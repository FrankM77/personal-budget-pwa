(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();function p5(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var lb={exports:{}},uf={};var QA;function g5(){if(QA)return uf;QA=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,i,a){var o=null;if(a!==void 0&&(o=""+a),i.key!==void 0&&(o=""+i.key),"key"in i){a={};for(var c in i)c!=="key"&&(a[c]=i[c])}else a=i;return i=a.ref,{$$typeof:t,type:r,key:o,ref:i!==void 0?i:null,props:a}}return uf.Fragment=e,uf.jsx=n,uf.jsxs=n,uf}var ZA;function m5(){return ZA||(ZA=1,lb.exports=g5()),lb.exports}var v=m5(),cb={exports:{}},it={};var JA;function v5(){if(JA)return it;JA=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),m=Symbol.iterator;function b(F){return F===null||typeof F!="object"?null:(F=m&&F[m]||F["@@iterator"],typeof F=="function"?F:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,S={};function T(F,Y,Q){this.props=F,this.context=Y,this.refs=S,this.updater=Q||w}T.prototype.isReactComponent={},T.prototype.setState=function(F,Y){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,Y,"setState")},T.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function C(){}C.prototype=T.prototype;function N(F,Y,Q){this.props=F,this.context=Y,this.refs=S,this.updater=Q||w}var j=N.prototype=new C;j.constructor=N,E(j,T.prototype),j.isPureReactComponent=!0;var P=Array.isArray;function M(){}var A={H:null,A:null,T:null,S:null},k=Object.prototype.hasOwnProperty;function D(F,Y,Q){var X=Q.ref;return{$$typeof:t,type:F,key:Y,ref:X!==void 0?X:null,props:Q}}function V(F,Y){return D(F.type,Y,F.props)}function L(F){return typeof F=="object"&&F!==null&&F.$$typeof===t}function U(F){var Y={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(Q){return Y[Q]})}var O=/\/+/g;function J(F,Y){return typeof F=="object"&&F!==null&&F.key!=null?U(""+F.key):Y.toString(36)}function W(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(M,M):(F.status="pending",F.then(function(Y){F.status==="pending"&&(F.status="fulfilled",F.value=Y)},function(Y){F.status==="pending"&&(F.status="rejected",F.reason=Y)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function q(F,Y,Q,X,ie){var le=typeof F;(le==="undefined"||le==="boolean")&&(F=null);var ge=!1;if(F===null)ge=!0;else switch(le){case"bigint":case"string":case"number":ge=!0;break;case"object":switch(F.$$typeof){case t:case e:ge=!0;break;case h:return ge=F._init,q(ge(F._payload),Y,Q,X,ie)}}if(ge)return ie=ie(F),ge=X===""?"."+J(F,0):X,P(ie)?(Q="",ge!=null&&(Q=ge.replace(O,"$&/")+"/"),q(ie,Y,Q,"",function(Ie){return Ie})):ie!=null&&(L(ie)&&(ie=V(ie,Q+(ie.key==null||F&&F.key===ie.key?"":(""+ie.key).replace(O,"$&/")+"/")+ge)),Y.push(ie)),1;ge=0;var pe=X===""?".":X+":";if(P(F))for(var _e=0;_e<F.length;_e++)X=F[_e],le=pe+J(X,_e),ge+=q(X,Y,Q,le,ie);else if(_e=b(F),typeof _e=="function")for(F=_e.call(F),_e=0;!(X=F.next()).done;)X=X.value,le=pe+J(X,_e++),ge+=q(X,Y,Q,le,ie);else if(le==="object"){if(typeof F.then=="function")return q(W(F),Y,Q,X,ie);throw Y=String(F),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.")}return ge}function K(F,Y,Q){if(F==null)return F;var X=[],ie=0;return q(F,X,"","",function(le){return Y.call(Q,le,ie++)}),X}function te(F){if(F._status===-1){var Y=F._result;Y=Y(),Y.then(function(Q){(F._status===0||F._status===-1)&&(F._status=1,F._result=Q)},function(Q){(F._status===0||F._status===-1)&&(F._status=2,F._result=Q)}),F._status===-1&&(F._status=0,F._result=Y)}if(F._status===1)return F._result.default;throw F._result}var se=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent(Y))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)},G={map:K,forEach:function(F,Y,Q){K(F,function(){Y.apply(this,arguments)},Q)},count:function(F){var Y=0;return K(F,function(){Y++}),Y},toArray:function(F){return K(F,function(Y){return Y})||[]},only:function(F){if(!L(F))throw Error("React.Children.only expected to receive a single React element child.");return F}};return it.Activity=p,it.Children=G,it.Component=T,it.Fragment=n,it.Profiler=i,it.PureComponent=N,it.StrictMode=r,it.Suspense=u,it.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,it.__COMPILER_RUNTIME={__proto__:null,c:function(F){return A.H.useMemoCache(F)}},it.cache=function(F){return function(){return F.apply(null,arguments)}},it.cacheSignal=function(){return null},it.cloneElement=function(F,Y,Q){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var X=E({},F.props),ie=F.key;if(Y!=null)for(le in Y.key!==void 0&&(ie=""+Y.key),Y)!k.call(Y,le)||le==="key"||le==="__self"||le==="__source"||le==="ref"&&Y.ref===void 0||(X[le]=Y[le]);var le=arguments.length-2;if(le===1)X.children=Q;else if(1<le){for(var ge=Array(le),pe=0;pe<le;pe++)ge[pe]=arguments[pe+2];X.children=ge}return D(F.type,ie,X)},it.createContext=function(F){return F={$$typeof:o,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:a,_context:F},F},it.createElement=function(F,Y,Q){var X,ie={},le=null;if(Y!=null)for(X in Y.key!==void 0&&(le=""+Y.key),Y)k.call(Y,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(ie[X]=Y[X]);var ge=arguments.length-2;if(ge===1)ie.children=Q;else if(1<ge){for(var pe=Array(ge),_e=0;_e<ge;_e++)pe[_e]=arguments[_e+2];ie.children=pe}if(F&&F.defaultProps)for(X in ge=F.defaultProps,ge)ie[X]===void 0&&(ie[X]=ge[X]);return D(F,le,ie)},it.createRef=function(){return{current:null}},it.forwardRef=function(F){return{$$typeof:c,render:F}},it.isValidElement=L,it.lazy=function(F){return{$$typeof:h,_payload:{_status:-1,_result:F},_init:te}},it.memo=function(F,Y){return{$$typeof:d,type:F,compare:Y===void 0?null:Y}},it.startTransition=function(F){var Y=A.T,Q={};A.T=Q;try{var X=F(),ie=A.S;ie!==null&&ie(Q,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(M,se)}catch(le){se(le)}finally{Y!==null&&Q.types!==null&&(Y.types=Q.types),A.T=Y}},it.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},it.use=function(F){return A.H.use(F)},it.useActionState=function(F,Y,Q){return A.H.useActionState(F,Y,Q)},it.useCallback=function(F,Y){return A.H.useCallback(F,Y)},it.useContext=function(F){return A.H.useContext(F)},it.useDebugValue=function(){},it.useDeferredValue=function(F,Y){return A.H.useDeferredValue(F,Y)},it.useEffect=function(F,Y){return A.H.useEffect(F,Y)},it.useEffectEvent=function(F){return A.H.useEffectEvent(F)},it.useId=function(){return A.H.useId()},it.useImperativeHandle=function(F,Y,Q){return A.H.useImperativeHandle(F,Y,Q)},it.useInsertionEffect=function(F,Y){return A.H.useInsertionEffect(F,Y)},it.useLayoutEffect=function(F,Y){return A.H.useLayoutEffect(F,Y)},it.useMemo=function(F,Y){return A.H.useMemo(F,Y)},it.useOptimistic=function(F,Y){return A.H.useOptimistic(F,Y)},it.useReducer=function(F,Y,Q){return A.H.useReducer(F,Y,Q)},it.useRef=function(F){return A.H.useRef(F)},it.useState=function(F){return A.H.useState(F)},it.useSyncExternalStore=function(F,Y,Q){return A.H.useSyncExternalStore(F,Y,Q)},it.useTransition=function(){return A.H.useTransition()},it.version="19.2.0",it}var eC;function W1(){return eC||(eC=1,cb.exports=v5()),cb.exports}var B=W1();const gf=p5(B);var ub={exports:{}},df={},db={exports:{}},fb={};var tC;function y5(){return tC||(tC=1,(function(t){function e(q,K){var te=q.length;q.push(K);e:for(;0<te;){var se=te-1>>>1,G=q[se];if(0<i(G,K))q[se]=K,q[te]=G,te=se;else break e}}function n(q){return q.length===0?null:q[0]}function r(q){if(q.length===0)return null;var K=q[0],te=q.pop();if(te!==K){q[0]=te;e:for(var se=0,G=q.length,F=G>>>1;se<F;){var Y=2*(se+1)-1,Q=q[Y],X=Y+1,ie=q[X];if(0>i(Q,te))X<G&&0>i(ie,Q)?(q[se]=ie,q[X]=te,se=X):(q[se]=Q,q[Y]=te,se=Y);else if(X<G&&0>i(ie,te))q[se]=ie,q[X]=te,se=X;else break e}}return K}function i(q,K){var te=q.sortIndex-K.sortIndex;return te!==0?te:q.id-K.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],d=[],h=1,p=null,m=3,b=!1,w=!1,E=!1,S=!1,T=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function j(q){for(var K=n(d);K!==null;){if(K.callback===null)r(d);else if(K.startTime<=q)r(d),K.sortIndex=K.expirationTime,e(u,K);else break;K=n(d)}}function P(q){if(E=!1,j(q),!w)if(n(u)!==null)w=!0,M||(M=!0,U());else{var K=n(d);K!==null&&W(P,K.startTime-q)}}var M=!1,A=-1,k=5,D=-1;function V(){return S?!0:!(t.unstable_now()-D<k)}function L(){if(S=!1,M){var q=t.unstable_now();D=q;var K=!0;try{e:{w=!1,E&&(E=!1,C(A),A=-1),b=!0;var te=m;try{t:{for(j(q),p=n(u);p!==null&&!(p.expirationTime>q&&V());){var se=p.callback;if(typeof se=="function"){p.callback=null,m=p.priorityLevel;var G=se(p.expirationTime<=q);if(q=t.unstable_now(),typeof G=="function"){p.callback=G,j(q),K=!0;break t}p===n(u)&&r(u),j(q)}else r(u);p=n(u)}if(p!==null)K=!0;else{var F=n(d);F!==null&&W(P,F.startTime-q),K=!1}}break e}finally{p=null,m=te,b=!1}K=void 0}}finally{K?U():M=!1}}}var U;if(typeof N=="function")U=function(){N(L)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,J=O.port2;O.port1.onmessage=L,U=function(){J.postMessage(null)}}else U=function(){T(L,0)};function W(q,K){A=T(function(){q(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(q){q.callback=null},t.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<q?Math.floor(1e3/q):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_next=function(q){switch(m){case 1:case 2:case 3:var K=3;break;default:K=m}var te=m;m=K;try{return q()}finally{m=te}},t.unstable_requestPaint=function(){S=!0},t.unstable_runWithPriority=function(q,K){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var te=m;m=q;try{return K()}finally{m=te}},t.unstable_scheduleCallback=function(q,K,te){var se=t.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?se+te:se):te=se,q){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=te+G,q={id:h++,callback:K,priorityLevel:q,startTime:te,expirationTime:G,sortIndex:-1},te>se?(q.sortIndex=te,e(d,q),n(u)===null&&q===n(d)&&(E?(C(A),A=-1):E=!0,W(P,te-se))):(q.sortIndex=G,e(u,q),w||b||(w=!0,M||(M=!0,U()))),q},t.unstable_shouldYield=V,t.unstable_wrapCallback=function(q){var K=m;return function(){var te=m;m=K;try{return q.apply(this,arguments)}finally{m=te}}}})(fb)),fb}var nC;function b5(){return nC||(nC=1,db.exports=y5()),db.exports}var hb={exports:{}},or={};var rC;function x5(){if(rC)return or;rC=1;var t=W1();function e(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)d+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(u,d,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:p==null?null:""+p,children:u,containerInfo:d,implementation:h}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return or.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,or.createPortal=function(u,d){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return a(u,d,null,h)},or.flushSync=function(u){var d=o.T,h=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=d,r.p=h,r.d.f()}},or.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(u,d))},or.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},or.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin),m=typeof d.integrity=="string"?d.integrity:void 0,b=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;h==="style"?r.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:b}):h==="script"&&r.d.X(u,{crossOrigin:p,integrity:m,fetchPriority:b,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},or.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var h=c(d.as,d.crossOrigin);r.d.M(u,{crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(u)},or.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin);r.d.L(u,h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},or.preloadModule=function(u,d){if(typeof u=="string")if(d){var h=c(d.as,d.crossOrigin);r.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(u)},or.requestFormReset=function(u){r.d.r(u)},or.unstable_batchedUpdates=function(u,d){return u(d)},or.useFormState=function(u,d,h){return o.H.useFormState(u,d,h)},or.useFormStatus=function(){return o.H.useHostTransitionStatus()},or.version="19.2.0",or}var iC;function w5(){if(iC)return hb.exports;iC=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),hb.exports=x5(),hb.exports}var aC;function _5(){if(aC)return df;aC=1;var t=b5(),e=W1(),n=w5();function r(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var l=s,f=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(f=l.return),s=l.return;while(s)}return l.tag===3?f:null}function o(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function c(s){if(s.tag===31){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function u(s){if(a(s)!==s)throw Error(r(188))}function d(s){var l=s.alternate;if(!l){if(l=a(s),l===null)throw Error(r(188));return l!==s?null:s}for(var f=s,g=l;;){var x=f.return;if(x===null)break;var _=x.alternate;if(_===null){if(g=x.return,g!==null){f=g;continue}break}if(x.child===_.child){for(_=x.child;_;){if(_===f)return u(x),s;if(_===g)return u(x),l;_=_.sibling}throw Error(r(188))}if(f.return!==g.return)f=x,g=_;else{for(var I=!1,$=x.child;$;){if($===f){I=!0,f=x,g=_;break}if($===g){I=!0,g=x,f=_;break}$=$.sibling}if(!I){for($=_.child;$;){if($===f){I=!0,f=_,g=x;break}if($===g){I=!0,g=_,f=x;break}$=$.sibling}if(!I)throw Error(r(189))}}if(f.alternate!==g)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?s:l}function h(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=h(s),l!==null)return l;s=s.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),N=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function U(s){return s===null||typeof s!="object"?null:(s=L&&s[L]||s["@@iterator"],typeof s=="function"?s:null)}var O=Symbol.for("react.client.reference");function J(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===O?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case E:return"Fragment";case T:return"Profiler";case S:return"StrictMode";case P:return"Suspense";case M:return"SuspenseList";case D:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case w:return"Portal";case N:return s.displayName||"Context";case C:return(s._context.displayName||"Context")+".Consumer";case j:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case A:return l=s.displayName||null,l!==null?l:J(s.type)||"Memo";case k:l=s._payload,s=s._init;try{return J(s(l))}catch{}}return null}var W=Array.isArray,q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,te={pending:!1,data:null,method:null,action:null},se=[],G=-1;function F(s){return{current:s}}function Y(s){0>G||(s.current=se[G],se[G]=null,G--)}function Q(s,l){G++,se[G]=s.current,s.current=l}var X=F(null),ie=F(null),le=F(null),ge=F(null);function pe(s,l){switch(Q(le,l),Q(ie,s),Q(X,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?xA(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=xA(l),s=wA(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}Y(X),Q(X,s)}function _e(){Y(X),Y(ie),Y(le)}function Ie(s){s.memoizedState!==null&&Q(ge,s);var l=X.current,f=wA(l,s.type);l!==f&&(Q(ie,s),Q(X,f))}function ae(s){ie.current===s&&(Y(X),Y(ie)),ge.current===s&&(Y(ge),sf._currentValue=te)}var Ae,Re;function De(s){if(Ae===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);Ae=l&&l[1]||"",Re=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ae+s+Re}var Ve=!1;function ze(s,l){if(!s||Ve)return"";Ve=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(l){var xe=function(){throw Error()};if(Object.defineProperty(xe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xe,[])}catch(me){var fe=me}Reflect.construct(s,[],xe)}else{try{xe.call()}catch(me){fe=me}s.call(xe.prototype)}}else{try{throw Error()}catch(me){fe=me}(xe=s())&&typeof xe.catch=="function"&&xe.catch(function(){})}}catch(me){if(me&&fe&&typeof me.stack=="string")return[me.stack,fe.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=g.DetermineComponentFrameRoot(),I=_[0],$=_[1];if(I&&$){var Z=I.split(`
`),de=$.split(`
`);for(x=g=0;g<Z.length&&!Z[g].includes("DetermineComponentFrameRoot");)g++;for(;x<de.length&&!de[x].includes("DetermineComponentFrameRoot");)x++;if(g===Z.length||x===de.length)for(g=Z.length-1,x=de.length-1;1<=g&&0<=x&&Z[g]!==de[x];)x--;for(;1<=g&&0<=x;g--,x--)if(Z[g]!==de[x]){if(g!==1||x!==1)do if(g--,x--,0>x||Z[g]!==de[x]){var ve=`
`+Z[g].replace(" at new "," at ");return s.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",s.displayName)),ve}while(1<=g&&0<=x);break}}}finally{Ve=!1,Error.prepareStackTrace=f}return(f=s?s.displayName||s.name:"")?De(f):""}function Se(s,l){switch(s.tag){case 26:case 27:case 5:return De(s.type);case 16:return De("Lazy");case 13:return s.child!==l&&l!==null?De("Suspense Fallback"):De("Suspense");case 19:return De("SuspenseList");case 0:case 15:return ze(s.type,!1);case 11:return ze(s.type.render,!1);case 1:return ze(s.type,!0);case 31:return De("Activity");default:return""}}function Le(s){try{var l="",f=null;do l+=Se(s,f),f=s,s=s.return;while(s);return l}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var Me=Object.prototype.hasOwnProperty,Be=t.unstable_scheduleCallback,st=t.unstable_cancelCallback,_t=t.unstable_shouldYield,Ze=t.unstable_requestPaint,ut=t.unstable_now,Rt=t.unstable_getCurrentPriorityLevel,cn=t.unstable_ImmediatePriority,Mt=t.unstable_UserBlockingPriority,_n=t.unstable_NormalPriority,$r=t.unstable_LowPriority,sa=t.unstable_IdlePriority,Xa=t.log,Vs=t.unstable_setDisableYieldValue,Gr=null,En=null;function sr(s){if(typeof Xa=="function"&&Vs(s),En&&typeof En.setStrictMode=="function")try{En.setStrictMode(Gr,s)}catch{}}var tn=Math.clz32?Math.clz32:Ls,fc=Math.log,zs=Math.LN2;function Ls(s){return s>>>=0,s===0?32:31-(fc(s)/zs|0)|0}var ft=256,nn=262144,rn=4194304;function Hr(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function si(s,l,f){var g=s.pendingLanes;if(g===0)return 0;var x=0,_=s.suspendedLanes,I=s.pingedLanes;s=s.warmLanes;var $=g&134217727;return $!==0?(g=$&~_,g!==0?x=Hr(g):(I&=$,I!==0?x=Hr(I):f||(f=$&~s,f!==0&&(x=Hr(f))))):($=g&~_,$!==0?x=Hr($):I!==0?x=Hr(I):f||(f=g&~s,f!==0&&(x=Hr(f)))),x===0?0:l!==0&&l!==x&&(l&_)===0&&(_=x&-x,f=l&-l,_>=f||_===32&&(f&4194048)!==0)?l:x}function gr(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function fv(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Zh(){var s=rn;return rn<<=1,(rn&62914560)===0&&(rn=4194304),s}function oa(s){for(var l=[],f=0;31>f;f++)l.push(s);return l}function ol(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function hv(s,l,f,g,x,_){var I=s.pendingLanes;s.pendingLanes=f,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=f,s.entangledLanes&=f,s.errorRecoveryDisabledLanes&=f,s.shellSuspendCounter=0;var $=s.entanglements,Z=s.expirationTimes,de=s.hiddenUpdates;for(f=I&~f;0<f;){var ve=31-tn(f),xe=1<<ve;$[ve]=0,Z[ve]=-1;var fe=de[ve];if(fe!==null)for(de[ve]=null,ve=0;ve<fe.length;ve++){var me=fe[ve];me!==null&&(me.lane&=-536870913)}f&=~xe}g!==0&&ll(s,g,0),_!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=_&~(I&~l))}function ll(s,l,f){s.pendingLanes|=l,s.suspendedLanes&=~l;var g=31-tn(l);s.entangledLanes|=l,s.entanglements[g]=s.entanglements[g]|1073741824|f&261930}function ud(s,l){var f=s.entangledLanes|=l;for(s=s.entanglements;f;){var g=31-tn(f),x=1<<g;x&l|s[g]&l&&(s[g]|=l),f&=~x}}function dd(s,l){var f=l&-l;return f=(f&42)!==0?1:cl(f),(f&(s.suspendedLanes|l))!==0?0:f}function cl(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Wa(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Jh(){var s=K.p;return s!==0?s:(s=window.event,s===void 0?32:GA(s.type))}function Oi(s,l){var f=K.p;try{return K.p=s,l()}finally{K.p=f}}var Pi=Math.random().toString(36).slice(2),Sn="__reactFiber$"+Pi,Hn="__reactProps$"+Pi,la="__reactContainer$"+Pi,hc="__reactEvents$"+Pi,pv="__reactListeners$"+Pi,ep="__reactHandles$"+Pi,tp="__reactResources$"+Pi,ca="__reactMarker$"+Pi;function pc(s){delete s[Sn],delete s[Hn],delete s[hc],delete s[pv],delete s[ep]}function ua(s){var l=s[Sn];if(l)return l;for(var f=s.parentNode;f;){if(l=f[la]||f[Sn]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(s=kA(s);s!==null;){if(f=s[Sn])return f;s=kA(s)}return l}s=f,f=s.parentNode}return null}function oi(s){if(s=s[Sn]||s[la]){var l=s.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return s}return null}function qr(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(r(33))}function da(s){var l=s[tp];return l||(l=s[tp]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Tn(s){s[ca]=!0}var fd=new Set,hd={};function fa(s,l){ha(s,l),ha(s+"Capture",l)}function ha(s,l){for(hd[s]=l,s=0;s<l.length;s++)fd.add(l[s])}var pd=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),gd={},md={};function np(s){return Me.call(md,s)?!0:Me.call(gd,s)?!1:pd.test(s)?md[s]=!0:(gd[s]=!0,!1)}function gc(s,l,f){if(np(l))if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var g=l.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+f)}}function Yr(s,l,f){if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+f)}}function An(s,l,f,g){if(g===null)s.removeAttribute(f);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(f);return}s.setAttributeNS(l,f,""+g)}}function qn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Bs(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function vd(s,l,f){var g=Object.getOwnPropertyDescriptor(s.constructor.prototype,l);if(!s.hasOwnProperty(l)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var x=g.get,_=g.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return x.call(this)},set:function(I){f=""+I,_.call(this,I)}}),Object.defineProperty(s,l,{enumerable:g.enumerable}),{getValue:function(){return f},setValue:function(I){f=""+I},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function Pt(s){if(!s._valueTracker){var l=Bs(s)?"checked":"value";s._valueTracker=vd(s,l,""+s[l])}}function ul(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var f=l.getValue(),g="";return s&&(g=Bs(s)?s.checked?"true":"false":s.value),s=g,s!==f?(l.setValue(s),!0):!1}function pa(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var dl=/[\n"\\]/g;function Ar(s){return s.replace(dl,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function mc(s,l,f,g,x,_,I,$){s.name="",I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?s.type=I:s.removeAttribute("type"),l!=null?I==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+qn(l)):s.value!==""+qn(l)&&(s.value=""+qn(l)):I!=="submit"&&I!=="reset"||s.removeAttribute("value"),l!=null?yd(s,I,qn(l)):f!=null?yd(s,I,qn(f)):g!=null&&s.removeAttribute("value"),x==null&&_!=null&&(s.defaultChecked=!!_),x!=null&&(s.checked=x&&typeof x!="function"&&typeof x!="symbol"),$!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"?s.name=""+qn($):s.removeAttribute("name")}function rp(s,l,f,g,x,_,I,$){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(s.type=_),l!=null||f!=null){if(!(_!=="submit"&&_!=="reset"||l!=null)){Pt(s);return}f=f!=null?""+qn(f):"",l=l!=null?""+qn(l):f,$||l===s.value||(s.value=l),s.defaultValue=l}g=g??x,g=typeof g!="function"&&typeof g!="symbol"&&!!g,s.checked=$?s.checked:!!g,s.defaultChecked=!!g,I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"&&(s.name=I),Pt(s)}function yd(s,l,f){l==="number"&&pa(s.ownerDocument)===s||s.defaultValue===""+f||(s.defaultValue=""+f)}function Us(s,l,f,g){if(s=s.options,l){l={};for(var x=0;x<f.length;x++)l["$"+f[x]]=!0;for(f=0;f<s.length;f++)x=l.hasOwnProperty("$"+s[f].value),s[f].selected!==x&&(s[f].selected=x),x&&g&&(s[f].defaultSelected=!0)}else{for(f=""+qn(f),l=null,x=0;x<s.length;x++){if(s[x].value===f){s[x].selected=!0,g&&(s[x].defaultSelected=!0);return}l!==null||s[x].disabled||(l=s[x])}l!==null&&(l.selected=!0)}}function ip(s,l,f){if(l!=null&&(l=""+qn(l),l!==s.value&&(s.value=l),f==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=f!=null?""+qn(f):""}function Fs(s,l,f,g){if(l==null){if(g!=null){if(f!=null)throw Error(r(92));if(W(g)){if(1<g.length)throw Error(r(93));g=g[0]}f=g}f==null&&(f=""),l=f}f=qn(l),s.defaultValue=f,g=s.textContent,g===f&&g!==""&&g!==null&&(s.value=g),Pt(s)}function Cr(s,l){if(l){var f=s.firstChild;if(f&&f===s.lastChild&&f.nodeType===3){f.nodeValue=l;return}}s.textContent=l}var ap=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function bd(s,l,f){var g=l.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?g?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":g?s.setProperty(l,f):typeof f!="number"||f===0||ap.has(l)?l==="float"?s.cssFloat=f:s[l]=(""+f).trim():s[l]=f+"px"}function xd(s,l,f){if(l!=null&&typeof l!="object")throw Error(r(62));if(s=s.style,f!=null){for(var g in f)!f.hasOwnProperty(g)||l!=null&&l.hasOwnProperty(g)||(g.indexOf("--")===0?s.setProperty(g,""):g==="float"?s.cssFloat="":s[g]="");for(var x in l)g=l[x],l.hasOwnProperty(x)&&f[x]!==g&&bd(s,x,g)}else for(var _ in l)l.hasOwnProperty(_)&&bd(s,_,l[_])}function vc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sp=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),$s=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function yc(s){return $s.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function ji(){}var wd=null;function li(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Gs=null,ga=null;function fl(s){var l=oi(s);if(l&&(s=l.stateNode)){var f=s[Hn]||null;e:switch(s=l.stateNode,l.type){case"input":if(mc(s,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),l=f.name,f.type==="radio"&&l!=null){for(f=s;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Ar(""+l)+'"][type="radio"]'),l=0;l<f.length;l++){var g=f[l];if(g!==s&&g.form===s.form){var x=g[Hn]||null;if(!x)throw Error(r(90));mc(g,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(l=0;l<f.length;l++)g=f[l],g.form===s.form&&ul(g)}break e;case"textarea":ip(s,f.value,f.defaultValue);break e;case"select":l=f.value,l!=null&&Us(s,!!f.multiple,l,!1)}}}var bc=!1;function Hs(s,l,f){if(bc)return s(l,f);bc=!0;try{var g=s(l);return g}finally{if(bc=!1,(Gs!==null||ga!==null)&&(Jp(),Gs&&(l=Gs,s=ga,ga=Gs=null,fl(l),s)))for(l=0;l<s.length;l++)fl(s[l])}}function Vi(s,l){var f=s.stateNode;if(f===null)return null;var g=f[Hn]||null;if(g===null)return null;f=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(s=s.type,g=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!g;break e;default:s=!1}if(s)return null;if(f&&typeof f!="function")throw Error(r(231,l,typeof f));return f}var ci=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hl=!1;if(ci)try{var Lt={};Object.defineProperty(Lt,"passive",{get:function(){hl=!0}}),window.addEventListener("test",Lt,Lt),window.removeEventListener("test",Lt,Lt)}catch{hl=!1}var ma=null,_d=null,pl=null;function Ed(){if(pl)return pl;var s,l=_d,f=l.length,g,x="value"in ma?ma.value:ma.textContent,_=x.length;for(s=0;s<f&&l[s]===x[s];s++);var I=f-s;for(g=1;g<=I&&l[f-g]===x[_-g];g++);return pl=x.slice(s,1<g?1-g:void 0)}function gl(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function Ka(){return!0}function zi(){return!1}function Wn(s){function l(f,g,x,_,I){this._reactName=f,this._targetInst=x,this.type=g,this.nativeEvent=_,this.target=I,this.currentTarget=null;for(var $ in s)s.hasOwnProperty($)&&(f=s[$],this[$]=f?f(_):_[$]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?Ka:zi,this.isPropagationStopped=zi,this}return p(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Ka)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Ka)},persist:function(){},isPersistent:Ka}),l}var Qa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},va=Wn(Qa),qs=p({},Qa,{view:0,detail:0}),Sd=Wn(qs),Ys,xc,ya,wc=p({},qs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xs,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ya&&(ya&&s.type==="mousemove"?(Ys=s.screenX-ya.screenX,xc=s.screenY-ya.screenY):xc=Ys=0,ya=s),Ys)},movementY:function(s){return"movementY"in s?s.movementY:xc}}),Td=Wn(wc),ml=p({},wc,{dataTransfer:0}),op=Wn(ml),lp=p({},qs,{relatedTarget:0}),vl=Wn(lp),Ad=p({},Qa,{animationName:0,elapsedTime:0,pseudoElement:0}),cp=Wn(Ad),_c=p({},Qa,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),up=Wn(_c),dp=p({},Qa,{data:0}),ba=Wn(dp),fp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gp(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=pp[s])?!!l[s]:!1}function Xs(){return gp}var mr=p({},qs,{key:function(s){if(s.key){var l=fp[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=gl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?hp[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xs,charCode:function(s){return s.type==="keypress"?gl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?gl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),mp=Wn(mr),vp=p({},wc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Za=Wn(vp),y=p({},qs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xs}),R=Wn(y),z=p({},Qa,{propertyName:0,elapsedTime:0,pseudoElement:0}),H=Wn(z),ce=p({},wc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),he=Wn(ce),ke=p({},Qa,{newState:0,oldState:0}),ot=Wn(ke),mn=[9,13,27,32],Nt=ci&&"CompositionEvent"in window,Zt=null;ci&&"documentMode"in document&&(Zt=document.documentMode);var ui=ci&&"TextEvent"in window&&!Zt,xa=ci&&(!Nt||Zt&&8<Zt&&11>=Zt),Li=" ",Bi=!1;function yl(s,l){switch(s){case"keyup":return mn.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ec(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Sc=!1;function z3(s,l){switch(s){case"compositionend":return Ec(l);case"keypress":return l.which!==32?null:(Bi=!0,Li);case"textInput":return s=l.data,s===Li&&Bi?null:s;default:return null}}function L3(s,l){if(Sc)return s==="compositionend"||!Nt&&yl(s,l)?(s=Ed(),pl=_d=ma=null,Sc=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return xa&&l.locale!=="ko"?null:l.data;default:return null}}var B3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function DE(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!B3[s.type]:l==="textarea"}function IE(s,l,f,g){Gs?ga?ga.push(g):ga=[g]:Gs=g,l=sg(l,"onChange"),0<l.length&&(f=new va("onChange","change",null,f,g),s.push({event:f,listeners:l}))}var Cd=null,kd=null;function U3(s){pA(s,0)}function yp(s){var l=qr(s);if(ul(l))return s}function ME(s,l){if(s==="change")return l}var OE=!1;if(ci){var gv;if(ci){var mv="oninput"in document;if(!mv){var PE=document.createElement("div");PE.setAttribute("oninput","return;"),mv=typeof PE.oninput=="function"}gv=mv}else gv=!1;OE=gv&&(!document.documentMode||9<document.documentMode)}function jE(){Cd&&(Cd.detachEvent("onpropertychange",VE),kd=Cd=null)}function VE(s){if(s.propertyName==="value"&&yp(kd)){var l=[];IE(l,kd,s,li(s)),Hs(U3,l)}}function F3(s,l,f){s==="focusin"?(jE(),Cd=l,kd=f,Cd.attachEvent("onpropertychange",VE)):s==="focusout"&&jE()}function $3(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return yp(kd)}function G3(s,l){if(s==="click")return yp(l)}function H3(s,l){if(s==="input"||s==="change")return yp(l)}function q3(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var Xr=typeof Object.is=="function"?Object.is:q3;function Rd(s,l){if(Xr(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var f=Object.keys(s),g=Object.keys(l);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var x=f[g];if(!Me.call(l,x)||!Xr(s[x],l[x]))return!1}return!0}function zE(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function LE(s,l){var f=zE(s);s=0;for(var g;f;){if(f.nodeType===3){if(g=s+f.textContent.length,s<=l&&g>=l)return{node:f,offset:l-s};s=g}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=zE(f)}}function BE(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?BE(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function UE(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=pa(s.document);l instanceof s.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)s=l.contentWindow;else break;l=pa(s.document)}return l}function vv(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var Y3=ci&&"documentMode"in document&&11>=document.documentMode,Tc=null,yv=null,Nd=null,bv=!1;function FE(s,l,f){var g=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;bv||Tc==null||Tc!==pa(g)||(g=Tc,"selectionStart"in g&&vv(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Nd&&Rd(Nd,g)||(Nd=g,g=sg(yv,"onSelect"),0<g.length&&(l=new va("onSelect","select",null,l,f),s.push({event:l,listeners:g}),l.target=Tc)))}function bl(s,l){var f={};return f[s.toLowerCase()]=l.toLowerCase(),f["Webkit"+s]="webkit"+l,f["Moz"+s]="moz"+l,f}var Ac={animationend:bl("Animation","AnimationEnd"),animationiteration:bl("Animation","AnimationIteration"),animationstart:bl("Animation","AnimationStart"),transitionrun:bl("Transition","TransitionRun"),transitionstart:bl("Transition","TransitionStart"),transitioncancel:bl("Transition","TransitionCancel"),transitionend:bl("Transition","TransitionEnd")},xv={},$E={};ci&&($E=document.createElement("div").style,"AnimationEvent"in window||(delete Ac.animationend.animation,delete Ac.animationiteration.animation,delete Ac.animationstart.animation),"TransitionEvent"in window||delete Ac.transitionend.transition);function xl(s){if(xv[s])return xv[s];if(!Ac[s])return s;var l=Ac[s],f;for(f in l)if(l.hasOwnProperty(f)&&f in $E)return xv[s]=l[f];return s}var GE=xl("animationend"),HE=xl("animationiteration"),qE=xl("animationstart"),X3=xl("transitionrun"),W3=xl("transitionstart"),K3=xl("transitioncancel"),YE=xl("transitionend"),XE=new Map,wv="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");wv.push("scrollEnd");function Ui(s,l){XE.set(s,l),fa(l,[s])}var bp=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},di=[],Cc=0,_v=0;function xp(){for(var s=Cc,l=_v=Cc=0;l<s;){var f=di[l];di[l++]=null;var g=di[l];di[l++]=null;var x=di[l];di[l++]=null;var _=di[l];if(di[l++]=null,g!==null&&x!==null){var I=g.pending;I===null?x.next=x:(x.next=I.next,I.next=x),g.pending=x}_!==0&&WE(f,x,_)}}function wp(s,l,f,g){di[Cc++]=s,di[Cc++]=l,di[Cc++]=f,di[Cc++]=g,_v|=g,s.lanes|=g,s=s.alternate,s!==null&&(s.lanes|=g)}function Ev(s,l,f,g){return wp(s,l,f,g),_p(s)}function wl(s,l){return wp(s,null,null,l),_p(s)}function WE(s,l,f){s.lanes|=f;var g=s.alternate;g!==null&&(g.lanes|=f);for(var x=!1,_=s.return;_!==null;)_.childLanes|=f,g=_.alternate,g!==null&&(g.childLanes|=f),_.tag===22&&(s=_.stateNode,s===null||s._visibility&1||(x=!0)),s=_,_=_.return;return s.tag===3?(_=s.stateNode,x&&l!==null&&(x=31-tn(f),s=_.hiddenUpdates,g=s[x],g===null?s[x]=[l]:g.push(l),l.lane=f|536870912),_):null}function _p(s){if(50<Zd)throw Zd=0,Iy=null,Error(r(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var kc={};function Q3(s,l,f,g){this.tag=s,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wr(s,l,f,g){return new Q3(s,l,f,g)}function Sv(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Ja(s,l){var f=s.alternate;return f===null?(f=Wr(s.tag,l,s.key,s.mode),f.elementType=s.elementType,f.type=s.type,f.stateNode=s.stateNode,f.alternate=s,s.alternate=f):(f.pendingProps=l,f.type=s.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=s.flags&65011712,f.childLanes=s.childLanes,f.lanes=s.lanes,f.child=s.child,f.memoizedProps=s.memoizedProps,f.memoizedState=s.memoizedState,f.updateQueue=s.updateQueue,l=s.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=s.sibling,f.index=s.index,f.ref=s.ref,f.refCleanup=s.refCleanup,f}function KE(s,l){s.flags&=65011714;var f=s.alternate;return f===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=f.childLanes,s.lanes=f.lanes,s.child=f.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=f.memoizedProps,s.memoizedState=f.memoizedState,s.updateQueue=f.updateQueue,s.type=f.type,l=f.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function Ep(s,l,f,g,x,_){var I=0;if(g=s,typeof s=="function")Sv(s)&&(I=1);else if(typeof s=="string")I=n5(s,f,X.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case D:return s=Wr(31,f,l,x),s.elementType=D,s.lanes=_,s;case E:return _l(f.children,x,_,l);case S:I=8,x|=24;break;case T:return s=Wr(12,f,l,x|2),s.elementType=T,s.lanes=_,s;case P:return s=Wr(13,f,l,x),s.elementType=P,s.lanes=_,s;case M:return s=Wr(19,f,l,x),s.elementType=M,s.lanes=_,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case N:I=10;break e;case C:I=9;break e;case j:I=11;break e;case A:I=14;break e;case k:I=16,g=null;break e}I=29,f=Error(r(130,s===null?"null":typeof s,"")),g=null}return l=Wr(I,f,l,x),l.elementType=s,l.type=g,l.lanes=_,l}function _l(s,l,f,g){return s=Wr(7,s,g,l),s.lanes=f,s}function Tv(s,l,f){return s=Wr(6,s,null,l),s.lanes=f,s}function QE(s){var l=Wr(18,null,null,0);return l.stateNode=s,l}function Av(s,l,f){return l=Wr(4,s.children!==null?s.children:[],s.key,l),l.lanes=f,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var ZE=new WeakMap;function fi(s,l){if(typeof s=="object"&&s!==null){var f=ZE.get(s);return f!==void 0?f:(l={value:s,source:l,stack:Le(l)},ZE.set(s,l),l)}return{value:s,source:l,stack:Le(l)}}var Rc=[],Nc=0,Sp=null,Dd=0,hi=[],pi=0,Ws=null,wa=1,_a="";function es(s,l){Rc[Nc++]=Dd,Rc[Nc++]=Sp,Sp=s,Dd=l}function JE(s,l,f){hi[pi++]=wa,hi[pi++]=_a,hi[pi++]=Ws,Ws=s;var g=wa;s=_a;var x=32-tn(g)-1;g&=~(1<<x),f+=1;var _=32-tn(l)+x;if(30<_){var I=x-x%5;_=(g&(1<<I)-1).toString(32),g>>=I,x-=I,wa=1<<32-tn(l)+x|f<<x|g,_a=_+s}else wa=1<<_|f<<x|g,_a=s}function Cv(s){s.return!==null&&(es(s,1),JE(s,1,0))}function kv(s){for(;s===Sp;)Sp=Rc[--Nc],Rc[Nc]=null,Dd=Rc[--Nc],Rc[Nc]=null;for(;s===Ws;)Ws=hi[--pi],hi[pi]=null,_a=hi[--pi],hi[pi]=null,wa=hi[--pi],hi[pi]=null}function eS(s,l){hi[pi++]=wa,hi[pi++]=_a,hi[pi++]=Ws,wa=l.id,_a=l.overflow,Ws=s}var Kn=null,Xt=null,Et=!1,Ks=null,gi=!1,Rv=Error(r(519));function Qs(s){var l=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Id(fi(l,s)),Rv}function tS(s){var l=s.stateNode,f=s.type,g=s.memoizedProps;switch(l[Sn]=s,l[Hn]=g,f){case"dialog":pt("cancel",l),pt("close",l);break;case"iframe":case"object":case"embed":pt("load",l);break;case"video":case"audio":for(f=0;f<ef.length;f++)pt(ef[f],l);break;case"source":pt("error",l);break;case"img":case"image":case"link":pt("error",l),pt("load",l);break;case"details":pt("toggle",l);break;case"input":pt("invalid",l),rp(l,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":pt("invalid",l);break;case"textarea":pt("invalid",l),Fs(l,g.value,g.defaultValue,g.children)}f=g.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||l.textContent===""+f||g.suppressHydrationWarning===!0||yA(l.textContent,f)?(g.popover!=null&&(pt("beforetoggle",l),pt("toggle",l)),g.onScroll!=null&&pt("scroll",l),g.onScrollEnd!=null&&pt("scrollend",l),g.onClick!=null&&(l.onclick=ji),l=!0):l=!1,l||Qs(s,!0)}function nS(s){for(Kn=s.return;Kn;)switch(Kn.tag){case 5:case 31:case 13:gi=!1;return;case 27:case 3:gi=!0;return;default:Kn=Kn.return}}function Dc(s){if(s!==Kn)return!1;if(!Et)return nS(s),Et=!0,!1;var l=s.tag,f;if((f=l!==3&&l!==27)&&((f=l===5)&&(f=s.type,f=!(f!=="form"&&f!=="button")||Yy(s.type,s.memoizedProps)),f=!f),f&&Xt&&Qs(s),nS(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Xt=CA(s)}else if(l===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Xt=CA(s)}else l===27?(l=Xt,fo(s.type)?(s=Zy,Zy=null,Xt=s):Xt=l):Xt=Kn?vi(s.stateNode.nextSibling):null;return!0}function El(){Xt=Kn=null,Et=!1}function Nv(){var s=Ks;return s!==null&&(Dr===null?Dr=s:Dr.push.apply(Dr,s),Ks=null),s}function Id(s){Ks===null?Ks=[s]:Ks.push(s)}var Dv=F(null),Sl=null,ts=null;function Zs(s,l,f){Q(Dv,l._currentValue),l._currentValue=f}function ns(s){s._currentValue=Dv.current,Y(Dv)}function Iv(s,l,f){for(;s!==null;){var g=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),s===f)break;s=s.return}}function Mv(s,l,f,g){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var _=x.dependencies;if(_!==null){var I=x.child;_=_.firstContext;e:for(;_!==null;){var $=_;_=x;for(var Z=0;Z<l.length;Z++)if($.context===l[Z]){_.lanes|=f,$=_.alternate,$!==null&&($.lanes|=f),Iv(_.return,f,s),g||(I=null);break e}_=$.next}}else if(x.tag===18){if(I=x.return,I===null)throw Error(r(341));I.lanes|=f,_=I.alternate,_!==null&&(_.lanes|=f),Iv(I,f,s),I=null}else I=x.child;if(I!==null)I.return=x;else for(I=x;I!==null;){if(I===s){I=null;break}if(x=I.sibling,x!==null){x.return=I.return,I=x;break}I=I.return}x=I}}function Ic(s,l,f,g){s=null;for(var x=l,_=!1;x!==null;){if(!_){if((x.flags&524288)!==0)_=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var I=x.alternate;if(I===null)throw Error(r(387));if(I=I.memoizedProps,I!==null){var $=x.type;Xr(x.pendingProps.value,I.value)||(s!==null?s.push($):s=[$])}}else if(x===ge.current){if(I=x.alternate,I===null)throw Error(r(387));I.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(sf):s=[sf])}x=x.return}s!==null&&Mv(l,s,f,g),l.flags|=262144}function Tp(s){for(s=s.firstContext;s!==null;){if(!Xr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Tl(s){Sl=s,ts=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Qn(s){return rS(Sl,s)}function Ap(s,l){return Sl===null&&Tl(s),rS(s,l)}function rS(s,l){var f=l._currentValue;if(l={context:l,memoizedValue:f,next:null},ts===null){if(s===null)throw Error(r(308));ts=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else ts=ts.next=l;return f}var Z3=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(f,g){s.push(g)}};this.abort=function(){l.aborted=!0,s.forEach(function(f){return f()})}},J3=t.unstable_scheduleCallback,ej=t.unstable_NormalPriority,Cn={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ov(){return{controller:new Z3,data:new Map,refCount:0}}function Md(s){s.refCount--,s.refCount===0&&J3(ej,function(){s.controller.abort()})}var Od=null,Pv=0,Mc=0,Oc=null;function tj(s,l){if(Od===null){var f=Od=[];Pv=0,Mc=zy(),Oc={status:"pending",value:void 0,then:function(g){f.push(g)}}}return Pv++,l.then(iS,iS),l}function iS(){if(--Pv===0&&Od!==null){Oc!==null&&(Oc.status="fulfilled");var s=Od;Od=null,Mc=0,Oc=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function nj(s,l){var f=[],g={status:"pending",value:null,reason:null,then:function(x){f.push(x)}};return s.then(function(){g.status="fulfilled",g.value=l;for(var x=0;x<f.length;x++)(0,f[x])(l)},function(x){for(g.status="rejected",g.reason=x,x=0;x<f.length;x++)(0,f[x])(void 0)}),g}var aS=q.S;q.S=function(s,l){FT=ut(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&tj(s,l),aS!==null&&aS(s,l)};var Al=F(null);function jv(){var s=Al.current;return s!==null?s:Ht.pooledCache}function Cp(s,l){l===null?Q(Al,Al.current):Q(Al,l.pool)}function sS(){var s=jv();return s===null?null:{parent:Cn._currentValue,pool:s}}var Pc=Error(r(460)),Vv=Error(r(474)),kp=Error(r(542)),Rp={then:function(){}};function oS(s){return s=s.status,s==="fulfilled"||s==="rejected"}function lS(s,l,f){switch(f=s[f],f===void 0?s.push(l):f!==l&&(l.then(ji,ji),l=f),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,uS(s),s;default:if(typeof l.status=="string")l.then(ji,ji);else{if(s=Ht,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=l,s.status="pending",s.then(function(g){if(l.status==="pending"){var x=l;x.status="fulfilled",x.value=g}},function(g){if(l.status==="pending"){var x=l;x.status="rejected",x.reason=g}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,uS(s),s}throw kl=l,Pc}}function Cl(s){try{var l=s._init;return l(s._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(kl=f,Pc):f}}var kl=null;function cS(){if(kl===null)throw Error(r(459));var s=kl;return kl=null,s}function uS(s){if(s===Pc||s===kp)throw Error(r(483))}var jc=null,Pd=0;function Np(s){var l=Pd;return Pd+=1,jc===null&&(jc=[]),lS(jc,s,l)}function jd(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function Dp(s,l){throw l.$$typeof===m?Error(r(525)):(s=Object.prototype.toString.call(l),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function dS(s){function l(oe,re){if(s){var ue=oe.deletions;ue===null?(oe.deletions=[re],oe.flags|=16):ue.push(re)}}function f(oe,re){if(!s)return null;for(;re!==null;)l(oe,re),re=re.sibling;return null}function g(oe){for(var re=new Map;oe!==null;)oe.key!==null?re.set(oe.key,oe):re.set(oe.index,oe),oe=oe.sibling;return re}function x(oe,re){return oe=Ja(oe,re),oe.index=0,oe.sibling=null,oe}function _(oe,re,ue){return oe.index=ue,s?(ue=oe.alternate,ue!==null?(ue=ue.index,ue<re?(oe.flags|=67108866,re):ue):(oe.flags|=67108866,re)):(oe.flags|=1048576,re)}function I(oe){return s&&oe.alternate===null&&(oe.flags|=67108866),oe}function $(oe,re,ue,ye){return re===null||re.tag!==6?(re=Tv(ue,oe.mode,ye),re.return=oe,re):(re=x(re,ue),re.return=oe,re)}function Z(oe,re,ue,ye){var Ge=ue.type;return Ge===E?ve(oe,re,ue.props.children,ye,ue.key):re!==null&&(re.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===k&&Cl(Ge)===re.type)?(re=x(re,ue.props),jd(re,ue),re.return=oe,re):(re=Ep(ue.type,ue.key,ue.props,null,oe.mode,ye),jd(re,ue),re.return=oe,re)}function de(oe,re,ue,ye){return re===null||re.tag!==4||re.stateNode.containerInfo!==ue.containerInfo||re.stateNode.implementation!==ue.implementation?(re=Av(ue,oe.mode,ye),re.return=oe,re):(re=x(re,ue.children||[]),re.return=oe,re)}function ve(oe,re,ue,ye,Ge){return re===null||re.tag!==7?(re=_l(ue,oe.mode,ye,Ge),re.return=oe,re):(re=x(re,ue),re.return=oe,re)}function xe(oe,re,ue){if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return re=Tv(""+re,oe.mode,ue),re.return=oe,re;if(typeof re=="object"&&re!==null){switch(re.$$typeof){case b:return ue=Ep(re.type,re.key,re.props,null,oe.mode,ue),jd(ue,re),ue.return=oe,ue;case w:return re=Av(re,oe.mode,ue),re.return=oe,re;case k:return re=Cl(re),xe(oe,re,ue)}if(W(re)||U(re))return re=_l(re,oe.mode,ue,null),re.return=oe,re;if(typeof re.then=="function")return xe(oe,Np(re),ue);if(re.$$typeof===N)return xe(oe,Ap(oe,re),ue);Dp(oe,re)}return null}function fe(oe,re,ue,ye){var Ge=re!==null?re.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint")return Ge!==null?null:$(oe,re,""+ue,ye);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case b:return ue.key===Ge?Z(oe,re,ue,ye):null;case w:return ue.key===Ge?de(oe,re,ue,ye):null;case k:return ue=Cl(ue),fe(oe,re,ue,ye)}if(W(ue)||U(ue))return Ge!==null?null:ve(oe,re,ue,ye,null);if(typeof ue.then=="function")return fe(oe,re,Np(ue),ye);if(ue.$$typeof===N)return fe(oe,re,Ap(oe,ue),ye);Dp(oe,ue)}return null}function me(oe,re,ue,ye,Ge){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return oe=oe.get(ue)||null,$(re,oe,""+ye,Ge);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case b:return oe=oe.get(ye.key===null?ue:ye.key)||null,Z(re,oe,ye,Ge);case w:return oe=oe.get(ye.key===null?ue:ye.key)||null,de(re,oe,ye,Ge);case k:return ye=Cl(ye),me(oe,re,ue,ye,Ge)}if(W(ye)||U(ye))return oe=oe.get(ue)||null,ve(re,oe,ye,Ge,null);if(typeof ye.then=="function")return me(oe,re,ue,Np(ye),Ge);if(ye.$$typeof===N)return me(oe,re,ue,Ap(re,ye),Ge);Dp(re,ye)}return null}function je(oe,re,ue,ye){for(var Ge=null,Ct=null,Ue=re,dt=re=0,vt=null;Ue!==null&&dt<ue.length;dt++){Ue.index>dt?(vt=Ue,Ue=null):vt=Ue.sibling;var kt=fe(oe,Ue,ue[dt],ye);if(kt===null){Ue===null&&(Ue=vt);break}s&&Ue&&kt.alternate===null&&l(oe,Ue),re=_(kt,re,dt),Ct===null?Ge=kt:Ct.sibling=kt,Ct=kt,Ue=vt}if(dt===ue.length)return f(oe,Ue),Et&&es(oe,dt),Ge;if(Ue===null){for(;dt<ue.length;dt++)Ue=xe(oe,ue[dt],ye),Ue!==null&&(re=_(Ue,re,dt),Ct===null?Ge=Ue:Ct.sibling=Ue,Ct=Ue);return Et&&es(oe,dt),Ge}for(Ue=g(Ue);dt<ue.length;dt++)vt=me(Ue,oe,dt,ue[dt],ye),vt!==null&&(s&&vt.alternate!==null&&Ue.delete(vt.key===null?dt:vt.key),re=_(vt,re,dt),Ct===null?Ge=vt:Ct.sibling=vt,Ct=vt);return s&&Ue.forEach(function(vo){return l(oe,vo)}),Et&&es(oe,dt),Ge}function Xe(oe,re,ue,ye){if(ue==null)throw Error(r(151));for(var Ge=null,Ct=null,Ue=re,dt=re=0,vt=null,kt=ue.next();Ue!==null&&!kt.done;dt++,kt=ue.next()){Ue.index>dt?(vt=Ue,Ue=null):vt=Ue.sibling;var vo=fe(oe,Ue,kt.value,ye);if(vo===null){Ue===null&&(Ue=vt);break}s&&Ue&&vo.alternate===null&&l(oe,Ue),re=_(vo,re,dt),Ct===null?Ge=vo:Ct.sibling=vo,Ct=vo,Ue=vt}if(kt.done)return f(oe,Ue),Et&&es(oe,dt),Ge;if(Ue===null){for(;!kt.done;dt++,kt=ue.next())kt=xe(oe,kt.value,ye),kt!==null&&(re=_(kt,re,dt),Ct===null?Ge=kt:Ct.sibling=kt,Ct=kt);return Et&&es(oe,dt),Ge}for(Ue=g(Ue);!kt.done;dt++,kt=ue.next())kt=me(Ue,oe,dt,kt.value,ye),kt!==null&&(s&&kt.alternate!==null&&Ue.delete(kt.key===null?dt:kt.key),re=_(kt,re,dt),Ct===null?Ge=kt:Ct.sibling=kt,Ct=kt);return s&&Ue.forEach(function(h5){return l(oe,h5)}),Et&&es(oe,dt),Ge}function Ft(oe,re,ue,ye){if(typeof ue=="object"&&ue!==null&&ue.type===E&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case b:e:{for(var Ge=ue.key;re!==null;){if(re.key===Ge){if(Ge=ue.type,Ge===E){if(re.tag===7){f(oe,re.sibling),ye=x(re,ue.props.children),ye.return=oe,oe=ye;break e}}else if(re.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===k&&Cl(Ge)===re.type){f(oe,re.sibling),ye=x(re,ue.props),jd(ye,ue),ye.return=oe,oe=ye;break e}f(oe,re);break}else l(oe,re);re=re.sibling}ue.type===E?(ye=_l(ue.props.children,oe.mode,ye,ue.key),ye.return=oe,oe=ye):(ye=Ep(ue.type,ue.key,ue.props,null,oe.mode,ye),jd(ye,ue),ye.return=oe,oe=ye)}return I(oe);case w:e:{for(Ge=ue.key;re!==null;){if(re.key===Ge)if(re.tag===4&&re.stateNode.containerInfo===ue.containerInfo&&re.stateNode.implementation===ue.implementation){f(oe,re.sibling),ye=x(re,ue.children||[]),ye.return=oe,oe=ye;break e}else{f(oe,re);break}else l(oe,re);re=re.sibling}ye=Av(ue,oe.mode,ye),ye.return=oe,oe=ye}return I(oe);case k:return ue=Cl(ue),Ft(oe,re,ue,ye)}if(W(ue))return je(oe,re,ue,ye);if(U(ue)){if(Ge=U(ue),typeof Ge!="function")throw Error(r(150));return ue=Ge.call(ue),Xe(oe,re,ue,ye)}if(typeof ue.then=="function")return Ft(oe,re,Np(ue),ye);if(ue.$$typeof===N)return Ft(oe,re,Ap(oe,ue),ye);Dp(oe,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint"?(ue=""+ue,re!==null&&re.tag===6?(f(oe,re.sibling),ye=x(re,ue),ye.return=oe,oe=ye):(f(oe,re),ye=Tv(ue,oe.mode,ye),ye.return=oe,oe=ye),I(oe)):f(oe,re)}return function(oe,re,ue,ye){try{Pd=0;var Ge=Ft(oe,re,ue,ye);return jc=null,Ge}catch(Ue){if(Ue===Pc||Ue===kp)throw Ue;var Ct=Wr(29,Ue,null,oe.mode);return Ct.lanes=ye,Ct.return=oe,Ct}finally{}}}var Rl=dS(!0),fS=dS(!1),Js=!1;function zv(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Lv(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function eo(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function to(s,l,f){var g=s.updateQueue;if(g===null)return null;if(g=g.shared,(Dt&2)!==0){var x=g.pending;return x===null?l.next=l:(l.next=x.next,x.next=l),g.pending=l,l=_p(s),WE(s,null,f),l}return wp(s,g,l,f),_p(s)}function Vd(s,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194048)!==0)){var g=l.lanes;g&=s.pendingLanes,f|=g,l.lanes=f,ud(s,f)}}function Bv(s,l){var f=s.updateQueue,g=s.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var x=null,_=null;if(f=f.firstBaseUpdate,f!==null){do{var I={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};_===null?x=_=I:_=_.next=I,f=f.next}while(f!==null);_===null?x=_=l:_=_.next=l}else x=_=l;f={baseState:g.baseState,firstBaseUpdate:x,lastBaseUpdate:_,shared:g.shared,callbacks:g.callbacks},s.updateQueue=f;return}s=f.lastBaseUpdate,s===null?f.firstBaseUpdate=l:s.next=l,f.lastBaseUpdate=l}var Uv=!1;function zd(){if(Uv){var s=Oc;if(s!==null)throw s}}function Ld(s,l,f,g){Uv=!1;var x=s.updateQueue;Js=!1;var _=x.firstBaseUpdate,I=x.lastBaseUpdate,$=x.shared.pending;if($!==null){x.shared.pending=null;var Z=$,de=Z.next;Z.next=null,I===null?_=de:I.next=de,I=Z;var ve=s.alternate;ve!==null&&(ve=ve.updateQueue,$=ve.lastBaseUpdate,$!==I&&($===null?ve.firstBaseUpdate=de:$.next=de,ve.lastBaseUpdate=Z))}if(_!==null){var xe=x.baseState;I=0,ve=de=Z=null,$=_;do{var fe=$.lane&-536870913,me=fe!==$.lane;if(me?(mt&fe)===fe:(g&fe)===fe){fe!==0&&fe===Mc&&(Uv=!0),ve!==null&&(ve=ve.next={lane:0,tag:$.tag,payload:$.payload,callback:null,next:null});e:{var je=s,Xe=$;fe=l;var Ft=f;switch(Xe.tag){case 1:if(je=Xe.payload,typeof je=="function"){xe=je.call(Ft,xe,fe);break e}xe=je;break e;case 3:je.flags=je.flags&-65537|128;case 0:if(je=Xe.payload,fe=typeof je=="function"?je.call(Ft,xe,fe):je,fe==null)break e;xe=p({},xe,fe);break e;case 2:Js=!0}}fe=$.callback,fe!==null&&(s.flags|=64,me&&(s.flags|=8192),me=x.callbacks,me===null?x.callbacks=[fe]:me.push(fe))}else me={lane:fe,tag:$.tag,payload:$.payload,callback:$.callback,next:null},ve===null?(de=ve=me,Z=xe):ve=ve.next=me,I|=fe;if($=$.next,$===null){if($=x.shared.pending,$===null)break;me=$,$=me.next,me.next=null,x.lastBaseUpdate=me,x.shared.pending=null}}while(!0);ve===null&&(Z=xe),x.baseState=Z,x.firstBaseUpdate=de,x.lastBaseUpdate=ve,_===null&&(x.shared.lanes=0),so|=I,s.lanes=I,s.memoizedState=xe}}function hS(s,l){if(typeof s!="function")throw Error(r(191,s));s.call(l)}function pS(s,l){var f=s.callbacks;if(f!==null)for(s.callbacks=null,s=0;s<f.length;s++)hS(f[s],l)}var Vc=F(null),Ip=F(0);function gS(s,l){s=ds,Q(Ip,s),Q(Vc,l),ds=s|l.baseLanes}function Fv(){Q(Ip,ds),Q(Vc,Vc.current)}function $v(){ds=Ip.current,Y(Vc),Y(Ip)}var Kr=F(null),mi=null;function no(s){var l=s.alternate;Q(vn,vn.current&1),Q(Kr,s),mi===null&&(l===null||Vc.current!==null||l.memoizedState!==null)&&(mi=s)}function Gv(s){Q(vn,vn.current),Q(Kr,s),mi===null&&(mi=s)}function mS(s){s.tag===22?(Q(vn,vn.current),Q(Kr,s),mi===null&&(mi=s)):ro()}function ro(){Q(vn,vn.current),Q(Kr,Kr.current)}function Qr(s){Y(Kr),mi===s&&(mi=null),Y(vn)}var vn=F(0);function Mp(s){for(var l=s;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||Ky(f)||Qy(f)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var rs=0,lt=null,Bt=null,kn=null,Op=!1,zc=!1,Nl=!1,Pp=0,Bd=0,Lc=null,rj=0;function un(){throw Error(r(321))}function Hv(s,l){if(l===null)return!1;for(var f=0;f<l.length&&f<s.length;f++)if(!Xr(s[f],l[f]))return!1;return!0}function qv(s,l,f,g,x,_){return rs=_,lt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,q.H=s===null||s.memoizedState===null?JS:oy,Nl=!1,_=f(g,x),Nl=!1,zc&&(_=yS(l,f,g,x)),vS(s),_}function vS(s){q.H=$d;var l=Bt!==null&&Bt.next!==null;if(rs=0,kn=Bt=lt=null,Op=!1,Bd=0,Lc=null,l)throw Error(r(300));s===null||Rn||(s=s.dependencies,s!==null&&Tp(s)&&(Rn=!0))}function yS(s,l,f,g){lt=s;var x=0;do{if(zc&&(Lc=null),Bd=0,zc=!1,25<=x)throw Error(r(301));if(x+=1,kn=Bt=null,s.updateQueue!=null){var _=s.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}q.H=eT,_=l(f,g)}while(zc);return _}function ij(){var s=q.H,l=s.useState()[0];return l=typeof l.then=="function"?Ud(l):l,s=s.useState()[0],(Bt!==null?Bt.memoizedState:null)!==s&&(lt.flags|=1024),l}function Yv(){var s=Pp!==0;return Pp=0,s}function Xv(s,l,f){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~f}function Wv(s){if(Op){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}Op=!1}rs=0,kn=Bt=lt=null,zc=!1,Bd=Pp=0,Lc=null}function vr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kn===null?lt.memoizedState=kn=s:kn=kn.next=s,kn}function yn(){if(Bt===null){var s=lt.alternate;s=s!==null?s.memoizedState:null}else s=Bt.next;var l=kn===null?lt.memoizedState:kn.next;if(l!==null)kn=l,Bt=s;else{if(s===null)throw lt.alternate===null?Error(r(467)):Error(r(310));Bt=s,s={memoizedState:Bt.memoizedState,baseState:Bt.baseState,baseQueue:Bt.baseQueue,queue:Bt.queue,next:null},kn===null?lt.memoizedState=kn=s:kn=kn.next=s}return kn}function jp(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ud(s){var l=Bd;return Bd+=1,Lc===null&&(Lc=[]),s=lS(Lc,s,l),l=lt,(kn===null?l.memoizedState:kn.next)===null&&(l=l.alternate,q.H=l===null||l.memoizedState===null?JS:oy),s}function Vp(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Ud(s);if(s.$$typeof===N)return Qn(s)}throw Error(r(438,String(s)))}function Kv(s){var l=null,f=lt.updateQueue;if(f!==null&&(l=f.memoCache),l==null){var g=lt.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(l={data:g.data.map(function(x){return x.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),f===null&&(f=jp(),lt.updateQueue=f),f.memoCache=l,f=l.data[l.index],f===void 0)for(f=l.data[l.index]=Array(s),g=0;g<s;g++)f[g]=V;return l.index++,f}function is(s,l){return typeof l=="function"?l(s):l}function zp(s){var l=yn();return Qv(l,Bt,s)}function Qv(s,l,f){var g=s.queue;if(g===null)throw Error(r(311));g.lastRenderedReducer=f;var x=s.baseQueue,_=g.pending;if(_!==null){if(x!==null){var I=x.next;x.next=_.next,_.next=I}l.baseQueue=x=_,g.pending=null}if(_=s.baseState,x===null)s.memoizedState=_;else{l=x.next;var $=I=null,Z=null,de=l,ve=!1;do{var xe=de.lane&-536870913;if(xe!==de.lane?(mt&xe)===xe:(rs&xe)===xe){var fe=de.revertLane;if(fe===0)Z!==null&&(Z=Z.next={lane:0,revertLane:0,gesture:null,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null}),xe===Mc&&(ve=!0);else if((rs&fe)===fe){de=de.next,fe===Mc&&(ve=!0);continue}else xe={lane:0,revertLane:de.revertLane,gesture:null,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},Z===null?($=Z=xe,I=_):Z=Z.next=xe,lt.lanes|=fe,so|=fe;xe=de.action,Nl&&f(_,xe),_=de.hasEagerState?de.eagerState:f(_,xe)}else fe={lane:xe,revertLane:de.revertLane,gesture:de.gesture,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},Z===null?($=Z=fe,I=_):Z=Z.next=fe,lt.lanes|=xe,so|=xe;de=de.next}while(de!==null&&de!==l);if(Z===null?I=_:Z.next=$,!Xr(_,s.memoizedState)&&(Rn=!0,ve&&(f=Oc,f!==null)))throw f;s.memoizedState=_,s.baseState=I,s.baseQueue=Z,g.lastRenderedState=_}return x===null&&(g.lanes=0),[s.memoizedState,g.dispatch]}function Zv(s){var l=yn(),f=l.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=s;var g=f.dispatch,x=f.pending,_=l.memoizedState;if(x!==null){f.pending=null;var I=x=x.next;do _=s(_,I.action),I=I.next;while(I!==x);Xr(_,l.memoizedState)||(Rn=!0),l.memoizedState=_,l.baseQueue===null&&(l.baseState=_),f.lastRenderedState=_}return[_,g]}function bS(s,l,f){var g=lt,x=yn(),_=Et;if(_){if(f===void 0)throw Error(r(407));f=f()}else f=l();var I=!Xr((Bt||x).memoizedState,f);if(I&&(x.memoizedState=f,Rn=!0),x=x.queue,ty(_S.bind(null,g,x,s),[s]),x.getSnapshot!==l||I||kn!==null&&kn.memoizedState.tag&1){if(g.flags|=2048,Bc(9,{destroy:void 0},wS.bind(null,g,x,f,l),null),Ht===null)throw Error(r(349));_||(rs&127)!==0||xS(g,l,f)}return f}function xS(s,l,f){s.flags|=16384,s={getSnapshot:l,value:f},l=lt.updateQueue,l===null?(l=jp(),lt.updateQueue=l,l.stores=[s]):(f=l.stores,f===null?l.stores=[s]:f.push(s))}function wS(s,l,f,g){l.value=f,l.getSnapshot=g,ES(l)&&SS(s)}function _S(s,l,f){return f(function(){ES(l)&&SS(s)})}function ES(s){var l=s.getSnapshot;s=s.value;try{var f=l();return!Xr(s,f)}catch{return!0}}function SS(s){var l=wl(s,2);l!==null&&Ir(l,s,2)}function Jv(s){var l=vr();if(typeof s=="function"){var f=s;if(s=f(),Nl){sr(!0);try{f()}finally{sr(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:is,lastRenderedState:s},l}function TS(s,l,f,g){return s.baseState=f,Qv(s,Bt,typeof g=="function"?g:is)}function aj(s,l,f,g,x){if(Up(s))throw Error(r(485));if(s=l.action,s!==null){var _={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(I){_.listeners.push(I)}};q.T!==null?f(!0):_.isTransition=!1,g(_),f=l.pending,f===null?(_.next=l.pending=_,AS(l,_)):(_.next=f.next,l.pending=f.next=_)}}function AS(s,l){var f=l.action,g=l.payload,x=s.state;if(l.isTransition){var _=q.T,I={};q.T=I;try{var $=f(x,g),Z=q.S;Z!==null&&Z(I,$),CS(s,l,$)}catch(de){ey(s,l,de)}finally{_!==null&&I.types!==null&&(_.types=I.types),q.T=_}}else try{_=f(x,g),CS(s,l,_)}catch(de){ey(s,l,de)}}function CS(s,l,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(g){kS(s,l,g)},function(g){return ey(s,l,g)}):kS(s,l,f)}function kS(s,l,f){l.status="fulfilled",l.value=f,RS(l),s.state=f,l=s.pending,l!==null&&(f=l.next,f===l?s.pending=null:(f=f.next,l.next=f,AS(s,f)))}function ey(s,l,f){var g=s.pending;if(s.pending=null,g!==null){g=g.next;do l.status="rejected",l.reason=f,RS(l),l=l.next;while(l!==g)}s.action=null}function RS(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function NS(s,l){return l}function DS(s,l){if(Et){var f=Ht.formState;if(f!==null){e:{var g=lt;if(Et){if(Xt){t:{for(var x=Xt,_=gi;x.nodeType!==8;){if(!_){x=null;break t}if(x=vi(x.nextSibling),x===null){x=null;break t}}_=x.data,x=_==="F!"||_==="F"?x:null}if(x){Xt=vi(x.nextSibling),g=x.data==="F!";break e}}Qs(g)}g=!1}g&&(l=f[0])}}return f=vr(),f.memoizedState=f.baseState=l,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:NS,lastRenderedState:l},f.queue=g,f=KS.bind(null,lt,g),g.dispatch=f,g=Jv(!1),_=sy.bind(null,lt,!1,g.queue),g=vr(),x={state:l,dispatch:null,action:s,pending:null},g.queue=x,f=aj.bind(null,lt,x,_,f),x.dispatch=f,g.memoizedState=s,[l,f,!1]}function IS(s){var l=yn();return MS(l,Bt,s)}function MS(s,l,f){if(l=Qv(s,l,NS)[0],s=zp(is)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var g=Ud(l)}catch(I){throw I===Pc?kp:I}else g=l;l=yn();var x=l.queue,_=x.dispatch;return f!==l.memoizedState&&(lt.flags|=2048,Bc(9,{destroy:void 0},sj.bind(null,x,f),null)),[g,_,s]}function sj(s,l){s.action=l}function OS(s){var l=yn(),f=Bt;if(f!==null)return MS(l,f,s);yn(),l=l.memoizedState,f=yn();var g=f.queue.dispatch;return f.memoizedState=s,[l,g,!1]}function Bc(s,l,f,g){return s={tag:s,create:f,deps:g,inst:l,next:null},l=lt.updateQueue,l===null&&(l=jp(),lt.updateQueue=l),f=l.lastEffect,f===null?l.lastEffect=s.next=s:(g=f.next,f.next=s,s.next=g,l.lastEffect=s),s}function PS(){return yn().memoizedState}function Lp(s,l,f,g){var x=vr();lt.flags|=s,x.memoizedState=Bc(1|l,{destroy:void 0},f,g===void 0?null:g)}function Bp(s,l,f,g){var x=yn();g=g===void 0?null:g;var _=x.memoizedState.inst;Bt!==null&&g!==null&&Hv(g,Bt.memoizedState.deps)?x.memoizedState=Bc(l,_,f,g):(lt.flags|=s,x.memoizedState=Bc(1|l,_,f,g))}function jS(s,l){Lp(8390656,8,s,l)}function ty(s,l){Bp(2048,8,s,l)}function oj(s){lt.flags|=4;var l=lt.updateQueue;if(l===null)l=jp(),lt.updateQueue=l,l.events=[s];else{var f=l.events;f===null?l.events=[s]:f.push(s)}}function VS(s){var l=yn().memoizedState;return oj({ref:l,nextImpl:s}),function(){if((Dt&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}function zS(s,l){return Bp(4,2,s,l)}function LS(s,l){return Bp(4,4,s,l)}function BS(s,l){if(typeof l=="function"){s=s();var f=l(s);return function(){typeof f=="function"?f():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function US(s,l,f){f=f!=null?f.concat([s]):null,Bp(4,4,BS.bind(null,l,s),f)}function ny(){}function FS(s,l){var f=yn();l=l===void 0?null:l;var g=f.memoizedState;return l!==null&&Hv(l,g[1])?g[0]:(f.memoizedState=[s,l],s)}function $S(s,l){var f=yn();l=l===void 0?null:l;var g=f.memoizedState;if(l!==null&&Hv(l,g[1]))return g[0];if(g=s(),Nl){sr(!0);try{s()}finally{sr(!1)}}return f.memoizedState=[g,l],g}function ry(s,l,f){return f===void 0||(rs&1073741824)!==0&&(mt&261930)===0?s.memoizedState=l:(s.memoizedState=f,s=GT(),lt.lanes|=s,so|=s,f)}function GS(s,l,f,g){return Xr(f,l)?f:Vc.current!==null?(s=ry(s,f,g),Xr(s,l)||(Rn=!0),s):(rs&42)===0||(rs&1073741824)!==0&&(mt&261930)===0?(Rn=!0,s.memoizedState=f):(s=GT(),lt.lanes|=s,so|=s,l)}function HS(s,l,f,g,x){var _=K.p;K.p=_!==0&&8>_?_:8;var I=q.T,$={};q.T=$,sy(s,!1,l,f);try{var Z=x(),de=q.S;if(de!==null&&de($,Z),Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var ve=nj(Z,g);Fd(s,l,ve,ei(s))}else Fd(s,l,g,ei(s))}catch(xe){Fd(s,l,{then:function(){},status:"rejected",reason:xe},ei())}finally{K.p=_,I!==null&&$.types!==null&&(I.types=$.types),q.T=I}}function lj(){}function iy(s,l,f,g){if(s.tag!==5)throw Error(r(476));var x=qS(s).queue;HS(s,x,l,te,f===null?lj:function(){return YS(s),f(g)})}function qS(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:te,baseState:te,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:is,lastRenderedState:te},next:null};var f={};return l.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:is,lastRenderedState:f},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function YS(s){var l=qS(s);l.next===null&&(l=s.alternate.memoizedState),Fd(s,l.next.queue,{},ei())}function ay(){return Qn(sf)}function XS(){return yn().memoizedState}function WS(){return yn().memoizedState}function cj(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var f=ei();s=eo(f);var g=to(l,s,f);g!==null&&(Ir(g,l,f),Vd(g,l,f)),l={cache:Ov()},s.payload=l;return}l=l.return}}function uj(s,l,f){var g=ei();f={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Up(s)?QS(l,f):(f=Ev(s,l,f,g),f!==null&&(Ir(f,s,g),ZS(f,l,g)))}function KS(s,l,f){var g=ei();Fd(s,l,f,g)}function Fd(s,l,f,g){var x={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Up(s))QS(l,x);else{var _=s.alternate;if(s.lanes===0&&(_===null||_.lanes===0)&&(_=l.lastRenderedReducer,_!==null))try{var I=l.lastRenderedState,$=_(I,f);if(x.hasEagerState=!0,x.eagerState=$,Xr($,I))return wp(s,l,x,0),Ht===null&&xp(),!1}catch{}finally{}if(f=Ev(s,l,x,g),f!==null)return Ir(f,s,g),ZS(f,l,g),!0}return!1}function sy(s,l,f,g){if(g={lane:2,revertLane:zy(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Up(s)){if(l)throw Error(r(479))}else l=Ev(s,f,g,2),l!==null&&Ir(l,s,2)}function Up(s){var l=s.alternate;return s===lt||l!==null&&l===lt}function QS(s,l){zc=Op=!0;var f=s.pending;f===null?l.next=l:(l.next=f.next,f.next=l),s.pending=l}function ZS(s,l,f){if((f&4194048)!==0){var g=l.lanes;g&=s.pendingLanes,f|=g,l.lanes=f,ud(s,f)}}var $d={readContext:Qn,use:Vp,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useLayoutEffect:un,useInsertionEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useSyncExternalStore:un,useId:un,useHostTransitionStatus:un,useFormState:un,useActionState:un,useOptimistic:un,useMemoCache:un,useCacheRefresh:un};$d.useEffectEvent=un;var JS={readContext:Qn,use:Vp,useCallback:function(s,l){return vr().memoizedState=[s,l===void 0?null:l],s},useContext:Qn,useEffect:jS,useImperativeHandle:function(s,l,f){f=f!=null?f.concat([s]):null,Lp(4194308,4,BS.bind(null,l,s),f)},useLayoutEffect:function(s,l){return Lp(4194308,4,s,l)},useInsertionEffect:function(s,l){Lp(4,2,s,l)},useMemo:function(s,l){var f=vr();l=l===void 0?null:l;var g=s();if(Nl){sr(!0);try{s()}finally{sr(!1)}}return f.memoizedState=[g,l],g},useReducer:function(s,l,f){var g=vr();if(f!==void 0){var x=f(l);if(Nl){sr(!0);try{f(l)}finally{sr(!1)}}}else x=l;return g.memoizedState=g.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},g.queue=s,s=s.dispatch=uj.bind(null,lt,s),[g.memoizedState,s]},useRef:function(s){var l=vr();return s={current:s},l.memoizedState=s},useState:function(s){s=Jv(s);var l=s.queue,f=KS.bind(null,lt,l);return l.dispatch=f,[s.memoizedState,f]},useDebugValue:ny,useDeferredValue:function(s,l){var f=vr();return ry(f,s,l)},useTransition:function(){var s=Jv(!1);return s=HS.bind(null,lt,s.queue,!0,!1),vr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,f){var g=lt,x=vr();if(Et){if(f===void 0)throw Error(r(407));f=f()}else{if(f=l(),Ht===null)throw Error(r(349));(mt&127)!==0||xS(g,l,f)}x.memoizedState=f;var _={value:f,getSnapshot:l};return x.queue=_,jS(_S.bind(null,g,_,s),[s]),g.flags|=2048,Bc(9,{destroy:void 0},wS.bind(null,g,_,f,l),null),f},useId:function(){var s=vr(),l=Ht.identifierPrefix;if(Et){var f=_a,g=wa;f=(g&~(1<<32-tn(g)-1)).toString(32)+f,l="_"+l+"R_"+f,f=Pp++,0<f&&(l+="H"+f.toString(32)),l+="_"}else f=rj++,l="_"+l+"r_"+f.toString(32)+"_";return s.memoizedState=l},useHostTransitionStatus:ay,useFormState:DS,useActionState:DS,useOptimistic:function(s){var l=vr();l.memoizedState=l.baseState=s;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=f,l=sy.bind(null,lt,!0,f),f.dispatch=l,[s,l]},useMemoCache:Kv,useCacheRefresh:function(){return vr().memoizedState=cj.bind(null,lt)},useEffectEvent:function(s){var l=vr(),f={impl:s};return l.memoizedState=f,function(){if((Dt&2)!==0)throw Error(r(440));return f.impl.apply(void 0,arguments)}}},oy={readContext:Qn,use:Vp,useCallback:FS,useContext:Qn,useEffect:ty,useImperativeHandle:US,useInsertionEffect:zS,useLayoutEffect:LS,useMemo:$S,useReducer:zp,useRef:PS,useState:function(){return zp(is)},useDebugValue:ny,useDeferredValue:function(s,l){var f=yn();return GS(f,Bt.memoizedState,s,l)},useTransition:function(){var s=zp(is)[0],l=yn().memoizedState;return[typeof s=="boolean"?s:Ud(s),l]},useSyncExternalStore:bS,useId:XS,useHostTransitionStatus:ay,useFormState:IS,useActionState:IS,useOptimistic:function(s,l){var f=yn();return TS(f,Bt,s,l)},useMemoCache:Kv,useCacheRefresh:WS};oy.useEffectEvent=VS;var eT={readContext:Qn,use:Vp,useCallback:FS,useContext:Qn,useEffect:ty,useImperativeHandle:US,useInsertionEffect:zS,useLayoutEffect:LS,useMemo:$S,useReducer:Zv,useRef:PS,useState:function(){return Zv(is)},useDebugValue:ny,useDeferredValue:function(s,l){var f=yn();return Bt===null?ry(f,s,l):GS(f,Bt.memoizedState,s,l)},useTransition:function(){var s=Zv(is)[0],l=yn().memoizedState;return[typeof s=="boolean"?s:Ud(s),l]},useSyncExternalStore:bS,useId:XS,useHostTransitionStatus:ay,useFormState:OS,useActionState:OS,useOptimistic:function(s,l){var f=yn();return Bt!==null?TS(f,Bt,s,l):(f.baseState=s,[s,f.queue.dispatch])},useMemoCache:Kv,useCacheRefresh:WS};eT.useEffectEvent=VS;function ly(s,l,f,g){l=s.memoizedState,f=f(g,l),f=f==null?l:p({},l,f),s.memoizedState=f,s.lanes===0&&(s.updateQueue.baseState=f)}var cy={enqueueSetState:function(s,l,f){s=s._reactInternals;var g=ei(),x=eo(g);x.payload=l,f!=null&&(x.callback=f),l=to(s,x,g),l!==null&&(Ir(l,s,g),Vd(l,s,g))},enqueueReplaceState:function(s,l,f){s=s._reactInternals;var g=ei(),x=eo(g);x.tag=1,x.payload=l,f!=null&&(x.callback=f),l=to(s,x,g),l!==null&&(Ir(l,s,g),Vd(l,s,g))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var f=ei(),g=eo(f);g.tag=2,l!=null&&(g.callback=l),l=to(s,g,f),l!==null&&(Ir(l,s,f),Vd(l,s,f))}};function tT(s,l,f,g,x,_,I){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(g,_,I):l.prototype&&l.prototype.isPureReactComponent?!Rd(f,g)||!Rd(x,_):!0}function nT(s,l,f,g){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,g),l.state!==s&&cy.enqueueReplaceState(l,l.state,null)}function Dl(s,l){var f=l;if("ref"in l){f={};for(var g in l)g!=="ref"&&(f[g]=l[g])}if(s=s.defaultProps){f===l&&(f=p({},f));for(var x in s)f[x]===void 0&&(f[x]=s[x])}return f}function rT(s){bp(s)}function iT(s){console.error(s)}function aT(s){bp(s)}function Fp(s,l){try{var f=s.onUncaughtError;f(l.value,{componentStack:l.stack})}catch(g){setTimeout(function(){throw g})}}function sT(s,l,f){try{var g=s.onCaughtError;g(f.value,{componentStack:f.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function uy(s,l,f){return f=eo(f),f.tag=3,f.payload={element:null},f.callback=function(){Fp(s,l)},f}function oT(s){return s=eo(s),s.tag=3,s}function lT(s,l,f,g){var x=f.type.getDerivedStateFromError;if(typeof x=="function"){var _=g.value;s.payload=function(){return x(_)},s.callback=function(){sT(l,f,g)}}var I=f.stateNode;I!==null&&typeof I.componentDidCatch=="function"&&(s.callback=function(){sT(l,f,g),typeof x!="function"&&(oo===null?oo=new Set([this]):oo.add(this));var $=g.stack;this.componentDidCatch(g.value,{componentStack:$!==null?$:""})})}function dj(s,l,f,g,x){if(f.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(l=f.alternate,l!==null&&Ic(l,f,x,!0),f=Kr.current,f!==null){switch(f.tag){case 31:case 13:return mi===null?eg():f.alternate===null&&dn===0&&(dn=3),f.flags&=-257,f.flags|=65536,f.lanes=x,g===Rp?f.flags|=16384:(l=f.updateQueue,l===null?f.updateQueue=new Set([g]):l.add(g),Py(s,g,x)),!1;case 22:return f.flags|=65536,g===Rp?f.flags|=16384:(l=f.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([g])},f.updateQueue=l):(f=l.retryQueue,f===null?l.retryQueue=new Set([g]):f.add(g)),Py(s,g,x)),!1}throw Error(r(435,f.tag))}return Py(s,g,x),eg(),!1}if(Et)return l=Kr.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=x,g!==Rv&&(s=Error(r(422),{cause:g}),Id(fi(s,f)))):(g!==Rv&&(l=Error(r(423),{cause:g}),Id(fi(l,f))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,g=fi(g,f),x=uy(s.stateNode,g,x),Bv(s,x),dn!==4&&(dn=2)),!1;var _=Error(r(520),{cause:g});if(_=fi(_,f),Qd===null?Qd=[_]:Qd.push(_),dn!==4&&(dn=2),l===null)return!0;g=fi(g,f),f=l;do{switch(f.tag){case 3:return f.flags|=65536,s=x&-x,f.lanes|=s,s=uy(f.stateNode,g,s),Bv(f,s),!1;case 1:if(l=f.type,_=f.stateNode,(f.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(oo===null||!oo.has(_))))return f.flags|=65536,x&=-x,f.lanes|=x,x=oT(x),lT(x,s,f,g),Bv(f,x),!1}f=f.return}while(f!==null);return!1}var dy=Error(r(461)),Rn=!1;function Zn(s,l,f,g){l.child=s===null?fS(l,null,f,g):Rl(l,s.child,f,g)}function cT(s,l,f,g,x){f=f.render;var _=l.ref;if("ref"in g){var I={};for(var $ in g)$!=="ref"&&(I[$]=g[$])}else I=g;return Tl(l),g=qv(s,l,f,I,_,x),$=Yv(),s!==null&&!Rn?(Xv(s,l,x),as(s,l,x)):(Et&&$&&Cv(l),l.flags|=1,Zn(s,l,g,x),l.child)}function uT(s,l,f,g,x){if(s===null){var _=f.type;return typeof _=="function"&&!Sv(_)&&_.defaultProps===void 0&&f.compare===null?(l.tag=15,l.type=_,dT(s,l,_,g,x)):(s=Ep(f.type,null,g,l,l.mode,x),s.ref=l.ref,s.return=l,l.child=s)}if(_=s.child,!by(s,x)){var I=_.memoizedProps;if(f=f.compare,f=f!==null?f:Rd,f(I,g)&&s.ref===l.ref)return as(s,l,x)}return l.flags|=1,s=Ja(_,g),s.ref=l.ref,s.return=l,l.child=s}function dT(s,l,f,g,x){if(s!==null){var _=s.memoizedProps;if(Rd(_,g)&&s.ref===l.ref)if(Rn=!1,l.pendingProps=g=_,by(s,x))(s.flags&131072)!==0&&(Rn=!0);else return l.lanes=s.lanes,as(s,l,x)}return fy(s,l,f,g,x)}function fT(s,l,f,g){var x=g.children,_=s!==null?s.memoizedState:null;if(s===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((l.flags&128)!==0){if(_=_!==null?_.baseLanes|f:f,s!==null){for(g=l.child=s.child,x=0;g!==null;)x=x|g.lanes|g.childLanes,g=g.sibling;g=x&~_}else g=0,l.child=null;return hT(s,l,_,f,g)}if((f&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&Cp(l,_!==null?_.cachePool:null),_!==null?gS(l,_):Fv(),mS(l);else return g=l.lanes=536870912,hT(s,l,_!==null?_.baseLanes|f:f,f,g)}else _!==null?(Cp(l,_.cachePool),gS(l,_),ro(),l.memoizedState=null):(s!==null&&Cp(l,null),Fv(),ro());return Zn(s,l,x,f),l.child}function Gd(s,l){return s!==null&&s.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function hT(s,l,f,g,x){var _=jv();return _=_===null?null:{parent:Cn._currentValue,pool:_},l.memoizedState={baseLanes:f,cachePool:_},s!==null&&Cp(l,null),Fv(),mS(l),s!==null&&Ic(s,l,g,!0),l.childLanes=x,null}function $p(s,l){return l=Hp({mode:l.mode,children:l.children},s.mode),l.ref=s.ref,s.child=l,l.return=s,l}function pT(s,l,f){return Rl(l,s.child,null,f),s=$p(l,l.pendingProps),s.flags|=2,Qr(l),l.memoizedState=null,s}function fj(s,l,f){var g=l.pendingProps,x=(l.flags&128)!==0;if(l.flags&=-129,s===null){if(Et){if(g.mode==="hidden")return s=$p(l,g),l.lanes=536870912,Gd(null,s);if(Gv(l),(s=Xt)?(s=AA(s,gi),s=s!==null&&s.data==="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:Ws!==null?{id:wa,overflow:_a}:null,retryLane:536870912,hydrationErrors:null},f=QE(s),f.return=l,l.child=f,Kn=l,Xt=null)):s=null,s===null)throw Qs(l);return l.lanes=536870912,null}return $p(l,g)}var _=s.memoizedState;if(_!==null){var I=_.dehydrated;if(Gv(l),x)if(l.flags&256)l.flags&=-257,l=pT(s,l,f);else if(l.memoizedState!==null)l.child=s.child,l.flags|=128,l=null;else throw Error(r(558));else if(Rn||Ic(s,l,f,!1),x=(f&s.childLanes)!==0,Rn||x){if(g=Ht,g!==null&&(I=dd(g,f),I!==0&&I!==_.retryLane))throw _.retryLane=I,wl(s,I),Ir(g,s,I),dy;eg(),l=pT(s,l,f)}else s=_.treeContext,Xt=vi(I.nextSibling),Kn=l,Et=!0,Ks=null,gi=!1,s!==null&&eS(l,s),l=$p(l,g),l.flags|=4096;return l}return s=Ja(s.child,{mode:g.mode,children:g.children}),s.ref=l.ref,l.child=s,s.return=l,s}function Gp(s,l){var f=l.ref;if(f===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(r(284));(s===null||s.ref!==f)&&(l.flags|=4194816)}}function fy(s,l,f,g,x){return Tl(l),f=qv(s,l,f,g,void 0,x),g=Yv(),s!==null&&!Rn?(Xv(s,l,x),as(s,l,x)):(Et&&g&&Cv(l),l.flags|=1,Zn(s,l,f,x),l.child)}function gT(s,l,f,g,x,_){return Tl(l),l.updateQueue=null,f=yS(l,g,f,x),vS(s),g=Yv(),s!==null&&!Rn?(Xv(s,l,_),as(s,l,_)):(Et&&g&&Cv(l),l.flags|=1,Zn(s,l,f,_),l.child)}function mT(s,l,f,g,x){if(Tl(l),l.stateNode===null){var _=kc,I=f.contextType;typeof I=="object"&&I!==null&&(_=Qn(I)),_=new f(g,_),l.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=cy,l.stateNode=_,_._reactInternals=l,_=l.stateNode,_.props=g,_.state=l.memoizedState,_.refs={},zv(l),I=f.contextType,_.context=typeof I=="object"&&I!==null?Qn(I):kc,_.state=l.memoizedState,I=f.getDerivedStateFromProps,typeof I=="function"&&(ly(l,f,I,g),_.state=l.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(I=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),I!==_.state&&cy.enqueueReplaceState(_,_.state,null),Ld(l,g,_,x),zd(),_.state=l.memoizedState),typeof _.componentDidMount=="function"&&(l.flags|=4194308),g=!0}else if(s===null){_=l.stateNode;var $=l.memoizedProps,Z=Dl(f,$);_.props=Z;var de=_.context,ve=f.contextType;I=kc,typeof ve=="object"&&ve!==null&&(I=Qn(ve));var xe=f.getDerivedStateFromProps;ve=typeof xe=="function"||typeof _.getSnapshotBeforeUpdate=="function",$=l.pendingProps!==$,ve||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||($||de!==I)&&nT(l,_,g,I),Js=!1;var fe=l.memoizedState;_.state=fe,Ld(l,g,_,x),zd(),de=l.memoizedState,$||fe!==de||Js?(typeof xe=="function"&&(ly(l,f,xe,g),de=l.memoizedState),(Z=Js||tT(l,f,Z,g,fe,de,I))?(ve||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(l.flags|=4194308)):(typeof _.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=de),_.props=g,_.state=de,_.context=I,g=Z):(typeof _.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{_=l.stateNode,Lv(s,l),I=l.memoizedProps,ve=Dl(f,I),_.props=ve,xe=l.pendingProps,fe=_.context,de=f.contextType,Z=kc,typeof de=="object"&&de!==null&&(Z=Qn(de)),$=f.getDerivedStateFromProps,(de=typeof $=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(I!==xe||fe!==Z)&&nT(l,_,g,Z),Js=!1,fe=l.memoizedState,_.state=fe,Ld(l,g,_,x),zd();var me=l.memoizedState;I!==xe||fe!==me||Js||s!==null&&s.dependencies!==null&&Tp(s.dependencies)?(typeof $=="function"&&(ly(l,f,$,g),me=l.memoizedState),(ve=Js||tT(l,f,ve,g,fe,me,Z)||s!==null&&s.dependencies!==null&&Tp(s.dependencies))?(de||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(g,me,Z),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(g,me,Z)),typeof _.componentDidUpdate=="function"&&(l.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof _.componentDidUpdate!="function"||I===s.memoizedProps&&fe===s.memoizedState||(l.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||I===s.memoizedProps&&fe===s.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=me),_.props=g,_.state=me,_.context=Z,g=ve):(typeof _.componentDidUpdate!="function"||I===s.memoizedProps&&fe===s.memoizedState||(l.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||I===s.memoizedProps&&fe===s.memoizedState||(l.flags|=1024),g=!1)}return _=g,Gp(s,l),g=(l.flags&128)!==0,_||g?(_=l.stateNode,f=g&&typeof f.getDerivedStateFromError!="function"?null:_.render(),l.flags|=1,s!==null&&g?(l.child=Rl(l,s.child,null,x),l.child=Rl(l,null,f,x)):Zn(s,l,f,x),l.memoizedState=_.state,s=l.child):s=as(s,l,x),s}function vT(s,l,f,g){return El(),l.flags|=256,Zn(s,l,f,g),l.child}var hy={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function py(s){return{baseLanes:s,cachePool:sS()}}function gy(s,l,f){return s=s!==null?s.childLanes&~f:0,l&&(s|=Jr),s}function yT(s,l,f){var g=l.pendingProps,x=!1,_=(l.flags&128)!==0,I;if((I=_)||(I=s!==null&&s.memoizedState===null?!1:(vn.current&2)!==0),I&&(x=!0,l.flags&=-129),I=(l.flags&32)!==0,l.flags&=-33,s===null){if(Et){if(x?no(l):ro(),(s=Xt)?(s=AA(s,gi),s=s!==null&&s.data!=="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:Ws!==null?{id:wa,overflow:_a}:null,retryLane:536870912,hydrationErrors:null},f=QE(s),f.return=l,l.child=f,Kn=l,Xt=null)):s=null,s===null)throw Qs(l);return Qy(s)?l.lanes=32:l.lanes=536870912,null}var $=g.children;return g=g.fallback,x?(ro(),x=l.mode,$=Hp({mode:"hidden",children:$},x),g=_l(g,x,f,null),$.return=l,g.return=l,$.sibling=g,l.child=$,g=l.child,g.memoizedState=py(f),g.childLanes=gy(s,I,f),l.memoizedState=hy,Gd(null,g)):(no(l),my(l,$))}var Z=s.memoizedState;if(Z!==null&&($=Z.dehydrated,$!==null)){if(_)l.flags&256?(no(l),l.flags&=-257,l=vy(s,l,f)):l.memoizedState!==null?(ro(),l.child=s.child,l.flags|=128,l=null):(ro(),$=g.fallback,x=l.mode,g=Hp({mode:"visible",children:g.children},x),$=_l($,x,f,null),$.flags|=2,g.return=l,$.return=l,g.sibling=$,l.child=g,Rl(l,s.child,null,f),g=l.child,g.memoizedState=py(f),g.childLanes=gy(s,I,f),l.memoizedState=hy,l=Gd(null,g));else if(no(l),Qy($)){if(I=$.nextSibling&&$.nextSibling.dataset,I)var de=I.dgst;I=de,g=Error(r(419)),g.stack="",g.digest=I,Id({value:g,source:null,stack:null}),l=vy(s,l,f)}else if(Rn||Ic(s,l,f,!1),I=(f&s.childLanes)!==0,Rn||I){if(I=Ht,I!==null&&(g=dd(I,f),g!==0&&g!==Z.retryLane))throw Z.retryLane=g,wl(s,g),Ir(I,s,g),dy;Ky($)||eg(),l=vy(s,l,f)}else Ky($)?(l.flags|=192,l.child=s.child,l=null):(s=Z.treeContext,Xt=vi($.nextSibling),Kn=l,Et=!0,Ks=null,gi=!1,s!==null&&eS(l,s),l=my(l,g.children),l.flags|=4096);return l}return x?(ro(),$=g.fallback,x=l.mode,Z=s.child,de=Z.sibling,g=Ja(Z,{mode:"hidden",children:g.children}),g.subtreeFlags=Z.subtreeFlags&65011712,de!==null?$=Ja(de,$):($=_l($,x,f,null),$.flags|=2),$.return=l,g.return=l,g.sibling=$,l.child=g,Gd(null,g),g=l.child,$=s.child.memoizedState,$===null?$=py(f):(x=$.cachePool,x!==null?(Z=Cn._currentValue,x=x.parent!==Z?{parent:Z,pool:Z}:x):x=sS(),$={baseLanes:$.baseLanes|f,cachePool:x}),g.memoizedState=$,g.childLanes=gy(s,I,f),l.memoizedState=hy,Gd(s.child,g)):(no(l),f=s.child,s=f.sibling,f=Ja(f,{mode:"visible",children:g.children}),f.return=l,f.sibling=null,s!==null&&(I=l.deletions,I===null?(l.deletions=[s],l.flags|=16):I.push(s)),l.child=f,l.memoizedState=null,f)}function my(s,l){return l=Hp({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function Hp(s,l){return s=Wr(22,s,null,l),s.lanes=0,s}function vy(s,l,f){return Rl(l,s.child,null,f),s=my(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function bT(s,l,f){s.lanes|=l;var g=s.alternate;g!==null&&(g.lanes|=l),Iv(s.return,l,f)}function yy(s,l,f,g,x,_){var I=s.memoizedState;I===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:x,treeForkCount:_}:(I.isBackwards=l,I.rendering=null,I.renderingStartTime=0,I.last=g,I.tail=f,I.tailMode=x,I.treeForkCount=_)}function xT(s,l,f){var g=l.pendingProps,x=g.revealOrder,_=g.tail;g=g.children;var I=vn.current,$=(I&2)!==0;if($?(I=I&1|2,l.flags|=128):I&=1,Q(vn,I),Zn(s,l,g,f),g=Et?Dd:0,!$&&s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&bT(s,f,l);else if(s.tag===19)bT(s,f,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(x){case"forwards":for(f=l.child,x=null;f!==null;)s=f.alternate,s!==null&&Mp(s)===null&&(x=f),f=f.sibling;f=x,f===null?(x=l.child,l.child=null):(x=f.sibling,f.sibling=null),yy(l,!1,x,f,_,g);break;case"backwards":case"unstable_legacy-backwards":for(f=null,x=l.child,l.child=null;x!==null;){if(s=x.alternate,s!==null&&Mp(s)===null){l.child=x;break}s=x.sibling,x.sibling=f,f=x,x=s}yy(l,!0,f,null,_,g);break;case"together":yy(l,!1,null,null,void 0,g);break;default:l.memoizedState=null}return l.child}function as(s,l,f){if(s!==null&&(l.dependencies=s.dependencies),so|=l.lanes,(f&l.childLanes)===0)if(s!==null){if(Ic(s,l,f,!1),(f&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(r(153));if(l.child!==null){for(s=l.child,f=Ja(s,s.pendingProps),l.child=f,f.return=l;s.sibling!==null;)s=s.sibling,f=f.sibling=Ja(s,s.pendingProps),f.return=l;f.sibling=null}return l.child}function by(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&Tp(s)))}function hj(s,l,f){switch(l.tag){case 3:pe(l,l.stateNode.containerInfo),Zs(l,Cn,s.memoizedState.cache),El();break;case 27:case 5:Ie(l);break;case 4:pe(l,l.stateNode.containerInfo);break;case 10:Zs(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,Gv(l),null;break;case 13:var g=l.memoizedState;if(g!==null)return g.dehydrated!==null?(no(l),l.flags|=128,null):(f&l.child.childLanes)!==0?yT(s,l,f):(no(l),s=as(s,l,f),s!==null?s.sibling:null);no(l);break;case 19:var x=(s.flags&128)!==0;if(g=(f&l.childLanes)!==0,g||(Ic(s,l,f,!1),g=(f&l.childLanes)!==0),x){if(g)return xT(s,l,f);l.flags|=128}if(x=l.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),Q(vn,vn.current),g)break;return null;case 22:return l.lanes=0,fT(s,l,f,l.pendingProps);case 24:Zs(l,Cn,s.memoizedState.cache)}return as(s,l,f)}function wT(s,l,f){if(s!==null)if(s.memoizedProps!==l.pendingProps)Rn=!0;else{if(!by(s,f)&&(l.flags&128)===0)return Rn=!1,hj(s,l,f);Rn=(s.flags&131072)!==0}else Rn=!1,Et&&(l.flags&1048576)!==0&&JE(l,Dd,l.index);switch(l.lanes=0,l.tag){case 16:e:{var g=l.pendingProps;if(s=Cl(l.elementType),l.type=s,typeof s=="function")Sv(s)?(g=Dl(s,g),l.tag=1,l=mT(null,l,s,g,f)):(l.tag=0,l=fy(null,l,s,g,f));else{if(s!=null){var x=s.$$typeof;if(x===j){l.tag=11,l=cT(null,l,s,g,f);break e}else if(x===A){l.tag=14,l=uT(null,l,s,g,f);break e}}throw l=J(s)||s,Error(r(306,l,""))}}return l;case 0:return fy(s,l,l.type,l.pendingProps,f);case 1:return g=l.type,x=Dl(g,l.pendingProps),mT(s,l,g,x,f);case 3:e:{if(pe(l,l.stateNode.containerInfo),s===null)throw Error(r(387));g=l.pendingProps;var _=l.memoizedState;x=_.element,Lv(s,l),Ld(l,g,null,f);var I=l.memoizedState;if(g=I.cache,Zs(l,Cn,g),g!==_.cache&&Mv(l,[Cn],f,!0),zd(),g=I.element,_.isDehydrated)if(_={element:g,isDehydrated:!1,cache:I.cache},l.updateQueue.baseState=_,l.memoizedState=_,l.flags&256){l=vT(s,l,g,f);break e}else if(g!==x){x=fi(Error(r(424)),l),Id(x),l=vT(s,l,g,f);break e}else{switch(s=l.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Xt=vi(s.firstChild),Kn=l,Et=!0,Ks=null,gi=!0,f=fS(l,null,g,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(El(),g===x){l=as(s,l,f);break e}Zn(s,l,g,f)}l=l.child}return l;case 26:return Gp(s,l),s===null?(f=IA(l.type,null,l.pendingProps,null))?l.memoizedState=f:Et||(f=l.type,s=l.pendingProps,g=og(le.current).createElement(f),g[Sn]=l,g[Hn]=s,Jn(g,f,s),Tn(g),l.stateNode=g):l.memoizedState=IA(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return Ie(l),s===null&&Et&&(g=l.stateNode=RA(l.type,l.pendingProps,le.current),Kn=l,gi=!0,x=Xt,fo(l.type)?(Zy=x,Xt=vi(g.firstChild)):Xt=x),Zn(s,l,l.pendingProps.children,f),Gp(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&Et&&((x=g=Xt)&&(g=$j(g,l.type,l.pendingProps,gi),g!==null?(l.stateNode=g,Kn=l,Xt=vi(g.firstChild),gi=!1,x=!0):x=!1),x||Qs(l)),Ie(l),x=l.type,_=l.pendingProps,I=s!==null?s.memoizedProps:null,g=_.children,Yy(x,_)?g=null:I!==null&&Yy(x,I)&&(l.flags|=32),l.memoizedState!==null&&(x=qv(s,l,ij,null,null,f),sf._currentValue=x),Gp(s,l),Zn(s,l,g,f),l.child;case 6:return s===null&&Et&&((s=f=Xt)&&(f=Gj(f,l.pendingProps,gi),f!==null?(l.stateNode=f,Kn=l,Xt=null,s=!0):s=!1),s||Qs(l)),null;case 13:return yT(s,l,f);case 4:return pe(l,l.stateNode.containerInfo),g=l.pendingProps,s===null?l.child=Rl(l,null,g,f):Zn(s,l,g,f),l.child;case 11:return cT(s,l,l.type,l.pendingProps,f);case 7:return Zn(s,l,l.pendingProps,f),l.child;case 8:return Zn(s,l,l.pendingProps.children,f),l.child;case 12:return Zn(s,l,l.pendingProps.children,f),l.child;case 10:return g=l.pendingProps,Zs(l,l.type,g.value),Zn(s,l,g.children,f),l.child;case 9:return x=l.type._context,g=l.pendingProps.children,Tl(l),x=Qn(x),g=g(x),l.flags|=1,Zn(s,l,g,f),l.child;case 14:return uT(s,l,l.type,l.pendingProps,f);case 15:return dT(s,l,l.type,l.pendingProps,f);case 19:return xT(s,l,f);case 31:return fj(s,l,f);case 22:return fT(s,l,f,l.pendingProps);case 24:return Tl(l),g=Qn(Cn),s===null?(x=jv(),x===null&&(x=Ht,_=Ov(),x.pooledCache=_,_.refCount++,_!==null&&(x.pooledCacheLanes|=f),x=_),l.memoizedState={parent:g,cache:x},zv(l),Zs(l,Cn,x)):((s.lanes&f)!==0&&(Lv(s,l),Ld(l,null,null,f),zd()),x=s.memoizedState,_=l.memoizedState,x.parent!==g?(x={parent:g,cache:g},l.memoizedState=x,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=x),Zs(l,Cn,g)):(g=_.cache,Zs(l,Cn,g),g!==x.cache&&Mv(l,[Cn],f,!0))),Zn(s,l,l.pendingProps.children,f),l.child;case 29:throw l.pendingProps}throw Error(r(156,l.tag))}function ss(s){s.flags|=4}function xy(s,l,f,g,x){if((l=(s.mode&32)!==0)&&(l=!1),l){if(s.flags|=16777216,(x&335544128)===x)if(s.stateNode.complete)s.flags|=8192;else if(XT())s.flags|=8192;else throw kl=Rp,Vv}else s.flags&=-16777217}function _T(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!VA(l))if(XT())s.flags|=8192;else throw kl=Rp,Vv}function qp(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?Zh():536870912,s.lanes|=l,Gc|=l)}function Hd(s,l){if(!Et)switch(s.tailMode){case"hidden":l=s.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s.tail=null:f.sibling=null;break;case"collapsed":f=s.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:g.sibling=null}}function Wt(s){var l=s.alternate!==null&&s.alternate.child===s.child,f=0,g=0;if(l)for(var x=s.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags&65011712,g|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags,g|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=g,s.childLanes=f,l}function pj(s,l,f){var g=l.pendingProps;switch(kv(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wt(l),null;case 1:return Wt(l),null;case 3:return f=l.stateNode,g=null,s!==null&&(g=s.memoizedState.cache),l.memoizedState.cache!==g&&(l.flags|=2048),ns(Cn),_e(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(Dc(l)?ss(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Nv())),Wt(l),null;case 26:var x=l.type,_=l.memoizedState;return s===null?(ss(l),_!==null?(Wt(l),_T(l,_)):(Wt(l),xy(l,x,null,g,f))):_?_!==s.memoizedState?(ss(l),Wt(l),_T(l,_)):(Wt(l),l.flags&=-16777217):(s=s.memoizedProps,s!==g&&ss(l),Wt(l),xy(l,x,s,g,f)),null;case 27:if(ae(l),f=le.current,x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==g&&ss(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return Wt(l),null}s=X.current,Dc(l)?tS(l):(s=RA(x,g,f),l.stateNode=s,ss(l))}return Wt(l),null;case 5:if(ae(l),x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==g&&ss(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return Wt(l),null}if(_=X.current,Dc(l))tS(l);else{var I=og(le.current);switch(_){case 1:_=I.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:_=I.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":_=I.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":_=I.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":_=I.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof g.is=="string"?I.createElement("select",{is:g.is}):I.createElement("select"),g.multiple?_.multiple=!0:g.size&&(_.size=g.size);break;default:_=typeof g.is=="string"?I.createElement(x,{is:g.is}):I.createElement(x)}}_[Sn]=l,_[Hn]=g;e:for(I=l.child;I!==null;){if(I.tag===5||I.tag===6)_.appendChild(I.stateNode);else if(I.tag!==4&&I.tag!==27&&I.child!==null){I.child.return=I,I=I.child;continue}if(I===l)break e;for(;I.sibling===null;){if(I.return===null||I.return===l)break e;I=I.return}I.sibling.return=I.return,I=I.sibling}l.stateNode=_;e:switch(Jn(_,x,g),x){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&ss(l)}}return Wt(l),xy(l,l.type,s===null?null:s.memoizedProps,l.pendingProps,f),null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==g&&ss(l);else{if(typeof g!="string"&&l.stateNode===null)throw Error(r(166));if(s=le.current,Dc(l)){if(s=l.stateNode,f=l.memoizedProps,g=null,x=Kn,x!==null)switch(x.tag){case 27:case 5:g=x.memoizedProps}s[Sn]=l,s=!!(s.nodeValue===f||g!==null&&g.suppressHydrationWarning===!0||yA(s.nodeValue,f)),s||Qs(l,!0)}else s=og(s).createTextNode(g),s[Sn]=l,l.stateNode=s}return Wt(l),null;case 31:if(f=l.memoizedState,s===null||s.memoizedState!==null){if(g=Dc(l),f!==null){if(s===null){if(!g)throw Error(r(318));if(s=l.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(557));s[Sn]=l}else El(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Wt(l),s=!1}else f=Nv(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),s=!0;if(!s)return l.flags&256?(Qr(l),l):(Qr(l),null);if((l.flags&128)!==0)throw Error(r(558))}return Wt(l),null;case 13:if(g=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=Dc(l),g!==null&&g.dehydrated!==null){if(s===null){if(!x)throw Error(r(318));if(x=l.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[Sn]=l}else El(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Wt(l),x=!1}else x=Nv(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return l.flags&256?(Qr(l),l):(Qr(l),null)}return Qr(l),(l.flags&128)!==0?(l.lanes=f,l):(f=g!==null,s=s!==null&&s.memoizedState!==null,f&&(g=l.child,x=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(x=g.alternate.memoizedState.cachePool.pool),_=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(_=g.memoizedState.cachePool.pool),_!==x&&(g.flags|=2048)),f!==s&&f&&(l.child.flags|=8192),qp(l,l.updateQueue),Wt(l),null);case 4:return _e(),s===null&&Fy(l.stateNode.containerInfo),Wt(l),null;case 10:return ns(l.type),Wt(l),null;case 19:if(Y(vn),g=l.memoizedState,g===null)return Wt(l),null;if(x=(l.flags&128)!==0,_=g.rendering,_===null)if(x)Hd(g,!1);else{if(dn!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(_=Mp(s),_!==null){for(l.flags|=128,Hd(g,!1),s=_.updateQueue,l.updateQueue=s,qp(l,s),l.subtreeFlags=0,s=f,f=l.child;f!==null;)KE(f,s),f=f.sibling;return Q(vn,vn.current&1|2),Et&&es(l,g.treeForkCount),l.child}s=s.sibling}g.tail!==null&&ut()>Qp&&(l.flags|=128,x=!0,Hd(g,!1),l.lanes=4194304)}else{if(!x)if(s=Mp(_),s!==null){if(l.flags|=128,x=!0,s=s.updateQueue,l.updateQueue=s,qp(l,s),Hd(g,!0),g.tail===null&&g.tailMode==="hidden"&&!_.alternate&&!Et)return Wt(l),null}else 2*ut()-g.renderingStartTime>Qp&&f!==536870912&&(l.flags|=128,x=!0,Hd(g,!1),l.lanes=4194304);g.isBackwards?(_.sibling=l.child,l.child=_):(s=g.last,s!==null?s.sibling=_:l.child=_,g.last=_)}return g.tail!==null?(s=g.tail,g.rendering=s,g.tail=s.sibling,g.renderingStartTime=ut(),s.sibling=null,f=vn.current,Q(vn,x?f&1|2:f&1),Et&&es(l,g.treeForkCount),s):(Wt(l),null);case 22:case 23:return Qr(l),$v(),g=l.memoizedState!==null,s!==null?s.memoizedState!==null!==g&&(l.flags|=8192):g&&(l.flags|=8192),g?(f&536870912)!==0&&(l.flags&128)===0&&(Wt(l),l.subtreeFlags&6&&(l.flags|=8192)):Wt(l),f=l.updateQueue,f!==null&&qp(l,f.retryQueue),f=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),g=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),g!==f&&(l.flags|=2048),s!==null&&Y(Al),null;case 24:return f=null,s!==null&&(f=s.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),ns(Cn),Wt(l),null;case 25:return null;case 30:return null}throw Error(r(156,l.tag))}function gj(s,l){switch(kv(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return ns(Cn),_e(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return ae(l),null;case 31:if(l.memoizedState!==null){if(Qr(l),l.alternate===null)throw Error(r(340));El()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 13:if(Qr(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(r(340));El()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return Y(vn),null;case 4:return _e(),null;case 10:return ns(l.type),null;case 22:case 23:return Qr(l),$v(),s!==null&&Y(Al),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return ns(Cn),null;case 25:return null;default:return null}}function ET(s,l){switch(kv(l),l.tag){case 3:ns(Cn),_e();break;case 26:case 27:case 5:ae(l);break;case 4:_e();break;case 31:l.memoizedState!==null&&Qr(l);break;case 13:Qr(l);break;case 19:Y(vn);break;case 10:ns(l.type);break;case 22:case 23:Qr(l),$v(),s!==null&&Y(Al);break;case 24:ns(Cn)}}function qd(s,l){try{var f=l.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var x=g.next;f=x;do{if((f.tag&s)===s){g=void 0;var _=f.create,I=f.inst;g=_(),I.destroy=g}f=f.next}while(f!==x)}}catch($){Vt(l,l.return,$)}}function io(s,l,f){try{var g=l.updateQueue,x=g!==null?g.lastEffect:null;if(x!==null){var _=x.next;g=_;do{if((g.tag&s)===s){var I=g.inst,$=I.destroy;if($!==void 0){I.destroy=void 0,x=l;var Z=f,de=$;try{de()}catch(ve){Vt(x,Z,ve)}}}g=g.next}while(g!==_)}}catch(ve){Vt(l,l.return,ve)}}function ST(s){var l=s.updateQueue;if(l!==null){var f=s.stateNode;try{pS(l,f)}catch(g){Vt(s,s.return,g)}}}function TT(s,l,f){f.props=Dl(s.type,s.memoizedProps),f.state=s.memoizedState;try{f.componentWillUnmount()}catch(g){Vt(s,l,g)}}function Yd(s,l){try{var f=s.ref;if(f!==null){switch(s.tag){case 26:case 27:case 5:var g=s.stateNode;break;case 30:g=s.stateNode;break;default:g=s.stateNode}typeof f=="function"?s.refCleanup=f(g):f.current=g}}catch(x){Vt(s,l,x)}}function Ea(s,l){var f=s.ref,g=s.refCleanup;if(f!==null)if(typeof g=="function")try{g()}catch(x){Vt(s,l,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(x){Vt(s,l,x)}else f.current=null}function AT(s){var l=s.type,f=s.memoizedProps,g=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":f.autoFocus&&g.focus();break e;case"img":f.src?g.src=f.src:f.srcSet&&(g.srcset=f.srcSet)}}catch(x){Vt(s,s.return,x)}}function wy(s,l,f){try{var g=s.stateNode;Vj(g,s.type,f,l),g[Hn]=l}catch(x){Vt(s,s.return,x)}}function CT(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&fo(s.type)||s.tag===4}function _y(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||CT(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&fo(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Ey(s,l,f){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(s,l):(l=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,l.appendChild(s),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=ji));else if(g!==4&&(g===27&&fo(s.type)&&(f=s.stateNode,l=null),s=s.child,s!==null))for(Ey(s,l,f),s=s.sibling;s!==null;)Ey(s,l,f),s=s.sibling}function Yp(s,l,f){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?f.insertBefore(s,l):f.appendChild(s);else if(g!==4&&(g===27&&fo(s.type)&&(f=s.stateNode),s=s.child,s!==null))for(Yp(s,l,f),s=s.sibling;s!==null;)Yp(s,l,f),s=s.sibling}function kT(s){var l=s.stateNode,f=s.memoizedProps;try{for(var g=s.type,x=l.attributes;x.length;)l.removeAttributeNode(x[0]);Jn(l,g,f),l[Sn]=s,l[Hn]=f}catch(_){Vt(s,s.return,_)}}var os=!1,Nn=!1,Sy=!1,RT=typeof WeakSet=="function"?WeakSet:Set,Yn=null;function mj(s,l){if(s=s.containerInfo,Hy=pg,s=UE(s),vv(s)){if("selectionStart"in s)var f={start:s.selectionStart,end:s.selectionEnd};else e:{f=(f=s.ownerDocument)&&f.defaultView||window;var g=f.getSelection&&f.getSelection();if(g&&g.rangeCount!==0){f=g.anchorNode;var x=g.anchorOffset,_=g.focusNode;g=g.focusOffset;try{f.nodeType,_.nodeType}catch{f=null;break e}var I=0,$=-1,Z=-1,de=0,ve=0,xe=s,fe=null;t:for(;;){for(var me;xe!==f||x!==0&&xe.nodeType!==3||($=I+x),xe!==_||g!==0&&xe.nodeType!==3||(Z=I+g),xe.nodeType===3&&(I+=xe.nodeValue.length),(me=xe.firstChild)!==null;)fe=xe,xe=me;for(;;){if(xe===s)break t;if(fe===f&&++de===x&&($=I),fe===_&&++ve===g&&(Z=I),(me=xe.nextSibling)!==null)break;xe=fe,fe=xe.parentNode}xe=me}f=$===-1||Z===-1?null:{start:$,end:Z}}else f=null}f=f||{start:0,end:0}}else f=null;for(qy={focusedElem:s,selectionRange:f},pg=!1,Yn=l;Yn!==null;)if(l=Yn,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,Yn=s;else for(;Yn!==null;){switch(l=Yn,_=l.alternate,s=l.flags,l.tag){case 0:if((s&4)!==0&&(s=l.updateQueue,s=s!==null?s.events:null,s!==null))for(f=0;f<s.length;f++)x=s[f],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&_!==null){s=void 0,f=l,x=_.memoizedProps,_=_.memoizedState,g=f.stateNode;try{var je=Dl(f.type,x);s=g.getSnapshotBeforeUpdate(je,_),g.__reactInternalSnapshotBeforeUpdate=s}catch(Xe){Vt(f,f.return,Xe)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,f=s.nodeType,f===9)Wy(s);else if(f===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Wy(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=l.sibling,s!==null){s.return=l.return,Yn=s;break}Yn=l.return}}function NT(s,l,f){var g=f.flags;switch(f.tag){case 0:case 11:case 15:cs(s,f),g&4&&qd(5,f);break;case 1:if(cs(s,f),g&4)if(s=f.stateNode,l===null)try{s.componentDidMount()}catch(I){Vt(f,f.return,I)}else{var x=Dl(f.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(x,l,s.__reactInternalSnapshotBeforeUpdate)}catch(I){Vt(f,f.return,I)}}g&64&&ST(f),g&512&&Yd(f,f.return);break;case 3:if(cs(s,f),g&64&&(s=f.updateQueue,s!==null)){if(l=null,f.child!==null)switch(f.child.tag){case 27:case 5:l=f.child.stateNode;break;case 1:l=f.child.stateNode}try{pS(s,l)}catch(I){Vt(f,f.return,I)}}break;case 27:l===null&&g&4&&kT(f);case 26:case 5:cs(s,f),l===null&&g&4&&AT(f),g&512&&Yd(f,f.return);break;case 12:cs(s,f);break;case 31:cs(s,f),g&4&&MT(s,f);break;case 13:cs(s,f),g&4&&OT(s,f),g&64&&(s=f.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(f=Tj.bind(null,f),Hj(s,f))));break;case 22:if(g=f.memoizedState!==null||os,!g){l=l!==null&&l.memoizedState!==null||Nn,x=os;var _=Nn;os=g,(Nn=l)&&!_?us(s,f,(f.subtreeFlags&8772)!==0):cs(s,f),os=x,Nn=_}break;case 30:break;default:cs(s,f)}}function DT(s){var l=s.alternate;l!==null&&(s.alternate=null,DT(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&pc(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Jt=null,kr=!1;function ls(s,l,f){for(f=f.child;f!==null;)IT(s,l,f),f=f.sibling}function IT(s,l,f){if(En&&typeof En.onCommitFiberUnmount=="function")try{En.onCommitFiberUnmount(Gr,f)}catch{}switch(f.tag){case 26:Nn||Ea(f,l),ls(s,l,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:Nn||Ea(f,l);var g=Jt,x=kr;fo(f.type)&&(Jt=f.stateNode,kr=!1),ls(s,l,f),nf(f.stateNode),Jt=g,kr=x;break;case 5:Nn||Ea(f,l);case 6:if(g=Jt,x=kr,Jt=null,ls(s,l,f),Jt=g,kr=x,Jt!==null)if(kr)try{(Jt.nodeType===9?Jt.body:Jt.nodeName==="HTML"?Jt.ownerDocument.body:Jt).removeChild(f.stateNode)}catch(_){Vt(f,l,_)}else try{Jt.removeChild(f.stateNode)}catch(_){Vt(f,l,_)}break;case 18:Jt!==null&&(kr?(s=Jt,SA(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,f.stateNode),Zc(s)):SA(Jt,f.stateNode));break;case 4:g=Jt,x=kr,Jt=f.stateNode.containerInfo,kr=!0,ls(s,l,f),Jt=g,kr=x;break;case 0:case 11:case 14:case 15:io(2,f,l),Nn||io(4,f,l),ls(s,l,f);break;case 1:Nn||(Ea(f,l),g=f.stateNode,typeof g.componentWillUnmount=="function"&&TT(f,l,g)),ls(s,l,f);break;case 21:ls(s,l,f);break;case 22:Nn=(g=Nn)||f.memoizedState!==null,ls(s,l,f),Nn=g;break;default:ls(s,l,f)}}function MT(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Zc(s)}catch(f){Vt(l,l.return,f)}}}function OT(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Zc(s)}catch(f){Vt(l,l.return,f)}}function vj(s){switch(s.tag){case 31:case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new RT),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new RT),l;default:throw Error(r(435,s.tag))}}function Xp(s,l){var f=vj(s);l.forEach(function(g){if(!f.has(g)){f.add(g);var x=Aj.bind(null,s,g);g.then(x,x)}})}function Rr(s,l){var f=l.deletions;if(f!==null)for(var g=0;g<f.length;g++){var x=f[g],_=s,I=l,$=I;e:for(;$!==null;){switch($.tag){case 27:if(fo($.type)){Jt=$.stateNode,kr=!1;break e}break;case 5:Jt=$.stateNode,kr=!1;break e;case 3:case 4:Jt=$.stateNode.containerInfo,kr=!0;break e}$=$.return}if(Jt===null)throw Error(r(160));IT(_,I,x),Jt=null,kr=!1,_=x.alternate,_!==null&&(_.return=null),x.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)PT(l,s),l=l.sibling}var Fi=null;function PT(s,l){var f=s.alternate,g=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Rr(l,s),Nr(s),g&4&&(io(3,s,s.return),qd(3,s),io(5,s,s.return));break;case 1:Rr(l,s),Nr(s),g&512&&(Nn||f===null||Ea(f,f.return)),g&64&&os&&(s=s.updateQueue,s!==null&&(g=s.callbacks,g!==null&&(f=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=f===null?g:f.concat(g))));break;case 26:var x=Fi;if(Rr(l,s),Nr(s),g&512&&(Nn||f===null||Ea(f,f.return)),g&4){var _=f!==null?f.memoizedState:null;if(g=s.memoizedState,f===null)if(g===null)if(s.stateNode===null){e:{g=s.type,f=s.memoizedProps,x=x.ownerDocument||x;t:switch(g){case"title":_=x.getElementsByTagName("title")[0],(!_||_[ca]||_[Sn]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=x.createElement(g),x.head.insertBefore(_,x.querySelector("head > title"))),Jn(_,g,f),_[Sn]=s,Tn(_),g=_;break e;case"link":var I=PA("link","href",x).get(g+(f.href||""));if(I){for(var $=0;$<I.length;$++)if(_=I[$],_.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&_.getAttribute("rel")===(f.rel==null?null:f.rel)&&_.getAttribute("title")===(f.title==null?null:f.title)&&_.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){I.splice($,1);break t}}_=x.createElement(g),Jn(_,g,f),x.head.appendChild(_);break;case"meta":if(I=PA("meta","content",x).get(g+(f.content||""))){for($=0;$<I.length;$++)if(_=I[$],_.getAttribute("content")===(f.content==null?null:""+f.content)&&_.getAttribute("name")===(f.name==null?null:f.name)&&_.getAttribute("property")===(f.property==null?null:f.property)&&_.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&_.getAttribute("charset")===(f.charSet==null?null:f.charSet)){I.splice($,1);break t}}_=x.createElement(g),Jn(_,g,f),x.head.appendChild(_);break;default:throw Error(r(468,g))}_[Sn]=s,Tn(_),g=_}s.stateNode=g}else jA(x,s.type,s.stateNode);else s.stateNode=OA(x,g,s.memoizedProps);else _!==g?(_===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):_.count--,g===null?jA(x,s.type,s.stateNode):OA(x,g,s.memoizedProps)):g===null&&s.stateNode!==null&&wy(s,s.memoizedProps,f.memoizedProps)}break;case 27:Rr(l,s),Nr(s),g&512&&(Nn||f===null||Ea(f,f.return)),f!==null&&g&4&&wy(s,s.memoizedProps,f.memoizedProps);break;case 5:if(Rr(l,s),Nr(s),g&512&&(Nn||f===null||Ea(f,f.return)),s.flags&32){x=s.stateNode;try{Cr(x,"")}catch(je){Vt(s,s.return,je)}}g&4&&s.stateNode!=null&&(x=s.memoizedProps,wy(s,x,f!==null?f.memoizedProps:x)),g&1024&&(Sy=!0);break;case 6:if(Rr(l,s),Nr(s),g&4){if(s.stateNode===null)throw Error(r(162));g=s.memoizedProps,f=s.stateNode;try{f.nodeValue=g}catch(je){Vt(s,s.return,je)}}break;case 3:if(ug=null,x=Fi,Fi=lg(l.containerInfo),Rr(l,s),Fi=x,Nr(s),g&4&&f!==null&&f.memoizedState.isDehydrated)try{Zc(l.containerInfo)}catch(je){Vt(s,s.return,je)}Sy&&(Sy=!1,jT(s));break;case 4:g=Fi,Fi=lg(s.stateNode.containerInfo),Rr(l,s),Nr(s),Fi=g;break;case 12:Rr(l,s),Nr(s);break;case 31:Rr(l,s),Nr(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Xp(s,g)));break;case 13:Rr(l,s),Nr(s),s.child.flags&8192&&s.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Kp=ut()),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Xp(s,g)));break;case 22:x=s.memoizedState!==null;var Z=f!==null&&f.memoizedState!==null,de=os,ve=Nn;if(os=de||x,Nn=ve||Z,Rr(l,s),Nn=ve,os=de,Nr(s),g&8192)e:for(l=s.stateNode,l._visibility=x?l._visibility&-2:l._visibility|1,x&&(f===null||Z||os||Nn||Il(s)),f=null,l=s;;){if(l.tag===5||l.tag===26){if(f===null){Z=f=l;try{if(_=Z.stateNode,x)I=_.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none";else{$=Z.stateNode;var xe=Z.memoizedProps.style,fe=xe!=null&&xe.hasOwnProperty("display")?xe.display:null;$.style.display=fe==null||typeof fe=="boolean"?"":(""+fe).trim()}}catch(je){Vt(Z,Z.return,je)}}}else if(l.tag===6){if(f===null){Z=l;try{Z.stateNode.nodeValue=x?"":Z.memoizedProps}catch(je){Vt(Z,Z.return,je)}}}else if(l.tag===18){if(f===null){Z=l;try{var me=Z.stateNode;x?TA(me,!0):TA(Z.stateNode,!1)}catch(je){Vt(Z,Z.return,je)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;f===l&&(f=null),l=l.return}f===l&&(f=null),l.sibling.return=l.return,l=l.sibling}g&4&&(g=s.updateQueue,g!==null&&(f=g.retryQueue,f!==null&&(g.retryQueue=null,Xp(s,f))));break;case 19:Rr(l,s),Nr(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Xp(s,g)));break;case 30:break;case 21:break;default:Rr(l,s),Nr(s)}}function Nr(s){var l=s.flags;if(l&2){try{for(var f,g=s.return;g!==null;){if(CT(g)){f=g;break}g=g.return}if(f==null)throw Error(r(160));switch(f.tag){case 27:var x=f.stateNode,_=_y(s);Yp(s,_,x);break;case 5:var I=f.stateNode;f.flags&32&&(Cr(I,""),f.flags&=-33);var $=_y(s);Yp(s,$,I);break;case 3:case 4:var Z=f.stateNode.containerInfo,de=_y(s);Ey(s,de,Z);break;default:throw Error(r(161))}}catch(ve){Vt(s,s.return,ve)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function jT(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;jT(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function cs(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)NT(s,l.alternate,l),l=l.sibling}function Il(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:io(4,l,l.return),Il(l);break;case 1:Ea(l,l.return);var f=l.stateNode;typeof f.componentWillUnmount=="function"&&TT(l,l.return,f),Il(l);break;case 27:nf(l.stateNode);case 26:case 5:Ea(l,l.return),Il(l);break;case 22:l.memoizedState===null&&Il(l);break;case 30:Il(l);break;default:Il(l)}s=s.sibling}}function us(s,l,f){for(f=f&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var g=l.alternate,x=s,_=l,I=_.flags;switch(_.tag){case 0:case 11:case 15:us(x,_,f),qd(4,_);break;case 1:if(us(x,_,f),g=_,x=g.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(de){Vt(g,g.return,de)}if(g=_,x=g.updateQueue,x!==null){var $=g.stateNode;try{var Z=x.shared.hiddenCallbacks;if(Z!==null)for(x.shared.hiddenCallbacks=null,x=0;x<Z.length;x++)hS(Z[x],$)}catch(de){Vt(g,g.return,de)}}f&&I&64&&ST(_),Yd(_,_.return);break;case 27:kT(_);case 26:case 5:us(x,_,f),f&&g===null&&I&4&&AT(_),Yd(_,_.return);break;case 12:us(x,_,f);break;case 31:us(x,_,f),f&&I&4&&MT(x,_);break;case 13:us(x,_,f),f&&I&4&&OT(x,_);break;case 22:_.memoizedState===null&&us(x,_,f),Yd(_,_.return);break;case 30:break;default:us(x,_,f)}l=l.sibling}}function Ty(s,l){var f=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==f&&(s!=null&&s.refCount++,f!=null&&Md(f))}function Ay(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&Md(s))}function $i(s,l,f,g){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)VT(s,l,f,g),l=l.sibling}function VT(s,l,f,g){var x=l.flags;switch(l.tag){case 0:case 11:case 15:$i(s,l,f,g),x&2048&&qd(9,l);break;case 1:$i(s,l,f,g);break;case 3:$i(s,l,f,g),x&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&Md(s)));break;case 12:if(x&2048){$i(s,l,f,g),s=l.stateNode;try{var _=l.memoizedProps,I=_.id,$=_.onPostCommit;typeof $=="function"&&$(I,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(Z){Vt(l,l.return,Z)}}else $i(s,l,f,g);break;case 31:$i(s,l,f,g);break;case 13:$i(s,l,f,g);break;case 23:break;case 22:_=l.stateNode,I=l.alternate,l.memoizedState!==null?_._visibility&2?$i(s,l,f,g):Xd(s,l):_._visibility&2?$i(s,l,f,g):(_._visibility|=2,Uc(s,l,f,g,(l.subtreeFlags&10256)!==0||!1)),x&2048&&Ty(I,l);break;case 24:$i(s,l,f,g),x&2048&&Ay(l.alternate,l);break;default:$i(s,l,f,g)}}function Uc(s,l,f,g,x){for(x=x&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var _=s,I=l,$=f,Z=g,de=I.flags;switch(I.tag){case 0:case 11:case 15:Uc(_,I,$,Z,x),qd(8,I);break;case 23:break;case 22:var ve=I.stateNode;I.memoizedState!==null?ve._visibility&2?Uc(_,I,$,Z,x):Xd(_,I):(ve._visibility|=2,Uc(_,I,$,Z,x)),x&&de&2048&&Ty(I.alternate,I);break;case 24:Uc(_,I,$,Z,x),x&&de&2048&&Ay(I.alternate,I);break;default:Uc(_,I,$,Z,x)}l=l.sibling}}function Xd(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var f=s,g=l,x=g.flags;switch(g.tag){case 22:Xd(f,g),x&2048&&Ty(g.alternate,g);break;case 24:Xd(f,g),x&2048&&Ay(g.alternate,g);break;default:Xd(f,g)}l=l.sibling}}var Wd=8192;function Fc(s,l,f){if(s.subtreeFlags&Wd)for(s=s.child;s!==null;)zT(s,l,f),s=s.sibling}function zT(s,l,f){switch(s.tag){case 26:Fc(s,l,f),s.flags&Wd&&s.memoizedState!==null&&r5(f,Fi,s.memoizedState,s.memoizedProps);break;case 5:Fc(s,l,f);break;case 3:case 4:var g=Fi;Fi=lg(s.stateNode.containerInfo),Fc(s,l,f),Fi=g;break;case 22:s.memoizedState===null&&(g=s.alternate,g!==null&&g.memoizedState!==null?(g=Wd,Wd=16777216,Fc(s,l,f),Wd=g):Fc(s,l,f));break;default:Fc(s,l,f)}}function LT(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function Kd(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];Yn=g,UT(g,s)}LT(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)BT(s),s=s.sibling}function BT(s){switch(s.tag){case 0:case 11:case 15:Kd(s),s.flags&2048&&io(9,s,s.return);break;case 3:Kd(s);break;case 12:Kd(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,Wp(s)):Kd(s);break;default:Kd(s)}}function Wp(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];Yn=g,UT(g,s)}LT(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:io(8,l,l.return),Wp(l);break;case 22:f=l.stateNode,f._visibility&2&&(f._visibility&=-3,Wp(l));break;default:Wp(l)}s=s.sibling}}function UT(s,l){for(;Yn!==null;){var f=Yn;switch(f.tag){case 0:case 11:case 15:io(8,f,l);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var g=f.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:Md(f.memoizedState.cache)}if(g=f.child,g!==null)g.return=f,Yn=g;else e:for(f=s;Yn!==null;){g=Yn;var x=g.sibling,_=g.return;if(DT(g),g===f){Yn=null;break e}if(x!==null){x.return=_,Yn=x;break e}Yn=_}}}var yj={getCacheForType:function(s){var l=Qn(Cn),f=l.data.get(s);return f===void 0&&(f=s(),l.data.set(s,f)),f},cacheSignal:function(){return Qn(Cn).controller.signal}},bj=typeof WeakMap=="function"?WeakMap:Map,Dt=0,Ht=null,ht=null,mt=0,jt=0,Zr=null,ao=!1,$c=!1,Cy=!1,ds=0,dn=0,so=0,Ml=0,ky=0,Jr=0,Gc=0,Qd=null,Dr=null,Ry=!1,Kp=0,FT=0,Qp=1/0,Zp=null,oo=null,zn=0,lo=null,Hc=null,fs=0,Ny=0,Dy=null,$T=null,Zd=0,Iy=null;function ei(){return(Dt&2)!==0&&mt!==0?mt&-mt:q.T!==null?zy():Jh()}function GT(){if(Jr===0)if((mt&536870912)===0||Et){var s=nn;nn<<=1,(nn&3932160)===0&&(nn=262144),Jr=s}else Jr=536870912;return s=Kr.current,s!==null&&(s.flags|=32),Jr}function Ir(s,l,f){(s===Ht&&(jt===2||jt===9)||s.cancelPendingCommit!==null)&&(qc(s,0),co(s,mt,Jr,!1)),ol(s,f),((Dt&2)===0||s!==Ht)&&(s===Ht&&((Dt&2)===0&&(Ml|=f),dn===4&&co(s,mt,Jr,!1)),Sa(s))}function HT(s,l,f){if((Dt&6)!==0)throw Error(r(327));var g=!f&&(l&127)===0&&(l&s.expiredLanes)===0||gr(s,l),x=g?_j(s,l):Oy(s,l,!0),_=g;do{if(x===0){$c&&!g&&co(s,l,0,!1);break}else{if(f=s.current.alternate,_&&!xj(f)){x=Oy(s,l,!1),_=!1;continue}if(x===2){if(_=l,s.errorRecoveryDisabledLanes&_)var I=0;else I=s.pendingLanes&-536870913,I=I!==0?I:I&536870912?536870912:0;if(I!==0){l=I;e:{var $=s;x=Qd;var Z=$.current.memoizedState.isDehydrated;if(Z&&(qc($,I).flags|=256),I=Oy($,I,!1),I!==2){if(Cy&&!Z){$.errorRecoveryDisabledLanes|=_,Ml|=_,x=4;break e}_=Dr,Dr=x,_!==null&&(Dr===null?Dr=_:Dr.push.apply(Dr,_))}x=I}if(_=!1,x!==2)continue}}if(x===1){qc(s,0),co(s,l,0,!0);break}e:{switch(g=s,_=x,_){case 0:case 1:throw Error(r(345));case 4:if((l&4194048)!==l)break;case 6:co(g,l,Jr,!ao);break e;case 2:Dr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((l&62914560)===l&&(x=Kp+300-ut(),10<x)){if(co(g,l,Jr,!ao),si(g,0,!0)!==0)break e;fs=l,g.timeoutHandle=_A(qT.bind(null,g,f,Dr,Zp,Ry,l,Jr,Ml,Gc,ao,_,"Throttled",-0,0),x);break e}qT(g,f,Dr,Zp,Ry,l,Jr,Ml,Gc,ao,_,null,-0,0)}}break}while(!0);Sa(s)}function qT(s,l,f,g,x,_,I,$,Z,de,ve,xe,fe,me){if(s.timeoutHandle=-1,xe=l.subtreeFlags,xe&8192||(xe&16785408)===16785408){xe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ji},zT(l,_,xe);var je=(_&62914560)===_?Kp-ut():(_&4194048)===_?FT-ut():0;if(je=i5(xe,je),je!==null){fs=_,s.cancelPendingCommit=je(eA.bind(null,s,l,_,f,g,x,I,$,Z,ve,xe,null,fe,me)),co(s,_,I,!de);return}}eA(s,l,_,f,g,x,I,$,Z)}function xj(s){for(var l=s;;){var f=l.tag;if((f===0||f===11||f===15)&&l.flags&16384&&(f=l.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var g=0;g<f.length;g++){var x=f[g],_=x.getSnapshot;x=x.value;try{if(!Xr(_(),x))return!1}catch{return!1}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function co(s,l,f,g){l&=~ky,l&=~Ml,s.suspendedLanes|=l,s.pingedLanes&=~l,g&&(s.warmLanes|=l),g=s.expirationTimes;for(var x=l;0<x;){var _=31-tn(x),I=1<<_;g[_]=-1,x&=~I}f!==0&&ll(s,f,l)}function Jp(){return(Dt&6)===0?(Jd(0),!1):!0}function My(){if(ht!==null){if(jt===0)var s=ht.return;else s=ht,ts=Sl=null,Wv(s),jc=null,Pd=0,s=ht;for(;s!==null;)ET(s.alternate,s),s=s.return;ht=null}}function qc(s,l){var f=s.timeoutHandle;f!==-1&&(s.timeoutHandle=-1,Bj(f)),f=s.cancelPendingCommit,f!==null&&(s.cancelPendingCommit=null,f()),fs=0,My(),Ht=s,ht=f=Ja(s.current,null),mt=l,jt=0,Zr=null,ao=!1,$c=gr(s,l),Cy=!1,Gc=Jr=ky=Ml=so=dn=0,Dr=Qd=null,Ry=!1,(l&8)!==0&&(l|=l&32);var g=s.entangledLanes;if(g!==0)for(s=s.entanglements,g&=l;0<g;){var x=31-tn(g),_=1<<x;l|=s[x],g&=~_}return ds=l,xp(),f}function YT(s,l){lt=null,q.H=$d,l===Pc||l===kp?(l=cS(),jt=3):l===Vv?(l=cS(),jt=4):jt=l===dy?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,Zr=l,ht===null&&(dn=1,Fp(s,fi(l,s.current)))}function XT(){var s=Kr.current;return s===null?!0:(mt&4194048)===mt?mi===null:(mt&62914560)===mt||(mt&536870912)!==0?s===mi:!1}function WT(){var s=q.H;return q.H=$d,s===null?$d:s}function KT(){var s=q.A;return q.A=yj,s}function eg(){dn=4,ao||(mt&4194048)!==mt&&Kr.current!==null||($c=!0),(so&134217727)===0&&(Ml&134217727)===0||Ht===null||co(Ht,mt,Jr,!1)}function Oy(s,l,f){var g=Dt;Dt|=2;var x=WT(),_=KT();(Ht!==s||mt!==l)&&(Zp=null,qc(s,l)),l=!1;var I=dn;e:do try{if(jt!==0&&ht!==null){var $=ht,Z=Zr;switch(jt){case 8:My(),I=6;break e;case 3:case 2:case 9:case 6:Kr.current===null&&(l=!0);var de=jt;if(jt=0,Zr=null,Yc(s,$,Z,de),f&&$c){I=0;break e}break;default:de=jt,jt=0,Zr=null,Yc(s,$,Z,de)}}wj(),I=dn;break}catch(ve){YT(s,ve)}while(!0);return l&&s.shellSuspendCounter++,ts=Sl=null,Dt=g,q.H=x,q.A=_,ht===null&&(Ht=null,mt=0,xp()),I}function wj(){for(;ht!==null;)QT(ht)}function _j(s,l){var f=Dt;Dt|=2;var g=WT(),x=KT();Ht!==s||mt!==l?(Zp=null,Qp=ut()+500,qc(s,l)):$c=gr(s,l);e:do try{if(jt!==0&&ht!==null){l=ht;var _=Zr;t:switch(jt){case 1:jt=0,Zr=null,Yc(s,l,_,1);break;case 2:case 9:if(oS(_)){jt=0,Zr=null,ZT(l);break}l=function(){jt!==2&&jt!==9||Ht!==s||(jt=7),Sa(s)},_.then(l,l);break e;case 3:jt=7;break e;case 4:jt=5;break e;case 7:oS(_)?(jt=0,Zr=null,ZT(l)):(jt=0,Zr=null,Yc(s,l,_,7));break;case 5:var I=null;switch(ht.tag){case 26:I=ht.memoizedState;case 5:case 27:var $=ht;if(I?VA(I):$.stateNode.complete){jt=0,Zr=null;var Z=$.sibling;if(Z!==null)ht=Z;else{var de=$.return;de!==null?(ht=de,tg(de)):ht=null}break t}}jt=0,Zr=null,Yc(s,l,_,5);break;case 6:jt=0,Zr=null,Yc(s,l,_,6);break;case 8:My(),dn=6;break e;default:throw Error(r(462))}}Ej();break}catch(ve){YT(s,ve)}while(!0);return ts=Sl=null,q.H=g,q.A=x,Dt=f,ht!==null?0:(Ht=null,mt=0,xp(),dn)}function Ej(){for(;ht!==null&&!_t();)QT(ht)}function QT(s){var l=wT(s.alternate,s,ds);s.memoizedProps=s.pendingProps,l===null?tg(s):ht=l}function ZT(s){var l=s,f=l.alternate;switch(l.tag){case 15:case 0:l=gT(f,l,l.pendingProps,l.type,void 0,mt);break;case 11:l=gT(f,l,l.pendingProps,l.type.render,l.ref,mt);break;case 5:Wv(l);default:ET(f,l),l=ht=KE(l,ds),l=wT(f,l,ds)}s.memoizedProps=s.pendingProps,l===null?tg(s):ht=l}function Yc(s,l,f,g){ts=Sl=null,Wv(l),jc=null,Pd=0;var x=l.return;try{if(dj(s,x,l,f,mt)){dn=1,Fp(s,fi(f,s.current)),ht=null;return}}catch(_){if(x!==null)throw ht=x,_;dn=1,Fp(s,fi(f,s.current)),ht=null;return}l.flags&32768?(Et||g===1?s=!0:$c||(mt&536870912)!==0?s=!1:(ao=s=!0,(g===2||g===9||g===3||g===6)&&(g=Kr.current,g!==null&&g.tag===13&&(g.flags|=16384))),JT(l,s)):tg(l)}function tg(s){var l=s;do{if((l.flags&32768)!==0){JT(l,ao);return}s=l.return;var f=pj(l.alternate,l,ds);if(f!==null){ht=f;return}if(l=l.sibling,l!==null){ht=l;return}ht=l=s}while(l!==null);dn===0&&(dn=5)}function JT(s,l){do{var f=gj(s.alternate,s);if(f!==null){f.flags&=32767,ht=f;return}if(f=s.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!l&&(s=s.sibling,s!==null)){ht=s;return}ht=s=f}while(s!==null);dn=6,ht=null}function eA(s,l,f,g,x,_,I,$,Z){s.cancelPendingCommit=null;do ng();while(zn!==0);if((Dt&6)!==0)throw Error(r(327));if(l!==null){if(l===s.current)throw Error(r(177));if(_=l.lanes|l.childLanes,_|=_v,hv(s,f,_,I,$,Z),s===Ht&&(ht=Ht=null,mt=0),Hc=l,lo=s,fs=f,Ny=_,Dy=x,$T=g,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Cj(_n,function(){return aA(),null})):(s.callbackNode=null,s.callbackPriority=0),g=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||g){g=q.T,q.T=null,x=K.p,K.p=2,I=Dt,Dt|=4;try{mj(s,l,f)}finally{Dt=I,K.p=x,q.T=g}}zn=1,tA(),nA(),rA()}}function tA(){if(zn===1){zn=0;var s=lo,l=Hc,f=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||f){f=q.T,q.T=null;var g=K.p;K.p=2;var x=Dt;Dt|=4;try{PT(l,s);var _=qy,I=UE(s.containerInfo),$=_.focusedElem,Z=_.selectionRange;if(I!==$&&$&&$.ownerDocument&&BE($.ownerDocument.documentElement,$)){if(Z!==null&&vv($)){var de=Z.start,ve=Z.end;if(ve===void 0&&(ve=de),"selectionStart"in $)$.selectionStart=de,$.selectionEnd=Math.min(ve,$.value.length);else{var xe=$.ownerDocument||document,fe=xe&&xe.defaultView||window;if(fe.getSelection){var me=fe.getSelection(),je=$.textContent.length,Xe=Math.min(Z.start,je),Ft=Z.end===void 0?Xe:Math.min(Z.end,je);!me.extend&&Xe>Ft&&(I=Ft,Ft=Xe,Xe=I);var oe=LE($,Xe),re=LE($,Ft);if(oe&&re&&(me.rangeCount!==1||me.anchorNode!==oe.node||me.anchorOffset!==oe.offset||me.focusNode!==re.node||me.focusOffset!==re.offset)){var ue=xe.createRange();ue.setStart(oe.node,oe.offset),me.removeAllRanges(),Xe>Ft?(me.addRange(ue),me.extend(re.node,re.offset)):(ue.setEnd(re.node,re.offset),me.addRange(ue))}}}}for(xe=[],me=$;me=me.parentNode;)me.nodeType===1&&xe.push({element:me,left:me.scrollLeft,top:me.scrollTop});for(typeof $.focus=="function"&&$.focus(),$=0;$<xe.length;$++){var ye=xe[$];ye.element.scrollLeft=ye.left,ye.element.scrollTop=ye.top}}pg=!!Hy,qy=Hy=null}finally{Dt=x,K.p=g,q.T=f}}s.current=l,zn=2}}function nA(){if(zn===2){zn=0;var s=lo,l=Hc,f=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||f){f=q.T,q.T=null;var g=K.p;K.p=2;var x=Dt;Dt|=4;try{NT(s,l.alternate,l)}finally{Dt=x,K.p=g,q.T=f}}zn=3}}function rA(){if(zn===4||zn===3){zn=0,Ze();var s=lo,l=Hc,f=fs,g=$T;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?zn=5:(zn=0,Hc=lo=null,iA(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(oo=null),Wa(f),l=l.stateNode,En&&typeof En.onCommitFiberRoot=="function")try{En.onCommitFiberRoot(Gr,l,void 0,(l.current.flags&128)===128)}catch{}if(g!==null){l=q.T,x=K.p,K.p=2,q.T=null;try{for(var _=s.onRecoverableError,I=0;I<g.length;I++){var $=g[I];_($.value,{componentStack:$.stack})}}finally{q.T=l,K.p=x}}(fs&3)!==0&&ng(),Sa(s),x=s.pendingLanes,(f&261930)!==0&&(x&42)!==0?s===Iy?Zd++:(Zd=0,Iy=s):Zd=0,Jd(0)}}function iA(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,Md(l)))}function ng(){return tA(),nA(),rA(),aA()}function aA(){if(zn!==5)return!1;var s=lo,l=Ny;Ny=0;var f=Wa(fs),g=q.T,x=K.p;try{K.p=32>f?32:f,q.T=null,f=Dy,Dy=null;var _=lo,I=fs;if(zn=0,Hc=lo=null,fs=0,(Dt&6)!==0)throw Error(r(331));var $=Dt;if(Dt|=4,BT(_.current),VT(_,_.current,I,f),Dt=$,Jd(0,!1),En&&typeof En.onPostCommitFiberRoot=="function")try{En.onPostCommitFiberRoot(Gr,_)}catch{}return!0}finally{K.p=x,q.T=g,iA(s,l)}}function sA(s,l,f){l=fi(f,l),l=uy(s.stateNode,l,2),s=to(s,l,2),s!==null&&(ol(s,2),Sa(s))}function Vt(s,l,f){if(s.tag===3)sA(s,s,f);else for(;l!==null;){if(l.tag===3){sA(l,s,f);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(oo===null||!oo.has(g))){s=fi(f,s),f=oT(2),g=to(l,f,2),g!==null&&(lT(f,g,l,s),ol(g,2),Sa(g));break}}l=l.return}}function Py(s,l,f){var g=s.pingCache;if(g===null){g=s.pingCache=new bj;var x=new Set;g.set(l,x)}else x=g.get(l),x===void 0&&(x=new Set,g.set(l,x));x.has(f)||(Cy=!0,x.add(f),s=Sj.bind(null,s,l,f),l.then(s,s))}function Sj(s,l,f){var g=s.pingCache;g!==null&&g.delete(l),s.pingedLanes|=s.suspendedLanes&f,s.warmLanes&=~f,Ht===s&&(mt&f)===f&&(dn===4||dn===3&&(mt&62914560)===mt&&300>ut()-Kp?(Dt&2)===0&&qc(s,0):ky|=f,Gc===mt&&(Gc=0)),Sa(s)}function oA(s,l){l===0&&(l=Zh()),s=wl(s,l),s!==null&&(ol(s,l),Sa(s))}function Tj(s){var l=s.memoizedState,f=0;l!==null&&(f=l.retryLane),oA(s,f)}function Aj(s,l){var f=0;switch(s.tag){case 31:case 13:var g=s.stateNode,x=s.memoizedState;x!==null&&(f=x.retryLane);break;case 19:g=s.stateNode;break;case 22:g=s.stateNode._retryCache;break;default:throw Error(r(314))}g!==null&&g.delete(l),oA(s,f)}function Cj(s,l){return Be(s,l)}var rg=null,Xc=null,jy=!1,ig=!1,Vy=!1,uo=0;function Sa(s){s!==Xc&&s.next===null&&(Xc===null?rg=Xc=s:Xc=Xc.next=s),ig=!0,jy||(jy=!0,Rj())}function Jd(s,l){if(!Vy&&ig){Vy=!0;do for(var f=!1,g=rg;g!==null;){if(s!==0){var x=g.pendingLanes;if(x===0)var _=0;else{var I=g.suspendedLanes,$=g.pingedLanes;_=(1<<31-tn(42|s)+1)-1,_&=x&~(I&~$),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(f=!0,dA(g,_))}else _=mt,_=si(g,g===Ht?_:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(_&3)===0||gr(g,_)||(f=!0,dA(g,_));g=g.next}while(f);Vy=!1}}function kj(){lA()}function lA(){ig=jy=!1;var s=0;uo!==0&&Lj()&&(s=uo);for(var l=ut(),f=null,g=rg;g!==null;){var x=g.next,_=cA(g,l);_===0?(g.next=null,f===null?rg=x:f.next=x,x===null&&(Xc=f)):(f=g,(s!==0||(_&3)!==0)&&(ig=!0)),g=x}zn!==0&&zn!==5||Jd(s),uo!==0&&(uo=0)}function cA(s,l){for(var f=s.suspendedLanes,g=s.pingedLanes,x=s.expirationTimes,_=s.pendingLanes&-62914561;0<_;){var I=31-tn(_),$=1<<I,Z=x[I];Z===-1?(($&f)===0||($&g)!==0)&&(x[I]=fv($,l)):Z<=l&&(s.expiredLanes|=$),_&=~$}if(l=Ht,f=mt,f=si(s,s===l?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g=s.callbackNode,f===0||s===l&&(jt===2||jt===9)||s.cancelPendingCommit!==null)return g!==null&&g!==null&&st(g),s.callbackNode=null,s.callbackPriority=0;if((f&3)===0||gr(s,f)){if(l=f&-f,l===s.callbackPriority)return l;switch(g!==null&&st(g),Wa(f)){case 2:case 8:f=Mt;break;case 32:f=_n;break;case 268435456:f=sa;break;default:f=_n}return g=uA.bind(null,s),f=Be(f,g),s.callbackPriority=l,s.callbackNode=f,l}return g!==null&&g!==null&&st(g),s.callbackPriority=2,s.callbackNode=null,2}function uA(s,l){if(zn!==0&&zn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var f=s.callbackNode;if(ng()&&s.callbackNode!==f)return null;var g=mt;return g=si(s,s===Ht?g:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g===0?null:(HT(s,g,l),cA(s,ut()),s.callbackNode!=null&&s.callbackNode===f?uA.bind(null,s):null)}function dA(s,l){if(ng())return null;HT(s,l,!0)}function Rj(){Uj(function(){(Dt&6)!==0?Be(cn,kj):lA()})}function zy(){if(uo===0){var s=Mc;s===0&&(s=ft,ft<<=1,(ft&261888)===0&&(ft=256)),uo=s}return uo}function fA(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:yc(""+s)}function hA(s,l){var f=l.ownerDocument.createElement("input");return f.name=l.name,f.value=l.value,s.id&&f.setAttribute("form",s.id),l.parentNode.insertBefore(f,l),s=new FormData(s),f.parentNode.removeChild(f),s}function Nj(s,l,f,g,x){if(l==="submit"&&f&&f.stateNode===x){var _=fA((x[Hn]||null).action),I=g.submitter;I&&(l=(l=I[Hn]||null)?fA(l.formAction):I.getAttribute("formAction"),l!==null&&(_=l,I=null));var $=new va("action","action",null,g,x);s.push({event:$,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(uo!==0){var Z=I?hA(x,I):new FormData(x);iy(f,{pending:!0,data:Z,method:x.method,action:_},null,Z)}}else typeof _=="function"&&($.preventDefault(),Z=I?hA(x,I):new FormData(x),iy(f,{pending:!0,data:Z,method:x.method,action:_},_,Z))},currentTarget:x}]})}}for(var Ly=0;Ly<wv.length;Ly++){var By=wv[Ly],Dj=By.toLowerCase(),Ij=By[0].toUpperCase()+By.slice(1);Ui(Dj,"on"+Ij)}Ui(GE,"onAnimationEnd"),Ui(HE,"onAnimationIteration"),Ui(qE,"onAnimationStart"),Ui("dblclick","onDoubleClick"),Ui("focusin","onFocus"),Ui("focusout","onBlur"),Ui(X3,"onTransitionRun"),Ui(W3,"onTransitionStart"),Ui(K3,"onTransitionCancel"),Ui(YE,"onTransitionEnd"),ha("onMouseEnter",["mouseout","mouseover"]),ha("onMouseLeave",["mouseout","mouseover"]),ha("onPointerEnter",["pointerout","pointerover"]),ha("onPointerLeave",["pointerout","pointerover"]),fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),fa("onBeforeInput",["compositionend","keypress","textInput","paste"]),fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ef="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ef));function pA(s,l){l=(l&4)!==0;for(var f=0;f<s.length;f++){var g=s[f],x=g.event;g=g.listeners;e:{var _=void 0;if(l)for(var I=g.length-1;0<=I;I--){var $=g[I],Z=$.instance,de=$.currentTarget;if($=$.listener,Z!==_&&x.isPropagationStopped())break e;_=$,x.currentTarget=de;try{_(x)}catch(ve){bp(ve)}x.currentTarget=null,_=Z}else for(I=0;I<g.length;I++){if($=g[I],Z=$.instance,de=$.currentTarget,$=$.listener,Z!==_&&x.isPropagationStopped())break e;_=$,x.currentTarget=de;try{_(x)}catch(ve){bp(ve)}x.currentTarget=null,_=Z}}}}function pt(s,l){var f=l[hc];f===void 0&&(f=l[hc]=new Set);var g=s+"__bubble";f.has(g)||(gA(l,s,2,!1),f.add(g))}function Uy(s,l,f){var g=0;l&&(g|=4),gA(f,s,g,l)}var ag="_reactListening"+Math.random().toString(36).slice(2);function Fy(s){if(!s[ag]){s[ag]=!0,fd.forEach(function(f){f!=="selectionchange"&&(Mj.has(f)||Uy(f,!1,s),Uy(f,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[ag]||(l[ag]=!0,Uy("selectionchange",!1,l))}}function gA(s,l,f,g){switch(GA(l)){case 2:var x=o5;break;case 8:x=l5;break;default:x=rb}f=x.bind(null,l,f,s),x=void 0,!hl||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(x=!0),g?x!==void 0?s.addEventListener(l,f,{capture:!0,passive:x}):s.addEventListener(l,f,!0):x!==void 0?s.addEventListener(l,f,{passive:x}):s.addEventListener(l,f,!1)}function $y(s,l,f,g,x){var _=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var I=g.tag;if(I===3||I===4){var $=g.stateNode.containerInfo;if($===x)break;if(I===4)for(I=g.return;I!==null;){var Z=I.tag;if((Z===3||Z===4)&&I.stateNode.containerInfo===x)return;I=I.return}for(;$!==null;){if(I=ua($),I===null)return;if(Z=I.tag,Z===5||Z===6||Z===26||Z===27){g=_=I;continue e}$=$.parentNode}}g=g.return}Hs(function(){var de=_,ve=li(f),xe=[];e:{var fe=XE.get(s);if(fe!==void 0){var me=va,je=s;switch(s){case"keypress":if(gl(f)===0)break e;case"keydown":case"keyup":me=mp;break;case"focusin":je="focus",me=vl;break;case"focusout":je="blur",me=vl;break;case"beforeblur":case"afterblur":me=vl;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":me=Td;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":me=op;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":me=R;break;case GE:case HE:case qE:me=cp;break;case YE:me=H;break;case"scroll":case"scrollend":me=Sd;break;case"wheel":me=he;break;case"copy":case"cut":case"paste":me=up;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":me=Za;break;case"toggle":case"beforetoggle":me=ot}var Xe=(l&4)!==0,Ft=!Xe&&(s==="scroll"||s==="scrollend"),oe=Xe?fe!==null?fe+"Capture":null:fe;Xe=[];for(var re=de,ue;re!==null;){var ye=re;if(ue=ye.stateNode,ye=ye.tag,ye!==5&&ye!==26&&ye!==27||ue===null||oe===null||(ye=Vi(re,oe),ye!=null&&Xe.push(tf(re,ye,ue))),Ft)break;re=re.return}0<Xe.length&&(fe=new me(fe,je,null,f,ve),xe.push({event:fe,listeners:Xe}))}}if((l&7)===0){e:{if(fe=s==="mouseover"||s==="pointerover",me=s==="mouseout"||s==="pointerout",fe&&f!==wd&&(je=f.relatedTarget||f.fromElement)&&(ua(je)||je[la]))break e;if((me||fe)&&(fe=ve.window===ve?ve:(fe=ve.ownerDocument)?fe.defaultView||fe.parentWindow:window,me?(je=f.relatedTarget||f.toElement,me=de,je=je?ua(je):null,je!==null&&(Ft=a(je),Xe=je.tag,je!==Ft||Xe!==5&&Xe!==27&&Xe!==6)&&(je=null)):(me=null,je=de),me!==je)){if(Xe=Td,ye="onMouseLeave",oe="onMouseEnter",re="mouse",(s==="pointerout"||s==="pointerover")&&(Xe=Za,ye="onPointerLeave",oe="onPointerEnter",re="pointer"),Ft=me==null?fe:qr(me),ue=je==null?fe:qr(je),fe=new Xe(ye,re+"leave",me,f,ve),fe.target=Ft,fe.relatedTarget=ue,ye=null,ua(ve)===de&&(Xe=new Xe(oe,re+"enter",je,f,ve),Xe.target=ue,Xe.relatedTarget=Ft,ye=Xe),Ft=ye,me&&je)t:{for(Xe=Oj,oe=me,re=je,ue=0,ye=oe;ye;ye=Xe(ye))ue++;ye=0;for(var Ge=re;Ge;Ge=Xe(Ge))ye++;for(;0<ue-ye;)oe=Xe(oe),ue--;for(;0<ye-ue;)re=Xe(re),ye--;for(;ue--;){if(oe===re||re!==null&&oe===re.alternate){Xe=oe;break t}oe=Xe(oe),re=Xe(re)}Xe=null}else Xe=null;me!==null&&mA(xe,fe,me,Xe,!1),je!==null&&Ft!==null&&mA(xe,Ft,je,Xe,!0)}}e:{if(fe=de?qr(de):window,me=fe.nodeName&&fe.nodeName.toLowerCase(),me==="select"||me==="input"&&fe.type==="file")var Ct=ME;else if(DE(fe))if(OE)Ct=H3;else{Ct=$3;var Ue=F3}else me=fe.nodeName,!me||me.toLowerCase()!=="input"||fe.type!=="checkbox"&&fe.type!=="radio"?de&&vc(de.elementType)&&(Ct=ME):Ct=G3;if(Ct&&(Ct=Ct(s,de))){IE(xe,Ct,f,ve);break e}Ue&&Ue(s,fe,de),s==="focusout"&&de&&fe.type==="number"&&de.memoizedProps.value!=null&&yd(fe,"number",fe.value)}switch(Ue=de?qr(de):window,s){case"focusin":(DE(Ue)||Ue.contentEditable==="true")&&(Tc=Ue,yv=de,Nd=null);break;case"focusout":Nd=yv=Tc=null;break;case"mousedown":bv=!0;break;case"contextmenu":case"mouseup":case"dragend":bv=!1,FE(xe,f,ve);break;case"selectionchange":if(Y3)break;case"keydown":case"keyup":FE(xe,f,ve)}var dt;if(Nt)e:{switch(s){case"compositionstart":var vt="onCompositionStart";break e;case"compositionend":vt="onCompositionEnd";break e;case"compositionupdate":vt="onCompositionUpdate";break e}vt=void 0}else Sc?yl(s,f)&&(vt="onCompositionEnd"):s==="keydown"&&f.keyCode===229&&(vt="onCompositionStart");vt&&(xa&&f.locale!=="ko"&&(Sc||vt!=="onCompositionStart"?vt==="onCompositionEnd"&&Sc&&(dt=Ed()):(ma=ve,_d="value"in ma?ma.value:ma.textContent,Sc=!0)),Ue=sg(de,vt),0<Ue.length&&(vt=new ba(vt,s,null,f,ve),xe.push({event:vt,listeners:Ue}),dt?vt.data=dt:(dt=Ec(f),dt!==null&&(vt.data=dt)))),(dt=ui?z3(s,f):L3(s,f))&&(vt=sg(de,"onBeforeInput"),0<vt.length&&(Ue=new ba("onBeforeInput","beforeinput",null,f,ve),xe.push({event:Ue,listeners:vt}),Ue.data=dt)),Nj(xe,s,de,f,ve)}pA(xe,l)})}function tf(s,l,f){return{instance:s,listener:l,currentTarget:f}}function sg(s,l){for(var f=l+"Capture",g=[];s!==null;){var x=s,_=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||_===null||(x=Vi(s,f),x!=null&&g.unshift(tf(s,x,_)),x=Vi(s,l),x!=null&&g.push(tf(s,x,_))),s.tag===3)return g;s=s.return}return[]}function Oj(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function mA(s,l,f,g,x){for(var _=l._reactName,I=[];f!==null&&f!==g;){var $=f,Z=$.alternate,de=$.stateNode;if($=$.tag,Z!==null&&Z===g)break;$!==5&&$!==26&&$!==27||de===null||(Z=de,x?(de=Vi(f,_),de!=null&&I.unshift(tf(f,de,Z))):x||(de=Vi(f,_),de!=null&&I.push(tf(f,de,Z)))),f=f.return}I.length!==0&&s.push({event:l,listeners:I})}var Pj=/\r\n?/g,jj=/\u0000|\uFFFD/g;function vA(s){return(typeof s=="string"?s:""+s).replace(Pj,`
`).replace(jj,"")}function yA(s,l){return l=vA(l),vA(s)===l}function Ut(s,l,f,g,x,_){switch(f){case"children":typeof g=="string"?l==="body"||l==="textarea"&&g===""||Cr(s,g):(typeof g=="number"||typeof g=="bigint")&&l!=="body"&&Cr(s,""+g);break;case"className":Yr(s,"class",g);break;case"tabIndex":Yr(s,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":Yr(s,f,g);break;case"style":xd(s,g,_);break;case"data":if(l!=="object"){Yr(s,"data",g);break}case"src":case"href":if(g===""&&(l!=="a"||f!=="href")){s.removeAttribute(f);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(f);break}g=yc(""+g),s.setAttribute(f,g);break;case"action":case"formAction":if(typeof g=="function"){s.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(f==="formAction"?(l!=="input"&&Ut(s,l,"name",x.name,x,null),Ut(s,l,"formEncType",x.formEncType,x,null),Ut(s,l,"formMethod",x.formMethod,x,null),Ut(s,l,"formTarget",x.formTarget,x,null)):(Ut(s,l,"encType",x.encType,x,null),Ut(s,l,"method",x.method,x,null),Ut(s,l,"target",x.target,x,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(f);break}g=yc(""+g),s.setAttribute(f,g);break;case"onClick":g!=null&&(s.onclick=ji);break;case"onScroll":g!=null&&pt("scroll",s);break;case"onScrollEnd":g!=null&&pt("scrollend",s);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"multiple":s.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":s.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){s.removeAttribute("xlink:href");break}f=yc(""+g),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,""+g):s.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,""):s.removeAttribute(f);break;case"capture":case"download":g===!0?s.setAttribute(f,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,g):s.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?s.setAttribute(f,g):s.removeAttribute(f);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?s.removeAttribute(f):s.setAttribute(f,g);break;case"popover":pt("beforetoggle",s),pt("toggle",s),gc(s,"popover",g);break;case"xlinkActuate":An(s,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":An(s,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":An(s,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":An(s,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":An(s,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":An(s,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":An(s,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":An(s,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":An(s,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":gc(s,"is",g);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=sp.get(f)||f,gc(s,f,g))}}function Gy(s,l,f,g,x,_){switch(f){case"style":xd(s,g,_);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"children":typeof g=="string"?Cr(s,g):(typeof g=="number"||typeof g=="bigint")&&Cr(s,""+g);break;case"onScroll":g!=null&&pt("scroll",s);break;case"onScrollEnd":g!=null&&pt("scrollend",s);break;case"onClick":g!=null&&(s.onclick=ji);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!hd.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(x=f.endsWith("Capture"),l=f.slice(2,x?f.length-7:void 0),_=s[Hn]||null,_=_!=null?_[f]:null,typeof _=="function"&&s.removeEventListener(l,_,x),typeof g=="function")){typeof _!="function"&&_!==null&&(f in s?s[f]=null:s.hasAttribute(f)&&s.removeAttribute(f)),s.addEventListener(l,g,x);break e}f in s?s[f]=g:g===!0?s.setAttribute(f,""):gc(s,f,g)}}}function Jn(s,l,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":pt("error",s),pt("load",s);var g=!1,x=!1,_;for(_ in f)if(f.hasOwnProperty(_)){var I=f[_];if(I!=null)switch(_){case"src":g=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Ut(s,l,_,I,f,null)}}x&&Ut(s,l,"srcSet",f.srcSet,f,null),g&&Ut(s,l,"src",f.src,f,null);return;case"input":pt("invalid",s);var $=_=I=x=null,Z=null,de=null;for(g in f)if(f.hasOwnProperty(g)){var ve=f[g];if(ve!=null)switch(g){case"name":x=ve;break;case"type":I=ve;break;case"checked":Z=ve;break;case"defaultChecked":de=ve;break;case"value":_=ve;break;case"defaultValue":$=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(r(137,l));break;default:Ut(s,l,g,ve,f,null)}}rp(s,_,$,Z,de,I,x,!1);return;case"select":pt("invalid",s),g=I=_=null;for(x in f)if(f.hasOwnProperty(x)&&($=f[x],$!=null))switch(x){case"value":_=$;break;case"defaultValue":I=$;break;case"multiple":g=$;default:Ut(s,l,x,$,f,null)}l=_,f=I,s.multiple=!!g,l!=null?Us(s,!!g,l,!1):f!=null&&Us(s,!!g,f,!0);return;case"textarea":pt("invalid",s),_=x=g=null;for(I in f)if(f.hasOwnProperty(I)&&($=f[I],$!=null))switch(I){case"value":g=$;break;case"defaultValue":x=$;break;case"children":_=$;break;case"dangerouslySetInnerHTML":if($!=null)throw Error(r(91));break;default:Ut(s,l,I,$,f,null)}Fs(s,g,x,_);return;case"option":for(Z in f)if(f.hasOwnProperty(Z)&&(g=f[Z],g!=null))switch(Z){case"selected":s.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:Ut(s,l,Z,g,f,null)}return;case"dialog":pt("beforetoggle",s),pt("toggle",s),pt("cancel",s),pt("close",s);break;case"iframe":case"object":pt("load",s);break;case"video":case"audio":for(g=0;g<ef.length;g++)pt(ef[g],s);break;case"image":pt("error",s),pt("load",s);break;case"details":pt("toggle",s);break;case"embed":case"source":case"link":pt("error",s),pt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(de in f)if(f.hasOwnProperty(de)&&(g=f[de],g!=null))switch(de){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Ut(s,l,de,g,f,null)}return;default:if(vc(l)){for(ve in f)f.hasOwnProperty(ve)&&(g=f[ve],g!==void 0&&Gy(s,l,ve,g,f,void 0));return}}for($ in f)f.hasOwnProperty($)&&(g=f[$],g!=null&&Ut(s,l,$,g,f,null))}function Vj(s,l,f,g){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,_=null,I=null,$=null,Z=null,de=null,ve=null;for(me in f){var xe=f[me];if(f.hasOwnProperty(me)&&xe!=null)switch(me){case"checked":break;case"value":break;case"defaultValue":Z=xe;default:g.hasOwnProperty(me)||Ut(s,l,me,null,g,xe)}}for(var fe in g){var me=g[fe];if(xe=f[fe],g.hasOwnProperty(fe)&&(me!=null||xe!=null))switch(fe){case"type":_=me;break;case"name":x=me;break;case"checked":de=me;break;case"defaultChecked":ve=me;break;case"value":I=me;break;case"defaultValue":$=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(r(137,l));break;default:me!==xe&&Ut(s,l,fe,me,g,xe)}}mc(s,I,$,Z,de,ve,_,x);return;case"select":me=I=$=fe=null;for(_ in f)if(Z=f[_],f.hasOwnProperty(_)&&Z!=null)switch(_){case"value":break;case"multiple":me=Z;default:g.hasOwnProperty(_)||Ut(s,l,_,null,g,Z)}for(x in g)if(_=g[x],Z=f[x],g.hasOwnProperty(x)&&(_!=null||Z!=null))switch(x){case"value":fe=_;break;case"defaultValue":$=_;break;case"multiple":I=_;default:_!==Z&&Ut(s,l,x,_,g,Z)}l=$,f=I,g=me,fe!=null?Us(s,!!f,fe,!1):!!g!=!!f&&(l!=null?Us(s,!!f,l,!0):Us(s,!!f,f?[]:"",!1));return;case"textarea":me=fe=null;for($ in f)if(x=f[$],f.hasOwnProperty($)&&x!=null&&!g.hasOwnProperty($))switch($){case"value":break;case"children":break;default:Ut(s,l,$,null,g,x)}for(I in g)if(x=g[I],_=f[I],g.hasOwnProperty(I)&&(x!=null||_!=null))switch(I){case"value":fe=x;break;case"defaultValue":me=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==_&&Ut(s,l,I,x,g,_)}ip(s,fe,me);return;case"option":for(var je in f)if(fe=f[je],f.hasOwnProperty(je)&&fe!=null&&!g.hasOwnProperty(je))switch(je){case"selected":s.selected=!1;break;default:Ut(s,l,je,null,g,fe)}for(Z in g)if(fe=g[Z],me=f[Z],g.hasOwnProperty(Z)&&fe!==me&&(fe!=null||me!=null))switch(Z){case"selected":s.selected=fe&&typeof fe!="function"&&typeof fe!="symbol";break;default:Ut(s,l,Z,fe,g,me)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Xe in f)fe=f[Xe],f.hasOwnProperty(Xe)&&fe!=null&&!g.hasOwnProperty(Xe)&&Ut(s,l,Xe,null,g,fe);for(de in g)if(fe=g[de],me=f[de],g.hasOwnProperty(de)&&fe!==me&&(fe!=null||me!=null))switch(de){case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(r(137,l));break;default:Ut(s,l,de,fe,g,me)}return;default:if(vc(l)){for(var Ft in f)fe=f[Ft],f.hasOwnProperty(Ft)&&fe!==void 0&&!g.hasOwnProperty(Ft)&&Gy(s,l,Ft,void 0,g,fe);for(ve in g)fe=g[ve],me=f[ve],!g.hasOwnProperty(ve)||fe===me||fe===void 0&&me===void 0||Gy(s,l,ve,fe,g,me);return}}for(var oe in f)fe=f[oe],f.hasOwnProperty(oe)&&fe!=null&&!g.hasOwnProperty(oe)&&Ut(s,l,oe,null,g,fe);for(xe in g)fe=g[xe],me=f[xe],!g.hasOwnProperty(xe)||fe===me||fe==null&&me==null||Ut(s,l,xe,fe,g,me)}function bA(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function zj(){if(typeof performance.getEntriesByType=="function"){for(var s=0,l=0,f=performance.getEntriesByType("resource"),g=0;g<f.length;g++){var x=f[g],_=x.transferSize,I=x.initiatorType,$=x.duration;if(_&&$&&bA(I)){for(I=0,$=x.responseEnd,g+=1;g<f.length;g++){var Z=f[g],de=Z.startTime;if(de>$)break;var ve=Z.transferSize,xe=Z.initiatorType;ve&&bA(xe)&&(Z=Z.responseEnd,I+=ve*(Z<$?1:($-de)/(Z-de)))}if(--g,l+=8*(_+I)/(x.duration/1e3),s++,10<s)break}}if(0<s)return l/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Hy=null,qy=null;function og(s){return s.nodeType===9?s:s.ownerDocument}function xA(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function wA(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function Yy(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Xy=null;function Lj(){var s=window.event;return s&&s.type==="popstate"?s===Xy?!1:(Xy=s,!0):(Xy=null,!1)}var _A=typeof setTimeout=="function"?setTimeout:void 0,Bj=typeof clearTimeout=="function"?clearTimeout:void 0,EA=typeof Promise=="function"?Promise:void 0,Uj=typeof queueMicrotask=="function"?queueMicrotask:typeof EA<"u"?function(s){return EA.resolve(null).then(s).catch(Fj)}:_A;function Fj(s){setTimeout(function(){throw s})}function fo(s){return s==="head"}function SA(s,l){var f=l,g=0;do{var x=f.nextSibling;if(s.removeChild(f),x&&x.nodeType===8)if(f=x.data,f==="/$"||f==="/&"){if(g===0){s.removeChild(x),Zc(l);return}g--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")g++;else if(f==="html")nf(s.ownerDocument.documentElement);else if(f==="head"){f=s.ownerDocument.head,nf(f);for(var _=f.firstChild;_;){var I=_.nextSibling,$=_.nodeName;_[ca]||$==="SCRIPT"||$==="STYLE"||$==="LINK"&&_.rel.toLowerCase()==="stylesheet"||f.removeChild(_),_=I}}else f==="body"&&nf(s.ownerDocument.body);f=x}while(f);Zc(l)}function TA(s,l){var f=s;s=0;do{var g=f.nextSibling;if(f.nodeType===1?l?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(l?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),g&&g.nodeType===8)if(f=g.data,f==="/$"){if(s===0)break;s--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||s++;f=g}while(f)}function Wy(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var f=l;switch(l=l.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":Wy(f),pc(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}s.removeChild(f)}}function $j(s,l,f,g){for(;s.nodeType===1;){var x=f;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!g&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(g){if(!s[ca])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(_=s.getAttribute("rel"),_==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(_!==x.rel||s.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||s.getAttribute("title")!==(x.title==null?null:x.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(_=s.getAttribute("src"),(_!==(x.src==null?null:x.src)||s.getAttribute("type")!==(x.type==null?null:x.type)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&_&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var _=x.name==null?null:""+x.name;if(x.type==="hidden"&&s.getAttribute("name")===_)return s}else return s;if(s=vi(s.nextSibling),s===null)break}return null}function Gj(s,l,f){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!f||(s=vi(s.nextSibling),s===null))return null;return s}function AA(s,l){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=vi(s.nextSibling),s===null))return null;return s}function Ky(s){return s.data==="$?"||s.data==="$~"}function Qy(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function Hj(s,l){var f=s.ownerDocument;if(s.data==="$~")s._reactRetry=l;else if(s.data!=="$?"||f.readyState!=="loading")l();else{var g=function(){l(),f.removeEventListener("DOMContentLoaded",g)};f.addEventListener("DOMContentLoaded",g),s._reactRetry=g}}function vi(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return s}var Zy=null;function CA(s){s=s.nextSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="/$"||f==="/&"){if(l===0)return vi(s.nextSibling);l--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||l++}s=s.nextSibling}return null}function kA(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(l===0)return s;l--}else f!=="/$"&&f!=="/&"||l++}s=s.previousSibling}return null}function RA(s,l,f){switch(l=og(f),s){case"html":if(s=l.documentElement,!s)throw Error(r(452));return s;case"head":if(s=l.head,!s)throw Error(r(453));return s;case"body":if(s=l.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function nf(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);pc(s)}var yi=new Map,NA=new Set;function lg(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var hs=K.d;K.d={f:qj,r:Yj,D:Xj,C:Wj,L:Kj,m:Qj,X:Jj,S:Zj,M:e5};function qj(){var s=hs.f(),l=Jp();return s||l}function Yj(s){var l=oi(s);l!==null&&l.tag===5&&l.type==="form"?YS(l):hs.r(s)}var Wc=typeof document>"u"?null:document;function DA(s,l,f){var g=Wc;if(g&&typeof l=="string"&&l){var x=Ar(l);x='link[rel="'+s+'"][href="'+x+'"]',typeof f=="string"&&(x+='[crossorigin="'+f+'"]'),NA.has(x)||(NA.add(x),s={rel:s,crossOrigin:f,href:l},g.querySelector(x)===null&&(l=g.createElement("link"),Jn(l,"link",s),Tn(l),g.head.appendChild(l)))}}function Xj(s){hs.D(s),DA("dns-prefetch",s,null)}function Wj(s,l){hs.C(s,l),DA("preconnect",s,l)}function Kj(s,l,f){hs.L(s,l,f);var g=Wc;if(g&&s&&l){var x='link[rel="preload"][as="'+Ar(l)+'"]';l==="image"&&f&&f.imageSrcSet?(x+='[imagesrcset="'+Ar(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(x+='[imagesizes="'+Ar(f.imageSizes)+'"]')):x+='[href="'+Ar(s)+'"]';var _=x;switch(l){case"style":_=Kc(s);break;case"script":_=Qc(s)}yi.has(_)||(s=p({rel:"preload",href:l==="image"&&f&&f.imageSrcSet?void 0:s,as:l},f),yi.set(_,s),g.querySelector(x)!==null||l==="style"&&g.querySelector(rf(_))||l==="script"&&g.querySelector(af(_))||(l=g.createElement("link"),Jn(l,"link",s),Tn(l),g.head.appendChild(l)))}}function Qj(s,l){hs.m(s,l);var f=Wc;if(f&&s){var g=l&&typeof l.as=="string"?l.as:"script",x='link[rel="modulepreload"][as="'+Ar(g)+'"][href="'+Ar(s)+'"]',_=x;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=Qc(s)}if(!yi.has(_)&&(s=p({rel:"modulepreload",href:s},l),yi.set(_,s),f.querySelector(x)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(af(_)))return}g=f.createElement("link"),Jn(g,"link",s),Tn(g),f.head.appendChild(g)}}}function Zj(s,l,f){hs.S(s,l,f);var g=Wc;if(g&&s){var x=da(g).hoistableStyles,_=Kc(s);l=l||"default";var I=x.get(_);if(!I){var $={loading:0,preload:null};if(I=g.querySelector(rf(_)))$.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":l},f),(f=yi.get(_))&&Jy(s,f);var Z=I=g.createElement("link");Tn(Z),Jn(Z,"link",s),Z._p=new Promise(function(de,ve){Z.onload=de,Z.onerror=ve}),Z.addEventListener("load",function(){$.loading|=1}),Z.addEventListener("error",function(){$.loading|=2}),$.loading|=4,cg(I,l,g)}I={type:"stylesheet",instance:I,count:1,state:$},x.set(_,I)}}}function Jj(s,l){hs.X(s,l);var f=Wc;if(f&&s){var g=da(f).hoistableScripts,x=Qc(s),_=g.get(x);_||(_=f.querySelector(af(x)),_||(s=p({src:s,async:!0},l),(l=yi.get(x))&&eb(s,l),_=f.createElement("script"),Tn(_),Jn(_,"link",s),f.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},g.set(x,_))}}function e5(s,l){hs.M(s,l);var f=Wc;if(f&&s){var g=da(f).hoistableScripts,x=Qc(s),_=g.get(x);_||(_=f.querySelector(af(x)),_||(s=p({src:s,async:!0,type:"module"},l),(l=yi.get(x))&&eb(s,l),_=f.createElement("script"),Tn(_),Jn(_,"link",s),f.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},g.set(x,_))}}function IA(s,l,f,g){var x=(x=le.current)?lg(x):null;if(!x)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(l=Kc(f.href),f=da(x).hoistableStyles,g=f.get(l),g||(g={type:"style",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){s=Kc(f.href);var _=da(x).hoistableStyles,I=_.get(s);if(I||(x=x.ownerDocument||x,I={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(s,I),(_=x.querySelector(rf(s)))&&!_._p&&(I.instance=_,I.state.loading=5),yi.has(s)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},yi.set(s,f),_||t5(x,s,f,I.state))),l&&g===null)throw Error(r(528,""));return I}if(l&&g!==null)throw Error(r(529,""));return null;case"script":return l=f.async,f=f.src,typeof f=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Qc(f),f=da(x).hoistableScripts,g=f.get(l),g||(g={type:"script",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Kc(s){return'href="'+Ar(s)+'"'}function rf(s){return'link[rel="stylesheet"]['+s+"]"}function MA(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function t5(s,l,f,g){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?g.loading=1:(l=s.createElement("link"),g.preload=l,l.addEventListener("load",function(){return g.loading|=1}),l.addEventListener("error",function(){return g.loading|=2}),Jn(l,"link",f),Tn(l),s.head.appendChild(l))}function Qc(s){return'[src="'+Ar(s)+'"]'}function af(s){return"script[async]"+s}function OA(s,l,f){if(l.count++,l.instance===null)switch(l.type){case"style":var g=s.querySelector('style[data-href~="'+Ar(f.href)+'"]');if(g)return l.instance=g,Tn(g),g;var x=p({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return g=(s.ownerDocument||s).createElement("style"),Tn(g),Jn(g,"style",x),cg(g,f.precedence,s),l.instance=g;case"stylesheet":x=Kc(f.href);var _=s.querySelector(rf(x));if(_)return l.state.loading|=4,l.instance=_,Tn(_),_;g=MA(f),(x=yi.get(x))&&Jy(g,x),_=(s.ownerDocument||s).createElement("link"),Tn(_);var I=_;return I._p=new Promise(function($,Z){I.onload=$,I.onerror=Z}),Jn(_,"link",g),l.state.loading|=4,cg(_,f.precedence,s),l.instance=_;case"script":return _=Qc(f.src),(x=s.querySelector(af(_)))?(l.instance=x,Tn(x),x):(g=f,(x=yi.get(_))&&(g=p({},f),eb(g,x)),s=s.ownerDocument||s,x=s.createElement("script"),Tn(x),Jn(x,"link",g),s.head.appendChild(x),l.instance=x);case"void":return null;default:throw Error(r(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(g=l.instance,l.state.loading|=4,cg(g,f.precedence,s));return l.instance}function cg(s,l,f){for(var g=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=g.length?g[g.length-1]:null,_=x,I=0;I<g.length;I++){var $=g[I];if($.dataset.precedence===l)_=$;else if(_!==x)break}_?_.parentNode.insertBefore(s,_.nextSibling):(l=f.nodeType===9?f.head:f,l.insertBefore(s,l.firstChild))}function Jy(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function eb(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var ug=null;function PA(s,l,f){if(ug===null){var g=new Map,x=ug=new Map;x.set(f,g)}else x=ug,g=x.get(f),g||(g=new Map,x.set(f,g));if(g.has(s))return g;for(g.set(s,null),f=f.getElementsByTagName(s),x=0;x<f.length;x++){var _=f[x];if(!(_[ca]||_[Sn]||s==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var I=_.getAttribute(l)||"";I=s+I;var $=g.get(I);$?$.push(_):g.set(I,[_])}}return g}function jA(s,l,f){s=s.ownerDocument||s,s.head.insertBefore(f,l==="title"?s.querySelector("head > title"):null)}function n5(s,l,f){if(f===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return s=l.disabled,typeof l.precedence=="string"&&s==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function VA(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function r5(s,l,f,g){if(f.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var x=Kc(g.href),_=l.querySelector(rf(x));if(_){l=_._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(s.count++,s=dg.bind(s),l.then(s,s)),f.state.loading|=4,f.instance=_,Tn(_);return}_=l.ownerDocument||l,g=MA(g),(x=yi.get(x))&&Jy(g,x),_=_.createElement("link"),Tn(_);var I=_;I._p=new Promise(function($,Z){I.onload=$,I.onerror=Z}),Jn(_,"link",g),f.instance=_}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(f,l),(l=f.state.preload)&&(f.state.loading&3)===0&&(s.count++,f=dg.bind(s),l.addEventListener("load",f),l.addEventListener("error",f))}}var tb=0;function i5(s,l){return s.stylesheets&&s.count===0&&hg(s,s.stylesheets),0<s.count||0<s.imgCount?function(f){var g=setTimeout(function(){if(s.stylesheets&&hg(s,s.stylesheets),s.unsuspend){var _=s.unsuspend;s.unsuspend=null,_()}},6e4+l);0<s.imgBytes&&tb===0&&(tb=62500*zj());var x=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&hg(s,s.stylesheets),s.unsuspend)){var _=s.unsuspend;s.unsuspend=null,_()}},(s.imgBytes>tb?50:800)+l);return s.unsuspend=f,function(){s.unsuspend=null,clearTimeout(g),clearTimeout(x)}}:null}function dg(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)hg(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var fg=null;function hg(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,fg=new Map,l.forEach(a5,s),fg=null,dg.call(s))}function a5(s,l){if(!(l.state.loading&4)){var f=fg.get(s);if(f)var g=f.get(null);else{f=new Map,fg.set(s,f);for(var x=s.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<x.length;_++){var I=x[_];(I.nodeName==="LINK"||I.getAttribute("media")!=="not all")&&(f.set(I.dataset.precedence,I),g=I)}g&&f.set(null,g)}x=l.instance,I=x.getAttribute("data-precedence"),_=f.get(I)||g,_===g&&f.set(null,x),f.set(I,x),this.count++,g=dg.bind(this),x.addEventListener("load",g),x.addEventListener("error",g),_?_.parentNode.insertBefore(x,_.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(x,s.firstChild)),l.state.loading|=4}}var sf={$$typeof:N,Provider:null,Consumer:null,_currentValue:te,_currentValue2:te,_threadCount:0};function s5(s,l,f,g,x,_,I,$,Z){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=oa(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=oa(0),this.hiddenUpdates=oa(null),this.identifierPrefix=g,this.onUncaughtError=x,this.onCaughtError=_,this.onRecoverableError=I,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Z,this.incompleteTransitions=new Map}function zA(s,l,f,g,x,_,I,$,Z,de,ve,xe){return s=new s5(s,l,f,I,Z,de,ve,xe,$),l=1,_===!0&&(l|=24),_=Wr(3,null,null,l),s.current=_,_.stateNode=s,l=Ov(),l.refCount++,s.pooledCache=l,l.refCount++,_.memoizedState={element:g,isDehydrated:f,cache:l},zv(_),s}function LA(s){return s?(s=kc,s):kc}function BA(s,l,f,g,x,_){x=LA(x),g.context===null?g.context=x:g.pendingContext=x,g=eo(l),g.payload={element:f},_=_===void 0?null:_,_!==null&&(g.callback=_),f=to(s,g,l),f!==null&&(Ir(f,s,l),Vd(f,s,l))}function UA(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var f=s.retryLane;s.retryLane=f!==0&&f<l?f:l}}function nb(s,l){UA(s,l),(s=s.alternate)&&UA(s,l)}function FA(s){if(s.tag===13||s.tag===31){var l=wl(s,67108864);l!==null&&Ir(l,s,67108864),nb(s,67108864)}}function $A(s){if(s.tag===13||s.tag===31){var l=ei();l=cl(l);var f=wl(s,l);f!==null&&Ir(f,s,l),nb(s,l)}}var pg=!0;function o5(s,l,f,g){var x=q.T;q.T=null;var _=K.p;try{K.p=2,rb(s,l,f,g)}finally{K.p=_,q.T=x}}function l5(s,l,f,g){var x=q.T;q.T=null;var _=K.p;try{K.p=8,rb(s,l,f,g)}finally{K.p=_,q.T=x}}function rb(s,l,f,g){if(pg){var x=ib(g);if(x===null)$y(s,l,g,gg,f),HA(s,g);else if(u5(x,s,l,f,g))g.stopPropagation();else if(HA(s,g),l&4&&-1<c5.indexOf(s)){for(;x!==null;){var _=oi(x);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var I=Hr(_.pendingLanes);if(I!==0){var $=_;for($.pendingLanes|=2,$.entangledLanes|=2;I;){var Z=1<<31-tn(I);$.entanglements[1]|=Z,I&=~Z}Sa(_),(Dt&6)===0&&(Qp=ut()+500,Jd(0))}}break;case 31:case 13:$=wl(_,2),$!==null&&Ir($,_,2),Jp(),nb(_,2)}if(_=ib(g),_===null&&$y(s,l,g,gg,f),_===x)break;x=_}x!==null&&g.stopPropagation()}else $y(s,l,g,null,f)}}function ib(s){return s=li(s),ab(s)}var gg=null;function ab(s){if(gg=null,s=ua(s),s!==null){var l=a(s);if(l===null)s=null;else{var f=l.tag;if(f===13){if(s=o(l),s!==null)return s;s=null}else if(f===31){if(s=c(l),s!==null)return s;s=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return gg=s,null}function GA(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Rt()){case cn:return 2;case Mt:return 8;case _n:case $r:return 32;case sa:return 268435456;default:return 32}default:return 32}}var sb=!1,ho=null,po=null,go=null,of=new Map,lf=new Map,mo=[],c5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function HA(s,l){switch(s){case"focusin":case"focusout":ho=null;break;case"dragenter":case"dragleave":po=null;break;case"mouseover":case"mouseout":go=null;break;case"pointerover":case"pointerout":of.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":lf.delete(l.pointerId)}}function cf(s,l,f,g,x,_){return s===null||s.nativeEvent!==_?(s={blockedOn:l,domEventName:f,eventSystemFlags:g,nativeEvent:_,targetContainers:[x]},l!==null&&(l=oi(l),l!==null&&FA(l)),s):(s.eventSystemFlags|=g,l=s.targetContainers,x!==null&&l.indexOf(x)===-1&&l.push(x),s)}function u5(s,l,f,g,x){switch(l){case"focusin":return ho=cf(ho,s,l,f,g,x),!0;case"dragenter":return po=cf(po,s,l,f,g,x),!0;case"mouseover":return go=cf(go,s,l,f,g,x),!0;case"pointerover":var _=x.pointerId;return of.set(_,cf(of.get(_)||null,s,l,f,g,x)),!0;case"gotpointercapture":return _=x.pointerId,lf.set(_,cf(lf.get(_)||null,s,l,f,g,x)),!0}return!1}function qA(s){var l=ua(s.target);if(l!==null){var f=a(l);if(f!==null){if(l=f.tag,l===13){if(l=o(f),l!==null){s.blockedOn=l,Oi(s.priority,function(){$A(f)});return}}else if(l===31){if(l=c(f),l!==null){s.blockedOn=l,Oi(s.priority,function(){$A(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){s.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}s.blockedOn=null}function mg(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var f=ib(s.nativeEvent);if(f===null){f=s.nativeEvent;var g=new f.constructor(f.type,f);wd=g,f.target.dispatchEvent(g),wd=null}else return l=oi(f),l!==null&&FA(l),s.blockedOn=f,!1;l.shift()}return!0}function YA(s,l,f){mg(s)&&f.delete(l)}function d5(){sb=!1,ho!==null&&mg(ho)&&(ho=null),po!==null&&mg(po)&&(po=null),go!==null&&mg(go)&&(go=null),of.forEach(YA),lf.forEach(YA)}function vg(s,l){s.blockedOn===l&&(s.blockedOn=null,sb||(sb=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,d5)))}var yg=null;function XA(s){yg!==s&&(yg=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){yg===s&&(yg=null);for(var l=0;l<s.length;l+=3){var f=s[l],g=s[l+1],x=s[l+2];if(typeof g!="function"){if(ab(g||f)===null)continue;break}var _=oi(f);_!==null&&(s.splice(l,3),l-=3,iy(_,{pending:!0,data:x,method:f.method,action:g},g,x))}}))}function Zc(s){function l(Z){return vg(Z,s)}ho!==null&&vg(ho,s),po!==null&&vg(po,s),go!==null&&vg(go,s),of.forEach(l),lf.forEach(l);for(var f=0;f<mo.length;f++){var g=mo[f];g.blockedOn===s&&(g.blockedOn=null)}for(;0<mo.length&&(f=mo[0],f.blockedOn===null);)qA(f),f.blockedOn===null&&mo.shift();if(f=(s.ownerDocument||s).$$reactFormReplay,f!=null)for(g=0;g<f.length;g+=3){var x=f[g],_=f[g+1],I=x[Hn]||null;if(typeof _=="function")I||XA(f);else if(I){var $=null;if(_&&_.hasAttribute("formAction")){if(x=_,I=_[Hn]||null)$=I.formAction;else if(ab(x)!==null)continue}else $=I.action;typeof $=="function"?f[g+1]=$:(f.splice(g,3),g-=3),XA(f)}}}function WA(){function s(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(I){return x=I})},focusReset:"manual",scroll:"manual"})}function l(){x!==null&&(x(),x=null),g||setTimeout(f,20)}function f(){if(!g&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,x=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(f,100),function(){g=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),x!==null&&(x(),x=null)}}}function ob(s){this._internalRoot=s}bg.prototype.render=ob.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(r(409));var f=l.current,g=ei();BA(f,g,s,l,null,null)},bg.prototype.unmount=ob.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;BA(s.current,2,null,s,null,null),Jp(),l[la]=null}};function bg(s){this._internalRoot=s}bg.prototype.unstable_scheduleHydration=function(s){if(s){var l=Jh();s={blockedOn:null,target:s,priority:l};for(var f=0;f<mo.length&&l!==0&&l<mo[f].priority;f++);mo.splice(f,0,s),f===0&&qA(s)}};var KA=e.version;if(KA!=="19.2.0")throw Error(r(527,KA,"19.2.0"));K.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(l),s=s!==null?h(s):null,s=s===null?null:s.stateNode,s};var f5={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xg.isDisabled&&xg.supportsFiber)try{Gr=xg.inject(f5),En=xg}catch{}}return df.createRoot=function(s,l){if(!i(s))throw Error(r(299));var f=!1,g="",x=rT,_=iT,I=aT;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(_=l.onCaughtError),l.onRecoverableError!==void 0&&(I=l.onRecoverableError)),l=zA(s,1,!1,null,null,f,g,null,x,_,I,WA),s[la]=l.current,Fy(s),new ob(l)},df.hydrateRoot=function(s,l,f){if(!i(s))throw Error(r(299));var g=!1,x="",_=rT,I=iT,$=aT,Z=null;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onUncaughtError!==void 0&&(_=f.onUncaughtError),f.onCaughtError!==void 0&&(I=f.onCaughtError),f.onRecoverableError!==void 0&&($=f.onRecoverableError),f.formState!==void 0&&(Z=f.formState)),l=zA(s,1,!0,l,f??null,g,x,Z,_,I,$,WA),l.context=LA(null),f=l.current,g=ei(),g=cl(g),x=eo(g),x.callback=null,to(f,x,g),f=g,l.current.lanes=f,ol(l,f),Sa(l),s[la]=l.current,Fy(s),new bg(l)},df.version="19.2.0",df}var sC;function E5(){if(sC)return ub.exports;sC=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),ub.exports=_5(),ub.exports}var S5=E5();const T5="modulepreload",A5=function(t){return"/personal-budget-pwa/"+t},oC={},Tt=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){let u=function(d){return Promise.all(d.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");i=u(n.map(d=>{if(d=A5(d),d in oC)return;oC[d]=!0;const h=d.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${p}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":T5,h||(m.as="script"),m.crossOrigin="",m.href=d,c&&m.setAttribute("nonce",c),document.head.appendChild(m),h)return new Promise((b,w)=>{m.addEventListener("load",b),m.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return i.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};function C5(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:a,onRegisterError:o}=t;let c,u;const d=async(p=!0)=>{await u};async function h(){if("serviceWorker"in navigator){if(c=await Tt(async()=>{const{Workbox:p}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/personal-budget-pwa/sw.js",{scope:"/personal-budget-pwa/",type:"classic"})).catch(p=>{o?.(p)}),!c)return;c.addEventListener("activated",p=>{(p.isUpdate||p.isExternal)&&window.location.reload()}),c.addEventListener("installed",p=>{p.isUpdate||r?.()}),c.register({immediate:e}).then(p=>{a?a("/personal-budget-pwa/sw.js",p):i?.(p)}).catch(p=>{o?.(p)})}}return u=h(),d}const k5=()=>{};var lC={};const kN=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},R5=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[n++];e[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[n++],o=t[n++],c=t[n++],u=((i&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const a=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return e.join("")},K1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const a=t[i],o=i+1<t.length,c=o?t[i+1]:0,u=i+2<t.length,d=u?t[i+2]:0,h=a>>2,p=(a&3)<<4|c>>4;let m=(c&15)<<2|d>>6,b=d&63;u||(b=64,o||(m=64)),r.push(n[h],n[p],n[m],n[b])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(kN(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):R5(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const a=n[t.charAt(i++)],c=i<t.length?n[t.charAt(i)]:0;++i;const d=i<t.length?n[t.charAt(i)]:64;++i;const p=i<t.length?n[t.charAt(i)]:64;if(++i,a==null||c==null||d==null||p==null)throw new N5;const m=a<<2|c>>4;if(r.push(m),d!==64){const b=c<<4&240|d>>2;if(r.push(b),p!==64){const w=d<<6&192|p;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class N5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const D5=function(t){const e=kN(t);return K1.encodeByteArray(e,!0)},vm=function(t){return D5(t).replace(/\./g,"")},RN=function(t){try{return K1.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function NN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const I5=()=>NN().__FIREBASE_DEFAULTS__,M5=()=>{if(typeof process>"u"||typeof lC>"u")return;const t=lC.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},O5=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&RN(t[1]);return e&&JSON.parse(e)},f0=()=>{try{return k5()||I5()||M5()||O5()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},DN=t=>f0()?.emulatorHosts?.[t],IN=t=>{const e=DN(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},MN=()=>f0()?.config,ON=t=>f0()?.[`_${t}`];class Gf{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}function el(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Q1(t){return(await fetch(t,{credentials:"include"})).ok}function P5(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...t};return[vm(JSON.stringify(n)),vm(JSON.stringify(o)),""].join(".")}const Cf={};function j5(){const t={prod:[],emulator:[]};for(const e of Object.keys(Cf))Cf[e]?t.emulator.push(e):t.prod.push(e);return t}function V5(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let cC=!1;function Z1(t,e){if(typeof window>"u"||typeof document>"u"||!el(window.location.host)||Cf[t]===e||Cf[t]||cC)return;Cf[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",a=j5().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function c(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,b){m.setAttribute("width","24"),m.setAttribute("id",b),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{cC=!0,o()},m}function h(m,b){m.setAttribute("id",b),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=V5(r),b=n("text"),w=document.getElementById(b)||document.createElement("span"),E=n("learnmore"),S=document.getElementById(E)||document.createElement("a"),T=n("preprendIcon"),C=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const N=m.element;c(N),h(S,E);const j=d();u(C,T),N.append(C,w,S,j),document.body.appendChild(N)}a?(w.innerText="Preview backend disconnected.",C.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(C.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function fr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function z5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(fr())}function L5(){const t=f0()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function B5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function U5(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function F5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function $5(){const t=fr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function G5(){return!L5()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function J1(){try{return typeof indexedDB=="object"}catch{return!1}}function H5(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(n){e(n)}})}const q5="FirebaseError";class Ga extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=q5,Object.setPrototypeOf(this,Ga.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Hu.prototype.create)}}class Hu{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,a=this.errors[e],o=a?Y5(a,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new Ga(i,c,r)}}function Y5(t,e){return t.replace(X5,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const X5=/\{\$([^}]+)}/g;function W5(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Lo(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const a=t[i],o=e[i];if(uC(a)&&uC(o)){if(!Lo(a,o))return!1}else if(a!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function uC(t){return t!==null&&typeof t=="object"}function yh(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function mf(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,a]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function vf(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function K5(t,e){const n=new Q5(t,e);return n.subscribe.bind(n)}class Q5{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Z5(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=pb),i.error===void 0&&(i.error=pb),i.complete===void 0&&(i.complete=pb);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Z5(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function pb(){}const J5=1e3,eV=2,tV=14400*1e3,nV=.5;function rV(t,e=J5,n=eV){const r=e*Math.pow(n,t),i=Math.round(nV*r*(Math.random()-.5)*2);return Math.min(tV,r+i)}function It(t){return t&&t._delegate?t._delegate:t}let La=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};const Pl="[DEFAULT]";let iV=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Gf;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(sV(e))try{this.getOrInitializeService({instanceIdentifier:Pl})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const a=this.getOrInitializeService({instanceIdentifier:i});r.resolve(a)}catch{}}}}clearInstance(e=Pl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Pl){return this.instances.has(e)}getOptions(e=Pl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[a,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);r===c&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const a=this.instances.get(r);return a&&e(a,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:aV(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Pl){return this.component?this.component.multipleInstances?e:Pl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function aV(t){return t===Pl?void 0:t}function sV(t){return t.instantiationMode==="EAGER"}class oV{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new iV(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var bt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(bt||(bt={}));const lV={debug:bt.DEBUG,verbose:bt.VERBOSE,info:bt.INFO,warn:bt.WARN,error:bt.ERROR,silent:bt.SILENT},cV=bt.INFO,uV={[bt.DEBUG]:"log",[bt.VERBOSE]:"log",[bt.INFO]:"info",[bt.WARN]:"warn",[bt.ERROR]:"error"},dV=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=uV[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class h0{constructor(e){this.name=e,this._logLevel=cV,this._logHandler=dV,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in bt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?lV[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,bt.DEBUG,...e),this._logHandler(this,bt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,bt.VERBOSE,...e),this._logHandler(this,bt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,bt.INFO,...e),this._logHandler(this,bt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,bt.WARN,...e),this._logHandler(this,bt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,bt.ERROR,...e),this._logHandler(this,bt.ERROR,...e)}}const fV=(t,e)=>e.some(n=>t instanceof n);let dC,fC;function hV(){return dC||(dC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function pV(){return fC||(fC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const PN=new WeakMap,mx=new WeakMap,jN=new WeakMap,gb=new WeakMap,ew=new WeakMap;function gV(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{n(Oo(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&PN.set(n,t)}).catch(()=>{}),ew.set(e,t),e}function mV(t){if(mx.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});mx.set(t,e)}let vx={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return mx.get(t);if(e==="objectStoreNames")return t.objectStoreNames||jN.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Oo(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function vV(t){vx=t(vx)}function yV(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(mb(this),e,...n);return jN.set(r,e.sort?e.sort():[e]),Oo(r)}:pV().includes(t)?function(...e){return t.apply(mb(this),e),Oo(PN.get(this))}:function(...e){return Oo(t.apply(mb(this),e))}}function bV(t){return typeof t=="function"?yV(t):(t instanceof IDBTransaction&&mV(t),fV(t,hV())?new Proxy(t,vx):t)}function Oo(t){if(t instanceof IDBRequest)return gV(t);if(gb.has(t))return gb.get(t);const e=bV(t);return e!==t&&(gb.set(t,e),ew.set(e,t)),e}const mb=t=>ew.get(t);function xV(t,e,{blocked:n,upgrade:r,blocking:i,terminated:a}={}){const o=indexedDB.open(t,e),c=Oo(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Oo(o.result),u.oldVersion,u.newVersion,Oo(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),c.then(u=>{a&&u.addEventListener("close",()=>a()),i&&u.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const wV=["get","getKey","getAll","getAllKeys","count"],_V=["put","add","delete","clear"],vb=new Map;function hC(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(vb.get(e))return vb.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=_V.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||wV.includes(n)))return;const a=async function(o,...c){const u=this.transaction(o,i?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[n](...c),i&&u.done]))[0]};return vb.set(e,a),a}vV(t=>({...t,get:(e,n,r)=>hC(e,n)||t.get(e,n,r),has:(e,n)=>!!hC(e,n)||t.has(e,n)}));class EV{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(SV(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function SV(t){return t.getComponent()?.type==="VERSION"}const yx="@firebase/app",pC="0.14.6";const As=new h0("@firebase/app"),TV="@firebase/app-compat",AV="@firebase/analytics-compat",CV="@firebase/analytics",kV="@firebase/app-check-compat",RV="@firebase/app-check",NV="@firebase/auth",DV="@firebase/auth-compat",IV="@firebase/database",MV="@firebase/data-connect",OV="@firebase/database-compat",PV="@firebase/functions",jV="@firebase/functions-compat",VV="@firebase/installations",zV="@firebase/installations-compat",LV="@firebase/messaging",BV="@firebase/messaging-compat",UV="@firebase/performance",FV="@firebase/performance-compat",$V="@firebase/remote-config",GV="@firebase/remote-config-compat",HV="@firebase/storage",qV="@firebase/storage-compat",YV="@firebase/firestore",XV="@firebase/ai",WV="@firebase/firestore-compat",KV="firebase",QV="12.6.0";const bx="[DEFAULT]",ZV={[yx]:"fire-core",[TV]:"fire-core-compat",[CV]:"fire-analytics",[AV]:"fire-analytics-compat",[RV]:"fire-app-check",[kV]:"fire-app-check-compat",[NV]:"fire-auth",[DV]:"fire-auth-compat",[IV]:"fire-rtdb",[MV]:"fire-data-connect",[OV]:"fire-rtdb-compat",[PV]:"fire-fn",[jV]:"fire-fn-compat",[VV]:"fire-iid",[zV]:"fire-iid-compat",[LV]:"fire-fcm",[BV]:"fire-fcm-compat",[UV]:"fire-perf",[FV]:"fire-perf-compat",[$V]:"fire-rc",[GV]:"fire-rc-compat",[HV]:"fire-gcs",[qV]:"fire-gcs-compat",[YV]:"fire-fst",[WV]:"fire-fst-compat",[XV]:"fire-vertex","fire-js":"fire-js",[KV]:"fire-js-all"};const ym=new Map,JV=new Map,xx=new Map;function gC(t,e){try{t.container.addComponent(e)}catch(n){As.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Cs(t){const e=t.name;if(xx.has(e))return As.debug(`There were multiple attempts to register component ${e}.`),!1;xx.set(e,t);for(const n of ym.values())gC(n,t);for(const n of JV.values())gC(n,t);return!0}function qu(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function ni(t){return t==null?!1:t.settings!==void 0}const e6={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Po=new Hu("app","Firebase",e6);class t6{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new La("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Po.create("app-deleted",{appName:this._name})}}const Yu=QV;function VN(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:bx,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Po.create("bad-app-name",{appName:String(i)});if(n||(n=MN()),!n)throw Po.create("no-options");const a=ym.get(i);if(a){if(Lo(n,a.options)&&Lo(r,a.config))return a;throw Po.create("duplicate-app",{appName:i})}const o=new oV(i);for(const u of xx.values())o.addComponent(u);const c=new t6(n,r,o);return ym.set(i,c),c}function p0(t=bx){const e=ym.get(t);if(!e&&t===bx&&MN())return VN();if(!e)throw Po.create("no-app",{appName:t});return e}function Wi(t,e,n){let r=ZV[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),As.warn(o.join(" "));return}Cs(new La(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const n6="firebase-heartbeat-database",r6=1,Hf="firebase-heartbeat-store";let yb=null;function zN(){return yb||(yb=xV(n6,r6,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Hf)}catch(n){console.warn(n)}}}}).catch(t=>{throw Po.create("idb-open",{originalErrorMessage:t.message})})),yb}async function i6(t){try{const n=(await zN()).transaction(Hf),r=await n.objectStore(Hf).get(LN(t));return await n.done,r}catch(e){if(e instanceof Ga)As.warn(e.message);else{const n=Po.create("idb-get",{originalErrorMessage:e?.message});As.warn(n.message)}}}async function mC(t,e){try{const r=(await zN()).transaction(Hf,"readwrite");await r.objectStore(Hf).put(e,LN(t)),await r.done}catch(n){if(n instanceof Ga)As.warn(n.message);else{const r=Po.create("idb-set",{originalErrorMessage:n?.message});As.warn(r.message)}}}function LN(t){return`${t.name}!${t.options.appId}`}const a6=1024,s6=30;class o6{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new c6(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=vC();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>s6){const i=u6(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){As.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=vC(),{heartbeatsToSend:n,unsentEntries:r}=l6(this._heartbeatsCache.heartbeats),i=vm(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return As.warn(e),""}}}function vC(){return new Date().toISOString().substring(0,10)}function l6(t,e=a6){const n=[];let r=t.slice();for(const i of t){const a=n.find(o=>o.agent===i.agent);if(a){if(a.dates.push(i.date),yC(n)>e){a.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),yC(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class c6{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return J1()?H5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await i6(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return mC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return mC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function yC(t){return vm(JSON.stringify({version:2,heartbeats:t})).length}function u6(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}function d6(t){Cs(new La("platform-logger",e=>new EV(e),"PRIVATE")),Cs(new La("heartbeat",e=>new o6(e),"PRIVATE")),Wi(yx,pC,t),Wi(yx,pC,"esm2020"),Wi("fire-js","")}d6("");function BN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const f6=BN,UN=new Hu("auth","Firebase",BN());const bm=new h0("@firebase/auth");function h6(t,...e){bm.logLevel<=bt.WARN&&bm.warn(`Auth (${Yu}): ${t}`,...e)}function Kg(t,...e){bm.logLevel<=bt.ERROR&&bm.error(`Auth (${Yu}): ${t}`,...e)}function Ji(t,...e){throw tw(t,...e)}function Na(t,...e){return tw(t,...e)}function FN(t,e,n){const r={...f6(),[e]:n};return new Hu("auth","Firebase",r).create(e,{appName:t.name})}function xs(t){return FN(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function tw(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return UN.create(t,...e)}function Ye(t,e,...n){if(!t)throw tw(e,...n)}function vs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Kg(e),new Error(e)}function ks(t,e){t||vs(e)}function wx(){return typeof self<"u"&&self.location?.href||""}function p6(){return bC()==="http:"||bC()==="https:"}function bC(){return typeof self<"u"&&self.location?.protocol||null}function g6(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(p6()||U5()||"connection"in navigator)?navigator.onLine:!0}function m6(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class bh{constructor(e,n){this.shortDelay=e,this.longDelay=n,ks(n>e,"Short delay should be less than long delay!"),this.isMobile=z5()||F5()}get(){return g6()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function nw(t,e){ks(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class $N{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;vs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;vs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;vs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const v6={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const y6=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],b6=new bh(3e4,6e4);function ia(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Ii(t,e,n,r,i={}){return GN(t,i,async()=>{let a={},o={};r&&(e==="GET"?o=r:a={body:JSON.stringify(r)});const c=yh({key:t.config.apiKey,...o}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:u,...a};return B5()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&el(t.emulatorConfig.host)&&(d.credentials="include"),$N.fetch()(await HN(t,t.config.apiHost,n,c),d)})}async function GN(t,e,n){t._canInitEmulator=!1;const r={...v6,...e};try{const i=new w6(t),a=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw wg(t,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const c=a.ok?o.errorMessage:o.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw wg(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw wg(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw wg(t,"user-disabled",o);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw FN(t,h,d);Ji(t,h)}}catch(i){if(i instanceof Ga)throw i;Ji(t,"network-request-failed",{message:String(i)})}}async function xh(t,e,n,r,i={}){const a=await Ii(t,e,n,r,i);return"mfaPendingCredential"in a&&Ji(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function HN(t,e,n,r){const i=`${e}${n}?${r}`,a=t,o=a.config.emulator?nw(t.config,i):`${t.config.apiScheme}://${i}`;return y6.includes(n)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(o).toString():o}function x6(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class w6{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Na(this.auth,"network-request-failed")),b6.get())})}}function wg(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Na(t,e,r);return i.customData._tokenResponse=n,i}function xC(t){return t!==void 0&&t.enterprise!==void 0}class _6{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return x6(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function E6(t,e){return Ii(t,"GET","/v2/recaptchaConfig",ia(t,e))}async function S6(t,e){return Ii(t,"POST","/v1/accounts:delete",e)}async function xm(t,e){return Ii(t,"POST","/v1/accounts:lookup",e)}function kf(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function T6(t,e=!1){const n=It(t),r=await n.getIdToken(e),i=rw(r);Ye(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,o=a?.sign_in_provider;return{claims:i,token:r,authTime:kf(bb(i.auth_time)),issuedAtTime:kf(bb(i.iat)),expirationTime:kf(bb(i.exp)),signInProvider:o||null,signInSecondFactor:a?.sign_in_second_factor||null}}function bb(t){return Number(t)*1e3}function rw(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Kg("JWT malformed, contained fewer than 3 sections"),null;try{const i=RN(n);return i?JSON.parse(i):(Kg("Failed to decode base64 JWT payload"),null)}catch(i){return Kg("Caught error parsing JWT payload as JSON",i?.toString()),null}}function wC(t){const e=rw(t);return Ye(e,"internal-error"),Ye(typeof e.exp<"u","internal-error"),Ye(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Tu(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Ga&&A6(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function A6({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class C6{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class _x{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=kf(this.lastLoginAt),this.creationTime=kf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function wm(t){const e=t.auth,n=await t.getIdToken(),r=await Tu(t,xm(e,{idToken:n}));Ye(r?.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const a=i.providerUserInfo?.length?qN(i.providerUserInfo):[],o=R6(t.providerData,a),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!o?.length,d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new _x(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function k6(t){const e=It(t);await wm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function R6(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function qN(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function N6(t,e){const n=await GN(t,{},async()=>{const r=yh({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=t.config,o=await HN(t,i,"/v1/token",`key=${a}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:r};return t.emulatorConfig&&el(t.emulatorConfig.host)&&(u.credentials="include"),$N.fetch()(o,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function D6(t,e){return Ii(t,"POST","/v2/accounts:revokeToken",ia(t,e))}class yu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ye(e.idToken,"internal-error"),Ye(typeof e.idToken<"u","internal-error"),Ye(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):wC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ye(e.length!==0,"internal-error");const n=wC(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ye(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:a}=await N6(e,n);this.updateTokensAndExpiration(r,i,Number(a))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:a}=n,o=new yu;return r&&(Ye(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Ye(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),a&&(Ye(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new yu,this.toJSON())}_performRefresh(){return vs("not implemented")}}function yo(t,e){Ye(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Xi{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new C6(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new _x(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Tu(this,this.stsTokenManager.getToken(this.auth,e));return Ye(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return T6(this,e)}reload(){return k6(this)}_assign(e){this!==e&&(Ye(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Xi({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Ye(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await wm(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ni(this.auth.app))return Promise.reject(xs(this.auth));const e=await this.getIdToken();return await Tu(this,S6(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,a=n.phoneNumber??void 0,o=n.photoURL??void 0,c=n.tenantId??void 0,u=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:b,providerData:w,stsTokenManager:E}=n;Ye(p&&E,e,"internal-error");const S=yu.fromJSON(this.name,E);Ye(typeof p=="string",e,"internal-error"),yo(r,e.name),yo(i,e.name),Ye(typeof m=="boolean",e,"internal-error"),Ye(typeof b=="boolean",e,"internal-error"),yo(a,e.name),yo(o,e.name),yo(c,e.name),yo(u,e.name),yo(d,e.name),yo(h,e.name);const T=new Xi({uid:p,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:b,photoURL:o,phoneNumber:a,tenantId:c,stsTokenManager:S,createdAt:d,lastLoginAt:h});return w&&Array.isArray(w)&&(T.providerData=w.map(C=>({...C}))),u&&(T._redirectEventId=u),T}static async _fromIdTokenResponse(e,n,r=!1){const i=new yu;i.updateFromServerResponse(n);const a=new Xi({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await wm(a),a}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];Ye(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?qN(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!a?.length,c=new yu;c.updateFromIdToken(r);const u=new Xi({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new _x(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(u,d),u}}const _C=new Map;function ys(t){ks(t instanceof Function,"Expected a class definition");let e=_C.get(t);return e?(ks(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,_C.set(t,e),e)}class YN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}YN.type="NONE";const EC=YN;function Qg(t,e,n){return`firebase:${t}:${e}:${n}`}class bu{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:a}=this.auth;this.fullUserKey=Qg(this.userKey,i.apiKey,a),this.fullPersistenceKey=Qg("persistence",i.apiKey,a),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await xm(this.auth,{idToken:e}).catch(()=>{});return n?Xi._fromGetAccountInfoResponse(this.auth,n,e):null}return Xi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new bu(ys(EC),e,r);const i=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let a=i[0]||ys(EC);const o=Qg(r,e.config.apiKey,e.name);let c=null;for(const d of n)try{const h=await d._get(o);if(h){let p;if(typeof h=="string"){const m=await xm(e,{idToken:h}).catch(()=>{});if(!m)break;p=await Xi._fromGetAccountInfoResponse(e,m,h)}else p=Xi._fromJSON(e,h);d!==a&&(c=p),a=d;break}}catch{}const u=i.filter(d=>d._shouldAllowMigration);return!a._shouldAllowMigration||!u.length?new bu(a,e,r):(a=u[0],c&&await a._set(o,c.toJSON()),await Promise.all(n.map(async d=>{if(d!==a)try{await d._remove(o)}catch{}})),new bu(a,e,r))}}function SC(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(QN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(XN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(JN(e))return"Blackberry";if(eD(e))return"Webos";if(WN(e))return"Safari";if((e.includes("chrome/")||KN(e))&&!e.includes("edge/"))return"Chrome";if(ZN(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if(r?.length===2)return r[1]}return"Other"}function XN(t=fr()){return/firefox\//i.test(t)}function WN(t=fr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function KN(t=fr()){return/crios\//i.test(t)}function QN(t=fr()){return/iemobile/i.test(t)}function ZN(t=fr()){return/android/i.test(t)}function JN(t=fr()){return/blackberry/i.test(t)}function eD(t=fr()){return/webos/i.test(t)}function iw(t=fr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function I6(t=fr()){return iw(t)&&!!window.navigator?.standalone}function M6(){return $5()&&document.documentMode===10}function tD(t=fr()){return iw(t)||ZN(t)||eD(t)||JN(t)||/windows phone/i.test(t)||QN(t)}function nD(t,e=[]){let n;switch(t){case"Browser":n=SC(fr());break;case"Worker":n=`${SC(fr())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Yu}/${r}`}class O6{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=a=>new Promise((o,c)=>{try{const u=e(a);o(u)}catch(u){c(u)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function P6(t,e={}){return Ii(t,"GET","/v2/passwordPolicy",ia(t,e))}const j6=6;class V6{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??j6,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class z6{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new TC(this),this.idTokenSubscription=new TC(this),this.beforeStateQueue=new O6(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=UN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ys(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await bu.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await xm(this,{idToken:e}),r=await Xi._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ni(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,o=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===o)&&c?.user&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ye(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await wm(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=m6()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ni(this.app))return Promise.reject(xs(this));const n=e?It(e):null;return n&&Ye(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ye(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ni(this.app)?Promise.reject(xs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ni(this.app)?Promise.reject(xs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ys(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await P6(this),n=new V6(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Hu("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await D6(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ys(e)||this._popupRedirectResolver;Ye(n,this,"argument-error"),this.redirectPersistenceManager=await bu.create(this,[ys(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const a=typeof n=="function"?n:n.next.bind(n);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ye(c,this,"internal-error"),c.then(()=>{o||a(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,i);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ye(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=nD(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(ni(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&h6(`Error while retrieving App Check token: ${e.error}`),e?.token}}function tl(t){return It(t)}class TC{constructor(e){this.auth=e,this.observer=null,this.addObserver=K5(n=>this.observer=n)}get next(){return Ye(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let g0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function L6(t){g0=t}function rD(t){return g0.loadJS(t)}function B6(){return g0.recaptchaEnterpriseScript}function U6(){return g0.gapiScript}function F6(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class $6{constructor(){this.enterprise=new G6}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class G6{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const H6="recaptcha-enterprise",iD="NO_RECAPTCHA";class q6{constructor(e){this.type=H6,this.auth=tl(e)}async verify(e="verify",n=!1){async function r(a){if(!n){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,c)=>{E6(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new _6(u);return a.tenantId==null?a._agentRecaptchaConfig=d:a._tenantRecaptchaConfigs[a.tenantId]=d,o(d.siteKey)}}).catch(u=>{c(u)})})}function i(a,o,c){const u=window.grecaptcha;xC(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:e}).then(d=>{o(d)}).catch(()=>{o(iD)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new $6().execute("siteKey",{action:"verify"}):new Promise((a,o)=>{r(this.auth).then(c=>{if(!n&&xC(window.grecaptcha))i(c,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=B6();u.length!==0&&(u+=c),rD(u).then(()=>{i(c,a,o)}).catch(d=>{o(d)})}}).catch(c=>{o(c)})})}}async function AC(t,e,n,r=!1,i=!1){const a=new q6(t);let o;if(i)o=iD;else try{o=await a.verify(n)}catch{o=await a.verify(n,!0)}const c={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function _m(t,e,n,r,i){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await AC(t,e,n,n==="getOobCode");return r(t,a)}else return r(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await AC(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(a)})}function Y6(t,e){const n=qu(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),a=n.getOptions();if(Lo(a,e??{}))return i;Ji(i,"already-initialized")}return n.initialize({options:e})}function X6(t,e){const n=e?.persistence||[],r=(Array.isArray(n)?n:[n]).map(ys);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e?.popupRedirectResolver)}function W6(t,e,n){const r=tl(t);Ye(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,a=aD(e),{host:o,port:c}=K6(e),u=c===null?"":`:${c}`,d={url:`${a}//${o}${u}/`},h=Object.freeze({host:o,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Ye(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Ye(Lo(d,r.config.emulator)&&Lo(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,el(o)?(Q1(`${a}//${o}${u}`),Z1("Auth",!0)):Q6()}function aD(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function K6(t){const e=aD(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const a=i[1];return{host:a,port:CC(r.substr(a.length+1))}}else{const[a,o]=r.split(":");return{host:a,port:CC(o)}}}function CC(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Q6(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class aw{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return vs("not implemented")}_getIdTokenResponse(e){return vs("not implemented")}_linkToIdToken(e,n){return vs("not implemented")}_getReauthenticationResolver(e){return vs("not implemented")}}async function Z6(t,e){return Ii(t,"POST","/v1/accounts:resetPassword",ia(t,e))}async function J6(t,e){return Ii(t,"POST","/v1/accounts:signUp",e)}async function ez(t,e){return Ii(t,"POST","/v1/accounts:update",ia(t,e))}async function tz(t,e){return xh(t,"POST","/v1/accounts:signInWithPassword",ia(t,e))}async function sD(t,e){return Ii(t,"POST","/v1/accounts:sendOobCode",ia(t,e))}async function nz(t,e){return sD(t,e)}async function rz(t,e){return sD(t,e)}async function iz(t,e){return xh(t,"POST","/v1/accounts:signInWithEmailLink",ia(t,e))}async function az(t,e){return xh(t,"POST","/v1/accounts:signInWithEmailLink",ia(t,e))}class qf extends aw{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new qf(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new qf(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return _m(e,n,"signInWithPassword",tz);case"emailLink":return iz(e,{email:this._email,oobCode:this._password});default:Ji(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return _m(e,r,"signUpPassword",J6);case"emailLink":return az(e,{idToken:n,email:this._email,oobCode:this._password});default:Ji(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function xu(t,e){return xh(t,"POST","/v1/accounts:signInWithIdp",ia(t,e))}const sz="http://localhost";class Ql extends aw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ql(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Ji("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...a}=n;if(!r||!i)return null;const o=new Ql(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return xu(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,xu(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,xu(e,n)}buildRequest(){const e={requestUri:sz,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=yh(n)}return e}}function oz(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function lz(t){const e=mf(vf(t)).link,n=e?mf(vf(e)).deep_link_id:null,r=mf(vf(t)).deep_link_id;return(r?mf(vf(r)).link:null)||r||n||e||t}class sw{constructor(e){const n=mf(vf(e)),r=n.apiKey??null,i=n.oobCode??null,a=oz(n.mode??null);Ye(r&&i&&a,"argument-error"),this.apiKey=r,this.operation=a,this.code=i,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=lz(e);try{return new sw(n)}catch{return null}}}class ac{constructor(){this.providerId=ac.PROVIDER_ID}static credential(e,n){return qf._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=sw.parseLink(n);return Ye(r,"argument-error"),qf._fromEmailAndCode(e,r.code,r.tenantId)}}ac.PROVIDER_ID="password";ac.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ac.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class oD{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class wh extends oD{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Eo extends wh{constructor(){super("facebook.com")}static credential(e){return Ql._fromParams({providerId:Eo.PROVIDER_ID,signInMethod:Eo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Eo.credentialFromTaggedObject(e)}static credentialFromError(e){return Eo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Eo.credential(e.oauthAccessToken)}catch{return null}}}Eo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Eo.PROVIDER_ID="facebook.com";class So extends wh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ql._fromParams({providerId:So.PROVIDER_ID,signInMethod:So.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return So.credentialFromTaggedObject(e)}static credentialFromError(e){return So.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return So.credential(n,r)}catch{return null}}}So.GOOGLE_SIGN_IN_METHOD="google.com";So.PROVIDER_ID="google.com";class To extends wh{constructor(){super("github.com")}static credential(e){return Ql._fromParams({providerId:To.PROVIDER_ID,signInMethod:To.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return To.credentialFromTaggedObject(e)}static credentialFromError(e){return To.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return To.credential(e.oauthAccessToken)}catch{return null}}}To.GITHUB_SIGN_IN_METHOD="github.com";To.PROVIDER_ID="github.com";class Ao extends wh{constructor(){super("twitter.com")}static credential(e,n){return Ql._fromParams({providerId:Ao.PROVIDER_ID,signInMethod:Ao.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ao.credentialFromTaggedObject(e)}static credentialFromError(e){return Ao.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ao.credential(n,r)}catch{return null}}}Ao.TWITTER_SIGN_IN_METHOD="twitter.com";Ao.PROVIDER_ID="twitter.com";async function cz(t,e){return xh(t,"POST","/v1/accounts:signUp",ia(t,e))}class Zl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const a=await Xi._fromIdTokenResponse(e,r,i),o=kC(r);return new Zl({user:a,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=kC(r);return new Zl({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function kC(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class Em extends Ga{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Em.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Em(e,n,r,i)}}function lD(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Em._fromErrorAndOperation(t,a,e,r):a})}async function uz(t,e,n=!1){const r=await Tu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Zl._forOperation(t,"link",r)}async function cD(t,e,n=!1){const{auth:r}=t;if(ni(r.app))return Promise.reject(xs(r));const i="reauthenticate";try{const a=await Tu(t,lD(r,i,e,t),n);Ye(a.idToken,r,"internal-error");const o=rw(a.idToken);Ye(o,r,"internal-error");const{sub:c}=o;return Ye(t.uid===c,r,"user-mismatch"),Zl._forOperation(t,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&Ji(r,"user-mismatch"),a}}async function uD(t,e,n=!1){if(ni(t.app))return Promise.reject(xs(t));const r="signIn",i=await lD(t,r,e),a=await Zl._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(a.user),a}async function dz(t,e){return uD(tl(t),e)}async function fz(t,e){return cD(It(t),e)}function hz(t,e,n){Ye(n.url?.length>0,t,"invalid-continue-uri"),Ye(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),Ye(typeof n.linkDomain>"u"||n.linkDomain.length>0,t,"invalid-hosting-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.linkDomain=n.linkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Ye(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(Ye(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}async function ow(t){const e=tl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function pz(t,e,n){const r=tl(t);await _m(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",rz)}async function gz(t,e,n){await Z6(It(t),{oobCode:e,newPassword:n}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&ow(t),r})}async function mz(t,e){await ez(It(t),{oobCode:e})}async function vz(t,e,n){if(ni(t.app))return Promise.reject(xs(t));const r=tl(t),o=await _m(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",cz).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&ow(t),u}),c=await Zl._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(c.user),c}function yz(t,e,n){return ni(t.app)?Promise.reject(xs(t)):dz(It(t),ac.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&ow(t),r})}async function RC(t,e){const n=It(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};e&&hz(n.auth,i,e);const{email:a}=await nz(n.auth,i);a!==t.email&&await t.reload()}async function bz(t,e){return Ii(t,"POST","/v1/accounts:update",e)}async function xz(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=It(t),a={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await Tu(r,bz(r.auth,a));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const c=r.providerData.find(({providerId:u})=>u==="password");c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function wz(t,e,n,r){return It(t).onIdTokenChanged(e,n,r)}function _z(t,e,n){return It(t).beforeAuthStateChanged(e,n)}function Ez(t,e,n,r){return It(t).onAuthStateChanged(e,n,r)}function NC(t){return It(t).signOut()}async function Sz(t){return It(t).delete()}const Sm="__sak";class dD{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Sm,"1"),this.storage.removeItem(Sm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const Tz=1e3,Az=10;class fD extends dD{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=tD(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},a=this.storage.getItem(r);M6()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Az):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Tz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}fD.type="LOCAL";const Cz=fD;class hD extends dD{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}hD.type="SESSION";const pD=hD;function kz(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class m0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new m0(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:a}=n.data,o=this.handlersMap[i];if(!o?.size)return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const c=Array.from(o).map(async d=>d(n.origin,a)),u=await kz(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}m0.receivers=[];function lw(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}class Rz{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,o;return new Promise((c,u)=>{const d=lw("",20);i.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const m=p;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),a=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(m.data.response);break;default:clearTimeout(h),clearTimeout(a),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Da(){return window}function Nz(t){Da().location.href=t}function gD(){return typeof Da().WorkerGlobalScope<"u"&&typeof Da().importScripts=="function"}async function Dz(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Iz(){return navigator?.serviceWorker?.controller||null}function Mz(){return gD()?self:null}const mD="firebaseLocalStorageDb",Oz=1,Tm="firebaseLocalStorage",vD="fbase_key";class _h{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function v0(t,e){return t.transaction([Tm],e?"readwrite":"readonly").objectStore(Tm)}function Pz(){const t=indexedDB.deleteDatabase(mD);return new _h(t).toPromise()}function Ex(){const t=indexedDB.open(mD,Oz);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Tm,{keyPath:vD})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Tm)?e(r):(r.close(),await Pz(),e(await Ex()))})})}async function DC(t,e,n){const r=v0(t,!0).put({[vD]:e,value:n});return new _h(r).toPromise()}async function jz(t,e){const n=v0(t,!1).get(e),r=await new _h(n).toPromise();return r===void 0?null:r.value}function IC(t,e){const n=v0(t,!0).delete(e);return new _h(n).toPromise()}const Vz=800,zz=3;class yD{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ex(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>zz)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return gD()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=m0._getInstance(Mz()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Dz(),!this.activeServiceWorker)return;this.sender=new Rz(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Iz()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ex();return await DC(e,Sm,"1"),await IC(e,Sm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>DC(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>jz(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>IC(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=v0(i,!1).getAll();return new _h(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Vz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}yD.type="LOCAL";const Lz=yD;new bh(3e4,6e4);function Bz(t,e){return e?ys(e):(Ye(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class cw extends aw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return xu(e,this._buildIdpRequest())}_linkToIdToken(e,n){return xu(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return xu(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Uz(t){return uD(t.auth,new cw(t),t.bypassAuthState)}function Fz(t){const{auth:e,user:n}=t;return Ye(n,e,"internal-error"),cD(n,new cw(t),t.bypassAuthState)}async function $z(t){const{auth:e,user:n}=t;return Ye(n,e,"internal-error"),uz(n,new cw(t),t.bypassAuthState)}class bD{constructor(e,n,r,i,a=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:a,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Uz;case"linkViaPopup":case"linkViaRedirect":return $z;case"reauthViaPopup":case"reauthViaRedirect":return Fz;default:Ji(this.auth,"internal-error")}}resolve(e){ks(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ks(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Gz=new bh(2e3,1e4);class au extends bD{constructor(e,n,r,i,a){super(e,n,i,a),this.provider=r,this.authWindow=null,this.pollId=null,au.currentPopupAction&&au.currentPopupAction.cancel(),au.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ye(e,this.auth,"internal-error"),e}async onExecution(){ks(this.filter.length===1,"Popup operations only handle one event");const e=lw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Na(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Na(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,au.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Na(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Gz.get())};e()}}au.currentPopupAction=null;const Hz="pendingRedirect",Zg=new Map;class qz extends bD{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Zg.get(this.auth._key());if(!e){try{const r=await Yz(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Zg.set(this.auth._key(),e)}return this.bypassAuthState||Zg.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Yz(t,e){const n=Kz(e),r=Wz(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function Xz(t,e){Zg.set(t._key(),e)}function Wz(t){return ys(t._redirectPersistence)}function Kz(t){return Qg(Hz,t.config.apiKey,t.name)}async function Qz(t,e,n=!1){if(ni(t.app))return Promise.reject(xs(t));const r=tl(t),i=Bz(r,e),o=await new qz(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}const Zz=600*1e3;class Jz{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!eL(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!xD(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";n.onError(Na(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Zz&&this.cachedEventUids.clear(),this.cachedEventUids.has(MC(e))}saveEventToCache(e){this.cachedEventUids.add(MC(e)),this.lastProcessedEventTime=Date.now()}}function MC(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function xD({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function eL(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return xD(t);default:return!1}}async function tL(t,e={}){return Ii(t,"GET","/v1/projects",e)}const nL=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,rL=/^https?/;async function iL(t){if(t.config.emulator)return;const{authorizedDomains:e}=await tL(t);for(const n of e)try{if(aL(n))return}catch{}Ji(t,"unauthorized-domain")}function aL(t){const e=wx(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!rL.test(n))return!1;if(nL.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const sL=new bh(3e4,6e4);function OC(){const t=Da().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function oL(t){return new Promise((e,n)=>{function r(){OC(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{OC(),n(Na(t,"network-request-failed"))},timeout:sL.get()})}if(Da().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Da().gapi?.load)r();else{const i=F6("iframefcb");return Da()[i]=()=>{gapi.load?r():n(Na(t,"network-request-failed"))},rD(`${U6()}?onload=${i}`).catch(a=>n(a))}}).catch(e=>{throw Jg=null,e})}let Jg=null;function lL(t){return Jg=Jg||oL(t),Jg}const cL=new bh(5e3,15e3),uL="__/auth/iframe",dL="emulator/auth/iframe",fL={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},hL=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function pL(t){const e=t.config;Ye(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?nw(e,dL):`https://${t.config.authDomain}/${uL}`,r={apiKey:e.apiKey,appName:t.name,v:Yu},i=hL.get(t.config.apiHost);i&&(r.eid=i);const a=t._getFrameworks();return a.length&&(r.fw=a.join(",")),`${n}?${yh(r).slice(1)}`}async function gL(t){const e=await lL(t),n=Da().gapi;return Ye(n,t,"internal-error"),e.open({where:document.body,url:pL(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:fL,dontclear:!0},r=>new Promise(async(i,a)=>{await r.restyle({setHideOnLeave:!1});const o=Na(t,"network-request-failed"),c=Da().setTimeout(()=>{a(o)},cL.get());function u(){Da().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{a(o)})}))}const mL={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},vL=500,yL=600,bL="_blank",xL="http://localhost";class PC{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function wL(t,e,n,r=vL,i=yL){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u={...mL,width:r.toString(),height:i.toString(),top:a,left:o},d=fr().toLowerCase();n&&(c=KN(d)?bL:n),XN(d)&&(e=e||xL,u.scrollbars="yes");const h=Object.entries(u).reduce((m,[b,w])=>`${m}${b}=${w},`,"");if(I6(d)&&c!=="_self")return _L(e||"",c),new PC(null);const p=window.open(e||"",c,h);Ye(p,t,"popup-blocked");try{p.focus()}catch{}return new PC(p)}function _L(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}const EL="__/auth/handler",SL="emulator/auth/handler",TL=encodeURIComponent("fac");async function jC(t,e,n,r,i,a){Ye(t.config.authDomain,t,"auth-domain-config-required"),Ye(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Yu,eventId:i};if(e instanceof oD){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",W5(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))o[h]=p}if(e instanceof wh){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const h of Object.keys(c))c[h]===void 0&&delete c[h];const u=await t._getAppCheckToken(),d=u?`#${TL}=${encodeURIComponent(u)}`:"";return`${AL(t)}?${yh(c).slice(1)}${d}`}function AL({config:t}){return t.emulator?nw(t,SL):`https://${t.authDomain}/${EL}`}const xb="webStorageSupport";class CL{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=pD,this._completeRedirectFn=Qz,this._overrideRedirectResult=Xz}async _openPopup(e,n,r,i){ks(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await jC(e,n,r,wx(),i);return wL(e,a,lw())}async _openRedirect(e,n,r,i){await this._originValidation(e);const a=await jC(e,n,r,wx(),i);return Nz(a),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:a}=this.eventManagers[n];return i?Promise.resolve(i):(ks(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await gL(e),r=new Jz(e);return n.register("authEvent",i=>(Ye(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(xb,{type:xb},i=>{const a=i?.[0]?.[xb];a!==void 0&&n(!!a),Ji(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=iL(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return tD()||WN()||iw()}}const kL=CL;var VC="@firebase/auth",zC="1.11.1";class RL{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ye(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function NL(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function DL(t){Cs(new La("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;Ye(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:nD(t)},d=new z6(r,i,a,u);return X6(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Cs(new La("auth-internal",e=>{const n=tl(e.getProvider("auth").getImmediate());return(r=>new RL(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Wi(VC,zC,NL(t)),Wi(VC,zC,"esm2020")}const IL=300,ML=ON("authIdTokenMaxAge")||IL;let LC=null;const OL=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>ML)return;const i=n?.token;LC!==i&&(LC=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function PL(t=p0()){const e=qu(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Y6(t,{popupRedirectResolver:kL,persistence:[Lz,Cz,pD]}),r=ON("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const o=OL(a.toString());_z(n,o,()=>o(n.currentUser)),wz(n,c=>o(c))}}const i=DN("auth");return i&&W6(n,`http://${i}`),n}function jL(){return document.getElementsByTagName("head")?.[0]??document}L6({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const a=Na("internal-error");a.customData=i,n(a)},r.type="text/javascript",r.charset="UTF-8",jL().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});DL("Browser");var BC="popstate";function VL(t={}){function e(i,a){let{pathname:o="/",search:c="",hash:u=""}=sc(i.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),Sx("",{pathname:o,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(i,a){let o=i.document.querySelector("base"),c="";if(o&&o.getAttribute("href")){let u=i.location.href,d=u.indexOf("#");c=d===-1?u:u.slice(0,d)}return c+"#"+(typeof a=="string"?a:Yf(a))}function r(i,a){Ri(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(a)})`)}return LL(e,n,r,t)}function on(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ri(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function zL(){return Math.random().toString(36).substring(2,10)}function UC(t,e){return{usr:t.state,key:t.key,idx:e}}function Sx(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?sc(e):e,state:n,key:e&&e.key||r||zL()}}function Yf({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function sc(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function LL(t,e,n,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,c="POP",u=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function p(){c="POP";let S=h(),T=S==null?null:S-d;d=S,u&&u({action:c,location:E.location,delta:T})}function m(S,T){c="PUSH";let C=Sx(E.location,S,T);n&&n(C,S),d=h()+1;let N=UC(C,d),j=E.createHref(C);try{o.pushState(N,"",j)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;i.location.assign(j)}a&&u&&u({action:c,location:E.location,delta:1})}function b(S,T){c="REPLACE";let C=Sx(E.location,S,T);n&&n(C,S),d=h();let N=UC(C,d),j=E.createHref(C);o.replaceState(N,"",j),a&&u&&u({action:c,location:E.location,delta:0})}function w(S){return BL(S)}let E={get action(){return c},get location(){return t(i,o)},listen(S){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(BC,p),u=S,()=>{i.removeEventListener(BC,p),u=null}},createHref(S){return e(i,S)},createURL:w,encodeLocation(S){let T=w(S);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:m,replace:b,go(S){return o.go(S)}};return E}function BL(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),on(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:Yf(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function wD(t,e,n="/"){return UL(t,e,n,!1)}function UL(t,e,n,r){let i=typeof e=="string"?sc(e):e,a=Rs(i.pathname||"/",n);if(a==null)return null;let o=_D(t);FL(o);let c=null;for(let u=0;c==null&&u<o.length;++u){let d=JL(a);c=QL(o[u],d,r)}return c}function _D(t,e=[],n=[],r="",i=!1){let a=(o,c,u=i,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&u)return;on(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let p=ws([r,h.relativePath]),m=n.concat(h);o.children&&o.children.length>0&&(on(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),_D(o.children,e,m,p,u)),!(o.path==null&&!o.index)&&e.push({path:p,score:WL(p,o.index),routesMeta:m})};return t.forEach((o,c)=>{if(o.path===""||!o.path?.includes("?"))a(o,c);else for(let u of ED(o.path))a(o,c,!0,u)}),e}function ED(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=ED(r.join("/")),c=[];return c.push(...o.map(u=>u===""?a:[a,u].join("/"))),i&&c.push(...o),c.map(u=>t.startsWith("/")&&u===""?"/":u)}function FL(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:KL(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var $L=/^:[\w-]+$/,GL=3,HL=2,qL=1,YL=10,XL=-2,FC=t=>t==="*";function WL(t,e){let n=t.split("/"),r=n.length;return n.some(FC)&&(r+=XL),e&&(r+=HL),n.filter(i=>!FC(i)).reduce((i,a)=>i+($L.test(a)?GL:a===""?qL:YL),r)}function KL(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function QL(t,e,n=!1){let{routesMeta:r}=t,i={},a="/",o=[];for(let c=0;c<r.length;++c){let u=r[c],d=c===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=Am({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),m=u.route;if(!p&&d&&n&&!r[r.length-1].route.index&&(p=Am({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:ws([a,p.pathname]),pathnameBase:r9(ws([a,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(a=ws([a,p.pathnameBase]))}return o}function Am(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=ZL(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:p},m)=>{if(h==="*"){let w=c[m]||"";o=a.slice(0,a.length-w.length).replace(/(.)\/+$/,"$1")}const b=c[m];return p&&!b?d[h]=void 0:d[h]=(b||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:t}}function ZL(t,e=!1,n=!0){Ri(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function JL(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ri(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Rs(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var e9=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function t9(t,e="/"){let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?sc(t):t,a;return n?(n=n.replace(/\/\/+/g,"/"),n.startsWith("/")?a=$C(n.substring(1),"/"):a=$C(n,e)):a=e,{pathname:a,search:i9(r),hash:a9(i)}}function $C(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function wb(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function n9(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function SD(t){let e=n9(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function TD(t,e,n,r=!1){let i;typeof t=="string"?i=sc(t):(i={...t},on(!i.pathname||!i.pathname.includes("?"),wb("?","pathname","search",i)),on(!i.pathname||!i.pathname.includes("#"),wb("#","pathname","hash",i)),on(!i.search||!i.search.includes("#"),wb("#","search","hash",i)));let a=t===""||i.pathname==="",o=a?"/":i.pathname,c;if(o==null)c=n;else{let p=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;i.pathname=m.join("/")}c=p>=0?e[p]:"/"}let u=t9(i,c),d=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}var ws=t=>t.join("/").replace(/\/\/+/g,"/"),r9=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),i9=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,a9=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,s9=class{constructor(t,e,n,r=!1){this.status=t,this.statusText=e||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function o9(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function l9(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var AD=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function CD(t,e){let n=t;if(typeof n!="string"||!e9.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let r=n,i=!1;if(AD)try{let a=new URL(window.location.href),o=n.startsWith("//")?new URL(a.protocol+n):new URL(n),c=Rs(o.pathname,e);o.origin===a.origin&&c!=null?n=c+o.search+o.hash:i=!0}catch{Ri(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:i,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var kD=["POST","PUT","PATCH","DELETE"];new Set(kD);var c9=["GET",...kD];new Set(c9);var Xu=B.createContext(null);Xu.displayName="DataRouter";var y0=B.createContext(null);y0.displayName="DataRouterState";var u9=B.createContext(!1),RD=B.createContext({isTransitioning:!1});RD.displayName="ViewTransition";var d9=B.createContext(new Map);d9.displayName="Fetchers";var f9=B.createContext(null);f9.displayName="Await";var Mi=B.createContext(null);Mi.displayName="Navigation";var Eh=B.createContext(null);Eh.displayName="Location";var Ha=B.createContext({outlet:null,matches:[],isDataRoute:!1});Ha.displayName="Route";var uw=B.createContext(null);uw.displayName="RouteError";var ND="REACT_ROUTER_ERROR",h9="REDIRECT",p9="ROUTE_ERROR_RESPONSE";function g9(t){if(t.startsWith(`${ND}:${h9}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function m9(t){if(t.startsWith(`${ND}:${p9}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new s9(e.status,e.statusText,e.data)}catch{}}function v9(t,{relative:e}={}){on(Sh(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=B.useContext(Mi),{hash:i,pathname:a,search:o}=Th(t,{relative:e}),c=a;return n!=="/"&&(c=a==="/"?n:ws([n,a])),r.createHref({pathname:c,search:o,hash:i})}function Sh(){return B.useContext(Eh)!=null}function aa(){return on(Sh(),"useLocation() may be used only in the context of a <Router> component."),B.useContext(Eh).location}var DD="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ID(t){B.useContext(Mi).static||B.useLayoutEffect(t)}function qa(){let{isDataRoute:t}=B.useContext(Ha);return t?D9():y9()}function y9(){on(Sh(),"useNavigate() may be used only in the context of a <Router> component.");let t=B.useContext(Xu),{basename:e,navigator:n}=B.useContext(Mi),{matches:r}=B.useContext(Ha),{pathname:i}=aa(),a=JSON.stringify(SD(r)),o=B.useRef(!1);return ID(()=>{o.current=!0}),B.useCallback((u,d={})=>{if(Ri(o.current,DD),!o.current)return;if(typeof u=="number"){n.go(u);return}let h=TD(u,JSON.parse(a),i,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:ws([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,a,i,t])}B.createContext(null);function b9(){let{matches:t}=B.useContext(Ha),e=t[t.length-1];return e?e.params:{}}function Th(t,{relative:e}={}){let{matches:n}=B.useContext(Ha),{pathname:r}=aa(),i=JSON.stringify(SD(n));return B.useMemo(()=>TD(t,JSON.parse(i),r,e==="path"),[t,i,r,e])}function x9(t,e){return MD(t,e)}function MD(t,e,n,r,i){on(Sh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=B.useContext(Mi),{matches:o}=B.useContext(Ha),c=o[o.length-1],u=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",p=c&&c.route;{let C=p&&p.path||"";PD(d,!p||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let m=aa(),b;if(e){let C=typeof e=="string"?sc(e):e;on(h==="/"||C.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${C.pathname}" was given in the \`location\` prop.`),b=C}else b=m;let w=b.pathname||"/",E=w;if(h!=="/"){let C=h.replace(/^\//,"").split("/");E="/"+w.replace(/^\//,"").split("/").slice(C.length).join("/")}let S=wD(t,{pathname:E});Ri(p||S!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),Ri(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=T9(S&&S.map(C=>Object.assign({},C,{params:Object.assign({},u,C.params),pathname:ws([h,a.encodeLocation?a.encodeLocation(C.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?h:ws([h,a.encodeLocation?a.encodeLocation(C.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathnameBase])})),o,n,r,i);return e&&T?B.createElement(Eh.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},T):T}function w9(){let t=N9(),e=o9(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=B.createElement(B.Fragment,null,B.createElement("p",null," Hey developer "),B.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",B.createElement("code",{style:a},"ErrorBoundary")," or"," ",B.createElement("code",{style:a},"errorElement")," prop on your route.")),B.createElement(B.Fragment,null,B.createElement("h2",null,"Unexpected Application Error!"),B.createElement("h3",{style:{fontStyle:"italic"}},e),n?B.createElement("pre",{style:i},n):null,o)}var _9=B.createElement(w9,null),OD=class extends B.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=m9(t.digest);n&&(t=n)}let e=t!==void 0?B.createElement(Ha.Provider,{value:this.props.routeContext},B.createElement(uw.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?B.createElement(E9,{error:t},e):e}};OD.contextType=u9;var _b=new WeakMap;function E9({children:t,error:e}){let{basename:n}=B.useContext(Mi);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=g9(e.digest);if(r){let i=_b.get(e);if(i)throw i;let a=CD(r.location,n);if(AD&&!_b.get(e))if(a.isExternal||r.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:r.replace}));throw _b.set(e,o),o}return B.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return t}function S9({routeContext:t,match:e,children:n}){let r=B.useContext(Xu);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),B.createElement(Ha.Provider,{value:t},n)}function T9(t,e=[],n=null,r=null,i=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,o=n?.errors;if(o!=null){let h=a.findIndex(p=>p.route.id&&o?.[p.route.id]!==void 0);on(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let c=!1,u=-1;if(n)for(let h=0;h<a.length;h++){let p=a[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=h),p.route.id){let{loaderData:m,errors:b}=n,w=p.route.loader&&!m.hasOwnProperty(p.route.id)&&(!b||b[p.route.id]===void 0);if(p.route.lazy||w){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}let d=n&&r?(h,p)=>{r(h,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:l9(n.matches),errorInfo:p})}:void 0;return a.reduceRight((h,p,m)=>{let b,w=!1,E=null,S=null;n&&(b=o&&p.route.id?o[p.route.id]:void 0,E=p.route.errorElement||_9,c&&(u<0&&m===0?(PD("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,S=null):u===m&&(w=!0,S=p.route.hydrateFallbackElement||null)));let T=e.concat(a.slice(0,m+1)),C=()=>{let N;return b?N=E:w?N=S:p.route.Component?N=B.createElement(p.route.Component,null):p.route.element?N=p.route.element:N=h,B.createElement(S9,{match:p,routeContext:{outlet:h,matches:T,isDataRoute:n!=null},children:N})};return n&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?B.createElement(OD,{location:n.location,revalidation:n.revalidation,component:E,error:b,children:C(),routeContext:{outlet:null,matches:T,isDataRoute:!0},onError:d}):C()},null)}function dw(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function A9(t){let e=B.useContext(Xu);return on(e,dw(t)),e}function C9(t){let e=B.useContext(y0);return on(e,dw(t)),e}function k9(t){let e=B.useContext(Ha);return on(e,dw(t)),e}function fw(t){let e=k9(t),n=e.matches[e.matches.length-1];return on(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function R9(){return fw("useRouteId")}function N9(){let t=B.useContext(uw),e=C9("useRouteError"),n=fw("useRouteError");return t!==void 0?t:e.errors?.[n]}function D9(){let{router:t}=A9("useNavigate"),e=fw("useNavigate"),n=B.useRef(!1);return ID(()=>{n.current=!0}),B.useCallback(async(i,a={})=>{Ri(n.current,DD),n.current&&(typeof i=="number"?await t.navigate(i):await t.navigate(i,{fromRouteId:e,...a}))},[t,e])}var GC={};function PD(t,e,n){!e&&!GC[t]&&(GC[t]=!0,Ri(!1,n))}B.memo(I9);function I9({routes:t,future:e,state:n,onError:r}){return MD(t,void 0,n,r,e)}function gs(t){on(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function M9({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:i,static:a=!1,unstable_useTransitions:o}){on(!Sh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),u=B.useMemo(()=>({basename:c,navigator:i,static:a,unstable_useTransitions:o,future:{}}),[c,i,a,o]);typeof n=="string"&&(n=sc(n));let{pathname:d="/",search:h="",hash:p="",state:m=null,key:b="default"}=n,w=B.useMemo(()=>{let E=Rs(d,c);return E==null?null:{location:{pathname:E,search:h,hash:p,state:m,key:b},navigationType:r}},[c,d,h,p,m,b,r]);return Ri(w!=null,`<Router basename="${c}"> is not able to match the URL "${d}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:B.createElement(Mi.Provider,{value:u},B.createElement(Eh.Provider,{children:e,value:w}))}function O9({children:t,location:e}){return x9(Tx(t),e)}function Tx(t,e=[]){let n=[];return B.Children.forEach(t,(r,i)=>{if(!B.isValidElement(r))return;let a=[...e,i];if(r.type===B.Fragment){n.push.apply(n,Tx(r.props.children,a));return}on(r.type===gs,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),on(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Tx(r.props.children,a)),n.push(o)}),n}var em="get",tm="application/x-www-form-urlencoded";function b0(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function P9(t){return b0(t)&&t.tagName.toLowerCase()==="button"}function j9(t){return b0(t)&&t.tagName.toLowerCase()==="form"}function V9(t){return b0(t)&&t.tagName.toLowerCase()==="input"}function z9(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function L9(t,e){return t.button===0&&(!e||e==="_self")&&!z9(t)}function Ax(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(i=>[n,i]):[[n,r]])},[]))}function B9(t,e){let n=Ax(t);return e&&e.forEach((r,i)=>{n.has(i)||e.getAll(i).forEach(a=>{n.append(i,a)})}),n}var _g=null;function U9(){if(_g===null)try{new FormData(document.createElement("form"),0),_g=!1}catch{_g=!0}return _g}var F9=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Eb(t){return t!=null&&!F9.has(t)?(Ri(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${tm}"`),null):t}function $9(t,e){let n,r,i,a,o;if(j9(t)){let c=t.getAttribute("action");r=c?Rs(c,e):null,n=t.getAttribute("method")||em,i=Eb(t.getAttribute("enctype"))||tm,a=new FormData(t)}else if(P9(t)||V9(t)&&(t.type==="submit"||t.type==="image")){let c=t.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=t.getAttribute("formaction")||c.getAttribute("action");if(r=u?Rs(u,e):null,n=t.getAttribute("formmethod")||c.getAttribute("method")||em,i=Eb(t.getAttribute("formenctype"))||Eb(c.getAttribute("enctype"))||tm,a=new FormData(c,t),!U9()){let{name:d,type:h,value:p}=t;if(h==="image"){let m=d?`${d}.`:"";a.append(`${m}x`,"0"),a.append(`${m}y`,"0")}else d&&a.append(d,p)}}else{if(b0(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=em,r=null,i=tm,o=t}return a&&i==="text/plain"&&(o=a,a=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function hw(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function G9(t,e,n,r){let i=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n?i.pathname.endsWith("/")?i.pathname=`${i.pathname}_.${r}`:i.pathname=`${i.pathname}.${r}`:i.pathname==="/"?i.pathname=`_root.${r}`:e&&Rs(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${r}`,i}async function H9(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function q9(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function Y9(t,e,n){let r=await Promise.all(t.map(async i=>{let a=e.routes[i.route.id];if(a){let o=await H9(a,n);return o.links?o.links():[]}return[]}));return Q9(r.flat(1).filter(q9).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function HC(t,e,n,r,i,a){let o=(u,d)=>n[d]?u.route.id!==n[d].route.id:!0,c=(u,d)=>n[d].pathname!==u.pathname||n[d].route.path?.endsWith("*")&&n[d].params["*"]!==u.params["*"];return a==="assets"?e.filter((u,d)=>o(u,d)||c(u,d)):a==="data"?e.filter((u,d)=>{let h=r.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,d)||c(u,d))return!0;if(u.route.shouldRevalidate){let p=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function X9(t,e,{includeHydrateFallback:n}={}){return W9(t.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function W9(t){return[...new Set(t)]}function K9(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function Q9(t,e){let n=new Set;return new Set(e),t.reduce((r,i)=>{let a=JSON.stringify(K9(i));return n.has(a)||(n.add(a),r.push({key:a,link:i})),r},[])}function jD(){let t=B.useContext(Xu);return hw(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function Z9(){let t=B.useContext(y0);return hw(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var pw=B.createContext(void 0);pw.displayName="FrameworkContext";function VD(){let t=B.useContext(pw);return hw(t,"You must render this element inside a <HydratedRouter> element"),t}function J9(t,e){let n=B.useContext(pw),[r,i]=B.useState(!1),[a,o]=B.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:d,onMouseLeave:h,onTouchStart:p}=e,m=B.useRef(null);B.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let E=T=>{T.forEach(C=>{o(C.isIntersecting)})},S=new IntersectionObserver(E,{threshold:.5});return m.current&&S.observe(m.current),()=>{S.disconnect()}}},[t]),B.useEffect(()=>{if(r){let E=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(E)}}},[r]);let b=()=>{i(!0)},w=()=>{i(!1),o(!1)};return n?t!=="intent"?[a,m,{}]:[a,m,{onFocus:ff(c,b),onBlur:ff(u,w),onMouseEnter:ff(d,b),onMouseLeave:ff(h,w),onTouchStart:ff(p,b)}]:[!1,m,{}]}function ff(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function eB({page:t,...e}){let{router:n}=jD(),r=B.useMemo(()=>wD(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?B.createElement(nB,{page:t,matches:r,...e}):null}function tB(t){let{manifest:e,routeModules:n}=VD(),[r,i]=B.useState([]);return B.useEffect(()=>{let a=!1;return Y9(t,e,n).then(o=>{a||i(o)}),()=>{a=!0}},[t,e,n]),r}function nB({page:t,matches:e,...n}){let r=aa(),{future:i,manifest:a,routeModules:o}=VD(),{basename:c}=jD(),{loaderData:u,matches:d}=Z9(),h=B.useMemo(()=>HC(t,e,d,a,r,"data"),[t,e,d,a,r]),p=B.useMemo(()=>HC(t,e,d,a,r,"assets"),[t,e,d,a,r]),m=B.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let E=new Set,S=!1;if(e.forEach(C=>{let N=a.routes[C.route.id];!N||!N.hasLoader||(!h.some(j=>j.route.id===C.route.id)&&C.route.id in u&&o[C.route.id]?.shouldRevalidate||N.hasClientLoader?S=!0:E.add(C.route.id))}),E.size===0)return[];let T=G9(t,c,i.unstable_trailingSlashAwareDataRequests,"data");return S&&E.size>0&&T.searchParams.set("_routes",e.filter(C=>E.has(C.route.id)).map(C=>C.route.id).join(",")),[T.pathname+T.search]},[c,i.unstable_trailingSlashAwareDataRequests,u,r,a,h,e,t,o]),b=B.useMemo(()=>X9(p,a),[p,a]),w=tB(p);return B.createElement(B.Fragment,null,m.map(E=>B.createElement("link",{key:E,rel:"prefetch",as:"fetch",href:E,...n})),b.map(E=>B.createElement("link",{key:E,rel:"modulepreload",href:E,...n})),w.map(({key:E,link:S})=>B.createElement("link",{key:E,nonce:n.nonce,...S,crossOrigin:S.crossOrigin??n.crossOrigin})))}function rB(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var iB=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{iB&&(window.__reactRouterVersion="7.13.0")}catch{}function aB({basename:t,children:e,unstable_useTransitions:n,window:r}){let i=B.useRef();i.current==null&&(i.current=VL({window:r,v5Compat:!0}));let a=i.current,[o,c]=B.useState({action:a.action,location:a.location}),u=B.useCallback(d=>{n===!1?c(d):B.startTransition(()=>c(d))},[n]);return B.useLayoutEffect(()=>a.listen(u),[a,u]),B.createElement(M9,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:a,unstable_useTransitions:n})}var zD=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,LD=B.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:i,reloadDocument:a,replace:o,state:c,target:u,to:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...b},w){let{basename:E,unstable_useTransitions:S}=B.useContext(Mi),T=typeof d=="string"&&zD.test(d),C=CD(d,E);d=C.to;let N=v9(d,{relative:i}),[j,P,M]=J9(r,b),A=cB(d,{replace:o,state:c,target:u,preventScrollReset:h,relative:i,viewTransition:p,unstable_defaultShouldRevalidate:m,unstable_useTransitions:S});function k(V){e&&e(V),V.defaultPrevented||A(V)}let D=B.createElement("a",{...b,...M,href:C.absoluteURL||N,onClick:C.isExternal||a?e:k,ref:rB(w,P),target:u,"data-discover":!T&&n==="render"?"true":void 0});return j&&!T?B.createElement(B.Fragment,null,D,B.createElement(eB,{page:N})):D});LD.displayName="Link";var sB=B.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:i=!1,style:a,to:o,viewTransition:c,children:u,...d},h){let p=Th(o,{relative:d.relative}),m=aa(),b=B.useContext(y0),{navigator:w,basename:E}=B.useContext(Mi),S=b!=null&&pB(p)&&c===!0,T=w.encodeLocation?w.encodeLocation(p).pathname:p.pathname,C=m.pathname,N=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;n||(C=C.toLowerCase(),N=N?N.toLowerCase():null,T=T.toLowerCase()),N&&E&&(N=Rs(N,E)||N);const j=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let P=C===T||!i&&C.startsWith(T)&&C.charAt(j)==="/",M=N!=null&&(N===T||!i&&N.startsWith(T)&&N.charAt(T.length)==="/"),A={isActive:P,isPending:M,isTransitioning:S},k=P?e:void 0,D;typeof r=="function"?D=r(A):D=[r,P?"active":null,M?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let V=typeof a=="function"?a(A):a;return B.createElement(LD,{...d,"aria-current":k,className:D,ref:h,style:V,to:o,viewTransition:c},typeof u=="function"?u(A):u)});sB.displayName="NavLink";var oB=B.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:i,state:a,method:o=em,action:c,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...b},w)=>{let{unstable_useTransitions:E}=B.useContext(Mi),S=fB(),T=hB(c,{relative:d}),C=o.toLowerCase()==="get"?"get":"post",N=typeof c=="string"&&zD.test(c),j=P=>{if(u&&u(P),P.defaultPrevented)return;P.preventDefault();let M=P.nativeEvent.submitter,A=M?.getAttribute("formmethod")||o,k=()=>S(M||P.currentTarget,{fetcherKey:e,method:A,navigate:n,replace:i,state:a,relative:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m});E&&n!==!1?B.startTransition(()=>k()):k()};return B.createElement("form",{ref:w,method:C,action:T,onSubmit:r?u:j,...b,"data-discover":!N&&t==="render"?"true":void 0})});oB.displayName="Form";function lB(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function BD(t){let e=B.useContext(Xu);return on(e,lB(t)),e}function cB(t,{target:e,replace:n,state:r,preventScrollReset:i,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:c,unstable_useTransitions:u}={}){let d=qa(),h=aa(),p=Th(t,{relative:a});return B.useCallback(m=>{if(L9(m,e)){m.preventDefault();let b=n!==void 0?n:Yf(h)===Yf(p),w=()=>d(t,{replace:b,state:r,preventScrollReset:i,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:c});u?B.startTransition(()=>w()):w()}},[h,d,p,n,r,e,t,i,a,o,c,u])}function UD(t){Ri(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=B.useRef(Ax(t)),n=B.useRef(!1),r=aa(),i=B.useMemo(()=>B9(r.search,n.current?null:e.current),[r.search]),a=qa(),o=B.useCallback((c,u)=>{const d=Ax(typeof c=="function"?c(new URLSearchParams(i)):c);n.current=!0,a("?"+d,u)},[a,i]);return[i,o]}var uB=0,dB=()=>`__${String(++uB)}__`;function fB(){let{router:t}=BD("useSubmit"),{basename:e}=B.useContext(Mi),n=R9(),r=t.fetch,i=t.navigate;return B.useCallback(async(a,o={})=>{let{action:c,method:u,encType:d,formData:h,body:p}=$9(a,e);if(o.navigate===!1){let m=o.fetcherKey||dB();await r(m,n,o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:p,formMethod:o.method||u,formEncType:o.encType||d,flushSync:o.flushSync})}else await i(o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:p,formMethod:o.method||u,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:n,flushSync:o.flushSync,viewTransition:o.viewTransition})},[r,i,e,n])}function hB(t,{relative:e}={}){let{basename:n}=B.useContext(Mi),r=B.useContext(Ha);on(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),a={...Th(t||".",{relative:e})},o=aa();if(t==null){a.search=o.search;let c=new URLSearchParams(a.search),u=c.getAll("index");if(u.some(h=>h==="")){c.delete("index"),u.filter(p=>p).forEach(p=>c.append("index",p));let h=c.toString();a.search=h?`?${h}`:""}}return(!t||t===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(a.pathname=a.pathname==="/"?n:ws([n,a.pathname])),Yf(a)}function pB(t,{relative:e}={}){let n=B.useContext(RD);on(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=BD("useViewTransitionState"),i=Th(t,{relative:e});if(!n.isTransitioning)return!1;let a=Rs(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Rs(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Am(i.pathname,o)!=null||Am(i.pathname,a)!=null}const gB=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),mB=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),qC=t=>{const e=mB(t);return e.charAt(0).toUpperCase()+e.slice(1)},FD=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),vB=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var yB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const bB=B.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:a,iconNode:o,...c},u)=>B.createElement("svg",{ref:u,...yB,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:FD("lucide",i),...!a&&!vB(c)&&{"aria-hidden":"true"},...c},[...o.map(([d,h])=>B.createElement(d,h)),...Array.isArray(a)?a:[a]]));const Qe=(t,e)=>{const n=B.forwardRef(({className:r,...i},a)=>B.createElement(bB,{ref:a,iconNode:e,className:FD(`lucide-${gB(qC(t))}`,`lucide-${t}`,r),...i}));return n.displayName=qC(t),n};const xB=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Bo=Qe("arrow-left",xB);const wB=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],_B=Qe("arrow-right-left",wB);const EB=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],SB=Qe("arrow-right",EB);const TB=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],AB=Qe("calendar",TB);const CB=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],kB=Qe("chart-column",CB);const RB=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],NB=Qe("chart-pie",RB);const DB=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],IB=Qe("check",DB);const MB=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],OB=Qe("chevron-left",MB);const PB=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Ta=Qe("chevron-right",PB);const jB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]],VB=Qe("circle-arrow-down",jB);const zB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],LB=Qe("circle-arrow-up",zB);const BB=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Cm=Qe("circle-check-big",BB);const UB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ms=Qe("circle-check",UB);const FB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],YC=Qe("circle",FB);const $B=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],XC=Qe("dollar-sign",$B);const GB=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],WC=Qe("download",GB);const HB=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],qB=Qe("ellipsis",HB);const YB=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],$D=Qe("eye-off",YB);const XB=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],GD=Qe("eye",XB);const WB=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],KB=Qe("file-text",WB);const QB=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],ZB=Qe("folder",QB);const JB=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],eU=Qe("funnel",JB);const tU=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],Xf=Qe("grip-vertical",tU);const nU=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],rU=Qe("house",nU);const iU=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],aU=Qe("list",iU);const sU=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],KC=Qe("loader",sU);const oU=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],QC=Qe("lock",oU);const lU=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],cU=Qe("log-out",lU);const uU=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Cx=Qe("mail",uU);const dU=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],ZC=Qe("mic",dU);const fU=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],hU=Qe("pause",fU);const pU=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],gU=Qe("pen",pU);const mU=[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]],Ah=Qe("piggy-bank",mU);const vU=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ch=Qe("plus",vU);const yU=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Wf=Qe("refresh-cw",yU);const bU=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],xU=Qe("rotate-ccw",bU);const wU=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],_U=Qe("search",wU);const EU=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],SU=Qe("settings",EU);const TU=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Kf=Qe("sparkles",TU);const AU=[["path",{d:"M13.172 2a2 2 0 0 1 1.414.586l6.71 6.71a2.4 2.4 0 0 1 0 3.408l-4.592 4.592a2.4 2.4 0 0 1-3.408 0l-6.71-6.71A2 2 0 0 1 6 9.172V3a1 1 0 0 1 1-1z",key:"16rjxf"}],["path",{d:"M2 7v6.172a2 2 0 0 0 .586 1.414l6.71 6.71a2.4 2.4 0 0 0 3.191.193",key:"178nd4"}],["circle",{cx:"10.5",cy:"6.5",r:".5",fill:"currentColor",key:"12ikhr"}]],CU=Qe("tags",AU);const kU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],RU=Qe("target",kU);const NU=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],km=Qe("trash-2",NU);const DU=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],HD=Qe("trash",DU);const IU=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Rm=Qe("trending-up",IU);const MU=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],wu=Qe("triangle-alert",MU);const OU=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],PU=Qe("undo-2",OU);const jU=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],VU=Qe("upload",jU);const zU=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],LU=Qe("user-plus",zU);const BU=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],x0=Qe("wallet",BU);const UU=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],w0=Qe("x",UU),JC=t=>{let e;const n=new Set,r=(d,h)=>{const p=typeof d=="function"?d(e):d;if(!Object.is(p,e)){const m=e;e=h??(typeof p!="object"||p===null)?p:Object.assign({},e,p),n.forEach(b=>b(e,m))}},i=()=>e,c={setState:r,getState:i,getInitialState:()=>u,subscribe:d=>(n.add(d),()=>n.delete(d))},u=e=t(r,i,c);return c},FU=(t=>t?JC(t):JC),$U=t=>t;function GU(t,e=$U){const n=gf.useSyncExternalStore(t.subscribe,gf.useCallback(()=>e(t.getState()),[t,e]),gf.useCallback(()=>e(t.getInitialState()),[t,e]));return gf.useDebugValue(n),n}const e2=t=>{const e=FU(t),n=r=>GU(e,r);return Object.assign(n,e),n},gw=(t=>t?e2(t):e2),t2={BASE_URL:"/personal-budget-pwa/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyCRHcpbVGQrEZUVdO_Ucn4ZarwwPsrON40",VITE_FIREBASE_APP_ID:"1:137454342284:web:0ae73943f9058a4342aba9",VITE_FIREBASE_AUTH_DOMAIN:"personal-budget-pwa-5defb.firebaseapp.com",VITE_FIREBASE_MEASUREMENT_ID:"G-VMP5DF6273",VITE_FIREBASE_MESSAGING_SENDER_ID:"137454342284",VITE_FIREBASE_PROJECT_ID:"personal-budget-pwa-5defb",VITE_FIREBASE_STORAGE_BUCKET:"personal-budget-pwa-5defb.firebasestorage.app",VITE_RECAPTCHA_ENTERPRISE_SITE_KEY:"6Lf31GMsAAAAAHqILQS1jVjTe51WHK6lfIyxmsFT"},Qf=new Map,Eg=t=>{const e=Qf.get(t);return e?Object.fromEntries(Object.entries(e.stores).map(([n,r])=>[n,r.getState()])):{}},HU=(t,e,n)=>{if(t===void 0)return{type:"untracked",connection:e.connect(n)};const r=Qf.get(n.name);if(r)return{type:"tracked",store:t,...r};const i={connection:e.connect(n),stores:{}};return Qf.set(n.name,i),{type:"tracked",store:t,...i}},qU=(t,e)=>{if(e===void 0)return;const n=Qf.get(t);n&&(delete n.stores[e],Object.keys(n.stores).length===0&&Qf.delete(t))},YU=t=>{var e,n;if(!t)return;const r=t.split(`
`),i=r.findIndex(o=>o.includes("api.setState"));if(i<0)return;const a=((e=r[i+1])==null?void 0:e.trim())||"";return(n=/.+ (.+) .+/.exec(a))==null?void 0:n[1]},XU=(t,e={})=>(n,r,i)=>{const{enabled:a,anonymousActionType:o,store:c,...u}=e;let d;try{d=(a??(t2?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!d)return t(n,r,i);const{connection:h,...p}=HU(c,d,u);let m=!0;i.setState=((E,S,T)=>{const C=n(E,S);if(!m)return C;const N=T===void 0?{type:o||YU(new Error().stack)||"anonymous"}:typeof T=="string"?{type:T}:T;return c===void 0?(h?.send(N,r()),C):(h?.send({...N,type:`${c}/${N.type}`},{...Eg(u.name),[c]:i.getState()}),C)}),i.devtools={cleanup:()=>{h&&typeof h.unsubscribe=="function"&&h.unsubscribe(),qU(u.name,c)}};const b=(...E)=>{const S=m;m=!1,n(...E),m=S},w=t(i.setState,r,i);if(p.type==="untracked"?h?.init(w):(p.stores[p.store]=i,h?.init(Object.fromEntries(Object.entries(p.stores).map(([E,S])=>[E,E===p.store?w:S.getState()])))),i.dispatchFromDevtools&&typeof i.dispatch=="function"){let E=!1;const S=i.dispatch;i.dispatch=(...T)=>{(t2?"production":void 0)!=="production"&&T[0].type==="__setState"&&!E&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),E=!0),S(...T)}}return h.subscribe(E=>{var S;switch(E.type){case"ACTION":if(typeof E.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return Sb(E.payload,T=>{if(T.type==="__setState"){if(c===void 0){b(T.state);return}Object.keys(T.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const C=T.state[c];if(C==null)return;JSON.stringify(i.getState())!==JSON.stringify(C)&&b(C);return}i.dispatchFromDevtools&&typeof i.dispatch=="function"&&i.dispatch(T)});case"DISPATCH":switch(E.payload.type){case"RESET":return b(w),c===void 0?h?.init(i.getState()):h?.init(Eg(u.name));case"COMMIT":if(c===void 0){h?.init(i.getState());return}return h?.init(Eg(u.name));case"ROLLBACK":return Sb(E.state,T=>{if(c===void 0){b(T),h?.init(i.getState());return}b(T[c]),h?.init(Eg(u.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return Sb(E.state,T=>{if(c===void 0){b(T);return}JSON.stringify(i.getState())!==JSON.stringify(T[c])&&b(T[c])});case"IMPORT_STATE":{const{nextLiftedState:T}=E.payload,C=(S=T.computedStates.slice(-1)[0])==null?void 0:S.state;if(!C)return;b(c===void 0?C:C[c]),h?.send(null,T);return}case"PAUSE_RECORDING":return m=!m}return}}),w},WU=XU,Sb=(t,e)=>{let n;try{n=JSON.parse(t)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}n!==void 0&&e(n)};function KU(t,e){let n;try{n=t()}catch{return}return{getItem:i=>{var a;const o=u=>u===null?null:JSON.parse(u,void 0),c=(a=n.getItem(i))!=null?a:null;return c instanceof Promise?c.then(o):o(c)},setItem:(i,a)=>n.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>n.removeItem(i)}}const kx=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return kx(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return kx(r)(n)}}}},QU=(t,e)=>(n,r,i)=>{let a={storage:KU(()=>localStorage),partialize:E=>E,version:0,merge:(E,S)=>({...S,...E}),...e},o=!1;const c=new Set,u=new Set;let d=a.storage;if(!d)return t((...E)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),n(...E)},r,i);const h=()=>{const E=a.partialize({...r()});return d.setItem(a.name,{state:E,version:a.version})},p=i.setState;i.setState=(E,S)=>(p(E,S),h());const m=t((...E)=>(n(...E),h()),r,i);i.getInitialState=()=>m;let b;const w=()=>{var E,S;if(!d)return;o=!1,c.forEach(C=>{var N;return C((N=r())!=null?N:m)});const T=((S=a.onRehydrateStorage)==null?void 0:S.call(a,(E=r())!=null?E:m))||void 0;return kx(d.getItem.bind(d))(a.name).then(C=>{if(C)if(typeof C.version=="number"&&C.version!==a.version){if(a.migrate){const N=a.migrate(C.state,C.version);return N instanceof Promise?N.then(j=>[!0,j]):[!0,N]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,C.state];return[!1,void 0]}).then(C=>{var N;const[j,P]=C;if(b=a.merge(P,(N=r())!=null?N:m),n(b,!0),j)return h()}).then(()=>{T?.(b,void 0),b=r(),o=!0,u.forEach(C=>C(b))}).catch(C=>{T?.(void 0,C)})};return i.persist={setOptions:E=>{a={...a,...E},E.storage&&(d=E.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>w(),hasHydrated:()=>o,onHydrate:E=>(c.add(E),()=>{c.delete(E)}),onFinishHydration:E=>(u.add(E),()=>{u.delete(E)})},a.skipHydration||w(),b||m},qD=QU;var ZU="firebase",JU="12.6.0";Wi(ZU,JU,"app");var n2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var jo,YD;(function(){var t;function e(A,k){function D(){}D.prototype=k.prototype,A.F=k.prototype,A.prototype=new D,A.prototype.constructor=A,A.D=function(V,L,U){for(var O=Array(arguments.length-2),J=2;J<arguments.length;J++)O[J-2]=arguments[J];return k.prototype[L].apply(V,O)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,k,D){D||(D=0);const V=Array(16);if(typeof k=="string")for(var L=0;L<16;++L)V[L]=k.charCodeAt(D++)|k.charCodeAt(D++)<<8|k.charCodeAt(D++)<<16|k.charCodeAt(D++)<<24;else for(L=0;L<16;++L)V[L]=k[D++]|k[D++]<<8|k[D++]<<16|k[D++]<<24;k=A.g[0],D=A.g[1],L=A.g[2];let U=A.g[3],O;O=k+(U^D&(L^U))+V[0]+3614090360&4294967295,k=D+(O<<7&4294967295|O>>>25),O=U+(L^k&(D^L))+V[1]+3905402710&4294967295,U=k+(O<<12&4294967295|O>>>20),O=L+(D^U&(k^D))+V[2]+606105819&4294967295,L=U+(O<<17&4294967295|O>>>15),O=D+(k^L&(U^k))+V[3]+3250441966&4294967295,D=L+(O<<22&4294967295|O>>>10),O=k+(U^D&(L^U))+V[4]+4118548399&4294967295,k=D+(O<<7&4294967295|O>>>25),O=U+(L^k&(D^L))+V[5]+1200080426&4294967295,U=k+(O<<12&4294967295|O>>>20),O=L+(D^U&(k^D))+V[6]+2821735955&4294967295,L=U+(O<<17&4294967295|O>>>15),O=D+(k^L&(U^k))+V[7]+4249261313&4294967295,D=L+(O<<22&4294967295|O>>>10),O=k+(U^D&(L^U))+V[8]+1770035416&4294967295,k=D+(O<<7&4294967295|O>>>25),O=U+(L^k&(D^L))+V[9]+2336552879&4294967295,U=k+(O<<12&4294967295|O>>>20),O=L+(D^U&(k^D))+V[10]+4294925233&4294967295,L=U+(O<<17&4294967295|O>>>15),O=D+(k^L&(U^k))+V[11]+2304563134&4294967295,D=L+(O<<22&4294967295|O>>>10),O=k+(U^D&(L^U))+V[12]+1804603682&4294967295,k=D+(O<<7&4294967295|O>>>25),O=U+(L^k&(D^L))+V[13]+4254626195&4294967295,U=k+(O<<12&4294967295|O>>>20),O=L+(D^U&(k^D))+V[14]+2792965006&4294967295,L=U+(O<<17&4294967295|O>>>15),O=D+(k^L&(U^k))+V[15]+1236535329&4294967295,D=L+(O<<22&4294967295|O>>>10),O=k+(L^U&(D^L))+V[1]+4129170786&4294967295,k=D+(O<<5&4294967295|O>>>27),O=U+(D^L&(k^D))+V[6]+3225465664&4294967295,U=k+(O<<9&4294967295|O>>>23),O=L+(k^D&(U^k))+V[11]+643717713&4294967295,L=U+(O<<14&4294967295|O>>>18),O=D+(U^k&(L^U))+V[0]+3921069994&4294967295,D=L+(O<<20&4294967295|O>>>12),O=k+(L^U&(D^L))+V[5]+3593408605&4294967295,k=D+(O<<5&4294967295|O>>>27),O=U+(D^L&(k^D))+V[10]+38016083&4294967295,U=k+(O<<9&4294967295|O>>>23),O=L+(k^D&(U^k))+V[15]+3634488961&4294967295,L=U+(O<<14&4294967295|O>>>18),O=D+(U^k&(L^U))+V[4]+3889429448&4294967295,D=L+(O<<20&4294967295|O>>>12),O=k+(L^U&(D^L))+V[9]+568446438&4294967295,k=D+(O<<5&4294967295|O>>>27),O=U+(D^L&(k^D))+V[14]+3275163606&4294967295,U=k+(O<<9&4294967295|O>>>23),O=L+(k^D&(U^k))+V[3]+4107603335&4294967295,L=U+(O<<14&4294967295|O>>>18),O=D+(U^k&(L^U))+V[8]+1163531501&4294967295,D=L+(O<<20&4294967295|O>>>12),O=k+(L^U&(D^L))+V[13]+2850285829&4294967295,k=D+(O<<5&4294967295|O>>>27),O=U+(D^L&(k^D))+V[2]+4243563512&4294967295,U=k+(O<<9&4294967295|O>>>23),O=L+(k^D&(U^k))+V[7]+1735328473&4294967295,L=U+(O<<14&4294967295|O>>>18),O=D+(U^k&(L^U))+V[12]+2368359562&4294967295,D=L+(O<<20&4294967295|O>>>12),O=k+(D^L^U)+V[5]+4294588738&4294967295,k=D+(O<<4&4294967295|O>>>28),O=U+(k^D^L)+V[8]+2272392833&4294967295,U=k+(O<<11&4294967295|O>>>21),O=L+(U^k^D)+V[11]+1839030562&4294967295,L=U+(O<<16&4294967295|O>>>16),O=D+(L^U^k)+V[14]+4259657740&4294967295,D=L+(O<<23&4294967295|O>>>9),O=k+(D^L^U)+V[1]+2763975236&4294967295,k=D+(O<<4&4294967295|O>>>28),O=U+(k^D^L)+V[4]+1272893353&4294967295,U=k+(O<<11&4294967295|O>>>21),O=L+(U^k^D)+V[7]+4139469664&4294967295,L=U+(O<<16&4294967295|O>>>16),O=D+(L^U^k)+V[10]+3200236656&4294967295,D=L+(O<<23&4294967295|O>>>9),O=k+(D^L^U)+V[13]+681279174&4294967295,k=D+(O<<4&4294967295|O>>>28),O=U+(k^D^L)+V[0]+3936430074&4294967295,U=k+(O<<11&4294967295|O>>>21),O=L+(U^k^D)+V[3]+3572445317&4294967295,L=U+(O<<16&4294967295|O>>>16),O=D+(L^U^k)+V[6]+76029189&4294967295,D=L+(O<<23&4294967295|O>>>9),O=k+(D^L^U)+V[9]+3654602809&4294967295,k=D+(O<<4&4294967295|O>>>28),O=U+(k^D^L)+V[12]+3873151461&4294967295,U=k+(O<<11&4294967295|O>>>21),O=L+(U^k^D)+V[15]+530742520&4294967295,L=U+(O<<16&4294967295|O>>>16),O=D+(L^U^k)+V[2]+3299628645&4294967295,D=L+(O<<23&4294967295|O>>>9),O=k+(L^(D|~U))+V[0]+4096336452&4294967295,k=D+(O<<6&4294967295|O>>>26),O=U+(D^(k|~L))+V[7]+1126891415&4294967295,U=k+(O<<10&4294967295|O>>>22),O=L+(k^(U|~D))+V[14]+2878612391&4294967295,L=U+(O<<15&4294967295|O>>>17),O=D+(U^(L|~k))+V[5]+4237533241&4294967295,D=L+(O<<21&4294967295|O>>>11),O=k+(L^(D|~U))+V[12]+1700485571&4294967295,k=D+(O<<6&4294967295|O>>>26),O=U+(D^(k|~L))+V[3]+2399980690&4294967295,U=k+(O<<10&4294967295|O>>>22),O=L+(k^(U|~D))+V[10]+4293915773&4294967295,L=U+(O<<15&4294967295|O>>>17),O=D+(U^(L|~k))+V[1]+2240044497&4294967295,D=L+(O<<21&4294967295|O>>>11),O=k+(L^(D|~U))+V[8]+1873313359&4294967295,k=D+(O<<6&4294967295|O>>>26),O=U+(D^(k|~L))+V[15]+4264355552&4294967295,U=k+(O<<10&4294967295|O>>>22),O=L+(k^(U|~D))+V[6]+2734768916&4294967295,L=U+(O<<15&4294967295|O>>>17),O=D+(U^(L|~k))+V[13]+1309151649&4294967295,D=L+(O<<21&4294967295|O>>>11),O=k+(L^(D|~U))+V[4]+4149444226&4294967295,k=D+(O<<6&4294967295|O>>>26),O=U+(D^(k|~L))+V[11]+3174756917&4294967295,U=k+(O<<10&4294967295|O>>>22),O=L+(k^(U|~D))+V[2]+718787259&4294967295,L=U+(O<<15&4294967295|O>>>17),O=D+(U^(L|~k))+V[9]+3951481745&4294967295,A.g[0]=A.g[0]+k&4294967295,A.g[1]=A.g[1]+(L+(O<<21&4294967295|O>>>11))&4294967295,A.g[2]=A.g[2]+L&4294967295,A.g[3]=A.g[3]+U&4294967295}r.prototype.v=function(A,k){k===void 0&&(k=A.length);const D=k-this.blockSize,V=this.C;let L=this.h,U=0;for(;U<k;){if(L==0)for(;U<=D;)i(this,A,U),U+=this.blockSize;if(typeof A=="string"){for(;U<k;)if(V[L++]=A.charCodeAt(U++),L==this.blockSize){i(this,V),L=0;break}}else for(;U<k;)if(V[L++]=A[U++],L==this.blockSize){i(this,V),L=0;break}}this.h=L,this.o+=k},r.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var k=1;k<A.length-8;++k)A[k]=0;k=this.o*8;for(var D=A.length-8;D<A.length;++D)A[D]=k&255,k/=256;for(this.v(A),A=Array(16),k=0,D=0;D<4;++D)for(let V=0;V<32;V+=8)A[k++]=this.g[D]>>>V&255;return A};function a(A,k){var D=c;return Object.prototype.hasOwnProperty.call(D,A)?D[A]:D[A]=k(A)}function o(A,k){this.h=k;const D=[];let V=!0;for(let L=A.length-1;L>=0;L--){const U=A[L]|0;V&&U==k||(D[L]=U,V=!1)}this.g=D}var c={};function u(A){return-128<=A&&A<128?a(A,function(k){return new o([k|0],k<0?-1:0)}):new o([A|0],A<0?-1:0)}function d(A){if(isNaN(A)||!isFinite(A))return p;if(A<0)return S(d(-A));const k=[];let D=1;for(let V=0;A>=D;V++)k[V]=A/D|0,D*=4294967296;return new o(k,0)}function h(A,k){if(A.length==0)throw Error("number format error: empty string");if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(A.charAt(0)=="-")return S(h(A.substring(1),k));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=d(Math.pow(k,8));let V=p;for(let U=0;U<A.length;U+=8){var L=Math.min(8,A.length-U);const O=parseInt(A.substring(U,U+L),k);L<8?(L=d(Math.pow(k,L)),V=V.j(L).add(d(O))):(V=V.j(D),V=V.add(d(O)))}return V}var p=u(0),m=u(1),b=u(16777216);t=o.prototype,t.m=function(){if(E(this))return-S(this).m();let A=0,k=1;for(let D=0;D<this.g.length;D++){const V=this.i(D);A+=(V>=0?V:4294967296+V)*k,k*=4294967296}return A},t.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(w(this))return"0";if(E(this))return"-"+S(this).toString(A);const k=d(Math.pow(A,6));var D=this;let V="";for(;;){const L=j(D,k).g;D=T(D,L.j(k));let U=((D.g.length>0?D.g[0]:D.h)>>>0).toString(A);if(D=L,w(D))return U+V;for(;U.length<6;)U="0"+U;V=U+V}},t.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function w(A){if(A.h!=0)return!1;for(let k=0;k<A.g.length;k++)if(A.g[k]!=0)return!1;return!0}function E(A){return A.h==-1}t.l=function(A){return A=T(this,A),E(A)?-1:w(A)?0:1};function S(A){const k=A.g.length,D=[];for(let V=0;V<k;V++)D[V]=~A.g[V];return new o(D,~A.h).add(m)}t.abs=function(){return E(this)?S(this):this},t.add=function(A){const k=Math.max(this.g.length,A.g.length),D=[];let V=0;for(let L=0;L<=k;L++){let U=V+(this.i(L)&65535)+(A.i(L)&65535),O=(U>>>16)+(this.i(L)>>>16)+(A.i(L)>>>16);V=O>>>16,U&=65535,O&=65535,D[L]=O<<16|U}return new o(D,D[D.length-1]&-2147483648?-1:0)};function T(A,k){return A.add(S(k))}t.j=function(A){if(w(this)||w(A))return p;if(E(this))return E(A)?S(this).j(S(A)):S(S(this).j(A));if(E(A))return S(this.j(S(A)));if(this.l(b)<0&&A.l(b)<0)return d(this.m()*A.m());const k=this.g.length+A.g.length,D=[];for(var V=0;V<2*k;V++)D[V]=0;for(V=0;V<this.g.length;V++)for(let L=0;L<A.g.length;L++){const U=this.i(V)>>>16,O=this.i(V)&65535,J=A.i(L)>>>16,W=A.i(L)&65535;D[2*V+2*L]+=O*W,C(D,2*V+2*L),D[2*V+2*L+1]+=U*W,C(D,2*V+2*L+1),D[2*V+2*L+1]+=O*J,C(D,2*V+2*L+1),D[2*V+2*L+2]+=U*J,C(D,2*V+2*L+2)}for(A=0;A<k;A++)D[A]=D[2*A+1]<<16|D[2*A];for(A=k;A<2*k;A++)D[A]=0;return new o(D,0)};function C(A,k){for(;(A[k]&65535)!=A[k];)A[k+1]+=A[k]>>>16,A[k]&=65535,k++}function N(A,k){this.g=A,this.h=k}function j(A,k){if(w(k))throw Error("division by zero");if(w(A))return new N(p,p);if(E(A))return k=j(S(A),k),new N(S(k.g),S(k.h));if(E(k))return k=j(A,S(k)),new N(S(k.g),k.h);if(A.g.length>30){if(E(A)||E(k))throw Error("slowDivide_ only works with positive integers.");for(var D=m,V=k;V.l(A)<=0;)D=P(D),V=P(V);var L=M(D,1),U=M(V,1);for(V=M(V,2),D=M(D,2);!w(V);){var O=U.add(V);O.l(A)<=0&&(L=L.add(D),U=O),V=M(V,1),D=M(D,1)}return k=T(A,L.j(k)),new N(L,k)}for(L=p;A.l(k)>=0;){for(D=Math.max(1,Math.floor(A.m()/k.m())),V=Math.ceil(Math.log(D)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),U=d(D),O=U.j(k);E(O)||O.l(A)>0;)D-=V,U=d(D),O=U.j(k);w(U)&&(U=m),L=L.add(U),A=T(A,O)}return new N(L,A)}t.B=function(A){return j(this,A).h},t.and=function(A){const k=Math.max(this.g.length,A.g.length),D=[];for(let V=0;V<k;V++)D[V]=this.i(V)&A.i(V);return new o(D,this.h&A.h)},t.or=function(A){const k=Math.max(this.g.length,A.g.length),D=[];for(let V=0;V<k;V++)D[V]=this.i(V)|A.i(V);return new o(D,this.h|A.h)},t.xor=function(A){const k=Math.max(this.g.length,A.g.length),D=[];for(let V=0;V<k;V++)D[V]=this.i(V)^A.i(V);return new o(D,this.h^A.h)};function P(A){const k=A.g.length+1,D=[];for(let V=0;V<k;V++)D[V]=A.i(V)<<1|A.i(V-1)>>>31;return new o(D,A.h)}function M(A,k){const D=k>>5;k%=32;const V=A.g.length-D,L=[];for(let U=0;U<V;U++)L[U]=k>0?A.i(U+D)>>>k|A.i(U+D+1)<<32-k:A.i(U+D);return new o(L,A.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,YD=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,jo=o}).apply(typeof n2<"u"?n2:typeof self<"u"?self:typeof window<"u"?window:{});var Sg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var XD,yf,WD,nm,Rx,KD,QD,ZD;(function(){var t,e=Object.defineProperty;function n(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof Sg=="object"&&Sg];for(var R=0;R<y.length;++R){var z=y[R];if(z&&z.Math==Math)return z}throw Error("Cannot find global object")}var r=n(this);function i(y,R){if(R)e:{var z=r;y=y.split(".");for(var H=0;H<y.length-1;H++){var ce=y[H];if(!(ce in z))break e;z=z[ce]}y=y[y.length-1],H=z[y],R=R(H),R!=H&&R!=null&&e(z,y,{configurable:!0,writable:!0,value:R})}}i("Symbol.dispose",function(y){return y||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(y){return y||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(y){return y||function(R){var z=[],H;for(H in R)Object.prototype.hasOwnProperty.call(R,H)&&z.push([H,R[H]]);return z}});var a=a||{},o=this||self;function c(y){var R=typeof y;return R=="object"&&y!=null||R=="function"}function u(y,R,z){return y.call.apply(y.bind,arguments)}function d(y,R,z){return d=u,d.apply(null,arguments)}function h(y,R){var z=Array.prototype.slice.call(arguments,1);return function(){var H=z.slice();return H.push.apply(H,arguments),y.apply(this,H)}}function p(y,R){function z(){}z.prototype=R.prototype,y.Z=R.prototype,y.prototype=new z,y.prototype.constructor=y,y.Ob=function(H,ce,he){for(var ke=Array(arguments.length-2),ot=2;ot<arguments.length;ot++)ke[ot-2]=arguments[ot];return R.prototype[ce].apply(H,ke)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?y=>y&&AsyncContext.Snapshot.wrap(y):y=>y;function b(y){const R=y.length;if(R>0){const z=Array(R);for(let H=0;H<R;H++)z[H]=y[H];return z}return[]}function w(y,R){for(let H=1;H<arguments.length;H++){const ce=arguments[H];var z=typeof ce;if(z=z!="object"?z:ce?Array.isArray(ce)?"array":z:"null",z=="array"||z=="object"&&typeof ce.length=="number"){z=y.length||0;const he=ce.length||0;y.length=z+he;for(let ke=0;ke<he;ke++)y[z+ke]=ce[ke]}else y.push(ce)}}class E{constructor(R,z){this.i=R,this.j=z,this.h=0,this.g=null}get(){let R;return this.h>0?(this.h--,R=this.g,this.g=R.next,R.next=null):R=this.i(),R}}function S(y){o.setTimeout(()=>{throw y},0)}function T(){var y=A;let R=null;return y.g&&(R=y.g,y.g=y.g.next,y.g||(y.h=null),R.next=null),R}class C{constructor(){this.h=this.g=null}add(R,z){const H=N.get();H.set(R,z),this.h?this.h.next=H:this.g=H,this.h=H}}var N=new E(()=>new j,y=>y.reset());class j{constructor(){this.next=this.g=this.h=null}set(R,z){this.h=R,this.g=z,this.next=null}reset(){this.next=this.g=this.h=null}}let P,M=!1,A=new C,k=()=>{const y=Promise.resolve(void 0);P=()=>{y.then(D)}};function D(){for(var y;y=T();){try{y.h.call(y.g)}catch(z){S(z)}var R=N;R.j(y),R.h<100&&(R.h++,y.next=R.g,R.g=y)}M=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(y,R){this.type=y,this.g=this.target=R,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var y=!1,R=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const z=()=>{};o.addEventListener("test",z,R),o.removeEventListener("test",z,R)}catch{}return y})();function O(y){return/^[\s\xa0]*$/.test(y)}function J(y,R){L.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y&&this.init(y,R)}p(J,L),J.prototype.init=function(y,R){const z=this.type=y.type,H=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;this.target=y.target||y.srcElement,this.g=R,R=y.relatedTarget,R||(z=="mouseover"?R=y.fromElement:z=="mouseout"&&(R=y.toElement)),this.relatedTarget=R,H?(this.clientX=H.clientX!==void 0?H.clientX:H.pageX,this.clientY=H.clientY!==void 0?H.clientY:H.pageY,this.screenX=H.screenX||0,this.screenY=H.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=y.pointerType,this.state=y.state,this.i=y,y.defaultPrevented&&J.Z.h.call(this)},J.prototype.h=function(){J.Z.h.call(this);const y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var W="closure_listenable_"+(Math.random()*1e6|0),q=0;function K(y,R,z,H,ce){this.listener=y,this.proxy=null,this.src=R,this.type=z,this.capture=!!H,this.ha=ce,this.key=++q,this.da=this.fa=!1}function te(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function se(y,R,z){for(const H in y)R.call(z,y[H],H,y)}function G(y,R){for(const z in y)R.call(void 0,y[z],z,y)}function F(y){const R={};for(const z in y)R[z]=y[z];return R}const Y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Q(y,R){let z,H;for(let ce=1;ce<arguments.length;ce++){H=arguments[ce];for(z in H)y[z]=H[z];for(let he=0;he<Y.length;he++)z=Y[he],Object.prototype.hasOwnProperty.call(H,z)&&(y[z]=H[z])}}function X(y){this.src=y,this.g={},this.h=0}X.prototype.add=function(y,R,z,H,ce){const he=y.toString();y=this.g[he],y||(y=this.g[he]=[],this.h++);const ke=le(y,R,H,ce);return ke>-1?(R=y[ke],z||(R.fa=!1)):(R=new K(R,this.src,he,!!H,ce),R.fa=z,y.push(R)),R};function ie(y,R){const z=R.type;if(z in y.g){var H=y.g[z],ce=Array.prototype.indexOf.call(H,R,void 0),he;(he=ce>=0)&&Array.prototype.splice.call(H,ce,1),he&&(te(R),y.g[z].length==0&&(delete y.g[z],y.h--))}}function le(y,R,z,H){for(let ce=0;ce<y.length;++ce){const he=y[ce];if(!he.da&&he.listener==R&&he.capture==!!z&&he.ha==H)return ce}return-1}var ge="closure_lm_"+(Math.random()*1e6|0),pe={};function _e(y,R,z,H,ce){if(Array.isArray(R)){for(let he=0;he<R.length;he++)_e(y,R[he],z,H,ce);return null}return z=Le(z),y&&y[W]?y.J(R,z,c(H)?!!H.capture:!1,ce):Ie(y,R,z,!1,H,ce)}function Ie(y,R,z,H,ce,he){if(!R)throw Error("Invalid event type");const ke=c(ce)?!!ce.capture:!!ce;let ot=ze(y);if(ot||(y[ge]=ot=new X(y)),z=ot.add(R,z,H,ke,he),z.proxy)return z;if(H=ae(),z.proxy=H,H.src=y,H.listener=z,y.addEventListener)U||(ce=ke),ce===void 0&&(ce=!1),y.addEventListener(R.toString(),H,ce);else if(y.attachEvent)y.attachEvent(De(R.toString()),H);else if(y.addListener&&y.removeListener)y.addListener(H);else throw Error("addEventListener and attachEvent are unavailable.");return z}function ae(){function y(z){return R.call(y.src,y.listener,z)}const R=Ve;return y}function Ae(y,R,z,H,ce){if(Array.isArray(R))for(var he=0;he<R.length;he++)Ae(y,R[he],z,H,ce);else H=c(H)?!!H.capture:!!H,z=Le(z),y&&y[W]?(y=y.i,he=String(R).toString(),he in y.g&&(R=y.g[he],z=le(R,z,H,ce),z>-1&&(te(R[z]),Array.prototype.splice.call(R,z,1),R.length==0&&(delete y.g[he],y.h--)))):y&&(y=ze(y))&&(R=y.g[R.toString()],y=-1,R&&(y=le(R,z,H,ce)),(z=y>-1?R[y]:null)&&Re(z))}function Re(y){if(typeof y!="number"&&y&&!y.da){var R=y.src;if(R&&R[W])ie(R.i,y);else{var z=y.type,H=y.proxy;R.removeEventListener?R.removeEventListener(z,H,y.capture):R.detachEvent?R.detachEvent(De(z),H):R.addListener&&R.removeListener&&R.removeListener(H),(z=ze(R))?(ie(z,y),z.h==0&&(z.src=null,R[ge]=null)):te(y)}}}function De(y){return y in pe?pe[y]:pe[y]="on"+y}function Ve(y,R){if(y.da)y=!0;else{R=new J(R,this);const z=y.listener,H=y.ha||y.src;y.fa&&Re(y),y=z.call(H,R)}return y}function ze(y){return y=y[ge],y instanceof X?y:null}var Se="__closure_events_fn_"+(Math.random()*1e9>>>0);function Le(y){return typeof y=="function"?y:(y[Se]||(y[Se]=function(R){return y.handleEvent(R)}),y[Se])}function Me(){V.call(this),this.i=new X(this),this.M=this,this.G=null}p(Me,V),Me.prototype[W]=!0,Me.prototype.removeEventListener=function(y,R,z,H){Ae(this,y,R,z,H)};function Be(y,R){var z,H=y.G;if(H)for(z=[];H;H=H.G)z.push(H);if(y=y.M,H=R.type||R,typeof R=="string")R=new L(R,y);else if(R instanceof L)R.target=R.target||y;else{var ce=R;R=new L(H,y),Q(R,ce)}ce=!0;let he,ke;if(z)for(ke=z.length-1;ke>=0;ke--)he=R.g=z[ke],ce=st(he,H,!0,R)&&ce;if(he=R.g=y,ce=st(he,H,!0,R)&&ce,ce=st(he,H,!1,R)&&ce,z)for(ke=0;ke<z.length;ke++)he=R.g=z[ke],ce=st(he,H,!1,R)&&ce}Me.prototype.N=function(){if(Me.Z.N.call(this),this.i){var y=this.i;for(const R in y.g){const z=y.g[R];for(let H=0;H<z.length;H++)te(z[H]);delete y.g[R],y.h--}}this.G=null},Me.prototype.J=function(y,R,z,H){return this.i.add(String(y),R,!1,z,H)},Me.prototype.K=function(y,R,z,H){return this.i.add(String(y),R,!0,z,H)};function st(y,R,z,H){if(R=y.i.g[String(R)],!R)return!0;R=R.concat();let ce=!0;for(let he=0;he<R.length;++he){const ke=R[he];if(ke&&!ke.da&&ke.capture==z){const ot=ke.listener,mn=ke.ha||ke.src;ke.fa&&ie(y.i,ke),ce=ot.call(mn,H)!==!1&&ce}}return ce&&!H.defaultPrevented}function _t(y,R){if(typeof y!="function")if(y&&typeof y.handleEvent=="function")y=d(y.handleEvent,y);else throw Error("Invalid listener argument");return Number(R)>2147483647?-1:o.setTimeout(y,R||0)}function Ze(y){y.g=_t(()=>{y.g=null,y.i&&(y.i=!1,Ze(y))},y.l);const R=y.h;y.h=null,y.m.apply(null,R)}class ut extends V{constructor(R,z){super(),this.m=R,this.l=z,this.h=null,this.i=!1,this.g=null}j(R){this.h=arguments,this.g?this.i=!0:Ze(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Rt(y){V.call(this),this.h=y,this.g={}}p(Rt,V);var cn=[];function Mt(y){se(y.g,function(R,z){this.g.hasOwnProperty(z)&&Re(R)},y),y.g={}}Rt.prototype.N=function(){Rt.Z.N.call(this),Mt(this)},Rt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _n=o.JSON.stringify,$r=o.JSON.parse,sa=class{stringify(y){return o.JSON.stringify(y,void 0)}parse(y){return o.JSON.parse(y,void 0)}};function Xa(){}function Vs(){}var Gr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function En(){L.call(this,"d")}p(En,L);function sr(){L.call(this,"c")}p(sr,L);var tn={},fc=null;function zs(){return fc=fc||new Me}tn.Ia="serverreachability";function Ls(y){L.call(this,tn.Ia,y)}p(Ls,L);function ft(y){const R=zs();Be(R,new Ls(R))}tn.STAT_EVENT="statevent";function nn(y,R){L.call(this,tn.STAT_EVENT,y),this.stat=R}p(nn,L);function rn(y){const R=zs();Be(R,new nn(R,y))}tn.Ja="timingevent";function Hr(y,R){L.call(this,tn.Ja,y),this.size=R}p(Hr,L);function si(y,R){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){y()},R)}function gr(){this.g=!0}gr.prototype.ua=function(){this.g=!1};function fv(y,R,z,H,ce,he){y.info(function(){if(y.g)if(he){var ke="",ot=he.split("&");for(let Nt=0;Nt<ot.length;Nt++){var mn=ot[Nt].split("=");if(mn.length>1){const Zt=mn[0];mn=mn[1];const ui=Zt.split("_");ke=ui.length>=2&&ui[1]=="type"?ke+(Zt+"="+mn+"&"):ke+(Zt+"=redacted&")}}}else ke=null;else ke=he;return"XMLHTTP REQ ("+H+") [attempt "+ce+"]: "+R+`
`+z+`
`+ke})}function Zh(y,R,z,H,ce,he,ke){y.info(function(){return"XMLHTTP RESP ("+H+") [ attempt "+ce+"]: "+R+`
`+z+`
`+he+" "+ke})}function oa(y,R,z,H){y.info(function(){return"XMLHTTP TEXT ("+R+"): "+hv(y,z)+(H?" "+H:"")})}function ol(y,R){y.info(function(){return"TIMEOUT: "+R})}gr.prototype.info=function(){};function hv(y,R){if(!y.g)return R;if(!R)return null;try{const he=JSON.parse(R);if(he){for(y=0;y<he.length;y++)if(Array.isArray(he[y])){var z=he[y];if(!(z.length<2)){var H=z[1];if(Array.isArray(H)&&!(H.length<1)){var ce=H[0];if(ce!="noop"&&ce!="stop"&&ce!="close")for(let ke=1;ke<H.length;ke++)H[ke]=""}}}}return _n(he)}catch{return R}}var ll={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ud={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},dd;function cl(){}p(cl,Xa),cl.prototype.g=function(){return new XMLHttpRequest},dd=new cl;function Wa(y){return encodeURIComponent(String(y))}function Jh(y){var R=1;y=y.split(":");const z=[];for(;R>0&&y.length;)z.push(y.shift()),R--;return y.length&&z.push(y.join(":")),z}function Oi(y,R,z,H){this.j=y,this.i=R,this.l=z,this.S=H||1,this.V=new Rt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Pi}function Pi(){this.i=null,this.g="",this.h=!1}var Sn={},Hn={};function la(y,R,z){y.M=1,y.A=ul(An(R)),y.u=z,y.R=!0,hc(y,null)}function hc(y,R){y.F=Date.now(),ca(y),y.B=An(y.A);var z=y.B,H=y.S;Array.isArray(H)||(H=[String(H)]),vc(z.i,"t",H),y.C=0,z=y.j.L,y.h=new Pi,y.g=pp(y.j,z?R:null,!y.u),y.P>0&&(y.O=new ut(d(y.Y,y,y.g),y.P)),R=y.V,z=y.g,H=y.ba;var ce="readystatechange";Array.isArray(ce)||(ce&&(cn[0]=ce.toString()),ce=cn);for(let he=0;he<ce.length;he++){const ke=_e(z,ce[he],H||R.handleEvent,!1,R.h||R);if(!ke)break;R.g[ke.key]=ke}R=y.J?F(y.J):{},y.u?(y.v||(y.v="POST"),R["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.B,y.v,y.u,R)):(y.v="GET",y.g.ea(y.B,y.v,null,R)),ft(),fv(y.i,y.v,y.B,y.l,y.S,y.u)}Oi.prototype.ba=function(y){y=y.target;const R=this.O;R&&zi(y)==3?R.j():this.Y(y)},Oi.prototype.Y=function(y){try{if(y==this.g)e:{const ot=zi(this.g),mn=this.g.ya(),Nt=this.g.ca();if(!(ot<3)&&(ot!=3||this.g&&(this.h.h||this.g.la()||Wn(this.g)))){this.K||ot!=4||mn==7||(mn==8||Nt<=0?ft(3):ft(2)),ua(this);var R=this.g.ca();this.X=R;var z=pv(this);if(this.o=R==200,Zh(this.i,this.v,this.B,this.l,this.S,ot,R),this.o){if(this.U&&!this.L){t:{if(this.g){var H,ce=this.g;if((H=ce.g?ce.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(H)){var he=H;break t}}he=null}if(y=he)oa(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,da(this,y);else{this.o=!1,this.m=3,rn(12),qr(this),oi(this);break e}}if(this.R){y=!0;let Zt;for(;!this.K&&this.C<z.length;)if(Zt=tp(this,z),Zt==Hn){ot==4&&(this.m=4,rn(14),y=!1),oa(this.i,this.l,null,"[Incomplete Response]");break}else if(Zt==Sn){this.m=4,rn(15),oa(this.i,this.l,z,"[Invalid Chunk]"),y=!1;break}else oa(this.i,this.l,Zt,null),da(this,Zt);if(ep(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ot!=4||z.length!=0||this.h.h||(this.m=1,rn(16),y=!1),this.o=this.o&&y,!y)oa(this.i,this.l,z,"[Invalid Chunked Response]"),qr(this),oi(this);else if(z.length>0&&!this.W){this.W=!0;var ke=this.j;ke.g==this&&ke.aa&&!ke.P&&(ke.j.info("Great, no buffering proxy detected. Bytes received: "+z.length),Ad(ke),ke.P=!0,rn(11))}}else oa(this.i,this.l,z,null),da(this,z);ot==4&&qr(this),this.o&&!this.K&&(ot==4?up(this.j,this):(this.o=!1,ca(this)))}else Qa(this.g),R==400&&z.indexOf("Unknown SID")>0?(this.m=3,rn(12)):(this.m=0,rn(13)),qr(this),oi(this)}}}catch{}finally{}};function pv(y){if(!ep(y))return y.g.la();const R=Wn(y.g);if(R==="")return"";let z="";const H=R.length,ce=zi(y.g)==4;if(!y.h.i){if(typeof TextDecoder>"u")return qr(y),oi(y),"";y.h.i=new o.TextDecoder}for(let he=0;he<H;he++)y.h.h=!0,z+=y.h.i.decode(R[he],{stream:!(ce&&he==H-1)});return R.length=0,y.h.g+=z,y.C=0,y.h.g}function ep(y){return y.g?y.v=="GET"&&y.M!=2&&y.j.Aa:!1}function tp(y,R){var z=y.C,H=R.indexOf(`
`,z);return H==-1?Hn:(z=Number(R.substring(z,H)),isNaN(z)?Sn:(H+=1,H+z>R.length?Hn:(R=R.slice(H,H+z),y.C=H+z,R)))}Oi.prototype.cancel=function(){this.K=!0,qr(this)};function ca(y){y.T=Date.now()+y.H,pc(y,y.H)}function pc(y,R){if(y.D!=null)throw Error("WatchDog timer not null");y.D=si(d(y.aa,y),R)}function ua(y){y.D&&(o.clearTimeout(y.D),y.D=null)}Oi.prototype.aa=function(){this.D=null;const y=Date.now();y-this.T>=0?(ol(this.i,this.B),this.M!=2&&(ft(),rn(17)),qr(this),this.m=2,oi(this)):pc(this,this.T-y)};function oi(y){y.j.I==0||y.K||up(y.j,y)}function qr(y){ua(y);var R=y.O;R&&typeof R.dispose=="function"&&R.dispose(),y.O=null,Mt(y.V),y.g&&(R=y.g,y.g=null,R.abort(),R.dispose())}function da(y,R){try{var z=y.j;if(z.I!=0&&(z.g==y||ha(z.h,y))){if(!y.L&&ha(z.h,y)&&z.I==3){try{var H=z.Ba.g.parse(R)}catch{H=null}if(Array.isArray(H)&&H.length==3){var ce=H;if(ce[0]==0){e:if(!z.v){if(z.g)if(z.g.F+3e3<y.F)_c(z),Ys(z);else break e;vl(z),rn(18)}}else z.xa=ce[1],0<z.xa-z.K&&ce[2]<37500&&z.F&&z.A==0&&!z.C&&(z.C=si(d(z.Va,z),6e3));fa(z.h)<=1&&z.ta&&(z.ta=void 0)}else ba(z,11)}else if((y.L||z.g==y)&&_c(z),!O(R))for(ce=z.Ba.g.parse(R),R=0;R<ce.length;R++){let Nt=ce[R];const Zt=Nt[0];if(!(Zt<=z.K))if(z.K=Zt,Nt=Nt[1],z.I==2)if(Nt[0]=="c"){z.M=Nt[1],z.ba=Nt[2];const ui=Nt[3];ui!=null&&(z.ka=ui,z.j.info("VER="+z.ka));const xa=Nt[4];xa!=null&&(z.za=xa,z.j.info("SVER="+z.za));const Li=Nt[5];Li!=null&&typeof Li=="number"&&Li>0&&(H=1.5*Li,z.O=H,z.j.info("backChannelRequestTimeoutMs_="+H)),H=z;const Bi=y.g;if(Bi){const yl=Bi.g?Bi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(yl){var he=H.h;he.g||yl.indexOf("spdy")==-1&&yl.indexOf("quic")==-1&&yl.indexOf("h2")==-1||(he.j=he.l,he.g=new Set,he.h&&(pd(he,he.h),he.h=null))}if(H.G){const Ec=Bi.g?Bi.g.getResponseHeader("X-HTTP-Session-Id"):null;Ec&&(H.wa=Ec,Pt(H.J,H.G,Ec))}}z.I=3,z.l&&z.l.ra(),z.aa&&(z.T=Date.now()-y.F,z.j.info("Handshake RTT: "+z.T+"ms")),H=z;var ke=y;if(H.na=hp(H,H.L?H.ba:null,H.W),ke.L){gd(H.h,ke);var ot=ke,mn=H.O;mn&&(ot.H=mn),ot.D&&(ua(ot),ca(ot)),H.g=ke}else lp(H);z.i.length>0&&ya(z)}else Nt[0]!="stop"&&Nt[0]!="close"||ba(z,7);else z.I==3&&(Nt[0]=="stop"||Nt[0]=="close"?Nt[0]=="stop"?ba(z,7):Sd(z):Nt[0]!="noop"&&z.l&&z.l.qa(Nt),z.A=0)}}ft(4)}catch{}}var Tn=class{constructor(y,R){this.g=y,this.map=R}};function fd(y){this.l=y||10,o.PerformanceNavigationTiming?(y=o.performance.getEntriesByType("navigation"),y=y.length>0&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function hd(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function fa(y){return y.h?1:y.g?y.g.size:0}function ha(y,R){return y.h?y.h==R:y.g?y.g.has(R):!1}function pd(y,R){y.g?y.g.add(R):y.h=R}function gd(y,R){y.h&&y.h==R?y.h=null:y.g&&y.g.has(R)&&y.g.delete(R)}fd.prototype.cancel=function(){if(this.i=md(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function md(y){if(y.h!=null)return y.i.concat(y.h.G);if(y.g!=null&&y.g.size!==0){let R=y.i;for(const z of y.g.values())R=R.concat(z.G);return R}return b(y.i)}var np=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function gc(y,R){if(y){y=y.split("&");for(let z=0;z<y.length;z++){const H=y[z].indexOf("=");let ce,he=null;H>=0?(ce=y[z].substring(0,H),he=y[z].substring(H+1)):ce=y[z],R(ce,he?decodeURIComponent(he.replace(/\+/g," ")):"")}}}function Yr(y){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let R;y instanceof Yr?(this.l=y.l,qn(this,y.j),this.o=y.o,this.g=y.g,Bs(this,y.u),this.h=y.h,vd(this,sp(y.i)),this.m=y.m):y&&(R=String(y).match(np))?(this.l=!1,qn(this,R[1]||"",!0),this.o=pa(R[2]||""),this.g=pa(R[3]||"",!0),Bs(this,R[4]),this.h=pa(R[5]||"",!0),vd(this,R[6]||"",!0),this.m=pa(R[7]||"")):(this.l=!1,this.i=new Fs(null,this.l))}Yr.prototype.toString=function(){const y=[];var R=this.j;R&&y.push(dl(R,mc,!0),":");var z=this.g;return(z||R=="file")&&(y.push("//"),(R=this.o)&&y.push(dl(R,mc,!0),"@"),y.push(Wa(z).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),z=this.u,z!=null&&y.push(":",String(z))),(z=this.h)&&(this.g&&z.charAt(0)!="/"&&y.push("/"),y.push(dl(z,z.charAt(0)=="/"?yd:rp,!0))),(z=this.i.toString())&&y.push("?",z),(z=this.m)&&y.push("#",dl(z,ip)),y.join("")},Yr.prototype.resolve=function(y){const R=An(this);let z=!!y.j;z?qn(R,y.j):z=!!y.o,z?R.o=y.o:z=!!y.g,z?R.g=y.g:z=y.u!=null;var H=y.h;if(z)Bs(R,y.u);else if(z=!!y.h){if(H.charAt(0)!="/")if(this.g&&!this.h)H="/"+H;else{var ce=R.h.lastIndexOf("/");ce!=-1&&(H=R.h.slice(0,ce+1)+H)}if(ce=H,ce==".."||ce==".")H="";else if(ce.indexOf("./")!=-1||ce.indexOf("/.")!=-1){H=ce.lastIndexOf("/",0)==0,ce=ce.split("/");const he=[];for(let ke=0;ke<ce.length;){const ot=ce[ke++];ot=="."?H&&ke==ce.length&&he.push(""):ot==".."?((he.length>1||he.length==1&&he[0]!="")&&he.pop(),H&&ke==ce.length&&he.push("")):(he.push(ot),H=!0)}H=he.join("/")}else H=ce}return z?R.h=H:z=y.i.toString()!=="",z?vd(R,sp(y.i)):z=!!y.m,z&&(R.m=y.m),R};function An(y){return new Yr(y)}function qn(y,R,z){y.j=z?pa(R,!0):R,y.j&&(y.j=y.j.replace(/:$/,""))}function Bs(y,R){if(R){if(R=Number(R),isNaN(R)||R<0)throw Error("Bad port number "+R);y.u=R}else y.u=null}function vd(y,R,z){R instanceof Fs?(y.i=R,yc(y.i,y.l)):(z||(R=dl(R,Us)),y.i=new Fs(R,y.l))}function Pt(y,R,z){y.i.set(R,z)}function ul(y){return Pt(y,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),y}function pa(y,R){return y?R?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function dl(y,R,z){return typeof y=="string"?(y=encodeURI(y).replace(R,Ar),z&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Ar(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var mc=/[#\/\?@]/g,rp=/[#\?:]/g,yd=/[#\?]/g,Us=/[#\?@]/g,ip=/#/g;function Fs(y,R){this.h=this.g=null,this.i=y||null,this.j=!!R}function Cr(y){y.g||(y.g=new Map,y.h=0,y.i&&gc(y.i,function(R,z){y.add(decodeURIComponent(R.replace(/\+/g," ")),z)}))}t=Fs.prototype,t.add=function(y,R){Cr(this),this.i=null,y=$s(this,y);let z=this.g.get(y);return z||this.g.set(y,z=[]),z.push(R),this.h+=1,this};function ap(y,R){Cr(y),R=$s(y,R),y.g.has(R)&&(y.i=null,y.h-=y.g.get(R).length,y.g.delete(R))}function bd(y,R){return Cr(y),R=$s(y,R),y.g.has(R)}t.forEach=function(y,R){Cr(this),this.g.forEach(function(z,H){z.forEach(function(ce){y.call(R,ce,H,this)},this)},this)};function xd(y,R){Cr(y);let z=[];if(typeof R=="string")bd(y,R)&&(z=z.concat(y.g.get($s(y,R))));else for(y=Array.from(y.g.values()),R=0;R<y.length;R++)z=z.concat(y[R]);return z}t.set=function(y,R){return Cr(this),this.i=null,y=$s(this,y),bd(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[R]),this.h+=1,this},t.get=function(y,R){return y?(y=xd(this,y),y.length>0?String(y[0]):R):R};function vc(y,R,z){ap(y,R),z.length>0&&(y.i=null,y.g.set($s(y,R),b(z)),y.h+=z.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],R=Array.from(this.g.keys());for(let H=0;H<R.length;H++){var z=R[H];const ce=Wa(z);z=xd(this,z);for(let he=0;he<z.length;he++){let ke=ce;z[he]!==""&&(ke+="="+Wa(z[he])),y.push(ke)}}return this.i=y.join("&")};function sp(y){const R=new Fs;return R.i=y.i,y.g&&(R.g=new Map(y.g),R.h=y.h),R}function $s(y,R){return R=String(R),y.j&&(R=R.toLowerCase()),R}function yc(y,R){R&&!y.j&&(Cr(y),y.i=null,y.g.forEach(function(z,H){const ce=H.toLowerCase();H!=ce&&(ap(this,H),vc(this,ce,z))},y)),y.j=R}function ji(y,R){const z=new gr;if(o.Image){const H=new Image;H.onload=h(li,z,"TestLoadImage: loaded",!0,R,H),H.onerror=h(li,z,"TestLoadImage: error",!1,R,H),H.onabort=h(li,z,"TestLoadImage: abort",!1,R,H),H.ontimeout=h(li,z,"TestLoadImage: timeout",!1,R,H),o.setTimeout(function(){H.ontimeout&&H.ontimeout()},1e4),H.src=y}else R(!1)}function wd(y,R){const z=new gr,H=new AbortController,ce=setTimeout(()=>{H.abort(),li(z,"TestPingServer: timeout",!1,R)},1e4);fetch(y,{signal:H.signal}).then(he=>{clearTimeout(ce),he.ok?li(z,"TestPingServer: ok",!0,R):li(z,"TestPingServer: server error",!1,R)}).catch(()=>{clearTimeout(ce),li(z,"TestPingServer: error",!1,R)})}function li(y,R,z,H,ce){try{ce&&(ce.onload=null,ce.onerror=null,ce.onabort=null,ce.ontimeout=null),H(z)}catch{}}function Gs(){this.g=new sa}function ga(y){this.i=y.Sb||null,this.h=y.ab||!1}p(ga,Xa),ga.prototype.g=function(){return new fl(this.i,this.h)};function fl(y,R){Me.call(this),this.H=y,this.o=R,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(fl,Me),t=fl.prototype,t.open=function(y,R){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=y,this.D=R,this.readyState=1,Vi(this)},t.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const R={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};y&&(R.body=y),(this.H||o).fetch(new Request(this.D,R)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Hs(this)),this.readyState=0},t.Pa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,Vi(this)),this.g&&(this.readyState=3,Vi(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;bc(this)}else y.text().then(this.Oa.bind(this),this.ga.bind(this))};function bc(y){y.j.read().then(y.Ma.bind(y)).catch(y.ga.bind(y))}t.Ma=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var R=y.value?y.value:new Uint8Array(0);(R=this.B.decode(R,{stream:!y.done}))&&(this.response=this.responseText+=R)}y.done?Hs(this):Vi(this),this.readyState==3&&bc(this)}},t.Oa=function(y){this.g&&(this.response=this.responseText=y,Hs(this))},t.Na=function(y){this.g&&(this.response=y,Hs(this))},t.ga=function(){this.g&&Hs(this)};function Hs(y){y.readyState=4,y.l=null,y.j=null,y.B=null,Vi(y)}t.setRequestHeader=function(y,R){this.A.append(y,R)},t.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],R=this.h.entries();for(var z=R.next();!z.done;)z=z.value,y.push(z[0]+": "+z[1]),z=R.next();return y.join(`\r
`)};function Vi(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(fl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function ci(y){let R="";return se(y,function(z,H){R+=H,R+=":",R+=z,R+=`\r
`}),R}function hl(y,R,z){e:{for(H in z){var H=!1;break e}H=!0}H||(z=ci(z),typeof y=="string"?z!=null&&Wa(z):Pt(y,R,z))}function Lt(y){Me.call(this),this.headers=new Map,this.L=y||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(Lt,Me);var ma=/^https?$/i,_d=["POST","PUT"];t=Lt.prototype,t.Fa=function(y){this.H=y},t.ea=function(y,R,z,H){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);R=R?R.toUpperCase():"GET",this.D=y,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():dd.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(R,String(y),!0),this.B=!1}catch(he){pl(this,he);return}if(y=z||"",z=new Map(this.headers),H)if(Object.getPrototypeOf(H)===Object.prototype)for(var ce in H)z.set(ce,H[ce]);else if(typeof H.keys=="function"&&typeof H.get=="function")for(const he of H.keys())z.set(he,H.get(he));else throw Error("Unknown input type for opt_headers: "+String(H));H=Array.from(z.keys()).find(he=>he.toLowerCase()=="content-type"),ce=o.FormData&&y instanceof o.FormData,!(Array.prototype.indexOf.call(_d,R,void 0)>=0)||H||ce||z.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[he,ke]of z)this.g.setRequestHeader(he,ke);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(y),this.v=!1}catch(he){pl(this,he)}};function pl(y,R){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=R,y.o=5,Ed(y),Ka(y)}function Ed(y){y.A||(y.A=!0,Be(y,"complete"),Be(y,"error"))}t.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=y||7,Be(this,"complete"),Be(this,"abort"),Ka(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ka(this,!0)),Lt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?gl(this):this.Xa())},t.Xa=function(){gl(this)};function gl(y){if(y.h&&typeof a<"u"){if(y.v&&zi(y)==4)setTimeout(y.Ca.bind(y),0);else if(Be(y,"readystatechange"),zi(y)==4){y.h=!1;try{const he=y.ca();e:switch(he){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var R=!0;break e;default:R=!1}var z;if(!(z=R)){var H;if(H=he===0){let ke=String(y.D).match(np)[1]||null;!ke&&o.self&&o.self.location&&(ke=o.self.location.protocol.slice(0,-1)),H=!ma.test(ke?ke.toLowerCase():"")}z=H}if(z)Be(y,"complete"),Be(y,"success");else{y.o=6;try{var ce=zi(y)>2?y.g.statusText:""}catch{ce=""}y.l=ce+" ["+y.ca()+"]",Ed(y)}}finally{Ka(y)}}}}function Ka(y,R){if(y.g){y.m&&(clearTimeout(y.m),y.m=null);const z=y.g;y.g=null,R||Be(y,"ready");try{z.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function zi(y){return y.g?y.g.readyState:0}t.ca=function(){try{return zi(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(y){if(this.g){var R=this.g.responseText;return y&&R.indexOf(y)==0&&(R=R.substring(y.length)),$r(R)}};function Wn(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.F){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function Qa(y){const R={};y=(y.g&&zi(y)>=2&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let H=0;H<y.length;H++){if(O(y[H]))continue;var z=Jh(y[H]);const ce=z[0];if(z=z[1],typeof z!="string")continue;z=z.trim();const he=R[ce]||[];R[ce]=he,he.push(z)}G(R,function(H){return H.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function va(y,R,z){return z&&z.internalChannelParams&&z.internalChannelParams[y]||R}function qs(y){this.za=0,this.i=[],this.j=new gr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=va("failFast",!1,y),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=va("baseRetryDelayMs",5e3,y),this.Za=va("retryDelaySeedMs",1e4,y),this.Ta=va("forwardChannelMaxRetries",2,y),this.va=va("forwardChannelRequestTimeoutMs",2e4,y),this.ma=y&&y.xmlHttpFactory||void 0,this.Ua=y&&y.Rb||void 0,this.Aa=y&&y.useFetchStreams||!1,this.O=void 0,this.L=y&&y.supportsCrossDomainXhr||!1,this.M="",this.h=new fd(y&&y.concurrentRequestLimit),this.Ba=new Gs,this.S=y&&y.fastHandshake||!1,this.R=y&&y.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=y&&y.Pb||!1,y&&y.ua&&this.j.ua(),y&&y.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&y&&y.detectBufferingProxy||!1,this.ia=void 0,y&&y.longPollingTimeout&&y.longPollingTimeout>0&&(this.ia=y.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=qs.prototype,t.ka=8,t.I=1,t.connect=function(y,R,z,H){rn(0),this.W=y,this.H=R||{},z&&H!==void 0&&(this.H.OSID=z,this.H.OAID=H),this.F=this.X,this.J=hp(this,null,this.W),ya(this)};function Sd(y){if(xc(y),y.I==3){var R=y.V++,z=An(y.J);if(Pt(z,"SID",y.M),Pt(z,"RID",R),Pt(z,"TYPE","terminate"),ml(y,z),R=new Oi(y,y.j,R),R.M=2,R.A=ul(An(z)),z=!1,o.navigator&&o.navigator.sendBeacon)try{z=o.navigator.sendBeacon(R.A.toString(),"")}catch{}!z&&o.Image&&(new Image().src=R.A,z=!0),z||(R.g=pp(R.j,null),R.g.ea(R.A)),R.F=Date.now(),ca(R)}fp(y)}function Ys(y){y.g&&(Ad(y),y.g.cancel(),y.g=null)}function xc(y){Ys(y),y.v&&(o.clearTimeout(y.v),y.v=null),_c(y),y.h.cancel(),y.m&&(typeof y.m=="number"&&o.clearTimeout(y.m),y.m=null)}function ya(y){if(!hd(y.h)&&!y.m){y.m=!0;var R=y.Ea;P||k(),M||(P(),M=!0),A.add(R,y),y.D=0}}function wc(y,R){return fa(y.h)>=y.h.j-(y.m?1:0)?!1:y.m?(y.i=R.G.concat(y.i),!0):y.I==1||y.I==2||y.D>=(y.Sa?0:y.Ta)?!1:(y.m=si(d(y.Ea,y,R),dp(y,y.D)),y.D++,!0)}t.Ea=function(y){if(this.m)if(this.m=null,this.I==1){if(!y){this.V=Math.floor(Math.random()*1e5),y=this.V++;const ce=new Oi(this,this.j,y);let he=this.o;if(this.U&&(he?(he=F(he),Q(he,this.U)):he=this.U),this.u!==null||this.R||(ce.J=he,he=null),this.S)e:{for(var R=0,z=0;z<this.i.length;z++){t:{var H=this.i[z];if("__data__"in H.map&&(H=H.map.__data__,typeof H=="string")){H=H.length;break t}H=void 0}if(H===void 0)break;if(R+=H,R>4096){R=z;break e}if(R===4096||z===this.i.length-1){R=z+1;break e}}R=1e3}else R=1e3;R=op(this,ce,R),z=An(this.J),Pt(z,"RID",y),Pt(z,"CVER",22),this.G&&Pt(z,"X-HTTP-Session-Id",this.G),ml(this,z),he&&(this.R?R="headers="+Wa(ci(he))+"&"+R:this.u&&hl(z,this.u,he)),pd(this.h,ce),this.Ra&&Pt(z,"TYPE","init"),this.S?(Pt(z,"$req",R),Pt(z,"SID","null"),ce.U=!0,la(ce,z,null)):la(ce,z,R),this.I=2}}else this.I==3&&(y?Td(this,y):this.i.length==0||hd(this.h)||Td(this))};function Td(y,R){var z;R?z=R.l:z=y.V++;const H=An(y.J);Pt(H,"SID",y.M),Pt(H,"RID",z),Pt(H,"AID",y.K),ml(y,H),y.u&&y.o&&hl(H,y.u,y.o),z=new Oi(y,y.j,z,y.D+1),y.u===null&&(z.J=y.o),R&&(y.i=R.G.concat(y.i)),R=op(y,z,1e3),z.H=Math.round(y.va*.5)+Math.round(y.va*.5*Math.random()),pd(y.h,z),la(z,H,R)}function ml(y,R){y.H&&se(y.H,function(z,H){Pt(R,H,z)}),y.l&&se({},function(z,H){Pt(R,H,z)})}function op(y,R,z){z=Math.min(y.i.length,z);const H=y.l?d(y.l.Ka,y.l,y):null;e:{var ce=y.i;let ot=-1;for(;;){const mn=["count="+z];ot==-1?z>0?(ot=ce[0].g,mn.push("ofs="+ot)):ot=0:mn.push("ofs="+ot);let Nt=!0;for(let Zt=0;Zt<z;Zt++){var he=ce[Zt].g;const ui=ce[Zt].map;if(he-=ot,he<0)ot=Math.max(0,ce[Zt].g-100),Nt=!1;else try{he="req"+he+"_"||"";try{var ke=ui instanceof Map?ui:Object.entries(ui);for(const[xa,Li]of ke){let Bi=Li;c(Li)&&(Bi=_n(Li)),mn.push(he+xa+"="+encodeURIComponent(Bi))}}catch(xa){throw mn.push(he+"type="+encodeURIComponent("_badmap")),xa}}catch{H&&H(ui)}}if(Nt){ke=mn.join("&");break e}}ke=void 0}return y=y.i.splice(0,z),R.G=y,ke}function lp(y){if(!y.g&&!y.v){y.Y=1;var R=y.Da;P||k(),M||(P(),M=!0),A.add(R,y),y.A=0}}function vl(y){return y.g||y.v||y.A>=3?!1:(y.Y++,y.v=si(d(y.Da,y),dp(y,y.A)),y.A++,!0)}t.Da=function(){if(this.v=null,cp(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var y=4*this.T;this.j.info("BP detection timer enabled: "+y),this.B=si(d(this.Wa,this),y)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,rn(10),Ys(this),cp(this))};function Ad(y){y.B!=null&&(o.clearTimeout(y.B),y.B=null)}function cp(y){y.g=new Oi(y,y.j,"rpc",y.Y),y.u===null&&(y.g.J=y.o),y.g.P=0;var R=An(y.na);Pt(R,"RID","rpc"),Pt(R,"SID",y.M),Pt(R,"AID",y.K),Pt(R,"CI",y.F?"0":"1"),!y.F&&y.ia&&Pt(R,"TO",y.ia),Pt(R,"TYPE","xmlhttp"),ml(y,R),y.u&&y.o&&hl(R,y.u,y.o),y.O&&(y.g.H=y.O);var z=y.g;y=y.ba,z.M=1,z.A=ul(An(R)),z.u=null,z.R=!0,hc(z,y)}t.Va=function(){this.C!=null&&(this.C=null,Ys(this),vl(this),rn(19))};function _c(y){y.C!=null&&(o.clearTimeout(y.C),y.C=null)}function up(y,R){var z=null;if(y.g==R){_c(y),Ad(y),y.g=null;var H=2}else if(ha(y.h,R))z=R.G,gd(y.h,R),H=1;else return;if(y.I!=0){if(R.o)if(H==1){z=R.u?R.u.length:0,R=Date.now()-R.F;var ce=y.D;H=zs(),Be(H,new Hr(H,z)),ya(y)}else lp(y);else if(ce=R.m,ce==3||ce==0&&R.X>0||!(H==1&&wc(y,R)||H==2&&vl(y)))switch(z&&z.length>0&&(R=y.h,R.i=R.i.concat(z)),ce){case 1:ba(y,5);break;case 4:ba(y,10);break;case 3:ba(y,6);break;default:ba(y,2)}}}function dp(y,R){let z=y.Qa+Math.floor(Math.random()*y.Za);return y.isActive()||(z*=2),z*R}function ba(y,R){if(y.j.info("Error code "+R),R==2){var z=d(y.bb,y),H=y.Ua;const ce=!H;H=new Yr(H||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||qn(H,"https"),ul(H),ce?ji(H.toString(),z):wd(H.toString(),z)}else rn(2);y.I=0,y.l&&y.l.pa(R),fp(y),xc(y)}t.bb=function(y){y?(this.j.info("Successfully pinged google.com"),rn(2)):(this.j.info("Failed to ping google.com"),rn(1))};function fp(y){if(y.I=0,y.ja=[],y.l){const R=md(y.h);(R.length!=0||y.i.length!=0)&&(w(y.ja,R),w(y.ja,y.i),y.h.i.length=0,b(y.i),y.i.length=0),y.l.oa()}}function hp(y,R,z){var H=z instanceof Yr?An(z):new Yr(z);if(H.g!="")R&&(H.g=R+"."+H.g),Bs(H,H.u);else{var ce=o.location;H=ce.protocol,R=R?R+"."+ce.hostname:ce.hostname,ce=+ce.port;const he=new Yr(null);H&&qn(he,H),R&&(he.g=R),ce&&Bs(he,ce),z&&(he.h=z),H=he}return z=y.G,R=y.wa,z&&R&&Pt(H,z,R),Pt(H,"VER",y.ka),ml(y,H),H}function pp(y,R,z){if(R&&!y.L)throw Error("Can't create secondary domain capable XhrIo object.");return R=y.Aa&&!y.ma?new Lt(new ga({ab:z})):new Lt(y.ma),R.Fa(y.L),R}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function gp(){}t=gp.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Xs(){}Xs.prototype.g=function(y,R){return new mr(y,R)};function mr(y,R){Me.call(this),this.g=new qs(R),this.l=y,this.h=R&&R.messageUrlParams||null,y=R&&R.messageHeaders||null,R&&R.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=R&&R.initMessageHeaders||null,R&&R.messageContentType&&(y?y["X-WebChannel-Content-Type"]=R.messageContentType:y={"X-WebChannel-Content-Type":R.messageContentType}),R&&R.sa&&(y?y["X-WebChannel-Client-Profile"]=R.sa:y={"X-WebChannel-Client-Profile":R.sa}),this.g.U=y,(y=R&&R.Qb)&&!O(y)&&(this.g.u=y),this.A=R&&R.supportsCrossDomainXhr||!1,this.v=R&&R.sendRawJson||!1,(R=R&&R.httpSessionIdParam)&&!O(R)&&(this.g.G=R,y=this.h,y!==null&&R in y&&(y=this.h,R in y&&delete y[R])),this.j=new Za(this)}p(mr,Me),mr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},mr.prototype.close=function(){Sd(this.g)},mr.prototype.o=function(y){var R=this.g;if(typeof y=="string"){var z={};z.__data__=y,y=z}else this.v&&(z={},z.__data__=_n(y),y=z);R.i.push(new Tn(R.Ya++,y)),R.I==3&&ya(R)},mr.prototype.N=function(){this.g.l=null,delete this.j,Sd(this.g),delete this.g,mr.Z.N.call(this)};function mp(y){En.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var R=y.__sm__;if(R){e:{for(const z in R){y=z;break e}y=void 0}(this.i=y)&&(y=this.i,R=R!==null&&y in R?R[y]:void 0),this.data=R}else this.data=y}p(mp,En);function vp(){sr.call(this),this.status=1}p(vp,sr);function Za(y){this.g=y}p(Za,gp),Za.prototype.ra=function(){Be(this.g,"a")},Za.prototype.qa=function(y){Be(this.g,new mp(y))},Za.prototype.pa=function(y){Be(this.g,new vp)},Za.prototype.oa=function(){Be(this.g,"b")},Xs.prototype.createWebChannel=Xs.prototype.g,mr.prototype.send=mr.prototype.o,mr.prototype.open=mr.prototype.m,mr.prototype.close=mr.prototype.close,ZD=function(){return new Xs},QD=function(){return zs()},KD=tn,Rx={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ll.NO_ERROR=0,ll.TIMEOUT=8,ll.HTTP_ERROR=6,nm=ll,ud.COMPLETE="complete",WD=ud,Vs.EventType=Gr,Gr.OPEN="a",Gr.CLOSE="b",Gr.ERROR="c",Gr.MESSAGE="d",Me.prototype.listen=Me.prototype.J,yf=Vs,Lt.prototype.listenOnce=Lt.prototype.K,Lt.prototype.getLastError=Lt.prototype.Ha,Lt.prototype.getLastErrorCode=Lt.prototype.ya,Lt.prototype.getStatus=Lt.prototype.ca,Lt.prototype.getResponseJson=Lt.prototype.La,Lt.prototype.getResponseText=Lt.prototype.la,Lt.prototype.send=Lt.prototype.ea,Lt.prototype.setWithCredentials=Lt.prototype.Fa,XD=Lt}).apply(typeof Sg<"u"?Sg:typeof self<"u"?self:typeof window<"u"?window:{});const r2="@firebase/firestore",i2="4.9.2";class cr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}cr.UNAUTHENTICATED=new cr(null),cr.GOOGLE_CREDENTIALS=new cr("google-credentials-uid"),cr.FIRST_PARTY=new cr("first-party-uid"),cr.MOCK_USER=new cr("mock-user");let Wu="12.3.0";const Jl=new h0("@firebase/firestore");function eu(){return Jl.logLevel}function Oe(t,...e){if(Jl.logLevel<=bt.DEBUG){const n=e.map(mw);Jl.debug(`Firestore (${Wu}): ${t}`,...n)}}function Ns(t,...e){if(Jl.logLevel<=bt.ERROR){const n=e.map(mw);Jl.error(`Firestore (${Wu}): ${t}`,...n)}}function Au(t,...e){if(Jl.logLevel<=bt.WARN){const n=e.map(mw);Jl.warn(`Firestore (${Wu}): ${t}`,...n)}}function mw(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function Je(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,JD(t,r,n)}function JD(t,e,n){let r=`FIRESTORE (${Wu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Ns(r),new Error(r)}function Ot(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||JD(e,i,r)}function at(t,e){return t}const be={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ne extends Ga{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class _s{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class eI{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class e8{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(cr.UNAUTHENTICATED)))}shutdown(){}}class t8{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class n8{constructor(e){this.t=e,this.currentUser=cr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ot(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let a=new _s;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new _s,e.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const u=a;e.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},c=u=>{Oe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>c(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(Oe("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new _s)}}),0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((r=>this.i!==e?(Oe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ot(typeof r.accessToken=="string",31837,{l:r}),new eI(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ot(e===null||typeof e=="string",2055,{h:e}),new cr(e)}}class r8{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=cr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class i8{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new r8(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(cr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class a2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class a8{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ni(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Ot(this.o===void 0,3512);const r=a=>{a.error!=null&&Oe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.m;return this.m=a.token,Oe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>r(a)))};const i=a=>{Oe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):Oe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new a2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(Ot(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new a2(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function s8(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}class vw{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=s8(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<n&&(r+=e.charAt(i[a]%62))}return r}}function xt(t,e){return t<e?-1:t>e?1:0}function Nx(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),a=e.charAt(r);if(i!==a)return Tb(i)===Tb(a)?xt(i,a):Tb(i)?1:-1}return xt(t.length,e.length)}const o8=55296,l8=57343;function Tb(t){const e=t.charCodeAt(0);return e>=o8&&e<=l8}function Cu(t,e,n){return t.length===e.length&&t.every(((r,i)=>n(r,e[i])))}const s2="__name__";class Aa{constructor(e,n,r){n===void 0?n=0:n>e.length&&Je(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Je(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Aa.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Aa?e.forEach((r=>{n.push(r)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const a=Aa.compareSegments(e.get(i),n.get(i));if(a!==0)return a}return xt(e.length,n.length)}static compareSegments(e,n){const r=Aa.isNumericId(e),i=Aa.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?Aa.extractNumericId(e).compare(Aa.extractNumericId(n)):Nx(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return jo.fromString(e.substring(4,e.length-2))}}class Yt extends Aa{construct(e,n,r){return new Yt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Ne(be.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter((i=>i.length>0)))}return new Yt(n)}static emptyPath(){return new Yt([])}}const c8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class rr extends Aa{construct(e,n,r){return new rr(e,n,r)}static isValidIdentifier(e){return c8.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),rr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===s2}static keyField(){return new rr([s2])}static fromServerFormat(e){const n=[];let r="",i=0;const a=()=>{if(r.length===0)throw new Ne(be.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new Ne(be.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Ne(be.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(r+=c,i++):(a(),i++)}if(a(),o)throw new Ne(be.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new rr(n)}static emptyPath(){return new rr([])}}class qe{constructor(e){this.path=e}static fromPath(e){return new qe(Yt.fromString(e))}static fromName(e){return new qe(Yt.fromString(e).popFirst(5))}static empty(){return new qe(Yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Yt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Yt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new qe(new Yt(e.slice()))}}function tI(t,e,n){if(!n)throw new Ne(be.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function u8(t,e,n,r){if(e===!0&&r===!0)throw new Ne(be.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function o2(t){if(!qe.isDocumentKey(t))throw new Ne(be.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function l2(t){if(qe.isDocumentKey(t))throw new Ne(be.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function nI(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function _0(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Je(12329,{type:typeof t})}function Er(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ne(be.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=_0(t);throw new Ne(be.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function jn(t,e){const n={typeString:t};return e&&(n.value=e),n}function kh(t,e){if(!nI(t))throw new Ne(be.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(a!==void 0&&o!==a.value){n=`Expected '${r}' field to equal '${a.value}'`;break}}if(n)throw new Ne(be.INVALID_ARGUMENT,n);return!0}const c2=-62135596800,u2=1e6;class gt{static now(){return gt.fromMillis(Date.now())}static fromDate(e){return gt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*u2);return new gt(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Ne(be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Ne(be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<c2)throw new Ne(be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ne(be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/u2}_compareTo(e){return this.seconds===e.seconds?xt(this.nanoseconds,e.nanoseconds):xt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:gt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(kh(e,gt._jsonSchema))return new gt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-c2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}gt._jsonSchemaVersion="firestore/timestamp/1.0",gt._jsonSchema={type:jn("string",gt._jsonSchemaVersion),seconds:jn("number"),nanoseconds:jn("number")};class nt{static fromTimestamp(e){return new nt(e)}static min(){return new nt(new gt(0,0))}static max(){return new nt(new gt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Zf=-1;function d8(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=nt.fromTimestamp(r===1e9?new gt(n+1,0):new gt(n,r));return new Uo(i,qe.empty(),e)}function f8(t){return new Uo(t.readTime,t.key,Zf)}class Uo{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Uo(nt.min(),qe.empty(),Zf)}static max(){return new Uo(nt.max(),qe.empty(),Zf)}}function h8(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=qe.comparator(t.documentKey,e.documentKey),n!==0?n:xt(t.largestBatchId,e.largestBatchId))}const p8="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class g8{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ku(t){if(t.code!==be.FAILED_PRECONDITION||t.message!==p8)throw t;Oe("LocalStore","Unexpectedly lost primary lease")}class we{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Je(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new we(((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(n,a).next(r,i)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof we?n:we.resolve(n)}catch(n){return we.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):we.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):we.reject(n)}static resolve(e){return new we(((n,r)=>{n(e)}))}static reject(e){return new we(((n,r)=>{r(e)}))}static waitFor(e){return new we(((n,r)=>{let i=0,a=0,o=!1;e.forEach((c=>{++i,c.next((()=>{++a,o&&a===i&&n()}),(u=>r(u)))})),o=!0,a===i&&n()}))}static or(e){let n=we.resolve(!1);for(const r of e)n=n.next((i=>i?we.resolve(i):r()));return n}static forEach(e,n){const r=[];return e.forEach(((i,a)=>{r.push(n.call(this,i,a))})),this.waitFor(r)}static mapArray(e,n){return new we(((r,i)=>{const a=e.length,o=new Array(a);let c=0;for(let u=0;u<a;u++){const d=u;n(e[d]).next((h=>{o[d]=h,++c,c===a&&r(o)}),(h=>i(h)))}}))}static doWhile(e,n){return new we(((r,i)=>{const a=()=>{e()===!0?n().next((()=>{a()}),i):r()};a()}))}}function m8(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Qu(t){return t.name==="IndexedDbTransactionError"}class E0{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}E0.ce=-1;const yw=-1;function S0(t){return t==null}function Nm(t){return t===0&&1/t==-1/0}function v8(t){return typeof t=="number"&&Number.isInteger(t)&&!Nm(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const rI="";function y8(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=d2(e)),e=b8(t.get(n),e);return d2(e)}function b8(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const a=t.charAt(i);switch(a){case"\0":n+="";break;case rI:n+="";break;default:n+=a}}return n}function d2(t){return t+rI+""}function f2(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function nl(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function iI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class ln{constructor(e,n){this.comparator=e,this.root=n||nr.EMPTY}insert(e,n){return new ln(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,nr.BLACK,null,null))}remove(e){return new ln(this.comparator,this.root.remove(e,this.comparator).copy(null,null,nr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,r)=>(e(n,r),!1)))}toString(){const e=[];return this.inorderTraversal(((n,r)=>(e.push(`${n}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Tg(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Tg(this.root,e,this.comparator,!1)}getReverseIterator(){return new Tg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Tg(this.root,e,this.comparator,!0)}}class Tg{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=n?r(e.key,n):1,n&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class nr{constructor(e,n,r,i,a){this.key=e,this.value=n,this.color=r??nr.RED,this.left=i??nr.EMPTY,this.right=a??nr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,a){return new nr(e??this.key,n??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,n,r),null):a===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return nr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return nr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,nr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,nr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Je(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Je(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Je(27949);return e+(this.isRed()?0:1)}}nr.EMPTY=null,nr.RED=!0,nr.BLACK=!1;nr.EMPTY=new class{constructor(){this.size=0}get key(){throw Je(57766)}get value(){throw Je(16141)}get color(){throw Je(16727)}get left(){throw Je(29726)}get right(){throw Je(36894)}copy(e,n,r,i,a){return this}insert(e,n,r){return new nr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class $n{constructor(e){this.comparator=e,this.data=new ln(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,r)=>(e(n),!1)))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new h2(this.data.getIterator())}getIteratorFrom(e){return new h2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((r=>{n=n.add(r)})),n}isEqual(e){if(!(e instanceof $n)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,a=r.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new $n(this.comparator);return n.data=e,n}}class h2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ri{constructor(e){this.fields=e,e.sort(rr.comparator)}static empty(){return new ri([])}unionWith(e){let n=new $n(rr.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new ri(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Cu(this.fields,e.fields,((n,r)=>n.isEqual(r)))}}class aI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ar{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new aI("Invalid base64 string: "+a):a}})(e);return new ar(n)}static fromUint8Array(e){const n=(function(i){let a="";for(let o=0;o<i.length;++o)a+=String.fromCharCode(i[o]);return a})(e);return new ar(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ar.EMPTY_BYTE_STRING=new ar("");const x8=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fo(t){if(Ot(!!t,39018),typeof t=="string"){let e=0;const n=x8.exec(t);if(Ot(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:xn(t.seconds),nanos:xn(t.nanos)}}function xn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function $o(t){return typeof t=="string"?ar.fromBase64String(t):ar.fromUint8Array(t)}const sI="server_timestamp",oI="__type__",lI="__previous_value__",cI="__local_write_time__";function bw(t){return(t?.mapValue?.fields||{})[oI]?.stringValue===sI}function T0(t){const e=t.mapValue.fields[lI];return bw(e)?T0(e):e}function Jf(t){const e=Fo(t.mapValue.fields[cI].timestampValue);return new gt(e.seconds,e.nanos)}class w8{constructor(e,n,r,i,a,o,c,u,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=h}}const Dm="(default)";class eh{constructor(e,n){this.projectId=e,this.database=n||Dm}static empty(){return new eh("","")}get isDefaultDatabase(){return this.database===Dm}isEqual(e){return e instanceof eh&&e.projectId===this.projectId&&e.database===this.database}}const uI="__type__",_8="__max__",Ag={mapValue:{}},dI="__vector__",Im="value";function Go(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?bw(t)?4:S8(t)?9007199254740991:E8(t)?10:11:Je(28295,{value:t})}function Ba(t,e){if(t===e)return!0;const n=Go(t);if(n!==Go(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Jf(t).isEqual(Jf(e));case 3:return(function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const o=Fo(i.timestampValue),c=Fo(a.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(i,a){return $o(i.bytesValue).isEqual($o(a.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(i,a){return xn(i.geoPointValue.latitude)===xn(a.geoPointValue.latitude)&&xn(i.geoPointValue.longitude)===xn(a.geoPointValue.longitude)})(t,e);case 2:return(function(i,a){if("integerValue"in i&&"integerValue"in a)return xn(i.integerValue)===xn(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const o=xn(i.doubleValue),c=xn(a.doubleValue);return o===c?Nm(o)===Nm(c):isNaN(o)&&isNaN(c)}return!1})(t,e);case 9:return Cu(t.arrayValue.values||[],e.arrayValue.values||[],Ba);case 10:case 11:return(function(i,a){const o=i.mapValue.fields||{},c=a.mapValue.fields||{};if(f2(o)!==f2(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!Ba(o[u],c[u])))return!1;return!0})(t,e);default:return Je(52216,{left:t})}}function th(t,e){return(t.values||[]).find((n=>Ba(n,e)))!==void 0}function ku(t,e){if(t===e)return 0;const n=Go(t),r=Go(e);if(n!==r)return xt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return xt(t.booleanValue,e.booleanValue);case 2:return(function(a,o){const c=xn(a.integerValue||a.doubleValue),u=xn(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1})(t,e);case 3:return p2(t.timestampValue,e.timestampValue);case 4:return p2(Jf(t),Jf(e));case 5:return Nx(t.stringValue,e.stringValue);case 6:return(function(a,o){const c=$o(a),u=$o(o);return c.compareTo(u)})(t.bytesValue,e.bytesValue);case 7:return(function(a,o){const c=a.split("/"),u=o.split("/");for(let d=0;d<c.length&&d<u.length;d++){const h=xt(c[d],u[d]);if(h!==0)return h}return xt(c.length,u.length)})(t.referenceValue,e.referenceValue);case 8:return(function(a,o){const c=xt(xn(a.latitude),xn(o.latitude));return c!==0?c:xt(xn(a.longitude),xn(o.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return g2(t.arrayValue,e.arrayValue);case 10:return(function(a,o){const c=a.fields||{},u=o.fields||{},d=c[Im]?.arrayValue,h=u[Im]?.arrayValue,p=xt(d?.values?.length||0,h?.values?.length||0);return p!==0?p:g2(d,h)})(t.mapValue,e.mapValue);case 11:return(function(a,o){if(a===Ag.mapValue&&o===Ag.mapValue)return 0;if(a===Ag.mapValue)return 1;if(o===Ag.mapValue)return-1;const c=a.fields||{},u=Object.keys(c),d=o.fields||{},h=Object.keys(d);u.sort(),h.sort();for(let p=0;p<u.length&&p<h.length;++p){const m=Nx(u[p],h[p]);if(m!==0)return m;const b=ku(c[u[p]],d[h[p]]);if(b!==0)return b}return xt(u.length,h.length)})(t.mapValue,e.mapValue);default:throw Je(23264,{he:n})}}function p2(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return xt(t,e);const n=Fo(t),r=Fo(e),i=xt(n.seconds,r.seconds);return i!==0?i:xt(n.nanos,r.nanos)}function g2(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const a=ku(n[i],r[i]);if(a)return a}return xt(n.length,r.length)}function Ru(t){return Dx(t)}function Dx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const r=Fo(n);return`time(${r.seconds},${r.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return $o(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return qe.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let r="[",i=!0;for(const a of n.values||[])i?i=!1:r+=",",r+=Dx(a);return r+"]"})(t.arrayValue):"mapValue"in t?(function(n){const r=Object.keys(n.fields||{}).sort();let i="{",a=!0;for(const o of r)a?a=!1:i+=",",i+=`${o}:${Dx(n.fields[o])}`;return i+"}"})(t.mapValue):Je(61005,{value:t})}function rm(t){switch(Go(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=T0(t);return e?16+rm(e):16;case 5:return 2*t.stringValue.length;case 6:return $o(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,a)=>i+rm(a)),0)})(t.arrayValue);case 10:case 11:return(function(r){let i=0;return nl(r.fields,((a,o)=>{i+=a.length+rm(o)})),i})(t.mapValue);default:throw Je(13486,{value:t})}}function m2(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Ix(t){return!!t&&"integerValue"in t}function xw(t){return!!t&&"arrayValue"in t}function v2(t){return!!t&&"nullValue"in t}function y2(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function im(t){return!!t&&"mapValue"in t}function E8(t){return(t?.mapValue?.fields||{})[uI]?.stringValue===dI}function Rf(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return nl(t.mapValue.fields,((n,r)=>e.mapValue.fields[n]=Rf(r))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Rf(t.arrayValue.values[n]);return e}return{...t}}function S8(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===_8}class Pr{constructor(e){this.value=e}static empty(){return new Pr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!im(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Rf(n)}setAll(e){let n=rr.emptyPath(),r={},i=[];e.forEach(((o,c)=>{if(!n.isImmediateParentOf(c)){const u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=c.popLast()}o?r[c.lastSegment()]=Rf(o):i.push(c.lastSegment())}));const a=this.getFieldsMap(n);this.applyChanges(a,r,i)}delete(e){const n=this.field(e.popLast());im(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ba(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];im(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){nl(n,((i,a)=>e[i]=a));for(const i of r)delete e[i]}clone(){return new Pr(Rf(this.value))}}function fI(t){const e=[];return nl(t.fields,((n,r)=>{const i=new rr([n]);if(im(r)){const a=fI(r.mapValue).fields;if(a.length===0)e.push(i);else for(const o of a)e.push(i.child(o))}else e.push(i)})),new ri(e)}class ur{constructor(e,n,r,i,a,o,c){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=a,this.data=o,this.documentState=c}static newInvalidDocument(e){return new ur(e,0,nt.min(),nt.min(),nt.min(),Pr.empty(),0)}static newFoundDocument(e,n,r,i){return new ur(e,1,n,nt.min(),r,i,0)}static newNoDocument(e,n){return new ur(e,2,n,nt.min(),nt.min(),Pr.empty(),0)}static newUnknownDocument(e,n){return new ur(e,3,n,nt.min(),nt.min(),Pr.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(nt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=nt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ur&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ur(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Mm{constructor(e,n){this.position=e,this.inclusive=n}}function b2(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const a=e[i],o=t.position[i];if(a.field.isKeyField()?r=qe.comparator(qe.fromName(o.referenceValue),n.key):r=ku(o,n.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function x2(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ba(t.position[n],e.position[n]))return!1;return!0}class nh{constructor(e,n="asc"){this.field=e,this.dir=n}}function T8(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class hI{}class On extends hI{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new C8(e,n,r):n==="array-contains"?new N8(e,r):n==="in"?new D8(e,r):n==="not-in"?new I8(e,r):n==="array-contains-any"?new M8(e,r):new On(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new k8(e,r):new R8(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(ku(n,this.value)):n!==null&&Go(this.value)===Go(n)&&this.matchesComparison(ku(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Je(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ea extends hI{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new ea(e,n)}matches(e){return pI(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function pI(t){return t.op==="and"}function gI(t){return A8(t)&&pI(t)}function A8(t){for(const e of t.filters)if(e instanceof ea)return!1;return!0}function Mx(t){if(t instanceof On)return t.field.canonicalString()+t.op.toString()+Ru(t.value);if(gI(t))return t.filters.map((e=>Mx(e))).join(",");{const e=t.filters.map((n=>Mx(n))).join(",");return`${t.op}(${e})`}}function mI(t,e){return t instanceof On?(function(r,i){return i instanceof On&&r.op===i.op&&r.field.isEqual(i.field)&&Ba(r.value,i.value)})(t,e):t instanceof ea?(function(r,i){return i instanceof ea&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((a,o,c)=>a&&mI(o,i.filters[c])),!0):!1})(t,e):void Je(19439)}function vI(t){return t instanceof On?(function(n){return`${n.field.canonicalString()} ${n.op} ${Ru(n.value)}`})(t):t instanceof ea?(function(n){return n.op.toString()+" {"+n.getFilters().map(vI).join(" ,")+"}"})(t):"Filter"}class C8 extends On{constructor(e,n,r){super(e,n,r),this.key=qe.fromName(r.referenceValue)}matches(e){const n=qe.comparator(e.key,this.key);return this.matchesComparison(n)}}class k8 extends On{constructor(e,n){super(e,"in",n),this.keys=yI("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class R8 extends On{constructor(e,n){super(e,"not-in",n),this.keys=yI("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function yI(t,e){return(e.arrayValue?.values||[]).map((n=>qe.fromName(n.referenceValue)))}class N8 extends On{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return xw(n)&&th(n.arrayValue,this.value)}}class D8 extends On{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&th(this.value.arrayValue,n)}}class I8 extends On{constructor(e,n){super(e,"not-in",n)}matches(e){if(th(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!th(this.value.arrayValue,n)}}class M8 extends On{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!xw(n)||!n.arrayValue.values)&&n.arrayValue.values.some((r=>th(this.value.arrayValue,r)))}}class O8{constructor(e,n=null,r=[],i=[],a=null,o=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=c,this.Te=null}}function w2(t,e=null,n=[],r=[],i=null,a=null,o=null){return new O8(t,e,n,r,i,a,o)}function ww(t){const e=at(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((r=>Mx(r))).join(","),n+="|ob:",n+=e.orderBy.map((r=>(function(a){return a.field.canonicalString()+a.dir})(r))).join(","),S0(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((r=>Ru(r))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((r=>Ru(r))).join(",")),e.Te=n}return e.Te}function _w(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!T8(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!mI(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!x2(t.startAt,e.startAt)&&x2(t.endAt,e.endAt)}function Ox(t){return qe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class Zu{constructor(e,n=null,r=[],i=[],a=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function P8(t,e,n,r,i,a,o,c){return new Zu(t,e,n,r,i,a,o,c)}function A0(t){return new Zu(t)}function _2(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function bI(t){return t.collectionGroup!==null}function Nf(t){const e=at(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),n.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new $n(rr.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((d=>{d.isInequality()&&(c=c.add(d.field))}))})),c})(e).forEach((a=>{n.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new nh(a,r))})),n.has(rr.keyField().canonicalString())||e.Ie.push(new nh(rr.keyField(),r))}return e.Ie}function Ia(t){const e=at(t);return e.Ee||(e.Ee=j8(e,Nf(t))),e.Ee}function j8(t,e){if(t.limitType==="F")return w2(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((i=>{const a=i.dir==="desc"?"asc":"desc";return new nh(i.field,a)}));const n=t.endAt?new Mm(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Mm(t.startAt.position,t.startAt.inclusive):null;return w2(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Px(t,e){const n=t.filters.concat([e]);return new Zu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Om(t,e,n){return new Zu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function C0(t,e){return _w(Ia(t),Ia(e))&&t.limitType===e.limitType}function xI(t){return`${ww(Ia(t))}|lt:${t.limitType}`}function tu(t){return`Query(target=${(function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map((i=>vI(i))).join(", ")}]`),S0(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map((i=>Ru(i))).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map((i=>Ru(i))).join(",")),`Target(${r})`})(Ia(t))}; limitType=${t.limitType})`}function k0(t,e){return e.isFoundDocument()&&(function(r,i){const a=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):qe.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)})(t,e)&&(function(r,i){for(const a of Nf(r))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0})(t,e)&&(function(r,i){for(const a of r.filters)if(!a.matches(i))return!1;return!0})(t,e)&&(function(r,i){return!(r.startAt&&!(function(o,c,u){const d=b2(o,c,u);return o.inclusive?d<=0:d<0})(r.startAt,Nf(r),i)||r.endAt&&!(function(o,c,u){const d=b2(o,c,u);return o.inclusive?d>=0:d>0})(r.endAt,Nf(r),i))})(t,e)}function V8(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function wI(t){return(e,n)=>{let r=!1;for(const i of Nf(t)){const a=z8(i,e,n);if(a!==0)return a;r=r||i.field.isKeyField()}return 0}}function z8(t,e,n){const r=t.field.isKeyField()?qe.comparator(e.key,n.key):(function(a,o,c){const u=o.data.field(a),d=c.data.field(a);return u!==null&&d!==null?ku(u,d):Je(42886)})(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Je(19790,{direction:t.dir})}}class oc{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,a]of r)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){nl(this.inner,((n,r)=>{for(const[i,a]of r)e(i,a)}))}isEmpty(){return iI(this.inner)}size(){return this.innerSize}}const L8=new ln(qe.comparator);function Ds(){return L8}const _I=new ln(qe.comparator);function bf(...t){let e=_I;for(const n of t)e=e.insert(n.key,n);return e}function EI(t){let e=_I;return t.forEach(((n,r)=>e=e.insert(n,r.overlayedDocument))),e}function Fl(){return Df()}function SI(){return Df()}function Df(){return new oc((t=>t.toString()),((t,e)=>t.isEqual(e)))}const B8=new ln(qe.comparator),U8=new $n(qe.comparator);function wt(...t){let e=U8;for(const n of t)e=e.add(n);return e}const F8=new $n(xt);function $8(){return F8}function Ew(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Nm(e)?"-0":e}}function TI(t){return{integerValue:""+t}}function G8(t,e){return v8(e)?TI(e):Ew(t,e)}class R0{constructor(){this._=void 0}}function H8(t,e,n){return t instanceof Pm?(function(i,a){const o={fields:{[oI]:{stringValue:sI},[cI]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&bw(a)&&(a=T0(a)),a&&(o.fields[lI]=a),{mapValue:o}})(n,e):t instanceof Nu?CI(t,e):t instanceof rh?kI(t,e):(function(i,a){const o=AI(i,a),c=E2(o)+E2(i.Ae);return Ix(o)&&Ix(i.Ae)?TI(c):Ew(i.serializer,c)})(t,e)}function q8(t,e,n){return t instanceof Nu?CI(t,e):t instanceof rh?kI(t,e):n}function AI(t,e){return t instanceof jm?(function(r){return Ix(r)||(function(a){return!!a&&"doubleValue"in a})(r)})(e)?e:{integerValue:0}:null}class Pm extends R0{}class Nu extends R0{constructor(e){super(),this.elements=e}}function CI(t,e){const n=RI(e);for(const r of t.elements)n.some((i=>Ba(i,r)))||n.push(r);return{arrayValue:{values:n}}}class rh extends R0{constructor(e){super(),this.elements=e}}function kI(t,e){let n=RI(e);for(const r of t.elements)n=n.filter((i=>!Ba(i,r)));return{arrayValue:{values:n}}}class jm extends R0{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function E2(t){return xn(t.integerValue||t.doubleValue)}function RI(t){return xw(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Y8{constructor(e,n){this.field=e,this.transform=n}}function X8(t,e){return t.field.isEqual(e.field)&&(function(r,i){return r instanceof Nu&&i instanceof Nu||r instanceof rh&&i instanceof rh?Cu(r.elements,i.elements,Ba):r instanceof jm&&i instanceof jm?Ba(r.Ae,i.Ae):r instanceof Pm&&i instanceof Pm})(t.transform,e.transform)}class W8{constructor(e,n){this.version=e,this.transformResults=n}}class Sr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Sr}static exists(e){return new Sr(void 0,e)}static updateTime(e){return new Sr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function am(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class N0{}function NI(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new D0(t.key,Sr.none()):new Rh(t.key,t.data,Sr.none());{const n=t.data,r=Pr.empty();let i=new $n(rr.comparator);for(let a of e.fields)if(!i.has(a)){let o=n.field(a);o===null&&a.length>1&&(a=a.popLast(),o=n.field(a)),o===null?r.delete(a):r.set(a,o),i=i.add(a)}return new rl(t.key,r,new ri(i.toArray()),Sr.none())}}function K8(t,e,n){t instanceof Rh?(function(i,a,o){const c=i.value.clone(),u=T2(i.fieldTransforms,a,o.transformResults);c.setAll(u),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(t,e,n):t instanceof rl?(function(i,a,o){if(!am(i.precondition,a))return void a.convertToUnknownDocument(o.version);const c=T2(i.fieldTransforms,a,o.transformResults),u=a.data;u.setAll(DI(i)),u.setAll(c),a.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(t,e,n):(function(i,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,n)}function If(t,e,n,r){return t instanceof Rh?(function(a,o,c,u){if(!am(a.precondition,o))return c;const d=a.value.clone(),h=A2(a.fieldTransforms,u,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(t,e,n,r):t instanceof rl?(function(a,o,c,u){if(!am(a.precondition,o))return c;const d=A2(a.fieldTransforms,u,o),h=o.data;return h.setAll(DI(a)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((p=>p.field)))})(t,e,n,r):(function(a,o,c){return am(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(t,e,n)}function Q8(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),a=AI(r.transform,i||null);a!=null&&(n===null&&(n=Pr.empty()),n.set(r.field,a))}return n||null}function S2(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Cu(r,i,((a,o)=>X8(a,o)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Rh extends N0{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class rl extends N0{constructor(e,n,r,i,a=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function DI(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}})),e}function T2(t,e,n){const r=new Map;Ot(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const a=t[i],o=a.transform,c=e.data.field(a.field);r.set(a.field,q8(o,c,n[i]))}return r}function A2(t,e,n){const r=new Map;for(const i of t){const a=i.transform,o=n.data.field(i.field);r.set(i.field,H8(a,o,e))}return r}class D0 extends N0{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Z8 extends N0{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class J8{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&K8(a,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=If(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=If(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=SI();return this.mutations.forEach((i=>{const a=e.get(i.key),o=a.overlayedDocument;let c=this.applyToLocalView(o,a.mutatedFields);c=n.has(i.key)?null:c;const u=NI(o,c);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(nt.min())})),r}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),wt())}isEqual(e){return this.batchId===e.batchId&&Cu(this.mutations,e.mutations,((n,r)=>S2(n,r)))&&Cu(this.baseMutations,e.baseMutations,((n,r)=>S2(n,r)))}}class Sw{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Ot(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return B8})();const a=e.mutations;for(let o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new Sw(e,n,r,i)}}class eF{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class tF{constructor(e,n){this.count=e,this.unchangedNames=n}}var In,St;function nF(t){switch(t){case be.OK:return Je(64938);case be.CANCELLED:case be.UNKNOWN:case be.DEADLINE_EXCEEDED:case be.RESOURCE_EXHAUSTED:case be.INTERNAL:case be.UNAVAILABLE:case be.UNAUTHENTICATED:return!1;case be.INVALID_ARGUMENT:case be.NOT_FOUND:case be.ALREADY_EXISTS:case be.PERMISSION_DENIED:case be.FAILED_PRECONDITION:case be.ABORTED:case be.OUT_OF_RANGE:case be.UNIMPLEMENTED:case be.DATA_LOSS:return!0;default:return Je(15467,{code:t})}}function II(t){if(t===void 0)return Ns("GRPC error has no .code"),be.UNKNOWN;switch(t){case In.OK:return be.OK;case In.CANCELLED:return be.CANCELLED;case In.UNKNOWN:return be.UNKNOWN;case In.DEADLINE_EXCEEDED:return be.DEADLINE_EXCEEDED;case In.RESOURCE_EXHAUSTED:return be.RESOURCE_EXHAUSTED;case In.INTERNAL:return be.INTERNAL;case In.UNAVAILABLE:return be.UNAVAILABLE;case In.UNAUTHENTICATED:return be.UNAUTHENTICATED;case In.INVALID_ARGUMENT:return be.INVALID_ARGUMENT;case In.NOT_FOUND:return be.NOT_FOUND;case In.ALREADY_EXISTS:return be.ALREADY_EXISTS;case In.PERMISSION_DENIED:return be.PERMISSION_DENIED;case In.FAILED_PRECONDITION:return be.FAILED_PRECONDITION;case In.ABORTED:return be.ABORTED;case In.OUT_OF_RANGE:return be.OUT_OF_RANGE;case In.UNIMPLEMENTED:return be.UNIMPLEMENTED;case In.DATA_LOSS:return be.DATA_LOSS;default:return Je(39323,{code:t})}}(St=In||(In={}))[St.OK=0]="OK",St[St.CANCELLED=1]="CANCELLED",St[St.UNKNOWN=2]="UNKNOWN",St[St.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",St[St.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",St[St.NOT_FOUND=5]="NOT_FOUND",St[St.ALREADY_EXISTS=6]="ALREADY_EXISTS",St[St.PERMISSION_DENIED=7]="PERMISSION_DENIED",St[St.UNAUTHENTICATED=16]="UNAUTHENTICATED",St[St.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",St[St.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",St[St.ABORTED=10]="ABORTED",St[St.OUT_OF_RANGE=11]="OUT_OF_RANGE",St[St.UNIMPLEMENTED=12]="UNIMPLEMENTED",St[St.INTERNAL=13]="INTERNAL",St[St.UNAVAILABLE=14]="UNAVAILABLE",St[St.DATA_LOSS=15]="DATA_LOSS";function rF(){return new TextEncoder}const iF=new jo([4294967295,4294967295],0);function C2(t){const e=rF().encode(t),n=new YD;return n.update(e),new Uint8Array(n.digest())}function k2(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new jo([n,r],0),new jo([i,a],0)]}class Tw{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new xf(`Invalid padding: ${n}`);if(r<0)throw new xf(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new xf(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new xf(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=jo.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(jo.fromNumber(r)));return i.compare(iF)===1&&(i=new jo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=C2(e),[r,i]=k2(n);for(let a=0;a<this.hashCount;a++){const o=this.ye(r,i,a);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new Tw(a,i,n);return r.forEach((c=>o.insert(c))),o}insert(e){if(this.ge===0)return;const n=C2(e),[r,i]=k2(n);for(let a=0;a<this.hashCount;a++){const o=this.ye(r,i,a);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class xf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class I0{constructor(e,n,r,i,a){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Nh.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new I0(nt.min(),i,new ln(xt),Ds(),wt())}}class Nh{constructor(e,n,r,i,a){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Nh(r,n,wt(),wt(),wt())}}class sm{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class MI{constructor(e,n){this.targetId=e,this.Ce=n}}class OI{constructor(e,n,r=ar.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class R2{constructor(){this.ve=0,this.Fe=N2(),this.Me=ar.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=wt(),n=wt(),r=wt();return this.Fe.forEach(((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Je(38017,{changeType:a})}})),new Nh(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=N2()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ot(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class aF{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ds(),this.Je=Cg(),this.He=Cg(),this.Ye=new ln(xt)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:Je(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((r,i)=>{this.rt(i)&&n(i)}))}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const a=i.target;if(Ox(a))if(r===0){const o=new qe(a.path);this.et(n,o,ur.newNoDocument(o,nt.min()))}else Ot(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:a=0}=n;let o,c;try{o=$o(r).toUint8Array()}catch(u){if(u instanceof aI)return Au("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Tw(o,i,a)}catch(u){return Au(u instanceof xf?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach((a=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.et(n,a,null),i++)})),i}Tt(e){const n=new Map;this.ze.forEach(((a,o)=>{const c=this.ot(o);if(c){if(a.current&&Ox(c.target)){const u=new qe(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,ur.newNoDocument(u,e))}a.Be&&(n.set(o,a.ke()),a.qe())}}));let r=wt();this.He.forEach(((a,o)=>{let c=!0;o.forEachWhile((u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(a))})),this.je.forEach(((a,o)=>o.setReadTime(e)));const i=new I0(e,n,this.Ye,this.je,r);return this.je=Ds(),this.Je=Cg(),this.He=Cg(),this.Ye=new ln(xt),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new R2,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new $n(xt),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new $n(xt),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Oe("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new R2),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Cg(){return new ln(qe.comparator)}function N2(){return new ln(qe.comparator)}const sF={asc:"ASCENDING",desc:"DESCENDING"},oF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},lF={and:"AND",or:"OR"};class cF{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function jx(t,e){return t.useProto3Json||S0(e)?e:{value:e}}function Vm(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function PI(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function uF(t,e){return Vm(t,e.toTimestamp())}function Ma(t){return Ot(!!t,49232),nt.fromTimestamp((function(n){const r=Fo(n);return new gt(r.seconds,r.nanos)})(t))}function Aw(t,e){return Vx(t,e).canonicalString()}function Vx(t,e){const n=(function(i){return new Yt(["projects",i.projectId,"databases",i.database])})(t).child("documents");return e===void 0?n:n.child(e)}function jI(t){const e=Yt.fromString(t);return Ot(UI(e),10190,{key:e.toString()}),e}function zx(t,e){return Aw(t.databaseId,e.path)}function Ab(t,e){const n=jI(e);if(n.get(1)!==t.databaseId.projectId)throw new Ne(be.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Ne(be.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new qe(zI(n))}function VI(t,e){return Aw(t.databaseId,e)}function dF(t){const e=jI(t);return e.length===4?Yt.emptyPath():zI(e)}function Lx(t){return new Yt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function zI(t){return Ot(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function D2(t,e,n){return{name:zx(t,e),fields:n.value.mapValue.fields}}function fF(t,e){let n;if("targetChange"in e){e.targetChange;const r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Je(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=(function(d,h){return d.useProto3Json?(Ot(h===void 0||typeof h=="string",58123),ar.fromBase64String(h||"")):(Ot(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),ar.fromUint8Array(h||new Uint8Array))})(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(d){const h=d.code===void 0?be.UNKNOWN:II(d.code);return new Ne(h,d.message||"")})(o);n=new OI(r,i,a,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ab(t,r.document.name),a=Ma(r.document.updateTime),o=r.document.createTime?Ma(r.document.createTime):nt.min(),c=new Pr({mapValue:{fields:r.document.fields}}),u=ur.newFoundDocument(i,a,o,c),d=r.targetIds||[],h=r.removedTargetIds||[];n=new sm(d,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Ab(t,r.document),a=r.readTime?Ma(r.readTime):nt.min(),o=ur.newNoDocument(i,a),c=r.removedTargetIds||[];n=new sm([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Ab(t,r.document),a=r.removedTargetIds||[];n=new sm([],a,i,null)}else{if(!("filter"in e))return Je(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:a}=r,o=new tF(i,a),c=r.targetId;n=new MI(c,o)}}return n}function hF(t,e){let n;if(e instanceof Rh)n={update:D2(t,e.key,e.value)};else if(e instanceof D0)n={delete:zx(t,e.key)};else if(e instanceof rl)n={update:D2(t,e.key,e.data),updateMask:_F(e.fieldMask)};else{if(!(e instanceof Z8))return Je(16599,{Vt:e.type});n={verify:zx(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((r=>(function(a,o){const c=o.transform;if(c instanceof Pm)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Nu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof rh)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof jm)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw Je(20930,{transform:o.transform})})(0,r)))),e.precondition.isNone||(n.currentDocument=(function(i,a){return a.updateTime!==void 0?{updateTime:uF(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Je(27497)})(t,e.precondition)),n}function pF(t,e){return t&&t.length>0?(Ot(e!==void 0,14353),t.map((n=>(function(i,a){let o=i.updateTime?Ma(i.updateTime):Ma(a);return o.isEqual(nt.min())&&(o=Ma(a)),new W8(o,i.transformResults||[])})(n,e)))):[]}function gF(t,e){return{documents:[VI(t,e.path)]}}function mF(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=VI(t,i);const a=(function(d){if(d.length!==0)return BI(ea.create(d,"and"))})(e.filters);a&&(n.structuredQuery.where=a);const o=(function(d){if(d.length!==0)return d.map((h=>(function(m){return{field:nu(m.field),direction:bF(m.dir)}})(h)))})(e.orderBy);o&&(n.structuredQuery.orderBy=o);const c=jx(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:n,parent:i}}function vF(t){let e=dF(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Ot(r===1,65062);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let a=[];n.where&&(a=(function(p){const m=LI(p);return m instanceof ea&&gI(m)?m.getFilters():[m]})(n.where));let o=[];n.orderBy&&(o=(function(p){return p.map((m=>(function(w){return new nh(ru(w.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(w.direction))})(m)))})(n.orderBy));let c=null;n.limit&&(c=(function(p){let m;return m=typeof p=="object"?p.value:p,S0(m)?null:m})(n.limit));let u=null;n.startAt&&(u=(function(p){const m=!!p.before,b=p.values||[];return new Mm(b,m)})(n.startAt));let d=null;return n.endAt&&(d=(function(p){const m=!p.before,b=p.values||[];return new Mm(b,m)})(n.endAt)),P8(e,i,o,a,c,"F",u,d)}function yF(t,e){const n=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Je(28987,{purpose:i})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function LI(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=ru(n.unaryFilter.field);return On.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=ru(n.unaryFilter.field);return On.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=ru(n.unaryFilter.field);return On.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ru(n.unaryFilter.field);return On.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Je(61313);default:return Je(60726)}})(t):t.fieldFilter!==void 0?(function(n){return On.create(ru(n.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Je(58110);default:return Je(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return ea.create(n.compositeFilter.filters.map((r=>LI(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Je(1026)}})(n.compositeFilter.op))})(t):Je(30097,{filter:t})}function bF(t){return sF[t]}function xF(t){return oF[t]}function wF(t){return lF[t]}function nu(t){return{fieldPath:t.canonicalString()}}function ru(t){return rr.fromServerFormat(t.fieldPath)}function BI(t){return t instanceof On?(function(n){if(n.op==="=="){if(y2(n.value))return{unaryFilter:{field:nu(n.field),op:"IS_NAN"}};if(v2(n.value))return{unaryFilter:{field:nu(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(y2(n.value))return{unaryFilter:{field:nu(n.field),op:"IS_NOT_NAN"}};if(v2(n.value))return{unaryFilter:{field:nu(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:nu(n.field),op:xF(n.op),value:n.value}}})(t):t instanceof ea?(function(n){const r=n.getFilters().map((i=>BI(i)));return r.length===1?r[0]:{compositeFilter:{op:wF(n.op),filters:r}}})(t):Je(54877,{filter:t})}function _F(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function UI(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Co{constructor(e,n,r,i,a=nt.min(),o=nt.min(),c=ar.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Co(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Co(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Co(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Co(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class EF{constructor(e){this.yt=e}}function SF(t){const e=vF({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Om(e,e.limit,"L"):e}class TF{constructor(){this.Cn=new AF}addToCollectionParentIndex(e,n){return this.Cn.add(n),we.resolve()}getCollectionParents(e,n){return we.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return we.resolve()}deleteFieldIndex(e,n){return we.resolve()}deleteAllFieldIndexes(e){return we.resolve()}createTargetIndexes(e,n){return we.resolve()}getDocumentsMatchingTarget(e,n){return we.resolve(null)}getIndexType(e,n){return we.resolve(0)}getFieldIndexes(e,n){return we.resolve([])}getNextCollectionGroupToUpdate(e){return we.resolve(null)}getMinOffset(e,n){return we.resolve(Uo.min())}getMinOffsetFromCollectionGroup(e,n){return we.resolve(Uo.min())}updateCollectionGroup(e,n,r){return we.resolve()}updateIndexEntries(e,n){return we.resolve()}}class AF{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new $n(Yt.comparator),a=!i.has(r);return this.index[n]=i.add(r),a}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new $n(Yt.comparator)).toArray()}}const I2={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},FI=41943040;class Or{static withCacheSize(e){return new Or(e,Or.DEFAULT_COLLECTION_PERCENTILE,Or.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}Or.DEFAULT_COLLECTION_PERCENTILE=10,Or.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Or.DEFAULT=new Or(FI,Or.DEFAULT_COLLECTION_PERCENTILE,Or.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Or.DISABLED=new Or(-1,0,0);class Du{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Du(0)}static cr(){return new Du(-1)}}const M2="LruGarbageCollector",CF=1048576;function O2([t,e],[n,r]){const i=xt(t,n);return i===0?xt(e,r):i}class kF{constructor(e){this.Ir=e,this.buffer=new $n(O2),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();O2(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class RF{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Oe(M2,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Qu(n)?Oe(M2,"Ignoring IndexedDB error during garbage collection: ",n):await Ku(n)}await this.Vr(3e5)}))}}class NF{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((r=>Math.floor(n/100*r)))}nthSequenceNumber(e,n){if(n===0)return we.resolve(E0.ce);const r=new kF(n);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Oe("LruGarbageCollector","Garbage collection skipped; disabled"),we.resolve(I2)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Oe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),I2):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,a,o,c,u,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(Oe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i)))).next((p=>(r=p,c=Date.now(),this.removeTargets(e,r,n)))).next((p=>(a=p,u=Date.now(),this.removeOrphanedDocuments(e,r)))).next((p=>(d=Date.now(),eu()<=bt.DEBUG&&Oe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${a} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(d-u)+`ms
Total Duration: ${d-h}ms`),we.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:p}))))}}function DF(t,e){return new NF(t,e)}class IF{constructor(){this.changes=new oc((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ur.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?we.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class MF{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class OF{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,n)))).next((i=>(r!==null&&If(r.mutation,i,ri.empty(),gt.now()),i)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.getLocalViewOfDocuments(e,r,wt()).next((()=>r))))}getLocalViewOfDocuments(e,n,r=wt()){const i=Fl();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,r).next((a=>{let o=bf();return a.forEach(((c,u)=>{o=o.insert(c,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,n){const r=Fl();return this.populateOverlays(e,r,n).next((()=>this.computeViews(e,n,r,wt())))}populateOverlays(e,n,r){const i=[];return r.forEach((a=>{n.has(a)||i.push(a)})),this.documentOverlayCache.getOverlays(e,i).next((a=>{a.forEach(((o,c)=>{n.set(o,c)}))}))}computeViews(e,n,r,i){let a=Ds();const o=Df(),c=(function(){return Df()})();return n.forEach(((u,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof rl)?a=a.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),If(h.mutation,d,h.mutation.getFieldMask(),gt.now())):o.set(d.key,ri.empty())})),this.recalculateAndSaveOverlays(e,a).next((u=>(u.forEach(((d,h)=>o.set(d,h))),n.forEach(((d,h)=>c.set(d,new MF(h,o.get(d)??null)))),c)))}recalculateAndSaveOverlays(e,n){const r=Df();let i=new ln(((o,c)=>o-c)),a=wt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((o=>{for(const c of o)c.keys().forEach((u=>{const d=n.get(u);if(d===null)return;let h=r.get(u)||ri.empty();h=c.applyToLocalView(d,h),r.set(u,h);const p=(i.get(c.batchId)||wt()).add(u);i=i.insert(c.batchId,p)}))})).next((()=>{const o=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,h=u.value,p=SI();h.forEach((m=>{if(!a.has(m)){const b=NI(n.get(m),r.get(m));b!==null&&p.set(m,b),a=a.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return we.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,n,r,i){return(function(o){return qe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):bI(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next((a=>{const o=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-a.size):we.resolve(Fl());let c=Zf,u=a;return o.next((d=>we.forEach(d,((h,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),a.get(h)?we.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{u=u.insert(h,m)}))))).next((()=>this.populateOverlays(e,d,a))).next((()=>this.computeViews(e,u,d,wt()))).next((h=>({batchId:c,changes:EI(h)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new qe(n)).next((r=>{let i=bf();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const a=n.collectionGroup;let o=bf();return this.indexManager.getCollectionParents(e,a).next((c=>we.forEach(c,(u=>{const d=(function(p,m){return new Zu(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(n,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next((h=>{h.forEach(((p,m)=>{o=o.insert(p,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,n,r,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next((o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,a,i)))).next((o=>{a.forEach(((u,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,ur.newInvalidDocument(h)))}));let c=bf();return o.forEach(((u,d)=>{const h=a.get(u);h!==void 0&&If(h.mutation,d,ri.empty(),gt.now()),k0(n,d)&&(c=c.insert(u,d))})),c}))}}class PF{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return we.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(i){return{id:i.id,version:i.version,createTime:Ma(i.createTime)}})(n)),we.resolve()}getNamedQuery(e,n){return we.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(i){return{name:i.name,query:SF(i.bundledQuery),readTime:Ma(i.readTime)}})(n)),we.resolve()}}class jF{constructor(){this.overlays=new ln(qe.comparator),this.qr=new Map}getOverlay(e,n){return we.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Fl();return we.forEach(n,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,n,r){return r.forEach(((i,a)=>{this.St(e,n,a)})),we.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(r)),we.resolve()}getOverlaysForCollection(e,n,r){const i=Fl(),a=n.length+1,o=new qe(n.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===a&&u.largestBatchId>r&&i.set(u.getKey(),u)}return we.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let a=new ln(((d,h)=>d-h));const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=a.get(d.largestBatchId);h===null&&(h=Fl(),a=a.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const c=Fl(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((d,h)=>c.set(d,h))),!(c.size()>=i)););return we.resolve(c)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new eF(n,r));let a=this.qr.get(n);a===void 0&&(a=wt(),this.qr.set(n,a)),this.qr.set(n,a.add(r.key))}}class VF{constructor(){this.sessionToken=ar.EMPTY_BYTE_STRING}getSessionToken(e){return we.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,we.resolve()}}class Cw{constructor(){this.Qr=new $n(Xn.$r),this.Ur=new $n(Xn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Xn(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach((r=>this.addReference(r,n)))}removeReference(e,n){this.Gr(new Xn(e,n))}zr(e,n){e.forEach((r=>this.removeReference(r,n)))}jr(e){const n=new qe(new Yt([])),r=new Xn(n,e),i=new Xn(n,e+1),a=[];return this.Ur.forEachInRange([r,i],(o=>{this.Gr(o),a.push(o.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new qe(new Yt([])),r=new Xn(n,e),i=new Xn(n,e+1);let a=wt();return this.Ur.forEachInRange([r,i],(o=>{a=a.add(o.key)})),a}containsKey(e){const n=new Xn(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Xn{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return qe.comparator(e.key,n.key)||xt(e.Yr,n.Yr)}static Kr(e,n){return xt(e.Yr,n.Yr)||qe.comparator(e.key,n.key)}}class zF{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new $n(Xn.$r)}checkEmpty(e){return we.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new J8(a,n,r,i);this.mutationQueue.push(o);for(const c of i)this.Zr=this.Zr.add(new Xn(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return we.resolve(o)}lookupMutationBatch(e,n){return we.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),a=i<0?0:i;return we.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return we.resolve(this.mutationQueue.length===0?yw:this.tr-1)}getAllMutationBatches(e){return we.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Xn(n,0),i=new Xn(n,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([r,i],(o=>{const c=this.Xr(o.Yr);a.push(c)})),we.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new $n(xt);return n.forEach((i=>{const a=new Xn(i,0),o=new Xn(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,o],(c=>{r=r.add(c.Yr)}))})),we.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let a=r;qe.isDocumentKey(a)||(a=a.child(""));const o=new Xn(new qe(a),0);let c=new $n(xt);return this.Zr.forEachWhile((u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(c=c.add(u.Yr)),!0)}),o),we.resolve(this.ti(c))}ti(e){const n=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&n.push(i)})),n}removeMutationBatch(e,n){Ot(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return we.forEach(n.mutations,(i=>{const a=new Xn(i.key,n.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,n){const r=new Xn(n,0),i=this.Zr.firstAfterOrEqual(r);return we.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,we.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class LF{constructor(e){this.ri=e,this.docs=(function(){return new ln(qe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),a=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return we.resolve(r?r.document.mutableCopy():ur.newInvalidDocument(n))}getEntries(e,n){let r=Ds();return n.forEach((i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():ur.newInvalidDocument(i))})),we.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let a=Ds();const o=n.path,c=new qe(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:h}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||h8(f8(h),r)<=0||(i.has(h.key)||k0(n,h))&&(a=a.insert(h.key,h.mutableCopy()))}return we.resolve(a)}getAllFromCollectionGroup(e,n,r,i){Je(9500)}ii(e,n){return we.forEach(this.docs,(r=>n(r)))}newChangeBuffer(e){return new BF(this)}getSize(e){return we.resolve(this.size)}}class BF extends IF{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),we.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class UF{constructor(e){this.persistence=e,this.si=new oc((n=>ww(n)),_w),this.lastRemoteSnapshotVersion=nt.min(),this.highestTargetId=0,this.oi=0,this._i=new Cw,this.targetCount=0,this.ai=Du.ur()}forEachTarget(e,n){return this.si.forEach(((r,i)=>n(i))),we.resolve()}getLastRemoteSnapshotVersion(e){return we.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return we.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),we.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),we.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Du(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,we.resolve()}updateTargetData(e,n){return this.Pr(n),we.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,we.resolve()}removeTargets(e,n,r){let i=0;const a=[];return this.si.forEach(((o,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.si.delete(o),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)})),we.waitFor(a).next((()=>i))}getTargetCount(e){return we.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return we.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),we.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,a=[];return i&&n.forEach((o=>{a.push(i.markPotentiallyOrphaned(e,o))})),we.waitFor(a)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),we.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return we.resolve(r)}containsKey(e,n){return we.resolve(this._i.containsKey(n))}}class $I{constructor(e,n){this.ui={},this.overlays={},this.ci=new E0(0),this.li=!1,this.li=!0,this.hi=new VF,this.referenceDelegate=e(this),this.Pi=new UF(this),this.indexManager=new TF,this.remoteDocumentCache=(function(i){return new LF(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new EF(n),this.Ii=new PF(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new jF,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new zF(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){Oe("MemoryPersistence","Starting transaction:",e);const i=new FF(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((a=>this.referenceDelegate.di(i).next((()=>a)))).toPromise().then((a=>(i.raiseOnCommittedEvent(),a)))}Ai(e,n){return we.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,n))))}}class FF extends g8{constructor(e){super(),this.currentSequenceNumber=e}}class kw{constructor(e){this.persistence=e,this.Ri=new Cw,this.Vi=null}static mi(e){return new kw(e)}get fi(){if(this.Vi)return this.Vi;throw Je(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),we.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),we.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),we.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next((i=>{i.forEach((a=>this.fi.add(a.toString())))})).next((()=>r.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return we.forEach(this.fi,(r=>{const i=qe.fromPath(r);return this.gi(e,i).next((a=>{a||n.removeEntry(i,nt.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return we.or([()=>we.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class zm{constructor(e,n){this.persistence=e,this.pi=new oc((r=>y8(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=DF(this,n)}static mi(e,n){return new zm(e,n)}Ei(){}di(e){return we.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>n.next((i=>r+i))))}wr(e){let n=0;return this.pr(e,(r=>{n++})).next((()=>n))}pr(e,n){return we.forEach(this.pi,((r,i)=>this.br(e,r,i).next((a=>a?we.resolve():n(i)))))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,(o=>this.br(e,o,n).next((c=>{c||(r++,a.removeEntry(o,nt.min()))})))).next((()=>a.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),we.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),we.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),we.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),we.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=rm(e.data.value)),n}br(e,n,r){return we.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return we.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Rw{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=wt(),i=wt();for(const a of n.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Rw(e,n.fromCache,r,i)}}class $F{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class GF{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return G5()?8:m8(fr())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const a={result:null};return this.ys(e,n).next((o=>{a.result=o})).next((()=>{if(!a.result)return this.ws(e,n,i,r).next((o=>{a.result=o}))})).next((()=>{if(a.result)return;const o=new $F;return this.Ss(e,n,o).next((c=>{if(a.result=c,this.Vs)return this.bs(e,n,o,c.size)}))})).next((()=>a.result))}bs(e,n,r,i){return r.documentReadCount<this.fs?(eu()<=bt.DEBUG&&Oe("QueryEngine","SDK will not create cache indexes for query:",tu(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),we.resolve()):(eu()<=bt.DEBUG&&Oe("QueryEngine","Query:",tu(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(eu()<=bt.DEBUG&&Oe("QueryEngine","The SDK decides to create cache indexes for query:",tu(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ia(n))):we.resolve())}ys(e,n){if(_2(n))return we.resolve(null);let r=Ia(n);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(n.limit!==null&&i===1&&(n=Om(n,null,"F"),r=Ia(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next((a=>{const o=wt(...a);return this.ps.getDocuments(e,o).next((c=>this.indexManager.getMinOffset(e,r).next((u=>{const d=this.Ds(n,c);return this.Cs(n,d,o,u.readTime)?this.ys(e,Om(n,null,"F")):this.vs(e,d,n,u)}))))})))))}ws(e,n,r,i){return _2(n)||i.isEqual(nt.min())?we.resolve(null):this.ps.getDocuments(e,r).next((a=>{const o=this.Ds(n,a);return this.Cs(n,o,r,i)?we.resolve(null):(eu()<=bt.DEBUG&&Oe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),tu(n)),this.vs(e,o,n,d8(i,Zf)).next((c=>c)))}))}Ds(e,n){let r=new $n(wI(e));return n.forEach(((i,a)=>{k0(e,a)&&(r=r.add(a))})),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const a=e.limitType==="F"?n.last():n.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,n,r){return eu()<=bt.DEBUG&&Oe("QueryEngine","Using full collection scan to execute query:",tu(n)),this.ps.getDocumentsMatchingQuery(e,n,Uo.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((a=>(n.forEach((o=>{a=a.insert(o.key,o)})),a)))}}const Nw="LocalStore",HF=3e8;class qF{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new ln(xt),this.xs=new oc((a=>ww(a)),_w),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new OF(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function YF(t,e,n,r){return new qF(t,e,n,r)}async function GI(t,e){const n=at(t);return await n.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next((a=>(i=a,n.Bs(e),n.mutationQueue.getAllMutationBatches(r)))).next((a=>{const o=[],c=[];let u=wt();for(const d of i){o.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}for(const d of a){c.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}return n.localDocuments.getDocuments(r,u).next((d=>({Ls:d,removedBatchIds:o,addedBatchIds:c})))}))}))}function XF(t,e){const n=at(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),a=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,u,d,h){const p=d.batch,m=p.keys();let b=we.resolve();return m.forEach((w=>{b=b.next((()=>h.getEntry(u,w))).next((E=>{const S=d.docVersions.get(w);Ot(S!==null,48541),E.version.compareTo(S)<0&&(p.applyToRemoteDocument(E,d),E.isValidDocument()&&(E.setReadTime(d.commitVersion),h.addEntry(E)))}))})),b.next((()=>c.mutationQueue.removeMutationBatch(u,p)))})(n,r,e,a).next((()=>a.apply(r))).next((()=>n.mutationQueue.performConsistencyCheck(r))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let u=wt();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u})(e)))).next((()=>n.localDocuments.getDocuments(r,i)))}))}function HI(t){const e=at(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function WF(t,e){const n=at(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const c=[];e.targetChanges.forEach(((h,p)=>{const m=i.get(p);if(!m)return;c.push(n.Pi.removeMatchingKeys(a,h.removedDocuments,p).next((()=>n.Pi.addMatchingKeys(a,h.addedDocuments,p))));let b=m.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(p)!==null?b=b.withResumeToken(ar.EMPTY_BYTE_STRING,nt.min()).withLastLimboFreeSnapshotVersion(nt.min()):h.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(h.resumeToken,r)),i=i.insert(p,b),(function(E,S,T){return E.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=HF?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(m,b,h)&&c.push(n.Pi.updateTargetData(a,b))}));let u=Ds(),d=wt();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(a,h))})),c.push(KF(a,o,e.documentUpdates).next((h=>{u=h.ks,d=h.qs}))),!r.isEqual(nt.min())){const h=n.Pi.getLastRemoteSnapshotVersion(a).next((p=>n.Pi.setTargetsMetadata(a,a.currentSequenceNumber,r)));c.push(h)}return we.waitFor(c).next((()=>o.apply(a))).next((()=>n.localDocuments.getLocalViewOfDocuments(a,u,d))).next((()=>u))})).then((a=>(n.Ms=i,a)))}function KF(t,e,n){let r=wt(),i=wt();return n.forEach((a=>r=r.add(a))),e.getEntries(t,r).next((a=>{let o=Ds();return n.forEach(((c,u)=>{const d=a.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(nt.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):Oe(Nw,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)})),{ks:o,qs:i}}))}function QF(t,e){const n=at(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=yw),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function ZF(t,e){const n=at(t);return n.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return n.Pi.getTargetData(r,e).next((a=>a?(i=a,we.resolve(i)):n.Pi.allocateTargetId(r).next((o=>(i=new Co(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r}))}async function Bx(t,e,n){const r=at(t),i=r.Ms.get(e),a=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",a,(o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Qu(o))throw o;Oe(Nw,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function P2(t,e,n){const r=at(t);let i=nt.min(),a=wt();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(u,d,h){const p=at(u),m=p.xs.get(h);return m!==void 0?we.resolve(p.Ms.get(m)):p.Pi.getTargetData(d,h)})(r,o,Ia(e)).next((c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,c.targetId).next((u=>{a=u}))})).next((()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:nt.min(),n?a:wt()))).next((c=>(JF(r,V8(e),c),{documents:c,Qs:a})))))}function JF(t,e,n){let r=t.Os.get(e)||nt.min();n.forEach(((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)})),t.Os.set(e,r)}class j2{constructor(){this.activeTargetIds=$8()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class e7{constructor(){this.Mo=new j2,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new j2,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class t7{Oo(e){}shutdown(){}}const V2="ConnectivityMonitor";class z2{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Oe(V2,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Oe(V2,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let kg=null;function Ux(){return kg===null?kg=(function(){return 268435456+Math.round(2147483648*Math.random())})():kg++,"0x"+kg.toString(16)}const Cb="RestConnection",n7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class r7{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===Dm?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,a){const o=Ux(),c=this.zo(e,n.toUriEncodedString());Oe(Cb,`Sending RPC '${e}' ${o}:`,c,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,a);const{host:d}=new URL(c),h=el(d);return this.Jo(e,c,u,r,h).then((p=>(Oe(Cb,`Received RPC '${e}' ${o}: `,p),p)),(p=>{throw Au(Cb,`RPC '${e}' ${o} failed with error: `,p,"url: ",c,"request:",r),p}))}Ho(e,n,r,i,a,o){return this.Go(e,n,r,i,a)}jo(e,n,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Wu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((i,a)=>e[a]=i)),r&&r.headers.forEach(((i,a)=>e[a]=i))}zo(e,n){const r=n7[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}class i7{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const lr="WebChannelConnection";class a7 extends r7{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,a){const o=Ux();return new Promise(((c,u)=>{const d=new XD;d.setWithCredentials(!0),d.listenOnce(WD.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case nm.NO_ERROR:const p=d.getResponseJson();Oe(lr,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),c(p);break;case nm.TIMEOUT:Oe(lr,`RPC '${e}' ${o} timed out`),u(new Ne(be.DEADLINE_EXCEEDED,"Request time out"));break;case nm.HTTP_ERROR:const m=d.getStatus();if(Oe(lr,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let b=d.getResponseJson();Array.isArray(b)&&(b=b[0]);const w=b?.error;if(w&&w.status&&w.message){const E=(function(T){const C=T.toLowerCase().replace(/_/g,"-");return Object.values(be).indexOf(C)>=0?C:be.UNKNOWN})(w.status);u(new Ne(E,w.message))}else u(new Ne(be.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new Ne(be.UNAVAILABLE,"Connection failed."));break;default:Je(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Oe(lr,`RPC '${e}' ${o} completed.`)}}));const h=JSON.stringify(i);Oe(lr,`RPC '${e}' ${o} sending request:`,i),d.send(n,"POST",h,r,15)}))}T_(e,n,r){const i=Ux(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=ZD(),c=QD(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const h=a.join("");Oe(lr,`Creating RPC '${e}' stream ${i}: ${h}`,u);const p=o.createWebChannel(h,u);this.I_(p);let m=!1,b=!1;const w=new i7({Yo:S=>{b?Oe(lr,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(m||(Oe(lr,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),Oe(lr,`RPC '${e}' stream ${i} sending:`,S),p.send(S))},Zo:()=>p.close()}),E=(S,T,C)=>{S.listen(T,(N=>{try{C(N)}catch(j){setTimeout((()=>{throw j}),0)}}))};return E(p,yf.EventType.OPEN,(()=>{b||(Oe(lr,`RPC '${e}' stream ${i} transport opened.`),w.o_())})),E(p,yf.EventType.CLOSE,(()=>{b||(b=!0,Oe(lr,`RPC '${e}' stream ${i} transport closed`),w.a_(),this.E_(p))})),E(p,yf.EventType.ERROR,(S=>{b||(b=!0,Au(lr,`RPC '${e}' stream ${i} transport errored. Name:`,S.name,"Message:",S.message),w.a_(new Ne(be.UNAVAILABLE,"The operation could not be completed")))})),E(p,yf.EventType.MESSAGE,(S=>{if(!b){const T=S.data[0];Ot(!!T,16349);const C=T,N=C?.error||C[0]?.error;if(N){Oe(lr,`RPC '${e}' stream ${i} received error:`,N);const j=N.status;let P=(function(k){const D=In[k];if(D!==void 0)return II(D)})(j),M=N.message;P===void 0&&(P=be.INTERNAL,M="Unknown error status: "+j+" with message "+N.message),b=!0,w.a_(new Ne(P,M)),p.close()}else Oe(lr,`RPC '${e}' stream ${i} received:`,T),w.u_(T)}})),E(c,KD.STAT_EVENT,(S=>{S.stat===Rx.PROXY?Oe(lr,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===Rx.NOPROXY&&Oe(lr,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{w.__()}),0),w}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function kb(){return typeof document<"u"?document:null}function M0(t){return new cF(t,!0)}class qI{constructor(e,n,r=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&Oe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const L2="PersistentStream";class YI{constructor(e,n,r,i,a,o,c,u){this.Mi=e,this.S_=r,this.b_=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new qI(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===be.RESOURCE_EXHAUSTED?(Ns(n.toString()),Ns("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===be.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===n&&this.G_(r,i)}),(r=>{e((()=>{const i=new Ne(be.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Oe(L2,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(Oe(L2,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class s7 extends YI{constructor(e,n,r,i,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=a}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=fF(this.serializer,e),r=(function(a){if(!("targetChange"in a))return nt.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?nt.min():o.readTime?Ma(o.readTime):nt.min()})(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Lx(this.serializer),n.addTarget=(function(a,o){let c;const u=o.target;if(c=Ox(u)?{documents:gF(a,u)}:{query:mF(a,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=PI(a,o.resumeToken);const d=jx(a,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(nt.min())>0){c.readTime=Vm(a,o.snapshotVersion.toTimestamp());const d=jx(a,o.expectedCount);d!==null&&(c.expectedCount=d)}return c})(this.serializer,e);const r=yF(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Lx(this.serializer),n.removeTarget=e,this.q_(n)}}class o7 extends YI{constructor(e,n,r,i,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Ot(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ot(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ot(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=pF(e.writeResults,e.commitTime),r=Ma(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Lx(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((r=>hF(this.serializer,r)))};this.q_(n)}}class l7{}class c7 extends l7{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Ne(be.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Go(e,Vx(n,r),i,a,o))).catch((a=>{throw a.name==="FirebaseError"?(a.code===be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ne(be.UNKNOWN,a.toString())}))}Ho(e,n,r,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Ho(e,Vx(n,r),i,o,c,a))).catch((o=>{throw o.name==="FirebaseError"?(o.code===be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ne(be.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class u7{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ns(n),this.aa=!1):Oe("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const ec="RemoteStore";class d7{constructor(e,n,r,i,a){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((o=>{r.enqueueAndForget((async()=>{lc(this)&&(Oe(ec,"Restarting streams for network reachability change."),await(async function(u){const d=at(u);d.Ea.add(4),await Dh(d),d.Ra.set("Unknown"),d.Ea.delete(4),await O0(d)})(this))}))})),this.Ra=new u7(r,i)}}async function O0(t){if(lc(t))for(const e of t.da)await e(!0)}async function Dh(t){for(const e of t.da)await e(!1)}function XI(t,e){const n=at(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Ow(n)?Mw(n):Ju(n).O_()&&Iw(n,e))}function Dw(t,e){const n=at(t),r=Ju(n);n.Ia.delete(e),r.O_()&&WI(n,e),n.Ia.size===0&&(r.O_()?r.L_():lc(n)&&n.Ra.set("Unknown"))}function Iw(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(nt.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ju(t).Y_(e)}function WI(t,e){t.Va.Ue(e),Ju(t).Z_(e)}function Mw(t){t.Va=new aF({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Ju(t).start(),t.Ra.ua()}function Ow(t){return lc(t)&&!Ju(t).x_()&&t.Ia.size>0}function lc(t){return at(t).Ea.size===0}function KI(t){t.Va=void 0}async function f7(t){t.Ra.set("Online")}async function h7(t){t.Ia.forEach(((e,n)=>{Iw(t,e)}))}async function p7(t,e){KI(t),Ow(t)?(t.Ra.ha(e),Mw(t)):t.Ra.set("Unknown")}async function g7(t,e,n){if(t.Ra.set("Online"),e instanceof OI&&e.state===2&&e.cause)try{await(async function(i,a){const o=a.cause;for(const c of a.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.Ia.delete(c),i.Va.removeTarget(c))})(t,e)}catch(r){Oe(ec,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Lm(t,r)}else if(e instanceof sm?t.Va.Ze(e):e instanceof MI?t.Va.st(e):t.Va.tt(e),!n.isEqual(nt.min()))try{const r=await HI(t.localStore);n.compareTo(r)>=0&&await(function(a,o){const c=a.Va.Tt(o);return c.targetChanges.forEach(((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const h=a.Ia.get(d);h&&a.Ia.set(d,h.withResumeToken(u.resumeToken,o))}})),c.targetMismatches.forEach(((u,d)=>{const h=a.Ia.get(u);if(!h)return;a.Ia.set(u,h.withResumeToken(ar.EMPTY_BYTE_STRING,h.snapshotVersion)),WI(a,u);const p=new Co(h.target,u,d,h.sequenceNumber);Iw(a,p)})),a.remoteSyncer.applyRemoteEvent(c)})(t,n)}catch(r){Oe(ec,"Failed to raise snapshot:",r),await Lm(t,r)}}async function Lm(t,e,n){if(!Qu(e))throw e;t.Ea.add(1),await Dh(t),t.Ra.set("Offline"),n||(n=()=>HI(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Oe(ec,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await O0(t)}))}function QI(t,e){return e().catch((n=>Lm(t,n,e)))}async function P0(t){const e=at(t),n=Ho(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:yw;for(;m7(e);)try{const i=await QF(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,v7(e,i)}catch(i){await Lm(e,i)}ZI(e)&&JI(e)}function m7(t){return lc(t)&&t.Ta.length<10}function v7(t,e){t.Ta.push(e);const n=Ho(t);n.O_()&&n.X_&&n.ea(e.mutations)}function ZI(t){return lc(t)&&!Ho(t).x_()&&t.Ta.length>0}function JI(t){Ho(t).start()}async function y7(t){Ho(t).ra()}async function b7(t){const e=Ho(t);for(const n of t.Ta)e.ea(n.mutations)}async function x7(t,e,n){const r=t.Ta.shift(),i=Sw.from(r,e,n);await QI(t,(()=>t.remoteSyncer.applySuccessfulWrite(i))),await P0(t)}async function w7(t,e){e&&Ho(t).X_&&await(async function(r,i){if((function(o){return nF(o)&&o!==be.ABORTED})(i.code)){const a=r.Ta.shift();Ho(r).B_(),await QI(r,(()=>r.remoteSyncer.rejectFailedWrite(a.batchId,i))),await P0(r)}})(t,e),ZI(t)&&JI(t)}async function B2(t,e){const n=at(t);n.asyncQueue.verifyOperationInProgress(),Oe(ec,"RemoteStore received new credentials");const r=lc(n);n.Ea.add(3),await Dh(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await O0(n)}async function _7(t,e){const n=at(t);e?(n.Ea.delete(2),await O0(n)):e||(n.Ea.add(2),await Dh(n),n.Ra.set("Unknown"))}function Ju(t){return t.ma||(t.ma=(function(n,r,i){const a=at(n);return a.sa(),new s7(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(t.datastore,t.asyncQueue,{Xo:f7.bind(null,t),t_:h7.bind(null,t),r_:p7.bind(null,t),H_:g7.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),Ow(t)?Mw(t):t.Ra.set("Unknown")):(await t.ma.stop(),KI(t))}))),t.ma}function Ho(t){return t.fa||(t.fa=(function(n,r,i){const a=at(n);return a.sa(),new o7(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:y7.bind(null,t),r_:w7.bind(null,t),ta:b7.bind(null,t),na:x7.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await P0(t)):(await t.fa.stop(),t.Ta.length>0&&(Oe(ec,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class Pw{constructor(e,n,r,i,a){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new _s,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,a){const o=Date.now()+r,c=new Pw(e,n,o,i,a);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ne(be.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jw(t,e){if(Ns("AsyncQueue",`${e}: ${t}`),Qu(t))return new Ne(be.UNAVAILABLE,`${e}: ${t}`);throw t}class _u{static emptySet(e){return new _u(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||qe.comparator(n.key,r.key):(n,r)=>qe.comparator(n.key,r.key),this.keyedMap=bf(),this.sortedSet=new ln(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,r)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof _u)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new _u;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}class U2{constructor(){this.ga=new ln(qe.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Je(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,r)=>{e.push(r)})),e}}class Iu{constructor(e,n,r,i,a,o,c,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,i,a){const o=[];return n.forEach((c=>{o.push({type:0,doc:c})})),new Iu(e,n,_u.emptySet(n),o,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&C0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}class E7{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class S7{constructor(){this.queries=F2(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=at(n),a=i.queries;i.queries=F2(),a.forEach(((o,c)=>{for(const u of c.Sa)u.onError(r)}))})(this,new Ne(be.ABORTED,"Firestore shutting down"))}}function F2(){return new oc((t=>xI(t)),C0)}async function Vw(t,e){const n=at(t);let r=3;const i=e.query;let a=n.queries.get(i);a?!a.ba()&&e.Da()&&(r=2):(a=new E7,r=e.Da()?0:1);try{switch(r){case 0:a.wa=await n.onListen(i,!0);break;case 1:a.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const c=jw(o,`Initialization of query '${tu(e.query)}' failed`);return void e.onError(c)}n.queries.set(i,a),a.Sa.push(e),e.va(n.onlineState),a.wa&&e.Fa(a.wa)&&Lw(n)}async function zw(t,e){const n=at(t),r=e.query;let i=3;const a=n.queries.get(r);if(a){const o=a.Sa.indexOf(e);o>=0&&(a.Sa.splice(o,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function T7(t,e){const n=at(t);let r=!1;for(const i of e){const a=i.query,o=n.queries.get(a);if(o){for(const c of o.Sa)c.Fa(i)&&(r=!0);o.wa=i}}r&&Lw(n)}function A7(t,e,n){const r=at(t),i=r.queries.get(e);if(i)for(const a of i.Sa)a.onError(n);r.queries.delete(e)}function Lw(t){t.Ca.forEach((e=>{e.next()}))}var Fx,$2;($2=Fx||(Fx={})).Ma="default",$2.Cache="cache";class Bw{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Iu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Iu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Fx.Cache}}class eM{constructor(e){this.key=e}}class tM{constructor(e){this.key=e}}class C7{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=wt(),this.mutatedKeys=wt(),this.eu=wI(e),this.tu=new _u(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new U2,i=n?n.tu:this.tu;let a=n?n.mutatedKeys:this.mutatedKeys,o=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,p)=>{const m=i.get(h),b=k0(this.query,p)?p:null,w=!!m&&this.mutatedKeys.has(m.key),E=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let S=!1;m&&b?m.data.isEqual(b.data)?w!==E&&(r.track({type:3,doc:b}),S=!0):this.su(m,b)||(r.track({type:2,doc:b}),S=!0,(u&&this.eu(b,u)>0||d&&this.eu(b,d)<0)&&(c=!0)):!m&&b?(r.track({type:0,doc:b}),S=!0):m&&!b&&(r.track({type:1,doc:m}),S=!0,(u||d)&&(c=!0)),S&&(b?(o=o.add(b),a=E?a.add(h):a.delete(h)):(o=o.delete(h),a=a.delete(h)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),a=a.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:c,mutatedKeys:a}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((h,p)=>(function(b,w){const E=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Je(20277,{Rt:S})}};return E(b)-E(w)})(h.type,p.type)||this.eu(h.doc,p.doc))),this.ou(r),i=i??!1;const c=n&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,d=u!==this.Za;return this.Za=u,o.length!==0||d?{snapshot:new Iu(this.query,e.tu,a,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new U2,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=wt(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const n=[];return e.forEach((r=>{this.Xa.has(r)||n.push(new tM(r))})),this.Xa.forEach((r=>{e.has(r)||n.push(new eM(r))})),n}cu(e){this.Ya=e.Qs,this.Xa=wt();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Iu.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Uw="SyncEngine";class k7{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class R7{constructor(e){this.key=e,this.hu=!1}}class N7{constructor(e,n,r,i,a,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new oc((c=>xI(c)),C0),this.Iu=new Map,this.Eu=new Set,this.du=new ln(qe.comparator),this.Au=new Map,this.Ru=new Cw,this.Vu={},this.mu=new Map,this.fu=Du.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function D7(t,e,n=!0){const r=oM(t);let i;const a=r.Tu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await nM(r,e,n,!0),i}async function I7(t,e){const n=oM(t);await nM(n,e,!0,!1)}async function nM(t,e,n,r){const i=await ZF(t.localStore,Ia(e)),a=i.targetId,o=t.sharedClientState.addLocalQueryTarget(a,n);let c;return r&&(c=await M7(t,e,a,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&XI(t.remoteStore,i),c}async function M7(t,e,n,r,i){t.pu=(p,m,b)=>(async function(E,S,T,C){let N=S.view.ru(T);N.Cs&&(N=await P2(E.localStore,S.query,!1).then((({documents:A})=>S.view.ru(A,N))));const j=C&&C.targetChanges.get(S.targetId),P=C&&C.targetMismatches.get(S.targetId)!=null,M=S.view.applyChanges(N,E.isPrimaryClient,j,P);return H2(E,S.targetId,M.au),M.snapshot})(t,p,m,b);const a=await P2(t.localStore,e,!0),o=new C7(e,a.Qs),c=o.ru(a.documents),u=Nh.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),d=o.applyChanges(c,t.isPrimaryClient,u);H2(t,n,d.au);const h=new k7(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function O7(t,e,n){const r=at(t),i=r.Tu.get(e),a=r.Iu.get(i.targetId);if(a.length>1)return r.Iu.set(i.targetId,a.filter((o=>!C0(o,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Bx(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Dw(r.remoteStore,i.targetId),$x(r,i.targetId)})).catch(Ku)):($x(r,i.targetId),await Bx(r.localStore,i.targetId,!0))}async function P7(t,e){const n=at(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Dw(n.remoteStore,r.targetId))}async function j7(t,e,n){const r=$7(t);try{const i=await(function(o,c){const u=at(o),d=gt.now(),h=c.reduce(((b,w)=>b.add(w.key)),wt());let p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",(b=>{let w=Ds(),E=wt();return u.Ns.getEntries(b,h).next((S=>{w=S,w.forEach(((T,C)=>{C.isValidDocument()||(E=E.add(T))}))})).next((()=>u.localDocuments.getOverlayedDocuments(b,w))).next((S=>{p=S;const T=[];for(const C of c){const N=Q8(C,p.get(C.key).overlayedDocument);N!=null&&T.push(new rl(C.key,N,fI(N.value.mapValue),Sr.exists(!0)))}return u.mutationQueue.addMutationBatch(b,d,T,c)})).next((S=>{m=S;const T=S.applyToLocalDocumentSet(p,E);return u.documentOverlayCache.saveOverlays(b,S.batchId,T)}))})).then((()=>({batchId:m.batchId,changes:EI(p)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,c,u){let d=o.Vu[o.currentUser.toKey()];d||(d=new ln(xt)),d=d.insert(c,u),o.Vu[o.currentUser.toKey()]=d})(r,i.batchId,n),await Ih(r,i.changes),await P0(r.remoteStore)}catch(i){const a=jw(i,"Failed to persist write");n.reject(a)}}async function rM(t,e){const n=at(t);try{const r=await WF(n.localStore,e);e.targetChanges.forEach(((i,a)=>{const o=n.Au.get(a);o&&(Ot(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?Ot(o.hu,14607):i.removedDocuments.size>0&&(Ot(o.hu,42227),o.hu=!1))})),await Ih(n,r,e)}catch(r){await Ku(r)}}function G2(t,e,n){const r=at(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach(((a,o)=>{const c=o.view.va(e);c.snapshot&&i.push(c.snapshot)})),(function(o,c){const u=at(o);u.onlineState=c;let d=!1;u.queries.forEach(((h,p)=>{for(const m of p.Sa)m.va(c)&&(d=!0)})),d&&Lw(u)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function V7(t,e,n){const r=at(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),a=i&&i.key;if(a){let o=new ln(qe.comparator);o=o.insert(a,ur.newNoDocument(a,nt.min()));const c=wt().add(a),u=new I0(nt.min(),new Map,new ln(xt),o,c);await rM(r,u),r.du=r.du.remove(a),r.Au.delete(e),Fw(r)}else await Bx(r.localStore,e,!1).then((()=>$x(r,e,n))).catch(Ku)}async function z7(t,e){const n=at(t),r=e.batch.batchId;try{const i=await XF(n.localStore,e);aM(n,r,null),iM(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ih(n,i)}catch(i){await Ku(i)}}async function L7(t,e,n){const r=at(t);try{const i=await(function(o,c){const u=at(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let h;return u.mutationQueue.lookupMutationBatch(d,c).next((p=>(Ot(p!==null,37113),h=p.keys(),u.mutationQueue.removeMutationBatch(d,p)))).next((()=>u.mutationQueue.performConsistencyCheck(d))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(d,h,c))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h))).next((()=>u.localDocuments.getDocuments(d,h)))}))})(r.localStore,e);aM(r,e,n),iM(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ih(r,i)}catch(i){await Ku(i)}}function iM(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function aM(t,e,n){const r=at(t);let i=r.Vu[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(n?a.reject(n):a.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function $x(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((r=>{t.Ru.containsKey(r)||sM(t,r)}))}function sM(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Dw(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),Fw(t))}function H2(t,e,n){for(const r of n)r instanceof eM?(t.Ru.addReference(r.key,e),B7(t,r)):r instanceof tM?(Oe(Uw,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||sM(t,r.key)):Je(19791,{wu:r})}function B7(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(Oe(Uw,"New document in limbo: "+n),t.Eu.add(r),Fw(t))}function Fw(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new qe(Yt.fromString(e)),r=t.fu.next();t.Au.set(r,new R7(n)),t.du=t.du.insert(n,r),XI(t.remoteStore,new Co(Ia(A0(n.path)),r,"TargetPurposeLimboResolution",E0.ce))}}async function Ih(t,e,n){const r=at(t),i=[],a=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,u)=>{o.push(r.pu(u,e,n).then((d=>{if((d||n)&&r.isPrimaryClient){const h=d?!d.fromCache:n?.targetChanges.get(u.targetId)?.current;r.sharedClientState.updateQueryState(u.targetId,h?"current":"not-current")}if(d){i.push(d);const h=Rw.As(u.targetId,d);a.push(h)}})))})),await Promise.all(o),r.Pu.H_(i),await(async function(u,d){const h=at(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>we.forEach(d,(m=>we.forEach(m.Es,(b=>h.persistence.referenceDelegate.addReference(p,m.targetId,b))).next((()=>we.forEach(m.ds,(b=>h.persistence.referenceDelegate.removeReference(p,m.targetId,b)))))))))}catch(p){if(!Qu(p))throw p;Oe(Nw,"Failed to update sequence numbers: "+p)}for(const p of d){const m=p.targetId;if(!p.fromCache){const b=h.Ms.get(m),w=b.snapshotVersion,E=b.withLastLimboFreeSnapshotVersion(w);h.Ms=h.Ms.insert(m,E)}}})(r.localStore,a))}async function U7(t,e){const n=at(t);if(!n.currentUser.isEqual(e)){Oe(Uw,"User change. New user:",e.toKey());const r=await GI(n.localStore,e);n.currentUser=e,(function(a,o){a.mu.forEach((c=>{c.forEach((u=>{u.reject(new Ne(be.CANCELLED,o))}))})),a.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ih(n,r.Ls)}}function F7(t,e){const n=at(t),r=n.Au.get(e);if(r&&r.hu)return wt().add(r.key);{let i=wt();const a=n.Iu.get(e);if(!a)return i;for(const o of a){const c=n.Tu.get(o);i=i.unionWith(c.view.nu)}return i}}function oM(t){const e=at(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=rM.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=F7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=V7.bind(null,e),e.Pu.H_=T7.bind(null,e.eventManager),e.Pu.yu=A7.bind(null,e.eventManager),e}function $7(t){const e=at(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=z7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=L7.bind(null,e),e}class Bm{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=M0(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return YF(this.persistence,new GF,e.initialUser,this.serializer)}Cu(e){return new $I(kw.mi,this.serializer)}Du(e){return new e7}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Bm.provider={build:()=>new Bm};class G7 extends Bm{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Ot(this.persistence.referenceDelegate instanceof zm,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new RF(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Or.withCacheSize(this.cacheSizeBytes):Or.DEFAULT;return new $I((r=>zm.mi(r,n)),this.serializer)}}class Gx{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>G2(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=U7.bind(null,this.syncEngine),await _7(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new S7})()}createDatastore(e){const n=M0(e.databaseInfo.databaseId),r=(function(a){return new a7(a)})(e.databaseInfo);return(function(a,o,c,u){return new c7(a,o,c,u)})(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return(function(r,i,a,o,c){return new d7(r,i,a,o,c)})(this.localStore,this.datastore,e.asyncQueue,(n=>G2(this.syncEngine,n,0)),(function(){return z2.v()?new z2:new t7})())}createSyncEngine(e,n){return(function(i,a,o,c,u,d,h){const p=new N7(i,a,o,c,u,d);return h&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const r=at(n);Oe(ec,"RemoteStore shutting down."),r.Ea.add(5),await Dh(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Gx.provider={build:()=>new Gx};class $w{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ns("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const qo="FirestoreClient";class H7{constructor(e,n,r,i,a){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=cr.UNAUTHENTICATED,this.clientId=vw.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,(async o=>{Oe(qo,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(Oe(qo,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new _s;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=jw(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Rb(t,e){t.asyncQueue.verifyOperationInProgress(),Oe(qo,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener((async i=>{r.isEqual(i)||(await GI(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function q2(t,e){t.asyncQueue.verifyOperationInProgress();const n=await q7(t);Oe(qo,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((r=>B2(e.remoteStore,r))),t.setAppCheckTokenChangeListener(((r,i)=>B2(e.remoteStore,i))),t._onlineComponents=e}async function q7(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Oe(qo,"Using user provided OfflineComponentProvider");try{await Rb(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(i){return i.name==="FirebaseError"?i.code===be.FAILED_PRECONDITION||i.code===be.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(n))throw n;Au("Error using user provided cache. Falling back to memory cache: "+n),await Rb(t,new Bm)}}else Oe(qo,"Using default OfflineComponentProvider"),await Rb(t,new G7(void 0));return t._offlineComponents}async function lM(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Oe(qo,"Using user provided OnlineComponentProvider"),await q2(t,t._uninitializedComponentsProvider._online)):(Oe(qo,"Using default OnlineComponentProvider"),await q2(t,new Gx))),t._onlineComponents}function Y7(t){return lM(t).then((e=>e.syncEngine))}async function Um(t){const e=await lM(t),n=e.eventManager;return n.onListen=D7.bind(null,e.syncEngine),n.onUnlisten=O7.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=I7.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=P7.bind(null,e.syncEngine),n}function X7(t,e,n={}){const r=new _s;return t.asyncQueue.enqueueAndForget((async()=>(function(a,o,c,u,d){const h=new $w({next:m=>{h.Nu(),o.enqueueAndForget((()=>zw(a,p)));const b=m.docs.has(c);!b&&m.fromCache?d.reject(new Ne(be.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&m.fromCache&&u&&u.source==="server"?d.reject(new Ne(be.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new Bw(A0(c.path),h,{includeMetadataChanges:!0,qa:!0});return Vw(a,p)})(await Um(t),t.asyncQueue,e,n,r))),r.promise}function W7(t,e,n={}){const r=new _s;return t.asyncQueue.enqueueAndForget((async()=>(function(a,o,c,u,d){const h=new $w({next:m=>{h.Nu(),o.enqueueAndForget((()=>zw(a,p))),m.fromCache&&u.source==="server"?d.reject(new Ne(be.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new Bw(c,h,{includeMetadataChanges:!0,qa:!0});return Vw(a,p)})(await Um(t),t.asyncQueue,e,n,r))),r.promise}function cM(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const Y2=new Map;const uM="firestore.googleapis.com",X2=!0;class W2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ne(be.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=uM,this.ssl=X2}else this.host=e.host,this.ssl=e.ssl??X2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=FI;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<CF)throw new Ne(be.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}u8("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=cM(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Ne(be.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Ne(be.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Ne(be.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class j0{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new W2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ne(be.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ne(be.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new W2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new e8;switch(r.type){case"firstParty":return new i8(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Ne(be.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const r=Y2.get(n);r&&(Oe("ComponentProvider","Removing Datastore"),Y2.delete(n),r.terminate())})(this),Promise.resolve()}}function K7(t,e,n,r={}){t=Er(t,j0);const i=el(e),a=t._getSettings(),o={...a,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${n}`;i&&(Q1(`https://${c}`),Z1("Firestore",!0)),a.host!==uM&&a.host!==c&&Au("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...a,host:c,ssl:i,emulatorOptions:r};if(!Lo(u,o)&&(t._setSettings(u),r.mockUserToken)){let d,h;if(typeof r.mockUserToken=="string")d=r.mockUserToken,h=cr.MOCK_USER;else{d=P5(r.mockUserToken,t._app?.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new Ne(be.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new cr(p)}t._authCredentials=new t8(new eI(d,h))}}class js{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new js(this.firestore,e,this._query)}}class pn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Vo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new pn(this.firestore,e,this._key)}toJSON(){return{type:pn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(kh(n,pn._jsonSchema))return new pn(e,r||null,new qe(Yt.fromString(n.referencePath)))}}pn._jsonSchemaVersion="firestore/documentReference/1.0",pn._jsonSchema={type:jn("string",pn._jsonSchemaVersion),referencePath:jn("string")};class Vo extends js{constructor(e,n,r){super(e,n,A0(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new pn(this.firestore,null,new qe(e))}withConverter(e){return new Vo(this.firestore,e,this._path)}}function yr(t,e,...n){if(t=It(t),tI("collection","path",e),t instanceof j0){const r=Yt.fromString(e,...n);return l2(r),new Vo(t,null,r)}{if(!(t instanceof pn||t instanceof Vo))throw new Ne(be.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Yt.fromString(e,...n));return l2(r),new Vo(t.firestore,null,r)}}function yt(t,e,...n){if(t=It(t),arguments.length===1&&(e=vw.newId()),tI("doc","path",e),t instanceof j0){const r=Yt.fromString(e,...n);return o2(r),new pn(t,null,new qe(r))}{if(!(t instanceof pn||t instanceof Vo))throw new Ne(be.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Yt.fromString(e,...n));return o2(r),new pn(t.firestore,t instanceof Vo?t.converter:null,new qe(r))}}const K2="AsyncQueue";class Q2{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new qI(this,"async_queue_retry"),this._c=()=>{const r=kb();r&&Oe(K2,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=kb();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=kb();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new _s;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Qu(e))throw e;Oe(K2,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Ns("INTERNAL UNHANDLED ERROR: ",Z2(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=Pw.createAndSchedule(this,e,n,r,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&Je(47125,{Pc:Z2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,r)=>n.targetTimeMs-r.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Z2(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}function J2(t){return(function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const a of r)if(a in i&&typeof i[a]=="function")return!0;return!1})(t,["next","error","complete"])}class Ua extends j0{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Q2,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Q2(e),this._firestoreClient=void 0,await e}}}function Q7(t,e){const n=typeof t=="object"?t:p0(),r=typeof t=="string"?t:Dm,i=qu(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const a=IN("firestore");a&&K7(i,...a)}return i}function Mh(t){if(t._terminated)throw new Ne(be.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Z7(t),t._firestoreClient}function Z7(t){const e=t._freezeSettings(),n=(function(i,a,o,c){return new w8(i,a,o,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,cM(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new H7(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}})(t._componentsProvider))}class Si{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Si(ar.fromBase64String(e))}catch(n){throw new Ne(be.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Si(ar.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Si._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(kh(e,Si._jsonSchema))return Si.fromBase64String(e.bytes)}}Si._jsonSchemaVersion="firestore/bytes/1.0",Si._jsonSchema={type:jn("string",Si._jsonSchemaVersion),bytes:jn("string")};class Oh{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Ne(be.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new rr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class V0{constructor(e){this._methodName=e}}class Oa{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Ne(be.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Ne(be.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return xt(this._lat,e._lat)||xt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Oa._jsonSchemaVersion}}static fromJSON(e){if(kh(e,Oa._jsonSchema))return new Oa(e.latitude,e.longitude)}}Oa._jsonSchemaVersion="firestore/geoPoint/1.0",Oa._jsonSchema={type:jn("string",Oa._jsonSchemaVersion),latitude:jn("number"),longitude:jn("number")};class Pa{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Pa._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(kh(e,Pa._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new Pa(e.vectorValues);throw new Ne(be.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Pa._jsonSchemaVersion="firestore/vectorValue/1.0",Pa._jsonSchema={type:jn("string",Pa._jsonSchemaVersion),vectorValues:jn("object")};const J7=/^__.*__$/;class e${constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new rl(e,this.data,this.fieldMask,n,this.fieldTransforms):new Rh(e,this.data,n,this.fieldTransforms)}}class dM{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new rl(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function fM(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Je(40011,{Ac:t})}}class z0{constructor(e,n,r,i,a,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new z0({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){const n=this.path?.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Fm(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(fM(this.Ac)&&J7.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class t${constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||M0(e)}Cc(e,n,r,i=!1){return new z0({Ac:e,methodName:n,Dc:r,path:rr.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ph(t){const e=t._freezeSettings(),n=M0(t._databaseId);return new t$(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Gw(t,e,n,r,i,a={}){const o=t.Cc(a.merge||a.mergeFields?2:0,e,n,i);qw("Data must be an object, but it was:",o,r);const c=gM(r,o);let u,d;if(a.merge)u=new ri(o.fieldMask),d=o.fieldTransforms;else if(a.mergeFields){const h=[];for(const p of a.mergeFields){const m=Hx(e,p,n);if(!o.contains(m))throw new Ne(be.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);vM(h,m)||h.push(m)}u=new ri(h),d=o.fieldTransforms.filter((p=>u.covers(p.field)))}else u=null,d=o.fieldTransforms;return new e$(new Pr(c),u,d)}class jh extends V0{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof jh}}function n$(t,e,n){return new z0({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Hw extends V0{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=n$(this,e,!0),r=this.vc.map((a=>ed(a,n))),i=new Nu(r);return new Y8(e.path,i)}isEqual(e){return e instanceof Hw&&Lo(this.vc,e.vc)}}function hM(t,e,n,r){const i=t.Cc(1,e,n);qw("Data must be an object, but it was:",i,r);const a=[],o=Pr.empty();nl(r,((u,d)=>{const h=Yw(e,u,n);d=It(d);const p=i.yc(h);if(d instanceof jh)a.push(h);else{const m=ed(d,p);m!=null&&(a.push(h),o.set(h,m))}}));const c=new ri(a);return new dM(o,c,i.fieldTransforms)}function pM(t,e,n,r,i,a){const o=t.Cc(1,e,n),c=[Hx(e,r,n)],u=[i];if(a.length%2!=0)throw new Ne(be.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<a.length;m+=2)c.push(Hx(e,a[m])),u.push(a[m+1]);const d=[],h=Pr.empty();for(let m=c.length-1;m>=0;--m)if(!vM(d,c[m])){const b=c[m];let w=u[m];w=It(w);const E=o.yc(b);if(w instanceof jh)d.push(b);else{const S=ed(w,E);S!=null&&(d.push(b),h.set(b,S))}}const p=new ri(d);return new dM(h,p,o.fieldTransforms)}function r$(t,e,n,r=!1){return ed(n,t.Cc(r?4:3,e))}function ed(t,e){if(mM(t=It(t)))return qw("Unsupported field value:",e,t),gM(t,e);if(t instanceof V0)return(function(r,i){if(!fM(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(i);a&&i.fieldTransforms.push(a)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const a=[];let o=0;for(const c of r){let u=ed(c,i.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),o++}return{arrayValue:{values:a}}})(t,e)}return(function(r,i){if((r=It(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return G8(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=gt.fromDate(r);return{timestampValue:Vm(i.serializer,a)}}if(r instanceof gt){const a=new gt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Vm(i.serializer,a)}}if(r instanceof Oa)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Si)return{bytesValue:PI(i.serializer,r._byteString)};if(r instanceof pn){const a=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(a))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Aw(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Pa)return(function(o,c){return{mapValue:{fields:{[uI]:{stringValue:dI},[Im]:{arrayValue:{values:o.toArray().map((d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return Ew(c.serializer,d)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${_0(r)}`)})(t,e)}function gM(t,e){const n={};return iI(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):nl(t,((r,i)=>{const a=ed(i,e.mc(r));a!=null&&(n[r]=a)})),{mapValue:{fields:n}}}function mM(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof gt||t instanceof Oa||t instanceof Si||t instanceof pn||t instanceof V0||t instanceof Pa)}function qw(t,e,n){if(!mM(n)||!nI(n)){const r=_0(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function Hx(t,e,n){if((e=It(e))instanceof Oh)return e._internalPath;if(typeof e=="string")return Yw(t,e);throw Fm("Field path arguments must be of type string or ",t,!1,void 0,n)}const i$=new RegExp("[~\\*/\\[\\]]");function Yw(t,e,n){if(e.search(i$)>=0)throw Fm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Oh(...e.split("."))._internalPath}catch{throw Fm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Fm(t,e,n,r,i){const a=r&&!r.isEmpty(),o=i!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(a||o)&&(u+=" (found",a&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new Ne(be.INVALID_ARGUMENT,c+t+u)}function vM(t,e){return t.some((n=>n.isEqual(e)))}class yM{constructor(e,n,r,i,a){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new pn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new a$(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(L0("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class a$ extends yM{data(){return super.data()}}function L0(t,e){return typeof e=="string"?Yw(t,e):e instanceof Oh?e._internalPath:e._delegate._internalPath}function bM(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Ne(be.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Xw{}class Ww extends Xw{}function ta(t,e,...n){let r=[];e instanceof Xw&&r.push(e),r=r.concat(n),(function(a){const o=a.filter((u=>u instanceof Kw)).length,c=a.filter((u=>u instanceof B0)).length;if(o>1||o>0&&c>0)throw new Ne(be.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)t=i._apply(t);return t}class B0 extends Ww{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new B0(e,n,r)}_apply(e){const n=this._parse(e);return xM(e._query,n),new js(e.firestore,e.converter,Px(e._query,n))}_parse(e){const n=Ph(e.firestore);return(function(a,o,c,u,d,h,p){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Ne(be.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){nk(p,h);const w=[];for(const E of p)w.push(tk(u,a,E));m={arrayValue:{values:w}}}else m=tk(u,a,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||nk(p,h),m=r$(c,o,p,h==="in"||h==="not-in");return On.create(d,h,m)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function s$(t,e,n){const r=e,i=L0("where",t);return B0._create(i,r,n)}class Kw extends Xw{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Kw(e,n)}_parse(e){const n=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return n.length===1?n[0]:ea.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(i,a){let o=i;const c=a.getFlattenedFilters();for(const u of c)xM(o,u),o=Px(o,u)})(e._query,n),new js(e.firestore,e.converter,Px(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Qw extends Ww{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Qw(e,n)}_apply(e){const n=(function(i,a,o){if(i.startAt!==null)throw new Ne(be.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Ne(be.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new nh(a,o)})(e._query,this._field,this._direction);return new js(e.firestore,e.converter,(function(i,a){const o=i.explicitOrderBy.concat([a]);return new Zu(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,n))}}function Yo(t,e="asc"){const n=e,r=L0("orderBy",t);return Qw._create(r,n)}class Zw extends Ww{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Zw(e,n,r)}_apply(e){return new js(e.firestore,e.converter,Om(e._query,this._limit,this._limitType))}}function ek(t){return Zw._create("limit",t,"F")}function tk(t,e,n){if(typeof(n=It(n))=="string"){if(n==="")throw new Ne(be.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!bI(e)&&n.indexOf("/")!==-1)throw new Ne(be.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Yt.fromString(n));if(!qe.isDocumentKey(r))throw new Ne(be.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return m2(t,new qe(r))}if(n instanceof pn)return m2(t,n._key);throw new Ne(be.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${_0(n)}.`)}function nk(t,e){if(!Array.isArray(t)||t.length===0)throw new Ne(be.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function xM(t,e){const n=(function(i,a){for(const o of i)for(const c of o.getFlattenedFilters())if(a.indexOf(c.op)>=0)return c.op;return null})(t.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new Ne(be.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ne(be.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class o${convertValue(e,n="none"){switch(Go(e)){case 0:return null;case 1:return e.booleanValue;case 2:return xn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes($o(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Je(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return nl(e,((i,a)=>{r[i]=this.convertValue(a,n)})),r}convertVectorValue(e){const n=e.fields?.[Im].arrayValue?.values?.map((r=>xn(r.doubleValue)));return new Pa(n)}convertGeoPoint(e){return new Oa(xn(e.latitude),xn(e.longitude))}convertArray(e,n){return(e.values||[]).map((r=>this.convertValue(r,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const r=T0(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Jf(e));default:return null}}convertTimestamp(e){const n=Fo(e);return new gt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Yt.fromString(e);Ot(UI(r),9688,{name:e});const i=new eh(r.get(1),r.get(3)),a=new qe(r.popFirst(5));return i.isEqual(n)||Ns(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),a}}function Jw(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class wf{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Yl extends yM{constructor(e,n,r,i,a,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new om(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(L0("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ne(be.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Yl._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Yl._jsonSchemaVersion="firestore/documentSnapshot/1.0",Yl._jsonSchema={type:jn("string",Yl._jsonSchemaVersion),bundleSource:jn("string","DocumentSnapshot"),bundleName:jn("string"),bundle:jn("string")};class om extends Yl{data(e={}){return super.data(e)}}class Xl{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new wf(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((r=>{e.call(n,new om(this._firestore,this._userDataWriter,r.key,r,new wf(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Ne(be.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((c=>{const u=new om(i._firestore,i._userDataWriter,c.doc.key,c.doc,new wf(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((c=>a||c.type!==3)).map((c=>{const u=new om(i._firestore,i._userDataWriter,c.doc.key,c.doc,new wf(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),h=o.indexOf(c.doc.key)),{type:l$(c.type),doc:u,oldIndex:d,newIndex:h}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ne(be.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Xl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=vw.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(n.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function l$(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Je(61501,{type:t})}}function Nb(t){t=Er(t,pn);const e=Er(t.firestore,Ua);return X7(Mh(e),t._key).then((n=>wM(e,t,n)))}Xl._jsonSchemaVersion="firestore/querySnapshot/1.0",Xl._jsonSchema={type:jn("string",Xl._jsonSchemaVersion),bundleSource:jn("string","QuerySnapshot"),bundleName:jn("string"),bundle:jn("string")};class e_ extends o${constructor(e){super(),this.firestore=e}convertBytes(e){return new Si(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new pn(this.firestore,null,n)}}function qi(t){t=Er(t,js);const e=Er(t.firestore,Ua),n=Mh(e),r=new e_(e);return bM(t._query),W7(n,t._query).then((i=>new Xl(e,r,t,i)))}function ti(t,e,n){t=Er(t,pn);const r=Er(t.firestore,Ua),i=Jw(t.converter,e,n);return Vh(r,[Gw(Ph(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Sr.none())])}function Ca(t,e,n,...r){t=Er(t,pn);const i=Er(t.firestore,Ua),a=Ph(i);let o;return o=typeof(e=It(e))=="string"||e instanceof Oh?pM(a,"updateDoc",t._key,e,n,r):hM(a,"updateDoc",t._key,e),Vh(i,[o.toMutation(t._key,Sr.exists(!0))])}function Yi(t){return Vh(Er(t.firestore,Ua),[new D0(t._key,Sr.none())])}function U0(t,e){const n=Er(t.firestore,Ua),r=yt(t),i=Jw(t.converter,e);return Vh(n,[Gw(Ph(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Sr.exists(!1))]).then((()=>r))}function td(t,...e){t=It(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||J2(e[r])||(n=e[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(J2(e[r])){const u=e[r];e[r]=u.next?.bind(u),e[r+1]=u.error?.bind(u),e[r+2]=u.complete?.bind(u)}let a,o,c;if(t instanceof pn)o=Er(t.firestore,Ua),c=A0(t._key.path),a={next:u=>{e[r]&&e[r](wM(o,t,u))},error:e[r+1],complete:e[r+2]};else{const u=Er(t,js);o=Er(u.firestore,Ua),c=u._query;const d=new e_(o);a={next:h=>{e[r]&&e[r](new Xl(o,d,u,h))},error:e[r+1],complete:e[r+2]},bM(t._query)}return(function(d,h,p,m){const b=new $w(m),w=new Bw(h,b,p);return d.asyncQueue.enqueueAndForget((async()=>Vw(await Um(d),w))),()=>{b.Nu(),d.asyncQueue.enqueueAndForget((async()=>zw(await Um(d),w)))}})(Mh(o),c,i,a)}function Vh(t,e){return(function(r,i){const a=new _s;return r.asyncQueue.enqueueAndForget((async()=>j7(await Y7(r),i,a))),a.promise})(Mh(t),e)}function wM(t,e,n){const r=n.docs.get(e._key),i=new e_(t);return new Yl(t,i,e._key,r,new wf(n.hasPendingWrites,n.fromCache),e.converter)}class c${constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Ph(e)}set(e,n,r){this._verifyNotCommitted();const i=Db(e,this._firestore),a=Jw(i.converter,n,r),o=Gw(this._dataReader,"WriteBatch.set",i._key,a,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Sr.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const a=Db(e,this._firestore);let o;return o=typeof(n=It(n))=="string"||n instanceof Oh?pM(this._dataReader,"WriteBatch.update",a._key,n,r,i):hM(this._dataReader,"WriteBatch.update",a._key,n),this._mutations.push(o.toMutation(a._key,Sr.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Db(e,this._firestore);return this._mutations=this._mutations.concat(new D0(n._key,Sr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ne(be.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Db(t,e){if((t=It(t)).firestore!==e)throw new Ne(be.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function rk(){return new jh("deleteField")}function u$(...t){return new Hw("arrayUnion",t)}function qx(t){return Mh(t=Er(t,Ua)),new c$(t,(e=>Vh(t,e)))}(function(e,n=!0){(function(i){Wu=i})(Yu),Cs(new La("firestore",((r,{instanceIdentifier:i,options:a})=>{const o=r.getProvider("app").getImmediate(),c=new Ua(new n8(r.getProvider("auth-internal")),new a8(o,r.getProvider("app-check-internal")),(function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Ne(be.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new eh(d.options.projectId,h)})(o,i),o);return a={useFetchStreams:n,...a},c._setSettings(a),c}),"PUBLIC").setMultipleInstances(!0)),Wi(r2,i2,e),Wi(r2,i2,"esm2020")})();const Yx=new Map,_M={activated:!1,tokenObservers:[]},d$={initialized:!1,enabled:!1};function Gn(t){return Yx.get(t)||{..._M}}function f$(t,e){return Yx.set(t,e),Yx.get(t)}function F0(){return d$}const EM="https://content-firebaseappcheck.googleapis.com/v1",h$="exchangeRecaptchaEnterpriseToken",p$="exchangeDebugToken",ik={RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:960*1e3},g$=1440*60*1e3;class m${constructor(e,n,r,i,a){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new Gf,this.pending.promise.catch(n=>{}),await v$(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new Gf,this.pending.promise.catch(n=>{}),await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}}function v$(t){return new Promise(e=>{setTimeout(e,t)})}const y$={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},jr=new Hu("appCheck","AppCheck",y$);function ak(t=!1){return t?self.grecaptcha?.enterprise:self.grecaptcha}function t_(t){if(!Gn(t).activated)throw jr.create("use-before-activation",{appName:t.name})}function SM(t){const e=Math.round(t/1e3),n=Math.floor(e/(3600*24)),r=Math.floor((e-n*3600*24)/3600),i=Math.floor((e-n*3600*24-r*3600)/60),a=e-n*3600*24-r*3600-i*60;let o="";return n&&(o+=Rg(n)+"d:"),r&&(o+=Rg(r)+"h:"),o+=Rg(i)+"m:"+Rg(a)+"s",o}function Rg(t){return t===0?"00":t>=10?t.toString():"0"+t}async function n_({url:t,body:e},n){const r={"Content-Type":"application/json"},i=n.getImmediate({optional:!0});if(i){const p=await i.getHeartbeatsHeader();p&&(r["X-Firebase-Client"]=p)}const a={method:"POST",body:JSON.stringify(e),headers:r};let o;try{o=await fetch(t,a)}catch(p){throw jr.create("fetch-network-error",{originalErrorMessage:p?.message})}if(o.status!==200)throw jr.create("fetch-status-error",{httpStatus:o.status});let c;try{c=await o.json()}catch(p){throw jr.create("fetch-parse-error",{originalErrorMessage:p?.message})}const u=c.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw jr.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});const d=Number(u[1])*1e3,h=Date.now();return{token:c.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}}function b$(t,e){const{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${EM}/projects/${n}/apps/${r}:${h$}?key=${i}`,body:{recaptcha_enterprise_token:e}}}function TM(t,e){const{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${EM}/projects/${n}/apps/${r}:${p$}?key=${i}`,body:{debug_token:e}}}const x$="firebase-app-check-database",w$=1,ih="firebase-app-check-store",AM="debug-token";let Ng=null;function CM(){return Ng||(Ng=new Promise((t,e)=>{try{const n=indexedDB.open(x$,w$);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{e(jr.create("storage-open",{originalErrorMessage:r.target.error?.message}))},n.onupgradeneeded=r=>{const i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(ih,{keyPath:"compositeKey"})}}}catch(n){e(jr.create("storage-open",{originalErrorMessage:n?.message}))}}),Ng)}function _$(t){return RM(NM(t))}function E$(t,e){return kM(NM(t),e)}function S$(t){return kM(AM,t)}function T$(){return RM(AM)}async function kM(t,e){const r=(await CM()).transaction(ih,"readwrite"),a=r.objectStore(ih).put({compositeKey:t,value:e});return new Promise((o,c)=>{a.onsuccess=u=>{o()},r.onerror=u=>{c(jr.create("storage-set",{originalErrorMessage:u.target.error?.message}))}})}async function RM(t){const n=(await CM()).transaction(ih,"readonly"),i=n.objectStore(ih).get(t);return new Promise((a,o)=>{i.onsuccess=c=>{const u=c.target.result;a(u?u.value:void 0)},n.onerror=c=>{o(jr.create("storage-get",{originalErrorMessage:c.target.error?.message}))}})}function NM(t){return`${t.options.appId}-${t.name}`}const ko=new h0("@firebase/app-check");async function A$(t){if(J1()){let e;try{e=await _$(t)}catch(n){ko.warn(`Failed to read token from IndexedDB. Error: ${n}`)}return e}}function Ib(t,e){return J1()?E$(t,e).catch(n=>{ko.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}async function C$(){let t;try{t=await T$()}catch{}if(t)return t;{const e=crypto.randomUUID();return S$(e).catch(n=>ko.warn(`Failed to persist debug token to IndexedDB. Error: ${n}`)),e}}function r_(){return F0().enabled}async function i_(){const t=F0();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}function k$(){const t=NN(),e=F0();if(e.initialized=!0,typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN!="string"&&t.FIREBASE_APPCHECK_DEBUG_TOKEN!==!0)return;e.enabled=!0;const n=new Gf;e.token=n,typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN=="string"?n.resolve(t.FIREBASE_APPCHECK_DEBUG_TOKEN):n.resolve(C$())}const R$={error:"UNKNOWN_ERROR"};function N$(t){return K1.encodeString(JSON.stringify(t),!1)}async function Xx(t,e=!1,n=!1){const r=t.app;t_(r);const i=Gn(r);let a=i.token,o;if(a&&!su(a)&&(i.token=void 0,a=void 0),!a){const d=await i.cachedTokenPromise;d&&(su(d)?a=d:await Ib(r,void 0))}if(!e&&a&&su(a))return{token:a.token};let c=!1;if(r_())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=n_(TM(r,await i_()),t.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),c=!0);const d=await i.exchangeTokenPromise;return await Ib(r,d),i.token=d,{token:d.token}}catch(d){return d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?ko.warn(d.message):n&&ko.error(d),Mb(d)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),c=!0),a=await Gn(r).exchangeTokenPromise}catch(d){d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?ko.warn(d.message):n&&ko.error(d),o=d}let u;return a?o?su(a)?u={token:a.token,internalError:o}:u=Mb(o):(u={token:a.token},i.token=a,await Ib(r,a)):u=Mb(o),c&&MM(r,u),u}async function D$(t){const e=t.app;t_(e);const{provider:n}=Gn(e);if(r_()){const r=await i_(),{token:i}=await n_(TM(e,r),t.heartbeatServiceProvider);return{token:i}}else{const{token:r}=await n.getToken();return{token:r}}}function DM(t,e,n,r){const{app:i}=t,a=Gn(i),o={next:n,error:r,type:e};if(a.tokenObservers=[...a.tokenObservers,o],a.token&&su(a.token)){const c=a.token;Promise.resolve().then(()=>{n({token:c.token}),sk(t)}).catch(()=>{})}a.cachedTokenPromise.then(()=>sk(t))}function IM(t,e){const n=Gn(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function sk(t){const{app:e}=t,n=Gn(e);let r=n.tokenRefresher;r||(r=I$(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function I$(t){const{app:e}=t;return new m$(async()=>{const n=Gn(e);let r;if(n.token?r=await Xx(t,!0):r=await Xx(t),r.error)throw r.error;if(r.internalError)throw r.internalError},()=>!0,()=>{const n=Gn(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5;const i=n.token.expireTimeMillis-300*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},ik.RETRIAL_MIN_WAIT,ik.RETRIAL_MAX_WAIT)}function MM(t,e){const n=Gn(t).tokenObservers;for(const r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function su(t){return t.expireTimeMillis-Date.now()>0}function Mb(t){return{token:N$(R$),error:t}}class M${constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){const{tokenObservers:e}=Gn(this.app);for(const n of e)IM(this.app,n.next);return Promise.resolve()}}function O$(t,e){return new M$(t,e)}function P$(t){return{getToken:e=>Xx(t,e),getLimitedUseToken:()=>D$(t),addTokenListener:e=>DM(t,"INTERNAL",e),removeTokenListener:e=>IM(t.app,e)}}const j$="@firebase/app-check",V$="0.11.0",z$="https://www.google.com/recaptcha/enterprise.js";function L$(t,e){const n=new Gf,r=Gn(t);r.reCAPTCHAState={initialized:n};const i=B$(t),a=ak(!0);return a?ok(t,e,a,i,n):$$(()=>{const o=ak(!0);if(!o)throw new Error("no recaptcha");ok(t,e,o,i,n)}),n.promise}function ok(t,e,n,r,i){n.ready(()=>{F$(t,e,n,r),i.resolve(n)})}function B$(t){const e=`fire_app_check_${t.name}`,n=document.createElement("div");return n.id=e,n.style.display="none",document.body.appendChild(n),e}async function U$(t){t_(t);const n=await Gn(t).reCAPTCHAState.initialized.promise;return new Promise((r,i)=>{const a=Gn(t).reCAPTCHAState;n.ready(()=>{r(n.execute(a.widgetId,{action:"fire_app_check"}))})})}function F$(t,e,n,r){const i=n.render(r,{sitekey:e,size:"invisible",callback:()=>{Gn(t).reCAPTCHAState.succeeded=!0},"error-callback":()=>{Gn(t).reCAPTCHAState.succeeded=!1}}),a=Gn(t);a.reCAPTCHAState={...a.reCAPTCHAState,widgetId:i}}function $$(t){const e=document.createElement("script");e.src=z$,e.onload=t,document.head.appendChild(e)}class a_{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){H$(this._throttleData);const e=await U$(this._app).catch(r=>{throw jr.create("recaptcha-error")});if(!Gn(this._app).reCAPTCHAState?.succeeded)throw jr.create("recaptcha-error");let n;try{n=await n_(b$(this._app,e),this._heartbeatServiceProvider)}catch(r){throw r.code?.includes("fetch-status-error")?(this._throttleData=G$(Number(r.customData?.httpStatus),this._throttleData),jr.create("initial-throttle",{time:SM(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):r}return this._throttleData=null,n}initialize(e){this._app=e,this._heartbeatServiceProvider=qu(e,"heartbeat"),L$(e,this._siteKey).catch(()=>{})}isEqual(e){return e instanceof a_?this._siteKey===e._siteKey:!1}}function G$(t,e){if(t===404||t===403)return{backoffCount:1,allowRequestsAfter:Date.now()+g$,httpStatus:t};{const n=e?e.backoffCount:0,r=rV(n,1e3,2);return{backoffCount:n+1,allowRequestsAfter:Date.now()+r,httpStatus:t}}}function H$(t){if(t&&Date.now()-t.allowRequestsAfter<=0)throw jr.create("throttled",{time:SM(t.allowRequestsAfter-Date.now()),httpStatus:t.httpStatus})}function q$(t=p0(),e){t=It(t);const n=qu(t,"app-check");if(F0().initialized||k$(),r_()&&i_().then(i=>console.log(`App Check debug token: ${i}. You will need to add it to your app's App Check settings in the Firebase console for it to work.`)),n.isInitialized()){const i=n.getImmediate(),a=n.getOptions();if(a.isTokenAutoRefreshEnabled===e.isTokenAutoRefreshEnabled&&a.provider.isEqual(e.provider))return i;throw jr.create("already-initialized",{appName:t.name})}const r=n.initialize({options:e});return Y$(t,e.provider,e.isTokenAutoRefreshEnabled),Gn(t).isTokenAutoRefreshEnabled&&DM(r,"INTERNAL",()=>{}),r}function Y$(t,e,n=!1){const r=f$(t,{..._M});r.activated=!0,r.provider=e,r.cachedTokenPromise=A$(t).then(i=>(i&&su(i)&&(r.token=i,MM(t,{token:i.token})),i)),r.isTokenAutoRefreshEnabled=n&&t.automaticDataCollectionEnabled,!t.automaticDataCollectionEnabled&&n&&ko.warn("`isTokenAutoRefreshEnabled` is true but `automaticDataCollectionEnabled` was set to false during `initializeApp()`. This blocks automatic token refresh."),r.provider.initialize(t)}const X$="app-check",lk="app-check-internal";function W$(){Cs(new La(X$,t=>{const e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return O$(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(lk).initialize()})),Cs(new La(lk,t=>{const e=t.getProvider("app-check").getImmediate();return P$(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Wi(j$,V$)}W$();const K$={apiKey:"AIzaSyCRHcpbVGQrEZUVdO_Ucn4ZarwwPsrON40",authDomain:"personal-budget-pwa-5defb.firebaseapp.com",projectId:"personal-budget-pwa-5defb",storageBucket:"personal-budget-pwa-5defb.firebasestorage.app",messagingSenderId:"137454342284",appId:"1:137454342284:web:0ae73943f9058a4342aba9",measurementId:"G-VMP5DF6273"},s_=VN(K$);q$(s_,{provider:new a_("6Lf31GMsAAAAAHqILQS1jVjTe51WHK6lfIyxmsFT"),isTokenAutoRefreshEnabled:!0});const wi=PL(s_),Ke=Q7(s_),ck=()=>({url:window.location.origin+"/personal-budget-pwa/",handleCodeInApp:!1}),Dg=t=>({id:t.uid,username:t.email||t.uid,displayName:t.displayName||t.email?.split("@")[0]||"User",email:t.email||void 0}),Ai=gw()(qD(t=>({currentUser:null,isAuthenticated:!1,loginError:null,isLoading:!1,isInitialized:!1,isInitializing:!0,lastAuthTime:null,offlineGracePeriod:10080*60*1e3,lastVerificationEmailSent:null,login:async(e,n)=>{t({isLoading:!0,loginError:null});try{const i=(await yz(wi,e,n)).user;if(console.log(` Checking email verification for: ${i.email}`),console.log(" emailVerified status:",i.emailVerified),console.log(" Firebase user object:",{uid:i.uid,email:i.email,emailVerified:i.emailVerified,metadata:i.metadata}),!i.emailVerified)return console.log(` BLOCKING LOGIN: Email not verified for ${i.email}`),await NC(wi),t({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:"Please verify your email address before signing in. Check your email for a verification link."}),console.log(` Login blocked: ${i.email} not verified`),!1;console.log(` EMAIL VERIFIED: Allowing login for ${i.email}`);const a=Dg(i);return t({currentUser:a,isAuthenticated:!0,isLoading:!1,loginError:null,lastAuthTime:Date.now()}),console.log(` User logged in: ${a.email}`),!0}catch(r){console.error("Login error:",r),console.error("Error code:",r.code),console.error("Error message:",r.message);let i="Login failed. Please try again.";if(r.code)switch(r.code){case"auth/invalid-email":i="Invalid email address.";break;case"auth/user-disabled":i="This account has been disabled.";break;case"auth/user-not-found":i="No account found with this email.";break;case"auth/wrong-password":i="Incorrect password.";break;case"auth/too-many-requests":i="Too many failed attempts. Please try again later.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break;case"auth/invalid-credential":i="Invalid email or password.";break;default:console.warn(`Unhandled Firebase error code: ${r.code}`),i="Authentication failed. Please try again.";break}else console.warn("Non-Firebase error in login:",r),i="An unexpected error occurred. Please try again.";return t({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:i}),!1}},register:async(e,n,r)=>{t({isLoading:!0,loginError:null});try{const a=(await vz(wi,e,n)).user;await xz(a,{displayName:r}),await RC(a,ck());const o=Dg(a);return t({currentUser:o,isAuthenticated:!1,isLoading:!1,loginError:null,lastVerificationEmailSent:Date.now()}),console.log(` User registered: ${o.email}, verification email sent`),!0}catch(i){console.error("Registration error:",i);let a="Registration failed. Please try again.";switch(i.code){case"auth/email-already-in-use":a="An account with this email already exists.";break;case"auth/invalid-email":a="Invalid email address.";break;case"auth/weak-password":a="Password should be at least 6 characters.";break;case"auth/operation-not-allowed":a="Email/password accounts are not enabled.";break}return t({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:a}),!1}},logout:async()=>{try{await NC(wi),console.log(" User logged out")}catch(e){console.error("Logout error:",e)}},clearError:()=>{t({loginError:null})},sendPasswordReset:async e=>{t({isLoading:!0,loginError:null});try{return await pz(wi,e),t({isLoading:!1}),!0}catch(n){console.error("Password reset error:",n);let r="Failed to send password reset email. Please try again.";switch(n.code){case"auth/user-not-found":r="No account found with this email.";break;case"auth/invalid-email":r="Invalid email address.";break;case"auth/too-many-requests":r="Too many attempts. Please try again later.";break}return t({isLoading:!1,loginError:r}),!1}},sendEmailVerification:async()=>{const e=wi.currentUser;if(!e)return t({loginError:"No user is currently signed in."}),!1;t({isLoading:!0,loginError:null});try{return await RC(e,ck()),t({isLoading:!1,lastVerificationEmailSent:Date.now()}),console.log(` Verification email sent to: ${e.email}`),!0}catch(n){console.error("Email verification error:",n);let r="Failed to send verification email. Please try again.";switch(n.code){case"auth/too-many-requests":r="Too many verification emails sent. Please wait before trying again.";break}return t({isLoading:!1,loginError:r}),!1}},resendEmailVerification:async()=>{const e=Ai.getState();if(e.lastVerificationEmailSent){const n=Date.now()-e.lastVerificationEmailSent,r=60*1e3;if(n<r){const i=Math.ceil((r-n)/1e3);return t({loginError:`Please wait ${i} seconds before requesting another verification email.`}),!1}}return e.sendEmailVerification()},checkVerificationStatus:async()=>{const e=wi.currentUser;if(!e)return!1;try{await e.reload();const n=wi.currentUser;if(n?.emailVerified){const r=Dg(n);return t({currentUser:r,isAuthenticated:!0,lastAuthTime:Date.now()}),console.log(` Email verified for: ${n.email}`),!0}return!1}catch(n){return console.error("Error checking verification status:",n),!1}},deleteAccount:async e=>{const n=wi.currentUser;if(!n||!n.email)return t({loginError:"No user is currently signed in."}),!1;t({isLoading:!0,loginError:null});try{const r=ac.credential(n.email,e);return await fz(n,r),await Sz(n),t({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:null,lastAuthTime:null}),console.log(` Account permanently deleted: ${n.email}`),!0}catch(r){console.error("Account deletion error:",r);let i="Failed to delete account. Please try again.";switch(r.code){case"auth/requires-recent-login":i="For security, please log out and log back in before deleting your account.";break;case"auth/wrong-password":i="Incorrect password. Please enter your current password.";break;case"auth/too-many-requests":i="Too many deletion attempts. Please wait before trying again.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break}return t({isLoading:!1,loginError:i}),!1}},confirmPasswordReset:async(e,n)=>{t({isLoading:!0,loginError:null});try{return await gz(wi,e,n),t({isLoading:!1}),console.log(" Password reset successful"),!0}catch(r){console.error("Password reset confirmation error:",r);let i="Failed to reset password. The link may be expired or invalid.";switch(r.code){case"auth/expired-action-code":i="The password reset link has expired. Please request a new one.";break;case"auth/invalid-action-code":i="The password reset link is invalid. Please request a new one.";break;case"auth/weak-password":i="Password should be at least 6 characters.";break}return t({isLoading:!1,loginError:i}),!1}},initializeAuth:()=>Ai.getState().isInitialized?()=>{}:(t({isInitialized:!1}),Ez(wi,async r=>{const i=Date.now(),a=Ai.getState(),o=r?Dg(r):null,c=a.lastAuthTime&&i-a.lastAuthTime<a.offlineGracePeriod,d=typeof navigator<"u"&&!navigator.onLine&&a.isAuthenticated&&c&&!o,h=r?r.emailVerified:!0,p=r&&h||!!d,m=r?o:d?a.currentUser:null;if(t({currentUser:m,isAuthenticated:p,isInitialized:!0,isLoading:!1,loginError:null,lastAuthTime:r&&h?i:a.lastAuthTime}),m)if(console.log(` Auth state: User is signed in (${m.email})`,d?"(offline grace period)":h?"(verified)":"(unverified)"),console.log(" Onboarding check:",{isVerified:h,shouldGrantOfflineAccess:d,willCheckOnboarding:h&&!d}),h&&!d){console.log(" Loading budgetStore to check onboarding...");const b=await Tt(()=>Promise.resolve().then(()=>gJ),[]).then(w=>w.useBudgetStore.getState());console.log(" Calling budgetStore.checkAndStartOnboarding()..."),await b.checkAndStartOnboarding()}else console.log(" Skipping onboarding check (not verified or offline grace period)");else console.log(" Auth state: User is signed out")}))}),{name:"auth-storage",partialize:t=>({isAuthenticated:t.isAuthenticated,currentUser:t.currentUser,lastAuthTime:t.lastAuthTime,offlineGracePeriod:t.offlineGracePeriod,lastVerificationEmailSent:t.lastVerificationEmailSent})})),zt=Object.freeze(Object.defineProperty({__proto__:null,useAuthStore:Ai},Symbol.toStringTag,{value:"Module"})),OM=[{id:"length",label:"Minimum 12 characters",regex:/^.{12,}$/},{id:"uppercase",label:"At least one uppercase letter (A-Z)",regex:/[A-Z]/},{id:"lowercase",label:"At least one lowercase letter (a-z)",regex:/[a-z]/},{id:"number",label:"At least one number (0-9)",regex:/\d/},{id:"special",label:"At least one special character (!@#$%^&*)",regex:/[!@#$%^&*]/}],Q$=t=>{if(!t)return{score:0,level:"weak",color:"text-gray-400",label:"Enter password"};const r=OM.map(c=>({...c,met:c.regex.test(t)})).filter(c=>c.met).length;let i,a,o;return r<=1?(i="weak",a="text-red-500",o="Weak"):r<=3?(i="medium",a="text-yellow-500",o="Medium"):r===4?(i="strong",a="text-blue-500",o="Strong"):(i="very-strong",a="text-green-500",o="Very Strong"),{score:r,level:i,color:a,label:o}},$0=t=>{const e=OM.map(i=>({...i,met:i.regex.test(t)})),n=Q$(t),r=e.every(i=>i.met);return{requirements:e,strength:n,isValid:r,isEmpty:!t.trim()}},PM=({password:t,className:e=""})=>{const{strength:n,isEmpty:r}=$0(t);return r?null:v.jsxs("div",{className:`flex items-center gap-2 ${e}`,children:[v.jsx("div",{className:"flex-1",children:v.jsx("div",{className:"flex gap-1",children:[1,2,3,4].map(i=>v.jsx("div",{className:`h-1 flex-1 rounded-full ${i<=n.score?n.score<=1?"bg-red-500":n.score<=3?"bg-yellow-500":n.score===4?"bg-blue-500":"bg-green-500":"bg-gray-200 dark:bg-gray-700"}`},i))})}),v.jsx("span",{className:`text-sm font-medium ${n.color}`,children:n.label})]})},jM=({password:t,className:e=""})=>{const{requirements:n,isEmpty:r}=$0(t);return r?null:v.jsx("div",{className:`space-y-1 ${e}`,children:n.map(i=>v.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.met?v.jsx(IB,{className:"h-4 w-4 text-green-500 flex-shrink-0"}):v.jsx(w0,{className:"h-4 w-4 text-red-500 flex-shrink-0"}),v.jsx("span",{className:i.met?"text-green-700 dark:text-green-300":"text-gray-600 dark:text-gray-400",children:i.label})]},i.id))})},Z$=()=>{const[t,e]=B.useState(""),[n,r]=B.useState(""),[i,a]=B.useState(""),[o,c]=B.useState(!1),[u,d]=B.useState(!1),[h,p]=B.useState(!1),[m,b]=B.useState(!1),{login:w,register:E,sendPasswordReset:S,isLoading:T,loginError:C,clearError:N}=Ai(),j=$0(n),P=async A=>{if(A.preventDefault(),N(),t.trim()&&n.trim())if(u){if(!i.trim()||!j.isValid)return;await E(t.trim(),n,i.trim())}else await w(t.trim(),n)},M=async A=>{A.preventDefault(),t.trim()&&await S(t.trim())&&b(!0)};return B.useEffect(()=>{e(""),r(""),a(""),b(!1)},[u,h]),v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsxs("div",{className:"flex flex-col items-center gap-3 mb-2",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"Personal Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"Personal Budget"})]}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Simple envelope budgeting for personal finance"})]})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:h?v.jsxs("form",{onSubmit:M,className:"space-y-6",children:[v.jsxs("div",{className:"text-center mb-2",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Reset Password"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Enter your email and we'll send you a link to reset your password."})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"reset-email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(Cx,{className:"h-5 w-5 text-gray-400"})}),v.jsx("input",{id:"reset-email",type:"email",value:t,onChange:A=>e(A.target.value),className:"w-full pl-10 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"email"})]})]}),m?v.jsxs("div",{className:"text-center py-4",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 dark:bg-green-900/30",children:v.jsx(Cx,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),v.jsx("h3",{className:"mt-3 text-lg font-medium text-gray-900 dark:text-white",children:"Check your email"}),v.jsxs("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:["We've sent a password reset link to ",v.jsx("span",{className:"font-medium",children:t})]}),v.jsxs("button",{type:"button",onClick:()=>p(!1),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[v.jsx(Bo,{className:"-ml-1 mr-2 h-4 w-4"}),"Back to login"]})]}):v.jsxs(v.Fragment,{children:[v.jsx("button",{type:"submit",disabled:T||!t.trim(),className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?"Sending...":"Send Reset Link"}),v.jsx("div",{className:"mt-4 text-center",children:v.jsxs("button",{type:"button",onClick:()=>p(!1),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:[v.jsx(Bo,{className:"inline-block h-4 w-4 -ml-1 mr-1"}),"Back to login"]})})]})]}):v.jsxs("form",{onSubmit:P,className:"space-y-6",children:[v.jsxs("div",{className:"text-center mb-6",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:u?"Create Account":"Sign In"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:u?"Create a new account to get started":"Sign in to your account"})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),v.jsx("input",{id:"email",type:"email",value:t,onChange:A=>e(A.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"username"})]}),u&&v.jsxs("div",{children:[v.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Display Name"}),v.jsx("input",{id:"displayName",type:"text",value:i,onChange:A=>a(A.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your display name",required:!0,disabled:T})]}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"}),!u&&v.jsx("button",{type:"button",onClick:()=>p(!0),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:"Forgot password?"})]}),v.jsxs("div",{className:"relative",children:[v.jsx("input",{id:"password",type:o?"text":"password",value:n,onChange:A=>r(A.target.value),className:`w-full px-3 py-2 pr-10 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white ${u&&n&&!j.isValid?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"Enter your password",required:!0,disabled:T,autoComplete:u?"new-password":"current-password"}),v.jsx("button",{type:"button",onClick:()=>c(!o),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none",disabled:T,children:o?v.jsx($D,{className:"h-5 w-5"}):v.jsx(GD,{className:"h-5 w-5"})})]}),u&&n&&v.jsx("div",{className:"mt-2",children:v.jsx(PM,{password:n})}),u&&n&&v.jsx("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-md",children:v.jsx(jM,{password:n})})]}),C&&v.jsxs("div",{className:"text-red-600 dark:text-red-400 text-sm text-center bg-red-50 dark:bg-red-900/20 p-3 rounded-md",children:[C,C.includes("verify your email")&&v.jsx("div",{className:"mt-3",children:v.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Please check your email and click the verification link to continue."})})]}),v.jsx("button",{type:"submit",disabled:T||!t.trim()||!n.trim()||u&&!i.trim()||u&&!j.isValid,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?u?"Creating Account...":"Signing in...":u?"Create Account":"Sign In"}),v.jsx("div",{className:"mt-6 text-center",children:v.jsxs("button",{type:"button",onClick:()=>{d(!u),p(!1)},className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",disabled:T,children:[v.jsx(LU,{className:"h-4 w-4"}),u?"Already have an account? Sign In":"Don't have an account? Sign Up"]})})]})})]})})},J$=({oobCode:t,onSuccess:e,onCancel:n})=>{const[r,i]=B.useState(""),[a,o]=B.useState(""),[c,u]=B.useState(!1),[d,h]=B.useState(!1),{confirmPasswordReset:p,isLoading:m,loginError:b,clearError:w}=Ai(),E=$0(r);B.useEffect(()=>{w()},[w]);const S=async T=>{if(T.preventDefault(),r!==a||!E.isValid)return;await p(t,r)&&h(!0)};return d?v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-md p-8 text-center",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/30 mb-6",children:v.jsx(Cm,{className:"h-10 w-10 text-green-600 dark:text-green-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Password Reset Complete"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"Your password has been successfully updated. You can now log in with your new password."}),v.jsx("button",{onClick:e,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200",children:"Go to Login"})]})}):v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsxs("div",{className:"flex flex-col items-center gap-3 mb-2",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"Personal Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:"Reset Password"})]}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Create a new password for your account"})]})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:v.jsxs("form",{onSubmit:S,className:"space-y-6",children:[v.jsxs("div",{children:[v.jsx("label",{htmlFor:"new-password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"New Password"}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(QC,{className:"h-5 w-5 text-gray-400"})}),v.jsx("input",{id:"new-password",type:c?"text":"password",value:r,onChange:T=>i(T.target.value),className:"w-full pl-10 pr-10 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white transition-colors",placeholder:"Enter new password",required:!0}),v.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-200",onClick:()=>u(!c),children:c?v.jsx($D,{className:"h-5 w-5"}):v.jsx(GD,{className:"h-5 w-5"})})]}),v.jsx("div",{className:"mt-2",children:v.jsx(PM,{password:r})})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Confirm New Password"}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(QC,{className:"h-5 w-5 text-gray-400"})}),v.jsx("input",{id:"confirm-password",type:c?"text":"password",value:a,onChange:T=>o(T.target.value),className:`w-full pl-10 px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white transition-colors ${a&&r!==a?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"Confirm new password",required:!0})]}),a&&r!==a&&v.jsx("p",{className:"mt-1 text-sm text-red-500",children:"Passwords do not match"})]}),v.jsx(jM,{password:r}),b&&v.jsx("div",{className:"p-3 rounded-md bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-400 text-sm",children:b}),v.jsx("button",{type:"submit",disabled:m||!r||!a||r!==a||!E.isValid,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:m?"Updating Password...":"Reset Password"}),v.jsx("div",{className:"text-center",children:v.jsxs("button",{type:"button",onClick:n,className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium inline-flex items-center",children:[v.jsx(Bo,{className:"h-4 w-4 mr-1"}),"Back to Login"]})})]})})]})})},VM=()=>{const[t,e]=B.useState(!1),[n,r]=B.useState(!1),{currentUser:i,resendEmailVerification:a,checkVerificationStatus:o,logout:c,loginError:u}=Ai();B.useEffect(()=>{i||console.warn("EmailVerificationView: No current user, this should not happen")},[i]),B.useEffect(()=>{const p=()=>{console.log("Window focused, checking verification status..."),o()};return window.addEventListener("focus",p),()=>window.removeEventListener("focus",p)},[o]);const d=async()=>{e(!0),r(!1);const p=await a();e(!1),p&&(r(!0),setTimeout(()=>r(!1),3e3))},h=async()=>{await c()};return i?v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsx("div",{className:"flex flex-col items-center gap-3 mb-2",children:v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"House Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"House Budget"})]})})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/30 mb-4",children:v.jsx(Cx,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Check your email"}),v.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["We've sent a verification link to"," ",v.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:i.email})]}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 mb-6",children:v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(Cm,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),v.jsxs("div",{className:"text-left",children:[v.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium",children:"What to do next:"}),v.jsxs("ol",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1 space-y-1",children:[v.jsx("li",{children:"1. Open your email inbox"}),v.jsx("li",{children:"2. Find the email from House Budget"}),v.jsx("li",{children:'3. Click the "Verify Email" link'}),v.jsx("li",{children:"4. Return here and sign in"})]})]})]})}),u&&v.jsx("div",{className:"text-red-600 dark:text-red-400 text-sm mb-4 p-3 bg-red-50 dark:bg-red-900/20 rounded-md",children:u}),n&&v.jsx("div",{className:"text-green-600 dark:text-green-400 text-sm mb-4 p-3 bg-green-50 dark:bg-green-900/20 rounded-md",children:"Verification email sent successfully!"}),v.jsx("button",{onClick:d,disabled:t,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed mb-4 flex items-center justify-center gap-2",children:t?v.jsxs(v.Fragment,{children:[v.jsx(Wf,{className:"h-4 w-4 animate-spin"}),"Sending..."]}):v.jsxs(v.Fragment,{children:[v.jsx(Wf,{className:"h-4 w-4"}),"Resend verification email"]})}),v.jsxs("button",{onClick:h,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",children:[v.jsx(Bo,{className:"h-4 w-4"}),"Back to sign in"]})]})}),v.jsx("div",{className:"text-center",children:v.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Didn't receive the email? Check your spam folder or try resending."})})]})}):null},zM=({message:t="Loading your budget...",showTimeout:e=!1})=>v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex flex-col items-center justify-center px-4",children:[v.jsx("div",{className:"mb-8",children:v.jsxs("div",{className:"relative",children:[v.jsx(Wf,{size:48,className:"text-blue-500 animate-spin"}),v.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:v.jsx(x0,{size:24,className:"text-blue-600 dark:text-blue-400"})})]})}),v.jsxs("div",{className:"text-center space-y-3",children:[v.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:t}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400 max-w-md",children:"This may take a moment on slow connections. We're fetching your budget data securely."})]}),v.jsxs("div",{className:"mt-12 w-full max-w-md space-y-4",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("div",{className:"h-6 bg-gray-200 dark:bg-zinc-700 rounded w-24 animate-pulse"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]})]})}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsx("div",{className:"h-4 bg-gray-200 dark:bg-zinc-700 rounded w-32 mb-2 animate-pulse"}),v.jsx("div",{className:"h-8 bg-gray-200 dark:bg-zinc-700 rounded w-20 animate-pulse"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-28 animate-pulse"}),v.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-32 animate-pulse"}),v.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]})]}),e&&v.jsx("div",{className:"mt-8 p-4 bg-amber-50 dark:bg-amber-900/20 rounded-xl border border-amber-200 dark:border-amber-800 max-w-md",children:v.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200 text-center",children:"This is taking longer than usual. If you're on a very slow connection, this is normal. Your data will load shortly."})}),v.jsx("div",{className:"mt-8 w-full max-w-md",children:v.jsx("div",{className:"h-1 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:v.jsx("div",{className:"h-full bg-blue-500 rounded-full animate-pulse",style:{width:"60%"}})})})]}),o_=B.createContext({});function G0(t){const e=B.useRef(null);return e.current===null&&(e.current=t()),e.current}const l_=typeof window<"u",c_=l_?B.useLayoutEffect:B.useEffect,H0=B.createContext(null);function u_(t,e){t.indexOf(e)===-1&&t.push(e)}function d_(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const Is=(t,e,n)=>n>e?e:n<t?t:n;let f_=()=>{};const Ms={},LM=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function BM(t){return typeof t=="object"&&t!==null}const UM=t=>/^0[^.\s]+$/u.test(t);function h_(t){let e;return()=>(e===void 0&&(e=t()),e)}const Ci=t=>t,eG=(t,e)=>n=>e(t(n)),zh=(...t)=>t.reduce(eG),ah=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r};class p_{constructor(){this.subscriptions=[]}add(e){return u_(this.subscriptions,e),()=>d_(this.subscriptions,e)}notify(e,n,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,n,r);else for(let a=0;a<i;a++){const o=this.subscriptions[a];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const ja=t=>t*1e3,Ti=t=>t/1e3;function FM(t,e){return e?t*(1e3/e):0}const $M=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,tG=1e-7,nG=12;function rG(t,e,n,r,i){let a,o,c=0;do o=e+(n-e)/2,a=$M(o,r,i)-t,a>0?n=o:e=o;while(Math.abs(a)>tG&&++c<nG);return o}function Lh(t,e,n,r){if(t===e&&n===r)return Ci;const i=a=>rG(a,0,1,t,n);return a=>a===0||a===1?a:$M(i(a),e,r)}const GM=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,HM=t=>e=>1-t(1-e),qM=Lh(.33,1.53,.69,.99),g_=HM(qM),YM=GM(g_),XM=t=>(t*=2)<1?.5*g_(t):.5*(2-Math.pow(2,-10*(t-1))),m_=t=>1-Math.sin(Math.acos(t)),WM=HM(m_),KM=GM(m_),iG=Lh(.42,0,1,1),aG=Lh(0,0,.58,1),QM=Lh(.42,0,.58,1),sG=t=>Array.isArray(t)&&typeof t[0]!="number",ZM=t=>Array.isArray(t)&&typeof t[0]=="number",oG={linear:Ci,easeIn:iG,easeInOut:QM,easeOut:aG,circIn:m_,circInOut:KM,circOut:WM,backIn:g_,backInOut:YM,backOut:qM,anticipate:XM},lG=t=>typeof t=="string",uk=t=>{if(ZM(t)){f_(t.length===4);const[e,n,r,i]=t;return Lh(e,n,r,i)}else if(lG(t))return oG[t];return t},Ig=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function cG(t,e){let n=new Set,r=new Set,i=!1,a=!1;const o=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function u(h){o.has(h)&&(d.schedule(h),t()),h(c)}const d={schedule:(h,p=!1,m=!1)=>{const w=m&&i?n:r;return p&&o.add(h),w.has(h)||w.add(h),h},cancel:h=>{r.delete(h),o.delete(h)},process:h=>{if(c=h,i){a=!0;return}i=!0,[n,r]=[r,n],n.forEach(u),n.clear(),i=!1,a&&(a=!1,d.process(h))}};return d}const uG=40;function JM(t,e){let n=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},a=()=>n=!0,o=Ig.reduce((N,j)=>(N[j]=cG(a),N),{}),{setup:c,read:u,resolveKeyframes:d,preUpdate:h,update:p,preRender:m,render:b,postRender:w}=o,E=()=>{const N=Ms.useManualTiming?i.timestamp:performance.now();n=!1,Ms.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(N-i.timestamp,uG),1)),i.timestamp=N,i.isProcessing=!0,c.process(i),u.process(i),d.process(i),h.process(i),p.process(i),m.process(i),b.process(i),w.process(i),i.isProcessing=!1,n&&e&&(r=!1,t(E))},S=()=>{n=!0,r=!0,i.isProcessing||t(E)};return{schedule:Ig.reduce((N,j)=>{const P=o[j];return N[j]=(M,A=!1,k=!1)=>(n||S(),P.schedule(M,A,k)),N},{}),cancel:N=>{for(let j=0;j<Ig.length;j++)o[Ig[j]].cancel(N)},state:i,steps:o}}const{schedule:en,cancel:Xo,state:tr,steps:Ob}=JM(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ci,!0);let lm;function dG(){lm=void 0}const Vr={now:()=>(lm===void 0&&Vr.set(tr.isProcessing||Ms.useManualTiming?tr.timestamp:performance.now()),lm),set:t=>{lm=t,queueMicrotask(dG)}},eO=t=>e=>typeof e=="string"&&e.startsWith(t),v_=eO("--"),fG=eO("var(--"),y_=t=>fG(t)?hG.test(t.split("/*")[0].trim()):!1,hG=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,nd={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},sh={...nd,transform:t=>Is(0,1,t)},Mg={...nd,default:1},Mf=t=>Math.round(t*1e5)/1e5,b_=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function pG(t){return t==null}const gG=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,x_=(t,e)=>n=>!!(typeof n=="string"&&gG.test(n)&&n.startsWith(t)||e&&!pG(n)&&Object.prototype.hasOwnProperty.call(n,e)),tO=(t,e,n)=>r=>{if(typeof r!="string")return r;const[i,a,o,c]=r.match(b_);return{[t]:parseFloat(i),[e]:parseFloat(a),[n]:parseFloat(o),alpha:c!==void 0?parseFloat(c):1}},mG=t=>Is(0,255,t),Pb={...nd,transform:t=>Math.round(mG(t))},$l={test:x_("rgb","red"),parse:tO("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+Pb.transform(t)+", "+Pb.transform(e)+", "+Pb.transform(n)+", "+Mf(sh.transform(r))+")"};function vG(t){let e="",n="",r="",i="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),i=t.substring(4,5),e+=e,n+=n,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const Wx={test:x_("#"),parse:vG,transform:$l.transform},Bh=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),wo=Bh("deg"),Va=Bh("%"),et=Bh("px"),yG=Bh("vh"),bG=Bh("vw"),dk={...Va,parse:t=>Va.parse(t)/100,transform:t=>Va.transform(t*100)},ou={test:x_("hsl","hue"),parse:tO("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+Va.transform(Mf(e))+", "+Va.transform(Mf(n))+", "+Mf(sh.transform(r))+")"},Mn={test:t=>$l.test(t)||Wx.test(t)||ou.test(t),parse:t=>$l.test(t)?$l.parse(t):ou.test(t)?ou.parse(t):Wx.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?$l.transform(t):ou.transform(t),getAnimatableNone:t=>{const e=Mn.parse(t);return e.alpha=0,Mn.transform(e)}},xG=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function wG(t){return isNaN(t)&&typeof t=="string"&&(t.match(b_)?.length||0)+(t.match(xG)?.length||0)>0}const nO="number",rO="color",_G="var",EG="var(",fk="${}",SG=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function oh(t){const e=t.toString(),n=[],r={color:[],number:[],var:[]},i=[];let a=0;const c=e.replace(SG,u=>(Mn.test(u)?(r.color.push(a),i.push(rO),n.push(Mn.parse(u))):u.startsWith(EG)?(r.var.push(a),i.push(_G),n.push(u)):(r.number.push(a),i.push(nO),n.push(parseFloat(u))),++a,fk)).split(fk);return{values:n,split:c,indexes:r,types:i}}function iO(t){return oh(t).values}function aO(t){const{split:e,types:n}=oh(t),r=e.length;return i=>{let a="";for(let o=0;o<r;o++)if(a+=e[o],i[o]!==void 0){const c=n[o];c===nO?a+=Mf(i[o]):c===rO?a+=Mn.transform(i[o]):a+=i[o]}return a}}const TG=t=>typeof t=="number"?0:Mn.test(t)?Mn.getAnimatableNone(t):t;function AG(t){const e=iO(t);return aO(t)(e.map(TG))}const Wo={test:wG,parse:iO,createTransformer:aO,getAnimatableNone:AG};function jb(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function CG({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let i=0,a=0,o=0;if(!e)i=a=o=n;else{const c=n<.5?n*(1+e):n+e-n*e,u=2*n-c;i=jb(u,c,t+1/3),a=jb(u,c,t),o=jb(u,c,t-1/3)}return{red:Math.round(i*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:r}}function $m(t,e){return n=>n>0?e:t}const sn=(t,e,n)=>t+(e-t)*n,Vb=(t,e,n)=>{const r=t*t,i=n*(e*e-r)+r;return i<0?0:Math.sqrt(i)},kG=[Wx,$l,ou],RG=t=>kG.find(e=>e.test(t));function hk(t){const e=RG(t);if(!e)return!1;let n=e.parse(t);return e===ou&&(n=CG(n)),n}const pk=(t,e)=>{const n=hk(t),r=hk(e);if(!n||!r)return $m(t,e);const i={...n};return a=>(i.red=Vb(n.red,r.red,a),i.green=Vb(n.green,r.green,a),i.blue=Vb(n.blue,r.blue,a),i.alpha=sn(n.alpha,r.alpha,a),$l.transform(i))},Kx=new Set(["none","hidden"]);function NG(t,e){return Kx.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function DG(t,e){return n=>sn(t,e,n)}function w_(t){return typeof t=="number"?DG:typeof t=="string"?y_(t)?$m:Mn.test(t)?pk:OG:Array.isArray(t)?sO:typeof t=="object"?Mn.test(t)?pk:IG:$m}function sO(t,e){const n=[...t],r=n.length,i=t.map((a,o)=>w_(a)(a,e[o]));return a=>{for(let o=0;o<r;o++)n[o]=i[o](a);return n}}function IG(t,e){const n={...t,...e},r={};for(const i in n)t[i]!==void 0&&e[i]!==void 0&&(r[i]=w_(t[i])(t[i],e[i]));return i=>{for(const a in r)n[a]=r[a](i);return n}}function MG(t,e){const n=[],r={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const a=e.types[i],o=t.indexes[a][r[a]],c=t.values[o]??0;n[i]=c,r[a]++}return n}const OG=(t,e)=>{const n=Wo.createTransformer(e),r=oh(t),i=oh(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?Kx.has(t)&&!i.values.length||Kx.has(e)&&!r.values.length?NG(t,e):zh(sO(MG(r,i),i.values),n):$m(t,e)};function oO(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?sn(t,e,n):w_(t)(t,e)}const PG=t=>{const e=({timestamp:n})=>t(n);return{start:(n=!0)=>en.update(e,n),stop:()=>Xo(e),now:()=>tr.isProcessing?tr.timestamp:Vr.now()}},lO=(t,e,n=10)=>{let r="";const i=Math.max(Math.round(e/n),2);for(let a=0;a<i;a++)r+=Math.round(t(a/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},Gm=2e4;function __(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<Gm;)e+=n,r=t.next(e);return e>=Gm?1/0:e}function jG(t,e=100,n){const r=n({...t,keyframes:[0,e]}),i=Math.min(__(r),Gm);return{type:"keyframes",ease:a=>r.next(i*a).value/e,duration:Ti(i)}}const VG=5;function cO(t,e,n){const r=Math.max(e-VG,0);return FM(n-t(r),e-r)}const hn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},zb=.001;function zG({duration:t=hn.duration,bounce:e=hn.bounce,velocity:n=hn.velocity,mass:r=hn.mass}){let i,a,o=1-e;o=Is(hn.minDamping,hn.maxDamping,o),t=Is(hn.minDuration,hn.maxDuration,Ti(t)),o<1?(i=d=>{const h=d*o,p=h*t,m=h-n,b=Qx(d,o),w=Math.exp(-p);return zb-m/b*w},a=d=>{const p=d*o*t,m=p*n+n,b=Math.pow(o,2)*Math.pow(d,2)*t,w=Math.exp(-p),E=Qx(Math.pow(d,2),o);return(-i(d)+zb>0?-1:1)*((m-b)*w)/E}):(i=d=>{const h=Math.exp(-d*t),p=(d-n)*t+1;return-zb+h*p},a=d=>{const h=Math.exp(-d*t),p=(n-d)*(t*t);return h*p});const c=5/t,u=BG(i,a,c);if(t=ja(t),isNaN(u))return{stiffness:hn.stiffness,damping:hn.damping,duration:t};{const d=Math.pow(u,2)*r;return{stiffness:d,damping:o*2*Math.sqrt(r*d),duration:t}}}const LG=12;function BG(t,e,n){let r=n;for(let i=1;i<LG;i++)r=r-t(r)/e(r);return r}function Qx(t,e){return t*Math.sqrt(1-e*e)}const UG=["duration","bounce"],FG=["stiffness","damping","mass"];function gk(t,e){return e.some(n=>t[n]!==void 0)}function $G(t){let e={velocity:hn.velocity,stiffness:hn.stiffness,damping:hn.damping,mass:hn.mass,isResolvedFromDuration:!1,...t};if(!gk(t,FG)&&gk(t,UG))if(t.visualDuration){const n=t.visualDuration,r=2*Math.PI/(n*1.2),i=r*r,a=2*Is(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:hn.mass,stiffness:i,damping:a}}else{const n=zG(t);e={...e,...n,mass:hn.mass},e.isResolvedFromDuration=!0}return e}function Hm(t=hn.visualDuration,e=hn.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:r,restDelta:i}=n;const a=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],c={done:!1,value:a},{stiffness:u,damping:d,mass:h,duration:p,velocity:m,isResolvedFromDuration:b}=$G({...n,velocity:-Ti(n.velocity||0)}),w=m||0,E=d/(2*Math.sqrt(u*h)),S=o-a,T=Ti(Math.sqrt(u/h)),C=Math.abs(S)<5;r||(r=C?hn.restSpeed.granular:hn.restSpeed.default),i||(i=C?hn.restDelta.granular:hn.restDelta.default);let N;if(E<1){const P=Qx(T,E);N=M=>{const A=Math.exp(-E*T*M);return o-A*((w+E*T*S)/P*Math.sin(P*M)+S*Math.cos(P*M))}}else if(E===1)N=P=>o-Math.exp(-T*P)*(S+(w+T*S)*P);else{const P=T*Math.sqrt(E*E-1);N=M=>{const A=Math.exp(-E*T*M),k=Math.min(P*M,300);return o-A*((w+E*T*S)*Math.sinh(k)+P*S*Math.cosh(k))/P}}const j={calculatedDuration:b&&p||null,next:P=>{const M=N(P);if(b)c.done=P>=p;else{let A=P===0?w:0;E<1&&(A=P===0?ja(w):cO(N,P,M));const k=Math.abs(A)<=r,D=Math.abs(o-M)<=i;c.done=k&&D}return c.value=c.done?o:M,c},toString:()=>{const P=Math.min(__(j),Gm),M=lO(A=>j.next(P*A).value,P,30);return P+"ms "+M},toTransition:()=>{}};return j}Hm.applyToOptions=t=>{const e=jG(t,100,Hm);return t.ease=e.ease,t.duration=ja(e.duration),t.type="keyframes",t};function Zx({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:a=500,modifyTarget:o,min:c,max:u,restDelta:d=.5,restSpeed:h}){const p=t[0],m={done:!1,value:p},b=k=>c!==void 0&&k<c||u!==void 0&&k>u,w=k=>c===void 0?u:u===void 0||Math.abs(c-k)<Math.abs(u-k)?c:u;let E=n*e;const S=p+E,T=o===void 0?S:o(S);T!==S&&(E=T-p);const C=k=>-E*Math.exp(-k/r),N=k=>T+C(k),j=k=>{const D=C(k),V=N(k);m.done=Math.abs(D)<=d,m.value=m.done?T:V};let P,M;const A=k=>{b(m.value)&&(P=k,M=Hm({keyframes:[m.value,w(m.value)],velocity:cO(N,k,m.value),damping:i,stiffness:a,restDelta:d,restSpeed:h}))};return A(0),{calculatedDuration:null,next:k=>{let D=!1;return!M&&P===void 0&&(D=!0,j(k),A(k)),P!==void 0&&k>=P?M.next(k-P):(!D&&j(k),m)}}}function GG(t,e,n){const r=[],i=n||Ms.mix||oO,a=t.length-1;for(let o=0;o<a;o++){let c=i(t[o],t[o+1]);if(e){const u=Array.isArray(e)?e[o]||Ci:e;c=zh(u,c)}r.push(c)}return r}function HG(t,e,{clamp:n=!0,ease:r,mixer:i}={}){const a=t.length;if(f_(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[a-1]&&(t=[...t].reverse(),e=[...e].reverse());const c=GG(e,r,i),u=c.length,d=h=>{if(o&&h<t[0])return e[0];let p=0;if(u>1)for(;p<t.length-2&&!(h<t[p+1]);p++);const m=ah(t[p],t[p+1],h);return c[p](m)};return n?h=>d(Is(t[0],t[a-1],h)):d}function qG(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const i=ah(0,e,r);t.push(sn(n,1,i))}}function YG(t){const e=[0];return qG(e,t.length-1),e}function XG(t,e){return t.map(n=>n*e)}function WG(t,e){return t.map(()=>e||QM).splice(0,t.length-1)}function Of({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const i=sG(r)?r.map(uk):uk(r),a={done:!1,value:e[0]},o=XG(n&&n.length===e.length?n:YG(e),t),c=HG(o,e,{ease:Array.isArray(i)?i:WG(e,i)});return{calculatedDuration:t,next:u=>(a.value=c(u),a.done=u>=t,a)}}const KG=t=>t!==null;function E_(t,{repeat:e,repeatType:n="loop"},r,i=1){const a=t.filter(KG),c=i<0||e&&n!=="loop"&&e%2===1?0:a.length-1;return!c||r===void 0?a[c]:r}const QG={decay:Zx,inertia:Zx,tween:Of,keyframes:Of,spring:Hm};function uO(t){typeof t.type=="string"&&(t.type=QG[t.type])}class S_{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,n){return this.finished.then(e,n)}}const ZG=t=>t/100;class T_ extends S_{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;n&&n.updatedAt!==Vr.now()&&this.tick(Vr.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;uO(e);const{type:n=Of,repeat:r=0,repeatDelay:i=0,repeatType:a,velocity:o=0}=e;let{keyframes:c}=e;const u=n||Of;u!==Of&&typeof c[0]!="number"&&(this.mixKeyframes=zh(ZG,oO(c[0],c[1])),c=[0,100]);const d=u({...e,keyframes:c});a==="mirror"&&(this.mirroredGenerator=u({...e,keyframes:[...c].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=__(d));const{calculatedDuration:h}=d;this.calculatedDuration=h,this.resolvedDuration=h+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=d}updateTime(e){const n=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(e,n=!1){const{generator:r,totalDuration:i,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:c,calculatedDuration:u}=this;if(this.startTime===null)return r.next(0);const{delay:d=0,keyframes:h,repeat:p,repeatType:m,repeatDelay:b,type:w,onUpdate:E,finalKeyframe:S}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),n?this.currentTime=e:this.updateTime(e);const T=this.currentTime-d*(this.playbackSpeed>=0?1:-1),C=this.playbackSpeed>=0?T<0:T>i;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let N=this.currentTime,j=r;if(p){const k=Math.min(this.currentTime,i)/c;let D=Math.floor(k),V=k%1;!V&&k>=1&&(V=1),V===1&&D--,D=Math.min(D,p+1),!!(D%2)&&(m==="reverse"?(V=1-V,b&&(V-=b/c)):m==="mirror"&&(j=o)),N=Is(0,1,V)*c}const P=C?{done:!1,value:h[0]}:j.next(N);a&&(P.value=a(P.value));let{done:M}=P;!C&&u!==null&&(M=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const A=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&M);return A&&w!==Zx&&(P.value=E_(h,this.options,S,this.speed)),E&&E(P.value),A&&this.finish(),P}then(e,n){return this.finished.then(e,n)}get duration(){return Ti(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Ti(e)}get time(){return Ti(this.currentTime)}set time(e){e=ja(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Vr.now());const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=Ti(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=PG,startTime:n}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=n??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Vr.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function JG(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const Gl=t=>t*180/Math.PI,Jx=t=>{const e=Gl(Math.atan2(t[1],t[0]));return e1(e)},eH={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:Jx,rotateZ:Jx,skewX:t=>Gl(Math.atan(t[1])),skewY:t=>Gl(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},e1=t=>(t=t%360,t<0&&(t+=360),t),mk=Jx,vk=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),yk=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),tH={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:vk,scaleY:yk,scale:t=>(vk(t)+yk(t))/2,rotateX:t=>e1(Gl(Math.atan2(t[6],t[5]))),rotateY:t=>e1(Gl(Math.atan2(-t[2],t[0]))),rotateZ:mk,rotate:mk,skewX:t=>Gl(Math.atan(t[4])),skewY:t=>Gl(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function t1(t){return t.includes("scale")?1:0}function n1(t,e){if(!t||t==="none")return t1(e);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(n)r=tH,i=n;else{const c=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=eH,i=c}if(!i)return t1(e);const a=r[e],o=i[1].split(",").map(rH);return typeof a=="function"?a(o):o[a]}const nH=(t,e)=>{const{transform:n="none"}=getComputedStyle(t);return n1(n,e)};function rH(t){return parseFloat(t.trim())}const rd=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],id=new Set(rd),bk=t=>t===nd||t===et,iH=new Set(["x","y","z"]),aH=rd.filter(t=>!iH.has(t));function sH(t){const e=[];return aH.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e}const Wl={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>n1(e,"x"),y:(t,{transform:e})=>n1(e,"y")};Wl.translateX=Wl.x;Wl.translateY=Wl.y;const Kl=new Set;let r1=!1,i1=!1,a1=!1;function dO(){if(i1){const t=Array.from(Kl).filter(r=>r.needsMeasurement),e=new Set(t.map(r=>r.element)),n=new Map;e.forEach(r=>{const i=sH(r);i.length&&(n.set(r,i),r.render())}),t.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=n.get(r);i&&i.forEach(([a,o])=>{r.getValue(a)?.set(o)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}i1=!1,r1=!1,Kl.forEach(t=>t.complete(a1)),Kl.clear()}function fO(){Kl.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(i1=!0)})}function oH(){a1=!0,fO(),dO(),a1=!1}class A_{constructor(e,n,r,i,a,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=r,this.motionValue=i,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(Kl.add(this),r1||(r1=!0,en.read(fO),en.resolveKeyframes(dO))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:r,motionValue:i}=this;if(e[0]===null){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&n){const c=r.readValue(n,o);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}JG(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Kl.delete(this)}cancel(){this.state==="scheduled"&&(Kl.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const lH=t=>t.startsWith("--");function cH(t,e,n){lH(e)?t.style.setProperty(e,n):t.style[e]=n}const uH=h_(()=>window.ScrollTimeline!==void 0),dH={};function fH(t,e){const n=h_(t);return()=>dH[e]??n()}const hO=fH(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),_f=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,xk={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:_f([0,.65,.55,1]),circOut:_f([.55,0,1,.45]),backIn:_f([.31,.01,.66,-.59]),backOut:_f([.33,1.53,.69,.99])};function pO(t,e){if(t)return typeof t=="function"?hO()?lO(t,e):"ease-out":ZM(t)?_f(t):Array.isArray(t)?t.map(n=>pO(n,e)||xk.easeOut):xk[t]}function hH(t,e,n,{delay:r=0,duration:i=300,repeat:a=0,repeatType:o="loop",ease:c="easeOut",times:u}={},d=void 0){const h={[e]:n};u&&(h.offset=u);const p=pO(c,i);Array.isArray(p)&&(h.easing=p);const m={delay:r,duration:i,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};return d&&(m.pseudoElement=d),t.animate(h,m)}function gO(t){return typeof t=="function"&&"applyToOptions"in t}function pH({type:t,...e}){return gO(t)&&hO()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class gH extends S_{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:n,name:r,keyframes:i,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:c,onComplete:u}=e;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=e,f_(typeof e.type!="string");const d=pH(e);this.animation=hH(n,r,i,d,a),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const h=E_(i,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(h):cH(n,r,h),this.animation.cancel()}u?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return Ti(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Ti(e)}get time(){return Ti(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=ja(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:n}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&uH()?(this.animation.timeline=e,Ci):n(this)}}const mO={anticipate:XM,backInOut:YM,circInOut:KM};function mH(t){return t in mO}function vH(t){typeof t.ease=="string"&&mH(t.ease)&&(t.ease=mO[t.ease])}const wk=10;class yH extends gH{constructor(e){vH(e),uO(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:n,onUpdate:r,onComplete:i,element:a,...o}=this.options;if(!n)return;if(e!==void 0){n.set(e);return}const c=new T_({...o,autoplay:!1}),u=ja(this.finishedTime??this.time);n.setWithVelocity(c.sample(u-wk).value,c.sample(u).value,wk),c.stop()}}const _k=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Wo.test(t)||t==="0")&&!t.startsWith("url("));function bH(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function xH(t,e,n,r){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const a=t[t.length-1],o=_k(i,e),c=_k(a,e);return!o||!c?!1:bH(t)||(n==="spring"||gO(n))&&r}function s1(t){t.duration=0,t.type="keyframes"}const wH=new Set(["opacity","clipPath","filter","transform"]),_H=h_(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function EH(t){const{motionValue:e,name:n,repeatDelay:r,repeatType:i,damping:a,type:o}=t;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:d}=e.owner.getProps();return _H()&&n&&wH.has(n)&&(n!=="transform"||!d)&&!u&&!r&&i!=="mirror"&&a!==0&&o!=="inertia"}const SH=40;class TH extends S_{constructor({autoplay:e=!0,delay:n=0,type:r="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:o="loop",keyframes:c,name:u,motionValue:d,element:h,...p}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Vr.now();const m={autoplay:e,delay:n,type:r,repeat:i,repeatDelay:a,repeatType:o,name:u,motionValue:d,element:h,...p},b=h?.KeyframeResolver||A_;this.keyframeResolver=new b(c,(w,E,S)=>this.onKeyframesResolved(w,E,m,!S),u,d,h),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,n,r,i){this.keyframeResolver=void 0;const{name:a,type:o,velocity:c,delay:u,isHandoff:d,onUpdate:h}=r;this.resolvedAt=Vr.now(),xH(e,a,o,c)||((Ms.instantAnimations||!u)&&h?.(E_(e,r,n)),e[0]=e[e.length-1],s1(r),r.repeat=0);const m={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>SH?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:e},b=!d&&EH(m)?new yH({...m,element:m.motionValue.owner.current}):new T_(m);b.finished.then(()=>this.notifyFinished()).catch(Ci),this.pendingTimeline&&(this.stopTimeline=b.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=b}get finished(){return this._animation?this.animation.finished:this._finished}then(e,n){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),oH()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const AH=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function CH(t){const e=AH.exec(t);if(!e)return[,];const[,n,r,i]=e;return[`--${n??r}`,i]}function vO(t,e,n=1){const[r,i]=CH(t);if(!r)return;const a=window.getComputedStyle(e).getPropertyValue(r);if(a){const o=a.trim();return LM(o)?parseFloat(o):o}return y_(i)?vO(i,e,n+1):i}function C_(t,e){return t?.[e]??t?.default??t}const yO=new Set(["width","height","top","left","right","bottom",...rd]),kH={test:t=>t==="auto",parse:t=>t},bO=t=>e=>e.test(t),xO=[nd,et,Va,wo,bG,yG,kH],Ek=t=>xO.find(bO(t));function RH(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||UM(t):!0}const NH=new Set(["brightness","contrast","saturate","opacity"]);function DH(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(b_)||[];if(!r)return t;const i=n.replace(r,"");let a=NH.has(e)?1:0;return r!==n&&(a*=100),e+"("+a+i+")"}const IH=/\b([a-z-]*)\(.*?\)/gu,o1={...Wo,getAnimatableNone:t=>{const e=t.match(IH);return e?e.map(DH).join(" "):t}},Sk={...nd,transform:Math.round},MH={rotate:wo,rotateX:wo,rotateY:wo,rotateZ:wo,scale:Mg,scaleX:Mg,scaleY:Mg,scaleZ:Mg,skew:wo,skewX:wo,skewY:wo,distance:et,translateX:et,translateY:et,translateZ:et,x:et,y:et,z:et,perspective:et,transformPerspective:et,opacity:sh,originX:dk,originY:dk,originZ:et},k_={borderWidth:et,borderTopWidth:et,borderRightWidth:et,borderBottomWidth:et,borderLeftWidth:et,borderRadius:et,radius:et,borderTopLeftRadius:et,borderTopRightRadius:et,borderBottomRightRadius:et,borderBottomLeftRadius:et,width:et,maxWidth:et,height:et,maxHeight:et,top:et,right:et,bottom:et,left:et,padding:et,paddingTop:et,paddingRight:et,paddingBottom:et,paddingLeft:et,margin:et,marginTop:et,marginRight:et,marginBottom:et,marginLeft:et,backgroundPositionX:et,backgroundPositionY:et,...MH,zIndex:Sk,fillOpacity:sh,strokeOpacity:sh,numOctaves:Sk},OH={...k_,color:Mn,backgroundColor:Mn,outlineColor:Mn,fill:Mn,stroke:Mn,borderColor:Mn,borderTopColor:Mn,borderRightColor:Mn,borderBottomColor:Mn,borderLeftColor:Mn,filter:o1,WebkitFilter:o1},wO=t=>OH[t];function _O(t,e){let n=wO(t);return n!==o1&&(n=Wo),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const PH=new Set(["auto","none","0"]);function jH(t,e,n){let r=0,i;for(;r<t.length&&!i;){const a=t[r];typeof a=="string"&&!PH.has(a)&&oh(a).values.length&&(i=t[r]),r++}if(i&&n)for(const a of e)t[a]=_O(n,i)}class VH extends A_{constructor(e,n,r,i,a){super(e,n,r,i,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let d=e[u];if(typeof d=="string"&&(d=d.trim(),y_(d))){const h=vO(d,n.current);h!==void 0&&(e[u]=h),u===e.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!yO.has(r)||e.length!==2)return;const[i,a]=e,o=Ek(i),c=Ek(a);if(o!==c)if(bk(o)&&bk(c))for(let u=0;u<e.length;u++){const d=e[u];typeof d=="string"&&(e[u]=parseFloat(d))}else Wl[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,r=[];for(let i=0;i<e.length;i++)(e[i]===null||RH(e[i]))&&r.push(i);r.length&&jH(e,r,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Wl[r](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const i=n[n.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){const{element:e,name:n,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const i=e.getValue(n);i&&i.jump(this.measuredOrigin,!1);const a=r.length-1,o=r[a];r[a]=Wl[n](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([c,u])=>{e.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function zH(t,e,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let r=document;const i=n?.[t]??r.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}const EO=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function SO(t){return BM(t)&&"offsetHeight"in t}const Tk=30,LH=t=>!isNaN(parseFloat(t));class BH{constructor(e,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const i=Vr.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Vr.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=LH(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new p_);const r=this.events[e].add(n);return e==="change"?()=>{r(),en.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Vr.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>Tk)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,Tk);return FM(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Mu(t,e){return new BH(t,e)}const{schedule:R_}=JM(queueMicrotask,!1),Gi={x:!1,y:!1};function TO(){return Gi.x||Gi.y}function UH(t){return t==="x"||t==="y"?Gi[t]?null:(Gi[t]=!0,()=>{Gi[t]=!1}):Gi.x||Gi.y?null:(Gi.x=Gi.y=!0,()=>{Gi.x=Gi.y=!1})}function AO(t,e){const n=zH(t),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[n,i,()=>r.abort()]}function Ak(t){return!(t.pointerType==="touch"||TO())}function FH(t,e,n={}){const[r,i,a]=AO(t,n),o=c=>{if(!Ak(c))return;const{target:u}=c,d=e(u,c);if(typeof d!="function"||!u)return;const h=p=>{Ak(p)&&(d(p),u.removeEventListener("pointerleave",h))};u.addEventListener("pointerleave",h,i)};return r.forEach(c=>{c.addEventListener("pointerenter",o,i)}),a}const CO=(t,e)=>e?t===e?!0:CO(t,e.parentElement):!1,N_=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,$H=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function GH(t){return $H.has(t.tagName)||t.tabIndex!==-1}const cm=new WeakSet;function Ck(t){return e=>{e.key==="Enter"&&t(e)}}function Lb(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const HH=(t,e)=>{const n=t.currentTarget;if(!n)return;const r=Ck(()=>{if(cm.has(n))return;Lb(n,"down");const i=Ck(()=>{Lb(n,"up")}),a=()=>Lb(n,"cancel");n.addEventListener("keyup",i,e),n.addEventListener("blur",a,e)});n.addEventListener("keydown",r,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),e)};function kk(t){return N_(t)&&!TO()}function qH(t,e,n={}){const[r,i,a]=AO(t,n),o=c=>{const u=c.currentTarget;if(!kk(c))return;cm.add(u);const d=e(u,c),h=(b,w)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",m),cm.has(u)&&cm.delete(u),kk(b)&&typeof d=="function"&&d(b,{success:w})},p=b=>{h(b,u===window||u===document||n.useGlobalTarget||CO(u,b.target))},m=b=>{h(b,!1)};window.addEventListener("pointerup",p,i),window.addEventListener("pointercancel",m,i)};return r.forEach(c=>{(n.useGlobalTarget?window:c).addEventListener("pointerdown",o,i),SO(c)&&(c.addEventListener("focus",d=>HH(d,i)),!GH(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),a}function kO(t){return BM(t)&&"ownerSVGElement"in t}function YH(t){return kO(t)&&t.tagName==="svg"}const dr=t=>!!(t&&t.getVelocity),XH=[...xO,Mn,Wo],WH=t=>XH.find(bO(t)),D_=B.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function Rk(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function KH(...t){return e=>{let n=!1;const r=t.map(i=>{const a=Rk(i,e);return!n&&typeof a=="function"&&(n=!0),a});if(n)return()=>{for(let i=0;i<r.length;i++){const a=r[i];typeof a=="function"?a():Rk(t[i],null)}}}}function QH(...t){return B.useCallback(KH(...t),t)}class ZH extends B.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=n.offsetParent,i=SO(r)&&r.offsetWidth||0,a=this.props.sizeRef.current;a.height=n.offsetHeight||0,a.width=n.offsetWidth||0,a.top=n.offsetTop,a.left=n.offsetLeft,a.right=i-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function JH({children:t,isPresent:e,anchorX:n,root:r}){const i=B.useId(),a=B.useRef(null),o=B.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=B.useContext(D_),u=QH(a,t?.ref);return B.useInsertionEffect(()=>{const{width:d,height:h,top:p,left:m,right:b}=o.current;if(e||!a.current||!d||!h)return;const w=n==="left"?`left: ${m}`:`right: ${b}`;a.current.dataset.motionPopId=i;const E=document.createElement("style");c&&(E.nonce=c);const S=r??document.head;return S.appendChild(E),E.sheet&&E.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${h}px !important;
            ${w}px !important;
            top: ${p}px !important;
          }
        `),()=>{S.contains(E)&&S.removeChild(E)}},[e]),v.jsx(ZH,{isPresent:e,childRef:a,sizeRef:o,children:B.cloneElement(t,{ref:u})})}const eq=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:i,presenceAffectsLayout:a,mode:o,anchorX:c,root:u})=>{const d=G0(tq),h=B.useId();let p=!0,m=B.useMemo(()=>(p=!1,{id:h,initial:e,isPresent:n,custom:i,onExitComplete:b=>{d.set(b,!0);for(const w of d.values())if(!w)return;r&&r()},register:b=>(d.set(b,!1),()=>d.delete(b))}),[n,d,r]);return a&&p&&(m={...m}),B.useMemo(()=>{d.forEach((b,w)=>d.set(w,!1))},[n]),B.useEffect(()=>{!n&&!d.size&&r&&r()},[n]),o==="popLayout"&&(t=v.jsx(JH,{isPresent:n,anchorX:c,root:u,children:t})),v.jsx(H0.Provider,{value:m,children:t})};function tq(){return new Map}function RO(t=!0){const e=B.useContext(H0);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:i}=e,a=B.useId();B.useEffect(()=>{if(t)return i(a)},[t]);const o=B.useCallback(()=>t&&r&&r(a),[a,r,t]);return!n&&r?[!1,o]:[!0]}const Og=t=>t.key||"";function Nk(t){const e=[];return B.Children.forEach(t,n=>{B.isValidElement(n)&&e.push(n)}),e}const ai=({children:t,custom:e,initial:n=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:a="sync",propagate:o=!1,anchorX:c="left",root:u})=>{const[d,h]=RO(o),p=B.useMemo(()=>Nk(t),[t]),m=o&&!d?[]:p.map(Og),b=B.useRef(!0),w=B.useRef(p),E=G0(()=>new Map),[S,T]=B.useState(p),[C,N]=B.useState(p);c_(()=>{b.current=!1,w.current=p;for(let M=0;M<C.length;M++){const A=Og(C[M]);m.includes(A)?E.delete(A):E.get(A)!==!0&&E.set(A,!1)}},[C,m.length,m.join("-")]);const j=[];if(p!==S){let M=[...p];for(let A=0;A<C.length;A++){const k=C[A],D=Og(k);m.includes(D)||(M.splice(A,0,k),j.push(k))}return a==="wait"&&j.length&&(M=j),N(Nk(M)),T(p),null}const{forceRender:P}=B.useContext(o_);return v.jsx(v.Fragment,{children:C.map(M=>{const A=Og(M),k=o&&!d?!1:p===C||m.includes(A),D=()=>{if(E.has(A))E.set(A,!0);else return;let V=!0;E.forEach(L=>{L||(V=!1)}),V&&(P?.(),N(w.current),o&&h?.(),r&&r())};return v.jsx(eq,{isPresent:k,initial:!b.current||n?void 0:!1,custom:e,presenceAffectsLayout:i,mode:a,root:u,onExitComplete:k?void 0:D,anchorX:c,children:M},A)})})},NO=B.createContext({strict:!1}),Dk={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ou={};for(const t in Dk)Ou[t]={isEnabled:e=>Dk[t].some(n=>!!e[n])};function nq(t){for(const e in t)Ou[e]={...Ou[e],...t[e]}}const rq=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function qm(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||rq.has(t)}let DO=t=>!qm(t);function iq(t){typeof t=="function"&&(DO=e=>e.startsWith("on")?!qm(e):t(e))}try{iq(require("@emotion/is-prop-valid").default)}catch{}function aq(t,e,n){const r={};for(const i in t)i==="values"&&typeof t.values=="object"||(DO(i)||n===!0&&qm(i)||!e&&!qm(i)||t.draggable&&i.startsWith("onDrag"))&&(r[i]=t[i]);return r}const q0=B.createContext({});function Y0(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function lh(t){return typeof t=="string"||Array.isArray(t)}const I_=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],M_=["initial",...I_];function X0(t){return Y0(t.animate)||M_.some(e=>lh(t[e]))}function IO(t){return!!(X0(t)||t.variants)}function sq(t,e){if(X0(t)){const{initial:n,animate:r}=t;return{initial:n===!1||lh(n)?n:void 0,animate:lh(r)?r:void 0}}return t.inherit!==!1?e:{}}function oq(t){const{initial:e,animate:n}=sq(t,B.useContext(q0));return B.useMemo(()=>({initial:e,animate:n}),[Ik(e),Ik(n)])}function Ik(t){return Array.isArray(t)?t.join(" "):t}const ch={};function lq(t){for(const e in t)ch[e]=t[e],v_(e)&&(ch[e].isCSSVariable=!0)}function MO(t,{layout:e,layoutId:n}){return id.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!ch[t]||t==="opacity")}const cq={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},uq=rd.length;function dq(t,e,n){let r="",i=!0;for(let a=0;a<uq;a++){const o=rd[a],c=t[o];if(c===void 0)continue;let u=!0;if(typeof c=="number"?u=c===(o.startsWith("scale")?1:0):u=parseFloat(c)===0,!u||n){const d=EO(c,k_[o]);if(!u){i=!1;const h=cq[o]||o;r+=`${h}(${d}) `}n&&(e[o]=d)}}return r=r.trim(),n?r=n(e,i?"":r):i&&(r="none"),r}function O_(t,e,n){const{style:r,vars:i,transformOrigin:a}=t;let o=!1,c=!1;for(const u in e){const d=e[u];if(id.has(u)){o=!0;continue}else if(v_(u)){i[u]=d;continue}else{const h=EO(d,k_[u]);u.startsWith("origin")?(c=!0,a[u]=h):r[u]=h}}if(e.transform||(o||n?r.transform=dq(e,t.transform,n):r.transform&&(r.transform="none")),c){const{originX:u="50%",originY:d="50%",originZ:h=0}=a;r.transformOrigin=`${u} ${d} ${h}`}}const P_=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function OO(t,e,n){for(const r in e)!dr(e[r])&&!MO(r,n)&&(t[r]=e[r])}function fq({transformTemplate:t},e){return B.useMemo(()=>{const n=P_();return O_(n,e,t),Object.assign({},n.vars,n.style)},[e])}function hq(t,e){const n=t.style||{},r={};return OO(r,n,t),Object.assign(r,fq(t,e)),r}function pq(t,e){const n={},r=hq(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}const gq={offset:"stroke-dashoffset",array:"stroke-dasharray"},mq={offset:"strokeDashoffset",array:"strokeDasharray"};function vq(t,e,n=1,r=0,i=!0){t.pathLength=1;const a=i?gq:mq;t[a.offset]=et.transform(-r);const o=et.transform(e),c=et.transform(n);t[a.array]=`${o} ${c}`}function PO(t,{attrX:e,attrY:n,attrScale:r,pathLength:i,pathSpacing:a=1,pathOffset:o=0,...c},u,d,h){if(O_(t,c,d),u){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:p,style:m}=t;p.transform&&(m.transform=p.transform,delete p.transform),(m.transform||p.transformOrigin)&&(m.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),m.transform&&(m.transformBox=h?.transformBox??"fill-box",delete p.transformBox),e!==void 0&&(p.x=e),n!==void 0&&(p.y=n),r!==void 0&&(p.scale=r),i!==void 0&&vq(p,i,a,o,!1)}const jO=()=>({...P_(),attrs:{}}),VO=t=>typeof t=="string"&&t.toLowerCase()==="svg";function yq(t,e,n,r){const i=B.useMemo(()=>{const a=jO();return PO(a,e,VO(r),t.transformTemplate,t.style),{...a.attrs,style:{...a.style}}},[e]);if(t.style){const a={};OO(a,t.style,t),i.style={...a,...i.style}}return i}const bq=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function j_(t){return typeof t!="string"||t.includes("-")?!1:!!(bq.indexOf(t)>-1||/[A-Z]/u.test(t))}function xq(t,e,n,{latestValues:r},i,a=!1){const c=(j_(t)?yq:pq)(e,r,i,t),u=aq(e,typeof t=="string",a),d=t!==B.Fragment?{...u,...c,ref:n}:{},{children:h}=e,p=B.useMemo(()=>dr(h)?h.get():h,[h]);return B.createElement(t,{...d,children:p})}function Mk(t){const e=[{},{}];return t?.values.forEach((n,r)=>{e[0][r]=n.get(),e[1][r]=n.getVelocity()}),e}function V_(t,e,n,r){if(typeof e=="function"){const[i,a]=Mk(r);e=e(n!==void 0?n:t.custom,i,a)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,a]=Mk(r);e=e(n!==void 0?n:t.custom,i,a)}return e}function um(t){return dr(t)?t.get():t}function wq({scrapeMotionValuesFromProps:t,createRenderState:e},n,r,i){return{latestValues:_q(n,r,i,t),renderState:e()}}function _q(t,e,n,r){const i={},a=r(t,{});for(const m in a)i[m]=um(a[m]);let{initial:o,animate:c}=t;const u=X0(t),d=IO(t);e&&d&&!u&&t.inherit!==!1&&(o===void 0&&(o=e.initial),c===void 0&&(c=e.animate));let h=n?n.initial===!1:!1;h=h||o===!1;const p=h?c:o;if(p&&typeof p!="boolean"&&!Y0(p)){const m=Array.isArray(p)?p:[p];for(let b=0;b<m.length;b++){const w=V_(t,m[b]);if(w){const{transitionEnd:E,transition:S,...T}=w;for(const C in T){let N=T[C];if(Array.isArray(N)){const j=h?N.length-1:0;N=N[j]}N!==null&&(i[C]=N)}for(const C in E)i[C]=E[C]}}}return i}const zO=t=>(e,n)=>{const r=B.useContext(q0),i=B.useContext(H0),a=()=>wq(t,e,r,i);return n?a():G0(a)};function z_(t,e,n){const{style:r}=t,i={};for(const a in r)(dr(r[a])||e.style&&dr(e.style[a])||MO(a,t)||n?.getValue(a)?.liveStyle!==void 0)&&(i[a]=r[a]);return i}const Eq=zO({scrapeMotionValuesFromProps:z_,createRenderState:P_});function LO(t,e,n){const r=z_(t,e,n);for(const i in t)if(dr(t[i])||dr(e[i])){const a=rd.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[a]=t[i]}return r}const Sq=zO({scrapeMotionValuesFromProps:LO,createRenderState:jO}),Tq=Symbol.for("motionComponentSymbol");function lu(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Aq(t,e,n){return B.useCallback(r=>{r&&t.onMount&&t.onMount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):lu(n)&&(n.current=r))},[e])}const L_=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Cq="framerAppearId",BO="data-"+L_(Cq),UO=B.createContext({});function kq(t,e,n,r,i){const{visualElement:a}=B.useContext(q0),o=B.useContext(NO),c=B.useContext(H0),u=B.useContext(D_).reducedMotion,d=B.useRef(null);r=r||o.renderer,!d.current&&r&&(d.current=r(t,{visualState:e,parent:a,props:n,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const h=d.current,p=B.useContext(UO);h&&!h.projection&&i&&(h.type==="html"||h.type==="svg")&&Rq(d.current,n,i,p);const m=B.useRef(!1);B.useInsertionEffect(()=>{h&&m.current&&h.update(n,c)});const b=n[BO],w=B.useRef(!!b&&!window.MotionHandoffIsComplete?.(b)&&window.MotionHasOptimisedAnimation?.(b));return c_(()=>{h&&(m.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),h.scheduleRenderMicrotask(),w.current&&h.animationState&&h.animationState.animateChanges())}),B.useEffect(()=>{h&&(!w.current&&h.animationState&&h.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(b)}),w.current=!1),h.enteringChildren=void 0)}),h}function Rq(t,e,n,r){const{layoutId:i,layout:a,drag:o,dragConstraints:c,layoutScroll:u,layoutRoot:d,layoutCrossfade:h}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:FO(t.parent)),t.projection.setOptions({layoutId:i,layout:a,alwaysMeasureLayout:!!o||c&&lu(c),visualElement:t,animationType:typeof a=="string"?a:"both",initialPromotionConfig:r,crossfade:h,layoutScroll:u,layoutRoot:d})}function FO(t){if(t)return t.options.allowProjection!==!1?t.projection:FO(t.parent)}function Bb(t,{forwardMotionProps:e=!1}={},n,r){n&&nq(n);const i=j_(t)?Sq:Eq;function a(c,u){let d;const h={...B.useContext(D_),...c,layoutId:Nq(c)},{isStatic:p}=h,m=oq(c),b=i(c,p);if(!p&&l_){Dq();const w=Iq(h);d=w.MeasureLayout,m.visualElement=kq(t,b,h,r,w.ProjectionNode)}return v.jsxs(q0.Provider,{value:m,children:[d&&m.visualElement?v.jsx(d,{visualElement:m.visualElement,...h}):null,xq(t,c,Aq(b,m.visualElement,u),b,p,e)]})}a.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const o=B.forwardRef(a);return o[Tq]=t,o}function Nq({layoutId:t}){const e=B.useContext(o_).id;return e&&t!==void 0?e+"-"+t:t}function Dq(t,e){B.useContext(NO).strict}function Iq(t){const{drag:e,layout:n}=Ou;if(!e&&!n)return{};const r={...e,...n};return{MeasureLayout:e?.isEnabled(t)||n?.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function Mq(t,e){if(typeof Proxy>"u")return Bb;const n=new Map,r=(a,o)=>Bb(a,o,t,e),i=(a,o)=>r(a,o);return new Proxy(i,{get:(a,o)=>o==="create"?r:(n.has(o)||n.set(o,Bb(o,void 0,t,e)),n.get(o))})}function $O({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function Oq({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function Pq(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function Ub(t){return t===void 0||t===1}function l1({scale:t,scaleX:e,scaleY:n}){return!Ub(t)||!Ub(e)||!Ub(n)}function jl(t){return l1(t)||GO(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function GO(t){return Ok(t.x)||Ok(t.y)}function Ok(t){return t&&t!=="0%"}function Ym(t,e,n){const r=t-n,i=e*r;return n+i}function Pk(t,e,n,r,i){return i!==void 0&&(t=Ym(t,i,r)),Ym(t,n,r)+e}function c1(t,e=0,n=1,r,i){t.min=Pk(t.min,e,n,r,i),t.max=Pk(t.max,e,n,r,i)}function HO(t,{x:e,y:n}){c1(t.x,e.translate,e.scale,e.originPoint),c1(t.y,n.translate,n.scale,n.originPoint)}const jk=.999999999999,Vk=1.0000000000001;function jq(t,e,n,r=!1){const i=n.length;if(!i)return;e.x=e.y=1;let a,o;for(let c=0;c<i;c++){a=n[c],o=a.projectionDelta;const{visualElement:u}=a.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&a.options.layoutScroll&&a.scroll&&a!==a.root&&uu(t,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,HO(t,o)),r&&jl(a.latestValues)&&uu(t,a.latestValues))}e.x<Vk&&e.x>jk&&(e.x=1),e.y<Vk&&e.y>jk&&(e.y=1)}function cu(t,e){t.min=t.min+e,t.max=t.max+e}function zk(t,e,n,r,i=.5){const a=sn(t.min,t.max,i);c1(t,e,n,a,r)}function uu(t,e){zk(t.x,e.x,e.scaleX,e.scale,e.originX),zk(t.y,e.y,e.scaleY,e.scale,e.originY)}function qO(t,e){return $O(Pq(t.getBoundingClientRect(),e))}function Vq(t,e,n){const r=qO(t,n),{scroll:i}=e;return i&&(cu(r.x,i.offset.x),cu(r.y,i.offset.y)),r}const Lk=()=>({translate:0,scale:1,origin:0,originPoint:0}),du=()=>({x:Lk(),y:Lk()}),Bk=()=>({min:0,max:0}),bn=()=>({x:Bk(),y:Bk()}),u1={current:null},YO={current:!1};function zq(){if(YO.current=!0,!!l_)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>u1.current=t.matches;t.addEventListener("change",e),e()}else u1.current=!1}const Lq=new WeakMap;function Bq(t,e,n){for(const r in e){const i=e[r],a=n[r];if(dr(i))t.addValue(r,i);else if(dr(a))t.addValue(r,Mu(i,{owner:t}));else if(a!==i)if(t.hasValue(r)){const o=t.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=t.getStaticValue(r);t.addValue(r,Mu(o!==void 0?o:i,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const Uk=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Uq{scrapeMotionValuesFromProps(e,n,r){return{}}constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:a,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=A_,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=Vr.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,en.render(this.render,!1,!0))};const{latestValues:u,renderState:d}=o;this.latestValues=u,this.baseTarget={...u},this.initialValues=n.initial?{...u}:{},this.renderState=d,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=c,this.blockInitialAnimation=!!a,this.isControllingVariants=X0(n),this.isVariantNode=IO(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...p}=this.scrapeMotionValuesFromProps(n,{},this);for(const m in p){const b=p[m];u[m]!==void 0&&dr(b)&&b.set(u[m])}}mount(e){this.current=e,Lq.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),YO.current||zq(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:u1.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Xo(this.notifyUpdate),Xo(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=id.has(e);r&&this.onBindTransform&&this.onBindTransform();const i=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&en.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{i(),a&&a(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Ou){const n=Ou[e];if(!n)continue;const{isEnabled:r,Feature:i}=n;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):bn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<Uk.length;r++){const i=Uk[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const a="on"+i,o=e[a];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=Bq(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const r=this.values.get(e);n!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=Mu(n===null?void 0:n,{owner:this}),this.addValue(e,r)),r}readValue(e,n){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(LM(r)||UM(r))?r=parseFloat(r):!WH(r)&&Wo.test(n)&&(r=_O(e,n)),this.setBaseTarget(e,dr(r)?r.get():r)),dr(r)?r.get():r}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const a=V_(this.props,n,this.presenceContext?.custom);a&&(r=a[e])}if(n&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!dr(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new p_),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}scheduleRenderMicrotask(){R_.render(this.render)}}class XO extends Uq{constructor(){super(...arguments),this.KeyframeResolver=VH}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;dr(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function WO(t,{style:e,vars:n},r,i){const a=t.style;let o;for(o in e)a[o]=e[o];i?.applyProjectionStyles(a,r);for(o in n)a.setProperty(o,n[o])}function Fq(t){return window.getComputedStyle(t)}class $q extends XO{constructor(){super(...arguments),this.type="html",this.renderInstance=WO}readValueFromInstance(e,n){if(id.has(n))return this.projection?.isProjecting?t1(n):nH(e,n);{const r=Fq(e),i=(v_(n)?r.getPropertyValue(n):r[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return qO(e,n)}build(e,n,r){O_(e,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,n,r){return z_(e,n,r)}}const KO=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Gq(t,e,n,r){WO(t,e,void 0,r);for(const i in e.attrs)t.setAttribute(KO.has(i)?i:L_(i),e.attrs[i])}class Hq extends XO{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=bn}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(id.has(n)){const r=wO(n);return r&&r.default||0}return n=KO.has(n)?n:L_(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,r){return LO(e,n,r)}build(e,n,r){PO(e,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,n,r,i){Gq(e,n,r,i)}mount(e){this.isSVGTag=VO(e.tagName),super.mount(e)}}const qq=(t,e)=>j_(t)?new Hq(e):new $q(e,{allowProjection:t!==B.Fragment});function Eu(t,e,n){const r=t.getProps();return V_(r,e,n!==void 0?n:r.custom,t)}const d1=t=>Array.isArray(t);function Yq(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Mu(n))}function Xq(t){return d1(t)?t[t.length-1]||0:t}function B_(t,e){const n=Eu(t,e);let{transitionEnd:r={},transition:i={},...a}=n||{};a={...a,...r};for(const o in a){const c=Xq(a[o]);Yq(t,o,c)}}function Wq(t){return!!(dr(t)&&t.add)}function f1(t,e){const n=t.getValue("willChange");if(Wq(n))return n.add(e);if(!n&&Ms.WillChange){const r=new Ms.WillChange("auto");t.addValue("willChange",r),r.add(e)}}function QO(t){return t.props[BO]}const Kq=t=>t!==null;function Qq(t,{repeat:e,repeatType:n="loop"},r){const i=t.filter(Kq),a=e&&n!=="loop"&&e%2===1?0:i.length-1;return i[a]}const Zq={type:"spring",stiffness:500,damping:25,restSpeed:10},Jq=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),eY={type:"keyframes",duration:.8},tY={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},nY=(t,{keyframes:e})=>e.length>2?eY:id.has(t)?t.startsWith("scale")?Jq(e[1]):Zq:tY;function rY({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:i,repeat:a,repeatType:o,repeatDelay:c,from:u,elapsed:d,...h}){return!!Object.keys(h).length}const U_=(t,e,n,r={},i,a)=>o=>{const c=C_(r,t)||{},u=c.delay||r.delay||0;let{elapsed:d=0}=r;d=d-ja(u);const h={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...c,delay:-d,onUpdate:m=>{e.set(m),c.onUpdate&&c.onUpdate(m)},onComplete:()=>{o(),c.onComplete&&c.onComplete()},name:t,motionValue:e,element:a?void 0:i};rY(c)||Object.assign(h,nY(t,h)),h.duration&&(h.duration=ja(h.duration)),h.repeatDelay&&(h.repeatDelay=ja(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let p=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(s1(h),h.delay===0&&(p=!0)),(Ms.instantAnimations||Ms.skipAnimations)&&(p=!0,s1(h),h.delay=0),h.allowFlatten=!c.type&&!c.ease,p&&!a&&e.get()!==void 0){const m=Qq(h.keyframes,c);if(m!==void 0){en.update(()=>{h.onUpdate(m),h.onComplete()});return}}return c.isSync?new T_(h):new TH(h)};function iY({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function ZO(t,e,{delay:n=0,transitionOverride:r,type:i}={}){let{transition:a=t.getDefaultTransition(),transitionEnd:o,...c}=e;r&&(a=r);const u=[],d=i&&t.animationState&&t.animationState.getState()[i];for(const h in c){const p=t.getValue(h,t.latestValues[h]??null),m=c[h];if(m===void 0||d&&iY(d,h))continue;const b={delay:n,...C_(a||{},h)},w=p.get();if(w!==void 0&&!p.isAnimating&&!Array.isArray(m)&&m===w&&!b.velocity)continue;let E=!1;if(window.MotionHandoffAnimation){const T=QO(t);if(T){const C=window.MotionHandoffAnimation(T,h,en);C!==null&&(b.startTime=C,E=!0)}}f1(t,h),p.start(U_(h,p,m,t.shouldReduceMotion&&yO.has(h)?{type:!1}:b,t,E));const S=p.animation;S&&u.push(S)}return o&&Promise.all(u).then(()=>{en.update(()=>{o&&B_(t,o)})}),u}function JO(t,e,n,r=0,i=1){const a=Array.from(t).sort((d,h)=>d.sortNodePosition(h)).indexOf(e),o=t.size,c=(o-1)*r;return typeof n=="function"?n(a,o):i===1?a*r:c-a*r}function h1(t,e,n={}){const r=Eu(t,e,n.type==="exit"?t.presenceContext?.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(i=n.transitionOverride);const a=r?()=>Promise.all(ZO(t,r,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:h,staggerDirection:p}=i;return aY(t,e,u,d,h,p,n)}:()=>Promise.resolve(),{when:c}=i;if(c){const[u,d]=c==="beforeChildren"?[a,o]:[o,a];return u().then(()=>d())}else return Promise.all([a(),o(n.delay)])}function aY(t,e,n=0,r=0,i=0,a=1,o){const c=[];for(const u of t.variantChildren)u.notify("AnimationStart",e),c.push(h1(u,e,{...o,delay:n+(typeof r=="function"?0:r)+JO(t.variantChildren,u,r,i,a)}).then(()=>u.notify("AnimationComplete",e)));return Promise.all(c)}function e4(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(a=>h1(t,a,n));r=Promise.all(i)}else if(typeof e=="string")r=h1(t,e,n);else{const i=typeof e=="function"?Eu(t,e,n.custom):e;r=Promise.all(ZO(t,i,n))}return r.then(()=>{t.notify("AnimationComplete",e)})}function t4(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}const sY=M_.length;function n4(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?n4(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<sY;n++){const r=M_[n],i=t.props[r];(lh(i)||i===!1)&&(e[r]=i)}return e}const oY=[...I_].reverse(),lY=I_.length;function cY(t){return e=>Promise.all(e.map(({animation:n,options:r})=>e4(t,n,r)))}function uY(t){let e=cY(t),n=Fk(),r=!0;const i=u=>(d,h)=>{const p=Eu(t,h,u==="exit"?t.presenceContext?.custom:void 0);if(p){const{transition:m,transitionEnd:b,...w}=p;d={...d,...w,...b}}return d};function a(u){e=u(t)}function o(u){const{props:d}=t,h=n4(t.parent)||{},p=[],m=new Set;let b={},w=1/0;for(let S=0;S<lY;S++){const T=oY[S],C=n[T],N=d[T]!==void 0?d[T]:h[T],j=lh(N),P=T===u?C.isActive:null;P===!1&&(w=S);let M=N===h[T]&&N!==d[T]&&j;if(M&&r&&t.manuallyAnimateOnMount&&(M=!1),C.protectedKeys={...b},!C.isActive&&P===null||!N&&!C.prevProp||Y0(N)||typeof N=="boolean")continue;const A=dY(C.prevProp,N);let k=A||T===u&&C.isActive&&!M&&j||S>w&&j,D=!1;const V=Array.isArray(N)?N:[N];let L=V.reduce(i(T),{});P===!1&&(L={});const{prevResolvedValues:U={}}=C,O={...U,...L},J=K=>{k=!0,m.has(K)&&(D=!0,m.delete(K)),C.needsAnimating[K]=!0;const te=t.getValue(K);te&&(te.liveStyle=!1)};for(const K in O){const te=L[K],se=U[K];if(b.hasOwnProperty(K))continue;let G=!1;d1(te)&&d1(se)?G=!t4(te,se):G=te!==se,G?te!=null?J(K):m.add(K):te!==void 0&&m.has(K)?J(K):C.protectedKeys[K]=!0}C.prevProp=N,C.prevResolvedValues=L,C.isActive&&(b={...b,...L}),r&&t.blockInitialAnimation&&(k=!1);const W=M&&A;k&&(!W||D)&&p.push(...V.map(K=>{const te={type:T};if(typeof K=="string"&&r&&!W&&t.manuallyAnimateOnMount&&t.parent){const{parent:se}=t,G=Eu(se,K);if(se.enteringChildren&&G){const{delayChildren:F}=G.transition||{};te.delay=JO(se.enteringChildren,t,F)}}return{animation:K,options:te}}))}if(m.size){const S={};if(typeof d.initial!="boolean"){const T=Eu(t,Array.isArray(d.initial)?d.initial[0]:d.initial);T&&T.transition&&(S.transition=T.transition)}m.forEach(T=>{const C=t.getBaseTarget(T),N=t.getValue(T);N&&(N.liveStyle=!0),S[T]=C??null}),p.push({animation:S})}let E=!!p.length;return r&&(d.initial===!1||d.initial===d.animate)&&!t.manuallyAnimateOnMount&&(E=!1),r=!1,E?e(p):Promise.resolve()}function c(u,d){if(n[u].isActive===d)return Promise.resolve();t.variantChildren?.forEach(p=>p.animationState?.setActive(u,d)),n[u].isActive=d;const h=o(u);for(const p in n)n[p].protectedKeys={};return h}return{animateChanges:o,setActive:c,setAnimateFunction:a,getState:()=>n,reset:()=>{n=Fk()}}}function dY(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!t4(e,t):!1}function Ol(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Fk(){return{animate:Ol(!0),whileInView:Ol(),whileHover:Ol(),whileTap:Ol(),whileDrag:Ol(),whileFocus:Ol(),exit:Ol()}}class il{constructor(e){this.isMounted=!1,this.node=e}update(){}}class fY extends il{constructor(e){super(e),e.animationState||(e.animationState=uY(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Y0(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let hY=0;class pY extends il{constructor(){super(...arguments),this.id=hY++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);n&&!e&&i.then(()=>{n(this.id)})}mount(){const{register:e,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const gY={animation:{Feature:fY},exit:{Feature:pY}};function uh(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}function Uh(t){return{point:{x:t.pageX,y:t.pageY}}}const mY=t=>e=>N_(e)&&t(e,Uh(e));function Pf(t,e,n,r){return uh(t,e,mY(n),r)}const r4=1e-4,vY=1-r4,yY=1+r4,i4=.01,bY=0-i4,xY=0+i4;function wr(t){return t.max-t.min}function wY(t,e,n){return Math.abs(t-e)<=n}function $k(t,e,n,r=.5){t.origin=r,t.originPoint=sn(e.min,e.max,t.origin),t.scale=wr(n)/wr(e),t.translate=sn(n.min,n.max,t.origin)-t.originPoint,(t.scale>=vY&&t.scale<=yY||isNaN(t.scale))&&(t.scale=1),(t.translate>=bY&&t.translate<=xY||isNaN(t.translate))&&(t.translate=0)}function jf(t,e,n,r){$k(t.x,e.x,n.x,r?r.originX:void 0),$k(t.y,e.y,n.y,r?r.originY:void 0)}function Gk(t,e,n){t.min=n.min+e.min,t.max=t.min+wr(e)}function _Y(t,e,n){Gk(t.x,e.x,n.x),Gk(t.y,e.y,n.y)}function Hk(t,e,n){t.min=e.min-n.min,t.max=t.min+wr(e)}function Vf(t,e,n){Hk(t.x,e.x,n.x),Hk(t.y,e.y,n.y)}function _i(t){return[t("x"),t("y")]}const a4=({current:t})=>t?t.ownerDocument.defaultView:null,qk=(t,e)=>Math.abs(t-e);function EY(t,e){const n=qk(t.x,e.x),r=qk(t.y,e.y);return Math.sqrt(n**2+r**2)}class s4{constructor(e,n,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:a=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=$b(this.lastMoveEventInfo,this.history),b=this.startEvent!==null,w=EY(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!b&&!w)return;const{point:E}=m,{timestamp:S}=tr;this.history.push({...E,timestamp:S});const{onStart:T,onMove:C}=this.handlers;b||(T&&T(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),C&&C(this.lastMoveEvent,m)},this.handlePointerMove=(m,b)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=Fb(b,this.transformPagePoint),en.update(this.updatePoint,!0)},this.handlePointerUp=(m,b)=>{this.end();const{onEnd:w,onSessionEnd:E,resumeAnimation:S}=this.handlers;if(this.dragSnapToOrigin&&S&&S(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=$b(m.type==="pointercancel"?this.lastMoveEventInfo:Fb(b,this.transformPagePoint),this.history);this.startEvent&&w&&w(m,T),E&&E(m,T)},!N_(e))return;this.dragSnapToOrigin=a,this.handlers=n,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=i||window;const c=Uh(e),u=Fb(c,this.transformPagePoint),{point:d}=u,{timestamp:h}=tr;this.history=[{...d,timestamp:h}];const{onSessionStart:p}=n;p&&p(e,$b(u,this.history)),this.removeListeners=zh(Pf(this.contextWindow,"pointermove",this.handlePointerMove),Pf(this.contextWindow,"pointerup",this.handlePointerUp),Pf(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Xo(this.updatePoint)}}function Fb(t,e){return e?{point:e(t.point)}:t}function Yk(t,e){return{x:t.x-e.x,y:t.y-e.y}}function $b({point:t},e){return{point:t,delta:Yk(t,o4(e)),offset:Yk(t,SY(e)),velocity:TY(e,.1)}}function SY(t){return t[0]}function o4(t){return t[t.length-1]}function TY(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const i=o4(t);for(;n>=0&&(r=t[n],!(i.timestamp-r.timestamp>ja(e)));)n--;if(!r)return{x:0,y:0};const a=Ti(i.timestamp-r.timestamp);if(a===0)return{x:0,y:0};const o={x:(i.x-r.x)/a,y:(i.y-r.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function AY(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?sn(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?sn(n,t,r.max):Math.min(t,n)),t}function Xk(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function CY(t,{top:e,left:n,bottom:r,right:i}){return{x:Xk(t.x,n,i),y:Xk(t.y,e,r)}}function Wk(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function kY(t,e){return{x:Wk(t.x,e.x),y:Wk(t.y,e.y)}}function RY(t,e){let n=.5;const r=wr(t),i=wr(e);return i>r?n=ah(e.min,e.max-r,t.min):r>i&&(n=ah(t.min,t.max-i,e.min)),Is(0,1,n)}function NY(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const p1=.35;function DY(t=p1){return t===!1?t=0:t===!0&&(t=p1),{x:Kk(t,"left","right"),y:Kk(t,"top","bottom")}}function Kk(t,e,n){return{min:Qk(t,e),max:Qk(t,n)}}function Qk(t,e){return typeof t=="number"?t:t[e]||0}const IY=new WeakMap;class MY{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=bn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:n=!1,distanceThreshold:r}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const a=p=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Uh(p).point)},o=(p,m)=>{const{drag:b,dragPropagation:w,onDragStart:E}=this.getProps();if(b&&!w&&(this.openDragLock&&this.openDragLock(),this.openDragLock=UH(b),!this.openDragLock))return;this.latestPointerEvent=p,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),_i(T=>{let C=this.getAxisMotionValue(T).get()||0;if(Va.test(C)){const{projection:N}=this.visualElement;if(N&&N.layout){const j=N.layout.layoutBox[T];j&&(C=wr(j)*(parseFloat(C)/100))}}this.originPoint[T]=C}),E&&en.postRender(()=>E(p,m)),f1(this.visualElement,"transform");const{animationState:S}=this.visualElement;S&&S.setActive("whileDrag",!0)},c=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m;const{dragPropagation:b,dragDirectionLock:w,onDirectionLock:E,onDrag:S}=this.getProps();if(!b&&!this.openDragLock)return;const{offset:T}=m;if(w&&this.currentDirection===null){this.currentDirection=OY(T),this.currentDirection!==null&&E&&E(this.currentDirection);return}this.updateAxis("x",m.point,T),this.updateAxis("y",m.point,T),this.visualElement.render(),S&&S(p,m)},u=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m,this.stop(p,m),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>_i(p=>this.getAnimationState(p)==="paused"&&this.getAxisMotionValue(p).animation?.play()),{dragSnapToOrigin:h}=this.getProps();this.panSession=new s4(e,{onSessionStart:a,onStart:o,onMove:c,onSessionEnd:u,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,distanceThreshold:r,contextWindow:a4(this.visualElement)})}stop(e,n){const r=e||this.latestPointerEvent,i=n||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!i||!r)return;const{velocity:o}=i;this.startAnimation(o);const{onDragEnd:c}=this.getProps();c&&en.postRender(()=>c(r,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:i}=this.getProps();if(!r||!Pg(e,i,this.currentDirection))return;const a=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=AY(o,this.constraints[e],this.elastic[e])),a.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,i=this.constraints;e&&lu(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=CY(r.layoutBox,e):this.constraints=!1,this.elastic=DY(n),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&_i(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=NY(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!lu(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const a=Vq(r,i.root,this.visualElement.getTransformPagePoint());let o=kY(i.layout.layoutBox,a);if(n){const c=n(Oq(o));this.hasMutatedConstraints=!!c,c&&(o=$O(c))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:i,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:c}=this.getProps(),u=this.constraints||{},d=_i(h=>{if(!Pg(h,n,this.currentDirection))return;let p=u&&u[h]||{};o&&(p={min:0,max:0});const m=i?200:1e6,b=i?40:1e7,w={type:"inertia",velocity:r?e[h]:0,bounceStiffness:m,bounceDamping:b,timeConstant:750,restDelta:1,restSpeed:10,...a,...p};return this.startAxisValueAnimation(h,w)});return Promise.all(d).then(c)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return f1(this.visualElement,e),r.start(U_(e,r,0,n,this.visualElement,!1))}stopAnimation(){_i(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){_i(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[n];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){_i(n=>{const{drag:r}=this.getProps();if(!Pg(n,r,this.currentDirection))return;const{projection:i}=this.visualElement,a=this.getAxisMotionValue(n);if(i&&i.layout){const{min:o,max:c}=i.layout.layoutBox[n];a.set(e[n]-sn(o,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!lu(n)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};_i(o=>{const c=this.getAxisMotionValue(o);if(c&&this.constraints!==!1){const u=c.get();i[o]=RY({min:u,max:u},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),_i(o=>{if(!Pg(o,e,null))return;const c=this.getAxisMotionValue(o),{min:u,max:d}=this.constraints[o];c.set(sn(u,d,i[o]))})}addListeners(){if(!this.visualElement.current)return;IY.set(this.visualElement,this);const e=this.visualElement.current,n=Pf(e,"pointerdown",u=>{const{drag:d,dragListener:h=!0}=this.getProps();d&&h&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();lu(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,a=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),en.read(r);const o=uh(window,"resize",()=>this.scalePositionWithinConstraints()),c=i.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:d})=>{this.isDragging&&d&&(_i(h=>{const p=this.getAxisMotionValue(h);p&&(this.originPoint[h]+=u[h].translate,p.set(p.get()+u[h].translate))}),this.visualElement.render())}));return()=>{o(),n(),a(),c&&c()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:a=!1,dragElastic:o=p1,dragMomentum:c=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:i,dragConstraints:a,dragElastic:o,dragMomentum:c}}}function Pg(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function OY(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class PY extends il{constructor(e){super(e),this.removeGroupControls=Ci,this.removeListeners=Ci,this.controls=new MY(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ci}unmount(){this.removeGroupControls(),this.removeListeners()}}const Zk=t=>(e,n)=>{t&&en.postRender(()=>t(e,n))};class jY extends il{constructor(){super(...arguments),this.removePointerDownListener=Ci}onPointerDown(e){this.session=new s4(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:a4(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:Zk(e),onStart:Zk(n),onMove:r,onEnd:(a,o)=>{delete this.session,i&&en.postRender(()=>i(a,o))}}}mount(){this.removePointerDownListener=Pf(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const dm={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Jk(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const hf={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(et.test(t))t=parseFloat(t);else return t;const n=Jk(t,e.target.x),r=Jk(t,e.target.y);return`${n}% ${r}%`}},VY={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,i=Wo.parse(t);if(i.length>5)return r;const a=Wo.createTransformer(t),o=typeof i[0]!="number"?1:0,c=n.x.scale*e.x,u=n.y.scale*e.y;i[0+o]/=c,i[1+o]/=u;const d=sn(c,u,.5);return typeof i[2+o]=="number"&&(i[2+o]/=d),typeof i[3+o]=="number"&&(i[3+o]/=d),a(i)}};let Gb=!1;class zY extends B.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:i}=this.props,{projection:a}=e;lq(LY),a&&(n.group&&n.group.add(a),r&&r.register&&i&&r.register(a),Gb&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),dm.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:i,isPresent:a}=this.props,{projection:o}=r;return o&&(o.isPresent=a,Gb=!0,i||e.layoutDependency!==n||n===void 0||e.isPresent!==a?o.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?o.promote():o.relegate()||en.postRender(()=>{const c=o.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),R_.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:i}=e;Gb=!0,i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function l4(t){const[e,n]=RO(),r=B.useContext(o_);return v.jsx(zY,{...t,layoutGroup:r,switchLayoutGroup:B.useContext(UO),isPresent:e,safeToRemove:n})}const LY={borderRadius:{...hf,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:hf,borderTopRightRadius:hf,borderBottomLeftRadius:hf,borderBottomRightRadius:hf,boxShadow:VY};function BY(t,e,n){const r=dr(t)?t:Mu(t);return r.start(U_("",r,e,n)),r.animation}const UY=(t,e)=>t.depth-e.depth;class FY{constructor(){this.children=[],this.isDirty=!1}add(e){u_(this.children,e),this.isDirty=!0}remove(e){d_(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(UY),this.isDirty=!1,this.children.forEach(e)}}function $Y(t,e){const n=Vr.now(),r=({timestamp:i})=>{const a=i-n;a>=e&&(Xo(r),t(a-e))};return en.setup(r,!0),()=>Xo(r)}const c4=["TopLeft","TopRight","BottomLeft","BottomRight"],GY=c4.length,eR=t=>typeof t=="string"?parseFloat(t):t,tR=t=>typeof t=="number"||et.test(t);function HY(t,e,n,r,i,a){i?(t.opacity=sn(0,n.opacity??1,qY(r)),t.opacityExit=sn(e.opacity??1,0,YY(r))):a&&(t.opacity=sn(e.opacity??1,n.opacity??1,r));for(let o=0;o<GY;o++){const c=`border${c4[o]}Radius`;let u=nR(e,c),d=nR(n,c);if(u===void 0&&d===void 0)continue;u||(u=0),d||(d=0),u===0||d===0||tR(u)===tR(d)?(t[c]=Math.max(sn(eR(u),eR(d),r),0),(Va.test(d)||Va.test(u))&&(t[c]+="%")):t[c]=d}(e.rotate||n.rotate)&&(t.rotate=sn(e.rotate||0,n.rotate||0,r))}function nR(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const qY=u4(0,.5,WM),YY=u4(.5,.95,Ci);function u4(t,e,n){return r=>r<t?0:r>e?1:n(ah(t,e,r))}function rR(t,e){t.min=e.min,t.max=e.max}function bi(t,e){rR(t.x,e.x),rR(t.y,e.y)}function iR(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function aR(t,e,n,r,i){return t-=e,t=Ym(t,1/n,r),i!==void 0&&(t=Ym(t,1/i,r)),t}function XY(t,e=0,n=1,r=.5,i,a=t,o=t){if(Va.test(e)&&(e=parseFloat(e),e=sn(o.min,o.max,e/100)-o.min),typeof e!="number")return;let c=sn(a.min,a.max,r);t===a&&(c-=e),t.min=aR(t.min,e,n,c,i),t.max=aR(t.max,e,n,c,i)}function sR(t,e,[n,r,i],a,o){XY(t,e[n],e[r],e[i],e.scale,a,o)}const WY=["x","scaleX","originX"],KY=["y","scaleY","originY"];function oR(t,e,n,r){sR(t.x,e,WY,n?n.x:void 0,r?r.x:void 0),sR(t.y,e,KY,n?n.y:void 0,r?r.y:void 0)}function lR(t){return t.translate===0&&t.scale===1}function d4(t){return lR(t.x)&&lR(t.y)}function cR(t,e){return t.min===e.min&&t.max===e.max}function QY(t,e){return cR(t.x,e.x)&&cR(t.y,e.y)}function uR(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function f4(t,e){return uR(t.x,e.x)&&uR(t.y,e.y)}function dR(t){return wr(t.x)/wr(t.y)}function fR(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class ZY{constructor(){this.members=[]}add(e){u_(this.members,e),e.scheduleRender()}remove(e){if(d_(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(i=>e===i);if(n===0)return!1;let r;for(let i=n;i>=0;i--){const a=this.members[i];if(a.isPresent!==!1){r=a;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function JY(t,e,n){let r="";const i=t.x.translate/e.x,a=t.y.translate/e.y,o=n?.z||0;if((i||a||o)&&(r=`translate3d(${i}px, ${a}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:d,rotate:h,rotateX:p,rotateY:m,skewX:b,skewY:w}=n;d&&(r=`perspective(${d}px) ${r}`),h&&(r+=`rotate(${h}deg) `),p&&(r+=`rotateX(${p}deg) `),m&&(r+=`rotateY(${m}deg) `),b&&(r+=`skewX(${b}deg) `),w&&(r+=`skewY(${w}deg) `)}const c=t.x.scale*e.x,u=t.y.scale*e.y;return(c!==1||u!==1)&&(r+=`scale(${c}, ${u})`),r||"none"}const Hb=["","X","Y","Z"],eX=1e3;let tX=0;function qb(t,e,n,r){const{latestValues:i}=e;i[t]&&(n[t]=i[t],e.setStaticValue(t,0),r&&(r[t]=0))}function h4(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=QO(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:i,layoutId:a}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",en,!(i||a))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&h4(r)}function p4({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},c=e?.()){this.id=tX++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(iX),this.nodes.forEach(lX),this.nodes.forEach(cX),this.nodes.forEach(aX)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new FY)}addEventListener(o,c){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new p_),this.eventHandlers.get(o).add(c)}notifyListeners(o,...c){const u=this.eventHandlers.get(o);u&&u.notify(...c)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=kO(o)&&!YH(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(u||c)&&(this.isLayoutDirty=!0),t){let h,p=0;const m=()=>this.root.updateBlockedByResize=!1;en.read(()=>{p=window.innerWidth}),t(o,()=>{const b=window.innerWidth;b!==p&&(p=b,this.root.updateBlockedByResize=!0,h&&h(),h=$Y(m,250),dm.hasAnimatedSinceResize&&(dm.hasAnimatedSinceResize=!1,this.nodes.forEach(gR)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:p,hasRelativeLayoutChanged:m,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const w=this.options.transition||d.getDefaultTransition()||pX,{onLayoutAnimationStart:E,onLayoutAnimationComplete:S}=d.getProps(),T=!this.targetLayout||!f4(this.targetLayout,b),C=!p&&m;if(this.options.layoutRoot||this.resumeFrom||C||p&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const N={...C_(w,"layout"),onPlay:E,onComplete:S};(d.shouldReduceMotion||this.options.layoutRoot)&&(N.delay=0,N.type=!1),this.startAnimation(N),this.setAnimationOrigin(h,C)}else p||gR(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Xo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(uX),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&h4(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const p=this.path[h];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:c,layout:u}=this.options;if(c===void 0&&!u)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(hR);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(pR);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(oX),this.nodes.forEach(nX),this.nodes.forEach(rX)):this.nodes.forEach(pR),this.clearAllSnapshots();const c=Vr.now();tr.delta=Is(0,1e3/60,c-tr.timestamp),tr.timestamp=c,tr.isProcessing=!0,Ob.update.process(tr),Ob.preRender.process(tr),Ob.render.process(tr),tr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,R_.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(sX),this.sharedNodes.forEach(dX)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,en.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){en.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!wr(this.snapshot.measuredBox.x)&&!wr(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=bn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(c=!1),c&&this.instance){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!d4(this.projectionDelta),u=this.getTransformTemplate(),d=u?u(this.latestValues,""):void 0,h=d!==this.prevTransformTemplateValue;o&&this.instance&&(c||jl(this.latestValues)||h)&&(i(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const c=this.measurePageBox();let u=this.removeElementScroll(c);return o&&(u=this.removeTransform(u)),gX(u),{animationId:this.root.animationId,measuredBox:c,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return bn();const c=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(mX))){const{scroll:d}=this.root;d&&(cu(c.x,d.offset.x),cu(c.y,d.offset.y))}return c}removeElementScroll(o){const c=bn();if(bi(c,o),this.scroll?.wasRoot)return c;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:h,options:p}=d;d!==this.root&&h&&p.layoutScroll&&(h.wasRoot&&bi(c,o),cu(c.x,h.offset.x),cu(c.y,h.offset.y))}return c}applyTransform(o,c=!1){const u=bn();bi(u,o);for(let d=0;d<this.path.length;d++){const h=this.path[d];!c&&h.options.layoutScroll&&h.scroll&&h!==h.root&&uu(u,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),jl(h.latestValues)&&uu(u,h.latestValues)}return jl(this.latestValues)&&uu(u,this.latestValues),u}removeTransform(o){const c=bn();bi(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];if(!d.instance||!jl(d.latestValues))continue;l1(d.latestValues)&&d.updateSnapshot();const h=bn(),p=d.measurePageBox();bi(h,p),oR(c,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,h)}return jl(this.latestValues)&&oR(c,this.latestValues),c}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==tr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:p}=this.options;if(!(!this.layout||!(h||p))){if(this.resolvedRelativeTargetAt=tr.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=bn(),this.relativeTargetOrigin=bn(),Vf(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),bi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=bn(),this.targetWithTransforms=bn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),_Y(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):bi(this.target,this.layout.layoutBox),HO(this.target,this.targetDelta)):bi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=bn(),this.relativeTargetOrigin=bn(),Vf(this.relativeTargetOrigin,this.target,m.target),bi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||l1(this.parent.latestValues)||GO(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const o=this.getLead(),c=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===tr.timestamp&&(u=!1),u)return;const{layout:d,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||h))return;bi(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,m=this.treeScale.y;jq(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=bn());const{target:b}=o;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(iR(this.prevProjectionDelta.x,this.projectionDelta.x),iR(this.prevProjectionDelta.y,this.projectionDelta.y)),jf(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==m||!fR(this.projectionDelta.x,this.prevProjectionDelta.x)||!fR(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=du(),this.projectionDelta=du(),this.projectionDeltaWithTransform=du()}setAnimationOrigin(o,c=!1){const u=this.snapshot,d=u?u.latestValues:{},h={...this.latestValues},p=du();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const m=bn(),b=u?u.source:void 0,w=this.layout?this.layout.source:void 0,E=b!==w,S=this.getStack(),T=!S||S.members.length<=1,C=!!(E&&!T&&this.options.crossfade===!0&&!this.path.some(hX));this.animationProgress=0;let N;this.mixTargetDelta=j=>{const P=j/1e3;mR(p.x,o.x,P),mR(p.y,o.y,P),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Vf(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),fX(this.relativeTarget,this.relativeTargetOrigin,m,P),N&&QY(this.relativeTarget,N)&&(this.isProjectionDirty=!1),N||(N=bn()),bi(N,this.relativeTarget)),E&&(this.animationValues=h,HY(h,d,this.latestValues,P,C,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=P},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Xo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=en.update(()=>{dm.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Mu(0)),this.currentAnimation=BY(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:c=>{this.mixTargetDelta(c),o.onUpdate&&o.onUpdate(c)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(eX),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:c,target:u,layout:d,latestValues:h}=o;if(!(!c||!u||!d)){if(this!==o&&this.layout&&d&&g4(this.options.animationType,this.layout.layoutBox,d.layoutBox)){u=this.target||bn();const p=wr(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const m=wr(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+m}bi(c,u),uu(c,h),jf(this.projectionDeltaWithTransform,this.layoutCorrected,c,h)}}registerSharedNode(o,c){this.sharedNodes.has(o)||this.sharedNodes.set(o,new ZY),this.sharedNodes.get(o).add(c);const d=c.options.initialPromotionConfig;c.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(c):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:c,preserveFollowOpacity:u}={}){const d=this.getStack();d&&d.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let c=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(c=!0),!c)return;const d={};u.z&&qb("z",o,d,this.animationValues);for(let h=0;h<Hb.length;h++)qb(`rotate${Hb[h]}`,o,d,this.animationValues),qb(`skew${Hb[h]}`,o,d,this.animationValues);o.render();for(const h in d)o.setStaticValue(h,d[h]),this.animationValues&&(this.animationValues[h]=d[h]);o.scheduleRender()}applyProjectionStyles(o,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const u=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=um(c?.pointerEvents)||"",o.transform=u?u(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=um(c?.pointerEvents)||""),this.hasProjected&&!jl(this.latestValues)&&(o.transform=u?u({},""):"none",this.hasProjected=!1);return}o.visibility="";const h=d.animationValues||d.latestValues;this.applyTransformsToTarget();let p=JY(this.projectionDeltaWithTransform,this.treeScale,h);u&&(p=u(h,p)),o.transform=p;const{x:m,y:b}=this.projectionDelta;o.transformOrigin=`${m.origin*100}% ${b.origin*100}% 0`,d.animationValues?o.opacity=d===this?h.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:o.opacity=d===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const w in ch){if(h[w]===void 0)continue;const{correct:E,applyTo:S,isCSSVariable:T}=ch[w],C=p==="none"?h[w]:E(h[w],d);if(S){const N=S.length;for(let j=0;j<N;j++)o[S[j]]=C}else T?this.options.visualElement.renderState.vars[w]=C:o[w]=C}this.options.layoutId&&(o.pointerEvents=d===this?um(c?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(hR),this.root.sharedNodes.clear()}}}function nX(t){t.updateLayout()}function rX(t){const e=t.resumeFrom?.snapshot||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:r}=t.layout,{animationType:i}=t.options,a=e.source!==t.layout.source;i==="size"?_i(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=wr(p);p.min=n[h].min,p.max=p.min+m}):g4(i,e.layoutBox,n)&&_i(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=wr(n[h]);p.max=p.min+m,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+m)});const o=du();jf(o,n,e.layoutBox);const c=du();a?jf(c,t.applyTransform(r,!0),e.measuredBox):jf(c,n,e.layoutBox);const u=!d4(o);let d=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:p,layout:m}=h;if(p&&m){const b=bn();Vf(b,e.layoutBox,p.layoutBox);const w=bn();Vf(w,n,m.layoutBox),f4(b,w)||(d=!0),h.options.layoutRoot&&(t.relativeTarget=w,t.relativeTargetOrigin=b,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:e,delta:c,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function iX(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function aX(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function sX(t){t.clearSnapshot()}function hR(t){t.clearMeasurements()}function pR(t){t.isLayoutDirty=!1}function oX(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function gR(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function lX(t){t.resolveTargetDelta()}function cX(t){t.calcProjection()}function uX(t){t.resetSkewAndRotation()}function dX(t){t.removeLeadSnapshot()}function mR(t,e,n){t.translate=sn(e.translate,0,n),t.scale=sn(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function vR(t,e,n,r){t.min=sn(e.min,n.min,r),t.max=sn(e.max,n.max,r)}function fX(t,e,n,r){vR(t.x,e.x,n.x,r),vR(t.y,e.y,n.y,r)}function hX(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const pX={duration:.45,ease:[.4,0,.1,1]},yR=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),bR=yR("applewebkit/")&&!yR("chrome/")?Math.round:Ci;function xR(t){t.min=bR(t.min),t.max=bR(t.max)}function gX(t){xR(t.x),xR(t.y)}function g4(t,e,n){return t==="position"||t==="preserve-aspect"&&!wY(dR(e),dR(n),.2)}function mX(t){return t!==t.root&&t.scroll?.wasRoot}const vX=p4({attachResizeListener:(t,e)=>uh(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Yb={current:void 0},m4=p4({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Yb.current){const t=new vX({});t.mount(window),t.setOptions({layoutScroll:!0}),Yb.current=t}return Yb.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),yX={pan:{Feature:jY},drag:{Feature:PY,ProjectionNode:m4,MeasureLayout:l4}};function wR(t,e,n){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",n==="Start");const i="onHover"+n,a=r[i];a&&en.postRender(()=>a(e,Uh(e)))}class bX extends il{mount(){const{current:e}=this.node;e&&(this.unmount=FH(e,(n,r)=>(wR(this.node,r,"Start"),i=>wR(this.node,i,"End"))))}unmount(){}}class xX extends il{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=zh(uh(this.node.current,"focus",()=>this.onFocus()),uh(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function _R(t,e,n){const{props:r}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",n==="Start");const i="onTap"+(n==="End"?"":n),a=r[i];a&&en.postRender(()=>a(e,Uh(e)))}class wX extends il{mount(){const{current:e}=this.node;e&&(this.unmount=qH(e,(n,r)=>(_R(this.node,r,"Start"),(i,{success:a})=>_R(this.node,i,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const g1=new WeakMap,Xb=new WeakMap,_X=t=>{const e=g1.get(t.target);e&&e(t)},EX=t=>{t.forEach(_X)};function SX({root:t,...e}){const n=t||document;Xb.has(n)||Xb.set(n,{});const r=Xb.get(n),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(EX,{root:t,...e})),r[i]}function TX(t,e,n){const r=SX(e);return g1.set(t,n),r.observe(t),()=>{g1.delete(t),r.unobserve(t)}}const AX={some:0,all:1};class CX extends il{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:i="some",once:a}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:AX[i]},c=u=>{const{isIntersecting:d}=u;if(this.isInView===d||(this.isInView=d,a&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:h,onViewportLeave:p}=this.node.getProps(),m=d?h:p;m&&m(u)};return TX(this.node.current,o,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(kX(e,n))&&this.startObserver()}unmount(){}}function kX({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const RX={inView:{Feature:CX},tap:{Feature:wX},focus:{Feature:xX},hover:{Feature:bX}},NX={layout:{ProjectionNode:m4,MeasureLayout:l4}},DX={...gY,...RX,...yX,...NX},gn=Mq(DX,qq);function IX(t){t.values.forEach(e=>e.stop())}function m1(t,e){[...e].reverse().forEach(r=>{const i=t.getVariant(r);i&&B_(t,i),t.variantChildren&&t.variantChildren.forEach(a=>{m1(a,e)})})}function MX(t,e){if(Array.isArray(e))return m1(t,e);if(typeof e=="string")return m1(t,[e]);B_(t,e)}function OX(){const t=new Set,e={subscribe(n){return t.add(n),()=>void t.delete(n)},start(n,r){const i=[];return t.forEach(a=>{i.push(e4(a,n,{transitionOverride:r}))}),Promise.all(i)},set(n){return t.forEach(r=>{MX(r,n)})},stop(){t.forEach(n=>{IX(n)})},mount(){return()=>{e.stop()}}};return e}function PX(){const t=G0(OX);return c_(t.mount,[]),t}const jX=PX,cc=gw((t,e)=>({message:"",type:"neutral",isVisible:!1,undoAction:void 0,showToast:(n,r="neutral",i)=>{t({message:n,type:r,isVisible:!0,undoAction:i}),setTimeout(()=>{e().hideToast()},2e3)},hideToast:()=>{t({isVisible:!1})}})),VX=()=>{const{message:t,type:e,isVisible:n,undoAction:r,hideToast:i}=cc(),a=()=>{switch(e){case"success":return"bg-green-500 dark:bg-green-600 text-white";case"error":return"bg-red-500 dark:bg-red-600 text-white";case"neutral":default:return"bg-gray-800 dark:bg-gray-900 text-white border border-gray-200 dark:border-gray-700"}};return v.jsx(ai,{children:n&&v.jsx(gn.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-24 right-6 z-[110] max-w-xs",children:v.jsxs("div",{className:`rounded-lg shadow-lg p-3 flex items-center justify-between ${a()}`,children:[v.jsx("div",{className:"flex items-center flex-1 min-w-0",children:v.jsx("span",{className:"text-xs font-medium whitespace-pre-line pr-2",children:t})}),v.jsxs("div",{className:"flex items-center gap-1 ml-2 flex-shrink-0",children:[r&&v.jsxs("button",{onClick:()=>{r(),i()},className:"px-2 py-1 bg-white/20 hover:bg-white/30 rounded text-xs font-bold transition-colors",children:[v.jsx(PU,{size:12,className:"inline mr-1"}),"Undo"]}),v.jsx("button",{onClick:i,className:"p-0.5 hover:bg-black/10 dark:hover:bg-white/10 rounded-full transition-colors",children:v.jsx(w0,{size:14})})]})]})})})};class Ei extends B.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("ErrorBoundary caught an error:",e,n),this.setState({error:e,errorInfo:n}),this.props.onError&&this.props.onError(e,n)}componentDidUpdate(e){this.props.resetKeys&&this.props.resetOnPropsChange&&this.props.resetKeys.some((r,i)=>r!==e.resetKeys?.[i])&&this.state.hasError&&this.resetErrorBoundary()}resetErrorBoundary=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[v.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 dark:bg-red-900/30 rounded-full",children:v.jsx(wu,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white text-center mb-2",children:"Something went wrong"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-6",children:"We're sorry, but something unexpected happened. You can try refreshing or going back to the home screen."}),!1,v.jsxs("div",{className:"flex flex-col gap-3",children:[v.jsxs("button",{onClick:this.resetErrorBoundary,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors",children:[v.jsx(Wf,{className:"h-4 w-4"}),"Try Again"]}),v.jsxs("button",{onClick:()=>window.location.href="/#/",className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white font-medium rounded-md transition-colors",children:[v.jsx(rU,{className:"h-4 w-4"}),"Go to Home"]})]})]})}):this.props.children}}const zX=({onAddTransaction:t})=>{const e=qa(),n=aa(),[r,i]=B.useState(!1),a=B.useRef(null),o=d=>n.pathname===d;B.useEffect(()=>{const d=h=>{a.current&&!a.current.contains(h.target)&&i(!1)};if(r)return document.addEventListener("mousedown",d),document.addEventListener("touchstart",d),()=>{document.removeEventListener("mousedown",d),document.removeEventListener("touchstart",d)}},[r]);const c=[{path:"/reports",icon:v.jsx(kB,{className:"w-5 h-5"}),label:"Reports"},{path:"/analytics",icon:v.jsx(Rm,{className:"w-5 h-5"}),label:"Analytics"},{path:"/budget-breakdown",icon:v.jsx(NB,{className:"w-5 h-5"}),label:"Budget Breakdown"}],u=({path:d,icon:h,label:p})=>{const m=o(d);return v.jsxs("button",{onClick:b=>{b.stopPropagation(),e(d)},className:`
          relative group flex flex-col items-center justify-center
          w-12 h-12 rounded-2xl transition-all duration-300
          ${m?"text-blue-500 bg-blue-50 dark:bg-blue-500/20 dark:text-blue-400":"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-800"}
        `,children:[v.jsx("div",{className:`transition-transform duration-300 ${m?"scale-110":"group-hover:scale-105"}`,children:h}),v.jsx("span",{className:"sr-only",children:p}),m&&v.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-current rounded-full opacity-80"})]})};return v.jsx("div",{className:"fixed bottom-6 left-0 right-0 flex justify-center z-[100] pointer-events-none safe-area-inset-bottom",children:v.jsxs("nav",{className:`
          pointer-events-auto
          flex items-center gap-1 p-2 pl-4 pr-4
          bg-white/60 dark:bg-zinc-900/60 backdrop-blur-xl
          border border-zinc-200/30 dark:border-zinc-800/30
          rounded-full shadow-2xl shadow-zinc-900/10
          transform transition-all duration-500 ease-out
        `,onClick:d=>d.stopPropagation(),onTouchStart:d=>d.stopPropagation(),onTouchEnd:d=>d.stopPropagation(),children:[v.jsx(u,{path:"/",label:"Budget",icon:v.jsx(x0,{className:"w-6 h-6"})}),v.jsx(u,{path:"/transactions",label:"Transactions",icon:v.jsx(aU,{className:"w-6 h-6"})}),v.jsx("div",{className:"w-px h-8 bg-zinc-200 dark:bg-zinc-800 mx-2"}),v.jsx("button",{onClick:d=>{if(d.stopPropagation(),i(!1),t){t();return}e("/add-transaction")},className:`
            -mt-8 mb-2 mx-1
            group relative flex items-center justify-center
            w-16 h-16 rounded-full
            bg-blue-600 text-white
            shadow-xl shadow-blue-600/30
            hover:shadow-blue-600/50 hover:scale-105 hover:-translate-y-1
            active:scale-95 active:translate-y-0
            transition-all duration-300 cubic-bezier(0.175, 0.885, 0.32, 1.275)
          `,children:v.jsx(Ch,{className:"w-8 h-8 transition-transform duration-300 group-hover:rotate-90"})}),v.jsx("div",{className:"w-px h-8 bg-zinc-200 dark:bg-zinc-800 mx-2"}),v.jsxs("div",{className:"relative",ref:a,children:[v.jsxs("button",{onClick:d=>{d.stopPropagation(),i(!r)},className:`
              relative group flex flex-col items-center justify-center
              w-12 h-12 rounded-2xl transition-all duration-300
              ${r?"text-blue-500 bg-blue-50 dark:bg-blue-500/20 dark:text-blue-400":"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-800"}
            `,children:[v.jsx("div",{className:`transition-transform duration-300 ${r?"scale-110":"group-hover:scale-105"}`,children:v.jsx(qB,{className:"w-6 h-6"})}),v.jsx("span",{className:"sr-only",children:"More"}),r&&v.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-current rounded-full opacity-80"})]}),r&&v.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-56 bg-white dark:bg-zinc-900 rounded-2xl shadow-2xl border border-zinc-200/50 dark:border-zinc-800/50 backdrop-blur-xl z-50 overflow-hidden",onClick:d=>d.stopPropagation(),onTouchStart:d=>d.stopPropagation(),onTouchEnd:d=>d.stopPropagation(),children:v.jsx("div",{className:"p-2 space-y-1",children:c.map((d,h)=>v.jsxs("button",{onClick:p=>{p.stopPropagation(),e(d.path),i(!1)},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[v.jsx("div",{className:"text-zinc-600 dark:text-zinc-400",children:d.icon}),v.jsx("span",{className:"text-sm font-medium text-zinc-900 dark:text-white",children:d.label})]},h))})})]}),v.jsx(u,{path:"/settings",label:"Settings",icon:v.jsx(SU,{className:"w-6 h-6"})})]})})};function LX(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.map(function(r){return r.split(" ").map(function(i){return i?""+t+i:""}).join(" ")}).join(" ")}function BX(t,e){return e.replace(/([^}{]*){/gm,function(n,r){return r.replace(/\.([^{,\s\d.]+)/g,"."+t+"$1")+"{"})}function Es(t,e){return function(n){n&&(t[e]=n)}}function v4(t,e,n){return function(r){r&&(t[e][n]=r)}}function ER(t,e){return function(n){var r=n.prototype;t.forEach(function(i){e(r,i)})}}function UX(t,e){return e===void 0&&(e={}),function(n,r){t.forEach(function(i){var a=e[i]||i;a in n||(n[a]=function(){for(var o,c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];var d=(o=this[r])[i].apply(o,c);return d===this[r]?this:d})})}}var FX="function",$X="object",GX="string",HX="number",F_="undefined",y4=typeof window!==F_,qX=typeof document!==F_&&document,YX=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],Pn=1e-7,jg={cm:function(t){return t*96/2.54},mm:function(t){return t*96/254},in:function(t){return t*96},pt:function(t){return t*96/72},pc:function(t){return t*96/6},"%":function(t,e){return t*e/100},vw:function(t,e){return e===void 0&&(e=window.innerWidth),t/100*e},vh:function(t,e){return e===void 0&&(e=window.innerHeight),t/100*e},vmax:function(t,e){return e===void 0&&(e=Math.max(window.innerWidth,window.innerHeight)),t/100*e},vmin:function(t,e){return e===void 0&&(e=Math.min(window.innerWidth,window.innerHeight)),t/100*e}};function XX(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}function Xm(t,e,n,r){return(t*r+e*n)/(n+r)}function W0(t){return typeof t===F_}function na(t){return t&&typeof t===$X}function Vn(t){return Array.isArray(t)}function Lr(t){return typeof t===GX}function Pu(t){return typeof t===HX}function $_(t){return typeof t===FX}function WX(t,e){var n=t===""||t==" ",r=e===""||e==" ";return r&&n||t===e}function b4(t,e,n,r,i){var a=G_(t,e,n);return a?n:KX(t,e,n+1,r,i)}function G_(t,e,n){if(!t.ignore)return null;var r=e.slice(Math.max(n-3,0),n+3).join("");return new RegExp(t.ignore).exec(r)}function KX(t,e,n,r,i){for(var a=function(d){var h=e[d].trim();if(h===t.close&&!G_(t,e,d))return{value:d};var p=d,m=Br(i,function(b){var w=b.open;return w===h});if(m&&(p=b4(m,e,d,r,i)),p===-1)return o=d,"break";d=p,o=d},o,c=n;c<r;++c){var u=a(c);if(c=o,typeof u=="object")return u.value;if(u==="break")break}return-1}function H_(t,e){var n=Lr(e)?{separator:e}:e,r=n.separator,i=r===void 0?",":r,a=n.isSeparateFirst,o=n.isSeparateOnlyOpenClose,c=n.isSeparateOpenClose,u=c===void 0?o:c,d=n.openCloseCharacters,h=d===void 0?YX:d,p=h.map(function(A){var k=A.open,D=A.close;return k===D?k:k+"|"+D}).join("|"),m="(\\s*"+i+"\\s*|"+p+"|\\s+)",b=new RegExp(m,"g"),w=t.split(b).filter(function(A){return A&&A!=="undefined"}),E=w.length,S=[],T=[];function C(){return T.length?(S.push(T.join("")),T=[],!0):!1}for(var N=function(A){var k=w[A].trim(),D=A,V=Br(h,function(O){var J=O.open;return J===k}),L=Br(h,function(O){var J=O.close;return J===k});if(V){if(D=b4(V,w,A,E,h),D!==-1&&u)return C()&&a||(S.push(w.slice(A,D+1).join("")),A=D,a)?(j=A,"break"):(j=A,"continue")}else if(L&&!G_(L,w,A)){var U=XX(h);return U.splice(h.indexOf(L),1),{value:H_(t,{separator:i,isSeparateFirst:a,isSeparateOnlyOpenClose:o,isSeparateOpenClose:u,openCloseCharacters:U})}}else if(WX(k,i)&&!o)return C(),a?(j=A,"break"):(j=A,"continue");D===-1&&(D=E-1),T.push(w.slice(A,D+1).join("")),A=D,j=A},j,P=0;P<E;++P){var M=N(P);if(P=j,typeof M=="object")return M.value;if(M==="break")break}return T.length&&S.push(T.join("")),S}function Ko(t){return H_(t,"")}function Hl(t){return H_(t,",")}function x4(t){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(t);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function Fh(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var n=e[1],r=e[2],i=e[3];return{prefix:n,unit:i,value:parseFloat(r)}}function QX(t){return t.replace(/[\s-_]+([^\s-_])/g,function(e,n){return n.toUpperCase()})}function fm(t,e){return t.replace(/([a-z])([A-Z])/g,function(n,r,i){return""+r+e+i.toLowerCase()})}function dh(){return Date.now?Date.now():new Date().getTime()}function Os(t,e,n){n===void 0&&(n=-1);for(var r=t.length,i=0;i<r;++i)if(e(t[i],i,t))return i;return n}function Br(t,e,n){var r=Os(t,e);return r>-1?t[r]:n}var w4=(function(){var t=dh(),e=y4&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(n){var r=dh(),i=setTimeout(function(){n(r-t)},1e3/60);return i}})(),ZX=(function(){var t=y4&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return t?t.bind(window):function(e){clearTimeout(e)}})();function Ps(t){return Object.keys(t)}function JX(t){var e=Ps(t);return e.map(function(n){return t[n]})}function $t(t,e){var n=Fh(t),r=n.value,i=n.unit;if(na(e)){var a=e[i];if(a){if($_(a))return a(r);if(jg[i])return jg[i](r,a)}}else if(i==="%")return r*e/100;return jg[i]?jg[i](r):r}function v1(t,e,n){return Math.max(e,Math.min(t,n))}function SR(t,e,n,r){return r===void 0&&(r=t[0]/t[1]),[[rt(e[0],Pn),rt(e[0]/r,Pn)],[rt(e[1]*r,Pn),rt(e[1],Pn)]].filter(function(i){return i.every(function(a,o){var c=e[o],u=rt(c,Pn);return n?a<=c||a<=u:a>=c||a>=u})})[0]||t}function _4(t,e,n,r){if(!r)return t.map(function(b,w){return v1(b,e[w],n[w])});var i=t[0],a=t[1],o=r===!0?i/a:r,c=SR(t,e,!1,o),u=c[0],d=c[1],h=SR(t,n,!0,o),p=h[0],m=h[1];return i<u||a<d?(i=u,a=d):(i>p||a>m)&&(i=p,a=m),[i,a]}function eW(t){for(var e=t.length,n=0,r=e-1;r>=0;--r)n+=t[r];return n}function y1(t){for(var e=t.length,n=0,r=e-1;r>=0;--r)n+=t[r];return e?n/e:0}function wn(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=Math.atan2(r,n);return i>=0?i:i+Math.PI*2}function tW(t){return[0,1].map(function(e){return y1(t.map(function(n){return n[e]}))})}function TR(t){var e=tW(t),n=wn(e,t[0]),r=wn(e,t[1]);return n<r&&r-n<Math.PI||n>r&&r-n<-Math.PI?1:-1}function Ss(t,e){return Math.sqrt(Math.pow((e?e[0]:0)-t[0],2)+Math.pow((e?e[1]:0)-t[1],2))}function rt(t,e){if(!e)return t;var n=1/e;return Math.round(t/e)/n}function AR(t,e){return t.forEach(function(n,r){t[r]=rt(t[r],e)}),t}function nW(t){for(var e=[],n=0;n<t;++n)e.push(n);return e}function E4(t){return t.reduce(function(e,n){return e.concat(n)},[])}function S4(t,e){t.indexOf(e)===-1&&t.push(e)}function Un(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function T4(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function A4(t,e){if(t.classList)t.classList.remove(e);else{var n=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(n," ")}}function er(t,e,n,r){t.addEventListener(e,n,r)}function Ln(t,e,n,r){t.removeEventListener(e,n,r)}function ad(t){return t?.ownerDocument||qX}function q_(t){return ad(t).documentElement}function al(t){return ad(t).body}function zo(t){var e;return((e=t?.ownerDocument)===null||e===void 0?void 0:e.defaultView)||window}function C4(t){return t&&"postMessage"in t&&"blur"in t&&"self"in t}function sd(t){return na(t)&&t.nodeName&&t.nodeType&&"ownerDocument"in t}var rW=(function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(n){return this.values[this.keys.indexOf(n)]},e.set=function(n,r){var i=this.keys,a=this.values,o=i.indexOf(n),c=o===-1?i.length:o;i[c]=n,a[c]=r},t})(),iW=(function(){function t(){this.object={}}var e=t.prototype;return e.get=function(n){return this.object[n]},e.set=function(n,r){this.object[n]=r},t})(),aW=typeof Map=="function",sW=(function(){function t(){}var e=t.prototype;return e.connect=function(n,r){this.prev=n,this.next=r,n&&(n.next=this),r&&(r.prev=this)},e.disconnect=function(){var n=this.prev,r=this.next;n&&(n.next=r),r&&(r.prev=n)},e.getIndex=function(){for(var n=this,r=-1;n;)n=n.prev,++r;return r},t})();function oW(t,e){var n=[],r=[];return t.forEach(function(i){var a=i[0],o=i[1],c=new sW;n[a]=c,r[o]=c}),n.forEach(function(i,a){i.connect(n[a-1])}),t.filter(function(i,a){return!e[a]}).map(function(i,a){var o=i[0],c=i[1];if(o===c)return[0,0];var u=n[o],d=r[c-1],h=u.getIndex();u.disconnect(),d?u.connect(d,d.next):u.connect(void 0,n[0]);var p=u.getIndex();return[h,p]})}var lW=(function(){function t(n,r,i,a,o,c,u,d){this.prevList=n,this.list=r,this.added=i,this.removed=a,this.changed=o,this.maintained=c,this.changedBeforeAdded=u,this.fixed=d}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var n=oW(this.changedBeforeAdded,this.fixed),r=this.changed,i=[];this.cacheOrdered=n.filter(function(a,o){var c=a[0],u=a[1],d=r[o],h=d[0],p=d[1];if(c!==u)return i.push([h,p]),!0}),this.cachePureChanged=i},t})();function $h(t,e,n){var r=aW?Map:n?iW:rW,i=n||function(C){return C},a=[],o=[],c=[],u=t.map(i),d=e.map(i),h=new r,p=new r,m=[],b=[],w={},E=[],S=0,T=0;return u.forEach(function(C,N){h.set(C,N)}),d.forEach(function(C,N){p.set(C,N)}),u.forEach(function(C,N){var j=p.get(C);typeof j>"u"?(++T,o.push(N)):w[j]=T}),d.forEach(function(C,N){var j=h.get(C);typeof j>"u"?(a.push(N),++S):(c.push([j,N]),T=w[N]||0,m.push([j-T,N-S]),b.push(N===j),j!==N&&E.push([j,N]))}),o.reverse(),new lW(t,e,a,o,E,c,m,b)}var cW=(function(){function t(n,r){n===void 0&&(n=[]),this.findKeyCallback=r,this.list=[].slice.call(n)}var e=t.prototype;return e.update=function(n){var r=[].slice.call(n),i=$h(this.list,r,this.findKeyCallback);return this.list=r,i},t})(),b1=function(t,e){return b1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},b1(t,e)};function Gh(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");b1(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var ka=function(){return ka=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ka.apply(this,arguments)};function k4(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function CR(t,e,n){for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return t.concat(a||Array.prototype.slice.call(e))}function kR(t){var e=0;return t.map(function(n){return n==null?"$compat".concat(++e):"".concat(n)})}function R4(t){var e=[];return t.forEach(function(n){e=e.concat(Vn(n)?R4(n):n)}),e}function Wb(t,e){if(!e)return t;for(var n in e)W0(t[n])&&(t[n]=e[n]);return t}function Wm(t,e){if(t===e)return!1;for(var n in t)if(!(n in e))return!0;for(var n in e)if(t[n]!==e[n])return!0;return!1}function RR(t){var e=t.className,n=k4(t,["className"]);return e!=null&&(n.class=e),delete n.style,delete n.children,n}function NR(t){var e={},n={};for(var r in t)r.indexOf("on")===0?n[r]=t[r]:e[r]=t[r];return[e,n]}function K0(t){if(!t)return null;var e=t.b;return sd(e)?e:K0(t.c)}function N4(t){var e=t.parentNode;e&&e.removeChild(t)}function D4(t){t.forEach(function(e){e()})}function uW(){return this.constructor(this.props,this.context)}var Y_=0,Q0=(function(){function t(n,r,i,a,o,c,u){u===void 0&&(u={}),this.t=n,this.d=r,this.k=i,this.i=a,this.c=o,this.ref=c,this.ps=u,this.typ="prov",this._ps=[],this._cs={},this._hyd=null,this._sel=!1}var e=t.prototype;return e.s=function(){return!0},e.u=function(n,r,i,a,o){var c=this,u=c.d,d=JX(r).filter(function(w){return w.$_req}),h=R4(d.map(function(w){return w.$_subs})),p=Br(h,function(w){return w.d===u});if(c.b&&!Lr(i)&&!o&&!c.s(i.props,a)&&!p){var m=h.reduce(function(w,E){var S=E.d;return w[0]?w[0].d===S&&w.push(E):S>u&&w.push(E),w},[]);return m.forEach(function(w){Hh(w,w._ps,[w.o],n,r,!0)}),!1}c.o=i,c.ss(a);var b=c.ps;return Lr(i)||(c.ps=i.props,c.ref=i.ref),X_(this),c.r(n,r,c.b?b:{},a),!0},e.md=function(){this.rr()},e.ss=function(){},e.ud=function(){this.rr()},e.rr=function(){var n=this,r=n.ref,i=n.fr;r&&r(i?i.current:n.b)},t})();function I4(){return Object.__CROACT_CURRENT_INSTNACE__}function dW(){return Y_}function fW(t){Y_=t}function X_(t){return Object.__CROACT_CURRENT_INSTNACE__=t,Y_=0,t}var W_=(function(){function t(n,r){n===void 0&&(n={}),this.props=n,this.context=r,this.state={},this.$_timer=0,this.$_state={},this.$_subs=[],this.$_cs={}}var e=t.prototype;return e.render=function(){return null},e.shouldComponentUpdate=function(n,r){return this.props!==n||this.state!==r},e.setState=function(n,r,i){var a=this;a.$_timer||(a.$_state={}),clearTimeout(a.$_timer),a.$_timer=0,a.$_state=ka(ka({},a.$_state),n),i?a.$_setState(r,i):a.$_timer=window.setTimeout(function(){a.$_timer=0,a.$_setState(r,i)})},e.forceUpdate=function(n){this.setState({},n,!0)},e.componentDidMount=function(){},e.componentDidUpdate=function(n,r){},e.componentWillUnmount=function(){},e.$_setState=function(n,r){var i=[],a=this.$_p,o=Hh(a.c,[a],[a.o],i,a._cs,ka(ka({},this.state),this.$_state),r);o&&(n&&i.push(n),D4(i),X_(null))},t})(),M4=(function(t){Gh(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}var n=e.prototype;return n.shouldComponentUpdate=function(r,i){return Wm(this.props,r)||Wm(this.state,i)},e})(W_);function O4(t){var e=function(n){e.current=n};return e.current=t,e}function hW(t){return t._fr=!0,t}function pW(t,e,n,r){var i,a;return!((i=t?.prototype)===null||i===void 0)&&i.render?a=new t(e,n):(a=new W_(e,n),a.constructor=t,t._fr?(r.fr=O4(),a.render=function(){return this.constructor(this.props,r.fr)}):a.render=uW),a.$_p=r,a}var gW=(function(t){Gh(e,t);function e(r,i,a,o,c,u,d){d===void 0&&(d={});var h=t.call(this,r,i,a,o,c,u,Wb(d,r.defaultProps))||this;return h.typ="comp",h._usefs=[],h._uefs=[],h._defs=[],h}var n=e.prototype;return n.s=function(r,i){var a=this.b;return a.shouldComponentUpdate(Wb(r,this.t.defaultProps),i||a.state)!==!1},n.r=function(r,i,a){var o,c,u=this,d=u.t;u.ps=Wb(u.ps,u.t.defaultProps);var h=u.ps,p=!u.b,m=d.contextType,b=u.b,w=m?.get(u);u._cs=i,p?(b=pW(d,h,w,u),u.b=b):(b.props=h,b.context=w);var E=b.state;u._usefs=[],u._uefs=[];var S=b.render();((c=(o=S?.props)===null||o===void 0?void 0:o.children)===null||c===void 0?void 0:c.length)===0&&(S.props.children=u.ps.children);var T=ka(ka({},i),b.$_cs);Hh(u,u._ps,S?[S]:[],r,T),p?u._uefs.push(function(){m?.register(u),b.componentDidMount()}):u._uefs.push(function(){b.componentDidUpdate(a,E)}),r.push(function(){u._usefs.forEach(function(C){C()}),p?u.md():u.ud(),u._defs=u._uefs.map(function(C){return C()})})},n.ss=function(r){var i=this.b;!i||!r||(i.state=r)},n.un=function(){var r,i=this;i._ps.forEach(function(o){o.un()});var a=i.t;(r=a.contextType)===null||r===void 0||r.unregister(i),clearTimeout(i.b.$_timer),i._defs.forEach(function(o){o&&o()}),i.b.componentWillUnmount()},e})(Q0);function mW(t,e,n){var r=K_(RR(t),RR(e)),i=r.added,a=r.removed,o=r.changed;for(var c in i)n.setAttribute(c,i[c]);for(var u in o)n.setAttribute(u,o[u][1]);for(var d in a)n.removeAttribute(d)}function vW(t,e,n){var r=K_(t,e),i=r.added,a=r.removed;for(var o in a)n.e(o,!0);for(var c in i)n.e(c)}function K_(t,e){var n=Ps(t),r=Ps(e),i=$h(n,r,function(u){return u}),a={},o={},c={};return i.added.forEach(function(u){var d=r[u];a[d]=e[d]}),i.removed.forEach(function(u){var d=n[u];o[d]=t[d]}),i.maintained.forEach(function(u){var d=u[0],h=n[d],p=[t[h],e[h]];t[h]!==e[h]&&(c[h]=p)}),{added:a,removed:o,changed:c}}function yW(t,e,n){var r=n.style,i=K_(t,e),a=i.added,o=i.removed,c=i.changed;for(var u in a){var d=fm(u,"-");r.setProperty(d,a[u])}for(var u in c){var h=fm(u,"-");r.setProperty(h,c[u][1])}for(var u in o){var p=fm(u,"-");r.removeProperty(p)}}function bW(t){return t.replace(/^on/g,"").toLowerCase()}var xW=(function(t){Gh(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.typ="elem",r._es={},r._svg=!1,r}var n=e.prototype;return n.e=function(r,i){var a=this,o=a._es,c=a.b,u=bW(r);i?(Ln(c,u,o[r]),delete o[r]):(o[r]=function(d){var h,p;(p=(h=a.ps)[r])===null||p===void 0||p.call(h,d)},er(c,u,o[r]))},n.s=function(r){return Wm(this.ps,r)},n.r=function(r,i,a){var o,c=this,u=!c.b,d=c.ps;if(u){var h=K0(c.c),p=!1;c._svg||c.t==="svg"?p=!0:p=h&&h.ownerSVGElement,c._svg=p;var m=(o=c._hyd)===null||o===void 0?void 0:o.splice(0,1)[0],b=c.t;if(m)c._hyd=[].slice.call(m.children||[]);else{var w=ad(h);p?m=w.createElementNS("http://www.w3.org/2000/svg",b):m=w.createElement(b)}c.b=m}Hh(c,c._ps,d.children,r,i);var E=c.b,S=NR(a),T=S[0],C=S[1],N=NR(d),j=N[0],P=N[1];return mW(T,j,E),vW(C,P,c),yW(a.style||{},d.style||{},E),r.push(function(){u?c.md():c.ud()}),!0},n.un=function(){var r=this,i=r._es,a=r.b;for(var o in i)Ln(a,o,i[o]);r._ps.forEach(function(c){c.un()}),r._es={},r._sel||N4(a)},e})(Q0);function fh(t){if(!t||sd(t))return t;var e=t.$_p._ps;return e.length?fh(e[0].b):null}function P4(t){if(t){if(t.b&&sd(t.b))return t;var e=t._ps;return e.length?P4(e[0]):null}}function Ki(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=e||{},a=i.key,o=i.ref,c=k4(i,["key","ref"]);return{type:t,key:a,ref:o,props:ka(ka({},c),{children:E4(n).filter(function(u){return u!=null&&u!==!1})})}}var j4=(function(t){Gh(e,t);function e(r,i){i===void 0&&(i=0);var a=t.call(this,"container",i,"container",0,null)||this;return a.typ="container",a.b=r,a}var n=e.prototype;return n.r=function(){return!0},n.un=function(){},e})(Q0),wW=(function(t){Gh(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.typ="text",r}var n=e.prototype;return n.r=function(r){var i,a=this,o=!a.b;if(o){var c=K0(a.c),u=(i=a._hyd)===null||i===void 0?void 0:i.splice(0,1)[0];a.b=u||ad(c).createTextNode(a.t.replace("text_",""))}return r.push(function(){o?a.md():a.ud()}),!0},n.un=function(){N4(this.b)},e})(Q0);function _W(t,e,n){var r=n.map(function(u){return Lr(u)?null:u.key}),i=kR(e.map(function(u){return u.k})),a=kR(r),o=$h(i,a,function(u){return u});o.removed.forEach(function(u){e.splice(u,1)[0].un()}),o.ordered.forEach(function(u){var d=u[0],h=u[1],p=e.splice(d,1)[0];e.splice(h,0,p);var m=fh(p.b),b=fh(e[h+1]&&e[h+1].b);m&&m.parentNode.insertBefore(m,b)}),o.added.forEach(function(u){e.splice(u,0,DR(n[u],r[u],u,t))});var c=o.maintained.filter(function(u){u[0];var d=u[1],h=n[d],p=e[d],m=Lr(h)?"text_".concat(h):h.type;return m!==p.t?(p.un(),e.splice(d,1,DR(h,r[d],d,t)),!0):(p.i=d,!1)});return CR(CR([],o.added,!0),c.map(function(u){u[0];var d=u[1];return d}))}function EW(t,e){for(var n=t._ps,r=n.length,i=e.i+1;i<r;++i){var a=fh(n[i].b);if(a)return a}return null}function DR(t,e,n,r){var i=r.d+1;if(Lr(t)||Pu(t))return new wW("text_".concat(t),i,e,n,r,null,{});var a=t.type,o=typeof a=="string"?xW:gW;return new o(a,i,e,n,r,t.ref,t.props)}function Hh(t,e,n,r,i,a,o){var c=_W(t,e,n),u=t._hyd,d=e.filter(function(p,m){return p._hyd=u,p.u(r,i,n[m],a,o)});t.typ==="container"&&t._sel&&e.forEach(function(p){var m=P4(p);m&&(m._sel=!0)}),t._hyd=null;var h=K0(t);return h&&c.reverse().forEach(function(p){var m=e[p],b=fh(m.b);if(b&&h!==b&&!b.parentNode){var w=EW(t,m);h.insertBefore(b,w)}}),d.length>0}function SW(t,e,n,r){n===void 0&&(n=e.__CROACT__),r===void 0&&(r={});var i=!!n;n||(n=new j4(e));var a=[];return Hh(n,n._ps,t?[t]:[],a,r,void 0,void 0),D4(a),X_(null),i||(e.__CROACT__=n),n}function IR(t,e,n){return!n&&t&&(n=new j4(e.parentElement),n._hyd=[e],n._sel=!0),SW(t,e,n),n}function V4(t){var e=I4(),n=e._hs||(e._hs=[]),r=dW(),i=n[r];if(fW(r+1),i){if(!Wm(i.deps,t.deps))return i.updated=!1,i;n[r]=t}else n.push(t);return t.value=t.func(),t.updated=!0,t}function TW(t,e){var n=V4({func:t,deps:e});return n.value}function AW(t){return TW(function(){return O4(t)},[])}function z4(t,e,n){var r=I4(),i=V4({func:function(){return t},deps:e}),a=n?r._usefs:r._uefs;i.updated?a.push(function(){return i.effect&&i.effect(),i.effect=t(),i.effect}):a.push(function(){return i.effect})}function CW(t,e,n){z4(function(){t?.(e())},n,!0)}function Q_(t,e){for(var n=t.length,r=0;r<n;++r)if(e(t[r],r))return!0;return!1}function L4(t,e){for(var n=t.length,r=0;r<n;++r)if(e(t[r],r))return t[r];return null}function B4(t){var e=t;if(typeof e>"u"){if(typeof navigator>"u"||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function Z_(t,e){try{return new RegExp(t,"g").exec(e)}catch{return null}}function kW(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var t=navigator.userAgentData,e=t.brands||t.uaList;return!!(e&&e.length)}function RW(t,e){var n=Z_("("+t+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return n?n[3]:""}function x1(t){return t.replace(/_/g,".")}function Ef(t,e){var n=null,r="-1";return Q_(t,function(i){var a=Z_("("+i.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!a||i.brand?!1:(n=i,r=a[3]||"-1",i.versionAlias?r=i.versionAlias:i.versionTest&&(r=RW(i.versionTest.toLowerCase(),e)||r),r=x1(r),!0)}),{preset:n,version:r}}function Vg(t,e){var n={brand:"",version:"-1"};return Q_(t,function(r){var i=U4(e,r);return i?(n.brand=r.id,n.version=r.versionAlias||i.version,n.version!=="-1"):!1}),n}function U4(t,e){return L4(t,function(n){var r=n.brand;return Z_(""+e.test,r.toLowerCase())})}var F4=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],$4=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],w1=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],G4=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],H4=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function q4(t){return!!Ef(G4,t).preset}function NW(t){var e=B4(t),n=!!/mobi/g.exec(e),r={name:"unknown",version:"-1",majorVersion:-1,webview:q4(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},a=Ef(F4,e),o=a.preset,c=a.version,u=Ef(H4,e),d=u.preset,h=u.version,p=Ef($4,e);if(r.chromium=!!p.preset,r.chromiumVersion=p.version,!r.chromium){var m=Ef(w1,e);r.webkit=!!m.preset,r.webkitVersion=m.version}return d&&(i.name=d.id,i.version=h,i.majorVersion=parseInt(h,10)),o&&(r.name=o.id,r.version=c,r.webview&&i.name==="ios"&&r.name!=="safari"&&(r.webview=!1)),r.majorVersion=parseInt(r.version,10),{browser:r,os:i,isMobile:n,isHints:!1}}function DW(t){var e=navigator.userAgentData,n=(e.uaList||e.brands).slice(),r=e.mobile||!1,i=n[0],a=(e.platform||navigator.platform).toLowerCase(),o={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!Vg(G4,n).brand||q4(B4())},c={name:"unknown",version:"-1",majorVersion:-1};o.webkit=!o.chromium&&Q_(w1,function(m){return U4(n,m)});var u=Vg($4,n);if(o.chromium=!!u.brand,o.chromiumVersion=u.version||"-1",!o.chromium){var d=Vg(w1,n);o.webkit=!!d.brand,o.webkitVersion=d.version||"-1"}var h=L4(H4,function(m){return new RegExp(""+m.test,"g").exec(a)});c.name=h?h.id:"";{var p=Vg(F4,n);o.name=p.brand||o.name,o.version=p.brand&&t?t.uaFullVersion:p.version}return o.webkit&&(c.name=r?"ios":"mac"),c.name==="ios"&&o.webview&&(o.version="-1"),c.version=x1(c.version),o.version=x1(o.version),c.majorVersion=parseInt(c.version,10),o.majorVersion=parseInt(o.version,10),{browser:o,os:c,isMobile:r,isHints:!0}}function IW(t){return kW()?DW():NW(t)}function MW(t,e,n,r,i,a){for(var o=0;o<i;++o){var c=n+o*i,u=r+o*i;t[c]+=t[u]*a,e[c]+=e[u]*a}}function OW(t,e,n,r,i){for(var a=0;a<i;++a){var o=n+a*i,c=r+a*i,u=t[o],d=e[o];t[o]=t[c],t[c]=u,e[o]=e[c],e[c]=d}}function PW(t,e,n,r,i){for(var a=0;a<r;++a){var o=n+a*r;t[o]/=i,e[o]/=i}}function Y4(t,e,n){for(var r=t.slice(),i=0;i<n;++i)r[i*n+e-1]=0,r[(e-1)*n+i]=0;return r[(e-1)*(n+1)]=1,r}function Fa(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var n=t.slice(),r=Kt(e),i=0;i<e;++i){var a=e*i+i;if(!rt(n[a],Pn)){for(var o=i+1;o<e;++o)if(n[e*i+o]){OW(n,r,i,o,e);break}}if(!rt(n[a],Pn))return[];PW(n,r,i,e,n[a]);for(var o=0;o<e;++o){var c=o,u=o+i*e,d=n[u];!rt(d,Pn)||i===o||MW(n,r,c,i,e,-d)}}return r}function jW(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var n=[],r=0;r<e;++r)for(var i=0;i<e;++i)n[i*e+r]=t[e*r+i];return n}function X4(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var n=[],r=t[e*e-1],i=0;i<e-1;++i)n[i]=t[e*(e-1)+i]/r;return n[e-1]=0,n}function VW(t,e){for(var n=Kt(e),r=0;r<e-1;++r)n[e*(e-1)+r]=t[r]||0;return n}function tc(t,e){for(var n=t.slice(),r=t.length;r<e-1;++r)n[r]=0;return n[e-1]=1,n}function ra(t,e,n){if(e===void 0&&(e=Math.sqrt(t.length)),e===n)return t;for(var r=Kt(n),i=Math.min(e,n),a=0;a<i-1;++a){for(var o=0;o<i-1;++o)r[a*n+o]=t[a*e+o];r[(a+1)*n-1]=t[(a+1)*e-1],r[(n-1)*n+a]=t[(e-1)*e+a]}return r[n*n-1]=t[e*e-1],r}function Km(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=Kt(t);return e.forEach(function(i){r=Gt(r,i,t)}),r}function Gt(t,e,n){n===void 0&&(n=Math.sqrt(t.length));var r=[],i=t.length/n,a=e.length/i;if(i){if(!a)return t}else return e;for(var o=0;o<n;++o)for(var c=0;c<a;++c){r[c*n+o]=0;for(var u=0;u<i;++u)r[c*n+o]+=t[u*n+o]*e[c*i+u]}return r}function At(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),i=0;i<n;++i)r[i]=r[i]+e[i];return r}function He(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),i=0;i<n;++i)r[i]=r[i]-e[i];return r}function zW(t,e){return e===void 0&&(e=t.length===6),e?[t[0],t[1],0,t[2],t[3],0,t[4],t[5],1]:t}function W4(t,e){return e===void 0&&(e=t.length===9),e?[t[0],t[1],t[3],t[4],t[6],t[7]]:t}function hr(t,e,n){n===void 0&&(n=e.length);var r=Gt(t,e,n),i=r[n-1];return r.map(function(a){return a/i})}function LW(t,e){return Gt(t,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function BW(t,e){return Gt(t,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function UW(t,e){return Gt(t,Yh(e,4))}function zg(t,e){var n=e[0],r=n===void 0?1:n,i=e[1],a=i===void 0?1:i,o=e[2],c=o===void 0?1:o;return Gt(t,[r,0,0,0,0,a,0,0,0,0,c,0,0,0,0,1],4)}function qh(t,e){return hr(Yh(e,3),tc(t,3))}function Kb(t,e){var n=e[0],r=n===void 0?0:n,i=e[1],a=i===void 0?0:i,o=e[2],c=o===void 0?0:o;return Gt(t,[1,0,0,0,0,1,0,0,0,0,1,0,r,a,c,1],4)}function MR(t,e){return Gt(t,e,4)}function Yh(t,e){var n=Math.cos(t),r=Math.sin(t),i=Kt(e);return i[0]=n,i[1]=r,i[e]=-r,i[e+1]=n,i}function Kt(t){for(var e=t*t,n=[],r=0;r<e;++r)n[r]=r%(t+1)?0:1;return n}function J_(t,e){for(var n=Kt(e),r=Math.min(t.length,e-1),i=0;i<r;++i)n[(e+1)*i]=t[i];return n}function nc(t,e){for(var n=Kt(e),r=Math.min(t.length,e-1),i=0;i<r;++i)n[e*(e-1)+i]=t[i];return n}function eE(t,e,n,r,i,a,o,c){var u=t[0],d=t[1],h=e[0],p=e[1],m=n[0],b=n[1],w=r[0],E=r[1],S=i[0],T=i[1],C=a[0],N=a[1],j=o[0],P=o[1],M=c[0],A=c[1],k=[u,0,h,0,m,0,w,0,d,0,p,0,b,0,E,0,1,0,1,0,1,0,1,0,0,u,0,h,0,m,0,w,0,d,0,p,0,b,0,E,0,1,0,1,0,1,0,1,-S*u,-T*u,-C*h,-N*h,-j*m,-P*m,-M*w,-A*w,-S*d,-T*d,-C*p,-N*p,-j*b,-P*b,-M*E,-A*E],D=Fa(k,8);if(!D.length)return[];var V=Gt(D,[S,T,C,N,j,P,M,A],8);return V[8]=1,ra(jW(V),3,4)}var zf=function(){return zf=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},zf.apply(this,arguments)};function FW(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function hh(t,e){return e===void 0&&(e=0),iu(ju(t,e))}function $W(t,e){var n=hr(t,[e[0],e[1]||0,e[2]||0,1],4),r=n[3]||1;return[n[0]/r,n[1]/r,n[2]/r]}function iu(t){var e=FW();return t.forEach(function(n){var r=n.matrixFunction,i=n.functionValue;r&&(e=r(e,i))}),e}function ju(t,e){e===void 0&&(e=0);var n=Vn(t)?t:Ko(t);return n.map(function(r){var i=x4(r),a=i.prefix,o=i.value,c=null,u=a,d="";if(a==="translate"||a==="translateX"||a==="translate3d"){var h=na(e)?zf(zf({},e),{"o%":e["%"]}):{"%":e,"o%":e},p=Hl(o).map(function(O,J){return J===0&&"x%"in h?h["%"]=e["x%"]:J===1&&"y%"in h?h["%"]=e["y%"]:h["%"]=e["o%"],$t(O,h)}),m=p[0],b=p[1],w=b===void 0?0:b,E=p[2],S=E===void 0?0:E;c=Kb,d=[m,w,S]}else if(a==="translateY"){var T=na(e)?zf({"%":e["y%"]},e):{"%":e},w=$t(o,T);c=Kb,d=[0,w,0]}else if(a==="translateZ"){var S=parseFloat(o);c=Kb,d=[0,0,S]}else if(a==="scale"||a==="scale3d"){var C=Hl(o).map(function(O){return parseFloat(O)}),N=C[0],j=C[1],P=j===void 0?N:j,M=C[2],A=M===void 0?1:M;c=zg,d=[N,P,A]}else if(a==="scaleX"){var N=parseFloat(o);c=zg,d=[N,1,1]}else if(a==="scaleY"){var P=parseFloat(o);c=zg,d=[1,P,1]}else if(a==="scaleZ"){var A=parseFloat(o);c=zg,d=[1,1,A]}else if(a==="rotate"||a==="rotateZ"||a==="rotateX"||a==="rotateY"){var k=Fh(o),D=k.unit,V=k.value,L=D==="rad"?V:V*Math.PI/180;a==="rotate"||a==="rotateZ"?(u="rotateZ",c=UW):a==="rotateX"?c=LW:a==="rotateY"&&(c=BW),d=L}else if(a==="matrix3d")c=MR,d=Hl(o).map(function(O){return parseFloat(O)});else if(a==="matrix"){var U=Hl(o).map(function(O){return parseFloat(O)});c=MR,d=[U[0],U[1],0,0,U[2],U[3],0,0,0,0,1,0,U[4],U[5],0,1]}else u="";return{name:a,functionName:u,value:o,matrixFunction:c,functionValue:d}})}var _1=function(t,e){return _1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},_1(t,e)};function GW(t,e){_1(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var K4=typeof Map=="function"?void 0:(function(){var t=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++t)}})(),Q4=(function(t){GW(e,t);function e(n){return n===void 0&&(n=[]),t.call(this,n,K4)||this}return e})(cW);function HW(t,e){return $h(t,e,K4)}var E1=function(){return E1=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},E1.apply(this,arguments)};function qW(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}var Z0=(function(){function t(){this._events={}}var e=t.prototype;return e.on=function(n,r){if(na(n))for(var i in n)this.on(i,n[i]);else this._addEvent(n,r,{});return this},e.off=function(n,r){if(!n)this._events={};else if(na(n))for(var i in n)this.off(i);else if(!r)this._events[n]=[];else{var a=this._events[n];if(a){var o=Os(a,function(c){return c.listener===r});o>-1&&a.splice(o,1)}}return this},e.once=function(n,r){var i=this;return r&&this._addEvent(n,r,{once:!0}),new Promise(function(a){i._addEvent(n,a,{once:!0})})},e.emit=function(n,r){var i=this;r===void 0&&(r={});var a=this._events[n];if(!n||!a)return!0;var o=!1;return r.eventType=n,r.stop=function(){o=!0},r.currentTarget=this,qW(a).forEach(function(c){c.listener(r),c.once&&i.off(n,c.listener)}),!o},e.trigger=function(n,r){return r===void 0&&(r={}),this.emit(n,r)},e._addEvent=function(n,r,i){var a=this._events;a[n]=a[n]||[];var o=a[n];o.push(E1({listener:r},i))},t})();var S1=function(t,e){return S1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},S1(t,e)};function YW(t,e){S1(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var fu=function(){return fu=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},fu.apply(this,arguments)};function XW(t){var e=t.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function OR(t,e){return t.addEventListener("scroll",e),function(){t.removeEventListener("scroll",e)}}function Lg(t){if(t){if(Lr(t))return document.querySelector(t)}else return null;if($_(t))return t();if(t instanceof Element)return t;if("current"in t)return t.current;if("value"in t)return t.value}var WW=(function(t){YW(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r._startRect=null,r._startPos=[],r._prevTime=0,r._timer=0,r._prevScrollPos=[0,0],r._isWait=!1,r._flag=!1,r._currentOptions=null,r._lock=!1,r._unregister=null,r._onScroll=function(){var i=r._currentOptions;r._lock||!i||r.emit("scrollDrag",{next:function(a){r.checkScroll({container:i.container,inputEvent:a})}})},r}var n=e.prototype;return n.dragStart=function(r,i){var a=Lg(i.container);if(!a){this._flag=!1;return}var o=0,c=0,u=0,d=0;if(a===document.body)u=window.innerWidth,d=window.innerHeight;else{var h=a.getBoundingClientRect();o=h.top,c=h.left,u=h.width,d=h.height}this._flag=!0,this._startPos=[r.clientX,r.clientY],this._startRect={top:o,left:c,width:u,height:d},this._prevScrollPos=this._getScrollPosition([0,0],i),this._currentOptions=i,this._registerScrollEvent(i)},n.drag=function(r,i){if(clearTimeout(this._timer),!!this._flag){var a=r.clientX,o=r.clientY,c=i.threshold,u=c===void 0?0:c,d=this,h=d._startRect,p=d._startPos;this._currentOptions=i;var m=[0,0];return h.top>o-u?(p[1]>h.top||o<p[1])&&(m[1]=-1):h.top+h.height<o+u&&(p[1]<h.top+h.height||o>p[1])&&(m[1]=1),h.left>a-u?(p[0]>h.left||a<p[0])&&(m[0]=-1):h.left+h.width<a+u&&(p[0]<h.left+h.width||a>p[0])&&(m[0]=1),!m[0]&&!m[1]?!1:this._continueDrag(fu(fu({},i),{direction:m,inputEvent:r,isDrag:!0}))}},n.checkScroll=function(r){var i=this;if(this._isWait)return!1;var a=r.prevScrollPos,o=a===void 0?this._prevScrollPos:a,c=r.direction,u=r.throttleTime,d=u===void 0?0:u,h=r.inputEvent,p=r.isDrag,m=this._getScrollPosition(c||[0,0],r),b=m[0]-o[0],w=m[1]-o[1],E=c||[b?Math.abs(b)/b:0,w?Math.abs(w)/w:0];return this._prevScrollPos=m,this._lock=!1,!b&&!w?!1:(this.emit("move",{offsetX:E[0]?b:0,offsetY:E[1]?w:0,inputEvent:h}),d&&p&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},d)),!0)},n.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},n._getScrollPosition=function(r,i){var a=i.container,o=i.getScrollPosition,c=o===void 0?XW:o;return c({container:Lg(a),direction:r})},n._continueDrag=function(r){var i=this,a,o=r.container,c=r.direction,u=r.throttleTime,d=r.useScroll,h=r.isDrag,p=r.inputEvent;if(!(!this._flag||h&&this._isWait)){var m=dh(),b=Math.max(u+this._prevTime-m,0);if(b>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},b),!1;this._prevTime=m;var w=this._getScrollPosition(c,r);this._prevScrollPos=w,h&&(this._isWait=!0),d||(this._lock=!0);var E={container:Lg(o),direction:c,inputEvent:p};return(a=r.requestScroll)===null||a===void 0||a.call(r,E),this.emit("scroll",E),this._isWait=!1,d||this.checkScroll(fu(fu({},r),{prevScrollPos:w,direction:c,inputEvent:p}))}},n._registerScrollEvent=function(r){this._unregisterScrollEvent();var i=r.checkScrollEvent;if(i){var a=i===!0?OR:i,o=Lg(r.container);i===!0&&(o===document.body||o===document.documentElement)?this._unregister=OR(window,this._onScroll):this._unregister=a(o,this._onScroll)}},n._unregisterScrollEvent=function(){var r;(r=this._unregister)===null||r===void 0||r.call(this),this._unregister=null},e})(Z0);function KW(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}function Mr(t){return rt(t,Pn)}function QW(t,e){return t.every(function(n,r){return Mr(n-e[r])===0})}function ZW(t,e){return!Mr(t[0]-e[0])&&!Mr(t[1]-e[1])}function Z4(t){return t.length<3?0:Math.abs(eW(t.map(function(e,n){var r=t[n+1]||t[0];return e[0]*r[1]-r[0]*e[1]})))/2}function PR(t,e){var n=e.width,r=e.height,i=e.left,a=e.top,o=rc(t),c=o.minX,u=o.minY,d=o.maxX,h=o.maxY,p=n/(d-c),m=r/(h-u);return t.map(function(b){return[i+(b[0]-c)*p,a+(b[1]-u)*m]})}function rc(t){var e=t.map(function(r){return r[0]}),n=t.map(function(r){return r[1]});return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,n),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,n)}}function T1(t,e,n){var r=t[0],i=t[1],a=rc(e),o=a.minX,c=a.maxX,u=[[o,i],[c,i]],d=Qm(u[0],u[1]),h=A1(e),p=[];if(h.forEach(function(w){var E=Qm(w[0],w[1]),S=w[0];if(QW(d,E))p.push({pos:t,line:w,type:"line"});else{var T=J4(tE(d,E),[u,w]);T.forEach(function(C){w.some(function(N){return ZW(N,C)})?p.push({pos:C,line:w,type:"point"}):Mr(S[1]-i)!==0&&p.push({pos:C,line:w,type:"intersection"})})}}),Br(p,function(w){return w[0]===r}))return!0;var m=0,b={};return p.forEach(function(w){var E=w.pos,S=w.type,T=w.line;if(!(E[0]>r))if(S==="intersection")++m;else{if(S==="line")return;if(S==="point"){var C=Br(T,function(P){return P[1]!==i}),N=b[E[0]],j=C[1]>i?1:-1;N?N!==j&&++m:b[E[0]]=j}}}),m%2===1}function Qm(t,e){var n=t[0],r=t[1],i=e[0],a=e[1],o=i-n,c=a-r;Math.abs(o)<Pn&&(o=0),Math.abs(c)<Pn&&(c=0);var u=0,d=0,h=0;return o?c?(u=-c/o,d=1,h=-u*n-r):(d=1,h=-r):c&&(u=-1,h=n),[u,d,h]}function tE(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],o=e[1],c=e[2],u=n===0&&a===0,d=r===0&&o===0,h=[];if(u&&d)return[];if(u){var p=-i/r,m=-c/o;return p!==m?[]:[[-1/0,p],[1/0,p]]}else if(d){var b=-i/n,w=-c/a;return b!==w?[]:[[b,-1/0],[b,1/0]]}else if(n===0){var E=-i/r,S=-(o*E+c)/a;h=[[S,E]]}else if(a===0){var E=-c/o,S=-(r*E+i)/n;h=[[S,E]]}else if(r===0){var S=-i/n,E=-(a*S+c)/o;h=[[S,E]]}else if(o===0){var S=-c/a,E=-(n*S+i)/r;h=[[S,E]]}else{var S=(r*c-o*i)/(o*n-r*a),E=-(n*S+i)/r;h=[[S,E]]}return h.map(function(T){return[T[0],T[1]]})}function J4(t,e){var n=e.map(function(p){return[0,1].map(function(m){return[Math.min(p[0][m],p[1][m]),Math.max(p[0][m],p[1][m])]})}),r=[];if(t.length===2){var i=t[0],a=i[0],o=i[1];if(Mr(a-t[1][0])){if(!Mr(o-t[1][1])){var d=Math.max.apply(Math,n.map(function(p){return p[0][0]})),h=Math.min.apply(Math,n.map(function(p){return p[0][1]}));if(Mr(d-h)>0)return[];r=[[d,o],[h,o]]}}else{var c=Math.max.apply(Math,n.map(function(p){return p[1][0]})),u=Math.min.apply(Math,n.map(function(p){return p[1][1]}));if(Mr(c-u)>0)return[];r=[[a,c],[a,u]]}}return r.length||(r=t.filter(function(p){var m=p[0],b=p[1];return n.every(function(w){return 0<=Mr(m-w[0][0])&&0<=Mr(w[0][1]-m)&&0<=Mr(b-w[1][0])&&0<=Mr(w[1][1]-b)})})),r.map(function(p){return[Mr(p[0]),Mr(p[1])]})}function A1(t){return KW(t.slice(1),[t[0]]).map(function(e,n){return[t[n],e]})}function JW(t,e){var n=t.slice(),r=e.slice();TR(n)===-1&&n.reverse(),TR(r)===-1&&r.reverse();var i=A1(n),a=A1(r),o=i.map(function(h){return Qm(h[0],h[1])}),c=a.map(function(h){return Qm(h[0],h[1])}),u=[];o.forEach(function(h,p){var m=i[p],b=[];c.forEach(function(w,E){var S=tE(h,w),T=J4(S,[m,a[E]]);b.push.apply(b,T.map(function(C){return{index1:p,index2:E,pos:C,type:"intersection"}}))}),b.sort(function(w,E){return Ss(m[0],w.pos)-Ss(m[0],E.pos)}),u.push.apply(u,b),T1(m[1],r)&&u.push({index1:p,index2:-1,pos:m[1],type:"inside"})}),a.forEach(function(h,p){if(T1(h[1],n)){var m=!1,b=Os(u,function(w){var E=w.index2;return E===p?(m=!0,!1):!!m});b===-1&&(m=!1,b=Os(u,function(w){var E=w.index1,S=w.index2;return E===-1&&S+1===p?(m=!0,!1):!!m})),b===-1?u.push({index1:-1,index2:p,pos:h[1],type:"inside"}):u.splice(b,0,{index1:-1,index2:p,pos:h[1],type:"inside"})}});var d={};return u.filter(function(h){var p=h.pos,m=p[0]+"x"+p[1];return d[m]?!1:(d[m]=!0,!0)})}function eK(t,e){var n=JW(t,e);return n.map(function(r){var i=r.pos;return i})}function tK(t,e){var n=eK(t,e);return Z4(n)}var C1=function(t,e){return C1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},C1(t,e)};function nK(t,e){C1(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Dn=function(){return Dn=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Dn.apply(this,arguments)};function rK(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=Math.atan2(r,n);return i>=0?i:i+Math.PI*2}function Qb(t){return rK([t[0].clientX,t[0].clientY],[t[1].clientX,t[1].clientY])/Math.PI*180}function iK(t){return t.touches&&t.touches.length>=2}function Bg(t){return t?t.touches?sK(t.touches):[eP(t)]:[]}function aK(t){return t&&(t.type.indexOf("mouse")>-1||"button"in t)}function jR(t,e,n){var r=n.length,i=Lf(t,r),a=i.clientX,o=i.clientY,c=i.originalClientX,u=i.originalClientY,d=Lf(e,r),h=d.clientX,p=d.clientY,m=Lf(n,r),b=m.clientX,w=m.clientY,E=a-h,S=o-p,T=a-b,C=o-w;return{clientX:c,clientY:u,deltaX:E,deltaY:S,distX:T,distY:C}}function Zb(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function sK(t){for(var e=Math.min(t.length,2),n=[],r=0;r<e;++r)n.push(eP(t[r]));return n}function eP(t){return{clientX:t.clientX,clientY:t.clientY}}function Lf(t,e){e===void 0&&(e=t.length);for(var n={clientX:0,clientY:0,originalClientX:0,originalClientY:0},r=Math.min(t.length,e),i=0;i<r;++i){var a=t[i];n.originalClientX+="originalClientX"in a?a.originalClientX:a.clientX,n.originalClientY+="originalClientY"in a?a.originalClientY:a.clientY,n.clientX+=a.clientX,n.clientY+=a.clientY}return e?{clientX:n.clientX/e,clientY:n.clientY/e,originalClientX:n.originalClientX/e,originalClientY:n.originalClientY/e}:n}var Jb=(function(){function t(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return t.prototype.getAngle=function(e){return e===void 0&&(e=this.prevClients),Qb(e)},t.prototype.getRotation=function(e){return e===void 0&&(e=this.prevClients),Qb(e)-Qb(this.startClients)},t.prototype.getPosition=function(e,n){e===void 0&&(e=this.prevClients);var r=jR(e||this.prevClients,this.prevClients,this.startClients),i=r.deltaX,a=r.deltaY;return this.movement+=Math.sqrt(i*i+a*a),this.prevClients=e,r},t.prototype.getPositions=function(e){e===void 0&&(e=this.prevClients);for(var n=this.prevClients,r=this.startClients,i=Math.min(this.length,n.length),a=[],o=0;o<i;++o)a[o]=jR([e[o]],[n[o]],[r[o]]);return a},t.prototype.getMovement=function(e){var n=this.movement;if(!e)return n;var r=Lf(e,this.length),i=Lf(this.prevClients,this.length),a=r.clientX-i.clientX,o=r.clientY-i.clientY;return Math.sqrt(a*a+o*o)+n},t.prototype.getDistance=function(e){return e===void 0&&(e=this.prevClients),Zb(e)},t.prototype.getScale=function(e){return e===void 0&&(e=this.prevClients),Zb(e)/Zb(this.startClients)},t.prototype.move=function(e,n){this.startClients.forEach(function(r){r.clientX-=e,r.clientY-=n}),this.prevClients.forEach(function(r){r.clientX-=e,r.clientY-=n})},t})(),VR=["textarea","input"],oK=(function(t){nK(e,t);function e(n,r){r===void 0&&(r={});var i=t.call(this)||this;i.options={},i.flag=!1,i.pinchFlag=!1,i.data={},i.isDrag=!1,i.isPinch=!1,i.clientStores=[],i.targets=[],i.prevTime=0,i.doubleFlag=!1,i._useMouse=!1,i._useTouch=!1,i._useDrag=!1,i._dragFlag=!1,i._isTrusted=!1,i._isMouseEvent=!1,i._isSecondaryButton=!1,i._preventMouseEvent=!1,i._prevInputEvent=null,i._isDragAPI=!1,i._isIdle=!0,i._preventMouseEventId=0,i._window=window,i.onDragStart=function(m,b){if(b===void 0&&(b=!0),!(!i.flag&&m.cancelable===!1)){var w=m.type.indexOf("drag")>=-1;if(!(i.flag&&w)){i._isDragAPI=!0;var E=i.options,S=E.container,T=E.pinchOutside,C=E.preventWheelClick,N=E.preventRightClick,j=E.preventDefault,P=E.checkInput,M=E.dragFocusedInput,A=E.preventClickEventOnDragStart,k=E.preventClickEventOnDrag,D=E.preventClickEventByCondition,V=i._useTouch,L=!i.flag;if(i._isSecondaryButton=m.which===3||m.button===2,C&&(m.which===2||m.button===1)||N&&(m.which===3||m.button===2))return i.stop(),!1;if(L){var U=i._window.document.activeElement,O=m.target;if(O){var J=O.tagName.toLowerCase(),W=VR.indexOf(J)>-1,q=O.isContentEditable;if(W||q){if(P||!M&&U===O)return!1;if(U&&(U===O||q&&U.isContentEditable&&U.contains(O)))if(M)O.blur();else return!1}else if((j||m.type==="touchstart")&&U){var K=U.tagName.toLowerCase();(U.isContentEditable||VR.indexOf(K)>-1)&&U.blur()}(A||k||D)&&er(i._window,"click",i._onClick,!0)}i.clientStores=[new Jb(Bg(m))],i._isIdle=!1,i.flag=!0,i.isDrag=!1,i._isTrusted=b,i._dragFlag=!0,i._prevInputEvent=m,i.data={},i.doubleFlag=dh()-i.prevTime<200,i._isMouseEvent=aK(m),!i._isMouseEvent&&i._preventMouseEvent&&i._allowMouseEvent();var te=i._preventMouseEvent||i.emit("dragStart",Dn(Dn({data:i.data,datas:i.data,inputEvent:m,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,isTrusted:b,isDouble:i.doubleFlag},i.getCurrentStore().getPosition()),{preventDefault:function(){m.preventDefault()},preventDrag:function(){i._dragFlag=!1}}));te===!1&&i.stop(),i._isMouseEvent&&i.flag&&j&&m.preventDefault()}if(!i.flag)return!1;var se=0;if(L?(i._attchDragEvent(),V&&T&&(se=setTimeout(function(){er(S,"touchstart",i.onDragStart,{passive:!1})}))):V&&T&&Ln(S,"touchstart",i.onDragStart),i.flag&&iK(m)){if(clearTimeout(se),L&&m.touches.length!==m.changedTouches.length)return;i.pinchFlag||i.onPinchStart(m)}}}},i.onDrag=function(m,b){if(i.flag){var w=i.options.preventDefault;!i._isMouseEvent&&w&&m.preventDefault(),i._prevInputEvent=m;var E=Bg(m),S=i.moveClients(E,m,!1);if(i._dragFlag){if(i.pinchFlag||S.deltaX||S.deltaY){var T=i._preventMouseEvent||i.emit("drag",Dn(Dn({},S),{isScroll:!!b,inputEvent:m}));if(T===!1){i.stop();return}}i.pinchFlag&&i.onPinch(m,E)}i.getCurrentStore().getPosition(E,!0)}},i.onDragEnd=function(m){if(i.flag){var b=i.options,w=b.pinchOutside,E=b.container,S=b.preventClickEventOnDrag,T=b.preventClickEventOnDragStart,C=b.preventClickEventByCondition,N=i.isDrag;(S||T||C)&&requestAnimationFrame(function(){i._allowClickEvent()}),!C&&!T&&S&&!N&&i._allowClickEvent(),i._useTouch&&w&&Ln(E,"touchstart",i.onDragStart),i.pinchFlag&&i.onPinchEnd(m);var j=m?.touches?Bg(m):[],P=j.length;P===0||!i.options.keepDragging?i.flag=!1:i._addStore(new Jb(j));var M=i._getPosition(),A=dh(),k=!N&&i.doubleFlag;i._prevInputEvent=null,i.prevTime=N||k?0:A,i.flag||(i._dettachDragEvent(),i._preventMouseEvent||i.emit("dragEnd",Dn({data:i.data,datas:i.data,isDouble:k,isDrag:N,isClick:!N,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,inputEvent:m,isTrusted:i._isTrusted},M)),i.clientStores=[],i._isMouseEvent||(i._preventMouseEvent=!0,clearTimeout(i._preventMouseEventId),i._preventMouseEventId=setTimeout(function(){i._preventMouseEvent=!1},200)),i._isIdle=!0)}},i.onBlur=function(){i.onDragEnd()},i._allowClickEvent=function(){Ln(i._window,"click",i._onClick,!0)},i._onClick=function(m){i._allowClickEvent(),i._allowMouseEvent();var b=i.options.preventClickEventByCondition;b?.(m)||(m.stopPropagation(),m.preventDefault())},i._onContextMenu=function(m){var b=i.options;b.preventRightClick?i.onDragEnd(m):m.preventDefault()},i._passCallback=function(){};var a=[].concat(n),o=a[0];i._window=C4(o)?o:zo(o),i.options=Dn({checkInput:!1,container:o&&!("document"in o)?zo(o):o,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},r);var c=i.options,u=c.container,d=c.events,h=c.checkWindowBlur;if(i._useDrag=d.indexOf("drag")>-1,i._useTouch=d.indexOf("touch")>-1,i._useMouse=d.indexOf("mouse")>-1,i.targets=a,i._useDrag&&a.forEach(function(m){er(m,"dragstart",i.onDragStart)}),i._useMouse&&(a.forEach(function(m){er(m,"mousedown",i.onDragStart),er(m,"mousemove",i._passCallback)}),er(u,"contextmenu",i._onContextMenu)),h&&er(zo(),"blur",i.onBlur),i._useTouch){var p={passive:!1};a.forEach(function(m){er(m,"touchstart",i.onDragStart,p),er(m,"touchmove",i._passCallback,p)})}return i}return e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(n){return this.getCurrentStore().getMovement(n)+this.clientStores.slice(1).reduce(function(r,i){return r+i.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(n,r,i,a){a===void 0&&(a=!0),this.flag&&(this.clientStores[0].move(n,r),a&&this.onDrag(i,!0))},e.prototype.move=function(n,r){var i=n[0],a=n[1],o=this.getCurrentStore(),c=o.prevClients;return this.moveClients(c.map(function(u){var d=u.clientX,h=u.clientY;return{clientX:d+i,clientY:h+a,originalClientX:d,originalClientY:h}}),r,!0)},e.prototype.triggerDragStart=function(n){this.onDragStart(n,!1)},e.prototype.setEventData=function(n){var r=this.data;for(var i in n)r[i]=n[i];return this},e.prototype.setEventDatas=function(n){return this.setEventData(n)},e.prototype.getCurrentEvent=function(n){return n===void 0&&(n=this._prevInputEvent),Dn(Dn({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:n})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var n=this,r=this.targets,i=this.options.container;this.off(),Ln(this._window,"blur",this.onBlur),this._useDrag&&r.forEach(function(a){Ln(a,"dragstart",n.onDragStart)}),this._useMouse&&(r.forEach(function(a){Ln(a,"mousedown",n.onDragStart)}),Ln(i,"contextmenu",this._onContextMenu)),this._useTouch&&(r.forEach(function(a){Ln(a,"touchstart",n.onDragStart)}),Ln(i,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(n){var r=this,i=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>i)){var a=new Jb(Bg(n));this.pinchFlag=!0,this._addStore(a);var o=this.emit("pinchStart",Dn(Dn({data:this.data,datas:this.data,angle:a.getAngle(),touches:this.getCurrentStore().getPositions()},a.getPosition()),{inputEvent:n,isTrusted:this._isTrusted,preventDefault:function(){n.preventDefault()},preventDrag:function(){r._dragFlag=!1}}));o===!1&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(n,r){if(!(!this.flag||!this.pinchFlag||r.length<2)){var i=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",Dn(Dn({data:this.data,datas:this.data,movement:this.getMovement(r),angle:i.getAngle(r),rotation:i.getRotation(r),touches:i.getPositions(r),scale:i.getScale(r),distance:i.getDistance(r)},i.getPosition(r)),{inputEvent:n,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(n){if(this.pinchFlag){var r=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var i=this.getCurrentStore();this.emit("pinchEnd",Dn(Dn({data:this.data,datas:this.data,isPinch:r,touches:i.getPositions()},i.getPosition()),{inputEvent:n}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(n,r,i){var a=this._getPosition(n,i),o=this.isDrag;(a.deltaX||a.deltaY)&&(this.isDrag=!0);var c=!1;return!o&&this.isDrag&&(c=!0),Dn(Dn({data:this.data,datas:this.data},a),{movement:this.getMovement(n),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:r,isTrusted:this._isTrusted,isFirstDrag:c})},e.prototype._addStore=function(n){this.clientStores.splice(0,0,n)},e.prototype._getPosition=function(n,r){var i=this.getCurrentStore(),a=i.getPosition(n,r),o=this.clientStores.slice(1).reduce(function(d,h){var p=h.getPosition();return d.distX+=p.distX,d.distY+=p.distY,d},a),c=o.distX,u=o.distY;return Dn(Dn({},a),{distX:c,distY:u})},e.prototype._attchDragEvent=function(){var n=this._window,r=this.options.container,i={passive:!1};this._isDragAPI&&(er(r,"dragover",this.onDrag,i),er(n,"dragend",this.onDragEnd)),this._useMouse&&(er(r,"mousemove",this.onDrag),er(n,"mouseup",this.onDragEnd)),this._useTouch&&(er(r,"touchmove",this.onDrag,i),er(n,"touchend",this.onDragEnd,i),er(n,"touchcancel",this.onDragEnd,i))},e.prototype._dettachDragEvent=function(){var n=this._window,r=this.options.container;this._isDragAPI&&(Ln(r,"dragover",this.onDrag),Ln(n,"dragend",this.onDragEnd)),this._useMouse&&(Ln(r,"mousemove",this.onDrag),Ln(n,"mouseup",this.onDragEnd)),this._useTouch&&(Ln(r,"touchstart",this.onDragStart),Ln(r,"touchmove",this.onDrag),Ln(n,"touchend",this.onDragEnd),Ln(n,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e})(Z0);function lK(t){for(var e=5381,n=t.length;n;)e=e*33^t.charCodeAt(--n);return e>>>0}var cK=lK;function uK(t){return cK(t).toString(36)}function dK(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function fK(t,e,n){return n.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(r,i){var a=i.trim();return(a?Hl(a):[""]).map(function(o){var c=o.trim();return c.indexOf("@")===0?c:c.indexOf(":global")>-1?c.replace(/\:global/g,""):c.indexOf(":host")>-1?"".concat(c.replace(/\:host/g,".".concat(t))):c?".".concat(t," ").concat(c):".".concat(t)}).join(", ")+" {"})}function hK(t,e,n,r,i){var a=ad(r),o=a.createElement("style");return o.setAttribute("type","text/css"),o.setAttribute("data-styled-id",t),o.setAttribute("data-styled-count","1"),n.nonce&&o.setAttribute("nonce",n.nonce),o.innerHTML=fK(t,e,n),(i||a.head||a.body).appendChild(o),o}function pK(t){var e="rCS"+uK(t);return{className:e,inject:function(n,r){r===void 0&&(r={});var i=dK(n),a=(i||n.ownerDocument||document).querySelector('style[data-styled-id="'.concat(e,'"]'));if(!a)a=hK(e,t,r,n,i);else{var o=parseFloat(a.getAttribute("data-styled-count"))||0;a.setAttribute("data-styled-count","".concat(o+1))}return{destroy:function(){var c,u=parseFloat(a.getAttribute("data-styled-count"))||0;u<=1?(a.remove?a.remove():(c=a.parentNode)===null||c===void 0||c.removeChild(a),a=null):a.setAttribute("data-styled-count","".concat(u-1))}}}}}var k1=function(){return k1=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},k1.apply(this,arguments)};function gK(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function tP(t,e){var n=pK(e),r=n.className;return hW(function(i,a){var o=i.className,c=o===void 0?"":o;i.cspNonce;var u=gK(i,["className","cspNonce"]),d=AW();return CW(a,function(){return d.current},[]),z4(function(){var h=n.inject(d.current,{nonce:i.cspNonce});return function(){h.destroy()}},[]),Ki(t,k1({ref:d,"data-styled-id":r,className:"".concat(c," ").concat(r)},u))})}var R1=function(t,e){return R1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},R1(t,e)};function Xh(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");R1(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var ee=function(){return ee=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ee.apply(this,arguments)};function mK(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function vK(t,e,n,r){var i=arguments.length,a=i<3?e:r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}function yK(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ne(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function Ce(t,e,n){if(arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return t.concat(a||Array.prototype.slice.call(e))}function Wh(t,e){return ee({events:[],props:[],name:t},e)}var bK=["n","w","s","e"],nE=["n","w","s","e","nw","ne","sw","se"];function xK(t,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*t,'px" height="').concat(32*t,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}function wK(t){var e=xK(1,t),n=Math.round(t/45)*45%180,r="ns-resize";return n===135?r="nwse-resize":n===45?r="nesw-resize":n===90&&(r="ew-resize"),"cursor:".concat(r,";cursor: url('").concat(e,"') 16 16, ").concat(r,";")}var od=IW(),nP=od.browser.webkit,rP=nP&&(function(){var t=typeof window>"u"?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(t.userAgent.toLowerCase());return e?parseFloat(e[1])<605:!1})(),iP=od.browser.name,aP=parseInt(od.browser.version,10),_K=iP==="chrome",EK=od.browser.chromium,SK=parseInt(od.browser.chromiumVersion,10)||0,TK=_K&&aP>=109||EK&&SK>=109,AK=iP==="firefox",CK=parseInt(od.browser.webkitVersion,10)>=612||aP>=15,rE="moveable-",kK=nE.map(function(t){var e="",n="",r="center",i="center",a="calc(var(--moveable-control-padding, 20) * -1px)";return t.indexOf("n")>-1&&(e="top: ".concat(a,";"),i="bottom"),t.indexOf("s")>-1&&(e="top: 0px;",i="top"),t.indexOf("w")>-1&&(n="left: ".concat(a,";"),r="right"),t.indexOf("e")>-1&&(n="left: 0px;",r="left"),'.around-control[data-direction*="'.concat(t,`"] {
        `).concat(n).concat(e,`
        transform-origin: `).concat(r," ").concat(i,`;
    }`)}).join(`
`),RK=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(kK,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(t){return`
.direction[data-rotation="`.concat(t,'"], :global .view-control-rotation').concat(t,` {
`).concat(wK(t),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(rP?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),NK=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],N1=1e-4,Tr=1e-7,Ug=1e-9,D1=Math.pow(10,10),zR=-D1,DK={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},iE={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},sP={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},oP=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function Kh(t,e,n,r,i,a){var o,c;a===void 0&&(a="draggable");var u=(c=(o=e.gestos[a])===null||o===void 0?void 0:o.move(n,t.inputEvent))!==null&&c!==void 0?c:{},d=u.originalDatas||u.datas,h=d[a]||(d[a]={});return ee(ee({},u),{isPinch:!!r,parentEvent:!0,datas:h,originalDatas:t.originalDatas})}var Vu=(function(){function t(e){var n;e===void 0&&(e="draggable"),this.ableName=e,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(n={},n[e]={},n)}return t.prototype.dragStart=function(e,n){this.isDrag=!1,this.isFlag=!1;var r=n.originalDatas;return this.datas=r,r[this.ableName]||(r[this.ableName]={}),ee(ee({},this.move(e,n.inputEvent)),{type:"dragstart"})},t.prototype.drag=function(e,n){return this.move([e[0]-this.prevX,e[1]-this.prevY],n)},t.prototype.move=function(e,n){var r,i,a=!1;if(!this.isFlag)this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],r=e[0],i=e[1],this.isFlag=!0;else{var o=this.isDrag;r=this.prevX+e[0],i=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!o&&this.isDrag&&(a=!0)}return this.prevX=r,this.prevY=i,{type:"drag",clientX:r,clientY:i,inputEvent:n,isFirstDrag:a,isDrag:this.isDrag,distX:r-this.startX,distY:i-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},t})();function Su(t,e,n,r){var i=t.length===16,a=i?4:3,o=dc(t,n,r,a),c=ne(o,4),u=ne(c[0],2),d=u[0],h=u[1],p=ne(c[1],2),m=p[0],b=p[1],w=ne(c[2],2),E=w[0],S=w[1],T=ne(c[3],2),C=T[0],N=T[1],j=ne(an(t,e,a),2),P=j[0],M=j[1],A=Math.min(d,m,E,C),k=Math.min(h,b,S,N),D=Math.max(d,m,E,C),V=Math.max(h,b,S,N);d=d-A||0,m=m-A||0,E=E-A||0,C=C-A||0,h=h-k||0,b=b-k||0,S=S-k||0,N=N-k||0,P=P-A||0,M=M-k||0;var L=t[0],U=t[a+1],O=xr(L*U);return{left:A,top:k,right:D,bottom:V,origin:[P,M],pos1:[d,h],pos2:[m,b],pos3:[E,S],pos4:[C,N],direction:O}}function lP(t,e){var n=e.clientX,r=e.clientY,i=e.datas,a=t.state,o=a.moveableClientRect,c=a.rootMatrix,u=a.is3d,d=a.pos1,h=o.left,p=o.top,m=u?4:3,b=ne(He(Bu(c,[n-h,r-p],m),d),2),w=b[0],E=b[1],S=ne(Ya({datas:i,distX:w,distY:E}),2),T=S[0],C=S[1];return[T,C]}function uc(t,e){var n=e.datas,r=t.state,i=r.allMatrix,a=r.beforeMatrix,o=r.is3d,c=r.left,u=r.top,d=r.origin,h=r.offsetMatrix,p=r.targetMatrix,m=r.transformOrigin,b=o?4:3;n.is3d=o,n.matrix=i,n.targetMatrix=p,n.beforeMatrix=a,n.offsetMatrix=h,n.transformOrigin=m,n.inverseMatrix=Fa(i,b),n.inverseBeforeMatrix=Fa(a,b),n.absoluteOrigin=tc(At([c,u],d),b),n.startDragBeforeDist=hr(n.inverseBeforeMatrix,n.absoluteOrigin,b),n.startDragDist=hr(n.inverseMatrix,n.absoluteOrigin,b)}function IK(t){return Su(t.datas.beforeTransform,[50,50],100,100).direction}function J0(t,e,n){var r=e.datas,i=e.originalDatas.beforeRenderable,a=r.transformIndex,o=i.nextTransforms,c=o.length,u=i.nextTransformAppendedIndexes,d=-1;a===-1?(n==="translate"?d=0:n==="rotate"&&(d=Os(o,function(b){return b.match(/scale\(/g)})),d===-1&&(d=o.length),r.transformIndex=d):Br(u,function(b){return b.index===a&&b.functionName===n})?d=a:d=a+u.filter(function(b){return b.index<a}).length;var h=iZ(o,t.state,d),p=h.targetFunction,m=n==="rotate"?"rotateZ":n;r.beforeFunctionTexts=h.beforeFunctionTexts,r.afterFunctionTexts=h.afterFunctionTexts,r.beforeTransform=h.beforeFunctionMatrix,r.beforeTransform2=h.beforeFunctionMatrix2,r.targetTansform=h.targetFunctionMatrix,r.afterTransform=h.afterFunctionMatrix,r.afterTransform2=h.afterFunctionMatrix2,r.targetAllTransform=h.allFunctionMatrix,p.functionName===m?(r.afterFunctionTexts.splice(0,1),r.isAppendTransform=!1):c>d&&(r.isAppendTransform=!0,i.nextTransformAppendedIndexes=Ce(Ce([],ne(u),!1),[{functionName:n,index:d,isAppend:!0}],!1))}function ev(t,e,n){return"".concat(t.beforeFunctionTexts.join(" ")," ").concat(t.isAppendTransform?n:e," ").concat(t.afterFunctionTexts.join(" "))}function MK(t){var e=t.datas,n=t.distX,r=t.distY,i=ne(uP({datas:e,distX:n,distY:r}),2),a=i[0],o=i[1],c=cP(e,VW([a,o],4));return hr(c,tc([0,0,0],4),4)}function cP(t,e,n){var r=t.beforeTransform,i=t.afterTransform,a=t.beforeTransform2,o=t.afterTransform2,c=t.targetAllTransform,u=n?Gt(c,e,4):Gt(e,c,4),d=Gt(Fa(n?a:r,4),u,4),h=Gt(d,Fa(n?o:i,4),4);return h}function uP(t){var e=t.datas,n=t.distX,r=t.distY,i=e.inverseBeforeMatrix,a=e.is3d,o=e.startDragBeforeDist,c=e.absoluteOrigin,u=a?4:3;return He(hr(i,At(c,[n,r]),u),o)}function Ya(t,e){var n=t.datas,r=t.distX,i=t.distY,a=n.inverseBeforeMatrix,o=n.inverseMatrix,c=n.is3d,u=n.startDragBeforeDist,d=n.startDragDist,h=n.absoluteOrigin,p=c?4:3;return He(hr(e?a:o,At(h,[r,i]),p),e?u:d)}function OK(t,e){var n=t.datas,r=t.distX,i=t.distY;n.beforeMatrix;var a=n.matrix,o=n.is3d;n.startDragBeforeDist;var c=n.startDragDist,u=n.absoluteOrigin,d=o?4:3;return He(hr(a,At(c,[r,i]),d),u)}function PK(t,e,n,r,i,a){return r===void 0&&(r=e),i===void 0&&(i=n),a===void 0&&(a=[0,0]),t?t.map(function(o,c){var u=Fh(o),d=u.value,h=u.unit,p=c?i:r,m=c?n:e;if(o==="%"||isNaN(d)){var b=p?a[c]/p:0;return m*b}else if(h!=="%")return d;return m*d/100}):a}function dP(t){var e=[];return t[1]>=0&&(t[0]>=0&&e.push(3),t[0]<=0&&e.push(2)),t[1]<=0&&(t[0]>=0&&e.push(1),t[0]<=0&&e.push(0)),e}function jK(t,e){return dP(e).map(function(n){return t[n]})}function ex(t,e){var n=(e+1)/2;return[Xm(t[0][0],t[1][0],n,1-n),Xm(t[0][1],t[1][1],n,1-n)]}function Fn(t,e){var n=ex([t[0],t[1]],e[0]),r=ex([t[2],t[3]],e[0]);return ex([n,r],e[1])}function VK(t,e,n,r,i,a){var o=dc(e,n,r,i),c=Fn(o,a),u=t[0]-c[0],d=t[1]-c[1];return[u,d]}function Qh(t,e,n,r){return Gt(t,Uf(e,r,n),r)}function zK(t,e,n,r){var i=t.transformOrigin,a=t.offsetMatrix,o=t.is3d,c=o?4:3,u;if(Lr(n)){var d=e.beforeTransform,h=e.afterTransform;r?u=ra(hh(n),4,c):u=ra(Gt(Gt(d,hh([n]),4),h,4),4,c)}else u=n;return Qh(a,u,i,c)}function LK(t,e){var n=t.transformOrigin,r=t.offsetMatrix,i=t.is3d,a=t.targetMatrix,o=t.targetAllTransform,c=i?4:3;return Qh(r,Gt(o||a,J_(e,c),c),n,c)}function tv(t,e){var n=ld(e);return{setTransform:function(r,i){i===void 0&&(i=-1),n.startTransforms=Vn(r)?r:Ko(r),I1(t,e,i)},setTransformIndex:function(r){I1(t,e,r)}}}function nv(t,e,n){var r=ld(e),i=r.startTransforms;I1(t,e,Os(i,function(a){return a.indexOf("".concat(n,"("))===0}))}function I1(t,e,n){var r=ld(e),i=e.datas;if(i.transformIndex=n,n!==-1){var a=r.startTransforms[n];if(a){var o=t.state,c=ju([a],{"x%":function(u){return u/100*o.offsetWidth},"y%":function(u){return u/100*o.offsetHeight}});i.startValue=c[0].functionValue}}}function aE(t,e){var n=ld(t);n.nextTransforms=Ko(e)}function ld(t){return t.originalDatas.beforeRenderable}function Zm(t){var e=t.originalDatas.beforeRenderable;return e.nextTransforms}function Fg(t){return(Zm(t)||[]).join(" ")}function $g(t){return ld(t).nextStyle}function fP(t,e,n,r,i){aE(i,e);var a=br.drag(t,Kh(i,t.state,n,r)),o=a?a.transform:e;return ee(ee({transform:e,drag:a},_r({transform:o},i)),{afterTransform:o})}function sE(t,e,n,r,i,a){var o=zK(t.state,i,e,a),c=FK(t,n,r,o);return c}function hP(t,e,n,r,i,a,o){var c=sE(t,e,n,i,a,o),u=t.state,d=u.left,h=u.top,p=t.props.groupable,m=p?d:0,b=p?h:0,w=He(r,c);return He(w,[m,b])}function BK(t,e,n,r,i,a,o){var c=hP(t,e,n,r,i,a,o);return c}function UK(t,e,n){return[e?-1+t[0]/(e/2):0,n?-1+t[1]/(n/2):0]}function FK(t,e,n,r){r===void 0&&(r=t.state.allMatrix);var i=t.state,a=i.width,o=i.height,c=i.is3d,u=c?4:3,d=[a/2*(1+e[0])+n[0],o/2*(1+e[1])+n[1]];return an(r,d,u)}function $K(t,e,n){var r=n.fixedDirection,i=n.fixedPosition,a=n.fixedOffset;return hP(t,"rotate(".concat(e,"deg)"),r,i,a,n)}function GK(t,e,n,r,i,a){var o=t.props.groupable,c=t.state,u=c.transformOrigin,d=c.offsetMatrix,h=c.is3d,p=c.width,m=c.height,b=c.left,w=c.top,E=a.fixedDirection,S=a.nextTargetMatrix||c.targetMatrix,T=h?4:3,C=PK(i,e,n,p,m,u),N=o?b:0,j=o?w:0,P=Qh(d,S,C,T),M=VK(r,P,e,n,T,E);return He(M,[N,j])}function HK(t,e){return Fn(Di(t.state),e)}function qK(t,e){var n=t.targetGesto,r=t.controlGesto,i;return n?.isFlag()&&(i=n.getEventData()[e]),!i&&r?.isFlag()&&(i=r.getEventData()[e]),i||{}}function YK(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function XK(t){var e=t("scale"),n=t("rotate"),r=t("translate"),i=[];return r&&r!=="0px"&&r!=="none"&&i.push("translate(".concat(r.split(/\s+/).join(","),")")),n&&n!=="1"&&n!=="none"&&i.push("rotate(".concat(n,")")),e&&e!=="1"&&e!=="none"&&i.push("scale(".concat(e.split(/\s+/).join(","),")")),i}function pP(t,e,n){for(var r=t,i=[],a=q_(t)||al(t),o=!n&&t===e||t===a,c=o,u=!1,d=3,h,p,m,b=!1,w=gh(e,e,!0).offsetParent,E=1;r&&!c;){c=o;var S=Ur(r),T=S("position"),C=zP(r),N=T==="fixed",j=XK(S),P=zW(HQ(C)),M=void 0,A=!1,k=!1,D=0,V=0,L=0,U=0,O={hasTransform:!1,fixedContainer:null};N&&(b=!0,O=KQ(r),w=O.fixedContainer);var J=P.length;!u&&(J===16||j.length)&&(u=!0,d=4,z1(i),m&&(m=ra(m,3,4))),u&&J===9&&(P=ra(P,3,4));var W=WQ(r,t),q=W.tagName,K=W.hasOffset,te=W.isSVG,se=W.origin,G=W.targetOrigin,F=W.offset,Y=ne(F,2),Q=Y[0],X=Y[1];q==="svg"&&!r.ownerSVGElement&&m&&(i.push({type:"target",target:r,matrix:QQ(r,d)}),i.push({type:"offset",target:r,matrix:Kt(d)}));var ie=parseFloat(S("zoom"))||1;if(N)M=O.fixedContainer,A=!0;else{var le=gh(r,e,!1,!0,S),ge=le.offsetZoom;if(M=le.offsetParent,A=le.isEnd,k=le.isStatic,E*=ge,(le.isCustomElement||ge!==1)&&k)Q-=M.offsetLeft,X-=M.offsetTop;else if(AK||TK){var pe=le.parentSlotElement;if(pe){for(var _e=M,Ie=0,ae=0;_e&&YK(_e);)Ie+=_e.offsetLeft,ae+=_e.offsetTop,_e=_e.offsetParent;Q-=Ie,X-=ae}}}if(nP&&!CK&&K&&!te&&k&&(T==="relative"||T==="static")&&(Q-=M.offsetLeft,X-=M.offsetTop,o=o||A),N)K&&O.hasTransform&&(L=M.clientLeft,U=M.clientTop);else if(K&&w!==M&&(D=M.clientLeft,V=M.clientTop),K&&M===a){var Ae=LP(r,!1);Q+=Ae[0],X+=Ae[1]}if(i.push({type:"target",target:r,matrix:Uf(P,d,se)}),j.length&&(i.push({type:"offset",target:r,matrix:Kt(d)}),i.push({type:"target",target:r,matrix:Uf(hh(j),d,se)})),K){var Re=r===t,De=Re?0:r.scrollLeft,Ve=Re?0:r.scrollTop;i.push({type:"offset",target:r,matrix:nc([Q-De+D-L,X-Ve+V-U],d)})}else i.push({type:"offset",target:r,origin:se});if(ie!==1&&i.push({type:"zoom",target:r,matrix:Uf(J_([ie,ie],d),d,[0,0])}),m||(m=P),h||(h=se),p||(p=G),c||N)break;r=M,o=A,(!n||r===a)&&(c=o)}return m||(m=Kt(d)),h||(h=[0,0]),p||(p=[0,0]),{zoom:E,offsetContainer:w,matrixes:i,targetMatrix:m,transformOrigin:h,targetOrigin:p,is3d:u,hasFixed:b}}var zl=null,Ll=null,hu=null;function zu(t){t?(window.Map&&(zl=new Map,Ll=new Map),hu=[]):(zl=null,hu=null,Ll=null)}function WK(t){var e=Ll?.get(t);if(e)return e;var n=Ff(t,!0);return Ll&&Ll.set(t,n),n}function KK(t,e){if(hu){var n=Br(hu,function(i){return i[0][0]==t&&i[0][1]==e});if(n)return n[1]}var r=pP(t,e,!0);return hu&&hu.push([[t,e],r]),r}function Ur(t){var e=zl?.get(t);if(!e){var n=zo(t).getComputedStyle(t);if(!zl)return function(a){return n[a]};e={style:n,cached:{}},zl.set(t,e)}var r=e.cached,i=e.style;return function(a){return a in r||(r[a]=i[a]),r[a]}}function Qi(t,e,n){var r=n.originalDatas;r.groupable=r.groupable||{};var i=r.groupable;i.childDatas=i.childDatas||[];var a=i.childDatas;return t.moveables.map(function(o,c){return a[c]=a[c]||{},a[c][e]=a[c][e]||{},ee(ee({},n),{isRequestChild:!0,datas:a[c][e],originalDatas:a[c]})})}function tx(t,e,n,r,i,a,o){var c=!!n.match(/Start$/g),u=!!n.match(/End$/g),d=i.isPinch,h=i.datas,p=Qi(t,e.name,i),m=t.moveables,b=[],w=p.map(function(E,S){var T=m[S],C=T.state,N=C.gestos,j=E;if(c)j=new Vu(o).dragStart(r,E),b.push(j);else{if(N[o]||(N[o]=h.childGestos[S]),!N[o])return;j=Kh(E,C,r,d,a,o),b.push(j)}var P=e[n](T,ee(ee({},j),{parentFlag:!0}));return u&&(N[o]=null),P});return c&&(h.childGestos=m.map(function(E){return E.state.gestos[o]})),{eventParams:w,childEvents:b}}function Ts(t,e,n,r,i,a){i===void 0&&(i=function(h,p){return p});var o=!!n.match(/End$/g),c=Qi(t,e.name,r),u=t.moveables,d=c.map(function(h,p){var m=u[p],b=h;b=i(m,h);var w=e[n](m,ee(ee({},b),{parentFlag:!0}));return o&&(m.state.gestos={}),w});return d}function Jm(t,e,n,r){var i=n.fixedDirection,a=n.fixedPosition,o=r.datas.startPositions||Di(e.state),c=Fn(o,i),u=ne(hr(Yh(-t.rotation/180*Math.PI,3),[c[0]-a[0],c[1]-a[1],1],3),2),d=u[0],h=u[1];return r.datas.originalX=d,r.datas.originalY=h,r}function gP(t,e,n,r){var i=t.getState(),a=i.renderPoses,o=i.rotation,c=i.direction,u=ic(t.props,e).zoom,d=Bf(o/Math.PI*180),h={},p=t.renderState;p.renderDirectionMap||(p.renderDirectionMap={});var m=p.renderDirectionMap;n.forEach(function(w){var E=w.dir;h[E]=!0});var b=xr(c);return n.map(function(w){var E=w.data,S=w.classNames,T=w.dir,C=iE[T];if(!C||!h[T])return null;m[T]=!0;var N=(rt(d,15)+b*sP[T]+720)%180,j={};return Ps(E).forEach(function(P){j["data-".concat(P)]=E[P]}),r.createElement("div",ee({className:Fe.apply(void 0,Ce(["control","direction",T,e],ne(S),!1)),"data-rotation":N,"data-direction":T},j,{key:"direction-".concat(T),style:r0.apply(void 0,Ce([o,u],ne(C.map(function(P){return a[P]})),!1))}))})}function mP(t,e,n,r){var i=ic(t.props,n),a=i.renderDirections,o=a===void 0?e:a,c=i.displayAroundControls;if(!o)return[];var u=o===!0?nE:o;return Ce(Ce([],ne(c?xP(t,r,n,u):[]),!1),ne(gP(t,n,u.map(function(d){return{data:{},classNames:[],dir:d}}),r)),!1)}function ph(t,e,n,r,i,a){for(var o=[],c=6;c<arguments.length;c++)o[c-6]=arguments[c];var u=wn(n,r),d=e?rt(u/Math.PI*180,15)%180:-1;return t.createElement("div",{key:"line-".concat(a),className:Fe.apply(void 0,Ce(["line","direction",e?"edge":"",e],ne(o),!1)),"data-rotation":d,"data-line-key":a,"data-direction":e,style:Tf(n,r,i,u)})}function vP(t,e,n,r,i){var a=n===!0?bK:n;return a.map(function(o,c){var u=ne(iE[o],2),d=u[0],h=u[1];if(h!=null)return ph(t,o,r[d],r[h],i,"".concat(e,"Edge").concat(c),e)}).filter(Boolean)}function yP(t){return function(e,n){var r=ic(e.props,t).edge;return r&&(r===!0||r.length)?Ce(Ce([],ne(vP(n,t,r,e.getState().renderPoses,e.props.zoom)),!1),ne(QK(e,t,n)),!1):bP(e,t,n)}}function bP(t,e,n){return mP(t,nE,e,n)}function QK(t,e,n){return mP(t,["nw","ne","sw","se"],e,n)}function xP(t,e,n,r){var i=t.renderState;i.renderDirectionMap||(i.renderDirectionMap={});var a=t.getState(),o=a.renderPoses,c=a.rotation,u=a.direction,d=i.renderDirectionMap,h=t.props.zoom,p=xr(u),m=c/Math.PI*180;return(r||Ps(d)).map(function(b){var w=iE[b];if(!w)return null;var E=(rt(m,15)+p*sP[b]+720)%180,S=["around-control"];return n&&S.push("direction",n),e.createElement("div",{className:Fe.apply(void 0,Ce([],ne(S),!1)),"data-rotation":E,"data-direction":b,key:"direction-around-".concat(b),style:r0.apply(void 0,Ce([c,h],ne(w.map(function(T){return o[T]})),!1))})})}function oE(t,e,n){var r=t||{},i=r.position,a=i===void 0?"client":i,o=r.left,c=o===void 0?-1/0:o,u=r.top,d=u===void 0?-1/0:u,h=r.right,p=h===void 0?1/0:h,m=r.bottom,b=m===void 0?1/0:m,w={position:a,left:c,top:d,right:p,bottom:b};return{vertical:LR(w,e,!0),horizontal:LR(w,n,!1)}}function rv(t,e){var n=t.state,r=n.containerClientRect,i=r.clientHeight,a=r.clientWidth,o=r.clientLeft,c=r.clientTop,u=n.snapOffset,d=u.left,h=u.top,p=u.right,m=u.bottom,b=e||t.props.bounds||{},w=b.position||"client",E=w==="css",S=b.left,T=S===void 0?-1/0:S,C=b.top,N=C===void 0?-1/0:C,j=b.right,P=j===void 0?E?-1/0:1/0:j,M=b.bottom,A=M===void 0?E?-1/0:1/0:M;return E&&(P=a+p-d-P,A=i+m-h-A),{left:T+d-o,right:P+d-o,top:N+h-c,bottom:A+h-c}}function ZK(t,e,n){var r=rv(t),i=r.left,a=r.top,o=r.right,c=r.bottom,u=ne(n,2),d=u[0],h=u[1],p=ne(He(n,e),2),m=p[0],b=p[1];Ee(m)<Tr&&(m=0),Ee(b)<Tr&&(b=0);var w=b>0,E=m>0,S={isBound:!1,offset:0,pos:0},T={isBound:!1,offset:0,pos:0};if(m===0&&b===0)return{vertical:S,horizontal:T};if(m===0)w?c<h&&(T.pos=c,T.offset=h-c):a>h&&(T.pos=a,T.offset=h-a);else if(b===0)E?o<d&&(S.pos=o,S.offset=d-o):i>d&&(S.pos=i,S.offset=d-i);else{var C=b/m,N=n[1]-C*d,j=0,P=0,M=!1;E&&o<=d?(j=C*o+N,P=o,M=!0):!E&&d<=i&&(j=C*i+N,P=i,M=!0),M&&(j<a||j>c)&&(M=!1),M||(w&&c<=h?(j=c,P=(j-N)/C,M=!0):!w&&h<=a&&(j=a,P=(j-N)/C,M=!0)),M&&(S.isBound=!0,S.pos=P,S.offset=d-P,T.isBound=!0,T.pos=j,T.offset=h-j)}return{vertical:S,horizontal:T}}function LR(t,e,n){var r=t[n?"left":"top"],i=t[n?"right":"bottom"],a=Math.min.apply(Math,Ce([],ne(e),!1)),o=Math.max.apply(Math,Ce([],ne(e),!1)),c=[];return r+1>a&&c.push({direction:"start",isBound:!0,offset:a-r,pos:r}),i-1<o&&c.push({direction:"end",isBound:!0,offset:o-i,pos:i}),c.length||c.push({isBound:!1,offset:0,pos:0}),c.sort(function(u,d){return Ee(d.offset)-Ee(u.offset)})}function BR(t,e,n){var r=n?t.map(function(i){return qh(i,n)}):t;return r.some(function(i){return i[0]<e.left&&Ee(i[0]-e.left)>.1||i[0]>e.right&&Ee(i[0]-e.right)>.1||i[1]<e.top&&Ee(i[1]-e.top)>.1||i[1]>e.bottom&&Ee(i[1]-e.bottom)>.1})}function JK(t,e,n){var r=Ni(t),i=Math.sqrt(r*r-e*e)||0;return[i,-i].sort(function(a,o){return Ee(a-t[n?0:1])-Ee(o-t[n?0:1])}).map(function(a){return wn([0,0],n?[a,e]:[e,a])})}function eQ(t,e,n,r,i){if(!t.props.bounds)return[];var a=i*Math.PI/180,o=rv(t),c=o.left,u=o.top,d=o.right,h=o.bottom,p=c-r[0],m=d-r[0],b=u-r[1],w=h-r[1],E={left:p,top:b,right:m,bottom:w};if(!BR(n,E,0))return[];var S=[];return[[p,0],[m,0],[b,1],[w,1]].forEach(function(T){var C=ne(T,2),N=C[0],j=C[1];n.forEach(function(P){var M=wn([0,0],P);S.push.apply(S,Ce([],ne(JK(P,N,j).map(function(A){return a+A-M}).filter(function(A){return!BR(e,E,A)}).map(function(A){return rt(A*180/Math.PI,Tr)})),!1))})}),S}var tQ=["left","right","center"],nQ=["top","bottom","middle"],UR={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},Qo={start:"left",end:"right",center:"center"},Zo={start:"top",end:"bottom",center:"middle"};function pu(){return{left:!1,top:!1,right:!1,bottom:!1}}function cd(t,e){var n=t.props,r=n.snappable,i=n.bounds,a=n.innerBounds,o=n.verticalGuidelines,c=n.horizontalGuidelines,u=n.snapGridWidth,d=n.snapGridHeight,h=t.state,p=h.guidelines,m=h.enableSnap;return!r||!m||e&&r!==!0&&r.indexOf(e)<0?!1:!!(u||d||i||a||p&&p.length||o&&o.length||c&&c.length)}function lE(t){return t===!1?{}:t===!0||!t?{left:!0,right:!0,top:!0,bottom:!0}:t}function rQ(t,e){var n=lE(t),r={};for(var i in n)i in e&&n[i]&&(r[i]=e[i]);return r}function cE(t,e){var n=rQ(t,e),r=nQ.filter(function(a){return a in n}),i=tQ.filter(function(a){return a in n});return{horizontalNames:r,verticalNames:i,horizontal:r.map(function(a){return n[a]}),vertical:i.map(function(a){return n[a]})}}function iQ(t,e,n){var r=an(t,[e.clientLeft,e.clientTop],n);return[e.left+r[0],e.top+r[1]]}function aQ(t){var e=ne(t,2),n=e[0],r=e[1],i=r[0]-n[0],a=r[1]-n[1];Math.abs(i)<Pn&&(i=0),Math.abs(a)<Pn&&(a=0);var o=0,c=0,u=0;return i?a?(o=-a/i,c=1,u=o*n[0]-n[1]):(c=1,u=-n[1]):(o=-1,u=n[0]),[o,c,u].map(function(d){return rt(d,Pn)})}var wP="snapRotationThreshold",_P="snapRotationDegrees",EP="snapHorizontalThreshold",SP="snapVerticalThreshold";function iv(t,e,n,r,i,a,o){var c;r===void 0&&(r=[]),i===void 0&&(i=[]);var u=t.props,d=((c=t.state.snapThresholdInfo)===null||c===void 0?void 0:c.multiples)||[1,1],h=nN(o,u[EP],5),p=nN(a,u[SP],5);return TP(t.state.guidelines,e,n,r,i,h,p,d)}function TP(t,e,n,r,i,a,o,c){return{vertical:$R(t,"vertical",e,o*c[0],r),horizontal:$R(t,"horizontal",n,a*c[1],i)}}function sQ(t,e,n){var r=ne(n,2),i=r[0],a=r[1],o=ne(e,2),c=o[0],u=o[1],d=ne(He(n,e),2),h=d[0],p=d[1],m=p>0,b=h>0;h=i0(h),p=i0(p);var w={isSnap:!1,offset:0,pos:0},E={isSnap:!1,offset:0,pos:0};if(h===0&&p===0)return{vertical:w,horizontal:E};var S=iv(t,h?[i]:[],p?[a]:[],[],[],void 0,void 0),T=S.vertical,C=S.horizontal;T.posInfos.filter(function(q){var K=q.pos;return b?K>=c:K<=c}),C.posInfos.filter(function(q){var K=q.pos;return m?K>=u:K<=u}),T.isSnap=T.posInfos.length>0,C.isSnap=C.posInfos.length>0;var N=M1(T),j=N.isSnap,P=N.guideline,M=M1(C),A=M.isSnap,k=M.guideline,D=A?k.pos[1]:0,V=j?P.pos[0]:0;if(h===0)A&&(E.isSnap=!0,E.pos=k.pos[1],E.offset=a-E.pos);else if(p===0)j&&(w.isSnap=!0,w.pos=V,w.offset=i-V);else{var L=p/h,U=n[1]-L*i,O=0,J=0,W=!1;j?(J=V,O=L*J+U,W=!0):A&&(O=D,J=(O-U)/L,W=!0),W&&(w.isSnap=!0,w.pos=J,w.offset=i-J,E.isSnap=!0,E.pos=O,E.offset=a-O)}return{vertical:w,horizontal:E}}function Ro(t){var e="";return t===-1||t==="top"||t==="left"?e="start":t===0||t==="center"||t==="middle"?e="center":(t===1||t==="right"||t==="bottom")&&(e="end"),e}function FR(t,e,n,r){var i=cE(t.props.snapDirections,e),a=iv(t,i.vertical,i.horizontal,i.verticalNames.map(function(u){return Ro(u)}),i.horizontalNames.map(function(u){return Ro(u)}),n,r),o=Ro(i.horizontalNames[a.horizontal.index]),c=Ro(i.verticalNames[a.vertical.index]);return{vertical:ee(ee({},a.vertical),{direction:c}),horizontal:ee(ee({},a.horizontal),{direction:o})}}function M1(t){var e=t.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var n=t.posInfos[0],r=n.guidelineInfos[0],i=r.offset,a=r.dist,o=r.guideline;return{isSnap:e,offset:i,dist:a,pos:n.pos,guideline:o}}function $R(t,e,n,r,i){var a,o;if(i===void 0&&(i=[]),!t||!t.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var c=e==="vertical",u=c?0:1,d=n.map(function(p,m){var b=i[m]||"",w=t.map(function(E){var S=E.pos,T=p-S[u];return{offset:T,dist:Ee(T),guideline:E,direction:b}}).filter(function(E){var S=E.guideline,T=E.dist,C=S.type;return!(C!==e||T>r)}).sort(function(E,S){return E.dist-S.dist});return{pos:p,index:m,guidelineInfos:w,direction:b}}).filter(function(p){return p.guidelineInfos.length>0}).sort(function(p,m){return p.guidelineInfos[0].dist-m.guidelineInfos[0].dist}),h=d.length>0;return{isSnap:h,index:h?d[0].index:-1,direction:(o=(a=d[0])===null||a===void 0?void 0:a.direction)!==null&&o!==void 0?o:"",posInfos:d}}function oQ(t,e,n,r,i){var a=[];n[0]&&n[1]?a=[n,[-n[0],n[1]],[n[0],-n[1]]]:!n[0]&&!n[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(m,b,w){var E=w[b+1]||w[0];a.push(m),a.push([(m[0]+E[0])/2,(m[1]+E[1])/2])}):t.props.keepRatio?a.push([-1,-1],[-1,1],[1,-1],[1,1],n):(a.push.apply(a,Ce([],ne(jK([[-1,-1],[1,-1],[-1,-1],[1,1]],n)),!1)),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var o=a.map(function(m){return Fn(e,m)}),c=o.map(function(m){return m[0]}),u=o.map(function(m){return m[1]}),d=iv(t,c,u,a.map(function(m){return Ro(m[0])}),a.map(function(m){return Ro(m[1])}),r,i),h=Ro(a.map(function(m){return m[0]})[d.vertical.index]),p=Ro(a.map(function(m){return m[1]})[d.horizontal.index]);return{vertical:ee(ee({},d.vertical),{direction:h}),horizontal:ee(ee({},d.horizontal),{direction:p})}}function AP(t,e){var n=Ee(t.offset),r=Ee(e.offset);return t.isBound&&e.isBound?r-n:t.isBound?-1:e.isBound?1:t.isSnap&&e.isSnap?r-n:t.isSnap?-1:e.isSnap||n<Tr?1:r<Tr?-1:n-r}function e0(t,e){return t.slice().sort(function(n,r){var i=n.sign[e],a=r.sign[e],o=n.offset[e],c=r.offset[e];if(i){if(!a)return-1}else return 1;return AP({isBound:n.isBound,isSnap:n.isSnap,offset:o},{isBound:r.isBound,isSnap:r.isSnap,offset:c})})[0]}function lQ(t,e,n){var r=[];if(n)Ee(e[0])!==1||Ee(e[1])!==1?r.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):r.push([e,[t[0],-t[1]]],[e,[-t[0],t[1]]]),r.push([e,t]);else if(t[0]&&t[1]||!t[0]&&!t[1]){var i=t[0]?t:[1,1];[1,-1].forEach(function(o){[1,-1].forEach(function(c){var u=[o*i[0],c*i[1]];e[0]===u[0]&&e[1]===u[1]||r.push([e,u])})})}else if(t[0]){var a=Ee(e[0])===1?[1]:[1,-1];a.forEach(function(o){r.push([[e[0],-1],[o*t[0],-1]],[[e[0],0],[o*t[0],0]],[[e[0],1],[o*t[0],1]])})}else if(t[1]){var a=Ee(e[1])===1?[1]:[1,-1];a.forEach(function(c){r.push([[-1,e[1]],[-1,c*t[1]]],[[0,e[1]],[0,c*t[1]]],[[1,e[1]],[1,c*t[1]]])})}return r}function CP(t,e){var n=y1([e[0][0],e[1][0]]),r=y1([e[0][1],e[1][1]]);return{vertical:n<=t[0],horizontal:r<=t[1]}}function uE(t,e){var n=ne(e,2),r=n[0],i=n[1],a=i[0]-r[0],o=i[1]-r[1];Ee(a)<Tr&&(a=0),Ee(o)<Tr&&(o=0);var c,u;if(!a)c=r[0],u=t[0];else if(!o)c=r[1],u=t[1];else{var d=o/a;c=d*(t[0]-r[0])+r[1],u=t[1]}return c-u}function kP(t,e,n,r){return r===void 0&&(r=Tr),t.every(function(i){var a=uE(i,e),o=a<=0;return o===n||Ee(a)<=r})}function GR(t,e,n,r,i){return i===void 0&&(i=0),r&&e-i<=t||!r&&t<=n+i?{isBound:!0,offset:r?e-t:n-t}:{isBound:!1,offset:0}}function cQ(t,e){var n=e.line,r=e.centerSign,i=e.verticalSign,a=e.horizontalSign,o=e.lineConstants,c=t.props.innerBounds;if(!c)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var u=c.left,d=c.top,h=c.width,p=c.height,m=[[u,d],[u,d+p]],b=[[u,d],[u+h,d]],w=[[u+h,d],[u+h,d+p]],E=[[u,d+p],[u+h,d+p]];if(kP([[u,d],[u+h,d],[u,d+p],[u+h,d+p]],n,r))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var S=No(n,o,b,i),T=No(n,o,E,i),C=No(n,o,m,a),N=No(n,o,w,a),j=S.isBound&&T.isBound,P=S.isBound||T.isBound,M=C.isBound&&N.isBound,A=C.isBound||N.isBound,k=Lu(S.offset,T.offset),D=Lu(C.offset,N.offset),V=[0,0],L=!1,U=!1;return Ee(D)<Ee(k)?(V=[k,0],L=P,U=j):(V=[0,D],L=A,U=M),{isAllBound:U,isVerticalBound:P,isHorizontalBound:A,isBound:L,offset:V}}function No(t,e,n,r,i,a){var o=ne(e,2),c=o[0],u=o[1],d=t[0],h=n[0],p=n[1],m=i0(p[1]-h[1]),b=i0(p[0]-h[0]),w=u,E=c,S=-c/u;if(b){if(!m){if(a&&!w)return{isBound:!1,offset:0};if(E){var j=(h[1]-d[1])/S+d[0];return GR(j,h[0],p[0],r,i)}else{var C=h[1]-d[1],N=Ee(C)<=(i||0);return{isBound:N,offset:N?C:0}}}}else{if(a&&!E)return{isBound:!1,offset:0};if(w){var T=S*(h[0]-d[0])+d[1];return GR(T,h[1],p[1],r,i)}else{var C=h[0]-d[0],N=Ee(C)<=(i||0);return{isBound:N,offset:N?C:0}}}return{isBound:!1,offset:0}}function RP(t,e,n){return e.map(function(r){var i=cQ(t,r),a=i.isBound,o=i.offset,c=i.isVerticalBound,u=i.isHorizontalBound,d=r.multiple,h=Ya({datas:n,distX:o[0],distY:o[1]}).map(function(p,m){return p*(d[m]?2/d[m]:0)});return{sign:d,isBound:a,isVerticalBound:c,isHorizontalBound:u,isSnap:!1,offset:h}})}function uQ(t,e,n){var r,i=dE(t,e,[0,0],!1).map(function(m){return ee(ee({},m),{multiple:m.multiple.map(function(b){return Ee(b)*2})})}),a=RP(t,i,n),o=e0(a,0),c=e0(a,1),u=0,d=0,h=o.isVerticalBound||c.isVerticalBound,p=o.isHorizontalBound||c.isHorizontalBound;return(h||p)&&(r=ne(OK({datas:n,distX:-o.offset[0],distY:-c.offset[1]}),2),u=r[0],d=r[1]),{vertical:{isBound:h,offset:u},horizontal:{isBound:p,offset:d}}}function dQ(t,e){var n=[],r=t[0],i=t[1];return r&&i?n.push([[0,i*2],t,[-r,i]],[[r*2,0],t,[r,-i]]):r?(n.push([[r*2,0],[r,1],[r,-1]]),e&&n.push([[0,-1],[r,-1],[-r,-1]],[[0,1],[r,1],[-r,1]])):i?(n.push([[0,i*2],[1,i],[-1,i]]),e&&n.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):n.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),n}function dE(t,e,n,r){var i=t.state,a=i.allMatrix,o=i.is3d,c=dc(a,100,100,o?4:3),u=Fn(c,[0,0]);return dQ(n,r).map(function(d){var h=ne(d,3),p=h[0],m=h[1],b=h[2],w=[Fn(c,m),Fn(c,b)],E=aQ(w),S=CP(u,w),T=S.vertical,C=S.horizontal,N=uE(u,w)<=0;return{multiple:p,centerSign:N,verticalSign:T,horizontalSign:C,lineConstants:E,line:[Fn(e,m),Fn(e,b)]}})}function HR(t,e,n,r){var i=r?t.map(function(a){return qh(a,r)}):t;return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some(function(a){var o=uE(n,a)<=0;return!kP(e,a,o)})}function fQ(t){var e=ne(t,2),n=e[0],r=e[1],i=r[0]-n[0],a=r[1]-n[1];if(!i)return Ee(n[0]);if(!a)return Ee(n[1]);var o=a/i;return Ee((-o*n[0]+n[1])/Math.sqrt(Math.pow(o,2)+1))}function hQ(t){var e=ne(t,2),n=e[0],r=e[1],i=r[0]-n[0],a=r[1]-n[1];if(!i)return[n[0],0];if(!a)return[0,n[1]];var o=a/i,c=-o*n[0]+n[1];return[-c/(o+1/o),c/(o*o+1)]}function pQ(t,e,n,r,i){var a=t.props.innerBounds,o=i*Math.PI/180;if(!a)return[];var c=a.left,u=a.top,d=a.width,h=a.height,p=c-r[0],m=c+d-r[0],b=u-r[1],w=u+h-r[1],E=[[p,b],[m,b],[p,w],[m,w]],S=Fn(n,[0,0]);if(!HR(n,E,S,0))return[];var T=[],C=E.map(function(N){return[Ni(N),wn([0,0],N)]});return[[n[0],n[1]],[n[1],n[3]],[n[3],n[2]],[n[2],n[0]]].forEach(function(N){var j=wn([0,0],hQ(N)),P=fQ(N);T.push.apply(T,Ce([],ne(C.filter(function(M){var A=ne(M,1),k=A[0];return k&&P<=k}).map(function(M){var A=ne(M,2),k=A[0],D=A[1],V=Math.acos(k?P/k:0),L=D+V,U=D-V;return[o+L-j,o+U-j]}).reduce(function(M,A){return M.push.apply(M,Ce([],ne(A),!1)),M},[]).filter(function(M){return!HR(e,E,S,M)}).map(function(M){return rt(M*180/Math.PI,Tr)})),!1))}),T}function gQ(t){var e=t.props.innerBounds,n=pu();if(!e)return{boundMap:n,vertical:[],horizontal:[]};var r=t.getRect(),i=r.pos1,a=r.pos2,o=r.pos3,c=r.pos4,u=[i,a,o,c],d=Fn(u,[0,0]),h=e.left,p=e.top,m=e.width,b=e.height,w=[[h,p],[h,p+b]],E=[[h,p],[h+m,p]],S=[[h+m,p],[h+m,p+b]],T=[[h,p+b],[h+m,p+b]],C=dE(t,u,[0,0],!1),N=[],j=[];return C.forEach(function(P){var M=P.line,A=P.lineConstants,k=CP(d,M),D=k.horizontal,V=k.vertical,L=No(M,A,E,V,1,!0),U=No(M,A,T,V,1,!0),O=No(M,A,w,D,1,!0),J=No(M,A,S,D,1,!0);L.isBound&&!n.top&&(N.push(p),n.top=!0),U.isBound&&!n.bottom&&(N.push(p+b),n.bottom=!0),O.isBound&&!n.left&&(j.push(h),n.left=!0),J.isBound&&!n.right&&(j.push(h+m),n.right=!0)}),{boundMap:n,horizontal:N,vertical:j}}function mQ(t,e,n,r){var i=e[0]-t[0],a=e[1]-t[1];if(Ee(i)<Pn&&(i=0),Ee(a)<Pn&&(a=0),!i)return r?[0,0]:[0,n];if(!a)return r?[n,0]:[0,0];var o=a/i,c=t[1]-o*t[0];if(r){var u=o*(e[0]+n)+c;return[n,u-e[1]]}else{var d=(e[1]+n-c)/o;return[d-e[0],n]}}function O1(t,e,n,r,i){var a=mQ(t,e,n,r);if(!a)return{isOutside:!1,offset:[0,0]};var o=Ss(t,e),c=Ss(a,t),u=Ss(a,e),d=c>o||u>o,h=ne(Ya({datas:i,distX:a[0],distY:a[1]}),2),p=h[0],m=h[1];return{offset:[p,m],isOutside:d}}function t0(t,e){return t.isBound?t.offset:e.isSnap?M1(e).offset:0}function vQ(t,e,n,r,i){var a=ne(e,2),o=a[0],c=a[1],u=ne(n,2),d=u[0],h=u[1],p=ne(r,2),m=p[0],b=p[1],w=ne(i,2),E=w[0],S=w[1],T=-E,C=-S;if(t&&o&&c){T=0,C=0;var N=[];if(d&&h?N.push([0,S],[E,0]):d?N.push([E,0]):h?N.push([0,S]):m&&b?N.push([0,S],[E,0]):m?N.push([E,0]):b&&N.push([0,S]),N.length){N.sort(function(A,k){return Ni(He([o,c],A))-Ni(He([o,c],k))});var j=N[0];if(j[0]&&Ee(o)>Pn)T=-j[0],C=c*Ee(o+T)/Ee(o)-c;else if(j[1]&&Ee(c)>Pn){var P=c;C=-j[1],T=o*Ee(c+C)/Ee(P)-o}if(t&&h&&d)if(Ee(T)>Pn&&Ee(T)<Ee(E)){var M=Ee(E)/Ee(T);T*=M,C*=M}else if(Ee(C)>Pn&&Ee(C)<Ee(S)){var M=Ee(S)/Ee(C);T*=M,C*=M}else T=Lu(-E,T),C=Lu(-S,C)}}else T=o||d?-E:0,C=c||h?-S:0;return[T,C]}function yQ(t,e,n,r,i,a){if(!cd(t,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var o=pE(a.absolutePoses,[e,n]),c=ki(o),u=c.left,d=c.right,h=c.top,p=c.bottom,m={horizontal:o.map(function(J){return J[1]}),vertical:o.map(function(J){return J[0]})},b=lE(t.props.snapDirections),w=cE(b,{left:u,right:d,top:h,bottom:p,center:(u+d)/2,middle:(h+p)/2}),E=av(t,i,w,m),S=E.vertical,T=E.horizontal,C=uQ(t,o,a),N=C.vertical,j=C.horizontal,P=S.isSnap,M=T.isSnap,A=S.isBound||N.isBound,k=T.isBound||j.isBound,D=Lu(S.offset,N.offset),V=Lu(T.offset,j.offset),L=ne(vQ(r,[e,n],[A,k],[P,M],[D,V]),2),U=L[0],O=L[1];return[{isBound:A,isSnap:P,offset:U},{isBound:k,isSnap:M,offset:O}]}function av(t,e,n,r){r===void 0&&(r=n);var i=oE(rv(t),r.vertical,r.horizontal),a=i.horizontal,o=i.vertical,c=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:iv(t,n.vertical,n.horizontal,void 0,void 0,void 0,void 0),u=c.horizontal,d=c.vertical,h=t0(a[0],u),p=t0(o[0],d),m=Ee(h),b=Ee(p);return{horizontal:{isBound:a[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:h,dist:m,bounds:a,snap:u},vertical:{isBound:o[0].isBound,isSnap:d.isSnap,snapIndex:d.index,offset:p,dist:b,bounds:o,snap:d}}}function qR(t,e,n,r,i,a,o){o===void 0&&(o=[1,1]);var c=oE(e,n,r),u=c.horizontal,d=c.vertical,h=TP(t,n,r,[],[],i,a,o),p=h.horizontal,m=h.vertical,b=t0(u[0],p),w=t0(d[0],m),E=Ee(b),S=Ee(w);return{horizontal:{isBound:u[0].isBound,isSnap:p.isSnap,snapIndex:p.index,offset:b,dist:E,bounds:u,snap:p},vertical:{isBound:d[0].isBound,isSnap:m.isSnap,snapIndex:m.index,offset:w,dist:S,bounds:d,snap:m}}}function bQ(t,e,n,r){var i=wn(t,e)/Math.PI*180,a=n.vertical,o=a.isBound,c=a.isSnap,u=a.dist,d=n.horizontal,h=d.isBound,p=d.isSnap,m=d.dist,b=i%180,w=b<3||b>177,E=b>87&&b<93;return m<u&&(o||c&&!E&&(!r||!w))?"vertical":h||p&&!w&&(!r||!E)?"horizontal":""}function xQ(t,e,n,r,i,a){return n.map(function(o){var c=ne(o,2),u=c[0],d=c[1],h=Fn(e,u),p=Fn(e,d),m=r?wQ(t,h,p,i):av(t,i,{vertical:[p[0]],horizontal:[p[1]]}),b=m.horizontal,w=b.offset,E=b.isBound,S=b.isSnap,T=m.vertical,C=T.offset,N=T.isBound,j=T.isSnap,P=He(d,u);if(!C&&!w)return{isBound:N||E,isSnap:j||S,sign:P,offset:[0,0]};var M=bQ(h,p,m,r);if(!M)return{sign:P,isBound:!1,isSnap:!1,offset:[0,0]};var A=M==="vertical",k=[0,0];return!r&&Ee(d[0])===1&&Ee(d[1])===1&&u[0]!==d[0]&&u[1]!==d[1]?k=Ya({datas:a,distX:-C,distY:-w}):k=O1(h,p,-(A?C:w),A,a).offset,k=k.map(function(D,V){return D*(P[V]?2/P[V]:0)}),{sign:P,isBound:A?N:E,isSnap:A?j:S,offset:k}})}function YR(t,e){return t.isBound?t.offset:e.isSnap?e.offset:0}function wQ(t,e,n,r){var i=ZK(t,e,n),a=i.horizontal,o=i.vertical,c=r?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:sQ(t,e,n),u=c.horizontal,d=c.vertical,h=YR(a,u),p=YR(o,d),m=Ee(h),b=Ee(p);return{horizontal:{isBound:a.isBound,isSnap:u.isSnap,offset:h,dist:m},vertical:{isBound:o.isBound,isSnap:d.isSnap,offset:p,dist:b}}}function _Q(t,e,n,r,i){var a=[-n[0],-n[1]],o=t.state,c=o.width,u=o.height,d=t.props.bounds,h=1/0,p=1/0;if(d){var m=[[n[0],-n[1]],[-n[0],n[1]]],b=d.left,w=b===void 0?-1/0:b,E=d.top,S=E===void 0?-1/0:E,T=d.right,C=T===void 0?1/0:T,N=d.bottom,j=N===void 0?1/0:N;m.forEach(function(P){var M=P[0]!==a[0],A=P[1]!==a[1],k=Fn(e,P),D=wn(r,k)*360/Math.PI;if(A){var V=k.slice();(Ee(D-360)<2||Ee(D-180)<2)&&(V[1]=r[1]);var L=O1(r,V,(r[1]<k[1]?j:S)-k[1],!1,i),U=ne(L.offset,2),O=U[1],J=L.isOutside;isNaN(O)||(p=u+(J?1:-1)*Ee(O))}if(M){var V=k.slice();(Ee(D-90)<2||Ee(D-270)<2)&&(V[0]=r[0]);var W=O1(r,V,(r[0]<k[0]?C:w)-k[0],!0,i),q=ne(W.offset,1),K=q[0],te=W.isOutside;isNaN(K)||(h=c+(te?1:-1)*Ee(K))}})}return{maxWidth:h,maxHeight:p}}var br={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(t,e){var n=t.props,r=n.hideThrottleDragRotateLine,i=n.throttleDragRotate,a=n.zoom,o=t.getState(),c=o.dragInfo,u=o.beforeOrigin;if(r||!i||!c)return[];var d=c.dist;if(!d[0]&&!d[1])return[];var h=Ni(d),p=wn(d,[0,0]);return[e.createElement("div",{className:Fe("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(h,"px"),transform:"translate(".concat(u[0],"px, ").concat(u[1],"px) rotate(").concat(p,"rad) scaleY(").concat(a,")")}})]},dragStart:function(t,e){var n=e.datas,r=e.parentEvent,i=e.parentGesto,a=t.state,o=a.gestos,c=a.style;if(o.draggable)return!1;o.draggable=i||t.targetGesto,n.datas={},n.left=parseFloat(c.left||"")||0,n.top=parseFloat(c.top||"")||0,n.bottom=parseFloat(c.bottom||"")||0,n.right=parseFloat(c.right||"")||0,n.startValue=[0,0],uc(t,e),nv(t,e,"translate"),UQ(t,n),n.prevDist=[0,0],n.prevBeforeDist=[0,0],n.isDrag=!1,n.deltaOffset=[0,0];var u=ct(t,e,ee({set:function(h){n.startValue=h}},tv(t,e))),d=r||Pe(t,"onDragStart",u);return d!==!1?(n.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(o.draggable=null,n.isPinch=!1),n.isDrag?u:!1},drag:function(t,e){if(e){J0(t,e,"translate");var n=e.datas,r=e.parentEvent,i=e.parentFlag,a=e.isPinch,o=e.deltaOffset,c=e.useSnap,u=e.isRequest,d=e.isGroup,h=e.parentThrottleDrag,p=e.distX,m=e.distY,b=n.isDrag,w=n.prevDist,E=n.prevBeforeDist,S=n.startValue;if(b){o&&(p+=o[0],m+=o[1]);var T=t.props,C=T.parentMoveable,N=d?0:T.throttleDrag||h||0,j=r?0:T.throttleDragRotate||0,P=0,M=!1,A=!1,k=!1,D=!1;if(!r&&j>0&&(p||m)){var V=T.startDragRotate||0,L=rt(V+wn([0,0],[p,m])*180/Math.PI,j)-V,U=m*Math.abs(Math.cos((L-90)/180*Math.PI)),O=p*Math.abs(Math.cos(L/180*Math.PI)),J=Ni([O,U]);P=L*Math.PI/180,p=J*Math.cos(P),m=J*Math.sin(P)}if(!a&&!r&&!i){var W=ne(yQ(t,p,m,j,!c&&u||o,n),2),q=W[0],K=W[1];M=q.isSnap,A=q.isBound,k=K.isSnap,D=K.isBound;var te=q.offset,se=K.offset;p+=te,m+=se}var G=At(uP({datas:n,distX:p,distY:m}),S),F=At(MK({datas:n,distX:p,distY:m}),S);AR(F,Tr),AR(G,Tr),j||(!M&&!A&&(F[0]=rt(F[0],N),G[0]=rt(G[0],N)),!k&&!D&&(F[1]=rt(F[1],N),G[1]=rt(G[1],N)));var Y=He(G,S),Q=He(F,S),X=He(Q,w),ie=He(Y,E);n.prevDist=Q,n.prevBeforeDist=Y,n.passDelta=X,n.passDist=Q;var le=n.left+Y[0],ge=n.top+Y[1],pe=n.right-Y[0],_e=n.bottom-Y[1],Ie=ev(n,"translate(".concat(F[0],"px, ").concat(F[1],"px)"),"translate(".concat(Q[0],"px, ").concat(Q[1],"px)"));if(aE(e,Ie),t.state.dragInfo.dist=r?[0,0]:Q,!(!r&&!C&&X.every(function(Ve){return!Ve})&&ie.some(function(Ve){return!Ve}))){var ae=t.state,Ae=ae.width,Re=ae.height,De=ct(t,e,ee({transform:Ie,dist:Q,delta:X,translate:F,beforeDist:Y,beforeDelta:ie,beforeTranslate:G,left:le,top:ge,right:pe,bottom:_e,width:Ae,height:Re,isPinch:a},_r({transform:Ie},e)));return!r&&Pe(t,"onDrag",De),De}}}},dragAfter:function(t,e){var n=e.datas,r=n.deltaOffset;return r[0]||r[1]?(n.deltaOffset=[0,0],this.drag(t,ee(ee({},e),{deltaOffset:r}))):!1},dragEnd:function(t,e){var n=e.parentEvent,r=e.datas;if(t.state.dragInfo=null,!!r.isDrag){r.isDrag=!1;var i=ii(t,e,{});return!n&&Pe(t,"onDragEnd",i),i}},dragGroupStart:function(t,e){var n,r,i=e.datas,a=e.clientX,o=e.clientY,c=this.dragStart(t,e);if(!c)return!1;var u=tx(t,this,"dragStart",[a||0,o||0],e,!1,"draggable"),d=u.childEvents,h=u.eventParams,p=ee(ee({},c),{targets:t.props.targets,events:h}),m=Pe(t,"onDragGroupStart",p);i.isDrag=m!==!1;var b=(r=(n=d[0])===null||n===void 0?void 0:n.datas.startValue)!==null&&r!==void 0?r:[0,0];return i.throttleOffset=[b[0]%1,b[1]%1],i.isDrag?c:!1},dragGroup:function(t,e){var n=e.datas;if(n.isDrag){var r=this.drag(t,ee(ee({},e),{parentThrottleDrag:t.props.throttleDrag})),i=e.datas.passDelta,a=tx(t,this,"drag",i,e,!1,"draggable").eventParams;if(r){var o=ee({targets:t.props.targets,events:a},r);return Pe(t,"onDragGroup",o),o}}},dragGroupEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isDrag){this.dragEnd(t,e);var i=tx(t,this,"dragEnd",[0,0],e,!1,"draggable").eventParams;return Pe(t,"onDragGroupEnd",ii(t,e,{targets:t.props.targets,events:i})),n}},request:function(t){var e={},n=t.getRect(),r=0,i=0,a=!1;return{isControl:!1,requestStart:function(o){return a=o.useSnap,{datas:e,useSnap:a}},request:function(o){return"x"in o?r=o.x-n.left:"deltaX"in o&&(r+=o.deltaX),"y"in o?i=o.y-n.top:"deltaY"in o&&(i+=o.deltaY),{datas:e,distX:r,distY:i,useSnap:a}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:a}}}},unset:function(t){t.state.gestos.draggable=null,t.state.dragInfo=null}};function NP(t,e){var n=Fn(t,e),r=[0,0];return{fixedPosition:n,fixedDirection:e,fixedOffset:r}}function EQ(t,e){var n=t.allMatrix,r=t.is3d,i=t.width,a=t.height,o=r?4:3,c=[i/2*(1+e[0]),a/2*(1+e[1])],u=an(n,c,o),d=[0,0];return{fixedPosition:u,fixedDirection:e,fixedOffset:d}}function DP(t,e){var n=t.allMatrix,r=t.is3d,i=t.width,a=t.height,o=r?4:3,c=UK(e,i,a),u=an(n,e,o),d=[i?0:e[0],a?0:e[1]];return{fixedPosition:u,fixedDirection:c,fixedOffset:d}}var XR=vE("resizable"),P1={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:yP("resizable"),dragControlCondition:XR,viewClassName:mE("resizable"),dragControlStart:function(t,e){var n,r=e.inputEvent,i=e.isPinch,a=e.isGroup,o=e.parentDirection,c=e.parentGesto,u=e.datas,d=e.parentFixedDirection,h=e.parentEvent,p=GP(o,i,r,u),m=t.state,b=m.target,w=m.width,E=m.height,S=m.gestos;if(!p||!b||S.resizable)return!1;S.resizable=c||t.controlGesto,!i&&uc(t,e),u.datas={},u.direction=p,u.startOffsetWidth=w,u.startOffsetHeight=E,u.prevWidth=0,u.prevHeight=0,u.minSize=[0,0],u.startWidth=m.inlineCSSWidth||m.cssWidth,u.startHeight=m.inlineCSSHeight||m.cssHeight,u.maxSize=[1/0,1/0],a||(u.minSize=[m.minOffsetWidth,m.minOffsetHeight],u.maxSize=[m.maxOffsetWidth,m.maxOffsetHeight]);var T=t.props.transformOrigin||"% %";u.transformOrigin=Lr(T)?T.split(" "):T,u.startOffsetMatrix=m.offsetMatrix,u.startTransformOrigin=m.transformOrigin,u.isWidth=(n=e?.parentIsWidth)!==null&&n!==void 0?n:!p[0]&&!p[1]||p[0]||!p[1];function C(D){u.ratio=D&&isFinite(D)?D:0}u.startPositions=Di(t.state);function N(D){var V=NP(u.startPositions,D);u.fixedDirection=V.fixedDirection,u.fixedPosition=V.fixedPosition,u.fixedOffset=V.fixedOffset}function j(D){var V=DP(t.state,D);u.fixedDirection=V.fixedDirection,u.fixedPosition=V.fixedPosition,u.fixedOffset=V.fixedOffset}function P(D){u.minSize=[$t("".concat(D[0]),0)||0,$t("".concat(D[1]),0)||0]}function M(D){var V=[D[0]||1/0,D[1]||1/0];(!Pu(V[0])||isFinite(V[0]))&&(V[0]=$t("".concat(V[0]),0)||1/0),(!Pu(V[1])||isFinite(V[1]))&&(V[1]=$t("".concat(V[1]),0)||1/0),u.maxSize=V}C(w/E),N(d||[-p[0],-p[1]]),u.setFixedDirection=N,u.setFixedPosition=j,u.setMin=P,u.setMax=M;var A=ct(t,e,{direction:p,startRatio:u.ratio,set:function(D){var V=ne(D,2),L=V[0],U=V[1];u.startWidth=L,u.startHeight=U},setMin:P,setMax:M,setRatio:C,setFixedDirection:N,setFixedPosition:j,setOrigin:function(D){u.transformOrigin=D},dragStart:br.dragStart(t,new Vu().dragStart([0,0],e))}),k=h||Pe(t,"onResizeStart",A);return u.startFixedDirection=u.fixedDirection,u.startFixedPosition=u.fixedPosition,k!==!1&&(u.isResize=!0,t.state.snapRenderInfo={request:e.isRequest,direction:p}),u.isResize?A:!1},dragControl:function(t,e){var n,r=e.datas,i=e.parentFlag,a=e.isPinch,o=e.parentKeepRatio,c=e.dragClient,u=e.parentDist,d=e.useSnap,h=e.isRequest,p=e.isGroup,m=e.parentEvent,b=e.resolveMatrix,w=r.isResize,E=r.transformOrigin,S=r.startWidth,T=r.startHeight,C=r.prevWidth,N=r.prevHeight,j=r.minSize,P=r.maxSize,M=r.ratio,A=r.startOffsetWidth,k=r.startOffsetHeight,D=r.isWidth;if(!w)return;if(b){var V=t.state.is3d,L=r.startOffsetMatrix,U=r.startTransformOrigin,O=V?4:3,J=hh(Zm(e)),W=Math.sqrt(J.length);O!==W&&(J=ra(J,W,O));var q=Qh(L,J,U,O),K=dc(q,A,k,O);r.startPositions=K,r.nextTargetMatrix=J,r.nextAllMatrix=q}var te=ic(t.props,"resizable"),se=te.resizeFormat,G=te.throttleResize,F=G===void 0?i?0:1:G,Y=te.parentMoveable,Q=te.keepRatioFinally,X=r.direction,ie=X,le=0,ge=0;!X[0]&&!X[1]&&(ie=[1,1]);var pe=M&&(o??te.keepRatio)||!1;function _e(){var ut=r.fixedDirection,Rt=KP(ie,pe,r,e);le=Rt.distWidth,ge=Rt.distHeight;var cn=ie[0]-ut[0]||pe?Math.max(A+le,Tr):A,Mt=ie[1]-ut[1]||pe?Math.max(k+ge,Tr):k;return pe&&A&&k&&(D?Mt=cn/M:cn=Mt*M),[cn,Mt]}var Ie=ne(_e(),2),ae=Ie[0],Ae=Ie[1];m||(r.setFixedDirection(r.fixedDirection),Pe(t,"onBeforeResize",ct(t,e,{startFixedDirection:r.startFixedDirection,startFixedPosition:r.startFixedPosition,setFixedDirection:function(ut){var Rt;return r.setFixedDirection(ut),Rt=ne(_e(),2),ae=Rt[0],Ae=Rt[1],[ae,Ae]},setFixedPosition:function(ut){var Rt;return r.setFixedPosition(ut),Rt=ne(_e(),2),ae=Rt[0],Ae=Rt[1],[ae,Ae]},boundingWidth:ae,boundingHeight:Ae,setSize:function(ut){var Rt;Rt=ne(ut,2),ae=Rt[0],Ae=Rt[1]}},!0)));var Re=c;c||(!i&&a?Re=HK(t,[0,0]):Re=r.fixedPosition);var De=[0,0];a||(De=LQ(t,ae,Ae,X,Re,!d&&h,r)),u&&(!u[0]&&(De[0]=0),!u[1]&&(De[1]=0));function Ve(){var ut;se&&(ut=ne(se([ae,Ae]),2),ae=ut[0],Ae=ut[1]),ae=rt(ae,F),Ae=rt(Ae,F)}if(pe){ie[0]&&ie[1]&&De[0]&&De[1]&&(Ee(De[0])>Ee(De[1])?De[1]=0:De[0]=0);var ze=!De[0]&&!De[1];ze&&Ve(),ie[0]&&!ie[1]||De[0]&&!De[1]||ze&&D?(ae+=De[0],Ae=ae/M):(!ie[0]&&ie[1]||!De[0]&&De[1]||ze&&!D)&&(Ae+=De[1],ae=Ae*M)}else ae+=De[0],Ae+=De[1],ae=Math.max(0,ae),Ae=Math.max(0,Ae);n=ne(_4([ae,Ae],j,P,pe?M:!1),2),ae=n[0],Ae=n[1],Ve(),pe&&(p||Q)&&(D?Ae=ae/M:ae=Ae*M),le=ae-A,ge=Ae-k;var Se=[le-C,ge-N];r.prevWidth=le,r.prevHeight=ge;var Le=GK(t,ae,Ae,Re,E,r);if(!(!Y&&Se.every(function(ut){return!ut})&&Le.every(function(ut){return!ut}))){var Me=br.drag(t,Kh(e,t.state,Le,!!a,!1,"draggable")),Be=Me.transform,st=S+le,_t=T+ge,Ze=ct(t,e,ee({width:st,height:_t,offsetWidth:Math.round(ae),offsetHeight:Math.round(Ae),startRatio:M,boundingWidth:ae,boundingHeight:Ae,direction:X,dist:[le,ge],delta:Se,isPinch:!!a,drag:Me},qP({style:{width:"".concat(st,"px"),height:"".concat(_t,"px")},transform:Be},Me,e)));return!m&&Pe(t,"onResize",Ze),Ze}},dragControlAfter:function(t,e){var n=e.datas,r=n.isResize,i=n.startOffsetWidth,a=n.startOffsetHeight,o=n.prevWidth,c=n.prevHeight;if(!(!r||t.props.checkResizableError===!1)){var u=t.state,d=u.width,h=u.height,p=d-(i+o),m=h-(a+c),b=Ee(p)>3,w=Ee(m)>3;if(b&&(n.startWidth+=p,n.startOffsetWidth+=p,n.prevWidth+=p),w&&(n.startHeight+=m,n.startOffsetHeight+=m,n.prevHeight+=m),b||w)return this.dragControl(t,e)}},dragControlEnd:function(t,e){var n=e.datas,r=e.parentEvent;if(n.isResize){n.isResize=!1;var i=ii(t,e,{});return!r&&Pe(t,"onResizeEnd",i),i}},dragGroupControlCondition:XR,dragGroupControlStart:function(t,e){var n=e.datas,r=this.dragControlStart(t,ee(ee({},e),{isGroup:!0}));if(!r)return!1;var i=Qi(t,"resizable",e),a=n.startOffsetWidth,o=n.startOffsetHeight;function c(){var b=n.minSize;i.forEach(function(w){var E=w.datas,S=E.minSize,T=E.startOffsetWidth,C=E.startOffsetHeight,N=a*(T?S[0]/T:0),j=o*(C?S[1]/C:0);b[0]=Math.max(b[0],N),b[1]=Math.max(b[1],j)})}function u(){var b=n.maxSize;i.forEach(function(w){var E=w.datas,S=E.maxSize,T=E.startOffsetWidth,C=E.startOffsetHeight,N=a*(T?S[0]/T:0),j=o*(C?S[1]/C:0);b[0]=Math.min(b[0],N),b[1]=Math.min(b[1],j)})}var d=Ts(t,this,"dragControlStart",e,function(b,w){return Jm(t,b,n,w)});c(),u();var h=function(b){r.setFixedDirection(b),d.forEach(function(w,E){w.setFixedDirection(b),Jm(t,w.moveable,n,i[E])})};n.setFixedDirection=h;var p=ee(ee({},r),{targets:t.props.targets,events:d.map(function(b){return ee(ee({},b),{setMin:function(w){b.setMin(w),c()},setMax:function(w){b.setMax(w),u()}})}),setFixedDirection:h,setMin:function(b){r.setMin(b),c()},setMax:function(b){r.setMax(b),u()}}),m=Pe(t,"onResizeGroupStart",p);return n.isResize=m!==!1,n.isResize?r:!1},dragGroupControl:function(t,e){var n=e.datas;if(n.isResize){var r=ic(t.props,"resizable");ov(t,"onBeforeResize",function(b){Pe(t,"onBeforeResizeGroup",ct(t,e,ee(ee({},b),{targets:r.targets}),!0))});var i=this.dragControl(t,ee(ee({},e),{isGroup:!0}));if(i){var a=i.boundingWidth,o=i.boundingHeight,c=i.dist,u=r.keepRatio,d=[a/(a-c[0]),o/(o-c[1])],h=n.fixedPosition,p=Ts(t,this,"dragControl",e,function(b,w){var E=ne(hr(Yh(t.rotation/180*Math.PI,3),[w.datas.originalX*d[0],w.datas.originalY*d[1],1],3),2),S=E[0],T=E[1];return ee(ee({},w),{parentDist:null,parentScale:d,dragClient:At(h,[S,T]),parentKeepRatio:u})}),m=ee({targets:r.targets,events:p},i);return Pe(t,"onResizeGroup",m),m}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isResize){this.dragControlEnd(t,e);var i=Ts(t,this,"dragControlEnd",e),a=ii(t,e,{targets:t.props.targets,events:i});return Pe(t,"onResizeGroupEnd",a),n}},request:function(t){var e={},n=0,r=0,i=!1,a=t.getRect();return{isControl:!0,requestStart:function(o){var c;return i=o.useSnap,{datas:e,parentDirection:o.direction||[1,1],parentIsWidth:(c=o?.horizontal)!==null&&c!==void 0?c:!0,useSnap:i}},request:function(o){return"offsetWidth"in o?n=o.offsetWidth-a.offsetWidth:"deltaWidth"in o&&(n+=o.deltaWidth),"offsetHeight"in o?r=o.offsetHeight-a.offsetHeight:"deltaHeight"in o&&(r+=o.deltaHeight),{datas:e,parentDist:[n,r],parentKeepRatio:o.keepRatio,useSnap:i}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:i}}}},unset:function(t){t.state.gestos.resizable=null}};function nx(t,e,n,r,i){var a=t.props.groupable,o=t.state,c=o.is3d?4:3,u=e.origin,d=an(t.state.rootMatrix,He([u[0],u[1]],a?[0,0]:[o.left,o.top]),c),h=At([i.left,i.top],d);e.startAbsoluteOrigin=h,e.prevDeg=wn(h,[n,r])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=Ss(h,[n,r])}function hm(t,e,n){var r=n.defaultDeg,i=n.prevDeg,a=i%360,o=Math.floor(i/360);a<0&&(a+=360),a>t&&a>270&&t<90?++o:a<t&&a<90&&t>270&&--o;var c=e*(o*360+t-r);return n.prevDeg=r+c,c}function rx(t,e,n,r){return hm(wn(r.startAbsoluteOrigin,[t,e])/Math.PI*180,n,r)}function ix(t,e,n,r,i,a){var o=t.props.throttleRotate,c=o===void 0?0:o,u=n.prevSnapDeg,d=0,h=!1;if(a){var p=zQ(t,e,r,i+r);h=p.isSnap,d=i+p.dist}h||(d=rt(i+r,c));var m=d-i;return n.prevSnapDeg=m,[m-u,m,d]}function IP(t,e,n){var r=ne(e,4),i=r[0],a=r[1],o=r[2],c=r[3];if(t==="none")return[];if(Vn(t))return t.map(function(S){return IP(S,[i,a,o,c],n)[0]});var u=ne((t||"top").split("-"),2),d=u[0],h=u[1],p=[i,a];d==="left"?p=[o,i]:d==="right"?p=[a,c]:d==="bottom"&&(p=[c,o]);var m=[(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2],b=FP(p,n);if(h){var w=h==="top"||h==="left",E=d==="bottom"||d==="left";m=p[w&&!E||!w&&E?0:1]}return[[m,b]]}function j1(t,e){if(e.isRequest)return e.requestAble==="rotatable";var n=e.inputEvent.target;if(Un(n,Fe("rotation-control"))||t.props.rotateAroundControls&&Un(n,Fe("around-control"))||Un(n,Fe("control"))&&Un(n,Fe("rotatable")))return!0;var r=t.props.rotationTarget;return r?yE(r,!0).some(function(i){return i?n===i||n.contains(i):!1}):!1}var SQ=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,TQ={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[SQ],viewClassName:function(t){return t.isDragging("rotatable")?Fe("view-rotation-dragging"):""},render:function(t,e){var n=ic(t.props,"rotatable"),r=n.rotatable,i=n.rotationPosition,a=n.zoom,o=n.renderDirections,c=n.rotateAroundControls,u=n.resolveAblesWithRotatable,d=t.getState(),h=d.renderPoses,p=d.direction;if(!r)return null;var m=IP(i,h,p),b=[];if(m.forEach(function(T,C){var N=ne(T,2),j=N[0],P=N[1];b.push(e.createElement("div",{key:"rotation".concat(C),className:Fe("rotation"),style:{transform:"translate(-50%) translate(".concat(j[0],"px, ").concat(j[1],"px) rotate(").concat(P,"rad)")}},e.createElement("div",{className:Fe("line rotation-line"),style:{transform:"scaleX(".concat(a,")")}}),e.createElement("div",{className:Fe("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(a,")")}})))}),o){var w=Ps(u||{}),E={};w.forEach(function(T){u[T].forEach(function(C){E[C]=T})});var S=[];Vn(o)&&(S=o.map(function(T){var C=E[T];return{data:C?{resolve:C}:{},classNames:C?["move"]:[],dir:T}})),b.push.apply(b,Ce([],ne(gP(t,"rotatable",S,e)),!1))}return c&&b.push.apply(b,Ce([],ne(xP(t,e)),!1)),b},dragControlCondition:j1,dragControlStart:function(t,e){var n,r,i=e.datas,a=e.clientX,o=e.clientY,c=e.parentRotate,u=e.parentFlag,d=e.isPinch,h=e.isRequest,p=t.state,m=p.target,b=p.left,w=p.top,E=p.direction,S=p.beforeDirection,T=p.targetTransform,C=p.moveableClientRect,N=p.offsetMatrix,j=p.targetMatrix,P=p.allMatrix,M=p.width,A=p.height;if(!h&&!m)return!1;var k=t.getRect();i.rect=k,i.transform=T,i.left=b,i.top=w;var D=function(ie){var le=DP(t.state,ie);i.fixedDirection=le.fixedDirection,i.fixedOffset=le.fixedOffset,i.fixedPosition=le.fixedPosition,F&&F.setFixedPosition(ie)},V=function(ie){var le=EQ(t.state,ie);i.fixedDirection=le.fixedDirection,i.fixedOffset=le.fixedOffset,i.fixedPosition=le.fixedPosition,F&&F.setFixedDirection(ie)},L=a,U=o;if(h||d||u){var O=c||0;i.beforeInfo={origin:k.beforeOrigin,prevDeg:O,defaultDeg:O,prevSnapDeg:0,startDist:0},i.afterInfo=ee(ee({},i.beforeInfo),{origin:k.origin}),i.absoluteInfo=ee(ee({},i.beforeInfo),{origin:k.origin,startValue:O})}else{var J=(r=e.inputEvent)===null||r===void 0?void 0:r.target;if(J){var W=J.getAttribute("data-direction")||"",q=DK[W];if(q){i.isControl=!0,i.isAroundControl=Un(J,Fe("around-control")),i.controlDirection=q;var K=J.getAttribute("data-resolve");K&&(i.resolveAble=K);var te=eZ(p.rootMatrix,p.renderPoses,C);n=ne(Fn(te,q),2),L=n[0],U=n[1]}}i.beforeInfo={origin:k.beforeOrigin},i.afterInfo={origin:k.origin},i.absoluteInfo={origin:k.origin,startValue:k.rotation};var se=D;D=function(ie){var le=p.is3d?4:3,ge=ne(At(X4(j,le),ie),2),pe=ge[0],_e=ge[1],Ie=hr(N,tc([pe,_e],le)),ae=hr(P,tc([ie[0],ie[1]],le));se(ie);var Ae=p.posDelta;i.beforeInfo.origin=He(Ie,Ae),i.afterInfo.origin=He(ae,Ae),i.absoluteInfo.origin=He(ae,Ae),nx(t,i.beforeInfo,L,U,C),nx(t,i.afterInfo,L,U,C),nx(t,i.absoluteInfo,L,U,C)},V=function(ie){var le=Fn([[0,0],[M,0],[0,A],[M,A]],ie);D(le)}}i.startClientX=L,i.startClientY=U,i.direction=E,i.beforeDirection=S,i.startValue=0,i.datas={},nv(t,e,"rotate");var G=!1,F=!1;if(i.isControl&&i.resolveAble){var Y=i.resolveAble;Y==="resizable"&&(F=P1.dragControlStart(t,ee(ee({},new Vu("resizable").dragStart([0,0],e)),{parentPosition:i.controlPosition,parentFixedPosition:i.fixedPosition})))}F||(G=br.dragStart(t,new Vu().dragStart([0,0],e))),D(tZ(t));var Q=ct(t,e,ee(ee({set:function(ie){i.startValue=ie*Math.PI/180},setFixedDirection:V,setFixedPosition:D},tv(t,e)),{dragStart:G,resizeStart:F})),X=Pe(t,"onRotateStart",Q);return i.isRotate=X!==!1,p.snapRenderInfo={request:e.isRequest},i.isRotate?Q:!1},dragControl:function(t,e){var n,r,i,a=e.datas,o=e.clientDistX,c=e.clientDistY,u=e.parentRotate,d=e.parentFlag,h=e.isPinch,p=e.groupDelta,m=e.resolveMatrix,b=a.beforeDirection,w=a.beforeInfo,E=a.afterInfo,S=a.absoluteInfo,T=a.isRotate,C=a.startValue,N=a.rect,j=a.startClientX,P=a.startClientY;if(T){J0(t,e,"rotate");var M=IK(e),A=b*M,k=t.props.parentMoveable,D=0,V,L,U=0,O,J,W=0,q,K,te=180/Math.PI*C,se=S.startValue,G=!1,F=j+o,Y=P+c;if(!d&&"parentDist"in e){var Q=e.parentDist;V=Q,O=Q,q=Q}else h||d?(V=hm(u,b,w),O=hm(u,A,E),q=hm(u,A,S)):(V=rx(F,Y,b,w),O=rx(F,Y,A,E),q=rx(F,Y,A,S),G=!0);if(L=te+V,J=te+O,K=se+q,Pe(t,"onBeforeRotate",ct(t,e,{beforeRotation:L,rotation:J,absoluteRotation:K,setRotation:function(Re){O=Re-te,V=O,q=O}},!0)),n=ne(ix(t,N,w,V,te,G),3),D=n[0],V=n[1],L=n[2],r=ne(ix(t,N,E,O,te,G),3),U=r[0],O=r[1],J=r[2],i=ne(ix(t,N,S,q,se,G),3),W=i[0],q=i[1],K=i[2],!(!W&&!U&&!D&&!k&&!m)){var X=ev(a,"rotate(".concat(J,"deg)"),"rotate(".concat(O,"deg)"));m&&(a.fixedPosition=sE(t,a.targetAllTransform,a.fixedDirection,a.fixedOffset,a));var ie=$K(t,O,a),le=He(At(p||[0,0],ie),a.prevInverseDist||[0,0]);a.prevInverseDist=ie,a.requestValue=null;var ge=fP(t,X,le,h,e),pe=ge,_e=Ss([F,Y],S.startAbsoluteOrigin)-S.startDist,Ie=void 0;if(a.resolveAble==="resizable"){var ae=P1.dragControl(t,ee(ee({},Kh(e,t.state,[e.deltaX,e.deltaY],!!h,!1,"resizable")),{resolveMatrix:!0,parentDistance:_e}));ae&&(Ie=ae,pe=qP(pe,ae,e))}var Ae=ct(t,e,ee(ee({delta:U,dist:O,rotate:J,rotation:J,beforeDist:V,beforeDelta:D,beforeRotate:L,beforeRotation:L,absoluteDist:q,absoluteDelta:W,absoluteRotate:K,absoluteRotation:K,isPinch:!!h,resize:Ie},ge),pe));return Pe(t,"onRotate",Ae),Ae}}},dragControlEnd:function(t,e){var n=e.datas;if(n.isRotate){n.isRotate=!1;var r=ii(t,e,{});return Pe(t,"onRotateEnd",r),r}},dragGroupControlCondition:j1,dragGroupControlStart:function(t,e){var n=e.datas,r=t.state,i=r.left,a=r.top,o=r.beforeOrigin,c=this.dragControlStart(t,e);if(!c)return!1;c.set(n.beforeDirection*t.rotation);var u=Ts(t,this,"dragControlStart",e,function(p,m){var b=p.state,w=b.left,E=b.top,S=b.beforeOrigin,T=At(He([w,E],[i,a]),He(S,o));return m.datas.startGroupClient=T,m.datas.groupClient=T,ee(ee({},m),{parentRotate:0})}),d=ee(ee({},c),{targets:t.props.targets,events:u}),h=Pe(t,"onRotateGroupStart",d);return n.isRotate=h!==!1,n.isRotate?c:!1},dragGroupControl:function(t,e){var n=e.datas;if(n.isRotate){ov(t,"onBeforeRotate",function(d){Pe(t,"onBeforeRotateGroup",ct(t,e,ee(ee({},d),{targets:t.props.targets}),!0))});var r=this.dragControl(t,e);if(r){var i=n.beforeDirection,a=r.beforeDist,o=a/180*Math.PI,c=Ts(t,this,"dragControl",e,function(d,h){var p=h.datas.startGroupClient,m=ne(h.datas.groupClient,2),b=m[0],w=m[1],E=ne(qh(p,o*i),2),S=E[0],T=E[1],C=[S-b,T-w];return h.datas.groupClient=[S,T],ee(ee({},h),{parentRotate:a,groupDelta:C})});t.rotation=i*r.beforeRotation;var u=ee({targets:t.props.targets,events:c,set:function(d){t.rotation=d},setGroupRotation:function(d){t.rotation=d}},r);return Pe(t,"onRotateGroup",u),u}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isRotate){this.dragControlEnd(t,e);var i=Ts(t,this,"dragControlEnd",e),a=ii(t,e,{targets:t.props.targets,events:i});return Pe(t,"onRotateGroupEnd",a),n}},request:function(t){var e={},n=0,r=t.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(i){return"deltaRotate"in i?n+=i.deltaRotate:"rotate"in i&&(n=i.rotate-r),{datas:e,parentDist:n}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function AQ(t,e){var n,r=t.direction,i=t.classNames,a=t.size,o=t.pos,c=t.zoom,u=t.key,d=r==="horizontal",h=d?"Y":"X";return e.createElement("div",{key:u,className:i.join(" "),style:(n={},n[d?"width":"height"]="".concat(a),n.transform="translate(".concat(o[0],", ").concat(o[1],") translate").concat(h,"(-50%) scale").concat(h,"(").concat(c,")"),n)})}function fE(t,e){return AQ(ee(ee({},t),{classNames:Ce([Fe("line","guideline",t.direction)],ne(t.classNames),!1).filter(function(n){return n}),size:t.size||"".concat(t.sizeValue,"px"),pos:t.pos||t.posValue.map(function(n){return"".concat(rt(n,.1),"px")})}),e)}function WR(t,e,n,r,i,a,o,c){var u=t.props.zoom;return n.map(function(d,h){var p=d.type,m=d.pos,b=[0,0];return b[o]=r,b[o?0:1]=-i+m,fE({key:"".concat(e,"TargetGuideline").concat(h),classNames:[Fe("target","bold",p)],posValue:b,sizeValue:a,zoom:u,direction:e},c)})}function KR(t,e,n,r,i,a){var o=t.props,c=o.zoom,u=o.isDisplayInnerSnapDigit,d=e==="horizontal"?Qo:Zo,h=i[d.start],p=i[d.end];return n.filter(function(m){var b=m.hide,w=m.elementRect;if(b)return!1;if(u&&w){var E=w.rect;if(E[d.start]<=h&&p<=E[d.end])return!1}return!0}).map(function(m,b){var w=m.pos,E=m.size,S=m.element,T=m.className,C=[-r[0]+w[0],-r[1]+w[1]];return fE({key:"".concat(e,"-default-guideline-").concat(b),classNames:S?[Fe("bold"),T]:[Fe("normal"),T],direction:e,posValue:C,sizeValue:E,zoom:c},a)})}function Sf(t,e,n,r,i,a,o,c){var u,d=t.props,h=d.snapDigit,p=h===void 0?0:h,m=d.isDisplaySnapDigit,b=m===void 0?!0:m,w=d.snapDistFormat,E=w===void 0?function(P,M){return P}:w,S=d.zoom,T=e==="horizontal"?"X":"Y",C=e==="vertical"?"height":"width",N=Math.abs(i),j=b?parseFloat(N.toFixed(p)):0;return c.createElement("div",{key:"".concat(e,"-").concat(n,"-guideline-").concat(r),className:Fe("guideline-group",e),style:(u={left:"".concat(a[0],"px"),top:"".concat(a[1],"px")},u[C]="".concat(N,"px"),u)},fE({direction:e,classNames:[Fe(n),o],size:"100%",posValue:[0,0],sizeValue:N,zoom:S},c),c.createElement("div",{className:Fe("size-value","gap"),style:{transform:"translate".concat(T,"(-50%) scale(").concat(S,")")}},j>0?E(j,e):""))}function CQ(t,e,n,r){var i=t==="vertical"?0:1,a=t==="vertical"?1:0,o=i?Qo:Zo,c=n[o.start],u=n[o.end];return YP(e,function(d){return d.pos[i]}).map(function(d){var h=[],p=[],m=[];return d.forEach(function(b){var w,E,S=b.element,T=b.elementRect.rect;if(T[o.end]<c)h.push(b);else if(u<T[o.start])p.push(b);else if(T[o.start]<=c&&u<=T[o.end]&&r){var C=b.pos,N={element:S,rect:ee(ee({},T),(w={},w[o.end]=T[o.start],w))},j={element:S,rect:ee(ee({},T),(E={},E[o.start]=T[o.end],E))},P=[0,0],M=[0,0];P[i]=C[i],P[a]=C[a],M[i]=C[i],M[a]=C[a]+b.size,h.push({type:t,pos:P,size:0,elementRect:N,direction:"",elementDirection:"end"}),p.push({type:t,pos:M,size:0,elementRect:j,direction:"",elementDirection:"start"})}}),h.sort(function(b,w){return w.pos[a]-b.pos[a]}),p.sort(function(b,w){return b.pos[a]-w.pos[a]}),{total:d,start:h,end:p,inner:m}})}function kQ(t,e,n,r,i){var a=t.props.isDisplayInnerSnapDigit,o=[];return["vertical","horizontal"].forEach(function(c){var u=e.filter(function(S){return S.type===c}),d=c==="vertical"?1:0,h=d?0:1,p=CQ(c,u,r,a),m=d?Zo:Qo,b=d?Qo:Zo,w=r[m.start],E=r[m.end];p.forEach(function(S){var T=S.total,C=S.start,N=S.end,j=S.inner,P=n[h]+T[0].pos[h]-r[b.start],M=r;C.forEach(function(A){var k=A.elementRect.rect,D=M[m.start]-k[m.end];if(D>0){var V=[0,0];V[d]=n[d]+M[m.start]-w-D,V[h]=P,o.push(Sf(t,c,"dashed",o.length,D,V,A.className,i))}M=k}),M=r,N.forEach(function(A){var k=A.elementRect.rect,D=k[m.start]-M[m.end];if(D>0){var V=[0,0];V[d]=n[d]+M[m.end]-w,V[h]=P,o.push(Sf(t,c,"dashed",o.length,D,V,A.className,i))}M=k}),j.forEach(function(A){var k=A.elementRect.rect,D=w-k[m.start],V=k[m.end]-E,L=[0,0],U=[0,0];L[d]=n[d]-D,L[h]=P,U[d]=n[d]+E-w,U[h]=P,o.push(Sf(t,c,"dashed",o.length,D,L,A.className,i)),o.push(Sf(t,c,"dashed",o.length,V,U,A.className,i))})})}),o}function RQ(t,e,n,r,i){var a=[];return["horizontal","vertical"].forEach(function(o){var c=e.filter(function(S){return S.type===o}).slice(0,1),u=o==="vertical"?0:1,d=u?0:1,h=u?Zo:Qo,p=u?Qo:Zo,m=r[h.start],b=r[h.end],w=r[p.start],E=r[p.end];c.forEach(function(S){var T=S.gap,C=S.gapRects,N=Math.max.apply(Math,Ce([w],ne(C.map(function(M){var A=M.rect;return A[p.start]})),!1)),j=Math.min.apply(Math,Ce([E],ne(C.map(function(M){var A=M.rect;return A[p.end]})),!1)),P=(N+j)/2;N===j||P===(w+E)/2||C.forEach(function(M){var A=M.rect,k=M.className,D=[n[0],n[1]];if(A[h.end]<m)D[u]+=A[h.end]-m;else if(b<A[h.start])D[u]+=A[h.start]-m-T;else return;D[d]+=P-w,a.push(Sf(t,u?"vertical":"horizontal","gap",a.length,T,D,k,i))})})}),a}function V1(t){var e,n,r=t.state,i=r.containerClientRect,a=r.hasFixed,o=i.overflow,c=i.scrollHeight,u=i.scrollWidth,d=i.clientHeight,h=i.clientWidth,p=i.clientLeft,m=i.clientTop,b=t.props,w=b.snapGap,E=w===void 0?!0:w,S=b.verticalGuidelines,T=b.horizontalGuidelines,C=b.snapThreshold,N=C===void 0?5:C,j=b.maxSnapElementGuidelineDistance,P=j===void 0?1/0:j,M=b.isDisplayGridGuidelines,A=ki(Di(t.state)),k=A.top,D=A.left,V=A.bottom,L=A.right,U={top:k,left:D,bottom:V,right:L,center:(D+L)/2,middle:(k+V)/2},O=MQ(t),J=Ce([],ne(O),!1),W=((n=(e=r.snapThresholdInfo)===null||e===void 0?void 0:e.multiples)!==null&&n!==void 0?n:[1,1]).map(function(se){return se*N});E&&J.push.apply(J,Ce([],ne(NQ(t,U,W)),!1));var q=ee({},r.snapOffset||{left:0,top:0,bottom:0,right:0});if(J.push.apply(J,Ce([],ne(IQ(t,o?u:h,o?c:d,p,m,q,M)),!1)),a){var K=i.left,te=i.top;q.left+=K,q.top+=te,q.right+=K,q.bottom+=te}return J.push.apply(J,Ce([],ne(OP(T||!1,S||!1,o?u:h,o?c:d,p,m,q)),!1)),J=J.filter(function(se){var G=se.element,F=se.elementRect,Y=se.type;if(!G||!F)return!0;var Q=F.rect;return MP(U,Q,Y,P)}),J}function NQ(t,e,n){var r=t.props,i=r.maxSnapElementGuidelineDistance,a=i===void 0?1/0:i,o=r.maxSnapElementGapDistance,c=o===void 0?1/0:o,u=t.state.elementRects,d=[];return[["vertical",Qo,Zo],["horizontal",Zo,Qo]].forEach(function(h){var p=ne(h,3),m=p[0],b=p[1],w=p[2],E=e[b.start],S=e[b.end],T=e[b.center],C=e[w.start],N=e[w.end],j={left:n[0],top:n[1]};function P(k){var D=k.rect,V=j[b.start];return D[b.end]<E+V?E-D[b.end]:S-V<D[b.start]?D[b.start]-S:-1}var M=u.filter(function(k){var D=k.rect;return D[w.start]>N||D[w.end]<C?!1:P(k)>0}).sort(function(k,D){return P(k)-P(D)}),A=[];M.forEach(function(k){M.forEach(function(D){if(k!==D){var V=k.rect,L=D.rect,U=V[w.start],O=V[w.end],J=L[w.start],W=L[w.end];U>W||J>O||A.push([k,D])}})}),A.forEach(function(k){var D=ne(k,2),V=D[0],L=D[1],U=V.rect,O=L.rect,J=U[b.start],W=U[b.end],q=O[b.start],K=O[b.end],te=j[b.start],se=0,G=0,F=!1,Y=!1,Q=!1;if(W<=E&&S<=q){if(Y=!0,se=(q-W-(S-E))/2,G=W+se+(S-E)/2,Ee(G-T)>te)return}else if(W<q&&K<E+te){if(F=!0,se=q-W,G=K+se,Ee(G-E)>te)return}else if(W<q&&S-te<J){if(Q=!0,se=q-W,G=J-se,Ee(G-S)>te)return}else return;se&&MP(e,O,m,a)&&(se>c||d.push({type:m,pos:m==="vertical"?[G,0]:[0,G],element:L.element,size:0,className:L.className,isStart:F,isCenter:Y,isEnd:Q,gap:se,hide:!0,gapRects:[V,L],direction:"",elementDirection:""}))})}),d}function DQ(t,e,n,r){var i,a,o=t.props,c=t.state,u=o.snapGridAll,d=o.snapGridWidth,h=d===void 0?0:d,p=o.snapGridHeight,m=p===void 0?0:p,b=c.snapRenderInfo,w=b&&(((i=b.direction)===null||i===void 0?void 0:i[0])||((a=b.direction)===null||a===void 0?void 0:a[1])),E=t.moveables;if(u&&E&&w&&(h||m)){if(c.snapThresholdInfo)return;c.snapThresholdInfo={multiples:[1,1],offset:[0,0]};var S=t.getRect(),T=S.children,C=b.direction;if(T){var N=C.map(function(P,M){var A=M===0?{snapSize:h,posName:"left",sizeName:"width",clientOffset:r.left-e}:{snapSize:m,posName:"top",sizeName:"height",clientOffset:r.top-n},k=A.snapSize,D=A.posName,V=A.sizeName,L=A.clientOffset;if(!k)return{dir:P,multiple:1,snapSize:k,snapOffset:0};var U=S[V],O=S[D],J=E4(T.map(function(F){return[F[D]-O,F[V],U-F[V]-F[D]+O]})).filter(function(F){return F}).sort(function(F,Y){return F-Y}),W=J[0],q=J.map(function(F){return rt(F/W,.1)*k}),K=1,te=rt(U/W,.1);for(K=1;K<=10&&!q.every(function(F){return F*K%1===0});++K);var se=(-P+1)/2,G=Xm(O-L,O-L+U,se,1-se);return{multiple:te*K,dir:P,snapSize:k,snapOffset:Math.round(G/k)}}),j=N.map(function(P){return P.multiple||1});c.snapThresholdInfo.multiples=j,c.snapThresholdInfo.offset=N.map(function(P){return P.snapOffset}),N.forEach(function(P,M){P.snapSize})}}else c.snapThresholdInfo=null}function IQ(t,e,n,r,i,a,o){r===void 0&&(r=0),i===void 0&&(i=0);var c=t.props,u=t.state,d=c.snapGridWidth,h=d===void 0?0:d,p=c.snapGridHeight,m=p===void 0?0:p,b=[],w=a.left,E=a.top,S=[0,0];DQ(t,r,i,a);var T=u.snapThresholdInfo,C=h,N=m;if(T&&(h*=T.multiples[0]||1,m*=T.multiples[1]||1,S=T.offset),m){for(var j=function(M){b.push({type:"horizontal",pos:[w,rt(S[1]*N+M-i+E,.1)],className:Fe("grid-guideline"),size:e,hide:!o,direction:"",grid:!0})},P=0;P<=n*2;P+=m)j(P);for(var P=-m;P>=-n;P-=m)j(P)}if(h){for(var j=function(A){b.push({type:"vertical",pos:[rt(S[0]*C+A-r+w,.1),E],className:Fe("grid-guideline"),size:n,hide:!o,direction:"",grid:!0})},P=0;P<=e*2;P+=h)j(P);for(var P=-h;P>=-e;P-=h)j(P)}return b}function MP(t,e,n,r){return n==="horizontal"?Ee(t.right-e.left)<=r||Ee(t.left-e.right)<=r||t.left<=e.right&&e.left<=t.right:n==="vertical"?Ee(t.bottom-e.top)<=r||Ee(t.top-e.bottom)<=r||t.top<=e.bottom&&e.top<=t.bottom:!0}function MQ(t){var e=t.state,n=t.props.elementGuidelines,r=n===void 0?[]:n;if(!r.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter(function(m){return!m.refresh}),a=r.map(function(m){return na(m)&&"element"in m?ee(ee({},m),{element:za(m.element,!0)}):{element:za(m,!0)}}).filter(function(m){return m.element}),o=HW(i.map(function(m){return m.element}),a.map(function(m){return m.element})),c=o.maintained,u=o.added,d=[];c.forEach(function(m){var b=ne(m,2),w=b[0],E=b[1];d[E]=i[w]}),OQ(t,u.map(function(m){return a[m]})).map(function(m,b){d[u[b]]=m}),e.elementRects=d;var h=lE(t.props.elementSnapDirections),p=[];return d.forEach(function(m){var b=m.element,w=m.top,E=w===void 0?h.top:w,S=m.left,T=S===void 0?h.left:S,C=m.right,N=C===void 0?h.right:C,j=m.bottom,P=j===void 0?h.bottom:j,M=m.center,A=M===void 0?h.center:M,k=m.middle,D=k===void 0?h.middle:k,V=m.className,L=m.rect,U=cE({top:E,right:N,left:T,bottom:P,center:A,middle:D},L),O=U.horizontal,J=U.vertical,W=U.horizontalNames,q=U.verticalNames,K=L.top,te=L.left,se=L.right-te,G=L.bottom-K,F=[se,G];J.forEach(function(Y,Q){p.push({type:"vertical",element:b,pos:[rt(Y,.1),K],size:G,sizes:F,className:V,elementRect:m,elementDirection:UR[q[Q]]||q[Q],direction:""})}),O.forEach(function(Y,Q){p.push({type:"horizontal",element:b,pos:[te,rt(Y,.1)],size:se,sizes:F,className:V,elementRect:m,elementDirection:UR[W[Q]]||W[Q],direction:""})})}),p}function QR(t,e){return t?t.map(function(n){var r=na(n)?n:{pos:n},i=r.pos;return Pu(i)?r:ee(ee({},r),{pos:$t(i,e)})}):[]}function OP(t,e,n,r,i,a,o){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o={left:0,top:0,right:0,bottom:0});var c=[],u=o.left,d=o.top,h=o.bottom,p=o.right,m=n+p-u,b=r+h-d;return QR(t,b).forEach(function(w){c.push({type:"horizontal",pos:[u,rt(w.pos-a+d,.1)],size:m,className:w.className,direction:""})}),QR(e,m).forEach(function(w){c.push({type:"vertical",pos:[rt(w.pos-i+u,.1),d],size:b,className:w.className,direction:""})}),c}function OQ(t,e){if(!e.length)return[];var n=t.props.groupable,r=t.state,i=r.containerClientRect,a=r.rootMatrix,o=r.is3d,c=r.offsetDelta,u=o?4:3,d=ne(iQ(a,i,u),2),h=d[0],p=d[1],m=n?0:c[0],b=n?0:c[1];return e.map(function(w){var E=w.element.getBoundingClientRect(),S=E.left-h-m,T=E.top-p-b,C=T+E.height,N=S+E.width,j=ne(Bu(a,[S,T],u),2),P=j[0],M=j[1],A=ne(Bu(a,[N,C],u),2),k=A[0],D=A[1];return ee(ee({},w),{rect:{left:P,right:k,top:M,bottom:D,center:(P+k)/2,middle:(M+D)/2}})})}function Gg(t){var e=t.state,n=e.container,r=t.props.snapContainer||n;if(e.snapContainer===r&&e.guidelines&&e.guidelines.length)return!1;var i=e.containerClientRect,a={left:0,top:0,bottom:0,right:0};if(n!==r){var o=za(r,!0);if(o){var c=Ff(o),u=rN(e,[c.left-i.left,c.top-i.top]),d=rN(e,[c.right-i.right,c.bottom-i.bottom]);a.left=rt(u[0],1e-5),a.top=rt(u[1],1e-5),a.right=rt(d[0],1e-5),a.bottom=rt(d[1],1e-5)}}return e.snapContainer=r,e.snapOffset=a,e.guidelines=V1(t),e.enableSnap=!0,!0}function PP(t,e,n,r,i,a){var o=dc(t,e,n,a?4:3),c=Fn(o,r);return pE(o,He(i,c))}function ZR(t){return t?t/Ee(t):0}function PQ(t,e,n,r,i,a){var o=a.fixedDirection,c=lQ(n,o,r),u=dE(t,e,n,r),d=Ce(Ce([],ne(xQ(t,e,c,r,i,a)),!1),ne(RP(t,u,a)),!1),h=e0(d,0),p=e0(d,1);return{width:{isBound:h.isBound,offset:h.offset[0]},height:{isBound:p.isBound,offset:p.offset[1]}}}function jQ(t,e,n,r,i,a,o,c,u){var d=Fn(e,o),h=av(t,c,{vertical:[d[0]],horizontal:[d[1]]}),p=h.horizontal.offset,m=h.vertical.offset;if(rt(m,N1)||rt(p,N1)){var b=ne(Ya({datas:u,distX:-m,distY:-p}),2),w=b[0],E=b[1],S=Math.min(i||1/0,n+o[0]*w),T=Math.min(a||1/0,r+o[1]*E);return[S-n,T-r]}return[0,0]}function jP(t,e,n,r,i,a,o,c){for(var u=Di(t.state),d=t.props.keepRatio,h=0,p=0,m=0;m<2;++m){var b=e(h,p),w=PQ(t,b,i,d,o,c),E=w.width,S=w.height,T=E.isBound,C=S.isBound,N=E.offset,j=S.offset;if(m===1&&(T||(N=0),C||(j=0)),m===0&&o&&!T&&!C)return[0,0];if(d){var P=Ee(N)*(n?1/n:1),M=Ee(j)*(r?1/r:1),A=T&&C?P<M:C||!T&&P<M;A?N=n*j/r:j=r*N/n}h+=N,p+=j}if(!d&&i[0]&&i[1]){var k=_Q(t,u,i,a,c),D=k.maxWidth,V=k.maxHeight,L=ne(jQ(t,e(h,p).map(function(J){return J.map(function(W){return rt(W,N1)})}),n+h,r+p,D,V,i,o,c),2),N=L[0],j=L[1];h+=N,p+=j}return[h,p]}function Bf(t){return t<0&&(t=t%360+360),t%=360,t}function VQ(t,e){e=Bf(e);var n=Math.floor(t/360),r=n*360+360-e,i=n*360+e;return Ee(t-r)<Ee(t-i)?r:i}function ax(t,e){t=Bf(t),e=Bf(e);var n=Bf(t-e);return Math.min(n,360-n)}function zQ(t,e,n,r){var i,a=t.props,o=(i=a[wP])!==null&&i!==void 0?i:5,c=a[_P];if(cd(t,"rotatable")){var u=e.pos1,d=e.pos2,h=e.pos3,p=e.pos4,m=e.origin,b=n*Math.PI/180,w=[u,d,h,p].map(function(j){return He(j,m)}),E=w.map(function(j){return qh(j,b)}),S=Ce(Ce([],ne(eQ(t,w,E,m,n)),!1),ne(pQ(t,w,E,m,n)),!1);S.sort(function(j,P){return Ee(j-n)-Ee(P-n)});var T=S.length>0;if(T)return{isSnap:T,dist:T?S[0]:n}}if(c?.length&&o){var C=c.slice().sort(function(j,P){return ax(j,r)-ax(P,r)}),N=C[0];if(ax(N,r)<=o)return{isSnap:!0,dist:n+VQ(r,N)-r}}return{isSnap:!1,dist:n}}function LQ(t,e,n,r,i,a,o){if(!cd(t,"resizable"))return[0,0];var c=o.fixedDirection,u=o.nextAllMatrix,d=t.state,h=d.allMatrix,p=d.is3d;return jP(t,function(m,b){return PP(u||h,e+m,n+b,c,i,p)},e,n,r,i,a,o)}function BQ(t,e,n,r,i){if(!cd(t,"scalable"))return[0,0];var a=i.startOffsetWidth,o=i.startOffsetHeight,c=i.fixedPosition,u=i.fixedDirection,d=i.is3d,h=jP(t,function(p,m){return PP(LK(i,At(e,[p/a,m/o])),a,o,u,c,d)},a,o,n,c,r,i);return[h[0]/a,h[1]/o]}function UQ(t,e){e.absolutePoses=Di(t.state)}function JR(t){var e=[];return t.forEach(function(n){n.guidelineInfos.forEach(function(r){var i=r.guideline;Br(e,function(a){return a.guideline===i})||(i.direction="",e.push({guideline:i,posInfo:n}))})}),e.map(function(n){var r=n.guideline,i=n.posInfo;return ee(ee({},r),{direction:i.direction})})}function eN(t,e,n,r,i,a){var o=oE(rv(t,a),e,n),c=o.vertical,u=o.horizontal,d=pu();c.forEach(function(w){w.isBound&&(w.direction==="start"&&(d.left=!0),w.direction==="end"&&(d.right=!0),r.push({type:"bounds",pos:w.pos}))}),u.forEach(function(w){w.isBound&&(w.direction==="start"&&(d.top=!0),w.direction==="end"&&(d.bottom=!0),i.push({type:"bounds",pos:w.pos}))});var h=gQ(t),p=h.boundMap,m=h.vertical,b=h.horizontal;return m.forEach(function(w){Os(r,function(E){var S=E.type,T=E.pos;return S==="bounds"&&T===w})>=0||r.push({type:"bounds",pos:w})}),b.forEach(function(w){Os(i,function(E){var S=E.type,T=E.pos;return S==="bounds"&&T===w})>=0||i.push({type:"bounds",pos:w})}),{boundMap:d,innerBoundMap:p}}var FQ=vE("",["resizable","scalable"]),$Q={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold","snapGridAll",wP,_P,EP,SP,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(t,e){var n=t.state,r=n.top,i=n.left,a=n.pos1,o=n.pos2,c=n.pos3,u=n.pos4,d=n.snapRenderInfo,h=t.props.snapRenderThreshold,p=h===void 0?1:h;if(!d||!d.render||!cd(t,""))return mu(t,"boundMap",pu(),function(X){return JSON.stringify(X)}),mu(t,"innerBoundMap",pu(),function(X){return JSON.stringify(X)}),[];n.guidelines=V1(t);var m=Math.min(a[0],o[0],c[0],u[0]),b=Math.min(a[1],o[1],c[1],u[1]),w=d.externalPoses||[],E=Di(t.state),S=[],T=[],C=[],N=[],j=[],P=ki(E),M=P.width,A=P.height,k=P.top,D=P.left,V=P.bottom,L=P.right,U={left:D,right:L,top:k,bottom:V,center:(D+L)/2,middle:(k+V)/2},O=w.length>0,J=O?ki(w):{};if(!d.request){if(d.direction&&j.push(oQ(t,E,d.direction,p,p)),d.snap){var W=ki(E);d.center&&(W.middle=(W.top+W.bottom)/2,W.center=(W.left+W.right)/2),j.push(FR(t,W,p,p))}O&&(d.center&&(J.middle=(J.top+J.bottom)/2,J.center=(J.left+J.right)/2),j.push(FR(t,J,p,p))),j.forEach(function(X){var ie=X.vertical.posInfos,le=X.horizontal.posInfos;S.push.apply(S,Ce([],ne(ie.filter(function(ge){var pe=ge.guidelineInfos;return pe.some(function(_e){var Ie=_e.guideline;return!Ie.hide})}).map(function(ge){return{type:"snap",pos:ge.pos}})),!1)),T.push.apply(T,Ce([],ne(le.filter(function(ge){var pe=ge.guidelineInfos;return pe.some(function(_e){var Ie=_e.guideline;return!Ie.hide})}).map(function(ge){return{type:"snap",pos:ge.pos}})),!1)),C.push.apply(C,Ce([],ne(JR(ie)),!1)),N.push.apply(N,Ce([],ne(JR(le)),!1))})}var q=eN(t,[D,L],[k,V],S,T),K=q.boundMap,te=q.innerBoundMap;O&&eN(t,[J.left,J.right],[J.top,J.bottom],S,T,d.externalBounds);var se=Ce(Ce([],ne(C),!1),ne(N),!1),G=se.filter(function(X){return X.element&&!X.gapRects}),F=se.filter(function(X){return X.gapRects}).sort(function(X,ie){return X.gap-ie.gap});Pe(t,"onSnap",{guidelines:se.filter(function(X){var ie=X.element;return!ie}),elements:G,gaps:F},!0);var Y=mu(t,"boundMap",K,function(X){return JSON.stringify(X)},pu()),Q=mu(t,"innerBoundMap",te,function(X){return JSON.stringify(X)},pu());return(K===Y||te===Q)&&Pe(t,"onBound",{bounds:K,innerBounds:te},!0),Ce(Ce(Ce(Ce(Ce(Ce([],ne(kQ(t,G,[m,b],U,e)),!1),ne(RQ(t,F,[m,b],U,e)),!1),ne(KR(t,"horizontal",N,[i,r],U,e)),!1),ne(KR(t,"vertical",C,[i,r],U,e)),!1),ne(WR(t,"horizontal",T,m,r,M,0,e)),!1),ne(WR(t,"vertical",S,b,i,A,1,e)),!1)},dragStart:function(t,e){t.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},Gg(t)},drag:function(t){var e=t.state;Gg(t)||(e.guidelines=V1(t)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart:function(t){this.unset(t)},dragEnd:function(t){this.unset(t)},dragControlCondition:function(t,e){if(FQ(t,e)||j1(t,e))return!0;if(!e.isRequest&&e.inputEvent)return Un(e.inputEvent.target,Fe("snap-control"))},dragControlStart:function(t){t.state.snapRenderInfo=null,Gg(t)},dragControl:function(t){this.drag(t)},dragControlEnd:function(t){this.unset(t)},dragGroupStart:function(t,e){this.dragStart(t,e)},dragGroup:function(t){this.drag(t)},dragGroupEnd:function(t){this.unset(t)},dragGroupControlStart:function(t){t.state.snapRenderInfo=null,Gg(t)},dragGroupControl:function(t){this.drag(t)},dragGroupControlEnd:function(t){this.unset(t)},unset:function(t){var e=t.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function GQ(t,e){return[t[0]*e[0],t[1]*e[1]]}function Fe(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return LX.apply(void 0,Ce([rE],ne(t),!1))}function VP(t){t()}function HQ(t){return!t||t==="none"?[1,0,0,1,0,0]:na(t)?t:hh(t)}function Uf(t,e,n){return Km(e,nc(n,e),t,nc(n.map(function(r){return-r}),e))}function qQ(t,e,n){if(e==="%"){var r=hE(t.ownerSVGElement);return r[n?"width":"height"]/100}return 1}function YQ(t){var e=XQ(gE(t,":before"));return e.map(function(n,r){var i=Fh(n),a=i.value,o=i.unit;return a*qQ(t,o,r===0)})}function n0(t){return t?t.split(" "):["0","0"]}function XQ(t){return n0(t.transformOrigin)}function zP(t){var e=Ur(t),n=e("transform");if(n&&n!=="none")return n;if("transform"in t){var r=t.transform,i=r.baseVal;if(!i)return"";var a=i.length;if(!a)return"";for(var o=[],c=function(d){var h=i[d].matrix;o.push("matrix(".concat(["a","b","c","d","e","f"].map(function(p){return h[p]}).join(", "),")"))},u=0;u<a;++u)c(u);return o.join(" ")}return""}function gh(t,e,n,r,i){var a,o,c=q_(t)||al(t),u=!1,d,h;if(!t||n)d=t;else{var p=(a=t?.assignedSlot)===null||a===void 0?void 0:a.parentElement,m=t.parentElement;p?(u=!0,h=m,d=p):d=m}for(var b=!1,w=t===e||d===e,E="relative",S=1,T=parseFloat(i?.("zoom"))||1,C=i?.("position");d&&d!==c;){e===d&&(w=!0);var N=Ur(d),j=d.tagName.toLowerCase(),P=zP(d),M=N("willChange"),A=parseFloat(N("zoom"))||1;if(E=N("position"),r&&A!==1){S=A;break}if(!n&&r&&T!==1&&C&&C!=="absolute"||j==="svg"||j==="foreignobject"||E!=="static"||P&&P!=="none"||M==="transform")break;var k=(o=t?.assignedSlot)===null||o===void 0?void 0:o.parentNode,D=d.parentNode;k&&(u=!0,h=D);var V=D;if(V&&V.nodeType===11){d=V.host,b=!0,E=Ur(d)("position");break}d=V,E="relative"}return{offsetZoom:S,hasSlot:u,parentSlotElement:h,isCustomElement:b,isStatic:E==="static",isEnd:w||!d||d===c,offsetParent:d||c}}function WQ(t,e){var n,r=t.tagName.toLowerCase(),i=t.offsetLeft,a=t.offsetTop,o=Ur(t),c=W0(i),u=!c,d,h;return!u&&(r!=="svg"||t.ownerSVGElement)?(d=rP?YQ(t):n0(o("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice(),u=!0,r==="svg"?(i=0,a=0):(n=ne(ZQ(t,d,t===e&&e.tagName.toLowerCase()==="g"),4),i=n[0],a=n[1],d[0]=n[2],d[1]=n[3])):(d=n0(o("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice()),{tagName:r,isSVG:c,hasOffset:u,offset:[i||0,a||0],origin:d,targetOrigin:h}}function LP(t,e){var n=Ur(t),r=Ur(al(t)),i=r("position");if(!e&&(!i||i==="static"))return[0,0];var a=parseInt(r("marginLeft"),10),o=parseInt(r("marginTop"),10);return n("position")==="absolute"&&((n("top")!=="auto"||n("bottom")!=="auto")&&(o=0),(n("left")!=="auto"||n("right")!=="auto")&&(a=0)),[a,o]}function z1(t){t.forEach(function(e){var n=e.matrix;n&&(e.matrix=ra(n,3,4))})}function KQ(t){for(var e=t.parentElement,n=!1,r=al(t);e;){var i=gE(e).transform;if(i&&i!=="none"){n=!0;break}if(e===r)break;e=e.parentElement}return{fixedContainer:e||r,hasTransform:n}}function sv(t,e){return e===void 0&&(e=t.length>9),"".concat(e?"matrix3d":"matrix","(").concat(W4(t,!e).join(","),")")}function hE(t){var e=t.clientWidth,n=t.clientHeight;if(!t)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:n};var r=t.viewBox,i=r&&r.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||n,clientWidth:e,clientHeight:n}}function QQ(t,e){var n,r=hE(t),i=r.width,a=r.height,o=r.clientWidth,c=r.clientHeight,u=o/i,d=c/a,h=t.preserveAspectRatio.baseVal,p=h.align,m=h.meetOrSlice,b=[0,0],w=[u,d],E=[0,0];if(p!==1){var S=(p-2)%3,T=Math.floor((p-2)/3);b[0]=i*S/2,b[1]=a*T/2;var C=m===2?Math.max(d,u):Math.min(u,d);w[0]=C,w[1]=C,E[0]=(o-i)/2*S,E[1]=(c-a)/2*T}var N=J_(w,e);return n=ne(E,2),N[e*(e-1)]=n[0],N[e*(e-1)+1]=n[1],Uf(N,e,b)}function ZQ(t,e,n){var r=t.tagName.toLowerCase();if(!t.getBBox||!n&&r==="g")return[0,0,0,0];var i=Ur(t),a=i("transform-box")==="fill-box",o=t.getBBox(),c=hE(t.ownerSVGElement),u=o.x,d=o.y;r==="foreignobject"&&!u&&!d&&(u=parseFloat(t.getAttribute("x"))||0,d=parseFloat(t.getAttribute("y"))||0);var h=u-c.x,p=d-c.y,m=a?e[0]:e[0]-h,b=a?e[1]:e[1]-p;return[h,p,m,b]}function an(t,e,n){return hr(t,tc(e,n),n)}function dc(t,e,n,r){return[[0,0],[e,0],[0,n],[e,n]].map(function(i){return an(t,i,r)})}function ki(t){var e=t.map(function(d){return d[0]}),n=t.map(function(d){return d[1]}),r=Math.min.apply(Math,Ce([],ne(e),!1)),i=Math.min.apply(Math,Ce([],ne(n),!1)),a=Math.max.apply(Math,Ce([],ne(e),!1)),o=Math.max.apply(Math,Ce([],ne(n),!1)),c=a-r,u=o-i;return{left:r,top:i,right:a,bottom:o,width:c,height:u}}function tN(t,e,n,r){var i=dc(t,e,n,r);return ki(i)}function JQ(t,e,n,r,i){var a,o=t.target,c=t.origin,u=e.matrix,d=UP(o),h=d.offsetWidth,p=d.offsetHeight,m=n.getBoundingClientRect(),b=[0,0];n===al(n)&&(b=LP(o,!0));for(var w=o.getBoundingClientRect(),E=w.left-m.left+n.scrollLeft-(n.clientLeft||0)+b[0],S=w.top-m.top+n.scrollTop-(n.clientTop||0)+b[1],T=w.width,C=w.height,N=Km(r,i,u),j=tN(N,h,p,r),P=j.left,M=j.top,A=j.width,k=j.height,D=an(N,c,r),V=He(D,[P,M]),L=[E+V[0]*T/A,S+V[1]*C/k],U=[0,0],O=0;++O<10;){var J=Fa(i,r);a=ne(He(an(J,L,r),an(J,D,r)),2),U[0]=a[0],U[1]=a[1];var W=Km(r,i,nc(U,r),u),q=tN(W,h,p,r),K=q.left,te=q.top,se=K-E,G=te-S;if(Ee(se)<2&&Ee(G)<2)break;L[0]-=se,L[1]-=G}return U.map(function(F){return Math.round(F)})}function eZ(t,e,n){var r=t.length===16,i=r?4:3,a=e.map(function(u){return an(t,u,i)}),o=n.left,c=n.top;return a.map(function(u){return[u[0]+o,u[1]+c]})}function Ni(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function BP(t,e){return Ni([e[0]-t[0],e[1]-t[1]])}function Tf(t,e,n,r){n===void 0&&(n=1),r===void 0&&(r=wn(t,e));var i=BP(t,e);return{transform:"translateY(-50%) translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(r,"rad) scaleY(").concat(n,")"),width:"".concat(i,"px")}}function r0(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n.length,a=n.reduce(function(c,u){return c+u[0]},0)/i,o=n.reduce(function(c,u){return c+u[1]},0)/i;return{transform:"translateZ(0px) translate(".concat(a,"px, ").concat(o,"px) rotate(").concat(t,"rad) scale(").concat(e,")")}}function ic(t,e){var n=t[e];return na(n)?ee(ee({},t),n):t}function UP(t){var e=t&&!W0(t.offsetWidth),n=0,r=0,i=0,a=0,o=0,c=0,u=0,d=0,h=0,p=0,m=0,b=0,w=1/0,E=1/0,S=1/0,T=1/0,C=0,N=0,j=!1;if(t)if(!e&&t.ownerSVGElement){var P=t.getBBox();j=!0,n=P.width,r=P.height,o=n,c=r,u=n,d=r,i=n,a=r}else{var M=Ur(t),A=t.style,k=M("boxSizing")==="border-box",D=parseFloat(M("borderLeftWidth"))||0,V=parseFloat(M("borderRightWidth"))||0,L=parseFloat(M("borderTopWidth"))||0,U=parseFloat(M("borderBottomWidth"))||0,O=parseFloat(M("paddingLeft"))||0,J=parseFloat(M("paddingRight"))||0,W=parseFloat(M("paddingTop"))||0,q=parseFloat(M("paddingBottom"))||0,K=O+J,te=W+q,se=D+V,G=L+U,F=K+se,Y=te+G,Q=M("position"),X=0,ie=0;if("clientLeft"in t){var le=null;if(Q==="absolute"){var ge=gh(t,al(t));le=ge.offsetParent}else le=t.parentElement;if(le){var pe=Ur(le);X=parseFloat(pe("width")),ie=parseFloat(pe("height"))}}h=Math.max(K,$t(M("minWidth"),X)||0),p=Math.max(te,$t(M("minHeight"),ie)||0),w=$t(M("maxWidth"),X),E=$t(M("maxHeight"),ie),isNaN(w)&&(w=1/0),isNaN(E)&&(E=1/0),C=$t(A.width,0)||0,N=$t(A.height,0)||0,o=parseFloat(M("width"))||0,c=parseFloat(M("height"))||0,u=Ee(o-C)<1?v1(h,C||o,w):o,d=Ee(c-N)<1?v1(p,N||c,E):c,n=u,r=d,i=u,a=d,k?(S=w,T=E,m=h,b=p,u=n-F,d=r-Y):(S=w+F,T=E+Y,m=h+F,b=p+Y,n=u+F,r=d+Y),i=u+K,a=d+te}return{svg:j,offsetWidth:n,offsetHeight:r,clientWidth:i,clientHeight:a,contentWidth:u,contentHeight:d,inlineCSSWidth:C,inlineCSSHeight:N,cssWidth:o,cssHeight:c,minWidth:h,minHeight:p,maxWidth:w,maxHeight:E,minOffsetWidth:m,minOffsetHeight:b,maxOffsetWidth:S,maxOffsetHeight:T}}function FP(t,e){return wn(e>0?t[0]:t[1],e>0?t[1]:t[0])}function Hg(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function $P(t,e){var n=t===al(t)||t===q_(t),r={clientLeft:t.clientLeft,clientTop:t.clientTop,clientWidth:t.clientWidth,clientHeight:t.clientHeight,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight,overflow:!1};return n&&(r.clientHeight=Math.max(e.height,r.clientHeight),r.scrollHeight=Math.max(e.height,r.scrollHeight)),r.overflow=Ur(t)("overflow")!=="visible",ee(ee({},e),r)}function sx(t,e,n,r){var i=t.left,a=t.right,o=t.top,c=t.bottom,u=e.top,d=e.left,h={left:d+i,top:u+o,right:d+a,bottom:u+c,width:a-i,height:c-o};return n&&r?$P(n,h):h}function Ff(t,e){var n=0,r=0,i=0,a=0;if(t){var o=t.getBoundingClientRect();n=o.left,r=o.top,i=o.width,a=o.height}var c={left:n,top:r,width:i,height:a,right:n+i,bottom:r+a};return t&&e?$P(t,c):c}function tZ(t){var e=t.props,n=e.groupable,r=e.svgOrigin,i=t.getState(),a=i.offsetWidth,o=i.offsetHeight,c=i.svg,u=i.transformOrigin;return!n&&c&&r?bE(r,a,o):u}function GP(t,e,n,r){var i;if(t)i=t;else if(e)i=[0,0];else{var a=n.target;i=HP(a,r)}return i}function HP(t,e){if(t){var n=t.getAttribute("data-rotation")||"",r=t.getAttribute("data-direction");if(e.deg=n,!!r){var i=[0,0];return r.indexOf("w")>-1&&(i[0]=-1),r.indexOf("e")>-1&&(i[0]=1),r.indexOf("n")>-1&&(i[1]=-1),r.indexOf("s")>-1&&(i[1]=1),i}}}function pE(t,e){return[At(e,t[0]),At(e,t[1]),At(e,t[2]),At(e,t[3])]}function Di(t){var e=t.left,n=t.top,r=t.pos1,i=t.pos2,a=t.pos3,o=t.pos4;return pE([r,i,a,o],[e,n])}function L1(t,e){t[e?"controlAbles":"targetAbles"].forEach(function(n){n.unset&&n.unset(t)})}function gu(t,e){var n=e?"controlGesto":"targetGesto",r=t[n];r?.isIdle()===!1&&L1(t,e),r?.unset(),t[n]=null}function _r(t,e){if(e){var n=ld(e);n.nextStyle=ee(ee({},n.nextStyle),t)}return{style:t,cssText:Ps(t).map(function(r){return"".concat(fm(r,"-"),": ").concat(t[r],";")}).join("")}}function qP(t,e,n){var r=e.afterTransform||e.transform;return ee(ee({},_r(ee(ee(ee({},t.style),e.style),{transform:r}),n)),{afterTransform:r,transform:t.transform})}function ct(t,e,n,r){var i=e.datas;i.datas||(i.datas={});var a=ee(ee({},n),{target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,moveable:t,datas:i.datas,isRequest:e.isRequest,isRequestChild:e.isRequestChild,isFirstDrag:!!e.isFirstDrag,isTrusted:e.isTrusted!==!1,stopAble:function(){i.isEventStart=!1},stopDrag:function(){var o;(o=e.stop)===null||o===void 0||o.call(e)}});return i.isStartEvent?r||(i.lastEvent=a):i.isStartEvent=!0,a}function ii(t,e,n){var r=e.datas,i="isDrag"in n?n.isDrag:e.isDrag;return r.datas||(r.datas={}),ee(ee({isDrag:i},n),{moveable:t,target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,lastEvent:r.lastEvent,isDouble:e.isDouble,datas:r.datas,isFirstDrag:!!e.isFirstDrag})}function ov(t,e,n){t._emitter.on(e,n)}function Pe(t,e,n,r,i){return t.triggerEvent(e,n,r,i)}function gE(t,e){return zo(t).getComputedStyle(t,e)}function qg(t,e,n){var r={},i={};return t.filter(function(a){var o=a.name;if(r[o]||!e.some(function(c){return a[c]}))return!1;if(!n&&a.ableGroup){if(i[a.ableGroup])return!1;i[a.ableGroup]=!0}return r[o]=!0,!0})}function B1(t,e){return t===e||t==null&&e==null}function nN(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=t.length-1,r=0;r<n;++r){var i=t[r];if(!W0(i))return i}return t[n]}function YP(t,e){var n=[],r=[];return t.forEach(function(i,a){var o=e(i,a,t),c=r.indexOf(o),u=n[c]||[];c===-1&&(r.push(o),n.push(u)),u.push(i)}),n}function nZ(t,e){var n=[],r={};return t.forEach(function(i,a){var o=e(i,a,t),c=r[o];c||(c=[],r[o]=c,n.push(c)),c.push(i)}),n}function XP(t){return t.reduce(function(e,n){return e.concat(n)},[])}function Lu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.sort(function(n,r){return Ee(r)-Ee(n)}),t[0]}function Bu(t,e,n){return hr(Fa(t,n),tc(e,n),n)}function rZ(t,e){var n,r=t.is3d,i=t.rootMatrix,a=r?4:3;return n=ne(Bu(i,[e.distX,e.distY],a),2),e.distX=n[0],e.distY=n[1],e}function xi(t,e,n,r){if(!n[0]&&!n[1])return e;var i=an(t,[ZR(n[0]||1),0],r),a=an(t,[0,ZR(n[1]||1)],r),o=an(t,[n[0]/Ni(i),n[1]/Ni(a)],r);return At(e,o)}function Hi(t,e,n){return n?"".concat(t/e*100,"%"):"".concat(t,"px")}function i0(t){return Ee(t)<=Tr?0:t}function mE(t){return function(e){if(!e.isDragging(t))return"";var n=qK(e,t),r=n.deg;return r?Fe("view-control-rotation".concat(r)):""}}function vE(t,e){return e===void 0&&(e=[t]),function(n,r){if(r.isRequest)return e.some(function(a){return r.requestAble===a})?r.parentDirection:!1;var i=r.inputEvent.target;return Un(i,Fe("direction"))&&(!t||Un(i,Fe(t)))}}function iZ(t,e,n){var r,i=ju(t,{"x%":function(P){return P/100*e.offsetWidth},"y%":function(P){return P/100*e.offsetHeight}}),a=t.slice(0,n<0?void 0:n),o=t.slice(0,n<0?void 0:n+1),c=t[n]||"",u=n<0?[]:t.slice(n),d=n<0?[]:t.slice(n+1),h=i.slice(0,n<0?void 0:n),p=i.slice(0,n<0?void 0:n+1),m=(r=i[n])!==null&&r!==void 0?r:ju([""])[0],b=n<0?[]:i.slice(n),w=n<0?[]:i.slice(n+1),E=m?[m]:[],S=iu(h),T=iu(p),C=iu(b),N=iu(w),j=Gt(S,C,4);return{transforms:t,beforeFunctionMatrix:S,beforeFunctionMatrix2:T,targetFunctionMatrix:iu(E),afterFunctionMatrix:C,afterFunctionMatrix2:N,allFunctionMatrix:j,beforeFunctions:h,beforeFunctions2:p,targetFunction:E[0],afterFunctions:b,afterFunctions2:w,beforeFunctionTexts:a,beforeFunctionTexts2:o,targetFunctionText:c,afterFunctionTexts:u,afterFunctionTexts2:d}}function aZ(t){return!t||!na(t)||sd(t)?!1:Vn(t)||"length"in t}function za(t,e){return t?sd(t)?t:Lr(t)?e?document.querySelector(t):t:$_(t)?t():C4(t)?t:"current"in t?t.current:t:null}function yE(t,e){if(!t)return[];var n=aZ(t)?[].slice.call(t):[t];return n.reduce(function(r,i){return Lr(i)&&e?Ce(Ce([],ne(r),!1),ne([].slice.call(document.querySelectorAll(i))),!1):(Vn(i)?r.push(yE(i,e)):r.push(za(i,e)),r)},[])}function sZ(t,e,n){var r=wn(t,e)/Math.PI*180;return r=n>=0?r:180-r,r=r>=0?r:360+r,r}function rN(t,e){var n=t.rootMatrix,r=t.is3d,i=r?4:3,a=Fa(n,i);return r||(a=ra(a,3,4)),a[12]=0,a[13]=0,a[14]=0,$W(a,e)}function WP(t,e,n,r,i){var a=ne(t,2),o=a[0],c=a[1],u=0,d=0;if(i&&o&&c){var h=wn([0,0],e),p=wn([0,0],r),m=Ni(e),b=Math.cos(h-p)*m;if(!r[0])d=b,u=d*n;else if(!r[1])u=b,d=u/n;else{var w=r[0]*o,E=r[1]*c,S=Math.atan2(w+e[0],E+e[1]),T=Math.atan2(w,E);S<0&&(S+=Math.PI*2),T<0&&(T+=Math.PI*2);var C=0;Ee(S-T)<Math.PI/2||Ee(S-T)>Math.PI/2*3||(T+=Math.PI),C=S-T,C>Math.PI*2?C-=Math.PI*2:C>Math.PI?C=2*Math.PI-C:C<-Math.PI&&(C=-2*Math.PI-C);var N=Ni([w+e[0],E+e[1]])*Math.cos(C);u=N*Math.sin(T)-w,d=N*Math.cos(T)-E,r[0]<0&&(u*=-1),r[1]<0&&(d*=-1)}}else u=r[0]*e[0],d=r[1]*e[1];return[u,d]}function KP(t,e,n,r){var i,a=n.ratio,o=n.startOffsetWidth,c=n.startOffsetHeight,u=0,d=0,h=r.distX,p=r.distY,m=r.pinchScale,b=r.parentDistance,w=r.parentDist,E=r.parentScale,S=n.fixedDirection,T=[0,1].map(function(A){return Ee(t[A]-S[A])}),C=[0,1].map(function(A){var k=T[A];return k!==0&&(k=2/k),k});if(w)u=w[0],d=w[1],e&&(u?d||(d=u/a):u=d*a);else if(Pu(m))u=(m-1)*o,d=(m-1)*c;else if(E)u=(E[0]-1)*o,d=(E[1]-1)*c;else if(b){var N=o*T[0],j=c*T[1],P=Ni([N,j]);u=b/P*N*C[0],d=b/P*j*C[1]}else{var M=Ya({datas:n,distX:h,distY:p});M=C.map(function(A,k){return M[k]*A}),i=ne(WP([o,c],M,a,t,e),2),u=i[0],d=i[1]}return{distWidth:u,distHeight:d}}function U1(t,e){if(e){if(t==="left")return{x:"0%",y:"50%"};if(t==="top")return{x:"50%",y:"50%"};if(t==="center")return{x:"50%",y:"50%"};if(t==="right")return{x:"100%",y:"50%"};if(t==="bottom")return{x:"50%",y:"100%"};var n=ne(t.split(" "),2),r=n[0],i=n[1],a=U1(r||""),o=U1(i||""),c=ee(ee({},a),o),u={x:"50%",y:"50%"};return c.x&&(u.x=c.x),c.y&&(u.y=c.y),c.value&&(c.x&&!c.y&&(u.y=c.value),!c.x&&c.y&&(u.x=c.value)),u}return t==="left"?{x:"0%"}:t==="right"?{x:"100%"}:t==="top"?{y:"0%"}:t==="bottom"?{y:"100%"}:t?t==="center"?{value:"50%"}:{value:t}:{}}function bE(t,e,n){var r=U1(t,!0),i=r.x,a=r.y;return[$t(i,e)||0,$t(a,n)||0]}function oZ(t,e,n){var r=t.map(function(a){return He(a,e)}),i=r.map(function(a){return qh(a,n)});return{prev:r,next:i,result:i.map(function(a){return At(a,e)})}}function QP(t,e){return t.length===e.length&&t.every(function(n,r){var i=e[r],a=Vn(n),o=Vn(i);return a&&o?QP(n,i):!a&&!o?n===i:!1})}function mu(t,e,n,r,i){var a=t._store,o=a[e];if(!(e in a))if(i!=null)a[e]=i,o=i;else return a[e]=n,n;return o===n||r(o)===r(n)?o:(a[e]=n,n)}function xr(t){return t>=0?1:-1}function Ee(t){return Math.abs(t)}function ox(t,e){return nW(t).map(function(n){return e(n)})}function ZP(t){return Pu(t)?{top:t,left:t,right:t,bottom:t}:{left:t.left||0,top:t.top||0,right:t.right||0,bottom:t.bottom||0}}var lZ=Wh("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(t,e){var n=e.datas,r=e.targets,i=e.angle,a=e.originalDatas,o=t.props,c=o.pinchable,u=o.ables;if(!c)return!1;var d="onPinch".concat(r?"Group":"","Start"),h="drag".concat(r?"Group":"","ControlStart"),p=(c===!0?t.controlAbles:u.filter(function(E){return c.indexOf(E.name)>-1})).filter(function(E){return E.canPinch&&E[h]}),m=ct(t,e,{});r&&(m.targets=r);var b=Pe(t,d,m);n.isPinch=b!==!1,n.ables=p;var w=n.isPinch;return w?(p.forEach(function(E){if(a[E.name]=a[E.name]||{},!!E[h]){var S=ee(ee({},e),{datas:a[E.name],parentRotate:i,isPinch:!0});E[h](t,S)}}),t.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},w):!1},pinch:function(t,e){var n=e.datas,r=e.scale,i=e.distance,a=e.originalDatas,o=e.inputEvent,c=e.targets,u=e.angle;if(n.isPinch){var d=i*(1-1/r),h=ct(t,e,{});c&&(h.targets=c);var p="onPinch".concat(c?"Group":"");Pe(t,p,h);var m=n.ables,b="drag".concat(c?"Group":"","Control");return m.forEach(function(w){w[b]&&w[b](t,ee(ee({},e),{datas:a[w.name],inputEvent:o,resolveMatrix:!0,pinchScale:r,parentDistance:d,parentRotate:u,isPinch:!0}))}),h}},pinchEnd:function(t,e){var n=e.datas,r=e.isPinch,i=e.inputEvent,a=e.targets,o=e.originalDatas;if(n.isPinch){var c="onPinch".concat(a?"Group":"","End"),u=ii(t,e,{isDrag:r});a&&(u.targets=a),Pe(t,c,u);var d=n.ables,h="drag".concat(a?"Group":"","ControlEnd");return d.forEach(function(p){p[h]&&p[h](t,ee(ee({},e),{isDrag:r,datas:o[p.name],inputEvent:i,isPinch:!0}))}),r}},pinchGroupStart:function(t,e){return this.pinchStart(t,ee(ee({},e),{targets:t.props.targets}))},pinchGroup:function(t,e){return this.pinch(t,ee(ee({},e),{targets:t.props.targets}))},pinchGroupEnd:function(t,e){return this.pinchEnd(t,ee(ee({},e),{targets:t.props.targets}))}}),iN=vE("scalable"),cZ={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:yP("scalable"),dragControlCondition:iN,viewClassName:mE("scalable"),dragControlStart:function(t,e){var n=e.datas,r=e.isPinch,i=e.inputEvent,a=e.parentDirection,o=GP(a,r,i,n),c=t.state,u=c.width,d=c.height,h=c.targetTransform,p=c.target,m=c.pos1,b=c.pos2,w=c.pos4;if(!o||!p)return!1;r||uc(t,e),n.datas={},n.transform=h,n.prevDist=[1,1],n.direction=o,n.startOffsetWidth=u,n.startOffsetHeight=d,n.startValue=[1,1];var E=!o[0]&&!o[1]||o[0]||!o[1];nv(t,e,"scale"),n.isWidth=E;function S(M){n.ratio=M&&isFinite(M)?M:0}n.startPositions=Di(t.state);function T(M){var A=NP(n.startPositions,M);n.fixedDirection=A.fixedDirection,n.fixedPosition=A.fixedPosition,n.fixedOffset=A.fixedOffset}n.setFixedDirection=T,S(Ss(m,b)/Ss(b,w)),T([-o[0],-o[1]]);var C=function(M){n.minScaleSize=M},N=function(M){n.maxScaleSize=M};C([-1/0,-1/0]),N([1/0,1/0]);var j=ct(t,e,ee(ee({direction:o,set:function(M){n.startValue=M},setRatio:S,setFixedDirection:T,setMinScaleSize:C,setMaxScaleSize:N},tv(t,e)),{dragStart:br.dragStart(t,new Vu().dragStart([0,0],e))})),P=Pe(t,"onScaleStart",j);return n.startFixedDirection=n.fixedDirection,P!==!1&&(n.isScale=!0,t.state.snapRenderInfo={request:e.isRequest,direction:o}),n.isScale?j:!1},dragControl:function(t,e){J0(t,e,"scale");var n=e.datas,r=e.parentKeepRatio,i=e.parentFlag,a=e.isPinch,o=e.dragClient,c=e.isRequest,u=e.useSnap,d=e.resolveMatrix,h=n.prevDist,p=n.direction,m=n.startOffsetWidth,b=n.startOffsetHeight,w=n.isScale,E=n.startValue,S=n.isWidth,T=n.ratio;if(!w)return!1;var C=t.props,N=C.throttleScale,j=C.parentMoveable,P=p;!p[0]&&!p[1]&&(P=[1,1]);var M=T&&(r??C.keepRatio)||!1,A=t.state,k=[E[0],E[1]];function D(){var ae=KP(P,M,n,e),Ae=ae.distWidth,Re=ae.distHeight,De=m?(m+Ae)/m:1,Ve=b?(b+Re)/b:1;E[0]||(k[0]=Ae/m),E[1]||(k[1]=Re/b);var ze=(P[0]||M?De:1)*k[0],Se=(P[1]||M?Ve:1)*k[1];return ze===0&&(ze=xr(h[0])*Ug),Se===0&&(Se=xr(h[1])*Ug),[ze,Se]}var V=D();if(!a&&t.props.groupable){var L=A.snapRenderInfo||{},U=L.direction;Vn(U)&&(U[0]||U[1])&&(A.snapRenderInfo={direction:p,request:e.isRequest})}Pe(t,"onBeforeScale",ct(t,e,{scale:V,setFixedDirection:function(ae){return n.setFixedDirection(ae),V=D(),V},startFixedDirection:n.startFixedDirection,setScale:function(ae){V=ae}},!0));var O=[V[0]/k[0],V[1]/k[1]],J=o,W=[0,0],q=xr(O[0]*O[1]),K=!o&&!i&&a;if(K||d?J=sE(t,n.targetAllTransform,[0,0],[0,0],n):o||(J=n.fixedPosition),a||(W=BQ(t,O,p,!u&&c,n)),M){P[0]&&P[1]&&W[0]&&W[1]&&(Math.abs(W[0]*m)>Math.abs(W[1]*b)?W[1]=0:W[0]=0);var te=!W[0]&&!W[1];if(te&&(S?O[0]=rt(O[0]*k[0],N)/k[0]:O[1]=rt(O[1]*k[1],N)/k[1]),P[0]&&!P[1]||W[0]&&!W[1]||te&&S){O[0]+=W[0];var se=m*O[0]*k[0]/T;O[1]=xr(q*O[0])*Ee(se/b/k[1])}else if(!P[0]&&P[1]||!W[0]&&W[1]||te&&!S){O[1]+=W[1];var G=b*O[1]*k[1]*T;O[0]=xr(q*O[1])*Ee(G/m/k[0])}}else O[0]+=W[0],O[1]+=W[1],W[0]||(O[0]=rt(O[0]*k[0],N)/k[0]),W[1]||(O[1]=rt(O[1]*k[1],N)/k[1]);O[0]===0&&(O[0]=xr(h[0])*Ug),O[1]===0&&(O[1]=xr(h[1])*Ug),V=GQ(O,[k[0],k[1]]);var F=[m,b],Y=[m*V[0],b*V[1]];Y=_4(Y,n.minScaleSize,n.maxScaleSize,M?T:!1),V=ox(2,function(ae){return F[ae]?Y[ae]/F[ae]:Y[ae]}),O=ox(2,function(ae){return V[ae]/k[ae]});var Q=ox(2,function(ae){return h[ae]?O[ae]/h[ae]:O[ae]}),X="scale(".concat(O.join(", "),")"),ie="scale(".concat(V.join(", "),")"),le=ev(n,ie,X),ge=!E[0]||!E[1],pe=BK(t,ge?ie:X,n.fixedDirection,J,n.fixedOffset,n,ge),_e=K?pe:He(pe,n.prevInverseDist||[0,0]);if(n.prevDist=O,n.prevInverseDist=pe,V[0]===h[0]&&V[1]===h[1]&&_e.every(function(ae){return!ae})&&!j&&!K)return!1;var Ie=ct(t,e,ee({offsetWidth:m,offsetHeight:b,direction:p,scale:V,dist:O,delta:Q,isPinch:!!a},fP(t,le,_e,a,e)));return Pe(t,"onScale",Ie),Ie},dragControlEnd:function(t,e){var n=e.datas;if(!n.isScale)return!1;n.isScale=!1;var r=ii(t,e,{});return Pe(t,"onScaleEnd",r),r},dragGroupControlCondition:iN,dragGroupControlStart:function(t,e){var n=e.datas,r=this.dragControlStart(t,e);if(!r)return!1;var i=Qi(t,"resizable",e);n.moveableScale=t.scale;var a=Ts(t,this,"dragControlStart",e,function(d,h){return Jm(t,d,n,h)}),o=function(d){r.setFixedDirection(d),a.forEach(function(h,p){h.setFixedDirection(d),Jm(t,h.moveable,n,i[p])})};n.setFixedDirection=o;var c=ee(ee({},r),{targets:t.props.targets,events:a,setFixedDirection:o}),u=Pe(t,"onScaleGroupStart",c);return n.isScale=u!==!1,n.isScale?c:!1},dragGroupControl:function(t,e){var n=e.datas;if(n.isScale){ov(t,"onBeforeScale",function(h){Pe(t,"onBeforeScaleGroup",ct(t,e,ee(ee({},h),{targets:t.props.targets}),!0))});var r=this.dragControl(t,e);if(r){var i=r.dist,a=n.moveableScale;t.scale=[i[0]*a[0],i[1]*a[1]];var o=t.props.keepRatio,c=n.fixedPosition,u=Ts(t,this,"dragControl",e,function(h,p){var m=ne(hr(Yh(t.rotation/180*Math.PI,3),[p.datas.originalX*i[0],p.datas.originalY*i[1],1],3),2),b=m[0],w=m[1];return ee(ee({},p),{parentDist:null,parentScale:i,parentKeepRatio:o,dragClient:At(c,[b,w])})}),d=ee({targets:t.props.targets,events:u},r);return Pe(t,"onScaleGroup",d),d}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isScale){this.dragControlEnd(t,e);var i=Ts(t,this,"dragControlEnd",e),a=ii(t,e,{targets:t.props.targets,events:i});return Pe(t,"onScaleGroupEnd",a),n}},request:function(){var t={},e=0,n=0,r=!1;return{isControl:!0,requestStart:function(i){return r=i.useSnap,{datas:t,parentDirection:i.direction||[1,1],useSnap:r}},request:function(i){return e+=i.deltaWidth,n+=i.deltaHeight,{datas:t,parentDist:[e,n],parentKeepRatio:i.keepRatio,useSnap:r}},requestEnd:function(){return{datas:t,isDrag:!0,useSnap:r}}}}};function bo(t,e){return t.map(function(n,r){return Xm(n,e[r],1,2)})}function aN(t,e,n){var r=wn(t,e),i=wn(t,n),a=i-r;return a>=0?a:a+2*Math.PI}function uZ(t,e){var n=aN(t[0],t[1],t[2]),r=aN(e[0],e[1],e[2]),i=Math.PI;return!(n>=i&&r<=i||n<=i&&r>=i)}var dZ={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:mE("warpable"),render:function(t,e){var n=t.props,r=n.resizable,i=n.scalable,a=n.warpable,o=n.zoom;if(r||i||!a)return[];var c=t.state,u=c.pos1,d=c.pos2,h=c.pos3,p=c.pos4,m=bo(u,d),b=bo(d,u),w=bo(u,h),E=bo(h,u),S=bo(h,p),T=bo(p,h),C=bo(d,p),N=bo(p,d);return Ce([e.createElement("div",{className:Fe("line"),key:"middeLine1",style:Tf(m,S,o)}),e.createElement("div",{className:Fe("line"),key:"middeLine2",style:Tf(b,T,o)}),e.createElement("div",{className:Fe("line"),key:"middeLine3",style:Tf(w,C,o)}),e.createElement("div",{className:Fe("line"),key:"middeLine4",style:Tf(E,N,o)})],ne(bP(t,"warpable",e)),!1)},dragControlCondition:function(t,e){if(e.isRequest)return!1;var n=e.inputEvent.target;return Un(n,Fe("direction"))&&Un(n,Fe("warpable"))},dragControlStart:function(t,e){var n=e.datas,r=e.inputEvent,i=t.props.target,a=r.target,o=HP(a,n);if(!o||!i)return!1;var c=t.state,u=c.transformOrigin,d=c.is3d,h=c.targetTransform,p=c.targetMatrix,m=c.width,b=c.height,w=c.left,E=c.top;n.datas={},n.targetTransform=h,n.warpTargetMatrix=d?p:ra(p,3,4),n.targetInverseMatrix=Y4(Fa(n.warpTargetMatrix,4),3,4),n.direction=o,n.left=w,n.top=E,n.poses=[[0,0],[m,0],[0,b],[m,b]].map(function(C){return He(C,u)}),n.nextPoses=n.poses.map(function(C){var N=ne(C,2),j=N[0],P=N[1];return hr(n.warpTargetMatrix,[j,P,0,1],4)}),n.startValue=Kt(4),n.prevMatrix=Kt(4),n.absolutePoses=Di(c),n.posIndexes=dP(o),uc(t,e),nv(t,e,"matrix3d"),c.snapRenderInfo={request:e.isRequest,direction:o};var S=ct(t,e,ee({set:function(C){n.startValue=C}},tv(t,e))),T=Pe(t,"onWarpStart",S);return T!==!1&&(n.isWarp=!0),n.isWarp},dragControl:function(t,e){var n=e.datas,r=e.isRequest,i=e.distX,a=e.distY,o=n.targetInverseMatrix,c=n.prevMatrix,u=n.isWarp,d=n.startValue,h=n.poses,p=n.posIndexes,m=n.absolutePoses;if(!u)return!1;if(J0(t,e,"matrix3d"),cd(t,"warpable")){var b=p.map(function(D){return m[D]});b.length>1&&b.push([(b[0][0]+b[1][0])/2,(b[0][1]+b[1][1])/2]);var w=av(t,r,{horizontal:b.map(function(D){return D[1]+a}),vertical:b.map(function(D){return D[0]+i})}),E=w.horizontal,S=w.vertical;a-=E.offset,i-=S.offset}var T=Ya({datas:n,distX:i,distY:a},!0),C=n.nextPoses.slice();if(p.forEach(function(D){C[D]=At(C[D],T)}),!NK.every(function(D){return uZ(D.map(function(V){return h[V]}),D.map(function(V){return C[V]}))}))return!1;var N=eE(h[0],h[2],h[1],h[3],C[0],C[2],C[1],C[3]);if(!N.length)return!1;var j=Gt(o,N,4),P=cP(n,j,!0),M=Gt(Fa(c,4),P,4);n.prevMatrix=P;var A=Gt(d,P,4),k=ev(n,"matrix3d(".concat(A.join(", "),")"),"matrix3d(".concat(P.join(", "),")"));return aE(e,k),Pe(t,"onWarp",ct(t,e,ee({delta:M,matrix:A,dist:P,multiply:Gt,transform:k},_r({transform:k},e)))),!0},dragControlEnd:function(t,e){var n=e.datas,r=e.isDrag;return n.isWarp?(n.isWarp=!1,Pe(t,"onWarpEnd",ii(t,e,{})),r):!1}},fZ=Fe("area-pieces"),Yg=Fe("area-piece"),JP=Fe("avoid"),hZ=Fe("view-dragging");function lx(t){var e=t.areaElement;if(e){var n=t.state,r=n.width,i=n.height;A4(e,JP),e.style.cssText+="left: 0px; top: 0px; width: ".concat(r,"px; height: ").concat(i,"px")}}function sN(t){return t.createElement("div",{key:"area_pieces",className:fZ},t.createElement("div",{className:Yg}),t.createElement("div",{className:Yg}),t.createElement("div",{className:Yg}),t.createElement("div",{className:Yg}))}var e3={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(t,e){var n=t.props,r=n.target,i=n.dragArea,a=n.groupable,o=n.passDragArea,c=t.getState(),u=c.width,d=c.height,h=c.renderPoses,p=o?Fe("area","pass"):Fe("area");if(a)return[e.createElement("div",{key:"area",ref:Es(t,"areaElement"),className:p}),sN(e)];if(!r||!i)return[];var m=eE([0,0],[u,0],[0,d],[u,d],h[0],h[1],h[2],h[3]),b=m.length?sv(m,!0):"none";return[e.createElement("div",{key:"area",ref:Es(t,"areaElement"),className:p,style:{top:"0px",left:"0px",width:"".concat(u,"px"),height:"".concat(d,"px"),transformOrigin:"0 0",transform:b}}),sN(e)]},dragStart:function(t,e){var n=e.datas,r=e.clientX,i=e.clientY,a=e.inputEvent;if(!a)return!1;n.isDragArea=!1;var o=t.areaElement,c=t.state,u=c.moveableClientRect,d=c.renderPoses,h=c.rootMatrix,p=c.is3d,m=u.left,b=u.top,w=ki(d),E=w.left,S=w.top,T=w.width,C=w.height,N=p?4:3,j=ne(Bu(h,[r-m,i-b],N),2),P=j[0],M=j[1];P-=E,M-=S;var A=[{left:E,top:S,width:T,height:M-10},{left:E,top:S,width:P-10,height:C},{left:E,top:S+M+10,width:T,height:C-M-10},{left:E+P+10,top:S,width:T-P-10,height:C}],k=[].slice.call(o.nextElementSibling.children);A.forEach(function(D,V){k[V].style.cssText="left: ".concat(D.left,"px;top: ").concat(D.top,"px; width: ").concat(D.width,"px; height: ").concat(D.height,"px;")}),T4(o,JP),c.disableNativeEvent=!0},drag:function(t,e){var n=e.datas,r=e.inputEvent;if(this.enableNativeEvent(t),!r)return!1;n.isDragArea||(n.isDragArea=!0,lx(t))},dragEnd:function(t,e){this.enableNativeEvent(t);var n=e.inputEvent,r=e.datas;if(!n)return!1;r.isDragArea||lx(t)},dragGroupStart:function(t,e){return this.dragStart(t,e)},dragGroup:function(t,e){return this.drag(t,e)},dragGroupEnd:function(t,e){return this.dragEnd(t,e)},unset:function(t){lx(t),t.state.disableNativeEvent=!1},enableNativeEvent:function(t){var e=t.state;e.disableNativeEvent&&w4(function(){e.disableNativeEvent=!1})}},pZ=Wh("origin",{props:["origin","svgOrigin"],render:function(t,e){var n=t.props,r=n.zoom,i=n.svgOrigin,a=n.groupable,o=t.getState(),c=o.beforeOrigin,u=o.rotation,d=o.svg,h=o.allMatrix,p=o.is3d,m=o.left,b=o.top,w=o.offsetWidth,E=o.offsetHeight,S;if(!a&&d&&i){var T=ne(bE(i,w,E),2),C=T[0],N=T[1],j=p?4:3,P=an(h,[C,N],j);S=r0(u,r,He(P,[m,b]))}else S=r0(u,r,c);return[e.createElement("div",{className:Fe("control","origin"),style:S,key:"beforeOrigin"})]}});function gZ(t){var e=t.scrollContainer;return[e.scrollLeft,e.scrollTop]}var mZ={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(t,e){var n=t.props,r=n.scrollContainer,i=r===void 0?t.getContainer():r,a=n.scrollOptions,o=new WW,c=za(i,!0);e.datas.dragScroll=o,t.state.dragScroll=o;var u=e.isControl?"controlGesto":"targetGesto",d=e.targets;o.on("scroll",function(h){var p=h.container,m=h.direction,b=ct(t,e,{scrollContainer:p,direction:m}),w=d?"onScrollGroup":"onScroll";d&&(b.targets=d),Pe(t,w,b)}).on("move",function(h){var p=h.offsetX,m=h.offsetY,b=h.inputEvent;t[u].scrollBy(p,m,b.inputEvent,!1)}).on("scrollDrag",function(h){var p=h.next;p(t[u].getCurrentEvent())}),o.dragStart(e,ee({container:c},a))},checkScroll:function(t,e){var n=e.datas.dragScroll;if(n){var r=t.props,i=r.scrollContainer,a=i===void 0?t.getContainer():i,o=r.scrollThreshold,c=o===void 0?0:o,u=r.scrollThrottleTime,d=u===void 0?0:u,h=r.getScrollPosition,p=h===void 0?gZ:h,m=r.scrollOptions;return n.drag(e,ee({container:a,threshold:c,throttleTime:d,getScrollPosition:function(b){return p({scrollContainer:b.container,direction:b.direction})}},m)),!0}},drag:function(t,e){return this.checkScroll(t,e)},dragEnd:function(t,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(t,e){return this.dragStart(t,ee(ee({},e),{isControl:!0}))},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupStart:function(t,e){return this.dragStart(t,ee(ee({},e),{targets:t.props.targets}))},dragGroup:function(t,e){return this.drag(t,ee(ee({},e),{targets:t.props.targets}))},dragGroupEnd:function(t,e){return this.dragEnd(t,ee(ee({},e),{targets:t.props.targets}))},dragGroupControlStart:function(t,e){return this.dragStart(t,ee(ee({},e),{targets:t.props.targets,isControl:!0}))},dragGroupControl:function(t,e){return this.drag(t,ee(ee({},e),{targets:t.props.targets}))},dragGroupControEnd:function(t,e){return this.dragEnd(t,ee(ee({},e),{targets:t.props.targets}))},unset:function(t){var e,n=t.state;(e=n.dragScroll)===null||e===void 0||e.dragEnd(),n.dragScroll=null}},t3={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","preventRightClick","preventWheelClick","requestStyles"],events:["changeTargets"]},vZ=Wh("padding",{props:["padding"],render:function(t,e){var n=t.props;if(n.dragArea)return[];var r=ZP(n.padding||{}),i=r.left,a=r.top,o=r.right,c=r.bottom,u=t.getState(),d=u.renderPoses,h=u.pos1,p=u.pos2,m=u.pos3,b=u.pos4,w=[h,p,m,b],E=[];return i>0&&E.push([0,2]),a>0&&E.push([0,1]),o>0&&E.push([1,3]),c>0&&E.push([2,3]),E.map(function(S,T){var C=ne(S,2),N=C[0],j=C[1],P=w[N],M=w[j],A=d[N],k=d[j],D=eE([0,0],[100,0],[0,100],[100,100],P,M,A,k);if(D.length)return e.createElement("div",{key:"padding".concat(T),className:Fe("padding"),style:{transform:sv(D,!0)}})})}}),oN=["nw","ne","se","sw"];function Xg(t,e){var n=t[0]+t[1],r=n>e?e/n:1;return t[0]*=r,t[1]=e-t[1]*r,t}var yZ=[1,2,5,6],bZ=[0,3,4,7],Bl=[1,-1,-1,1],Ul=[1,1,-1,-1];function xE(t,e,n,r,i,a,o,c){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=n),c===void 0&&(c=r);var u=[],d=!1,h=t.filter(function(m){return!m.virtual}),p=h.map(function(m){var b=m.horizontal,w=m.vertical,E=m.pos;if(w&&!d&&(d=!0,u.push("/")),d){var S=Math.max(0,w===1?E[1]-a:c-E[1]);return u.push(Hi(S,r,e)),S}else{var S=Math.max(0,b===1?E[0]-i:o-E[0]);return u.push(Hi(S,n,e)),S}});return{radiusPoses:h,styles:u,raws:p}}function n3(t){for(var e=[0,0],n=[0,0],r=t.length,i=0;i<r;++i){var a=t[i];a.sub&&(a.horizontal&&(e[1]===0&&(e[0]=i),e[1]=i-e[0]+1,n[0]=i+1),a.vertical&&(n[1]===0&&(n[0]=i),n[1]=i-n[0]+1))}return{horizontalRange:e,verticalRange:n}}function r3(t,e,n,r,i,a,o){var c,u,d,h;a===void 0&&(a=[0,0]),o===void 0&&(o=!1);var p=t.indexOf("/"),m=(p>-1?t.slice(0,p):t).length,b=t.slice(0,m),w=t.slice(m+1),E=b.length,S=w.length,T=S>0,C=ne(b,4),N=C[0],j=N===void 0?"0px":N,P=C[1],M=P===void 0?j:P,A=C[2],k=A===void 0?j:A,D=C[3],V=D===void 0?M:D,L=ne(w,4),U=L[0],O=U===void 0?j:U,J=L[1],W=J===void 0?T?O:M:J,q=L[2],K=q===void 0?T?O:k:q,te=L[3],se=te===void 0?T?W:V:te,G=[j,M,k,V].map(function(le){return $t(le,e)}),F=[O,W,K,se].map(function(le){return $t(le,n)}),Y=G.slice(),Q=F.slice();c=ne(Xg([Y[0],Y[1]],e),2),Y[0]=c[0],Y[1]=c[1],u=ne(Xg([Y[3],Y[2]],e),2),Y[3]=u[0],Y[2]=u[1],d=ne(Xg([Q[0],Q[3]],n),2),Q[0]=d[0],Q[3]=d[1],h=ne(Xg([Q[1],Q[2]],n),2),Q[1]=h[0],Q[2]=h[1];var X=o?Y:Y.slice(0,Math.max(a[0],E)),ie=o?Q:Q.slice(0,Math.max(a[1],S));return Ce(Ce([],ne(X.map(function(le,ge){var pe=oN[ge];return{virtual:ge>=E,horizontal:Bl[ge],vertical:0,pos:[r+le,i+(Ul[ge]===-1?n:0)],sub:!0,raw:G[ge],direction:pe}})),!1),ne(ie.map(function(le,ge){var pe=oN[ge];return{virtual:ge>=S,horizontal:0,vertical:Ul[ge],pos:[r+(Bl[ge]===-1?e:0),i+le],sub:!0,raw:F[ge],direction:pe}})),!1)}function xZ(t,e,n,r,i){i===void 0&&(i=e.length);var a=n3(t.slice(r)),o=a.horizontalRange,c=a.verticalRange,u=n-r,d=0;if(u===0)d=i;else if(u>0&&u<o[1])d=o[1]-u;else if(u>=c[0])d=c[0]+c[1]-u;else return;t.splice(n,d),e.splice(n,d)}function wZ(t,e,n,r,i,a,o,c,u,d,h){d===void 0&&(d=0),h===void 0&&(h=0);var p=n3(t.slice(n)),m=p.horizontalRange,b=p.verticalRange;if(r>-1)for(var w=Bl[r]===1?a-d:c-a,E=m[1];E<=r;++E){var S=Ul[E]===1?h:u,T=0;if(r===E?T=a:E===0?T=d+w:Bl[E]===-1&&(T=c-(e[n][0]-d)),t.splice(n+E,0,{horizontal:Bl[E],vertical:0,pos:[T,S]}),e.splice(n+E,0,[T,S]),E===0)break}else if(i>-1){var C=Ul[i]===1?o-h:u-o;if(m[1]===0&&b[1]===0){var N=[d+C,h];t.push({horizontal:Bl[0],vertical:0,pos:N}),e.push(N)}for(var j=b[0],E=b[1];E<=i;++E){var T=Bl[E]===1?d:c,S=0;if(i===E?S=o:E===0?S=h+C:Ul[E]===1?S=e[n+j][1]:Ul[E]===-1&&(S=u-(e[n+j][1]-h)),t.push({horizontal:0,vertical:Ul[E],pos:[T,S]}),e.push([T,S]),E===0)break}}}function _Z(t,e){e===void 0&&(e=t.map(function(i){return i.raw}));var n=t.map(function(i,a){return i.horizontal?e[a]:null}).filter(function(i){return i!=null}),r=t.map(function(i,a){return i.vertical?e[a]:null}).filter(function(i){return i!=null});return{horizontals:n,verticals:r}}var EZ=[[0,-1,"n"],[1,0,"e"]],SZ=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function wE(t,e,n){var r=t.props.clipRelative,i=t.state,a=i.width,o=i.height,c=e,u=c.type,d=c.poses,h=u==="rect",p=u==="circle";if(u==="polygon")return n.map(function(M){return"".concat(Hi(M[0],a,r)," ").concat(Hi(M[1],o,r))});if(h||u==="inset"){var m=n[1][1],b=n[3][0],w=n[7][0],E=n[5][1];if(h)return[m,b,E,w].map(function(M){return"".concat(M,"px")});var S=[m,a-b,o-E,w].map(function(M,A){return Hi(M,A%2?a:o,r)});if(n.length>8){var T=ne(He(n[4],n[0]),2),C=T[0],N=T[1];S.push.apply(S,Ce(["round"],ne(xE(d.slice(8).map(function(M,A){return ee(ee({},M),{pos:n[A]})}),r,C,N,w,m,b,E).styles),!1))}return S}else if(p||u==="ellipse"){var j=n[0],P=Hi(Ee(n[1][1]-j[1]),p?Math.sqrt((a*a+o*o)/2):o,r),S=p?[P]:[Hi(Ee(n[2][0]-j[0]),a,r),P];return S.push("at",Hi(j[0],a,r),Hi(j[1],o,r)),S}}function a0(t,e,n,r){var i=[r,(r+e)/2,e],a=[t,(t+n)/2,n];return SZ.map(function(o){var c=ne(o,3),u=c[0],d=c[1],h=c[2],p=i[u+1],m=a[d+1];return{vertical:Ee(d),horizontal:Ee(u),direction:h,pos:[p,m]}})}function i3(t){var e=[1/0,-1/0],n=[1/0,-1/0];return t.forEach(function(r){var i=r.pos;e[0]=Math.min(e[0],i[0]),e[1]=Math.max(e[1],i[0]),n[0]=Math.min(n[0],i[1]),n[1]=Math.max(n[1],i[1])}),[Ee(e[1]-e[0]),Ee(n[1]-n[0])]}function lN(t,e,n,r,i){var a,o,c,u,d,h,p,m,b;if(t){var w=i;if(!w){var E=Ur(t),S=E("clipPath");w=S!=="none"?S:E("clip")}if(!((!w||w==="none"||w==="auto")&&(w=r,!w))){var T=x4(w),C=T.prefix,N=C===void 0?w:C,j=T.value,P=j===void 0?"":j,M=N==="circle",A=" ";if(N==="polygon"){var k=Hl(P||"0% 0%, 100% 0%, 100% 100%, 0% 100%");A=",";var D=k.map(function(st){var _t=ne(st.split(" "),2),Ze=_t[0],ut=_t[1];return{vertical:1,horizontal:1,pos:[$t(Ze,e),$t(ut,n)]}}),V=rc(D.map(function(st){return st.pos}));return{type:N,clipText:w,poses:D,splitter:A,left:V.minX,right:V.maxX,top:V.minY,bottom:V.maxY}}else if(M||N==="ellipse"){var L="",U="",O=0,J=0,k=Ko(P);if(M){var W="";a=ne(k,4),o=a[0],W=o===void 0?"50%":o,c=a[2],L=c===void 0?"50%":c,u=a[3],U=u===void 0?"50%":u,O=$t(W,Math.sqrt((e*e+n*n)/2)),J=O}else{var q="",K="";d=ne(k,5),h=d[0],q=h===void 0?"50%":h,p=d[1],K=p===void 0?"50%":p,m=d[3],L=m===void 0?"50%":m,b=d[4],U=b===void 0?"50%":b,O=$t(q,e),J=$t(K,n)}var te=[$t(L,e),$t(U,n)],D=Ce([{vertical:1,horizontal:1,pos:te,direction:"nesw"}],ne(EZ.slice(0,M?1:2).map(function(Ze){return{vertical:Ee(Ze[1]),horizontal:Ze[0],direction:Ze[2],sub:!0,pos:[te[0]+Ze[0]*O,te[1]+Ze[1]*J]}})),!1);return{type:N,clipText:w,radiusX:O,radiusY:J,left:te[0]-O,top:te[1]-J,right:te[0]+O,bottom:te[1]+J,poses:D,splitter:A}}else if(N==="inset"){var k=Ko(P||"0 0 0 0"),se=k.indexOf("round"),G=(se>-1?k.slice(0,se):k).length,F=k.slice(G+1),Y=ne(k.slice(0,G),4),Q=Y[0],X=Y[1],ie=X===void 0?Q:X,le=Y[2],ge=le===void 0?Q:le,pe=Y[3],_e=pe===void 0?ie:pe,Ie=ne([Q,ge].map(function(Ze){return $t(Ze,n)}),2),ae=Ie[0],Ae=Ie[1],Re=ne([_e,ie].map(function(Ze){return $t(Ze,e)}),2),De=Re[0],Ve=Re[1],ze=e-Ve,Se=n-Ae,Le=r3(F,ze-De,Se-ae,De,ae),D=Ce(Ce([],ne(a0(ae,ze,Se,De)),!1),ne(Le),!1);return{type:"inset",clipText:w,poses:D,top:ae,left:De,right:ze,bottom:Se,radius:F,splitter:A}}else if(N==="rect"){var k=Hl(P||"0px, ".concat(e,"px, ").concat(n,"px, 0px"));A=",";var Me=ne(k.map(function(cn){var Mt=Fh(cn).value;return Mt}),4),Be=Me[0],Ve=Me[1],Ae=Me[2],De=Me[3],D=a0(Be,Ve,Ae,De);return{type:"rect",clipText:w,poses:D,top:Be,right:Ve,bottom:Ae,left:De,values:k,splitter:A}}}}}function TZ(t,e,n,r,i){var a=t[e],o=a.direction,c=a.sub,u=t.map(function(){return[0,0]}),d=o?o.split(""):[];if(r&&e<8){var h=d.filter(function(O){return O==="w"||O==="e"}),p=d.filter(function(O){return O==="n"||O==="s"}),m=h[0],b=p[0];u[e]=n;var w=ne(i3(t),2),E=w[0],S=w[1],T=E&&S?E/S:0;if(T&&i){var C=(e+4)%8,N=t[C].pos,j=[0,0];o.indexOf("w")>-1?j[0]=-1:o.indexOf("e")>-1&&(j[0]=1),o.indexOf("n")>-1?j[1]=-1:o.indexOf("s")>-1&&(j[1]=1);var P=WP([E,S],n,T,j,!0),M=E+P[0],A=S+P[1],k=N[1],D=N[1],V=N[0],L=N[0];j[0]===-1?V=L-M:j[0]===1?L=V+M:(V=V-M/2,L=L+M/2),j[1]===-1?k=D-A:(j[1]===1||(k=D-A/2),D=k+A);var U=a0(k,L,D,V);t.forEach(function(O,J){u[J][0]=U[J].pos[0]-O.pos[0],u[J][1]=U[J].pos[1]-O.pos[1]})}else t.forEach(function(O,J){var W=O.direction;W&&(W.indexOf(m)>-1&&(u[J][0]=n[0]),W.indexOf(b)>-1&&(u[J][1]=n[1]))}),m&&(u[1][0]=n[0]/2,u[5][0]=n[0]/2),b&&(u[3][1]=n[1]/2,u[7][1]=n[1]/2)}else o&&!c?d.forEach(function(O){var J=O==="n"||O==="s";t.forEach(function(W,q){var K=W.direction,te=W.horizontal,se=W.vertical;!K||K.indexOf(O)===-1||(u[q]=[J||!te?0:n[0],!J||!se?0:n[1]])})}):u[e]=n;return u}function AZ(t,e){var n=ne(lP(t,e),2),r=n[0],i=n[1],a=e.datas,o=a.clipPath,c=a.clipIndex,u=o,d=u.type,h=u.poses,p=u.splitter,m=h.map(function(C){return C.pos});if(d==="polygon")m.splice(c,0,[r,i]);else if(d==="inset"){var b=yZ.indexOf(c),w=bZ.indexOf(c),E=h.length;if(wZ(h,m,8,b,w,r,i,m[4][0],m[4][1],m[0][0],m[0][1]),E===h.length)return}else return;var S=wE(t,o,m),T="".concat(d,"(").concat(S.join(p),")");Pe(t,"onClip",ct(t,e,ee({clipEventType:"added",clipType:d,poses:m,clipStyles:S,clipStyle:T,distX:0,distY:0},_r({clipPath:T},e))))}function CZ(t,e){var n=e.datas,r=n.clipPath,i=n.clipIndex,a=r,o=a.type,c=a.poses,u=a.splitter,d=c.map(function(b){return b.pos}),h=d.length;if(o==="polygon")c.splice(i,1),d.splice(i,1);else if(o==="inset"){if(i<8||(xZ(c,d,i,8,h),h===c.length))return}else return;var p=wE(t,r,d),m="".concat(o,"(").concat(p.join(u),")");Pe(t,"onClip",ct(t,e,ee({clipEventType:"removed",clipType:o,poses:d,clipStyles:p,clipStyle:m,distX:0,distY:0},_r({clipPath:m},e))))}var kZ={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(t,e){var n=t.props,r=n.customClipPath,i=n.defaultClipPath,a=n.clipArea,o=n.zoom,c=n.groupable,u=t.getState(),d=u.target,h=u.width,p=u.height,m=u.allMatrix,b=u.is3d,w=u.left,E=u.top,S=u.pos1,T=u.pos2,C=u.pos3,N=u.pos4,j=u.clipPathState,P=u.snapBoundInfos,M=u.rotation;if(!d||c)return[];var A=lN(d,h,p,i||"inset",j||r);if(!A)return[];var k=b?4:3,D=A.type,V=A.poses,L=V.map(function(Ve){var ze=an(m,Ve.pos,k);return[ze[0]-w,ze[1]-E]}),U=[],O=[],J=D==="rect",W=D==="inset",q=D==="polygon";if(J||W||q){var K=W?L.slice(0,8):L;O=K.map(function(Ve,ze){var Se=ze===0?K[K.length-1]:K[ze-1],Le=wn(Se,Ve),Me=BP(Se,Ve);return e.createElement("div",{key:"clipLine".concat(ze),className:Fe("line","clip-line","snap-control"),"data-clip-index":ze,style:{width:"".concat(Me,"px"),transform:"translate(".concat(Se[0],"px, ").concat(Se[1],"px) rotate(").concat(Le,"rad) scaleY(").concat(o,")")}})})}if(U=L.map(function(Ve,ze){return e.createElement("div",{key:"clipControl".concat(ze),className:Fe("control","clip-control","snap-control"),"data-clip-index":ze,style:{transform:"translate(".concat(Ve[0],"px, ").concat(Ve[1],"px) rotate(").concat(M,"rad) scale(").concat(o,")")}})}),W&&U.push.apply(U,Ce([],ne(L.slice(8).map(function(Ve,ze){return e.createElement("div",{key:"clipRadiusControl".concat(ze),className:Fe("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+ze,style:{transform:"translate(".concat(Ve[0],"px, ").concat(Ve[1],"px) rotate(").concat(M,"rad) scale(").concat(o,")")}})})),!1)),D==="circle"||D==="ellipse"){var te=A.left,se=A.top,G=A.radiusX,F=A.radiusY,Y=ne(He(an(m,[te,se],k),an(m,[0,0],k)),2),Q=Y[0],X=Y[1],ie="none";if(!a){for(var le=Math.max(10,G/5,F/5),ge=[],pe=0;pe<=le;++pe){var _e=Math.PI*2/le*pe;ge.push([G+(G-o)*Math.cos(_e),F+(F-o)*Math.sin(_e)])}ge.push([G,-2]),ge.push([-2,-2]),ge.push([-2,F*2+2]),ge.push([G*2+2,F*2+2]),ge.push([G*2+2,-2]),ge.push([G,-2]),ie="polygon(".concat(ge.map(function(Ve){return"".concat(Ve[0],"px ").concat(Ve[1],"px")}).join(", "),")")}U.push(e.createElement("div",{key:"clipEllipse",className:Fe("clip-ellipse","snap-control"),style:{width:"".concat(G*2,"px"),height:"".concat(F*2,"px"),clipPath:ie,transform:"translate(".concat(-w+Q,"px, ").concat(-E+X,"px) ").concat(sv(m))}}))}if(a){var Ie=ki(Ce([S,T,C,N],ne(L),!1)),ae=Ie.width,Ae=Ie.height,Re=Ie.left,De=Ie.top;if(q||J||W){var ge=W?L.slice(0,8):L;U.push(e.createElement("div",{key:"clipArea",className:Fe("clip-area","snap-control"),style:{width:"".concat(ae,"px"),height:"".concat(Ae,"px"),transform:"translate(".concat(Re,"px, ").concat(De,"px)"),clipPath:"polygon(".concat(ge.map(function(ze){return"".concat(ze[0]-Re,"px ").concat(ze[1]-De,"px")}).join(", "),")")}}))}}return P&&["vertical","horizontal"].forEach(function(Ve){var ze=P[Ve],Se=Ve==="horizontal";ze.isSnap&&O.push.apply(O,Ce([],ne(ze.snap.posInfos.map(function(Le,Me){var Be=Le.pos,st=He(an(m,Se?[0,Be]:[Be,0],k),[w,E]),_t=He(an(m,Se?[h,Be]:[Be,p],k),[w,E]);return ph(e,"",st,_t,o,"clip".concat(Ve,"snap").concat(Me),"guideline")})),!1)),ze.isBound&&O.push.apply(O,Ce([],ne(ze.bounds.map(function(Le,Me){var Be=Le.pos,st=He(an(m,Se?[0,Be]:[Be,0],k),[w,E]),_t=He(an(m,Se?[h,Be]:[Be,p],k),[w,E]);return ph(e,"",st,_t,o,"clip".concat(Ve,"bounds").concat(Me),"guideline","bounds","bold")})),!1))}),Ce(Ce([],ne(U),!1),ne(O),!1)},dragControlCondition:function(t,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(t,e){var n=t.props,r=n.dragWithClip,i=r===void 0?!0:r;return i?!1:this.dragControlStart(t,e)},drag:function(t,e){return this.dragControl(t,ee(ee({},e),{isDragTarget:!0}))},dragEnd:function(t,e){return this.dragControlEnd(t,e)},dragControlStart:function(t,e){var n=t.state,r=t.props,i=r.defaultClipPath,a=r.customClipPath,o=n.target,c=n.width,u=n.height,d=e.inputEvent?e.inputEvent.target:null,h=d&&d.getAttribute("class")||"",p=e.datas,m=lN(o,c,u,i||"inset",a);if(!m)return!1;var b=m.clipText,w=m.type,E=m.poses,S=Pe(t,"onClipStart",ct(t,e,{clipType:w,clipStyle:b,poses:E.map(function(T){return T.pos})}));return S===!1?(p.isClipStart=!1,!1):(p.isControl=h&&h.indexOf("clip-control")>-1,p.isLine=h.indexOf("clip-line")>-1,p.isArea=h.indexOf("clip-area")>-1||h.indexOf("clip-ellipse")>-1,p.clipIndex=d?parseInt(d.getAttribute("data-clip-index"),10):-1,p.clipPath=m,p.isClipStart=!0,n.clipPathState=b,uc(t,e),!0)},dragControl:function(t,e){var n,r,i,a=e.datas,o=e.originalDatas,c=e.isDragTarget;if(!a.isClipStart)return!1;var u=a,d=u.isControl,h=u.isLine,p=u.isArea,m=u.clipIndex,b=u.clipPath;if(!b)return!1;var w=ic(t.props,"clippable"),E=w.keepRatio,S=0,T=0,C=o.draggable,N=Ya(e);c&&C?(n=ne(C.prevBeforeDist,2),S=n[0],T=n[1]):(r=ne(N,2),S=r[0],T=r[1]);var j=[S,T],P=t.state,M=P.width,A=P.height,k=!p&&!d&&!h,D=b.type,V=b.poses,L=b.splitter,U=V.map(function(ft){return ft.pos});k&&(S=-S,T=-T);var O=!d||V[m].direction==="nesw",J=D==="inset"||D==="rect",W=V.map(function(){return[0,0]});if(d&&!O){var q=V[m],K=q.horizontal,te=q.vertical,se=[S*Ee(K),T*Ee(te)];W=TZ(V,m,se,J,E)}else O&&(W=U.map(function(){return[S,T]}));var G=U.map(function(ft,nn){return At(ft,W[nn])}),F=Ce([],ne(G),!1);P.snapBoundInfos=null;var Y=b.type==="circle",Q=b.type==="ellipse";if(Y||Q){var X=ki(G),ie=Ee(X.bottom-X.top),le=Ee(Q?X.right-X.left:ie),ge=G[0][1]+ie,pe=G[0][0]-le,_e=G[0][0]+le;Y&&(F.push([_e,X.bottom]),W.push([1,0])),F.push([X.left,ge]),W.push([0,1]),F.push([pe,X.bottom]),W.push([1,0])}var Ie=OP((w.clipHorizontalGuidelines||[]).map(function(ft){return $t("".concat(ft),A)}),(w.clipVerticalGuidelines||[]).map(function(ft){return $t("".concat(ft),M)}),M,A),ae=[],Ae=[];if(Y||Q)ae=[F[4][0],F[2][0]],Ae=[F[1][1],F[3][1]];else if(J){var Re=[F[0],F[2],F[4],F[6]],De=[W[0],W[2],W[4],W[6]];ae=Re.filter(function(ft,nn){return De[nn][0]}).map(function(ft){return ft[0]}),Ae=Re.filter(function(ft,nn){return De[nn][1]}).map(function(ft){return ft[1]})}else ae=F.filter(function(ft,nn){return W[nn][0]}).map(function(ft){return ft[0]}),Ae=F.filter(function(ft,nn){return W[nn][1]}).map(function(ft){return ft[1]});var Ve=[0,0],ze=qR(Ie,w.clipTargetBounds&&{left:0,top:0,right:M,bottom:A},ae,Ae,5,5),Se=ze.horizontal,Le=ze.vertical,Me=Se.offset,Be=Le.offset;if(Se.isBound&&(Ve[1]+=Me),Le.isBound&&(Ve[0]+=Be),(Q||Y)&&W[0][0]===0&&W[0][1]===0){var X=ki(G),st=X.bottom-X.top,_t=Q?X.right-X.left:st,Ze=Le.isBound?Ee(Be):Le.snapIndex===0?-Be:Be,ut=Se.isBound?Ee(Me):Se.snapIndex===0?-Me:Me;_t-=Ze,st-=ut,Y&&(st=AP(Le,Se)>0?st:_t,_t=st);var Rt=F[0];F[1][1]=Rt[1]-st,F[2][0]=Rt[0]+_t,F[3][1]=Rt[1]+st,F[4][0]=Rt[0]-_t}else if(J&&E&&d){var cn=ne(i3(V),2),Mt=cn[0],_n=cn[1],$r=Mt&&_n?Mt/_n:0,sa=V[m],Xa=sa.direction||"",Vs=F[1][1],ge=F[5][1],pe=F[7][0],_e=F[3][0];Ee(Me)<=Ee(Be)?Me=xr(Me)*Ee(Be)/$r:Be=xr(Be)*Ee(Me)*$r,Xa.indexOf("w")>-1?pe-=Be:Xa.indexOf("e")>-1?_e-=Be:(pe+=Be/2,_e-=Be/2),Xa.indexOf("n")>-1?Vs-=Me:Xa.indexOf("s")>-1?ge-=Me:(Vs+=Me/2,ge-=Me/2);var Gr=a0(Vs,_e,ge,pe);F.forEach(function(Hr,si){var gr;gr=ne(Gr[si].pos,2),Hr[0]=gr[0],Hr[1]=gr[1]})}else F.forEach(function(ft,nn){var rn=W[nn];rn[0]&&(ft[0]-=Be),rn[1]&&(ft[1]-=Me)});var En=wE(t,b,G),sr="".concat(D,"(").concat(En.join(L),")");if(P.clipPathState=sr,Y||Q)ae=[F[4][0],F[2][0]],Ae=[F[1][1],F[3][1]];else if(J){var Re=[F[0],F[2],F[4],F[6]];ae=Re.map(function(nn){return nn[0]}),Ae=Re.map(function(nn){return nn[1]})}else ae=F.map(function(ft){return ft[0]}),Ae=F.map(function(ft){return ft[1]});if(P.snapBoundInfos=qR(Ie,w.clipTargetBounds&&{left:0,top:0,right:M,bottom:A},ae,Ae,1,1),C){var tn=P.is3d,fc=P.allMatrix,zs=tn?4:3,Ls=Ve;c&&(Ls=[j[0]+Ve[0]-N[0],j[1]+Ve[1]-N[1]]),C.deltaOffset=Gt(fc,[Ls[0],Ls[1],0,0],zs)}return Pe(t,"onClip",ct(t,e,ee({clipEventType:"changed",clipType:D,poses:G,clipStyle:sr,clipStyles:En,distX:S,distY:T},_r((i={},i[D==="rect"?"clip":"clipPath"]=sr,i),e)))),!0},dragControlEnd:function(t,e){this.unset(t);var n=e.isDrag,r=e.datas,i=e.isDouble,a=r.isLine,o=r.isClipStart,c=r.isControl;return o?(Pe(t,"onClipEnd",ii(t,e,{})),i&&(c?CZ(t,e):a&&AZ(t,e)),i||n):!1},unset:function(t){t.state.clipPathState="",t.state.snapBoundInfos=null}},RZ={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(t,e){return e.isRequest?e.requestAble==="originDraggable":Un(e.inputEvent.target,Fe("origin"))},dragControlStart:function(t,e){var n=e.datas;uc(t,e);var r=ct(t,e,{dragStart:br.dragStart(t,new Vu().dragStart([0,0],e))}),i=Pe(t,"onDragOriginStart",r);return n.startOrigin=t.state.transformOrigin,n.startTargetOrigin=t.state.targetOrigin,n.prevOrigin=[0,0],n.isDragOrigin=!0,i===!1?(n.isDragOrigin=!1,!1):r},dragControl:function(t,e){var n=e.datas,r=e.isPinch,i=e.isRequest;if(!n.isDragOrigin)return!1;var a=ne(Ya(e),2),o=a[0],c=a[1],u=t.state,d=u.width,h=u.height,p=u.offsetMatrix,m=u.targetMatrix,b=u.is3d,w=t.props.originRelative,E=w===void 0?!0:w,S=b?4:3,T=[o,c];if(i){var C=e.distOrigin;(C[0]||C[1])&&(T=C)}var N=At(n.startOrigin,T),j=At(n.startTargetOrigin,T),P=He(T,n.prevOrigin),M=Qh(p,m,N,S),A=t.getRect(),k=ki(dc(M,d,h,S)),D=[A.left-k.left,A.top-k.top];n.prevOrigin=T;var V=[Hi(j[0],d,E),Hi(j[1],h,E)].join(" "),L=br.drag(t,Kh(e,t.state,D,!!r)),U=ct(t,e,ee(ee({width:d,height:h,origin:N,dist:T,delta:P,transformOrigin:V,drag:L},_r({transformOrigin:V,transform:L.transform},e)),{afterTransform:L.transform}));return Pe(t,"onDragOrigin",U),U},dragControlEnd:function(t,e){var n=e.datas;return n.isDragOrigin?(Pe(t,"onDragOriginEnd",ii(t,e,{})),!0):!1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragGroupControlStart:function(t,e){var n=this.dragControlStart(t,e);return!!n},dragGroupControl:function(t,e){var n=this.dragControl(t,e);return n?(t.transformOrigin=n.transformOrigin,!0):!1},request:function(t){var e={},n=t.getRect(),r=0,i=0,a=n.transformOrigin,o=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(c){return"deltaOrigin"in c?(o[0]+=c.deltaOrigin[0],o[1]+=c.deltaOrigin[1]):"origin"in c?(o[0]=c.origin[0]-a[0],o[1]=c.origin[1]-a[1]):("x"in c?r=c.x-n.left:"deltaX"in c&&(r+=c.deltaX),"y"in c?i=c.y-n.top:"deltaY"in c&&(i+=c.deltaY)),{datas:e,distX:r,distY:i,distOrigin:o}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function NZ(t,e,n,r){var i=t.filter(function(u){var d=u.virtual,h=u.horizontal;return h&&!d}).length,a=t.filter(function(u){var d=u.virtual,h=u.vertical;return h&&!d}).length,o=-1;if(e===0&&(i===0?o=0:i===1&&(o=1)),e===2&&(i<=2?o=2:i<=3&&(o=3)),e===3&&(a===0?o=4:a<4&&(o=7)),e===1&&(a<=1?o=5:a<=2&&(o=6)),!(o===-1||!t[o].virtual)){var c=t[o];DZ(t,o),o<4?c.pos[0]=n:c.pos[1]=r}}function DZ(t,e){e<4?t.slice(0,e+1).forEach(function(n){n.virtual=!1}):(t[0].virtual&&(t[0].virtual=!1),t.slice(4,e+1).forEach(function(n){n.virtual=!1}))}function IZ(t,e){e<4?t.slice(e,4).forEach(function(n){n.virtual=!0}):t.slice(e).forEach(function(n){n.virtual=!0})}function cN(t,e,n,r,i){r===void 0&&(r=[0,0]);var a=[];return!t||t==="0px"?a=[]:a=Ko(t),r3(a,e,n,0,0,r,i)}function uN(t,e,n,r,i){var a=t.state,o=a.width,c=a.height,u=xE(i,t.props.roundRelative,o,c),d=u.raws,h=u.styles,p=u.radiusPoses,m=_Z(p,d),b=m.horizontals,w=m.verticals,E=h.join(" ");a.borderRadiusState=E;var S=ct(t,e,ee({horizontals:b,verticals:w,borderRadius:E,width:o,height:c,delta:r,dist:n},_r({borderRadius:E},e)));return Pe(t,"onRound",S),S}function dN(t){var e,n,r=t.getState().style,i=r.borderRadius||"";if(!i&&t.props.groupable){var a=t.moveables[0],o=t.getTargets()[0];o&&(a?.props.target===o?(i=(n=(e=t.moveables[0])===null||e===void 0?void 0:e.state.style.borderRadius)!==null&&n!==void 0?n:"",r.borderRadius=i):(i=gE(o).borderRadius,r.borderRadius=i))}return i}var MZ={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(t){var e=t.props.roundClickable;return e===!0||e==="line"?Fe("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(t,e){var n=t.getState(),r=n.target,i=n.width,a=n.height,o=n.allMatrix,c=n.is3d,u=n.left,d=n.top,h=n.borderRadiusState,p=t.props,m=p.minRoundControls,b=m===void 0?[0,0]:m,w=p.maxRoundControls,E=w===void 0?[4,4]:w,S=p.zoom,T=p.roundPadding,C=T===void 0?0:T,N=p.isDisplayShadowRoundControls,j=p.groupable;if(!r)return null;var P=h||dN(t),M=c?4:3,A=cN(P,i,a,b,!0);if(!A)return null;var k=0,D=0,V=j?[0,0]:[u,d];return A.map(function(L,U){var O=L.horizontal,J=L.vertical,W=L.direction||"",q=Ce([],ne(L.pos),!1);D+=Math.abs(O),k+=Math.abs(J),O&&W.indexOf("n")>-1&&(q[1]-=C),J&&W.indexOf("w")>-1&&(q[0]-=C),O&&W.indexOf("s")>-1&&(q[1]+=C),J&&W.indexOf("e")>-1&&(q[0]+=C);var K=He(an(o,q,M),V),te=N&&N!=="horizontal",se=L.vertical?k<=E[1]&&(te||!L.virtual):D<=E[0]&&(N||!L.virtual);return e.createElement("div",{key:"borderRadiusControl".concat(U),className:Fe("control","border-radius",L.vertical?"vertical":"",L.virtual?"virtual":""),"data-radius-index":U,style:{display:se?"block":"none",transform:"translate(".concat(K[0],"px, ").concat(K[1],"px) scale(").concat(S,")")}})})},dragControlCondition:function(t,e){if(!e.inputEvent||e.isRequest)return!1;var n=e.inputEvent.target.getAttribute("class")||"";return n.indexOf("border-radius")>-1||n.indexOf("moveable-line")>-1&&n.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragControlStart:function(t,e){var n=e.inputEvent,r=e.datas,i=n.target,a=i.getAttribute("class")||"",o=a.indexOf("border-radius")>-1,c=a.indexOf("moveable-line")>-1&&a.indexOf("moveable-direction")>-1,u=o?parseInt(i.getAttribute("data-radius-index"),10):-1,d=-1;if(c){var h=i.getAttribute("data-line-key")||"";h&&(d=parseInt(h.replace(/render-line-/g,""),10),isNaN(d)&&(d=-1))}if(!o&&!c)return!1;var p=ct(t,e,{}),m=Pe(t,"onRoundStart",p);if(m===!1)return!1;r.lineIndex=d,r.controlIndex=u,r.isControl=o,r.isLine=c,uc(t,e);var b=t.props,w=b.roundRelative,E=b.minRoundControls,S=E===void 0?[0,0]:E,T=t.state,C=T.width,N=T.height;r.isRound=!0,r.prevDist=[0,0];var j=dN(t),P=cN(j||"",C,N,S,!0)||[];return r.controlPoses=P,T.borderRadiusState=xE(P,w,C,N).styles.join(" "),p},dragControl:function(t,e){var n=e.datas,r=n.controlPoses;if(!n.isRound||!n.isControl||!r.length)return!1;var i=n.controlIndex,a=ne(Ya(e),2),o=a[0],c=a[1],u=[o,c],d=He(u,n.prevDist),h=t.props.maxRoundControls,p=h===void 0?[4,4]:h,m=t.state,b=m.width,w=m.height,E=r[i],S=E.vertical,T=E.horizontal,C=r.map(function(j){var P=j.horizontal,M=j.vertical,A=[P*T*u[0],M*S*u[1]];if(P){if(p[0]===1)return A;if(p[0]<4&&P!==T)return A}else{if(p[1]===0)return A[1]=M*T*u[0]/b*w,A;if(S){if(p[1]===1)return A;if(p[1]<4&&M!==S)return A}}return[0,0]});C[i]=u;var N=r.map(function(j,P){return ee(ee({},j),{pos:At(j.pos,C[P])})});return i<4?N.slice(0,i+1).forEach(function(j){j.virtual=!1}):N.slice(4,i+1).forEach(function(j){j.virtual=!1}),n.prevDist=[o,c],uN(t,e,u,d,N)},dragControlEnd:function(t,e){var n=t.state;n.borderRadiusState="";var r=e.datas,i=e.isDouble;if(!r.isRound)return!1;var a=r.isControl,o=r.controlIndex,c=r.isLine,u=r.lineIndex,d=r.controlPoses,h=d.filter(function(T){var C=T.virtual;return C}).length,p=t.props.roundClickable,m=p===void 0?!0:p;if(i&&m){if(a&&(m===!0||m==="control"))IZ(d,o);else if(c&&(m===!0||m==="line")){var b=ne(lP(t,e),2),w=b[0],E=b[1];NZ(d,u,w,E)}h!==d.filter(function(T){var C=T.virtual;return C}).length&&uN(t,e,[0,0],[0,0],d)}var S=ii(t,e,{});return Pe(t,"onRoundEnd",S),n.borderRadiusState="",S},dragGroupControlStart:function(t,e){var n=this.dragControlStart(t,e);if(!n)return!1;var r=t.moveables,i=t.props.targets,a=Qi(t,"roundable",e),o=ee({targets:t.props.targets,events:a.map(function(c,u){return ee(ee({},c),{target:i[u],moveable:r[u],currentTarget:r[u]})})},n);return Pe(t,"onRoundGroupStart",o),n},dragGroupControl:function(t,e){var n=this.dragControl(t,e);if(!n)return!1;var r=t.moveables,i=t.props.targets,a=Qi(t,"roundable",e),o=ee({targets:t.props.targets,events:a.map(function(c,u){return ee(ee(ee({},c),{target:i[u],moveable:r[u],currentTarget:r[u]}),_r({borderRadius:n.borderRadius},c))})},n);return Pe(t,"onRoundGroup",o),o},dragGroupControlEnd:function(t,e){var n=t.moveables,r=t.props.targets,i=Qi(t,"roundable",e);ov(t,"onRound",function(c){var u=ee({targets:t.props.targets,events:i.map(function(d,h){return ee(ee(ee({},d),{target:r[h],moveable:n[h],currentTarget:n[h]}),_r({borderRadius:c.borderRadius},d))})},c);Pe(t,"onRoundGroup",u)});var a=this.dragControlEnd(t,e);if(!a)return!1;var o=ee({targets:t.props.targets,events:i.map(function(c,u){var d;return ee(ee({},c),{target:r[u],moveable:n[u],currentTarget:n[u],lastEvent:(d=c.datas)===null||d===void 0?void 0:d.lastEvent})})},a);return Pe(t,"onRoundGroupEnd",o),o},unset:function(t){t.state.borderRadiusState=""}};function OZ(t,e){var n=e?4:3,r=Kt(n),i="matrix".concat(e?"3d":"","(").concat(r.join(","),")");return t===i||t==="matrix(1,0,0,1,0,0)"}var a3={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(t,e){var n=t.state,r=n.is3d,i=n.targetMatrix,a=n.inlineTransform,o=r?"matrix3d(".concat(i.join(","),")"):"matrix(".concat(W4(i,!0),")"),c=!a||a==="none"?o:a;e.datas.startTransforms=OZ(c,r)?[]:Ko(c)},resetStyle:function(t){var e=t.datas;e.nextStyle={},e.nextTransforms=t.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(t,e){return ct(t,e,{setTransform:function(n){e.datas.startTransforms=Vn(n)?n:Ko(n)},isPinch:!!e.isPinch})},fillDragParams:function(t,e){return ct(t,e,{isPinch:!!e.isPinch})},dragStart:function(t,e){this.setTransform(t,e),this.resetStyle(e),Pe(t,"onBeforeRenderStart",this.fillDragStartParams(t,e))},drag:function(t,e){e.datas.startTransforms||this.setTransform(t,e),this.resetStyle(e),Pe(t,"onBeforeRender",ct(t,e,{isPinch:!!e.isPinch}))},dragEnd:function(t,e){e.datas.startTransforms||(this.setTransform(t,e),this.resetStyle(e)),Pe(t,"onBeforeRenderEnd",ct(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(t,e){var n=this;this.dragStart(t,e);var r=Qi(t,"beforeRenderable",e),i=t.moveables,a=r.map(function(o,c){var u=i[c];return n.setTransform(u,o),n.resetStyle(o),n.fillDragStartParams(u,o)});Pe(t,"onBeforeRenderGroupStart",ct(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,setTransform:function(){},events:a}))},dragGroup:function(t,e){var n=this;this.drag(t,e);var r=Qi(t,"beforeRenderable",e),i=t.moveables,a=r.map(function(o,c){var u=i[c];return n.resetStyle(o),n.fillDragParams(u,o)});Pe(t,"onBeforeRenderGroup",ct(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,events:a}))},dragGroupEnd:function(t,e){this.dragEnd(t,e),Pe(t,"onBeforeRenderGroupEnd",ct(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets}))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)}},s3={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(t,e){Pe(t,"onRenderStart",ct(t,e,{isPinch:!!e.isPinch}))},drag:function(t,e){Pe(t,"onRender",this.fillDragParams(t,e))},dragAfter:function(t,e){return this.drag(t,e)},dragEnd:function(t,e){Pe(t,"onRenderEnd",this.fillDragEndParams(t,e))},dragGroupStart:function(t,e){Pe(t,"onRenderGroupStart",ct(t,e,{isPinch:!!e.isPinch,targets:t.props.targets}))},dragGroup:function(t,e){var n=this,r=Qi(t,"beforeRenderable",e),i=t.moveables,a=r.map(function(o,c){var u=i[c];return n.fillDragParams(u,o)});Pe(t,"onRenderGroup",ct(t,e,ee(ee({isPinch:!!e.isPinch,targets:t.props.targets,transform:Fg(e),transformObject:{}},_r($g(e))),{events:a})))},dragGroupEnd:function(t,e){var n=this,r=Qi(t,"beforeRenderable",e),i=t.moveables,a=r.map(function(o,c){var u=i[c];return n.fillDragEndParams(u,o)});Pe(t,"onRenderGroupEnd",ct(t,e,ee({isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets,events:a,transformObject:{},transform:Fg(e)},_r($g(e)))))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlAfter:function(t,e){return this.dragAfter(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)},fillDragParams:function(t,e){var n={};return ju(Zm(e)||[]).forEach(function(r){n[r.name]=r.functionValue}),ct(t,e,ee({isPinch:!!e.isPinch,transformObject:n,transform:Fg(e)},_r($g(e))))},fillDragEndParams:function(t,e){var n={};return ju(Zm(e)||[]).forEach(function(r){n[r.name]=r.functionValue}),ct(t,e,ee({isPinch:!!e.isPinch,isDrag:e.isDrag,transformObject:n,transform:Fg(e)},_r($g(e))))}};function $f(t,e,n,r,i,a,o){a.clientDistX=a.distX,a.clientDistY=a.distY;var c=i==="Start",u=i==="End",d=i==="After",h=t.state.target,p=a.isRequest,m=r.indexOf("Control")>-1;if(!h||c&&m&&!p&&t.areaElement===a.inputEvent.target)return!1;var b=Ce([],ne(e),!1);if(p){var w=a.requestAble;b.some(function(U){return U.name===w})||b.push.apply(b,Ce([],ne(t.props.ables.filter(function(U){return U.name===w})),!1))}if(!b.length||b.every(function(U){return U.dragRelation}))return!1;var E=a.inputEvent,S;u&&E&&(S=document.elementFromPoint(a.clientX,a.clientY)||E.target);var T=!1,C=function(){var U;T=!0,(U=a.stop)===null||U===void 0||U.call(a)},N=c&&(!t.targetGesto||!t.controlGesto||!t.targetGesto.isFlag()||!t.controlGesto.isFlag());N&&t.updateRect(i,!0,!1);var j=a.datas,P=m?"controlGesto":"targetGesto",M=t[P],A=function(U,O,J){if(!(O in U)||M!==t[P])return!1;var W=U.name,q=j[W]||(j[W]={});if(c&&(q.isEventStart=!J||!U[J]||U[J](t,a)),!q.isEventStart)return!1;var K=U[O](t,ee(ee({},a),{stop:C,datas:q,originalDatas:j,inputTarget:S}));return t._emitter.off(),c&&K===!1&&(q.isEventStart=!1),K};N&&b.forEach(function(U){U.unset&&U.unset(t)}),A(a3,"drag".concat(r).concat(i));var k=0,D=0;n.forEach(function(U){if(T)return!1;var O="".concat(U).concat(r).concat(i),J="".concat(U).concat(r,"Condition");i===""&&!p&&rZ(t.state,a);var W=b.filter(function(te){return te[O]});W=W.filter(function(te,se){return te.name&&W.indexOf(te)===se});var q=W.filter(function(te){return A(te,O,J)}),K=q.length;T&&++k,K&&++D,!T&&c&&W.length&&!K&&(k+=W.filter(function(te){var se=te.name,G=j[se];return G.isEventStart?te.dragRelation!=="strong":!1}).length?1:0)}),(!d||D)&&A(s3,"drag".concat(r).concat(i));var V=M!==t[P]||k===n.length;if((u||T||V)&&(t.state.gestos={},t.moveables&&t.moveables.forEach(function(U){U.state.gestos={}}),b.forEach(function(U){U.unset&&U.unset(t)})),c&&!V&&!p&&D&&t.props.preventDefault&&a?.preventDefault(),t.isUnmounted||V)return!1;if(!c&&D&&!o||u){var L=t.props.flushSync||VP;L(function(){t.updateRect(u?i:"",!0,!1),t.forceUpdate()})}return!c&&!u&&!d&&D&&!o&&$f(t,e,n,r,i+"After",a),!0}function _E(t,e){return function(n,r){var i;r===void 0&&(r=n.inputEvent.target);var a=r,o=t.areaElement,c=t._dragTarget;return!c||!e&&(!((i=t.controlGesto)===null||i===void 0)&&i.isFlag())?!1:a===c||c.contains(a)||a===o||!t.isMoveableElement(a)&&!t.controlBox.contains(a)||Un(a,"moveable-area")||Un(a,"moveable-padding")||Un(a,"moveable-edgeDraggable")}}function o3(t,e,n){var r=t.controlBox,i=[],a=t.props,o=a.dragArea,c=t.state.target,u=a.dragTarget;i.push(r),(!o||u)&&i.push(e),!o&&u&&c&&e!==c&&a.dragTargetSelf&&i.push(c);var d=_E(t);return c3(t,i,"targetAbles",n,{dragStart:d,pinchStart:d})}function l3(t,e){var n=t.controlBox,r=[];r.push(n);var i=_E(t,!0),a=function(o,c){if(c===void 0&&(c=o.inputEvent.target),c===n)return!0;var u=i(o,c);return!u};return c3(t,r,"controlAbles",e,{dragStart:a,pinchStart:a})}function c3(t,e,n,r,i){i===void 0&&(i={});var a=n==="targetAbles",o=t.props,c=o.pinchOutside,u=o.pinchThreshold,d=o.preventClickEventOnDrag,h=o.preventClickDefault,p=o.checkInput,m=o.dragFocusedInput,b=o.preventDefault,w=b===void 0?!0:b,E=o.preventRightClick,S=E===void 0?!0:E,T=o.preventWheelClick,C=T===void 0?!0:T,N=o.dragContainer,j=za(N,!0),P={preventDefault:w,preventRightClick:S,preventWheelClick:C,container:j||zo(t.getControlBoxElement()),pinchThreshold:u,pinchOutside:c,preventClickEventOnDrag:a?d:!1,preventClickEventOnDragStart:a?h:!1,preventClickEventByCondition:a?null:function(k){return t.controlBox.contains(k.target)},checkInput:a?p:!1,dragFocusedInput:m},M=new oK(e,P),A=r==="Control";return["drag","pinch"].forEach(function(k){["Start","","End"].forEach(function(D){M.on("".concat(k).concat(D),function(V){var L,U=V.eventType,O=k==="drag"&&V.isPinch;if(i[U]&&!i[U](V)){V.stop();return}if(!O){var J=k==="drag"?[k]:["drag",k],W=Ce([],ne(t[n]),!1),q=$f(t,W,J,r,D,V);q?(t.props.stopPropagation||D==="Start"&&A)&&((L=V?.inputEvent)===null||L===void 0||L.stopPropagation()):V.stop()}})})}),M}var PZ=(function(){function t(e,n,r){var i=this;this.target=e,this.moveable=n,this.eventName=r,this.ables=[],this._onEvent=function(a){var o=i.eventName,c=i.moveable;c.state.disableNativeEvent||i.ables.forEach(function(u){u[o](c,{inputEvent:a})})},e.addEventListener(r.toLowerCase(),this._onEvent)}return t.prototype.setAbles=function(e){this.ables=e},t.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},t})();function jZ(t,e,n,r){var i;n===void 0&&(n=e);var a=pP(t,e),o=a.matrixes,c=a.is3d,u=a.targetMatrix,d=a.transformOrigin,h=a.targetOrigin,p=a.offsetContainer,m=a.hasFixed,b=a.zoom,w=KK(p,n),E=w.matrixes,S=w.is3d,T=w.offsetContainer,C=w.zoom,N=r,j=4,P=t.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in t,M=u,A=Kt(j),k=Kt(j),D=Kt(j),V=Kt(j),L=o.length,U=E.map(function(se){return ee(ee({},se),{matrix:se.matrix?Ce([],ne(se.matrix),!1):void 0})}).reverse();o.reverse(),!c&&N&&(M=ra(M,3,4),z1(o)),!S&&N&&z1(U),U.forEach(function(se){k=Gt(k,se.matrix,j)});var O=n||al(t),J=((i=U[0])===null||i===void 0?void 0:i.target)||gh(O,O,!0).offsetParent,W=U.slice(1).reduce(function(se,G){return Gt(se,G.matrix,j)},Kt(j));o.forEach(function(se,G){if(L-2===G&&(D=A.slice()),L-1===G&&(V=A.slice()),!se.matrix){var F=o[G+1],Y=JQ(se,F,J,j,Gt(W,A,j));se.matrix=nc(Y,j)}A=Gt(A,se.matrix,j)});var q=!P&&c;M||(M=Kt(q?4:3));var K=sv(P&&M.length===16?ra(M,4,3):M,q),te=k;return k=Y4(k,j,j),{hasZoom:b!==1||C!==1,hasFixed:m,matrixes:o,rootMatrix:k,originalRootMatrix:te,beforeMatrix:D,offsetMatrix:V,allMatrix:A,targetMatrix:M,targetTransform:K,inlineTransform:t.style.transform,transformOrigin:d,targetOrigin:h,is3d:N,offsetContainer:p,offsetRootContainer:T}}function VZ(t,e,n,r){n===void 0&&(n=e);var i=0,a=0,o=0,c={},u=UP(t);if(t&&(i=u.offsetWidth,a=u.offsetHeight),t){var d=jZ(t,e,n,r),h=Su(d.allMatrix,d.transformOrigin,i,a);c=ee(ee({},d),h);var p=Su(d.allMatrix,[50,50],100,100);o=FP([p.pos1,p.pos2],p.direction)}var m=4;return ee(ee(ee({hasZoom:!1,width:i,height:a,rotation:o},u),{originalRootMatrix:Kt(m),rootMatrix:Kt(m),beforeMatrix:Kt(m),offsetMatrix:Kt(m),allMatrix:Kt(m),targetMatrix:Kt(m),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!0,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),c)}function F1(t,e,n,r,i,a){a===void 0&&(a=[]);var o=1,c=[0,0],u=Hg(),d=Hg(),h=Hg(),p=Hg(),m=[0,0],b={},w=VZ(e,n,i,!0);if(e){var E=Ur(e);a.forEach(function(U){b[U]=E(U)});var S=w.is3d?4:3,T=Su(w.offsetMatrix,At(w.transformOrigin,X4(w.targetMatrix,S)),w.width,w.height);o=T.direction,c=At(T.origin,[T.left-w.left,T.top-w.top]),p=Ff(w.offsetRootContainer);var C=gh(r,r,!0).offsetParent||w.offsetRootContainer;if(w.hasZoom){var N=Su(Gt(w.originalRootMatrix,w.allMatrix),w.transformOrigin,w.width,w.height),j=Su(w.originalRootMatrix,n0(Ur(C)("transformOrigin")).map(function(U){return parseFloat(U)}),C.offsetWidth,C.offsetHeight);if(u=sx(N,p),h=sx(j,p,C,!0),t){var P=N.left,M=N.top;d=sx({left:P,top:M,bottom:M,right:M},p)}}else{u=Ff(e),h=WK(C),t&&(d=Ff(t));var A=h.left,k=h.top,D=h.clientLeft,V=h.clientTop,L=[u.left-A,u.top-k];m=He(Bu(w.rootMatrix,L,4),[D+w.left,V+w.top])}}return ee({targetClientRect:u,containerClientRect:h,moveableClientRect:d,rootContainerClientRect:p,beforeDirection:o,beforeOrigin:c,originalBeforeOrigin:c,target:e,style:b,offsetDelta:m},w)}function fN(t){var e=t.pos1,n=t.pos2,r=t.pos3,i=t.pos4;if(!e||!n||!r||!i)return null;var a=rc([e,n,r,i]),o=[a.minX,a.minY],c=He(t.origin,o);return e=He(e,o),n=He(n,o),r=He(r,o),i=He(i,o),ee(ee({},t),{left:t.left,top:t.top,posDelta:o,pos1:e,pos2:n,pos3:r,pos4:i,origin:c,beforeOrigin:c,isPersisted:!0})}var Uu=(function(t){Xh(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.state=ee({container:null,gestos:{},renderLines:[[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]]],renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},F1(null)),n.renderState={},n.enabledAbles=[],n.targetAbles=[],n.controlAbles=[],n.rotation=0,n.scale=[1,1],n.isMoveableMounted=!1,n.isUnmounted=!1,n.events={mouseEnter:null,mouseLeave:null},n._emitter=new Z0,n._prevOriginalDragTarget=null,n._originalDragTarget=null,n._prevDragTarget=null,n._dragTarget=null,n._prevPropTarget=null,n._propTarget=null,n._prevDragArea=!1,n._isPropTargetChanged=!1,n._hasFirstTarget=!1,n._reiszeObserver=null,n._observerId=0,n._mutationObserver=null,n._rootContainer=null,n._viewContainer=null,n._viewClassNames=[],n._store={},n.checkUpdateRect=function(){if(!n.isDragging()){var r=n.props.parentMoveable;if(r){r.checkUpdateRect();return}ZX(n._observerId),n._observerId=w4(function(){n.isDragging()||n.updateRect()})}},n._onPreventClick=function(r){r.stopPropagation(),r.preventDefault()},n}return e.prototype.render=function(){var n=this.props,r=this.getState(),i=n.parentPosition,a=n.className,o=n.target,c=n.zoom,u=n.cspNonce,d=n.translateZ,h=n.cssStyled,p=n.groupable,m=n.linePadding,b=n.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var w=ne(i||[0,0],2),E=w[0],S=w[1],T=r.left,C=r.top,N=r.target,j=r.direction,P=r.hasFixed,M=r.offsetDelta,A=n.targets,k=this.isDragging(),D={};this.getEnabledAbles().forEach(function(W){D["data-able-".concat(W.name.toLowerCase())]=!0});var V=this._getAbleClassName(),L=A&&A.length&&(N||p)||o||!this._hasFirstTarget&&this.state.isPersisted,U=this.controlBox||this.props.firstRenderState||this.props.persistData,O=[T-E,C-S];!p&&n.useAccuratePosition&&(O[0]+=M[0],O[1]+=M[1]);var J={position:P?"fixed":"absolute",display:L?"block":"none",visibility:U?"visible":"hidden",transform:"translate3d(".concat(O[0],"px, ").concat(O[1],"px, ").concat(d,")"),"--zoom":c,"--zoompx":"".concat(c,"px")};return m&&(J["--moveable-line-padding"]=m),b&&(J["--moveable-control-padding"]=b),Ki(h,ee({cspNonce:u,ref:Es(this,"controlBox"),className:"".concat(Fe("control-box",j===-1?"reverse":"",k?"dragging":"")," ").concat(V," ").concat(a)},D,{onClick:this._onPreventClick,style:J}),this.renderAbles(),this._renderLines())},e.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var n=this.props,r=n.parentMoveable,i=n.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!r&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},e.prototype.componentDidUpdate=function(n){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(n)},e.prototype.componentWillUnmount=function(){var n,r;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(n=this._reiszeObserver)===null||n===void 0||n.disconnect(),(r=this._mutationObserver)===null||r===void 0||r.disconnect();var i=this._viewContainer;i&&this._changeAbleViewClassNames([]),gu(this,!1),gu(this,!0);var a=this.events;for(var o in a){var c=a[o];c&&c.destroy()}},e.prototype.getTargets=function(){var n=this.props.target;return n?[n]:[]},e.prototype.getAble=function(n){var r=this.props.ables||[];return Br(r,function(i){return i.name===n})},e.prototype.getContainer=function(){var n=this.props,r=n.parentMoveable,i=n.wrapperMoveable,a=n.container;return a||i&&i.getContainer()||r&&r.getContainer()||this.controlBox.parentElement},e.prototype.getControlBoxElement=function(){return this.controlBox},e.prototype.getDragElement=function(){return this._dragTarget},e.prototype.isMoveableElement=function(n){var r;return n&&(((r=n.getAttribute)===null||r===void 0?void 0:r.call(n,"class"))||"").indexOf(rE)>-1},e.prototype.dragStart=function(n,r){r===void 0&&(r=n.target);var i=this.targetGesto,a=this.controlGesto;return i&&_E(this)({inputEvent:n},r)?i.isFlag()||i.triggerDragStart(n):a&&this.isMoveableElement(r)&&(a.isFlag()||a.triggerDragStart(n)),this},e.prototype.hitTest=function(n){var r=this.state,i=r.target,a=r.pos1,o=r.pos2,c=r.pos3,u=r.pos4,d=r.targetClientRect;if(!i)return 0;var h;if(sd(n)){var p=n.getBoundingClientRect();h={left:p.left,top:p.top,width:p.width,height:p.height}}else h=ee({width:0,height:0},n);var m=h.left,b=h.top,w=h.width,E=h.height,S=PR([a,o,u,c],d),T=tK(S,[[m,b],[m+w,b],[m+w,b+E],[m,b+E]]),C=Z4(S);return!T||!C?0:Math.min(100,T/C*100)},e.prototype.isInside=function(n,r){var i=this.state,a=i.target,o=i.pos1,c=i.pos2,u=i.pos3,d=i.pos4,h=i.targetClientRect;return a?T1([n,r],PR([o,c,d,u],h)):!1},e.prototype.updateRect=function(n,r,i){i===void 0&&(i=!0);var a=this.props,o=!a.parentPosition&&!a.wrapperMoveable;o&&zu(!0);var c=a.parentMoveable,u=this.state,d=u.target||a.target,h=this.getContainer(),p=c?c._rootContainer:this._rootContainer,m=F1(this.controlBox,d,h,h,p||h,this._getRequestStyles());if(!d&&this._hasFirstTarget&&a.persistData){var b=fN(a.persistData);for(var w in b)m[w]=b[w]}o&&zu(),this.updateState(m,c?!1:i)},e.prototype.isDragging=function(n){var r,i,a=this.targetGesto,o=this.controlGesto;if(a?.isFlag()){if(!n)return!0;var c=a.getEventData();return!!(!((r=c[n])===null||r===void 0)&&r.isEventStart)}if(o?.isFlag()){if(!n)return!0;var c=o.getEventData();return!!(!((i=c[n])===null||i===void 0)&&i.isEventStart)}return!1},e.prototype.updateTarget=function(n){this.updateRect(n,!0)},e.prototype.getRect=function(){var n=this.state,r=Di(this.state),i=ne(r,4),a=i[0],o=i[1],c=i[2],u=i[3],d=ki(r),h=n.width,p=n.height,m=d.width,b=d.height,w=d.left,E=d.top,S=[n.left,n.top],T=At(S,n.origin),C=At(S,n.beforeOrigin),N=n.transformOrigin;return{width:m,height:b,left:w,top:E,pos1:a,pos2:o,pos3:c,pos4:u,offsetWidth:h,offsetHeight:p,beforeOrigin:C,origin:T,transformOrigin:N,rotation:this.getRotation()}},e.prototype.getManager=function(){return this},e.prototype.stopDrag=function(n){if(!n||n==="target"){var r=this.targetGesto;r?.isIdle()===!1&&L1(this,!1),r?.stop()}if(!n||n==="control"){var r=this.controlGesto;r?.isIdle()===!1&&L1(this,!0),r?.stop()}},e.prototype.getRotation=function(){var n=this.state,r=n.pos1,i=n.pos2,a=n.direction;return sZ(r,i,a)},e.prototype.request=function(n,r,i){r===void 0&&(r={});var a=this,o=a.props,c=o.parentMoveable||o.wrapperMoveable||a,u=c.props.ables,d=o.groupable,h=Br(u,function(T){return T.name===n});if(this.isDragging()||!h||!h.request)return{request:function(){return this},requestEnd:function(){return this}};var p=h.request(a),m=i||r.isInstant,b=p.isControl?"controlAbles":"targetAbles",w="".concat(d?"Group":"").concat(p.isControl?"Control":""),E=Ce([],ne(c[b]),!1),S={request:function(T){return $f(a,E,["drag"],w,"",ee(ee({},p.request(T)),{requestAble:n,isRequest:!0}),m),S},requestEnd:function(){return $f(a,E,["drag"],w,"End",ee(ee({},p.requestEnd()),{requestAble:n,isRequest:!0}),m),S}};return $f(a,E,["drag"],w,"Start",ee(ee({},p.requestStart(r)),{requestAble:n,isRequest:!0}),m),m?S.request(r).requestEnd():S},e.prototype.getMoveables=function(){return[this]},e.prototype.destroy=function(){this.componentWillUnmount()},e.prototype.updateRenderPoses=function(){var n=this.getState(),r=this.props,i=r.padding,a=n.originalBeforeOrigin,o=n.transformOrigin,c=n.allMatrix,u=n.is3d,d=n.pos1,h=n.pos2,p=n.pos3,m=n.pos4,b=n.left,w=n.top,E=n.isPersisted,S=r.zoom||1;if(!i&&S<=1){n.renderPoses=[d,h,p,m],n.renderLines=[[d,h],[h,m],[m,p],[p,d]];return}var T=ZP(i||{}),C=T.left,N=T.top,j=T.bottom,P=T.right,M=u?4:3,A=[];E?A=o:this.controlBox&&r.groupable?A=a:A=At(a,[b,w]);var k=Km(M,nc(A.map(function(J){return-J}),M),c,nc(o,M)),D=xi(k,d,[-C,-N],M),V=xi(k,h,[P,-N],M),L=xi(k,p,[-C,j],M),U=xi(k,m,[P,j],M);n.renderPoses=[D,V,L,U],n.renderLines=[[D,V],[V,U],[U,L],[L,D]];{var O=S/2;n.renderLines=[[xi(k,d,[-C-O,-N],M),xi(k,h,[P+O,-N],M)],[xi(k,h,[P,-N-O],M),xi(k,m,[P,j+O],M)],[xi(k,m,[P+O,j],M),xi(k,p,[-C-O,j],M)],[xi(k,p,[-C,j+O],M),xi(k,d,[-C,-N-O],M)]]}},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var n=this.props,r=n.target,i=n.container,a=n.parentMoveable,o=this.state,c=o.target,u=o.container;if(!(!c&&!r)){this.updateAbles();var d=!B1(c,r),h=d||!B1(u,i);if(h){var p=i||this.controlBox;p&&this.unsetAbles(),this.updateState({target:r,container:i}),!a&&p&&this.updateRect("End",!1,!1),this._isPropTargetChanged=d}}},e.prototype.waitToChangeTarget=function(){return new Promise(function(){})},e.prototype.triggerEvent=function(n,r){var i=this.props;if(this._emitter.trigger(n,r),i.parentMoveable&&r.isRequest&&!r.isRequestChild)return i.parentMoveable.triggerEvent(n,r,!0);var a=i[n];return a&&a(r)},e.prototype.useCSS=function(n,r){var i=this.props.customStyledMap,a=n+r;return i[a]||(i[a]=tP(n,r)),i[a]},e.prototype.getState=function(){var n,r=this.props;(r.target||!((n=r.targets)===null||n===void 0)&&n.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,a=r.persistData,o=r.firstRenderState;if(o&&!i)return o;if(!this._hasFirstTarget&&a){var c=fN(a);if(c)return this.updateState(c,!1),this.state}return this.state.isPersisted=!1,this.state},e.prototype.updateSelectors=function(){},e.prototype.unsetAbles=function(){var n=this;this.targetAbles.forEach(function(r){r.unset&&r.unset(n)})},e.prototype.updateAbles=function(n,r){n===void 0&&(n=this.props.ables),r===void 0&&(r="");var i=this.props,a=i.triggerAblesSimultaneously,o=this.getEnabledAbles(n),c="drag".concat(r,"Start"),u="pinch".concat(r,"Start"),d="drag".concat(r,"ControlStart"),h=qg(o,[c,u],a),p=qg(o,[d],a);this.enabledAbles=o,this.targetAbles=h,this.controlAbles=p},e.prototype.updateState=function(n,r){if(r){if(this.isUnmounted)return;this.setState(n)}else{var i=this.state;for(var a in n)i[a]=n[a]}},e.prototype.getEnabledAbles=function(n){n===void 0&&(n=this.props.ables);var r=this.props;return n.filter(function(i){return i&&(i.always&&r[i.name]!==!1||r[i.name])})},e.prototype.renderAbles=function(){var n=this,r=this.props,i=r.triggerAblesSimultaneously,a={createElement:Ki};return this.renderState={},nZ(XP(qg(this.getEnabledAbles(),["render"],i).map(function(o){var c=o.render;return c(n,a)||[]})).filter(function(o){return o}),function(o){var c=o.key;return c}).map(function(o){return o[0]})},e.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},e.prototype._getRequestStyles=function(){var n=this.getEnabledAbles().reduce(function(r,i){var a,o,c=(o=(a=i.requestStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return Ce(Ce([],ne(r),!1),ne(c),!1)},Ce([],ne(this.props.requestStyles||[]),!1));return n},e.prototype._updateObserver=function(n){this._updateResizeObserver(n),this._updateMutationObserver(n)},e.prototype._updateEvents=function(){var n=this.targetAbles.length,r=this.controlAbles.length,i=this._dragTarget,a=!n&&this.targetGesto||this._isTargetChanged(!0);a&&(gu(this,!1),this.updateState({gestos:{}})),r||gu(this,!0),i&&n&&!this.targetGesto&&(this.targetGesto=o3(this,i,"")),!this.controlGesto&&r&&(this.controlGesto=l3(this,"Control"))},e.prototype._updateTargets=function(){var n=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=n.dragArea,this._propTarget=n.target,this._originalDragTarget=n.dragTarget||n.target,this._dragTarget=za(this._originalDragTarget,!0)},e.prototype._renderLines=function(){var n=this.props,r=n,i=r.zoom,a=r.hideDefaultLines,o=r.hideChildMoveableDefaultLines,c=r.parentMoveable;if(a||c&&o)return[];var u=this.getState(),d={createElement:Ki};return u.renderLines.map(function(h,p){return ph(d,"",h[0],h[1],i,"render-line-".concat(p))})},e.prototype._isTargetChanged=function(n){var r=this.props,i=r.dragTarget||r.target,a=this._prevOriginalDragTarget,o=this._prevDragArea,c=r.dragArea,u=!c&&a!==i,d=(n||c)&&o!==c;return u||d||this._prevPropTarget!=this._propTarget},e.prototype._updateNativeEvents=function(){var n=this,r=this.props,i=r.dragArea?this.areaElement:this.state.target,a=this.events,o=Ps(a);if(this._isTargetChanged())for(var c in a){var u=a[c];u&&u.destroy(),a[c]=null}if(i){var d=this.enabledAbles;o.forEach(function(h){var p=qg(d,[h]),m=p.length>0,b=a[h];if(!m){b&&(b.destroy(),a[h]=null);return}b||(b=new PZ(i,n,h),a[h]=b),b.setAbles(p)})}},e.prototype._checkUpdateRootContainer=function(){var n=this.props.rootContainer;!this._rootContainer&&n&&(this._rootContainer=za(n,!0))},e.prototype._checkUpdateViewContainer=function(){var n=this.props.viewContainer;!this._viewContainer&&n&&(this._viewContainer=za(n,!0));var r=this._viewContainer;r&&this._changeAbleViewClassNames(Ce(Ce([],ne(this._getAbleViewClassNames()),!1),[this.isDragging()?hZ:""],!1))},e.prototype._changeAbleViewClassNames=function(n){var r=this._viewContainer,i=YP(n.filter(Boolean),function(d){return d}).map(function(d){var h=ne(d,1),p=h[0];return p}),a=this._viewClassNames,o=$h(a,i),c=o.removed,u=o.added;c.forEach(function(d){A4(r,a[d])}),u.forEach(function(d){T4(r,i[d])}),this._viewClassNames=i},e.prototype._getAbleViewClassNames=function(){var n=this;return(this.getEnabledAbles().map(function(r){var i;return((i=r.viewClassName)===null||i===void 0?void 0:i.call(r,n))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},e.prototype._getAbleClassName=function(n){var r=this;n===void 0&&(n="");var i=this.getEnabledAbles(),a=this.targetGesto,o=this.controlGesto,c=a?.isFlag()?a.getEventData():{},u=o?.isFlag()?o.getEventData():{};return i.map(function(d){var h,p,m,b=d.name,w=((h=d.className)===null||h===void 0?void 0:h.call(d,r))||"";return(!((p=c[b])===null||p===void 0)&&p.isEventStart||!((m=u[b])===null||m===void 0)&&m.isEventStart)&&(w+=" ".concat(Fe("".concat(b).concat(n,"-dragging")))),w.trim()}).filter(Boolean).join(" ")},e.prototype._updateResizeObserver=function(n){var r,i=this.props,a=i.target,o=zo(this.getControlBoxElement());if(!o.ResizeObserver||!a||!i.useResizeObserver){(r=this._reiszeObserver)===null||r===void 0||r.disconnect();return}if(!(n.target===a&&this._reiszeObserver)){var c=new o.ResizeObserver(this.checkUpdateRect);c.observe(a,{box:"border-box"}),this._reiszeObserver=c}},e.prototype._updateMutationObserver=function(n){var r=this,i,a=this.props,o=a.target,c=zo(this.getControlBoxElement());if(!c.MutationObserver||!o||!a.useMutationObserver){(i=this._mutationObserver)===null||i===void 0||i.disconnect();return}if(!(n.target===o&&this._mutationObserver)){var u=new c.MutationObserver(function(d){var h,p;try{for(var m=yK(d),b=m.next();!b.done;b=m.next()){var w=b.value;w.type==="attributes"&&w.attributeName==="style"&&r.checkUpdateRect()}}catch(E){h={error:E}}finally{try{b&&!b.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}});u.observe(o,{attributes:!0}),this._mutationObserver=u}},e.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:VP,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},e})(M4),EE={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(t,e){var n,r=t.props,i=r.targets||[],a=t.getState(),o=a.left,c=a.top,u=a.isPersisted,d=r.zoom||1,h=t.renderGroupRects,p=((n=r.persistData)===null||n===void 0?void 0:n.children)||[];u?i=p.map(function(){return null}):p=[];var m=mu(t,"parentPosition",[o,c],function(w){return w.join(",")}),b=mu(t,"requestStyles",t.getRequestChildStyles(),function(w){return w.join(",")});return t.moveables=t.moveables.slice(0,i.length),Ce(Ce([],ne(i.map(function(w,E){return e.createElement(Uu,{key:"moveable"+E,ref:v4(t,"moveables",E),target:w,origin:!1,requestStyles:b,cssStyled:r.cssStyled,customStyledMap:r.customStyledMap,useResizeObserver:r.useResizeObserver,useMutationObserver:r.useMutationObserver,hideChildMoveableDefaultLines:r.hideChildMoveableDefaultLines,parentMoveable:t,parentPosition:[o,c],persistData:p[E],zoom:d})})),!1),ne(XP(h.map(function(w,E){var S=w.pos1,T=w.pos2,C=w.pos3,N=w.pos4,j=[S,T,C,N];return[[0,1],[1,3],[3,2],[2,0]].map(function(P,M){var A=ne(P,2),k=A[0],D=A[1];return ph(e,"",He(j[k],m),He(j[D],m),d,"group-rect-".concat(E,"-").concat(M))})}))),!1)}},zZ=Wh("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(t,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(t,e){var n=t.props.target,r=e.inputEvent,i=e.inputTarget,a=t.isMoveableElement(i),o=!a&&t.controlBox.contains(i);if(!(!r||!i||e.isDrag||t.isMoveableElement(i)||o)){var c=n.contains(i);Pe(t,"onClick",ct(t,e,{isDouble:e.isDouble,inputTarget:i,isTarget:n===i,moveableTarget:t.props.target,containsTarget:c}))}},dragGroupEnd:function(t,e){var n=e.inputEvent,r=e.inputTarget;if(!(!n||!r||e.isDrag||t.isMoveableElement(r)||e.datas.inputTarget===r)){var i=t.props.targets,a=i.indexOf(r),o=a>-1,c=!1;a===-1&&(a=Os(i,function(u){return u.contains(r)}),c=a>-1),Pe(t,"onClickGroup",ct(t,e,{isDouble:e.isDouble,targets:i,inputTarget:r,targetIndex:a,isTarget:o,containsTarget:c,moveableTarget:i[a]}))}},dragControlEnd:function(t,e){this.dragEnd(t,e)},dragGroupControlEnd:function(t,e){this.dragEnd(t,e)}});function Jc(t){var e=t.originalDatas.draggable;return e||(t.originalDatas.draggable={},e=t.originalDatas.draggable),ee(ee({},t),{datas:e})}var LZ=Wh("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(t,e){var n=t.props,r=n.edgeDraggable;return r?vP(e,"edgeDraggable",r,t.getState().renderPoses,n.zoom):[]},dragCondition:function(t,e){var n,r=t.props,i=(n=e.inputEvent)===null||n===void 0?void 0:n.target;return!r.edgeDraggable||!i?!1:!r.draggable&&Un(i,Fe("direction"))&&Un(i,Fe("edge"))&&Un(i,Fe("edgeDraggable"))},dragStart:function(t,e){return br.dragStart(t,Jc(e))},drag:function(t,e){return br.drag(t,Jc(e))},dragEnd:function(t,e){return br.dragEnd(t,Jc(e))},dragGroupCondition:function(t,e){var n,r=t.props,i=(n=e.inputEvent)===null||n===void 0?void 0:n.target;return!r.edgeDraggable||!i?!1:!r.draggable&&Un(i,Fe("direction"))&&Un(i,Fe("line"))},dragGroupStart:function(t,e){return br.dragGroupStart(t,Jc(e))},dragGroup:function(t,e){return br.dragGroup(t,Jc(e))},dragGroupEnd:function(t,e){return br.dragGroupEnd(t,Jc(e))},unset:function(t){return br.unset(t)}}),u3={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},SE=[a3,t3,$Q,lZ,br,LZ,P1,cZ,dZ,TQ,mZ,vZ,pZ,RZ,kZ,MZ,EE,u3,zZ,e3,s3],BZ=SE.reduce(function(t,e){return(e.events||[]).forEach(function(n){S4(t,n)}),t},[]),UZ=SE.reduce(function(t,e){return(e.props||[]).forEach(function(n){S4(t,n)}),t},[]);function hN(t,e){var n=ne(t,3),r=n[0],i=n[1],a=n[2];return(r*e[0]+i*e[1]+a)/Math.sqrt(r*r+i*i)}function Wg(t,e){var n=ne(t,2),r=n[0],i=n[1];return-r*e[0]-i*e[1]}function pN(t,e){return Math.max.apply(Math,Ce([],ne(t.map(function(n){var r=ne(n,4),i=r[0],a=r[1],o=r[2],c=r[3];return Math.max(i[e],a[e],o[e],c[e])})),!1))}function gN(t,e){return Math.min.apply(Math,Ce([],ne(t.map(function(n){var r=ne(n,4),i=r[0],a=r[1],o=r[2],c=r[3];return Math.min(i[e],a[e],o[e],c[e])})),!1))}function FZ(t,e){var n,r,i,a=[0,0],o=[0,0],c=[0,0],u=[0,0],d=0,h=0;if(!t.length)return{pos1:a,pos2:o,pos3:c,pos4:u,minX:0,minY:0,maxX:0,maxY:0,width:d,height:h,rotation:e};var p=rt(e,Tr);if(p%90){var m=p/180*Math.PI,b=Math.tan(m),w=-1/b,E=[D1,zR],S=[[0,0],[0,0]],T=[D1,zR],C=[[0,0],[0,0]];t.forEach(function(Q){Q.forEach(function(X){var ie=hN([-b,1,0],X),le=hN([-w,1,0],X);E[0]>ie&&(S[0]=X,E[0]=ie),E[1]<ie&&(S[1]=X,E[1]=ie),T[0]>le&&(C[0]=X,T[0]=le),T[1]<le&&(C[1]=X,T[1]=le)})});var N=ne(S,2),j=N[0],P=N[1],M=ne(C,2),A=M[0],k=M[1],D=[-b,1,Wg([-b,1],j)],V=[-b,1,Wg([-b,1],P)],L=[-w,1,Wg([-w,1],A)],U=[-w,1,Wg([-w,1],k)];n=ne([[D,L],[D,U],[V,L],[V,U]].map(function(Q){var X=ne(Q,2),ie=X[0],le=X[1];return tE(ie,le)[0]}),4),a=n[0],o=n[1],c=n[2],u=n[3],d=T[1]-T[0],h=E[1]-E[0]}else{var O=gN(t,0),J=gN(t,1),W=pN(t,0),q=pN(t,1);if(a=[O,J],o=[W,J],c=[O,q],u=[W,q],d=W-O,h=q-J,p%180){var K=[c,a,u,o];r=ne(K,4),a=r[0],o=r[1],c=r[2],u=r[3],d=q-J,h=W-O}}if(p%360>180){var K=[u,c,o,a];i=ne(K,4),a=i[0],o=i[1],c=i[2],u=i[3]}var te=rc([a,o,c,u]),se=te.minX,G=te.minY,F=te.maxX,Y=te.maxY;return{pos1:a,pos2:o,pos3:c,pos4:u,width:d,height:h,minX:se,minY:G,maxX:F,maxY:Y,rotation:e}}function d3(t,e){var n=e.map(function(r){if(Vn(r)){var i=d3(t,r),a=i.length;return a>1?i:a===1?i[0]:null}else{var o=Br(t,function(c){var u=c.manager;return u.props.target===r});return o?(o.finded=!0,o.manager):null}}).filter(Boolean);return n.length===1&&Vn(n[0])?n[0]:n}var $Z=(function(t){Xh(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.differ=new Q4,n.moveables=[],n.transformOrigin="50% 50%",n.renderGroupRects=[],n._targetGroups=[],n._hasFirstTargets=!1,n}return e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this)},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(n,r,i){var a;i===void 0&&(i=!0);var o=this.state;if(!this.controlBox||o.isPersisted)return;zu(!0),this.moveables.forEach(function(pe){pe.updateRect(n,!1,!1)});var c=this.props,u=this.moveables,d=o.target||c.target,h=u.map(function(pe){return{finded:!1,manager:pe}}),p=this.props.targetGroups||[],m=d3(h,p),b=c.useDefaultGroupRotate;m.push.apply(m,Ce([],ne(h.filter(function(pe){var _e=pe.finded;return!_e}).map(function(pe){var _e=pe.manager;return _e})),!1));var w=[],E=!r||n!==""&&c.updateGroup,S=c.defaultGroupRotate||0;if(!this._hasFirstTargets){var T=(a=c.persistData)===null||a===void 0?void 0:a.rotation;T!=null&&(S=T)}function C(pe,_e,Ie){var ae=pe.map(function(Le){if(Vn(Le)){var Me=C(Le,_e),Be=[Me.pos1,Me.pos2,Me.pos3,Me.pos4];return w.push(Me),{poses:Be,rotation:Me.rotation}}else return{poses:Di(Le.state),rotation:Le.getRotation()}}),Ae=ae.map(function(Le){var Me=Le.rotation;return Me}),Re=0,De=Ae[0],Ve=Ae.every(function(Le){return Math.abs(De-Le)<.1});E?Re=!b&&Ve?De:S:Re=!b&&!Ie&&Ve?De:_e;var ze=ae.map(function(Le){var Me=Le.poses;return Me}),Se=FZ(ze,Re);return Se}var N=C(m,this.rotation,!0);E&&(this.rotation=N.rotation,this.transformOrigin=c.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=p,this.renderGroupRects=w;var j=this.transformOrigin,P=this.rotation,M=this.scale,A=N.width,k=N.height,D=N.minX,V=N.minY,L=oZ([[0,0],[A,0],[0,k],[A,k]],bE(j,A,k),this.rotation/180*Math.PI),U=rc(L.result),O=U.minX,J=U.minY,W=" rotate(".concat(P,"deg)")+" scale(".concat(xr(M[0]),", ").concat(xr(M[1]),")"),q="translate(".concat(-O,"px, ").concat(-J,"px)").concat(W);this.controlBox.style.transform="translate3d(".concat(D,"px, ").concat(V,"px, ").concat(this.props.translateZ||0,")"),d.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(j,";")+"width:".concat(A,"px;height:").concat(k,"px;")+"transform: ".concat(q),o.width=A,o.height=k;var K=this.getContainer(),te=F1(this.controlBox,d,this.controlBox,this.getContainer(),this._rootContainer||K,[]),se=[te.left,te.top],G=ne(Di(te),4),F=G[0],Y=G[1],Q=G[2],X=G[3],ie=rc([F,Y,Q,X]),le=[ie.minX,ie.minY],ge=xr(M[0]*M[1]);te.pos1=He(F,le),te.pos2=He(Y,le),te.pos3=He(Q,le),te.pos4=He(X,le),te.left=D-te.left+le[0],te.top=V-te.top+le[1],te.origin=He(At(se,te.origin),le),te.beforeOrigin=He(At(se,te.beforeOrigin),le),te.originalBeforeOrigin=At(se,te.originalBeforeOrigin),te.transformOrigin=He(At(se,te.transformOrigin),le),d.style.transform="translate(".concat(-O-le[0],"px, ").concat(-J-le[1],"px)")+W,zu(),this.updateState(ee(ee({},te),{posDelta:le,direction:ge,beforeDirection:ge}),i)},e.prototype.getRect=function(){return ee(ee({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(n){return n.getRect()})})},e.prototype.triggerEvent=function(n,r,i){if(i||n.indexOf("Group")>-1)return t.prototype.triggerEvent.call(this,n,r);this._emitter.trigger(n,r)},e.prototype.getRequestChildStyles=function(){var n=this.getEnabledAbles().reduce(function(r,i){var a,o,c=(o=(a=i.requestChildStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return Ce(Ce([],ne(r),!1),ne(c),!1)},[]);return n},e.prototype.getMoveables=function(){return Ce([],ne(this.moveables),!1)},e.prototype.updateAbles=function(){t.prototype.updateAbles.call(this,Ce(Ce([],ne(this.props.ables),!1),[EE],!1),"Group")},e.prototype._updateTargets=function(){t.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=za(this._originalDragTarget,!0)},e.prototype._updateEvents=function(){var n=this.state,r=this.props,i=this._prevDragTarget,a=r.dragTarget||this.areaElement,o=r.targets,c=this.differ.update(o),u=c.added,d=c.changed,h=c.removed,p=u.length||h.length;(p||this._prevOriginalDragTarget!==this._originalDragTarget)&&(gu(this,!1),gu(this,!0),this.updateState({gestos:{}})),i!==a&&(n.target=null),n.target||(n.target=this.areaElement,this.controlBox.style.display="block"),n.target&&(this.targetGesto||(this.targetGesto=o3(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=l3(this,"GroupControl")));var m=!B1(n.container,r.container);m&&(n.container=r.container),(m||p||this.transformOrigin!==(r.defaultGroupOrigin||"50% 50%")||d.length||o.length&&!QP(this._targetGroups,r.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!p},e.prototype._updateObserver=function(){},e.defaultProps=ee(ee({},Uu.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e})(Uu),GZ=(function(t){Xh(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.moveables=[],n}return e.prototype.render=function(){var n=this,r,i=this.props,a=i.cspNonce,o=i.cssStyled,c=i.persistData,u=i.targets||[],d=u.length,h=this.isUnmounted||!d,p=(r=c?.children)!==null&&r!==void 0?r:[];return h&&!d&&p.length?u=p.map(function(){return null}):h||(p=[]),Ki(o,{cspNonce:a,ref:Es(this,"controlBox"),className:Fe("control-box")},u.map(function(m,b){var w,E,S=(E=(w=i.individualGroupableProps)===null||w===void 0?void 0:w.call(i,m,b))!==null&&E!==void 0?E:{};return Ki(Uu,ee({key:"moveable"+b,ref:v4(n,"moveables",b)},i,S,{target:m,wrapperMoveable:n,isWrapperMounted:n.isMoveableMounted,persistData:p[b]}))}))},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(n,r,i){i===void 0&&(i=!0),zu(!0),this.moveables.forEach(function(a){a.updateRect(n,r,i)}),zu()},e.prototype.getRect=function(){return ee(ee({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(n){return n.getRect()})})},e.prototype.request=function(n,r,i){r===void 0&&(r={});var a=this.moveables.map(function(u){return u.request(n,ee(ee({},r),{isInstant:!1}),!1)}),o=i||r.isInstant,c={request:function(u){return a.forEach(function(d){return d.request(u)}),this},requestEnd:function(){return a.forEach(function(u){return u.requestEnd()}),this}};return o?c.request(r).requestEnd():c},e.prototype.dragStart=function(n,r){r===void 0&&(r=n.target);var i=r,a=Br(this.moveables,function(o){var c=o.getTargets()[0],u=o.getControlBoxElement(),d=o.getDragElement();return!c||!d?!1:d===i||d.contains(i)||d!==c&&c===i||c.contains(i)||u===i||u.contains(i)});return a&&a.dragStart(n,r),this},e.prototype.hitTest=function(){return 0},e.prototype.isInside=function(){return!1},e.prototype.isDragging=function(){return!1},e.prototype.getDragElement=function(){return null},e.prototype.getMoveables=function(){return Ce([],ne(this.moveables),!1)},e.prototype.updateRenderPoses=function(){},e.prototype.checkUpdate=function(){},e.prototype.triggerEvent=function(){},e.prototype.updateAbles=function(){},e.prototype._updateEvents=function(){},e.prototype._updateObserver=function(){},e})(Uu);function f3(t,e){var n=[];return t.forEach(function(r){if(r){if(Lr(r)){e[r]&&n.push.apply(n,Ce([],ne(e[r]),!1));return}Vn(r)?n.push.apply(n,Ce([],ne(f3(r,e)),!1)):n.push(r)}}),n}function h3(t,e){var n=[];return t.forEach(function(r){if(r){if(Lr(r)){e[r]&&n.push.apply(n,Ce([],ne(e[r]),!1));return}Vn(r)?n.push(h3(r,e)):n.push(r)}}),n}function p3(t,e){return t.length!==e.length||t.some(function(n,r){var i=e[r];return!n&&!i?!1:n!=i?Vn(n)&&Vn(i)?p3(n,i):!0:!1})}var HZ=(function(t){Xh(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.refTargets=[],n.selectorMap={},n._differ=new Q4,n._elementTargets=[],n._tmpRefTargets=[],n._tmpSelectorMap={},n._onChangeTargets=null,n}return e.makeStyled=function(){var n={},r=this.getTotalAbles();r.forEach(function(a){var o=a.css;o&&o.forEach(function(c){n[c]=!0})});var i=Ps(n).join(`
`);this.defaultStyled=tP("div",BX(rE,RK+i))},e.getTotalAbles=function(){return Ce([t3,EE,u3,e3],ne(this.defaultAbles),!1)},e.prototype.render=function(){var n,r=this.constructor;r.defaultStyled||r.makeStyled();var i=this.props,a=i.ables,o=i.props,c=mK(i,["ables","props"]),u=ne(this._updateRefs(!0),2),d=u[0],h=u[1],p=f3(d,h),m=p.length>1,b=r.getTotalAbles(),w=Ce(Ce([],ne(b),!1),ne(a||[]),!1),E=ee(ee(ee({},c),o||{}),{ables:w,cssStyled:r.defaultStyled,customStyledMap:r.customStyledMap});this._elementTargets=p;var S=null,T=this.moveable,C=c.persistData;if(C?.children&&(m=!0),c.individualGroupable)return Ki(GZ,ee({key:"individual-group",ref:Es(this,"moveable")},E,{target:null,targets:p}));if(m){var N=h3(d,h);if(T&&!T.props.groupable&&!T.props.individualGroupable){var j=T.props.target;j&&p.indexOf(j)>-1&&(S=ee({},T.state))}return Ki($Z,ee({key:"group",ref:Es(this,"moveable")},E,(n=c.groupableProps)!==null&&n!==void 0?n:{},{target:null,targets:p,targetGroups:N,firstRenderState:S}))}else{var P=p[0];if(T&&(T.props.groupable||T.props.individualGroupable)){var M=T.moveables||[],A=Br(M,function(k){return k.props.target===P});A&&(S=ee({},A.state))}return Ki(Uu,ee({key:"single",ref:Es(this,"moveable")},E,{target:P,firstRenderState:S}))}},e.prototype.componentDidMount=function(){this._checkChangeTargets()},e.prototype.componentDidUpdate=function(){this._checkChangeTargets()},e.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},e.prototype.getTargets=function(){var n,r;return(r=(n=this.moveable)===null||n===void 0?void 0:n.getTargets())!==null&&r!==void 0?r:[]},e.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs(),this.forceUpdate()},e.prototype.waitToChangeTarget=function(){var n=this,r;return this._onChangeTargets=function(){n._onChangeTargets=null,r()},new Promise(function(i){r=i})},e.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},e.prototype.getManager=function(){return this.moveable},e.prototype.getMoveables=function(){return this.moveable.getMoveables()},e.prototype.getDragElement=function(){return this.moveable.getDragElement()},e.prototype._updateRefs=function(n){var r=this.refTargets,i=yE(this.props.target||this.props.targets),a=typeof document<"u",o=p3(r,i),c=this.selectorMap,u={};return this.refTargets.forEach(function d(h){if(Lr(h)){var p=c[h];p?u[h]=c[h]:a&&(o=!0,u[h]=[].slice.call(document.querySelectorAll(h)))}else Vn(h)&&h.forEach(d)}),this._tmpRefTargets=i,this._tmpSelectorMap=u,[i,u,!n&&o]},e.prototype._checkChangeTargets=function(){var n,r,i;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var a=this._differ.update(this._elementTargets),o=a.added,c=a.removed,u=o.length||c.length;u&&((r=(n=this.props).onChangeTargets)===null||r===void 0||r.call(n,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this));var d=ne(this._updateRefs(),3),h=d[0],p=d[1],m=d[2];this.refTargets=h,this.selectorMap=p,m&&this.forceUpdate()},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,vK([UX(oP)],e.prototype,"moveable",void 0),e})(M4),qZ=(function(t){Xh(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.defaultAbles=SE,e})(HZ),$1=function(t,e){return $1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},$1(t,e)};function TE(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");$1(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var mh=function(){return mh=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},mh.apply(this,arguments)};function YZ(t,e,n,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}var XZ=(function(t){TE(e,t);function e(r){var i=t.call(this,r)||this;return i.state={},i.state=i.props,i}var n=e.prototype;return n.render=function(){return Ki(qZ,mh({ref:Es(this,"moveable")},this.state))},e})(W_),WZ=UZ,KZ=oP,QZ=BZ,ZZ=(function(t){TE(e,t);function e(r,i){i===void 0&&(i={});var a=t.call(this)||this;a.containerProvider=null,a.selfElement=null,a._warp=!1;var o=mh({},i),c={};QZ.forEach(function(h){c[QX("on ".concat(h))]=function(p){return a.trigger(h,p)}});var u;i.warpSelf?(delete i.warpSelf,a._warp=!0,u=r):(u=ad(r).createElement("div"),r.appendChild(u)),a.containerProvider=IR(Ki(XZ,mh({ref:Es(a,"innerMoveable")},o,c)),u),a.selfElement=u;var d=o.target;return Vn(d)&&d.length>1&&a.updateRect(),a}var n=e.prototype;return n.setState=function(r,i){this.innerMoveable.setState(r,i)},n.forceUpdate=function(r){this.innerMoveable.forceUpdate(r)},n.dragStart=function(r,i){i===void 0&&(i=r.target);var a=this.innerMoveable;a.$_timer&&this.forceUpdate(),this.getMoveable().dragStart(r,i)},n.destroy=function(){var r,i=this.selfElement;IR(null,i,this.containerProvider),this._warp||(r=i?.parentElement)===null||r===void 0||r.removeChild(i),this.containerProvider=null,this.off(),this.selfElement=null,this.innerMoveable=null},n.getMoveable=function(){return this.innerMoveable.moveable},e=YZ([ER(KZ,function(r,i){r[i]||(r[i]=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];var c=this.getMoveable();if(!(!c||!c[i]))return c[i].apply(c,a)})}),ER(WZ,function(r,i){Object.defineProperty(r,i,{get:function(){return this.getMoveable().props[i]},set:function(a){var o;this.setState((o={},o[i]=a,o))},enumerable:!0,configurable:!0})})],e),e})(Z0),g3=(function(t){TE(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(ZZ),Do=(t=>(t.Mouse="mouse",t.Touch="touch",t.Pointer="pointer",t))(Do||{}),Af=(t=>(t.CancelledByMovement="cancelled-by-movement",t.CancelledByRelease="cancelled-by-release",t.CancelledOutsideElement="cancelled-outside-element",t))(Af||{});const JZ=["mousedown","mousemove","mouseup","mouseleave","mouseout"],eJ=["touchstart","touchmove","touchend","touchcancel"],tJ=["pointerdown","pointermove","pointerup","pointerleave","pointerout"];function nJ(t){return typeof t=="object"&&t!==null&&"pageX"in t&&typeof t.pageX=="number"&&"pageY"in t&&typeof t.pageY=="number"}function rJ(t){var e;return JZ.includes((e=t?.nativeEvent)==null?void 0:e.type)}function m3(t){var e;return eJ.includes((e=t?.nativeEvent)==null?void 0:e.type)||"touches"in t}function iJ(t){const{nativeEvent:e}=t;return e?tJ.includes(e?.type)||"pointerId"in e:!1}function cx(t){return rJ(t)||m3(t)||iJ(t)}function mN(t){var e;const n=m3(t)?(e=t?.touches)==null?void 0:e[0]:t;return nJ(n)?{x:n.pageX,y:n.pageY}:null}function aJ(t){return{target:t.target,currentTarget:t.currentTarget,nativeEvent:t,persist:()=>{}}}function AE(t,{threshold:e=400,captureEvent:n=!1,detect:r=Do.Pointer,cancelOnMovement:i=!1,cancelOutsideElement:a=!0,filterEvents:o,onStart:c,onMove:u,onFinish:d,onCancel:h}={}){const p=B.useRef(!1),m=B.useRef(!1),b=B.useRef(),w=B.useRef(),E=B.useRef(t),S=B.useRef(null),T=B.useCallback(P=>M=>{m.current||cx(M)&&(o!==void 0&&!o(M)||(n&&M.persist(),c?.(M,{context:P}),S.current=mN(M),m.current=!0,b.current=M.currentTarget,w.current=setTimeout(()=>{E.current&&(E.current(M,{context:P}),p.current=!0)},e)))},[n,o,c,e]),C=B.useCallback(P=>(M,A)=>{cx(M)&&m.current&&(S.current=null,n&&M.persist(),p.current?d?.(M,{context:P}):m.current&&h?.(M,{context:P,reason:A??Af.CancelledByRelease}),p.current=!1,m.current=!1,w.current!==void 0&&clearTimeout(w.current))},[n,d,h]),N=B.useCallback(P=>M=>{if(cx(M)&&(u?.(M,{context:P}),i!==!1&&S.current)){const A=mN(M);if(A){const k=i===!0?25:i,D={x:Math.abs(A.x-S.current.x),y:Math.abs(A.y-S.current.y)};(D.x>k||D.y>k)&&C(P)(M,Af.CancelledByMovement)}}},[C,i,u]),j=B.useCallback(P=>{if(t===null)return{};switch(r){case Do.Mouse:{const M={onMouseDown:T(P),onMouseMove:N(P),onMouseUp:C(P)};return a&&(M.onMouseLeave=A=>{C(P)(A,Af.CancelledOutsideElement)}),M}case Do.Touch:return{onTouchStart:T(P),onTouchMove:N(P),onTouchEnd:C(P)};case Do.Pointer:{const M={onPointerDown:T(P),onPointerMove:N(P),onPointerUp:C(P)};return a&&(M.onPointerLeave=A=>C(P)(A,Af.CancelledOutsideElement)),M}}},[t,C,a,r,N,T]);return B.useEffect(()=>{function P(M){const A=aJ(M);C()(A)}return window.addEventListener("mouseup",P),window.addEventListener("touchend",P),window.addEventListener("pointerup",P),()=>{window.removeEventListener("mouseup",P),window.removeEventListener("touchend",P),window.removeEventListener("pointerup",P)}},[C]),B.useEffect(()=>()=>{w.current!==void 0&&clearTimeout(w.current)},[]),B.useEffect(()=>{E.current=t},[t]),j}const v3=()=>{if(/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream){const e=document.getElementById("ios-haptic-trigger");e&&e.click()}else typeof navigator<"u"&&navigator.vibrate&&navigator.vibrate(50)},s0=t=>t?t instanceof Date?t:typeof t=="string"?new Date(t):typeof t=="number"?new Date(t):t?.toDate&&typeof t.toDate=="function"?t.toDate():new Date:new Date,Vl=t=>s0(t).toISOString(),sJ=t=>{const e=s0(t);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`},oJ=t=>{const e=t.toLowerCase();return e==="income"?"Income":e==="expense"?"Expense":e==="transfer"?"Transfer":"Expense"},CE=t=>{const e=t;let n=0;typeof e.amount=="number"?n=e.amount:typeof e.amount=="string"&&(n=parseFloat(e.amount)),isNaN(n)&&(n=0);const r=Vl(e.date);return{id:e.id||"",userId:e.userId||"",envelopeId:e.envelopeId||"",amount:n,date:r,month:e.month||sJ(r),description:e.description||"",merchant:e.merchant||void 0,type:oJ(e.type||"expense"),reconciled:e.reconciled??!1,transferId:e.transferId||void 0,isAutomatic:e.isAutomatic||void 0,paymentMethod:e.paymentMethod?typeof e.paymentMethod=="string"?{id:e.paymentMethod,name:e.paymentMethod,network:"Visa",last4:"****",color:"#000000"}:e.paymentMethod:void 0}};class ql{static instance;static getInstance(){return ql.instance||(ql.instance=new ql),ql.instance}async restoreUserData(e,n){try{console.log(" BudgetService.restoreUserData: STARTING RESTORE for user:",e),await this.deleteAllUserData(e);const r=[{name:"envelopes",data:n.envelopes||[]},{name:"transactions",data:n.transactions||[]},{name:"envelopeAllocations",data:n.allocations?Object.values(n.allocations).flat():[]},{name:"monthlyBudgets",data:this.prepareMonthlyBudgetsData(n.allocations,n.incomeSources)},{name:"appSettings",data:n.appSettings?[n.appSettings]:[]}],i=[];for(const{name:o,data:c}of r)if(Array.isArray(c))for(const u of c){if(!u.id&&o!=="monthlyBudgets")continue;const d={...u,userId:e};let h=u.id;o==="monthlyBudgets"&&u.month&&(h=u.month);const p=yt(Ke,"users",e,o,h);i.push({ref:p,data:d})}console.log(` Prepared ${i.length} items for restoration.`);const a=450;for(let o=0;o<i.length;o+=a){const c=qx(Ke);i.slice(o,o+a).forEach(d=>{c.set(d.ref,d.data)}),console.log(` Committing batch ${Math.floor(o/a)+1}/${Math.ceil(i.length/a)}...`),await c.commit()}console.log(" Restore completed successfully.")}catch(r){throw console.error(" BudgetService.restoreUserData failed:",r),new Error(`Failed to restore user data: ${r instanceof Error?r.message:"Unknown error"}`)}}async getEnvelopes(e){try{console.log(" BudgetService.getEnvelopes called for user:",e);const n=yr(Ke,"users",e,"envelopes"),a=(await qi(n)).docs.map((o,c)=>({id:o.id,...o.data(),orderIndex:o.data().orderIndex??c})).sort((o,c)=>{const u=o.orderIndex??0,d=c.orderIndex??0;return u-d});return console.log(" Fetched envelopes:",a.length),a}catch(n){throw console.error(" BudgetService.getEnvelopes failed:",n),new Error(`Failed to fetch envelopes: ${n instanceof Error?n.message:"Unknown error"}`)}}async getTransactions(e){try{console.log(" BudgetService.getTransactions: Fetching for user",e);const n=yr(Ke,"users",e,"transactions"),r=ta(n,Yo("date","desc")),a=(await qi(r)).docs.map(o=>{const c={id:o.id,...o.data()};return CE(c)});return console.log(` Fetched ${a.length} transactions`),a}catch(n){throw console.error(" BudgetService.getTransactions failed:",n),new Error(`Failed to fetch transactions: ${n instanceof Error?n.message:"Unknown error"}`)}}async createEnvelope(e){try{console.log(" BudgetService.createEnvelope called for user:",e.userId);const n=yr(Ke,"users",e.userId,"envelopes"),r=yt(n),i=gt.now(),a={...e,createdAt:i,lastUpdated:i};ti(r,a).catch(c=>console.error("Create env failed",c));const o={...e,id:r.id,createdAt:Vl(i),lastUpdated:Vl(i)};return console.log(" Created envelope (optimistic):",o.id),o}catch(n){throw console.error(" BudgetService.createEnvelope failed:",n),new Error(`Failed to create envelope: ${n instanceof Error?n.message:"Unknown error"}`)}}async updateEnvelope(e,n){try{console.log(" BudgetService.updateEnvelope called for envelope:",n.id);const r=yt(Ke,"users",e,"envelopes",n.id);ti(r,{...n,lastUpdated:gt.now()},{merge:!0}).catch(i=>console.error("Update env failed",i)),console.log(" Updated envelope (optimistic):",n.id)}catch(r){throw console.error(" BudgetService.updateEnvelope failed:",r),new Error(`Failed to update envelope: ${r instanceof Error?r.message:"Unknown error"}`)}}async deleteEnvelope(e,n){try{const r=yt(Ke,"users",e,"envelopes",n),i=ta(yr(Ke,"users",e,"transactions"),s$("envelopeId","==",n)),o=(await qi(i)).docs.map(c=>Yi(c.ref));await Promise.all([Yi(r),...o]),console.log(" Deleted envelope and associated transactions from Firestore:",n)}catch(r){throw console.error(" BudgetService.deleteEnvelope failed:",r),new Error(`Failed to delete envelope: ${r instanceof Error?r.message:"Unknown error"}`)}}async reorderEnvelopes(e,n){try{console.log(" BudgetService.reorderEnvelopes called for user:",e);const r=n.map(i=>{const a=yt(Ke,"users",e,"envelopes",i.id);return ti(a,{orderIndex:i.orderIndex,lastUpdated:gt.now()},{merge:!0})});Promise.all(r).catch(i=>console.error("Reorder env failed",i)),console.log(" Reordered envelopes (optimistic)")}catch(r){throw console.error(" BudgetService.reorderEnvelopes failed:",r),new Error(`Failed to reorder envelopes: ${r instanceof Error?r.message:"Unknown error"}`)}}async createTransaction(e){try{console.log(" BudgetService.createTransaction called for user:",e.userId);const n=yr(Ke,"users",e.userId,"transactions"),r=yt(n),i=gt.now();if(e.paymentMethod){const u={...e.paymentMethod};u.last4===void 0&&delete u.last4,e.paymentMethod=u}const o={...Object.fromEntries(Object.entries(e).filter(([u,d])=>d!==void 0)),createdAt:i};ti(r,o).catch(u=>console.error("Create tx failed",u));const c={...e,id:r.id};return console.log(" Created transaction (optimistic):",c.id),c}catch(n){throw console.error(" BudgetService.createTransaction failed:",n),new Error(`Failed to create transaction: ${n instanceof Error?n.message:"Unknown error"}`)}}async updateTransaction(e,n){try{if(console.log(" BudgetService.updateTransaction called for transaction:",n.id),n.paymentMethod){const a={...n.paymentMethod};a.last4===void 0&&delete a.last4,n.paymentMethod=a}const r=Object.fromEntries(Object.entries(n).filter(([a,o])=>o!==void 0)),i=yt(Ke,"users",e,"transactions",n.id);ti(i,r,{merge:!0}).catch(a=>console.error("Update tx failed",a)),console.log(" Updated transaction (optimistic):",n.id)}catch(r){throw console.error(" BudgetService.updateTransaction failed:",r),new Error(`Failed to update transaction: ${r instanceof Error?r.message:"Unknown error"}`)}}async deleteTransaction(e,n){try{console.log(" BudgetService.deleteTransaction called for transaction:",n);const r=yt(Ke,"users",e,"transactions",n);Yi(r).catch(i=>console.error("Delete tx failed",i)),console.log(" Deleted transaction (optimistic):",n)}catch(r){throw console.error(" BudgetService.deleteTransaction failed:",r),new Error(`Failed to delete transaction: ${r instanceof Error?r.message:"Unknown error"}`)}}async createIncomeSource(e){try{console.log(" BudgetService.createIncomeSource (Embedded) called for user:",e.userId);const n=yt(Ke,"users",e.userId,"monthlyBudgets",e.month),r=gt.now(),i=`inc_${r.toMillis()}_${Math.random().toString(36).substring(2,9)}`,a={...e,id:i,amount:Number(e.amount),createdAt:r,updatedAt:r};Ca(n,{incomeSources:u$(a),updatedAt:r}).catch(c=>{c.code==="not-found"?ti(n,{id:`${e.userId}_${e.month}`,userId:e.userId,month:e.month,createdAt:r,updatedAt:r,incomeSources:[a],allocations:{},totalIncome:0,availableToBudget:0}).catch(u=>console.error("Failed to create monthly budget doc",u)):console.error("Create income failed",c)});const o={...e,id:i,amount:Number(e.amount),createdAt:Vl(r),updatedAt:Vl(r)};return console.log(" Created income source (optimistic/embedded):",o.id),o}catch(n){throw console.error(" BudgetService.createIncomeSource failed:",n),new Error(`Failed to create income source: ${n instanceof Error?n.message:"Unknown error"}`)}}async updateIncomeSource(e,n,r,i){try{console.log(" BudgetService.updateIncomeSource (Embedded) called for source:",n);const a=yt(Ke,"users",e,"monthlyBudgets",r);Nb(a).then(o=>{if(!o.exists())return;const d=(o.data().incomeSources||[]).map(h=>{if(h.id===n){const p={...h,...i,updatedAt:gt.now()};return i.amount!==void 0&&(p.amount=Number(i.amount)),p}return h});Ca(a,{incomeSources:d,updatedAt:gt.now()})}).catch(o=>console.error("Update income failed",o)),console.log(" Updated income source (optimistic/embedded):",n)}catch(a){throw console.error(" BudgetService.updateIncomeSource failed:",a),a}}async deleteIncomeSource(e,n,r){try{console.log(" BudgetService.deleteIncomeSource (Embedded) called for source:",n);const i=yt(Ke,"users",e,"monthlyBudgets",r);Nb(i).then(a=>{if(!a.exists())return;const u=(a.data().incomeSources||[]).filter(d=>d.id!==n);Ca(i,{incomeSources:u,updatedAt:gt.now()})}).catch(a=>console.error("Delete income failed",a)),console.log(" Deleted income source (optimistic/embedded):",n)}catch(i){throw console.error(" BudgetService.deleteIncomeSource failed:",i),new Error(`Failed to delete income source: ${i instanceof Error?i.message:"Unknown error"}`)}}async createEnvelopeAllocation(e){try{console.log(" BudgetService.createEnvelopeAllocation (Embedded) called for user:",e.userId);const n=yt(Ke,"users",e.userId,"monthlyBudgets",e.month),r=gt.now(),i={[`allocations.${e.envelopeId}`]:Number(e.budgetedAmount),updatedAt:r};Ca(n,i).catch(o=>{o.code==="not-found"?ti(n,{id:`${e.userId}_${e.month}`,userId:e.userId,month:e.month,createdAt:r,updatedAt:r,incomeSources:[],allocations:{[e.envelopeId]:Number(e.budgetedAmount)},totalIncome:0,availableToBudget:0}).catch(c=>console.error("Failed to create monthly budget doc",c)):console.error("Create allocation failed",o)});const a={...e,id:e.envelopeId,createdAt:Vl(r),updatedAt:Vl(r)};return console.log(" Created allocation (optimistic/embedded):",a.id),a}catch(n){throw console.error(" BudgetService.createEnvelopeAllocation failed:",n),new Error(`Failed to create envelope allocation: ${n instanceof Error?n.message:"Unknown error"}`)}}async updateEnvelopeAllocation(e,n,r,i){try{console.log(" BudgetService.updateEnvelopeAllocation (Embedded) called for envelope:",n);const a=yt(Ke,"users",e,"monthlyBudgets",r),o={updatedAt:gt.now()};i.budgetedAmount!==void 0&&(o[`allocations.${n}`]=Number(i.budgetedAmount)),Ca(a,o).catch(c=>console.error("Update allocation failed",c)),console.log(" Updated allocation (optimistic/embedded):",n)}catch(a){throw console.error(" BudgetService.updateEnvelopeAllocation failed:",a),new Error(`Failed to update envelope allocation: ${a instanceof Error?a.message:"Unknown error"}`)}}async deleteEnvelopeAllocation(e,n,r){try{console.log(" BudgetService.deleteEnvelopeAllocation (Embedded) called for envelope:",n);const i=yt(Ke,"users",e,"monthlyBudgets",r);Ca(i,{[`allocations.${n}`]:rk(),updatedAt:gt.now()}).catch(a=>console.error("Delete allocation failed",a)),console.log(" Deleted allocation (optimistic/embedded):",n)}catch(i){throw console.error(" BudgetService.deleteEnvelopeAllocation failed:",i),new Error(`Failed to delete envelope allocation: ${i instanceof Error?i.message:"Unknown error"}`)}}async getMonthData(e,n){try{console.log(` BudgetService.getMonthData (Embedded): Fetching for user ${e}, month ${n}`);const r=yt(Ke,"users",e,"monthlyBudgets",n),i=await Nb(r);if(!i.exists())return console.log(` No budget data found for ${n}, returning empty defaults.`),{incomeSources:[],allocations:[]};const a=i.data(),o=(a.incomeSources||[]).map(d=>({...d,amount:Number(d.amount),createdAt:d.createdAt?.toDate?d.createdAt.toDate().toISOString():d.createdAt||new Date().toISOString(),updatedAt:d.updatedAt?.toDate?d.updatedAt.toDate().toISOString():d.updatedAt||new Date().toISOString()})).sort((d,h)=>new Date(d.createdAt).getTime()-new Date(h.createdAt).getTime()),c=a.allocations||{},u=Object.entries(c).map(([d,h])=>({id:d,userId:e,envelopeId:d,month:n,budgetedAmount:Number(h),createdAt:a.createdAt?.toDate?a.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:a.updatedAt?.toDate?a.updatedAt.toDate().toISOString():new Date().toISOString()})).sort((d,h)=>new Date(d.createdAt).getTime()-new Date(h.createdAt).getTime());return console.log(` Fetched ${o.length} income sources and ${u.length} allocations for ${n}`),{incomeSources:o,allocations:u}}catch(r){throw console.error(" BudgetService.getMonthData failed:",r),new Error(`Failed to fetch month data: ${r instanceof Error?r.message:"Unknown error"}`)}}async cleanupOrphanedData(e){try{console.log(" BudgetService.cleanupOrphanedData: Starting cleanup for user:",e);const n={orphanedAllocationsDeleted:0,orphanedTransactionsDeleted:0,details:{deletedAllocationIds:[],deletedTransactionIds:[],monthsProcessed:[]}},r=await this.getEnvelopes(e),i=new Set(r.map(b=>b.id));console.log(` Found ${r.length} existing envelopes`);const a=yr(Ke,"users",e,"envelopeAllocations"),o=await qi(a),c=[],u=new Set;for(const b of o.docs){const w=b.data();u.add(w.month),i.has(w.envelopeId)||(c.push(b.id),console.log(` Found orphaned allocation: ${b.id} for envelope ${w.envelopeId} in month ${w.month}`))}if(c.length>0){const b=c.map(w=>Yi(yt(Ke,"users",e,"envelopeAllocations",w)));await Promise.all(b),n.orphanedAllocationsDeleted+=c.length,n.details.deletedAllocationIds.push(...c),console.log(` Deleted ${c.length} orphaned allocations (legacy)`)}const d=yr(Ke,"users",e,"monthlyBudgets"),h=await qi(d);for(const b of h.docs){const E=b.data().allocations||{},S={};let T=!1;Object.keys(E).forEach(C=>{i.has(C)||(S[`allocations.${C}`]=rk(),T=!0,console.log(` Found orphaned embedded allocation in ${b.id} for envelope ${C}`),n.orphanedAllocationsDeleted++,n.details.deletedAllocationIds.push(`${b.id}_${C}`))}),T&&(S.updatedAt=gt.now(),await Ca(b.ref,S),u.add(b.id))}const p=await this.getTransactions(e),m=[];for(const b of p)i.has(b.envelopeId)||(m.push(b.id),console.log(` Found orphaned transaction: ${b.id} for envelope ${b.envelopeId}`));if(m.length>0){const b=m.map(w=>Yi(yt(Ke,"users",e,"transactions",w)));await Promise.all(b),n.orphanedTransactionsDeleted=m.length,n.details.deletedTransactionIds=m,console.log(` Deleted ${m.length} orphaned transactions`)}return n.details.monthsProcessed=Array.from(u),console.log(" Cleanup completed:",{orphanedAllocationsDeleted:n.orphanedAllocationsDeleted,orphanedTransactionsDeleted:n.orphanedTransactionsDeleted,monthsProcessed:n.details.monthsProcessed.length}),n}catch(n){throw console.error(" BudgetService.cleanupOrphanedData failed:",n),new Error(`Failed to cleanup orphaned data: ${n instanceof Error?n.message:"Unknown error"}`)}}subscribeToMonthlyBudget(e,n,r){const i=yt(Ke,"users",e,"monthlyBudgets",n);return td(i,a=>{if(!a.exists()){r({incomeSources:[],allocations:[]});return}const o=a.data(),c=(o.incomeSources||[]).map(h=>({...h,amount:Number(h.amount),createdAt:h.createdAt?.toDate?h.createdAt.toDate().toISOString():h.createdAt||new Date().toISOString(),updatedAt:h.updatedAt?.toDate?h.updatedAt.toDate().toISOString():h.updatedAt||new Date().toISOString()})).sort((h,p)=>new Date(h.createdAt).getTime()-new Date(p.createdAt).getTime()),u=o.allocations||{},d=Object.entries(u).map(([h,p])=>({id:h,userId:e,envelopeId:h,month:n,budgetedAmount:Number(p),createdAt:o.createdAt?.toDate?o.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:o.updatedAt?.toDate?o.updatedAt.toDate().toISOString():new Date().toISOString()})).sort((h,p)=>new Date(h.createdAt).getTime()-new Date(p.createdAt).getTime());r({incomeSources:c,allocations:d})})}prepareMonthlyBudgetsData(e,n){const r=[],i=new Set;return e&&Object.keys(e).forEach(a=>i.add(a)),n&&Object.keys(n).forEach(a=>i.add(a)),i.forEach(a=>{const o=e?.[a]||[],c=n?.[a]||[],u={};o.forEach(h=>{u[h.envelopeId]=h.budgetedAmount});const d={month:a,userId:"",incomeSources:c,allocations:u,totalIncome:c.reduce((h,p)=>h+Number(p.amount||0),0),availableToBudget:c.reduce((h,p)=>h+Number(p.amount||0),0)-o.reduce((h,p)=>h+Number(p.budgetedAmount||0),0),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};r.push(d)}),r}async deleteAllUserData(e){try{console.log(" BudgetService.deleteAllUserData: STARTING DELETION for user:",e);const n=["envelopes","transactions","incomeSources","envelopeAllocations","monthlyBudgets","appSettings"];for(const r of n){console.log(` Deleting collection: ${r}...`);const i=yr(Ke,"users",e,r),a=await qi(i);if(a.empty){console.log("   (Empty collection)");continue}const o=a.docs.map(c=>Yi(c.ref));await Promise.all(o),console.log(`    Deleted ${a.size} documents from ${r}`)}console.log(" All user data deleted successfully.")}catch(n){throw console.error(" BudgetService.deleteAllUserData failed:",n),new Error(`Failed to delete all user data: ${n instanceof Error?n.message:"Unknown error"}`)}}}const kE=ql.getInstance();class Io{static instance;constructor(){}static getInstance(){return Io.instance||(Io.instance=new Io),Io.instance}createId(){return yt(yr(Ke,"temp")).id}async createCategory(e){const n=yt(Ke,`users/${e.userId}/categories`,e.id);return await ti(n,e),e}async getCategories(e){const n=ta(yr(Ke,`users/${e}/categories`),Yo("orderIndex","asc"));return(await qi(n)).docs.map(i=>i.data())}async updateCategory(e,n){const r=yt(Ke,`users/${e}/categories`,n.id);await ti(r,n,{merge:!0})}async deleteCategory(e,n){const r=yt(Ke,`users/${e}/categories`,n);await Yi(r)}async reorderCategories(e,n){const r=qx(Ke);n.forEach((i,a)=>{const o=yt(Ke,`users/${e}/categories`,i.id);r.update(o,{orderIndex:a})}),await r.commit()}async deduplicateCategories(e){const n=await this.getCategories(e),r=new Map,i=[];for(const o of n){const c=o.name.toLowerCase().trim();r.has(c)?i.push(o.id):r.set(c,o)}if(i.length===0)return console.log(" No duplicate categories found"),0;console.log(` Found ${i.length} duplicate categories to remove`);const a=450;for(let o=0;o<i.length;o+=a){const c=qx(Ke);i.slice(o,o+a).forEach(d=>{const h=yt(Ke,`users/${e}/categories`,d);c.delete(h)}),await c.commit(),console.log(` Deleted batch ${Math.floor(o/a)+1}`)}return console.log(` Removed ${i.length} duplicate categories`),i.length}subscribeToCategories(e,n){const r=ta(yr(Ke,`users/${e}/categories`),Yo("orderIndex","asc"));return td(r,i=>{const a=i.docs.map(o=>o.data());n(a)},i=>{console.error(" Category subscription error:",i)})}}Io.getInstance();const ux=t=>yr(Ke,"users",t,"transactions"),lJ={subscribeToTransactions:(t,e)=>{const n=ta(ux(t),Yo("date","desc"));return td(n,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllTransactions:async t=>{console.log(` TransactionService.getAllTransactions: Fetching for user ${t}`);const e=ta(ux(t),Yo("date","desc")),r=(await qi(e)).docs.map(i=>{const a={id:i.id,...i.data()};return CE(a)});return console.log(` Fetched ${r.length} transactions:`,r.map(i=>({id:i.id,description:i.description,month:i.month}))),r},addTransaction:async t=>{const{userId:e,id:n,...r}=t;if(!e)throw new Error("User ID is required to create transaction");console.log(` TransactionService.addTransaction: Adding transaction for user ${e}:`,r),console.log(` Original transaction had temp ID: ${n}`);try{console.log(" About to call addDoc with:",r);const i=await U0(ux(e),r);console.log(" addDoc succeeded, docRef:",i),console.log(` Document ID: ${i.id}`),console.log(` Document path: ${i.path}`);const a={id:i.id,...r,userId:e};return console.log(" Final result object:",a),a}catch(i){throw console.error(" addDoc failed:",i),console.error("Error message:",i.message),i}},updateTransaction:async(t,e,n)=>{const r=yt(Ke,"users",t,"transactions",e);return await Ca(r,n)},deleteTransaction:async(t,e)=>{console.log(` TransactionService.deleteTransaction: Deleting transaction ${e} for user ${t}`);try{const n=yt(Ke,"users",t,"transactions",e);console.log(` Deleting document at path: ${n.path}`),await Yi(n),console.log(` TransactionService.deleteTransaction: Successfully deleted transaction ${e}`)}catch(n){throw console.error(` TransactionService.deleteTransaction: Failed to delete transaction ${e}:`,n),console.error("Error message:",n.message),n}}},dx=t=>yr(Ke,"users",t,"envelopes"),cJ={subscribeToEnvelopes:(t,e)=>{const n=ta(dx(t),Yo("orderIndex","asc"));return td(n,i=>{const a=i.docs.map(o=>{const c=o.data();return{id:o.id,...c,createdAt:c.createdAt?.toDate?.()?c.createdAt.toDate().toISOString():c.createdAt,lastUpdated:c.lastUpdated?.toDate?.()?c.lastUpdated.toDate().toISOString():c.lastUpdated}});e(a)})},getAllEnvelopes:async t=>{try{console.log(" EnvelopeService.getAllEnvelopes called for user:",t);const e=dx(t),i=(await qi(e)).docs.map((a,o)=>{const c=a.data();return{id:a.id,...c,createdAt:c.createdAt?.toDate?.()?c.createdAt.toDate().toISOString():c.createdAt,lastUpdated:c.lastUpdated?.toDate?.()?c.lastUpdated.toDate().toISOString():c.lastUpdated,orderIndex:c.orderIndex??o}}).sort((a,o)=>{const c=a.orderIndex??0,u=o.orderIndex??0;return c-u});return console.log(" Fetched envelopes:",i.length),i}catch(e){return console.error(" EnvelopeService.getAllEnvelopes failed:",e),[]}},createEnvelope:async t=>{const{userId:e,id:n,...r}=t;if(!e)throw new Error("User ID is required to create envelope");try{return{id:(await U0(dx(e),r)).id,...r,userId:e}}catch(i){throw console.error(" Envelope addDoc failed:",i),i}},saveEnvelope:async(t,e)=>{if(!e.id)throw new Error("Envelope ID is required for save operation");const n=yt(Ke,"users",t,"envelopes",e.id);return await ti(n,e,{merge:!0})},updateBalance:async(t,e,n)=>{const r=yt(Ke,"users",t,"envelopes",e);return await Ca(r,{currentBalance:n,lastUpdated:new Date().toISOString()})},deleteEnvelope:async(t,e)=>{console.log(` EnvelopeService.deleteEnvelope: Deleting envelope ${e} for user ${t}`);const n=yt(Ke,"users",t,"envelopes",e);await Yi(n),console.log(` EnvelopeService.deleteEnvelope: Successfully deleted envelope ${e}`)}},fx=t=>yr(Ke,"users",t,"distributionTemplates"),uJ={subscribeToDistributionTemplates:(t,e)=>{const n=ta(fx(t),Yo("lastUsed","desc"));return td(n,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllDistributionTemplates:async t=>{const e=ta(fx(t),Yo("lastUsed","desc"));return(await qi(e)).docs.map(r=>({id:r.id,...r.data()}))},createDistributionTemplate:async t=>{const{userId:e,id:n,...r}=t;if(!e)throw new Error("User ID is required to create distribution template");console.log(` DistributionTemplateService.createDistributionTemplate: Adding template for user ${e}:`,r);try{const i=await U0(fx(e),r);console.log(" Template addDoc succeeded, docRef:",i);const a={id:i.id,...r,userId:e};return console.log(" Final template result object:",a),a}catch(i){throw console.error(" Template addDoc failed:",i),i}},saveDistributionTemplate:async(t,e)=>{const n=yt(Ke,"users",t,"distributionTemplates",e.id);return await ti(n,e,{merge:!0})},updateDistributionTemplate:async(t,e,n)=>{const r=yt(Ke,"users",t,"distributionTemplates",e);return await Ca(r,n)},deleteDistributionTemplate:async(t,e)=>{console.log(` DistributionTemplateService.deleteDistributionTemplate: Deleting template ${e} for user ${t}`);const n=yt(Ke,"users",t,"distributionTemplates",e);await Yi(n),console.log(` DistributionTemplateService.deleteDistributionTemplate: Successfully deleted template ${e}`)}},hx=t=>yr(Ke,"users",t,"appSettings"),y3={subscribeToAppSettings:(t,e)=>{const n=ta(hx(t),ek(1));return td(n,i=>{if(i.empty){e(null);return}const a=i.docs.map(o=>({id:o.id,...o.data()}))[0];e(a)})},getAppSettings:async t=>{const e=ta(hx(t),ek(1)),n=await qi(e);if(n.empty)return null;const r=n.docs[0];return{id:r.id,...r.data()}},createAppSettings:async t=>{const{userId:e,...n}=t;if(!e)throw new Error("User ID is required to create app settings");console.log(` AppSettingsService.createAppSettings: Creating settings for user ${e}:`,n);try{const r=await U0(hx(e),n);console.log(" Settings addDoc succeeded, docRef:",r);const i={id:r.id,...n,userId:e};return console.log(" Final settings result object:",i),i}catch(r){throw console.error(" Settings addDoc failed:",r),r}},saveAppSettings:async(t,e)=>{const n=yt(Ke,"users",t,"appSettings",e.id);return await ti(n,e,{merge:!0})},updateAppSettings:async(t,e,n)=>{const r=yt(Ke,"users",t,"appSettings",e);return await ti(r,n,{merge:!0})},deleteAppSettings:async(t,e)=>{console.log(` AppSettingsService.deleteAppSettings: Deleting settings ${e} for user ${t}`);const n=yt(Ke,"users",t,"appSettings",e);await Yi(n),console.log(` AppSettingsService.deleteAppSettings: Successfully deleted settings ${e}`)}},vN=Object.freeze(Object.defineProperty({__proto__:null,AppSettingsService:y3},Symbol.toStringTag,{value:"Module"})),dJ=t=>CE(t),fJ=t=>({id:t.id,name:t.name||"",currentBalance:t.currentBalance||0,lastUpdated:t.lastUpdated?.toDate?.()?t.lastUpdated.toDate().toISOString():t.lastUpdated,isActive:t.isActive??!0,orderIndex:t.orderIndex??0,userId:t.userId||void 0,createdAt:t.createdAt?.toDate?.()?t.createdAt.toDate().toISOString():t.createdAt,isPiggybank:t.isPiggybank,piggybankConfig:t.piggybankConfig,categoryId:t.categoryId}),hJ=t=>({id:t.id,userId:t.userId,name:t.name,orderIndex:t.orderIndex,isArchived:t.isArchived,createdAt:t.createdAt?.toDate?.()?t.createdAt.toDate().toISOString():t.createdAt,updatedAt:t.updatedAt?.toDate?.()?t.updatedAt.toDate().toISOString():t.updatedAt}),yN=(t,e)=>{if(window.__firebaseUnsubscribers){console.log(" Real-time subscriptions already active, skipping setup");return}console.log(" Setting up real-time Firebase subscriptions...");const n=t.getState().currentMonth;console.log(" Current month for subscriptions:",n);const r=cJ.subscribeToEnvelopes(e,h=>{console.log(" Real-time sync: Envelopes updated",h.length);const p=h.map(fJ),m=t.getState(),b=new Set(m.envelopes.map(S=>S.id)),w=new Set(p.map(S=>S.id)),E=[...p.filter(S=>b.has(S.id)),...m.envelopes.filter(S=>!w.has(S.id))];t.setState({envelopes:E})}),i=lJ.subscribeToTransactions(e,h=>{console.log(" Real-time sync: Transactions updated",h.length);const p=h.map(dJ),m=t.getState(),b=new Set(m.transactions.map(S=>`${S.id}-${S.month}`)),w=new Set(p.map(S=>`${S.id}-${S.month}`)),E=[...p.filter(S=>b.has(`${S.id}-${S.month}`)),...m.transactions.filter(S=>!w.has(`${S.id}-${S.month}`))];t.setState({transactions:E})}),o=Io.getInstance().subscribeToCategories(e,h=>{console.log(" Real-time sync: Categories updated",h.length);const p=h.map(hJ),m=Array.from(new Map(p.map(b=>[b.id,b])).values());m.length!==p.length&&console.warn(" Duplicate categories detected in real-time update, deduplicating..."),t.setState({categories:m})}),c=uJ.subscribeToDistributionTemplates(e,h=>{console.log(" Real-time sync: Templates updated from Firebase",h.length)}),u=y3.subscribeToAppSettings(e,h=>{console.log(" Real-time sync: Settings updated",h?"found":"null");const p=t.getState();if(h){const m={...p.appSettings,...h,paymentSources:h.paymentSources??p.appSettings?.paymentSources??[]};t.setState({appSettings:m})}else console.log(" Firebase settings null, preserving local state")}),d=kE.subscribeToMonthlyBudget(e,n,h=>{console.log(` Real-time sync: Monthly budget updated (${h.incomeSources.length} sources, ${h.allocations.length} allocations)`);const p=t.getState();t.setState({incomeSources:{...p.incomeSources,[n]:h.incomeSources},allocations:{...p.allocations,[n]:h.allocations}})});window.__firebaseUnsubscribers={envelopes:r,transactions:i,categories:o,templates:c,settings:u,monthlyBudget:d},console.log(" Real-time subscriptions active - cross-device sync enabled")},pJ=t=>{const{useBudgetStore:e,useAuthStore:n,getCurrentUserId:r}=t;if(typeof window>"u")return;window.addEventListener("online",async()=>{console.log(" Browser online event detected"),e.setState({isOnline:!0})}),window.addEventListener("offline",()=>{console.log(" Browser offline event detected"),e.setState({isOnline:!1})}),e.setState({isOnline:navigator.onLine});const i=n.getState();i.isAuthenticated&&i.currentUser&&(console.log(" User already authenticated on app load, setting up real-time subscriptions"),yN(e,r())),n.subscribe(o=>{if(o.isAuthenticated&&o.currentUser)console.log(" User authenticated, setting up real-time subscriptions"),yN(e,r());else if(!o.isAuthenticated&&!o.isLoading){if(console.log(" User logged out, clearing data and unsubscribing"),window.__firebaseUnsubscribers){const c=window.__firebaseUnsubscribers;c.envelopes&&c.envelopes(),c.transactions&&c.transactions(),c.categories&&c.categories(),c.templates&&c.templates(),c.settings&&c.settings(),c.monthlyBudget&&c.monthlyBudget(),delete window.__firebaseUnsubscribers,console.log(" Cleaned up Firebase subscriptions")}e.getState().handleUserLogout()}});let a=e.getState().currentMonth;e.subscribe(o=>{if(o.currentMonth!==a&&o.isAuthenticated){console.log(" Month changed from",a,"to",o.currentMonth),a=o.currentMonth;const c=r();if(c&&window.__firebaseUnsubscribers){const u=window.__firebaseUnsubscribers;u.monthlyBudget&&u.monthlyBudget(),console.log(" Unsubscribed from old month data"),u.monthlyBudget=kE.subscribeToMonthlyBudget(c,o.currentMonth,d=>{console.log(" Real-time sync: Monthly budget updated for new month");const h=e.getState();e.setState({incomeSources:{...h.incomeSources,[o.currentMonth]:d.incomeSources},allocations:{...h.allocations,[o.currentMonth]:d.allocations}})}),console.log(" Subscribed to monthly data for new month:",o.currentMonth)}}})},pm=()=>Ai.getState().currentUser?.id||"",fn=ql.getInstance(),ps=Io.getInstance(),Qt=gw()(WU(qD((t,e)=>({envelopes:[],transactions:[],categories:[],appSettings:null,incomeSources:{},allocations:{},currentMonth:new Date().toISOString().slice(0,7),isOnline:typeof navigator<"u"?navigator.onLine:!0,isOnboardingActive:!1,isOnboardingCompleted:!1,isLoading:!1,error:null,setIsOnboardingActive:n=>{t({isOnboardingActive:n})},checkAndStartOnboarding:async()=>{const n=pm();if(!n){console.log(" No user ID, skipping onboarding check");return}const r=`onboardingCompleted_${n}`,i=typeof localStorage<"u"?localStorage.getItem(r)==="true":!1;if(console.log(" checkAndStartOnboarding called:",{userId:n,isOnboardingCompleted:i,isOnboardingActive:e().isOnboardingActive,localStorage_key:r,localStorage_value:localStorage.getItem(r)}),i){t({isOnboardingCompleted:!0}),console.log(" Skipping onboarding: already completed (localStorage)");return}try{if((await fn.getEnvelopes(n)).length>0){console.log(" Existing user detected on new device  skipping onboarding, setting localStorage"),localStorage.setItem(r,"true"),t({isOnboardingCompleted:!0,isOnboardingActive:!1});return}}catch(a){console.error(" Failed to check existing envelopes for onboarding:",a),t({isOnboardingCompleted:!0,isOnboardingActive:!1});return}e().isOnboardingActive||(console.log(" Starting onboarding for new user - setting isOnboardingActive to TRUE"),t({isOnboardingCompleted:!1,isOnboardingActive:!0}),console.log(" isOnboardingActive set to:",e().isOnboardingActive))},completeOnboarding:()=>{const n=pm();if(n){const r=`onboardingCompleted_${n}`;localStorage.setItem(r,"true"),console.log(" Onboarding completed for user:",n)}t({isOnboardingCompleted:!0,isOnboardingActive:!1})},resetOnboarding:()=>{const n=pm();if(n){const r=`onboardingCompleted_${n}`;localStorage.removeItem(r),console.log(" Onboarding reset for user:",n)}t({isOnboardingCompleted:!1,isOnboardingActive:!0})},clearMonthData:async n=>{try{t({isLoading:!0,error:null}),console.log(` Clearing all data for month: ${n}`);const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const{monthlyBudgetService:a}=await Tt(async()=>{const{monthlyBudgetService:o}=await import("./MonthlyBudgetService-CaB9XSM3.js");return{monthlyBudgetService:o}},[]);await a.clearMonthData(i.id,n),await e().init(),console.log(` Cleared month data for ${n}`),t({isLoading:!1})}catch(r){throw console.error(" clearMonthData failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to clear month data"}),r}},fetchMonthData:async n=>{try{const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i){console.log("No user logged in, skipping month data fetch");return}console.log(`Fetching month data for: ${n}`);const a=await fn.getMonthData(i.id,n),o=e();t({incomeSources:{...o.incomeSources,[n]:a.incomeSources},allocations:{...o.allocations,[n]:a.allocations}}),console.log(` Fetched month data for ${n}`),(async()=>{const u=e(),d=u.allocations[n]||[],h=u.transactions.filter(m=>m.month===n);let p=0;for(const m of d){const b=u.envelopes.find(E=>E.id===m.envelopeId);if(b?.isPiggybank)continue;const w=h.find(E=>E.envelopeId===m.envelopeId&&(E.description==="Monthly Budget Allocation"||E.description==="Monthly Allocation"||E.description==="Budgeted"||E.description==="Piggybank Contribution"));w?w.amount!==m.budgetedAmount&&(console.log(` Repairing mismatch for envelope ${b?.name||m.envelopeId}: Alloc ${m.budgetedAmount} vs Tx ${w.amount}`),await u.updateTransaction({...w,amount:m.budgetedAmount}),p++):m.budgetedAmount>0&&(console.log(` Repairing missing transaction for envelope ${b?.name||m.envelopeId}`),await u.addTransaction({description:"Budgeted",amount:m.budgetedAmount,envelopeId:m.envelopeId,type:"Income",month:n,date:`${n}-01T00:00:00`,reconciled:!1,isAutomatic:!0}),p++)}p>0&&console.log(` Repaired ${p} allocation discrepancies for ${n}`)})().catch(u=>console.error("Verification failed:",u))}catch(r){console.error(` Failed to fetch month data for ${n}:`,r)}},removeEnvelopeFromMonth:async(n,r)=>{try{t({isLoading:!0,error:null}),console.log(` Removing envelope ${n} from month ${r}`);const i=e(),a=i.allocations[r]?.find(c=>c.envelopeId===n);a?await e().deleteEnvelopeAllocation(a.id):console.log(` No allocation found for envelope ${n} in ${r}`);const o=i.transactions.filter(c=>c.envelopeId===n&&(c.month===r||c.date.startsWith(r)));o.length>0&&(console.log(` Deleting ${o.length} transactions for envelope ${n} in ${r}`),await Promise.all(o.map(c=>e().deleteTransaction(c.id)))),t({isLoading:!1}),console.log(` Removed envelope ${n} from month ${r}`)}catch(i){throw console.error(" removeEnvelopeFromMonth failed:",i),t({isLoading:!1,error:i instanceof Error?i.message:"Failed to remove envelope from month"}),i}},setMonth:async n=>{t({currentMonth:n});const r=e();(r.incomeSources[n]===void 0||r.allocations[n]===void 0)&&(console.log(`Month ${n} data missing in store, fetching...`),t({isLoading:!0}),await e().fetchMonthData(n),t({isLoading:!1}))},init:async()=>{console.log("BudgetStore initializing...");const n=e();try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(m=>m.useAuthStore.getState())).currentUser;if(!i){console.log("No user logged in, skipping data fetch"),t({isLoading:!1});return}console.log(`Fetching data for user: ${i.id}, month: ${n.currentMonth}`);const[a,o,c,u]=await Promise.all([fn.getEnvelopes(i.id),fn.getTransactions(i.id),ps.getCategories(i.id).catch(m=>(console.error(" Failed to load categories:",m),[])),fn.getMonthData(i.id,n.currentMonth)]);let d=Array.from(new Map(c.map(m=>[m.id,m])).values());const h=new Set;let p=!1;for(const m of d){const b=m.name.toLowerCase().trim();if(h.has(b)){p=!0;break}h.add(b)}p&&i&&(console.log(" Duplicate category names detected, running Firestore cleanup..."),await ps.deduplicateCategories(i.id)>0&&(d=await ps.getCategories(i.id))),t({envelopes:a,transactions:o,categories:d,incomeSources:{...n.incomeSources,[n.currentMonth]:u.incomeSources},allocations:{...n.allocations,[n.currentMonth]:u.allocations},isLoading:!1,error:null}),console.log(` BudgetStore initialized: ${a.length} envelopes, ${o.length} transactions, ${c.length} categories, ${u.incomeSources.length} income sources, ${u.allocations.length} allocations`)}catch(r){console.error(" BudgetStore initialization failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to initialize budget data"})}},fetchCategories:async()=>{try{t({isLoading:!0,error:null});const r=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!r)return;const i=await ps.getCategories(r.id),a=Array.from(new Map(i.map(o=>[o.id,o])).values());t({categories:a,isLoading:!1})}catch(n){console.error("Failed to fetch categories:",n),t({isLoading:!1})}},addCategory:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i)throw new Error("No user logged in");const a=e().categories.find(u=>u.name.toLowerCase().trim()===(n.name||"").toLowerCase().trim());if(a)return console.log(` Category "${n.name}" already exists, skipping creation`),t({isLoading:!1}),a.id;const o=ps.createId(),c={...n,id:o,userId:i.id,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),orderIndex:e().categories.length};return await ps.createCategory(c),t(u=>u.categories.some(h=>h.id===o)?{isLoading:!1}:{categories:[...u.categories,c],isLoading:!1}),o}catch(r){throw console.error("Failed to add category:",r),t({isLoading:!1}),r}},updateCategory:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!i)throw new Error("No user logged in");const a={...n,updatedAt:new Date().toISOString()};await ps.updateCategory(i.id,a),t(o=>({categories:o.categories.map(c=>c.id===n.id?a:c),isLoading:!1}))}catch(r){throw console.error("Failed to update category:",r),t({isLoading:!1}),r}},deleteCategory:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No user logged in");await ps.deleteCategory(i.id,n),t(a=>({categories:a.categories.filter(o=>o.id!==n),isLoading:!1}))}catch(r){throw console.error("Failed to delete category:",r),t({isLoading:!1}),r}},reorderCategories:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i)throw new Error("No user logged in");const a=e(),o=new Map;n.forEach((u,d)=>o.set(u,d));const c=a.categories.map(u=>{if(!o.has(u.id))return u;const d=o.get(u.id);return u.orderIndex===d?u:{...u,orderIndex:d}});t({categories:c.sort((u,d)=>u.orderIndex-d.orderIndex)}),await ps.reorderCategories(i.id,c),t({isLoading:!1})}catch(r){throw console.error("Failed to reorder categories:",r),t({isLoading:!1}),r}},addEnvelope:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a={...n,userId:i.id},o=await fn.createEnvelope(a);return t(c=>c.envelopes.some(d=>d.id===o.id)?{isLoading:!1}:{envelopes:[...c.envelopes,o],isLoading:!1}),console.log(" Added envelope:",o.id),o.id}catch(r){throw console.error(" addEnvelope failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to add envelope"}),r}},updateEnvelope:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await fn.updateEnvelope(i.id,n),t(a=>({envelopes:a.envelopes.map(o=>o.id===n.id?n:o),isLoading:!1})),console.log(" Updated envelope:",n.id)}catch(r){throw console.error(" updateEnvelope failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to update envelope"}),r}},deleteEnvelope:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await fn.deleteEnvelope(i.id,n),t(a=>({envelopes:a.envelopes.filter(o=>o.id!==n),transactions:a.transactions.filter(o=>o.envelopeId!==n),isLoading:!1})),console.log(" Deleted envelope:",n)}catch(r){throw console.error(" deleteEnvelope failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete envelope"}),r}},reorderEnvelopes:async n=>{try{t({isLoading:!0,error:null});const r=e(),i=new Map;n.forEach((d,h)=>{i.set(d,h)});const a=r.envelopes.map(d=>{if(!i.has(d.id))return d;const h=i.get(d.id);return d.orderIndex===h?d:{...d,orderIndex:h}}),o=a.filter((d,h)=>d!==r.envelopes[h]);if(!o.length){t({isLoading:!1});return}const u=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!u)throw new Error("No authenticated user found");await fn.reorderEnvelopes(u.id,o),t({envelopes:a,isLoading:!1}),console.log(" Reordered envelopes")}catch(r){throw console.error(" reorderEnvelopes failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to reorder envelopes"}),r}},addTransaction:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=new Date(n.date),o=n.month||`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,c={...n,userId:i.id,month:o},u=await fn.createTransaction(c);t(d=>d.transactions.some(p=>p.id===u.id)?{isLoading:!1}:{transactions:[...d.transactions,u],isLoading:!1}),console.log(" Added transaction:",u.id)}catch(r){throw console.error(" addTransaction failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to add transaction"}),r}},updateTransaction:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=new Date(n.date),o=n.month||`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,c={...n,month:o};await fn.updateTransaction(i.id,c),t(u=>({transactions:u.transactions.map(d=>d.id===n.id?c:d),isLoading:!1})),console.log(" Updated transaction:",n.id)}catch(r){throw console.error(" updateTransaction failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to update transaction"}),r}},deleteTransaction:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await fn.deleteTransaction(i.id,n),t(a=>({transactions:a.transactions.filter(o=>o.id!==n),isLoading:!1})),console.log(" Deleted transaction:",n)}catch(r){throw console.error(" deleteTransaction failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete transaction"}),r}},restoreTransaction:async n=>{await e().updateTransaction(n)},transferFunds:async(n,r,i,a,o)=>{try{const c=o?typeof o=="string"?o:o.toISOString():new Date().toISOString(),u=`transfer-${Date.now()}-${Math.random()}`;await e().addTransaction({description:`Transfer to ${e().envelopes.find(d=>d.id===r)?.name||"envelope"}`,amount:i,envelopeId:n,date:c,type:"Expense",transferId:u,reconciled:!1}),await e().addTransaction({description:`Transfer from ${e().envelopes.find(d=>d.id===n)?.name||"envelope"}`,amount:i,envelopeId:r,date:c,type:"Income",transferId:u,reconciled:!1}),console.log(" Transfer completed")}catch(c){throw console.error(" transferFunds failed:",c),c}},fetchData:async()=>{await e().init()},renameEnvelope:async(n,r)=>{try{t({isLoading:!0,error:null});const a=e().envelopes.find(d=>d.id===n);if(!a)throw new Error("Envelope not found");t(d=>({envelopes:d.envelopes.map(h=>h.id===n?{...h,name:r}:h),isLoading:!0}));const c=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!c)throw new Error("No authenticated user found");const u={...a,name:r};await fn.updateEnvelope(c.id,u),t({isLoading:!1}),console.log(" Renamed envelope:",n)}catch(i){throw console.error(" renameEnvelope failed:",i),t({isLoading:!1,error:i instanceof Error?i.message:"Failed to rename envelope"}),i}},getEnvelopeBalance:(n,r)=>{const i=e(),a=i.envelopes.find(o=>o.id===n);if(!a)return console.log(` getEnvelopeBalance: Envelope ${n} not found`),0;if(a.isPiggybank){const o=i.transactions.filter(p=>p.envelopeId===n),c=o.filter(p=>p.type==="Expense"),u=o.filter(p=>p.type==="Income"),d=c.reduce((p,m)=>p+(m.amount||0),0);return u.reduce((p,m)=>p+(m.amount||0),0)-d}if(r){const o=i.transactions.filter(p=>p.envelopeId===n&&p.month===r),c=o.filter(p=>p.type==="Expense"),u=o.filter(p=>p.type==="Income"),d=c.reduce((p,m)=>p+(m.amount||0),0);return u.reduce((p,m)=>p+(m.amount||0),0)-d}return console.warn(` getEnvelopeBalance: Month not provided for non-piggybank envelope ${n}. Returning 0.`),0},resetData:async()=>{console.log(" Resetting all data"),t({isLoading:!0});try{const r=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(i=>i.useAuthStore.getState())).currentUser;r?(console.log(" Deleting all data from Firestore for user:",r.id),await fn.deleteAllUserData(r.id)):console.warn(" No user logged in, only clearing local state"),t({envelopes:[],transactions:[],appSettings:null,incomeSources:{},allocations:{},isLoading:!1,error:null}),console.log(" Reset data complete")}catch(n){throw console.error(" resetData failed:",n),t({isLoading:!1,error:n instanceof Error?n.message:"Failed to reset data"}),n}},importData:async n=>{try{if(t({isLoading:!0,error:null}),!n||typeof n!="object")throw new Error("Invalid data format");const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("You must be logged in to restore data.");return console.log(" Starting Time Machine Restore for user:",i.id),await fn.restoreUserData(i.id,n),console.log(" Reloading app state from cloud..."),await e().init(),t({isLoading:!1}),{success:!0,message:"Data restored successfully from backup."}}catch(r){return console.error(" importData failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to import data"}),{success:!1,message:r instanceof Error?r.message:"Import failed"}}},updateAppSettings:async n=>{try{t({isLoading:!0,error:null});const r=e(),i={id:r.appSettings?.id||"default",theme:n.theme??r.appSettings?.theme??"system",fontSize:n.fontSize??r.appSettings?.fontSize??"medium",enableMoveableReorder:n.enableMoveableReorder??r.appSettings?.enableMoveableReorder??!0,paymentSources:n.paymentSources??r.appSettings?.paymentSources??[]};(n.userId||r.appSettings?.userId)&&(i.userId=n.userId??r.appSettings?.userId),i.paymentSources&&(i.paymentSources=i.paymentSources.map(c=>{const u={...c};return u.last4===void 0&&delete u.last4,u}));const o=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(o){const{AppSettingsService:c}=await Tt(async()=>{const{AppSettingsService:u}=await Promise.resolve().then(()=>vN);return{AppSettingsService:u}},void 0);await c.updateAppSettings(o.id,i.id,i)}t({appSettings:i,isLoading:!1}),console.log(" Updated app settings")}catch(r){throw console.error(" updateAppSettings failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to update settings"}),r}},initializeAppSettings:async()=>{try{if(e().appSettings)return;const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(i){const{AppSettingsService:o}=await Tt(async()=>{const{AppSettingsService:u}=await Promise.resolve().then(()=>vN);return{AppSettingsService:u}},void 0),c=await o.getAppSettings(i.id);if(c){t({appSettings:c}),console.log(" Loaded app settings from Firestore");return}}const a={id:"default",theme:"system",fontSize:"medium",enableMoveableReorder:!0,paymentSources:[]};i&&(a.userId=i.id),t({appSettings:a}),console.log(" Initialized default app settings")}catch(n){console.error(" initializeAppSettings failed:",n),t({error:n instanceof Error?n.message:"Failed to initialize settings"})}},updatePiggybankContribution:async(n,r)=>{try{t({isLoading:!0,error:null}),console.log(" Updating piggybank contribution:",{envelopeId:n,newAmount:r});const a=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");const o=e().envelopes.find(u=>u.id===n&&u.isPiggybank);if(!o)throw new Error("Piggybank not found");const c={...o,lastUpdated:new Date().toISOString(),piggybankConfig:{monthlyContribution:r,targetAmount:o.piggybankConfig?.targetAmount,color:o.piggybankConfig?.color,icon:o.piggybankConfig?.icon,paused:o.piggybankConfig?.paused??!1}};if(console.log(" Updating envelope in Firestore:",c),await fn.updateEnvelope(a.id,c),console.log(" Envelope updated successfully"),t(u=>({envelopes:u.envelopes.map(d=>d.id===n?c:d),isLoading:!1})),!o.piggybankConfig?.paused)try{await e().setEnvelopeAllocation(n,r),setTimeout(()=>{e().transactions.find(d=>d.envelopeId===n&&(d.description==="Monthly Allocation"||d.description==="Piggybank Contribution"))||console.warn(" Piggybank contribution transaction not found after update")},1e3)}catch(u){console.error(" Failed to update piggybank contribution:",u)}console.log(" Piggybank contribution updated successfully")}catch(i){throw console.error(" updatePiggybankContribution failed:",i),t({isLoading:!1,error:i instanceof Error?i.message:"Failed to update piggybank contribution"}),i}},addIncomeSource:async(n,r)=>{try{t({isLoading:!0,error:null});const a=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");console.log(" Adding income source:",{month:n,source:r});const o=await fn.createIncomeSource({...r,userId:a.id,month:n});t(c=>{const u=c.incomeSources[n]||[];return u.some(h=>h.id===o.id)?{isLoading:!1}:{incomeSources:{...c.incomeSources,[n]:[...u,o]},isLoading:!1}}),console.log(" Added income source:",o.id)}catch(i){throw console.error(" addIncomeSource failed:",i),t({isLoading:!1,error:i instanceof Error?i.message:"Failed to add income source"}),i}},updateIncomeSource:async(n,r)=>{try{t({isLoading:!0,error:null}),console.log(" Updating income source:",{month:n,sourceId:r.id}),t(o=>({incomeSources:{...o.incomeSources,[n]:o.incomeSources[n]?.map(c=>c.id===r.id?{...r,updatedAt:new Date().toISOString()}:c)||[]},isLoading:!1}));const a=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!a)return;await fn.updateIncomeSource(a.id,r.id,n,r),console.log(" Updated income source:",r.id)}catch(i){throw console.error(" updateIncomeSource failed:",i),t({isLoading:!1,error:i instanceof Error?i.message:"Failed to update income source"}),i}},deleteIncomeSource:async(n,r)=>{try{t({isLoading:!0,error:null}),console.log(" Deleting income source:",{month:n,sourceId:r}),t(o=>({incomeSources:{...o.incomeSources,[n]:o.incomeSources[n]?.filter(c=>c.id!==r)||[]},isLoading:!1}));const a=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!a)return;await fn.deleteIncomeSource(a.id,r,n),console.log(" Deleted income source:",r)}catch(i){throw console.error(" deleteIncomeSource failed:",i),t({isLoading:!1,error:i instanceof Error?i.message:"Failed to delete income source"}),i}},copyPreviousMonthAllocations:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(w=>w.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");console.log(" Copying allocations from previous month:",n);const[a,o]=n.split("-").map(Number);let c=a,u=o-1;u<1&&(c=a-1,u=12);const d=`${c}-${String(u).padStart(2,"0")}`;(!e().incomeSources[d]||!e().allocations[d])&&(console.log(` Previous month ${d} data missing, fetching...`),await e().fetchMonthData(d));const h=e().incomeSources[d]||[];if(console.log(` Found ${h.length} income sources from ${d}`),h.length>0){for(const w of h){const{id:E,...S}=w;await e().addIncomeSource(n,S)}console.log(` Copied ${h.length} income sources to ${n}`)}const p=e().allocations[d]||[];console.log(` Found ${p.length} allocations from ${d}`);const m=p.filter(w=>{const E=e().envelopes.find(S=>S.id===w.envelopeId);return!!E&&!E.isPiggybank});if(m.length>0){for(const w of m)await e().createEnvelopeAllocation({envelopeId:w.envelopeId,budgetedAmount:w.budgetedAmount,userId:i.id,month:n,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),w.budgetedAmount>0&&await e().addTransaction({description:"Budgeted",amount:w.budgetedAmount,envelopeId:w.envelopeId,type:"Income",month:n,date:`${n}-01T00:00:00`,reconciled:!1,isAutomatic:!0});console.log(` Copied ${m.length} regular allocations to ${n}`)}const b=e().envelopes.filter(w=>w.isPiggybank);console.log(` Processing ${b.length} piggybanks for ${n}`);for(const w of b){const E=w.piggybankConfig?.monthlyContribution,S=w.piggybankConfig?.paused??!1;if(!S&&E&&E>0)try{console.log(` Setting piggybank allocation for ${w.name}: ${E}`),await e().setEnvelopeAllocation(w.id,E)}catch(T){console.error(` Failed to set allocation for piggybank ${w.name}:`,T)}else console.log(` Skipping piggybank ${w.name} (paused=${S}, contribution=${E})`)}t({isLoading:!1}),console.log(` Complete monthly setup copied to ${n}`)}catch(r){throw console.error(" copyPreviousMonthAllocations failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to copy allocations"}),r}},setEnvelopeAllocation:async(n,r)=>{try{t({isLoading:!0,error:null});const a=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(h=>h.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");const o=e().currentMonth,c=e().envelopes.find(h=>h.id===n);if(!c){console.error(` setEnvelopeAllocation: Envelope ${n} not found in store! Aborting.`),t({isLoading:!1});return}const u=!!c.isPiggybank;console.log(` setEnvelopeAllocation called: envelopeId=${n}, amount=${r}, currentMonth=${o}, isPiggybank=${u}`);const d=e().allocations[o]?.find(h=>h.envelopeId===n);if(d?await e().updateEnvelopeAllocation(d.id,{budgetedAmount:r}):await e().createEnvelopeAllocation({envelopeId:n,budgetedAmount:r,userId:a.id,month:o,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),u&&r>0&&!c?.piggybankConfig?.paused){const h=e().transactions.find(p=>p.envelopeId===n&&p.month===o&&(p.description==="Monthly Allocation"||p.description==="Piggybank Contribution"));if(h){const p={...h,amount:r,description:"Piggybank Contribution"};await e().updateTransaction(p)}else{const p={description:"Piggybank Contribution",amount:r,envelopeId:n,type:"Income",month:o,date:`${o}-01T00:00:00`,reconciled:!1,isAutomatic:!0};await e().addTransaction(p)}}if(!u&&r>0){const h=e().transactions.find(p=>p.envelopeId===n&&p.month===o&&(p.description==="Monthly Budget Allocation"||p.description==="Budgeted"));if(h){const p={...h,amount:r,description:"Budgeted"};await e().updateTransaction(p)}else{const p={description:"Budgeted",amount:r,envelopeId:n,type:"Income",month:o,date:`${o}-01T00:00:00`,reconciled:!1,isAutomatic:!0};await e().addTransaction(p)}}console.log(" Envelope allocation set successfully")}catch(i){throw console.error(" setEnvelopeAllocation failed:",i),t({isLoading:!1,error:i instanceof Error?i.message:"Failed to set envelope allocation"}),i}},createEnvelopeAllocation:async n=>{try{const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=e().currentMonth,o=await fn.createEnvelopeAllocation({envelopeId:n.envelopeId,budgetedAmount:n.budgetedAmount,userId:i.id,month:a});t(c=>{const u=c.allocations[a]||[];return u.some(h=>h.id===o.id)?{isLoading:!1}:{allocations:{...c.allocations,[a]:[...u,o]},isLoading:!1}}),console.log(" Created envelope allocation:",o.id)}catch(r){throw console.error(" createEnvelopeAllocation failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to create envelope allocation"}),r}},updateEnvelopeAllocation:async(n,r)=>{try{console.log(" Updating envelope allocation:",{id:n,updates:r});const i=e().currentMonth,o=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(h=>h.useAuthStore.getState())).currentUser;if(!o)throw new Error("No authenticated user found");const c=e().allocations[i]?.find(h=>h.id===n);if(!c)throw new Error("Allocation not found");const u=e().envelopes.find(h=>h.id===c.envelopeId),d=u?.isPiggybank;if(await fn.updateEnvelopeAllocation(o.id,c.envelopeId,i,{budgetedAmount:r.budgetedAmount}),t(h=>({allocations:{...h.allocations,[i]:h.allocations[i]?.map(p=>p.id===n?{...p,...r,updatedAt:new Date().toISOString()}:p)||[]},isLoading:!1})),d&&r.budgetedAmount!==void 0){const h=e().transactions.find(p=>p.envelopeId===c.envelopeId&&p.month===i&&(p.description==="Monthly Allocation"||p.description==="Piggybank Contribution"));h?r.budgetedAmount>0&&!u?.piggybankConfig?.paused?await e().updateTransaction({...h,amount:r.budgetedAmount,description:"Piggybank Contribution"}):(r.budgetedAmount===0||u?.piggybankConfig?.paused)&&await e().deleteTransaction(h.id):r.budgetedAmount>0&&!u?.piggybankConfig?.paused&&await e().addTransaction({description:"Piggybank Contribution",amount:r.budgetedAmount,envelopeId:c.envelopeId,type:"Income",month:i,date:`${i}-01T00:00:00`,reconciled:!1,isAutomatic:!0})}if(!d&&r.budgetedAmount!==void 0){const h=e().transactions.find(p=>p.envelopeId===c.envelopeId&&p.month===i&&(p.description==="Monthly Budget Allocation"||p.description==="Budgeted"));h?r.budgetedAmount>0?await e().updateTransaction({...h,amount:r.budgetedAmount,description:"Budgeted"}):r.budgetedAmount===0&&await e().deleteTransaction(h.id):r.budgetedAmount>0&&await e().addTransaction({description:"Budgeted",amount:r.budgetedAmount,envelopeId:c.envelopeId,type:"Income",month:i,date:`${i}-01T00:00:00`,reconciled:!1,isAutomatic:!0})}console.log(" Updated envelope allocation:",n)}catch(i){throw console.error(" updateEnvelopeAllocation failed:",i),t({isLoading:!1,error:i instanceof Error?i.message:"Failed to update envelope allocation"}),i}},deleteEnvelopeAllocation:async n=>{try{console.log(" Deleting envelope allocation:",n);const r=e().currentMonth,i=e().allocations[r]?.find(c=>c.id===n);if(!i){console.warn("Allocation not found in store, skipping delete");return}const o=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!o)throw new Error("No authenticated user found");await fn.deleteEnvelopeAllocation(o.id,i.envelopeId,r),t(c=>({allocations:{...c.allocations,[r]:c.allocations[r]?.filter(u=>u.id!==n)||[]},isLoading:!1})),console.log(" Deleted envelope allocation:",n)}catch(r){throw console.error(" deleteEnvelopeAllocation failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete envelope allocation"}),r}},refreshAvailableToBudget:async()=>{try{const n=e().currentMonth,r=e().allocations[n]||[],i=e().incomeSources[n]||[],a=r.reduce((u,d)=>u+d.budgetedAmount,0);return i.reduce((u,d)=>u+d.amount,0)-a}catch(n){throw console.error(" refreshAvailableToBudget failed:",n),t({error:n instanceof Error?n.message:"Failed to refresh available to budget"}),n}},updateOnlineStatus:async()=>{try{const n=typeof navigator<"u"?navigator.onLine:!0;t({isOnline:n}),console.log(" Online status updated:",n)}catch(n){console.error(" Failed to update online status:",n)}},handleUserLogout:()=>{console.log(" Clearing user data on logout"),t({envelopes:[],transactions:[],categories:[],incomeSources:{},allocations:{},isOnboardingActive:!1,isOnboardingCompleted:!1,isLoading:!1,error:null})}}),{name:"budget-storage",partialize:t=>({envelopes:t.envelopes,transactions:t.transactions,categories:t.categories,appSettings:t.appSettings,incomeSources:t.incomeSources,allocations:t.allocations,currentMonth:t.currentMonth,isOnline:t.isOnline})})));pJ({useBudgetStore:Qt,useAuthStore:Ai,getCurrentUserId:pm});const gJ=Object.freeze(Object.defineProperty({__proto__:null,useBudgetStore:Qt},Symbol.toStringTag,{value:"Module"}));var vu=9e15,sl=1e9,G1="0123456789abcdef",o0="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",l0="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",H1={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-vu,maxE:vu,crypto:!1},b3,bs,tt=!0,lv="[DecimalError] ",Jo=lv+"Invalid argument: ",x3=lv+"Precision limit exceeded",w3=lv+"crypto unavailable",_3="[object Decimal]",pr=Math.floor,Bn=Math.pow,mJ=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,vJ=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,yJ=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,E3=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Zi=1e7,We=7,bJ=9007199254740991,xJ=o0.length-1,q1=l0.length-1,Te={toStringTag:_3};Te.absoluteValue=Te.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),$e(t)};Te.ceil=function(){return $e(new this.constructor(this),this.e+1,2)};Te.clampedTo=Te.clamp=function(t,e){var n,r=this,i=r.constructor;if(t=new i(t),e=new i(e),!t.s||!e.s)return new i(NaN);if(t.gt(e))throw Error(Jo+e);return n=r.cmp(t),n<0?t:r.cmp(e)>0?e:new i(r)};Te.comparedTo=Te.cmp=function(t){var e,n,r,i,a=this,o=a.d,c=(t=new a.constructor(t)).d,u=a.s,d=t.s;if(!o||!c)return!u||!d?NaN:u!==d?u:o===c?0:!o^u<0?1:-1;if(!o[0]||!c[0])return o[0]?u:c[0]?-d:0;if(u!==d)return u;if(a.e!==t.e)return a.e>t.e^u<0?1:-1;for(r=o.length,i=c.length,e=0,n=r<i?r:i;e<n;++e)if(o[e]!==c[e])return o[e]>c[e]^u<0?1:-1;return r===i?0:r>i^u<0?1:-1};Te.cosine=Te.cos=function(){var t,e,n=this,r=n.constructor;return n.d?n.d[0]?(t=r.precision,e=r.rounding,r.precision=t+Math.max(n.e,n.sd())+We,r.rounding=1,n=wJ(r,k3(r,n)),r.precision=t,r.rounding=e,$e(bs==2||bs==3?n.neg():n,t,e,!0)):new r(1):new r(NaN)};Te.cubeRoot=Te.cbrt=function(){var t,e,n,r,i,a,o,c,u,d,h=this,p=h.constructor;if(!h.isFinite()||h.isZero())return new p(h);for(tt=!1,a=h.s*Bn(h.s*h,1/3),!a||Math.abs(a)==1/0?(n=ir(h.d),t=h.e,(a=(t-n.length+1)%3)&&(n+=a==1||a==-2?"0":"00"),a=Bn(n,1/3),t=pr((t+1)/3)-(t%3==(t<0?-1:2)),a==1/0?n="5e"+t:(n=a.toExponential(),n=n.slice(0,n.indexOf("e")+1)+t),r=new p(n),r.s=h.s):r=new p(a.toString()),o=(t=p.precision)+3;;)if(c=r,u=c.times(c).times(c),d=u.plus(h),r=qt(d.plus(h).times(c),d.plus(u),o+2,1),ir(c.d).slice(0,o)===(n=ir(r.d)).slice(0,o))if(n=n.slice(o-3,o+1),n=="9999"||!i&&n=="4999"){if(!i&&($e(c,t+1,0),c.times(c).times(c).eq(h))){r=c;break}o+=4,i=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&($e(r,t+1,1),e=!r.times(r).times(r).eq(h));break}return tt=!0,$e(r,t,p.rounding,e)};Te.decimalPlaces=Te.dp=function(){var t,e=this.d,n=NaN;if(e){if(t=e.length-1,n=(t-pr(this.e/We))*We,t=e[t],t)for(;t%10==0;t/=10)n--;n<0&&(n=0)}return n};Te.dividedBy=Te.div=function(t){return qt(this,new this.constructor(t))};Te.dividedToIntegerBy=Te.divToInt=function(t){var e=this,n=e.constructor;return $e(qt(e,new n(t),0,1,1),n.precision,n.rounding)};Te.equals=Te.eq=function(t){return this.cmp(t)===0};Te.floor=function(){return $e(new this.constructor(this),this.e+1,3)};Te.greaterThan=Te.gt=function(t){return this.cmp(t)>0};Te.greaterThanOrEqualTo=Te.gte=function(t){var e=this.cmp(t);return e==1||e===0};Te.hyperbolicCosine=Te.cosh=function(){var t,e,n,r,i,a=this,o=a.constructor,c=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return c;n=o.precision,r=o.rounding,o.precision=n+Math.max(a.e,a.sd())+4,o.rounding=1,i=a.d.length,i<32?(t=Math.ceil(i/3),e=(1/uv(4,t)).toString()):(t=16,e="2.3283064365386962890625e-10"),a=Fu(o,1,a.times(e),new o(1),!0);for(var u,d=t,h=new o(8);d--;)u=a.times(a),a=c.minus(u.times(h.minus(u.times(h))));return $e(a,o.precision=n,o.rounding=r,!0)};Te.hyperbolicSine=Te.sinh=function(){var t,e,n,r,i=this,a=i.constructor;if(!i.isFinite()||i.isZero())return new a(i);if(e=a.precision,n=a.rounding,a.precision=e+Math.max(i.e,i.sd())+4,a.rounding=1,r=i.d.length,r<3)i=Fu(a,2,i,i,!0);else{t=1.4*Math.sqrt(r),t=t>16?16:t|0,i=i.times(1/uv(5,t)),i=Fu(a,2,i,i,!0);for(var o,c=new a(5),u=new a(16),d=new a(20);t--;)o=i.times(i),i=i.times(c.plus(o.times(u.times(o).plus(d))))}return a.precision=e,a.rounding=n,$e(i,e,n,!0)};Te.hyperbolicTangent=Te.tanh=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+7,r.rounding=1,qt(n.sinh(),n.cosh(),r.precision=t,r.rounding=e)):new r(n.s)};Te.inverseCosine=Te.acos=function(){var t=this,e=t.constructor,n=t.abs().cmp(1),r=e.precision,i=e.rounding;return n!==-1?n===0?t.isNeg()?Ra(e,r,i):new e(0):new e(NaN):t.isZero()?Ra(e,r+4,i).times(.5):(e.precision=r+6,e.rounding=1,t=new e(1).minus(t).div(t.plus(1)).sqrt().atan(),e.precision=r,e.rounding=i,t.times(2))};Te.inverseHyperbolicCosine=Te.acosh=function(){var t,e,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(t=r.precision,e=r.rounding,r.precision=t+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,tt=!1,n=n.times(n).minus(1).sqrt().plus(n),tt=!0,r.precision=t,r.rounding=e,n.ln()):new r(n)};Te.inverseHyperbolicSine=Te.asinh=function(){var t,e,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,tt=!1,n=n.times(n).plus(1).sqrt().plus(n),tt=!0,r.precision=t,r.rounding=e,n.ln())};Te.inverseHyperbolicTangent=Te.atanh=function(){var t,e,n,r,i=this,a=i.constructor;return i.isFinite()?i.e>=0?new a(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(t=a.precision,e=a.rounding,r=i.sd(),Math.max(r,t)<2*-i.e-1?$e(new a(i),t,e,!0):(a.precision=n=r-i.e,i=qt(i.plus(1),new a(1).minus(i),n+t,1),a.precision=t+4,a.rounding=1,i=i.ln(),a.precision=t,a.rounding=e,i.times(.5))):new a(NaN)};Te.inverseSine=Te.asin=function(){var t,e,n,r,i=this,a=i.constructor;return i.isZero()?new a(i):(e=i.abs().cmp(1),n=a.precision,r=a.rounding,e!==-1?e===0?(t=Ra(a,n+4,r).times(.5),t.s=i.s,t):new a(NaN):(a.precision=n+6,a.rounding=1,i=i.div(new a(1).minus(i.times(i)).sqrt().plus(1)).atan(),a.precision=n,a.rounding=r,i.times(2)))};Te.inverseTangent=Te.atan=function(){var t,e,n,r,i,a,o,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding;if(d.isFinite()){if(d.isZero())return new h(d);if(d.abs().eq(1)&&p+4<=q1)return o=Ra(h,p+4,m).times(.25),o.s=d.s,o}else{if(!d.s)return new h(NaN);if(p+4<=q1)return o=Ra(h,p+4,m).times(.5),o.s=d.s,o}for(h.precision=c=p+10,h.rounding=1,n=Math.min(28,c/We+2|0),t=n;t;--t)d=d.div(d.times(d).plus(1).sqrt().plus(1));for(tt=!1,e=Math.ceil(c/We),r=1,u=d.times(d),o=new h(d),i=d;t!==-1;)if(i=i.times(u),a=o.minus(i.div(r+=2)),i=i.times(u),o=a.plus(i.div(r+=2)),o.d[e]!==void 0)for(t=e;o.d[t]===a.d[t]&&t--;);return n&&(o=o.times(2<<n-1)),tt=!0,$e(o,h.precision=p,h.rounding=m,!0)};Te.isFinite=function(){return!!this.d};Te.isInteger=Te.isInt=function(){return!!this.d&&pr(this.e/We)>this.d.length-2};Te.isNaN=function(){return!this.s};Te.isNegative=Te.isNeg=function(){return this.s<0};Te.isPositive=Te.isPos=function(){return this.s>0};Te.isZero=function(){return!!this.d&&this.d[0]===0};Te.lessThan=Te.lt=function(t){return this.cmp(t)<0};Te.lessThanOrEqualTo=Te.lte=function(t){return this.cmp(t)<1};Te.logarithm=Te.log=function(t){var e,n,r,i,a,o,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding,b=5;if(t==null)t=new h(10),e=!0;else{if(t=new h(t),n=t.d,t.s<0||!n||!n[0]||t.eq(1))return new h(NaN);e=t.eq(10)}if(n=d.d,d.s<0||!n||!n[0]||d.eq(1))return new h(n&&!n[0]?-1/0:d.s!=1?NaN:n?0:1/0);if(e)if(n.length>1)a=!0;else{for(i=n[0];i%10===0;)i/=10;a=i!==1}if(tt=!1,c=p+b,o=Mo(d,c),r=e?c0(h,c+10):Mo(t,c),u=qt(o,r,c,1),vh(u.d,i=p,m))do if(c+=10,o=Mo(d,c),r=e?c0(h,c+10):Mo(t,c),u=qt(o,r,c,1),!a){+ir(u.d).slice(i+1,i+15)+1==1e14&&(u=$e(u,p+1,0));break}while(vh(u.d,i+=10,m));return tt=!0,$e(u,p,m)};Te.minus=Te.sub=function(t){var e,n,r,i,a,o,c,u,d,h,p,m,b=this,w=b.constructor;if(t=new w(t),!b.d||!t.d)return!b.s||!t.s?t=new w(NaN):b.d?t.s=-t.s:t=new w(t.d||b.s!==t.s?b:NaN),t;if(b.s!=t.s)return t.s=-t.s,b.plus(t);if(d=b.d,m=t.d,c=w.precision,u=w.rounding,!d[0]||!m[0]){if(m[0])t.s=-t.s;else if(d[0])t=new w(b);else return new w(u===3?-0:0);return tt?$e(t,c,u):t}if(n=pr(t.e/We),h=pr(b.e/We),d=d.slice(),a=h-n,a){for(p=a<0,p?(e=d,a=-a,o=m.length):(e=m,n=h,o=d.length),r=Math.max(Math.ceil(c/We),o)+2,a>r&&(a=r,e.length=1),e.reverse(),r=a;r--;)e.push(0);e.reverse()}else{for(r=d.length,o=m.length,p=r<o,p&&(o=r),r=0;r<o;r++)if(d[r]!=m[r]){p=d[r]<m[r];break}a=0}for(p&&(e=d,d=m,m=e,t.s=-t.s),o=d.length,r=m.length-o;r>0;--r)d[o++]=0;for(r=m.length;r>a;){if(d[--r]<m[r]){for(i=r;i&&d[--i]===0;)d[i]=Zi-1;--d[i],d[r]+=Zi}d[r]-=m[r]}for(;d[--o]===0;)d.pop();for(;d[0]===0;d.shift())--n;return d[0]?(t.d=d,t.e=cv(d,n),tt?$e(t,c,u):t):new w(u===3?-0:0)};Te.modulo=Te.mod=function(t){var e,n=this,r=n.constructor;return t=new r(t),!n.d||!t.s||t.d&&!t.d[0]?new r(NaN):!t.d||n.d&&!n.d[0]?$e(new r(n),r.precision,r.rounding):(tt=!1,r.modulo==9?(e=qt(n,t.abs(),0,3,1),e.s*=t.s):e=qt(n,t,0,r.modulo,1),e=e.times(t),tt=!0,n.minus(e))};Te.naturalExponential=Te.exp=function(){return Y1(this)};Te.naturalLogarithm=Te.ln=function(){return Mo(this)};Te.negated=Te.neg=function(){var t=new this.constructor(this);return t.s=-t.s,$e(t)};Te.plus=Te.add=function(t){var e,n,r,i,a,o,c,u,d,h,p=this,m=p.constructor;if(t=new m(t),!p.d||!t.d)return!p.s||!t.s?t=new m(NaN):p.d||(t=new m(t.d||p.s===t.s?p:NaN)),t;if(p.s!=t.s)return t.s=-t.s,p.minus(t);if(d=p.d,h=t.d,c=m.precision,u=m.rounding,!d[0]||!h[0])return h[0]||(t=new m(p)),tt?$e(t,c,u):t;if(a=pr(p.e/We),r=pr(t.e/We),d=d.slice(),i=a-r,i){for(i<0?(n=d,i=-i,o=h.length):(n=h,r=a,o=d.length),a=Math.ceil(c/We),o=a>o?a+1:o+1,i>o&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(o=d.length,i=h.length,o-i<0&&(i=o,n=h,h=d,d=n),e=0;i;)e=(d[--i]=d[i]+h[i]+e)/Zi|0,d[i]%=Zi;for(e&&(d.unshift(e),++r),o=d.length;d[--o]==0;)d.pop();return t.d=d,t.e=cv(d,r),tt?$e(t,c,u):t};Te.precision=Te.sd=function(t){var e,n=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Jo+t);return n.d?(e=S3(n.d),t&&n.e+1>e&&(e=n.e+1)):e=NaN,e};Te.round=function(){var t=this,e=t.constructor;return $e(new e(t),t.e+1,e.rounding)};Te.sine=Te.sin=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+Math.max(n.e,n.sd())+We,r.rounding=1,n=EJ(r,k3(r,n)),r.precision=t,r.rounding=e,$e(bs>2?n.neg():n,t,e,!0)):new r(NaN)};Te.squareRoot=Te.sqrt=function(){var t,e,n,r,i,a,o=this,c=o.d,u=o.e,d=o.s,h=o.constructor;if(d!==1||!c||!c[0])return new h(!d||d<0&&(!c||c[0])?NaN:c?o:1/0);for(tt=!1,d=Math.sqrt(+o),d==0||d==1/0?(e=ir(c),(e.length+u)%2==0&&(e+="0"),d=Math.sqrt(e),u=pr((u+1)/2)-(u<0||u%2),d==1/0?e="5e"+u:(e=d.toExponential(),e=e.slice(0,e.indexOf("e")+1)+u),r=new h(e)):r=new h(d.toString()),n=(u=h.precision)+3;;)if(a=r,r=a.plus(qt(o,a,n+2,1)).times(.5),ir(a.d).slice(0,n)===(e=ir(r.d)).slice(0,n))if(e=e.slice(n-3,n+1),e=="9999"||!i&&e=="4999"){if(!i&&($e(a,u+1,0),a.times(a).eq(o))){r=a;break}n+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&($e(r,u+1,1),t=!r.times(r).eq(o));break}return tt=!0,$e(r,u,h.rounding,t)};Te.tangent=Te.tan=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+10,r.rounding=1,n=n.sin(),n.s=1,n=qt(n,new r(1).minus(n.times(n)).sqrt(),t+10,0),r.precision=t,r.rounding=e,$e(bs==2||bs==4?n.neg():n,t,e,!0)):new r(NaN)};Te.times=Te.mul=function(t){var e,n,r,i,a,o,c,u,d,h=this,p=h.constructor,m=h.d,b=(t=new p(t)).d;if(t.s*=h.s,!m||!m[0]||!b||!b[0])return new p(!t.s||m&&!m[0]&&!b||b&&!b[0]&&!m?NaN:!m||!b?t.s/0:t.s*0);for(n=pr(h.e/We)+pr(t.e/We),u=m.length,d=b.length,u<d&&(a=m,m=b,b=a,o=u,u=d,d=o),a=[],o=u+d,r=o;r--;)a.push(0);for(r=d;--r>=0;){for(e=0,i=u+r;i>r;)c=a[i]+b[r]*m[i-r-1]+e,a[i--]=c%Zi|0,e=c/Zi|0;a[i]=(a[i]+e)%Zi|0}for(;!a[--o];)a.pop();return e?++n:a.shift(),t.d=a,t.e=cv(a,n),tt?$e(t,p.precision,p.rounding):t};Te.toBinary=function(t,e){return RE(this,2,t,e)};Te.toDecimalPlaces=Te.toDP=function(t,e){var n=this,r=n.constructor;return n=new r(n),t===void 0?n:(Fr(t,0,sl),e===void 0?e=r.rounding:Fr(e,0,8),$e(n,t+n.e+1,e))};Te.toExponential=function(t,e){var n,r=this,i=r.constructor;return t===void 0?n=$a(r,!0):(Fr(t,0,sl),e===void 0?e=i.rounding:Fr(e,0,8),r=$e(new i(r),t+1,e),n=$a(r,!0,t+1)),r.isNeg()&&!r.isZero()?"-"+n:n};Te.toFixed=function(t,e){var n,r,i=this,a=i.constructor;return t===void 0?n=$a(i):(Fr(t,0,sl),e===void 0?e=a.rounding:Fr(e,0,8),r=$e(new a(i),t+i.e+1,e),n=$a(r,!1,t+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n};Te.toFraction=function(t){var e,n,r,i,a,o,c,u,d,h,p,m,b=this,w=b.d,E=b.constructor;if(!w)return new E(b);if(d=n=new E(1),r=u=new E(0),e=new E(r),a=e.e=S3(w)-b.e-1,o=a%We,e.d[0]=Bn(10,o<0?We+o:o),t==null)t=a>0?e:d;else{if(c=new E(t),!c.isInt()||c.lt(d))throw Error(Jo+c);t=c.gt(e)?a>0?e:d:c}for(tt=!1,c=new E(ir(w)),h=E.precision,E.precision=a=w.length*We*2;p=qt(c,e,0,1,1),i=n.plus(p.times(r)),i.cmp(t)!=1;)n=r,r=i,i=d,d=u.plus(p.times(i)),u=i,i=e,e=c.minus(p.times(i)),c=i;return i=qt(t.minus(n),r,0,1,1),u=u.plus(i.times(d)),n=n.plus(i.times(r)),u.s=d.s=b.s,m=qt(d,r,a,1).minus(b).abs().cmp(qt(u,n,a,1).minus(b).abs())<1?[d,r]:[u,n],E.precision=h,tt=!0,m};Te.toHexadecimal=Te.toHex=function(t,e){return RE(this,16,t,e)};Te.toNearest=function(t,e){var n=this,r=n.constructor;if(n=new r(n),t==null){if(!n.d)return n;t=new r(1),e=r.rounding}else{if(t=new r(t),e===void 0?e=r.rounding:Fr(e,0,8),!n.d)return t.s?n:t;if(!t.d)return t.s&&(t.s=n.s),t}return t.d[0]?(tt=!1,n=qt(n,t,0,e,1).times(t),tt=!0,$e(n)):(t.s=n.s,n=t),n};Te.toNumber=function(){return+this};Te.toOctal=function(t,e){return RE(this,8,t,e)};Te.toPower=Te.pow=function(t){var e,n,r,i,a,o,c=this,u=c.constructor,d=+(t=new u(t));if(!c.d||!t.d||!c.d[0]||!t.d[0])return new u(Bn(+c,d));if(c=new u(c),c.eq(1))return c;if(r=u.precision,a=u.rounding,t.eq(1))return $e(c,r,a);if(e=pr(t.e/We),e>=t.d.length-1&&(n=d<0?-d:d)<=bJ)return i=T3(u,c,n,r),t.s<0?new u(1).div(i):$e(i,r,a);if(o=c.s,o<0){if(e<t.d.length-1)return new u(NaN);if((t.d[e]&1)==0&&(o=1),c.e==0&&c.d[0]==1&&c.d.length==1)return c.s=o,c}return n=Bn(+c,d),e=n==0||!isFinite(n)?pr(d*(Math.log("0."+ir(c.d))/Math.LN10+c.e+1)):new u(n+"").e,e>u.maxE+1||e<u.minE-1?new u(e>0?o/0:0):(tt=!1,u.rounding=c.s=1,n=Math.min(12,(e+"").length),i=Y1(t.times(Mo(c,r+n)),r),i.d&&(i=$e(i,r+5,1),vh(i.d,r,a)&&(e=r+10,i=$e(Y1(t.times(Mo(c,e+n)),e),e+5,1),+ir(i.d).slice(r+1,r+15)+1==1e14&&(i=$e(i,r+1,0)))),i.s=o,tt=!0,u.rounding=a,$e(i,r,a))};Te.toPrecision=function(t,e){var n,r=this,i=r.constructor;return t===void 0?n=$a(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(Fr(t,1,sl),e===void 0?e=i.rounding:Fr(e,0,8),r=$e(new i(r),t,e),n=$a(r,t<=r.e||r.e<=i.toExpNeg,t)),r.isNeg()&&!r.isZero()?"-"+n:n};Te.toSignificantDigits=Te.toSD=function(t,e){var n=this,r=n.constructor;return t===void 0?(t=r.precision,e=r.rounding):(Fr(t,1,sl),e===void 0?e=r.rounding:Fr(e,0,8)),$e(new r(n),t,e)};Te.toString=function(){var t=this,e=t.constructor,n=$a(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()&&!t.isZero()?"-"+n:n};Te.truncated=Te.trunc=function(){return $e(new this.constructor(this),this.e+1,1)};Te.valueOf=Te.toJSON=function(){var t=this,e=t.constructor,n=$a(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()?"-"+n:n};function ir(t){var e,n,r,i=t.length-1,a="",o=t[0];if(i>0){for(a+=o,e=1;e<i;e++)r=t[e]+"",n=We-r.length,n&&(a+=_o(n)),a+=r;o=t[e],r=o+"",n=We-r.length,n&&(a+=_o(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}function Fr(t,e,n){if(t!==~~t||t<e||t>n)throw Error(Jo+t)}function vh(t,e,n,r){var i,a,o,c;for(a=t[0];a>=10;a/=10)--e;return--e<0?(e+=We,i=0):(i=Math.ceil((e+1)/We),e%=We),a=Bn(10,We-e),c=t[i]%a|0,r==null?e<3?(e==0?c=c/100|0:e==1&&(c=c/10|0),o=n<4&&c==99999||n>3&&c==49999||c==5e4||c==0):o=(n<4&&c+1==a||n>3&&c+1==a/2)&&(t[i+1]/a/100|0)==Bn(10,e-2)-1||(c==a/2||c==0)&&(t[i+1]/a/100|0)==0:e<4?(e==0?c=c/1e3|0:e==1?c=c/100|0:e==2&&(c=c/10|0),o=(r||n<4)&&c==9999||!r&&n>3&&c==4999):o=((r||n<4)&&c+1==a||!r&&n>3&&c+1==a/2)&&(t[i+1]/a/1e3|0)==Bn(10,e-3)-1,o}function gm(t,e,n){for(var r,i=[0],a,o=0,c=t.length;o<c;){for(a=i.length;a--;)i[a]*=e;for(i[0]+=G1.indexOf(t.charAt(o++)),r=0;r<i.length;r++)i[r]>n-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/n|0,i[r]%=n)}return i.reverse()}function wJ(t,e){var n,r,i;if(e.isZero())return e;r=e.d.length,r<32?(n=Math.ceil(r/3),i=(1/uv(4,n)).toString()):(n=16,i="2.3283064365386962890625e-10"),t.precision+=n,e=Fu(t,1,e.times(i),new t(1));for(var a=n;a--;){var o=e.times(e);e=o.times(o).minus(o).times(8).plus(1)}return t.precision-=n,e}var qt=(function(){function t(r,i,a){var o,c=0,u=r.length;for(r=r.slice();u--;)o=r[u]*i+c,r[u]=o%a|0,c=o/a|0;return c&&r.unshift(c),r}function e(r,i,a,o){var c,u;if(a!=o)u=a>o?1:-1;else for(c=u=0;c<a;c++)if(r[c]!=i[c]){u=r[c]>i[c]?1:-1;break}return u}function n(r,i,a,o){for(var c=0;a--;)r[a]-=c,c=r[a]<i[a]?1:0,r[a]=c*o+r[a]-i[a];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,a,o,c,u){var d,h,p,m,b,w,E,S,T,C,N,j,P,M,A,k,D,V,L,U,O=r.constructor,J=r.s==i.s?1:-1,W=r.d,q=i.d;if(!W||!W[0]||!q||!q[0])return new O(!r.s||!i.s||(W?q&&W[0]==q[0]:!q)?NaN:W&&W[0]==0||!q?J*0:J/0);for(u?(b=1,h=r.e-i.e):(u=Zi,b=We,h=pr(r.e/b)-pr(i.e/b)),L=q.length,D=W.length,T=new O(J),C=T.d=[],p=0;q[p]==(W[p]||0);p++);if(q[p]>(W[p]||0)&&h--,a==null?(M=a=O.precision,o=O.rounding):c?M=a+(r.e-i.e)+1:M=a,M<0)C.push(1),w=!0;else{if(M=M/b+2|0,p=0,L==1){for(m=0,q=q[0],M++;(p<D||m)&&M--;p++)A=m*u+(W[p]||0),C[p]=A/q|0,m=A%q|0;w=m||p<D}else{for(m=u/(q[0]+1)|0,m>1&&(q=t(q,m,u),W=t(W,m,u),L=q.length,D=W.length),k=L,N=W.slice(0,L),j=N.length;j<L;)N[j++]=0;U=q.slice(),U.unshift(0),V=q[0],q[1]>=u/2&&++V;do m=0,d=e(q,N,L,j),d<0?(P=N[0],L!=j&&(P=P*u+(N[1]||0)),m=P/V|0,m>1?(m>=u&&(m=u-1),E=t(q,m,u),S=E.length,j=N.length,d=e(E,N,S,j),d==1&&(m--,n(E,L<S?U:q,S,u))):(m==0&&(d=m=1),E=q.slice()),S=E.length,S<j&&E.unshift(0),n(N,E,j,u),d==-1&&(j=N.length,d=e(q,N,L,j),d<1&&(m++,n(N,L<j?U:q,j,u))),j=N.length):d===0&&(m++,N=[0]),C[p++]=m,d&&N[0]?N[j++]=W[k]||0:(N=[W[k]],j=1);while((k++<D||N[0]!==void 0)&&M--);w=N[0]!==void 0}C[0]||C.shift()}if(b==1)T.e=h,b3=w;else{for(p=1,m=C[0];m>=10;m/=10)p++;T.e=p+h*b-1,$e(T,c?a+T.e+1:a,o,w)}return T}})();function $e(t,e,n,r){var i,a,o,c,u,d,h,p,m,b=t.constructor;e:if(e!=null){if(p=t.d,!p)return t;for(i=1,c=p[0];c>=10;c/=10)i++;if(a=e-i,a<0)a+=We,o=e,h=p[m=0],u=h/Bn(10,i-o-1)%10|0;else if(m=Math.ceil((a+1)/We),c=p.length,m>=c)if(r){for(;c++<=m;)p.push(0);h=u=0,i=1,a%=We,o=a-We+1}else break e;else{for(h=c=p[m],i=1;c>=10;c/=10)i++;a%=We,o=a-We+i,u=o<0?0:h/Bn(10,i-o-1)%10|0}if(r=r||e<0||p[m+1]!==void 0||(o<0?h:h%Bn(10,i-o-1)),d=n<4?(u||r)&&(n==0||n==(t.s<0?3:2)):u>5||u==5&&(n==4||r||n==6&&(a>0?o>0?h/Bn(10,i-o):0:p[m-1])%10&1||n==(t.s<0?8:7)),e<1||!p[0])return p.length=0,d?(e-=t.e+1,p[0]=Bn(10,(We-e%We)%We),t.e=-e||0):p[0]=t.e=0,t;if(a==0?(p.length=m,c=1,m--):(p.length=m+1,c=Bn(10,We-a),p[m]=o>0?(h/Bn(10,i-o)%Bn(10,o)|0)*c:0),d)for(;;)if(m==0){for(a=1,o=p[0];o>=10;o/=10)a++;for(o=p[0]+=c,c=1;o>=10;o/=10)c++;a!=c&&(t.e++,p[0]==Zi&&(p[0]=1));break}else{if(p[m]+=c,p[m]!=Zi)break;p[m--]=0,c=1}for(a=p.length;p[--a]===0;)p.pop()}return tt&&(t.e>b.maxE?(t.d=null,t.e=NaN):t.e<b.minE&&(t.e=0,t.d=[0])),t}function $a(t,e,n){if(!t.isFinite())return C3(t);var r,i=t.e,a=ir(t.d),o=a.length;return e?(n&&(r=n-o)>0?a=a.charAt(0)+"."+a.slice(1)+_o(r):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(t.e<0?"e":"e+")+t.e):i<0?(a="0."+_o(-i-1)+a,n&&(r=n-o)>0&&(a+=_o(r))):i>=o?(a+=_o(i+1-o),n&&(r=n-i-1)>0&&(a=a+"."+_o(r))):((r=i+1)<o&&(a=a.slice(0,r)+"."+a.slice(r)),n&&(r=n-o)>0&&(i+1===o&&(a+="."),a+=_o(r))),a}function cv(t,e){var n=t[0];for(e*=We;n>=10;n/=10)e++;return e}function c0(t,e,n){if(e>xJ)throw tt=!0,n&&(t.precision=n),Error(x3);return $e(new t(o0),e,1,!0)}function Ra(t,e,n){if(e>q1)throw Error(x3);return $e(new t(l0),e,n,!0)}function S3(t){var e=t.length-1,n=e*We+1;if(e=t[e],e){for(;e%10==0;e/=10)n--;for(e=t[0];e>=10;e/=10)n++}return n}function _o(t){for(var e="";t--;)e+="0";return e}function T3(t,e,n,r){var i,a=new t(1),o=Math.ceil(r/We+4);for(tt=!1;;){if(n%2&&(a=a.times(e),xN(a.d,o)&&(i=!0)),n=pr(n/2),n===0){n=a.d.length-1,i&&a.d[n]===0&&++a.d[n];break}e=e.times(e),xN(e.d,o)}return tt=!0,a}function bN(t){return t.d[t.d.length-1]&1}function A3(t,e,n){for(var r,i,a=new t(e[0]),o=0;++o<e.length;){if(i=new t(e[o]),!i.s){a=i;break}r=a.cmp(i),(r===n||r===0&&a.s===n)&&(a=i)}return a}function Y1(t,e){var n,r,i,a,o,c,u,d=0,h=0,p=0,m=t.constructor,b=m.rounding,w=m.precision;if(!t.d||!t.d[0]||t.e>17)return new m(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(e==null?(tt=!1,u=w):u=e,c=new m(.03125);t.e>-2;)t=t.times(c),p+=5;for(r=Math.log(Bn(2,p))/Math.LN10*2+5|0,u+=r,n=a=o=new m(1),m.precision=u;;){if(a=$e(a.times(t),u,1),n=n.times(++h),c=o.plus(qt(a,n,u,1)),ir(c.d).slice(0,u)===ir(o.d).slice(0,u)){for(i=p;i--;)o=$e(o.times(o),u,1);if(e==null)if(d<3&&vh(o.d,u-r,b,d))m.precision=u+=10,n=a=c=new m(1),h=0,d++;else return $e(o,m.precision=w,b,tt=!0);else return m.precision=w,o}o=c}}function Mo(t,e){var n,r,i,a,o,c,u,d,h,p,m,b=1,w=10,E=t,S=E.d,T=E.constructor,C=T.rounding,N=T.precision;if(E.s<0||!S||!S[0]||!E.e&&S[0]==1&&S.length==1)return new T(S&&!S[0]?-1/0:E.s!=1?NaN:S?0:E);if(e==null?(tt=!1,h=N):h=e,T.precision=h+=w,n=ir(S),r=n.charAt(0),Math.abs(a=E.e)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)E=E.times(t),n=ir(E.d),r=n.charAt(0),b++;a=E.e,r>1?(E=new T("0."+n),a++):E=new T(r+"."+n.slice(1))}else return d=c0(T,h+2,N).times(a+""),E=Mo(new T(r+"."+n.slice(1)),h-w).plus(d),T.precision=N,e==null?$e(E,N,C,tt=!0):E;for(p=E,u=o=E=qt(E.minus(1),E.plus(1),h,1),m=$e(E.times(E),h,1),i=3;;){if(o=$e(o.times(m),h,1),d=u.plus(qt(o,new T(i),h,1)),ir(d.d).slice(0,h)===ir(u.d).slice(0,h))if(u=u.times(2),a!==0&&(u=u.plus(c0(T,h+2,N).times(a+""))),u=qt(u,new T(b),h,1),e==null)if(vh(u.d,h-w,C,c))T.precision=h+=w,d=o=E=qt(p.minus(1),p.plus(1),h,1),m=$e(E.times(E),h,1),i=c=1;else return $e(u,T.precision=N,C,tt=!0);else return T.precision=N,u;u=d,i+=2}}function C3(t){return String(t.s*t.s/0)}function mm(t,e){var n,r,i;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),r=0;e.charCodeAt(r)===48;r++);for(i=e.length;e.charCodeAt(i-1)===48;--i);if(e=e.slice(r,i),e){if(i-=r,t.e=n=n-r-1,t.d=[],r=(n+1)%We,n<0&&(r+=We),r<i){for(r&&t.d.push(+e.slice(0,r)),i-=We;r<i;)t.d.push(+e.slice(r,r+=We));e=e.slice(r),r=We-e.length}else r-=i;for(;r--;)e+="0";t.d.push(+e),tt&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function _J(t,e){var n,r,i,a,o,c,u,d,h;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),E3.test(e))return mm(t,e)}else if(e==="Infinity"||e==="NaN")return+e||(t.s=NaN),t.e=NaN,t.d=null,t;if(vJ.test(e))n=16,e=e.toLowerCase();else if(mJ.test(e))n=2;else if(yJ.test(e))n=8;else throw Error(Jo+e);for(a=e.search(/p/i),a>0?(u=+e.slice(a+1),e=e.substring(2,a)):e=e.slice(2),a=e.indexOf("."),o=a>=0,r=t.constructor,o&&(e=e.replace(".",""),c=e.length,a=c-a,i=T3(r,new r(n),a,a*2)),d=gm(e,n,Zi),h=d.length-1,a=h;d[a]===0;--a)d.pop();return a<0?new r(t.s*0):(t.e=cv(d,h),t.d=d,tt=!1,o&&(t=qt(t,i,c*4)),u&&(t=t.times(Math.abs(u)<54?Bn(2,u):$u.pow(2,u))),tt=!0,t)}function EJ(t,e){var n,r=e.d.length;if(r<3)return e.isZero()?e:Fu(t,2,e,e);n=1.4*Math.sqrt(r),n=n>16?16:n|0,e=e.times(1/uv(5,n)),e=Fu(t,2,e,e);for(var i,a=new t(5),o=new t(16),c=new t(20);n--;)i=e.times(e),e=e.times(a.plus(i.times(o.times(i).minus(c))));return e}function Fu(t,e,n,r,i){var a,o,c,u,d=t.precision,h=Math.ceil(d/We);for(tt=!1,u=n.times(n),c=new t(r);;){if(o=qt(c.times(u),new t(e++*e++),d,1),c=i?r.plus(o):r.minus(o),r=qt(o.times(u),new t(e++*e++),d,1),o=c.plus(r),o.d[h]!==void 0){for(a=h;o.d[a]===c.d[a]&&a--;);if(a==-1)break}a=c,c=r,r=o,o=a}return tt=!0,o.d.length=h+1,o}function uv(t,e){for(var n=t;--e;)n*=t;return n}function k3(t,e){var n,r=e.s<0,i=Ra(t,t.precision,1),a=i.times(.5);if(e=e.abs(),e.lte(a))return bs=r?4:1,e;if(n=e.divToInt(i),n.isZero())bs=r?3:2;else{if(e=e.minus(n.times(i)),e.lte(a))return bs=bN(n)?r?2:3:r?4:1,e;bs=bN(n)?r?1:4:r?3:2}return e.minus(i).abs()}function RE(t,e,n,r){var i,a,o,c,u,d,h,p,m,b=t.constructor,w=n!==void 0;if(w?(Fr(n,1,sl),r===void 0?r=b.rounding:Fr(r,0,8)):(n=b.precision,r=b.rounding),!t.isFinite())h=C3(t);else{for(h=$a(t),o=h.indexOf("."),w?(i=2,e==16?n=n*4-3:e==8&&(n=n*3-2)):i=e,o>=0&&(h=h.replace(".",""),m=new b(1),m.e=h.length-o,m.d=gm($a(m),10,i),m.e=m.d.length),p=gm(h,10,i),a=u=p.length;p[--u]==0;)p.pop();if(!p[0])h=w?"0p+0":"0";else{if(o<0?a--:(t=new b(t),t.d=p,t.e=a,t=qt(t,m,n,r,0,i),p=t.d,a=t.e,d=b3),o=p[n],c=i/2,d=d||p[n+1]!==void 0,d=r<4?(o!==void 0||d)&&(r===0||r===(t.s<0?3:2)):o>c||o===c&&(r===4||d||r===6&&p[n-1]&1||r===(t.s<0?8:7)),p.length=n,d)for(;++p[--n]>i-1;)p[n]=0,n||(++a,p.unshift(1));for(u=p.length;!p[u-1];--u);for(o=0,h="";o<u;o++)h+=G1.charAt(p[o]);if(w){if(u>1)if(e==16||e==8){for(o=e==16?4:3,--u;u%o;u++)h+="0";for(p=gm(h,i,e),u=p.length;!p[u-1];--u);for(o=1,h="1.";o<u;o++)h+=G1.charAt(p[o])}else h=h.charAt(0)+"."+h.slice(1);h=h+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)h="0"+h;h="0."+h}else if(++a>u)for(a-=u;a--;)h+="0";else a<u&&(h=h.slice(0,a)+"."+h.slice(a))}h=(e==16?"0x":e==2?"0b":e==8?"0o":"")+h}return t.s<0?"-"+h:h}function xN(t,e){if(t.length>e)return t.length=e,!0}function SJ(t){return new this(t).abs()}function TJ(t){return new this(t).acos()}function AJ(t){return new this(t).acosh()}function CJ(t,e){return new this(t).plus(e)}function kJ(t){return new this(t).asin()}function RJ(t){return new this(t).asinh()}function NJ(t){return new this(t).atan()}function DJ(t){return new this(t).atanh()}function IJ(t,e){t=new this(t),e=new this(e);var n,r=this.precision,i=this.rounding,a=r+4;return!t.s||!e.s?n=new this(NaN):!t.d&&!e.d?(n=Ra(this,a,1).times(e.s>0?.25:.75),n.s=t.s):!e.d||t.isZero()?(n=e.s<0?Ra(this,r,i):new this(0),n.s=t.s):!t.d||e.isZero()?(n=Ra(this,a,1).times(.5),n.s=t.s):e.s<0?(this.precision=a,this.rounding=1,n=this.atan(qt(t,e,a,1)),e=Ra(this,a,1),this.precision=r,this.rounding=i,n=t.s<0?n.minus(e):n.plus(e)):n=this.atan(qt(t,e,a,1)),n}function MJ(t){return new this(t).cbrt()}function OJ(t){return $e(t=new this(t),t.e+1,2)}function PJ(t,e,n){return new this(t).clamp(e,n)}function jJ(t){if(!t||typeof t!="object")throw Error(lv+"Object expected");var e,n,r,i=t.defaults===!0,a=["precision",1,sl,"rounding",0,8,"toExpNeg",-vu,0,"toExpPos",0,vu,"maxE",0,vu,"minE",-vu,0,"modulo",0,9];for(e=0;e<a.length;e+=3)if(n=a[e],i&&(this[n]=H1[n]),(r=t[n])!==void 0)if(pr(r)===r&&r>=a[e+1]&&r<=a[e+2])this[n]=r;else throw Error(Jo+n+": "+r);if(n="crypto",i&&(this[n]=H1[n]),(r=t[n])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(w3);else this[n]=!1;else throw Error(Jo+n+": "+r);return this}function VJ(t){return new this(t).cos()}function zJ(t){return new this(t).cosh()}function R3(t){var e,n,r;function i(a){var o,c,u,d=this;if(!(d instanceof i))return new i(a);if(d.constructor=i,wN(a)){d.s=a.s,tt?!a.d||a.e>i.maxE?(d.e=NaN,d.d=null):a.e<i.minE?(d.e=0,d.d=[0]):(d.e=a.e,d.d=a.d.slice()):(d.e=a.e,d.d=a.d?a.d.slice():a.d);return}if(u=typeof a,u==="number"){if(a===0){d.s=1/a<0?-1:1,d.e=0,d.d=[0];return}if(a<0?(a=-a,d.s=-1):d.s=1,a===~~a&&a<1e7){for(o=0,c=a;c>=10;c/=10)o++;tt?o>i.maxE?(d.e=NaN,d.d=null):o<i.minE?(d.e=0,d.d=[0]):(d.e=o,d.d=[a]):(d.e=o,d.d=[a]);return}if(a*0!==0){a||(d.s=NaN),d.e=NaN,d.d=null;return}return mm(d,a.toString())}if(u==="string")return(c=a.charCodeAt(0))===45?(a=a.slice(1),d.s=-1):(c===43&&(a=a.slice(1)),d.s=1),E3.test(a)?mm(d,a):_J(d,a);if(u==="bigint")return a<0?(a=-a,d.s=-1):d.s=1,mm(d,a.toString());throw Error(Jo+a)}if(i.prototype=Te,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=jJ,i.clone=R3,i.isDecimal=wN,i.abs=SJ,i.acos=TJ,i.acosh=AJ,i.add=CJ,i.asin=kJ,i.asinh=RJ,i.atan=NJ,i.atanh=DJ,i.atan2=IJ,i.cbrt=MJ,i.ceil=OJ,i.clamp=PJ,i.cos=VJ,i.cosh=zJ,i.div=LJ,i.exp=BJ,i.floor=UJ,i.hypot=FJ,i.ln=$J,i.log=GJ,i.log10=qJ,i.log2=HJ,i.max=YJ,i.min=XJ,i.mod=WJ,i.mul=KJ,i.pow=QJ,i.random=ZJ,i.round=JJ,i.sign=eee,i.sin=tee,i.sinh=nee,i.sqrt=ree,i.sub=iee,i.sum=aee,i.tan=see,i.tanh=oee,i.trunc=lee,t===void 0&&(t={}),t&&t.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<r.length;)t.hasOwnProperty(n=r[e++])||(t[n]=this[n]);return i.config(t),i}function LJ(t,e){return new this(t).div(e)}function BJ(t){return new this(t).exp()}function UJ(t){return $e(t=new this(t),t.e+1,3)}function FJ(){var t,e,n=new this(0);for(tt=!1,t=0;t<arguments.length;)if(e=new this(arguments[t++]),e.d)n.d&&(n=n.plus(e.times(e)));else{if(e.s)return tt=!0,new this(1/0);n=e}return tt=!0,n.sqrt()}function wN(t){return t instanceof $u||t&&t.toStringTag===_3||!1}function $J(t){return new this(t).ln()}function GJ(t,e){return new this(t).log(e)}function HJ(t){return new this(t).log(2)}function qJ(t){return new this(t).log(10)}function YJ(){return A3(this,arguments,-1)}function XJ(){return A3(this,arguments,1)}function WJ(t,e){return new this(t).mod(e)}function KJ(t,e){return new this(t).mul(e)}function QJ(t,e){return new this(t).pow(e)}function ZJ(t){var e,n,r,i,a=0,o=new this(1),c=[];if(t===void 0?t=this.precision:Fr(t,1,sl),r=Math.ceil(t/We),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));a<r;)i=e[a],i>=429e7?e[a]=crypto.getRandomValues(new Uint32Array(1))[0]:c[a++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(r*=4);a<r;)i=e[a]+(e[a+1]<<8)+(e[a+2]<<16)+((e[a+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(e,a):(c.push(i%1e7),a+=4);a=r/4}else throw Error(w3);else for(;a<r;)c[a++]=Math.random()*1e7|0;for(r=c[--a],t%=We,r&&t&&(i=Bn(10,We-t),c[a]=(r/i|0)*i);c[a]===0;a--)c.pop();if(a<0)n=0,c=[0];else{for(n=-1;c[0]===0;n-=We)c.shift();for(r=1,i=c[0];i>=10;i/=10)r++;r<We&&(n-=We-r)}return o.e=n,o.d=c,o}function JJ(t){return $e(t=new this(t),t.e+1,this.rounding)}function eee(t){return t=new this(t),t.d?t.d[0]?t.s:0*t.s:t.s||NaN}function tee(t){return new this(t).sin()}function nee(t){return new this(t).sinh()}function ree(t){return new this(t).sqrt()}function iee(t,e){return new this(t).sub(e)}function aee(){var t=0,e=arguments,n=new this(e[t]);for(tt=!1;n.s&&++t<e.length;)n=n.plus(e[t]);return tt=!0,$e(n,this.precision,this.rounding)}function see(t){return new this(t).tan()}function oee(t){return new this(t).tanh()}function lee(t){return $e(t=new this(t),t.e+1,1)}Te[Symbol.for("nodejs.util.inspect.custom")]=Te.toString;Te[Symbol.toStringTag]="Decimal";var $u=Te.constructor=R3(H1);o0=new $u(o0);l0=new $u(l0);const _N=t=>{if(!t)return null;if(t instanceof Date)return t;if(typeof t=="object"&&typeof t.toDate=="function")return t.toDate();if(typeof t=="object"&&t.seconds!==void 0)return new Date(t.seconds*1e3);if(typeof t=="string"){const e=new Date(t);return isNaN(e.getTime())?null:e}if(typeof t=="number"){const e=new Date(t);return isNaN(e.getTime())?null:e}return null},cee=()=>{const{envelopes:t,transactions:e,fetchData:n,isLoading:r,isOnline:i,reorderEnvelopes:a}=Qt(),{currentUser:o}=Ai(),{currentMonth:c,incomeSources:u,allocations:d,deleteIncomeSource:h,setEnvelopeAllocation:p,copyPreviousMonthAllocations:m,isLoading:b}=Qt(),{showToast:w}=cc(),[E,S]=B.useState(!1),T=B.useRef(null),[C,N]=B.useState(!1),j=!C||r||b,[P,M]=B.useState([]),A=B.useRef([]),[k,D]=B.useState([]),V=B.useRef([]),L=B.useCallback(Q=>{if(t.find(le=>le.id===Q)?.isPiggybank){const le=Qt.getState().getEnvelopeBalance(Q);return new $u(le)}const ie=Qt.getState().getEnvelopeBalance(Q,c);return new $u(ie)},[t,c]);B.useEffect(()=>{const Q=t.filter(X=>{if(!X.isPiggybank||!X.isActive)return!1;if(X.createdAt)try{const ie=_N(X.createdAt);if(!ie)return console.error(` Invalid creation date for piggybank ${X.name}:`,X.createdAt),!1;const le=`${ie.getFullYear()}-${String(ie.getMonth()+1).padStart(2,"0")}`;return c>=le}catch(ie){return console.error(` Error processing piggybank ${X.name}:`,ie,{createdAt:X.createdAt,typeofCreatedAt:typeof X.createdAt}),!1}return!0}).sort((X,ie)=>{const le=X.orderIndex??0,ge=ie.orderIndex??0;return le-ge});D(Q),V.current=Q},[t,c]);const U=k,O=P;B.useEffect(()=>(T.current=setTimeout(()=>{S(!0)},8e3),n(),N(!0),()=>{T.current&&clearTimeout(T.current)}),[]),B.useEffect(()=>{C&&!r&&!b&&(S(!1),T.current&&clearTimeout(T.current))},[C,r,b]),B.useEffect(()=>{const Q=t.filter(X=>{if(X.isPiggybank||X.isActive===!1)return!1;const le=(d[c]||[]).some(pe=>pe.envelopeId===X.id),ge=e.some(pe=>pe.envelopeId===X.id&&(pe.month===c||pe.date.startsWith(c)));return le||ge}).sort((X,ie)=>{const le=X.orderIndex??0,ge=ie.orderIndex??0;return le-ge});M(Q),A.current=Q},[t,d,c,e]);const J=(u[c]||[]).reduce((Q,X)=>Q+X.amount,0),W=(d[c]||[]).filter(Q=>O.some(X=>X.id===Q.envelopeId)||U.some(X=>X.id===Q.envelopeId)).reduce((Q,X)=>Q+X.budgetedAmount,0),q=J-W,K=B.useCallback(async Q=>{if(!Q.length)return;const X=Q.map(ie=>ie.id);try{await a(X)}catch(ie){console.error("Failed to persist envelope order:",ie),w("Failed to save envelope order","error")}},[a,w]),te=B.useCallback(async Q=>{await K(Q)},[K]),se=B.useCallback(Q=>{h(c,Q.id).catch(console.error),w(`Deleted "${Q.name}"`,"neutral")},[h,c,w]),G=B.useCallback(async Q=>{try{const X=Q||c;console.log(" Copying to month:",X),await m(X),w("Previous month budget copied","success")}catch(X){console.error("Error copying previous month:",X),w("Failed to copy previous month","error")}},[m,w,c]),F=B.useCallback(async()=>{if(!o||!c){w("Cannot clear data: not logged in or no month selected","error");return}try{await Qt.getState().clearMonthData(c),w(`"${c}" budget and transactions cleared successfully`,"success")}catch(Q){console.error("Error clearing month data:",Q),w("Failed to clear month data","error")}},[o,c,w]),Y=B.useCallback(async(Q,X)=>{try{await p(Q,X),setTimeout(()=>{const ie=Qt.getState(),le=ie.currentMonth,ge=ie.incomeSources[le]||[],pe=ie.allocations[le]||[],_e=new Set(ie.envelopes.filter(Re=>{if(Re.isPiggybank){if(!Re.isActive)return!1;if(Re.createdAt){const De=_N(Re.createdAt);if(!De)return!1;const Ve=`${De.getFullYear()}-${String(De.getMonth()+1).padStart(2,"0")}`;return le>=Ve}return!0}return Re.isActive!==!1}).map(Re=>Re.id)),Ie=pe.filter(Re=>_e.has(Re.envelopeId)),ae=ge.reduce((Re,De)=>Re+De.amount,0),Ae=Ie.reduce((Re,De)=>Re+De.budgetedAmount,0);ae-Ae<-.005?w(`You can't spend more than you make.
You're not in Congress!`,"error"):Math.abs(ae-Ae)<.005&&ae>0&&w("Every dollar has a job ","success")},100)}catch(ie){console.error("Failed to set allocation:",ie),w("Failed to update budget","error")}},[p,w]);return{visibleEnvelopes:O,piggybanks:U,incomeSources:u,availableToBudget:q,currentMonth:c,allocations:d,transactions:e,isLoading:r,isInitialLoading:j,isOnline:i,showTimeoutMessage:E,getEnvelopeBalance:L,fetchData:n,reorderEnvelopes:te,deleteIncomeSource:se,clearMonthData:F,copyFromPreviousMonth:G,setEnvelopeAllocation:Y,localOrderRef:A,setLocalEnvelopes:M,localPiggybankOrderRef:V,setLocalPiggybanks:D}},uee=({currentMonth:t,onMonthChange:e,budgetStatus:n})=>{const[r,i]=t.split("-").map(Number),o=["January","February","March","April","May","June","July","August","September","October","November","December"][i-1],c=()=>{let p=r,m=i-1;m<1&&(p=r-1,m=12);const b=`${p}-${m.toString().padStart(2,"0")}`;e(b)},u=()=>{let p=r,m=i+1;m>12&&(p=r+1,m=1);const b=`${p}-${m.toString().padStart(2,"0")}`;e(b)},d=()=>{const p=new Date,m=`${p.getFullYear()}-${(p.getMonth()+1).toString().padStart(2,"0")}`;e(m)},h=()=>{if(!n)return null;const{amount:p,totalIncome:m,totalAllocated:b}=n,w=typeof p=="number"?p:0,E=typeof m=="number"?m:0,S=typeof b=="number"?b:0,T=Math.abs(w)<.005,C=w<-.005,N=E>0?S/E*100:0;let j="text-gray-900 dark:text-white",P="bg-green-500",M="Left to Budget",A=E>0?Math.min(N,100):0,k=!0;return E===0?(M="Add income to start budgeting",A=0,k=!1,j="text-gray-500 dark:text-zinc-500"):T?(j="text-green-600 dark:text-emerald-400",P="bg-green-500",M="Perfect! Every dollar has a job ",A=100,k=!1):C&&(j="text-red-600 dark:text-red-400",P="bg-red-500",M="You're not in Congress! Try again.",A=100),v.jsxs("div",{className:"flex flex-col justify-center min-w-0 w-full",children:[v.jsxs("div",{className:"flex items-baseline justify-start mb-1",children:[v.jsx("span",{className:`text-xs font-medium truncate mr-1.5 ${j}`,children:M}),k&&v.jsxs("span",{className:`text-sm font-bold truncate ${j}`,children:[C?"-":"","$",Math.abs(w).toFixed(2)]})]}),v.jsx("div",{className:"w-full h-1.5 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:v.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${P}`,style:{width:`${A}%`}})})]})};return v.jsxs("div",{className:"py-2 space-y-3",children:[v.jsxs("div",{className:"flex items-center justify-center gap-4",children:[v.jsx("button",{onClick:c,className:"p-1.5 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Previous month",children:v.jsx(OB,{size:20})}),v.jsx("div",{className:"text-center",children:v.jsxs("button",{onClick:d,className:"text-base font-semibold text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors whitespace-nowrap",title:"Click to go to current month",children:[o," ",r]})}),v.jsx("button",{onClick:u,className:"p-1.5 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Next month",children:v.jsx(Ta,{size:20})})]}),n&&v.jsx("div",{className:"px-1",children:h()})]})},dv=({children:t,onDelete:e,threshold:n=-100,disabled:r=!1})=>{const i=jX(),[a,o]=B.useState(!1),c=B.useRef(0),u=()=>{r||(o(!0),c.current=Date.now())},d=async(h,p)=>{if(r)return;const m=p.offset.x,b=p.velocity.x;if(setTimeout(()=>o(!1),100),m<n||m<-50&&b<-500){const w=e();w===!1?i.start({x:0}):w instanceof Promise&&w.then(E=>{E===!1&&i.start({x:0})})}else i.start({x:0})};return v.jsxs("div",{className:"relative w-full overflow-hidden mb-2 rounded-xl group",children:[v.jsx("div",{className:"absolute inset-0 bg-red-500 flex items-center justify-end pr-6 rounded-xl",children:v.jsx(km,{className:"text-white w-6 h-6"})}),v.jsx(gn.div,{drag:r?!1:"x",dragConstraints:{left:-500,right:0},dragElastic:.1,onDragStart:u,onDragEnd:d,animate:i,className:`relative bg-white dark:bg-zinc-900 rounded-xl ${a?"z-20":"z-10"}`,style:{touchAction:"pan-y",pointerEvents:a?"none":"auto"},children:t})]})},dee=({isVisible:t,onClose:e,mode:n,initialIncomeSource:r})=>{const{addIncomeSource:i,updateIncomeSource:a,currentMonth:o}=Qt(),{showToast:c}=cc(),[u,d]=B.useState(""),[h,p]=B.useState(""),[m,b]=B.useState(!1);B.useEffect(()=>{if(!t)return;const E=window.setTimeout(()=>{n==="edit"&&r?(d(r.name),p(r.amount.toString())):(d(""),p(""))},0);return()=>window.clearTimeout(E)},[t,n,r]);const w=async E=>{if(E.preventDefault(),!u.trim()||!h||parseFloat(h)<=0){c("Please fill in all required fields with valid values","error");return}b(!0);try{if(n==="add")await i(o,{name:u.trim(),amount:parseFloat(h),month:o,userId:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),c("Income source added successfully","success");else{if(!r){c("Error: No income source to edit","error");return}await a(o,{...r,name:u.trim(),amount:parseFloat(h),updatedAt:new Date().toISOString()}),c(`Updated "${u.trim()}" income source`,"success")}e()}catch(S){console.error("Error saving income source:",S),c("Failed to save income source. Please try again.","error")}finally{b(!1)}};return v.jsx(ai,{children:t&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(gn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black bg-opacity-50"}),v.jsxs(gn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n==="add"?"Add Income Source":"Edit Income Source"}),v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",children:""})]}),v.jsxs("form",{onSubmit:w,className:"p-6 space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Income Source Name *"}),v.jsx("input",{type:"text",value:u,onChange:E=>d(E.target.value),placeholder:"e.g., Primary Job, Freelance, Investments",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Amount *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-zinc-400",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:h,onChange:E=>{const S=E.target.value.replace(/\D/g,"");if(!S){p("");return}const C=(parseInt(S,10)/100).toFixed(2);p(C)},placeholder:"0.00",className:"w-full pl-8 pr-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"submit",disabled:m||!u.trim()||!h||parseFloat(h)<=0,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m?"Saving...":n==="add"?"Add Income":"Save Changes"})]})]})]})]})})},fee=({currentMonth:t,onCopy:e,isLoading:n=!1})=>{const r=c=>{const[u,d]=c.split("-");return new Date(parseInt(u),parseInt(d)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},i=c=>{const[u,d]=c.split("-").map(Number);let h=u,p=d-1;return p<1&&(h=u-1,p=12),r(`${h}-${p.toString().padStart(2,"0")}`)},a=r(t),o=i(t);return v.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6 py-12 space-y-6 animate-in fade-in zoom-in-95 duration-300",children:[v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-0 bg-blue-100 dark:bg-blue-900/30 blur-2xl rounded-full opacity-50"}),v.jsxs("div",{className:"relative bg-white dark:bg-zinc-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-700",children:[v.jsx(AB,{className:"w-12 h-12 text-blue-500"}),v.jsx("div",{className:"absolute -top-2 -right-2 bg-blue-500 text-white p-1.5 rounded-full border-2 border-white dark:border-zinc-900",children:v.jsx(Kf,{size:14})})]})]}),v.jsxs("div",{className:"max-w-xs mx-auto space-y-2",children:[v.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["It looks like you need a budget for ",a]}),v.jsxs("p",{className:"text-gray-500 dark:text-zinc-400",children:["We can copy your budget from ",o," to get you started right away."]})]}),v.jsx("div",{className:"w-full max-w-xs space-y-3 pt-2",children:v.jsx("button",{onClick:e,disabled:n,className:"w-full py-3.5 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-sm transition-all active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:n?"Creating...":v.jsx(v.Fragment,{children:v.jsxs("span",{children:["Create ",a," Budget"]})})})})]})},hee="/personal-budget-pwa/icon-512.png",px="/personal-budget-pwa/images/budget-balanced.png",EN=["Giving","Savings","Housing","Transportation","Food","Personal","Health","Insurance","Debt"],pee=({currentMonth:t,onComplete:e})=>{const[n,r]=B.useState(0),[i,a]=B.useState(0),[o,c]=B.useState(2500),[u,d]=B.useState(EN),{addCategory:h}=Qt(),p=M=>{d(A=>A.includes(M)?A.filter(k=>k!==M):[...A,M])},m=async()=>{for(let M=0;M<u.length;M++)await h({name:u[M],orderIndex:M,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()});e()};B.useEffect(()=>{if(console.log("Animation effect triggered:",{currentStep:n,animationKey:i}),n===5){console.log("Starting animation from $2500 to $0"),c(2500);const M=2e3,A=20,k=M/A,D=2500/A;let V=0;const L=setInterval(()=>{V++;const U=Math.max(0,2500-D*V);console.log("Phase 1 - Animation step:",V,"New amount:",U),c(U),V>=A&&(clearInterval(L),console.log("Phase 1 completed - Perfect budget reached"),setTimeout(()=>{console.log("Starting Phase 2 - Over budget demonstration");let O=0;const J=10,W=200,q=500/J,K=setInterval(()=>{O++;const te=-(q*O);console.log("Phase 2 - Over budget step:",O,"Over budget amount:",te),c(te),O>=J&&(clearInterval(K),console.log("Animation completed - Over budget scenario demonstrated"))},W)},1e3))},k);return()=>{console.log("Cleaning up animation timers"),clearInterval(L)}}},[i,n]);const w=(M=>{const[A,k]=M.split("-");return new Date(parseInt(A),parseInt(k)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})})(t),E=[{icon:Kf,title:"Welcome to Dollars At Work!",description:`Let's set up your budget for ${w}`,content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["Dollars At Work helps you take control of your money using the ",v.jsx("strong",{children:"zero-based budgeting"})," method."]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Every dollar gets a job, and you'll know exactly where your money is going."}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4",children:v.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-200 font-medium",children:" This quick guide will show you how to get started in just a few steps!"})})]}),color:"blue"},{icon:CU,title:"Step 1: Choose Categories",description:"Select categories to organize your spending",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Categories help group your envelopes. Select the ones you need:"}),v.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-60 overflow-y-auto pr-1",children:EN.map(M=>v.jsxs("button",{onClick:()=>p(M),className:`p-3 rounded-xl border text-sm font-medium transition-all flex items-center gap-2 ${u.includes(M)?"bg-blue-50 border-blue-200 text-blue-700 dark:bg-blue-900/30 dark:border-blue-800 dark:text-blue-300":"bg-white border-gray-200 text-gray-600 dark:bg-zinc-800 dark:border-zinc-700 dark:text-zinc-400"}`,children:[v.jsx("div",{className:`w-4 h-4 rounded-full border flex items-center justify-center ${u.includes(M)?"border-blue-500 bg-blue-500":"border-gray-400"}`,children:u.includes(M)&&v.jsx(ms,{size:12,className:"text-white"})}),M]},M))}),u.length===0&&v.jsx("p",{className:"text-red-500 text-xs",children:"Please select at least one category."})]}),color:"blue"},{icon:XC,title:"Step 2: Add Your Income",description:"Tell us how much money you have to work with",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"First, you'll add your income sources for the month. This could be:"}),v.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-zinc-400",children:[v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ms,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Salary"})," - Your regular paycheck"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ms,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Freelance"})," - Side gig income"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ms,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Other Income"})," - Any other money coming in"]})]})]}),v.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-green-900 dark:text-green-200",children:[v.jsx("strong",{children:'Look for the "Income Sources" section'})," at the top of your budget and tap the ",v.jsx(Ch,{className:"w-4 h-4 inline"})," button to add income."]})})]}),color:"green"},{icon:x0,title:"Step 3: Create Spending Envelopes",description:"Organize your spending into categories",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Spending envelopes are where you track expenses. You'll assign each envelope to a category."}),v.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-zinc-400",children:[v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ms,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Groceries"})," (Food)"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ms,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Rent/Mortgage"})," (Housing)"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ms,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Gas"})," (Transportation)"]})]})]}),v.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-purple-900 dark:text-purple-200",children:[v.jsx("strong",{children:'Tap "+" on a category section'})," to add an envelope to it."]})})]}),color:"purple"},{icon:Xf,title:"Step 4: Organize Your Budget",description:"Reorder categories and envelopes to match your preferences",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["Your budget should work the way ",v.jsx("strong",{children:"you"})," think about money. Customize the order to match your priorities!"]}),v.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-200 dark:border-indigo-800 rounded-xl p-4",children:[v.jsxs("h4",{className:"font-medium text-indigo-900 dark:text-indigo-200 mb-3 flex items-center gap-2",children:[v.jsx(Xf,{className:"w-4 h-4"}),"Drag to Reorder"]}),v.jsx("p",{className:"text-sm text-indigo-800 dark:text-indigo-300 mb-3",children:"Both categories and envelopes can be reordered the same way:"}),v.jsxs("div",{className:"space-y-2 mb-3",children:[v.jsxs("p",{className:"text-sm text-indigo-800 dark:text-indigo-300",children:[v.jsx("strong",{children:"Mobile:"})," Long-press and drag"]}),v.jsxs("p",{className:"text-sm text-indigo-800 dark:text-indigo-300",children:[v.jsx("strong",{children:"PC:"})," Click and hold on the ",v.jsx("strong",{children:""})," dots, then drag"]})]}),v.jsxs("div",{className:"bg-white dark:bg-indigo-950/30 rounded-lg p-3 mb-3 border border-indigo-300 dark:border-indigo-700",children:[v.jsxs("div",{className:"flex items-center gap-2 text-xs mb-2",children:[v.jsx("div",{className:"text-indigo-600 dark:text-indigo-400 font-bold",children:""}),v.jsxs("div",{className:"flex-1",children:[v.jsx("div",{className:"font-medium text-indigo-900 dark:text-indigo-200",children:"Food"}),v.jsx("div",{className:"text-indigo-700 dark:text-indigo-400 text-xs",children:"Category"})]})]}),v.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[v.jsx("div",{className:"text-indigo-600 dark:text-indigo-400 font-bold",children:""}),v.jsxs("div",{className:"flex-1",children:[v.jsx("div",{className:"font-medium text-indigo-900 dark:text-indigo-200",children:"Groceries"}),v.jsx("div",{className:"text-indigo-700 dark:text-indigo-400 text-xs",children:"$450 / $500"})]})]}),v.jsx("p",{className:"text-xs text-indigo-600 dark:text-indigo-400 mt-2 italic",children:" Click and hold these dots to drag"})]}),v.jsxs("ul",{className:"space-y-1 text-sm text-indigo-700 dark:text-indigo-400",children:[v.jsx("li",{children:" Reorder categories: Settings  Manage Categories"}),v.jsx("li",{children:" Reorder envelopes: On the main budget screen"}),v.jsx("li",{children:" Organize by priority, frequency, or preference"})]})]}),v.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-amber-900 dark:text-amber-200",children:[" ",v.jsx("strong",{children:"Pro tip:"})," Try organizing your budget like this: Income  Fixed Expenses  Variable Expenses  Savings Goals"]})})]}),color:"indigo"},{icon:Rm,title:"Step 5: Allocate Your Budget",description:"Assign money to each envelope",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Now comes the fun part - giving every dollar a job!"}),v.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500 rounded-r-xl p-4 relative",children:[v.jsx("button",{onClick:()=>a(M=>M+1),className:"absolute top-2 right-2 p-1.5 text-blue-600 dark:text-blue-400 hover:bg-blue-100 dark:hover:bg-blue-800 rounded-lg transition-colors",title:"Replay animation",children:v.jsx(xU,{className:"w-4 h-4"})}),v.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-200 font-medium mb-2",children:'The "Left to Budget" amount shows unassigned money'}),v.jsxs("p",{className:"text-sm text-blue-900 dark:text-blue-200 mb-3",children:["Your goal is to get this to ",v.jsx("strong",{children:"$0.00"})," by allocating all your income to envelopes."]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex justify-between text-xs text-blue-700 dark:text-blue-300 font-medium",children:[v.jsx("span",{children:"Left to Budget"}),v.jsxs("span",{className:`font-bold ${o<0?"text-red-600 dark:text-red-400":""}`,children:["$",o.toFixed(2)]})]}),v.jsx("div",{className:"w-full bg-blue-200 dark:bg-blue-800 rounded-full h-2 overflow-hidden",children:v.jsx(gn.div,{className:`h-full rounded-full ${o<0?"bg-red-500":"bg-green-500"}`,initial:{width:"0%"},animate:{width:o<0?"100%":`${(2500-o)/2500*100}%`},transition:{duration:.3,ease:"easeInOut"}})}),v.jsxs(gn.div,{className:`text-xs font-medium text-center mt-1 ${o===0?"text-green-600 dark:text-emerald-400":o<0?"text-red-600 dark:text-red-400":"text-blue-700 dark:text-blue-300"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:2,duration:.5},children:[o===0&&"Perfect! Every dollar has a job ",o<0&&"You're not in Congress! Try again.",o>0&&"Keep allocating until you reach $0"]})]},i)]}),v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:[v.jsx("strong",{children:"To allocate money:"})," Tap the budget amount on any envelope and enter how much you want to assign to it."]}),v.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-amber-900 dark:text-amber-200",children:[" ",v.jsx("strong",{children:"Pro tip:"})," Start with your essential expenses (rent, utilities, groceries) first, then allocate what's left to other categories."]})})]}),color:"blue"},{icon:Ah,title:"Bonus: Piggybanks (Savings Goals)",description:"Save for future goals",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["Piggybanks are special envelopes for ",v.jsx("strong",{children:"savings goals"})," that carry over month-to-month."]}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(RU,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Set a Goal"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Vacation, emergency fund, new car - whatever you're saving for"})]})]}),v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(XC,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Monthly Contributions"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Set an automatic monthly amount to save"})]})]}),v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(Rm,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Track Progress"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Watch your savings grow toward your goal"})]})]})]}),v.jsx("div",{className:"bg-pink-50 dark:bg-pink-900/20 border border-pink-200 dark:border-pink-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-pink-900 dark:text-pink-200",children:[v.jsx("strong",{children:"Find Piggybanks"})," at the bottom of your budget. They're optional but powerful for reaching your goals!"]})})]}),color:"pink"},{icon:px,title:"You're Ready to Budget!",description:"Start taking control of your money",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"That's it! You now know the basics of Dollars At Work:"}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"1"})}),v.jsx("span",{children:"Choose your categories"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"2"})}),v.jsx("span",{children:"Add your income sources"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"3"})}),v.jsx("span",{children:"Create envelopes in categories"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"4"})}),v.jsx("span",{children:"Organize your budget order"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"5"})}),v.jsx("span",{children:"Allocate until Left to Budget = $0"})]})]}),v.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4 mt-6",children:v.jsx("p",{className:"text-sm text-center text-blue-900 dark:text-blue-200 font-medium",children:' Click "Start Budgeting" below to create your first budget!'})})]}),color:"green",useCustomIcon:!0}],S=E[n],T=S.useCustomIcon?px:S.icon,C=n===E.length-1,N=n===0,P={blue:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-600 dark:text-blue-400",button:"bg-blue-600 hover:bg-blue-700"},green:{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-600 dark:text-green-400",button:"bg-green-600 hover:bg-green-700"},purple:{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-600 dark:text-purple-400",button:"bg-purple-600 hover:bg-purple-700"},indigo:{bg:"bg-indigo-100 dark:bg-indigo-900/30",text:"text-indigo-600 dark:text-indigo-400",button:"bg-indigo-600 hover:bg-indigo-700"},pink:{bg:"bg-pink-100 dark:bg-pink-900/30",text:"text-pink-600 dark:text-pink-400",button:"bg-pink-600 hover:bg-pink-700"}}[S.color];return v.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex items-center justify-center p-4",children:v.jsx("div",{className:"w-full max-w-2xl",children:v.jsx(ai,{mode:"wait",children:v.jsxs(gn.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-xl border border-gray-200 dark:border-zinc-800 overflow-hidden",children:[v.jsx("div",{className:"p-6 pb-2",children:v.jsxs("div",{className:"flex items-center justify-between mb-4",children:[v.jsxs("div",{className:"flex-1",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:S.title}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:S.description})]}),v.jsx("div",{className:"flex flex-col items-center mx-4",children:n===0?v.jsx("img",{src:hee,alt:"Dollars At Work",className:`w-20 h-20 ${P.text}`}):S.useCustomIcon?v.jsx("img",{src:px,alt:"Budget Balanced",className:`w-32 h-32 ${P.text}`}):v.jsx("div",{className:`${P.bg} p-3 rounded-xl`,children:v.jsx(T,{className:`w-8 h-8 ${P.text}`})})}),v.jsxs("div",{className:"text-sm text-gray-500 dark:text-zinc-400 whitespace-nowrap",children:["Step ",n+1," of ",E.length]})]})}),v.jsx("div",{className:"px-6 pb-6 pt-2",children:S.content}),v.jsx("div",{className:"px-6 pb-4 flex justify-center gap-2",children:E.map((M,A)=>v.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${A===n?`w-8 ${P.button}`:A<n?"w-2 bg-gray-400 dark:bg-zinc-600":"w-2 bg-gray-200 dark:bg-zinc-700"}`},A))}),v.jsxs("div",{className:"p-6 pt-0 flex gap-3",children:[!N&&v.jsxs("button",{onClick:()=>r(M=>M-1),className:"flex-1 py-3 px-4 border border-gray-300 dark:border-zinc-700 text-gray-700 dark:text-zinc-300 rounded-xl font-medium hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors flex items-center justify-center gap-2",children:[v.jsx(Bo,{className:"w-5 h-5"}),"Back"]}),v.jsx("button",{onClick:()=>{if(C)m();else{if(S.title.includes("Choose Categories")&&u.length===0)return;r(M=>M+1)}},disabled:S.title.includes("Choose Categories")&&u.length===0,className:`${N?"flex-1":"flex-[2]"} py-3 px-4 ${P.button} text-white rounded-xl font-semibold transition-all active:scale-[0.98] flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed`,children:C?v.jsxs(v.Fragment,{children:[v.jsx(Kf,{className:"w-5 h-5"}),"Start Budgeting"]}):v.jsxs(v.Fragment,{children:["Next",v.jsx(SB,{className:"w-5 h-5"})]})})]})]},n)})})})},gee=({piggybank:t,balance:e,onNavigate:n,setMoveableRef:r,isReorderingActive:i,activelyDraggingId:a,onItemDragStart:o,onLongPressTrigger:c})=>{const u=B.useRef(null),[d,h]=B.useState(!1),p=AE(D=>{v3(),c(D,t.id)},{threshold:500,cancelOnMovement:25,detect:Do.Touch}),m=t.piggybankConfig?.targetAmount,b=t.piggybankConfig?.monthlyContribution??0,w=t.piggybankConfig?.color||"#3B82F6",E=t.piggybankConfig?.paused||!1,S=typeof e=="number"?e:e.toNumber(),T=(D,V=1)=>{const L=D.replace("#",""),U=parseInt(L,16),O=U>>16&255,J=U>>8&255,W=U&255;return`rgba(${O}, ${J}, ${W}, ${V})`},C=`linear-gradient(135deg, ${T(w,.14)} 0%, ${T(w,.05)} 100%)`,N=T(w,.4),j=m&&m>0?Math.min(S/m*100,100):0,P=m&&S>=m;B.useEffect(()=>{a&&a!==t.id&&h(!1)},[a,t.id]),B.useEffect(()=>{a===t.id&&(h(!0),o&&o(t.id))},[a,t.id,o]),B.useEffect(()=>{if(!a&&d){const D=setTimeout(()=>{h(!1)},300);return()=>clearTimeout(D)}},[a,d]);const M=D=>{if(d||i){D.preventDefault(),D.stopPropagation();return}n(t.id)},A=a===t.id,k=v.jsxs("div",{className:"flex items-center gap-3 w-full",children:[v.jsx("div",{className:"hidden md:flex items-center justify-center p-1 text-gray-400 opacity-0 group-hover:opacity-100 cursor-grab active:cursor-grabbing transition-all duration-200",onMouseDown:D=>c(D,t.id),children:v.jsx(Xf,{size:20})}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsxs("div",{className:"flex items-center justify-between gap-3 mb-1",children:[v.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[v.jsx("div",{className:"w-6 h-6 rounded-full flex-shrink-0 flex items-center justify-center",style:{backgroundColor:`${w}20`},children:v.jsx(Ah,{size:12,style:{color:w}})}),v.jsxs("div",{className:"min-w-0",children:[v.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white truncate leading-tight",children:t.name}),v.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[v.jsx(Rm,{size:10,style:{color:w}}),v.jsxs("span",{className:"text-[10px] text-gray-500 dark:text-zinc-400 font-medium",children:["$",b.toFixed(2),"/mo"]}),E&&v.jsxs("span",{className:"text-[9px] text-orange-600 dark:text-orange-400 font-bold ml-1 flex items-center gap-0.5",children:[v.jsx(hU,{size:8})," PAUSED"]})]})]})]}),v.jsxs("div",{className:"text-right flex-shrink-0",children:[v.jsxs("div",{className:"text-sm font-bold text-gray-900 dark:text-white leading-none",children:["$",S.toFixed(2)]}),v.jsxs("div",{className:"text-[9px] text-gray-400 dark:text-zinc-500 mt-1",children:["of $",m?.toFixed(0)||"0"]})]})]}),m&&m>0&&v.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-800/50 rounded-full h-0.5 overflow-hidden",children:v.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${j}%`,backgroundColor:w}})}),P&&!m&&v.jsx("div",{className:"text-[9px] text-green-600 dark:text-green-400 font-bold mt-0.5",children:" GOAL REACHED"})]})]});return v.jsx(gn.div,{...p(),layout:!A,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},ref:D=>{r&&r(D),u.current=D},onClick:M,style:{background:C,borderColor:N,boxShadow:A?"0 18px 45px rgba(15,23,42,0.35)":"0 1px 2px rgba(15,23,42,0.08)",zIndex:A?50:1,scale:A?1.02:1},className:"rounded-xl py-1.5 px-3 border transition-all cursor-pointer shadow-sm hover:shadow-md select-none active:scale-[0.99] group",children:k})},pf=(t,e=1)=>{const n=t.replace("#",""),r=parseInt(n,16),i=r>>16&255,a=r>>8&255,o=r&255;return`rgba(${i}, ${a}, ${o}, ${e})`},mee=12,vee=(t,e,n)=>Math.min(Math.max(t,e),n),yee=({env:t,budgetedAmount:e,remainingBalance:n,navigate:r,transactions:i,currentMonth:a,setMoveableRef:o,isReorderingActive:c,activelyDraggingId:u,onItemDragStart:d,onLongPressTrigger:h})=>{const p=!!t.isPiggybank,m=t.piggybankConfig?.color||"#3B82F6",b=p?`linear-gradient(135deg, ${pf(m,.18)} 0%, ${pf(m,.08)} 100%)`:void 0,w=p?pf(m,.5):void 0,[E,S]=B.useState(!1),T=AE(L=>{v3(),h(L,t.id)},{threshold:500,cancelOnMovement:25,detect:Do.Touch}),C=i.filter(L=>L.envelopeId===t.id&&L.month===a),N=C.filter(L=>L.type==="Expense"),j=C.filter(L=>L.type==="Income"),P=N.reduce((L,U)=>L+(U.amount||0),0),M=j.reduce((L,U)=>L+(U.amount||0),0),A=M>0?Math.max(0,P/M*100):0,k=L=>{if(E||c){L.preventDefault(),L.stopPropagation();return}r(`/envelope/${t.id}`)};B.useEffect(()=>{u&&u!==t.id&&S(!1)},[u,t.id]),B.useEffect(()=>{u===t.id&&(S(!0),d(t.id))},[u,t.id,d]),B.useEffect(()=>{if(!u&&E){const L=setTimeout(()=>{S(!1)},300);return()=>clearTimeout(L)}},[u,E]);const D=v.jsxs("div",{className:"flex items-center gap-3 w-full",children:[v.jsx("div",{className:"hidden md:flex items-center justify-center p-1 text-gray-400 opacity-0 group-hover:opacity-100 cursor-grab active:cursor-grabbing transition-all duration-200",onMouseDown:L=>h(L,t.id),children:v.jsx(Xf,{size:20})}),v.jsxs("div",{className:"flex-1",children:[v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[p&&v.jsx("span",{className:"w-5 h-5 rounded-full flex items-center justify-center border",style:{borderColor:pf(m,.4),backgroundColor:pf(m,.15),color:m},children:v.jsx(Ah,{size:10})}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white leading-tight",children:t.name}),v.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[v.jsx("span",{className:"text-[10px] text-gray-500 dark:text-zinc-400",children:"Budgeted:"}),v.jsxs("span",{className:"text-[10px] font-medium text-gray-700 dark:text-zinc-300",children:["$",e.toFixed(2)]})]})]})]}),v.jsxs("div",{className:"text-right",children:[v.jsxs("span",{className:`text-sm font-bold leading-none ${(typeof n=="number"?n:n.toNumber())<0||100-A<=5?"text-red-500":A>=80?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-emerald-400"}`,children:["$",(typeof n=="number"?n:n.toNumber()).toFixed(2)]}),v.jsx("span",{className:"text-[9px] text-gray-400 dark:text-zinc-500 block uppercase tracking-wider mt-0.5",children:"Remaining"})]})]}),e>0&&v.jsx("div",{className:"mt-1",children:v.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-700/50 rounded-full h-0.5 overflow-hidden",children:v.jsx("div",{className:`h-full transition-all duration-300 ease-out ${(typeof n=="number"?n:n.toNumber())<0||100-A<=5?"bg-red-500":A>=80?"bg-yellow-500":"bg-green-400"}`,style:{width:`${Math.max(100-A,2)}%`}})})})]})]}),V=u===t.id;return v.jsx(gn.div,{...T(),layout:!V,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},"data-envelope-id":t.id,ref:o(t.id),onClick:k,style:{boxShadow:V?"0 18px 45px rgba(15,23,42,0.35)":"0 1px 2px rgba(15,23,42,0.08)",background:b,borderColor:w,cursor:V?"grabbing":"pointer",zIndex:V?50:1,scale:V?1.02:1},className:`py-1.5 px-3 rounded-xl active:scale-[0.99] transition-all select-none border group ${p?"bg-white/70 dark:bg-zinc-800/80":"bg-gray-50 dark:bg-zinc-800 border-transparent"}`,children:D})},SN=({category:t,envelopes:e,allocations:n,currentMonth:r,transactions:i,navigate:a,getEnvelopeBalance:o,onReorderGlobal:c})=>{if(e.length===0&&t.id==="uncategorized")return null;const[u,d]=B.useState(e),h=B.useRef(e),[p,m]=B.useState(!1),[b,w]=B.useState(null),E=B.useRef(!1),S=B.useRef(null),T=B.useRef({}),C=B.useRef({}),N=B.useRef({activeId:null,startIndex:0,currentIndex:0,itemHeight:0});B.useEffect(()=>{p||(d(e),h.current=e)},[e,p]);const j=B.useCallback((M,A)=>{const k=C.current[A];if(k){E.current=!0;const D=M.nativeEvent||M;k.dragStart(D)}},[]),P=B.useCallback(M=>A=>{A?T.current[M]=A:delete T.current[M]},[]);return B.useEffect(()=>{const M=()=>{Object.values(C.current).forEach(D=>D?.destroy()),C.current={}};if(!u.length)return;const A=()=>{u.forEach(D=>{const V=T.current[D.id];if(!V||!S.current)return;const L=new g3(S.current,{target:V,draggable:!0,throttleDrag:0,snappable:!0,snapThreshold:5,snapDirections:{top:!0,bottom:!0},elementSnapDirections:{top:!0,bottom:!0},clickable:!0,dragArea:!1,hideDefaultLines:!0,renderDirections:[]});L.on("dragStart",O=>{if(!E.current){O.stop();return}const J=O.inputEvent.target;if(J.closest(".js-budget-target")||J.tagName==="INPUT"){O.stop();return}const W=h.current.findIndex(te=>te.id===D.id),q=O.target,K=q.getBoundingClientRect();w(D.id),N.current={activeId:D.id,startIndex:W,currentIndex:W,itemHeight:K.height+mee},q.style.transition="none",q.style.boxShadow="0 18px 45px rgba(15,23,42,0.35)",q.style.zIndex="20",m(!0)});let U=null;L.on("drag",O=>{const J=O.target;U!==null&&cancelAnimationFrame(U),U=requestAnimationFrame(()=>{const W=N.current;if(W.activeId!==D.id)return;const q=O.beforeTranslate[1];J.style.transform=`translateY(${q}px)`,J.style.transition="none";const{itemHeight:K,startIndex:te}=W,se=Math.round(q/K),G=vee(te+se,0,h.current.length-1);G!==W.currentIndex&&(W.currentIndex=G,h.current.forEach((F,Y)=>{if(F.id===D.id)return;const Q=T.current[F.id];if(!Q)return;let X=0;te<G&&Y>te&&Y<=G?X=-K:te>G&&Y>=G&&Y<te&&(X=K),Q.style.transform=X?`translateY(${X}px)`:"",Q.style.transition="transform 0.2s ease"})),U=null})}),L.on("dragEnd",O=>{U!==null&&(cancelAnimationFrame(U),U=null);const J=O.target,{startIndex:W,currentIndex:q}=N.current;if(J.style.transform="",J.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease",J.style.boxShadow="",h.current.forEach(K=>{const te=T.current[K.id];te&&(te.style.transform="",te.style.transition="")}),W!==q){const K=[...h.current],[te]=K.splice(W,1);K.splice(q,0,te),h.current=K,d(K),c(K.map(se=>se.id))}setTimeout(()=>{J.style.zIndex="",w(null),m(!1),E.current=!1},300)}),L.on("click",()=>{const O=window.event?.target;O&&(O.closest(".js-budget-target")||O.tagName==="INPUT")||a(`/envelope/${D.id}`)}),C.current[D.id]=L})},k=window.setTimeout(A,80);return()=>{clearTimeout(k),M()}},[u,a,c]),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-3 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-2 px-1",children:[v.jsx("h2",{className:"text-base font-bold text-gray-900 dark:text-white flex items-center gap-2",children:t.name}),v.jsx("button",{onClick:()=>a(t.id==="uncategorized"?"/add-envelope":`/add-envelope?categoryId=${t.id}`),className:"text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 p-1 rounded-full transition-colors",title:`Add to ${t.name}`,children:v.jsx(Ch,{size:20})})]}),v.jsx("div",{ref:S,className:"space-y-2 relative",children:u.length===0?v.jsx("div",{className:"py-2 text-center border border-dashed border-gray-100 dark:border-zinc-800 rounded-xl",children:v.jsx("p",{className:"text-[10px] text-gray-400 dark:text-zinc-500",children:"Empty category"})}):v.jsx(ai,{initial:!1,children:u.map(M=>{const k=(n[r]||[]).find(V=>V.envelopeId===M.id)?.budgetedAmount||0,D=o(M.id);return M.isPiggybank?v.jsx(gee,{piggybank:M,balance:D,onNavigate:V=>a(`/envelope/${V}`),setMoveableRef:P(M.id),isReorderingActive:p,activelyDraggingId:b,onItemDragStart:()=>{},onLongPressTrigger:j},M.id):v.jsx(yee,{env:M,budgetedAmount:k,remainingBalance:D,navigate:a,transactions:i,currentMonth:r,setMoveableRef:P,isReorderingActive:p,activelyDraggingId:b,onItemDragStart:()=>{},onLongPressTrigger:j},M.id)})})})]})},bee=()=>{const{visibleEnvelopes:t,piggybanks:e,incomeSources:n,availableToBudget:r,currentMonth:i,allocations:a,transactions:o,isLoading:c,isInitialLoading:u,showTimeoutMessage:d,getEnvelopeBalance:h,deleteIncomeSource:p}=cee(),{setMonth:m,setIsOnboardingActive:b,isOnboardingActive:w,isOnboardingCompleted:E,completeOnboarding:S,categories:T,fetchCategories:C,envelopes:N,reorderEnvelopes:j}=Qt(),P=qa(),[M,A]=B.useState(!1),[k,D]=B.useState("add"),[V,L]=B.useState(null),[U,O]=B.useState(!1),[J,W]=B.useState(!1),q=B.useRef(null),K=B.useRef(null),[te,se]=B.useState(0);B.useEffect(()=>{T.length===0&&C()},[T.length,C]);const G=B.useMemo(()=>{const pe={},_e=[];return T.forEach(ae=>pe[ae.id]=[]),[...t,...e].sort((ae,Ae)=>(ae.orderIndex??0)-(Ae.orderIndex??0)).forEach(ae=>{ae.categoryId&&pe[ae.categoryId]?pe[ae.categoryId].push(ae):_e.push(ae)}),{groups:pe,uncategorized:_e}},[T,t,e]),F=B.useCallback(async pe=>{const _e=[...N.map(Re=>Re.id)],Ie=new Set(pe),ae=[];let Ae=0;_e.forEach(Re=>{Ie.has(Re)?ae.push(pe[Ae++]):ae.push(Re)}),await j(ae)},[N,j]);B.useLayoutEffect(()=>{if(w)return;const pe=K.current;if(!pe)return;const _e=()=>se(pe.getBoundingClientRect().height);_e();const Ie=new ResizeObserver(()=>_e());return Ie.observe(pe),window.addEventListener("resize",_e),()=>{window.removeEventListener("resize",_e),Ie.disconnect()}},[w,i,n,a,t,e,r]),B.useEffect(()=>{if(!u&&!c){const pe=setTimeout(()=>{if(w)return;if(E){b(!1);const ae=(n[i]||[]).length===0&&(a[i]||[]).length===0,Ae=Object.keys(n).some(Re=>(n[Re]||[]).length>0)||Object.keys(a).some(Re=>(a[Re]||[]).length>0);W(!!(ae&&Ae));return}const _e=(n[i]||[]).length===0&&(a[i]||[]).length===0,Ie=Object.keys(n).some(ae=>(n[ae]||[]).length>0)||Object.keys(a).some(ae=>(a[ae]||[]).length>0);_e?Ie?(W(!0),b(!1)):(b(!0),W(!1)):(W(!1),b(!1))},500);return()=>clearTimeout(pe)}},[u,c,i,n,a,E]);const Y=()=>{D("add"),L(null),A(!0)},Q=pe=>{q.current&&clearTimeout(q.current),!U&&(D("edit"),L(pe),A(!0))},X=pe=>{q.current&&clearTimeout(q.current),O(!0),p(pe),setTimeout(()=>O(!1),500)},ie=()=>{A(!1),L(null)},le=async()=>{W(!1);const{copyPreviousMonthAllocations:pe}=Qt.getState();await pe(i)},ge=()=>{S(),b(!1)};return u?v.jsx(zM,{message:d?"Still loading...":"Loading your budget...",showTimeout:d}):v.jsxs(v.Fragment,{children:[v.jsx("style",{dangerouslySetInnerHTML:{__html:".moveable-control, .moveable-origin, .moveable-line { display: none !important; }"}}),v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-20",children:[!w&&v.jsx("header",{ref:K,className:"fixed top-0 left-0 right-0 z-50 bg-white dark:bg-zinc-900 border-b border-gray-100 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+4px)] pb-1",children:v.jsx(uee,{currentMonth:i,onMonthChange:pe=>{W(!1),m(pe)},budgetStatus:{amount:r,totalIncome:(n[i]||[]).reduce((pe,_e)=>pe+_e.amount,0),totalAllocated:(a[i]||[]).filter(pe=>t.some(_e=>_e.id===pe.envelopeId)||e.some(_e=>_e.id===pe.envelopeId)).reduce((pe,_e)=>pe+_e.budgetedAmount,0)}})}),v.jsxs("div",{className:"pb-[calc(8rem+env(safe-area-inset-bottom))] px-4 max-w-4xl mx-auto space-y-4",style:w?void 0:{paddingTop:Math.max(0,te+16)},children:[w?v.jsx(pee,{currentMonth:i,onComplete:ge}):J?v.jsx(fee,{currentMonth:i,onCopy:le}):v.jsxs(v.Fragment,{children:[v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-3 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-2 px-1",children:[v.jsx("h2",{className:"text-base font-bold text-gray-900 dark:text-white",children:"Income Sources"}),v.jsx("button",{onClick:Y,className:"text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 p-1 rounded-full transition-colors",children:v.jsx(Ch,{size:20})})]}),(n[i]||[]).length===0?v.jsx("div",{className:"text-center py-4",children:v.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-[10px]",children:"No income sources yet."})}):v.jsx("div",{className:"space-y-2",children:v.jsx(ai,{initial:!1,mode:"popLayout",children:(n[i]||[]).map(pe=>v.jsx(gn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(dv,{onDelete:()=>X(pe),children:v.jsxs("div",{className:"flex justify-between items-center py-2 px-3 bg-gray-50 dark:bg-zinc-800 rounded-xl cursor-pointer",onClick:()=>Q(pe),children:[v.jsx("div",{className:"flex-1",children:v.jsx("p",{className:"text-xs font-medium text-gray-900 dark:text-white",children:pe.name})}),v.jsxs("p",{className:"text-xs font-bold text-green-600 dark:text-emerald-400",children:["$",pe.amount.toFixed(2)]})]})})},pe.id))})})]}),T.map(pe=>v.jsx(SN,{category:pe,envelopes:G.groups[pe.id]||[],allocations:a,currentMonth:i,transactions:o,navigate:P,getEnvelopeBalance:h,onReorderGlobal:F},pe.id)),G.uncategorized.length>0&&v.jsx(SN,{category:{id:"uncategorized",name:"Uncategorized"},envelopes:G.uncategorized,allocations:a,currentMonth:i,transactions:o,navigate:P,getEnvelopeBalance:h,onReorderGlobal:F}),T.length===0&&G.uncategorized.length===0&&v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800 text-center py-12",children:[v.jsx(x0,{className:"w-12 h-12 text-gray-300 dark:text-zinc-700 mx-auto mb-3"}),v.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-sm mb-4",children:"No envelopes yet."}),v.jsx("button",{onClick:()=>P("/add-envelope"),className:"text-blue-600 dark:text-blue-300 font-medium hover:text-blue-700 dark:hover:text-blue-200 transition-colors",children:"Create First Envelope"})]})]}),v.jsx(dee,{isVisible:M,onClose:ie,mode:k,initialIncomeSource:V})]})]})]})},xee=[],N3=({selectedCard:t,onCardSelect:e,initialCards:n=xee,disabled:r=!1,isUserSelected:i=!1})=>{const a=Qt(G=>G.appSettings),o=Qt(G=>G.updateAppSettings),[c,u]=B.useState(n.length>0?n[0]:{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}),[d,h]=B.useState(!1),[p,m]=B.useState(!1),[b,w]=B.useState(n),[E,S]=B.useState(null),[T,C]=B.useState({name:"",network:"Visa",last4:"",color:"#3b82f6"}),[N,j]=B.useState(null),[P,M]=B.useState(null);B.useEffect(()=>{a?.paymentSources&&(w(a.paymentSources),a.paymentSources.length>0&&!t&&u(a.paymentSources[0]))},[a,t]);const A=t||c;B.useEffect(()=>{!t&&e&&b.length>0&&e(b[0])},[t,e,b]);const k=G=>{r||(G.id==="add-new"?m(!0):(u(G),e?.(G),h(!1)))},D=()=>{r||h(!d)},V=G=>{r||S(G)},L=async()=>{if(E&&!r){const G=b.filter(F=>F.id!==E.id);if(w(G),A?.id===E.id){const F=G.length>0?G[0]:{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"};u(F),e?.(F)}S(null),h(!1);try{await o({paymentSources:G})}catch(F){console.error("Failed to delete card from app settings:",F),w(b),alert("Failed to delete card. Please try again.");return}}},U=()=>{S(null)},O=async()=>{if(r)return;const G=!["Cash","Venmo"].includes(T.network);if(G&&(T.last4.length!==4||!/^\d{4}$/.test(T.last4))){alert("Please enter exactly 4 digits for the last 4 digits");return}if(!T.name.trim()){alert("Please enter a name");return}const F={id:`custom-${Date.now()}`,name:T.name.trim(),network:T.network,last4:G?T.last4:void 0,color:T.color},Y=[...b,F];w(Y),u(F),e?.(F),m(!1),h(!1);try{await o({paymentSources:Y})}catch(Q){console.error("Failed to save card to app settings:",Q),w(b),u(A),alert("Failed to save card. Please try again.");return}C({name:"",network:"Visa",last4:"",color:"#3b82f6"})},J=(G,F)=>{r||(j(F),G.dataTransfer.effectAllowed="move")},W=(G,F)=>{r||!N||(G.preventDefault(),G.dataTransfer.dropEffect="move",M(F))},q=()=>{M(null)},K=async(G,F)=>{if(r||!N)return;G.preventDefault(),M(null);const Y=b.findIndex(X=>X.id===N.id);if(Y===-1||Y===F)return;const Q=[...b];Q.splice(Y,1),Q.splice(F,0,N),w(Q),j(null);try{await o({paymentSources:Q})}catch(X){console.error("Failed to reorder cards:",X),w(b),alert("Failed to reorder cards. Please try again.")}},te=()=>{j(null),M(null)},se=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#6b7280","#0f4c81","#fdbb30","#7fb5b5","#232f3e","#e3e3e3"];return v.jsxs(v.Fragment,{children:[v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Payment Method",!i&&v.jsx("span",{className:"ml-2 text-xs text-blue-600 dark:text-blue-400 font-medium",children:"(Default selected)"})]}),v.jsxs("div",{onClick:D,className:`flex items-center gap-4 p-3 border rounded-lg transition-colors ${r?"cursor-not-allowed opacity-50 border-gray-300 dark:border-gray-600":"cursor-pointer hover:bg-gray-50 dark:hover:bg-zinc-800 border-gray-300 dark:border-gray-600"} ${i?"":"ring-2 ring-blue-200 dark:ring-blue-800"}`,children:[v.jsxs("div",{className:"w-[70px] h-[40px] rounded-lg flex flex-col justify-between p-[6px] shadow-lg text-white font-mono text-xs",style:{backgroundColor:A.color},children:[v.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:A.network}),v.jsx("span",{className:"text-left text-[9px] leading-none",children:["Cash","Venmo"].includes(A.network)?A.network==="Cash"?"$$$":"@":` ${A.last4||""}`})]}),v.jsxs("div",{className:"flex-1",children:[v.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:A.name}),v.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Cash","Venmo"].includes(A.network)?A.network:`(...${A.last4})`})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"text-gray-400",children:d?"":""}),!i&&v.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",title:"Default payment method - tap to change"})]})]}),d&&v.jsxs("div",{className:"card-stack-dropdown",children:[b.length>1&&v.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2 text-center",children:" Drag and drop cards to reorder"}),v.jsx("div",{className:"card-stack",children:v.jsx(ai,{initial:!1,mode:"popLayout",children:[...b,{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}].map((G,F)=>{const Y=A.id===G.id,Q=G.id==="add-new",X=["Cash","Venmo"].includes(G.network);return v.jsx(gn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(dv,{onDelete:()=>!Q&&!r&&V(G),threshold:-80,children:v.jsxs("div",{className:`card-stack-item ${Y?"selected":""} ${Q?"add-new-card":""} ${N?.id===G.id?"dragging":""} ${P===F?"drag-over":""}`,onClick:()=>k(G),draggable:!Q&&!r,onDragStart:Q?void 0:ie=>J(ie,G),onDragOver:Q?void 0:ie=>W(ie,F),onDragLeave:Q?void 0:q,onDrop:Q?void 0:ie=>K(ie,F),onDragEnd:Q?void 0:te,style:{backgroundColor:Q?"#f3f4f6":G.color,color:Q?"#374151":G.color==="#e3e3e3"?"#000":"#fff",zIndex:b.length-F,opacity:N?.id===G.id?.5:1,transform:P===F?"scale(1.02)":"scale(1)"},children:[v.jsxs("div",{className:"card-header",children:[v.jsx("span",{className:"card-network",children:Q?"":G.network}),Y&&!Q&&v.jsx("span",{className:"selected-indicator",children:""})]}),v.jsxs("div",{className:"card-details",children:[v.jsx("div",{className:"card-name",children:G.name}),v.jsx("div",{className:"card-number",children:Q?"":X?G.network==="Cash"?"$$$":"@":` ${G.last4}`})]}),Q&&v.jsx("div",{className:"add-icon",children:v.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[v.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),v.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})})},G.id)})})})]})]}),p&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-md mx-4",children:[v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Add New Payment Method"}),v.jsx("button",{type:"button",onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:""})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Name"}),v.jsx("input",{type:"text",value:T.name,onChange:G=>C({...T,name:G.target.value}),placeholder:"e.g., Wallet Cash, My Venmo",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type"}),v.jsxs("select",{value:T.network,onChange:G=>C({...T,network:G.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[v.jsx("option",{value:"Visa",children:"Visa"}),v.jsx("option",{value:"Mastercard",children:"Mastercard"}),v.jsx("option",{value:"Amex",children:"Amex"}),v.jsx("option",{value:"Cash",children:"Cash"}),v.jsx("option",{value:"Venmo",children:"Venmo"})]})]}),!["Cash","Venmo"].includes(T.network)&&v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Last 4 Digits"}),v.jsx("input",{type:"text",value:T.last4,onChange:G=>C({...T,last4:G.target.value.replace(/\D/g,"").slice(0,4)}),placeholder:"1234",maxLength:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:se.map(G=>v.jsx("button",{type:"button",onClick:()=>C({...T,color:G}),className:`w-full h-10 rounded-lg border-2 transition-all ${T.color===G?"border-blue-500 scale-110":"border-gray-300 dark:border-gray-600"}`,style:{backgroundColor:G}},G))})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Preview"}),v.jsxs("div",{className:"w-full h-20 rounded-lg flex flex-col justify-between p-3 shadow-lg text-white font-mono text-xs",style:{backgroundColor:T.color},children:[v.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:T.network}),v.jsx("span",{className:"text-left text-[9px] leading-none",children:["Cash","Venmo"].includes(T.network)?T.network==="Cash"?"$$$":"@":` ${T.last4||"0000"}`})]})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{type:"button",onClick:()=>m(!1),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"button",onClick:O,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors",children:"Add"})]})]})]})}),E&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-sm mx-4",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center mx-auto mb-4",children:v.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Delete Card"}),v.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Are you sure you want to delete ",v.jsx("span",{className:"font-medium",children:E.name}),"?"]}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{type:"button",onClick:U,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"button",onClick:L,className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md transition-colors",children:"Delete"})]})]})})})]})},D3=({isVisible:t,onClose:e,mode:n,currentEnvelope:r,initialTransaction:i})=>{const{addTransaction:a,updateTransaction:o,deleteTransaction:c,currentMonth:u}=Qt(),[d,h]=B.useState(""),[p,m]=B.useState(""),[b,w]=B.useState(""),[E,S]=B.useState(new Date().toISOString().split("T")[0]),[T,C]=B.useState(null);B.useEffect(()=>{if(t)if(n==="edit"&&i){h(i.amount.toString()),m(i.merchant||""),w(i.description),C(i.paymentMethod||null);try{const A=new Date(i.date);isNaN(A.getTime())?(console.warn("Invalid date in transaction:",i.date),S(new Date().toISOString().split("T")[0])):S(A.toISOString().split("T")[0])}catch(A){console.error("Error parsing transaction date:",A),S(new Date().toISOString().split("T")[0])}}else h(""),m(""),w(""),S(new Date().toISOString().split("T")[0])},[t,n,i]);const N=async A=>{A.preventDefault();const k=parseFloat(d);if(isNaN(k)||k<=0){console.log(" Invalid amount:",d);return}console.log(" Saving transaction:",{mode:n,amount:k,note:b,date:E,envelopeId:r.id,paymentMethod:T});try{const D=new Date(E),V=`${D.getFullYear()}-${(D.getMonth()+1).toString().padStart(2,"0")}`;if(V!==u){const L=`This transaction date (${V}) does not match the current budget month (${u}). Are you sure you want to save it?`;if(!window.confirm(L))return}n==="add"?(console.log(" Adding income transaction"),await a({amount:k,description:b,merchant:p||void 0,date:new Date(E).toISOString(),envelopeId:r.id,type:"Income",reconciled:!1,paymentMethod:T||void 0})):n==="spend"?(console.log(" Adding expense transaction"),await a({amount:k,description:b,merchant:p||void 0,date:new Date(E).toISOString(),envelopeId:r.id,type:"Expense",reconciled:!1,paymentMethod:T||void 0})):n==="edit"&&i&&(console.log(" Updating transaction"),await o({...i,amount:k,description:b,merchant:p||void 0,date:new Date(E).toISOString(),paymentMethod:T||void 0})),console.log(" Transaction saved successfully"),e()}catch(D){console.error(" Error saving transaction:",D),alert("Failed to save transaction: "+(D instanceof Error?D.message:"Unknown error"))}},j=()=>{!i||!i.id||window.confirm("Are you sure you want to delete this transaction?")&&(c(i.id),e())},P=n==="add"?"Add Money":n==="spend"?"Spend Money":"Edit Transaction",M=n==="add"?"text-green-500":"text-red-500";return v.jsx(ai,{children:t&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(gn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),v.jsxs(gn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden relative z-10",children:[v.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),v.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:P}),v.jsx("button",{onClick:N,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!d||parseFloat(d)<=0||i?.isAutomatic,children:i?.isAutomatic?"":"Save"})]}),v.jsxs("form",{onSubmit:N,className:"p-6 space-y-6",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${M}`,children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:d,onChange:A=>{const k=A.target.value.replace(/\D/g,"");if(!k){h("");return}const V=(parseInt(k,10)/100).toFixed(2);h(V)},onKeyDown:A=>{(A.key==="e"||A.key==="E"||A.key==="+"||A.key==="-")&&A.preventDefault()},placeholder:"0.00",autoFocus:!0,disabled:i?.isAutomatic,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${M} placeholder-gray-700 ${i?.isAutomatic?"cursor-not-allowed opacity-80":""}`})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),v.jsx("input",{type:"text",value:p,onChange:A=>m(A.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none",disabled:i?.isAutomatic})]}),!i?.isAutomatic&&v.jsx(N3,{selectedCard:T,onCardSelect:C}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),v.jsx("input",{type:"text",value:b,onChange:A=>w(A.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none",disabled:i?.isAutomatic})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const A=new Date(E);return`${A.getFullYear()}-${(A.getMonth()+1).toString().padStart(2,"0")}`!==u?v.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[v.jsx(wu,{size:14}),v.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),v.jsx("input",{type:"date",value:E,onChange:A=>{console.log("Date changed to:",A.target.value),S(A.target.value)},required:!0,disabled:i?.isAutomatic,className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark] disabled:opacity-80"})]}),n==="edit"&&!i?.isAutomatic&&v.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-zinc-800",children:v.jsxs("button",{type:"button",onClick:j,className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-50 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-200 dark:border-zinc-800",children:[v.jsx(HD,{className:"w-5 h-5 mr-2"}),"Delete Transaction"]})})]})]})]})})},wee=({isVisible:t,onClose:e,sourceEnvelope:n})=>{const{envelopes:r,transferFunds:i}=Qt(),[a,o]=B.useState(""),[c,u]=B.useState(""),[d,h]=B.useState(""),[p,m]=B.useState(new Date().toISOString().split("T")[0]),b=r.filter(S=>S.id!==n.id);B.useEffect(()=>{if(!t)return;const S=window.setTimeout(()=>{o(""),u(""),h(""),m(new Date().toISOString().split("T")[0])},0);return()=>window.clearTimeout(S)},[t]);const w=S=>{S.preventDefault();const T=parseFloat(c);isNaN(T)||T<=0||!a||(i(n.id,a,T,d,new Date(p)),e())},E=r.find(S=>S.id===a);return v.jsx(ai,{children:t&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(gn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),v.jsxs(gn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden relative z-10",children:[v.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),v.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:"Transfer Money"}),v.jsx("button",{onClick:w,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!c||parseFloat(c)<=0||!a,children:"Transfer"})]}),v.jsxs("form",{onSubmit:w,className:"p-6 space-y-6",children:[v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"From"}),v.jsx("div",{className:"text-gray-900 dark:text-white font-medium",children:n.name})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"To"}),v.jsxs("select",{value:a,onChange:S=>o(S.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none cursor-pointer",children:[v.jsx("option",{value:"",className:"bg-white dark:bg-zinc-900",children:"Select envelope..."}),b.map(S=>v.jsx("option",{value:S.id,className:"bg-white dark:bg-zinc-900",children:S.name},S.id))]})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl text-blue-600 dark:text-blue-400",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:c,onChange:S=>{const T=S.target.value.replace(/\D/g,"");if(!T){u("");return}const N=(parseInt(T,10)/100).toFixed(2);u(N)},onKeyDown:S=>{(S.key==="e"||S.key==="E"||S.key==="+"||S.key==="-")&&S.preventDefault()},placeholder:"0.00",autoFocus:!0,className:"bg-transparent text-4xl font-bold text-center w-40 focus:outline-none text-blue-600 dark:text-blue-400 placeholder-gray-400 dark:placeholder-gray-600"})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note (Optional)"}),v.jsx("input",{type:"text",value:d,onChange:S=>h(S.target.value),placeholder:"What is this transfer for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Date"}),v.jsx("input",{type:"date",value:p,onChange:S=>m(S.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),E&&c&&parseFloat(c)>0&&v.jsxs("div",{className:"text-center text-sm text-gray-500 dark:text-zinc-400 pt-2 border-t border-gray-200 dark:border-zinc-800",children:["Moving ",v.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-bold",children:["$",parseFloat(c).toFixed(2)]})," from"," ",v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:n.name})," to"," ",v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:E.name})]})]})]})]})})},_ee=({isOpen:t,onClose:e,onSave:n,existingPiggybank:r})=>{const[i,a]=B.useState(""),[o,c]=B.useState(""),[u,d]=B.useState(""),[h,p]=B.useState("#3B82F6"),[m,b]=B.useState("piggy-bank"),[w,E]=B.useState(!1),[S,T]=B.useState(!1);B.useEffect(()=>{r?(a(r.name),c(r.piggybankConfig?.targetAmount?.toString()||""),d(r.piggybankConfig?.monthlyContribution.toString()||"0"),p(r.piggybankConfig?.color||"#3B82F6"),b(r.piggybankConfig?.icon||"piggy-bank"),E(r.piggybankConfig?.paused||!1)):(a(""),c(""),d(""),p("#3B82F6"),b("piggy-bank"),E(!1))},[r,t]);const C=async j=>{if(j.preventDefault(),!(!i.trim()||!u)){T(!0);try{const P={name:i.trim(),isPiggybank:!0,piggybankConfig:{monthlyContribution:parseFloat(u),color:h,icon:m,paused:w}};o&&parseFloat(o)>0&&(P.piggybankConfig.targetAmount=parseFloat(o)),r&&(P.id=r.id,P.currentBalance=r.currentBalance,P.lastUpdated=new Date().toISOString(),P.isActive=r.isActive,P.orderIndex=r.orderIndex,P.userId=r.userId),await n(P),e()}catch(P){console.error("Error saving piggybank:",P),alert("Failed to save piggybank")}finally{T(!1)}}},N=[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#F59E0B",label:"Amber"},{value:"#EF4444",label:"Red"},{value:"#8B5CF6",label:"Purple"},{value:"#EC4899",label:"Pink"}];return v.jsx(ai,{children:t&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(gn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),v.jsxs(gn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"sticky top-0 bg-white dark:bg-zinc-900 border-b border-gray-200 dark:border-zinc-800 px-6 py-4 flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center",children:v.jsx(Ah,{size:20,className:"text-blue-600 dark:text-blue-400"})}),v.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:r?"Edit Piggybank":"New Piggybank"})]}),v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:v.jsx(w0,{size:24})})]}),v.jsxs("form",{onSubmit:C,className:"p-6 space-y-5",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"piggybank-name",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Piggybank Name *"}),v.jsx("input",{type:"text",id:"piggybank-name",value:i,onChange:j=>a(j.target.value),placeholder:"e.g. Vacation Fund, Emergency Savings",className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:!0,autoFocus:!0})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"monthly-contribution",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Monthly Auto-Contribution *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",id:"monthly-contribution",value:u,onChange:j=>{const P=j.target.value.replace(/\D/g,"");if(!P){d("");return}const A=(parseInt(P,10)/100).toFixed(2);d(A)},placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:!0})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"This amount will be automatically added each month and deducted from Available to Budget"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Target Goal (Optional)"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",id:"target-amount",value:o,onChange:j=>{const P=j.target.value.replace(/\D/g,"");if(!P){c("");return}const A=(parseInt(P,10)/100).toFixed(2);c(A)},placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Set a savings goal to track progress"})]}),v.jsx("div",{className:"space-y-2",children:v.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[v.jsx("input",{type:"checkbox",checked:w,onChange:j=>E(j.target.checked),className:"w-5 h-5 rounded border-gray-300 dark:border-zinc-700 text-blue-600 focus:ring-2 focus:ring-blue-500"}),v.jsxs("div",{children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Pause auto-contributions"}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Monthly contributions will be skipped while paused"})]})]})}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:N.map(j=>v.jsx("button",{type:"button",onClick:()=>p(j.value),className:`w-full aspect-square rounded-lg transition-all ${h===j.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-zinc-900":"hover:scale-110"}`,style:{backgroundColor:j.value},title:j.label},j.value))})]}),v.jsxs("div",{className:"pt-4 flex gap-3",children:[v.jsx("button",{type:"button",onClick:e,className:"flex-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 font-semibold bg-white dark:bg-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",disabled:S,children:"Cancel"}),v.jsx("button",{type:"submit",disabled:!i.trim()||!u||S,className:`flex-1 py-3 px-4 rounded-xl font-semibold shadow-sm text-white transition-colors ${i.trim()&&u&&!S?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-300 dark:bg-zinc-600 cursor-not-allowed"}`,children:S?"Saving...":r?"Update":"Create"})]})]})]})]})})},Eee=t=>{if(!t)return"No Date";try{let e;return t&&typeof t=="object"&&t.toDate&&typeof t.toDate=="function"?e=t.toDate():typeof t=="number"?t<1e10?e=new Date((t+978307200)*1e3):e=new Date(t):e=new Date(t),isNaN(e.getTime())?"Invalid Date":new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(e)}catch(e){return console.error("Date error:",e),"Error"}},See=t=>{const e=typeof t=="string"?parseFloat(t):t;return typeof e!="number"||isNaN(e)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.abs(e))},I3=({transaction:t,envelopeName:e,onReconcile:n,onEdit:r})=>{if(!t)return null;console.log(" Transaction payment method:",t.paymentMethod);const i=t.type==="Income",a=t.type==="Expense";let o="text-gray-900 dark:text-white";return i&&(o="text-green-600 dark:text-green-400"),a&&(o="text-red-600 dark:text-red-400"),v.jsxs("div",{onClick:r,className:"flex items-center justify-between p-4 bg-white dark:bg-zinc-900 active:bg-gray-50 dark:active:bg-zinc-800 active:scale-[0.99] transition-all cursor-pointer group border-b border-gray-100 dark:border-zinc-800 last:border-0",children:[v.jsxs("div",{className:"flex flex-col gap-1 overflow-hidden",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"font-semibold text-gray-900 dark:text-white truncate",children:t.merchant||t.description||"No Description"}),t.reconciled&&v.jsx("span",{className:"text-[10px] bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 px-1.5 py-0.5 rounded-full font-bold uppercase tracking-wide",children:"R"})]}),t.merchant&&t.description&&t.description!==t.merchant&&v.jsx("div",{className:"text-xs text-gray-600 dark:text-zinc-400 truncate",children:t.description}),v.jsxs("div",{className:"text-xs text-gray-500 dark:text-zinc-500 flex items-center gap-1 flex-wrap",children:[v.jsx("span",{children:Eee(t.date)}),e&&v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""}),v.jsx("span",{className:"text-blue-500 dark:text-blue-400 truncate max-w-[150px]",children:e})]}),t.paymentMethod&&v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""}),v.jsxs("span",{className:"flex items-center gap-1",children:[v.jsx("span",{className:"w-[12px] h-[8px] rounded-[2px] flex-shrink-0",style:{backgroundColor:t.paymentMethod.color}}),v.jsx("span",{className:"truncate max-w-[80px]",children:t.paymentMethod.name})]})]})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("div",{className:`font-bold font-mono whitespace-nowrap ${o}`,children:[a?"-":i?"+":"",See(t.amount)]}),n?v.jsx("button",{type:"button",onClick:c=>{c.stopPropagation(),n()},className:"p-1.5 rounded-full border border-transparent hover:border-green-200 dark:hover:border-green-500 transition-colors","aria-label":t.reconciled?"Mark as unreconciled":"Mark as reconciled",children:t.reconciled?v.jsx(ms,{className:"text-green-500",size:20}):v.jsx(YC,{className:"text-gray-400",size:20})}):v.jsx("span",{children:t.reconciled?v.jsx(ms,{className:"text-green-500",size:20}):v.jsx(YC,{className:"text-gray-400",size:20})})]})]})},gx=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t),Tee=()=>{const{id:t}=b9(),{envelopes:e,transactions:n,fetchData:r,isLoading:i,deleteEnvelope:a,renameEnvelope:o,updateTransaction:c,deleteTransaction:u,restoreTransaction:d,getEnvelopeBalance:h,currentMonth:p,allocations:m,incomeSources:b,setEnvelopeAllocation:w,updatePiggybankContribution:E,updateEnvelope:S}=Qt(),{showToast:T}=cc(),C=qa(),N=aa(),[j,P]=B.useState(!1),[M,A]=B.useState(!1),[k,D]=B.useState(!1),[V,L]=B.useState(null),[U,O]=B.useState(!1),[J,W]=B.useState(!1),[q,K]=B.useState(""),te=B.useRef(null),se=B.useRef(!1);B.useEffect(()=>{e.length===0&&r()},[]);const G=e.find(ae=>ae.id===t),F=async ae=>{if(G)try{const Ae={...G,...ae,id:G.id,userId:G.userId,currentBalance:G.currentBalance,lastUpdated:new Date().toISOString(),isActive:G.isActive,orderIndex:G.orderIndex};await S(Ae),T("Piggybank updated successfully","success"),O(!1)}catch(Ae){console.error("Failed to update piggybank:",Ae),T("Failed to update piggybank","error")}},Y=G?.isPiggybank?G.piggybankConfig?.monthlyContribution||0:m[p]?.find(ae=>ae.envelopeId===t)?.budgetedAmount||0;B.useEffect(()=>{J&&(K(Y.toString()),setTimeout(()=>{te.current?.focus(),te.current?.select()},50))},[J,Y]);const Q=ae=>{const Ae=(b[p]||[]).reduce((ze,Se)=>ze+Se.amount,0),Re=m[p]||[];let Ve=Re.map(ze=>G&&ze.envelopeId===G.id&&ae!==void 0?{...ze,budgetedAmount:ae}:ze).filter(ze=>{const Se=e.find(Le=>Le.id===ze.envelopeId);return Se?Se.isActive!==!1:!1}).reduce((ze,Se)=>ze+Se.budgetedAmount,0);return ae!==void 0&&G&&(Re.some(Se=>Se.envelopeId===G.id)||(Ve+=ae)),Ae-Ve},ie=J?Q(parseFloat(q)||0):Q(),le=async()=>{if(!G||se.current)return;const ae=parseFloat(q);if(isNaN(ae)||ae<0){T("Please enter a valid positive number","error");return}se.current=!0;try{G.isPiggybank?await E(G.id,ae):await w(G.id,ae),W(!1)}catch(Ae){console.error("Failed to save budget:",Ae),T("Failed to update budget","error")}finally{se.current=!1}};if(!G)return i?v.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:v.jsx("p",{children:"Loading envelope..."})}):v.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:v.jsx("p",{children:"Envelope not found."})});if(G.isPiggybank){const ae=n.filter(Ae=>Ae.envelopeId===G.id);console.log(" Piggybank:",G.name),console.log(" Created at:",G.createdAt),console.log(" Transactions:",ae.map(Ae=>({date:Ae.date,description:Ae.description,amount:Ae.amount})))}const ge=n.filter(ae=>ae.envelopeId===G.id).filter(ae=>{if(ae.description==="Budgeted"||ae.description==="Piggybank Contribution")return!1;if(G.isPiggybank){if(!G.createdAt)return!0;const Ae=s0(G.createdAt).toISOString().split("T")[0];return s0(ae.date).toISOString().split("T")[0]>=Ae}return ae.month===p||!ae.month}).sort((ae,Ae)=>new Date(Ae.date).getTime()-new Date(ae.date).getTime()),pe=()=>{N.state?.fromGlobalFAB?C("/"):C(-1)},_e=()=>{t&&(a(t),C(-1))},Ie=ae=>{const Ae={...ae,reconciled:!ae.reconciled};c(Ae)};return v.jsxs("div",{className:"min-h-screen bg-white dark:bg-black text-gray-900 dark:text-white p-4 pb-[calc(8rem+env(safe-area-inset-bottom))] max-w-4xl mx-auto",children:[v.jsxs("header",{className:"flex justify-between items-center pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 bg-white dark:bg-black z-10 border-b border-gray-100 dark:border-zinc-800",children:[v.jsx("button",{onClick:()=>{if(G.isPiggybank)O(!0);else{const ae=prompt("Rename envelope:",G.name);ae&&ae.trim()&&t&&o(t,ae)}},className:"text-blue-600 dark:text-blue-400 font-medium",children:G.isPiggybank?"Edit":"Rename"}),v.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:G.name}),v.jsx("button",{onClick:pe,className:"text-blue-600 dark:text-blue-400 font-bold",children:"Done"})]}),v.jsxs("section",{className:"mt-4 bg-white dark:bg-zinc-900 rounded-lg p-4 shadow-lg mb-4 border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-2",children:[v.jsx("span",{className:"text-lg font-headline text-gray-900 dark:text-white",children:"Current Balance"}),(()=>{const ae=G.isPiggybank?h(G.id):h(G.id,p);return console.log(`Debug: Envelope ${G.name} Balance:`,ae),v.jsx("span",{className:`text-xl font-bold ${ae<0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:gx(ae)})})()]}),v.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("span",{className:"text-sm font-medium text-gray-500 dark:text-zinc-400",children:G.isPiggybank?"Monthly Contribution":"Budgeted This Month"}),J?v.jsx("form",{onSubmit:ae=>{ae.preventDefault(),le()},className:"flex items-center gap-2",children:v.jsx("input",{ref:te,type:"number",step:"0.01",value:q,onChange:ae=>K(ae.target.value),onBlur:le,className:"w-24 px-2 py-1 text-right font-semibold bg-gray-100 dark:bg-zinc-800 rounded border border-blue-500 focus:outline-none"})}):v.jsx("div",{onClick:()=>W(!0),className:"px-2 py-1 -mr-2 rounded hover:bg-gray-100 dark:hover:bg-zinc-800 cursor-pointer transition-colors",children:v.jsx("span",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:gx(Y)})})]}),v.jsxs("div",{className:`mt-3 py-1.5 px-3 rounded-md flex justify-between items-center text-xs font-medium transition-colors ${ie<0?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":ie===0?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300"}`,children:[v.jsx("span",{children:"Left to Budget:"}),v.jsx("span",{children:gx(ie)})]})]})]}),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg mb-4 divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:[v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-green-600 dark:text-green-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>P(!0),children:[v.jsx(LB,{className:"w-5 h-5 mr-3"}),"Add Money"]}),v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>A(!0),children:[v.jsx(VB,{className:"w-5 h-5 mr-3"}),"Spend Money"]}),v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>D(!0),children:[v.jsx(_B,{className:"w-5 h-5 mr-3"}),"Transfer Money"]})]}),v.jsxs("section",{className:"mt-6",children:[v.jsx("h2",{className:"text-sm font-semibold uppercase text-gray-500 dark:text-zinc-400 mb-2 px-2",children:"Transaction History"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:ge.length===0?v.jsx("p",{className:"p-4 text-center text-gray-500 dark:text-zinc-400",children:"No transactions yet for this envelope."}):v.jsx(ai,{initial:!1,mode:"popLayout",children:ge.map(ae=>v.jsx(gn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(dv,{disabled:ae.isAutomatic,onDelete:()=>{if(!ae.id)return;const Ae={...ae};u(ae.id),T("Transaction deleted","neutral",()=>d(Ae))},children:v.jsx(I3,{transaction:ae,onReconcile:()=>Ie(ae),onEdit:()=>{ae.isAutomatic||L(ae)}})})},ae.id))})})]}),v.jsx("div",{className:"mt-8",children:v.jsxs("button",{className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-100 dark:border-zinc-800",onClick:()=>{const ae=G.isPiggybank?`Are you sure you want to delete "${G.name}"? This will delete the piggybank and all its history.`:`Are you sure you want to remove "${G.name}" from ${p}? This will delete all transactions for this month only.`;confirm(ae)&&_e()},children:[v.jsx(HD,{className:"w-5 h-5 mr-2"}),"Delete Envelope"]})}),v.jsx(D3,{isVisible:j||M||!!V,onClose:()=>{P(!1),A(!1),L(null)},mode:j?"add":M?"spend":"edit",currentEnvelope:G,initialTransaction:V}),v.jsx(wee,{isVisible:k,onClose:()=>D(!1),sourceEnvelope:G}),v.jsx(_ee,{isOpen:U,onClose:()=>O(!1),onSave:F,existingPiggybank:G})]})},Aee=({isVisible:t,onClose:e,onConfirm:n,currentMonth:r,incomeCount:i,totalIncome:a,allocationCount:o,totalAllocated:c,transactionCount:u,totalTransactionAmount:d,isLoading:h=!1})=>{const[p,m]=B.useState("confirm"),b=S=>{const[T,C]=S.split("-");return new Date(parseInt(T),parseInt(C)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},w=()=>{p==="confirm"?m("final_confirm"):p==="final_confirm"&&n()},E=()=>{m("confirm"),e()};return v.jsx(ai,{children:t&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(gn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:E,className:"absolute inset-0 bg-black bg-opacity-50"}),v.jsxs(gn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[v.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Start Fresh for ",b(r)]}),v.jsx("button",{onClick:E,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",disabled:h,children:""})]}),v.jsx("div",{className:"p-6 space-y-4",children:p==="confirm"?v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),v.jsxs("div",{className:"ml-3",children:[v.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"This action will permanently delete:"}),v.jsx("div",{className:"mt-2 text-sm text-red-700 dark:text-red-300",children:v.jsxs("ul",{className:"space-y-1",children:[v.jsxs("li",{children:[" ",i," income source",i!==1?"s":""," (totaling $",a.toFixed(2),"/month)"]}),v.jsxs("li",{children:[" ",o," envelope allocation",o!==1?"s":""," (totaling $",c.toFixed(2),")"]}),v.jsxs("li",{children:[" ",u," transaction",u!==1?"s":""," (totaling $",d.toFixed(2),")"]})]})})]})]})}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),v.jsx("div",{className:"ml-3",children:v.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[v.jsx("strong",{children:"All other months will remain completely unchanged."})," This only affects the current month's budget data, income sources, allocations, and all transactions."]})})]})})]}):v.jsxs("div",{className:"text-center py-4",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900 mb-4",children:v.jsx("svg",{className:"h-6 w-6 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),v.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 dark:text-white mb-2",children:"Are you absolutely sure?"}),v.jsxs("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:["This action cannot be undone. All budget data and transactions for ",v.jsx("strong",{children:b(r)})," will be permanently removed."]})]})}),v.jsxs("div",{className:"flex gap-3 p-6 border-t border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{type:"button",onClick:E,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",disabled:h,children:"Cancel"}),v.jsx("button",{type:"button",onClick:w,disabled:h,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:h?"Clearing...":p==="confirm"?"Continue":"Yes, Start Fresh"})]})]})]})})},Cee=()=>{const t=qa(),e=B.useRef(null),{envelopes:n,transactions:r,resetData:i,importData:a,getEnvelopeBalance:o,appSettings:c,updateAppSettings:u,initializeAppSettings:d,incomeSources:h,allocations:p,currentMonth:m,clearMonthData:b,handleUserLogout:w,resetOnboarding:E}=Qt(),{deleteAccount:S,currentUser:T,logout:C}=Ai(),[N,j]=B.useState(null),[P,M]=B.useState(()=>localStorage.getItem("lastBackupDate")||"Never"),[A,k]=B.useState(!1),[D,V]=B.useState(""),[L,U]=B.useState(!1),[O,J]=B.useState(!1),[W,q]=B.useState(null),[K,te]=B.useState(!1),[se,G]=B.useState(!1),F=978307200,Y=c?.theme??"system",Q=c?.fontSize??"medium";B.useEffect(()=>{c||d().catch(Se=>{console.error("Failed to initialize app settings:",Se)})},[d,c]);const X=(Se,Le)=>{j({type:Se,text:Le}),setTimeout(()=>j(null),3500)},ie=B.useMemo(()=>{const Se=n.length,Le=r.length,Me=m?p[m]||[]:[],Be=Object.values(h).reduce((cn,Mt)=>cn+Mt.length,0),st=Me.length,_t=n.reduce((cn,Mt)=>{const _n=Mt.isPiggybank?o(Mt.id):o(Mt.id,m);return cn+(typeof _n=="number"?_n:0)},0),Ze=0,ut=r.reduce((cn,Mt)=>{let _n=0;if(typeof Mt.date=="string"){const $r=Date.parse(Mt.date);_n=Number.isNaN($r)?0:$r}else typeof Mt.date=="number"&&(_n=Mt.date<2e9?(Mt.date+F)*1e3:Mt.date);return Math.max(cn,_n)},0),Rt=Ze||ut?new Date(Math.max(Ze,ut)).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"Never";return{envelopeCount:Se,transactionCount:Le,incomeSourceCount:Be,allocationCount:st,totalBalance:_t,lastUpdated:Rt}},[n,r,h,p,m]),le=()=>{try{console.log(" Creating backup...");const Se={appVersion:"1.7.0",backupDate:Date.now(),appSettings:c||{theme:"system"},envelopes:n.map(_t=>({..._t,currentBalance:(()=>{const Ze=_t.isPiggybank?o(_t.id):o(_t.id,m);return typeof Ze=="number"?Ze:0})(),lastUpdated:new Date().toISOString()})),transactions:r,allocations:p,incomeSources:h},Le=new Blob([JSON.stringify(Se,null,2)],{type:"application/json"}),Me=URL.createObjectURL(Le),Be=document.createElement("a");Be.href=Me,Be.download=`HouseBudget_Backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(Be),Be.click(),document.body.removeChild(Be),URL.revokeObjectURL(Me);const st=new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});localStorage.setItem("lastBackupDate",st),M(st),q({success:!0,message:"Backup downloaded successfully."})}catch(Se){console.error(Se),q({success:!1,message:"Failed to create backup file.",onRetry:le})}},ge=()=>{J(!0),q(null);try{const Se=["Date","Merchant","Payment Method","Notes","Amount","Type","Envelope","Reconciled"],Le=r.filter(Ze=>Ze.description!=="Budgeted"&&Ze.description!=="Piggybank Contribution").map(Ze=>{const ut=n.find(sa=>sa.id===Ze.envelopeId)?.name||"Unknown",Rt=(Ze.merchant||"").replace(/"/g,'""'),cn=(Ze.description||"").replace(/"/g,'""');let Mt="";Ze.paymentMethod&&(Mt=`${Ze.paymentMethod.name} (...${Ze.paymentMethod.last4})`);const _n=Mt.replace(/"/g,'""');let $r="Invalid Date";if(Ze.date){if(typeof Ze.date=="string")$r=Ze.date.split("T")[0];else if(typeof Ze.date=="number"){const sa=Ze.date<2e9?(Ze.date+F)*1e3:Ze.date;$r=new Date(sa).toISOString().split("T")[0]}}return[$r,`"${Rt}"`,`"${_n}"`,`"${cn}"`,Ze.amount.toFixed(2),Ze.type,`"${ut}"`,Ze.reconciled?"Yes":"No"].join(",")}),Me=[Se.join(","),...Le].join(`
`),Be=new Blob([Me],{type:"text/csv;charset=utf-8;"}),st=URL.createObjectURL(Be),_t=document.createElement("a");_t.href=st,_t.download=`HouseBudget_Transactions_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(_t),_t.click(),document.body.removeChild(_t),URL.revokeObjectURL(st),q({success:!0,message:"Transactions CSV exported successfully."})}catch(Se){console.error(Se),q({success:!1,message:"Failed to export CSV. Please try again.",onRetry:ge})}finally{J(!1)}},pe=()=>{e.current?.click()},_e=Se=>{const Le=Se.target.files?.[0];if(!Le)return;const Me=new FileReader;Me.onload=async Be=>{try{const st=JSON.parse(Be.target?.result),_t=await a(st);if(!_t.success){X("error",_t.message);return}if(st.appSettings?.theme)try{await u({theme:st.appSettings.theme})}catch(Ze){console.error("Failed to update imported settings:",Ze)}X("success",`Loaded ${st.envelopes?.length??0} envelopes, ${st.transactions?.length??0} transactions.`)}catch(st){console.error(st),X("error","Invalid backup file. Please verify the JSON.")}},Me.readAsText(Le),Se.target.value=""},Ie=async()=>{if(window.confirm("Are you sure? This will permanently delete all envelopes, transactions, budget allocations, income sources, and settings from the cloud. This action cannot be undone."))try{await i(),X("success","All data has been permanently deleted."),t("/")}catch(Se){console.error("Reset failed:",Se),X("error","Failed to delete all data. Some data may remain.")}},ae=async()=>{if(!D.trim()){X("error","Please enter your password to confirm account deletion.");return}k(!0);try{await i(),await S(D)?X("success","Your account has been permanently deleted."):X("error","Failed to delete account. Please try again.")}catch(Se){console.error("Account deletion failed:",Se),X("error","Failed to delete account. Please try again.")}finally{k(!1),U(!1),V("")}},Ae=async()=>{if(!T){X("error","You must be logged in to clean up data.");return}te(!0);try{const Se=await kE.cleanupOrphanedData(T.id),Le=Se.orphanedAllocationsDeleted+Se.orphanedTransactionsDeleted;Le>0?X("success",`Cleaned ${Le} orphaned items: ${Se.orphanedAllocationsDeleted} allocations and ${Se.orphanedTransactionsDeleted} transactions.`):X("success","No orphaned data found. Your database is already clean!")}catch(Se){console.error("Cleanup failed:",Se),X("error","Failed to clean up orphaned data. Please try again.")}finally{te(!1)}},Re=()=>{G(!0)},De=async()=>{G(!1),await b(m),X("success","Month data has been reset.")},Ve=async()=>{if(window.confirm("Are you sure you want to log out? This will clear all your data from the app until you log back in."))try{w(),C(),t("/")}catch(Se){console.error("Logout failed:",Se)}},ze=T?.displayName?.charAt(0)?.toUpperCase()||T?.email?.charAt(0)?.toUpperCase()||"U";return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black transition-colors duration-200",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-center shadow-sm relative",children:[v.jsx("button",{onClick:()=>t(-1),className:"absolute left-4 text-blue-600 dark:text-blue-400 font-medium",children:"Done"}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Settings"})]}),v.jsxs("div",{className:"p-4 space-y-6 max-w-4xl mx-auto pb-[calc(8rem+env(safe-area-inset-bottom))]",children:[N&&v.jsxs("div",{className:`px-4 py-3 rounded-2xl text-sm font-medium flex items-center gap-2 ${N.type==="success"?"bg-green-50 text-green-700 dark:bg-emerald-900/30 dark:text-emerald-200":"bg-red-50 text-red-700 dark:bg-red-900/30 dark:text-red-200"}`,children:[N.type==="success"?v.jsx(Cm,{size:18}):v.jsx(km,{size:18}),N.text]}),v.jsx("section",{children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4 flex items-center gap-4",children:[v.jsx("div",{className:"w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center text-white text-2xl font-semibold shadow-md",children:ze}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white truncate",children:T?.displayName||T?.email?.split("@")[0]||"User"}),v.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400 truncate",children:T?.email}),v.jsxs("button",{onClick:Ve,className:"mt-2 text-sm text-red-600 dark:text-red-400 font-medium flex items-center gap-1 hover:underline",children:[v.jsx(cU,{size:14})," Log Out"]})]})]})}),v.jsx("section",{children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-5 space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(WC,{className:"text-blue-500",size:22}),v.jsxs("div",{children:[v.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Backup & Restore"}),v.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Create backups of all your data including envelopes, transactions, budget allocations, income sources, and settings."})]})]}),v.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 pt-2",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Envelopes"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:ie.envelopeCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Transactions"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:ie.transactionCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Income Sources"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:ie.incomeSourceCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Allocations"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:ie.allocationCount})]})]})]})}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Categories"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:v.jsxs("button",{onClick:()=>t("/settings/categories"),className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("span",{className:"text-xl",children:""}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Manage Categories"})]}),v.jsx(Ta,{className:"text-gray-400",size:18})]})})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Appearance"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4 space-y-4",children:[v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[Y==="light"&&v.jsx("span",{className:"text-orange-500 text-lg",children:""}),Y==="dark"&&v.jsx("span",{className:"text-purple-500 text-lg",children:""}),Y==="system"&&v.jsx("span",{className:"text-gray-500 text-lg",children:""}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Theme"})]}),v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 capitalize",children:Y})]}),v.jsx("div",{className:"flex gap-2",children:[{label:"Light",value:"light"},{label:"Dark",value:"dark"},{label:"System",value:"system"}].map(Se=>v.jsx("button",{onClick:async()=>{try{await u({theme:Se.value})}catch(Le){console.error("Failed to update theme setting:",Le)}},className:`flex-1 py-2 rounded-lg text-sm font-medium border transition-colors ${Y===Se.value?"bg-blue-50 dark:bg-blue-900/30 border-blue-500 text-blue-700 dark:text-blue-200":"border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 hover:border-gray-300 dark:hover:border-zinc-600"}`,children:Se.label},Se.value))})]}),v.jsx("div",{className:"h-px bg-gray-100 dark:bg-zinc-800"}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("span",{className:"text-gray-500 text-lg",children:"Aa"}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Font Size"})]}),v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 capitalize",children:Q})]}),v.jsx("div",{className:"flex gap-2",children:[{label:"A",value:"extra-small",sizeClass:"text-[10px]"},{label:"A",value:"small",sizeClass:"text-xs"},{label:"A",value:"medium",sizeClass:"text-base"},{label:"A",value:"large",sizeClass:"text-xl"},{label:"A",value:"extra-large",sizeClass:"text-2xl"}].map(Se=>v.jsx("button",{onClick:async()=>{try{await u({fontSize:Se.value})}catch(Le){console.error("Failed to update font size setting:",Le)}},className:`flex-1 py-2 rounded-lg font-medium border transition-colors flex items-center justify-center ${Q===Se.value?"bg-blue-50 dark:bg-blue-900/30 border-blue-500 text-blue-700 dark:text-blue-200":"border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 hover:border-gray-300 dark:hover:border-zinc-600"}`,children:v.jsx("span",{className:Se.sizeClass,children:Se.label})},Se.value))})]})]})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Help & Guide"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:v.jsxs("button",{onClick:()=>{E(),t("/")},className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Kf,{className:"text-purple-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Restart Onboarding Guide"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"View the welcome tutorial again"})]})]}),v.jsx(Ta,{className:"text-gray-400",size:18})]})})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Actions"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:[v.jsxs("button",{onClick:le,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(WC,{className:"text-blue-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Create Backup"}),v.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["Last backup: ",P]})]})]}),v.jsx(Ta,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:pe,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(VU,{className:"text-blue-500",size:20}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Restore from Backup"})]}),v.jsx(Ta,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:ge,disabled:O,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[O?v.jsx(KC,{className:"text-blue-500 animate-spin",size:20}):v.jsx(KB,{className:"text-blue-500",size:20}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:O?"Preparing CSV":"Export Transactions (CSV)"})]}),v.jsx(Ta,{className:"text-gray-400",size:18})]}),v.jsx("input",{type:"file",ref:e,onChange:_e,accept:".json",className:"hidden"})]})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Danger Zone"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm",children:[v.jsxs("button",{onClick:Re,className:"w-full p-4 flex items-center justify-between hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Wf,{className:"text-orange-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Start Fresh (This Month)"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Clear all allocations and data for the current month only"})]})]}),v.jsx(Ta,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:Ae,disabled:K,className:"w-full p-4 flex items-center justify-between hover:bg-yellow-50 dark:hover:bg-yellow-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800 disabled:opacity-60 disabled:cursor-not-allowed",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[K?v.jsx(KC,{className:"text-yellow-500 animate-spin",size:20}):v.jsx(Kf,{className:"text-yellow-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:K?"Cleaning Data...":"Purge Orphaned Data"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Remove allocations and transactions pointing to deleted envelopes"})]})]}),v.jsx(Ta,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:Ie,className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(km,{className:"text-red-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Reset All Data"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Permanently delete everything"})]})]}),v.jsx(Ta,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:()=>U(!0),className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(wu,{className:"text-red-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Delete Account"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Permanently delete your account and all data"})]})]}),v.jsx(Ta,{className:"text-gray-400",size:18})]})]})]}),v.jsxs("div",{className:"text-center py-4",children:[v.jsxs("p",{className:"text-xs text-gray-400 dark:text-zinc-500",children:["Version ","1.7.0"," (PWA)"]}),"        "]}),W&&v.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 max-w-sm w-full",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[W.success?v.jsx(Cm,{className:"text-green-500",size:24}):v.jsx(wu,{className:"text-red-500",size:24}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:W.success?"Success":"Error"})]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-300 mb-4",children:W.message}),v.jsxs("div",{className:"flex gap-2",children:[W.onRetry&&v.jsx("button",{onClick:()=>{q(null),W.onRetry?.()},className:"flex-1 py-2 px-4 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors",children:"Retry"}),v.jsx("button",{onClick:()=>q(null),className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-zinc-700 text-gray-900 dark:text-white rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-zinc-600 transition-colors",children:"Close"})]})]})}),v.jsx(Aee,{isVisible:se,onClose:()=>G(!1),onConfirm:De,currentMonth:m,incomeCount:(h[m]||[]).length,totalIncome:(h[m]||[]).reduce((Se,Le)=>Se+Le.amount,0),allocationCount:(p[m]||[]).filter(Se=>n.some(Le=>Le.id===Se.envelopeId)).length,totalAllocated:(p[m]||[]).filter(Se=>n.some(Le=>Le.id===Se.envelopeId)).reduce((Se,Le)=>Se+Le.budgetedAmount,0),transactionCount:r.filter(Se=>Se.month===m).length,totalTransactionAmount:r.filter(Se=>Se.month===m).reduce((Se,Le)=>Se+Le.amount,0)}),L&&v.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 max-w-sm w-full",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[v.jsx(wu,{className:"text-red-500",size:24}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Account"})]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-300 mb-4",children:"This action cannot be undone. This will permanently delete your account and remove all data from our servers."}),v.jsx("input",{type:"password",value:D,onChange:Se=>V(Se.target.value),placeholder:"Enter your password",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 mb-4"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>{U(!1),V("")},className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-zinc-700 text-gray-900 dark:text-white rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-zinc-600 transition-colors",children:"Cancel"}),v.jsx("button",{onClick:ae,disabled:A||!D.trim(),className:"flex-1 py-2 px-4 bg-red-500 text-white rounded-lg font-medium hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:A?"Deleting...":"Delete Account"})]})]})})]})]})},kee=()=>{const t=qa(),{categories:e,addCategory:n,updateCategory:r,deleteCategory:i,reorderCategories:a}=Qt(),{showToast:o}=cc(),[c,u]=B.useState(!1),[d,h]=B.useState(""),[p,m]=B.useState(null),[b,w]=B.useState(""),[E,S]=B.useState(e),T=B.useRef(e),[C,N]=B.useState(!1),[j,P]=B.useState(null),M=B.useRef(!1),A=B.useRef(null),k=B.useRef({}),D=B.useRef({}),V=B.useRef({activeId:null,startIndex:0,currentIndex:0,itemHeight:0});B.useEffect(()=>{C||(S(e),T.current=e)},[e,C]),B.useEffect(()=>(C?(document.body.style.overflow="hidden",document.body.style.touchAction="none"):(document.body.style.overflow="",document.body.style.touchAction=""),()=>{document.body.style.overflow="",document.body.style.touchAction=""}),[C]);const L=B.useCallback((se,G)=>{console.log(" Long press triggered for category:",G);const F=D.current[G];if(F){console.log(" Moveable instance found, starting drag"),M.current=!0;const Y=se.nativeEvent||se;F.dragStart(Y)}else console.log(" No moveable instance found for:",G)},[]),U=B.useCallback(se=>G=>{G?k.current[se]=G:delete k.current[se]},[]),O=async se=>{if(se.preventDefault(),!!d.trim())try{await n({name:d.trim(),orderIndex:e.length,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),h(""),u(!1),o("Category added","success")}catch(G){console.error(G),o("Failed to add category","error")}},J=async se=>{if(!b.trim())return;const G=e.find(F=>F.id===se);if(G)try{await r({...G,name:b.trim()}),m(null),o("Category updated","success")}catch(F){console.error(F),o("Failed to update category","error")}},W=async se=>{if(confirm("Are you sure? Envelopes in this category will become Uncategorized."))try{await i(se),o("Category deleted","success")}catch(G){console.error(G),o("Failed to delete category","error")}},q=8,K=(se,G,F)=>Math.max(G,Math.min(F,se)),te=B.useCallback(async se=>{if(!se.length)return;const G=se.map(F=>F.id);try{await a(G)}catch(F){console.error("Failed to persist category order:",F),o("Failed to save category order","error")}},[a,o]);return B.useEffect(()=>{const se=()=>{Object.values(D.current).forEach(Y=>Y?.destroy()),D.current={}};if(!E.length)return;const G=()=>{E.forEach(Y=>{const Q=k.current[Y.id];if(!Q||!A.current)return;const X=new g3(A.current,{target:Q,draggable:!0,throttleDrag:0,snappable:!0,snapThreshold:5,snapDirections:{top:!0,bottom:!0},elementSnapDirections:{top:!0,bottom:!0},clickable:!0,dragArea:!1,hideDefaultLines:!0,renderDirections:[],edge:!1,origin:!1});X.on("dragStart",le=>{if(console.log(" Moveable dragStart event",{isManualDrag:M.current,categoryId:Y.id}),!M.current){console.log(" Stopping drag - not manual"),le.stop();return}const ge=le.inputEvent.target;if(ge.tagName==="INPUT"||ge.tagName==="BUTTON"||ge.closest("button")){console.log(" Stopping drag - clicked on button/input"),le.stop();return}console.log(" Drag starting for category:",Y.id);const pe=T.current.findIndex(ae=>ae.id===Y.id),_e=le.target,Ie=_e.getBoundingClientRect();P(Y.id),V.current={activeId:Y.id,startIndex:pe,currentIndex:pe,itemHeight:Ie.height+q},_e.style.transition="none",_e.style.boxShadow="0 18px 45px rgba(15,23,42,0.35)",_e.style.zIndex="20",N(!0)});let ie=null;X.on("drag",le=>{const ge=le.target;ie!==null&&cancelAnimationFrame(ie),ie=requestAnimationFrame(()=>{const pe=V.current;if(pe.activeId!==Y.id)return;const _e=le.beforeTranslate[1];ge.style.transform=`translateY(${_e}px)`,ge.style.transition="none";const{itemHeight:Ie,startIndex:ae}=pe,Ae=Math.round(_e/Ie),Re=K(ae+Ae,0,T.current.length-1);Re!==pe.currentIndex&&(pe.currentIndex=Re,T.current.forEach((De,Ve)=>{if(De.id===Y.id)return;const ze=k.current[De.id];if(!ze)return;let Se=0;ae<Re&&Ve>ae&&Ve<=Re?Se=-Ie:ae>Re&&Ve>=Re&&Ve<ae&&(Se=Ie),ze.style.transform=Se?`translateY(${Se}px)`:"",ze.style.transition="transform 0.2s ease"})),ie=null})}),X.on("dragEnd",le=>{ie!==null&&(cancelAnimationFrame(ie),ie=null);const ge=le.target,{startIndex:pe,currentIndex:_e}=V.current;if(ge.style.transform="",ge.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease",ge.style.boxShadow="",T.current.forEach(Ie=>{const ae=k.current[Ie.id];ae&&(ae.style.transform="",ae.style.transition="")}),pe!==_e){const Ie=[...T.current],[ae]=Ie.splice(pe,1);Ie.splice(_e,0,ae),T.current=Ie,S(Ie),te(Ie)}setTimeout(()=>{ge.style.zIndex="",P(null),N(!1),M.current=!1},300)}),D.current[Y.id]=X})},F=window.setTimeout(G,80);return()=>{clearTimeout(F),se()}},[E,te]),v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-20",children:[v.jsx("style",{children:`
        .moveable-control-box,
        .moveable-line,
        .moveable-direction {
          display: none !important;
        }
      `}),v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-10 flex items-center shadow-sm",children:[v.jsx("button",{onClick:()=>t(-1),className:"mr-3 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white",children:v.jsx(Bo,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Manage Categories"})]}),v.jsxs("div",{className:"p-4 max-w-2xl mx-auto space-y-4",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:c?v.jsxs("form",{onSubmit:O,className:"flex gap-2",children:[v.jsx("input",{type:"text",value:d,onChange:se=>h(se.target.value),placeholder:"Category Name",className:"flex-1 px-3 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg outline-none dark:text-white",autoFocus:!0}),v.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium",children:"Save"}),v.jsx("button",{type:"button",onClick:()=>u(!1),className:"text-gray-500 px-2",children:"Cancel"})]}):v.jsxs("button",{onClick:()=>u(!0),className:"w-full flex items-center justify-center gap-2 text-blue-600 dark:text-blue-400 font-medium py-2",children:[v.jsx(Ch,{size:20}),"Add Category"]})}),v.jsxs("div",{ref:A,className:"space-y-2",style:{touchAction:C?"none":"auto"},children:[E.map(se=>{const G=AE(Y=>{L(Y,se.id)},{threshold:500,cancelOnMovement:25,detect:Do.Touch}),F=j===se.id;return v.jsx("div",{...G(),ref:U(se.id),style:{cursor:F?"grabbing":"pointer"},className:"bg-white dark:bg-zinc-900 rounded-xl p-4 border border-gray-100 dark:border-zinc-800 flex items-center justify-between group select-none",children:p===se.id?v.jsxs("div",{className:"flex-1 flex gap-2",children:[v.jsx("input",{type:"text",value:b,onChange:Y=>w(Y.target.value),className:"flex-1 px-3 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg outline-none dark:text-white",autoFocus:!0}),v.jsx("button",{onClick:()=>J(se.id),className:"bg-green-600 text-white px-3 py-2 rounded-lg text-sm",children:"Save"}),v.jsx("button",{onClick:()=>m(null),className:"text-gray-500 px-2 text-sm",children:"Cancel"})]}):v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"text-gray-400 dark:text-zinc-600 cursor-grab active:cursor-grabbing",onMouseDown:Y=>L(Y,se.id),children:v.jsx(Xf,{size:20})}),v.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:se.name})]}),v.jsxs("div",{className:"flex gap-2 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity",children:[v.jsx("button",{onClick:()=>{m(se.id),w(se.name)},className:"p-2 text-gray-500 hover:text-blue-600 dark:hover:text-blue-400",children:v.jsx(gU,{size:18})}),v.jsx("button",{onClick:()=>W(se.id),className:"p-2 text-gray-500 hover:text-red-600 dark:hover:text-red-400",children:v.jsx(km,{size:18})})]})]})},se.id)}),E.length===0&&!c&&v.jsx("div",{className:"text-center text-gray-500 dark:text-zinc-500 py-8",children:"No categories yet. Add one to get started."})]})]})]})},Ree=()=>{const{addEnvelope:t,setEnvelopeAllocation:e,currentMonth:n,categories:r,fetchCategories:i}=Qt(),{showToast:a}=cc(),o=qa(),[c]=UD();gf.useEffect(()=>{r.length===0&&i()},[r.length,i]);const[u,d]=B.useState(""),[h,p]=B.useState(c.get("type")==="piggybank"),[m,b]=B.useState(c.get("categoryId")||""),[w,E]=B.useState(""),[S,T]=B.useState(""),[C,N]=B.useState("#3B82F6"),[j,P]=B.useState(!1),M=async A=>{if(A.preventDefault(),!u.trim()||j)return;P(!0);const k=Qt.getState().envelopes,V=(k.length>0?Math.max(...k.map(J=>J.orderIndex??0)):-1)+1,L=h?new Date(`${n}-01T00:00:00`):new Date,U={name:u,currentBalance:0,lastUpdated:new Date().toISOString(),createdAt:L.toISOString(),isActive:!0,orderIndex:V,categoryId:m||void 0};if(h){U.isPiggybank=!0;const J={monthlyContribution:parseFloat(S||"0"),color:C,icon:"piggy-bank"};w&&parseFloat(w)>0&&(J.targetAmount=parseFloat(w)),U.piggybankConfig=J}t(U).then(J=>{if(J){const W=h?parseFloat(S||"0"):0;e(J,W).catch(q=>console.error("Failed to create allocation:",q)),setTimeout(()=>{o("/")},50)}}).catch(J=>{console.error("Failed to create envelope:",J),a(J.message||"Failed to create envelope","error"),P(!1)})};return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-[calc(8rem+env(safe-area-inset-bottom))]",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-10 flex items-center shadow-sm",children:[v.jsx("button",{onClick:()=>o("/"),className:"mr-3 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white",children:v.jsx(Bo,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:h?"New Piggybank":"New Envelope"})]}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:[v.jsx("div",{className:"p-6 bg-blue-50 dark:bg-zinc-800 border-b border-blue-100 dark:border-zinc-700 flex justify-center py-8",children:v.jsx("div",{className:"w-20 h-20 bg-blue-100 dark:bg-zinc-700 text-blue-600 dark:text-blue-400 rounded-full flex items-center justify-center",children:h?v.jsx(Ah,{size:40}):v.jsx(ZB,{size:40})})}),v.jsxs("form",{onSubmit:M,className:"p-6 space-y-6 pb-6",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Type"}),v.jsxs("div",{className:"flex bg-gray-100 dark:bg-zinc-800 p-1 rounded-xl",children:[v.jsx("button",{type:"button",onClick:()=>p(!1),className:`flex-1 py-2 px-4 rounded-lg text-sm font-semibold transition-all ${h?"text-gray-500 dark:text-zinc-400 hover:text-gray-700 dark:hover:text-zinc-300":"bg-white dark:bg-zinc-700 text-blue-600 dark:text-blue-400 shadow-sm"}`,children:"Spending"}),v.jsx("button",{type:"button",onClick:()=>p(!0),className:`flex-1 py-2 px-4 rounded-lg text-sm font-semibold transition-all ${h?"bg-white dark:bg-zinc-700 text-blue-600 dark:text-blue-400 shadow-sm":"text-gray-500 dark:text-zinc-400 hover:text-gray-700 dark:hover:text-zinc-300"}`,children:"Piggybank"})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Category"}),v.jsxs("select",{id:"category",value:m,onChange:A=>b(A.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all appearance-none",children:[v.jsx("option",{value:"",children:"Uncategorized"}),r.map(A=>v.jsx("option",{value:A.id,children:A.name},A.id))]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:h?"Piggybank Name":"Envelope Name"}),v.jsx("input",{type:"text",id:"name",value:u,onChange:A=>d(A.target.value),placeholder:h?"e.g. Vacation Fund, Emergency Savings":"e.g. Groceries, Rent, Fun Money",className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",autoFocus:!0,required:!0})]}),h&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"monthly-contribution",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Monthly Auto-Contribution *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"number",id:"monthly-contribution",value:S,onChange:A=>T(A.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:h})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"This amount will be automatically added each month and deducted from Available to Budget"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Target Goal (Optional)"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"number",id:"target-amount",value:w,onChange:A=>E(A.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Set a savings goal to track progress"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#F59E0B",label:"Amber"},{value:"#EF4444",label:"Red"},{value:"#8B5CF6",label:"Purple"},{value:"#EC4899",label:"Pink"}].map(A=>v.jsx("button",{type:"button",onClick:()=>N(A.value),className:`w-full aspect-square rounded-lg transition-all ${C===A.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-zinc-900":"hover:scale-110"}`,style:{backgroundColor:A.value},title:A.label},A.value))})]})]}),v.jsxs("div",{className:"pt-4 flex gap-3",children:[v.jsx("button",{type:"button",onClick:()=>o("/"),className:"flex-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 font-semibold bg-white dark:bg-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",children:"Cancel"}),v.jsx("button",{type:"submit",disabled:!u.trim()||h&&!S||j,className:`flex-1 py-3 px-4 rounded-xl font-semibold shadow-sm text-white transition-colors ${u.trim()&&(!h||S)&&!j?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-300 dark:bg-zinc-600 cursor-not-allowed"}`,children:j?"Creating...":h?"Create Piggybank":"Create Envelope"})]})]})]})})]})},Nee=({envelopes:t,transactionAmount:e,onSplitChange:n,initialSelectedEnvelopeId:r})=>{const[i,a]=B.useState([]),[o,c]=B.useState(!1);B.useEffect(()=>{r&&!o&&t.some(C=>C.id===r)&&(a([r]),c(!0))},[r,t,o]);const[u,d]=B.useState({}),[h,p]=B.useState(e),m=T=>{a(C=>C.includes(T)?C.filter(N=>N!==T):[...C,T])},b=(T,C)=>{d(N=>({...N,[T]:C}))};B.useEffect(()=>{if(i.length===1){const T=i[0];d({[T]:e})}},[i.length,e]),B.useEffect(()=>{const T=Object.values(u).reduce((C,N)=>C+(N||0),0);p(e-T),n(u)},[u,e,n]),B.useEffect(()=>{const T={...u};Object.keys(T).forEach(C=>{i.includes(C)||delete T[C]}),Object.keys(T).length!==Object.keys(u).length&&d(T)},[i,u]);const w=()=>{a([]),d({})},E=Math.abs(h)<.01&&i.length>0,S=i.length>0&&Math.abs(h)>.01;return v.jsxs("div",{className:"space-y-3",children:[i.length>1&&v.jsxs("div",{className:`p-3 rounded-lg ${S?"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800":E?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-zinc-800 border border-gray-200 dark:border-zinc-700"}`,children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Remaining to Split:"}),v.jsxs("span",{className:`font-bold text-lg ${S?"text-red-600 dark:text-red-400":E?"text-green-600 dark:text-green-400":"text-gray-900 dark:text-white"}`,children:["$",h.toFixed(2)]})]}),S&&v.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Split amounts must equal transaction total"})]}),v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("label",{className:"text-xs text-gray-500 dark:text-zinc-400",children:i.length>1?"Split Across Envelopes":"Select Envelope"}),i.length>0&&v.jsx("button",{type:"button",onClick:w,className:"text-xs text-blue-600 dark:text-blue-400",children:"Clear All"})]}),v.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-200 dark:border-zinc-800 rounded-lg",children:t.map(T=>v.jsxs("div",{className:"flex items-center py-3 px-3 border-b border-gray-100 dark:border-zinc-800 last:border-b-0 hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsx("input",{type:"checkbox",checked:i.includes(T.id),onChange:()=>m(T.id),className:"mr-3 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),v.jsx("span",{className:"flex-1 text-gray-900 dark:text-white",children:T.name}),i.includes(T.id)&&i.length>1&&v.jsxs("div",{className:"flex items-center",children:[v.jsx("span",{className:"mr-1 text-gray-500 dark:text-zinc-400",children:"$"}),v.jsx("input",{type:"number",min:"0",step:"0.01",value:u[T.id]||"",onChange:C=>b(T.id,parseFloat(C.target.value)||0),className:"w-24 px-2 py-1 border border-gray-300 dark:border-zinc-700 rounded bg-white dark:bg-zinc-900 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]})]},T.id))})]})};const Dee="type.googleapis.com/google.protobuf.Int64Value",Iee="type.googleapis.com/google.protobuf.UInt64Value";function M3(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function u0(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>u0(e));if(typeof t=="function"||typeof t=="object")return M3(t,e=>u0(e));throw new Error("Data cannot be encoded in JSON: "+t)}function Gu(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case Dee:case Iee:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>Gu(e)):typeof t=="function"||typeof t=="object"?M3(t,e=>Gu(e)):t}const NE="functions";const TN={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class zr extends Ga{constructor(e,n,r){super(`${NE}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,zr.prototype)}}function Mee(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function d0(t,e){let n=Mee(t),r=n,i;try{const a=e&&e.error;if(a){const o=a.status;if(typeof o=="string"){if(!TN[o])return new zr("internal","internal");n=TN[o],r=o}const c=a.message;typeof c=="string"&&(r=c),i=a.details,i!==void 0&&(i=Gu(i))}}catch{}return n==="ok"?null:new zr(n,r,i)}class Oee{constructor(e,n,r,i){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,ni(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(a=>this.auth=a,()=>{}),this.messaging||r.get().then(a=>this.messaging=a,()=>{}),this.appCheck||i?.get().then(a=>this.appCheck=a,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:i}}}const X1="us-central1",Pee=/^data: (.*?)(?:\n|$)/;function jee(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new zr("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class Vee{constructor(e,n,r,i,a=X1,o=(...c)=>fetch(...c)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new Oee(e,n,r,i),this.cancelAllRequests=new Promise(c=>{this.deleteService=()=>Promise.resolve(c())});try{const c=new URL(a);this.customDomain=c.origin+(c.pathname==="/"?"":c.pathname),this.region=X1}catch{this.customDomain=null,this.region=a}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function zee(t,e,n){const r=el(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(Q1(t.emulatorOrigin+"/backends"),Z1("Functions",!0))}function Lee(t,e,n){const r=i=>Uee(t,e,i,{});return r.stream=(i,a)=>$ee(t,e,i,a),r}function O3(t){return t.emulatorOrigin&&el(t.emulatorOrigin)?"include":void 0}async function Bee(t,e,n,r,i){n["Content-Type"]="application/json";let a;try{a=await r(t,{method:"POST",body:JSON.stringify(e),headers:n,credentials:O3(i)})}catch{return{status:0,json:null}}let o=null;try{o=await a.json()}catch{}return{status:a.status,json:o}}async function P3(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function Uee(t,e,n,r){const i=t._url(e);return Fee(t,i,n,r)}async function Fee(t,e,n,r){n=u0(n);const i={data:n},a=await P3(t,r),o=r.timeout||7e4,c=jee(o),u=await Promise.race([Bee(e,i,a,t.fetchImpl,t),c.promise,t.cancelAllRequests]);if(c.cancel(),!u)throw new zr("cancelled","Firebase Functions instance was deleted.");const d=d0(u.status,u.json);if(d)throw d;if(!u.json)throw new zr("internal","Response is not valid JSON object.");let h=u.json.data;if(typeof h>"u"&&(h=u.json.result),typeof h>"u")throw new zr("internal","Response is missing data field.");return{data:Gu(h)}}function $ee(t,e,n,r){const i=t._url(e);return Gee(t,i,n,r||{})}async function Gee(t,e,n,r){n=u0(n);const i={data:n},a=await P3(t,r);a["Content-Type"]="application/json",a.Accept="text/event-stream";let o;try{o=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(i),headers:a,signal:r?.signal,credentials:O3(t)})}catch(m){if(m instanceof Error&&m.name==="AbortError"){const w=new zr("cancelled","Request was cancelled.");return{data:Promise.reject(w),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(w)}}}}}}const b=d0(0,null);return{data:Promise.reject(b),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(b)}}}}}}let c,u;const d=new Promise((m,b)=>{c=m,u=b});r?.signal?.addEventListener("abort",()=>{const m=new zr("cancelled","Request was cancelled.");u(m)});const h=o.body.getReader(),p=Hee(h,c,u,r?.signal);return{stream:{[Symbol.asyncIterator](){const m=p.getReader();return{async next(){const{value:b,done:w}=await m.read();return{value:b,done:w}},async return(){return await m.cancel(),{done:!0,value:void 0}}}}},data:d}}function Hee(t,e,n,r){const i=(o,c)=>{const u=o.match(Pee);if(!u)return;const d=u[1];try{const h=JSON.parse(d);if("result"in h){e(Gu(h.result));return}if("message"in h){c.enqueue(Gu(h.message));return}if("error"in h){const p=d0(0,h);c.error(p),n(p);return}}catch(h){if(h instanceof zr){c.error(h),n(h);return}}},a=new TextDecoder;return new ReadableStream({start(o){let c="";return u();async function u(){if(r?.aborted){const d=new zr("cancelled","Request was cancelled");return o.error(d),n(d),Promise.resolve()}try{const{value:d,done:h}=await t.read();if(h){c.trim()&&i(c.trim(),o),o.close();return}if(r?.aborted){const m=new zr("cancelled","Request was cancelled");o.error(m),n(m),await t.cancel();return}c+=a.decode(d,{stream:!0});const p=c.split(`
`);c=p.pop()||"";for(const m of p)m.trim()&&i(m.trim(),o);return u()}catch(d){const h=d instanceof zr?d:d0(0,null);o.error(h),n(h)}}},cancel(){return t.cancel()}})}const AN="@firebase/functions",CN="0.13.1";const qee="auth-internal",Yee="app-check-internal",Xee="messaging-internal";function Wee(t){const e=(n,{instanceIdentifier:r})=>{const i=n.getProvider("app").getImmediate(),a=n.getProvider(qee),o=n.getProvider(Xee),c=n.getProvider(Yee);return new Vee(i,a,o,c,r)};Cs(new La(NE,e,"PUBLIC").setMultipleInstances(!0)),Wi(AN,CN,t),Wi(AN,CN,"esm2020")}function Kee(t=p0(),e=X1){const r=qu(It(t),NE).getImmediate({identifier:e}),i=IN("functions");return i&&Qee(r,...i),r}function Qee(t,e,n){zee(It(t),e,n)}function Zee(t,e,n){return Lee(It(t),e)}Wee();function j3(t,e){const n={amount:null,merchant:null,envelope:null,envelopeId:null,description:null,paymentMethodName:null,type:"Expense",confidence:0};if(!t||t.trim().length===0)return n;const r=t.trim();let i=r,a=0;const o=r.match(/\b(?:with|using)\s+(.+)$/i);if(o&&o[1]){const b=o[1].trim();b.length>0&&b.length<60&&(n.paymentMethodName=b,i=i.replace(o[0]," ").trim(),a++)}/\b(income|earned|received|got paid|paycheck|salary|deposit|refund)\b/i.test(r)&&(n.type="Income",a++);const u=[/\$\s?(\d{1,}(?:,\d{3})*(?:\.\d{1,2})?)/,/(\d{1,}(?:,\d{3})*\.\d{1,2})\s*(?:dollars?)?/,/\b(\d{1,}(?:,\d{3})*)\s*(?:dollars?|bucks?)\b/i,/(?:for|of|spent|paid|cost|was)\s+\$?(\d{1,}(?:,\d{3})*(?:\.\d{1,2})?)/i];for(const b of u){const w=r.match(b);if(w){const E=w[1].replace(/,/g,""),S=parseFloat(E);if(!isNaN(S)&&S>0){n.amount=S,i=i.replace(w[0]," ").trim(),a++;break}}}if(n.amount===null){const b=r.match(/\b(\d{1,}(?:\.\d{1,2})?)\b/);if(b){const w=parseFloat(b[1]);!isNaN(w)&&w>0&&w<1e6&&(n.amount=w,i=i.replace(b[0]," ").trim(),a++)}}const d=e.filter(b=>b.isActive!==!1);let h=null;for(const b of d){const w=b.name.toLowerCase(),E=r.toLowerCase();if(E.includes(w)){const C=w.length/E.length;(!h||C>h.score)&&(h={envelope:b,score:Math.max(C,.8)});continue}const S=E.split(/\s+/),T=w.split(/\s+/);for(const C of T)if(!(C.length<3)){for(const N of S)if(!(N.length<3)&&(N.startsWith(C.slice(0,-1))||C.startsWith(N.slice(0,-1)))){const j=Math.min(N.length,C.length)/Math.max(N.length,C.length);j>=.6&&(!h||j>h.score)&&(h={envelope:b,score:j})}}}if(h){n.envelope=h.envelope.name,n.envelopeId=h.envelope.id,a++;const b=new RegExp(h.envelope.name.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"i");i=i.replace(b," ").trim()}const p=/\b(at|for|from|to|the|a|an|on|in|my|spent|paid|bought|got|transaction|purchase|payment|income|earned|received)\b/gi;let m=i.replace(p," ").replace(/\s+/g," ").trim();return m=m.replace(/^[^a-zA-Z0-9]+|[^a-zA-Z0-9]+$/g,"").trim(),m.length>0&&m.length<100&&(n.merchant=m,a++),n.description=r,n.confidence=0,n.amount!==null&&(n.confidence+=.35),n.envelopeId!==null&&(n.confidence+=.3),n.merchant!==null&&(n.confidence+=.2),n.paymentMethodName!==null&&(n.confidence+=.1),a>0&&(n.confidence+=.05),n.confidence=Math.min(n.confidence,1),n}async function Jee(t,e){const n=e.filter(i=>i.isActive!==!1),r=n.map(i=>i.name);try{console.log(" Siri: Calling Cloud Function to parse:",t);const i=Kee(),c=(await Zee(i,"parseTransaction")({text:t,userEnvelopes:r})).data;console.log(" Siri: Cloud Function response:",c);let u=null,d=c.envelope;if(c.envelope){const h=n.find(p=>p.name.toLowerCase()===c.envelope.toLowerCase());h&&(u=h.id,d=h.name)}return{amount:c.amount,merchant:c.merchant,envelope:d,envelopeId:u,description:c.description||t,paymentMethodName:c.paymentMethodName||null,type:c.type||"Expense",confidence:.9}}catch(i){return console.warn(" Siri: Cloud Function failed, falling back to regex parser:",i.message),j3(t,e)}}function ete(t,e){return console.log(" Siri: Parsing locally with regex:",t),j3(t,e)}async function tte(t,e){return typeof navigator<"u"&&!navigator.onLine?(console.log(" Siri: Offline  using local parser"),ete(t,e)):Jee(t,e)}function nte(){const[t,e]=UD(),{envelopes:n}=Qt(),[r,i]=B.useState(null),[a,o]=B.useState(!1),[c,u]=B.useState(null);B.useEffect(()=>{const h=t.get("query");if(!h||h.trim().length===0){u(null);return}u(h),o(!0),tte(h,n).then(m=>{console.log(" Siri: Parsed result:",m),i(m)}).catch(m=>{console.error(" Siri: Parse failed:",m),i(null)}).finally(()=>{o(!1)});const p=new URLSearchParams(t);p.delete("query"),e(p,{replace:!0})},[]);const d=B.useCallback(()=>{i(null),u(null)},[]);return{parsedData:r,isParsing:a,siriQuery:c,clearParsedData:d}}const V3=({onClose:t,onSaved:e})=>{const n=qa(),{envelopes:r,addTransaction:i,currentMonth:a,appSettings:o}=Qt(),{parsedData:c,isParsing:u,siriQuery:d,clearParsedData:h}=nte(),[p,m]=B.useState(""),[b,w]=B.useState(""),[E,S]=B.useState(""),[T,C]=B.useState(!1),[N,j]=B.useState(()=>{const X=new Date;return new Date(X.getTime()-X.getTimezoneOffset()*6e4).toISOString().split("T")[0]}),[P,M]=B.useState("expense"),[A,k]=B.useState({}),[D,V]=B.useState(null),[L,U]=B.useState(!1),[O,J]=B.useState(null);B.useEffect(()=>{if(!(!c||T)){if(c.amount!==null&&m(c.amount.toFixed(2)),c.merchant&&w(c.merchant),c.description&&S(c.description),c.type&&M(c.type==="Income"?"income":"expense"),c.envelopeId&&J(c.envelopeId),c.paymentMethodName&&o?.paymentSources?.length){const X=c.paymentMethodName.toLowerCase(),ie=o.paymentSources.find(le=>{const ge=le.name.toLowerCase();return ge===X||ge.includes(X)||X.includes(ge)});ie&&(V(ie),U(!1))}C(!0),console.log(" Siri: Pre-filled form with parsed data:",c)}},[c,T,o?.paymentSources]);const W=()=>{if(t){t();return}n("/")},q=X=>{V(X),D&&U(!0)},K=Object.keys(A).length>0,te=Object.values(A).reduce((X,ie)=>X+(ie||0),0),se=Math.abs(te-parseFloat(p||"0"))<.01,G=p&&parseFloat(p)>0&&K&&se,F=async X=>{if(X.preventDefault(),!G)return;const[ie,le,ge]=N.split("-").map(Number),pe=new Date(ie,le-1,ge,12,0,0);console.log(" Selected date:",N),console.log(" Parsed date:",pe.toISOString());try{const[_e,Ie]=N.split("-").map(Number),ae=`${_e}-${Ie.toString().padStart(2,"0")}`;if(ae!==a){const Re=`This transaction date (${ae}) does not match the current budget month (${a}). Are you sure you want to save it?`;if(!window.confirm(Re))return}const Ae=Object.entries(A).filter(([Re,De])=>De>0);Promise.all(Ae.map(([Re,De])=>i({amount:De,description:E,merchant:b||void 0,date:pe.toISOString(),envelopeId:Re,type:P==="income"?"Income":"Expense",reconciled:!1,paymentMethod:D||void 0}).catch(Ve=>console.error("Failed to create transaction:",Ve)))).catch(Re=>console.error("Failed to create transactions:",Re)),e&&e(),t?t():n("/")}catch(_e){console.error("Error saving transaction:",_e),alert("Failed to save transaction: "+(_e instanceof Error?_e.message:"Unknown error"))}},Y=[...r].filter(X=>X.isActive!==!1).sort((X,ie)=>{const le=X.orderIndex??0,ge=ie.orderIndex??0;return le!==ge?le-ge:X.name.localeCompare(ie.name)}),Q=P==="income"?"text-green-500":"text-red-500";return v.jsxs("div",{className:"h-screen overflow-y-auto bg-gray-50 dark:bg-black overscroll-contain",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b border-gray-200 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 z-20 flex items-center justify-between",children:[v.jsx("button",{onClick:W,className:"text-blue-600 dark:text-blue-400 font-medium",children:"Cancel"}),v.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"New Transaction"}),v.jsx("button",{onClick:F,disabled:!G,className:"text-blue-600 dark:text-blue-400 font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:"Save"})]}),u&&v.jsxs("div",{className:"mx-4 mt-3 p-3 bg-purple-50 dark:bg-purple-900/30 border border-purple-200 dark:border-purple-800 rounded-xl flex items-center gap-3",children:[v.jsx(ZC,{size:18,className:"text-purple-500 animate-pulse"}),v.jsx("span",{className:"text-sm text-purple-700 dark:text-purple-300",children:"Parsing voice input..."})]}),T&&!u&&d&&v.jsxs("div",{className:"mx-4 mt-3 p-3 bg-purple-50 dark:bg-purple-900/30 border border-purple-200 dark:border-purple-800 rounded-xl",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[v.jsx(ZC,{size:14,className:"text-purple-500"}),v.jsx("span",{className:"text-xs font-semibold text-purple-700 dark:text-purple-300",children:"Siri Shortcut"}),c&&v.jsxs("span",{className:"ml-auto text-[10px] text-purple-500 dark:text-purple-400",children:[Math.round(c.confidence*100),"% confidence"]})]}),v.jsxs("p",{className:"text-xs text-purple-600 dark:text-purple-400 italic truncate",children:['"',d,'"']}),v.jsx("button",{type:"button",onClick:()=>{h(),C(!1)},className:"text-[10px] text-purple-500 dark:text-purple-400 underline mt-1",children:"Clear pre-filled data"})]}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto pb-[calc(8rem+env(safe-area-inset-bottom))]",children:v.jsxs("form",{onSubmit:F,className:"space-y-6",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl border border-gray-200 dark:border-zinc-800 overflow-hidden",children:v.jsxs("div",{className:"flex",children:[v.jsx("button",{type:"button",onClick:()=>M("expense"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${P==="expense"?"bg-red-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Expense"}),v.jsx("button",{type:"button",onClick:()=>M("income"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${P==="income"?"bg-green-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Income"})]})}),v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${Q}`,children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:p,onChange:X=>{const ie=X.target.value.replace(/\D/g,"");if(!ie){m("");return}const ge=(parseInt(ie,10)/100).toFixed(2);m(ge)},onKeyDown:X=>{(X.key==="e"||X.key==="E"||X.key==="+"||X.key==="-")&&X.preventDefault()},placeholder:"0.00",autoFocus:!0,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${Q} placeholder-gray-700`})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),v.jsx("input",{type:"text",value:b,onChange:X=>w(X.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsx(N3,{selectedCard:D,onCardSelect:q,isUserSelected:L}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),v.jsx("input",{type:"text",value:E,onChange:X=>S(X.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const[X,ie]=N.split("-").map(Number);return`${X}-${ie.toString().padStart(2,"0")}`!==a?v.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[v.jsx(wu,{size:14}),v.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),v.jsx("input",{type:"date",value:N,onChange:X=>j(X.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 transition-colors",children:v.jsx(Nee,{envelopes:Y,transactionAmount:parseFloat(p)||0,onSplitChange:k,initialSelectedEnvelopeId:O})})]})})]})},rte=()=>{const t=qa(),{transactions:e,envelopes:n,updateTransaction:r,deleteTransaction:i,restoreTransaction:a,currentMonth:o,appSettings:c}=Qt(),{showToast:u}=cc(),[d,h]=B.useState(!1),[p,m]=B.useState(""),[b,w]=B.useState("all"),[E,S]=B.useState("All"),[T,C]=B.useState(!1),[N,j]=B.useState("all"),[P,M]=B.useState(!1),[A,k]=B.useState("all"),[D,V]=B.useState(!1),[L,U]=B.useState(()=>{const G=new Date;return G.setMonth(G.getMonth()-1),G.toISOString().split("T")[0]}),[O,J]=B.useState(()=>new Date().toISOString().split("T")[0]),[W,q]=B.useState(null),K=B.useMemo(()=>{console.log(" Filtering transactions:",{totalTransactions:e.length,showAllTime:P,currentMonth:o,transactionMonths:e.map(Y=>({id:Y.id,month:Y.month,date:Y.date,description:Y.description}))});let G=e;return P||(G=e.filter(Y=>Y.month===o||!Y.month),console.log(" After month filter:",{remaining:G.length,currentMonth:o,filteredTransactions:G.map(Y=>({id:Y.id,description:Y.description,month:Y.month,matchesCurrentMonth:Y.month===o}))})),G.map(Y=>{if(!Y)return null;let Q=Y.date;if(typeof Y.date=="number"){const ie=(Y.date+978307200)*1e3;Q=new Date(ie).toISOString()}else if(!Y.date||typeof Y.date!="string")return null;return{...Y,date:Q}}).filter(Boolean).filter(Y=>{if(Y.description==="Budgeted"||Y.description==="Piggybank Contribution")return!1;if(p){const X=p.toLowerCase(),ie=n.find(pe=>pe.id===Y.envelopeId)?.name.toLowerCase()||"",le=Y.amount.toFixed(2);if(!(Y.description.toLowerCase().includes(X)||ie.includes(X)||le.includes(X)))return!1}if(b!=="all"&&Y.envelopeId!==b||E!=="All"&&Y.type!==E||A!=="all"&&(!Y.paymentMethod||Y.paymentMethod.id!==A)||!Y.date||typeof Y.date!="string")return!1;const Q=Y.date.split("T")[0];return!(D&&(Q<L||Q>O)||N!=="all"&&new Date(Q).getMonth()!==parseInt(N)||T&&!Y.reconciled)}).sort((Y,Q)=>new Date(Q.date).getTime()-new Date(Y.date).getTime())},[e,n,p,b,E,A,L,O,T,P,o,D]);console.log(" Final filtered transactions:",{count:K.length,transactions:K.map(G=>({id:G.id,description:G.description,amount:G.amount,date:G.date,month:G.month,type:G.type}))});const te=W?n.find(G=>G.id===W.envelopeId):null,se=G=>{const F={...G,reconciled:!G.reconciled};r(F)};return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-[calc(8rem+env(safe-area-inset-bottom))] transition-colors duration-200",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-between shadow-sm",children:[v.jsxs("div",{className:"flex items-center",children:[v.jsx("button",{onClick:()=>t(-1),className:"mr-3 text-gray-600 hover:text-gray-900 dark:text-zinc-400 dark:hover:text-white transition-colors",children:v.jsx(Bo,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"All Transactions"})]}),v.jsx("button",{onClick:()=>h(!d),className:`p-2 rounded-full transition-colors ${d?"bg-blue-100 text-blue-600 dark:bg-blue-900/40 dark:text-blue-400":"text-gray-400 dark:text-zinc-600 hover:bg-gray-100 dark:hover:bg-zinc-800"}`,children:v.jsx(eU,{size:20,className:d?"fill-current":""})})]}),v.jsxs("div",{className:"px-4 py-2 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 flex justify-between items-center",children:[v.jsxs("div",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:["Month: ",o]}),v.jsx("button",{onClick:()=>M(!P),className:`text-sm px-3 py-1 rounded-md ${P?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-800 dark:bg-zinc-800 dark:text-zinc-300"}`,children:P?"Current Month Only":"All Time"})]}),v.jsx("div",{className:"px-4 py-3 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800",children:v.jsxs("div",{className:"relative",children:[v.jsx(_U,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),v.jsx("input",{type:"text",placeholder:"Search transactions...",value:p,onChange:G=>m(G.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none dark:text-white"}),p&&v.jsx("button",{onClick:()=>m(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",children:v.jsx(w0,{size:16})})]})}),v.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 ${d?"max-h-[600px] opacity-100":"max-h-0 opacity-0"}`,children:v.jsxs("div",{className:"p-4 space-y-4",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Payment Method"}),v.jsxs("select",{value:A,onChange:G=>k(G.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Payment Methods"}),c?.paymentSources?.map(G=>v.jsx("option",{value:G.id,children:G.name},G.id))]})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Envelope"}),v.jsxs("select",{value:b,onChange:G=>w(G.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Envelopes"}),n.sort((G,F)=>G.name.localeCompare(F.name)).map(G=>v.jsx("option",{value:G.id,children:G.name},G.id))]})]}),v.jsx("div",{className:"bg-gray-100 dark:bg-zinc-800 p-1 rounded-lg flex",children:["All","Income","Expense"].map(G=>v.jsx("button",{onClick:()=>S(G),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${E===G?"bg-white dark:bg-zinc-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-zinc-500 hover:text-gray-700"}`,children:G},G))}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Month"}),v.jsxs("select",{value:N,onChange:G=>j(G.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Months"}),Array.from({length:12},(G,F)=>F).map(G=>v.jsx("option",{value:G,children:new Date(2022,G).toLocaleString("default",{month:"long"})},G))]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Date Range"}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("label",{className:"text-xs text-gray-600 dark:text-zinc-400",children:"Enable"}),v.jsx("button",{onClick:()=>V(!D),className:`w-9 h-5 rounded-full transition-colors relative ${D?"bg-blue-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-3 h-3 bg-white rounded-full transition-transform ${D?"translate-x-4":"translate-x-0"}`})})]})]}),v.jsxs("div",{className:`grid grid-cols-2 gap-4 transition-opacity ${D?"opacity-100":"opacity-50 pointer-events-none"}`,children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-[10px] font-medium text-gray-500 dark:text-zinc-500 uppercase",children:"From"}),v.jsx("div",{className:"relative",children:v.jsx("input",{type:"date",value:L,onChange:G=>U(G.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-[10px] font-medium text-gray-500 dark:text-zinc-500 uppercase",children:"To"}),v.jsx("div",{className:"relative",children:v.jsx("input",{type:"date",value:O,onChange:G=>J(G.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]})]})]}),v.jsxs("div",{className:"flex items-center justify-between pt-2",children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show only reconciled"}),v.jsx("button",{onClick:()=>C(!T),className:`w-11 h-6 rounded-full transition-colors relative ${T?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${T?"translate-x-5":"translate-x-0"}`})})]}),v.jsxs("div",{className:"flex items-center justify-between pt-2",children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show all time"}),v.jsx("button",{onClick:()=>M(!P),className:`w-11 h-6 rounded-full transition-colors relative ${P?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${P?"translate-x-5":"translate-x-0"}`})})]})]})}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:K.length===0?v.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-zinc-500",children:"No transactions match your filters."}):v.jsx(ai,{initial:!1,mode:"popLayout",children:K.map(G=>{const F=n.find(Y=>Y.id===G.envelopeId);return v.jsx(gn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(dv,{disabled:G.isAutomatic,onDelete:()=>{if(!G.id)return;const Y={...G};i(G.id),u("Transaction deleted","neutral",()=>a(Y))},children:v.jsx(I3,{transaction:G,envelopeName:F?.name||"Unknown Envelope",onReconcile:()=>se(G),onEdit:()=>{G.isAutomatic||(F?q(G):alert("Cannot edit: Envelope deleted."))}})})},G.id)})})})}),v.jsx(D3,{isVisible:!!W&&!!te,onClose:()=>q(null),mode:"edit",currentEnvelope:te||{},initialTransaction:W})]})},xo=({children:t})=>v.jsx(gn.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2,ease:"easeInOut"},className:"w-full h-full bg-gray-50 dark:bg-black",children:t}),ite=()=>{const t=aa();return v.jsx(ai,{mode:"wait",children:v.jsxs(O9,{location:t,children:[v.jsx(gs,{path:"/",element:v.jsx(xo,{children:v.jsx(Ei,{children:v.jsx(bee,{})})})}),v.jsx(gs,{path:"/envelope/:id",element:v.jsx(xo,{children:v.jsx(Ei,{children:v.jsx(Tee,{})})})}),v.jsx(gs,{path:"/add-envelope",element:v.jsx(xo,{children:v.jsx(Ei,{children:v.jsx(Ree,{})})})}),v.jsx(gs,{path:"/add-transaction",element:v.jsx(xo,{children:v.jsx(Ei,{children:v.jsx(V3,{})})})}),v.jsx(gs,{path:"/transactions",element:v.jsx(xo,{children:v.jsx(Ei,{children:v.jsx(rte,{})})})}),v.jsx(gs,{path:"/settings",element:v.jsx(xo,{children:v.jsx(Ei,{children:v.jsx(Cee,{})})})}),v.jsx(gs,{path:"/settings/categories",element:v.jsx(xo,{children:v.jsx(Ei,{children:v.jsx(kee,{})})})}),v.jsx(gs,{path:"/verify-email",element:v.jsx(xo,{children:v.jsx(Ei,{children:v.jsx(VM,{})})})})]},t.pathname)})};function ate(){const[t,e]=B.useState(!0),[n,r]=B.useState(!1),[i,a]=B.useState(null),{appSettings:o,isOnboardingActive:c}=Qt(),{isAuthenticated:u,isInitialized:d,initializeAuth:h,lastAuthTime:p,offlineGracePeriod:m,currentUser:b}=Ai();if(B.useEffect(()=>{const S=setTimeout(()=>{e(!1)},2e3);return()=>clearTimeout(S)},[]),B.useEffect(()=>h(),[h]),B.useEffect(()=>{(async()=>{const T=new URLSearchParams(window.location.search),C=T.get("mode"),N=T.get("oobCode");if(C==="resetPassword"&&N){console.log(" Processing password reset from URL"),a(N);return}if(C==="verifyEmail"&&N){console.log(" Processing email verification from URL");try{await mz(wi,N),console.log(" Email verification successful");const j=window.location.pathname;window.history.replaceState({},document.title,j),alert("Email verified successfully! You can now sign in.")}catch(j){console.error(" Email verification failed:",j),alert("Email verification failed. The link may be expired or invalid.")}}})()},[]),B.useEffect(()=>{const S=document.documentElement,T=window.matchMedia("(prefers-color-scheme: dark)"),C=()=>{const N=o?.theme??"system",j=T.matches;N==="dark"||N==="system"&&j?S.classList.add("dark"):S.classList.remove("dark")};if(C(),o?.theme==="system")return T.addEventListener("change",C),()=>T.removeEventListener("change",C)},[o]),B.useEffect(()=>{const S=document.documentElement;switch(o?.fontSize??"medium"){case"extra-small":S.style.fontSize="75%";break;case"small":S.style.fontSize="87.5%";break;case"large":S.style.fontSize="112.5%";break;case"extra-large":S.style.fontSize="125%";break;default:S.style.fontSize="100%"}},[o?.fontSize]),t||!d)return v.jsx(zM,{message:"Initializing Personal Budget..."});if(i)return v.jsx(Ei,{children:v.jsx(J$,{oobCode:i,onSuccess:()=>{a(null);const S=window.location.pathname;window.history.replaceState({},document.title,S)},onCancel:()=>{a(null);const S=window.location.pathname;window.history.replaceState({},document.title,S)}})});if(!u)return b?v.jsx(Ei,{children:v.jsx(VM,{})}):v.jsx(Ei,{children:v.jsx(Z$,{})});const E=typeof navigator<"u"&&!navigator.onLine&&u&&p&&Date.now()-p<m;return v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"fixed opacity-0 pointer-events-none -z-50",children:v.jsx("label",{id:"ios-haptic-trigger",htmlFor:"ios-haptic-checkbox",children:v.jsx("input",{type:"checkbox",id:"ios-haptic-checkbox",switch:"true"})})}),v.jsxs(Ei,{children:[E&&v.jsx("div",{className:"bg-yellow-100 dark:bg-yellow-900 border-l-4 border-yellow-500 text-yellow-700 dark:text-yellow-200 p-4",children:v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),v.jsx("div",{className:"ml-3",children:v.jsxs("p",{className:"text-sm",children:[v.jsx("strong",{children:"Offline Access:"})," You're using cached authentication. Expires in"," ",Math.ceil((m-(Date.now()-p))/(1440*60*1e3))," ","days. Connect to internet to refresh."]})})]})}),v.jsxs(aB,{children:[v.jsx(ite,{}),n&&v.jsxs("div",{className:"fixed inset-0 z-[60]",children:[v.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>r(!1)}),v.jsx("div",{className:"absolute inset-0",children:v.jsx(V3,{onClose:()=>r(!1),onSaved:()=>r(!1)})})]}),!c&&v.jsx(zX,{onAddTransaction:()=>r(!0)})]}),v.jsx(VX,{})]})]})}C5({onNeedRefresh(){},onOfflineReady(){console.log("App is ready for offline work")}});S5.createRoot(document.getElementById("root")).render(v.jsx(B.StrictMode,{children:v.jsx(ate,{})}));export{gt as T,Ke as a,u$ as b,rk as c,yt as d,yr as e,qi as f,Nb as g,Yi as h,td as o,ta as q,ti as s,Vl as t,Ca as u,s$ as w};
