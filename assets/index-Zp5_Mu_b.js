(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function h6(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var hx={exports:{}},Kf={};var l2;function p6(){if(l2)return Kf;l2=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,i,a){var o=null;if(a!==void 0&&(o=""+a),i.key!==void 0&&(o=""+i.key),"key"in i){a={};for(var c in i)c!=="key"&&(a[c]=i[c])}else a=i;return i=a.ref,{$$typeof:n,type:r,key:o,ref:i!==void 0?i:null,props:a}}return Kf.Fragment=e,Kf.jsx=t,Kf.jsxs=t,Kf}var c2;function g6(){return c2||(c2=1,hx.exports=p6()),hx.exports}var v=g6(),px={exports:{}},lt={};var u2;function m6(){if(u2)return lt;u2=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),m=Symbol.iterator;function b(G){return G===null||typeof G!="object"?null:(G=m&&G[m]||G["@@iterator"],typeof G=="function"?G:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function T(G,$,ee){this.props=G,this.context=$,this.refs=S,this.updater=ee||_}T.prototype.isReactComponent={},T.prototype.setState=function(G,$){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,$,"setState")},T.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function A(){}A.prototype=T.prototype;function D(G,$,ee){this.props=G,this.context=$,this.refs=S,this.updater=ee||_}var O=D.prototype=new A;O.constructor=D,w(O,T.prototype),O.isPureReactComponent=!0;var M=Array.isArray;function j(){}var C={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function k(G,$,ee){var te=ee.ref;return{$$typeof:n,type:G,key:$,ref:te!==void 0?te:null,props:ee}}function z(G,$){return k(G.type,$,G.props)}function L(G){return typeof G=="object"&&G!==null&&G.$$typeof===n}function B(G){var $={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(ee){return $[ee]})}var P=/\/+/g;function J(G,$){return typeof G=="object"&&G!==null&&G.key!=null?B(""+G.key):$.toString(36)}function Y(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(j,j):(G.status="pending",G.then(function($){G.status==="pending"&&(G.status="fulfilled",G.value=$)},function($){G.status==="pending"&&(G.status="rejected",G.reason=$)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function H(G,$,ee,te,le){var fe=typeof G;(fe==="undefined"||fe==="boolean")&&(G=null);var oe=!1;if(G===null)oe=!0;else switch(fe){case"bigint":case"string":case"number":oe=!0;break;case"object":switch(G.$$typeof){case n:case e:oe=!0;break;case h:return oe=G._init,H(oe(G._payload),$,ee,te,le)}}if(oe)return le=le(G),oe=te===""?"."+J(G,0):te,M(le)?(ee="",oe!=null&&(ee=oe.replace(P,"$&/")+"/"),H(le,$,ee,"",function(Ke){return Ke})):le!=null&&(L(le)&&(le=z(le,ee+(le.key==null||G&&G.key===le.key?"":(""+le.key).replace(P,"$&/")+"/")+oe)),$.push(le)),1;oe=0;var Ee=te===""?".":te+":";if(M(G))for(var ke=0;ke<G.length;ke++)te=G[ke],fe=Ee+J(te,ke),oe+=H(te,$,ee,fe,le);else if(ke=b(G),typeof ke=="function")for(G=ke.call(G),ke=0;!(te=G.next()).done;)te=te.value,fe=Ee+J(te,ke++),oe+=H(te,$,ee,fe,le);else if(fe==="object"){if(typeof G.then=="function")return H(Y(G),$,ee,te,le);throw $=String(G),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.")}return oe}function W(G,$,ee){if(G==null)return G;var te=[],le=0;return H(G,te,"","",function(fe){return $.call(ee,fe,le++)}),te}function K(G){if(G._status===-1){var $=G._result;$=$(),$.then(function(ee){(G._status===0||G._status===-1)&&(G._status=1,G._result=ee)},function(ee){(G._status===0||G._status===-1)&&(G._status=2,G._result=ee)}),G._status===-1&&(G._status=0,G._result=$)}if(G._status===1)return G._result.default;throw G._result}var de=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var $=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent($))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)},Q={map:W,forEach:function(G,$,ee){W(G,function(){$.apply(this,arguments)},ee)},count:function(G){var $=0;return W(G,function(){$++}),$},toArray:function(G){return W(G,function($){return $})||[]},only:function(G){if(!L(G))throw Error("React.Children.only expected to receive a single React element child.");return G}};return lt.Activity=p,lt.Children=Q,lt.Component=T,lt.Fragment=t,lt.Profiler=i,lt.PureComponent=D,lt.StrictMode=r,lt.Suspense=u,lt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,lt.__COMPILER_RUNTIME={__proto__:null,c:function(G){return C.H.useMemoCache(G)}},lt.cache=function(G){return function(){return G.apply(null,arguments)}},lt.cacheSignal=function(){return null},lt.cloneElement=function(G,$,ee){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var te=w({},G.props),le=G.key;if($!=null)for(fe in $.key!==void 0&&(le=""+$.key),$)!I.call($,fe)||fe==="key"||fe==="__self"||fe==="__source"||fe==="ref"&&$.ref===void 0||(te[fe]=$[fe]);var fe=arguments.length-2;if(fe===1)te.children=ee;else if(1<fe){for(var oe=Array(fe),Ee=0;Ee<fe;Ee++)oe[Ee]=arguments[Ee+2];te.children=oe}return k(G.type,le,te)},lt.createContext=function(G){return G={$$typeof:o,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:a,_context:G},G},lt.createElement=function(G,$,ee){var te,le={},fe=null;if($!=null)for(te in $.key!==void 0&&(fe=""+$.key),$)I.call($,te)&&te!=="key"&&te!=="__self"&&te!=="__source"&&(le[te]=$[te]);var oe=arguments.length-2;if(oe===1)le.children=ee;else if(1<oe){for(var Ee=Array(oe),ke=0;ke<oe;ke++)Ee[ke]=arguments[ke+2];le.children=Ee}if(G&&G.defaultProps)for(te in oe=G.defaultProps,oe)le[te]===void 0&&(le[te]=oe[te]);return k(G,fe,le)},lt.createRef=function(){return{current:null}},lt.forwardRef=function(G){return{$$typeof:c,render:G}},lt.isValidElement=L,lt.lazy=function(G){return{$$typeof:h,_payload:{_status:-1,_result:G},_init:K}},lt.memo=function(G,$){return{$$typeof:d,type:G,compare:$===void 0?null:$}},lt.startTransition=function(G){var $=C.T,ee={};C.T=ee;try{var te=G(),le=C.S;le!==null&&le(ee,te),typeof te=="object"&&te!==null&&typeof te.then=="function"&&te.then(j,de)}catch(fe){de(fe)}finally{$!==null&&ee.types!==null&&($.types=ee.types),C.T=$}},lt.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},lt.use=function(G){return C.H.use(G)},lt.useActionState=function(G,$,ee){return C.H.useActionState(G,$,ee)},lt.useCallback=function(G,$){return C.H.useCallback(G,$)},lt.useContext=function(G){return C.H.useContext(G)},lt.useDebugValue=function(){},lt.useDeferredValue=function(G,$){return C.H.useDeferredValue(G,$)},lt.useEffect=function(G,$){return C.H.useEffect(G,$)},lt.useEffectEvent=function(G){return C.H.useEffectEvent(G)},lt.useId=function(){return C.H.useId()},lt.useImperativeHandle=function(G,$,ee){return C.H.useImperativeHandle(G,$,ee)},lt.useInsertionEffect=function(G,$){return C.H.useInsertionEffect(G,$)},lt.useLayoutEffect=function(G,$){return C.H.useLayoutEffect(G,$)},lt.useMemo=function(G,$){return C.H.useMemo(G,$)},lt.useOptimistic=function(G,$){return C.H.useOptimistic(G,$)},lt.useReducer=function(G,$,ee){return C.H.useReducer(G,$,ee)},lt.useRef=function(G){return C.H.useRef(G)},lt.useState=function(G){return C.H.useState(G)},lt.useSyncExternalStore=function(G,$,ee){return C.H.useSyncExternalStore(G,$,ee)},lt.useTransition=function(){return C.H.useTransition()},lt.version="19.2.0",lt}var d2;function sw(){return d2||(d2=1,px.exports=m6()),px.exports}var U=sw();const Em=h6(U);var gx={exports:{}},Xf={},mx={exports:{}},vx={};var f2;function v6(){return f2||(f2=1,(function(n){function e(H,W){var K=H.length;H.push(W);e:for(;0<K;){var de=K-1>>>1,Q=H[de];if(0<i(Q,W))H[de]=W,H[K]=Q,K=de;else break e}}function t(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var W=H[0],K=H.pop();if(K!==W){H[0]=K;e:for(var de=0,Q=H.length,G=Q>>>1;de<G;){var $=2*(de+1)-1,ee=H[$],te=$+1,le=H[te];if(0>i(ee,K))te<Q&&0>i(le,ee)?(H[de]=le,H[te]=K,de=te):(H[de]=ee,H[$]=K,de=$);else if(te<Q&&0>i(le,K))H[de]=le,H[te]=K,de=te;else break e}}return W}function i(H,W){var K=H.sortIndex-W.sortIndex;return K!==0?K:H.id-W.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();n.unstable_now=function(){return o.now()-c}}var u=[],d=[],h=1,p=null,m=3,b=!1,_=!1,w=!1,S=!1,T=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function O(H){for(var W=t(d);W!==null;){if(W.callback===null)r(d);else if(W.startTime<=H)r(d),W.sortIndex=W.expirationTime,e(u,W);else break;W=t(d)}}function M(H){if(w=!1,O(H),!_)if(t(u)!==null)_=!0,j||(j=!0,B());else{var W=t(d);W!==null&&Y(M,W.startTime-H)}}var j=!1,C=-1,I=5,k=-1;function z(){return S?!0:!(n.unstable_now()-k<I)}function L(){if(S=!1,j){var H=n.unstable_now();k=H;var W=!0;try{e:{_=!1,w&&(w=!1,A(C),C=-1),b=!0;var K=m;try{t:{for(O(H),p=t(u);p!==null&&!(p.expirationTime>H&&z());){var de=p.callback;if(typeof de=="function"){p.callback=null,m=p.priorityLevel;var Q=de(p.expirationTime<=H);if(H=n.unstable_now(),typeof Q=="function"){p.callback=Q,O(H),W=!0;break t}p===t(u)&&r(u),O(H)}else r(u);p=t(u)}if(p!==null)W=!0;else{var G=t(d);G!==null&&Y(M,G.startTime-H),W=!1}}break e}finally{p=null,m=K,b=!1}W=void 0}}finally{W?B():j=!1}}}var B;if(typeof D=="function")B=function(){D(L)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,J=P.port2;P.port1.onmessage=L,B=function(){J.postMessage(null)}}else B=function(){T(L,0)};function Y(H,W){C=T(function(){H(n.unstable_now())},W)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(H){H.callback=null},n.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<H?Math.floor(1e3/H):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function(H){switch(m){case 1:case 2:case 3:var W=3;break;default:W=m}var K=m;m=W;try{return H()}finally{m=K}},n.unstable_requestPaint=function(){S=!0},n.unstable_runWithPriority=function(H,W){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var K=m;m=H;try{return W()}finally{m=K}},n.unstable_scheduleCallback=function(H,W,K){var de=n.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?de+K:de):K=de,H){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=K+Q,H={id:h++,callback:W,priorityLevel:H,startTime:K,expirationTime:Q,sortIndex:-1},K>de?(H.sortIndex=K,e(d,H),t(u)===null&&H===t(d)&&(w?(A(C),C=-1):w=!0,Y(M,K-de))):(H.sortIndex=Q,e(u,H),_||b||(_=!0,j||(j=!0,B()))),H},n.unstable_shouldYield=z,n.unstable_wrapCallback=function(H){var W=m;return function(){var K=m;m=W;try{return H.apply(this,arguments)}finally{m=K}}}})(vx)),vx}var h2;function y6(){return h2||(h2=1,mx.exports=v6()),mx.exports}var yx={exports:{}},kr={};var p2;function b6(){if(p2)return kr;p2=1;var n=sw();function e(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)d+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(u,d,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:p==null?null:""+p,children:u,containerInfo:d,implementation:h}}var o=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return kr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,kr.createPortal=function(u,d){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return a(u,d,null,h)},kr.flushSync=function(u){var d=o.T,h=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=d,r.p=h,r.d.f()}},kr.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(u,d))},kr.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},kr.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin),m=typeof d.integrity=="string"?d.integrity:void 0,b=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;h==="style"?r.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:b}):h==="script"&&r.d.X(u,{crossOrigin:p,integrity:m,fetchPriority:b,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},kr.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var h=c(d.as,d.crossOrigin);r.d.M(u,{crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(u)},kr.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin);r.d.L(u,h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},kr.preloadModule=function(u,d){if(typeof u=="string")if(d){var h=c(d.as,d.crossOrigin);r.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(u)},kr.requestFormReset=function(u){r.d.r(u)},kr.unstable_batchedUpdates=function(u,d){return u(d)},kr.useFormState=function(u,d,h){return o.H.useFormState(u,d,h)},kr.useFormStatus=function(){return o.H.useHostTransitionStatus()},kr.version="19.2.0",kr}var g2;function x6(){if(g2)return yx.exports;g2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),yx.exports=b6(),yx.exports}var m2;function _6(){if(m2)return Xf;m2=1;var n=y6(),e=sw(),t=x6();function r(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var l=s,f=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(f=l.return),s=l.return;while(s)}return l.tag===3?f:null}function o(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function c(s){if(s.tag===31){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function u(s){if(a(s)!==s)throw Error(r(188))}function d(s){var l=s.alternate;if(!l){if(l=a(s),l===null)throw Error(r(188));return l!==s?null:s}for(var f=s,g=l;;){var x=f.return;if(x===null)break;var E=x.alternate;if(E===null){if(g=x.return,g!==null){f=g;continue}break}if(x.child===E.child){for(E=x.child;E;){if(E===f)return u(x),s;if(E===g)return u(x),l;E=E.sibling}throw Error(r(188))}if(f.return!==g.return)f=x,g=E;else{for(var N=!1,F=x.child;F;){if(F===f){N=!0,f=x,g=E;break}if(F===g){N=!0,g=x,f=E;break}F=F.sibling}if(!N){for(F=E.child;F;){if(F===f){N=!0,f=E,g=x;break}if(F===g){N=!0,g=E,f=x;break}F=F.sibling}if(!N)throw Error(r(189))}}if(f.alternate!==g)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?s:l}function h(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=h(s),l!==null)return l;s=s.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),A=Symbol.for("react.consumer"),D=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),z=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function B(s){return s===null||typeof s!="object"?null:(s=L&&s[L]||s["@@iterator"],typeof s=="function"?s:null)}var P=Symbol.for("react.client.reference");function J(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===P?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case w:return"Fragment";case T:return"Profiler";case S:return"StrictMode";case M:return"Suspense";case j:return"SuspenseList";case k:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case _:return"Portal";case D:return s.displayName||"Context";case A:return(s._context.displayName||"Context")+".Consumer";case O:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case C:return l=s.displayName||null,l!==null?l:J(s.type)||"Memo";case I:l=s._payload,s=s._init;try{return J(s(l))}catch{}}return null}var Y=Array.isArray,H=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K={pending:!1,data:null,method:null,action:null},de=[],Q=-1;function G(s){return{current:s}}function $(s){0>Q||(s.current=de[Q],de[Q]=null,Q--)}function ee(s,l){Q++,de[Q]=s.current,s.current=l}var te=G(null),le=G(null),fe=G(null),oe=G(null);function Ee(s,l){switch(ee(fe,l),ee(le,s),ee(te,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?kC(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=kC(l),s=NC(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}$(te),ee(te,s)}function ke(){$(te),$(le),$(fe)}function Ke(s){s.memoizedState!==null&&ee(oe,s);var l=te.current,f=NC(l,s.type);l!==f&&(ee(le,s),ee(te,f))}function Se(s){le.current===s&&($(te),$(le)),oe.current===s&&($(oe),qf._currentValue=K)}var Ne,Be;function Me(s){if(Ne===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);Ne=l&&l[1]||"",Be=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ne+s+Be}var He=!1;function we(s,l){if(!s||He)return"";He=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(l){var be=function(){throw Error()};if(Object.defineProperty(be.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(be,[])}catch(ge){var he=ge}Reflect.construct(s,[],be)}else{try{be.call()}catch(ge){he=ge}s.call(be.prototype)}}else{try{throw Error()}catch(ge){he=ge}(be=s())&&typeof be.catch=="function"&&be.catch(function(){})}}catch(ge){if(ge&&he&&typeof ge.stack=="string")return[ge.stack,he.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=g.DetermineComponentFrameRoot(),N=E[0],F=E[1];if(N&&F){var X=N.split(`
`),ue=F.split(`
`);for(x=g=0;g<X.length&&!X[g].includes("DetermineComponentFrameRoot");)g++;for(;x<ue.length&&!ue[x].includes("DetermineComponentFrameRoot");)x++;if(g===X.length||x===ue.length)for(g=X.length-1,x=ue.length-1;1<=g&&0<=x&&X[g]!==ue[x];)x--;for(;1<=g&&0<=x;g--,x--)if(X[g]!==ue[x]){if(g!==1||x!==1)do if(g--,x--,0>x||X[g]!==ue[x]){var ve=`
`+X[g].replace(" at new "," at ");return s.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",s.displayName)),ve}while(1<=g&&0<=x);break}}}finally{He=!1,Error.prepareStackTrace=f}return(f=s?s.displayName||s.name:"")?Me(f):""}function Ve(s,l){switch(s.tag){case 26:case 27:case 5:return Me(s.type);case 16:return Me("Lazy");case 13:return s.child!==l&&l!==null?Me("Suspense Fallback"):Me("Suspense");case 19:return Me("SuspenseList");case 0:case 15:return we(s.type,!1);case 11:return we(s.type.render,!1);case 1:return we(s.type,!0);case 31:return Me("Activity");default:return""}}function Ze(s){try{var l="",f=null;do l+=Ve(s,f),f=s,s=s.return;while(s);return l}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var Re=Object.prototype.hasOwnProperty,Oe=n.unstable_scheduleCallback,ct=n.unstable_cancelCallback,et=n.unstable_shouldYield,Ot=n.unstable_requestPaint,rt=n.unstable_now,pt=n.unstable_getCurrentPriorityLevel,jt=n.unstable_ImmediatePriority,Ft=n.unstable_UserBlockingPriority,jn=n.unstable_NormalPriority,ui=n.unstable_LowPriority,ls=n.unstable_IdlePriority,Zi=n.log,di=n.unstable_setDisableYieldValue,Ir=null,Sn=null;function rr(s){if(typeof Zi=="function"&&di(s),Sn&&typeof Sn.setStrictMode=="function")try{Sn.setStrictMode(Ir,s)}catch{}}var cn=Math.clz32?Math.clz32:wa,eo=Math.log,_a=Math.LN2;function wa(s){return s>>>=0,s===0?32:31-(eo(s)/_a|0)|0}var yt=256,un=262144,dn=4194304;function Pe(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function ut(s,l,f){var g=s.pendingLanes;if(g===0)return 0;var x=0,E=s.suspendedLanes,N=s.pingedLanes;s=s.warmLanes;var F=g&134217727;return F!==0?(g=F&~E,g!==0?x=Pe(g):(N&=F,N!==0?x=Pe(N):f||(f=F&~s,f!==0&&(x=Pe(f))))):(F=g&~E,F!==0?x=Pe(F):N!==0?x=Pe(N):f||(f=g&~s,f!==0&&(x=Pe(f)))),x===0?0:l!==0&&l!==x&&(l&E)===0&&(E=x&-x,f=l&-l,E>=f||E===32&&(f&4194048)!==0)?l:x}function qt(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function bt(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rr(){var s=dn;return dn<<=1,(dn&62914560)===0&&(dn=4194304),s}function Gn(s){for(var l=[],f=0;31>f;f++)l.push(s);return l}function ir(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function ar(s,l,f,g,x,E){var N=s.pendingLanes;s.pendingLanes=f,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=f,s.entangledLanes&=f,s.errorRecoveryDisabledLanes&=f,s.shellSuspendCounter=0;var F=s.entanglements,X=s.expirationTimes,ue=s.hiddenUpdates;for(f=N&~f;0<f;){var ve=31-cn(f),be=1<<ve;F[ve]=0,X[ve]=-1;var he=ue[ve];if(he!==null)for(ue[ve]=null,ve=0;ve<he.length;ve++){var ge=he[ve];ge!==null&&(ge.lane&=-536870913)}f&=~be}g!==0&&Dt(s,g,0),E!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=E&~(N&~l))}function Dt(s,l,f){s.pendingLanes|=l,s.suspendedLanes&=~l;var g=31-cn(l);s.entangledLanes|=l,s.entanglements[g]=s.entanglements[g]|1073741824|f&261930}function kt(s,l){var f=s.entangledLanes|=l;for(s=s.entanglements;f;){var g=31-cn(f),x=1<<g;x&l|s[g]&l&&(s[g]|=l),f&=~x}}function fn(s,l){var f=l&-l;return f=(f&42)!==0?1:Vt(f),(f&(s.suspendedLanes|l))!==0?0:f}function Vt(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function an(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Et(){var s=W.p;return s!==0?s:(s=window.event,s===void 0?32:t2(s.type))}function zt(s,l){var f=W.p;try{return W.p=s,l()}finally{W.p=f}}var hn=Math.random().toString(36).slice(2),ln="__reactFiber$"+hn,Wt="__reactProps$"+hn,pr="__reactContainer$"+hn,Dr="__reactEvents$"+hn,by="__reactListeners$"+hn,ng="__reactHandles$"+hn,rg="__reactResources$"+hn,Ea="__reactMarker$"+hn;function qc(s){delete s[ln],delete s[Wt],delete s[Dr],delete s[by],delete s[ng]}function Sa(s){var l=s[ln];if(l)return l;for(var f=s.parentNode;f;){if(l=f[pr]||f[ln]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(s=LC(s);s!==null;){if(f=s[ln])return f;s=LC(s)}return l}s=f,f=s.parentNode}return null}function Ti(s){if(s=s[ln]||s[pr]){var l=s.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return s}return null}function fi(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(r(33))}function Ta(s){var l=s[rg];return l||(l=s[rg]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function qn(s){s[Ea]=!0}var Wd=new Set,Qd={};function Aa(s,l){Ca(s,l),Ca(s+"Capture",l)}function Ca(s,l){for(Qd[s]=l,s=0;s<l.length;s++)Wd.add(l[s])}var Zd=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Jd={},ef={};function ig(s){return Re.call(ef,s)?!0:Re.call(Jd,s)?!1:Zd.test(s)?ef[s]=!0:(Jd[s]=!0,!1)}function Hc(s,l,f){if(ig(l))if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var g=l.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+f)}}function hi(s,l,f){if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+f)}}function Hn(s,l,f,g){if(g===null)s.removeAttribute(f);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(f);return}s.setAttributeNS(l,f,""+g)}}function gr(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function to(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function tf(s,l,f){var g=Object.getOwnPropertyDescriptor(s.constructor.prototype,l);if(!s.hasOwnProperty(l)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var x=g.get,E=g.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return x.call(this)},set:function(N){f=""+N,E.call(this,N)}}),Object.defineProperty(s,l,{enumerable:g.enumerable}),{getValue:function(){return f},setValue:function(N){f=""+N},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function Ht(s){if(!s._valueTracker){var l=to(s)?"checked":"value";s._valueTracker=tf(s,l,""+s[l])}}function wl(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var f=l.getValue(),g="";return s&&(g=to(s)?s.checked?"true":"false":s.value),s=g,s!==f?(l.setValue(s),!0):!1}function Ia(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var El=/[\n"\\]/g;function Xr(s){return s.replace(El,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function $c(s,l,f,g,x,E,N,F){s.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.type=N:s.removeAttribute("type"),l!=null?N==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+gr(l)):s.value!==""+gr(l)&&(s.value=""+gr(l)):N!=="submit"&&N!=="reset"||s.removeAttribute("value"),l!=null?nf(s,N,gr(l)):f!=null?nf(s,N,gr(f)):g!=null&&s.removeAttribute("value"),x==null&&E!=null&&(s.defaultChecked=!!E),x!=null&&(s.checked=x&&typeof x!="function"&&typeof x!="symbol"),F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"?s.name=""+gr(F):s.removeAttribute("name")}function ag(s,l,f,g,x,E,N,F){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(s.type=E),l!=null||f!=null){if(!(E!=="submit"&&E!=="reset"||l!=null)){Ht(s);return}f=f!=null?""+gr(f):"",l=l!=null?""+gr(l):f,F||l===s.value||(s.value=l),s.defaultValue=l}g=g??x,g=typeof g!="function"&&typeof g!="symbol"&&!!g,s.checked=F?s.checked:!!g,s.defaultChecked=!!g,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(s.name=N),Ht(s)}function nf(s,l,f){l==="number"&&Ia(s.ownerDocument)===s||s.defaultValue===""+f||(s.defaultValue=""+f)}function no(s,l,f,g){if(s=s.options,l){l={};for(var x=0;x<f.length;x++)l["$"+f[x]]=!0;for(f=0;f<s.length;f++)x=l.hasOwnProperty("$"+s[f].value),s[f].selected!==x&&(s[f].selected=x),x&&g&&(s[f].defaultSelected=!0)}else{for(f=""+gr(f),l=null,x=0;x<s.length;x++){if(s[x].value===f){s[x].selected=!0,g&&(s[x].defaultSelected=!0);return}l!==null||s[x].disabled||(l=s[x])}l!==null&&(l.selected=!0)}}function sg(s,l,f){if(l!=null&&(l=""+gr(l),l!==s.value&&(s.value=l),f==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=f!=null?""+gr(f):""}function ro(s,l,f,g){if(l==null){if(g!=null){if(f!=null)throw Error(r(92));if(Y(g)){if(1<g.length)throw Error(r(93));g=g[0]}f=g}f==null&&(f=""),l=f}f=gr(l),s.defaultValue=f,g=s.textContent,g===f&&g!==""&&g!==null&&(s.value=g),Ht(s)}function Wr(s,l){if(l){var f=s.firstChild;if(f&&f===s.lastChild&&f.nodeType===3){f.nodeValue=l;return}}s.textContent=l}var og=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function rf(s,l,f){var g=l.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?g?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":g?s.setProperty(l,f):typeof f!="number"||f===0||og.has(l)?l==="float"?s.cssFloat=f:s[l]=(""+f).trim():s[l]=f+"px"}function af(s,l,f){if(l!=null&&typeof l!="object")throw Error(r(62));if(s=s.style,f!=null){for(var g in f)!f.hasOwnProperty(g)||l!=null&&l.hasOwnProperty(g)||(g.indexOf("--")===0?s.setProperty(g,""):g==="float"?s.cssFloat="":s[g]="");for(var x in l)g=l[x],l.hasOwnProperty(x)&&f[x]!==g&&rf(s,x,g)}else for(var E in l)l.hasOwnProperty(E)&&rf(s,E,l[E])}function Yc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lg=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),io=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Kc(s){return io.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Ji(){}var sf=null;function Ai(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var ao=null,Ra=null;function Sl(s){var l=Ti(s);if(l&&(s=l.stateNode)){var f=s[Wt]||null;e:switch(s=l.stateNode,l.type){case"input":if($c(s,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),l=f.name,f.type==="radio"&&l!=null){for(f=s;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Xr(""+l)+'"][type="radio"]'),l=0;l<f.length;l++){var g=f[l];if(g!==s&&g.form===s.form){var x=g[Wt]||null;if(!x)throw Error(r(90));$c(g,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(l=0;l<f.length;l++)g=f[l],g.form===s.form&&wl(g)}break e;case"textarea":sg(s,f.value,f.defaultValue);break e;case"select":l=f.value,l!=null&&no(s,!!f.multiple,l,!1)}}}var Xc=!1;function so(s,l,f){if(Xc)return s(l,f);Xc=!0;try{var g=s(l);return g}finally{if(Xc=!1,(ao!==null||Ra!==null)&&(tm(),ao&&(l=ao,s=Ra,Ra=ao=null,Sl(l),s)))for(l=0;l<s.length;l++)Sl(s[l])}}function ea(s,l){var f=s.stateNode;if(f===null)return null;var g=f[Wt]||null;if(g===null)return null;f=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(s=s.type,g=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!g;break e;default:s=!1}if(s)return null;if(f&&typeof f!="function")throw Error(r(231,l,typeof f));return f}var Ci=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tl=!1;if(Ci)try{var Qt={};Object.defineProperty(Qt,"passive",{get:function(){Tl=!0}}),window.addEventListener("test",Qt,Qt),window.removeEventListener("test",Qt,Qt)}catch{Tl=!1}var Da=null,of=null,Al=null;function lf(){if(Al)return Al;var s,l=of,f=l.length,g,x="value"in Da?Da.value:Da.textContent,E=x.length;for(s=0;s<f&&l[s]===x[s];s++);var N=f-s;for(g=1;g<=N&&l[f-g]===x[E-g];g++);return Al=x.slice(s,1<g?1-g:void 0)}function Cl(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function cs(){return!0}function ta(){return!1}function yr(s){function l(f,g,x,E,N){this._reactName=f,this._targetInst=x,this.type=g,this.nativeEvent=E,this.target=N,this.currentTarget=null;for(var F in s)s.hasOwnProperty(F)&&(f=s[F],this[F]=f?f(E):E[F]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?cs:ta,this.isPropagationStopped=ta,this}return p(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=cs)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=cs)},persist:function(){},isPersistent:cs}),l}var us={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ka=yr(us),oo=p({},us,{view:0,detail:0}),cf=yr(oo),lo,Wc,Na,Qc=p({},oo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:co,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Na&&(Na&&s.type==="mousemove"?(lo=s.screenX-Na.screenX,Wc=s.screenY-Na.screenY):Wc=lo=0,Na=s),lo)},movementY:function(s){return"movementY"in s?s.movementY:Wc}}),uf=yr(Qc),Il=p({},Qc,{dataTransfer:0}),cg=yr(Il),ug=p({},oo,{relatedTarget:0}),Rl=yr(ug),df=p({},us,{animationName:0,elapsedTime:0,pseudoElement:0}),dg=yr(df),Zc=p({},us,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),fg=yr(Zc),hg=p({},us,{data:0}),Ma=yr(hg),pg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vg(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=mg[s])?!!l[s]:!1}function co(){return vg}var Br=p({},oo,{key:function(s){if(s.key){var l=pg[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=Cl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?gg[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:co,charCode:function(s){return s.type==="keypress"?Cl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Cl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),yg=yr(Br),bg=p({},Qc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ds=yr(bg),y=p({},oo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:co}),R=yr(y),V=p({},us,{propertyName:0,elapsedTime:0,pseudoElement:0}),q=yr(V),se=p({},Qc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),pe=yr(se),Ie=p({},us,{newState:0,oldState:0}),dt=yr(Ie),Vn=[9,13,27,32],Lt=Ci&&"CompositionEvent"in window,yn=null;Ci&&"documentMode"in document&&(yn=document.documentMode);var Ii=Ci&&"TextEvent"in window&&!yn,Pa=Ci&&(!Lt||yn&&8<yn&&11>=yn),na=" ",ra=!1;function Dl(s,l){switch(s){case"keyup":return Vn.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Jc(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var eu=!1;function VV(s,l){switch(s){case"compositionend":return Jc(l);case"keypress":return l.which!==32?null:(ra=!0,na);case"textInput":return s=l.data,s===na&&ra?null:s;default:return null}}function zV(s,l){if(eu)return s==="compositionend"||!Lt&&Dl(s,l)?(s=lf(),Al=of=Da=null,eu=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Pa&&l.locale!=="ko"?null:l.data;default:return null}}var LV={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function FS(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!LV[s.type]:l==="textarea"}function GS(s,l,f,g){ao?Ra?Ra.push(g):Ra=[g]:ao=g,l=lm(l,"onChange"),0<l.length&&(f=new ka("onChange","change",null,f,g),s.push({event:f,listeners:l}))}var ff=null,hf=null;function BV(s){TC(s,0)}function xg(s){var l=fi(s);if(wl(l))return s}function qS(s,l){if(s==="change")return l}var HS=!1;if(Ci){var xy;if(Ci){var _y="oninput"in document;if(!_y){var $S=document.createElement("div");$S.setAttribute("oninput","return;"),_y=typeof $S.oninput=="function"}xy=_y}else xy=!1;HS=xy&&(!document.documentMode||9<document.documentMode)}function YS(){ff&&(ff.detachEvent("onpropertychange",KS),hf=ff=null)}function KS(s){if(s.propertyName==="value"&&xg(hf)){var l=[];GS(l,hf,s,Ai(s)),so(BV,l)}}function UV(s,l,f){s==="focusin"?(YS(),ff=l,hf=f,ff.attachEvent("onpropertychange",KS)):s==="focusout"&&YS()}function FV(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return xg(hf)}function GV(s,l){if(s==="click")return xg(l)}function qV(s,l){if(s==="input"||s==="change")return xg(l)}function HV(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var pi=typeof Object.is=="function"?Object.is:HV;function pf(s,l){if(pi(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var f=Object.keys(s),g=Object.keys(l);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var x=f[g];if(!Re.call(l,x)||!pi(s[x],l[x]))return!1}return!0}function XS(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function WS(s,l){var f=XS(s);s=0;for(var g;f;){if(f.nodeType===3){if(g=s+f.textContent.length,s<=l&&g>=l)return{node:f,offset:l-s};s=g}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=XS(f)}}function QS(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?QS(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function ZS(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=Ia(s.document);l instanceof s.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)s=l.contentWindow;else break;l=Ia(s.document)}return l}function wy(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var $V=Ci&&"documentMode"in document&&11>=document.documentMode,tu=null,Ey=null,gf=null,Sy=!1;function JS(s,l,f){var g=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Sy||tu==null||tu!==Ia(g)||(g=tu,"selectionStart"in g&&wy(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),gf&&pf(gf,g)||(gf=g,g=lm(Ey,"onSelect"),0<g.length&&(l=new ka("onSelect","select",null,l,f),s.push({event:l,listeners:g}),l.target=tu)))}function kl(s,l){var f={};return f[s.toLowerCase()]=l.toLowerCase(),f["Webkit"+s]="webkit"+l,f["Moz"+s]="moz"+l,f}var nu={animationend:kl("Animation","AnimationEnd"),animationiteration:kl("Animation","AnimationIteration"),animationstart:kl("Animation","AnimationStart"),transitionrun:kl("Transition","TransitionRun"),transitionstart:kl("Transition","TransitionStart"),transitioncancel:kl("Transition","TransitionCancel"),transitionend:kl("Transition","TransitionEnd")},Ty={},eT={};Ci&&(eT=document.createElement("div").style,"AnimationEvent"in window||(delete nu.animationend.animation,delete nu.animationiteration.animation,delete nu.animationstart.animation),"TransitionEvent"in window||delete nu.transitionend.transition);function Nl(s){if(Ty[s])return Ty[s];if(!nu[s])return s;var l=nu[s],f;for(f in l)if(l.hasOwnProperty(f)&&f in eT)return Ty[s]=l[f];return s}var tT=Nl("animationend"),nT=Nl("animationiteration"),rT=Nl("animationstart"),YV=Nl("transitionrun"),KV=Nl("transitionstart"),XV=Nl("transitioncancel"),iT=Nl("transitionend"),aT=new Map,Ay="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ay.push("scrollEnd");function ia(s,l){aT.set(s,l),Aa(l,[s])}var _g=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Ri=[],ru=0,Cy=0;function wg(){for(var s=ru,l=Cy=ru=0;l<s;){var f=Ri[l];Ri[l++]=null;var g=Ri[l];Ri[l++]=null;var x=Ri[l];Ri[l++]=null;var E=Ri[l];if(Ri[l++]=null,g!==null&&x!==null){var N=g.pending;N===null?x.next=x:(x.next=N.next,N.next=x),g.pending=x}E!==0&&sT(f,x,E)}}function Eg(s,l,f,g){Ri[ru++]=s,Ri[ru++]=l,Ri[ru++]=f,Ri[ru++]=g,Cy|=g,s.lanes|=g,s=s.alternate,s!==null&&(s.lanes|=g)}function Iy(s,l,f,g){return Eg(s,l,f,g),Sg(s)}function Ml(s,l){return Eg(s,null,null,l),Sg(s)}function sT(s,l,f){s.lanes|=f;var g=s.alternate;g!==null&&(g.lanes|=f);for(var x=!1,E=s.return;E!==null;)E.childLanes|=f,g=E.alternate,g!==null&&(g.childLanes|=f),E.tag===22&&(s=E.stateNode,s===null||s._visibility&1||(x=!0)),s=E,E=E.return;return s.tag===3?(E=s.stateNode,x&&l!==null&&(x=31-cn(f),s=E.hiddenUpdates,g=s[x],g===null?s[x]=[l]:g.push(l),l.lane=f|536870912),E):null}function Sg(s){if(50<Vf)throw Vf=0,Vb=null,Error(r(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var iu={};function WV(s,l,f,g){this.tag=s,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gi(s,l,f,g){return new WV(s,l,f,g)}function Ry(s){return s=s.prototype,!(!s||!s.isReactComponent)}function fs(s,l){var f=s.alternate;return f===null?(f=gi(s.tag,l,s.key,s.mode),f.elementType=s.elementType,f.type=s.type,f.stateNode=s.stateNode,f.alternate=s,s.alternate=f):(f.pendingProps=l,f.type=s.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=s.flags&65011712,f.childLanes=s.childLanes,f.lanes=s.lanes,f.child=s.child,f.memoizedProps=s.memoizedProps,f.memoizedState=s.memoizedState,f.updateQueue=s.updateQueue,l=s.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=s.sibling,f.index=s.index,f.ref=s.ref,f.refCleanup=s.refCleanup,f}function oT(s,l){s.flags&=65011714;var f=s.alternate;return f===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=f.childLanes,s.lanes=f.lanes,s.child=f.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=f.memoizedProps,s.memoizedState=f.memoizedState,s.updateQueue=f.updateQueue,s.type=f.type,l=f.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function Tg(s,l,f,g,x,E){var N=0;if(g=s,typeof s=="function")Ry(s)&&(N=1);else if(typeof s=="string")N=t6(s,f,te.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case k:return s=gi(31,f,l,x),s.elementType=k,s.lanes=E,s;case w:return Pl(f.children,x,E,l);case S:N=8,x|=24;break;case T:return s=gi(12,f,l,x|2),s.elementType=T,s.lanes=E,s;case M:return s=gi(13,f,l,x),s.elementType=M,s.lanes=E,s;case j:return s=gi(19,f,l,x),s.elementType=j,s.lanes=E,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case D:N=10;break e;case A:N=9;break e;case O:N=11;break e;case C:N=14;break e;case I:N=16,g=null;break e}N=29,f=Error(r(130,s===null?"null":typeof s,"")),g=null}return l=gi(N,f,l,x),l.elementType=s,l.type=g,l.lanes=E,l}function Pl(s,l,f,g){return s=gi(7,s,g,l),s.lanes=f,s}function Dy(s,l,f){return s=gi(6,s,null,l),s.lanes=f,s}function lT(s){var l=gi(18,null,null,0);return l.stateNode=s,l}function ky(s,l,f){return l=gi(4,s.children!==null?s.children:[],s.key,l),l.lanes=f,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var cT=new WeakMap;function Di(s,l){if(typeof s=="object"&&s!==null){var f=cT.get(s);return f!==void 0?f:(l={value:s,source:l,stack:Ze(l)},cT.set(s,l),l)}return{value:s,source:l,stack:Ze(l)}}var au=[],su=0,Ag=null,mf=0,ki=[],Ni=0,uo=null,Oa=1,ja="";function hs(s,l){au[su++]=mf,au[su++]=Ag,Ag=s,mf=l}function uT(s,l,f){ki[Ni++]=Oa,ki[Ni++]=ja,ki[Ni++]=uo,uo=s;var g=Oa;s=ja;var x=32-cn(g)-1;g&=~(1<<x),f+=1;var E=32-cn(l)+x;if(30<E){var N=x-x%5;E=(g&(1<<N)-1).toString(32),g>>=N,x-=N,Oa=1<<32-cn(l)+x|f<<x|g,ja=E+s}else Oa=1<<E|f<<x|g,ja=s}function Ny(s){s.return!==null&&(hs(s,1),uT(s,1,0))}function My(s){for(;s===Ag;)Ag=au[--su],au[su]=null,mf=au[--su],au[su]=null;for(;s===uo;)uo=ki[--Ni],ki[Ni]=null,ja=ki[--Ni],ki[Ni]=null,Oa=ki[--Ni],ki[Ni]=null}function dT(s,l){ki[Ni++]=Oa,ki[Ni++]=ja,ki[Ni++]=uo,Oa=l.id,ja=l.overflow,uo=s}var br=null,pn=null,It=!1,fo=null,Mi=!1,Py=Error(r(519));function ho(s){var l=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw vf(Di(l,s)),Py}function fT(s){var l=s.stateNode,f=s.type,g=s.memoizedProps;switch(l[ln]=s,l[Wt]=g,f){case"dialog":wt("cancel",l),wt("close",l);break;case"iframe":case"object":case"embed":wt("load",l);break;case"video":case"audio":for(f=0;f<Lf.length;f++)wt(Lf[f],l);break;case"source":wt("error",l);break;case"img":case"image":case"link":wt("error",l),wt("load",l);break;case"details":wt("toggle",l);break;case"input":wt("invalid",l),ag(l,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":wt("invalid",l);break;case"textarea":wt("invalid",l),ro(l,g.value,g.defaultValue,g.children)}f=g.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||l.textContent===""+f||g.suppressHydrationWarning===!0||RC(l.textContent,f)?(g.popover!=null&&(wt("beforetoggle",l),wt("toggle",l)),g.onScroll!=null&&wt("scroll",l),g.onScrollEnd!=null&&wt("scrollend",l),g.onClick!=null&&(l.onclick=Ji),l=!0):l=!1,l||ho(s,!0)}function hT(s){for(br=s.return;br;)switch(br.tag){case 5:case 31:case 13:Mi=!1;return;case 27:case 3:Mi=!0;return;default:br=br.return}}function ou(s){if(s!==br)return!1;if(!It)return hT(s),It=!0,!1;var l=s.tag,f;if((f=l!==3&&l!==27)&&((f=l===5)&&(f=s.type,f=!(f!=="form"&&f!=="button")||Zb(s.type,s.memoizedProps)),f=!f),f&&pn&&ho(s),hT(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));pn=zC(s)}else if(l===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));pn=zC(s)}else l===27?(l=pn,Co(s.type)?(s=rx,rx=null,pn=s):pn=l):pn=br?Oi(s.stateNode.nextSibling):null;return!0}function Ol(){pn=br=null,It=!1}function Oy(){var s=fo;return s!==null&&(ei===null?ei=s:ei.push.apply(ei,s),fo=null),s}function vf(s){fo===null?fo=[s]:fo.push(s)}var jy=G(null),jl=null,ps=null;function po(s,l,f){ee(jy,l._currentValue),l._currentValue=f}function gs(s){s._currentValue=jy.current,$(jy)}function Vy(s,l,f){for(;s!==null;){var g=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),s===f)break;s=s.return}}function zy(s,l,f,g){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var E=x.dependencies;if(E!==null){var N=x.child;E=E.firstContext;e:for(;E!==null;){var F=E;E=x;for(var X=0;X<l.length;X++)if(F.context===l[X]){E.lanes|=f,F=E.alternate,F!==null&&(F.lanes|=f),Vy(E.return,f,s),g||(N=null);break e}E=F.next}}else if(x.tag===18){if(N=x.return,N===null)throw Error(r(341));N.lanes|=f,E=N.alternate,E!==null&&(E.lanes|=f),Vy(N,f,s),N=null}else N=x.child;if(N!==null)N.return=x;else for(N=x;N!==null;){if(N===s){N=null;break}if(x=N.sibling,x!==null){x.return=N.return,N=x;break}N=N.return}x=N}}function lu(s,l,f,g){s=null;for(var x=l,E=!1;x!==null;){if(!E){if((x.flags&524288)!==0)E=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var N=x.alternate;if(N===null)throw Error(r(387));if(N=N.memoizedProps,N!==null){var F=x.type;pi(x.pendingProps.value,N.value)||(s!==null?s.push(F):s=[F])}}else if(x===oe.current){if(N=x.alternate,N===null)throw Error(r(387));N.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(qf):s=[qf])}x=x.return}s!==null&&zy(l,s,f,g),l.flags|=262144}function Cg(s){for(s=s.firstContext;s!==null;){if(!pi(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Vl(s){jl=s,ps=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function xr(s){return pT(jl,s)}function Ig(s,l){return jl===null&&Vl(s),pT(s,l)}function pT(s,l){var f=l._currentValue;if(l={context:l,memoizedValue:f,next:null},ps===null){if(s===null)throw Error(r(308));ps=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else ps=ps.next=l;return f}var QV=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(f,g){s.push(g)}};this.abort=function(){l.aborted=!0,s.forEach(function(f){return f()})}},ZV=n.unstable_scheduleCallback,JV=n.unstable_NormalPriority,$n={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ly(){return{controller:new QV,data:new Map,refCount:0}}function yf(s){s.refCount--,s.refCount===0&&ZV(JV,function(){s.controller.abort()})}var bf=null,By=0,cu=0,uu=null;function e5(s,l){if(bf===null){var f=bf=[];By=0,cu=Gb(),uu={status:"pending",value:void 0,then:function(g){f.push(g)}}}return By++,l.then(gT,gT),l}function gT(){if(--By===0&&bf!==null){uu!==null&&(uu.status="fulfilled");var s=bf;bf=null,cu=0,uu=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function t5(s,l){var f=[],g={status:"pending",value:null,reason:null,then:function(x){f.push(x)}};return s.then(function(){g.status="fulfilled",g.value=l;for(var x=0;x<f.length;x++)(0,f[x])(l)},function(x){for(g.status="rejected",g.reason=x,x=0;x<f.length;x++)(0,f[x])(void 0)}),g}var mT=H.S;H.S=function(s,l){JA=rt(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&e5(s,l),mT!==null&&mT(s,l)};var zl=G(null);function Uy(){var s=zl.current;return s!==null?s:sn.pooledCache}function Rg(s,l){l===null?ee(zl,zl.current):ee(zl,l.pool)}function vT(){var s=Uy();return s===null?null:{parent:$n._currentValue,pool:s}}var du=Error(r(460)),Fy=Error(r(474)),Dg=Error(r(542)),kg={then:function(){}};function yT(s){return s=s.status,s==="fulfilled"||s==="rejected"}function bT(s,l,f){switch(f=s[f],f===void 0?s.push(l):f!==l&&(l.then(Ji,Ji),l=f),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,_T(s),s;default:if(typeof l.status=="string")l.then(Ji,Ji);else{if(s=sn,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=l,s.status="pending",s.then(function(g){if(l.status==="pending"){var x=l;x.status="fulfilled",x.value=g}},function(g){if(l.status==="pending"){var x=l;x.status="rejected",x.reason=g}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,_T(s),s}throw Bl=l,du}}function Ll(s){try{var l=s._init;return l(s._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(Bl=f,du):f}}var Bl=null;function xT(){if(Bl===null)throw Error(r(459));var s=Bl;return Bl=null,s}function _T(s){if(s===du||s===Dg)throw Error(r(483))}var fu=null,xf=0;function Ng(s){var l=xf;return xf+=1,fu===null&&(fu=[]),bT(fu,s,l)}function _f(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function Mg(s,l){throw l.$$typeof===m?Error(r(525)):(s=Object.prototype.toString.call(l),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function wT(s){function l(ie,re){if(s){var ce=ie.deletions;ce===null?(ie.deletions=[re],ie.flags|=16):ce.push(re)}}function f(ie,re){if(!s)return null;for(;re!==null;)l(ie,re),re=re.sibling;return null}function g(ie){for(var re=new Map;ie!==null;)ie.key!==null?re.set(ie.key,ie):re.set(ie.index,ie),ie=ie.sibling;return re}function x(ie,re){return ie=fs(ie,re),ie.index=0,ie.sibling=null,ie}function E(ie,re,ce){return ie.index=ce,s?(ce=ie.alternate,ce!==null?(ce=ce.index,ce<re?(ie.flags|=67108866,re):ce):(ie.flags|=67108866,re)):(ie.flags|=1048576,re)}function N(ie){return s&&ie.alternate===null&&(ie.flags|=67108866),ie}function F(ie,re,ce,ye){return re===null||re.tag!==6?(re=Dy(ce,ie.mode,ye),re.return=ie,re):(re=x(re,ce),re.return=ie,re)}function X(ie,re,ce,ye){var $e=ce.type;return $e===w?ve(ie,re,ce.props.children,ye,ce.key):re!==null&&(re.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===I&&Ll($e)===re.type)?(re=x(re,ce.props),_f(re,ce),re.return=ie,re):(re=Tg(ce.type,ce.key,ce.props,null,ie.mode,ye),_f(re,ce),re.return=ie,re)}function ue(ie,re,ce,ye){return re===null||re.tag!==4||re.stateNode.containerInfo!==ce.containerInfo||re.stateNode.implementation!==ce.implementation?(re=ky(ce,ie.mode,ye),re.return=ie,re):(re=x(re,ce.children||[]),re.return=ie,re)}function ve(ie,re,ce,ye,$e){return re===null||re.tag!==7?(re=Pl(ce,ie.mode,ye,$e),re.return=ie,re):(re=x(re,ce),re.return=ie,re)}function be(ie,re,ce){if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return re=Dy(""+re,ie.mode,ce),re.return=ie,re;if(typeof re=="object"&&re!==null){switch(re.$$typeof){case b:return ce=Tg(re.type,re.key,re.props,null,ie.mode,ce),_f(ce,re),ce.return=ie,ce;case _:return re=ky(re,ie.mode,ce),re.return=ie,re;case I:return re=Ll(re),be(ie,re,ce)}if(Y(re)||B(re))return re=Pl(re,ie.mode,ce,null),re.return=ie,re;if(typeof re.then=="function")return be(ie,Ng(re),ce);if(re.$$typeof===D)return be(ie,Ig(ie,re),ce);Mg(ie,re)}return null}function he(ie,re,ce,ye){var $e=re!==null?re.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return $e!==null?null:F(ie,re,""+ce,ye);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case b:return ce.key===$e?X(ie,re,ce,ye):null;case _:return ce.key===$e?ue(ie,re,ce,ye):null;case I:return ce=Ll(ce),he(ie,re,ce,ye)}if(Y(ce)||B(ce))return $e!==null?null:ve(ie,re,ce,ye,null);if(typeof ce.then=="function")return he(ie,re,Ng(ce),ye);if(ce.$$typeof===D)return he(ie,re,Ig(ie,ce),ye);Mg(ie,ce)}return null}function ge(ie,re,ce,ye,$e){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return ie=ie.get(ce)||null,F(re,ie,""+ye,$e);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case b:return ie=ie.get(ye.key===null?ce:ye.key)||null,X(re,ie,ye,$e);case _:return ie=ie.get(ye.key===null?ce:ye.key)||null,ue(re,ie,ye,$e);case I:return ye=Ll(ye),ge(ie,re,ce,ye,$e)}if(Y(ye)||B(ye))return ie=ie.get(ce)||null,ve(re,ie,ye,$e,null);if(typeof ye.then=="function")return ge(ie,re,ce,Ng(ye),$e);if(ye.$$typeof===D)return ge(ie,re,ce,Ig(re,ye),$e);Mg(re,ye)}return null}function ze(ie,re,ce,ye){for(var $e=null,Mt=null,Ue=re,gt=re=0,Tt=null;Ue!==null&&gt<ce.length;gt++){Ue.index>gt?(Tt=Ue,Ue=null):Tt=Ue.sibling;var Pt=he(ie,Ue,ce[gt],ye);if(Pt===null){Ue===null&&(Ue=Tt);break}s&&Ue&&Pt.alternate===null&&l(ie,Ue),re=E(Pt,re,gt),Mt===null?$e=Pt:Mt.sibling=Pt,Mt=Pt,Ue=Tt}if(gt===ce.length)return f(ie,Ue),It&&hs(ie,gt),$e;if(Ue===null){for(;gt<ce.length;gt++)Ue=be(ie,ce[gt],ye),Ue!==null&&(re=E(Ue,re,gt),Mt===null?$e=Ue:Mt.sibling=Ue,Mt=Ue);return It&&hs(ie,gt),$e}for(Ue=g(Ue);gt<ce.length;gt++)Tt=ge(Ue,ie,gt,ce[gt],ye),Tt!==null&&(s&&Tt.alternate!==null&&Ue.delete(Tt.key===null?gt:Tt.key),re=E(Tt,re,gt),Mt===null?$e=Tt:Mt.sibling=Tt,Mt=Tt);return s&&Ue.forEach(function(No){return l(ie,No)}),It&&hs(ie,gt),$e}function We(ie,re,ce,ye){if(ce==null)throw Error(r(151));for(var $e=null,Mt=null,Ue=re,gt=re=0,Tt=null,Pt=ce.next();Ue!==null&&!Pt.done;gt++,Pt=ce.next()){Ue.index>gt?(Tt=Ue,Ue=null):Tt=Ue.sibling;var No=he(ie,Ue,Pt.value,ye);if(No===null){Ue===null&&(Ue=Tt);break}s&&Ue&&No.alternate===null&&l(ie,Ue),re=E(No,re,gt),Mt===null?$e=No:Mt.sibling=No,Mt=No,Ue=Tt}if(Pt.done)return f(ie,Ue),It&&hs(ie,gt),$e;if(Ue===null){for(;!Pt.done;gt++,Pt=ce.next())Pt=be(ie,Pt.value,ye),Pt!==null&&(re=E(Pt,re,gt),Mt===null?$e=Pt:Mt.sibling=Pt,Mt=Pt);return It&&hs(ie,gt),$e}for(Ue=g(Ue);!Pt.done;gt++,Pt=ce.next())Pt=ge(Ue,ie,gt,Pt.value,ye),Pt!==null&&(s&&Pt.alternate!==null&&Ue.delete(Pt.key===null?gt:Pt.key),re=E(Pt,re,gt),Mt===null?$e=Pt:Mt.sibling=Pt,Mt=Pt);return s&&Ue.forEach(function(f6){return l(ie,f6)}),It&&hs(ie,gt),$e}function en(ie,re,ce,ye){if(typeof ce=="object"&&ce!==null&&ce.type===w&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case b:e:{for(var $e=ce.key;re!==null;){if(re.key===$e){if($e=ce.type,$e===w){if(re.tag===7){f(ie,re.sibling),ye=x(re,ce.props.children),ye.return=ie,ie=ye;break e}}else if(re.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===I&&Ll($e)===re.type){f(ie,re.sibling),ye=x(re,ce.props),_f(ye,ce),ye.return=ie,ie=ye;break e}f(ie,re);break}else l(ie,re);re=re.sibling}ce.type===w?(ye=Pl(ce.props.children,ie.mode,ye,ce.key),ye.return=ie,ie=ye):(ye=Tg(ce.type,ce.key,ce.props,null,ie.mode,ye),_f(ye,ce),ye.return=ie,ie=ye)}return N(ie);case _:e:{for($e=ce.key;re!==null;){if(re.key===$e)if(re.tag===4&&re.stateNode.containerInfo===ce.containerInfo&&re.stateNode.implementation===ce.implementation){f(ie,re.sibling),ye=x(re,ce.children||[]),ye.return=ie,ie=ye;break e}else{f(ie,re);break}else l(ie,re);re=re.sibling}ye=ky(ce,ie.mode,ye),ye.return=ie,ie=ye}return N(ie);case I:return ce=Ll(ce),en(ie,re,ce,ye)}if(Y(ce))return ze(ie,re,ce,ye);if(B(ce)){if($e=B(ce),typeof $e!="function")throw Error(r(150));return ce=$e.call(ce),We(ie,re,ce,ye)}if(typeof ce.then=="function")return en(ie,re,Ng(ce),ye);if(ce.$$typeof===D)return en(ie,re,Ig(ie,ce),ye);Mg(ie,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint"?(ce=""+ce,re!==null&&re.tag===6?(f(ie,re.sibling),ye=x(re,ce),ye.return=ie,ie=ye):(f(ie,re),ye=Dy(ce,ie.mode,ye),ye.return=ie,ie=ye),N(ie)):f(ie,re)}return function(ie,re,ce,ye){try{xf=0;var $e=en(ie,re,ce,ye);return fu=null,$e}catch(Ue){if(Ue===du||Ue===Dg)throw Ue;var Mt=gi(29,Ue,null,ie.mode);return Mt.lanes=ye,Mt.return=ie,Mt}finally{}}}var Ul=wT(!0),ET=wT(!1),go=!1;function Gy(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function qy(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function mo(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function vo(s,l,f){var g=s.updateQueue;if(g===null)return null;if(g=g.shared,(Bt&2)!==0){var x=g.pending;return x===null?l.next=l:(l.next=x.next,x.next=l),g.pending=l,l=Sg(s),sT(s,null,f),l}return Eg(s,g,l,f),Sg(s)}function wf(s,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194048)!==0)){var g=l.lanes;g&=s.pendingLanes,f|=g,l.lanes=f,kt(s,f)}}function Hy(s,l){var f=s.updateQueue,g=s.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var x=null,E=null;if(f=f.firstBaseUpdate,f!==null){do{var N={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};E===null?x=E=N:E=E.next=N,f=f.next}while(f!==null);E===null?x=E=l:E=E.next=l}else x=E=l;f={baseState:g.baseState,firstBaseUpdate:x,lastBaseUpdate:E,shared:g.shared,callbacks:g.callbacks},s.updateQueue=f;return}s=f.lastBaseUpdate,s===null?f.firstBaseUpdate=l:s.next=l,f.lastBaseUpdate=l}var $y=!1;function Ef(){if($y){var s=uu;if(s!==null)throw s}}function Sf(s,l,f,g){$y=!1;var x=s.updateQueue;go=!1;var E=x.firstBaseUpdate,N=x.lastBaseUpdate,F=x.shared.pending;if(F!==null){x.shared.pending=null;var X=F,ue=X.next;X.next=null,N===null?E=ue:N.next=ue,N=X;var ve=s.alternate;ve!==null&&(ve=ve.updateQueue,F=ve.lastBaseUpdate,F!==N&&(F===null?ve.firstBaseUpdate=ue:F.next=ue,ve.lastBaseUpdate=X))}if(E!==null){var be=x.baseState;N=0,ve=ue=X=null,F=E;do{var he=F.lane&-536870913,ge=he!==F.lane;if(ge?(St&he)===he:(g&he)===he){he!==0&&he===cu&&($y=!0),ve!==null&&(ve=ve.next={lane:0,tag:F.tag,payload:F.payload,callback:null,next:null});e:{var ze=s,We=F;he=l;var en=f;switch(We.tag){case 1:if(ze=We.payload,typeof ze=="function"){be=ze.call(en,be,he);break e}be=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=We.payload,he=typeof ze=="function"?ze.call(en,be,he):ze,he==null)break e;be=p({},be,he);break e;case 2:go=!0}}he=F.callback,he!==null&&(s.flags|=64,ge&&(s.flags|=8192),ge=x.callbacks,ge===null?x.callbacks=[he]:ge.push(he))}else ge={lane:he,tag:F.tag,payload:F.payload,callback:F.callback,next:null},ve===null?(ue=ve=ge,X=be):ve=ve.next=ge,N|=he;if(F=F.next,F===null){if(F=x.shared.pending,F===null)break;ge=F,F=ge.next,ge.next=null,x.lastBaseUpdate=ge,x.shared.pending=null}}while(!0);ve===null&&(X=be),x.baseState=X,x.firstBaseUpdate=ue,x.lastBaseUpdate=ve,E===null&&(x.shared.lanes=0),wo|=N,s.lanes=N,s.memoizedState=be}}function ST(s,l){if(typeof s!="function")throw Error(r(191,s));s.call(l)}function TT(s,l){var f=s.callbacks;if(f!==null)for(s.callbacks=null,s=0;s<f.length;s++)ST(f[s],l)}var hu=G(null),Pg=G(0);function AT(s,l){s=Ss,ee(Pg,s),ee(hu,l),Ss=s|l.baseLanes}function Yy(){ee(Pg,Ss),ee(hu,hu.current)}function Ky(){Ss=Pg.current,$(hu),$(Pg)}var mi=G(null),Pi=null;function yo(s){var l=s.alternate;ee(zn,zn.current&1),ee(mi,s),Pi===null&&(l===null||hu.current!==null||l.memoizedState!==null)&&(Pi=s)}function Xy(s){ee(zn,zn.current),ee(mi,s),Pi===null&&(Pi=s)}function CT(s){s.tag===22?(ee(zn,zn.current),ee(mi,s),Pi===null&&(Pi=s)):bo()}function bo(){ee(zn,zn.current),ee(mi,mi.current)}function vi(s){$(mi),Pi===s&&(Pi=null),$(zn)}var zn=G(0);function Og(s){for(var l=s;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||tx(f)||nx(f)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var ms=0,ft=null,Zt=null,Yn=null,jg=!1,pu=!1,Fl=!1,Vg=0,Tf=0,gu=null,n5=0;function Rn(){throw Error(r(321))}function Wy(s,l){if(l===null)return!1;for(var f=0;f<l.length&&f<s.length;f++)if(!pi(s[f],l[f]))return!1;return!0}function Qy(s,l,f,g,x,E){return ms=E,ft=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,H.H=s===null||s.memoizedState===null?uA:fb,Fl=!1,E=f(g,x),Fl=!1,pu&&(E=RT(l,f,g,x)),IT(s),E}function IT(s){H.H=If;var l=Zt!==null&&Zt.next!==null;if(ms=0,Yn=Zt=ft=null,jg=!1,Tf=0,gu=null,l)throw Error(r(300));s===null||Kn||(s=s.dependencies,s!==null&&Cg(s)&&(Kn=!0))}function RT(s,l,f,g){ft=s;var x=0;do{if(pu&&(gu=null),Tf=0,pu=!1,25<=x)throw Error(r(301));if(x+=1,Yn=Zt=null,s.updateQueue!=null){var E=s.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}H.H=dA,E=l(f,g)}while(pu);return E}function r5(){var s=H.H,l=s.useState()[0];return l=typeof l.then=="function"?Af(l):l,s=s.useState()[0],(Zt!==null?Zt.memoizedState:null)!==s&&(ft.flags|=1024),l}function Zy(){var s=Vg!==0;return Vg=0,s}function Jy(s,l,f){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~f}function eb(s){if(jg){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}jg=!1}ms=0,Yn=Zt=ft=null,pu=!1,Tf=Vg=0,gu=null}function Ur(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yn===null?ft.memoizedState=Yn=s:Yn=Yn.next=s,Yn}function Ln(){if(Zt===null){var s=ft.alternate;s=s!==null?s.memoizedState:null}else s=Zt.next;var l=Yn===null?ft.memoizedState:Yn.next;if(l!==null)Yn=l,Zt=s;else{if(s===null)throw ft.alternate===null?Error(r(467)):Error(r(310));Zt=s,s={memoizedState:Zt.memoizedState,baseState:Zt.baseState,baseQueue:Zt.baseQueue,queue:Zt.queue,next:null},Yn===null?ft.memoizedState=Yn=s:Yn=Yn.next=s}return Yn}function zg(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Af(s){var l=Tf;return Tf+=1,gu===null&&(gu=[]),s=bT(gu,s,l),l=ft,(Yn===null?l.memoizedState:Yn.next)===null&&(l=l.alternate,H.H=l===null||l.memoizedState===null?uA:fb),s}function Lg(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Af(s);if(s.$$typeof===D)return xr(s)}throw Error(r(438,String(s)))}function tb(s){var l=null,f=ft.updateQueue;if(f!==null&&(l=f.memoCache),l==null){var g=ft.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(l={data:g.data.map(function(x){return x.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),f===null&&(f=zg(),ft.updateQueue=f),f.memoCache=l,f=l.data[l.index],f===void 0)for(f=l.data[l.index]=Array(s),g=0;g<s;g++)f[g]=z;return l.index++,f}function vs(s,l){return typeof l=="function"?l(s):l}function Bg(s){var l=Ln();return nb(l,Zt,s)}function nb(s,l,f){var g=s.queue;if(g===null)throw Error(r(311));g.lastRenderedReducer=f;var x=s.baseQueue,E=g.pending;if(E!==null){if(x!==null){var N=x.next;x.next=E.next,E.next=N}l.baseQueue=x=E,g.pending=null}if(E=s.baseState,x===null)s.memoizedState=E;else{l=x.next;var F=N=null,X=null,ue=l,ve=!1;do{var be=ue.lane&-536870913;if(be!==ue.lane?(St&be)===be:(ms&be)===be){var he=ue.revertLane;if(he===0)X!==null&&(X=X.next={lane:0,revertLane:0,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),be===cu&&(ve=!0);else if((ms&he)===he){ue=ue.next,he===cu&&(ve=!0);continue}else be={lane:0,revertLane:ue.revertLane,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},X===null?(F=X=be,N=E):X=X.next=be,ft.lanes|=he,wo|=he;be=ue.action,Fl&&f(E,be),E=ue.hasEagerState?ue.eagerState:f(E,be)}else he={lane:be,revertLane:ue.revertLane,gesture:ue.gesture,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},X===null?(F=X=he,N=E):X=X.next=he,ft.lanes|=be,wo|=be;ue=ue.next}while(ue!==null&&ue!==l);if(X===null?N=E:X.next=F,!pi(E,s.memoizedState)&&(Kn=!0,ve&&(f=uu,f!==null)))throw f;s.memoizedState=E,s.baseState=N,s.baseQueue=X,g.lastRenderedState=E}return x===null&&(g.lanes=0),[s.memoizedState,g.dispatch]}function rb(s){var l=Ln(),f=l.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=s;var g=f.dispatch,x=f.pending,E=l.memoizedState;if(x!==null){f.pending=null;var N=x=x.next;do E=s(E,N.action),N=N.next;while(N!==x);pi(E,l.memoizedState)||(Kn=!0),l.memoizedState=E,l.baseQueue===null&&(l.baseState=E),f.lastRenderedState=E}return[E,g]}function DT(s,l,f){var g=ft,x=Ln(),E=It;if(E){if(f===void 0)throw Error(r(407));f=f()}else f=l();var N=!pi((Zt||x).memoizedState,f);if(N&&(x.memoizedState=f,Kn=!0),x=x.queue,sb(MT.bind(null,g,x,s),[s]),x.getSnapshot!==l||N||Yn!==null&&Yn.memoizedState.tag&1){if(g.flags|=2048,mu(9,{destroy:void 0},NT.bind(null,g,x,f,l),null),sn===null)throw Error(r(349));E||(ms&127)!==0||kT(g,l,f)}return f}function kT(s,l,f){s.flags|=16384,s={getSnapshot:l,value:f},l=ft.updateQueue,l===null?(l=zg(),ft.updateQueue=l,l.stores=[s]):(f=l.stores,f===null?l.stores=[s]:f.push(s))}function NT(s,l,f,g){l.value=f,l.getSnapshot=g,PT(l)&&OT(s)}function MT(s,l,f){return f(function(){PT(l)&&OT(s)})}function PT(s){var l=s.getSnapshot;s=s.value;try{var f=l();return!pi(s,f)}catch{return!0}}function OT(s){var l=Ml(s,2);l!==null&&ti(l,s,2)}function ib(s){var l=Ur();if(typeof s=="function"){var f=s;if(s=f(),Fl){rr(!0);try{f()}finally{rr(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vs,lastRenderedState:s},l}function jT(s,l,f,g){return s.baseState=f,nb(s,Zt,typeof g=="function"?g:vs)}function i5(s,l,f,g,x){if(Gg(s))throw Error(r(485));if(s=l.action,s!==null){var E={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){E.listeners.push(N)}};H.T!==null?f(!0):E.isTransition=!1,g(E),f=l.pending,f===null?(E.next=l.pending=E,VT(l,E)):(E.next=f.next,l.pending=f.next=E)}}function VT(s,l){var f=l.action,g=l.payload,x=s.state;if(l.isTransition){var E=H.T,N={};H.T=N;try{var F=f(x,g),X=H.S;X!==null&&X(N,F),zT(s,l,F)}catch(ue){ab(s,l,ue)}finally{E!==null&&N.types!==null&&(E.types=N.types),H.T=E}}else try{E=f(x,g),zT(s,l,E)}catch(ue){ab(s,l,ue)}}function zT(s,l,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(g){LT(s,l,g)},function(g){return ab(s,l,g)}):LT(s,l,f)}function LT(s,l,f){l.status="fulfilled",l.value=f,BT(l),s.state=f,l=s.pending,l!==null&&(f=l.next,f===l?s.pending=null:(f=f.next,l.next=f,VT(s,f)))}function ab(s,l,f){var g=s.pending;if(s.pending=null,g!==null){g=g.next;do l.status="rejected",l.reason=f,BT(l),l=l.next;while(l!==g)}s.action=null}function BT(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function UT(s,l){return l}function FT(s,l){if(It){var f=sn.formState;if(f!==null){e:{var g=ft;if(It){if(pn){t:{for(var x=pn,E=Mi;x.nodeType!==8;){if(!E){x=null;break t}if(x=Oi(x.nextSibling),x===null){x=null;break t}}E=x.data,x=E==="F!"||E==="F"?x:null}if(x){pn=Oi(x.nextSibling),g=x.data==="F!";break e}}ho(g)}g=!1}g&&(l=f[0])}}return f=Ur(),f.memoizedState=f.baseState=l,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:UT,lastRenderedState:l},f.queue=g,f=oA.bind(null,ft,g),g.dispatch=f,g=ib(!1),E=db.bind(null,ft,!1,g.queue),g=Ur(),x={state:l,dispatch:null,action:s,pending:null},g.queue=x,f=i5.bind(null,ft,x,E,f),x.dispatch=f,g.memoizedState=s,[l,f,!1]}function GT(s){var l=Ln();return qT(l,Zt,s)}function qT(s,l,f){if(l=nb(s,l,UT)[0],s=Bg(vs)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var g=Af(l)}catch(N){throw N===du?Dg:N}else g=l;l=Ln();var x=l.queue,E=x.dispatch;return f!==l.memoizedState&&(ft.flags|=2048,mu(9,{destroy:void 0},a5.bind(null,x,f),null)),[g,E,s]}function a5(s,l){s.action=l}function HT(s){var l=Ln(),f=Zt;if(f!==null)return qT(l,f,s);Ln(),l=l.memoizedState,f=Ln();var g=f.queue.dispatch;return f.memoizedState=s,[l,g,!1]}function mu(s,l,f,g){return s={tag:s,create:f,deps:g,inst:l,next:null},l=ft.updateQueue,l===null&&(l=zg(),ft.updateQueue=l),f=l.lastEffect,f===null?l.lastEffect=s.next=s:(g=f.next,f.next=s,s.next=g,l.lastEffect=s),s}function $T(){return Ln().memoizedState}function Ug(s,l,f,g){var x=Ur();ft.flags|=s,x.memoizedState=mu(1|l,{destroy:void 0},f,g===void 0?null:g)}function Fg(s,l,f,g){var x=Ln();g=g===void 0?null:g;var E=x.memoizedState.inst;Zt!==null&&g!==null&&Wy(g,Zt.memoizedState.deps)?x.memoizedState=mu(l,E,f,g):(ft.flags|=s,x.memoizedState=mu(1|l,E,f,g))}function YT(s,l){Ug(8390656,8,s,l)}function sb(s,l){Fg(2048,8,s,l)}function s5(s){ft.flags|=4;var l=ft.updateQueue;if(l===null)l=zg(),ft.updateQueue=l,l.events=[s];else{var f=l.events;f===null?l.events=[s]:f.push(s)}}function KT(s){var l=Ln().memoizedState;return s5({ref:l,nextImpl:s}),function(){if((Bt&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}function XT(s,l){return Fg(4,2,s,l)}function WT(s,l){return Fg(4,4,s,l)}function QT(s,l){if(typeof l=="function"){s=s();var f=l(s);return function(){typeof f=="function"?f():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function ZT(s,l,f){f=f!=null?f.concat([s]):null,Fg(4,4,QT.bind(null,l,s),f)}function ob(){}function JT(s,l){var f=Ln();l=l===void 0?null:l;var g=f.memoizedState;return l!==null&&Wy(l,g[1])?g[0]:(f.memoizedState=[s,l],s)}function eA(s,l){var f=Ln();l=l===void 0?null:l;var g=f.memoizedState;if(l!==null&&Wy(l,g[1]))return g[0];if(g=s(),Fl){rr(!0);try{s()}finally{rr(!1)}}return f.memoizedState=[g,l],g}function lb(s,l,f){return f===void 0||(ms&1073741824)!==0&&(St&261930)===0?s.memoizedState=l:(s.memoizedState=f,s=tC(),ft.lanes|=s,wo|=s,f)}function tA(s,l,f,g){return pi(f,l)?f:hu.current!==null?(s=lb(s,f,g),pi(s,l)||(Kn=!0),s):(ms&42)===0||(ms&1073741824)!==0&&(St&261930)===0?(Kn=!0,s.memoizedState=f):(s=tC(),ft.lanes|=s,wo|=s,l)}function nA(s,l,f,g,x){var E=W.p;W.p=E!==0&&8>E?E:8;var N=H.T,F={};H.T=F,db(s,!1,l,f);try{var X=x(),ue=H.S;if(ue!==null&&ue(F,X),X!==null&&typeof X=="object"&&typeof X.then=="function"){var ve=t5(X,g);Cf(s,l,ve,xi(s))}else Cf(s,l,g,xi(s))}catch(be){Cf(s,l,{then:function(){},status:"rejected",reason:be},xi())}finally{W.p=E,N!==null&&F.types!==null&&(N.types=F.types),H.T=N}}function o5(){}function cb(s,l,f,g){if(s.tag!==5)throw Error(r(476));var x=rA(s).queue;nA(s,x,l,K,f===null?o5:function(){return iA(s),f(g)})}function rA(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vs,lastRenderedState:K},next:null};var f={};return l.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vs,lastRenderedState:f},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function iA(s){var l=rA(s);l.next===null&&(l=s.alternate.memoizedState),Cf(s,l.next.queue,{},xi())}function ub(){return xr(qf)}function aA(){return Ln().memoizedState}function sA(){return Ln().memoizedState}function l5(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var f=xi();s=mo(f);var g=vo(l,s,f);g!==null&&(ti(g,l,f),wf(g,l,f)),l={cache:Ly()},s.payload=l;return}l=l.return}}function c5(s,l,f){var g=xi();f={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Gg(s)?lA(l,f):(f=Iy(s,l,f,g),f!==null&&(ti(f,s,g),cA(f,l,g)))}function oA(s,l,f){var g=xi();Cf(s,l,f,g)}function Cf(s,l,f,g){var x={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Gg(s))lA(l,x);else{var E=s.alternate;if(s.lanes===0&&(E===null||E.lanes===0)&&(E=l.lastRenderedReducer,E!==null))try{var N=l.lastRenderedState,F=E(N,f);if(x.hasEagerState=!0,x.eagerState=F,pi(F,N))return Eg(s,l,x,0),sn===null&&wg(),!1}catch{}finally{}if(f=Iy(s,l,x,g),f!==null)return ti(f,s,g),cA(f,l,g),!0}return!1}function db(s,l,f,g){if(g={lane:2,revertLane:Gb(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Gg(s)){if(l)throw Error(r(479))}else l=Iy(s,f,g,2),l!==null&&ti(l,s,2)}function Gg(s){var l=s.alternate;return s===ft||l!==null&&l===ft}function lA(s,l){pu=jg=!0;var f=s.pending;f===null?l.next=l:(l.next=f.next,f.next=l),s.pending=l}function cA(s,l,f){if((f&4194048)!==0){var g=l.lanes;g&=s.pendingLanes,f|=g,l.lanes=f,kt(s,f)}}var If={readContext:xr,use:Lg,useCallback:Rn,useContext:Rn,useEffect:Rn,useImperativeHandle:Rn,useLayoutEffect:Rn,useInsertionEffect:Rn,useMemo:Rn,useReducer:Rn,useRef:Rn,useState:Rn,useDebugValue:Rn,useDeferredValue:Rn,useTransition:Rn,useSyncExternalStore:Rn,useId:Rn,useHostTransitionStatus:Rn,useFormState:Rn,useActionState:Rn,useOptimistic:Rn,useMemoCache:Rn,useCacheRefresh:Rn};If.useEffectEvent=Rn;var uA={readContext:xr,use:Lg,useCallback:function(s,l){return Ur().memoizedState=[s,l===void 0?null:l],s},useContext:xr,useEffect:YT,useImperativeHandle:function(s,l,f){f=f!=null?f.concat([s]):null,Ug(4194308,4,QT.bind(null,l,s),f)},useLayoutEffect:function(s,l){return Ug(4194308,4,s,l)},useInsertionEffect:function(s,l){Ug(4,2,s,l)},useMemo:function(s,l){var f=Ur();l=l===void 0?null:l;var g=s();if(Fl){rr(!0);try{s()}finally{rr(!1)}}return f.memoizedState=[g,l],g},useReducer:function(s,l,f){var g=Ur();if(f!==void 0){var x=f(l);if(Fl){rr(!0);try{f(l)}finally{rr(!1)}}}else x=l;return g.memoizedState=g.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},g.queue=s,s=s.dispatch=c5.bind(null,ft,s),[g.memoizedState,s]},useRef:function(s){var l=Ur();return s={current:s},l.memoizedState=s},useState:function(s){s=ib(s);var l=s.queue,f=oA.bind(null,ft,l);return l.dispatch=f,[s.memoizedState,f]},useDebugValue:ob,useDeferredValue:function(s,l){var f=Ur();return lb(f,s,l)},useTransition:function(){var s=ib(!1);return s=nA.bind(null,ft,s.queue,!0,!1),Ur().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,f){var g=ft,x=Ur();if(It){if(f===void 0)throw Error(r(407));f=f()}else{if(f=l(),sn===null)throw Error(r(349));(St&127)!==0||kT(g,l,f)}x.memoizedState=f;var E={value:f,getSnapshot:l};return x.queue=E,YT(MT.bind(null,g,E,s),[s]),g.flags|=2048,mu(9,{destroy:void 0},NT.bind(null,g,E,f,l),null),f},useId:function(){var s=Ur(),l=sn.identifierPrefix;if(It){var f=ja,g=Oa;f=(g&~(1<<32-cn(g)-1)).toString(32)+f,l="_"+l+"R_"+f,f=Vg++,0<f&&(l+="H"+f.toString(32)),l+="_"}else f=n5++,l="_"+l+"r_"+f.toString(32)+"_";return s.memoizedState=l},useHostTransitionStatus:ub,useFormState:FT,useActionState:FT,useOptimistic:function(s){var l=Ur();l.memoizedState=l.baseState=s;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=f,l=db.bind(null,ft,!0,f),f.dispatch=l,[s,l]},useMemoCache:tb,useCacheRefresh:function(){return Ur().memoizedState=l5.bind(null,ft)},useEffectEvent:function(s){var l=Ur(),f={impl:s};return l.memoizedState=f,function(){if((Bt&2)!==0)throw Error(r(440));return f.impl.apply(void 0,arguments)}}},fb={readContext:xr,use:Lg,useCallback:JT,useContext:xr,useEffect:sb,useImperativeHandle:ZT,useInsertionEffect:XT,useLayoutEffect:WT,useMemo:eA,useReducer:Bg,useRef:$T,useState:function(){return Bg(vs)},useDebugValue:ob,useDeferredValue:function(s,l){var f=Ln();return tA(f,Zt.memoizedState,s,l)},useTransition:function(){var s=Bg(vs)[0],l=Ln().memoizedState;return[typeof s=="boolean"?s:Af(s),l]},useSyncExternalStore:DT,useId:aA,useHostTransitionStatus:ub,useFormState:GT,useActionState:GT,useOptimistic:function(s,l){var f=Ln();return jT(f,Zt,s,l)},useMemoCache:tb,useCacheRefresh:sA};fb.useEffectEvent=KT;var dA={readContext:xr,use:Lg,useCallback:JT,useContext:xr,useEffect:sb,useImperativeHandle:ZT,useInsertionEffect:XT,useLayoutEffect:WT,useMemo:eA,useReducer:rb,useRef:$T,useState:function(){return rb(vs)},useDebugValue:ob,useDeferredValue:function(s,l){var f=Ln();return Zt===null?lb(f,s,l):tA(f,Zt.memoizedState,s,l)},useTransition:function(){var s=rb(vs)[0],l=Ln().memoizedState;return[typeof s=="boolean"?s:Af(s),l]},useSyncExternalStore:DT,useId:aA,useHostTransitionStatus:ub,useFormState:HT,useActionState:HT,useOptimistic:function(s,l){var f=Ln();return Zt!==null?jT(f,Zt,s,l):(f.baseState=s,[s,f.queue.dispatch])},useMemoCache:tb,useCacheRefresh:sA};dA.useEffectEvent=KT;function hb(s,l,f,g){l=s.memoizedState,f=f(g,l),f=f==null?l:p({},l,f),s.memoizedState=f,s.lanes===0&&(s.updateQueue.baseState=f)}var pb={enqueueSetState:function(s,l,f){s=s._reactInternals;var g=xi(),x=mo(g);x.payload=l,f!=null&&(x.callback=f),l=vo(s,x,g),l!==null&&(ti(l,s,g),wf(l,s,g))},enqueueReplaceState:function(s,l,f){s=s._reactInternals;var g=xi(),x=mo(g);x.tag=1,x.payload=l,f!=null&&(x.callback=f),l=vo(s,x,g),l!==null&&(ti(l,s,g),wf(l,s,g))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var f=xi(),g=mo(f);g.tag=2,l!=null&&(g.callback=l),l=vo(s,g,f),l!==null&&(ti(l,s,f),wf(l,s,f))}};function fA(s,l,f,g,x,E,N){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(g,E,N):l.prototype&&l.prototype.isPureReactComponent?!pf(f,g)||!pf(x,E):!0}function hA(s,l,f,g){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,g),l.state!==s&&pb.enqueueReplaceState(l,l.state,null)}function Gl(s,l){var f=l;if("ref"in l){f={};for(var g in l)g!=="ref"&&(f[g]=l[g])}if(s=s.defaultProps){f===l&&(f=p({},f));for(var x in s)f[x]===void 0&&(f[x]=s[x])}return f}function pA(s){_g(s)}function gA(s){console.error(s)}function mA(s){_g(s)}function qg(s,l){try{var f=s.onUncaughtError;f(l.value,{componentStack:l.stack})}catch(g){setTimeout(function(){throw g})}}function vA(s,l,f){try{var g=s.onCaughtError;g(f.value,{componentStack:f.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function gb(s,l,f){return f=mo(f),f.tag=3,f.payload={element:null},f.callback=function(){qg(s,l)},f}function yA(s){return s=mo(s),s.tag=3,s}function bA(s,l,f,g){var x=f.type.getDerivedStateFromError;if(typeof x=="function"){var E=g.value;s.payload=function(){return x(E)},s.callback=function(){vA(l,f,g)}}var N=f.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(s.callback=function(){vA(l,f,g),typeof x!="function"&&(Eo===null?Eo=new Set([this]):Eo.add(this));var F=g.stack;this.componentDidCatch(g.value,{componentStack:F!==null?F:""})})}function u5(s,l,f,g,x){if(f.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(l=f.alternate,l!==null&&lu(l,f,x,!0),f=mi.current,f!==null){switch(f.tag){case 31:case 13:return Pi===null?nm():f.alternate===null&&Dn===0&&(Dn=3),f.flags&=-257,f.flags|=65536,f.lanes=x,g===kg?f.flags|=16384:(l=f.updateQueue,l===null?f.updateQueue=new Set([g]):l.add(g),Bb(s,g,x)),!1;case 22:return f.flags|=65536,g===kg?f.flags|=16384:(l=f.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([g])},f.updateQueue=l):(f=l.retryQueue,f===null?l.retryQueue=new Set([g]):f.add(g)),Bb(s,g,x)),!1}throw Error(r(435,f.tag))}return Bb(s,g,x),nm(),!1}if(It)return l=mi.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=x,g!==Py&&(s=Error(r(422),{cause:g}),vf(Di(s,f)))):(g!==Py&&(l=Error(r(423),{cause:g}),vf(Di(l,f))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,g=Di(g,f),x=gb(s.stateNode,g,x),Hy(s,x),Dn!==4&&(Dn=2)),!1;var E=Error(r(520),{cause:g});if(E=Di(E,f),jf===null?jf=[E]:jf.push(E),Dn!==4&&(Dn=2),l===null)return!0;g=Di(g,f),f=l;do{switch(f.tag){case 3:return f.flags|=65536,s=x&-x,f.lanes|=s,s=gb(f.stateNode,g,s),Hy(f,s),!1;case 1:if(l=f.type,E=f.stateNode,(f.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Eo===null||!Eo.has(E))))return f.flags|=65536,x&=-x,f.lanes|=x,x=yA(x),bA(x,s,f,g),Hy(f,x),!1}f=f.return}while(f!==null);return!1}var mb=Error(r(461)),Kn=!1;function _r(s,l,f,g){l.child=s===null?ET(l,null,f,g):Ul(l,s.child,f,g)}function xA(s,l,f,g,x){f=f.render;var E=l.ref;if("ref"in g){var N={};for(var F in g)F!=="ref"&&(N[F]=g[F])}else N=g;return Vl(l),g=Qy(s,l,f,N,E,x),F=Zy(),s!==null&&!Kn?(Jy(s,l,x),ys(s,l,x)):(It&&F&&Ny(l),l.flags|=1,_r(s,l,g,x),l.child)}function _A(s,l,f,g,x){if(s===null){var E=f.type;return typeof E=="function"&&!Ry(E)&&E.defaultProps===void 0&&f.compare===null?(l.tag=15,l.type=E,wA(s,l,E,g,x)):(s=Tg(f.type,null,g,l,l.mode,x),s.ref=l.ref,s.return=l,l.child=s)}if(E=s.child,!Sb(s,x)){var N=E.memoizedProps;if(f=f.compare,f=f!==null?f:pf,f(N,g)&&s.ref===l.ref)return ys(s,l,x)}return l.flags|=1,s=fs(E,g),s.ref=l.ref,s.return=l,l.child=s}function wA(s,l,f,g,x){if(s!==null){var E=s.memoizedProps;if(pf(E,g)&&s.ref===l.ref)if(Kn=!1,l.pendingProps=g=E,Sb(s,x))(s.flags&131072)!==0&&(Kn=!0);else return l.lanes=s.lanes,ys(s,l,x)}return vb(s,l,f,g,x)}function EA(s,l,f,g){var x=g.children,E=s!==null?s.memoizedState:null;if(s===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((l.flags&128)!==0){if(E=E!==null?E.baseLanes|f:f,s!==null){for(g=l.child=s.child,x=0;g!==null;)x=x|g.lanes|g.childLanes,g=g.sibling;g=x&~E}else g=0,l.child=null;return SA(s,l,E,f,g)}if((f&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&Rg(l,E!==null?E.cachePool:null),E!==null?AT(l,E):Yy(),CT(l);else return g=l.lanes=536870912,SA(s,l,E!==null?E.baseLanes|f:f,f,g)}else E!==null?(Rg(l,E.cachePool),AT(l,E),bo(),l.memoizedState=null):(s!==null&&Rg(l,null),Yy(),bo());return _r(s,l,x,f),l.child}function Rf(s,l){return s!==null&&s.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function SA(s,l,f,g,x){var E=Uy();return E=E===null?null:{parent:$n._currentValue,pool:E},l.memoizedState={baseLanes:f,cachePool:E},s!==null&&Rg(l,null),Yy(),CT(l),s!==null&&lu(s,l,g,!0),l.childLanes=x,null}function Hg(s,l){return l=Yg({mode:l.mode,children:l.children},s.mode),l.ref=s.ref,s.child=l,l.return=s,l}function TA(s,l,f){return Ul(l,s.child,null,f),s=Hg(l,l.pendingProps),s.flags|=2,vi(l),l.memoizedState=null,s}function d5(s,l,f){var g=l.pendingProps,x=(l.flags&128)!==0;if(l.flags&=-129,s===null){if(It){if(g.mode==="hidden")return s=Hg(l,g),l.lanes=536870912,Rf(null,s);if(Xy(l),(s=pn)?(s=VC(s,Mi),s=s!==null&&s.data==="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:uo!==null?{id:Oa,overflow:ja}:null,retryLane:536870912,hydrationErrors:null},f=lT(s),f.return=l,l.child=f,br=l,pn=null)):s=null,s===null)throw ho(l);return l.lanes=536870912,null}return Hg(l,g)}var E=s.memoizedState;if(E!==null){var N=E.dehydrated;if(Xy(l),x)if(l.flags&256)l.flags&=-257,l=TA(s,l,f);else if(l.memoizedState!==null)l.child=s.child,l.flags|=128,l=null;else throw Error(r(558));else if(Kn||lu(s,l,f,!1),x=(f&s.childLanes)!==0,Kn||x){if(g=sn,g!==null&&(N=fn(g,f),N!==0&&N!==E.retryLane))throw E.retryLane=N,Ml(s,N),ti(g,s,N),mb;nm(),l=TA(s,l,f)}else s=E.treeContext,pn=Oi(N.nextSibling),br=l,It=!0,fo=null,Mi=!1,s!==null&&dT(l,s),l=Hg(l,g),l.flags|=4096;return l}return s=fs(s.child,{mode:g.mode,children:g.children}),s.ref=l.ref,l.child=s,s.return=l,s}function $g(s,l){var f=l.ref;if(f===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(r(284));(s===null||s.ref!==f)&&(l.flags|=4194816)}}function vb(s,l,f,g,x){return Vl(l),f=Qy(s,l,f,g,void 0,x),g=Zy(),s!==null&&!Kn?(Jy(s,l,x),ys(s,l,x)):(It&&g&&Ny(l),l.flags|=1,_r(s,l,f,x),l.child)}function AA(s,l,f,g,x,E){return Vl(l),l.updateQueue=null,f=RT(l,g,f,x),IT(s),g=Zy(),s!==null&&!Kn?(Jy(s,l,E),ys(s,l,E)):(It&&g&&Ny(l),l.flags|=1,_r(s,l,f,E),l.child)}function CA(s,l,f,g,x){if(Vl(l),l.stateNode===null){var E=iu,N=f.contextType;typeof N=="object"&&N!==null&&(E=xr(N)),E=new f(g,E),l.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=pb,l.stateNode=E,E._reactInternals=l,E=l.stateNode,E.props=g,E.state=l.memoizedState,E.refs={},Gy(l),N=f.contextType,E.context=typeof N=="object"&&N!==null?xr(N):iu,E.state=l.memoizedState,N=f.getDerivedStateFromProps,typeof N=="function"&&(hb(l,f,N,g),E.state=l.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(N=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),N!==E.state&&pb.enqueueReplaceState(E,E.state,null),Sf(l,g,E,x),Ef(),E.state=l.memoizedState),typeof E.componentDidMount=="function"&&(l.flags|=4194308),g=!0}else if(s===null){E=l.stateNode;var F=l.memoizedProps,X=Gl(f,F);E.props=X;var ue=E.context,ve=f.contextType;N=iu,typeof ve=="object"&&ve!==null&&(N=xr(ve));var be=f.getDerivedStateFromProps;ve=typeof be=="function"||typeof E.getSnapshotBeforeUpdate=="function",F=l.pendingProps!==F,ve||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(F||ue!==N)&&hA(l,E,g,N),go=!1;var he=l.memoizedState;E.state=he,Sf(l,g,E,x),Ef(),ue=l.memoizedState,F||he!==ue||go?(typeof be=="function"&&(hb(l,f,be,g),ue=l.memoizedState),(X=go||fA(l,f,X,g,he,ue,N))?(ve||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(l.flags|=4194308)):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=ue),E.props=g,E.state=ue,E.context=N,g=X):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{E=l.stateNode,qy(s,l),N=l.memoizedProps,ve=Gl(f,N),E.props=ve,be=l.pendingProps,he=E.context,ue=f.contextType,X=iu,typeof ue=="object"&&ue!==null&&(X=xr(ue)),F=f.getDerivedStateFromProps,(ue=typeof F=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(N!==be||he!==X)&&hA(l,E,g,X),go=!1,he=l.memoizedState,E.state=he,Sf(l,g,E,x),Ef();var ge=l.memoizedState;N!==be||he!==ge||go||s!==null&&s.dependencies!==null&&Cg(s.dependencies)?(typeof F=="function"&&(hb(l,f,F,g),ge=l.memoizedState),(ve=go||fA(l,f,ve,g,he,ge,X)||s!==null&&s.dependencies!==null&&Cg(s.dependencies))?(ue||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(g,ge,X),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(g,ge,X)),typeof E.componentDidUpdate=="function"&&(l.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof E.componentDidUpdate!="function"||N===s.memoizedProps&&he===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&he===s.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=ge),E.props=g,E.state=ge,E.context=X,g=ve):(typeof E.componentDidUpdate!="function"||N===s.memoizedProps&&he===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&he===s.memoizedState||(l.flags|=1024),g=!1)}return E=g,$g(s,l),g=(l.flags&128)!==0,E||g?(E=l.stateNode,f=g&&typeof f.getDerivedStateFromError!="function"?null:E.render(),l.flags|=1,s!==null&&g?(l.child=Ul(l,s.child,null,x),l.child=Ul(l,null,f,x)):_r(s,l,f,x),l.memoizedState=E.state,s=l.child):s=ys(s,l,x),s}function IA(s,l,f,g){return Ol(),l.flags|=256,_r(s,l,f,g),l.child}var yb={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function bb(s){return{baseLanes:s,cachePool:vT()}}function xb(s,l,f){return s=s!==null?s.childLanes&~f:0,l&&(s|=bi),s}function RA(s,l,f){var g=l.pendingProps,x=!1,E=(l.flags&128)!==0,N;if((N=E)||(N=s!==null&&s.memoizedState===null?!1:(zn.current&2)!==0),N&&(x=!0,l.flags&=-129),N=(l.flags&32)!==0,l.flags&=-33,s===null){if(It){if(x?yo(l):bo(),(s=pn)?(s=VC(s,Mi),s=s!==null&&s.data!=="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:uo!==null?{id:Oa,overflow:ja}:null,retryLane:536870912,hydrationErrors:null},f=lT(s),f.return=l,l.child=f,br=l,pn=null)):s=null,s===null)throw ho(l);return nx(s)?l.lanes=32:l.lanes=536870912,null}var F=g.children;return g=g.fallback,x?(bo(),x=l.mode,F=Yg({mode:"hidden",children:F},x),g=Pl(g,x,f,null),F.return=l,g.return=l,F.sibling=g,l.child=F,g=l.child,g.memoizedState=bb(f),g.childLanes=xb(s,N,f),l.memoizedState=yb,Rf(null,g)):(yo(l),_b(l,F))}var X=s.memoizedState;if(X!==null&&(F=X.dehydrated,F!==null)){if(E)l.flags&256?(yo(l),l.flags&=-257,l=wb(s,l,f)):l.memoizedState!==null?(bo(),l.child=s.child,l.flags|=128,l=null):(bo(),F=g.fallback,x=l.mode,g=Yg({mode:"visible",children:g.children},x),F=Pl(F,x,f,null),F.flags|=2,g.return=l,F.return=l,g.sibling=F,l.child=g,Ul(l,s.child,null,f),g=l.child,g.memoizedState=bb(f),g.childLanes=xb(s,N,f),l.memoizedState=yb,l=Rf(null,g));else if(yo(l),nx(F)){if(N=F.nextSibling&&F.nextSibling.dataset,N)var ue=N.dgst;N=ue,g=Error(r(419)),g.stack="",g.digest=N,vf({value:g,source:null,stack:null}),l=wb(s,l,f)}else if(Kn||lu(s,l,f,!1),N=(f&s.childLanes)!==0,Kn||N){if(N=sn,N!==null&&(g=fn(N,f),g!==0&&g!==X.retryLane))throw X.retryLane=g,Ml(s,g),ti(N,s,g),mb;tx(F)||nm(),l=wb(s,l,f)}else tx(F)?(l.flags|=192,l.child=s.child,l=null):(s=X.treeContext,pn=Oi(F.nextSibling),br=l,It=!0,fo=null,Mi=!1,s!==null&&dT(l,s),l=_b(l,g.children),l.flags|=4096);return l}return x?(bo(),F=g.fallback,x=l.mode,X=s.child,ue=X.sibling,g=fs(X,{mode:"hidden",children:g.children}),g.subtreeFlags=X.subtreeFlags&65011712,ue!==null?F=fs(ue,F):(F=Pl(F,x,f,null),F.flags|=2),F.return=l,g.return=l,g.sibling=F,l.child=g,Rf(null,g),g=l.child,F=s.child.memoizedState,F===null?F=bb(f):(x=F.cachePool,x!==null?(X=$n._currentValue,x=x.parent!==X?{parent:X,pool:X}:x):x=vT(),F={baseLanes:F.baseLanes|f,cachePool:x}),g.memoizedState=F,g.childLanes=xb(s,N,f),l.memoizedState=yb,Rf(s.child,g)):(yo(l),f=s.child,s=f.sibling,f=fs(f,{mode:"visible",children:g.children}),f.return=l,f.sibling=null,s!==null&&(N=l.deletions,N===null?(l.deletions=[s],l.flags|=16):N.push(s)),l.child=f,l.memoizedState=null,f)}function _b(s,l){return l=Yg({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function Yg(s,l){return s=gi(22,s,null,l),s.lanes=0,s}function wb(s,l,f){return Ul(l,s.child,null,f),s=_b(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function DA(s,l,f){s.lanes|=l;var g=s.alternate;g!==null&&(g.lanes|=l),Vy(s.return,l,f)}function Eb(s,l,f,g,x,E){var N=s.memoizedState;N===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:x,treeForkCount:E}:(N.isBackwards=l,N.rendering=null,N.renderingStartTime=0,N.last=g,N.tail=f,N.tailMode=x,N.treeForkCount=E)}function kA(s,l,f){var g=l.pendingProps,x=g.revealOrder,E=g.tail;g=g.children;var N=zn.current,F=(N&2)!==0;if(F?(N=N&1|2,l.flags|=128):N&=1,ee(zn,N),_r(s,l,g,f),g=It?mf:0,!F&&s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&DA(s,f,l);else if(s.tag===19)DA(s,f,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(x){case"forwards":for(f=l.child,x=null;f!==null;)s=f.alternate,s!==null&&Og(s)===null&&(x=f),f=f.sibling;f=x,f===null?(x=l.child,l.child=null):(x=f.sibling,f.sibling=null),Eb(l,!1,x,f,E,g);break;case"backwards":case"unstable_legacy-backwards":for(f=null,x=l.child,l.child=null;x!==null;){if(s=x.alternate,s!==null&&Og(s)===null){l.child=x;break}s=x.sibling,x.sibling=f,f=x,x=s}Eb(l,!0,f,null,E,g);break;case"together":Eb(l,!1,null,null,void 0,g);break;default:l.memoizedState=null}return l.child}function ys(s,l,f){if(s!==null&&(l.dependencies=s.dependencies),wo|=l.lanes,(f&l.childLanes)===0)if(s!==null){if(lu(s,l,f,!1),(f&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(r(153));if(l.child!==null){for(s=l.child,f=fs(s,s.pendingProps),l.child=f,f.return=l;s.sibling!==null;)s=s.sibling,f=f.sibling=fs(s,s.pendingProps),f.return=l;f.sibling=null}return l.child}function Sb(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&Cg(s)))}function f5(s,l,f){switch(l.tag){case 3:Ee(l,l.stateNode.containerInfo),po(l,$n,s.memoizedState.cache),Ol();break;case 27:case 5:Ke(l);break;case 4:Ee(l,l.stateNode.containerInfo);break;case 10:po(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,Xy(l),null;break;case 13:var g=l.memoizedState;if(g!==null)return g.dehydrated!==null?(yo(l),l.flags|=128,null):(f&l.child.childLanes)!==0?RA(s,l,f):(yo(l),s=ys(s,l,f),s!==null?s.sibling:null);yo(l);break;case 19:var x=(s.flags&128)!==0;if(g=(f&l.childLanes)!==0,g||(lu(s,l,f,!1),g=(f&l.childLanes)!==0),x){if(g)return kA(s,l,f);l.flags|=128}if(x=l.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),ee(zn,zn.current),g)break;return null;case 22:return l.lanes=0,EA(s,l,f,l.pendingProps);case 24:po(l,$n,s.memoizedState.cache)}return ys(s,l,f)}function NA(s,l,f){if(s!==null)if(s.memoizedProps!==l.pendingProps)Kn=!0;else{if(!Sb(s,f)&&(l.flags&128)===0)return Kn=!1,f5(s,l,f);Kn=(s.flags&131072)!==0}else Kn=!1,It&&(l.flags&1048576)!==0&&uT(l,mf,l.index);switch(l.lanes=0,l.tag){case 16:e:{var g=l.pendingProps;if(s=Ll(l.elementType),l.type=s,typeof s=="function")Ry(s)?(g=Gl(s,g),l.tag=1,l=CA(null,l,s,g,f)):(l.tag=0,l=vb(null,l,s,g,f));else{if(s!=null){var x=s.$$typeof;if(x===O){l.tag=11,l=xA(null,l,s,g,f);break e}else if(x===C){l.tag=14,l=_A(null,l,s,g,f);break e}}throw l=J(s)||s,Error(r(306,l,""))}}return l;case 0:return vb(s,l,l.type,l.pendingProps,f);case 1:return g=l.type,x=Gl(g,l.pendingProps),CA(s,l,g,x,f);case 3:e:{if(Ee(l,l.stateNode.containerInfo),s===null)throw Error(r(387));g=l.pendingProps;var E=l.memoizedState;x=E.element,qy(s,l),Sf(l,g,null,f);var N=l.memoizedState;if(g=N.cache,po(l,$n,g),g!==E.cache&&zy(l,[$n],f,!0),Ef(),g=N.element,E.isDehydrated)if(E={element:g,isDehydrated:!1,cache:N.cache},l.updateQueue.baseState=E,l.memoizedState=E,l.flags&256){l=IA(s,l,g,f);break e}else if(g!==x){x=Di(Error(r(424)),l),vf(x),l=IA(s,l,g,f);break e}else{switch(s=l.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(pn=Oi(s.firstChild),br=l,It=!0,fo=null,Mi=!0,f=ET(l,null,g,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(Ol(),g===x){l=ys(s,l,f);break e}_r(s,l,g,f)}l=l.child}return l;case 26:return $g(s,l),s===null?(f=GC(l.type,null,l.pendingProps,null))?l.memoizedState=f:It||(f=l.type,s=l.pendingProps,g=cm(fe.current).createElement(f),g[ln]=l,g[Wt]=s,wr(g,f,s),qn(g),l.stateNode=g):l.memoizedState=GC(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return Ke(l),s===null&&It&&(g=l.stateNode=BC(l.type,l.pendingProps,fe.current),br=l,Mi=!0,x=pn,Co(l.type)?(rx=x,pn=Oi(g.firstChild)):pn=x),_r(s,l,l.pendingProps.children,f),$g(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&It&&((x=g=pn)&&(g=F5(g,l.type,l.pendingProps,Mi),g!==null?(l.stateNode=g,br=l,pn=Oi(g.firstChild),Mi=!1,x=!0):x=!1),x||ho(l)),Ke(l),x=l.type,E=l.pendingProps,N=s!==null?s.memoizedProps:null,g=E.children,Zb(x,E)?g=null:N!==null&&Zb(x,N)&&(l.flags|=32),l.memoizedState!==null&&(x=Qy(s,l,r5,null,null,f),qf._currentValue=x),$g(s,l),_r(s,l,g,f),l.child;case 6:return s===null&&It&&((s=f=pn)&&(f=G5(f,l.pendingProps,Mi),f!==null?(l.stateNode=f,br=l,pn=null,s=!0):s=!1),s||ho(l)),null;case 13:return RA(s,l,f);case 4:return Ee(l,l.stateNode.containerInfo),g=l.pendingProps,s===null?l.child=Ul(l,null,g,f):_r(s,l,g,f),l.child;case 11:return xA(s,l,l.type,l.pendingProps,f);case 7:return _r(s,l,l.pendingProps,f),l.child;case 8:return _r(s,l,l.pendingProps.children,f),l.child;case 12:return _r(s,l,l.pendingProps.children,f),l.child;case 10:return g=l.pendingProps,po(l,l.type,g.value),_r(s,l,g.children,f),l.child;case 9:return x=l.type._context,g=l.pendingProps.children,Vl(l),x=xr(x),g=g(x),l.flags|=1,_r(s,l,g,f),l.child;case 14:return _A(s,l,l.type,l.pendingProps,f);case 15:return wA(s,l,l.type,l.pendingProps,f);case 19:return kA(s,l,f);case 31:return d5(s,l,f);case 22:return EA(s,l,f,l.pendingProps);case 24:return Vl(l),g=xr($n),s===null?(x=Uy(),x===null&&(x=sn,E=Ly(),x.pooledCache=E,E.refCount++,E!==null&&(x.pooledCacheLanes|=f),x=E),l.memoizedState={parent:g,cache:x},Gy(l),po(l,$n,x)):((s.lanes&f)!==0&&(qy(s,l),Sf(l,null,null,f),Ef()),x=s.memoizedState,E=l.memoizedState,x.parent!==g?(x={parent:g,cache:g},l.memoizedState=x,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=x),po(l,$n,g)):(g=E.cache,po(l,$n,g),g!==x.cache&&zy(l,[$n],f,!0))),_r(s,l,l.pendingProps.children,f),l.child;case 29:throw l.pendingProps}throw Error(r(156,l.tag))}function bs(s){s.flags|=4}function Tb(s,l,f,g,x){if((l=(s.mode&32)!==0)&&(l=!1),l){if(s.flags|=16777216,(x&335544128)===x)if(s.stateNode.complete)s.flags|=8192;else if(aC())s.flags|=8192;else throw Bl=kg,Fy}else s.flags&=-16777217}function MA(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!KC(l))if(aC())s.flags|=8192;else throw Bl=kg,Fy}function Kg(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?Rr():536870912,s.lanes|=l,xu|=l)}function Df(s,l){if(!It)switch(s.tailMode){case"hidden":l=s.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s.tail=null:f.sibling=null;break;case"collapsed":f=s.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:g.sibling=null}}function gn(s){var l=s.alternate!==null&&s.alternate.child===s.child,f=0,g=0;if(l)for(var x=s.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags&65011712,g|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags,g|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=g,s.childLanes=f,l}function h5(s,l,f){var g=l.pendingProps;switch(My(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gn(l),null;case 1:return gn(l),null;case 3:return f=l.stateNode,g=null,s!==null&&(g=s.memoizedState.cache),l.memoizedState.cache!==g&&(l.flags|=2048),gs($n),ke(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(ou(l)?bs(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Oy())),gn(l),null;case 26:var x=l.type,E=l.memoizedState;return s===null?(bs(l),E!==null?(gn(l),MA(l,E)):(gn(l),Tb(l,x,null,g,f))):E?E!==s.memoizedState?(bs(l),gn(l),MA(l,E)):(gn(l),l.flags&=-16777217):(s=s.memoizedProps,s!==g&&bs(l),gn(l),Tb(l,x,s,g,f)),null;case 27:if(Se(l),f=fe.current,x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==g&&bs(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return gn(l),null}s=te.current,ou(l)?fT(l):(s=BC(x,g,f),l.stateNode=s,bs(l))}return gn(l),null;case 5:if(Se(l),x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==g&&bs(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return gn(l),null}if(E=te.current,ou(l))fT(l);else{var N=cm(fe.current);switch(E){case 1:E=N.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:E=N.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":E=N.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":E=N.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":E=N.createElement("div"),E.innerHTML="<script><\/script>",E=E.removeChild(E.firstChild);break;case"select":E=typeof g.is=="string"?N.createElement("select",{is:g.is}):N.createElement("select"),g.multiple?E.multiple=!0:g.size&&(E.size=g.size);break;default:E=typeof g.is=="string"?N.createElement(x,{is:g.is}):N.createElement(x)}}E[ln]=l,E[Wt]=g;e:for(N=l.child;N!==null;){if(N.tag===5||N.tag===6)E.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===l)break e;for(;N.sibling===null;){if(N.return===null||N.return===l)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}l.stateNode=E;e:switch(wr(E,x,g),x){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&bs(l)}}return gn(l),Tb(l,l.type,s===null?null:s.memoizedProps,l.pendingProps,f),null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==g&&bs(l);else{if(typeof g!="string"&&l.stateNode===null)throw Error(r(166));if(s=fe.current,ou(l)){if(s=l.stateNode,f=l.memoizedProps,g=null,x=br,x!==null)switch(x.tag){case 27:case 5:g=x.memoizedProps}s[ln]=l,s=!!(s.nodeValue===f||g!==null&&g.suppressHydrationWarning===!0||RC(s.nodeValue,f)),s||ho(l,!0)}else s=cm(s).createTextNode(g),s[ln]=l,l.stateNode=s}return gn(l),null;case 31:if(f=l.memoizedState,s===null||s.memoizedState!==null){if(g=ou(l),f!==null){if(s===null){if(!g)throw Error(r(318));if(s=l.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(557));s[ln]=l}else Ol(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;gn(l),s=!1}else f=Oy(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),s=!0;if(!s)return l.flags&256?(vi(l),l):(vi(l),null);if((l.flags&128)!==0)throw Error(r(558))}return gn(l),null;case 13:if(g=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=ou(l),g!==null&&g.dehydrated!==null){if(s===null){if(!x)throw Error(r(318));if(x=l.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[ln]=l}else Ol(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;gn(l),x=!1}else x=Oy(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return l.flags&256?(vi(l),l):(vi(l),null)}return vi(l),(l.flags&128)!==0?(l.lanes=f,l):(f=g!==null,s=s!==null&&s.memoizedState!==null,f&&(g=l.child,x=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(x=g.alternate.memoizedState.cachePool.pool),E=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(E=g.memoizedState.cachePool.pool),E!==x&&(g.flags|=2048)),f!==s&&f&&(l.child.flags|=8192),Kg(l,l.updateQueue),gn(l),null);case 4:return ke(),s===null&&Yb(l.stateNode.containerInfo),gn(l),null;case 10:return gs(l.type),gn(l),null;case 19:if($(zn),g=l.memoizedState,g===null)return gn(l),null;if(x=(l.flags&128)!==0,E=g.rendering,E===null)if(x)Df(g,!1);else{if(Dn!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(E=Og(s),E!==null){for(l.flags|=128,Df(g,!1),s=E.updateQueue,l.updateQueue=s,Kg(l,s),l.subtreeFlags=0,s=f,f=l.child;f!==null;)oT(f,s),f=f.sibling;return ee(zn,zn.current&1|2),It&&hs(l,g.treeForkCount),l.child}s=s.sibling}g.tail!==null&&rt()>Jg&&(l.flags|=128,x=!0,Df(g,!1),l.lanes=4194304)}else{if(!x)if(s=Og(E),s!==null){if(l.flags|=128,x=!0,s=s.updateQueue,l.updateQueue=s,Kg(l,s),Df(g,!0),g.tail===null&&g.tailMode==="hidden"&&!E.alternate&&!It)return gn(l),null}else 2*rt()-g.renderingStartTime>Jg&&f!==536870912&&(l.flags|=128,x=!0,Df(g,!1),l.lanes=4194304);g.isBackwards?(E.sibling=l.child,l.child=E):(s=g.last,s!==null?s.sibling=E:l.child=E,g.last=E)}return g.tail!==null?(s=g.tail,g.rendering=s,g.tail=s.sibling,g.renderingStartTime=rt(),s.sibling=null,f=zn.current,ee(zn,x?f&1|2:f&1),It&&hs(l,g.treeForkCount),s):(gn(l),null);case 22:case 23:return vi(l),Ky(),g=l.memoizedState!==null,s!==null?s.memoizedState!==null!==g&&(l.flags|=8192):g&&(l.flags|=8192),g?(f&536870912)!==0&&(l.flags&128)===0&&(gn(l),l.subtreeFlags&6&&(l.flags|=8192)):gn(l),f=l.updateQueue,f!==null&&Kg(l,f.retryQueue),f=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),g=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),g!==f&&(l.flags|=2048),s!==null&&$(zl),null;case 24:return f=null,s!==null&&(f=s.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),gs($n),gn(l),null;case 25:return null;case 30:return null}throw Error(r(156,l.tag))}function p5(s,l){switch(My(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return gs($n),ke(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return Se(l),null;case 31:if(l.memoizedState!==null){if(vi(l),l.alternate===null)throw Error(r(340));Ol()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 13:if(vi(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(r(340));Ol()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return $(zn),null;case 4:return ke(),null;case 10:return gs(l.type),null;case 22:case 23:return vi(l),Ky(),s!==null&&$(zl),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return gs($n),null;case 25:return null;default:return null}}function PA(s,l){switch(My(l),l.tag){case 3:gs($n),ke();break;case 26:case 27:case 5:Se(l);break;case 4:ke();break;case 31:l.memoizedState!==null&&vi(l);break;case 13:vi(l);break;case 19:$(zn);break;case 10:gs(l.type);break;case 22:case 23:vi(l),Ky(),s!==null&&$(zl);break;case 24:gs($n)}}function kf(s,l){try{var f=l.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var x=g.next;f=x;do{if((f.tag&s)===s){g=void 0;var E=f.create,N=f.inst;g=E(),N.destroy=g}f=f.next}while(f!==x)}}catch(F){Yt(l,l.return,F)}}function xo(s,l,f){try{var g=l.updateQueue,x=g!==null?g.lastEffect:null;if(x!==null){var E=x.next;g=E;do{if((g.tag&s)===s){var N=g.inst,F=N.destroy;if(F!==void 0){N.destroy=void 0,x=l;var X=f,ue=F;try{ue()}catch(ve){Yt(x,X,ve)}}}g=g.next}while(g!==E)}}catch(ve){Yt(l,l.return,ve)}}function OA(s){var l=s.updateQueue;if(l!==null){var f=s.stateNode;try{TT(l,f)}catch(g){Yt(s,s.return,g)}}}function jA(s,l,f){f.props=Gl(s.type,s.memoizedProps),f.state=s.memoizedState;try{f.componentWillUnmount()}catch(g){Yt(s,l,g)}}function Nf(s,l){try{var f=s.ref;if(f!==null){switch(s.tag){case 26:case 27:case 5:var g=s.stateNode;break;case 30:g=s.stateNode;break;default:g=s.stateNode}typeof f=="function"?s.refCleanup=f(g):f.current=g}}catch(x){Yt(s,l,x)}}function Va(s,l){var f=s.ref,g=s.refCleanup;if(f!==null)if(typeof g=="function")try{g()}catch(x){Yt(s,l,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(x){Yt(s,l,x)}else f.current=null}function VA(s){var l=s.type,f=s.memoizedProps,g=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":f.autoFocus&&g.focus();break e;case"img":f.src?g.src=f.src:f.srcSet&&(g.srcset=f.srcSet)}}catch(x){Yt(s,s.return,x)}}function Ab(s,l,f){try{var g=s.stateNode;j5(g,s.type,f,l),g[Wt]=l}catch(x){Yt(s,s.return,x)}}function zA(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Co(s.type)||s.tag===4}function Cb(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||zA(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Co(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Ib(s,l,f){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(s,l):(l=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,l.appendChild(s),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=Ji));else if(g!==4&&(g===27&&Co(s.type)&&(f=s.stateNode,l=null),s=s.child,s!==null))for(Ib(s,l,f),s=s.sibling;s!==null;)Ib(s,l,f),s=s.sibling}function Xg(s,l,f){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?f.insertBefore(s,l):f.appendChild(s);else if(g!==4&&(g===27&&Co(s.type)&&(f=s.stateNode),s=s.child,s!==null))for(Xg(s,l,f),s=s.sibling;s!==null;)Xg(s,l,f),s=s.sibling}function LA(s){var l=s.stateNode,f=s.memoizedProps;try{for(var g=s.type,x=l.attributes;x.length;)l.removeAttributeNode(x[0]);wr(l,g,f),l[ln]=s,l[Wt]=f}catch(E){Yt(s,s.return,E)}}var xs=!1,Xn=!1,Rb=!1,BA=typeof WeakSet=="function"?WeakSet:Set,mr=null;function g5(s,l){if(s=s.containerInfo,Wb=mm,s=ZS(s),wy(s)){if("selectionStart"in s)var f={start:s.selectionStart,end:s.selectionEnd};else e:{f=(f=s.ownerDocument)&&f.defaultView||window;var g=f.getSelection&&f.getSelection();if(g&&g.rangeCount!==0){f=g.anchorNode;var x=g.anchorOffset,E=g.focusNode;g=g.focusOffset;try{f.nodeType,E.nodeType}catch{f=null;break e}var N=0,F=-1,X=-1,ue=0,ve=0,be=s,he=null;t:for(;;){for(var ge;be!==f||x!==0&&be.nodeType!==3||(F=N+x),be!==E||g!==0&&be.nodeType!==3||(X=N+g),be.nodeType===3&&(N+=be.nodeValue.length),(ge=be.firstChild)!==null;)he=be,be=ge;for(;;){if(be===s)break t;if(he===f&&++ue===x&&(F=N),he===E&&++ve===g&&(X=N),(ge=be.nextSibling)!==null)break;be=he,he=be.parentNode}be=ge}f=F===-1||X===-1?null:{start:F,end:X}}else f=null}f=f||{start:0,end:0}}else f=null;for(Qb={focusedElem:s,selectionRange:f},mm=!1,mr=l;mr!==null;)if(l=mr,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,mr=s;else for(;mr!==null;){switch(l=mr,E=l.alternate,s=l.flags,l.tag){case 0:if((s&4)!==0&&(s=l.updateQueue,s=s!==null?s.events:null,s!==null))for(f=0;f<s.length;f++)x=s[f],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&E!==null){s=void 0,f=l,x=E.memoizedProps,E=E.memoizedState,g=f.stateNode;try{var ze=Gl(f.type,x);s=g.getSnapshotBeforeUpdate(ze,E),g.__reactInternalSnapshotBeforeUpdate=s}catch(We){Yt(f,f.return,We)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,f=s.nodeType,f===9)ex(s);else if(f===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":ex(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=l.sibling,s!==null){s.return=l.return,mr=s;break}mr=l.return}}function UA(s,l,f){var g=f.flags;switch(f.tag){case 0:case 11:case 15:ws(s,f),g&4&&kf(5,f);break;case 1:if(ws(s,f),g&4)if(s=f.stateNode,l===null)try{s.componentDidMount()}catch(N){Yt(f,f.return,N)}else{var x=Gl(f.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(x,l,s.__reactInternalSnapshotBeforeUpdate)}catch(N){Yt(f,f.return,N)}}g&64&&OA(f),g&512&&Nf(f,f.return);break;case 3:if(ws(s,f),g&64&&(s=f.updateQueue,s!==null)){if(l=null,f.child!==null)switch(f.child.tag){case 27:case 5:l=f.child.stateNode;break;case 1:l=f.child.stateNode}try{TT(s,l)}catch(N){Yt(f,f.return,N)}}break;case 27:l===null&&g&4&&LA(f);case 26:case 5:ws(s,f),l===null&&g&4&&VA(f),g&512&&Nf(f,f.return);break;case 12:ws(s,f);break;case 31:ws(s,f),g&4&&qA(s,f);break;case 13:ws(s,f),g&4&&HA(s,f),g&64&&(s=f.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(f=S5.bind(null,f),q5(s,f))));break;case 22:if(g=f.memoizedState!==null||xs,!g){l=l!==null&&l.memoizedState!==null||Xn,x=xs;var E=Xn;xs=g,(Xn=l)&&!E?Es(s,f,(f.subtreeFlags&8772)!==0):ws(s,f),xs=x,Xn=E}break;case 30:break;default:ws(s,f)}}function FA(s){var l=s.alternate;l!==null&&(s.alternate=null,FA(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&qc(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var bn=null,Qr=!1;function _s(s,l,f){for(f=f.child;f!==null;)GA(s,l,f),f=f.sibling}function GA(s,l,f){if(Sn&&typeof Sn.onCommitFiberUnmount=="function")try{Sn.onCommitFiberUnmount(Ir,f)}catch{}switch(f.tag){case 26:Xn||Va(f,l),_s(s,l,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:Xn||Va(f,l);var g=bn,x=Qr;Co(f.type)&&(bn=f.stateNode,Qr=!1),_s(s,l,f),Uf(f.stateNode),bn=g,Qr=x;break;case 5:Xn||Va(f,l);case 6:if(g=bn,x=Qr,bn=null,_s(s,l,f),bn=g,Qr=x,bn!==null)if(Qr)try{(bn.nodeType===9?bn.body:bn.nodeName==="HTML"?bn.ownerDocument.body:bn).removeChild(f.stateNode)}catch(E){Yt(f,l,E)}else try{bn.removeChild(f.stateNode)}catch(E){Yt(f,l,E)}break;case 18:bn!==null&&(Qr?(s=bn,OC(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,f.stateNode),Iu(s)):OC(bn,f.stateNode));break;case 4:g=bn,x=Qr,bn=f.stateNode.containerInfo,Qr=!0,_s(s,l,f),bn=g,Qr=x;break;case 0:case 11:case 14:case 15:xo(2,f,l),Xn||xo(4,f,l),_s(s,l,f);break;case 1:Xn||(Va(f,l),g=f.stateNode,typeof g.componentWillUnmount=="function"&&jA(f,l,g)),_s(s,l,f);break;case 21:_s(s,l,f);break;case 22:Xn=(g=Xn)||f.memoizedState!==null,_s(s,l,f),Xn=g;break;default:_s(s,l,f)}}function qA(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Iu(s)}catch(f){Yt(l,l.return,f)}}}function HA(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Iu(s)}catch(f){Yt(l,l.return,f)}}function m5(s){switch(s.tag){case 31:case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new BA),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new BA),l;default:throw Error(r(435,s.tag))}}function Wg(s,l){var f=m5(s);l.forEach(function(g){if(!f.has(g)){f.add(g);var x=T5.bind(null,s,g);g.then(x,x)}})}function Zr(s,l){var f=l.deletions;if(f!==null)for(var g=0;g<f.length;g++){var x=f[g],E=s,N=l,F=N;e:for(;F!==null;){switch(F.tag){case 27:if(Co(F.type)){bn=F.stateNode,Qr=!1;break e}break;case 5:bn=F.stateNode,Qr=!1;break e;case 3:case 4:bn=F.stateNode.containerInfo,Qr=!0;break e}F=F.return}if(bn===null)throw Error(r(160));GA(E,N,x),bn=null,Qr=!1,E=x.alternate,E!==null&&(E.return=null),x.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)$A(l,s),l=l.sibling}var aa=null;function $A(s,l){var f=s.alternate,g=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Zr(l,s),Jr(s),g&4&&(xo(3,s,s.return),kf(3,s),xo(5,s,s.return));break;case 1:Zr(l,s),Jr(s),g&512&&(Xn||f===null||Va(f,f.return)),g&64&&xs&&(s=s.updateQueue,s!==null&&(g=s.callbacks,g!==null&&(f=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=f===null?g:f.concat(g))));break;case 26:var x=aa;if(Zr(l,s),Jr(s),g&512&&(Xn||f===null||Va(f,f.return)),g&4){var E=f!==null?f.memoizedState:null;if(g=s.memoizedState,f===null)if(g===null)if(s.stateNode===null){e:{g=s.type,f=s.memoizedProps,x=x.ownerDocument||x;t:switch(g){case"title":E=x.getElementsByTagName("title")[0],(!E||E[Ea]||E[ln]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=x.createElement(g),x.head.insertBefore(E,x.querySelector("head > title"))),wr(E,g,f),E[ln]=s,qn(E),g=E;break e;case"link":var N=$C("link","href",x).get(g+(f.href||""));if(N){for(var F=0;F<N.length;F++)if(E=N[F],E.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&E.getAttribute("rel")===(f.rel==null?null:f.rel)&&E.getAttribute("title")===(f.title==null?null:f.title)&&E.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){N.splice(F,1);break t}}E=x.createElement(g),wr(E,g,f),x.head.appendChild(E);break;case"meta":if(N=$C("meta","content",x).get(g+(f.content||""))){for(F=0;F<N.length;F++)if(E=N[F],E.getAttribute("content")===(f.content==null?null:""+f.content)&&E.getAttribute("name")===(f.name==null?null:f.name)&&E.getAttribute("property")===(f.property==null?null:f.property)&&E.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&E.getAttribute("charset")===(f.charSet==null?null:f.charSet)){N.splice(F,1);break t}}E=x.createElement(g),wr(E,g,f),x.head.appendChild(E);break;default:throw Error(r(468,g))}E[ln]=s,qn(E),g=E}s.stateNode=g}else YC(x,s.type,s.stateNode);else s.stateNode=HC(x,g,s.memoizedProps);else E!==g?(E===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):E.count--,g===null?YC(x,s.type,s.stateNode):HC(x,g,s.memoizedProps)):g===null&&s.stateNode!==null&&Ab(s,s.memoizedProps,f.memoizedProps)}break;case 27:Zr(l,s),Jr(s),g&512&&(Xn||f===null||Va(f,f.return)),f!==null&&g&4&&Ab(s,s.memoizedProps,f.memoizedProps);break;case 5:if(Zr(l,s),Jr(s),g&512&&(Xn||f===null||Va(f,f.return)),s.flags&32){x=s.stateNode;try{Wr(x,"")}catch(ze){Yt(s,s.return,ze)}}g&4&&s.stateNode!=null&&(x=s.memoizedProps,Ab(s,x,f!==null?f.memoizedProps:x)),g&1024&&(Rb=!0);break;case 6:if(Zr(l,s),Jr(s),g&4){if(s.stateNode===null)throw Error(r(162));g=s.memoizedProps,f=s.stateNode;try{f.nodeValue=g}catch(ze){Yt(s,s.return,ze)}}break;case 3:if(fm=null,x=aa,aa=um(l.containerInfo),Zr(l,s),aa=x,Jr(s),g&4&&f!==null&&f.memoizedState.isDehydrated)try{Iu(l.containerInfo)}catch(ze){Yt(s,s.return,ze)}Rb&&(Rb=!1,YA(s));break;case 4:g=aa,aa=um(s.stateNode.containerInfo),Zr(l,s),Jr(s),aa=g;break;case 12:Zr(l,s),Jr(s);break;case 31:Zr(l,s),Jr(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Wg(s,g)));break;case 13:Zr(l,s),Jr(s),s.child.flags&8192&&s.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Zg=rt()),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Wg(s,g)));break;case 22:x=s.memoizedState!==null;var X=f!==null&&f.memoizedState!==null,ue=xs,ve=Xn;if(xs=ue||x,Xn=ve||X,Zr(l,s),Xn=ve,xs=ue,Jr(s),g&8192)e:for(l=s.stateNode,l._visibility=x?l._visibility&-2:l._visibility|1,x&&(f===null||X||xs||Xn||ql(s)),f=null,l=s;;){if(l.tag===5||l.tag===26){if(f===null){X=f=l;try{if(E=X.stateNode,x)N=E.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{F=X.stateNode;var be=X.memoizedProps.style,he=be!=null&&be.hasOwnProperty("display")?be.display:null;F.style.display=he==null||typeof he=="boolean"?"":(""+he).trim()}}catch(ze){Yt(X,X.return,ze)}}}else if(l.tag===6){if(f===null){X=l;try{X.stateNode.nodeValue=x?"":X.memoizedProps}catch(ze){Yt(X,X.return,ze)}}}else if(l.tag===18){if(f===null){X=l;try{var ge=X.stateNode;x?jC(ge,!0):jC(X.stateNode,!1)}catch(ze){Yt(X,X.return,ze)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;f===l&&(f=null),l=l.return}f===l&&(f=null),l.sibling.return=l.return,l=l.sibling}g&4&&(g=s.updateQueue,g!==null&&(f=g.retryQueue,f!==null&&(g.retryQueue=null,Wg(s,f))));break;case 19:Zr(l,s),Jr(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Wg(s,g)));break;case 30:break;case 21:break;default:Zr(l,s),Jr(s)}}function Jr(s){var l=s.flags;if(l&2){try{for(var f,g=s.return;g!==null;){if(zA(g)){f=g;break}g=g.return}if(f==null)throw Error(r(160));switch(f.tag){case 27:var x=f.stateNode,E=Cb(s);Xg(s,E,x);break;case 5:var N=f.stateNode;f.flags&32&&(Wr(N,""),f.flags&=-33);var F=Cb(s);Xg(s,F,N);break;case 3:case 4:var X=f.stateNode.containerInfo,ue=Cb(s);Ib(s,ue,X);break;default:throw Error(r(161))}}catch(ve){Yt(s,s.return,ve)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function YA(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;YA(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function ws(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)UA(s,l.alternate,l),l=l.sibling}function ql(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:xo(4,l,l.return),ql(l);break;case 1:Va(l,l.return);var f=l.stateNode;typeof f.componentWillUnmount=="function"&&jA(l,l.return,f),ql(l);break;case 27:Uf(l.stateNode);case 26:case 5:Va(l,l.return),ql(l);break;case 22:l.memoizedState===null&&ql(l);break;case 30:ql(l);break;default:ql(l)}s=s.sibling}}function Es(s,l,f){for(f=f&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var g=l.alternate,x=s,E=l,N=E.flags;switch(E.tag){case 0:case 11:case 15:Es(x,E,f),kf(4,E);break;case 1:if(Es(x,E,f),g=E,x=g.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(ue){Yt(g,g.return,ue)}if(g=E,x=g.updateQueue,x!==null){var F=g.stateNode;try{var X=x.shared.hiddenCallbacks;if(X!==null)for(x.shared.hiddenCallbacks=null,x=0;x<X.length;x++)ST(X[x],F)}catch(ue){Yt(g,g.return,ue)}}f&&N&64&&OA(E),Nf(E,E.return);break;case 27:LA(E);case 26:case 5:Es(x,E,f),f&&g===null&&N&4&&VA(E),Nf(E,E.return);break;case 12:Es(x,E,f);break;case 31:Es(x,E,f),f&&N&4&&qA(x,E);break;case 13:Es(x,E,f),f&&N&4&&HA(x,E);break;case 22:E.memoizedState===null&&Es(x,E,f),Nf(E,E.return);break;case 30:break;default:Es(x,E,f)}l=l.sibling}}function Db(s,l){var f=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==f&&(s!=null&&s.refCount++,f!=null&&yf(f))}function kb(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&yf(s))}function sa(s,l,f,g){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)KA(s,l,f,g),l=l.sibling}function KA(s,l,f,g){var x=l.flags;switch(l.tag){case 0:case 11:case 15:sa(s,l,f,g),x&2048&&kf(9,l);break;case 1:sa(s,l,f,g);break;case 3:sa(s,l,f,g),x&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&yf(s)));break;case 12:if(x&2048){sa(s,l,f,g),s=l.stateNode;try{var E=l.memoizedProps,N=E.id,F=E.onPostCommit;typeof F=="function"&&F(N,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(X){Yt(l,l.return,X)}}else sa(s,l,f,g);break;case 31:sa(s,l,f,g);break;case 13:sa(s,l,f,g);break;case 23:break;case 22:E=l.stateNode,N=l.alternate,l.memoizedState!==null?E._visibility&2?sa(s,l,f,g):Mf(s,l):E._visibility&2?sa(s,l,f,g):(E._visibility|=2,vu(s,l,f,g,(l.subtreeFlags&10256)!==0||!1)),x&2048&&Db(N,l);break;case 24:sa(s,l,f,g),x&2048&&kb(l.alternate,l);break;default:sa(s,l,f,g)}}function vu(s,l,f,g,x){for(x=x&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var E=s,N=l,F=f,X=g,ue=N.flags;switch(N.tag){case 0:case 11:case 15:vu(E,N,F,X,x),kf(8,N);break;case 23:break;case 22:var ve=N.stateNode;N.memoizedState!==null?ve._visibility&2?vu(E,N,F,X,x):Mf(E,N):(ve._visibility|=2,vu(E,N,F,X,x)),x&&ue&2048&&Db(N.alternate,N);break;case 24:vu(E,N,F,X,x),x&&ue&2048&&kb(N.alternate,N);break;default:vu(E,N,F,X,x)}l=l.sibling}}function Mf(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var f=s,g=l,x=g.flags;switch(g.tag){case 22:Mf(f,g),x&2048&&Db(g.alternate,g);break;case 24:Mf(f,g),x&2048&&kb(g.alternate,g);break;default:Mf(f,g)}l=l.sibling}}var Pf=8192;function yu(s,l,f){if(s.subtreeFlags&Pf)for(s=s.child;s!==null;)XA(s,l,f),s=s.sibling}function XA(s,l,f){switch(s.tag){case 26:yu(s,l,f),s.flags&Pf&&s.memoizedState!==null&&n6(f,aa,s.memoizedState,s.memoizedProps);break;case 5:yu(s,l,f);break;case 3:case 4:var g=aa;aa=um(s.stateNode.containerInfo),yu(s,l,f),aa=g;break;case 22:s.memoizedState===null&&(g=s.alternate,g!==null&&g.memoizedState!==null?(g=Pf,Pf=16777216,yu(s,l,f),Pf=g):yu(s,l,f));break;default:yu(s,l,f)}}function WA(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function Of(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];mr=g,ZA(g,s)}WA(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)QA(s),s=s.sibling}function QA(s){switch(s.tag){case 0:case 11:case 15:Of(s),s.flags&2048&&xo(9,s,s.return);break;case 3:Of(s);break;case 12:Of(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,Qg(s)):Of(s);break;default:Of(s)}}function Qg(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];mr=g,ZA(g,s)}WA(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:xo(8,l,l.return),Qg(l);break;case 22:f=l.stateNode,f._visibility&2&&(f._visibility&=-3,Qg(l));break;default:Qg(l)}s=s.sibling}}function ZA(s,l){for(;mr!==null;){var f=mr;switch(f.tag){case 0:case 11:case 15:xo(8,f,l);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var g=f.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:yf(f.memoizedState.cache)}if(g=f.child,g!==null)g.return=f,mr=g;else e:for(f=s;mr!==null;){g=mr;var x=g.sibling,E=g.return;if(FA(g),g===f){mr=null;break e}if(x!==null){x.return=E,mr=x;break e}mr=E}}}var v5={getCacheForType:function(s){var l=xr($n),f=l.data.get(s);return f===void 0&&(f=s(),l.data.set(s,f)),f},cacheSignal:function(){return xr($n).controller.signal}},y5=typeof WeakMap=="function"?WeakMap:Map,Bt=0,sn=null,_t=null,St=0,$t=0,yi=null,_o=!1,bu=!1,Nb=!1,Ss=0,Dn=0,wo=0,Hl=0,Mb=0,bi=0,xu=0,jf=null,ei=null,Pb=!1,Zg=0,JA=0,Jg=1/0,em=null,Eo=null,sr=0,So=null,_u=null,Ts=0,Ob=0,jb=null,eC=null,Vf=0,Vb=null;function xi(){return(Bt&2)!==0&&St!==0?St&-St:H.T!==null?Gb():Et()}function tC(){if(bi===0)if((St&536870912)===0||It){var s=un;un<<=1,(un&3932160)===0&&(un=262144),bi=s}else bi=536870912;return s=mi.current,s!==null&&(s.flags|=32),bi}function ti(s,l,f){(s===sn&&($t===2||$t===9)||s.cancelPendingCommit!==null)&&(wu(s,0),To(s,St,bi,!1)),ir(s,f),((Bt&2)===0||s!==sn)&&(s===sn&&((Bt&2)===0&&(Hl|=f),Dn===4&&To(s,St,bi,!1)),za(s))}function nC(s,l,f){if((Bt&6)!==0)throw Error(r(327));var g=!f&&(l&127)===0&&(l&s.expiredLanes)===0||qt(s,l),x=g?_5(s,l):Lb(s,l,!0),E=g;do{if(x===0){bu&&!g&&To(s,l,0,!1);break}else{if(f=s.current.alternate,E&&!b5(f)){x=Lb(s,l,!1),E=!1;continue}if(x===2){if(E=l,s.errorRecoveryDisabledLanes&E)var N=0;else N=s.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){l=N;e:{var F=s;x=jf;var X=F.current.memoizedState.isDehydrated;if(X&&(wu(F,N).flags|=256),N=Lb(F,N,!1),N!==2){if(Nb&&!X){F.errorRecoveryDisabledLanes|=E,Hl|=E,x=4;break e}E=ei,ei=x,E!==null&&(ei===null?ei=E:ei.push.apply(ei,E))}x=N}if(E=!1,x!==2)continue}}if(x===1){wu(s,0),To(s,l,0,!0);break}e:{switch(g=s,E=x,E){case 0:case 1:throw Error(r(345));case 4:if((l&4194048)!==l)break;case 6:To(g,l,bi,!_o);break e;case 2:ei=null;break;case 3:case 5:break;default:throw Error(r(329))}if((l&62914560)===l&&(x=Zg+300-rt(),10<x)){if(To(g,l,bi,!_o),ut(g,0,!0)!==0)break e;Ts=l,g.timeoutHandle=MC(rC.bind(null,g,f,ei,em,Pb,l,bi,Hl,xu,_o,E,"Throttled",-0,0),x);break e}rC(g,f,ei,em,Pb,l,bi,Hl,xu,_o,E,null,-0,0)}}break}while(!0);za(s)}function rC(s,l,f,g,x,E,N,F,X,ue,ve,be,he,ge){if(s.timeoutHandle=-1,be=l.subtreeFlags,be&8192||(be&16785408)===16785408){be={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ji},XA(l,E,be);var ze=(E&62914560)===E?Zg-rt():(E&4194048)===E?JA-rt():0;if(ze=r6(be,ze),ze!==null){Ts=E,s.cancelPendingCommit=ze(dC.bind(null,s,l,E,f,g,x,N,F,X,ve,be,null,he,ge)),To(s,E,N,!ue);return}}dC(s,l,E,f,g,x,N,F,X)}function b5(s){for(var l=s;;){var f=l.tag;if((f===0||f===11||f===15)&&l.flags&16384&&(f=l.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var g=0;g<f.length;g++){var x=f[g],E=x.getSnapshot;x=x.value;try{if(!pi(E(),x))return!1}catch{return!1}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function To(s,l,f,g){l&=~Mb,l&=~Hl,s.suspendedLanes|=l,s.pingedLanes&=~l,g&&(s.warmLanes|=l),g=s.expirationTimes;for(var x=l;0<x;){var E=31-cn(x),N=1<<E;g[E]=-1,x&=~N}f!==0&&Dt(s,f,l)}function tm(){return(Bt&6)===0?(zf(0),!1):!0}function zb(){if(_t!==null){if($t===0)var s=_t.return;else s=_t,ps=jl=null,eb(s),fu=null,xf=0,s=_t;for(;s!==null;)PA(s.alternate,s),s=s.return;_t=null}}function wu(s,l){var f=s.timeoutHandle;f!==-1&&(s.timeoutHandle=-1,L5(f)),f=s.cancelPendingCommit,f!==null&&(s.cancelPendingCommit=null,f()),Ts=0,zb(),sn=s,_t=f=fs(s.current,null),St=l,$t=0,yi=null,_o=!1,bu=qt(s,l),Nb=!1,xu=bi=Mb=Hl=wo=Dn=0,ei=jf=null,Pb=!1,(l&8)!==0&&(l|=l&32);var g=s.entangledLanes;if(g!==0)for(s=s.entanglements,g&=l;0<g;){var x=31-cn(g),E=1<<x;l|=s[x],g&=~E}return Ss=l,wg(),f}function iC(s,l){ft=null,H.H=If,l===du||l===Dg?(l=xT(),$t=3):l===Fy?(l=xT(),$t=4):$t=l===mb?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,yi=l,_t===null&&(Dn=1,qg(s,Di(l,s.current)))}function aC(){var s=mi.current;return s===null?!0:(St&4194048)===St?Pi===null:(St&62914560)===St||(St&536870912)!==0?s===Pi:!1}function sC(){var s=H.H;return H.H=If,s===null?If:s}function oC(){var s=H.A;return H.A=v5,s}function nm(){Dn=4,_o||(St&4194048)!==St&&mi.current!==null||(bu=!0),(wo&134217727)===0&&(Hl&134217727)===0||sn===null||To(sn,St,bi,!1)}function Lb(s,l,f){var g=Bt;Bt|=2;var x=sC(),E=oC();(sn!==s||St!==l)&&(em=null,wu(s,l)),l=!1;var N=Dn;e:do try{if($t!==0&&_t!==null){var F=_t,X=yi;switch($t){case 8:zb(),N=6;break e;case 3:case 2:case 9:case 6:mi.current===null&&(l=!0);var ue=$t;if($t=0,yi=null,Eu(s,F,X,ue),f&&bu){N=0;break e}break;default:ue=$t,$t=0,yi=null,Eu(s,F,X,ue)}}x5(),N=Dn;break}catch(ve){iC(s,ve)}while(!0);return l&&s.shellSuspendCounter++,ps=jl=null,Bt=g,H.H=x,H.A=E,_t===null&&(sn=null,St=0,wg()),N}function x5(){for(;_t!==null;)lC(_t)}function _5(s,l){var f=Bt;Bt|=2;var g=sC(),x=oC();sn!==s||St!==l?(em=null,Jg=rt()+500,wu(s,l)):bu=qt(s,l);e:do try{if($t!==0&&_t!==null){l=_t;var E=yi;t:switch($t){case 1:$t=0,yi=null,Eu(s,l,E,1);break;case 2:case 9:if(yT(E)){$t=0,yi=null,cC(l);break}l=function(){$t!==2&&$t!==9||sn!==s||($t=7),za(s)},E.then(l,l);break e;case 3:$t=7;break e;case 4:$t=5;break e;case 7:yT(E)?($t=0,yi=null,cC(l)):($t=0,yi=null,Eu(s,l,E,7));break;case 5:var N=null;switch(_t.tag){case 26:N=_t.memoizedState;case 5:case 27:var F=_t;if(N?KC(N):F.stateNode.complete){$t=0,yi=null;var X=F.sibling;if(X!==null)_t=X;else{var ue=F.return;ue!==null?(_t=ue,rm(ue)):_t=null}break t}}$t=0,yi=null,Eu(s,l,E,5);break;case 6:$t=0,yi=null,Eu(s,l,E,6);break;case 8:zb(),Dn=6;break e;default:throw Error(r(462))}}w5();break}catch(ve){iC(s,ve)}while(!0);return ps=jl=null,H.H=g,H.A=x,Bt=f,_t!==null?0:(sn=null,St=0,wg(),Dn)}function w5(){for(;_t!==null&&!et();)lC(_t)}function lC(s){var l=NA(s.alternate,s,Ss);s.memoizedProps=s.pendingProps,l===null?rm(s):_t=l}function cC(s){var l=s,f=l.alternate;switch(l.tag){case 15:case 0:l=AA(f,l,l.pendingProps,l.type,void 0,St);break;case 11:l=AA(f,l,l.pendingProps,l.type.render,l.ref,St);break;case 5:eb(l);default:PA(f,l),l=_t=oT(l,Ss),l=NA(f,l,Ss)}s.memoizedProps=s.pendingProps,l===null?rm(s):_t=l}function Eu(s,l,f,g){ps=jl=null,eb(l),fu=null,xf=0;var x=l.return;try{if(u5(s,x,l,f,St)){Dn=1,qg(s,Di(f,s.current)),_t=null;return}}catch(E){if(x!==null)throw _t=x,E;Dn=1,qg(s,Di(f,s.current)),_t=null;return}l.flags&32768?(It||g===1?s=!0:bu||(St&536870912)!==0?s=!1:(_o=s=!0,(g===2||g===9||g===3||g===6)&&(g=mi.current,g!==null&&g.tag===13&&(g.flags|=16384))),uC(l,s)):rm(l)}function rm(s){var l=s;do{if((l.flags&32768)!==0){uC(l,_o);return}s=l.return;var f=h5(l.alternate,l,Ss);if(f!==null){_t=f;return}if(l=l.sibling,l!==null){_t=l;return}_t=l=s}while(l!==null);Dn===0&&(Dn=5)}function uC(s,l){do{var f=p5(s.alternate,s);if(f!==null){f.flags&=32767,_t=f;return}if(f=s.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!l&&(s=s.sibling,s!==null)){_t=s;return}_t=s=f}while(s!==null);Dn=6,_t=null}function dC(s,l,f,g,x,E,N,F,X){s.cancelPendingCommit=null;do im();while(sr!==0);if((Bt&6)!==0)throw Error(r(327));if(l!==null){if(l===s.current)throw Error(r(177));if(E=l.lanes|l.childLanes,E|=Cy,ar(s,f,E,N,F,X),s===sn&&(_t=sn=null,St=0),_u=l,So=s,Ts=f,Ob=E,jb=x,eC=g,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,A5(jn,function(){return mC(),null})):(s.callbackNode=null,s.callbackPriority=0),g=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||g){g=H.T,H.T=null,x=W.p,W.p=2,N=Bt,Bt|=4;try{g5(s,l,f)}finally{Bt=N,W.p=x,H.T=g}}sr=1,fC(),hC(),pC()}}function fC(){if(sr===1){sr=0;var s=So,l=_u,f=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||f){f=H.T,H.T=null;var g=W.p;W.p=2;var x=Bt;Bt|=4;try{$A(l,s);var E=Qb,N=ZS(s.containerInfo),F=E.focusedElem,X=E.selectionRange;if(N!==F&&F&&F.ownerDocument&&QS(F.ownerDocument.documentElement,F)){if(X!==null&&wy(F)){var ue=X.start,ve=X.end;if(ve===void 0&&(ve=ue),"selectionStart"in F)F.selectionStart=ue,F.selectionEnd=Math.min(ve,F.value.length);else{var be=F.ownerDocument||document,he=be&&be.defaultView||window;if(he.getSelection){var ge=he.getSelection(),ze=F.textContent.length,We=Math.min(X.start,ze),en=X.end===void 0?We:Math.min(X.end,ze);!ge.extend&&We>en&&(N=en,en=We,We=N);var ie=WS(F,We),re=WS(F,en);if(ie&&re&&(ge.rangeCount!==1||ge.anchorNode!==ie.node||ge.anchorOffset!==ie.offset||ge.focusNode!==re.node||ge.focusOffset!==re.offset)){var ce=be.createRange();ce.setStart(ie.node,ie.offset),ge.removeAllRanges(),We>en?(ge.addRange(ce),ge.extend(re.node,re.offset)):(ce.setEnd(re.node,re.offset),ge.addRange(ce))}}}}for(be=[],ge=F;ge=ge.parentNode;)ge.nodeType===1&&be.push({element:ge,left:ge.scrollLeft,top:ge.scrollTop});for(typeof F.focus=="function"&&F.focus(),F=0;F<be.length;F++){var ye=be[F];ye.element.scrollLeft=ye.left,ye.element.scrollTop=ye.top}}mm=!!Wb,Qb=Wb=null}finally{Bt=x,W.p=g,H.T=f}}s.current=l,sr=2}}function hC(){if(sr===2){sr=0;var s=So,l=_u,f=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||f){f=H.T,H.T=null;var g=W.p;W.p=2;var x=Bt;Bt|=4;try{UA(s,l.alternate,l)}finally{Bt=x,W.p=g,H.T=f}}sr=3}}function pC(){if(sr===4||sr===3){sr=0,Ot();var s=So,l=_u,f=Ts,g=eC;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?sr=5:(sr=0,_u=So=null,gC(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(Eo=null),an(f),l=l.stateNode,Sn&&typeof Sn.onCommitFiberRoot=="function")try{Sn.onCommitFiberRoot(Ir,l,void 0,(l.current.flags&128)===128)}catch{}if(g!==null){l=H.T,x=W.p,W.p=2,H.T=null;try{for(var E=s.onRecoverableError,N=0;N<g.length;N++){var F=g[N];E(F.value,{componentStack:F.stack})}}finally{H.T=l,W.p=x}}(Ts&3)!==0&&im(),za(s),x=s.pendingLanes,(f&261930)!==0&&(x&42)!==0?s===Vb?Vf++:(Vf=0,Vb=s):Vf=0,zf(0)}}function gC(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,yf(l)))}function im(){return fC(),hC(),pC(),mC()}function mC(){if(sr!==5)return!1;var s=So,l=Ob;Ob=0;var f=an(Ts),g=H.T,x=W.p;try{W.p=32>f?32:f,H.T=null,f=jb,jb=null;var E=So,N=Ts;if(sr=0,_u=So=null,Ts=0,(Bt&6)!==0)throw Error(r(331));var F=Bt;if(Bt|=4,QA(E.current),KA(E,E.current,N,f),Bt=F,zf(0,!1),Sn&&typeof Sn.onPostCommitFiberRoot=="function")try{Sn.onPostCommitFiberRoot(Ir,E)}catch{}return!0}finally{W.p=x,H.T=g,gC(s,l)}}function vC(s,l,f){l=Di(f,l),l=gb(s.stateNode,l,2),s=vo(s,l,2),s!==null&&(ir(s,2),za(s))}function Yt(s,l,f){if(s.tag===3)vC(s,s,f);else for(;l!==null;){if(l.tag===3){vC(l,s,f);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Eo===null||!Eo.has(g))){s=Di(f,s),f=yA(2),g=vo(l,f,2),g!==null&&(bA(f,g,l,s),ir(g,2),za(g));break}}l=l.return}}function Bb(s,l,f){var g=s.pingCache;if(g===null){g=s.pingCache=new y5;var x=new Set;g.set(l,x)}else x=g.get(l),x===void 0&&(x=new Set,g.set(l,x));x.has(f)||(Nb=!0,x.add(f),s=E5.bind(null,s,l,f),l.then(s,s))}function E5(s,l,f){var g=s.pingCache;g!==null&&g.delete(l),s.pingedLanes|=s.suspendedLanes&f,s.warmLanes&=~f,sn===s&&(St&f)===f&&(Dn===4||Dn===3&&(St&62914560)===St&&300>rt()-Zg?(Bt&2)===0&&wu(s,0):Mb|=f,xu===St&&(xu=0)),za(s)}function yC(s,l){l===0&&(l=Rr()),s=Ml(s,l),s!==null&&(ir(s,l),za(s))}function S5(s){var l=s.memoizedState,f=0;l!==null&&(f=l.retryLane),yC(s,f)}function T5(s,l){var f=0;switch(s.tag){case 31:case 13:var g=s.stateNode,x=s.memoizedState;x!==null&&(f=x.retryLane);break;case 19:g=s.stateNode;break;case 22:g=s.stateNode._retryCache;break;default:throw Error(r(314))}g!==null&&g.delete(l),yC(s,f)}function A5(s,l){return Oe(s,l)}var am=null,Su=null,Ub=!1,sm=!1,Fb=!1,Ao=0;function za(s){s!==Su&&s.next===null&&(Su===null?am=Su=s:Su=Su.next=s),sm=!0,Ub||(Ub=!0,I5())}function zf(s,l){if(!Fb&&sm){Fb=!0;do for(var f=!1,g=am;g!==null;){if(s!==0){var x=g.pendingLanes;if(x===0)var E=0;else{var N=g.suspendedLanes,F=g.pingedLanes;E=(1<<31-cn(42|s)+1)-1,E&=x&~(N&~F),E=E&201326741?E&201326741|1:E?E|2:0}E!==0&&(f=!0,wC(g,E))}else E=St,E=ut(g,g===sn?E:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(E&3)===0||qt(g,E)||(f=!0,wC(g,E));g=g.next}while(f);Fb=!1}}function C5(){bC()}function bC(){sm=Ub=!1;var s=0;Ao!==0&&z5()&&(s=Ao);for(var l=rt(),f=null,g=am;g!==null;){var x=g.next,E=xC(g,l);E===0?(g.next=null,f===null?am=x:f.next=x,x===null&&(Su=f)):(f=g,(s!==0||(E&3)!==0)&&(sm=!0)),g=x}sr!==0&&sr!==5||zf(s),Ao!==0&&(Ao=0)}function xC(s,l){for(var f=s.suspendedLanes,g=s.pingedLanes,x=s.expirationTimes,E=s.pendingLanes&-62914561;0<E;){var N=31-cn(E),F=1<<N,X=x[N];X===-1?((F&f)===0||(F&g)!==0)&&(x[N]=bt(F,l)):X<=l&&(s.expiredLanes|=F),E&=~F}if(l=sn,f=St,f=ut(s,s===l?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g=s.callbackNode,f===0||s===l&&($t===2||$t===9)||s.cancelPendingCommit!==null)return g!==null&&g!==null&&ct(g),s.callbackNode=null,s.callbackPriority=0;if((f&3)===0||qt(s,f)){if(l=f&-f,l===s.callbackPriority)return l;switch(g!==null&&ct(g),an(f)){case 2:case 8:f=Ft;break;case 32:f=jn;break;case 268435456:f=ls;break;default:f=jn}return g=_C.bind(null,s),f=Oe(f,g),s.callbackPriority=l,s.callbackNode=f,l}return g!==null&&g!==null&&ct(g),s.callbackPriority=2,s.callbackNode=null,2}function _C(s,l){if(sr!==0&&sr!==5)return s.callbackNode=null,s.callbackPriority=0,null;var f=s.callbackNode;if(im()&&s.callbackNode!==f)return null;var g=St;return g=ut(s,s===sn?g:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g===0?null:(nC(s,g,l),xC(s,rt()),s.callbackNode!=null&&s.callbackNode===f?_C.bind(null,s):null)}function wC(s,l){if(im())return null;nC(s,l,!0)}function I5(){B5(function(){(Bt&6)!==0?Oe(jt,C5):bC()})}function Gb(){if(Ao===0){var s=cu;s===0&&(s=yt,yt<<=1,(yt&261888)===0&&(yt=256)),Ao=s}return Ao}function EC(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Kc(""+s)}function SC(s,l){var f=l.ownerDocument.createElement("input");return f.name=l.name,f.value=l.value,s.id&&f.setAttribute("form",s.id),l.parentNode.insertBefore(f,l),s=new FormData(s),f.parentNode.removeChild(f),s}function R5(s,l,f,g,x){if(l==="submit"&&f&&f.stateNode===x){var E=EC((x[Wt]||null).action),N=g.submitter;N&&(l=(l=N[Wt]||null)?EC(l.formAction):N.getAttribute("formAction"),l!==null&&(E=l,N=null));var F=new ka("action","action",null,g,x);s.push({event:F,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(Ao!==0){var X=N?SC(x,N):new FormData(x);cb(f,{pending:!0,data:X,method:x.method,action:E},null,X)}}else typeof E=="function"&&(F.preventDefault(),X=N?SC(x,N):new FormData(x),cb(f,{pending:!0,data:X,method:x.method,action:E},E,X))},currentTarget:x}]})}}for(var qb=0;qb<Ay.length;qb++){var Hb=Ay[qb],D5=Hb.toLowerCase(),k5=Hb[0].toUpperCase()+Hb.slice(1);ia(D5,"on"+k5)}ia(tT,"onAnimationEnd"),ia(nT,"onAnimationIteration"),ia(rT,"onAnimationStart"),ia("dblclick","onDoubleClick"),ia("focusin","onFocus"),ia("focusout","onBlur"),ia(YV,"onTransitionRun"),ia(KV,"onTransitionStart"),ia(XV,"onTransitionCancel"),ia(iT,"onTransitionEnd"),Ca("onMouseEnter",["mouseout","mouseover"]),Ca("onMouseLeave",["mouseout","mouseover"]),Ca("onPointerEnter",["pointerout","pointerover"]),Ca("onPointerLeave",["pointerout","pointerover"]),Aa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Aa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Aa("onBeforeInput",["compositionend","keypress","textInput","paste"]),Aa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Aa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Aa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),N5=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Lf));function TC(s,l){l=(l&4)!==0;for(var f=0;f<s.length;f++){var g=s[f],x=g.event;g=g.listeners;e:{var E=void 0;if(l)for(var N=g.length-1;0<=N;N--){var F=g[N],X=F.instance,ue=F.currentTarget;if(F=F.listener,X!==E&&x.isPropagationStopped())break e;E=F,x.currentTarget=ue;try{E(x)}catch(ve){_g(ve)}x.currentTarget=null,E=X}else for(N=0;N<g.length;N++){if(F=g[N],X=F.instance,ue=F.currentTarget,F=F.listener,X!==E&&x.isPropagationStopped())break e;E=F,x.currentTarget=ue;try{E(x)}catch(ve){_g(ve)}x.currentTarget=null,E=X}}}}function wt(s,l){var f=l[Dr];f===void 0&&(f=l[Dr]=new Set);var g=s+"__bubble";f.has(g)||(AC(l,s,2,!1),f.add(g))}function $b(s,l,f){var g=0;l&&(g|=4),AC(f,s,g,l)}var om="_reactListening"+Math.random().toString(36).slice(2);function Yb(s){if(!s[om]){s[om]=!0,Wd.forEach(function(f){f!=="selectionchange"&&(N5.has(f)||$b(f,!1,s),$b(f,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[om]||(l[om]=!0,$b("selectionchange",!1,l))}}function AC(s,l,f,g){switch(t2(l)){case 2:var x=s6;break;case 8:x=o6;break;default:x=lx}f=x.bind(null,l,f,s),x=void 0,!Tl||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(x=!0),g?x!==void 0?s.addEventListener(l,f,{capture:!0,passive:x}):s.addEventListener(l,f,!0):x!==void 0?s.addEventListener(l,f,{passive:x}):s.addEventListener(l,f,!1)}function Kb(s,l,f,g,x){var E=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var N=g.tag;if(N===3||N===4){var F=g.stateNode.containerInfo;if(F===x)break;if(N===4)for(N=g.return;N!==null;){var X=N.tag;if((X===3||X===4)&&N.stateNode.containerInfo===x)return;N=N.return}for(;F!==null;){if(N=Sa(F),N===null)return;if(X=N.tag,X===5||X===6||X===26||X===27){g=E=N;continue e}F=F.parentNode}}g=g.return}so(function(){var ue=E,ve=Ai(f),be=[];e:{var he=aT.get(s);if(he!==void 0){var ge=ka,ze=s;switch(s){case"keypress":if(Cl(f)===0)break e;case"keydown":case"keyup":ge=yg;break;case"focusin":ze="focus",ge=Rl;break;case"focusout":ze="blur",ge=Rl;break;case"beforeblur":case"afterblur":ge=Rl;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=uf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=cg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=R;break;case tT:case nT:case rT:ge=dg;break;case iT:ge=q;break;case"scroll":case"scrollend":ge=cf;break;case"wheel":ge=pe;break;case"copy":case"cut":case"paste":ge=fg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=ds;break;case"toggle":case"beforetoggle":ge=dt}var We=(l&4)!==0,en=!We&&(s==="scroll"||s==="scrollend"),ie=We?he!==null?he+"Capture":null:he;We=[];for(var re=ue,ce;re!==null;){var ye=re;if(ce=ye.stateNode,ye=ye.tag,ye!==5&&ye!==26&&ye!==27||ce===null||ie===null||(ye=ea(re,ie),ye!=null&&We.push(Bf(re,ye,ce))),en)break;re=re.return}0<We.length&&(he=new ge(he,ze,null,f,ve),be.push({event:he,listeners:We}))}}if((l&7)===0){e:{if(he=s==="mouseover"||s==="pointerover",ge=s==="mouseout"||s==="pointerout",he&&f!==sf&&(ze=f.relatedTarget||f.fromElement)&&(Sa(ze)||ze[pr]))break e;if((ge||he)&&(he=ve.window===ve?ve:(he=ve.ownerDocument)?he.defaultView||he.parentWindow:window,ge?(ze=f.relatedTarget||f.toElement,ge=ue,ze=ze?Sa(ze):null,ze!==null&&(en=a(ze),We=ze.tag,ze!==en||We!==5&&We!==27&&We!==6)&&(ze=null)):(ge=null,ze=ue),ge!==ze)){if(We=uf,ye="onMouseLeave",ie="onMouseEnter",re="mouse",(s==="pointerout"||s==="pointerover")&&(We=ds,ye="onPointerLeave",ie="onPointerEnter",re="pointer"),en=ge==null?he:fi(ge),ce=ze==null?he:fi(ze),he=new We(ye,re+"leave",ge,f,ve),he.target=en,he.relatedTarget=ce,ye=null,Sa(ve)===ue&&(We=new We(ie,re+"enter",ze,f,ve),We.target=ce,We.relatedTarget=en,ye=We),en=ye,ge&&ze)t:{for(We=M5,ie=ge,re=ze,ce=0,ye=ie;ye;ye=We(ye))ce++;ye=0;for(var $e=re;$e;$e=We($e))ye++;for(;0<ce-ye;)ie=We(ie),ce--;for(;0<ye-ce;)re=We(re),ye--;for(;ce--;){if(ie===re||re!==null&&ie===re.alternate){We=ie;break t}ie=We(ie),re=We(re)}We=null}else We=null;ge!==null&&CC(be,he,ge,We,!1),ze!==null&&en!==null&&CC(be,en,ze,We,!0)}}e:{if(he=ue?fi(ue):window,ge=he.nodeName&&he.nodeName.toLowerCase(),ge==="select"||ge==="input"&&he.type==="file")var Mt=qS;else if(FS(he))if(HS)Mt=qV;else{Mt=FV;var Ue=UV}else ge=he.nodeName,!ge||ge.toLowerCase()!=="input"||he.type!=="checkbox"&&he.type!=="radio"?ue&&Yc(ue.elementType)&&(Mt=qS):Mt=GV;if(Mt&&(Mt=Mt(s,ue))){GS(be,Mt,f,ve);break e}Ue&&Ue(s,he,ue),s==="focusout"&&ue&&he.type==="number"&&ue.memoizedProps.value!=null&&nf(he,"number",he.value)}switch(Ue=ue?fi(ue):window,s){case"focusin":(FS(Ue)||Ue.contentEditable==="true")&&(tu=Ue,Ey=ue,gf=null);break;case"focusout":gf=Ey=tu=null;break;case"mousedown":Sy=!0;break;case"contextmenu":case"mouseup":case"dragend":Sy=!1,JS(be,f,ve);break;case"selectionchange":if($V)break;case"keydown":case"keyup":JS(be,f,ve)}var gt;if(Lt)e:{switch(s){case"compositionstart":var Tt="onCompositionStart";break e;case"compositionend":Tt="onCompositionEnd";break e;case"compositionupdate":Tt="onCompositionUpdate";break e}Tt=void 0}else eu?Dl(s,f)&&(Tt="onCompositionEnd"):s==="keydown"&&f.keyCode===229&&(Tt="onCompositionStart");Tt&&(Pa&&f.locale!=="ko"&&(eu||Tt!=="onCompositionStart"?Tt==="onCompositionEnd"&&eu&&(gt=lf()):(Da=ve,of="value"in Da?Da.value:Da.textContent,eu=!0)),Ue=lm(ue,Tt),0<Ue.length&&(Tt=new Ma(Tt,s,null,f,ve),be.push({event:Tt,listeners:Ue}),gt?Tt.data=gt:(gt=Jc(f),gt!==null&&(Tt.data=gt)))),(gt=Ii?VV(s,f):zV(s,f))&&(Tt=lm(ue,"onBeforeInput"),0<Tt.length&&(Ue=new Ma("onBeforeInput","beforeinput",null,f,ve),be.push({event:Ue,listeners:Tt}),Ue.data=gt)),R5(be,s,ue,f,ve)}TC(be,l)})}function Bf(s,l,f){return{instance:s,listener:l,currentTarget:f}}function lm(s,l){for(var f=l+"Capture",g=[];s!==null;){var x=s,E=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||E===null||(x=ea(s,f),x!=null&&g.unshift(Bf(s,x,E)),x=ea(s,l),x!=null&&g.push(Bf(s,x,E))),s.tag===3)return g;s=s.return}return[]}function M5(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function CC(s,l,f,g,x){for(var E=l._reactName,N=[];f!==null&&f!==g;){var F=f,X=F.alternate,ue=F.stateNode;if(F=F.tag,X!==null&&X===g)break;F!==5&&F!==26&&F!==27||ue===null||(X=ue,x?(ue=ea(f,E),ue!=null&&N.unshift(Bf(f,ue,X))):x||(ue=ea(f,E),ue!=null&&N.push(Bf(f,ue,X)))),f=f.return}N.length!==0&&s.push({event:l,listeners:N})}var P5=/\r\n?/g,O5=/\u0000|\uFFFD/g;function IC(s){return(typeof s=="string"?s:""+s).replace(P5,`
`).replace(O5,"")}function RC(s,l){return l=IC(l),IC(s)===l}function Jt(s,l,f,g,x,E){switch(f){case"children":typeof g=="string"?l==="body"||l==="textarea"&&g===""||Wr(s,g):(typeof g=="number"||typeof g=="bigint")&&l!=="body"&&Wr(s,""+g);break;case"className":hi(s,"class",g);break;case"tabIndex":hi(s,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":hi(s,f,g);break;case"style":af(s,g,E);break;case"data":if(l!=="object"){hi(s,"data",g);break}case"src":case"href":if(g===""&&(l!=="a"||f!=="href")){s.removeAttribute(f);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(f);break}g=Kc(""+g),s.setAttribute(f,g);break;case"action":case"formAction":if(typeof g=="function"){s.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(f==="formAction"?(l!=="input"&&Jt(s,l,"name",x.name,x,null),Jt(s,l,"formEncType",x.formEncType,x,null),Jt(s,l,"formMethod",x.formMethod,x,null),Jt(s,l,"formTarget",x.formTarget,x,null)):(Jt(s,l,"encType",x.encType,x,null),Jt(s,l,"method",x.method,x,null),Jt(s,l,"target",x.target,x,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(f);break}g=Kc(""+g),s.setAttribute(f,g);break;case"onClick":g!=null&&(s.onclick=Ji);break;case"onScroll":g!=null&&wt("scroll",s);break;case"onScrollEnd":g!=null&&wt("scrollend",s);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"multiple":s.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":s.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){s.removeAttribute("xlink:href");break}f=Kc(""+g),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,""+g):s.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,""):s.removeAttribute(f);break;case"capture":case"download":g===!0?s.setAttribute(f,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,g):s.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?s.setAttribute(f,g):s.removeAttribute(f);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?s.removeAttribute(f):s.setAttribute(f,g);break;case"popover":wt("beforetoggle",s),wt("toggle",s),Hc(s,"popover",g);break;case"xlinkActuate":Hn(s,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":Hn(s,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":Hn(s,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":Hn(s,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":Hn(s,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":Hn(s,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":Hn(s,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":Hn(s,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":Hn(s,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":Hc(s,"is",g);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=lg.get(f)||f,Hc(s,f,g))}}function Xb(s,l,f,g,x,E){switch(f){case"style":af(s,g,E);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"children":typeof g=="string"?Wr(s,g):(typeof g=="number"||typeof g=="bigint")&&Wr(s,""+g);break;case"onScroll":g!=null&&wt("scroll",s);break;case"onScrollEnd":g!=null&&wt("scrollend",s);break;case"onClick":g!=null&&(s.onclick=Ji);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Qd.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(x=f.endsWith("Capture"),l=f.slice(2,x?f.length-7:void 0),E=s[Wt]||null,E=E!=null?E[f]:null,typeof E=="function"&&s.removeEventListener(l,E,x),typeof g=="function")){typeof E!="function"&&E!==null&&(f in s?s[f]=null:s.hasAttribute(f)&&s.removeAttribute(f)),s.addEventListener(l,g,x);break e}f in s?s[f]=g:g===!0?s.setAttribute(f,""):Hc(s,f,g)}}}function wr(s,l,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":wt("error",s),wt("load",s);var g=!1,x=!1,E;for(E in f)if(f.hasOwnProperty(E)){var N=f[E];if(N!=null)switch(E){case"src":g=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Jt(s,l,E,N,f,null)}}x&&Jt(s,l,"srcSet",f.srcSet,f,null),g&&Jt(s,l,"src",f.src,f,null);return;case"input":wt("invalid",s);var F=E=N=x=null,X=null,ue=null;for(g in f)if(f.hasOwnProperty(g)){var ve=f[g];if(ve!=null)switch(g){case"name":x=ve;break;case"type":N=ve;break;case"checked":X=ve;break;case"defaultChecked":ue=ve;break;case"value":E=ve;break;case"defaultValue":F=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(r(137,l));break;default:Jt(s,l,g,ve,f,null)}}ag(s,E,F,X,ue,N,x,!1);return;case"select":wt("invalid",s),g=N=E=null;for(x in f)if(f.hasOwnProperty(x)&&(F=f[x],F!=null))switch(x){case"value":E=F;break;case"defaultValue":N=F;break;case"multiple":g=F;default:Jt(s,l,x,F,f,null)}l=E,f=N,s.multiple=!!g,l!=null?no(s,!!g,l,!1):f!=null&&no(s,!!g,f,!0);return;case"textarea":wt("invalid",s),E=x=g=null;for(N in f)if(f.hasOwnProperty(N)&&(F=f[N],F!=null))switch(N){case"value":g=F;break;case"defaultValue":x=F;break;case"children":E=F;break;case"dangerouslySetInnerHTML":if(F!=null)throw Error(r(91));break;default:Jt(s,l,N,F,f,null)}ro(s,g,x,E);return;case"option":for(X in f)if(f.hasOwnProperty(X)&&(g=f[X],g!=null))switch(X){case"selected":s.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:Jt(s,l,X,g,f,null)}return;case"dialog":wt("beforetoggle",s),wt("toggle",s),wt("cancel",s),wt("close",s);break;case"iframe":case"object":wt("load",s);break;case"video":case"audio":for(g=0;g<Lf.length;g++)wt(Lf[g],s);break;case"image":wt("error",s),wt("load",s);break;case"details":wt("toggle",s);break;case"embed":case"source":case"link":wt("error",s),wt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ue in f)if(f.hasOwnProperty(ue)&&(g=f[ue],g!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Jt(s,l,ue,g,f,null)}return;default:if(Yc(l)){for(ve in f)f.hasOwnProperty(ve)&&(g=f[ve],g!==void 0&&Xb(s,l,ve,g,f,void 0));return}}for(F in f)f.hasOwnProperty(F)&&(g=f[F],g!=null&&Jt(s,l,F,g,f,null))}function j5(s,l,f,g){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,E=null,N=null,F=null,X=null,ue=null,ve=null;for(ge in f){var be=f[ge];if(f.hasOwnProperty(ge)&&be!=null)switch(ge){case"checked":break;case"value":break;case"defaultValue":X=be;default:g.hasOwnProperty(ge)||Jt(s,l,ge,null,g,be)}}for(var he in g){var ge=g[he];if(be=f[he],g.hasOwnProperty(he)&&(ge!=null||be!=null))switch(he){case"type":E=ge;break;case"name":x=ge;break;case"checked":ue=ge;break;case"defaultChecked":ve=ge;break;case"value":N=ge;break;case"defaultValue":F=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(r(137,l));break;default:ge!==be&&Jt(s,l,he,ge,g,be)}}$c(s,N,F,X,ue,ve,E,x);return;case"select":ge=N=F=he=null;for(E in f)if(X=f[E],f.hasOwnProperty(E)&&X!=null)switch(E){case"value":break;case"multiple":ge=X;default:g.hasOwnProperty(E)||Jt(s,l,E,null,g,X)}for(x in g)if(E=g[x],X=f[x],g.hasOwnProperty(x)&&(E!=null||X!=null))switch(x){case"value":he=E;break;case"defaultValue":F=E;break;case"multiple":N=E;default:E!==X&&Jt(s,l,x,E,g,X)}l=F,f=N,g=ge,he!=null?no(s,!!f,he,!1):!!g!=!!f&&(l!=null?no(s,!!f,l,!0):no(s,!!f,f?[]:"",!1));return;case"textarea":ge=he=null;for(F in f)if(x=f[F],f.hasOwnProperty(F)&&x!=null&&!g.hasOwnProperty(F))switch(F){case"value":break;case"children":break;default:Jt(s,l,F,null,g,x)}for(N in g)if(x=g[N],E=f[N],g.hasOwnProperty(N)&&(x!=null||E!=null))switch(N){case"value":he=x;break;case"defaultValue":ge=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==E&&Jt(s,l,N,x,g,E)}sg(s,he,ge);return;case"option":for(var ze in f)if(he=f[ze],f.hasOwnProperty(ze)&&he!=null&&!g.hasOwnProperty(ze))switch(ze){case"selected":s.selected=!1;break;default:Jt(s,l,ze,null,g,he)}for(X in g)if(he=g[X],ge=f[X],g.hasOwnProperty(X)&&he!==ge&&(he!=null||ge!=null))switch(X){case"selected":s.selected=he&&typeof he!="function"&&typeof he!="symbol";break;default:Jt(s,l,X,he,g,ge)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var We in f)he=f[We],f.hasOwnProperty(We)&&he!=null&&!g.hasOwnProperty(We)&&Jt(s,l,We,null,g,he);for(ue in g)if(he=g[ue],ge=f[ue],g.hasOwnProperty(ue)&&he!==ge&&(he!=null||ge!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(r(137,l));break;default:Jt(s,l,ue,he,g,ge)}return;default:if(Yc(l)){for(var en in f)he=f[en],f.hasOwnProperty(en)&&he!==void 0&&!g.hasOwnProperty(en)&&Xb(s,l,en,void 0,g,he);for(ve in g)he=g[ve],ge=f[ve],!g.hasOwnProperty(ve)||he===ge||he===void 0&&ge===void 0||Xb(s,l,ve,he,g,ge);return}}for(var ie in f)he=f[ie],f.hasOwnProperty(ie)&&he!=null&&!g.hasOwnProperty(ie)&&Jt(s,l,ie,null,g,he);for(be in g)he=g[be],ge=f[be],!g.hasOwnProperty(be)||he===ge||he==null&&ge==null||Jt(s,l,be,he,g,ge)}function DC(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function V5(){if(typeof performance.getEntriesByType=="function"){for(var s=0,l=0,f=performance.getEntriesByType("resource"),g=0;g<f.length;g++){var x=f[g],E=x.transferSize,N=x.initiatorType,F=x.duration;if(E&&F&&DC(N)){for(N=0,F=x.responseEnd,g+=1;g<f.length;g++){var X=f[g],ue=X.startTime;if(ue>F)break;var ve=X.transferSize,be=X.initiatorType;ve&&DC(be)&&(X=X.responseEnd,N+=ve*(X<F?1:(F-ue)/(X-ue)))}if(--g,l+=8*(E+N)/(x.duration/1e3),s++,10<s)break}}if(0<s)return l/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Wb=null,Qb=null;function cm(s){return s.nodeType===9?s:s.ownerDocument}function kC(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function NC(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function Zb(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Jb=null;function z5(){var s=window.event;return s&&s.type==="popstate"?s===Jb?!1:(Jb=s,!0):(Jb=null,!1)}var MC=typeof setTimeout=="function"?setTimeout:void 0,L5=typeof clearTimeout=="function"?clearTimeout:void 0,PC=typeof Promise=="function"?Promise:void 0,B5=typeof queueMicrotask=="function"?queueMicrotask:typeof PC<"u"?function(s){return PC.resolve(null).then(s).catch(U5)}:MC;function U5(s){setTimeout(function(){throw s})}function Co(s){return s==="head"}function OC(s,l){var f=l,g=0;do{var x=f.nextSibling;if(s.removeChild(f),x&&x.nodeType===8)if(f=x.data,f==="/$"||f==="/&"){if(g===0){s.removeChild(x),Iu(l);return}g--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")g++;else if(f==="html")Uf(s.ownerDocument.documentElement);else if(f==="head"){f=s.ownerDocument.head,Uf(f);for(var E=f.firstChild;E;){var N=E.nextSibling,F=E.nodeName;E[Ea]||F==="SCRIPT"||F==="STYLE"||F==="LINK"&&E.rel.toLowerCase()==="stylesheet"||f.removeChild(E),E=N}}else f==="body"&&Uf(s.ownerDocument.body);f=x}while(f);Iu(l)}function jC(s,l){var f=s;s=0;do{var g=f.nextSibling;if(f.nodeType===1?l?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(l?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),g&&g.nodeType===8)if(f=g.data,f==="/$"){if(s===0)break;s--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||s++;f=g}while(f)}function ex(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var f=l;switch(l=l.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":ex(f),qc(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}s.removeChild(f)}}function F5(s,l,f,g){for(;s.nodeType===1;){var x=f;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!g&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(g){if(!s[Ea])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(E=s.getAttribute("rel"),E==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(E!==x.rel||s.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||s.getAttribute("title")!==(x.title==null?null:x.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(E=s.getAttribute("src"),(E!==(x.src==null?null:x.src)||s.getAttribute("type")!==(x.type==null?null:x.type)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&E&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var E=x.name==null?null:""+x.name;if(x.type==="hidden"&&s.getAttribute("name")===E)return s}else return s;if(s=Oi(s.nextSibling),s===null)break}return null}function G5(s,l,f){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!f||(s=Oi(s.nextSibling),s===null))return null;return s}function VC(s,l){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Oi(s.nextSibling),s===null))return null;return s}function tx(s){return s.data==="$?"||s.data==="$~"}function nx(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function q5(s,l){var f=s.ownerDocument;if(s.data==="$~")s._reactRetry=l;else if(s.data!=="$?"||f.readyState!=="loading")l();else{var g=function(){l(),f.removeEventListener("DOMContentLoaded",g)};f.addEventListener("DOMContentLoaded",g),s._reactRetry=g}}function Oi(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return s}var rx=null;function zC(s){s=s.nextSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="/$"||f==="/&"){if(l===0)return Oi(s.nextSibling);l--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||l++}s=s.nextSibling}return null}function LC(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(l===0)return s;l--}else f!=="/$"&&f!=="/&"||l++}s=s.previousSibling}return null}function BC(s,l,f){switch(l=cm(f),s){case"html":if(s=l.documentElement,!s)throw Error(r(452));return s;case"head":if(s=l.head,!s)throw Error(r(453));return s;case"body":if(s=l.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function Uf(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);qc(s)}var ji=new Map,UC=new Set;function um(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var As=W.d;W.d={f:H5,r:$5,D:Y5,C:K5,L:X5,m:W5,X:Z5,S:Q5,M:J5};function H5(){var s=As.f(),l=tm();return s||l}function $5(s){var l=Ti(s);l!==null&&l.tag===5&&l.type==="form"?iA(l):As.r(s)}var Tu=typeof document>"u"?null:document;function FC(s,l,f){var g=Tu;if(g&&typeof l=="string"&&l){var x=Xr(l);x='link[rel="'+s+'"][href="'+x+'"]',typeof f=="string"&&(x+='[crossorigin="'+f+'"]'),UC.has(x)||(UC.add(x),s={rel:s,crossOrigin:f,href:l},g.querySelector(x)===null&&(l=g.createElement("link"),wr(l,"link",s),qn(l),g.head.appendChild(l)))}}function Y5(s){As.D(s),FC("dns-prefetch",s,null)}function K5(s,l){As.C(s,l),FC("preconnect",s,l)}function X5(s,l,f){As.L(s,l,f);var g=Tu;if(g&&s&&l){var x='link[rel="preload"][as="'+Xr(l)+'"]';l==="image"&&f&&f.imageSrcSet?(x+='[imagesrcset="'+Xr(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(x+='[imagesizes="'+Xr(f.imageSizes)+'"]')):x+='[href="'+Xr(s)+'"]';var E=x;switch(l){case"style":E=Au(s);break;case"script":E=Cu(s)}ji.has(E)||(s=p({rel:"preload",href:l==="image"&&f&&f.imageSrcSet?void 0:s,as:l},f),ji.set(E,s),g.querySelector(x)!==null||l==="style"&&g.querySelector(Ff(E))||l==="script"&&g.querySelector(Gf(E))||(l=g.createElement("link"),wr(l,"link",s),qn(l),g.head.appendChild(l)))}}function W5(s,l){As.m(s,l);var f=Tu;if(f&&s){var g=l&&typeof l.as=="string"?l.as:"script",x='link[rel="modulepreload"][as="'+Xr(g)+'"][href="'+Xr(s)+'"]',E=x;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=Cu(s)}if(!ji.has(E)&&(s=p({rel:"modulepreload",href:s},l),ji.set(E,s),f.querySelector(x)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Gf(E)))return}g=f.createElement("link"),wr(g,"link",s),qn(g),f.head.appendChild(g)}}}function Q5(s,l,f){As.S(s,l,f);var g=Tu;if(g&&s){var x=Ta(g).hoistableStyles,E=Au(s);l=l||"default";var N=x.get(E);if(!N){var F={loading:0,preload:null};if(N=g.querySelector(Ff(E)))F.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":l},f),(f=ji.get(E))&&ix(s,f);var X=N=g.createElement("link");qn(X),wr(X,"link",s),X._p=new Promise(function(ue,ve){X.onload=ue,X.onerror=ve}),X.addEventListener("load",function(){F.loading|=1}),X.addEventListener("error",function(){F.loading|=2}),F.loading|=4,dm(N,l,g)}N={type:"stylesheet",instance:N,count:1,state:F},x.set(E,N)}}}function Z5(s,l){As.X(s,l);var f=Tu;if(f&&s){var g=Ta(f).hoistableScripts,x=Cu(s),E=g.get(x);E||(E=f.querySelector(Gf(x)),E||(s=p({src:s,async:!0},l),(l=ji.get(x))&&ax(s,l),E=f.createElement("script"),qn(E),wr(E,"link",s),f.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},g.set(x,E))}}function J5(s,l){As.M(s,l);var f=Tu;if(f&&s){var g=Ta(f).hoistableScripts,x=Cu(s),E=g.get(x);E||(E=f.querySelector(Gf(x)),E||(s=p({src:s,async:!0,type:"module"},l),(l=ji.get(x))&&ax(s,l),E=f.createElement("script"),qn(E),wr(E,"link",s),f.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},g.set(x,E))}}function GC(s,l,f,g){var x=(x=fe.current)?um(x):null;if(!x)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(l=Au(f.href),f=Ta(x).hoistableStyles,g=f.get(l),g||(g={type:"style",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){s=Au(f.href);var E=Ta(x).hoistableStyles,N=E.get(s);if(N||(x=x.ownerDocument||x,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(s,N),(E=x.querySelector(Ff(s)))&&!E._p&&(N.instance=E,N.state.loading=5),ji.has(s)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},ji.set(s,f),E||e6(x,s,f,N.state))),l&&g===null)throw Error(r(528,""));return N}if(l&&g!==null)throw Error(r(529,""));return null;case"script":return l=f.async,f=f.src,typeof f=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Cu(f),f=Ta(x).hoistableScripts,g=f.get(l),g||(g={type:"script",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Au(s){return'href="'+Xr(s)+'"'}function Ff(s){return'link[rel="stylesheet"]['+s+"]"}function qC(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function e6(s,l,f,g){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?g.loading=1:(l=s.createElement("link"),g.preload=l,l.addEventListener("load",function(){return g.loading|=1}),l.addEventListener("error",function(){return g.loading|=2}),wr(l,"link",f),qn(l),s.head.appendChild(l))}function Cu(s){return'[src="'+Xr(s)+'"]'}function Gf(s){return"script[async]"+s}function HC(s,l,f){if(l.count++,l.instance===null)switch(l.type){case"style":var g=s.querySelector('style[data-href~="'+Xr(f.href)+'"]');if(g)return l.instance=g,qn(g),g;var x=p({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return g=(s.ownerDocument||s).createElement("style"),qn(g),wr(g,"style",x),dm(g,f.precedence,s),l.instance=g;case"stylesheet":x=Au(f.href);var E=s.querySelector(Ff(x));if(E)return l.state.loading|=4,l.instance=E,qn(E),E;g=qC(f),(x=ji.get(x))&&ix(g,x),E=(s.ownerDocument||s).createElement("link"),qn(E);var N=E;return N._p=new Promise(function(F,X){N.onload=F,N.onerror=X}),wr(E,"link",g),l.state.loading|=4,dm(E,f.precedence,s),l.instance=E;case"script":return E=Cu(f.src),(x=s.querySelector(Gf(E)))?(l.instance=x,qn(x),x):(g=f,(x=ji.get(E))&&(g=p({},f),ax(g,x)),s=s.ownerDocument||s,x=s.createElement("script"),qn(x),wr(x,"link",g),s.head.appendChild(x),l.instance=x);case"void":return null;default:throw Error(r(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(g=l.instance,l.state.loading|=4,dm(g,f.precedence,s));return l.instance}function dm(s,l,f){for(var g=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=g.length?g[g.length-1]:null,E=x,N=0;N<g.length;N++){var F=g[N];if(F.dataset.precedence===l)E=F;else if(E!==x)break}E?E.parentNode.insertBefore(s,E.nextSibling):(l=f.nodeType===9?f.head:f,l.insertBefore(s,l.firstChild))}function ix(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function ax(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var fm=null;function $C(s,l,f){if(fm===null){var g=new Map,x=fm=new Map;x.set(f,g)}else x=fm,g=x.get(f),g||(g=new Map,x.set(f,g));if(g.has(s))return g;for(g.set(s,null),f=f.getElementsByTagName(s),x=0;x<f.length;x++){var E=f[x];if(!(E[Ea]||E[ln]||s==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var N=E.getAttribute(l)||"";N=s+N;var F=g.get(N);F?F.push(E):g.set(N,[E])}}return g}function YC(s,l,f){s=s.ownerDocument||s,s.head.insertBefore(f,l==="title"?s.querySelector("head > title"):null)}function t6(s,l,f){if(f===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return s=l.disabled,typeof l.precedence=="string"&&s==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function KC(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function n6(s,l,f,g){if(f.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var x=Au(g.href),E=l.querySelector(Ff(x));if(E){l=E._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(s.count++,s=hm.bind(s),l.then(s,s)),f.state.loading|=4,f.instance=E,qn(E);return}E=l.ownerDocument||l,g=qC(g),(x=ji.get(x))&&ix(g,x),E=E.createElement("link"),qn(E);var N=E;N._p=new Promise(function(F,X){N.onload=F,N.onerror=X}),wr(E,"link",g),f.instance=E}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(f,l),(l=f.state.preload)&&(f.state.loading&3)===0&&(s.count++,f=hm.bind(s),l.addEventListener("load",f),l.addEventListener("error",f))}}var sx=0;function r6(s,l){return s.stylesheets&&s.count===0&&gm(s,s.stylesheets),0<s.count||0<s.imgCount?function(f){var g=setTimeout(function(){if(s.stylesheets&&gm(s,s.stylesheets),s.unsuspend){var E=s.unsuspend;s.unsuspend=null,E()}},6e4+l);0<s.imgBytes&&sx===0&&(sx=62500*V5());var x=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&gm(s,s.stylesheets),s.unsuspend)){var E=s.unsuspend;s.unsuspend=null,E()}},(s.imgBytes>sx?50:800)+l);return s.unsuspend=f,function(){s.unsuspend=null,clearTimeout(g),clearTimeout(x)}}:null}function hm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)gm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var pm=null;function gm(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,pm=new Map,l.forEach(i6,s),pm=null,hm.call(s))}function i6(s,l){if(!(l.state.loading&4)){var f=pm.get(s);if(f)var g=f.get(null);else{f=new Map,pm.set(s,f);for(var x=s.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<x.length;E++){var N=x[E];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(f.set(N.dataset.precedence,N),g=N)}g&&f.set(null,g)}x=l.instance,N=x.getAttribute("data-precedence"),E=f.get(N)||g,E===g&&f.set(null,x),f.set(N,x),this.count++,g=hm.bind(this),x.addEventListener("load",g),x.addEventListener("error",g),E?E.parentNode.insertBefore(x,E.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(x,s.firstChild)),l.state.loading|=4}}var qf={$$typeof:D,Provider:null,Consumer:null,_currentValue:K,_currentValue2:K,_threadCount:0};function a6(s,l,f,g,x,E,N,F,X){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Gn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gn(0),this.hiddenUpdates=Gn(null),this.identifierPrefix=g,this.onUncaughtError=x,this.onCaughtError=E,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=X,this.incompleteTransitions=new Map}function XC(s,l,f,g,x,E,N,F,X,ue,ve,be){return s=new a6(s,l,f,N,X,ue,ve,be,F),l=1,E===!0&&(l|=24),E=gi(3,null,null,l),s.current=E,E.stateNode=s,l=Ly(),l.refCount++,s.pooledCache=l,l.refCount++,E.memoizedState={element:g,isDehydrated:f,cache:l},Gy(E),s}function WC(s){return s?(s=iu,s):iu}function QC(s,l,f,g,x,E){x=WC(x),g.context===null?g.context=x:g.pendingContext=x,g=mo(l),g.payload={element:f},E=E===void 0?null:E,E!==null&&(g.callback=E),f=vo(s,g,l),f!==null&&(ti(f,s,l),wf(f,s,l))}function ZC(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var f=s.retryLane;s.retryLane=f!==0&&f<l?f:l}}function ox(s,l){ZC(s,l),(s=s.alternate)&&ZC(s,l)}function JC(s){if(s.tag===13||s.tag===31){var l=Ml(s,67108864);l!==null&&ti(l,s,67108864),ox(s,67108864)}}function e2(s){if(s.tag===13||s.tag===31){var l=xi();l=Vt(l);var f=Ml(s,l);f!==null&&ti(f,s,l),ox(s,l)}}var mm=!0;function s6(s,l,f,g){var x=H.T;H.T=null;var E=W.p;try{W.p=2,lx(s,l,f,g)}finally{W.p=E,H.T=x}}function o6(s,l,f,g){var x=H.T;H.T=null;var E=W.p;try{W.p=8,lx(s,l,f,g)}finally{W.p=E,H.T=x}}function lx(s,l,f,g){if(mm){var x=cx(g);if(x===null)Kb(s,l,g,vm,f),n2(s,g);else if(c6(x,s,l,f,g))g.stopPropagation();else if(n2(s,g),l&4&&-1<l6.indexOf(s)){for(;x!==null;){var E=Ti(x);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var N=Pe(E.pendingLanes);if(N!==0){var F=E;for(F.pendingLanes|=2,F.entangledLanes|=2;N;){var X=1<<31-cn(N);F.entanglements[1]|=X,N&=~X}za(E),(Bt&6)===0&&(Jg=rt()+500,zf(0))}}break;case 31:case 13:F=Ml(E,2),F!==null&&ti(F,E,2),tm(),ox(E,2)}if(E=cx(g),E===null&&Kb(s,l,g,vm,f),E===x)break;x=E}x!==null&&g.stopPropagation()}else Kb(s,l,g,null,f)}}function cx(s){return s=Ai(s),ux(s)}var vm=null;function ux(s){if(vm=null,s=Sa(s),s!==null){var l=a(s);if(l===null)s=null;else{var f=l.tag;if(f===13){if(s=o(l),s!==null)return s;s=null}else if(f===31){if(s=c(l),s!==null)return s;s=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return vm=s,null}function t2(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(pt()){case jt:return 2;case Ft:return 8;case jn:case ui:return 32;case ls:return 268435456;default:return 32}default:return 32}}var dx=!1,Io=null,Ro=null,Do=null,Hf=new Map,$f=new Map,ko=[],l6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function n2(s,l){switch(s){case"focusin":case"focusout":Io=null;break;case"dragenter":case"dragleave":Ro=null;break;case"mouseover":case"mouseout":Do=null;break;case"pointerover":case"pointerout":Hf.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":$f.delete(l.pointerId)}}function Yf(s,l,f,g,x,E){return s===null||s.nativeEvent!==E?(s={blockedOn:l,domEventName:f,eventSystemFlags:g,nativeEvent:E,targetContainers:[x]},l!==null&&(l=Ti(l),l!==null&&JC(l)),s):(s.eventSystemFlags|=g,l=s.targetContainers,x!==null&&l.indexOf(x)===-1&&l.push(x),s)}function c6(s,l,f,g,x){switch(l){case"focusin":return Io=Yf(Io,s,l,f,g,x),!0;case"dragenter":return Ro=Yf(Ro,s,l,f,g,x),!0;case"mouseover":return Do=Yf(Do,s,l,f,g,x),!0;case"pointerover":var E=x.pointerId;return Hf.set(E,Yf(Hf.get(E)||null,s,l,f,g,x)),!0;case"gotpointercapture":return E=x.pointerId,$f.set(E,Yf($f.get(E)||null,s,l,f,g,x)),!0}return!1}function r2(s){var l=Sa(s.target);if(l!==null){var f=a(l);if(f!==null){if(l=f.tag,l===13){if(l=o(f),l!==null){s.blockedOn=l,zt(s.priority,function(){e2(f)});return}}else if(l===31){if(l=c(f),l!==null){s.blockedOn=l,zt(s.priority,function(){e2(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){s.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ym(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var f=cx(s.nativeEvent);if(f===null){f=s.nativeEvent;var g=new f.constructor(f.type,f);sf=g,f.target.dispatchEvent(g),sf=null}else return l=Ti(f),l!==null&&JC(l),s.blockedOn=f,!1;l.shift()}return!0}function i2(s,l,f){ym(s)&&f.delete(l)}function u6(){dx=!1,Io!==null&&ym(Io)&&(Io=null),Ro!==null&&ym(Ro)&&(Ro=null),Do!==null&&ym(Do)&&(Do=null),Hf.forEach(i2),$f.forEach(i2)}function bm(s,l){s.blockedOn===l&&(s.blockedOn=null,dx||(dx=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,u6)))}var xm=null;function a2(s){xm!==s&&(xm=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){xm===s&&(xm=null);for(var l=0;l<s.length;l+=3){var f=s[l],g=s[l+1],x=s[l+2];if(typeof g!="function"){if(ux(g||f)===null)continue;break}var E=Ti(f);E!==null&&(s.splice(l,3),l-=3,cb(E,{pending:!0,data:x,method:f.method,action:g},g,x))}}))}function Iu(s){function l(X){return bm(X,s)}Io!==null&&bm(Io,s),Ro!==null&&bm(Ro,s),Do!==null&&bm(Do,s),Hf.forEach(l),$f.forEach(l);for(var f=0;f<ko.length;f++){var g=ko[f];g.blockedOn===s&&(g.blockedOn=null)}for(;0<ko.length&&(f=ko[0],f.blockedOn===null);)r2(f),f.blockedOn===null&&ko.shift();if(f=(s.ownerDocument||s).$$reactFormReplay,f!=null)for(g=0;g<f.length;g+=3){var x=f[g],E=f[g+1],N=x[Wt]||null;if(typeof E=="function")N||a2(f);else if(N){var F=null;if(E&&E.hasAttribute("formAction")){if(x=E,N=E[Wt]||null)F=N.formAction;else if(ux(x)!==null)continue}else F=N.action;typeof F=="function"?f[g+1]=F:(f.splice(g,3),g-=3),a2(f)}}}function s2(){function s(E){E.canIntercept&&E.info==="react-transition"&&E.intercept({handler:function(){return new Promise(function(N){return x=N})},focusReset:"manual",scroll:"manual"})}function l(){x!==null&&(x(),x=null),g||setTimeout(f,20)}function f(){if(!g&&!navigation.transition){var E=navigation.currentEntry;E&&E.url!=null&&navigation.navigate(E.url,{state:E.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,x=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(f,100),function(){g=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),x!==null&&(x(),x=null)}}}function fx(s){this._internalRoot=s}_m.prototype.render=fx.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(r(409));var f=l.current,g=xi();QC(f,g,s,l,null,null)},_m.prototype.unmount=fx.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;QC(s.current,2,null,s,null,null),tm(),l[pr]=null}};function _m(s){this._internalRoot=s}_m.prototype.unstable_scheduleHydration=function(s){if(s){var l=Et();s={blockedOn:null,target:s,priority:l};for(var f=0;f<ko.length&&l!==0&&l<ko[f].priority;f++);ko.splice(f,0,s),f===0&&r2(s)}};var o2=e.version;if(o2!=="19.2.0")throw Error(r(527,o2,"19.2.0"));W.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(l),s=s!==null?h(s):null,s=s===null?null:s.stateNode,s};var d6={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wm.isDisabled&&wm.supportsFiber)try{Ir=wm.inject(d6),Sn=wm}catch{}}return Xf.createRoot=function(s,l){if(!i(s))throw Error(r(299));var f=!1,g="",x=pA,E=gA,N=mA;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(E=l.onCaughtError),l.onRecoverableError!==void 0&&(N=l.onRecoverableError)),l=XC(s,1,!1,null,null,f,g,null,x,E,N,s2),s[pr]=l.current,Yb(s),new fx(l)},Xf.hydrateRoot=function(s,l,f){if(!i(s))throw Error(r(299));var g=!1,x="",E=pA,N=gA,F=mA,X=null;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onUncaughtError!==void 0&&(E=f.onUncaughtError),f.onCaughtError!==void 0&&(N=f.onCaughtError),f.onRecoverableError!==void 0&&(F=f.onRecoverableError),f.formState!==void 0&&(X=f.formState)),l=XC(s,1,!0,l,f??null,g,x,X,E,N,F,s2),l.context=WC(null),f=l.current,g=xi(),g=Vt(g),x=mo(g),x.callback=null,vo(f,x,g),f=g,l.current.lanes=f,ir(l,f),za(l),s[pr]=l.current,Yb(s),new _m(l)},Xf.version="19.2.0",Xf}var v2;function w6(){if(v2)return gx.exports;v2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),gx.exports=_6(),gx.exports}var E6=w6();const S6="modulepreload",T6=function(n){return"/personal-budget-pwa/"+n},y2={},tn=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let u=function(d){return Promise.all(d.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");i=u(t.map(d=>{if(d=T6(d),d in y2)return;y2[d]=!0;const h=d.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${p}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":S6,h||(m.as="script"),m.crossOrigin="",m.href=d,c&&m.setAttribute("nonce",c),document.head.appendChild(m),h)return new Promise((b,_)=>{m.addEventListener("load",b),m.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return i.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};function A6(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:r,onRegistered:i,onRegisteredSW:a,onRegisterError:o}=n;let c,u;const d=async(p=!0)=>{await u};async function h(){if("serviceWorker"in navigator){if(c=await tn(async()=>{const{Workbox:p}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/personal-budget-pwa/sw.js",{scope:"/personal-budget-pwa/",type:"classic"})).catch(p=>{o?.(p)}),!c)return;c.addEventListener("activated",p=>{(p.isUpdate||p.isExternal)&&window.location.reload()}),c.addEventListener("installed",p=>{p.isUpdate||r?.()}),c.register({immediate:e}).then(p=>{a?a("/personal-budget-pwa/sw.js",p):i?.(p)}).catch(p=>{o?.(p)})}}return u=h(),d}var b2="popstate";function C6(n={}){function e(i,a){let{pathname:o="/",search:c="",hash:u=""}=zc(i.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),_1("",{pathname:o,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(i,a){let o=i.document.querySelector("base"),c="";if(o&&o.getAttribute("href")){let u=i.location.href,d=u.indexOf("#");c=d===-1?u:u.slice(0,d)}return c+"#"+(typeof a=="string"?a:zh(a))}function r(i,a){Ki(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(a)})`)}return R6(e,t,r,n)}function In(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Ki(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function I6(){return Math.random().toString(36).substring(2,10)}function x2(n,e){return{usr:n.state,key:n.key,idx:e}}function _1(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?zc(e):e,state:t,key:e&&e.key||r||I6()}}function zh({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function zc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function R6(n,e,t,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,c="POP",u=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function p(){c="POP";let S=h(),T=S==null?null:S-d;d=S,u&&u({action:c,location:w.location,delta:T})}function m(S,T){c="PUSH";let A=_1(w.location,S,T);t&&t(A,S),d=h()+1;let D=x2(A,d),O=w.createHref(A);try{o.pushState(D,"",O)}catch(M){if(M instanceof DOMException&&M.name==="DataCloneError")throw M;i.location.assign(O)}a&&u&&u({action:c,location:w.location,delta:1})}function b(S,T){c="REPLACE";let A=_1(w.location,S,T);t&&t(A,S),d=h();let D=x2(A,d),O=w.createHref(A);o.replaceState(D,"",O),a&&u&&u({action:c,location:w.location,delta:0})}function _(S){return D6(S)}let w={get action(){return c},get location(){return n(i,o)},listen(S){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(b2,p),u=S,()=>{i.removeEventListener(b2,p),u=null}},createHref(S){return e(i,S)},createURL:_,encodeLocation(S){let T=_(S);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:m,replace:b,go(S){return o.go(S)}};return w}function D6(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),In(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:zh(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function Zk(n,e,t="/"){return k6(n,e,t,!1)}function k6(n,e,t,r){let i=typeof e=="string"?zc(e):e,a=zs(i.pathname||"/",t);if(a==null)return null;let o=Jk(n);N6(o);let c=null;for(let u=0;c==null&&u<o.length;++u){let d=G6(a);c=U6(o[u],d,r)}return c}function Jk(n,e=[],t=[],r="",i=!1){let a=(o,c,u=i,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&u)return;In(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let p=Ms([r,h.relativePath]),m=t.concat(h);o.children&&o.children.length>0&&(In(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),Jk(o.children,e,m,p,u)),!(o.path==null&&!o.index)&&e.push({path:p,score:L6(p,o.index),routesMeta:m})};return n.forEach((o,c)=>{if(o.path===""||!o.path?.includes("?"))a(o,c);else for(let u of eN(o.path))a(o,c,!0,u)}),e}function eN(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=eN(r.join("/")),c=[];return c.push(...o.map(u=>u===""?a:[a,u].join("/"))),i&&c.push(...o),c.map(u=>n.startsWith("/")&&u===""?"/":u)}function N6(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:B6(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var M6=/^:[\w-]+$/,P6=3,O6=2,j6=1,V6=10,z6=-2,_2=n=>n==="*";function L6(n,e){let t=n.split("/"),r=t.length;return t.some(_2)&&(r+=z6),e&&(r+=O6),t.filter(i=>!_2(i)).reduce((i,a)=>i+(M6.test(a)?P6:a===""?j6:V6),r)}function B6(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function U6(n,e,t=!1){let{routesMeta:r}=n,i={},a="/",o=[];for(let c=0;c<r.length;++c){let u=r[c],d=c===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=S0({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),m=u.route;if(!p&&d&&t&&!r[r.length-1].route.index&&(p=S0({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:Ms([a,p.pathname]),pathnameBase:Y6(Ms([a,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(a=Ms([a,p.pathnameBase]))}return o}function S0(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=F6(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:p},m)=>{if(h==="*"){let _=c[m]||"";o=a.slice(0,a.length-_.length).replace(/(.)\/+$/,"$1")}const b=c[m];return p&&!b?d[h]=void 0:d[h]=(b||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:n}}function F6(n,e=!1,t=!0){Ki(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function G6(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ki(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function zs(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}var q6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function H6(n,e="/"){let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?zc(n):n,a;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?a=w2(t.substring(1),"/"):a=w2(t,e)):a=e,{pathname:a,search:K6(r),hash:X6(i)}}function w2(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function bx(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function $6(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function tN(n){let e=$6(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function nN(n,e,t,r=!1){let i;typeof n=="string"?i=zc(n):(i={...n},In(!i.pathname||!i.pathname.includes("?"),bx("?","pathname","search",i)),In(!i.pathname||!i.pathname.includes("#"),bx("#","pathname","hash",i)),In(!i.search||!i.search.includes("#"),bx("#","search","hash",i)));let a=n===""||i.pathname==="",o=a?"/":i.pathname,c;if(o==null)c=t;else{let p=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;i.pathname=m.join("/")}c=p>=0?e[p]:"/"}let u=H6(i,c),d=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}var Ms=n=>n.join("/").replace(/\/\/+/g,"/"),Y6=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),K6=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,X6=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,W6=class{constructor(n,e,t,r=!1){this.status=n,this.statusText=e||"",this.internal=r,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function Q6(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function Z6(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var rN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function iN(n,e){let t=n;if(typeof t!="string"||!q6.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let r=t,i=!1;if(rN)try{let a=new URL(window.location.href),o=t.startsWith("//")?new URL(a.protocol+t):new URL(t),c=zs(o.pathname,e);o.origin===a.origin&&c!=null?t=c+o.search+o.hash:i=!0}catch{Ki(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:i,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var aN=["POST","PUT","PATCH","DELETE"];new Set(aN);var J6=["GET",...aN];new Set(J6);var Pd=U.createContext(null);Pd.displayName="DataRouter";var xv=U.createContext(null);xv.displayName="DataRouterState";var ez=U.createContext(!1),sN=U.createContext({isTransitioning:!1});sN.displayName="ViewTransition";var tz=U.createContext(new Map);tz.displayName="Fetchers";var nz=U.createContext(null);nz.displayName="Await";var Qi=U.createContext(null);Qi.displayName="Navigation";var vp=U.createContext(null);vp.displayName="Location";var as=U.createContext({outlet:null,matches:[],isDataRoute:!1});as.displayName="Route";var ow=U.createContext(null);ow.displayName="RouteError";var oN="REACT_ROUTER_ERROR",rz="REDIRECT",iz="ROUTE_ERROR_RESPONSE";function az(n){if(n.startsWith(`${oN}:${rz}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function sz(n){if(n.startsWith(`${oN}:${iz}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new W6(e.status,e.statusText,e.data)}catch{}}function oz(n,{relative:e}={}){In(yp(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=U.useContext(Qi),{hash:i,pathname:a,search:o}=bp(n,{relative:e}),c=a;return t!=="/"&&(c=a==="/"?t:Ms([t,a])),r.createHref({pathname:c,search:o,hash:i})}function yp(){return U.useContext(vp)!=null}function xa(){return In(yp(),"useLocation() may be used only in the context of a <Router> component."),U.useContext(vp).location}var lN="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function cN(n){U.useContext(Qi).static||U.useLayoutEffect(n)}function Ks(){let{isDataRoute:n}=U.useContext(as);return n?_z():lz()}function lz(){In(yp(),"useNavigate() may be used only in the context of a <Router> component.");let n=U.useContext(Pd),{basename:e,navigator:t}=U.useContext(Qi),{matches:r}=U.useContext(as),{pathname:i}=xa(),a=JSON.stringify(tN(r)),o=U.useRef(!1);return cN(()=>{o.current=!0}),U.useCallback((u,d={})=>{if(Ki(o.current,lN),!o.current)return;if(typeof u=="number"){t.go(u);return}let h=nN(u,JSON.parse(a),i,d.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Ms([e,h.pathname])),(d.replace?t.replace:t.push)(h,d.state,d)},[e,t,a,i,n])}U.createContext(null);function cz(){let{matches:n}=U.useContext(as),e=n[n.length-1];return e?e.params:{}}function bp(n,{relative:e}={}){let{matches:t}=U.useContext(as),{pathname:r}=xa(),i=JSON.stringify(tN(t));return U.useMemo(()=>nN(n,JSON.parse(i),r,e==="path"),[n,i,r,e])}function uz(n,e){return uN(n,e)}function uN(n,e,t,r,i){In(yp(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=U.useContext(Qi),{matches:o}=U.useContext(as),c=o[o.length-1],u=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",p=c&&c.route;{let A=p&&p.path||"";fN(d,!p||A.endsWith("*")||A.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${A}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${A}"> to <Route path="${A==="/"?"*":`${A}/*`}">.`)}let m=xa(),b;if(e){let A=typeof e=="string"?zc(e):e;In(h==="/"||A.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${A.pathname}" was given in the \`location\` prop.`),b=A}else b=m;let _=b.pathname||"/",w=_;if(h!=="/"){let A=h.replace(/^\//,"").split("/");w="/"+_.replace(/^\//,"").split("/").slice(A.length).join("/")}let S=Zk(n,{pathname:w});Ki(p||S!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),Ki(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=gz(S&&S.map(A=>Object.assign({},A,{params:Object.assign({},u,A.params),pathname:Ms([h,a.encodeLocation?a.encodeLocation(A.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?h:Ms([h,a.encodeLocation?a.encodeLocation(A.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:A.pathnameBase])})),o,t,r,i);return e&&T?U.createElement(vp.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},T):T}function dz(){let n=xz(),e=Q6(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",n),o=U.createElement(U.Fragment,null,U.createElement("p",null," Hey developer "),U.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",U.createElement("code",{style:a},"ErrorBoundary")," or"," ",U.createElement("code",{style:a},"errorElement")," prop on your route.")),U.createElement(U.Fragment,null,U.createElement("h2",null,"Unexpected Application Error!"),U.createElement("h3",{style:{fontStyle:"italic"}},e),t?U.createElement("pre",{style:i},t):null,o)}var fz=U.createElement(dz,null),dN=class extends U.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=sz(n.digest);t&&(n=t)}let e=n!==void 0?U.createElement(as.Provider,{value:this.props.routeContext},U.createElement(ow.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?U.createElement(hz,{error:n},e):e}};dN.contextType=ez;var xx=new WeakMap;function hz({children:n,error:e}){let{basename:t}=U.useContext(Qi);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=az(e.digest);if(r){let i=xx.get(e);if(i)throw i;let a=iN(r.location,t);if(rN&&!xx.get(e))if(a.isExternal||r.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:r.replace}));throw xx.set(e,o),o}return U.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return n}function pz({routeContext:n,match:e,children:t}){let r=U.useContext(Pd);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),U.createElement(as.Provider,{value:n},t)}function gz(n,e=[],t=null,r=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,o=t?.errors;if(o!=null){let h=a.findIndex(p=>p.route.id&&o?.[p.route.id]!==void 0);In(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let c=!1,u=-1;if(t)for(let h=0;h<a.length;h++){let p=a[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=h),p.route.id){let{loaderData:m,errors:b}=t,_=p.route.loader&&!m.hasOwnProperty(p.route.id)&&(!b||b[p.route.id]===void 0);if(p.route.lazy||_){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}let d=t&&r?(h,p)=>{r(h,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:Z6(t.matches),errorInfo:p})}:void 0;return a.reduceRight((h,p,m)=>{let b,_=!1,w=null,S=null;t&&(b=o&&p.route.id?o[p.route.id]:void 0,w=p.route.errorElement||fz,c&&(u<0&&m===0?(fN("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,S=null):u===m&&(_=!0,S=p.route.hydrateFallbackElement||null)));let T=e.concat(a.slice(0,m+1)),A=()=>{let D;return b?D=w:_?D=S:p.route.Component?D=U.createElement(p.route.Component,null):p.route.element?D=p.route.element:D=h,U.createElement(pz,{match:p,routeContext:{outlet:h,matches:T,isDataRoute:t!=null},children:D})};return t&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?U.createElement(dN,{location:t.location,revalidation:t.revalidation,component:w,error:b,children:A(),routeContext:{outlet:null,matches:T,isDataRoute:!0},onError:d}):A()},null)}function lw(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function mz(n){let e=U.useContext(Pd);return In(e,lw(n)),e}function vz(n){let e=U.useContext(xv);return In(e,lw(n)),e}function yz(n){let e=U.useContext(as);return In(e,lw(n)),e}function cw(n){let e=yz(n),t=e.matches[e.matches.length-1];return In(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function bz(){return cw("useRouteId")}function xz(){let n=U.useContext(ow),e=vz("useRouteError"),t=cw("useRouteError");return n!==void 0?n:e.errors?.[t]}function _z(){let{router:n}=mz("useNavigate"),e=cw("useNavigate"),t=U.useRef(!1);return cN(()=>{t.current=!0}),U.useCallback(async(i,a={})=>{Ki(t.current,lN),t.current&&(typeof i=="number"?await n.navigate(i):await n.navigate(i,{fromRouteId:e,...a}))},[n,e])}var E2={};function fN(n,e,t){!e&&!E2[n]&&(E2[n]=!0,Ki(!1,t))}U.memo(wz);function wz({routes:n,future:e,state:t,onError:r}){return uN(n,void 0,t,r,e)}function Lo(n){In(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Ez({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:i,static:a=!1,unstable_useTransitions:o}){In(!yp(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=n.replace(/^\/*/,"/"),u=U.useMemo(()=>({basename:c,navigator:i,static:a,unstable_useTransitions:o,future:{}}),[c,i,a,o]);typeof t=="string"&&(t=zc(t));let{pathname:d="/",search:h="",hash:p="",state:m=null,key:b="default"}=t,_=U.useMemo(()=>{let w=zs(d,c);return w==null?null:{location:{pathname:w,search:h,hash:p,state:m,key:b},navigationType:r}},[c,d,h,p,m,b,r]);return Ki(_!=null,`<Router basename="${c}"> is not able to match the URL "${d}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:U.createElement(Qi.Provider,{value:u},U.createElement(vp.Provider,{children:e,value:_}))}function Sz({children:n,location:e}){return uz(w1(n),e)}function w1(n,e=[]){let t=[];return U.Children.forEach(n,(r,i)=>{if(!U.isValidElement(r))return;let a=[...e,i];if(r.type===U.Fragment){t.push.apply(t,w1(r.props.children,a));return}In(r.type===Lo,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),In(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=w1(r.props.children,a)),t.push(o)}),t}var Zm="get",Jm="application/x-www-form-urlencoded";function _v(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function Tz(n){return _v(n)&&n.tagName.toLowerCase()==="button"}function Az(n){return _v(n)&&n.tagName.toLowerCase()==="form"}function Cz(n){return _v(n)&&n.tagName.toLowerCase()==="input"}function Iz(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Rz(n,e){return n.button===0&&(!e||e==="_self")&&!Iz(n)}function E1(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let r=n[t];return e.concat(Array.isArray(r)?r.map(i=>[t,i]):[[t,r]])},[]))}function Dz(n,e){let t=E1(n);return e&&e.forEach((r,i)=>{t.has(i)||e.getAll(i).forEach(a=>{t.append(i,a)})}),t}var Sm=null;function kz(){if(Sm===null)try{new FormData(document.createElement("form"),0),Sm=!1}catch{Sm=!0}return Sm}var Nz=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function _x(n){return n!=null&&!Nz.has(n)?(Ki(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Jm}"`),null):n}function Mz(n,e){let t,r,i,a,o;if(Az(n)){let c=n.getAttribute("action");r=c?zs(c,e):null,t=n.getAttribute("method")||Zm,i=_x(n.getAttribute("enctype"))||Jm,a=new FormData(n)}else if(Tz(n)||Cz(n)&&(n.type==="submit"||n.type==="image")){let c=n.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=n.getAttribute("formaction")||c.getAttribute("action");if(r=u?zs(u,e):null,t=n.getAttribute("formmethod")||c.getAttribute("method")||Zm,i=_x(n.getAttribute("formenctype"))||_x(c.getAttribute("enctype"))||Jm,a=new FormData(c,n),!kz()){let{name:d,type:h,value:p}=n;if(h==="image"){let m=d?`${d}.`:"";a.append(`${m}x`,"0"),a.append(`${m}y`,"0")}else d&&a.append(d,p)}}else{if(_v(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Zm,r=null,i=Jm,o=n}return a&&i==="text/plain"&&(o=a,a=void 0),{action:r,method:t.toLowerCase(),encType:i,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function uw(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Pz(n,e,t,r){let i=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?i.pathname.endsWith("/")?i.pathname=`${i.pathname}_.${r}`:i.pathname=`${i.pathname}.${r}`:i.pathname==="/"?i.pathname=`_root.${r}`:e&&zs(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${r}`,i}async function Oz(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function jz(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function Vz(n,e,t){let r=await Promise.all(n.map(async i=>{let a=e.routes[i.route.id];if(a){let o=await Oz(a,t);return o.links?o.links():[]}return[]}));return Uz(r.flat(1).filter(jz).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function S2(n,e,t,r,i,a){let o=(u,d)=>t[d]?u.route.id!==t[d].route.id:!0,c=(u,d)=>t[d].pathname!==u.pathname||t[d].route.path?.endsWith("*")&&t[d].params["*"]!==u.params["*"];return a==="assets"?e.filter((u,d)=>o(u,d)||c(u,d)):a==="data"?e.filter((u,d)=>{let h=r.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,d)||c(u,d))return!0;if(u.route.shouldRevalidate){let p=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function zz(n,e,{includeHydrateFallback:t}={}){return Lz(n.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function Lz(n){return[...new Set(n)]}function Bz(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function Uz(n,e){let t=new Set;return new Set(e),n.reduce((r,i)=>{let a=JSON.stringify(Bz(i));return t.has(a)||(t.add(a),r.push({key:a,link:i})),r},[])}function hN(){let n=U.useContext(Pd);return uw(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function Fz(){let n=U.useContext(xv);return uw(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var dw=U.createContext(void 0);dw.displayName="FrameworkContext";function pN(){let n=U.useContext(dw);return uw(n,"You must render this element inside a <HydratedRouter> element"),n}function Gz(n,e){let t=U.useContext(dw),[r,i]=U.useState(!1),[a,o]=U.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:d,onMouseLeave:h,onTouchStart:p}=e,m=U.useRef(null);U.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let w=T=>{T.forEach(A=>{o(A.isIntersecting)})},S=new IntersectionObserver(w,{threshold:.5});return m.current&&S.observe(m.current),()=>{S.disconnect()}}},[n]),U.useEffect(()=>{if(r){let w=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(w)}}},[r]);let b=()=>{i(!0)},_=()=>{i(!1),o(!1)};return t?n!=="intent"?[a,m,{}]:[a,m,{onFocus:Wf(c,b),onBlur:Wf(u,_),onMouseEnter:Wf(d,b),onMouseLeave:Wf(h,_),onTouchStart:Wf(p,b)}]:[!1,m,{}]}function Wf(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function qz({page:n,...e}){let{router:t}=hN(),r=U.useMemo(()=>Zk(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?U.createElement($z,{page:n,matches:r,...e}):null}function Hz(n){let{manifest:e,routeModules:t}=pN(),[r,i]=U.useState([]);return U.useEffect(()=>{let a=!1;return Vz(n,e,t).then(o=>{a||i(o)}),()=>{a=!0}},[n,e,t]),r}function $z({page:n,matches:e,...t}){let r=xa(),{future:i,manifest:a,routeModules:o}=pN(),{basename:c}=hN(),{loaderData:u,matches:d}=Fz(),h=U.useMemo(()=>S2(n,e,d,a,r,"data"),[n,e,d,a,r]),p=U.useMemo(()=>S2(n,e,d,a,r,"assets"),[n,e,d,a,r]),m=U.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let w=new Set,S=!1;if(e.forEach(A=>{let D=a.routes[A.route.id];!D||!D.hasLoader||(!h.some(O=>O.route.id===A.route.id)&&A.route.id in u&&o[A.route.id]?.shouldRevalidate||D.hasClientLoader?S=!0:w.add(A.route.id))}),w.size===0)return[];let T=Pz(n,c,i.unstable_trailingSlashAwareDataRequests,"data");return S&&w.size>0&&T.searchParams.set("_routes",e.filter(A=>w.has(A.route.id)).map(A=>A.route.id).join(",")),[T.pathname+T.search]},[c,i.unstable_trailingSlashAwareDataRequests,u,r,a,h,e,n,o]),b=U.useMemo(()=>zz(p,a),[p,a]),_=Hz(p);return U.createElement(U.Fragment,null,m.map(w=>U.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...t})),b.map(w=>U.createElement("link",{key:w,rel:"modulepreload",href:w,...t})),_.map(({key:w,link:S})=>U.createElement("link",{key:w,nonce:t.nonce,...S,crossOrigin:S.crossOrigin??t.crossOrigin})))}function Yz(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var Kz=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Kz&&(window.__reactRouterVersion="7.13.0")}catch{}function Xz({basename:n,children:e,unstable_useTransitions:t,window:r}){let i=U.useRef();i.current==null&&(i.current=C6({window:r,v5Compat:!0}));let a=i.current,[o,c]=U.useState({action:a.action,location:a.location}),u=U.useCallback(d=>{t===!1?c(d):U.startTransition(()=>c(d))},[t]);return U.useLayoutEffect(()=>a.listen(u),[a,u]),U.createElement(Ez,{basename:n,children:e,location:o.location,navigationType:o.action,navigator:a,unstable_useTransitions:t})}var gN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mN=U.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:i,reloadDocument:a,replace:o,state:c,target:u,to:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...b},_){let{basename:w,unstable_useTransitions:S}=U.useContext(Qi),T=typeof d=="string"&&gN.test(d),A=iN(d,w);d=A.to;let D=oz(d,{relative:i}),[O,M,j]=Gz(r,b),C=Jz(d,{replace:o,state:c,target:u,preventScrollReset:h,relative:i,viewTransition:p,unstable_defaultShouldRevalidate:m,unstable_useTransitions:S});function I(z){e&&e(z),z.defaultPrevented||C(z)}let k=U.createElement("a",{...b,...j,href:A.absoluteURL||D,onClick:A.isExternal||a?e:I,ref:Yz(_,M),target:u,"data-discover":!T&&t==="render"?"true":void 0});return O&&!T?U.createElement(U.Fragment,null,k,U.createElement(qz,{page:D})):k});mN.displayName="Link";var Wz=U.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:i=!1,style:a,to:o,viewTransition:c,children:u,...d},h){let p=bp(o,{relative:d.relative}),m=xa(),b=U.useContext(xv),{navigator:_,basename:w}=U.useContext(Qi),S=b!=null&&aL(p)&&c===!0,T=_.encodeLocation?_.encodeLocation(p).pathname:p.pathname,A=m.pathname,D=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;t||(A=A.toLowerCase(),D=D?D.toLowerCase():null,T=T.toLowerCase()),D&&w&&(D=zs(D,w)||D);const O=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let M=A===T||!i&&A.startsWith(T)&&A.charAt(O)==="/",j=D!=null&&(D===T||!i&&D.startsWith(T)&&D.charAt(T.length)==="/"),C={isActive:M,isPending:j,isTransitioning:S},I=M?e:void 0,k;typeof r=="function"?k=r(C):k=[r,M?"active":null,j?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let z=typeof a=="function"?a(C):a;return U.createElement(mN,{...d,"aria-current":I,className:k,ref:h,style:z,to:o,viewTransition:c},typeof u=="function"?u(C):u)});Wz.displayName="NavLink";var Qz=U.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:i,state:a,method:o=Zm,action:c,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...b},_)=>{let{unstable_useTransitions:w}=U.useContext(Qi),S=rL(),T=iL(c,{relative:d}),A=o.toLowerCase()==="get"?"get":"post",D=typeof c=="string"&&gN.test(c),O=M=>{if(u&&u(M),M.defaultPrevented)return;M.preventDefault();let j=M.nativeEvent.submitter,C=j?.getAttribute("formmethod")||o,I=()=>S(j||M.currentTarget,{fetcherKey:e,method:C,navigate:t,replace:i,state:a,relative:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m});w&&t!==!1?U.startTransition(()=>I()):I()};return U.createElement("form",{ref:_,method:A,action:T,onSubmit:r?u:O,...b,"data-discover":!D&&n==="render"?"true":void 0})});Qz.displayName="Form";function Zz(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function vN(n){let e=U.useContext(Pd);return In(e,Zz(n)),e}function Jz(n,{target:e,replace:t,state:r,preventScrollReset:i,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:c,unstable_useTransitions:u}={}){let d=Ks(),h=xa(),p=bp(n,{relative:a});return U.useCallback(m=>{if(Rz(m,e)){m.preventDefault();let b=t!==void 0?t:zh(h)===zh(p),_=()=>d(n,{replace:b,state:r,preventScrollReset:i,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:c});u?U.startTransition(()=>_()):_()}},[h,d,p,t,r,e,n,i,a,o,c,u])}function eL(n){Ki(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=U.useRef(E1(n)),t=U.useRef(!1),r=xa(),i=U.useMemo(()=>Dz(r.search,t.current?null:e.current),[r.search]),a=Ks(),o=U.useCallback((c,u)=>{const d=E1(typeof c=="function"?c(new URLSearchParams(i)):c);t.current=!0,a("?"+d,u)},[a,i]);return[i,o]}var tL=0,nL=()=>`__${String(++tL)}__`;function rL(){let{router:n}=vN("useSubmit"),{basename:e}=U.useContext(Qi),t=bz(),r=n.fetch,i=n.navigate;return U.useCallback(async(a,o={})=>{let{action:c,method:u,encType:d,formData:h,body:p}=Mz(a,e);if(o.navigate===!1){let m=o.fetcherKey||nL();await r(m,t,o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:p,formMethod:o.method||u,formEncType:o.encType||d,flushSync:o.flushSync})}else await i(o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:p,formMethod:o.method||u,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:t,flushSync:o.flushSync,viewTransition:o.viewTransition})},[r,i,e,t])}function iL(n,{relative:e}={}){let{basename:t}=U.useContext(Qi),r=U.useContext(as);In(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),a={...bp(n||".",{relative:e})},o=xa();if(n==null){a.search=o.search;let c=new URLSearchParams(a.search),u=c.getAll("index");if(u.some(h=>h==="")){c.delete("index"),u.filter(p=>p).forEach(p=>c.append("index",p));let h=c.toString();a.search=h?`?${h}`:""}}return(!n||n===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:Ms([t,a.pathname])),zh(a)}function aL(n,{relative:e}={}){let t=U.useContext(sN);In(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=vN("useViewTransitionState"),i=bp(n,{relative:e});if(!t.isTransitioning)return!1;let a=zs(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=zs(t.nextLocation.pathname,r)||t.nextLocation.pathname;return S0(i.pathname,o)!=null||S0(i.pathname,a)!=null}const sL=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),oL=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),T2=n=>{const e=oL(n);return e.charAt(0).toUpperCase()+e.slice(1)},yN=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),lL=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var cL={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const uL=U.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:a,iconNode:o,...c},u)=>U.createElement("svg",{ref:u,...cL,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:yN("lucide",i),...!a&&!lL(c)&&{"aria-hidden":"true"},...c},[...o.map(([d,h])=>U.createElement(d,h)),...Array.isArray(a)?a:[a]]));const nt=(n,e)=>{const t=U.forwardRef(({className:r,...i},a)=>U.createElement(uL,{ref:a,iconNode:e,className:yN(`lucide-${sL(T2(n))}`,`lucide-${n}`,r),...i}));return t.displayName=T2(n),t};const dL=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],od=nt("arrow-left",dL);const fL=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],hL=nt("arrow-right-left",fL);const pL=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],gL=nt("arrow-right",pL);const mL=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],vL=nt("calendar",mL);const yL=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],bL=nt("chart-column",yL);const xL=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],_L=nt("chart-pie",xL);const wL=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],EL=nt("check",wL);const SL=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],TL=nt("chevron-left",SL);const AL=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Cs=nt("chevron-right",AL);const CL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]],IL=nt("circle-arrow-down",CL);const RL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],DL=nt("circle-arrow-up",RL);const kL=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],S1=nt("circle-check-big",kL);const NL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Is=nt("circle-check",NL);const ML=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],A2=nt("circle",ML);const PL=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],C2=nt("dollar-sign",PL);const OL=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],I2=nt("download",OL);const jL=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],bN=nt("ellipsis",jL);const VL=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],zL=nt("eye-off",VL);const LL=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],BL=nt("eye",LL);const UL=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],FL=nt("file-text",UL);const GL=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],qL=nt("folder",GL);const HL=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],$L=nt("funnel",HL);const YL=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],xN=nt("grip-vertical",YL);const KL=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],XL=nt("house",KL);const WL=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],QL=nt("list",WL);const ZL=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],JL=nt("loader-circle",ZL);const e9=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],R2=nt("loader",e9);const t9=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],n9=nt("log-out",t9);const r9=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],T1=nt("mail",r9);const i9=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],a9=nt("pause",i9);const s9=[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]],_c=nt("piggy-bank",s9);const o9=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],mh=nt("plus",o9);const l9=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Lh=nt("refresh-cw",l9);const c9=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],u9=nt("rotate-ccw",c9);const d9=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],f9=nt("search",d9);const h9=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],p9=nt("settings",h9);const g9=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Bh=nt("sparkles",g9);const m9=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],v9=nt("target",m9);const y9=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],A1=nt("trash-2",y9);const b9=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],_N=nt("trash",b9);const x9=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],T0=nt("trending-up",x9);const _9=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ed=nt("triangle-alert",_9);const w9=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],E9=nt("undo-2",w9);const S9=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],T9=nt("upload",S9);const A9=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],C9=nt("user-plus",A9);const I9=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],wv=nt("wallet",I9);const R9=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ev=nt("x",R9),D2=n=>{let e;const t=new Set,r=(d,h)=>{const p=typeof d=="function"?d(e):d;if(!Object.is(p,e)){const m=e;e=h??(typeof p!="object"||p===null)?p:Object.assign({},e,p),t.forEach(b=>b(e,m))}},i=()=>e,c={setState:r,getState:i,getInitialState:()=>u,subscribe:d=>(t.add(d),()=>t.delete(d))},u=e=n(r,i,c);return c},D9=(n=>n?D2(n):D2),k9=n=>n;function N9(n,e=k9){const t=Em.useSyncExternalStore(n.subscribe,Em.useCallback(()=>e(n.getState()),[n,e]),Em.useCallback(()=>e(n.getInitialState()),[n,e]));return Em.useDebugValue(t),t}const k2=n=>{const e=D9(n),t=r=>N9(e,r);return Object.assign(t,e),t},fw=(n=>n?k2(n):k2),N2={BASE_URL:"/personal-budget-pwa/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyDwUA0paVI6n01aENV5Q2aLwVz1DEDtNuA",VITE_FIREBASE_APP_ID:"1:137454342284:web:ab8b52955e6f0ffd42aba9",VITE_FIREBASE_AUTH_DOMAIN:"personal-budget-pwa-5defb.firebaseapp.com",VITE_FIREBASE_MEASUREMENT_ID:"G-BCLXBQHT9L",VITE_FIREBASE_MESSAGING_SENDER_ID:"137454342284",VITE_FIREBASE_PROJECT_ID:"personal-budget-pwa-5defb",VITE_FIREBASE_STORAGE_BUCKET:"personal-budget-pwa-5defb.firebasestorage.app"},Uh=new Map,Tm=n=>{const e=Uh.get(n);return e?Object.fromEntries(Object.entries(e.stores).map(([t,r])=>[t,r.getState()])):{}},M9=(n,e,t)=>{if(n===void 0)return{type:"untracked",connection:e.connect(t)};const r=Uh.get(t.name);if(r)return{type:"tracked",store:n,...r};const i={connection:e.connect(t),stores:{}};return Uh.set(t.name,i),{type:"tracked",store:n,...i}},P9=(n,e)=>{if(e===void 0)return;const t=Uh.get(n);t&&(delete t.stores[e],Object.keys(t.stores).length===0&&Uh.delete(n))},O9=n=>{var e,t;if(!n)return;const r=n.split(`
`),i=r.findIndex(o=>o.includes("api.setState"));if(i<0)return;const a=((e=r[i+1])==null?void 0:e.trim())||"";return(t=/.+ (.+) .+/.exec(a))==null?void 0:t[1]},j9=(n,e={})=>(t,r,i)=>{const{enabled:a,anonymousActionType:o,store:c,...u}=e;let d;try{d=(a??(N2?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!d)return n(t,r,i);const{connection:h,...p}=M9(c,d,u);let m=!0;i.setState=((w,S,T)=>{const A=t(w,S);if(!m)return A;const D=T===void 0?{type:o||O9(new Error().stack)||"anonymous"}:typeof T=="string"?{type:T}:T;return c===void 0?(h?.send(D,r()),A):(h?.send({...D,type:`${c}/${D.type}`},{...Tm(u.name),[c]:i.getState()}),A)}),i.devtools={cleanup:()=>{h&&typeof h.unsubscribe=="function"&&h.unsubscribe(),P9(u.name,c)}};const b=(...w)=>{const S=m;m=!1,t(...w),m=S},_=n(i.setState,r,i);if(p.type==="untracked"?h?.init(_):(p.stores[p.store]=i,h?.init(Object.fromEntries(Object.entries(p.stores).map(([w,S])=>[w,w===p.store?_:S.getState()])))),i.dispatchFromDevtools&&typeof i.dispatch=="function"){let w=!1;const S=i.dispatch;i.dispatch=(...T)=>{(N2?"production":void 0)!=="production"&&T[0].type==="__setState"&&!w&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),w=!0),S(...T)}}return h.subscribe(w=>{var S;switch(w.type){case"ACTION":if(typeof w.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return wx(w.payload,T=>{if(T.type==="__setState"){if(c===void 0){b(T.state);return}Object.keys(T.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const A=T.state[c];if(A==null)return;JSON.stringify(i.getState())!==JSON.stringify(A)&&b(A);return}i.dispatchFromDevtools&&typeof i.dispatch=="function"&&i.dispatch(T)});case"DISPATCH":switch(w.payload.type){case"RESET":return b(_),c===void 0?h?.init(i.getState()):h?.init(Tm(u.name));case"COMMIT":if(c===void 0){h?.init(i.getState());return}return h?.init(Tm(u.name));case"ROLLBACK":return wx(w.state,T=>{if(c===void 0){b(T),h?.init(i.getState());return}b(T[c]),h?.init(Tm(u.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return wx(w.state,T=>{if(c===void 0){b(T);return}JSON.stringify(i.getState())!==JSON.stringify(T[c])&&b(T[c])});case"IMPORT_STATE":{const{nextLiftedState:T}=w.payload,A=(S=T.computedStates.slice(-1)[0])==null?void 0:S.state;if(!A)return;b(c===void 0?A:A[c]),h?.send(null,T);return}case"PAUSE_RECORDING":return m=!m}return}}),_},V9=j9,wx=(n,e)=>{let t;try{t=JSON.parse(n)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}t!==void 0&&e(t)};function z9(n,e){let t;try{t=n()}catch{return}return{getItem:i=>{var a;const o=u=>u===null?null:JSON.parse(u,void 0),c=(a=t.getItem(i))!=null?a:null;return c instanceof Promise?c.then(o):o(c)},setItem:(i,a)=>t.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>t.removeItem(i)}}const C1=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return C1(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return C1(r)(t)}}}},L9=(n,e)=>(t,r,i)=>{let a={storage:z9(()=>localStorage),partialize:w=>w,version:0,merge:(w,S)=>({...S,...w}),...e},o=!1;const c=new Set,u=new Set;let d=a.storage;if(!d)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(...w)},r,i);const h=()=>{const w=a.partialize({...r()});return d.setItem(a.name,{state:w,version:a.version})},p=i.setState;i.setState=(w,S)=>(p(w,S),h());const m=n((...w)=>(t(...w),h()),r,i);i.getInitialState=()=>m;let b;const _=()=>{var w,S;if(!d)return;o=!1,c.forEach(A=>{var D;return A((D=r())!=null?D:m)});const T=((S=a.onRehydrateStorage)==null?void 0:S.call(a,(w=r())!=null?w:m))||void 0;return C1(d.getItem.bind(d))(a.name).then(A=>{if(A)if(typeof A.version=="number"&&A.version!==a.version){if(a.migrate){const D=a.migrate(A.state,A.version);return D instanceof Promise?D.then(O=>[!0,O]):[!0,D]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,A.state];return[!1,void 0]}).then(A=>{var D;const[O,M]=A;if(b=a.merge(M,(D=r())!=null?D:m),t(b,!0),O)return h()}).then(()=>{T?.(b,void 0),b=r(),o=!0,u.forEach(A=>A(b))}).catch(A=>{T?.(void 0,A)})};return i.persist={setOptions:w=>{a={...a,...w},w.storage&&(d=w.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:w=>(c.add(w),()=>{c.delete(w)}),onFinishHydration:w=>(u.add(w),()=>{u.delete(w)})},a.skipHydration||_(),b||m},wN=L9,B9=()=>{};var M2={};const EN=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},U9=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=n[t++];e[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=n[t++],o=n[t++],c=n[t++],u=((i&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const a=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return e.join("")},SN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const a=n[i],o=i+1<n.length,c=o?n[i+1]:0,u=i+2<n.length,d=u?n[i+2]:0,h=a>>2,p=(a&3)<<4|c>>4;let m=(c&15)<<2|d>>6,b=d&63;u||(b=64,o||(m=64)),r.push(t[h],t[p],t[m],t[b])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(EN(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):U9(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const a=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;const d=i<n.length?t[n.charAt(i)]:64;++i;const p=i<n.length?t[n.charAt(i)]:64;if(++i,a==null||c==null||d==null||p==null)throw new F9;const m=a<<2|c>>4;if(r.push(m),d!==64){const b=c<<4&240|d>>2;if(r.push(b),p!==64){const _=d<<6&192|p;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class F9 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const G9=function(n){const e=EN(n);return SN.encodeByteArray(e,!0)},A0=function(n){return G9(n).replace(/\./g,"")},TN=function(n){try{return SN.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function AN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const q9=()=>AN().__FIREBASE_DEFAULTS__,H9=()=>{if(typeof process>"u"||typeof M2>"u")return;const n=M2.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},$9=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&TN(n[1]);return e&&JSON.parse(e)},Sv=()=>{try{return B9()||q9()||H9()||$9()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},CN=n=>Sv()?.emulatorHosts?.[n],Y9=n=>{const e=CN(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},IN=()=>Sv()?.config,RN=n=>Sv()?.[`_${n}`];class K9{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Od(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function DN(n){return(await fetch(n,{credentials:"include"})).ok}function X9(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...n};return[A0(JSON.stringify(t)),A0(JSON.stringify(o)),""].join(".")}const vh={};function W9(){const n={prod:[],emulator:[]};for(const e of Object.keys(vh))vh[e]?n.emulator.push(e):n.prod.push(e);return n}function Q9(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let P2=!1;function kN(n,e){if(typeof window>"u"||typeof document>"u"||!Od(window.location.host)||vh[n]===e||vh[n]||P2)return;vh[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",a=W9().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function c(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,b){m.setAttribute("width","24"),m.setAttribute("id",b),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{P2=!0,o()},m}function h(m,b){m.setAttribute("id",b),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=Q9(r),b=t("text"),_=document.getElementById(b)||document.createElement("span"),w=t("learnmore"),S=document.getElementById(w)||document.createElement("a"),T=t("preprendIcon"),A=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const D=m.element;c(D),h(S,w);const O=d();u(A,T),D.append(A,_,S,O),document.body.appendChild(D)}a?(_.innerText="Preview backend disconnected.",A.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(A.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function fr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Z9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(fr())}function NN(){const n=Sv()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function J9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function eB(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function tB(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function nB(){const n=fr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function MN(){return!NN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function PN(){return!NN()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function ON(){try{return typeof indexedDB=="object"}catch{return!1}}function rB(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const iB="FirebaseError";class Xs extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=iB,Object.setPrototypeOf(this,Xs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xp.prototype.create)}}class xp{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,a=this.errors[e],o=a?aB(a,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new Xs(i,c,r)}}function aB(n,e){return n.replace(sB,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const sB=/\{\$([^}]+)}/g;function oB(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function il(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const a=n[i],o=e[i];if(O2(a)&&O2(o)){if(!il(a,o))return!1}else if(a!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function O2(n){return n!==null&&typeof n=="object"}function _p(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ih(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,a]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function ah(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function lB(n,e){const t=new cB(n,e);return t.subscribe.bind(t)}class cB{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");uB(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Ex),i.error===void 0&&(i.error=Ex),i.complete===void 0&&(i.complete=Ex);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function uB(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ex(){}function vn(n){return n&&n._delegate?n._delegate:n}let wc=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};const Xl="[DEFAULT]";let dB=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new K9;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(hB(e))try{this.getOrInitializeService({instanceIdentifier:Xl})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:i});r.resolve(a)}catch{}}}}clearInstance(e=Xl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Xl){return this.instances.has(e)}getOptions(e=Xl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);r===c&&o.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const a=this.instances.get(r);return a&&e(a,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:fB(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Xl){return this.component?this.component.multipleInstances?e:Xl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function fB(n){return n===Xl?void 0:n}function hB(n){return n.instantiationMode==="EAGER"}class pB{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new dB(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var At;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(At||(At={}));const gB={debug:At.DEBUG,verbose:At.VERBOSE,info:At.INFO,warn:At.WARN,error:At.ERROR,silent:At.SILENT},mB=At.INFO,vB={[At.DEBUG]:"log",[At.VERBOSE]:"log",[At.INFO]:"info",[At.WARN]:"warn",[At.ERROR]:"error"},yB=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=vB[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class hw{constructor(e){this.name=e,this._logLevel=mB,this._logHandler=yB,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in At))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?gB[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,At.DEBUG,...e),this._logHandler(this,At.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,At.VERBOSE,...e),this._logHandler(this,At.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,At.INFO,...e),this._logHandler(this,At.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,At.WARN,...e),this._logHandler(this,At.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,At.ERROR,...e),this._logHandler(this,At.ERROR,...e)}}const bB=(n,e)=>e.some(t=>n instanceof t);let j2,V2;function xB(){return j2||(j2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _B(){return V2||(V2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const jN=new WeakMap,I1=new WeakMap,VN=new WeakMap,Sx=new WeakMap,pw=new WeakMap;function wB(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",a),n.removeEventListener("error",o)},a=()=>{t(Qo(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",a),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&jN.set(t,n)}).catch(()=>{}),pw.set(e,n),e}function EB(n){if(I1.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",o),n.removeEventListener("abort",o)},a=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",a),n.addEventListener("error",o),n.addEventListener("abort",o)});I1.set(n,e)}let R1={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return I1.get(n);if(e==="objectStoreNames")return n.objectStoreNames||VN.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Qo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function SB(n){R1=n(R1)}function TB(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Tx(this),e,...t);return VN.set(r,e.sort?e.sort():[e]),Qo(r)}:_B().includes(n)?function(...e){return n.apply(Tx(this),e),Qo(jN.get(this))}:function(...e){return Qo(n.apply(Tx(this),e))}}function AB(n){return typeof n=="function"?TB(n):(n instanceof IDBTransaction&&EB(n),bB(n,xB())?new Proxy(n,R1):n)}function Qo(n){if(n instanceof IDBRequest)return wB(n);if(Sx.has(n))return Sx.get(n);const e=AB(n);return e!==n&&(Sx.set(n,e),pw.set(e,n)),e}const Tx=n=>pw.get(n);function CB(n,e,{blocked:t,upgrade:r,blocking:i,terminated:a}={}){const o=indexedDB.open(n,e),c=Qo(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Qo(o.result),u.oldVersion,u.newVersion,Qo(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{a&&u.addEventListener("close",()=>a()),i&&u.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const IB=["get","getKey","getAll","getAllKeys","count"],RB=["put","add","delete","clear"],Ax=new Map;function z2(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ax.get(e))return Ax.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=RB.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||IB.includes(t)))return;const a=async function(o,...c){const u=this.transaction(o,i?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[t](...c),i&&u.done]))[0]};return Ax.set(e,a),a}SB(n=>({...n,get:(e,t,r)=>z2(e,t)||n.get(e,t,r),has:(e,t)=>!!z2(e,t)||n.has(e,t)}));class DB{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(kB(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function kB(n){return n.getComponent()?.type==="VERSION"}const D1="@firebase/app",L2="0.14.6";const Ls=new hw("@firebase/app"),NB="@firebase/app-compat",MB="@firebase/analytics-compat",PB="@firebase/analytics",OB="@firebase/app-check-compat",jB="@firebase/app-check",VB="@firebase/auth",zB="@firebase/auth-compat",LB="@firebase/database",BB="@firebase/data-connect",UB="@firebase/database-compat",FB="@firebase/functions",GB="@firebase/functions-compat",qB="@firebase/installations",HB="@firebase/installations-compat",$B="@firebase/messaging",YB="@firebase/messaging-compat",KB="@firebase/performance",XB="@firebase/performance-compat",WB="@firebase/remote-config",QB="@firebase/remote-config-compat",ZB="@firebase/storage",JB="@firebase/storage-compat",e8="@firebase/firestore",t8="@firebase/ai",n8="@firebase/firestore-compat",r8="firebase",i8="12.6.0";const k1="[DEFAULT]",a8={[D1]:"fire-core",[NB]:"fire-core-compat",[PB]:"fire-analytics",[MB]:"fire-analytics-compat",[jB]:"fire-app-check",[OB]:"fire-app-check-compat",[VB]:"fire-auth",[zB]:"fire-auth-compat",[LB]:"fire-rtdb",[BB]:"fire-data-connect",[UB]:"fire-rtdb-compat",[FB]:"fire-fn",[GB]:"fire-fn-compat",[qB]:"fire-iid",[HB]:"fire-iid-compat",[$B]:"fire-fcm",[YB]:"fire-fcm-compat",[KB]:"fire-perf",[XB]:"fire-perf-compat",[WB]:"fire-rc",[QB]:"fire-rc-compat",[ZB]:"fire-gcs",[JB]:"fire-gcs-compat",[e8]:"fire-fst",[n8]:"fire-fst-compat",[t8]:"fire-vertex","fire-js":"fire-js",[r8]:"fire-js-all"};const C0=new Map,s8=new Map,N1=new Map;function B2(n,e){try{n.container.addComponent(e)}catch(t){Ls.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ld(n){const e=n.name;if(N1.has(e))return Ls.debug(`There were multiple attempts to register component ${e}.`),!1;N1.set(e,n);for(const t of C0.values())B2(t,n);for(const t of s8.values())B2(t,n);return!0}function gw(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ui(n){return n==null?!1:n.settings!==void 0}const o8={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Zo=new xp("app","Firebase",o8);class l8{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new wc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Zo.create("app-deleted",{appName:this._name})}}const jd=i8;function zN(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:k1,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Zo.create("bad-app-name",{appName:String(i)});if(t||(t=IN()),!t)throw Zo.create("no-options");const a=C0.get(i);if(a){if(il(t,a.options)&&il(r,a.config))return a;throw Zo.create("duplicate-app",{appName:i})}const o=new pB(i);for(const u of N1.values())o.addComponent(u);const c=new l8(t,r,o);return C0.set(i,c),c}function LN(n=k1){const e=C0.get(n);if(!e&&n===k1&&IN())return zN();if(!e)throw Zo.create("no-app",{appName:n});return e}function Jo(n,e,t){let r=a8[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ls.warn(o.join(" "));return}ld(new wc(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const c8="firebase-heartbeat-database",u8=1,Fh="firebase-heartbeat-store";let Cx=null;function BN(){return Cx||(Cx=CB(c8,u8,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Fh)}catch(t){console.warn(t)}}}}).catch(n=>{throw Zo.create("idb-open",{originalErrorMessage:n.message})})),Cx}async function d8(n){try{const t=(await BN()).transaction(Fh),r=await t.objectStore(Fh).get(UN(n));return await t.done,r}catch(e){if(e instanceof Xs)Ls.warn(e.message);else{const t=Zo.create("idb-get",{originalErrorMessage:e?.message});Ls.warn(t.message)}}}async function U2(n,e){try{const r=(await BN()).transaction(Fh,"readwrite");await r.objectStore(Fh).put(e,UN(n)),await r.done}catch(t){if(t instanceof Xs)Ls.warn(t.message);else{const r=Zo.create("idb-set",{originalErrorMessage:t?.message});Ls.warn(r.message)}}}function UN(n){return`${n.name}!${n.options.appId}`}const f8=1024,h8=30;class p8{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new m8(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=F2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>h8){const i=v8(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ls.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=F2(),{heartbeatsToSend:t,unsentEntries:r}=g8(this._heartbeatsCache.heartbeats),i=A0(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Ls.warn(e),""}}}function F2(){return new Date().toISOString().substring(0,10)}function g8(n,e=f8){const t=[];let r=n.slice();for(const i of n){const a=t.find(o=>o.agent===i.agent);if(a){if(a.dates.push(i.date),G2(t)>e){a.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),G2(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class m8{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ON()?rB().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await d8(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return U2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return U2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function G2(n){return A0(JSON.stringify({version:2,heartbeats:n})).length}function v8(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function y8(n){ld(new wc("platform-logger",e=>new DB(e),"PRIVATE")),ld(new wc("heartbeat",e=>new p8(e),"PRIVATE")),Jo(D1,L2,n),Jo(D1,L2,"esm2020"),Jo("fire-js","")}y8("");function FN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const b8=FN,GN=new xp("auth","Firebase",FN());const I0=new hw("@firebase/auth");function x8(n,...e){I0.logLevel<=At.WARN&&I0.warn(`Auth (${jd}): ${n}`,...e)}function e0(n,...e){I0.logLevel<=At.ERROR&&I0.error(`Auth (${jd}): ${n}`,...e)}function ma(n,...e){throw mw(n,...e)}function Ka(n,...e){return mw(n,...e)}function qN(n,e,t){const r={...b8(),[e]:t};return new xp("auth","Firebase",r).create(e,{appName:n.name})}function Ps(n){return qN(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function mw(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return GN.create(n,...e)}function Je(n,e,...t){if(!n)throw mw(e,...t)}function Rs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw e0(e),new Error(e)}function Bs(n,e){n||Rs(e)}function M1(){return typeof self<"u"&&self.location?.href||""}function _8(){return q2()==="http:"||q2()==="https:"}function q2(){return typeof self<"u"&&self.location?.protocol||null}function w8(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(_8()||eB()||"connection"in navigator)?navigator.onLine:!0}function E8(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class wp{constructor(e,t){this.shortDelay=e,this.longDelay=t,Bs(t>e,"Short delay should be less than long delay!"),this.isMobile=Z9()||tB()}get(){return w8()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function vw(n,e){Bs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class HN{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Rs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Rs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Rs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const S8={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const T8=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],A8=new wp(3e4,6e4);function Ws(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function ss(n,e,t,r,i={}){return $N(n,i,async()=>{let a={},o={};r&&(e==="GET"?o=r:a={body:JSON.stringify(r)});const c=_p({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const d={method:e,headers:u,...a};return J9()||(d.referrerPolicy="no-referrer"),n.emulatorConfig&&Od(n.emulatorConfig.host)&&(d.credentials="include"),HN.fetch()(await YN(n,n.config.apiHost,t,c),d)})}async function $N(n,e,t){n._canInitEmulator=!1;const r={...S8,...e};try{const i=new I8(n),a=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw Am(n,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const c=a.ok?o.errorMessage:o.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Am(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Am(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Am(n,"user-disabled",o);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw qN(n,h,d);ma(n,h)}}catch(i){if(i instanceof Xs)throw i;ma(n,"network-request-failed",{message:String(i)})}}async function Ep(n,e,t,r,i={}){const a=await ss(n,e,t,r,i);return"mfaPendingCredential"in a&&ma(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function YN(n,e,t,r){const i=`${e}${t}?${r}`,a=n,o=a.config.emulator?vw(n.config,i):`${n.config.apiScheme}://${i}`;return T8.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(o).toString():o}function C8(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class I8{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ka(this.auth,"network-request-failed")),A8.get())})}}function Am(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=Ka(n,e,r);return i.customData._tokenResponse=t,i}function H2(n){return n!==void 0&&n.enterprise!==void 0}class R8{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return C8(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function D8(n,e){return ss(n,"GET","/v2/recaptchaConfig",Ws(n,e))}async function k8(n,e){return ss(n,"POST","/v1/accounts:delete",e)}async function R0(n,e){return ss(n,"POST","/v1/accounts:lookup",e)}function yh(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function N8(n,e=!1){const t=vn(n),r=await t.getIdToken(e),i=yw(r);Je(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,o=a?.sign_in_provider;return{claims:i,token:r,authTime:yh(Ix(i.auth_time)),issuedAtTime:yh(Ix(i.iat)),expirationTime:yh(Ix(i.exp)),signInProvider:o||null,signInSecondFactor:a?.sign_in_second_factor||null}}function Ix(n){return Number(n)*1e3}function yw(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return e0("JWT malformed, contained fewer than 3 sections"),null;try{const i=TN(t);return i?JSON.parse(i):(e0("Failed to decode base64 JWT payload"),null)}catch(i){return e0("Caught error parsing JWT payload as JSON",i?.toString()),null}}function $2(n){const e=yw(n);return Je(e,"internal-error"),Je(typeof e.exp<"u","internal-error"),Je(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function cd(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Xs&&M8(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function M8({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class P8{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class P1{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=yh(this.lastLoginAt),this.creationTime=yh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function D0(n){const e=n.auth,t=await n.getIdToken(),r=await cd(n,R0(e,{idToken:t}));Je(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const a=i.providerUserInfo?.length?KN(i.providerUserInfo):[],o=j8(n.providerData,a),c=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!o?.length,d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new P1(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,h)}async function O8(n){const e=vn(n);await D0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function j8(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function KN(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function V8(n,e){const t=await $N(n,{},async()=>{const r=_p({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=n.config,o=await YN(n,i,"/v1/token",`key=${a}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:r};return n.emulatorConfig&&Od(n.emulatorConfig.host)&&(u.credentials="include"),HN.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function z8(n,e){return ss(n,"POST","/v2/accounts:revokeToken",Ws(n,e))}class td{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Je(e.idToken,"internal-error"),Je(typeof e.idToken<"u","internal-error"),Je(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):$2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Je(e.length!==0,"internal-error");const t=$2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Je(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:a}=await V8(e,t);this.updateTokensAndExpiration(r,i,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:a}=t,o=new td;return r&&(Je(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Je(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),a&&(Je(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new td,this.toJSON())}_performRefresh(){return Rs("not implemented")}}function Mo(n,e){Je(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class da{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new P8(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new P1(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await cd(this,this.stsTokenManager.getToken(this.auth,e));return Je(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return N8(this,e)}reload(){return O8(this)}_assign(e){this!==e&&(Je(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new da({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Je(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await D0(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ui(this.auth.app))return Promise.reject(Ps(this.auth));const e=await this.getIdToken();return await cd(this,k8(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,a=t.phoneNumber??void 0,o=t.photoURL??void 0,c=t.tenantId??void 0,u=t._redirectEventId??void 0,d=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:b,providerData:_,stsTokenManager:w}=t;Je(p&&w,e,"internal-error");const S=td.fromJSON(this.name,w);Je(typeof p=="string",e,"internal-error"),Mo(r,e.name),Mo(i,e.name),Je(typeof m=="boolean",e,"internal-error"),Je(typeof b=="boolean",e,"internal-error"),Mo(a,e.name),Mo(o,e.name),Mo(c,e.name),Mo(u,e.name),Mo(d,e.name),Mo(h,e.name);const T=new da({uid:p,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:b,photoURL:o,phoneNumber:a,tenantId:c,stsTokenManager:S,createdAt:d,lastLoginAt:h});return _&&Array.isArray(_)&&(T.providerData=_.map(A=>({...A}))),u&&(T._redirectEventId=u),T}static async _fromIdTokenResponse(e,t,r=!1){const i=new td;i.updateFromServerResponse(t);const a=new da({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await D0(a),a}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Je(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?KN(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!a?.length,c=new td;c.updateFromIdToken(r);const u=new da({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new P1(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(u,d),u}}const Y2=new Map;function Ds(n){Bs(n instanceof Function,"Expected a class definition");let e=Y2.get(n);return e?(Bs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Y2.set(n,e),e)}class XN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}XN.type="NONE";const K2=XN;function t0(n,e,t){return`firebase:${n}:${e}:${t}`}class nd{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:a}=this.auth;this.fullUserKey=t0(this.userKey,i.apiKey,a),this.fullPersistenceKey=t0("persistence",i.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await R0(this.auth,{idToken:e}).catch(()=>{});return t?da._fromGetAccountInfoResponse(this.auth,t,e):null}return da._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new nd(Ds(K2),e,r);const i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let a=i[0]||Ds(K2);const o=t0(r,e.config.apiKey,e.name);let c=null;for(const d of t)try{const h=await d._get(o);if(h){let p;if(typeof h=="string"){const m=await R0(e,{idToken:h}).catch(()=>{});if(!m)break;p=await da._fromGetAccountInfoResponse(e,m,h)}else p=da._fromJSON(e,h);d!==a&&(c=p),a=d;break}}catch{}const u=i.filter(d=>d._shouldAllowMigration);return!a._shouldAllowMigration||!u.length?new nd(a,e,r):(a=u[0],c&&await a._set(o,c.toJSON()),await Promise.all(t.map(async d=>{if(d!==a)try{await d._remove(o)}catch{}})),new nd(a,e,r))}}function X2(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(JN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(WN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(tM(e))return"Blackberry";if(nM(e))return"Webos";if(QN(e))return"Safari";if((e.includes("chrome/")||ZN(e))&&!e.includes("edge/"))return"Chrome";if(eM(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function WN(n=fr()){return/firefox\//i.test(n)}function QN(n=fr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ZN(n=fr()){return/crios\//i.test(n)}function JN(n=fr()){return/iemobile/i.test(n)}function eM(n=fr()){return/android/i.test(n)}function tM(n=fr()){return/blackberry/i.test(n)}function nM(n=fr()){return/webos/i.test(n)}function bw(n=fr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function L8(n=fr()){return bw(n)&&!!window.navigator?.standalone}function B8(){return nB()&&document.documentMode===10}function rM(n=fr()){return bw(n)||eM(n)||nM(n)||tM(n)||/windows phone/i.test(n)||JN(n)}function iM(n,e=[]){let t;switch(n){case"Browser":t=X2(fr());break;case"Worker":t=`${X2(fr())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${jd}/${r}`}class U8{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((o,c)=>{try{const u=e(a);o(u)}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function F8(n,e={}){return ss(n,"GET","/v2/passwordPolicy",Ws(n,e))}const G8=6;class q8{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??G8,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class H8{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new W2(this),this.idTokenSubscription=new W2(this),this.beforeStateQueue=new U8(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=GN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ds(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await nd.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await R0(this,{idToken:e}),r=await da._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ui(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,o=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===o)&&c?.user&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Je(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await D0(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=E8()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ui(this.app))return Promise.reject(Ps(this));const t=e?vn(e):null;return t&&Je(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Je(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ui(this.app)?Promise.reject(Ps(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ui(this.app)?Promise.reject(Ps(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ds(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await F8(this),t=new q8(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new xp("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await z8(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ds(e)||this._popupRedirectResolver;Je(t,this,"argument-error"),this.redirectPersistenceManager=await nd.create(this,[Ds(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(Je(c,this,"internal-error"),c.then(()=>{o||a(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,i);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Je(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=iM(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Ui(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&x8(`Error while retrieving App Check token: ${e.error}`),e?.token}}function gl(n){return vn(n)}class W2{constructor(e){this.auth=e,this.observer=null,this.addObserver=lB(t=>this.observer=t)}get next(){return Je(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Tv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $8(n){Tv=n}function aM(n){return Tv.loadJS(n)}function Y8(){return Tv.recaptchaEnterpriseScript}function K8(){return Tv.gapiScript}function X8(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class W8{constructor(){this.enterprise=new Q8}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Q8{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Z8="recaptcha-enterprise",sM="NO_RECAPTCHA";class J8{constructor(e){this.type=Z8,this.auth=gl(e)}async verify(e="verify",t=!1){async function r(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,c)=>{D8(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new R8(u);return a.tenantId==null?a._agentRecaptchaConfig=d:a._tenantRecaptchaConfigs[a.tenantId]=d,o(d.siteKey)}}).catch(u=>{c(u)})})}function i(a,o,c){const u=window.grecaptcha;H2(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:e}).then(d=>{o(d)}).catch(()=>{o(sM)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new W8().execute("siteKey",{action:"verify"}):new Promise((a,o)=>{r(this.auth).then(c=>{if(!t&&H2(window.grecaptcha))i(c,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=Y8();u.length!==0&&(u+=c),aM(u).then(()=>{i(c,a,o)}).catch(d=>{o(d)})}}).catch(c=>{o(c)})})}}async function Q2(n,e,t,r=!1,i=!1){const a=new J8(n);let o;if(i)o=sM;else try{o=await a.verify(t)}catch{o=await a.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function k0(n,e,t,r,i){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Q2(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Q2(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(a)})}function eU(n,e){const t=gw(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),a=t.getOptions();if(il(a,e??{}))return i;ma(i,"already-initialized")}return t.initialize({options:e})}function tU(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Ds);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function nU(n,e,t){const r=gl(n);Je(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,a=oM(e),{host:o,port:c}=rU(e),u=c===null?"":`:${c}`,d={url:`${a}//${o}${u}/`},h=Object.freeze({host:o,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Je(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Je(il(d,r.config.emulator)&&il(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Od(o)?(DN(`${a}//${o}${u}`),kN("Auth",!0)):iU()}function oM(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function rU(n){const e=oM(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const a=i[1];return{host:a,port:Z2(r.substr(a.length+1))}}else{const[a,o]=r.split(":");return{host:a,port:Z2(o)}}}function Z2(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function iU(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class xw{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Rs("not implemented")}_getIdTokenResponse(e){return Rs("not implemented")}_linkToIdToken(e,t){return Rs("not implemented")}_getReauthenticationResolver(e){return Rs("not implemented")}}async function aU(n,e){return ss(n,"POST","/v1/accounts:signUp",e)}async function sU(n,e){return Ep(n,"POST","/v1/accounts:signInWithPassword",Ws(n,e))}async function lM(n,e){return ss(n,"POST","/v1/accounts:sendOobCode",Ws(n,e))}async function oU(n,e){return lM(n,e)}async function lU(n,e){return lM(n,e)}async function cU(n,e){return Ep(n,"POST","/v1/accounts:signInWithEmailLink",Ws(n,e))}async function uU(n,e){return Ep(n,"POST","/v1/accounts:signInWithEmailLink",Ws(n,e))}class Gh extends xw{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Gh(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Gh(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return k0(e,t,"signInWithPassword",sU);case"emailLink":return cU(e,{email:this._email,oobCode:this._password});default:ma(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return k0(e,r,"signUpPassword",aU);case"emailLink":return uU(e,{idToken:t,email:this._email,oobCode:this._password});default:ma(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function rd(n,e){return Ep(n,"POST","/v1/accounts:signInWithIdp",Ws(n,e))}const dU="http://localhost";class Ec extends xw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ec(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ma("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...a}=t;if(!r||!i)return null;const o=new Ec(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return rd(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,rd(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,rd(e,t)}buildRequest(){const e={requestUri:dU,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=_p(t)}return e}}function fU(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function hU(n){const e=ih(ah(n)).link,t=e?ih(ah(e)).deep_link_id:null,r=ih(ah(n)).deep_link_id;return(r?ih(ah(r)).link:null)||r||t||e||n}class _w{constructor(e){const t=ih(ah(e)),r=t.apiKey??null,i=t.oobCode??null,a=fU(t.mode??null);Je(r&&i&&a,"argument-error"),this.apiKey=r,this.operation=a,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=hU(e);try{return new _w(t)}catch{return null}}}class Lc{constructor(){this.providerId=Lc.PROVIDER_ID}static credential(e,t){return Gh._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=_w.parseLink(t);return Je(r,"argument-error"),Gh._fromEmailAndCode(e,r.code,r.tenantId)}}Lc.PROVIDER_ID="password";Lc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Lc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class cM{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Sp extends cM{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Fo extends Sp{constructor(){super("facebook.com")}static credential(e){return Ec._fromParams({providerId:Fo.PROVIDER_ID,signInMethod:Fo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fo.credentialFromTaggedObject(e)}static credentialFromError(e){return Fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fo.credential(e.oauthAccessToken)}catch{return null}}}Fo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Fo.PROVIDER_ID="facebook.com";class Go extends Sp{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ec._fromParams({providerId:Go.PROVIDER_ID,signInMethod:Go.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Go.credentialFromTaggedObject(e)}static credentialFromError(e){return Go.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Go.credential(t,r)}catch{return null}}}Go.GOOGLE_SIGN_IN_METHOD="google.com";Go.PROVIDER_ID="google.com";class qo extends Sp{constructor(){super("github.com")}static credential(e){return Ec._fromParams({providerId:qo.PROVIDER_ID,signInMethod:qo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qo.credentialFromTaggedObject(e)}static credentialFromError(e){return qo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qo.credential(e.oauthAccessToken)}catch{return null}}}qo.GITHUB_SIGN_IN_METHOD="github.com";qo.PROVIDER_ID="github.com";class Ho extends Sp{constructor(){super("twitter.com")}static credential(e,t){return Ec._fromParams({providerId:Ho.PROVIDER_ID,signInMethod:Ho.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ho.credentialFromTaggedObject(e)}static credentialFromError(e){return Ho.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Ho.credential(t,r)}catch{return null}}}Ho.TWITTER_SIGN_IN_METHOD="twitter.com";Ho.PROVIDER_ID="twitter.com";async function pU(n,e){return Ep(n,"POST","/v1/accounts:signUp",Ws(n,e))}class Sc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const a=await da._fromIdTokenResponse(e,r,i),o=J2(r);return new Sc({user:a,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=J2(r);return new Sc({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function J2(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class N0 extends Xs{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,N0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new N0(e,t,r,i)}}function uM(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?N0._fromErrorAndOperation(n,a,e,r):a})}async function gU(n,e,t=!1){const r=await cd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Sc._forOperation(n,"link",r)}async function dM(n,e,t=!1){const{auth:r}=n;if(Ui(r.app))return Promise.reject(Ps(r));const i="reauthenticate";try{const a=await cd(n,uM(r,i,e,n),t);Je(a.idToken,r,"internal-error");const o=yw(a.idToken);Je(o,r,"internal-error");const{sub:c}=o;return Je(n.uid===c,r,"user-mismatch"),Sc._forOperation(n,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&ma(r,"user-mismatch"),a}}async function fM(n,e,t=!1){if(Ui(n.app))return Promise.reject(Ps(n));const r="signIn",i=await uM(n,r,e),a=await Sc._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(a.user),a}async function mU(n,e){return fM(gl(n),e)}async function vU(n,e){return dM(vn(n),e)}async function hM(n){const e=gl(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function yU(n,e,t){const r=gl(n);await k0(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",lU)}async function bU(n,e,t){if(Ui(n.app))return Promise.reject(Ps(n));const r=gl(n),o=await k0(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",pU).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&hM(n),u}),c=await Sc._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(c.user),c}function xU(n,e,t){return Ui(n.app)?Promise.reject(Ps(n)):mU(vn(n),Lc.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&hM(n),r})}async function eI(n,e){const t=vn(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()},{email:a}=await oU(t.auth,i);a!==n.email&&await n.reload()}async function _U(n,e){return ss(n,"POST","/v1/accounts:update",e)}async function wU(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=vn(n),a={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await cd(r,_U(r.auth,a));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const c=r.providerData.find(({providerId:u})=>u==="password");c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function EU(n,e,t,r){return vn(n).onIdTokenChanged(e,t,r)}function SU(n,e,t){return vn(n).beforeAuthStateChanged(e,t)}function TU(n,e,t,r){return vn(n).onAuthStateChanged(e,t,r)}function tI(n){return vn(n).signOut()}async function AU(n){return vn(n).delete()}const M0="__sak";class pM{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(M0,"1"),this.storage.removeItem(M0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const CU=1e3,IU=10;class gM extends pM{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=rM(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},a=this.storage.getItem(r);B8()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,IU):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},CU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}gM.type="LOCAL";const RU=gM;class mM extends pM{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}mM.type="SESSION";const vM=mM;function DU(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Av{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Av(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:a}=t.data,o=this.handlersMap[i];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const c=Array.from(o).map(async d=>d(t.origin,a)),u=await DU(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Av.receivers=[];function ww(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class kU{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,o;return new Promise((c,u)=>{const d=ww("",20);i.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const m=p;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),a=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(m.data.response);break;default:clearTimeout(h),clearTimeout(a),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Xa(){return window}function NU(n){Xa().location.href=n}function yM(){return typeof Xa().WorkerGlobalScope<"u"&&typeof Xa().importScripts=="function"}async function MU(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function PU(){return navigator?.serviceWorker?.controller||null}function OU(){return yM()?self:null}const bM="firebaseLocalStorageDb",jU=1,P0="firebaseLocalStorage",xM="fbase_key";class Tp{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Cv(n,e){return n.transaction([P0],e?"readwrite":"readonly").objectStore(P0)}function VU(){const n=indexedDB.deleteDatabase(bM);return new Tp(n).toPromise()}function O1(){const n=indexedDB.open(bM,jU);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(P0,{keyPath:xM})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(P0)?e(r):(r.close(),await VU(),e(await O1()))})})}async function nI(n,e,t){const r=Cv(n,!0).put({[xM]:e,value:t});return new Tp(r).toPromise()}async function zU(n,e){const t=Cv(n,!1).get(e),r=await new Tp(t).toPromise();return r===void 0?null:r.value}function rI(n,e){const t=Cv(n,!0).delete(e);return new Tp(t).toPromise()}const LU=800,BU=3;class _M{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await O1(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>BU)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return yM()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Av._getInstance(OU()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await MU(),!this.activeServiceWorker)return;this.sender=new kU(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||PU()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await O1();return await nI(e,M0,"1"),await rI(e,M0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>nI(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>zU(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>rI(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=Cv(i,!1).getAll();return new Tp(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),LU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}_M.type="LOCAL";const UU=_M;new wp(3e4,6e4);function FU(n,e){return e?Ds(e):(Je(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Ew extends xw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return rd(e,this._buildIdpRequest())}_linkToIdToken(e,t){return rd(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return rd(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function GU(n){return fM(n.auth,new Ew(n),n.bypassAuthState)}function qU(n){const{auth:e,user:t}=n;return Je(t,e,"internal-error"),dM(t,new Ew(n),n.bypassAuthState)}async function HU(n){const{auth:e,user:t}=n;return Je(t,e,"internal-error"),gU(t,new Ew(n),n.bypassAuthState)}class wM{constructor(e,t,r,i,a=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:a,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return GU;case"linkViaPopup":case"linkViaRedirect":return HU;case"reauthViaPopup":case"reauthViaRedirect":return qU;default:ma(this.auth,"internal-error")}}resolve(e){Bs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Bs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const $U=new wp(2e3,1e4);class Fu extends wM{constructor(e,t,r,i,a){super(e,t,i,a),this.provider=r,this.authWindow=null,this.pollId=null,Fu.currentPopupAction&&Fu.currentPopupAction.cancel(),Fu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Je(e,this.auth,"internal-error"),e}async onExecution(){Bs(this.filter.length===1,"Popup operations only handle one event");const e=ww();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ka(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ka(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Fu.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ka(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,$U.get())};e()}}Fu.currentPopupAction=null;const YU="pendingRedirect",n0=new Map;class KU extends wM{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=n0.get(this.auth._key());if(!e){try{const r=await XU(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}n0.set(this.auth._key(),e)}return this.bypassAuthState||n0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function XU(n,e){const t=ZU(e),r=QU(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function WU(n,e){n0.set(n._key(),e)}function QU(n){return Ds(n._redirectPersistence)}function ZU(n){return t0(YU,n.config.apiKey,n.name)}async function JU(n,e,t=!1){if(Ui(n.app))return Promise.reject(Ps(n));const r=gl(n),i=FU(r,e),o=await new KU(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}const eF=600*1e3;class tF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!nF(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!EM(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ka(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=eF&&this.cachedEventUids.clear(),this.cachedEventUids.has(iI(e))}saveEventToCache(e){this.cachedEventUids.add(iI(e)),this.lastProcessedEventTime=Date.now()}}function iI(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function EM({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function nF(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return EM(n);default:return!1}}async function rF(n,e={}){return ss(n,"GET","/v1/projects",e)}const iF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,aF=/^https?/;async function sF(n){if(n.config.emulator)return;const{authorizedDomains:e}=await rF(n);for(const t of e)try{if(oF(t))return}catch{}ma(n,"unauthorized-domain")}function oF(n){const e=M1(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!aF.test(t))return!1;if(iF.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const lF=new wp(3e4,6e4);function aI(){const n=Xa().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function cF(n){return new Promise((e,t)=>{function r(){aI(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{aI(),t(Ka(n,"network-request-failed"))},timeout:lF.get()})}if(Xa().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Xa().gapi?.load)r();else{const i=X8("iframefcb");return Xa()[i]=()=>{gapi.load?r():t(Ka(n,"network-request-failed"))},aM(`${K8()}?onload=${i}`).catch(a=>t(a))}}).catch(e=>{throw r0=null,e})}let r0=null;function uF(n){return r0=r0||cF(n),r0}const dF=new wp(5e3,15e3),fF="__/auth/iframe",hF="emulator/auth/iframe",pF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},gF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mF(n){const e=n.config;Je(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?vw(e,hF):`https://${n.config.authDomain}/${fF}`,r={apiKey:e.apiKey,appName:n.name,v:jd},i=gF.get(n.config.apiHost);i&&(r.eid=i);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${_p(r).slice(1)}`}async function vF(n){const e=await uF(n),t=Xa().gapi;return Je(t,n,"internal-error"),e.open({where:document.body,url:mF(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:pF,dontclear:!0},r=>new Promise(async(i,a)=>{await r.restyle({setHideOnLeave:!1});const o=Ka(n,"network-request-failed"),c=Xa().setTimeout(()=>{a(o)},dF.get());function u(){Xa().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{a(o)})}))}const yF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},bF=500,xF=600,_F="_blank",wF="http://localhost";class sI{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function EF(n,e,t,r=bF,i=xF){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u={...yF,width:r.toString(),height:i.toString(),top:a,left:o},d=fr().toLowerCase();t&&(c=ZN(d)?_F:t),WN(d)&&(e=e||wF,u.scrollbars="yes");const h=Object.entries(u).reduce((m,[b,_])=>`${m}${b}=${_},`,"");if(L8(d)&&c!=="_self")return SF(e||"",c),new sI(null);const p=window.open(e||"",c,h);Je(p,n,"popup-blocked");try{p.focus()}catch{}return new sI(p)}function SF(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const TF="__/auth/handler",AF="emulator/auth/handler",CF=encodeURIComponent("fac");async function oI(n,e,t,r,i,a){Je(n.config.authDomain,n,"auth-domain-config-required"),Je(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:jd,eventId:i};if(e instanceof cM){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",oB(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))o[h]=p}if(e instanceof Sp){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);const c=o;for(const h of Object.keys(c))c[h]===void 0&&delete c[h];const u=await n._getAppCheckToken(),d=u?`#${CF}=${encodeURIComponent(u)}`:"";return`${IF(n)}?${_p(c).slice(1)}${d}`}function IF({config:n}){return n.emulator?vw(n,AF):`https://${n.authDomain}/${TF}`}const Rx="webStorageSupport";class RF{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vM,this._completeRedirectFn=JU,this._overrideRedirectResult=WU}async _openPopup(e,t,r,i){Bs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await oI(e,t,r,M1(),i);return EF(e,a,ww())}async _openRedirect(e,t,r,i){await this._originValidation(e);const a=await oI(e,t,r,M1(),i);return NU(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:a}=this.eventManagers[t];return i?Promise.resolve(i):(Bs(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await vF(e),r=new tF(e);return t.register("authEvent",i=>(Je(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Rx,{type:Rx},i=>{const a=i?.[0]?.[Rx];a!==void 0&&t(!!a),ma(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=sF(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return rM()||QN()||bw()}}const DF=RF;var lI="@firebase/auth",cI="1.11.1";class kF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Je(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function NF(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function MF(n){ld(new wc("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;Je(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:iM(n)},d=new H8(r,i,a,u);return tU(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ld(new wc("auth-internal",e=>{const t=gl(e.getProvider("auth").getImmediate());return(r=>new kF(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Jo(lI,cI,NF(n)),Jo(lI,cI,"esm2020")}const PF=300,OF=RN("authIdTokenMaxAge")||PF;let uI=null;const jF=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>OF)return;const i=t?.token;uI!==i&&(uI=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function VF(n=LN()){const e=gw(n,"auth");if(e.isInitialized())return e.getImmediate();const t=eU(n,{popupRedirectResolver:DF,persistence:[UU,RU,vM]}),r=RN("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const o=jF(a.toString());SU(t,o,()=>o(t.currentUser)),EU(t,c=>o(c))}}const i=CN("auth");return i&&nU(t,`http://${i}`),t}function zF(){return document.getElementsByTagName("head")?.[0]??document}$8({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const a=Ka("internal-error");a.customData=i,t(a)},r.type="text/javascript",r.charset="UTF-8",zF().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});MF("Browser");var LF="firebase",BF="12.6.0";Jo(LF,BF,"app");var dI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var el,SM;(function(){var n;function e(C,I){function k(){}k.prototype=I.prototype,C.F=I.prototype,C.prototype=new k,C.prototype.constructor=C,C.D=function(z,L,B){for(var P=Array(arguments.length-2),J=2;J<arguments.length;J++)P[J-2]=arguments[J];return I.prototype[L].apply(z,P)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(C,I,k){k||(k=0);const z=Array(16);if(typeof I=="string")for(var L=0;L<16;++L)z[L]=I.charCodeAt(k++)|I.charCodeAt(k++)<<8|I.charCodeAt(k++)<<16|I.charCodeAt(k++)<<24;else for(L=0;L<16;++L)z[L]=I[k++]|I[k++]<<8|I[k++]<<16|I[k++]<<24;I=C.g[0],k=C.g[1],L=C.g[2];let B=C.g[3],P;P=I+(B^k&(L^B))+z[0]+3614090360&4294967295,I=k+(P<<7&4294967295|P>>>25),P=B+(L^I&(k^L))+z[1]+3905402710&4294967295,B=I+(P<<12&4294967295|P>>>20),P=L+(k^B&(I^k))+z[2]+606105819&4294967295,L=B+(P<<17&4294967295|P>>>15),P=k+(I^L&(B^I))+z[3]+3250441966&4294967295,k=L+(P<<22&4294967295|P>>>10),P=I+(B^k&(L^B))+z[4]+4118548399&4294967295,I=k+(P<<7&4294967295|P>>>25),P=B+(L^I&(k^L))+z[5]+1200080426&4294967295,B=I+(P<<12&4294967295|P>>>20),P=L+(k^B&(I^k))+z[6]+2821735955&4294967295,L=B+(P<<17&4294967295|P>>>15),P=k+(I^L&(B^I))+z[7]+4249261313&4294967295,k=L+(P<<22&4294967295|P>>>10),P=I+(B^k&(L^B))+z[8]+1770035416&4294967295,I=k+(P<<7&4294967295|P>>>25),P=B+(L^I&(k^L))+z[9]+2336552879&4294967295,B=I+(P<<12&4294967295|P>>>20),P=L+(k^B&(I^k))+z[10]+4294925233&4294967295,L=B+(P<<17&4294967295|P>>>15),P=k+(I^L&(B^I))+z[11]+2304563134&4294967295,k=L+(P<<22&4294967295|P>>>10),P=I+(B^k&(L^B))+z[12]+1804603682&4294967295,I=k+(P<<7&4294967295|P>>>25),P=B+(L^I&(k^L))+z[13]+4254626195&4294967295,B=I+(P<<12&4294967295|P>>>20),P=L+(k^B&(I^k))+z[14]+2792965006&4294967295,L=B+(P<<17&4294967295|P>>>15),P=k+(I^L&(B^I))+z[15]+1236535329&4294967295,k=L+(P<<22&4294967295|P>>>10),P=I+(L^B&(k^L))+z[1]+4129170786&4294967295,I=k+(P<<5&4294967295|P>>>27),P=B+(k^L&(I^k))+z[6]+3225465664&4294967295,B=I+(P<<9&4294967295|P>>>23),P=L+(I^k&(B^I))+z[11]+643717713&4294967295,L=B+(P<<14&4294967295|P>>>18),P=k+(B^I&(L^B))+z[0]+3921069994&4294967295,k=L+(P<<20&4294967295|P>>>12),P=I+(L^B&(k^L))+z[5]+3593408605&4294967295,I=k+(P<<5&4294967295|P>>>27),P=B+(k^L&(I^k))+z[10]+38016083&4294967295,B=I+(P<<9&4294967295|P>>>23),P=L+(I^k&(B^I))+z[15]+3634488961&4294967295,L=B+(P<<14&4294967295|P>>>18),P=k+(B^I&(L^B))+z[4]+3889429448&4294967295,k=L+(P<<20&4294967295|P>>>12),P=I+(L^B&(k^L))+z[9]+568446438&4294967295,I=k+(P<<5&4294967295|P>>>27),P=B+(k^L&(I^k))+z[14]+3275163606&4294967295,B=I+(P<<9&4294967295|P>>>23),P=L+(I^k&(B^I))+z[3]+4107603335&4294967295,L=B+(P<<14&4294967295|P>>>18),P=k+(B^I&(L^B))+z[8]+1163531501&4294967295,k=L+(P<<20&4294967295|P>>>12),P=I+(L^B&(k^L))+z[13]+2850285829&4294967295,I=k+(P<<5&4294967295|P>>>27),P=B+(k^L&(I^k))+z[2]+4243563512&4294967295,B=I+(P<<9&4294967295|P>>>23),P=L+(I^k&(B^I))+z[7]+1735328473&4294967295,L=B+(P<<14&4294967295|P>>>18),P=k+(B^I&(L^B))+z[12]+2368359562&4294967295,k=L+(P<<20&4294967295|P>>>12),P=I+(k^L^B)+z[5]+4294588738&4294967295,I=k+(P<<4&4294967295|P>>>28),P=B+(I^k^L)+z[8]+2272392833&4294967295,B=I+(P<<11&4294967295|P>>>21),P=L+(B^I^k)+z[11]+1839030562&4294967295,L=B+(P<<16&4294967295|P>>>16),P=k+(L^B^I)+z[14]+4259657740&4294967295,k=L+(P<<23&4294967295|P>>>9),P=I+(k^L^B)+z[1]+2763975236&4294967295,I=k+(P<<4&4294967295|P>>>28),P=B+(I^k^L)+z[4]+1272893353&4294967295,B=I+(P<<11&4294967295|P>>>21),P=L+(B^I^k)+z[7]+4139469664&4294967295,L=B+(P<<16&4294967295|P>>>16),P=k+(L^B^I)+z[10]+3200236656&4294967295,k=L+(P<<23&4294967295|P>>>9),P=I+(k^L^B)+z[13]+681279174&4294967295,I=k+(P<<4&4294967295|P>>>28),P=B+(I^k^L)+z[0]+3936430074&4294967295,B=I+(P<<11&4294967295|P>>>21),P=L+(B^I^k)+z[3]+3572445317&4294967295,L=B+(P<<16&4294967295|P>>>16),P=k+(L^B^I)+z[6]+76029189&4294967295,k=L+(P<<23&4294967295|P>>>9),P=I+(k^L^B)+z[9]+3654602809&4294967295,I=k+(P<<4&4294967295|P>>>28),P=B+(I^k^L)+z[12]+3873151461&4294967295,B=I+(P<<11&4294967295|P>>>21),P=L+(B^I^k)+z[15]+530742520&4294967295,L=B+(P<<16&4294967295|P>>>16),P=k+(L^B^I)+z[2]+3299628645&4294967295,k=L+(P<<23&4294967295|P>>>9),P=I+(L^(k|~B))+z[0]+4096336452&4294967295,I=k+(P<<6&4294967295|P>>>26),P=B+(k^(I|~L))+z[7]+1126891415&4294967295,B=I+(P<<10&4294967295|P>>>22),P=L+(I^(B|~k))+z[14]+2878612391&4294967295,L=B+(P<<15&4294967295|P>>>17),P=k+(B^(L|~I))+z[5]+4237533241&4294967295,k=L+(P<<21&4294967295|P>>>11),P=I+(L^(k|~B))+z[12]+1700485571&4294967295,I=k+(P<<6&4294967295|P>>>26),P=B+(k^(I|~L))+z[3]+2399980690&4294967295,B=I+(P<<10&4294967295|P>>>22),P=L+(I^(B|~k))+z[10]+4293915773&4294967295,L=B+(P<<15&4294967295|P>>>17),P=k+(B^(L|~I))+z[1]+2240044497&4294967295,k=L+(P<<21&4294967295|P>>>11),P=I+(L^(k|~B))+z[8]+1873313359&4294967295,I=k+(P<<6&4294967295|P>>>26),P=B+(k^(I|~L))+z[15]+4264355552&4294967295,B=I+(P<<10&4294967295|P>>>22),P=L+(I^(B|~k))+z[6]+2734768916&4294967295,L=B+(P<<15&4294967295|P>>>17),P=k+(B^(L|~I))+z[13]+1309151649&4294967295,k=L+(P<<21&4294967295|P>>>11),P=I+(L^(k|~B))+z[4]+4149444226&4294967295,I=k+(P<<6&4294967295|P>>>26),P=B+(k^(I|~L))+z[11]+3174756917&4294967295,B=I+(P<<10&4294967295|P>>>22),P=L+(I^(B|~k))+z[2]+718787259&4294967295,L=B+(P<<15&4294967295|P>>>17),P=k+(B^(L|~I))+z[9]+3951481745&4294967295,C.g[0]=C.g[0]+I&4294967295,C.g[1]=C.g[1]+(L+(P<<21&4294967295|P>>>11))&4294967295,C.g[2]=C.g[2]+L&4294967295,C.g[3]=C.g[3]+B&4294967295}r.prototype.v=function(C,I){I===void 0&&(I=C.length);const k=I-this.blockSize,z=this.C;let L=this.h,B=0;for(;B<I;){if(L==0)for(;B<=k;)i(this,C,B),B+=this.blockSize;if(typeof C=="string"){for(;B<I;)if(z[L++]=C.charCodeAt(B++),L==this.blockSize){i(this,z),L=0;break}}else for(;B<I;)if(z[L++]=C[B++],L==this.blockSize){i(this,z),L=0;break}}this.h=L,this.o+=I},r.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var I=1;I<C.length-8;++I)C[I]=0;I=this.o*8;for(var k=C.length-8;k<C.length;++k)C[k]=I&255,I/=256;for(this.v(C),C=Array(16),I=0,k=0;k<4;++k)for(let z=0;z<32;z+=8)C[I++]=this.g[k]>>>z&255;return C};function a(C,I){var k=c;return Object.prototype.hasOwnProperty.call(k,C)?k[C]:k[C]=I(C)}function o(C,I){this.h=I;const k=[];let z=!0;for(let L=C.length-1;L>=0;L--){const B=C[L]|0;z&&B==I||(k[L]=B,z=!1)}this.g=k}var c={};function u(C){return-128<=C&&C<128?a(C,function(I){return new o([I|0],I<0?-1:0)}):new o([C|0],C<0?-1:0)}function d(C){if(isNaN(C)||!isFinite(C))return p;if(C<0)return S(d(-C));const I=[];let k=1;for(let z=0;C>=k;z++)I[z]=C/k|0,k*=4294967296;return new o(I,0)}function h(C,I){if(C.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(C.charAt(0)=="-")return S(h(C.substring(1),I));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=d(Math.pow(I,8));let z=p;for(let B=0;B<C.length;B+=8){var L=Math.min(8,C.length-B);const P=parseInt(C.substring(B,B+L),I);L<8?(L=d(Math.pow(I,L)),z=z.j(L).add(d(P))):(z=z.j(k),z=z.add(d(P)))}return z}var p=u(0),m=u(1),b=u(16777216);n=o.prototype,n.m=function(){if(w(this))return-S(this).m();let C=0,I=1;for(let k=0;k<this.g.length;k++){const z=this.i(k);C+=(z>=0?z:4294967296+z)*I,I*=4294967296}return C},n.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(_(this))return"0";if(w(this))return"-"+S(this).toString(C);const I=d(Math.pow(C,6));var k=this;let z="";for(;;){const L=O(k,I).g;k=T(k,L.j(I));let B=((k.g.length>0?k.g[0]:k.h)>>>0).toString(C);if(k=L,_(k))return B+z;for(;B.length<6;)B="0"+B;z=B+z}},n.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function _(C){if(C.h!=0)return!1;for(let I=0;I<C.g.length;I++)if(C.g[I]!=0)return!1;return!0}function w(C){return C.h==-1}n.l=function(C){return C=T(this,C),w(C)?-1:_(C)?0:1};function S(C){const I=C.g.length,k=[];for(let z=0;z<I;z++)k[z]=~C.g[z];return new o(k,~C.h).add(m)}n.abs=function(){return w(this)?S(this):this},n.add=function(C){const I=Math.max(this.g.length,C.g.length),k=[];let z=0;for(let L=0;L<=I;L++){let B=z+(this.i(L)&65535)+(C.i(L)&65535),P=(B>>>16)+(this.i(L)>>>16)+(C.i(L)>>>16);z=P>>>16,B&=65535,P&=65535,k[L]=P<<16|B}return new o(k,k[k.length-1]&-2147483648?-1:0)};function T(C,I){return C.add(S(I))}n.j=function(C){if(_(this)||_(C))return p;if(w(this))return w(C)?S(this).j(S(C)):S(S(this).j(C));if(w(C))return S(this.j(S(C)));if(this.l(b)<0&&C.l(b)<0)return d(this.m()*C.m());const I=this.g.length+C.g.length,k=[];for(var z=0;z<2*I;z++)k[z]=0;for(z=0;z<this.g.length;z++)for(let L=0;L<C.g.length;L++){const B=this.i(z)>>>16,P=this.i(z)&65535,J=C.i(L)>>>16,Y=C.i(L)&65535;k[2*z+2*L]+=P*Y,A(k,2*z+2*L),k[2*z+2*L+1]+=B*Y,A(k,2*z+2*L+1),k[2*z+2*L+1]+=P*J,A(k,2*z+2*L+1),k[2*z+2*L+2]+=B*J,A(k,2*z+2*L+2)}for(C=0;C<I;C++)k[C]=k[2*C+1]<<16|k[2*C];for(C=I;C<2*I;C++)k[C]=0;return new o(k,0)};function A(C,I){for(;(C[I]&65535)!=C[I];)C[I+1]+=C[I]>>>16,C[I]&=65535,I++}function D(C,I){this.g=C,this.h=I}function O(C,I){if(_(I))throw Error("division by zero");if(_(C))return new D(p,p);if(w(C))return I=O(S(C),I),new D(S(I.g),S(I.h));if(w(I))return I=O(C,S(I)),new D(S(I.g),I.h);if(C.g.length>30){if(w(C)||w(I))throw Error("slowDivide_ only works with positive integers.");for(var k=m,z=I;z.l(C)<=0;)k=M(k),z=M(z);var L=j(k,1),B=j(z,1);for(z=j(z,2),k=j(k,2);!_(z);){var P=B.add(z);P.l(C)<=0&&(L=L.add(k),B=P),z=j(z,1),k=j(k,1)}return I=T(C,L.j(I)),new D(L,I)}for(L=p;C.l(I)>=0;){for(k=Math.max(1,Math.floor(C.m()/I.m())),z=Math.ceil(Math.log(k)/Math.LN2),z=z<=48?1:Math.pow(2,z-48),B=d(k),P=B.j(I);w(P)||P.l(C)>0;)k-=z,B=d(k),P=B.j(I);_(B)&&(B=m),L=L.add(B),C=T(C,P)}return new D(L,C)}n.B=function(C){return O(this,C).h},n.and=function(C){const I=Math.max(this.g.length,C.g.length),k=[];for(let z=0;z<I;z++)k[z]=this.i(z)&C.i(z);return new o(k,this.h&C.h)},n.or=function(C){const I=Math.max(this.g.length,C.g.length),k=[];for(let z=0;z<I;z++)k[z]=this.i(z)|C.i(z);return new o(k,this.h|C.h)},n.xor=function(C){const I=Math.max(this.g.length,C.g.length),k=[];for(let z=0;z<I;z++)k[z]=this.i(z)^C.i(z);return new o(k,this.h^C.h)};function M(C){const I=C.g.length+1,k=[];for(let z=0;z<I;z++)k[z]=C.i(z)<<1|C.i(z-1)>>>31;return new o(k,C.h)}function j(C,I){const k=I>>5;I%=32;const z=C.g.length-k,L=[];for(let B=0;B<z;B++)L[B]=I>0?C.i(B+k)>>>I|C.i(B+k+1)<<32-I:C.i(B+k);return new o(L,C.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,SM=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,el=o}).apply(typeof dI<"u"?dI:typeof self<"u"?self:typeof window<"u"?window:{});var Cm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var TM,sh,AM,i0,j1,CM,IM,RM;(function(){var n,e=Object.defineProperty;function t(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof Cm=="object"&&Cm];for(var R=0;R<y.length;++R){var V=y[R];if(V&&V.Math==Math)return V}throw Error("Cannot find global object")}var r=t(this);function i(y,R){if(R)e:{var V=r;y=y.split(".");for(var q=0;q<y.length-1;q++){var se=y[q];if(!(se in V))break e;V=V[se]}y=y[y.length-1],q=V[y],R=R(q),R!=q&&R!=null&&e(V,y,{configurable:!0,writable:!0,value:R})}}i("Symbol.dispose",function(y){return y||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(y){return y||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(y){return y||function(R){var V=[],q;for(q in R)Object.prototype.hasOwnProperty.call(R,q)&&V.push([q,R[q]]);return V}});var a=a||{},o=this||self;function c(y){var R=typeof y;return R=="object"&&y!=null||R=="function"}function u(y,R,V){return y.call.apply(y.bind,arguments)}function d(y,R,V){return d=u,d.apply(null,arguments)}function h(y,R){var V=Array.prototype.slice.call(arguments,1);return function(){var q=V.slice();return q.push.apply(q,arguments),y.apply(this,q)}}function p(y,R){function V(){}V.prototype=R.prototype,y.Z=R.prototype,y.prototype=new V,y.prototype.constructor=y,y.Ob=function(q,se,pe){for(var Ie=Array(arguments.length-2),dt=2;dt<arguments.length;dt++)Ie[dt-2]=arguments[dt];return R.prototype[se].apply(q,Ie)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?y=>y&&AsyncContext.Snapshot.wrap(y):y=>y;function b(y){const R=y.length;if(R>0){const V=Array(R);for(let q=0;q<R;q++)V[q]=y[q];return V}return[]}function _(y,R){for(let q=1;q<arguments.length;q++){const se=arguments[q];var V=typeof se;if(V=V!="object"?V:se?Array.isArray(se)?"array":V:"null",V=="array"||V=="object"&&typeof se.length=="number"){V=y.length||0;const pe=se.length||0;y.length=V+pe;for(let Ie=0;Ie<pe;Ie++)y[V+Ie]=se[Ie]}else y.push(se)}}class w{constructor(R,V){this.i=R,this.j=V,this.h=0,this.g=null}get(){let R;return this.h>0?(this.h--,R=this.g,this.g=R.next,R.next=null):R=this.i(),R}}function S(y){o.setTimeout(()=>{throw y},0)}function T(){var y=C;let R=null;return y.g&&(R=y.g,y.g=y.g.next,y.g||(y.h=null),R.next=null),R}class A{constructor(){this.h=this.g=null}add(R,V){const q=D.get();q.set(R,V),this.h?this.h.next=q:this.g=q,this.h=q}}var D=new w(()=>new O,y=>y.reset());class O{constructor(){this.next=this.g=this.h=null}set(R,V){this.h=R,this.g=V,this.next=null}reset(){this.next=this.g=this.h=null}}let M,j=!1,C=new A,I=()=>{const y=Promise.resolve(void 0);M=()=>{y.then(k)}};function k(){for(var y;y=T();){try{y.h.call(y.g)}catch(V){S(V)}var R=D;R.j(y),R.h<100&&(R.h++,y.next=R.g,R.g=y)}j=!1}function z(){this.u=this.u,this.C=this.C}z.prototype.u=!1,z.prototype.dispose=function(){this.u||(this.u=!0,this.N())},z.prototype[Symbol.dispose]=function(){this.dispose()},z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(y,R){this.type=y,this.g=this.target=R,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var y=!1,R=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const V=()=>{};o.addEventListener("test",V,R),o.removeEventListener("test",V,R)}catch{}return y})();function P(y){return/^[\s\xa0]*$/.test(y)}function J(y,R){L.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y&&this.init(y,R)}p(J,L),J.prototype.init=function(y,R){const V=this.type=y.type,q=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;this.target=y.target||y.srcElement,this.g=R,R=y.relatedTarget,R||(V=="mouseover"?R=y.fromElement:V=="mouseout"&&(R=y.toElement)),this.relatedTarget=R,q?(this.clientX=q.clientX!==void 0?q.clientX:q.pageX,this.clientY=q.clientY!==void 0?q.clientY:q.pageY,this.screenX=q.screenX||0,this.screenY=q.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=y.pointerType,this.state=y.state,this.i=y,y.defaultPrevented&&J.Z.h.call(this)},J.prototype.h=function(){J.Z.h.call(this);const y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var Y="closure_listenable_"+(Math.random()*1e6|0),H=0;function W(y,R,V,q,se){this.listener=y,this.proxy=null,this.src=R,this.type=V,this.capture=!!q,this.ha=se,this.key=++H,this.da=this.fa=!1}function K(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function de(y,R,V){for(const q in y)R.call(V,y[q],q,y)}function Q(y,R){for(const V in y)R.call(void 0,y[V],V,y)}function G(y){const R={};for(const V in y)R[V]=y[V];return R}const $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ee(y,R){let V,q;for(let se=1;se<arguments.length;se++){q=arguments[se];for(V in q)y[V]=q[V];for(let pe=0;pe<$.length;pe++)V=$[pe],Object.prototype.hasOwnProperty.call(q,V)&&(y[V]=q[V])}}function te(y){this.src=y,this.g={},this.h=0}te.prototype.add=function(y,R,V,q,se){const pe=y.toString();y=this.g[pe],y||(y=this.g[pe]=[],this.h++);const Ie=fe(y,R,q,se);return Ie>-1?(R=y[Ie],V||(R.fa=!1)):(R=new W(R,this.src,pe,!!q,se),R.fa=V,y.push(R)),R};function le(y,R){const V=R.type;if(V in y.g){var q=y.g[V],se=Array.prototype.indexOf.call(q,R,void 0),pe;(pe=se>=0)&&Array.prototype.splice.call(q,se,1),pe&&(K(R),y.g[V].length==0&&(delete y.g[V],y.h--))}}function fe(y,R,V,q){for(let se=0;se<y.length;++se){const pe=y[se];if(!pe.da&&pe.listener==R&&pe.capture==!!V&&pe.ha==q)return se}return-1}var oe="closure_lm_"+(Math.random()*1e6|0),Ee={};function ke(y,R,V,q,se){if(Array.isArray(R)){for(let pe=0;pe<R.length;pe++)ke(y,R[pe],V,q,se);return null}return V=Ze(V),y&&y[Y]?y.J(R,V,c(q)?!!q.capture:!1,se):Ke(y,R,V,!1,q,se)}function Ke(y,R,V,q,se,pe){if(!R)throw Error("Invalid event type");const Ie=c(se)?!!se.capture:!!se;let dt=we(y);if(dt||(y[oe]=dt=new te(y)),V=dt.add(R,V,q,Ie,pe),V.proxy)return V;if(q=Se(),V.proxy=q,q.src=y,q.listener=V,y.addEventListener)B||(se=Ie),se===void 0&&(se=!1),y.addEventListener(R.toString(),q,se);else if(y.attachEvent)y.attachEvent(Me(R.toString()),q);else if(y.addListener&&y.removeListener)y.addListener(q);else throw Error("addEventListener and attachEvent are unavailable.");return V}function Se(){function y(V){return R.call(y.src,y.listener,V)}const R=He;return y}function Ne(y,R,V,q,se){if(Array.isArray(R))for(var pe=0;pe<R.length;pe++)Ne(y,R[pe],V,q,se);else q=c(q)?!!q.capture:!!q,V=Ze(V),y&&y[Y]?(y=y.i,pe=String(R).toString(),pe in y.g&&(R=y.g[pe],V=fe(R,V,q,se),V>-1&&(K(R[V]),Array.prototype.splice.call(R,V,1),R.length==0&&(delete y.g[pe],y.h--)))):y&&(y=we(y))&&(R=y.g[R.toString()],y=-1,R&&(y=fe(R,V,q,se)),(V=y>-1?R[y]:null)&&Be(V))}function Be(y){if(typeof y!="number"&&y&&!y.da){var R=y.src;if(R&&R[Y])le(R.i,y);else{var V=y.type,q=y.proxy;R.removeEventListener?R.removeEventListener(V,q,y.capture):R.detachEvent?R.detachEvent(Me(V),q):R.addListener&&R.removeListener&&R.removeListener(q),(V=we(R))?(le(V,y),V.h==0&&(V.src=null,R[oe]=null)):K(y)}}}function Me(y){return y in Ee?Ee[y]:Ee[y]="on"+y}function He(y,R){if(y.da)y=!0;else{R=new J(R,this);const V=y.listener,q=y.ha||y.src;y.fa&&Be(y),y=V.call(q,R)}return y}function we(y){return y=y[oe],y instanceof te?y:null}var Ve="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ze(y){return typeof y=="function"?y:(y[Ve]||(y[Ve]=function(R){return y.handleEvent(R)}),y[Ve])}function Re(){z.call(this),this.i=new te(this),this.M=this,this.G=null}p(Re,z),Re.prototype[Y]=!0,Re.prototype.removeEventListener=function(y,R,V,q){Ne(this,y,R,V,q)};function Oe(y,R){var V,q=y.G;if(q)for(V=[];q;q=q.G)V.push(q);if(y=y.M,q=R.type||R,typeof R=="string")R=new L(R,y);else if(R instanceof L)R.target=R.target||y;else{var se=R;R=new L(q,y),ee(R,se)}se=!0;let pe,Ie;if(V)for(Ie=V.length-1;Ie>=0;Ie--)pe=R.g=V[Ie],se=ct(pe,q,!0,R)&&se;if(pe=R.g=y,se=ct(pe,q,!0,R)&&se,se=ct(pe,q,!1,R)&&se,V)for(Ie=0;Ie<V.length;Ie++)pe=R.g=V[Ie],se=ct(pe,q,!1,R)&&se}Re.prototype.N=function(){if(Re.Z.N.call(this),this.i){var y=this.i;for(const R in y.g){const V=y.g[R];for(let q=0;q<V.length;q++)K(V[q]);delete y.g[R],y.h--}}this.G=null},Re.prototype.J=function(y,R,V,q){return this.i.add(String(y),R,!1,V,q)},Re.prototype.K=function(y,R,V,q){return this.i.add(String(y),R,!0,V,q)};function ct(y,R,V,q){if(R=y.i.g[String(R)],!R)return!0;R=R.concat();let se=!0;for(let pe=0;pe<R.length;++pe){const Ie=R[pe];if(Ie&&!Ie.da&&Ie.capture==V){const dt=Ie.listener,Vn=Ie.ha||Ie.src;Ie.fa&&le(y.i,Ie),se=dt.call(Vn,q)!==!1&&se}}return se&&!q.defaultPrevented}function et(y,R){if(typeof y!="function")if(y&&typeof y.handleEvent=="function")y=d(y.handleEvent,y);else throw Error("Invalid listener argument");return Number(R)>2147483647?-1:o.setTimeout(y,R||0)}function Ot(y){y.g=et(()=>{y.g=null,y.i&&(y.i=!1,Ot(y))},y.l);const R=y.h;y.h=null,y.m.apply(null,R)}class rt extends z{constructor(R,V){super(),this.m=R,this.l=V,this.h=null,this.i=!1,this.g=null}j(R){this.h=arguments,this.g?this.i=!0:Ot(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function pt(y){z.call(this),this.h=y,this.g={}}p(pt,z);var jt=[];function Ft(y){de(y.g,function(R,V){this.g.hasOwnProperty(V)&&Be(R)},y),y.g={}}pt.prototype.N=function(){pt.Z.N.call(this),Ft(this)},pt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var jn=o.JSON.stringify,ui=o.JSON.parse,ls=class{stringify(y){return o.JSON.stringify(y,void 0)}parse(y){return o.JSON.parse(y,void 0)}};function Zi(){}function di(){}var Ir={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Sn(){L.call(this,"d")}p(Sn,L);function rr(){L.call(this,"c")}p(rr,L);var cn={},eo=null;function _a(){return eo=eo||new Re}cn.Ia="serverreachability";function wa(y){L.call(this,cn.Ia,y)}p(wa,L);function yt(y){const R=_a();Oe(R,new wa(R))}cn.STAT_EVENT="statevent";function un(y,R){L.call(this,cn.STAT_EVENT,y),this.stat=R}p(un,L);function dn(y){const R=_a();Oe(R,new un(R,y))}cn.Ja="timingevent";function Pe(y,R){L.call(this,cn.Ja,y),this.size=R}p(Pe,L);function ut(y,R){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){y()},R)}function qt(){this.g=!0}qt.prototype.ua=function(){this.g=!1};function bt(y,R,V,q,se,pe){y.info(function(){if(y.g)if(pe){var Ie="",dt=pe.split("&");for(let Lt=0;Lt<dt.length;Lt++){var Vn=dt[Lt].split("=");if(Vn.length>1){const yn=Vn[0];Vn=Vn[1];const Ii=yn.split("_");Ie=Ii.length>=2&&Ii[1]=="type"?Ie+(yn+"="+Vn+"&"):Ie+(yn+"=redacted&")}}}else Ie=null;else Ie=pe;return"XMLHTTP REQ ("+q+") [attempt "+se+"]: "+R+`
`+V+`
`+Ie})}function Rr(y,R,V,q,se,pe,Ie){y.info(function(){return"XMLHTTP RESP ("+q+") [ attempt "+se+"]: "+R+`
`+V+`
`+pe+" "+Ie})}function Gn(y,R,V,q){y.info(function(){return"XMLHTTP TEXT ("+R+"): "+ar(y,V)+(q?" "+q:"")})}function ir(y,R){y.info(function(){return"TIMEOUT: "+R})}qt.prototype.info=function(){};function ar(y,R){if(!y.g)return R;if(!R)return null;try{const pe=JSON.parse(R);if(pe){for(y=0;y<pe.length;y++)if(Array.isArray(pe[y])){var V=pe[y];if(!(V.length<2)){var q=V[1];if(Array.isArray(q)&&!(q.length<1)){var se=q[0];if(se!="noop"&&se!="stop"&&se!="close")for(let Ie=1;Ie<q.length;Ie++)q[Ie]=""}}}}return jn(pe)}catch{return R}}var Dt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},kt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},fn;function Vt(){}p(Vt,Zi),Vt.prototype.g=function(){return new XMLHttpRequest},fn=new Vt;function an(y){return encodeURIComponent(String(y))}function Et(y){var R=1;y=y.split(":");const V=[];for(;R>0&&y.length;)V.push(y.shift()),R--;return y.length&&V.push(y.join(":")),V}function zt(y,R,V,q){this.j=y,this.i=R,this.l=V,this.S=q||1,this.V=new pt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new hn}function hn(){this.i=null,this.g="",this.h=!1}var ln={},Wt={};function pr(y,R,V){y.M=1,y.A=wl(Hn(R)),y.u=V,y.R=!0,Dr(y,null)}function Dr(y,R){y.F=Date.now(),Ea(y),y.B=Hn(y.A);var V=y.B,q=y.S;Array.isArray(q)||(q=[String(q)]),Yc(V.i,"t",q),y.C=0,V=y.j.L,y.h=new hn,y.g=mg(y.j,V?R:null,!y.u),y.P>0&&(y.O=new rt(d(y.Y,y,y.g),y.P)),R=y.V,V=y.g,q=y.ba;var se="readystatechange";Array.isArray(se)||(se&&(jt[0]=se.toString()),se=jt);for(let pe=0;pe<se.length;pe++){const Ie=ke(V,se[pe],q||R.handleEvent,!1,R.h||R);if(!Ie)break;R.g[Ie.key]=Ie}R=y.J?G(y.J):{},y.u?(y.v||(y.v="POST"),R["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.B,y.v,y.u,R)):(y.v="GET",y.g.ea(y.B,y.v,null,R)),yt(),bt(y.i,y.v,y.B,y.l,y.S,y.u)}zt.prototype.ba=function(y){y=y.target;const R=this.O;R&&ta(y)==3?R.j():this.Y(y)},zt.prototype.Y=function(y){try{if(y==this.g)e:{const dt=ta(this.g),Vn=this.g.ya(),Lt=this.g.ca();if(!(dt<3)&&(dt!=3||this.g&&(this.h.h||this.g.la()||yr(this.g)))){this.K||dt!=4||Vn==7||(Vn==8||Lt<=0?yt(3):yt(2)),Sa(this);var R=this.g.ca();this.X=R;var V=by(this);if(this.o=R==200,Rr(this.i,this.v,this.B,this.l,this.S,dt,R),this.o){if(this.U&&!this.L){t:{if(this.g){var q,se=this.g;if((q=se.g?se.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(q)){var pe=q;break t}}pe=null}if(y=pe)Gn(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ta(this,y);else{this.o=!1,this.m=3,dn(12),fi(this),Ti(this);break e}}if(this.R){y=!0;let yn;for(;!this.K&&this.C<V.length;)if(yn=rg(this,V),yn==Wt){dt==4&&(this.m=4,dn(14),y=!1),Gn(this.i,this.l,null,"[Incomplete Response]");break}else if(yn==ln){this.m=4,dn(15),Gn(this.i,this.l,V,"[Invalid Chunk]"),y=!1;break}else Gn(this.i,this.l,yn,null),Ta(this,yn);if(ng(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),dt!=4||V.length!=0||this.h.h||(this.m=1,dn(16),y=!1),this.o=this.o&&y,!y)Gn(this.i,this.l,V,"[Invalid Chunked Response]"),fi(this),Ti(this);else if(V.length>0&&!this.W){this.W=!0;var Ie=this.j;Ie.g==this&&Ie.aa&&!Ie.P&&(Ie.j.info("Great, no buffering proxy detected. Bytes received: "+V.length),df(Ie),Ie.P=!0,dn(11))}}else Gn(this.i,this.l,V,null),Ta(this,V);dt==4&&fi(this),this.o&&!this.K&&(dt==4?fg(this.j,this):(this.o=!1,Ea(this)))}else us(this.g),R==400&&V.indexOf("Unknown SID")>0?(this.m=3,dn(12)):(this.m=0,dn(13)),fi(this),Ti(this)}}}catch{}finally{}};function by(y){if(!ng(y))return y.g.la();const R=yr(y.g);if(R==="")return"";let V="";const q=R.length,se=ta(y.g)==4;if(!y.h.i){if(typeof TextDecoder>"u")return fi(y),Ti(y),"";y.h.i=new o.TextDecoder}for(let pe=0;pe<q;pe++)y.h.h=!0,V+=y.h.i.decode(R[pe],{stream:!(se&&pe==q-1)});return R.length=0,y.h.g+=V,y.C=0,y.h.g}function ng(y){return y.g?y.v=="GET"&&y.M!=2&&y.j.Aa:!1}function rg(y,R){var V=y.C,q=R.indexOf(`
`,V);return q==-1?Wt:(V=Number(R.substring(V,q)),isNaN(V)?ln:(q+=1,q+V>R.length?Wt:(R=R.slice(q,q+V),y.C=q+V,R)))}zt.prototype.cancel=function(){this.K=!0,fi(this)};function Ea(y){y.T=Date.now()+y.H,qc(y,y.H)}function qc(y,R){if(y.D!=null)throw Error("WatchDog timer not null");y.D=ut(d(y.aa,y),R)}function Sa(y){y.D&&(o.clearTimeout(y.D),y.D=null)}zt.prototype.aa=function(){this.D=null;const y=Date.now();y-this.T>=0?(ir(this.i,this.B),this.M!=2&&(yt(),dn(17)),fi(this),this.m=2,Ti(this)):qc(this,this.T-y)};function Ti(y){y.j.I==0||y.K||fg(y.j,y)}function fi(y){Sa(y);var R=y.O;R&&typeof R.dispose=="function"&&R.dispose(),y.O=null,Ft(y.V),y.g&&(R=y.g,y.g=null,R.abort(),R.dispose())}function Ta(y,R){try{var V=y.j;if(V.I!=0&&(V.g==y||Ca(V.h,y))){if(!y.L&&Ca(V.h,y)&&V.I==3){try{var q=V.Ba.g.parse(R)}catch{q=null}if(Array.isArray(q)&&q.length==3){var se=q;if(se[0]==0){e:if(!V.v){if(V.g)if(V.g.F+3e3<y.F)Zc(V),lo(V);else break e;Rl(V),dn(18)}}else V.xa=se[1],0<V.xa-V.K&&se[2]<37500&&V.F&&V.A==0&&!V.C&&(V.C=ut(d(V.Va,V),6e3));Aa(V.h)<=1&&V.ta&&(V.ta=void 0)}else Ma(V,11)}else if((y.L||V.g==y)&&Zc(V),!P(R))for(se=V.Ba.g.parse(R),R=0;R<se.length;R++){let Lt=se[R];const yn=Lt[0];if(!(yn<=V.K))if(V.K=yn,Lt=Lt[1],V.I==2)if(Lt[0]=="c"){V.M=Lt[1],V.ba=Lt[2];const Ii=Lt[3];Ii!=null&&(V.ka=Ii,V.j.info("VER="+V.ka));const Pa=Lt[4];Pa!=null&&(V.za=Pa,V.j.info("SVER="+V.za));const na=Lt[5];na!=null&&typeof na=="number"&&na>0&&(q=1.5*na,V.O=q,V.j.info("backChannelRequestTimeoutMs_="+q)),q=V;const ra=y.g;if(ra){const Dl=ra.g?ra.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Dl){var pe=q.h;pe.g||Dl.indexOf("spdy")==-1&&Dl.indexOf("quic")==-1&&Dl.indexOf("h2")==-1||(pe.j=pe.l,pe.g=new Set,pe.h&&(Zd(pe,pe.h),pe.h=null))}if(q.G){const Jc=ra.g?ra.g.getResponseHeader("X-HTTP-Session-Id"):null;Jc&&(q.wa=Jc,Ht(q.J,q.G,Jc))}}V.I=3,V.l&&V.l.ra(),V.aa&&(V.T=Date.now()-y.F,V.j.info("Handshake RTT: "+V.T+"ms")),q=V;var Ie=y;if(q.na=gg(q,q.L?q.ba:null,q.W),Ie.L){Jd(q.h,Ie);var dt=Ie,Vn=q.O;Vn&&(dt.H=Vn),dt.D&&(Sa(dt),Ea(dt)),q.g=Ie}else ug(q);V.i.length>0&&Na(V)}else Lt[0]!="stop"&&Lt[0]!="close"||Ma(V,7);else V.I==3&&(Lt[0]=="stop"||Lt[0]=="close"?Lt[0]=="stop"?Ma(V,7):cf(V):Lt[0]!="noop"&&V.l&&V.l.qa(Lt),V.A=0)}}yt(4)}catch{}}var qn=class{constructor(y,R){this.g=y,this.map=R}};function Wd(y){this.l=y||10,o.PerformanceNavigationTiming?(y=o.performance.getEntriesByType("navigation"),y=y.length>0&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Qd(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function Aa(y){return y.h?1:y.g?y.g.size:0}function Ca(y,R){return y.h?y.h==R:y.g?y.g.has(R):!1}function Zd(y,R){y.g?y.g.add(R):y.h=R}function Jd(y,R){y.h&&y.h==R?y.h=null:y.g&&y.g.has(R)&&y.g.delete(R)}Wd.prototype.cancel=function(){if(this.i=ef(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function ef(y){if(y.h!=null)return y.i.concat(y.h.G);if(y.g!=null&&y.g.size!==0){let R=y.i;for(const V of y.g.values())R=R.concat(V.G);return R}return b(y.i)}var ig=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Hc(y,R){if(y){y=y.split("&");for(let V=0;V<y.length;V++){const q=y[V].indexOf("=");let se,pe=null;q>=0?(se=y[V].substring(0,q),pe=y[V].substring(q+1)):se=y[V],R(se,pe?decodeURIComponent(pe.replace(/\+/g," ")):"")}}}function hi(y){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let R;y instanceof hi?(this.l=y.l,gr(this,y.j),this.o=y.o,this.g=y.g,to(this,y.u),this.h=y.h,tf(this,lg(y.i)),this.m=y.m):y&&(R=String(y).match(ig))?(this.l=!1,gr(this,R[1]||"",!0),this.o=Ia(R[2]||""),this.g=Ia(R[3]||"",!0),to(this,R[4]),this.h=Ia(R[5]||"",!0),tf(this,R[6]||"",!0),this.m=Ia(R[7]||"")):(this.l=!1,this.i=new ro(null,this.l))}hi.prototype.toString=function(){const y=[];var R=this.j;R&&y.push(El(R,$c,!0),":");var V=this.g;return(V||R=="file")&&(y.push("//"),(R=this.o)&&y.push(El(R,$c,!0),"@"),y.push(an(V).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),V=this.u,V!=null&&y.push(":",String(V))),(V=this.h)&&(this.g&&V.charAt(0)!="/"&&y.push("/"),y.push(El(V,V.charAt(0)=="/"?nf:ag,!0))),(V=this.i.toString())&&y.push("?",V),(V=this.m)&&y.push("#",El(V,sg)),y.join("")},hi.prototype.resolve=function(y){const R=Hn(this);let V=!!y.j;V?gr(R,y.j):V=!!y.o,V?R.o=y.o:V=!!y.g,V?R.g=y.g:V=y.u!=null;var q=y.h;if(V)to(R,y.u);else if(V=!!y.h){if(q.charAt(0)!="/")if(this.g&&!this.h)q="/"+q;else{var se=R.h.lastIndexOf("/");se!=-1&&(q=R.h.slice(0,se+1)+q)}if(se=q,se==".."||se==".")q="";else if(se.indexOf("./")!=-1||se.indexOf("/.")!=-1){q=se.lastIndexOf("/",0)==0,se=se.split("/");const pe=[];for(let Ie=0;Ie<se.length;){const dt=se[Ie++];dt=="."?q&&Ie==se.length&&pe.push(""):dt==".."?((pe.length>1||pe.length==1&&pe[0]!="")&&pe.pop(),q&&Ie==se.length&&pe.push("")):(pe.push(dt),q=!0)}q=pe.join("/")}else q=se}return V?R.h=q:V=y.i.toString()!=="",V?tf(R,lg(y.i)):V=!!y.m,V&&(R.m=y.m),R};function Hn(y){return new hi(y)}function gr(y,R,V){y.j=V?Ia(R,!0):R,y.j&&(y.j=y.j.replace(/:$/,""))}function to(y,R){if(R){if(R=Number(R),isNaN(R)||R<0)throw Error("Bad port number "+R);y.u=R}else y.u=null}function tf(y,R,V){R instanceof ro?(y.i=R,Kc(y.i,y.l)):(V||(R=El(R,no)),y.i=new ro(R,y.l))}function Ht(y,R,V){y.i.set(R,V)}function wl(y){return Ht(y,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),y}function Ia(y,R){return y?R?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function El(y,R,V){return typeof y=="string"?(y=encodeURI(y).replace(R,Xr),V&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Xr(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var $c=/[#\/\?@]/g,ag=/[#\?:]/g,nf=/[#\?]/g,no=/[#\?@]/g,sg=/#/g;function ro(y,R){this.h=this.g=null,this.i=y||null,this.j=!!R}function Wr(y){y.g||(y.g=new Map,y.h=0,y.i&&Hc(y.i,function(R,V){y.add(decodeURIComponent(R.replace(/\+/g," ")),V)}))}n=ro.prototype,n.add=function(y,R){Wr(this),this.i=null,y=io(this,y);let V=this.g.get(y);return V||this.g.set(y,V=[]),V.push(R),this.h+=1,this};function og(y,R){Wr(y),R=io(y,R),y.g.has(R)&&(y.i=null,y.h-=y.g.get(R).length,y.g.delete(R))}function rf(y,R){return Wr(y),R=io(y,R),y.g.has(R)}n.forEach=function(y,R){Wr(this),this.g.forEach(function(V,q){V.forEach(function(se){y.call(R,se,q,this)},this)},this)};function af(y,R){Wr(y);let V=[];if(typeof R=="string")rf(y,R)&&(V=V.concat(y.g.get(io(y,R))));else for(y=Array.from(y.g.values()),R=0;R<y.length;R++)V=V.concat(y[R]);return V}n.set=function(y,R){return Wr(this),this.i=null,y=io(this,y),rf(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[R]),this.h+=1,this},n.get=function(y,R){return y?(y=af(this,y),y.length>0?String(y[0]):R):R};function Yc(y,R,V){og(y,R),V.length>0&&(y.i=null,y.g.set(io(y,R),b(V)),y.h+=V.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],R=Array.from(this.g.keys());for(let q=0;q<R.length;q++){var V=R[q];const se=an(V);V=af(this,V);for(let pe=0;pe<V.length;pe++){let Ie=se;V[pe]!==""&&(Ie+="="+an(V[pe])),y.push(Ie)}}return this.i=y.join("&")};function lg(y){const R=new ro;return R.i=y.i,y.g&&(R.g=new Map(y.g),R.h=y.h),R}function io(y,R){return R=String(R),y.j&&(R=R.toLowerCase()),R}function Kc(y,R){R&&!y.j&&(Wr(y),y.i=null,y.g.forEach(function(V,q){const se=q.toLowerCase();q!=se&&(og(this,q),Yc(this,se,V))},y)),y.j=R}function Ji(y,R){const V=new qt;if(o.Image){const q=new Image;q.onload=h(Ai,V,"TestLoadImage: loaded",!0,R,q),q.onerror=h(Ai,V,"TestLoadImage: error",!1,R,q),q.onabort=h(Ai,V,"TestLoadImage: abort",!1,R,q),q.ontimeout=h(Ai,V,"TestLoadImage: timeout",!1,R,q),o.setTimeout(function(){q.ontimeout&&q.ontimeout()},1e4),q.src=y}else R(!1)}function sf(y,R){const V=new qt,q=new AbortController,se=setTimeout(()=>{q.abort(),Ai(V,"TestPingServer: timeout",!1,R)},1e4);fetch(y,{signal:q.signal}).then(pe=>{clearTimeout(se),pe.ok?Ai(V,"TestPingServer: ok",!0,R):Ai(V,"TestPingServer: server error",!1,R)}).catch(()=>{clearTimeout(se),Ai(V,"TestPingServer: error",!1,R)})}function Ai(y,R,V,q,se){try{se&&(se.onload=null,se.onerror=null,se.onabort=null,se.ontimeout=null),q(V)}catch{}}function ao(){this.g=new ls}function Ra(y){this.i=y.Sb||null,this.h=y.ab||!1}p(Ra,Zi),Ra.prototype.g=function(){return new Sl(this.i,this.h)};function Sl(y,R){Re.call(this),this.H=y,this.o=R,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(Sl,Re),n=Sl.prototype,n.open=function(y,R){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=y,this.D=R,this.readyState=1,ea(this)},n.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const R={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};y&&(R.body=y),(this.H||o).fetch(new Request(this.D,R)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,so(this)),this.readyState=0},n.Pa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,ea(this)),this.g&&(this.readyState=3,ea(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Xc(this)}else y.text().then(this.Oa.bind(this),this.ga.bind(this))};function Xc(y){y.j.read().then(y.Ma.bind(y)).catch(y.ga.bind(y))}n.Ma=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var R=y.value?y.value:new Uint8Array(0);(R=this.B.decode(R,{stream:!y.done}))&&(this.response=this.responseText+=R)}y.done?so(this):ea(this),this.readyState==3&&Xc(this)}},n.Oa=function(y){this.g&&(this.response=this.responseText=y,so(this))},n.Na=function(y){this.g&&(this.response=y,so(this))},n.ga=function(){this.g&&so(this)};function so(y){y.readyState=4,y.l=null,y.j=null,y.B=null,ea(y)}n.setRequestHeader=function(y,R){this.A.append(y,R)},n.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],R=this.h.entries();for(var V=R.next();!V.done;)V=V.value,y.push(V[0]+": "+V[1]),V=R.next();return y.join(`\r
`)};function ea(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(Sl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function Ci(y){let R="";return de(y,function(V,q){R+=q,R+=":",R+=V,R+=`\r
`}),R}function Tl(y,R,V){e:{for(q in V){var q=!1;break e}q=!0}q||(V=Ci(V),typeof y=="string"?V!=null&&an(V):Ht(y,R,V))}function Qt(y){Re.call(this),this.headers=new Map,this.L=y||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(Qt,Re);var Da=/^https?$/i,of=["POST","PUT"];n=Qt.prototype,n.Fa=function(y){this.H=y},n.ea=function(y,R,V,q){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);R=R?R.toUpperCase():"GET",this.D=y,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():fn.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(R,String(y),!0),this.B=!1}catch(pe){Al(this,pe);return}if(y=V||"",V=new Map(this.headers),q)if(Object.getPrototypeOf(q)===Object.prototype)for(var se in q)V.set(se,q[se]);else if(typeof q.keys=="function"&&typeof q.get=="function")for(const pe of q.keys())V.set(pe,q.get(pe));else throw Error("Unknown input type for opt_headers: "+String(q));q=Array.from(V.keys()).find(pe=>pe.toLowerCase()=="content-type"),se=o.FormData&&y instanceof o.FormData,!(Array.prototype.indexOf.call(of,R,void 0)>=0)||q||se||V.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[pe,Ie]of V)this.g.setRequestHeader(pe,Ie);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(y),this.v=!1}catch(pe){Al(this,pe)}};function Al(y,R){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=R,y.o=5,lf(y),cs(y)}function lf(y){y.A||(y.A=!0,Oe(y,"complete"),Oe(y,"error"))}n.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=y||7,Oe(this,"complete"),Oe(this,"abort"),cs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),cs(this,!0)),Qt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Cl(this):this.Xa())},n.Xa=function(){Cl(this)};function Cl(y){if(y.h&&typeof a<"u"){if(y.v&&ta(y)==4)setTimeout(y.Ca.bind(y),0);else if(Oe(y,"readystatechange"),ta(y)==4){y.h=!1;try{const pe=y.ca();e:switch(pe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var R=!0;break e;default:R=!1}var V;if(!(V=R)){var q;if(q=pe===0){let Ie=String(y.D).match(ig)[1]||null;!Ie&&o.self&&o.self.location&&(Ie=o.self.location.protocol.slice(0,-1)),q=!Da.test(Ie?Ie.toLowerCase():"")}V=q}if(V)Oe(y,"complete"),Oe(y,"success");else{y.o=6;try{var se=ta(y)>2?y.g.statusText:""}catch{se=""}y.l=se+" ["+y.ca()+"]",lf(y)}}finally{cs(y)}}}}function cs(y,R){if(y.g){y.m&&(clearTimeout(y.m),y.m=null);const V=y.g;y.g=null,R||Oe(y,"ready");try{V.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ta(y){return y.g?y.g.readyState:0}n.ca=function(){try{return ta(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(y){if(this.g){var R=this.g.responseText;return y&&R.indexOf(y)==0&&(R=R.substring(y.length)),ui(R)}};function yr(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.F){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function us(y){const R={};y=(y.g&&ta(y)>=2&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let q=0;q<y.length;q++){if(P(y[q]))continue;var V=Et(y[q]);const se=V[0];if(V=V[1],typeof V!="string")continue;V=V.trim();const pe=R[se]||[];R[se]=pe,pe.push(V)}Q(R,function(q){return q.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ka(y,R,V){return V&&V.internalChannelParams&&V.internalChannelParams[y]||R}function oo(y){this.za=0,this.i=[],this.j=new qt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ka("failFast",!1,y),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ka("baseRetryDelayMs",5e3,y),this.Za=ka("retryDelaySeedMs",1e4,y),this.Ta=ka("forwardChannelMaxRetries",2,y),this.va=ka("forwardChannelRequestTimeoutMs",2e4,y),this.ma=y&&y.xmlHttpFactory||void 0,this.Ua=y&&y.Rb||void 0,this.Aa=y&&y.useFetchStreams||!1,this.O=void 0,this.L=y&&y.supportsCrossDomainXhr||!1,this.M="",this.h=new Wd(y&&y.concurrentRequestLimit),this.Ba=new ao,this.S=y&&y.fastHandshake||!1,this.R=y&&y.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=y&&y.Pb||!1,y&&y.ua&&this.j.ua(),y&&y.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&y&&y.detectBufferingProxy||!1,this.ia=void 0,y&&y.longPollingTimeout&&y.longPollingTimeout>0&&(this.ia=y.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=oo.prototype,n.ka=8,n.I=1,n.connect=function(y,R,V,q){dn(0),this.W=y,this.H=R||{},V&&q!==void 0&&(this.H.OSID=V,this.H.OAID=q),this.F=this.X,this.J=gg(this,null,this.W),Na(this)};function cf(y){if(Wc(y),y.I==3){var R=y.V++,V=Hn(y.J);if(Ht(V,"SID",y.M),Ht(V,"RID",R),Ht(V,"TYPE","terminate"),Il(y,V),R=new zt(y,y.j,R),R.M=2,R.A=wl(Hn(V)),V=!1,o.navigator&&o.navigator.sendBeacon)try{V=o.navigator.sendBeacon(R.A.toString(),"")}catch{}!V&&o.Image&&(new Image().src=R.A,V=!0),V||(R.g=mg(R.j,null),R.g.ea(R.A)),R.F=Date.now(),Ea(R)}pg(y)}function lo(y){y.g&&(df(y),y.g.cancel(),y.g=null)}function Wc(y){lo(y),y.v&&(o.clearTimeout(y.v),y.v=null),Zc(y),y.h.cancel(),y.m&&(typeof y.m=="number"&&o.clearTimeout(y.m),y.m=null)}function Na(y){if(!Qd(y.h)&&!y.m){y.m=!0;var R=y.Ea;M||I(),j||(M(),j=!0),C.add(R,y),y.D=0}}function Qc(y,R){return Aa(y.h)>=y.h.j-(y.m?1:0)?!1:y.m?(y.i=R.G.concat(y.i),!0):y.I==1||y.I==2||y.D>=(y.Sa?0:y.Ta)?!1:(y.m=ut(d(y.Ea,y,R),hg(y,y.D)),y.D++,!0)}n.Ea=function(y){if(this.m)if(this.m=null,this.I==1){if(!y){this.V=Math.floor(Math.random()*1e5),y=this.V++;const se=new zt(this,this.j,y);let pe=this.o;if(this.U&&(pe?(pe=G(pe),ee(pe,this.U)):pe=this.U),this.u!==null||this.R||(se.J=pe,pe=null),this.S)e:{for(var R=0,V=0;V<this.i.length;V++){t:{var q=this.i[V];if("__data__"in q.map&&(q=q.map.__data__,typeof q=="string")){q=q.length;break t}q=void 0}if(q===void 0)break;if(R+=q,R>4096){R=V;break e}if(R===4096||V===this.i.length-1){R=V+1;break e}}R=1e3}else R=1e3;R=cg(this,se,R),V=Hn(this.J),Ht(V,"RID",y),Ht(V,"CVER",22),this.G&&Ht(V,"X-HTTP-Session-Id",this.G),Il(this,V),pe&&(this.R?R="headers="+an(Ci(pe))+"&"+R:this.u&&Tl(V,this.u,pe)),Zd(this.h,se),this.Ra&&Ht(V,"TYPE","init"),this.S?(Ht(V,"$req",R),Ht(V,"SID","null"),se.U=!0,pr(se,V,null)):pr(se,V,R),this.I=2}}else this.I==3&&(y?uf(this,y):this.i.length==0||Qd(this.h)||uf(this))};function uf(y,R){var V;R?V=R.l:V=y.V++;const q=Hn(y.J);Ht(q,"SID",y.M),Ht(q,"RID",V),Ht(q,"AID",y.K),Il(y,q),y.u&&y.o&&Tl(q,y.u,y.o),V=new zt(y,y.j,V,y.D+1),y.u===null&&(V.J=y.o),R&&(y.i=R.G.concat(y.i)),R=cg(y,V,1e3),V.H=Math.round(y.va*.5)+Math.round(y.va*.5*Math.random()),Zd(y.h,V),pr(V,q,R)}function Il(y,R){y.H&&de(y.H,function(V,q){Ht(R,q,V)}),y.l&&de({},function(V,q){Ht(R,q,V)})}function cg(y,R,V){V=Math.min(y.i.length,V);const q=y.l?d(y.l.Ka,y.l,y):null;e:{var se=y.i;let dt=-1;for(;;){const Vn=["count="+V];dt==-1?V>0?(dt=se[0].g,Vn.push("ofs="+dt)):dt=0:Vn.push("ofs="+dt);let Lt=!0;for(let yn=0;yn<V;yn++){var pe=se[yn].g;const Ii=se[yn].map;if(pe-=dt,pe<0)dt=Math.max(0,se[yn].g-100),Lt=!1;else try{pe="req"+pe+"_"||"";try{var Ie=Ii instanceof Map?Ii:Object.entries(Ii);for(const[Pa,na]of Ie){let ra=na;c(na)&&(ra=jn(na)),Vn.push(pe+Pa+"="+encodeURIComponent(ra))}}catch(Pa){throw Vn.push(pe+"type="+encodeURIComponent("_badmap")),Pa}}catch{q&&q(Ii)}}if(Lt){Ie=Vn.join("&");break e}}Ie=void 0}return y=y.i.splice(0,V),R.G=y,Ie}function ug(y){if(!y.g&&!y.v){y.Y=1;var R=y.Da;M||I(),j||(M(),j=!0),C.add(R,y),y.A=0}}function Rl(y){return y.g||y.v||y.A>=3?!1:(y.Y++,y.v=ut(d(y.Da,y),hg(y,y.A)),y.A++,!0)}n.Da=function(){if(this.v=null,dg(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var y=4*this.T;this.j.info("BP detection timer enabled: "+y),this.B=ut(d(this.Wa,this),y)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,dn(10),lo(this),dg(this))};function df(y){y.B!=null&&(o.clearTimeout(y.B),y.B=null)}function dg(y){y.g=new zt(y,y.j,"rpc",y.Y),y.u===null&&(y.g.J=y.o),y.g.P=0;var R=Hn(y.na);Ht(R,"RID","rpc"),Ht(R,"SID",y.M),Ht(R,"AID",y.K),Ht(R,"CI",y.F?"0":"1"),!y.F&&y.ia&&Ht(R,"TO",y.ia),Ht(R,"TYPE","xmlhttp"),Il(y,R),y.u&&y.o&&Tl(R,y.u,y.o),y.O&&(y.g.H=y.O);var V=y.g;y=y.ba,V.M=1,V.A=wl(Hn(R)),V.u=null,V.R=!0,Dr(V,y)}n.Va=function(){this.C!=null&&(this.C=null,lo(this),Rl(this),dn(19))};function Zc(y){y.C!=null&&(o.clearTimeout(y.C),y.C=null)}function fg(y,R){var V=null;if(y.g==R){Zc(y),df(y),y.g=null;var q=2}else if(Ca(y.h,R))V=R.G,Jd(y.h,R),q=1;else return;if(y.I!=0){if(R.o)if(q==1){V=R.u?R.u.length:0,R=Date.now()-R.F;var se=y.D;q=_a(),Oe(q,new Pe(q,V)),Na(y)}else ug(y);else if(se=R.m,se==3||se==0&&R.X>0||!(q==1&&Qc(y,R)||q==2&&Rl(y)))switch(V&&V.length>0&&(R=y.h,R.i=R.i.concat(V)),se){case 1:Ma(y,5);break;case 4:Ma(y,10);break;case 3:Ma(y,6);break;default:Ma(y,2)}}}function hg(y,R){let V=y.Qa+Math.floor(Math.random()*y.Za);return y.isActive()||(V*=2),V*R}function Ma(y,R){if(y.j.info("Error code "+R),R==2){var V=d(y.bb,y),q=y.Ua;const se=!q;q=new hi(q||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||gr(q,"https"),wl(q),se?Ji(q.toString(),V):sf(q.toString(),V)}else dn(2);y.I=0,y.l&&y.l.pa(R),pg(y),Wc(y)}n.bb=function(y){y?(this.j.info("Successfully pinged google.com"),dn(2)):(this.j.info("Failed to ping google.com"),dn(1))};function pg(y){if(y.I=0,y.ja=[],y.l){const R=ef(y.h);(R.length!=0||y.i.length!=0)&&(_(y.ja,R),_(y.ja,y.i),y.h.i.length=0,b(y.i),y.i.length=0),y.l.oa()}}function gg(y,R,V){var q=V instanceof hi?Hn(V):new hi(V);if(q.g!="")R&&(q.g=R+"."+q.g),to(q,q.u);else{var se=o.location;q=se.protocol,R=R?R+"."+se.hostname:se.hostname,se=+se.port;const pe=new hi(null);q&&gr(pe,q),R&&(pe.g=R),se&&to(pe,se),V&&(pe.h=V),q=pe}return V=y.G,R=y.wa,V&&R&&Ht(q,V,R),Ht(q,"VER",y.ka),Il(y,q),q}function mg(y,R,V){if(R&&!y.L)throw Error("Can't create secondary domain capable XhrIo object.");return R=y.Aa&&!y.ma?new Qt(new Ra({ab:V})):new Qt(y.ma),R.Fa(y.L),R}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function vg(){}n=vg.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function co(){}co.prototype.g=function(y,R){return new Br(y,R)};function Br(y,R){Re.call(this),this.g=new oo(R),this.l=y,this.h=R&&R.messageUrlParams||null,y=R&&R.messageHeaders||null,R&&R.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=R&&R.initMessageHeaders||null,R&&R.messageContentType&&(y?y["X-WebChannel-Content-Type"]=R.messageContentType:y={"X-WebChannel-Content-Type":R.messageContentType}),R&&R.sa&&(y?y["X-WebChannel-Client-Profile"]=R.sa:y={"X-WebChannel-Client-Profile":R.sa}),this.g.U=y,(y=R&&R.Qb)&&!P(y)&&(this.g.u=y),this.A=R&&R.supportsCrossDomainXhr||!1,this.v=R&&R.sendRawJson||!1,(R=R&&R.httpSessionIdParam)&&!P(R)&&(this.g.G=R,y=this.h,y!==null&&R in y&&(y=this.h,R in y&&delete y[R])),this.j=new ds(this)}p(Br,Re),Br.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Br.prototype.close=function(){cf(this.g)},Br.prototype.o=function(y){var R=this.g;if(typeof y=="string"){var V={};V.__data__=y,y=V}else this.v&&(V={},V.__data__=jn(y),y=V);R.i.push(new qn(R.Ya++,y)),R.I==3&&Na(R)},Br.prototype.N=function(){this.g.l=null,delete this.j,cf(this.g),delete this.g,Br.Z.N.call(this)};function yg(y){Sn.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var R=y.__sm__;if(R){e:{for(const V in R){y=V;break e}y=void 0}(this.i=y)&&(y=this.i,R=R!==null&&y in R?R[y]:void 0),this.data=R}else this.data=y}p(yg,Sn);function bg(){rr.call(this),this.status=1}p(bg,rr);function ds(y){this.g=y}p(ds,vg),ds.prototype.ra=function(){Oe(this.g,"a")},ds.prototype.qa=function(y){Oe(this.g,new yg(y))},ds.prototype.pa=function(y){Oe(this.g,new bg)},ds.prototype.oa=function(){Oe(this.g,"b")},co.prototype.createWebChannel=co.prototype.g,Br.prototype.send=Br.prototype.o,Br.prototype.open=Br.prototype.m,Br.prototype.close=Br.prototype.close,RM=function(){return new co},IM=function(){return _a()},CM=cn,j1={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Dt.NO_ERROR=0,Dt.TIMEOUT=8,Dt.HTTP_ERROR=6,i0=Dt,kt.COMPLETE="complete",AM=kt,di.EventType=Ir,Ir.OPEN="a",Ir.CLOSE="b",Ir.ERROR="c",Ir.MESSAGE="d",Re.prototype.listen=Re.prototype.J,sh=di,Qt.prototype.listenOnce=Qt.prototype.K,Qt.prototype.getLastError=Qt.prototype.Ha,Qt.prototype.getLastErrorCode=Qt.prototype.ya,Qt.prototype.getStatus=Qt.prototype.ca,Qt.prototype.getResponseJson=Qt.prototype.La,Qt.prototype.getResponseText=Qt.prototype.la,Qt.prototype.send=Qt.prototype.ea,Qt.prototype.setWithCredentials=Qt.prototype.Fa,TM=Qt}).apply(typeof Cm<"u"?Cm:typeof self<"u"?self:typeof window<"u"?window:{});const fI="@firebase/firestore",hI="4.9.2";class Tr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Tr.UNAUTHENTICATED=new Tr(null),Tr.GOOGLE_CREDENTIALS=new Tr("google-credentials-uid"),Tr.FIRST_PARTY=new Tr("first-party-uid"),Tr.MOCK_USER=new Tr("mock-user");let Vd="12.3.0";const Tc=new hw("@firebase/firestore");function ju(){return Tc.logLevel}function Te(n,...e){if(Tc.logLevel<=At.DEBUG){const t=e.map(Sw);Tc.debug(`Firestore (${Vd}): ${n}`,...t)}}function qr(n,...e){if(Tc.logLevel<=At.ERROR){const t=e.map(Sw);Tc.error(`Firestore (${Vd}): ${n}`,...t)}}function Ac(n,...e){if(Tc.logLevel<=At.WARN){const t=e.map(Sw);Tc.warn(`Firestore (${Vd}): ${n}`,...t)}}function Sw(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Le(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,DM(n,r,t)}function DM(n,e,t){let r=`FIRESTORE (${Vd}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw qr(r),new Error(r)}function Fe(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||DM(e,i,r)}function ot(n,e){return n}const me={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ce extends Xs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Wa{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class kM{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class UF{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Tr.UNAUTHENTICATED)))}shutdown(){}}class FF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class GF{constructor(e){this.t=e,this.currentUser=Tr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Fe(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let a=new Wa;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Wa,e.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const u=a;e.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},c=u=>{Te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>c(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(Te("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Wa)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Fe(typeof r.accessToken=="string",31837,{l:r}),new kM(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Fe(e===null||typeof e=="string",2055,{h:e}),new Tr(e)}}class qF{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Tr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class HF{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new qF(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Tr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class pI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $F{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ui(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Fe(this.o===void 0,3512);const r=a=>{a.error!=null&&Te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.m;return this.m=a.token,Te("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>r(a)))};const i=a=>{Te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):Te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new pI(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Fe(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new pI(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function YF(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class Tw{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=YF(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+=e.charAt(i[a]%62))}return r}}function at(n,e){return n<e?-1:n>e?1:0}function V1(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),a=e.charAt(r);if(i!==a)return Dx(i)===Dx(a)?at(i,a):Dx(i)?1:-1}return at(n.length,e.length)}const KF=55296,XF=57343;function Dx(n){const e=n.charCodeAt(0);return e>=KF&&e<=XF}function ud(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function NM(n){return n+"\0"}const gI="__name__";class La{constructor(e,t,r){t===void 0?t=0:t>e.length&&Le(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Le(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return La.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof La?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=La.compareSegments(e.get(i),t.get(i));if(a!==0)return a}return at(e.length,t.length)}static compareSegments(e,t){const r=La.isNumericId(e),i=La.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?La.extractNumericId(e).compare(La.extractNumericId(t)):V1(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return el.fromString(e.substring(4,e.length-2))}}class Ut extends La{construct(e,t,r){return new Ut(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Ce(me.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new Ut(t)}static emptyPath(){return new Ut([])}}const WF=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class An extends La{construct(e,t,r){return new An(e,t,r)}static isValidIdentifier(e){return WF.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),An.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===gI}static keyField(){return new An([gI])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(r.length===0)throw new Ce(me.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new Ce(me.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Ce(me.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(r+=c,i++):(a(),i++)}if(a(),o)throw new Ce(me.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new An(t)}static emptyPath(){return new An([])}}class De{constructor(e){this.path=e}static fromPath(e){return new De(Ut.fromString(e))}static fromName(e){return new De(Ut.fromString(e).popFirst(5))}static empty(){return new De(Ut.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ut.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ut.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new De(new Ut(e.slice()))}}function MM(n,e,t){if(!t)throw new Ce(me.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function QF(n,e,t,r){if(e===!0&&r===!0)throw new Ce(me.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function mI(n){if(!De.isDocumentKey(n))throw new Ce(me.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function vI(n){if(De.isDocumentKey(n))throw new Ce(me.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function PM(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Iv(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Le(12329,{type:typeof n})}function jr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ce(me.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Iv(n);throw new Ce(me.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function er(n,e){const t={typeString:n};return e&&(t.value=e),t}function Ap(n,e){if(!PM(n))throw new Ce(me.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(a!==void 0&&o!==a.value){t=`Expected '${r}' field to equal '${a.value}'`;break}}if(t)throw new Ce(me.INVALID_ARGUMENT,t);return!0}const yI=-62135596800,bI=1e6;class vt{static now(){return vt.fromMillis(Date.now())}static fromDate(e){return vt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*bI);return new vt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ce(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ce(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<yI)throw new Ce(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ce(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/bI}_compareTo(e){return this.seconds===e.seconds?at(this.nanoseconds,e.nanoseconds):at(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:vt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ap(e,vt._jsonSchema))return new vt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-yI;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}vt._jsonSchemaVersion="firestore/timestamp/1.0",vt._jsonSchema={type:er("string",vt._jsonSchemaVersion),seconds:er("number"),nanoseconds:er("number")};class Xe{static fromTimestamp(e){return new Xe(e)}static min(){return new Xe(new vt(0,0))}static max(){return new Xe(new vt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const qh=-1;class O0{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function z1(n){return n.fields.find((e=>e.kind===2))}function Wl(n){return n.fields.filter((e=>e.kind!==2))}O0.UNKNOWN_ID=-1;class a0{constructor(e,t){this.fieldPath=e,this.kind=t}}class Hh{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Hh(0,Ei.min())}}function ZF(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Xe.fromTimestamp(r===1e9?new vt(t+1,0):new vt(t,r));return new Ei(i,De.empty(),e)}function OM(n){return new Ei(n.readTime,n.key,qh)}class Ei{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Ei(Xe.min(),De.empty(),qh)}static max(){return new Ei(Xe.max(),De.empty(),qh)}}function Aw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=De.comparator(n.documentKey,e.documentKey),t!==0?t:at(n.largestBatchId,e.largestBatchId))}const jM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class VM{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Bc(n){if(n.code!==me.FAILED_PRECONDITION||n.message!==jM)throw n;Te("LocalStore","Unexpectedly lost primary lease")}class ae{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Le(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ae(((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ae?t:ae.resolve(t)}catch(t){return ae.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.reject(t)}static resolve(e){return new ae(((t,r)=>{t(e)}))}static reject(e){return new ae(((t,r)=>{r(e)}))}static waitFor(e){return new ae(((t,r)=>{let i=0,a=0,o=!1;e.forEach((c=>{++i,c.next((()=>{++a,o&&a===i&&t()}),(u=>r(u)))})),o=!0,a===i&&t()}))}static or(e){let t=ae.resolve(!1);for(const r of e)t=t.next((i=>i?ae.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,a)=>{r.push(t.call(this,i,a))})),this.waitFor(r)}static mapArray(e,t){return new ae(((r,i)=>{const a=e.length,o=new Array(a);let c=0;for(let u=0;u<a;u++){const d=u;t(e[d]).next((h=>{o[d]=h,++c,c===a&&r(o)}),(h=>i(h)))}}))}static doWhile(e,t){return new ae(((r,i)=>{const a=()=>{e()===!0?t().next((()=>{a()}),i):r()};a()}))}}const _i="SimpleDb";class Rv{static open(e,t,r,i){try{return new Rv(t,e.transaction(i,r))}catch(a){throw new bh(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Wa,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new bh(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=Cw(r.target.error);this.S.reject(new bh(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Te(_i,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new e7(t)}}class tl{static delete(e){return Te(_i,"Removing database:",e),ec(AN().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!ON())return!1;if(tl.F())return!0;const e=fr(),t=tl.M(e),r=0<t&&t<10,i=zM(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,tl.M(fr())===12.2&&qr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Te(_i,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=a=>{const o=a.target.result;t(o)},i.onblocked=()=>{r(new bh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=a=>{const o=a.target.error;o.name==="VersionError"?r(new Ce(me.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Ce(me.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new bh(e,o))},i.onupgradeneeded=a=>{Te(_i,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const o=a.target.result;this.N.k(o,i.transaction,a.oldVersion,this.version).next((()=>{Te(_i,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const a=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const c=Rv.open(this.db,e,a?"readonly":"readwrite",r),u=i(c).next((d=>(c.C(),d))).catch((d=>(c.abort(d),ae.reject(d)))).toPromise();return u.catch((()=>{})),await c.D,u}catch(c){const u=c,d=u.name!=="FirebaseError"&&o<3;if(Te(_i,"Transaction failed with error:",u.message,"Retrying:",d),this.close(),!d)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function zM(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class JF{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return ec(this.U.delete())}}class bh extends Ce{constructor(e,t){super(me.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ml(n){return n.name==="IndexedDbTransactionError"}class e7{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Te(_i,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Te(_i,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ec(r)}add(e){return Te(_i,"ADD",this.store.name,e,e),ec(this.store.add(e))}get(e){return ec(this.store.get(e)).next((t=>(t===void 0&&(t=null),Te(_i,"GET",this.store.name,e,t),t)))}delete(e){return Te(_i,"DELETE",this.store.name,e),ec(this.store.delete(e))}count(){return Te(_i,"COUNT",this.store.name),ec(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const a=i.getAll(r.range);return new ae(((o,c)=>{a.onerror=u=>{c(u.target.error)},a.onsuccess=u=>{o(u.target.result)}}))}{const a=this.cursor(r),o=[];return this.H(a,((c,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new ae(((i,a)=>{r.onerror=o=>{a(o.target.error)},r.onsuccess=o=>{i(o.target.result)}}))}Z(e,t){Te(_i,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((a,o,c)=>c.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new ae(((r,i)=>{t.onerror=a=>{const o=Cw(a.target.error);i(o)},t.onsuccess=a=>{const o=a.target.result;o?e(o.primaryKey,o.value).next((c=>{c?o.continue():r()})):r()}}))}H(e,t){const r=[];return new ae(((i,a)=>{e.onerror=o=>{a(o.target.error)},e.onsuccess=o=>{const c=o.target.result;if(!c)return void i();const u=new JF(c),d=t(c.primaryKey,c.value,u);if(d instanceof ae){const h=d.catch((p=>(u.done(),ae.reject(p))));r.push(h)}u.isDone?i():u.G===null?c.continue():c.continue(u.G)}})).next((()=>ae.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function ec(n){return new ae(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=Cw(r.target.error);t(i)}}))}let xI=!1;function Cw(n){const e=tl.M(fr());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Ce("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return xI||(xI=!0,setTimeout((()=>{throw r}),0)),r}}return n}const xh="IndexBackfiller";class t7{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Te(xh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Te(xh,`Documents written: ${t}`)}catch(t){ml(t)?Te(xh,"Ignoring IndexedDB error during index backfill: ",t):await Bc(t)}await this.re(6e4)}))}}class n7{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,a=!0;return ae.doWhile((()=>a===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!r.has(o))return Te(xh,`Processing collection: ${o}`),this.oe(e,o,i).next((c=>{i-=c,r.add(o)}));a=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((a=>{const o=a.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(i,a))).next((c=>(Te(xh,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c)))).next((()=>o.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,a)=>{const o=OM(a);Aw(o,r)>0&&(r=o)})),new Ei(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Gi{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Gi.ce=-1;const pc=-1;function Dv(n){return n==null}function $h(n){return n===0&&1/n==-1/0}function r7(n){return typeof n=="number"&&Number.isInteger(n)&&!$h(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const j0="";function Vr(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=_I(e)),e=i7(n.get(t),e);return _I(e)}function i7(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="";break;case j0:t+="";break;default:t+=a}}return t}function _I(n){return n+j0+""}function qa(n){const e=n.length;if(Fe(e>=2,64408,{path:n}),e===2)return Fe(n.charAt(0)===j0&&n.charAt(1)==="",56145,{path:n}),Ut.emptyPath();const t=e-2,r=[];let i="";for(let a=0;a<e;){const o=n.indexOf(j0,a);switch((o<0||o>t)&&Le(50515,{path:n}),n.charAt(o+1)){case"":const c=n.substring(a,o);let u;i.length===0?u=c:(i+=c,u=i,i=""),r.push(u);break;case"":i+=n.substring(a,o),i+="\0";break;case"":i+=n.substring(a,o+1);break;default:Le(61167,{path:n})}a=o+2}return new Ut(r)}const Ql="remoteDocuments",Cp="owner",Ru="owner",Yh="mutationQueues",a7="userId",la="mutations",wI="batchId",lc="userMutationsIndex",EI=["userId","batchId"];function s0(n,e){return[n,Vr(e)]}function LM(n,e,t){return[n,Vr(e),t]}const s7={},dd="documentMutations",V0="remoteDocumentsV14",o7=["prefixPath","collectionGroup","readTime","documentId"],o0="documentKeyIndex",l7=["prefixPath","collectionGroup","documentId"],BM="collectionGroupIndex",c7=["collectionGroup","readTime","prefixPath","documentId"],Kh="remoteDocumentGlobal",L1="remoteDocumentGlobalKey",fd="targets",UM="queryTargetsIndex",u7=["canonicalId","targetId"],hd="targetDocuments",d7=["targetId","path"],Iw="documentTargetsIndex",f7=["path","targetId"],z0="targetGlobalKey",gc="targetGlobal",Xh="collectionParents",h7=["collectionId","parent"],pd="clientMetadata",p7="clientId",kv="bundles",g7="bundleId",Nv="namedQueries",m7="name",Rw="indexConfiguration",v7="indexId",B1="collectionGroupIndex",y7="collectionGroup",_h="indexState",b7=["indexId","uid"],FM="sequenceNumberIndex",x7=["uid","sequenceNumber"],wh="indexEntries",_7=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],GM="documentKeyIndex",w7=["indexId","uid","orderedDocumentKey"],Mv="documentOverlays",E7=["userId","collectionPath","documentId"],U1="collectionPathOverlayIndex",S7=["userId","collectionPath","largestBatchId"],qM="collectionGroupOverlayIndex",T7=["userId","collectionGroup","largestBatchId"],Dw="globals",A7="name",HM=[Yh,la,dd,Ql,fd,Cp,gc,hd,pd,Kh,Xh,kv,Nv],C7=[...HM,Mv],$M=[Yh,la,dd,V0,fd,Cp,gc,hd,pd,Kh,Xh,kv,Nv,Mv],YM=$M,kw=[...YM,Rw,_h,wh],I7=kw,KM=[...kw,Dw],R7=KM;class F1 extends VM{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function hr(n,e){const t=ot(n);return tl.O(t.le,e)}function SI(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function vl(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function XM(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class En{constructor(e,t){this.comparator=e,this.root=t||Ar.EMPTY}insert(e,t){return new En(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ar.BLACK,null,null))}remove(e){return new En(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ar.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Im(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Im(this.root,e,this.comparator,!1)}getReverseIterator(){return new Im(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Im(this.root,e,this.comparator,!0)}}class Im{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ar{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=r??Ar.RED,this.left=i??Ar.EMPTY,this.right=a??Ar.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new Ar(e??this.key,t??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):a===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ar.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Ar.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ar.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ar.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Le(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Le(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Le(27949);return e+(this.isRed()?0:1)}}Ar.EMPTY=null,Ar.RED=!0,Ar.BLACK=!1;Ar.EMPTY=new class{constructor(){this.size=0}get key(){throw Le(57766)}get value(){throw Le(16141)}get color(){throw Le(16727)}get left(){throw Le(29726)}get right(){throw Le(36894)}copy(e,t,r,i,a){return this}insert(e,t,r){return new Ar(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Xt{constructor(e){this.comparator=e,this.data=new En(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new TI(this.data.getIterator())}getIteratorFrom(e){return new TI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Xt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Xt(this.comparator);return t.data=e,t}}class TI{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Du(n){return n.hasNext()?n.getNext():void 0}class ri{constructor(e){this.fields=e,e.sort(An.comparator)}static empty(){return new ri([])}unionWith(e){let t=new Xt(An.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new ri(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ud(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class WM extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class tr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new WM("Invalid base64 string: "+a):a}})(e);return new tr(t)}static fromUint8Array(e){const t=(function(i){let a="";for(let o=0;o<i.length;++o)a+=String.fromCharCode(i[o]);return a})(e);return new tr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return at(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}tr.EMPTY_BYTE_STRING=new tr("");const D7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Us(n){if(Fe(!!n,39018),typeof n=="string"){let e=0;const t=D7.exec(n);if(Fe(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:_n(n.seconds),nanos:_n(n.nanos)}}function _n(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Fs(n){return typeof n=="string"?tr.fromBase64String(n):tr.fromUint8Array(n)}const QM="server_timestamp",ZM="__type__",JM="__previous_value__",eP="__local_write_time__";function Nw(n){return(n?.mapValue?.fields||{})[ZM]?.stringValue===QM}function Pv(n){const e=n.mapValue.fields[JM];return Nw(e)?Pv(e):e}function Wh(n){const e=Us(n.mapValue.fields[eP].timestampValue);return new vt(e.seconds,e.nanos)}class k7{constructor(e,t,r,i,a,o,c,u,d,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=h}}const L0="(default)";class Cc{constructor(e,t){this.projectId=e,this.database=t||L0}static empty(){return new Cc("","")}get isDefaultDatabase(){return this.database===L0}isEqual(e){return e instanceof Cc&&e.projectId===this.projectId&&e.database===this.database}}const Mw="__type__",tP="__max__",Yo={mapValue:{fields:{__type__:{stringValue:tP}}}},Pw="__vector__",gd="value",l0={nullValue:"NULL_VALUE"};function al(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Nw(n)?4:nP(n)?9007199254740991:Ov(n)?10:11:Le(28295,{value:n})}function ns(n,e){if(n===e)return!0;const t=al(n);if(t!==al(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Wh(n).isEqual(Wh(e));case 3:return(function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const o=Us(i.timestampValue),c=Us(a.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,a){return Fs(i.bytesValue).isEqual(Fs(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,a){return _n(i.geoPointValue.latitude)===_n(a.geoPointValue.latitude)&&_n(i.geoPointValue.longitude)===_n(a.geoPointValue.longitude)})(n,e);case 2:return(function(i,a){if("integerValue"in i&&"integerValue"in a)return _n(i.integerValue)===_n(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const o=_n(i.doubleValue),c=_n(a.doubleValue);return o===c?$h(o)===$h(c):isNaN(o)&&isNaN(c)}return!1})(n,e);case 9:return ud(n.arrayValue.values||[],e.arrayValue.values||[],ns);case 10:case 11:return(function(i,a){const o=i.mapValue.fields||{},c=a.mapValue.fields||{};if(SI(o)!==SI(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!ns(o[u],c[u])))return!1;return!0})(n,e);default:return Le(52216,{left:n})}}function Qh(n,e){return(n.values||[]).find((t=>ns(t,e)))!==void 0}function sl(n,e){if(n===e)return 0;const t=al(n),r=al(e);if(t!==r)return at(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return at(n.booleanValue,e.booleanValue);case 2:return(function(a,o){const c=_n(a.integerValue||a.doubleValue),u=_n(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1})(n,e);case 3:return AI(n.timestampValue,e.timestampValue);case 4:return AI(Wh(n),Wh(e));case 5:return V1(n.stringValue,e.stringValue);case 6:return(function(a,o){const c=Fs(a),u=Fs(o);return c.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(a,o){const c=a.split("/"),u=o.split("/");for(let d=0;d<c.length&&d<u.length;d++){const h=at(c[d],u[d]);if(h!==0)return h}return at(c.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,o){const c=at(_n(a.latitude),_n(o.latitude));return c!==0?c:at(_n(a.longitude),_n(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return CI(n.arrayValue,e.arrayValue);case 10:return(function(a,o){const c=a.fields||{},u=o.fields||{},d=c[gd]?.arrayValue,h=u[gd]?.arrayValue,p=at(d?.values?.length||0,h?.values?.length||0);return p!==0?p:CI(d,h)})(n.mapValue,e.mapValue);case 11:return(function(a,o){if(a===Yo.mapValue&&o===Yo.mapValue)return 0;if(a===Yo.mapValue)return 1;if(o===Yo.mapValue)return-1;const c=a.fields||{},u=Object.keys(c),d=o.fields||{},h=Object.keys(d);u.sort(),h.sort();for(let p=0;p<u.length&&p<h.length;++p){const m=V1(u[p],h[p]);if(m!==0)return m;const b=sl(c[u[p]],d[h[p]]);if(b!==0)return b}return at(u.length,h.length)})(n.mapValue,e.mapValue);default:throw Le(23264,{he:t})}}function AI(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return at(n,e);const t=Us(n),r=Us(e),i=at(t.seconds,r.seconds);return i!==0?i:at(t.nanos,r.nanos)}function CI(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const a=sl(t[i],r[i]);if(a)return a}return at(t.length,r.length)}function md(n){return G1(n)}function G1(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=Us(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Fs(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return De.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const a of t.values||[])i?i=!1:r+=",",r+=G1(a);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",a=!0;for(const o of r)a?a=!1:i+=",",i+=`${o}:${G1(t.fields[o])}`;return i+"}"})(n.mapValue):Le(61005,{value:n})}function c0(n){switch(al(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Pv(n);return e?16+c0(e):16;case 5:return 2*n.stringValue.length;case 6:return Fs(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,a)=>i+c0(a)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return vl(r.fields,((a,o)=>{i+=a.length+c0(o)})),i})(n.mapValue);default:throw Le(13486,{value:n})}}function Zh(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function q1(n){return!!n&&"integerValue"in n}function Jh(n){return!!n&&"arrayValue"in n}function II(n){return!!n&&"nullValue"in n}function RI(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function u0(n){return!!n&&"mapValue"in n}function Ov(n){return(n?.mapValue?.fields||{})[Mw]?.stringValue===Pw}function Eh(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return vl(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Eh(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Eh(n.arrayValue.values[t]);return e}return{...n}}function nP(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===tP}const rP={mapValue:{fields:{[Mw]:{stringValue:Pw},[gd]:{arrayValue:{}}}}};function N7(n){return"nullValue"in n?l0:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Zh(Cc.empty(),De.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Ov(n)?rP:{mapValue:{}}:Le(35942,{value:n})}function M7(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Zh(Cc.empty(),De.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?rP:"mapValue"in n?Ov(n)?{mapValue:{}}:Yo:Le(61959,{value:n})}function DI(n,e){const t=sl(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function kI(n,e){const t=sl(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Pr{constructor(e){this.value=e}static empty(){return new Pr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!u0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Eh(t)}setAll(e){let t=An.emptyPath(),r={},i=[];e.forEach(((o,c)=>{if(!t.isImmediateParentOf(c)){const u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=c.popLast()}o?r[c.lastSegment()]=Eh(o):i.push(c.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());u0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ns(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];u0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){vl(t,((i,a)=>e[i]=a));for(const i of r)delete e[i]}clone(){return new Pr(Eh(this.value))}}function iP(n){const e=[];return vl(n.fields,((t,r)=>{const i=new An([t]);if(u0(r)){const a=iP(r.mapValue).fields;if(a.length===0)e.push(i);else for(const o of a)e.push(i.child(o))}else e.push(i)})),new ri(e)}class Nn{constructor(e,t,r,i,a,o,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=a,this.data=o,this.documentState=c}static newInvalidDocument(e){return new Nn(e,0,Xe.min(),Xe.min(),Xe.min(),Pr.empty(),0)}static newFoundDocument(e,t,r,i){return new Nn(e,1,t,Xe.min(),r,i,0)}static newNoDocument(e,t){return new Nn(e,2,t,Xe.min(),Xe.min(),Pr.empty(),0)}static newUnknownDocument(e,t){return new Nn(e,3,t,Xe.min(),Xe.min(),Pr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Xe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Xe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Nn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Nn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class vd{constructor(e,t){this.position=e,this.inclusive=t}}function NI(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],o=n.position[i];if(a.field.isKeyField()?r=De.comparator(De.fromName(o.referenceValue),t.key):r=sl(o,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function MI(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ns(n.position[t],e.position[t]))return!1;return!0}class ep{constructor(e,t="asc"){this.field=e,this.dir=t}}function P7(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class aP{}class Ct extends aP{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new O7(e,t,r):t==="array-contains"?new z7(e,r):t==="in"?new dP(e,r):t==="not-in"?new L7(e,r):t==="array-contains-any"?new B7(e,r):new Ct(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new j7(e,r):new V7(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(sl(t,this.value)):t!==null&&al(this.value)===al(t)&&this.matchesComparison(sl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Le(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Kt extends aP{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Kt(e,t)}matches(e){return yd(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function yd(n){return n.op==="and"}function H1(n){return n.op==="or"}function Ow(n){return sP(n)&&yd(n)}function sP(n){for(const e of n.filters)if(e instanceof Kt)return!1;return!0}function $1(n){if(n instanceof Ct)return n.field.canonicalString()+n.op.toString()+md(n.value);if(Ow(n))return n.filters.map((e=>$1(e))).join(",");{const e=n.filters.map((t=>$1(t))).join(",");return`${n.op}(${e})`}}function oP(n,e){return n instanceof Ct?(function(r,i){return i instanceof Ct&&r.op===i.op&&r.field.isEqual(i.field)&&ns(r.value,i.value)})(n,e):n instanceof Kt?(function(r,i){return i instanceof Kt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((a,o,c)=>a&&oP(o,i.filters[c])),!0):!1})(n,e):void Le(19439)}function lP(n,e){const t=n.filters.concat(e);return Kt.create(t,n.op)}function cP(n){return n instanceof Ct?(function(t){return`${t.field.canonicalString()} ${t.op} ${md(t.value)}`})(n):n instanceof Kt?(function(t){return t.op.toString()+" {"+t.getFilters().map(cP).join(" ,")+"}"})(n):"Filter"}class O7 extends Ct{constructor(e,t,r){super(e,t,r),this.key=De.fromName(r.referenceValue)}matches(e){const t=De.comparator(e.key,this.key);return this.matchesComparison(t)}}class j7 extends Ct{constructor(e,t){super(e,"in",t),this.keys=uP("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class V7 extends Ct{constructor(e,t){super(e,"not-in",t),this.keys=uP("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function uP(n,e){return(e.arrayValue?.values||[]).map((t=>De.fromName(t.referenceValue)))}class z7 extends Ct{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Jh(t)&&Qh(t.arrayValue,this.value)}}class dP extends Ct{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Qh(this.value.arrayValue,t)}}class L7 extends Ct{constructor(e,t){super(e,"not-in",t)}matches(e){if(Qh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Qh(this.value.arrayValue,t)}}class B7 extends Ct{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Jh(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Qh(this.value.arrayValue,r)))}}class U7{constructor(e,t=null,r=[],i=[],a=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=c,this.Te=null}}function Y1(n,e=null,t=[],r=[],i=null,a=null,o=null){return new U7(n,e,t,r,i,a,o)}function Ic(n){const e=ot(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>$1(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(a){return a.field.canonicalString()+a.dir})(r))).join(","),Dv(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>md(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>md(r))).join(",")),e.Te=t}return e.Te}function Ip(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!P7(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!oP(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!MI(n.startAt,e.startAt)&&MI(n.endAt,e.endAt)}function B0(n){return De.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function U0(n,e){return n.filters.filter((t=>t instanceof Ct&&t.field.isEqual(e)))}function PI(n,e,t){let r=l0,i=!0;for(const a of U0(n,e)){let o=l0,c=!0;switch(a.op){case"<":case"<=":o=N7(a.value);break;case"==":case"in":case">=":o=a.value;break;case">":o=a.value,c=!1;break;case"!=":case"not-in":o=l0}DI({value:r,inclusive:i},{value:o,inclusive:c})<0&&(r=o,i=c)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const o=t.position[a];DI({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function OI(n,e,t){let r=Yo,i=!0;for(const a of U0(n,e)){let o=Yo,c=!0;switch(a.op){case">=":case">":o=M7(a.value),c=!1;break;case"==":case"in":case"<=":o=a.value;break;case"<":o=a.value,c=!1;break;case"!=":case"not-in":o=Yo}kI({value:r,inclusive:i},{value:o,inclusive:c})>0&&(r=o,i=c)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const o=t.position[a];kI({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}class zd{constructor(e,t=null,r=[],i=[],a=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function F7(n,e,t,r,i,a,o,c){return new zd(n,e,t,r,i,a,o,c)}function Rp(n){return new zd(n)}function jI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function fP(n){return n.collectionGroup!==null}function Sh(n){const e=ot(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Xt(An.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((d=>{d.isInequality()&&(c=c.add(d.field))}))})),c})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new ep(a,r))})),t.has(An.keyField().canonicalString())||e.Ie.push(new ep(An.keyField(),r))}return e.Ie}function Hi(n){const e=ot(n);return e.Ee||(e.Ee=G7(e,Sh(n))),e.Ee}function G7(n,e){if(n.limitType==="F")return Y1(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const a=i.dir==="desc"?"asc":"desc";return new ep(i.field,a)}));const t=n.endAt?new vd(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new vd(n.startAt.position,n.startAt.inclusive):null;return Y1(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function K1(n,e){const t=n.filters.concat([e]);return new zd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function F0(n,e,t){return new zd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function jv(n,e){return Ip(Hi(n),Hi(e))&&n.limitType===e.limitType}function hP(n){return`${Ic(Hi(n))}|lt:${n.limitType}`}function Vu(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>cP(i))).join(", ")}]`),Dv(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>md(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>md(i))).join(",")),`Target(${r})`})(Hi(n))}; limitType=${n.limitType})`}function Dp(n,e){return e.isFoundDocument()&&(function(r,i){const a=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):De.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)})(n,e)&&(function(r,i){for(const a of Sh(r))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const a of r.filters)if(!a.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,c,u){const d=NI(o,c,u);return o.inclusive?d<=0:d<0})(r.startAt,Sh(r),i)||r.endAt&&!(function(o,c,u){const d=NI(o,c,u);return o.inclusive?d>=0:d>0})(r.endAt,Sh(r),i))})(n,e)}function q7(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function pP(n){return(e,t)=>{let r=!1;for(const i of Sh(n)){const a=H7(i,e,t);if(a!==0)return a;r=r||i.field.isKeyField()}return 0}}function H7(n,e,t){const r=n.field.isKeyField()?De.comparator(e.key,t.key):(function(a,o,c){const u=o.data.field(a),d=c.data.field(a);return u!==null&&d!==null?sl(u,d):Le(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Le(19790,{direction:n.dir})}}class Qs{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,a]of r)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){vl(this.inner,((t,r)=>{for(const[i,a]of r)e(i,a)}))}isEmpty(){return XM(this.inner)}size(){return this.innerSize}}const $7=new En(De.comparator);function wi(){return $7}const gP=new En(De.comparator);function oh(...n){let e=gP;for(const t of n)e=e.insert(t.key,t);return e}function mP(n){let e=gP;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Ha(){return Th()}function vP(){return Th()}function Th(){return new Qs((n=>n.toString()),((n,e)=>n.isEqual(e)))}const Y7=new En(De.comparator),K7=new Xt(De.comparator);function xt(...n){let e=K7;for(const t of n)e=e.add(t);return e}const X7=new Xt(at);function W7(){return X7}function jw(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$h(e)?"-0":e}}function yP(n){return{integerValue:""+n}}function Q7(n,e){return r7(e)?yP(e):jw(n,e)}class Vv{constructor(){this._=void 0}}function Z7(n,e,t){return n instanceof tp?(function(i,a){const o={fields:{[ZM]:{stringValue:QM},[eP]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Nw(a)&&(a=Pv(a)),a&&(o.fields[JM]=a),{mapValue:o}})(t,e):n instanceof Rc?xP(n,e):n instanceof bd?_P(n,e):(function(i,a){const o=bP(i,a),c=VI(o)+VI(i.Ae);return q1(o)&&q1(i.Ae)?yP(c):jw(i.serializer,c)})(n,e)}function J7(n,e,t){return n instanceof Rc?xP(n,e):n instanceof bd?_P(n,e):t}function bP(n,e){return n instanceof np?(function(r){return q1(r)||(function(a){return!!a&&"doubleValue"in a})(r)})(e)?e:{integerValue:0}:null}class tp extends Vv{}class Rc extends Vv{constructor(e){super(),this.elements=e}}function xP(n,e){const t=wP(e);for(const r of n.elements)t.some((i=>ns(i,r)))||t.push(r);return{arrayValue:{values:t}}}class bd extends Vv{constructor(e){super(),this.elements=e}}function _P(n,e){let t=wP(e);for(const r of n.elements)t=t.filter((i=>!ns(i,r)));return{arrayValue:{values:t}}}class np extends Vv{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function VI(n){return _n(n.integerValue||n.doubleValue)}function wP(n){return Jh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class EP{constructor(e,t){this.field=e,this.transform=t}}function eG(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Rc&&i instanceof Rc||r instanceof bd&&i instanceof bd?ud(r.elements,i.elements,ns):r instanceof np&&i instanceof np?ns(r.Ae,i.Ae):r instanceof tp&&i instanceof tp})(n.transform,e.transform)}class tG{constructor(e,t){this.version=e,this.transformResults=t}}class dr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new dr}static exists(e){return new dr(void 0,e)}static updateTime(e){return new dr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function d0(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class zv{}function SP(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new kp(n.key,dr.none()):new Ld(n.key,n.data,dr.none());{const t=n.data,r=Pr.empty();let i=new Xt(An.comparator);for(let a of e.fields)if(!i.has(a)){let o=t.field(a);o===null&&a.length>1&&(a=a.popLast(),o=t.field(a)),o===null?r.delete(a):r.set(a,o),i=i.add(a)}return new Zs(n.key,r,new ri(i.toArray()),dr.none())}}function nG(n,e,t){n instanceof Ld?(function(i,a,o){const c=i.value.clone(),u=LI(i.fieldTransforms,a,o.transformResults);c.setAll(u),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):n instanceof Zs?(function(i,a,o){if(!d0(i.precondition,a))return void a.convertToUnknownDocument(o.version);const c=LI(i.fieldTransforms,a,o.transformResults),u=a.data;u.setAll(TP(i)),u.setAll(c),a.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(i,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Ah(n,e,t,r){return n instanceof Ld?(function(a,o,c,u){if(!d0(a.precondition,o))return c;const d=a.value.clone(),h=BI(a.fieldTransforms,u,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof Zs?(function(a,o,c,u){if(!d0(a.precondition,o))return c;const d=BI(a.fieldTransforms,u,o),h=o.data;return h.setAll(TP(a)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((p=>p.field)))})(n,e,t,r):(function(a,o,c){return d0(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(n,e,t)}function rG(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=bP(r.transform,i||null);a!=null&&(t===null&&(t=Pr.empty()),t.set(r.field,a))}return t||null}function zI(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ud(r,i,((a,o)=>eG(a,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ld extends zv{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Zs extends zv{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function TP(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function LI(n,e,t){const r=new Map;Fe(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const a=n[i],o=a.transform,c=e.data.field(a.field);r.set(a.field,J7(o,c,t[i]))}return r}function BI(n,e,t){const r=new Map;for(const i of n){const a=i.transform,o=t.data.field(i.field);r.set(i.field,Z7(a,o,e))}return r}class kp extends zv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class AP extends zv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Vw{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&nG(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ah(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Ah(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=vP();return this.mutations.forEach((i=>{const a=e.get(i.key),o=a.overlayedDocument;let c=this.applyToLocalView(o,a.mutatedFields);c=t.has(i.key)?null:c;const u=SP(o,c);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Xe.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),xt())}isEqual(e){return this.batchId===e.batchId&&ud(this.mutations,e.mutations,((t,r)=>zI(t,r)))&&ud(this.baseMutations,e.baseMutations,((t,r)=>zI(t,r)))}}class zw{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Fe(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return Y7})();const a=e.mutations;for(let o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new zw(e,t,r,i)}}class Lw{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class iG{constructor(e,t){this.count=e,this.unchangedNames=t}}var Qn,Rt;function aG(n){switch(n){case me.OK:return Le(64938);case me.CANCELLED:case me.UNKNOWN:case me.DEADLINE_EXCEEDED:case me.RESOURCE_EXHAUSTED:case me.INTERNAL:case me.UNAVAILABLE:case me.UNAUTHENTICATED:return!1;case me.INVALID_ARGUMENT:case me.NOT_FOUND:case me.ALREADY_EXISTS:case me.PERMISSION_DENIED:case me.FAILED_PRECONDITION:case me.ABORTED:case me.OUT_OF_RANGE:case me.UNIMPLEMENTED:case me.DATA_LOSS:return!0;default:return Le(15467,{code:n})}}function CP(n){if(n===void 0)return qr("GRPC error has no .code"),me.UNKNOWN;switch(n){case Qn.OK:return me.OK;case Qn.CANCELLED:return me.CANCELLED;case Qn.UNKNOWN:return me.UNKNOWN;case Qn.DEADLINE_EXCEEDED:return me.DEADLINE_EXCEEDED;case Qn.RESOURCE_EXHAUSTED:return me.RESOURCE_EXHAUSTED;case Qn.INTERNAL:return me.INTERNAL;case Qn.UNAVAILABLE:return me.UNAVAILABLE;case Qn.UNAUTHENTICATED:return me.UNAUTHENTICATED;case Qn.INVALID_ARGUMENT:return me.INVALID_ARGUMENT;case Qn.NOT_FOUND:return me.NOT_FOUND;case Qn.ALREADY_EXISTS:return me.ALREADY_EXISTS;case Qn.PERMISSION_DENIED:return me.PERMISSION_DENIED;case Qn.FAILED_PRECONDITION:return me.FAILED_PRECONDITION;case Qn.ABORTED:return me.ABORTED;case Qn.OUT_OF_RANGE:return me.OUT_OF_RANGE;case Qn.UNIMPLEMENTED:return me.UNIMPLEMENTED;case Qn.DATA_LOSS:return me.DATA_LOSS;default:return Le(39323,{code:n})}}(Rt=Qn||(Qn={}))[Rt.OK=0]="OK",Rt[Rt.CANCELLED=1]="CANCELLED",Rt[Rt.UNKNOWN=2]="UNKNOWN",Rt[Rt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Rt[Rt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Rt[Rt.NOT_FOUND=5]="NOT_FOUND",Rt[Rt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Rt[Rt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Rt[Rt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Rt[Rt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Rt[Rt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Rt[Rt.ABORTED=10]="ABORTED",Rt[Rt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Rt[Rt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Rt[Rt.INTERNAL=13]="INTERNAL",Rt[Rt.UNAVAILABLE=14]="UNAVAILABLE",Rt[Rt.DATA_LOSS=15]="DATA_LOSS";function sG(){return new TextEncoder}const oG=new el([4294967295,4294967295],0);function UI(n){const e=sG().encode(n),t=new SM;return t.update(e),new Uint8Array(t.digest())}function FI(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new el([t,r],0),new el([i,a],0)]}class Bw{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new lh(`Invalid padding: ${t}`);if(r<0)throw new lh(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new lh(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new lh(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=el.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(el.fromNumber(r)));return i.compare(oG)===1&&(i=new el([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=UI(e),[r,i]=FI(t);for(let a=0;a<this.hashCount;a++){const o=this.ye(r,i,a);if(!this.we(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new Bw(a,i,t);return r.forEach((c=>o.insert(c))),o}insert(e){if(this.ge===0)return;const t=UI(e),[r,i]=FI(t);for(let a=0;a<this.hashCount;a++){const o=this.ye(r,i,a);this.Se(o)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class lh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Lv{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Np.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Lv(Xe.min(),i,new En(at),wi(),xt())}}class Np{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Np(r,t,xt(),xt(),xt())}}class f0{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class IP{constructor(e,t){this.targetId=e,this.Ce=t}}class RP{constructor(e,t,r=tr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class GI{constructor(){this.ve=0,this.Fe=qI(),this.Me=tr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=xt(),t=xt(),r=xt();return this.Fe.forEach(((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Le(38017,{changeType:a})}})),new Np(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=qI()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Fe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class lG{constructor(e){this.Ge=e,this.ze=new Map,this.je=wi(),this.Je=Rm(),this.He=Rm(),this.Ye=new En(at)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Le(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const a=i.target;if(B0(a))if(r===0){const o=new De(a.path);this.et(t,o,Nn.newNoDocument(o,Xe.min()))}else Fe(r===1,20013,{expectedCount:r});else{const o=this._t(t);if(o!==r){const c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(t);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,d)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:a=0}=t;let o,c;try{o=Fs(r).toUint8Array()}catch(u){if(u instanceof WM)return Ac("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Bw(o,i,a)}catch(u){return Ac(u instanceof lh?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((a=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.et(t,a,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((a,o)=>{const c=this.ot(o);if(c){if(a.current&&B0(c.target)){const u=new De(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,Nn.newNoDocument(u,e))}a.Be&&(t.set(o,a.ke()),a.qe())}}));let r=xt();this.He.forEach(((a,o)=>{let c=!0;o.forEachWhile((u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(a))})),this.je.forEach(((a,o)=>o.setReadTime(e)));const i=new Lv(e,t,this.Ye,this.je,r);return this.je=wi(),this.Je=Rm(),this.He=Rm(),this.Ye=new En(at),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new GI,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Xt(at),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Xt(at),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Te("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new GI),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Rm(){return new En(De.comparator)}function qI(){return new En(De.comparator)}const cG={asc:"ASCENDING",desc:"DESCENDING"},uG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},dG={and:"AND",or:"OR"};class fG{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function X1(n,e){return n.useProto3Json||Dv(e)?e:{value:e}}function xd(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function DP(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function hG(n,e){return xd(n,e.toTimestamp())}function Yr(n){return Fe(!!n,49232),Xe.fromTimestamp((function(t){const r=Us(t);return new vt(r.seconds,r.nanos)})(n))}function Uw(n,e){return W1(n,e).canonicalString()}function W1(n,e){const t=(function(i){return new Ut(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function kP(n){const e=Ut.fromString(n);return Fe(BP(e),10190,{key:e.toString()}),e}function G0(n,e){return Uw(n.databaseId,e.path)}function mc(n,e){const t=kP(e);if(t.get(1)!==n.databaseId.projectId)throw new Ce(me.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ce(me.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new De(PP(t))}function NP(n,e){return Uw(n.databaseId,e)}function MP(n){const e=kP(n);return e.length===4?Ut.emptyPath():PP(e)}function Q1(n){return new Ut(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function PP(n){return Fe(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function HI(n,e,t){return{name:G0(n,e),fields:t.value.mapValue.fields}}function pG(n,e,t){const r=mc(n,e.name),i=Yr(e.updateTime),a=e.createTime?Yr(e.createTime):Xe.min(),o=new Pr({mapValue:{fields:e.fields}}),c=Nn.newFoundDocument(r,i,a,o);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function gG(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Le(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=(function(d,h){return d.useProto3Json?(Fe(h===void 0||typeof h=="string",58123),tr.fromBase64String(h||"")):(Fe(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),tr.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(d){const h=d.code===void 0?me.UNKNOWN:CP(d.code);return new Ce(h,d.message||"")})(o);t=new RP(r,i,a,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=mc(n,r.document.name),a=Yr(r.document.updateTime),o=r.document.createTime?Yr(r.document.createTime):Xe.min(),c=new Pr({mapValue:{fields:r.document.fields}}),u=Nn.newFoundDocument(i,a,o,c),d=r.targetIds||[],h=r.removedTargetIds||[];t=new f0(d,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=mc(n,r.document),a=r.readTime?Yr(r.readTime):Xe.min(),o=Nn.newNoDocument(i,a),c=r.removedTargetIds||[];t=new f0([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=mc(n,r.document),a=r.removedTargetIds||[];t=new f0([],a,i,null)}else{if(!("filter"in e))return Le(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:a}=r,o=new iG(i,a),c=r.targetId;t=new IP(c,o)}}return t}function q0(n,e){let t;if(e instanceof Ld)t={update:HI(n,e.key,e.value)};else if(e instanceof kp)t={delete:G0(n,e.key)};else if(e instanceof Zs)t={update:HI(n,e.key,e.data),updateMask:_G(e.fieldMask)};else{if(!(e instanceof AP))return Le(16599,{Vt:e.type});t={verify:G0(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(a,o){const c=o.transform;if(c instanceof tp)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Rc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof bd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof np)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw Le(20930,{transform:o.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,a){return a.updateTime!==void 0?{updateTime:hG(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Le(27497)})(n,e.precondition)),t}function Z1(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?dr.updateTime(Yr(a.updateTime)):a.exists!==void 0?dr.exists(a.exists):dr.none()})(e.currentDocument):dr.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(o,c){let u=null;if("setToServerValue"in c)Fe(c.setToServerValue==="REQUEST_TIME",16630,{proto:c}),u=new tp;else if("appendMissingElements"in c){const h=c.appendMissingElements.values||[];u=new Rc(h)}else if("removeAllFromArray"in c){const h=c.removeAllFromArray.values||[];u=new bd(h)}else"increment"in c?u=new np(o,c.increment):Le(16584,{proto:c});const d=An.fromServerFormat(c.fieldPath);return new EP(d,u)})(n,i))):[];if(e.update){e.update.name;const i=mc(n,e.update.name),a=new Pr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const d=u.fieldPaths||[];return new ri(d.map((h=>An.fromServerFormat(h))))})(e.updateMask);return new Zs(i,a,o,t,r)}return new Ld(i,a,t,r)}if(e.delete){const i=mc(n,e.delete);return new kp(i,t)}if(e.verify){const i=mc(n,e.verify);return new AP(i,t)}return Le(1463,{proto:e})}function mG(n,e){return n&&n.length>0?(Fe(e!==void 0,14353),n.map((t=>(function(i,a){let o=i.updateTime?Yr(i.updateTime):Yr(a);return o.isEqual(Xe.min())&&(o=Yr(a)),new tG(o,i.transformResults||[])})(t,e)))):[]}function OP(n,e){return{documents:[NP(n,e.path)]}}function jP(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=NP(n,i);const a=(function(d){if(d.length!==0)return LP(Kt.create(d,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const o=(function(d){if(d.length!==0)return d.map((h=>(function(m){return{field:zu(m.field),direction:yG(m.dir)}})(h)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const c=X1(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:i}}function VP(n){let e=MP(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Fe(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let a=[];t.where&&(a=(function(p){const m=zP(p);return m instanceof Kt&&Ow(m)?m.getFilters():[m]})(t.where));let o=[];t.orderBy&&(o=(function(p){return p.map((m=>(function(_){return new ep(Lu(_.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(_.direction))})(m)))})(t.orderBy));let c=null;t.limit&&(c=(function(p){let m;return m=typeof p=="object"?p.value:p,Dv(m)?null:m})(t.limit));let u=null;t.startAt&&(u=(function(p){const m=!!p.before,b=p.values||[];return new vd(b,m)})(t.startAt));let d=null;return t.endAt&&(d=(function(p){const m=!p.before,b=p.values||[];return new vd(b,m)})(t.endAt)),F7(e,i,o,a,c,"F",u,d)}function vG(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function zP(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Lu(t.unaryFilter.field);return Ct.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Lu(t.unaryFilter.field);return Ct.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Lu(t.unaryFilter.field);return Ct.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Lu(t.unaryFilter.field);return Ct.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Le(61313);default:return Le(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ct.create(Lu(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Le(58110);default:return Le(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Kt.create(t.compositeFilter.filters.map((r=>zP(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Le(1026)}})(t.compositeFilter.op))})(n):Le(30097,{filter:n})}function yG(n){return cG[n]}function bG(n){return uG[n]}function xG(n){return dG[n]}function zu(n){return{fieldPath:n.canonicalString()}}function Lu(n){return An.fromServerFormat(n.fieldPath)}function LP(n){return n instanceof Ct?(function(t){if(t.op==="=="){if(RI(t.value))return{unaryFilter:{field:zu(t.field),op:"IS_NAN"}};if(II(t.value))return{unaryFilter:{field:zu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(RI(t.value))return{unaryFilter:{field:zu(t.field),op:"IS_NOT_NAN"}};if(II(t.value))return{unaryFilter:{field:zu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zu(t.field),op:bG(t.op),value:t.value}}})(n):n instanceof Kt?(function(t){const r=t.getFilters().map((i=>LP(i)));return r.length===1?r[0]:{compositeFilter:{op:xG(t.op),filters:r}}})(n):Le(54877,{filter:n})}function _G(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function BP(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class ks{constructor(e,t,r,i,a=Xe.min(),o=Xe.min(),c=tr.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new ks(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ks(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ks(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ks(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class UP{constructor(e){this.yt=e}}function wG(n,e){let t;if(e.document)t=pG(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=De.fromSegments(e.noDocument.path),i=kc(e.noDocument.readTime);t=Nn.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Le(56709);{const r=De.fromSegments(e.unknownDocument.path),i=kc(e.unknownDocument.version);t=Nn.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const a=new vt(i[0],i[1]);return Xe.fromTimestamp(a)})(e.readTime)),t}function $I(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:H0(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(a,o){return{name:G0(a,o.key),fields:o.data.value.mapValue.fields,updateTime:xd(a,o.version.toTimestamp()),createTime:xd(a,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Dc(e.version)};else{if(!e.isUnknownDocument())return Le(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Dc(e.version)}}return r}function H0(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Dc(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function kc(n){const e=new vt(n.seconds,n.nanoseconds);return Xe.fromTimestamp(e)}function tc(n,e){const t=(e.baseMutations||[]).map((a=>Z1(n.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const o=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const c=e.mutations[a+1];o.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const r=e.mutations.map((a=>Z1(n.yt,a))),i=vt.fromMillis(e.localWriteTimeMs);return new Vw(e.batchId,i,t,r)}function ch(n){const e=kc(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?kc(n.lastLimboFreeSnapshotVersion):Xe.min();let r;return r=(function(a){return a.documents!==void 0})(n.query)?(function(a){const o=a.documents.length;return Fe(o===1,1966,{count:o}),Hi(Rp(MP(a.documents[0])))})(n.query):(function(a){return Hi(VP(a))})(n.query),new ks(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,tr.fromBase64String(n.resumeToken))}function FP(n,e){const t=Dc(e.snapshotVersion),r=Dc(e.lastLimboFreeSnapshotVersion);let i;i=B0(e.target)?OP(n.yt,e.target):jP(n.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ic(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function GP(n){const e=VP({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?F0(e,e.limit,"L"):e}function kx(n,e){return new Lw(e.largestBatchId,Z1(n.yt,e.overlayMutation))}function YI(n,e){const t=e.path.lastSegment();return[n,Vr(e.path.popLast()),t]}function KI(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Dc(r.readTime),documentKey:Vr(r.documentKey.path),largestBatchId:r.largestBatchId}}class EG{getBundleMetadata(e,t){return XI(e).get(t).next((r=>{if(r)return(function(a){return{id:a.bundleId,createTime:kc(a.createTime),version:a.version}})(r)}))}saveBundleMetadata(e,t){return XI(e).put((function(i){return{bundleId:i.id,createTime:Dc(Yr(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return WI(e).get(t).next((r=>{if(r)return(function(a){return{name:a.name,query:GP(a.bundledQuery),readTime:kc(a.readTime)}})(r)}))}saveNamedQuery(e,t){return WI(e).put((function(i){return{name:i.name,readTime:Dc(Yr(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function XI(n){return hr(n,kv)}function WI(n){return hr(n,Nv)}class Bv{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new Bv(e,r)}getOverlay(e,t){return Qf(e).get(YI(this.userId,t)).next((r=>r?kx(this.serializer,r):null))}getOverlays(e,t){const r=Ha();return ae.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((a,o)=>{const c=new Lw(t,o);i.push(this.St(e,c))})),ae.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((o=>i.add(Vr(o.getCollectionPath()))));const a=[];return i.forEach((o=>{const c=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);a.push(Qf(e).Z(U1,c))})),ae.waitFor(a)}getOverlaysForCollection(e,t,r){const i=Ha(),a=Vr(t),o=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Qf(e).J(U1,o).next((c=>{for(const u of c){const d=kx(this.serializer,u);i.set(d.getKey(),d)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const a=Ha();let o;const c=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Qf(e).ee({index:qM,range:c},((u,d,h)=>{const p=kx(this.serializer,d);a.size()<i||p.largestBatchId===o?(a.set(p.getKey(),p),o=p.largestBatchId):h.done()})).next((()=>a))}St(e,t){return Qf(e).put((function(i,a,o){const[c,u,d]=YI(a,o.mutation.key);return{userId:a,collectionPath:u,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:q0(i.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Qf(n){return hr(n,Mv)}class SG{bt(e){return hr(e,Dw)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?tr.fromUint8Array(r):tr.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class nc{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(_n(e.integerValue));else if("doubleValue"in e){const r=_n(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),$h(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=Us(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Fs(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?nP(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Ov(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Le(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const i=gd,a=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(_n(a)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),De.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}nc.Kt=new nc;const ku=255;function TG(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function QI(n){const e=64-(function(r){let i=0;for(let a=0;a<8;++a){const o=TG(255&r[a]);if(i+=o,o!==8)break}return i})(n);return Math.ceil(e/8)}class AG{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=QI(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=QI(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(ku),this.sn(255)}_n(){this.an(ku),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(a){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,a,!1),new Uint8Array(o.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===ku?(this.sn(ku),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===ku?(this.an(ku),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class CG{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class IG{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Zf{constructor(){this.cn=new AG,this.ln=new CG(this.cn),this.hn=new IG(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class rc{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new rc(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:h0(this.En),directionalValue:h0(this.dn),orderedDocumentKey:h0(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Po(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=ZI(n.En,e.En),t!==0?t:(t=ZI(n.dn,e.dn),t!==0?t:De.comparator(n.In,e.In)))}function ZI(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function h0(n){return PN()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function JI(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class eR{constructor(e){this.mn=new Xt(((t,r)=>An.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Fe(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=z1(e);if(t!==void 0&&!this.wn(t))return!1;const r=Wl(e);let i=new Set,a=0,o=0;for(;a<r.length&&this.wn(r[a]);++a)i=i.add(r[a].fieldPath.canonicalString());if(a===r.length)return!0;if(this.mn.size>0){const c=this.mn.getIterator().getNext();if(!i.has(c.field.canonicalString())){const u=r[a];if(!this.Sn(c,u)||!this.bn(this.fn[o++],u))return!1}++a}for(;a<r.length;++a){const c=r[a];if(o>=this.fn.length||!this.bn(this.fn[o++],c))return!1}return!0}Dn(){if(this.pn)return null;let e=new Xt(An.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new a0(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new a0(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new a0(r.field,r.dir==="asc"?0:1)));return new O0(O0.UNKNOWN_ID,this.collectionId,t,Hh.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function qP(n){if(Fe(n instanceof Ct||n instanceof Kt,20012),n instanceof Ct){if(n instanceof dP){const t=n.value.arrayValue?.values?.map((r=>Ct.create(n.field,"==",r)))||[];return Kt.create(t,"or")}return n}const e=n.filters.map((t=>qP(t)));return Kt.create(e,n.op)}function RG(n){if(n.getFilters().length===0)return[];const e=t_(qP(n));return Fe(HP(e),7391),J1(e)||e_(e)?[e]:e.getFilters()}function J1(n){return n instanceof Ct}function e_(n){return n instanceof Kt&&Ow(n)}function HP(n){return J1(n)||e_(n)||(function(t){if(t instanceof Kt&&H1(t)){for(const r of t.getFilters())if(!J1(r)&&!e_(r))return!1;return!0}return!1})(n)}function t_(n){if(Fe(n instanceof Ct||n instanceof Kt,34018),n instanceof Ct)return n;if(n.filters.length===1)return t_(n.filters[0]);const e=n.filters.map((r=>t_(r)));let t=Kt.create(e,n.op);return t=$0(t),HP(t)?t:(Fe(t instanceof Kt,64498),Fe(yd(t),40251),Fe(t.filters.length>1,57927),t.filters.reduce(((r,i)=>Fw(r,i))))}function Fw(n,e){let t;return Fe(n instanceof Ct||n instanceof Kt,38388),Fe(e instanceof Ct||e instanceof Kt,25473),t=n instanceof Ct?e instanceof Ct?(function(i,a){return Kt.create([i,a],"and")})(n,e):tR(n,e):e instanceof Ct?tR(e,n):(function(i,a){if(Fe(i.filters.length>0&&a.filters.length>0,48005),yd(i)&&yd(a))return lP(i,a.getFilters());const o=H1(i)?i:a,c=H1(i)?a:i,u=o.filters.map((d=>Fw(d,c)));return Kt.create(u,"or")})(n,e),$0(t)}function tR(n,e){if(yd(e))return lP(e,n.getFilters());{const t=e.filters.map((r=>Fw(n,r)));return Kt.create(t,"or")}}function $0(n){if(Fe(n instanceof Ct||n instanceof Kt,11850),n instanceof Ct)return n;const e=n.getFilters();if(e.length===1)return $0(e[0]);if(sP(n))return n;const t=e.map((i=>$0(i))),r=[];return t.forEach((i=>{i instanceof Ct?r.push(i):i instanceof Kt&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:Kt.create(r,n.op)}class DG{constructor(){this.Cn=new Gw}addToCollectionParentIndex(e,t){return this.Cn.add(t),ae.resolve()}getCollectionParents(e,t){return ae.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ae.resolve()}deleteFieldIndex(e,t){return ae.resolve()}deleteAllFieldIndexes(e){return ae.resolve()}createTargetIndexes(e,t){return ae.resolve()}getDocumentsMatchingTarget(e,t){return ae.resolve(null)}getIndexType(e,t){return ae.resolve(0)}getFieldIndexes(e,t){return ae.resolve([])}getNextCollectionGroupToUpdate(e){return ae.resolve(null)}getMinOffset(e,t){return ae.resolve(Ei.min())}getMinOffsetFromCollectionGroup(e,t){return ae.resolve(Ei.min())}updateCollectionGroup(e,t,r){return ae.resolve()}updateIndexEntries(e,t){return ae.resolve()}}class Gw{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Xt(Ut.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Xt(Ut.comparator)).toArray()}}const nR="IndexedDbIndexManager",Dm=new Uint8Array(0);class kG{constructor(e,t){this.databaseId=t,this.vn=new Gw,this.Fn=new Qs((r=>Ic(r)),((r,i)=>Ip(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const a={collectionId:r,parent:Vr(i)};return rR(e).put(a)}return ae.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[NM(t),""],!1,!0);return rR(e).J(i).next((a=>{for(const o of a){if(o.collectionId!==t)break;r.push(qa(o.parent))}return r}))}addFieldIndex(e,t){const r=Jf(e),i=(function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete i.indexId;const a=r.add(i);if(t.indexState){const o=Mu(e);return a.next((c=>{o.put(KI(c,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const r=Jf(e),i=Mu(e),a=Nu(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Jf(e),r=Nu(e),i=Mu(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return ae.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const a=new eR(r).Dn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const r=Nu(e);let i=!0;const a=new Map;return ae.forEach(this.Mn(t),(o=>this.xn(e,o).next((c=>{i&&(i=!!c),a.set(o,c)})))).next((()=>{if(i){let o=xt();const c=[];return ae.forEach(a,((u,d)=>{Te(nR,`Using index ${(function(D){return`id=${D.indexId}|cg=${D.collectionGroup}|f=${D.fields.map((O=>`${O.fieldPath}:${O.kind}`)).join(",")}`})(u)} to execute ${Ic(t)}`);const h=(function(D,O){const M=z1(O);if(M===void 0)return null;for(const j of U0(D,M.fieldPath))switch(j.op){case"array-contains-any":return j.value.arrayValue.values||[];case"array-contains":return[j.value]}return null})(d,u),p=(function(D,O){const M=new Map;for(const j of Wl(O))for(const C of U0(D,j.fieldPath))switch(C.op){case"==":case"in":M.set(j.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return M.set(j.fieldPath.canonicalString(),C.value),Array.from(M.values())}return null})(d,u),m=(function(D,O){const M=[];let j=!0;for(const C of Wl(O)){const I=C.kind===0?PI(D,C.fieldPath,D.startAt):OI(D,C.fieldPath,D.startAt);M.push(I.value),j&&(j=I.inclusive)}return new vd(M,j)})(d,u),b=(function(D,O){const M=[];let j=!0;for(const C of Wl(O)){const I=C.kind===0?OI(D,C.fieldPath,D.endAt):PI(D,C.fieldPath,D.endAt);M.push(I.value),j&&(j=I.inclusive)}return new vd(M,j)})(d,u),_=this.On(u,d,m),w=this.On(u,d,b),S=this.Nn(u,d,p),T=this.Bn(u.indexId,h,_,m.inclusive,w,b.inclusive,S);return ae.forEach(T,(A=>r.Y(A,t.limit).next((D=>{D.forEach((O=>{const M=De.fromSegments(O.documentKey);o.has(M)||(o=o.add(M),c.push(M))}))}))))})).next((()=>c))}return ae.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=RG(Kt.create(e.filters,"and")).map((r=>Y1(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,a,o,c){const u=(t!=null?t.length:1)*Math.max(r.length,a.length),d=u/(t!=null?t.length:1),h=[];for(let p=0;p<u;++p){const m=t?this.Ln(t[p/d]):Dm,b=this.kn(e,m,r[p%d],i),_=this.qn(e,m,a[p%d],o),w=c.map((S=>this.kn(e,m,S,!0)));h.push(...this.createRange(b,_,w))}return h}kn(e,t,r,i){const a=new rc(e,De.empty(),t,r);return i?a:a.An()}qn(e,t,r,i){const a=new rc(e,De.empty(),t,r);return i?a.An():a}xn(e,t){const r=new eR(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((a=>{let o=null;for(const c of a)r.yn(c)&&(!o||c.fields.length>o.fields.length)&&(o=c);return o}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return ae.forEach(i,(a=>this.xn(e,a).next((o=>{o?r!==0&&o.fields.length<(function(u){let d=new Xt(An.comparator),h=!1;for(const p of u.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:d=d.add(m.field));for(const p of u.orderBy)p.field.isKeyField()||(d=d.add(p.field));return d.size+(h?1:0)})(a)&&(r=1):r=0})))).next((()=>(function(o){return o.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new Zf;for(const i of Wl(e)){const a=t.data.field(i.fieldPath);if(a==null)return null;const o=r.Pn(i.kind);nc.Kt.Dt(a,o)}return r.un()}Ln(e){const t=new Zf;return nc.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new Zf;return nc.Kt.Dt(Zh(this.databaseId,t),r.Pn((function(a){const o=Wl(a);return o.length===0?0:o[o.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new Zf);let a=0;for(const o of Wl(e)){const c=r[a++];for(const u of i)if(this.Un(t,o.fieldPath)&&Jh(c))i=this.Kn(i,o,c);else{const d=u.Pn(o.kind);nc.Kt.Dt(c,d)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],a=[];for(const o of r.arrayValue.values||[])for(const c of i){const u=new Zf;u.seed(c.un()),nc.Kt.Dt(o,u.Pn(t.kind)),a.push(u)}return a}Un(e,t){return!!e.filters.find((r=>r instanceof Ct&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=Jf(e),i=Mu(e);return(t?r.J(B1,IDBKeyRange.bound(t,t)):r.J()).next((a=>{const o=[];return ae.forEach(a,(c=>i.get([c.indexId,this.uid]).next((u=>{o.push((function(h,p){const m=p?new Hh(p.sequenceNumber,new Ei(kc(p.readTime),new De(qa(p.documentKey)),p.largestBatchId)):Hh.empty(),b=h.fields.map((([_,w])=>new a0(An.fromServerFormat(_),w)));return new O0(h.indexId,h.collectionGroup,b,m)})(c,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const a=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return a!==0?a:at(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=Jf(e),a=Mu(e);return this.Gn(e).next((o=>i.J(B1,IDBKeyRange.bound(t,t)).next((c=>ae.forEach(c,(u=>a.put(KI(u.indexId,this.uid,o,r))))))))}updateIndexEntries(e,t){const r=new Map;return ae.forEach(t,((i,a)=>{const o=r.get(i.collectionGroup);return(o?ae.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next((c=>(r.set(i.collectionGroup,c),ae.forEach(c,(u=>this.zn(e,i,u).next((d=>{const h=this.jn(a,u);return d.isEqual(h)?ae.resolve():this.Jn(e,a,u,d,h)})))))))}))}Hn(e,t,r,i){return Nu(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return Nu(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=Nu(e);let a=new Xt(Po);return i.ee({index:GM,range:IDBKeyRange.only([r.indexId,this.uid,h0(this.$n(r,t))])},((o,c)=>{a=a.add(new rc(r.indexId,t,JI(c.arrayValue),JI(c.directionalValue)))})).next((()=>a))}jn(e,t){let r=new Xt(Po);const i=this.Qn(t,e);if(i==null)return r;const a=z1(t);if(a!=null){const o=e.data.field(a.fieldPath);if(Jh(o))for(const c of o.arrayValue.values||[])r=r.add(new rc(t.indexId,e.key,this.Ln(c),i))}else r=r.add(new rc(t.indexId,e.key,Dm,i));return r}Jn(e,t,r,i,a){Te(nR,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,d,h,p,m){const b=u.getIterator(),_=d.getIterator();let w=Du(b),S=Du(_);for(;w||S;){let T=!1,A=!1;if(w&&S){const D=h(w,S);D<0?A=!0:D>0&&(T=!0)}else w!=null?A=!0:T=!0;T?(p(S),S=Du(_)):A?(m(w),w=Du(b)):(w=Du(b),S=Du(_))}})(i,a,Po,(c=>{o.push(this.Hn(e,t,r,c))}),(c=>{o.push(this.Yn(e,t,r,c))})),ae.waitFor(o)}Gn(e){let t=1;return Mu(e).ee({index:FM,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,a)=>{a.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((o,c)=>Po(o,c))).filter(((o,c,u)=>!c||Po(o,u[c-1])!==0));const i=[];i.push(e);for(const o of r){const c=Po(o,e),u=Po(o,t);if(c===0)i[0]=e.An();else if(c>0&&u<0)i.push(o),i.push(o.An());else if(u>0)break}i.push(t);const a=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const c=i[o].Vn(this.uid,Dm,De.empty()),u=i[o+1].Vn(this.uid,Dm,De.empty());a.push(IDBKeyRange.bound(c,u))}return a}Zn(e,t){return Po(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(iR)}getMinOffset(e,t){return ae.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||Le(44426))))).next(iR)}}function rR(n){return hr(n,Xh)}function Nu(n){return hr(n,wh)}function Jf(n){return hr(n,Rw)}function Mu(n){return hr(n,_h)}function iR(n){Fe(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;Aw(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Ei(e.readTime,e.documentKey,t)}const aR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},$P=41943040;class Mr{static withCacheSize(e){return new Mr(e,Mr.DEFAULT_COLLECTION_PERCENTILE,Mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function YP(n,e,t){const r=n.store(la),i=n.store(dd),a=[],o=IDBKeyRange.only(t.batchId);let c=0;const u=r.ee({range:o},((h,p,m)=>(c++,m.delete())));a.push(u.next((()=>{Fe(c===1,47070,{batchId:t.batchId})})));const d=[];for(const h of t.mutations){const p=LM(e,h.key.path,t.batchId);a.push(i.delete(p)),d.push(h.key)}return ae.waitFor(a).next((()=>d))}function Y0(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Le(14731);e=n.noDocument}return JSON.stringify(e).length}Mr.DEFAULT_COLLECTION_PERCENTILE=10,Mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Mr.DEFAULT=new Mr($P,Mr.DEFAULT_COLLECTION_PERCENTILE,Mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Mr.DISABLED=new Mr(-1,0,0);class Uv{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){Fe(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new Uv(a,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Oo(e).ee({index:lc,range:r},((i,a,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const a=Bu(e),o=Oo(e);return o.add({}).next((c=>{Fe(typeof c=="number",49019);const u=new Vw(c,t,r,i),d=(function(b,_,w){const S=w.baseMutations.map((A=>q0(b.yt,A))),T=w.mutations.map((A=>q0(b.yt,A)));return{userId:_,batchId:w.batchId,localWriteTimeMs:w.localWriteTime.toMillis(),baseMutations:S,mutations:T}})(this.serializer,this.userId,u),h=[];let p=new Xt(((m,b)=>at(m.canonicalString(),b.canonicalString())));for(const m of i){const b=LM(this.userId,m.key.path,c);p=p.add(m.key.path.popLast()),h.push(o.put(d)),h.push(a.put(b,s7))}return p.forEach((m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[c]=u.keys()})),ae.waitFor(h).next((()=>u))}))}lookupMutationBatch(e,t){return Oo(e).get(t).next((r=>r?(Fe(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),tc(this.serializer,r)):null))}er(e,t){return this.Xn[t]?ae.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return Oo(e).ee({index:lc,range:i},((o,c,u)=>{c.userId===this.userId&&(Fe(c.batchId>=r,47524,{tr:r}),a=tc(this.serializer,c)),u.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=pc;return Oo(e).ee({index:lc,range:t,reverse:!0},((i,a,o)=>{r=a.batchId,o.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,pc],[this.userId,Number.POSITIVE_INFINITY]);return Oo(e).J(lc,t).next((r=>r.map((i=>tc(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=s0(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return Bu(e).ee({range:i},((o,c,u)=>{const[d,h,p]=o,m=qa(h);if(d===this.userId&&t.path.isEqual(m))return Oo(e).get(p).next((b=>{if(!b)throw Le(61480,{nr:o,batchId:p});Fe(b.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:b.userId,batchId:p}),a.push(tc(this.serializer,b))}));u.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Xt(at);const i=[];return t.forEach((a=>{const o=s0(this.userId,a.path),c=IDBKeyRange.lowerBound(o),u=Bu(e).ee({range:c},((d,h,p)=>{const[m,b,_]=d,w=qa(b);m===this.userId&&a.path.isEqual(w)?r=r.add(_):p.done()}));i.push(u)})),ae.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,a=s0(this.userId,r),o=IDBKeyRange.lowerBound(a);let c=new Xt(at);return Bu(e).ee({range:o},((u,d,h)=>{const[p,m,b]=u,_=qa(m);p===this.userId&&r.isPrefixOf(_)?_.length===i&&(c=c.add(b)):h.done()})).next((()=>this.rr(e,c)))}rr(e,t){const r=[],i=[];return t.forEach((a=>{i.push(Oo(e).get(a).next((o=>{if(o===null)throw Le(35274,{batchId:a});Fe(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:a}),r.push(tc(this.serializer,o))})))})),ae.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return YP(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),ae.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return ae.resolve();const r=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),i=[];return Bu(e).ee({range:r},((a,o,c)=>{if(a[0]===this.userId){const u=qa(a[1]);i.push(u)}else c.done()})).next((()=>{Fe(i.length===0,56720,{sr:i.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return KP(e,this.userId,t)}_r(e){return XP(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:pc,lastStreamToken:""}))}}function KP(n,e,t){const r=s0(e,t.path),i=r[1],a=IDBKeyRange.lowerBound(r);let o=!1;return Bu(n).ee({range:a,X:!0},((c,u,d)=>{const[h,p,m]=c;h===e&&p===i&&(o=!0),d.done()})).next((()=>o))}function Oo(n){return hr(n,la)}function Bu(n){return hr(n,dd)}function XP(n){return hr(n,Yh)}class Nc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Nc(0)}static cr(){return new Nc(-1)}}class NG{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new Nc(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Xe.fromTimestamp(new vt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Pu(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(Fe(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const a=[];return Pu(e).ee(((o,c)=>{const u=ch(c);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(i++,a.push(this.removeTargetData(e,u)))})).next((()=>ae.waitFor(a))).next((()=>i))}forEachTarget(e,t){return Pu(e).ee(((r,i)=>{const a=ch(i);t(a)}))}lr(e){return sR(e).get(z0).next((t=>(Fe(t!==null,2888),t)))}hr(e,t){return sR(e).put(z0,t)}Pr(e,t){return Pu(e).put(FP(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=Ic(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return Pu(e).ee({range:i,index:UM},((o,c,u)=>{const d=ch(c);Ip(t,d.target)&&(a=d,u.done())})).next((()=>a))}addMatchingKeys(e,t,r){const i=[],a=$o(e);return t.forEach((o=>{const c=Vr(o.path);i.push(a.put({targetId:r,path:c})),i.push(this.referenceDelegate.addReference(e,r,o))})),ae.waitFor(i)}removeMatchingKeys(e,t,r){const i=$o(e);return ae.forEach(t,(a=>{const o=Vr(a.path);return ae.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,a)])}))}removeMatchingKeysForTargetId(e,t){const r=$o(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=$o(e);let a=xt();return i.ee({range:r,X:!0},((o,c,u)=>{const d=qa(o[1]),h=new De(d);a=a.add(h)})).next((()=>a))}containsKey(e,t){const r=Vr(t.path),i=IDBKeyRange.bound([r],[NM(r)],!1,!0);let a=0;return $o(e).ee({index:Iw,X:!0,range:i},(([o,c],u,d)=>{o!==0&&(a++,d.done())})).next((()=>a>0))}At(e,t){return Pu(e).get(t).next((r=>r?ch(r):null))}}function Pu(n){return hr(n,fd)}function sR(n){return hr(n,gc)}function $o(n){return hr(n,hd)}const oR="LruGarbageCollector",MG=1048576;function lR([n,e],[t,r]){const i=at(n,t);return i===0?at(e,r):i}class PG{constructor(e){this.Ir=e,this.buffer=new Xt(lR),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();lR(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class WP{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Te(oR,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ml(t)?Te(oR,"Ignoring IndexedDB error during garbage collection: ",t):await Bc(t)}await this.Vr(3e5)}))}}class OG{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return ae.resolve(Gi.ce);const r=new PG(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Te("LruGarbageCollector","Garbage collection skipped; disabled"),ae.resolve(aR)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Te("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),aR):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,a,o,c,u,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(Te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i)))).next((p=>(r=p,c=Date.now(),this.removeTargets(e,r,t)))).next((p=>(a=p,u=Date.now(),this.removeOrphanedDocuments(e,r)))).next((p=>(d=Date.now(),ju()<=At.DEBUG&&Te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${a} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(d-u)+`ms
Total Duration: ${d-h}ms`),ae.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:p}))))}}function QP(n,e){return new OG(n,e)}class jG{constructor(e,t){this.db=e,this.garbageCollector=QP(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return km(e,r)}removeReference(e,t,r){return km(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return km(e,t)}br(e,t){return(function(i,a){let o=!1;return XP(i).te((c=>KP(i,c,a).next((u=>(u&&(o=!0),ae.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Sr(e,((o,c)=>{if(c<=t){const u=this.br(e,o).next((d=>{if(!d)return a++,r.getEntry(e,o).next((()=>(r.removeEntry(o,Xe.min()),$o(e).delete((function(p){return[0,Vr(p.path)]})(o)))))}));i.push(u)}})).next((()=>ae.waitFor(i))).next((()=>r.apply(e))).next((()=>a))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return km(e,t)}Sr(e,t){const r=$o(e);let i,a=Gi.ce;return r.ee({index:Iw},(([o,c],{path:u,sequenceNumber:d})=>{o===0?(a!==Gi.ce&&t(new De(qa(i)),a),a=d,i=u):a=Gi.ce})).next((()=>{a!==Gi.ce&&t(new De(qa(i)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function km(n,e){return $o(n).put((function(r,i){return{targetId:0,path:Vr(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class ZP{constructor(){this.changes=new Qs((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Nn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?ae.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class VG{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return $l(e).put(r)}removeEntry(e,t,r){return $l(e).delete((function(a,o){const c=a.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],H0(o),c[c.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=Nn.newInvalidDocument(t);return $l(e).ee({index:o0,range:IDBKeyRange.only(eh(t))},((i,a)=>{r=this.Cr(t,a)})).next((()=>r))}vr(e,t){let r={size:0,document:Nn.newInvalidDocument(t)};return $l(e).ee({index:o0,range:IDBKeyRange.only(eh(t))},((i,a)=>{r={document:this.Cr(t,a),size:Y0(a)}})).next((()=>r))}getEntries(e,t){let r=wi();return this.Fr(e,t,((i,a)=>{const o=this.Cr(i,a);r=r.insert(i,o)})).next((()=>r))}Mr(e,t){let r=wi(),i=new En(De.comparator);return this.Fr(e,t,((a,o)=>{const c=this.Cr(a,o);r=r.insert(a,c),i=i.insert(a,Y0(o))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return ae.resolve();let i=new Xt(dR);t.forEach((u=>i=i.add(u)));const a=IDBKeyRange.bound(eh(i.first()),eh(i.last())),o=i.getIterator();let c=o.getNext();return $l(e).ee({index:o0,range:a},((u,d,h)=>{const p=De.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;c&&dR(c,p)<0;)r(c,null),c=o.getNext();c&&c.isEqual(p)&&(r(c,d),c=o.hasNext()?o.getNext():null),c?h.j(eh(c)):h.done()})).next((()=>{for(;c;)r(c,null),c=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,a){const o=t.path,c=[o.popLast().toArray(),o.lastSegment(),H0(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return $l(e).J(IDBKeyRange.bound(c,u,!0)).next((d=>{a?.incrementDocumentReadCount(d.length);let h=wi();for(const p of d){const m=this.Cr(De.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(Dp(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h}))}getAllFromCollectionGroup(e,t,r,i){let a=wi();const o=uR(t,r),c=uR(t,Ei.max());return $l(e).ee({index:BM,range:IDBKeyRange.bound(o,c,!0)},((u,d,h)=>{const p=this.Cr(De.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);a=a.insert(p.key,p),a.size===i&&h.done()})).next((()=>a))}newChangeBuffer(e){return new zG(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return cR(e).get(L1).next((t=>(Fe(!!t,20021),t)))}Dr(e,t){return cR(e).put(L1,t)}Cr(e,t){if(t){const r=wG(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Xe.min())))return r}return Nn.newInvalidDocument(e)}}function JP(n){return new VG(n)}class zG extends ZP{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Qs((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new Xt(((a,o)=>at(a.canonicalString(),o.canonicalString())));return this.changes.forEach(((a,o)=>{const c=this.Br.get(a);if(t.push(this.Nr.removeEntry(e,a,c.readTime)),o.isValidDocument()){const u=$I(this.Nr.serializer,o);i=i.add(a.path.popLast());const d=Y0(u);r+=d-c.size,t.push(this.Nr.addEntry(e,a,u))}else if(r-=c.size,this.trackRemovals){const u=$I(this.Nr.serializer,o.convertToNoDocument(Xe.min()));t.push(this.Nr.addEntry(e,a,u))}})),i.forEach((a=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Nr.updateMetadata(e,r)),ae.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((a,o)=>{this.Br.set(a,{size:o,readTime:r.get(a).readTime})})),r)))}}function cR(n){return hr(n,Kh)}function $l(n){return hr(n,V0)}function eh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function uR(n,e){const t=e.documentKey.path.toArray();return[n,H0(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function dR(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(i=at(t[a],r[a]),i)return i;return i=at(t.length,r.length),i||(i=at(t[t.length-2],r[r.length-2]),i||at(t[t.length-1],r[r.length-1]))}class LG{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class eO{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Ah(r.mutation,i,ri.empty(),vt.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,xt()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=xt()){const i=Ha();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((a=>{let o=oh();return a.forEach(((c,u)=>{o=o.insert(c,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const r=Ha();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,xt())))}populateOverlays(e,t,r){const i=[];return r.forEach((a=>{t.has(a)||i.push(a)})),this.documentOverlayCache.getOverlays(e,i).next((a=>{a.forEach(((o,c)=>{t.set(o,c)}))}))}computeViews(e,t,r,i){let a=wi();const o=Th(),c=(function(){return Th()})();return t.forEach(((u,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof Zs)?a=a.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Ah(h.mutation,d,h.mutation.getFieldMask(),vt.now())):o.set(d.key,ri.empty())})),this.recalculateAndSaveOverlays(e,a).next((u=>(u.forEach(((d,h)=>o.set(d,h))),t.forEach(((d,h)=>c.set(d,new LG(h,o.get(d)??null)))),c)))}recalculateAndSaveOverlays(e,t){const r=Th();let i=new En(((o,c)=>o-c)),a=xt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const c of o)c.keys().forEach((u=>{const d=t.get(u);if(d===null)return;let h=r.get(u)||ri.empty();h=c.applyToLocalView(d,h),r.set(u,h);const p=(i.get(c.batchId)||xt()).add(u);i=i.insert(c.batchId,p)}))})).next((()=>{const o=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,h=u.value,p=vP();h.forEach((m=>{if(!a.has(m)){const b=SP(t.get(m),r.get(m));b!==null&&p.set(m,b),a=a.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return ae.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(o){return De.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):fP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((a=>{const o=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):ae.resolve(Ha());let c=qh,u=a;return o.next((d=>ae.forEach(d,((h,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),a.get(h)?ae.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{u=u.insert(h,m)}))))).next((()=>this.populateOverlays(e,d,a))).next((()=>this.computeViews(e,u,d,xt()))).next((h=>({batchId:c,changes:mP(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new De(t)).next((r=>{let i=oh();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const a=t.collectionGroup;let o=oh();return this.indexManager.getCollectionParents(e,a).next((c=>ae.forEach(c,(u=>{const d=(function(p,m){return new zd(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next((h=>{h.forEach(((p,m)=>{o=o.insert(p,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,i)))).next((o=>{a.forEach(((u,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,Nn.newInvalidDocument(h)))}));let c=oh();return o.forEach(((u,d)=>{const h=a.get(u);h!==void 0&&Ah(h.mutation,d,ri.empty(),vt.now()),Dp(t,d)&&(c=c.insert(u,d))})),c}))}}class BG{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ae.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Yr(i.createTime)}})(t)),ae.resolve()}getNamedQuery(e,t){return ae.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:GP(i.bundledQuery),readTime:Yr(i.readTime)}})(t)),ae.resolve()}}class UG{constructor(){this.overlays=new En(De.comparator),this.qr=new Map}getOverlay(e,t){return ae.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ha();return ae.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,a)=>{this.St(e,t,a)})),ae.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(r)),ae.resolve()}getOverlaysForCollection(e,t,r){const i=Ha(),a=t.length+1,o=new De(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===a&&u.largestBatchId>r&&i.set(u.getKey(),u)}return ae.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new En(((d,h)=>d-h));const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let h=a.get(d.largestBatchId);h===null&&(h=Ha(),a=a.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const c=Ha(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((d,h)=>c.set(d,h))),!(c.size()>=i)););return ae.resolve(c)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Lw(t,r));let a=this.qr.get(t);a===void 0&&(a=xt(),this.qr.set(t,a)),this.qr.set(t,a.add(r.key))}}class FG{constructor(){this.sessionToken=tr.EMPTY_BYTE_STRING}getSessionToken(e){return ae.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ae.resolve()}}class qw{constructor(){this.Qr=new Xt(vr.$r),this.Ur=new Xt(vr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new vr(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new vr(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new De(new Ut([])),r=new vr(t,e),i=new vr(t,e+1),a=[];return this.Ur.forEachInRange([r,i],(o=>{this.Gr(o),a.push(o.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new De(new Ut([])),r=new vr(t,e),i=new vr(t,e+1);let a=xt();return this.Ur.forEachInRange([r,i],(o=>{a=a.add(o.key)})),a}containsKey(e){const t=new vr(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class vr{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return De.comparator(e.key,t.key)||at(e.Yr,t.Yr)}static Kr(e,t){return at(e.Yr,t.Yr)||De.comparator(e.key,t.key)}}class GG{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Xt(vr.$r)}checkEmpty(e){return ae.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Vw(a,t,r,i);this.mutationQueue.push(o);for(const c of i)this.Zr=this.Zr.add(new vr(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return ae.resolve(o)}lookupMutationBatch(e,t){return ae.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),a=i<0?0:i;return ae.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ae.resolve(this.mutationQueue.length===0?pc:this.tr-1)}getAllMutationBatches(e){return ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new vr(t,0),i=new vr(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([r,i],(o=>{const c=this.Xr(o.Yr);a.push(c)})),ae.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Xt(at);return t.forEach((i=>{const a=new vr(i,0),o=new vr(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,o],(c=>{r=r.add(c.Yr)}))})),ae.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;De.isDocumentKey(a)||(a=a.child(""));const o=new vr(new De(a),0);let c=new Xt(at);return this.Zr.forEachWhile((u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(c=c.add(u.Yr)),!0)}),o),ae.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Fe(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return ae.forEach(t.mutations,(i=>{const a=new vr(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new vr(t,0),i=this.Zr.firstAfterOrEqual(r);return ae.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ae.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class qG{constructor(e){this.ri=e,this.docs=(function(){return new En(De.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,o=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return ae.resolve(r?r.document.mutableCopy():Nn.newInvalidDocument(t))}getEntries(e,t){let r=wi();return t.forEach((i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():Nn.newInvalidDocument(i))})),ae.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let a=wi();const o=t.path,c=new De(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:h}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||Aw(OM(h),r)<=0||(i.has(h.key)||Dp(t,h))&&(a=a.insert(h.key,h.mutableCopy()))}return ae.resolve(a)}getAllFromCollectionGroup(e,t,r,i){Le(9500)}ii(e,t){return ae.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new HG(this)}getSize(e){return ae.resolve(this.size)}}class HG extends ZP{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),ae.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class $G{constructor(e){this.persistence=e,this.si=new Qs((t=>Ic(t)),Ip),this.lastRemoteSnapshotVersion=Xe.min(),this.highestTargetId=0,this.oi=0,this._i=new qw,this.targetCount=0,this.ai=Nc.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),ae.resolve()}getLastRemoteSnapshotVersion(e){return ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ae.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ae.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),ae.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Nc(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ae.resolve()}updateTargetData(e,t){return this.Pr(t),ae.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ae.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.si.forEach(((o,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(o),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)})),ae.waitFor(a).next((()=>i))}getTargetCount(e){return ae.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return ae.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),ae.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach((o=>{a.push(i.markPotentiallyOrphaned(e,o))})),ae.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ae.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return ae.resolve(r)}containsKey(e,t){return ae.resolve(this._i.containsKey(t))}}class Hw{constructor(e,t){this.ui={},this.overlays={},this.ci=new Gi(0),this.li=!1,this.li=!0,this.hi=new FG,this.referenceDelegate=e(this),this.Pi=new $G(this),this.indexManager=new DG,this.remoteDocumentCache=(function(i){return new qG(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new UP(t),this.Ii=new BG(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new UG,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new GG(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){Te("MemoryPersistence","Starting transaction:",e);const i=new YG(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((a=>this.referenceDelegate.di(i).next((()=>a)))).toPromise().then((a=>(i.raiseOnCommittedEvent(),a)))}Ai(e,t){return ae.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class YG extends VM{constructor(e){super(),this.currentSequenceNumber=e}}class Fv{constructor(e){this.persistence=e,this.Ri=new qw,this.Vi=null}static mi(e){return new Fv(e)}get fi(){if(this.Vi)return this.Vi;throw Le(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),ae.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),ae.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ae.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((a=>this.fi.add(a.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ae.forEach(this.fi,(r=>{const i=De.fromPath(r);return this.gi(e,i).next((a=>{a||t.removeEntry(i,Xe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return ae.or([()=>ae.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class K0{constructor(e,t){this.persistence=e,this.pi=new Qs((r=>Vr(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=QP(this,t)}static mi(e,t){return new K0(e,t)}Ei(){}di(e){return ae.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return ae.forEach(this.pi,((r,i)=>this.br(e,r,i).next((a=>a?ae.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,(o=>this.br(e,o,t).next((c=>{c||(r++,a.removeEntry(o,Xe.min()))})))).next((()=>a.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),ae.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),ae.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),ae.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),ae.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=c0(e.data.value)),t}br(e,t,r){return ae.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return ae.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class KG{constructor(e){this.serializer=e}k(e,t,r,i){const a=new Rv("createOrUpgrade",t);r<1&&i>=1&&((function(u){u.createObjectStore(Cp)})(e),(function(u){u.createObjectStore(Yh,{keyPath:a7}),u.createObjectStore(la,{keyPath:wI,autoIncrement:!0}).createIndex(lc,EI,{unique:!0}),u.createObjectStore(dd)})(e),fR(e),(function(u){u.createObjectStore(Ql)})(e));let o=ae.resolve();return r<3&&i>=3&&(r!==0&&((function(u){u.deleteObjectStore(hd),u.deleteObjectStore(fd),u.deleteObjectStore(gc)})(e),fR(e)),o=o.next((()=>(function(u){const d=u.store(gc),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Xe.min().toTimestamp(),targetCount:0};return d.put(z0,h)})(a)))),r<4&&i>=4&&(r!==0&&(o=o.next((()=>(function(u,d){return d.store(la).J().next((p=>{u.deleteObjectStore(la),u.createObjectStore(la,{keyPath:wI,autoIncrement:!0}).createIndex(lc,EI,{unique:!0});const m=d.store(la),b=p.map((_=>m.put(_)));return ae.waitFor(b)}))})(e,a)))),o=o.next((()=>{(function(u){u.createObjectStore(pd,{keyPath:p7})})(e)}))),r<5&&i>=5&&(o=o.next((()=>this.yi(a)))),r<6&&i>=6&&(o=o.next((()=>((function(u){u.createObjectStore(Kh)})(e),this.wi(a))))),r<7&&i>=7&&(o=o.next((()=>this.Si(a)))),r<8&&i>=8&&(o=o.next((()=>this.bi(e,a)))),r<9&&i>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(o=o.next((()=>this.Di(a)))),r<11&&i>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(kv,{keyPath:g7})})(e),(function(u){u.createObjectStore(Nv,{keyPath:m7})})(e)}))),r<12&&i>=12&&(o=o.next((()=>{(function(u){const d=u.createObjectStore(Mv,{keyPath:E7});d.createIndex(U1,S7,{unique:!1}),d.createIndex(qM,T7,{unique:!1})})(e)}))),r<13&&i>=13&&(o=o.next((()=>(function(u){const d=u.createObjectStore(V0,{keyPath:o7});d.createIndex(o0,l7),d.createIndex(BM,c7)})(e))).next((()=>this.Ci(e,a))).next((()=>e.deleteObjectStore(Ql)))),r<14&&i>=14&&(o=o.next((()=>this.Fi(e,a)))),r<15&&i>=15&&(o=o.next((()=>(function(u){u.createObjectStore(Rw,{keyPath:v7,autoIncrement:!0}).createIndex(B1,y7,{unique:!1}),u.createObjectStore(_h,{keyPath:b7}).createIndex(FM,x7,{unique:!1}),u.createObjectStore(wh,{keyPath:_7}).createIndex(GM,w7,{unique:!1})})(e)))),r<16&&i>=16&&(o=o.next((()=>{t.objectStore(_h).clear()})).next((()=>{t.objectStore(wh).clear()}))),r<17&&i>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(Dw,{keyPath:A7})})(e)}))),r<18&&i>=18&&PN()&&(o=o.next((()=>{t.objectStore(_h).clear()})).next((()=>{t.objectStore(wh).clear()}))),o}wi(e){let t=0;return e.store(Ql).ee(((r,i)=>{t+=Y0(i)})).next((()=>{const r={byteSize:t};return e.store(Kh).put(L1,r)}))}yi(e){const t=e.store(Yh),r=e.store(la);return t.J().next((i=>ae.forEach(i,(a=>{const o=IDBKeyRange.bound([a.userId,pc],[a.userId,a.lastAcknowledgedBatchId]);return r.J(lc,o).next((c=>ae.forEach(c,(u=>{Fe(u.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const d=tc(this.serializer,u);return YP(e,a.userId,d).next((()=>{}))}))))}))))}Si(e){const t=e.store(hd),r=e.store(Ql);return e.store(gc).get(z0).next((i=>{const a=[];return r.ee(((o,c)=>{const u=new Ut(o),d=(function(p){return[0,Vr(p)]})(u);a.push(t.get(d).next((h=>h?ae.resolve():(p=>t.put({targetId:0,path:Vr(p),sequenceNumber:i.highestListenSequenceNumber}))(u))))})).next((()=>ae.waitFor(a)))}))}bi(e,t){e.createObjectStore(Xh,{keyPath:h7});const r=t.store(Xh),i=new Gw,a=o=>{if(i.add(o)){const c=o.lastSegment(),u=o.popLast();return r.put({collectionId:c,parent:Vr(u)})}};return t.store(Ql).ee({X:!0},((o,c)=>{const u=new Ut(o);return a(u.popLast())})).next((()=>t.store(dd).ee({X:!0},(([o,c,u],d)=>{const h=qa(c);return a(h.popLast())}))))}Di(e){const t=e.store(fd);return t.ee(((r,i)=>{const a=ch(i),o=FP(this.serializer,a);return t.put(o)}))}Ci(e,t){const r=t.store(Ql),i=[];return r.ee(((a,o)=>{const c=t.store(V0),u=(function(p){return p.document?new De(Ut.fromString(p.document.name).popFirst(5)):p.noDocument?De.fromSegments(p.noDocument.path):p.unknownDocument?De.fromSegments(p.unknownDocument.path):Le(36783)})(o).path.toArray(),d={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(c.put(d))})).next((()=>ae.waitFor(i)))}Fi(e,t){const r=t.store(la),i=JP(this.serializer),a=new Hw(Fv.mi,this.serializer.yt);return r.J().next((o=>{const c=new Map;return o.forEach((u=>{let d=c.get(u.userId)??xt();tc(this.serializer,u).keys().forEach((h=>d=d.add(h))),c.set(u.userId,d)})),ae.forEach(c,((u,d)=>{const h=new Tr(d),p=Bv.wt(this.serializer,h),m=a.getIndexManager(h),b=Uv.wt(h,this.serializer,m,a.referenceDelegate);return new eO(i,b,p,m).recalculateAndSaveOverlaysForDocumentKeys(new F1(t,Gi.ce),u).next()}))}))}}function fR(n){n.createObjectStore(hd,{keyPath:d7}).createIndex(Iw,f7,{unique:!0}),n.createObjectStore(fd,{keyPath:"targetId"}).createIndex(UM,u7,{unique:!0}),n.createObjectStore(gc)}const jo="IndexedDbPersistence",Nx=18e5,Mx=5e3,Px="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",XG="main";class $w{constructor(e,t,r,i,a,o,c,u,d,h,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=a,this.window=o,this.document=c,this.xi=d,this.Oi=h,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!$w.v())throw new Ce(me.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new jG(this,i),this.$i=t+XG,this.serializer=new UP(u),this.Ui=new tl(this.$i,this.Ni,new KG(this.serializer)),this.hi=new SG,this.Pi=new NG(this.referenceDelegate,this.serializer),this.remoteDocumentCache=JP(this.serializer),this.Ii=new EG,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&qr(jo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ce(me.FAILED_PRECONDITION,Px);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Gi(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Nm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(ml(e))return Te(jo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Te(jo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return th(e).get(Ru).next((t=>ae.resolve(this.es(t))))}ts(e){return Nm(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Nx)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=hr(t,pd);return r.J().next((i=>{const a=this.ss(i,Nx),o=i.filter((c=>a.indexOf(c)===-1));return ae.forEach(o,(c=>r.delete(c.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?ae.resolve(!0):th(e).get(Ru).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Mx)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Ce(me.FAILED_PRECONDITION,Px);return!1}}return!(!this.networkEnabled||!this.inForeground)||Nm(e).J().next((r=>this.ss(r,Mx).find((i=>{if(this.clientId!==i.clientId){const a=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,c=this.networkEnabled===i.networkEnabled;if(a||o&&c)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Te(jo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Cp,pd],(e=>{const t=new F1(e,Gi.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Nm(e).J().next((t=>this.ss(t,Nx).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return Uv.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new kG(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Bv.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){Te(jo,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",a=(function(u){return u===18?R7:u===17?KM:u===16?I7:u===15?kw:u===14?YM:u===13?$M:u===12?C7:u===11?HM:void Le(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,i,a,(c=>(o=new F1(c,this.ci?this.ci.next():Gi.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw qr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Ce(me.FAILED_PRECONDITION,jM);return r(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>r(o)))))).then((c=>(o.raiseOnCommittedEvent(),c)))}Is(e){return th(e).get(Ru).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Mx)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ce(me.FAILED_PRECONDITION,Px)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return th(e).put(Ru,t)}static v(){return tl.v()}Zi(e){const t=th(e);return t.get(Ru).next((r=>this.es(r)?(Te(jo,"Releasing primary lease."),t.delete(Ru)):ae.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(qr(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;MN()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return Te(jo,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return qr(jo,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){qr("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function th(n){return hr(n,Cp)}function Nm(n){return hr(n,pd)}function WG(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Yw{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=xt(),i=xt();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Yw(e,t.fromCache,r,i)}}class QG{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class tO{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return MN()?8:zM(fr())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const a={result:null};return this.ys(e,t).next((o=>{a.result=o})).next((()=>{if(!a.result)return this.ws(e,t,i,r).next((o=>{a.result=o}))})).next((()=>{if(a.result)return;const o=new QG;return this.Ss(e,t,o).next((c=>{if(a.result=c,this.Vs)return this.bs(e,t,o,c.size)}))})).next((()=>a.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(ju()<=At.DEBUG&&Te("QueryEngine","SDK will not create cache indexes for query:",Vu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ae.resolve()):(ju()<=At.DEBUG&&Te("QueryEngine","Query:",Vu(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(ju()<=At.DEBUG&&Te("QueryEngine","The SDK decides to create cache indexes for query:",Vu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Hi(t))):ae.resolve())}ys(e,t){if(jI(t))return ae.resolve(null);let r=Hi(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=F0(t,null,"F"),r=Hi(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((a=>{const o=xt(...a);return this.ps.getDocuments(e,o).next((c=>this.indexManager.getMinOffset(e,r).next((u=>{const d=this.Ds(t,c);return this.Cs(t,d,o,u.readTime)?this.ys(e,F0(t,null,"F")):this.vs(e,d,t,u)}))))})))))}ws(e,t,r,i){return jI(t)||i.isEqual(Xe.min())?ae.resolve(null):this.ps.getDocuments(e,r).next((a=>{const o=this.Ds(t,a);return this.Cs(t,o,r,i)?ae.resolve(null):(ju()<=At.DEBUG&&Te("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Vu(t)),this.vs(e,o,t,ZF(i,qh)).next((c=>c)))}))}Ds(e,t){let r=new Xt(pP(e));return t.forEach(((i,a)=>{Dp(e,a)&&(r=r.add(a))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,t,r){return ju()<=At.DEBUG&&Te("QueryEngine","Using full collection scan to execute query:",Vu(t)),this.ps.getDocumentsMatchingQuery(e,t,Ei.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((a=>(t.forEach((o=>{a=a.insert(o.key,o)})),a)))}}const Kw="LocalStore",ZG=3e8;class JG{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new En(at),this.xs=new Qs((a=>Ic(a)),Ip),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new eO(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function nO(n,e,t,r){return new JG(n,e,t,r)}async function rO(n,e){const t=ot(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((a=>(i=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((a=>{const o=[],c=[];let u=xt();for(const d of i){o.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}for(const d of a){c.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}return t.localDocuments.getDocuments(r,u).next((d=>({Ls:d,removedBatchIds:o,addedBatchIds:c})))}))}))}function eq(n,e){const t=ot(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,u,d,h){const p=d.batch,m=p.keys();let b=ae.resolve();return m.forEach((_=>{b=b.next((()=>h.getEntry(u,_))).next((w=>{const S=d.docVersions.get(_);Fe(S!==null,48541),w.version.compareTo(S)<0&&(p.applyToRemoteDocument(w,d),w.isValidDocument()&&(w.setReadTime(d.commitVersion),h.addEntry(w)))}))})),b.next((()=>c.mutationQueue.removeMutationBatch(u,p)))})(t,r,e,a).next((()=>a.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let u=xt();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function iO(n){const e=ot(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function tq(n,e){const t=ot(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const c=[];e.targetChanges.forEach(((h,p)=>{const m=i.get(p);if(!m)return;c.push(t.Pi.removeMatchingKeys(a,h.removedDocuments,p).next((()=>t.Pi.addMatchingKeys(a,h.addedDocuments,p))));let b=m.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(p)!==null?b=b.withResumeToken(tr.EMPTY_BYTE_STRING,Xe.min()).withLastLimboFreeSnapshotVersion(Xe.min()):h.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(h.resumeToken,r)),i=i.insert(p,b),(function(w,S,T){return w.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=ZG?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(m,b,h)&&c.push(t.Pi.updateTargetData(a,b))}));let u=wi(),d=xt();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(a,h))})),c.push(nq(a,o,e.documentUpdates).next((h=>{u=h.ks,d=h.qs}))),!r.isEqual(Xe.min())){const h=t.Pi.getLastRemoteSnapshotVersion(a).next((p=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,r)));c.push(h)}return ae.waitFor(c).next((()=>o.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,u,d))).next((()=>u))})).then((a=>(t.Ms=i,a)))}function nq(n,e,t){let r=xt(),i=xt();return t.forEach((a=>r=r.add(a))),e.getEntries(n,r).next((a=>{let o=wi();return t.forEach(((c,u)=>{const d=a.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(Xe.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):Te(Kw,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)})),{ks:o,qs:i}}))}function rq(n,e){const t=ot(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=pc),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function iq(n,e){const t=ot(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((a=>a?(i=a,ae.resolve(i)):t.Pi.allocateTargetId(r).next((o=>(i=new ks(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function n_(n,e,t){const r=ot(n),i=r.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,(o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!ml(o))throw o;Te(Kw,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function hR(n,e,t){const r=ot(n);let i=Xe.min(),a=xt();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(u,d,h){const p=ot(u),m=p.xs.get(h);return m!==void 0?ae.resolve(p.Ms.get(m)):p.Pi.getTargetData(d,h)})(r,o,Hi(e)).next((c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,c.targetId).next((u=>{a=u}))})).next((()=>r.Fs.getDocumentsMatchingQuery(o,e,t?i:Xe.min(),t?a:xt()))).next((c=>(aq(r,q7(e),c),{documents:c,Qs:a})))))}function aq(n,e,t){let r=n.Os.get(e)||Xe.min();t.forEach(((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)})),n.Os.set(e,r)}class pR{constructor(){this.activeTargetIds=W7()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class aO{constructor(){this.Mo=new pR,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new pR,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class sq{Oo(e){}shutdown(){}}const gR="ConnectivityMonitor";class mR{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Te(gR,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Te(gR,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Mm=null;function r_(){return Mm===null?Mm=(function(){return 268435456+Math.round(2147483648*Math.random())})():Mm++,"0x"+Mm.toString(16)}const Ox="RestConnection",oq={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class lq{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===L0?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,a){const o=r_(),c=this.zo(e,t.toUriEncodedString());Te(Ox,`Sending RPC '${e}' ${o}:`,c,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,a);const{host:d}=new URL(c),h=Od(d);return this.Jo(e,c,u,r,h).then((p=>(Te(Ox,`Received RPC '${e}' ${o}: `,p),p)),(p=>{throw Ac(Ox,`RPC '${e}' ${o} failed with error: `,p,"url: ",c,"request:",r),p}))}Ho(e,t,r,i,a,o){return this.Go(e,t,r,i,a)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Vd})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,a)=>e[a]=i)),r&&r.headers.forEach(((i,a)=>e[a]=i))}zo(e,t){const r=oq[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class cq{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Nr="WebChannelConnection";class uq extends lq{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,a){const o=r_();return new Promise(((c,u)=>{const d=new TM;d.setWithCredentials(!0),d.listenOnce(AM.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case i0.NO_ERROR:const p=d.getResponseJson();Te(Nr,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),c(p);break;case i0.TIMEOUT:Te(Nr,`RPC '${e}' ${o} timed out`),u(new Ce(me.DEADLINE_EXCEEDED,"Request time out"));break;case i0.HTTP_ERROR:const m=d.getStatus();if(Te(Nr,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let b=d.getResponseJson();Array.isArray(b)&&(b=b[0]);const _=b?.error;if(_&&_.status&&_.message){const w=(function(T){const A=T.toLowerCase().replace(/_/g,"-");return Object.values(me).indexOf(A)>=0?A:me.UNKNOWN})(_.status);u(new Ce(w,_.message))}else u(new Ce(me.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new Ce(me.UNAVAILABLE,"Connection failed."));break;default:Le(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Te(Nr,`RPC '${e}' ${o} completed.`)}}));const h=JSON.stringify(i);Te(Nr,`RPC '${e}' ${o} sending request:`,i),d.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=r_(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=RM(),c=IM(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const h=a.join("");Te(Nr,`Creating RPC '${e}' stream ${i}: ${h}`,u);const p=o.createWebChannel(h,u);this.I_(p);let m=!1,b=!1;const _=new cq({Yo:S=>{b?Te(Nr,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(m||(Te(Nr,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),Te(Nr,`RPC '${e}' stream ${i} sending:`,S),p.send(S))},Zo:()=>p.close()}),w=(S,T,A)=>{S.listen(T,(D=>{try{A(D)}catch(O){setTimeout((()=>{throw O}),0)}}))};return w(p,sh.EventType.OPEN,(()=>{b||(Te(Nr,`RPC '${e}' stream ${i} transport opened.`),_.o_())})),w(p,sh.EventType.CLOSE,(()=>{b||(b=!0,Te(Nr,`RPC '${e}' stream ${i} transport closed`),_.a_(),this.E_(p))})),w(p,sh.EventType.ERROR,(S=>{b||(b=!0,Ac(Nr,`RPC '${e}' stream ${i} transport errored. Name:`,S.name,"Message:",S.message),_.a_(new Ce(me.UNAVAILABLE,"The operation could not be completed")))})),w(p,sh.EventType.MESSAGE,(S=>{if(!b){const T=S.data[0];Fe(!!T,16349);const A=T,D=A?.error||A[0]?.error;if(D){Te(Nr,`RPC '${e}' stream ${i} received error:`,D);const O=D.status;let M=(function(I){const k=Qn[I];if(k!==void 0)return CP(k)})(O),j=D.message;M===void 0&&(M=me.INTERNAL,j="Unknown error status: "+O+" with message "+D.message),b=!0,_.a_(new Ce(M,j)),p.close()}else Te(Nr,`RPC '${e}' stream ${i} received:`,T),_.u_(T)}})),w(c,CM.STAT_EVENT,(S=>{S.stat===j1.PROXY?Te(Nr,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===j1.NOPROXY&&Te(Nr,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{_.__()}),0),_}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function dq(){return typeof window<"u"?window:null}function p0(){return typeof document<"u"?document:null}function Gv(n){return new fG(n,!0)}class sO{constructor(e,t,r=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&Te("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const vR="PersistentStream";class oO{constructor(e,t,r,i,a,o,c,u){this.Mi=e,this.S_=r,this.b_=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new sO(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===me.RESOURCE_EXHAUSTED?(qr(t.toString()),qr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===me.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new Ce(me.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Te(vR,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Te(vR,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class fq extends oO{constructor(e,t,r,i,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=gG(this.serializer,e),r=(function(a){if(!("targetChange"in a))return Xe.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?Xe.min():o.readTime?Yr(o.readTime):Xe.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Q1(this.serializer),t.addTarget=(function(a,o){let c;const u=o.target;if(c=B0(u)?{documents:OP(a,u)}:{query:jP(a,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=DP(a,o.resumeToken);const d=X1(a,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(Xe.min())>0){c.readTime=xd(a,o.snapshotVersion.toTimestamp());const d=X1(a,o.expectedCount);d!==null&&(c.expectedCount=d)}return c})(this.serializer,e);const r=vG(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Q1(this.serializer),t.removeTarget=e,this.q_(t)}}class hq extends oO{constructor(e,t,r,i,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Fe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Fe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Fe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=mG(e.writeResults,e.commitTime),r=Yr(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Q1(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>q0(this.serializer,r)))};this.q_(t)}}class pq{}class gq extends pq{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Ce(me.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Go(e,W1(t,r),i,a,o))).catch((a=>{throw a.name==="FirebaseError"?(a.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ce(me.UNKNOWN,a.toString())}))}Ho(e,t,r,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Ho(e,W1(t,r),i,o,c,a))).catch((o=>{throw o.name==="FirebaseError"?(o.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ce(me.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class mq{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(qr(t),this.aa=!1):Te("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Mc="RemoteStore";class vq{constructor(e,t,r,i,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((o=>{r.enqueueAndForget((async()=>{Uc(this)&&(Te(Mc,"Restarting streams for network reachability change."),await(async function(u){const d=ot(u);d.Ea.add(4),await Mp(d),d.Ra.set("Unknown"),d.Ea.delete(4),await qv(d)})(this))}))})),this.Ra=new mq(r,i)}}async function qv(n){if(Uc(n))for(const e of n.da)await e(!0)}async function Mp(n){for(const e of n.da)await e(!1)}function lO(n,e){const t=ot(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Zw(t)?Qw(t):Bd(t).O_()&&Ww(t,e))}function Xw(n,e){const t=ot(n),r=Bd(t);t.Ia.delete(e),r.O_()&&cO(t,e),t.Ia.size===0&&(r.O_()?r.L_():Uc(t)&&t.Ra.set("Unknown"))}function Ww(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Xe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Bd(n).Y_(e)}function cO(n,e){n.Va.Ue(e),Bd(n).Z_(e)}function Qw(n){n.Va=new lG({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Bd(n).start(),n.Ra.ua()}function Zw(n){return Uc(n)&&!Bd(n).x_()&&n.Ia.size>0}function Uc(n){return ot(n).Ea.size===0}function uO(n){n.Va=void 0}async function yq(n){n.Ra.set("Online")}async function bq(n){n.Ia.forEach(((e,t)=>{Ww(n,e)}))}async function xq(n,e){uO(n),Zw(n)?(n.Ra.ha(e),Qw(n)):n.Ra.set("Unknown")}async function _q(n,e,t){if(n.Ra.set("Online"),e instanceof RP&&e.state===2&&e.cause)try{await(async function(i,a){const o=a.cause;for(const c of a.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.Ia.delete(c),i.Va.removeTarget(c))})(n,e)}catch(r){Te(Mc,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await X0(n,r)}else if(e instanceof f0?n.Va.Ze(e):e instanceof IP?n.Va.st(e):n.Va.tt(e),!t.isEqual(Xe.min()))try{const r=await iO(n.localStore);t.compareTo(r)>=0&&await(function(a,o){const c=a.Va.Tt(o);return c.targetChanges.forEach(((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const h=a.Ia.get(d);h&&a.Ia.set(d,h.withResumeToken(u.resumeToken,o))}})),c.targetMismatches.forEach(((u,d)=>{const h=a.Ia.get(u);if(!h)return;a.Ia.set(u,h.withResumeToken(tr.EMPTY_BYTE_STRING,h.snapshotVersion)),cO(a,u);const p=new ks(h.target,u,d,h.sequenceNumber);Ww(a,p)})),a.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){Te(Mc,"Failed to raise snapshot:",r),await X0(n,r)}}async function X0(n,e,t){if(!ml(e))throw e;n.Ea.add(1),await Mp(n),n.Ra.set("Offline"),t||(t=()=>iO(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Te(Mc,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await qv(n)}))}function dO(n,e){return e().catch((t=>X0(n,t,e)))}async function Pp(n){const e=ot(n),t=ol(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:pc;for(;wq(e);)try{const i=await rq(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,Eq(e,i)}catch(i){await X0(e,i)}fO(e)&&hO(e)}function wq(n){return Uc(n)&&n.Ta.length<10}function Eq(n,e){n.Ta.push(e);const t=ol(n);t.O_()&&t.X_&&t.ea(e.mutations)}function fO(n){return Uc(n)&&!ol(n).x_()&&n.Ta.length>0}function hO(n){ol(n).start()}async function Sq(n){ol(n).ra()}async function Tq(n){const e=ol(n);for(const t of n.Ta)e.ea(t.mutations)}async function Aq(n,e,t){const r=n.Ta.shift(),i=zw.from(r,e,t);await dO(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await Pp(n)}async function Cq(n,e){e&&ol(n).X_&&await(async function(r,i){if((function(o){return aG(o)&&o!==me.ABORTED})(i.code)){const a=r.Ta.shift();ol(r).B_(),await dO(r,(()=>r.remoteSyncer.rejectFailedWrite(a.batchId,i))),await Pp(r)}})(n,e),fO(n)&&hO(n)}async function yR(n,e){const t=ot(n);t.asyncQueue.verifyOperationInProgress(),Te(Mc,"RemoteStore received new credentials");const r=Uc(t);t.Ea.add(3),await Mp(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await qv(t)}async function Iq(n,e){const t=ot(n);e?(t.Ea.delete(2),await qv(t)):e||(t.Ea.add(2),await Mp(t),t.Ra.set("Unknown"))}function Bd(n){return n.ma||(n.ma=(function(t,r,i){const a=ot(t);return a.sa(),new fq(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:yq.bind(null,n),t_:bq.bind(null,n),r_:xq.bind(null,n),H_:_q.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Zw(n)?Qw(n):n.Ra.set("Unknown")):(await n.ma.stop(),uO(n))}))),n.ma}function ol(n){return n.fa||(n.fa=(function(t,r,i){const a=ot(t);return a.sa(),new hq(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:Sq.bind(null,n),r_:Cq.bind(null,n),ta:Tq.bind(null,n),na:Aq.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Pp(n)):(await n.fa.stop(),n.Ta.length>0&&(Te(Mc,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Jw{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Wa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,a){const o=Date.now()+r,c=new Jw(e,t,o,i,a);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ce(me.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function eE(n,e){if(qr("AsyncQueue",`${e}: ${n}`),ml(n))return new Ce(me.UNAVAILABLE,`${e}: ${n}`);throw n}class id{static emptySet(e){return new id(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||De.comparator(t.key,r.key):(t,r)=>De.comparator(t.key,r.key),this.keyedMap=oh(),this.sortedSet=new En(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof id)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new id;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class bR{constructor(){this.ga=new En(De.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Le(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class _d{constructor(e,t,r,i,a,o,c,u,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,a){const o=[];return t.forEach((c=>{o.push({type:0,doc:c})})),new _d(e,t,id.emptySet(t),o,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&jv(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class Rq{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Dq{constructor(){this.queries=xR(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=ot(t),a=i.queries;i.queries=xR(),a.forEach(((o,c)=>{for(const u of c.Sa)u.onError(r)}))})(this,new Ce(me.ABORTED,"Firestore shutting down"))}}function xR(){return new Qs((n=>hP(n)),jv)}async function tE(n,e){const t=ot(n);let r=3;const i=e.query;let a=t.queries.get(i);a?!a.ba()&&e.Da()&&(r=2):(a=new Rq,r=e.Da()?0:1);try{switch(r){case 0:a.wa=await t.onListen(i,!0);break;case 1:a.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const c=eE(o,`Initialization of query '${Vu(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&rE(t)}async function nE(n,e){const t=ot(n),r=e.query;let i=3;const a=t.queries.get(r);if(a){const o=a.Sa.indexOf(e);o>=0&&(a.Sa.splice(o,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function kq(n,e){const t=ot(n);let r=!1;for(const i of e){const a=i.query,o=t.queries.get(a);if(o){for(const c of o.Sa)c.Fa(i)&&(r=!0);o.wa=i}}r&&rE(t)}function Nq(n,e,t){const r=ot(n),i=r.queries.get(e);if(i)for(const a of i.Sa)a.onError(t);r.queries.delete(e)}function rE(n){n.Ca.forEach((e=>{e.next()}))}var i_,_R;(_R=i_||(i_={})).Ma="default",_R.Cache="cache";class iE{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new _d(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=_d.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==i_.Cache}}class pO{constructor(e){this.key=e}}class gO{constructor(e){this.key=e}}class Mq{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=xt(),this.mutatedKeys=xt(),this.eu=pP(e),this.tu=new id(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new bR,i=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,o=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,p)=>{const m=i.get(h),b=Dp(this.query,p)?p:null,_=!!m&&this.mutatedKeys.has(m.key),w=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let S=!1;m&&b?m.data.isEqual(b.data)?_!==w&&(r.track({type:3,doc:b}),S=!0):this.su(m,b)||(r.track({type:2,doc:b}),S=!0,(u&&this.eu(b,u)>0||d&&this.eu(b,d)<0)&&(c=!0)):!m&&b?(r.track({type:0,doc:b}),S=!0):m&&!b&&(r.track({type:1,doc:m}),S=!0,(u||d)&&(c=!0)),S&&(b?(o=o.add(b),a=w?a.add(h):a.delete(h)):(o=o.delete(h),a=a.delete(h)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),a=a.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:c,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((h,p)=>(function(b,_){const w=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le(20277,{Rt:S})}};return w(b)-w(_)})(h.type,p.type)||this.eu(h.doc,p.doc))),this.ou(r),i=i??!1;const c=t&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,d=u!==this.Za;return this.Za=u,o.length!==0||d?{snapshot:new _d(this.query,e.tu,a,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new bR,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=xt(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new gO(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new pO(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=xt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return _d.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const aE="SyncEngine";class Pq{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Oq{constructor(e){this.key=e,this.hu=!1}}class jq{constructor(e,t,r,i,a,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Qs((c=>hP(c)),jv),this.Iu=new Map,this.Eu=new Set,this.du=new En(De.comparator),this.Au=new Map,this.Ru=new qw,this.Vu={},this.mu=new Map,this.fu=Nc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Vq(n,e,t=!0){const r=_O(n);let i;const a=r.Tu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await mO(r,e,t,!0),i}async function zq(n,e){const t=_O(n);await mO(t,e,!0,!1)}async function mO(n,e,t,r){const i=await iq(n.localStore,Hi(e)),a=i.targetId,o=n.sharedClientState.addLocalQueryTarget(a,t);let c;return r&&(c=await Lq(n,e,a,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&lO(n.remoteStore,i),c}async function Lq(n,e,t,r,i){n.pu=(p,m,b)=>(async function(w,S,T,A){let D=S.view.ru(T);D.Cs&&(D=await hR(w.localStore,S.query,!1).then((({documents:C})=>S.view.ru(C,D))));const O=A&&A.targetChanges.get(S.targetId),M=A&&A.targetMismatches.get(S.targetId)!=null,j=S.view.applyChanges(D,w.isPrimaryClient,O,M);return ER(w,S.targetId,j.au),j.snapshot})(n,p,m,b);const a=await hR(n.localStore,e,!0),o=new Mq(e,a.Qs),c=o.ru(a.documents),u=Np.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=o.applyChanges(c,n.isPrimaryClient,u);ER(n,t,d.au);const h=new Pq(e,t,o);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),d.snapshot}async function Bq(n,e,t){const r=ot(n),i=r.Tu.get(e),a=r.Iu.get(i.targetId);if(a.length>1)return r.Iu.set(i.targetId,a.filter((o=>!jv(o,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await n_(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Xw(r.remoteStore,i.targetId),a_(r,i.targetId)})).catch(Bc)):(a_(r,i.targetId),await n_(r.localStore,i.targetId,!0))}async function Uq(n,e){const t=ot(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Xw(t.remoteStore,r.targetId))}async function Fq(n,e,t){const r=wO(n);try{const i=await(function(o,c){const u=ot(o),d=vt.now(),h=c.reduce(((b,_)=>b.add(_.key)),xt());let p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",(b=>{let _=wi(),w=xt();return u.Ns.getEntries(b,h).next((S=>{_=S,_.forEach(((T,A)=>{A.isValidDocument()||(w=w.add(T))}))})).next((()=>u.localDocuments.getOverlayedDocuments(b,_))).next((S=>{p=S;const T=[];for(const A of c){const D=rG(A,p.get(A.key).overlayedDocument);D!=null&&T.push(new Zs(A.key,D,iP(D.value.mapValue),dr.exists(!0)))}return u.mutationQueue.addMutationBatch(b,d,T,c)})).next((S=>{m=S;const T=S.applyToLocalDocumentSet(p,w);return u.documentOverlayCache.saveOverlays(b,S.batchId,T)}))})).then((()=>({batchId:m.batchId,changes:mP(p)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,c,u){let d=o.Vu[o.currentUser.toKey()];d||(d=new En(at)),d=d.insert(c,u),o.Vu[o.currentUser.toKey()]=d})(r,i.batchId,t),await Op(r,i.changes),await Pp(r.remoteStore)}catch(i){const a=eE(i,"Failed to persist write");t.reject(a)}}async function vO(n,e){const t=ot(n);try{const r=await tq(t.localStore,e);e.targetChanges.forEach(((i,a)=>{const o=t.Au.get(a);o&&(Fe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?Fe(o.hu,14607):i.removedDocuments.size>0&&(Fe(o.hu,42227),o.hu=!1))})),await Op(t,r,e)}catch(r){await Bc(r)}}function wR(n,e,t){const r=ot(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((a,o)=>{const c=o.view.va(e);c.snapshot&&i.push(c.snapshot)})),(function(o,c){const u=ot(o);u.onlineState=c;let d=!1;u.queries.forEach(((h,p)=>{for(const m of p.Sa)m.va(c)&&(d=!0)})),d&&rE(u)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Gq(n,e,t){const r=ot(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),a=i&&i.key;if(a){let o=new En(De.comparator);o=o.insert(a,Nn.newNoDocument(a,Xe.min()));const c=xt().add(a),u=new Lv(Xe.min(),new Map,new En(at),o,c);await vO(r,u),r.du=r.du.remove(a),r.Au.delete(e),sE(r)}else await n_(r.localStore,e,!1).then((()=>a_(r,e,t))).catch(Bc)}async function qq(n,e){const t=ot(n),r=e.batch.batchId;try{const i=await eq(t.localStore,e);bO(t,r,null),yO(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Op(t,i)}catch(i){await Bc(i)}}async function Hq(n,e,t){const r=ot(n);try{const i=await(function(o,c){const u=ot(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let h;return u.mutationQueue.lookupMutationBatch(d,c).next((p=>(Fe(p!==null,37113),h=p.keys(),u.mutationQueue.removeMutationBatch(d,p)))).next((()=>u.mutationQueue.performConsistencyCheck(d))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(d,h,c))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h))).next((()=>u.localDocuments.getDocuments(d,h)))}))})(r.localStore,e);bO(r,e,t),yO(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Op(r,i)}catch(i){await Bc(i)}}function yO(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function bO(n,e,t){const r=ot(n);let i=r.Vu[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function a_(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||xO(n,r)}))}function xO(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Xw(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),sE(n))}function ER(n,e,t){for(const r of t)r instanceof pO?(n.Ru.addReference(r.key,e),$q(n,r)):r instanceof gO?(Te(aE,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||xO(n,r.key)):Le(19791,{wu:r})}function $q(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(Te(aE,"New document in limbo: "+t),n.Eu.add(r),sE(n))}function sE(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new De(Ut.fromString(e)),r=n.fu.next();n.Au.set(r,new Oq(t)),n.du=n.du.insert(t,r),lO(n.remoteStore,new ks(Hi(Rp(t.path)),r,"TargetPurposeLimboResolution",Gi.ce))}}async function Op(n,e,t){const r=ot(n),i=[],a=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,u)=>{o.push(r.pu(u,e,t).then((d=>{if((d||t)&&r.isPrimaryClient){const h=d?!d.fromCache:t?.targetChanges.get(u.targetId)?.current;r.sharedClientState.updateQueryState(u.targetId,h?"current":"not-current")}if(d){i.push(d);const h=Yw.As(u.targetId,d);a.push(h)}})))})),await Promise.all(o),r.Pu.H_(i),await(async function(u,d){const h=ot(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>ae.forEach(d,(m=>ae.forEach(m.Es,(b=>h.persistence.referenceDelegate.addReference(p,m.targetId,b))).next((()=>ae.forEach(m.ds,(b=>h.persistence.referenceDelegate.removeReference(p,m.targetId,b)))))))))}catch(p){if(!ml(p))throw p;Te(Kw,"Failed to update sequence numbers: "+p)}for(const p of d){const m=p.targetId;if(!p.fromCache){const b=h.Ms.get(m),_=b.snapshotVersion,w=b.withLastLimboFreeSnapshotVersion(_);h.Ms=h.Ms.insert(m,w)}}})(r.localStore,a))}async function Yq(n,e){const t=ot(n);if(!t.currentUser.isEqual(e)){Te(aE,"User change. New user:",e.toKey());const r=await rO(t.localStore,e);t.currentUser=e,(function(a,o){a.mu.forEach((c=>{c.forEach((u=>{u.reject(new Ce(me.CANCELLED,o))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Op(t,r.Ls)}}function Kq(n,e){const t=ot(n),r=t.Au.get(e);if(r&&r.hu)return xt().add(r.key);{let i=xt();const a=t.Iu.get(e);if(!a)return i;for(const o of a){const c=t.Tu.get(o);i=i.unionWith(c.view.nu)}return i}}function _O(n){const e=ot(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=vO.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Kq.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Gq.bind(null,e),e.Pu.H_=kq.bind(null,e.eventManager),e.Pu.yu=Nq.bind(null,e.eventManager),e}function wO(n){const e=ot(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=qq.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Hq.bind(null,e),e}class rp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Gv(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return nO(this.persistence,new tO,e.initialUser,this.serializer)}Cu(e){return new Hw(Fv.mi,this.serializer)}Du(e){return new aO}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}rp.provider={build:()=>new rp};class Xq extends rp{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Fe(this.persistence.referenceDelegate instanceof K0,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new WP(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Mr.withCacheSize(this.cacheSizeBytes):Mr.DEFAULT;return new Hw((r=>K0.mi(r,t)),this.serializer)}}class Wq extends rp{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await wO(this.xu.syncEngine),await Pp(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return nO(this.persistence,new tO,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new WP(r,e.asyncQueue,t)}Mu(e,t){const r=new n7(t,this.persistence);return new t7(e.asyncQueue,r)}Cu(e){const t=WG(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Mr.withCacheSize(this.cacheSizeBytes):Mr.DEFAULT;return new $w(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,dq(),p0(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new aO}}class W0{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>wR(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Yq.bind(null,this.syncEngine),await Iq(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Dq})()}createDatastore(e){const t=Gv(e.databaseInfo.databaseId),r=(function(a){return new uq(a)})(e.databaseInfo);return(function(a,o,c,u){return new gq(a,o,c,u)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,a,o,c){return new vq(r,i,a,o,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>wR(this.syncEngine,t,0)),(function(){return mR.v()?new mR:new sq})())}createSyncEngine(e,t){return(function(i,a,o,c,u,d,h){const p=new jq(i,a,o,c,u,d);return h&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=ot(t);Te(Mc,"RemoteStore shutting down."),r.Ea.add(5),await Mp(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}W0.provider={build:()=>new W0};class oE{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):qr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const ll="FirestoreClient";class Qq{constructor(e,t,r,i,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Tr.UNAUTHENTICATED,this.clientId=Tw.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,(async o=>{Te(ll,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(Te(ll,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Wa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=eE(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function jx(n,e){n.asyncQueue.verifyOperationInProgress(),Te(ll,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await rO(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function SR(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Zq(n);Te(ll,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>yR(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>yR(e.remoteStore,i))),n._onlineComponents=e}async function Zq(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Te(ll,"Using user provided OfflineComponentProvider");try{await jx(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===me.FAILED_PRECONDITION||i.code===me.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Ac("Error using user provided cache. Falling back to memory cache: "+t),await jx(n,new rp)}}else Te(ll,"Using default OfflineComponentProvider"),await jx(n,new Xq(void 0));return n._offlineComponents}async function EO(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Te(ll,"Using user provided OnlineComponentProvider"),await SR(n,n._uninitializedComponentsProvider._online)):(Te(ll,"Using default OnlineComponentProvider"),await SR(n,new W0))),n._onlineComponents}function Jq(n){return EO(n).then((e=>e.syncEngine))}async function Q0(n){const e=await EO(n),t=e.eventManager;return t.onListen=Vq.bind(null,e.syncEngine),t.onUnlisten=Bq.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=zq.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Uq.bind(null,e.syncEngine),t}function eH(n,e,t={}){const r=new Wa;return n.asyncQueue.enqueueAndForget((async()=>(function(a,o,c,u,d){const h=new oE({next:m=>{h.Nu(),o.enqueueAndForget((()=>nE(a,p)));const b=m.docs.has(c);!b&&m.fromCache?d.reject(new Ce(me.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&m.fromCache&&u&&u.source==="server"?d.reject(new Ce(me.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new iE(Rp(c.path),h,{includeMetadataChanges:!0,qa:!0});return tE(a,p)})(await Q0(n),n.asyncQueue,e,t,r))),r.promise}function tH(n,e,t={}){const r=new Wa;return n.asyncQueue.enqueueAndForget((async()=>(function(a,o,c,u,d){const h=new oE({next:m=>{h.Nu(),o.enqueueAndForget((()=>nE(a,p))),m.fromCache&&u.source==="server"?d.reject(new Ce(me.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new iE(c,h,{includeMetadataChanges:!0,qa:!0});return tE(a,p)})(await Q0(n),n.asyncQueue,e,t,r))),r.promise}function SO(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const TR=new Map;const TO="firestore.googleapis.com",AR=!0;class CR{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ce(me.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=TO,this.ssl=AR}else this.host=e.host,this.ssl=e.ssl??AR;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=$P;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<MG)throw new Ce(me.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}QF("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=SO(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Ce(me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Ce(me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Ce(me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Hv{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new CR({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ce(me.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ce(me.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new CR(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new UF;switch(r.type){case"firstParty":return new HF(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Ce(me.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=TR.get(t);r&&(Te("ComponentProvider","Removing Datastore"),TR.delete(t),r.terminate())})(this),Promise.resolve()}}function nH(n,e,t,r={}){n=jr(n,Hv);const i=Od(e),a=n._getSettings(),o={...a,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;i&&(DN(`https://${c}`),kN("Firestore",!0)),a.host!==TO&&a.host!==c&&Ac("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...a,host:c,ssl:i,emulatorOptions:r};if(!il(u,o)&&(n._setSettings(u),r.mockUserToken)){let d,h;if(typeof r.mockUserToken=="string")d=r.mockUserToken,h=Tr.MOCK_USER;else{d=X9(r.mockUserToken,n._app?.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new Ce(me.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Tr(p)}n._authCredentials=new FF(new kM(d,h))}}class Js{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Js(this.firestore,e,this._query)}}class Pn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new nl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Pn(this.firestore,e,this._key)}toJSON(){return{type:Pn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Ap(t,Pn._jsonSchema))return new Pn(e,r||null,new De(Ut.fromString(t.referencePath)))}}Pn._jsonSchemaVersion="firestore/documentReference/1.0",Pn._jsonSchema={type:er("string",Pn._jsonSchemaVersion),referencePath:er("string")};class nl extends Js{constructor(e,t,r){super(e,t,Rp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Pn(this.firestore,null,new De(e))}withConverter(e){return new nl(this.firestore,e,this._path)}}function Bi(n,e,...t){if(n=vn(n),MM("collection","path",e),n instanceof Hv){const r=Ut.fromString(e,...t);return vI(r),new nl(n,null,r)}{if(!(n instanceof Pn||n instanceof nl))throw new Ce(me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ut.fromString(e,...t));return vI(r),new nl(n.firestore,null,r)}}function Gt(n,e,...t){if(n=vn(n),arguments.length===1&&(e=Tw.newId()),MM("doc","path",e),n instanceof Hv){const r=Ut.fromString(e,...t);return mI(r),new Pn(n,null,new De(r))}{if(!(n instanceof Pn||n instanceof nl))throw new Ce(me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ut.fromString(e,...t));return mI(r),new Pn(n.firestore,n instanceof nl?n.converter:null,new De(r))}}const IR="AsyncQueue";class RR{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new sO(this,"async_queue_retry"),this._c=()=>{const r=p0();r&&Te(IR,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=p0();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=p0();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Wa;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ml(e))throw e;Te(IR,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,qr("INTERNAL UNHANDLED ERROR: ",DR(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=Jw.createAndSchedule(this,e,t,r,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&Le(47125,{Pc:DR(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function DR(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function kR(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const a of r)if(a in i&&typeof i[a]=="function")return!0;return!1})(n,["next","error","complete"])}class va extends Hv{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new RR,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new RR(e),this._firestoreClient=void 0,await e}}}function rH(n,e){const t=typeof n=="object"?n:LN(),r=typeof n=="string"?n:L0,i=gw(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const a=Y9("firestore");a&&nH(i,...a)}return i}function jp(n){if(n._terminated)throw new Ce(me.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||AO(n),n._firestoreClient}function AO(n){const e=n._freezeSettings(),t=(function(i,a,o,c){return new k7(i,a,o,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,SO(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Qq(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}})(n._componentsProvider))}function iH(n,e){Ac("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return aH(n,W0.provider,{build:r=>new Wq(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function aH(n,e,t){if((n=jr(n,va))._firestoreClient||n._terminated)throw new Ce(me.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Ce(me.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},AO(n)}class Fi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Fi(tr.fromBase64String(e))}catch(t){throw new Ce(me.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Fi(tr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Fi._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ap(e,Fi._jsonSchema))return Fi.fromBase64String(e.bytes)}}Fi._jsonSchemaVersion="firestore/bytes/1.0",Fi._jsonSchema={type:er("string",Fi._jsonSchemaVersion),bytes:er("string")};class Vp{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ce(me.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new An(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class $v{constructor(e){this._methodName=e}}class Qa{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ce(me.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ce(me.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return at(this._lat,e._lat)||at(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Qa._jsonSchemaVersion}}static fromJSON(e){if(Ap(e,Qa._jsonSchema))return new Qa(e.latitude,e.longitude)}}Qa._jsonSchemaVersion="firestore/geoPoint/1.0",Qa._jsonSchema={type:er("string",Qa._jsonSchemaVersion),latitude:er("number"),longitude:er("number")};class Za{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Za._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ap(e,Za._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Za(e.vectorValues);throw new Ce(me.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Za._jsonSchemaVersion="firestore/vectorValue/1.0",Za._jsonSchema={type:er("string",Za._jsonSchemaVersion),vectorValues:er("object")};const sH=/^__.*__$/;class oH{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Zs(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ld(e,this.data,t,this.fieldTransforms)}}class CO{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Zs(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function IO(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le(40011,{Ac:n})}}class Yv{constructor(e,t,r,i,a,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Yv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Z0(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(IO(this.Ac)&&sH.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class lH{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Gv(e)}Cc(e,t,r,i=!1){return new Yv({Ac:e,methodName:t,Dc:r,path:An.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zp(n){const e=n._freezeSettings(),t=Gv(n._databaseId);return new lH(n._databaseId,!!e.ignoreUndefinedProperties,t)}function lE(n,e,t,r,i,a={}){const o=n.Cc(a.merge||a.mergeFields?2:0,e,t,i);uE("Data must be an object, but it was:",o,r);const c=kO(r,o);let u,d;if(a.merge)u=new ri(o.fieldMask),d=o.fieldTransforms;else if(a.mergeFields){const h=[];for(const p of a.mergeFields){const m=s_(e,p,t);if(!o.contains(m))throw new Ce(me.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);MO(h,m)||h.push(m)}u=new ri(h),d=o.fieldTransforms.filter((p=>u.covers(p.field)))}else u=null,d=o.fieldTransforms;return new oH(new Pr(c),u,d)}class Lp extends $v{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Lp}}function cH(n,e,t){return new Yv({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class cE extends $v{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=cH(this,e,!0),r=this.vc.map((a=>Ud(a,t))),i=new Rc(r);return new EP(e.path,i)}isEqual(e){return e instanceof cE&&il(this.vc,e.vc)}}function RO(n,e,t,r){const i=n.Cc(1,e,t);uE("Data must be an object, but it was:",i,r);const a=[],o=Pr.empty();vl(r,((u,d)=>{const h=dE(e,u,t);d=vn(d);const p=i.yc(h);if(d instanceof Lp)a.push(h);else{const m=Ud(d,p);m!=null&&(a.push(h),o.set(h,m))}}));const c=new ri(a);return new CO(o,c,i.fieldTransforms)}function DO(n,e,t,r,i,a){const o=n.Cc(1,e,t),c=[s_(e,r,t)],u=[i];if(a.length%2!=0)throw new Ce(me.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<a.length;m+=2)c.push(s_(e,a[m])),u.push(a[m+1]);const d=[],h=Pr.empty();for(let m=c.length-1;m>=0;--m)if(!MO(d,c[m])){const b=c[m];let _=u[m];_=vn(_);const w=o.yc(b);if(_ instanceof Lp)d.push(b);else{const S=Ud(_,w);S!=null&&(d.push(b),h.set(b,S))}}const p=new ri(d);return new CO(h,p,o.fieldTransforms)}function uH(n,e,t,r=!1){return Ud(t,n.Cc(r?4:3,e))}function Ud(n,e){if(NO(n=vn(n)))return uE("Unsupported field value:",e,n),kO(n,e);if(n instanceof $v)return(function(r,i){if(!IO(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(i);a&&i.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const a=[];let o=0;for(const c of r){let u=Ud(c,i.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),o++}return{arrayValue:{values:a}}})(n,e)}return(function(r,i){if((r=vn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Q7(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=vt.fromDate(r);return{timestampValue:xd(i.serializer,a)}}if(r instanceof vt){const a=new vt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:xd(i.serializer,a)}}if(r instanceof Qa)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Fi)return{bytesValue:DP(i.serializer,r._byteString)};if(r instanceof Pn){const a=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(a))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Uw(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Za)return(function(o,c){return{mapValue:{fields:{[Mw]:{stringValue:Pw},[gd]:{arrayValue:{values:o.toArray().map((d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return jw(c.serializer,d)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${Iv(r)}`)})(n,e)}function kO(n,e){const t={};return XM(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):vl(n,((r,i)=>{const a=Ud(i,e.mc(r));a!=null&&(t[r]=a)})),{mapValue:{fields:t}}}function NO(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof vt||n instanceof Qa||n instanceof Fi||n instanceof Pn||n instanceof $v||n instanceof Za)}function uE(n,e,t){if(!NO(t)||!PM(t)){const r=Iv(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function s_(n,e,t){if((e=vn(e))instanceof Vp)return e._internalPath;if(typeof e=="string")return dE(n,e);throw Z0("Field path arguments must be of type string or ",n,!1,void 0,t)}const dH=new RegExp("[~\\*/\\[\\]]");function dE(n,e,t){if(e.search(dH)>=0)throw Z0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Vp(...e.split("."))._internalPath}catch{throw Z0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Z0(n,e,t,r,i){const a=r&&!r.isEmpty(),o=i!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(a||o)&&(u+=" (found",a&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new Ce(me.INVALID_ARGUMENT,c+n+u)}function MO(n,e){return n.some((t=>t.isEqual(e)))}class PO{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Pn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new fH(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Kv("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class fH extends PO{data(){return super.data()}}function Kv(n,e){return typeof e=="string"?dE(n,e):e instanceof Vp?e._internalPath:e._delegate._internalPath}function OO(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ce(me.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class fE{}class hE extends fE{}function Gs(n,e,...t){let r=[];e instanceof fE&&r.push(e),r=r.concat(t),(function(a){const o=a.filter((u=>u instanceof pE)).length,c=a.filter((u=>u instanceof Xv)).length;if(o>1||o>0&&c>0)throw new Ce(me.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class Xv extends hE{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Xv(e,t,r)}_apply(e){const t=this._parse(e);return jO(e._query,t),new Js(e.firestore,e.converter,K1(e._query,t))}_parse(e){const t=zp(e.firestore);return(function(a,o,c,u,d,h,p){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Ce(me.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){PR(p,h);const _=[];for(const w of p)_.push(MR(u,a,w));m={arrayValue:{values:_}}}else m=MR(u,a,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||PR(p,h),m=uH(c,o,p,h==="in"||h==="not-in");return Ct.create(d,h,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function hH(n,e,t){const r=e,i=Kv("where",n);return Xv._create(i,r,t)}class pE extends fE{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new pE(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Kt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,a){let o=i;const c=a.getFlattenedFilters();for(const u of c)jO(o,u),o=K1(o,u)})(e._query,t),new Js(e.firestore,e.converter,K1(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class gE extends hE{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new gE(e,t)}_apply(e){const t=(function(i,a,o){if(i.startAt!==null)throw new Ce(me.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Ce(me.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ep(a,o)})(e._query,this._field,this._direction);return new Js(e.firestore,e.converter,(function(i,a){const o=i.explicitOrderBy.concat([a]);return new zd(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}}function wd(n,e="asc"){const t=e,r=Kv("orderBy",n);return gE._create(r,t)}class mE extends hE{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new mE(e,t,r)}_apply(e){return new Js(e.firestore,e.converter,F0(e._query,this._limit,this._limitType))}}function NR(n){return mE._create("limit",n,"F")}function MR(n,e,t){if(typeof(t=vn(t))=="string"){if(t==="")throw new Ce(me.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!fP(e)&&t.indexOf("/")!==-1)throw new Ce(me.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Ut.fromString(t));if(!De.isDocumentKey(r))throw new Ce(me.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Zh(n,new De(r))}if(t instanceof Pn)return Zh(n,t._key);throw new Ce(me.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Iv(t)}.`)}function PR(n,e){if(!Array.isArray(n)||n.length===0)throw new Ce(me.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function jO(n,e){const t=(function(i,a){for(const o of i)for(const c of o.getFlattenedFilters())if(a.indexOf(c.op)>=0)return c.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ce(me.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ce(me.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class pH{convertValue(e,t="none"){switch(al(e)){case 0:return null;case 1:return e.booleanValue;case 2:return _n(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Fs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Le(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return vl(e,((i,a)=>{r[i]=this.convertValue(a,t)})),r}convertVectorValue(e){const t=e.fields?.[gd].arrayValue?.values?.map((r=>_n(r.doubleValue)));return new Za(t)}convertGeoPoint(e){return new Qa(_n(e.latitude),_n(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Pv(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Wh(e));default:return null}}convertTimestamp(e){const t=Us(e);return new vt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Ut.fromString(e);Fe(BP(r),9688,{name:e});const i=new Cc(r.get(1),r.get(3)),a=new De(r.popFirst(5));return i.isEqual(t)||qr(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function vE(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class uh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class vc extends PO{constructor(e,t,r,i,a,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new g0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Kv("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ce(me.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=vc._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}vc._jsonSchemaVersion="firestore/documentSnapshot/1.0",vc._jsonSchema={type:er("string",vc._jsonSchemaVersion),bundleSource:er("string","DocumentSnapshot"),bundleName:er("string"),bundle:er("string")};class g0 extends vc{data(e={}){return super.data(e)}}class yc{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new uh(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new g0(this._firestore,this._userDataWriter,r.key,r,new uh(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ce(me.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((c=>{const u=new g0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new uh(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((c=>a||c.type!==3)).map((c=>{const u=new g0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new uh(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),h=o.indexOf(c.doc.key)),{type:gH(c.type),doc:u,oldIndex:d,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ce(me.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=yc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Tw.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function gH(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Le(61501,{type:n})}}function Vx(n){n=jr(n,Pn);const e=jr(n.firestore,va);return eH(jp(e),n._key).then((t=>VO(e,n,t)))}yc._jsonSchemaVersion="firestore/querySnapshot/1.0",yc._jsonSchema={type:er("string",yc._jsonSchemaVersion),bundleSource:er("string","QuerySnapshot"),bundleName:er("string"),bundle:er("string")};class yE extends pH{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Pn(this.firestore,null,t)}}function Fa(n){n=jr(n,Js);const e=jr(n.firestore,va),t=jp(e),r=new yE(e);return OO(n._query),tH(t,n._query).then((i=>new yc(e,r,n,i)))}function ca(n,e,t){n=jr(n,Pn);const r=jr(n.firestore,va),i=vE(n.converter,e,t);return Up(r,[lE(zp(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,dr.none())])}function Ba(n,e,t,...r){n=jr(n,Pn);const i=jr(n.firestore,va),a=zp(i);let o;return o=typeof(e=vn(e))=="string"||e instanceof Vp?DO(a,"updateDoc",n._key,e,t,r):RO(a,"updateDoc",n._key,e),Up(i,[o.toMutation(n._key,dr.exists(!0))])}function Ga(n){return Up(jr(n.firestore,va),[new kp(n._key,dr.none())])}function Wv(n,e){const t=jr(n.firestore,va),r=Gt(n),i=vE(n.converter,e);return Up(t,[lE(zp(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,dr.exists(!1))]).then((()=>r))}function Bp(n,...e){n=vn(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||kR(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(kR(e[r])){const u=e[r];e[r]=u.next?.bind(u),e[r+1]=u.error?.bind(u),e[r+2]=u.complete?.bind(u)}let a,o,c;if(n instanceof Pn)o=jr(n.firestore,va),c=Rp(n._key.path),a={next:u=>{e[r]&&e[r](VO(o,n,u))},error:e[r+1],complete:e[r+2]};else{const u=jr(n,Js);o=jr(u.firestore,va),c=u._query;const d=new yE(o);a={next:h=>{e[r]&&e[r](new yc(o,d,u,h))},error:e[r+1],complete:e[r+2]},OO(n._query)}return(function(d,h,p,m){const b=new oE(m),_=new iE(h,b,p);return d.asyncQueue.enqueueAndForget((async()=>tE(await Q0(d),_))),()=>{b.Nu(),d.asyncQueue.enqueueAndForget((async()=>nE(await Q0(d),_)))}})(jp(o),c,i,a)}function Up(n,e){return(function(r,i){const a=new Wa;return r.asyncQueue.enqueueAndForget((async()=>Fq(await Jq(r),i,a))),a.promise})(jp(n),e)}function VO(n,e,t){const r=t.docs.get(e._key),i=new yE(n);return new vc(n,i,e._key,r,new uh(t.hasPendingWrites,t.fromCache),e.converter)}class mH{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=zp(e)}set(e,t,r){this._verifyNotCommitted();const i=zx(e,this._firestore),a=vE(i.converter,t,r),o=lE(this._dataReader,"WriteBatch.set",i._key,a,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,dr.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const a=zx(e,this._firestore);let o;return o=typeof(t=vn(t))=="string"||t instanceof Vp?DO(this._dataReader,"WriteBatch.update",a._key,t,r,i):RO(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(o.toMutation(a._key,dr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=zx(e,this._firestore);return this._mutations=this._mutations.concat(new kp(t._key,dr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ce(me.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function zx(n,e){if((n=vn(n)).firestore!==e)throw new Ce(me.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function OR(){return new Lp("deleteField")}function vH(...n){return new cE("arrayUnion",n)}function yH(n){return jp(n=jr(n,va)),new mH(n,(e=>Up(n,e)))}(function(e,t=!0){(function(i){Vd=i})(jd),ld(new wc("firestore",((r,{instanceIdentifier:i,options:a})=>{const o=r.getProvider("app").getImmediate(),c=new va(new GF(r.getProvider("auth-internal")),new $F(o,r.getProvider("app-check-internal")),(function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Ce(me.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Cc(d.options.projectId,h)})(o,i),o);return a={useFetchStreams:t,...a},c._setSettings(a),c}),"PUBLIC").setMultipleInstances(!0)),Jo(fI,hI,e),Jo(fI,hI,"esm2020")})();const bH={apiKey:"AIzaSyDwUA0paVI6n01aENV5Q2aLwVz1DEDtNuA",authDomain:"personal-budget-pwa-5defb.firebaseapp.com",projectId:"personal-budget-pwa-5defb",storageBucket:"personal-budget-pwa-5defb.firebasestorage.app",messagingSenderId:"137454342284",appId:"1:137454342284:web:d7a8169fd53f437e42aba9"},zO=zN(bH),Vo=VF(zO),mt=rH(zO);iH(mt).catch(n=>{n.code==="failed-precondition"?console.warn(" Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"?console.warn(" Offline persistence not available in this browser"):console.error(" Failed to enable offline persistence:",n)});const Lx=n=>({id:n.uid,username:n.email||n.uid,displayName:n.displayName||n.email?.split("@")[0]||"User",email:n.email||void 0}),fa=fw()(wN(n=>({currentUser:null,isAuthenticated:!1,loginError:null,isLoading:!1,isInitialized:!1,isInitializing:!0,lastAuthTime:null,offlineGracePeriod:10080*60*1e3,lastVerificationEmailSent:null,login:async(e,t)=>{n({isLoading:!0,loginError:null});try{const i=(await xU(Vo,e,t)).user;if(!i.emailVerified)return await tI(Vo),n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:"Please verify your email address before signing in. Check your email for a verification link."}),console.log(` Login blocked: ${i.email} not verified`),!1;const a=Lx(i);return n({currentUser:a,isAuthenticated:!0,isLoading:!1,loginError:null,lastAuthTime:Date.now()}),console.log(` User logged in: ${a.email}`),!0}catch(r){console.error("Login error:",r),console.error("Error code:",r.code),console.error("Error message:",r.message);let i="Login failed. Please try again.";if(r.code)switch(r.code){case"auth/invalid-email":i="Invalid email address.";break;case"auth/user-disabled":i="This account has been disabled.";break;case"auth/user-not-found":i="No account found with this email.";break;case"auth/wrong-password":i="Incorrect password.";break;case"auth/too-many-requests":i="Too many failed attempts. Please try again later.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break;case"auth/invalid-credential":i="Invalid email or password.";break;default:console.warn(`Unhandled Firebase error code: ${r.code}`),i="Authentication failed. Please try again.";break}else console.warn("Non-Firebase error in login:",r),i="An unexpected error occurred. Please try again.";return n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:i}),!1}},register:async(e,t,r)=>{n({isLoading:!0,loginError:null});try{const a=(await bU(Vo,e,t)).user;await wU(a,{displayName:r}),await eI(a);const o=Lx(a);return n({currentUser:o,isAuthenticated:!1,isLoading:!1,loginError:null,lastVerificationEmailSent:Date.now()}),console.log(` User registered: ${o.email}, verification email sent`),!0}catch(i){console.error("Registration error:",i);let a="Registration failed. Please try again.";switch(i.code){case"auth/email-already-in-use":a="An account with this email already exists.";break;case"auth/invalid-email":a="Invalid email address.";break;case"auth/weak-password":a="Password should be at least 6 characters.";break;case"auth/operation-not-allowed":a="Email/password accounts are not enabled.";break}return n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:a}),!1}},logout:async()=>{try{await tI(Vo),console.log(" User logged out")}catch(e){console.error("Logout error:",e)}},clearError:()=>{n({loginError:null})},sendPasswordReset:async e=>{n({isLoading:!0,loginError:null});try{return await yU(Vo,e),n({isLoading:!1}),!0}catch(t){console.error("Password reset error:",t);let r="Failed to send password reset email. Please try again.";switch(t.code){case"auth/user-not-found":r="No account found with this email.";break;case"auth/invalid-email":r="Invalid email address.";break;case"auth/too-many-requests":r="Too many attempts. Please try again later.";break}return n({isLoading:!1,loginError:r}),!1}},sendEmailVerification:async()=>{const e=Vo.currentUser;if(!e)return n({loginError:"No user is currently signed in."}),!1;n({isLoading:!0,loginError:null});try{return await eI(e),n({isLoading:!1,lastVerificationEmailSent:Date.now()}),console.log(` Verification email sent to: ${e.email}`),!0}catch(t){console.error("Email verification error:",t);let r="Failed to send verification email. Please try again.";switch(t.code){case"auth/too-many-requests":r="Too many verification emails sent. Please wait before trying again.";break}return n({isLoading:!1,loginError:r}),!1}},resendEmailVerification:async()=>{const e=fa.getState();if(e.lastVerificationEmailSent){const t=Date.now()-e.lastVerificationEmailSent,r=60*1e3;if(t<r){const i=Math.ceil((r-t)/1e3);return n({loginError:`Please wait ${i} seconds before requesting another verification email.`}),!1}}return e.sendEmailVerification()},deleteAccount:async e=>{const t=Vo.currentUser;if(!t||!t.email)return n({loginError:"No user is currently signed in."}),!1;n({isLoading:!0,loginError:null});try{const r=Lc.credential(t.email,e);return await vU(t,r),await AU(t),n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:null,lastAuthTime:null}),console.log(` Account permanently deleted: ${t.email}`),!0}catch(r){console.error("Account deletion error:",r);let i="Failed to delete account. Please try again.";switch(r.code){case"auth/requires-recent-login":i="For security, please log out and log back in before deleting your account.";break;case"auth/wrong-password":i="Incorrect password. Please enter your current password.";break;case"auth/too-many-requests":i="Too many deletion attempts. Please wait before trying again.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break}return n({isLoading:!1,loginError:i}),!1}},initializeAuth:()=>fa.getState().isInitialized?()=>{}:(n({isInitialized:!1}),TU(Vo,r=>{const i=Date.now(),a=fa.getState(),o=r?Lx(r):null,c=a.lastAuthTime&&i-a.lastAuthTime<a.offlineGracePeriod,d=typeof navigator<"u"&&!navigator.onLine&&a.isAuthenticated&&c&&!o,h=r?r.emailVerified:!0,p=r&&h||!!d,m=r?o:d?a.currentUser:null;n({currentUser:m,isAuthenticated:p,isInitialized:!0,isLoading:!1,loginError:null,lastAuthTime:r&&h?i:a.lastAuthTime}),m?console.log(` Auth state: User is signed in (${m.email})`,d?"(offline grace period)":h?"(verified)":"(unverified)"):console.log(" Auth state: User is signed out")}))}),{name:"auth-storage",partialize:n=>({isAuthenticated:n.isAuthenticated,currentUser:n.currentUser,lastAuthTime:n.lastAuthTime,offlineGracePeriod:n.offlineGracePeriod,lastVerificationEmailSent:n.lastVerificationEmailSent})})),xn=Object.freeze(Object.defineProperty({__proto__:null,useAuthStore:fa},Symbol.toStringTag,{value:"Module"})),LO=[{id:"length",label:"Minimum 12 characters",regex:/^.{12,}$/},{id:"uppercase",label:"At least one uppercase letter (A-Z)",regex:/[A-Z]/},{id:"lowercase",label:"At least one lowercase letter (a-z)",regex:/[a-z]/},{id:"number",label:"At least one number (0-9)",regex:/\d/},{id:"special",label:"At least one special character (!@#$%^&*)",regex:/[!@#$%^&*]/}],xH=n=>{if(!n)return{score:0,level:"weak",color:"text-gray-400",label:"Enter password"};const r=LO.map(c=>({...c,met:c.regex.test(n)})).filter(c=>c.met).length;let i,a,o;return r<=1?(i="weak",a="text-red-500",o="Weak"):r<=3?(i="medium",a="text-yellow-500",o="Medium"):r===4?(i="strong",a="text-blue-500",o="Strong"):(i="very-strong",a="text-green-500",o="Very Strong"),{score:r,level:i,color:a,label:o}},bE=n=>{const e=LO.map(i=>({...i,met:i.regex.test(n)})),t=xH(n),r=e.every(i=>i.met);return{requirements:e,strength:t,isValid:r,isEmpty:!n.trim()}},_H=({password:n,className:e=""})=>{const{strength:t,isEmpty:r}=bE(n);return r?null:v.jsxs("div",{className:`flex items-center gap-2 ${e}`,children:[v.jsx("div",{className:"flex-1",children:v.jsx("div",{className:"flex gap-1",children:[1,2,3,4].map(i=>v.jsx("div",{className:`h-1 flex-1 rounded-full ${i<=t.score?t.score<=1?"bg-red-500":t.score<=3?"bg-yellow-500":t.score===4?"bg-blue-500":"bg-green-500":"bg-gray-200 dark:bg-gray-700"}`},i))})}),v.jsx("span",{className:`text-sm font-medium ${t.color}`,children:t.label})]})},wH=({password:n,className:e=""})=>{const{requirements:t,isEmpty:r}=bE(n);return r?null:v.jsx("div",{className:`space-y-1 ${e}`,children:t.map(i=>v.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.met?v.jsx(EL,{className:"h-4 w-4 text-green-500 flex-shrink-0"}):v.jsx(Ev,{className:"h-4 w-4 text-red-500 flex-shrink-0"}),v.jsx("span",{className:i.met?"text-green-700 dark:text-green-300":"text-gray-600 dark:text-gray-400",children:i.label})]},i.id))})},EH=()=>{const[n,e]=U.useState(""),[t,r]=U.useState(""),[i,a]=U.useState(""),[o,c]=U.useState(!1),[u,d]=U.useState(!1),[h,p]=U.useState(!1),[m,b]=U.useState(!1),{login:_,register:w,sendPasswordReset:S,isLoading:T,loginError:A,clearError:D}=fa(),O=bE(t),M=async C=>{if(C.preventDefault(),D(),n.trim()&&t.trim())if(u){if(!i.trim()||!O.isValid)return;await w(n.trim(),t,i.trim())}else await _(n.trim(),t)},j=async C=>{C.preventDefault(),n.trim()&&await S(n.trim())&&b(!0)};return U.useEffect(()=>{e(""),r(""),a(""),b(!1)},[u,h]),v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsxs("div",{className:"flex flex-col items-center gap-3 mb-2",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"Personal Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"Personal Budget"})]}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Simple envelope budgeting for personal finance"})]})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:h?v.jsxs("form",{onSubmit:j,className:"space-y-6",children:[v.jsxs("div",{className:"text-center mb-2",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Reset Password"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Enter your email and we'll send you a link to reset your password."})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"reset-email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(T1,{className:"h-5 w-5 text-gray-400"})}),v.jsx("input",{id:"reset-email",type:"email",value:n,onChange:C=>e(C.target.value),className:"w-full pl-10 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"email"})]})]}),m?v.jsxs("div",{className:"text-center py-4",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 dark:bg-green-900/30",children:v.jsx(T1,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),v.jsx("h3",{className:"mt-3 text-lg font-medium text-gray-900 dark:text-white",children:"Check your email"}),v.jsxs("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:["We've sent a password reset link to ",v.jsx("span",{className:"font-medium",children:n})]}),v.jsxs("button",{type:"button",onClick:()=>p(!1),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[v.jsx(od,{className:"-ml-1 mr-2 h-4 w-4"}),"Back to login"]})]}):v.jsxs(v.Fragment,{children:[v.jsx("button",{type:"submit",disabled:T||!n.trim(),className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?"Sending...":"Send Reset Link"}),v.jsx("div",{className:"mt-4 text-center",children:v.jsxs("button",{type:"button",onClick:()=>p(!1),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:[v.jsx(od,{className:"inline-block h-4 w-4 -ml-1 mr-1"}),"Back to login"]})})]})]}):v.jsxs("form",{onSubmit:M,className:"space-y-6",children:[v.jsxs("div",{className:"text-center mb-6",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:u?"Create Account":"Sign In"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:u?"Create a new account to get started":"Sign in to your account"})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),v.jsx("input",{id:"email",type:"email",value:n,onChange:C=>e(C.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"username"})]}),u&&v.jsxs("div",{children:[v.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Display Name"}),v.jsx("input",{id:"displayName",type:"text",value:i,onChange:C=>a(C.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your display name",required:!0,disabled:T})]}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"}),!u&&v.jsx("button",{type:"button",onClick:()=>p(!0),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:"Forgot password?"})]}),v.jsxs("div",{className:"relative",children:[v.jsx("input",{id:"password",type:o?"text":"password",value:t,onChange:C=>r(C.target.value),className:`w-full px-3 py-2 pr-10 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white ${u&&t&&!O.isValid?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"Enter your password",required:!0,disabled:T,autoComplete:u?"new-password":"current-password"}),v.jsx("button",{type:"button",onClick:()=>c(!o),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none",disabled:T,children:o?v.jsx(zL,{className:"h-5 w-5"}):v.jsx(BL,{className:"h-5 w-5"})})]}),u&&t&&v.jsx("div",{className:"mt-2",children:v.jsx(_H,{password:t})}),u&&t&&v.jsx("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-md",children:v.jsx(wH,{password:t})})]}),A&&v.jsxs("div",{className:"text-red-600 dark:text-red-400 text-sm text-center bg-red-50 dark:bg-red-900/20 p-3 rounded-md",children:[A,A.includes("verify your email")&&v.jsx("div",{className:"mt-3",children:v.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Please check your email and click the verification link to continue."})})]}),v.jsx("button",{type:"submit",disabled:T||!n.trim()||!t.trim()||u&&!i.trim()||u&&!O.isValid,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?u?"Creating Account...":"Signing in...":u?"Create Account":"Sign In"}),v.jsx("div",{className:"mt-6 text-center",children:v.jsxs("button",{type:"button",onClick:()=>{d(!u),p(!1)},className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",disabled:T,children:[v.jsx(C9,{className:"h-4 w-4"}),u?"Already have an account? Sign In":"Don't have an account? Sign Up"]})})]})})]})})},BO=()=>{const[n,e]=U.useState(!1),[t,r]=U.useState(!1),{currentUser:i,resendEmailVerification:a,logout:o,loginError:c}=fa();U.useEffect(()=>{i||console.warn("EmailVerificationView: No current user, this should not happen")},[i]);const u=async()=>{e(!0),r(!1);const h=await a();e(!1),h&&(r(!0),setTimeout(()=>r(!1),3e3))},d=async()=>{await o()};return i?v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsx("div",{className:"flex flex-col items-center gap-3 mb-2",children:v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"House Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"House Budget"})]})})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/30 mb-4",children:v.jsx(T1,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Check your email"}),v.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["We've sent a verification link to"," ",v.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:i.email})]}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 mb-6",children:v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(S1,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),v.jsxs("div",{className:"text-left",children:[v.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium",children:"What to do next:"}),v.jsxs("ol",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1 space-y-1",children:[v.jsx("li",{children:"1. Open your email inbox"}),v.jsx("li",{children:"2. Find the email from House Budget"}),v.jsx("li",{children:'3. Click the "Verify Email" link'}),v.jsx("li",{children:"4. Return here and sign in"})]})]})]})}),c&&v.jsx("div",{className:"text-red-600 dark:text-red-400 text-sm mb-4 p-3 bg-red-50 dark:bg-red-900/20 rounded-md",children:c}),t&&v.jsx("div",{className:"text-green-600 dark:text-green-400 text-sm mb-4 p-3 bg-green-50 dark:bg-green-900/20 rounded-md",children:"Verification email sent successfully!"}),v.jsx("button",{onClick:u,disabled:n,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed mb-4 flex items-center justify-center gap-2",children:n?v.jsxs(v.Fragment,{children:[v.jsx(Lh,{className:"h-4 w-4 animate-spin"}),"Sending..."]}):v.jsxs(v.Fragment,{children:[v.jsx(Lh,{className:"h-4 w-4"}),"Resend verification email"]})}),v.jsxs("button",{onClick:d,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",children:[v.jsx(od,{className:"h-4 w-4"}),"Back to sign in"]})]})}),v.jsx("div",{className:"text-center",children:v.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Didn't receive the email? Check your spam folder or try resending."})})]})}):null},UO=({message:n="Loading your budget...",showTimeout:e=!1})=>v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex flex-col items-center justify-center px-4",children:[v.jsx("div",{className:"mb-8",children:v.jsxs("div",{className:"relative",children:[v.jsx(Lh,{size:48,className:"text-blue-500 animate-spin"}),v.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:v.jsx(wv,{size:24,className:"text-blue-600 dark:text-blue-400"})})]})}),v.jsxs("div",{className:"text-center space-y-3",children:[v.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400 max-w-md",children:"This may take a moment on slow connections. We're fetching your budget data securely."})]}),v.jsxs("div",{className:"mt-12 w-full max-w-md space-y-4",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("div",{className:"h-6 bg-gray-200 dark:bg-zinc-700 rounded w-24 animate-pulse"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]})]})}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsx("div",{className:"h-4 bg-gray-200 dark:bg-zinc-700 rounded w-32 mb-2 animate-pulse"}),v.jsx("div",{className:"h-8 bg-gray-200 dark:bg-zinc-700 rounded w-20 animate-pulse"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-28 animate-pulse"}),v.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-32 animate-pulse"}),v.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]})]}),e&&v.jsx("div",{className:"mt-8 p-4 bg-amber-50 dark:bg-amber-900/20 rounded-xl border border-amber-200 dark:border-amber-800 max-w-md",children:v.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200 text-center",children:"This is taking longer than usual. If you're on a very slow connection, this is normal. Your data will load shortly."})}),v.jsx("div",{className:"mt-8 w-full max-w-md",children:v.jsx("div",{className:"h-1 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:v.jsx("div",{className:"h-full bg-blue-500 rounded-full animate-pulse",style:{width:"60%"}})})})]}),xE=U.createContext({});function Qv(n){const e=U.useRef(null);return e.current===null&&(e.current=n()),e.current}const _E=typeof window<"u",wE=_E?U.useLayoutEffect:U.useEffect,Zv=U.createContext(null);function EE(n,e){n.indexOf(e)===-1&&n.push(e)}function SE(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const qs=(n,e,t)=>t>e?e:t<n?n:t;let TE=()=>{};const Hs={},FO=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function GO(n){return typeof n=="object"&&n!==null}const qO=n=>/^0[^.\s]+$/u.test(n);function AE(n){let e;return()=>(e===void 0&&(e=n()),e)}const $i=n=>n,SH=(n,e)=>t=>e(n(t)),Fp=(...n)=>n.reduce(SH),ip=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r};class CE{constructor(){this.subscriptions=[]}add(e){return EE(this.subscriptions,e),()=>SE(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let a=0;a<i;a++){const o=this.subscriptions[a];o&&o(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Ja=n=>n*1e3,qi=n=>n/1e3;function HO(n,e){return e?n*(1e3/e):0}const $O=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,TH=1e-7,AH=12;function CH(n,e,t,r,i){let a,o,c=0;do o=e+(t-e)/2,a=$O(o,r,i)-n,a>0?t=o:e=o;while(Math.abs(a)>TH&&++c<AH);return o}function Gp(n,e,t,r){if(n===e&&t===r)return $i;const i=a=>CH(a,0,1,n,t);return a=>a===0||a===1?a:$O(i(a),e,r)}const YO=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,KO=n=>e=>1-n(1-e),XO=Gp(.33,1.53,.69,.99),IE=KO(XO),WO=YO(IE),QO=n=>(n*=2)<1?.5*IE(n):.5*(2-Math.pow(2,-10*(n-1))),RE=n=>1-Math.sin(Math.acos(n)),ZO=KO(RE),JO=YO(RE),IH=Gp(.42,0,1,1),RH=Gp(0,0,.58,1),e4=Gp(.42,0,.58,1),DH=n=>Array.isArray(n)&&typeof n[0]!="number",t4=n=>Array.isArray(n)&&typeof n[0]=="number",kH={linear:$i,easeIn:IH,easeInOut:e4,easeOut:RH,circIn:RE,circInOut:JO,circOut:ZO,backIn:IE,backInOut:WO,backOut:XO,anticipate:QO},NH=n=>typeof n=="string",jR=n=>{if(t4(n)){TE(n.length===4);const[e,t,r,i]=n;return Gp(e,t,r,i)}else if(NH(n))return kH[n];return n},Pm=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function MH(n,e){let t=new Set,r=new Set,i=!1,a=!1;const o=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function u(h){o.has(h)&&(d.schedule(h),n()),h(c)}const d={schedule:(h,p=!1,m=!1)=>{const _=m&&i?t:r;return p&&o.add(h),_.has(h)||_.add(h),h},cancel:h=>{r.delete(h),o.delete(h)},process:h=>{if(c=h,i){a=!0;return}i=!0,[t,r]=[r,t],t.forEach(u),t.clear(),i=!1,a&&(a=!1,d.process(h))}};return d}const PH=40;function n4(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},a=()=>t=!0,o=Pm.reduce((D,O)=>(D[O]=MH(a),D),{}),{setup:c,read:u,resolveKeyframes:d,preUpdate:h,update:p,preRender:m,render:b,postRender:_}=o,w=()=>{const D=Hs.useManualTiming?i.timestamp:performance.now();t=!1,Hs.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(D-i.timestamp,PH),1)),i.timestamp=D,i.isProcessing=!0,c.process(i),u.process(i),d.process(i),h.process(i),p.process(i),m.process(i),b.process(i),_.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(w))},S=()=>{t=!0,r=!0,i.isProcessing||n(w)};return{schedule:Pm.reduce((D,O)=>{const M=o[O];return D[O]=(j,C=!1,I=!1)=>(t||S(),M.schedule(j,C,I)),D},{}),cancel:D=>{for(let O=0;O<Pm.length;O++)o[Pm[O]].cancel(D)},state:i,steps:o}}const{schedule:wn,cancel:cl,state:Sr,steps:Bx}=n4(typeof requestAnimationFrame<"u"?requestAnimationFrame:$i,!0);let m0;function OH(){m0=void 0}const ii={now:()=>(m0===void 0&&ii.set(Sr.isProcessing||Hs.useManualTiming?Sr.timestamp:performance.now()),m0),set:n=>{m0=n,queueMicrotask(OH)}},r4=n=>e=>typeof e=="string"&&e.startsWith(n),DE=r4("--"),jH=r4("var(--"),kE=n=>jH(n)?VH.test(n.split("/*")[0].trim()):!1,VH=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Fd={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},ap={...Fd,transform:n=>qs(0,1,n)},Om={...Fd,default:1},Ch=n=>Math.round(n*1e5)/1e5,NE=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function zH(n){return n==null}const LH=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,ME=(n,e)=>t=>!!(typeof t=="string"&&LH.test(t)&&t.startsWith(n)||e&&!zH(t)&&Object.prototype.hasOwnProperty.call(t,e)),i4=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,a,o,c]=r.match(NE);return{[n]:parseFloat(i),[e]:parseFloat(a),[t]:parseFloat(o),alpha:c!==void 0?parseFloat(c):1}},BH=n=>qs(0,255,n),Ux={...Fd,transform:n=>Math.round(BH(n))},cc={test:ME("rgb","red"),parse:i4("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+Ux.transform(n)+", "+Ux.transform(e)+", "+Ux.transform(t)+", "+Ch(ap.transform(r))+")"};function UH(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const o_={test:ME("#"),parse:UH,transform:cc.transform},qp=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Bo=qp("deg"),es=qp("%"),tt=qp("px"),FH=qp("vh"),GH=qp("vw"),VR={...es,parse:n=>es.parse(n)/100,transform:n=>es.transform(n*100)},Gu={test:ME("hsl","hue"),parse:i4("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+es.transform(Ch(e))+", "+es.transform(Ch(t))+", "+Ch(ap.transform(r))+")"},Zn={test:n=>cc.test(n)||o_.test(n)||Gu.test(n),parse:n=>cc.test(n)?cc.parse(n):Gu.test(n)?Gu.parse(n):o_.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?cc.transform(n):Gu.transform(n),getAnimatableNone:n=>{const e=Zn.parse(n);return e.alpha=0,Zn.transform(e)}},qH=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function HH(n){return isNaN(n)&&typeof n=="string"&&(n.match(NE)?.length||0)+(n.match(qH)?.length||0)>0}const a4="number",s4="color",$H="var",YH="var(",zR="${}",KH=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function sp(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let a=0;const c=e.replace(KH,u=>(Zn.test(u)?(r.color.push(a),i.push(s4),t.push(Zn.parse(u))):u.startsWith(YH)?(r.var.push(a),i.push($H),t.push(u)):(r.number.push(a),i.push(a4),t.push(parseFloat(u))),++a,zR)).split(zR);return{values:t,split:c,indexes:r,types:i}}function o4(n){return sp(n).values}function l4(n){const{split:e,types:t}=sp(n),r=e.length;return i=>{let a="";for(let o=0;o<r;o++)if(a+=e[o],i[o]!==void 0){const c=t[o];c===a4?a+=Ch(i[o]):c===s4?a+=Zn.transform(i[o]):a+=i[o]}return a}}const XH=n=>typeof n=="number"?0:Zn.test(n)?Zn.getAnimatableNone(n):n;function WH(n){const e=o4(n);return l4(n)(e.map(XH))}const ul={test:HH,parse:o4,createTransformer:l4,getAnimatableNone:WH};function Fx(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function QH({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,a=0,o=0;if(!e)i=a=o=t;else{const c=t<.5?t*(1+e):t+e-t*e,u=2*t-c;i=Fx(u,c,n+1/3),a=Fx(u,c,n),o=Fx(u,c,n-1/3)}return{red:Math.round(i*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:r}}function J0(n,e){return t=>t>0?e:n}const Cn=(n,e,t)=>n+(e-n)*t,Gx=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},ZH=[o_,cc,Gu],JH=n=>ZH.find(e=>e.test(n));function LR(n){const e=JH(n);if(!e)return!1;let t=e.parse(n);return e===Gu&&(t=QH(t)),t}const BR=(n,e)=>{const t=LR(n),r=LR(e);if(!t||!r)return J0(n,e);const i={...t};return a=>(i.red=Gx(t.red,r.red,a),i.green=Gx(t.green,r.green,a),i.blue=Gx(t.blue,r.blue,a),i.alpha=Cn(t.alpha,r.alpha,a),cc.transform(i))},l_=new Set(["none","hidden"]);function e$(n,e){return l_.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function t$(n,e){return t=>Cn(n,e,t)}function PE(n){return typeof n=="number"?t$:typeof n=="string"?kE(n)?J0:Zn.test(n)?BR:i$:Array.isArray(n)?c4:typeof n=="object"?Zn.test(n)?BR:n$:J0}function c4(n,e){const t=[...n],r=t.length,i=n.map((a,o)=>PE(a)(a,e[o]));return a=>{for(let o=0;o<r;o++)t[o]=i[o](a);return t}}function n$(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=PE(n[i])(n[i],e[i]));return i=>{for(const a in r)t[a]=r[a](i);return t}}function r$(n,e){const t=[],r={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const a=e.types[i],o=n.indexes[a][r[a]],c=n.values[o]??0;t[i]=c,r[a]++}return t}const i$=(n,e)=>{const t=ul.createTransformer(e),r=sp(n),i=sp(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?l_.has(n)&&!i.values.length||l_.has(e)&&!r.values.length?e$(n,e):Fp(c4(r$(r,i),i.values),t):J0(n,e)};function u4(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Cn(n,e,t):PE(n)(n,e)}const a$=n=>{const e=({timestamp:t})=>n(t);return{start:(t=!0)=>wn.update(e,t),stop:()=>cl(e),now:()=>Sr.isProcessing?Sr.timestamp:ii.now()}},d4=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let a=0;a<i;a++)r+=Math.round(n(a/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},ev=2e4;function OE(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<ev;)e+=t,r=n.next(e);return e>=ev?1/0:e}function s$(n,e=100,t){const r=t({...n,keyframes:[0,e]}),i=Math.min(OE(r),ev);return{type:"keyframes",ease:a=>r.next(i*a).value/e,duration:qi(i)}}const o$=5;function f4(n,e,t){const r=Math.max(e-o$,0);return HO(t-n(r),e-r)}const kn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},qx=.001;function l$({duration:n=kn.duration,bounce:e=kn.bounce,velocity:t=kn.velocity,mass:r=kn.mass}){let i,a,o=1-e;o=qs(kn.minDamping,kn.maxDamping,o),n=qs(kn.minDuration,kn.maxDuration,qi(n)),o<1?(i=d=>{const h=d*o,p=h*n,m=h-t,b=c_(d,o),_=Math.exp(-p);return qx-m/b*_},a=d=>{const p=d*o*n,m=p*t+t,b=Math.pow(o,2)*Math.pow(d,2)*n,_=Math.exp(-p),w=c_(Math.pow(d,2),o);return(-i(d)+qx>0?-1:1)*((m-b)*_)/w}):(i=d=>{const h=Math.exp(-d*n),p=(d-t)*n+1;return-qx+h*p},a=d=>{const h=Math.exp(-d*n),p=(t-d)*(n*n);return h*p});const c=5/n,u=u$(i,a,c);if(n=Ja(n),isNaN(u))return{stiffness:kn.stiffness,damping:kn.damping,duration:n};{const d=Math.pow(u,2)*r;return{stiffness:d,damping:o*2*Math.sqrt(r*d),duration:n}}}const c$=12;function u$(n,e,t){let r=t;for(let i=1;i<c$;i++)r=r-n(r)/e(r);return r}function c_(n,e){return n*Math.sqrt(1-e*e)}const d$=["duration","bounce"],f$=["stiffness","damping","mass"];function UR(n,e){return e.some(t=>n[t]!==void 0)}function h$(n){let e={velocity:kn.velocity,stiffness:kn.stiffness,damping:kn.damping,mass:kn.mass,isResolvedFromDuration:!1,...n};if(!UR(n,f$)&&UR(n,d$))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,a=2*qs(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:kn.mass,stiffness:i,damping:a}}else{const t=l$(n);e={...e,...t,mass:kn.mass},e.isResolvedFromDuration=!0}return e}function tv(n=kn.visualDuration,e=kn.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const a=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],c={done:!1,value:a},{stiffness:u,damping:d,mass:h,duration:p,velocity:m,isResolvedFromDuration:b}=h$({...t,velocity:-qi(t.velocity||0)}),_=m||0,w=d/(2*Math.sqrt(u*h)),S=o-a,T=qi(Math.sqrt(u/h)),A=Math.abs(S)<5;r||(r=A?kn.restSpeed.granular:kn.restSpeed.default),i||(i=A?kn.restDelta.granular:kn.restDelta.default);let D;if(w<1){const M=c_(T,w);D=j=>{const C=Math.exp(-w*T*j);return o-C*((_+w*T*S)/M*Math.sin(M*j)+S*Math.cos(M*j))}}else if(w===1)D=M=>o-Math.exp(-T*M)*(S+(_+T*S)*M);else{const M=T*Math.sqrt(w*w-1);D=j=>{const C=Math.exp(-w*T*j),I=Math.min(M*j,300);return o-C*((_+w*T*S)*Math.sinh(I)+M*S*Math.cosh(I))/M}}const O={calculatedDuration:b&&p||null,next:M=>{const j=D(M);if(b)c.done=M>=p;else{let C=M===0?_:0;w<1&&(C=M===0?Ja(_):f4(D,M,j));const I=Math.abs(C)<=r,k=Math.abs(o-j)<=i;c.done=I&&k}return c.value=c.done?o:j,c},toString:()=>{const M=Math.min(OE(O),ev),j=d4(C=>O.next(M*C).value,M,30);return M+"ms "+j},toTransition:()=>{}};return O}tv.applyToOptions=n=>{const e=s$(n,100,tv);return n.ease=e.ease,n.duration=Ja(e.duration),n.type="keyframes",n};function u_({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:a=500,modifyTarget:o,min:c,max:u,restDelta:d=.5,restSpeed:h}){const p=n[0],m={done:!1,value:p},b=I=>c!==void 0&&I<c||u!==void 0&&I>u,_=I=>c===void 0?u:u===void 0||Math.abs(c-I)<Math.abs(u-I)?c:u;let w=t*e;const S=p+w,T=o===void 0?S:o(S);T!==S&&(w=T-p);const A=I=>-w*Math.exp(-I/r),D=I=>T+A(I),O=I=>{const k=A(I),z=D(I);m.done=Math.abs(k)<=d,m.value=m.done?T:z};let M,j;const C=I=>{b(m.value)&&(M=I,j=tv({keyframes:[m.value,_(m.value)],velocity:f4(D,I,m.value),damping:i,stiffness:a,restDelta:d,restSpeed:h}))};return C(0),{calculatedDuration:null,next:I=>{let k=!1;return!j&&M===void 0&&(k=!0,O(I),C(I)),M!==void 0&&I>=M?j.next(I-M):(!k&&O(I),m)}}}function p$(n,e,t){const r=[],i=t||Hs.mix||u4,a=n.length-1;for(let o=0;o<a;o++){let c=i(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||$i:e;c=Fp(u,c)}r.push(c)}return r}function g$(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const a=n.length;if(TE(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[a-1]&&(n=[...n].reverse(),e=[...e].reverse());const c=p$(e,r,i),u=c.length,d=h=>{if(o&&h<n[0])return e[0];let p=0;if(u>1)for(;p<n.length-2&&!(h<n[p+1]);p++);const m=ip(n[p],n[p+1],h);return c[p](m)};return t?h=>d(qs(n[0],n[a-1],h)):d}function m$(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=ip(0,e,r);n.push(Cn(t,1,i))}}function v$(n){const e=[0];return m$(e,n.length-1),e}function y$(n,e){return n.map(t=>t*e)}function b$(n,e){return n.map(()=>e||e4).splice(0,n.length-1)}function Ih({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=DH(r)?r.map(jR):jR(r),a={done:!1,value:e[0]},o=y$(t&&t.length===e.length?t:v$(e),n),c=g$(o,e,{ease:Array.isArray(i)?i:b$(e,i)});return{calculatedDuration:n,next:u=>(a.value=c(u),a.done=u>=n,a)}}const x$=n=>n!==null;function jE(n,{repeat:e,repeatType:t="loop"},r,i=1){const a=n.filter(x$),c=i<0||e&&t!=="loop"&&e%2===1?0:a.length-1;return!c||r===void 0?a[c]:r}const _$={decay:u_,inertia:u_,tween:Ih,keyframes:Ih,spring:tv};function h4(n){typeof n.type=="string"&&(n.type=_$[n.type])}class VE{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const w$=n=>n/100;class zE extends VE{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:t}=this.options;t&&t.updatedAt!==ii.now()&&this.tick(ii.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;h4(e);const{type:t=Ih,repeat:r=0,repeatDelay:i=0,repeatType:a,velocity:o=0}=e;let{keyframes:c}=e;const u=t||Ih;u!==Ih&&typeof c[0]!="number"&&(this.mixKeyframes=Fp(w$,u4(c[0],c[1])),c=[0,100]);const d=u({...e,keyframes:c});a==="mirror"&&(this.mirroredGenerator=u({...e,keyframes:[...c].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=OE(d));const{calculatedDuration:h}=d;this.calculatedDuration=h,this.resolvedDuration=h+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=d}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:r,totalDuration:i,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:c,calculatedDuration:u}=this;if(this.startTime===null)return r.next(0);const{delay:d=0,keyframes:h,repeat:p,repeatType:m,repeatDelay:b,type:_,onUpdate:w,finalKeyframe:S}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const T=this.currentTime-d*(this.playbackSpeed>=0?1:-1),A=this.playbackSpeed>=0?T<0:T>i;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let D=this.currentTime,O=r;if(p){const I=Math.min(this.currentTime,i)/c;let k=Math.floor(I),z=I%1;!z&&I>=1&&(z=1),z===1&&k--,k=Math.min(k,p+1),!!(k%2)&&(m==="reverse"?(z=1-z,b&&(z-=b/c)):m==="mirror"&&(O=o)),D=qs(0,1,z)*c}const M=A?{done:!1,value:h[0]}:O.next(D);a&&(M.value=a(M.value));let{done:j}=M;!A&&u!==null&&(j=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const C=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&j);return C&&_!==u_&&(M.value=jE(h,this.options,S,this.speed)),w&&w(M.value),C&&this.finish(),M}then(e,t){return this.finished.then(e,t)}get duration(){return qi(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+qi(e)}get time(){return qi(this.currentTime)}set time(e){e=Ja(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(ii.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=qi(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=a$,startTime:t}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=t??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ii.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function E$(n){for(let e=1;e<n.length;e++)n[e]??(n[e]=n[e-1])}const uc=n=>n*180/Math.PI,d_=n=>{const e=uc(Math.atan2(n[1],n[0]));return f_(e)},S$={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:d_,rotateZ:d_,skewX:n=>uc(Math.atan(n[1])),skewY:n=>uc(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},f_=n=>(n=n%360,n<0&&(n+=360),n),FR=d_,GR=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),qR=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),T$={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:GR,scaleY:qR,scale:n=>(GR(n)+qR(n))/2,rotateX:n=>f_(uc(Math.atan2(n[6],n[5]))),rotateY:n=>f_(uc(Math.atan2(-n[2],n[0]))),rotateZ:FR,rotate:FR,skewX:n=>uc(Math.atan(n[4])),skewY:n=>uc(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function h_(n){return n.includes("scale")?1:0}function p_(n,e){if(!n||n==="none")return h_(e);const t=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(t)r=T$,i=t;else{const c=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=S$,i=c}if(!i)return h_(e);const a=r[e],o=i[1].split(",").map(C$);return typeof a=="function"?a(o):o[a]}const A$=(n,e)=>{const{transform:t="none"}=getComputedStyle(n);return p_(t,e)};function C$(n){return parseFloat(n.trim())}const Gd=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],qd=new Set(Gd),HR=n=>n===Fd||n===tt,I$=new Set(["x","y","z"]),R$=Gd.filter(n=>!I$.has(n));function D$(n){const e=[];return R$.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const bc={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:(n,{transform:e})=>p_(e,"x"),y:(n,{transform:e})=>p_(e,"y")};bc.translateX=bc.x;bc.translateY=bc.y;const xc=new Set;let g_=!1,m_=!1,v_=!1;function p4(){if(m_){const n=Array.from(xc).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=D$(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([a,o])=>{r.getValue(a)?.set(o)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}m_=!1,g_=!1,xc.forEach(n=>n.complete(v_)),xc.clear()}function g4(){xc.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(m_=!0)})}function k$(){v_=!0,g4(),p4(),v_=!1}class LE{constructor(e,t,r,i,a,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(xc.add(this),g_||(g_=!0,wn.read(g4),wn.resolveKeyframes(p4))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;if(e[0]===null){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&t){const c=r.readValue(t,o);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}E$(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),xc.delete(this)}cancel(){this.state==="scheduled"&&(xc.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const N$=n=>n.startsWith("--");function M$(n,e,t){N$(e)?n.style.setProperty(e,t):n.style[e]=t}const P$=AE(()=>window.ScrollTimeline!==void 0),O$={};function j$(n,e){const t=AE(n);return()=>O$[e]??t()}const m4=j$(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),dh=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,$R={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:dh([0,.65,.55,1]),circOut:dh([.55,0,1,.45]),backIn:dh([.31,.01,.66,-.59]),backOut:dh([.33,1.53,.69,.99])};function v4(n,e){if(n)return typeof n=="function"?m4()?d4(n,e):"ease-out":t4(n)?dh(n):Array.isArray(n)?n.map(t=>v4(t,e)||$R.easeOut):$R[n]}function V$(n,e,t,{delay:r=0,duration:i=300,repeat:a=0,repeatType:o="loop",ease:c="easeOut",times:u}={},d=void 0){const h={[e]:t};u&&(h.offset=u);const p=v4(c,i);Array.isArray(p)&&(h.easing=p);const m={delay:r,duration:i,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};return d&&(m.pseudoElement=d),n.animate(h,m)}function y4(n){return typeof n=="function"&&"applyToOptions"in n}function z$({type:n,...e}){return y4(n)&&m4()?n.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class L$ extends VE{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:r,keyframes:i,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:c,onComplete:u}=e;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=e,TE(typeof e.type!="string");const d=z$(e);this.animation=V$(t,r,i,d,a),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const h=jE(i,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(h):M$(t,r,h),this.animation.cancel()}u?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return qi(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+qi(e)}get time(){return qi(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=Ja(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&P$()?(this.animation.timeline=e,$i):t(this)}}const b4={anticipate:QO,backInOut:WO,circInOut:JO};function B$(n){return n in b4}function U$(n){typeof n.ease=="string"&&B$(n.ease)&&(n.ease=b4[n.ease])}const YR=10;class F$ extends L${constructor(e){U$(e),h4(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:r,onComplete:i,element:a,...o}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const c=new zE({...o,autoplay:!1}),u=Ja(this.finishedTime??this.time);t.setWithVelocity(c.sample(u-YR).value,c.sample(u).value,YR),c.stop()}}const KR=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(ul.test(n)||n==="0")&&!n.startsWith("url("));function G$(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function q$(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const a=n[n.length-1],o=KR(i,e),c=KR(a,e);return!o||!c?!1:G$(n)||(t==="spring"||y4(t))&&r}function y_(n){n.duration=0,n.type="keyframes"}const H$=new Set(["opacity","clipPath","filter","transform"]),$$=AE(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Y$(n){const{motionValue:e,name:t,repeatDelay:r,repeatType:i,damping:a,type:o}=n;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:d}=e.owner.getProps();return $$()&&t&&H$.has(t)&&(t!=="transform"||!d)&&!u&&!r&&i!=="mirror"&&a!==0&&o!=="inertia"}const K$=40;class X$ extends VE{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:o="loop",keyframes:c,name:u,motionValue:d,element:h,...p}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=ii.now();const m={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:a,repeatType:o,name:u,motionValue:d,element:h,...p},b=h?.KeyframeResolver||LE;this.keyframeResolver=new b(c,(_,w,S)=>this.onKeyframesResolved(_,w,m,!S),u,d,h),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,t,r,i){this.keyframeResolver=void 0;const{name:a,type:o,velocity:c,delay:u,isHandoff:d,onUpdate:h}=r;this.resolvedAt=ii.now(),q$(e,a,o,c)||((Hs.instantAnimations||!u)&&h?.(jE(e,r,t)),e[0]=e[e.length-1],y_(r),r.repeat=0);const m={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>K$?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...r,keyframes:e},b=!d&&Y$(m)?new F$({...m,element:m.motionValue.owner.current}):new zE(m);b.finished.then(()=>this.notifyFinished()).catch($i),this.pendingTimeline&&(this.stopTimeline=b.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=b}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),k$()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const W$=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Q$(n){const e=W$.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function x4(n,e,t=1){const[r,i]=Q$(n);if(!r)return;const a=window.getComputedStyle(e).getPropertyValue(r);if(a){const o=a.trim();return FO(o)?parseFloat(o):o}return kE(i)?x4(i,e,t+1):i}function BE(n,e){return n?.[e]??n?.default??n}const _4=new Set(["width","height","top","left","right","bottom",...Gd]),Z$={test:n=>n==="auto",parse:n=>n},w4=n=>e=>e.test(n),E4=[Fd,tt,es,Bo,GH,FH,Z$],XR=n=>E4.find(w4(n));function J$(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||qO(n):!0}const eY=new Set(["brightness","contrast","saturate","opacity"]);function tY(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(NE)||[];if(!r)return n;const i=t.replace(r,"");let a=eY.has(e)?1:0;return r!==t&&(a*=100),e+"("+a+i+")"}const nY=/\b([a-z-]*)\(.*?\)/gu,b_={...ul,getAnimatableNone:n=>{const e=n.match(nY);return e?e.map(tY).join(" "):n}},WR={...Fd,transform:Math.round},rY={rotate:Bo,rotateX:Bo,rotateY:Bo,rotateZ:Bo,scale:Om,scaleX:Om,scaleY:Om,scaleZ:Om,skew:Bo,skewX:Bo,skewY:Bo,distance:tt,translateX:tt,translateY:tt,translateZ:tt,x:tt,y:tt,z:tt,perspective:tt,transformPerspective:tt,opacity:ap,originX:VR,originY:VR,originZ:tt},UE={borderWidth:tt,borderTopWidth:tt,borderRightWidth:tt,borderBottomWidth:tt,borderLeftWidth:tt,borderRadius:tt,radius:tt,borderTopLeftRadius:tt,borderTopRightRadius:tt,borderBottomRightRadius:tt,borderBottomLeftRadius:tt,width:tt,maxWidth:tt,height:tt,maxHeight:tt,top:tt,right:tt,bottom:tt,left:tt,padding:tt,paddingTop:tt,paddingRight:tt,paddingBottom:tt,paddingLeft:tt,margin:tt,marginTop:tt,marginRight:tt,marginBottom:tt,marginLeft:tt,backgroundPositionX:tt,backgroundPositionY:tt,...rY,zIndex:WR,fillOpacity:ap,strokeOpacity:ap,numOctaves:WR},iY={...UE,color:Zn,backgroundColor:Zn,outlineColor:Zn,fill:Zn,stroke:Zn,borderColor:Zn,borderTopColor:Zn,borderRightColor:Zn,borderBottomColor:Zn,borderLeftColor:Zn,filter:b_,WebkitFilter:b_},S4=n=>iY[n];function T4(n,e){let t=S4(n);return t!==b_&&(t=ul),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const aY=new Set(["auto","none","0"]);function sY(n,e,t){let r=0,i;for(;r<n.length&&!i;){const a=n[r];typeof a=="string"&&!aY.has(a)&&sp(a).values.length&&(i=n[r]),r++}if(i&&t)for(const a of e)n[a]=T4(t,i)}class oY extends LE{constructor(e,t,r,i,a){super(e,t,r,i,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let d=e[u];if(typeof d=="string"&&(d=d.trim(),kE(d))){const h=x4(d,t.current);h!==void 0&&(e[u]=h),u===e.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!_4.has(r)||e.length!==2)return;const[i,a]=e,o=XR(i),c=XR(a);if(o!==c)if(HR(o)&&HR(c))for(let u=0;u<e.length;u++){const d=e[u];typeof d=="string"&&(e[u]=parseFloat(d))}else bc[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)(e[i]===null||J$(e[i]))&&r.push(i);r.length&&sY(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=bc[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){const{element:e,name:t,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const i=e.getValue(t);i&&i.jump(this.measuredOrigin,!1);const a=r.length-1,o=r[a];r[a]=bc[t](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([c,u])=>{e.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function lY(n,e,t){if(n instanceof EventTarget)return[n];if(typeof n=="string"){let r=document;const i=t?.[n]??r.querySelectorAll(n);return i?Array.from(i):[]}return Array.from(n)}const A4=(n,e)=>e&&typeof n=="number"?e.transform(n):n;function C4(n){return GO(n)&&"offsetHeight"in n}const QR=30,cY=n=>!isNaN(parseFloat(n));class uY{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const i=ii.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=ii.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=cY(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new CE);const r=this.events[e].add(t);return e==="change"?()=>{r(),wn.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ii.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>QR)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,QR);return HO(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ed(n,e){return new uY(n,e)}const{schedule:FE}=n4(queueMicrotask,!1),oa={x:!1,y:!1};function I4(){return oa.x||oa.y}function dY(n){return n==="x"||n==="y"?oa[n]?null:(oa[n]=!0,()=>{oa[n]=!1}):oa.x||oa.y?null:(oa.x=oa.y=!0,()=>{oa.x=oa.y=!1})}function R4(n,e){const t=lY(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function ZR(n){return!(n.pointerType==="touch"||I4())}function fY(n,e,t={}){const[r,i,a]=R4(n,t),o=c=>{if(!ZR(c))return;const{target:u}=c,d=e(u,c);if(typeof d!="function"||!u)return;const h=p=>{ZR(p)&&(d(p),u.removeEventListener("pointerleave",h))};u.addEventListener("pointerleave",h,i)};return r.forEach(c=>{c.addEventListener("pointerenter",o,i)}),a}const D4=(n,e)=>e?n===e?!0:D4(n,e.parentElement):!1,GE=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,hY=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function pY(n){return hY.has(n.tagName)||n.tabIndex!==-1}const v0=new WeakSet;function JR(n){return e=>{e.key==="Enter"&&n(e)}}function Hx(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const gY=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=JR(()=>{if(v0.has(t))return;Hx(t,"down");const i=JR(()=>{Hx(t,"up")}),a=()=>Hx(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",a,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function eD(n){return GE(n)&&!I4()}function mY(n,e,t={}){const[r,i,a]=R4(n,t),o=c=>{const u=c.currentTarget;if(!eD(c))return;v0.add(u);const d=e(u,c),h=(b,_)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",m),v0.has(u)&&v0.delete(u),eD(b)&&typeof d=="function"&&d(b,{success:_})},p=b=>{h(b,u===window||u===document||t.useGlobalTarget||D4(u,b.target))},m=b=>{h(b,!1)};window.addEventListener("pointerup",p,i),window.addEventListener("pointercancel",m,i)};return r.forEach(c=>{(t.useGlobalTarget?window:c).addEventListener("pointerdown",o,i),C4(c)&&(c.addEventListener("focus",d=>gY(d,i)),!pY(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),a}function k4(n){return GO(n)&&"ownerSVGElement"in n}function vY(n){return k4(n)&&n.tagName==="svg"}const Or=n=>!!(n&&n.getVelocity),yY=[...E4,Zn,ul],bY=n=>yY.find(w4(n)),qE=U.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function tD(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function xY(...n){return e=>{let t=!1;const r=n.map(i=>{const a=tD(i,e);return!t&&typeof a=="function"&&(t=!0),a});if(t)return()=>{for(let i=0;i<r.length;i++){const a=r[i];typeof a=="function"?a():tD(n[i],null)}}}}function _Y(...n){return U.useCallback(xY(...n),n)}class wY extends U.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=t.offsetParent,i=C4(r)&&r.offsetWidth||0,a=this.props.sizeRef.current;a.height=t.offsetHeight||0,a.width=t.offsetWidth||0,a.top=t.offsetTop,a.left=t.offsetLeft,a.right=i-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function EY({children:n,isPresent:e,anchorX:t,root:r}){const i=U.useId(),a=U.useRef(null),o=U.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=U.useContext(qE),u=_Y(a,n?.ref);return U.useInsertionEffect(()=>{const{width:d,height:h,top:p,left:m,right:b}=o.current;if(e||!a.current||!d||!h)return;const _=t==="left"?`left: ${m}`:`right: ${b}`;a.current.dataset.motionPopId=i;const w=document.createElement("style");c&&(w.nonce=c);const S=r??document.head;return S.appendChild(w),w.sheet&&w.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${h}px !important;
            ${_}px !important;
            top: ${p}px !important;
          }
        `),()=>{S.contains(w)&&S.removeChild(w)}},[e]),v.jsx(wY,{isPresent:e,childRef:a,sizeRef:o,children:U.cloneElement(n,{ref:u})})}const SY=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:a,mode:o,anchorX:c,root:u})=>{const d=Qv(TY),h=U.useId();let p=!0,m=U.useMemo(()=>(p=!1,{id:h,initial:e,isPresent:t,custom:i,onExitComplete:b=>{d.set(b,!0);for(const _ of d.values())if(!_)return;r&&r()},register:b=>(d.set(b,!1),()=>d.delete(b))}),[t,d,r]);return a&&p&&(m={...m}),U.useMemo(()=>{d.forEach((b,_)=>d.set(_,!1))},[t]),U.useEffect(()=>{!t&&!d.size&&r&&r()},[t]),o==="popLayout"&&(n=v.jsx(EY,{isPresent:t,anchorX:c,root:u,children:n})),v.jsx(Zv.Provider,{value:m,children:n})};function TY(){return new Map}function N4(n=!0){const e=U.useContext(Zv);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,a=U.useId();U.useEffect(()=>{if(n)return i(a)},[n]);const o=U.useCallback(()=>n&&r&&r(a),[a,r,n]);return!t&&r?[!1,o]:[!0]}const jm=n=>n.key||"";function nD(n){const e=[];return U.Children.forEach(n,t=>{U.isValidElement(t)&&e.push(t)}),e}const ai=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:a="sync",propagate:o=!1,anchorX:c="left",root:u})=>{const[d,h]=N4(o),p=U.useMemo(()=>nD(n),[n]),m=o&&!d?[]:p.map(jm),b=U.useRef(!0),_=U.useRef(p),w=Qv(()=>new Map),[S,T]=U.useState(p),[A,D]=U.useState(p);wE(()=>{b.current=!1,_.current=p;for(let j=0;j<A.length;j++){const C=jm(A[j]);m.includes(C)?w.delete(C):w.get(C)!==!0&&w.set(C,!1)}},[A,m.length,m.join("-")]);const O=[];if(p!==S){let j=[...p];for(let C=0;C<A.length;C++){const I=A[C],k=jm(I);m.includes(k)||(j.splice(C,0,I),O.push(I))}return a==="wait"&&O.length&&(j=O),D(nD(j)),T(p),null}const{forceRender:M}=U.useContext(xE);return v.jsx(v.Fragment,{children:A.map(j=>{const C=jm(j),I=o&&!d?!1:p===A||m.includes(C),k=()=>{if(w.has(C))w.set(C,!0);else return;let z=!0;w.forEach(L=>{L||(z=!1)}),z&&(M?.(),D(_.current),o&&h?.(),r&&r())};return v.jsx(SY,{isPresent:I,initial:!b.current||t?void 0:!1,custom:e,presenceAffectsLayout:i,mode:a,root:u,onExitComplete:I?void 0:k,anchorX:c,children:j},C)})})},M4=U.createContext({strict:!1}),rD={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Sd={};for(const n in rD)Sd[n]={isEnabled:e=>rD[n].some(t=>!!e[t])};function AY(n){for(const e in n)Sd[e]={...Sd[e],...n[e]}}const CY=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function nv(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||CY.has(n)}let P4=n=>!nv(n);function IY(n){typeof n=="function"&&(P4=e=>e.startsWith("on")?!nv(e):n(e))}try{IY(require("@emotion/is-prop-valid").default)}catch{}function RY(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(P4(i)||t===!0&&nv(i)||!e&&!nv(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}const Jv=U.createContext({});function ey(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function op(n){return typeof n=="string"||Array.isArray(n)}const HE=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],$E=["initial",...HE];function ty(n){return ey(n.animate)||$E.some(e=>op(n[e]))}function O4(n){return!!(ty(n)||n.variants)}function DY(n,e){if(ty(n)){const{initial:t,animate:r}=n;return{initial:t===!1||op(t)?t:void 0,animate:op(r)?r:void 0}}return n.inherit!==!1?e:{}}function kY(n){const{initial:e,animate:t}=DY(n,U.useContext(Jv));return U.useMemo(()=>({initial:e,animate:t}),[iD(e),iD(t)])}function iD(n){return Array.isArray(n)?n.join(" "):n}const lp={};function NY(n){for(const e in n)lp[e]=n[e],DE(e)&&(lp[e].isCSSVariable=!0)}function j4(n,{layout:e,layoutId:t}){return qd.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!lp[n]||n==="opacity")}const MY={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},PY=Gd.length;function OY(n,e,t){let r="",i=!0;for(let a=0;a<PY;a++){const o=Gd[a],c=n[o];if(c===void 0)continue;let u=!0;if(typeof c=="number"?u=c===(o.startsWith("scale")?1:0):u=parseFloat(c)===0,!u||t){const d=A4(c,UE[o]);if(!u){i=!1;const h=MY[o]||o;r+=`${h}(${d}) `}t&&(e[o]=d)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function YE(n,e,t){const{style:r,vars:i,transformOrigin:a}=n;let o=!1,c=!1;for(const u in e){const d=e[u];if(qd.has(u)){o=!0;continue}else if(DE(u)){i[u]=d;continue}else{const h=A4(d,UE[u]);u.startsWith("origin")?(c=!0,a[u]=h):r[u]=h}}if(e.transform||(o||t?r.transform=OY(e,n.transform,t):r.transform&&(r.transform="none")),c){const{originX:u="50%",originY:d="50%",originZ:h=0}=a;r.transformOrigin=`${u} ${d} ${h}`}}const KE=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function V4(n,e,t){for(const r in e)!Or(e[r])&&!j4(r,t)&&(n[r]=e[r])}function jY({transformTemplate:n},e){return U.useMemo(()=>{const t=KE();return YE(t,e,n),Object.assign({},t.vars,t.style)},[e])}function VY(n,e){const t=n.style||{},r={};return V4(r,t,n),Object.assign(r,jY(n,e)),r}function zY(n,e){const t={},r=VY(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}const LY={offset:"stroke-dashoffset",array:"stroke-dasharray"},BY={offset:"strokeDashoffset",array:"strokeDasharray"};function UY(n,e,t=1,r=0,i=!0){n.pathLength=1;const a=i?LY:BY;n[a.offset]=tt.transform(-r);const o=tt.transform(e),c=tt.transform(t);n[a.array]=`${o} ${c}`}function z4(n,{attrX:e,attrY:t,attrScale:r,pathLength:i,pathSpacing:a=1,pathOffset:o=0,...c},u,d,h){if(YE(n,c,d),u){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:p,style:m}=n;p.transform&&(m.transform=p.transform,delete p.transform),(m.transform||p.transformOrigin)&&(m.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),m.transform&&(m.transformBox=h?.transformBox??"fill-box",delete p.transformBox),e!==void 0&&(p.x=e),t!==void 0&&(p.y=t),r!==void 0&&(p.scale=r),i!==void 0&&UY(p,i,a,o,!1)}const L4=()=>({...KE(),attrs:{}}),B4=n=>typeof n=="string"&&n.toLowerCase()==="svg";function FY(n,e,t,r){const i=U.useMemo(()=>{const a=L4();return z4(a,e,B4(r),n.transformTemplate,n.style),{...a.attrs,style:{...a.style}}},[e]);if(n.style){const a={};V4(a,n.style,n),i.style={...a,...i.style}}return i}const GY=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function XE(n){return typeof n!="string"||n.includes("-")?!1:!!(GY.indexOf(n)>-1||/[A-Z]/u.test(n))}function qY(n,e,t,{latestValues:r},i,a=!1){const c=(XE(n)?FY:zY)(e,r,i,n),u=RY(e,typeof n=="string",a),d=n!==U.Fragment?{...u,...c,ref:t}:{},{children:h}=e,p=U.useMemo(()=>Or(h)?h.get():h,[h]);return U.createElement(n,{...d,children:p})}function aD(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function WE(n,e,t,r){if(typeof e=="function"){const[i,a]=aD(r);e=e(t!==void 0?t:n.custom,i,a)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,a]=aD(r);e=e(t!==void 0?t:n.custom,i,a)}return e}function y0(n){return Or(n)?n.get():n}function HY({scrapeMotionValuesFromProps:n,createRenderState:e},t,r,i){return{latestValues:$Y(t,r,i,n),renderState:e()}}function $Y(n,e,t,r){const i={},a=r(n,{});for(const m in a)i[m]=y0(a[m]);let{initial:o,animate:c}=n;const u=ty(n),d=O4(n);e&&d&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),c===void 0&&(c=e.animate));let h=t?t.initial===!1:!1;h=h||o===!1;const p=h?c:o;if(p&&typeof p!="boolean"&&!ey(p)){const m=Array.isArray(p)?p:[p];for(let b=0;b<m.length;b++){const _=WE(n,m[b]);if(_){const{transitionEnd:w,transition:S,...T}=_;for(const A in T){let D=T[A];if(Array.isArray(D)){const O=h?D.length-1:0;D=D[O]}D!==null&&(i[A]=D)}for(const A in w)i[A]=w[A]}}}return i}const U4=n=>(e,t)=>{const r=U.useContext(Jv),i=U.useContext(Zv),a=()=>HY(n,e,r,i);return t?a():Qv(a)};function QE(n,e,t){const{style:r}=n,i={};for(const a in r)(Or(r[a])||e.style&&Or(e.style[a])||j4(a,n)||t?.getValue(a)?.liveStyle!==void 0)&&(i[a]=r[a]);return i}const YY=U4({scrapeMotionValuesFromProps:QE,createRenderState:KE});function F4(n,e,t){const r=QE(n,e,t);for(const i in n)if(Or(n[i])||Or(e[i])){const a=Gd.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[a]=n[i]}return r}const KY=U4({scrapeMotionValuesFromProps:F4,createRenderState:L4}),XY=Symbol.for("motionComponentSymbol");function qu(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function WY(n,e,t){return U.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):qu(t)&&(t.current=r))},[e])}const ZE=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),QY="framerAppearId",G4="data-"+ZE(QY),q4=U.createContext({});function ZY(n,e,t,r,i){const{visualElement:a}=U.useContext(Jv),o=U.useContext(M4),c=U.useContext(Zv),u=U.useContext(qE).reducedMotion,d=U.useRef(null);r=r||o.renderer,!d.current&&r&&(d.current=r(n,{visualState:e,parent:a,props:t,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const h=d.current,p=U.useContext(q4);h&&!h.projection&&i&&(h.type==="html"||h.type==="svg")&&JY(d.current,t,i,p);const m=U.useRef(!1);U.useInsertionEffect(()=>{h&&m.current&&h.update(t,c)});const b=t[G4],_=U.useRef(!!b&&!window.MotionHandoffIsComplete?.(b)&&window.MotionHasOptimisedAnimation?.(b));return wE(()=>{h&&(m.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),h.scheduleRenderMicrotask(),_.current&&h.animationState&&h.animationState.animateChanges())}),U.useEffect(()=>{h&&(!_.current&&h.animationState&&h.animationState.animateChanges(),_.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(b)}),_.current=!1),h.enteringChildren=void 0)}),h}function JY(n,e,t,r){const{layoutId:i,layout:a,drag:o,dragConstraints:c,layoutScroll:u,layoutRoot:d,layoutCrossfade:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:H4(n.parent)),n.projection.setOptions({layoutId:i,layout:a,alwaysMeasureLayout:!!o||c&&qu(c),visualElement:n,animationType:typeof a=="string"?a:"both",initialPromotionConfig:r,crossfade:h,layoutScroll:u,layoutRoot:d})}function H4(n){if(n)return n.options.allowProjection!==!1?n.projection:H4(n.parent)}function $x(n,{forwardMotionProps:e=!1}={},t,r){t&&AY(t);const i=XE(n)?KY:YY;function a(c,u){let d;const h={...U.useContext(qE),...c,layoutId:eK(c)},{isStatic:p}=h,m=kY(c),b=i(c,p);if(!p&&_E){tK();const _=nK(h);d=_.MeasureLayout,m.visualElement=ZY(n,b,h,r,_.ProjectionNode)}return v.jsxs(Jv.Provider,{value:m,children:[d&&m.visualElement?v.jsx(d,{visualElement:m.visualElement,...h}):null,qY(n,c,WY(b,m.visualElement,u),b,p,e)]})}a.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const o=U.forwardRef(a);return o[XY]=n,o}function eK({layoutId:n}){const e=U.useContext(xE).id;return e&&n!==void 0?e+"-"+n:n}function tK(n,e){U.useContext(M4).strict}function nK(n){const{drag:e,layout:t}=Sd;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function rK(n,e){if(typeof Proxy>"u")return $x;const t=new Map,r=(a,o)=>$x(a,o,n,e),i=(a,o)=>r(a,o);return new Proxy(i,{get:(a,o)=>o==="create"?r:(t.has(o)||t.set(o,$x(o,void 0,n,e)),t.get(o))})}function $4({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function iK({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function aK(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function Yx(n){return n===void 0||n===1}function x_({scale:n,scaleX:e,scaleY:t}){return!Yx(n)||!Yx(e)||!Yx(t)}function Zl(n){return x_(n)||Y4(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function Y4(n){return sD(n.x)||sD(n.y)}function sD(n){return n&&n!=="0%"}function rv(n,e,t){const r=n-t,i=e*r;return t+i}function oD(n,e,t,r,i){return i!==void 0&&(n=rv(n,i,r)),rv(n,t,r)+e}function __(n,e=0,t=1,r,i){n.min=oD(n.min,e,t,r,i),n.max=oD(n.max,e,t,r,i)}function K4(n,{x:e,y:t}){__(n.x,e.translate,e.scale,e.originPoint),__(n.y,t.translate,t.scale,t.originPoint)}const lD=.999999999999,cD=1.0000000000001;function sK(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let a,o;for(let c=0;c<i;c++){a=t[c],o=a.projectionDelta;const{visualElement:u}=a.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&a.options.layoutScroll&&a.scroll&&a!==a.root&&$u(n,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,K4(n,o)),r&&Zl(a.latestValues)&&$u(n,a.latestValues))}e.x<cD&&e.x>lD&&(e.x=1),e.y<cD&&e.y>lD&&(e.y=1)}function Hu(n,e){n.min=n.min+e,n.max=n.max+e}function uD(n,e,t,r,i=.5){const a=Cn(n.min,n.max,i);__(n,e,t,a,r)}function $u(n,e){uD(n.x,e.x,e.scaleX,e.scale,e.originX),uD(n.y,e.y,e.scaleY,e.scale,e.originY)}function X4(n,e){return $4(aK(n.getBoundingClientRect(),e))}function oK(n,e,t){const r=X4(n,t),{scroll:i}=e;return i&&(Hu(r.x,i.offset.x),Hu(r.y,i.offset.y)),r}const dD=()=>({translate:0,scale:1,origin:0,originPoint:0}),Yu=()=>({x:dD(),y:dD()}),fD=()=>({min:0,max:0}),Un=()=>({x:fD(),y:fD()}),w_={current:null},W4={current:!1};function lK(){if(W4.current=!0,!!_E)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>w_.current=n.matches;n.addEventListener("change",e),e()}else w_.current=!1}const cK=new WeakMap;function uK(n,e,t){for(const r in e){const i=e[r],a=t[r];if(Or(i))n.addValue(r,i);else if(Or(a))n.addValue(r,Ed(i,{owner:n}));else if(a!==i)if(n.hasValue(r)){const o=n.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=n.getStaticValue(r);n.addValue(r,Ed(o!==void 0?o:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const hD=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class dK{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:a,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=LE,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=ii.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,wn.render(this.render,!1,!0))};const{latestValues:u,renderState:d}=o;this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=d,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=c,this.blockInitialAnimation=!!a,this.isControllingVariants=ty(t),this.isVariantNode=O4(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...p}=this.scrapeMotionValuesFromProps(t,{},this);for(const m in p){const b=p[m];u[m]!==void 0&&Or(b)&&b.set(u[m])}}mount(e){this.current=e,cK.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),W4.current||lK(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:w_.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),cl(this.notifyUpdate),cl(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=qd.has(e);r&&this.onBindTransform&&this.onBindTransform();const i=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&wn.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Sd){const t=Sd[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Un()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<hD.length;r++){const i=hD[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const a="on"+i,o=e[a];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=uK(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=Ed(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(FO(r)||qO(r))?r=parseFloat(r):!bY(r)&&ul.test(t)&&(r=T4(e,t)),this.setBaseTarget(e,Or(r)?r.get():r)),Or(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let r;if(typeof t=="string"||typeof t=="object"){const a=WE(this.props,t,this.presenceContext?.custom);a&&(r=a[e])}if(t&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Or(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new CE),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){FE.render(this.render)}}class Q4 extends dK{constructor(){super(...arguments),this.KeyframeResolver=oY}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Or(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function Z4(n,{style:e,vars:t},r,i){const a=n.style;let o;for(o in e)a[o]=e[o];i?.applyProjectionStyles(a,r);for(o in t)a.setProperty(o,t[o])}function fK(n){return window.getComputedStyle(n)}class hK extends Q4{constructor(){super(...arguments),this.type="html",this.renderInstance=Z4}readValueFromInstance(e,t){if(qd.has(t))return this.projection?.isProjecting?h_(t):A$(e,t);{const r=fK(e),i=(DE(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return X4(e,t)}build(e,t,r){YE(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return QE(e,t,r)}}const J4=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function pK(n,e,t,r){Z4(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(J4.has(i)?i:ZE(i),e.attrs[i])}class gK extends Q4{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Un}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(qd.has(t)){const r=S4(t);return r&&r.default||0}return t=J4.has(t)?t:ZE(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return F4(e,t,r)}build(e,t,r){z4(e,t,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,t,r,i){pK(e,t,r,i)}mount(e){this.isSVGTag=B4(e.tagName),super.mount(e)}}const mK=(n,e)=>XE(n)?new gK(e):new hK(e,{allowProjection:n!==U.Fragment});function ad(n,e,t){const r=n.getProps();return WE(r,e,t!==void 0?t:r.custom,n)}const E_=n=>Array.isArray(n);function vK(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,Ed(t))}function yK(n){return E_(n)?n[n.length-1]||0:n}function JE(n,e){const t=ad(n,e);let{transitionEnd:r={},transition:i={},...a}=t||{};a={...a,...r};for(const o in a){const c=yK(a[o]);vK(n,o,c)}}function bK(n){return!!(Or(n)&&n.add)}function S_(n,e){const t=n.getValue("willChange");if(bK(t))return t.add(e);if(!t&&Hs.WillChange){const r=new Hs.WillChange("auto");n.addValue("willChange",r),r.add(e)}}function e3(n){return n.props[G4]}const xK=n=>n!==null;function _K(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(xK),a=e&&t!=="loop"&&e%2===1?0:i.length-1;return i[a]}const wK={type:"spring",stiffness:500,damping:25,restSpeed:10},EK=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),SK={type:"keyframes",duration:.8},TK={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},AK=(n,{keyframes:e})=>e.length>2?SK:qd.has(n)?n.startsWith("scale")?EK(e[1]):wK:TK;function CK({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:a,repeatType:o,repeatDelay:c,from:u,elapsed:d,...h}){return!!Object.keys(h).length}const eS=(n,e,t,r={},i,a)=>o=>{const c=BE(r,n)||{},u=c.delay||r.delay||0;let{elapsed:d=0}=r;d=d-Ja(u);const h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...c,delay:-d,onUpdate:m=>{e.set(m),c.onUpdate&&c.onUpdate(m)},onComplete:()=>{o(),c.onComplete&&c.onComplete()},name:n,motionValue:e,element:a?void 0:i};CK(c)||Object.assign(h,AK(n,h)),h.duration&&(h.duration=Ja(h.duration)),h.repeatDelay&&(h.repeatDelay=Ja(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let p=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(y_(h),h.delay===0&&(p=!0)),(Hs.instantAnimations||Hs.skipAnimations)&&(p=!0,y_(h),h.delay=0),h.allowFlatten=!c.type&&!c.ease,p&&!a&&e.get()!==void 0){const m=_K(h.keyframes,c);if(m!==void 0){wn.update(()=>{h.onUpdate(m),h.onComplete()});return}}return c.isSync?new zE(h):new X$(h)};function IK({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function t3(n,e,{delay:t=0,transitionOverride:r,type:i}={}){let{transition:a=n.getDefaultTransition(),transitionEnd:o,...c}=e;r&&(a=r);const u=[],d=i&&n.animationState&&n.animationState.getState()[i];for(const h in c){const p=n.getValue(h,n.latestValues[h]??null),m=c[h];if(m===void 0||d&&IK(d,h))continue;const b={delay:t,...BE(a||{},h)},_=p.get();if(_!==void 0&&!p.isAnimating&&!Array.isArray(m)&&m===_&&!b.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const T=e3(n);if(T){const A=window.MotionHandoffAnimation(T,h,wn);A!==null&&(b.startTime=A,w=!0)}}S_(n,h),p.start(eS(h,p,m,n.shouldReduceMotion&&_4.has(h)?{type:!1}:b,n,w));const S=p.animation;S&&u.push(S)}return o&&Promise.all(u).then(()=>{wn.update(()=>{o&&JE(n,o)})}),u}function n3(n,e,t,r=0,i=1){const a=Array.from(n).sort((d,h)=>d.sortNodePosition(h)).indexOf(e),o=n.size,c=(o-1)*r;return typeof t=="function"?t(a,o):i===1?a*r:c-a*r}function T_(n,e,t={}){const r=ad(n,e,t.type==="exit"?n.presenceContext?.custom:void 0);let{transition:i=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(i=t.transitionOverride);const a=r?()=>Promise.all(t3(n,r,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:h,staggerDirection:p}=i;return RK(n,e,u,d,h,p,t)}:()=>Promise.resolve(),{when:c}=i;if(c){const[u,d]=c==="beforeChildren"?[a,o]:[o,a];return u().then(()=>d())}else return Promise.all([a(),o(t.delay)])}function RK(n,e,t=0,r=0,i=0,a=1,o){const c=[];for(const u of n.variantChildren)u.notify("AnimationStart",e),c.push(T_(u,e,{...o,delay:t+(typeof r=="function"?0:r)+n3(n.variantChildren,u,r,i,a)}).then(()=>u.notify("AnimationComplete",e)));return Promise.all(c)}function r3(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(a=>T_(n,a,t));r=Promise.all(i)}else if(typeof e=="string")r=T_(n,e,t);else{const i=typeof e=="function"?ad(n,e,t.custom):e;r=Promise.all(t3(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}function i3(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}const DK=$E.length;function a3(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?a3(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<DK;t++){const r=$E[t],i=n.props[r];(op(i)||i===!1)&&(e[r]=i)}return e}const kK=[...HE].reverse(),NK=HE.length;function MK(n){return e=>Promise.all(e.map(({animation:t,options:r})=>r3(n,t,r)))}function PK(n){let e=MK(n),t=pD(),r=!0;const i=u=>(d,h)=>{const p=ad(n,h,u==="exit"?n.presenceContext?.custom:void 0);if(p){const{transition:m,transitionEnd:b,..._}=p;d={...d,..._,...b}}return d};function a(u){e=u(n)}function o(u){const{props:d}=n,h=a3(n.parent)||{},p=[],m=new Set;let b={},_=1/0;for(let S=0;S<NK;S++){const T=kK[S],A=t[T],D=d[T]!==void 0?d[T]:h[T],O=op(D),M=T===u?A.isActive:null;M===!1&&(_=S);let j=D===h[T]&&D!==d[T]&&O;if(j&&r&&n.manuallyAnimateOnMount&&(j=!1),A.protectedKeys={...b},!A.isActive&&M===null||!D&&!A.prevProp||ey(D)||typeof D=="boolean")continue;const C=OK(A.prevProp,D);let I=C||T===u&&A.isActive&&!j&&O||S>_&&O,k=!1;const z=Array.isArray(D)?D:[D];let L=z.reduce(i(T),{});M===!1&&(L={});const{prevResolvedValues:B={}}=A,P={...B,...L},J=W=>{I=!0,m.has(W)&&(k=!0,m.delete(W)),A.needsAnimating[W]=!0;const K=n.getValue(W);K&&(K.liveStyle=!1)};for(const W in P){const K=L[W],de=B[W];if(b.hasOwnProperty(W))continue;let Q=!1;E_(K)&&E_(de)?Q=!i3(K,de):Q=K!==de,Q?K!=null?J(W):m.add(W):K!==void 0&&m.has(W)?J(W):A.protectedKeys[W]=!0}A.prevProp=D,A.prevResolvedValues=L,A.isActive&&(b={...b,...L}),r&&n.blockInitialAnimation&&(I=!1);const Y=j&&C;I&&(!Y||k)&&p.push(...z.map(W=>{const K={type:T};if(typeof W=="string"&&r&&!Y&&n.manuallyAnimateOnMount&&n.parent){const{parent:de}=n,Q=ad(de,W);if(de.enteringChildren&&Q){const{delayChildren:G}=Q.transition||{};K.delay=n3(de.enteringChildren,n,G)}}return{animation:W,options:K}}))}if(m.size){const S={};if(typeof d.initial!="boolean"){const T=ad(n,Array.isArray(d.initial)?d.initial[0]:d.initial);T&&T.transition&&(S.transition=T.transition)}m.forEach(T=>{const A=n.getBaseTarget(T),D=n.getValue(T);D&&(D.liveStyle=!0),S[T]=A??null}),p.push({animation:S})}let w=!!p.length;return r&&(d.initial===!1||d.initial===d.animate)&&!n.manuallyAnimateOnMount&&(w=!1),r=!1,w?e(p):Promise.resolve()}function c(u,d){if(t[u].isActive===d)return Promise.resolve();n.variantChildren?.forEach(p=>p.animationState?.setActive(u,d)),t[u].isActive=d;const h=o(u);for(const p in t)t[p].protectedKeys={};return h}return{animateChanges:o,setActive:c,setAnimateFunction:a,getState:()=>t,reset:()=>{t=pD()}}}function OK(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!i3(e,n):!1}function Yl(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function pD(){return{animate:Yl(!0),whileInView:Yl(),whileHover:Yl(),whileTap:Yl(),whileDrag:Yl(),whileFocus:Yl(),exit:Yl()}}class yl{constructor(e){this.isMounted=!1,this.node=e}update(){}}class jK extends yl{constructor(e){super(e),e.animationState||(e.animationState=PK(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();ey(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let VK=0;class zK extends yl{constructor(){super(...arguments),this.id=VK++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const LK={animation:{Feature:jK},exit:{Feature:zK}};function cp(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function Hp(n){return{point:{x:n.pageX,y:n.pageY}}}const BK=n=>e=>GE(e)&&n(e,Hp(e));function Rh(n,e,t,r){return cp(n,e,BK(t),r)}const s3=1e-4,UK=1-s3,FK=1+s3,o3=.01,GK=0-o3,qK=0+o3;function Hr(n){return n.max-n.min}function HK(n,e,t){return Math.abs(n-e)<=t}function gD(n,e,t,r=.5){n.origin=r,n.originPoint=Cn(e.min,e.max,n.origin),n.scale=Hr(t)/Hr(e),n.translate=Cn(t.min,t.max,n.origin)-n.originPoint,(n.scale>=UK&&n.scale<=FK||isNaN(n.scale))&&(n.scale=1),(n.translate>=GK&&n.translate<=qK||isNaN(n.translate))&&(n.translate=0)}function Dh(n,e,t,r){gD(n.x,e.x,t.x,r?r.originX:void 0),gD(n.y,e.y,t.y,r?r.originY:void 0)}function mD(n,e,t){n.min=t.min+e.min,n.max=n.min+Hr(e)}function $K(n,e,t){mD(n.x,e.x,t.x),mD(n.y,e.y,t.y)}function vD(n,e,t){n.min=e.min-t.min,n.max=n.min+Hr(e)}function kh(n,e,t){vD(n.x,e.x,t.x),vD(n.y,e.y,t.y)}function Li(n){return[n("x"),n("y")]}const l3=({current:n})=>n?n.ownerDocument.defaultView:null,yD=(n,e)=>Math.abs(n-e);function YK(n,e){const t=yD(n.x,e.x),r=yD(n.y,e.y);return Math.sqrt(t**2+r**2)}class c3{constructor(e,t,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:a=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=Xx(this.lastMoveEventInfo,this.history),b=this.startEvent!==null,_=YK(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!b&&!_)return;const{point:w}=m,{timestamp:S}=Sr;this.history.push({...w,timestamp:S});const{onStart:T,onMove:A}=this.handlers;b||(T&&T(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),A&&A(this.lastMoveEvent,m)},this.handlePointerMove=(m,b)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=Kx(b,this.transformPagePoint),wn.update(this.updatePoint,!0)},this.handlePointerUp=(m,b)=>{this.end();const{onEnd:_,onSessionEnd:w,resumeAnimation:S}=this.handlers;if(this.dragSnapToOrigin&&S&&S(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=Xx(m.type==="pointercancel"?this.lastMoveEventInfo:Kx(b,this.transformPagePoint),this.history);this.startEvent&&_&&_(m,T),w&&w(m,T)},!GE(e))return;this.dragSnapToOrigin=a,this.handlers=t,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=i||window;const c=Hp(e),u=Kx(c,this.transformPagePoint),{point:d}=u,{timestamp:h}=Sr;this.history=[{...d,timestamp:h}];const{onSessionStart:p}=t;p&&p(e,Xx(u,this.history)),this.removeListeners=Fp(Rh(this.contextWindow,"pointermove",this.handlePointerMove),Rh(this.contextWindow,"pointerup",this.handlePointerUp),Rh(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),cl(this.updatePoint)}}function Kx(n,e){return e?{point:e(n.point)}:n}function bD(n,e){return{x:n.x-e.x,y:n.y-e.y}}function Xx({point:n},e){return{point:n,delta:bD(n,u3(e)),offset:bD(n,KK(e)),velocity:XK(e,.1)}}function KK(n){return n[0]}function u3(n){return n[n.length-1]}function XK(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=u3(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Ja(e)));)t--;if(!r)return{x:0,y:0};const a=qi(i.timestamp-r.timestamp);if(a===0)return{x:0,y:0};const o={x:(i.x-r.x)/a,y:(i.y-r.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function WK(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?Cn(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?Cn(t,n,r.max):Math.min(n,t)),n}function xD(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function QK(n,{top:e,left:t,bottom:r,right:i}){return{x:xD(n.x,t,i),y:xD(n.y,e,r)}}function _D(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function ZK(n,e){return{x:_D(n.x,e.x),y:_D(n.y,e.y)}}function JK(n,e){let t=.5;const r=Hr(n),i=Hr(e);return i>r?t=ip(e.min,e.max-r,n.min):r>i&&(t=ip(n.min,n.max-i,e.min)),qs(0,1,t)}function eX(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const A_=.35;function tX(n=A_){return n===!1?n=0:n===!0&&(n=A_),{x:wD(n,"left","right"),y:wD(n,"top","bottom")}}function wD(n,e,t){return{min:ED(n,e),max:ED(n,t)}}function ED(n,e){return typeof n=="number"?n:n[e]||0}const nX=new WeakMap;class rX{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Un(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:r}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const a=p=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Hp(p).point)},o=(p,m)=>{const{drag:b,dragPropagation:_,onDragStart:w}=this.getProps();if(b&&!_&&(this.openDragLock&&this.openDragLock(),this.openDragLock=dY(b),!this.openDragLock))return;this.latestPointerEvent=p,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Li(T=>{let A=this.getAxisMotionValue(T).get()||0;if(es.test(A)){const{projection:D}=this.visualElement;if(D&&D.layout){const O=D.layout.layoutBox[T];O&&(A=Hr(O)*(parseFloat(A)/100))}}this.originPoint[T]=A}),w&&wn.postRender(()=>w(p,m)),S_(this.visualElement,"transform");const{animationState:S}=this.visualElement;S&&S.setActive("whileDrag",!0)},c=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m;const{dragPropagation:b,dragDirectionLock:_,onDirectionLock:w,onDrag:S}=this.getProps();if(!b&&!this.openDragLock)return;const{offset:T}=m;if(_&&this.currentDirection===null){this.currentDirection=iX(T),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",m.point,T),this.updateAxis("y",m.point,T),this.visualElement.render(),S&&S(p,m)},u=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m,this.stop(p,m),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>Li(p=>this.getAnimationState(p)==="paused"&&this.getAxisMotionValue(p).animation?.play()),{dragSnapToOrigin:h}=this.getProps();this.panSession=new c3(e,{onSessionStart:a,onStart:o,onMove:c,onSessionEnd:u,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,distanceThreshold:r,contextWindow:l3(this.visualElement)})}stop(e,t){const r=e||this.latestPointerEvent,i=t||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!i||!r)return;const{velocity:o}=i;this.startAnimation(o);const{onDragEnd:c}=this.getProps();c&&wn.postRender(()=>c(r,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!Vm(e,i,this.currentDirection))return;const a=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=WK(o,this.constraints[e],this.elastic[e])),a.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:t}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,i=this.constraints;e&&qu(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=QK(r.layoutBox,e):this.constraints=!1,this.elastic=tX(t),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Li(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=eX(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!qu(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const a=oK(r,i.root,this.visualElement.getTransformPagePoint());let o=ZK(i.layout.layoutBox,a);if(t){const c=t(iK(o));this.hasMutatedConstraints=!!c,c&&(o=$4(c))}return o}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:c}=this.getProps(),u=this.constraints||{},d=Li(h=>{if(!Vm(h,t,this.currentDirection))return;let p=u&&u[h]||{};o&&(p={min:0,max:0});const m=i?200:1e6,b=i?40:1e7,_={type:"inertia",velocity:r?e[h]:0,bounceStiffness:m,bounceDamping:b,timeConstant:750,restDelta:1,restSpeed:10,...a,...p};return this.startAxisValueAnimation(h,_)});return Promise.all(d).then(c)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return S_(this.visualElement,e),r.start(eS(e,r,0,t,this.visualElement,!1))}stopAnimation(){Li(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Li(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Li(t=>{const{drag:r}=this.getProps();if(!Vm(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,a=this.getAxisMotionValue(t);if(i&&i.layout){const{min:o,max:c}=i.layout.layoutBox[t];a.set(e[t]-Cn(o,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!qu(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Li(o=>{const c=this.getAxisMotionValue(o);if(c&&this.constraints!==!1){const u=c.get();i[o]=JK({min:u,max:u},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Li(o=>{if(!Vm(o,e,null))return;const c=this.getAxisMotionValue(o),{min:u,max:d}=this.constraints[o];c.set(Cn(u,d,i[o]))})}addListeners(){if(!this.visualElement.current)return;nX.set(this.visualElement,this);const e=this.visualElement.current,t=Rh(e,"pointerdown",u=>{const{drag:d,dragListener:h=!0}=this.getProps();d&&h&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();qu(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,a=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),wn.read(r);const o=cp(window,"resize",()=>this.scalePositionWithinConstraints()),c=i.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:d})=>{this.isDragging&&d&&(Li(h=>{const p=this.getAxisMotionValue(h);p&&(this.originPoint[h]+=u[h].translate,p.set(p.get()+u[h].translate))}),this.visualElement.render())}));return()=>{o(),t(),a(),c&&c()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:a=!1,dragElastic:o=A_,dragMomentum:c=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:a,dragElastic:o,dragMomentum:c}}}function Vm(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function iX(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class aX extends yl{constructor(e){super(e),this.removeGroupControls=$i,this.removeListeners=$i,this.controls=new rX(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||$i}unmount(){this.removeGroupControls(),this.removeListeners()}}const SD=n=>(e,t)=>{n&&wn.postRender(()=>n(e,t))};class sX extends yl{constructor(){super(...arguments),this.removePointerDownListener=$i}onPointerDown(e){this.session=new c3(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:l3(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:SD(e),onStart:SD(t),onMove:r,onEnd:(a,o)=>{delete this.session,i&&wn.postRender(()=>i(a,o))}}}mount(){this.removePointerDownListener=Rh(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const b0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function TD(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const nh={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(tt.test(n))n=parseFloat(n);else return n;const t=TD(n,e.target.x),r=TD(n,e.target.y);return`${t}% ${r}%`}},oX={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=ul.parse(n);if(i.length>5)return r;const a=ul.createTransformer(n),o=typeof i[0]!="number"?1:0,c=t.x.scale*e.x,u=t.y.scale*e.y;i[0+o]/=c,i[1+o]/=u;const d=Cn(c,u,.5);return typeof i[2+o]=="number"&&(i[2+o]/=d),typeof i[3+o]=="number"&&(i[3+o]/=d),a(i)}};let Wx=!1;class lX extends U.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:a}=e;NY(cX),a&&(t.group&&t.group.add(a),r&&r.register&&i&&r.register(a),Wx&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),b0.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:a}=this.props,{projection:o}=r;return o&&(o.isPresent=a,Wx=!0,i||e.layoutDependency!==t||t===void 0||e.isPresent!==a?o.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?o.promote():o.relegate()||wn.postRender(()=>{const c=o.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),FE.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;Wx=!0,i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function d3(n){const[e,t]=N4(),r=U.useContext(xE);return v.jsx(lX,{...n,layoutGroup:r,switchLayoutGroup:U.useContext(q4),isPresent:e,safeToRemove:t})}const cX={borderRadius:{...nh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:nh,borderTopRightRadius:nh,borderBottomLeftRadius:nh,borderBottomRightRadius:nh,boxShadow:oX};function uX(n,e,t){const r=Or(n)?n:Ed(n);return r.start(eS("",r,e,t)),r.animation}const dX=(n,e)=>n.depth-e.depth;class fX{constructor(){this.children=[],this.isDirty=!1}add(e){EE(this.children,e),this.isDirty=!0}remove(e){SE(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(dX),this.isDirty=!1,this.children.forEach(e)}}function hX(n,e){const t=ii.now(),r=({timestamp:i})=>{const a=i-t;a>=e&&(cl(r),n(a-e))};return wn.setup(r,!0),()=>cl(r)}const f3=["TopLeft","TopRight","BottomLeft","BottomRight"],pX=f3.length,AD=n=>typeof n=="string"?parseFloat(n):n,CD=n=>typeof n=="number"||tt.test(n);function gX(n,e,t,r,i,a){i?(n.opacity=Cn(0,t.opacity??1,mX(r)),n.opacityExit=Cn(e.opacity??1,0,vX(r))):a&&(n.opacity=Cn(e.opacity??1,t.opacity??1,r));for(let o=0;o<pX;o++){const c=`border${f3[o]}Radius`;let u=ID(e,c),d=ID(t,c);if(u===void 0&&d===void 0)continue;u||(u=0),d||(d=0),u===0||d===0||CD(u)===CD(d)?(n[c]=Math.max(Cn(AD(u),AD(d),r),0),(es.test(d)||es.test(u))&&(n[c]+="%")):n[c]=d}(e.rotate||t.rotate)&&(n.rotate=Cn(e.rotate||0,t.rotate||0,r))}function ID(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const mX=h3(0,.5,ZO),vX=h3(.5,.95,$i);function h3(n,e,t){return r=>r<n?0:r>e?1:t(ip(n,e,r))}function RD(n,e){n.min=e.min,n.max=e.max}function Vi(n,e){RD(n.x,e.x),RD(n.y,e.y)}function DD(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function kD(n,e,t,r,i){return n-=e,n=rv(n,1/t,r),i!==void 0&&(n=rv(n,1/i,r)),n}function yX(n,e=0,t=1,r=.5,i,a=n,o=n){if(es.test(e)&&(e=parseFloat(e),e=Cn(o.min,o.max,e/100)-o.min),typeof e!="number")return;let c=Cn(a.min,a.max,r);n===a&&(c-=e),n.min=kD(n.min,e,t,c,i),n.max=kD(n.max,e,t,c,i)}function ND(n,e,[t,r,i],a,o){yX(n,e[t],e[r],e[i],e.scale,a,o)}const bX=["x","scaleX","originX"],xX=["y","scaleY","originY"];function MD(n,e,t,r){ND(n.x,e,bX,t?t.x:void 0,r?r.x:void 0),ND(n.y,e,xX,t?t.y:void 0,r?r.y:void 0)}function PD(n){return n.translate===0&&n.scale===1}function p3(n){return PD(n.x)&&PD(n.y)}function OD(n,e){return n.min===e.min&&n.max===e.max}function _X(n,e){return OD(n.x,e.x)&&OD(n.y,e.y)}function jD(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function g3(n,e){return jD(n.x,e.x)&&jD(n.y,e.y)}function VD(n){return Hr(n.x)/Hr(n.y)}function zD(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class wX{constructor(){this.members=[]}add(e){EE(this.members,e),e.scheduleRender()}remove(e){if(SE(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const a=this.members[i];if(a.isPresent!==!1){r=a;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function EX(n,e,t){let r="";const i=n.x.translate/e.x,a=n.y.translate/e.y,o=t?.z||0;if((i||a||o)&&(r=`translate3d(${i}px, ${a}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:d,rotate:h,rotateX:p,rotateY:m,skewX:b,skewY:_}=t;d&&(r=`perspective(${d}px) ${r}`),h&&(r+=`rotate(${h}deg) `),p&&(r+=`rotateX(${p}deg) `),m&&(r+=`rotateY(${m}deg) `),b&&(r+=`skewX(${b}deg) `),_&&(r+=`skewY(${_}deg) `)}const c=n.x.scale*e.x,u=n.y.scale*e.y;return(c!==1||u!==1)&&(r+=`scale(${c}, ${u})`),r||"none"}const Qx=["","X","Y","Z"],SX=1e3;let TX=0;function Zx(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function m3(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=e3(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:a}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",wn,!(i||a))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&m3(r)}function v3({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},c=e?.()){this.id=TX++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(IX),this.nodes.forEach(NX),this.nodes.forEach(MX),this.nodes.forEach(RX)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new fX)}addEventListener(o,c){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new CE),this.eventHandlers.get(o).add(c)}notifyListeners(o,...c){const u=this.eventHandlers.get(o);u&&u.notify(...c)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=k4(o)&&!vY(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(u||c)&&(this.isLayoutDirty=!0),n){let h,p=0;const m=()=>this.root.updateBlockedByResize=!1;wn.read(()=>{p=window.innerWidth}),n(o,()=>{const b=window.innerWidth;b!==p&&(p=b,this.root.updateBlockedByResize=!0,h&&h(),h=hX(m,250),b0.hasAnimatedSinceResize&&(b0.hasAnimatedSinceResize=!1,this.nodes.forEach(UD)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:p,hasRelativeLayoutChanged:m,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||d.getDefaultTransition()||zX,{onLayoutAnimationStart:w,onLayoutAnimationComplete:S}=d.getProps(),T=!this.targetLayout||!g3(this.targetLayout,b),A=!p&&m;if(this.options.layoutRoot||this.resumeFrom||A||p&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const D={...BE(_,"layout"),onPlay:w,onComplete:S};(d.shouldReduceMotion||this.options.layoutRoot)&&(D.delay=0,D.type=!1),this.startAnimation(D),this.setAnimationOrigin(h,A)}else p||UD(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),cl(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(PX),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&m3(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const p=this.path[h];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:c,layout:u}=this.options;if(c===void 0&&!u)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(LD);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(BD);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(kX),this.nodes.forEach(AX),this.nodes.forEach(CX)):this.nodes.forEach(BD),this.clearAllSnapshots();const c=ii.now();Sr.delta=qs(0,1e3/60,c-Sr.timestamp),Sr.timestamp=c,Sr.isProcessing=!0,Bx.update.process(Sr),Bx.preRender.process(Sr),Bx.render.process(Sr),Sr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,FE.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(DX),this.sharedNodes.forEach(OX)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,wn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){wn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Hr(this.snapshot.measuredBox.x)&&!Hr(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Un(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(c=!1),c&&this.instance){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!p3(this.projectionDelta),u=this.getTransformTemplate(),d=u?u(this.latestValues,""):void 0,h=d!==this.prevTransformTemplateValue;o&&this.instance&&(c||Zl(this.latestValues)||h)&&(i(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const c=this.measurePageBox();let u=this.removeElementScroll(c);return o&&(u=this.removeTransform(u)),LX(u),{animationId:this.root.animationId,measuredBox:c,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return Un();const c=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(BX))){const{scroll:d}=this.root;d&&(Hu(c.x,d.offset.x),Hu(c.y,d.offset.y))}return c}removeElementScroll(o){const c=Un();if(Vi(c,o),this.scroll?.wasRoot)return c;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:h,options:p}=d;d!==this.root&&h&&p.layoutScroll&&(h.wasRoot&&Vi(c,o),Hu(c.x,h.offset.x),Hu(c.y,h.offset.y))}return c}applyTransform(o,c=!1){const u=Un();Vi(u,o);for(let d=0;d<this.path.length;d++){const h=this.path[d];!c&&h.options.layoutScroll&&h.scroll&&h!==h.root&&$u(u,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Zl(h.latestValues)&&$u(u,h.latestValues)}return Zl(this.latestValues)&&$u(u,this.latestValues),u}removeTransform(o){const c=Un();Vi(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];if(!d.instance||!Zl(d.latestValues))continue;x_(d.latestValues)&&d.updateSnapshot();const h=Un(),p=d.measurePageBox();Vi(h,p),MD(c,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,h)}return Zl(this.latestValues)&&MD(c,this.latestValues),c}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Sr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:p}=this.options;if(!(!this.layout||!(h||p))){if(this.resolvedRelativeTargetAt=Sr.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Un(),this.relativeTargetOrigin=Un(),kh(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Vi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Un(),this.targetWithTransforms=Un()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),$K(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Vi(this.target,this.layout.layoutBox),K4(this.target,this.targetDelta)):Vi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Un(),this.relativeTargetOrigin=Un(),kh(this.relativeTargetOrigin,this.target,m.target),Vi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||x_(this.parent.latestValues)||Y4(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const o=this.getLead(),c=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===Sr.timestamp&&(u=!1),u)return;const{layout:d,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||h))return;Vi(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,m=this.treeScale.y;sK(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Un());const{target:b}=o;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(DD(this.prevProjectionDelta.x,this.projectionDelta.x),DD(this.prevProjectionDelta.y,this.projectionDelta.y)),Dh(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==m||!zD(this.projectionDelta.x,this.prevProjectionDelta.x)||!zD(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Yu(),this.projectionDelta=Yu(),this.projectionDeltaWithTransform=Yu()}setAnimationOrigin(o,c=!1){const u=this.snapshot,d=u?u.latestValues:{},h={...this.latestValues},p=Yu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const m=Un(),b=u?u.source:void 0,_=this.layout?this.layout.source:void 0,w=b!==_,S=this.getStack(),T=!S||S.members.length<=1,A=!!(w&&!T&&this.options.crossfade===!0&&!this.path.some(VX));this.animationProgress=0;let D;this.mixTargetDelta=O=>{const M=O/1e3;FD(p.x,o.x,M),FD(p.y,o.y,M),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(kh(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),jX(this.relativeTarget,this.relativeTargetOrigin,m,M),D&&_X(this.relativeTarget,D)&&(this.isProjectionDirty=!1),D||(D=Un()),Vi(D,this.relativeTarget)),w&&(this.animationValues=h,gX(h,d,this.latestValues,M,A,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=M},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(cl(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=wn.update(()=>{b0.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Ed(0)),this.currentAnimation=uX(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:c=>{this.mixTargetDelta(c),o.onUpdate&&o.onUpdate(c)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(SX),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:c,target:u,layout:d,latestValues:h}=o;if(!(!c||!u||!d)){if(this!==o&&this.layout&&d&&y3(this.options.animationType,this.layout.layoutBox,d.layoutBox)){u=this.target||Un();const p=Hr(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const m=Hr(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+m}Vi(c,u),$u(c,h),Dh(this.projectionDeltaWithTransform,this.layoutCorrected,c,h)}}registerSharedNode(o,c){this.sharedNodes.has(o)||this.sharedNodes.set(o,new wX),this.sharedNodes.get(o).add(c);const d=c.options.initialPromotionConfig;c.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(c):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:c,preserveFollowOpacity:u}={}){const d=this.getStack();d&&d.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let c=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(c=!0),!c)return;const d={};u.z&&Zx("z",o,d,this.animationValues);for(let h=0;h<Qx.length;h++)Zx(`rotate${Qx[h]}`,o,d,this.animationValues),Zx(`skew${Qx[h]}`,o,d,this.animationValues);o.render();for(const h in d)o.setStaticValue(h,d[h]),this.animationValues&&(this.animationValues[h]=d[h]);o.scheduleRender()}applyProjectionStyles(o,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const u=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=y0(c?.pointerEvents)||"",o.transform=u?u(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=y0(c?.pointerEvents)||""),this.hasProjected&&!Zl(this.latestValues)&&(o.transform=u?u({},""):"none",this.hasProjected=!1);return}o.visibility="";const h=d.animationValues||d.latestValues;this.applyTransformsToTarget();let p=EX(this.projectionDeltaWithTransform,this.treeScale,h);u&&(p=u(h,p)),o.transform=p;const{x:m,y:b}=this.projectionDelta;o.transformOrigin=`${m.origin*100}% ${b.origin*100}% 0`,d.animationValues?o.opacity=d===this?h.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:o.opacity=d===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const _ in lp){if(h[_]===void 0)continue;const{correct:w,applyTo:S,isCSSVariable:T}=lp[_],A=p==="none"?h[_]:w(h[_],d);if(S){const D=S.length;for(let O=0;O<D;O++)o[S[O]]=A}else T?this.options.visualElement.renderState.vars[_]=A:o[_]=A}this.options.layoutId&&(o.pointerEvents=d===this?y0(c?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(LD),this.root.sharedNodes.clear()}}}function AX(n){n.updateLayout()}function CX(n){const e=n.resumeFrom?.snapshot||n.snapshot;if(n.isLead()&&n.layout&&e&&n.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:r}=n.layout,{animationType:i}=n.options,a=e.source!==n.layout.source;i==="size"?Li(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=Hr(p);p.min=t[h].min,p.max=p.min+m}):y3(i,e.layoutBox,t)&&Li(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=Hr(t[h]);p.max=p.min+m,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[h].max=n.relativeTarget[h].min+m)});const o=Yu();Dh(o,t,e.layoutBox);const c=Yu();a?Dh(c,n.applyTransform(r,!0),e.measuredBox):Dh(c,t,e.layoutBox);const u=!p3(o);let d=!1;if(!n.resumeFrom){const h=n.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:p,layout:m}=h;if(p&&m){const b=Un();kh(b,e.layoutBox,p.layoutBox);const _=Un();kh(_,t,m.layoutBox),g3(b,_)||(d=!0),h.options.layoutRoot&&(n.relativeTarget=_,n.relativeTargetOrigin=b,n.relativeParent=h)}}}n.notifyListeners("didUpdate",{layout:t,snapshot:e,delta:c,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(n.isLead()){const{onExitComplete:t}=n.options;t&&t()}n.options.transition=void 0}function IX(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function RX(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function DX(n){n.clearSnapshot()}function LD(n){n.clearMeasurements()}function BD(n){n.isLayoutDirty=!1}function kX(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function UD(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function NX(n){n.resolveTargetDelta()}function MX(n){n.calcProjection()}function PX(n){n.resetSkewAndRotation()}function OX(n){n.removeLeadSnapshot()}function FD(n,e,t){n.translate=Cn(e.translate,0,t),n.scale=Cn(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function GD(n,e,t,r){n.min=Cn(e.min,t.min,r),n.max=Cn(e.max,t.max,r)}function jX(n,e,t,r){GD(n.x,e.x,t.x,r),GD(n.y,e.y,t.y,r)}function VX(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const zX={duration:.45,ease:[.4,0,.1,1]},qD=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),HD=qD("applewebkit/")&&!qD("chrome/")?Math.round:$i;function $D(n){n.min=HD(n.min),n.max=HD(n.max)}function LX(n){$D(n.x),$D(n.y)}function y3(n,e,t){return n==="position"||n==="preserve-aspect"&&!HK(VD(e),VD(t),.2)}function BX(n){return n!==n.root&&n.scroll?.wasRoot}const UX=v3({attachResizeListener:(n,e)=>cp(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Jx={current:void 0},b3=v3({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!Jx.current){const n=new UX({});n.mount(window),n.setOptions({layoutScroll:!0}),Jx.current=n}return Jx.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),FX={pan:{Feature:sX},drag:{Feature:aX,ProjectionNode:b3,MeasureLayout:d3}};function YD(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,a=r[i];a&&wn.postRender(()=>a(e,Hp(e)))}class GX extends yl{mount(){const{current:e}=this.node;e&&(this.unmount=fY(e,(t,r)=>(YD(this.node,r,"Start"),i=>YD(this.node,i,"End"))))}unmount(){}}class qX extends yl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Fp(cp(this.node.current,"focus",()=>this.onFocus()),cp(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function KD(n,e,t){const{props:r}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),a=r[i];a&&wn.postRender(()=>a(e,Hp(e)))}class HX extends yl{mount(){const{current:e}=this.node;e&&(this.unmount=mY(e,(t,r)=>(KD(this.node,r,"Start"),(i,{success:a})=>KD(this.node,i,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const C_=new WeakMap,e1=new WeakMap,$X=n=>{const e=C_.get(n.target);e&&e(n)},YX=n=>{n.forEach($X)};function KX({root:n,...e}){const t=n||document;e1.has(t)||e1.set(t,{});const r=e1.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(YX,{root:n,...e})),r[i]}function XX(n,e,t){const r=KX(e);return C_.set(n,t),r.observe(n),()=>{C_.delete(n),r.unobserve(n)}}const WX={some:0,all:1};class QX extends yl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:a}=e,o={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:WX[i]},c=u=>{const{isIntersecting:d}=u;if(this.isInView===d||(this.isInView=d,a&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:h,onViewportLeave:p}=this.node.getProps(),m=d?h:p;m&&m(u)};return XX(this.node.current,o,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(ZX(e,t))&&this.startObserver()}unmount(){}}function ZX({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const JX={inView:{Feature:QX},tap:{Feature:HX},focus:{Feature:qX},hover:{Feature:GX}},eW={layout:{ProjectionNode:b3,MeasureLayout:d3}},tW={...LK,...JX,...FX,...eW},On=rK(tW,mK);function nW(n){n.values.forEach(e=>e.stop())}function I_(n,e){[...e].reverse().forEach(r=>{const i=n.getVariant(r);i&&JE(n,i),n.variantChildren&&n.variantChildren.forEach(a=>{I_(a,e)})})}function rW(n,e){if(Array.isArray(e))return I_(n,e);if(typeof e=="string")return I_(n,[e]);JE(n,e)}function iW(){const n=new Set,e={subscribe(t){return n.add(t),()=>void n.delete(t)},start(t,r){const i=[];return n.forEach(a=>{i.push(r3(a,t,{transitionOverride:r}))}),Promise.all(i)},set(t){return n.forEach(r=>{rW(r,t)})},stop(){n.forEach(t=>{nW(t)})},mount(){return()=>{e.stop()}}};return e}function aW(){const n=Qv(iW);return wE(n.mount,[]),n}const sW=aW,bl=fw((n,e)=>({message:"",type:"neutral",isVisible:!1,undoAction:void 0,showToast:(t,r="neutral",i)=>{n({message:t,type:r,isVisible:!0,undoAction:i}),setTimeout(()=>{e().hideToast()},2e3)},hideToast:()=>{n({isVisible:!1})}})),oW=()=>{const{message:n,type:e,isVisible:t,undoAction:r,hideToast:i}=bl(),a=()=>{switch(e){case"success":return"bg-green-500 dark:bg-green-600 text-white";case"error":return"bg-red-500 dark:bg-red-600 text-white";case"neutral":default:return"bg-gray-800 dark:bg-gray-900 text-white border border-gray-200 dark:border-gray-700"}};return v.jsx(ai,{children:t&&v.jsx(On.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-24 right-6 z-[110] max-w-xs",children:v.jsxs("div",{className:`rounded-lg shadow-lg p-3 flex items-center justify-between ${a()}`,children:[v.jsx("div",{className:"flex items-center flex-1 min-w-0",children:v.jsx("span",{className:"text-xs font-medium whitespace-pre-line pr-2",children:n})}),v.jsxs("div",{className:"flex items-center gap-1 ml-2 flex-shrink-0",children:[r&&v.jsxs("button",{onClick:()=>{r(),i()},className:"px-2 py-1 bg-white/20 hover:bg-white/30 rounded text-xs font-bold transition-colors",children:[v.jsx(E9,{size:12,className:"inline mr-1"}),"Undo"]}),v.jsx("button",{onClick:i,className:"p-0.5 hover:bg-black/10 dark:hover:bg-white/10 rounded-full transition-colors",children:v.jsx(Ev,{size:14})})]})]})})})};class Ua extends U.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t),this.setState({error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t)}componentDidUpdate(e){this.props.resetKeys&&this.props.resetOnPropsChange&&this.props.resetKeys.some((r,i)=>r!==e.resetKeys?.[i])&&this.state.hasError&&this.resetErrorBoundary()}resetErrorBoundary=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[v.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 dark:bg-red-900/30 rounded-full",children:v.jsx(ed,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white text-center mb-2",children:"Something went wrong"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-6",children:"We're sorry, but something unexpected happened. You can try refreshing or going back to the home screen."}),!1,v.jsxs("div",{className:"flex flex-col gap-3",children:[v.jsxs("button",{onClick:this.resetErrorBoundary,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors",children:[v.jsx(Lh,{className:"h-4 w-4"}),"Try Again"]}),v.jsxs("button",{onClick:()=>window.location.href="/#/",className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white font-medium rounded-md transition-colors",children:[v.jsx(XL,{className:"h-4 w-4"}),"Go to Home"]})]})]})}):this.props.children}}const lW=({onAddTransaction:n})=>{const e=Ks(),t=xa(),[r,i]=U.useState(!1),a=U.useRef(null),o=d=>t.pathname===d;U.useEffect(()=>{const d=h=>{a.current&&!a.current.contains(h.target)&&i(!1)};if(r)return document.addEventListener("mousedown",d),document.addEventListener("touchstart",d),()=>{document.removeEventListener("mousedown",d),document.removeEventListener("touchstart",d)}},[r]);const c=[{path:"/reports",icon:v.jsx(bL,{className:"w-5 h-5"}),label:"Reports"},{path:"/analytics",icon:v.jsx(T0,{className:"w-5 h-5"}),label:"Analytics"},{path:"/budget-breakdown",icon:v.jsx(_L,{className:"w-5 h-5"}),label:"Budget Breakdown"}],u=({path:d,icon:h,label:p})=>{const m=o(d);return v.jsxs("button",{onClick:b=>{b.stopPropagation(),e(d)},className:`
          relative group flex flex-col items-center justify-center
          w-12 h-12 rounded-2xl transition-all duration-300
          ${m?"text-blue-500 bg-blue-50 dark:bg-blue-500/20 dark:text-blue-400":"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-800"}
        `,children:[v.jsx("div",{className:`transition-transform duration-300 ${m?"scale-110":"group-hover:scale-105"}`,children:h}),v.jsx("span",{className:"sr-only",children:p}),m&&v.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-current rounded-full opacity-80"})]})};return v.jsx("div",{className:"fixed bottom-6 left-0 right-0 flex justify-center z-[100] pointer-events-none safe-area-inset-bottom",children:v.jsxs("nav",{className:`
          pointer-events-auto
          flex items-center gap-1 p-2 pl-4 pr-4
          bg-white/60 dark:bg-zinc-900/60 backdrop-blur-xl
          border border-zinc-200/30 dark:border-zinc-800/30
          rounded-full shadow-2xl shadow-zinc-900/10
          transform transition-all duration-500 ease-out
        `,onClick:d=>d.stopPropagation(),onTouchStart:d=>d.stopPropagation(),onTouchEnd:d=>d.stopPropagation(),children:[v.jsx(u,{path:"/",label:"Budget",icon:v.jsx(wv,{className:"w-6 h-6"})}),v.jsx(u,{path:"/transactions",label:"Transactions",icon:v.jsx(QL,{className:"w-6 h-6"})}),v.jsx("div",{className:"w-px h-8 bg-zinc-200 dark:bg-zinc-800 mx-2"}),v.jsx("button",{onClick:d=>{if(d.stopPropagation(),i(!1),n){n();return}e("/add-transaction")},className:`
            -mt-8 mb-2 mx-1
            group relative flex items-center justify-center
            w-16 h-16 rounded-full
            bg-blue-600 text-white
            shadow-xl shadow-blue-600/30
            hover:shadow-blue-600/50 hover:scale-105 hover:-translate-y-1
            active:scale-95 active:translate-y-0
            transition-all duration-300 cubic-bezier(0.175, 0.885, 0.32, 1.275)
          `,children:v.jsx(mh,{className:"w-8 h-8 transition-transform duration-300 group-hover:rotate-90"})}),v.jsx("div",{className:"w-px h-8 bg-zinc-200 dark:bg-zinc-800 mx-2"}),v.jsxs("div",{className:"relative",ref:a,children:[v.jsxs("button",{onClick:d=>{d.stopPropagation(),i(!r)},className:`
              relative group flex flex-col items-center justify-center
              w-12 h-12 rounded-2xl transition-all duration-300
              ${r?"text-blue-500 bg-blue-50 dark:bg-blue-500/20 dark:text-blue-400":"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-800"}
            `,children:[v.jsx("div",{className:`transition-transform duration-300 ${r?"scale-110":"group-hover:scale-105"}`,children:v.jsx(bN,{className:"w-6 h-6"})}),v.jsx("span",{className:"sr-only",children:"More"}),r&&v.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-current rounded-full opacity-80"})]}),r&&v.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-56 bg-white dark:bg-zinc-900 rounded-2xl shadow-2xl border border-zinc-200/50 dark:border-zinc-800/50 backdrop-blur-xl z-50 overflow-hidden",onClick:d=>d.stopPropagation(),onTouchStart:d=>d.stopPropagation(),onTouchEnd:d=>d.stopPropagation(),children:v.jsx("div",{className:"p-2 space-y-1",children:c.map((d,h)=>v.jsxs("button",{onClick:p=>{p.stopPropagation(),e(d.path),i(!1)},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[v.jsx("div",{className:"text-zinc-600 dark:text-zinc-400",children:d.icon}),v.jsx("span",{className:"text-sm font-medium text-zinc-900 dark:text-white",children:d.label})]},h))})})]}),v.jsx(u,{path:"/settings",label:"Settings",icon:v.jsx(p9,{className:"w-6 h-6"})})]})})};function cW(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.map(function(r){return r.split(" ").map(function(i){return i?""+n+i:""}).join(" ")}).join(" ")}function uW(n,e){return e.replace(/([^}{]*){/gm,function(t,r){return r.replace(/\.([^{,\s\d.]+)/g,"."+n+"$1")+"{"})}function Os(n,e){return function(t){t&&(n[e]=t)}}function x3(n,e,t){return function(r){r&&(n[e][t]=r)}}function XD(n,e){return function(t){var r=t.prototype;n.forEach(function(i){e(r,i)})}}function dW(n,e){return e===void 0&&(e={}),function(t,r){n.forEach(function(i){var a=e[i]||i;a in t||(t[a]=function(){for(var o,c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];var d=(o=this[r])[i].apply(o,c);return d===this[r]?this:d})})}}var fW="function",hW="object",pW="string",gW="number",tS="undefined",_3=typeof window!==tS,mW=typeof document!==tS&&document,vW=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],Jn=1e-7,zm={cm:function(n){return n*96/2.54},mm:function(n){return n*96/254},in:function(n){return n*96},pt:function(n){return n*96/72},pc:function(n){return n*96/6},"%":function(n,e){return n*e/100},vw:function(n,e){return e===void 0&&(e=window.innerWidth),n/100*e},vh:function(n,e){return e===void 0&&(e=window.innerHeight),n/100*e},vmax:function(n,e){return e===void 0&&(e=Math.max(window.innerWidth,window.innerHeight)),n/100*e},vmin:function(n,e){return e===void 0&&(e=Math.min(window.innerWidth,window.innerHeight)),n/100*e}};function yW(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}function iv(n,e,t,r){return(n*r+e*t)/(t+r)}function ny(n){return typeof n===tS}function ya(n){return n&&typeof n===hW}function nr(n){return Array.isArray(n)}function si(n){return typeof n===pW}function Td(n){return typeof n===gW}function nS(n){return typeof n===fW}function bW(n,e){var t=n===""||n==" ",r=e===""||e==" ";return r&&t||n===e}function w3(n,e,t,r,i){var a=rS(n,e,t);return a?t:xW(n,e,t+1,r,i)}function rS(n,e,t){if(!n.ignore)return null;var r=e.slice(Math.max(t-3,0),t+3).join("");return new RegExp(n.ignore).exec(r)}function xW(n,e,t,r,i){for(var a=function(d){var h=e[d].trim();if(h===n.close&&!rS(n,e,d))return{value:d};var p=d,m=oi(i,function(b){var _=b.open;return _===h});if(m&&(p=w3(m,e,d,r,i)),p===-1)return o=d,"break";d=p,o=d},o,c=t;c<r;++c){var u=a(c);if(c=o,typeof u=="object")return u.value;if(u==="break")break}return-1}function iS(n,e){var t=si(e)?{separator:e}:e,r=t.separator,i=r===void 0?",":r,a=t.isSeparateFirst,o=t.isSeparateOnlyOpenClose,c=t.isSeparateOpenClose,u=c===void 0?o:c,d=t.openCloseCharacters,h=d===void 0?vW:d,p=h.map(function(C){var I=C.open,k=C.close;return I===k?I:I+"|"+k}).join("|"),m="(\\s*"+i+"\\s*|"+p+"|\\s+)",b=new RegExp(m,"g"),_=n.split(b).filter(function(C){return C&&C!=="undefined"}),w=_.length,S=[],T=[];function A(){return T.length?(S.push(T.join("")),T=[],!0):!1}for(var D=function(C){var I=_[C].trim(),k=C,z=oi(h,function(P){var J=P.open;return J===I}),L=oi(h,function(P){var J=P.close;return J===I});if(z){if(k=w3(z,_,C,w,h),k!==-1&&u)return A()&&a||(S.push(_.slice(C,k+1).join("")),C=k,a)?(O=C,"break"):(O=C,"continue")}else if(L&&!rS(L,_,C)){var B=yW(h);return B.splice(h.indexOf(L),1),{value:iS(n,{separator:i,isSeparateFirst:a,isSeparateOnlyOpenClose:o,isSeparateOpenClose:u,openCloseCharacters:B})}}else if(bW(I,i)&&!o)return A(),a?(O=C,"break"):(O=C,"continue");k===-1&&(k=w-1),T.push(_.slice(C,k+1).join("")),C=k,O=C},O,M=0;M<w;++M){var j=D(M);if(M=O,typeof j=="object")return j.value;if(j==="break")break}return T.length&&S.push(T.join("")),S}function dl(n){return iS(n,"")}function dc(n){return iS(n,",")}function E3(n){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(n);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function $p(n){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(n);if(!e)return{prefix:"",unit:"",value:NaN};var t=e[1],r=e[2],i=e[3];return{prefix:t,unit:i,value:parseFloat(r)}}function _W(n){return n.replace(/[\s-_]+([^\s-_])/g,function(e,t){return t.toUpperCase()})}function x0(n,e){return n.replace(/([a-z])([A-Z])/g,function(t,r,i){return""+r+e+i.toLowerCase()})}function up(){return Date.now?Date.now():new Date().getTime()}function $s(n,e,t){t===void 0&&(t=-1);for(var r=n.length,i=0;i<r;++i)if(e(n[i],i,n))return i;return t}function oi(n,e,t){var r=$s(n,e);return r>-1?n[r]:t}var S3=(function(){var n=up(),e=_3&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(t){var r=up(),i=setTimeout(function(){t(r-n)},1e3/60);return i}})(),wW=(function(){var n=_3&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return n?n.bind(window):function(e){clearTimeout(e)}})();function Ys(n){return Object.keys(n)}function EW(n){var e=Ys(n);return e.map(function(t){return n[t]})}function nn(n,e){var t=$p(n),r=t.value,i=t.unit;if(ya(e)){var a=e[i];if(a){if(nS(a))return a(r);if(zm[i])return zm[i](r,a)}}else if(i==="%")return r*e/100;return zm[i]?zm[i](r):r}function R_(n,e,t){return Math.max(e,Math.min(n,t))}function WD(n,e,t,r){return r===void 0&&(r=n[0]/n[1]),[[st(e[0],Jn),st(e[0]/r,Jn)],[st(e[1]*r,Jn),st(e[1],Jn)]].filter(function(i){return i.every(function(a,o){var c=e[o],u=st(c,Jn);return t?a<=c||a<=u:a>=c||a>=u})})[0]||n}function T3(n,e,t,r){if(!r)return n.map(function(b,_){return R_(b,e[_],t[_])});var i=n[0],a=n[1],o=r===!0?i/a:r,c=WD(n,e,!1,o),u=c[0],d=c[1],h=WD(n,t,!0,o),p=h[0],m=h[1];return i<u||a<d?(i=u,a=d):(i>p||a>m)&&(i=p,a=m),[i,a]}function SW(n){for(var e=n.length,t=0,r=e-1;r>=0;--r)t+=n[r];return t}function D_(n){for(var e=n.length,t=0,r=e-1;r>=0;--r)t+=n[r];return e?t/e:0}function Fn(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=Math.atan2(r,t);return i>=0?i:i+Math.PI*2}function TW(n){return[0,1].map(function(e){return D_(n.map(function(t){return t[e]}))})}function QD(n){var e=TW(n),t=Fn(e,n[0]),r=Fn(e,n[1]);return t<r&&r-t<Math.PI||t>r&&r-t<-Math.PI?1:-1}function js(n,e){return Math.sqrt(Math.pow((e?e[0]:0)-n[0],2)+Math.pow((e?e[1]:0)-n[1],2))}function st(n,e){if(!e)return n;var t=1/e;return Math.round(n/e)/t}function ZD(n,e){return n.forEach(function(t,r){n[r]=st(n[r],e)}),n}function AW(n){for(var e=[],t=0;t<n;++t)e.push(t);return e}function A3(n){return n.reduce(function(e,t){return e.concat(t)},[])}function C3(n,e){n.indexOf(e)===-1&&n.push(e)}function cr(n,e){return n.classList?n.classList.contains(e):!!n.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function I3(n,e){n.classList?n.classList.add(e):n.className+=" "+e}function R3(n,e){if(n.classList)n.classList.remove(e);else{var t=new RegExp("(\\s|^)"+e+"(\\s|$)");n.className=n.className.replace(t," ")}}function Er(n,e,t,r){n.addEventListener(e,t,r)}function or(n,e,t,r){n.removeEventListener(e,t,r)}function Hd(n){return n?.ownerDocument||mW}function aS(n){return Hd(n).documentElement}function xl(n){return Hd(n).body}function rl(n){var e;return((e=n?.ownerDocument)===null||e===void 0?void 0:e.defaultView)||window}function D3(n){return n&&"postMessage"in n&&"blur"in n&&"self"in n}function $d(n){return ya(n)&&n.nodeName&&n.nodeType&&"ownerDocument"in n}var CW=(function(){function n(){this.keys=[],this.values=[]}var e=n.prototype;return e.get=function(t){return this.values[this.keys.indexOf(t)]},e.set=function(t,r){var i=this.keys,a=this.values,o=i.indexOf(t),c=o===-1?i.length:o;i[c]=t,a[c]=r},n})(),IW=(function(){function n(){this.object={}}var e=n.prototype;return e.get=function(t){return this.object[t]},e.set=function(t,r){this.object[t]=r},n})(),RW=typeof Map=="function",DW=(function(){function n(){}var e=n.prototype;return e.connect=function(t,r){this.prev=t,this.next=r,t&&(t.next=this),r&&(r.prev=this)},e.disconnect=function(){var t=this.prev,r=this.next;t&&(t.next=r),r&&(r.prev=t)},e.getIndex=function(){for(var t=this,r=-1;t;)t=t.prev,++r;return r},n})();function kW(n,e){var t=[],r=[];return n.forEach(function(i){var a=i[0],o=i[1],c=new DW;t[a]=c,r[o]=c}),t.forEach(function(i,a){i.connect(t[a-1])}),n.filter(function(i,a){return!e[a]}).map(function(i,a){var o=i[0],c=i[1];if(o===c)return[0,0];var u=t[o],d=r[c-1],h=u.getIndex();u.disconnect(),d?u.connect(d,d.next):u.connect(void 0,t[0]);var p=u.getIndex();return[h,p]})}var NW=(function(){function n(t,r,i,a,o,c,u,d){this.prevList=t,this.list=r,this.added=i,this.removed=a,this.changed=o,this.maintained=c,this.changedBeforeAdded=u,this.fixed=d}var e=n.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var t=kW(this.changedBeforeAdded,this.fixed),r=this.changed,i=[];this.cacheOrdered=t.filter(function(a,o){var c=a[0],u=a[1],d=r[o],h=d[0],p=d[1];if(c!==u)return i.push([h,p]),!0}),this.cachePureChanged=i},n})();function Yp(n,e,t){var r=RW?Map:t?IW:CW,i=t||function(A){return A},a=[],o=[],c=[],u=n.map(i),d=e.map(i),h=new r,p=new r,m=[],b=[],_={},w=[],S=0,T=0;return u.forEach(function(A,D){h.set(A,D)}),d.forEach(function(A,D){p.set(A,D)}),u.forEach(function(A,D){var O=p.get(A);typeof O>"u"?(++T,o.push(D)):_[O]=T}),d.forEach(function(A,D){var O=h.get(A);typeof O>"u"?(a.push(D),++S):(c.push([O,D]),T=_[D]||0,m.push([O-T,D-S]),b.push(D===O),O!==D&&w.push([O,D]))}),o.reverse(),new NW(n,e,a,o,w,c,m,b)}var MW=(function(){function n(t,r){t===void 0&&(t=[]),this.findKeyCallback=r,this.list=[].slice.call(t)}var e=n.prototype;return e.update=function(t){var r=[].slice.call(t),i=Yp(this.list,r,this.findKeyCallback);return this.list=r,i},n})(),k_=function(n,e){return k_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},k_(n,e)};function Kp(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");k_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var $a=function(){return $a=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},$a.apply(this,arguments)};function k3(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function JD(n,e,t){for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function ek(n){var e=0;return n.map(function(t){return t==null?"$compat".concat(++e):"".concat(t)})}function N3(n){var e=[];return n.forEach(function(t){e=e.concat(nr(t)?N3(t):t)}),e}function t1(n,e){if(!e)return n;for(var t in e)ny(n[t])&&(n[t]=e[t]);return n}function av(n,e){if(n===e)return!1;for(var t in n)if(!(t in e))return!0;for(var t in e)if(n[t]!==e[t])return!0;return!1}function tk(n){var e=n.className,t=k3(n,["className"]);return e!=null&&(t.class=e),delete t.style,delete t.children,t}function nk(n){var e={},t={};for(var r in n)r.indexOf("on")===0?t[r]=n[r]:e[r]=n[r];return[e,t]}function ry(n){if(!n)return null;var e=n.b;return $d(e)?e:ry(n.c)}function M3(n){var e=n.parentNode;e&&e.removeChild(n)}function P3(n){n.forEach(function(e){e()})}function PW(){return this.constructor(this.props,this.context)}var sS=0,iy=(function(){function n(t,r,i,a,o,c,u){u===void 0&&(u={}),this.t=t,this.d=r,this.k=i,this.i=a,this.c=o,this.ref=c,this.ps=u,this.typ="prov",this._ps=[],this._cs={},this._hyd=null,this._sel=!1}var e=n.prototype;return e.s=function(){return!0},e.u=function(t,r,i,a,o){var c=this,u=c.d,d=EW(r).filter(function(_){return _.$_req}),h=N3(d.map(function(_){return _.$_subs})),p=oi(h,function(_){return _.d===u});if(c.b&&!si(i)&&!o&&!c.s(i.props,a)&&!p){var m=h.reduce(function(_,w){var S=w.d;return _[0]?_[0].d===S&&_.push(w):S>u&&_.push(w),_},[]);return m.forEach(function(_){Xp(_,_._ps,[_.o],t,r,!0)}),!1}c.o=i,c.ss(a);var b=c.ps;return si(i)||(c.ps=i.props,c.ref=i.ref),oS(this),c.r(t,r,c.b?b:{},a),!0},e.md=function(){this.rr()},e.ss=function(){},e.ud=function(){this.rr()},e.rr=function(){var t=this,r=t.ref,i=t.fr;r&&r(i?i.current:t.b)},n})();function O3(){return Object.__CROACT_CURRENT_INSTNACE__}function OW(){return sS}function jW(n){sS=n}function oS(n){return Object.__CROACT_CURRENT_INSTNACE__=n,sS=0,n}var lS=(function(){function n(t,r){t===void 0&&(t={}),this.props=t,this.context=r,this.state={},this.$_timer=0,this.$_state={},this.$_subs=[],this.$_cs={}}var e=n.prototype;return e.render=function(){return null},e.shouldComponentUpdate=function(t,r){return this.props!==t||this.state!==r},e.setState=function(t,r,i){var a=this;a.$_timer||(a.$_state={}),clearTimeout(a.$_timer),a.$_timer=0,a.$_state=$a($a({},a.$_state),t),i?a.$_setState(r,i):a.$_timer=window.setTimeout(function(){a.$_timer=0,a.$_setState(r,i)})},e.forceUpdate=function(t){this.setState({},t,!0)},e.componentDidMount=function(){},e.componentDidUpdate=function(t,r){},e.componentWillUnmount=function(){},e.$_setState=function(t,r){var i=[],a=this.$_p,o=Xp(a.c,[a],[a.o],i,a._cs,$a($a({},this.state),this.$_state),r);o&&(t&&i.push(t),P3(i),oS(null))},n})(),j3=(function(n){Kp(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}var t=e.prototype;return t.shouldComponentUpdate=function(r,i){return av(this.props,r)||av(this.state,i)},e})(lS);function V3(n){var e=function(t){e.current=t};return e.current=n,e}function VW(n){return n._fr=!0,n}function zW(n,e,t,r){var i,a;return!((i=n?.prototype)===null||i===void 0)&&i.render?a=new n(e,t):(a=new lS(e,t),a.constructor=n,n._fr?(r.fr=V3(),a.render=function(){return this.constructor(this.props,r.fr)}):a.render=PW),a.$_p=r,a}var LW=(function(n){Kp(e,n);function e(r,i,a,o,c,u,d){d===void 0&&(d={});var h=n.call(this,r,i,a,o,c,u,t1(d,r.defaultProps))||this;return h.typ="comp",h._usefs=[],h._uefs=[],h._defs=[],h}var t=e.prototype;return t.s=function(r,i){var a=this.b;return a.shouldComponentUpdate(t1(r,this.t.defaultProps),i||a.state)!==!1},t.r=function(r,i,a){var o,c,u=this,d=u.t;u.ps=t1(u.ps,u.t.defaultProps);var h=u.ps,p=!u.b,m=d.contextType,b=u.b,_=m?.get(u);u._cs=i,p?(b=zW(d,h,_,u),u.b=b):(b.props=h,b.context=_);var w=b.state;u._usefs=[],u._uefs=[];var S=b.render();((c=(o=S?.props)===null||o===void 0?void 0:o.children)===null||c===void 0?void 0:c.length)===0&&(S.props.children=u.ps.children);var T=$a($a({},i),b.$_cs);Xp(u,u._ps,S?[S]:[],r,T),p?u._uefs.push(function(){m?.register(u),b.componentDidMount()}):u._uefs.push(function(){b.componentDidUpdate(a,w)}),r.push(function(){u._usefs.forEach(function(A){A()}),p?u.md():u.ud(),u._defs=u._uefs.map(function(A){return A()})})},t.ss=function(r){var i=this.b;!i||!r||(i.state=r)},t.un=function(){var r,i=this;i._ps.forEach(function(o){o.un()});var a=i.t;(r=a.contextType)===null||r===void 0||r.unregister(i),clearTimeout(i.b.$_timer),i._defs.forEach(function(o){o&&o()}),i.b.componentWillUnmount()},e})(iy);function BW(n,e,t){var r=cS(tk(n),tk(e)),i=r.added,a=r.removed,o=r.changed;for(var c in i)t.setAttribute(c,i[c]);for(var u in o)t.setAttribute(u,o[u][1]);for(var d in a)t.removeAttribute(d)}function UW(n,e,t){var r=cS(n,e),i=r.added,a=r.removed;for(var o in a)t.e(o,!0);for(var c in i)t.e(c)}function cS(n,e){var t=Ys(n),r=Ys(e),i=Yp(t,r,function(u){return u}),a={},o={},c={};return i.added.forEach(function(u){var d=r[u];a[d]=e[d]}),i.removed.forEach(function(u){var d=t[u];o[d]=n[d]}),i.maintained.forEach(function(u){var d=u[0],h=t[d],p=[n[h],e[h]];n[h]!==e[h]&&(c[h]=p)}),{added:a,removed:o,changed:c}}function FW(n,e,t){var r=t.style,i=cS(n,e),a=i.added,o=i.removed,c=i.changed;for(var u in a){var d=x0(u,"-");r.setProperty(d,a[u])}for(var u in c){var h=x0(u,"-");r.setProperty(h,c[u][1])}for(var u in o){var p=x0(u,"-");r.removeProperty(p)}}function GW(n){return n.replace(/^on/g,"").toLowerCase()}var qW=(function(n){Kp(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r.typ="elem",r._es={},r._svg=!1,r}var t=e.prototype;return t.e=function(r,i){var a=this,o=a._es,c=a.b,u=GW(r);i?(or(c,u,o[r]),delete o[r]):(o[r]=function(d){var h,p;(p=(h=a.ps)[r])===null||p===void 0||p.call(h,d)},Er(c,u,o[r]))},t.s=function(r){return av(this.ps,r)},t.r=function(r,i,a){var o,c=this,u=!c.b,d=c.ps;if(u){var h=ry(c.c),p=!1;c._svg||c.t==="svg"?p=!0:p=h&&h.ownerSVGElement,c._svg=p;var m=(o=c._hyd)===null||o===void 0?void 0:o.splice(0,1)[0],b=c.t;if(m)c._hyd=[].slice.call(m.children||[]);else{var _=Hd(h);p?m=_.createElementNS("http://www.w3.org/2000/svg",b):m=_.createElement(b)}c.b=m}Xp(c,c._ps,d.children,r,i);var w=c.b,S=nk(a),T=S[0],A=S[1],D=nk(d),O=D[0],M=D[1];return BW(T,O,w),UW(A,M,c),FW(a.style||{},d.style||{},w),r.push(function(){u?c.md():c.ud()}),!0},t.un=function(){var r=this,i=r._es,a=r.b;for(var o in i)or(a,o,i[o]);r._ps.forEach(function(c){c.un()}),r._es={},r._sel||M3(a)},e})(iy);function dp(n){if(!n||$d(n))return n;var e=n.$_p._ps;return e.length?dp(e[0].b):null}function z3(n){if(n){if(n.b&&$d(n.b))return n;var e=n._ps;return e.length?z3(e[0]):null}}function ha(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=e||{},a=i.key,o=i.ref,c=k3(i,["key","ref"]);return{type:n,key:a,ref:o,props:$a($a({},c),{children:A3(t).filter(function(u){return u!=null&&u!==!1})})}}var L3=(function(n){Kp(e,n);function e(r,i){i===void 0&&(i=0);var a=n.call(this,"container",i,"container",0,null)||this;return a.typ="container",a.b=r,a}var t=e.prototype;return t.r=function(){return!0},t.un=function(){},e})(iy),HW=(function(n){Kp(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r.typ="text",r}var t=e.prototype;return t.r=function(r){var i,a=this,o=!a.b;if(o){var c=ry(a.c),u=(i=a._hyd)===null||i===void 0?void 0:i.splice(0,1)[0];a.b=u||Hd(c).createTextNode(a.t.replace("text_",""))}return r.push(function(){o?a.md():a.ud()}),!0},t.un=function(){M3(this.b)},e})(iy);function $W(n,e,t){var r=t.map(function(u){return si(u)?null:u.key}),i=ek(e.map(function(u){return u.k})),a=ek(r),o=Yp(i,a,function(u){return u});o.removed.forEach(function(u){e.splice(u,1)[0].un()}),o.ordered.forEach(function(u){var d=u[0],h=u[1],p=e.splice(d,1)[0];e.splice(h,0,p);var m=dp(p.b),b=dp(e[h+1]&&e[h+1].b);m&&m.parentNode.insertBefore(m,b)}),o.added.forEach(function(u){e.splice(u,0,rk(t[u],r[u],u,n))});var c=o.maintained.filter(function(u){u[0];var d=u[1],h=t[d],p=e[d],m=si(h)?"text_".concat(h):h.type;return m!==p.t?(p.un(),e.splice(d,1,rk(h,r[d],d,n)),!0):(p.i=d,!1)});return JD(JD([],o.added,!0),c.map(function(u){u[0];var d=u[1];return d}))}function YW(n,e){for(var t=n._ps,r=t.length,i=e.i+1;i<r;++i){var a=dp(t[i].b);if(a)return a}return null}function rk(n,e,t,r){var i=r.d+1;if(si(n)||Td(n))return new HW("text_".concat(n),i,e,t,r,null,{});var a=n.type,o=typeof a=="string"?qW:LW;return new o(a,i,e,t,r,n.ref,n.props)}function Xp(n,e,t,r,i,a,o){var c=$W(n,e,t),u=n._hyd,d=e.filter(function(p,m){return p._hyd=u,p.u(r,i,t[m],a,o)});n.typ==="container"&&n._sel&&e.forEach(function(p){var m=z3(p);m&&(m._sel=!0)}),n._hyd=null;var h=ry(n);return h&&c.reverse().forEach(function(p){var m=e[p],b=dp(m.b);if(b&&h!==b&&!b.parentNode){var _=YW(n,m);h.insertBefore(b,_)}}),d.length>0}function KW(n,e,t,r){t===void 0&&(t=e.__CROACT__),r===void 0&&(r={});var i=!!t;t||(t=new L3(e));var a=[];return Xp(t,t._ps,n?[n]:[],a,r,void 0,void 0),P3(a),oS(null),i||(e.__CROACT__=t),t}function ik(n,e,t){return!t&&n&&(t=new L3(e.parentElement),t._hyd=[e],t._sel=!0),KW(n,e,t),t}function B3(n){var e=O3(),t=e._hs||(e._hs=[]),r=OW(),i=t[r];if(jW(r+1),i){if(!av(i.deps,n.deps))return i.updated=!1,i;t[r]=n}else t.push(n);return n.value=n.func(),n.updated=!0,n}function XW(n,e){var t=B3({func:n,deps:e});return t.value}function WW(n){return XW(function(){return V3(n)},[])}function U3(n,e,t){var r=O3(),i=B3({func:function(){return n},deps:e}),a=t?r._usefs:r._uefs;i.updated?a.push(function(){return i.effect&&i.effect(),i.effect=n(),i.effect}):a.push(function(){return i.effect})}function QW(n,e,t){U3(function(){n?.(e())},t,!0)}function uS(n,e){for(var t=n.length,r=0;r<t;++r)if(e(n[r],r))return!0;return!1}function F3(n,e){for(var t=n.length,r=0;r<t;++r)if(e(n[r],r))return n[r];return null}function G3(n){var e=n;if(typeof e>"u"){if(typeof navigator>"u"||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function dS(n,e){try{return new RegExp(n,"g").exec(e)}catch{return null}}function ZW(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var n=navigator.userAgentData,e=n.brands||n.uaList;return!!(e&&e.length)}function JW(n,e){var t=dS("("+n+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return t?t[3]:""}function N_(n){return n.replace(/_/g,".")}function fh(n,e){var t=null,r="-1";return uS(n,function(i){var a=dS("("+i.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!a||i.brand?!1:(t=i,r=a[3]||"-1",i.versionAlias?r=i.versionAlias:i.versionTest&&(r=JW(i.versionTest.toLowerCase(),e)||r),r=N_(r),!0)}),{preset:t,version:r}}function Lm(n,e){var t={brand:"",version:"-1"};return uS(n,function(r){var i=q3(e,r);return i?(t.brand=r.id,t.version=r.versionAlias||i.version,t.version!=="-1"):!1}),t}function q3(n,e){return F3(n,function(t){var r=t.brand;return dS(""+e.test,r.toLowerCase())})}var H3=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],$3=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],M_=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],Y3=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],K3=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function X3(n){return!!fh(Y3,n).preset}function eQ(n){var e=G3(n),t=!!/mobi/g.exec(e),r={name:"unknown",version:"-1",majorVersion:-1,webview:X3(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},a=fh(H3,e),o=a.preset,c=a.version,u=fh(K3,e),d=u.preset,h=u.version,p=fh($3,e);if(r.chromium=!!p.preset,r.chromiumVersion=p.version,!r.chromium){var m=fh(M_,e);r.webkit=!!m.preset,r.webkitVersion=m.version}return d&&(i.name=d.id,i.version=h,i.majorVersion=parseInt(h,10)),o&&(r.name=o.id,r.version=c,r.webview&&i.name==="ios"&&r.name!=="safari"&&(r.webview=!1)),r.majorVersion=parseInt(r.version,10),{browser:r,os:i,isMobile:t,isHints:!1}}function tQ(n){var e=navigator.userAgentData,t=(e.uaList||e.brands).slice(),r=e.mobile||!1,i=t[0],a=(e.platform||navigator.platform).toLowerCase(),o={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!Lm(Y3,t).brand||X3(G3())},c={name:"unknown",version:"-1",majorVersion:-1};o.webkit=!o.chromium&&uS(M_,function(m){return q3(t,m)});var u=Lm($3,t);if(o.chromium=!!u.brand,o.chromiumVersion=u.version||"-1",!o.chromium){var d=Lm(M_,t);o.webkit=!!d.brand,o.webkitVersion=d.version||"-1"}var h=F3(K3,function(m){return new RegExp(""+m.test,"g").exec(a)});c.name=h?h.id:"";{var p=Lm(H3,t);o.name=p.brand||o.name,o.version=p.brand&&n?n.uaFullVersion:p.version}return o.webkit&&(c.name=r?"ios":"mac"),c.name==="ios"&&o.webview&&(o.version="-1"),c.version=N_(c.version),o.version=N_(o.version),c.majorVersion=parseInt(c.version,10),o.majorVersion=parseInt(o.version,10),{browser:o,os:c,isMobile:r,isHints:!0}}function nQ(n){return ZW()?tQ():eQ(n)}function rQ(n,e,t,r,i,a){for(var o=0;o<i;++o){var c=t+o*i,u=r+o*i;n[c]+=n[u]*a,e[c]+=e[u]*a}}function iQ(n,e,t,r,i){for(var a=0;a<i;++a){var o=t+a*i,c=r+a*i,u=n[o],d=e[o];n[o]=n[c],n[c]=u,e[o]=e[c],e[c]=d}}function aQ(n,e,t,r,i){for(var a=0;a<r;++a){var o=t+a*r;n[o]/=i,e[o]/=i}}function W3(n,e,t){for(var r=n.slice(),i=0;i<t;++i)r[i*t+e-1]=0,r[(e-1)*t+i]=0;return r[(e-1)*(t+1)]=1,r}function rs(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=n.slice(),r=mn(e),i=0;i<e;++i){var a=e*i+i;if(!st(t[a],Jn)){for(var o=i+1;o<e;++o)if(t[e*i+o]){iQ(t,r,i,o,e);break}}if(!st(t[a],Jn))return[];aQ(t,r,i,e,t[a]);for(var o=0;o<e;++o){var c=o,u=o+i*e,d=t[u];!st(d,Jn)||i===o||rQ(t,r,c,i,e,-d)}}return r}function sQ(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=[],r=0;r<e;++r)for(var i=0;i<e;++i)t[i*e+r]=n[e*r+i];return t}function Q3(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=[],r=n[e*e-1],i=0;i<e-1;++i)t[i]=n[e*(e-1)+i]/r;return t[e-1]=0,t}function oQ(n,e){for(var t=mn(e),r=0;r<e-1;++r)t[e*(e-1)+r]=n[r]||0;return t}function Pc(n,e){for(var t=n.slice(),r=n.length;r<e-1;++r)t[r]=0;return t[e-1]=1,t}function ba(n,e,t){if(e===void 0&&(e=Math.sqrt(n.length)),e===t)return n;for(var r=mn(t),i=Math.min(e,t),a=0;a<i-1;++a){for(var o=0;o<i-1;++o)r[a*t+o]=n[a*e+o];r[(a+1)*t-1]=n[(a+1)*e-1],r[(t-1)*t+a]=n[(e-1)*e+a]}return r[t*t-1]=n[e*e-1],r}function sv(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var r=mn(n);return e.forEach(function(i){r=rn(r,i,n)}),r}function rn(n,e,t){t===void 0&&(t=Math.sqrt(n.length));var r=[],i=n.length/t,a=e.length/i;if(i){if(!a)return n}else return e;for(var o=0;o<t;++o)for(var c=0;c<a;++c){r[c*t+o]=0;for(var u=0;u<i;++u)r[c*t+o]+=n[u*t+o]*e[c*i+u]}return r}function Nt(n,e){for(var t=Math.min(n.length,e.length),r=n.slice(),i=0;i<t;++i)r[i]=r[i]+e[i];return r}function Ye(n,e){for(var t=Math.min(n.length,e.length),r=n.slice(),i=0;i<t;++i)r[i]=r[i]-e[i];return r}function lQ(n,e){return e===void 0&&(e=n.length===6),e?[n[0],n[1],0,n[2],n[3],0,n[4],n[5],1]:n}function Z3(n,e){return e===void 0&&(e=n.length===9),e?[n[0],n[1],n[3],n[4],n[6],n[7]]:n}function zr(n,e,t){t===void 0&&(t=e.length);var r=rn(n,e,t),i=r[t-1];return r.map(function(a){return a/i})}function cQ(n,e){return rn(n,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function uQ(n,e){return rn(n,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function dQ(n,e){return rn(n,Qp(e,4))}function Bm(n,e){var t=e[0],r=t===void 0?1:t,i=e[1],a=i===void 0?1:i,o=e[2],c=o===void 0?1:o;return rn(n,[r,0,0,0,0,a,0,0,0,0,c,0,0,0,0,1],4)}function Wp(n,e){return zr(Qp(e,3),Pc(n,3))}function n1(n,e){var t=e[0],r=t===void 0?0:t,i=e[1],a=i===void 0?0:i,o=e[2],c=o===void 0?0:o;return rn(n,[1,0,0,0,0,1,0,0,0,0,1,0,r,a,c,1],4)}function ak(n,e){return rn(n,e,4)}function Qp(n,e){var t=Math.cos(n),r=Math.sin(n),i=mn(e);return i[0]=t,i[1]=r,i[e]=-r,i[e+1]=t,i}function mn(n){for(var e=n*n,t=[],r=0;r<e;++r)t[r]=r%(n+1)?0:1;return t}function fS(n,e){for(var t=mn(e),r=Math.min(n.length,e-1),i=0;i<r;++i)t[(e+1)*i]=n[i];return t}function Oc(n,e){for(var t=mn(e),r=Math.min(n.length,e-1),i=0;i<r;++i)t[e*(e-1)+i]=n[i];return t}function hS(n,e,t,r,i,a,o,c){var u=n[0],d=n[1],h=e[0],p=e[1],m=t[0],b=t[1],_=r[0],w=r[1],S=i[0],T=i[1],A=a[0],D=a[1],O=o[0],M=o[1],j=c[0],C=c[1],I=[u,0,h,0,m,0,_,0,d,0,p,0,b,0,w,0,1,0,1,0,1,0,1,0,0,u,0,h,0,m,0,_,0,d,0,p,0,b,0,w,0,1,0,1,0,1,0,1,-S*u,-T*u,-A*h,-D*h,-O*m,-M*m,-j*_,-C*_,-S*d,-T*d,-A*p,-D*p,-O*b,-M*b,-j*w,-C*w],k=rs(I,8);if(!k.length)return[];var z=rn(k,[S,T,A,D,O,M,j,C],8);return z[8]=1,ba(sQ(z),3,4)}var Nh=function(){return Nh=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Nh.apply(this,arguments)};function fQ(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function fp(n,e){return e===void 0&&(e=0),Uu(Ad(n,e))}function hQ(n,e){var t=zr(n,[e[0],e[1]||0,e[2]||0,1],4),r=t[3]||1;return[t[0]/r,t[1]/r,t[2]/r]}function Uu(n){var e=fQ();return n.forEach(function(t){var r=t.matrixFunction,i=t.functionValue;r&&(e=r(e,i))}),e}function Ad(n,e){e===void 0&&(e=0);var t=nr(n)?n:dl(n);return t.map(function(r){var i=E3(r),a=i.prefix,o=i.value,c=null,u=a,d="";if(a==="translate"||a==="translateX"||a==="translate3d"){var h=ya(e)?Nh(Nh({},e),{"o%":e["%"]}):{"%":e,"o%":e},p=dc(o).map(function(P,J){return J===0&&"x%"in h?h["%"]=e["x%"]:J===1&&"y%"in h?h["%"]=e["y%"]:h["%"]=e["o%"],nn(P,h)}),m=p[0],b=p[1],_=b===void 0?0:b,w=p[2],S=w===void 0?0:w;c=n1,d=[m,_,S]}else if(a==="translateY"){var T=ya(e)?Nh({"%":e["y%"]},e):{"%":e},_=nn(o,T);c=n1,d=[0,_,0]}else if(a==="translateZ"){var S=parseFloat(o);c=n1,d=[0,0,S]}else if(a==="scale"||a==="scale3d"){var A=dc(o).map(function(P){return parseFloat(P)}),D=A[0],O=A[1],M=O===void 0?D:O,j=A[2],C=j===void 0?1:j;c=Bm,d=[D,M,C]}else if(a==="scaleX"){var D=parseFloat(o);c=Bm,d=[D,1,1]}else if(a==="scaleY"){var M=parseFloat(o);c=Bm,d=[1,M,1]}else if(a==="scaleZ"){var C=parseFloat(o);c=Bm,d=[1,1,C]}else if(a==="rotate"||a==="rotateZ"||a==="rotateX"||a==="rotateY"){var I=$p(o),k=I.unit,z=I.value,L=k==="rad"?z:z*Math.PI/180;a==="rotate"||a==="rotateZ"?(u="rotateZ",c=dQ):a==="rotateX"?c=cQ:a==="rotateY"&&(c=uQ),d=L}else if(a==="matrix3d")c=ak,d=dc(o).map(function(P){return parseFloat(P)});else if(a==="matrix"){var B=dc(o).map(function(P){return parseFloat(P)});c=ak,d=[B[0],B[1],0,0,B[2],B[3],0,0,0,0,1,0,B[4],B[5],0,1]}else u="";return{name:a,functionName:u,value:o,matrixFunction:c,functionValue:d}})}var P_=function(n,e){return P_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},P_(n,e)};function pQ(n,e){P_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var J3=typeof Map=="function"?void 0:(function(){var n=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++n)}})(),ej=(function(n){pQ(e,n);function e(t){return t===void 0&&(t=[]),n.call(this,t,J3)||this}return e})(MW);function gQ(n,e){return Yp(n,e,J3)}var O_=function(){return O_=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},O_.apply(this,arguments)};function mQ(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}var ay=(function(){function n(){this._events={}}var e=n.prototype;return e.on=function(t,r){if(ya(t))for(var i in t)this.on(i,t[i]);else this._addEvent(t,r,{});return this},e.off=function(t,r){if(!t)this._events={};else if(ya(t))for(var i in t)this.off(i);else if(!r)this._events[t]=[];else{var a=this._events[t];if(a){var o=$s(a,function(c){return c.listener===r});o>-1&&a.splice(o,1)}}return this},e.once=function(t,r){var i=this;return r&&this._addEvent(t,r,{once:!0}),new Promise(function(a){i._addEvent(t,a,{once:!0})})},e.emit=function(t,r){var i=this;r===void 0&&(r={});var a=this._events[t];if(!t||!a)return!0;var o=!1;return r.eventType=t,r.stop=function(){o=!0},r.currentTarget=this,mQ(a).forEach(function(c){c.listener(r),c.once&&i.off(t,c.listener)}),!o},e.trigger=function(t,r){return r===void 0&&(r={}),this.emit(t,r)},e._addEvent=function(t,r,i){var a=this._events;a[t]=a[t]||[];var o=a[t];o.push(O_({listener:r},i))},n})();var j_=function(n,e){return j_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},j_(n,e)};function vQ(n,e){j_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Ku=function(){return Ku=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Ku.apply(this,arguments)};function yQ(n){var e=n.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function sk(n,e){return n.addEventListener("scroll",e),function(){n.removeEventListener("scroll",e)}}function Um(n){if(n){if(si(n))return document.querySelector(n)}else return null;if(nS(n))return n();if(n instanceof Element)return n;if("current"in n)return n.current;if("value"in n)return n.value}var bQ=(function(n){vQ(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r._startRect=null,r._startPos=[],r._prevTime=0,r._timer=0,r._prevScrollPos=[0,0],r._isWait=!1,r._flag=!1,r._currentOptions=null,r._lock=!1,r._unregister=null,r._onScroll=function(){var i=r._currentOptions;r._lock||!i||r.emit("scrollDrag",{next:function(a){r.checkScroll({container:i.container,inputEvent:a})}})},r}var t=e.prototype;return t.dragStart=function(r,i){var a=Um(i.container);if(!a){this._flag=!1;return}var o=0,c=0,u=0,d=0;if(a===document.body)u=window.innerWidth,d=window.innerHeight;else{var h=a.getBoundingClientRect();o=h.top,c=h.left,u=h.width,d=h.height}this._flag=!0,this._startPos=[r.clientX,r.clientY],this._startRect={top:o,left:c,width:u,height:d},this._prevScrollPos=this._getScrollPosition([0,0],i),this._currentOptions=i,this._registerScrollEvent(i)},t.drag=function(r,i){if(clearTimeout(this._timer),!!this._flag){var a=r.clientX,o=r.clientY,c=i.threshold,u=c===void 0?0:c,d=this,h=d._startRect,p=d._startPos;this._currentOptions=i;var m=[0,0];return h.top>o-u?(p[1]>h.top||o<p[1])&&(m[1]=-1):h.top+h.height<o+u&&(p[1]<h.top+h.height||o>p[1])&&(m[1]=1),h.left>a-u?(p[0]>h.left||a<p[0])&&(m[0]=-1):h.left+h.width<a+u&&(p[0]<h.left+h.width||a>p[0])&&(m[0]=1),!m[0]&&!m[1]?!1:this._continueDrag(Ku(Ku({},i),{direction:m,inputEvent:r,isDrag:!0}))}},t.checkScroll=function(r){var i=this;if(this._isWait)return!1;var a=r.prevScrollPos,o=a===void 0?this._prevScrollPos:a,c=r.direction,u=r.throttleTime,d=u===void 0?0:u,h=r.inputEvent,p=r.isDrag,m=this._getScrollPosition(c||[0,0],r),b=m[0]-o[0],_=m[1]-o[1],w=c||[b?Math.abs(b)/b:0,_?Math.abs(_)/_:0];return this._prevScrollPos=m,this._lock=!1,!b&&!_?!1:(this.emit("move",{offsetX:w[0]?b:0,offsetY:w[1]?_:0,inputEvent:h}),d&&p&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},d)),!0)},t.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},t._getScrollPosition=function(r,i){var a=i.container,o=i.getScrollPosition,c=o===void 0?yQ:o;return c({container:Um(a),direction:r})},t._continueDrag=function(r){var i=this,a,o=r.container,c=r.direction,u=r.throttleTime,d=r.useScroll,h=r.isDrag,p=r.inputEvent;if(!(!this._flag||h&&this._isWait)){var m=up(),b=Math.max(u+this._prevTime-m,0);if(b>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},b),!1;this._prevTime=m;var _=this._getScrollPosition(c,r);this._prevScrollPos=_,h&&(this._isWait=!0),d||(this._lock=!0);var w={container:Um(o),direction:c,inputEvent:p};return(a=r.requestScroll)===null||a===void 0||a.call(r,w),this.emit("scroll",w),this._isWait=!1,d||this.checkScroll(Ku(Ku({},r),{prevScrollPos:_,direction:c,inputEvent:p}))}},t._registerScrollEvent=function(r){this._unregisterScrollEvent();var i=r.checkScrollEvent;if(i){var a=i===!0?sk:i,o=Um(r.container);i===!0&&(o===document.body||o===document.documentElement)?this._unregister=sk(window,this._onScroll):this._unregister=a(o,this._onScroll)}},t._unregisterScrollEvent=function(){var r;(r=this._unregister)===null||r===void 0||r.call(this),this._unregister=null},e})(ay);function xQ(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}function ni(n){return st(n,Jn)}function _Q(n,e){return n.every(function(t,r){return ni(t-e[r])===0})}function wQ(n,e){return!ni(n[0]-e[0])&&!ni(n[1]-e[1])}function tj(n){return n.length<3?0:Math.abs(SW(n.map(function(e,t){var r=n[t+1]||n[0];return e[0]*r[1]-r[0]*e[1]})))/2}function ok(n,e){var t=e.width,r=e.height,i=e.left,a=e.top,o=jc(n),c=o.minX,u=o.minY,d=o.maxX,h=o.maxY,p=t/(d-c),m=r/(h-u);return n.map(function(b){return[i+(b[0]-c)*p,a+(b[1]-u)*m]})}function jc(n){var e=n.map(function(r){return r[0]}),t=n.map(function(r){return r[1]});return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,t),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,t)}}function V_(n,e,t){var r=n[0],i=n[1],a=jc(e),o=a.minX,c=a.maxX,u=[[o,i],[c,i]],d=ov(u[0],u[1]),h=z_(e),p=[];if(h.forEach(function(_){var w=ov(_[0],_[1]),S=_[0];if(_Q(d,w))p.push({pos:n,line:_,type:"line"});else{var T=nj(pS(d,w),[u,_]);T.forEach(function(A){_.some(function(D){return wQ(D,A)})?p.push({pos:A,line:_,type:"point"}):ni(S[1]-i)!==0&&p.push({pos:A,line:_,type:"intersection"})})}}),oi(p,function(_){return _[0]===r}))return!0;var m=0,b={};return p.forEach(function(_){var w=_.pos,S=_.type,T=_.line;if(!(w[0]>r))if(S==="intersection")++m;else{if(S==="line")return;if(S==="point"){var A=oi(T,function(M){return M[1]!==i}),D=b[w[0]],O=A[1]>i?1:-1;D?D!==O&&++m:b[w[0]]=O}}}),m%2===1}function ov(n,e){var t=n[0],r=n[1],i=e[0],a=e[1],o=i-t,c=a-r;Math.abs(o)<Jn&&(o=0),Math.abs(c)<Jn&&(c=0);var u=0,d=0,h=0;return o?c?(u=-c/o,d=1,h=-u*t-r):(d=1,h=-r):c&&(u=-1,h=t),[u,d,h]}function pS(n,e){var t=n[0],r=n[1],i=n[2],a=e[0],o=e[1],c=e[2],u=t===0&&a===0,d=r===0&&o===0,h=[];if(u&&d)return[];if(u){var p=-i/r,m=-c/o;return p!==m?[]:[[-1/0,p],[1/0,p]]}else if(d){var b=-i/t,_=-c/a;return b!==_?[]:[[b,-1/0],[b,1/0]]}else if(t===0){var w=-i/r,S=-(o*w+c)/a;h=[[S,w]]}else if(a===0){var w=-c/o,S=-(r*w+i)/t;h=[[S,w]]}else if(r===0){var S=-i/t,w=-(a*S+c)/o;h=[[S,w]]}else if(o===0){var S=-c/a,w=-(t*S+i)/r;h=[[S,w]]}else{var S=(r*c-o*i)/(o*t-r*a),w=-(t*S+i)/r;h=[[S,w]]}return h.map(function(T){return[T[0],T[1]]})}function nj(n,e){var t=e.map(function(p){return[0,1].map(function(m){return[Math.min(p[0][m],p[1][m]),Math.max(p[0][m],p[1][m])]})}),r=[];if(n.length===2){var i=n[0],a=i[0],o=i[1];if(ni(a-n[1][0])){if(!ni(o-n[1][1])){var d=Math.max.apply(Math,t.map(function(p){return p[0][0]})),h=Math.min.apply(Math,t.map(function(p){return p[0][1]}));if(ni(d-h)>0)return[];r=[[d,o],[h,o]]}}else{var c=Math.max.apply(Math,t.map(function(p){return p[1][0]})),u=Math.min.apply(Math,t.map(function(p){return p[1][1]}));if(ni(c-u)>0)return[];r=[[a,c],[a,u]]}}return r.length||(r=n.filter(function(p){var m=p[0],b=p[1];return t.every(function(_){return 0<=ni(m-_[0][0])&&0<=ni(_[0][1]-m)&&0<=ni(b-_[1][0])&&0<=ni(_[1][1]-b)})})),r.map(function(p){return[ni(p[0]),ni(p[1])]})}function z_(n){return xQ(n.slice(1),[n[0]]).map(function(e,t){return[n[t],e]})}function EQ(n,e){var t=n.slice(),r=e.slice();QD(t)===-1&&t.reverse(),QD(r)===-1&&r.reverse();var i=z_(t),a=z_(r),o=i.map(function(h){return ov(h[0],h[1])}),c=a.map(function(h){return ov(h[0],h[1])}),u=[];o.forEach(function(h,p){var m=i[p],b=[];c.forEach(function(_,w){var S=pS(h,_),T=nj(S,[m,a[w]]);b.push.apply(b,T.map(function(A){return{index1:p,index2:w,pos:A,type:"intersection"}}))}),b.sort(function(_,w){return js(m[0],_.pos)-js(m[0],w.pos)}),u.push.apply(u,b),V_(m[1],r)&&u.push({index1:p,index2:-1,pos:m[1],type:"inside"})}),a.forEach(function(h,p){if(V_(h[1],t)){var m=!1,b=$s(u,function(_){var w=_.index2;return w===p?(m=!0,!1):!!m});b===-1&&(m=!1,b=$s(u,function(_){var w=_.index1,S=_.index2;return w===-1&&S+1===p?(m=!0,!1):!!m})),b===-1?u.push({index1:-1,index2:p,pos:h[1],type:"inside"}):u.splice(b,0,{index1:-1,index2:p,pos:h[1],type:"inside"})}});var d={};return u.filter(function(h){var p=h.pos,m=p[0]+"x"+p[1];return d[m]?!1:(d[m]=!0,!0)})}function SQ(n,e){var t=EQ(n,e);return t.map(function(r){var i=r.pos;return i})}function TQ(n,e){var t=SQ(n,e);return tj(t)}var L_=function(n,e){return L_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},L_(n,e)};function AQ(n,e){L_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Wn=function(){return Wn=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Wn.apply(this,arguments)};function CQ(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=Math.atan2(r,t);return i>=0?i:i+Math.PI*2}function r1(n){return CQ([n[0].clientX,n[0].clientY],[n[1].clientX,n[1].clientY])/Math.PI*180}function IQ(n){return n.touches&&n.touches.length>=2}function Fm(n){return n?n.touches?DQ(n.touches):[rj(n)]:[]}function RQ(n){return n&&(n.type.indexOf("mouse")>-1||"button"in n)}function lk(n,e,t){var r=t.length,i=Mh(n,r),a=i.clientX,o=i.clientY,c=i.originalClientX,u=i.originalClientY,d=Mh(e,r),h=d.clientX,p=d.clientY,m=Mh(t,r),b=m.clientX,_=m.clientY,w=a-h,S=o-p,T=a-b,A=o-_;return{clientX:c,clientY:u,deltaX:w,deltaY:S,distX:T,distY:A}}function i1(n){return Math.sqrt(Math.pow(n[0].clientX-n[1].clientX,2)+Math.pow(n[0].clientY-n[1].clientY,2))}function DQ(n){for(var e=Math.min(n.length,2),t=[],r=0;r<e;++r)t.push(rj(n[r]));return t}function rj(n){return{clientX:n.clientX,clientY:n.clientY}}function Mh(n,e){e===void 0&&(e=n.length);for(var t={clientX:0,clientY:0,originalClientX:0,originalClientY:0},r=Math.min(n.length,e),i=0;i<r;++i){var a=n[i];t.originalClientX+="originalClientX"in a?a.originalClientX:a.clientX,t.originalClientY+="originalClientY"in a?a.originalClientY:a.clientY,t.clientX+=a.clientX,t.clientY+=a.clientY}return e?{clientX:t.clientX/e,clientY:t.clientY/e,originalClientX:t.originalClientX/e,originalClientY:t.originalClientY/e}:t}var a1=(function(){function n(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return n.prototype.getAngle=function(e){return e===void 0&&(e=this.prevClients),r1(e)},n.prototype.getRotation=function(e){return e===void 0&&(e=this.prevClients),r1(e)-r1(this.startClients)},n.prototype.getPosition=function(e,t){e===void 0&&(e=this.prevClients);var r=lk(e||this.prevClients,this.prevClients,this.startClients),i=r.deltaX,a=r.deltaY;return this.movement+=Math.sqrt(i*i+a*a),this.prevClients=e,r},n.prototype.getPositions=function(e){e===void 0&&(e=this.prevClients);for(var t=this.prevClients,r=this.startClients,i=Math.min(this.length,t.length),a=[],o=0;o<i;++o)a[o]=lk([e[o]],[t[o]],[r[o]]);return a},n.prototype.getMovement=function(e){var t=this.movement;if(!e)return t;var r=Mh(e,this.length),i=Mh(this.prevClients,this.length),a=r.clientX-i.clientX,o=r.clientY-i.clientY;return Math.sqrt(a*a+o*o)+t},n.prototype.getDistance=function(e){return e===void 0&&(e=this.prevClients),i1(e)},n.prototype.getScale=function(e){return e===void 0&&(e=this.prevClients),i1(e)/i1(this.startClients)},n.prototype.move=function(e,t){this.startClients.forEach(function(r){r.clientX-=e,r.clientY-=t}),this.prevClients.forEach(function(r){r.clientX-=e,r.clientY-=t})},n})(),ck=["textarea","input"],kQ=(function(n){AQ(e,n);function e(t,r){r===void 0&&(r={});var i=n.call(this)||this;i.options={},i.flag=!1,i.pinchFlag=!1,i.data={},i.isDrag=!1,i.isPinch=!1,i.clientStores=[],i.targets=[],i.prevTime=0,i.doubleFlag=!1,i._useMouse=!1,i._useTouch=!1,i._useDrag=!1,i._dragFlag=!1,i._isTrusted=!1,i._isMouseEvent=!1,i._isSecondaryButton=!1,i._preventMouseEvent=!1,i._prevInputEvent=null,i._isDragAPI=!1,i._isIdle=!0,i._preventMouseEventId=0,i._window=window,i.onDragStart=function(m,b){if(b===void 0&&(b=!0),!(!i.flag&&m.cancelable===!1)){var _=m.type.indexOf("drag")>=-1;if(!(i.flag&&_)){i._isDragAPI=!0;var w=i.options,S=w.container,T=w.pinchOutside,A=w.preventWheelClick,D=w.preventRightClick,O=w.preventDefault,M=w.checkInput,j=w.dragFocusedInput,C=w.preventClickEventOnDragStart,I=w.preventClickEventOnDrag,k=w.preventClickEventByCondition,z=i._useTouch,L=!i.flag;if(i._isSecondaryButton=m.which===3||m.button===2,A&&(m.which===2||m.button===1)||D&&(m.which===3||m.button===2))return i.stop(),!1;if(L){var B=i._window.document.activeElement,P=m.target;if(P){var J=P.tagName.toLowerCase(),Y=ck.indexOf(J)>-1,H=P.isContentEditable;if(Y||H){if(M||!j&&B===P)return!1;if(B&&(B===P||H&&B.isContentEditable&&B.contains(P)))if(j)P.blur();else return!1}else if((O||m.type==="touchstart")&&B){var W=B.tagName.toLowerCase();(B.isContentEditable||ck.indexOf(W)>-1)&&B.blur()}(C||I||k)&&Er(i._window,"click",i._onClick,!0)}i.clientStores=[new a1(Fm(m))],i._isIdle=!1,i.flag=!0,i.isDrag=!1,i._isTrusted=b,i._dragFlag=!0,i._prevInputEvent=m,i.data={},i.doubleFlag=up()-i.prevTime<200,i._isMouseEvent=RQ(m),!i._isMouseEvent&&i._preventMouseEvent&&i._allowMouseEvent();var K=i._preventMouseEvent||i.emit("dragStart",Wn(Wn({data:i.data,datas:i.data,inputEvent:m,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,isTrusted:b,isDouble:i.doubleFlag},i.getCurrentStore().getPosition()),{preventDefault:function(){m.preventDefault()},preventDrag:function(){i._dragFlag=!1}}));K===!1&&i.stop(),i._isMouseEvent&&i.flag&&O&&m.preventDefault()}if(!i.flag)return!1;var de=0;if(L?(i._attchDragEvent(),z&&T&&(de=setTimeout(function(){Er(S,"touchstart",i.onDragStart,{passive:!1})}))):z&&T&&or(S,"touchstart",i.onDragStart),i.flag&&IQ(m)){if(clearTimeout(de),L&&m.touches.length!==m.changedTouches.length)return;i.pinchFlag||i.onPinchStart(m)}}}},i.onDrag=function(m,b){if(i.flag){var _=i.options.preventDefault;!i._isMouseEvent&&_&&m.preventDefault(),i._prevInputEvent=m;var w=Fm(m),S=i.moveClients(w,m,!1);if(i._dragFlag){if(i.pinchFlag||S.deltaX||S.deltaY){var T=i._preventMouseEvent||i.emit("drag",Wn(Wn({},S),{isScroll:!!b,inputEvent:m}));if(T===!1){i.stop();return}}i.pinchFlag&&i.onPinch(m,w)}i.getCurrentStore().getPosition(w,!0)}},i.onDragEnd=function(m){if(i.flag){var b=i.options,_=b.pinchOutside,w=b.container,S=b.preventClickEventOnDrag,T=b.preventClickEventOnDragStart,A=b.preventClickEventByCondition,D=i.isDrag;(S||T||A)&&requestAnimationFrame(function(){i._allowClickEvent()}),!A&&!T&&S&&!D&&i._allowClickEvent(),i._useTouch&&_&&or(w,"touchstart",i.onDragStart),i.pinchFlag&&i.onPinchEnd(m);var O=m?.touches?Fm(m):[],M=O.length;M===0||!i.options.keepDragging?i.flag=!1:i._addStore(new a1(O));var j=i._getPosition(),C=up(),I=!D&&i.doubleFlag;i._prevInputEvent=null,i.prevTime=D||I?0:C,i.flag||(i._dettachDragEvent(),i._preventMouseEvent||i.emit("dragEnd",Wn({data:i.data,datas:i.data,isDouble:I,isDrag:D,isClick:!D,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,inputEvent:m,isTrusted:i._isTrusted},j)),i.clientStores=[],i._isMouseEvent||(i._preventMouseEvent=!0,clearTimeout(i._preventMouseEventId),i._preventMouseEventId=setTimeout(function(){i._preventMouseEvent=!1},200)),i._isIdle=!0)}},i.onBlur=function(){i.onDragEnd()},i._allowClickEvent=function(){or(i._window,"click",i._onClick,!0)},i._onClick=function(m){i._allowClickEvent(),i._allowMouseEvent();var b=i.options.preventClickEventByCondition;b?.(m)||(m.stopPropagation(),m.preventDefault())},i._onContextMenu=function(m){var b=i.options;b.preventRightClick?i.onDragEnd(m):m.preventDefault()},i._passCallback=function(){};var a=[].concat(t),o=a[0];i._window=D3(o)?o:rl(o),i.options=Wn({checkInput:!1,container:o&&!("document"in o)?rl(o):o,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},r);var c=i.options,u=c.container,d=c.events,h=c.checkWindowBlur;if(i._useDrag=d.indexOf("drag")>-1,i._useTouch=d.indexOf("touch")>-1,i._useMouse=d.indexOf("mouse")>-1,i.targets=a,i._useDrag&&a.forEach(function(m){Er(m,"dragstart",i.onDragStart)}),i._useMouse&&(a.forEach(function(m){Er(m,"mousedown",i.onDragStart),Er(m,"mousemove",i._passCallback)}),Er(u,"contextmenu",i._onContextMenu)),h&&Er(rl(),"blur",i.onBlur),i._useTouch){var p={passive:!1};a.forEach(function(m){Er(m,"touchstart",i.onDragStart,p),Er(m,"touchmove",i._passCallback,p)})}return i}return e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(t){return this.getCurrentStore().getMovement(t)+this.clientStores.slice(1).reduce(function(r,i){return r+i.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(t,r,i,a){a===void 0&&(a=!0),this.flag&&(this.clientStores[0].move(t,r),a&&this.onDrag(i,!0))},e.prototype.move=function(t,r){var i=t[0],a=t[1],o=this.getCurrentStore(),c=o.prevClients;return this.moveClients(c.map(function(u){var d=u.clientX,h=u.clientY;return{clientX:d+i,clientY:h+a,originalClientX:d,originalClientY:h}}),r,!0)},e.prototype.triggerDragStart=function(t){this.onDragStart(t,!1)},e.prototype.setEventData=function(t){var r=this.data;for(var i in t)r[i]=t[i];return this},e.prototype.setEventDatas=function(t){return this.setEventData(t)},e.prototype.getCurrentEvent=function(t){return t===void 0&&(t=this._prevInputEvent),Wn(Wn({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:t})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var t=this,r=this.targets,i=this.options.container;this.off(),or(this._window,"blur",this.onBlur),this._useDrag&&r.forEach(function(a){or(a,"dragstart",t.onDragStart)}),this._useMouse&&(r.forEach(function(a){or(a,"mousedown",t.onDragStart)}),or(i,"contextmenu",this._onContextMenu)),this._useTouch&&(r.forEach(function(a){or(a,"touchstart",t.onDragStart)}),or(i,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(t){var r=this,i=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>i)){var a=new a1(Fm(t));this.pinchFlag=!0,this._addStore(a);var o=this.emit("pinchStart",Wn(Wn({data:this.data,datas:this.data,angle:a.getAngle(),touches:this.getCurrentStore().getPositions()},a.getPosition()),{inputEvent:t,isTrusted:this._isTrusted,preventDefault:function(){t.preventDefault()},preventDrag:function(){r._dragFlag=!1}}));o===!1&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(t,r){if(!(!this.flag||!this.pinchFlag||r.length<2)){var i=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",Wn(Wn({data:this.data,datas:this.data,movement:this.getMovement(r),angle:i.getAngle(r),rotation:i.getRotation(r),touches:i.getPositions(r),scale:i.getScale(r),distance:i.getDistance(r)},i.getPosition(r)),{inputEvent:t,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(t){if(this.pinchFlag){var r=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var i=this.getCurrentStore();this.emit("pinchEnd",Wn(Wn({data:this.data,datas:this.data,isPinch:r,touches:i.getPositions()},i.getPosition()),{inputEvent:t}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(t,r,i){var a=this._getPosition(t,i),o=this.isDrag;(a.deltaX||a.deltaY)&&(this.isDrag=!0);var c=!1;return!o&&this.isDrag&&(c=!0),Wn(Wn({data:this.data,datas:this.data},a),{movement:this.getMovement(t),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:r,isTrusted:this._isTrusted,isFirstDrag:c})},e.prototype._addStore=function(t){this.clientStores.splice(0,0,t)},e.prototype._getPosition=function(t,r){var i=this.getCurrentStore(),a=i.getPosition(t,r),o=this.clientStores.slice(1).reduce(function(d,h){var p=h.getPosition();return d.distX+=p.distX,d.distY+=p.distY,d},a),c=o.distX,u=o.distY;return Wn(Wn({},a),{distX:c,distY:u})},e.prototype._attchDragEvent=function(){var t=this._window,r=this.options.container,i={passive:!1};this._isDragAPI&&(Er(r,"dragover",this.onDrag,i),Er(t,"dragend",this.onDragEnd)),this._useMouse&&(Er(r,"mousemove",this.onDrag),Er(t,"mouseup",this.onDragEnd)),this._useTouch&&(Er(r,"touchmove",this.onDrag,i),Er(t,"touchend",this.onDragEnd,i),Er(t,"touchcancel",this.onDragEnd,i))},e.prototype._dettachDragEvent=function(){var t=this._window,r=this.options.container;this._isDragAPI&&(or(r,"dragover",this.onDrag),or(t,"dragend",this.onDragEnd)),this._useMouse&&(or(r,"mousemove",this.onDrag),or(t,"mouseup",this.onDragEnd)),this._useTouch&&(or(r,"touchstart",this.onDragStart),or(r,"touchmove",this.onDrag),or(t,"touchend",this.onDragEnd),or(t,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e})(ay);function NQ(n){for(var e=5381,t=n.length;t;)e=e*33^n.charCodeAt(--t);return e>>>0}var MQ=NQ;function PQ(n){return MQ(n).toString(36)}function OQ(n){if(n&&n.getRootNode){var e=n.getRootNode();if(e.nodeType===11)return e}}function jQ(n,e,t){return t.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(r,i){var a=i.trim();return(a?dc(a):[""]).map(function(o){var c=o.trim();return c.indexOf("@")===0?c:c.indexOf(":global")>-1?c.replace(/\:global/g,""):c.indexOf(":host")>-1?"".concat(c.replace(/\:host/g,".".concat(n))):c?".".concat(n," ").concat(c):".".concat(n)}).join(", ")+" {"})}function VQ(n,e,t,r,i){var a=Hd(r),o=a.createElement("style");return o.setAttribute("type","text/css"),o.setAttribute("data-styled-id",n),o.setAttribute("data-styled-count","1"),t.nonce&&o.setAttribute("nonce",t.nonce),o.innerHTML=jQ(n,e,t),(i||a.head||a.body).appendChild(o),o}function zQ(n){var e="rCS"+PQ(n);return{className:e,inject:function(t,r){r===void 0&&(r={});var i=OQ(t),a=(i||t.ownerDocument||document).querySelector('style[data-styled-id="'.concat(e,'"]'));if(!a)a=VQ(e,n,r,t,i);else{var o=parseFloat(a.getAttribute("data-styled-count"))||0;a.setAttribute("data-styled-count","".concat(o+1))}return{destroy:function(){var c,u=parseFloat(a.getAttribute("data-styled-count"))||0;u<=1?(a.remove?a.remove():(c=a.parentNode)===null||c===void 0||c.removeChild(a),a=null):a.setAttribute("data-styled-count","".concat(u-1))}}}}}var B_=function(){return B_=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},B_.apply(this,arguments)};function LQ(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function ij(n,e){var t=zQ(e),r=t.className;return VW(function(i,a){var o=i.className,c=o===void 0?"":o;i.cspNonce;var u=LQ(i,["className","cspNonce"]),d=WW();return QW(a,function(){return d.current},[]),U3(function(){var h=t.inject(d.current,{nonce:i.cspNonce});return function(){h.destroy()}},[]),ha(n,B_({ref:d,"data-styled-id":r,className:"".concat(c," ").concat(r)},u))})}var U_=function(n,e){return U_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},U_(n,e)};function Zp(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");U_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Z=function(){return Z=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Z.apply(this,arguments)};function BQ(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function UQ(n,e,t,r){var i=arguments.length,a=i<3?e:r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function FQ(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ne(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function Ae(n,e,t){if(arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function Jp(n,e){return Z({events:[],props:[],name:n},e)}var GQ=["n","w","s","e"],gS=["n","w","s","e","nw","ne","sw","se"];function qQ(n,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*n,'px" height="').concat(32*n,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}function HQ(n){var e=qQ(1,n),t=Math.round(n/45)*45%180,r="ns-resize";return t===135?r="nwse-resize":t===45?r="nesw-resize":t===90&&(r="ew-resize"),"cursor:".concat(r,";cursor: url('").concat(e,"') 16 16, ").concat(r,";")}var Yd=nQ(),aj=Yd.browser.webkit,sj=aj&&(function(){var n=typeof window>"u"?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(n.userAgent.toLowerCase());return e?parseFloat(e[1])<605:!1})(),oj=Yd.browser.name,lj=parseInt(Yd.browser.version,10),$Q=oj==="chrome",YQ=Yd.browser.chromium,KQ=parseInt(Yd.browser.chromiumVersion,10)||0,XQ=$Q&&lj>=109||YQ&&KQ>=109,WQ=oj==="firefox",QQ=parseInt(Yd.browser.webkitVersion,10)>=612||lj>=15,mS="moveable-",ZQ=gS.map(function(n){var e="",t="",r="center",i="center",a="calc(var(--moveable-control-padding, 20) * -1px)";return n.indexOf("n")>-1&&(e="top: ".concat(a,";"),i="bottom"),n.indexOf("s")>-1&&(e="top: 0px;",i="top"),n.indexOf("w")>-1&&(t="left: ".concat(a,";"),r="right"),n.indexOf("e")>-1&&(t="left: 0px;",r="left"),'.around-control[data-direction*="'.concat(n,`"] {
        `).concat(t).concat(e,`
        transform-origin: `).concat(r," ").concat(i,`;
    }`)}).join(`
`),JQ=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(ZQ,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(n){return`
.direction[data-rotation="`.concat(n,'"], :global .view-control-rotation').concat(n,` {
`).concat(HQ(n),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(sj?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),eZ=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],F_=1e-4,Kr=1e-7,Gm=1e-9,G_=Math.pow(10,10),uk=-G_,tZ={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},vS={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},cj={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},uj=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function eg(n,e,t,r,i,a){var o,c;a===void 0&&(a="draggable");var u=(c=(o=e.gestos[a])===null||o===void 0?void 0:o.move(t,n.inputEvent))!==null&&c!==void 0?c:{},d=u.originalDatas||u.datas,h=d[a]||(d[a]={});return Z(Z({},u),{isPinch:!!r,parentEvent:!0,datas:h,originalDatas:n.originalDatas})}var Cd=(function(){function n(e){var t;e===void 0&&(e="draggable"),this.ableName=e,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(t={},t[e]={},t)}return n.prototype.dragStart=function(e,t){this.isDrag=!1,this.isFlag=!1;var r=t.originalDatas;return this.datas=r,r[this.ableName]||(r[this.ableName]={}),Z(Z({},this.move(e,t.inputEvent)),{type:"dragstart"})},n.prototype.drag=function(e,t){return this.move([e[0]-this.prevX,e[1]-this.prevY],t)},n.prototype.move=function(e,t){var r,i,a=!1;if(!this.isFlag)this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],r=e[0],i=e[1],this.isFlag=!0;else{var o=this.isDrag;r=this.prevX+e[0],i=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!o&&this.isDrag&&(a=!0)}return this.prevX=r,this.prevY=i,{type:"drag",clientX:r,clientY:i,inputEvent:t,isFirstDrag:a,isDrag:this.isDrag,distX:r-this.startX,distY:i-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},n})();function sd(n,e,t,r){var i=n.length===16,a=i?4:3,o=Gc(n,t,r,a),c=ne(o,4),u=ne(c[0],2),d=u[0],h=u[1],p=ne(c[1],2),m=p[0],b=p[1],_=ne(c[2],2),w=_[0],S=_[1],T=ne(c[3],2),A=T[0],D=T[1],O=ne(Tn(n,e,a),2),M=O[0],j=O[1],C=Math.min(d,m,w,A),I=Math.min(h,b,S,D),k=Math.max(d,m,w,A),z=Math.max(h,b,S,D);d=d-C||0,m=m-C||0,w=w-C||0,A=A-C||0,h=h-I||0,b=b-I||0,S=S-I||0,D=D-I||0,M=M-C||0,j=j-I||0;var L=n[0],B=n[a+1],P=Gr(L*B);return{left:C,top:I,right:k,bottom:z,origin:[M,j],pos1:[d,h],pos2:[m,b],pos3:[w,S],pos4:[A,D],direction:P}}function dj(n,e){var t=e.clientX,r=e.clientY,i=e.datas,a=n.state,o=a.moveableClientRect,c=a.rootMatrix,u=a.is3d,d=a.pos1,h=o.left,p=o.top,m=u?4:3,b=ne(Ye(Dd(c,[t-h,r-p],m),d),2),_=b[0],w=b[1],S=ne(os({datas:i,distX:_,distY:w}),2),T=S[0],A=S[1];return[T,A]}function Fc(n,e){var t=e.datas,r=n.state,i=r.allMatrix,a=r.beforeMatrix,o=r.is3d,c=r.left,u=r.top,d=r.origin,h=r.offsetMatrix,p=r.targetMatrix,m=r.transformOrigin,b=o?4:3;t.is3d=o,t.matrix=i,t.targetMatrix=p,t.beforeMatrix=a,t.offsetMatrix=h,t.transformOrigin=m,t.inverseMatrix=rs(i,b),t.inverseBeforeMatrix=rs(a,b),t.absoluteOrigin=Pc(Nt([c,u],d),b),t.startDragBeforeDist=zr(t.inverseBeforeMatrix,t.absoluteOrigin,b),t.startDragDist=zr(t.inverseMatrix,t.absoluteOrigin,b)}function nZ(n){return sd(n.datas.beforeTransform,[50,50],100,100).direction}function sy(n,e,t){var r=e.datas,i=e.originalDatas.beforeRenderable,a=r.transformIndex,o=i.nextTransforms,c=o.length,u=i.nextTransformAppendedIndexes,d=-1;a===-1?(t==="translate"?d=0:t==="rotate"&&(d=$s(o,function(b){return b.match(/scale\(/g)})),d===-1&&(d=o.length),r.transformIndex=d):oi(u,function(b){return b.index===a&&b.functionName===t})?d=a:d=a+u.filter(function(b){return b.index<a}).length;var h=IJ(o,n.state,d),p=h.targetFunction,m=t==="rotate"?"rotateZ":t;r.beforeFunctionTexts=h.beforeFunctionTexts,r.afterFunctionTexts=h.afterFunctionTexts,r.beforeTransform=h.beforeFunctionMatrix,r.beforeTransform2=h.beforeFunctionMatrix2,r.targetTansform=h.targetFunctionMatrix,r.afterTransform=h.afterFunctionMatrix,r.afterTransform2=h.afterFunctionMatrix2,r.targetAllTransform=h.allFunctionMatrix,p.functionName===m?(r.afterFunctionTexts.splice(0,1),r.isAppendTransform=!1):c>d&&(r.isAppendTransform=!0,i.nextTransformAppendedIndexes=Ae(Ae([],ne(u),!1),[{functionName:t,index:d,isAppend:!0}],!1))}function oy(n,e,t){return"".concat(n.beforeFunctionTexts.join(" ")," ").concat(n.isAppendTransform?t:e," ").concat(n.afterFunctionTexts.join(" "))}function rZ(n){var e=n.datas,t=n.distX,r=n.distY,i=ne(hj({datas:e,distX:t,distY:r}),2),a=i[0],o=i[1],c=fj(e,oQ([a,o],4));return zr(c,Pc([0,0,0],4),4)}function fj(n,e,t){var r=n.beforeTransform,i=n.afterTransform,a=n.beforeTransform2,o=n.afterTransform2,c=n.targetAllTransform,u=t?rn(c,e,4):rn(e,c,4),d=rn(rs(t?a:r,4),u,4),h=rn(d,rs(t?o:i,4),4);return h}function hj(n){var e=n.datas,t=n.distX,r=n.distY,i=e.inverseBeforeMatrix,a=e.is3d,o=e.startDragBeforeDist,c=e.absoluteOrigin,u=a?4:3;return Ye(zr(i,Nt(c,[t,r]),u),o)}function os(n,e){var t=n.datas,r=n.distX,i=n.distY,a=t.inverseBeforeMatrix,o=t.inverseMatrix,c=t.is3d,u=t.startDragBeforeDist,d=t.startDragDist,h=t.absoluteOrigin,p=c?4:3;return Ye(zr(e?a:o,Nt(h,[r,i]),p),e?u:d)}function iZ(n,e){var t=n.datas,r=n.distX,i=n.distY;t.beforeMatrix;var a=t.matrix,o=t.is3d;t.startDragBeforeDist;var c=t.startDragDist,u=t.absoluteOrigin,d=o?4:3;return Ye(zr(a,Nt(c,[r,i]),d),u)}function aZ(n,e,t,r,i,a){return r===void 0&&(r=e),i===void 0&&(i=t),a===void 0&&(a=[0,0]),n?n.map(function(o,c){var u=$p(o),d=u.value,h=u.unit,p=c?i:r,m=c?t:e;if(o==="%"||isNaN(d)){var b=p?a[c]/p:0;return m*b}else if(h!=="%")return d;return m*d/100}):a}function pj(n){var e=[];return n[1]>=0&&(n[0]>=0&&e.push(3),n[0]<=0&&e.push(2)),n[1]<=0&&(n[0]>=0&&e.push(1),n[0]<=0&&e.push(0)),e}function sZ(n,e){return pj(e).map(function(t){return n[t]})}function s1(n,e){var t=(e+1)/2;return[iv(n[0][0],n[1][0],t,1-t),iv(n[0][1],n[1][1],t,1-t)]}function ur(n,e){var t=s1([n[0],n[1]],e[0]),r=s1([n[2],n[3]],e[0]);return s1([t,r],e[1])}function oZ(n,e,t,r,i,a){var o=Gc(e,t,r,i),c=ur(o,a),u=n[0]-c[0],d=n[1]-c[1];return[u,d]}function tg(n,e,t,r){return rn(n,Oh(e,r,t),r)}function lZ(n,e,t,r){var i=n.transformOrigin,a=n.offsetMatrix,o=n.is3d,c=o?4:3,u;if(si(t)){var d=e.beforeTransform,h=e.afterTransform;r?u=ba(fp(t),4,c):u=ba(rn(rn(d,fp([t]),4),h,4),4,c)}else u=t;return tg(a,u,i,c)}function cZ(n,e){var t=n.transformOrigin,r=n.offsetMatrix,i=n.is3d,a=n.targetMatrix,o=n.targetAllTransform,c=i?4:3;return tg(r,rn(o||a,fS(e,c),c),t,c)}function ly(n,e){var t=Kd(e);return{setTransform:function(r,i){i===void 0&&(i=-1),t.startTransforms=nr(r)?r:dl(r),q_(n,e,i)},setTransformIndex:function(r){q_(n,e,r)}}}function cy(n,e,t){var r=Kd(e),i=r.startTransforms;q_(n,e,$s(i,function(a){return a.indexOf("".concat(t,"("))===0}))}function q_(n,e,t){var r=Kd(e),i=e.datas;if(i.transformIndex=t,t!==-1){var a=r.startTransforms[t];if(a){var o=n.state,c=Ad([a],{"x%":function(u){return u/100*o.offsetWidth},"y%":function(u){return u/100*o.offsetHeight}});i.startValue=c[0].functionValue}}}function yS(n,e){var t=Kd(n);t.nextTransforms=dl(e)}function Kd(n){return n.originalDatas.beforeRenderable}function lv(n){var e=n.originalDatas.beforeRenderable;return e.nextTransforms}function qm(n){return(lv(n)||[]).join(" ")}function Hm(n){return Kd(n).nextStyle}function gj(n,e,t,r,i){yS(i,e);var a=Fr.drag(n,eg(i,n.state,t,r)),o=a?a.transform:e;return Z(Z({transform:e,drag:a},$r({transform:o},i)),{afterTransform:o})}function bS(n,e,t,r,i,a){var o=lZ(n.state,i,e,a),c=fZ(n,t,r,o);return c}function mj(n,e,t,r,i,a,o){var c=bS(n,e,t,i,a,o),u=n.state,d=u.left,h=u.top,p=n.props.groupable,m=p?d:0,b=p?h:0,_=Ye(r,c);return Ye(_,[m,b])}function uZ(n,e,t,r,i,a,o){var c=mj(n,e,t,r,i,a,o);return c}function dZ(n,e,t){return[e?-1+n[0]/(e/2):0,t?-1+n[1]/(t/2):0]}function fZ(n,e,t,r){r===void 0&&(r=n.state.allMatrix);var i=n.state,a=i.width,o=i.height,c=i.is3d,u=c?4:3,d=[a/2*(1+e[0])+t[0],o/2*(1+e[1])+t[1]];return Tn(r,d,u)}function hZ(n,e,t){var r=t.fixedDirection,i=t.fixedPosition,a=t.fixedOffset;return mj(n,"rotate(".concat(e,"deg)"),r,i,a,t)}function pZ(n,e,t,r,i,a){var o=n.props.groupable,c=n.state,u=c.transformOrigin,d=c.offsetMatrix,h=c.is3d,p=c.width,m=c.height,b=c.left,_=c.top,w=a.fixedDirection,S=a.nextTargetMatrix||c.targetMatrix,T=h?4:3,A=aZ(i,e,t,p,m,u),D=o?b:0,O=o?_:0,M=tg(d,S,A,T),j=oZ(r,M,e,t,T,w);return Ye(j,[D,O])}function gZ(n,e){return ur(Wi(n.state),e)}function mZ(n,e){var t=n.targetGesto,r=n.controlGesto,i;return t?.isFlag()&&(i=t.getEventData()[e]),!i&&r?.isFlag()&&(i=r.getEventData()[e]),i||{}}function vZ(n){if(n&&n.getRootNode){var e=n.getRootNode();if(e.nodeType===11)return e}}function yZ(n){var e=n("scale"),t=n("rotate"),r=n("translate"),i=[];return r&&r!=="0px"&&r!=="none"&&i.push("translate(".concat(r.split(/\s+/).join(","),")")),t&&t!=="1"&&t!=="none"&&i.push("rotate(".concat(t,")")),e&&e!=="1"&&e!=="none"&&i.push("scale(".concat(e.split(/\s+/).join(","),")")),i}function vj(n,e,t){for(var r=n,i=[],a=aS(n)||xl(n),o=!t&&n===e||n===a,c=o,u=!1,d=3,h,p,m,b=!1,_=pp(e,e,!0).offsetParent,w=1;r&&!c;){c=o;var S=li(r),T=S("position"),A=Uj(r),D=T==="fixed",O=yZ(S),M=lQ(gJ(A)),j=void 0,C=!1,I=!1,k=0,z=0,L=0,B=0,P={hasTransform:!1,fixedContainer:null};D&&(b=!0,P=xJ(r),_=P.fixedContainer);var J=M.length;!u&&(J===16||O.length)&&(u=!0,d=4,W_(i),m&&(m=ba(m,3,4))),u&&J===9&&(M=ba(M,3,4));var Y=bJ(r,n),H=Y.tagName,W=Y.hasOffset,K=Y.isSVG,de=Y.origin,Q=Y.targetOrigin,G=Y.offset,$=ne(G,2),ee=$[0],te=$[1];H==="svg"&&!r.ownerSVGElement&&m&&(i.push({type:"target",target:r,matrix:_J(r,d)}),i.push({type:"offset",target:r,matrix:mn(d)}));var le=parseFloat(S("zoom"))||1;if(D)j=P.fixedContainer,C=!0;else{var fe=pp(r,e,!1,!0,S),oe=fe.offsetZoom;if(j=fe.offsetParent,C=fe.isEnd,I=fe.isStatic,w*=oe,(fe.isCustomElement||oe!==1)&&I)ee-=j.offsetLeft,te-=j.offsetTop;else if(WQ||XQ){var Ee=fe.parentSlotElement;if(Ee){for(var ke=j,Ke=0,Se=0;ke&&vZ(ke);)Ke+=ke.offsetLeft,Se+=ke.offsetTop,ke=ke.offsetParent;ee-=Ke,te-=Se}}}if(aj&&!QQ&&W&&!K&&I&&(T==="relative"||T==="static")&&(ee-=j.offsetLeft,te-=j.offsetTop,o=o||C),D)W&&P.hasTransform&&(L=j.clientLeft,B=j.clientTop);else if(W&&_!==j&&(k=j.clientLeft,z=j.clientTop),W&&j===a){var Ne=Fj(r,!1);ee+=Ne[0],te+=Ne[1]}if(i.push({type:"target",target:r,matrix:Oh(M,d,de)}),O.length&&(i.push({type:"offset",target:r,matrix:mn(d)}),i.push({type:"target",target:r,matrix:Oh(fp(O),d,de)})),W){var Be=r===n,Me=Be?0:r.scrollLeft,He=Be?0:r.scrollTop;i.push({type:"offset",target:r,matrix:Oc([ee-Me+k-L,te-He+z-B],d)})}else i.push({type:"offset",target:r,origin:de});if(le!==1&&i.push({type:"zoom",target:r,matrix:Oh(fS([le,le],d),d,[0,0])}),m||(m=M),h||(h=de),p||(p=Q),c||D)break;r=j,o=C,(!t||r===a)&&(c=o)}return m||(m=mn(d)),h||(h=[0,0]),p||(p=[0,0]),{zoom:w,offsetContainer:_,matrixes:i,targetMatrix:m,transformOrigin:h,targetOrigin:p,is3d:u,hasFixed:b}}var ic=null,ac=null,Xu=null;function Id(n){n?(window.Map&&(ic=new Map,ac=new Map),Xu=[]):(ic=null,Xu=null,ac=null)}function bZ(n){var e=ac?.get(n);if(e)return e;var t=jh(n,!0);return ac&&ac.set(n,t),t}function xZ(n,e){if(Xu){var t=oi(Xu,function(i){return i[0][0]==n&&i[0][1]==e});if(t)return t[1]}var r=vj(n,e,!0);return Xu&&Xu.push([[n,e],r]),r}function li(n){var e=ic?.get(n);if(!e){var t=rl(n).getComputedStyle(n);if(!ic)return function(a){return t[a]};e={style:t,cached:{}},ic.set(n,e)}var r=e.cached,i=e.style;return function(a){return a in r||(r[a]=i[a]),r[a]}}function pa(n,e,t){var r=t.originalDatas;r.groupable=r.groupable||{};var i=r.groupable;i.childDatas=i.childDatas||[];var a=i.childDatas;return n.moveables.map(function(o,c){return a[c]=a[c]||{},a[c][e]=a[c][e]||{},Z(Z({},t),{isRequestChild:!0,datas:a[c][e],originalDatas:a[c]})})}function o1(n,e,t,r,i,a,o){var c=!!t.match(/Start$/g),u=!!t.match(/End$/g),d=i.isPinch,h=i.datas,p=pa(n,e.name,i),m=n.moveables,b=[],_=p.map(function(w,S){var T=m[S],A=T.state,D=A.gestos,O=w;if(c)O=new Cd(o).dragStart(r,w),b.push(O);else{if(D[o]||(D[o]=h.childGestos[S]),!D[o])return;O=eg(w,A,r,d,a,o),b.push(O)}var M=e[t](T,Z(Z({},O),{parentFlag:!0}));return u&&(D[o]=null),M});return c&&(h.childGestos=m.map(function(w){return w.state.gestos[o]})),{eventParams:_,childEvents:b}}function Vs(n,e,t,r,i,a){i===void 0&&(i=function(h,p){return p});var o=!!t.match(/End$/g),c=pa(n,e.name,r),u=n.moveables,d=c.map(function(h,p){var m=u[p],b=h;b=i(m,h);var _=e[t](m,Z(Z({},b),{parentFlag:!0}));return o&&(m.state.gestos={}),_});return d}function cv(n,e,t,r){var i=t.fixedDirection,a=t.fixedPosition,o=r.datas.startPositions||Wi(e.state),c=ur(o,i),u=ne(zr(Qp(-n.rotation/180*Math.PI,3),[c[0]-a[0],c[1]-a[1],1],3),2),d=u[0],h=u[1];return r.datas.originalX=d,r.datas.originalY=h,r}function yj(n,e,t,r){var i=n.getState(),a=i.renderPoses,o=i.rotation,c=i.direction,u=Vc(n.props,e).zoom,d=Ph(o/Math.PI*180),h={},p=n.renderState;p.renderDirectionMap||(p.renderDirectionMap={});var m=p.renderDirectionMap;t.forEach(function(_){var w=_.dir;h[w]=!0});var b=Gr(c);return t.map(function(_){var w=_.data,S=_.classNames,T=_.dir,A=vS[T];if(!A||!h[T])return null;m[T]=!0;var D=(st(d,15)+b*cj[T]+720)%180,O={};return Ys(w).forEach(function(M){O["data-".concat(M)]=w[M]}),r.createElement("div",Z({className:Ge.apply(void 0,Ae(["control","direction",T,e],ne(S),!1)),"data-rotation":D,"data-direction":T},O,{key:"direction-".concat(T),style:hv.apply(void 0,Ae([o,u],ne(A.map(function(M){return a[M]})),!1))}))})}function bj(n,e,t,r){var i=Vc(n.props,t),a=i.renderDirections,o=a===void 0?e:a,c=i.displayAroundControls;if(!o)return[];var u=o===!0?gS:o;return Ae(Ae([],ne(c?Ej(n,r,t,u):[]),!1),ne(yj(n,t,u.map(function(d){return{data:{},classNames:[],dir:d}}),r)),!1)}function hp(n,e,t,r,i,a){for(var o=[],c=6;c<arguments.length;c++)o[c-6]=arguments[c];var u=Fn(t,r),d=e?st(u/Math.PI*180,15)%180:-1;return n.createElement("div",{key:"line-".concat(a),className:Ge.apply(void 0,Ae(["line","direction",e?"edge":"",e],ne(o),!1)),"data-rotation":d,"data-line-key":a,"data-direction":e,style:ph(t,r,i,u)})}function xj(n,e,t,r,i){var a=t===!0?GQ:t;return a.map(function(o,c){var u=ne(vS[o],2),d=u[0],h=u[1];if(h!=null)return hp(n,o,r[d],r[h],i,"".concat(e,"Edge").concat(c),e)}).filter(Boolean)}function _j(n){return function(e,t){var r=Vc(e.props,n).edge;return r&&(r===!0||r.length)?Ae(Ae([],ne(xj(t,n,r,e.getState().renderPoses,e.props.zoom)),!1),ne(_Z(e,n,t)),!1):wj(e,n,t)}}function wj(n,e,t){return bj(n,gS,e,t)}function _Z(n,e,t){return bj(n,["nw","ne","sw","se"],e,t)}function Ej(n,e,t,r){var i=n.renderState;i.renderDirectionMap||(i.renderDirectionMap={});var a=n.getState(),o=a.renderPoses,c=a.rotation,u=a.direction,d=i.renderDirectionMap,h=n.props.zoom,p=Gr(u),m=c/Math.PI*180;return(r||Ys(d)).map(function(b){var _=vS[b];if(!_)return null;var w=(st(m,15)+p*cj[b]+720)%180,S=["around-control"];return t&&S.push("direction",t),e.createElement("div",{className:Ge.apply(void 0,Ae([],ne(S),!1)),"data-rotation":w,"data-direction":b,key:"direction-around-".concat(b),style:hv.apply(void 0,Ae([c,h],ne(_.map(function(T){return o[T]})),!1))})})}function xS(n,e,t){var r=n||{},i=r.position,a=i===void 0?"client":i,o=r.left,c=o===void 0?-1/0:o,u=r.top,d=u===void 0?-1/0:u,h=r.right,p=h===void 0?1/0:h,m=r.bottom,b=m===void 0?1/0:m,_={position:a,left:c,top:d,right:p,bottom:b};return{vertical:dk(_,e,!0),horizontal:dk(_,t,!1)}}function uy(n,e){var t=n.state,r=t.containerClientRect,i=r.clientHeight,a=r.clientWidth,o=r.clientLeft,c=r.clientTop,u=t.snapOffset,d=u.left,h=u.top,p=u.right,m=u.bottom,b=e||n.props.bounds||{},_=b.position||"client",w=_==="css",S=b.left,T=S===void 0?-1/0:S,A=b.top,D=A===void 0?-1/0:A,O=b.right,M=O===void 0?w?-1/0:1/0:O,j=b.bottom,C=j===void 0?w?-1/0:1/0:j;return w&&(M=a+p-d-M,C=i+m-h-C),{left:T+d-o,right:M+d-o,top:D+h-c,bottom:C+h-c}}function wZ(n,e,t){var r=uy(n),i=r.left,a=r.top,o=r.right,c=r.bottom,u=ne(t,2),d=u[0],h=u[1],p=ne(Ye(t,e),2),m=p[0],b=p[1];xe(m)<Kr&&(m=0),xe(b)<Kr&&(b=0);var _=b>0,w=m>0,S={isBound:!1,offset:0,pos:0},T={isBound:!1,offset:0,pos:0};if(m===0&&b===0)return{vertical:S,horizontal:T};if(m===0)_?c<h&&(T.pos=c,T.offset=h-c):a>h&&(T.pos=a,T.offset=h-a);else if(b===0)w?o<d&&(S.pos=o,S.offset=d-o):i>d&&(S.pos=i,S.offset=d-i);else{var A=b/m,D=t[1]-A*d,O=0,M=0,j=!1;w&&o<=d?(O=A*o+D,M=o,j=!0):!w&&d<=i&&(O=A*i+D,M=i,j=!0),j&&(O<a||O>c)&&(j=!1),j||(_&&c<=h?(O=c,M=(O-D)/A,j=!0):!_&&h<=a&&(O=a,M=(O-D)/A,j=!0)),j&&(S.isBound=!0,S.pos=M,S.offset=d-M,T.isBound=!0,T.pos=O,T.offset=h-O)}return{vertical:S,horizontal:T}}function dk(n,e,t){var r=n[t?"left":"top"],i=n[t?"right":"bottom"],a=Math.min.apply(Math,Ae([],ne(e),!1)),o=Math.max.apply(Math,Ae([],ne(e),!1)),c=[];return r+1>a&&c.push({direction:"start",isBound:!0,offset:a-r,pos:r}),i-1<o&&c.push({direction:"end",isBound:!0,offset:o-i,pos:i}),c.length||c.push({isBound:!1,offset:0,pos:0}),c.sort(function(u,d){return xe(d.offset)-xe(u.offset)})}function fk(n,e,t){var r=t?n.map(function(i){return Wp(i,t)}):n;return r.some(function(i){return i[0]<e.left&&xe(i[0]-e.left)>.1||i[0]>e.right&&xe(i[0]-e.right)>.1||i[1]<e.top&&xe(i[1]-e.top)>.1||i[1]>e.bottom&&xe(i[1]-e.bottom)>.1})}function EZ(n,e,t){var r=Xi(n),i=Math.sqrt(r*r-e*e)||0;return[i,-i].sort(function(a,o){return xe(a-n[t?0:1])-xe(o-n[t?0:1])}).map(function(a){return Fn([0,0],t?[a,e]:[e,a])})}function SZ(n,e,t,r,i){if(!n.props.bounds)return[];var a=i*Math.PI/180,o=uy(n),c=o.left,u=o.top,d=o.right,h=o.bottom,p=c-r[0],m=d-r[0],b=u-r[1],_=h-r[1],w={left:p,top:b,right:m,bottom:_};if(!fk(t,w,0))return[];var S=[];return[[p,0],[m,0],[b,1],[_,1]].forEach(function(T){var A=ne(T,2),D=A[0],O=A[1];t.forEach(function(M){var j=Fn([0,0],M);S.push.apply(S,Ae([],ne(EZ(M,D,O).map(function(C){return a+C-j}).filter(function(C){return!fk(e,w,C)}).map(function(C){return st(C*180/Math.PI,Kr)})),!1))})}),S}var TZ=["left","right","center"],AZ=["top","bottom","middle"],hk={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},fl={start:"left",end:"right",center:"center"},hl={start:"top",end:"bottom",center:"middle"};function Wu(){return{left:!1,top:!1,right:!1,bottom:!1}}function Xd(n,e){var t=n.props,r=t.snappable,i=t.bounds,a=t.innerBounds,o=t.verticalGuidelines,c=t.horizontalGuidelines,u=t.snapGridWidth,d=t.snapGridHeight,h=n.state,p=h.guidelines,m=h.enableSnap;return!r||!m||e&&r!==!0&&r.indexOf(e)<0?!1:!!(u||d||i||a||p&&p.length||o&&o.length||c&&c.length)}function _S(n){return n===!1?{}:n===!0||!n?{left:!0,right:!0,top:!0,bottom:!0}:n}function CZ(n,e){var t=_S(n),r={};for(var i in t)i in e&&t[i]&&(r[i]=e[i]);return r}function wS(n,e){var t=CZ(n,e),r=AZ.filter(function(a){return a in t}),i=TZ.filter(function(a){return a in t});return{horizontalNames:r,verticalNames:i,horizontal:r.map(function(a){return t[a]}),vertical:i.map(function(a){return t[a]})}}function IZ(n,e,t){var r=Tn(n,[e.clientLeft,e.clientTop],t);return[e.left+r[0],e.top+r[1]]}function RZ(n){var e=ne(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];Math.abs(i)<Jn&&(i=0),Math.abs(a)<Jn&&(a=0);var o=0,c=0,u=0;return i?a?(o=-a/i,c=1,u=o*t[0]-t[1]):(c=1,u=-t[1]):(o=-1,u=t[0]),[o,c,u].map(function(d){return st(d,Jn)})}var Sj="snapRotationThreshold",Tj="snapRotationDegrees",Aj="snapHorizontalThreshold",Cj="snapVerticalThreshold";function dy(n,e,t,r,i,a,o){var c;r===void 0&&(r=[]),i===void 0&&(i=[]);var u=n.props,d=((c=n.state.snapThresholdInfo)===null||c===void 0?void 0:c.multiples)||[1,1],h=Ik(o,u[Aj],5),p=Ik(a,u[Cj],5);return Ij(n.state.guidelines,e,t,r,i,h,p,d)}function Ij(n,e,t,r,i,a,o,c){return{vertical:gk(n,"vertical",e,o*c[0],r),horizontal:gk(n,"horizontal",t,a*c[1],i)}}function DZ(n,e,t){var r=ne(t,2),i=r[0],a=r[1],o=ne(e,2),c=o[0],u=o[1],d=ne(Ye(t,e),2),h=d[0],p=d[1],m=p>0,b=h>0;h=pv(h),p=pv(p);var _={isSnap:!1,offset:0,pos:0},w={isSnap:!1,offset:0,pos:0};if(h===0&&p===0)return{vertical:_,horizontal:w};var S=dy(n,h?[i]:[],p?[a]:[],[],[],void 0,void 0),T=S.vertical,A=S.horizontal;T.posInfos.filter(function(H){var W=H.pos;return b?W>=c:W<=c}),A.posInfos.filter(function(H){var W=H.pos;return m?W>=u:W<=u}),T.isSnap=T.posInfos.length>0,A.isSnap=A.posInfos.length>0;var D=H_(T),O=D.isSnap,M=D.guideline,j=H_(A),C=j.isSnap,I=j.guideline,k=C?I.pos[1]:0,z=O?M.pos[0]:0;if(h===0)C&&(w.isSnap=!0,w.pos=I.pos[1],w.offset=a-w.pos);else if(p===0)O&&(_.isSnap=!0,_.pos=z,_.offset=i-z);else{var L=p/h,B=t[1]-L*i,P=0,J=0,Y=!1;O?(J=z,P=L*J+B,Y=!0):C&&(P=k,J=(P-B)/L,Y=!0),Y&&(_.isSnap=!0,_.pos=J,_.offset=i-J,w.isSnap=!0,w.pos=P,w.offset=a-P)}return{vertical:_,horizontal:w}}function Ko(n){var e="";return n===-1||n==="top"||n==="left"?e="start":n===0||n==="center"||n==="middle"?e="center":(n===1||n==="right"||n==="bottom")&&(e="end"),e}function pk(n,e,t,r){var i=wS(n.props.snapDirections,e),a=dy(n,i.vertical,i.horizontal,i.verticalNames.map(function(u){return Ko(u)}),i.horizontalNames.map(function(u){return Ko(u)}),t,r),o=Ko(i.horizontalNames[a.horizontal.index]),c=Ko(i.verticalNames[a.vertical.index]);return{vertical:Z(Z({},a.vertical),{direction:c}),horizontal:Z(Z({},a.horizontal),{direction:o})}}function H_(n){var e=n.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var t=n.posInfos[0],r=t.guidelineInfos[0],i=r.offset,a=r.dist,o=r.guideline;return{isSnap:e,offset:i,dist:a,pos:t.pos,guideline:o}}function gk(n,e,t,r,i){var a,o;if(i===void 0&&(i=[]),!n||!n.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var c=e==="vertical",u=c?0:1,d=t.map(function(p,m){var b=i[m]||"",_=n.map(function(w){var S=w.pos,T=p-S[u];return{offset:T,dist:xe(T),guideline:w,direction:b}}).filter(function(w){var S=w.guideline,T=w.dist,A=S.type;return!(A!==e||T>r)}).sort(function(w,S){return w.dist-S.dist});return{pos:p,index:m,guidelineInfos:_,direction:b}}).filter(function(p){return p.guidelineInfos.length>0}).sort(function(p,m){return p.guidelineInfos[0].dist-m.guidelineInfos[0].dist}),h=d.length>0;return{isSnap:h,index:h?d[0].index:-1,direction:(o=(a=d[0])===null||a===void 0?void 0:a.direction)!==null&&o!==void 0?o:"",posInfos:d}}function kZ(n,e,t,r,i){var a=[];t[0]&&t[1]?a=[t,[-t[0],t[1]],[t[0],-t[1]]]:!t[0]&&!t[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(m,b,_){var w=_[b+1]||_[0];a.push(m),a.push([(m[0]+w[0])/2,(m[1]+w[1])/2])}):n.props.keepRatio?a.push([-1,-1],[-1,1],[1,-1],[1,1],t):(a.push.apply(a,Ae([],ne(sZ([[-1,-1],[1,-1],[-1,-1],[1,1]],t)),!1)),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var o=a.map(function(m){return ur(e,m)}),c=o.map(function(m){return m[0]}),u=o.map(function(m){return m[1]}),d=dy(n,c,u,a.map(function(m){return Ko(m[0])}),a.map(function(m){return Ko(m[1])}),r,i),h=Ko(a.map(function(m){return m[0]})[d.vertical.index]),p=Ko(a.map(function(m){return m[1]})[d.horizontal.index]);return{vertical:Z(Z({},d.vertical),{direction:h}),horizontal:Z(Z({},d.horizontal),{direction:p})}}function Rj(n,e){var t=xe(n.offset),r=xe(e.offset);return n.isBound&&e.isBound?r-t:n.isBound?-1:e.isBound?1:n.isSnap&&e.isSnap?r-t:n.isSnap?-1:e.isSnap||t<Kr?1:r<Kr?-1:t-r}function uv(n,e){return n.slice().sort(function(t,r){var i=t.sign[e],a=r.sign[e],o=t.offset[e],c=r.offset[e];if(i){if(!a)return-1}else return 1;return Rj({isBound:t.isBound,isSnap:t.isSnap,offset:o},{isBound:r.isBound,isSnap:r.isSnap,offset:c})})[0]}function NZ(n,e,t){var r=[];if(t)xe(e[0])!==1||xe(e[1])!==1?r.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):r.push([e,[n[0],-n[1]]],[e,[-n[0],n[1]]]),r.push([e,n]);else if(n[0]&&n[1]||!n[0]&&!n[1]){var i=n[0]?n:[1,1];[1,-1].forEach(function(o){[1,-1].forEach(function(c){var u=[o*i[0],c*i[1]];e[0]===u[0]&&e[1]===u[1]||r.push([e,u])})})}else if(n[0]){var a=xe(e[0])===1?[1]:[1,-1];a.forEach(function(o){r.push([[e[0],-1],[o*n[0],-1]],[[e[0],0],[o*n[0],0]],[[e[0],1],[o*n[0],1]])})}else if(n[1]){var a=xe(e[1])===1?[1]:[1,-1];a.forEach(function(c){r.push([[-1,e[1]],[-1,c*n[1]]],[[0,e[1]],[0,c*n[1]]],[[1,e[1]],[1,c*n[1]]])})}return r}function Dj(n,e){var t=D_([e[0][0],e[1][0]]),r=D_([e[0][1],e[1][1]]);return{vertical:t<=n[0],horizontal:r<=n[1]}}function ES(n,e){var t=ne(e,2),r=t[0],i=t[1],a=i[0]-r[0],o=i[1]-r[1];xe(a)<Kr&&(a=0),xe(o)<Kr&&(o=0);var c,u;if(!a)c=r[0],u=n[0];else if(!o)c=r[1],u=n[1];else{var d=o/a;c=d*(n[0]-r[0])+r[1],u=n[1]}return c-u}function kj(n,e,t,r){return r===void 0&&(r=Kr),n.every(function(i){var a=ES(i,e),o=a<=0;return o===t||xe(a)<=r})}function mk(n,e,t,r,i){return i===void 0&&(i=0),r&&e-i<=n||!r&&n<=t+i?{isBound:!0,offset:r?e-n:t-n}:{isBound:!1,offset:0}}function MZ(n,e){var t=e.line,r=e.centerSign,i=e.verticalSign,a=e.horizontalSign,o=e.lineConstants,c=n.props.innerBounds;if(!c)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var u=c.left,d=c.top,h=c.width,p=c.height,m=[[u,d],[u,d+p]],b=[[u,d],[u+h,d]],_=[[u+h,d],[u+h,d+p]],w=[[u,d+p],[u+h,d+p]];if(kj([[u,d],[u+h,d],[u,d+p],[u+h,d+p]],t,r))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var S=Xo(t,o,b,i),T=Xo(t,o,w,i),A=Xo(t,o,m,a),D=Xo(t,o,_,a),O=S.isBound&&T.isBound,M=S.isBound||T.isBound,j=A.isBound&&D.isBound,C=A.isBound||D.isBound,I=Rd(S.offset,T.offset),k=Rd(A.offset,D.offset),z=[0,0],L=!1,B=!1;return xe(k)<xe(I)?(z=[I,0],L=M,B=O):(z=[0,k],L=C,B=j),{isAllBound:B,isVerticalBound:M,isHorizontalBound:C,isBound:L,offset:z}}function Xo(n,e,t,r,i,a){var o=ne(e,2),c=o[0],u=o[1],d=n[0],h=t[0],p=t[1],m=pv(p[1]-h[1]),b=pv(p[0]-h[0]),_=u,w=c,S=-c/u;if(b){if(!m){if(a&&!_)return{isBound:!1,offset:0};if(w){var O=(h[1]-d[1])/S+d[0];return mk(O,h[0],p[0],r,i)}else{var A=h[1]-d[1],D=xe(A)<=(i||0);return{isBound:D,offset:D?A:0}}}}else{if(a&&!w)return{isBound:!1,offset:0};if(_){var T=S*(h[0]-d[0])+d[1];return mk(T,h[1],p[1],r,i)}else{var A=h[0]-d[0],D=xe(A)<=(i||0);return{isBound:D,offset:D?A:0}}}return{isBound:!1,offset:0}}function Nj(n,e,t){return e.map(function(r){var i=MZ(n,r),a=i.isBound,o=i.offset,c=i.isVerticalBound,u=i.isHorizontalBound,d=r.multiple,h=os({datas:t,distX:o[0],distY:o[1]}).map(function(p,m){return p*(d[m]?2/d[m]:0)});return{sign:d,isBound:a,isVerticalBound:c,isHorizontalBound:u,isSnap:!1,offset:h}})}function PZ(n,e,t){var r,i=SS(n,e,[0,0],!1).map(function(m){return Z(Z({},m),{multiple:m.multiple.map(function(b){return xe(b)*2})})}),a=Nj(n,i,t),o=uv(a,0),c=uv(a,1),u=0,d=0,h=o.isVerticalBound||c.isVerticalBound,p=o.isHorizontalBound||c.isHorizontalBound;return(h||p)&&(r=ne(iZ({datas:t,distX:-o.offset[0],distY:-c.offset[1]}),2),u=r[0],d=r[1]),{vertical:{isBound:h,offset:u},horizontal:{isBound:p,offset:d}}}function OZ(n,e){var t=[],r=n[0],i=n[1];return r&&i?t.push([[0,i*2],n,[-r,i]],[[r*2,0],n,[r,-i]]):r?(t.push([[r*2,0],[r,1],[r,-1]]),e&&t.push([[0,-1],[r,-1],[-r,-1]],[[0,1],[r,1],[-r,1]])):i?(t.push([[0,i*2],[1,i],[-1,i]]),e&&t.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):t.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),t}function SS(n,e,t,r){var i=n.state,a=i.allMatrix,o=i.is3d,c=Gc(a,100,100,o?4:3),u=ur(c,[0,0]);return OZ(t,r).map(function(d){var h=ne(d,3),p=h[0],m=h[1],b=h[2],_=[ur(c,m),ur(c,b)],w=RZ(_),S=Dj(u,_),T=S.vertical,A=S.horizontal,D=ES(u,_)<=0;return{multiple:p,centerSign:D,verticalSign:T,horizontalSign:A,lineConstants:w,line:[ur(e,m),ur(e,b)]}})}function vk(n,e,t,r){var i=r?n.map(function(a){return Wp(a,r)}):n;return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some(function(a){var o=ES(t,a)<=0;return!kj(e,a,o)})}function jZ(n){var e=ne(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];if(!i)return xe(t[0]);if(!a)return xe(t[1]);var o=a/i;return xe((-o*t[0]+t[1])/Math.sqrt(Math.pow(o,2)+1))}function VZ(n){var e=ne(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];if(!i)return[t[0],0];if(!a)return[0,t[1]];var o=a/i,c=-o*t[0]+t[1];return[-c/(o+1/o),c/(o*o+1)]}function zZ(n,e,t,r,i){var a=n.props.innerBounds,o=i*Math.PI/180;if(!a)return[];var c=a.left,u=a.top,d=a.width,h=a.height,p=c-r[0],m=c+d-r[0],b=u-r[1],_=u+h-r[1],w=[[p,b],[m,b],[p,_],[m,_]],S=ur(t,[0,0]);if(!vk(t,w,S,0))return[];var T=[],A=w.map(function(D){return[Xi(D),Fn([0,0],D)]});return[[t[0],t[1]],[t[1],t[3]],[t[3],t[2]],[t[2],t[0]]].forEach(function(D){var O=Fn([0,0],VZ(D)),M=jZ(D);T.push.apply(T,Ae([],ne(A.filter(function(j){var C=ne(j,1),I=C[0];return I&&M<=I}).map(function(j){var C=ne(j,2),I=C[0],k=C[1],z=Math.acos(I?M/I:0),L=k+z,B=k-z;return[o+L-O,o+B-O]}).reduce(function(j,C){return j.push.apply(j,Ae([],ne(C),!1)),j},[]).filter(function(j){return!vk(e,w,S,j)}).map(function(j){return st(j*180/Math.PI,Kr)})),!1))}),T}function LZ(n){var e=n.props.innerBounds,t=Wu();if(!e)return{boundMap:t,vertical:[],horizontal:[]};var r=n.getRect(),i=r.pos1,a=r.pos2,o=r.pos3,c=r.pos4,u=[i,a,o,c],d=ur(u,[0,0]),h=e.left,p=e.top,m=e.width,b=e.height,_=[[h,p],[h,p+b]],w=[[h,p],[h+m,p]],S=[[h+m,p],[h+m,p+b]],T=[[h,p+b],[h+m,p+b]],A=SS(n,u,[0,0],!1),D=[],O=[];return A.forEach(function(M){var j=M.line,C=M.lineConstants,I=Dj(d,j),k=I.horizontal,z=I.vertical,L=Xo(j,C,w,z,1,!0),B=Xo(j,C,T,z,1,!0),P=Xo(j,C,_,k,1,!0),J=Xo(j,C,S,k,1,!0);L.isBound&&!t.top&&(D.push(p),t.top=!0),B.isBound&&!t.bottom&&(D.push(p+b),t.bottom=!0),P.isBound&&!t.left&&(O.push(h),t.left=!0),J.isBound&&!t.right&&(O.push(h+m),t.right=!0)}),{boundMap:t,horizontal:D,vertical:O}}function BZ(n,e,t,r){var i=e[0]-n[0],a=e[1]-n[1];if(xe(i)<Jn&&(i=0),xe(a)<Jn&&(a=0),!i)return r?[0,0]:[0,t];if(!a)return r?[t,0]:[0,0];var o=a/i,c=n[1]-o*n[0];if(r){var u=o*(e[0]+t)+c;return[t,u-e[1]]}else{var d=(e[1]+t-c)/o;return[d-e[0],t]}}function $_(n,e,t,r,i){var a=BZ(n,e,t,r);if(!a)return{isOutside:!1,offset:[0,0]};var o=js(n,e),c=js(a,n),u=js(a,e),d=c>o||u>o,h=ne(os({datas:i,distX:a[0],distY:a[1]}),2),p=h[0],m=h[1];return{offset:[p,m],isOutside:d}}function dv(n,e){return n.isBound?n.offset:e.isSnap?H_(e).offset:0}function UZ(n,e,t,r,i){var a=ne(e,2),o=a[0],c=a[1],u=ne(t,2),d=u[0],h=u[1],p=ne(r,2),m=p[0],b=p[1],_=ne(i,2),w=_[0],S=_[1],T=-w,A=-S;if(n&&o&&c){T=0,A=0;var D=[];if(d&&h?D.push([0,S],[w,0]):d?D.push([w,0]):h?D.push([0,S]):m&&b?D.push([0,S],[w,0]):m?D.push([w,0]):b&&D.push([0,S]),D.length){D.sort(function(C,I){return Xi(Ye([o,c],C))-Xi(Ye([o,c],I))});var O=D[0];if(O[0]&&xe(o)>Jn)T=-O[0],A=c*xe(o+T)/xe(o)-c;else if(O[1]&&xe(c)>Jn){var M=c;A=-O[1],T=o*xe(c+A)/xe(M)-o}if(n&&h&&d)if(xe(T)>Jn&&xe(T)<xe(w)){var j=xe(w)/xe(T);T*=j,A*=j}else if(xe(A)>Jn&&xe(A)<xe(S)){var j=xe(S)/xe(A);T*=j,A*=j}else T=Rd(-w,T),A=Rd(-S,A)}}else T=o||d?-w:0,A=c||h?-S:0;return[T,A]}function FZ(n,e,t,r,i,a){if(!Xd(n,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var o=CS(a.absolutePoses,[e,t]),c=Yi(o),u=c.left,d=c.right,h=c.top,p=c.bottom,m={horizontal:o.map(function(J){return J[1]}),vertical:o.map(function(J){return J[0]})},b=_S(n.props.snapDirections),_=wS(b,{left:u,right:d,top:h,bottom:p,center:(u+d)/2,middle:(h+p)/2}),w=fy(n,i,_,m),S=w.vertical,T=w.horizontal,A=PZ(n,o,a),D=A.vertical,O=A.horizontal,M=S.isSnap,j=T.isSnap,C=S.isBound||D.isBound,I=T.isBound||O.isBound,k=Rd(S.offset,D.offset),z=Rd(T.offset,O.offset),L=ne(UZ(r,[e,t],[C,I],[M,j],[k,z]),2),B=L[0],P=L[1];return[{isBound:C,isSnap:M,offset:B},{isBound:I,isSnap:j,offset:P}]}function fy(n,e,t,r){r===void 0&&(r=t);var i=xS(uy(n),r.vertical,r.horizontal),a=i.horizontal,o=i.vertical,c=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:dy(n,t.vertical,t.horizontal,void 0,void 0,void 0,void 0),u=c.horizontal,d=c.vertical,h=dv(a[0],u),p=dv(o[0],d),m=xe(h),b=xe(p);return{horizontal:{isBound:a[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:h,dist:m,bounds:a,snap:u},vertical:{isBound:o[0].isBound,isSnap:d.isSnap,snapIndex:d.index,offset:p,dist:b,bounds:o,snap:d}}}function yk(n,e,t,r,i,a,o){o===void 0&&(o=[1,1]);var c=xS(e,t,r),u=c.horizontal,d=c.vertical,h=Ij(n,t,r,[],[],i,a,o),p=h.horizontal,m=h.vertical,b=dv(u[0],p),_=dv(d[0],m),w=xe(b),S=xe(_);return{horizontal:{isBound:u[0].isBound,isSnap:p.isSnap,snapIndex:p.index,offset:b,dist:w,bounds:u,snap:p},vertical:{isBound:d[0].isBound,isSnap:m.isSnap,snapIndex:m.index,offset:_,dist:S,bounds:d,snap:m}}}function GZ(n,e,t,r){var i=Fn(n,e)/Math.PI*180,a=t.vertical,o=a.isBound,c=a.isSnap,u=a.dist,d=t.horizontal,h=d.isBound,p=d.isSnap,m=d.dist,b=i%180,_=b<3||b>177,w=b>87&&b<93;return m<u&&(o||c&&!w&&(!r||!_))?"vertical":h||p&&!_&&(!r||!w)?"horizontal":""}function qZ(n,e,t,r,i,a){return t.map(function(o){var c=ne(o,2),u=c[0],d=c[1],h=ur(e,u),p=ur(e,d),m=r?HZ(n,h,p,i):fy(n,i,{vertical:[p[0]],horizontal:[p[1]]}),b=m.horizontal,_=b.offset,w=b.isBound,S=b.isSnap,T=m.vertical,A=T.offset,D=T.isBound,O=T.isSnap,M=Ye(d,u);if(!A&&!_)return{isBound:D||w,isSnap:O||S,sign:M,offset:[0,0]};var j=GZ(h,p,m,r);if(!j)return{sign:M,isBound:!1,isSnap:!1,offset:[0,0]};var C=j==="vertical",I=[0,0];return!r&&xe(d[0])===1&&xe(d[1])===1&&u[0]!==d[0]&&u[1]!==d[1]?I=os({datas:a,distX:-A,distY:-_}):I=$_(h,p,-(C?A:_),C,a).offset,I=I.map(function(k,z){return k*(M[z]?2/M[z]:0)}),{sign:M,isBound:C?D:w,isSnap:C?O:S,offset:I}})}function bk(n,e){return n.isBound?n.offset:e.isSnap?e.offset:0}function HZ(n,e,t,r){var i=wZ(n,e,t),a=i.horizontal,o=i.vertical,c=r?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:DZ(n,e,t),u=c.horizontal,d=c.vertical,h=bk(a,u),p=bk(o,d),m=xe(h),b=xe(p);return{horizontal:{isBound:a.isBound,isSnap:u.isSnap,offset:h,dist:m},vertical:{isBound:o.isBound,isSnap:d.isSnap,offset:p,dist:b}}}function $Z(n,e,t,r,i){var a=[-t[0],-t[1]],o=n.state,c=o.width,u=o.height,d=n.props.bounds,h=1/0,p=1/0;if(d){var m=[[t[0],-t[1]],[-t[0],t[1]]],b=d.left,_=b===void 0?-1/0:b,w=d.top,S=w===void 0?-1/0:w,T=d.right,A=T===void 0?1/0:T,D=d.bottom,O=D===void 0?1/0:D;m.forEach(function(M){var j=M[0]!==a[0],C=M[1]!==a[1],I=ur(e,M),k=Fn(r,I)*360/Math.PI;if(C){var z=I.slice();(xe(k-360)<2||xe(k-180)<2)&&(z[1]=r[1]);var L=$_(r,z,(r[1]<I[1]?O:S)-I[1],!1,i),B=ne(L.offset,2),P=B[1],J=L.isOutside;isNaN(P)||(p=u+(J?1:-1)*xe(P))}if(j){var z=I.slice();(xe(k-90)<2||xe(k-270)<2)&&(z[0]=r[0]);var Y=$_(r,z,(r[0]<I[0]?A:_)-I[0],!0,i),H=ne(Y.offset,1),W=H[0],K=Y.isOutside;isNaN(W)||(h=c+(K?1:-1)*xe(W))}})}return{maxWidth:h,maxHeight:p}}var Fr={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(n,e){var t=n.props,r=t.hideThrottleDragRotateLine,i=t.throttleDragRotate,a=t.zoom,o=n.getState(),c=o.dragInfo,u=o.beforeOrigin;if(r||!i||!c)return[];var d=c.dist;if(!d[0]&&!d[1])return[];var h=Xi(d),p=Fn(d,[0,0]);return[e.createElement("div",{className:Ge("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(h,"px"),transform:"translate(".concat(u[0],"px, ").concat(u[1],"px) rotate(").concat(p,"rad) scaleY(").concat(a,")")}})]},dragStart:function(n,e){var t=e.datas,r=e.parentEvent,i=e.parentGesto,a=n.state,o=a.gestos,c=a.style;if(o.draggable)return!1;o.draggable=i||n.targetGesto,t.datas={},t.left=parseFloat(c.left||"")||0,t.top=parseFloat(c.top||"")||0,t.bottom=parseFloat(c.bottom||"")||0,t.right=parseFloat(c.right||"")||0,t.startValue=[0,0],Fc(n,e),cy(n,e,"translate"),dJ(n,t),t.prevDist=[0,0],t.prevBeforeDist=[0,0],t.isDrag=!1,t.deltaOffset=[0,0];var u=ht(n,e,Z({set:function(h){t.startValue=h}},ly(n,e))),d=r||je(n,"onDragStart",u);return d!==!1?(t.isDrag=!0,n.state.dragInfo={startRect:n.getRect(),dist:[0,0]}):(o.draggable=null,t.isPinch=!1),t.isDrag?u:!1},drag:function(n,e){if(e){sy(n,e,"translate");var t=e.datas,r=e.parentEvent,i=e.parentFlag,a=e.isPinch,o=e.deltaOffset,c=e.useSnap,u=e.isRequest,d=e.isGroup,h=e.parentThrottleDrag,p=e.distX,m=e.distY,b=t.isDrag,_=t.prevDist,w=t.prevBeforeDist,S=t.startValue;if(b){o&&(p+=o[0],m+=o[1]);var T=n.props,A=T.parentMoveable,D=d?0:T.throttleDrag||h||0,O=r?0:T.throttleDragRotate||0,M=0,j=!1,C=!1,I=!1,k=!1;if(!r&&O>0&&(p||m)){var z=T.startDragRotate||0,L=st(z+Fn([0,0],[p,m])*180/Math.PI,O)-z,B=m*Math.abs(Math.cos((L-90)/180*Math.PI)),P=p*Math.abs(Math.cos(L/180*Math.PI)),J=Xi([P,B]);M=L*Math.PI/180,p=J*Math.cos(M),m=J*Math.sin(M)}if(!a&&!r&&!i){var Y=ne(FZ(n,p,m,O,!c&&u||o,t),2),H=Y[0],W=Y[1];j=H.isSnap,C=H.isBound,I=W.isSnap,k=W.isBound;var K=H.offset,de=W.offset;p+=K,m+=de}var Q=Nt(hj({datas:t,distX:p,distY:m}),S),G=Nt(rZ({datas:t,distX:p,distY:m}),S);ZD(G,Kr),ZD(Q,Kr),O||(!j&&!C&&(G[0]=st(G[0],D),Q[0]=st(Q[0],D)),!I&&!k&&(G[1]=st(G[1],D),Q[1]=st(Q[1],D)));var $=Ye(Q,S),ee=Ye(G,S),te=Ye(ee,_),le=Ye($,w);t.prevDist=ee,t.prevBeforeDist=$,t.passDelta=te,t.passDist=ee;var fe=t.left+$[0],oe=t.top+$[1],Ee=t.right-$[0],ke=t.bottom-$[1],Ke=oy(t,"translate(".concat(G[0],"px, ").concat(G[1],"px)"),"translate(".concat(ee[0],"px, ").concat(ee[1],"px)"));if(yS(e,Ke),n.state.dragInfo.dist=r?[0,0]:ee,!(!r&&!A&&te.every(function(He){return!He})&&le.some(function(He){return!He}))){var Se=n.state,Ne=Se.width,Be=Se.height,Me=ht(n,e,Z({transform:Ke,dist:ee,delta:te,translate:G,beforeDist:$,beforeDelta:le,beforeTranslate:Q,left:fe,top:oe,right:Ee,bottom:ke,width:Ne,height:Be,isPinch:a},$r({transform:Ke},e)));return!r&&je(n,"onDrag",Me),Me}}}},dragAfter:function(n,e){var t=e.datas,r=t.deltaOffset;return r[0]||r[1]?(t.deltaOffset=[0,0],this.drag(n,Z(Z({},e),{deltaOffset:r}))):!1},dragEnd:function(n,e){var t=e.parentEvent,r=e.datas;if(n.state.dragInfo=null,!!r.isDrag){r.isDrag=!1;var i=Si(n,e,{});return!t&&je(n,"onDragEnd",i),i}},dragGroupStart:function(n,e){var t,r,i=e.datas,a=e.clientX,o=e.clientY,c=this.dragStart(n,e);if(!c)return!1;var u=o1(n,this,"dragStart",[a||0,o||0],e,!1,"draggable"),d=u.childEvents,h=u.eventParams,p=Z(Z({},c),{targets:n.props.targets,events:h}),m=je(n,"onDragGroupStart",p);i.isDrag=m!==!1;var b=(r=(t=d[0])===null||t===void 0?void 0:t.datas.startValue)!==null&&r!==void 0?r:[0,0];return i.throttleOffset=[b[0]%1,b[1]%1],i.isDrag?c:!1},dragGroup:function(n,e){var t=e.datas;if(t.isDrag){var r=this.drag(n,Z(Z({},e),{parentThrottleDrag:n.props.throttleDrag})),i=e.datas.passDelta,a=o1(n,this,"drag",i,e,!1,"draggable").eventParams;if(r){var o=Z({targets:n.props.targets,events:a},r);return je(n,"onDragGroup",o),o}}},dragGroupEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isDrag){this.dragEnd(n,e);var i=o1(n,this,"dragEnd",[0,0],e,!1,"draggable").eventParams;return je(n,"onDragGroupEnd",Si(n,e,{targets:n.props.targets,events:i})),t}},request:function(n){var e={},t=n.getRect(),r=0,i=0,a=!1;return{isControl:!1,requestStart:function(o){return a=o.useSnap,{datas:e,useSnap:a}},request:function(o){return"x"in o?r=o.x-t.left:"deltaX"in o&&(r+=o.deltaX),"y"in o?i=o.y-t.top:"deltaY"in o&&(i+=o.deltaY),{datas:e,distX:r,distY:i,useSnap:a}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:a}}}},unset:function(n){n.state.gestos.draggable=null,n.state.dragInfo=null}};function Mj(n,e){var t=ur(n,e),r=[0,0];return{fixedPosition:t,fixedDirection:e,fixedOffset:r}}function YZ(n,e){var t=n.allMatrix,r=n.is3d,i=n.width,a=n.height,o=r?4:3,c=[i/2*(1+e[0]),a/2*(1+e[1])],u=Tn(t,c,o),d=[0,0];return{fixedPosition:u,fixedDirection:e,fixedOffset:d}}function Pj(n,e){var t=n.allMatrix,r=n.is3d,i=n.width,a=n.height,o=r?4:3,c=dZ(e,i,a),u=Tn(t,e,o),d=[i?0:e[0],a?0:e[1]];return{fixedPosition:u,fixedDirection:c,fixedOffset:d}}var xk=DS("resizable"),Y_={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:_j("resizable"),dragControlCondition:xk,viewClassName:RS("resizable"),dragControlStart:function(n,e){var t,r=e.inputEvent,i=e.isPinch,a=e.isGroup,o=e.parentDirection,c=e.parentGesto,u=e.datas,d=e.parentFixedDirection,h=e.parentEvent,p=Yj(o,i,r,u),m=n.state,b=m.target,_=m.width,w=m.height,S=m.gestos;if(!p||!b||S.resizable)return!1;S.resizable=c||n.controlGesto,!i&&Fc(n,e),u.datas={},u.direction=p,u.startOffsetWidth=_,u.startOffsetHeight=w,u.prevWidth=0,u.prevHeight=0,u.minSize=[0,0],u.startWidth=m.inlineCSSWidth||m.cssWidth,u.startHeight=m.inlineCSSHeight||m.cssHeight,u.maxSize=[1/0,1/0],a||(u.minSize=[m.minOffsetWidth,m.minOffsetHeight],u.maxSize=[m.maxOffsetWidth,m.maxOffsetHeight]);var T=n.props.transformOrigin||"% %";u.transformOrigin=si(T)?T.split(" "):T,u.startOffsetMatrix=m.offsetMatrix,u.startTransformOrigin=m.transformOrigin,u.isWidth=(t=e?.parentIsWidth)!==null&&t!==void 0?t:!p[0]&&!p[1]||p[0]||!p[1];function A(k){u.ratio=k&&isFinite(k)?k:0}u.startPositions=Wi(n.state);function D(k){var z=Mj(u.startPositions,k);u.fixedDirection=z.fixedDirection,u.fixedPosition=z.fixedPosition,u.fixedOffset=z.fixedOffset}function O(k){var z=Pj(n.state,k);u.fixedDirection=z.fixedDirection,u.fixedPosition=z.fixedPosition,u.fixedOffset=z.fixedOffset}function M(k){u.minSize=[nn("".concat(k[0]),0)||0,nn("".concat(k[1]),0)||0]}function j(k){var z=[k[0]||1/0,k[1]||1/0];(!Td(z[0])||isFinite(z[0]))&&(z[0]=nn("".concat(z[0]),0)||1/0),(!Td(z[1])||isFinite(z[1]))&&(z[1]=nn("".concat(z[1]),0)||1/0),u.maxSize=z}A(_/w),D(d||[-p[0],-p[1]]),u.setFixedDirection=D,u.setFixedPosition=O,u.setMin=M,u.setMax=j;var C=ht(n,e,{direction:p,startRatio:u.ratio,set:function(k){var z=ne(k,2),L=z[0],B=z[1];u.startWidth=L,u.startHeight=B},setMin:M,setMax:j,setRatio:A,setFixedDirection:D,setFixedPosition:O,setOrigin:function(k){u.transformOrigin=k},dragStart:Fr.dragStart(n,new Cd().dragStart([0,0],e))}),I=h||je(n,"onResizeStart",C);return u.startFixedDirection=u.fixedDirection,u.startFixedPosition=u.fixedPosition,I!==!1&&(u.isResize=!0,n.state.snapRenderInfo={request:e.isRequest,direction:p}),u.isResize?C:!1},dragControl:function(n,e){var t,r=e.datas,i=e.parentFlag,a=e.isPinch,o=e.parentKeepRatio,c=e.dragClient,u=e.parentDist,d=e.useSnap,h=e.isRequest,p=e.isGroup,m=e.parentEvent,b=e.resolveMatrix,_=r.isResize,w=r.transformOrigin,S=r.startWidth,T=r.startHeight,A=r.prevWidth,D=r.prevHeight,O=r.minSize,M=r.maxSize,j=r.ratio,C=r.startOffsetWidth,I=r.startOffsetHeight,k=r.isWidth;if(!_)return;if(b){var z=n.state.is3d,L=r.startOffsetMatrix,B=r.startTransformOrigin,P=z?4:3,J=fp(lv(e)),Y=Math.sqrt(J.length);P!==Y&&(J=ba(J,Y,P));var H=tg(L,J,B,P),W=Gc(H,C,I,P);r.startPositions=W,r.nextTargetMatrix=J,r.nextAllMatrix=H}var K=Vc(n.props,"resizable"),de=K.resizeFormat,Q=K.throttleResize,G=Q===void 0?i?0:1:Q,$=K.parentMoveable,ee=K.keepRatioFinally,te=r.direction,le=te,fe=0,oe=0;!te[0]&&!te[1]&&(le=[1,1]);var Ee=j&&(o??K.keepRatio)||!1;function ke(){var rt=r.fixedDirection,pt=Jj(le,Ee,r,e);fe=pt.distWidth,oe=pt.distHeight;var jt=le[0]-rt[0]||Ee?Math.max(C+fe,Kr):C,Ft=le[1]-rt[1]||Ee?Math.max(I+oe,Kr):I;return Ee&&C&&I&&(k?Ft=jt/j:jt=Ft*j),[jt,Ft]}var Ke=ne(ke(),2),Se=Ke[0],Ne=Ke[1];m||(r.setFixedDirection(r.fixedDirection),je(n,"onBeforeResize",ht(n,e,{startFixedDirection:r.startFixedDirection,startFixedPosition:r.startFixedPosition,setFixedDirection:function(rt){var pt;return r.setFixedDirection(rt),pt=ne(ke(),2),Se=pt[0],Ne=pt[1],[Se,Ne]},setFixedPosition:function(rt){var pt;return r.setFixedPosition(rt),pt=ne(ke(),2),Se=pt[0],Ne=pt[1],[Se,Ne]},boundingWidth:Se,boundingHeight:Ne,setSize:function(rt){var pt;pt=ne(rt,2),Se=pt[0],Ne=pt[1]}},!0)));var Be=c;c||(!i&&a?Be=gZ(n,[0,0]):Be=r.fixedPosition);var Me=[0,0];a||(Me=cJ(n,Se,Ne,te,Be,!d&&h,r)),u&&(!u[0]&&(Me[0]=0),!u[1]&&(Me[1]=0));function He(){var rt;de&&(rt=ne(de([Se,Ne]),2),Se=rt[0],Ne=rt[1]),Se=st(Se,G),Ne=st(Ne,G)}if(Ee){le[0]&&le[1]&&Me[0]&&Me[1]&&(xe(Me[0])>xe(Me[1])?Me[1]=0:Me[0]=0);var we=!Me[0]&&!Me[1];we&&He(),le[0]&&!le[1]||Me[0]&&!Me[1]||we&&k?(Se+=Me[0],Ne=Se/j):(!le[0]&&le[1]||!Me[0]&&Me[1]||we&&!k)&&(Ne+=Me[1],Se=Ne*j)}else Se+=Me[0],Ne+=Me[1],Se=Math.max(0,Se),Ne=Math.max(0,Ne);t=ne(T3([Se,Ne],O,M,Ee?j:!1),2),Se=t[0],Ne=t[1],He(),Ee&&(p||ee)&&(k?Ne=Se/j:Se=Ne*j),fe=Se-C,oe=Ne-I;var Ve=[fe-A,oe-D];r.prevWidth=fe,r.prevHeight=oe;var Ze=pZ(n,Se,Ne,Be,w,r);if(!(!$&&Ve.every(function(rt){return!rt})&&Ze.every(function(rt){return!rt}))){var Re=Fr.drag(n,eg(e,n.state,Ze,!!a,!1,"draggable")),Oe=Re.transform,ct=S+fe,et=T+oe,Ot=ht(n,e,Z({width:ct,height:et,offsetWidth:Math.round(Se),offsetHeight:Math.round(Ne),startRatio:j,boundingWidth:Se,boundingHeight:Ne,direction:te,dist:[fe,oe],delta:Ve,isPinch:!!a,drag:Re},Xj({style:{width:"".concat(ct,"px"),height:"".concat(et,"px")},transform:Oe},Re,e)));return!m&&je(n,"onResize",Ot),Ot}},dragControlAfter:function(n,e){var t=e.datas,r=t.isResize,i=t.startOffsetWidth,a=t.startOffsetHeight,o=t.prevWidth,c=t.prevHeight;if(!(!r||n.props.checkResizableError===!1)){var u=n.state,d=u.width,h=u.height,p=d-(i+o),m=h-(a+c),b=xe(p)>3,_=xe(m)>3;if(b&&(t.startWidth+=p,t.startOffsetWidth+=p,t.prevWidth+=p),_&&(t.startHeight+=m,t.startOffsetHeight+=m,t.prevHeight+=m),b||_)return this.dragControl(n,e)}},dragControlEnd:function(n,e){var t=e.datas,r=e.parentEvent;if(t.isResize){t.isResize=!1;var i=Si(n,e,{});return!r&&je(n,"onResizeEnd",i),i}},dragGroupControlCondition:xk,dragGroupControlStart:function(n,e){var t=e.datas,r=this.dragControlStart(n,Z(Z({},e),{isGroup:!0}));if(!r)return!1;var i=pa(n,"resizable",e),a=t.startOffsetWidth,o=t.startOffsetHeight;function c(){var b=t.minSize;i.forEach(function(_){var w=_.datas,S=w.minSize,T=w.startOffsetWidth,A=w.startOffsetHeight,D=a*(T?S[0]/T:0),O=o*(A?S[1]/A:0);b[0]=Math.max(b[0],D),b[1]=Math.max(b[1],O)})}function u(){var b=t.maxSize;i.forEach(function(_){var w=_.datas,S=w.maxSize,T=w.startOffsetWidth,A=w.startOffsetHeight,D=a*(T?S[0]/T:0),O=o*(A?S[1]/A:0);b[0]=Math.min(b[0],D),b[1]=Math.min(b[1],O)})}var d=Vs(n,this,"dragControlStart",e,function(b,_){return cv(n,b,t,_)});c(),u();var h=function(b){r.setFixedDirection(b),d.forEach(function(_,w){_.setFixedDirection(b),cv(n,_.moveable,t,i[w])})};t.setFixedDirection=h;var p=Z(Z({},r),{targets:n.props.targets,events:d.map(function(b){return Z(Z({},b),{setMin:function(_){b.setMin(_),c()},setMax:function(_){b.setMax(_),u()}})}),setFixedDirection:h,setMin:function(b){r.setMin(b),c()},setMax:function(b){r.setMax(b),u()}}),m=je(n,"onResizeGroupStart",p);return t.isResize=m!==!1,t.isResize?r:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isResize){var r=Vc(n.props,"resizable");py(n,"onBeforeResize",function(b){je(n,"onBeforeResizeGroup",ht(n,e,Z(Z({},b),{targets:r.targets}),!0))});var i=this.dragControl(n,Z(Z({},e),{isGroup:!0}));if(i){var a=i.boundingWidth,o=i.boundingHeight,c=i.dist,u=r.keepRatio,d=[a/(a-c[0]),o/(o-c[1])],h=t.fixedPosition,p=Vs(n,this,"dragControl",e,function(b,_){var w=ne(zr(Qp(n.rotation/180*Math.PI,3),[_.datas.originalX*d[0],_.datas.originalY*d[1],1],3),2),S=w[0],T=w[1];return Z(Z({},_),{parentDist:null,parentScale:d,dragClient:Nt(h,[S,T]),parentKeepRatio:u})}),m=Z({targets:r.targets,events:p},i);return je(n,"onResizeGroup",m),m}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isResize){this.dragControlEnd(n,e);var i=Vs(n,this,"dragControlEnd",e),a=Si(n,e,{targets:n.props.targets,events:i});return je(n,"onResizeGroupEnd",a),t}},request:function(n){var e={},t=0,r=0,i=!1,a=n.getRect();return{isControl:!0,requestStart:function(o){var c;return i=o.useSnap,{datas:e,parentDirection:o.direction||[1,1],parentIsWidth:(c=o?.horizontal)!==null&&c!==void 0?c:!0,useSnap:i}},request:function(o){return"offsetWidth"in o?t=o.offsetWidth-a.offsetWidth:"deltaWidth"in o&&(t+=o.deltaWidth),"offsetHeight"in o?r=o.offsetHeight-a.offsetHeight:"deltaHeight"in o&&(r+=o.deltaHeight),{datas:e,parentDist:[t,r],parentKeepRatio:o.keepRatio,useSnap:i}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:i}}}},unset:function(n){n.state.gestos.resizable=null}};function l1(n,e,t,r,i){var a=n.props.groupable,o=n.state,c=o.is3d?4:3,u=e.origin,d=Tn(n.state.rootMatrix,Ye([u[0],u[1]],a?[0,0]:[o.left,o.top]),c),h=Nt([i.left,i.top],d);e.startAbsoluteOrigin=h,e.prevDeg=Fn(h,[t,r])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=js(h,[t,r])}function _0(n,e,t){var r=t.defaultDeg,i=t.prevDeg,a=i%360,o=Math.floor(i/360);a<0&&(a+=360),a>n&&a>270&&n<90?++o:a<n&&a<90&&n>270&&--o;var c=e*(o*360+n-r);return t.prevDeg=r+c,c}function c1(n,e,t,r){return _0(Fn(r.startAbsoluteOrigin,[n,e])/Math.PI*180,t,r)}function u1(n,e,t,r,i,a){var o=n.props.throttleRotate,c=o===void 0?0:o,u=t.prevSnapDeg,d=0,h=!1;if(a){var p=lJ(n,e,r,i+r);h=p.isSnap,d=i+p.dist}h||(d=st(i+r,c));var m=d-i;return t.prevSnapDeg=m,[m-u,m,d]}function Oj(n,e,t){var r=ne(e,4),i=r[0],a=r[1],o=r[2],c=r[3];if(n==="none")return[];if(nr(n))return n.map(function(S){return Oj(S,[i,a,o,c],t)[0]});var u=ne((n||"top").split("-"),2),d=u[0],h=u[1],p=[i,a];d==="left"?p=[o,i]:d==="right"?p=[a,c]:d==="bottom"&&(p=[c,o]);var m=[(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2],b=Hj(p,t);if(h){var _=h==="top"||h==="left",w=d==="bottom"||d==="left";m=p[_&&!w||!_&&w?0:1]}return[[m,b]]}function K_(n,e){if(e.isRequest)return e.requestAble==="rotatable";var t=e.inputEvent.target;if(cr(t,Ge("rotation-control"))||n.props.rotateAroundControls&&cr(t,Ge("around-control"))||cr(t,Ge("control"))&&cr(t,Ge("rotatable")))return!0;var r=n.props.rotationTarget;return r?kS(r,!0).some(function(i){return i?t===i||t.contains(i):!1}):!1}var KZ=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,XZ={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[KZ],viewClassName:function(n){return n.isDragging("rotatable")?Ge("view-rotation-dragging"):""},render:function(n,e){var t=Vc(n.props,"rotatable"),r=t.rotatable,i=t.rotationPosition,a=t.zoom,o=t.renderDirections,c=t.rotateAroundControls,u=t.resolveAblesWithRotatable,d=n.getState(),h=d.renderPoses,p=d.direction;if(!r)return null;var m=Oj(i,h,p),b=[];if(m.forEach(function(T,A){var D=ne(T,2),O=D[0],M=D[1];b.push(e.createElement("div",{key:"rotation".concat(A),className:Ge("rotation"),style:{transform:"translate(-50%) translate(".concat(O[0],"px, ").concat(O[1],"px) rotate(").concat(M,"rad)")}},e.createElement("div",{className:Ge("line rotation-line"),style:{transform:"scaleX(".concat(a,")")}}),e.createElement("div",{className:Ge("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(a,")")}})))}),o){var _=Ys(u||{}),w={};_.forEach(function(T){u[T].forEach(function(A){w[A]=T})});var S=[];nr(o)&&(S=o.map(function(T){var A=w[T];return{data:A?{resolve:A}:{},classNames:A?["move"]:[],dir:T}})),b.push.apply(b,Ae([],ne(yj(n,"rotatable",S,e)),!1))}return c&&b.push.apply(b,Ae([],ne(Ej(n,e)),!1)),b},dragControlCondition:K_,dragControlStart:function(n,e){var t,r,i=e.datas,a=e.clientX,o=e.clientY,c=e.parentRotate,u=e.parentFlag,d=e.isPinch,h=e.isRequest,p=n.state,m=p.target,b=p.left,_=p.top,w=p.direction,S=p.beforeDirection,T=p.targetTransform,A=p.moveableClientRect,D=p.offsetMatrix,O=p.targetMatrix,M=p.allMatrix,j=p.width,C=p.height;if(!h&&!m)return!1;var I=n.getRect();i.rect=I,i.transform=T,i.left=b,i.top=_;var k=function(le){var fe=Pj(n.state,le);i.fixedDirection=fe.fixedDirection,i.fixedOffset=fe.fixedOffset,i.fixedPosition=fe.fixedPosition,G&&G.setFixedPosition(le)},z=function(le){var fe=YZ(n.state,le);i.fixedDirection=fe.fixedDirection,i.fixedOffset=fe.fixedOffset,i.fixedPosition=fe.fixedPosition,G&&G.setFixedDirection(le)},L=a,B=o;if(h||d||u){var P=c||0;i.beforeInfo={origin:I.beforeOrigin,prevDeg:P,defaultDeg:P,prevSnapDeg:0,startDist:0},i.afterInfo=Z(Z({},i.beforeInfo),{origin:I.origin}),i.absoluteInfo=Z(Z({},i.beforeInfo),{origin:I.origin,startValue:P})}else{var J=(r=e.inputEvent)===null||r===void 0?void 0:r.target;if(J){var Y=J.getAttribute("data-direction")||"",H=tZ[Y];if(H){i.isControl=!0,i.isAroundControl=cr(J,Ge("around-control")),i.controlDirection=H;var W=J.getAttribute("data-resolve");W&&(i.resolveAble=W);var K=SJ(p.rootMatrix,p.renderPoses,A);t=ne(ur(K,H),2),L=t[0],B=t[1]}}i.beforeInfo={origin:I.beforeOrigin},i.afterInfo={origin:I.origin},i.absoluteInfo={origin:I.origin,startValue:I.rotation};var de=k;k=function(le){var fe=p.is3d?4:3,oe=ne(Nt(Q3(O,fe),le),2),Ee=oe[0],ke=oe[1],Ke=zr(D,Pc([Ee,ke],fe)),Se=zr(M,Pc([le[0],le[1]],fe));de(le);var Ne=p.posDelta;i.beforeInfo.origin=Ye(Ke,Ne),i.afterInfo.origin=Ye(Se,Ne),i.absoluteInfo.origin=Ye(Se,Ne),l1(n,i.beforeInfo,L,B,A),l1(n,i.afterInfo,L,B,A),l1(n,i.absoluteInfo,L,B,A)},z=function(le){var fe=ur([[0,0],[j,0],[0,C],[j,C]],le);k(fe)}}i.startClientX=L,i.startClientY=B,i.direction=w,i.beforeDirection=S,i.startValue=0,i.datas={},cy(n,e,"rotate");var Q=!1,G=!1;if(i.isControl&&i.resolveAble){var $=i.resolveAble;$==="resizable"&&(G=Y_.dragControlStart(n,Z(Z({},new Cd("resizable").dragStart([0,0],e)),{parentPosition:i.controlPosition,parentFixedPosition:i.fixedPosition})))}G||(Q=Fr.dragStart(n,new Cd().dragStart([0,0],e))),k(TJ(n));var ee=ht(n,e,Z(Z({set:function(le){i.startValue=le*Math.PI/180},setFixedDirection:z,setFixedPosition:k},ly(n,e)),{dragStart:Q,resizeStart:G})),te=je(n,"onRotateStart",ee);return i.isRotate=te!==!1,p.snapRenderInfo={request:e.isRequest},i.isRotate?ee:!1},dragControl:function(n,e){var t,r,i,a=e.datas,o=e.clientDistX,c=e.clientDistY,u=e.parentRotate,d=e.parentFlag,h=e.isPinch,p=e.groupDelta,m=e.resolveMatrix,b=a.beforeDirection,_=a.beforeInfo,w=a.afterInfo,S=a.absoluteInfo,T=a.isRotate,A=a.startValue,D=a.rect,O=a.startClientX,M=a.startClientY;if(T){sy(n,e,"rotate");var j=nZ(e),C=b*j,I=n.props.parentMoveable,k=0,z,L,B=0,P,J,Y=0,H,W,K=180/Math.PI*A,de=S.startValue,Q=!1,G=O+o,$=M+c;if(!d&&"parentDist"in e){var ee=e.parentDist;z=ee,P=ee,H=ee}else h||d?(z=_0(u,b,_),P=_0(u,C,w),H=_0(u,C,S)):(z=c1(G,$,b,_),P=c1(G,$,C,w),H=c1(G,$,C,S),Q=!0);if(L=K+z,J=K+P,W=de+H,je(n,"onBeforeRotate",ht(n,e,{beforeRotation:L,rotation:J,absoluteRotation:W,setRotation:function(Be){P=Be-K,z=P,H=P}},!0)),t=ne(u1(n,D,_,z,K,Q),3),k=t[0],z=t[1],L=t[2],r=ne(u1(n,D,w,P,K,Q),3),B=r[0],P=r[1],J=r[2],i=ne(u1(n,D,S,H,de,Q),3),Y=i[0],H=i[1],W=i[2],!(!Y&&!B&&!k&&!I&&!m)){var te=oy(a,"rotate(".concat(J,"deg)"),"rotate(".concat(P,"deg)"));m&&(a.fixedPosition=bS(n,a.targetAllTransform,a.fixedDirection,a.fixedOffset,a));var le=hZ(n,P,a),fe=Ye(Nt(p||[0,0],le),a.prevInverseDist||[0,0]);a.prevInverseDist=le,a.requestValue=null;var oe=gj(n,te,fe,h,e),Ee=oe,ke=js([G,$],S.startAbsoluteOrigin)-S.startDist,Ke=void 0;if(a.resolveAble==="resizable"){var Se=Y_.dragControl(n,Z(Z({},eg(e,n.state,[e.deltaX,e.deltaY],!!h,!1,"resizable")),{resolveMatrix:!0,parentDistance:ke}));Se&&(Ke=Se,Ee=Xj(Ee,Se,e))}var Ne=ht(n,e,Z(Z({delta:B,dist:P,rotate:J,rotation:J,beforeDist:z,beforeDelta:k,beforeRotate:L,beforeRotation:L,absoluteDist:H,absoluteDelta:Y,absoluteRotate:W,absoluteRotation:W,isPinch:!!h,resize:Ke},oe),Ee));return je(n,"onRotate",Ne),Ne}}},dragControlEnd:function(n,e){var t=e.datas;if(t.isRotate){t.isRotate=!1;var r=Si(n,e,{});return je(n,"onRotateEnd",r),r}},dragGroupControlCondition:K_,dragGroupControlStart:function(n,e){var t=e.datas,r=n.state,i=r.left,a=r.top,o=r.beforeOrigin,c=this.dragControlStart(n,e);if(!c)return!1;c.set(t.beforeDirection*n.rotation);var u=Vs(n,this,"dragControlStart",e,function(p,m){var b=p.state,_=b.left,w=b.top,S=b.beforeOrigin,T=Nt(Ye([_,w],[i,a]),Ye(S,o));return m.datas.startGroupClient=T,m.datas.groupClient=T,Z(Z({},m),{parentRotate:0})}),d=Z(Z({},c),{targets:n.props.targets,events:u}),h=je(n,"onRotateGroupStart",d);return t.isRotate=h!==!1,t.isRotate?c:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isRotate){py(n,"onBeforeRotate",function(d){je(n,"onBeforeRotateGroup",ht(n,e,Z(Z({},d),{targets:n.props.targets}),!0))});var r=this.dragControl(n,e);if(r){var i=t.beforeDirection,a=r.beforeDist,o=a/180*Math.PI,c=Vs(n,this,"dragControl",e,function(d,h){var p=h.datas.startGroupClient,m=ne(h.datas.groupClient,2),b=m[0],_=m[1],w=ne(Wp(p,o*i),2),S=w[0],T=w[1],A=[S-b,T-_];return h.datas.groupClient=[S,T],Z(Z({},h),{parentRotate:a,groupDelta:A})});n.rotation=i*r.beforeRotation;var u=Z({targets:n.props.targets,events:c,set:function(d){n.rotation=d},setGroupRotation:function(d){n.rotation=d}},r);return je(n,"onRotateGroup",u),u}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isRotate){this.dragControlEnd(n,e);var i=Vs(n,this,"dragControlEnd",e),a=Si(n,e,{targets:n.props.targets,events:i});return je(n,"onRotateGroupEnd",a),t}},request:function(n){var e={},t=0,r=n.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(i){return"deltaRotate"in i?t+=i.deltaRotate:"rotate"in i&&(t=i.rotate-r),{datas:e,parentDist:t}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function WZ(n,e){var t,r=n.direction,i=n.classNames,a=n.size,o=n.pos,c=n.zoom,u=n.key,d=r==="horizontal",h=d?"Y":"X";return e.createElement("div",{key:u,className:i.join(" "),style:(t={},t[d?"width":"height"]="".concat(a),t.transform="translate(".concat(o[0],", ").concat(o[1],") translate").concat(h,"(-50%) scale").concat(h,"(").concat(c,")"),t)})}function TS(n,e){return WZ(Z(Z({},n),{classNames:Ae([Ge("line","guideline",n.direction)],ne(n.classNames),!1).filter(function(t){return t}),size:n.size||"".concat(n.sizeValue,"px"),pos:n.pos||n.posValue.map(function(t){return"".concat(st(t,.1),"px")})}),e)}function _k(n,e,t,r,i,a,o,c){var u=n.props.zoom;return t.map(function(d,h){var p=d.type,m=d.pos,b=[0,0];return b[o]=r,b[o?0:1]=-i+m,TS({key:"".concat(e,"TargetGuideline").concat(h),classNames:[Ge("target","bold",p)],posValue:b,sizeValue:a,zoom:u,direction:e},c)})}function wk(n,e,t,r,i,a){var o=n.props,c=o.zoom,u=o.isDisplayInnerSnapDigit,d=e==="horizontal"?fl:hl,h=i[d.start],p=i[d.end];return t.filter(function(m){var b=m.hide,_=m.elementRect;if(b)return!1;if(u&&_){var w=_.rect;if(w[d.start]<=h&&p<=w[d.end])return!1}return!0}).map(function(m,b){var _=m.pos,w=m.size,S=m.element,T=m.className,A=[-r[0]+_[0],-r[1]+_[1]];return TS({key:"".concat(e,"-default-guideline-").concat(b),classNames:S?[Ge("bold"),T]:[Ge("normal"),T],direction:e,posValue:A,sizeValue:w,zoom:c},a)})}function hh(n,e,t,r,i,a,o,c){var u,d=n.props,h=d.snapDigit,p=h===void 0?0:h,m=d.isDisplaySnapDigit,b=m===void 0?!0:m,_=d.snapDistFormat,w=_===void 0?function(M,j){return M}:_,S=d.zoom,T=e==="horizontal"?"X":"Y",A=e==="vertical"?"height":"width",D=Math.abs(i),O=b?parseFloat(D.toFixed(p)):0;return c.createElement("div",{key:"".concat(e,"-").concat(t,"-guideline-").concat(r),className:Ge("guideline-group",e),style:(u={left:"".concat(a[0],"px"),top:"".concat(a[1],"px")},u[A]="".concat(D,"px"),u)},TS({direction:e,classNames:[Ge(t),o],size:"100%",posValue:[0,0],sizeValue:D,zoom:S},c),c.createElement("div",{className:Ge("size-value","gap"),style:{transform:"translate".concat(T,"(-50%) scale(").concat(S,")")}},O>0?w(O,e):""))}function QZ(n,e,t,r){var i=n==="vertical"?0:1,a=n==="vertical"?1:0,o=i?fl:hl,c=t[o.start],u=t[o.end];return Wj(e,function(d){return d.pos[i]}).map(function(d){var h=[],p=[],m=[];return d.forEach(function(b){var _,w,S=b.element,T=b.elementRect.rect;if(T[o.end]<c)h.push(b);else if(u<T[o.start])p.push(b);else if(T[o.start]<=c&&u<=T[o.end]&&r){var A=b.pos,D={element:S,rect:Z(Z({},T),(_={},_[o.end]=T[o.start],_))},O={element:S,rect:Z(Z({},T),(w={},w[o.start]=T[o.end],w))},M=[0,0],j=[0,0];M[i]=A[i],M[a]=A[a],j[i]=A[i],j[a]=A[a]+b.size,h.push({type:n,pos:M,size:0,elementRect:D,direction:"",elementDirection:"end"}),p.push({type:n,pos:j,size:0,elementRect:O,direction:"",elementDirection:"start"})}}),h.sort(function(b,_){return _.pos[a]-b.pos[a]}),p.sort(function(b,_){return b.pos[a]-_.pos[a]}),{total:d,start:h,end:p,inner:m}})}function ZZ(n,e,t,r,i){var a=n.props.isDisplayInnerSnapDigit,o=[];return["vertical","horizontal"].forEach(function(c){var u=e.filter(function(S){return S.type===c}),d=c==="vertical"?1:0,h=d?0:1,p=QZ(c,u,r,a),m=d?hl:fl,b=d?fl:hl,_=r[m.start],w=r[m.end];p.forEach(function(S){var T=S.total,A=S.start,D=S.end,O=S.inner,M=t[h]+T[0].pos[h]-r[b.start],j=r;A.forEach(function(C){var I=C.elementRect.rect,k=j[m.start]-I[m.end];if(k>0){var z=[0,0];z[d]=t[d]+j[m.start]-_-k,z[h]=M,o.push(hh(n,c,"dashed",o.length,k,z,C.className,i))}j=I}),j=r,D.forEach(function(C){var I=C.elementRect.rect,k=I[m.start]-j[m.end];if(k>0){var z=[0,0];z[d]=t[d]+j[m.end]-_,z[h]=M,o.push(hh(n,c,"dashed",o.length,k,z,C.className,i))}j=I}),O.forEach(function(C){var I=C.elementRect.rect,k=_-I[m.start],z=I[m.end]-w,L=[0,0],B=[0,0];L[d]=t[d]-k,L[h]=M,B[d]=t[d]+w-_,B[h]=M,o.push(hh(n,c,"dashed",o.length,k,L,C.className,i)),o.push(hh(n,c,"dashed",o.length,z,B,C.className,i))})})}),o}function JZ(n,e,t,r,i){var a=[];return["horizontal","vertical"].forEach(function(o){var c=e.filter(function(S){return S.type===o}).slice(0,1),u=o==="vertical"?0:1,d=u?0:1,h=u?hl:fl,p=u?fl:hl,m=r[h.start],b=r[h.end],_=r[p.start],w=r[p.end];c.forEach(function(S){var T=S.gap,A=S.gapRects,D=Math.max.apply(Math,Ae([_],ne(A.map(function(j){var C=j.rect;return C[p.start]})),!1)),O=Math.min.apply(Math,Ae([w],ne(A.map(function(j){var C=j.rect;return C[p.end]})),!1)),M=(D+O)/2;D===O||M===(_+w)/2||A.forEach(function(j){var C=j.rect,I=j.className,k=[t[0],t[1]];if(C[h.end]<m)k[u]+=C[h.end]-m;else if(b<C[h.start])k[u]+=C[h.start]-m-T;else return;k[d]+=M-_,a.push(hh(n,u?"vertical":"horizontal","gap",a.length,T,k,I,i))})})}),a}function X_(n){var e,t,r=n.state,i=r.containerClientRect,a=r.hasFixed,o=i.overflow,c=i.scrollHeight,u=i.scrollWidth,d=i.clientHeight,h=i.clientWidth,p=i.clientLeft,m=i.clientTop,b=n.props,_=b.snapGap,w=_===void 0?!0:_,S=b.verticalGuidelines,T=b.horizontalGuidelines,A=b.snapThreshold,D=A===void 0?5:A,O=b.maxSnapElementGuidelineDistance,M=O===void 0?1/0:O,j=b.isDisplayGridGuidelines,C=Yi(Wi(n.state)),I=C.top,k=C.left,z=C.bottom,L=C.right,B={top:I,left:k,bottom:z,right:L,center:(k+L)/2,middle:(I+z)/2},P=rJ(n),J=Ae([],ne(P),!1),Y=((t=(e=r.snapThresholdInfo)===null||e===void 0?void 0:e.multiples)!==null&&t!==void 0?t:[1,1]).map(function(de){return de*D});w&&J.push.apply(J,Ae([],ne(eJ(n,B,Y)),!1));var H=Z({},r.snapOffset||{left:0,top:0,bottom:0,right:0});if(J.push.apply(J,Ae([],ne(nJ(n,o?u:h,o?c:d,p,m,H,j)),!1)),a){var W=i.left,K=i.top;H.left+=W,H.top+=K,H.right+=W,H.bottom+=K}return J.push.apply(J,Ae([],ne(Vj(T||!1,S||!1,o?u:h,o?c:d,p,m,H)),!1)),J=J.filter(function(de){var Q=de.element,G=de.elementRect,$=de.type;if(!Q||!G)return!0;var ee=G.rect;return jj(B,ee,$,M)}),J}function eJ(n,e,t){var r=n.props,i=r.maxSnapElementGuidelineDistance,a=i===void 0?1/0:i,o=r.maxSnapElementGapDistance,c=o===void 0?1/0:o,u=n.state.elementRects,d=[];return[["vertical",fl,hl],["horizontal",hl,fl]].forEach(function(h){var p=ne(h,3),m=p[0],b=p[1],_=p[2],w=e[b.start],S=e[b.end],T=e[b.center],A=e[_.start],D=e[_.end],O={left:t[0],top:t[1]};function M(I){var k=I.rect,z=O[b.start];return k[b.end]<w+z?w-k[b.end]:S-z<k[b.start]?k[b.start]-S:-1}var j=u.filter(function(I){var k=I.rect;return k[_.start]>D||k[_.end]<A?!1:M(I)>0}).sort(function(I,k){return M(I)-M(k)}),C=[];j.forEach(function(I){j.forEach(function(k){if(I!==k){var z=I.rect,L=k.rect,B=z[_.start],P=z[_.end],J=L[_.start],Y=L[_.end];B>Y||J>P||C.push([I,k])}})}),C.forEach(function(I){var k=ne(I,2),z=k[0],L=k[1],B=z.rect,P=L.rect,J=B[b.start],Y=B[b.end],H=P[b.start],W=P[b.end],K=O[b.start],de=0,Q=0,G=!1,$=!1,ee=!1;if(Y<=w&&S<=H){if($=!0,de=(H-Y-(S-w))/2,Q=Y+de+(S-w)/2,xe(Q-T)>K)return}else if(Y<H&&W<w+K){if(G=!0,de=H-Y,Q=W+de,xe(Q-w)>K)return}else if(Y<H&&S-K<J){if(ee=!0,de=H-Y,Q=J-de,xe(Q-S)>K)return}else return;de&&jj(e,P,m,a)&&(de>c||d.push({type:m,pos:m==="vertical"?[Q,0]:[0,Q],element:L.element,size:0,className:L.className,isStart:G,isCenter:$,isEnd:ee,gap:de,hide:!0,gapRects:[z,L],direction:"",elementDirection:""}))})}),d}function tJ(n,e,t,r){var i,a,o=n.props,c=n.state,u=o.snapGridAll,d=o.snapGridWidth,h=d===void 0?0:d,p=o.snapGridHeight,m=p===void 0?0:p,b=c.snapRenderInfo,_=b&&(((i=b.direction)===null||i===void 0?void 0:i[0])||((a=b.direction)===null||a===void 0?void 0:a[1])),w=n.moveables;if(u&&w&&_&&(h||m)){if(c.snapThresholdInfo)return;c.snapThresholdInfo={multiples:[1,1],offset:[0,0]};var S=n.getRect(),T=S.children,A=b.direction;if(T){var D=A.map(function(M,j){var C=j===0?{snapSize:h,posName:"left",sizeName:"width",clientOffset:r.left-e}:{snapSize:m,posName:"top",sizeName:"height",clientOffset:r.top-t},I=C.snapSize,k=C.posName,z=C.sizeName,L=C.clientOffset;if(!I)return{dir:M,multiple:1,snapSize:I,snapOffset:0};var B=S[z],P=S[k],J=A3(T.map(function(G){return[G[k]-P,G[z],B-G[z]-G[k]+P]})).filter(function(G){return G}).sort(function(G,$){return G-$}),Y=J[0],H=J.map(function(G){return st(G/Y,.1)*I}),W=1,K=st(B/Y,.1);for(W=1;W<=10&&!H.every(function(G){return G*W%1===0});++W);var de=(-M+1)/2,Q=iv(P-L,P-L+B,de,1-de);return{multiple:K*W,dir:M,snapSize:I,snapOffset:Math.round(Q/I)}}),O=D.map(function(M){return M.multiple||1});c.snapThresholdInfo.multiples=O,c.snapThresholdInfo.offset=D.map(function(M){return M.snapOffset}),D.forEach(function(M,j){M.snapSize})}}else c.snapThresholdInfo=null}function nJ(n,e,t,r,i,a,o){r===void 0&&(r=0),i===void 0&&(i=0);var c=n.props,u=n.state,d=c.snapGridWidth,h=d===void 0?0:d,p=c.snapGridHeight,m=p===void 0?0:p,b=[],_=a.left,w=a.top,S=[0,0];tJ(n,r,i,a);var T=u.snapThresholdInfo,A=h,D=m;if(T&&(h*=T.multiples[0]||1,m*=T.multiples[1]||1,S=T.offset),m){for(var O=function(j){b.push({type:"horizontal",pos:[_,st(S[1]*D+j-i+w,.1)],className:Ge("grid-guideline"),size:e,hide:!o,direction:"",grid:!0})},M=0;M<=t*2;M+=m)O(M);for(var M=-m;M>=-t;M-=m)O(M)}if(h){for(var O=function(C){b.push({type:"vertical",pos:[st(S[0]*A+C-r+_,.1),w],className:Ge("grid-guideline"),size:t,hide:!o,direction:"",grid:!0})},M=0;M<=e*2;M+=h)O(M);for(var M=-h;M>=-e;M-=h)O(M)}return b}function jj(n,e,t,r){return t==="horizontal"?xe(n.right-e.left)<=r||xe(n.left-e.right)<=r||n.left<=e.right&&e.left<=n.right:t==="vertical"?xe(n.bottom-e.top)<=r||xe(n.top-e.bottom)<=r||n.top<=e.bottom&&e.top<=n.bottom:!0}function rJ(n){var e=n.state,t=n.props.elementGuidelines,r=t===void 0?[]:t;if(!r.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter(function(m){return!m.refresh}),a=r.map(function(m){return ya(m)&&"element"in m?Z(Z({},m),{element:ts(m.element,!0)}):{element:ts(m,!0)}}).filter(function(m){return m.element}),o=gQ(i.map(function(m){return m.element}),a.map(function(m){return m.element})),c=o.maintained,u=o.added,d=[];c.forEach(function(m){var b=ne(m,2),_=b[0],w=b[1];d[w]=i[_]}),iJ(n,u.map(function(m){return a[m]})).map(function(m,b){d[u[b]]=m}),e.elementRects=d;var h=_S(n.props.elementSnapDirections),p=[];return d.forEach(function(m){var b=m.element,_=m.top,w=_===void 0?h.top:_,S=m.left,T=S===void 0?h.left:S,A=m.right,D=A===void 0?h.right:A,O=m.bottom,M=O===void 0?h.bottom:O,j=m.center,C=j===void 0?h.center:j,I=m.middle,k=I===void 0?h.middle:I,z=m.className,L=m.rect,B=wS({top:w,right:D,left:T,bottom:M,center:C,middle:k},L),P=B.horizontal,J=B.vertical,Y=B.horizontalNames,H=B.verticalNames,W=L.top,K=L.left,de=L.right-K,Q=L.bottom-W,G=[de,Q];J.forEach(function($,ee){p.push({type:"vertical",element:b,pos:[st($,.1),W],size:Q,sizes:G,className:z,elementRect:m,elementDirection:hk[H[ee]]||H[ee],direction:""})}),P.forEach(function($,ee){p.push({type:"horizontal",element:b,pos:[K,st($,.1)],size:de,sizes:G,className:z,elementRect:m,elementDirection:hk[Y[ee]]||Y[ee],direction:""})})}),p}function Ek(n,e){return n?n.map(function(t){var r=ya(t)?t:{pos:t},i=r.pos;return Td(i)?r:Z(Z({},r),{pos:nn(i,e)})}):[]}function Vj(n,e,t,r,i,a,o){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o={left:0,top:0,right:0,bottom:0});var c=[],u=o.left,d=o.top,h=o.bottom,p=o.right,m=t+p-u,b=r+h-d;return Ek(n,b).forEach(function(_){c.push({type:"horizontal",pos:[u,st(_.pos-a+d,.1)],size:m,className:_.className,direction:""})}),Ek(e,m).forEach(function(_){c.push({type:"vertical",pos:[st(_.pos-i+u,.1),d],size:b,className:_.className,direction:""})}),c}function iJ(n,e){if(!e.length)return[];var t=n.props.groupable,r=n.state,i=r.containerClientRect,a=r.rootMatrix,o=r.is3d,c=r.offsetDelta,u=o?4:3,d=ne(IZ(a,i,u),2),h=d[0],p=d[1],m=t?0:c[0],b=t?0:c[1];return e.map(function(_){var w=_.element.getBoundingClientRect(),S=w.left-h-m,T=w.top-p-b,A=T+w.height,D=S+w.width,O=ne(Dd(a,[S,T],u),2),M=O[0],j=O[1],C=ne(Dd(a,[D,A],u),2),I=C[0],k=C[1];return Z(Z({},_),{rect:{left:M,right:I,top:j,bottom:k,center:(M+I)/2,middle:(j+k)/2}})})}function $m(n){var e=n.state,t=e.container,r=n.props.snapContainer||t;if(e.snapContainer===r&&e.guidelines&&e.guidelines.length)return!1;var i=e.containerClientRect,a={left:0,top:0,bottom:0,right:0};if(t!==r){var o=ts(r,!0);if(o){var c=jh(o),u=Rk(e,[c.left-i.left,c.top-i.top]),d=Rk(e,[c.right-i.right,c.bottom-i.bottom]);a.left=st(u[0],1e-5),a.top=st(u[1],1e-5),a.right=st(d[0],1e-5),a.bottom=st(d[1],1e-5)}}return e.snapContainer=r,e.snapOffset=a,e.guidelines=X_(n),e.enableSnap=!0,!0}function zj(n,e,t,r,i,a){var o=Gc(n,e,t,a?4:3),c=ur(o,r);return CS(o,Ye(i,c))}function Sk(n){return n?n/xe(n):0}function aJ(n,e,t,r,i,a){var o=a.fixedDirection,c=NZ(t,o,r),u=SS(n,e,t,r),d=Ae(Ae([],ne(qZ(n,e,c,r,i,a)),!1),ne(Nj(n,u,a)),!1),h=uv(d,0),p=uv(d,1);return{width:{isBound:h.isBound,offset:h.offset[0]},height:{isBound:p.isBound,offset:p.offset[1]}}}function sJ(n,e,t,r,i,a,o,c,u){var d=ur(e,o),h=fy(n,c,{vertical:[d[0]],horizontal:[d[1]]}),p=h.horizontal.offset,m=h.vertical.offset;if(st(m,F_)||st(p,F_)){var b=ne(os({datas:u,distX:-m,distY:-p}),2),_=b[0],w=b[1],S=Math.min(i||1/0,t+o[0]*_),T=Math.min(a||1/0,r+o[1]*w);return[S-t,T-r]}return[0,0]}function Lj(n,e,t,r,i,a,o,c){for(var u=Wi(n.state),d=n.props.keepRatio,h=0,p=0,m=0;m<2;++m){var b=e(h,p),_=aJ(n,b,i,d,o,c),w=_.width,S=_.height,T=w.isBound,A=S.isBound,D=w.offset,O=S.offset;if(m===1&&(T||(D=0),A||(O=0)),m===0&&o&&!T&&!A)return[0,0];if(d){var M=xe(D)*(t?1/t:1),j=xe(O)*(r?1/r:1),C=T&&A?M<j:A||!T&&M<j;C?D=t*O/r:O=r*D/t}h+=D,p+=O}if(!d&&i[0]&&i[1]){var I=$Z(n,u,i,a,c),k=I.maxWidth,z=I.maxHeight,L=ne(sJ(n,e(h,p).map(function(J){return J.map(function(Y){return st(Y,F_)})}),t+h,r+p,k,z,i,o,c),2),D=L[0],O=L[1];h+=D,p+=O}return[h,p]}function Ph(n){return n<0&&(n=n%360+360),n%=360,n}function oJ(n,e){e=Ph(e);var t=Math.floor(n/360),r=t*360+360-e,i=t*360+e;return xe(n-r)<xe(n-i)?r:i}function d1(n,e){n=Ph(n),e=Ph(e);var t=Ph(n-e);return Math.min(t,360-t)}function lJ(n,e,t,r){var i,a=n.props,o=(i=a[Sj])!==null&&i!==void 0?i:5,c=a[Tj];if(Xd(n,"rotatable")){var u=e.pos1,d=e.pos2,h=e.pos3,p=e.pos4,m=e.origin,b=t*Math.PI/180,_=[u,d,h,p].map(function(O){return Ye(O,m)}),w=_.map(function(O){return Wp(O,b)}),S=Ae(Ae([],ne(SZ(n,_,w,m,t)),!1),ne(zZ(n,_,w,m,t)),!1);S.sort(function(O,M){return xe(O-t)-xe(M-t)});var T=S.length>0;if(T)return{isSnap:T,dist:T?S[0]:t}}if(c?.length&&o){var A=c.slice().sort(function(O,M){return d1(O,r)-d1(M,r)}),D=A[0];if(d1(D,r)<=o)return{isSnap:!0,dist:t+oJ(r,D)-r}}return{isSnap:!1,dist:t}}function cJ(n,e,t,r,i,a,o){if(!Xd(n,"resizable"))return[0,0];var c=o.fixedDirection,u=o.nextAllMatrix,d=n.state,h=d.allMatrix,p=d.is3d;return Lj(n,function(m,b){return zj(u||h,e+m,t+b,c,i,p)},e,t,r,i,a,o)}function uJ(n,e,t,r,i){if(!Xd(n,"scalable"))return[0,0];var a=i.startOffsetWidth,o=i.startOffsetHeight,c=i.fixedPosition,u=i.fixedDirection,d=i.is3d,h=Lj(n,function(p,m){return zj(cZ(i,Nt(e,[p/a,m/o])),a,o,u,c,d)},a,o,t,c,r,i);return[h[0]/a,h[1]/o]}function dJ(n,e){e.absolutePoses=Wi(n.state)}function Tk(n){var e=[];return n.forEach(function(t){t.guidelineInfos.forEach(function(r){var i=r.guideline;oi(e,function(a){return a.guideline===i})||(i.direction="",e.push({guideline:i,posInfo:t}))})}),e.map(function(t){var r=t.guideline,i=t.posInfo;return Z(Z({},r),{direction:i.direction})})}function Ak(n,e,t,r,i,a){var o=xS(uy(n,a),e,t),c=o.vertical,u=o.horizontal,d=Wu();c.forEach(function(_){_.isBound&&(_.direction==="start"&&(d.left=!0),_.direction==="end"&&(d.right=!0),r.push({type:"bounds",pos:_.pos}))}),u.forEach(function(_){_.isBound&&(_.direction==="start"&&(d.top=!0),_.direction==="end"&&(d.bottom=!0),i.push({type:"bounds",pos:_.pos}))});var h=LZ(n),p=h.boundMap,m=h.vertical,b=h.horizontal;return m.forEach(function(_){$s(r,function(w){var S=w.type,T=w.pos;return S==="bounds"&&T===_})>=0||r.push({type:"bounds",pos:_})}),b.forEach(function(_){$s(i,function(w){var S=w.type,T=w.pos;return S==="bounds"&&T===_})>=0||i.push({type:"bounds",pos:_})}),{boundMap:d,innerBoundMap:p}}var fJ=DS("",["resizable","scalable"]),hJ={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold","snapGridAll",Sj,Tj,Aj,Cj,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(n,e){var t=n.state,r=t.top,i=t.left,a=t.pos1,o=t.pos2,c=t.pos3,u=t.pos4,d=t.snapRenderInfo,h=n.props.snapRenderThreshold,p=h===void 0?1:h;if(!d||!d.render||!Xd(n,""))return Zu(n,"boundMap",Wu(),function(te){return JSON.stringify(te)}),Zu(n,"innerBoundMap",Wu(),function(te){return JSON.stringify(te)}),[];t.guidelines=X_(n);var m=Math.min(a[0],o[0],c[0],u[0]),b=Math.min(a[1],o[1],c[1],u[1]),_=d.externalPoses||[],w=Wi(n.state),S=[],T=[],A=[],D=[],O=[],M=Yi(w),j=M.width,C=M.height,I=M.top,k=M.left,z=M.bottom,L=M.right,B={left:k,right:L,top:I,bottom:z,center:(k+L)/2,middle:(I+z)/2},P=_.length>0,J=P?Yi(_):{};if(!d.request){if(d.direction&&O.push(kZ(n,w,d.direction,p,p)),d.snap){var Y=Yi(w);d.center&&(Y.middle=(Y.top+Y.bottom)/2,Y.center=(Y.left+Y.right)/2),O.push(pk(n,Y,p,p))}P&&(d.center&&(J.middle=(J.top+J.bottom)/2,J.center=(J.left+J.right)/2),O.push(pk(n,J,p,p))),O.forEach(function(te){var le=te.vertical.posInfos,fe=te.horizontal.posInfos;S.push.apply(S,Ae([],ne(le.filter(function(oe){var Ee=oe.guidelineInfos;return Ee.some(function(ke){var Ke=ke.guideline;return!Ke.hide})}).map(function(oe){return{type:"snap",pos:oe.pos}})),!1)),T.push.apply(T,Ae([],ne(fe.filter(function(oe){var Ee=oe.guidelineInfos;return Ee.some(function(ke){var Ke=ke.guideline;return!Ke.hide})}).map(function(oe){return{type:"snap",pos:oe.pos}})),!1)),A.push.apply(A,Ae([],ne(Tk(le)),!1)),D.push.apply(D,Ae([],ne(Tk(fe)),!1))})}var H=Ak(n,[k,L],[I,z],S,T),W=H.boundMap,K=H.innerBoundMap;P&&Ak(n,[J.left,J.right],[J.top,J.bottom],S,T,d.externalBounds);var de=Ae(Ae([],ne(A),!1),ne(D),!1),Q=de.filter(function(te){return te.element&&!te.gapRects}),G=de.filter(function(te){return te.gapRects}).sort(function(te,le){return te.gap-le.gap});je(n,"onSnap",{guidelines:de.filter(function(te){var le=te.element;return!le}),elements:Q,gaps:G},!0);var $=Zu(n,"boundMap",W,function(te){return JSON.stringify(te)},Wu()),ee=Zu(n,"innerBoundMap",K,function(te){return JSON.stringify(te)},Wu());return(W===$||K===ee)&&je(n,"onBound",{bounds:W,innerBounds:K},!0),Ae(Ae(Ae(Ae(Ae(Ae([],ne(ZZ(n,Q,[m,b],B,e)),!1),ne(JZ(n,G,[m,b],B,e)),!1),ne(wk(n,"horizontal",D,[i,r],B,e)),!1),ne(wk(n,"vertical",A,[i,r],B,e)),!1),ne(_k(n,"horizontal",T,m,r,j,0,e)),!1),ne(_k(n,"vertical",S,b,i,C,1,e)),!1)},dragStart:function(n,e){n.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},$m(n)},drag:function(n){var e=n.state;$m(n)||(e.guidelines=X_(n)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart:function(n){this.unset(n)},dragEnd:function(n){this.unset(n)},dragControlCondition:function(n,e){if(fJ(n,e)||K_(n,e))return!0;if(!e.isRequest&&e.inputEvent)return cr(e.inputEvent.target,Ge("snap-control"))},dragControlStart:function(n){n.state.snapRenderInfo=null,$m(n)},dragControl:function(n){this.drag(n)},dragControlEnd:function(n){this.unset(n)},dragGroupStart:function(n,e){this.dragStart(n,e)},dragGroup:function(n){this.drag(n)},dragGroupEnd:function(n){this.unset(n)},dragGroupControlStart:function(n){n.state.snapRenderInfo=null,$m(n)},dragGroupControl:function(n){this.drag(n)},dragGroupControlEnd:function(n){this.unset(n)},unset:function(n){var e=n.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function pJ(n,e){return[n[0]*e[0],n[1]*e[1]]}function Ge(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return cW.apply(void 0,Ae([mS],ne(n),!1))}function Bj(n){n()}function gJ(n){return!n||n==="none"?[1,0,0,1,0,0]:ya(n)?n:fp(n)}function Oh(n,e,t){return sv(e,Oc(t,e),n,Oc(t.map(function(r){return-r}),e))}function mJ(n,e,t){if(e==="%"){var r=AS(n.ownerSVGElement);return r[t?"width":"height"]/100}return 1}function vJ(n){var e=yJ(IS(n,":before"));return e.map(function(t,r){var i=$p(t),a=i.value,o=i.unit;return a*mJ(n,o,r===0)})}function fv(n){return n?n.split(" "):["0","0"]}function yJ(n){return fv(n.transformOrigin)}function Uj(n){var e=li(n),t=e("transform");if(t&&t!=="none")return t;if("transform"in n){var r=n.transform,i=r.baseVal;if(!i)return"";var a=i.length;if(!a)return"";for(var o=[],c=function(d){var h=i[d].matrix;o.push("matrix(".concat(["a","b","c","d","e","f"].map(function(p){return h[p]}).join(", "),")"))},u=0;u<a;++u)c(u);return o.join(" ")}return""}function pp(n,e,t,r,i){var a,o,c=aS(n)||xl(n),u=!1,d,h;if(!n||t)d=n;else{var p=(a=n?.assignedSlot)===null||a===void 0?void 0:a.parentElement,m=n.parentElement;p?(u=!0,h=m,d=p):d=m}for(var b=!1,_=n===e||d===e,w="relative",S=1,T=parseFloat(i?.("zoom"))||1,A=i?.("position");d&&d!==c;){e===d&&(_=!0);var D=li(d),O=d.tagName.toLowerCase(),M=Uj(d),j=D("willChange"),C=parseFloat(D("zoom"))||1;if(w=D("position"),r&&C!==1){S=C;break}if(!t&&r&&T!==1&&A&&A!=="absolute"||O==="svg"||O==="foreignobject"||w!=="static"||M&&M!=="none"||j==="transform")break;var I=(o=n?.assignedSlot)===null||o===void 0?void 0:o.parentNode,k=d.parentNode;I&&(u=!0,h=k);var z=k;if(z&&z.nodeType===11){d=z.host,b=!0,w=li(d)("position");break}d=z,w="relative"}return{offsetZoom:S,hasSlot:u,parentSlotElement:h,isCustomElement:b,isStatic:w==="static",isEnd:_||!d||d===c,offsetParent:d||c}}function bJ(n,e){var t,r=n.tagName.toLowerCase(),i=n.offsetLeft,a=n.offsetTop,o=li(n),c=ny(i),u=!c,d,h;return!u&&(r!=="svg"||n.ownerSVGElement)?(d=sj?vJ(n):fv(o("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice(),u=!0,r==="svg"?(i=0,a=0):(t=ne(wJ(n,d,n===e&&e.tagName.toLowerCase()==="g"),4),i=t[0],a=t[1],d[0]=t[2],d[1]=t[3])):(d=fv(o("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice()),{tagName:r,isSVG:c,hasOffset:u,offset:[i||0,a||0],origin:d,targetOrigin:h}}function Fj(n,e){var t=li(n),r=li(xl(n)),i=r("position");if(!e&&(!i||i==="static"))return[0,0];var a=parseInt(r("marginLeft"),10),o=parseInt(r("marginTop"),10);return t("position")==="absolute"&&((t("top")!=="auto"||t("bottom")!=="auto")&&(o=0),(t("left")!=="auto"||t("right")!=="auto")&&(a=0)),[a,o]}function W_(n){n.forEach(function(e){var t=e.matrix;t&&(e.matrix=ba(t,3,4))})}function xJ(n){for(var e=n.parentElement,t=!1,r=xl(n);e;){var i=IS(e).transform;if(i&&i!=="none"){t=!0;break}if(e===r)break;e=e.parentElement}return{fixedContainer:e||r,hasTransform:t}}function hy(n,e){return e===void 0&&(e=n.length>9),"".concat(e?"matrix3d":"matrix","(").concat(Z3(n,!e).join(","),")")}function AS(n){var e=n.clientWidth,t=n.clientHeight;if(!n)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:t};var r=n.viewBox,i=r&&r.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||t,clientWidth:e,clientHeight:t}}function _J(n,e){var t,r=AS(n),i=r.width,a=r.height,o=r.clientWidth,c=r.clientHeight,u=o/i,d=c/a,h=n.preserveAspectRatio.baseVal,p=h.align,m=h.meetOrSlice,b=[0,0],_=[u,d],w=[0,0];if(p!==1){var S=(p-2)%3,T=Math.floor((p-2)/3);b[0]=i*S/2,b[1]=a*T/2;var A=m===2?Math.max(d,u):Math.min(u,d);_[0]=A,_[1]=A,w[0]=(o-i)/2*S,w[1]=(c-a)/2*T}var D=fS(_,e);return t=ne(w,2),D[e*(e-1)]=t[0],D[e*(e-1)+1]=t[1],Oh(D,e,b)}function wJ(n,e,t){var r=n.tagName.toLowerCase();if(!n.getBBox||!t&&r==="g")return[0,0,0,0];var i=li(n),a=i("transform-box")==="fill-box",o=n.getBBox(),c=AS(n.ownerSVGElement),u=o.x,d=o.y;r==="foreignobject"&&!u&&!d&&(u=parseFloat(n.getAttribute("x"))||0,d=parseFloat(n.getAttribute("y"))||0);var h=u-c.x,p=d-c.y,m=a?e[0]:e[0]-h,b=a?e[1]:e[1]-p;return[h,p,m,b]}function Tn(n,e,t){return zr(n,Pc(e,t),t)}function Gc(n,e,t,r){return[[0,0],[e,0],[0,t],[e,t]].map(function(i){return Tn(n,i,r)})}function Yi(n){var e=n.map(function(d){return d[0]}),t=n.map(function(d){return d[1]}),r=Math.min.apply(Math,Ae([],ne(e),!1)),i=Math.min.apply(Math,Ae([],ne(t),!1)),a=Math.max.apply(Math,Ae([],ne(e),!1)),o=Math.max.apply(Math,Ae([],ne(t),!1)),c=a-r,u=o-i;return{left:r,top:i,right:a,bottom:o,width:c,height:u}}function Ck(n,e,t,r){var i=Gc(n,e,t,r);return Yi(i)}function EJ(n,e,t,r,i){var a,o=n.target,c=n.origin,u=e.matrix,d=qj(o),h=d.offsetWidth,p=d.offsetHeight,m=t.getBoundingClientRect(),b=[0,0];t===xl(t)&&(b=Fj(o,!0));for(var _=o.getBoundingClientRect(),w=_.left-m.left+t.scrollLeft-(t.clientLeft||0)+b[0],S=_.top-m.top+t.scrollTop-(t.clientTop||0)+b[1],T=_.width,A=_.height,D=sv(r,i,u),O=Ck(D,h,p,r),M=O.left,j=O.top,C=O.width,I=O.height,k=Tn(D,c,r),z=Ye(k,[M,j]),L=[w+z[0]*T/C,S+z[1]*A/I],B=[0,0],P=0;++P<10;){var J=rs(i,r);a=ne(Ye(Tn(J,L,r),Tn(J,k,r)),2),B[0]=a[0],B[1]=a[1];var Y=sv(r,i,Oc(B,r),u),H=Ck(Y,h,p,r),W=H.left,K=H.top,de=W-w,Q=K-S;if(xe(de)<2&&xe(Q)<2)break;L[0]-=de,L[1]-=Q}return B.map(function(G){return Math.round(G)})}function SJ(n,e,t){var r=n.length===16,i=r?4:3,a=e.map(function(u){return Tn(n,u,i)}),o=t.left,c=t.top;return a.map(function(u){return[u[0]+o,u[1]+c]})}function Xi(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function Gj(n,e){return Xi([e[0]-n[0],e[1]-n[1]])}function ph(n,e,t,r){t===void 0&&(t=1),r===void 0&&(r=Fn(n,e));var i=Gj(n,e);return{transform:"translateY(-50%) translate(".concat(n[0],"px, ").concat(n[1],"px) rotate(").concat(r,"rad) scaleY(").concat(t,")"),width:"".concat(i,"px")}}function hv(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=t.length,a=t.reduce(function(c,u){return c+u[0]},0)/i,o=t.reduce(function(c,u){return c+u[1]},0)/i;return{transform:"translateZ(0px) translate(".concat(a,"px, ").concat(o,"px) rotate(").concat(n,"rad) scale(").concat(e,")")}}function Vc(n,e){var t=n[e];return ya(t)?Z(Z({},n),t):n}function qj(n){var e=n&&!ny(n.offsetWidth),t=0,r=0,i=0,a=0,o=0,c=0,u=0,d=0,h=0,p=0,m=0,b=0,_=1/0,w=1/0,S=1/0,T=1/0,A=0,D=0,O=!1;if(n)if(!e&&n.ownerSVGElement){var M=n.getBBox();O=!0,t=M.width,r=M.height,o=t,c=r,u=t,d=r,i=t,a=r}else{var j=li(n),C=n.style,I=j("boxSizing")==="border-box",k=parseFloat(j("borderLeftWidth"))||0,z=parseFloat(j("borderRightWidth"))||0,L=parseFloat(j("borderTopWidth"))||0,B=parseFloat(j("borderBottomWidth"))||0,P=parseFloat(j("paddingLeft"))||0,J=parseFloat(j("paddingRight"))||0,Y=parseFloat(j("paddingTop"))||0,H=parseFloat(j("paddingBottom"))||0,W=P+J,K=Y+H,de=k+z,Q=L+B,G=W+de,$=K+Q,ee=j("position"),te=0,le=0;if("clientLeft"in n){var fe=null;if(ee==="absolute"){var oe=pp(n,xl(n));fe=oe.offsetParent}else fe=n.parentElement;if(fe){var Ee=li(fe);te=parseFloat(Ee("width")),le=parseFloat(Ee("height"))}}h=Math.max(W,nn(j("minWidth"),te)||0),p=Math.max(K,nn(j("minHeight"),le)||0),_=nn(j("maxWidth"),te),w=nn(j("maxHeight"),le),isNaN(_)&&(_=1/0),isNaN(w)&&(w=1/0),A=nn(C.width,0)||0,D=nn(C.height,0)||0,o=parseFloat(j("width"))||0,c=parseFloat(j("height"))||0,u=xe(o-A)<1?R_(h,A||o,_):o,d=xe(c-D)<1?R_(p,D||c,w):c,t=u,r=d,i=u,a=d,I?(S=_,T=w,m=h,b=p,u=t-G,d=r-$):(S=_+G,T=w+$,m=h+G,b=p+$,t=u+G,r=d+$),i=u+W,a=d+K}return{svg:O,offsetWidth:t,offsetHeight:r,clientWidth:i,clientHeight:a,contentWidth:u,contentHeight:d,inlineCSSWidth:A,inlineCSSHeight:D,cssWidth:o,cssHeight:c,minWidth:h,minHeight:p,maxWidth:_,maxHeight:w,minOffsetWidth:m,minOffsetHeight:b,maxOffsetWidth:S,maxOffsetHeight:T}}function Hj(n,e){return Fn(e>0?n[0]:n[1],e>0?n[1]:n[0])}function Ym(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function $j(n,e){var t=n===xl(n)||n===aS(n),r={clientLeft:n.clientLeft,clientTop:n.clientTop,clientWidth:n.clientWidth,clientHeight:n.clientHeight,scrollWidth:n.scrollWidth,scrollHeight:n.scrollHeight,overflow:!1};return t&&(r.clientHeight=Math.max(e.height,r.clientHeight),r.scrollHeight=Math.max(e.height,r.scrollHeight)),r.overflow=li(n)("overflow")!=="visible",Z(Z({},e),r)}function f1(n,e,t,r){var i=n.left,a=n.right,o=n.top,c=n.bottom,u=e.top,d=e.left,h={left:d+i,top:u+o,right:d+a,bottom:u+c,width:a-i,height:c-o};return t&&r?$j(t,h):h}function jh(n,e){var t=0,r=0,i=0,a=0;if(n){var o=n.getBoundingClientRect();t=o.left,r=o.top,i=o.width,a=o.height}var c={left:t,top:r,width:i,height:a,right:t+i,bottom:r+a};return n&&e?$j(n,c):c}function TJ(n){var e=n.props,t=e.groupable,r=e.svgOrigin,i=n.getState(),a=i.offsetWidth,o=i.offsetHeight,c=i.svg,u=i.transformOrigin;return!t&&c&&r?NS(r,a,o):u}function Yj(n,e,t,r){var i;if(n)i=n;else if(e)i=[0,0];else{var a=t.target;i=Kj(a,r)}return i}function Kj(n,e){if(n){var t=n.getAttribute("data-rotation")||"",r=n.getAttribute("data-direction");if(e.deg=t,!!r){var i=[0,0];return r.indexOf("w")>-1&&(i[0]=-1),r.indexOf("e")>-1&&(i[0]=1),r.indexOf("n")>-1&&(i[1]=-1),r.indexOf("s")>-1&&(i[1]=1),i}}}function CS(n,e){return[Nt(e,n[0]),Nt(e,n[1]),Nt(e,n[2]),Nt(e,n[3])]}function Wi(n){var e=n.left,t=n.top,r=n.pos1,i=n.pos2,a=n.pos3,o=n.pos4;return CS([r,i,a,o],[e,t])}function Q_(n,e){n[e?"controlAbles":"targetAbles"].forEach(function(t){t.unset&&t.unset(n)})}function Qu(n,e){var t=e?"controlGesto":"targetGesto",r=n[t];r?.isIdle()===!1&&Q_(n,e),r?.unset(),n[t]=null}function $r(n,e){if(e){var t=Kd(e);t.nextStyle=Z(Z({},t.nextStyle),n)}return{style:n,cssText:Ys(n).map(function(r){return"".concat(x0(r,"-"),": ").concat(n[r],";")}).join("")}}function Xj(n,e,t){var r=e.afterTransform||e.transform;return Z(Z({},$r(Z(Z(Z({},n.style),e.style),{transform:r}),t)),{afterTransform:r,transform:n.transform})}function ht(n,e,t,r){var i=e.datas;i.datas||(i.datas={});var a=Z(Z({},t),{target:n.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:n,moveable:n,datas:i.datas,isRequest:e.isRequest,isRequestChild:e.isRequestChild,isFirstDrag:!!e.isFirstDrag,isTrusted:e.isTrusted!==!1,stopAble:function(){i.isEventStart=!1},stopDrag:function(){var o;(o=e.stop)===null||o===void 0||o.call(e)}});return i.isStartEvent?r||(i.lastEvent=a):i.isStartEvent=!0,a}function Si(n,e,t){var r=e.datas,i="isDrag"in t?t.isDrag:e.isDrag;return r.datas||(r.datas={}),Z(Z({isDrag:i},t),{moveable:n,target:n.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:n,lastEvent:r.lastEvent,isDouble:e.isDouble,datas:r.datas,isFirstDrag:!!e.isFirstDrag})}function py(n,e,t){n._emitter.on(e,t)}function je(n,e,t,r,i){return n.triggerEvent(e,t,r,i)}function IS(n,e){return rl(n).getComputedStyle(n,e)}function Km(n,e,t){var r={},i={};return n.filter(function(a){var o=a.name;if(r[o]||!e.some(function(c){return a[c]}))return!1;if(!t&&a.ableGroup){if(i[a.ableGroup])return!1;i[a.ableGroup]=!0}return r[o]=!0,!0})}function Z_(n,e){return n===e||n==null&&e==null}function Ik(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(var t=n.length-1,r=0;r<t;++r){var i=n[r];if(!ny(i))return i}return n[t]}function Wj(n,e){var t=[],r=[];return n.forEach(function(i,a){var o=e(i,a,n),c=r.indexOf(o),u=t[c]||[];c===-1&&(r.push(o),t.push(u)),u.push(i)}),t}function AJ(n,e){var t=[],r={};return n.forEach(function(i,a){var o=e(i,a,n),c=r[o];c||(c=[],r[o]=c,t.push(c)),c.push(i)}),t}function Qj(n){return n.reduce(function(e,t){return e.concat(t)},[])}function Rd(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return n.sort(function(t,r){return xe(r)-xe(t)}),n[0]}function Dd(n,e,t){return zr(rs(n,t),Pc(e,t),t)}function CJ(n,e){var t,r=n.is3d,i=n.rootMatrix,a=r?4:3;return t=ne(Dd(i,[e.distX,e.distY],a),2),e.distX=t[0],e.distY=t[1],e}function zi(n,e,t,r){if(!t[0]&&!t[1])return e;var i=Tn(n,[Sk(t[0]||1),0],r),a=Tn(n,[0,Sk(t[1]||1)],r),o=Tn(n,[t[0]/Xi(i),t[1]/Xi(a)],r);return Nt(e,o)}function ua(n,e,t){return t?"".concat(n/e*100,"%"):"".concat(n,"px")}function pv(n){return xe(n)<=Kr?0:n}function RS(n){return function(e){if(!e.isDragging(n))return"";var t=mZ(e,n),r=t.deg;return r?Ge("view-control-rotation".concat(r)):""}}function DS(n,e){return e===void 0&&(e=[n]),function(t,r){if(r.isRequest)return e.some(function(a){return r.requestAble===a})?r.parentDirection:!1;var i=r.inputEvent.target;return cr(i,Ge("direction"))&&(!n||cr(i,Ge(n)))}}function IJ(n,e,t){var r,i=Ad(n,{"x%":function(M){return M/100*e.offsetWidth},"y%":function(M){return M/100*e.offsetHeight}}),a=n.slice(0,t<0?void 0:t),o=n.slice(0,t<0?void 0:t+1),c=n[t]||"",u=t<0?[]:n.slice(t),d=t<0?[]:n.slice(t+1),h=i.slice(0,t<0?void 0:t),p=i.slice(0,t<0?void 0:t+1),m=(r=i[t])!==null&&r!==void 0?r:Ad([""])[0],b=t<0?[]:i.slice(t),_=t<0?[]:i.slice(t+1),w=m?[m]:[],S=Uu(h),T=Uu(p),A=Uu(b),D=Uu(_),O=rn(S,A,4);return{transforms:n,beforeFunctionMatrix:S,beforeFunctionMatrix2:T,targetFunctionMatrix:Uu(w),afterFunctionMatrix:A,afterFunctionMatrix2:D,allFunctionMatrix:O,beforeFunctions:h,beforeFunctions2:p,targetFunction:w[0],afterFunctions:b,afterFunctions2:_,beforeFunctionTexts:a,beforeFunctionTexts2:o,targetFunctionText:c,afterFunctionTexts:u,afterFunctionTexts2:d}}function RJ(n){return!n||!ya(n)||$d(n)?!1:nr(n)||"length"in n}function ts(n,e){return n?$d(n)?n:si(n)?e?document.querySelector(n):n:nS(n)?n():D3(n)?n:"current"in n?n.current:n:null}function kS(n,e){if(!n)return[];var t=RJ(n)?[].slice.call(n):[n];return t.reduce(function(r,i){return si(i)&&e?Ae(Ae([],ne(r),!1),ne([].slice.call(document.querySelectorAll(i))),!1):(nr(i)?r.push(kS(i,e)):r.push(ts(i,e)),r)},[])}function DJ(n,e,t){var r=Fn(n,e)/Math.PI*180;return r=t>=0?r:180-r,r=r>=0?r:360+r,r}function Rk(n,e){var t=n.rootMatrix,r=n.is3d,i=r?4:3,a=rs(t,i);return r||(a=ba(a,3,4)),a[12]=0,a[13]=0,a[14]=0,hQ(a,e)}function Zj(n,e,t,r,i){var a=ne(n,2),o=a[0],c=a[1],u=0,d=0;if(i&&o&&c){var h=Fn([0,0],e),p=Fn([0,0],r),m=Xi(e),b=Math.cos(h-p)*m;if(!r[0])d=b,u=d*t;else if(!r[1])u=b,d=u/t;else{var _=r[0]*o,w=r[1]*c,S=Math.atan2(_+e[0],w+e[1]),T=Math.atan2(_,w);S<0&&(S+=Math.PI*2),T<0&&(T+=Math.PI*2);var A=0;xe(S-T)<Math.PI/2||xe(S-T)>Math.PI/2*3||(T+=Math.PI),A=S-T,A>Math.PI*2?A-=Math.PI*2:A>Math.PI?A=2*Math.PI-A:A<-Math.PI&&(A=-2*Math.PI-A);var D=Xi([_+e[0],w+e[1]])*Math.cos(A);u=D*Math.sin(T)-_,d=D*Math.cos(T)-w,r[0]<0&&(u*=-1),r[1]<0&&(d*=-1)}}else u=r[0]*e[0],d=r[1]*e[1];return[u,d]}function Jj(n,e,t,r){var i,a=t.ratio,o=t.startOffsetWidth,c=t.startOffsetHeight,u=0,d=0,h=r.distX,p=r.distY,m=r.pinchScale,b=r.parentDistance,_=r.parentDist,w=r.parentScale,S=t.fixedDirection,T=[0,1].map(function(C){return xe(n[C]-S[C])}),A=[0,1].map(function(C){var I=T[C];return I!==0&&(I=2/I),I});if(_)u=_[0],d=_[1],e&&(u?d||(d=u/a):u=d*a);else if(Td(m))u=(m-1)*o,d=(m-1)*c;else if(w)u=(w[0]-1)*o,d=(w[1]-1)*c;else if(b){var D=o*T[0],O=c*T[1],M=Xi([D,O]);u=b/M*D*A[0],d=b/M*O*A[1]}else{var j=os({datas:t,distX:h,distY:p});j=A.map(function(C,I){return j[I]*C}),i=ne(Zj([o,c],j,a,n,e),2),u=i[0],d=i[1]}return{distWidth:u,distHeight:d}}function J_(n,e){if(e){if(n==="left")return{x:"0%",y:"50%"};if(n==="top")return{x:"50%",y:"50%"};if(n==="center")return{x:"50%",y:"50%"};if(n==="right")return{x:"100%",y:"50%"};if(n==="bottom")return{x:"50%",y:"100%"};var t=ne(n.split(" "),2),r=t[0],i=t[1],a=J_(r||""),o=J_(i||""),c=Z(Z({},a),o),u={x:"50%",y:"50%"};return c.x&&(u.x=c.x),c.y&&(u.y=c.y),c.value&&(c.x&&!c.y&&(u.y=c.value),!c.x&&c.y&&(u.x=c.value)),u}return n==="left"?{x:"0%"}:n==="right"?{x:"100%"}:n==="top"?{y:"0%"}:n==="bottom"?{y:"100%"}:n?n==="center"?{value:"50%"}:{value:n}:{}}function NS(n,e,t){var r=J_(n,!0),i=r.x,a=r.y;return[nn(i,e)||0,nn(a,t)||0]}function kJ(n,e,t){var r=n.map(function(a){return Ye(a,e)}),i=r.map(function(a){return Wp(a,t)});return{prev:r,next:i,result:i.map(function(a){return Nt(a,e)})}}function eV(n,e){return n.length===e.length&&n.every(function(t,r){var i=e[r],a=nr(t),o=nr(i);return a&&o?eV(t,i):!a&&!o?t===i:!1})}function Zu(n,e,t,r,i){var a=n._store,o=a[e];if(!(e in a))if(i!=null)a[e]=i,o=i;else return a[e]=t,t;return o===t||r(o)===r(t)?o:(a[e]=t,t)}function Gr(n){return n>=0?1:-1}function xe(n){return Math.abs(n)}function h1(n,e){return AW(n).map(function(t){return e(t)})}function tV(n){return Td(n)?{top:n,left:n,right:n,bottom:n}:{left:n.left||0,top:n.top||0,right:n.right||0,bottom:n.bottom||0}}var NJ=Jp("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(n,e){var t=e.datas,r=e.targets,i=e.angle,a=e.originalDatas,o=n.props,c=o.pinchable,u=o.ables;if(!c)return!1;var d="onPinch".concat(r?"Group":"","Start"),h="drag".concat(r?"Group":"","ControlStart"),p=(c===!0?n.controlAbles:u.filter(function(w){return c.indexOf(w.name)>-1})).filter(function(w){return w.canPinch&&w[h]}),m=ht(n,e,{});r&&(m.targets=r);var b=je(n,d,m);t.isPinch=b!==!1,t.ables=p;var _=t.isPinch;return _?(p.forEach(function(w){if(a[w.name]=a[w.name]||{},!!w[h]){var S=Z(Z({},e),{datas:a[w.name],parentRotate:i,isPinch:!0});w[h](n,S)}}),n.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},_):!1},pinch:function(n,e){var t=e.datas,r=e.scale,i=e.distance,a=e.originalDatas,o=e.inputEvent,c=e.targets,u=e.angle;if(t.isPinch){var d=i*(1-1/r),h=ht(n,e,{});c&&(h.targets=c);var p="onPinch".concat(c?"Group":"");je(n,p,h);var m=t.ables,b="drag".concat(c?"Group":"","Control");return m.forEach(function(_){_[b]&&_[b](n,Z(Z({},e),{datas:a[_.name],inputEvent:o,resolveMatrix:!0,pinchScale:r,parentDistance:d,parentRotate:u,isPinch:!0}))}),h}},pinchEnd:function(n,e){var t=e.datas,r=e.isPinch,i=e.inputEvent,a=e.targets,o=e.originalDatas;if(t.isPinch){var c="onPinch".concat(a?"Group":"","End"),u=Si(n,e,{isDrag:r});a&&(u.targets=a),je(n,c,u);var d=t.ables,h="drag".concat(a?"Group":"","ControlEnd");return d.forEach(function(p){p[h]&&p[h](n,Z(Z({},e),{isDrag:r,datas:o[p.name],inputEvent:i,isPinch:!0}))}),r}},pinchGroupStart:function(n,e){return this.pinchStart(n,Z(Z({},e),{targets:n.props.targets}))},pinchGroup:function(n,e){return this.pinch(n,Z(Z({},e),{targets:n.props.targets}))},pinchGroupEnd:function(n,e){return this.pinchEnd(n,Z(Z({},e),{targets:n.props.targets}))}}),Dk=DS("scalable"),MJ={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:_j("scalable"),dragControlCondition:Dk,viewClassName:RS("scalable"),dragControlStart:function(n,e){var t=e.datas,r=e.isPinch,i=e.inputEvent,a=e.parentDirection,o=Yj(a,r,i,t),c=n.state,u=c.width,d=c.height,h=c.targetTransform,p=c.target,m=c.pos1,b=c.pos2,_=c.pos4;if(!o||!p)return!1;r||Fc(n,e),t.datas={},t.transform=h,t.prevDist=[1,1],t.direction=o,t.startOffsetWidth=u,t.startOffsetHeight=d,t.startValue=[1,1];var w=!o[0]&&!o[1]||o[0]||!o[1];cy(n,e,"scale"),t.isWidth=w;function S(j){t.ratio=j&&isFinite(j)?j:0}t.startPositions=Wi(n.state);function T(j){var C=Mj(t.startPositions,j);t.fixedDirection=C.fixedDirection,t.fixedPosition=C.fixedPosition,t.fixedOffset=C.fixedOffset}t.setFixedDirection=T,S(js(m,b)/js(b,_)),T([-o[0],-o[1]]);var A=function(j){t.minScaleSize=j},D=function(j){t.maxScaleSize=j};A([-1/0,-1/0]),D([1/0,1/0]);var O=ht(n,e,Z(Z({direction:o,set:function(j){t.startValue=j},setRatio:S,setFixedDirection:T,setMinScaleSize:A,setMaxScaleSize:D},ly(n,e)),{dragStart:Fr.dragStart(n,new Cd().dragStart([0,0],e))})),M=je(n,"onScaleStart",O);return t.startFixedDirection=t.fixedDirection,M!==!1&&(t.isScale=!0,n.state.snapRenderInfo={request:e.isRequest,direction:o}),t.isScale?O:!1},dragControl:function(n,e){sy(n,e,"scale");var t=e.datas,r=e.parentKeepRatio,i=e.parentFlag,a=e.isPinch,o=e.dragClient,c=e.isRequest,u=e.useSnap,d=e.resolveMatrix,h=t.prevDist,p=t.direction,m=t.startOffsetWidth,b=t.startOffsetHeight,_=t.isScale,w=t.startValue,S=t.isWidth,T=t.ratio;if(!_)return!1;var A=n.props,D=A.throttleScale,O=A.parentMoveable,M=p;!p[0]&&!p[1]&&(M=[1,1]);var j=T&&(r??A.keepRatio)||!1,C=n.state,I=[w[0],w[1]];function k(){var Se=Jj(M,j,t,e),Ne=Se.distWidth,Be=Se.distHeight,Me=m?(m+Ne)/m:1,He=b?(b+Be)/b:1;w[0]||(I[0]=Ne/m),w[1]||(I[1]=Be/b);var we=(M[0]||j?Me:1)*I[0],Ve=(M[1]||j?He:1)*I[1];return we===0&&(we=Gr(h[0])*Gm),Ve===0&&(Ve=Gr(h[1])*Gm),[we,Ve]}var z=k();if(!a&&n.props.groupable){var L=C.snapRenderInfo||{},B=L.direction;nr(B)&&(B[0]||B[1])&&(C.snapRenderInfo={direction:p,request:e.isRequest})}je(n,"onBeforeScale",ht(n,e,{scale:z,setFixedDirection:function(Se){return t.setFixedDirection(Se),z=k(),z},startFixedDirection:t.startFixedDirection,setScale:function(Se){z=Se}},!0));var P=[z[0]/I[0],z[1]/I[1]],J=o,Y=[0,0],H=Gr(P[0]*P[1]),W=!o&&!i&&a;if(W||d?J=bS(n,t.targetAllTransform,[0,0],[0,0],t):o||(J=t.fixedPosition),a||(Y=uJ(n,P,p,!u&&c,t)),j){M[0]&&M[1]&&Y[0]&&Y[1]&&(Math.abs(Y[0]*m)>Math.abs(Y[1]*b)?Y[1]=0:Y[0]=0);var K=!Y[0]&&!Y[1];if(K&&(S?P[0]=st(P[0]*I[0],D)/I[0]:P[1]=st(P[1]*I[1],D)/I[1]),M[0]&&!M[1]||Y[0]&&!Y[1]||K&&S){P[0]+=Y[0];var de=m*P[0]*I[0]/T;P[1]=Gr(H*P[0])*xe(de/b/I[1])}else if(!M[0]&&M[1]||!Y[0]&&Y[1]||K&&!S){P[1]+=Y[1];var Q=b*P[1]*I[1]*T;P[0]=Gr(H*P[1])*xe(Q/m/I[0])}}else P[0]+=Y[0],P[1]+=Y[1],Y[0]||(P[0]=st(P[0]*I[0],D)/I[0]),Y[1]||(P[1]=st(P[1]*I[1],D)/I[1]);P[0]===0&&(P[0]=Gr(h[0])*Gm),P[1]===0&&(P[1]=Gr(h[1])*Gm),z=pJ(P,[I[0],I[1]]);var G=[m,b],$=[m*z[0],b*z[1]];$=T3($,t.minScaleSize,t.maxScaleSize,j?T:!1),z=h1(2,function(Se){return G[Se]?$[Se]/G[Se]:$[Se]}),P=h1(2,function(Se){return z[Se]/I[Se]});var ee=h1(2,function(Se){return h[Se]?P[Se]/h[Se]:P[Se]}),te="scale(".concat(P.join(", "),")"),le="scale(".concat(z.join(", "),")"),fe=oy(t,le,te),oe=!w[0]||!w[1],Ee=uZ(n,oe?le:te,t.fixedDirection,J,t.fixedOffset,t,oe),ke=W?Ee:Ye(Ee,t.prevInverseDist||[0,0]);if(t.prevDist=P,t.prevInverseDist=Ee,z[0]===h[0]&&z[1]===h[1]&&ke.every(function(Se){return!Se})&&!O&&!W)return!1;var Ke=ht(n,e,Z({offsetWidth:m,offsetHeight:b,direction:p,scale:z,dist:P,delta:ee,isPinch:!!a},gj(n,fe,ke,a,e)));return je(n,"onScale",Ke),Ke},dragControlEnd:function(n,e){var t=e.datas;if(!t.isScale)return!1;t.isScale=!1;var r=Si(n,e,{});return je(n,"onScaleEnd",r),r},dragGroupControlCondition:Dk,dragGroupControlStart:function(n,e){var t=e.datas,r=this.dragControlStart(n,e);if(!r)return!1;var i=pa(n,"resizable",e);t.moveableScale=n.scale;var a=Vs(n,this,"dragControlStart",e,function(d,h){return cv(n,d,t,h)}),o=function(d){r.setFixedDirection(d),a.forEach(function(h,p){h.setFixedDirection(d),cv(n,h.moveable,t,i[p])})};t.setFixedDirection=o;var c=Z(Z({},r),{targets:n.props.targets,events:a,setFixedDirection:o}),u=je(n,"onScaleGroupStart",c);return t.isScale=u!==!1,t.isScale?c:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isScale){py(n,"onBeforeScale",function(h){je(n,"onBeforeScaleGroup",ht(n,e,Z(Z({},h),{targets:n.props.targets}),!0))});var r=this.dragControl(n,e);if(r){var i=r.dist,a=t.moveableScale;n.scale=[i[0]*a[0],i[1]*a[1]];var o=n.props.keepRatio,c=t.fixedPosition,u=Vs(n,this,"dragControl",e,function(h,p){var m=ne(zr(Qp(n.rotation/180*Math.PI,3),[p.datas.originalX*i[0],p.datas.originalY*i[1],1],3),2),b=m[0],_=m[1];return Z(Z({},p),{parentDist:null,parentScale:i,parentKeepRatio:o,dragClient:Nt(c,[b,_])})}),d=Z({targets:n.props.targets,events:u},r);return je(n,"onScaleGroup",d),d}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isScale){this.dragControlEnd(n,e);var i=Vs(n,this,"dragControlEnd",e),a=Si(n,e,{targets:n.props.targets,events:i});return je(n,"onScaleGroupEnd",a),t}},request:function(){var n={},e=0,t=0,r=!1;return{isControl:!0,requestStart:function(i){return r=i.useSnap,{datas:n,parentDirection:i.direction||[1,1],useSnap:r}},request:function(i){return e+=i.deltaWidth,t+=i.deltaHeight,{datas:n,parentDist:[e,t],parentKeepRatio:i.keepRatio,useSnap:r}},requestEnd:function(){return{datas:n,isDrag:!0,useSnap:r}}}}};function zo(n,e){return n.map(function(t,r){return iv(t,e[r],1,2)})}function kk(n,e,t){var r=Fn(n,e),i=Fn(n,t),a=i-r;return a>=0?a:a+2*Math.PI}function PJ(n,e){var t=kk(n[0],n[1],n[2]),r=kk(e[0],e[1],e[2]),i=Math.PI;return!(t>=i&&r<=i||t<=i&&r>=i)}var OJ={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:RS("warpable"),render:function(n,e){var t=n.props,r=t.resizable,i=t.scalable,a=t.warpable,o=t.zoom;if(r||i||!a)return[];var c=n.state,u=c.pos1,d=c.pos2,h=c.pos3,p=c.pos4,m=zo(u,d),b=zo(d,u),_=zo(u,h),w=zo(h,u),S=zo(h,p),T=zo(p,h),A=zo(d,p),D=zo(p,d);return Ae([e.createElement("div",{className:Ge("line"),key:"middeLine1",style:ph(m,S,o)}),e.createElement("div",{className:Ge("line"),key:"middeLine2",style:ph(b,T,o)}),e.createElement("div",{className:Ge("line"),key:"middeLine3",style:ph(_,A,o)}),e.createElement("div",{className:Ge("line"),key:"middeLine4",style:ph(w,D,o)})],ne(wj(n,"warpable",e)),!1)},dragControlCondition:function(n,e){if(e.isRequest)return!1;var t=e.inputEvent.target;return cr(t,Ge("direction"))&&cr(t,Ge("warpable"))},dragControlStart:function(n,e){var t=e.datas,r=e.inputEvent,i=n.props.target,a=r.target,o=Kj(a,t);if(!o||!i)return!1;var c=n.state,u=c.transformOrigin,d=c.is3d,h=c.targetTransform,p=c.targetMatrix,m=c.width,b=c.height,_=c.left,w=c.top;t.datas={},t.targetTransform=h,t.warpTargetMatrix=d?p:ba(p,3,4),t.targetInverseMatrix=W3(rs(t.warpTargetMatrix,4),3,4),t.direction=o,t.left=_,t.top=w,t.poses=[[0,0],[m,0],[0,b],[m,b]].map(function(A){return Ye(A,u)}),t.nextPoses=t.poses.map(function(A){var D=ne(A,2),O=D[0],M=D[1];return zr(t.warpTargetMatrix,[O,M,0,1],4)}),t.startValue=mn(4),t.prevMatrix=mn(4),t.absolutePoses=Wi(c),t.posIndexes=pj(o),Fc(n,e),cy(n,e,"matrix3d"),c.snapRenderInfo={request:e.isRequest,direction:o};var S=ht(n,e,Z({set:function(A){t.startValue=A}},ly(n,e))),T=je(n,"onWarpStart",S);return T!==!1&&(t.isWarp=!0),t.isWarp},dragControl:function(n,e){var t=e.datas,r=e.isRequest,i=e.distX,a=e.distY,o=t.targetInverseMatrix,c=t.prevMatrix,u=t.isWarp,d=t.startValue,h=t.poses,p=t.posIndexes,m=t.absolutePoses;if(!u)return!1;if(sy(n,e,"matrix3d"),Xd(n,"warpable")){var b=p.map(function(k){return m[k]});b.length>1&&b.push([(b[0][0]+b[1][0])/2,(b[0][1]+b[1][1])/2]);var _=fy(n,r,{horizontal:b.map(function(k){return k[1]+a}),vertical:b.map(function(k){return k[0]+i})}),w=_.horizontal,S=_.vertical;a-=w.offset,i-=S.offset}var T=os({datas:t,distX:i,distY:a},!0),A=t.nextPoses.slice();if(p.forEach(function(k){A[k]=Nt(A[k],T)}),!eZ.every(function(k){return PJ(k.map(function(z){return h[z]}),k.map(function(z){return A[z]}))}))return!1;var D=hS(h[0],h[2],h[1],h[3],A[0],A[2],A[1],A[3]);if(!D.length)return!1;var O=rn(o,D,4),M=fj(t,O,!0),j=rn(rs(c,4),M,4);t.prevMatrix=M;var C=rn(d,M,4),I=oy(t,"matrix3d(".concat(C.join(", "),")"),"matrix3d(".concat(M.join(", "),")"));return yS(e,I),je(n,"onWarp",ht(n,e,Z({delta:j,matrix:C,dist:M,multiply:rn,transform:I},$r({transform:I},e)))),!0},dragControlEnd:function(n,e){var t=e.datas,r=e.isDrag;return t.isWarp?(t.isWarp=!1,je(n,"onWarpEnd",Si(n,e,{})),r):!1}},jJ=Ge("area-pieces"),Xm=Ge("area-piece"),nV=Ge("avoid"),VJ=Ge("view-dragging");function p1(n){var e=n.areaElement;if(e){var t=n.state,r=t.width,i=t.height;R3(e,nV),e.style.cssText+="left: 0px; top: 0px; width: ".concat(r,"px; height: ").concat(i,"px")}}function Nk(n){return n.createElement("div",{key:"area_pieces",className:jJ},n.createElement("div",{className:Xm}),n.createElement("div",{className:Xm}),n.createElement("div",{className:Xm}),n.createElement("div",{className:Xm}))}var rV={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(n,e){var t=n.props,r=t.target,i=t.dragArea,a=t.groupable,o=t.passDragArea,c=n.getState(),u=c.width,d=c.height,h=c.renderPoses,p=o?Ge("area","pass"):Ge("area");if(a)return[e.createElement("div",{key:"area",ref:Os(n,"areaElement"),className:p}),Nk(e)];if(!r||!i)return[];var m=hS([0,0],[u,0],[0,d],[u,d],h[0],h[1],h[2],h[3]),b=m.length?hy(m,!0):"none";return[e.createElement("div",{key:"area",ref:Os(n,"areaElement"),className:p,style:{top:"0px",left:"0px",width:"".concat(u,"px"),height:"".concat(d,"px"),transformOrigin:"0 0",transform:b}}),Nk(e)]},dragStart:function(n,e){var t=e.datas,r=e.clientX,i=e.clientY,a=e.inputEvent;if(!a)return!1;t.isDragArea=!1;var o=n.areaElement,c=n.state,u=c.moveableClientRect,d=c.renderPoses,h=c.rootMatrix,p=c.is3d,m=u.left,b=u.top,_=Yi(d),w=_.left,S=_.top,T=_.width,A=_.height,D=p?4:3,O=ne(Dd(h,[r-m,i-b],D),2),M=O[0],j=O[1];M-=w,j-=S;var C=[{left:w,top:S,width:T,height:j-10},{left:w,top:S,width:M-10,height:A},{left:w,top:S+j+10,width:T,height:A-j-10},{left:w+M+10,top:S,width:T-M-10,height:A}],I=[].slice.call(o.nextElementSibling.children);C.forEach(function(k,z){I[z].style.cssText="left: ".concat(k.left,"px;top: ").concat(k.top,"px; width: ").concat(k.width,"px; height: ").concat(k.height,"px;")}),I3(o,nV),c.disableNativeEvent=!0},drag:function(n,e){var t=e.datas,r=e.inputEvent;if(this.enableNativeEvent(n),!r)return!1;t.isDragArea||(t.isDragArea=!0,p1(n))},dragEnd:function(n,e){this.enableNativeEvent(n);var t=e.inputEvent,r=e.datas;if(!t)return!1;r.isDragArea||p1(n)},dragGroupStart:function(n,e){return this.dragStart(n,e)},dragGroup:function(n,e){return this.drag(n,e)},dragGroupEnd:function(n,e){return this.dragEnd(n,e)},unset:function(n){p1(n),n.state.disableNativeEvent=!1},enableNativeEvent:function(n){var e=n.state;e.disableNativeEvent&&S3(function(){e.disableNativeEvent=!1})}},zJ=Jp("origin",{props:["origin","svgOrigin"],render:function(n,e){var t=n.props,r=t.zoom,i=t.svgOrigin,a=t.groupable,o=n.getState(),c=o.beforeOrigin,u=o.rotation,d=o.svg,h=o.allMatrix,p=o.is3d,m=o.left,b=o.top,_=o.offsetWidth,w=o.offsetHeight,S;if(!a&&d&&i){var T=ne(NS(i,_,w),2),A=T[0],D=T[1],O=p?4:3,M=Tn(h,[A,D],O);S=hv(u,r,Ye(M,[m,b]))}else S=hv(u,r,c);return[e.createElement("div",{className:Ge("control","origin"),style:S,key:"beforeOrigin"})]}});function LJ(n){var e=n.scrollContainer;return[e.scrollLeft,e.scrollTop]}var BJ={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(n,e){var t=n.props,r=t.scrollContainer,i=r===void 0?n.getContainer():r,a=t.scrollOptions,o=new bQ,c=ts(i,!0);e.datas.dragScroll=o,n.state.dragScroll=o;var u=e.isControl?"controlGesto":"targetGesto",d=e.targets;o.on("scroll",function(h){var p=h.container,m=h.direction,b=ht(n,e,{scrollContainer:p,direction:m}),_=d?"onScrollGroup":"onScroll";d&&(b.targets=d),je(n,_,b)}).on("move",function(h){var p=h.offsetX,m=h.offsetY,b=h.inputEvent;n[u].scrollBy(p,m,b.inputEvent,!1)}).on("scrollDrag",function(h){var p=h.next;p(n[u].getCurrentEvent())}),o.dragStart(e,Z({container:c},a))},checkScroll:function(n,e){var t=e.datas.dragScroll;if(t){var r=n.props,i=r.scrollContainer,a=i===void 0?n.getContainer():i,o=r.scrollThreshold,c=o===void 0?0:o,u=r.scrollThrottleTime,d=u===void 0?0:u,h=r.getScrollPosition,p=h===void 0?LJ:h,m=r.scrollOptions;return t.drag(e,Z({container:a,threshold:c,throttleTime:d,getScrollPosition:function(b){return p({scrollContainer:b.container,direction:b.direction})}},m)),!0}},drag:function(n,e){return this.checkScroll(n,e)},dragEnd:function(n,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(n,e){return this.dragStart(n,Z(Z({},e),{isControl:!0}))},dragControl:function(n,e){return this.drag(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupStart:function(n,e){return this.dragStart(n,Z(Z({},e),{targets:n.props.targets}))},dragGroup:function(n,e){return this.drag(n,Z(Z({},e),{targets:n.props.targets}))},dragGroupEnd:function(n,e){return this.dragEnd(n,Z(Z({},e),{targets:n.props.targets}))},dragGroupControlStart:function(n,e){return this.dragStart(n,Z(Z({},e),{targets:n.props.targets,isControl:!0}))},dragGroupControl:function(n,e){return this.drag(n,Z(Z({},e),{targets:n.props.targets}))},dragGroupControEnd:function(n,e){return this.dragEnd(n,Z(Z({},e),{targets:n.props.targets}))},unset:function(n){var e,t=n.state;(e=t.dragScroll)===null||e===void 0||e.dragEnd(),t.dragScroll=null}},iV={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","preventRightClick","preventWheelClick","requestStyles"],events:["changeTargets"]},UJ=Jp("padding",{props:["padding"],render:function(n,e){var t=n.props;if(t.dragArea)return[];var r=tV(t.padding||{}),i=r.left,a=r.top,o=r.right,c=r.bottom,u=n.getState(),d=u.renderPoses,h=u.pos1,p=u.pos2,m=u.pos3,b=u.pos4,_=[h,p,m,b],w=[];return i>0&&w.push([0,2]),a>0&&w.push([0,1]),o>0&&w.push([1,3]),c>0&&w.push([2,3]),w.map(function(S,T){var A=ne(S,2),D=A[0],O=A[1],M=_[D],j=_[O],C=d[D],I=d[O],k=hS([0,0],[100,0],[0,100],[100,100],M,j,C,I);if(k.length)return e.createElement("div",{key:"padding".concat(T),className:Ge("padding"),style:{transform:hy(k,!0)}})})}}),Mk=["nw","ne","se","sw"];function Wm(n,e){var t=n[0]+n[1],r=t>e?e/t:1;return n[0]*=r,n[1]=e-n[1]*r,n}var FJ=[1,2,5,6],GJ=[0,3,4,7],sc=[1,-1,-1,1],oc=[1,1,-1,-1];function MS(n,e,t,r,i,a,o,c){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=t),c===void 0&&(c=r);var u=[],d=!1,h=n.filter(function(m){return!m.virtual}),p=h.map(function(m){var b=m.horizontal,_=m.vertical,w=m.pos;if(_&&!d&&(d=!0,u.push("/")),d){var S=Math.max(0,_===1?w[1]-a:c-w[1]);return u.push(ua(S,r,e)),S}else{var S=Math.max(0,b===1?w[0]-i:o-w[0]);return u.push(ua(S,t,e)),S}});return{radiusPoses:h,styles:u,raws:p}}function aV(n){for(var e=[0,0],t=[0,0],r=n.length,i=0;i<r;++i){var a=n[i];a.sub&&(a.horizontal&&(e[1]===0&&(e[0]=i),e[1]=i-e[0]+1,t[0]=i+1),a.vertical&&(t[1]===0&&(t[0]=i),t[1]=i-t[0]+1))}return{horizontalRange:e,verticalRange:t}}function sV(n,e,t,r,i,a,o){var c,u,d,h;a===void 0&&(a=[0,0]),o===void 0&&(o=!1);var p=n.indexOf("/"),m=(p>-1?n.slice(0,p):n).length,b=n.slice(0,m),_=n.slice(m+1),w=b.length,S=_.length,T=S>0,A=ne(b,4),D=A[0],O=D===void 0?"0px":D,M=A[1],j=M===void 0?O:M,C=A[2],I=C===void 0?O:C,k=A[3],z=k===void 0?j:k,L=ne(_,4),B=L[0],P=B===void 0?O:B,J=L[1],Y=J===void 0?T?P:j:J,H=L[2],W=H===void 0?T?P:I:H,K=L[3],de=K===void 0?T?Y:z:K,Q=[O,j,I,z].map(function(fe){return nn(fe,e)}),G=[P,Y,W,de].map(function(fe){return nn(fe,t)}),$=Q.slice(),ee=G.slice();c=ne(Wm([$[0],$[1]],e),2),$[0]=c[0],$[1]=c[1],u=ne(Wm([$[3],$[2]],e),2),$[3]=u[0],$[2]=u[1],d=ne(Wm([ee[0],ee[3]],t),2),ee[0]=d[0],ee[3]=d[1],h=ne(Wm([ee[1],ee[2]],t),2),ee[1]=h[0],ee[2]=h[1];var te=o?$:$.slice(0,Math.max(a[0],w)),le=o?ee:ee.slice(0,Math.max(a[1],S));return Ae(Ae([],ne(te.map(function(fe,oe){var Ee=Mk[oe];return{virtual:oe>=w,horizontal:sc[oe],vertical:0,pos:[r+fe,i+(oc[oe]===-1?t:0)],sub:!0,raw:Q[oe],direction:Ee}})),!1),ne(le.map(function(fe,oe){var Ee=Mk[oe];return{virtual:oe>=S,horizontal:0,vertical:oc[oe],pos:[r+(sc[oe]===-1?e:0),i+fe],sub:!0,raw:G[oe],direction:Ee}})),!1)}function qJ(n,e,t,r,i){i===void 0&&(i=e.length);var a=aV(n.slice(r)),o=a.horizontalRange,c=a.verticalRange,u=t-r,d=0;if(u===0)d=i;else if(u>0&&u<o[1])d=o[1]-u;else if(u>=c[0])d=c[0]+c[1]-u;else return;n.splice(t,d),e.splice(t,d)}function HJ(n,e,t,r,i,a,o,c,u,d,h){d===void 0&&(d=0),h===void 0&&(h=0);var p=aV(n.slice(t)),m=p.horizontalRange,b=p.verticalRange;if(r>-1)for(var _=sc[r]===1?a-d:c-a,w=m[1];w<=r;++w){var S=oc[w]===1?h:u,T=0;if(r===w?T=a:w===0?T=d+_:sc[w]===-1&&(T=c-(e[t][0]-d)),n.splice(t+w,0,{horizontal:sc[w],vertical:0,pos:[T,S]}),e.splice(t+w,0,[T,S]),w===0)break}else if(i>-1){var A=oc[i]===1?o-h:u-o;if(m[1]===0&&b[1]===0){var D=[d+A,h];n.push({horizontal:sc[0],vertical:0,pos:D}),e.push(D)}for(var O=b[0],w=b[1];w<=i;++w){var T=sc[w]===1?d:c,S=0;if(i===w?S=o:w===0?S=h+A:oc[w]===1?S=e[t+O][1]:oc[w]===-1&&(S=u-(e[t+O][1]-h)),n.push({horizontal:0,vertical:oc[w],pos:[T,S]}),e.push([T,S]),w===0)break}}}function $J(n,e){e===void 0&&(e=n.map(function(i){return i.raw}));var t=n.map(function(i,a){return i.horizontal?e[a]:null}).filter(function(i){return i!=null}),r=n.map(function(i,a){return i.vertical?e[a]:null}).filter(function(i){return i!=null});return{horizontals:t,verticals:r}}var YJ=[[0,-1,"n"],[1,0,"e"]],KJ=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function PS(n,e,t){var r=n.props.clipRelative,i=n.state,a=i.width,o=i.height,c=e,u=c.type,d=c.poses,h=u==="rect",p=u==="circle";if(u==="polygon")return t.map(function(j){return"".concat(ua(j[0],a,r)," ").concat(ua(j[1],o,r))});if(h||u==="inset"){var m=t[1][1],b=t[3][0],_=t[7][0],w=t[5][1];if(h)return[m,b,w,_].map(function(j){return"".concat(j,"px")});var S=[m,a-b,o-w,_].map(function(j,C){return ua(j,C%2?a:o,r)});if(t.length>8){var T=ne(Ye(t[4],t[0]),2),A=T[0],D=T[1];S.push.apply(S,Ae(["round"],ne(MS(d.slice(8).map(function(j,C){return Z(Z({},j),{pos:t[C]})}),r,A,D,_,m,b,w).styles),!1))}return S}else if(p||u==="ellipse"){var O=t[0],M=ua(xe(t[1][1]-O[1]),p?Math.sqrt((a*a+o*o)/2):o,r),S=p?[M]:[ua(xe(t[2][0]-O[0]),a,r),M];return S.push("at",ua(O[0],a,r),ua(O[1],o,r)),S}}function gv(n,e,t,r){var i=[r,(r+e)/2,e],a=[n,(n+t)/2,t];return KJ.map(function(o){var c=ne(o,3),u=c[0],d=c[1],h=c[2],p=i[u+1],m=a[d+1];return{vertical:xe(d),horizontal:xe(u),direction:h,pos:[p,m]}})}function oV(n){var e=[1/0,-1/0],t=[1/0,-1/0];return n.forEach(function(r){var i=r.pos;e[0]=Math.min(e[0],i[0]),e[1]=Math.max(e[1],i[0]),t[0]=Math.min(t[0],i[1]),t[1]=Math.max(t[1],i[1])}),[xe(e[1]-e[0]),xe(t[1]-t[0])]}function Pk(n,e,t,r,i){var a,o,c,u,d,h,p,m,b;if(n){var _=i;if(!_){var w=li(n),S=w("clipPath");_=S!=="none"?S:w("clip")}if(!((!_||_==="none"||_==="auto")&&(_=r,!_))){var T=E3(_),A=T.prefix,D=A===void 0?_:A,O=T.value,M=O===void 0?"":O,j=D==="circle",C=" ";if(D==="polygon"){var I=dc(M||"0% 0%, 100% 0%, 100% 100%, 0% 100%");C=",";var k=I.map(function(ct){var et=ne(ct.split(" "),2),Ot=et[0],rt=et[1];return{vertical:1,horizontal:1,pos:[nn(Ot,e),nn(rt,t)]}}),z=jc(k.map(function(ct){return ct.pos}));return{type:D,clipText:_,poses:k,splitter:C,left:z.minX,right:z.maxX,top:z.minY,bottom:z.maxY}}else if(j||D==="ellipse"){var L="",B="",P=0,J=0,I=dl(M);if(j){var Y="";a=ne(I,4),o=a[0],Y=o===void 0?"50%":o,c=a[2],L=c===void 0?"50%":c,u=a[3],B=u===void 0?"50%":u,P=nn(Y,Math.sqrt((e*e+t*t)/2)),J=P}else{var H="",W="";d=ne(I,5),h=d[0],H=h===void 0?"50%":h,p=d[1],W=p===void 0?"50%":p,m=d[3],L=m===void 0?"50%":m,b=d[4],B=b===void 0?"50%":b,P=nn(H,e),J=nn(W,t)}var K=[nn(L,e),nn(B,t)],k=Ae([{vertical:1,horizontal:1,pos:K,direction:"nesw"}],ne(YJ.slice(0,j?1:2).map(function(Ot){return{vertical:xe(Ot[1]),horizontal:Ot[0],direction:Ot[2],sub:!0,pos:[K[0]+Ot[0]*P,K[1]+Ot[1]*J]}})),!1);return{type:D,clipText:_,radiusX:P,radiusY:J,left:K[0]-P,top:K[1]-J,right:K[0]+P,bottom:K[1]+J,poses:k,splitter:C}}else if(D==="inset"){var I=dl(M||"0 0 0 0"),de=I.indexOf("round"),Q=(de>-1?I.slice(0,de):I).length,G=I.slice(Q+1),$=ne(I.slice(0,Q),4),ee=$[0],te=$[1],le=te===void 0?ee:te,fe=$[2],oe=fe===void 0?ee:fe,Ee=$[3],ke=Ee===void 0?le:Ee,Ke=ne([ee,oe].map(function(Ot){return nn(Ot,t)}),2),Se=Ke[0],Ne=Ke[1],Be=ne([ke,le].map(function(Ot){return nn(Ot,e)}),2),Me=Be[0],He=Be[1],we=e-He,Ve=t-Ne,Ze=sV(G,we-Me,Ve-Se,Me,Se),k=Ae(Ae([],ne(gv(Se,we,Ve,Me)),!1),ne(Ze),!1);return{type:"inset",clipText:_,poses:k,top:Se,left:Me,right:we,bottom:Ve,radius:G,splitter:C}}else if(D==="rect"){var I=dc(M||"0px, ".concat(e,"px, ").concat(t,"px, 0px"));C=",";var Re=ne(I.map(function(jt){var Ft=$p(jt).value;return Ft}),4),Oe=Re[0],He=Re[1],Ne=Re[2],Me=Re[3],k=gv(Oe,He,Ne,Me);return{type:"rect",clipText:_,poses:k,top:Oe,right:He,bottom:Ne,left:Me,values:I,splitter:C}}}}}function XJ(n,e,t,r,i){var a=n[e],o=a.direction,c=a.sub,u=n.map(function(){return[0,0]}),d=o?o.split(""):[];if(r&&e<8){var h=d.filter(function(P){return P==="w"||P==="e"}),p=d.filter(function(P){return P==="n"||P==="s"}),m=h[0],b=p[0];u[e]=t;var _=ne(oV(n),2),w=_[0],S=_[1],T=w&&S?w/S:0;if(T&&i){var A=(e+4)%8,D=n[A].pos,O=[0,0];o.indexOf("w")>-1?O[0]=-1:o.indexOf("e")>-1&&(O[0]=1),o.indexOf("n")>-1?O[1]=-1:o.indexOf("s")>-1&&(O[1]=1);var M=Zj([w,S],t,T,O,!0),j=w+M[0],C=S+M[1],I=D[1],k=D[1],z=D[0],L=D[0];O[0]===-1?z=L-j:O[0]===1?L=z+j:(z=z-j/2,L=L+j/2),O[1]===-1?I=k-C:(O[1]===1||(I=k-C/2),k=I+C);var B=gv(I,L,k,z);n.forEach(function(P,J){u[J][0]=B[J].pos[0]-P.pos[0],u[J][1]=B[J].pos[1]-P.pos[1]})}else n.forEach(function(P,J){var Y=P.direction;Y&&(Y.indexOf(m)>-1&&(u[J][0]=t[0]),Y.indexOf(b)>-1&&(u[J][1]=t[1]))}),m&&(u[1][0]=t[0]/2,u[5][0]=t[0]/2),b&&(u[3][1]=t[1]/2,u[7][1]=t[1]/2)}else o&&!c?d.forEach(function(P){var J=P==="n"||P==="s";n.forEach(function(Y,H){var W=Y.direction,K=Y.horizontal,de=Y.vertical;!W||W.indexOf(P)===-1||(u[H]=[J||!K?0:t[0],!J||!de?0:t[1]])})}):u[e]=t;return u}function WJ(n,e){var t=ne(dj(n,e),2),r=t[0],i=t[1],a=e.datas,o=a.clipPath,c=a.clipIndex,u=o,d=u.type,h=u.poses,p=u.splitter,m=h.map(function(A){return A.pos});if(d==="polygon")m.splice(c,0,[r,i]);else if(d==="inset"){var b=FJ.indexOf(c),_=GJ.indexOf(c),w=h.length;if(HJ(h,m,8,b,_,r,i,m[4][0],m[4][1],m[0][0],m[0][1]),w===h.length)return}else return;var S=PS(n,o,m),T="".concat(d,"(").concat(S.join(p),")");je(n,"onClip",ht(n,e,Z({clipEventType:"added",clipType:d,poses:m,clipStyles:S,clipStyle:T,distX:0,distY:0},$r({clipPath:T},e))))}function QJ(n,e){var t=e.datas,r=t.clipPath,i=t.clipIndex,a=r,o=a.type,c=a.poses,u=a.splitter,d=c.map(function(b){return b.pos}),h=d.length;if(o==="polygon")c.splice(i,1),d.splice(i,1);else if(o==="inset"){if(i<8||(qJ(c,d,i,8,h),h===c.length))return}else return;var p=PS(n,r,d),m="".concat(o,"(").concat(p.join(u),")");je(n,"onClip",ht(n,e,Z({clipEventType:"removed",clipType:o,poses:d,clipStyles:p,clipStyle:m,distX:0,distY:0},$r({clipPath:m},e))))}var ZJ={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(n,e){var t=n.props,r=t.customClipPath,i=t.defaultClipPath,a=t.clipArea,o=t.zoom,c=t.groupable,u=n.getState(),d=u.target,h=u.width,p=u.height,m=u.allMatrix,b=u.is3d,_=u.left,w=u.top,S=u.pos1,T=u.pos2,A=u.pos3,D=u.pos4,O=u.clipPathState,M=u.snapBoundInfos,j=u.rotation;if(!d||c)return[];var C=Pk(d,h,p,i||"inset",O||r);if(!C)return[];var I=b?4:3,k=C.type,z=C.poses,L=z.map(function(He){var we=Tn(m,He.pos,I);return[we[0]-_,we[1]-w]}),B=[],P=[],J=k==="rect",Y=k==="inset",H=k==="polygon";if(J||Y||H){var W=Y?L.slice(0,8):L;P=W.map(function(He,we){var Ve=we===0?W[W.length-1]:W[we-1],Ze=Fn(Ve,He),Re=Gj(Ve,He);return e.createElement("div",{key:"clipLine".concat(we),className:Ge("line","clip-line","snap-control"),"data-clip-index":we,style:{width:"".concat(Re,"px"),transform:"translate(".concat(Ve[0],"px, ").concat(Ve[1],"px) rotate(").concat(Ze,"rad) scaleY(").concat(o,")")}})})}if(B=L.map(function(He,we){return e.createElement("div",{key:"clipControl".concat(we),className:Ge("control","clip-control","snap-control"),"data-clip-index":we,style:{transform:"translate(".concat(He[0],"px, ").concat(He[1],"px) rotate(").concat(j,"rad) scale(").concat(o,")")}})}),Y&&B.push.apply(B,Ae([],ne(L.slice(8).map(function(He,we){return e.createElement("div",{key:"clipRadiusControl".concat(we),className:Ge("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+we,style:{transform:"translate(".concat(He[0],"px, ").concat(He[1],"px) rotate(").concat(j,"rad) scale(").concat(o,")")}})})),!1)),k==="circle"||k==="ellipse"){var K=C.left,de=C.top,Q=C.radiusX,G=C.radiusY,$=ne(Ye(Tn(m,[K,de],I),Tn(m,[0,0],I)),2),ee=$[0],te=$[1],le="none";if(!a){for(var fe=Math.max(10,Q/5,G/5),oe=[],Ee=0;Ee<=fe;++Ee){var ke=Math.PI*2/fe*Ee;oe.push([Q+(Q-o)*Math.cos(ke),G+(G-o)*Math.sin(ke)])}oe.push([Q,-2]),oe.push([-2,-2]),oe.push([-2,G*2+2]),oe.push([Q*2+2,G*2+2]),oe.push([Q*2+2,-2]),oe.push([Q,-2]),le="polygon(".concat(oe.map(function(He){return"".concat(He[0],"px ").concat(He[1],"px")}).join(", "),")")}B.push(e.createElement("div",{key:"clipEllipse",className:Ge("clip-ellipse","snap-control"),style:{width:"".concat(Q*2,"px"),height:"".concat(G*2,"px"),clipPath:le,transform:"translate(".concat(-_+ee,"px, ").concat(-w+te,"px) ").concat(hy(m))}}))}if(a){var Ke=Yi(Ae([S,T,A,D],ne(L),!1)),Se=Ke.width,Ne=Ke.height,Be=Ke.left,Me=Ke.top;if(H||J||Y){var oe=Y?L.slice(0,8):L;B.push(e.createElement("div",{key:"clipArea",className:Ge("clip-area","snap-control"),style:{width:"".concat(Se,"px"),height:"".concat(Ne,"px"),transform:"translate(".concat(Be,"px, ").concat(Me,"px)"),clipPath:"polygon(".concat(oe.map(function(we){return"".concat(we[0]-Be,"px ").concat(we[1]-Me,"px")}).join(", "),")")}}))}}return M&&["vertical","horizontal"].forEach(function(He){var we=M[He],Ve=He==="horizontal";we.isSnap&&P.push.apply(P,Ae([],ne(we.snap.posInfos.map(function(Ze,Re){var Oe=Ze.pos,ct=Ye(Tn(m,Ve?[0,Oe]:[Oe,0],I),[_,w]),et=Ye(Tn(m,Ve?[h,Oe]:[Oe,p],I),[_,w]);return hp(e,"",ct,et,o,"clip".concat(He,"snap").concat(Re),"guideline")})),!1)),we.isBound&&P.push.apply(P,Ae([],ne(we.bounds.map(function(Ze,Re){var Oe=Ze.pos,ct=Ye(Tn(m,Ve?[0,Oe]:[Oe,0],I),[_,w]),et=Ye(Tn(m,Ve?[h,Oe]:[Oe,p],I),[_,w]);return hp(e,"",ct,et,o,"clip".concat(He,"bounds").concat(Re),"guideline","bounds","bold")})),!1))}),Ae(Ae([],ne(B),!1),ne(P),!1)},dragControlCondition:function(n,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(n,e){var t=n.props,r=t.dragWithClip,i=r===void 0?!0:r;return i?!1:this.dragControlStart(n,e)},drag:function(n,e){return this.dragControl(n,Z(Z({},e),{isDragTarget:!0}))},dragEnd:function(n,e){return this.dragControlEnd(n,e)},dragControlStart:function(n,e){var t=n.state,r=n.props,i=r.defaultClipPath,a=r.customClipPath,o=t.target,c=t.width,u=t.height,d=e.inputEvent?e.inputEvent.target:null,h=d&&d.getAttribute("class")||"",p=e.datas,m=Pk(o,c,u,i||"inset",a);if(!m)return!1;var b=m.clipText,_=m.type,w=m.poses,S=je(n,"onClipStart",ht(n,e,{clipType:_,clipStyle:b,poses:w.map(function(T){return T.pos})}));return S===!1?(p.isClipStart=!1,!1):(p.isControl=h&&h.indexOf("clip-control")>-1,p.isLine=h.indexOf("clip-line")>-1,p.isArea=h.indexOf("clip-area")>-1||h.indexOf("clip-ellipse")>-1,p.clipIndex=d?parseInt(d.getAttribute("data-clip-index"),10):-1,p.clipPath=m,p.isClipStart=!0,t.clipPathState=b,Fc(n,e),!0)},dragControl:function(n,e){var t,r,i,a=e.datas,o=e.originalDatas,c=e.isDragTarget;if(!a.isClipStart)return!1;var u=a,d=u.isControl,h=u.isLine,p=u.isArea,m=u.clipIndex,b=u.clipPath;if(!b)return!1;var _=Vc(n.props,"clippable"),w=_.keepRatio,S=0,T=0,A=o.draggable,D=os(e);c&&A?(t=ne(A.prevBeforeDist,2),S=t[0],T=t[1]):(r=ne(D,2),S=r[0],T=r[1]);var O=[S,T],M=n.state,j=M.width,C=M.height,I=!p&&!d&&!h,k=b.type,z=b.poses,L=b.splitter,B=z.map(function(yt){return yt.pos});I&&(S=-S,T=-T);var P=!d||z[m].direction==="nesw",J=k==="inset"||k==="rect",Y=z.map(function(){return[0,0]});if(d&&!P){var H=z[m],W=H.horizontal,K=H.vertical,de=[S*xe(W),T*xe(K)];Y=XJ(z,m,de,J,w)}else P&&(Y=B.map(function(){return[S,T]}));var Q=B.map(function(yt,un){return Nt(yt,Y[un])}),G=Ae([],ne(Q),!1);M.snapBoundInfos=null;var $=b.type==="circle",ee=b.type==="ellipse";if($||ee){var te=Yi(Q),le=xe(te.bottom-te.top),fe=xe(ee?te.right-te.left:le),oe=Q[0][1]+le,Ee=Q[0][0]-fe,ke=Q[0][0]+fe;$&&(G.push([ke,te.bottom]),Y.push([1,0])),G.push([te.left,oe]),Y.push([0,1]),G.push([Ee,te.bottom]),Y.push([1,0])}var Ke=Vj((_.clipHorizontalGuidelines||[]).map(function(yt){return nn("".concat(yt),C)}),(_.clipVerticalGuidelines||[]).map(function(yt){return nn("".concat(yt),j)}),j,C),Se=[],Ne=[];if($||ee)Se=[G[4][0],G[2][0]],Ne=[G[1][1],G[3][1]];else if(J){var Be=[G[0],G[2],G[4],G[6]],Me=[Y[0],Y[2],Y[4],Y[6]];Se=Be.filter(function(yt,un){return Me[un][0]}).map(function(yt){return yt[0]}),Ne=Be.filter(function(yt,un){return Me[un][1]}).map(function(yt){return yt[1]})}else Se=G.filter(function(yt,un){return Y[un][0]}).map(function(yt){return yt[0]}),Ne=G.filter(function(yt,un){return Y[un][1]}).map(function(yt){return yt[1]});var He=[0,0],we=yk(Ke,_.clipTargetBounds&&{left:0,top:0,right:j,bottom:C},Se,Ne,5,5),Ve=we.horizontal,Ze=we.vertical,Re=Ve.offset,Oe=Ze.offset;if(Ve.isBound&&(He[1]+=Re),Ze.isBound&&(He[0]+=Oe),(ee||$)&&Y[0][0]===0&&Y[0][1]===0){var te=Yi(Q),ct=te.bottom-te.top,et=ee?te.right-te.left:ct,Ot=Ze.isBound?xe(Oe):Ze.snapIndex===0?-Oe:Oe,rt=Ve.isBound?xe(Re):Ve.snapIndex===0?-Re:Re;et-=Ot,ct-=rt,$&&(ct=Rj(Ze,Ve)>0?ct:et,et=ct);var pt=G[0];G[1][1]=pt[1]-ct,G[2][0]=pt[0]+et,G[3][1]=pt[1]+ct,G[4][0]=pt[0]-et}else if(J&&w&&d){var jt=ne(oV(z),2),Ft=jt[0],jn=jt[1],ui=Ft&&jn?Ft/jn:0,ls=z[m],Zi=ls.direction||"",di=G[1][1],oe=G[5][1],Ee=G[7][0],ke=G[3][0];xe(Re)<=xe(Oe)?Re=Gr(Re)*xe(Oe)/ui:Oe=Gr(Oe)*xe(Re)*ui,Zi.indexOf("w")>-1?Ee-=Oe:Zi.indexOf("e")>-1?ke-=Oe:(Ee+=Oe/2,ke-=Oe/2),Zi.indexOf("n")>-1?di-=Re:Zi.indexOf("s")>-1?oe-=Re:(di+=Re/2,oe-=Re/2);var Ir=gv(di,ke,oe,Ee);G.forEach(function(Pe,ut){var qt;qt=ne(Ir[ut].pos,2),Pe[0]=qt[0],Pe[1]=qt[1]})}else G.forEach(function(yt,un){var dn=Y[un];dn[0]&&(yt[0]-=Oe),dn[1]&&(yt[1]-=Re)});var Sn=PS(n,b,Q),rr="".concat(k,"(").concat(Sn.join(L),")");if(M.clipPathState=rr,$||ee)Se=[G[4][0],G[2][0]],Ne=[G[1][1],G[3][1]];else if(J){var Be=[G[0],G[2],G[4],G[6]];Se=Be.map(function(un){return un[0]}),Ne=Be.map(function(un){return un[1]})}else Se=G.map(function(yt){return yt[0]}),Ne=G.map(function(yt){return yt[1]});if(M.snapBoundInfos=yk(Ke,_.clipTargetBounds&&{left:0,top:0,right:j,bottom:C},Se,Ne,1,1),A){var cn=M.is3d,eo=M.allMatrix,_a=cn?4:3,wa=He;c&&(wa=[O[0]+He[0]-D[0],O[1]+He[1]-D[1]]),A.deltaOffset=rn(eo,[wa[0],wa[1],0,0],_a)}return je(n,"onClip",ht(n,e,Z({clipEventType:"changed",clipType:k,poses:Q,clipStyle:rr,clipStyles:Sn,distX:S,distY:T},$r((i={},i[k==="rect"?"clip":"clipPath"]=rr,i),e)))),!0},dragControlEnd:function(n,e){this.unset(n);var t=e.isDrag,r=e.datas,i=e.isDouble,a=r.isLine,o=r.isClipStart,c=r.isControl;return o?(je(n,"onClipEnd",Si(n,e,{})),i&&(c?QJ(n,e):a&&WJ(n,e)),i||t):!1},unset:function(n){n.state.clipPathState="",n.state.snapBoundInfos=null}},JJ={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(n,e){return e.isRequest?e.requestAble==="originDraggable":cr(e.inputEvent.target,Ge("origin"))},dragControlStart:function(n,e){var t=e.datas;Fc(n,e);var r=ht(n,e,{dragStart:Fr.dragStart(n,new Cd().dragStart([0,0],e))}),i=je(n,"onDragOriginStart",r);return t.startOrigin=n.state.transformOrigin,t.startTargetOrigin=n.state.targetOrigin,t.prevOrigin=[0,0],t.isDragOrigin=!0,i===!1?(t.isDragOrigin=!1,!1):r},dragControl:function(n,e){var t=e.datas,r=e.isPinch,i=e.isRequest;if(!t.isDragOrigin)return!1;var a=ne(os(e),2),o=a[0],c=a[1],u=n.state,d=u.width,h=u.height,p=u.offsetMatrix,m=u.targetMatrix,b=u.is3d,_=n.props.originRelative,w=_===void 0?!0:_,S=b?4:3,T=[o,c];if(i){var A=e.distOrigin;(A[0]||A[1])&&(T=A)}var D=Nt(t.startOrigin,T),O=Nt(t.startTargetOrigin,T),M=Ye(T,t.prevOrigin),j=tg(p,m,D,S),C=n.getRect(),I=Yi(Gc(j,d,h,S)),k=[C.left-I.left,C.top-I.top];t.prevOrigin=T;var z=[ua(O[0],d,w),ua(O[1],h,w)].join(" "),L=Fr.drag(n,eg(e,n.state,k,!!r)),B=ht(n,e,Z(Z({width:d,height:h,origin:D,dist:T,delta:M,transformOrigin:z,drag:L},$r({transformOrigin:z,transform:L.transform},e)),{afterTransform:L.transform}));return je(n,"onDragOrigin",B),B},dragControlEnd:function(n,e){var t=e.datas;return t.isDragOrigin?(je(n,"onDragOriginEnd",Si(n,e,{})),!0):!1},dragGroupControlCondition:function(n,e){return this.dragControlCondition(n,e)},dragGroupControlStart:function(n,e){var t=this.dragControlStart(n,e);return!!t},dragGroupControl:function(n,e){var t=this.dragControl(n,e);return t?(n.transformOrigin=t.transformOrigin,!0):!1},request:function(n){var e={},t=n.getRect(),r=0,i=0,a=t.transformOrigin,o=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(c){return"deltaOrigin"in c?(o[0]+=c.deltaOrigin[0],o[1]+=c.deltaOrigin[1]):"origin"in c?(o[0]=c.origin[0]-a[0],o[1]=c.origin[1]-a[1]):("x"in c?r=c.x-t.left:"deltaX"in c&&(r+=c.deltaX),"y"in c?i=c.y-t.top:"deltaY"in c&&(i+=c.deltaY)),{datas:e,distX:r,distY:i,distOrigin:o}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function eee(n,e,t,r){var i=n.filter(function(u){var d=u.virtual,h=u.horizontal;return h&&!d}).length,a=n.filter(function(u){var d=u.virtual,h=u.vertical;return h&&!d}).length,o=-1;if(e===0&&(i===0?o=0:i===1&&(o=1)),e===2&&(i<=2?o=2:i<=3&&(o=3)),e===3&&(a===0?o=4:a<4&&(o=7)),e===1&&(a<=1?o=5:a<=2&&(o=6)),!(o===-1||!n[o].virtual)){var c=n[o];tee(n,o),o<4?c.pos[0]=t:c.pos[1]=r}}function tee(n,e){e<4?n.slice(0,e+1).forEach(function(t){t.virtual=!1}):(n[0].virtual&&(n[0].virtual=!1),n.slice(4,e+1).forEach(function(t){t.virtual=!1}))}function nee(n,e){e<4?n.slice(e,4).forEach(function(t){t.virtual=!0}):n.slice(e).forEach(function(t){t.virtual=!0})}function Ok(n,e,t,r,i){r===void 0&&(r=[0,0]);var a=[];return!n||n==="0px"?a=[]:a=dl(n),sV(a,e,t,0,0,r,i)}function jk(n,e,t,r,i){var a=n.state,o=a.width,c=a.height,u=MS(i,n.props.roundRelative,o,c),d=u.raws,h=u.styles,p=u.radiusPoses,m=$J(p,d),b=m.horizontals,_=m.verticals,w=h.join(" ");a.borderRadiusState=w;var S=ht(n,e,Z({horizontals:b,verticals:_,borderRadius:w,width:o,height:c,delta:r,dist:t},$r({borderRadius:w},e)));return je(n,"onRound",S),S}function Vk(n){var e,t,r=n.getState().style,i=r.borderRadius||"";if(!i&&n.props.groupable){var a=n.moveables[0],o=n.getTargets()[0];o&&(a?.props.target===o?(i=(t=(e=n.moveables[0])===null||e===void 0?void 0:e.state.style.borderRadius)!==null&&t!==void 0?t:"",r.borderRadius=i):(i=IS(o).borderRadius,r.borderRadius=i))}return i}var ree={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(n){var e=n.props.roundClickable;return e===!0||e==="line"?Ge("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(n,e){var t=n.getState(),r=t.target,i=t.width,a=t.height,o=t.allMatrix,c=t.is3d,u=t.left,d=t.top,h=t.borderRadiusState,p=n.props,m=p.minRoundControls,b=m===void 0?[0,0]:m,_=p.maxRoundControls,w=_===void 0?[4,4]:_,S=p.zoom,T=p.roundPadding,A=T===void 0?0:T,D=p.isDisplayShadowRoundControls,O=p.groupable;if(!r)return null;var M=h||Vk(n),j=c?4:3,C=Ok(M,i,a,b,!0);if(!C)return null;var I=0,k=0,z=O?[0,0]:[u,d];return C.map(function(L,B){var P=L.horizontal,J=L.vertical,Y=L.direction||"",H=Ae([],ne(L.pos),!1);k+=Math.abs(P),I+=Math.abs(J),P&&Y.indexOf("n")>-1&&(H[1]-=A),J&&Y.indexOf("w")>-1&&(H[0]-=A),P&&Y.indexOf("s")>-1&&(H[1]+=A),J&&Y.indexOf("e")>-1&&(H[0]+=A);var W=Ye(Tn(o,H,j),z),K=D&&D!=="horizontal",de=L.vertical?I<=w[1]&&(K||!L.virtual):k<=w[0]&&(D||!L.virtual);return e.createElement("div",{key:"borderRadiusControl".concat(B),className:Ge("control","border-radius",L.vertical?"vertical":"",L.virtual?"virtual":""),"data-radius-index":B,style:{display:de?"block":"none",transform:"translate(".concat(W[0],"px, ").concat(W[1],"px) scale(").concat(S,")")}})})},dragControlCondition:function(n,e){if(!e.inputEvent||e.isRequest)return!1;var t=e.inputEvent.target.getAttribute("class")||"";return t.indexOf("border-radius")>-1||t.indexOf("moveable-line")>-1&&t.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(n,e){return this.dragControlCondition(n,e)},dragControlStart:function(n,e){var t=e.inputEvent,r=e.datas,i=t.target,a=i.getAttribute("class")||"",o=a.indexOf("border-radius")>-1,c=a.indexOf("moveable-line")>-1&&a.indexOf("moveable-direction")>-1,u=o?parseInt(i.getAttribute("data-radius-index"),10):-1,d=-1;if(c){var h=i.getAttribute("data-line-key")||"";h&&(d=parseInt(h.replace(/render-line-/g,""),10),isNaN(d)&&(d=-1))}if(!o&&!c)return!1;var p=ht(n,e,{}),m=je(n,"onRoundStart",p);if(m===!1)return!1;r.lineIndex=d,r.controlIndex=u,r.isControl=o,r.isLine=c,Fc(n,e);var b=n.props,_=b.roundRelative,w=b.minRoundControls,S=w===void 0?[0,0]:w,T=n.state,A=T.width,D=T.height;r.isRound=!0,r.prevDist=[0,0];var O=Vk(n),M=Ok(O||"",A,D,S,!0)||[];return r.controlPoses=M,T.borderRadiusState=MS(M,_,A,D).styles.join(" "),p},dragControl:function(n,e){var t=e.datas,r=t.controlPoses;if(!t.isRound||!t.isControl||!r.length)return!1;var i=t.controlIndex,a=ne(os(e),2),o=a[0],c=a[1],u=[o,c],d=Ye(u,t.prevDist),h=n.props.maxRoundControls,p=h===void 0?[4,4]:h,m=n.state,b=m.width,_=m.height,w=r[i],S=w.vertical,T=w.horizontal,A=r.map(function(O){var M=O.horizontal,j=O.vertical,C=[M*T*u[0],j*S*u[1]];if(M){if(p[0]===1)return C;if(p[0]<4&&M!==T)return C}else{if(p[1]===0)return C[1]=j*T*u[0]/b*_,C;if(S){if(p[1]===1)return C;if(p[1]<4&&j!==S)return C}}return[0,0]});A[i]=u;var D=r.map(function(O,M){return Z(Z({},O),{pos:Nt(O.pos,A[M])})});return i<4?D.slice(0,i+1).forEach(function(O){O.virtual=!1}):D.slice(4,i+1).forEach(function(O){O.virtual=!1}),t.prevDist=[o,c],jk(n,e,u,d,D)},dragControlEnd:function(n,e){var t=n.state;t.borderRadiusState="";var r=e.datas,i=e.isDouble;if(!r.isRound)return!1;var a=r.isControl,o=r.controlIndex,c=r.isLine,u=r.lineIndex,d=r.controlPoses,h=d.filter(function(T){var A=T.virtual;return A}).length,p=n.props.roundClickable,m=p===void 0?!0:p;if(i&&m){if(a&&(m===!0||m==="control"))nee(d,o);else if(c&&(m===!0||m==="line")){var b=ne(dj(n,e),2),_=b[0],w=b[1];eee(d,u,_,w)}h!==d.filter(function(T){var A=T.virtual;return A}).length&&jk(n,e,[0,0],[0,0],d)}var S=Si(n,e,{});return je(n,"onRoundEnd",S),t.borderRadiusState="",S},dragGroupControlStart:function(n,e){var t=this.dragControlStart(n,e);if(!t)return!1;var r=n.moveables,i=n.props.targets,a=pa(n,"roundable",e),o=Z({targets:n.props.targets,events:a.map(function(c,u){return Z(Z({},c),{target:i[u],moveable:r[u],currentTarget:r[u]})})},t);return je(n,"onRoundGroupStart",o),t},dragGroupControl:function(n,e){var t=this.dragControl(n,e);if(!t)return!1;var r=n.moveables,i=n.props.targets,a=pa(n,"roundable",e),o=Z({targets:n.props.targets,events:a.map(function(c,u){return Z(Z(Z({},c),{target:i[u],moveable:r[u],currentTarget:r[u]}),$r({borderRadius:t.borderRadius},c))})},t);return je(n,"onRoundGroup",o),o},dragGroupControlEnd:function(n,e){var t=n.moveables,r=n.props.targets,i=pa(n,"roundable",e);py(n,"onRound",function(c){var u=Z({targets:n.props.targets,events:i.map(function(d,h){return Z(Z(Z({},d),{target:r[h],moveable:t[h],currentTarget:t[h]}),$r({borderRadius:c.borderRadius},d))})},c);je(n,"onRoundGroup",u)});var a=this.dragControlEnd(n,e);if(!a)return!1;var o=Z({targets:n.props.targets,events:i.map(function(c,u){var d;return Z(Z({},c),{target:r[u],moveable:t[u],currentTarget:t[u],lastEvent:(d=c.datas)===null||d===void 0?void 0:d.lastEvent})})},a);return je(n,"onRoundGroupEnd",o),o},unset:function(n){n.state.borderRadiusState=""}};function iee(n,e){var t=e?4:3,r=mn(t),i="matrix".concat(e?"3d":"","(").concat(r.join(","),")");return n===i||n==="matrix(1,0,0,1,0,0)"}var lV={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(n,e){var t=n.state,r=t.is3d,i=t.targetMatrix,a=t.inlineTransform,o=r?"matrix3d(".concat(i.join(","),")"):"matrix(".concat(Z3(i,!0),")"),c=!a||a==="none"?o:a;e.datas.startTransforms=iee(c,r)?[]:dl(c)},resetStyle:function(n){var e=n.datas;e.nextStyle={},e.nextTransforms=n.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(n,e){return ht(n,e,{setTransform:function(t){e.datas.startTransforms=nr(t)?t:dl(t)},isPinch:!!e.isPinch})},fillDragParams:function(n,e){return ht(n,e,{isPinch:!!e.isPinch})},dragStart:function(n,e){this.setTransform(n,e),this.resetStyle(e),je(n,"onBeforeRenderStart",this.fillDragStartParams(n,e))},drag:function(n,e){e.datas.startTransforms||this.setTransform(n,e),this.resetStyle(e),je(n,"onBeforeRender",ht(n,e,{isPinch:!!e.isPinch}))},dragEnd:function(n,e){e.datas.startTransforms||(this.setTransform(n,e),this.resetStyle(e)),je(n,"onBeforeRenderEnd",ht(n,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(n,e){var t=this;this.dragStart(n,e);var r=pa(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.setTransform(u,o),t.resetStyle(o),t.fillDragStartParams(u,o)});je(n,"onBeforeRenderGroupStart",ht(n,e,{isPinch:!!e.isPinch,targets:n.props.targets,setTransform:function(){},events:a}))},dragGroup:function(n,e){var t=this;this.drag(n,e);var r=pa(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.resetStyle(o),t.fillDragParams(u,o)});je(n,"onBeforeRenderGroup",ht(n,e,{isPinch:!!e.isPinch,targets:n.props.targets,events:a}))},dragGroupEnd:function(n,e){this.dragEnd(n,e),je(n,"onBeforeRenderGroupEnd",ht(n,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:n.props.targets}))},dragControlStart:function(n,e){return this.dragStart(n,e)},dragControl:function(n,e){return this.drag(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupControlStart:function(n,e){return this.dragGroupStart(n,e)},dragGroupControl:function(n,e){return this.dragGroup(n,e)},dragGroupControlEnd:function(n,e){return this.dragGroupEnd(n,e)}},cV={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(n,e){je(n,"onRenderStart",ht(n,e,{isPinch:!!e.isPinch}))},drag:function(n,e){je(n,"onRender",this.fillDragParams(n,e))},dragAfter:function(n,e){return this.drag(n,e)},dragEnd:function(n,e){je(n,"onRenderEnd",this.fillDragEndParams(n,e))},dragGroupStart:function(n,e){je(n,"onRenderGroupStart",ht(n,e,{isPinch:!!e.isPinch,targets:n.props.targets}))},dragGroup:function(n,e){var t=this,r=pa(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.fillDragParams(u,o)});je(n,"onRenderGroup",ht(n,e,Z(Z({isPinch:!!e.isPinch,targets:n.props.targets,transform:qm(e),transformObject:{}},$r(Hm(e))),{events:a})))},dragGroupEnd:function(n,e){var t=this,r=pa(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.fillDragEndParams(u,o)});je(n,"onRenderGroupEnd",ht(n,e,Z({isPinch:!!e.isPinch,isDrag:e.isDrag,targets:n.props.targets,events:a,transformObject:{},transform:qm(e)},$r(Hm(e)))))},dragControlStart:function(n,e){return this.dragStart(n,e)},dragControl:function(n,e){return this.drag(n,e)},dragControlAfter:function(n,e){return this.dragAfter(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupControlStart:function(n,e){return this.dragGroupStart(n,e)},dragGroupControl:function(n,e){return this.dragGroup(n,e)},dragGroupControlEnd:function(n,e){return this.dragGroupEnd(n,e)},fillDragParams:function(n,e){var t={};return Ad(lv(e)||[]).forEach(function(r){t[r.name]=r.functionValue}),ht(n,e,Z({isPinch:!!e.isPinch,transformObject:t,transform:qm(e)},$r(Hm(e))))},fillDragEndParams:function(n,e){var t={};return Ad(lv(e)||[]).forEach(function(r){t[r.name]=r.functionValue}),ht(n,e,Z({isPinch:!!e.isPinch,isDrag:e.isDrag,transformObject:t,transform:qm(e)},$r(Hm(e))))}};function Vh(n,e,t,r,i,a,o){a.clientDistX=a.distX,a.clientDistY=a.distY;var c=i==="Start",u=i==="End",d=i==="After",h=n.state.target,p=a.isRequest,m=r.indexOf("Control")>-1;if(!h||c&&m&&!p&&n.areaElement===a.inputEvent.target)return!1;var b=Ae([],ne(e),!1);if(p){var _=a.requestAble;b.some(function(B){return B.name===_})||b.push.apply(b,Ae([],ne(n.props.ables.filter(function(B){return B.name===_})),!1))}if(!b.length||b.every(function(B){return B.dragRelation}))return!1;var w=a.inputEvent,S;u&&w&&(S=document.elementFromPoint(a.clientX,a.clientY)||w.target);var T=!1,A=function(){var B;T=!0,(B=a.stop)===null||B===void 0||B.call(a)},D=c&&(!n.targetGesto||!n.controlGesto||!n.targetGesto.isFlag()||!n.controlGesto.isFlag());D&&n.updateRect(i,!0,!1);var O=a.datas,M=m?"controlGesto":"targetGesto",j=n[M],C=function(B,P,J){if(!(P in B)||j!==n[M])return!1;var Y=B.name,H=O[Y]||(O[Y]={});if(c&&(H.isEventStart=!J||!B[J]||B[J](n,a)),!H.isEventStart)return!1;var W=B[P](n,Z(Z({},a),{stop:A,datas:H,originalDatas:O,inputTarget:S}));return n._emitter.off(),c&&W===!1&&(H.isEventStart=!1),W};D&&b.forEach(function(B){B.unset&&B.unset(n)}),C(lV,"drag".concat(r).concat(i));var I=0,k=0;t.forEach(function(B){if(T)return!1;var P="".concat(B).concat(r).concat(i),J="".concat(B).concat(r,"Condition");i===""&&!p&&CJ(n.state,a);var Y=b.filter(function(K){return K[P]});Y=Y.filter(function(K,de){return K.name&&Y.indexOf(K)===de});var H=Y.filter(function(K){return C(K,P,J)}),W=H.length;T&&++I,W&&++k,!T&&c&&Y.length&&!W&&(I+=Y.filter(function(K){var de=K.name,Q=O[de];return Q.isEventStart?K.dragRelation!=="strong":!1}).length?1:0)}),(!d||k)&&C(cV,"drag".concat(r).concat(i));var z=j!==n[M]||I===t.length;if((u||T||z)&&(n.state.gestos={},n.moveables&&n.moveables.forEach(function(B){B.state.gestos={}}),b.forEach(function(B){B.unset&&B.unset(n)})),c&&!z&&!p&&k&&n.props.preventDefault&&a?.preventDefault(),n.isUnmounted||z)return!1;if(!c&&k&&!o||u){var L=n.props.flushSync||Bj;L(function(){n.updateRect(u?i:"",!0,!1),n.forceUpdate()})}return!c&&!u&&!d&&k&&!o&&Vh(n,e,t,r,i+"After",a),!0}function OS(n,e){return function(t,r){var i;r===void 0&&(r=t.inputEvent.target);var a=r,o=n.areaElement,c=n._dragTarget;return!c||!e&&(!((i=n.controlGesto)===null||i===void 0)&&i.isFlag())?!1:a===c||c.contains(a)||a===o||!n.isMoveableElement(a)&&!n.controlBox.contains(a)||cr(a,"moveable-area")||cr(a,"moveable-padding")||cr(a,"moveable-edgeDraggable")}}function uV(n,e,t){var r=n.controlBox,i=[],a=n.props,o=a.dragArea,c=n.state.target,u=a.dragTarget;i.push(r),(!o||u)&&i.push(e),!o&&u&&c&&e!==c&&a.dragTargetSelf&&i.push(c);var d=OS(n);return fV(n,i,"targetAbles",t,{dragStart:d,pinchStart:d})}function dV(n,e){var t=n.controlBox,r=[];r.push(t);var i=OS(n,!0),a=function(o,c){if(c===void 0&&(c=o.inputEvent.target),c===t)return!0;var u=i(o,c);return!u};return fV(n,r,"controlAbles",e,{dragStart:a,pinchStart:a})}function fV(n,e,t,r,i){i===void 0&&(i={});var a=t==="targetAbles",o=n.props,c=o.pinchOutside,u=o.pinchThreshold,d=o.preventClickEventOnDrag,h=o.preventClickDefault,p=o.checkInput,m=o.dragFocusedInput,b=o.preventDefault,_=b===void 0?!0:b,w=o.preventRightClick,S=w===void 0?!0:w,T=o.preventWheelClick,A=T===void 0?!0:T,D=o.dragContainer,O=ts(D,!0),M={preventDefault:_,preventRightClick:S,preventWheelClick:A,container:O||rl(n.getControlBoxElement()),pinchThreshold:u,pinchOutside:c,preventClickEventOnDrag:a?d:!1,preventClickEventOnDragStart:a?h:!1,preventClickEventByCondition:a?null:function(I){return n.controlBox.contains(I.target)},checkInput:a?p:!1,dragFocusedInput:m},j=new kQ(e,M),C=r==="Control";return["drag","pinch"].forEach(function(I){["Start","","End"].forEach(function(k){j.on("".concat(I).concat(k),function(z){var L,B=z.eventType,P=I==="drag"&&z.isPinch;if(i[B]&&!i[B](z)){z.stop();return}if(!P){var J=I==="drag"?[I]:["drag",I],Y=Ae([],ne(n[t]),!1),H=Vh(n,Y,J,r,k,z);H?(n.props.stopPropagation||k==="Start"&&C)&&((L=z?.inputEvent)===null||L===void 0||L.stopPropagation()):z.stop()}})})}),j}var aee=(function(){function n(e,t,r){var i=this;this.target=e,this.moveable=t,this.eventName=r,this.ables=[],this._onEvent=function(a){var o=i.eventName,c=i.moveable;c.state.disableNativeEvent||i.ables.forEach(function(u){u[o](c,{inputEvent:a})})},e.addEventListener(r.toLowerCase(),this._onEvent)}return n.prototype.setAbles=function(e){this.ables=e},n.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},n})();function see(n,e,t,r){var i;t===void 0&&(t=e);var a=vj(n,e),o=a.matrixes,c=a.is3d,u=a.targetMatrix,d=a.transformOrigin,h=a.targetOrigin,p=a.offsetContainer,m=a.hasFixed,b=a.zoom,_=xZ(p,t),w=_.matrixes,S=_.is3d,T=_.offsetContainer,A=_.zoom,D=r,O=4,M=n.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in n,j=u,C=mn(O),I=mn(O),k=mn(O),z=mn(O),L=o.length,B=w.map(function(de){return Z(Z({},de),{matrix:de.matrix?Ae([],ne(de.matrix),!1):void 0})}).reverse();o.reverse(),!c&&D&&(j=ba(j,3,4),W_(o)),!S&&D&&W_(B),B.forEach(function(de){I=rn(I,de.matrix,O)});var P=t||xl(n),J=((i=B[0])===null||i===void 0?void 0:i.target)||pp(P,P,!0).offsetParent,Y=B.slice(1).reduce(function(de,Q){return rn(de,Q.matrix,O)},mn(O));o.forEach(function(de,Q){if(L-2===Q&&(k=C.slice()),L-1===Q&&(z=C.slice()),!de.matrix){var G=o[Q+1],$=EJ(de,G,J,O,rn(Y,C,O));de.matrix=Oc($,O)}C=rn(C,de.matrix,O)});var H=!M&&c;j||(j=mn(H?4:3));var W=hy(M&&j.length===16?ba(j,4,3):j,H),K=I;return I=W3(I,O,O),{hasZoom:b!==1||A!==1,hasFixed:m,matrixes:o,rootMatrix:I,originalRootMatrix:K,beforeMatrix:k,offsetMatrix:z,allMatrix:C,targetMatrix:j,targetTransform:W,inlineTransform:n.style.transform,transformOrigin:d,targetOrigin:h,is3d:D,offsetContainer:p,offsetRootContainer:T}}function oee(n,e,t,r){t===void 0&&(t=e);var i=0,a=0,o=0,c={},u=qj(n);if(n&&(i=u.offsetWidth,a=u.offsetHeight),n){var d=see(n,e,t,r),h=sd(d.allMatrix,d.transformOrigin,i,a);c=Z(Z({},d),h);var p=sd(d.allMatrix,[50,50],100,100);o=Hj([p.pos1,p.pos2],p.direction)}var m=4;return Z(Z(Z({hasZoom:!1,width:i,height:a,rotation:o},u),{originalRootMatrix:mn(m),rootMatrix:mn(m),beforeMatrix:mn(m),offsetMatrix:mn(m),allMatrix:mn(m),targetMatrix:mn(m),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!0,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),c)}function ew(n,e,t,r,i,a){a===void 0&&(a=[]);var o=1,c=[0,0],u=Ym(),d=Ym(),h=Ym(),p=Ym(),m=[0,0],b={},_=oee(e,t,i,!0);if(e){var w=li(e);a.forEach(function(B){b[B]=w(B)});var S=_.is3d?4:3,T=sd(_.offsetMatrix,Nt(_.transformOrigin,Q3(_.targetMatrix,S)),_.width,_.height);o=T.direction,c=Nt(T.origin,[T.left-_.left,T.top-_.top]),p=jh(_.offsetRootContainer);var A=pp(r,r,!0).offsetParent||_.offsetRootContainer;if(_.hasZoom){var D=sd(rn(_.originalRootMatrix,_.allMatrix),_.transformOrigin,_.width,_.height),O=sd(_.originalRootMatrix,fv(li(A)("transformOrigin")).map(function(B){return parseFloat(B)}),A.offsetWidth,A.offsetHeight);if(u=f1(D,p),h=f1(O,p,A,!0),n){var M=D.left,j=D.top;d=f1({left:M,top:j,bottom:j,right:j},p)}}else{u=jh(e),h=bZ(A),n&&(d=jh(n));var C=h.left,I=h.top,k=h.clientLeft,z=h.clientTop,L=[u.left-C,u.top-I];m=Ye(Dd(_.rootMatrix,L,4),[k+_.left,z+_.top])}}return Z({targetClientRect:u,containerClientRect:h,moveableClientRect:d,rootContainerClientRect:p,beforeDirection:o,beforeOrigin:c,originalBeforeOrigin:c,target:e,style:b,offsetDelta:m},_)}function zk(n){var e=n.pos1,t=n.pos2,r=n.pos3,i=n.pos4;if(!e||!t||!r||!i)return null;var a=jc([e,t,r,i]),o=[a.minX,a.minY],c=Ye(n.origin,o);return e=Ye(e,o),t=Ye(t,o),r=Ye(r,o),i=Ye(i,o),Z(Z({},n),{left:n.left,top:n.top,posDelta:o,pos1:e,pos2:t,pos3:r,pos4:i,origin:c,beforeOrigin:c,isPersisted:!0})}var kd=(function(n){Zp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.state=Z({container:null,gestos:{},renderLines:[[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]]],renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},ew(null)),t.renderState={},t.enabledAbles=[],t.targetAbles=[],t.controlAbles=[],t.rotation=0,t.scale=[1,1],t.isMoveableMounted=!1,t.isUnmounted=!1,t.events={mouseEnter:null,mouseLeave:null},t._emitter=new ay,t._prevOriginalDragTarget=null,t._originalDragTarget=null,t._prevDragTarget=null,t._dragTarget=null,t._prevPropTarget=null,t._propTarget=null,t._prevDragArea=!1,t._isPropTargetChanged=!1,t._hasFirstTarget=!1,t._reiszeObserver=null,t._observerId=0,t._mutationObserver=null,t._rootContainer=null,t._viewContainer=null,t._viewClassNames=[],t._store={},t.checkUpdateRect=function(){if(!t.isDragging()){var r=t.props.parentMoveable;if(r){r.checkUpdateRect();return}wW(t._observerId),t._observerId=S3(function(){t.isDragging()||t.updateRect()})}},t._onPreventClick=function(r){r.stopPropagation(),r.preventDefault()},t}return e.prototype.render=function(){var t=this.props,r=this.getState(),i=t.parentPosition,a=t.className,o=t.target,c=t.zoom,u=t.cspNonce,d=t.translateZ,h=t.cssStyled,p=t.groupable,m=t.linePadding,b=t.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var _=ne(i||[0,0],2),w=_[0],S=_[1],T=r.left,A=r.top,D=r.target,O=r.direction,M=r.hasFixed,j=r.offsetDelta,C=t.targets,I=this.isDragging(),k={};this.getEnabledAbles().forEach(function(Y){k["data-able-".concat(Y.name.toLowerCase())]=!0});var z=this._getAbleClassName(),L=C&&C.length&&(D||p)||o||!this._hasFirstTarget&&this.state.isPersisted,B=this.controlBox||this.props.firstRenderState||this.props.persistData,P=[T-w,A-S];!p&&t.useAccuratePosition&&(P[0]+=j[0],P[1]+=j[1]);var J={position:M?"fixed":"absolute",display:L?"block":"none",visibility:B?"visible":"hidden",transform:"translate3d(".concat(P[0],"px, ").concat(P[1],"px, ").concat(d,")"),"--zoom":c,"--zoompx":"".concat(c,"px")};return m&&(J["--moveable-line-padding"]=m),b&&(J["--moveable-control-padding"]=b),ha(h,Z({cspNonce:u,ref:Os(this,"controlBox"),className:"".concat(Ge("control-box",O===-1?"reverse":"",I?"dragging":"")," ").concat(z," ").concat(a)},k,{onClick:this._onPreventClick,style:J}),this.renderAbles(),this._renderLines())},e.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var t=this.props,r=t.parentMoveable,i=t.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!r&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},e.prototype.componentDidUpdate=function(t){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(t)},e.prototype.componentWillUnmount=function(){var t,r;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(t=this._reiszeObserver)===null||t===void 0||t.disconnect(),(r=this._mutationObserver)===null||r===void 0||r.disconnect();var i=this._viewContainer;i&&this._changeAbleViewClassNames([]),Qu(this,!1),Qu(this,!0);var a=this.events;for(var o in a){var c=a[o];c&&c.destroy()}},e.prototype.getTargets=function(){var t=this.props.target;return t?[t]:[]},e.prototype.getAble=function(t){var r=this.props.ables||[];return oi(r,function(i){return i.name===t})},e.prototype.getContainer=function(){var t=this.props,r=t.parentMoveable,i=t.wrapperMoveable,a=t.container;return a||i&&i.getContainer()||r&&r.getContainer()||this.controlBox.parentElement},e.prototype.getControlBoxElement=function(){return this.controlBox},e.prototype.getDragElement=function(){return this._dragTarget},e.prototype.isMoveableElement=function(t){var r;return t&&(((r=t.getAttribute)===null||r===void 0?void 0:r.call(t,"class"))||"").indexOf(mS)>-1},e.prototype.dragStart=function(t,r){r===void 0&&(r=t.target);var i=this.targetGesto,a=this.controlGesto;return i&&OS(this)({inputEvent:t},r)?i.isFlag()||i.triggerDragStart(t):a&&this.isMoveableElement(r)&&(a.isFlag()||a.triggerDragStart(t)),this},e.prototype.hitTest=function(t){var r=this.state,i=r.target,a=r.pos1,o=r.pos2,c=r.pos3,u=r.pos4,d=r.targetClientRect;if(!i)return 0;var h;if($d(t)){var p=t.getBoundingClientRect();h={left:p.left,top:p.top,width:p.width,height:p.height}}else h=Z({width:0,height:0},t);var m=h.left,b=h.top,_=h.width,w=h.height,S=ok([a,o,u,c],d),T=TQ(S,[[m,b],[m+_,b],[m+_,b+w],[m,b+w]]),A=tj(S);return!T||!A?0:Math.min(100,T/A*100)},e.prototype.isInside=function(t,r){var i=this.state,a=i.target,o=i.pos1,c=i.pos2,u=i.pos3,d=i.pos4,h=i.targetClientRect;return a?V_([t,r],ok([o,c,d,u],h)):!1},e.prototype.updateRect=function(t,r,i){i===void 0&&(i=!0);var a=this.props,o=!a.parentPosition&&!a.wrapperMoveable;o&&Id(!0);var c=a.parentMoveable,u=this.state,d=u.target||a.target,h=this.getContainer(),p=c?c._rootContainer:this._rootContainer,m=ew(this.controlBox,d,h,h,p||h,this._getRequestStyles());if(!d&&this._hasFirstTarget&&a.persistData){var b=zk(a.persistData);for(var _ in b)m[_]=b[_]}o&&Id(),this.updateState(m,c?!1:i)},e.prototype.isDragging=function(t){var r,i,a=this.targetGesto,o=this.controlGesto;if(a?.isFlag()){if(!t)return!0;var c=a.getEventData();return!!(!((r=c[t])===null||r===void 0)&&r.isEventStart)}if(o?.isFlag()){if(!t)return!0;var c=o.getEventData();return!!(!((i=c[t])===null||i===void 0)&&i.isEventStart)}return!1},e.prototype.updateTarget=function(t){this.updateRect(t,!0)},e.prototype.getRect=function(){var t=this.state,r=Wi(this.state),i=ne(r,4),a=i[0],o=i[1],c=i[2],u=i[3],d=Yi(r),h=t.width,p=t.height,m=d.width,b=d.height,_=d.left,w=d.top,S=[t.left,t.top],T=Nt(S,t.origin),A=Nt(S,t.beforeOrigin),D=t.transformOrigin;return{width:m,height:b,left:_,top:w,pos1:a,pos2:o,pos3:c,pos4:u,offsetWidth:h,offsetHeight:p,beforeOrigin:A,origin:T,transformOrigin:D,rotation:this.getRotation()}},e.prototype.getManager=function(){return this},e.prototype.stopDrag=function(t){if(!t||t==="target"){var r=this.targetGesto;r?.isIdle()===!1&&Q_(this,!1),r?.stop()}if(!t||t==="control"){var r=this.controlGesto;r?.isIdle()===!1&&Q_(this,!0),r?.stop()}},e.prototype.getRotation=function(){var t=this.state,r=t.pos1,i=t.pos2,a=t.direction;return DJ(r,i,a)},e.prototype.request=function(t,r,i){r===void 0&&(r={});var a=this,o=a.props,c=o.parentMoveable||o.wrapperMoveable||a,u=c.props.ables,d=o.groupable,h=oi(u,function(T){return T.name===t});if(this.isDragging()||!h||!h.request)return{request:function(){return this},requestEnd:function(){return this}};var p=h.request(a),m=i||r.isInstant,b=p.isControl?"controlAbles":"targetAbles",_="".concat(d?"Group":"").concat(p.isControl?"Control":""),w=Ae([],ne(c[b]),!1),S={request:function(T){return Vh(a,w,["drag"],_,"",Z(Z({},p.request(T)),{requestAble:t,isRequest:!0}),m),S},requestEnd:function(){return Vh(a,w,["drag"],_,"End",Z(Z({},p.requestEnd()),{requestAble:t,isRequest:!0}),m),S}};return Vh(a,w,["drag"],_,"Start",Z(Z({},p.requestStart(r)),{requestAble:t,isRequest:!0}),m),m?S.request(r).requestEnd():S},e.prototype.getMoveables=function(){return[this]},e.prototype.destroy=function(){this.componentWillUnmount()},e.prototype.updateRenderPoses=function(){var t=this.getState(),r=this.props,i=r.padding,a=t.originalBeforeOrigin,o=t.transformOrigin,c=t.allMatrix,u=t.is3d,d=t.pos1,h=t.pos2,p=t.pos3,m=t.pos4,b=t.left,_=t.top,w=t.isPersisted,S=r.zoom||1;if(!i&&S<=1){t.renderPoses=[d,h,p,m],t.renderLines=[[d,h],[h,m],[m,p],[p,d]];return}var T=tV(i||{}),A=T.left,D=T.top,O=T.bottom,M=T.right,j=u?4:3,C=[];w?C=o:this.controlBox&&r.groupable?C=a:C=Nt(a,[b,_]);var I=sv(j,Oc(C.map(function(J){return-J}),j),c,Oc(o,j)),k=zi(I,d,[-A,-D],j),z=zi(I,h,[M,-D],j),L=zi(I,p,[-A,O],j),B=zi(I,m,[M,O],j);t.renderPoses=[k,z,L,B],t.renderLines=[[k,z],[z,B],[B,L],[L,k]];{var P=S/2;t.renderLines=[[zi(I,d,[-A-P,-D],j),zi(I,h,[M+P,-D],j)],[zi(I,h,[M,-D-P],j),zi(I,m,[M,O+P],j)],[zi(I,m,[M+P,O],j),zi(I,p,[-A-P,O],j)],[zi(I,p,[-A,O+P],j),zi(I,d,[-A,-D-P],j)]]}},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var t=this.props,r=t.target,i=t.container,a=t.parentMoveable,o=this.state,c=o.target,u=o.container;if(!(!c&&!r)){this.updateAbles();var d=!Z_(c,r),h=d||!Z_(u,i);if(h){var p=i||this.controlBox;p&&this.unsetAbles(),this.updateState({target:r,container:i}),!a&&p&&this.updateRect("End",!1,!1),this._isPropTargetChanged=d}}},e.prototype.waitToChangeTarget=function(){return new Promise(function(){})},e.prototype.triggerEvent=function(t,r){var i=this.props;if(this._emitter.trigger(t,r),i.parentMoveable&&r.isRequest&&!r.isRequestChild)return i.parentMoveable.triggerEvent(t,r,!0);var a=i[t];return a&&a(r)},e.prototype.useCSS=function(t,r){var i=this.props.customStyledMap,a=t+r;return i[a]||(i[a]=ij(t,r)),i[a]},e.prototype.getState=function(){var t,r=this.props;(r.target||!((t=r.targets)===null||t===void 0)&&t.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,a=r.persistData,o=r.firstRenderState;if(o&&!i)return o;if(!this._hasFirstTarget&&a){var c=zk(a);if(c)return this.updateState(c,!1),this.state}return this.state.isPersisted=!1,this.state},e.prototype.updateSelectors=function(){},e.prototype.unsetAbles=function(){var t=this;this.targetAbles.forEach(function(r){r.unset&&r.unset(t)})},e.prototype.updateAbles=function(t,r){t===void 0&&(t=this.props.ables),r===void 0&&(r="");var i=this.props,a=i.triggerAblesSimultaneously,o=this.getEnabledAbles(t),c="drag".concat(r,"Start"),u="pinch".concat(r,"Start"),d="drag".concat(r,"ControlStart"),h=Km(o,[c,u],a),p=Km(o,[d],a);this.enabledAbles=o,this.targetAbles=h,this.controlAbles=p},e.prototype.updateState=function(t,r){if(r){if(this.isUnmounted)return;this.setState(t)}else{var i=this.state;for(var a in t)i[a]=t[a]}},e.prototype.getEnabledAbles=function(t){t===void 0&&(t=this.props.ables);var r=this.props;return t.filter(function(i){return i&&(i.always&&r[i.name]!==!1||r[i.name])})},e.prototype.renderAbles=function(){var t=this,r=this.props,i=r.triggerAblesSimultaneously,a={createElement:ha};return this.renderState={},AJ(Qj(Km(this.getEnabledAbles(),["render"],i).map(function(o){var c=o.render;return c(t,a)||[]})).filter(function(o){return o}),function(o){var c=o.key;return c}).map(function(o){return o[0]})},e.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},e.prototype._getRequestStyles=function(){var t=this.getEnabledAbles().reduce(function(r,i){var a,o,c=(o=(a=i.requestStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return Ae(Ae([],ne(r),!1),ne(c),!1)},Ae([],ne(this.props.requestStyles||[]),!1));return t},e.prototype._updateObserver=function(t){this._updateResizeObserver(t),this._updateMutationObserver(t)},e.prototype._updateEvents=function(){var t=this.targetAbles.length,r=this.controlAbles.length,i=this._dragTarget,a=!t&&this.targetGesto||this._isTargetChanged(!0);a&&(Qu(this,!1),this.updateState({gestos:{}})),r||Qu(this,!0),i&&t&&!this.targetGesto&&(this.targetGesto=uV(this,i,"")),!this.controlGesto&&r&&(this.controlGesto=dV(this,"Control"))},e.prototype._updateTargets=function(){var t=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=t.dragArea,this._propTarget=t.target,this._originalDragTarget=t.dragTarget||t.target,this._dragTarget=ts(this._originalDragTarget,!0)},e.prototype._renderLines=function(){var t=this.props,r=t,i=r.zoom,a=r.hideDefaultLines,o=r.hideChildMoveableDefaultLines,c=r.parentMoveable;if(a||c&&o)return[];var u=this.getState(),d={createElement:ha};return u.renderLines.map(function(h,p){return hp(d,"",h[0],h[1],i,"render-line-".concat(p))})},e.prototype._isTargetChanged=function(t){var r=this.props,i=r.dragTarget||r.target,a=this._prevOriginalDragTarget,o=this._prevDragArea,c=r.dragArea,u=!c&&a!==i,d=(t||c)&&o!==c;return u||d||this._prevPropTarget!=this._propTarget},e.prototype._updateNativeEvents=function(){var t=this,r=this.props,i=r.dragArea?this.areaElement:this.state.target,a=this.events,o=Ys(a);if(this._isTargetChanged())for(var c in a){var u=a[c];u&&u.destroy(),a[c]=null}if(i){var d=this.enabledAbles;o.forEach(function(h){var p=Km(d,[h]),m=p.length>0,b=a[h];if(!m){b&&(b.destroy(),a[h]=null);return}b||(b=new aee(i,t,h),a[h]=b),b.setAbles(p)})}},e.prototype._checkUpdateRootContainer=function(){var t=this.props.rootContainer;!this._rootContainer&&t&&(this._rootContainer=ts(t,!0))},e.prototype._checkUpdateViewContainer=function(){var t=this.props.viewContainer;!this._viewContainer&&t&&(this._viewContainer=ts(t,!0));var r=this._viewContainer;r&&this._changeAbleViewClassNames(Ae(Ae([],ne(this._getAbleViewClassNames()),!1),[this.isDragging()?VJ:""],!1))},e.prototype._changeAbleViewClassNames=function(t){var r=this._viewContainer,i=Wj(t.filter(Boolean),function(d){return d}).map(function(d){var h=ne(d,1),p=h[0];return p}),a=this._viewClassNames,o=Yp(a,i),c=o.removed,u=o.added;c.forEach(function(d){R3(r,a[d])}),u.forEach(function(d){I3(r,i[d])}),this._viewClassNames=i},e.prototype._getAbleViewClassNames=function(){var t=this;return(this.getEnabledAbles().map(function(r){var i;return((i=r.viewClassName)===null||i===void 0?void 0:i.call(r,t))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},e.prototype._getAbleClassName=function(t){var r=this;t===void 0&&(t="");var i=this.getEnabledAbles(),a=this.targetGesto,o=this.controlGesto,c=a?.isFlag()?a.getEventData():{},u=o?.isFlag()?o.getEventData():{};return i.map(function(d){var h,p,m,b=d.name,_=((h=d.className)===null||h===void 0?void 0:h.call(d,r))||"";return(!((p=c[b])===null||p===void 0)&&p.isEventStart||!((m=u[b])===null||m===void 0)&&m.isEventStart)&&(_+=" ".concat(Ge("".concat(b).concat(t,"-dragging")))),_.trim()}).filter(Boolean).join(" ")},e.prototype._updateResizeObserver=function(t){var r,i=this.props,a=i.target,o=rl(this.getControlBoxElement());if(!o.ResizeObserver||!a||!i.useResizeObserver){(r=this._reiszeObserver)===null||r===void 0||r.disconnect();return}if(!(t.target===a&&this._reiszeObserver)){var c=new o.ResizeObserver(this.checkUpdateRect);c.observe(a,{box:"border-box"}),this._reiszeObserver=c}},e.prototype._updateMutationObserver=function(t){var r=this,i,a=this.props,o=a.target,c=rl(this.getControlBoxElement());if(!c.MutationObserver||!o||!a.useMutationObserver){(i=this._mutationObserver)===null||i===void 0||i.disconnect();return}if(!(t.target===o&&this._mutationObserver)){var u=new c.MutationObserver(function(d){var h,p;try{for(var m=FQ(d),b=m.next();!b.done;b=m.next()){var _=b.value;_.type==="attributes"&&_.attributeName==="style"&&r.checkUpdateRect()}}catch(w){h={error:w}}finally{try{b&&!b.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}});u.observe(o,{attributes:!0}),this._mutationObserver=u}},e.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:Bj,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},e})(j3),jS={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(n,e){var t,r=n.props,i=r.targets||[],a=n.getState(),o=a.left,c=a.top,u=a.isPersisted,d=r.zoom||1,h=n.renderGroupRects,p=((t=r.persistData)===null||t===void 0?void 0:t.children)||[];u?i=p.map(function(){return null}):p=[];var m=Zu(n,"parentPosition",[o,c],function(_){return _.join(",")}),b=Zu(n,"requestStyles",n.getRequestChildStyles(),function(_){return _.join(",")});return n.moveables=n.moveables.slice(0,i.length),Ae(Ae([],ne(i.map(function(_,w){return e.createElement(kd,{key:"moveable"+w,ref:x3(n,"moveables",w),target:_,origin:!1,requestStyles:b,cssStyled:r.cssStyled,customStyledMap:r.customStyledMap,useResizeObserver:r.useResizeObserver,useMutationObserver:r.useMutationObserver,hideChildMoveableDefaultLines:r.hideChildMoveableDefaultLines,parentMoveable:n,parentPosition:[o,c],persistData:p[w],zoom:d})})),!1),ne(Qj(h.map(function(_,w){var S=_.pos1,T=_.pos2,A=_.pos3,D=_.pos4,O=[S,T,A,D];return[[0,1],[1,3],[3,2],[2,0]].map(function(M,j){var C=ne(M,2),I=C[0],k=C[1];return hp(e,"",Ye(O[I],m),Ye(O[k],m),d,"group-rect-".concat(w,"-").concat(j))})}))),!1)}},lee=Jp("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(n,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(n,e){var t=n.props.target,r=e.inputEvent,i=e.inputTarget,a=n.isMoveableElement(i),o=!a&&n.controlBox.contains(i);if(!(!r||!i||e.isDrag||n.isMoveableElement(i)||o)){var c=t.contains(i);je(n,"onClick",ht(n,e,{isDouble:e.isDouble,inputTarget:i,isTarget:t===i,moveableTarget:n.props.target,containsTarget:c}))}},dragGroupEnd:function(n,e){var t=e.inputEvent,r=e.inputTarget;if(!(!t||!r||e.isDrag||n.isMoveableElement(r)||e.datas.inputTarget===r)){var i=n.props.targets,a=i.indexOf(r),o=a>-1,c=!1;a===-1&&(a=$s(i,function(u){return u.contains(r)}),c=a>-1),je(n,"onClickGroup",ht(n,e,{isDouble:e.isDouble,targets:i,inputTarget:r,targetIndex:a,isTarget:o,containsTarget:c,moveableTarget:i[a]}))}},dragControlEnd:function(n,e){this.dragEnd(n,e)},dragGroupControlEnd:function(n,e){this.dragEnd(n,e)}});function Ou(n){var e=n.originalDatas.draggable;return e||(n.originalDatas.draggable={},e=n.originalDatas.draggable),Z(Z({},n),{datas:e})}var cee=Jp("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(n,e){var t=n.props,r=t.edgeDraggable;return r?xj(e,"edgeDraggable",r,n.getState().renderPoses,t.zoom):[]},dragCondition:function(n,e){var t,r=n.props,i=(t=e.inputEvent)===null||t===void 0?void 0:t.target;return!r.edgeDraggable||!i?!1:!r.draggable&&cr(i,Ge("direction"))&&cr(i,Ge("edge"))&&cr(i,Ge("edgeDraggable"))},dragStart:function(n,e){return Fr.dragStart(n,Ou(e))},drag:function(n,e){return Fr.drag(n,Ou(e))},dragEnd:function(n,e){return Fr.dragEnd(n,Ou(e))},dragGroupCondition:function(n,e){var t,r=n.props,i=(t=e.inputEvent)===null||t===void 0?void 0:t.target;return!r.edgeDraggable||!i?!1:!r.draggable&&cr(i,Ge("direction"))&&cr(i,Ge("line"))},dragGroupStart:function(n,e){return Fr.dragGroupStart(n,Ou(e))},dragGroup:function(n,e){return Fr.dragGroup(n,Ou(e))},dragGroupEnd:function(n,e){return Fr.dragGroupEnd(n,Ou(e))},unset:function(n){return Fr.unset(n)}}),hV={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},VS=[lV,iV,hJ,NJ,Fr,cee,Y_,MJ,OJ,XZ,BJ,UJ,zJ,JJ,ZJ,ree,jS,hV,lee,rV,cV],uee=VS.reduce(function(n,e){return(e.events||[]).forEach(function(t){C3(n,t)}),n},[]),dee=VS.reduce(function(n,e){return(e.props||[]).forEach(function(t){C3(n,t)}),n},[]);function Lk(n,e){var t=ne(n,3),r=t[0],i=t[1],a=t[2];return(r*e[0]+i*e[1]+a)/Math.sqrt(r*r+i*i)}function Qm(n,e){var t=ne(n,2),r=t[0],i=t[1];return-r*e[0]-i*e[1]}function Bk(n,e){return Math.max.apply(Math,Ae([],ne(n.map(function(t){var r=ne(t,4),i=r[0],a=r[1],o=r[2],c=r[3];return Math.max(i[e],a[e],o[e],c[e])})),!1))}function Uk(n,e){return Math.min.apply(Math,Ae([],ne(n.map(function(t){var r=ne(t,4),i=r[0],a=r[1],o=r[2],c=r[3];return Math.min(i[e],a[e],o[e],c[e])})),!1))}function fee(n,e){var t,r,i,a=[0,0],o=[0,0],c=[0,0],u=[0,0],d=0,h=0;if(!n.length)return{pos1:a,pos2:o,pos3:c,pos4:u,minX:0,minY:0,maxX:0,maxY:0,width:d,height:h,rotation:e};var p=st(e,Kr);if(p%90){var m=p/180*Math.PI,b=Math.tan(m),_=-1/b,w=[G_,uk],S=[[0,0],[0,0]],T=[G_,uk],A=[[0,0],[0,0]];n.forEach(function(ee){ee.forEach(function(te){var le=Lk([-b,1,0],te),fe=Lk([-_,1,0],te);w[0]>le&&(S[0]=te,w[0]=le),w[1]<le&&(S[1]=te,w[1]=le),T[0]>fe&&(A[0]=te,T[0]=fe),T[1]<fe&&(A[1]=te,T[1]=fe)})});var D=ne(S,2),O=D[0],M=D[1],j=ne(A,2),C=j[0],I=j[1],k=[-b,1,Qm([-b,1],O)],z=[-b,1,Qm([-b,1],M)],L=[-_,1,Qm([-_,1],C)],B=[-_,1,Qm([-_,1],I)];t=ne([[k,L],[k,B],[z,L],[z,B]].map(function(ee){var te=ne(ee,2),le=te[0],fe=te[1];return pS(le,fe)[0]}),4),a=t[0],o=t[1],c=t[2],u=t[3],d=T[1]-T[0],h=w[1]-w[0]}else{var P=Uk(n,0),J=Uk(n,1),Y=Bk(n,0),H=Bk(n,1);if(a=[P,J],o=[Y,J],c=[P,H],u=[Y,H],d=Y-P,h=H-J,p%180){var W=[c,a,u,o];r=ne(W,4),a=r[0],o=r[1],c=r[2],u=r[3],d=H-J,h=Y-P}}if(p%360>180){var W=[u,c,o,a];i=ne(W,4),a=i[0],o=i[1],c=i[2],u=i[3]}var K=jc([a,o,c,u]),de=K.minX,Q=K.minY,G=K.maxX,$=K.maxY;return{pos1:a,pos2:o,pos3:c,pos4:u,width:d,height:h,minX:de,minY:Q,maxX:G,maxY:$,rotation:e}}function pV(n,e){var t=e.map(function(r){if(nr(r)){var i=pV(n,r),a=i.length;return a>1?i:a===1?i[0]:null}else{var o=oi(n,function(c){var u=c.manager;return u.props.target===r});return o?(o.finded=!0,o.manager):null}}).filter(Boolean);return t.length===1&&nr(t[0])?t[0]:t}var hee=(function(n){Zp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.differ=new ej,t.moveables=[],t.transformOrigin="50% 50%",t.renderGroupRects=[],t._targetGroups=[],t._hasFirstTargets=!1,t}return e.prototype.componentDidMount=function(){n.prototype.componentDidMount.call(this)},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(t,r,i){var a;i===void 0&&(i=!0);var o=this.state;if(!this.controlBox||o.isPersisted)return;Id(!0),this.moveables.forEach(function(Ee){Ee.updateRect(t,!1,!1)});var c=this.props,u=this.moveables,d=o.target||c.target,h=u.map(function(Ee){return{finded:!1,manager:Ee}}),p=this.props.targetGroups||[],m=pV(h,p),b=c.useDefaultGroupRotate;m.push.apply(m,Ae([],ne(h.filter(function(Ee){var ke=Ee.finded;return!ke}).map(function(Ee){var ke=Ee.manager;return ke})),!1));var _=[],w=!r||t!==""&&c.updateGroup,S=c.defaultGroupRotate||0;if(!this._hasFirstTargets){var T=(a=c.persistData)===null||a===void 0?void 0:a.rotation;T!=null&&(S=T)}function A(Ee,ke,Ke){var Se=Ee.map(function(Ze){if(nr(Ze)){var Re=A(Ze,ke),Oe=[Re.pos1,Re.pos2,Re.pos3,Re.pos4];return _.push(Re),{poses:Oe,rotation:Re.rotation}}else return{poses:Wi(Ze.state),rotation:Ze.getRotation()}}),Ne=Se.map(function(Ze){var Re=Ze.rotation;return Re}),Be=0,Me=Ne[0],He=Ne.every(function(Ze){return Math.abs(Me-Ze)<.1});w?Be=!b&&He?Me:S:Be=!b&&!Ke&&He?Me:ke;var we=Se.map(function(Ze){var Re=Ze.poses;return Re}),Ve=fee(we,Be);return Ve}var D=A(m,this.rotation,!0);w&&(this.rotation=D.rotation,this.transformOrigin=c.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=p,this.renderGroupRects=_;var O=this.transformOrigin,M=this.rotation,j=this.scale,C=D.width,I=D.height,k=D.minX,z=D.minY,L=kJ([[0,0],[C,0],[0,I],[C,I]],NS(O,C,I),this.rotation/180*Math.PI),B=jc(L.result),P=B.minX,J=B.minY,Y=" rotate(".concat(M,"deg)")+" scale(".concat(Gr(j[0]),", ").concat(Gr(j[1]),")"),H="translate(".concat(-P,"px, ").concat(-J,"px)").concat(Y);this.controlBox.style.transform="translate3d(".concat(k,"px, ").concat(z,"px, ").concat(this.props.translateZ||0,")"),d.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(O,";")+"width:".concat(C,"px;height:").concat(I,"px;")+"transform: ".concat(H),o.width=C,o.height=I;var W=this.getContainer(),K=ew(this.controlBox,d,this.controlBox,this.getContainer(),this._rootContainer||W,[]),de=[K.left,K.top],Q=ne(Wi(K),4),G=Q[0],$=Q[1],ee=Q[2],te=Q[3],le=jc([G,$,ee,te]),fe=[le.minX,le.minY],oe=Gr(j[0]*j[1]);K.pos1=Ye(G,fe),K.pos2=Ye($,fe),K.pos3=Ye(ee,fe),K.pos4=Ye(te,fe),K.left=k-K.left+fe[0],K.top=z-K.top+fe[1],K.origin=Ye(Nt(de,K.origin),fe),K.beforeOrigin=Ye(Nt(de,K.beforeOrigin),fe),K.originalBeforeOrigin=Nt(de,K.originalBeforeOrigin),K.transformOrigin=Ye(Nt(de,K.transformOrigin),fe),d.style.transform="translate(".concat(-P-fe[0],"px, ").concat(-J-fe[1],"px)")+Y,Id(),this.updateState(Z(Z({},K),{posDelta:fe,direction:oe,beforeDirection:oe}),i)},e.prototype.getRect=function(){return Z(Z({},n.prototype.getRect.call(this)),{children:this.moveables.map(function(t){return t.getRect()})})},e.prototype.triggerEvent=function(t,r,i){if(i||t.indexOf("Group")>-1)return n.prototype.triggerEvent.call(this,t,r);this._emitter.trigger(t,r)},e.prototype.getRequestChildStyles=function(){var t=this.getEnabledAbles().reduce(function(r,i){var a,o,c=(o=(a=i.requestChildStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return Ae(Ae([],ne(r),!1),ne(c),!1)},[]);return t},e.prototype.getMoveables=function(){return Ae([],ne(this.moveables),!1)},e.prototype.updateAbles=function(){n.prototype.updateAbles.call(this,Ae(Ae([],ne(this.props.ables),!1),[jS],!1),"Group")},e.prototype._updateTargets=function(){n.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=ts(this._originalDragTarget,!0)},e.prototype._updateEvents=function(){var t=this.state,r=this.props,i=this._prevDragTarget,a=r.dragTarget||this.areaElement,o=r.targets,c=this.differ.update(o),u=c.added,d=c.changed,h=c.removed,p=u.length||h.length;(p||this._prevOriginalDragTarget!==this._originalDragTarget)&&(Qu(this,!1),Qu(this,!0),this.updateState({gestos:{}})),i!==a&&(t.target=null),t.target||(t.target=this.areaElement,this.controlBox.style.display="block"),t.target&&(this.targetGesto||(this.targetGesto=uV(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=dV(this,"GroupControl")));var m=!Z_(t.container,r.container);m&&(t.container=r.container),(m||p||this.transformOrigin!==(r.defaultGroupOrigin||"50% 50%")||d.length||o.length&&!eV(this._targetGroups,r.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!p},e.prototype._updateObserver=function(){},e.defaultProps=Z(Z({},kd.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e})(kd),pee=(function(n){Zp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.moveables=[],t}return e.prototype.render=function(){var t=this,r,i=this.props,a=i.cspNonce,o=i.cssStyled,c=i.persistData,u=i.targets||[],d=u.length,h=this.isUnmounted||!d,p=(r=c?.children)!==null&&r!==void 0?r:[];return h&&!d&&p.length?u=p.map(function(){return null}):h||(p=[]),ha(o,{cspNonce:a,ref:Os(this,"controlBox"),className:Ge("control-box")},u.map(function(m,b){var _,w,S=(w=(_=i.individualGroupableProps)===null||_===void 0?void 0:_.call(i,m,b))!==null&&w!==void 0?w:{};return ha(kd,Z({key:"moveable"+b,ref:x3(t,"moveables",b)},i,S,{target:m,wrapperMoveable:t,isWrapperMounted:t.isMoveableMounted,persistData:p[b]}))}))},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(t,r,i){i===void 0&&(i=!0),Id(!0),this.moveables.forEach(function(a){a.updateRect(t,r,i)}),Id()},e.prototype.getRect=function(){return Z(Z({},n.prototype.getRect.call(this)),{children:this.moveables.map(function(t){return t.getRect()})})},e.prototype.request=function(t,r,i){r===void 0&&(r={});var a=this.moveables.map(function(u){return u.request(t,Z(Z({},r),{isInstant:!1}),!1)}),o=i||r.isInstant,c={request:function(u){return a.forEach(function(d){return d.request(u)}),this},requestEnd:function(){return a.forEach(function(u){return u.requestEnd()}),this}};return o?c.request(r).requestEnd():c},e.prototype.dragStart=function(t,r){r===void 0&&(r=t.target);var i=r,a=oi(this.moveables,function(o){var c=o.getTargets()[0],u=o.getControlBoxElement(),d=o.getDragElement();return!c||!d?!1:d===i||d.contains(i)||d!==c&&c===i||c.contains(i)||u===i||u.contains(i)});return a&&a.dragStart(t,r),this},e.prototype.hitTest=function(){return 0},e.prototype.isInside=function(){return!1},e.prototype.isDragging=function(){return!1},e.prototype.getDragElement=function(){return null},e.prototype.getMoveables=function(){return Ae([],ne(this.moveables),!1)},e.prototype.updateRenderPoses=function(){},e.prototype.checkUpdate=function(){},e.prototype.triggerEvent=function(){},e.prototype.updateAbles=function(){},e.prototype._updateEvents=function(){},e.prototype._updateObserver=function(){},e})(kd);function gV(n,e){var t=[];return n.forEach(function(r){if(r){if(si(r)){e[r]&&t.push.apply(t,Ae([],ne(e[r]),!1));return}nr(r)?t.push.apply(t,Ae([],ne(gV(r,e)),!1)):t.push(r)}}),t}function mV(n,e){var t=[];return n.forEach(function(r){if(r){if(si(r)){e[r]&&t.push.apply(t,Ae([],ne(e[r]),!1));return}nr(r)?t.push(mV(r,e)):t.push(r)}}),t}function vV(n,e){return n.length!==e.length||n.some(function(t,r){var i=e[r];return!t&&!i?!1:t!=i?nr(t)&&nr(i)?vV(t,i):!0:!1})}var gee=(function(n){Zp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.refTargets=[],t.selectorMap={},t._differ=new ej,t._elementTargets=[],t._tmpRefTargets=[],t._tmpSelectorMap={},t._onChangeTargets=null,t}return e.makeStyled=function(){var t={},r=this.getTotalAbles();r.forEach(function(a){var o=a.css;o&&o.forEach(function(c){t[c]=!0})});var i=Ys(t).join(`
`);this.defaultStyled=ij("div",uW(mS,JQ+i))},e.getTotalAbles=function(){return Ae([iV,jS,hV,rV],ne(this.defaultAbles),!1)},e.prototype.render=function(){var t,r=this.constructor;r.defaultStyled||r.makeStyled();var i=this.props,a=i.ables,o=i.props,c=BQ(i,["ables","props"]),u=ne(this._updateRefs(!0),2),d=u[0],h=u[1],p=gV(d,h),m=p.length>1,b=r.getTotalAbles(),_=Ae(Ae([],ne(b),!1),ne(a||[]),!1),w=Z(Z(Z({},c),o||{}),{ables:_,cssStyled:r.defaultStyled,customStyledMap:r.customStyledMap});this._elementTargets=p;var S=null,T=this.moveable,A=c.persistData;if(A?.children&&(m=!0),c.individualGroupable)return ha(pee,Z({key:"individual-group",ref:Os(this,"moveable")},w,{target:null,targets:p}));if(m){var D=mV(d,h);if(T&&!T.props.groupable&&!T.props.individualGroupable){var O=T.props.target;O&&p.indexOf(O)>-1&&(S=Z({},T.state))}return ha(hee,Z({key:"group",ref:Os(this,"moveable")},w,(t=c.groupableProps)!==null&&t!==void 0?t:{},{target:null,targets:p,targetGroups:D,firstRenderState:S}))}else{var M=p[0];if(T&&(T.props.groupable||T.props.individualGroupable)){var j=T.moveables||[],C=oi(j,function(I){return I.props.target===M});C&&(S=Z({},C.state))}return ha(kd,Z({key:"single",ref:Os(this,"moveable")},w,{target:M,firstRenderState:S}))}},e.prototype.componentDidMount=function(){this._checkChangeTargets()},e.prototype.componentDidUpdate=function(){this._checkChangeTargets()},e.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},e.prototype.getTargets=function(){var t,r;return(r=(t=this.moveable)===null||t===void 0?void 0:t.getTargets())!==null&&r!==void 0?r:[]},e.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs(),this.forceUpdate()},e.prototype.waitToChangeTarget=function(){var t=this,r;return this._onChangeTargets=function(){t._onChangeTargets=null,r()},new Promise(function(i){r=i})},e.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},e.prototype.getManager=function(){return this.moveable},e.prototype.getMoveables=function(){return this.moveable.getMoveables()},e.prototype.getDragElement=function(){return this.moveable.getDragElement()},e.prototype._updateRefs=function(t){var r=this.refTargets,i=kS(this.props.target||this.props.targets),a=typeof document<"u",o=vV(r,i),c=this.selectorMap,u={};return this.refTargets.forEach(function d(h){if(si(h)){var p=c[h];p?u[h]=c[h]:a&&(o=!0,u[h]=[].slice.call(document.querySelectorAll(h)))}else nr(h)&&h.forEach(d)}),this._tmpRefTargets=i,this._tmpSelectorMap=u,[i,u,!t&&o]},e.prototype._checkChangeTargets=function(){var t,r,i;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var a=this._differ.update(this._elementTargets),o=a.added,c=a.removed,u=o.length||c.length;u&&((r=(t=this.props).onChangeTargets)===null||r===void 0||r.call(t,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this));var d=ne(this._updateRefs(),3),h=d[0],p=d[1],m=d[2];this.refTargets=h,this.selectorMap=p,m&&this.forceUpdate()},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,UQ([dW(uj)],e.prototype,"moveable",void 0),e})(j3),mee=(function(n){Zp(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.defaultAbles=VS,e})(gee),tw=function(n,e){return tw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},tw(n,e)};function zS(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");tw(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var gp=function(){return gp=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},gp.apply(this,arguments)};function vee(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}var yee=(function(n){zS(e,n);function e(r){var i=n.call(this,r)||this;return i.state={},i.state=i.props,i}var t=e.prototype;return t.render=function(){return ha(mee,gp({ref:Os(this,"moveable")},this.state))},e})(lS),bee=dee,xee=uj,_ee=uee,wee=(function(n){zS(e,n);function e(r,i){i===void 0&&(i={});var a=n.call(this)||this;a.containerProvider=null,a.selfElement=null,a._warp=!1;var o=gp({},i),c={};_ee.forEach(function(h){c[_W("on ".concat(h))]=function(p){return a.trigger(h,p)}});var u;i.warpSelf?(delete i.warpSelf,a._warp=!0,u=r):(u=Hd(r).createElement("div"),r.appendChild(u)),a.containerProvider=ik(ha(yee,gp({ref:Os(a,"innerMoveable")},o,c)),u),a.selfElement=u;var d=o.target;return nr(d)&&d.length>1&&a.updateRect(),a}var t=e.prototype;return t.setState=function(r,i){this.innerMoveable.setState(r,i)},t.forceUpdate=function(r){this.innerMoveable.forceUpdate(r)},t.dragStart=function(r,i){i===void 0&&(i=r.target);var a=this.innerMoveable;a.$_timer&&this.forceUpdate(),this.getMoveable().dragStart(r,i)},t.destroy=function(){var r,i=this.selfElement;ik(null,i,this.containerProvider),this._warp||(r=i?.parentElement)===null||r===void 0||r.removeChild(i),this.containerProvider=null,this.off(),this.selfElement=null,this.innerMoveable=null},t.getMoveable=function(){return this.innerMoveable.moveable},e=vee([XD(xee,function(r,i){r[i]||(r[i]=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];var c=this.getMoveable();if(!(!c||!c[i]))return c[i].apply(c,a)})}),XD(bee,function(r,i){Object.defineProperty(r,i,{get:function(){return this.getMoveable().props[i]},set:function(a){var o;this.setState((o={},o[i]=a,o))},enumerable:!0,configurable:!0})})],e),e})(ay),Fk=(function(n){zS(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e})(wee),fc=(n=>(n.Mouse="mouse",n.Touch="touch",n.Pointer="pointer",n))(fc||{}),gh=(n=>(n.CancelledByMovement="cancelled-by-movement",n.CancelledByRelease="cancelled-by-release",n.CancelledOutsideElement="cancelled-outside-element",n))(gh||{});const Eee=["mousedown","mousemove","mouseup","mouseleave","mouseout"],See=["touchstart","touchmove","touchend","touchcancel"],Tee=["pointerdown","pointermove","pointerup","pointerleave","pointerout"];function Aee(n){return typeof n=="object"&&n!==null&&"pageX"in n&&typeof n.pageX=="number"&&"pageY"in n&&typeof n.pageY=="number"}function Cee(n){var e;return Eee.includes((e=n?.nativeEvent)==null?void 0:e.type)}function yV(n){var e;return See.includes((e=n?.nativeEvent)==null?void 0:e.type)||"touches"in n}function Iee(n){const{nativeEvent:e}=n;return e?Tee.includes(e?.type)||"pointerId"in e:!1}function g1(n){return Cee(n)||yV(n)||Iee(n)}function Gk(n){var e;const t=yV(n)?(e=n?.touches)==null?void 0:e[0]:n;return Aee(t)?{x:t.pageX,y:t.pageY}:null}function Ree(n){return{target:n.target,currentTarget:n.currentTarget,nativeEvent:n,persist:()=>{}}}function bV(n,{threshold:e=400,captureEvent:t=!1,detect:r=fc.Pointer,cancelOnMovement:i=!1,cancelOutsideElement:a=!0,filterEvents:o,onStart:c,onMove:u,onFinish:d,onCancel:h}={}){const p=U.useRef(!1),m=U.useRef(!1),b=U.useRef(),_=U.useRef(),w=U.useRef(n),S=U.useRef(null),T=U.useCallback(M=>j=>{m.current||g1(j)&&(o!==void 0&&!o(j)||(t&&j.persist(),c?.(j,{context:M}),S.current=Gk(j),m.current=!0,b.current=j.currentTarget,_.current=setTimeout(()=>{w.current&&(w.current(j,{context:M}),p.current=!0)},e)))},[t,o,c,e]),A=U.useCallback(M=>(j,C)=>{g1(j)&&m.current&&(S.current=null,t&&j.persist(),p.current?d?.(j,{context:M}):m.current&&h?.(j,{context:M,reason:C??gh.CancelledByRelease}),p.current=!1,m.current=!1,_.current!==void 0&&clearTimeout(_.current))},[t,d,h]),D=U.useCallback(M=>j=>{if(g1(j)&&(u?.(j,{context:M}),i!==!1&&S.current)){const C=Gk(j);if(C){const I=i===!0?25:i,k={x:Math.abs(C.x-S.current.x),y:Math.abs(C.y-S.current.y)};(k.x>I||k.y>I)&&A(M)(j,gh.CancelledByMovement)}}},[A,i,u]),O=U.useCallback(M=>{if(n===null)return{};switch(r){case fc.Mouse:{const j={onMouseDown:T(M),onMouseMove:D(M),onMouseUp:A(M)};return a&&(j.onMouseLeave=C=>{A(M)(C,gh.CancelledOutsideElement)}),j}case fc.Touch:return{onTouchStart:T(M),onTouchMove:D(M),onTouchEnd:A(M)};case fc.Pointer:{const j={onPointerDown:T(M),onPointerMove:D(M),onPointerUp:A(M)};return a&&(j.onPointerLeave=C=>A(M)(C,gh.CancelledOutsideElement)),j}}},[n,A,a,r,D,T]);return U.useEffect(()=>{function M(j){const C=Ree(j);A()(C)}return window.addEventListener("mouseup",M),window.addEventListener("touchend",M),window.addEventListener("pointerup",M),()=>{window.removeEventListener("mouseup",M),window.removeEventListener("touchend",M),window.removeEventListener("pointerup",M)}},[A]),U.useEffect(()=>()=>{_.current!==void 0&&clearTimeout(_.current)},[]),U.useEffect(()=>{w.current=n},[n]),O}const xV=()=>{if(/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream){const e=document.getElementById("ios-haptic-trigger");e&&e.click()}else typeof navigator<"u"&&navigator.vibrate&&navigator.vibrate(50)},mv=n=>n?n instanceof Date?n:typeof n=="string"?new Date(n):typeof n=="number"?new Date(n):n?.toDate&&typeof n.toDate=="function"?n.toDate():new Date:new Date,Jl=n=>mv(n).toISOString(),Dee=n=>{const e=mv(n);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`},kee=n=>{const e=n.toLowerCase();return e==="income"?"Income":e==="expense"?"Expense":e==="transfer"?"Transfer":"Expense"},LS=n=>{const e=n;let t=0;typeof e.amount=="number"?t=e.amount:typeof e.amount=="string"&&(t=parseFloat(e.amount)),isNaN(t)&&(t=0);const r=Jl(e.date);return{id:e.id||"",userId:e.userId||"",envelopeId:e.envelopeId||"",amount:t,date:r,month:e.month||Dee(r),description:e.description||"",merchant:e.merchant||void 0,type:kee(e.type||"expense"),reconciled:e.reconciled??!1,transferId:e.transferId||void 0,isAutomatic:e.isAutomatic||void 0,paymentMethod:e.paymentMethod?typeof e.paymentMethod=="string"?{id:e.paymentMethod,name:e.paymentMethod,network:"Visa",last4:"****",color:"#000000"}:e.paymentMethod:void 0}};class hc{static instance;static getInstance(){return hc.instance||(hc.instance=new hc),hc.instance}async restoreUserData(e,t){try{console.log(" BudgetService.restoreUserData: STARTING RESTORE for user:",e),await this.deleteAllUserData(e);const r=[{name:"envelopes",data:t.envelopes||[]},{name:"transactions",data:t.transactions||[]},{name:"envelopeAllocations",data:t.allocations?Object.values(t.allocations).flat():[]},{name:"monthlyBudgets",data:this.prepareMonthlyBudgetsData(t.allocations,t.incomeSources)},{name:"appSettings",data:t.appSettings?[t.appSettings]:[]}],i=[];for(const{name:o,data:c}of r)if(Array.isArray(c))for(const u of c){if(!u.id&&o!=="monthlyBudgets")continue;const d={...u,userId:e};let h=u.id;o==="monthlyBudgets"&&u.month&&(h=u.month);const p=Gt(mt,"users",e,o,h);i.push({ref:p,data:d})}console.log(` Prepared ${i.length} items for restoration.`);const a=450;for(let o=0;o<i.length;o+=a){const c=yH(mt);i.slice(o,o+a).forEach(d=>{c.set(d.ref,d.data)}),console.log(` Committing batch ${Math.floor(o/a)+1}/${Math.ceil(i.length/a)}...`),await c.commit()}console.log(" Restore completed successfully.")}catch(r){throw console.error(" BudgetService.restoreUserData failed:",r),new Error(`Failed to restore user data: ${r instanceof Error?r.message:"Unknown error"}`)}}async getEnvelopes(e){try{console.log(" BudgetService.getEnvelopes called for user:",e);const t=Bi(mt,"users",e,"envelopes"),a=(await Fa(t)).docs.map((o,c)=>({id:o.id,...o.data(),orderIndex:o.data().orderIndex??c})).sort((o,c)=>{const u=o.orderIndex??0,d=c.orderIndex??0;return u-d});return console.log(" Fetched envelopes:",a.length),a}catch(t){throw console.error(" BudgetService.getEnvelopes failed:",t),new Error(`Failed to fetch envelopes: ${t instanceof Error?t.message:"Unknown error"}`)}}async getTransactions(e){try{console.log(" BudgetService.getTransactions: Fetching for user",e);const t=Bi(mt,"users",e,"transactions"),r=Gs(t,wd("date","desc")),a=(await Fa(r)).docs.map(o=>{const c={id:o.id,...o.data()};return LS(c)});return console.log(` Fetched ${a.length} transactions`),a}catch(t){throw console.error(" BudgetService.getTransactions failed:",t),new Error(`Failed to fetch transactions: ${t instanceof Error?t.message:"Unknown error"}`)}}async createEnvelope(e){try{console.log(" BudgetService.createEnvelope called for user:",e.userId);const t=Bi(mt,"users",e.userId,"envelopes"),r=Gt(t),i=vt.now(),a={...e,createdAt:i,lastUpdated:i};ca(r,a).catch(c=>console.error("Create env failed",c));const o={...e,id:r.id,createdAt:Jl(i),lastUpdated:Jl(i)};return console.log(" Created envelope (optimistic):",o.id),o}catch(t){throw console.error(" BudgetService.createEnvelope failed:",t),new Error(`Failed to create envelope: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateEnvelope(e,t){try{console.log(" BudgetService.updateEnvelope called for envelope:",t.id);const r=Gt(mt,"users",e,"envelopes",t.id);ca(r,{...t,lastUpdated:vt.now()},{merge:!0}).catch(i=>console.error("Update env failed",i)),console.log(" Updated envelope (optimistic):",t.id)}catch(r){throw console.error(" BudgetService.updateEnvelope failed:",r),new Error(`Failed to update envelope: ${r instanceof Error?r.message:"Unknown error"}`)}}async deleteEnvelope(e,t){try{const r=Gt(mt,"users",e,"envelopes",t),i=Gs(Bi(mt,"users",e,"transactions"),hH("envelopeId","==",t)),o=(await Fa(i)).docs.map(c=>Ga(c.ref));await Promise.all([Ga(r),...o]),console.log(" Deleted envelope and associated transactions from Firestore:",t)}catch(r){throw console.error(" BudgetService.deleteEnvelope failed:",r),new Error(`Failed to delete envelope: ${r instanceof Error?r.message:"Unknown error"}`)}}async reorderEnvelopes(e,t){try{console.log(" BudgetService.reorderEnvelopes called for user:",e);const r=t.map(i=>{const a=Gt(mt,"users",e,"envelopes",i.id);return ca(a,{orderIndex:i.orderIndex,lastUpdated:vt.now()},{merge:!0})});Promise.all(r).catch(i=>console.error("Reorder env failed",i)),console.log(" Reordered envelopes (optimistic)")}catch(r){throw console.error(" BudgetService.reorderEnvelopes failed:",r),new Error(`Failed to reorder envelopes: ${r instanceof Error?r.message:"Unknown error"}`)}}async createTransaction(e){try{console.log(" BudgetService.createTransaction called for user:",e.userId);const t=Bi(mt,"users",e.userId,"transactions"),r=Gt(t),i=vt.now(),o={...Object.fromEntries(Object.entries(e).filter(([u,d])=>d!==void 0)),createdAt:i};ca(r,o).catch(u=>console.error("Create tx failed",u));const c={...e,id:r.id};return console.log(" Created transaction (optimistic):",c.id),c}catch(t){throw console.error(" BudgetService.createTransaction failed:",t),new Error(`Failed to create transaction: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateTransaction(e,t){try{console.log(" BudgetService.updateTransaction called for transaction:",t.id);const r=Object.fromEntries(Object.entries(t).filter(([a,o])=>o!==void 0)),i=Gt(mt,"users",e,"transactions",t.id);ca(i,r,{merge:!0}).catch(a=>console.error("Update tx failed",a)),console.log(" Updated transaction (optimistic):",t.id)}catch(r){throw console.error(" BudgetService.updateTransaction failed:",r),new Error(`Failed to update transaction: ${r instanceof Error?r.message:"Unknown error"}`)}}async deleteTransaction(e,t){try{console.log(" BudgetService.deleteTransaction called for transaction:",t);const r=Gt(mt,"users",e,"transactions",t);Ga(r).catch(i=>console.error("Delete tx failed",i)),console.log(" Deleted transaction (optimistic):",t)}catch(r){throw console.error(" BudgetService.deleteTransaction failed:",r),new Error(`Failed to delete transaction: ${r instanceof Error?r.message:"Unknown error"}`)}}async createIncomeSource(e){try{console.log(" BudgetService.createIncomeSource (Embedded) called for user:",e.userId);const t=Gt(mt,"users",e.userId,"monthlyBudgets",e.month),r=vt.now(),i=`inc_${r.toMillis()}_${Math.random().toString(36).substring(2,9)}`,a={...e,id:i,amount:Number(e.amount),createdAt:r,updatedAt:r};Ba(t,{incomeSources:vH(a),updatedAt:r}).catch(c=>{c.code==="not-found"?ca(t,{id:`${e.userId}_${e.month}`,userId:e.userId,month:e.month,createdAt:r,updatedAt:r,incomeSources:[a],allocations:{},totalIncome:0,availableToBudget:0}).catch(u=>console.error("Failed to create monthly budget doc",u)):console.error("Create income failed",c)});const o={...e,id:i,amount:Number(e.amount),createdAt:Jl(r),updatedAt:Jl(r)};return console.log(" Created income source (optimistic/embedded):",o.id),o}catch(t){throw console.error(" BudgetService.createIncomeSource failed:",t),new Error(`Failed to create income source: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateIncomeSource(e,t,r,i){try{console.log(" BudgetService.updateIncomeSource (Embedded) called for source:",t);const a=Gt(mt,"users",e,"monthlyBudgets",r);Vx(a).then(o=>{if(!o.exists())return;const d=(o.data().incomeSources||[]).map(h=>{if(h.id===t){const p={...h,...i,updatedAt:vt.now()};return i.amount!==void 0&&(p.amount=Number(i.amount)),p}return h});Ba(a,{incomeSources:d,updatedAt:vt.now()})}).catch(o=>console.error("Update income failed",o)),console.log(" Updated income source (optimistic/embedded):",t)}catch(a){throw console.error(" BudgetService.updateIncomeSource failed:",a),a}}async deleteIncomeSource(e,t,r){try{console.log(" BudgetService.deleteIncomeSource (Embedded) called for source:",t);const i=Gt(mt,"users",e,"monthlyBudgets",r);Vx(i).then(a=>{if(!a.exists())return;const u=(a.data().incomeSources||[]).filter(d=>d.id!==t);Ba(i,{incomeSources:u,updatedAt:vt.now()})}).catch(a=>console.error("Delete income failed",a)),console.log(" Deleted income source (optimistic/embedded):",t)}catch(i){throw console.error(" BudgetService.deleteIncomeSource failed:",i),new Error(`Failed to delete income source: ${i instanceof Error?i.message:"Unknown error"}`)}}async createEnvelopeAllocation(e){try{console.log(" BudgetService.createEnvelopeAllocation (Embedded) called for user:",e.userId);const t=Gt(mt,"users",e.userId,"monthlyBudgets",e.month),r=vt.now(),i={[`allocations.${e.envelopeId}`]:Number(e.budgetedAmount),updatedAt:r};Ba(t,i).catch(o=>{o.code==="not-found"?ca(t,{id:`${e.userId}_${e.month}`,userId:e.userId,month:e.month,createdAt:r,updatedAt:r,incomeSources:[],allocations:{[e.envelopeId]:Number(e.budgetedAmount)},totalIncome:0,availableToBudget:0}).catch(c=>console.error("Failed to create monthly budget doc",c)):console.error("Create allocation failed",o)});const a={...e,id:e.envelopeId,createdAt:Jl(r),updatedAt:Jl(r)};return console.log(" Created allocation (optimistic/embedded):",a.id),a}catch(t){throw console.error(" BudgetService.createEnvelopeAllocation failed:",t),new Error(`Failed to create envelope allocation: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateEnvelopeAllocation(e,t,r,i){try{console.log(" BudgetService.updateEnvelopeAllocation (Embedded) called for envelope:",t);const a=Gt(mt,"users",e,"monthlyBudgets",r),o={updatedAt:vt.now()};i.budgetedAmount!==void 0&&(o[`allocations.${t}`]=Number(i.budgetedAmount)),Ba(a,o).catch(c=>console.error("Update allocation failed",c)),console.log(" Updated allocation (optimistic/embedded):",t)}catch(a){throw console.error(" BudgetService.updateEnvelopeAllocation failed:",a),new Error(`Failed to update envelope allocation: ${a instanceof Error?a.message:"Unknown error"}`)}}async deleteEnvelopeAllocation(e,t,r){try{console.log(" BudgetService.deleteEnvelopeAllocation (Embedded) called for envelope:",t);const i=Gt(mt,"users",e,"monthlyBudgets",r);Ba(i,{[`allocations.${t}`]:OR(),updatedAt:vt.now()}).catch(a=>console.error("Delete allocation failed",a)),console.log(" Deleted allocation (optimistic/embedded):",t)}catch(i){throw console.error(" BudgetService.deleteEnvelopeAllocation failed:",i),new Error(`Failed to delete envelope allocation: ${i instanceof Error?i.message:"Unknown error"}`)}}async getMonthData(e,t){try{console.log(` BudgetService.getMonthData (Embedded): Fetching for user ${e}, month ${t}`);const r=Gt(mt,"users",e,"monthlyBudgets",t),i=await Vx(r);if(!i.exists())return console.log(` No budget data found for ${t}, returning empty defaults.`),{incomeSources:[],allocations:[]};const a=i.data(),o=(a.incomeSources||[]).map(d=>({...d,amount:Number(d.amount),createdAt:d.createdAt?.toDate?d.createdAt.toDate().toISOString():d.createdAt||new Date().toISOString(),updatedAt:d.updatedAt?.toDate?d.updatedAt.toDate().toISOString():d.updatedAt||new Date().toISOString()})).sort((d,h)=>new Date(d.createdAt).getTime()-new Date(h.createdAt).getTime()),c=a.allocations||{},u=Object.entries(c).map(([d,h])=>({id:d,userId:e,envelopeId:d,month:t,budgetedAmount:Number(h),createdAt:a.createdAt?.toDate?a.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:a.updatedAt?.toDate?a.updatedAt.toDate().toISOString():new Date().toISOString()})).sort((d,h)=>new Date(d.createdAt).getTime()-new Date(h.createdAt).getTime());return console.log(` Fetched ${o.length} income sources and ${u.length} allocations for ${t}`),{incomeSources:o,allocations:u}}catch(r){throw console.error(" BudgetService.getMonthData failed:",r),new Error(`Failed to fetch month data: ${r instanceof Error?r.message:"Unknown error"}`)}}async cleanupOrphanedData(e){try{console.log(" BudgetService.cleanupOrphanedData: Starting cleanup for user:",e);const t={orphanedAllocationsDeleted:0,orphanedTransactionsDeleted:0,details:{deletedAllocationIds:[],deletedTransactionIds:[],monthsProcessed:[]}},r=await this.getEnvelopes(e),i=new Set(r.map(b=>b.id));console.log(` Found ${r.length} existing envelopes`);const a=Bi(mt,"users",e,"envelopeAllocations"),o=await Fa(a),c=[],u=new Set;for(const b of o.docs){const _=b.data();u.add(_.month),i.has(_.envelopeId)||(c.push(b.id),console.log(` Found orphaned allocation: ${b.id} for envelope ${_.envelopeId} in month ${_.month}`))}if(c.length>0){const b=c.map(_=>Ga(Gt(mt,"users",e,"envelopeAllocations",_)));await Promise.all(b),t.orphanedAllocationsDeleted+=c.length,t.details.deletedAllocationIds.push(...c),console.log(` Deleted ${c.length} orphaned allocations (legacy)`)}const d=Bi(mt,"users",e,"monthlyBudgets"),h=await Fa(d);for(const b of h.docs){const w=b.data().allocations||{},S={};let T=!1;Object.keys(w).forEach(A=>{i.has(A)||(S[`allocations.${A}`]=OR(),T=!0,console.log(` Found orphaned embedded allocation in ${b.id} for envelope ${A}`),t.orphanedAllocationsDeleted++,t.details.deletedAllocationIds.push(`${b.id}_${A}`))}),T&&(S.updatedAt=vt.now(),await Ba(b.ref,S),u.add(b.id))}const p=await this.getTransactions(e),m=[];for(const b of p)i.has(b.envelopeId)||(m.push(b.id),console.log(` Found orphaned transaction: ${b.id} for envelope ${b.envelopeId}`));if(m.length>0){const b=m.map(_=>Ga(Gt(mt,"users",e,"transactions",_)));await Promise.all(b),t.orphanedTransactionsDeleted=m.length,t.details.deletedTransactionIds=m,console.log(` Deleted ${m.length} orphaned transactions`)}return t.details.monthsProcessed=Array.from(u),console.log(" Cleanup completed:",{orphanedAllocationsDeleted:t.orphanedAllocationsDeleted,orphanedTransactionsDeleted:t.orphanedTransactionsDeleted,monthsProcessed:t.details.monthsProcessed.length}),t}catch(t){throw console.error(" BudgetService.cleanupOrphanedData failed:",t),new Error(`Failed to cleanup orphaned data: ${t instanceof Error?t.message:"Unknown error"}`)}}subscribeToMonthlyBudget(e,t,r){const i=Gt(mt,"users",e,"monthlyBudgets",t);return Bp(i,a=>{if(!a.exists()){r({incomeSources:[],allocations:[]});return}const o=a.data(),c=(o.incomeSources||[]).map(h=>({...h,amount:Number(h.amount),createdAt:h.createdAt?.toDate?h.createdAt.toDate().toISOString():h.createdAt||new Date().toISOString(),updatedAt:h.updatedAt?.toDate?h.updatedAt.toDate().toISOString():h.updatedAt||new Date().toISOString()})).sort((h,p)=>new Date(h.createdAt).getTime()-new Date(p.createdAt).getTime()),u=o.allocations||{},d=Object.entries(u).map(([h,p])=>({id:h,userId:e,envelopeId:h,month:t,budgetedAmount:Number(p),createdAt:o.createdAt?.toDate?o.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:o.updatedAt?.toDate?o.updatedAt.toDate().toISOString():new Date().toISOString()})).sort((h,p)=>new Date(h.createdAt).getTime()-new Date(p.createdAt).getTime());r({incomeSources:c,allocations:d})})}prepareMonthlyBudgetsData(e,t){const r=[],i=new Set;return e&&Object.keys(e).forEach(a=>i.add(a)),t&&Object.keys(t).forEach(a=>i.add(a)),i.forEach(a=>{const o=e?.[a]||[],c=t?.[a]||[],u={};o.forEach(h=>{u[h.envelopeId]=h.budgetedAmount});const d={month:a,userId:"",incomeSources:c,allocations:u,totalIncome:c.reduce((h,p)=>h+Number(p.amount||0),0),availableToBudget:c.reduce((h,p)=>h+Number(p.amount||0),0)-o.reduce((h,p)=>h+Number(p.budgetedAmount||0),0),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};r.push(d)}),r}async deleteAllUserData(e){try{console.log(" BudgetService.deleteAllUserData: STARTING DELETION for user:",e);const t=["envelopes","transactions","incomeSources","envelopeAllocations","monthlyBudgets","appSettings"];for(const r of t){console.log(` Deleting collection: ${r}...`);const i=Bi(mt,"users",e,r),a=await Fa(i);if(a.empty){console.log("   (Empty collection)");continue}const o=a.docs.map(c=>Ga(c.ref));await Promise.all(o),console.log(`    Deleted ${a.size} documents from ${r}`)}console.log(" All user data deleted successfully.")}catch(t){throw console.error(" BudgetService.deleteAllUserData failed:",t),new Error(`Failed to delete all user data: ${t instanceof Error?t.message:"Unknown error"}`)}}}const BS=hc.getInstance(),m1=n=>Bi(mt,"users",n,"transactions"),Nee={subscribeToTransactions:(n,e)=>{const t=Gs(m1(n),wd("date","desc"));return Bp(t,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllTransactions:async n=>{console.log(` TransactionService.getAllTransactions: Fetching for user ${n}`);const e=Gs(m1(n),wd("date","desc")),r=(await Fa(e)).docs.map(i=>{const a={id:i.id,...i.data()};return LS(a)});return console.log(` Fetched ${r.length} transactions:`,r.map(i=>({id:i.id,description:i.description,month:i.month}))),r},addTransaction:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create transaction");console.log(` TransactionService.addTransaction: Adding transaction for user ${e}:`,r),console.log(` Original transaction had temp ID: ${t}`);try{console.log(" About to call addDoc with:",r);const i=await Wv(m1(e),r);console.log(" addDoc succeeded, docRef:",i),console.log(` Document ID: ${i.id}`),console.log(` Document path: ${i.path}`);const a={id:i.id,...r,userId:e};return console.log(" Final result object:",a),a}catch(i){throw console.error(" addDoc failed:",i),console.error("Error message:",i.message),i}},updateTransaction:async(n,e,t)=>{const r=Gt(mt,"users",n,"transactions",e);return await Ba(r,t)},deleteTransaction:async(n,e)=>{console.log(` TransactionService.deleteTransaction: Deleting transaction ${e} for user ${n}`);try{const t=Gt(mt,"users",n,"transactions",e);console.log(` Deleting document at path: ${t.path}`),await Ga(t),console.log(` TransactionService.deleteTransaction: Successfully deleted transaction ${e}`)}catch(t){throw console.error(` TransactionService.deleteTransaction: Failed to delete transaction ${e}:`,t),console.error("Error message:",t.message),t}}},v1=n=>Bi(mt,"users",n,"envelopes"),Mee={subscribeToEnvelopes:(n,e)=>{const t=Gs(v1(n),wd("orderIndex","asc"));return Bp(t,i=>{const a=i.docs.map(o=>{const c=o.data();return{id:o.id,...c,createdAt:c.createdAt?.toDate?.()?c.createdAt.toDate().toISOString():c.createdAt,lastUpdated:c.lastUpdated?.toDate?.()?c.lastUpdated.toDate().toISOString():c.lastUpdated}});e(a)})},getAllEnvelopes:async n=>{try{console.log(" EnvelopeService.getAllEnvelopes called for user:",n);const e=v1(n),i=(await Fa(e)).docs.map((a,o)=>{const c=a.data();return{id:a.id,...c,createdAt:c.createdAt?.toDate?.()?c.createdAt.toDate().toISOString():c.createdAt,lastUpdated:c.lastUpdated?.toDate?.()?c.lastUpdated.toDate().toISOString():c.lastUpdated,orderIndex:c.orderIndex??o}}).sort((a,o)=>{const c=a.orderIndex??0,u=o.orderIndex??0;return c-u});return console.log(" Fetched envelopes:",i.length),i}catch(e){return console.error(" EnvelopeService.getAllEnvelopes failed:",e),[]}},createEnvelope:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create envelope");try{return{id:(await Wv(v1(e),r)).id,...r,userId:e}}catch(i){throw console.error(" Envelope addDoc failed:",i),i}},saveEnvelope:async(n,e)=>{if(!e.id)throw new Error("Envelope ID is required for save operation");const t=Gt(mt,"users",n,"envelopes",e.id);return await ca(t,e,{merge:!0})},updateBalance:async(n,e,t)=>{const r=Gt(mt,"users",n,"envelopes",e);return await Ba(r,{currentBalance:t,lastUpdated:new Date().toISOString()})},deleteEnvelope:async(n,e)=>{console.log(` EnvelopeService.deleteEnvelope: Deleting envelope ${e} for user ${n}`);const t=Gt(mt,"users",n,"envelopes",e);await Ga(t),console.log(` EnvelopeService.deleteEnvelope: Successfully deleted envelope ${e}`)}},y1=n=>Bi(mt,"users",n,"distributionTemplates"),Pee={subscribeToDistributionTemplates:(n,e)=>{const t=Gs(y1(n),wd("lastUsed","desc"));return Bp(t,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllDistributionTemplates:async n=>{const e=Gs(y1(n),wd("lastUsed","desc"));return(await Fa(e)).docs.map(r=>({id:r.id,...r.data()}))},createDistributionTemplate:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create distribution template");console.log(` DistributionTemplateService.createDistributionTemplate: Adding template for user ${e}:`,r);try{const i=await Wv(y1(e),r);console.log(" Template addDoc succeeded, docRef:",i);const a={id:i.id,...r,userId:e};return console.log(" Final template result object:",a),a}catch(i){throw console.error(" Template addDoc failed:",i),i}},saveDistributionTemplate:async(n,e)=>{const t=Gt(mt,"users",n,"distributionTemplates",e.id);return await ca(t,e,{merge:!0})},updateDistributionTemplate:async(n,e,t)=>{const r=Gt(mt,"users",n,"distributionTemplates",e);return await Ba(r,t)},deleteDistributionTemplate:async(n,e)=>{console.log(` DistributionTemplateService.deleteDistributionTemplate: Deleting template ${e} for user ${n}`);const t=Gt(mt,"users",n,"distributionTemplates",e);await Ga(t),console.log(` DistributionTemplateService.deleteDistributionTemplate: Successfully deleted template ${e}`)}},b1=n=>Bi(mt,"users",n,"appSettings"),_V={subscribeToAppSettings:(n,e)=>{const t=Gs(b1(n),NR(1));return Bp(t,i=>{if(i.empty){e(null);return}const a=i.docs.map(o=>({id:o.id,...o.data()}))[0];e(a)})},getAppSettings:async n=>{const e=Gs(b1(n),NR(1)),t=await Fa(e);if(t.empty)return null;const r=t.docs[0];return{id:r.id,...r.data()}},createAppSettings:async n=>{const{userId:e,...t}=n;if(!e)throw new Error("User ID is required to create app settings");console.log(` AppSettingsService.createAppSettings: Creating settings for user ${e}:`,t);try{const r=await Wv(b1(e),t);console.log(" Settings addDoc succeeded, docRef:",r);const i={id:r.id,...t,userId:e};return console.log(" Final settings result object:",i),i}catch(r){throw console.error(" Settings addDoc failed:",r),r}},saveAppSettings:async(n,e)=>{const t=Gt(mt,"users",n,"appSettings",e.id);return await ca(t,e,{merge:!0})},updateAppSettings:async(n,e,t)=>{const r=Gt(mt,"users",n,"appSettings",e);return await ca(r,t,{merge:!0})},deleteAppSettings:async(n,e)=>{console.log(` AppSettingsService.deleteAppSettings: Deleting settings ${e} for user ${n}`);const t=Gt(mt,"users",n,"appSettings",e);await Ga(t),console.log(` AppSettingsService.deleteAppSettings: Successfully deleted settings ${e}`)}},qk=Object.freeze(Object.defineProperty({__proto__:null,AppSettingsService:_V},Symbol.toStringTag,{value:"Module"})),Oee=n=>LS(n),jee=n=>({id:n.id,name:n.name||"",currentBalance:n.currentBalance||0,lastUpdated:n.lastUpdated?.toDate?.()?n.lastUpdated.toDate().toISOString():n.lastUpdated,isActive:n.isActive??!0,orderIndex:n.orderIndex??0,userId:n.userId||void 0,createdAt:n.createdAt?.toDate?.()?n.createdAt.toDate().toISOString():n.createdAt,isPiggybank:n.isPiggybank,piggybankConfig:n.piggybankConfig}),Hk=(n,e)=>{if(window.__firebaseUnsubscribers){console.log(" Real-time subscriptions already active, skipping setup");return}console.log(" Setting up real-time Firebase subscriptions...");const t=n.getState().currentMonth;console.log(" Current month for subscriptions:",t);const r=Mee.subscribeToEnvelopes(e,u=>{console.log(" Real-time sync: Envelopes updated",u.length);const d=u.map(jee),h=n.getState(),p=new Set(h.envelopes.map(_=>_.id)),m=new Set(d.map(_=>_.id)),b=[...d.filter(_=>p.has(_.id)),...h.envelopes.filter(_=>!m.has(_.id))];n.setState({envelopes:b})}),i=Nee.subscribeToTransactions(e,u=>{console.log(" Real-time sync: Transactions updated",u.length);const d=u.map(Oee),h=n.getState(),p=new Set(h.transactions.map(_=>`${_.id}-${_.month}`)),m=new Set(d.map(_=>`${_.id}-${_.month}`)),b=[...d.filter(_=>p.has(`${_.id}-${_.month}`)),...h.transactions.filter(_=>!m.has(`${_.id}-${_.month}`))];n.setState({transactions:b})}),a=Pee.subscribeToDistributionTemplates(e,u=>{console.log(" Real-time sync: Templates updated from Firebase",u.length)}),o=_V.subscribeToAppSettings(e,u=>{console.log(" Real-time sync: Settings updated",u?"found":"null");const d=n.getState();if(u){const h={...d.appSettings,...u,paymentSources:u.paymentSources??d.appSettings?.paymentSources??[]};n.setState({appSettings:h})}else console.log(" Firebase settings null, preserving local state")}),c=BS.subscribeToMonthlyBudget(e,t,u=>{console.log(` Real-time sync: Monthly budget updated (${u.incomeSources.length} sources, ${u.allocations.length} allocations)`);const d=n.getState();n.setState({incomeSources:{...d.incomeSources,[t]:u.incomeSources},allocations:{...d.allocations,[t]:u.allocations}})});window.__firebaseUnsubscribers={envelopes:r,transactions:i,templates:a,settings:o,monthlyBudget:c},console.log(" Real-time subscriptions active - cross-device sync enabled")},Vee=n=>{const{useBudgetStore:e,useAuthStore:t,getCurrentUserId:r}=n;if(typeof window>"u")return;window.addEventListener("online",async()=>{console.log(" Browser online event detected"),e.setState({isOnline:!0})}),window.addEventListener("offline",()=>{console.log(" Browser offline event detected"),e.setState({isOnline:!1})}),e.setState({isOnline:navigator.onLine});const i=t.getState();i.isAuthenticated&&i.currentUser&&(console.log(" User already authenticated on app load, setting up real-time subscriptions"),Hk(e,r())),t.subscribe(o=>{if(o.isAuthenticated&&o.currentUser)console.log(" User authenticated, setting up real-time subscriptions"),Hk(e,r());else if(!o.isAuthenticated&&!o.isLoading){if(console.log(" User logged out, clearing data and unsubscribing"),window.__firebaseUnsubscribers){const c=window.__firebaseUnsubscribers;c.envelopes&&c.envelopes(),c.transactions&&c.transactions(),c.templates&&c.templates(),c.settings&&c.settings(),c.monthlyBudget&&c.monthlyBudget(),delete window.__firebaseUnsubscribers,console.log(" Cleaned up Firebase subscriptions")}e.getState().handleUserLogout()}});let a=e.getState().currentMonth;e.subscribe(o=>{if(o.currentMonth!==a&&o.isAuthenticated){console.log(" Month changed from",a,"to",o.currentMonth),a=o.currentMonth;const c=r();if(c&&window.__firebaseUnsubscribers){const u=window.__firebaseUnsubscribers;u.monthlyBudget&&u.monthlyBudget(),console.log(" Unsubscribed from old month data"),u.monthlyBudget=BS.subscribeToMonthlyBudget(c,o.currentMonth,d=>{console.log(" Real-time sync: Monthly budget updated for new month");const h=e.getState();e.setState({incomeSources:{...h.incomeSources,[o.currentMonth]:d.incomeSources},allocations:{...h.allocations,[o.currentMonth]:d.allocations}})}),console.log(" Subscribed to monthly data for new month:",o.currentMonth)}}})},zee=()=>fa.getState().currentUser?.id||"",Bn=hc.getInstance(),Mn=fw()(V9(wN((n,e)=>({envelopes:[],transactions:[],appSettings:null,incomeSources:{},allocations:{},currentMonth:new Date().toISOString().slice(0,7),isOnline:typeof navigator<"u"?navigator.onLine:!0,isOnboardingActive:!1,isOnboardingCompleted:typeof localStorage<"u"?localStorage.getItem("onboardingCompleted")==="true":!1,isLoading:!1,error:null,setIsOnboardingActive:t=>{n({isOnboardingActive:t})},completeOnboarding:()=>{n({isOnboardingCompleted:!0,isOnboardingActive:!1}),localStorage.setItem("onboardingCompleted","true")},resetOnboarding:()=>{n({isOnboardingCompleted:!1,isOnboardingActive:!0}),localStorage.removeItem("onboardingCompleted")},clearMonthData:async t=>{try{n({isLoading:!0,error:null}),console.log(` Clearing all data for month: ${t}`);const i=(await tn(()=>Promise.resolve().then(()=>xn),[]).then(o=>o.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const{monthlyBudgetService:a}=await tn(async()=>{const{monthlyBudgetService:o}=await import("./MonthlyBudgetService-DIOT5Cq_.js");return{monthlyBudgetService:o}},[]);await a.clearMonthData(i.id,t),await e().init(),console.log(` Cleared month data for ${t}`),n({isLoading:!1})}catch(r){throw console.error(" clearMonthData failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to clear month data"}),r}},fetchMonthData:async t=>{try{const i=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i){console.log("No user logged in, skipping month data fetch");return}console.log(`Fetching month data for: ${t}`);const a=await Bn.getMonthData(i.id,t),o=e();n({incomeSources:{...o.incomeSources,[t]:a.incomeSources},allocations:{...o.allocations,[t]:a.allocations}}),console.log(` Fetched month data for ${t}`),(async()=>{const u=e(),d=u.allocations[t]||[],h=u.transactions.filter(m=>m.month===t);let p=0;for(const m of d){const b=u.envelopes.find(w=>w.id===m.envelopeId);if(b?.isPiggybank)continue;const _=h.find(w=>w.envelopeId===m.envelopeId&&(w.description==="Monthly Budget Allocation"||w.description==="Monthly Allocation"||w.description==="Budgeted"||w.description==="Piggybank Contribution"));_?_.amount!==m.budgetedAmount&&(console.log(` Repairing mismatch for envelope ${b?.name||m.envelopeId}: Alloc ${m.budgetedAmount} vs Tx ${_.amount}`),await u.updateTransaction({..._,amount:m.budgetedAmount}),p++):m.budgetedAmount>0&&(console.log(` Repairing missing transaction for envelope ${b?.name||m.envelopeId}`),await u.addTransaction({description:"Budgeted",amount:m.budgetedAmount,envelopeId:m.envelopeId,type:"Income",month:t,date:`${t}-01T00:00:00`,reconciled:!1,isAutomatic:!0}),p++)}p>0&&console.log(` Repaired ${p} allocation discrepancies for ${t}`)})().catch(u=>console.error("Verification failed:",u))}catch(r){console.error(` Failed to fetch month data for ${t}:`,r)}},removeEnvelopeFromMonth:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(` Removing envelope ${t} from month ${r}`);const i=e(),a=i.allocations[r]?.find(c=>c.envelopeId===t);a?await e().deleteEnvelopeAllocation(a.id):console.log(` No allocation found for envelope ${t} in ${r}`);const o=i.transactions.filter(c=>c.envelopeId===t&&(c.month===r||c.date.startsWith(r)));o.length>0&&(console.log(` Deleting ${o.length} transactions for envelope ${t} in ${r}`),await Promise.all(o.map(c=>e().deleteTransaction(c.id)))),n({isLoading:!1}),console.log(` Removed envelope ${t} from month ${r}`)}catch(i){throw console.error(" removeEnvelopeFromMonth failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to remove envelope from month"}),i}},setMonth:async t=>{n({currentMonth:t});const r=e();(r.incomeSources[t]===void 0||r.allocations[t]===void 0)&&(console.log(`Month ${t} data missing in store, fetching...`),n({isLoading:!0}),await e().fetchMonthData(t),n({isLoading:!1}))},init:async()=>{console.log("BudgetStore initializing...");const t=e();try{n({isLoading:!0,error:null});const i=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i){console.log("No user logged in, skipping data fetch"),n({isLoading:!1});return}console.log(`Fetching data for user: ${i.id}, month: ${t.currentMonth}`);const[a,o,c]=await Promise.all([Bn.getEnvelopes(i.id),Bn.getTransactions(i.id),Bn.getMonthData(i.id,t.currentMonth)]);n({envelopes:a,transactions:o,incomeSources:{...t.incomeSources,[t.currentMonth]:c.incomeSources},allocations:{...t.allocations,[t.currentMonth]:c.allocations},isLoading:!1,error:null}),console.log(` BudgetStore initialized: ${a.length} envelopes, ${o.length} transactions, ${c.incomeSources.length} income sources, ${c.allocations.length} allocations`)}catch(r){console.error(" BudgetStore initialization failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to initialize budget data"})}},addEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a={...t,userId:i.id},o=await Bn.createEnvelope(a);return n(c=>c.envelopes.some(d=>d.id===o.id)?{isLoading:!1}:{envelopes:[...c.envelopes,o],isLoading:!1}),console.log(" Added envelope:",o.id),o.id}catch(r){throw console.error(" addEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to add envelope"}),r}},updateEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Bn.updateEnvelope(i.id,t),n(a=>({envelopes:a.envelopes.map(o=>o.id===t.id?t:o),isLoading:!1})),console.log(" Updated envelope:",t.id)}catch(r){throw console.error(" updateEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update envelope"}),r}},deleteEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Bn.deleteEnvelope(i.id,t),n(a=>({envelopes:a.envelopes.filter(o=>o.id!==t),transactions:a.transactions.filter(o=>o.envelopeId!==t),isLoading:!1})),console.log(" Deleted envelope:",t)}catch(r){throw console.error(" deleteEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete envelope"}),r}},reorderEnvelopes:async t=>{try{n({isLoading:!0,error:null});const r=e(),i=new Map;t.forEach((d,h)=>{i.set(d,h)});const a=r.envelopes.map(d=>{if(!i.has(d.id))return d;const h=i.get(d.id);return d.orderIndex===h?d:{...d,orderIndex:h}}),o=a.filter((d,h)=>d!==r.envelopes[h]);if(!o.length){n({isLoading:!1});return}const u=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!u)throw new Error("No authenticated user found");await Bn.reorderEnvelopes(u.id,o),n({envelopes:a,isLoading:!1}),console.log(" Reordered envelopes")}catch(r){throw console.error(" reorderEnvelopes failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to reorder envelopes"}),r}},addTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=new Date(t.date),o=t.month||`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,c={...t,userId:i.id,month:o},u=await Bn.createTransaction(c);n(d=>d.transactions.some(p=>p.id===u.id)?{isLoading:!1}:{transactions:[...d.transactions,u],isLoading:!1}),console.log(" Added transaction:",u.id)}catch(r){throw console.error(" addTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to add transaction"}),r}},updateTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=new Date(t.date),o=t.month||`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,c={...t,month:o};await Bn.updateTransaction(i.id,c),n(u=>({transactions:u.transactions.map(d=>d.id===t.id?c:d),isLoading:!1})),console.log(" Updated transaction:",t.id)}catch(r){throw console.error(" updateTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update transaction"}),r}},deleteTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Bn.deleteTransaction(i.id,t),n(a=>({transactions:a.transactions.filter(o=>o.id!==t),isLoading:!1})),console.log(" Deleted transaction:",t)}catch(r){throw console.error(" deleteTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete transaction"}),r}},restoreTransaction:async t=>{await e().updateTransaction(t)},transferFunds:async(t,r,i,a,o)=>{try{const c=o?typeof o=="string"?o:o.toISOString():new Date().toISOString(),u=`transfer-${Date.now()}-${Math.random()}`;await e().addTransaction({description:`Transfer to ${e().envelopes.find(d=>d.id===r)?.name||"envelope"}`,amount:i,envelopeId:t,date:c,type:"Expense",transferId:u,reconciled:!1}),await e().addTransaction({description:`Transfer from ${e().envelopes.find(d=>d.id===t)?.name||"envelope"}`,amount:i,envelopeId:r,date:c,type:"Income",transferId:u,reconciled:!1}),console.log(" Transfer completed")}catch(c){throw console.error(" transferFunds failed:",c),c}},fetchData:async()=>{await e().init()},renameEnvelope:async(t,r)=>{try{n({isLoading:!0,error:null});const a=e().envelopes.find(d=>d.id===t);if(!a)throw new Error("Envelope not found");n(d=>({envelopes:d.envelopes.map(h=>h.id===t?{...h,name:r}:h),isLoading:!0}));const c=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!c)throw new Error("No authenticated user found");const u={...a,name:r};await Bn.updateEnvelope(c.id,u),n({isLoading:!1}),console.log(" Renamed envelope:",t)}catch(i){throw console.error(" renameEnvelope failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to rename envelope"}),i}},getEnvelopeBalance:(t,r)=>{const i=e(),a=i.envelopes.find(o=>o.id===t);if(!a)return console.log(` getEnvelopeBalance: Envelope ${t} not found`),0;if(a.isPiggybank){const o=i.transactions.filter(p=>p.envelopeId===t),c=o.filter(p=>p.type==="Expense"),u=o.filter(p=>p.type==="Income"),d=c.reduce((p,m)=>p+(m.amount||0),0);return u.reduce((p,m)=>p+(m.amount||0),0)-d}if(r){const o=i.transactions.filter(p=>p.envelopeId===t&&p.month===r),c=o.filter(p=>p.type==="Expense"),u=o.filter(p=>p.type==="Income"),d=c.reduce((p,m)=>p+(m.amount||0),0);return u.reduce((p,m)=>p+(m.amount||0),0)-d}return console.warn(` getEnvelopeBalance: Month not provided for non-piggybank envelope ${t}. Returning 0.`),0},resetData:async()=>{console.log(" Resetting all data"),n({isLoading:!0});try{const r=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(i=>i.useAuthStore.getState())).currentUser;r?(console.log(" Deleting all data from Firestore for user:",r.id),await Bn.deleteAllUserData(r.id)):console.warn(" No user logged in, only clearing local state"),n({envelopes:[],transactions:[],appSettings:null,incomeSources:{},allocations:{},isLoading:!1,error:null}),console.log(" Reset data complete")}catch(t){throw console.error(" resetData failed:",t),n({isLoading:!1,error:t instanceof Error?t.message:"Failed to reset data"}),t}},importData:async t=>{try{if(n({isLoading:!0,error:null}),!t||typeof t!="object")throw new Error("Invalid data format");const i=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("You must be logged in to restore data.");return console.log(" Starting Time Machine Restore for user:",i.id),await Bn.restoreUserData(i.id,t),console.log(" Reloading app state from cloud..."),await e().init(),n({isLoading:!1}),{success:!0,message:"Data restored successfully from backup."}}catch(r){return console.error(" importData failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to import data"}),{success:!1,message:r instanceof Error?r.message:"Import failed"}}},updateAppSettings:async t=>{try{n({isLoading:!0,error:null});const r=e(),i={id:r.appSettings?.id||"default",theme:t.theme??r.appSettings?.theme??"system",enableMoveableReorder:t.enableMoveableReorder??r.appSettings?.enableMoveableReorder??!0,paymentSources:t.paymentSources??r.appSettings?.paymentSources??[]};(t.userId||r.appSettings?.userId)&&(i.userId=t.userId??r.appSettings?.userId);const o=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(o){const{AppSettingsService:c}=await tn(async()=>{const{AppSettingsService:u}=await Promise.resolve().then(()=>qk);return{AppSettingsService:u}},void 0);await c.updateAppSettings(o.id,i.id,i)}n({appSettings:i,isLoading:!1}),console.log(" Updated app settings")}catch(r){throw console.error(" updateAppSettings failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update settings"}),r}},initializeAppSettings:async()=>{try{if(e().appSettings)return;const i=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(i){const{AppSettingsService:o}=await tn(async()=>{const{AppSettingsService:u}=await Promise.resolve().then(()=>qk);return{AppSettingsService:u}},void 0),c=await o.getAppSettings(i.id);if(c){n({appSettings:c}),console.log(" Loaded app settings from Firestore");return}}const a={id:"default",theme:"system",enableMoveableReorder:!0,paymentSources:[]};i&&(a.userId=i.id),n({appSettings:a}),console.log(" Initialized default app settings")}catch(t){console.error(" initializeAppSettings failed:",t),n({error:t instanceof Error?t.message:"Failed to initialize settings"})}},updatePiggybankContribution:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Updating piggybank contribution:",{envelopeId:t,newAmount:r});const a=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");const o=e().envelopes.find(u=>u.id===t&&u.isPiggybank);if(!o)throw new Error("Piggybank not found");const c={...o,lastUpdated:new Date().toISOString(),piggybankConfig:{monthlyContribution:r,targetAmount:o.piggybankConfig?.targetAmount,color:o.piggybankConfig?.color,icon:o.piggybankConfig?.icon,paused:o.piggybankConfig?.paused??!1}};if(console.log(" Updating envelope in Firestore:",c),await Bn.updateEnvelope(a.id,c),console.log(" Envelope updated successfully"),n(u=>({envelopes:u.envelopes.map(d=>d.id===t?c:d),isLoading:!1})),!o.piggybankConfig?.paused)try{await e().setEnvelopeAllocation(t,r),setTimeout(()=>{e().transactions.find(d=>d.envelopeId===t&&(d.description==="Monthly Allocation"||d.description==="Piggybank Contribution"))||console.warn(" Piggybank contribution transaction not found after update")},1e3)}catch(u){console.error(" Failed to update piggybank contribution:",u)}console.log(" Piggybank contribution updated successfully")}catch(i){throw console.error(" updatePiggybankContribution failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update piggybank contribution"}),i}},addIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null});const a=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");console.log(" Adding income source:",{month:t,source:r});const o=await Bn.createIncomeSource({...r,userId:a.id,month:t});n(c=>{const u=c.incomeSources[t]||[];return u.some(h=>h.id===o.id)?{isLoading:!1}:{incomeSources:{...c.incomeSources,[t]:[...u,o]},isLoading:!1}}),console.log(" Added income source:",o.id)}catch(i){throw console.error(" addIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to add income source"}),i}},updateIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Updating income source:",{month:t,sourceId:r.id}),n(o=>({incomeSources:{...o.incomeSources,[t]:o.incomeSources[t]?.map(c=>c.id===r.id?{...r,updatedAt:new Date().toISOString()}:c)||[]},isLoading:!1}));const a=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!a)return;await Bn.updateIncomeSource(a.id,r.id,t,r),console.log(" Updated income source:",r.id)}catch(i){throw console.error(" updateIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update income source"}),i}},deleteIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Deleting income source:",{month:t,sourceId:r}),n(o=>({incomeSources:{...o.incomeSources,[t]:o.incomeSources[t]?.filter(c=>c.id!==r)||[]},isLoading:!1}));const a=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!a)return;await Bn.deleteIncomeSource(a.id,r,t),console.log(" Deleted income source:",r)}catch(i){throw console.error(" deleteIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to delete income source"}),i}},copyPreviousMonthAllocations:async t=>{try{n({isLoading:!0,error:null});const i=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(_=>_.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");console.log(" Copying allocations from previous month:",t);const[a,o]=t.split("-").map(Number);let c=a,u=o-1;u<1&&(c=a-1,u=12);const d=`${c}-${String(u).padStart(2,"0")}`,h=e().incomeSources[d]||[];if(console.log(` Found ${h.length} income sources from ${d}`),h.length>0){for(const _ of h){const{id:w,...S}=_;await e().addIncomeSource(t,S)}console.log(` Copied ${h.length} income sources to ${t}`)}const p=e().allocations[d]||[];console.log(` Found ${p.length} allocations from ${d}`);const m=p.filter(_=>!e().envelopes.find(S=>S.id===_.envelopeId)?.isPiggybank);if(m.length>0){for(const _ of m)await e().createEnvelopeAllocation({envelopeId:_.envelopeId,budgetedAmount:_.budgetedAmount,userId:i.id,month:t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),_.budgetedAmount>0&&await e().addTransaction({description:"Budgeted",amount:_.budgetedAmount,envelopeId:_.envelopeId,type:"Income",month:t,date:`${t}-01T00:00:00`,reconciled:!1,isAutomatic:!0});console.log(` Copied ${m.length} regular allocations to ${t}`)}const b=e().envelopes.filter(_=>_.isPiggybank);console.log(` Processing ${b.length} piggybanks for ${t}`);for(const _ of b){const w=_.piggybankConfig?.monthlyContribution,S=_.piggybankConfig?.paused??!1;if(!S&&w&&w>0)try{console.log(` Setting piggybank allocation for ${_.name}: ${w}`),await e().setEnvelopeAllocation(_.id,w)}catch(T){console.error(` Failed to set allocation for piggybank ${_.name}:`,T)}else console.log(` Skipping piggybank ${_.name} (paused=${S}, contribution=${w})`)}n({isLoading:!1}),console.log(` Complete monthly setup copied to ${t}`)}catch(r){throw console.error(" copyPreviousMonthAllocations failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to copy allocations"}),r}},setEnvelopeAllocation:async(t,r)=>{try{n({isLoading:!0,error:null});const a=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(h=>h.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");const o=e().currentMonth,c=e().envelopes.find(h=>h.id===t),u=c?.isPiggybank;console.log(` setEnvelopeAllocation called: envelopeId=${t}, amount=${r}, currentMonth=${o}, isPiggybank=${u}`);const d=e().allocations[o]?.find(h=>h.envelopeId===t);if(d?await e().updateEnvelopeAllocation(d.id,{budgetedAmount:r}):await e().createEnvelopeAllocation({envelopeId:t,budgetedAmount:r,userId:a.id,month:o,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),u&&r>0&&!c?.piggybankConfig?.paused){const h=e().transactions.find(p=>p.envelopeId===t&&p.month===o&&(p.description==="Monthly Allocation"||p.description==="Piggybank Contribution"));if(h){const p={...h,amount:r,description:"Piggybank Contribution"};await e().updateTransaction(p)}else{const p={description:"Piggybank Contribution",amount:r,envelopeId:t,type:"Income",month:o,date:`${o}-01T00:00:00`,reconciled:!1,isAutomatic:!0};await e().addTransaction(p)}}if(!u&&r>0){const h=e().transactions.find(p=>p.envelopeId===t&&p.month===o&&(p.description==="Monthly Budget Allocation"||p.description==="Budgeted"));if(h){const p={...h,amount:r,description:"Budgeted"};await e().updateTransaction(p)}else{const p={description:"Budgeted",amount:r,envelopeId:t,type:"Income",month:o,date:`${o}-01T00:00:00`,reconciled:!1,isAutomatic:!0};await e().addTransaction(p)}}console.log(" Envelope allocation set successfully")}catch(i){throw console.error(" setEnvelopeAllocation failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to set envelope allocation"}),i}},createEnvelopeAllocation:async t=>{try{const i=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=e().currentMonth,o=await Bn.createEnvelopeAllocation({envelopeId:t.envelopeId,budgetedAmount:t.budgetedAmount,userId:i.id,month:a});n(c=>{const u=c.allocations[a]||[];return u.some(h=>h.id===o.id)?{isLoading:!1}:{allocations:{...c.allocations,[a]:[...u,o]},isLoading:!1}}),console.log(" Created envelope allocation:",o.id)}catch(r){throw console.error(" createEnvelopeAllocation failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to create envelope allocation"}),r}},updateEnvelopeAllocation:async(t,r)=>{try{console.log(" Updating envelope allocation:",{id:t,updates:r});const i=e().currentMonth,o=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(h=>h.useAuthStore.getState())).currentUser;if(!o)throw new Error("No authenticated user found");const c=e().allocations[i]?.find(h=>h.id===t);if(!c)throw new Error("Allocation not found");const u=e().envelopes.find(h=>h.id===c.envelopeId),d=u?.isPiggybank;if(await Bn.updateEnvelopeAllocation(o.id,c.envelopeId,i,{budgetedAmount:r.budgetedAmount}),n(h=>({allocations:{...h.allocations,[i]:h.allocations[i]?.map(p=>p.id===t?{...p,...r,updatedAt:new Date().toISOString()}:p)||[]},isLoading:!1})),d&&r.budgetedAmount!==void 0){const h=e().transactions.find(p=>p.envelopeId===c.envelopeId&&p.month===i&&(p.description==="Monthly Allocation"||p.description==="Piggybank Contribution"));h?r.budgetedAmount>0&&!u?.piggybankConfig?.paused?await e().updateTransaction({...h,amount:r.budgetedAmount,description:"Piggybank Contribution"}):(r.budgetedAmount===0||u?.piggybankConfig?.paused)&&await e().deleteTransaction(h.id):r.budgetedAmount>0&&!u?.piggybankConfig?.paused&&await e().addTransaction({description:"Piggybank Contribution",amount:r.budgetedAmount,envelopeId:c.envelopeId,type:"Income",month:i,date:`${i}-01T00:00:00`,reconciled:!1,isAutomatic:!0})}if(!d&&r.budgetedAmount!==void 0){const h=e().transactions.find(p=>p.envelopeId===c.envelopeId&&p.month===i&&(p.description==="Monthly Budget Allocation"||p.description==="Budgeted"));h?r.budgetedAmount>0?await e().updateTransaction({...h,amount:r.budgetedAmount,description:"Budgeted"}):r.budgetedAmount===0&&await e().deleteTransaction(h.id):r.budgetedAmount>0&&await e().addTransaction({description:"Budgeted",amount:r.budgetedAmount,envelopeId:c.envelopeId,type:"Income",month:i,date:`${i}-01T00:00:00`,reconciled:!1,isAutomatic:!0})}console.log(" Updated envelope allocation:",t)}catch(i){throw console.error(" updateEnvelopeAllocation failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update envelope allocation"}),i}},deleteEnvelopeAllocation:async t=>{try{console.log(" Deleting envelope allocation:",t);const r=e().currentMonth,i=e().allocations[r]?.find(c=>c.id===t);if(!i){console.warn("Allocation not found in store, skipping delete");return}const o=(await tn(()=>Promise.resolve().then(()=>xn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!o)throw new Error("No authenticated user found");await Bn.deleteEnvelopeAllocation(o.id,i.envelopeId,r),n(c=>({allocations:{...c.allocations,[r]:c.allocations[r]?.filter(u=>u.id!==t)||[]},isLoading:!1})),console.log(" Deleted envelope allocation:",t)}catch(r){throw console.error(" deleteEnvelopeAllocation failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete envelope allocation"}),r}},refreshAvailableToBudget:async()=>{try{const t=e().currentMonth,r=e().allocations[t]||[],i=e().incomeSources[t]||[],a=r.reduce((u,d)=>u+d.budgetedAmount,0);return i.reduce((u,d)=>u+d.amount,0)-a}catch(t){throw console.error(" refreshAvailableToBudget failed:",t),n({error:t instanceof Error?t.message:"Failed to refresh available to budget"}),t}},updateOnlineStatus:async()=>{try{const t=typeof navigator<"u"?navigator.onLine:!0;n({isOnline:t}),console.log(" Online status updated:",t)}catch(t){console.error(" Failed to update online status:",t)}},handleUserLogout:()=>{console.log(" Clearing user data on logout"),n({envelopes:[],transactions:[],incomeSources:{},allocations:{},isLoading:!1,error:null})}}),{name:"budget-storage"})));Vee({useBudgetStore:Mn,useAuthStore:fa,getCurrentUserId:zee});var Ju=9e15,_l=1e9,nw="0123456789abcdef",vv="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",yv="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",rw={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Ju,maxE:Ju,crypto:!1},wV,Ns,it=!0,gy="[DecimalError] ",pl=gy+"Invalid argument: ",EV=gy+"Precision limit exceeded",SV=gy+"crypto unavailable",TV="[object Decimal]",Lr=Math.floor,lr=Math.pow,Lee=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Bee=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Uee=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,AV=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ga=1e7,Qe=7,Fee=9007199254740991,Gee=vv.length-1,iw=yv.length-1,_e={toStringTag:TV};_e.absoluteValue=_e.abs=function(){var n=new this.constructor(this);return n.s<0&&(n.s=1),qe(n)};_e.ceil=function(){return qe(new this.constructor(this),this.e+1,2)};_e.clampedTo=_e.clamp=function(n,e){var t,r=this,i=r.constructor;if(n=new i(n),e=new i(e),!n.s||!e.s)return new i(NaN);if(n.gt(e))throw Error(pl+e);return t=r.cmp(n),t<0?n:r.cmp(e)>0?e:new i(r)};_e.comparedTo=_e.cmp=function(n){var e,t,r,i,a=this,o=a.d,c=(n=new a.constructor(n)).d,u=a.s,d=n.s;if(!o||!c)return!u||!d?NaN:u!==d?u:o===c?0:!o^u<0?1:-1;if(!o[0]||!c[0])return o[0]?u:c[0]?-d:0;if(u!==d)return u;if(a.e!==n.e)return a.e>n.e^u<0?1:-1;for(r=o.length,i=c.length,e=0,t=r<i?r:i;e<t;++e)if(o[e]!==c[e])return o[e]>c[e]^u<0?1:-1;return r===i?0:r>i^u<0?1:-1};_e.cosine=_e.cos=function(){var n,e,t=this,r=t.constructor;return t.d?t.d[0]?(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+Qe,r.rounding=1,t=qee(r,kV(r,t)),r.precision=n,r.rounding=e,qe(Ns==2||Ns==3?t.neg():t,n,e,!0)):new r(1):new r(NaN)};_e.cubeRoot=_e.cbrt=function(){var n,e,t,r,i,a,o,c,u,d,h=this,p=h.constructor;if(!h.isFinite()||h.isZero())return new p(h);for(it=!1,a=h.s*lr(h.s*h,1/3),!a||Math.abs(a)==1/0?(t=Cr(h.d),n=h.e,(a=(n-t.length+1)%3)&&(t+=a==1||a==-2?"0":"00"),a=lr(t,1/3),n=Lr((n+1)/3)-(n%3==(n<0?-1:2)),a==1/0?t="5e"+n:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+n),r=new p(t),r.s=h.s):r=new p(a.toString()),o=(n=p.precision)+3;;)if(c=r,u=c.times(c).times(c),d=u.plus(h),r=on(d.plus(h).times(c),d.plus(u),o+2,1),Cr(c.d).slice(0,o)===(t=Cr(r.d)).slice(0,o))if(t=t.slice(o-3,o+1),t=="9999"||!i&&t=="4999"){if(!i&&(qe(c,n+1,0),c.times(c).times(c).eq(h))){r=c;break}o+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(qe(r,n+1,1),e=!r.times(r).times(r).eq(h));break}return it=!0,qe(r,n,p.rounding,e)};_e.decimalPlaces=_e.dp=function(){var n,e=this.d,t=NaN;if(e){if(n=e.length-1,t=(n-Lr(this.e/Qe))*Qe,n=e[n],n)for(;n%10==0;n/=10)t--;t<0&&(t=0)}return t};_e.dividedBy=_e.div=function(n){return on(this,new this.constructor(n))};_e.dividedToIntegerBy=_e.divToInt=function(n){var e=this,t=e.constructor;return qe(on(e,new t(n),0,1,1),t.precision,t.rounding)};_e.equals=_e.eq=function(n){return this.cmp(n)===0};_e.floor=function(){return qe(new this.constructor(this),this.e+1,3)};_e.greaterThan=_e.gt=function(n){return this.cmp(n)>0};_e.greaterThanOrEqualTo=_e.gte=function(n){var e=this.cmp(n);return e==1||e===0};_e.hyperbolicCosine=_e.cosh=function(){var n,e,t,r,i,a=this,o=a.constructor,c=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return c;t=o.precision,r=o.rounding,o.precision=t+Math.max(a.e,a.sd())+4,o.rounding=1,i=a.d.length,i<32?(n=Math.ceil(i/3),e=(1/vy(4,n)).toString()):(n=16,e="2.3283064365386962890625e-10"),a=Nd(o,1,a.times(e),new o(1),!0);for(var u,d=n,h=new o(8);d--;)u=a.times(a),a=c.minus(u.times(h.minus(u.times(h))));return qe(a,o.precision=t,o.rounding=r,!0)};_e.hyperbolicSine=_e.sinh=function(){var n,e,t,r,i=this,a=i.constructor;if(!i.isFinite()||i.isZero())return new a(i);if(e=a.precision,t=a.rounding,a.precision=e+Math.max(i.e,i.sd())+4,a.rounding=1,r=i.d.length,r<3)i=Nd(a,2,i,i,!0);else{n=1.4*Math.sqrt(r),n=n>16?16:n|0,i=i.times(1/vy(5,n)),i=Nd(a,2,i,i,!0);for(var o,c=new a(5),u=new a(16),d=new a(20);n--;)o=i.times(i),i=i.times(c.plus(o.times(u.times(o).plus(d))))}return a.precision=e,a.rounding=t,qe(i,e,t,!0)};_e.hyperbolicTangent=_e.tanh=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+7,r.rounding=1,on(t.sinh(),t.cosh(),r.precision=n,r.rounding=e)):new r(t.s)};_e.inverseCosine=_e.acos=function(){var n=this,e=n.constructor,t=n.abs().cmp(1),r=e.precision,i=e.rounding;return t!==-1?t===0?n.isNeg()?Ya(e,r,i):new e(0):new e(NaN):n.isZero()?Ya(e,r+4,i).times(.5):(e.precision=r+6,e.rounding=1,n=new e(1).minus(n).div(n.plus(1)).sqrt().atan(),e.precision=r,e.rounding=i,n.times(2))};_e.inverseHyperbolicCosine=_e.acosh=function(){var n,e,t=this,r=t.constructor;return t.lte(1)?new r(t.eq(1)?0:NaN):t.isFinite()?(n=r.precision,e=r.rounding,r.precision=n+Math.max(Math.abs(t.e),t.sd())+4,r.rounding=1,it=!1,t=t.times(t).minus(1).sqrt().plus(t),it=!0,r.precision=n,r.rounding=e,t.ln()):new r(t)};_e.inverseHyperbolicSine=_e.asinh=function(){var n,e,t=this,r=t.constructor;return!t.isFinite()||t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+2*Math.max(Math.abs(t.e),t.sd())+6,r.rounding=1,it=!1,t=t.times(t).plus(1).sqrt().plus(t),it=!0,r.precision=n,r.rounding=e,t.ln())};_e.inverseHyperbolicTangent=_e.atanh=function(){var n,e,t,r,i=this,a=i.constructor;return i.isFinite()?i.e>=0?new a(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(n=a.precision,e=a.rounding,r=i.sd(),Math.max(r,n)<2*-i.e-1?qe(new a(i),n,e,!0):(a.precision=t=r-i.e,i=on(i.plus(1),new a(1).minus(i),t+n,1),a.precision=n+4,a.rounding=1,i=i.ln(),a.precision=n,a.rounding=e,i.times(.5))):new a(NaN)};_e.inverseSine=_e.asin=function(){var n,e,t,r,i=this,a=i.constructor;return i.isZero()?new a(i):(e=i.abs().cmp(1),t=a.precision,r=a.rounding,e!==-1?e===0?(n=Ya(a,t+4,r).times(.5),n.s=i.s,n):new a(NaN):(a.precision=t+6,a.rounding=1,i=i.div(new a(1).minus(i.times(i)).sqrt().plus(1)).atan(),a.precision=t,a.rounding=r,i.times(2)))};_e.inverseTangent=_e.atan=function(){var n,e,t,r,i,a,o,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding;if(d.isFinite()){if(d.isZero())return new h(d);if(d.abs().eq(1)&&p+4<=iw)return o=Ya(h,p+4,m).times(.25),o.s=d.s,o}else{if(!d.s)return new h(NaN);if(p+4<=iw)return o=Ya(h,p+4,m).times(.5),o.s=d.s,o}for(h.precision=c=p+10,h.rounding=1,t=Math.min(28,c/Qe+2|0),n=t;n;--n)d=d.div(d.times(d).plus(1).sqrt().plus(1));for(it=!1,e=Math.ceil(c/Qe),r=1,u=d.times(d),o=new h(d),i=d;n!==-1;)if(i=i.times(u),a=o.minus(i.div(r+=2)),i=i.times(u),o=a.plus(i.div(r+=2)),o.d[e]!==void 0)for(n=e;o.d[n]===a.d[n]&&n--;);return t&&(o=o.times(2<<t-1)),it=!0,qe(o,h.precision=p,h.rounding=m,!0)};_e.isFinite=function(){return!!this.d};_e.isInteger=_e.isInt=function(){return!!this.d&&Lr(this.e/Qe)>this.d.length-2};_e.isNaN=function(){return!this.s};_e.isNegative=_e.isNeg=function(){return this.s<0};_e.isPositive=_e.isPos=function(){return this.s>0};_e.isZero=function(){return!!this.d&&this.d[0]===0};_e.lessThan=_e.lt=function(n){return this.cmp(n)<0};_e.lessThanOrEqualTo=_e.lte=function(n){return this.cmp(n)<1};_e.logarithm=_e.log=function(n){var e,t,r,i,a,o,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding,b=5;if(n==null)n=new h(10),e=!0;else{if(n=new h(n),t=n.d,n.s<0||!t||!t[0]||n.eq(1))return new h(NaN);e=n.eq(10)}if(t=d.d,d.s<0||!t||!t[0]||d.eq(1))return new h(t&&!t[0]?-1/0:d.s!=1?NaN:t?0:1/0);if(e)if(t.length>1)a=!0;else{for(i=t[0];i%10===0;)i/=10;a=i!==1}if(it=!1,c=p+b,o=Wo(d,c),r=e?bv(h,c+10):Wo(n,c),u=on(o,r,c,1),mp(u.d,i=p,m))do if(c+=10,o=Wo(d,c),r=e?bv(h,c+10):Wo(n,c),u=on(o,r,c,1),!a){+Cr(u.d).slice(i+1,i+15)+1==1e14&&(u=qe(u,p+1,0));break}while(mp(u.d,i+=10,m));return it=!0,qe(u,p,m)};_e.minus=_e.sub=function(n){var e,t,r,i,a,o,c,u,d,h,p,m,b=this,_=b.constructor;if(n=new _(n),!b.d||!n.d)return!b.s||!n.s?n=new _(NaN):b.d?n.s=-n.s:n=new _(n.d||b.s!==n.s?b:NaN),n;if(b.s!=n.s)return n.s=-n.s,b.plus(n);if(d=b.d,m=n.d,c=_.precision,u=_.rounding,!d[0]||!m[0]){if(m[0])n.s=-n.s;else if(d[0])n=new _(b);else return new _(u===3?-0:0);return it?qe(n,c,u):n}if(t=Lr(n.e/Qe),h=Lr(b.e/Qe),d=d.slice(),a=h-t,a){for(p=a<0,p?(e=d,a=-a,o=m.length):(e=m,t=h,o=d.length),r=Math.max(Math.ceil(c/Qe),o)+2,a>r&&(a=r,e.length=1),e.reverse(),r=a;r--;)e.push(0);e.reverse()}else{for(r=d.length,o=m.length,p=r<o,p&&(o=r),r=0;r<o;r++)if(d[r]!=m[r]){p=d[r]<m[r];break}a=0}for(p&&(e=d,d=m,m=e,n.s=-n.s),o=d.length,r=m.length-o;r>0;--r)d[o++]=0;for(r=m.length;r>a;){if(d[--r]<m[r]){for(i=r;i&&d[--i]===0;)d[i]=ga-1;--d[i],d[r]+=ga}d[r]-=m[r]}for(;d[--o]===0;)d.pop();for(;d[0]===0;d.shift())--t;return d[0]?(n.d=d,n.e=my(d,t),it?qe(n,c,u):n):new _(u===3?-0:0)};_e.modulo=_e.mod=function(n){var e,t=this,r=t.constructor;return n=new r(n),!t.d||!n.s||n.d&&!n.d[0]?new r(NaN):!n.d||t.d&&!t.d[0]?qe(new r(t),r.precision,r.rounding):(it=!1,r.modulo==9?(e=on(t,n.abs(),0,3,1),e.s*=n.s):e=on(t,n,0,r.modulo,1),e=e.times(n),it=!0,t.minus(e))};_e.naturalExponential=_e.exp=function(){return aw(this)};_e.naturalLogarithm=_e.ln=function(){return Wo(this)};_e.negated=_e.neg=function(){var n=new this.constructor(this);return n.s=-n.s,qe(n)};_e.plus=_e.add=function(n){var e,t,r,i,a,o,c,u,d,h,p=this,m=p.constructor;if(n=new m(n),!p.d||!n.d)return!p.s||!n.s?n=new m(NaN):p.d||(n=new m(n.d||p.s===n.s?p:NaN)),n;if(p.s!=n.s)return n.s=-n.s,p.minus(n);if(d=p.d,h=n.d,c=m.precision,u=m.rounding,!d[0]||!h[0])return h[0]||(n=new m(p)),it?qe(n,c,u):n;if(a=Lr(p.e/Qe),r=Lr(n.e/Qe),d=d.slice(),i=a-r,i){for(i<0?(t=d,i=-i,o=h.length):(t=h,r=a,o=d.length),a=Math.ceil(c/Qe),o=a>o?a+1:o+1,i>o&&(i=o,t.length=1),t.reverse();i--;)t.push(0);t.reverse()}for(o=d.length,i=h.length,o-i<0&&(i=o,t=h,h=d,d=t),e=0;i;)e=(d[--i]=d[i]+h[i]+e)/ga|0,d[i]%=ga;for(e&&(d.unshift(e),++r),o=d.length;d[--o]==0;)d.pop();return n.d=d,n.e=my(d,r),it?qe(n,c,u):n};_e.precision=_e.sd=function(n){var e,t=this;if(n!==void 0&&n!==!!n&&n!==1&&n!==0)throw Error(pl+n);return t.d?(e=CV(t.d),n&&t.e+1>e&&(e=t.e+1)):e=NaN,e};_e.round=function(){var n=this,e=n.constructor;return qe(new e(n),n.e+1,e.rounding)};_e.sine=_e.sin=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+Qe,r.rounding=1,t=$ee(r,kV(r,t)),r.precision=n,r.rounding=e,qe(Ns>2?t.neg():t,n,e,!0)):new r(NaN)};_e.squareRoot=_e.sqrt=function(){var n,e,t,r,i,a,o=this,c=o.d,u=o.e,d=o.s,h=o.constructor;if(d!==1||!c||!c[0])return new h(!d||d<0&&(!c||c[0])?NaN:c?o:1/0);for(it=!1,d=Math.sqrt(+o),d==0||d==1/0?(e=Cr(c),(e.length+u)%2==0&&(e+="0"),d=Math.sqrt(e),u=Lr((u+1)/2)-(u<0||u%2),d==1/0?e="5e"+u:(e=d.toExponential(),e=e.slice(0,e.indexOf("e")+1)+u),r=new h(e)):r=new h(d.toString()),t=(u=h.precision)+3;;)if(a=r,r=a.plus(on(o,a,t+2,1)).times(.5),Cr(a.d).slice(0,t)===(e=Cr(r.d)).slice(0,t))if(e=e.slice(t-3,t+1),e=="9999"||!i&&e=="4999"){if(!i&&(qe(a,u+1,0),a.times(a).eq(o))){r=a;break}t+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(qe(r,u+1,1),n=!r.times(r).eq(o));break}return it=!0,qe(r,u,h.rounding,n)};_e.tangent=_e.tan=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+10,r.rounding=1,t=t.sin(),t.s=1,t=on(t,new r(1).minus(t.times(t)).sqrt(),n+10,0),r.precision=n,r.rounding=e,qe(Ns==2||Ns==4?t.neg():t,n,e,!0)):new r(NaN)};_e.times=_e.mul=function(n){var e,t,r,i,a,o,c,u,d,h=this,p=h.constructor,m=h.d,b=(n=new p(n)).d;if(n.s*=h.s,!m||!m[0]||!b||!b[0])return new p(!n.s||m&&!m[0]&&!b||b&&!b[0]&&!m?NaN:!m||!b?n.s/0:n.s*0);for(t=Lr(h.e/Qe)+Lr(n.e/Qe),u=m.length,d=b.length,u<d&&(a=m,m=b,b=a,o=u,u=d,d=o),a=[],o=u+d,r=o;r--;)a.push(0);for(r=d;--r>=0;){for(e=0,i=u+r;i>r;)c=a[i]+b[r]*m[i-r-1]+e,a[i--]=c%ga|0,e=c/ga|0;a[i]=(a[i]+e)%ga|0}for(;!a[--o];)a.pop();return e?++t:a.shift(),n.d=a,n.e=my(a,t),it?qe(n,p.precision,p.rounding):n};_e.toBinary=function(n,e){return US(this,2,n,e)};_e.toDecimalPlaces=_e.toDP=function(n,e){var t=this,r=t.constructor;return t=new r(t),n===void 0?t:(ci(n,0,_l),e===void 0?e=r.rounding:ci(e,0,8),qe(t,n+t.e+1,e))};_e.toExponential=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=is(r,!0):(ci(n,0,_l),e===void 0?e=i.rounding:ci(e,0,8),r=qe(new i(r),n+1,e),t=is(r,!0,n+1)),r.isNeg()&&!r.isZero()?"-"+t:t};_e.toFixed=function(n,e){var t,r,i=this,a=i.constructor;return n===void 0?t=is(i):(ci(n,0,_l),e===void 0?e=a.rounding:ci(e,0,8),r=qe(new a(i),n+i.e+1,e),t=is(r,!1,n+r.e+1)),i.isNeg()&&!i.isZero()?"-"+t:t};_e.toFraction=function(n){var e,t,r,i,a,o,c,u,d,h,p,m,b=this,_=b.d,w=b.constructor;if(!_)return new w(b);if(d=t=new w(1),r=u=new w(0),e=new w(r),a=e.e=CV(_)-b.e-1,o=a%Qe,e.d[0]=lr(10,o<0?Qe+o:o),n==null)n=a>0?e:d;else{if(c=new w(n),!c.isInt()||c.lt(d))throw Error(pl+c);n=c.gt(e)?a>0?e:d:c}for(it=!1,c=new w(Cr(_)),h=w.precision,w.precision=a=_.length*Qe*2;p=on(c,e,0,1,1),i=t.plus(p.times(r)),i.cmp(n)!=1;)t=r,r=i,i=d,d=u.plus(p.times(i)),u=i,i=e,e=c.minus(p.times(i)),c=i;return i=on(n.minus(t),r,0,1,1),u=u.plus(i.times(d)),t=t.plus(i.times(r)),u.s=d.s=b.s,m=on(d,r,a,1).minus(b).abs().cmp(on(u,t,a,1).minus(b).abs())<1?[d,r]:[u,t],w.precision=h,it=!0,m};_e.toHexadecimal=_e.toHex=function(n,e){return US(this,16,n,e)};_e.toNearest=function(n,e){var t=this,r=t.constructor;if(t=new r(t),n==null){if(!t.d)return t;n=new r(1),e=r.rounding}else{if(n=new r(n),e===void 0?e=r.rounding:ci(e,0,8),!t.d)return n.s?t:n;if(!n.d)return n.s&&(n.s=t.s),n}return n.d[0]?(it=!1,t=on(t,n,0,e,1).times(n),it=!0,qe(t)):(n.s=t.s,t=n),t};_e.toNumber=function(){return+this};_e.toOctal=function(n,e){return US(this,8,n,e)};_e.toPower=_e.pow=function(n){var e,t,r,i,a,o,c=this,u=c.constructor,d=+(n=new u(n));if(!c.d||!n.d||!c.d[0]||!n.d[0])return new u(lr(+c,d));if(c=new u(c),c.eq(1))return c;if(r=u.precision,a=u.rounding,n.eq(1))return qe(c,r,a);if(e=Lr(n.e/Qe),e>=n.d.length-1&&(t=d<0?-d:d)<=Fee)return i=IV(u,c,t,r),n.s<0?new u(1).div(i):qe(i,r,a);if(o=c.s,o<0){if(e<n.d.length-1)return new u(NaN);if((n.d[e]&1)==0&&(o=1),c.e==0&&c.d[0]==1&&c.d.length==1)return c.s=o,c}return t=lr(+c,d),e=t==0||!isFinite(t)?Lr(d*(Math.log("0."+Cr(c.d))/Math.LN10+c.e+1)):new u(t+"").e,e>u.maxE+1||e<u.minE-1?new u(e>0?o/0:0):(it=!1,u.rounding=c.s=1,t=Math.min(12,(e+"").length),i=aw(n.times(Wo(c,r+t)),r),i.d&&(i=qe(i,r+5,1),mp(i.d,r,a)&&(e=r+10,i=qe(aw(n.times(Wo(c,e+t)),e),e+5,1),+Cr(i.d).slice(r+1,r+15)+1==1e14&&(i=qe(i,r+1,0)))),i.s=o,it=!0,u.rounding=a,qe(i,r,a))};_e.toPrecision=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=is(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(ci(n,1,_l),e===void 0?e=i.rounding:ci(e,0,8),r=qe(new i(r),n,e),t=is(r,n<=r.e||r.e<=i.toExpNeg,n)),r.isNeg()&&!r.isZero()?"-"+t:t};_e.toSignificantDigits=_e.toSD=function(n,e){var t=this,r=t.constructor;return n===void 0?(n=r.precision,e=r.rounding):(ci(n,1,_l),e===void 0?e=r.rounding:ci(e,0,8)),qe(new r(t),n,e)};_e.toString=function(){var n=this,e=n.constructor,t=is(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()&&!n.isZero()?"-"+t:t};_e.truncated=_e.trunc=function(){return qe(new this.constructor(this),this.e+1,1)};_e.valueOf=_e.toJSON=function(){var n=this,e=n.constructor,t=is(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()?"-"+t:t};function Cr(n){var e,t,r,i=n.length-1,a="",o=n[0];if(i>0){for(a+=o,e=1;e<i;e++)r=n[e]+"",t=Qe-r.length,t&&(a+=Uo(t)),a+=r;o=n[e],r=o+"",t=Qe-r.length,t&&(a+=Uo(t))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}function ci(n,e,t){if(n!==~~n||n<e||n>t)throw Error(pl+n)}function mp(n,e,t,r){var i,a,o,c;for(a=n[0];a>=10;a/=10)--e;return--e<0?(e+=Qe,i=0):(i=Math.ceil((e+1)/Qe),e%=Qe),a=lr(10,Qe-e),c=n[i]%a|0,r==null?e<3?(e==0?c=c/100|0:e==1&&(c=c/10|0),o=t<4&&c==99999||t>3&&c==49999||c==5e4||c==0):o=(t<4&&c+1==a||t>3&&c+1==a/2)&&(n[i+1]/a/100|0)==lr(10,e-2)-1||(c==a/2||c==0)&&(n[i+1]/a/100|0)==0:e<4?(e==0?c=c/1e3|0:e==1?c=c/100|0:e==2&&(c=c/10|0),o=(r||t<4)&&c==9999||!r&&t>3&&c==4999):o=((r||t<4)&&c+1==a||!r&&t>3&&c+1==a/2)&&(n[i+1]/a/1e3|0)==lr(10,e-3)-1,o}function w0(n,e,t){for(var r,i=[0],a,o=0,c=n.length;o<c;){for(a=i.length;a--;)i[a]*=e;for(i[0]+=nw.indexOf(n.charAt(o++)),r=0;r<i.length;r++)i[r]>t-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/t|0,i[r]%=t)}return i.reverse()}function qee(n,e){var t,r,i;if(e.isZero())return e;r=e.d.length,r<32?(t=Math.ceil(r/3),i=(1/vy(4,t)).toString()):(t=16,i="2.3283064365386962890625e-10"),n.precision+=t,e=Nd(n,1,e.times(i),new n(1));for(var a=t;a--;){var o=e.times(e);e=o.times(o).minus(o).times(8).plus(1)}return n.precision-=t,e}var on=(function(){function n(r,i,a){var o,c=0,u=r.length;for(r=r.slice();u--;)o=r[u]*i+c,r[u]=o%a|0,c=o/a|0;return c&&r.unshift(c),r}function e(r,i,a,o){var c,u;if(a!=o)u=a>o?1:-1;else for(c=u=0;c<a;c++)if(r[c]!=i[c]){u=r[c]>i[c]?1:-1;break}return u}function t(r,i,a,o){for(var c=0;a--;)r[a]-=c,c=r[a]<i[a]?1:0,r[a]=c*o+r[a]-i[a];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,a,o,c,u){var d,h,p,m,b,_,w,S,T,A,D,O,M,j,C,I,k,z,L,B,P=r.constructor,J=r.s==i.s?1:-1,Y=r.d,H=i.d;if(!Y||!Y[0]||!H||!H[0])return new P(!r.s||!i.s||(Y?H&&Y[0]==H[0]:!H)?NaN:Y&&Y[0]==0||!H?J*0:J/0);for(u?(b=1,h=r.e-i.e):(u=ga,b=Qe,h=Lr(r.e/b)-Lr(i.e/b)),L=H.length,k=Y.length,T=new P(J),A=T.d=[],p=0;H[p]==(Y[p]||0);p++);if(H[p]>(Y[p]||0)&&h--,a==null?(j=a=P.precision,o=P.rounding):c?j=a+(r.e-i.e)+1:j=a,j<0)A.push(1),_=!0;else{if(j=j/b+2|0,p=0,L==1){for(m=0,H=H[0],j++;(p<k||m)&&j--;p++)C=m*u+(Y[p]||0),A[p]=C/H|0,m=C%H|0;_=m||p<k}else{for(m=u/(H[0]+1)|0,m>1&&(H=n(H,m,u),Y=n(Y,m,u),L=H.length,k=Y.length),I=L,D=Y.slice(0,L),O=D.length;O<L;)D[O++]=0;B=H.slice(),B.unshift(0),z=H[0],H[1]>=u/2&&++z;do m=0,d=e(H,D,L,O),d<0?(M=D[0],L!=O&&(M=M*u+(D[1]||0)),m=M/z|0,m>1?(m>=u&&(m=u-1),w=n(H,m,u),S=w.length,O=D.length,d=e(w,D,S,O),d==1&&(m--,t(w,L<S?B:H,S,u))):(m==0&&(d=m=1),w=H.slice()),S=w.length,S<O&&w.unshift(0),t(D,w,O,u),d==-1&&(O=D.length,d=e(H,D,L,O),d<1&&(m++,t(D,L<O?B:H,O,u))),O=D.length):d===0&&(m++,D=[0]),A[p++]=m,d&&D[0]?D[O++]=Y[I]||0:(D=[Y[I]],O=1);while((I++<k||D[0]!==void 0)&&j--);_=D[0]!==void 0}A[0]||A.shift()}if(b==1)T.e=h,wV=_;else{for(p=1,m=A[0];m>=10;m/=10)p++;T.e=p+h*b-1,qe(T,c?a+T.e+1:a,o,_)}return T}})();function qe(n,e,t,r){var i,a,o,c,u,d,h,p,m,b=n.constructor;e:if(e!=null){if(p=n.d,!p)return n;for(i=1,c=p[0];c>=10;c/=10)i++;if(a=e-i,a<0)a+=Qe,o=e,h=p[m=0],u=h/lr(10,i-o-1)%10|0;else if(m=Math.ceil((a+1)/Qe),c=p.length,m>=c)if(r){for(;c++<=m;)p.push(0);h=u=0,i=1,a%=Qe,o=a-Qe+1}else break e;else{for(h=c=p[m],i=1;c>=10;c/=10)i++;a%=Qe,o=a-Qe+i,u=o<0?0:h/lr(10,i-o-1)%10|0}if(r=r||e<0||p[m+1]!==void 0||(o<0?h:h%lr(10,i-o-1)),d=t<4?(u||r)&&(t==0||t==(n.s<0?3:2)):u>5||u==5&&(t==4||r||t==6&&(a>0?o>0?h/lr(10,i-o):0:p[m-1])%10&1||t==(n.s<0?8:7)),e<1||!p[0])return p.length=0,d?(e-=n.e+1,p[0]=lr(10,(Qe-e%Qe)%Qe),n.e=-e||0):p[0]=n.e=0,n;if(a==0?(p.length=m,c=1,m--):(p.length=m+1,c=lr(10,Qe-a),p[m]=o>0?(h/lr(10,i-o)%lr(10,o)|0)*c:0),d)for(;;)if(m==0){for(a=1,o=p[0];o>=10;o/=10)a++;for(o=p[0]+=c,c=1;o>=10;o/=10)c++;a!=c&&(n.e++,p[0]==ga&&(p[0]=1));break}else{if(p[m]+=c,p[m]!=ga)break;p[m--]=0,c=1}for(a=p.length;p[--a]===0;)p.pop()}return it&&(n.e>b.maxE?(n.d=null,n.e=NaN):n.e<b.minE&&(n.e=0,n.d=[0])),n}function is(n,e,t){if(!n.isFinite())return DV(n);var r,i=n.e,a=Cr(n.d),o=a.length;return e?(t&&(r=t-o)>0?a=a.charAt(0)+"."+a.slice(1)+Uo(r):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(n.e<0?"e":"e+")+n.e):i<0?(a="0."+Uo(-i-1)+a,t&&(r=t-o)>0&&(a+=Uo(r))):i>=o?(a+=Uo(i+1-o),t&&(r=t-i-1)>0&&(a=a+"."+Uo(r))):((r=i+1)<o&&(a=a.slice(0,r)+"."+a.slice(r)),t&&(r=t-o)>0&&(i+1===o&&(a+="."),a+=Uo(r))),a}function my(n,e){var t=n[0];for(e*=Qe;t>=10;t/=10)e++;return e}function bv(n,e,t){if(e>Gee)throw it=!0,t&&(n.precision=t),Error(EV);return qe(new n(vv),e,1,!0)}function Ya(n,e,t){if(e>iw)throw Error(EV);return qe(new n(yv),e,t,!0)}function CV(n){var e=n.length-1,t=e*Qe+1;if(e=n[e],e){for(;e%10==0;e/=10)t--;for(e=n[0];e>=10;e/=10)t++}return t}function Uo(n){for(var e="";n--;)e+="0";return e}function IV(n,e,t,r){var i,a=new n(1),o=Math.ceil(r/Qe+4);for(it=!1;;){if(t%2&&(a=a.times(e),Yk(a.d,o)&&(i=!0)),t=Lr(t/2),t===0){t=a.d.length-1,i&&a.d[t]===0&&++a.d[t];break}e=e.times(e),Yk(e.d,o)}return it=!0,a}function $k(n){return n.d[n.d.length-1]&1}function RV(n,e,t){for(var r,i,a=new n(e[0]),o=0;++o<e.length;){if(i=new n(e[o]),!i.s){a=i;break}r=a.cmp(i),(r===t||r===0&&a.s===t)&&(a=i)}return a}function aw(n,e){var t,r,i,a,o,c,u,d=0,h=0,p=0,m=n.constructor,b=m.rounding,_=m.precision;if(!n.d||!n.d[0]||n.e>17)return new m(n.d?n.d[0]?n.s<0?0:1/0:1:n.s?n.s<0?0:n:NaN);for(e==null?(it=!1,u=_):u=e,c=new m(.03125);n.e>-2;)n=n.times(c),p+=5;for(r=Math.log(lr(2,p))/Math.LN10*2+5|0,u+=r,t=a=o=new m(1),m.precision=u;;){if(a=qe(a.times(n),u,1),t=t.times(++h),c=o.plus(on(a,t,u,1)),Cr(c.d).slice(0,u)===Cr(o.d).slice(0,u)){for(i=p;i--;)o=qe(o.times(o),u,1);if(e==null)if(d<3&&mp(o.d,u-r,b,d))m.precision=u+=10,t=a=c=new m(1),h=0,d++;else return qe(o,m.precision=_,b,it=!0);else return m.precision=_,o}o=c}}function Wo(n,e){var t,r,i,a,o,c,u,d,h,p,m,b=1,_=10,w=n,S=w.d,T=w.constructor,A=T.rounding,D=T.precision;if(w.s<0||!S||!S[0]||!w.e&&S[0]==1&&S.length==1)return new T(S&&!S[0]?-1/0:w.s!=1?NaN:S?0:w);if(e==null?(it=!1,h=D):h=e,T.precision=h+=_,t=Cr(S),r=t.charAt(0),Math.abs(a=w.e)<15e14){for(;r<7&&r!=1||r==1&&t.charAt(1)>3;)w=w.times(n),t=Cr(w.d),r=t.charAt(0),b++;a=w.e,r>1?(w=new T("0."+t),a++):w=new T(r+"."+t.slice(1))}else return d=bv(T,h+2,D).times(a+""),w=Wo(new T(r+"."+t.slice(1)),h-_).plus(d),T.precision=D,e==null?qe(w,D,A,it=!0):w;for(p=w,u=o=w=on(w.minus(1),w.plus(1),h,1),m=qe(w.times(w),h,1),i=3;;){if(o=qe(o.times(m),h,1),d=u.plus(on(o,new T(i),h,1)),Cr(d.d).slice(0,h)===Cr(u.d).slice(0,h))if(u=u.times(2),a!==0&&(u=u.plus(bv(T,h+2,D).times(a+""))),u=on(u,new T(b),h,1),e==null)if(mp(u.d,h-_,A,c))T.precision=h+=_,d=o=w=on(p.minus(1),p.plus(1),h,1),m=qe(w.times(w),h,1),i=c=1;else return qe(u,T.precision=D,A,it=!0);else return T.precision=D,u;u=d,i+=2}}function DV(n){return String(n.s*n.s/0)}function E0(n,e){var t,r,i;for((t=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(t<0&&(t=r),t+=+e.slice(r+1),e=e.substring(0,r)):t<0&&(t=e.length),r=0;e.charCodeAt(r)===48;r++);for(i=e.length;e.charCodeAt(i-1)===48;--i);if(e=e.slice(r,i),e){if(i-=r,n.e=t=t-r-1,n.d=[],r=(t+1)%Qe,t<0&&(r+=Qe),r<i){for(r&&n.d.push(+e.slice(0,r)),i-=Qe;r<i;)n.d.push(+e.slice(r,r+=Qe));e=e.slice(r),r=Qe-e.length}else r-=i;for(;r--;)e+="0";n.d.push(+e),it&&(n.e>n.constructor.maxE?(n.d=null,n.e=NaN):n.e<n.constructor.minE&&(n.e=0,n.d=[0]))}else n.e=0,n.d=[0];return n}function Hee(n,e){var t,r,i,a,o,c,u,d,h;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),AV.test(e))return E0(n,e)}else if(e==="Infinity"||e==="NaN")return+e||(n.s=NaN),n.e=NaN,n.d=null,n;if(Bee.test(e))t=16,e=e.toLowerCase();else if(Lee.test(e))t=2;else if(Uee.test(e))t=8;else throw Error(pl+e);for(a=e.search(/p/i),a>0?(u=+e.slice(a+1),e=e.substring(2,a)):e=e.slice(2),a=e.indexOf("."),o=a>=0,r=n.constructor,o&&(e=e.replace(".",""),c=e.length,a=c-a,i=IV(r,new r(t),a,a*2)),d=w0(e,t,ga),h=d.length-1,a=h;d[a]===0;--a)d.pop();return a<0?new r(n.s*0):(n.e=my(d,h),n.d=d,it=!1,o&&(n=on(n,i,c*4)),u&&(n=n.times(Math.abs(u)<54?lr(2,u):Md.pow(2,u))),it=!0,n)}function $ee(n,e){var t,r=e.d.length;if(r<3)return e.isZero()?e:Nd(n,2,e,e);t=1.4*Math.sqrt(r),t=t>16?16:t|0,e=e.times(1/vy(5,t)),e=Nd(n,2,e,e);for(var i,a=new n(5),o=new n(16),c=new n(20);t--;)i=e.times(e),e=e.times(a.plus(i.times(o.times(i).minus(c))));return e}function Nd(n,e,t,r,i){var a,o,c,u,d=n.precision,h=Math.ceil(d/Qe);for(it=!1,u=t.times(t),c=new n(r);;){if(o=on(c.times(u),new n(e++*e++),d,1),c=i?r.plus(o):r.minus(o),r=on(o.times(u),new n(e++*e++),d,1),o=c.plus(r),o.d[h]!==void 0){for(a=h;o.d[a]===c.d[a]&&a--;);if(a==-1)break}a=c,c=r,r=o,o=a}return it=!0,o.d.length=h+1,o}function vy(n,e){for(var t=n;--e;)t*=n;return t}function kV(n,e){var t,r=e.s<0,i=Ya(n,n.precision,1),a=i.times(.5);if(e=e.abs(),e.lte(a))return Ns=r?4:1,e;if(t=e.divToInt(i),t.isZero())Ns=r?3:2;else{if(e=e.minus(t.times(i)),e.lte(a))return Ns=$k(t)?r?2:3:r?4:1,e;Ns=$k(t)?r?1:4:r?3:2}return e.minus(i).abs()}function US(n,e,t,r){var i,a,o,c,u,d,h,p,m,b=n.constructor,_=t!==void 0;if(_?(ci(t,1,_l),r===void 0?r=b.rounding:ci(r,0,8)):(t=b.precision,r=b.rounding),!n.isFinite())h=DV(n);else{for(h=is(n),o=h.indexOf("."),_?(i=2,e==16?t=t*4-3:e==8&&(t=t*3-2)):i=e,o>=0&&(h=h.replace(".",""),m=new b(1),m.e=h.length-o,m.d=w0(is(m),10,i),m.e=m.d.length),p=w0(h,10,i),a=u=p.length;p[--u]==0;)p.pop();if(!p[0])h=_?"0p+0":"0";else{if(o<0?a--:(n=new b(n),n.d=p,n.e=a,n=on(n,m,t,r,0,i),p=n.d,a=n.e,d=wV),o=p[t],c=i/2,d=d||p[t+1]!==void 0,d=r<4?(o!==void 0||d)&&(r===0||r===(n.s<0?3:2)):o>c||o===c&&(r===4||d||r===6&&p[t-1]&1||r===(n.s<0?8:7)),p.length=t,d)for(;++p[--t]>i-1;)p[t]=0,t||(++a,p.unshift(1));for(u=p.length;!p[u-1];--u);for(o=0,h="";o<u;o++)h+=nw.charAt(p[o]);if(_){if(u>1)if(e==16||e==8){for(o=e==16?4:3,--u;u%o;u++)h+="0";for(p=w0(h,i,e),u=p.length;!p[u-1];--u);for(o=1,h="1.";o<u;o++)h+=nw.charAt(p[o])}else h=h.charAt(0)+"."+h.slice(1);h=h+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)h="0"+h;h="0."+h}else if(++a>u)for(a-=u;a--;)h+="0";else a<u&&(h=h.slice(0,a)+"."+h.slice(a))}h=(e==16?"0x":e==2?"0b":e==8?"0o":"")+h}return n.s<0?"-"+h:h}function Yk(n,e){if(n.length>e)return n.length=e,!0}function Yee(n){return new this(n).abs()}function Kee(n){return new this(n).acos()}function Xee(n){return new this(n).acosh()}function Wee(n,e){return new this(n).plus(e)}function Qee(n){return new this(n).asin()}function Zee(n){return new this(n).asinh()}function Jee(n){return new this(n).atan()}function ete(n){return new this(n).atanh()}function tte(n,e){n=new this(n),e=new this(e);var t,r=this.precision,i=this.rounding,a=r+4;return!n.s||!e.s?t=new this(NaN):!n.d&&!e.d?(t=Ya(this,a,1).times(e.s>0?.25:.75),t.s=n.s):!e.d||n.isZero()?(t=e.s<0?Ya(this,r,i):new this(0),t.s=n.s):!n.d||e.isZero()?(t=Ya(this,a,1).times(.5),t.s=n.s):e.s<0?(this.precision=a,this.rounding=1,t=this.atan(on(n,e,a,1)),e=Ya(this,a,1),this.precision=r,this.rounding=i,t=n.s<0?t.minus(e):t.plus(e)):t=this.atan(on(n,e,a,1)),t}function nte(n){return new this(n).cbrt()}function rte(n){return qe(n=new this(n),n.e+1,2)}function ite(n,e,t){return new this(n).clamp(e,t)}function ate(n){if(!n||typeof n!="object")throw Error(gy+"Object expected");var e,t,r,i=n.defaults===!0,a=["precision",1,_l,"rounding",0,8,"toExpNeg",-Ju,0,"toExpPos",0,Ju,"maxE",0,Ju,"minE",-Ju,0,"modulo",0,9];for(e=0;e<a.length;e+=3)if(t=a[e],i&&(this[t]=rw[t]),(r=n[t])!==void 0)if(Lr(r)===r&&r>=a[e+1]&&r<=a[e+2])this[t]=r;else throw Error(pl+t+": "+r);if(t="crypto",i&&(this[t]=rw[t]),(r=n[t])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[t]=!0;else throw Error(SV);else this[t]=!1;else throw Error(pl+t+": "+r);return this}function ste(n){return new this(n).cos()}function ote(n){return new this(n).cosh()}function NV(n){var e,t,r;function i(a){var o,c,u,d=this;if(!(d instanceof i))return new i(a);if(d.constructor=i,Kk(a)){d.s=a.s,it?!a.d||a.e>i.maxE?(d.e=NaN,d.d=null):a.e<i.minE?(d.e=0,d.d=[0]):(d.e=a.e,d.d=a.d.slice()):(d.e=a.e,d.d=a.d?a.d.slice():a.d);return}if(u=typeof a,u==="number"){if(a===0){d.s=1/a<0?-1:1,d.e=0,d.d=[0];return}if(a<0?(a=-a,d.s=-1):d.s=1,a===~~a&&a<1e7){for(o=0,c=a;c>=10;c/=10)o++;it?o>i.maxE?(d.e=NaN,d.d=null):o<i.minE?(d.e=0,d.d=[0]):(d.e=o,d.d=[a]):(d.e=o,d.d=[a]);return}if(a*0!==0){a||(d.s=NaN),d.e=NaN,d.d=null;return}return E0(d,a.toString())}if(u==="string")return(c=a.charCodeAt(0))===45?(a=a.slice(1),d.s=-1):(c===43&&(a=a.slice(1)),d.s=1),AV.test(a)?E0(d,a):Hee(d,a);if(u==="bigint")return a<0?(a=-a,d.s=-1):d.s=1,E0(d,a.toString());throw Error(pl+a)}if(i.prototype=_e,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=ate,i.clone=NV,i.isDecimal=Kk,i.abs=Yee,i.acos=Kee,i.acosh=Xee,i.add=Wee,i.asin=Qee,i.asinh=Zee,i.atan=Jee,i.atanh=ete,i.atan2=tte,i.cbrt=nte,i.ceil=rte,i.clamp=ite,i.cos=ste,i.cosh=ote,i.div=lte,i.exp=cte,i.floor=ute,i.hypot=dte,i.ln=fte,i.log=hte,i.log10=gte,i.log2=pte,i.max=mte,i.min=vte,i.mod=yte,i.mul=bte,i.pow=xte,i.random=_te,i.round=wte,i.sign=Ete,i.sin=Ste,i.sinh=Tte,i.sqrt=Ate,i.sub=Cte,i.sum=Ite,i.tan=Rte,i.tanh=Dte,i.trunc=kte,n===void 0&&(n={}),n&&n.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<r.length;)n.hasOwnProperty(t=r[e++])||(n[t]=this[t]);return i.config(n),i}function lte(n,e){return new this(n).div(e)}function cte(n){return new this(n).exp()}function ute(n){return qe(n=new this(n),n.e+1,3)}function dte(){var n,e,t=new this(0);for(it=!1,n=0;n<arguments.length;)if(e=new this(arguments[n++]),e.d)t.d&&(t=t.plus(e.times(e)));else{if(e.s)return it=!0,new this(1/0);t=e}return it=!0,t.sqrt()}function Kk(n){return n instanceof Md||n&&n.toStringTag===TV||!1}function fte(n){return new this(n).ln()}function hte(n,e){return new this(n).log(e)}function pte(n){return new this(n).log(2)}function gte(n){return new this(n).log(10)}function mte(){return RV(this,arguments,-1)}function vte(){return RV(this,arguments,1)}function yte(n,e){return new this(n).mod(e)}function bte(n,e){return new this(n).mul(e)}function xte(n,e){return new this(n).pow(e)}function _te(n){var e,t,r,i,a=0,o=new this(1),c=[];if(n===void 0?n=this.precision:ci(n,1,_l),r=Math.ceil(n/Qe),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));a<r;)i=e[a],i>=429e7?e[a]=crypto.getRandomValues(new Uint32Array(1))[0]:c[a++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(r*=4);a<r;)i=e[a]+(e[a+1]<<8)+(e[a+2]<<16)+((e[a+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(e,a):(c.push(i%1e7),a+=4);a=r/4}else throw Error(SV);else for(;a<r;)c[a++]=Math.random()*1e7|0;for(r=c[--a],n%=Qe,r&&n&&(i=lr(10,Qe-n),c[a]=(r/i|0)*i);c[a]===0;a--)c.pop();if(a<0)t=0,c=[0];else{for(t=-1;c[0]===0;t-=Qe)c.shift();for(r=1,i=c[0];i>=10;i/=10)r++;r<Qe&&(t-=Qe-r)}return o.e=t,o.d=c,o}function wte(n){return qe(n=new this(n),n.e+1,this.rounding)}function Ete(n){return n=new this(n),n.d?n.d[0]?n.s:0*n.s:n.s||NaN}function Ste(n){return new this(n).sin()}function Tte(n){return new this(n).sinh()}function Ate(n){return new this(n).sqrt()}function Cte(n,e){return new this(n).sub(e)}function Ite(){var n=0,e=arguments,t=new this(e[n]);for(it=!1;t.s&&++n<e.length;)t=t.plus(e[n]);return it=!0,qe(t,this.precision,this.rounding)}function Rte(n){return new this(n).tan()}function Dte(n){return new this(n).tanh()}function kte(n){return qe(n=new this(n),n.e+1,1)}_e[Symbol.for("nodejs.util.inspect.custom")]=_e.toString;_e[Symbol.toStringTag]="Decimal";var Md=_e.constructor=NV(rw);vv=new Md(vv);yv=new Md(yv);const Xk=n=>{if(!n)return null;if(n instanceof Date)return n;if(typeof n=="object"&&typeof n.toDate=="function")return n.toDate();if(typeof n=="object"&&n.seconds!==void 0)return new Date(n.seconds*1e3);if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?null:e}if(typeof n=="number"){const e=new Date(n);return isNaN(e.getTime())?null:e}return null},Nte=()=>{const{envelopes:n,transactions:e,fetchData:t,isLoading:r,isOnline:i,reorderEnvelopes:a}=Mn(),{currentUser:o}=fa(),{currentMonth:c,incomeSources:u,allocations:d,deleteIncomeSource:h,setEnvelopeAllocation:p,copyPreviousMonthAllocations:m,isLoading:b}=Mn(),{showToast:_}=bl(),[w,S]=U.useState(!1),T=U.useRef(null),[A,D]=U.useState(!1),O=!A||r||b,[M,j]=U.useState([]),C=U.useRef([]),[I,k]=U.useState([]),z=U.useRef([]),L=U.useCallback(ee=>{if(n.find(fe=>fe.id===ee)?.isPiggybank){const fe=Mn.getState().getEnvelopeBalance(ee);return new Md(fe)}const le=Mn.getState().getEnvelopeBalance(ee,c);return new Md(le)},[n,c]);U.useEffect(()=>{const ee=n.filter(te=>{if(!te.isPiggybank||!te.isActive)return!1;if(te.createdAt)try{const le=Xk(te.createdAt);if(!le)return console.error(` Invalid creation date for piggybank ${te.name}:`,te.createdAt),!1;const fe=`${le.getFullYear()}-${String(le.getMonth()+1).padStart(2,"0")}`;return c>=fe}catch(le){return console.error(` Error processing piggybank ${te.name}:`,le,{createdAt:te.createdAt,typeofCreatedAt:typeof te.createdAt}),!1}return!0}).sort((te,le)=>{const fe=te.orderIndex??0,oe=le.orderIndex??0;return fe-oe});k(ee),z.current=ee},[n,c]);const B=I,P=M;U.useEffect(()=>(T.current=setTimeout(()=>{S(!0)},8e3),t(),D(!0),()=>{T.current&&clearTimeout(T.current)}),[]),U.useEffect(()=>{A&&!r&&!b&&(S(!1),T.current&&clearTimeout(T.current))},[A,r,b]),U.useEffect(()=>{const ee=n.filter(te=>{if(te.isPiggybank||te.isActive===!1)return!1;const fe=(d[c]||[]).some(Ee=>Ee.envelopeId===te.id),oe=e.some(Ee=>Ee.envelopeId===te.id&&(Ee.month===c||Ee.date.startsWith(c)));return fe||oe}).sort((te,le)=>{const fe=te.orderIndex??0,oe=le.orderIndex??0;return fe-oe});j(ee),C.current=ee},[n,d,c,e]);const J=(u[c]||[]).reduce((ee,te)=>ee+te.amount,0),Y=(d[c]||[]).filter(ee=>P.some(te=>te.id===ee.envelopeId)||B.some(te=>te.id===ee.envelopeId)).reduce((ee,te)=>ee+te.budgetedAmount,0),H=J-Y,W=U.useCallback(async ee=>{if(!ee.length)return;const te=ee.map(le=>le.id);try{await a(te)}catch(le){console.error("Failed to persist envelope order:",le),_("Failed to save envelope order","error")}},[a,_]),K=U.useCallback(async ee=>{await W(ee)},[W]),de=U.useCallback(ee=>{h(c,ee.id).catch(console.error),_(`Deleted "${ee.name}"`,"neutral")},[h,c,_]),Q=U.useCallback(async ee=>{try{const te=ee||c;console.log(" Copying to month:",te),await m(te),_("Previous month budget copied","success")}catch(te){console.error("Error copying previous month:",te),_("Failed to copy previous month","error")}},[m,_,c]),G=U.useCallback(async()=>{if(!o||!c){_("Cannot clear data: not logged in or no month selected","error");return}try{await Mn.getState().clearMonthData(c),_(`"${c}" budget and transactions cleared successfully`,"success")}catch(ee){console.error("Error clearing month data:",ee),_("Failed to clear month data","error")}},[o,c,_]),$=U.useCallback(async(ee,te)=>{try{await p(ee,te),setTimeout(()=>{const le=Mn.getState(),fe=le.currentMonth,oe=le.incomeSources[fe]||[],Ee=le.allocations[fe]||[],ke=new Set(le.envelopes.filter(Be=>{if(Be.isPiggybank){if(!Be.isActive)return!1;if(Be.createdAt){const Me=Xk(Be.createdAt);if(!Me)return!1;const He=`${Me.getFullYear()}-${String(Me.getMonth()+1).padStart(2,"0")}`;return fe>=He}return!0}return Be.isActive!==!1}).map(Be=>Be.id)),Ke=Ee.filter(Be=>ke.has(Be.envelopeId)),Se=oe.reduce((Be,Me)=>Be+Me.amount,0),Ne=Ke.reduce((Be,Me)=>Be+Me.budgetedAmount,0);Se-Ne<-.005?_(`You can't spend more than you make.
You're not in Congress!`,"error"):Math.abs(Se-Ne)<.005&&Se>0&&_("Every dollar has a job ","success")},100)}catch(le){console.error("Failed to set allocation:",le),_("Failed to update budget","error")}},[p,_]);return{visibleEnvelopes:P,piggybanks:B,incomeSources:u,availableToBudget:H,currentMonth:c,allocations:d,transactions:e,isLoading:r,isInitialLoading:O,isOnline:i,showTimeoutMessage:w,getEnvelopeBalance:L,fetchData:t,reorderEnvelopes:K,deleteIncomeSource:de,clearMonthData:G,copyFromPreviousMonth:Q,setEnvelopeAllocation:$,localOrderRef:C,setLocalEnvelopes:j,localPiggybankOrderRef:z,setLocalPiggybanks:k}},Mte=({currentMonth:n,onMonthChange:e,budgetStatus:t})=>{const[r,i]=n.split("-").map(Number),o=["January","February","March","April","May","June","July","August","September","October","November","December"][i-1],c=()=>{let p=r,m=i-1;m<1&&(p=r-1,m=12);const b=`${p}-${m.toString().padStart(2,"0")}`;e(b)},u=()=>{let p=r,m=i+1;m>12&&(p=r+1,m=1);const b=`${p}-${m.toString().padStart(2,"0")}`;e(b)},d=()=>{const p=new Date,m=`${p.getFullYear()}-${(p.getMonth()+1).toString().padStart(2,"0")}`;e(m)},h=()=>{if(!t)return null;const{amount:p,totalIncome:m,totalAllocated:b}=t,_=typeof p=="number"?p:0,w=typeof m=="number"?m:0,S=typeof b=="number"?b:0,T=Math.abs(_)<.005,A=_<-.005,D=w>0?S/w*100:0;let O="text-gray-900 dark:text-white",M="bg-green-500",j="Left to Budget",C=w>0?Math.min(D,100):0,I=!0;return w===0?(j="Add income to start budgeting",C=0,I=!1,O="text-gray-500 dark:text-zinc-500"):T?(O="text-green-600 dark:text-emerald-400",M="bg-green-500",j="Perfect! Every dollar has a job ",C=100,I=!1):A&&(O="text-red-600 dark:text-red-400",M="bg-red-500",j="You're not in Congress! Try again.",C=100),v.jsxs("div",{className:"flex flex-col justify-center min-w-0 w-full",children:[v.jsxs("div",{className:"flex items-baseline justify-start mb-1",children:[v.jsx("span",{className:`text-xs font-medium truncate mr-1.5 ${O}`,children:j}),I&&v.jsxs("span",{className:`text-sm font-bold truncate ${O}`,children:[A?"-":"","$",Math.abs(_).toFixed(2)]})]}),v.jsx("div",{className:"w-full h-1.5 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:v.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${M}`,style:{width:`${C}%`}})})]})};return v.jsxs("div",{className:"py-2 space-y-3",children:[v.jsxs("div",{className:"flex items-center justify-center gap-4",children:[v.jsx("button",{onClick:c,className:"p-1.5 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Previous month",children:v.jsx(TL,{size:20})}),v.jsx("div",{className:"text-center",children:v.jsxs("button",{onClick:d,className:"text-base font-semibold text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors whitespace-nowrap",title:"Click to go to current month",children:[o," ",r]})}),v.jsx("button",{onClick:u,className:"p-1.5 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Next month",children:v.jsx(Cs,{size:20})})]}),t&&v.jsx("div",{className:"px-1",children:h()})]})},yy=({children:n,onDelete:e,threshold:t=-100,disabled:r=!1})=>{const i=sW(),[a,o]=U.useState(!1),c=U.useRef(0),u=()=>{r||(o(!0),c.current=Date.now())},d=async(h,p)=>{if(r)return;const m=p.offset.x,b=p.velocity.x;if(setTimeout(()=>o(!1),100),m<t||m<-50&&b<-500){const _=e();_===!1?i.start({x:0}):_ instanceof Promise&&_.then(w=>{w===!1&&i.start({x:0})})}else i.start({x:0})};return v.jsxs("div",{className:"relative w-full overflow-hidden mb-2 rounded-xl group",children:[v.jsx("div",{className:"absolute inset-0 bg-red-500 flex items-center justify-end pr-6 rounded-xl",children:v.jsx(A1,{className:"text-white w-6 h-6"})}),v.jsx(On.div,{drag:r?!1:"x",dragConstraints:{left:-500,right:0},dragElastic:.1,onDragStart:u,onDragEnd:d,animate:i,className:`relative bg-white dark:bg-zinc-900 rounded-xl ${a?"z-20":"z-10"}`,style:{touchAction:"pan-y",pointerEvents:a?"none":"auto"},children:n})]})},Pte=({isVisible:n,onClose:e,mode:t,initialIncomeSource:r})=>{const{addIncomeSource:i,updateIncomeSource:a,currentMonth:o}=Mn(),{showToast:c}=bl(),[u,d]=U.useState(""),[h,p]=U.useState(""),[m,b]=U.useState(!1);U.useEffect(()=>{if(!n)return;const w=window.setTimeout(()=>{t==="edit"&&r?(d(r.name),p(r.amount.toString())):(d(""),p(""))},0);return()=>window.clearTimeout(w)},[n,t,r]);const _=async w=>{if(w.preventDefault(),!u.trim()||!h||parseFloat(h)<=0){c("Please fill in all required fields with valid values","error");return}b(!0);try{if(t==="add")await i(o,{name:u.trim(),amount:parseFloat(h),month:o,userId:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),c("Income source added successfully","success");else{if(!r){c("Error: No income source to edit","error");return}await a(o,{...r,name:u.trim(),amount:parseFloat(h),updatedAt:new Date().toISOString()}),c(`Updated "${u.trim()}" income source`,"success")}e()}catch(S){console.error("Error saving income source:",S),c("Failed to save income source. Please try again.","error")}finally{b(!1)}};return v.jsx(ai,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(On.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black bg-opacity-50"}),v.jsxs(On.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:t==="add"?"Add Income Source":"Edit Income Source"}),v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",children:""})]}),v.jsxs("form",{onSubmit:_,className:"p-6 space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Income Source Name *"}),v.jsx("input",{type:"text",value:u,onChange:w=>d(w.target.value),placeholder:"e.g., Primary Job, Freelance, Investments",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Amount *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-zinc-400",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:h,onChange:w=>{const S=w.target.value.replace(/\D/g,"");if(!S){p("");return}const A=(parseInt(S,10)/100).toFixed(2);p(A)},placeholder:"0.00",className:"w-full pl-8 pr-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"submit",disabled:m||!u.trim()||!h||parseFloat(h)<=0,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m?"Saving...":t==="add"?"Add Income":"Save Changes"})]})]})]})]})})},Ote=({currentMonth:n,onCopy:e,isLoading:t=!1})=>{const r=c=>{const[u,d]=c.split("-");return new Date(parseInt(u),parseInt(d)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},i=c=>{const[u,d]=c.split("-").map(Number);let h=u,p=d-1;return p<1&&(h=u-1,p=12),r(`${h}-${p.toString().padStart(2,"0")}`)},a=r(n),o=i(n);return v.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6 py-12 space-y-6 animate-in fade-in zoom-in-95 duration-300",children:[v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-0 bg-blue-100 dark:bg-blue-900/30 blur-2xl rounded-full opacity-50"}),v.jsxs("div",{className:"relative bg-white dark:bg-zinc-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-700",children:[v.jsx(vL,{className:"w-12 h-12 text-blue-500"}),v.jsx("div",{className:"absolute -top-2 -right-2 bg-blue-500 text-white p-1.5 rounded-full border-2 border-white dark:border-zinc-900",children:v.jsx(Bh,{size:14})})]})]}),v.jsxs("div",{className:"max-w-xs mx-auto space-y-2",children:[v.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["It looks like you need a budget for ",a]}),v.jsxs("p",{className:"text-gray-500 dark:text-zinc-400",children:["We can copy your budget from ",o," to get you started right away."]})]}),v.jsx("div",{className:"w-full max-w-xs space-y-3 pt-2",children:v.jsx("button",{onClick:e,disabled:t,className:"w-full py-3.5 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-sm transition-all active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:t?"Creating...":v.jsx(v.Fragment,{children:v.jsxs("span",{children:["Create ",a," Budget"]})})})})]})},jte="/personal-budget-pwa/icon-512.png",x1="/personal-budget-pwa/images/budget-balanced.png",Vte=({currentMonth:n,onComplete:e})=>{const[t,r]=U.useState(0),[i,a]=U.useState(0),[o,c]=U.useState(2500);U.useEffect(()=>{if(console.log("Animation effect triggered:",{currentStep:t,animationKey:i}),t===3){console.log("Starting animation from $2500 to $0"),c(2500);const T=2e3,A=20,D=T/A,O=2500/A;let M=0;const j=setInterval(()=>{M++;const C=Math.max(0,2500-O*M);console.log("Phase 1 - Animation step:",M,"New amount:",C),c(C),M>=A&&(clearInterval(j),console.log("Phase 1 completed - Perfect budget reached"),setTimeout(()=>{console.log("Starting Phase 2 - Over budget demonstration");let I=0;const k=10,z=200,L=500/k,B=setInterval(()=>{I++;const P=-(L*I);console.log("Phase 2 - Over budget step:",I,"Over budget amount:",P),c(P),I>=k&&(clearInterval(B),console.log("Animation completed - Over budget scenario demonstrated"))},z)},1e3))},D);return()=>{console.log("Cleaning up animation timers"),clearInterval(j)}}},[i,t]);const d=(T=>{const[A,D]=T.split("-");return new Date(parseInt(A),parseInt(D)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})})(n),h=[{icon:Bh,title:"Welcome to Dollars At Work!",description:`Let's set up your budget for ${d}`,content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["Dollars At Work helps you take control of your money using the ",v.jsx("strong",{children:"zero-based budgeting"})," method."]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Every dollar gets a job, and you'll know exactly where your money is going."}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4",children:v.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-200 font-medium",children:" This quick guide will show you how to get started in just a few steps!"})})]}),color:"blue"},{icon:C2,title:"Step 1: Add Your Income",description:"Tell us how much money you have to work with",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"First, you'll add your income sources for the month. This could be:"}),v.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-zinc-400",children:[v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Is,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Salary"})," - Your regular paycheck"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Is,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Freelance"})," - Side gig income"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Is,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Other Income"})," - Any other money coming in"]})]})]}),v.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-green-900 dark:text-green-200",children:[v.jsx("strong",{children:'Look for the "Income Sources" section'})," at the top of your budget and tap the ",v.jsx(mh,{className:"w-4 h-4 inline"})," button to add income."]})})]}),color:"green"},{icon:wv,title:"Step 2: Create Spending Envelopes",description:"Organize your spending into categories",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Spending envelopes are categories for your expenses. Common examples:"}),v.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-zinc-400",children:[v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Is,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Groceries"})," - Food and household items"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Is,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Rent/Mortgage"})," - Housing costs"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Is,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Transportation"})," - Gas, car payment, transit"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Is,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Entertainment"})," - Fun money"]})]})]}),v.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-purple-900 dark:text-purple-200",children:[v.jsx("strong",{children:'Scroll down to "Spending Envelopes"'}),' and tap "Create New Envelope" to add your categories.']})})]}),color:"purple"},{icon:T0,title:"Step 3: Allocate Your Budget",description:"Assign money to each envelope",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Now comes the fun part - giving every dollar a job!"}),v.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500 rounded-r-xl p-4 relative",children:[v.jsx("button",{onClick:()=>a(T=>T+1),className:"absolute top-2 right-2 p-1.5 text-blue-600 dark:text-blue-400 hover:bg-blue-100 dark:hover:bg-blue-800 rounded-lg transition-colors",title:"Replay animation",children:v.jsx(u9,{className:"w-4 h-4"})}),v.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-200 font-medium mb-2",children:'The "Left to Budget" amount shows unassigned money'}),v.jsxs("p",{className:"text-sm text-blue-900 dark:text-blue-200 mb-3",children:["Your goal is to get this to ",v.jsx("strong",{children:"$0.00"})," by allocating all your income to envelopes."]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex justify-between text-xs text-blue-700 dark:text-blue-300 font-medium",children:[v.jsx("span",{children:"Left to Budget"}),v.jsxs("span",{className:`font-bold ${o<0?"text-red-600 dark:text-red-400":""}`,children:["$",o.toFixed(2)]})]}),v.jsx("div",{className:"w-full bg-blue-200 dark:bg-blue-800 rounded-full h-2 overflow-hidden",children:v.jsx(On.div,{className:`h-full rounded-full ${o<0?"bg-red-500":"bg-green-500"}`,initial:{width:"0%"},animate:{width:o<0?"100%":`${(2500-o)/2500*100}%`},transition:{duration:.3,ease:"easeInOut"}})}),v.jsxs(On.div,{className:`text-xs font-medium text-center mt-1 ${o===0?"text-green-600 dark:text-emerald-400":o<0?"text-red-600 dark:text-red-400":"text-blue-700 dark:text-blue-300"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:2,duration:.5},children:[o===0&&"Perfect! Every dollar has a job ",o<0&&"You're not in Congress! Try again.",o>0&&"Keep allocating until you reach $0"]})]},i)]}),v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:[v.jsx("strong",{children:"To allocate money:"})," Tap the budget amount on any envelope and enter how much you want to assign to it."]}),v.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-amber-900 dark:text-amber-200",children:[" ",v.jsx("strong",{children:"Pro tip:"})," Start with your essential expenses (rent, utilities, groceries) first, then allocate what's left to other categories."]})})]}),color:"blue"},{icon:_c,title:"Bonus: Piggybanks (Savings Goals)",description:"Save for future goals",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["Piggybanks are special envelopes for ",v.jsx("strong",{children:"savings goals"})," that carry over month-to-month."]}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(v9,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Set a Goal"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Vacation, emergency fund, new car - whatever you're saving for"})]})]}),v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(C2,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Monthly Contributions"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Set an automatic monthly amount to save"})]})]}),v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(T0,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Track Progress"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Watch your savings grow toward your goal"})]})]})]}),v.jsx("div",{className:"bg-pink-50 dark:bg-pink-900/20 border border-pink-200 dark:border-pink-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-pink-900 dark:text-pink-200",children:[v.jsx("strong",{children:"Find Piggybanks"})," at the bottom of your budget. They're optional but powerful for reaching your goals!"]})})]}),color:"pink"},{icon:x1,title:"You're Ready to Budget!",description:"Start taking control of your money",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"That's it! You now know the basics of Dollars At Work:"}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"1"})}),v.jsx("span",{children:"Add your income sources"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"2"})}),v.jsx("span",{children:"Create spending envelopes"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"3"})}),v.jsx("span",{children:"Allocate until Left to Budget = $0"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"4"})}),v.jsx("span",{children:"Track spending and adjust as needed"})]})]}),v.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4 mt-6",children:v.jsx("p",{className:"text-sm text-center text-blue-900 dark:text-blue-200 font-medium",children:' Click "Start Budgeting" below to create your first budget!'})})]}),color:"green",useCustomIcon:!0}],p=h[t],m=p.useCustomIcon?x1:p.icon,b=t===h.length-1,_=t===0,S={blue:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-600 dark:text-blue-400",button:"bg-blue-600 hover:bg-blue-700"},green:{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-600 dark:text-green-400",button:"bg-green-600 hover:bg-green-700"},purple:{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-600 dark:text-purple-400",button:"bg-purple-600 hover:bg-purple-700"},pink:{bg:"bg-pink-100 dark:bg-pink-900/30",text:"text-pink-600 dark:text-pink-400",button:"bg-pink-600 hover:bg-pink-700"}}[p.color];return v.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex items-center justify-center p-4",children:v.jsx("div",{className:"w-full max-w-2xl",children:v.jsx(ai,{mode:"wait",children:v.jsxs(On.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-xl border border-gray-200 dark:border-zinc-800 overflow-hidden",children:[v.jsx("div",{className:"p-6 pb-2",children:v.jsxs("div",{className:"flex items-center justify-between mb-4",children:[v.jsxs("div",{className:"flex-1",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:p.title}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:p.description})]}),v.jsx("div",{className:"flex flex-col items-center mx-4",children:t===0?v.jsx("img",{src:jte,alt:"Dollars At Work",className:`w-20 h-20 ${S.text}`}):p.useCustomIcon?v.jsx("img",{src:x1,alt:"Budget Balanced",className:`w-32 h-32 ${S.text}`}):v.jsx("div",{className:`${S.bg} p-3 rounded-xl`,children:v.jsx(m,{className:`w-8 h-8 ${S.text}`})})}),v.jsxs("div",{className:"text-sm text-gray-500 dark:text-zinc-400 whitespace-nowrap",children:["Step ",t+1," of ",h.length]})]})}),v.jsx("div",{className:"px-6 pb-6 pt-2",children:p.content}),v.jsx("div",{className:"px-6 pb-4 flex justify-center gap-2",children:h.map((T,A)=>v.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${A===t?`w-8 ${S.button}`:A<t?"w-2 bg-gray-400 dark:bg-zinc-600":"w-2 bg-gray-200 dark:bg-zinc-700"}`},A))}),v.jsxs("div",{className:"p-6 pt-0 flex gap-3",children:[!_&&v.jsxs("button",{onClick:()=>r(T=>T-1),className:"flex-1 py-3 px-4 border border-gray-300 dark:border-zinc-700 text-gray-700 dark:text-zinc-300 rounded-xl font-medium hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors flex items-center justify-center gap-2",children:[v.jsx(od,{className:"w-5 h-5"}),"Back"]}),v.jsx("button",{onClick:()=>{b?e():r(T=>T+1)},className:`${_?"flex-1":"flex-[2]"} py-3 px-4 ${S.button} text-white rounded-xl font-semibold transition-all active:scale-[0.98] flex items-center justify-center gap-2`,children:b?v.jsxs(v.Fragment,{children:[v.jsx(Bh,{className:"w-5 h-5"}),"Start Budgeting"]}):v.jsxs(v.Fragment,{children:["Next",v.jsx(gL,{className:"w-5 h-5"})]})})]})]},t)})})})},zte=({isOpen:n,onClose:e,onSave:t,existingPiggybank:r})=>{const[i,a]=U.useState(""),[o,c]=U.useState(""),[u,d]=U.useState(""),[h,p]=U.useState("#3B82F6"),[m,b]=U.useState("piggy-bank"),[_,w]=U.useState(!1),[S,T]=U.useState(!1);U.useEffect(()=>{r?(a(r.name),c(r.piggybankConfig?.targetAmount?.toString()||""),d(r.piggybankConfig?.monthlyContribution.toString()||"0"),p(r.piggybankConfig?.color||"#3B82F6"),b(r.piggybankConfig?.icon||"piggy-bank"),w(r.piggybankConfig?.paused||!1)):(a(""),c(""),d(""),p("#3B82F6"),b("piggy-bank"),w(!1))},[r,n]);const A=async O=>{if(O.preventDefault(),!(!i.trim()||!u)){T(!0);try{const M={name:i.trim(),isPiggybank:!0,piggybankConfig:{monthlyContribution:parseFloat(u),color:h,icon:m,paused:_}};o&&parseFloat(o)>0&&(M.piggybankConfig.targetAmount=parseFloat(o)),r&&(M.id=r.id,M.currentBalance=r.currentBalance,M.lastUpdated=new Date().toISOString(),M.isActive=r.isActive,M.orderIndex=r.orderIndex,M.userId=r.userId),await t(M),e()}catch(M){console.error("Error saving piggybank:",M),alert("Failed to save piggybank")}finally{T(!1)}}},D=[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#F59E0B",label:"Amber"},{value:"#EF4444",label:"Red"},{value:"#8B5CF6",label:"Purple"},{value:"#EC4899",label:"Pink"}];return v.jsx(ai,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(On.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),v.jsxs(On.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"sticky top-0 bg-white dark:bg-zinc-900 border-b border-gray-200 dark:border-zinc-800 px-6 py-4 flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center",children:v.jsx(_c,{size:20,className:"text-blue-600 dark:text-blue-400"})}),v.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:r?"Edit Piggybank":"New Piggybank"})]}),v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:v.jsx(Ev,{size:24})})]}),v.jsxs("form",{onSubmit:A,className:"p-6 space-y-5",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"piggybank-name",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Piggybank Name *"}),v.jsx("input",{type:"text",id:"piggybank-name",value:i,onChange:O=>a(O.target.value),placeholder:"e.g. Vacation Fund, Emergency Savings",className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:!0,autoFocus:!0})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"monthly-contribution",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Monthly Auto-Contribution *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",id:"monthly-contribution",value:u,onChange:O=>{const M=O.target.value.replace(/\D/g,"");if(!M){d("");return}const C=(parseInt(M,10)/100).toFixed(2);d(C)},placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:!0})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"This amount will be automatically added each month and deducted from Available to Budget"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Target Goal (Optional)"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",id:"target-amount",value:o,onChange:O=>{const M=O.target.value.replace(/\D/g,"");if(!M){c("");return}const C=(parseInt(M,10)/100).toFixed(2);c(C)},placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Set a savings goal to track progress"})]}),v.jsx("div",{className:"space-y-2",children:v.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[v.jsx("input",{type:"checkbox",checked:_,onChange:O=>w(O.target.checked),className:"w-5 h-5 rounded border-gray-300 dark:border-zinc-700 text-blue-600 focus:ring-2 focus:ring-blue-500"}),v.jsxs("div",{children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Pause auto-contributions"}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Monthly contributions will be skipped while paused"})]})]})}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:D.map(O=>v.jsx("button",{type:"button",onClick:()=>p(O.value),className:`w-full aspect-square rounded-lg transition-all ${h===O.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-zinc-900":"hover:scale-110"}`,style:{backgroundColor:O.value},title:O.label},O.value))})]}),v.jsxs("div",{className:"pt-4 flex gap-3",children:[v.jsx("button",{type:"button",onClick:e,className:"flex-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 font-semibold bg-white dark:bg-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",disabled:S,children:"Cancel"}),v.jsx("button",{type:"submit",disabled:!i.trim()||!u||S,className:`flex-1 py-3 px-4 rounded-xl font-semibold shadow-sm text-white transition-colors ${i.trim()&&u&&!S?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-300 dark:bg-zinc-600 cursor-not-allowed"}`,children:S?"Saving...":r?"Update":"Create"})]})]})]})]})})},Lte=({piggybank:n,balance:e,onNavigate:t,setMoveableRef:r,isReorderingActive:i,activelyDraggingId:a,onItemDragStart:o,onLongPressTrigger:c})=>{const u=Mn(oe=>oe.updatePiggybankContribution),d=Mn(oe=>oe.updateEnvelope),h=bl(oe=>oe.showToast),[p,m]=U.useState(!1),b=bV(oe=>{xV(),c(oe,n.id)},{threshold:500,cancelOnMovement:25,detect:fc.Touch}),_=oe=>{oe.stopPropagation(),m(!0)},w=async oe=>{try{const Ee={...n,...oe,id:n.id,userId:n.userId,currentBalance:n.currentBalance,lastUpdated:new Date().toISOString(),isActive:n.isActive,orderIndex:n.orderIndex};await d(Ee),h("Piggybank updated successfully","success"),m(!1)}catch(Ee){console.error("Failed to update piggybank:",Ee),h("Failed to update piggybank","error")}},S=n.piggybankConfig?.targetAmount,T=n.piggybankConfig?.monthlyContribution??0,A=n.piggybankConfig?.color||"#3B82F6",D=n.piggybankConfig?.paused||!1,O=typeof e=="number"?e:e.toNumber(),M=(oe,Ee=1)=>{const ke=oe.replace("#",""),Ke=parseInt(ke,16),Se=Ke>>16&255,Ne=Ke>>8&255,Be=Ke&255;return`rgba(${Se}, ${Ne}, ${Be}, ${Ee})`},j=`linear-gradient(135deg, ${M(A,.14)} 0%, ${M(A,.05)} 100%)`,C=M(A,.4),[I,k]=U.useState(!1),[z,L]=U.useState(T?T.toFixed(2):"0.00"),[B,P]=U.useState(!1),J=U.useRef(null),Y=U.useRef(null),[H,W]=U.useState(!1),K=S&&S>0?Math.min(O/S*100,100):0,de=S&&O>=S;U.useEffect(()=>{a&&a!==n.id&&W(!1)},[a,n.id]),U.useEffect(()=>{a===n.id&&(W(!0),o&&o(n.id))},[a,n.id,o]),U.useEffect(()=>{if(!a&&H){const oe=setTimeout(()=>{W(!1)},300);return()=>clearTimeout(oe)}},[a,H]),U.useEffect(()=>{I||L(T?T.toFixed(2):"0.00")},[T,I]),U.useEffect(()=>{I&&J.current&&(J.current.focus(),J.current.select())},[I]);const Q=oe=>{oe.stopPropagation(),("touches"in oe||oe.type.startsWith("touch"))&&oe.preventDefault(),!B&&(L(T?T.toFixed(2):"0.00"),k(!0))},G=()=>{k(!1),L(T?T.toFixed(2):"0.00")},$=async()=>{if(!I||B)return;const oe=parseFloat(z);if(Number.isNaN(oe)||oe<0){h("Enter a valid contribution amount","error");return}if(oe===T){k(!1);return}P(!0);try{await u(n.id,oe),h("Monthly contribution updated","success"),L(oe.toFixed(2)),k(!1)}catch(Ee){console.error("Failed to update piggybank contribution",Ee),h("Failed to update contribution","error")}finally{P(!1)}},ee=oe=>{oe.key==="Enter"?(oe.preventDefault(),$()):oe.key==="Escape"&&(oe.preventDefault(),G())},te=oe=>{if(H||i){oe.preventDefault(),oe.stopPropagation();return}if(I){oe.preventDefault(),oe.stopPropagation();return}t(n.id)},le=a===n.id,fe=v.jsxs("div",{className:"flex items-center gap-2 w-full",children:[v.jsx("div",{className:"hidden md:flex items-center justify-center p-1 text-gray-400 opacity-0 group-hover:opacity-100 cursor-grab active:cursor-grabbing transition-all duration-200",onMouseDown:oe=>c(oe,n.id),children:v.jsx(xN,{size:20})}),v.jsxs("div",{className:"flex-1",children:[v.jsxs("div",{className:"flex items-start justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{backgroundColor:`${A}20`},children:v.jsx(_c,{size:20,style:{color:A}})}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:n.name}),de&&v.jsx("span",{className:"text-xs text-green-600 dark:text-green-400 font-medium",children:" Goal Reached!"})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("div",{className:"text-right",children:[v.jsxs("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:["$",O.toFixed(2)]}),S&&v.jsxs("div",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["of $",S.toFixed(2)]})]}),v.jsx("button",{onClick:_,className:"p-1.5 rounded-lg text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-zinc-800 transition-colors",title:"Edit piggybank",children:v.jsx(bN,{size:16})})]})]}),S&&S>0&&v.jsxs("div",{className:"mb-3",children:[v.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-800 rounded-full h-2 overflow-hidden",children:v.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${K}%`,backgroundColor:A}})}),v.jsxs("div",{className:"flex justify-between items-center mt-1",children:[v.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:[K.toFixed(0),"% complete"]}),v.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["$",(S-O).toFixed(2)," to go"]}),v.jsx("span",{className:"ml-2 px-2 py-0.5 text-[11px] font-semibold rounded-full uppercase tracking-wide",style:{backgroundColor:M(A,.15),color:A},children:"Piggybank"})]})]}),v.jsx("div",{className:"mt-2",children:D?v.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-zinc-400",children:[v.jsx(a9,{size:14,className:"text-orange-500"}),v.jsx("span",{className:"text-orange-600 dark:text-orange-400",children:"Paused"})]}):v.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-zinc-400",children:[v.jsx(T0,{size:14,style:{color:A}}),I?v.jsxs("form",{onSubmit:oe=>{oe.preventDefault(),$()},className:"flex items-center gap-2",onClick:oe=>oe.stopPropagation(),children:[v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{ref:J,type:"number",min:"0",step:"0.01",value:z,onChange:oe=>L(oe.target.value),onBlur:$,onKeyDown:ee,disabled:B,autoFocus:!0,className:"w-28 pl-6 pr-3 py-1.5 rounded-lg border border-gray-300 dark:border-zinc-600 bg-white dark:bg-zinc-900 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),B&&v.jsx(JL,{size:16,className:"animate-spin text-gray-400"})]}):v.jsxs("div",{onClick:Q,onTouchEnd:Q,className:"font-medium text-gray-900 dark:text-white hover:underline cursor-pointer",children:["$",T.toFixed(2),"/month"]})]})})]})]});return v.jsxs(v.Fragment,{children:[v.jsx(zte,{isOpen:p,onClose:()=>m(!1),onSave:w,existingPiggybank:n}),v.jsx(On.div,{...b(),layout:!le,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},ref:oe=>{r&&r(oe),Y.current=oe},onClick:te,style:{background:j,borderColor:C,boxShadow:le?"0 18px 45px rgba(15,23,42,0.35)":"0 1px 2px rgba(15,23,42,0.08)",zIndex:le?50:1,scale:le?1.02:1},className:"rounded-xl p-4 border transition-all cursor-pointer shadow-sm hover:shadow-md select-none active:scale-[0.99] group",children:fe})]})},rh=(n,e=1)=>{const t=n.replace("#",""),r=parseInt(t,16),i=r>>16&255,a=r>>8&255,o=r&255;return`rgba(${i}, ${a}, ${o}, ${e})`},Wk=12,Qk=(n,e,t)=>Math.min(Math.max(n,e),t),Bte=({env:n,budgetedAmount:e,remainingBalance:t,editingEnvelopeId:r,setEditingEnvelopeId:i,editingAmount:a,setEditingAmount:o,handleBudgetSave:c,navigate:u,inputRef:d,transactions:h,currentMonth:p,setMoveableRef:m,isReorderingActive:b,activelyDraggingId:_,onItemDragStart:w,onLongPressTrigger:S})=>{const T=!!n.isPiggybank,A=n.piggybankConfig?.color||"#3B82F6",D=T?`linear-gradient(135deg, ${rh(A,.18)} 0%, ${rh(A,.08)} 100%)`:void 0,O=T?rh(A,.5):void 0,M=U.useRef(null),[j,C]=U.useState(!1),I=bV(K=>{xV(),S(K,n.id)},{threshold:500,cancelOnMovement:25,detect:fc.Touch}),k=h.filter(K=>K.envelopeId===n.id&&K.month===p),z=k.filter(K=>K.type==="Expense"),L=k.filter(K=>K.type==="Income"),B=z.reduce((K,de)=>K+(de.amount||0),0),P=L.reduce((K,de)=>K+(de.amount||0),0),J=Math.max(0,B/P*100),Y=K=>{if(j||b){K.preventDefault(),K.stopPropagation();return}if(r===n.id){K.preventDefault(),K.stopPropagation();return}const de=K.target;if(de.closest(".js-budget-target")||de.tagName==="INPUT"){K.preventDefault(),K.stopPropagation();return}u(`/envelope/${n.id}`)};U.useEffect(()=>{_&&_!==n.id&&C(!1)},[_,n.id]),U.useEffect(()=>{_===n.id&&(C(!0),w(n.id))},[_,n.id,w]),U.useEffect(()=>{if(!_&&j){const K=setTimeout(()=>{C(!1)},300);return()=>clearTimeout(K)}},[_,j]);const H=v.jsxs("div",{className:"flex items-center gap-2 w-full",children:[v.jsx("div",{className:"hidden md:flex items-center justify-center p-1 text-gray-400 opacity-0 group-hover:opacity-100 cursor-grab active:cursor-grabbing transition-all duration-200",onMouseDown:K=>S(K,n.id),children:v.jsx(xN,{size:20})}),v.jsxs("div",{className:"flex-1",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[T&&v.jsx("span",{className:"w-8 h-8 rounded-full flex items-center justify-center border",style:{borderColor:rh(A,.4),backgroundColor:rh(A,.15),color:A},children:v.jsx(_c,{size:16})}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:n.name}),T&&v.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:A},children:"Piggybank"})]})]}),v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("div",{className:"flex items-center gap-x-4",onPointerDown:K=>K.stopPropagation(),children:r===n.id?v.jsxs("div",{className:"flex items-center gap-x-1",children:[v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Budgeted:"}),v.jsx("form",{onSubmit:K=>{K.preventDefault(),c()},children:v.jsx("input",{ref:d,type:"number",value:a,onChange:K=>o(K.target.value),onBlur:c,className:"w-24 px-2 py-1 text-sm border rounded bg-white dark:bg-zinc-900 text-gray-900 dark:text-white",step:"0.01",autoFocus:!0})})]}):v.jsxs("div",{onTouchEnd:K=>{K.preventDefault(),K.stopPropagation(),i(n.id),o(e.toString())},onClick:()=>{i(n.id),o(e.toString())},className:"flex items-center gap-x-1 hover:bg-gray-200 dark:hover:bg-zinc-700 px-3 py-2 rounded transition-colors cursor-pointer js-budget-target",children:[v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Budgeted:"}),v.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:["$",e.toFixed(2)]})]})}),v.jsxs("div",{className:"text-right",children:[v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 block",children:"Remaining"}),v.jsxs("span",{className:`font-bold ${(typeof t=="number"?t:t.toNumber())<0||100-J<=5?"text-red-500":J>=80?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-emerald-400"}`,children:["$",(typeof t=="number"?t:t.toNumber()).toFixed(2)]})]})]}),e>0&&v.jsx("div",{className:"mt-3",onClick:K=>K.stopPropagation(),children:v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-zinc-400 mb-1",children:[v.jsx("span",{children:"Budget Used"}),v.jsxs("span",{children:[J.toFixed(0),"%"]})]}),v.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-700 rounded-full h-2 overflow-hidden",children:v.jsx("div",{className:`h-full transition-all duration-300 ease-out ${(typeof t=="number"?t:t.toNumber())<0||100-J<=5?"bg-red-500":J>=80?"bg-yellow-500":"bg-green-400"}`,style:{width:`${Math.max(100-J,2)}%`}})})]})})]})]}),W=_===n.id;return v.jsx(On.div,{...I(),layout:!W,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},"data-envelope-id":n.id,ref:K=>{m(n.id)(K),M.current=K},onClick:Y,style:{boxShadow:W?"0 18px 45px rgba(15,23,42,0.35)":"0 1px 2px rgba(15,23,42,0.08)",background:D,borderColor:O,cursor:W?"grabbing":"pointer",zIndex:W?50:1,scale:W?1.02:1},className:`p-4 rounded-xl active:scale-[0.99] transition-all select-none border group ${T?"bg-white/70 dark:bg-zinc-800/80":"bg-gray-50 dark:bg-zinc-800 border-transparent"}`,children:H})},Ute=()=>{const{visibleEnvelopes:n,piggybanks:e,incomeSources:t,availableToBudget:r,currentMonth:i,allocations:a,transactions:o,isLoading:c,isInitialLoading:u,showTimeoutMessage:d,getEnvelopeBalance:h,reorderEnvelopes:p,deleteIncomeSource:m,copyFromPreviousMonth:b,setEnvelopeAllocation:_,localOrderRef:w,setLocalEnvelopes:S,localPiggybankOrderRef:T,setLocalPiggybanks:A}=Nte(),{setMonth:D,setIsOnboardingActive:O,isOnboardingCompleted:M,completeOnboarding:j,isOnboardingActive:C}=Mn(),{showToast:I}=bl(),k=Ks(),[z,L]=U.useState(!1),[B,P]=U.useState("add"),[J,Y]=U.useState(null),[H,W]=U.useState(!1),[K,de]=U.useState(!1),[Q,G]=U.useState(C),$=U.useRef(null),ee=U.useRef(null),[te,le]=U.useState(0);U.useLayoutEffect(()=>{if(Q)return;const Pe=ee.current;if(!Pe)return;const ut=()=>le(Pe.getBoundingClientRect().height);ut();const qt=new ResizeObserver(()=>ut());return qt.observe(Pe),window.addEventListener("resize",ut),()=>{window.removeEventListener("resize",ut),qt.disconnect()}},[Q,i,t,a,n,e,r]),U.useEffect(()=>(O(Q),()=>O(!1)),[Q,O]);const[fe,oe]=U.useState(null),[Ee,ke]=U.useState(""),Ke=U.useRef(null);U.useEffect(()=>{if(!u&&!c){const Pe=setTimeout(()=>{if(Q)return;if(M){G(!1);const bt=(t[i]||[]).length===0&&(a[i]||[]).length===0,Rr=Object.keys(t).some(Gn=>(t[Gn]||[]).length>0)||Object.keys(a).some(Gn=>(a[Gn]||[]).length>0);de(!!(bt&&Rr));return}const ut=(t[i]||[]).length===0&&(a[i]||[]).length===0,qt=Object.keys(t).some(bt=>(t[bt]||[]).length>0)||Object.keys(a).some(bt=>(a[bt]||[]).length>0);ut?qt?(de(!0),G(!1)):(G(!0),de(!1)):(de(!1),G(!1))},500);return()=>clearTimeout(Pe)}},[u,c,i,t,a,M]),U.useEffect(()=>{fe&&Ke.current&&Ke.current.select()},[fe]);const Se=U.useCallback(Pe=>ut=>{ut?Be.current[Pe]=ut:delete Be.current[Pe]},[]),Ne=U.useCallback(Pe=>ut=>{ut?Ze.current[Pe]=ut:delete Ze.current[Pe]},[]),Be=U.useRef({}),Me=U.useRef({}),[He,we]=U.useState(null),Ve=U.useRef({activeId:null,startIndex:0,currentIndex:0,itemHeight:0}),Ze=U.useRef({}),Re=U.useRef({}),Oe=U.useRef(null),[ct,et]=U.useState(null),Ot=U.useRef({activeId:null,startIndex:0,currentIndex:0,itemHeight:0}),[rt,pt]=U.useState(!1),jt=U.useRef(null),Ft=U.useRef(!1);U.useEffect(()=>{pt(!1),Ft.current=!1,we(null),et(null)},[]);const jn=U.useRef(rt);U.useEffect(()=>{jn.current=rt},[rt]);const ui=U.useCallback(()=>pt(!0),[]),ls=U.useCallback(()=>{pt(!1),Ft.current=!1,w.current.length&&p(w.current)},[p]),Zi=U.useCallback(Pe=>{},[]),di=U.useCallback(Pe=>{jn.current||fe!==Pe&&k(`/envelope/${Pe}`)},[fe,k]),Ir=U.useCallback((Pe,ut)=>{const qt=Me.current[ut]||Re.current[ut];if(qt){Ft.current=!0;const bt=Pe.nativeEvent||Pe;qt.dragStart(bt)}},[]),Sn=U.useCallback(()=>pt(!0),[]),rr=U.useCallback(()=>{pt(!1),Ft.current=!1,T.current.length&&p(T.current)},[p]);U.useEffect(()=>{const Pe=()=>{Object.values(Re.current).forEach(bt=>bt?.destroy()),Re.current={}};if(Q){Pe();return}if(!e.length)return;const ut=()=>{e.forEach(bt=>{const Rr=Ze.current[bt.id];if(!Rr)return;const Gn=Re.current[bt.id];if(Gn){Gn.target=Rr;return}const ir=new Fk(Oe.current,{target:Rr,draggable:!0,throttleDrag:0,edgeDraggable:!1,startDragRotate:0,throttleDragRotate:0,rotatable:!1,scalable:!1,resizable:!1,warpable:!1,pinchable:!1,snappable:!0,snapThreshold:5,isDisplaySnapDigit:!1,isDisplayInnerSnapDigit:!1,snapGap:!0,snapDirections:{top:!0,bottom:!0,left:!1,right:!1},elementSnapDirections:{top:!0,bottom:!0,left:!1,right:!1},clickable:!0,preventClickDefault:!1,preventClickEventOnDrag:!0,checkInput:!0,dragArea:!1,hideDefaultLines:!0,hideChildMoveableDefaultLines:!0,renderDirections:[]});ir.on("dragStart",Dt=>{if(!Ft.current){Dt.stop();return}const kt=Dt.inputEvent.target;if(kt.closest(".js-budget-target")||kt.tagName==="INPUT"){I("Lock envelope order to edit budget","neutral"),Dt.stop();return}const fn=T.current.findIndex(zt=>zt.id===bt.id),Vt=Dt.target,Et=Vt.getBoundingClientRect().height+Wk;et(bt.id),Ot.current={activeId:bt.id,startIndex:fn,currentIndex:fn,itemHeight:Et},Vt&&(Vt.style.transition="none",Vt.style.boxShadow="0 18px 45px rgba(15,23,42,0.35)",Vt.style.zIndex="20"),Sn()});let ar=null;ir.on("drag",Dt=>{const kt=Dt.target;ar!==null&&cancelAnimationFrame(ar),ar=requestAnimationFrame(()=>{const fn=Ot.current;if(fn.activeId!==bt.id)return;const Vt=Dt.beforeTranslate[1];kt.style.transform=`translateY(${Vt}px)`,kt.style.transition="none";const{itemHeight:an,startIndex:Et}=fn;if(!an)return;const zt=Math.round(Vt/an),hn=Qk(Et+zt,0,T.current.length-1);hn!==fn.currentIndex&&(fn.currentIndex=hn,T.current.forEach((ln,Wt)=>{if(ln.id===bt.id)return;const pr=Ze.current[ln.id];if(!pr)return;let Dr=0;Et<hn?Wt>Et&&Wt<=hn&&(Dr=-an):Et>hn&&Wt>=hn&&Wt<Et&&(Dr=an),pr.style.transform=Dr?`translateY(${Dr}px)`:"",pr.style.transition="transform 0.2s ease"})),ar=null})}),ir.on("dragEnd",Dt=>{ar!==null&&(cancelAnimationFrame(ar),ar=null);const kt=Dt.target,fn=Ot.current,{startIndex:Vt,currentIndex:an}=fn;if(kt.style.transform="",kt.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease",kt.style.boxShadow="",T.current.forEach(Et=>{if(Et.id===bt.id)return;const zt=Ze.current[Et.id];zt&&(zt.style.transform="",zt.style.transition="")}),Vt!==an){const Et=[...T.current],[zt]=Et.splice(Vt,1);Et.splice(an,0,zt),T.current=Et,A(Et)}setTimeout(()=>{kt.style.zIndex="",kt.style.transition="",et(null)},300),Ot.current={activeId:null,startIndex:0,currentIndex:0,itemHeight:0},rr()}),ir.on("click",Dt=>{const kt=Dt.inputEvent.target;kt.closest(".js-budget-target")||kt.tagName==="INPUT"||kt.tagName==="BUTTON"||di(bt.id)}),Re.current[bt.id]=ir})},qt=window.setTimeout(ut,80);return()=>{clearTimeout(qt),Pe()}},[e,Sn,rr,di,Q]),U.useEffect(()=>{const Pe=()=>{Object.values(Me.current).forEach(bt=>bt?.destroy()),Me.current={}};if(Q){Pe();return}if(!n.length)return;const ut=()=>{n.forEach(bt=>{const Rr=Be.current[bt.id];if(!Rr)return;const Gn=Me.current[bt.id];if(Gn){Gn.target=Rr;return}const ir=new Fk(jt.current,{target:Rr,draggable:!0,throttleDrag:0,edgeDraggable:!1,startDragRotate:0,throttleDragRotate:0,rotatable:!1,scalable:!1,resizable:!1,warpable:!1,pinchable:!1,snappable:!0,snapThreshold:5,isDisplaySnapDigit:!1,isDisplayInnerSnapDigit:!1,snapGap:!0,snapDirections:{top:!0,bottom:!0,left:!1,right:!1},elementSnapDirections:{top:!0,bottom:!0,left:!1,right:!1},clickable:!0,preventClickDefault:!1,preventClickEventOnDrag:!0,checkInput:!0,dragArea:!1,hideDefaultLines:!0,hideChildMoveableDefaultLines:!0,renderDirections:[]});ir.on("dragStart",Dt=>{if(!Ft.current){Dt.stop();return}const kt=Dt.inputEvent.target;if(kt.closest(".js-budget-target")||kt.tagName==="INPUT"){Dt.stop();return}const fn=w.current.findIndex(zt=>zt.id===bt.id),Vt=Dt.target,Et=Vt.getBoundingClientRect().height+Wk;we(bt.id),Ve.current={activeId:bt.id,startIndex:fn,currentIndex:fn,itemHeight:Et},Vt&&(Vt.style.transition="none",Vt.style.boxShadow="0 18px 45px rgba(15,23,42,0.35)",Vt.style.zIndex="20"),ui()});let ar=null;ir.on("drag",Dt=>{const kt=Dt.target;ar!==null&&cancelAnimationFrame(ar),ar=requestAnimationFrame(()=>{const fn=Ve.current;if(fn.activeId!==bt.id)return;const Vt=Dt.beforeTranslate[1];kt.style.transform=`translateY(${Vt}px)`,kt.style.transition="none";const{itemHeight:an,startIndex:Et}=fn;if(!an)return;const zt=Math.round(Vt/an),hn=Qk(Et+zt,0,w.current.length-1);hn!==fn.currentIndex&&(fn.currentIndex=hn,w.current.forEach((ln,Wt)=>{if(ln.id===bt.id)return;const pr=Be.current[ln.id];if(!pr)return;let Dr=0;Et<hn?Wt>Et&&Wt<=hn&&(Dr=-an):Et>hn&&Wt>=hn&&Wt<Et&&(Dr=an),pr.style.transform=Dr?`translateY(${Dr}px)`:"",pr.style.transition="transform 0.2s ease"})),ar=null})}),ir.on("dragEnd",Dt=>{ar!==null&&(cancelAnimationFrame(ar),ar=null);const kt=Dt.target,fn=Ve.current,{startIndex:Vt,currentIndex:an}=fn;if(kt.style.transform="",kt.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease",kt.style.boxShadow="",w.current.forEach(Et=>{if(Et.id===bt.id)return;const zt=Be.current[Et.id];zt&&(zt.style.transform="",zt.style.transition="")}),Vt!==an){const Et=[...w.current],[zt]=Et.splice(Vt,1);Et.splice(an,0,zt),w.current=Et,S(Et)}setTimeout(()=>{kt.style.zIndex="",kt.style.transition="",we(null)},300),Ve.current={activeId:null,startIndex:0,currentIndex:0,itemHeight:0},ls()}),ir.on("click",()=>{const Dt=window.event?.target;Dt&&(Dt.closest(".js-budget-target")||Dt.tagName==="INPUT")||di(bt.id)}),Me.current[bt.id]=ir})},qt=window.setTimeout(ut,80);return()=>{clearTimeout(qt),Pe()}},[n,ui,ls,di,Q]);const cn=async()=>{if(fe)try{const Pe=parseFloat(Ee)||0;await _(fe,Pe)}catch(Pe){console.error("Failed to save budget amount:",Pe)}finally{oe(null),ke("")}},eo=()=>{P("add"),Y(null),L(!0)},_a=Pe=>{$.current&&clearTimeout($.current),!H&&(P("edit"),Y(Pe),L(!0))},wa=Pe=>{$.current&&clearTimeout($.current),W(!0),m(Pe),setTimeout(()=>W(!1),500)},yt=()=>{L(!1),Y(null)},un=async()=>{de(!1),await b(i)},dn=()=>{j(),G(!1)};return u?v.jsx(UO,{message:d?"Still loading... This is normal on slow connections":"Loading your budget...",showTimeout:d}):v.jsxs(v.Fragment,{children:[v.jsx("style",{dangerouslySetInnerHTML:{__html:`
        .moveable-control { display: none !important; }
        .moveable-origin { display: none !important; }
        .moveable-line { display: none !important; }
      `}}),v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-20",children:[!Q&&v.jsx("header",{ref:ee,className:"fixed top-0 left-0 right-0 z-50 bg-white dark:bg-zinc-900 border-b border-gray-100 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+4px)] pb-1",children:v.jsx(Mte,{currentMonth:i,onMonthChange:Pe=>{de(!1),D(Pe)},budgetStatus:{amount:r,totalIncome:(t[i]||[]).reduce((Pe,ut)=>Pe+ut.amount,0),totalAllocated:(a[i]||[]).filter(Pe=>n.some(ut=>ut.id===Pe.envelopeId)||e.some(ut=>ut.id===Pe.envelopeId)).reduce((Pe,ut)=>Pe+ut.budgetedAmount,0)}})}),v.jsxs("div",{className:"pb-[calc(8rem+env(safe-area-inset-bottom))] px-4 max-w-4xl mx-auto space-y-4",style:Q?void 0:{paddingTop:Math.max(0,te+16)},children:[Q?v.jsx(Vte,{currentMonth:i,onComplete:dn}):K?v.jsx(Ote,{currentMonth:i,onCopy:un}):v.jsxs(v.Fragment,{children:[v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Income Sources"}),v.jsx("button",{onClick:eo,className:"text-blue-600 dark:text-blue-300 hover:text-blue-700 dark:hover:text-blue-200 transition-colors",children:v.jsx(mh,{size:20})})]}),(t[i]||[]).length===0?v.jsx("div",{className:"text-center py-6",children:v.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-sm",children:"No income sources yet. Add your monthly income."})}):v.jsx("div",{className:"space-y-3",children:v.jsx(ai,{initial:!1,mode:"popLayout",children:(t[i]||[]).map(Pe=>v.jsx(On.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(yy,{onDelete:()=>wa(Pe),children:v.jsxs("div",{className:"flex justify-between items-center py-3 px-4 bg-gray-50 dark:bg-zinc-800 rounded-xl cursor-pointer",onClick:()=>_a(Pe),children:[v.jsxs("div",{className:"flex-1",children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:Pe.name}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Monthly income"})]}),v.jsxs("p",{className:"font-semibold text-green-600 dark:text-emerald-400",children:["$",Pe.amount.toFixed(2)]})]})})},Pe.id))})})]}),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Spending Envelopes"}),v.jsx("button",{onClick:()=>k("/add-envelope"),className:"text-blue-600 dark:text-blue-300 hover:text-blue-700 dark:hover:text-blue-200 transition-colors",title:"Create New Envelope",children:v.jsx(mh,{size:20})})]}),n.length===0?v.jsxs("div",{className:"text-center py-6",children:[v.jsx(wv,{className:"w-12 h-12 text-gray-300 dark:text-zinc-700 mx-auto mb-3"}),v.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-sm mb-4",children:n.length===0?"No envelopes added to this month. Copy from previous month or add new ones.":"No envelopes yet. Create one to get started."}),v.jsx("button",{onClick:()=>k("/add-envelope"),className:"text-blue-600 dark:text-blue-300 font-medium hover:text-blue-700 dark:hover:text-blue-200 transition-colors",children:"Create First Envelope"})]}):v.jsx("div",{ref:jt,children:v.jsx(ai,{initial:!1,children:v.jsx("div",{className:"space-y-3",children:n.map(Pe=>{const qt=(a[i]||[]).find(Rr=>Rr.envelopeId===Pe.id)?.budgetedAmount||0,bt=h(Pe.id);return v.jsx(Bte,{env:Pe,budgetedAmount:qt,remainingBalance:bt,editingEnvelopeId:fe,setEditingEnvelopeId:oe,editingAmount:Ee,setEditingAmount:ke,handleBudgetSave:cn,navigate:k,inputRef:Ke,transactions:o,currentMonth:i,setMoveableRef:Se,isReorderingActive:rt,activelyDraggingId:He,onItemDragStart:Zi,onLongPressTrigger:Ir},Pe.id)})})})})]}),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[v.jsx(_c,{size:20,className:"text-blue-600 dark:text-blue-400"}),"Piggybanks"]}),v.jsx("button",{onClick:()=>k("/add-envelope?type=piggybank"),className:"text-blue-600 dark:text-blue-300 hover:text-blue-700 dark:hover:text-blue-200 transition-colors",title:"Create New Piggybank",children:v.jsx(mh,{size:20})})]}),e.length>0?v.jsx("div",{ref:Oe,className:"relative",children:v.jsx(ai,{initial:!1,children:v.jsx("div",{className:"space-y-3",children:e.map(Pe=>v.jsx(Lte,{piggybank:Pe,balance:h(Pe.id),onNavigate:ut=>k(`/envelope/${ut}`),setMoveableRef:Ne(Pe.id),isReorderingActive:rt,activelyDraggingId:ct,onItemDragStart:()=>{},onLongPressTrigger:Ir},Pe.id))})})}):v.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-zinc-400",children:[v.jsx(_c,{size:48,className:"mx-auto mb-3 opacity-30"}),v.jsx("p",{className:"text-sm",children:"No piggybanks yet"}),v.jsx("p",{className:"text-xs mt-1",children:"Click the + button above to create your first piggybank"})]})]})]}),v.jsx(Pte,{isVisible:z,onClose:yt,mode:B,initialIncomeSource:J})]})]})]})},Fte=[],MV=({selectedCard:n,onCardSelect:e,initialCards:t=Fte,disabled:r=!1,isUserSelected:i=!1})=>{const a=Mn(L=>L.appSettings),o=Mn(L=>L.updateAppSettings),[c,u]=U.useState(t.length>0?t[0]:{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}),[d,h]=U.useState(!1),[p,m]=U.useState(!1),[b,_]=U.useState(t),[w,S]=U.useState(null),[T,A]=U.useState({name:"",network:"Visa",last4:"",color:"#3b82f6"});U.useEffect(()=>{a?.paymentSources&&(_(a.paymentSources),a.paymentSources.length>0&&!n&&u(a.paymentSources[0]))},[a,n]);const D=n||c;U.useEffect(()=>{!n&&e&&b.length>0&&e(b[0])},[n,e,b]);const O=L=>{r||(L.id==="add-new"?m(!0):(u(L),e?.(L),h(!1)))},M=()=>{r||h(!d)},j=L=>{r||S(L)},C=async()=>{if(w&&!r){const L=b.filter(B=>B.id!==w.id);if(_(L),D?.id===w.id){const B=L.length>0?L[0]:{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"};u(B),e?.(B)}S(null),h(!1);try{await o({paymentSources:L})}catch(B){console.error("Failed to delete card from app settings:",B),_(b),alert("Failed to delete card. Please try again.");return}}},I=()=>{S(null)},k=async()=>{if(r)return;if(T.last4.length!==4||!/^\d{4}$/.test(T.last4)){alert("Please enter exactly 4 digits for the last 4 digits");return}if(!T.name.trim()){alert("Please enter a card name");return}const L={id:`custom-${Date.now()}`,name:T.name.trim(),network:T.network,last4:T.last4,color:T.color},B=[...b,L];_(B),u(L),e?.(L),m(!1),h(!1);try{await o({paymentSources:B})}catch(P){console.error("Failed to save card to app settings:",P),_(b),u(D),alert("Failed to save card. Please try again.");return}A({name:"",network:"Visa",last4:"",color:"#3b82f6"})},z=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#6b7280","#0f4c81","#fdbb30","#7fb5b5","#232f3e","#e3e3e3"];return v.jsxs(v.Fragment,{children:[v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Payment Method",!i&&v.jsx("span",{className:"ml-2 text-xs text-blue-600 dark:text-blue-400 font-medium",children:"(Default selected)"})]}),v.jsxs("div",{onClick:M,className:`flex items-center gap-4 p-3 border rounded-lg transition-colors ${r?"cursor-not-allowed opacity-50 border-gray-300 dark:border-gray-600":"cursor-pointer hover:bg-gray-50 dark:hover:bg-zinc-800 border-gray-300 dark:border-gray-600"} ${i?"":"ring-2 ring-blue-200 dark:ring-blue-800"}`,children:[v.jsxs("div",{className:"w-[70px] h-[40px] rounded-lg flex flex-col justify-between p-[6px] shadow-lg text-white font-mono text-xs",style:{backgroundColor:D.color},children:[v.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:D.network}),v.jsxs("span",{className:"text-left text-[9px] leading-none",children:[" ",D.last4]})]}),v.jsxs("div",{className:"flex-1",children:[v.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:D.name}),v.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(...",D.last4,")"]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"text-gray-400",children:d?"":""}),!i&&v.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",title:"Default payment method - tap to change"})]})]}),d&&v.jsx("div",{className:"card-stack-dropdown",children:v.jsx("div",{className:"card-stack",children:v.jsx(ai,{initial:!1,mode:"popLayout",children:[...b,{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}].map((L,B)=>{const P=D.id===L.id,J=L.id==="add-new";return v.jsx(On.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(yy,{onDelete:()=>!J&&!r&&j(L),threshold:-80,children:v.jsxs("div",{className:`card-stack-item ${P?"selected":""} ${J?"add-new-card":""}`,onClick:()=>O(L),style:{backgroundColor:J?"#f3f4f6":L.color,color:J?"#374151":L.color==="#e3e3e3"?"#000":"#fff",zIndex:b.length-B},children:[v.jsxs("div",{className:"card-header",children:[v.jsx("span",{className:"card-network",children:J?"":L.network}),P&&!J&&v.jsx("span",{className:"selected-indicator",children:""})]}),v.jsxs("div",{className:"card-details",children:[v.jsx("div",{className:"card-name",children:L.name}),v.jsx("div",{className:"card-number",children:J?"":` ${L.last4}`})]}),J&&v.jsx("div",{className:"add-icon",children:v.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[v.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),v.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})})},L.id)})})})})]}),p&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-md mx-4",children:[v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Add New Card"}),v.jsx("button",{type:"button",onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:""})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Card Name"}),v.jsx("input",{type:"text",value:T.name,onChange:L=>A({...T,name:L.target.value}),placeholder:"e.g., My Chase Card",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Network"}),v.jsxs("select",{value:T.network,onChange:L=>A({...T,network:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[v.jsx("option",{value:"Visa",children:"Visa"}),v.jsx("option",{value:"Mastercard",children:"Mastercard"}),v.jsx("option",{value:"Amex",children:"Amex"})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Last 4 Digits"}),v.jsx("input",{type:"text",value:T.last4,onChange:L=>A({...T,last4:L.target.value.replace(/\D/g,"").slice(0,4)}),placeholder:"1234",maxLength:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Card Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:z.map(L=>v.jsx("button",{type:"button",onClick:()=>A({...T,color:L}),className:`w-full h-10 rounded-lg border-2 transition-all ${T.color===L?"border-blue-500 scale-110":"border-gray-300 dark:border-gray-600"}`,style:{backgroundColor:L}},L))})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Preview"}),v.jsxs("div",{className:"w-full h-20 rounded-lg flex flex-col justify-between p-3 shadow-lg text-white font-mono text-xs",style:{backgroundColor:T.color},children:[v.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:T.network}),v.jsxs("span",{className:"text-left text-[9px] leading-none",children:[" ",T.last4||"0000"]})]})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{type:"button",onClick:()=>m(!1),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"button",onClick:k,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors",children:"Add Card"})]})]})]})}),w&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-sm mx-4",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center mx-auto mb-4",children:v.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Delete Card"}),v.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Are you sure you want to delete ",v.jsx("span",{className:"font-medium",children:w.name}),"?"]}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{type:"button",onClick:I,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"button",onClick:C,className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md transition-colors",children:"Delete"})]})]})})})]})},PV=({isVisible:n,onClose:e,mode:t,currentEnvelope:r,initialTransaction:i})=>{const{addTransaction:a,updateTransaction:o,deleteTransaction:c,currentMonth:u}=Mn(),[d,h]=U.useState(""),[p,m]=U.useState(""),[b,_]=U.useState(""),[w,S]=U.useState(new Date().toISOString().split("T")[0]),[T,A]=U.useState(null);U.useEffect(()=>{if(n)if(t==="edit"&&i){h(i.amount.toString()),m(i.merchant||""),_(i.description),A(i.paymentMethod||null);try{const C=new Date(i.date);isNaN(C.getTime())?(console.warn("Invalid date in transaction:",i.date),S(new Date().toISOString().split("T")[0])):S(C.toISOString().split("T")[0])}catch(C){console.error("Error parsing transaction date:",C),S(new Date().toISOString().split("T")[0])}}else h(""),m(""),_(""),S(new Date().toISOString().split("T")[0])},[n,t,i]);const D=async C=>{C.preventDefault();const I=parseFloat(d);if(isNaN(I)||I<=0){console.log(" Invalid amount:",d);return}console.log(" Saving transaction:",{mode:t,amount:I,note:b,date:w,envelopeId:r.id,paymentMethod:T});try{const k=new Date(w),z=`${k.getFullYear()}-${(k.getMonth()+1).toString().padStart(2,"0")}`;if(z!==u){const L=`This transaction date (${z}) does not match the current budget month (${u}). Are you sure you want to save it?`;if(!window.confirm(L))return}t==="add"?(console.log(" Adding income transaction"),await a({amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),envelopeId:r.id,type:"Income",reconciled:!1,paymentMethod:T||void 0})):t==="spend"?(console.log(" Adding expense transaction"),await a({amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),envelopeId:r.id,type:"Expense",reconciled:!1,paymentMethod:T||void 0})):t==="edit"&&i&&(console.log(" Updating transaction"),await o({...i,amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),paymentMethod:T||void 0})),console.log(" Transaction saved successfully"),e()}catch(k){console.error(" Error saving transaction:",k),alert("Failed to save transaction: "+(k instanceof Error?k.message:"Unknown error"))}},O=()=>{!i||!i.id||window.confirm("Are you sure you want to delete this transaction?")&&(c(i.id),e())},M=t==="add"?"Add Money":t==="spend"?"Spend Money":"Edit Transaction",j=t==="add"?"text-green-500":"text-red-500";return v.jsx(ai,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(On.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),v.jsxs(On.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden relative z-10",children:[v.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),v.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:M}),v.jsx("button",{onClick:D,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!d||parseFloat(d)<=0||i?.isAutomatic,children:i?.isAutomatic?"":"Save"})]}),v.jsxs("form",{onSubmit:D,className:"p-6 space-y-6",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${j}`,children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:d,onChange:C=>{const I=C.target.value.replace(/\D/g,"");if(!I){h("");return}const z=(parseInt(I,10)/100).toFixed(2);h(z)},onKeyDown:C=>{(C.key==="e"||C.key==="E"||C.key==="+"||C.key==="-")&&C.preventDefault()},placeholder:"0.00",autoFocus:!0,disabled:i?.isAutomatic,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${j} placeholder-gray-700 ${i?.isAutomatic?"cursor-not-allowed opacity-80":""}`})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),v.jsx("input",{type:"text",value:p,onChange:C=>m(C.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none",disabled:i?.isAutomatic})]}),!i?.isAutomatic&&v.jsx(MV,{selectedCard:T,onCardSelect:A}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),v.jsx("input",{type:"text",value:b,onChange:C=>_(C.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none",disabled:i?.isAutomatic})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const C=new Date(w);return`${C.getFullYear()}-${(C.getMonth()+1).toString().padStart(2,"0")}`!==u?v.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[v.jsx(ed,{size:14}),v.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),v.jsx("input",{type:"date",value:w,onChange:C=>{console.log("Date changed to:",C.target.value),S(C.target.value)},required:!0,disabled:i?.isAutomatic,className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark] disabled:opacity-80"})]}),t==="edit"&&!i?.isAutomatic&&v.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-zinc-800",children:v.jsxs("button",{type:"button",onClick:O,className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-50 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-200 dark:border-zinc-800",children:[v.jsx(_N,{className:"w-5 h-5 mr-2"}),"Delete Transaction"]})})]})]})]})})},Gte=({isVisible:n,onClose:e,sourceEnvelope:t})=>{const{envelopes:r,transferFunds:i}=Mn(),[a,o]=U.useState(""),[c,u]=U.useState(""),[d,h]=U.useState(""),[p,m]=U.useState(new Date().toISOString().split("T")[0]),b=r.filter(S=>S.id!==t.id);U.useEffect(()=>{if(!n)return;const S=window.setTimeout(()=>{o(""),u(""),h(""),m(new Date().toISOString().split("T")[0])},0);return()=>window.clearTimeout(S)},[n]);const _=S=>{S.preventDefault();const T=parseFloat(c);isNaN(T)||T<=0||!a||(i(t.id,a,T,d,new Date(p)),e())},w=r.find(S=>S.id===a);return v.jsx(ai,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(On.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),v.jsxs(On.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden relative z-10",children:[v.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),v.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:"Transfer Money"}),v.jsx("button",{onClick:_,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!c||parseFloat(c)<=0||!a,children:"Transfer"})]}),v.jsxs("form",{onSubmit:_,className:"p-6 space-y-6",children:[v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"From"}),v.jsx("div",{className:"text-gray-900 dark:text-white font-medium",children:t.name})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"To"}),v.jsxs("select",{value:a,onChange:S=>o(S.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none cursor-pointer",children:[v.jsx("option",{value:"",className:"bg-white dark:bg-zinc-900",children:"Select envelope..."}),b.map(S=>v.jsx("option",{value:S.id,className:"bg-white dark:bg-zinc-900",children:S.name},S.id))]})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl text-blue-600 dark:text-blue-400",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:c,onChange:S=>{const T=S.target.value.replace(/\D/g,"");if(!T){u("");return}const D=(parseInt(T,10)/100).toFixed(2);u(D)},onKeyDown:S=>{(S.key==="e"||S.key==="E"||S.key==="+"||S.key==="-")&&S.preventDefault()},placeholder:"0.00",autoFocus:!0,className:"bg-transparent text-4xl font-bold text-center w-40 focus:outline-none text-blue-600 dark:text-blue-400 placeholder-gray-400 dark:placeholder-gray-600"})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note (Optional)"}),v.jsx("input",{type:"text",value:d,onChange:S=>h(S.target.value),placeholder:"What is this transfer for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Date"}),v.jsx("input",{type:"date",value:p,onChange:S=>m(S.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),w&&c&&parseFloat(c)>0&&v.jsxs("div",{className:"text-center text-sm text-gray-500 dark:text-zinc-400 pt-2 border-t border-gray-200 dark:border-zinc-800",children:["Moving ",v.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-bold",children:["$",parseFloat(c).toFixed(2)]})," from"," ",v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:t.name})," to"," ",v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:w.name})]})]})]})]})})},qte=n=>{if(!n)return"No Date";try{let e;return n&&typeof n=="object"&&n.toDate&&typeof n.toDate=="function"?e=n.toDate():typeof n=="number"?n<1e10?e=new Date((n+978307200)*1e3):e=new Date(n):e=new Date(n),isNaN(e.getTime())?"Invalid Date":new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(e)}catch(e){return console.error("Date error:",e),"Error"}},Hte=n=>{const e=typeof n=="string"?parseFloat(n):n;return typeof e!="number"||isNaN(e)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.abs(e))},OV=({transaction:n,envelopeName:e,onReconcile:t,onEdit:r})=>{if(!n)return null;console.log(" Transaction payment method:",n.paymentMethod);const i=n.type==="Income",a=n.type==="Expense";let o="text-gray-900 dark:text-white";return i&&(o="text-green-600 dark:text-green-400"),a&&(o="text-red-600 dark:text-red-400"),v.jsxs("div",{onClick:r,className:"flex items-center justify-between p-4 bg-white dark:bg-zinc-900 active:bg-gray-50 dark:active:bg-zinc-800 active:scale-[0.99] transition-all cursor-pointer group border-b border-gray-100 dark:border-zinc-800 last:border-0",children:[v.jsxs("div",{className:"flex flex-col gap-1 overflow-hidden",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"font-semibold text-gray-900 dark:text-white truncate",children:n.merchant||n.description||"No Description"}),n.reconciled&&v.jsx("span",{className:"text-[10px] bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 px-1.5 py-0.5 rounded-full font-bold uppercase tracking-wide",children:"R"})]}),n.merchant&&n.description&&n.description!==n.merchant&&v.jsx("div",{className:"text-xs text-gray-600 dark:text-zinc-400 truncate",children:n.description}),v.jsxs("div",{className:"text-xs text-gray-500 dark:text-zinc-500 flex items-center gap-1 flex-wrap",children:[v.jsx("span",{children:qte(n.date)}),e&&v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""}),v.jsx("span",{className:"text-blue-500 dark:text-blue-400 truncate max-w-[150px]",children:e})]}),n.paymentMethod&&v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""}),v.jsxs("span",{className:"flex items-center gap-1",children:[v.jsx("span",{className:"w-[12px] h-[8px] rounded-[2px] flex-shrink-0",style:{backgroundColor:n.paymentMethod.color}}),v.jsx("span",{className:"truncate max-w-[80px]",children:n.paymentMethod.name})]})]})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("div",{className:`font-bold font-mono whitespace-nowrap ${o}`,children:[a?"-":i?"+":"",Hte(n.amount)]}),t?v.jsx("button",{type:"button",onClick:c=>{c.stopPropagation(),t()},className:"p-1.5 rounded-full border border-transparent hover:border-green-200 dark:hover:border-green-500 transition-colors","aria-label":n.reconciled?"Mark as unreconciled":"Mark as reconciled",children:n.reconciled?v.jsx(Is,{className:"text-green-500",size:20}):v.jsx(A2,{className:"text-gray-400",size:20})}):v.jsx("span",{children:n.reconciled?v.jsx(Is,{className:"text-green-500",size:20}):v.jsx(A2,{className:"text-gray-400",size:20})})]})]})},$te=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n),Yte=()=>{const{id:n}=cz(),{envelopes:e,transactions:t,fetchData:r,isLoading:i,deleteEnvelope:a,renameEnvelope:o,updateTransaction:c,deleteTransaction:u,restoreTransaction:d,getEnvelopeBalance:h,currentMonth:p}=Mn(),{showToast:m}=bl(),b=Ks(),_=xa(),[w,S]=U.useState(!1),[T,A]=U.useState(!1),[D,O]=U.useState(!1),[M,j]=U.useState(null);U.useEffect(()=>{e.length===0&&r()},[]);const C=e.find(B=>B.id===n);if(!C)return i?v.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:v.jsx("p",{children:"Loading envelope..."})}):v.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:v.jsx("p",{children:"Envelope not found."})});if(C.isPiggybank){const B=t.filter(P=>P.envelopeId===C.id);console.log(" Piggybank:",C.name),console.log(" Created at:",C.createdAt),console.log(" Transactions:",B.map(P=>({date:P.date,description:P.description,amount:P.amount})))}const I=t.filter(B=>B.envelopeId===C.id).filter(B=>{if(C.isPiggybank){if((B.description==="Monthly Allocation"||B.description==="Piggybank Contribution")&&B.isAutomatic||!C.createdAt)return!0;const P=mv(C.createdAt).toISOString().split("T")[0];return mv(B.date).toISOString().split("T")[0]>=P}return B.month===p||!B.month}).sort((B,P)=>new Date(P.date).getTime()-new Date(B.date).getTime()),k=()=>{_.state?.fromGlobalFAB?b("/"):b(-1)},z=()=>{n&&(a(n),b(-1))},L=B=>{const P={...B,reconciled:!B.reconciled};c(P)};return v.jsxs("div",{className:"min-h-screen bg-white dark:bg-black text-gray-900 dark:text-white p-4 pb-[calc(8rem+env(safe-area-inset-bottom))] max-w-4xl mx-auto",children:[v.jsxs("header",{className:"flex justify-between items-center pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 bg-white dark:bg-black z-10 border-b border-gray-100 dark:border-zinc-800",children:[v.jsx("button",{onClick:()=>{const B=prompt("Rename envelope:",C.name);B&&B.trim()&&n&&o(n,B)},className:"text-blue-600 dark:text-blue-400 font-medium",children:"Rename"}),v.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:C.name}),v.jsx("button",{onClick:k,className:"text-blue-600 dark:text-blue-400 font-bold",children:"Done"})]}),v.jsx("section",{className:"mt-4 bg-white dark:bg-zinc-900 rounded-lg p-4 shadow-lg mb-4 border border-gray-100 dark:border-zinc-800",children:v.jsxs("div",{className:"flex justify-between items-center mb-2",children:[v.jsx("span",{className:"text-lg font-headline text-gray-900 dark:text-white",children:"Current Balance"}),(()=>{const B=C.isPiggybank?h(C.id):h(C.id,p);return console.log(`Debug: Envelope ${C.name} Balance:`,B),v.jsx("span",{className:`text-xl font-bold ${B<0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:$te(B)})})()]})}),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg mb-4 divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:[v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-green-600 dark:text-green-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>S(!0),children:[v.jsx(DL,{className:"w-5 h-5 mr-3"}),"Add Money"]}),v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>A(!0),children:[v.jsx(IL,{className:"w-5 h-5 mr-3"}),"Spend Money"]}),v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>O(!0),children:[v.jsx(hL,{className:"w-5 h-5 mr-3"}),"Transfer Money"]})]}),v.jsxs("section",{className:"mt-6",children:[v.jsx("h2",{className:"text-sm font-semibold uppercase text-gray-500 dark:text-zinc-400 mb-2 px-2",children:"Transaction History"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:I.length===0?v.jsx("p",{className:"p-4 text-center text-gray-500 dark:text-zinc-400",children:"No transactions yet for this envelope."}):v.jsx(ai,{initial:!1,mode:"popLayout",children:I.map(B=>v.jsx(On.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(yy,{disabled:B.isAutomatic,onDelete:()=>{if(!B.id)return;const P={...B};u(B.id),m("Transaction deleted","neutral",()=>d(P))},children:v.jsx(OV,{transaction:B,onReconcile:()=>L(B),onEdit:()=>{B.isAutomatic||j(B)}})})},B.id))})})]}),v.jsx("div",{className:"mt-8",children:v.jsxs("button",{className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-100 dark:border-zinc-800",onClick:()=>{const B=C.isPiggybank?`Are you sure you want to delete "${C.name}"? This will delete the piggybank and all its history.`:`Are you sure you want to remove "${C.name}" from ${p}? This will delete all transactions for this month only.`;confirm(B)&&z()},children:[v.jsx(_N,{className:"w-5 h-5 mr-2"}),"Delete Envelope"]})}),v.jsx(PV,{isVisible:w||T||!!M,onClose:()=>{S(!1),A(!1),j(null)},mode:w?"add":T?"spend":"edit",currentEnvelope:C,initialTransaction:M}),v.jsx(Gte,{isVisible:D,onClose:()=>O(!1),sourceEnvelope:C})]})},Kte=({isVisible:n,onClose:e,onConfirm:t,currentMonth:r,incomeCount:i,totalIncome:a,allocationCount:o,totalAllocated:c,transactionCount:u,totalTransactionAmount:d,isLoading:h=!1})=>{const[p,m]=U.useState(""),[b,_]=U.useState("confirm"),w=A=>{const[D,O]=A.split("-");return new Date(parseInt(D),parseInt(O)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},S=()=>{b==="confirm"?_("type"):b==="type"&&p==="START FRESH"&&t()},T=()=>{_("confirm"),m(""),e()};return v.jsx(ai,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(On.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:T,className:"absolute inset-0 bg-black bg-opacity-50"}),v.jsxs(On.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[v.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Start Fresh for ",w(r)]}),v.jsx("button",{onClick:T,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",disabled:h,children:""})]}),v.jsx("div",{className:"p-6 space-y-4",children:b==="confirm"?v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),v.jsxs("div",{className:"ml-3",children:[v.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"This action will permanently delete:"}),v.jsx("div",{className:"mt-2 text-sm text-red-700 dark:text-red-300",children:v.jsxs("ul",{className:"space-y-1",children:[v.jsxs("li",{children:[" ",i," income source",i!==1?"s":""," (totaling $",a.toFixed(2),"/month)"]}),v.jsxs("li",{children:[" ",o," envelope allocation",o!==1?"s":""," (totaling $",c.toFixed(2),")"]}),v.jsxs("li",{children:[" ",u," transaction",u!==1?"s":""," (totaling $",d.toFixed(2),")"]})]})})]})]})}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),v.jsx("div",{className:"ml-3",children:v.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[v.jsx("strong",{children:"All other months will remain completely unchanged."})," This only affects the current month's budget data, income sources, allocations, and all transactions."]})})]})}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"You can undo this action within 30 seconds if you change your mind."})]}):v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"text-center",children:[v.jsxs("p",{className:"text-sm text-gray-900 dark:text-white mb-4",children:["Type ",v.jsx("strong",{children:"START FRESH"})," to confirm:"]}),v.jsx("input",{type:"text",value:p,onChange:A=>m(A.target.value),placeholder:"START FRESH",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent dark:bg-zinc-800 dark:text-white text-center font-mono text-lg",autoFocus:!0})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500 text-center",children:"This action cannot be undone after 30 seconds"})]})}),v.jsxs("div",{className:"flex gap-3 p-6 border-t border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{type:"button",onClick:T,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",disabled:h,children:"Cancel"}),v.jsx("button",{type:"button",onClick:S,disabled:h||b==="type"&&p!=="START FRESH",className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:h?"Clearing...":b==="confirm"?"Continue":"Start Fresh"})]})]})]})})},Xte=()=>{const n=Ks(),e=U.useRef(null),{envelopes:t,transactions:r,resetData:i,importData:a,getEnvelopeBalance:o,appSettings:c,updateAppSettings:u,initializeAppSettings:d,incomeSources:h,allocations:p,currentMonth:m,clearMonthData:b,handleUserLogout:_,resetOnboarding:w}=Mn(),{deleteAccount:S,currentUser:T,logout:A}=fa(),[D,O]=U.useState(null),[M,j]=U.useState(()=>localStorage.getItem("lastBackupDate")||"Never"),[C,I]=U.useState(!1),[k,z]=U.useState(""),[L,B]=U.useState(!1),[P,J]=U.useState(!1),[Y,H]=U.useState(null),[W,K]=U.useState(!1),[de,Q]=U.useState(!1),G=978307200,$=c?.theme??"system";U.useEffect(()=>{c||d().catch(we=>{console.error("Failed to initialize app settings:",we)})},[d,c]);const ee=(we,Ve)=>{O({type:we,text:Ve}),setTimeout(()=>O(null),3500)},te=U.useMemo(()=>{const we=t.length,Ve=r.length,Ze=m?p[m]||[]:[],Re=Object.values(h).reduce((pt,jt)=>pt+jt.length,0),Oe=Ze.length,ct=t.reduce((pt,jt)=>{const Ft=o(jt.id);return pt+(typeof Ft=="number"?Ft:0)},0),et=0,Ot=r.reduce((pt,jt)=>{let Ft=0;if(typeof jt.date=="string"){const jn=Date.parse(jt.date);Ft=Number.isNaN(jn)?0:jn}else typeof jt.date=="number"&&(Ft=jt.date<2e9?(jt.date+G)*1e3:jt.date);return Math.max(pt,Ft)},0),rt=et||Ot?new Date(Math.max(et,Ot)).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"Never";return{envelopeCount:we,transactionCount:Ve,incomeSourceCount:Re,allocationCount:Oe,totalBalance:ct,lastUpdated:rt}},[t,r,h,p,m]),le=()=>{try{console.log(" Creating backup...");const we={appVersion:"1.5.12",backupDate:Date.now(),appSettings:c||{theme:"system"},envelopes:t.map(ct=>({...ct,currentBalance:(()=>{const et=o(ct.id);return typeof et=="number"?et:0})(),lastUpdated:new Date().toISOString()})),transactions:r,allocations:p,incomeSources:h},Ve=new Blob([JSON.stringify(we,null,2)],{type:"application/json"}),Ze=URL.createObjectURL(Ve),Re=document.createElement("a");Re.href=Ze,Re.download=`HouseBudget_Backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(Re),Re.click(),document.body.removeChild(Re),URL.revokeObjectURL(Ze);const Oe=new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});localStorage.setItem("lastBackupDate",Oe),j(Oe),H({success:!0,message:"Backup downloaded successfully."})}catch(we){console.error(we),H({success:!1,message:"Failed to create backup file.",onRetry:le})}},fe=()=>{J(!0),H(null);try{const we=["Date","Merchant","Payment Method","Notes","Amount","Type","Envelope","Reconciled"],Ve=r.map(et=>{const Ot=t.find(ui=>ui.id===et.envelopeId)?.name||"Unknown",rt=(et.merchant||"").replace(/"/g,'""'),pt=(et.description||"").replace(/"/g,'""');let jt="";et.paymentMethod&&(jt=`${et.paymentMethod.name} (...${et.paymentMethod.last4})`);const Ft=jt.replace(/"/g,'""');let jn="Invalid Date";if(et.date){if(typeof et.date=="string")jn=et.date.split("T")[0];else if(typeof et.date=="number"){const ui=et.date<2e9?(et.date+G)*1e3:et.date;jn=new Date(ui).toISOString().split("T")[0]}}return[jn,`"${rt}"`,`"${Ft}"`,`"${pt}"`,et.amount.toFixed(2),et.type,`"${Ot}"`,et.reconciled?"Yes":"No"].join(",")}),Ze=[we.join(","),...Ve].join(`
`),Re=new Blob([Ze],{type:"text/csv;charset=utf-8;"}),Oe=URL.createObjectURL(Re),ct=document.createElement("a");ct.href=Oe,ct.download=`HouseBudget_Transactions_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(ct),ct.click(),document.body.removeChild(ct),URL.revokeObjectURL(Oe),H({success:!0,message:"Transactions CSV exported successfully."})}catch(we){console.error(we),H({success:!1,message:"Failed to export CSV. Please try again.",onRetry:fe})}finally{J(!1)}},oe=()=>{e.current?.click()},Ee=we=>{const Ve=we.target.files?.[0];if(!Ve)return;const Ze=new FileReader;Ze.onload=async Re=>{try{const Oe=JSON.parse(Re.target?.result),ct=await a(Oe);if(!ct.success){ee("error",ct.message);return}if(Oe.appSettings?.theme)try{await u({theme:Oe.appSettings.theme})}catch(et){console.error("Failed to update imported settings:",et)}ee("success",`Loaded ${Oe.envelopes?.length??0} envelopes, ${Oe.transactions?.length??0} transactions.`)}catch(Oe){console.error(Oe),ee("error","Invalid backup file. Please verify the JSON.")}},Ze.readAsText(Ve),we.target.value=""},ke=async()=>{if(window.confirm("Are you sure? This will permanently delete all envelopes, transactions, budget allocations, income sources, and settings from the cloud. This action cannot be undone."))try{await i(),ee("success","All data has been permanently deleted."),n("/")}catch(we){console.error("Reset failed:",we),ee("error","Failed to delete all data. Some data may remain.")}},Ke=async()=>{if(!k.trim()){ee("error","Please enter your password to confirm account deletion.");return}I(!0);try{await i(),await S(k)?ee("success","Your account has been permanently deleted."):ee("error","Failed to delete account. Please try again.")}catch(we){console.error("Account deletion failed:",we),ee("error","Failed to delete account. Please try again.")}finally{I(!1),B(!1),z("")}},Se=async()=>{if(!T){ee("error","You must be logged in to clean up data.");return}K(!0);try{const we=await BS.cleanupOrphanedData(T.id),Ve=we.orphanedAllocationsDeleted+we.orphanedTransactionsDeleted;Ve>0?ee("success",`Cleaned ${Ve} orphaned items: ${we.orphanedAllocationsDeleted} allocations and ${we.orphanedTransactionsDeleted} transactions.`):ee("success","No orphaned data found. Your database is already clean!")}catch(we){console.error("Cleanup failed:",we),ee("error","Failed to clean up orphaned data. Please try again.")}finally{K(!1)}},Ne=()=>{Q(!0)},Be=async()=>{Q(!1),await b(m),ee("success","Month data has been reset.")},Me=async()=>{if(window.confirm("Are you sure you want to log out? This will clear all your data from the app until you log back in."))try{_(),A(),n("/")}catch(we){console.error("Logout failed:",we)}},He=T?.displayName?.charAt(0)?.toUpperCase()||T?.email?.charAt(0)?.toUpperCase()||"U";return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black transition-colors duration-200",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-center shadow-sm relative",children:[v.jsx("button",{onClick:()=>n(-1),className:"absolute left-4 text-blue-600 dark:text-blue-400 font-medium",children:"Done"}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Settings"})]}),v.jsxs("div",{className:"p-4 space-y-6 max-w-4xl mx-auto pb-[calc(8rem+env(safe-area-inset-bottom))]",children:[D&&v.jsxs("div",{className:`px-4 py-3 rounded-2xl text-sm font-medium flex items-center gap-2 ${D.type==="success"?"bg-green-50 text-green-700 dark:bg-emerald-900/30 dark:text-emerald-200":"bg-red-50 text-red-700 dark:bg-red-900/30 dark:text-red-200"}`,children:[D.type==="success"?v.jsx(S1,{size:18}):v.jsx(A1,{size:18}),D.text]}),v.jsx("section",{children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4 flex items-center gap-4",children:[v.jsx("div",{className:"w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center text-white text-2xl font-semibold shadow-md",children:He}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white truncate",children:T?.displayName||T?.email?.split("@")[0]||"User"}),v.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400 truncate",children:T?.email}),v.jsxs("button",{onClick:Me,className:"mt-2 text-sm text-red-600 dark:text-red-400 font-medium flex items-center gap-1 hover:underline",children:[v.jsx(n9,{size:14})," Log Out"]})]})]})}),v.jsx("section",{children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-5 space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(I2,{className:"text-blue-500",size:22}),v.jsxs("div",{children:[v.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Backup & Restore"}),v.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Create backups of all your data including envelopes, transactions, budget allocations, income sources, and settings."})]})]}),v.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 pt-2",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Envelopes"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:te.envelopeCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Transactions"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:te.transactionCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Income Sources"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:te.incomeSourceCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Allocations"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:te.allocationCount})]})]})]})}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Appearance"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4",children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[$==="light"&&v.jsx("span",{className:"text-orange-500 text-lg",children:""}),$==="dark"&&v.jsx("span",{className:"text-purple-500 text-lg",children:""}),$==="system"&&v.jsx("span",{className:"text-gray-500 text-lg",children:""}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Theme"})]}),v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 capitalize",children:$})]}),v.jsx("div",{className:"flex gap-2",children:[{label:"Light",value:"light"},{label:"Dark",value:"dark"},{label:"System",value:"system"}].map(we=>v.jsx("button",{onClick:async()=>{try{await u({theme:we.value})}catch(Ve){console.error("Failed to update theme setting:",Ve)}},className:`flex-1 py-2 rounded-lg text-sm font-medium border transition-colors ${$===we.value?"bg-blue-50 dark:bg-blue-900/30 border-blue-500 text-blue-700 dark:text-blue-200":"border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 hover:border-gray-300 dark:hover:border-zinc-600"}`,children:we.label},we.value))})]})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Help & Guide"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:v.jsxs("button",{onClick:()=>{w(),n("/")},className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Bh,{className:"text-purple-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Restart Onboarding Guide"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"View the welcome tutorial again"})]})]}),v.jsx(Cs,{className:"text-gray-400",size:18})]})})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Actions"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:[v.jsxs("button",{onClick:le,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(I2,{className:"text-blue-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Create Backup"}),v.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["Last backup: ",M]})]})]}),v.jsx(Cs,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:oe,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(T9,{className:"text-blue-500",size:20}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Restore from Backup"})]}),v.jsx(Cs,{className:"text-gray-400",size:18})]}),v.jsx("div",{className:"p-4",children:v.jsxs("button",{onClick:fe,disabled:P,className:"w-full flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors disabled:opacity-60 disabled:cursor-not-allowed rounded-xl border border-gray-100 dark:border-zinc-800 px-4 py-3 bg-white dark:bg-zinc-900",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[P?v.jsx(R2,{className:"text-blue-500 animate-spin",size:20}):v.jsx(FL,{className:"text-blue-500",size:20}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:P?"Preparing CSV":"Export Transactions (CSV)"})]}),v.jsx(Cs,{className:"text-gray-400",size:18})]})}),v.jsx("input",{type:"file",ref:e,onChange:Ee,accept:".json",className:"hidden"})]})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Danger Zone"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm",children:[v.jsxs("button",{onClick:Ne,className:"w-full p-4 flex items-center justify-between hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Lh,{className:"text-orange-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Start Fresh (This Month)"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Clear all allocations and data for the current month only"})]})]}),v.jsx(Cs,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:Se,disabled:W,className:"w-full p-4 flex items-center justify-between hover:bg-yellow-50 dark:hover:bg-yellow-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800 disabled:opacity-60 disabled:cursor-not-allowed",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[W?v.jsx(R2,{className:"text-yellow-500 animate-spin",size:20}):v.jsx(Bh,{className:"text-yellow-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:W?"Cleaning Data...":"Purge Orphaned Data"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Remove allocations and transactions pointing to deleted envelopes"})]})]}),v.jsx(Cs,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:ke,className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(A1,{className:"text-red-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Reset All Data"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Permanently delete everything"})]})]}),v.jsx(Cs,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:()=>B(!0),className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(ed,{className:"text-red-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Delete Account"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Permanently delete your account and all data"})]})]}),v.jsx(Cs,{className:"text-gray-400",size:18})]})]})]}),v.jsxs("div",{className:"text-center py-4",children:[v.jsxs("p",{className:"text-xs text-gray-400 dark:text-zinc-500",children:["Version ","1.5.12"," (PWA)"]}),"        "]}),Y&&v.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 max-w-sm w-full",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[Y.success?v.jsx(S1,{className:"text-green-500",size:24}):v.jsx(ed,{className:"text-red-500",size:24}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:Y.success?"Success":"Error"})]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-300 mb-4",children:Y.message}),v.jsxs("div",{className:"flex gap-2",children:[Y.onRetry&&v.jsx("button",{onClick:()=>{H(null),Y.onRetry?.()},className:"flex-1 py-2 px-4 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors",children:"Retry"}),v.jsx("button",{onClick:()=>H(null),className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-zinc-700 text-gray-900 dark:text-white rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-zinc-600 transition-colors",children:"Close"})]})]})}),v.jsx(Kte,{isVisible:de,onClose:()=>Q(!1),onConfirm:Be,currentMonth:m,incomeCount:(h[m]||[]).length,totalIncome:(h[m]||[]).reduce((we,Ve)=>we+Ve.amount,0),allocationCount:(p[m]||[]).filter(we=>t.some(Ve=>Ve.id===we.envelopeId)).length,totalAllocated:(p[m]||[]).filter(we=>t.some(Ve=>Ve.id===we.envelopeId)).reduce((we,Ve)=>we+Ve.budgetedAmount,0),transactionCount:r.filter(we=>we.month===m).length,totalTransactionAmount:r.filter(we=>we.month===m).reduce((we,Ve)=>we+Ve.amount,0)}),L&&v.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 max-w-sm w-full",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[v.jsx(ed,{className:"text-red-500",size:24}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Account"})]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-300 mb-4",children:"This action cannot be undone. This will permanently delete your account and remove all data from our servers."}),v.jsx("input",{type:"password",value:k,onChange:we=>z(we.target.value),placeholder:"Enter your password",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 mb-4"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>{B(!1),z("")},className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-zinc-700 text-gray-900 dark:text-white rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-zinc-600 transition-colors",children:"Cancel"}),v.jsx("button",{onClick:Ke,disabled:C||!k.trim(),className:"flex-1 py-2 px-4 bg-red-500 text-white rounded-lg font-medium hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:C?"Deleting...":"Delete Account"})]})]})})]})]})},Wte=()=>{const{addEnvelope:n,setEnvelopeAllocation:e,currentMonth:t}=Mn(),{showToast:r}=bl(),i=Ks(),[a]=eL(),[o,c]=U.useState(""),u=a.get("type")==="piggybank",[d,h]=U.useState(""),[p,m]=U.useState(""),[b,_]=U.useState("#3B82F6"),[w,S]=U.useState(!1),T=async A=>{if(A.preventDefault(),!o.trim()||w)return;S(!0);const D=Mn.getState().envelopes,M=(D.length>0?Math.max(...D.map(k=>k.orderIndex??0)):-1)+1,j=u?new Date(`${t}-01T00:00:00`):new Date,C={name:o,currentBalance:0,lastUpdated:new Date().toISOString(),createdAt:j.toISOString(),isActive:!0,orderIndex:M};if(u){C.isPiggybank=!0;const k={monthlyContribution:parseFloat(p||"0"),color:b,icon:"piggy-bank"};d&&parseFloat(d)>0&&(k.targetAmount=parseFloat(d)),C.piggybankConfig=k}n(C).then(k=>{if(k){const z=u?parseFloat(p||"0"):0;e(k,z).catch(L=>console.error("Failed to create allocation:",L)),setTimeout(()=>{i("/")},50)}}).catch(k=>{console.error("Failed to create envelope:",k),r(k.message||"Failed to create envelope","error"),S(!1)})};return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-[calc(8rem+env(safe-area-inset-bottom))]",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-10 flex items-center shadow-sm",children:[v.jsx("button",{onClick:()=>i("/"),className:"mr-3 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white",children:v.jsx(od,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:u?"New Piggybank":"New Envelope"})]}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:[v.jsx("div",{className:"p-6 bg-blue-50 dark:bg-zinc-800 border-b border-blue-100 dark:border-zinc-700 flex justify-center py-8",children:v.jsx("div",{className:"w-20 h-20 bg-blue-100 dark:bg-zinc-700 text-blue-600 dark:text-blue-400 rounded-full flex items-center justify-center",children:u?v.jsx(_c,{size:40}):v.jsx(qL,{size:40})})}),v.jsxs("form",{onSubmit:T,className:"p-6 space-y-6 pb-6",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:u?"Piggybank Name":"Envelope Name"}),v.jsx("input",{type:"text",id:"name",value:o,onChange:A=>c(A.target.value),placeholder:u?"e.g. Vacation Fund, Emergency Savings":"e.g. Groceries, Rent, Fun Money",className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",autoFocus:!0,required:!0})]}),u&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"monthly-contribution",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Monthly Auto-Contribution *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"number",id:"monthly-contribution",value:p,onChange:A=>m(A.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:u})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"This amount will be automatically added each month and deducted from Available to Budget"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Target Goal (Optional)"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"number",id:"target-amount",value:d,onChange:A=>h(A.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Set a savings goal to track progress"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#F59E0B",label:"Amber"},{value:"#EF4444",label:"Red"},{value:"#8B5CF6",label:"Purple"},{value:"#EC4899",label:"Pink"}].map(A=>v.jsx("button",{type:"button",onClick:()=>_(A.value),className:`w-full aspect-square rounded-lg transition-all ${b===A.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-zinc-900":"hover:scale-110"}`,style:{backgroundColor:A.value},title:A.label},A.value))})]})]}),v.jsxs("div",{className:"pt-4 flex gap-3",children:[v.jsx("button",{type:"button",onClick:()=>i("/"),className:"flex-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 font-semibold bg-white dark:bg-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",children:"Cancel"}),v.jsx("button",{type:"submit",disabled:!o.trim()||u&&!p||w,className:`flex-1 py-3 px-4 rounded-xl font-semibold shadow-sm text-white transition-colors ${o.trim()&&(!u||p)&&!w?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-300 dark:bg-zinc-600 cursor-not-allowed"}`,children:w?"Creating...":u?"Create Piggybank":"Create Envelope"})]})]})]})})]})},Qte=({envelopes:n,transactionAmount:e,onSplitChange:t})=>{const[r,i]=U.useState([]),[a,o]=U.useState({}),[c,u]=U.useState(e),d=_=>{i(w=>w.includes(_)?w.filter(S=>S!==_):[...w,_])},h=(_,w)=>{o(S=>({...S,[_]:w}))};U.useEffect(()=>{if(r.length===1){const _=r[0];o({[_]:e})}},[r.length,e]),U.useEffect(()=>{const _=Object.values(a).reduce((w,S)=>w+(S||0),0);u(e-_),t(a)},[a,e,t]),U.useEffect(()=>{const _={...a};Object.keys(_).forEach(w=>{r.includes(w)||delete _[w]}),Object.keys(_).length!==Object.keys(a).length&&o(_)},[r,a]);const p=()=>{i([]),o({})},m=Math.abs(c)<.01&&r.length>0,b=r.length>0&&Math.abs(c)>.01;return v.jsxs("div",{className:"space-y-3",children:[r.length>1&&v.jsxs("div",{className:`p-3 rounded-lg ${b?"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800":m?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-zinc-800 border border-gray-200 dark:border-zinc-700"}`,children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Remaining to Split:"}),v.jsxs("span",{className:`font-bold text-lg ${b?"text-red-600 dark:text-red-400":m?"text-green-600 dark:text-green-400":"text-gray-900 dark:text-white"}`,children:["$",c.toFixed(2)]})]}),b&&v.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Split amounts must equal transaction total"})]}),v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("label",{className:"text-xs text-gray-500 dark:text-zinc-400",children:r.length>1?"Split Across Envelopes":"Select Envelope"}),r.length>0&&v.jsx("button",{type:"button",onClick:p,className:"text-xs text-blue-600 dark:text-blue-400",children:"Clear All"})]}),v.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-200 dark:border-zinc-800 rounded-lg",children:n.map(_=>v.jsxs("div",{className:"flex items-center py-3 px-3 border-b border-gray-100 dark:border-zinc-800 last:border-b-0 hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsx("input",{type:"checkbox",checked:r.includes(_.id),onChange:()=>d(_.id),className:"mr-3 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),v.jsx("span",{className:"flex-1 text-gray-900 dark:text-white",children:_.name}),r.includes(_.id)&&r.length>1&&v.jsxs("div",{className:"flex items-center",children:[v.jsx("span",{className:"mr-1 text-gray-500 dark:text-zinc-400",children:"$"}),v.jsx("input",{type:"number",min:"0",step:"0.01",value:a[_.id]||"",onChange:w=>h(_.id,parseFloat(w.target.value)||0),className:"w-24 px-2 py-1 border border-gray-300 dark:border-zinc-700 rounded bg-white dark:bg-zinc-900 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]})]},_.id))})]})},jV=({onClose:n,onSaved:e})=>{const t=Ks(),{envelopes:r,addTransaction:i,currentMonth:a}=Mn(),[o,c]=U.useState(""),[u,d]=U.useState(""),[h,p]=U.useState(""),[m,b]=U.useState(()=>{const Y=new Date;return new Date(Y.getTime()-Y.getTimezoneOffset()*6e4).toISOString().split("T")[0]}),[_,w]=U.useState("expense"),[S,T]=U.useState({}),[A,D]=U.useState(null),[O,M]=U.useState(!1),j=()=>{if(n){n();return}t(-1)},C=Y=>{D(Y),A&&M(!0)},I=Object.keys(S).length>0,k=Object.values(S).reduce((Y,H)=>Y+(H||0),0),z=Math.abs(k-parseFloat(o||"0"))<.01,L=o&&parseFloat(o)>0&&I&&z,B=async Y=>{if(Y.preventDefault(),!L)return;const[H,W,K]=m.split("-").map(Number),de=new Date(H,W-1,K,12,0,0);console.log(" Selected date:",m),console.log(" Parsed date:",de.toISOString());try{const[Q,G]=m.split("-").map(Number),$=`${Q}-${G.toString().padStart(2,"0")}`;if($!==a){const te=`This transaction date (${$}) does not match the current budget month (${a}). Are you sure you want to save it?`;if(!window.confirm(te))return}const ee=Object.entries(S).filter(([te,le])=>le>0);Promise.all(ee.map(([te,le])=>i({amount:le,description:h,merchant:u||void 0,date:de.toISOString(),envelopeId:te,type:_==="income"?"Income":"Expense",reconciled:!1,paymentMethod:A||void 0}).catch(fe=>console.error("Failed to create transaction:",fe)))).catch(te=>console.error("Failed to create transactions:",te)),e&&e(),n?n():t("/")}catch(Q){console.error("Error saving transaction:",Q),alert("Failed to save transaction: "+(Q instanceof Error?Q.message:"Unknown error"))}},P=[...r].filter(Y=>Y.isActive!==!1).sort((Y,H)=>{const W=Y.orderIndex??0,K=H.orderIndex??0;return W!==K?W-K:Y.name.localeCompare(H.name)}),J=_==="income"?"text-green-500":"text-red-500";return v.jsxs("div",{className:"h-screen overflow-y-auto bg-gray-50 dark:bg-black overscroll-contain",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b border-gray-200 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 z-20 flex items-center justify-between",children:[v.jsx("button",{onClick:j,className:"text-blue-600 dark:text-blue-400 font-medium",children:"Cancel"}),v.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"New Transaction"}),v.jsx("button",{onClick:B,disabled:!L,className:"text-blue-600 dark:text-blue-400 font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:"Save"})]}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto pb-[calc(8rem+env(safe-area-inset-bottom))]",children:v.jsxs("form",{onSubmit:B,className:"space-y-6",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl border border-gray-200 dark:border-zinc-800 overflow-hidden",children:v.jsxs("div",{className:"flex",children:[v.jsx("button",{type:"button",onClick:()=>w("expense"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${_==="expense"?"bg-red-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Expense"}),v.jsx("button",{type:"button",onClick:()=>w("income"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${_==="income"?"bg-green-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Income"})]})}),v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${J}`,children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:o,onChange:Y=>{const H=Y.target.value.replace(/\D/g,"");if(!H){c("");return}const K=(parseInt(H,10)/100).toFixed(2);c(K)},onKeyDown:Y=>{(Y.key==="e"||Y.key==="E"||Y.key==="+"||Y.key==="-")&&Y.preventDefault()},placeholder:"0.00",autoFocus:!0,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${J} placeholder-gray-700`})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),v.jsx("input",{type:"text",value:u,onChange:Y=>d(Y.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsx(MV,{selectedCard:A,onCardSelect:C,isUserSelected:O}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),v.jsx("input",{type:"text",value:h,onChange:Y=>p(Y.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const[Y,H]=m.split("-").map(Number);return`${Y}-${H.toString().padStart(2,"0")}`!==a?v.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[v.jsx(ed,{size:14}),v.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),v.jsx("input",{type:"date",value:m,onChange:Y=>b(Y.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 transition-colors",children:v.jsx(Qte,{envelopes:P,transactionAmount:parseFloat(o)||0,onSplitChange:T})})]})})]})},Zte=()=>{const n=Ks(),{transactions:e,envelopes:t,updateTransaction:r,deleteTransaction:i,restoreTransaction:a,currentMonth:o,appSettings:c}=Mn(),{showToast:u}=bl(),[d,h]=U.useState(!1),[p,m]=U.useState(""),[b,_]=U.useState("all"),[w,S]=U.useState("All"),[T,A]=U.useState(!1),[D,O]=U.useState("all"),[M,j]=U.useState(!1),[C,I]=U.useState("all"),[k,z]=U.useState(!1),[L,B]=U.useState(()=>{const Q=new Date;return Q.setMonth(Q.getMonth()-1),Q.toISOString().split("T")[0]}),[P,J]=U.useState(()=>new Date().toISOString().split("T")[0]),[Y,H]=U.useState(null),W=U.useMemo(()=>{console.log(" Filtering transactions:",{totalTransactions:e.length,showAllTime:M,currentMonth:o,transactionMonths:e.map($=>({id:$.id,month:$.month,date:$.date,description:$.description}))});let Q=e;return M||(Q=e.filter($=>$.month===o||!$.month),console.log(" After month filter:",{remaining:Q.length,currentMonth:o,filteredTransactions:Q.map($=>({id:$.id,description:$.description,month:$.month,matchesCurrentMonth:$.month===o}))})),Q.map($=>{if(!$)return null;let ee=$.date;if(typeof $.date=="number"){const le=($.date+978307200)*1e3;ee=new Date(le).toISOString()}else if(!$.date||typeof $.date!="string")return null;return{...$,date:ee}}).filter(Boolean).filter($=>{if(p){const te=p.toLowerCase(),le=t.find(Ee=>Ee.id===$.envelopeId)?.name.toLowerCase()||"",fe=$.amount.toFixed(2);if(!($.description.toLowerCase().includes(te)||le.includes(te)||fe.includes(te)))return!1}if(b!=="all"&&$.envelopeId!==b||w!=="All"&&$.type!==w||C!=="all"&&(!$.paymentMethod||$.paymentMethod.id!==C)||!$.date||typeof $.date!="string")return!1;const ee=$.date.split("T")[0];return!(k&&(ee<L||ee>P)||D!=="all"&&new Date(ee).getMonth()!==parseInt(D)||T&&!$.reconciled)}).sort(($,ee)=>new Date(ee.date).getTime()-new Date($.date).getTime())},[e,t,p,b,w,C,L,P,T,M,o,k]);console.log(" Final filtered transactions:",{count:W.length,transactions:W.map(Q=>({id:Q.id,description:Q.description,amount:Q.amount,date:Q.date,month:Q.month,type:Q.type}))});const K=Y?t.find(Q=>Q.id===Y.envelopeId):null,de=Q=>{const G={...Q,reconciled:!Q.reconciled};r(G)};return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-[calc(8rem+env(safe-area-inset-bottom))] transition-colors duration-200",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-between shadow-sm",children:[v.jsxs("div",{className:"flex items-center",children:[v.jsx("button",{onClick:()=>n(-1),className:"mr-3 text-gray-600 hover:text-gray-900 dark:text-zinc-400 dark:hover:text-white transition-colors",children:v.jsx(od,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"All Transactions"})]}),v.jsx("button",{onClick:()=>h(!d),className:`p-2 rounded-full transition-colors ${d?"bg-blue-100 text-blue-600 dark:bg-blue-900/40 dark:text-blue-400":"text-gray-400 dark:text-zinc-600 hover:bg-gray-100 dark:hover:bg-zinc-800"}`,children:v.jsx($L,{size:20,className:d?"fill-current":""})})]}),v.jsxs("div",{className:"px-4 py-2 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 flex justify-between items-center",children:[v.jsxs("div",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:["Month: ",o]}),v.jsx("button",{onClick:()=>j(!M),className:`text-sm px-3 py-1 rounded-md ${M?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-800 dark:bg-zinc-800 dark:text-zinc-300"}`,children:M?"Current Month Only":"All Time"})]}),v.jsx("div",{className:"px-4 py-3 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800",children:v.jsxs("div",{className:"relative",children:[v.jsx(f9,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),v.jsx("input",{type:"text",placeholder:"Search transactions...",value:p,onChange:Q=>m(Q.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none dark:text-white"}),p&&v.jsx("button",{onClick:()=>m(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",children:v.jsx(Ev,{size:16})})]})}),v.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 ${d?"max-h-[600px] opacity-100":"max-h-0 opacity-0"}`,children:v.jsxs("div",{className:"p-4 space-y-4",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Payment Method"}),v.jsxs("select",{value:C,onChange:Q=>I(Q.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Payment Methods"}),c?.paymentSources?.map(Q=>v.jsx("option",{value:Q.id,children:Q.name},Q.id))]})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Envelope"}),v.jsxs("select",{value:b,onChange:Q=>_(Q.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Envelopes"}),t.sort((Q,G)=>Q.name.localeCompare(G.name)).map(Q=>v.jsx("option",{value:Q.id,children:Q.name},Q.id))]})]}),v.jsx("div",{className:"bg-gray-100 dark:bg-zinc-800 p-1 rounded-lg flex",children:["All","Income","Expense"].map(Q=>v.jsx("button",{onClick:()=>S(Q),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${w===Q?"bg-white dark:bg-zinc-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-zinc-500 hover:text-gray-700"}`,children:Q},Q))}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Month"}),v.jsxs("select",{value:D,onChange:Q=>O(Q.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Months"}),Array.from({length:12},(Q,G)=>G).map(Q=>v.jsx("option",{value:Q,children:new Date(2022,Q).toLocaleString("default",{month:"long"})},Q))]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Date Range"}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("label",{className:"text-xs text-gray-600 dark:text-zinc-400",children:"Enable"}),v.jsx("button",{onClick:()=>z(!k),className:`w-9 h-5 rounded-full transition-colors relative ${k?"bg-blue-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-3 h-3 bg-white rounded-full transition-transform ${k?"translate-x-4":"translate-x-0"}`})})]})]}),v.jsxs("div",{className:`grid grid-cols-2 gap-4 transition-opacity ${k?"opacity-100":"opacity-50 pointer-events-none"}`,children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-[10px] font-medium text-gray-500 dark:text-zinc-500 uppercase",children:"From"}),v.jsx("div",{className:"relative",children:v.jsx("input",{type:"date",value:L,onChange:Q=>B(Q.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-[10px] font-medium text-gray-500 dark:text-zinc-500 uppercase",children:"To"}),v.jsx("div",{className:"relative",children:v.jsx("input",{type:"date",value:P,onChange:Q=>J(Q.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]})]})]}),v.jsxs("div",{className:"flex items-center justify-between pt-2",children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show only reconciled"}),v.jsx("button",{onClick:()=>A(!T),className:`w-11 h-6 rounded-full transition-colors relative ${T?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${T?"translate-x-5":"translate-x-0"}`})})]}),v.jsxs("div",{className:"flex items-center justify-between pt-2",children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show all time"}),v.jsx("button",{onClick:()=>j(!M),className:`w-11 h-6 rounded-full transition-colors relative ${M?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${M?"translate-x-5":"translate-x-0"}`})})]})]})}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:W.length===0?v.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-zinc-500",children:"No transactions match your filters."}):v.jsx(ai,{initial:!1,mode:"popLayout",children:W.map(Q=>{const G=t.find($=>$.id===Q.envelopeId);return v.jsx(On.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(yy,{disabled:Q.isAutomatic,onDelete:()=>{if(!Q.id)return;const $={...Q};i(Q.id),u("Transaction deleted","neutral",()=>a($))},children:v.jsx(OV,{transaction:Q,envelopeName:G?.name||"Unknown Envelope",onReconcile:()=>de(Q),onEdit:()=>{Q.isAutomatic||(G?H(Q):alert("Cannot edit: Envelope deleted."))}})})},Q.id)})})})}),v.jsx(PV,{isVisible:!!Y&&!!K,onClose:()=>H(null),mode:"edit",currentEnvelope:K||{},initialTransaction:Y})]})},Kl=({children:n})=>v.jsx(On.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2,ease:"easeInOut"},className:"w-full h-full bg-gray-50 dark:bg-black",children:n}),Jte=()=>{const n=xa();return v.jsx(ai,{mode:"wait",children:v.jsxs(Sz,{location:n,children:[v.jsx(Lo,{path:"/",element:v.jsx(Kl,{children:v.jsx(Ua,{children:v.jsx(Ute,{})})})}),v.jsx(Lo,{path:"/envelope/:id",element:v.jsx(Kl,{children:v.jsx(Ua,{children:v.jsx(Yte,{})})})}),v.jsx(Lo,{path:"/add-envelope",element:v.jsx(Kl,{children:v.jsx(Ua,{children:v.jsx(Wte,{})})})}),v.jsx(Lo,{path:"/add-transaction",element:v.jsx(Kl,{children:v.jsx(Ua,{children:v.jsx(jV,{})})})}),v.jsx(Lo,{path:"/transactions",element:v.jsx(Kl,{children:v.jsx(Ua,{children:v.jsx(Zte,{})})})}),v.jsx(Lo,{path:"/settings",element:v.jsx(Kl,{children:v.jsx(Ua,{children:v.jsx(Xte,{})})})}),v.jsx(Lo,{path:"/verify-email",element:v.jsx(Kl,{children:v.jsx(Ua,{children:v.jsx(BO,{})})})})]},n.pathname)})};function ene(){const[n,e]=U.useState(!0),[t,r]=U.useState(!1),{appSettings:i,isOnboardingActive:a}=Mn(),{isAuthenticated:o,isInitialized:c,initializeAuth:u,lastAuthTime:d,offlineGracePeriod:h,currentUser:p}=fa();if(U.useEffect(()=>{const _=setTimeout(()=>{e(!1)},2e3);return()=>clearTimeout(_)},[]),U.useEffect(()=>u(),[u]),U.useEffect(()=>{const _=document.documentElement,w=window.matchMedia("(prefers-color-scheme: dark)"),S=()=>{const T=i?.theme??"system",A=w.matches;T==="dark"||T==="system"&&A?_.classList.add("dark"):_.classList.remove("dark")};if(S(),i?.theme==="system")return w.addEventListener("change",S),()=>w.removeEventListener("change",S)},[i]),n||!c)return v.jsx(UO,{message:"Initializing Personal Budget..."});if(!o)return p?v.jsx(Ua,{children:v.jsx(BO,{})}):v.jsx(Ua,{children:v.jsx(EH,{})});const b=typeof navigator<"u"&&!navigator.onLine&&o&&d&&Date.now()-d<h;return v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"fixed opacity-0 pointer-events-none -z-50",children:v.jsx("label",{id:"ios-haptic-trigger",htmlFor:"ios-haptic-checkbox",children:v.jsx("input",{type:"checkbox",id:"ios-haptic-checkbox",switch:"true"})})}),v.jsxs(Ua,{children:[b&&v.jsx("div",{className:"bg-yellow-100 dark:bg-yellow-900 border-l-4 border-yellow-500 text-yellow-700 dark:text-yellow-200 p-4",children:v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),v.jsx("div",{className:"ml-3",children:v.jsxs("p",{className:"text-sm",children:[v.jsx("strong",{children:"Offline Access:"})," You're using cached authentication. Expires in"," ",Math.ceil((h-(Date.now()-d))/(1440*60*1e3))," ","days. Connect to internet to refresh."]})})]})}),v.jsxs(Xz,{children:[v.jsx(Jte,{}),t&&v.jsxs("div",{className:"fixed inset-0 z-[60]",children:[v.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>r(!1)}),v.jsx("div",{className:"absolute inset-0",children:v.jsx(jV,{onClose:()=>r(!1),onSaved:()=>r(!1)})})]}),!a&&v.jsx(lW,{onAddTransaction:()=>r(!0)})]}),v.jsx(oW,{})]})]})}A6({onNeedRefresh(){},onOfflineReady(){console.log("App is ready for offline work")}});E6.createRoot(document.getElementById("root")).render(v.jsx(U.StrictMode,{children:v.jsx(ene,{})}));export{vt as T,mt as a,vH as b,OR as c,Gt as d,Bi as e,Fa as f,Vx as g,Ga as h,Bp as o,Gs as q,ca as s,Jl as t,Ba as u,hH as w};
