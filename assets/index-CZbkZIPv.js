(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();function Mj(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Jy={exports:{}},af={};var DA;function Oj(){if(DA)return af;DA=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,i,a){var o=null;if(a!==void 0&&(o=""+a),i.key!==void 0&&(o=""+i.key),"key"in i){a={};for(var c in i)c!=="key"&&(a[c]=i[c])}else a=i;return i=a.ref,{$$typeof:t,type:r,key:o,ref:i!==void 0?i:null,props:a}}return af.Fragment=e,af.jsx=n,af.jsxs=n,af}var IA;function Pj(){return IA||(IA=1,Jy.exports=Oj()),Jy.exports}var v=Pj(),eb={exports:{}},it={};var MA;function jj(){if(MA)return it;MA=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),m=Symbol.iterator;function b(F){return F===null||typeof F!="object"?null:(F=m&&F[m]||F["@@iterator"],typeof F=="function"?F:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,E={};function T(F,Y,Z){this.props=F,this.context=Y,this.refs=E,this.updater=Z||w}T.prototype.isReactComponent={},T.prototype.setState=function(F,Y){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,Y,"setState")},T.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function C(){}C.prototype=T.prototype;function N(F,Y,Z){this.props=F,this.context=Y,this.refs=E,this.updater=Z||w}var j=N.prototype=new C;j.constructor=N,S(j,T.prototype),j.isPureReactComponent=!0;var O=Array.isArray;function M(){}var A={H:null,A:null,T:null,S:null},k=Object.prototype.hasOwnProperty;function D(F,Y,Z){var W=Z.ref;return{$$typeof:t,type:F,key:Y,ref:W!==void 0?W:null,props:Z}}function V(F,Y){return D(F.type,Y,F.props)}function L(F){return typeof F=="object"&&F!==null&&F.$$typeof===t}function U(F){var Y={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(Z){return Y[Z]})}var P=/\/+/g;function K(F,Y){return typeof F=="object"&&F!==null&&F.key!=null?U(""+F.key):Y.toString(36)}function X(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(M,M):(F.status="pending",F.then(function(Y){F.status==="pending"&&(F.status="fulfilled",F.value=Y)},function(Y){F.status==="pending"&&(F.status="rejected",F.reason=Y)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function q(F,Y,Z,W,le){var ie=typeof F;(ie==="undefined"||ie==="boolean")&&(F=null);var pe=!1;if(F===null)pe=!0;else switch(ie){case"bigint":case"string":case"number":pe=!0;break;case"object":switch(F.$$typeof){case t:case e:pe=!0;break;case h:return pe=F._init,q(pe(F._payload),Y,Z,W,le)}}if(pe)return le=le(F),pe=W===""?"."+K(F,0):W,O(le)?(Z="",pe!=null&&(Z=pe.replace(P,"$&/")+"/"),q(le,Y,Z,"",function(Re){return Re})):le!=null&&(L(le)&&(le=V(le,Z+(le.key==null||F&&F.key===le.key?"":(""+le.key).replace(P,"$&/")+"/")+pe)),Y.push(le)),1;pe=0;var ce=W===""?".":W+":";if(O(F))for(var xe=0;xe<F.length;xe++)W=F[xe],ie=ce+K(W,xe),pe+=q(W,Y,Z,ie,le);else if(xe=b(F),typeof xe=="function")for(F=xe.call(F),xe=0;!(W=F.next()).done;)W=W.value,ie=ce+K(W,xe++),pe+=q(W,Y,Z,ie,le);else if(ie==="object"){if(typeof F.then=="function")return q(X(F),Y,Z,W,le);throw Y=String(F),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.")}return pe}function Q(F,Y,Z){if(F==null)return F;var W=[],le=0;return q(F,W,"","",function(ie){return Y.call(Z,ie,le++)}),W}function te(F){if(F._status===-1){var Y=F._result;Y=Y(),Y.then(function(Z){(F._status===0||F._status===-1)&&(F._status=1,F._result=Z)},function(Z){(F._status===0||F._status===-1)&&(F._status=2,F._result=Z)}),F._status===-1&&(F._status=0,F._result=Y)}if(F._status===1)return F._result.default;throw F._result}var se=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent(Y))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)},G={map:Q,forEach:function(F,Y,Z){Q(F,function(){Y.apply(this,arguments)},Z)},count:function(F){var Y=0;return Q(F,function(){Y++}),Y},toArray:function(F){return Q(F,function(Y){return Y})||[]},only:function(F){if(!L(F))throw Error("React.Children.only expected to receive a single React element child.");return F}};return it.Activity=p,it.Children=G,it.Component=T,it.Fragment=n,it.Profiler=i,it.PureComponent=N,it.StrictMode=r,it.Suspense=u,it.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,it.__COMPILER_RUNTIME={__proto__:null,c:function(F){return A.H.useMemoCache(F)}},it.cache=function(F){return function(){return F.apply(null,arguments)}},it.cacheSignal=function(){return null},it.cloneElement=function(F,Y,Z){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var W=S({},F.props),le=F.key;if(Y!=null)for(ie in Y.key!==void 0&&(le=""+Y.key),Y)!k.call(Y,ie)||ie==="key"||ie==="__self"||ie==="__source"||ie==="ref"&&Y.ref===void 0||(W[ie]=Y[ie]);var ie=arguments.length-2;if(ie===1)W.children=Z;else if(1<ie){for(var pe=Array(ie),ce=0;ce<ie;ce++)pe[ce]=arguments[ce+2];W.children=pe}return D(F.type,le,W)},it.createContext=function(F){return F={$$typeof:o,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:a,_context:F},F},it.createElement=function(F,Y,Z){var W,le={},ie=null;if(Y!=null)for(W in Y.key!==void 0&&(ie=""+Y.key),Y)k.call(Y,W)&&W!=="key"&&W!=="__self"&&W!=="__source"&&(le[W]=Y[W]);var pe=arguments.length-2;if(pe===1)le.children=Z;else if(1<pe){for(var ce=Array(pe),xe=0;xe<pe;xe++)ce[xe]=arguments[xe+2];le.children=ce}if(F&&F.defaultProps)for(W in pe=F.defaultProps,pe)le[W]===void 0&&(le[W]=pe[W]);return D(F,ie,le)},it.createRef=function(){return{current:null}},it.forwardRef=function(F){return{$$typeof:c,render:F}},it.isValidElement=L,it.lazy=function(F){return{$$typeof:h,_payload:{_status:-1,_result:F},_init:te}},it.memo=function(F,Y){return{$$typeof:d,type:F,compare:Y===void 0?null:Y}},it.startTransition=function(F){var Y=A.T,Z={};A.T=Z;try{var W=F(),le=A.S;le!==null&&le(Z,W),typeof W=="object"&&W!==null&&typeof W.then=="function"&&W.then(M,se)}catch(ie){se(ie)}finally{Y!==null&&Z.types!==null&&(Y.types=Z.types),A.T=Y}},it.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},it.use=function(F){return A.H.use(F)},it.useActionState=function(F,Y,Z){return A.H.useActionState(F,Y,Z)},it.useCallback=function(F,Y){return A.H.useCallback(F,Y)},it.useContext=function(F){return A.H.useContext(F)},it.useDebugValue=function(){},it.useDeferredValue=function(F,Y){return A.H.useDeferredValue(F,Y)},it.useEffect=function(F,Y){return A.H.useEffect(F,Y)},it.useEffectEvent=function(F){return A.H.useEffectEvent(F)},it.useId=function(){return A.H.useId()},it.useImperativeHandle=function(F,Y,Z){return A.H.useImperativeHandle(F,Y,Z)},it.useInsertionEffect=function(F,Y){return A.H.useInsertionEffect(F,Y)},it.useLayoutEffect=function(F,Y){return A.H.useLayoutEffect(F,Y)},it.useMemo=function(F,Y){return A.H.useMemo(F,Y)},it.useOptimistic=function(F,Y){return A.H.useOptimistic(F,Y)},it.useReducer=function(F,Y,Z){return A.H.useReducer(F,Y,Z)},it.useRef=function(F){return A.H.useRef(F)},it.useState=function(F){return A.H.useState(F)},it.useSyncExternalStore=function(F,Y,Z){return A.H.useSyncExternalStore(F,Y,Z)},it.useTransition=function(){return A.H.useTransition()},it.version="19.2.0",it}var OA;function P1(){return OA||(OA=1,eb.exports=jj()),eb.exports}var B=P1();const uf=Mj(B);var tb={exports:{}},sf={},nb={exports:{}},rb={};var PA;function Vj(){return PA||(PA=1,(function(t){function e(q,Q){var te=q.length;q.push(Q);e:for(;0<te;){var se=te-1>>>1,G=q[se];if(0<i(G,Q))q[se]=Q,q[te]=G,te=se;else break e}}function n(q){return q.length===0?null:q[0]}function r(q){if(q.length===0)return null;var Q=q[0],te=q.pop();if(te!==Q){q[0]=te;e:for(var se=0,G=q.length,F=G>>>1;se<F;){var Y=2*(se+1)-1,Z=q[Y],W=Y+1,le=q[W];if(0>i(Z,te))W<G&&0>i(le,Z)?(q[se]=le,q[W]=te,se=W):(q[se]=Z,q[Y]=te,se=Y);else if(W<G&&0>i(le,te))q[se]=le,q[W]=te,se=W;else break e}}return Q}function i(q,Q){var te=q.sortIndex-Q.sortIndex;return te!==0?te:q.id-Q.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],d=[],h=1,p=null,m=3,b=!1,w=!1,S=!1,E=!1,T=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function j(q){for(var Q=n(d);Q!==null;){if(Q.callback===null)r(d);else if(Q.startTime<=q)r(d),Q.sortIndex=Q.expirationTime,e(u,Q);else break;Q=n(d)}}function O(q){if(S=!1,j(q),!w)if(n(u)!==null)w=!0,M||(M=!0,U());else{var Q=n(d);Q!==null&&X(O,Q.startTime-q)}}var M=!1,A=-1,k=5,D=-1;function V(){return E?!0:!(t.unstable_now()-D<k)}function L(){if(E=!1,M){var q=t.unstable_now();D=q;var Q=!0;try{e:{w=!1,S&&(S=!1,C(A),A=-1),b=!0;var te=m;try{t:{for(j(q),p=n(u);p!==null&&!(p.expirationTime>q&&V());){var se=p.callback;if(typeof se=="function"){p.callback=null,m=p.priorityLevel;var G=se(p.expirationTime<=q);if(q=t.unstable_now(),typeof G=="function"){p.callback=G,j(q),Q=!0;break t}p===n(u)&&r(u),j(q)}else r(u);p=n(u)}if(p!==null)Q=!0;else{var F=n(d);F!==null&&X(O,F.startTime-q),Q=!1}}break e}finally{p=null,m=te,b=!1}Q=void 0}}finally{Q?U():M=!1}}}var U;if(typeof N=="function")U=function(){N(L)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,K=P.port2;P.port1.onmessage=L,U=function(){K.postMessage(null)}}else U=function(){T(L,0)};function X(q,Q){A=T(function(){q(t.unstable_now())},Q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(q){q.callback=null},t.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<q?Math.floor(1e3/q):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_next=function(q){switch(m){case 1:case 2:case 3:var Q=3;break;default:Q=m}var te=m;m=Q;try{return q()}finally{m=te}},t.unstable_requestPaint=function(){E=!0},t.unstable_runWithPriority=function(q,Q){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var te=m;m=q;try{return Q()}finally{m=te}},t.unstable_scheduleCallback=function(q,Q,te){var se=t.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?se+te:se):te=se,q){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=te+G,q={id:h++,callback:Q,priorityLevel:q,startTime:te,expirationTime:G,sortIndex:-1},te>se?(q.sortIndex=te,e(d,q),n(u)===null&&q===n(d)&&(S?(C(A),A=-1):S=!0,X(O,te-se))):(q.sortIndex=G,e(u,q),w||b||(w=!0,M||(M=!0,U()))),q},t.unstable_shouldYield=V,t.unstable_wrapCallback=function(q){var Q=m;return function(){var te=m;m=Q;try{return q.apply(this,arguments)}finally{m=te}}}})(rb)),rb}var jA;function zj(){return jA||(jA=1,nb.exports=Vj()),nb.exports}var ib={exports:{}},sr={};var VA;function Lj(){if(VA)return sr;VA=1;var t=P1();function e(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)d+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(u,d,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:p==null?null:""+p,children:u,containerInfo:d,implementation:h}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return sr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,sr.createPortal=function(u,d){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return a(u,d,null,h)},sr.flushSync=function(u){var d=o.T,h=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=d,r.p=h,r.d.f()}},sr.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(u,d))},sr.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},sr.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin),m=typeof d.integrity=="string"?d.integrity:void 0,b=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;h==="style"?r.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:b}):h==="script"&&r.d.X(u,{crossOrigin:p,integrity:m,fetchPriority:b,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},sr.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var h=c(d.as,d.crossOrigin);r.d.M(u,{crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(u)},sr.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin);r.d.L(u,h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},sr.preloadModule=function(u,d){if(typeof u=="string")if(d){var h=c(d.as,d.crossOrigin);r.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(u)},sr.requestFormReset=function(u){r.d.r(u)},sr.unstable_batchedUpdates=function(u,d){return u(d)},sr.useFormState=function(u,d,h){return o.H.useFormState(u,d,h)},sr.useFormStatus=function(){return o.H.useHostTransitionStatus()},sr.version="19.2.0",sr}var zA;function Bj(){if(zA)return ib.exports;zA=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),ib.exports=Lj(),ib.exports}var LA;function Uj(){if(LA)return sf;LA=1;var t=zj(),e=P1(),n=Bj();function r(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var l=s,f=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(f=l.return),s=l.return;while(s)}return l.tag===3?f:null}function o(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function c(s){if(s.tag===31){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function u(s){if(a(s)!==s)throw Error(r(188))}function d(s){var l=s.alternate;if(!l){if(l=a(s),l===null)throw Error(r(188));return l!==s?null:s}for(var f=s,g=l;;){var x=f.return;if(x===null)break;var _=x.alternate;if(_===null){if(g=x.return,g!==null){f=g;continue}break}if(x.child===_.child){for(_=x.child;_;){if(_===f)return u(x),s;if(_===g)return u(x),l;_=_.sibling}throw Error(r(188))}if(f.return!==g.return)f=x,g=_;else{for(var I=!1,$=x.child;$;){if($===f){I=!0,f=x,g=_;break}if($===g){I=!0,g=x,f=_;break}$=$.sibling}if(!I){for($=_.child;$;){if($===f){I=!0,f=_,g=x;break}if($===g){I=!0,g=_,f=x;break}$=$.sibling}if(!I)throw Error(r(189))}}if(f.alternate!==g)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?s:l}function h(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=h(s),l!==null)return l;s=s.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),N=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function U(s){return s===null||typeof s!="object"?null:(s=L&&s[L]||s["@@iterator"],typeof s=="function"?s:null)}var P=Symbol.for("react.client.reference");function K(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===P?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case S:return"Fragment";case T:return"Profiler";case E:return"StrictMode";case O:return"Suspense";case M:return"SuspenseList";case D:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case w:return"Portal";case N:return s.displayName||"Context";case C:return(s._context.displayName||"Context")+".Consumer";case j:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case A:return l=s.displayName||null,l!==null?l:K(s.type)||"Memo";case k:l=s._payload,s=s._init;try{return K(s(l))}catch{}}return null}var X=Array.isArray,q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,te={pending:!1,data:null,method:null,action:null},se=[],G=-1;function F(s){return{current:s}}function Y(s){0>G||(s.current=se[G],se[G]=null,G--)}function Z(s,l){G++,se[G]=s.current,s.current=l}var W=F(null),le=F(null),ie=F(null),pe=F(null);function ce(s,l){switch(Z(ie,l),Z(le,s),Z(W,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?eA(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=eA(l),s=tA(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}Y(W),Z(W,s)}function xe(){Y(W),Y(le),Y(ie)}function Re(s){s.memoizedState!==null&&Z(pe,s);var l=W.current,f=tA(l,s.type);l!==f&&(Z(le,s),Z(W,f))}function ae(s){le.current===s&&(Y(W),Y(le)),pe.current===s&&(Y(pe),ef._currentValue=te)}var Ee,Ne;function Ie(s){if(Ee===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);Ee=l&&l[1]||"",Ne=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ee+s+Ne}var Oe=!1;function Ve(s,l){if(!s||Oe)return"";Oe=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(l){var we=function(){throw Error()};if(Object.defineProperty(we.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(we,[])}catch(me){var he=me}Reflect.construct(s,[],we)}else{try{we.call()}catch(me){he=me}s.call(we.prototype)}}else{try{throw Error()}catch(me){he=me}(we=s())&&typeof we.catch=="function"&&we.catch(function(){})}}catch(me){if(me&&he&&typeof me.stack=="string")return[me.stack,he.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=g.DetermineComponentFrameRoot(),I=_[0],$=_[1];if(I&&$){var J=I.split(`
`),fe=$.split(`
`);for(x=g=0;g<J.length&&!J[g].includes("DetermineComponentFrameRoot");)g++;for(;x<fe.length&&!fe[x].includes("DetermineComponentFrameRoot");)x++;if(g===J.length||x===fe.length)for(g=J.length-1,x=fe.length-1;1<=g&&0<=x&&J[g]!==fe[x];)x--;for(;1<=g&&0<=x;g--,x--)if(J[g]!==fe[x]){if(g!==1||x!==1)do if(g--,x--,0>x||J[g]!==fe[x]){var ve=`
`+J[g].replace(" at new "," at ");return s.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",s.displayName)),ve}while(1<=g&&0<=x);break}}}finally{Oe=!1,Error.prepareStackTrace=f}return(f=s?s.displayName||s.name:"")?Ie(f):""}function Se(s,l){switch(s.tag){case 26:case 27:case 5:return Ie(s.type);case 16:return Ie("Lazy");case 13:return s.child!==l&&l!==null?Ie("Suspense Fallback"):Ie("Suspense");case 19:return Ie("SuspenseList");case 0:case 15:return Ve(s.type,!1);case 11:return Ve(s.type.render,!1);case 1:return Ve(s.type,!0);case 31:return Ie("Activity");default:return""}}function Le(s){try{var l="",f=null;do l+=Se(s,f),f=s,s=s.return;while(s);return l}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var Me=Object.prototype.hasOwnProperty,Be=t.unstable_scheduleCallback,st=t.unstable_cancelCallback,_t=t.unstable_shouldYield,Ze=t.unstable_requestPaint,ut=t.unstable_now,Rt=t.unstable_getCurrentPriorityLevel,cn=t.unstable_ImmediatePriority,It=t.unstable_UserBlockingPriority,_n=t.unstable_NormalPriority,Ur=t.unstable_LowPriority,aa=t.unstable_IdlePriority,qa=t.log,Os=t.unstable_setDisableYieldValue,Fr=null,Sn=null;function ar(s){if(typeof qa=="function"&&Os(s),Sn&&typeof Sn.setStrictMode=="function")try{Sn.setStrictMode(Fr,s)}catch{}}var tn=Math.clz32?Math.clz32:js,uc=Math.log,Ps=Math.LN2;function js(s){return s>>>=0,s===0?32:31-(uc(s)/Ps|0)|0}var ft=256,nn=262144,rn=4194304;function $r(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function ai(s,l,f){var g=s.pendingLanes;if(g===0)return 0;var x=0,_=s.suspendedLanes,I=s.pingedLanes;s=s.warmLanes;var $=g&134217727;return $!==0?(g=$&~_,g!==0?x=$r(g):(I&=$,I!==0?x=$r(I):f||(f=$&~s,f!==0&&(x=$r(f))))):($=g&~_,$!==0?x=$r($):I!==0?x=$r(I):f||(f=g&~s,f!==0&&(x=$r(f)))),x===0?0:l!==0&&l!==x&&(l&_)===0&&(_=x&-x,f=l&-l,_>=f||_===32&&(f&4194048)!==0)?l:x}function pr(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function rv(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qh(){var s=rn;return rn<<=1,(rn&62914560)===0&&(rn=4194304),s}function sa(s){for(var l=[],f=0;31>f;f++)l.push(s);return l}function il(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function iv(s,l,f,g,x,_){var I=s.pendingLanes;s.pendingLanes=f,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=f,s.entangledLanes&=f,s.errorRecoveryDisabledLanes&=f,s.shellSuspendCounter=0;var $=s.entanglements,J=s.expirationTimes,fe=s.hiddenUpdates;for(f=I&~f;0<f;){var ve=31-tn(f),we=1<<ve;$[ve]=0,J[ve]=-1;var he=fe[ve];if(he!==null)for(fe[ve]=null,ve=0;ve<he.length;ve++){var me=he[ve];me!==null&&(me.lane&=-536870913)}f&=~we}g!==0&&al(s,g,0),_!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=_&~(I&~l))}function al(s,l,f){s.pendingLanes|=l,s.suspendedLanes&=~l;var g=31-tn(l);s.entangledLanes|=l,s.entanglements[g]=s.entanglements[g]|1073741824|f&261930}function ad(s,l){var f=s.entangledLanes|=l;for(s=s.entanglements;f;){var g=31-tn(f),x=1<<g;x&l|s[g]&l&&(s[g]|=l),f&=~x}}function sd(s,l){var f=l&-l;return f=(f&42)!==0?1:sl(f),(f&(s.suspendedLanes|l))!==0?0:f}function sl(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Ya(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Yh(){var s=Q.p;return s!==0?s:(s=window.event,s===void 0?32:EA(s.type))}function Oi(s,l){var f=Q.p;try{return Q.p=s,l()}finally{Q.p=f}}var Pi=Math.random().toString(36).slice(2),En="__reactFiber$"+Pi,Gn="__reactProps$"+Pi,oa="__reactContainer$"+Pi,dc="__reactEvents$"+Pi,av="__reactListeners$"+Pi,Xh="__reactHandles$"+Pi,Wh="__reactResources$"+Pi,la="__reactMarker$"+Pi;function fc(s){delete s[En],delete s[Gn],delete s[dc],delete s[av],delete s[Xh]}function ca(s){var l=s[En];if(l)return l;for(var f=s.parentNode;f;){if(l=f[oa]||f[En]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(s=lA(s);s!==null;){if(f=s[En])return f;s=lA(s)}return l}s=f,f=s.parentNode}return null}function si(s){if(s=s[En]||s[oa]){var l=s.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return s}return null}function Gr(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(r(33))}function ua(s){var l=s[Wh];return l||(l=s[Wh]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Tn(s){s[la]=!0}var od=new Set,ld={};function da(s,l){fa(s,l),fa(s+"Capture",l)}function fa(s,l){for(ld[s]=l,s=0;s<l.length;s++)od.add(l[s])}var cd=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ud={},dd={};function Kh(s){return Me.call(dd,s)?!0:Me.call(ud,s)?!1:cd.test(s)?dd[s]=!0:(ud[s]=!0,!1)}function hc(s,l,f){if(Kh(l))if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var g=l.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+f)}}function Hr(s,l,f){if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+f)}}function An(s,l,f,g){if(g===null)s.removeAttribute(f);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(f);return}s.setAttributeNS(l,f,""+g)}}function Hn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Vs(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function fd(s,l,f){var g=Object.getOwnPropertyDescriptor(s.constructor.prototype,l);if(!s.hasOwnProperty(l)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var x=g.get,_=g.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return x.call(this)},set:function(I){f=""+I,_.call(this,I)}}),Object.defineProperty(s,l,{enumerable:g.enumerable}),{getValue:function(){return f},setValue:function(I){f=""+I},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function Pt(s){if(!s._valueTracker){var l=Vs(s)?"checked":"value";s._valueTracker=fd(s,l,""+s[l])}}function ol(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var f=l.getValue(),g="";return s&&(g=Vs(s)?s.checked?"true":"false":s.value),s=g,s!==f?(l.setValue(s),!0):!1}function ha(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var ll=/[\n"\\]/g;function Tr(s){return s.replace(ll,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function pc(s,l,f,g,x,_,I,$){s.name="",I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?s.type=I:s.removeAttribute("type"),l!=null?I==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+Hn(l)):s.value!==""+Hn(l)&&(s.value=""+Hn(l)):I!=="submit"&&I!=="reset"||s.removeAttribute("value"),l!=null?hd(s,I,Hn(l)):f!=null?hd(s,I,Hn(f)):g!=null&&s.removeAttribute("value"),x==null&&_!=null&&(s.defaultChecked=!!_),x!=null&&(s.checked=x&&typeof x!="function"&&typeof x!="symbol"),$!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"?s.name=""+Hn($):s.removeAttribute("name")}function Qh(s,l,f,g,x,_,I,$){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(s.type=_),l!=null||f!=null){if(!(_!=="submit"&&_!=="reset"||l!=null)){Pt(s);return}f=f!=null?""+Hn(f):"",l=l!=null?""+Hn(l):f,$||l===s.value||(s.value=l),s.defaultValue=l}g=g??x,g=typeof g!="function"&&typeof g!="symbol"&&!!g,s.checked=$?s.checked:!!g,s.defaultChecked=!!g,I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"&&(s.name=I),Pt(s)}function hd(s,l,f){l==="number"&&ha(s.ownerDocument)===s||s.defaultValue===""+f||(s.defaultValue=""+f)}function zs(s,l,f,g){if(s=s.options,l){l={};for(var x=0;x<f.length;x++)l["$"+f[x]]=!0;for(f=0;f<s.length;f++)x=l.hasOwnProperty("$"+s[f].value),s[f].selected!==x&&(s[f].selected=x),x&&g&&(s[f].defaultSelected=!0)}else{for(f=""+Hn(f),l=null,x=0;x<s.length;x++){if(s[x].value===f){s[x].selected=!0,g&&(s[x].defaultSelected=!0);return}l!==null||s[x].disabled||(l=s[x])}l!==null&&(l.selected=!0)}}function Zh(s,l,f){if(l!=null&&(l=""+Hn(l),l!==s.value&&(s.value=l),f==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=f!=null?""+Hn(f):""}function Ls(s,l,f,g){if(l==null){if(g!=null){if(f!=null)throw Error(r(92));if(X(g)){if(1<g.length)throw Error(r(93));g=g[0]}f=g}f==null&&(f=""),l=f}f=Hn(l),s.defaultValue=f,g=s.textContent,g===f&&g!==""&&g!==null&&(s.value=g),Pt(s)}function Ar(s,l){if(l){var f=s.firstChild;if(f&&f===s.lastChild&&f.nodeType===3){f.nodeValue=l;return}}s.textContent=l}var Jh=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function pd(s,l,f){var g=l.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?g?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":g?s.setProperty(l,f):typeof f!="number"||f===0||Jh.has(l)?l==="float"?s.cssFloat=f:s[l]=(""+f).trim():s[l]=f+"px"}function gd(s,l,f){if(l!=null&&typeof l!="object")throw Error(r(62));if(s=s.style,f!=null){for(var g in f)!f.hasOwnProperty(g)||l!=null&&l.hasOwnProperty(g)||(g.indexOf("--")===0?s.setProperty(g,""):g==="float"?s.cssFloat="":s[g]="");for(var x in l)g=l[x],l.hasOwnProperty(x)&&f[x]!==g&&pd(s,x,g)}else for(var _ in l)l.hasOwnProperty(_)&&pd(s,_,l[_])}function gc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ep=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Bs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function mc(s){return Bs.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function ji(){}var md=null;function oi(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Us=null,pa=null;function cl(s){var l=si(s);if(l&&(s=l.stateNode)){var f=s[Gn]||null;e:switch(s=l.stateNode,l.type){case"input":if(pc(s,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),l=f.name,f.type==="radio"&&l!=null){for(f=s;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Tr(""+l)+'"][type="radio"]'),l=0;l<f.length;l++){var g=f[l];if(g!==s&&g.form===s.form){var x=g[Gn]||null;if(!x)throw Error(r(90));pc(g,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(l=0;l<f.length;l++)g=f[l],g.form===s.form&&ol(g)}break e;case"textarea":Zh(s,f.value,f.defaultValue);break e;case"select":l=f.value,l!=null&&zs(s,!!f.multiple,l,!1)}}}var vc=!1;function Fs(s,l,f){if(vc)return s(l,f);vc=!0;try{var g=s(l);return g}finally{if(vc=!1,(Us!==null||pa!==null)&&(Yp(),Us&&(l=Us,s=pa,pa=Us=null,cl(l),s)))for(l=0;l<s.length;l++)cl(s[l])}}function Vi(s,l){var f=s.stateNode;if(f===null)return null;var g=f[Gn]||null;if(g===null)return null;f=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(s=s.type,g=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!g;break e;default:s=!1}if(s)return null;if(f&&typeof f!="function")throw Error(r(231,l,typeof f));return f}var li=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ul=!1;if(li)try{var Lt={};Object.defineProperty(Lt,"passive",{get:function(){ul=!0}}),window.addEventListener("test",Lt,Lt),window.removeEventListener("test",Lt,Lt)}catch{ul=!1}var ga=null,vd=null,dl=null;function yd(){if(dl)return dl;var s,l=vd,f=l.length,g,x="value"in ga?ga.value:ga.textContent,_=x.length;for(s=0;s<f&&l[s]===x[s];s++);var I=f-s;for(g=1;g<=I&&l[f-g]===x[_-g];g++);return dl=x.slice(s,1<g?1-g:void 0)}function fl(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function Xa(){return!0}function zi(){return!1}function Xn(s){function l(f,g,x,_,I){this._reactName=f,this._targetInst=x,this.type=g,this.nativeEvent=_,this.target=I,this.currentTarget=null;for(var $ in s)s.hasOwnProperty($)&&(f=s[$],this[$]=f?f(_):_[$]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?Xa:zi,this.isPropagationStopped=zi,this}return p(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Xa)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Xa)},persist:function(){},isPersistent:Xa}),l}var Wa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ma=Xn(Wa),$s=p({},Wa,{view:0,detail:0}),bd=Xn($s),Gs,yc,va,bc=p({},$s,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hs,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==va&&(va&&s.type==="mousemove"?(Gs=s.screenX-va.screenX,yc=s.screenY-va.screenY):yc=Gs=0,va=s),Gs)},movementY:function(s){return"movementY"in s?s.movementY:yc}}),xd=Xn(bc),hl=p({},bc,{dataTransfer:0}),tp=Xn(hl),np=p({},$s,{relatedTarget:0}),pl=Xn(np),wd=p({},Wa,{animationName:0,elapsedTime:0,pseudoElement:0}),rp=Xn(wd),xc=p({},Wa,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),ip=Xn(xc),ap=p({},Wa,{data:0}),ya=Xn(ap),sp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},op={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cp(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=lp[s])?!!l[s]:!1}function Hs(){return cp}var gr=p({},$s,{key:function(s){if(s.key){var l=sp[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=fl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?op[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hs,charCode:function(s){return s.type==="keypress"?fl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?fl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),up=Xn(gr),dp=p({},bc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ka=Xn(dp),y=p({},$s,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hs}),R=Xn(y),z=p({},Wa,{propertyName:0,elapsedTime:0,pseudoElement:0}),H=Xn(z),ue=p({},bc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ge=Xn(ue),ke=p({},Wa,{newState:0,oldState:0}),ot=Xn(ke),mn=[9,13,27,32],Nt=li&&"CompositionEvent"in window,Zt=null;li&&"documentMode"in document&&(Zt=document.documentMode);var ci=li&&"TextEvent"in window&&!Zt,ba=li&&(!Nt||Zt&&8<Zt&&11>=Zt),Li=" ",Bi=!1;function gl(s,l){switch(s){case"keyup":return mn.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wc(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var _c=!1;function r3(s,l){switch(s){case"compositionend":return wc(l);case"keypress":return l.which!==32?null:(Bi=!0,Li);case"textInput":return s=l.data,s===Li&&Bi?null:s;default:return null}}function i3(s,l){if(_c)return s==="compositionend"||!Nt&&gl(s,l)?(s=yd(),dl=vd=ga=null,_c=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return ba&&l.locale!=="ko"?null:l.data;default:return null}}var a3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dS(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!a3[s.type]:l==="textarea"}function fS(s,l,f,g){Us?pa?pa.push(g):pa=[g]:Us=g,l=eg(l,"onChange"),0<l.length&&(f=new ma("onChange","change",null,f,g),s.push({event:f,listeners:l}))}var _d=null,Sd=null;function s3(s){XT(s,0)}function fp(s){var l=Gr(s);if(ol(l))return s}function hS(s,l){if(s==="change")return l}var pS=!1;if(li){var sv;if(li){var ov="oninput"in document;if(!ov){var gS=document.createElement("div");gS.setAttribute("oninput","return;"),ov=typeof gS.oninput=="function"}sv=ov}else sv=!1;pS=sv&&(!document.documentMode||9<document.documentMode)}function mS(){_d&&(_d.detachEvent("onpropertychange",vS),Sd=_d=null)}function vS(s){if(s.propertyName==="value"&&fp(Sd)){var l=[];fS(l,Sd,s,oi(s)),Fs(s3,l)}}function o3(s,l,f){s==="focusin"?(mS(),_d=l,Sd=f,_d.attachEvent("onpropertychange",vS)):s==="focusout"&&mS()}function l3(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return fp(Sd)}function c3(s,l){if(s==="click")return fp(l)}function u3(s,l){if(s==="input"||s==="change")return fp(l)}function d3(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var qr=typeof Object.is=="function"?Object.is:d3;function Ed(s,l){if(qr(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var f=Object.keys(s),g=Object.keys(l);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var x=f[g];if(!Me.call(l,x)||!qr(s[x],l[x]))return!1}return!0}function yS(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function bS(s,l){var f=yS(s);s=0;for(var g;f;){if(f.nodeType===3){if(g=s+f.textContent.length,s<=l&&g>=l)return{node:f,offset:l-s};s=g}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=yS(f)}}function xS(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?xS(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function wS(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=ha(s.document);l instanceof s.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)s=l.contentWindow;else break;l=ha(s.document)}return l}function lv(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var f3=li&&"documentMode"in document&&11>=document.documentMode,Sc=null,cv=null,Td=null,uv=!1;function _S(s,l,f){var g=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;uv||Sc==null||Sc!==ha(g)||(g=Sc,"selectionStart"in g&&lv(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Td&&Ed(Td,g)||(Td=g,g=eg(cv,"onSelect"),0<g.length&&(l=new ma("onSelect","select",null,l,f),s.push({event:l,listeners:g}),l.target=Sc)))}function ml(s,l){var f={};return f[s.toLowerCase()]=l.toLowerCase(),f["Webkit"+s]="webkit"+l,f["Moz"+s]="moz"+l,f}var Ec={animationend:ml("Animation","AnimationEnd"),animationiteration:ml("Animation","AnimationIteration"),animationstart:ml("Animation","AnimationStart"),transitionrun:ml("Transition","TransitionRun"),transitionstart:ml("Transition","TransitionStart"),transitioncancel:ml("Transition","TransitionCancel"),transitionend:ml("Transition","TransitionEnd")},dv={},SS={};li&&(SS=document.createElement("div").style,"AnimationEvent"in window||(delete Ec.animationend.animation,delete Ec.animationiteration.animation,delete Ec.animationstart.animation),"TransitionEvent"in window||delete Ec.transitionend.transition);function vl(s){if(dv[s])return dv[s];if(!Ec[s])return s;var l=Ec[s],f;for(f in l)if(l.hasOwnProperty(f)&&f in SS)return dv[s]=l[f];return s}var ES=vl("animationend"),TS=vl("animationiteration"),AS=vl("animationstart"),h3=vl("transitionrun"),p3=vl("transitionstart"),g3=vl("transitioncancel"),CS=vl("transitionend"),kS=new Map,fv="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");fv.push("scrollEnd");function Ui(s,l){kS.set(s,l),da(l,[s])}var hp=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},ui=[],Tc=0,hv=0;function pp(){for(var s=Tc,l=hv=Tc=0;l<s;){var f=ui[l];ui[l++]=null;var g=ui[l];ui[l++]=null;var x=ui[l];ui[l++]=null;var _=ui[l];if(ui[l++]=null,g!==null&&x!==null){var I=g.pending;I===null?x.next=x:(x.next=I.next,I.next=x),g.pending=x}_!==0&&RS(f,x,_)}}function gp(s,l,f,g){ui[Tc++]=s,ui[Tc++]=l,ui[Tc++]=f,ui[Tc++]=g,hv|=g,s.lanes|=g,s=s.alternate,s!==null&&(s.lanes|=g)}function pv(s,l,f,g){return gp(s,l,f,g),mp(s)}function yl(s,l){return gp(s,null,null,l),mp(s)}function RS(s,l,f){s.lanes|=f;var g=s.alternate;g!==null&&(g.lanes|=f);for(var x=!1,_=s.return;_!==null;)_.childLanes|=f,g=_.alternate,g!==null&&(g.childLanes|=f),_.tag===22&&(s=_.stateNode,s===null||s._visibility&1||(x=!0)),s=_,_=_.return;return s.tag===3?(_=s.stateNode,x&&l!==null&&(x=31-tn(f),s=_.hiddenUpdates,g=s[x],g===null?s[x]=[l]:g.push(l),l.lane=f|536870912),_):null}function mp(s){if(50<Yd)throw Yd=0,Sy=null,Error(r(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var Ac={};function m3(s,l,f,g){this.tag=s,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yr(s,l,f,g){return new m3(s,l,f,g)}function gv(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Qa(s,l){var f=s.alternate;return f===null?(f=Yr(s.tag,l,s.key,s.mode),f.elementType=s.elementType,f.type=s.type,f.stateNode=s.stateNode,f.alternate=s,s.alternate=f):(f.pendingProps=l,f.type=s.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=s.flags&65011712,f.childLanes=s.childLanes,f.lanes=s.lanes,f.child=s.child,f.memoizedProps=s.memoizedProps,f.memoizedState=s.memoizedState,f.updateQueue=s.updateQueue,l=s.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=s.sibling,f.index=s.index,f.ref=s.ref,f.refCleanup=s.refCleanup,f}function NS(s,l){s.flags&=65011714;var f=s.alternate;return f===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=f.childLanes,s.lanes=f.lanes,s.child=f.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=f.memoizedProps,s.memoizedState=f.memoizedState,s.updateQueue=f.updateQueue,s.type=f.type,l=f.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function vp(s,l,f,g,x,_){var I=0;if(g=s,typeof s=="function")gv(s)&&(I=1);else if(typeof s=="string")I=wj(s,f,W.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case D:return s=Yr(31,f,l,x),s.elementType=D,s.lanes=_,s;case S:return bl(f.children,x,_,l);case E:I=8,x|=24;break;case T:return s=Yr(12,f,l,x|2),s.elementType=T,s.lanes=_,s;case O:return s=Yr(13,f,l,x),s.elementType=O,s.lanes=_,s;case M:return s=Yr(19,f,l,x),s.elementType=M,s.lanes=_,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case N:I=10;break e;case C:I=9;break e;case j:I=11;break e;case A:I=14;break e;case k:I=16,g=null;break e}I=29,f=Error(r(130,s===null?"null":typeof s,"")),g=null}return l=Yr(I,f,l,x),l.elementType=s,l.type=g,l.lanes=_,l}function bl(s,l,f,g){return s=Yr(7,s,g,l),s.lanes=f,s}function mv(s,l,f){return s=Yr(6,s,null,l),s.lanes=f,s}function DS(s){var l=Yr(18,null,null,0);return l.stateNode=s,l}function vv(s,l,f){return l=Yr(4,s.children!==null?s.children:[],s.key,l),l.lanes=f,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var IS=new WeakMap;function di(s,l){if(typeof s=="object"&&s!==null){var f=IS.get(s);return f!==void 0?f:(l={value:s,source:l,stack:Le(l)},IS.set(s,l),l)}return{value:s,source:l,stack:Le(l)}}var Cc=[],kc=0,yp=null,Ad=0,fi=[],hi=0,qs=null,xa=1,wa="";function Za(s,l){Cc[kc++]=Ad,Cc[kc++]=yp,yp=s,Ad=l}function MS(s,l,f){fi[hi++]=xa,fi[hi++]=wa,fi[hi++]=qs,qs=s;var g=xa;s=wa;var x=32-tn(g)-1;g&=~(1<<x),f+=1;var _=32-tn(l)+x;if(30<_){var I=x-x%5;_=(g&(1<<I)-1).toString(32),g>>=I,x-=I,xa=1<<32-tn(l)+x|f<<x|g,wa=_+s}else xa=1<<_|f<<x|g,wa=s}function yv(s){s.return!==null&&(Za(s,1),MS(s,1,0))}function bv(s){for(;s===yp;)yp=Cc[--kc],Cc[kc]=null,Ad=Cc[--kc],Cc[kc]=null;for(;s===qs;)qs=fi[--hi],fi[hi]=null,wa=fi[--hi],fi[hi]=null,xa=fi[--hi],fi[hi]=null}function OS(s,l){fi[hi++]=xa,fi[hi++]=wa,fi[hi++]=qs,xa=l.id,wa=l.overflow,qs=s}var Wn=null,Wt=null,St=!1,Ys=null,pi=!1,xv=Error(r(519));function Xs(s){var l=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Cd(di(l,s)),xv}function PS(s){var l=s.stateNode,f=s.type,g=s.memoizedProps;switch(l[En]=s,l[Gn]=g,f){case"dialog":pt("cancel",l),pt("close",l);break;case"iframe":case"object":case"embed":pt("load",l);break;case"video":case"audio":for(f=0;f<Wd.length;f++)pt(Wd[f],l);break;case"source":pt("error",l);break;case"img":case"image":case"link":pt("error",l),pt("load",l);break;case"details":pt("toggle",l);break;case"input":pt("invalid",l),Qh(l,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":pt("invalid",l);break;case"textarea":pt("invalid",l),Ls(l,g.value,g.defaultValue,g.children)}f=g.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||l.textContent===""+f||g.suppressHydrationWarning===!0||ZT(l.textContent,f)?(g.popover!=null&&(pt("beforetoggle",l),pt("toggle",l)),g.onScroll!=null&&pt("scroll",l),g.onScrollEnd!=null&&pt("scrollend",l),g.onClick!=null&&(l.onclick=ji),l=!0):l=!1,l||Xs(s,!0)}function jS(s){for(Wn=s.return;Wn;)switch(Wn.tag){case 5:case 31:case 13:pi=!1;return;case 27:case 3:pi=!0;return;default:Wn=Wn.return}}function Rc(s){if(s!==Wn)return!1;if(!St)return jS(s),St=!0,!1;var l=s.tag,f;if((f=l!==3&&l!==27)&&((f=l===5)&&(f=s.type,f=!(f!=="form"&&f!=="button")||zy(s.type,s.memoizedProps)),f=!f),f&&Wt&&Xs(s),jS(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Wt=oA(s)}else if(l===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Wt=oA(s)}else l===27?(l=Wt,lo(s.type)?(s=$y,$y=null,Wt=s):Wt=l):Wt=Wn?mi(s.stateNode.nextSibling):null;return!0}function xl(){Wt=Wn=null,St=!1}function wv(){var s=Ys;return s!==null&&(Nr===null?Nr=s:Nr.push.apply(Nr,s),Ys=null),s}function Cd(s){Ys===null?Ys=[s]:Ys.push(s)}var _v=F(null),wl=null,Ja=null;function Ws(s,l,f){Z(_v,l._currentValue),l._currentValue=f}function es(s){s._currentValue=_v.current,Y(_v)}function Sv(s,l,f){for(;s!==null;){var g=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),s===f)break;s=s.return}}function Ev(s,l,f,g){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var _=x.dependencies;if(_!==null){var I=x.child;_=_.firstContext;e:for(;_!==null;){var $=_;_=x;for(var J=0;J<l.length;J++)if($.context===l[J]){_.lanes|=f,$=_.alternate,$!==null&&($.lanes|=f),Sv(_.return,f,s),g||(I=null);break e}_=$.next}}else if(x.tag===18){if(I=x.return,I===null)throw Error(r(341));I.lanes|=f,_=I.alternate,_!==null&&(_.lanes|=f),Sv(I,f,s),I=null}else I=x.child;if(I!==null)I.return=x;else for(I=x;I!==null;){if(I===s){I=null;break}if(x=I.sibling,x!==null){x.return=I.return,I=x;break}I=I.return}x=I}}function Nc(s,l,f,g){s=null;for(var x=l,_=!1;x!==null;){if(!_){if((x.flags&524288)!==0)_=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var I=x.alternate;if(I===null)throw Error(r(387));if(I=I.memoizedProps,I!==null){var $=x.type;qr(x.pendingProps.value,I.value)||(s!==null?s.push($):s=[$])}}else if(x===pe.current){if(I=x.alternate,I===null)throw Error(r(387));I.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(ef):s=[ef])}x=x.return}s!==null&&Ev(l,s,f,g),l.flags|=262144}function bp(s){for(s=s.firstContext;s!==null;){if(!qr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function _l(s){wl=s,Ja=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Kn(s){return VS(wl,s)}function xp(s,l){return wl===null&&_l(s),VS(s,l)}function VS(s,l){var f=l._currentValue;if(l={context:l,memoizedValue:f,next:null},Ja===null){if(s===null)throw Error(r(308));Ja=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else Ja=Ja.next=l;return f}var v3=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(f,g){s.push(g)}};this.abort=function(){l.aborted=!0,s.forEach(function(f){return f()})}},y3=t.unstable_scheduleCallback,b3=t.unstable_NormalPriority,Cn={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Tv(){return{controller:new v3,data:new Map,refCount:0}}function kd(s){s.refCount--,s.refCount===0&&y3(b3,function(){s.controller.abort()})}var Rd=null,Av=0,Dc=0,Ic=null;function x3(s,l){if(Rd===null){var f=Rd=[];Av=0,Dc=Ry(),Ic={status:"pending",value:void 0,then:function(g){f.push(g)}}}return Av++,l.then(zS,zS),l}function zS(){if(--Av===0&&Rd!==null){Ic!==null&&(Ic.status="fulfilled");var s=Rd;Rd=null,Dc=0,Ic=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function w3(s,l){var f=[],g={status:"pending",value:null,reason:null,then:function(x){f.push(x)}};return s.then(function(){g.status="fulfilled",g.value=l;for(var x=0;x<f.length;x++)(0,f[x])(l)},function(x){for(g.status="rejected",g.reason=x,x=0;x<f.length;x++)(0,f[x])(void 0)}),g}var LS=q.S;q.S=function(s,l){_T=ut(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&x3(s,l),LS!==null&&LS(s,l)};var Sl=F(null);function Cv(){var s=Sl.current;return s!==null?s:Ht.pooledCache}function wp(s,l){l===null?Z(Sl,Sl.current):Z(Sl,l.pool)}function BS(){var s=Cv();return s===null?null:{parent:Cn._currentValue,pool:s}}var Mc=Error(r(460)),kv=Error(r(474)),_p=Error(r(542)),Sp={then:function(){}};function US(s){return s=s.status,s==="fulfilled"||s==="rejected"}function FS(s,l,f){switch(f=s[f],f===void 0?s.push(l):f!==l&&(l.then(ji,ji),l=f),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,GS(s),s;default:if(typeof l.status=="string")l.then(ji,ji);else{if(s=Ht,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=l,s.status="pending",s.then(function(g){if(l.status==="pending"){var x=l;x.status="fulfilled",x.value=g}},function(g){if(l.status==="pending"){var x=l;x.status="rejected",x.reason=g}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,GS(s),s}throw Tl=l,Mc}}function El(s){try{var l=s._init;return l(s._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(Tl=f,Mc):f}}var Tl=null;function $S(){if(Tl===null)throw Error(r(459));var s=Tl;return Tl=null,s}function GS(s){if(s===Mc||s===_p)throw Error(r(483))}var Oc=null,Nd=0;function Ep(s){var l=Nd;return Nd+=1,Oc===null&&(Oc=[]),FS(Oc,s,l)}function Dd(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function Tp(s,l){throw l.$$typeof===m?Error(r(525)):(s=Object.prototype.toString.call(l),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function HS(s){function l(oe,re){if(s){var de=oe.deletions;de===null?(oe.deletions=[re],oe.flags|=16):de.push(re)}}function f(oe,re){if(!s)return null;for(;re!==null;)l(oe,re),re=re.sibling;return null}function g(oe){for(var re=new Map;oe!==null;)oe.key!==null?re.set(oe.key,oe):re.set(oe.index,oe),oe=oe.sibling;return re}function x(oe,re){return oe=Qa(oe,re),oe.index=0,oe.sibling=null,oe}function _(oe,re,de){return oe.index=de,s?(de=oe.alternate,de!==null?(de=de.index,de<re?(oe.flags|=67108866,re):de):(oe.flags|=67108866,re)):(oe.flags|=1048576,re)}function I(oe){return s&&oe.alternate===null&&(oe.flags|=67108866),oe}function $(oe,re,de,ye){return re===null||re.tag!==6?(re=mv(de,oe.mode,ye),re.return=oe,re):(re=x(re,de),re.return=oe,re)}function J(oe,re,de,ye){var Ge=de.type;return Ge===S?ve(oe,re,de.props.children,ye,de.key):re!==null&&(re.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===k&&El(Ge)===re.type)?(re=x(re,de.props),Dd(re,de),re.return=oe,re):(re=vp(de.type,de.key,de.props,null,oe.mode,ye),Dd(re,de),re.return=oe,re)}function fe(oe,re,de,ye){return re===null||re.tag!==4||re.stateNode.containerInfo!==de.containerInfo||re.stateNode.implementation!==de.implementation?(re=vv(de,oe.mode,ye),re.return=oe,re):(re=x(re,de.children||[]),re.return=oe,re)}function ve(oe,re,de,ye,Ge){return re===null||re.tag!==7?(re=bl(de,oe.mode,ye,Ge),re.return=oe,re):(re=x(re,de),re.return=oe,re)}function we(oe,re,de){if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return re=mv(""+re,oe.mode,de),re.return=oe,re;if(typeof re=="object"&&re!==null){switch(re.$$typeof){case b:return de=vp(re.type,re.key,re.props,null,oe.mode,de),Dd(de,re),de.return=oe,de;case w:return re=vv(re,oe.mode,de),re.return=oe,re;case k:return re=El(re),we(oe,re,de)}if(X(re)||U(re))return re=bl(re,oe.mode,de,null),re.return=oe,re;if(typeof re.then=="function")return we(oe,Ep(re),de);if(re.$$typeof===N)return we(oe,xp(oe,re),de);Tp(oe,re)}return null}function he(oe,re,de,ye){var Ge=re!==null?re.key:null;if(typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint")return Ge!==null?null:$(oe,re,""+de,ye);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case b:return de.key===Ge?J(oe,re,de,ye):null;case w:return de.key===Ge?fe(oe,re,de,ye):null;case k:return de=El(de),he(oe,re,de,ye)}if(X(de)||U(de))return Ge!==null?null:ve(oe,re,de,ye,null);if(typeof de.then=="function")return he(oe,re,Ep(de),ye);if(de.$$typeof===N)return he(oe,re,xp(oe,de),ye);Tp(oe,de)}return null}function me(oe,re,de,ye,Ge){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return oe=oe.get(de)||null,$(re,oe,""+ye,Ge);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case b:return oe=oe.get(ye.key===null?de:ye.key)||null,J(re,oe,ye,Ge);case w:return oe=oe.get(ye.key===null?de:ye.key)||null,fe(re,oe,ye,Ge);case k:return ye=El(ye),me(oe,re,de,ye,Ge)}if(X(ye)||U(ye))return oe=oe.get(de)||null,ve(re,oe,ye,Ge,null);if(typeof ye.then=="function")return me(oe,re,de,Ep(ye),Ge);if(ye.$$typeof===N)return me(oe,re,de,xp(re,ye),Ge);Tp(re,ye)}return null}function ze(oe,re,de,ye){for(var Ge=null,Ct=null,Ue=re,dt=re=0,yt=null;Ue!==null&&dt<de.length;dt++){Ue.index>dt?(yt=Ue,Ue=null):yt=Ue.sibling;var kt=he(oe,Ue,de[dt],ye);if(kt===null){Ue===null&&(Ue=yt);break}s&&Ue&&kt.alternate===null&&l(oe,Ue),re=_(kt,re,dt),Ct===null?Ge=kt:Ct.sibling=kt,Ct=kt,Ue=yt}if(dt===de.length)return f(oe,Ue),St&&Za(oe,dt),Ge;if(Ue===null){for(;dt<de.length;dt++)Ue=we(oe,de[dt],ye),Ue!==null&&(re=_(Ue,re,dt),Ct===null?Ge=Ue:Ct.sibling=Ue,Ct=Ue);return St&&Za(oe,dt),Ge}for(Ue=g(Ue);dt<de.length;dt++)yt=me(Ue,oe,dt,de[dt],ye),yt!==null&&(s&&yt.alternate!==null&&Ue.delete(yt.key===null?dt:yt.key),re=_(yt,re,dt),Ct===null?Ge=yt:Ct.sibling=yt,Ct=yt);return s&&Ue.forEach(function(po){return l(oe,po)}),St&&Za(oe,dt),Ge}function Xe(oe,re,de,ye){if(de==null)throw Error(r(151));for(var Ge=null,Ct=null,Ue=re,dt=re=0,yt=null,kt=de.next();Ue!==null&&!kt.done;dt++,kt=de.next()){Ue.index>dt?(yt=Ue,Ue=null):yt=Ue.sibling;var po=he(oe,Ue,kt.value,ye);if(po===null){Ue===null&&(Ue=yt);break}s&&Ue&&po.alternate===null&&l(oe,Ue),re=_(po,re,dt),Ct===null?Ge=po:Ct.sibling=po,Ct=po,Ue=yt}if(kt.done)return f(oe,Ue),St&&Za(oe,dt),Ge;if(Ue===null){for(;!kt.done;dt++,kt=de.next())kt=we(oe,kt.value,ye),kt!==null&&(re=_(kt,re,dt),Ct===null?Ge=kt:Ct.sibling=kt,Ct=kt);return St&&Za(oe,dt),Ge}for(Ue=g(Ue);!kt.done;dt++,kt=de.next())kt=me(Ue,oe,dt,kt.value,ye),kt!==null&&(s&&kt.alternate!==null&&Ue.delete(kt.key===null?dt:kt.key),re=_(kt,re,dt),Ct===null?Ge=kt:Ct.sibling=kt,Ct=kt);return s&&Ue.forEach(function(Ij){return l(oe,Ij)}),St&&Za(oe,dt),Ge}function Ft(oe,re,de,ye){if(typeof de=="object"&&de!==null&&de.type===S&&de.key===null&&(de=de.props.children),typeof de=="object"&&de!==null){switch(de.$$typeof){case b:e:{for(var Ge=de.key;re!==null;){if(re.key===Ge){if(Ge=de.type,Ge===S){if(re.tag===7){f(oe,re.sibling),ye=x(re,de.props.children),ye.return=oe,oe=ye;break e}}else if(re.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===k&&El(Ge)===re.type){f(oe,re.sibling),ye=x(re,de.props),Dd(ye,de),ye.return=oe,oe=ye;break e}f(oe,re);break}else l(oe,re);re=re.sibling}de.type===S?(ye=bl(de.props.children,oe.mode,ye,de.key),ye.return=oe,oe=ye):(ye=vp(de.type,de.key,de.props,null,oe.mode,ye),Dd(ye,de),ye.return=oe,oe=ye)}return I(oe);case w:e:{for(Ge=de.key;re!==null;){if(re.key===Ge)if(re.tag===4&&re.stateNode.containerInfo===de.containerInfo&&re.stateNode.implementation===de.implementation){f(oe,re.sibling),ye=x(re,de.children||[]),ye.return=oe,oe=ye;break e}else{f(oe,re);break}else l(oe,re);re=re.sibling}ye=vv(de,oe.mode,ye),ye.return=oe,oe=ye}return I(oe);case k:return de=El(de),Ft(oe,re,de,ye)}if(X(de))return ze(oe,re,de,ye);if(U(de)){if(Ge=U(de),typeof Ge!="function")throw Error(r(150));return de=Ge.call(de),Xe(oe,re,de,ye)}if(typeof de.then=="function")return Ft(oe,re,Ep(de),ye);if(de.$$typeof===N)return Ft(oe,re,xp(oe,de),ye);Tp(oe,de)}return typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint"?(de=""+de,re!==null&&re.tag===6?(f(oe,re.sibling),ye=x(re,de),ye.return=oe,oe=ye):(f(oe,re),ye=mv(de,oe.mode,ye),ye.return=oe,oe=ye),I(oe)):f(oe,re)}return function(oe,re,de,ye){try{Nd=0;var Ge=Ft(oe,re,de,ye);return Oc=null,Ge}catch(Ue){if(Ue===Mc||Ue===_p)throw Ue;var Ct=Yr(29,Ue,null,oe.mode);return Ct.lanes=ye,Ct.return=oe,Ct}finally{}}}var Al=HS(!0),qS=HS(!1),Ks=!1;function Rv(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Nv(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Qs(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Zs(s,l,f){var g=s.updateQueue;if(g===null)return null;if(g=g.shared,(Dt&2)!==0){var x=g.pending;return x===null?l.next=l:(l.next=x.next,x.next=l),g.pending=l,l=mp(s),RS(s,null,f),l}return gp(s,g,l,f),mp(s)}function Id(s,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194048)!==0)){var g=l.lanes;g&=s.pendingLanes,f|=g,l.lanes=f,ad(s,f)}}function Dv(s,l){var f=s.updateQueue,g=s.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var x=null,_=null;if(f=f.firstBaseUpdate,f!==null){do{var I={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};_===null?x=_=I:_=_.next=I,f=f.next}while(f!==null);_===null?x=_=l:_=_.next=l}else x=_=l;f={baseState:g.baseState,firstBaseUpdate:x,lastBaseUpdate:_,shared:g.shared,callbacks:g.callbacks},s.updateQueue=f;return}s=f.lastBaseUpdate,s===null?f.firstBaseUpdate=l:s.next=l,f.lastBaseUpdate=l}var Iv=!1;function Md(){if(Iv){var s=Ic;if(s!==null)throw s}}function Od(s,l,f,g){Iv=!1;var x=s.updateQueue;Ks=!1;var _=x.firstBaseUpdate,I=x.lastBaseUpdate,$=x.shared.pending;if($!==null){x.shared.pending=null;var J=$,fe=J.next;J.next=null,I===null?_=fe:I.next=fe,I=J;var ve=s.alternate;ve!==null&&(ve=ve.updateQueue,$=ve.lastBaseUpdate,$!==I&&($===null?ve.firstBaseUpdate=fe:$.next=fe,ve.lastBaseUpdate=J))}if(_!==null){var we=x.baseState;I=0,ve=fe=J=null,$=_;do{var he=$.lane&-536870913,me=he!==$.lane;if(me?(vt&he)===he:(g&he)===he){he!==0&&he===Dc&&(Iv=!0),ve!==null&&(ve=ve.next={lane:0,tag:$.tag,payload:$.payload,callback:null,next:null});e:{var ze=s,Xe=$;he=l;var Ft=f;switch(Xe.tag){case 1:if(ze=Xe.payload,typeof ze=="function"){we=ze.call(Ft,we,he);break e}we=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=Xe.payload,he=typeof ze=="function"?ze.call(Ft,we,he):ze,he==null)break e;we=p({},we,he);break e;case 2:Ks=!0}}he=$.callback,he!==null&&(s.flags|=64,me&&(s.flags|=8192),me=x.callbacks,me===null?x.callbacks=[he]:me.push(he))}else me={lane:he,tag:$.tag,payload:$.payload,callback:$.callback,next:null},ve===null?(fe=ve=me,J=we):ve=ve.next=me,I|=he;if($=$.next,$===null){if($=x.shared.pending,$===null)break;me=$,$=me.next,me.next=null,x.lastBaseUpdate=me,x.shared.pending=null}}while(!0);ve===null&&(J=we),x.baseState=J,x.firstBaseUpdate=fe,x.lastBaseUpdate=ve,_===null&&(x.shared.lanes=0),ro|=I,s.lanes=I,s.memoizedState=we}}function YS(s,l){if(typeof s!="function")throw Error(r(191,s));s.call(l)}function XS(s,l){var f=s.callbacks;if(f!==null)for(s.callbacks=null,s=0;s<f.length;s++)YS(f[s],l)}var Pc=F(null),Ap=F(0);function WS(s,l){s=cs,Z(Ap,s),Z(Pc,l),cs=s|l.baseLanes}function Mv(){Z(Ap,cs),Z(Pc,Pc.current)}function Ov(){cs=Ap.current,Y(Pc),Y(Ap)}var Xr=F(null),gi=null;function Js(s){var l=s.alternate;Z(vn,vn.current&1),Z(Xr,s),gi===null&&(l===null||Pc.current!==null||l.memoizedState!==null)&&(gi=s)}function Pv(s){Z(vn,vn.current),Z(Xr,s),gi===null&&(gi=s)}function KS(s){s.tag===22?(Z(vn,vn.current),Z(Xr,s),gi===null&&(gi=s)):eo()}function eo(){Z(vn,vn.current),Z(Xr,Xr.current)}function Wr(s){Y(Xr),gi===s&&(gi=null),Y(vn)}var vn=F(0);function Cp(s){for(var l=s;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||Uy(f)||Fy(f)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var ts=0,lt=null,Bt=null,kn=null,kp=!1,jc=!1,Cl=!1,Rp=0,Pd=0,Vc=null,_3=0;function un(){throw Error(r(321))}function jv(s,l){if(l===null)return!1;for(var f=0;f<l.length&&f<s.length;f++)if(!qr(s[f],l[f]))return!1;return!0}function Vv(s,l,f,g,x,_){return ts=_,lt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,q.H=s===null||s.memoizedState===null?ME:Zv,Cl=!1,_=f(g,x),Cl=!1,jc&&(_=ZS(l,f,g,x)),QS(s),_}function QS(s){q.H=zd;var l=Bt!==null&&Bt.next!==null;if(ts=0,kn=Bt=lt=null,kp=!1,Pd=0,Vc=null,l)throw Error(r(300));s===null||Rn||(s=s.dependencies,s!==null&&bp(s)&&(Rn=!0))}function ZS(s,l,f,g){lt=s;var x=0;do{if(jc&&(Vc=null),Pd=0,jc=!1,25<=x)throw Error(r(301));if(x+=1,kn=Bt=null,s.updateQueue!=null){var _=s.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}q.H=OE,_=l(f,g)}while(jc);return _}function S3(){var s=q.H,l=s.useState()[0];return l=typeof l.then=="function"?jd(l):l,s=s.useState()[0],(Bt!==null?Bt.memoizedState:null)!==s&&(lt.flags|=1024),l}function zv(){var s=Rp!==0;return Rp=0,s}function Lv(s,l,f){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~f}function Bv(s){if(kp){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}kp=!1}ts=0,kn=Bt=lt=null,jc=!1,Pd=Rp=0,Vc=null}function mr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kn===null?lt.memoizedState=kn=s:kn=kn.next=s,kn}function yn(){if(Bt===null){var s=lt.alternate;s=s!==null?s.memoizedState:null}else s=Bt.next;var l=kn===null?lt.memoizedState:kn.next;if(l!==null)kn=l,Bt=s;else{if(s===null)throw lt.alternate===null?Error(r(467)):Error(r(310));Bt=s,s={memoizedState:Bt.memoizedState,baseState:Bt.baseState,baseQueue:Bt.baseQueue,queue:Bt.queue,next:null},kn===null?lt.memoizedState=kn=s:kn=kn.next=s}return kn}function Np(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function jd(s){var l=Pd;return Pd+=1,Vc===null&&(Vc=[]),s=FS(Vc,s,l),l=lt,(kn===null?l.memoizedState:kn.next)===null&&(l=l.alternate,q.H=l===null||l.memoizedState===null?ME:Zv),s}function Dp(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return jd(s);if(s.$$typeof===N)return Kn(s)}throw Error(r(438,String(s)))}function Uv(s){var l=null,f=lt.updateQueue;if(f!==null&&(l=f.memoCache),l==null){var g=lt.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(l={data:g.data.map(function(x){return x.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),f===null&&(f=Np(),lt.updateQueue=f),f.memoCache=l,f=l.data[l.index],f===void 0)for(f=l.data[l.index]=Array(s),g=0;g<s;g++)f[g]=V;return l.index++,f}function ns(s,l){return typeof l=="function"?l(s):l}function Ip(s){var l=yn();return Fv(l,Bt,s)}function Fv(s,l,f){var g=s.queue;if(g===null)throw Error(r(311));g.lastRenderedReducer=f;var x=s.baseQueue,_=g.pending;if(_!==null){if(x!==null){var I=x.next;x.next=_.next,_.next=I}l.baseQueue=x=_,g.pending=null}if(_=s.baseState,x===null)s.memoizedState=_;else{l=x.next;var $=I=null,J=null,fe=l,ve=!1;do{var we=fe.lane&-536870913;if(we!==fe.lane?(vt&we)===we:(ts&we)===we){var he=fe.revertLane;if(he===0)J!==null&&(J=J.next={lane:0,revertLane:0,gesture:null,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null}),we===Dc&&(ve=!0);else if((ts&he)===he){fe=fe.next,he===Dc&&(ve=!0);continue}else we={lane:0,revertLane:fe.revertLane,gesture:null,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null},J===null?($=J=we,I=_):J=J.next=we,lt.lanes|=he,ro|=he;we=fe.action,Cl&&f(_,we),_=fe.hasEagerState?fe.eagerState:f(_,we)}else he={lane:we,revertLane:fe.revertLane,gesture:fe.gesture,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null},J===null?($=J=he,I=_):J=J.next=he,lt.lanes|=we,ro|=we;fe=fe.next}while(fe!==null&&fe!==l);if(J===null?I=_:J.next=$,!qr(_,s.memoizedState)&&(Rn=!0,ve&&(f=Ic,f!==null)))throw f;s.memoizedState=_,s.baseState=I,s.baseQueue=J,g.lastRenderedState=_}return x===null&&(g.lanes=0),[s.memoizedState,g.dispatch]}function $v(s){var l=yn(),f=l.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=s;var g=f.dispatch,x=f.pending,_=l.memoizedState;if(x!==null){f.pending=null;var I=x=x.next;do _=s(_,I.action),I=I.next;while(I!==x);qr(_,l.memoizedState)||(Rn=!0),l.memoizedState=_,l.baseQueue===null&&(l.baseState=_),f.lastRenderedState=_}return[_,g]}function JS(s,l,f){var g=lt,x=yn(),_=St;if(_){if(f===void 0)throw Error(r(407));f=f()}else f=l();var I=!qr((Bt||x).memoizedState,f);if(I&&(x.memoizedState=f,Rn=!0),x=x.queue,qv(nE.bind(null,g,x,s),[s]),x.getSnapshot!==l||I||kn!==null&&kn.memoizedState.tag&1){if(g.flags|=2048,zc(9,{destroy:void 0},tE.bind(null,g,x,f,l),null),Ht===null)throw Error(r(349));_||(ts&127)!==0||eE(g,l,f)}return f}function eE(s,l,f){s.flags|=16384,s={getSnapshot:l,value:f},l=lt.updateQueue,l===null?(l=Np(),lt.updateQueue=l,l.stores=[s]):(f=l.stores,f===null?l.stores=[s]:f.push(s))}function tE(s,l,f,g){l.value=f,l.getSnapshot=g,rE(l)&&iE(s)}function nE(s,l,f){return f(function(){rE(l)&&iE(s)})}function rE(s){var l=s.getSnapshot;s=s.value;try{var f=l();return!qr(s,f)}catch{return!0}}function iE(s){var l=yl(s,2);l!==null&&Dr(l,s,2)}function Gv(s){var l=mr();if(typeof s=="function"){var f=s;if(s=f(),Cl){ar(!0);try{f()}finally{ar(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ns,lastRenderedState:s},l}function aE(s,l,f,g){return s.baseState=f,Fv(s,Bt,typeof g=="function"?g:ns)}function E3(s,l,f,g,x){if(Pp(s))throw Error(r(485));if(s=l.action,s!==null){var _={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(I){_.listeners.push(I)}};q.T!==null?f(!0):_.isTransition=!1,g(_),f=l.pending,f===null?(_.next=l.pending=_,sE(l,_)):(_.next=f.next,l.pending=f.next=_)}}function sE(s,l){var f=l.action,g=l.payload,x=s.state;if(l.isTransition){var _=q.T,I={};q.T=I;try{var $=f(x,g),J=q.S;J!==null&&J(I,$),oE(s,l,$)}catch(fe){Hv(s,l,fe)}finally{_!==null&&I.types!==null&&(_.types=I.types),q.T=_}}else try{_=f(x,g),oE(s,l,_)}catch(fe){Hv(s,l,fe)}}function oE(s,l,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(g){lE(s,l,g)},function(g){return Hv(s,l,g)}):lE(s,l,f)}function lE(s,l,f){l.status="fulfilled",l.value=f,cE(l),s.state=f,l=s.pending,l!==null&&(f=l.next,f===l?s.pending=null:(f=f.next,l.next=f,sE(s,f)))}function Hv(s,l,f){var g=s.pending;if(s.pending=null,g!==null){g=g.next;do l.status="rejected",l.reason=f,cE(l),l=l.next;while(l!==g)}s.action=null}function cE(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function uE(s,l){return l}function dE(s,l){if(St){var f=Ht.formState;if(f!==null){e:{var g=lt;if(St){if(Wt){t:{for(var x=Wt,_=pi;x.nodeType!==8;){if(!_){x=null;break t}if(x=mi(x.nextSibling),x===null){x=null;break t}}_=x.data,x=_==="F!"||_==="F"?x:null}if(x){Wt=mi(x.nextSibling),g=x.data==="F!";break e}}Xs(g)}g=!1}g&&(l=f[0])}}return f=mr(),f.memoizedState=f.baseState=l,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:uE,lastRenderedState:l},f.queue=g,f=NE.bind(null,lt,g),g.dispatch=f,g=Gv(!1),_=Qv.bind(null,lt,!1,g.queue),g=mr(),x={state:l,dispatch:null,action:s,pending:null},g.queue=x,f=E3.bind(null,lt,x,_,f),x.dispatch=f,g.memoizedState=s,[l,f,!1]}function fE(s){var l=yn();return hE(l,Bt,s)}function hE(s,l,f){if(l=Fv(s,l,uE)[0],s=Ip(ns)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var g=jd(l)}catch(I){throw I===Mc?_p:I}else g=l;l=yn();var x=l.queue,_=x.dispatch;return f!==l.memoizedState&&(lt.flags|=2048,zc(9,{destroy:void 0},T3.bind(null,x,f),null)),[g,_,s]}function T3(s,l){s.action=l}function pE(s){var l=yn(),f=Bt;if(f!==null)return hE(l,f,s);yn(),l=l.memoizedState,f=yn();var g=f.queue.dispatch;return f.memoizedState=s,[l,g,!1]}function zc(s,l,f,g){return s={tag:s,create:f,deps:g,inst:l,next:null},l=lt.updateQueue,l===null&&(l=Np(),lt.updateQueue=l),f=l.lastEffect,f===null?l.lastEffect=s.next=s:(g=f.next,f.next=s,s.next=g,l.lastEffect=s),s}function gE(){return yn().memoizedState}function Mp(s,l,f,g){var x=mr();lt.flags|=s,x.memoizedState=zc(1|l,{destroy:void 0},f,g===void 0?null:g)}function Op(s,l,f,g){var x=yn();g=g===void 0?null:g;var _=x.memoizedState.inst;Bt!==null&&g!==null&&jv(g,Bt.memoizedState.deps)?x.memoizedState=zc(l,_,f,g):(lt.flags|=s,x.memoizedState=zc(1|l,_,f,g))}function mE(s,l){Mp(8390656,8,s,l)}function qv(s,l){Op(2048,8,s,l)}function A3(s){lt.flags|=4;var l=lt.updateQueue;if(l===null)l=Np(),lt.updateQueue=l,l.events=[s];else{var f=l.events;f===null?l.events=[s]:f.push(s)}}function vE(s){var l=yn().memoizedState;return A3({ref:l,nextImpl:s}),function(){if((Dt&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}function yE(s,l){return Op(4,2,s,l)}function bE(s,l){return Op(4,4,s,l)}function xE(s,l){if(typeof l=="function"){s=s();var f=l(s);return function(){typeof f=="function"?f():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function wE(s,l,f){f=f!=null?f.concat([s]):null,Op(4,4,xE.bind(null,l,s),f)}function Yv(){}function _E(s,l){var f=yn();l=l===void 0?null:l;var g=f.memoizedState;return l!==null&&jv(l,g[1])?g[0]:(f.memoizedState=[s,l],s)}function SE(s,l){var f=yn();l=l===void 0?null:l;var g=f.memoizedState;if(l!==null&&jv(l,g[1]))return g[0];if(g=s(),Cl){ar(!0);try{s()}finally{ar(!1)}}return f.memoizedState=[g,l],g}function Xv(s,l,f){return f===void 0||(ts&1073741824)!==0&&(vt&261930)===0?s.memoizedState=l:(s.memoizedState=f,s=ET(),lt.lanes|=s,ro|=s,f)}function EE(s,l,f,g){return qr(f,l)?f:Pc.current!==null?(s=Xv(s,f,g),qr(s,l)||(Rn=!0),s):(ts&42)===0||(ts&1073741824)!==0&&(vt&261930)===0?(Rn=!0,s.memoizedState=f):(s=ET(),lt.lanes|=s,ro|=s,l)}function TE(s,l,f,g,x){var _=Q.p;Q.p=_!==0&&8>_?_:8;var I=q.T,$={};q.T=$,Qv(s,!1,l,f);try{var J=x(),fe=q.S;if(fe!==null&&fe($,J),J!==null&&typeof J=="object"&&typeof J.then=="function"){var ve=w3(J,g);Vd(s,l,ve,Zr(s))}else Vd(s,l,g,Zr(s))}catch(we){Vd(s,l,{then:function(){},status:"rejected",reason:we},Zr())}finally{Q.p=_,I!==null&&$.types!==null&&(I.types=$.types),q.T=I}}function C3(){}function Wv(s,l,f,g){if(s.tag!==5)throw Error(r(476));var x=AE(s).queue;TE(s,x,l,te,f===null?C3:function(){return CE(s),f(g)})}function AE(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:te,baseState:te,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ns,lastRenderedState:te},next:null};var f={};return l.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ns,lastRenderedState:f},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function CE(s){var l=AE(s);l.next===null&&(l=s.alternate.memoizedState),Vd(s,l.next.queue,{},Zr())}function Kv(){return Kn(ef)}function kE(){return yn().memoizedState}function RE(){return yn().memoizedState}function k3(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var f=Zr();s=Qs(f);var g=Zs(l,s,f);g!==null&&(Dr(g,l,f),Id(g,l,f)),l={cache:Tv()},s.payload=l;return}l=l.return}}function R3(s,l,f){var g=Zr();f={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Pp(s)?DE(l,f):(f=pv(s,l,f,g),f!==null&&(Dr(f,s,g),IE(f,l,g)))}function NE(s,l,f){var g=Zr();Vd(s,l,f,g)}function Vd(s,l,f,g){var x={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Pp(s))DE(l,x);else{var _=s.alternate;if(s.lanes===0&&(_===null||_.lanes===0)&&(_=l.lastRenderedReducer,_!==null))try{var I=l.lastRenderedState,$=_(I,f);if(x.hasEagerState=!0,x.eagerState=$,qr($,I))return gp(s,l,x,0),Ht===null&&pp(),!1}catch{}finally{}if(f=pv(s,l,x,g),f!==null)return Dr(f,s,g),IE(f,l,g),!0}return!1}function Qv(s,l,f,g){if(g={lane:2,revertLane:Ry(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Pp(s)){if(l)throw Error(r(479))}else l=pv(s,f,g,2),l!==null&&Dr(l,s,2)}function Pp(s){var l=s.alternate;return s===lt||l!==null&&l===lt}function DE(s,l){jc=kp=!0;var f=s.pending;f===null?l.next=l:(l.next=f.next,f.next=l),s.pending=l}function IE(s,l,f){if((f&4194048)!==0){var g=l.lanes;g&=s.pendingLanes,f|=g,l.lanes=f,ad(s,f)}}var zd={readContext:Kn,use:Dp,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useLayoutEffect:un,useInsertionEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useSyncExternalStore:un,useId:un,useHostTransitionStatus:un,useFormState:un,useActionState:un,useOptimistic:un,useMemoCache:un,useCacheRefresh:un};zd.useEffectEvent=un;var ME={readContext:Kn,use:Dp,useCallback:function(s,l){return mr().memoizedState=[s,l===void 0?null:l],s},useContext:Kn,useEffect:mE,useImperativeHandle:function(s,l,f){f=f!=null?f.concat([s]):null,Mp(4194308,4,xE.bind(null,l,s),f)},useLayoutEffect:function(s,l){return Mp(4194308,4,s,l)},useInsertionEffect:function(s,l){Mp(4,2,s,l)},useMemo:function(s,l){var f=mr();l=l===void 0?null:l;var g=s();if(Cl){ar(!0);try{s()}finally{ar(!1)}}return f.memoizedState=[g,l],g},useReducer:function(s,l,f){var g=mr();if(f!==void 0){var x=f(l);if(Cl){ar(!0);try{f(l)}finally{ar(!1)}}}else x=l;return g.memoizedState=g.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},g.queue=s,s=s.dispatch=R3.bind(null,lt,s),[g.memoizedState,s]},useRef:function(s){var l=mr();return s={current:s},l.memoizedState=s},useState:function(s){s=Gv(s);var l=s.queue,f=NE.bind(null,lt,l);return l.dispatch=f,[s.memoizedState,f]},useDebugValue:Yv,useDeferredValue:function(s,l){var f=mr();return Xv(f,s,l)},useTransition:function(){var s=Gv(!1);return s=TE.bind(null,lt,s.queue,!0,!1),mr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,f){var g=lt,x=mr();if(St){if(f===void 0)throw Error(r(407));f=f()}else{if(f=l(),Ht===null)throw Error(r(349));(vt&127)!==0||eE(g,l,f)}x.memoizedState=f;var _={value:f,getSnapshot:l};return x.queue=_,mE(nE.bind(null,g,_,s),[s]),g.flags|=2048,zc(9,{destroy:void 0},tE.bind(null,g,_,f,l),null),f},useId:function(){var s=mr(),l=Ht.identifierPrefix;if(St){var f=wa,g=xa;f=(g&~(1<<32-tn(g)-1)).toString(32)+f,l="_"+l+"R_"+f,f=Rp++,0<f&&(l+="H"+f.toString(32)),l+="_"}else f=_3++,l="_"+l+"r_"+f.toString(32)+"_";return s.memoizedState=l},useHostTransitionStatus:Kv,useFormState:dE,useActionState:dE,useOptimistic:function(s){var l=mr();l.memoizedState=l.baseState=s;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=f,l=Qv.bind(null,lt,!0,f),f.dispatch=l,[s,l]},useMemoCache:Uv,useCacheRefresh:function(){return mr().memoizedState=k3.bind(null,lt)},useEffectEvent:function(s){var l=mr(),f={impl:s};return l.memoizedState=f,function(){if((Dt&2)!==0)throw Error(r(440));return f.impl.apply(void 0,arguments)}}},Zv={readContext:Kn,use:Dp,useCallback:_E,useContext:Kn,useEffect:qv,useImperativeHandle:wE,useInsertionEffect:yE,useLayoutEffect:bE,useMemo:SE,useReducer:Ip,useRef:gE,useState:function(){return Ip(ns)},useDebugValue:Yv,useDeferredValue:function(s,l){var f=yn();return EE(f,Bt.memoizedState,s,l)},useTransition:function(){var s=Ip(ns)[0],l=yn().memoizedState;return[typeof s=="boolean"?s:jd(s),l]},useSyncExternalStore:JS,useId:kE,useHostTransitionStatus:Kv,useFormState:fE,useActionState:fE,useOptimistic:function(s,l){var f=yn();return aE(f,Bt,s,l)},useMemoCache:Uv,useCacheRefresh:RE};Zv.useEffectEvent=vE;var OE={readContext:Kn,use:Dp,useCallback:_E,useContext:Kn,useEffect:qv,useImperativeHandle:wE,useInsertionEffect:yE,useLayoutEffect:bE,useMemo:SE,useReducer:$v,useRef:gE,useState:function(){return $v(ns)},useDebugValue:Yv,useDeferredValue:function(s,l){var f=yn();return Bt===null?Xv(f,s,l):EE(f,Bt.memoizedState,s,l)},useTransition:function(){var s=$v(ns)[0],l=yn().memoizedState;return[typeof s=="boolean"?s:jd(s),l]},useSyncExternalStore:JS,useId:kE,useHostTransitionStatus:Kv,useFormState:pE,useActionState:pE,useOptimistic:function(s,l){var f=yn();return Bt!==null?aE(f,Bt,s,l):(f.baseState=s,[s,f.queue.dispatch])},useMemoCache:Uv,useCacheRefresh:RE};OE.useEffectEvent=vE;function Jv(s,l,f,g){l=s.memoizedState,f=f(g,l),f=f==null?l:p({},l,f),s.memoizedState=f,s.lanes===0&&(s.updateQueue.baseState=f)}var ey={enqueueSetState:function(s,l,f){s=s._reactInternals;var g=Zr(),x=Qs(g);x.payload=l,f!=null&&(x.callback=f),l=Zs(s,x,g),l!==null&&(Dr(l,s,g),Id(l,s,g))},enqueueReplaceState:function(s,l,f){s=s._reactInternals;var g=Zr(),x=Qs(g);x.tag=1,x.payload=l,f!=null&&(x.callback=f),l=Zs(s,x,g),l!==null&&(Dr(l,s,g),Id(l,s,g))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var f=Zr(),g=Qs(f);g.tag=2,l!=null&&(g.callback=l),l=Zs(s,g,f),l!==null&&(Dr(l,s,f),Id(l,s,f))}};function PE(s,l,f,g,x,_,I){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(g,_,I):l.prototype&&l.prototype.isPureReactComponent?!Ed(f,g)||!Ed(x,_):!0}function jE(s,l,f,g){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,g),l.state!==s&&ey.enqueueReplaceState(l,l.state,null)}function kl(s,l){var f=l;if("ref"in l){f={};for(var g in l)g!=="ref"&&(f[g]=l[g])}if(s=s.defaultProps){f===l&&(f=p({},f));for(var x in s)f[x]===void 0&&(f[x]=s[x])}return f}function VE(s){hp(s)}function zE(s){console.error(s)}function LE(s){hp(s)}function jp(s,l){try{var f=s.onUncaughtError;f(l.value,{componentStack:l.stack})}catch(g){setTimeout(function(){throw g})}}function BE(s,l,f){try{var g=s.onCaughtError;g(f.value,{componentStack:f.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function ty(s,l,f){return f=Qs(f),f.tag=3,f.payload={element:null},f.callback=function(){jp(s,l)},f}function UE(s){return s=Qs(s),s.tag=3,s}function FE(s,l,f,g){var x=f.type.getDerivedStateFromError;if(typeof x=="function"){var _=g.value;s.payload=function(){return x(_)},s.callback=function(){BE(l,f,g)}}var I=f.stateNode;I!==null&&typeof I.componentDidCatch=="function"&&(s.callback=function(){BE(l,f,g),typeof x!="function"&&(io===null?io=new Set([this]):io.add(this));var $=g.stack;this.componentDidCatch(g.value,{componentStack:$!==null?$:""})})}function N3(s,l,f,g,x){if(f.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(l=f.alternate,l!==null&&Nc(l,f,x,!0),f=Xr.current,f!==null){switch(f.tag){case 31:case 13:return gi===null?Xp():f.alternate===null&&dn===0&&(dn=3),f.flags&=-257,f.flags|=65536,f.lanes=x,g===Sp?f.flags|=16384:(l=f.updateQueue,l===null?f.updateQueue=new Set([g]):l.add(g),Ay(s,g,x)),!1;case 22:return f.flags|=65536,g===Sp?f.flags|=16384:(l=f.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([g])},f.updateQueue=l):(f=l.retryQueue,f===null?l.retryQueue=new Set([g]):f.add(g)),Ay(s,g,x)),!1}throw Error(r(435,f.tag))}return Ay(s,g,x),Xp(),!1}if(St)return l=Xr.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=x,g!==xv&&(s=Error(r(422),{cause:g}),Cd(di(s,f)))):(g!==xv&&(l=Error(r(423),{cause:g}),Cd(di(l,f))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,g=di(g,f),x=ty(s.stateNode,g,x),Dv(s,x),dn!==4&&(dn=2)),!1;var _=Error(r(520),{cause:g});if(_=di(_,f),qd===null?qd=[_]:qd.push(_),dn!==4&&(dn=2),l===null)return!0;g=di(g,f),f=l;do{switch(f.tag){case 3:return f.flags|=65536,s=x&-x,f.lanes|=s,s=ty(f.stateNode,g,s),Dv(f,s),!1;case 1:if(l=f.type,_=f.stateNode,(f.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(io===null||!io.has(_))))return f.flags|=65536,x&=-x,f.lanes|=x,x=UE(x),FE(x,s,f,g),Dv(f,x),!1}f=f.return}while(f!==null);return!1}var ny=Error(r(461)),Rn=!1;function Qn(s,l,f,g){l.child=s===null?qS(l,null,f,g):Al(l,s.child,f,g)}function $E(s,l,f,g,x){f=f.render;var _=l.ref;if("ref"in g){var I={};for(var $ in g)$!=="ref"&&(I[$]=g[$])}else I=g;return _l(l),g=Vv(s,l,f,I,_,x),$=zv(),s!==null&&!Rn?(Lv(s,l,x),rs(s,l,x)):(St&&$&&yv(l),l.flags|=1,Qn(s,l,g,x),l.child)}function GE(s,l,f,g,x){if(s===null){var _=f.type;return typeof _=="function"&&!gv(_)&&_.defaultProps===void 0&&f.compare===null?(l.tag=15,l.type=_,HE(s,l,_,g,x)):(s=vp(f.type,null,g,l,l.mode,x),s.ref=l.ref,s.return=l,l.child=s)}if(_=s.child,!uy(s,x)){var I=_.memoizedProps;if(f=f.compare,f=f!==null?f:Ed,f(I,g)&&s.ref===l.ref)return rs(s,l,x)}return l.flags|=1,s=Qa(_,g),s.ref=l.ref,s.return=l,l.child=s}function HE(s,l,f,g,x){if(s!==null){var _=s.memoizedProps;if(Ed(_,g)&&s.ref===l.ref)if(Rn=!1,l.pendingProps=g=_,uy(s,x))(s.flags&131072)!==0&&(Rn=!0);else return l.lanes=s.lanes,rs(s,l,x)}return ry(s,l,f,g,x)}function qE(s,l,f,g){var x=g.children,_=s!==null?s.memoizedState:null;if(s===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((l.flags&128)!==0){if(_=_!==null?_.baseLanes|f:f,s!==null){for(g=l.child=s.child,x=0;g!==null;)x=x|g.lanes|g.childLanes,g=g.sibling;g=x&~_}else g=0,l.child=null;return YE(s,l,_,f,g)}if((f&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&wp(l,_!==null?_.cachePool:null),_!==null?WS(l,_):Mv(),KS(l);else return g=l.lanes=536870912,YE(s,l,_!==null?_.baseLanes|f:f,f,g)}else _!==null?(wp(l,_.cachePool),WS(l,_),eo(),l.memoizedState=null):(s!==null&&wp(l,null),Mv(),eo());return Qn(s,l,x,f),l.child}function Ld(s,l){return s!==null&&s.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function YE(s,l,f,g,x){var _=Cv();return _=_===null?null:{parent:Cn._currentValue,pool:_},l.memoizedState={baseLanes:f,cachePool:_},s!==null&&wp(l,null),Mv(),KS(l),s!==null&&Nc(s,l,g,!0),l.childLanes=x,null}function Vp(s,l){return l=Lp({mode:l.mode,children:l.children},s.mode),l.ref=s.ref,s.child=l,l.return=s,l}function XE(s,l,f){return Al(l,s.child,null,f),s=Vp(l,l.pendingProps),s.flags|=2,Wr(l),l.memoizedState=null,s}function D3(s,l,f){var g=l.pendingProps,x=(l.flags&128)!==0;if(l.flags&=-129,s===null){if(St){if(g.mode==="hidden")return s=Vp(l,g),l.lanes=536870912,Ld(null,s);if(Pv(l),(s=Wt)?(s=sA(s,pi),s=s!==null&&s.data==="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:qs!==null?{id:xa,overflow:wa}:null,retryLane:536870912,hydrationErrors:null},f=DS(s),f.return=l,l.child=f,Wn=l,Wt=null)):s=null,s===null)throw Xs(l);return l.lanes=536870912,null}return Vp(l,g)}var _=s.memoizedState;if(_!==null){var I=_.dehydrated;if(Pv(l),x)if(l.flags&256)l.flags&=-257,l=XE(s,l,f);else if(l.memoizedState!==null)l.child=s.child,l.flags|=128,l=null;else throw Error(r(558));else if(Rn||Nc(s,l,f,!1),x=(f&s.childLanes)!==0,Rn||x){if(g=Ht,g!==null&&(I=sd(g,f),I!==0&&I!==_.retryLane))throw _.retryLane=I,yl(s,I),Dr(g,s,I),ny;Xp(),l=XE(s,l,f)}else s=_.treeContext,Wt=mi(I.nextSibling),Wn=l,St=!0,Ys=null,pi=!1,s!==null&&OS(l,s),l=Vp(l,g),l.flags|=4096;return l}return s=Qa(s.child,{mode:g.mode,children:g.children}),s.ref=l.ref,l.child=s,s.return=l,s}function zp(s,l){var f=l.ref;if(f===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(r(284));(s===null||s.ref!==f)&&(l.flags|=4194816)}}function ry(s,l,f,g,x){return _l(l),f=Vv(s,l,f,g,void 0,x),g=zv(),s!==null&&!Rn?(Lv(s,l,x),rs(s,l,x)):(St&&g&&yv(l),l.flags|=1,Qn(s,l,f,x),l.child)}function WE(s,l,f,g,x,_){return _l(l),l.updateQueue=null,f=ZS(l,g,f,x),QS(s),g=zv(),s!==null&&!Rn?(Lv(s,l,_),rs(s,l,_)):(St&&g&&yv(l),l.flags|=1,Qn(s,l,f,_),l.child)}function KE(s,l,f,g,x){if(_l(l),l.stateNode===null){var _=Ac,I=f.contextType;typeof I=="object"&&I!==null&&(_=Kn(I)),_=new f(g,_),l.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=ey,l.stateNode=_,_._reactInternals=l,_=l.stateNode,_.props=g,_.state=l.memoizedState,_.refs={},Rv(l),I=f.contextType,_.context=typeof I=="object"&&I!==null?Kn(I):Ac,_.state=l.memoizedState,I=f.getDerivedStateFromProps,typeof I=="function"&&(Jv(l,f,I,g),_.state=l.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(I=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),I!==_.state&&ey.enqueueReplaceState(_,_.state,null),Od(l,g,_,x),Md(),_.state=l.memoizedState),typeof _.componentDidMount=="function"&&(l.flags|=4194308),g=!0}else if(s===null){_=l.stateNode;var $=l.memoizedProps,J=kl(f,$);_.props=J;var fe=_.context,ve=f.contextType;I=Ac,typeof ve=="object"&&ve!==null&&(I=Kn(ve));var we=f.getDerivedStateFromProps;ve=typeof we=="function"||typeof _.getSnapshotBeforeUpdate=="function",$=l.pendingProps!==$,ve||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||($||fe!==I)&&jE(l,_,g,I),Ks=!1;var he=l.memoizedState;_.state=he,Od(l,g,_,x),Md(),fe=l.memoizedState,$||he!==fe||Ks?(typeof we=="function"&&(Jv(l,f,we,g),fe=l.memoizedState),(J=Ks||PE(l,f,J,g,he,fe,I))?(ve||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(l.flags|=4194308)):(typeof _.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=fe),_.props=g,_.state=fe,_.context=I,g=J):(typeof _.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{_=l.stateNode,Nv(s,l),I=l.memoizedProps,ve=kl(f,I),_.props=ve,we=l.pendingProps,he=_.context,fe=f.contextType,J=Ac,typeof fe=="object"&&fe!==null&&(J=Kn(fe)),$=f.getDerivedStateFromProps,(fe=typeof $=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(I!==we||he!==J)&&jE(l,_,g,J),Ks=!1,he=l.memoizedState,_.state=he,Od(l,g,_,x),Md();var me=l.memoizedState;I!==we||he!==me||Ks||s!==null&&s.dependencies!==null&&bp(s.dependencies)?(typeof $=="function"&&(Jv(l,f,$,g),me=l.memoizedState),(ve=Ks||PE(l,f,ve,g,he,me,J)||s!==null&&s.dependencies!==null&&bp(s.dependencies))?(fe||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(g,me,J),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(g,me,J)),typeof _.componentDidUpdate=="function"&&(l.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof _.componentDidUpdate!="function"||I===s.memoizedProps&&he===s.memoizedState||(l.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||I===s.memoizedProps&&he===s.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=me),_.props=g,_.state=me,_.context=J,g=ve):(typeof _.componentDidUpdate!="function"||I===s.memoizedProps&&he===s.memoizedState||(l.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||I===s.memoizedProps&&he===s.memoizedState||(l.flags|=1024),g=!1)}return _=g,zp(s,l),g=(l.flags&128)!==0,_||g?(_=l.stateNode,f=g&&typeof f.getDerivedStateFromError!="function"?null:_.render(),l.flags|=1,s!==null&&g?(l.child=Al(l,s.child,null,x),l.child=Al(l,null,f,x)):Qn(s,l,f,x),l.memoizedState=_.state,s=l.child):s=rs(s,l,x),s}function QE(s,l,f,g){return xl(),l.flags|=256,Qn(s,l,f,g),l.child}var iy={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ay(s){return{baseLanes:s,cachePool:BS()}}function sy(s,l,f){return s=s!==null?s.childLanes&~f:0,l&&(s|=Qr),s}function ZE(s,l,f){var g=l.pendingProps,x=!1,_=(l.flags&128)!==0,I;if((I=_)||(I=s!==null&&s.memoizedState===null?!1:(vn.current&2)!==0),I&&(x=!0,l.flags&=-129),I=(l.flags&32)!==0,l.flags&=-33,s===null){if(St){if(x?Js(l):eo(),(s=Wt)?(s=sA(s,pi),s=s!==null&&s.data!=="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:qs!==null?{id:xa,overflow:wa}:null,retryLane:536870912,hydrationErrors:null},f=DS(s),f.return=l,l.child=f,Wn=l,Wt=null)):s=null,s===null)throw Xs(l);return Fy(s)?l.lanes=32:l.lanes=536870912,null}var $=g.children;return g=g.fallback,x?(eo(),x=l.mode,$=Lp({mode:"hidden",children:$},x),g=bl(g,x,f,null),$.return=l,g.return=l,$.sibling=g,l.child=$,g=l.child,g.memoizedState=ay(f),g.childLanes=sy(s,I,f),l.memoizedState=iy,Ld(null,g)):(Js(l),oy(l,$))}var J=s.memoizedState;if(J!==null&&($=J.dehydrated,$!==null)){if(_)l.flags&256?(Js(l),l.flags&=-257,l=ly(s,l,f)):l.memoizedState!==null?(eo(),l.child=s.child,l.flags|=128,l=null):(eo(),$=g.fallback,x=l.mode,g=Lp({mode:"visible",children:g.children},x),$=bl($,x,f,null),$.flags|=2,g.return=l,$.return=l,g.sibling=$,l.child=g,Al(l,s.child,null,f),g=l.child,g.memoizedState=ay(f),g.childLanes=sy(s,I,f),l.memoizedState=iy,l=Ld(null,g));else if(Js(l),Fy($)){if(I=$.nextSibling&&$.nextSibling.dataset,I)var fe=I.dgst;I=fe,g=Error(r(419)),g.stack="",g.digest=I,Cd({value:g,source:null,stack:null}),l=ly(s,l,f)}else if(Rn||Nc(s,l,f,!1),I=(f&s.childLanes)!==0,Rn||I){if(I=Ht,I!==null&&(g=sd(I,f),g!==0&&g!==J.retryLane))throw J.retryLane=g,yl(s,g),Dr(I,s,g),ny;Uy($)||Xp(),l=ly(s,l,f)}else Uy($)?(l.flags|=192,l.child=s.child,l=null):(s=J.treeContext,Wt=mi($.nextSibling),Wn=l,St=!0,Ys=null,pi=!1,s!==null&&OS(l,s),l=oy(l,g.children),l.flags|=4096);return l}return x?(eo(),$=g.fallback,x=l.mode,J=s.child,fe=J.sibling,g=Qa(J,{mode:"hidden",children:g.children}),g.subtreeFlags=J.subtreeFlags&65011712,fe!==null?$=Qa(fe,$):($=bl($,x,f,null),$.flags|=2),$.return=l,g.return=l,g.sibling=$,l.child=g,Ld(null,g),g=l.child,$=s.child.memoizedState,$===null?$=ay(f):(x=$.cachePool,x!==null?(J=Cn._currentValue,x=x.parent!==J?{parent:J,pool:J}:x):x=BS(),$={baseLanes:$.baseLanes|f,cachePool:x}),g.memoizedState=$,g.childLanes=sy(s,I,f),l.memoizedState=iy,Ld(s.child,g)):(Js(l),f=s.child,s=f.sibling,f=Qa(f,{mode:"visible",children:g.children}),f.return=l,f.sibling=null,s!==null&&(I=l.deletions,I===null?(l.deletions=[s],l.flags|=16):I.push(s)),l.child=f,l.memoizedState=null,f)}function oy(s,l){return l=Lp({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function Lp(s,l){return s=Yr(22,s,null,l),s.lanes=0,s}function ly(s,l,f){return Al(l,s.child,null,f),s=oy(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function JE(s,l,f){s.lanes|=l;var g=s.alternate;g!==null&&(g.lanes|=l),Sv(s.return,l,f)}function cy(s,l,f,g,x,_){var I=s.memoizedState;I===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:x,treeForkCount:_}:(I.isBackwards=l,I.rendering=null,I.renderingStartTime=0,I.last=g,I.tail=f,I.tailMode=x,I.treeForkCount=_)}function eT(s,l,f){var g=l.pendingProps,x=g.revealOrder,_=g.tail;g=g.children;var I=vn.current,$=(I&2)!==0;if($?(I=I&1|2,l.flags|=128):I&=1,Z(vn,I),Qn(s,l,g,f),g=St?Ad:0,!$&&s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&JE(s,f,l);else if(s.tag===19)JE(s,f,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(x){case"forwards":for(f=l.child,x=null;f!==null;)s=f.alternate,s!==null&&Cp(s)===null&&(x=f),f=f.sibling;f=x,f===null?(x=l.child,l.child=null):(x=f.sibling,f.sibling=null),cy(l,!1,x,f,_,g);break;case"backwards":case"unstable_legacy-backwards":for(f=null,x=l.child,l.child=null;x!==null;){if(s=x.alternate,s!==null&&Cp(s)===null){l.child=x;break}s=x.sibling,x.sibling=f,f=x,x=s}cy(l,!0,f,null,_,g);break;case"together":cy(l,!1,null,null,void 0,g);break;default:l.memoizedState=null}return l.child}function rs(s,l,f){if(s!==null&&(l.dependencies=s.dependencies),ro|=l.lanes,(f&l.childLanes)===0)if(s!==null){if(Nc(s,l,f,!1),(f&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(r(153));if(l.child!==null){for(s=l.child,f=Qa(s,s.pendingProps),l.child=f,f.return=l;s.sibling!==null;)s=s.sibling,f=f.sibling=Qa(s,s.pendingProps),f.return=l;f.sibling=null}return l.child}function uy(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&bp(s)))}function I3(s,l,f){switch(l.tag){case 3:ce(l,l.stateNode.containerInfo),Ws(l,Cn,s.memoizedState.cache),xl();break;case 27:case 5:Re(l);break;case 4:ce(l,l.stateNode.containerInfo);break;case 10:Ws(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,Pv(l),null;break;case 13:var g=l.memoizedState;if(g!==null)return g.dehydrated!==null?(Js(l),l.flags|=128,null):(f&l.child.childLanes)!==0?ZE(s,l,f):(Js(l),s=rs(s,l,f),s!==null?s.sibling:null);Js(l);break;case 19:var x=(s.flags&128)!==0;if(g=(f&l.childLanes)!==0,g||(Nc(s,l,f,!1),g=(f&l.childLanes)!==0),x){if(g)return eT(s,l,f);l.flags|=128}if(x=l.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),Z(vn,vn.current),g)break;return null;case 22:return l.lanes=0,qE(s,l,f,l.pendingProps);case 24:Ws(l,Cn,s.memoizedState.cache)}return rs(s,l,f)}function tT(s,l,f){if(s!==null)if(s.memoizedProps!==l.pendingProps)Rn=!0;else{if(!uy(s,f)&&(l.flags&128)===0)return Rn=!1,I3(s,l,f);Rn=(s.flags&131072)!==0}else Rn=!1,St&&(l.flags&1048576)!==0&&MS(l,Ad,l.index);switch(l.lanes=0,l.tag){case 16:e:{var g=l.pendingProps;if(s=El(l.elementType),l.type=s,typeof s=="function")gv(s)?(g=kl(s,g),l.tag=1,l=KE(null,l,s,g,f)):(l.tag=0,l=ry(null,l,s,g,f));else{if(s!=null){var x=s.$$typeof;if(x===j){l.tag=11,l=$E(null,l,s,g,f);break e}else if(x===A){l.tag=14,l=GE(null,l,s,g,f);break e}}throw l=K(s)||s,Error(r(306,l,""))}}return l;case 0:return ry(s,l,l.type,l.pendingProps,f);case 1:return g=l.type,x=kl(g,l.pendingProps),KE(s,l,g,x,f);case 3:e:{if(ce(l,l.stateNode.containerInfo),s===null)throw Error(r(387));g=l.pendingProps;var _=l.memoizedState;x=_.element,Nv(s,l),Od(l,g,null,f);var I=l.memoizedState;if(g=I.cache,Ws(l,Cn,g),g!==_.cache&&Ev(l,[Cn],f,!0),Md(),g=I.element,_.isDehydrated)if(_={element:g,isDehydrated:!1,cache:I.cache},l.updateQueue.baseState=_,l.memoizedState=_,l.flags&256){l=QE(s,l,g,f);break e}else if(g!==x){x=di(Error(r(424)),l),Cd(x),l=QE(s,l,g,f);break e}else{switch(s=l.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Wt=mi(s.firstChild),Wn=l,St=!0,Ys=null,pi=!0,f=qS(l,null,g,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(xl(),g===x){l=rs(s,l,f);break e}Qn(s,l,g,f)}l=l.child}return l;case 26:return zp(s,l),s===null?(f=fA(l.type,null,l.pendingProps,null))?l.memoizedState=f:St||(f=l.type,s=l.pendingProps,g=tg(ie.current).createElement(f),g[En]=l,g[Gn]=s,Zn(g,f,s),Tn(g),l.stateNode=g):l.memoizedState=fA(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return Re(l),s===null&&St&&(g=l.stateNode=cA(l.type,l.pendingProps,ie.current),Wn=l,pi=!0,x=Wt,lo(l.type)?($y=x,Wt=mi(g.firstChild)):Wt=x),Qn(s,l,l.pendingProps.children,f),zp(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&St&&((x=g=Wt)&&(g=lj(g,l.type,l.pendingProps,pi),g!==null?(l.stateNode=g,Wn=l,Wt=mi(g.firstChild),pi=!1,x=!0):x=!1),x||Xs(l)),Re(l),x=l.type,_=l.pendingProps,I=s!==null?s.memoizedProps:null,g=_.children,zy(x,_)?g=null:I!==null&&zy(x,I)&&(l.flags|=32),l.memoizedState!==null&&(x=Vv(s,l,S3,null,null,f),ef._currentValue=x),zp(s,l),Qn(s,l,g,f),l.child;case 6:return s===null&&St&&((s=f=Wt)&&(f=cj(f,l.pendingProps,pi),f!==null?(l.stateNode=f,Wn=l,Wt=null,s=!0):s=!1),s||Xs(l)),null;case 13:return ZE(s,l,f);case 4:return ce(l,l.stateNode.containerInfo),g=l.pendingProps,s===null?l.child=Al(l,null,g,f):Qn(s,l,g,f),l.child;case 11:return $E(s,l,l.type,l.pendingProps,f);case 7:return Qn(s,l,l.pendingProps,f),l.child;case 8:return Qn(s,l,l.pendingProps.children,f),l.child;case 12:return Qn(s,l,l.pendingProps.children,f),l.child;case 10:return g=l.pendingProps,Ws(l,l.type,g.value),Qn(s,l,g.children,f),l.child;case 9:return x=l.type._context,g=l.pendingProps.children,_l(l),x=Kn(x),g=g(x),l.flags|=1,Qn(s,l,g,f),l.child;case 14:return GE(s,l,l.type,l.pendingProps,f);case 15:return HE(s,l,l.type,l.pendingProps,f);case 19:return eT(s,l,f);case 31:return D3(s,l,f);case 22:return qE(s,l,f,l.pendingProps);case 24:return _l(l),g=Kn(Cn),s===null?(x=Cv(),x===null&&(x=Ht,_=Tv(),x.pooledCache=_,_.refCount++,_!==null&&(x.pooledCacheLanes|=f),x=_),l.memoizedState={parent:g,cache:x},Rv(l),Ws(l,Cn,x)):((s.lanes&f)!==0&&(Nv(s,l),Od(l,null,null,f),Md()),x=s.memoizedState,_=l.memoizedState,x.parent!==g?(x={parent:g,cache:g},l.memoizedState=x,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=x),Ws(l,Cn,g)):(g=_.cache,Ws(l,Cn,g),g!==x.cache&&Ev(l,[Cn],f,!0))),Qn(s,l,l.pendingProps.children,f),l.child;case 29:throw l.pendingProps}throw Error(r(156,l.tag))}function is(s){s.flags|=4}function dy(s,l,f,g,x){if((l=(s.mode&32)!==0)&&(l=!1),l){if(s.flags|=16777216,(x&335544128)===x)if(s.stateNode.complete)s.flags|=8192;else if(kT())s.flags|=8192;else throw Tl=Sp,kv}else s.flags&=-16777217}function nT(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!vA(l))if(kT())s.flags|=8192;else throw Tl=Sp,kv}function Bp(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?qh():536870912,s.lanes|=l,Fc|=l)}function Bd(s,l){if(!St)switch(s.tailMode){case"hidden":l=s.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s.tail=null:f.sibling=null;break;case"collapsed":f=s.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:g.sibling=null}}function Kt(s){var l=s.alternate!==null&&s.alternate.child===s.child,f=0,g=0;if(l)for(var x=s.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags&65011712,g|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags,g|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=g,s.childLanes=f,l}function M3(s,l,f){var g=l.pendingProps;switch(bv(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kt(l),null;case 1:return Kt(l),null;case 3:return f=l.stateNode,g=null,s!==null&&(g=s.memoizedState.cache),l.memoizedState.cache!==g&&(l.flags|=2048),es(Cn),xe(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(Rc(l)?is(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,wv())),Kt(l),null;case 26:var x=l.type,_=l.memoizedState;return s===null?(is(l),_!==null?(Kt(l),nT(l,_)):(Kt(l),dy(l,x,null,g,f))):_?_!==s.memoizedState?(is(l),Kt(l),nT(l,_)):(Kt(l),l.flags&=-16777217):(s=s.memoizedProps,s!==g&&is(l),Kt(l),dy(l,x,s,g,f)),null;case 27:if(ae(l),f=ie.current,x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==g&&is(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return Kt(l),null}s=W.current,Rc(l)?PS(l):(s=cA(x,g,f),l.stateNode=s,is(l))}return Kt(l),null;case 5:if(ae(l),x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==g&&is(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return Kt(l),null}if(_=W.current,Rc(l))PS(l);else{var I=tg(ie.current);switch(_){case 1:_=I.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:_=I.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":_=I.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":_=I.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":_=I.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof g.is=="string"?I.createElement("select",{is:g.is}):I.createElement("select"),g.multiple?_.multiple=!0:g.size&&(_.size=g.size);break;default:_=typeof g.is=="string"?I.createElement(x,{is:g.is}):I.createElement(x)}}_[En]=l,_[Gn]=g;e:for(I=l.child;I!==null;){if(I.tag===5||I.tag===6)_.appendChild(I.stateNode);else if(I.tag!==4&&I.tag!==27&&I.child!==null){I.child.return=I,I=I.child;continue}if(I===l)break e;for(;I.sibling===null;){if(I.return===null||I.return===l)break e;I=I.return}I.sibling.return=I.return,I=I.sibling}l.stateNode=_;e:switch(Zn(_,x,g),x){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&is(l)}}return Kt(l),dy(l,l.type,s===null?null:s.memoizedProps,l.pendingProps,f),null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==g&&is(l);else{if(typeof g!="string"&&l.stateNode===null)throw Error(r(166));if(s=ie.current,Rc(l)){if(s=l.stateNode,f=l.memoizedProps,g=null,x=Wn,x!==null)switch(x.tag){case 27:case 5:g=x.memoizedProps}s[En]=l,s=!!(s.nodeValue===f||g!==null&&g.suppressHydrationWarning===!0||ZT(s.nodeValue,f)),s||Xs(l,!0)}else s=tg(s).createTextNode(g),s[En]=l,l.stateNode=s}return Kt(l),null;case 31:if(f=l.memoizedState,s===null||s.memoizedState!==null){if(g=Rc(l),f!==null){if(s===null){if(!g)throw Error(r(318));if(s=l.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(557));s[En]=l}else xl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Kt(l),s=!1}else f=wv(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),s=!0;if(!s)return l.flags&256?(Wr(l),l):(Wr(l),null);if((l.flags&128)!==0)throw Error(r(558))}return Kt(l),null;case 13:if(g=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=Rc(l),g!==null&&g.dehydrated!==null){if(s===null){if(!x)throw Error(r(318));if(x=l.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[En]=l}else xl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Kt(l),x=!1}else x=wv(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return l.flags&256?(Wr(l),l):(Wr(l),null)}return Wr(l),(l.flags&128)!==0?(l.lanes=f,l):(f=g!==null,s=s!==null&&s.memoizedState!==null,f&&(g=l.child,x=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(x=g.alternate.memoizedState.cachePool.pool),_=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(_=g.memoizedState.cachePool.pool),_!==x&&(g.flags|=2048)),f!==s&&f&&(l.child.flags|=8192),Bp(l,l.updateQueue),Kt(l),null);case 4:return xe(),s===null&&My(l.stateNode.containerInfo),Kt(l),null;case 10:return es(l.type),Kt(l),null;case 19:if(Y(vn),g=l.memoizedState,g===null)return Kt(l),null;if(x=(l.flags&128)!==0,_=g.rendering,_===null)if(x)Bd(g,!1);else{if(dn!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(_=Cp(s),_!==null){for(l.flags|=128,Bd(g,!1),s=_.updateQueue,l.updateQueue=s,Bp(l,s),l.subtreeFlags=0,s=f,f=l.child;f!==null;)NS(f,s),f=f.sibling;return Z(vn,vn.current&1|2),St&&Za(l,g.treeForkCount),l.child}s=s.sibling}g.tail!==null&&ut()>Hp&&(l.flags|=128,x=!0,Bd(g,!1),l.lanes=4194304)}else{if(!x)if(s=Cp(_),s!==null){if(l.flags|=128,x=!0,s=s.updateQueue,l.updateQueue=s,Bp(l,s),Bd(g,!0),g.tail===null&&g.tailMode==="hidden"&&!_.alternate&&!St)return Kt(l),null}else 2*ut()-g.renderingStartTime>Hp&&f!==536870912&&(l.flags|=128,x=!0,Bd(g,!1),l.lanes=4194304);g.isBackwards?(_.sibling=l.child,l.child=_):(s=g.last,s!==null?s.sibling=_:l.child=_,g.last=_)}return g.tail!==null?(s=g.tail,g.rendering=s,g.tail=s.sibling,g.renderingStartTime=ut(),s.sibling=null,f=vn.current,Z(vn,x?f&1|2:f&1),St&&Za(l,g.treeForkCount),s):(Kt(l),null);case 22:case 23:return Wr(l),Ov(),g=l.memoizedState!==null,s!==null?s.memoizedState!==null!==g&&(l.flags|=8192):g&&(l.flags|=8192),g?(f&536870912)!==0&&(l.flags&128)===0&&(Kt(l),l.subtreeFlags&6&&(l.flags|=8192)):Kt(l),f=l.updateQueue,f!==null&&Bp(l,f.retryQueue),f=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),g=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),g!==f&&(l.flags|=2048),s!==null&&Y(Sl),null;case 24:return f=null,s!==null&&(f=s.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),es(Cn),Kt(l),null;case 25:return null;case 30:return null}throw Error(r(156,l.tag))}function O3(s,l){switch(bv(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return es(Cn),xe(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return ae(l),null;case 31:if(l.memoizedState!==null){if(Wr(l),l.alternate===null)throw Error(r(340));xl()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 13:if(Wr(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(r(340));xl()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return Y(vn),null;case 4:return xe(),null;case 10:return es(l.type),null;case 22:case 23:return Wr(l),Ov(),s!==null&&Y(Sl),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return es(Cn),null;case 25:return null;default:return null}}function rT(s,l){switch(bv(l),l.tag){case 3:es(Cn),xe();break;case 26:case 27:case 5:ae(l);break;case 4:xe();break;case 31:l.memoizedState!==null&&Wr(l);break;case 13:Wr(l);break;case 19:Y(vn);break;case 10:es(l.type);break;case 22:case 23:Wr(l),Ov(),s!==null&&Y(Sl);break;case 24:es(Cn)}}function Ud(s,l){try{var f=l.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var x=g.next;f=x;do{if((f.tag&s)===s){g=void 0;var _=f.create,I=f.inst;g=_(),I.destroy=g}f=f.next}while(f!==x)}}catch($){Vt(l,l.return,$)}}function to(s,l,f){try{var g=l.updateQueue,x=g!==null?g.lastEffect:null;if(x!==null){var _=x.next;g=_;do{if((g.tag&s)===s){var I=g.inst,$=I.destroy;if($!==void 0){I.destroy=void 0,x=l;var J=f,fe=$;try{fe()}catch(ve){Vt(x,J,ve)}}}g=g.next}while(g!==_)}}catch(ve){Vt(l,l.return,ve)}}function iT(s){var l=s.updateQueue;if(l!==null){var f=s.stateNode;try{XS(l,f)}catch(g){Vt(s,s.return,g)}}}function aT(s,l,f){f.props=kl(s.type,s.memoizedProps),f.state=s.memoizedState;try{f.componentWillUnmount()}catch(g){Vt(s,l,g)}}function Fd(s,l){try{var f=s.ref;if(f!==null){switch(s.tag){case 26:case 27:case 5:var g=s.stateNode;break;case 30:g=s.stateNode;break;default:g=s.stateNode}typeof f=="function"?s.refCleanup=f(g):f.current=g}}catch(x){Vt(s,l,x)}}function _a(s,l){var f=s.ref,g=s.refCleanup;if(f!==null)if(typeof g=="function")try{g()}catch(x){Vt(s,l,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(x){Vt(s,l,x)}else f.current=null}function sT(s){var l=s.type,f=s.memoizedProps,g=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":f.autoFocus&&g.focus();break e;case"img":f.src?g.src=f.src:f.srcSet&&(g.srcset=f.srcSet)}}catch(x){Vt(s,s.return,x)}}function fy(s,l,f){try{var g=s.stateNode;nj(g,s.type,f,l),g[Gn]=l}catch(x){Vt(s,s.return,x)}}function oT(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&lo(s.type)||s.tag===4}function hy(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||oT(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&lo(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function py(s,l,f){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(s,l):(l=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,l.appendChild(s),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=ji));else if(g!==4&&(g===27&&lo(s.type)&&(f=s.stateNode,l=null),s=s.child,s!==null))for(py(s,l,f),s=s.sibling;s!==null;)py(s,l,f),s=s.sibling}function Up(s,l,f){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?f.insertBefore(s,l):f.appendChild(s);else if(g!==4&&(g===27&&lo(s.type)&&(f=s.stateNode),s=s.child,s!==null))for(Up(s,l,f),s=s.sibling;s!==null;)Up(s,l,f),s=s.sibling}function lT(s){var l=s.stateNode,f=s.memoizedProps;try{for(var g=s.type,x=l.attributes;x.length;)l.removeAttributeNode(x[0]);Zn(l,g,f),l[En]=s,l[Gn]=f}catch(_){Vt(s,s.return,_)}}var as=!1,Nn=!1,gy=!1,cT=typeof WeakSet=="function"?WeakSet:Set,qn=null;function P3(s,l){if(s=s.containerInfo,jy=lg,s=wS(s),lv(s)){if("selectionStart"in s)var f={start:s.selectionStart,end:s.selectionEnd};else e:{f=(f=s.ownerDocument)&&f.defaultView||window;var g=f.getSelection&&f.getSelection();if(g&&g.rangeCount!==0){f=g.anchorNode;var x=g.anchorOffset,_=g.focusNode;g=g.focusOffset;try{f.nodeType,_.nodeType}catch{f=null;break e}var I=0,$=-1,J=-1,fe=0,ve=0,we=s,he=null;t:for(;;){for(var me;we!==f||x!==0&&we.nodeType!==3||($=I+x),we!==_||g!==0&&we.nodeType!==3||(J=I+g),we.nodeType===3&&(I+=we.nodeValue.length),(me=we.firstChild)!==null;)he=we,we=me;for(;;){if(we===s)break t;if(he===f&&++fe===x&&($=I),he===_&&++ve===g&&(J=I),(me=we.nextSibling)!==null)break;we=he,he=we.parentNode}we=me}f=$===-1||J===-1?null:{start:$,end:J}}else f=null}f=f||{start:0,end:0}}else f=null;for(Vy={focusedElem:s,selectionRange:f},lg=!1,qn=l;qn!==null;)if(l=qn,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,qn=s;else for(;qn!==null;){switch(l=qn,_=l.alternate,s=l.flags,l.tag){case 0:if((s&4)!==0&&(s=l.updateQueue,s=s!==null?s.events:null,s!==null))for(f=0;f<s.length;f++)x=s[f],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&_!==null){s=void 0,f=l,x=_.memoizedProps,_=_.memoizedState,g=f.stateNode;try{var ze=kl(f.type,x);s=g.getSnapshotBeforeUpdate(ze,_),g.__reactInternalSnapshotBeforeUpdate=s}catch(Xe){Vt(f,f.return,Xe)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,f=s.nodeType,f===9)By(s);else if(f===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":By(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=l.sibling,s!==null){s.return=l.return,qn=s;break}qn=l.return}}function uT(s,l,f){var g=f.flags;switch(f.tag){case 0:case 11:case 15:os(s,f),g&4&&Ud(5,f);break;case 1:if(os(s,f),g&4)if(s=f.stateNode,l===null)try{s.componentDidMount()}catch(I){Vt(f,f.return,I)}else{var x=kl(f.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(x,l,s.__reactInternalSnapshotBeforeUpdate)}catch(I){Vt(f,f.return,I)}}g&64&&iT(f),g&512&&Fd(f,f.return);break;case 3:if(os(s,f),g&64&&(s=f.updateQueue,s!==null)){if(l=null,f.child!==null)switch(f.child.tag){case 27:case 5:l=f.child.stateNode;break;case 1:l=f.child.stateNode}try{XS(s,l)}catch(I){Vt(f,f.return,I)}}break;case 27:l===null&&g&4&&lT(f);case 26:case 5:os(s,f),l===null&&g&4&&sT(f),g&512&&Fd(f,f.return);break;case 12:os(s,f);break;case 31:os(s,f),g&4&&hT(s,f);break;case 13:os(s,f),g&4&&pT(s,f),g&64&&(s=f.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(f=G3.bind(null,f),uj(s,f))));break;case 22:if(g=f.memoizedState!==null||as,!g){l=l!==null&&l.memoizedState!==null||Nn,x=as;var _=Nn;as=g,(Nn=l)&&!_?ls(s,f,(f.subtreeFlags&8772)!==0):os(s,f),as=x,Nn=_}break;case 30:break;default:os(s,f)}}function dT(s){var l=s.alternate;l!==null&&(s.alternate=null,dT(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&fc(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Jt=null,Cr=!1;function ss(s,l,f){for(f=f.child;f!==null;)fT(s,l,f),f=f.sibling}function fT(s,l,f){if(Sn&&typeof Sn.onCommitFiberUnmount=="function")try{Sn.onCommitFiberUnmount(Fr,f)}catch{}switch(f.tag){case 26:Nn||_a(f,l),ss(s,l,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:Nn||_a(f,l);var g=Jt,x=Cr;lo(f.type)&&(Jt=f.stateNode,Cr=!1),ss(s,l,f),Qd(f.stateNode),Jt=g,Cr=x;break;case 5:Nn||_a(f,l);case 6:if(g=Jt,x=Cr,Jt=null,ss(s,l,f),Jt=g,Cr=x,Jt!==null)if(Cr)try{(Jt.nodeType===9?Jt.body:Jt.nodeName==="HTML"?Jt.ownerDocument.body:Jt).removeChild(f.stateNode)}catch(_){Vt(f,l,_)}else try{Jt.removeChild(f.stateNode)}catch(_){Vt(f,l,_)}break;case 18:Jt!==null&&(Cr?(s=Jt,iA(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,f.stateNode),Kc(s)):iA(Jt,f.stateNode));break;case 4:g=Jt,x=Cr,Jt=f.stateNode.containerInfo,Cr=!0,ss(s,l,f),Jt=g,Cr=x;break;case 0:case 11:case 14:case 15:to(2,f,l),Nn||to(4,f,l),ss(s,l,f);break;case 1:Nn||(_a(f,l),g=f.stateNode,typeof g.componentWillUnmount=="function"&&aT(f,l,g)),ss(s,l,f);break;case 21:ss(s,l,f);break;case 22:Nn=(g=Nn)||f.memoizedState!==null,ss(s,l,f),Nn=g;break;default:ss(s,l,f)}}function hT(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Kc(s)}catch(f){Vt(l,l.return,f)}}}function pT(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Kc(s)}catch(f){Vt(l,l.return,f)}}function j3(s){switch(s.tag){case 31:case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new cT),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new cT),l;default:throw Error(r(435,s.tag))}}function Fp(s,l){var f=j3(s);l.forEach(function(g){if(!f.has(g)){f.add(g);var x=H3.bind(null,s,g);g.then(x,x)}})}function kr(s,l){var f=l.deletions;if(f!==null)for(var g=0;g<f.length;g++){var x=f[g],_=s,I=l,$=I;e:for(;$!==null;){switch($.tag){case 27:if(lo($.type)){Jt=$.stateNode,Cr=!1;break e}break;case 5:Jt=$.stateNode,Cr=!1;break e;case 3:case 4:Jt=$.stateNode.containerInfo,Cr=!0;break e}$=$.return}if(Jt===null)throw Error(r(160));fT(_,I,x),Jt=null,Cr=!1,_=x.alternate,_!==null&&(_.return=null),x.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)gT(l,s),l=l.sibling}var Fi=null;function gT(s,l){var f=s.alternate,g=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:kr(l,s),Rr(s),g&4&&(to(3,s,s.return),Ud(3,s),to(5,s,s.return));break;case 1:kr(l,s),Rr(s),g&512&&(Nn||f===null||_a(f,f.return)),g&64&&as&&(s=s.updateQueue,s!==null&&(g=s.callbacks,g!==null&&(f=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=f===null?g:f.concat(g))));break;case 26:var x=Fi;if(kr(l,s),Rr(s),g&512&&(Nn||f===null||_a(f,f.return)),g&4){var _=f!==null?f.memoizedState:null;if(g=s.memoizedState,f===null)if(g===null)if(s.stateNode===null){e:{g=s.type,f=s.memoizedProps,x=x.ownerDocument||x;t:switch(g){case"title":_=x.getElementsByTagName("title")[0],(!_||_[la]||_[En]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=x.createElement(g),x.head.insertBefore(_,x.querySelector("head > title"))),Zn(_,g,f),_[En]=s,Tn(_),g=_;break e;case"link":var I=gA("link","href",x).get(g+(f.href||""));if(I){for(var $=0;$<I.length;$++)if(_=I[$],_.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&_.getAttribute("rel")===(f.rel==null?null:f.rel)&&_.getAttribute("title")===(f.title==null?null:f.title)&&_.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){I.splice($,1);break t}}_=x.createElement(g),Zn(_,g,f),x.head.appendChild(_);break;case"meta":if(I=gA("meta","content",x).get(g+(f.content||""))){for($=0;$<I.length;$++)if(_=I[$],_.getAttribute("content")===(f.content==null?null:""+f.content)&&_.getAttribute("name")===(f.name==null?null:f.name)&&_.getAttribute("property")===(f.property==null?null:f.property)&&_.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&_.getAttribute("charset")===(f.charSet==null?null:f.charSet)){I.splice($,1);break t}}_=x.createElement(g),Zn(_,g,f),x.head.appendChild(_);break;default:throw Error(r(468,g))}_[En]=s,Tn(_),g=_}s.stateNode=g}else mA(x,s.type,s.stateNode);else s.stateNode=pA(x,g,s.memoizedProps);else _!==g?(_===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):_.count--,g===null?mA(x,s.type,s.stateNode):pA(x,g,s.memoizedProps)):g===null&&s.stateNode!==null&&fy(s,s.memoizedProps,f.memoizedProps)}break;case 27:kr(l,s),Rr(s),g&512&&(Nn||f===null||_a(f,f.return)),f!==null&&g&4&&fy(s,s.memoizedProps,f.memoizedProps);break;case 5:if(kr(l,s),Rr(s),g&512&&(Nn||f===null||_a(f,f.return)),s.flags&32){x=s.stateNode;try{Ar(x,"")}catch(ze){Vt(s,s.return,ze)}}g&4&&s.stateNode!=null&&(x=s.memoizedProps,fy(s,x,f!==null?f.memoizedProps:x)),g&1024&&(gy=!0);break;case 6:if(kr(l,s),Rr(s),g&4){if(s.stateNode===null)throw Error(r(162));g=s.memoizedProps,f=s.stateNode;try{f.nodeValue=g}catch(ze){Vt(s,s.return,ze)}}break;case 3:if(ig=null,x=Fi,Fi=ng(l.containerInfo),kr(l,s),Fi=x,Rr(s),g&4&&f!==null&&f.memoizedState.isDehydrated)try{Kc(l.containerInfo)}catch(ze){Vt(s,s.return,ze)}gy&&(gy=!1,mT(s));break;case 4:g=Fi,Fi=ng(s.stateNode.containerInfo),kr(l,s),Rr(s),Fi=g;break;case 12:kr(l,s),Rr(s);break;case 31:kr(l,s),Rr(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Fp(s,g)));break;case 13:kr(l,s),Rr(s),s.child.flags&8192&&s.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Gp=ut()),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Fp(s,g)));break;case 22:x=s.memoizedState!==null;var J=f!==null&&f.memoizedState!==null,fe=as,ve=Nn;if(as=fe||x,Nn=ve||J,kr(l,s),Nn=ve,as=fe,Rr(s),g&8192)e:for(l=s.stateNode,l._visibility=x?l._visibility&-2:l._visibility|1,x&&(f===null||J||as||Nn||Rl(s)),f=null,l=s;;){if(l.tag===5||l.tag===26){if(f===null){J=f=l;try{if(_=J.stateNode,x)I=_.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none";else{$=J.stateNode;var we=J.memoizedProps.style,he=we!=null&&we.hasOwnProperty("display")?we.display:null;$.style.display=he==null||typeof he=="boolean"?"":(""+he).trim()}}catch(ze){Vt(J,J.return,ze)}}}else if(l.tag===6){if(f===null){J=l;try{J.stateNode.nodeValue=x?"":J.memoizedProps}catch(ze){Vt(J,J.return,ze)}}}else if(l.tag===18){if(f===null){J=l;try{var me=J.stateNode;x?aA(me,!0):aA(J.stateNode,!1)}catch(ze){Vt(J,J.return,ze)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;f===l&&(f=null),l=l.return}f===l&&(f=null),l.sibling.return=l.return,l=l.sibling}g&4&&(g=s.updateQueue,g!==null&&(f=g.retryQueue,f!==null&&(g.retryQueue=null,Fp(s,f))));break;case 19:kr(l,s),Rr(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Fp(s,g)));break;case 30:break;case 21:break;default:kr(l,s),Rr(s)}}function Rr(s){var l=s.flags;if(l&2){try{for(var f,g=s.return;g!==null;){if(oT(g)){f=g;break}g=g.return}if(f==null)throw Error(r(160));switch(f.tag){case 27:var x=f.stateNode,_=hy(s);Up(s,_,x);break;case 5:var I=f.stateNode;f.flags&32&&(Ar(I,""),f.flags&=-33);var $=hy(s);Up(s,$,I);break;case 3:case 4:var J=f.stateNode.containerInfo,fe=hy(s);py(s,fe,J);break;default:throw Error(r(161))}}catch(ve){Vt(s,s.return,ve)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function mT(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;mT(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function os(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)uT(s,l.alternate,l),l=l.sibling}function Rl(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:to(4,l,l.return),Rl(l);break;case 1:_a(l,l.return);var f=l.stateNode;typeof f.componentWillUnmount=="function"&&aT(l,l.return,f),Rl(l);break;case 27:Qd(l.stateNode);case 26:case 5:_a(l,l.return),Rl(l);break;case 22:l.memoizedState===null&&Rl(l);break;case 30:Rl(l);break;default:Rl(l)}s=s.sibling}}function ls(s,l,f){for(f=f&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var g=l.alternate,x=s,_=l,I=_.flags;switch(_.tag){case 0:case 11:case 15:ls(x,_,f),Ud(4,_);break;case 1:if(ls(x,_,f),g=_,x=g.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(fe){Vt(g,g.return,fe)}if(g=_,x=g.updateQueue,x!==null){var $=g.stateNode;try{var J=x.shared.hiddenCallbacks;if(J!==null)for(x.shared.hiddenCallbacks=null,x=0;x<J.length;x++)YS(J[x],$)}catch(fe){Vt(g,g.return,fe)}}f&&I&64&&iT(_),Fd(_,_.return);break;case 27:lT(_);case 26:case 5:ls(x,_,f),f&&g===null&&I&4&&sT(_),Fd(_,_.return);break;case 12:ls(x,_,f);break;case 31:ls(x,_,f),f&&I&4&&hT(x,_);break;case 13:ls(x,_,f),f&&I&4&&pT(x,_);break;case 22:_.memoizedState===null&&ls(x,_,f),Fd(_,_.return);break;case 30:break;default:ls(x,_,f)}l=l.sibling}}function my(s,l){var f=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==f&&(s!=null&&s.refCount++,f!=null&&kd(f))}function vy(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&kd(s))}function $i(s,l,f,g){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)vT(s,l,f,g),l=l.sibling}function vT(s,l,f,g){var x=l.flags;switch(l.tag){case 0:case 11:case 15:$i(s,l,f,g),x&2048&&Ud(9,l);break;case 1:$i(s,l,f,g);break;case 3:$i(s,l,f,g),x&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&kd(s)));break;case 12:if(x&2048){$i(s,l,f,g),s=l.stateNode;try{var _=l.memoizedProps,I=_.id,$=_.onPostCommit;typeof $=="function"&&$(I,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(J){Vt(l,l.return,J)}}else $i(s,l,f,g);break;case 31:$i(s,l,f,g);break;case 13:$i(s,l,f,g);break;case 23:break;case 22:_=l.stateNode,I=l.alternate,l.memoizedState!==null?_._visibility&2?$i(s,l,f,g):$d(s,l):_._visibility&2?$i(s,l,f,g):(_._visibility|=2,Lc(s,l,f,g,(l.subtreeFlags&10256)!==0||!1)),x&2048&&my(I,l);break;case 24:$i(s,l,f,g),x&2048&&vy(l.alternate,l);break;default:$i(s,l,f,g)}}function Lc(s,l,f,g,x){for(x=x&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var _=s,I=l,$=f,J=g,fe=I.flags;switch(I.tag){case 0:case 11:case 15:Lc(_,I,$,J,x),Ud(8,I);break;case 23:break;case 22:var ve=I.stateNode;I.memoizedState!==null?ve._visibility&2?Lc(_,I,$,J,x):$d(_,I):(ve._visibility|=2,Lc(_,I,$,J,x)),x&&fe&2048&&my(I.alternate,I);break;case 24:Lc(_,I,$,J,x),x&&fe&2048&&vy(I.alternate,I);break;default:Lc(_,I,$,J,x)}l=l.sibling}}function $d(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var f=s,g=l,x=g.flags;switch(g.tag){case 22:$d(f,g),x&2048&&my(g.alternate,g);break;case 24:$d(f,g),x&2048&&vy(g.alternate,g);break;default:$d(f,g)}l=l.sibling}}var Gd=8192;function Bc(s,l,f){if(s.subtreeFlags&Gd)for(s=s.child;s!==null;)yT(s,l,f),s=s.sibling}function yT(s,l,f){switch(s.tag){case 26:Bc(s,l,f),s.flags&Gd&&s.memoizedState!==null&&_j(f,Fi,s.memoizedState,s.memoizedProps);break;case 5:Bc(s,l,f);break;case 3:case 4:var g=Fi;Fi=ng(s.stateNode.containerInfo),Bc(s,l,f),Fi=g;break;case 22:s.memoizedState===null&&(g=s.alternate,g!==null&&g.memoizedState!==null?(g=Gd,Gd=16777216,Bc(s,l,f),Gd=g):Bc(s,l,f));break;default:Bc(s,l,f)}}function bT(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function Hd(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];qn=g,wT(g,s)}bT(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)xT(s),s=s.sibling}function xT(s){switch(s.tag){case 0:case 11:case 15:Hd(s),s.flags&2048&&to(9,s,s.return);break;case 3:Hd(s);break;case 12:Hd(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,$p(s)):Hd(s);break;default:Hd(s)}}function $p(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];qn=g,wT(g,s)}bT(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:to(8,l,l.return),$p(l);break;case 22:f=l.stateNode,f._visibility&2&&(f._visibility&=-3,$p(l));break;default:$p(l)}s=s.sibling}}function wT(s,l){for(;qn!==null;){var f=qn;switch(f.tag){case 0:case 11:case 15:to(8,f,l);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var g=f.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:kd(f.memoizedState.cache)}if(g=f.child,g!==null)g.return=f,qn=g;else e:for(f=s;qn!==null;){g=qn;var x=g.sibling,_=g.return;if(dT(g),g===f){qn=null;break e}if(x!==null){x.return=_,qn=x;break e}qn=_}}}var V3={getCacheForType:function(s){var l=Kn(Cn),f=l.data.get(s);return f===void 0&&(f=s(),l.data.set(s,f)),f},cacheSignal:function(){return Kn(Cn).controller.signal}},z3=typeof WeakMap=="function"?WeakMap:Map,Dt=0,Ht=null,ht=null,vt=0,jt=0,Kr=null,no=!1,Uc=!1,yy=!1,cs=0,dn=0,ro=0,Nl=0,by=0,Qr=0,Fc=0,qd=null,Nr=null,xy=!1,Gp=0,_T=0,Hp=1/0,qp=null,io=null,zn=0,ao=null,$c=null,us=0,wy=0,_y=null,ST=null,Yd=0,Sy=null;function Zr(){return(Dt&2)!==0&&vt!==0?vt&-vt:q.T!==null?Ry():Yh()}function ET(){if(Qr===0)if((vt&536870912)===0||St){var s=nn;nn<<=1,(nn&3932160)===0&&(nn=262144),Qr=s}else Qr=536870912;return s=Xr.current,s!==null&&(s.flags|=32),Qr}function Dr(s,l,f){(s===Ht&&(jt===2||jt===9)||s.cancelPendingCommit!==null)&&(Gc(s,0),so(s,vt,Qr,!1)),il(s,f),((Dt&2)===0||s!==Ht)&&(s===Ht&&((Dt&2)===0&&(Nl|=f),dn===4&&so(s,vt,Qr,!1)),Sa(s))}function TT(s,l,f){if((Dt&6)!==0)throw Error(r(327));var g=!f&&(l&127)===0&&(l&s.expiredLanes)===0||pr(s,l),x=g?U3(s,l):Ty(s,l,!0),_=g;do{if(x===0){Uc&&!g&&so(s,l,0,!1);break}else{if(f=s.current.alternate,_&&!L3(f)){x=Ty(s,l,!1),_=!1;continue}if(x===2){if(_=l,s.errorRecoveryDisabledLanes&_)var I=0;else I=s.pendingLanes&-536870913,I=I!==0?I:I&536870912?536870912:0;if(I!==0){l=I;e:{var $=s;x=qd;var J=$.current.memoizedState.isDehydrated;if(J&&(Gc($,I).flags|=256),I=Ty($,I,!1),I!==2){if(yy&&!J){$.errorRecoveryDisabledLanes|=_,Nl|=_,x=4;break e}_=Nr,Nr=x,_!==null&&(Nr===null?Nr=_:Nr.push.apply(Nr,_))}x=I}if(_=!1,x!==2)continue}}if(x===1){Gc(s,0),so(s,l,0,!0);break}e:{switch(g=s,_=x,_){case 0:case 1:throw Error(r(345));case 4:if((l&4194048)!==l)break;case 6:so(g,l,Qr,!no);break e;case 2:Nr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((l&62914560)===l&&(x=Gp+300-ut(),10<x)){if(so(g,l,Qr,!no),ai(g,0,!0)!==0)break e;us=l,g.timeoutHandle=nA(AT.bind(null,g,f,Nr,qp,xy,l,Qr,Nl,Fc,no,_,"Throttled",-0,0),x);break e}AT(g,f,Nr,qp,xy,l,Qr,Nl,Fc,no,_,null,-0,0)}}break}while(!0);Sa(s)}function AT(s,l,f,g,x,_,I,$,J,fe,ve,we,he,me){if(s.timeoutHandle=-1,we=l.subtreeFlags,we&8192||(we&16785408)===16785408){we={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ji},yT(l,_,we);var ze=(_&62914560)===_?Gp-ut():(_&4194048)===_?_T-ut():0;if(ze=Sj(we,ze),ze!==null){us=_,s.cancelPendingCommit=ze(OT.bind(null,s,l,_,f,g,x,I,$,J,ve,we,null,he,me)),so(s,_,I,!fe);return}}OT(s,l,_,f,g,x,I,$,J)}function L3(s){for(var l=s;;){var f=l.tag;if((f===0||f===11||f===15)&&l.flags&16384&&(f=l.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var g=0;g<f.length;g++){var x=f[g],_=x.getSnapshot;x=x.value;try{if(!qr(_(),x))return!1}catch{return!1}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function so(s,l,f,g){l&=~by,l&=~Nl,s.suspendedLanes|=l,s.pingedLanes&=~l,g&&(s.warmLanes|=l),g=s.expirationTimes;for(var x=l;0<x;){var _=31-tn(x),I=1<<_;g[_]=-1,x&=~I}f!==0&&al(s,f,l)}function Yp(){return(Dt&6)===0?(Xd(0),!1):!0}function Ey(){if(ht!==null){if(jt===0)var s=ht.return;else s=ht,Ja=wl=null,Bv(s),Oc=null,Nd=0,s=ht;for(;s!==null;)rT(s.alternate,s),s=s.return;ht=null}}function Gc(s,l){var f=s.timeoutHandle;f!==-1&&(s.timeoutHandle=-1,aj(f)),f=s.cancelPendingCommit,f!==null&&(s.cancelPendingCommit=null,f()),us=0,Ey(),Ht=s,ht=f=Qa(s.current,null),vt=l,jt=0,Kr=null,no=!1,Uc=pr(s,l),yy=!1,Fc=Qr=by=Nl=ro=dn=0,Nr=qd=null,xy=!1,(l&8)!==0&&(l|=l&32);var g=s.entangledLanes;if(g!==0)for(s=s.entanglements,g&=l;0<g;){var x=31-tn(g),_=1<<x;l|=s[x],g&=~_}return cs=l,pp(),f}function CT(s,l){lt=null,q.H=zd,l===Mc||l===_p?(l=$S(),jt=3):l===kv?(l=$S(),jt=4):jt=l===ny?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,Kr=l,ht===null&&(dn=1,jp(s,di(l,s.current)))}function kT(){var s=Xr.current;return s===null?!0:(vt&4194048)===vt?gi===null:(vt&62914560)===vt||(vt&536870912)!==0?s===gi:!1}function RT(){var s=q.H;return q.H=zd,s===null?zd:s}function NT(){var s=q.A;return q.A=V3,s}function Xp(){dn=4,no||(vt&4194048)!==vt&&Xr.current!==null||(Uc=!0),(ro&134217727)===0&&(Nl&134217727)===0||Ht===null||so(Ht,vt,Qr,!1)}function Ty(s,l,f){var g=Dt;Dt|=2;var x=RT(),_=NT();(Ht!==s||vt!==l)&&(qp=null,Gc(s,l)),l=!1;var I=dn;e:do try{if(jt!==0&&ht!==null){var $=ht,J=Kr;switch(jt){case 8:Ey(),I=6;break e;case 3:case 2:case 9:case 6:Xr.current===null&&(l=!0);var fe=jt;if(jt=0,Kr=null,Hc(s,$,J,fe),f&&Uc){I=0;break e}break;default:fe=jt,jt=0,Kr=null,Hc(s,$,J,fe)}}B3(),I=dn;break}catch(ve){CT(s,ve)}while(!0);return l&&s.shellSuspendCounter++,Ja=wl=null,Dt=g,q.H=x,q.A=_,ht===null&&(Ht=null,vt=0,pp()),I}function B3(){for(;ht!==null;)DT(ht)}function U3(s,l){var f=Dt;Dt|=2;var g=RT(),x=NT();Ht!==s||vt!==l?(qp=null,Hp=ut()+500,Gc(s,l)):Uc=pr(s,l);e:do try{if(jt!==0&&ht!==null){l=ht;var _=Kr;t:switch(jt){case 1:jt=0,Kr=null,Hc(s,l,_,1);break;case 2:case 9:if(US(_)){jt=0,Kr=null,IT(l);break}l=function(){jt!==2&&jt!==9||Ht!==s||(jt=7),Sa(s)},_.then(l,l);break e;case 3:jt=7;break e;case 4:jt=5;break e;case 7:US(_)?(jt=0,Kr=null,IT(l)):(jt=0,Kr=null,Hc(s,l,_,7));break;case 5:var I=null;switch(ht.tag){case 26:I=ht.memoizedState;case 5:case 27:var $=ht;if(I?vA(I):$.stateNode.complete){jt=0,Kr=null;var J=$.sibling;if(J!==null)ht=J;else{var fe=$.return;fe!==null?(ht=fe,Wp(fe)):ht=null}break t}}jt=0,Kr=null,Hc(s,l,_,5);break;case 6:jt=0,Kr=null,Hc(s,l,_,6);break;case 8:Ey(),dn=6;break e;default:throw Error(r(462))}}F3();break}catch(ve){CT(s,ve)}while(!0);return Ja=wl=null,q.H=g,q.A=x,Dt=f,ht!==null?0:(Ht=null,vt=0,pp(),dn)}function F3(){for(;ht!==null&&!_t();)DT(ht)}function DT(s){var l=tT(s.alternate,s,cs);s.memoizedProps=s.pendingProps,l===null?Wp(s):ht=l}function IT(s){var l=s,f=l.alternate;switch(l.tag){case 15:case 0:l=WE(f,l,l.pendingProps,l.type,void 0,vt);break;case 11:l=WE(f,l,l.pendingProps,l.type.render,l.ref,vt);break;case 5:Bv(l);default:rT(f,l),l=ht=NS(l,cs),l=tT(f,l,cs)}s.memoizedProps=s.pendingProps,l===null?Wp(s):ht=l}function Hc(s,l,f,g){Ja=wl=null,Bv(l),Oc=null,Nd=0;var x=l.return;try{if(N3(s,x,l,f,vt)){dn=1,jp(s,di(f,s.current)),ht=null;return}}catch(_){if(x!==null)throw ht=x,_;dn=1,jp(s,di(f,s.current)),ht=null;return}l.flags&32768?(St||g===1?s=!0:Uc||(vt&536870912)!==0?s=!1:(no=s=!0,(g===2||g===9||g===3||g===6)&&(g=Xr.current,g!==null&&g.tag===13&&(g.flags|=16384))),MT(l,s)):Wp(l)}function Wp(s){var l=s;do{if((l.flags&32768)!==0){MT(l,no);return}s=l.return;var f=M3(l.alternate,l,cs);if(f!==null){ht=f;return}if(l=l.sibling,l!==null){ht=l;return}ht=l=s}while(l!==null);dn===0&&(dn=5)}function MT(s,l){do{var f=O3(s.alternate,s);if(f!==null){f.flags&=32767,ht=f;return}if(f=s.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!l&&(s=s.sibling,s!==null)){ht=s;return}ht=s=f}while(s!==null);dn=6,ht=null}function OT(s,l,f,g,x,_,I,$,J){s.cancelPendingCommit=null;do Kp();while(zn!==0);if((Dt&6)!==0)throw Error(r(327));if(l!==null){if(l===s.current)throw Error(r(177));if(_=l.lanes|l.childLanes,_|=hv,iv(s,f,_,I,$,J),s===Ht&&(ht=Ht=null,vt=0),$c=l,ao=s,us=f,wy=_,_y=x,ST=g,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,q3(_n,function(){return LT(),null})):(s.callbackNode=null,s.callbackPriority=0),g=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||g){g=q.T,q.T=null,x=Q.p,Q.p=2,I=Dt,Dt|=4;try{P3(s,l,f)}finally{Dt=I,Q.p=x,q.T=g}}zn=1,PT(),jT(),VT()}}function PT(){if(zn===1){zn=0;var s=ao,l=$c,f=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||f){f=q.T,q.T=null;var g=Q.p;Q.p=2;var x=Dt;Dt|=4;try{gT(l,s);var _=Vy,I=wS(s.containerInfo),$=_.focusedElem,J=_.selectionRange;if(I!==$&&$&&$.ownerDocument&&xS($.ownerDocument.documentElement,$)){if(J!==null&&lv($)){var fe=J.start,ve=J.end;if(ve===void 0&&(ve=fe),"selectionStart"in $)$.selectionStart=fe,$.selectionEnd=Math.min(ve,$.value.length);else{var we=$.ownerDocument||document,he=we&&we.defaultView||window;if(he.getSelection){var me=he.getSelection(),ze=$.textContent.length,Xe=Math.min(J.start,ze),Ft=J.end===void 0?Xe:Math.min(J.end,ze);!me.extend&&Xe>Ft&&(I=Ft,Ft=Xe,Xe=I);var oe=bS($,Xe),re=bS($,Ft);if(oe&&re&&(me.rangeCount!==1||me.anchorNode!==oe.node||me.anchorOffset!==oe.offset||me.focusNode!==re.node||me.focusOffset!==re.offset)){var de=we.createRange();de.setStart(oe.node,oe.offset),me.removeAllRanges(),Xe>Ft?(me.addRange(de),me.extend(re.node,re.offset)):(de.setEnd(re.node,re.offset),me.addRange(de))}}}}for(we=[],me=$;me=me.parentNode;)me.nodeType===1&&we.push({element:me,left:me.scrollLeft,top:me.scrollTop});for(typeof $.focus=="function"&&$.focus(),$=0;$<we.length;$++){var ye=we[$];ye.element.scrollLeft=ye.left,ye.element.scrollTop=ye.top}}lg=!!jy,Vy=jy=null}finally{Dt=x,Q.p=g,q.T=f}}s.current=l,zn=2}}function jT(){if(zn===2){zn=0;var s=ao,l=$c,f=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||f){f=q.T,q.T=null;var g=Q.p;Q.p=2;var x=Dt;Dt|=4;try{uT(s,l.alternate,l)}finally{Dt=x,Q.p=g,q.T=f}}zn=3}}function VT(){if(zn===4||zn===3){zn=0,Ze();var s=ao,l=$c,f=us,g=ST;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?zn=5:(zn=0,$c=ao=null,zT(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(io=null),Ya(f),l=l.stateNode,Sn&&typeof Sn.onCommitFiberRoot=="function")try{Sn.onCommitFiberRoot(Fr,l,void 0,(l.current.flags&128)===128)}catch{}if(g!==null){l=q.T,x=Q.p,Q.p=2,q.T=null;try{for(var _=s.onRecoverableError,I=0;I<g.length;I++){var $=g[I];_($.value,{componentStack:$.stack})}}finally{q.T=l,Q.p=x}}(us&3)!==0&&Kp(),Sa(s),x=s.pendingLanes,(f&261930)!==0&&(x&42)!==0?s===Sy?Yd++:(Yd=0,Sy=s):Yd=0,Xd(0)}}function zT(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,kd(l)))}function Kp(){return PT(),jT(),VT(),LT()}function LT(){if(zn!==5)return!1;var s=ao,l=wy;wy=0;var f=Ya(us),g=q.T,x=Q.p;try{Q.p=32>f?32:f,q.T=null,f=_y,_y=null;var _=ao,I=us;if(zn=0,$c=ao=null,us=0,(Dt&6)!==0)throw Error(r(331));var $=Dt;if(Dt|=4,xT(_.current),vT(_,_.current,I,f),Dt=$,Xd(0,!1),Sn&&typeof Sn.onPostCommitFiberRoot=="function")try{Sn.onPostCommitFiberRoot(Fr,_)}catch{}return!0}finally{Q.p=x,q.T=g,zT(s,l)}}function BT(s,l,f){l=di(f,l),l=ty(s.stateNode,l,2),s=Zs(s,l,2),s!==null&&(il(s,2),Sa(s))}function Vt(s,l,f){if(s.tag===3)BT(s,s,f);else for(;l!==null;){if(l.tag===3){BT(l,s,f);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(io===null||!io.has(g))){s=di(f,s),f=UE(2),g=Zs(l,f,2),g!==null&&(FE(f,g,l,s),il(g,2),Sa(g));break}}l=l.return}}function Ay(s,l,f){var g=s.pingCache;if(g===null){g=s.pingCache=new z3;var x=new Set;g.set(l,x)}else x=g.get(l),x===void 0&&(x=new Set,g.set(l,x));x.has(f)||(yy=!0,x.add(f),s=$3.bind(null,s,l,f),l.then(s,s))}function $3(s,l,f){var g=s.pingCache;g!==null&&g.delete(l),s.pingedLanes|=s.suspendedLanes&f,s.warmLanes&=~f,Ht===s&&(vt&f)===f&&(dn===4||dn===3&&(vt&62914560)===vt&&300>ut()-Gp?(Dt&2)===0&&Gc(s,0):by|=f,Fc===vt&&(Fc=0)),Sa(s)}function UT(s,l){l===0&&(l=qh()),s=yl(s,l),s!==null&&(il(s,l),Sa(s))}function G3(s){var l=s.memoizedState,f=0;l!==null&&(f=l.retryLane),UT(s,f)}function H3(s,l){var f=0;switch(s.tag){case 31:case 13:var g=s.stateNode,x=s.memoizedState;x!==null&&(f=x.retryLane);break;case 19:g=s.stateNode;break;case 22:g=s.stateNode._retryCache;break;default:throw Error(r(314))}g!==null&&g.delete(l),UT(s,f)}function q3(s,l){return Be(s,l)}var Qp=null,qc=null,Cy=!1,Zp=!1,ky=!1,oo=0;function Sa(s){s!==qc&&s.next===null&&(qc===null?Qp=qc=s:qc=qc.next=s),Zp=!0,Cy||(Cy=!0,X3())}function Xd(s,l){if(!ky&&Zp){ky=!0;do for(var f=!1,g=Qp;g!==null;){if(s!==0){var x=g.pendingLanes;if(x===0)var _=0;else{var I=g.suspendedLanes,$=g.pingedLanes;_=(1<<31-tn(42|s)+1)-1,_&=x&~(I&~$),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(f=!0,HT(g,_))}else _=vt,_=ai(g,g===Ht?_:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(_&3)===0||pr(g,_)||(f=!0,HT(g,_));g=g.next}while(f);ky=!1}}function Y3(){FT()}function FT(){Zp=Cy=!1;var s=0;oo!==0&&ij()&&(s=oo);for(var l=ut(),f=null,g=Qp;g!==null;){var x=g.next,_=$T(g,l);_===0?(g.next=null,f===null?Qp=x:f.next=x,x===null&&(qc=f)):(f=g,(s!==0||(_&3)!==0)&&(Zp=!0)),g=x}zn!==0&&zn!==5||Xd(s),oo!==0&&(oo=0)}function $T(s,l){for(var f=s.suspendedLanes,g=s.pingedLanes,x=s.expirationTimes,_=s.pendingLanes&-62914561;0<_;){var I=31-tn(_),$=1<<I,J=x[I];J===-1?(($&f)===0||($&g)!==0)&&(x[I]=rv($,l)):J<=l&&(s.expiredLanes|=$),_&=~$}if(l=Ht,f=vt,f=ai(s,s===l?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g=s.callbackNode,f===0||s===l&&(jt===2||jt===9)||s.cancelPendingCommit!==null)return g!==null&&g!==null&&st(g),s.callbackNode=null,s.callbackPriority=0;if((f&3)===0||pr(s,f)){if(l=f&-f,l===s.callbackPriority)return l;switch(g!==null&&st(g),Ya(f)){case 2:case 8:f=It;break;case 32:f=_n;break;case 268435456:f=aa;break;default:f=_n}return g=GT.bind(null,s),f=Be(f,g),s.callbackPriority=l,s.callbackNode=f,l}return g!==null&&g!==null&&st(g),s.callbackPriority=2,s.callbackNode=null,2}function GT(s,l){if(zn!==0&&zn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var f=s.callbackNode;if(Kp()&&s.callbackNode!==f)return null;var g=vt;return g=ai(s,s===Ht?g:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g===0?null:(TT(s,g,l),$T(s,ut()),s.callbackNode!=null&&s.callbackNode===f?GT.bind(null,s):null)}function HT(s,l){if(Kp())return null;TT(s,l,!0)}function X3(){sj(function(){(Dt&6)!==0?Be(cn,Y3):FT()})}function Ry(){if(oo===0){var s=Dc;s===0&&(s=ft,ft<<=1,(ft&261888)===0&&(ft=256)),oo=s}return oo}function qT(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:mc(""+s)}function YT(s,l){var f=l.ownerDocument.createElement("input");return f.name=l.name,f.value=l.value,s.id&&f.setAttribute("form",s.id),l.parentNode.insertBefore(f,l),s=new FormData(s),f.parentNode.removeChild(f),s}function W3(s,l,f,g,x){if(l==="submit"&&f&&f.stateNode===x){var _=qT((x[Gn]||null).action),I=g.submitter;I&&(l=(l=I[Gn]||null)?qT(l.formAction):I.getAttribute("formAction"),l!==null&&(_=l,I=null));var $=new ma("action","action",null,g,x);s.push({event:$,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(oo!==0){var J=I?YT(x,I):new FormData(x);Wv(f,{pending:!0,data:J,method:x.method,action:_},null,J)}}else typeof _=="function"&&($.preventDefault(),J=I?YT(x,I):new FormData(x),Wv(f,{pending:!0,data:J,method:x.method,action:_},_,J))},currentTarget:x}]})}}for(var Ny=0;Ny<fv.length;Ny++){var Dy=fv[Ny],K3=Dy.toLowerCase(),Q3=Dy[0].toUpperCase()+Dy.slice(1);Ui(K3,"on"+Q3)}Ui(ES,"onAnimationEnd"),Ui(TS,"onAnimationIteration"),Ui(AS,"onAnimationStart"),Ui("dblclick","onDoubleClick"),Ui("focusin","onFocus"),Ui("focusout","onBlur"),Ui(h3,"onTransitionRun"),Ui(p3,"onTransitionStart"),Ui(g3,"onTransitionCancel"),Ui(CS,"onTransitionEnd"),fa("onMouseEnter",["mouseout","mouseover"]),fa("onMouseLeave",["mouseout","mouseover"]),fa("onPointerEnter",["pointerout","pointerover"]),fa("onPointerLeave",["pointerout","pointerover"]),da("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),da("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),da("onBeforeInput",["compositionend","keypress","textInput","paste"]),da("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),da("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),da("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Z3=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Wd));function XT(s,l){l=(l&4)!==0;for(var f=0;f<s.length;f++){var g=s[f],x=g.event;g=g.listeners;e:{var _=void 0;if(l)for(var I=g.length-1;0<=I;I--){var $=g[I],J=$.instance,fe=$.currentTarget;if($=$.listener,J!==_&&x.isPropagationStopped())break e;_=$,x.currentTarget=fe;try{_(x)}catch(ve){hp(ve)}x.currentTarget=null,_=J}else for(I=0;I<g.length;I++){if($=g[I],J=$.instance,fe=$.currentTarget,$=$.listener,J!==_&&x.isPropagationStopped())break e;_=$,x.currentTarget=fe;try{_(x)}catch(ve){hp(ve)}x.currentTarget=null,_=J}}}}function pt(s,l){var f=l[dc];f===void 0&&(f=l[dc]=new Set);var g=s+"__bubble";f.has(g)||(WT(l,s,2,!1),f.add(g))}function Iy(s,l,f){var g=0;l&&(g|=4),WT(f,s,g,l)}var Jp="_reactListening"+Math.random().toString(36).slice(2);function My(s){if(!s[Jp]){s[Jp]=!0,od.forEach(function(f){f!=="selectionchange"&&(Z3.has(f)||Iy(f,!1,s),Iy(f,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[Jp]||(l[Jp]=!0,Iy("selectionchange",!1,l))}}function WT(s,l,f,g){switch(EA(l)){case 2:var x=Aj;break;case 8:x=Cj;break;default:x=Xy}f=x.bind(null,l,f,s),x=void 0,!ul||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(x=!0),g?x!==void 0?s.addEventListener(l,f,{capture:!0,passive:x}):s.addEventListener(l,f,!0):x!==void 0?s.addEventListener(l,f,{passive:x}):s.addEventListener(l,f,!1)}function Oy(s,l,f,g,x){var _=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var I=g.tag;if(I===3||I===4){var $=g.stateNode.containerInfo;if($===x)break;if(I===4)for(I=g.return;I!==null;){var J=I.tag;if((J===3||J===4)&&I.stateNode.containerInfo===x)return;I=I.return}for(;$!==null;){if(I=ca($),I===null)return;if(J=I.tag,J===5||J===6||J===26||J===27){g=_=I;continue e}$=$.parentNode}}g=g.return}Fs(function(){var fe=_,ve=oi(f),we=[];e:{var he=kS.get(s);if(he!==void 0){var me=ma,ze=s;switch(s){case"keypress":if(fl(f)===0)break e;case"keydown":case"keyup":me=up;break;case"focusin":ze="focus",me=pl;break;case"focusout":ze="blur",me=pl;break;case"beforeblur":case"afterblur":me=pl;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":me=xd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":me=tp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":me=R;break;case ES:case TS:case AS:me=rp;break;case CS:me=H;break;case"scroll":case"scrollend":me=bd;break;case"wheel":me=ge;break;case"copy":case"cut":case"paste":me=ip;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":me=Ka;break;case"toggle":case"beforetoggle":me=ot}var Xe=(l&4)!==0,Ft=!Xe&&(s==="scroll"||s==="scrollend"),oe=Xe?he!==null?he+"Capture":null:he;Xe=[];for(var re=fe,de;re!==null;){var ye=re;if(de=ye.stateNode,ye=ye.tag,ye!==5&&ye!==26&&ye!==27||de===null||oe===null||(ye=Vi(re,oe),ye!=null&&Xe.push(Kd(re,ye,de))),Ft)break;re=re.return}0<Xe.length&&(he=new me(he,ze,null,f,ve),we.push({event:he,listeners:Xe}))}}if((l&7)===0){e:{if(he=s==="mouseover"||s==="pointerover",me=s==="mouseout"||s==="pointerout",he&&f!==md&&(ze=f.relatedTarget||f.fromElement)&&(ca(ze)||ze[oa]))break e;if((me||he)&&(he=ve.window===ve?ve:(he=ve.ownerDocument)?he.defaultView||he.parentWindow:window,me?(ze=f.relatedTarget||f.toElement,me=fe,ze=ze?ca(ze):null,ze!==null&&(Ft=a(ze),Xe=ze.tag,ze!==Ft||Xe!==5&&Xe!==27&&Xe!==6)&&(ze=null)):(me=null,ze=fe),me!==ze)){if(Xe=xd,ye="onMouseLeave",oe="onMouseEnter",re="mouse",(s==="pointerout"||s==="pointerover")&&(Xe=Ka,ye="onPointerLeave",oe="onPointerEnter",re="pointer"),Ft=me==null?he:Gr(me),de=ze==null?he:Gr(ze),he=new Xe(ye,re+"leave",me,f,ve),he.target=Ft,he.relatedTarget=de,ye=null,ca(ve)===fe&&(Xe=new Xe(oe,re+"enter",ze,f,ve),Xe.target=de,Xe.relatedTarget=Ft,ye=Xe),Ft=ye,me&&ze)t:{for(Xe=J3,oe=me,re=ze,de=0,ye=oe;ye;ye=Xe(ye))de++;ye=0;for(var Ge=re;Ge;Ge=Xe(Ge))ye++;for(;0<de-ye;)oe=Xe(oe),de--;for(;0<ye-de;)re=Xe(re),ye--;for(;de--;){if(oe===re||re!==null&&oe===re.alternate){Xe=oe;break t}oe=Xe(oe),re=Xe(re)}Xe=null}else Xe=null;me!==null&&KT(we,he,me,Xe,!1),ze!==null&&Ft!==null&&KT(we,Ft,ze,Xe,!0)}}e:{if(he=fe?Gr(fe):window,me=he.nodeName&&he.nodeName.toLowerCase(),me==="select"||me==="input"&&he.type==="file")var Ct=hS;else if(dS(he))if(pS)Ct=u3;else{Ct=l3;var Ue=o3}else me=he.nodeName,!me||me.toLowerCase()!=="input"||he.type!=="checkbox"&&he.type!=="radio"?fe&&gc(fe.elementType)&&(Ct=hS):Ct=c3;if(Ct&&(Ct=Ct(s,fe))){fS(we,Ct,f,ve);break e}Ue&&Ue(s,he,fe),s==="focusout"&&fe&&he.type==="number"&&fe.memoizedProps.value!=null&&hd(he,"number",he.value)}switch(Ue=fe?Gr(fe):window,s){case"focusin":(dS(Ue)||Ue.contentEditable==="true")&&(Sc=Ue,cv=fe,Td=null);break;case"focusout":Td=cv=Sc=null;break;case"mousedown":uv=!0;break;case"contextmenu":case"mouseup":case"dragend":uv=!1,_S(we,f,ve);break;case"selectionchange":if(f3)break;case"keydown":case"keyup":_S(we,f,ve)}var dt;if(Nt)e:{switch(s){case"compositionstart":var yt="onCompositionStart";break e;case"compositionend":yt="onCompositionEnd";break e;case"compositionupdate":yt="onCompositionUpdate";break e}yt=void 0}else _c?gl(s,f)&&(yt="onCompositionEnd"):s==="keydown"&&f.keyCode===229&&(yt="onCompositionStart");yt&&(ba&&f.locale!=="ko"&&(_c||yt!=="onCompositionStart"?yt==="onCompositionEnd"&&_c&&(dt=yd()):(ga=ve,vd="value"in ga?ga.value:ga.textContent,_c=!0)),Ue=eg(fe,yt),0<Ue.length&&(yt=new ya(yt,s,null,f,ve),we.push({event:yt,listeners:Ue}),dt?yt.data=dt:(dt=wc(f),dt!==null&&(yt.data=dt)))),(dt=ci?r3(s,f):i3(s,f))&&(yt=eg(fe,"onBeforeInput"),0<yt.length&&(Ue=new ya("onBeforeInput","beforeinput",null,f,ve),we.push({event:Ue,listeners:yt}),Ue.data=dt)),W3(we,s,fe,f,ve)}XT(we,l)})}function Kd(s,l,f){return{instance:s,listener:l,currentTarget:f}}function eg(s,l){for(var f=l+"Capture",g=[];s!==null;){var x=s,_=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||_===null||(x=Vi(s,f),x!=null&&g.unshift(Kd(s,x,_)),x=Vi(s,l),x!=null&&g.push(Kd(s,x,_))),s.tag===3)return g;s=s.return}return[]}function J3(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function KT(s,l,f,g,x){for(var _=l._reactName,I=[];f!==null&&f!==g;){var $=f,J=$.alternate,fe=$.stateNode;if($=$.tag,J!==null&&J===g)break;$!==5&&$!==26&&$!==27||fe===null||(J=fe,x?(fe=Vi(f,_),fe!=null&&I.unshift(Kd(f,fe,J))):x||(fe=Vi(f,_),fe!=null&&I.push(Kd(f,fe,J)))),f=f.return}I.length!==0&&s.push({event:l,listeners:I})}var ej=/\r\n?/g,tj=/\u0000|\uFFFD/g;function QT(s){return(typeof s=="string"?s:""+s).replace(ej,`
`).replace(tj,"")}function ZT(s,l){return l=QT(l),QT(s)===l}function Ut(s,l,f,g,x,_){switch(f){case"children":typeof g=="string"?l==="body"||l==="textarea"&&g===""||Ar(s,g):(typeof g=="number"||typeof g=="bigint")&&l!=="body"&&Ar(s,""+g);break;case"className":Hr(s,"class",g);break;case"tabIndex":Hr(s,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":Hr(s,f,g);break;case"style":gd(s,g,_);break;case"data":if(l!=="object"){Hr(s,"data",g);break}case"src":case"href":if(g===""&&(l!=="a"||f!=="href")){s.removeAttribute(f);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(f);break}g=mc(""+g),s.setAttribute(f,g);break;case"action":case"formAction":if(typeof g=="function"){s.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(f==="formAction"?(l!=="input"&&Ut(s,l,"name",x.name,x,null),Ut(s,l,"formEncType",x.formEncType,x,null),Ut(s,l,"formMethod",x.formMethod,x,null),Ut(s,l,"formTarget",x.formTarget,x,null)):(Ut(s,l,"encType",x.encType,x,null),Ut(s,l,"method",x.method,x,null),Ut(s,l,"target",x.target,x,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(f);break}g=mc(""+g),s.setAttribute(f,g);break;case"onClick":g!=null&&(s.onclick=ji);break;case"onScroll":g!=null&&pt("scroll",s);break;case"onScrollEnd":g!=null&&pt("scrollend",s);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"multiple":s.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":s.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){s.removeAttribute("xlink:href");break}f=mc(""+g),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,""+g):s.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,""):s.removeAttribute(f);break;case"capture":case"download":g===!0?s.setAttribute(f,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,g):s.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?s.setAttribute(f,g):s.removeAttribute(f);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?s.removeAttribute(f):s.setAttribute(f,g);break;case"popover":pt("beforetoggle",s),pt("toggle",s),hc(s,"popover",g);break;case"xlinkActuate":An(s,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":An(s,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":An(s,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":An(s,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":An(s,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":An(s,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":An(s,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":An(s,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":An(s,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":hc(s,"is",g);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=ep.get(f)||f,hc(s,f,g))}}function Py(s,l,f,g,x,_){switch(f){case"style":gd(s,g,_);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"children":typeof g=="string"?Ar(s,g):(typeof g=="number"||typeof g=="bigint")&&Ar(s,""+g);break;case"onScroll":g!=null&&pt("scroll",s);break;case"onScrollEnd":g!=null&&pt("scrollend",s);break;case"onClick":g!=null&&(s.onclick=ji);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ld.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(x=f.endsWith("Capture"),l=f.slice(2,x?f.length-7:void 0),_=s[Gn]||null,_=_!=null?_[f]:null,typeof _=="function"&&s.removeEventListener(l,_,x),typeof g=="function")){typeof _!="function"&&_!==null&&(f in s?s[f]=null:s.hasAttribute(f)&&s.removeAttribute(f)),s.addEventListener(l,g,x);break e}f in s?s[f]=g:g===!0?s.setAttribute(f,""):hc(s,f,g)}}}function Zn(s,l,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":pt("error",s),pt("load",s);var g=!1,x=!1,_;for(_ in f)if(f.hasOwnProperty(_)){var I=f[_];if(I!=null)switch(_){case"src":g=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Ut(s,l,_,I,f,null)}}x&&Ut(s,l,"srcSet",f.srcSet,f,null),g&&Ut(s,l,"src",f.src,f,null);return;case"input":pt("invalid",s);var $=_=I=x=null,J=null,fe=null;for(g in f)if(f.hasOwnProperty(g)){var ve=f[g];if(ve!=null)switch(g){case"name":x=ve;break;case"type":I=ve;break;case"checked":J=ve;break;case"defaultChecked":fe=ve;break;case"value":_=ve;break;case"defaultValue":$=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(r(137,l));break;default:Ut(s,l,g,ve,f,null)}}Qh(s,_,$,J,fe,I,x,!1);return;case"select":pt("invalid",s),g=I=_=null;for(x in f)if(f.hasOwnProperty(x)&&($=f[x],$!=null))switch(x){case"value":_=$;break;case"defaultValue":I=$;break;case"multiple":g=$;default:Ut(s,l,x,$,f,null)}l=_,f=I,s.multiple=!!g,l!=null?zs(s,!!g,l,!1):f!=null&&zs(s,!!g,f,!0);return;case"textarea":pt("invalid",s),_=x=g=null;for(I in f)if(f.hasOwnProperty(I)&&($=f[I],$!=null))switch(I){case"value":g=$;break;case"defaultValue":x=$;break;case"children":_=$;break;case"dangerouslySetInnerHTML":if($!=null)throw Error(r(91));break;default:Ut(s,l,I,$,f,null)}Ls(s,g,x,_);return;case"option":for(J in f)if(f.hasOwnProperty(J)&&(g=f[J],g!=null))switch(J){case"selected":s.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:Ut(s,l,J,g,f,null)}return;case"dialog":pt("beforetoggle",s),pt("toggle",s),pt("cancel",s),pt("close",s);break;case"iframe":case"object":pt("load",s);break;case"video":case"audio":for(g=0;g<Wd.length;g++)pt(Wd[g],s);break;case"image":pt("error",s),pt("load",s);break;case"details":pt("toggle",s);break;case"embed":case"source":case"link":pt("error",s),pt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(fe in f)if(f.hasOwnProperty(fe)&&(g=f[fe],g!=null))switch(fe){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Ut(s,l,fe,g,f,null)}return;default:if(gc(l)){for(ve in f)f.hasOwnProperty(ve)&&(g=f[ve],g!==void 0&&Py(s,l,ve,g,f,void 0));return}}for($ in f)f.hasOwnProperty($)&&(g=f[$],g!=null&&Ut(s,l,$,g,f,null))}function nj(s,l,f,g){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,_=null,I=null,$=null,J=null,fe=null,ve=null;for(me in f){var we=f[me];if(f.hasOwnProperty(me)&&we!=null)switch(me){case"checked":break;case"value":break;case"defaultValue":J=we;default:g.hasOwnProperty(me)||Ut(s,l,me,null,g,we)}}for(var he in g){var me=g[he];if(we=f[he],g.hasOwnProperty(he)&&(me!=null||we!=null))switch(he){case"type":_=me;break;case"name":x=me;break;case"checked":fe=me;break;case"defaultChecked":ve=me;break;case"value":I=me;break;case"defaultValue":$=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(r(137,l));break;default:me!==we&&Ut(s,l,he,me,g,we)}}pc(s,I,$,J,fe,ve,_,x);return;case"select":me=I=$=he=null;for(_ in f)if(J=f[_],f.hasOwnProperty(_)&&J!=null)switch(_){case"value":break;case"multiple":me=J;default:g.hasOwnProperty(_)||Ut(s,l,_,null,g,J)}for(x in g)if(_=g[x],J=f[x],g.hasOwnProperty(x)&&(_!=null||J!=null))switch(x){case"value":he=_;break;case"defaultValue":$=_;break;case"multiple":I=_;default:_!==J&&Ut(s,l,x,_,g,J)}l=$,f=I,g=me,he!=null?zs(s,!!f,he,!1):!!g!=!!f&&(l!=null?zs(s,!!f,l,!0):zs(s,!!f,f?[]:"",!1));return;case"textarea":me=he=null;for($ in f)if(x=f[$],f.hasOwnProperty($)&&x!=null&&!g.hasOwnProperty($))switch($){case"value":break;case"children":break;default:Ut(s,l,$,null,g,x)}for(I in g)if(x=g[I],_=f[I],g.hasOwnProperty(I)&&(x!=null||_!=null))switch(I){case"value":he=x;break;case"defaultValue":me=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==_&&Ut(s,l,I,x,g,_)}Zh(s,he,me);return;case"option":for(var ze in f)if(he=f[ze],f.hasOwnProperty(ze)&&he!=null&&!g.hasOwnProperty(ze))switch(ze){case"selected":s.selected=!1;break;default:Ut(s,l,ze,null,g,he)}for(J in g)if(he=g[J],me=f[J],g.hasOwnProperty(J)&&he!==me&&(he!=null||me!=null))switch(J){case"selected":s.selected=he&&typeof he!="function"&&typeof he!="symbol";break;default:Ut(s,l,J,he,g,me)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Xe in f)he=f[Xe],f.hasOwnProperty(Xe)&&he!=null&&!g.hasOwnProperty(Xe)&&Ut(s,l,Xe,null,g,he);for(fe in g)if(he=g[fe],me=f[fe],g.hasOwnProperty(fe)&&he!==me&&(he!=null||me!=null))switch(fe){case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(r(137,l));break;default:Ut(s,l,fe,he,g,me)}return;default:if(gc(l)){for(var Ft in f)he=f[Ft],f.hasOwnProperty(Ft)&&he!==void 0&&!g.hasOwnProperty(Ft)&&Py(s,l,Ft,void 0,g,he);for(ve in g)he=g[ve],me=f[ve],!g.hasOwnProperty(ve)||he===me||he===void 0&&me===void 0||Py(s,l,ve,he,g,me);return}}for(var oe in f)he=f[oe],f.hasOwnProperty(oe)&&he!=null&&!g.hasOwnProperty(oe)&&Ut(s,l,oe,null,g,he);for(we in g)he=g[we],me=f[we],!g.hasOwnProperty(we)||he===me||he==null&&me==null||Ut(s,l,we,he,g,me)}function JT(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function rj(){if(typeof performance.getEntriesByType=="function"){for(var s=0,l=0,f=performance.getEntriesByType("resource"),g=0;g<f.length;g++){var x=f[g],_=x.transferSize,I=x.initiatorType,$=x.duration;if(_&&$&&JT(I)){for(I=0,$=x.responseEnd,g+=1;g<f.length;g++){var J=f[g],fe=J.startTime;if(fe>$)break;var ve=J.transferSize,we=J.initiatorType;ve&&JT(we)&&(J=J.responseEnd,I+=ve*(J<$?1:($-fe)/(J-fe)))}if(--g,l+=8*(_+I)/(x.duration/1e3),s++,10<s)break}}if(0<s)return l/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var jy=null,Vy=null;function tg(s){return s.nodeType===9?s:s.ownerDocument}function eA(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function tA(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function zy(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Ly=null;function ij(){var s=window.event;return s&&s.type==="popstate"?s===Ly?!1:(Ly=s,!0):(Ly=null,!1)}var nA=typeof setTimeout=="function"?setTimeout:void 0,aj=typeof clearTimeout=="function"?clearTimeout:void 0,rA=typeof Promise=="function"?Promise:void 0,sj=typeof queueMicrotask=="function"?queueMicrotask:typeof rA<"u"?function(s){return rA.resolve(null).then(s).catch(oj)}:nA;function oj(s){setTimeout(function(){throw s})}function lo(s){return s==="head"}function iA(s,l){var f=l,g=0;do{var x=f.nextSibling;if(s.removeChild(f),x&&x.nodeType===8)if(f=x.data,f==="/$"||f==="/&"){if(g===0){s.removeChild(x),Kc(l);return}g--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")g++;else if(f==="html")Qd(s.ownerDocument.documentElement);else if(f==="head"){f=s.ownerDocument.head,Qd(f);for(var _=f.firstChild;_;){var I=_.nextSibling,$=_.nodeName;_[la]||$==="SCRIPT"||$==="STYLE"||$==="LINK"&&_.rel.toLowerCase()==="stylesheet"||f.removeChild(_),_=I}}else f==="body"&&Qd(s.ownerDocument.body);f=x}while(f);Kc(l)}function aA(s,l){var f=s;s=0;do{var g=f.nextSibling;if(f.nodeType===1?l?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(l?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),g&&g.nodeType===8)if(f=g.data,f==="/$"){if(s===0)break;s--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||s++;f=g}while(f)}function By(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var f=l;switch(l=l.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":By(f),fc(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}s.removeChild(f)}}function lj(s,l,f,g){for(;s.nodeType===1;){var x=f;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!g&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(g){if(!s[la])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(_=s.getAttribute("rel"),_==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(_!==x.rel||s.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||s.getAttribute("title")!==(x.title==null?null:x.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(_=s.getAttribute("src"),(_!==(x.src==null?null:x.src)||s.getAttribute("type")!==(x.type==null?null:x.type)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&_&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var _=x.name==null?null:""+x.name;if(x.type==="hidden"&&s.getAttribute("name")===_)return s}else return s;if(s=mi(s.nextSibling),s===null)break}return null}function cj(s,l,f){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!f||(s=mi(s.nextSibling),s===null))return null;return s}function sA(s,l){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=mi(s.nextSibling),s===null))return null;return s}function Uy(s){return s.data==="$?"||s.data==="$~"}function Fy(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function uj(s,l){var f=s.ownerDocument;if(s.data==="$~")s._reactRetry=l;else if(s.data!=="$?"||f.readyState!=="loading")l();else{var g=function(){l(),f.removeEventListener("DOMContentLoaded",g)};f.addEventListener("DOMContentLoaded",g),s._reactRetry=g}}function mi(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return s}var $y=null;function oA(s){s=s.nextSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="/$"||f==="/&"){if(l===0)return mi(s.nextSibling);l--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||l++}s=s.nextSibling}return null}function lA(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(l===0)return s;l--}else f!=="/$"&&f!=="/&"||l++}s=s.previousSibling}return null}function cA(s,l,f){switch(l=tg(f),s){case"html":if(s=l.documentElement,!s)throw Error(r(452));return s;case"head":if(s=l.head,!s)throw Error(r(453));return s;case"body":if(s=l.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function Qd(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);fc(s)}var vi=new Map,uA=new Set;function ng(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ds=Q.d;Q.d={f:dj,r:fj,D:hj,C:pj,L:gj,m:mj,X:yj,S:vj,M:bj};function dj(){var s=ds.f(),l=Yp();return s||l}function fj(s){var l=si(s);l!==null&&l.tag===5&&l.type==="form"?CE(l):ds.r(s)}var Yc=typeof document>"u"?null:document;function dA(s,l,f){var g=Yc;if(g&&typeof l=="string"&&l){var x=Tr(l);x='link[rel="'+s+'"][href="'+x+'"]',typeof f=="string"&&(x+='[crossorigin="'+f+'"]'),uA.has(x)||(uA.add(x),s={rel:s,crossOrigin:f,href:l},g.querySelector(x)===null&&(l=g.createElement("link"),Zn(l,"link",s),Tn(l),g.head.appendChild(l)))}}function hj(s){ds.D(s),dA("dns-prefetch",s,null)}function pj(s,l){ds.C(s,l),dA("preconnect",s,l)}function gj(s,l,f){ds.L(s,l,f);var g=Yc;if(g&&s&&l){var x='link[rel="preload"][as="'+Tr(l)+'"]';l==="image"&&f&&f.imageSrcSet?(x+='[imagesrcset="'+Tr(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(x+='[imagesizes="'+Tr(f.imageSizes)+'"]')):x+='[href="'+Tr(s)+'"]';var _=x;switch(l){case"style":_=Xc(s);break;case"script":_=Wc(s)}vi.has(_)||(s=p({rel:"preload",href:l==="image"&&f&&f.imageSrcSet?void 0:s,as:l},f),vi.set(_,s),g.querySelector(x)!==null||l==="style"&&g.querySelector(Zd(_))||l==="script"&&g.querySelector(Jd(_))||(l=g.createElement("link"),Zn(l,"link",s),Tn(l),g.head.appendChild(l)))}}function mj(s,l){ds.m(s,l);var f=Yc;if(f&&s){var g=l&&typeof l.as=="string"?l.as:"script",x='link[rel="modulepreload"][as="'+Tr(g)+'"][href="'+Tr(s)+'"]',_=x;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=Wc(s)}if(!vi.has(_)&&(s=p({rel:"modulepreload",href:s},l),vi.set(_,s),f.querySelector(x)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Jd(_)))return}g=f.createElement("link"),Zn(g,"link",s),Tn(g),f.head.appendChild(g)}}}function vj(s,l,f){ds.S(s,l,f);var g=Yc;if(g&&s){var x=ua(g).hoistableStyles,_=Xc(s);l=l||"default";var I=x.get(_);if(!I){var $={loading:0,preload:null};if(I=g.querySelector(Zd(_)))$.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":l},f),(f=vi.get(_))&&Gy(s,f);var J=I=g.createElement("link");Tn(J),Zn(J,"link",s),J._p=new Promise(function(fe,ve){J.onload=fe,J.onerror=ve}),J.addEventListener("load",function(){$.loading|=1}),J.addEventListener("error",function(){$.loading|=2}),$.loading|=4,rg(I,l,g)}I={type:"stylesheet",instance:I,count:1,state:$},x.set(_,I)}}}function yj(s,l){ds.X(s,l);var f=Yc;if(f&&s){var g=ua(f).hoistableScripts,x=Wc(s),_=g.get(x);_||(_=f.querySelector(Jd(x)),_||(s=p({src:s,async:!0},l),(l=vi.get(x))&&Hy(s,l),_=f.createElement("script"),Tn(_),Zn(_,"link",s),f.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},g.set(x,_))}}function bj(s,l){ds.M(s,l);var f=Yc;if(f&&s){var g=ua(f).hoistableScripts,x=Wc(s),_=g.get(x);_||(_=f.querySelector(Jd(x)),_||(s=p({src:s,async:!0,type:"module"},l),(l=vi.get(x))&&Hy(s,l),_=f.createElement("script"),Tn(_),Zn(_,"link",s),f.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},g.set(x,_))}}function fA(s,l,f,g){var x=(x=ie.current)?ng(x):null;if(!x)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(l=Xc(f.href),f=ua(x).hoistableStyles,g=f.get(l),g||(g={type:"style",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){s=Xc(f.href);var _=ua(x).hoistableStyles,I=_.get(s);if(I||(x=x.ownerDocument||x,I={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(s,I),(_=x.querySelector(Zd(s)))&&!_._p&&(I.instance=_,I.state.loading=5),vi.has(s)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},vi.set(s,f),_||xj(x,s,f,I.state))),l&&g===null)throw Error(r(528,""));return I}if(l&&g!==null)throw Error(r(529,""));return null;case"script":return l=f.async,f=f.src,typeof f=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Wc(f),f=ua(x).hoistableScripts,g=f.get(l),g||(g={type:"script",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Xc(s){return'href="'+Tr(s)+'"'}function Zd(s){return'link[rel="stylesheet"]['+s+"]"}function hA(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function xj(s,l,f,g){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?g.loading=1:(l=s.createElement("link"),g.preload=l,l.addEventListener("load",function(){return g.loading|=1}),l.addEventListener("error",function(){return g.loading|=2}),Zn(l,"link",f),Tn(l),s.head.appendChild(l))}function Wc(s){return'[src="'+Tr(s)+'"]'}function Jd(s){return"script[async]"+s}function pA(s,l,f){if(l.count++,l.instance===null)switch(l.type){case"style":var g=s.querySelector('style[data-href~="'+Tr(f.href)+'"]');if(g)return l.instance=g,Tn(g),g;var x=p({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return g=(s.ownerDocument||s).createElement("style"),Tn(g),Zn(g,"style",x),rg(g,f.precedence,s),l.instance=g;case"stylesheet":x=Xc(f.href);var _=s.querySelector(Zd(x));if(_)return l.state.loading|=4,l.instance=_,Tn(_),_;g=hA(f),(x=vi.get(x))&&Gy(g,x),_=(s.ownerDocument||s).createElement("link"),Tn(_);var I=_;return I._p=new Promise(function($,J){I.onload=$,I.onerror=J}),Zn(_,"link",g),l.state.loading|=4,rg(_,f.precedence,s),l.instance=_;case"script":return _=Wc(f.src),(x=s.querySelector(Jd(_)))?(l.instance=x,Tn(x),x):(g=f,(x=vi.get(_))&&(g=p({},f),Hy(g,x)),s=s.ownerDocument||s,x=s.createElement("script"),Tn(x),Zn(x,"link",g),s.head.appendChild(x),l.instance=x);case"void":return null;default:throw Error(r(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(g=l.instance,l.state.loading|=4,rg(g,f.precedence,s));return l.instance}function rg(s,l,f){for(var g=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=g.length?g[g.length-1]:null,_=x,I=0;I<g.length;I++){var $=g[I];if($.dataset.precedence===l)_=$;else if(_!==x)break}_?_.parentNode.insertBefore(s,_.nextSibling):(l=f.nodeType===9?f.head:f,l.insertBefore(s,l.firstChild))}function Gy(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function Hy(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var ig=null;function gA(s,l,f){if(ig===null){var g=new Map,x=ig=new Map;x.set(f,g)}else x=ig,g=x.get(f),g||(g=new Map,x.set(f,g));if(g.has(s))return g;for(g.set(s,null),f=f.getElementsByTagName(s),x=0;x<f.length;x++){var _=f[x];if(!(_[la]||_[En]||s==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var I=_.getAttribute(l)||"";I=s+I;var $=g.get(I);$?$.push(_):g.set(I,[_])}}return g}function mA(s,l,f){s=s.ownerDocument||s,s.head.insertBefore(f,l==="title"?s.querySelector("head > title"):null)}function wj(s,l,f){if(f===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return s=l.disabled,typeof l.precedence=="string"&&s==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function vA(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function _j(s,l,f,g){if(f.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var x=Xc(g.href),_=l.querySelector(Zd(x));if(_){l=_._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(s.count++,s=ag.bind(s),l.then(s,s)),f.state.loading|=4,f.instance=_,Tn(_);return}_=l.ownerDocument||l,g=hA(g),(x=vi.get(x))&&Gy(g,x),_=_.createElement("link"),Tn(_);var I=_;I._p=new Promise(function($,J){I.onload=$,I.onerror=J}),Zn(_,"link",g),f.instance=_}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(f,l),(l=f.state.preload)&&(f.state.loading&3)===0&&(s.count++,f=ag.bind(s),l.addEventListener("load",f),l.addEventListener("error",f))}}var qy=0;function Sj(s,l){return s.stylesheets&&s.count===0&&og(s,s.stylesheets),0<s.count||0<s.imgCount?function(f){var g=setTimeout(function(){if(s.stylesheets&&og(s,s.stylesheets),s.unsuspend){var _=s.unsuspend;s.unsuspend=null,_()}},6e4+l);0<s.imgBytes&&qy===0&&(qy=62500*rj());var x=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&og(s,s.stylesheets),s.unsuspend)){var _=s.unsuspend;s.unsuspend=null,_()}},(s.imgBytes>qy?50:800)+l);return s.unsuspend=f,function(){s.unsuspend=null,clearTimeout(g),clearTimeout(x)}}:null}function ag(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)og(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var sg=null;function og(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,sg=new Map,l.forEach(Ej,s),sg=null,ag.call(s))}function Ej(s,l){if(!(l.state.loading&4)){var f=sg.get(s);if(f)var g=f.get(null);else{f=new Map,sg.set(s,f);for(var x=s.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<x.length;_++){var I=x[_];(I.nodeName==="LINK"||I.getAttribute("media")!=="not all")&&(f.set(I.dataset.precedence,I),g=I)}g&&f.set(null,g)}x=l.instance,I=x.getAttribute("data-precedence"),_=f.get(I)||g,_===g&&f.set(null,x),f.set(I,x),this.count++,g=ag.bind(this),x.addEventListener("load",g),x.addEventListener("error",g),_?_.parentNode.insertBefore(x,_.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(x,s.firstChild)),l.state.loading|=4}}var ef={$$typeof:N,Provider:null,Consumer:null,_currentValue:te,_currentValue2:te,_threadCount:0};function Tj(s,l,f,g,x,_,I,$,J){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=sa(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=sa(0),this.hiddenUpdates=sa(null),this.identifierPrefix=g,this.onUncaughtError=x,this.onCaughtError=_,this.onRecoverableError=I,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=J,this.incompleteTransitions=new Map}function yA(s,l,f,g,x,_,I,$,J,fe,ve,we){return s=new Tj(s,l,f,I,J,fe,ve,we,$),l=1,_===!0&&(l|=24),_=Yr(3,null,null,l),s.current=_,_.stateNode=s,l=Tv(),l.refCount++,s.pooledCache=l,l.refCount++,_.memoizedState={element:g,isDehydrated:f,cache:l},Rv(_),s}function bA(s){return s?(s=Ac,s):Ac}function xA(s,l,f,g,x,_){x=bA(x),g.context===null?g.context=x:g.pendingContext=x,g=Qs(l),g.payload={element:f},_=_===void 0?null:_,_!==null&&(g.callback=_),f=Zs(s,g,l),f!==null&&(Dr(f,s,l),Id(f,s,l))}function wA(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var f=s.retryLane;s.retryLane=f!==0&&f<l?f:l}}function Yy(s,l){wA(s,l),(s=s.alternate)&&wA(s,l)}function _A(s){if(s.tag===13||s.tag===31){var l=yl(s,67108864);l!==null&&Dr(l,s,67108864),Yy(s,67108864)}}function SA(s){if(s.tag===13||s.tag===31){var l=Zr();l=sl(l);var f=yl(s,l);f!==null&&Dr(f,s,l),Yy(s,l)}}var lg=!0;function Aj(s,l,f,g){var x=q.T;q.T=null;var _=Q.p;try{Q.p=2,Xy(s,l,f,g)}finally{Q.p=_,q.T=x}}function Cj(s,l,f,g){var x=q.T;q.T=null;var _=Q.p;try{Q.p=8,Xy(s,l,f,g)}finally{Q.p=_,q.T=x}}function Xy(s,l,f,g){if(lg){var x=Wy(g);if(x===null)Oy(s,l,g,cg,f),TA(s,g);else if(Rj(x,s,l,f,g))g.stopPropagation();else if(TA(s,g),l&4&&-1<kj.indexOf(s)){for(;x!==null;){var _=si(x);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var I=$r(_.pendingLanes);if(I!==0){var $=_;for($.pendingLanes|=2,$.entangledLanes|=2;I;){var J=1<<31-tn(I);$.entanglements[1]|=J,I&=~J}Sa(_),(Dt&6)===0&&(Hp=ut()+500,Xd(0))}}break;case 31:case 13:$=yl(_,2),$!==null&&Dr($,_,2),Yp(),Yy(_,2)}if(_=Wy(g),_===null&&Oy(s,l,g,cg,f),_===x)break;x=_}x!==null&&g.stopPropagation()}else Oy(s,l,g,null,f)}}function Wy(s){return s=oi(s),Ky(s)}var cg=null;function Ky(s){if(cg=null,s=ca(s),s!==null){var l=a(s);if(l===null)s=null;else{var f=l.tag;if(f===13){if(s=o(l),s!==null)return s;s=null}else if(f===31){if(s=c(l),s!==null)return s;s=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return cg=s,null}function EA(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Rt()){case cn:return 2;case It:return 8;case _n:case Ur:return 32;case aa:return 268435456;default:return 32}default:return 32}}var Qy=!1,co=null,uo=null,fo=null,tf=new Map,nf=new Map,ho=[],kj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function TA(s,l){switch(s){case"focusin":case"focusout":co=null;break;case"dragenter":case"dragleave":uo=null;break;case"mouseover":case"mouseout":fo=null;break;case"pointerover":case"pointerout":tf.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":nf.delete(l.pointerId)}}function rf(s,l,f,g,x,_){return s===null||s.nativeEvent!==_?(s={blockedOn:l,domEventName:f,eventSystemFlags:g,nativeEvent:_,targetContainers:[x]},l!==null&&(l=si(l),l!==null&&_A(l)),s):(s.eventSystemFlags|=g,l=s.targetContainers,x!==null&&l.indexOf(x)===-1&&l.push(x),s)}function Rj(s,l,f,g,x){switch(l){case"focusin":return co=rf(co,s,l,f,g,x),!0;case"dragenter":return uo=rf(uo,s,l,f,g,x),!0;case"mouseover":return fo=rf(fo,s,l,f,g,x),!0;case"pointerover":var _=x.pointerId;return tf.set(_,rf(tf.get(_)||null,s,l,f,g,x)),!0;case"gotpointercapture":return _=x.pointerId,nf.set(_,rf(nf.get(_)||null,s,l,f,g,x)),!0}return!1}function AA(s){var l=ca(s.target);if(l!==null){var f=a(l);if(f!==null){if(l=f.tag,l===13){if(l=o(f),l!==null){s.blockedOn=l,Oi(s.priority,function(){SA(f)});return}}else if(l===31){if(l=c(f),l!==null){s.blockedOn=l,Oi(s.priority,function(){SA(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){s.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ug(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var f=Wy(s.nativeEvent);if(f===null){f=s.nativeEvent;var g=new f.constructor(f.type,f);md=g,f.target.dispatchEvent(g),md=null}else return l=si(f),l!==null&&_A(l),s.blockedOn=f,!1;l.shift()}return!0}function CA(s,l,f){ug(s)&&f.delete(l)}function Nj(){Qy=!1,co!==null&&ug(co)&&(co=null),uo!==null&&ug(uo)&&(uo=null),fo!==null&&ug(fo)&&(fo=null),tf.forEach(CA),nf.forEach(CA)}function dg(s,l){s.blockedOn===l&&(s.blockedOn=null,Qy||(Qy=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Nj)))}var fg=null;function kA(s){fg!==s&&(fg=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){fg===s&&(fg=null);for(var l=0;l<s.length;l+=3){var f=s[l],g=s[l+1],x=s[l+2];if(typeof g!="function"){if(Ky(g||f)===null)continue;break}var _=si(f);_!==null&&(s.splice(l,3),l-=3,Wv(_,{pending:!0,data:x,method:f.method,action:g},g,x))}}))}function Kc(s){function l(J){return dg(J,s)}co!==null&&dg(co,s),uo!==null&&dg(uo,s),fo!==null&&dg(fo,s),tf.forEach(l),nf.forEach(l);for(var f=0;f<ho.length;f++){var g=ho[f];g.blockedOn===s&&(g.blockedOn=null)}for(;0<ho.length&&(f=ho[0],f.blockedOn===null);)AA(f),f.blockedOn===null&&ho.shift();if(f=(s.ownerDocument||s).$$reactFormReplay,f!=null)for(g=0;g<f.length;g+=3){var x=f[g],_=f[g+1],I=x[Gn]||null;if(typeof _=="function")I||kA(f);else if(I){var $=null;if(_&&_.hasAttribute("formAction")){if(x=_,I=_[Gn]||null)$=I.formAction;else if(Ky(x)!==null)continue}else $=I.action;typeof $=="function"?f[g+1]=$:(f.splice(g,3),g-=3),kA(f)}}}function RA(){function s(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(I){return x=I})},focusReset:"manual",scroll:"manual"})}function l(){x!==null&&(x(),x=null),g||setTimeout(f,20)}function f(){if(!g&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,x=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(f,100),function(){g=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),x!==null&&(x(),x=null)}}}function Zy(s){this._internalRoot=s}hg.prototype.render=Zy.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(r(409));var f=l.current,g=Zr();xA(f,g,s,l,null,null)},hg.prototype.unmount=Zy.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;xA(s.current,2,null,s,null,null),Yp(),l[oa]=null}};function hg(s){this._internalRoot=s}hg.prototype.unstable_scheduleHydration=function(s){if(s){var l=Yh();s={blockedOn:null,target:s,priority:l};for(var f=0;f<ho.length&&l!==0&&l<ho[f].priority;f++);ho.splice(f,0,s),f===0&&AA(s)}};var NA=e.version;if(NA!=="19.2.0")throw Error(r(527,NA,"19.2.0"));Q.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(l),s=s!==null?h(s):null,s=s===null?null:s.stateNode,s};var Dj={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pg.isDisabled&&pg.supportsFiber)try{Fr=pg.inject(Dj),Sn=pg}catch{}}return sf.createRoot=function(s,l){if(!i(s))throw Error(r(299));var f=!1,g="",x=VE,_=zE,I=LE;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(_=l.onCaughtError),l.onRecoverableError!==void 0&&(I=l.onRecoverableError)),l=yA(s,1,!1,null,null,f,g,null,x,_,I,RA),s[oa]=l.current,My(s),new Zy(l)},sf.hydrateRoot=function(s,l,f){if(!i(s))throw Error(r(299));var g=!1,x="",_=VE,I=zE,$=LE,J=null;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onUncaughtError!==void 0&&(_=f.onUncaughtError),f.onCaughtError!==void 0&&(I=f.onCaughtError),f.onRecoverableError!==void 0&&($=f.onRecoverableError),f.formState!==void 0&&(J=f.formState)),l=yA(s,1,!0,l,f??null,g,x,J,_,I,$,RA),l.context=bA(null),f=l.current,g=Zr(),g=sl(g),x=Qs(g),x.callback=null,Zs(f,x,g),f=g,l.current.lanes=f,il(l,f),Sa(l),s[oa]=l.current,My(s),new hg(l)},sf.version="19.2.0",sf}var BA;function Fj(){if(BA)return tb.exports;BA=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),tb.exports=Uj(),tb.exports}var $j=Fj();const Gj="modulepreload",Hj=function(t){return"/personal-budget-pwa/"+t},UA={},Tt=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){let u=function(d){return Promise.all(d.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");i=u(n.map(d=>{if(d=Hj(d),d in UA)return;UA[d]=!0;const h=d.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${p}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":Gj,h||(m.as="script"),m.crossOrigin="",m.href=d,c&&m.setAttribute("nonce",c),document.head.appendChild(m),h)return new Promise((b,w)=>{m.addEventListener("load",b),m.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return i.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};function qj(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:a,onRegisterError:o}=t;let c,u;const d=async(p=!0)=>{await u};async function h(){if("serviceWorker"in navigator){if(c=await Tt(async()=>{const{Workbox:p}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/personal-budget-pwa/sw.js",{scope:"/personal-budget-pwa/",type:"classic"})).catch(p=>{o?.(p)}),!c)return;c.addEventListener("activated",p=>{(p.isUpdate||p.isExternal)&&window.location.reload()}),c.addEventListener("installed",p=>{p.isUpdate||r?.()}),c.register({immediate:e}).then(p=>{a?a("/personal-budget-pwa/sw.js",p):i?.(p)}).catch(p=>{o?.(p)})}}return u=h(),d}const Yj=()=>{};var FA={};const rN=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Xj=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[n++];e[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[n++],o=t[n++],c=t[n++],u=((i&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const a=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return e.join("")},iN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const a=t[i],o=i+1<t.length,c=o?t[i+1]:0,u=i+2<t.length,d=u?t[i+2]:0,h=a>>2,p=(a&3)<<4|c>>4;let m=(c&15)<<2|d>>6,b=d&63;u||(b=64,o||(m=64)),r.push(n[h],n[p],n[m],n[b])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(rN(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Xj(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const a=n[t.charAt(i++)],c=i<t.length?n[t.charAt(i)]:0;++i;const d=i<t.length?n[t.charAt(i)]:64;++i;const p=i<t.length?n[t.charAt(i)]:64;if(++i,a==null||c==null||d==null||p==null)throw new Wj;const m=a<<2|c>>4;if(r.push(m),d!==64){const b=c<<4&240|d>>2;if(r.push(b),p!==64){const w=d<<6&192|p;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Wj extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Kj=function(t){const e=rN(t);return iN.encodeByteArray(e,!0)},um=function(t){return Kj(t).replace(/\./g,"")},aN=function(t){try{return iN.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Qj(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Zj=()=>Qj().__FIREBASE_DEFAULTS__,Jj=()=>{if(typeof process>"u"||typeof FA>"u")return;const t=FA.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},e5=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&aN(t[1]);return e&&JSON.parse(e)},a0=()=>{try{return Yj()||Zj()||Jj()||e5()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},sN=t=>a0()?.emulatorHosts?.[t],oN=t=>{const e=sN(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},lN=()=>a0()?.config,cN=t=>a0()?.[`_${t}`];class t5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}function Qo(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function j1(t){return(await fetch(t,{credentials:"include"})).ok}function n5(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...t};return[um(JSON.stringify(n)),um(JSON.stringify(o)),""].join(".")}const _f={};function r5(){const t={prod:[],emulator:[]};for(const e of Object.keys(_f))_f[e]?t.emulator.push(e):t.prod.push(e);return t}function i5(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let $A=!1;function V1(t,e){if(typeof window>"u"||typeof document>"u"||!Qo(window.location.host)||_f[t]===e||_f[t]||$A)return;_f[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",a=r5().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function c(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,b){m.setAttribute("width","24"),m.setAttribute("id",b),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{$A=!0,o()},m}function h(m,b){m.setAttribute("id",b),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=i5(r),b=n("text"),w=document.getElementById(b)||document.createElement("span"),S=n("learnmore"),E=document.getElementById(S)||document.createElement("a"),T=n("preprendIcon"),C=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const N=m.element;c(N),h(E,S);const j=d();u(C,T),N.append(C,w,E,j),document.body.appendChild(N)}a?(w.innerText="Preview backend disconnected.",C.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(C.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function dr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function a5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(dr())}function s5(){const t=a0()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function o5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function l5(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function c5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function u5(){const t=dr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function d5(){return!s5()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function f5(){try{return typeof indexedDB=="object"}catch{return!1}}function h5(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(n){e(n)}})}const p5="FirebaseError";class $a extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=p5,Object.setPrototypeOf(this,$a.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,dh.prototype.create)}}class dh{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,a=this.errors[e],o=a?g5(a,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new $a(i,c,r)}}function g5(t,e){return t.replace(m5,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const m5=/\{\$([^}]+)}/g;function v5(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Po(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const a=t[i],o=e[i];if(GA(a)&&GA(o)){if(!Po(a,o))return!1}else if(a!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function GA(t){return t!==null&&typeof t=="object"}function fh(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function df(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,a]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function ff(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function y5(t,e){const n=new b5(t,e);return n.subscribe.bind(n)}class b5{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");x5(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=ab),i.error===void 0&&(i.error=ab),i.complete===void 0&&(i.complete=ab);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function x5(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function ab(){}function Ot(t){return t&&t._delegate?t._delegate:t}let jo=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};const Il="[DEFAULT]";let w5=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new t5;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(S5(e))try{this.getOrInitializeService({instanceIdentifier:Il})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const a=this.getOrInitializeService({instanceIdentifier:i});r.resolve(a)}catch{}}}}clearInstance(e=Il){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Il){return this.instances.has(e)}getOptions(e=Il){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[a,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);r===c&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const a=this.instances.get(r);return a&&e(a,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:_5(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Il){return this.component?this.component.multipleInstances?e:Il:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function _5(t){return t===Il?void 0:t}function S5(t){return t.instantiationMode==="EAGER"}class E5{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new w5(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var bt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(bt||(bt={}));const T5={debug:bt.DEBUG,verbose:bt.VERBOSE,info:bt.INFO,warn:bt.WARN,error:bt.ERROR,silent:bt.SILENT},A5=bt.INFO,C5={[bt.DEBUG]:"log",[bt.VERBOSE]:"log",[bt.INFO]:"info",[bt.WARN]:"warn",[bt.ERROR]:"error"},k5=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=C5[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class z1{constructor(e){this.name=e,this._logLevel=A5,this._logHandler=k5,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in bt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?T5[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,bt.DEBUG,...e),this._logHandler(this,bt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,bt.VERBOSE,...e),this._logHandler(this,bt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,bt.INFO,...e),this._logHandler(this,bt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,bt.WARN,...e),this._logHandler(this,bt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,bt.ERROR,...e),this._logHandler(this,bt.ERROR,...e)}}const R5=(t,e)=>e.some(n=>t instanceof n);let HA,qA;function N5(){return HA||(HA=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function D5(){return qA||(qA=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const uN=new WeakMap,ix=new WeakMap,dN=new WeakMap,sb=new WeakMap,L1=new WeakMap;function I5(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{n(No(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&uN.set(n,t)}).catch(()=>{}),L1.set(e,t),e}function M5(t){if(ix.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});ix.set(t,e)}let ax={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ix.get(t);if(e==="objectStoreNames")return t.objectStoreNames||dN.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return No(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function O5(t){ax=t(ax)}function P5(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(ob(this),e,...n);return dN.set(r,e.sort?e.sort():[e]),No(r)}:D5().includes(t)?function(...e){return t.apply(ob(this),e),No(uN.get(this))}:function(...e){return No(t.apply(ob(this),e))}}function j5(t){return typeof t=="function"?P5(t):(t instanceof IDBTransaction&&M5(t),R5(t,N5())?new Proxy(t,ax):t)}function No(t){if(t instanceof IDBRequest)return I5(t);if(sb.has(t))return sb.get(t);const e=j5(t);return e!==t&&(sb.set(t,e),L1.set(e,t)),e}const ob=t=>L1.get(t);function V5(t,e,{blocked:n,upgrade:r,blocking:i,terminated:a}={}){const o=indexedDB.open(t,e),c=No(o);return r&&o.addEventListener("upgradeneeded",u=>{r(No(o.result),u.oldVersion,u.newVersion,No(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),c.then(u=>{a&&u.addEventListener("close",()=>a()),i&&u.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const z5=["get","getKey","getAll","getAllKeys","count"],L5=["put","add","delete","clear"],lb=new Map;function YA(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(lb.get(e))return lb.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=L5.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||z5.includes(n)))return;const a=async function(o,...c){const u=this.transaction(o,i?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[n](...c),i&&u.done]))[0]};return lb.set(e,a),a}O5(t=>({...t,get:(e,n,r)=>YA(e,n)||t.get(e,n,r),has:(e,n)=>!!YA(e,n)||t.has(e,n)}));class B5{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(U5(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function U5(t){return t.getComponent()?.type==="VERSION"}const sx="@firebase/app",XA="0.14.6";const Es=new z1("@firebase/app"),F5="@firebase/app-compat",$5="@firebase/analytics-compat",G5="@firebase/analytics",H5="@firebase/app-check-compat",q5="@firebase/app-check",Y5="@firebase/auth",X5="@firebase/auth-compat",W5="@firebase/database",K5="@firebase/data-connect",Q5="@firebase/database-compat",Z5="@firebase/functions",J5="@firebase/functions-compat",eV="@firebase/installations",tV="@firebase/installations-compat",nV="@firebase/messaging",rV="@firebase/messaging-compat",iV="@firebase/performance",aV="@firebase/performance-compat",sV="@firebase/remote-config",oV="@firebase/remote-config-compat",lV="@firebase/storage",cV="@firebase/storage-compat",uV="@firebase/firestore",dV="@firebase/ai",fV="@firebase/firestore-compat",hV="firebase",pV="12.6.0";const ox="[DEFAULT]",gV={[sx]:"fire-core",[F5]:"fire-core-compat",[G5]:"fire-analytics",[$5]:"fire-analytics-compat",[q5]:"fire-app-check",[H5]:"fire-app-check-compat",[Y5]:"fire-auth",[X5]:"fire-auth-compat",[W5]:"fire-rtdb",[K5]:"fire-data-connect",[Q5]:"fire-rtdb-compat",[Z5]:"fire-fn",[J5]:"fire-fn-compat",[eV]:"fire-iid",[tV]:"fire-iid-compat",[nV]:"fire-fcm",[rV]:"fire-fcm-compat",[iV]:"fire-perf",[aV]:"fire-perf-compat",[sV]:"fire-rc",[oV]:"fire-rc-compat",[lV]:"fire-gcs",[cV]:"fire-gcs-compat",[uV]:"fire-fst",[fV]:"fire-fst-compat",[dV]:"fire-vertex","fire-js":"fire-js",[hV]:"fire-js-all"};const dm=new Map,mV=new Map,lx=new Map;function WA(t,e){try{t.container.addComponent(e)}catch(n){Es.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Xl(t){const e=t.name;if(lx.has(e))return Es.debug(`There were multiple attempts to register component ${e}.`),!1;lx.set(e,t);for(const n of dm.values())WA(n,t);for(const n of mV.values())WA(n,t);return!0}function s0(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function ti(t){return t==null?!1:t.settings!==void 0}const vV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Do=new dh("app","Firebase",vV);class yV{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new jo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Do.create("app-deleted",{appName:this._name})}}const Fu=pV;function fN(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:ox,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Do.create("bad-app-name",{appName:String(i)});if(n||(n=lN()),!n)throw Do.create("no-options");const a=dm.get(i);if(a){if(Po(n,a.options)&&Po(r,a.config))return a;throw Do.create("duplicate-app",{appName:i})}const o=new E5(i);for(const u of lx.values())o.addComponent(u);const c=new yV(n,r,o);return dm.set(i,c),c}function B1(t=ox){const e=dm.get(t);if(!e&&t===ox&&lN())return fN();if(!e)throw Do.create("no-app",{appName:t});return e}function Ra(t,e,n){let r=gV[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Es.warn(o.join(" "));return}Xl(new jo(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const bV="firebase-heartbeat-database",xV=1,Lf="firebase-heartbeat-store";let cb=null;function hN(){return cb||(cb=V5(bV,xV,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Lf)}catch(n){console.warn(n)}}}}).catch(t=>{throw Do.create("idb-open",{originalErrorMessage:t.message})})),cb}async function wV(t){try{const n=(await hN()).transaction(Lf),r=await n.objectStore(Lf).get(pN(t));return await n.done,r}catch(e){if(e instanceof $a)Es.warn(e.message);else{const n=Do.create("idb-get",{originalErrorMessage:e?.message});Es.warn(n.message)}}}async function KA(t,e){try{const r=(await hN()).transaction(Lf,"readwrite");await r.objectStore(Lf).put(e,pN(t)),await r.done}catch(n){if(n instanceof $a)Es.warn(n.message);else{const r=Do.create("idb-set",{originalErrorMessage:n?.message});Es.warn(r.message)}}}function pN(t){return`${t.name}!${t.options.appId}`}const _V=1024,SV=30;class EV{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new AV(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=QA();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>SV){const i=CV(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Es.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=QA(),{heartbeatsToSend:n,unsentEntries:r}=TV(this._heartbeatsCache.heartbeats),i=um(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Es.warn(e),""}}}function QA(){return new Date().toISOString().substring(0,10)}function TV(t,e=_V){const n=[];let r=t.slice();for(const i of t){const a=n.find(o=>o.agent===i.agent);if(a){if(a.dates.push(i.date),ZA(n)>e){a.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),ZA(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class AV{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return f5()?h5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await wV(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return KA(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return KA(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function ZA(t){return um(JSON.stringify({version:2,heartbeats:t})).length}function CV(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}function kV(t){Xl(new jo("platform-logger",e=>new B5(e),"PRIVATE")),Xl(new jo("heartbeat",e=>new EV(e),"PRIVATE")),Ra(sx,XA,t),Ra(sx,XA,"esm2020"),Ra("fire-js","")}kV("");function gN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const RV=gN,mN=new dh("auth","Firebase",gN());const fm=new z1("@firebase/auth");function NV(t,...e){fm.logLevel<=bt.WARN&&fm.warn(`Auth (${Fu}): ${t}`,...e)}function Fg(t,...e){fm.logLevel<=bt.ERROR&&fm.error(`Auth (${Fu}): ${t}`,...e)}function Qi(t,...e){throw U1(t,...e)}function Na(t,...e){return U1(t,...e)}function vN(t,e,n){const r={...RV(),[e]:n};return new dh("auth","Firebase",r).create(e,{appName:t.name})}function ys(t){return vN(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function U1(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return mN.create(t,...e)}function Ye(t,e,...n){if(!t)throw U1(e,...n)}function gs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Fg(e),new Error(e)}function Ts(t,e){t||gs(e)}function cx(){return typeof self<"u"&&self.location?.href||""}function DV(){return JA()==="http:"||JA()==="https:"}function JA(){return typeof self<"u"&&self.location?.protocol||null}function IV(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(DV()||l5()||"connection"in navigator)?navigator.onLine:!0}function MV(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class hh{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ts(n>e,"Short delay should be less than long delay!"),this.isMobile=a5()||c5()}get(){return IV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function F1(t,e){Ts(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class yN{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;gs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;gs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;gs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const OV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const PV=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],jV=new hh(3e4,6e4);function na(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Ii(t,e,n,r,i={}){return bN(t,i,async()=>{let a={},o={};r&&(e==="GET"?o=r:a={body:JSON.stringify(r)});const c=fh({key:t.config.apiKey,...o}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:u,...a};return o5()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Qo(t.emulatorConfig.host)&&(d.credentials="include"),yN.fetch()(await xN(t,t.config.apiHost,n,c),d)})}async function bN(t,e,n){t._canInitEmulator=!1;const r={...OV,...e};try{const i=new zV(t),a=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw gg(t,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const c=a.ok?o.errorMessage:o.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw gg(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw gg(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw gg(t,"user-disabled",o);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw vN(t,h,d);Qi(t,h)}}catch(i){if(i instanceof $a)throw i;Qi(t,"network-request-failed",{message:String(i)})}}async function ph(t,e,n,r,i={}){const a=await Ii(t,e,n,r,i);return"mfaPendingCredential"in a&&Qi(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function xN(t,e,n,r){const i=`${e}${n}?${r}`,a=t,o=a.config.emulator?F1(t.config,i):`${t.config.apiScheme}://${i}`;return PV.includes(n)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(o).toString():o}function VV(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class zV{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Na(this.auth,"network-request-failed")),jV.get())})}}function gg(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Na(t,e,r);return i.customData._tokenResponse=n,i}function eC(t){return t!==void 0&&t.enterprise!==void 0}class LV{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return VV(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function BV(t,e){return Ii(t,"GET","/v2/recaptchaConfig",na(t,e))}async function UV(t,e){return Ii(t,"POST","/v1/accounts:delete",e)}async function hm(t,e){return Ii(t,"POST","/v1/accounts:lookup",e)}function Sf(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function FV(t,e=!1){const n=Ot(t),r=await n.getIdToken(e),i=$1(r);Ye(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,o=a?.sign_in_provider;return{claims:i,token:r,authTime:Sf(ub(i.auth_time)),issuedAtTime:Sf(ub(i.iat)),expirationTime:Sf(ub(i.exp)),signInProvider:o||null,signInSecondFactor:a?.sign_in_second_factor||null}}function ub(t){return Number(t)*1e3}function $1(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Fg("JWT malformed, contained fewer than 3 sections"),null;try{const i=aN(n);return i?JSON.parse(i):(Fg("Failed to decode base64 JWT payload"),null)}catch(i){return Fg("Caught error parsing JWT payload as JSON",i?.toString()),null}}function tC(t){const e=$1(t);return Ye(e,"internal-error"),Ye(typeof e.exp<"u","internal-error"),Ye(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function _u(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof $a&&$V(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function $V({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class GV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class ux{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Sf(this.lastLoginAt),this.creationTime=Sf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function pm(t){const e=t.auth,n=await t.getIdToken(),r=await _u(t,hm(e,{idToken:n}));Ye(r?.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const a=i.providerUserInfo?.length?wN(i.providerUserInfo):[],o=qV(t.providerData,a),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!o?.length,d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new ux(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function HV(t){const e=Ot(t);await pm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function qV(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function wN(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function YV(t,e){const n=await bN(t,{},async()=>{const r=fh({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=t.config,o=await xN(t,i,"/v1/token",`key=${a}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:r};return t.emulatorConfig&&Qo(t.emulatorConfig.host)&&(u.credentials="include"),yN.fetch()(o,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function XV(t,e){return Ii(t,"POST","/v2/accounts:revokeToken",na(t,e))}class gu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ye(e.idToken,"internal-error"),Ye(typeof e.idToken<"u","internal-error"),Ye(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):tC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ye(e.length!==0,"internal-error");const n=tC(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ye(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:a}=await YV(e,n);this.updateTokensAndExpiration(r,i,Number(a))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:a}=n,o=new gu;return r&&(Ye(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Ye(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),a&&(Ye(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new gu,this.toJSON())}_performRefresh(){return gs("not implemented")}}function go(t,e){Ye(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Yi{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new GV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new ux(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await _u(this,this.stsTokenManager.getToken(this.auth,e));return Ye(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return FV(this,e)}reload(){return HV(this)}_assign(e){this!==e&&(Ye(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Yi({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Ye(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await pm(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ti(this.auth.app))return Promise.reject(ys(this.auth));const e=await this.getIdToken();return await _u(this,UV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,a=n.phoneNumber??void 0,o=n.photoURL??void 0,c=n.tenantId??void 0,u=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:b,providerData:w,stsTokenManager:S}=n;Ye(p&&S,e,"internal-error");const E=gu.fromJSON(this.name,S);Ye(typeof p=="string",e,"internal-error"),go(r,e.name),go(i,e.name),Ye(typeof m=="boolean",e,"internal-error"),Ye(typeof b=="boolean",e,"internal-error"),go(a,e.name),go(o,e.name),go(c,e.name),go(u,e.name),go(d,e.name),go(h,e.name);const T=new Yi({uid:p,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:b,photoURL:o,phoneNumber:a,tenantId:c,stsTokenManager:E,createdAt:d,lastLoginAt:h});return w&&Array.isArray(w)&&(T.providerData=w.map(C=>({...C}))),u&&(T._redirectEventId=u),T}static async _fromIdTokenResponse(e,n,r=!1){const i=new gu;i.updateFromServerResponse(n);const a=new Yi({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await pm(a),a}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];Ye(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?wN(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!a?.length,c=new gu;c.updateFromIdToken(r);const u=new Yi({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new ux(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(u,d),u}}const nC=new Map;function ms(t){Ts(t instanceof Function,"Expected a class definition");let e=nC.get(t);return e?(Ts(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,nC.set(t,e),e)}class _N{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}_N.type="NONE";const rC=_N;function $g(t,e,n){return`firebase:${t}:${e}:${n}`}class mu{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:a}=this.auth;this.fullUserKey=$g(this.userKey,i.apiKey,a),this.fullPersistenceKey=$g("persistence",i.apiKey,a),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await hm(this.auth,{idToken:e}).catch(()=>{});return n?Yi._fromGetAccountInfoResponse(this.auth,n,e):null}return Yi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new mu(ms(rC),e,r);const i=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let a=i[0]||ms(rC);const o=$g(r,e.config.apiKey,e.name);let c=null;for(const d of n)try{const h=await d._get(o);if(h){let p;if(typeof h=="string"){const m=await hm(e,{idToken:h}).catch(()=>{});if(!m)break;p=await Yi._fromGetAccountInfoResponse(e,m,h)}else p=Yi._fromJSON(e,h);d!==a&&(c=p),a=d;break}}catch{}const u=i.filter(d=>d._shouldAllowMigration);return!a._shouldAllowMigration||!u.length?new mu(a,e,r):(a=u[0],c&&await a._set(o,c.toJSON()),await Promise.all(n.map(async d=>{if(d!==a)try{await d._remove(o)}catch{}})),new mu(a,e,r))}}function iC(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(AN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(SN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(kN(e))return"Blackberry";if(RN(e))return"Webos";if(EN(e))return"Safari";if((e.includes("chrome/")||TN(e))&&!e.includes("edge/"))return"Chrome";if(CN(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if(r?.length===2)return r[1]}return"Other"}function SN(t=dr()){return/firefox\//i.test(t)}function EN(t=dr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function TN(t=dr()){return/crios\//i.test(t)}function AN(t=dr()){return/iemobile/i.test(t)}function CN(t=dr()){return/android/i.test(t)}function kN(t=dr()){return/blackberry/i.test(t)}function RN(t=dr()){return/webos/i.test(t)}function G1(t=dr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function WV(t=dr()){return G1(t)&&!!window.navigator?.standalone}function KV(){return u5()&&document.documentMode===10}function NN(t=dr()){return G1(t)||CN(t)||RN(t)||kN(t)||/windows phone/i.test(t)||AN(t)}function DN(t,e=[]){let n;switch(t){case"Browser":n=iC(dr());break;case"Worker":n=`${iC(dr())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Fu}/${r}`}class QV{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=a=>new Promise((o,c)=>{try{const u=e(a);o(u)}catch(u){c(u)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function ZV(t,e={}){return Ii(t,"GET","/v2/passwordPolicy",na(t,e))}const JV=6;class e6{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??JV,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class t6{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new aC(this),this.idTokenSubscription=new aC(this),this.beforeStateQueue=new QV(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ms(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await mu.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await hm(this,{idToken:e}),r=await Yi._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ti(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,o=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===o)&&c?.user&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ye(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await pm(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=MV()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ti(this.app))return Promise.reject(ys(this));const n=e?Ot(e):null;return n&&Ye(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ye(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ti(this.app)?Promise.reject(ys(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ti(this.app)?Promise.reject(ys(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ms(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ZV(this),n=new e6(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new dh("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await XV(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ms(e)||this._popupRedirectResolver;Ye(n,this,"argument-error"),this.redirectPersistenceManager=await mu.create(this,[ms(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const a=typeof n=="function"?n:n.next.bind(n);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ye(c,this,"internal-error"),c.then(()=>{o||a(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,i);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ye(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=DN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(ti(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&NV(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Zo(t){return Ot(t)}class aC{constructor(e){this.auth=e,this.observer=null,this.addObserver=y5(n=>this.observer=n)}get next(){return Ye(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let o0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function n6(t){o0=t}function IN(t){return o0.loadJS(t)}function r6(){return o0.recaptchaEnterpriseScript}function i6(){return o0.gapiScript}function a6(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class s6{constructor(){this.enterprise=new o6}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class o6{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const l6="recaptcha-enterprise",MN="NO_RECAPTCHA";class c6{constructor(e){this.type=l6,this.auth=Zo(e)}async verify(e="verify",n=!1){async function r(a){if(!n){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,c)=>{BV(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new LV(u);return a.tenantId==null?a._agentRecaptchaConfig=d:a._tenantRecaptchaConfigs[a.tenantId]=d,o(d.siteKey)}}).catch(u=>{c(u)})})}function i(a,o,c){const u=window.grecaptcha;eC(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:e}).then(d=>{o(d)}).catch(()=>{o(MN)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new s6().execute("siteKey",{action:"verify"}):new Promise((a,o)=>{r(this.auth).then(c=>{if(!n&&eC(window.grecaptcha))i(c,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=r6();u.length!==0&&(u+=c),IN(u).then(()=>{i(c,a,o)}).catch(d=>{o(d)})}}).catch(c=>{o(c)})})}}async function sC(t,e,n,r=!1,i=!1){const a=new c6(t);let o;if(i)o=MN;else try{o=await a.verify(n)}catch{o=await a.verify(n,!0)}const c={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function gm(t,e,n,r,i){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await sC(t,e,n,n==="getOobCode");return r(t,a)}else return r(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await sC(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(a)})}function u6(t,e){const n=s0(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),a=n.getOptions();if(Po(a,e??{}))return i;Qi(i,"already-initialized")}return n.initialize({options:e})}function d6(t,e){const n=e?.persistence||[],r=(Array.isArray(n)?n:[n]).map(ms);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e?.popupRedirectResolver)}function f6(t,e,n){const r=Zo(t);Ye(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,a=ON(e),{host:o,port:c}=h6(e),u=c===null?"":`:${c}`,d={url:`${a}//${o}${u}/`},h=Object.freeze({host:o,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Ye(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Ye(Po(d,r.config.emulator)&&Po(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Qo(o)?(j1(`${a}//${o}${u}`),V1("Auth",!0)):p6()}function ON(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function h6(t){const e=ON(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const a=i[1];return{host:a,port:oC(r.substr(a.length+1))}}else{const[a,o]=r.split(":");return{host:a,port:oC(o)}}}function oC(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function p6(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class H1{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return gs("not implemented")}_getIdTokenResponse(e){return gs("not implemented")}_linkToIdToken(e,n){return gs("not implemented")}_getReauthenticationResolver(e){return gs("not implemented")}}async function g6(t,e){return Ii(t,"POST","/v1/accounts:resetPassword",na(t,e))}async function m6(t,e){return Ii(t,"POST","/v1/accounts:signUp",e)}async function v6(t,e){return Ii(t,"POST","/v1/accounts:update",na(t,e))}async function y6(t,e){return ph(t,"POST","/v1/accounts:signInWithPassword",na(t,e))}async function PN(t,e){return Ii(t,"POST","/v1/accounts:sendOobCode",na(t,e))}async function b6(t,e){return PN(t,e)}async function x6(t,e){return PN(t,e)}async function w6(t,e){return ph(t,"POST","/v1/accounts:signInWithEmailLink",na(t,e))}async function _6(t,e){return ph(t,"POST","/v1/accounts:signInWithEmailLink",na(t,e))}class Bf extends H1{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new Bf(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Bf(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return gm(e,n,"signInWithPassword",y6);case"emailLink":return w6(e,{email:this._email,oobCode:this._password});default:Qi(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return gm(e,r,"signUpPassword",m6);case"emailLink":return _6(e,{idToken:n,email:this._email,oobCode:this._password});default:Qi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function vu(t,e){return ph(t,"POST","/v1/accounts:signInWithIdp",na(t,e))}const S6="http://localhost";class Wl extends H1{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Wl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Qi("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...a}=n;if(!r||!i)return null;const o=new Wl(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return vu(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,vu(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,vu(e,n)}buildRequest(){const e={requestUri:S6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=fh(n)}return e}}function E6(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function T6(t){const e=df(ff(t)).link,n=e?df(ff(e)).deep_link_id:null,r=df(ff(t)).deep_link_id;return(r?df(ff(r)).link:null)||r||n||e||t}class q1{constructor(e){const n=df(ff(e)),r=n.apiKey??null,i=n.oobCode??null,a=E6(n.mode??null);Ye(r&&i&&a,"argument-error"),this.apiKey=r,this.operation=a,this.code=i,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=T6(e);try{return new q1(n)}catch{return null}}}class rc{constructor(){this.providerId=rc.PROVIDER_ID}static credential(e,n){return Bf._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=q1.parseLink(n);return Ye(r,"argument-error"),Bf._fromEmailAndCode(e,r.code,r.tenantId)}}rc.PROVIDER_ID="password";rc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";rc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class jN{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class gh extends jN{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class xo extends gh{constructor(){super("facebook.com")}static credential(e){return Wl._fromParams({providerId:xo.PROVIDER_ID,signInMethod:xo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xo.credentialFromTaggedObject(e)}static credentialFromError(e){return xo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xo.credential(e.oauthAccessToken)}catch{return null}}}xo.FACEBOOK_SIGN_IN_METHOD="facebook.com";xo.PROVIDER_ID="facebook.com";class wo extends gh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Wl._fromParams({providerId:wo.PROVIDER_ID,signInMethod:wo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return wo.credentialFromTaggedObject(e)}static credentialFromError(e){return wo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return wo.credential(n,r)}catch{return null}}}wo.GOOGLE_SIGN_IN_METHOD="google.com";wo.PROVIDER_ID="google.com";class _o extends gh{constructor(){super("github.com")}static credential(e){return Wl._fromParams({providerId:_o.PROVIDER_ID,signInMethod:_o.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _o.credentialFromTaggedObject(e)}static credentialFromError(e){return _o.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _o.credential(e.oauthAccessToken)}catch{return null}}}_o.GITHUB_SIGN_IN_METHOD="github.com";_o.PROVIDER_ID="github.com";class So extends gh{constructor(){super("twitter.com")}static credential(e,n){return Wl._fromParams({providerId:So.PROVIDER_ID,signInMethod:So.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return So.credentialFromTaggedObject(e)}static credentialFromError(e){return So.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return So.credential(n,r)}catch{return null}}}So.TWITTER_SIGN_IN_METHOD="twitter.com";So.PROVIDER_ID="twitter.com";async function A6(t,e){return ph(t,"POST","/v1/accounts:signUp",na(t,e))}class Kl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const a=await Yi._fromIdTokenResponse(e,r,i),o=lC(r);return new Kl({user:a,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=lC(r);return new Kl({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function lC(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class mm extends $a{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,mm.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new mm(e,n,r,i)}}function VN(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?mm._fromErrorAndOperation(t,a,e,r):a})}async function C6(t,e,n=!1){const r=await _u(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Kl._forOperation(t,"link",r)}async function zN(t,e,n=!1){const{auth:r}=t;if(ti(r.app))return Promise.reject(ys(r));const i="reauthenticate";try{const a=await _u(t,VN(r,i,e,t),n);Ye(a.idToken,r,"internal-error");const o=$1(a.idToken);Ye(o,r,"internal-error");const{sub:c}=o;return Ye(t.uid===c,r,"user-mismatch"),Kl._forOperation(t,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&Qi(r,"user-mismatch"),a}}async function LN(t,e,n=!1){if(ti(t.app))return Promise.reject(ys(t));const r="signIn",i=await VN(t,r,e),a=await Kl._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(a.user),a}async function k6(t,e){return LN(Zo(t),e)}async function R6(t,e){return zN(Ot(t),e)}function N6(t,e,n){Ye(n.url?.length>0,t,"invalid-continue-uri"),Ye(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),Ye(typeof n.linkDomain>"u"||n.linkDomain.length>0,t,"invalid-hosting-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.linkDomain=n.linkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Ye(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(Ye(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}async function Y1(t){const e=Zo(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function D6(t,e,n){const r=Zo(t);await gm(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",x6)}async function I6(t,e,n){await g6(Ot(t),{oobCode:e,newPassword:n}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Y1(t),r})}async function M6(t,e){await v6(Ot(t),{oobCode:e})}async function O6(t,e,n){if(ti(t.app))return Promise.reject(ys(t));const r=Zo(t),o=await gm(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",A6).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&Y1(t),u}),c=await Kl._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(c.user),c}function P6(t,e,n){return ti(t.app)?Promise.reject(ys(t)):k6(Ot(t),rc.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Y1(t),r})}async function cC(t,e){const n=Ot(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};e&&N6(n.auth,i,e);const{email:a}=await b6(n.auth,i);a!==t.email&&await t.reload()}async function j6(t,e){return Ii(t,"POST","/v1/accounts:update",e)}async function V6(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=Ot(t),a={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await _u(r,j6(r.auth,a));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const c=r.providerData.find(({providerId:u})=>u==="password");c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function z6(t,e,n,r){return Ot(t).onIdTokenChanged(e,n,r)}function L6(t,e,n){return Ot(t).beforeAuthStateChanged(e,n)}function B6(t,e,n,r){return Ot(t).onAuthStateChanged(e,n,r)}function uC(t){return Ot(t).signOut()}async function U6(t){return Ot(t).delete()}const vm="__sak";class BN{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(vm,"1"),this.storage.removeItem(vm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const F6=1e3,$6=10;class UN extends BN{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=NN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},a=this.storage.getItem(r);KV()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,$6):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},F6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}UN.type="LOCAL";const G6=UN;class FN extends BN{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}FN.type="SESSION";const $N=FN;function H6(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class l0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new l0(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:a}=n.data,o=this.handlersMap[i];if(!o?.size)return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const c=Array.from(o).map(async d=>d(n.origin,a)),u=await H6(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}l0.receivers=[];function X1(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}class q6{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,o;return new Promise((c,u)=>{const d=X1("",20);i.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const m=p;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),a=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(m.data.response);break;default:clearTimeout(h),clearTimeout(a),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Da(){return window}function Y6(t){Da().location.href=t}function GN(){return typeof Da().WorkerGlobalScope<"u"&&typeof Da().importScripts=="function"}async function X6(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function W6(){return navigator?.serviceWorker?.controller||null}function K6(){return GN()?self:null}const HN="firebaseLocalStorageDb",Q6=1,ym="firebaseLocalStorage",qN="fbase_key";class mh{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function c0(t,e){return t.transaction([ym],e?"readwrite":"readonly").objectStore(ym)}function Z6(){const t=indexedDB.deleteDatabase(HN);return new mh(t).toPromise()}function dx(){const t=indexedDB.open(HN,Q6);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(ym,{keyPath:qN})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(ym)?e(r):(r.close(),await Z6(),e(await dx()))})})}async function dC(t,e,n){const r=c0(t,!0).put({[qN]:e,value:n});return new mh(r).toPromise()}async function J6(t,e){const n=c0(t,!1).get(e),r=await new mh(n).toPromise();return r===void 0?null:r.value}function fC(t,e){const n=c0(t,!0).delete(e);return new mh(n).toPromise()}const ez=800,tz=3;class YN{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await dx(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>tz)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return GN()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=l0._getInstance(K6()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await X6(),!this.activeServiceWorker)return;this.sender=new q6(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||W6()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await dx();return await dC(e,vm,"1"),await fC(e,vm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>dC(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>J6(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>fC(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=c0(i,!1).getAll();return new mh(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ez)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}YN.type="LOCAL";const nz=YN;new hh(3e4,6e4);function rz(t,e){return e?ms(e):(Ye(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class W1 extends H1{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return vu(e,this._buildIdpRequest())}_linkToIdToken(e,n){return vu(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return vu(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function iz(t){return LN(t.auth,new W1(t),t.bypassAuthState)}function az(t){const{auth:e,user:n}=t;return Ye(n,e,"internal-error"),zN(n,new W1(t),t.bypassAuthState)}async function sz(t){const{auth:e,user:n}=t;return Ye(n,e,"internal-error"),C6(n,new W1(t),t.bypassAuthState)}class XN{constructor(e,n,r,i,a=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:a,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return iz;case"linkViaPopup":case"linkViaRedirect":return sz;case"reauthViaPopup":case"reauthViaRedirect":return az;default:Qi(this.auth,"internal-error")}}resolve(e){Ts(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ts(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const oz=new hh(2e3,1e4);class ru extends XN{constructor(e,n,r,i,a){super(e,n,i,a),this.provider=r,this.authWindow=null,this.pollId=null,ru.currentPopupAction&&ru.currentPopupAction.cancel(),ru.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ye(e,this.auth,"internal-error"),e}async onExecution(){Ts(this.filter.length===1,"Popup operations only handle one event");const e=X1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Na(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Na(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ru.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Na(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,oz.get())};e()}}ru.currentPopupAction=null;const lz="pendingRedirect",Gg=new Map;class cz extends XN{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Gg.get(this.auth._key());if(!e){try{const r=await uz(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Gg.set(this.auth._key(),e)}return this.bypassAuthState||Gg.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function uz(t,e){const n=hz(e),r=fz(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function dz(t,e){Gg.set(t._key(),e)}function fz(t){return ms(t._redirectPersistence)}function hz(t){return $g(lz,t.config.apiKey,t.name)}async function pz(t,e,n=!1){if(ti(t.app))return Promise.reject(ys(t));const r=Zo(t),i=rz(r,e),o=await new cz(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}const gz=600*1e3;class mz{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!vz(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!WN(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";n.onError(Na(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=gz&&this.cachedEventUids.clear(),this.cachedEventUids.has(hC(e))}saveEventToCache(e){this.cachedEventUids.add(hC(e)),this.lastProcessedEventTime=Date.now()}}function hC(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function WN({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function vz(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return WN(t);default:return!1}}async function yz(t,e={}){return Ii(t,"GET","/v1/projects",e)}const bz=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,xz=/^https?/;async function wz(t){if(t.config.emulator)return;const{authorizedDomains:e}=await yz(t);for(const n of e)try{if(_z(n))return}catch{}Qi(t,"unauthorized-domain")}function _z(t){const e=cx(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!xz.test(n))return!1;if(bz.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Sz=new hh(3e4,6e4);function pC(){const t=Da().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Ez(t){return new Promise((e,n)=>{function r(){pC(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{pC(),n(Na(t,"network-request-failed"))},timeout:Sz.get()})}if(Da().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Da().gapi?.load)r();else{const i=a6("iframefcb");return Da()[i]=()=>{gapi.load?r():n(Na(t,"network-request-failed"))},IN(`${i6()}?onload=${i}`).catch(a=>n(a))}}).catch(e=>{throw Hg=null,e})}let Hg=null;function Tz(t){return Hg=Hg||Ez(t),Hg}const Az=new hh(5e3,15e3),Cz="__/auth/iframe",kz="emulator/auth/iframe",Rz={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Nz=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Dz(t){const e=t.config;Ye(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?F1(e,kz):`https://${t.config.authDomain}/${Cz}`,r={apiKey:e.apiKey,appName:t.name,v:Fu},i=Nz.get(t.config.apiHost);i&&(r.eid=i);const a=t._getFrameworks();return a.length&&(r.fw=a.join(",")),`${n}?${fh(r).slice(1)}`}async function Iz(t){const e=await Tz(t),n=Da().gapi;return Ye(n,t,"internal-error"),e.open({where:document.body,url:Dz(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Rz,dontclear:!0},r=>new Promise(async(i,a)=>{await r.restyle({setHideOnLeave:!1});const o=Na(t,"network-request-failed"),c=Da().setTimeout(()=>{a(o)},Az.get());function u(){Da().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{a(o)})}))}const Mz={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Oz=500,Pz=600,jz="_blank",Vz="http://localhost";class gC{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function zz(t,e,n,r=Oz,i=Pz){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u={...Mz,width:r.toString(),height:i.toString(),top:a,left:o},d=dr().toLowerCase();n&&(c=TN(d)?jz:n),SN(d)&&(e=e||Vz,u.scrollbars="yes");const h=Object.entries(u).reduce((m,[b,w])=>`${m}${b}=${w},`,"");if(WV(d)&&c!=="_self")return Lz(e||"",c),new gC(null);const p=window.open(e||"",c,h);Ye(p,t,"popup-blocked");try{p.focus()}catch{}return new gC(p)}function Lz(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}const Bz="__/auth/handler",Uz="emulator/auth/handler",Fz=encodeURIComponent("fac");async function mC(t,e,n,r,i,a){Ye(t.config.authDomain,t,"auth-domain-config-required"),Ye(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Fu,eventId:i};if(e instanceof jN){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",v5(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))o[h]=p}if(e instanceof gh){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const h of Object.keys(c))c[h]===void 0&&delete c[h];const u=await t._getAppCheckToken(),d=u?`#${Fz}=${encodeURIComponent(u)}`:"";return`${$z(t)}?${fh(c).slice(1)}${d}`}function $z({config:t}){return t.emulator?F1(t,Uz):`https://${t.authDomain}/${Bz}`}const db="webStorageSupport";class Gz{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=$N,this._completeRedirectFn=pz,this._overrideRedirectResult=dz}async _openPopup(e,n,r,i){Ts(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await mC(e,n,r,cx(),i);return zz(e,a,X1())}async _openRedirect(e,n,r,i){await this._originValidation(e);const a=await mC(e,n,r,cx(),i);return Y6(a),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:a}=this.eventManagers[n];return i?Promise.resolve(i):(Ts(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await Iz(e),r=new mz(e);return n.register("authEvent",i=>(Ye(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(db,{type:db},i=>{const a=i?.[0]?.[db];a!==void 0&&n(!!a),Qi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=wz(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return NN()||EN()||G1()}}const Hz=Gz;var vC="@firebase/auth",yC="1.11.1";class qz{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ye(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Yz(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Xz(t){Xl(new jo("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;Ye(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:DN(t)},d=new t6(r,i,a,u);return d6(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Xl(new jo("auth-internal",e=>{const n=Zo(e.getProvider("auth").getImmediate());return(r=>new qz(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ra(vC,yC,Yz(t)),Ra(vC,yC,"esm2020")}const Wz=300,Kz=cN("authIdTokenMaxAge")||Wz;let bC=null;const Qz=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>Kz)return;const i=n?.token;bC!==i&&(bC=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Zz(t=B1()){const e=s0(t,"auth");if(e.isInitialized())return e.getImmediate();const n=u6(t,{popupRedirectResolver:Hz,persistence:[nz,G6,$N]}),r=cN("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const o=Qz(a.toString());L6(n,o,()=>o(n.currentUser)),z6(n,c=>o(c))}}const i=sN("auth");return i&&f6(n,`http://${i}`),n}function Jz(){return document.getElementsByTagName("head")?.[0]??document}n6({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const a=Na("internal-error");a.customData=i,n(a)},r.type="text/javascript",r.charset="UTF-8",Jz().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Xz("Browser");var xC="popstate";function eL(t={}){function e(i,a){let{pathname:o="/",search:c="",hash:u=""}=ic(i.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),fx("",{pathname:o,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(i,a){let o=i.document.querySelector("base"),c="";if(o&&o.getAttribute("href")){let u=i.location.href,d=u.indexOf("#");c=d===-1?u:u.slice(0,d)}return c+"#"+(typeof a=="string"?a:Uf(a))}function r(i,a){Ri(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(a)})`)}return nL(e,n,r,t)}function on(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ri(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function tL(){return Math.random().toString(36).substring(2,10)}function wC(t,e){return{usr:t.state,key:t.key,idx:e}}function fx(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?ic(e):e,state:n,key:e&&e.key||r||tL()}}function Uf({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function ic(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function nL(t,e,n,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,c="POP",u=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function p(){c="POP";let E=h(),T=E==null?null:E-d;d=E,u&&u({action:c,location:S.location,delta:T})}function m(E,T){c="PUSH";let C=fx(S.location,E,T);n&&n(C,E),d=h()+1;let N=wC(C,d),j=S.createHref(C);try{o.pushState(N,"",j)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;i.location.assign(j)}a&&u&&u({action:c,location:S.location,delta:1})}function b(E,T){c="REPLACE";let C=fx(S.location,E,T);n&&n(C,E),d=h();let N=wC(C,d),j=S.createHref(C);o.replaceState(N,"",j),a&&u&&u({action:c,location:S.location,delta:0})}function w(E){return rL(E)}let S={get action(){return c},get location(){return t(i,o)},listen(E){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(xC,p),u=E,()=>{i.removeEventListener(xC,p),u=null}},createHref(E){return e(i,E)},createURL:w,encodeLocation(E){let T=w(E);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:m,replace:b,go(E){return o.go(E)}};return S}function rL(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),on(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:Uf(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function KN(t,e,n="/"){return iL(t,e,n,!1)}function iL(t,e,n,r){let i=typeof e=="string"?ic(e):e,a=As(i.pathname||"/",n);if(a==null)return null;let o=QN(t);aL(o);let c=null;for(let u=0;c==null&&u<o.length;++u){let d=mL(a);c=pL(o[u],d,r)}return c}function QN(t,e=[],n=[],r="",i=!1){let a=(o,c,u=i,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&u)return;on(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let p=bs([r,h.relativePath]),m=n.concat(h);o.children&&o.children.length>0&&(on(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),QN(o.children,e,m,p,u)),!(o.path==null&&!o.index)&&e.push({path:p,score:fL(p,o.index),routesMeta:m})};return t.forEach((o,c)=>{if(o.path===""||!o.path?.includes("?"))a(o,c);else for(let u of ZN(o.path))a(o,c,!0,u)}),e}function ZN(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=ZN(r.join("/")),c=[];return c.push(...o.map(u=>u===""?a:[a,u].join("/"))),i&&c.push(...o),c.map(u=>t.startsWith("/")&&u===""?"/":u)}function aL(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:hL(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var sL=/^:[\w-]+$/,oL=3,lL=2,cL=1,uL=10,dL=-2,_C=t=>t==="*";function fL(t,e){let n=t.split("/"),r=n.length;return n.some(_C)&&(r+=dL),e&&(r+=lL),n.filter(i=>!_C(i)).reduce((i,a)=>i+(sL.test(a)?oL:a===""?cL:uL),r)}function hL(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function pL(t,e,n=!1){let{routesMeta:r}=t,i={},a="/",o=[];for(let c=0;c<r.length;++c){let u=r[c],d=c===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=bm({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),m=u.route;if(!p&&d&&n&&!r[r.length-1].route.index&&(p=bm({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:bs([a,p.pathname]),pathnameBase:xL(bs([a,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(a=bs([a,p.pathnameBase]))}return o}function bm(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=gL(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:p},m)=>{if(h==="*"){let w=c[m]||"";o=a.slice(0,a.length-w.length).replace(/(.)\/+$/,"$1")}const b=c[m];return p&&!b?d[h]=void 0:d[h]=(b||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:t}}function gL(t,e=!1,n=!0){Ri(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function mL(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ri(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function As(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var vL=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function yL(t,e="/"){let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?ic(t):t,a;return n?(n=n.replace(/\/\/+/g,"/"),n.startsWith("/")?a=SC(n.substring(1),"/"):a=SC(n,e)):a=e,{pathname:a,search:wL(r),hash:_L(i)}}function SC(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function fb(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function bL(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function JN(t){let e=bL(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function eD(t,e,n,r=!1){let i;typeof t=="string"?i=ic(t):(i={...t},on(!i.pathname||!i.pathname.includes("?"),fb("?","pathname","search",i)),on(!i.pathname||!i.pathname.includes("#"),fb("#","pathname","hash",i)),on(!i.search||!i.search.includes("#"),fb("#","search","hash",i)));let a=t===""||i.pathname==="",o=a?"/":i.pathname,c;if(o==null)c=n;else{let p=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;i.pathname=m.join("/")}c=p>=0?e[p]:"/"}let u=yL(i,c),d=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}var bs=t=>t.join("/").replace(/\/\/+/g,"/"),xL=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),wL=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,_L=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,SL=class{constructor(t,e,n,r=!1){this.status=t,this.statusText=e||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function EL(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function TL(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var tD=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function nD(t,e){let n=t;if(typeof n!="string"||!vL.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let r=n,i=!1;if(tD)try{let a=new URL(window.location.href),o=n.startsWith("//")?new URL(a.protocol+n):new URL(n),c=As(o.pathname,e);o.origin===a.origin&&c!=null?n=c+o.search+o.hash:i=!0}catch{Ri(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:i,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var rD=["POST","PUT","PATCH","DELETE"];new Set(rD);var AL=["GET",...rD];new Set(AL);var $u=B.createContext(null);$u.displayName="DataRouter";var u0=B.createContext(null);u0.displayName="DataRouterState";var CL=B.createContext(!1),iD=B.createContext({isTransitioning:!1});iD.displayName="ViewTransition";var kL=B.createContext(new Map);kL.displayName="Fetchers";var RL=B.createContext(null);RL.displayName="Await";var Mi=B.createContext(null);Mi.displayName="Navigation";var vh=B.createContext(null);vh.displayName="Location";var Ga=B.createContext({outlet:null,matches:[],isDataRoute:!1});Ga.displayName="Route";var K1=B.createContext(null);K1.displayName="RouteError";var aD="REACT_ROUTER_ERROR",NL="REDIRECT",DL="ROUTE_ERROR_RESPONSE";function IL(t){if(t.startsWith(`${aD}:${NL}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function ML(t){if(t.startsWith(`${aD}:${DL}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new SL(e.status,e.statusText,e.data)}catch{}}function OL(t,{relative:e}={}){on(yh(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=B.useContext(Mi),{hash:i,pathname:a,search:o}=bh(t,{relative:e}),c=a;return n!=="/"&&(c=a==="/"?n:bs([n,a])),r.createHref({pathname:c,search:o,hash:i})}function yh(){return B.useContext(vh)!=null}function ra(){return on(yh(),"useLocation() may be used only in the context of a <Router> component."),B.useContext(vh).location}var sD="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function oD(t){B.useContext(Mi).static||B.useLayoutEffect(t)}function ia(){let{isDataRoute:t}=B.useContext(Ga);return t?XL():PL()}function PL(){on(yh(),"useNavigate() may be used only in the context of a <Router> component.");let t=B.useContext($u),{basename:e,navigator:n}=B.useContext(Mi),{matches:r}=B.useContext(Ga),{pathname:i}=ra(),a=JSON.stringify(JN(r)),o=B.useRef(!1);return oD(()=>{o.current=!0}),B.useCallback((u,d={})=>{if(Ri(o.current,sD),!o.current)return;if(typeof u=="number"){n.go(u);return}let h=eD(u,JSON.parse(a),i,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:bs([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,a,i,t])}B.createContext(null);function jL(){let{matches:t}=B.useContext(Ga),e=t[t.length-1];return e?e.params:{}}function bh(t,{relative:e}={}){let{matches:n}=B.useContext(Ga),{pathname:r}=ra(),i=JSON.stringify(JN(n));return B.useMemo(()=>eD(t,JSON.parse(i),r,e==="path"),[t,i,r,e])}function VL(t,e){return lD(t,e)}function lD(t,e,n,r,i){on(yh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=B.useContext(Mi),{matches:o}=B.useContext(Ga),c=o[o.length-1],u=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",p=c&&c.route;{let C=p&&p.path||"";uD(d,!p||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let m=ra(),b;if(e){let C=typeof e=="string"?ic(e):e;on(h==="/"||C.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${C.pathname}" was given in the \`location\` prop.`),b=C}else b=m;let w=b.pathname||"/",S=w;if(h!=="/"){let C=h.replace(/^\//,"").split("/");S="/"+w.replace(/^\//,"").split("/").slice(C.length).join("/")}let E=KN(t,{pathname:S});Ri(p||E!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),Ri(E==null||E[E.length-1].route.element!==void 0||E[E.length-1].route.Component!==void 0||E[E.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=FL(E&&E.map(C=>Object.assign({},C,{params:Object.assign({},u,C.params),pathname:bs([h,a.encodeLocation?a.encodeLocation(C.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?h:bs([h,a.encodeLocation?a.encodeLocation(C.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathnameBase])})),o,n,r,i);return e&&T?B.createElement(vh.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},T):T}function zL(){let t=YL(),e=EL(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=B.createElement(B.Fragment,null,B.createElement("p",null," Hey developer "),B.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",B.createElement("code",{style:a},"ErrorBoundary")," or"," ",B.createElement("code",{style:a},"errorElement")," prop on your route.")),B.createElement(B.Fragment,null,B.createElement("h2",null,"Unexpected Application Error!"),B.createElement("h3",{style:{fontStyle:"italic"}},e),n?B.createElement("pre",{style:i},n):null,o)}var LL=B.createElement(zL,null),cD=class extends B.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=ML(t.digest);n&&(t=n)}let e=t!==void 0?B.createElement(Ga.Provider,{value:this.props.routeContext},B.createElement(K1.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?B.createElement(BL,{error:t},e):e}};cD.contextType=CL;var hb=new WeakMap;function BL({children:t,error:e}){let{basename:n}=B.useContext(Mi);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=IL(e.digest);if(r){let i=hb.get(e);if(i)throw i;let a=nD(r.location,n);if(tD&&!hb.get(e))if(a.isExternal||r.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:r.replace}));throw hb.set(e,o),o}return B.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return t}function UL({routeContext:t,match:e,children:n}){let r=B.useContext($u);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),B.createElement(Ga.Provider,{value:t},n)}function FL(t,e=[],n=null,r=null,i=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,o=n?.errors;if(o!=null){let h=a.findIndex(p=>p.route.id&&o?.[p.route.id]!==void 0);on(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let c=!1,u=-1;if(n)for(let h=0;h<a.length;h++){let p=a[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=h),p.route.id){let{loaderData:m,errors:b}=n,w=p.route.loader&&!m.hasOwnProperty(p.route.id)&&(!b||b[p.route.id]===void 0);if(p.route.lazy||w){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}let d=n&&r?(h,p)=>{r(h,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:TL(n.matches),errorInfo:p})}:void 0;return a.reduceRight((h,p,m)=>{let b,w=!1,S=null,E=null;n&&(b=o&&p.route.id?o[p.route.id]:void 0,S=p.route.errorElement||LL,c&&(u<0&&m===0?(uD("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,E=null):u===m&&(w=!0,E=p.route.hydrateFallbackElement||null)));let T=e.concat(a.slice(0,m+1)),C=()=>{let N;return b?N=S:w?N=E:p.route.Component?N=B.createElement(p.route.Component,null):p.route.element?N=p.route.element:N=h,B.createElement(UL,{match:p,routeContext:{outlet:h,matches:T,isDataRoute:n!=null},children:N})};return n&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?B.createElement(cD,{location:n.location,revalidation:n.revalidation,component:S,error:b,children:C(),routeContext:{outlet:null,matches:T,isDataRoute:!0},onError:d}):C()},null)}function Q1(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function $L(t){let e=B.useContext($u);return on(e,Q1(t)),e}function GL(t){let e=B.useContext(u0);return on(e,Q1(t)),e}function HL(t){let e=B.useContext(Ga);return on(e,Q1(t)),e}function Z1(t){let e=HL(t),n=e.matches[e.matches.length-1];return on(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function qL(){return Z1("useRouteId")}function YL(){let t=B.useContext(K1),e=GL("useRouteError"),n=Z1("useRouteError");return t!==void 0?t:e.errors?.[n]}function XL(){let{router:t}=$L("useNavigate"),e=Z1("useNavigate"),n=B.useRef(!1);return oD(()=>{n.current=!0}),B.useCallback(async(i,a={})=>{Ri(n.current,sD),n.current&&(typeof i=="number"?await t.navigate(i):await t.navigate(i,{fromRouteId:e,...a}))},[t,e])}var EC={};function uD(t,e,n){!e&&!EC[t]&&(EC[t]=!0,Ri(!1,n))}B.memo(WL);function WL({routes:t,future:e,state:n,onError:r}){return lD(t,void 0,n,r,e)}function hs(t){on(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function KL({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:i,static:a=!1,unstable_useTransitions:o}){on(!yh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),u=B.useMemo(()=>({basename:c,navigator:i,static:a,unstable_useTransitions:o,future:{}}),[c,i,a,o]);typeof n=="string"&&(n=ic(n));let{pathname:d="/",search:h="",hash:p="",state:m=null,key:b="default"}=n,w=B.useMemo(()=>{let S=As(d,c);return S==null?null:{location:{pathname:S,search:h,hash:p,state:m,key:b},navigationType:r}},[c,d,h,p,m,b,r]);return Ri(w!=null,`<Router basename="${c}"> is not able to match the URL "${d}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:B.createElement(Mi.Provider,{value:u},B.createElement(vh.Provider,{children:e,value:w}))}function QL({children:t,location:e}){return VL(hx(t),e)}function hx(t,e=[]){let n=[];return B.Children.forEach(t,(r,i)=>{if(!B.isValidElement(r))return;let a=[...e,i];if(r.type===B.Fragment){n.push.apply(n,hx(r.props.children,a));return}on(r.type===hs,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),on(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=hx(r.props.children,a)),n.push(o)}),n}var qg="get",Yg="application/x-www-form-urlencoded";function d0(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function ZL(t){return d0(t)&&t.tagName.toLowerCase()==="button"}function JL(t){return d0(t)&&t.tagName.toLowerCase()==="form"}function e9(t){return d0(t)&&t.tagName.toLowerCase()==="input"}function t9(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function n9(t,e){return t.button===0&&(!e||e==="_self")&&!t9(t)}function px(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(i=>[n,i]):[[n,r]])},[]))}function r9(t,e){let n=px(t);return e&&e.forEach((r,i)=>{n.has(i)||e.getAll(i).forEach(a=>{n.append(i,a)})}),n}var mg=null;function i9(){if(mg===null)try{new FormData(document.createElement("form"),0),mg=!1}catch{mg=!0}return mg}var a9=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function pb(t){return t!=null&&!a9.has(t)?(Ri(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Yg}"`),null):t}function s9(t,e){let n,r,i,a,o;if(JL(t)){let c=t.getAttribute("action");r=c?As(c,e):null,n=t.getAttribute("method")||qg,i=pb(t.getAttribute("enctype"))||Yg,a=new FormData(t)}else if(ZL(t)||e9(t)&&(t.type==="submit"||t.type==="image")){let c=t.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=t.getAttribute("formaction")||c.getAttribute("action");if(r=u?As(u,e):null,n=t.getAttribute("formmethod")||c.getAttribute("method")||qg,i=pb(t.getAttribute("formenctype"))||pb(c.getAttribute("enctype"))||Yg,a=new FormData(c,t),!i9()){let{name:d,type:h,value:p}=t;if(h==="image"){let m=d?`${d}.`:"";a.append(`${m}x`,"0"),a.append(`${m}y`,"0")}else d&&a.append(d,p)}}else{if(d0(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=qg,r=null,i=Yg,o=t}return a&&i==="text/plain"&&(o=a,a=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function J1(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function o9(t,e,n,r){let i=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n?i.pathname.endsWith("/")?i.pathname=`${i.pathname}_.${r}`:i.pathname=`${i.pathname}.${r}`:i.pathname==="/"?i.pathname=`_root.${r}`:e&&As(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${r}`,i}async function l9(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function c9(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function u9(t,e,n){let r=await Promise.all(t.map(async i=>{let a=e.routes[i.route.id];if(a){let o=await l9(a,n);return o.links?o.links():[]}return[]}));return p9(r.flat(1).filter(c9).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function TC(t,e,n,r,i,a){let o=(u,d)=>n[d]?u.route.id!==n[d].route.id:!0,c=(u,d)=>n[d].pathname!==u.pathname||n[d].route.path?.endsWith("*")&&n[d].params["*"]!==u.params["*"];return a==="assets"?e.filter((u,d)=>o(u,d)||c(u,d)):a==="data"?e.filter((u,d)=>{let h=r.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,d)||c(u,d))return!0;if(u.route.shouldRevalidate){let p=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function d9(t,e,{includeHydrateFallback:n}={}){return f9(t.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function f9(t){return[...new Set(t)]}function h9(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function p9(t,e){let n=new Set;return new Set(e),t.reduce((r,i)=>{let a=JSON.stringify(h9(i));return n.has(a)||(n.add(a),r.push({key:a,link:i})),r},[])}function dD(){let t=B.useContext($u);return J1(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function g9(){let t=B.useContext(u0);return J1(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var ew=B.createContext(void 0);ew.displayName="FrameworkContext";function fD(){let t=B.useContext(ew);return J1(t,"You must render this element inside a <HydratedRouter> element"),t}function m9(t,e){let n=B.useContext(ew),[r,i]=B.useState(!1),[a,o]=B.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:d,onMouseLeave:h,onTouchStart:p}=e,m=B.useRef(null);B.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let S=T=>{T.forEach(C=>{o(C.isIntersecting)})},E=new IntersectionObserver(S,{threshold:.5});return m.current&&E.observe(m.current),()=>{E.disconnect()}}},[t]),B.useEffect(()=>{if(r){let S=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(S)}}},[r]);let b=()=>{i(!0)},w=()=>{i(!1),o(!1)};return n?t!=="intent"?[a,m,{}]:[a,m,{onFocus:of(c,b),onBlur:of(u,w),onMouseEnter:of(d,b),onMouseLeave:of(h,w),onTouchStart:of(p,b)}]:[!1,m,{}]}function of(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function v9({page:t,...e}){let{router:n}=dD(),r=B.useMemo(()=>KN(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?B.createElement(b9,{page:t,matches:r,...e}):null}function y9(t){let{manifest:e,routeModules:n}=fD(),[r,i]=B.useState([]);return B.useEffect(()=>{let a=!1;return u9(t,e,n).then(o=>{a||i(o)}),()=>{a=!0}},[t,e,n]),r}function b9({page:t,matches:e,...n}){let r=ra(),{future:i,manifest:a,routeModules:o}=fD(),{basename:c}=dD(),{loaderData:u,matches:d}=g9(),h=B.useMemo(()=>TC(t,e,d,a,r,"data"),[t,e,d,a,r]),p=B.useMemo(()=>TC(t,e,d,a,r,"assets"),[t,e,d,a,r]),m=B.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let S=new Set,E=!1;if(e.forEach(C=>{let N=a.routes[C.route.id];!N||!N.hasLoader||(!h.some(j=>j.route.id===C.route.id)&&C.route.id in u&&o[C.route.id]?.shouldRevalidate||N.hasClientLoader?E=!0:S.add(C.route.id))}),S.size===0)return[];let T=o9(t,c,i.unstable_trailingSlashAwareDataRequests,"data");return E&&S.size>0&&T.searchParams.set("_routes",e.filter(C=>S.has(C.route.id)).map(C=>C.route.id).join(",")),[T.pathname+T.search]},[c,i.unstable_trailingSlashAwareDataRequests,u,r,a,h,e,t,o]),b=B.useMemo(()=>d9(p,a),[p,a]),w=y9(p);return B.createElement(B.Fragment,null,m.map(S=>B.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...n})),b.map(S=>B.createElement("link",{key:S,rel:"modulepreload",href:S,...n})),w.map(({key:S,link:E})=>B.createElement("link",{key:S,nonce:n.nonce,...E,crossOrigin:E.crossOrigin??n.crossOrigin})))}function x9(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var w9=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{w9&&(window.__reactRouterVersion="7.13.0")}catch{}function _9({basename:t,children:e,unstable_useTransitions:n,window:r}){let i=B.useRef();i.current==null&&(i.current=eL({window:r,v5Compat:!0}));let a=i.current,[o,c]=B.useState({action:a.action,location:a.location}),u=B.useCallback(d=>{n===!1?c(d):B.startTransition(()=>c(d))},[n]);return B.useLayoutEffect(()=>a.listen(u),[a,u]),B.createElement(KL,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:a,unstable_useTransitions:n})}var hD=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,pD=B.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:i,reloadDocument:a,replace:o,state:c,target:u,to:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...b},w){let{basename:S,unstable_useTransitions:E}=B.useContext(Mi),T=typeof d=="string"&&hD.test(d),C=nD(d,S);d=C.to;let N=OL(d,{relative:i}),[j,O,M]=m9(r,b),A=A9(d,{replace:o,state:c,target:u,preventScrollReset:h,relative:i,viewTransition:p,unstable_defaultShouldRevalidate:m,unstable_useTransitions:E});function k(V){e&&e(V),V.defaultPrevented||A(V)}let D=B.createElement("a",{...b,...M,href:C.absoluteURL||N,onClick:C.isExternal||a?e:k,ref:x9(w,O),target:u,"data-discover":!T&&n==="render"?"true":void 0});return j&&!T?B.createElement(B.Fragment,null,D,B.createElement(v9,{page:N})):D});pD.displayName="Link";var S9=B.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:i=!1,style:a,to:o,viewTransition:c,children:u,...d},h){let p=bh(o,{relative:d.relative}),m=ra(),b=B.useContext(u0),{navigator:w,basename:S}=B.useContext(Mi),E=b!=null&&D9(p)&&c===!0,T=w.encodeLocation?w.encodeLocation(p).pathname:p.pathname,C=m.pathname,N=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;n||(C=C.toLowerCase(),N=N?N.toLowerCase():null,T=T.toLowerCase()),N&&S&&(N=As(N,S)||N);const j=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let O=C===T||!i&&C.startsWith(T)&&C.charAt(j)==="/",M=N!=null&&(N===T||!i&&N.startsWith(T)&&N.charAt(T.length)==="/"),A={isActive:O,isPending:M,isTransitioning:E},k=O?e:void 0,D;typeof r=="function"?D=r(A):D=[r,O?"active":null,M?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let V=typeof a=="function"?a(A):a;return B.createElement(pD,{...d,"aria-current":k,className:D,ref:h,style:V,to:o,viewTransition:c},typeof u=="function"?u(A):u)});S9.displayName="NavLink";var E9=B.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:i,state:a,method:o=qg,action:c,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...b},w)=>{let{unstable_useTransitions:S}=B.useContext(Mi),E=R9(),T=N9(c,{relative:d}),C=o.toLowerCase()==="get"?"get":"post",N=typeof c=="string"&&hD.test(c),j=O=>{if(u&&u(O),O.defaultPrevented)return;O.preventDefault();let M=O.nativeEvent.submitter,A=M?.getAttribute("formmethod")||o,k=()=>E(M||O.currentTarget,{fetcherKey:e,method:A,navigate:n,replace:i,state:a,relative:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m});S&&n!==!1?B.startTransition(()=>k()):k()};return B.createElement("form",{ref:w,method:C,action:T,onSubmit:r?u:j,...b,"data-discover":!N&&t==="render"?"true":void 0})});E9.displayName="Form";function T9(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function gD(t){let e=B.useContext($u);return on(e,T9(t)),e}function A9(t,{target:e,replace:n,state:r,preventScrollReset:i,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:c,unstable_useTransitions:u}={}){let d=ia(),h=ra(),p=bh(t,{relative:a});return B.useCallback(m=>{if(n9(m,e)){m.preventDefault();let b=n!==void 0?n:Uf(h)===Uf(p),w=()=>d(t,{replace:b,state:r,preventScrollReset:i,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:c});u?B.startTransition(()=>w()):w()}},[h,d,p,n,r,e,t,i,a,o,c,u])}function mD(t){Ri(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=B.useRef(px(t)),n=B.useRef(!1),r=ra(),i=B.useMemo(()=>r9(r.search,n.current?null:e.current),[r.search]),a=ia(),o=B.useCallback((c,u)=>{const d=px(typeof c=="function"?c(new URLSearchParams(i)):c);n.current=!0,a("?"+d,u)},[a,i]);return[i,o]}var C9=0,k9=()=>`__${String(++C9)}__`;function R9(){let{router:t}=gD("useSubmit"),{basename:e}=B.useContext(Mi),n=qL(),r=t.fetch,i=t.navigate;return B.useCallback(async(a,o={})=>{let{action:c,method:u,encType:d,formData:h,body:p}=s9(a,e);if(o.navigate===!1){let m=o.fetcherKey||k9();await r(m,n,o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:p,formMethod:o.method||u,formEncType:o.encType||d,flushSync:o.flushSync})}else await i(o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:p,formMethod:o.method||u,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:n,flushSync:o.flushSync,viewTransition:o.viewTransition})},[r,i,e,n])}function N9(t,{relative:e}={}){let{basename:n}=B.useContext(Mi),r=B.useContext(Ga);on(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),a={...bh(t||".",{relative:e})},o=ra();if(t==null){a.search=o.search;let c=new URLSearchParams(a.search),u=c.getAll("index");if(u.some(h=>h==="")){c.delete("index"),u.filter(p=>p).forEach(p=>c.append("index",p));let h=c.toString();a.search=h?`?${h}`:""}}return(!t||t===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(a.pathname=a.pathname==="/"?n:bs([n,a.pathname])),Uf(a)}function D9(t,{relative:e}={}){let n=B.useContext(iD);on(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=gD("useViewTransitionState"),i=bh(t,{relative:e});if(!n.isTransitioning)return!1;let a=As(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=As(n.nextLocation.pathname,r)||n.nextLocation.pathname;return bm(i.pathname,o)!=null||bm(i.pathname,a)!=null}const I9=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),M9=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),AC=t=>{const e=M9(t);return e.charAt(0).toUpperCase()+e.slice(1)},vD=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),O9=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var P9={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const j9=B.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:a,iconNode:o,...c},u)=>B.createElement("svg",{ref:u,...P9,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:vD("lucide",i),...!a&&!O9(c)&&{"aria-hidden":"true"},...c},[...o.map(([d,h])=>B.createElement(d,h)),...Array.isArray(a)?a:[a]]));const Qe=(t,e)=>{const n=B.forwardRef(({className:r,...i},a)=>B.createElement(j9,{ref:a,iconNode:e,className:vD(`lucide-${I9(AC(t))}`,`lucide-${t}`,r),...i}));return n.displayName=AC(t),n};const V9=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Vo=Qe("arrow-left",V9);const z9=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],L9=Qe("arrow-right-left",z9);const B9=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],U9=Qe("arrow-right",B9);const F9=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],$9=Qe("calendar",F9);const G9=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],H9=Qe("chart-column",G9);const q9=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],Y9=Qe("chart-pie",q9);const X9=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],W9=Qe("check",X9);const K9=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Q9=Qe("chevron-left",K9);const Z9=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Ea=Qe("chevron-right",Z9);const J9=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]],eB=Qe("circle-arrow-down",J9);const tB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],nB=Qe("circle-arrow-up",tB);const rB=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],xm=Qe("circle-check-big",rB);const iB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ps=Qe("circle-check",iB);const aB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],CC=Qe("circle",aB);const sB=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],kC=Qe("dollar-sign",sB);const oB=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],RC=Qe("download",oB);const lB=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],cB=Qe("ellipsis",lB);const uB=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],yD=Qe("eye-off",uB);const dB=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],bD=Qe("eye",dB);const fB=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],hB=Qe("file-text",fB);const pB=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],gB=Qe("folder",pB);const mB=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],vB=Qe("funnel",mB);const yB=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],Ff=Qe("grip-vertical",yB);const bB=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],xB=Qe("house",bB);const wB=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],_B=Qe("list",wB);const SB=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],NC=Qe("loader",SB);const EB=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],DC=Qe("lock",EB);const TB=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],AB=Qe("log-out",TB);const CB=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],gx=Qe("mail",CB);const kB=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],IC=Qe("mic",kB);const RB=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],NB=Qe("pause",RB);const DB=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],IB=Qe("pen",DB);const MB=[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]],xh=Qe("piggy-bank",MB);const OB=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],wh=Qe("plus",OB);const PB=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],$f=Qe("refresh-cw",PB);const jB=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],VB=Qe("rotate-ccw",jB);const zB=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],LB=Qe("search",zB);const BB=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],UB=Qe("settings",BB);const FB=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Gf=Qe("sparkles",FB);const $B=[["path",{d:"M13.172 2a2 2 0 0 1 1.414.586l6.71 6.71a2.4 2.4 0 0 1 0 3.408l-4.592 4.592a2.4 2.4 0 0 1-3.408 0l-6.71-6.71A2 2 0 0 1 6 9.172V3a1 1 0 0 1 1-1z",key:"16rjxf"}],["path",{d:"M2 7v6.172a2 2 0 0 0 .586 1.414l6.71 6.71a2.4 2.4 0 0 0 3.191.193",key:"178nd4"}],["circle",{cx:"10.5",cy:"6.5",r:".5",fill:"currentColor",key:"12ikhr"}]],GB=Qe("tags",$B);const HB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],qB=Qe("target",HB);const YB=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],wm=Qe("trash-2",YB);const XB=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],xD=Qe("trash",XB);const WB=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],_m=Qe("trending-up",WB);const KB=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],yu=Qe("triangle-alert",KB);const QB=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],ZB=Qe("undo-2",QB);const JB=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],eU=Qe("upload",JB);const tU=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],nU=Qe("user-plus",tU);const rU=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],f0=Qe("wallet",rU);const iU=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],h0=Qe("x",iU),MC=t=>{let e;const n=new Set,r=(d,h)=>{const p=typeof d=="function"?d(e):d;if(!Object.is(p,e)){const m=e;e=h??(typeof p!="object"||p===null)?p:Object.assign({},e,p),n.forEach(b=>b(e,m))}},i=()=>e,c={setState:r,getState:i,getInitialState:()=>u,subscribe:d=>(n.add(d),()=>n.delete(d))},u=e=t(r,i,c);return c},aU=(t=>t?MC(t):MC),sU=t=>t;function oU(t,e=sU){const n=uf.useSyncExternalStore(t.subscribe,uf.useCallback(()=>e(t.getState()),[t,e]),uf.useCallback(()=>e(t.getInitialState()),[t,e]));return uf.useDebugValue(n),n}const OC=t=>{const e=aU(t),n=r=>oU(e,r);return Object.assign(n,e),n},tw=(t=>t?OC(t):OC),PC={BASE_URL:"/personal-budget-pwa/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyCRHcpbVGQrEZUVdO_Ucn4ZarwwPsrON40",VITE_FIREBASE_APP_ID:"1:137454342284:web:0ae73943f9058a4342aba9",VITE_FIREBASE_AUTH_DOMAIN:"personal-budget-pwa-5defb.firebaseapp.com",VITE_FIREBASE_MEASUREMENT_ID:"G-VMP5DF6273",VITE_FIREBASE_MESSAGING_SENDER_ID:"137454342284",VITE_FIREBASE_PROJECT_ID:"personal-budget-pwa-5defb",VITE_FIREBASE_STORAGE_BUCKET:"personal-budget-pwa-5defb.firebasestorage.app",VITE_RECAPTCHA_ENTERPRISE_SITE_KEY:"6Lf31GMsAAAAAHqILQS1jVjTe51WHK6lfIyxmsFT"},Hf=new Map,vg=t=>{const e=Hf.get(t);return e?Object.fromEntries(Object.entries(e.stores).map(([n,r])=>[n,r.getState()])):{}},lU=(t,e,n)=>{if(t===void 0)return{type:"untracked",connection:e.connect(n)};const r=Hf.get(n.name);if(r)return{type:"tracked",store:t,...r};const i={connection:e.connect(n),stores:{}};return Hf.set(n.name,i),{type:"tracked",store:t,...i}},cU=(t,e)=>{if(e===void 0)return;const n=Hf.get(t);n&&(delete n.stores[e],Object.keys(n.stores).length===0&&Hf.delete(t))},uU=t=>{var e,n;if(!t)return;const r=t.split(`
`),i=r.findIndex(o=>o.includes("api.setState"));if(i<0)return;const a=((e=r[i+1])==null?void 0:e.trim())||"";return(n=/.+ (.+) .+/.exec(a))==null?void 0:n[1]},dU=(t,e={})=>(n,r,i)=>{const{enabled:a,anonymousActionType:o,store:c,...u}=e;let d;try{d=(a??(PC?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!d)return t(n,r,i);const{connection:h,...p}=lU(c,d,u);let m=!0;i.setState=((S,E,T)=>{const C=n(S,E);if(!m)return C;const N=T===void 0?{type:o||uU(new Error().stack)||"anonymous"}:typeof T=="string"?{type:T}:T;return c===void 0?(h?.send(N,r()),C):(h?.send({...N,type:`${c}/${N.type}`},{...vg(u.name),[c]:i.getState()}),C)}),i.devtools={cleanup:()=>{h&&typeof h.unsubscribe=="function"&&h.unsubscribe(),cU(u.name,c)}};const b=(...S)=>{const E=m;m=!1,n(...S),m=E},w=t(i.setState,r,i);if(p.type==="untracked"?h?.init(w):(p.stores[p.store]=i,h?.init(Object.fromEntries(Object.entries(p.stores).map(([S,E])=>[S,S===p.store?w:E.getState()])))),i.dispatchFromDevtools&&typeof i.dispatch=="function"){let S=!1;const E=i.dispatch;i.dispatch=(...T)=>{(PC?"production":void 0)!=="production"&&T[0].type==="__setState"&&!S&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),S=!0),E(...T)}}return h.subscribe(S=>{var E;switch(S.type){case"ACTION":if(typeof S.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return gb(S.payload,T=>{if(T.type==="__setState"){if(c===void 0){b(T.state);return}Object.keys(T.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const C=T.state[c];if(C==null)return;JSON.stringify(i.getState())!==JSON.stringify(C)&&b(C);return}i.dispatchFromDevtools&&typeof i.dispatch=="function"&&i.dispatch(T)});case"DISPATCH":switch(S.payload.type){case"RESET":return b(w),c===void 0?h?.init(i.getState()):h?.init(vg(u.name));case"COMMIT":if(c===void 0){h?.init(i.getState());return}return h?.init(vg(u.name));case"ROLLBACK":return gb(S.state,T=>{if(c===void 0){b(T),h?.init(i.getState());return}b(T[c]),h?.init(vg(u.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return gb(S.state,T=>{if(c===void 0){b(T);return}JSON.stringify(i.getState())!==JSON.stringify(T[c])&&b(T[c])});case"IMPORT_STATE":{const{nextLiftedState:T}=S.payload,C=(E=T.computedStates.slice(-1)[0])==null?void 0:E.state;if(!C)return;b(c===void 0?C:C[c]),h?.send(null,T);return}case"PAUSE_RECORDING":return m=!m}return}}),w},fU=dU,gb=(t,e)=>{let n;try{n=JSON.parse(t)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}n!==void 0&&e(n)};function hU(t,e){let n;try{n=t()}catch{return}return{getItem:i=>{var a;const o=u=>u===null?null:JSON.parse(u,void 0),c=(a=n.getItem(i))!=null?a:null;return c instanceof Promise?c.then(o):o(c)},setItem:(i,a)=>n.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>n.removeItem(i)}}const mx=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return mx(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return mx(r)(n)}}}},pU=(t,e)=>(n,r,i)=>{let a={storage:hU(()=>localStorage),partialize:S=>S,version:0,merge:(S,E)=>({...E,...S}),...e},o=!1;const c=new Set,u=new Set;let d=a.storage;if(!d)return t((...S)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),n(...S)},r,i);const h=()=>{const S=a.partialize({...r()});return d.setItem(a.name,{state:S,version:a.version})},p=i.setState;i.setState=(S,E)=>(p(S,E),h());const m=t((...S)=>(n(...S),h()),r,i);i.getInitialState=()=>m;let b;const w=()=>{var S,E;if(!d)return;o=!1,c.forEach(C=>{var N;return C((N=r())!=null?N:m)});const T=((E=a.onRehydrateStorage)==null?void 0:E.call(a,(S=r())!=null?S:m))||void 0;return mx(d.getItem.bind(d))(a.name).then(C=>{if(C)if(typeof C.version=="number"&&C.version!==a.version){if(a.migrate){const N=a.migrate(C.state,C.version);return N instanceof Promise?N.then(j=>[!0,j]):[!0,N]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,C.state];return[!1,void 0]}).then(C=>{var N;const[j,O]=C;if(b=a.merge(O,(N=r())!=null?N:m),n(b,!0),j)return h()}).then(()=>{T?.(b,void 0),b=r(),o=!0,u.forEach(C=>C(b))}).catch(C=>{T?.(void 0,C)})};return i.persist={setOptions:S=>{a={...a,...S},S.storage&&(d=S.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>w(),hasHydrated:()=>o,onHydrate:S=>(c.add(S),()=>{c.delete(S)}),onFinishHydration:S=>(u.add(S),()=>{u.delete(S)})},a.skipHydration||w(),b||m},wD=pU;var gU="firebase",mU="12.6.0";Ra(gU,mU,"app");var jC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Io,_D;(function(){var t;function e(A,k){function D(){}D.prototype=k.prototype,A.F=k.prototype,A.prototype=new D,A.prototype.constructor=A,A.D=function(V,L,U){for(var P=Array(arguments.length-2),K=2;K<arguments.length;K++)P[K-2]=arguments[K];return k.prototype[L].apply(V,P)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,k,D){D||(D=0);const V=Array(16);if(typeof k=="string")for(var L=0;L<16;++L)V[L]=k.charCodeAt(D++)|k.charCodeAt(D++)<<8|k.charCodeAt(D++)<<16|k.charCodeAt(D++)<<24;else for(L=0;L<16;++L)V[L]=k[D++]|k[D++]<<8|k[D++]<<16|k[D++]<<24;k=A.g[0],D=A.g[1],L=A.g[2];let U=A.g[3],P;P=k+(U^D&(L^U))+V[0]+3614090360&4294967295,k=D+(P<<7&4294967295|P>>>25),P=U+(L^k&(D^L))+V[1]+3905402710&4294967295,U=k+(P<<12&4294967295|P>>>20),P=L+(D^U&(k^D))+V[2]+606105819&4294967295,L=U+(P<<17&4294967295|P>>>15),P=D+(k^L&(U^k))+V[3]+3250441966&4294967295,D=L+(P<<22&4294967295|P>>>10),P=k+(U^D&(L^U))+V[4]+4118548399&4294967295,k=D+(P<<7&4294967295|P>>>25),P=U+(L^k&(D^L))+V[5]+1200080426&4294967295,U=k+(P<<12&4294967295|P>>>20),P=L+(D^U&(k^D))+V[6]+2821735955&4294967295,L=U+(P<<17&4294967295|P>>>15),P=D+(k^L&(U^k))+V[7]+4249261313&4294967295,D=L+(P<<22&4294967295|P>>>10),P=k+(U^D&(L^U))+V[8]+1770035416&4294967295,k=D+(P<<7&4294967295|P>>>25),P=U+(L^k&(D^L))+V[9]+2336552879&4294967295,U=k+(P<<12&4294967295|P>>>20),P=L+(D^U&(k^D))+V[10]+4294925233&4294967295,L=U+(P<<17&4294967295|P>>>15),P=D+(k^L&(U^k))+V[11]+2304563134&4294967295,D=L+(P<<22&4294967295|P>>>10),P=k+(U^D&(L^U))+V[12]+1804603682&4294967295,k=D+(P<<7&4294967295|P>>>25),P=U+(L^k&(D^L))+V[13]+4254626195&4294967295,U=k+(P<<12&4294967295|P>>>20),P=L+(D^U&(k^D))+V[14]+2792965006&4294967295,L=U+(P<<17&4294967295|P>>>15),P=D+(k^L&(U^k))+V[15]+1236535329&4294967295,D=L+(P<<22&4294967295|P>>>10),P=k+(L^U&(D^L))+V[1]+4129170786&4294967295,k=D+(P<<5&4294967295|P>>>27),P=U+(D^L&(k^D))+V[6]+3225465664&4294967295,U=k+(P<<9&4294967295|P>>>23),P=L+(k^D&(U^k))+V[11]+643717713&4294967295,L=U+(P<<14&4294967295|P>>>18),P=D+(U^k&(L^U))+V[0]+3921069994&4294967295,D=L+(P<<20&4294967295|P>>>12),P=k+(L^U&(D^L))+V[5]+3593408605&4294967295,k=D+(P<<5&4294967295|P>>>27),P=U+(D^L&(k^D))+V[10]+38016083&4294967295,U=k+(P<<9&4294967295|P>>>23),P=L+(k^D&(U^k))+V[15]+3634488961&4294967295,L=U+(P<<14&4294967295|P>>>18),P=D+(U^k&(L^U))+V[4]+3889429448&4294967295,D=L+(P<<20&4294967295|P>>>12),P=k+(L^U&(D^L))+V[9]+568446438&4294967295,k=D+(P<<5&4294967295|P>>>27),P=U+(D^L&(k^D))+V[14]+3275163606&4294967295,U=k+(P<<9&4294967295|P>>>23),P=L+(k^D&(U^k))+V[3]+4107603335&4294967295,L=U+(P<<14&4294967295|P>>>18),P=D+(U^k&(L^U))+V[8]+1163531501&4294967295,D=L+(P<<20&4294967295|P>>>12),P=k+(L^U&(D^L))+V[13]+2850285829&4294967295,k=D+(P<<5&4294967295|P>>>27),P=U+(D^L&(k^D))+V[2]+4243563512&4294967295,U=k+(P<<9&4294967295|P>>>23),P=L+(k^D&(U^k))+V[7]+1735328473&4294967295,L=U+(P<<14&4294967295|P>>>18),P=D+(U^k&(L^U))+V[12]+2368359562&4294967295,D=L+(P<<20&4294967295|P>>>12),P=k+(D^L^U)+V[5]+4294588738&4294967295,k=D+(P<<4&4294967295|P>>>28),P=U+(k^D^L)+V[8]+2272392833&4294967295,U=k+(P<<11&4294967295|P>>>21),P=L+(U^k^D)+V[11]+1839030562&4294967295,L=U+(P<<16&4294967295|P>>>16),P=D+(L^U^k)+V[14]+4259657740&4294967295,D=L+(P<<23&4294967295|P>>>9),P=k+(D^L^U)+V[1]+2763975236&4294967295,k=D+(P<<4&4294967295|P>>>28),P=U+(k^D^L)+V[4]+1272893353&4294967295,U=k+(P<<11&4294967295|P>>>21),P=L+(U^k^D)+V[7]+4139469664&4294967295,L=U+(P<<16&4294967295|P>>>16),P=D+(L^U^k)+V[10]+3200236656&4294967295,D=L+(P<<23&4294967295|P>>>9),P=k+(D^L^U)+V[13]+681279174&4294967295,k=D+(P<<4&4294967295|P>>>28),P=U+(k^D^L)+V[0]+3936430074&4294967295,U=k+(P<<11&4294967295|P>>>21),P=L+(U^k^D)+V[3]+3572445317&4294967295,L=U+(P<<16&4294967295|P>>>16),P=D+(L^U^k)+V[6]+76029189&4294967295,D=L+(P<<23&4294967295|P>>>9),P=k+(D^L^U)+V[9]+3654602809&4294967295,k=D+(P<<4&4294967295|P>>>28),P=U+(k^D^L)+V[12]+3873151461&4294967295,U=k+(P<<11&4294967295|P>>>21),P=L+(U^k^D)+V[15]+530742520&4294967295,L=U+(P<<16&4294967295|P>>>16),P=D+(L^U^k)+V[2]+3299628645&4294967295,D=L+(P<<23&4294967295|P>>>9),P=k+(L^(D|~U))+V[0]+4096336452&4294967295,k=D+(P<<6&4294967295|P>>>26),P=U+(D^(k|~L))+V[7]+1126891415&4294967295,U=k+(P<<10&4294967295|P>>>22),P=L+(k^(U|~D))+V[14]+2878612391&4294967295,L=U+(P<<15&4294967295|P>>>17),P=D+(U^(L|~k))+V[5]+4237533241&4294967295,D=L+(P<<21&4294967295|P>>>11),P=k+(L^(D|~U))+V[12]+1700485571&4294967295,k=D+(P<<6&4294967295|P>>>26),P=U+(D^(k|~L))+V[3]+2399980690&4294967295,U=k+(P<<10&4294967295|P>>>22),P=L+(k^(U|~D))+V[10]+4293915773&4294967295,L=U+(P<<15&4294967295|P>>>17),P=D+(U^(L|~k))+V[1]+2240044497&4294967295,D=L+(P<<21&4294967295|P>>>11),P=k+(L^(D|~U))+V[8]+1873313359&4294967295,k=D+(P<<6&4294967295|P>>>26),P=U+(D^(k|~L))+V[15]+4264355552&4294967295,U=k+(P<<10&4294967295|P>>>22),P=L+(k^(U|~D))+V[6]+2734768916&4294967295,L=U+(P<<15&4294967295|P>>>17),P=D+(U^(L|~k))+V[13]+1309151649&4294967295,D=L+(P<<21&4294967295|P>>>11),P=k+(L^(D|~U))+V[4]+4149444226&4294967295,k=D+(P<<6&4294967295|P>>>26),P=U+(D^(k|~L))+V[11]+3174756917&4294967295,U=k+(P<<10&4294967295|P>>>22),P=L+(k^(U|~D))+V[2]+718787259&4294967295,L=U+(P<<15&4294967295|P>>>17),P=D+(U^(L|~k))+V[9]+3951481745&4294967295,A.g[0]=A.g[0]+k&4294967295,A.g[1]=A.g[1]+(L+(P<<21&4294967295|P>>>11))&4294967295,A.g[2]=A.g[2]+L&4294967295,A.g[3]=A.g[3]+U&4294967295}r.prototype.v=function(A,k){k===void 0&&(k=A.length);const D=k-this.blockSize,V=this.C;let L=this.h,U=0;for(;U<k;){if(L==0)for(;U<=D;)i(this,A,U),U+=this.blockSize;if(typeof A=="string"){for(;U<k;)if(V[L++]=A.charCodeAt(U++),L==this.blockSize){i(this,V),L=0;break}}else for(;U<k;)if(V[L++]=A[U++],L==this.blockSize){i(this,V),L=0;break}}this.h=L,this.o+=k},r.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var k=1;k<A.length-8;++k)A[k]=0;k=this.o*8;for(var D=A.length-8;D<A.length;++D)A[D]=k&255,k/=256;for(this.v(A),A=Array(16),k=0,D=0;D<4;++D)for(let V=0;V<32;V+=8)A[k++]=this.g[D]>>>V&255;return A};function a(A,k){var D=c;return Object.prototype.hasOwnProperty.call(D,A)?D[A]:D[A]=k(A)}function o(A,k){this.h=k;const D=[];let V=!0;for(let L=A.length-1;L>=0;L--){const U=A[L]|0;V&&U==k||(D[L]=U,V=!1)}this.g=D}var c={};function u(A){return-128<=A&&A<128?a(A,function(k){return new o([k|0],k<0?-1:0)}):new o([A|0],A<0?-1:0)}function d(A){if(isNaN(A)||!isFinite(A))return p;if(A<0)return E(d(-A));const k=[];let D=1;for(let V=0;A>=D;V++)k[V]=A/D|0,D*=4294967296;return new o(k,0)}function h(A,k){if(A.length==0)throw Error("number format error: empty string");if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(A.charAt(0)=="-")return E(h(A.substring(1),k));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=d(Math.pow(k,8));let V=p;for(let U=0;U<A.length;U+=8){var L=Math.min(8,A.length-U);const P=parseInt(A.substring(U,U+L),k);L<8?(L=d(Math.pow(k,L)),V=V.j(L).add(d(P))):(V=V.j(D),V=V.add(d(P)))}return V}var p=u(0),m=u(1),b=u(16777216);t=o.prototype,t.m=function(){if(S(this))return-E(this).m();let A=0,k=1;for(let D=0;D<this.g.length;D++){const V=this.i(D);A+=(V>=0?V:4294967296+V)*k,k*=4294967296}return A},t.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(w(this))return"0";if(S(this))return"-"+E(this).toString(A);const k=d(Math.pow(A,6));var D=this;let V="";for(;;){const L=j(D,k).g;D=T(D,L.j(k));let U=((D.g.length>0?D.g[0]:D.h)>>>0).toString(A);if(D=L,w(D))return U+V;for(;U.length<6;)U="0"+U;V=U+V}},t.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function w(A){if(A.h!=0)return!1;for(let k=0;k<A.g.length;k++)if(A.g[k]!=0)return!1;return!0}function S(A){return A.h==-1}t.l=function(A){return A=T(this,A),S(A)?-1:w(A)?0:1};function E(A){const k=A.g.length,D=[];for(let V=0;V<k;V++)D[V]=~A.g[V];return new o(D,~A.h).add(m)}t.abs=function(){return S(this)?E(this):this},t.add=function(A){const k=Math.max(this.g.length,A.g.length),D=[];let V=0;for(let L=0;L<=k;L++){let U=V+(this.i(L)&65535)+(A.i(L)&65535),P=(U>>>16)+(this.i(L)>>>16)+(A.i(L)>>>16);V=P>>>16,U&=65535,P&=65535,D[L]=P<<16|U}return new o(D,D[D.length-1]&-2147483648?-1:0)};function T(A,k){return A.add(E(k))}t.j=function(A){if(w(this)||w(A))return p;if(S(this))return S(A)?E(this).j(E(A)):E(E(this).j(A));if(S(A))return E(this.j(E(A)));if(this.l(b)<0&&A.l(b)<0)return d(this.m()*A.m());const k=this.g.length+A.g.length,D=[];for(var V=0;V<2*k;V++)D[V]=0;for(V=0;V<this.g.length;V++)for(let L=0;L<A.g.length;L++){const U=this.i(V)>>>16,P=this.i(V)&65535,K=A.i(L)>>>16,X=A.i(L)&65535;D[2*V+2*L]+=P*X,C(D,2*V+2*L),D[2*V+2*L+1]+=U*X,C(D,2*V+2*L+1),D[2*V+2*L+1]+=P*K,C(D,2*V+2*L+1),D[2*V+2*L+2]+=U*K,C(D,2*V+2*L+2)}for(A=0;A<k;A++)D[A]=D[2*A+1]<<16|D[2*A];for(A=k;A<2*k;A++)D[A]=0;return new o(D,0)};function C(A,k){for(;(A[k]&65535)!=A[k];)A[k+1]+=A[k]>>>16,A[k]&=65535,k++}function N(A,k){this.g=A,this.h=k}function j(A,k){if(w(k))throw Error("division by zero");if(w(A))return new N(p,p);if(S(A))return k=j(E(A),k),new N(E(k.g),E(k.h));if(S(k))return k=j(A,E(k)),new N(E(k.g),k.h);if(A.g.length>30){if(S(A)||S(k))throw Error("slowDivide_ only works with positive integers.");for(var D=m,V=k;V.l(A)<=0;)D=O(D),V=O(V);var L=M(D,1),U=M(V,1);for(V=M(V,2),D=M(D,2);!w(V);){var P=U.add(V);P.l(A)<=0&&(L=L.add(D),U=P),V=M(V,1),D=M(D,1)}return k=T(A,L.j(k)),new N(L,k)}for(L=p;A.l(k)>=0;){for(D=Math.max(1,Math.floor(A.m()/k.m())),V=Math.ceil(Math.log(D)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),U=d(D),P=U.j(k);S(P)||P.l(A)>0;)D-=V,U=d(D),P=U.j(k);w(U)&&(U=m),L=L.add(U),A=T(A,P)}return new N(L,A)}t.B=function(A){return j(this,A).h},t.and=function(A){const k=Math.max(this.g.length,A.g.length),D=[];for(let V=0;V<k;V++)D[V]=this.i(V)&A.i(V);return new o(D,this.h&A.h)},t.or=function(A){const k=Math.max(this.g.length,A.g.length),D=[];for(let V=0;V<k;V++)D[V]=this.i(V)|A.i(V);return new o(D,this.h|A.h)},t.xor=function(A){const k=Math.max(this.g.length,A.g.length),D=[];for(let V=0;V<k;V++)D[V]=this.i(V)^A.i(V);return new o(D,this.h^A.h)};function O(A){const k=A.g.length+1,D=[];for(let V=0;V<k;V++)D[V]=A.i(V)<<1|A.i(V-1)>>>31;return new o(D,A.h)}function M(A,k){const D=k>>5;k%=32;const V=A.g.length-D,L=[];for(let U=0;U<V;U++)L[U]=k>0?A.i(U+D)>>>k|A.i(U+D+1)<<32-k:A.i(U+D);return new o(L,A.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,_D=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Io=o}).apply(typeof jC<"u"?jC:typeof self<"u"?self:typeof window<"u"?window:{});var yg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var SD,hf,ED,Xg,vx,TD,AD,CD;(function(){var t,e=Object.defineProperty;function n(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof yg=="object"&&yg];for(var R=0;R<y.length;++R){var z=y[R];if(z&&z.Math==Math)return z}throw Error("Cannot find global object")}var r=n(this);function i(y,R){if(R)e:{var z=r;y=y.split(".");for(var H=0;H<y.length-1;H++){var ue=y[H];if(!(ue in z))break e;z=z[ue]}y=y[y.length-1],H=z[y],R=R(H),R!=H&&R!=null&&e(z,y,{configurable:!0,writable:!0,value:R})}}i("Symbol.dispose",function(y){return y||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(y){return y||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(y){return y||function(R){var z=[],H;for(H in R)Object.prototype.hasOwnProperty.call(R,H)&&z.push([H,R[H]]);return z}});var a=a||{},o=this||self;function c(y){var R=typeof y;return R=="object"&&y!=null||R=="function"}function u(y,R,z){return y.call.apply(y.bind,arguments)}function d(y,R,z){return d=u,d.apply(null,arguments)}function h(y,R){var z=Array.prototype.slice.call(arguments,1);return function(){var H=z.slice();return H.push.apply(H,arguments),y.apply(this,H)}}function p(y,R){function z(){}z.prototype=R.prototype,y.Z=R.prototype,y.prototype=new z,y.prototype.constructor=y,y.Ob=function(H,ue,ge){for(var ke=Array(arguments.length-2),ot=2;ot<arguments.length;ot++)ke[ot-2]=arguments[ot];return R.prototype[ue].apply(H,ke)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?y=>y&&AsyncContext.Snapshot.wrap(y):y=>y;function b(y){const R=y.length;if(R>0){const z=Array(R);for(let H=0;H<R;H++)z[H]=y[H];return z}return[]}function w(y,R){for(let H=1;H<arguments.length;H++){const ue=arguments[H];var z=typeof ue;if(z=z!="object"?z:ue?Array.isArray(ue)?"array":z:"null",z=="array"||z=="object"&&typeof ue.length=="number"){z=y.length||0;const ge=ue.length||0;y.length=z+ge;for(let ke=0;ke<ge;ke++)y[z+ke]=ue[ke]}else y.push(ue)}}class S{constructor(R,z){this.i=R,this.j=z,this.h=0,this.g=null}get(){let R;return this.h>0?(this.h--,R=this.g,this.g=R.next,R.next=null):R=this.i(),R}}function E(y){o.setTimeout(()=>{throw y},0)}function T(){var y=A;let R=null;return y.g&&(R=y.g,y.g=y.g.next,y.g||(y.h=null),R.next=null),R}class C{constructor(){this.h=this.g=null}add(R,z){const H=N.get();H.set(R,z),this.h?this.h.next=H:this.g=H,this.h=H}}var N=new S(()=>new j,y=>y.reset());class j{constructor(){this.next=this.g=this.h=null}set(R,z){this.h=R,this.g=z,this.next=null}reset(){this.next=this.g=this.h=null}}let O,M=!1,A=new C,k=()=>{const y=Promise.resolve(void 0);O=()=>{y.then(D)}};function D(){for(var y;y=T();){try{y.h.call(y.g)}catch(z){E(z)}var R=N;R.j(y),R.h<100&&(R.h++,y.next=R.g,R.g=y)}M=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(y,R){this.type=y,this.g=this.target=R,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var y=!1,R=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const z=()=>{};o.addEventListener("test",z,R),o.removeEventListener("test",z,R)}catch{}return y})();function P(y){return/^[\s\xa0]*$/.test(y)}function K(y,R){L.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y&&this.init(y,R)}p(K,L),K.prototype.init=function(y,R){const z=this.type=y.type,H=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;this.target=y.target||y.srcElement,this.g=R,R=y.relatedTarget,R||(z=="mouseover"?R=y.fromElement:z=="mouseout"&&(R=y.toElement)),this.relatedTarget=R,H?(this.clientX=H.clientX!==void 0?H.clientX:H.pageX,this.clientY=H.clientY!==void 0?H.clientY:H.pageY,this.screenX=H.screenX||0,this.screenY=H.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=y.pointerType,this.state=y.state,this.i=y,y.defaultPrevented&&K.Z.h.call(this)},K.prototype.h=function(){K.Z.h.call(this);const y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var X="closure_listenable_"+(Math.random()*1e6|0),q=0;function Q(y,R,z,H,ue){this.listener=y,this.proxy=null,this.src=R,this.type=z,this.capture=!!H,this.ha=ue,this.key=++q,this.da=this.fa=!1}function te(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function se(y,R,z){for(const H in y)R.call(z,y[H],H,y)}function G(y,R){for(const z in y)R.call(void 0,y[z],z,y)}function F(y){const R={};for(const z in y)R[z]=y[z];return R}const Y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Z(y,R){let z,H;for(let ue=1;ue<arguments.length;ue++){H=arguments[ue];for(z in H)y[z]=H[z];for(let ge=0;ge<Y.length;ge++)z=Y[ge],Object.prototype.hasOwnProperty.call(H,z)&&(y[z]=H[z])}}function W(y){this.src=y,this.g={},this.h=0}W.prototype.add=function(y,R,z,H,ue){const ge=y.toString();y=this.g[ge],y||(y=this.g[ge]=[],this.h++);const ke=ie(y,R,H,ue);return ke>-1?(R=y[ke],z||(R.fa=!1)):(R=new Q(R,this.src,ge,!!H,ue),R.fa=z,y.push(R)),R};function le(y,R){const z=R.type;if(z in y.g){var H=y.g[z],ue=Array.prototype.indexOf.call(H,R,void 0),ge;(ge=ue>=0)&&Array.prototype.splice.call(H,ue,1),ge&&(te(R),y.g[z].length==0&&(delete y.g[z],y.h--))}}function ie(y,R,z,H){for(let ue=0;ue<y.length;++ue){const ge=y[ue];if(!ge.da&&ge.listener==R&&ge.capture==!!z&&ge.ha==H)return ue}return-1}var pe="closure_lm_"+(Math.random()*1e6|0),ce={};function xe(y,R,z,H,ue){if(Array.isArray(R)){for(let ge=0;ge<R.length;ge++)xe(y,R[ge],z,H,ue);return null}return z=Le(z),y&&y[X]?y.J(R,z,c(H)?!!H.capture:!1,ue):Re(y,R,z,!1,H,ue)}function Re(y,R,z,H,ue,ge){if(!R)throw Error("Invalid event type");const ke=c(ue)?!!ue.capture:!!ue;let ot=Ve(y);if(ot||(y[pe]=ot=new W(y)),z=ot.add(R,z,H,ke,ge),z.proxy)return z;if(H=ae(),z.proxy=H,H.src=y,H.listener=z,y.addEventListener)U||(ue=ke),ue===void 0&&(ue=!1),y.addEventListener(R.toString(),H,ue);else if(y.attachEvent)y.attachEvent(Ie(R.toString()),H);else if(y.addListener&&y.removeListener)y.addListener(H);else throw Error("addEventListener and attachEvent are unavailable.");return z}function ae(){function y(z){return R.call(y.src,y.listener,z)}const R=Oe;return y}function Ee(y,R,z,H,ue){if(Array.isArray(R))for(var ge=0;ge<R.length;ge++)Ee(y,R[ge],z,H,ue);else H=c(H)?!!H.capture:!!H,z=Le(z),y&&y[X]?(y=y.i,ge=String(R).toString(),ge in y.g&&(R=y.g[ge],z=ie(R,z,H,ue),z>-1&&(te(R[z]),Array.prototype.splice.call(R,z,1),R.length==0&&(delete y.g[ge],y.h--)))):y&&(y=Ve(y))&&(R=y.g[R.toString()],y=-1,R&&(y=ie(R,z,H,ue)),(z=y>-1?R[y]:null)&&Ne(z))}function Ne(y){if(typeof y!="number"&&y&&!y.da){var R=y.src;if(R&&R[X])le(R.i,y);else{var z=y.type,H=y.proxy;R.removeEventListener?R.removeEventListener(z,H,y.capture):R.detachEvent?R.detachEvent(Ie(z),H):R.addListener&&R.removeListener&&R.removeListener(H),(z=Ve(R))?(le(z,y),z.h==0&&(z.src=null,R[pe]=null)):te(y)}}}function Ie(y){return y in ce?ce[y]:ce[y]="on"+y}function Oe(y,R){if(y.da)y=!0;else{R=new K(R,this);const z=y.listener,H=y.ha||y.src;y.fa&&Ne(y),y=z.call(H,R)}return y}function Ve(y){return y=y[pe],y instanceof W?y:null}var Se="__closure_events_fn_"+(Math.random()*1e9>>>0);function Le(y){return typeof y=="function"?y:(y[Se]||(y[Se]=function(R){return y.handleEvent(R)}),y[Se])}function Me(){V.call(this),this.i=new W(this),this.M=this,this.G=null}p(Me,V),Me.prototype[X]=!0,Me.prototype.removeEventListener=function(y,R,z,H){Ee(this,y,R,z,H)};function Be(y,R){var z,H=y.G;if(H)for(z=[];H;H=H.G)z.push(H);if(y=y.M,H=R.type||R,typeof R=="string")R=new L(R,y);else if(R instanceof L)R.target=R.target||y;else{var ue=R;R=new L(H,y),Z(R,ue)}ue=!0;let ge,ke;if(z)for(ke=z.length-1;ke>=0;ke--)ge=R.g=z[ke],ue=st(ge,H,!0,R)&&ue;if(ge=R.g=y,ue=st(ge,H,!0,R)&&ue,ue=st(ge,H,!1,R)&&ue,z)for(ke=0;ke<z.length;ke++)ge=R.g=z[ke],ue=st(ge,H,!1,R)&&ue}Me.prototype.N=function(){if(Me.Z.N.call(this),this.i){var y=this.i;for(const R in y.g){const z=y.g[R];for(let H=0;H<z.length;H++)te(z[H]);delete y.g[R],y.h--}}this.G=null},Me.prototype.J=function(y,R,z,H){return this.i.add(String(y),R,!1,z,H)},Me.prototype.K=function(y,R,z,H){return this.i.add(String(y),R,!0,z,H)};function st(y,R,z,H){if(R=y.i.g[String(R)],!R)return!0;R=R.concat();let ue=!0;for(let ge=0;ge<R.length;++ge){const ke=R[ge];if(ke&&!ke.da&&ke.capture==z){const ot=ke.listener,mn=ke.ha||ke.src;ke.fa&&le(y.i,ke),ue=ot.call(mn,H)!==!1&&ue}}return ue&&!H.defaultPrevented}function _t(y,R){if(typeof y!="function")if(y&&typeof y.handleEvent=="function")y=d(y.handleEvent,y);else throw Error("Invalid listener argument");return Number(R)>2147483647?-1:o.setTimeout(y,R||0)}function Ze(y){y.g=_t(()=>{y.g=null,y.i&&(y.i=!1,Ze(y))},y.l);const R=y.h;y.h=null,y.m.apply(null,R)}class ut extends V{constructor(R,z){super(),this.m=R,this.l=z,this.h=null,this.i=!1,this.g=null}j(R){this.h=arguments,this.g?this.i=!0:Ze(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Rt(y){V.call(this),this.h=y,this.g={}}p(Rt,V);var cn=[];function It(y){se(y.g,function(R,z){this.g.hasOwnProperty(z)&&Ne(R)},y),y.g={}}Rt.prototype.N=function(){Rt.Z.N.call(this),It(this)},Rt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _n=o.JSON.stringify,Ur=o.JSON.parse,aa=class{stringify(y){return o.JSON.stringify(y,void 0)}parse(y){return o.JSON.parse(y,void 0)}};function qa(){}function Os(){}var Fr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Sn(){L.call(this,"d")}p(Sn,L);function ar(){L.call(this,"c")}p(ar,L);var tn={},uc=null;function Ps(){return uc=uc||new Me}tn.Ia="serverreachability";function js(y){L.call(this,tn.Ia,y)}p(js,L);function ft(y){const R=Ps();Be(R,new js(R))}tn.STAT_EVENT="statevent";function nn(y,R){L.call(this,tn.STAT_EVENT,y),this.stat=R}p(nn,L);function rn(y){const R=Ps();Be(R,new nn(R,y))}tn.Ja="timingevent";function $r(y,R){L.call(this,tn.Ja,y),this.size=R}p($r,L);function ai(y,R){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){y()},R)}function pr(){this.g=!0}pr.prototype.ua=function(){this.g=!1};function rv(y,R,z,H,ue,ge){y.info(function(){if(y.g)if(ge){var ke="",ot=ge.split("&");for(let Nt=0;Nt<ot.length;Nt++){var mn=ot[Nt].split("=");if(mn.length>1){const Zt=mn[0];mn=mn[1];const ci=Zt.split("_");ke=ci.length>=2&&ci[1]=="type"?ke+(Zt+"="+mn+"&"):ke+(Zt+"=redacted&")}}}else ke=null;else ke=ge;return"XMLHTTP REQ ("+H+") [attempt "+ue+"]: "+R+`
`+z+`
`+ke})}function qh(y,R,z,H,ue,ge,ke){y.info(function(){return"XMLHTTP RESP ("+H+") [ attempt "+ue+"]: "+R+`
`+z+`
`+ge+" "+ke})}function sa(y,R,z,H){y.info(function(){return"XMLHTTP TEXT ("+R+"): "+iv(y,z)+(H?" "+H:"")})}function il(y,R){y.info(function(){return"TIMEOUT: "+R})}pr.prototype.info=function(){};function iv(y,R){if(!y.g)return R;if(!R)return null;try{const ge=JSON.parse(R);if(ge){for(y=0;y<ge.length;y++)if(Array.isArray(ge[y])){var z=ge[y];if(!(z.length<2)){var H=z[1];if(Array.isArray(H)&&!(H.length<1)){var ue=H[0];if(ue!="noop"&&ue!="stop"&&ue!="close")for(let ke=1;ke<H.length;ke++)H[ke]=""}}}}return _n(ge)}catch{return R}}var al={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ad={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},sd;function sl(){}p(sl,qa),sl.prototype.g=function(){return new XMLHttpRequest},sd=new sl;function Ya(y){return encodeURIComponent(String(y))}function Yh(y){var R=1;y=y.split(":");const z=[];for(;R>0&&y.length;)z.push(y.shift()),R--;return y.length&&z.push(y.join(":")),z}function Oi(y,R,z,H){this.j=y,this.i=R,this.l=z,this.S=H||1,this.V=new Rt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Pi}function Pi(){this.i=null,this.g="",this.h=!1}var En={},Gn={};function oa(y,R,z){y.M=1,y.A=ol(An(R)),y.u=z,y.R=!0,dc(y,null)}function dc(y,R){y.F=Date.now(),la(y),y.B=An(y.A);var z=y.B,H=y.S;Array.isArray(H)||(H=[String(H)]),gc(z.i,"t",H),y.C=0,z=y.j.L,y.h=new Pi,y.g=lp(y.j,z?R:null,!y.u),y.P>0&&(y.O=new ut(d(y.Y,y,y.g),y.P)),R=y.V,z=y.g,H=y.ba;var ue="readystatechange";Array.isArray(ue)||(ue&&(cn[0]=ue.toString()),ue=cn);for(let ge=0;ge<ue.length;ge++){const ke=xe(z,ue[ge],H||R.handleEvent,!1,R.h||R);if(!ke)break;R.g[ke.key]=ke}R=y.J?F(y.J):{},y.u?(y.v||(y.v="POST"),R["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.B,y.v,y.u,R)):(y.v="GET",y.g.ea(y.B,y.v,null,R)),ft(),rv(y.i,y.v,y.B,y.l,y.S,y.u)}Oi.prototype.ba=function(y){y=y.target;const R=this.O;R&&zi(y)==3?R.j():this.Y(y)},Oi.prototype.Y=function(y){try{if(y==this.g)e:{const ot=zi(this.g),mn=this.g.ya(),Nt=this.g.ca();if(!(ot<3)&&(ot!=3||this.g&&(this.h.h||this.g.la()||Xn(this.g)))){this.K||ot!=4||mn==7||(mn==8||Nt<=0?ft(3):ft(2)),ca(this);var R=this.g.ca();this.X=R;var z=av(this);if(this.o=R==200,qh(this.i,this.v,this.B,this.l,this.S,ot,R),this.o){if(this.U&&!this.L){t:{if(this.g){var H,ue=this.g;if((H=ue.g?ue.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(H)){var ge=H;break t}}ge=null}if(y=ge)sa(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ua(this,y);else{this.o=!1,this.m=3,rn(12),Gr(this),si(this);break e}}if(this.R){y=!0;let Zt;for(;!this.K&&this.C<z.length;)if(Zt=Wh(this,z),Zt==Gn){ot==4&&(this.m=4,rn(14),y=!1),sa(this.i,this.l,null,"[Incomplete Response]");break}else if(Zt==En){this.m=4,rn(15),sa(this.i,this.l,z,"[Invalid Chunk]"),y=!1;break}else sa(this.i,this.l,Zt,null),ua(this,Zt);if(Xh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ot!=4||z.length!=0||this.h.h||(this.m=1,rn(16),y=!1),this.o=this.o&&y,!y)sa(this.i,this.l,z,"[Invalid Chunked Response]"),Gr(this),si(this);else if(z.length>0&&!this.W){this.W=!0;var ke=this.j;ke.g==this&&ke.aa&&!ke.P&&(ke.j.info("Great, no buffering proxy detected. Bytes received: "+z.length),wd(ke),ke.P=!0,rn(11))}}else sa(this.i,this.l,z,null),ua(this,z);ot==4&&Gr(this),this.o&&!this.K&&(ot==4?ip(this.j,this):(this.o=!1,la(this)))}else Wa(this.g),R==400&&z.indexOf("Unknown SID")>0?(this.m=3,rn(12)):(this.m=0,rn(13)),Gr(this),si(this)}}}catch{}finally{}};function av(y){if(!Xh(y))return y.g.la();const R=Xn(y.g);if(R==="")return"";let z="";const H=R.length,ue=zi(y.g)==4;if(!y.h.i){if(typeof TextDecoder>"u")return Gr(y),si(y),"";y.h.i=new o.TextDecoder}for(let ge=0;ge<H;ge++)y.h.h=!0,z+=y.h.i.decode(R[ge],{stream:!(ue&&ge==H-1)});return R.length=0,y.h.g+=z,y.C=0,y.h.g}function Xh(y){return y.g?y.v=="GET"&&y.M!=2&&y.j.Aa:!1}function Wh(y,R){var z=y.C,H=R.indexOf(`
`,z);return H==-1?Gn:(z=Number(R.substring(z,H)),isNaN(z)?En:(H+=1,H+z>R.length?Gn:(R=R.slice(H,H+z),y.C=H+z,R)))}Oi.prototype.cancel=function(){this.K=!0,Gr(this)};function la(y){y.T=Date.now()+y.H,fc(y,y.H)}function fc(y,R){if(y.D!=null)throw Error("WatchDog timer not null");y.D=ai(d(y.aa,y),R)}function ca(y){y.D&&(o.clearTimeout(y.D),y.D=null)}Oi.prototype.aa=function(){this.D=null;const y=Date.now();y-this.T>=0?(il(this.i,this.B),this.M!=2&&(ft(),rn(17)),Gr(this),this.m=2,si(this)):fc(this,this.T-y)};function si(y){y.j.I==0||y.K||ip(y.j,y)}function Gr(y){ca(y);var R=y.O;R&&typeof R.dispose=="function"&&R.dispose(),y.O=null,It(y.V),y.g&&(R=y.g,y.g=null,R.abort(),R.dispose())}function ua(y,R){try{var z=y.j;if(z.I!=0&&(z.g==y||fa(z.h,y))){if(!y.L&&fa(z.h,y)&&z.I==3){try{var H=z.Ba.g.parse(R)}catch{H=null}if(Array.isArray(H)&&H.length==3){var ue=H;if(ue[0]==0){e:if(!z.v){if(z.g)if(z.g.F+3e3<y.F)xc(z),Gs(z);else break e;pl(z),rn(18)}}else z.xa=ue[1],0<z.xa-z.K&&ue[2]<37500&&z.F&&z.A==0&&!z.C&&(z.C=ai(d(z.Va,z),6e3));da(z.h)<=1&&z.ta&&(z.ta=void 0)}else ya(z,11)}else if((y.L||z.g==y)&&xc(z),!P(R))for(ue=z.Ba.g.parse(R),R=0;R<ue.length;R++){let Nt=ue[R];const Zt=Nt[0];if(!(Zt<=z.K))if(z.K=Zt,Nt=Nt[1],z.I==2)if(Nt[0]=="c"){z.M=Nt[1],z.ba=Nt[2];const ci=Nt[3];ci!=null&&(z.ka=ci,z.j.info("VER="+z.ka));const ba=Nt[4];ba!=null&&(z.za=ba,z.j.info("SVER="+z.za));const Li=Nt[5];Li!=null&&typeof Li=="number"&&Li>0&&(H=1.5*Li,z.O=H,z.j.info("backChannelRequestTimeoutMs_="+H)),H=z;const Bi=y.g;if(Bi){const gl=Bi.g?Bi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(gl){var ge=H.h;ge.g||gl.indexOf("spdy")==-1&&gl.indexOf("quic")==-1&&gl.indexOf("h2")==-1||(ge.j=ge.l,ge.g=new Set,ge.h&&(cd(ge,ge.h),ge.h=null))}if(H.G){const wc=Bi.g?Bi.g.getResponseHeader("X-HTTP-Session-Id"):null;wc&&(H.wa=wc,Pt(H.J,H.G,wc))}}z.I=3,z.l&&z.l.ra(),z.aa&&(z.T=Date.now()-y.F,z.j.info("Handshake RTT: "+z.T+"ms")),H=z;var ke=y;if(H.na=op(H,H.L?H.ba:null,H.W),ke.L){ud(H.h,ke);var ot=ke,mn=H.O;mn&&(ot.H=mn),ot.D&&(ca(ot),la(ot)),H.g=ke}else np(H);z.i.length>0&&va(z)}else Nt[0]!="stop"&&Nt[0]!="close"||ya(z,7);else z.I==3&&(Nt[0]=="stop"||Nt[0]=="close"?Nt[0]=="stop"?ya(z,7):bd(z):Nt[0]!="noop"&&z.l&&z.l.qa(Nt),z.A=0)}}ft(4)}catch{}}var Tn=class{constructor(y,R){this.g=y,this.map=R}};function od(y){this.l=y||10,o.PerformanceNavigationTiming?(y=o.performance.getEntriesByType("navigation"),y=y.length>0&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ld(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function da(y){return y.h?1:y.g?y.g.size:0}function fa(y,R){return y.h?y.h==R:y.g?y.g.has(R):!1}function cd(y,R){y.g?y.g.add(R):y.h=R}function ud(y,R){y.h&&y.h==R?y.h=null:y.g&&y.g.has(R)&&y.g.delete(R)}od.prototype.cancel=function(){if(this.i=dd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function dd(y){if(y.h!=null)return y.i.concat(y.h.G);if(y.g!=null&&y.g.size!==0){let R=y.i;for(const z of y.g.values())R=R.concat(z.G);return R}return b(y.i)}var Kh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hc(y,R){if(y){y=y.split("&");for(let z=0;z<y.length;z++){const H=y[z].indexOf("=");let ue,ge=null;H>=0?(ue=y[z].substring(0,H),ge=y[z].substring(H+1)):ue=y[z],R(ue,ge?decodeURIComponent(ge.replace(/\+/g," ")):"")}}}function Hr(y){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let R;y instanceof Hr?(this.l=y.l,Hn(this,y.j),this.o=y.o,this.g=y.g,Vs(this,y.u),this.h=y.h,fd(this,ep(y.i)),this.m=y.m):y&&(R=String(y).match(Kh))?(this.l=!1,Hn(this,R[1]||"",!0),this.o=ha(R[2]||""),this.g=ha(R[3]||"",!0),Vs(this,R[4]),this.h=ha(R[5]||"",!0),fd(this,R[6]||"",!0),this.m=ha(R[7]||"")):(this.l=!1,this.i=new Ls(null,this.l))}Hr.prototype.toString=function(){const y=[];var R=this.j;R&&y.push(ll(R,pc,!0),":");var z=this.g;return(z||R=="file")&&(y.push("//"),(R=this.o)&&y.push(ll(R,pc,!0),"@"),y.push(Ya(z).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),z=this.u,z!=null&&y.push(":",String(z))),(z=this.h)&&(this.g&&z.charAt(0)!="/"&&y.push("/"),y.push(ll(z,z.charAt(0)=="/"?hd:Qh,!0))),(z=this.i.toString())&&y.push("?",z),(z=this.m)&&y.push("#",ll(z,Zh)),y.join("")},Hr.prototype.resolve=function(y){const R=An(this);let z=!!y.j;z?Hn(R,y.j):z=!!y.o,z?R.o=y.o:z=!!y.g,z?R.g=y.g:z=y.u!=null;var H=y.h;if(z)Vs(R,y.u);else if(z=!!y.h){if(H.charAt(0)!="/")if(this.g&&!this.h)H="/"+H;else{var ue=R.h.lastIndexOf("/");ue!=-1&&(H=R.h.slice(0,ue+1)+H)}if(ue=H,ue==".."||ue==".")H="";else if(ue.indexOf("./")!=-1||ue.indexOf("/.")!=-1){H=ue.lastIndexOf("/",0)==0,ue=ue.split("/");const ge=[];for(let ke=0;ke<ue.length;){const ot=ue[ke++];ot=="."?H&&ke==ue.length&&ge.push(""):ot==".."?((ge.length>1||ge.length==1&&ge[0]!="")&&ge.pop(),H&&ke==ue.length&&ge.push("")):(ge.push(ot),H=!0)}H=ge.join("/")}else H=ue}return z?R.h=H:z=y.i.toString()!=="",z?fd(R,ep(y.i)):z=!!y.m,z&&(R.m=y.m),R};function An(y){return new Hr(y)}function Hn(y,R,z){y.j=z?ha(R,!0):R,y.j&&(y.j=y.j.replace(/:$/,""))}function Vs(y,R){if(R){if(R=Number(R),isNaN(R)||R<0)throw Error("Bad port number "+R);y.u=R}else y.u=null}function fd(y,R,z){R instanceof Ls?(y.i=R,mc(y.i,y.l)):(z||(R=ll(R,zs)),y.i=new Ls(R,y.l))}function Pt(y,R,z){y.i.set(R,z)}function ol(y){return Pt(y,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),y}function ha(y,R){return y?R?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function ll(y,R,z){return typeof y=="string"?(y=encodeURI(y).replace(R,Tr),z&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Tr(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var pc=/[#\/\?@]/g,Qh=/[#\?:]/g,hd=/[#\?]/g,zs=/[#\?@]/g,Zh=/#/g;function Ls(y,R){this.h=this.g=null,this.i=y||null,this.j=!!R}function Ar(y){y.g||(y.g=new Map,y.h=0,y.i&&hc(y.i,function(R,z){y.add(decodeURIComponent(R.replace(/\+/g," ")),z)}))}t=Ls.prototype,t.add=function(y,R){Ar(this),this.i=null,y=Bs(this,y);let z=this.g.get(y);return z||this.g.set(y,z=[]),z.push(R),this.h+=1,this};function Jh(y,R){Ar(y),R=Bs(y,R),y.g.has(R)&&(y.i=null,y.h-=y.g.get(R).length,y.g.delete(R))}function pd(y,R){return Ar(y),R=Bs(y,R),y.g.has(R)}t.forEach=function(y,R){Ar(this),this.g.forEach(function(z,H){z.forEach(function(ue){y.call(R,ue,H,this)},this)},this)};function gd(y,R){Ar(y);let z=[];if(typeof R=="string")pd(y,R)&&(z=z.concat(y.g.get(Bs(y,R))));else for(y=Array.from(y.g.values()),R=0;R<y.length;R++)z=z.concat(y[R]);return z}t.set=function(y,R){return Ar(this),this.i=null,y=Bs(this,y),pd(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[R]),this.h+=1,this},t.get=function(y,R){return y?(y=gd(this,y),y.length>0?String(y[0]):R):R};function gc(y,R,z){Jh(y,R),z.length>0&&(y.i=null,y.g.set(Bs(y,R),b(z)),y.h+=z.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],R=Array.from(this.g.keys());for(let H=0;H<R.length;H++){var z=R[H];const ue=Ya(z);z=gd(this,z);for(let ge=0;ge<z.length;ge++){let ke=ue;z[ge]!==""&&(ke+="="+Ya(z[ge])),y.push(ke)}}return this.i=y.join("&")};function ep(y){const R=new Ls;return R.i=y.i,y.g&&(R.g=new Map(y.g),R.h=y.h),R}function Bs(y,R){return R=String(R),y.j&&(R=R.toLowerCase()),R}function mc(y,R){R&&!y.j&&(Ar(y),y.i=null,y.g.forEach(function(z,H){const ue=H.toLowerCase();H!=ue&&(Jh(this,H),gc(this,ue,z))},y)),y.j=R}function ji(y,R){const z=new pr;if(o.Image){const H=new Image;H.onload=h(oi,z,"TestLoadImage: loaded",!0,R,H),H.onerror=h(oi,z,"TestLoadImage: error",!1,R,H),H.onabort=h(oi,z,"TestLoadImage: abort",!1,R,H),H.ontimeout=h(oi,z,"TestLoadImage: timeout",!1,R,H),o.setTimeout(function(){H.ontimeout&&H.ontimeout()},1e4),H.src=y}else R(!1)}function md(y,R){const z=new pr,H=new AbortController,ue=setTimeout(()=>{H.abort(),oi(z,"TestPingServer: timeout",!1,R)},1e4);fetch(y,{signal:H.signal}).then(ge=>{clearTimeout(ue),ge.ok?oi(z,"TestPingServer: ok",!0,R):oi(z,"TestPingServer: server error",!1,R)}).catch(()=>{clearTimeout(ue),oi(z,"TestPingServer: error",!1,R)})}function oi(y,R,z,H,ue){try{ue&&(ue.onload=null,ue.onerror=null,ue.onabort=null,ue.ontimeout=null),H(z)}catch{}}function Us(){this.g=new aa}function pa(y){this.i=y.Sb||null,this.h=y.ab||!1}p(pa,qa),pa.prototype.g=function(){return new cl(this.i,this.h)};function cl(y,R){Me.call(this),this.H=y,this.o=R,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(cl,Me),t=cl.prototype,t.open=function(y,R){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=y,this.D=R,this.readyState=1,Vi(this)},t.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const R={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};y&&(R.body=y),(this.H||o).fetch(new Request(this.D,R)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Fs(this)),this.readyState=0},t.Pa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,Vi(this)),this.g&&(this.readyState=3,Vi(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;vc(this)}else y.text().then(this.Oa.bind(this),this.ga.bind(this))};function vc(y){y.j.read().then(y.Ma.bind(y)).catch(y.ga.bind(y))}t.Ma=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var R=y.value?y.value:new Uint8Array(0);(R=this.B.decode(R,{stream:!y.done}))&&(this.response=this.responseText+=R)}y.done?Fs(this):Vi(this),this.readyState==3&&vc(this)}},t.Oa=function(y){this.g&&(this.response=this.responseText=y,Fs(this))},t.Na=function(y){this.g&&(this.response=y,Fs(this))},t.ga=function(){this.g&&Fs(this)};function Fs(y){y.readyState=4,y.l=null,y.j=null,y.B=null,Vi(y)}t.setRequestHeader=function(y,R){this.A.append(y,R)},t.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],R=this.h.entries();for(var z=R.next();!z.done;)z=z.value,y.push(z[0]+": "+z[1]),z=R.next();return y.join(`\r
`)};function Vi(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(cl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function li(y){let R="";return se(y,function(z,H){R+=H,R+=":",R+=z,R+=`\r
`}),R}function ul(y,R,z){e:{for(H in z){var H=!1;break e}H=!0}H||(z=li(z),typeof y=="string"?z!=null&&Ya(z):Pt(y,R,z))}function Lt(y){Me.call(this),this.headers=new Map,this.L=y||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(Lt,Me);var ga=/^https?$/i,vd=["POST","PUT"];t=Lt.prototype,t.Fa=function(y){this.H=y},t.ea=function(y,R,z,H){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);R=R?R.toUpperCase():"GET",this.D=y,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():sd.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(R,String(y),!0),this.B=!1}catch(ge){dl(this,ge);return}if(y=z||"",z=new Map(this.headers),H)if(Object.getPrototypeOf(H)===Object.prototype)for(var ue in H)z.set(ue,H[ue]);else if(typeof H.keys=="function"&&typeof H.get=="function")for(const ge of H.keys())z.set(ge,H.get(ge));else throw Error("Unknown input type for opt_headers: "+String(H));H=Array.from(z.keys()).find(ge=>ge.toLowerCase()=="content-type"),ue=o.FormData&&y instanceof o.FormData,!(Array.prototype.indexOf.call(vd,R,void 0)>=0)||H||ue||z.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ge,ke]of z)this.g.setRequestHeader(ge,ke);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(y),this.v=!1}catch(ge){dl(this,ge)}};function dl(y,R){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=R,y.o=5,yd(y),Xa(y)}function yd(y){y.A||(y.A=!0,Be(y,"complete"),Be(y,"error"))}t.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=y||7,Be(this,"complete"),Be(this,"abort"),Xa(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Xa(this,!0)),Lt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?fl(this):this.Xa())},t.Xa=function(){fl(this)};function fl(y){if(y.h&&typeof a<"u"){if(y.v&&zi(y)==4)setTimeout(y.Ca.bind(y),0);else if(Be(y,"readystatechange"),zi(y)==4){y.h=!1;try{const ge=y.ca();e:switch(ge){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var R=!0;break e;default:R=!1}var z;if(!(z=R)){var H;if(H=ge===0){let ke=String(y.D).match(Kh)[1]||null;!ke&&o.self&&o.self.location&&(ke=o.self.location.protocol.slice(0,-1)),H=!ga.test(ke?ke.toLowerCase():"")}z=H}if(z)Be(y,"complete"),Be(y,"success");else{y.o=6;try{var ue=zi(y)>2?y.g.statusText:""}catch{ue=""}y.l=ue+" ["+y.ca()+"]",yd(y)}}finally{Xa(y)}}}}function Xa(y,R){if(y.g){y.m&&(clearTimeout(y.m),y.m=null);const z=y.g;y.g=null,R||Be(y,"ready");try{z.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function zi(y){return y.g?y.g.readyState:0}t.ca=function(){try{return zi(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(y){if(this.g){var R=this.g.responseText;return y&&R.indexOf(y)==0&&(R=R.substring(y.length)),Ur(R)}};function Xn(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.F){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function Wa(y){const R={};y=(y.g&&zi(y)>=2&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let H=0;H<y.length;H++){if(P(y[H]))continue;var z=Yh(y[H]);const ue=z[0];if(z=z[1],typeof z!="string")continue;z=z.trim();const ge=R[ue]||[];R[ue]=ge,ge.push(z)}G(R,function(H){return H.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ma(y,R,z){return z&&z.internalChannelParams&&z.internalChannelParams[y]||R}function $s(y){this.za=0,this.i=[],this.j=new pr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ma("failFast",!1,y),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ma("baseRetryDelayMs",5e3,y),this.Za=ma("retryDelaySeedMs",1e4,y),this.Ta=ma("forwardChannelMaxRetries",2,y),this.va=ma("forwardChannelRequestTimeoutMs",2e4,y),this.ma=y&&y.xmlHttpFactory||void 0,this.Ua=y&&y.Rb||void 0,this.Aa=y&&y.useFetchStreams||!1,this.O=void 0,this.L=y&&y.supportsCrossDomainXhr||!1,this.M="",this.h=new od(y&&y.concurrentRequestLimit),this.Ba=new Us,this.S=y&&y.fastHandshake||!1,this.R=y&&y.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=y&&y.Pb||!1,y&&y.ua&&this.j.ua(),y&&y.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&y&&y.detectBufferingProxy||!1,this.ia=void 0,y&&y.longPollingTimeout&&y.longPollingTimeout>0&&(this.ia=y.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=$s.prototype,t.ka=8,t.I=1,t.connect=function(y,R,z,H){rn(0),this.W=y,this.H=R||{},z&&H!==void 0&&(this.H.OSID=z,this.H.OAID=H),this.F=this.X,this.J=op(this,null,this.W),va(this)};function bd(y){if(yc(y),y.I==3){var R=y.V++,z=An(y.J);if(Pt(z,"SID",y.M),Pt(z,"RID",R),Pt(z,"TYPE","terminate"),hl(y,z),R=new Oi(y,y.j,R),R.M=2,R.A=ol(An(z)),z=!1,o.navigator&&o.navigator.sendBeacon)try{z=o.navigator.sendBeacon(R.A.toString(),"")}catch{}!z&&o.Image&&(new Image().src=R.A,z=!0),z||(R.g=lp(R.j,null),R.g.ea(R.A)),R.F=Date.now(),la(R)}sp(y)}function Gs(y){y.g&&(wd(y),y.g.cancel(),y.g=null)}function yc(y){Gs(y),y.v&&(o.clearTimeout(y.v),y.v=null),xc(y),y.h.cancel(),y.m&&(typeof y.m=="number"&&o.clearTimeout(y.m),y.m=null)}function va(y){if(!ld(y.h)&&!y.m){y.m=!0;var R=y.Ea;O||k(),M||(O(),M=!0),A.add(R,y),y.D=0}}function bc(y,R){return da(y.h)>=y.h.j-(y.m?1:0)?!1:y.m?(y.i=R.G.concat(y.i),!0):y.I==1||y.I==2||y.D>=(y.Sa?0:y.Ta)?!1:(y.m=ai(d(y.Ea,y,R),ap(y,y.D)),y.D++,!0)}t.Ea=function(y){if(this.m)if(this.m=null,this.I==1){if(!y){this.V=Math.floor(Math.random()*1e5),y=this.V++;const ue=new Oi(this,this.j,y);let ge=this.o;if(this.U&&(ge?(ge=F(ge),Z(ge,this.U)):ge=this.U),this.u!==null||this.R||(ue.J=ge,ge=null),this.S)e:{for(var R=0,z=0;z<this.i.length;z++){t:{var H=this.i[z];if("__data__"in H.map&&(H=H.map.__data__,typeof H=="string")){H=H.length;break t}H=void 0}if(H===void 0)break;if(R+=H,R>4096){R=z;break e}if(R===4096||z===this.i.length-1){R=z+1;break e}}R=1e3}else R=1e3;R=tp(this,ue,R),z=An(this.J),Pt(z,"RID",y),Pt(z,"CVER",22),this.G&&Pt(z,"X-HTTP-Session-Id",this.G),hl(this,z),ge&&(this.R?R="headers="+Ya(li(ge))+"&"+R:this.u&&ul(z,this.u,ge)),cd(this.h,ue),this.Ra&&Pt(z,"TYPE","init"),this.S?(Pt(z,"$req",R),Pt(z,"SID","null"),ue.U=!0,oa(ue,z,null)):oa(ue,z,R),this.I=2}}else this.I==3&&(y?xd(this,y):this.i.length==0||ld(this.h)||xd(this))};function xd(y,R){var z;R?z=R.l:z=y.V++;const H=An(y.J);Pt(H,"SID",y.M),Pt(H,"RID",z),Pt(H,"AID",y.K),hl(y,H),y.u&&y.o&&ul(H,y.u,y.o),z=new Oi(y,y.j,z,y.D+1),y.u===null&&(z.J=y.o),R&&(y.i=R.G.concat(y.i)),R=tp(y,z,1e3),z.H=Math.round(y.va*.5)+Math.round(y.va*.5*Math.random()),cd(y.h,z),oa(z,H,R)}function hl(y,R){y.H&&se(y.H,function(z,H){Pt(R,H,z)}),y.l&&se({},function(z,H){Pt(R,H,z)})}function tp(y,R,z){z=Math.min(y.i.length,z);const H=y.l?d(y.l.Ka,y.l,y):null;e:{var ue=y.i;let ot=-1;for(;;){const mn=["count="+z];ot==-1?z>0?(ot=ue[0].g,mn.push("ofs="+ot)):ot=0:mn.push("ofs="+ot);let Nt=!0;for(let Zt=0;Zt<z;Zt++){var ge=ue[Zt].g;const ci=ue[Zt].map;if(ge-=ot,ge<0)ot=Math.max(0,ue[Zt].g-100),Nt=!1;else try{ge="req"+ge+"_"||"";try{var ke=ci instanceof Map?ci:Object.entries(ci);for(const[ba,Li]of ke){let Bi=Li;c(Li)&&(Bi=_n(Li)),mn.push(ge+ba+"="+encodeURIComponent(Bi))}}catch(ba){throw mn.push(ge+"type="+encodeURIComponent("_badmap")),ba}}catch{H&&H(ci)}}if(Nt){ke=mn.join("&");break e}}ke=void 0}return y=y.i.splice(0,z),R.G=y,ke}function np(y){if(!y.g&&!y.v){y.Y=1;var R=y.Da;O||k(),M||(O(),M=!0),A.add(R,y),y.A=0}}function pl(y){return y.g||y.v||y.A>=3?!1:(y.Y++,y.v=ai(d(y.Da,y),ap(y,y.A)),y.A++,!0)}t.Da=function(){if(this.v=null,rp(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var y=4*this.T;this.j.info("BP detection timer enabled: "+y),this.B=ai(d(this.Wa,this),y)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,rn(10),Gs(this),rp(this))};function wd(y){y.B!=null&&(o.clearTimeout(y.B),y.B=null)}function rp(y){y.g=new Oi(y,y.j,"rpc",y.Y),y.u===null&&(y.g.J=y.o),y.g.P=0;var R=An(y.na);Pt(R,"RID","rpc"),Pt(R,"SID",y.M),Pt(R,"AID",y.K),Pt(R,"CI",y.F?"0":"1"),!y.F&&y.ia&&Pt(R,"TO",y.ia),Pt(R,"TYPE","xmlhttp"),hl(y,R),y.u&&y.o&&ul(R,y.u,y.o),y.O&&(y.g.H=y.O);var z=y.g;y=y.ba,z.M=1,z.A=ol(An(R)),z.u=null,z.R=!0,dc(z,y)}t.Va=function(){this.C!=null&&(this.C=null,Gs(this),pl(this),rn(19))};function xc(y){y.C!=null&&(o.clearTimeout(y.C),y.C=null)}function ip(y,R){var z=null;if(y.g==R){xc(y),wd(y),y.g=null;var H=2}else if(fa(y.h,R))z=R.G,ud(y.h,R),H=1;else return;if(y.I!=0){if(R.o)if(H==1){z=R.u?R.u.length:0,R=Date.now()-R.F;var ue=y.D;H=Ps(),Be(H,new $r(H,z)),va(y)}else np(y);else if(ue=R.m,ue==3||ue==0&&R.X>0||!(H==1&&bc(y,R)||H==2&&pl(y)))switch(z&&z.length>0&&(R=y.h,R.i=R.i.concat(z)),ue){case 1:ya(y,5);break;case 4:ya(y,10);break;case 3:ya(y,6);break;default:ya(y,2)}}}function ap(y,R){let z=y.Qa+Math.floor(Math.random()*y.Za);return y.isActive()||(z*=2),z*R}function ya(y,R){if(y.j.info("Error code "+R),R==2){var z=d(y.bb,y),H=y.Ua;const ue=!H;H=new Hr(H||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Hn(H,"https"),ol(H),ue?ji(H.toString(),z):md(H.toString(),z)}else rn(2);y.I=0,y.l&&y.l.pa(R),sp(y),yc(y)}t.bb=function(y){y?(this.j.info("Successfully pinged google.com"),rn(2)):(this.j.info("Failed to ping google.com"),rn(1))};function sp(y){if(y.I=0,y.ja=[],y.l){const R=dd(y.h);(R.length!=0||y.i.length!=0)&&(w(y.ja,R),w(y.ja,y.i),y.h.i.length=0,b(y.i),y.i.length=0),y.l.oa()}}function op(y,R,z){var H=z instanceof Hr?An(z):new Hr(z);if(H.g!="")R&&(H.g=R+"."+H.g),Vs(H,H.u);else{var ue=o.location;H=ue.protocol,R=R?R+"."+ue.hostname:ue.hostname,ue=+ue.port;const ge=new Hr(null);H&&Hn(ge,H),R&&(ge.g=R),ue&&Vs(ge,ue),z&&(ge.h=z),H=ge}return z=y.G,R=y.wa,z&&R&&Pt(H,z,R),Pt(H,"VER",y.ka),hl(y,H),H}function lp(y,R,z){if(R&&!y.L)throw Error("Can't create secondary domain capable XhrIo object.");return R=y.Aa&&!y.ma?new Lt(new pa({ab:z})):new Lt(y.ma),R.Fa(y.L),R}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function cp(){}t=cp.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Hs(){}Hs.prototype.g=function(y,R){return new gr(y,R)};function gr(y,R){Me.call(this),this.g=new $s(R),this.l=y,this.h=R&&R.messageUrlParams||null,y=R&&R.messageHeaders||null,R&&R.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=R&&R.initMessageHeaders||null,R&&R.messageContentType&&(y?y["X-WebChannel-Content-Type"]=R.messageContentType:y={"X-WebChannel-Content-Type":R.messageContentType}),R&&R.sa&&(y?y["X-WebChannel-Client-Profile"]=R.sa:y={"X-WebChannel-Client-Profile":R.sa}),this.g.U=y,(y=R&&R.Qb)&&!P(y)&&(this.g.u=y),this.A=R&&R.supportsCrossDomainXhr||!1,this.v=R&&R.sendRawJson||!1,(R=R&&R.httpSessionIdParam)&&!P(R)&&(this.g.G=R,y=this.h,y!==null&&R in y&&(y=this.h,R in y&&delete y[R])),this.j=new Ka(this)}p(gr,Me),gr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},gr.prototype.close=function(){bd(this.g)},gr.prototype.o=function(y){var R=this.g;if(typeof y=="string"){var z={};z.__data__=y,y=z}else this.v&&(z={},z.__data__=_n(y),y=z);R.i.push(new Tn(R.Ya++,y)),R.I==3&&va(R)},gr.prototype.N=function(){this.g.l=null,delete this.j,bd(this.g),delete this.g,gr.Z.N.call(this)};function up(y){Sn.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var R=y.__sm__;if(R){e:{for(const z in R){y=z;break e}y=void 0}(this.i=y)&&(y=this.i,R=R!==null&&y in R?R[y]:void 0),this.data=R}else this.data=y}p(up,Sn);function dp(){ar.call(this),this.status=1}p(dp,ar);function Ka(y){this.g=y}p(Ka,cp),Ka.prototype.ra=function(){Be(this.g,"a")},Ka.prototype.qa=function(y){Be(this.g,new up(y))},Ka.prototype.pa=function(y){Be(this.g,new dp)},Ka.prototype.oa=function(){Be(this.g,"b")},Hs.prototype.createWebChannel=Hs.prototype.g,gr.prototype.send=gr.prototype.o,gr.prototype.open=gr.prototype.m,gr.prototype.close=gr.prototype.close,CD=function(){return new Hs},AD=function(){return Ps()},TD=tn,vx={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},al.NO_ERROR=0,al.TIMEOUT=8,al.HTTP_ERROR=6,Xg=al,ad.COMPLETE="complete",ED=ad,Os.EventType=Fr,Fr.OPEN="a",Fr.CLOSE="b",Fr.ERROR="c",Fr.MESSAGE="d",Me.prototype.listen=Me.prototype.J,hf=Os,Lt.prototype.listenOnce=Lt.prototype.K,Lt.prototype.getLastError=Lt.prototype.Ha,Lt.prototype.getLastErrorCode=Lt.prototype.ya,Lt.prototype.getStatus=Lt.prototype.ca,Lt.prototype.getResponseJson=Lt.prototype.La,Lt.prototype.getResponseText=Lt.prototype.la,Lt.prototype.send=Lt.prototype.ea,Lt.prototype.setWithCredentials=Lt.prototype.Fa,SD=Lt}).apply(typeof yg<"u"?yg:typeof self<"u"?self:typeof window<"u"?window:{});const VC="@firebase/firestore",zC="4.9.2";class lr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}lr.UNAUTHENTICATED=new lr(null),lr.GOOGLE_CREDENTIALS=new lr("google-credentials-uid"),lr.FIRST_PARTY=new lr("first-party-uid"),lr.MOCK_USER=new lr("mock-user");let Gu="12.3.0";const Ql=new z1("@firebase/firestore");function Zc(){return Ql.logLevel}function Pe(t,...e){if(Ql.logLevel<=bt.DEBUG){const n=e.map(nw);Ql.debug(`Firestore (${Gu}): ${t}`,...n)}}function Cs(t,...e){if(Ql.logLevel<=bt.ERROR){const n=e.map(nw);Ql.error(`Firestore (${Gu}): ${t}`,...n)}}function Su(t,...e){if(Ql.logLevel<=bt.WARN){const n=e.map(nw);Ql.warn(`Firestore (${Gu}): ${t}`,...n)}}function nw(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function Je(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,kD(t,r,n)}function kD(t,e,n){let r=`FIRESTORE (${Gu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Cs(r),new Error(r)}function Mt(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||kD(e,i,r)}function at(t,e){return t}const be={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class De extends $a{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class xs{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class RD{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class vU{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(lr.UNAUTHENTICATED)))}shutdown(){}}class yU{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class bU{constructor(e){this.t=e,this.currentUser=lr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Mt(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let a=new xs;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new xs,e.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const u=a;e.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},c=u=>{Pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>c(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(Pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new xs)}}),0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((r=>this.i!==e?(Pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Mt(typeof r.accessToken=="string",31837,{l:r}),new RD(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Mt(e===null||typeof e=="string",2055,{h:e}),new lr(e)}}class xU{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=lr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class wU{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new xU(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(lr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class LC{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class _U{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ti(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Mt(this.o===void 0,3512);const r=a=>{a.error!=null&&Pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.m;return this.m=a.token,Pe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>r(a)))};const i=a=>{Pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):Pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new LC(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(Mt(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new LC(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function SU(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}class rw{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=SU(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<n&&(r+=e.charAt(i[a]%62))}return r}}function xt(t,e){return t<e?-1:t>e?1:0}function yx(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),a=e.charAt(r);if(i!==a)return mb(i)===mb(a)?xt(i,a):mb(i)?1:-1}return xt(t.length,e.length)}const EU=55296,TU=57343;function mb(t){const e=t.charCodeAt(0);return e>=EU&&e<=TU}function Eu(t,e,n){return t.length===e.length&&t.every(((r,i)=>n(r,e[i])))}const BC="__name__";class Ta{constructor(e,n,r){n===void 0?n=0:n>e.length&&Je(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Je(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Ta.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ta?e.forEach((r=>{n.push(r)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const a=Ta.compareSegments(e.get(i),n.get(i));if(a!==0)return a}return xt(e.length,n.length)}static compareSegments(e,n){const r=Ta.isNumericId(e),i=Ta.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?Ta.extractNumericId(e).compare(Ta.extractNumericId(n)):yx(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Io.fromString(e.substring(4,e.length-2))}}class Yt extends Ta{construct(e,n,r){return new Yt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new De(be.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter((i=>i.length>0)))}return new Yt(n)}static emptyPath(){return new Yt([])}}const AU=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class nr extends Ta{construct(e,n,r){return new nr(e,n,r)}static isValidIdentifier(e){return AU.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),nr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===BC}static keyField(){return new nr([BC])}static fromServerFormat(e){const n=[];let r="",i=0;const a=()=>{if(r.length===0)throw new De(be.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new De(be.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new De(be.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(r+=c,i++):(a(),i++)}if(a(),o)throw new De(be.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new nr(n)}static emptyPath(){return new nr([])}}class qe{constructor(e){this.path=e}static fromPath(e){return new qe(Yt.fromString(e))}static fromName(e){return new qe(Yt.fromString(e).popFirst(5))}static empty(){return new qe(Yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Yt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Yt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new qe(new Yt(e.slice()))}}function ND(t,e,n){if(!n)throw new De(be.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function CU(t,e,n,r){if(e===!0&&r===!0)throw new De(be.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function UC(t){if(!qe.isDocumentKey(t))throw new De(be.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function FC(t){if(qe.isDocumentKey(t))throw new De(be.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function DD(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function p0(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Je(12329,{type:typeof t})}function _r(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new De(be.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=p0(t);throw new De(be.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function jn(t,e){const n={typeString:t};return e&&(n.value=e),n}function _h(t,e){if(!DD(t))throw new De(be.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(a!==void 0&&o!==a.value){n=`Expected '${r}' field to equal '${a.value}'`;break}}if(n)throw new De(be.INVALID_ARGUMENT,n);return!0}const $C=-62135596800,GC=1e6;class mt{static now(){return mt.fromMillis(Date.now())}static fromDate(e){return mt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*GC);return new mt(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new De(be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new De(be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<$C)throw new De(be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new De(be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/GC}_compareTo(e){return this.seconds===e.seconds?xt(this.nanoseconds,e.nanoseconds):xt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:mt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(_h(e,mt._jsonSchema))return new mt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-$C;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}mt._jsonSchemaVersion="firestore/timestamp/1.0",mt._jsonSchema={type:jn("string",mt._jsonSchemaVersion),seconds:jn("number"),nanoseconds:jn("number")};class nt{static fromTimestamp(e){return new nt(e)}static min(){return new nt(new mt(0,0))}static max(){return new nt(new mt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const qf=-1;function kU(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=nt.fromTimestamp(r===1e9?new mt(n+1,0):new mt(n,r));return new zo(i,qe.empty(),e)}function RU(t){return new zo(t.readTime,t.key,qf)}class zo{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new zo(nt.min(),qe.empty(),qf)}static max(){return new zo(nt.max(),qe.empty(),qf)}}function NU(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=qe.comparator(t.documentKey,e.documentKey),n!==0?n:xt(t.largestBatchId,e.largestBatchId))}const DU="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class IU{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Hu(t){if(t.code!==be.FAILED_PRECONDITION||t.message!==DU)throw t;Pe("LocalStore","Unexpectedly lost primary lease")}class _e{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Je(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new _e(((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(n,a).next(r,i)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof _e?n:_e.resolve(n)}catch(n){return _e.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):_e.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):_e.reject(n)}static resolve(e){return new _e(((n,r)=>{n(e)}))}static reject(e){return new _e(((n,r)=>{r(e)}))}static waitFor(e){return new _e(((n,r)=>{let i=0,a=0,o=!1;e.forEach((c=>{++i,c.next((()=>{++a,o&&a===i&&n()}),(u=>r(u)))})),o=!0,a===i&&n()}))}static or(e){let n=_e.resolve(!1);for(const r of e)n=n.next((i=>i?_e.resolve(i):r()));return n}static forEach(e,n){const r=[];return e.forEach(((i,a)=>{r.push(n.call(this,i,a))})),this.waitFor(r)}static mapArray(e,n){return new _e(((r,i)=>{const a=e.length,o=new Array(a);let c=0;for(let u=0;u<a;u++){const d=u;n(e[d]).next((h=>{o[d]=h,++c,c===a&&r(o)}),(h=>i(h)))}}))}static doWhile(e,n){return new _e(((r,i)=>{const a=()=>{e()===!0?n().next((()=>{a()}),i):r()};a()}))}}function MU(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function qu(t){return t.name==="IndexedDbTransactionError"}class g0{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}g0.ce=-1;const iw=-1;function m0(t){return t==null}function Sm(t){return t===0&&1/t==-1/0}function OU(t){return typeof t=="number"&&Number.isInteger(t)&&!Sm(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const ID="";function PU(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=HC(e)),e=jU(t.get(n),e);return HC(e)}function jU(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const a=t.charAt(i);switch(a){case"\0":n+="";break;case ID:n+="";break;default:n+=a}}return n}function HC(t){return t+ID+""}function qC(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Jo(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function MD(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class ln{constructor(e,n){this.comparator=e,this.root=n||tr.EMPTY}insert(e,n){return new ln(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,tr.BLACK,null,null))}remove(e){return new ln(this.comparator,this.root.remove(e,this.comparator).copy(null,null,tr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,r)=>(e(n,r),!1)))}toString(){const e=[];return this.inorderTraversal(((n,r)=>(e.push(`${n}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new bg(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new bg(this.root,e,this.comparator,!1)}getReverseIterator(){return new bg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new bg(this.root,e,this.comparator,!0)}}class bg{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=n?r(e.key,n):1,n&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class tr{constructor(e,n,r,i,a){this.key=e,this.value=n,this.color=r??tr.RED,this.left=i??tr.EMPTY,this.right=a??tr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,a){return new tr(e??this.key,n??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,n,r),null):a===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return tr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return tr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,tr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,tr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Je(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Je(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Je(27949);return e+(this.isRed()?0:1)}}tr.EMPTY=null,tr.RED=!0,tr.BLACK=!1;tr.EMPTY=new class{constructor(){this.size=0}get key(){throw Je(57766)}get value(){throw Je(16141)}get color(){throw Je(16727)}get left(){throw Je(29726)}get right(){throw Je(36894)}copy(e,n,r,i,a){return this}insert(e,n,r){return new tr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class $n{constructor(e){this.comparator=e,this.data=new ln(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,r)=>(e(n),!1)))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new YC(this.data.getIterator())}getIteratorFrom(e){return new YC(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((r=>{n=n.add(r)})),n}isEqual(e){if(!(e instanceof $n)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,a=r.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new $n(this.comparator);return n.data=e,n}}class YC{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ni{constructor(e){this.fields=e,e.sort(nr.comparator)}static empty(){return new ni([])}unionWith(e){let n=new $n(nr.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new ni(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Eu(this.fields,e.fields,((n,r)=>n.isEqual(r)))}}class OD extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ir{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new OD("Invalid base64 string: "+a):a}})(e);return new ir(n)}static fromUint8Array(e){const n=(function(i){let a="";for(let o=0;o<i.length;++o)a+=String.fromCharCode(i[o]);return a})(e);return new ir(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ir.EMPTY_BYTE_STRING=new ir("");const VU=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Lo(t){if(Mt(!!t,39018),typeof t=="string"){let e=0;const n=VU.exec(t);if(Mt(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:xn(t.seconds),nanos:xn(t.nanos)}}function xn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Bo(t){return typeof t=="string"?ir.fromBase64String(t):ir.fromUint8Array(t)}const PD="server_timestamp",jD="__type__",VD="__previous_value__",zD="__local_write_time__";function aw(t){return(t?.mapValue?.fields||{})[jD]?.stringValue===PD}function v0(t){const e=t.mapValue.fields[VD];return aw(e)?v0(e):e}function Yf(t){const e=Lo(t.mapValue.fields[zD].timestampValue);return new mt(e.seconds,e.nanos)}class zU{constructor(e,n,r,i,a,o,c,u,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=h}}const Em="(default)";class Xf{constructor(e,n){this.projectId=e,this.database=n||Em}static empty(){return new Xf("","")}get isDefaultDatabase(){return this.database===Em}isEqual(e){return e instanceof Xf&&e.projectId===this.projectId&&e.database===this.database}}const LD="__type__",LU="__max__",xg={mapValue:{}},BD="__vector__",Tm="value";function Uo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?aw(t)?4:UU(t)?9007199254740991:BU(t)?10:11:Je(28295,{value:t})}function La(t,e){if(t===e)return!0;const n=Uo(t);if(n!==Uo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Yf(t).isEqual(Yf(e));case 3:return(function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const o=Lo(i.timestampValue),c=Lo(a.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(i,a){return Bo(i.bytesValue).isEqual(Bo(a.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(i,a){return xn(i.geoPointValue.latitude)===xn(a.geoPointValue.latitude)&&xn(i.geoPointValue.longitude)===xn(a.geoPointValue.longitude)})(t,e);case 2:return(function(i,a){if("integerValue"in i&&"integerValue"in a)return xn(i.integerValue)===xn(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const o=xn(i.doubleValue),c=xn(a.doubleValue);return o===c?Sm(o)===Sm(c):isNaN(o)&&isNaN(c)}return!1})(t,e);case 9:return Eu(t.arrayValue.values||[],e.arrayValue.values||[],La);case 10:case 11:return(function(i,a){const o=i.mapValue.fields||{},c=a.mapValue.fields||{};if(qC(o)!==qC(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!La(o[u],c[u])))return!1;return!0})(t,e);default:return Je(52216,{left:t})}}function Wf(t,e){return(t.values||[]).find((n=>La(n,e)))!==void 0}function Tu(t,e){if(t===e)return 0;const n=Uo(t),r=Uo(e);if(n!==r)return xt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return xt(t.booleanValue,e.booleanValue);case 2:return(function(a,o){const c=xn(a.integerValue||a.doubleValue),u=xn(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1})(t,e);case 3:return XC(t.timestampValue,e.timestampValue);case 4:return XC(Yf(t),Yf(e));case 5:return yx(t.stringValue,e.stringValue);case 6:return(function(a,o){const c=Bo(a),u=Bo(o);return c.compareTo(u)})(t.bytesValue,e.bytesValue);case 7:return(function(a,o){const c=a.split("/"),u=o.split("/");for(let d=0;d<c.length&&d<u.length;d++){const h=xt(c[d],u[d]);if(h!==0)return h}return xt(c.length,u.length)})(t.referenceValue,e.referenceValue);case 8:return(function(a,o){const c=xt(xn(a.latitude),xn(o.latitude));return c!==0?c:xt(xn(a.longitude),xn(o.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return WC(t.arrayValue,e.arrayValue);case 10:return(function(a,o){const c=a.fields||{},u=o.fields||{},d=c[Tm]?.arrayValue,h=u[Tm]?.arrayValue,p=xt(d?.values?.length||0,h?.values?.length||0);return p!==0?p:WC(d,h)})(t.mapValue,e.mapValue);case 11:return(function(a,o){if(a===xg.mapValue&&o===xg.mapValue)return 0;if(a===xg.mapValue)return 1;if(o===xg.mapValue)return-1;const c=a.fields||{},u=Object.keys(c),d=o.fields||{},h=Object.keys(d);u.sort(),h.sort();for(let p=0;p<u.length&&p<h.length;++p){const m=yx(u[p],h[p]);if(m!==0)return m;const b=Tu(c[u[p]],d[h[p]]);if(b!==0)return b}return xt(u.length,h.length)})(t.mapValue,e.mapValue);default:throw Je(23264,{he:n})}}function XC(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return xt(t,e);const n=Lo(t),r=Lo(e),i=xt(n.seconds,r.seconds);return i!==0?i:xt(n.nanos,r.nanos)}function WC(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const a=Tu(n[i],r[i]);if(a)return a}return xt(n.length,r.length)}function Au(t){return bx(t)}function bx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const r=Lo(n);return`time(${r.seconds},${r.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return Bo(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return qe.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let r="[",i=!0;for(const a of n.values||[])i?i=!1:r+=",",r+=bx(a);return r+"]"})(t.arrayValue):"mapValue"in t?(function(n){const r=Object.keys(n.fields||{}).sort();let i="{",a=!0;for(const o of r)a?a=!1:i+=",",i+=`${o}:${bx(n.fields[o])}`;return i+"}"})(t.mapValue):Je(61005,{value:t})}function Wg(t){switch(Uo(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=v0(t);return e?16+Wg(e):16;case 5:return 2*t.stringValue.length;case 6:return Bo(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,a)=>i+Wg(a)),0)})(t.arrayValue);case 10:case 11:return(function(r){let i=0;return Jo(r.fields,((a,o)=>{i+=a.length+Wg(o)})),i})(t.mapValue);default:throw Je(13486,{value:t})}}function KC(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function xx(t){return!!t&&"integerValue"in t}function sw(t){return!!t&&"arrayValue"in t}function QC(t){return!!t&&"nullValue"in t}function ZC(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Kg(t){return!!t&&"mapValue"in t}function BU(t){return(t?.mapValue?.fields||{})[LD]?.stringValue===BD}function Ef(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Jo(t.mapValue.fields,((n,r)=>e.mapValue.fields[n]=Ef(r))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ef(t.arrayValue.values[n]);return e}return{...t}}function UU(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===LU}class Or{constructor(e){this.value=e}static empty(){return new Or({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Kg(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ef(n)}setAll(e){let n=nr.emptyPath(),r={},i=[];e.forEach(((o,c)=>{if(!n.isImmediateParentOf(c)){const u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=c.popLast()}o?r[c.lastSegment()]=Ef(o):i.push(c.lastSegment())}));const a=this.getFieldsMap(n);this.applyChanges(a,r,i)}delete(e){const n=this.field(e.popLast());Kg(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return La(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Kg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Jo(n,((i,a)=>e[i]=a));for(const i of r)delete e[i]}clone(){return new Or(Ef(this.value))}}function UD(t){const e=[];return Jo(t.fields,((n,r)=>{const i=new nr([n]);if(Kg(r)){const a=UD(r.mapValue).fields;if(a.length===0)e.push(i);else for(const o of a)e.push(i.child(o))}else e.push(i)})),new ni(e)}class cr{constructor(e,n,r,i,a,o,c){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=a,this.data=o,this.documentState=c}static newInvalidDocument(e){return new cr(e,0,nt.min(),nt.min(),nt.min(),Or.empty(),0)}static newFoundDocument(e,n,r,i){return new cr(e,1,n,nt.min(),r,i,0)}static newNoDocument(e,n){return new cr(e,2,n,nt.min(),nt.min(),Or.empty(),0)}static newUnknownDocument(e,n){return new cr(e,3,n,nt.min(),nt.min(),Or.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(nt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Or.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Or.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=nt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof cr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new cr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Am{constructor(e,n){this.position=e,this.inclusive=n}}function JC(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const a=e[i],o=t.position[i];if(a.field.isKeyField()?r=qe.comparator(qe.fromName(o.referenceValue),n.key):r=Tu(o,n.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function e2(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!La(t.position[n],e.position[n]))return!1;return!0}class Kf{constructor(e,n="asc"){this.field=e,this.dir=n}}function FU(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class FD{}class On extends FD{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new GU(e,n,r):n==="array-contains"?new YU(e,r):n==="in"?new XU(e,r):n==="not-in"?new WU(e,r):n==="array-contains-any"?new KU(e,r):new On(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new HU(e,r):new qU(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Tu(n,this.value)):n!==null&&Uo(this.value)===Uo(n)&&this.matchesComparison(Tu(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Je(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Zi extends FD{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Zi(e,n)}matches(e){return $D(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function $D(t){return t.op==="and"}function GD(t){return $U(t)&&$D(t)}function $U(t){for(const e of t.filters)if(e instanceof Zi)return!1;return!0}function wx(t){if(t instanceof On)return t.field.canonicalString()+t.op.toString()+Au(t.value);if(GD(t))return t.filters.map((e=>wx(e))).join(",");{const e=t.filters.map((n=>wx(n))).join(",");return`${t.op}(${e})`}}function HD(t,e){return t instanceof On?(function(r,i){return i instanceof On&&r.op===i.op&&r.field.isEqual(i.field)&&La(r.value,i.value)})(t,e):t instanceof Zi?(function(r,i){return i instanceof Zi&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((a,o,c)=>a&&HD(o,i.filters[c])),!0):!1})(t,e):void Je(19439)}function qD(t){return t instanceof On?(function(n){return`${n.field.canonicalString()} ${n.op} ${Au(n.value)}`})(t):t instanceof Zi?(function(n){return n.op.toString()+" {"+n.getFilters().map(qD).join(" ,")+"}"})(t):"Filter"}class GU extends On{constructor(e,n,r){super(e,n,r),this.key=qe.fromName(r.referenceValue)}matches(e){const n=qe.comparator(e.key,this.key);return this.matchesComparison(n)}}class HU extends On{constructor(e,n){super(e,"in",n),this.keys=YD("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class qU extends On{constructor(e,n){super(e,"not-in",n),this.keys=YD("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function YD(t,e){return(e.arrayValue?.values||[]).map((n=>qe.fromName(n.referenceValue)))}class YU extends On{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return sw(n)&&Wf(n.arrayValue,this.value)}}class XU extends On{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Wf(this.value.arrayValue,n)}}class WU extends On{constructor(e,n){super(e,"not-in",n)}matches(e){if(Wf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Wf(this.value.arrayValue,n)}}class KU extends On{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!sw(n)||!n.arrayValue.values)&&n.arrayValue.values.some((r=>Wf(this.value.arrayValue,r)))}}class QU{constructor(e,n=null,r=[],i=[],a=null,o=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=c,this.Te=null}}function t2(t,e=null,n=[],r=[],i=null,a=null,o=null){return new QU(t,e,n,r,i,a,o)}function ow(t){const e=at(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((r=>wx(r))).join(","),n+="|ob:",n+=e.orderBy.map((r=>(function(a){return a.field.canonicalString()+a.dir})(r))).join(","),m0(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((r=>Au(r))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((r=>Au(r))).join(",")),e.Te=n}return e.Te}function lw(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!FU(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!HD(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!e2(t.startAt,e.startAt)&&e2(t.endAt,e.endAt)}function _x(t){return qe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class Yu{constructor(e,n=null,r=[],i=[],a=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function ZU(t,e,n,r,i,a,o,c){return new Yu(t,e,n,r,i,a,o,c)}function y0(t){return new Yu(t)}function n2(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function XD(t){return t.collectionGroup!==null}function Tf(t){const e=at(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),n.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new $n(nr.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((d=>{d.isInequality()&&(c=c.add(d.field))}))})),c})(e).forEach((a=>{n.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new Kf(a,r))})),n.has(nr.keyField().canonicalString())||e.Ie.push(new Kf(nr.keyField(),r))}return e.Ie}function Ia(t){const e=at(t);return e.Ee||(e.Ee=JU(e,Tf(t))),e.Ee}function JU(t,e){if(t.limitType==="F")return t2(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((i=>{const a=i.dir==="desc"?"asc":"desc";return new Kf(i.field,a)}));const n=t.endAt?new Am(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Am(t.startAt.position,t.startAt.inclusive):null;return t2(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Sx(t,e){const n=t.filters.concat([e]);return new Yu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Cm(t,e,n){return new Yu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function b0(t,e){return lw(Ia(t),Ia(e))&&t.limitType===e.limitType}function WD(t){return`${ow(Ia(t))}|lt:${t.limitType}`}function Jc(t){return`Query(target=${(function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map((i=>qD(i))).join(", ")}]`),m0(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map((i=>Au(i))).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map((i=>Au(i))).join(",")),`Target(${r})`})(Ia(t))}; limitType=${t.limitType})`}function x0(t,e){return e.isFoundDocument()&&(function(r,i){const a=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):qe.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)})(t,e)&&(function(r,i){for(const a of Tf(r))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0})(t,e)&&(function(r,i){for(const a of r.filters)if(!a.matches(i))return!1;return!0})(t,e)&&(function(r,i){return!(r.startAt&&!(function(o,c,u){const d=JC(o,c,u);return o.inclusive?d<=0:d<0})(r.startAt,Tf(r),i)||r.endAt&&!(function(o,c,u){const d=JC(o,c,u);return o.inclusive?d>=0:d>0})(r.endAt,Tf(r),i))})(t,e)}function e8(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function KD(t){return(e,n)=>{let r=!1;for(const i of Tf(t)){const a=t8(i,e,n);if(a!==0)return a;r=r||i.field.isKeyField()}return 0}}function t8(t,e,n){const r=t.field.isKeyField()?qe.comparator(e.key,n.key):(function(a,o,c){const u=o.data.field(a),d=c.data.field(a);return u!==null&&d!==null?Tu(u,d):Je(42886)})(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Je(19790,{direction:t.dir})}}class ac{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,a]of r)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Jo(this.inner,((n,r)=>{for(const[i,a]of r)e(i,a)}))}isEmpty(){return MD(this.inner)}size(){return this.innerSize}}const n8=new ln(qe.comparator);function ks(){return n8}const QD=new ln(qe.comparator);function pf(...t){let e=QD;for(const n of t)e=e.insert(n.key,n);return e}function ZD(t){let e=QD;return t.forEach(((n,r)=>e=e.insert(n,r.overlayedDocument))),e}function Ll(){return Af()}function JD(){return Af()}function Af(){return new ac((t=>t.toString()),((t,e)=>t.isEqual(e)))}const r8=new ln(qe.comparator),i8=new $n(qe.comparator);function wt(...t){let e=i8;for(const n of t)e=e.add(n);return e}const a8=new $n(xt);function s8(){return a8}function cw(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Sm(e)?"-0":e}}function eI(t){return{integerValue:""+t}}function o8(t,e){return OU(e)?eI(e):cw(t,e)}class w0{constructor(){this._=void 0}}function l8(t,e,n){return t instanceof km?(function(i,a){const o={fields:{[jD]:{stringValue:PD},[zD]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&aw(a)&&(a=v0(a)),a&&(o.fields[VD]=a),{mapValue:o}})(n,e):t instanceof Cu?nI(t,e):t instanceof Qf?rI(t,e):(function(i,a){const o=tI(i,a),c=r2(o)+r2(i.Ae);return xx(o)&&xx(i.Ae)?eI(c):cw(i.serializer,c)})(t,e)}function c8(t,e,n){return t instanceof Cu?nI(t,e):t instanceof Qf?rI(t,e):n}function tI(t,e){return t instanceof Rm?(function(r){return xx(r)||(function(a){return!!a&&"doubleValue"in a})(r)})(e)?e:{integerValue:0}:null}class km extends w0{}class Cu extends w0{constructor(e){super(),this.elements=e}}function nI(t,e){const n=iI(e);for(const r of t.elements)n.some((i=>La(i,r)))||n.push(r);return{arrayValue:{values:n}}}class Qf extends w0{constructor(e){super(),this.elements=e}}function rI(t,e){let n=iI(e);for(const r of t.elements)n=n.filter((i=>!La(i,r)));return{arrayValue:{values:n}}}class Rm extends w0{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function r2(t){return xn(t.integerValue||t.doubleValue)}function iI(t){return sw(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class u8{constructor(e,n){this.field=e,this.transform=n}}function d8(t,e){return t.field.isEqual(e.field)&&(function(r,i){return r instanceof Cu&&i instanceof Cu||r instanceof Qf&&i instanceof Qf?Eu(r.elements,i.elements,La):r instanceof Rm&&i instanceof Rm?La(r.Ae,i.Ae):r instanceof km&&i instanceof km})(t.transform,e.transform)}class f8{constructor(e,n){this.version=e,this.transformResults=n}}class Sr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Sr}static exists(e){return new Sr(void 0,e)}static updateTime(e){return new Sr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Qg(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class _0{}function aI(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new S0(t.key,Sr.none()):new Sh(t.key,t.data,Sr.none());{const n=t.data,r=Or.empty();let i=new $n(nr.comparator);for(let a of e.fields)if(!i.has(a)){let o=n.field(a);o===null&&a.length>1&&(a=a.popLast(),o=n.field(a)),o===null?r.delete(a):r.set(a,o),i=i.add(a)}return new el(t.key,r,new ni(i.toArray()),Sr.none())}}function h8(t,e,n){t instanceof Sh?(function(i,a,o){const c=i.value.clone(),u=a2(i.fieldTransforms,a,o.transformResults);c.setAll(u),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(t,e,n):t instanceof el?(function(i,a,o){if(!Qg(i.precondition,a))return void a.convertToUnknownDocument(o.version);const c=a2(i.fieldTransforms,a,o.transformResults),u=a.data;u.setAll(sI(i)),u.setAll(c),a.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(t,e,n):(function(i,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,n)}function Cf(t,e,n,r){return t instanceof Sh?(function(a,o,c,u){if(!Qg(a.precondition,o))return c;const d=a.value.clone(),h=s2(a.fieldTransforms,u,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(t,e,n,r):t instanceof el?(function(a,o,c,u){if(!Qg(a.precondition,o))return c;const d=s2(a.fieldTransforms,u,o),h=o.data;return h.setAll(sI(a)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((p=>p.field)))})(t,e,n,r):(function(a,o,c){return Qg(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(t,e,n)}function p8(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),a=tI(r.transform,i||null);a!=null&&(n===null&&(n=Or.empty()),n.set(r.field,a))}return n||null}function i2(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Eu(r,i,((a,o)=>d8(a,o)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Sh extends _0{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class el extends _0{constructor(e,n,r,i,a=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function sI(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}})),e}function a2(t,e,n){const r=new Map;Mt(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const a=t[i],o=a.transform,c=e.data.field(a.field);r.set(a.field,c8(o,c,n[i]))}return r}function s2(t,e,n){const r=new Map;for(const i of t){const a=i.transform,o=n.data.field(i.field);r.set(i.field,l8(a,o,e))}return r}class S0 extends _0{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class g8 extends _0{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class m8{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&h8(a,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Cf(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Cf(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=JD();return this.mutations.forEach((i=>{const a=e.get(i.key),o=a.overlayedDocument;let c=this.applyToLocalView(o,a.mutatedFields);c=n.has(i.key)?null:c;const u=aI(o,c);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(nt.min())})),r}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),wt())}isEqual(e){return this.batchId===e.batchId&&Eu(this.mutations,e.mutations,((n,r)=>i2(n,r)))&&Eu(this.baseMutations,e.baseMutations,((n,r)=>i2(n,r)))}}class uw{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Mt(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return r8})();const a=e.mutations;for(let o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new uw(e,n,r,i)}}class v8{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class y8{constructor(e,n){this.count=e,this.unchangedNames=n}}var In,Et;function b8(t){switch(t){case be.OK:return Je(64938);case be.CANCELLED:case be.UNKNOWN:case be.DEADLINE_EXCEEDED:case be.RESOURCE_EXHAUSTED:case be.INTERNAL:case be.UNAVAILABLE:case be.UNAUTHENTICATED:return!1;case be.INVALID_ARGUMENT:case be.NOT_FOUND:case be.ALREADY_EXISTS:case be.PERMISSION_DENIED:case be.FAILED_PRECONDITION:case be.ABORTED:case be.OUT_OF_RANGE:case be.UNIMPLEMENTED:case be.DATA_LOSS:return!0;default:return Je(15467,{code:t})}}function oI(t){if(t===void 0)return Cs("GRPC error has no .code"),be.UNKNOWN;switch(t){case In.OK:return be.OK;case In.CANCELLED:return be.CANCELLED;case In.UNKNOWN:return be.UNKNOWN;case In.DEADLINE_EXCEEDED:return be.DEADLINE_EXCEEDED;case In.RESOURCE_EXHAUSTED:return be.RESOURCE_EXHAUSTED;case In.INTERNAL:return be.INTERNAL;case In.UNAVAILABLE:return be.UNAVAILABLE;case In.UNAUTHENTICATED:return be.UNAUTHENTICATED;case In.INVALID_ARGUMENT:return be.INVALID_ARGUMENT;case In.NOT_FOUND:return be.NOT_FOUND;case In.ALREADY_EXISTS:return be.ALREADY_EXISTS;case In.PERMISSION_DENIED:return be.PERMISSION_DENIED;case In.FAILED_PRECONDITION:return be.FAILED_PRECONDITION;case In.ABORTED:return be.ABORTED;case In.OUT_OF_RANGE:return be.OUT_OF_RANGE;case In.UNIMPLEMENTED:return be.UNIMPLEMENTED;case In.DATA_LOSS:return be.DATA_LOSS;default:return Je(39323,{code:t})}}(Et=In||(In={}))[Et.OK=0]="OK",Et[Et.CANCELLED=1]="CANCELLED",Et[Et.UNKNOWN=2]="UNKNOWN",Et[Et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Et[Et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Et[Et.NOT_FOUND=5]="NOT_FOUND",Et[Et.ALREADY_EXISTS=6]="ALREADY_EXISTS",Et[Et.PERMISSION_DENIED=7]="PERMISSION_DENIED",Et[Et.UNAUTHENTICATED=16]="UNAUTHENTICATED",Et[Et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Et[Et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Et[Et.ABORTED=10]="ABORTED",Et[Et.OUT_OF_RANGE=11]="OUT_OF_RANGE",Et[Et.UNIMPLEMENTED=12]="UNIMPLEMENTED",Et[Et.INTERNAL=13]="INTERNAL",Et[Et.UNAVAILABLE=14]="UNAVAILABLE",Et[Et.DATA_LOSS=15]="DATA_LOSS";function x8(){return new TextEncoder}const w8=new Io([4294967295,4294967295],0);function o2(t){const e=x8().encode(t),n=new _D;return n.update(e),new Uint8Array(n.digest())}function l2(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Io([n,r],0),new Io([i,a],0)]}class dw{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new gf(`Invalid padding: ${n}`);if(r<0)throw new gf(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new gf(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new gf(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Io.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(Io.fromNumber(r)));return i.compare(w8)===1&&(i=new Io([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=o2(e),[r,i]=l2(n);for(let a=0;a<this.hashCount;a++){const o=this.ye(r,i,a);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new dw(a,i,n);return r.forEach((c=>o.insert(c))),o}insert(e){if(this.ge===0)return;const n=o2(e),[r,i]=l2(n);for(let a=0;a<this.hashCount;a++){const o=this.ye(r,i,a);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class gf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class E0{constructor(e,n,r,i,a){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Eh.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new E0(nt.min(),i,new ln(xt),ks(),wt())}}class Eh{constructor(e,n,r,i,a){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Eh(r,n,wt(),wt(),wt())}}class Zg{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class lI{constructor(e,n){this.targetId=e,this.Ce=n}}class cI{constructor(e,n,r=ir.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class c2{constructor(){this.ve=0,this.Fe=u2(),this.Me=ir.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=wt(),n=wt(),r=wt();return this.Fe.forEach(((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Je(38017,{changeType:a})}})),new Eh(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=u2()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Mt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class _8{constructor(e){this.Ge=e,this.ze=new Map,this.je=ks(),this.Je=wg(),this.He=wg(),this.Ye=new ln(xt)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:Je(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((r,i)=>{this.rt(i)&&n(i)}))}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const a=i.target;if(_x(a))if(r===0){const o=new qe(a.path);this.et(n,o,cr.newNoDocument(o,nt.min()))}else Mt(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:a=0}=n;let o,c;try{o=Bo(r).toUint8Array()}catch(u){if(u instanceof OD)return Su("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new dw(o,i,a)}catch(u){return Su(u instanceof gf?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach((a=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.et(n,a,null),i++)})),i}Tt(e){const n=new Map;this.ze.forEach(((a,o)=>{const c=this.ot(o);if(c){if(a.current&&_x(c.target)){const u=new qe(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,cr.newNoDocument(u,e))}a.Be&&(n.set(o,a.ke()),a.qe())}}));let r=wt();this.He.forEach(((a,o)=>{let c=!0;o.forEachWhile((u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(a))})),this.je.forEach(((a,o)=>o.setReadTime(e)));const i=new E0(e,n,this.Ye,this.je,r);return this.je=ks(),this.Je=wg(),this.He=wg(),this.Ye=new ln(xt),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new c2,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new $n(xt),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new $n(xt),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Pe("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new c2),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function wg(){return new ln(qe.comparator)}function u2(){return new ln(qe.comparator)}const S8={asc:"ASCENDING",desc:"DESCENDING"},E8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},T8={and:"AND",or:"OR"};class A8{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Ex(t,e){return t.useProto3Json||m0(e)?e:{value:e}}function Nm(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function uI(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function C8(t,e){return Nm(t,e.toTimestamp())}function Ma(t){return Mt(!!t,49232),nt.fromTimestamp((function(n){const r=Lo(n);return new mt(r.seconds,r.nanos)})(t))}function fw(t,e){return Tx(t,e).canonicalString()}function Tx(t,e){const n=(function(i){return new Yt(["projects",i.projectId,"databases",i.database])})(t).child("documents");return e===void 0?n:n.child(e)}function dI(t){const e=Yt.fromString(t);return Mt(mI(e),10190,{key:e.toString()}),e}function Ax(t,e){return fw(t.databaseId,e.path)}function vb(t,e){const n=dI(e);if(n.get(1)!==t.databaseId.projectId)throw new De(be.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new De(be.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new qe(hI(n))}function fI(t,e){return fw(t.databaseId,e)}function k8(t){const e=dI(t);return e.length===4?Yt.emptyPath():hI(e)}function Cx(t){return new Yt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function hI(t){return Mt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function d2(t,e,n){return{name:Ax(t,e),fields:n.value.mapValue.fields}}function R8(t,e){let n;if("targetChange"in e){e.targetChange;const r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Je(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=(function(d,h){return d.useProto3Json?(Mt(h===void 0||typeof h=="string",58123),ir.fromBase64String(h||"")):(Mt(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),ir.fromUint8Array(h||new Uint8Array))})(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(d){const h=d.code===void 0?be.UNKNOWN:oI(d.code);return new De(h,d.message||"")})(o);n=new cI(r,i,a,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=vb(t,r.document.name),a=Ma(r.document.updateTime),o=r.document.createTime?Ma(r.document.createTime):nt.min(),c=new Or({mapValue:{fields:r.document.fields}}),u=cr.newFoundDocument(i,a,o,c),d=r.targetIds||[],h=r.removedTargetIds||[];n=new Zg(d,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=vb(t,r.document),a=r.readTime?Ma(r.readTime):nt.min(),o=cr.newNoDocument(i,a),c=r.removedTargetIds||[];n=new Zg([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=vb(t,r.document),a=r.removedTargetIds||[];n=new Zg([],a,i,null)}else{if(!("filter"in e))return Je(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:a}=r,o=new y8(i,a),c=r.targetId;n=new lI(c,o)}}return n}function N8(t,e){let n;if(e instanceof Sh)n={update:d2(t,e.key,e.value)};else if(e instanceof S0)n={delete:Ax(t,e.key)};else if(e instanceof el)n={update:d2(t,e.key,e.data),updateMask:L8(e.fieldMask)};else{if(!(e instanceof g8))return Je(16599,{Vt:e.type});n={verify:Ax(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((r=>(function(a,o){const c=o.transform;if(c instanceof km)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Cu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Qf)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Rm)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw Je(20930,{transform:o.transform})})(0,r)))),e.precondition.isNone||(n.currentDocument=(function(i,a){return a.updateTime!==void 0?{updateTime:C8(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Je(27497)})(t,e.precondition)),n}function D8(t,e){return t&&t.length>0?(Mt(e!==void 0,14353),t.map((n=>(function(i,a){let o=i.updateTime?Ma(i.updateTime):Ma(a);return o.isEqual(nt.min())&&(o=Ma(a)),new f8(o,i.transformResults||[])})(n,e)))):[]}function I8(t,e){return{documents:[fI(t,e.path)]}}function M8(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=fI(t,i);const a=(function(d){if(d.length!==0)return gI(Zi.create(d,"and"))})(e.filters);a&&(n.structuredQuery.where=a);const o=(function(d){if(d.length!==0)return d.map((h=>(function(m){return{field:eu(m.field),direction:j8(m.dir)}})(h)))})(e.orderBy);o&&(n.structuredQuery.orderBy=o);const c=Ex(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:n,parent:i}}function O8(t){let e=k8(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Mt(r===1,65062);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let a=[];n.where&&(a=(function(p){const m=pI(p);return m instanceof Zi&&GD(m)?m.getFilters():[m]})(n.where));let o=[];n.orderBy&&(o=(function(p){return p.map((m=>(function(w){return new Kf(tu(w.field),(function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(w.direction))})(m)))})(n.orderBy));let c=null;n.limit&&(c=(function(p){let m;return m=typeof p=="object"?p.value:p,m0(m)?null:m})(n.limit));let u=null;n.startAt&&(u=(function(p){const m=!!p.before,b=p.values||[];return new Am(b,m)})(n.startAt));let d=null;return n.endAt&&(d=(function(p){const m=!p.before,b=p.values||[];return new Am(b,m)})(n.endAt)),ZU(e,i,o,a,c,"F",u,d)}function P8(t,e){const n=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Je(28987,{purpose:i})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function pI(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=tu(n.unaryFilter.field);return On.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=tu(n.unaryFilter.field);return On.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=tu(n.unaryFilter.field);return On.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=tu(n.unaryFilter.field);return On.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Je(61313);default:return Je(60726)}})(t):t.fieldFilter!==void 0?(function(n){return On.create(tu(n.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Je(58110);default:return Je(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return Zi.create(n.compositeFilter.filters.map((r=>pI(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Je(1026)}})(n.compositeFilter.op))})(t):Je(30097,{filter:t})}function j8(t){return S8[t]}function V8(t){return E8[t]}function z8(t){return T8[t]}function eu(t){return{fieldPath:t.canonicalString()}}function tu(t){return nr.fromServerFormat(t.fieldPath)}function gI(t){return t instanceof On?(function(n){if(n.op==="=="){if(ZC(n.value))return{unaryFilter:{field:eu(n.field),op:"IS_NAN"}};if(QC(n.value))return{unaryFilter:{field:eu(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(ZC(n.value))return{unaryFilter:{field:eu(n.field),op:"IS_NOT_NAN"}};if(QC(n.value))return{unaryFilter:{field:eu(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:eu(n.field),op:V8(n.op),value:n.value}}})(t):t instanceof Zi?(function(n){const r=n.getFilters().map((i=>gI(i)));return r.length===1?r[0]:{compositeFilter:{op:z8(n.op),filters:r}}})(t):Je(54877,{filter:t})}function L8(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function mI(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Eo{constructor(e,n,r,i,a=nt.min(),o=nt.min(),c=ir.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Eo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Eo(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Eo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Eo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class B8{constructor(e){this.yt=e}}function U8(t){const e=O8({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Cm(e,e.limit,"L"):e}class F8{constructor(){this.Cn=new $8}addToCollectionParentIndex(e,n){return this.Cn.add(n),_e.resolve()}getCollectionParents(e,n){return _e.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return _e.resolve()}deleteFieldIndex(e,n){return _e.resolve()}deleteAllFieldIndexes(e){return _e.resolve()}createTargetIndexes(e,n){return _e.resolve()}getDocumentsMatchingTarget(e,n){return _e.resolve(null)}getIndexType(e,n){return _e.resolve(0)}getFieldIndexes(e,n){return _e.resolve([])}getNextCollectionGroupToUpdate(e){return _e.resolve(null)}getMinOffset(e,n){return _e.resolve(zo.min())}getMinOffsetFromCollectionGroup(e,n){return _e.resolve(zo.min())}updateCollectionGroup(e,n,r){return _e.resolve()}updateIndexEntries(e,n){return _e.resolve()}}class $8{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new $n(Yt.comparator),a=!i.has(r);return this.index[n]=i.add(r),a}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new $n(Yt.comparator)).toArray()}}const f2={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},vI=41943040;class Mr{static withCacheSize(e){return new Mr(e,Mr.DEFAULT_COLLECTION_PERCENTILE,Mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}Mr.DEFAULT_COLLECTION_PERCENTILE=10,Mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Mr.DEFAULT=new Mr(vI,Mr.DEFAULT_COLLECTION_PERCENTILE,Mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Mr.DISABLED=new Mr(-1,0,0);class ku{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ku(0)}static cr(){return new ku(-1)}}const h2="LruGarbageCollector",G8=1048576;function p2([t,e],[n,r]){const i=xt(t,n);return i===0?xt(e,r):i}class H8{constructor(e){this.Ir=e,this.buffer=new $n(p2),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();p2(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class q8{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Pe(h2,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){qu(n)?Pe(h2,"Ignoring IndexedDB error during garbage collection: ",n):await Hu(n)}await this.Vr(3e5)}))}}class Y8{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((r=>Math.floor(n/100*r)))}nthSequenceNumber(e,n){if(n===0)return _e.resolve(g0.ce);const r=new H8(n);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Pe("LruGarbageCollector","Garbage collection skipped; disabled"),_e.resolve(f2)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),f2):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,a,o,c,u,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(Pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i)))).next((p=>(r=p,c=Date.now(),this.removeTargets(e,r,n)))).next((p=>(a=p,u=Date.now(),this.removeOrphanedDocuments(e,r)))).next((p=>(d=Date.now(),Zc()<=bt.DEBUG&&Pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${a} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(d-u)+`ms
Total Duration: ${d-h}ms`),_e.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:p}))))}}function X8(t,e){return new Y8(t,e)}class W8{constructor(){this.changes=new ac((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,cr.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?_e.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class K8{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class Q8{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,n)))).next((i=>(r!==null&&Cf(r.mutation,i,ni.empty(),mt.now()),i)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.getLocalViewOfDocuments(e,r,wt()).next((()=>r))))}getLocalViewOfDocuments(e,n,r=wt()){const i=Ll();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,r).next((a=>{let o=pf();return a.forEach(((c,u)=>{o=o.insert(c,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,n){const r=Ll();return this.populateOverlays(e,r,n).next((()=>this.computeViews(e,n,r,wt())))}populateOverlays(e,n,r){const i=[];return r.forEach((a=>{n.has(a)||i.push(a)})),this.documentOverlayCache.getOverlays(e,i).next((a=>{a.forEach(((o,c)=>{n.set(o,c)}))}))}computeViews(e,n,r,i){let a=ks();const o=Af(),c=(function(){return Af()})();return n.forEach(((u,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof el)?a=a.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Cf(h.mutation,d,h.mutation.getFieldMask(),mt.now())):o.set(d.key,ni.empty())})),this.recalculateAndSaveOverlays(e,a).next((u=>(u.forEach(((d,h)=>o.set(d,h))),n.forEach(((d,h)=>c.set(d,new K8(h,o.get(d)??null)))),c)))}recalculateAndSaveOverlays(e,n){const r=Af();let i=new ln(((o,c)=>o-c)),a=wt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((o=>{for(const c of o)c.keys().forEach((u=>{const d=n.get(u);if(d===null)return;let h=r.get(u)||ni.empty();h=c.applyToLocalView(d,h),r.set(u,h);const p=(i.get(c.batchId)||wt()).add(u);i=i.insert(c.batchId,p)}))})).next((()=>{const o=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,h=u.value,p=JD();h.forEach((m=>{if(!a.has(m)){const b=aI(n.get(m),r.get(m));b!==null&&p.set(m,b),a=a.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return _e.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,n,r,i){return(function(o){return qe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):XD(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next((a=>{const o=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-a.size):_e.resolve(Ll());let c=qf,u=a;return o.next((d=>_e.forEach(d,((h,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),a.get(h)?_e.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{u=u.insert(h,m)}))))).next((()=>this.populateOverlays(e,d,a))).next((()=>this.computeViews(e,u,d,wt()))).next((h=>({batchId:c,changes:ZD(h)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new qe(n)).next((r=>{let i=pf();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const a=n.collectionGroup;let o=pf();return this.indexManager.getCollectionParents(e,a).next((c=>_e.forEach(c,(u=>{const d=(function(p,m){return new Yu(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(n,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next((h=>{h.forEach(((p,m)=>{o=o.insert(p,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,n,r,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next((o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,a,i)))).next((o=>{a.forEach(((u,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,cr.newInvalidDocument(h)))}));let c=pf();return o.forEach(((u,d)=>{const h=a.get(u);h!==void 0&&Cf(h.mutation,d,ni.empty(),mt.now()),x0(n,d)&&(c=c.insert(u,d))})),c}))}}class Z8{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return _e.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(i){return{id:i.id,version:i.version,createTime:Ma(i.createTime)}})(n)),_e.resolve()}getNamedQuery(e,n){return _e.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(i){return{name:i.name,query:U8(i.bundledQuery),readTime:Ma(i.readTime)}})(n)),_e.resolve()}}class J8{constructor(){this.overlays=new ln(qe.comparator),this.qr=new Map}getOverlay(e,n){return _e.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ll();return _e.forEach(n,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,n,r){return r.forEach(((i,a)=>{this.St(e,n,a)})),_e.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(r)),_e.resolve()}getOverlaysForCollection(e,n,r){const i=Ll(),a=n.length+1,o=new qe(n.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===a&&u.largestBatchId>r&&i.set(u.getKey(),u)}return _e.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let a=new ln(((d,h)=>d-h));const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=a.get(d.largestBatchId);h===null&&(h=Ll(),a=a.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const c=Ll(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((d,h)=>c.set(d,h))),!(c.size()>=i)););return _e.resolve(c)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new v8(n,r));let a=this.qr.get(n);a===void 0&&(a=wt(),this.qr.set(n,a)),this.qr.set(n,a.add(r.key))}}class eF{constructor(){this.sessionToken=ir.EMPTY_BYTE_STRING}getSessionToken(e){return _e.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,_e.resolve()}}class hw{constructor(){this.Qr=new $n(Yn.$r),this.Ur=new $n(Yn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Yn(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach((r=>this.addReference(r,n)))}removeReference(e,n){this.Gr(new Yn(e,n))}zr(e,n){e.forEach((r=>this.removeReference(r,n)))}jr(e){const n=new qe(new Yt([])),r=new Yn(n,e),i=new Yn(n,e+1),a=[];return this.Ur.forEachInRange([r,i],(o=>{this.Gr(o),a.push(o.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new qe(new Yt([])),r=new Yn(n,e),i=new Yn(n,e+1);let a=wt();return this.Ur.forEachInRange([r,i],(o=>{a=a.add(o.key)})),a}containsKey(e){const n=new Yn(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Yn{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return qe.comparator(e.key,n.key)||xt(e.Yr,n.Yr)}static Kr(e,n){return xt(e.Yr,n.Yr)||qe.comparator(e.key,n.key)}}class tF{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new $n(Yn.$r)}checkEmpty(e){return _e.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new m8(a,n,r,i);this.mutationQueue.push(o);for(const c of i)this.Zr=this.Zr.add(new Yn(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return _e.resolve(o)}lookupMutationBatch(e,n){return _e.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),a=i<0?0:i;return _e.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return _e.resolve(this.mutationQueue.length===0?iw:this.tr-1)}getAllMutationBatches(e){return _e.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Yn(n,0),i=new Yn(n,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([r,i],(o=>{const c=this.Xr(o.Yr);a.push(c)})),_e.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new $n(xt);return n.forEach((i=>{const a=new Yn(i,0),o=new Yn(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,o],(c=>{r=r.add(c.Yr)}))})),_e.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let a=r;qe.isDocumentKey(a)||(a=a.child(""));const o=new Yn(new qe(a),0);let c=new $n(xt);return this.Zr.forEachWhile((u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(c=c.add(u.Yr)),!0)}),o),_e.resolve(this.ti(c))}ti(e){const n=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&n.push(i)})),n}removeMutationBatch(e,n){Mt(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return _e.forEach(n.mutations,(i=>{const a=new Yn(i.key,n.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,n){const r=new Yn(n,0),i=this.Zr.firstAfterOrEqual(r);return _e.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,_e.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class nF{constructor(e){this.ri=e,this.docs=(function(){return new ln(qe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),a=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return _e.resolve(r?r.document.mutableCopy():cr.newInvalidDocument(n))}getEntries(e,n){let r=ks();return n.forEach((i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():cr.newInvalidDocument(i))})),_e.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let a=ks();const o=n.path,c=new qe(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:h}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||NU(RU(h),r)<=0||(i.has(h.key)||x0(n,h))&&(a=a.insert(h.key,h.mutableCopy()))}return _e.resolve(a)}getAllFromCollectionGroup(e,n,r,i){Je(9500)}ii(e,n){return _e.forEach(this.docs,(r=>n(r)))}newChangeBuffer(e){return new rF(this)}getSize(e){return _e.resolve(this.size)}}class rF extends W8{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),_e.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class iF{constructor(e){this.persistence=e,this.si=new ac((n=>ow(n)),lw),this.lastRemoteSnapshotVersion=nt.min(),this.highestTargetId=0,this.oi=0,this._i=new hw,this.targetCount=0,this.ai=ku.ur()}forEachTarget(e,n){return this.si.forEach(((r,i)=>n(i))),_e.resolve()}getLastRemoteSnapshotVersion(e){return _e.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return _e.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),_e.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),_e.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new ku(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,_e.resolve()}updateTargetData(e,n){return this.Pr(n),_e.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,_e.resolve()}removeTargets(e,n,r){let i=0;const a=[];return this.si.forEach(((o,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.si.delete(o),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)})),_e.waitFor(a).next((()=>i))}getTargetCount(e){return _e.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return _e.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),_e.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,a=[];return i&&n.forEach((o=>{a.push(i.markPotentiallyOrphaned(e,o))})),_e.waitFor(a)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),_e.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return _e.resolve(r)}containsKey(e,n){return _e.resolve(this._i.containsKey(n))}}class yI{constructor(e,n){this.ui={},this.overlays={},this.ci=new g0(0),this.li=!1,this.li=!0,this.hi=new eF,this.referenceDelegate=e(this),this.Pi=new iF(this),this.indexManager=new F8,this.remoteDocumentCache=(function(i){return new nF(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new B8(n),this.Ii=new Z8(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new J8,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new tF(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){Pe("MemoryPersistence","Starting transaction:",e);const i=new aF(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((a=>this.referenceDelegate.di(i).next((()=>a)))).toPromise().then((a=>(i.raiseOnCommittedEvent(),a)))}Ai(e,n){return _e.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,n))))}}class aF extends IU{constructor(e){super(),this.currentSequenceNumber=e}}class pw{constructor(e){this.persistence=e,this.Ri=new hw,this.Vi=null}static mi(e){return new pw(e)}get fi(){if(this.Vi)return this.Vi;throw Je(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),_e.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),_e.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),_e.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next((i=>{i.forEach((a=>this.fi.add(a.toString())))})).next((()=>r.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _e.forEach(this.fi,(r=>{const i=qe.fromPath(r);return this.gi(e,i).next((a=>{a||n.removeEntry(i,nt.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return _e.or([()=>_e.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Dm{constructor(e,n){this.persistence=e,this.pi=new ac((r=>PU(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=X8(this,n)}static mi(e,n){return new Dm(e,n)}Ei(){}di(e){return _e.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>n.next((i=>r+i))))}wr(e){let n=0;return this.pr(e,(r=>{n++})).next((()=>n))}pr(e,n){return _e.forEach(this.pi,((r,i)=>this.br(e,r,i).next((a=>a?_e.resolve():n(i)))))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,(o=>this.br(e,o,n).next((c=>{c||(r++,a.removeEntry(o,nt.min()))})))).next((()=>a.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),_e.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),_e.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),_e.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),_e.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Wg(e.data.value)),n}br(e,n,r){return _e.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return _e.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class gw{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=wt(),i=wt();for(const a of n.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new gw(e,n.fromCache,r,i)}}class sF{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class oF{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return d5()?8:MU(dr())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const a={result:null};return this.ys(e,n).next((o=>{a.result=o})).next((()=>{if(!a.result)return this.ws(e,n,i,r).next((o=>{a.result=o}))})).next((()=>{if(a.result)return;const o=new sF;return this.Ss(e,n,o).next((c=>{if(a.result=c,this.Vs)return this.bs(e,n,o,c.size)}))})).next((()=>a.result))}bs(e,n,r,i){return r.documentReadCount<this.fs?(Zc()<=bt.DEBUG&&Pe("QueryEngine","SDK will not create cache indexes for query:",Jc(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),_e.resolve()):(Zc()<=bt.DEBUG&&Pe("QueryEngine","Query:",Jc(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Zc()<=bt.DEBUG&&Pe("QueryEngine","The SDK decides to create cache indexes for query:",Jc(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ia(n))):_e.resolve())}ys(e,n){if(n2(n))return _e.resolve(null);let r=Ia(n);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(n.limit!==null&&i===1&&(n=Cm(n,null,"F"),r=Ia(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next((a=>{const o=wt(...a);return this.ps.getDocuments(e,o).next((c=>this.indexManager.getMinOffset(e,r).next((u=>{const d=this.Ds(n,c);return this.Cs(n,d,o,u.readTime)?this.ys(e,Cm(n,null,"F")):this.vs(e,d,n,u)}))))})))))}ws(e,n,r,i){return n2(n)||i.isEqual(nt.min())?_e.resolve(null):this.ps.getDocuments(e,r).next((a=>{const o=this.Ds(n,a);return this.Cs(n,o,r,i)?_e.resolve(null):(Zc()<=bt.DEBUG&&Pe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Jc(n)),this.vs(e,o,n,kU(i,qf)).next((c=>c)))}))}Ds(e,n){let r=new $n(KD(e));return n.forEach(((i,a)=>{x0(e,a)&&(r=r.add(a))})),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const a=e.limitType==="F"?n.last():n.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,n,r){return Zc()<=bt.DEBUG&&Pe("QueryEngine","Using full collection scan to execute query:",Jc(n)),this.ps.getDocumentsMatchingQuery(e,n,zo.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((a=>(n.forEach((o=>{a=a.insert(o.key,o)})),a)))}}const mw="LocalStore",lF=3e8;class cF{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new ln(xt),this.xs=new ac((a=>ow(a)),lw),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Q8(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function uF(t,e,n,r){return new cF(t,e,n,r)}async function bI(t,e){const n=at(t);return await n.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next((a=>(i=a,n.Bs(e),n.mutationQueue.getAllMutationBatches(r)))).next((a=>{const o=[],c=[];let u=wt();for(const d of i){o.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}for(const d of a){c.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}return n.localDocuments.getDocuments(r,u).next((d=>({Ls:d,removedBatchIds:o,addedBatchIds:c})))}))}))}function dF(t,e){const n=at(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),a=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,u,d,h){const p=d.batch,m=p.keys();let b=_e.resolve();return m.forEach((w=>{b=b.next((()=>h.getEntry(u,w))).next((S=>{const E=d.docVersions.get(w);Mt(E!==null,48541),S.version.compareTo(E)<0&&(p.applyToRemoteDocument(S,d),S.isValidDocument()&&(S.setReadTime(d.commitVersion),h.addEntry(S)))}))})),b.next((()=>c.mutationQueue.removeMutationBatch(u,p)))})(n,r,e,a).next((()=>a.apply(r))).next((()=>n.mutationQueue.performConsistencyCheck(r))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let u=wt();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u})(e)))).next((()=>n.localDocuments.getDocuments(r,i)))}))}function xI(t){const e=at(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function fF(t,e){const n=at(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const c=[];e.targetChanges.forEach(((h,p)=>{const m=i.get(p);if(!m)return;c.push(n.Pi.removeMatchingKeys(a,h.removedDocuments,p).next((()=>n.Pi.addMatchingKeys(a,h.addedDocuments,p))));let b=m.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(p)!==null?b=b.withResumeToken(ir.EMPTY_BYTE_STRING,nt.min()).withLastLimboFreeSnapshotVersion(nt.min()):h.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(h.resumeToken,r)),i=i.insert(p,b),(function(S,E,T){return S.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=lF?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(m,b,h)&&c.push(n.Pi.updateTargetData(a,b))}));let u=ks(),d=wt();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(a,h))})),c.push(hF(a,o,e.documentUpdates).next((h=>{u=h.ks,d=h.qs}))),!r.isEqual(nt.min())){const h=n.Pi.getLastRemoteSnapshotVersion(a).next((p=>n.Pi.setTargetsMetadata(a,a.currentSequenceNumber,r)));c.push(h)}return _e.waitFor(c).next((()=>o.apply(a))).next((()=>n.localDocuments.getLocalViewOfDocuments(a,u,d))).next((()=>u))})).then((a=>(n.Ms=i,a)))}function hF(t,e,n){let r=wt(),i=wt();return n.forEach((a=>r=r.add(a))),e.getEntries(t,r).next((a=>{let o=ks();return n.forEach(((c,u)=>{const d=a.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(nt.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):Pe(mw,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)})),{ks:o,qs:i}}))}function pF(t,e){const n=at(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=iw),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function gF(t,e){const n=at(t);return n.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return n.Pi.getTargetData(r,e).next((a=>a?(i=a,_e.resolve(i)):n.Pi.allocateTargetId(r).next((o=>(i=new Eo(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r}))}async function kx(t,e,n){const r=at(t),i=r.Ms.get(e),a=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",a,(o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!qu(o))throw o;Pe(mw,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function g2(t,e,n){const r=at(t);let i=nt.min(),a=wt();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(u,d,h){const p=at(u),m=p.xs.get(h);return m!==void 0?_e.resolve(p.Ms.get(m)):p.Pi.getTargetData(d,h)})(r,o,Ia(e)).next((c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,c.targetId).next((u=>{a=u}))})).next((()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:nt.min(),n?a:wt()))).next((c=>(mF(r,e8(e),c),{documents:c,Qs:a})))))}function mF(t,e,n){let r=t.Os.get(e)||nt.min();n.forEach(((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)})),t.Os.set(e,r)}class m2{constructor(){this.activeTargetIds=s8()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class vF{constructor(){this.Mo=new m2,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new m2,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class yF{Oo(e){}shutdown(){}}const v2="ConnectivityMonitor";class y2{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Pe(v2,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Pe(v2,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let _g=null;function Rx(){return _g===null?_g=(function(){return 268435456+Math.round(2147483648*Math.random())})():_g++,"0x"+_g.toString(16)}const yb="RestConnection",bF={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class xF{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===Em?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,a){const o=Rx(),c=this.zo(e,n.toUriEncodedString());Pe(yb,`Sending RPC '${e}' ${o}:`,c,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,a);const{host:d}=new URL(c),h=Qo(d);return this.Jo(e,c,u,r,h).then((p=>(Pe(yb,`Received RPC '${e}' ${o}: `,p),p)),(p=>{throw Su(yb,`RPC '${e}' ${o} failed with error: `,p,"url: ",c,"request:",r),p}))}Ho(e,n,r,i,a,o){return this.Go(e,n,r,i,a)}jo(e,n,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Gu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((i,a)=>e[a]=i)),r&&r.headers.forEach(((i,a)=>e[a]=i))}zo(e,n){const r=bF[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}class wF{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const or="WebChannelConnection";class _F extends xF{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,a){const o=Rx();return new Promise(((c,u)=>{const d=new SD;d.setWithCredentials(!0),d.listenOnce(ED.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case Xg.NO_ERROR:const p=d.getResponseJson();Pe(or,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),c(p);break;case Xg.TIMEOUT:Pe(or,`RPC '${e}' ${o} timed out`),u(new De(be.DEADLINE_EXCEEDED,"Request time out"));break;case Xg.HTTP_ERROR:const m=d.getStatus();if(Pe(or,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let b=d.getResponseJson();Array.isArray(b)&&(b=b[0]);const w=b?.error;if(w&&w.status&&w.message){const S=(function(T){const C=T.toLowerCase().replace(/_/g,"-");return Object.values(be).indexOf(C)>=0?C:be.UNKNOWN})(w.status);u(new De(S,w.message))}else u(new De(be.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new De(be.UNAVAILABLE,"Connection failed."));break;default:Je(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Pe(or,`RPC '${e}' ${o} completed.`)}}));const h=JSON.stringify(i);Pe(or,`RPC '${e}' ${o} sending request:`,i),d.send(n,"POST",h,r,15)}))}T_(e,n,r){const i=Rx(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=CD(),c=AD(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const h=a.join("");Pe(or,`Creating RPC '${e}' stream ${i}: ${h}`,u);const p=o.createWebChannel(h,u);this.I_(p);let m=!1,b=!1;const w=new wF({Yo:E=>{b?Pe(or,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(m||(Pe(or,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),Pe(or,`RPC '${e}' stream ${i} sending:`,E),p.send(E))},Zo:()=>p.close()}),S=(E,T,C)=>{E.listen(T,(N=>{try{C(N)}catch(j){setTimeout((()=>{throw j}),0)}}))};return S(p,hf.EventType.OPEN,(()=>{b||(Pe(or,`RPC '${e}' stream ${i} transport opened.`),w.o_())})),S(p,hf.EventType.CLOSE,(()=>{b||(b=!0,Pe(or,`RPC '${e}' stream ${i} transport closed`),w.a_(),this.E_(p))})),S(p,hf.EventType.ERROR,(E=>{b||(b=!0,Su(or,`RPC '${e}' stream ${i} transport errored. Name:`,E.name,"Message:",E.message),w.a_(new De(be.UNAVAILABLE,"The operation could not be completed")))})),S(p,hf.EventType.MESSAGE,(E=>{if(!b){const T=E.data[0];Mt(!!T,16349);const C=T,N=C?.error||C[0]?.error;if(N){Pe(or,`RPC '${e}' stream ${i} received error:`,N);const j=N.status;let O=(function(k){const D=In[k];if(D!==void 0)return oI(D)})(j),M=N.message;O===void 0&&(O=be.INTERNAL,M="Unknown error status: "+j+" with message "+N.message),b=!0,w.a_(new De(O,M)),p.close()}else Pe(or,`RPC '${e}' stream ${i} received:`,T),w.u_(T)}})),S(c,TD.STAT_EVENT,(E=>{E.stat===vx.PROXY?Pe(or,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===vx.NOPROXY&&Pe(or,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{w.__()}),0),w}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function bb(){return typeof document<"u"?document:null}function T0(t){return new A8(t,!0)}class wI{constructor(e,n,r=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&Pe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const b2="PersistentStream";class _I{constructor(e,n,r,i,a,o,c,u){this.Mi=e,this.S_=r,this.b_=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new wI(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===be.RESOURCE_EXHAUSTED?(Cs(n.toString()),Cs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===be.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===n&&this.G_(r,i)}),(r=>{e((()=>{const i=new De(be.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Pe(b2,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(Pe(b2,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class SF extends _I{constructor(e,n,r,i,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=a}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=R8(this.serializer,e),r=(function(a){if(!("targetChange"in a))return nt.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?nt.min():o.readTime?Ma(o.readTime):nt.min()})(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Cx(this.serializer),n.addTarget=(function(a,o){let c;const u=o.target;if(c=_x(u)?{documents:I8(a,u)}:{query:M8(a,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=uI(a,o.resumeToken);const d=Ex(a,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(nt.min())>0){c.readTime=Nm(a,o.snapshotVersion.toTimestamp());const d=Ex(a,o.expectedCount);d!==null&&(c.expectedCount=d)}return c})(this.serializer,e);const r=P8(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Cx(this.serializer),n.removeTarget=e,this.q_(n)}}class EF extends _I{constructor(e,n,r,i,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Mt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Mt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Mt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=D8(e.writeResults,e.commitTime),r=Ma(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Cx(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((r=>N8(this.serializer,r)))};this.q_(n)}}class TF{}class AF extends TF{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new De(be.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Go(e,Tx(n,r),i,a,o))).catch((a=>{throw a.name==="FirebaseError"?(a.code===be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new De(be.UNKNOWN,a.toString())}))}Ho(e,n,r,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Ho(e,Tx(n,r),i,o,c,a))).catch((o=>{throw o.name==="FirebaseError"?(o.code===be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new De(be.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class CF{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Cs(n),this.aa=!1):Pe("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Zl="RemoteStore";class kF{constructor(e,n,r,i,a){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((o=>{r.enqueueAndForget((async()=>{sc(this)&&(Pe(Zl,"Restarting streams for network reachability change."),await(async function(u){const d=at(u);d.Ea.add(4),await Th(d),d.Ra.set("Unknown"),d.Ea.delete(4),await A0(d)})(this))}))})),this.Ra=new CF(r,i)}}async function A0(t){if(sc(t))for(const e of t.da)await e(!0)}async function Th(t){for(const e of t.da)await e(!1)}function SI(t,e){const n=at(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),xw(n)?bw(n):Xu(n).O_()&&yw(n,e))}function vw(t,e){const n=at(t),r=Xu(n);n.Ia.delete(e),r.O_()&&EI(n,e),n.Ia.size===0&&(r.O_()?r.L_():sc(n)&&n.Ra.set("Unknown"))}function yw(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(nt.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Xu(t).Y_(e)}function EI(t,e){t.Va.Ue(e),Xu(t).Z_(e)}function bw(t){t.Va=new _8({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Xu(t).start(),t.Ra.ua()}function xw(t){return sc(t)&&!Xu(t).x_()&&t.Ia.size>0}function sc(t){return at(t).Ea.size===0}function TI(t){t.Va=void 0}async function RF(t){t.Ra.set("Online")}async function NF(t){t.Ia.forEach(((e,n)=>{yw(t,e)}))}async function DF(t,e){TI(t),xw(t)?(t.Ra.ha(e),bw(t)):t.Ra.set("Unknown")}async function IF(t,e,n){if(t.Ra.set("Online"),e instanceof cI&&e.state===2&&e.cause)try{await(async function(i,a){const o=a.cause;for(const c of a.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.Ia.delete(c),i.Va.removeTarget(c))})(t,e)}catch(r){Pe(Zl,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Im(t,r)}else if(e instanceof Zg?t.Va.Ze(e):e instanceof lI?t.Va.st(e):t.Va.tt(e),!n.isEqual(nt.min()))try{const r=await xI(t.localStore);n.compareTo(r)>=0&&await(function(a,o){const c=a.Va.Tt(o);return c.targetChanges.forEach(((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const h=a.Ia.get(d);h&&a.Ia.set(d,h.withResumeToken(u.resumeToken,o))}})),c.targetMismatches.forEach(((u,d)=>{const h=a.Ia.get(u);if(!h)return;a.Ia.set(u,h.withResumeToken(ir.EMPTY_BYTE_STRING,h.snapshotVersion)),EI(a,u);const p=new Eo(h.target,u,d,h.sequenceNumber);yw(a,p)})),a.remoteSyncer.applyRemoteEvent(c)})(t,n)}catch(r){Pe(Zl,"Failed to raise snapshot:",r),await Im(t,r)}}async function Im(t,e,n){if(!qu(e))throw e;t.Ea.add(1),await Th(t),t.Ra.set("Offline"),n||(n=()=>xI(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Pe(Zl,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await A0(t)}))}function AI(t,e){return e().catch((n=>Im(t,n,e)))}async function C0(t){const e=at(t),n=Fo(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:iw;for(;MF(e);)try{const i=await pF(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,OF(e,i)}catch(i){await Im(e,i)}CI(e)&&kI(e)}function MF(t){return sc(t)&&t.Ta.length<10}function OF(t,e){t.Ta.push(e);const n=Fo(t);n.O_()&&n.X_&&n.ea(e.mutations)}function CI(t){return sc(t)&&!Fo(t).x_()&&t.Ta.length>0}function kI(t){Fo(t).start()}async function PF(t){Fo(t).ra()}async function jF(t){const e=Fo(t);for(const n of t.Ta)e.ea(n.mutations)}async function VF(t,e,n){const r=t.Ta.shift(),i=uw.from(r,e,n);await AI(t,(()=>t.remoteSyncer.applySuccessfulWrite(i))),await C0(t)}async function zF(t,e){e&&Fo(t).X_&&await(async function(r,i){if((function(o){return b8(o)&&o!==be.ABORTED})(i.code)){const a=r.Ta.shift();Fo(r).B_(),await AI(r,(()=>r.remoteSyncer.rejectFailedWrite(a.batchId,i))),await C0(r)}})(t,e),CI(t)&&kI(t)}async function x2(t,e){const n=at(t);n.asyncQueue.verifyOperationInProgress(),Pe(Zl,"RemoteStore received new credentials");const r=sc(n);n.Ea.add(3),await Th(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await A0(n)}async function LF(t,e){const n=at(t);e?(n.Ea.delete(2),await A0(n)):e||(n.Ea.add(2),await Th(n),n.Ra.set("Unknown"))}function Xu(t){return t.ma||(t.ma=(function(n,r,i){const a=at(n);return a.sa(),new SF(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(t.datastore,t.asyncQueue,{Xo:RF.bind(null,t),t_:NF.bind(null,t),r_:DF.bind(null,t),H_:IF.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),xw(t)?bw(t):t.Ra.set("Unknown")):(await t.ma.stop(),TI(t))}))),t.ma}function Fo(t){return t.fa||(t.fa=(function(n,r,i){const a=at(n);return a.sa(),new EF(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:PF.bind(null,t),r_:zF.bind(null,t),ta:jF.bind(null,t),na:VF.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await C0(t)):(await t.fa.stop(),t.Ta.length>0&&(Pe(Zl,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class ww{constructor(e,n,r,i,a){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new xs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,a){const o=Date.now()+r,c=new ww(e,n,o,i,a);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new De(be.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function _w(t,e){if(Cs("AsyncQueue",`${e}: ${t}`),qu(t))return new De(be.UNAVAILABLE,`${e}: ${t}`);throw t}class bu{static emptySet(e){return new bu(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||qe.comparator(n.key,r.key):(n,r)=>qe.comparator(n.key,r.key),this.keyedMap=pf(),this.sortedSet=new ln(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,r)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof bu)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new bu;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}class w2{constructor(){this.ga=new ln(qe.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Je(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,r)=>{e.push(r)})),e}}class Ru{constructor(e,n,r,i,a,o,c,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,i,a){const o=[];return n.forEach((c=>{o.push({type:0,doc:c})})),new Ru(e,n,bu.emptySet(n),o,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&b0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}class BF{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class UF{constructor(){this.queries=_2(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=at(n),a=i.queries;i.queries=_2(),a.forEach(((o,c)=>{for(const u of c.Sa)u.onError(r)}))})(this,new De(be.ABORTED,"Firestore shutting down"))}}function _2(){return new ac((t=>WD(t)),b0)}async function Sw(t,e){const n=at(t);let r=3;const i=e.query;let a=n.queries.get(i);a?!a.ba()&&e.Da()&&(r=2):(a=new BF,r=e.Da()?0:1);try{switch(r){case 0:a.wa=await n.onListen(i,!0);break;case 1:a.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const c=_w(o,`Initialization of query '${Jc(e.query)}' failed`);return void e.onError(c)}n.queries.set(i,a),a.Sa.push(e),e.va(n.onlineState),a.wa&&e.Fa(a.wa)&&Tw(n)}async function Ew(t,e){const n=at(t),r=e.query;let i=3;const a=n.queries.get(r);if(a){const o=a.Sa.indexOf(e);o>=0&&(a.Sa.splice(o,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function FF(t,e){const n=at(t);let r=!1;for(const i of e){const a=i.query,o=n.queries.get(a);if(o){for(const c of o.Sa)c.Fa(i)&&(r=!0);o.wa=i}}r&&Tw(n)}function $F(t,e,n){const r=at(t),i=r.queries.get(e);if(i)for(const a of i.Sa)a.onError(n);r.queries.delete(e)}function Tw(t){t.Ca.forEach((e=>{e.next()}))}var Nx,S2;(S2=Nx||(Nx={})).Ma="default",S2.Cache="cache";class Aw{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Ru(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ru.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Nx.Cache}}class RI{constructor(e){this.key=e}}class NI{constructor(e){this.key=e}}class GF{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=wt(),this.mutatedKeys=wt(),this.eu=KD(e),this.tu=new bu(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new w2,i=n?n.tu:this.tu;let a=n?n.mutatedKeys:this.mutatedKeys,o=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,p)=>{const m=i.get(h),b=x0(this.query,p)?p:null,w=!!m&&this.mutatedKeys.has(m.key),S=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let E=!1;m&&b?m.data.isEqual(b.data)?w!==S&&(r.track({type:3,doc:b}),E=!0):this.su(m,b)||(r.track({type:2,doc:b}),E=!0,(u&&this.eu(b,u)>0||d&&this.eu(b,d)<0)&&(c=!0)):!m&&b?(r.track({type:0,doc:b}),E=!0):m&&!b&&(r.track({type:1,doc:m}),E=!0,(u||d)&&(c=!0)),E&&(b?(o=o.add(b),a=S?a.add(h):a.delete(h)):(o=o.delete(h),a=a.delete(h)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),a=a.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:c,mutatedKeys:a}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((h,p)=>(function(b,w){const S=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Je(20277,{Rt:E})}};return S(b)-S(w)})(h.type,p.type)||this.eu(h.doc,p.doc))),this.ou(r),i=i??!1;const c=n&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,d=u!==this.Za;return this.Za=u,o.length!==0||d?{snapshot:new Ru(this.query,e.tu,a,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new w2,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=wt(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const n=[];return e.forEach((r=>{this.Xa.has(r)||n.push(new NI(r))})),this.Xa.forEach((r=>{e.has(r)||n.push(new RI(r))})),n}cu(e){this.Ya=e.Qs,this.Xa=wt();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ru.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Cw="SyncEngine";class HF{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class qF{constructor(e){this.key=e,this.hu=!1}}class YF{constructor(e,n,r,i,a,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ac((c=>WD(c)),b0),this.Iu=new Map,this.Eu=new Set,this.du=new ln(qe.comparator),this.Au=new Map,this.Ru=new hw,this.Vu={},this.mu=new Map,this.fu=ku.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function XF(t,e,n=!0){const r=jI(t);let i;const a=r.Tu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await DI(r,e,n,!0),i}async function WF(t,e){const n=jI(t);await DI(n,e,!0,!1)}async function DI(t,e,n,r){const i=await gF(t.localStore,Ia(e)),a=i.targetId,o=t.sharedClientState.addLocalQueryTarget(a,n);let c;return r&&(c=await KF(t,e,a,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&SI(t.remoteStore,i),c}async function KF(t,e,n,r,i){t.pu=(p,m,b)=>(async function(S,E,T,C){let N=E.view.ru(T);N.Cs&&(N=await g2(S.localStore,E.query,!1).then((({documents:A})=>E.view.ru(A,N))));const j=C&&C.targetChanges.get(E.targetId),O=C&&C.targetMismatches.get(E.targetId)!=null,M=E.view.applyChanges(N,S.isPrimaryClient,j,O);return T2(S,E.targetId,M.au),M.snapshot})(t,p,m,b);const a=await g2(t.localStore,e,!0),o=new GF(e,a.Qs),c=o.ru(a.documents),u=Eh.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),d=o.applyChanges(c,t.isPrimaryClient,u);T2(t,n,d.au);const h=new HF(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function QF(t,e,n){const r=at(t),i=r.Tu.get(e),a=r.Iu.get(i.targetId);if(a.length>1)return r.Iu.set(i.targetId,a.filter((o=>!b0(o,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await kx(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&vw(r.remoteStore,i.targetId),Dx(r,i.targetId)})).catch(Hu)):(Dx(r,i.targetId),await kx(r.localStore,i.targetId,!0))}async function ZF(t,e){const n=at(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),vw(n.remoteStore,r.targetId))}async function JF(t,e,n){const r=s7(t);try{const i=await(function(o,c){const u=at(o),d=mt.now(),h=c.reduce(((b,w)=>b.add(w.key)),wt());let p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",(b=>{let w=ks(),S=wt();return u.Ns.getEntries(b,h).next((E=>{w=E,w.forEach(((T,C)=>{C.isValidDocument()||(S=S.add(T))}))})).next((()=>u.localDocuments.getOverlayedDocuments(b,w))).next((E=>{p=E;const T=[];for(const C of c){const N=p8(C,p.get(C.key).overlayedDocument);N!=null&&T.push(new el(C.key,N,UD(N.value.mapValue),Sr.exists(!0)))}return u.mutationQueue.addMutationBatch(b,d,T,c)})).next((E=>{m=E;const T=E.applyToLocalDocumentSet(p,S);return u.documentOverlayCache.saveOverlays(b,E.batchId,T)}))})).then((()=>({batchId:m.batchId,changes:ZD(p)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,c,u){let d=o.Vu[o.currentUser.toKey()];d||(d=new ln(xt)),d=d.insert(c,u),o.Vu[o.currentUser.toKey()]=d})(r,i.batchId,n),await Ah(r,i.changes),await C0(r.remoteStore)}catch(i){const a=_w(i,"Failed to persist write");n.reject(a)}}async function II(t,e){const n=at(t);try{const r=await fF(n.localStore,e);e.targetChanges.forEach(((i,a)=>{const o=n.Au.get(a);o&&(Mt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?Mt(o.hu,14607):i.removedDocuments.size>0&&(Mt(o.hu,42227),o.hu=!1))})),await Ah(n,r,e)}catch(r){await Hu(r)}}function E2(t,e,n){const r=at(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach(((a,o)=>{const c=o.view.va(e);c.snapshot&&i.push(c.snapshot)})),(function(o,c){const u=at(o);u.onlineState=c;let d=!1;u.queries.forEach(((h,p)=>{for(const m of p.Sa)m.va(c)&&(d=!0)})),d&&Tw(u)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function e7(t,e,n){const r=at(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),a=i&&i.key;if(a){let o=new ln(qe.comparator);o=o.insert(a,cr.newNoDocument(a,nt.min()));const c=wt().add(a),u=new E0(nt.min(),new Map,new ln(xt),o,c);await II(r,u),r.du=r.du.remove(a),r.Au.delete(e),kw(r)}else await kx(r.localStore,e,!1).then((()=>Dx(r,e,n))).catch(Hu)}async function t7(t,e){const n=at(t),r=e.batch.batchId;try{const i=await dF(n.localStore,e);OI(n,r,null),MI(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ah(n,i)}catch(i){await Hu(i)}}async function n7(t,e,n){const r=at(t);try{const i=await(function(o,c){const u=at(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let h;return u.mutationQueue.lookupMutationBatch(d,c).next((p=>(Mt(p!==null,37113),h=p.keys(),u.mutationQueue.removeMutationBatch(d,p)))).next((()=>u.mutationQueue.performConsistencyCheck(d))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(d,h,c))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h))).next((()=>u.localDocuments.getDocuments(d,h)))}))})(r.localStore,e);OI(r,e,n),MI(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ah(r,i)}catch(i){await Hu(i)}}function MI(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function OI(t,e,n){const r=at(t);let i=r.Vu[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(n?a.reject(n):a.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function Dx(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((r=>{t.Ru.containsKey(r)||PI(t,r)}))}function PI(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(vw(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),kw(t))}function T2(t,e,n){for(const r of n)r instanceof RI?(t.Ru.addReference(r.key,e),r7(t,r)):r instanceof NI?(Pe(Cw,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||PI(t,r.key)):Je(19791,{wu:r})}function r7(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(Pe(Cw,"New document in limbo: "+n),t.Eu.add(r),kw(t))}function kw(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new qe(Yt.fromString(e)),r=t.fu.next();t.Au.set(r,new qF(n)),t.du=t.du.insert(n,r),SI(t.remoteStore,new Eo(Ia(y0(n.path)),r,"TargetPurposeLimboResolution",g0.ce))}}async function Ah(t,e,n){const r=at(t),i=[],a=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,u)=>{o.push(r.pu(u,e,n).then((d=>{if((d||n)&&r.isPrimaryClient){const h=d?!d.fromCache:n?.targetChanges.get(u.targetId)?.current;r.sharedClientState.updateQueryState(u.targetId,h?"current":"not-current")}if(d){i.push(d);const h=gw.As(u.targetId,d);a.push(h)}})))})),await Promise.all(o),r.Pu.H_(i),await(async function(u,d){const h=at(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>_e.forEach(d,(m=>_e.forEach(m.Es,(b=>h.persistence.referenceDelegate.addReference(p,m.targetId,b))).next((()=>_e.forEach(m.ds,(b=>h.persistence.referenceDelegate.removeReference(p,m.targetId,b)))))))))}catch(p){if(!qu(p))throw p;Pe(mw,"Failed to update sequence numbers: "+p)}for(const p of d){const m=p.targetId;if(!p.fromCache){const b=h.Ms.get(m),w=b.snapshotVersion,S=b.withLastLimboFreeSnapshotVersion(w);h.Ms=h.Ms.insert(m,S)}}})(r.localStore,a))}async function i7(t,e){const n=at(t);if(!n.currentUser.isEqual(e)){Pe(Cw,"User change. New user:",e.toKey());const r=await bI(n.localStore,e);n.currentUser=e,(function(a,o){a.mu.forEach((c=>{c.forEach((u=>{u.reject(new De(be.CANCELLED,o))}))})),a.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ah(n,r.Ls)}}function a7(t,e){const n=at(t),r=n.Au.get(e);if(r&&r.hu)return wt().add(r.key);{let i=wt();const a=n.Iu.get(e);if(!a)return i;for(const o of a){const c=n.Tu.get(o);i=i.unionWith(c.view.nu)}return i}}function jI(t){const e=at(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=II.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=a7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=e7.bind(null,e),e.Pu.H_=FF.bind(null,e.eventManager),e.Pu.yu=$F.bind(null,e.eventManager),e}function s7(t){const e=at(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=t7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=n7.bind(null,e),e}class Mm{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=T0(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return uF(this.persistence,new oF,e.initialUser,this.serializer)}Cu(e){return new yI(pw.mi,this.serializer)}Du(e){return new vF}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Mm.provider={build:()=>new Mm};class o7 extends Mm{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Mt(this.persistence.referenceDelegate instanceof Dm,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new q8(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Mr.withCacheSize(this.cacheSizeBytes):Mr.DEFAULT;return new yI((r=>Dm.mi(r,n)),this.serializer)}}class Ix{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>E2(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=i7.bind(null,this.syncEngine),await LF(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new UF})()}createDatastore(e){const n=T0(e.databaseInfo.databaseId),r=(function(a){return new _F(a)})(e.databaseInfo);return(function(a,o,c,u){return new AF(a,o,c,u)})(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return(function(r,i,a,o,c){return new kF(r,i,a,o,c)})(this.localStore,this.datastore,e.asyncQueue,(n=>E2(this.syncEngine,n,0)),(function(){return y2.v()?new y2:new yF})())}createSyncEngine(e,n){return(function(i,a,o,c,u,d,h){const p=new YF(i,a,o,c,u,d);return h&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const r=at(n);Pe(Zl,"RemoteStore shutting down."),r.Ea.add(5),await Th(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Ix.provider={build:()=>new Ix};class Rw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Cs("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const $o="FirestoreClient";class l7{constructor(e,n,r,i,a){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=lr.UNAUTHENTICATED,this.clientId=rw.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,(async o=>{Pe($o,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(Pe($o,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new xs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=_w(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function xb(t,e){t.asyncQueue.verifyOperationInProgress(),Pe($o,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener((async i=>{r.isEqual(i)||(await bI(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function A2(t,e){t.asyncQueue.verifyOperationInProgress();const n=await c7(t);Pe($o,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((r=>x2(e.remoteStore,r))),t.setAppCheckTokenChangeListener(((r,i)=>x2(e.remoteStore,i))),t._onlineComponents=e}async function c7(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Pe($o,"Using user provided OfflineComponentProvider");try{await xb(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(i){return i.name==="FirebaseError"?i.code===be.FAILED_PRECONDITION||i.code===be.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(n))throw n;Su("Error using user provided cache. Falling back to memory cache: "+n),await xb(t,new Mm)}}else Pe($o,"Using default OfflineComponentProvider"),await xb(t,new o7(void 0));return t._offlineComponents}async function VI(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Pe($o,"Using user provided OnlineComponentProvider"),await A2(t,t._uninitializedComponentsProvider._online)):(Pe($o,"Using default OnlineComponentProvider"),await A2(t,new Ix))),t._onlineComponents}function u7(t){return VI(t).then((e=>e.syncEngine))}async function Om(t){const e=await VI(t),n=e.eventManager;return n.onListen=XF.bind(null,e.syncEngine),n.onUnlisten=QF.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=WF.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=ZF.bind(null,e.syncEngine),n}function d7(t,e,n={}){const r=new xs;return t.asyncQueue.enqueueAndForget((async()=>(function(a,o,c,u,d){const h=new Rw({next:m=>{h.Nu(),o.enqueueAndForget((()=>Ew(a,p)));const b=m.docs.has(c);!b&&m.fromCache?d.reject(new De(be.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&m.fromCache&&u&&u.source==="server"?d.reject(new De(be.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new Aw(y0(c.path),h,{includeMetadataChanges:!0,qa:!0});return Sw(a,p)})(await Om(t),t.asyncQueue,e,n,r))),r.promise}function f7(t,e,n={}){const r=new xs;return t.asyncQueue.enqueueAndForget((async()=>(function(a,o,c,u,d){const h=new Rw({next:m=>{h.Nu(),o.enqueueAndForget((()=>Ew(a,p))),m.fromCache&&u.source==="server"?d.reject(new De(be.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new Aw(c,h,{includeMetadataChanges:!0,qa:!0});return Sw(a,p)})(await Om(t),t.asyncQueue,e,n,r))),r.promise}function zI(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const C2=new Map;const LI="firestore.googleapis.com",k2=!0;class R2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new De(be.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=LI,this.ssl=k2}else this.host=e.host,this.ssl=e.ssl??k2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=vI;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<G8)throw new De(be.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}CU("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zI(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new De(be.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new De(be.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new De(be.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class k0{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new R2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new De(be.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new De(be.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new R2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new vU;switch(r.type){case"firstParty":return new wU(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new De(be.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const r=C2.get(n);r&&(Pe("ComponentProvider","Removing Datastore"),C2.delete(n),r.terminate())})(this),Promise.resolve()}}function h7(t,e,n,r={}){t=_r(t,k0);const i=Qo(e),a=t._getSettings(),o={...a,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${n}`;i&&(j1(`https://${c}`),V1("Firestore",!0)),a.host!==LI&&a.host!==c&&Su("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...a,host:c,ssl:i,emulatorOptions:r};if(!Po(u,o)&&(t._setSettings(u),r.mockUserToken)){let d,h;if(typeof r.mockUserToken=="string")d=r.mockUserToken,h=lr.MOCK_USER;else{d=n5(r.mockUserToken,t._app?.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new De(be.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new lr(p)}t._authCredentials=new yU(new RD(d,h))}}class Ms{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ms(this.firestore,e,this._query)}}class pn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Mo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new pn(this.firestore,e,this._key)}toJSON(){return{type:pn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(_h(n,pn._jsonSchema))return new pn(e,r||null,new qe(Yt.fromString(n.referencePath)))}}pn._jsonSchemaVersion="firestore/documentReference/1.0",pn._jsonSchema={type:jn("string",pn._jsonSchemaVersion),referencePath:jn("string")};class Mo extends Ms{constructor(e,n,r){super(e,n,y0(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new pn(this.firestore,null,new qe(e))}withConverter(e){return new Mo(this.firestore,e,this._path)}}function vr(t,e,...n){if(t=Ot(t),ND("collection","path",e),t instanceof k0){const r=Yt.fromString(e,...n);return FC(r),new Mo(t,null,r)}{if(!(t instanceof pn||t instanceof Mo))throw new De(be.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Yt.fromString(e,...n));return FC(r),new Mo(t.firestore,null,r)}}function gt(t,e,...n){if(t=Ot(t),arguments.length===1&&(e=rw.newId()),ND("doc","path",e),t instanceof k0){const r=Yt.fromString(e,...n);return UC(r),new pn(t,null,new qe(r))}{if(!(t instanceof pn||t instanceof Mo))throw new De(be.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Yt.fromString(e,...n));return UC(r),new pn(t.firestore,t instanceof Mo?t.converter:null,new qe(r))}}const N2="AsyncQueue";class D2{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new wI(this,"async_queue_retry"),this._c=()=>{const r=bb();r&&Pe(N2,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=bb();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=bb();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new xs;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!qu(e))throw e;Pe(N2,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Cs("INTERNAL UNHANDLED ERROR: ",I2(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=ww.createAndSchedule(this,e,n,r,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&Je(47125,{Pc:I2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,r)=>n.targetTimeMs-r.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function I2(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}function M2(t){return(function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const a of r)if(a in i&&typeof i[a]=="function")return!0;return!1})(t,["next","error","complete"])}class Ba extends k0{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new D2,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new D2(e),this._firestoreClient=void 0,await e}}}function p7(t,e){const n=typeof t=="object"?t:B1(),r=typeof t=="string"?t:Em,i=s0(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const a=oN("firestore");a&&h7(i,...a)}return i}function Ch(t){if(t._terminated)throw new De(be.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||g7(t),t._firestoreClient}function g7(t){const e=t._freezeSettings(),n=(function(i,a,o,c){return new zU(i,a,o,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,zI(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new l7(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}})(t._componentsProvider))}class Ei{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ei(ir.fromBase64String(e))}catch(n){throw new De(be.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Ei(ir.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ei._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(_h(e,Ei._jsonSchema))return Ei.fromBase64String(e.bytes)}}Ei._jsonSchemaVersion="firestore/bytes/1.0",Ei._jsonSchema={type:jn("string",Ei._jsonSchemaVersion),bytes:jn("string")};class kh{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new De(be.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new nr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class R0{constructor(e){this._methodName=e}}class Oa{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new De(be.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new De(be.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return xt(this._lat,e._lat)||xt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Oa._jsonSchemaVersion}}static fromJSON(e){if(_h(e,Oa._jsonSchema))return new Oa(e.latitude,e.longitude)}}Oa._jsonSchemaVersion="firestore/geoPoint/1.0",Oa._jsonSchema={type:jn("string",Oa._jsonSchemaVersion),latitude:jn("number"),longitude:jn("number")};class Pa{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Pa._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(_h(e,Pa._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new Pa(e.vectorValues);throw new De(be.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Pa._jsonSchemaVersion="firestore/vectorValue/1.0",Pa._jsonSchema={type:jn("string",Pa._jsonSchemaVersion),vectorValues:jn("object")};const m7=/^__.*__$/;class v7{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new el(e,this.data,this.fieldMask,n,this.fieldTransforms):new Sh(e,this.data,n,this.fieldTransforms)}}class BI{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new el(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function UI(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Je(40011,{Ac:t})}}class N0{constructor(e,n,r,i,a,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new N0({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){const n=this.path?.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Pm(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(UI(this.Ac)&&m7.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class y7{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||T0(e)}Cc(e,n,r,i=!1){return new N0({Ac:e,methodName:n,Dc:r,path:nr.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Rh(t){const e=t._freezeSettings(),n=T0(t._databaseId);return new y7(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Nw(t,e,n,r,i,a={}){const o=t.Cc(a.merge||a.mergeFields?2:0,e,n,i);Iw("Data must be an object, but it was:",o,r);const c=GI(r,o);let u,d;if(a.merge)u=new ni(o.fieldMask),d=o.fieldTransforms;else if(a.mergeFields){const h=[];for(const p of a.mergeFields){const m=Mx(e,p,n);if(!o.contains(m))throw new De(be.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);qI(h,m)||h.push(m)}u=new ni(h),d=o.fieldTransforms.filter((p=>u.covers(p.field)))}else u=null,d=o.fieldTransforms;return new v7(new Or(c),u,d)}class Nh extends R0{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Nh}}function b7(t,e,n){return new N0({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Dw extends R0{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=b7(this,e,!0),r=this.vc.map((a=>Wu(a,n))),i=new Cu(r);return new u8(e.path,i)}isEqual(e){return e instanceof Dw&&Po(this.vc,e.vc)}}function FI(t,e,n,r){const i=t.Cc(1,e,n);Iw("Data must be an object, but it was:",i,r);const a=[],o=Or.empty();Jo(r,((u,d)=>{const h=Mw(e,u,n);d=Ot(d);const p=i.yc(h);if(d instanceof Nh)a.push(h);else{const m=Wu(d,p);m!=null&&(a.push(h),o.set(h,m))}}));const c=new ni(a);return new BI(o,c,i.fieldTransforms)}function $I(t,e,n,r,i,a){const o=t.Cc(1,e,n),c=[Mx(e,r,n)],u=[i];if(a.length%2!=0)throw new De(be.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<a.length;m+=2)c.push(Mx(e,a[m])),u.push(a[m+1]);const d=[],h=Or.empty();for(let m=c.length-1;m>=0;--m)if(!qI(d,c[m])){const b=c[m];let w=u[m];w=Ot(w);const S=o.yc(b);if(w instanceof Nh)d.push(b);else{const E=Wu(w,S);E!=null&&(d.push(b),h.set(b,E))}}const p=new ni(d);return new BI(h,p,o.fieldTransforms)}function x7(t,e,n,r=!1){return Wu(n,t.Cc(r?4:3,e))}function Wu(t,e){if(HI(t=Ot(t)))return Iw("Unsupported field value:",e,t),GI(t,e);if(t instanceof R0)return(function(r,i){if(!UI(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(i);a&&i.fieldTransforms.push(a)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const a=[];let o=0;for(const c of r){let u=Wu(c,i.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),o++}return{arrayValue:{values:a}}})(t,e)}return(function(r,i){if((r=Ot(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return o8(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=mt.fromDate(r);return{timestampValue:Nm(i.serializer,a)}}if(r instanceof mt){const a=new mt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Nm(i.serializer,a)}}if(r instanceof Oa)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ei)return{bytesValue:uI(i.serializer,r._byteString)};if(r instanceof pn){const a=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(a))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:fw(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Pa)return(function(o,c){return{mapValue:{fields:{[LD]:{stringValue:BD},[Tm]:{arrayValue:{values:o.toArray().map((d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return cw(c.serializer,d)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${p0(r)}`)})(t,e)}function GI(t,e){const n={};return MD(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Jo(t,((r,i)=>{const a=Wu(i,e.mc(r));a!=null&&(n[r]=a)})),{mapValue:{fields:n}}}function HI(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof mt||t instanceof Oa||t instanceof Ei||t instanceof pn||t instanceof R0||t instanceof Pa)}function Iw(t,e,n){if(!HI(n)||!DD(n)){const r=p0(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function Mx(t,e,n){if((e=Ot(e))instanceof kh)return e._internalPath;if(typeof e=="string")return Mw(t,e);throw Pm("Field path arguments must be of type string or ",t,!1,void 0,n)}const w7=new RegExp("[~\\*/\\[\\]]");function Mw(t,e,n){if(e.search(w7)>=0)throw Pm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new kh(...e.split("."))._internalPath}catch{throw Pm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Pm(t,e,n,r,i){const a=r&&!r.isEmpty(),o=i!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(a||o)&&(u+=" (found",a&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new De(be.INVALID_ARGUMENT,c+t+u)}function qI(t,e){return t.some((n=>n.isEqual(e)))}class YI{constructor(e,n,r,i,a){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new pn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new _7(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(D0("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class _7 extends YI{data(){return super.data()}}function D0(t,e){return typeof e=="string"?Mw(t,e):e instanceof kh?e._internalPath:e._delegate._internalPath}function XI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new De(be.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ow{}class Pw extends Ow{}function Ji(t,e,...n){let r=[];e instanceof Ow&&r.push(e),r=r.concat(n),(function(a){const o=a.filter((u=>u instanceof jw)).length,c=a.filter((u=>u instanceof I0)).length;if(o>1||o>0&&c>0)throw new De(be.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)t=i._apply(t);return t}class I0 extends Pw{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new I0(e,n,r)}_apply(e){const n=this._parse(e);return WI(e._query,n),new Ms(e.firestore,e.converter,Sx(e._query,n))}_parse(e){const n=Rh(e.firestore);return(function(a,o,c,u,d,h,p){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new De(be.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){j2(p,h);const w=[];for(const S of p)w.push(P2(u,a,S));m={arrayValue:{values:w}}}else m=P2(u,a,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||j2(p,h),m=x7(c,o,p,h==="in"||h==="not-in");return On.create(d,h,m)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function S7(t,e,n){const r=e,i=D0("where",t);return I0._create(i,r,n)}class jw extends Ow{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new jw(e,n)}_parse(e){const n=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return n.length===1?n[0]:Zi.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(i,a){let o=i;const c=a.getFlattenedFilters();for(const u of c)WI(o,u),o=Sx(o,u)})(e._query,n),new Ms(e.firestore,e.converter,Sx(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Vw extends Pw{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Vw(e,n)}_apply(e){const n=(function(i,a,o){if(i.startAt!==null)throw new De(be.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new De(be.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Kf(a,o)})(e._query,this._field,this._direction);return new Ms(e.firestore,e.converter,(function(i,a){const o=i.explicitOrderBy.concat([a]);return new Yu(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,n))}}function Go(t,e="asc"){const n=e,r=D0("orderBy",t);return Vw._create(r,n)}class zw extends Pw{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new zw(e,n,r)}_apply(e){return new Ms(e.firestore,e.converter,Cm(e._query,this._limit,this._limitType))}}function O2(t){return zw._create("limit",t,"F")}function P2(t,e,n){if(typeof(n=Ot(n))=="string"){if(n==="")throw new De(be.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!XD(e)&&n.indexOf("/")!==-1)throw new De(be.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Yt.fromString(n));if(!qe.isDocumentKey(r))throw new De(be.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return KC(t,new qe(r))}if(n instanceof pn)return KC(t,n._key);throw new De(be.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${p0(n)}.`)}function j2(t,e){if(!Array.isArray(t)||t.length===0)throw new De(be.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function WI(t,e){const n=(function(i,a){for(const o of i)for(const c of o.getFlattenedFilters())if(a.indexOf(c.op)>=0)return c.op;return null})(t.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new De(be.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new De(be.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class E7{convertValue(e,n="none"){switch(Uo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return xn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Bo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Je(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Jo(e,((i,a)=>{r[i]=this.convertValue(a,n)})),r}convertVectorValue(e){const n=e.fields?.[Tm].arrayValue?.values?.map((r=>xn(r.doubleValue)));return new Pa(n)}convertGeoPoint(e){return new Oa(xn(e.latitude),xn(e.longitude))}convertArray(e,n){return(e.values||[]).map((r=>this.convertValue(r,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const r=v0(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Yf(e));default:return null}}convertTimestamp(e){const n=Lo(e);return new mt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Yt.fromString(e);Mt(mI(r),9688,{name:e});const i=new Xf(r.get(1),r.get(3)),a=new qe(r.popFirst(5));return i.isEqual(n)||Cs(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),a}}function Lw(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class mf{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Gl extends YI{constructor(e,n,r,i,a,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Jg(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(D0("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new De(be.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Gl._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Gl._jsonSchemaVersion="firestore/documentSnapshot/1.0",Gl._jsonSchema={type:jn("string",Gl._jsonSchemaVersion),bundleSource:jn("string","DocumentSnapshot"),bundleName:jn("string"),bundle:jn("string")};class Jg extends Gl{data(e={}){return super.data(e)}}class Hl{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new mf(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((r=>{e.call(n,new Jg(this._firestore,this._userDataWriter,r.key,r,new mf(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new De(be.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((c=>{const u=new Jg(i._firestore,i._userDataWriter,c.doc.key,c.doc,new mf(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((c=>a||c.type!==3)).map((c=>{const u=new Jg(i._firestore,i._userDataWriter,c.doc.key,c.doc,new mf(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),h=o.indexOf(c.doc.key)),{type:T7(c.type),doc:u,oldIndex:d,newIndex:h}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new De(be.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Hl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=rw.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(n.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function T7(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Je(61501,{type:t})}}function em(t){t=_r(t,pn);const e=_r(t.firestore,Ba);return d7(Ch(e),t._key).then((n=>KI(e,t,n)))}Hl._jsonSchemaVersion="firestore/querySnapshot/1.0",Hl._jsonSchema={type:jn("string",Hl._jsonSchemaVersion),bundleSource:jn("string","QuerySnapshot"),bundleName:jn("string"),bundle:jn("string")};class Bw extends E7{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ei(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new pn(this.firestore,null,n)}}function qi(t){t=_r(t,Ms);const e=_r(t.firestore,Ba),n=Ch(e),r=new Bw(e);return XI(t._query),f7(n,t._query).then((i=>new Hl(e,r,t,i)))}function Jr(t,e,n){t=_r(t,pn);const r=_r(t.firestore,Ba),i=Lw(t.converter,e,n);return Dh(r,[Nw(Rh(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Sr.none())])}function Aa(t,e,n,...r){t=_r(t,pn);const i=_r(t.firestore,Ba),a=Rh(i);let o;return o=typeof(e=Ot(e))=="string"||e instanceof kh?$I(a,"updateDoc",t._key,e,n,r):FI(a,"updateDoc",t._key,e),Dh(i,[o.toMutation(t._key,Sr.exists(!0))])}function ei(t){return Dh(_r(t.firestore,Ba),[new S0(t._key,Sr.none())])}function M0(t,e){const n=_r(t.firestore,Ba),r=gt(t),i=Lw(t.converter,e);return Dh(n,[Nw(Rh(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Sr.exists(!1))]).then((()=>r))}function Ku(t,...e){t=Ot(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||M2(e[r])||(n=e[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(M2(e[r])){const u=e[r];e[r]=u.next?.bind(u),e[r+1]=u.error?.bind(u),e[r+2]=u.complete?.bind(u)}let a,o,c;if(t instanceof pn)o=_r(t.firestore,Ba),c=y0(t._key.path),a={next:u=>{e[r]&&e[r](KI(o,t,u))},error:e[r+1],complete:e[r+2]};else{const u=_r(t,Ms);o=_r(u.firestore,Ba),c=u._query;const d=new Bw(o);a={next:h=>{e[r]&&e[r](new Hl(o,d,u,h))},error:e[r+1],complete:e[r+2]},XI(t._query)}return(function(d,h,p,m){const b=new Rw(m),w=new Aw(h,b,p);return d.asyncQueue.enqueueAndForget((async()=>Sw(await Om(d),w))),()=>{b.Nu(),d.asyncQueue.enqueueAndForget((async()=>Ew(await Om(d),w)))}})(Ch(o),c,i,a)}function Dh(t,e){return(function(r,i){const a=new xs;return r.asyncQueue.enqueueAndForget((async()=>JF(await u7(r),i,a))),a.promise})(Ch(t),e)}function KI(t,e,n){const r=n.docs.get(e._key),i=new Bw(t);return new Gl(t,i,e._key,r,new mf(n.hasPendingWrites,n.fromCache),e.converter)}class A7{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Rh(e)}set(e,n,r){this._verifyNotCommitted();const i=wb(e,this._firestore),a=Lw(i.converter,n,r),o=Nw(this._dataReader,"WriteBatch.set",i._key,a,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Sr.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const a=wb(e,this._firestore);let o;return o=typeof(n=Ot(n))=="string"||n instanceof kh?$I(this._dataReader,"WriteBatch.update",a._key,n,r,i):FI(this._dataReader,"WriteBatch.update",a._key,n),this._mutations.push(o.toMutation(a._key,Sr.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=wb(e,this._firestore);return this._mutations=this._mutations.concat(new S0(n._key,Sr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new De(be.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function wb(t,e){if((t=Ot(t)).firestore!==e)throw new De(be.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function V2(){return new Nh("deleteField")}function C7(...t){return new Dw("arrayUnion",t)}function Ox(t){return Ch(t=_r(t,Ba)),new A7(t,(e=>Dh(t,e)))}(function(e,n=!0){(function(i){Gu=i})(Fu),Xl(new jo("firestore",((r,{instanceIdentifier:i,options:a})=>{const o=r.getProvider("app").getImmediate(),c=new Ba(new bU(r.getProvider("auth-internal")),new _U(o,r.getProvider("app-check-internal")),(function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new De(be.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xf(d.options.projectId,h)})(o,i),o);return a={useFetchStreams:n,...a},c._setSettings(a),c}),"PUBLIC").setMultipleInstances(!0)),Ra(VC,zC,e),Ra(VC,zC,"esm2020")})();const k7={apiKey:"AIzaSyCRHcpbVGQrEZUVdO_Ucn4ZarwwPsrON40",authDomain:"personal-budget-pwa-5defb.firebaseapp.com",projectId:"personal-budget-pwa-5defb",storageBucket:"personal-budget-pwa-5defb.firebasestorage.app",messagingSenderId:"137454342284",appId:"1:137454342284:web:0ae73943f9058a4342aba9",measurementId:"G-VMP5DF6273"},QI=fN(k7),wi=Zz(QI),We=p7(QI),z2=()=>({url:window.location.origin+"/personal-budget-pwa/",handleCodeInApp:!1}),Sg=t=>({id:t.uid,username:t.email||t.uid,displayName:t.displayName||t.email?.split("@")[0]||"User",email:t.email||void 0}),Ai=tw()(wD(t=>({currentUser:null,isAuthenticated:!1,loginError:null,isLoading:!1,isInitialized:!1,isInitializing:!0,lastAuthTime:null,offlineGracePeriod:10080*60*1e3,lastVerificationEmailSent:null,login:async(e,n)=>{t({isLoading:!0,loginError:null});try{const i=(await P6(wi,e,n)).user;if(console.log(` Checking email verification for: ${i.email}`),console.log(" emailVerified status:",i.emailVerified),console.log(" Firebase user object:",{uid:i.uid,email:i.email,emailVerified:i.emailVerified,metadata:i.metadata}),!i.emailVerified)return console.log(` BLOCKING LOGIN: Email not verified for ${i.email}`),await uC(wi),t({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:"Please verify your email address before signing in. Check your email for a verification link."}),console.log(` Login blocked: ${i.email} not verified`),!1;console.log(` EMAIL VERIFIED: Allowing login for ${i.email}`);const a=Sg(i);return t({currentUser:a,isAuthenticated:!0,isLoading:!1,loginError:null,lastAuthTime:Date.now()}),console.log(` User logged in: ${a.email}`),!0}catch(r){console.error("Login error:",r),console.error("Error code:",r.code),console.error("Error message:",r.message);let i="Login failed. Please try again.";if(r.code)switch(r.code){case"auth/invalid-email":i="Invalid email address.";break;case"auth/user-disabled":i="This account has been disabled.";break;case"auth/user-not-found":i="No account found with this email.";break;case"auth/wrong-password":i="Incorrect password.";break;case"auth/too-many-requests":i="Too many failed attempts. Please try again later.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break;case"auth/invalid-credential":i="Invalid email or password.";break;default:console.warn(`Unhandled Firebase error code: ${r.code}`),i="Authentication failed. Please try again.";break}else console.warn("Non-Firebase error in login:",r),i="An unexpected error occurred. Please try again.";return t({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:i}),!1}},register:async(e,n,r)=>{t({isLoading:!0,loginError:null});try{const a=(await O6(wi,e,n)).user;await V6(a,{displayName:r}),await cC(a,z2());const o=Sg(a);return t({currentUser:o,isAuthenticated:!1,isLoading:!1,loginError:null,lastVerificationEmailSent:Date.now()}),console.log(` User registered: ${o.email}, verification email sent`),!0}catch(i){console.error("Registration error:",i);let a="Registration failed. Please try again.";switch(i.code){case"auth/email-already-in-use":a="An account with this email already exists.";break;case"auth/invalid-email":a="Invalid email address.";break;case"auth/weak-password":a="Password should be at least 6 characters.";break;case"auth/operation-not-allowed":a="Email/password accounts are not enabled.";break}return t({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:a}),!1}},logout:async()=>{try{await uC(wi),console.log(" User logged out")}catch(e){console.error("Logout error:",e)}},clearError:()=>{t({loginError:null})},sendPasswordReset:async e=>{t({isLoading:!0,loginError:null});try{return await D6(wi,e),t({isLoading:!1}),!0}catch(n){console.error("Password reset error:",n);let r="Failed to send password reset email. Please try again.";switch(n.code){case"auth/user-not-found":r="No account found with this email.";break;case"auth/invalid-email":r="Invalid email address.";break;case"auth/too-many-requests":r="Too many attempts. Please try again later.";break}return t({isLoading:!1,loginError:r}),!1}},sendEmailVerification:async()=>{const e=wi.currentUser;if(!e)return t({loginError:"No user is currently signed in."}),!1;t({isLoading:!0,loginError:null});try{return await cC(e,z2()),t({isLoading:!1,lastVerificationEmailSent:Date.now()}),console.log(` Verification email sent to: ${e.email}`),!0}catch(n){console.error("Email verification error:",n);let r="Failed to send verification email. Please try again.";switch(n.code){case"auth/too-many-requests":r="Too many verification emails sent. Please wait before trying again.";break}return t({isLoading:!1,loginError:r}),!1}},resendEmailVerification:async()=>{const e=Ai.getState();if(e.lastVerificationEmailSent){const n=Date.now()-e.lastVerificationEmailSent,r=60*1e3;if(n<r){const i=Math.ceil((r-n)/1e3);return t({loginError:`Please wait ${i} seconds before requesting another verification email.`}),!1}}return e.sendEmailVerification()},checkVerificationStatus:async()=>{const e=wi.currentUser;if(!e)return!1;try{await e.reload();const n=wi.currentUser;if(n?.emailVerified){const r=Sg(n);return t({currentUser:r,isAuthenticated:!0,lastAuthTime:Date.now()}),console.log(` Email verified for: ${n.email}`),!0}return!1}catch(n){return console.error("Error checking verification status:",n),!1}},deleteAccount:async e=>{const n=wi.currentUser;if(!n||!n.email)return t({loginError:"No user is currently signed in."}),!1;t({isLoading:!0,loginError:null});try{const r=rc.credential(n.email,e);return await R6(n,r),await U6(n),t({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:null,lastAuthTime:null}),console.log(` Account permanently deleted: ${n.email}`),!0}catch(r){console.error("Account deletion error:",r);let i="Failed to delete account. Please try again.";switch(r.code){case"auth/requires-recent-login":i="For security, please log out and log back in before deleting your account.";break;case"auth/wrong-password":i="Incorrect password. Please enter your current password.";break;case"auth/too-many-requests":i="Too many deletion attempts. Please wait before trying again.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break}return t({isLoading:!1,loginError:i}),!1}},confirmPasswordReset:async(e,n)=>{t({isLoading:!0,loginError:null});try{return await I6(wi,e,n),t({isLoading:!1}),console.log(" Password reset successful"),!0}catch(r){console.error("Password reset confirmation error:",r);let i="Failed to reset password. The link may be expired or invalid.";switch(r.code){case"auth/expired-action-code":i="The password reset link has expired. Please request a new one.";break;case"auth/invalid-action-code":i="The password reset link is invalid. Please request a new one.";break;case"auth/weak-password":i="Password should be at least 6 characters.";break}return t({isLoading:!1,loginError:i}),!1}},initializeAuth:()=>Ai.getState().isInitialized?()=>{}:(t({isInitialized:!1}),B6(wi,async r=>{const i=Date.now(),a=Ai.getState(),o=r?Sg(r):null,c=a.lastAuthTime&&i-a.lastAuthTime<a.offlineGracePeriod,d=typeof navigator<"u"&&!navigator.onLine&&a.isAuthenticated&&c&&!o,h=r?r.emailVerified:!0,p=r&&h||!!d,m=r?o:d?a.currentUser:null;if(t({currentUser:m,isAuthenticated:p,isInitialized:!0,isLoading:!1,loginError:null,lastAuthTime:r&&h?i:a.lastAuthTime}),m)if(console.log(` Auth state: User is signed in (${m.email})`,d?"(offline grace period)":h?"(verified)":"(unverified)"),console.log(" Onboarding check:",{isVerified:h,shouldGrantOfflineAccess:d,willCheckOnboarding:h&&!d}),h&&!d){console.log(" Loading budgetStore to check onboarding...");const b=await Tt(()=>Promise.resolve().then(()=>YQ),[]).then(w=>w.useBudgetStore.getState());console.log(" Calling budgetStore.checkAndStartOnboarding()..."),await b.checkAndStartOnboarding()}else console.log(" Skipping onboarding check (not verified or offline grace period)");else console.log(" Auth state: User is signed out")}))}),{name:"auth-storage",partialize:t=>({isAuthenticated:t.isAuthenticated,currentUser:t.currentUser,lastAuthTime:t.lastAuthTime,offlineGracePeriod:t.offlineGracePeriod,lastVerificationEmailSent:t.lastVerificationEmailSent})})),zt=Object.freeze(Object.defineProperty({__proto__:null,useAuthStore:Ai},Symbol.toStringTag,{value:"Module"})),ZI=[{id:"length",label:"Minimum 12 characters",regex:/^.{12,}$/},{id:"uppercase",label:"At least one uppercase letter (A-Z)",regex:/[A-Z]/},{id:"lowercase",label:"At least one lowercase letter (a-z)",regex:/[a-z]/},{id:"number",label:"At least one number (0-9)",regex:/\d/},{id:"special",label:"At least one special character (!@#$%^&*)",regex:/[!@#$%^&*]/}],R7=t=>{if(!t)return{score:0,level:"weak",color:"text-gray-400",label:"Enter password"};const r=ZI.map(c=>({...c,met:c.regex.test(t)})).filter(c=>c.met).length;let i,a,o;return r<=1?(i="weak",a="text-red-500",o="Weak"):r<=3?(i="medium",a="text-yellow-500",o="Medium"):r===4?(i="strong",a="text-blue-500",o="Strong"):(i="very-strong",a="text-green-500",o="Very Strong"),{score:r,level:i,color:a,label:o}},O0=t=>{const e=ZI.map(i=>({...i,met:i.regex.test(t)})),n=R7(t),r=e.every(i=>i.met);return{requirements:e,strength:n,isValid:r,isEmpty:!t.trim()}},JI=({password:t,className:e=""})=>{const{strength:n,isEmpty:r}=O0(t);return r?null:v.jsxs("div",{className:`flex items-center gap-2 ${e}`,children:[v.jsx("div",{className:"flex-1",children:v.jsx("div",{className:"flex gap-1",children:[1,2,3,4].map(i=>v.jsx("div",{className:`h-1 flex-1 rounded-full ${i<=n.score?n.score<=1?"bg-red-500":n.score<=3?"bg-yellow-500":n.score===4?"bg-blue-500":"bg-green-500":"bg-gray-200 dark:bg-gray-700"}`},i))})}),v.jsx("span",{className:`text-sm font-medium ${n.color}`,children:n.label})]})},eM=({password:t,className:e=""})=>{const{requirements:n,isEmpty:r}=O0(t);return r?null:v.jsx("div",{className:`space-y-1 ${e}`,children:n.map(i=>v.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.met?v.jsx(W9,{className:"h-4 w-4 text-green-500 flex-shrink-0"}):v.jsx(h0,{className:"h-4 w-4 text-red-500 flex-shrink-0"}),v.jsx("span",{className:i.met?"text-green-700 dark:text-green-300":"text-gray-600 dark:text-gray-400",children:i.label})]},i.id))})},N7=()=>{const[t,e]=B.useState(""),[n,r]=B.useState(""),[i,a]=B.useState(""),[o,c]=B.useState(!1),[u,d]=B.useState(!1),[h,p]=B.useState(!1),[m,b]=B.useState(!1),{login:w,register:S,sendPasswordReset:E,isLoading:T,loginError:C,clearError:N}=Ai(),j=O0(n),O=async A=>{if(A.preventDefault(),N(),t.trim()&&n.trim())if(u){if(!i.trim()||!j.isValid)return;await S(t.trim(),n,i.trim())}else await w(t.trim(),n)},M=async A=>{A.preventDefault(),t.trim()&&await E(t.trim())&&b(!0)};return B.useEffect(()=>{e(""),r(""),a(""),b(!1)},[u,h]),v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsxs("div",{className:"flex flex-col items-center gap-3 mb-2",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"Personal Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"Personal Budget"})]}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Simple envelope budgeting for personal finance"})]})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:h?v.jsxs("form",{onSubmit:M,className:"space-y-6",children:[v.jsxs("div",{className:"text-center mb-2",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Reset Password"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Enter your email and we'll send you a link to reset your password."})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"reset-email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(gx,{className:"h-5 w-5 text-gray-400"})}),v.jsx("input",{id:"reset-email",type:"email",value:t,onChange:A=>e(A.target.value),className:"w-full pl-10 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"email"})]})]}),m?v.jsxs("div",{className:"text-center py-4",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 dark:bg-green-900/30",children:v.jsx(gx,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),v.jsx("h3",{className:"mt-3 text-lg font-medium text-gray-900 dark:text-white",children:"Check your email"}),v.jsxs("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:["We've sent a password reset link to ",v.jsx("span",{className:"font-medium",children:t})]}),v.jsxs("button",{type:"button",onClick:()=>p(!1),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[v.jsx(Vo,{className:"-ml-1 mr-2 h-4 w-4"}),"Back to login"]})]}):v.jsxs(v.Fragment,{children:[v.jsx("button",{type:"submit",disabled:T||!t.trim(),className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?"Sending...":"Send Reset Link"}),v.jsx("div",{className:"mt-4 text-center",children:v.jsxs("button",{type:"button",onClick:()=>p(!1),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:[v.jsx(Vo,{className:"inline-block h-4 w-4 -ml-1 mr-1"}),"Back to login"]})})]})]}):v.jsxs("form",{onSubmit:O,className:"space-y-6",children:[v.jsxs("div",{className:"text-center mb-6",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:u?"Create Account":"Sign In"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:u?"Create a new account to get started":"Sign in to your account"})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),v.jsx("input",{id:"email",type:"email",value:t,onChange:A=>e(A.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"username"})]}),u&&v.jsxs("div",{children:[v.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Display Name"}),v.jsx("input",{id:"displayName",type:"text",value:i,onChange:A=>a(A.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your display name",required:!0,disabled:T})]}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"}),!u&&v.jsx("button",{type:"button",onClick:()=>p(!0),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:"Forgot password?"})]}),v.jsxs("div",{className:"relative",children:[v.jsx("input",{id:"password",type:o?"text":"password",value:n,onChange:A=>r(A.target.value),className:`w-full px-3 py-2 pr-10 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white ${u&&n&&!j.isValid?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"Enter your password",required:!0,disabled:T,autoComplete:u?"new-password":"current-password"}),v.jsx("button",{type:"button",onClick:()=>c(!o),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none",disabled:T,children:o?v.jsx(yD,{className:"h-5 w-5"}):v.jsx(bD,{className:"h-5 w-5"})})]}),u&&n&&v.jsx("div",{className:"mt-2",children:v.jsx(JI,{password:n})}),u&&n&&v.jsx("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-md",children:v.jsx(eM,{password:n})})]}),C&&v.jsxs("div",{className:"text-red-600 dark:text-red-400 text-sm text-center bg-red-50 dark:bg-red-900/20 p-3 rounded-md",children:[C,C.includes("verify your email")&&v.jsx("div",{className:"mt-3",children:v.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Please check your email and click the verification link to continue."})})]}),v.jsx("button",{type:"submit",disabled:T||!t.trim()||!n.trim()||u&&!i.trim()||u&&!j.isValid,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?u?"Creating Account...":"Signing in...":u?"Create Account":"Sign In"}),v.jsx("div",{className:"mt-6 text-center",children:v.jsxs("button",{type:"button",onClick:()=>{d(!u),p(!1)},className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",disabled:T,children:[v.jsx(nU,{className:"h-4 w-4"}),u?"Already have an account? Sign In":"Don't have an account? Sign Up"]})})]})})]})})},D7=({oobCode:t,onSuccess:e,onCancel:n})=>{const[r,i]=B.useState(""),[a,o]=B.useState(""),[c,u]=B.useState(!1),[d,h]=B.useState(!1),{confirmPasswordReset:p,isLoading:m,loginError:b,clearError:w}=Ai(),S=O0(r);B.useEffect(()=>{w()},[w]);const E=async T=>{if(T.preventDefault(),r!==a||!S.isValid)return;await p(t,r)&&h(!0)};return d?v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-md p-8 text-center",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/30 mb-6",children:v.jsx(xm,{className:"h-10 w-10 text-green-600 dark:text-green-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Password Reset Complete"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"Your password has been successfully updated. You can now log in with your new password."}),v.jsx("button",{onClick:e,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200",children:"Go to Login"})]})}):v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsxs("div",{className:"flex flex-col items-center gap-3 mb-2",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"Personal Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:"Reset Password"})]}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Create a new password for your account"})]})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:v.jsxs("form",{onSubmit:E,className:"space-y-6",children:[v.jsxs("div",{children:[v.jsx("label",{htmlFor:"new-password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"New Password"}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(DC,{className:"h-5 w-5 text-gray-400"})}),v.jsx("input",{id:"new-password",type:c?"text":"password",value:r,onChange:T=>i(T.target.value),className:"w-full pl-10 pr-10 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white transition-colors",placeholder:"Enter new password",required:!0}),v.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-200",onClick:()=>u(!c),children:c?v.jsx(yD,{className:"h-5 w-5"}):v.jsx(bD,{className:"h-5 w-5"})})]}),v.jsx("div",{className:"mt-2",children:v.jsx(JI,{password:r})})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Confirm New Password"}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(DC,{className:"h-5 w-5 text-gray-400"})}),v.jsx("input",{id:"confirm-password",type:c?"text":"password",value:a,onChange:T=>o(T.target.value),className:`w-full pl-10 px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white transition-colors ${a&&r!==a?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"Confirm new password",required:!0})]}),a&&r!==a&&v.jsx("p",{className:"mt-1 text-sm text-red-500",children:"Passwords do not match"})]}),v.jsx(eM,{password:r}),b&&v.jsx("div",{className:"p-3 rounded-md bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-400 text-sm",children:b}),v.jsx("button",{type:"submit",disabled:m||!r||!a||r!==a||!S.isValid,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:m?"Updating Password...":"Reset Password"}),v.jsx("div",{className:"text-center",children:v.jsxs("button",{type:"button",onClick:n,className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium inline-flex items-center",children:[v.jsx(Vo,{className:"h-4 w-4 mr-1"}),"Back to Login"]})})]})})]})})},tM=()=>{const[t,e]=B.useState(!1),[n,r]=B.useState(!1),{currentUser:i,resendEmailVerification:a,checkVerificationStatus:o,logout:c,loginError:u}=Ai();B.useEffect(()=>{i||console.warn("EmailVerificationView: No current user, this should not happen")},[i]),B.useEffect(()=>{const p=()=>{console.log("Window focused, checking verification status..."),o()};return window.addEventListener("focus",p),()=>window.removeEventListener("focus",p)},[o]);const d=async()=>{e(!0),r(!1);const p=await a();e(!1),p&&(r(!0),setTimeout(()=>r(!1),3e3))},h=async()=>{await c()};return i?v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsx("div",{className:"flex flex-col items-center gap-3 mb-2",children:v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"House Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"House Budget"})]})})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/30 mb-4",children:v.jsx(gx,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Check your email"}),v.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["We've sent a verification link to"," ",v.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:i.email})]}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 mb-6",children:v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(xm,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),v.jsxs("div",{className:"text-left",children:[v.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium",children:"What to do next:"}),v.jsxs("ol",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1 space-y-1",children:[v.jsx("li",{children:"1. Open your email inbox"}),v.jsx("li",{children:"2. Find the email from House Budget"}),v.jsx("li",{children:'3. Click the "Verify Email" link'}),v.jsx("li",{children:"4. Return here and sign in"})]})]})]})}),u&&v.jsx("div",{className:"text-red-600 dark:text-red-400 text-sm mb-4 p-3 bg-red-50 dark:bg-red-900/20 rounded-md",children:u}),n&&v.jsx("div",{className:"text-green-600 dark:text-green-400 text-sm mb-4 p-3 bg-green-50 dark:bg-green-900/20 rounded-md",children:"Verification email sent successfully!"}),v.jsx("button",{onClick:d,disabled:t,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed mb-4 flex items-center justify-center gap-2",children:t?v.jsxs(v.Fragment,{children:[v.jsx($f,{className:"h-4 w-4 animate-spin"}),"Sending..."]}):v.jsxs(v.Fragment,{children:[v.jsx($f,{className:"h-4 w-4"}),"Resend verification email"]})}),v.jsxs("button",{onClick:h,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",children:[v.jsx(Vo,{className:"h-4 w-4"}),"Back to sign in"]})]})}),v.jsx("div",{className:"text-center",children:v.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Didn't receive the email? Check your spam folder or try resending."})})]})}):null},nM=({message:t="Loading your budget...",showTimeout:e=!1})=>v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex flex-col items-center justify-center px-4",children:[v.jsx("div",{className:"mb-8",children:v.jsxs("div",{className:"relative",children:[v.jsx($f,{size:48,className:"text-blue-500 animate-spin"}),v.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:v.jsx(f0,{size:24,className:"text-blue-600 dark:text-blue-400"})})]})}),v.jsxs("div",{className:"text-center space-y-3",children:[v.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:t}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400 max-w-md",children:"This may take a moment on slow connections. We're fetching your budget data securely."})]}),v.jsxs("div",{className:"mt-12 w-full max-w-md space-y-4",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("div",{className:"h-6 bg-gray-200 dark:bg-zinc-700 rounded w-24 animate-pulse"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]})]})}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsx("div",{className:"h-4 bg-gray-200 dark:bg-zinc-700 rounded w-32 mb-2 animate-pulse"}),v.jsx("div",{className:"h-8 bg-gray-200 dark:bg-zinc-700 rounded w-20 animate-pulse"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-28 animate-pulse"}),v.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-32 animate-pulse"}),v.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]})]}),e&&v.jsx("div",{className:"mt-8 p-4 bg-amber-50 dark:bg-amber-900/20 rounded-xl border border-amber-200 dark:border-amber-800 max-w-md",children:v.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200 text-center",children:"This is taking longer than usual. If you're on a very slow connection, this is normal. Your data will load shortly."})}),v.jsx("div",{className:"mt-8 w-full max-w-md",children:v.jsx("div",{className:"h-1 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:v.jsx("div",{className:"h-full bg-blue-500 rounded-full animate-pulse",style:{width:"60%"}})})})]}),Uw=B.createContext({});function P0(t){const e=B.useRef(null);return e.current===null&&(e.current=t()),e.current}const Fw=typeof window<"u",$w=Fw?B.useLayoutEffect:B.useEffect,j0=B.createContext(null);function Gw(t,e){t.indexOf(e)===-1&&t.push(e)}function Hw(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const Rs=(t,e,n)=>n>e?e:n<t?t:n;let qw=()=>{};const Ns={},rM=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function iM(t){return typeof t=="object"&&t!==null}const aM=t=>/^0[^.\s]+$/u.test(t);function Yw(t){let e;return()=>(e===void 0&&(e=t()),e)}const Ci=t=>t,I7=(t,e)=>n=>e(t(n)),Ih=(...t)=>t.reduce(I7),Zf=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r};class Xw{constructor(){this.subscriptions=[]}add(e){return Gw(this.subscriptions,e),()=>Hw(this.subscriptions,e)}notify(e,n,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,n,r);else for(let a=0;a<i;a++){const o=this.subscriptions[a];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const ja=t=>t*1e3,Ti=t=>t/1e3;function sM(t,e){return e?t*(1e3/e):0}const oM=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,M7=1e-7,O7=12;function P7(t,e,n,r,i){let a,o,c=0;do o=e+(n-e)/2,a=oM(o,r,i)-t,a>0?n=o:e=o;while(Math.abs(a)>M7&&++c<O7);return o}function Mh(t,e,n,r){if(t===e&&n===r)return Ci;const i=a=>P7(a,0,1,t,n);return a=>a===0||a===1?a:oM(i(a),e,r)}const lM=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,cM=t=>e=>1-t(1-e),uM=Mh(.33,1.53,.69,.99),Ww=cM(uM),dM=lM(Ww),fM=t=>(t*=2)<1?.5*Ww(t):.5*(2-Math.pow(2,-10*(t-1))),Kw=t=>1-Math.sin(Math.acos(t)),hM=cM(Kw),pM=lM(Kw),j7=Mh(.42,0,1,1),V7=Mh(0,0,.58,1),gM=Mh(.42,0,.58,1),z7=t=>Array.isArray(t)&&typeof t[0]!="number",mM=t=>Array.isArray(t)&&typeof t[0]=="number",L7={linear:Ci,easeIn:j7,easeInOut:gM,easeOut:V7,circIn:Kw,circInOut:pM,circOut:hM,backIn:Ww,backInOut:dM,backOut:uM,anticipate:fM},B7=t=>typeof t=="string",L2=t=>{if(mM(t)){qw(t.length===4);const[e,n,r,i]=t;return Mh(e,n,r,i)}else if(B7(t))return L7[t];return t},Eg=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function U7(t,e){let n=new Set,r=new Set,i=!1,a=!1;const o=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function u(h){o.has(h)&&(d.schedule(h),t()),h(c)}const d={schedule:(h,p=!1,m=!1)=>{const w=m&&i?n:r;return p&&o.add(h),w.has(h)||w.add(h),h},cancel:h=>{r.delete(h),o.delete(h)},process:h=>{if(c=h,i){a=!0;return}i=!0,[n,r]=[r,n],n.forEach(u),n.clear(),i=!1,a&&(a=!1,d.process(h))}};return d}const F7=40;function vM(t,e){let n=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},a=()=>n=!0,o=Eg.reduce((N,j)=>(N[j]=U7(a),N),{}),{setup:c,read:u,resolveKeyframes:d,preUpdate:h,update:p,preRender:m,render:b,postRender:w}=o,S=()=>{const N=Ns.useManualTiming?i.timestamp:performance.now();n=!1,Ns.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(N-i.timestamp,F7),1)),i.timestamp=N,i.isProcessing=!0,c.process(i),u.process(i),d.process(i),h.process(i),p.process(i),m.process(i),b.process(i),w.process(i),i.isProcessing=!1,n&&e&&(r=!1,t(S))},E=()=>{n=!0,r=!0,i.isProcessing||t(S)};return{schedule:Eg.reduce((N,j)=>{const O=o[j];return N[j]=(M,A=!1,k=!1)=>(n||E(),O.schedule(M,A,k)),N},{}),cancel:N=>{for(let j=0;j<Eg.length;j++)o[Eg[j]].cancel(N)},state:i,steps:o}}const{schedule:en,cancel:Ho,state:er,steps:_b}=vM(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ci,!0);let tm;function $7(){tm=void 0}const Pr={now:()=>(tm===void 0&&Pr.set(er.isProcessing||Ns.useManualTiming?er.timestamp:performance.now()),tm),set:t=>{tm=t,queueMicrotask($7)}},yM=t=>e=>typeof e=="string"&&e.startsWith(t),Qw=yM("--"),G7=yM("var(--"),Zw=t=>G7(t)?H7.test(t.split("/*")[0].trim()):!1,H7=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Qu={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Jf={...Qu,transform:t=>Rs(0,1,t)},Tg={...Qu,default:1},kf=t=>Math.round(t*1e5)/1e5,Jw=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function q7(t){return t==null}const Y7=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,e_=(t,e)=>n=>!!(typeof n=="string"&&Y7.test(n)&&n.startsWith(t)||e&&!q7(n)&&Object.prototype.hasOwnProperty.call(n,e)),bM=(t,e,n)=>r=>{if(typeof r!="string")return r;const[i,a,o,c]=r.match(Jw);return{[t]:parseFloat(i),[e]:parseFloat(a),[n]:parseFloat(o),alpha:c!==void 0?parseFloat(c):1}},X7=t=>Rs(0,255,t),Sb={...Qu,transform:t=>Math.round(X7(t))},Bl={test:e_("rgb","red"),parse:bM("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+Sb.transform(t)+", "+Sb.transform(e)+", "+Sb.transform(n)+", "+kf(Jf.transform(r))+")"};function W7(t){let e="",n="",r="",i="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),i=t.substring(4,5),e+=e,n+=n,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const Px={test:e_("#"),parse:W7,transform:Bl.transform},Oh=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),yo=Oh("deg"),Va=Oh("%"),et=Oh("px"),K7=Oh("vh"),Q7=Oh("vw"),B2={...Va,parse:t=>Va.parse(t)/100,transform:t=>Va.transform(t*100)},iu={test:e_("hsl","hue"),parse:bM("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+Va.transform(kf(e))+", "+Va.transform(kf(n))+", "+kf(Jf.transform(r))+")"},Mn={test:t=>Bl.test(t)||Px.test(t)||iu.test(t),parse:t=>Bl.test(t)?Bl.parse(t):iu.test(t)?iu.parse(t):Px.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Bl.transform(t):iu.transform(t),getAnimatableNone:t=>{const e=Mn.parse(t);return e.alpha=0,Mn.transform(e)}},Z7=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function J7(t){return isNaN(t)&&typeof t=="string"&&(t.match(Jw)?.length||0)+(t.match(Z7)?.length||0)>0}const xM="number",wM="color",e$="var",t$="var(",U2="${}",n$=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function eh(t){const e=t.toString(),n=[],r={color:[],number:[],var:[]},i=[];let a=0;const c=e.replace(n$,u=>(Mn.test(u)?(r.color.push(a),i.push(wM),n.push(Mn.parse(u))):u.startsWith(t$)?(r.var.push(a),i.push(e$),n.push(u)):(r.number.push(a),i.push(xM),n.push(parseFloat(u))),++a,U2)).split(U2);return{values:n,split:c,indexes:r,types:i}}function _M(t){return eh(t).values}function SM(t){const{split:e,types:n}=eh(t),r=e.length;return i=>{let a="";for(let o=0;o<r;o++)if(a+=e[o],i[o]!==void 0){const c=n[o];c===xM?a+=kf(i[o]):c===wM?a+=Mn.transform(i[o]):a+=i[o]}return a}}const r$=t=>typeof t=="number"?0:Mn.test(t)?Mn.getAnimatableNone(t):t;function i$(t){const e=_M(t);return SM(t)(e.map(r$))}const qo={test:J7,parse:_M,createTransformer:SM,getAnimatableNone:i$};function Eb(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function a$({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let i=0,a=0,o=0;if(!e)i=a=o=n;else{const c=n<.5?n*(1+e):n+e-n*e,u=2*n-c;i=Eb(u,c,t+1/3),a=Eb(u,c,t),o=Eb(u,c,t-1/3)}return{red:Math.round(i*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:r}}function jm(t,e){return n=>n>0?e:t}const sn=(t,e,n)=>t+(e-t)*n,Tb=(t,e,n)=>{const r=t*t,i=n*(e*e-r)+r;return i<0?0:Math.sqrt(i)},s$=[Px,Bl,iu],o$=t=>s$.find(e=>e.test(t));function F2(t){const e=o$(t);if(!e)return!1;let n=e.parse(t);return e===iu&&(n=a$(n)),n}const $2=(t,e)=>{const n=F2(t),r=F2(e);if(!n||!r)return jm(t,e);const i={...n};return a=>(i.red=Tb(n.red,r.red,a),i.green=Tb(n.green,r.green,a),i.blue=Tb(n.blue,r.blue,a),i.alpha=sn(n.alpha,r.alpha,a),Bl.transform(i))},jx=new Set(["none","hidden"]);function l$(t,e){return jx.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function c$(t,e){return n=>sn(t,e,n)}function t_(t){return typeof t=="number"?c$:typeof t=="string"?Zw(t)?jm:Mn.test(t)?$2:f$:Array.isArray(t)?EM:typeof t=="object"?Mn.test(t)?$2:u$:jm}function EM(t,e){const n=[...t],r=n.length,i=t.map((a,o)=>t_(a)(a,e[o]));return a=>{for(let o=0;o<r;o++)n[o]=i[o](a);return n}}function u$(t,e){const n={...t,...e},r={};for(const i in n)t[i]!==void 0&&e[i]!==void 0&&(r[i]=t_(t[i])(t[i],e[i]));return i=>{for(const a in r)n[a]=r[a](i);return n}}function d$(t,e){const n=[],r={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const a=e.types[i],o=t.indexes[a][r[a]],c=t.values[o]??0;n[i]=c,r[a]++}return n}const f$=(t,e)=>{const n=qo.createTransformer(e),r=eh(t),i=eh(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?jx.has(t)&&!i.values.length||jx.has(e)&&!r.values.length?l$(t,e):Ih(EM(d$(r,i),i.values),n):jm(t,e)};function TM(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?sn(t,e,n):t_(t)(t,e)}const h$=t=>{const e=({timestamp:n})=>t(n);return{start:(n=!0)=>en.update(e,n),stop:()=>Ho(e),now:()=>er.isProcessing?er.timestamp:Pr.now()}},AM=(t,e,n=10)=>{let r="";const i=Math.max(Math.round(e/n),2);for(let a=0;a<i;a++)r+=Math.round(t(a/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},Vm=2e4;function n_(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<Vm;)e+=n,r=t.next(e);return e>=Vm?1/0:e}function p$(t,e=100,n){const r=n({...t,keyframes:[0,e]}),i=Math.min(n_(r),Vm);return{type:"keyframes",ease:a=>r.next(i*a).value/e,duration:Ti(i)}}const g$=5;function CM(t,e,n){const r=Math.max(e-g$,0);return sM(n-t(r),e-r)}const hn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Ab=.001;function m$({duration:t=hn.duration,bounce:e=hn.bounce,velocity:n=hn.velocity,mass:r=hn.mass}){let i,a,o=1-e;o=Rs(hn.minDamping,hn.maxDamping,o),t=Rs(hn.minDuration,hn.maxDuration,Ti(t)),o<1?(i=d=>{const h=d*o,p=h*t,m=h-n,b=Vx(d,o),w=Math.exp(-p);return Ab-m/b*w},a=d=>{const p=d*o*t,m=p*n+n,b=Math.pow(o,2)*Math.pow(d,2)*t,w=Math.exp(-p),S=Vx(Math.pow(d,2),o);return(-i(d)+Ab>0?-1:1)*((m-b)*w)/S}):(i=d=>{const h=Math.exp(-d*t),p=(d-n)*t+1;return-Ab+h*p},a=d=>{const h=Math.exp(-d*t),p=(n-d)*(t*t);return h*p});const c=5/t,u=y$(i,a,c);if(t=ja(t),isNaN(u))return{stiffness:hn.stiffness,damping:hn.damping,duration:t};{const d=Math.pow(u,2)*r;return{stiffness:d,damping:o*2*Math.sqrt(r*d),duration:t}}}const v$=12;function y$(t,e,n){let r=n;for(let i=1;i<v$;i++)r=r-t(r)/e(r);return r}function Vx(t,e){return t*Math.sqrt(1-e*e)}const b$=["duration","bounce"],x$=["stiffness","damping","mass"];function G2(t,e){return e.some(n=>t[n]!==void 0)}function w$(t){let e={velocity:hn.velocity,stiffness:hn.stiffness,damping:hn.damping,mass:hn.mass,isResolvedFromDuration:!1,...t};if(!G2(t,x$)&&G2(t,b$))if(t.visualDuration){const n=t.visualDuration,r=2*Math.PI/(n*1.2),i=r*r,a=2*Rs(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:hn.mass,stiffness:i,damping:a}}else{const n=m$(t);e={...e,...n,mass:hn.mass},e.isResolvedFromDuration=!0}return e}function zm(t=hn.visualDuration,e=hn.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:r,restDelta:i}=n;const a=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],c={done:!1,value:a},{stiffness:u,damping:d,mass:h,duration:p,velocity:m,isResolvedFromDuration:b}=w$({...n,velocity:-Ti(n.velocity||0)}),w=m||0,S=d/(2*Math.sqrt(u*h)),E=o-a,T=Ti(Math.sqrt(u/h)),C=Math.abs(E)<5;r||(r=C?hn.restSpeed.granular:hn.restSpeed.default),i||(i=C?hn.restDelta.granular:hn.restDelta.default);let N;if(S<1){const O=Vx(T,S);N=M=>{const A=Math.exp(-S*T*M);return o-A*((w+S*T*E)/O*Math.sin(O*M)+E*Math.cos(O*M))}}else if(S===1)N=O=>o-Math.exp(-T*O)*(E+(w+T*E)*O);else{const O=T*Math.sqrt(S*S-1);N=M=>{const A=Math.exp(-S*T*M),k=Math.min(O*M,300);return o-A*((w+S*T*E)*Math.sinh(k)+O*E*Math.cosh(k))/O}}const j={calculatedDuration:b&&p||null,next:O=>{const M=N(O);if(b)c.done=O>=p;else{let A=O===0?w:0;S<1&&(A=O===0?ja(w):CM(N,O,M));const k=Math.abs(A)<=r,D=Math.abs(o-M)<=i;c.done=k&&D}return c.value=c.done?o:M,c},toString:()=>{const O=Math.min(n_(j),Vm),M=AM(A=>j.next(O*A).value,O,30);return O+"ms "+M},toTransition:()=>{}};return j}zm.applyToOptions=t=>{const e=p$(t,100,zm);return t.ease=e.ease,t.duration=ja(e.duration),t.type="keyframes",t};function zx({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:a=500,modifyTarget:o,min:c,max:u,restDelta:d=.5,restSpeed:h}){const p=t[0],m={done:!1,value:p},b=k=>c!==void 0&&k<c||u!==void 0&&k>u,w=k=>c===void 0?u:u===void 0||Math.abs(c-k)<Math.abs(u-k)?c:u;let S=n*e;const E=p+S,T=o===void 0?E:o(E);T!==E&&(S=T-p);const C=k=>-S*Math.exp(-k/r),N=k=>T+C(k),j=k=>{const D=C(k),V=N(k);m.done=Math.abs(D)<=d,m.value=m.done?T:V};let O,M;const A=k=>{b(m.value)&&(O=k,M=zm({keyframes:[m.value,w(m.value)],velocity:CM(N,k,m.value),damping:i,stiffness:a,restDelta:d,restSpeed:h}))};return A(0),{calculatedDuration:null,next:k=>{let D=!1;return!M&&O===void 0&&(D=!0,j(k),A(k)),O!==void 0&&k>=O?M.next(k-O):(!D&&j(k),m)}}}function _$(t,e,n){const r=[],i=n||Ns.mix||TM,a=t.length-1;for(let o=0;o<a;o++){let c=i(t[o],t[o+1]);if(e){const u=Array.isArray(e)?e[o]||Ci:e;c=Ih(u,c)}r.push(c)}return r}function S$(t,e,{clamp:n=!0,ease:r,mixer:i}={}){const a=t.length;if(qw(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[a-1]&&(t=[...t].reverse(),e=[...e].reverse());const c=_$(e,r,i),u=c.length,d=h=>{if(o&&h<t[0])return e[0];let p=0;if(u>1)for(;p<t.length-2&&!(h<t[p+1]);p++);const m=Zf(t[p],t[p+1],h);return c[p](m)};return n?h=>d(Rs(t[0],t[a-1],h)):d}function E$(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const i=Zf(0,e,r);t.push(sn(n,1,i))}}function T$(t){const e=[0];return E$(e,t.length-1),e}function A$(t,e){return t.map(n=>n*e)}function C$(t,e){return t.map(()=>e||gM).splice(0,t.length-1)}function Rf({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const i=z7(r)?r.map(L2):L2(r),a={done:!1,value:e[0]},o=A$(n&&n.length===e.length?n:T$(e),t),c=S$(o,e,{ease:Array.isArray(i)?i:C$(e,i)});return{calculatedDuration:t,next:u=>(a.value=c(u),a.done=u>=t,a)}}const k$=t=>t!==null;function r_(t,{repeat:e,repeatType:n="loop"},r,i=1){const a=t.filter(k$),c=i<0||e&&n!=="loop"&&e%2===1?0:a.length-1;return!c||r===void 0?a[c]:r}const R$={decay:zx,inertia:zx,tween:Rf,keyframes:Rf,spring:zm};function kM(t){typeof t.type=="string"&&(t.type=R$[t.type])}class i_{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,n){return this.finished.then(e,n)}}const N$=t=>t/100;class a_ extends i_{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;n&&n.updatedAt!==Pr.now()&&this.tick(Pr.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;kM(e);const{type:n=Rf,repeat:r=0,repeatDelay:i=0,repeatType:a,velocity:o=0}=e;let{keyframes:c}=e;const u=n||Rf;u!==Rf&&typeof c[0]!="number"&&(this.mixKeyframes=Ih(N$,TM(c[0],c[1])),c=[0,100]);const d=u({...e,keyframes:c});a==="mirror"&&(this.mirroredGenerator=u({...e,keyframes:[...c].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=n_(d));const{calculatedDuration:h}=d;this.calculatedDuration=h,this.resolvedDuration=h+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=d}updateTime(e){const n=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(e,n=!1){const{generator:r,totalDuration:i,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:c,calculatedDuration:u}=this;if(this.startTime===null)return r.next(0);const{delay:d=0,keyframes:h,repeat:p,repeatType:m,repeatDelay:b,type:w,onUpdate:S,finalKeyframe:E}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),n?this.currentTime=e:this.updateTime(e);const T=this.currentTime-d*(this.playbackSpeed>=0?1:-1),C=this.playbackSpeed>=0?T<0:T>i;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let N=this.currentTime,j=r;if(p){const k=Math.min(this.currentTime,i)/c;let D=Math.floor(k),V=k%1;!V&&k>=1&&(V=1),V===1&&D--,D=Math.min(D,p+1),!!(D%2)&&(m==="reverse"?(V=1-V,b&&(V-=b/c)):m==="mirror"&&(j=o)),N=Rs(0,1,V)*c}const O=C?{done:!1,value:h[0]}:j.next(N);a&&(O.value=a(O.value));let{done:M}=O;!C&&u!==null&&(M=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const A=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&M);return A&&w!==zx&&(O.value=r_(h,this.options,E,this.speed)),S&&S(O.value),A&&this.finish(),O}then(e,n){return this.finished.then(e,n)}get duration(){return Ti(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Ti(e)}get time(){return Ti(this.currentTime)}set time(e){e=ja(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Pr.now());const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=Ti(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=h$,startTime:n}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=n??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Pr.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function D$(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const Ul=t=>t*180/Math.PI,Lx=t=>{const e=Ul(Math.atan2(t[1],t[0]));return Bx(e)},I$={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:Lx,rotateZ:Lx,skewX:t=>Ul(Math.atan(t[1])),skewY:t=>Ul(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Bx=t=>(t=t%360,t<0&&(t+=360),t),H2=Lx,q2=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),Y2=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),M$={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:q2,scaleY:Y2,scale:t=>(q2(t)+Y2(t))/2,rotateX:t=>Bx(Ul(Math.atan2(t[6],t[5]))),rotateY:t=>Bx(Ul(Math.atan2(-t[2],t[0]))),rotateZ:H2,rotate:H2,skewX:t=>Ul(Math.atan(t[4])),skewY:t=>Ul(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function Ux(t){return t.includes("scale")?1:0}function Fx(t,e){if(!t||t==="none")return Ux(e);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(n)r=M$,i=n;else{const c=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=I$,i=c}if(!i)return Ux(e);const a=r[e],o=i[1].split(",").map(P$);return typeof a=="function"?a(o):o[a]}const O$=(t,e)=>{const{transform:n="none"}=getComputedStyle(t);return Fx(n,e)};function P$(t){return parseFloat(t.trim())}const Zu=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ju=new Set(Zu),X2=t=>t===Qu||t===et,j$=new Set(["x","y","z"]),V$=Zu.filter(t=>!j$.has(t));function z$(t){const e=[];return V$.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e}const ql={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>Fx(e,"x"),y:(t,{transform:e})=>Fx(e,"y")};ql.translateX=ql.x;ql.translateY=ql.y;const Yl=new Set;let $x=!1,Gx=!1,Hx=!1;function RM(){if(Gx){const t=Array.from(Yl).filter(r=>r.needsMeasurement),e=new Set(t.map(r=>r.element)),n=new Map;e.forEach(r=>{const i=z$(r);i.length&&(n.set(r,i),r.render())}),t.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=n.get(r);i&&i.forEach(([a,o])=>{r.getValue(a)?.set(o)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}Gx=!1,$x=!1,Yl.forEach(t=>t.complete(Hx)),Yl.clear()}function NM(){Yl.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Gx=!0)})}function L$(){Hx=!0,NM(),RM(),Hx=!1}class s_{constructor(e,n,r,i,a,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=r,this.motionValue=i,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(Yl.add(this),$x||($x=!0,en.read(NM),en.resolveKeyframes(RM))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:r,motionValue:i}=this;if(e[0]===null){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&n){const c=r.readValue(n,o);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}D$(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Yl.delete(this)}cancel(){this.state==="scheduled"&&(Yl.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const B$=t=>t.startsWith("--");function U$(t,e,n){B$(e)?t.style.setProperty(e,n):t.style[e]=n}const F$=Yw(()=>window.ScrollTimeline!==void 0),$$={};function G$(t,e){const n=Yw(t);return()=>$$[e]??n()}const DM=G$(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),vf=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,W2={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:vf([0,.65,.55,1]),circOut:vf([.55,0,1,.45]),backIn:vf([.31,.01,.66,-.59]),backOut:vf([.33,1.53,.69,.99])};function IM(t,e){if(t)return typeof t=="function"?DM()?AM(t,e):"ease-out":mM(t)?vf(t):Array.isArray(t)?t.map(n=>IM(n,e)||W2.easeOut):W2[t]}function H$(t,e,n,{delay:r=0,duration:i=300,repeat:a=0,repeatType:o="loop",ease:c="easeOut",times:u}={},d=void 0){const h={[e]:n};u&&(h.offset=u);const p=IM(c,i);Array.isArray(p)&&(h.easing=p);const m={delay:r,duration:i,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};return d&&(m.pseudoElement=d),t.animate(h,m)}function MM(t){return typeof t=="function"&&"applyToOptions"in t}function q$({type:t,...e}){return MM(t)&&DM()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class Y$ extends i_{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:n,name:r,keyframes:i,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:c,onComplete:u}=e;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=e,qw(typeof e.type!="string");const d=q$(e);this.animation=H$(n,r,i,d,a),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const h=r_(i,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(h):U$(n,r,h),this.animation.cancel()}u?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return Ti(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Ti(e)}get time(){return Ti(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=ja(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:n}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&F$()?(this.animation.timeline=e,Ci):n(this)}}const OM={anticipate:fM,backInOut:dM,circInOut:pM};function X$(t){return t in OM}function W$(t){typeof t.ease=="string"&&X$(t.ease)&&(t.ease=OM[t.ease])}const K2=10;class K$ extends Y${constructor(e){W$(e),kM(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:n,onUpdate:r,onComplete:i,element:a,...o}=this.options;if(!n)return;if(e!==void 0){n.set(e);return}const c=new a_({...o,autoplay:!1}),u=ja(this.finishedTime??this.time);n.setWithVelocity(c.sample(u-K2).value,c.sample(u).value,K2),c.stop()}}const Q2=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(qo.test(t)||t==="0")&&!t.startsWith("url("));function Q$(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function Z$(t,e,n,r){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const a=t[t.length-1],o=Q2(i,e),c=Q2(a,e);return!o||!c?!1:Q$(t)||(n==="spring"||MM(n))&&r}function qx(t){t.duration=0,t.type="keyframes"}const J$=new Set(["opacity","clipPath","filter","transform"]),eG=Yw(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function tG(t){const{motionValue:e,name:n,repeatDelay:r,repeatType:i,damping:a,type:o}=t;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:d}=e.owner.getProps();return eG()&&n&&J$.has(n)&&(n!=="transform"||!d)&&!u&&!r&&i!=="mirror"&&a!==0&&o!=="inertia"}const nG=40;class rG extends i_{constructor({autoplay:e=!0,delay:n=0,type:r="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:o="loop",keyframes:c,name:u,motionValue:d,element:h,...p}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Pr.now();const m={autoplay:e,delay:n,type:r,repeat:i,repeatDelay:a,repeatType:o,name:u,motionValue:d,element:h,...p},b=h?.KeyframeResolver||s_;this.keyframeResolver=new b(c,(w,S,E)=>this.onKeyframesResolved(w,S,m,!E),u,d,h),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,n,r,i){this.keyframeResolver=void 0;const{name:a,type:o,velocity:c,delay:u,isHandoff:d,onUpdate:h}=r;this.resolvedAt=Pr.now(),Z$(e,a,o,c)||((Ns.instantAnimations||!u)&&h?.(r_(e,r,n)),e[0]=e[e.length-1],qx(r),r.repeat=0);const m={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>nG?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:e},b=!d&&tG(m)?new K$({...m,element:m.motionValue.owner.current}):new a_(m);b.finished.then(()=>this.notifyFinished()).catch(Ci),this.pendingTimeline&&(this.stopTimeline=b.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=b}get finished(){return this._animation?this.animation.finished:this._finished}then(e,n){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),L$()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const iG=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function aG(t){const e=iG.exec(t);if(!e)return[,];const[,n,r,i]=e;return[`--${n??r}`,i]}function PM(t,e,n=1){const[r,i]=aG(t);if(!r)return;const a=window.getComputedStyle(e).getPropertyValue(r);if(a){const o=a.trim();return rM(o)?parseFloat(o):o}return Zw(i)?PM(i,e,n+1):i}function o_(t,e){return t?.[e]??t?.default??t}const jM=new Set(["width","height","top","left","right","bottom",...Zu]),sG={test:t=>t==="auto",parse:t=>t},VM=t=>e=>e.test(t),zM=[Qu,et,Va,yo,Q7,K7,sG],Z2=t=>zM.find(VM(t));function oG(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||aM(t):!0}const lG=new Set(["brightness","contrast","saturate","opacity"]);function cG(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(Jw)||[];if(!r)return t;const i=n.replace(r,"");let a=lG.has(e)?1:0;return r!==n&&(a*=100),e+"("+a+i+")"}const uG=/\b([a-z-]*)\(.*?\)/gu,Yx={...qo,getAnimatableNone:t=>{const e=t.match(uG);return e?e.map(cG).join(" "):t}},J2={...Qu,transform:Math.round},dG={rotate:yo,rotateX:yo,rotateY:yo,rotateZ:yo,scale:Tg,scaleX:Tg,scaleY:Tg,scaleZ:Tg,skew:yo,skewX:yo,skewY:yo,distance:et,translateX:et,translateY:et,translateZ:et,x:et,y:et,z:et,perspective:et,transformPerspective:et,opacity:Jf,originX:B2,originY:B2,originZ:et},l_={borderWidth:et,borderTopWidth:et,borderRightWidth:et,borderBottomWidth:et,borderLeftWidth:et,borderRadius:et,radius:et,borderTopLeftRadius:et,borderTopRightRadius:et,borderBottomRightRadius:et,borderBottomLeftRadius:et,width:et,maxWidth:et,height:et,maxHeight:et,top:et,right:et,bottom:et,left:et,padding:et,paddingTop:et,paddingRight:et,paddingBottom:et,paddingLeft:et,margin:et,marginTop:et,marginRight:et,marginBottom:et,marginLeft:et,backgroundPositionX:et,backgroundPositionY:et,...dG,zIndex:J2,fillOpacity:Jf,strokeOpacity:Jf,numOctaves:J2},fG={...l_,color:Mn,backgroundColor:Mn,outlineColor:Mn,fill:Mn,stroke:Mn,borderColor:Mn,borderTopColor:Mn,borderRightColor:Mn,borderBottomColor:Mn,borderLeftColor:Mn,filter:Yx,WebkitFilter:Yx},LM=t=>fG[t];function BM(t,e){let n=LM(t);return n!==Yx&&(n=qo),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const hG=new Set(["auto","none","0"]);function pG(t,e,n){let r=0,i;for(;r<t.length&&!i;){const a=t[r];typeof a=="string"&&!hG.has(a)&&eh(a).values.length&&(i=t[r]),r++}if(i&&n)for(const a of e)t[a]=BM(n,i)}class gG extends s_{constructor(e,n,r,i,a){super(e,n,r,i,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let d=e[u];if(typeof d=="string"&&(d=d.trim(),Zw(d))){const h=PM(d,n.current);h!==void 0&&(e[u]=h),u===e.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!jM.has(r)||e.length!==2)return;const[i,a]=e,o=Z2(i),c=Z2(a);if(o!==c)if(X2(o)&&X2(c))for(let u=0;u<e.length;u++){const d=e[u];typeof d=="string"&&(e[u]=parseFloat(d))}else ql[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,r=[];for(let i=0;i<e.length;i++)(e[i]===null||oG(e[i]))&&r.push(i);r.length&&pG(e,r,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=ql[r](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const i=n[n.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){const{element:e,name:n,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const i=e.getValue(n);i&&i.jump(this.measuredOrigin,!1);const a=r.length-1,o=r[a];r[a]=ql[n](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([c,u])=>{e.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function mG(t,e,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let r=document;const i=n?.[t]??r.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}const UM=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function FM(t){return iM(t)&&"offsetHeight"in t}const ek=30,vG=t=>!isNaN(parseFloat(t));class yG{constructor(e,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const i=Pr.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Pr.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=vG(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new Xw);const r=this.events[e].add(n);return e==="change"?()=>{r(),en.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Pr.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>ek)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,ek);return sM(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Nu(t,e){return new yG(t,e)}const{schedule:c_}=vM(queueMicrotask,!1),Gi={x:!1,y:!1};function $M(){return Gi.x||Gi.y}function bG(t){return t==="x"||t==="y"?Gi[t]?null:(Gi[t]=!0,()=>{Gi[t]=!1}):Gi.x||Gi.y?null:(Gi.x=Gi.y=!0,()=>{Gi.x=Gi.y=!1})}function GM(t,e){const n=mG(t),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[n,i,()=>r.abort()]}function tk(t){return!(t.pointerType==="touch"||$M())}function xG(t,e,n={}){const[r,i,a]=GM(t,n),o=c=>{if(!tk(c))return;const{target:u}=c,d=e(u,c);if(typeof d!="function"||!u)return;const h=p=>{tk(p)&&(d(p),u.removeEventListener("pointerleave",h))};u.addEventListener("pointerleave",h,i)};return r.forEach(c=>{c.addEventListener("pointerenter",o,i)}),a}const HM=(t,e)=>e?t===e?!0:HM(t,e.parentElement):!1,u_=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,wG=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function _G(t){return wG.has(t.tagName)||t.tabIndex!==-1}const nm=new WeakSet;function nk(t){return e=>{e.key==="Enter"&&t(e)}}function Cb(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const SG=(t,e)=>{const n=t.currentTarget;if(!n)return;const r=nk(()=>{if(nm.has(n))return;Cb(n,"down");const i=nk(()=>{Cb(n,"up")}),a=()=>Cb(n,"cancel");n.addEventListener("keyup",i,e),n.addEventListener("blur",a,e)});n.addEventListener("keydown",r,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),e)};function rk(t){return u_(t)&&!$M()}function EG(t,e,n={}){const[r,i,a]=GM(t,n),o=c=>{const u=c.currentTarget;if(!rk(c))return;nm.add(u);const d=e(u,c),h=(b,w)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",m),nm.has(u)&&nm.delete(u),rk(b)&&typeof d=="function"&&d(b,{success:w})},p=b=>{h(b,u===window||u===document||n.useGlobalTarget||HM(u,b.target))},m=b=>{h(b,!1)};window.addEventListener("pointerup",p,i),window.addEventListener("pointercancel",m,i)};return r.forEach(c=>{(n.useGlobalTarget?window:c).addEventListener("pointerdown",o,i),FM(c)&&(c.addEventListener("focus",d=>SG(d,i)),!_G(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),a}function qM(t){return iM(t)&&"ownerSVGElement"in t}function TG(t){return qM(t)&&t.tagName==="svg"}const ur=t=>!!(t&&t.getVelocity),AG=[...zM,Mn,qo],CG=t=>AG.find(VM(t)),d_=B.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function ik(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function kG(...t){return e=>{let n=!1;const r=t.map(i=>{const a=ik(i,e);return!n&&typeof a=="function"&&(n=!0),a});if(n)return()=>{for(let i=0;i<r.length;i++){const a=r[i];typeof a=="function"?a():ik(t[i],null)}}}}function RG(...t){return B.useCallback(kG(...t),t)}class NG extends B.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=n.offsetParent,i=FM(r)&&r.offsetWidth||0,a=this.props.sizeRef.current;a.height=n.offsetHeight||0,a.width=n.offsetWidth||0,a.top=n.offsetTop,a.left=n.offsetLeft,a.right=i-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function DG({children:t,isPresent:e,anchorX:n,root:r}){const i=B.useId(),a=B.useRef(null),o=B.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=B.useContext(d_),u=RG(a,t?.ref);return B.useInsertionEffect(()=>{const{width:d,height:h,top:p,left:m,right:b}=o.current;if(e||!a.current||!d||!h)return;const w=n==="left"?`left: ${m}`:`right: ${b}`;a.current.dataset.motionPopId=i;const S=document.createElement("style");c&&(S.nonce=c);const E=r??document.head;return E.appendChild(S),S.sheet&&S.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${h}px !important;
            ${w}px !important;
            top: ${p}px !important;
          }
        `),()=>{E.contains(S)&&E.removeChild(S)}},[e]),v.jsx(NG,{isPresent:e,childRef:a,sizeRef:o,children:B.cloneElement(t,{ref:u})})}const IG=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:i,presenceAffectsLayout:a,mode:o,anchorX:c,root:u})=>{const d=P0(MG),h=B.useId();let p=!0,m=B.useMemo(()=>(p=!1,{id:h,initial:e,isPresent:n,custom:i,onExitComplete:b=>{d.set(b,!0);for(const w of d.values())if(!w)return;r&&r()},register:b=>(d.set(b,!1),()=>d.delete(b))}),[n,d,r]);return a&&p&&(m={...m}),B.useMemo(()=>{d.forEach((b,w)=>d.set(w,!1))},[n]),B.useEffect(()=>{!n&&!d.size&&r&&r()},[n]),o==="popLayout"&&(t=v.jsx(DG,{isPresent:n,anchorX:c,root:u,children:t})),v.jsx(j0.Provider,{value:m,children:t})};function MG(){return new Map}function YM(t=!0){const e=B.useContext(j0);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:i}=e,a=B.useId();B.useEffect(()=>{if(t)return i(a)},[t]);const o=B.useCallback(()=>t&&r&&r(a),[a,r,t]);return!n&&r?[!1,o]:[!0]}const Ag=t=>t.key||"";function ak(t){const e=[];return B.Children.forEach(t,n=>{B.isValidElement(n)&&e.push(n)}),e}const ii=({children:t,custom:e,initial:n=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:a="sync",propagate:o=!1,anchorX:c="left",root:u})=>{const[d,h]=YM(o),p=B.useMemo(()=>ak(t),[t]),m=o&&!d?[]:p.map(Ag),b=B.useRef(!0),w=B.useRef(p),S=P0(()=>new Map),[E,T]=B.useState(p),[C,N]=B.useState(p);$w(()=>{b.current=!1,w.current=p;for(let M=0;M<C.length;M++){const A=Ag(C[M]);m.includes(A)?S.delete(A):S.get(A)!==!0&&S.set(A,!1)}},[C,m.length,m.join("-")]);const j=[];if(p!==E){let M=[...p];for(let A=0;A<C.length;A++){const k=C[A],D=Ag(k);m.includes(D)||(M.splice(A,0,k),j.push(k))}return a==="wait"&&j.length&&(M=j),N(ak(M)),T(p),null}const{forceRender:O}=B.useContext(Uw);return v.jsx(v.Fragment,{children:C.map(M=>{const A=Ag(M),k=o&&!d?!1:p===C||m.includes(A),D=()=>{if(S.has(A))S.set(A,!0);else return;let V=!0;S.forEach(L=>{L||(V=!1)}),V&&(O?.(),N(w.current),o&&h?.(),r&&r())};return v.jsx(IG,{isPresent:k,initial:!b.current||n?void 0:!1,custom:e,presenceAffectsLayout:i,mode:a,root:u,onExitComplete:k?void 0:D,anchorX:c,children:M},A)})})},XM=B.createContext({strict:!1}),sk={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Du={};for(const t in sk)Du[t]={isEnabled:e=>sk[t].some(n=>!!e[n])};function OG(t){for(const e in t)Du[e]={...Du[e],...t[e]}}const PG=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Lm(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||PG.has(t)}let WM=t=>!Lm(t);function jG(t){typeof t=="function"&&(WM=e=>e.startsWith("on")?!Lm(e):t(e))}try{jG(require("@emotion/is-prop-valid").default)}catch{}function VG(t,e,n){const r={};for(const i in t)i==="values"&&typeof t.values=="object"||(WM(i)||n===!0&&Lm(i)||!e&&!Lm(i)||t.draggable&&i.startsWith("onDrag"))&&(r[i]=t[i]);return r}const V0=B.createContext({});function z0(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function th(t){return typeof t=="string"||Array.isArray(t)}const f_=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],h_=["initial",...f_];function L0(t){return z0(t.animate)||h_.some(e=>th(t[e]))}function KM(t){return!!(L0(t)||t.variants)}function zG(t,e){if(L0(t)){const{initial:n,animate:r}=t;return{initial:n===!1||th(n)?n:void 0,animate:th(r)?r:void 0}}return t.inherit!==!1?e:{}}function LG(t){const{initial:e,animate:n}=zG(t,B.useContext(V0));return B.useMemo(()=>({initial:e,animate:n}),[ok(e),ok(n)])}function ok(t){return Array.isArray(t)?t.join(" "):t}const nh={};function BG(t){for(const e in t)nh[e]=t[e],Qw(e)&&(nh[e].isCSSVariable=!0)}function QM(t,{layout:e,layoutId:n}){return Ju.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!nh[t]||t==="opacity")}const UG={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},FG=Zu.length;function $G(t,e,n){let r="",i=!0;for(let a=0;a<FG;a++){const o=Zu[a],c=t[o];if(c===void 0)continue;let u=!0;if(typeof c=="number"?u=c===(o.startsWith("scale")?1:0):u=parseFloat(c)===0,!u||n){const d=UM(c,l_[o]);if(!u){i=!1;const h=UG[o]||o;r+=`${h}(${d}) `}n&&(e[o]=d)}}return r=r.trim(),n?r=n(e,i?"":r):i&&(r="none"),r}function p_(t,e,n){const{style:r,vars:i,transformOrigin:a}=t;let o=!1,c=!1;for(const u in e){const d=e[u];if(Ju.has(u)){o=!0;continue}else if(Qw(u)){i[u]=d;continue}else{const h=UM(d,l_[u]);u.startsWith("origin")?(c=!0,a[u]=h):r[u]=h}}if(e.transform||(o||n?r.transform=$G(e,t.transform,n):r.transform&&(r.transform="none")),c){const{originX:u="50%",originY:d="50%",originZ:h=0}=a;r.transformOrigin=`${u} ${d} ${h}`}}const g_=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function ZM(t,e,n){for(const r in e)!ur(e[r])&&!QM(r,n)&&(t[r]=e[r])}function GG({transformTemplate:t},e){return B.useMemo(()=>{const n=g_();return p_(n,e,t),Object.assign({},n.vars,n.style)},[e])}function HG(t,e){const n=t.style||{},r={};return ZM(r,n,t),Object.assign(r,GG(t,e)),r}function qG(t,e){const n={},r=HG(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}const YG={offset:"stroke-dashoffset",array:"stroke-dasharray"},XG={offset:"strokeDashoffset",array:"strokeDasharray"};function WG(t,e,n=1,r=0,i=!0){t.pathLength=1;const a=i?YG:XG;t[a.offset]=et.transform(-r);const o=et.transform(e),c=et.transform(n);t[a.array]=`${o} ${c}`}function JM(t,{attrX:e,attrY:n,attrScale:r,pathLength:i,pathSpacing:a=1,pathOffset:o=0,...c},u,d,h){if(p_(t,c,d),u){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:p,style:m}=t;p.transform&&(m.transform=p.transform,delete p.transform),(m.transform||p.transformOrigin)&&(m.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),m.transform&&(m.transformBox=h?.transformBox??"fill-box",delete p.transformBox),e!==void 0&&(p.x=e),n!==void 0&&(p.y=n),r!==void 0&&(p.scale=r),i!==void 0&&WG(p,i,a,o,!1)}const e4=()=>({...g_(),attrs:{}}),t4=t=>typeof t=="string"&&t.toLowerCase()==="svg";function KG(t,e,n,r){const i=B.useMemo(()=>{const a=e4();return JM(a,e,t4(r),t.transformTemplate,t.style),{...a.attrs,style:{...a.style}}},[e]);if(t.style){const a={};ZM(a,t.style,t),i.style={...a,...i.style}}return i}const QG=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function m_(t){return typeof t!="string"||t.includes("-")?!1:!!(QG.indexOf(t)>-1||/[A-Z]/u.test(t))}function ZG(t,e,n,{latestValues:r},i,a=!1){const c=(m_(t)?KG:qG)(e,r,i,t),u=VG(e,typeof t=="string",a),d=t!==B.Fragment?{...u,...c,ref:n}:{},{children:h}=e,p=B.useMemo(()=>ur(h)?h.get():h,[h]);return B.createElement(t,{...d,children:p})}function lk(t){const e=[{},{}];return t?.values.forEach((n,r)=>{e[0][r]=n.get(),e[1][r]=n.getVelocity()}),e}function v_(t,e,n,r){if(typeof e=="function"){const[i,a]=lk(r);e=e(n!==void 0?n:t.custom,i,a)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,a]=lk(r);e=e(n!==void 0?n:t.custom,i,a)}return e}function rm(t){return ur(t)?t.get():t}function JG({scrapeMotionValuesFromProps:t,createRenderState:e},n,r,i){return{latestValues:eH(n,r,i,t),renderState:e()}}function eH(t,e,n,r){const i={},a=r(t,{});for(const m in a)i[m]=rm(a[m]);let{initial:o,animate:c}=t;const u=L0(t),d=KM(t);e&&d&&!u&&t.inherit!==!1&&(o===void 0&&(o=e.initial),c===void 0&&(c=e.animate));let h=n?n.initial===!1:!1;h=h||o===!1;const p=h?c:o;if(p&&typeof p!="boolean"&&!z0(p)){const m=Array.isArray(p)?p:[p];for(let b=0;b<m.length;b++){const w=v_(t,m[b]);if(w){const{transitionEnd:S,transition:E,...T}=w;for(const C in T){let N=T[C];if(Array.isArray(N)){const j=h?N.length-1:0;N=N[j]}N!==null&&(i[C]=N)}for(const C in S)i[C]=S[C]}}}return i}const n4=t=>(e,n)=>{const r=B.useContext(V0),i=B.useContext(j0),a=()=>JG(t,e,r,i);return n?a():P0(a)};function y_(t,e,n){const{style:r}=t,i={};for(const a in r)(ur(r[a])||e.style&&ur(e.style[a])||QM(a,t)||n?.getValue(a)?.liveStyle!==void 0)&&(i[a]=r[a]);return i}const tH=n4({scrapeMotionValuesFromProps:y_,createRenderState:g_});function r4(t,e,n){const r=y_(t,e,n);for(const i in t)if(ur(t[i])||ur(e[i])){const a=Zu.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[a]=t[i]}return r}const nH=n4({scrapeMotionValuesFromProps:r4,createRenderState:e4}),rH=Symbol.for("motionComponentSymbol");function au(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function iH(t,e,n){return B.useCallback(r=>{r&&t.onMount&&t.onMount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):au(n)&&(n.current=r))},[e])}const b_=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),aH="framerAppearId",i4="data-"+b_(aH),a4=B.createContext({});function sH(t,e,n,r,i){const{visualElement:a}=B.useContext(V0),o=B.useContext(XM),c=B.useContext(j0),u=B.useContext(d_).reducedMotion,d=B.useRef(null);r=r||o.renderer,!d.current&&r&&(d.current=r(t,{visualState:e,parent:a,props:n,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const h=d.current,p=B.useContext(a4);h&&!h.projection&&i&&(h.type==="html"||h.type==="svg")&&oH(d.current,n,i,p);const m=B.useRef(!1);B.useInsertionEffect(()=>{h&&m.current&&h.update(n,c)});const b=n[i4],w=B.useRef(!!b&&!window.MotionHandoffIsComplete?.(b)&&window.MotionHasOptimisedAnimation?.(b));return $w(()=>{h&&(m.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),h.scheduleRenderMicrotask(),w.current&&h.animationState&&h.animationState.animateChanges())}),B.useEffect(()=>{h&&(!w.current&&h.animationState&&h.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(b)}),w.current=!1),h.enteringChildren=void 0)}),h}function oH(t,e,n,r){const{layoutId:i,layout:a,drag:o,dragConstraints:c,layoutScroll:u,layoutRoot:d,layoutCrossfade:h}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:s4(t.parent)),t.projection.setOptions({layoutId:i,layout:a,alwaysMeasureLayout:!!o||c&&au(c),visualElement:t,animationType:typeof a=="string"?a:"both",initialPromotionConfig:r,crossfade:h,layoutScroll:u,layoutRoot:d})}function s4(t){if(t)return t.options.allowProjection!==!1?t.projection:s4(t.parent)}function kb(t,{forwardMotionProps:e=!1}={},n,r){n&&OG(n);const i=m_(t)?nH:tH;function a(c,u){let d;const h={...B.useContext(d_),...c,layoutId:lH(c)},{isStatic:p}=h,m=LG(c),b=i(c,p);if(!p&&Fw){cH();const w=uH(h);d=w.MeasureLayout,m.visualElement=sH(t,b,h,r,w.ProjectionNode)}return v.jsxs(V0.Provider,{value:m,children:[d&&m.visualElement?v.jsx(d,{visualElement:m.visualElement,...h}):null,ZG(t,c,iH(b,m.visualElement,u),b,p,e)]})}a.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const o=B.forwardRef(a);return o[rH]=t,o}function lH({layoutId:t}){const e=B.useContext(Uw).id;return e&&t!==void 0?e+"-"+t:t}function cH(t,e){B.useContext(XM).strict}function uH(t){const{drag:e,layout:n}=Du;if(!e&&!n)return{};const r={...e,...n};return{MeasureLayout:e?.isEnabled(t)||n?.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function dH(t,e){if(typeof Proxy>"u")return kb;const n=new Map,r=(a,o)=>kb(a,o,t,e),i=(a,o)=>r(a,o);return new Proxy(i,{get:(a,o)=>o==="create"?r:(n.has(o)||n.set(o,kb(o,void 0,t,e)),n.get(o))})}function o4({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function fH({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function hH(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function Rb(t){return t===void 0||t===1}function Xx({scale:t,scaleX:e,scaleY:n}){return!Rb(t)||!Rb(e)||!Rb(n)}function Ml(t){return Xx(t)||l4(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function l4(t){return ck(t.x)||ck(t.y)}function ck(t){return t&&t!=="0%"}function Bm(t,e,n){const r=t-n,i=e*r;return n+i}function uk(t,e,n,r,i){return i!==void 0&&(t=Bm(t,i,r)),Bm(t,n,r)+e}function Wx(t,e=0,n=1,r,i){t.min=uk(t.min,e,n,r,i),t.max=uk(t.max,e,n,r,i)}function c4(t,{x:e,y:n}){Wx(t.x,e.translate,e.scale,e.originPoint),Wx(t.y,n.translate,n.scale,n.originPoint)}const dk=.999999999999,fk=1.0000000000001;function pH(t,e,n,r=!1){const i=n.length;if(!i)return;e.x=e.y=1;let a,o;for(let c=0;c<i;c++){a=n[c],o=a.projectionDelta;const{visualElement:u}=a.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&a.options.layoutScroll&&a.scroll&&a!==a.root&&ou(t,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,c4(t,o)),r&&Ml(a.latestValues)&&ou(t,a.latestValues))}e.x<fk&&e.x>dk&&(e.x=1),e.y<fk&&e.y>dk&&(e.y=1)}function su(t,e){t.min=t.min+e,t.max=t.max+e}function hk(t,e,n,r,i=.5){const a=sn(t.min,t.max,i);Wx(t,e,n,a,r)}function ou(t,e){hk(t.x,e.x,e.scaleX,e.scale,e.originX),hk(t.y,e.y,e.scaleY,e.scale,e.originY)}function u4(t,e){return o4(hH(t.getBoundingClientRect(),e))}function gH(t,e,n){const r=u4(t,n),{scroll:i}=e;return i&&(su(r.x,i.offset.x),su(r.y,i.offset.y)),r}const pk=()=>({translate:0,scale:1,origin:0,originPoint:0}),lu=()=>({x:pk(),y:pk()}),gk=()=>({min:0,max:0}),bn=()=>({x:gk(),y:gk()}),Kx={current:null},d4={current:!1};function mH(){if(d4.current=!0,!!Fw)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Kx.current=t.matches;t.addEventListener("change",e),e()}else Kx.current=!1}const vH=new WeakMap;function yH(t,e,n){for(const r in e){const i=e[r],a=n[r];if(ur(i))t.addValue(r,i);else if(ur(a))t.addValue(r,Nu(i,{owner:t}));else if(a!==i)if(t.hasValue(r)){const o=t.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=t.getStaticValue(r);t.addValue(r,Nu(o!==void 0?o:i,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const mk=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class bH{scrapeMotionValuesFromProps(e,n,r){return{}}constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:a,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=s_,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=Pr.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,en.render(this.render,!1,!0))};const{latestValues:u,renderState:d}=o;this.latestValues=u,this.baseTarget={...u},this.initialValues=n.initial?{...u}:{},this.renderState=d,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=c,this.blockInitialAnimation=!!a,this.isControllingVariants=L0(n),this.isVariantNode=KM(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...p}=this.scrapeMotionValuesFromProps(n,{},this);for(const m in p){const b=p[m];u[m]!==void 0&&ur(b)&&b.set(u[m])}}mount(e){this.current=e,vH.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),d4.current||mH(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Kx.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Ho(this.notifyUpdate),Ho(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Ju.has(e);r&&this.onBindTransform&&this.onBindTransform();const i=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&en.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{i(),a&&a(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Du){const n=Du[e];if(!n)continue;const{isEnabled:r,Feature:i}=n;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):bn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<mk.length;r++){const i=mk[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const a="on"+i,o=e[a];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=yH(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const r=this.values.get(e);n!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=Nu(n===null?void 0:n,{owner:this}),this.addValue(e,r)),r}readValue(e,n){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(rM(r)||aM(r))?r=parseFloat(r):!CG(r)&&qo.test(n)&&(r=BM(e,n)),this.setBaseTarget(e,ur(r)?r.get():r)),ur(r)?r.get():r}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const a=v_(this.props,n,this.presenceContext?.custom);a&&(r=a[e])}if(n&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!ur(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new Xw),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}scheduleRenderMicrotask(){c_.render(this.render)}}class f4 extends bH{constructor(){super(...arguments),this.KeyframeResolver=gG}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ur(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function h4(t,{style:e,vars:n},r,i){const a=t.style;let o;for(o in e)a[o]=e[o];i?.applyProjectionStyles(a,r);for(o in n)a.setProperty(o,n[o])}function xH(t){return window.getComputedStyle(t)}class wH extends f4{constructor(){super(...arguments),this.type="html",this.renderInstance=h4}readValueFromInstance(e,n){if(Ju.has(n))return this.projection?.isProjecting?Ux(n):O$(e,n);{const r=xH(e),i=(Qw(n)?r.getPropertyValue(n):r[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return u4(e,n)}build(e,n,r){p_(e,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,n,r){return y_(e,n,r)}}const p4=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function _H(t,e,n,r){h4(t,e,void 0,r);for(const i in e.attrs)t.setAttribute(p4.has(i)?i:b_(i),e.attrs[i])}class SH extends f4{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=bn}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Ju.has(n)){const r=LM(n);return r&&r.default||0}return n=p4.has(n)?n:b_(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,r){return r4(e,n,r)}build(e,n,r){JM(e,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,n,r,i){_H(e,n,r,i)}mount(e){this.isSVGTag=t4(e.tagName),super.mount(e)}}const EH=(t,e)=>m_(t)?new SH(e):new wH(e,{allowProjection:t!==B.Fragment});function xu(t,e,n){const r=t.getProps();return v_(r,e,n!==void 0?n:r.custom,t)}const Qx=t=>Array.isArray(t);function TH(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Nu(n))}function AH(t){return Qx(t)?t[t.length-1]||0:t}function x_(t,e){const n=xu(t,e);let{transitionEnd:r={},transition:i={},...a}=n||{};a={...a,...r};for(const o in a){const c=AH(a[o]);TH(t,o,c)}}function CH(t){return!!(ur(t)&&t.add)}function Zx(t,e){const n=t.getValue("willChange");if(CH(n))return n.add(e);if(!n&&Ns.WillChange){const r=new Ns.WillChange("auto");t.addValue("willChange",r),r.add(e)}}function g4(t){return t.props[i4]}const kH=t=>t!==null;function RH(t,{repeat:e,repeatType:n="loop"},r){const i=t.filter(kH),a=e&&n!=="loop"&&e%2===1?0:i.length-1;return i[a]}const NH={type:"spring",stiffness:500,damping:25,restSpeed:10},DH=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),IH={type:"keyframes",duration:.8},MH={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},OH=(t,{keyframes:e})=>e.length>2?IH:Ju.has(t)?t.startsWith("scale")?DH(e[1]):NH:MH;function PH({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:i,repeat:a,repeatType:o,repeatDelay:c,from:u,elapsed:d,...h}){return!!Object.keys(h).length}const w_=(t,e,n,r={},i,a)=>o=>{const c=o_(r,t)||{},u=c.delay||r.delay||0;let{elapsed:d=0}=r;d=d-ja(u);const h={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...c,delay:-d,onUpdate:m=>{e.set(m),c.onUpdate&&c.onUpdate(m)},onComplete:()=>{o(),c.onComplete&&c.onComplete()},name:t,motionValue:e,element:a?void 0:i};PH(c)||Object.assign(h,OH(t,h)),h.duration&&(h.duration=ja(h.duration)),h.repeatDelay&&(h.repeatDelay=ja(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let p=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(qx(h),h.delay===0&&(p=!0)),(Ns.instantAnimations||Ns.skipAnimations)&&(p=!0,qx(h),h.delay=0),h.allowFlatten=!c.type&&!c.ease,p&&!a&&e.get()!==void 0){const m=RH(h.keyframes,c);if(m!==void 0){en.update(()=>{h.onUpdate(m),h.onComplete()});return}}return c.isSync?new a_(h):new rG(h)};function jH({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function m4(t,e,{delay:n=0,transitionOverride:r,type:i}={}){let{transition:a=t.getDefaultTransition(),transitionEnd:o,...c}=e;r&&(a=r);const u=[],d=i&&t.animationState&&t.animationState.getState()[i];for(const h in c){const p=t.getValue(h,t.latestValues[h]??null),m=c[h];if(m===void 0||d&&jH(d,h))continue;const b={delay:n,...o_(a||{},h)},w=p.get();if(w!==void 0&&!p.isAnimating&&!Array.isArray(m)&&m===w&&!b.velocity)continue;let S=!1;if(window.MotionHandoffAnimation){const T=g4(t);if(T){const C=window.MotionHandoffAnimation(T,h,en);C!==null&&(b.startTime=C,S=!0)}}Zx(t,h),p.start(w_(h,p,m,t.shouldReduceMotion&&jM.has(h)?{type:!1}:b,t,S));const E=p.animation;E&&u.push(E)}return o&&Promise.all(u).then(()=>{en.update(()=>{o&&x_(t,o)})}),u}function v4(t,e,n,r=0,i=1){const a=Array.from(t).sort((d,h)=>d.sortNodePosition(h)).indexOf(e),o=t.size,c=(o-1)*r;return typeof n=="function"?n(a,o):i===1?a*r:c-a*r}function Jx(t,e,n={}){const r=xu(t,e,n.type==="exit"?t.presenceContext?.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(i=n.transitionOverride);const a=r?()=>Promise.all(m4(t,r,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:h,staggerDirection:p}=i;return VH(t,e,u,d,h,p,n)}:()=>Promise.resolve(),{when:c}=i;if(c){const[u,d]=c==="beforeChildren"?[a,o]:[o,a];return u().then(()=>d())}else return Promise.all([a(),o(n.delay)])}function VH(t,e,n=0,r=0,i=0,a=1,o){const c=[];for(const u of t.variantChildren)u.notify("AnimationStart",e),c.push(Jx(u,e,{...o,delay:n+(typeof r=="function"?0:r)+v4(t.variantChildren,u,r,i,a)}).then(()=>u.notify("AnimationComplete",e)));return Promise.all(c)}function y4(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(a=>Jx(t,a,n));r=Promise.all(i)}else if(typeof e=="string")r=Jx(t,e,n);else{const i=typeof e=="function"?xu(t,e,n.custom):e;r=Promise.all(m4(t,i,n))}return r.then(()=>{t.notify("AnimationComplete",e)})}function b4(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}const zH=h_.length;function x4(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?x4(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<zH;n++){const r=h_[n],i=t.props[r];(th(i)||i===!1)&&(e[r]=i)}return e}const LH=[...f_].reverse(),BH=f_.length;function UH(t){return e=>Promise.all(e.map(({animation:n,options:r})=>y4(t,n,r)))}function FH(t){let e=UH(t),n=vk(),r=!0;const i=u=>(d,h)=>{const p=xu(t,h,u==="exit"?t.presenceContext?.custom:void 0);if(p){const{transition:m,transitionEnd:b,...w}=p;d={...d,...w,...b}}return d};function a(u){e=u(t)}function o(u){const{props:d}=t,h=x4(t.parent)||{},p=[],m=new Set;let b={},w=1/0;for(let E=0;E<BH;E++){const T=LH[E],C=n[T],N=d[T]!==void 0?d[T]:h[T],j=th(N),O=T===u?C.isActive:null;O===!1&&(w=E);let M=N===h[T]&&N!==d[T]&&j;if(M&&r&&t.manuallyAnimateOnMount&&(M=!1),C.protectedKeys={...b},!C.isActive&&O===null||!N&&!C.prevProp||z0(N)||typeof N=="boolean")continue;const A=$H(C.prevProp,N);let k=A||T===u&&C.isActive&&!M&&j||E>w&&j,D=!1;const V=Array.isArray(N)?N:[N];let L=V.reduce(i(T),{});O===!1&&(L={});const{prevResolvedValues:U={}}=C,P={...U,...L},K=Q=>{k=!0,m.has(Q)&&(D=!0,m.delete(Q)),C.needsAnimating[Q]=!0;const te=t.getValue(Q);te&&(te.liveStyle=!1)};for(const Q in P){const te=L[Q],se=U[Q];if(b.hasOwnProperty(Q))continue;let G=!1;Qx(te)&&Qx(se)?G=!b4(te,se):G=te!==se,G?te!=null?K(Q):m.add(Q):te!==void 0&&m.has(Q)?K(Q):C.protectedKeys[Q]=!0}C.prevProp=N,C.prevResolvedValues=L,C.isActive&&(b={...b,...L}),r&&t.blockInitialAnimation&&(k=!1);const X=M&&A;k&&(!X||D)&&p.push(...V.map(Q=>{const te={type:T};if(typeof Q=="string"&&r&&!X&&t.manuallyAnimateOnMount&&t.parent){const{parent:se}=t,G=xu(se,Q);if(se.enteringChildren&&G){const{delayChildren:F}=G.transition||{};te.delay=v4(se.enteringChildren,t,F)}}return{animation:Q,options:te}}))}if(m.size){const E={};if(typeof d.initial!="boolean"){const T=xu(t,Array.isArray(d.initial)?d.initial[0]:d.initial);T&&T.transition&&(E.transition=T.transition)}m.forEach(T=>{const C=t.getBaseTarget(T),N=t.getValue(T);N&&(N.liveStyle=!0),E[T]=C??null}),p.push({animation:E})}let S=!!p.length;return r&&(d.initial===!1||d.initial===d.animate)&&!t.manuallyAnimateOnMount&&(S=!1),r=!1,S?e(p):Promise.resolve()}function c(u,d){if(n[u].isActive===d)return Promise.resolve();t.variantChildren?.forEach(p=>p.animationState?.setActive(u,d)),n[u].isActive=d;const h=o(u);for(const p in n)n[p].protectedKeys={};return h}return{animateChanges:o,setActive:c,setAnimateFunction:a,getState:()=>n,reset:()=>{n=vk()}}}function $H(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!b4(e,t):!1}function Dl(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function vk(){return{animate:Dl(!0),whileInView:Dl(),whileHover:Dl(),whileTap:Dl(),whileDrag:Dl(),whileFocus:Dl(),exit:Dl()}}class tl{constructor(e){this.isMounted=!1,this.node=e}update(){}}class GH extends tl{constructor(e){super(e),e.animationState||(e.animationState=FH(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();z0(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let HH=0;class qH extends tl{constructor(){super(...arguments),this.id=HH++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);n&&!e&&i.then(()=>{n(this.id)})}mount(){const{register:e,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const YH={animation:{Feature:GH},exit:{Feature:qH}};function rh(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}function Ph(t){return{point:{x:t.pageX,y:t.pageY}}}const XH=t=>e=>u_(e)&&t(e,Ph(e));function Nf(t,e,n,r){return rh(t,e,XH(n),r)}const w4=1e-4,WH=1-w4,KH=1+w4,_4=.01,QH=0-_4,ZH=0+_4;function xr(t){return t.max-t.min}function JH(t,e,n){return Math.abs(t-e)<=n}function yk(t,e,n,r=.5){t.origin=r,t.originPoint=sn(e.min,e.max,t.origin),t.scale=xr(n)/xr(e),t.translate=sn(n.min,n.max,t.origin)-t.originPoint,(t.scale>=WH&&t.scale<=KH||isNaN(t.scale))&&(t.scale=1),(t.translate>=QH&&t.translate<=ZH||isNaN(t.translate))&&(t.translate=0)}function Df(t,e,n,r){yk(t.x,e.x,n.x,r?r.originX:void 0),yk(t.y,e.y,n.y,r?r.originY:void 0)}function bk(t,e,n){t.min=n.min+e.min,t.max=t.min+xr(e)}function eq(t,e,n){bk(t.x,e.x,n.x),bk(t.y,e.y,n.y)}function xk(t,e,n){t.min=e.min-n.min,t.max=t.min+xr(e)}function If(t,e,n){xk(t.x,e.x,n.x),xk(t.y,e.y,n.y)}function _i(t){return[t("x"),t("y")]}const S4=({current:t})=>t?t.ownerDocument.defaultView:null,wk=(t,e)=>Math.abs(t-e);function tq(t,e){const n=wk(t.x,e.x),r=wk(t.y,e.y);return Math.sqrt(n**2+r**2)}class E4{constructor(e,n,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:a=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=Db(this.lastMoveEventInfo,this.history),b=this.startEvent!==null,w=tq(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!b&&!w)return;const{point:S}=m,{timestamp:E}=er;this.history.push({...S,timestamp:E});const{onStart:T,onMove:C}=this.handlers;b||(T&&T(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),C&&C(this.lastMoveEvent,m)},this.handlePointerMove=(m,b)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=Nb(b,this.transformPagePoint),en.update(this.updatePoint,!0)},this.handlePointerUp=(m,b)=>{this.end();const{onEnd:w,onSessionEnd:S,resumeAnimation:E}=this.handlers;if(this.dragSnapToOrigin&&E&&E(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=Db(m.type==="pointercancel"?this.lastMoveEventInfo:Nb(b,this.transformPagePoint),this.history);this.startEvent&&w&&w(m,T),S&&S(m,T)},!u_(e))return;this.dragSnapToOrigin=a,this.handlers=n,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=i||window;const c=Ph(e),u=Nb(c,this.transformPagePoint),{point:d}=u,{timestamp:h}=er;this.history=[{...d,timestamp:h}];const{onSessionStart:p}=n;p&&p(e,Db(u,this.history)),this.removeListeners=Ih(Nf(this.contextWindow,"pointermove",this.handlePointerMove),Nf(this.contextWindow,"pointerup",this.handlePointerUp),Nf(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Ho(this.updatePoint)}}function Nb(t,e){return e?{point:e(t.point)}:t}function _k(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Db({point:t},e){return{point:t,delta:_k(t,T4(e)),offset:_k(t,nq(e)),velocity:rq(e,.1)}}function nq(t){return t[0]}function T4(t){return t[t.length-1]}function rq(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const i=T4(t);for(;n>=0&&(r=t[n],!(i.timestamp-r.timestamp>ja(e)));)n--;if(!r)return{x:0,y:0};const a=Ti(i.timestamp-r.timestamp);if(a===0)return{x:0,y:0};const o={x:(i.x-r.x)/a,y:(i.y-r.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function iq(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?sn(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?sn(n,t,r.max):Math.min(t,n)),t}function Sk(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function aq(t,{top:e,left:n,bottom:r,right:i}){return{x:Sk(t.x,n,i),y:Sk(t.y,e,r)}}function Ek(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function sq(t,e){return{x:Ek(t.x,e.x),y:Ek(t.y,e.y)}}function oq(t,e){let n=.5;const r=xr(t),i=xr(e);return i>r?n=Zf(e.min,e.max-r,t.min):r>i&&(n=Zf(t.min,t.max-i,e.min)),Rs(0,1,n)}function lq(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const e1=.35;function cq(t=e1){return t===!1?t=0:t===!0&&(t=e1),{x:Tk(t,"left","right"),y:Tk(t,"top","bottom")}}function Tk(t,e,n){return{min:Ak(t,e),max:Ak(t,n)}}function Ak(t,e){return typeof t=="number"?t:t[e]||0}const uq=new WeakMap;class dq{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=bn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:n=!1,distanceThreshold:r}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const a=p=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Ph(p).point)},o=(p,m)=>{const{drag:b,dragPropagation:w,onDragStart:S}=this.getProps();if(b&&!w&&(this.openDragLock&&this.openDragLock(),this.openDragLock=bG(b),!this.openDragLock))return;this.latestPointerEvent=p,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),_i(T=>{let C=this.getAxisMotionValue(T).get()||0;if(Va.test(C)){const{projection:N}=this.visualElement;if(N&&N.layout){const j=N.layout.layoutBox[T];j&&(C=xr(j)*(parseFloat(C)/100))}}this.originPoint[T]=C}),S&&en.postRender(()=>S(p,m)),Zx(this.visualElement,"transform");const{animationState:E}=this.visualElement;E&&E.setActive("whileDrag",!0)},c=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m;const{dragPropagation:b,dragDirectionLock:w,onDirectionLock:S,onDrag:E}=this.getProps();if(!b&&!this.openDragLock)return;const{offset:T}=m;if(w&&this.currentDirection===null){this.currentDirection=fq(T),this.currentDirection!==null&&S&&S(this.currentDirection);return}this.updateAxis("x",m.point,T),this.updateAxis("y",m.point,T),this.visualElement.render(),E&&E(p,m)},u=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m,this.stop(p,m),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>_i(p=>this.getAnimationState(p)==="paused"&&this.getAxisMotionValue(p).animation?.play()),{dragSnapToOrigin:h}=this.getProps();this.panSession=new E4(e,{onSessionStart:a,onStart:o,onMove:c,onSessionEnd:u,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,distanceThreshold:r,contextWindow:S4(this.visualElement)})}stop(e,n){const r=e||this.latestPointerEvent,i=n||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!i||!r)return;const{velocity:o}=i;this.startAnimation(o);const{onDragEnd:c}=this.getProps();c&&en.postRender(()=>c(r,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:i}=this.getProps();if(!r||!Cg(e,i,this.currentDirection))return;const a=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=iq(o,this.constraints[e],this.elastic[e])),a.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,i=this.constraints;e&&au(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=aq(r.layoutBox,e):this.constraints=!1,this.elastic=cq(n),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&_i(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=lq(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!au(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const a=gH(r,i.root,this.visualElement.getTransformPagePoint());let o=sq(i.layout.layoutBox,a);if(n){const c=n(fH(o));this.hasMutatedConstraints=!!c,c&&(o=o4(c))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:i,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:c}=this.getProps(),u=this.constraints||{},d=_i(h=>{if(!Cg(h,n,this.currentDirection))return;let p=u&&u[h]||{};o&&(p={min:0,max:0});const m=i?200:1e6,b=i?40:1e7,w={type:"inertia",velocity:r?e[h]:0,bounceStiffness:m,bounceDamping:b,timeConstant:750,restDelta:1,restSpeed:10,...a,...p};return this.startAxisValueAnimation(h,w)});return Promise.all(d).then(c)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return Zx(this.visualElement,e),r.start(w_(e,r,0,n,this.visualElement,!1))}stopAnimation(){_i(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){_i(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[n];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){_i(n=>{const{drag:r}=this.getProps();if(!Cg(n,r,this.currentDirection))return;const{projection:i}=this.visualElement,a=this.getAxisMotionValue(n);if(i&&i.layout){const{min:o,max:c}=i.layout.layoutBox[n];a.set(e[n]-sn(o,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!au(n)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};_i(o=>{const c=this.getAxisMotionValue(o);if(c&&this.constraints!==!1){const u=c.get();i[o]=oq({min:u,max:u},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),_i(o=>{if(!Cg(o,e,null))return;const c=this.getAxisMotionValue(o),{min:u,max:d}=this.constraints[o];c.set(sn(u,d,i[o]))})}addListeners(){if(!this.visualElement.current)return;uq.set(this.visualElement,this);const e=this.visualElement.current,n=Nf(e,"pointerdown",u=>{const{drag:d,dragListener:h=!0}=this.getProps();d&&h&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();au(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,a=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),en.read(r);const o=rh(window,"resize",()=>this.scalePositionWithinConstraints()),c=i.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:d})=>{this.isDragging&&d&&(_i(h=>{const p=this.getAxisMotionValue(h);p&&(this.originPoint[h]+=u[h].translate,p.set(p.get()+u[h].translate))}),this.visualElement.render())}));return()=>{o(),n(),a(),c&&c()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:a=!1,dragElastic:o=e1,dragMomentum:c=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:i,dragConstraints:a,dragElastic:o,dragMomentum:c}}}function Cg(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function fq(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class hq extends tl{constructor(e){super(e),this.removeGroupControls=Ci,this.removeListeners=Ci,this.controls=new dq(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ci}unmount(){this.removeGroupControls(),this.removeListeners()}}const Ck=t=>(e,n)=>{t&&en.postRender(()=>t(e,n))};class pq extends tl{constructor(){super(...arguments),this.removePointerDownListener=Ci}onPointerDown(e){this.session=new E4(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:S4(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:Ck(e),onStart:Ck(n),onMove:r,onEnd:(a,o)=>{delete this.session,i&&en.postRender(()=>i(a,o))}}}mount(){this.removePointerDownListener=Nf(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const im={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function kk(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const lf={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(et.test(t))t=parseFloat(t);else return t;const n=kk(t,e.target.x),r=kk(t,e.target.y);return`${n}% ${r}%`}},gq={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,i=qo.parse(t);if(i.length>5)return r;const a=qo.createTransformer(t),o=typeof i[0]!="number"?1:0,c=n.x.scale*e.x,u=n.y.scale*e.y;i[0+o]/=c,i[1+o]/=u;const d=sn(c,u,.5);return typeof i[2+o]=="number"&&(i[2+o]/=d),typeof i[3+o]=="number"&&(i[3+o]/=d),a(i)}};let Ib=!1;class mq extends B.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:i}=this.props,{projection:a}=e;BG(vq),a&&(n.group&&n.group.add(a),r&&r.register&&i&&r.register(a),Ib&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),im.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:i,isPresent:a}=this.props,{projection:o}=r;return o&&(o.isPresent=a,Ib=!0,i||e.layoutDependency!==n||n===void 0||e.isPresent!==a?o.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?o.promote():o.relegate()||en.postRender(()=>{const c=o.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),c_.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:i}=e;Ib=!0,i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function A4(t){const[e,n]=YM(),r=B.useContext(Uw);return v.jsx(mq,{...t,layoutGroup:r,switchLayoutGroup:B.useContext(a4),isPresent:e,safeToRemove:n})}const vq={borderRadius:{...lf,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:lf,borderTopRightRadius:lf,borderBottomLeftRadius:lf,borderBottomRightRadius:lf,boxShadow:gq};function yq(t,e,n){const r=ur(t)?t:Nu(t);return r.start(w_("",r,e,n)),r.animation}const bq=(t,e)=>t.depth-e.depth;class xq{constructor(){this.children=[],this.isDirty=!1}add(e){Gw(this.children,e),this.isDirty=!0}remove(e){Hw(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(bq),this.isDirty=!1,this.children.forEach(e)}}function wq(t,e){const n=Pr.now(),r=({timestamp:i})=>{const a=i-n;a>=e&&(Ho(r),t(a-e))};return en.setup(r,!0),()=>Ho(r)}const C4=["TopLeft","TopRight","BottomLeft","BottomRight"],_q=C4.length,Rk=t=>typeof t=="string"?parseFloat(t):t,Nk=t=>typeof t=="number"||et.test(t);function Sq(t,e,n,r,i,a){i?(t.opacity=sn(0,n.opacity??1,Eq(r)),t.opacityExit=sn(e.opacity??1,0,Tq(r))):a&&(t.opacity=sn(e.opacity??1,n.opacity??1,r));for(let o=0;o<_q;o++){const c=`border${C4[o]}Radius`;let u=Dk(e,c),d=Dk(n,c);if(u===void 0&&d===void 0)continue;u||(u=0),d||(d=0),u===0||d===0||Nk(u)===Nk(d)?(t[c]=Math.max(sn(Rk(u),Rk(d),r),0),(Va.test(d)||Va.test(u))&&(t[c]+="%")):t[c]=d}(e.rotate||n.rotate)&&(t.rotate=sn(e.rotate||0,n.rotate||0,r))}function Dk(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const Eq=k4(0,.5,hM),Tq=k4(.5,.95,Ci);function k4(t,e,n){return r=>r<t?0:r>e?1:n(Zf(t,e,r))}function Ik(t,e){t.min=e.min,t.max=e.max}function yi(t,e){Ik(t.x,e.x),Ik(t.y,e.y)}function Mk(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function Ok(t,e,n,r,i){return t-=e,t=Bm(t,1/n,r),i!==void 0&&(t=Bm(t,1/i,r)),t}function Aq(t,e=0,n=1,r=.5,i,a=t,o=t){if(Va.test(e)&&(e=parseFloat(e),e=sn(o.min,o.max,e/100)-o.min),typeof e!="number")return;let c=sn(a.min,a.max,r);t===a&&(c-=e),t.min=Ok(t.min,e,n,c,i),t.max=Ok(t.max,e,n,c,i)}function Pk(t,e,[n,r,i],a,o){Aq(t,e[n],e[r],e[i],e.scale,a,o)}const Cq=["x","scaleX","originX"],kq=["y","scaleY","originY"];function jk(t,e,n,r){Pk(t.x,e,Cq,n?n.x:void 0,r?r.x:void 0),Pk(t.y,e,kq,n?n.y:void 0,r?r.y:void 0)}function Vk(t){return t.translate===0&&t.scale===1}function R4(t){return Vk(t.x)&&Vk(t.y)}function zk(t,e){return t.min===e.min&&t.max===e.max}function Rq(t,e){return zk(t.x,e.x)&&zk(t.y,e.y)}function Lk(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function N4(t,e){return Lk(t.x,e.x)&&Lk(t.y,e.y)}function Bk(t){return xr(t.x)/xr(t.y)}function Uk(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class Nq{constructor(){this.members=[]}add(e){Gw(this.members,e),e.scheduleRender()}remove(e){if(Hw(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(i=>e===i);if(n===0)return!1;let r;for(let i=n;i>=0;i--){const a=this.members[i];if(a.isPresent!==!1){r=a;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Dq(t,e,n){let r="";const i=t.x.translate/e.x,a=t.y.translate/e.y,o=n?.z||0;if((i||a||o)&&(r=`translate3d(${i}px, ${a}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:d,rotate:h,rotateX:p,rotateY:m,skewX:b,skewY:w}=n;d&&(r=`perspective(${d}px) ${r}`),h&&(r+=`rotate(${h}deg) `),p&&(r+=`rotateX(${p}deg) `),m&&(r+=`rotateY(${m}deg) `),b&&(r+=`skewX(${b}deg) `),w&&(r+=`skewY(${w}deg) `)}const c=t.x.scale*e.x,u=t.y.scale*e.y;return(c!==1||u!==1)&&(r+=`scale(${c}, ${u})`),r||"none"}const Mb=["","X","Y","Z"],Iq=1e3;let Mq=0;function Ob(t,e,n,r){const{latestValues:i}=e;i[t]&&(n[t]=i[t],e.setStaticValue(t,0),r&&(r[t]=0))}function D4(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=g4(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:i,layoutId:a}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",en,!(i||a))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&D4(r)}function I4({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},c=e?.()){this.id=Mq++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(jq),this.nodes.forEach(Bq),this.nodes.forEach(Uq),this.nodes.forEach(Vq)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new xq)}addEventListener(o,c){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Xw),this.eventHandlers.get(o).add(c)}notifyListeners(o,...c){const u=this.eventHandlers.get(o);u&&u.notify(...c)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=qM(o)&&!TG(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(u||c)&&(this.isLayoutDirty=!0),t){let h,p=0;const m=()=>this.root.updateBlockedByResize=!1;en.read(()=>{p=window.innerWidth}),t(o,()=>{const b=window.innerWidth;b!==p&&(p=b,this.root.updateBlockedByResize=!0,h&&h(),h=wq(m,250),im.hasAnimatedSinceResize&&(im.hasAnimatedSinceResize=!1,this.nodes.forEach(Gk)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:p,hasRelativeLayoutChanged:m,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const w=this.options.transition||d.getDefaultTransition()||qq,{onLayoutAnimationStart:S,onLayoutAnimationComplete:E}=d.getProps(),T=!this.targetLayout||!N4(this.targetLayout,b),C=!p&&m;if(this.options.layoutRoot||this.resumeFrom||C||p&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const N={...o_(w,"layout"),onPlay:S,onComplete:E};(d.shouldReduceMotion||this.options.layoutRoot)&&(N.delay=0,N.type=!1),this.startAnimation(N),this.setAnimationOrigin(h,C)}else p||Gk(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Ho(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Fq),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&D4(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const p=this.path[h];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:c,layout:u}=this.options;if(c===void 0&&!u)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Fk);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach($k);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(Lq),this.nodes.forEach(Oq),this.nodes.forEach(Pq)):this.nodes.forEach($k),this.clearAllSnapshots();const c=Pr.now();er.delta=Rs(0,1e3/60,c-er.timestamp),er.timestamp=c,er.isProcessing=!0,_b.update.process(er),_b.preRender.process(er),_b.render.process(er),er.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,c_.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(zq),this.sharedNodes.forEach($q)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,en.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){en.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!xr(this.snapshot.measuredBox.x)&&!xr(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=bn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(c=!1),c&&this.instance){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!R4(this.projectionDelta),u=this.getTransformTemplate(),d=u?u(this.latestValues,""):void 0,h=d!==this.prevTransformTemplateValue;o&&this.instance&&(c||Ml(this.latestValues)||h)&&(i(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const c=this.measurePageBox();let u=this.removeElementScroll(c);return o&&(u=this.removeTransform(u)),Yq(u),{animationId:this.root.animationId,measuredBox:c,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return bn();const c=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(Xq))){const{scroll:d}=this.root;d&&(su(c.x,d.offset.x),su(c.y,d.offset.y))}return c}removeElementScroll(o){const c=bn();if(yi(c,o),this.scroll?.wasRoot)return c;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:h,options:p}=d;d!==this.root&&h&&p.layoutScroll&&(h.wasRoot&&yi(c,o),su(c.x,h.offset.x),su(c.y,h.offset.y))}return c}applyTransform(o,c=!1){const u=bn();yi(u,o);for(let d=0;d<this.path.length;d++){const h=this.path[d];!c&&h.options.layoutScroll&&h.scroll&&h!==h.root&&ou(u,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Ml(h.latestValues)&&ou(u,h.latestValues)}return Ml(this.latestValues)&&ou(u,this.latestValues),u}removeTransform(o){const c=bn();yi(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];if(!d.instance||!Ml(d.latestValues))continue;Xx(d.latestValues)&&d.updateSnapshot();const h=bn(),p=d.measurePageBox();yi(h,p),jk(c,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,h)}return Ml(this.latestValues)&&jk(c,this.latestValues),c}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==er.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:p}=this.options;if(!(!this.layout||!(h||p))){if(this.resolvedRelativeTargetAt=er.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=bn(),this.relativeTargetOrigin=bn(),If(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),yi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=bn(),this.targetWithTransforms=bn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),eq(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):yi(this.target,this.layout.layoutBox),c4(this.target,this.targetDelta)):yi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=bn(),this.relativeTargetOrigin=bn(),If(this.relativeTargetOrigin,this.target,m.target),yi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||Xx(this.parent.latestValues)||l4(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const o=this.getLead(),c=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===er.timestamp&&(u=!1),u)return;const{layout:d,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||h))return;yi(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,m=this.treeScale.y;pH(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=bn());const{target:b}=o;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Mk(this.prevProjectionDelta.x,this.projectionDelta.x),Mk(this.prevProjectionDelta.y,this.projectionDelta.y)),Df(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==m||!Uk(this.projectionDelta.x,this.prevProjectionDelta.x)||!Uk(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=lu(),this.projectionDelta=lu(),this.projectionDeltaWithTransform=lu()}setAnimationOrigin(o,c=!1){const u=this.snapshot,d=u?u.latestValues:{},h={...this.latestValues},p=lu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const m=bn(),b=u?u.source:void 0,w=this.layout?this.layout.source:void 0,S=b!==w,E=this.getStack(),T=!E||E.members.length<=1,C=!!(S&&!T&&this.options.crossfade===!0&&!this.path.some(Hq));this.animationProgress=0;let N;this.mixTargetDelta=j=>{const O=j/1e3;Hk(p.x,o.x,O),Hk(p.y,o.y,O),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(If(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Gq(this.relativeTarget,this.relativeTargetOrigin,m,O),N&&Rq(this.relativeTarget,N)&&(this.isProjectionDirty=!1),N||(N=bn()),yi(N,this.relativeTarget)),S&&(this.animationValues=h,Sq(h,d,this.latestValues,O,C,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=O},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Ho(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=en.update(()=>{im.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Nu(0)),this.currentAnimation=yq(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:c=>{this.mixTargetDelta(c),o.onUpdate&&o.onUpdate(c)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Iq),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:c,target:u,layout:d,latestValues:h}=o;if(!(!c||!u||!d)){if(this!==o&&this.layout&&d&&M4(this.options.animationType,this.layout.layoutBox,d.layoutBox)){u=this.target||bn();const p=xr(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const m=xr(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+m}yi(c,u),ou(c,h),Df(this.projectionDeltaWithTransform,this.layoutCorrected,c,h)}}registerSharedNode(o,c){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Nq),this.sharedNodes.get(o).add(c);const d=c.options.initialPromotionConfig;c.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(c):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:c,preserveFollowOpacity:u}={}){const d=this.getStack();d&&d.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let c=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(c=!0),!c)return;const d={};u.z&&Ob("z",o,d,this.animationValues);for(let h=0;h<Mb.length;h++)Ob(`rotate${Mb[h]}`,o,d,this.animationValues),Ob(`skew${Mb[h]}`,o,d,this.animationValues);o.render();for(const h in d)o.setStaticValue(h,d[h]),this.animationValues&&(this.animationValues[h]=d[h]);o.scheduleRender()}applyProjectionStyles(o,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const u=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=rm(c?.pointerEvents)||"",o.transform=u?u(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=rm(c?.pointerEvents)||""),this.hasProjected&&!Ml(this.latestValues)&&(o.transform=u?u({},""):"none",this.hasProjected=!1);return}o.visibility="";const h=d.animationValues||d.latestValues;this.applyTransformsToTarget();let p=Dq(this.projectionDeltaWithTransform,this.treeScale,h);u&&(p=u(h,p)),o.transform=p;const{x:m,y:b}=this.projectionDelta;o.transformOrigin=`${m.origin*100}% ${b.origin*100}% 0`,d.animationValues?o.opacity=d===this?h.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:o.opacity=d===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const w in nh){if(h[w]===void 0)continue;const{correct:S,applyTo:E,isCSSVariable:T}=nh[w],C=p==="none"?h[w]:S(h[w],d);if(E){const N=E.length;for(let j=0;j<N;j++)o[E[j]]=C}else T?this.options.visualElement.renderState.vars[w]=C:o[w]=C}this.options.layoutId&&(o.pointerEvents=d===this?rm(c?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(Fk),this.root.sharedNodes.clear()}}}function Oq(t){t.updateLayout()}function Pq(t){const e=t.resumeFrom?.snapshot||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:r}=t.layout,{animationType:i}=t.options,a=e.source!==t.layout.source;i==="size"?_i(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=xr(p);p.min=n[h].min,p.max=p.min+m}):M4(i,e.layoutBox,n)&&_i(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=xr(n[h]);p.max=p.min+m,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+m)});const o=lu();Df(o,n,e.layoutBox);const c=lu();a?Df(c,t.applyTransform(r,!0),e.measuredBox):Df(c,n,e.layoutBox);const u=!R4(o);let d=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:p,layout:m}=h;if(p&&m){const b=bn();If(b,e.layoutBox,p.layoutBox);const w=bn();If(w,n,m.layoutBox),N4(b,w)||(d=!0),h.options.layoutRoot&&(t.relativeTarget=w,t.relativeTargetOrigin=b,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:e,delta:c,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function jq(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Vq(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function zq(t){t.clearSnapshot()}function Fk(t){t.clearMeasurements()}function $k(t){t.isLayoutDirty=!1}function Lq(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function Gk(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Bq(t){t.resolveTargetDelta()}function Uq(t){t.calcProjection()}function Fq(t){t.resetSkewAndRotation()}function $q(t){t.removeLeadSnapshot()}function Hk(t,e,n){t.translate=sn(e.translate,0,n),t.scale=sn(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function qk(t,e,n,r){t.min=sn(e.min,n.min,r),t.max=sn(e.max,n.max,r)}function Gq(t,e,n,r){qk(t.x,e.x,n.x,r),qk(t.y,e.y,n.y,r)}function Hq(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const qq={duration:.45,ease:[.4,0,.1,1]},Yk=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),Xk=Yk("applewebkit/")&&!Yk("chrome/")?Math.round:Ci;function Wk(t){t.min=Xk(t.min),t.max=Xk(t.max)}function Yq(t){Wk(t.x),Wk(t.y)}function M4(t,e,n){return t==="position"||t==="preserve-aspect"&&!JH(Bk(e),Bk(n),.2)}function Xq(t){return t!==t.root&&t.scroll?.wasRoot}const Wq=I4({attachResizeListener:(t,e)=>rh(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Pb={current:void 0},O4=I4({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Pb.current){const t=new Wq({});t.mount(window),t.setOptions({layoutScroll:!0}),Pb.current=t}return Pb.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Kq={pan:{Feature:pq},drag:{Feature:hq,ProjectionNode:O4,MeasureLayout:A4}};function Kk(t,e,n){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",n==="Start");const i="onHover"+n,a=r[i];a&&en.postRender(()=>a(e,Ph(e)))}class Qq extends tl{mount(){const{current:e}=this.node;e&&(this.unmount=xG(e,(n,r)=>(Kk(this.node,r,"Start"),i=>Kk(this.node,i,"End"))))}unmount(){}}class Zq extends tl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Ih(rh(this.node.current,"focus",()=>this.onFocus()),rh(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Qk(t,e,n){const{props:r}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",n==="Start");const i="onTap"+(n==="End"?"":n),a=r[i];a&&en.postRender(()=>a(e,Ph(e)))}class Jq extends tl{mount(){const{current:e}=this.node;e&&(this.unmount=EG(e,(n,r)=>(Qk(this.node,r,"Start"),(i,{success:a})=>Qk(this.node,i,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const t1=new WeakMap,jb=new WeakMap,eY=t=>{const e=t1.get(t.target);e&&e(t)},tY=t=>{t.forEach(eY)};function nY({root:t,...e}){const n=t||document;jb.has(n)||jb.set(n,{});const r=jb.get(n),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(tY,{root:t,...e})),r[i]}function rY(t,e,n){const r=nY(e);return t1.set(t,n),r.observe(t),()=>{t1.delete(t),r.unobserve(t)}}const iY={some:0,all:1};class aY extends tl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:i="some",once:a}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:iY[i]},c=u=>{const{isIntersecting:d}=u;if(this.isInView===d||(this.isInView=d,a&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:h,onViewportLeave:p}=this.node.getProps(),m=d?h:p;m&&m(u)};return rY(this.node.current,o,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(sY(e,n))&&this.startObserver()}unmount(){}}function sY({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const oY={inView:{Feature:aY},tap:{Feature:Jq},focus:{Feature:Zq},hover:{Feature:Qq}},lY={layout:{ProjectionNode:O4,MeasureLayout:A4}},cY={...YH,...oY,...Kq,...lY},gn=dH(cY,EH);function uY(t){t.values.forEach(e=>e.stop())}function n1(t,e){[...e].reverse().forEach(r=>{const i=t.getVariant(r);i&&x_(t,i),t.variantChildren&&t.variantChildren.forEach(a=>{n1(a,e)})})}function dY(t,e){if(Array.isArray(e))return n1(t,e);if(typeof e=="string")return n1(t,[e]);x_(t,e)}function fY(){const t=new Set,e={subscribe(n){return t.add(n),()=>void t.delete(n)},start(n,r){const i=[];return t.forEach(a=>{i.push(y4(a,n,{transitionOverride:r}))}),Promise.all(i)},set(n){return t.forEach(r=>{dY(r,n)})},stop(){t.forEach(n=>{uY(n)})},mount(){return()=>{e.stop()}}};return e}function hY(){const t=P0(fY);return $w(t.mount,[]),t}const pY=hY,oc=tw((t,e)=>({message:"",type:"neutral",isVisible:!1,undoAction:void 0,showToast:(n,r="neutral",i)=>{t({message:n,type:r,isVisible:!0,undoAction:i}),setTimeout(()=>{e().hideToast()},2e3)},hideToast:()=>{t({isVisible:!1})}})),gY=()=>{const{message:t,type:e,isVisible:n,undoAction:r,hideToast:i}=oc(),a=()=>{switch(e){case"success":return"bg-green-500 dark:bg-green-600 text-white";case"error":return"bg-red-500 dark:bg-red-600 text-white";case"neutral":default:return"bg-gray-800 dark:bg-gray-900 text-white border border-gray-200 dark:border-gray-700"}};return v.jsx(ii,{children:n&&v.jsx(gn.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-24 right-6 z-[110] max-w-xs",children:v.jsxs("div",{className:`rounded-lg shadow-lg p-3 flex items-center justify-between ${a()}`,children:[v.jsx("div",{className:"flex items-center flex-1 min-w-0",children:v.jsx("span",{className:"text-xs font-medium whitespace-pre-line pr-2",children:t})}),v.jsxs("div",{className:"flex items-center gap-1 ml-2 flex-shrink-0",children:[r&&v.jsxs("button",{onClick:()=>{r(),i()},className:"px-2 py-1 bg-white/20 hover:bg-white/30 rounded text-xs font-bold transition-colors",children:[v.jsx(ZB,{size:12,className:"inline mr-1"}),"Undo"]}),v.jsx("button",{onClick:i,className:"p-0.5 hover:bg-black/10 dark:hover:bg-white/10 rounded-full transition-colors",children:v.jsx(h0,{size:14})})]})]})})})};class Si extends B.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("ErrorBoundary caught an error:",e,n),this.setState({error:e,errorInfo:n}),this.props.onError&&this.props.onError(e,n)}componentDidUpdate(e){this.props.resetKeys&&this.props.resetOnPropsChange&&this.props.resetKeys.some((r,i)=>r!==e.resetKeys?.[i])&&this.state.hasError&&this.resetErrorBoundary()}resetErrorBoundary=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[v.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 dark:bg-red-900/30 rounded-full",children:v.jsx(yu,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white text-center mb-2",children:"Something went wrong"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-6",children:"We're sorry, but something unexpected happened. You can try refreshing or going back to the home screen."}),!1,v.jsxs("div",{className:"flex flex-col gap-3",children:[v.jsxs("button",{onClick:this.resetErrorBoundary,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors",children:[v.jsx($f,{className:"h-4 w-4"}),"Try Again"]}),v.jsxs("button",{onClick:()=>window.location.href="/#/",className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white font-medium rounded-md transition-colors",children:[v.jsx(xB,{className:"h-4 w-4"}),"Go to Home"]})]})]})}):this.props.children}}const mY=({onAddTransaction:t})=>{const e=ia(),n=ra(),[r,i]=B.useState(!1),a=B.useRef(null),o=d=>n.pathname===d;B.useEffect(()=>{const d=h=>{a.current&&!a.current.contains(h.target)&&i(!1)};if(r)return document.addEventListener("mousedown",d),document.addEventListener("touchstart",d),()=>{document.removeEventListener("mousedown",d),document.removeEventListener("touchstart",d)}},[r]);const c=[{path:"/reports",icon:v.jsx(H9,{className:"w-5 h-5"}),label:"Reports"},{path:"/analytics",icon:v.jsx(_m,{className:"w-5 h-5"}),label:"Analytics"},{path:"/budget-breakdown",icon:v.jsx(Y9,{className:"w-5 h-5"}),label:"Budget Breakdown"}],u=({path:d,icon:h,label:p})=>{const m=o(d);return v.jsxs("button",{onClick:b=>{b.stopPropagation(),e(d)},className:`
          relative group flex flex-col items-center justify-center
          w-12 h-12 rounded-2xl transition-all duration-300
          ${m?"text-blue-500 bg-blue-50 dark:bg-blue-500/20 dark:text-blue-400":"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-800"}
        `,children:[v.jsx("div",{className:`transition-transform duration-300 ${m?"scale-110":"group-hover:scale-105"}`,children:h}),v.jsx("span",{className:"sr-only",children:p}),m&&v.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-current rounded-full opacity-80"})]})};return v.jsx("div",{className:"fixed bottom-6 left-0 right-0 flex justify-center z-[100] pointer-events-none safe-area-inset-bottom",children:v.jsxs("nav",{className:`
          pointer-events-auto
          flex items-center gap-1 p-2 pl-4 pr-4
          bg-white/60 dark:bg-zinc-900/60 backdrop-blur-xl
          border border-zinc-200/30 dark:border-zinc-800/30
          rounded-full shadow-2xl shadow-zinc-900/10
          transform transition-all duration-500 ease-out
        `,onClick:d=>d.stopPropagation(),onTouchStart:d=>d.stopPropagation(),onTouchEnd:d=>d.stopPropagation(),children:[v.jsx(u,{path:"/",label:"Budget",icon:v.jsx(f0,{className:"w-6 h-6"})}),v.jsx(u,{path:"/transactions",label:"Transactions",icon:v.jsx(_B,{className:"w-6 h-6"})}),v.jsx("div",{className:"w-px h-8 bg-zinc-200 dark:bg-zinc-800 mx-2"}),v.jsx("button",{onClick:d=>{if(d.stopPropagation(),i(!1),t){t();return}e("/add-transaction")},className:`
            -mt-8 mb-2 mx-1
            group relative flex items-center justify-center
            w-16 h-16 rounded-full
            bg-blue-600 text-white
            shadow-xl shadow-blue-600/30
            hover:shadow-blue-600/50 hover:scale-105 hover:-translate-y-1
            active:scale-95 active:translate-y-0
            transition-all duration-300 cubic-bezier(0.175, 0.885, 0.32, 1.275)
          `,children:v.jsx(wh,{className:"w-8 h-8 transition-transform duration-300 group-hover:rotate-90"})}),v.jsx("div",{className:"w-px h-8 bg-zinc-200 dark:bg-zinc-800 mx-2"}),v.jsxs("div",{className:"relative",ref:a,children:[v.jsxs("button",{onClick:d=>{d.stopPropagation(),i(!r)},className:`
              relative group flex flex-col items-center justify-center
              w-12 h-12 rounded-2xl transition-all duration-300
              ${r?"text-blue-500 bg-blue-50 dark:bg-blue-500/20 dark:text-blue-400":"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-800"}
            `,children:[v.jsx("div",{className:`transition-transform duration-300 ${r?"scale-110":"group-hover:scale-105"}`,children:v.jsx(cB,{className:"w-6 h-6"})}),v.jsx("span",{className:"sr-only",children:"More"}),r&&v.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-current rounded-full opacity-80"})]}),r&&v.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-56 bg-white dark:bg-zinc-900 rounded-2xl shadow-2xl border border-zinc-200/50 dark:border-zinc-800/50 backdrop-blur-xl z-50 overflow-hidden",onClick:d=>d.stopPropagation(),onTouchStart:d=>d.stopPropagation(),onTouchEnd:d=>d.stopPropagation(),children:v.jsx("div",{className:"p-2 space-y-1",children:c.map((d,h)=>v.jsxs("button",{onClick:p=>{p.stopPropagation(),e(d.path),i(!1)},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[v.jsx("div",{className:"text-zinc-600 dark:text-zinc-400",children:d.icon}),v.jsx("span",{className:"text-sm font-medium text-zinc-900 dark:text-white",children:d.label})]},h))})})]}),v.jsx(u,{path:"/settings",label:"Settings",icon:v.jsx(UB,{className:"w-6 h-6"})})]})})};function vY(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.map(function(r){return r.split(" ").map(function(i){return i?""+t+i:""}).join(" ")}).join(" ")}function yY(t,e){return e.replace(/([^}{]*){/gm,function(n,r){return r.replace(/\.([^{,\s\d.]+)/g,"."+t+"$1")+"{"})}function ws(t,e){return function(n){n&&(t[e]=n)}}function P4(t,e,n){return function(r){r&&(t[e][n]=r)}}function Zk(t,e){return function(n){var r=n.prototype;t.forEach(function(i){e(r,i)})}}function bY(t,e){return e===void 0&&(e={}),function(n,r){t.forEach(function(i){var a=e[i]||i;a in n||(n[a]=function(){for(var o,c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];var d=(o=this[r])[i].apply(o,c);return d===this[r]?this:d})})}}var xY="function",wY="object",_Y="string",SY="number",__="undefined",j4=typeof window!==__,EY=typeof document!==__&&document,TY=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],Pn=1e-7,kg={cm:function(t){return t*96/2.54},mm:function(t){return t*96/254},in:function(t){return t*96},pt:function(t){return t*96/72},pc:function(t){return t*96/6},"%":function(t,e){return t*e/100},vw:function(t,e){return e===void 0&&(e=window.innerWidth),t/100*e},vh:function(t,e){return e===void 0&&(e=window.innerHeight),t/100*e},vmax:function(t,e){return e===void 0&&(e=Math.max(window.innerWidth,window.innerHeight)),t/100*e},vmin:function(t,e){return e===void 0&&(e=Math.min(window.innerWidth,window.innerHeight)),t/100*e}};function AY(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}function Um(t,e,n,r){return(t*r+e*n)/(n+r)}function B0(t){return typeof t===__}function ea(t){return t&&typeof t===wY}function Vn(t){return Array.isArray(t)}function Vr(t){return typeof t===_Y}function Iu(t){return typeof t===SY}function S_(t){return typeof t===xY}function CY(t,e){var n=t===""||t==" ",r=e===""||e==" ";return r&&n||t===e}function V4(t,e,n,r,i){var a=E_(t,e,n);return a?n:kY(t,e,n+1,r,i)}function E_(t,e,n){if(!t.ignore)return null;var r=e.slice(Math.max(n-3,0),n+3).join("");return new RegExp(t.ignore).exec(r)}function kY(t,e,n,r,i){for(var a=function(d){var h=e[d].trim();if(h===t.close&&!E_(t,e,d))return{value:d};var p=d,m=zr(i,function(b){var w=b.open;return w===h});if(m&&(p=V4(m,e,d,r,i)),p===-1)return o=d,"break";d=p,o=d},o,c=n;c<r;++c){var u=a(c);if(c=o,typeof u=="object")return u.value;if(u==="break")break}return-1}function T_(t,e){var n=Vr(e)?{separator:e}:e,r=n.separator,i=r===void 0?",":r,a=n.isSeparateFirst,o=n.isSeparateOnlyOpenClose,c=n.isSeparateOpenClose,u=c===void 0?o:c,d=n.openCloseCharacters,h=d===void 0?TY:d,p=h.map(function(A){var k=A.open,D=A.close;return k===D?k:k+"|"+D}).join("|"),m="(\\s*"+i+"\\s*|"+p+"|\\s+)",b=new RegExp(m,"g"),w=t.split(b).filter(function(A){return A&&A!=="undefined"}),S=w.length,E=[],T=[];function C(){return T.length?(E.push(T.join("")),T=[],!0):!1}for(var N=function(A){var k=w[A].trim(),D=A,V=zr(h,function(P){var K=P.open;return K===k}),L=zr(h,function(P){var K=P.close;return K===k});if(V){if(D=V4(V,w,A,S,h),D!==-1&&u)return C()&&a||(E.push(w.slice(A,D+1).join("")),A=D,a)?(j=A,"break"):(j=A,"continue")}else if(L&&!E_(L,w,A)){var U=AY(h);return U.splice(h.indexOf(L),1),{value:T_(t,{separator:i,isSeparateFirst:a,isSeparateOnlyOpenClose:o,isSeparateOpenClose:u,openCloseCharacters:U})}}else if(CY(k,i)&&!o)return C(),a?(j=A,"break"):(j=A,"continue");D===-1&&(D=S-1),T.push(w.slice(A,D+1).join("")),A=D,j=A},j,O=0;O<S;++O){var M=N(O);if(O=j,typeof M=="object")return M.value;if(M==="break")break}return T.length&&E.push(T.join("")),E}function Yo(t){return T_(t,"")}function Fl(t){return T_(t,",")}function z4(t){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(t);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function jh(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var n=e[1],r=e[2],i=e[3];return{prefix:n,unit:i,value:parseFloat(r)}}function RY(t){return t.replace(/[\s-_]+([^\s-_])/g,function(e,n){return n.toUpperCase()})}function am(t,e){return t.replace(/([a-z])([A-Z])/g,function(n,r,i){return""+r+e+i.toLowerCase()})}function ih(){return Date.now?Date.now():new Date().getTime()}function Ds(t,e,n){n===void 0&&(n=-1);for(var r=t.length,i=0;i<r;++i)if(e(t[i],i,t))return i;return n}function zr(t,e,n){var r=Ds(t,e);return r>-1?t[r]:n}var L4=(function(){var t=ih(),e=j4&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(n){var r=ih(),i=setTimeout(function(){n(r-t)},1e3/60);return i}})(),NY=(function(){var t=j4&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return t?t.bind(window):function(e){clearTimeout(e)}})();function Is(t){return Object.keys(t)}function DY(t){var e=Is(t);return e.map(function(n){return t[n]})}function $t(t,e){var n=jh(t),r=n.value,i=n.unit;if(ea(e)){var a=e[i];if(a){if(S_(a))return a(r);if(kg[i])return kg[i](r,a)}}else if(i==="%")return r*e/100;return kg[i]?kg[i](r):r}function r1(t,e,n){return Math.max(e,Math.min(t,n))}function Jk(t,e,n,r){return r===void 0&&(r=t[0]/t[1]),[[rt(e[0],Pn),rt(e[0]/r,Pn)],[rt(e[1]*r,Pn),rt(e[1],Pn)]].filter(function(i){return i.every(function(a,o){var c=e[o],u=rt(c,Pn);return n?a<=c||a<=u:a>=c||a>=u})})[0]||t}function B4(t,e,n,r){if(!r)return t.map(function(b,w){return r1(b,e[w],n[w])});var i=t[0],a=t[1],o=r===!0?i/a:r,c=Jk(t,e,!1,o),u=c[0],d=c[1],h=Jk(t,n,!0,o),p=h[0],m=h[1];return i<u||a<d?(i=u,a=d):(i>p||a>m)&&(i=p,a=m),[i,a]}function IY(t){for(var e=t.length,n=0,r=e-1;r>=0;--r)n+=t[r];return n}function i1(t){for(var e=t.length,n=0,r=e-1;r>=0;--r)n+=t[r];return e?n/e:0}function wn(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=Math.atan2(r,n);return i>=0?i:i+Math.PI*2}function MY(t){return[0,1].map(function(e){return i1(t.map(function(n){return n[e]}))})}function eR(t){var e=MY(t),n=wn(e,t[0]),r=wn(e,t[1]);return n<r&&r-n<Math.PI||n>r&&r-n<-Math.PI?1:-1}function _s(t,e){return Math.sqrt(Math.pow((e?e[0]:0)-t[0],2)+Math.pow((e?e[1]:0)-t[1],2))}function rt(t,e){if(!e)return t;var n=1/e;return Math.round(t/e)/n}function tR(t,e){return t.forEach(function(n,r){t[r]=rt(t[r],e)}),t}function OY(t){for(var e=[],n=0;n<t;++n)e.push(n);return e}function U4(t){return t.reduce(function(e,n){return e.concat(n)},[])}function F4(t,e){t.indexOf(e)===-1&&t.push(e)}function Un(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function $4(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function G4(t,e){if(t.classList)t.classList.remove(e);else{var n=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(n," ")}}function Jn(t,e,n,r){t.addEventListener(e,n,r)}function Ln(t,e,n,r){t.removeEventListener(e,n,r)}function ed(t){return t?.ownerDocument||EY}function A_(t){return ed(t).documentElement}function nl(t){return ed(t).body}function Oo(t){var e;return((e=t?.ownerDocument)===null||e===void 0?void 0:e.defaultView)||window}function H4(t){return t&&"postMessage"in t&&"blur"in t&&"self"in t}function td(t){return ea(t)&&t.nodeName&&t.nodeType&&"ownerDocument"in t}var PY=(function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(n){return this.values[this.keys.indexOf(n)]},e.set=function(n,r){var i=this.keys,a=this.values,o=i.indexOf(n),c=o===-1?i.length:o;i[c]=n,a[c]=r},t})(),jY=(function(){function t(){this.object={}}var e=t.prototype;return e.get=function(n){return this.object[n]},e.set=function(n,r){this.object[n]=r},t})(),VY=typeof Map=="function",zY=(function(){function t(){}var e=t.prototype;return e.connect=function(n,r){this.prev=n,this.next=r,n&&(n.next=this),r&&(r.prev=this)},e.disconnect=function(){var n=this.prev,r=this.next;n&&(n.next=r),r&&(r.prev=n)},e.getIndex=function(){for(var n=this,r=-1;n;)n=n.prev,++r;return r},t})();function LY(t,e){var n=[],r=[];return t.forEach(function(i){var a=i[0],o=i[1],c=new zY;n[a]=c,r[o]=c}),n.forEach(function(i,a){i.connect(n[a-1])}),t.filter(function(i,a){return!e[a]}).map(function(i,a){var o=i[0],c=i[1];if(o===c)return[0,0];var u=n[o],d=r[c-1],h=u.getIndex();u.disconnect(),d?u.connect(d,d.next):u.connect(void 0,n[0]);var p=u.getIndex();return[h,p]})}var BY=(function(){function t(n,r,i,a,o,c,u,d){this.prevList=n,this.list=r,this.added=i,this.removed=a,this.changed=o,this.maintained=c,this.changedBeforeAdded=u,this.fixed=d}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var n=LY(this.changedBeforeAdded,this.fixed),r=this.changed,i=[];this.cacheOrdered=n.filter(function(a,o){var c=a[0],u=a[1],d=r[o],h=d[0],p=d[1];if(c!==u)return i.push([h,p]),!0}),this.cachePureChanged=i},t})();function Vh(t,e,n){var r=VY?Map:n?jY:PY,i=n||function(C){return C},a=[],o=[],c=[],u=t.map(i),d=e.map(i),h=new r,p=new r,m=[],b=[],w={},S=[],E=0,T=0;return u.forEach(function(C,N){h.set(C,N)}),d.forEach(function(C,N){p.set(C,N)}),u.forEach(function(C,N){var j=p.get(C);typeof j>"u"?(++T,o.push(N)):w[j]=T}),d.forEach(function(C,N){var j=h.get(C);typeof j>"u"?(a.push(N),++E):(c.push([j,N]),T=w[N]||0,m.push([j-T,N-E]),b.push(N===j),j!==N&&S.push([j,N]))}),o.reverse(),new BY(t,e,a,o,S,c,m,b)}var UY=(function(){function t(n,r){n===void 0&&(n=[]),this.findKeyCallback=r,this.list=[].slice.call(n)}var e=t.prototype;return e.update=function(n){var r=[].slice.call(n),i=Vh(this.list,r,this.findKeyCallback);return this.list=r,i},t})(),a1=function(t,e){return a1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},a1(t,e)};function zh(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");a1(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Ca=function(){return Ca=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ca.apply(this,arguments)};function q4(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function nR(t,e,n){for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return t.concat(a||Array.prototype.slice.call(e))}function rR(t){var e=0;return t.map(function(n){return n==null?"$compat".concat(++e):"".concat(n)})}function Y4(t){var e=[];return t.forEach(function(n){e=e.concat(Vn(n)?Y4(n):n)}),e}function Vb(t,e){if(!e)return t;for(var n in e)B0(t[n])&&(t[n]=e[n]);return t}function Fm(t,e){if(t===e)return!1;for(var n in t)if(!(n in e))return!0;for(var n in e)if(t[n]!==e[n])return!0;return!1}function iR(t){var e=t.className,n=q4(t,["className"]);return e!=null&&(n.class=e),delete n.style,delete n.children,n}function aR(t){var e={},n={};for(var r in t)r.indexOf("on")===0?n[r]=t[r]:e[r]=t[r];return[e,n]}function U0(t){if(!t)return null;var e=t.b;return td(e)?e:U0(t.c)}function X4(t){var e=t.parentNode;e&&e.removeChild(t)}function W4(t){t.forEach(function(e){e()})}function FY(){return this.constructor(this.props,this.context)}var C_=0,F0=(function(){function t(n,r,i,a,o,c,u){u===void 0&&(u={}),this.t=n,this.d=r,this.k=i,this.i=a,this.c=o,this.ref=c,this.ps=u,this.typ="prov",this._ps=[],this._cs={},this._hyd=null,this._sel=!1}var e=t.prototype;return e.s=function(){return!0},e.u=function(n,r,i,a,o){var c=this,u=c.d,d=DY(r).filter(function(w){return w.$_req}),h=Y4(d.map(function(w){return w.$_subs})),p=zr(h,function(w){return w.d===u});if(c.b&&!Vr(i)&&!o&&!c.s(i.props,a)&&!p){var m=h.reduce(function(w,S){var E=S.d;return w[0]?w[0].d===E&&w.push(S):E>u&&w.push(S),w},[]);return m.forEach(function(w){Lh(w,w._ps,[w.o],n,r,!0)}),!1}c.o=i,c.ss(a);var b=c.ps;return Vr(i)||(c.ps=i.props,c.ref=i.ref),k_(this),c.r(n,r,c.b?b:{},a),!0},e.md=function(){this.rr()},e.ss=function(){},e.ud=function(){this.rr()},e.rr=function(){var n=this,r=n.ref,i=n.fr;r&&r(i?i.current:n.b)},t})();function K4(){return Object.__CROACT_CURRENT_INSTNACE__}function $Y(){return C_}function GY(t){C_=t}function k_(t){return Object.__CROACT_CURRENT_INSTNACE__=t,C_=0,t}var R_=(function(){function t(n,r){n===void 0&&(n={}),this.props=n,this.context=r,this.state={},this.$_timer=0,this.$_state={},this.$_subs=[],this.$_cs={}}var e=t.prototype;return e.render=function(){return null},e.shouldComponentUpdate=function(n,r){return this.props!==n||this.state!==r},e.setState=function(n,r,i){var a=this;a.$_timer||(a.$_state={}),clearTimeout(a.$_timer),a.$_timer=0,a.$_state=Ca(Ca({},a.$_state),n),i?a.$_setState(r,i):a.$_timer=window.setTimeout(function(){a.$_timer=0,a.$_setState(r,i)})},e.forceUpdate=function(n){this.setState({},n,!0)},e.componentDidMount=function(){},e.componentDidUpdate=function(n,r){},e.componentWillUnmount=function(){},e.$_setState=function(n,r){var i=[],a=this.$_p,o=Lh(a.c,[a],[a.o],i,a._cs,Ca(Ca({},this.state),this.$_state),r);o&&(n&&i.push(n),W4(i),k_(null))},t})(),Q4=(function(t){zh(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}var n=e.prototype;return n.shouldComponentUpdate=function(r,i){return Fm(this.props,r)||Fm(this.state,i)},e})(R_);function Z4(t){var e=function(n){e.current=n};return e.current=t,e}function HY(t){return t._fr=!0,t}function qY(t,e,n,r){var i,a;return!((i=t?.prototype)===null||i===void 0)&&i.render?a=new t(e,n):(a=new R_(e,n),a.constructor=t,t._fr?(r.fr=Z4(),a.render=function(){return this.constructor(this.props,r.fr)}):a.render=FY),a.$_p=r,a}var YY=(function(t){zh(e,t);function e(r,i,a,o,c,u,d){d===void 0&&(d={});var h=t.call(this,r,i,a,o,c,u,Vb(d,r.defaultProps))||this;return h.typ="comp",h._usefs=[],h._uefs=[],h._defs=[],h}var n=e.prototype;return n.s=function(r,i){var a=this.b;return a.shouldComponentUpdate(Vb(r,this.t.defaultProps),i||a.state)!==!1},n.r=function(r,i,a){var o,c,u=this,d=u.t;u.ps=Vb(u.ps,u.t.defaultProps);var h=u.ps,p=!u.b,m=d.contextType,b=u.b,w=m?.get(u);u._cs=i,p?(b=qY(d,h,w,u),u.b=b):(b.props=h,b.context=w);var S=b.state;u._usefs=[],u._uefs=[];var E=b.render();((c=(o=E?.props)===null||o===void 0?void 0:o.children)===null||c===void 0?void 0:c.length)===0&&(E.props.children=u.ps.children);var T=Ca(Ca({},i),b.$_cs);Lh(u,u._ps,E?[E]:[],r,T),p?u._uefs.push(function(){m?.register(u),b.componentDidMount()}):u._uefs.push(function(){b.componentDidUpdate(a,S)}),r.push(function(){u._usefs.forEach(function(C){C()}),p?u.md():u.ud(),u._defs=u._uefs.map(function(C){return C()})})},n.ss=function(r){var i=this.b;!i||!r||(i.state=r)},n.un=function(){var r,i=this;i._ps.forEach(function(o){o.un()});var a=i.t;(r=a.contextType)===null||r===void 0||r.unregister(i),clearTimeout(i.b.$_timer),i._defs.forEach(function(o){o&&o()}),i.b.componentWillUnmount()},e})(F0);function XY(t,e,n){var r=N_(iR(t),iR(e)),i=r.added,a=r.removed,o=r.changed;for(var c in i)n.setAttribute(c,i[c]);for(var u in o)n.setAttribute(u,o[u][1]);for(var d in a)n.removeAttribute(d)}function WY(t,e,n){var r=N_(t,e),i=r.added,a=r.removed;for(var o in a)n.e(o,!0);for(var c in i)n.e(c)}function N_(t,e){var n=Is(t),r=Is(e),i=Vh(n,r,function(u){return u}),a={},o={},c={};return i.added.forEach(function(u){var d=r[u];a[d]=e[d]}),i.removed.forEach(function(u){var d=n[u];o[d]=t[d]}),i.maintained.forEach(function(u){var d=u[0],h=n[d],p=[t[h],e[h]];t[h]!==e[h]&&(c[h]=p)}),{added:a,removed:o,changed:c}}function KY(t,e,n){var r=n.style,i=N_(t,e),a=i.added,o=i.removed,c=i.changed;for(var u in a){var d=am(u,"-");r.setProperty(d,a[u])}for(var u in c){var h=am(u,"-");r.setProperty(h,c[u][1])}for(var u in o){var p=am(u,"-");r.removeProperty(p)}}function QY(t){return t.replace(/^on/g,"").toLowerCase()}var ZY=(function(t){zh(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.typ="elem",r._es={},r._svg=!1,r}var n=e.prototype;return n.e=function(r,i){var a=this,o=a._es,c=a.b,u=QY(r);i?(Ln(c,u,o[r]),delete o[r]):(o[r]=function(d){var h,p;(p=(h=a.ps)[r])===null||p===void 0||p.call(h,d)},Jn(c,u,o[r]))},n.s=function(r){return Fm(this.ps,r)},n.r=function(r,i,a){var o,c=this,u=!c.b,d=c.ps;if(u){var h=U0(c.c),p=!1;c._svg||c.t==="svg"?p=!0:p=h&&h.ownerSVGElement,c._svg=p;var m=(o=c._hyd)===null||o===void 0?void 0:o.splice(0,1)[0],b=c.t;if(m)c._hyd=[].slice.call(m.children||[]);else{var w=ed(h);p?m=w.createElementNS("http://www.w3.org/2000/svg",b):m=w.createElement(b)}c.b=m}Lh(c,c._ps,d.children,r,i);var S=c.b,E=aR(a),T=E[0],C=E[1],N=aR(d),j=N[0],O=N[1];return XY(T,j,S),WY(C,O,c),KY(a.style||{},d.style||{},S),r.push(function(){u?c.md():c.ud()}),!0},n.un=function(){var r=this,i=r._es,a=r.b;for(var o in i)Ln(a,o,i[o]);r._ps.forEach(function(c){c.un()}),r._es={},r._sel||X4(a)},e})(F0);function ah(t){if(!t||td(t))return t;var e=t.$_p._ps;return e.length?ah(e[0].b):null}function J4(t){if(t){if(t.b&&td(t.b))return t;var e=t._ps;return e.length?J4(e[0]):null}}function Xi(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=e||{},a=i.key,o=i.ref,c=q4(i,["key","ref"]);return{type:t,key:a,ref:o,props:Ca(Ca({},c),{children:U4(n).filter(function(u){return u!=null&&u!==!1})})}}var eO=(function(t){zh(e,t);function e(r,i){i===void 0&&(i=0);var a=t.call(this,"container",i,"container",0,null)||this;return a.typ="container",a.b=r,a}var n=e.prototype;return n.r=function(){return!0},n.un=function(){},e})(F0),JY=(function(t){zh(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.typ="text",r}var n=e.prototype;return n.r=function(r){var i,a=this,o=!a.b;if(o){var c=U0(a.c),u=(i=a._hyd)===null||i===void 0?void 0:i.splice(0,1)[0];a.b=u||ed(c).createTextNode(a.t.replace("text_",""))}return r.push(function(){o?a.md():a.ud()}),!0},n.un=function(){X4(this.b)},e})(F0);function eX(t,e,n){var r=n.map(function(u){return Vr(u)?null:u.key}),i=rR(e.map(function(u){return u.k})),a=rR(r),o=Vh(i,a,function(u){return u});o.removed.forEach(function(u){e.splice(u,1)[0].un()}),o.ordered.forEach(function(u){var d=u[0],h=u[1],p=e.splice(d,1)[0];e.splice(h,0,p);var m=ah(p.b),b=ah(e[h+1]&&e[h+1].b);m&&m.parentNode.insertBefore(m,b)}),o.added.forEach(function(u){e.splice(u,0,sR(n[u],r[u],u,t))});var c=o.maintained.filter(function(u){u[0];var d=u[1],h=n[d],p=e[d],m=Vr(h)?"text_".concat(h):h.type;return m!==p.t?(p.un(),e.splice(d,1,sR(h,r[d],d,t)),!0):(p.i=d,!1)});return nR(nR([],o.added,!0),c.map(function(u){u[0];var d=u[1];return d}))}function tX(t,e){for(var n=t._ps,r=n.length,i=e.i+1;i<r;++i){var a=ah(n[i].b);if(a)return a}return null}function sR(t,e,n,r){var i=r.d+1;if(Vr(t)||Iu(t))return new JY("text_".concat(t),i,e,n,r,null,{});var a=t.type,o=typeof a=="string"?ZY:YY;return new o(a,i,e,n,r,t.ref,t.props)}function Lh(t,e,n,r,i,a,o){var c=eX(t,e,n),u=t._hyd,d=e.filter(function(p,m){return p._hyd=u,p.u(r,i,n[m],a,o)});t.typ==="container"&&t._sel&&e.forEach(function(p){var m=J4(p);m&&(m._sel=!0)}),t._hyd=null;var h=U0(t);return h&&c.reverse().forEach(function(p){var m=e[p],b=ah(m.b);if(b&&h!==b&&!b.parentNode){var w=tX(t,m);h.insertBefore(b,w)}}),d.length>0}function nX(t,e,n,r){n===void 0&&(n=e.__CROACT__),r===void 0&&(r={});var i=!!n;n||(n=new eO(e));var a=[];return Lh(n,n._ps,t?[t]:[],a,r,void 0,void 0),W4(a),k_(null),i||(e.__CROACT__=n),n}function oR(t,e,n){return!n&&t&&(n=new eO(e.parentElement),n._hyd=[e],n._sel=!0),nX(t,e,n),n}function tO(t){var e=K4(),n=e._hs||(e._hs=[]),r=$Y(),i=n[r];if(GY(r+1),i){if(!Fm(i.deps,t.deps))return i.updated=!1,i;n[r]=t}else n.push(t);return t.value=t.func(),t.updated=!0,t}function rX(t,e){var n=tO({func:t,deps:e});return n.value}function iX(t){return rX(function(){return Z4(t)},[])}function nO(t,e,n){var r=K4(),i=tO({func:function(){return t},deps:e}),a=n?r._usefs:r._uefs;i.updated?a.push(function(){return i.effect&&i.effect(),i.effect=t(),i.effect}):a.push(function(){return i.effect})}function aX(t,e,n){nO(function(){t?.(e())},n,!0)}function D_(t,e){for(var n=t.length,r=0;r<n;++r)if(e(t[r],r))return!0;return!1}function rO(t,e){for(var n=t.length,r=0;r<n;++r)if(e(t[r],r))return t[r];return null}function iO(t){var e=t;if(typeof e>"u"){if(typeof navigator>"u"||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function I_(t,e){try{return new RegExp(t,"g").exec(e)}catch{return null}}function sX(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var t=navigator.userAgentData,e=t.brands||t.uaList;return!!(e&&e.length)}function oX(t,e){var n=I_("("+t+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return n?n[3]:""}function s1(t){return t.replace(/_/g,".")}function yf(t,e){var n=null,r="-1";return D_(t,function(i){var a=I_("("+i.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!a||i.brand?!1:(n=i,r=a[3]||"-1",i.versionAlias?r=i.versionAlias:i.versionTest&&(r=oX(i.versionTest.toLowerCase(),e)||r),r=s1(r),!0)}),{preset:n,version:r}}function Rg(t,e){var n={brand:"",version:"-1"};return D_(t,function(r){var i=aO(e,r);return i?(n.brand=r.id,n.version=r.versionAlias||i.version,n.version!=="-1"):!1}),n}function aO(t,e){return rO(t,function(n){var r=n.brand;return I_(""+e.test,r.toLowerCase())})}var sO=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],oO=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],o1=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],lO=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],cO=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function uO(t){return!!yf(lO,t).preset}function lX(t){var e=iO(t),n=!!/mobi/g.exec(e),r={name:"unknown",version:"-1",majorVersion:-1,webview:uO(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},a=yf(sO,e),o=a.preset,c=a.version,u=yf(cO,e),d=u.preset,h=u.version,p=yf(oO,e);if(r.chromium=!!p.preset,r.chromiumVersion=p.version,!r.chromium){var m=yf(o1,e);r.webkit=!!m.preset,r.webkitVersion=m.version}return d&&(i.name=d.id,i.version=h,i.majorVersion=parseInt(h,10)),o&&(r.name=o.id,r.version=c,r.webview&&i.name==="ios"&&r.name!=="safari"&&(r.webview=!1)),r.majorVersion=parseInt(r.version,10),{browser:r,os:i,isMobile:n,isHints:!1}}function cX(t){var e=navigator.userAgentData,n=(e.uaList||e.brands).slice(),r=e.mobile||!1,i=n[0],a=(e.platform||navigator.platform).toLowerCase(),o={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!Rg(lO,n).brand||uO(iO())},c={name:"unknown",version:"-1",majorVersion:-1};o.webkit=!o.chromium&&D_(o1,function(m){return aO(n,m)});var u=Rg(oO,n);if(o.chromium=!!u.brand,o.chromiumVersion=u.version||"-1",!o.chromium){var d=Rg(o1,n);o.webkit=!!d.brand,o.webkitVersion=d.version||"-1"}var h=rO(cO,function(m){return new RegExp(""+m.test,"g").exec(a)});c.name=h?h.id:"";{var p=Rg(sO,n);o.name=p.brand||o.name,o.version=p.brand&&t?t.uaFullVersion:p.version}return o.webkit&&(c.name=r?"ios":"mac"),c.name==="ios"&&o.webview&&(o.version="-1"),c.version=s1(c.version),o.version=s1(o.version),c.majorVersion=parseInt(c.version,10),o.majorVersion=parseInt(o.version,10),{browser:o,os:c,isMobile:r,isHints:!0}}function uX(t){return sX()?cX():lX(t)}function dX(t,e,n,r,i,a){for(var o=0;o<i;++o){var c=n+o*i,u=r+o*i;t[c]+=t[u]*a,e[c]+=e[u]*a}}function fX(t,e,n,r,i){for(var a=0;a<i;++a){var o=n+a*i,c=r+a*i,u=t[o],d=e[o];t[o]=t[c],t[c]=u,e[o]=e[c],e[c]=d}}function hX(t,e,n,r,i){for(var a=0;a<r;++a){var o=n+a*r;t[o]/=i,e[o]/=i}}function dO(t,e,n){for(var r=t.slice(),i=0;i<n;++i)r[i*n+e-1]=0,r[(e-1)*n+i]=0;return r[(e-1)*(n+1)]=1,r}function Ua(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var n=t.slice(),r=Qt(e),i=0;i<e;++i){var a=e*i+i;if(!rt(n[a],Pn)){for(var o=i+1;o<e;++o)if(n[e*i+o]){fX(n,r,i,o,e);break}}if(!rt(n[a],Pn))return[];hX(n,r,i,e,n[a]);for(var o=0;o<e;++o){var c=o,u=o+i*e,d=n[u];!rt(d,Pn)||i===o||dX(n,r,c,i,e,-d)}}return r}function pX(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var n=[],r=0;r<e;++r)for(var i=0;i<e;++i)n[i*e+r]=t[e*r+i];return n}function fO(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var n=[],r=t[e*e-1],i=0;i<e-1;++i)n[i]=t[e*(e-1)+i]/r;return n[e-1]=0,n}function gX(t,e){for(var n=Qt(e),r=0;r<e-1;++r)n[e*(e-1)+r]=t[r]||0;return n}function Jl(t,e){for(var n=t.slice(),r=t.length;r<e-1;++r)n[r]=0;return n[e-1]=1,n}function ta(t,e,n){if(e===void 0&&(e=Math.sqrt(t.length)),e===n)return t;for(var r=Qt(n),i=Math.min(e,n),a=0;a<i-1;++a){for(var o=0;o<i-1;++o)r[a*n+o]=t[a*e+o];r[(a+1)*n-1]=t[(a+1)*e-1],r[(n-1)*n+a]=t[(e-1)*e+a]}return r[n*n-1]=t[e*e-1],r}function $m(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=Qt(t);return e.forEach(function(i){r=Gt(r,i,t)}),r}function Gt(t,e,n){n===void 0&&(n=Math.sqrt(t.length));var r=[],i=t.length/n,a=e.length/i;if(i){if(!a)return t}else return e;for(var o=0;o<n;++o)for(var c=0;c<a;++c){r[c*n+o]=0;for(var u=0;u<i;++u)r[c*n+o]+=t[u*n+o]*e[c*i+u]}return r}function At(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),i=0;i<n;++i)r[i]=r[i]+e[i];return r}function He(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),i=0;i<n;++i)r[i]=r[i]-e[i];return r}function mX(t,e){return e===void 0&&(e=t.length===6),e?[t[0],t[1],0,t[2],t[3],0,t[4],t[5],1]:t}function hO(t,e){return e===void 0&&(e=t.length===9),e?[t[0],t[1],t[3],t[4],t[6],t[7]]:t}function fr(t,e,n){n===void 0&&(n=e.length);var r=Gt(t,e,n),i=r[n-1];return r.map(function(a){return a/i})}function vX(t,e){return Gt(t,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function yX(t,e){return Gt(t,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function bX(t,e){return Gt(t,Uh(e,4))}function Ng(t,e){var n=e[0],r=n===void 0?1:n,i=e[1],a=i===void 0?1:i,o=e[2],c=o===void 0?1:o;return Gt(t,[r,0,0,0,0,a,0,0,0,0,c,0,0,0,0,1],4)}function Bh(t,e){return fr(Uh(e,3),Jl(t,3))}function zb(t,e){var n=e[0],r=n===void 0?0:n,i=e[1],a=i===void 0?0:i,o=e[2],c=o===void 0?0:o;return Gt(t,[1,0,0,0,0,1,0,0,0,0,1,0,r,a,c,1],4)}function lR(t,e){return Gt(t,e,4)}function Uh(t,e){var n=Math.cos(t),r=Math.sin(t),i=Qt(e);return i[0]=n,i[1]=r,i[e]=-r,i[e+1]=n,i}function Qt(t){for(var e=t*t,n=[],r=0;r<e;++r)n[r]=r%(t+1)?0:1;return n}function M_(t,e){for(var n=Qt(e),r=Math.min(t.length,e-1),i=0;i<r;++i)n[(e+1)*i]=t[i];return n}function ec(t,e){for(var n=Qt(e),r=Math.min(t.length,e-1),i=0;i<r;++i)n[e*(e-1)+i]=t[i];return n}function O_(t,e,n,r,i,a,o,c){var u=t[0],d=t[1],h=e[0],p=e[1],m=n[0],b=n[1],w=r[0],S=r[1],E=i[0],T=i[1],C=a[0],N=a[1],j=o[0],O=o[1],M=c[0],A=c[1],k=[u,0,h,0,m,0,w,0,d,0,p,0,b,0,S,0,1,0,1,0,1,0,1,0,0,u,0,h,0,m,0,w,0,d,0,p,0,b,0,S,0,1,0,1,0,1,0,1,-E*u,-T*u,-C*h,-N*h,-j*m,-O*m,-M*w,-A*w,-E*d,-T*d,-C*p,-N*p,-j*b,-O*b,-M*S,-A*S],D=Ua(k,8);if(!D.length)return[];var V=Gt(D,[E,T,C,N,j,O,M,A],8);return V[8]=1,ta(pX(V),3,4)}var Mf=function(){return Mf=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Mf.apply(this,arguments)};function xX(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function sh(t,e){return e===void 0&&(e=0),nu(Mu(t,e))}function wX(t,e){var n=fr(t,[e[0],e[1]||0,e[2]||0,1],4),r=n[3]||1;return[n[0]/r,n[1]/r,n[2]/r]}function nu(t){var e=xX();return t.forEach(function(n){var r=n.matrixFunction,i=n.functionValue;r&&(e=r(e,i))}),e}function Mu(t,e){e===void 0&&(e=0);var n=Vn(t)?t:Yo(t);return n.map(function(r){var i=z4(r),a=i.prefix,o=i.value,c=null,u=a,d="";if(a==="translate"||a==="translateX"||a==="translate3d"){var h=ea(e)?Mf(Mf({},e),{"o%":e["%"]}):{"%":e,"o%":e},p=Fl(o).map(function(P,K){return K===0&&"x%"in h?h["%"]=e["x%"]:K===1&&"y%"in h?h["%"]=e["y%"]:h["%"]=e["o%"],$t(P,h)}),m=p[0],b=p[1],w=b===void 0?0:b,S=p[2],E=S===void 0?0:S;c=zb,d=[m,w,E]}else if(a==="translateY"){var T=ea(e)?Mf({"%":e["y%"]},e):{"%":e},w=$t(o,T);c=zb,d=[0,w,0]}else if(a==="translateZ"){var E=parseFloat(o);c=zb,d=[0,0,E]}else if(a==="scale"||a==="scale3d"){var C=Fl(o).map(function(P){return parseFloat(P)}),N=C[0],j=C[1],O=j===void 0?N:j,M=C[2],A=M===void 0?1:M;c=Ng,d=[N,O,A]}else if(a==="scaleX"){var N=parseFloat(o);c=Ng,d=[N,1,1]}else if(a==="scaleY"){var O=parseFloat(o);c=Ng,d=[1,O,1]}else if(a==="scaleZ"){var A=parseFloat(o);c=Ng,d=[1,1,A]}else if(a==="rotate"||a==="rotateZ"||a==="rotateX"||a==="rotateY"){var k=jh(o),D=k.unit,V=k.value,L=D==="rad"?V:V*Math.PI/180;a==="rotate"||a==="rotateZ"?(u="rotateZ",c=bX):a==="rotateX"?c=vX:a==="rotateY"&&(c=yX),d=L}else if(a==="matrix3d")c=lR,d=Fl(o).map(function(P){return parseFloat(P)});else if(a==="matrix"){var U=Fl(o).map(function(P){return parseFloat(P)});c=lR,d=[U[0],U[1],0,0,U[2],U[3],0,0,0,0,1,0,U[4],U[5],0,1]}else u="";return{name:a,functionName:u,value:o,matrixFunction:c,functionValue:d}})}var l1=function(t,e){return l1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},l1(t,e)};function _X(t,e){l1(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var pO=typeof Map=="function"?void 0:(function(){var t=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++t)}})(),gO=(function(t){_X(e,t);function e(n){return n===void 0&&(n=[]),t.call(this,n,pO)||this}return e})(UY);function SX(t,e){return Vh(t,e,pO)}var c1=function(){return c1=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},c1.apply(this,arguments)};function EX(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}var $0=(function(){function t(){this._events={}}var e=t.prototype;return e.on=function(n,r){if(ea(n))for(var i in n)this.on(i,n[i]);else this._addEvent(n,r,{});return this},e.off=function(n,r){if(!n)this._events={};else if(ea(n))for(var i in n)this.off(i);else if(!r)this._events[n]=[];else{var a=this._events[n];if(a){var o=Ds(a,function(c){return c.listener===r});o>-1&&a.splice(o,1)}}return this},e.once=function(n,r){var i=this;return r&&this._addEvent(n,r,{once:!0}),new Promise(function(a){i._addEvent(n,a,{once:!0})})},e.emit=function(n,r){var i=this;r===void 0&&(r={});var a=this._events[n];if(!n||!a)return!0;var o=!1;return r.eventType=n,r.stop=function(){o=!0},r.currentTarget=this,EX(a).forEach(function(c){c.listener(r),c.once&&i.off(n,c.listener)}),!o},e.trigger=function(n,r){return r===void 0&&(r={}),this.emit(n,r)},e._addEvent=function(n,r,i){var a=this._events;a[n]=a[n]||[];var o=a[n];o.push(c1({listener:r},i))},t})();var u1=function(t,e){return u1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},u1(t,e)};function TX(t,e){u1(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var cu=function(){return cu=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},cu.apply(this,arguments)};function AX(t){var e=t.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function cR(t,e){return t.addEventListener("scroll",e),function(){t.removeEventListener("scroll",e)}}function Dg(t){if(t){if(Vr(t))return document.querySelector(t)}else return null;if(S_(t))return t();if(t instanceof Element)return t;if("current"in t)return t.current;if("value"in t)return t.value}var CX=(function(t){TX(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r._startRect=null,r._startPos=[],r._prevTime=0,r._timer=0,r._prevScrollPos=[0,0],r._isWait=!1,r._flag=!1,r._currentOptions=null,r._lock=!1,r._unregister=null,r._onScroll=function(){var i=r._currentOptions;r._lock||!i||r.emit("scrollDrag",{next:function(a){r.checkScroll({container:i.container,inputEvent:a})}})},r}var n=e.prototype;return n.dragStart=function(r,i){var a=Dg(i.container);if(!a){this._flag=!1;return}var o=0,c=0,u=0,d=0;if(a===document.body)u=window.innerWidth,d=window.innerHeight;else{var h=a.getBoundingClientRect();o=h.top,c=h.left,u=h.width,d=h.height}this._flag=!0,this._startPos=[r.clientX,r.clientY],this._startRect={top:o,left:c,width:u,height:d},this._prevScrollPos=this._getScrollPosition([0,0],i),this._currentOptions=i,this._registerScrollEvent(i)},n.drag=function(r,i){if(clearTimeout(this._timer),!!this._flag){var a=r.clientX,o=r.clientY,c=i.threshold,u=c===void 0?0:c,d=this,h=d._startRect,p=d._startPos;this._currentOptions=i;var m=[0,0];return h.top>o-u?(p[1]>h.top||o<p[1])&&(m[1]=-1):h.top+h.height<o+u&&(p[1]<h.top+h.height||o>p[1])&&(m[1]=1),h.left>a-u?(p[0]>h.left||a<p[0])&&(m[0]=-1):h.left+h.width<a+u&&(p[0]<h.left+h.width||a>p[0])&&(m[0]=1),!m[0]&&!m[1]?!1:this._continueDrag(cu(cu({},i),{direction:m,inputEvent:r,isDrag:!0}))}},n.checkScroll=function(r){var i=this;if(this._isWait)return!1;var a=r.prevScrollPos,o=a===void 0?this._prevScrollPos:a,c=r.direction,u=r.throttleTime,d=u===void 0?0:u,h=r.inputEvent,p=r.isDrag,m=this._getScrollPosition(c||[0,0],r),b=m[0]-o[0],w=m[1]-o[1],S=c||[b?Math.abs(b)/b:0,w?Math.abs(w)/w:0];return this._prevScrollPos=m,this._lock=!1,!b&&!w?!1:(this.emit("move",{offsetX:S[0]?b:0,offsetY:S[1]?w:0,inputEvent:h}),d&&p&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},d)),!0)},n.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},n._getScrollPosition=function(r,i){var a=i.container,o=i.getScrollPosition,c=o===void 0?AX:o;return c({container:Dg(a),direction:r})},n._continueDrag=function(r){var i=this,a,o=r.container,c=r.direction,u=r.throttleTime,d=r.useScroll,h=r.isDrag,p=r.inputEvent;if(!(!this._flag||h&&this._isWait)){var m=ih(),b=Math.max(u+this._prevTime-m,0);if(b>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},b),!1;this._prevTime=m;var w=this._getScrollPosition(c,r);this._prevScrollPos=w,h&&(this._isWait=!0),d||(this._lock=!0);var S={container:Dg(o),direction:c,inputEvent:p};return(a=r.requestScroll)===null||a===void 0||a.call(r,S),this.emit("scroll",S),this._isWait=!1,d||this.checkScroll(cu(cu({},r),{prevScrollPos:w,direction:c,inputEvent:p}))}},n._registerScrollEvent=function(r){this._unregisterScrollEvent();var i=r.checkScrollEvent;if(i){var a=i===!0?cR:i,o=Dg(r.container);i===!0&&(o===document.body||o===document.documentElement)?this._unregister=cR(window,this._onScroll):this._unregister=a(o,this._onScroll)}},n._unregisterScrollEvent=function(){var r;(r=this._unregister)===null||r===void 0||r.call(this),this._unregister=null},e})($0);function kX(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}function Ir(t){return rt(t,Pn)}function RX(t,e){return t.every(function(n,r){return Ir(n-e[r])===0})}function NX(t,e){return!Ir(t[0]-e[0])&&!Ir(t[1]-e[1])}function mO(t){return t.length<3?0:Math.abs(IY(t.map(function(e,n){var r=t[n+1]||t[0];return e[0]*r[1]-r[0]*e[1]})))/2}function uR(t,e){var n=e.width,r=e.height,i=e.left,a=e.top,o=tc(t),c=o.minX,u=o.minY,d=o.maxX,h=o.maxY,p=n/(d-c),m=r/(h-u);return t.map(function(b){return[i+(b[0]-c)*p,a+(b[1]-u)*m]})}function tc(t){var e=t.map(function(r){return r[0]}),n=t.map(function(r){return r[1]});return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,n),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,n)}}function d1(t,e,n){var r=t[0],i=t[1],a=tc(e),o=a.minX,c=a.maxX,u=[[o,i],[c,i]],d=Gm(u[0],u[1]),h=f1(e),p=[];if(h.forEach(function(w){var S=Gm(w[0],w[1]),E=w[0];if(RX(d,S))p.push({pos:t,line:w,type:"line"});else{var T=vO(P_(d,S),[u,w]);T.forEach(function(C){w.some(function(N){return NX(N,C)})?p.push({pos:C,line:w,type:"point"}):Ir(E[1]-i)!==0&&p.push({pos:C,line:w,type:"intersection"})})}}),zr(p,function(w){return w[0]===r}))return!0;var m=0,b={};return p.forEach(function(w){var S=w.pos,E=w.type,T=w.line;if(!(S[0]>r))if(E==="intersection")++m;else{if(E==="line")return;if(E==="point"){var C=zr(T,function(O){return O[1]!==i}),N=b[S[0]],j=C[1]>i?1:-1;N?N!==j&&++m:b[S[0]]=j}}}),m%2===1}function Gm(t,e){var n=t[0],r=t[1],i=e[0],a=e[1],o=i-n,c=a-r;Math.abs(o)<Pn&&(o=0),Math.abs(c)<Pn&&(c=0);var u=0,d=0,h=0;return o?c?(u=-c/o,d=1,h=-u*n-r):(d=1,h=-r):c&&(u=-1,h=n),[u,d,h]}function P_(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],o=e[1],c=e[2],u=n===0&&a===0,d=r===0&&o===0,h=[];if(u&&d)return[];if(u){var p=-i/r,m=-c/o;return p!==m?[]:[[-1/0,p],[1/0,p]]}else if(d){var b=-i/n,w=-c/a;return b!==w?[]:[[b,-1/0],[b,1/0]]}else if(n===0){var S=-i/r,E=-(o*S+c)/a;h=[[E,S]]}else if(a===0){var S=-c/o,E=-(r*S+i)/n;h=[[E,S]]}else if(r===0){var E=-i/n,S=-(a*E+c)/o;h=[[E,S]]}else if(o===0){var E=-c/a,S=-(n*E+i)/r;h=[[E,S]]}else{var E=(r*c-o*i)/(o*n-r*a),S=-(n*E+i)/r;h=[[E,S]]}return h.map(function(T){return[T[0],T[1]]})}function vO(t,e){var n=e.map(function(p){return[0,1].map(function(m){return[Math.min(p[0][m],p[1][m]),Math.max(p[0][m],p[1][m])]})}),r=[];if(t.length===2){var i=t[0],a=i[0],o=i[1];if(Ir(a-t[1][0])){if(!Ir(o-t[1][1])){var d=Math.max.apply(Math,n.map(function(p){return p[0][0]})),h=Math.min.apply(Math,n.map(function(p){return p[0][1]}));if(Ir(d-h)>0)return[];r=[[d,o],[h,o]]}}else{var c=Math.max.apply(Math,n.map(function(p){return p[1][0]})),u=Math.min.apply(Math,n.map(function(p){return p[1][1]}));if(Ir(c-u)>0)return[];r=[[a,c],[a,u]]}}return r.length||(r=t.filter(function(p){var m=p[0],b=p[1];return n.every(function(w){return 0<=Ir(m-w[0][0])&&0<=Ir(w[0][1]-m)&&0<=Ir(b-w[1][0])&&0<=Ir(w[1][1]-b)})})),r.map(function(p){return[Ir(p[0]),Ir(p[1])]})}function f1(t){return kX(t.slice(1),[t[0]]).map(function(e,n){return[t[n],e]})}function DX(t,e){var n=t.slice(),r=e.slice();eR(n)===-1&&n.reverse(),eR(r)===-1&&r.reverse();var i=f1(n),a=f1(r),o=i.map(function(h){return Gm(h[0],h[1])}),c=a.map(function(h){return Gm(h[0],h[1])}),u=[];o.forEach(function(h,p){var m=i[p],b=[];c.forEach(function(w,S){var E=P_(h,w),T=vO(E,[m,a[S]]);b.push.apply(b,T.map(function(C){return{index1:p,index2:S,pos:C,type:"intersection"}}))}),b.sort(function(w,S){return _s(m[0],w.pos)-_s(m[0],S.pos)}),u.push.apply(u,b),d1(m[1],r)&&u.push({index1:p,index2:-1,pos:m[1],type:"inside"})}),a.forEach(function(h,p){if(d1(h[1],n)){var m=!1,b=Ds(u,function(w){var S=w.index2;return S===p?(m=!0,!1):!!m});b===-1&&(m=!1,b=Ds(u,function(w){var S=w.index1,E=w.index2;return S===-1&&E+1===p?(m=!0,!1):!!m})),b===-1?u.push({index1:-1,index2:p,pos:h[1],type:"inside"}):u.splice(b,0,{index1:-1,index2:p,pos:h[1],type:"inside"})}});var d={};return u.filter(function(h){var p=h.pos,m=p[0]+"x"+p[1];return d[m]?!1:(d[m]=!0,!0)})}function IX(t,e){var n=DX(t,e);return n.map(function(r){var i=r.pos;return i})}function MX(t,e){var n=IX(t,e);return mO(n)}var h1=function(t,e){return h1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},h1(t,e)};function OX(t,e){h1(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Dn=function(){return Dn=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Dn.apply(this,arguments)};function PX(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=Math.atan2(r,n);return i>=0?i:i+Math.PI*2}function Lb(t){return PX([t[0].clientX,t[0].clientY],[t[1].clientX,t[1].clientY])/Math.PI*180}function jX(t){return t.touches&&t.touches.length>=2}function Ig(t){return t?t.touches?zX(t.touches):[yO(t)]:[]}function VX(t){return t&&(t.type.indexOf("mouse")>-1||"button"in t)}function dR(t,e,n){var r=n.length,i=Of(t,r),a=i.clientX,o=i.clientY,c=i.originalClientX,u=i.originalClientY,d=Of(e,r),h=d.clientX,p=d.clientY,m=Of(n,r),b=m.clientX,w=m.clientY,S=a-h,E=o-p,T=a-b,C=o-w;return{clientX:c,clientY:u,deltaX:S,deltaY:E,distX:T,distY:C}}function Bb(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function zX(t){for(var e=Math.min(t.length,2),n=[],r=0;r<e;++r)n.push(yO(t[r]));return n}function yO(t){return{clientX:t.clientX,clientY:t.clientY}}function Of(t,e){e===void 0&&(e=t.length);for(var n={clientX:0,clientY:0,originalClientX:0,originalClientY:0},r=Math.min(t.length,e),i=0;i<r;++i){var a=t[i];n.originalClientX+="originalClientX"in a?a.originalClientX:a.clientX,n.originalClientY+="originalClientY"in a?a.originalClientY:a.clientY,n.clientX+=a.clientX,n.clientY+=a.clientY}return e?{clientX:n.clientX/e,clientY:n.clientY/e,originalClientX:n.originalClientX/e,originalClientY:n.originalClientY/e}:n}var Ub=(function(){function t(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return t.prototype.getAngle=function(e){return e===void 0&&(e=this.prevClients),Lb(e)},t.prototype.getRotation=function(e){return e===void 0&&(e=this.prevClients),Lb(e)-Lb(this.startClients)},t.prototype.getPosition=function(e,n){e===void 0&&(e=this.prevClients);var r=dR(e||this.prevClients,this.prevClients,this.startClients),i=r.deltaX,a=r.deltaY;return this.movement+=Math.sqrt(i*i+a*a),this.prevClients=e,r},t.prototype.getPositions=function(e){e===void 0&&(e=this.prevClients);for(var n=this.prevClients,r=this.startClients,i=Math.min(this.length,n.length),a=[],o=0;o<i;++o)a[o]=dR([e[o]],[n[o]],[r[o]]);return a},t.prototype.getMovement=function(e){var n=this.movement;if(!e)return n;var r=Of(e,this.length),i=Of(this.prevClients,this.length),a=r.clientX-i.clientX,o=r.clientY-i.clientY;return Math.sqrt(a*a+o*o)+n},t.prototype.getDistance=function(e){return e===void 0&&(e=this.prevClients),Bb(e)},t.prototype.getScale=function(e){return e===void 0&&(e=this.prevClients),Bb(e)/Bb(this.startClients)},t.prototype.move=function(e,n){this.startClients.forEach(function(r){r.clientX-=e,r.clientY-=n}),this.prevClients.forEach(function(r){r.clientX-=e,r.clientY-=n})},t})(),fR=["textarea","input"],LX=(function(t){OX(e,t);function e(n,r){r===void 0&&(r={});var i=t.call(this)||this;i.options={},i.flag=!1,i.pinchFlag=!1,i.data={},i.isDrag=!1,i.isPinch=!1,i.clientStores=[],i.targets=[],i.prevTime=0,i.doubleFlag=!1,i._useMouse=!1,i._useTouch=!1,i._useDrag=!1,i._dragFlag=!1,i._isTrusted=!1,i._isMouseEvent=!1,i._isSecondaryButton=!1,i._preventMouseEvent=!1,i._prevInputEvent=null,i._isDragAPI=!1,i._isIdle=!0,i._preventMouseEventId=0,i._window=window,i.onDragStart=function(m,b){if(b===void 0&&(b=!0),!(!i.flag&&m.cancelable===!1)){var w=m.type.indexOf("drag")>=-1;if(!(i.flag&&w)){i._isDragAPI=!0;var S=i.options,E=S.container,T=S.pinchOutside,C=S.preventWheelClick,N=S.preventRightClick,j=S.preventDefault,O=S.checkInput,M=S.dragFocusedInput,A=S.preventClickEventOnDragStart,k=S.preventClickEventOnDrag,D=S.preventClickEventByCondition,V=i._useTouch,L=!i.flag;if(i._isSecondaryButton=m.which===3||m.button===2,C&&(m.which===2||m.button===1)||N&&(m.which===3||m.button===2))return i.stop(),!1;if(L){var U=i._window.document.activeElement,P=m.target;if(P){var K=P.tagName.toLowerCase(),X=fR.indexOf(K)>-1,q=P.isContentEditable;if(X||q){if(O||!M&&U===P)return!1;if(U&&(U===P||q&&U.isContentEditable&&U.contains(P)))if(M)P.blur();else return!1}else if((j||m.type==="touchstart")&&U){var Q=U.tagName.toLowerCase();(U.isContentEditable||fR.indexOf(Q)>-1)&&U.blur()}(A||k||D)&&Jn(i._window,"click",i._onClick,!0)}i.clientStores=[new Ub(Ig(m))],i._isIdle=!1,i.flag=!0,i.isDrag=!1,i._isTrusted=b,i._dragFlag=!0,i._prevInputEvent=m,i.data={},i.doubleFlag=ih()-i.prevTime<200,i._isMouseEvent=VX(m),!i._isMouseEvent&&i._preventMouseEvent&&i._allowMouseEvent();var te=i._preventMouseEvent||i.emit("dragStart",Dn(Dn({data:i.data,datas:i.data,inputEvent:m,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,isTrusted:b,isDouble:i.doubleFlag},i.getCurrentStore().getPosition()),{preventDefault:function(){m.preventDefault()},preventDrag:function(){i._dragFlag=!1}}));te===!1&&i.stop(),i._isMouseEvent&&i.flag&&j&&m.preventDefault()}if(!i.flag)return!1;var se=0;if(L?(i._attchDragEvent(),V&&T&&(se=setTimeout(function(){Jn(E,"touchstart",i.onDragStart,{passive:!1})}))):V&&T&&Ln(E,"touchstart",i.onDragStart),i.flag&&jX(m)){if(clearTimeout(se),L&&m.touches.length!==m.changedTouches.length)return;i.pinchFlag||i.onPinchStart(m)}}}},i.onDrag=function(m,b){if(i.flag){var w=i.options.preventDefault;!i._isMouseEvent&&w&&m.preventDefault(),i._prevInputEvent=m;var S=Ig(m),E=i.moveClients(S,m,!1);if(i._dragFlag){if(i.pinchFlag||E.deltaX||E.deltaY){var T=i._preventMouseEvent||i.emit("drag",Dn(Dn({},E),{isScroll:!!b,inputEvent:m}));if(T===!1){i.stop();return}}i.pinchFlag&&i.onPinch(m,S)}i.getCurrentStore().getPosition(S,!0)}},i.onDragEnd=function(m){if(i.flag){var b=i.options,w=b.pinchOutside,S=b.container,E=b.preventClickEventOnDrag,T=b.preventClickEventOnDragStart,C=b.preventClickEventByCondition,N=i.isDrag;(E||T||C)&&requestAnimationFrame(function(){i._allowClickEvent()}),!C&&!T&&E&&!N&&i._allowClickEvent(),i._useTouch&&w&&Ln(S,"touchstart",i.onDragStart),i.pinchFlag&&i.onPinchEnd(m);var j=m?.touches?Ig(m):[],O=j.length;O===0||!i.options.keepDragging?i.flag=!1:i._addStore(new Ub(j));var M=i._getPosition(),A=ih(),k=!N&&i.doubleFlag;i._prevInputEvent=null,i.prevTime=N||k?0:A,i.flag||(i._dettachDragEvent(),i._preventMouseEvent||i.emit("dragEnd",Dn({data:i.data,datas:i.data,isDouble:k,isDrag:N,isClick:!N,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,inputEvent:m,isTrusted:i._isTrusted},M)),i.clientStores=[],i._isMouseEvent||(i._preventMouseEvent=!0,clearTimeout(i._preventMouseEventId),i._preventMouseEventId=setTimeout(function(){i._preventMouseEvent=!1},200)),i._isIdle=!0)}},i.onBlur=function(){i.onDragEnd()},i._allowClickEvent=function(){Ln(i._window,"click",i._onClick,!0)},i._onClick=function(m){i._allowClickEvent(),i._allowMouseEvent();var b=i.options.preventClickEventByCondition;b?.(m)||(m.stopPropagation(),m.preventDefault())},i._onContextMenu=function(m){var b=i.options;b.preventRightClick?i.onDragEnd(m):m.preventDefault()},i._passCallback=function(){};var a=[].concat(n),o=a[0];i._window=H4(o)?o:Oo(o),i.options=Dn({checkInput:!1,container:o&&!("document"in o)?Oo(o):o,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},r);var c=i.options,u=c.container,d=c.events,h=c.checkWindowBlur;if(i._useDrag=d.indexOf("drag")>-1,i._useTouch=d.indexOf("touch")>-1,i._useMouse=d.indexOf("mouse")>-1,i.targets=a,i._useDrag&&a.forEach(function(m){Jn(m,"dragstart",i.onDragStart)}),i._useMouse&&(a.forEach(function(m){Jn(m,"mousedown",i.onDragStart),Jn(m,"mousemove",i._passCallback)}),Jn(u,"contextmenu",i._onContextMenu)),h&&Jn(Oo(),"blur",i.onBlur),i._useTouch){var p={passive:!1};a.forEach(function(m){Jn(m,"touchstart",i.onDragStart,p),Jn(m,"touchmove",i._passCallback,p)})}return i}return e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(n){return this.getCurrentStore().getMovement(n)+this.clientStores.slice(1).reduce(function(r,i){return r+i.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(n,r,i,a){a===void 0&&(a=!0),this.flag&&(this.clientStores[0].move(n,r),a&&this.onDrag(i,!0))},e.prototype.move=function(n,r){var i=n[0],a=n[1],o=this.getCurrentStore(),c=o.prevClients;return this.moveClients(c.map(function(u){var d=u.clientX,h=u.clientY;return{clientX:d+i,clientY:h+a,originalClientX:d,originalClientY:h}}),r,!0)},e.prototype.triggerDragStart=function(n){this.onDragStart(n,!1)},e.prototype.setEventData=function(n){var r=this.data;for(var i in n)r[i]=n[i];return this},e.prototype.setEventDatas=function(n){return this.setEventData(n)},e.prototype.getCurrentEvent=function(n){return n===void 0&&(n=this._prevInputEvent),Dn(Dn({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:n})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var n=this,r=this.targets,i=this.options.container;this.off(),Ln(this._window,"blur",this.onBlur),this._useDrag&&r.forEach(function(a){Ln(a,"dragstart",n.onDragStart)}),this._useMouse&&(r.forEach(function(a){Ln(a,"mousedown",n.onDragStart)}),Ln(i,"contextmenu",this._onContextMenu)),this._useTouch&&(r.forEach(function(a){Ln(a,"touchstart",n.onDragStart)}),Ln(i,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(n){var r=this,i=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>i)){var a=new Ub(Ig(n));this.pinchFlag=!0,this._addStore(a);var o=this.emit("pinchStart",Dn(Dn({data:this.data,datas:this.data,angle:a.getAngle(),touches:this.getCurrentStore().getPositions()},a.getPosition()),{inputEvent:n,isTrusted:this._isTrusted,preventDefault:function(){n.preventDefault()},preventDrag:function(){r._dragFlag=!1}}));o===!1&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(n,r){if(!(!this.flag||!this.pinchFlag||r.length<2)){var i=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",Dn(Dn({data:this.data,datas:this.data,movement:this.getMovement(r),angle:i.getAngle(r),rotation:i.getRotation(r),touches:i.getPositions(r),scale:i.getScale(r),distance:i.getDistance(r)},i.getPosition(r)),{inputEvent:n,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(n){if(this.pinchFlag){var r=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var i=this.getCurrentStore();this.emit("pinchEnd",Dn(Dn({data:this.data,datas:this.data,isPinch:r,touches:i.getPositions()},i.getPosition()),{inputEvent:n}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(n,r,i){var a=this._getPosition(n,i),o=this.isDrag;(a.deltaX||a.deltaY)&&(this.isDrag=!0);var c=!1;return!o&&this.isDrag&&(c=!0),Dn(Dn({data:this.data,datas:this.data},a),{movement:this.getMovement(n),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:r,isTrusted:this._isTrusted,isFirstDrag:c})},e.prototype._addStore=function(n){this.clientStores.splice(0,0,n)},e.prototype._getPosition=function(n,r){var i=this.getCurrentStore(),a=i.getPosition(n,r),o=this.clientStores.slice(1).reduce(function(d,h){var p=h.getPosition();return d.distX+=p.distX,d.distY+=p.distY,d},a),c=o.distX,u=o.distY;return Dn(Dn({},a),{distX:c,distY:u})},e.prototype._attchDragEvent=function(){var n=this._window,r=this.options.container,i={passive:!1};this._isDragAPI&&(Jn(r,"dragover",this.onDrag,i),Jn(n,"dragend",this.onDragEnd)),this._useMouse&&(Jn(r,"mousemove",this.onDrag),Jn(n,"mouseup",this.onDragEnd)),this._useTouch&&(Jn(r,"touchmove",this.onDrag,i),Jn(n,"touchend",this.onDragEnd,i),Jn(n,"touchcancel",this.onDragEnd,i))},e.prototype._dettachDragEvent=function(){var n=this._window,r=this.options.container;this._isDragAPI&&(Ln(r,"dragover",this.onDrag),Ln(n,"dragend",this.onDragEnd)),this._useMouse&&(Ln(r,"mousemove",this.onDrag),Ln(n,"mouseup",this.onDragEnd)),this._useTouch&&(Ln(r,"touchstart",this.onDragStart),Ln(r,"touchmove",this.onDrag),Ln(n,"touchend",this.onDragEnd),Ln(n,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e})($0);function BX(t){for(var e=5381,n=t.length;n;)e=e*33^t.charCodeAt(--n);return e>>>0}var UX=BX;function FX(t){return UX(t).toString(36)}function $X(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function GX(t,e,n){return n.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(r,i){var a=i.trim();return(a?Fl(a):[""]).map(function(o){var c=o.trim();return c.indexOf("@")===0?c:c.indexOf(":global")>-1?c.replace(/\:global/g,""):c.indexOf(":host")>-1?"".concat(c.replace(/\:host/g,".".concat(t))):c?".".concat(t," ").concat(c):".".concat(t)}).join(", ")+" {"})}function HX(t,e,n,r,i){var a=ed(r),o=a.createElement("style");return o.setAttribute("type","text/css"),o.setAttribute("data-styled-id",t),o.setAttribute("data-styled-count","1"),n.nonce&&o.setAttribute("nonce",n.nonce),o.innerHTML=GX(t,e,n),(i||a.head||a.body).appendChild(o),o}function qX(t){var e="rCS"+FX(t);return{className:e,inject:function(n,r){r===void 0&&(r={});var i=$X(n),a=(i||n.ownerDocument||document).querySelector('style[data-styled-id="'.concat(e,'"]'));if(!a)a=HX(e,t,r,n,i);else{var o=parseFloat(a.getAttribute("data-styled-count"))||0;a.setAttribute("data-styled-count","".concat(o+1))}return{destroy:function(){var c,u=parseFloat(a.getAttribute("data-styled-count"))||0;u<=1?(a.remove?a.remove():(c=a.parentNode)===null||c===void 0||c.removeChild(a),a=null):a.setAttribute("data-styled-count","".concat(u-1))}}}}}var p1=function(){return p1=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},p1.apply(this,arguments)};function YX(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function bO(t,e){var n=qX(e),r=n.className;return HY(function(i,a){var o=i.className,c=o===void 0?"":o;i.cspNonce;var u=YX(i,["className","cspNonce"]),d=iX();return aX(a,function(){return d.current},[]),nO(function(){var h=n.inject(d.current,{nonce:i.cspNonce});return function(){h.destroy()}},[]),Xi(t,p1({ref:d,"data-styled-id":r,className:"".concat(c," ").concat(r)},u))})}var g1=function(t,e){return g1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},g1(t,e)};function Fh(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");g1(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var ee=function(){return ee=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ee.apply(this,arguments)};function XX(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function WX(t,e,n,r){var i=arguments.length,a=i<3?e:r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}function KX(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ne(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function Ce(t,e,n){if(arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return t.concat(a||Array.prototype.slice.call(e))}function $h(t,e){return ee({events:[],props:[],name:t},e)}var QX=["n","w","s","e"],j_=["n","w","s","e","nw","ne","sw","se"];function ZX(t,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*t,'px" height="').concat(32*t,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}function JX(t){var e=ZX(1,t),n=Math.round(t/45)*45%180,r="ns-resize";return n===135?r="nwse-resize":n===45?r="nesw-resize":n===90&&(r="ew-resize"),"cursor:".concat(r,";cursor: url('").concat(e,"') 16 16, ").concat(r,";")}var nd=uX(),xO=nd.browser.webkit,wO=xO&&(function(){var t=typeof window>"u"?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(t.userAgent.toLowerCase());return e?parseFloat(e[1])<605:!1})(),_O=nd.browser.name,SO=parseInt(nd.browser.version,10),eW=_O==="chrome",tW=nd.browser.chromium,nW=parseInt(nd.browser.chromiumVersion,10)||0,rW=eW&&SO>=109||tW&&nW>=109,iW=_O==="firefox",aW=parseInt(nd.browser.webkitVersion,10)>=612||SO>=15,V_="moveable-",sW=j_.map(function(t){var e="",n="",r="center",i="center",a="calc(var(--moveable-control-padding, 20) * -1px)";return t.indexOf("n")>-1&&(e="top: ".concat(a,";"),i="bottom"),t.indexOf("s")>-1&&(e="top: 0px;",i="top"),t.indexOf("w")>-1&&(n="left: ".concat(a,";"),r="right"),t.indexOf("e")>-1&&(n="left: 0px;",r="left"),'.around-control[data-direction*="'.concat(t,`"] {
        `).concat(n).concat(e,`
        transform-origin: `).concat(r," ").concat(i,`;
    }`)}).join(`
`),oW=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(sW,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(t){return`
.direction[data-rotation="`.concat(t,'"], :global .view-control-rotation').concat(t,` {
`).concat(JX(t),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(wO?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),lW=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],m1=1e-4,Er=1e-7,Mg=1e-9,v1=Math.pow(10,10),hR=-v1,cW={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},z_={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},EO={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},TO=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function Gh(t,e,n,r,i,a){var o,c;a===void 0&&(a="draggable");var u=(c=(o=e.gestos[a])===null||o===void 0?void 0:o.move(n,t.inputEvent))!==null&&c!==void 0?c:{},d=u.originalDatas||u.datas,h=d[a]||(d[a]={});return ee(ee({},u),{isPinch:!!r,parentEvent:!0,datas:h,originalDatas:t.originalDatas})}var Ou=(function(){function t(e){var n;e===void 0&&(e="draggable"),this.ableName=e,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(n={},n[e]={},n)}return t.prototype.dragStart=function(e,n){this.isDrag=!1,this.isFlag=!1;var r=n.originalDatas;return this.datas=r,r[this.ableName]||(r[this.ableName]={}),ee(ee({},this.move(e,n.inputEvent)),{type:"dragstart"})},t.prototype.drag=function(e,n){return this.move([e[0]-this.prevX,e[1]-this.prevY],n)},t.prototype.move=function(e,n){var r,i,a=!1;if(!this.isFlag)this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],r=e[0],i=e[1],this.isFlag=!0;else{var o=this.isDrag;r=this.prevX+e[0],i=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!o&&this.isDrag&&(a=!0)}return this.prevX=r,this.prevY=i,{type:"drag",clientX:r,clientY:i,inputEvent:n,isFirstDrag:a,isDrag:this.isDrag,distX:r-this.startX,distY:i-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},t})();function wu(t,e,n,r){var i=t.length===16,a=i?4:3,o=cc(t,n,r,a),c=ne(o,4),u=ne(c[0],2),d=u[0],h=u[1],p=ne(c[1],2),m=p[0],b=p[1],w=ne(c[2],2),S=w[0],E=w[1],T=ne(c[3],2),C=T[0],N=T[1],j=ne(an(t,e,a),2),O=j[0],M=j[1],A=Math.min(d,m,S,C),k=Math.min(h,b,E,N),D=Math.max(d,m,S,C),V=Math.max(h,b,E,N);d=d-A||0,m=m-A||0,S=S-A||0,C=C-A||0,h=h-k||0,b=b-k||0,E=E-k||0,N=N-k||0,O=O-A||0,M=M-k||0;var L=t[0],U=t[a+1],P=br(L*U);return{left:A,top:k,right:D,bottom:V,origin:[O,M],pos1:[d,h],pos2:[m,b],pos3:[S,E],pos4:[C,N],direction:P}}function AO(t,e){var n=e.clientX,r=e.clientY,i=e.datas,a=t.state,o=a.moveableClientRect,c=a.rootMatrix,u=a.is3d,d=a.pos1,h=o.left,p=o.top,m=u?4:3,b=ne(He(Vu(c,[n-h,r-p],m),d),2),w=b[0],S=b[1],E=ne(Ha({datas:i,distX:w,distY:S}),2),T=E[0],C=E[1];return[T,C]}function lc(t,e){var n=e.datas,r=t.state,i=r.allMatrix,a=r.beforeMatrix,o=r.is3d,c=r.left,u=r.top,d=r.origin,h=r.offsetMatrix,p=r.targetMatrix,m=r.transformOrigin,b=o?4:3;n.is3d=o,n.matrix=i,n.targetMatrix=p,n.beforeMatrix=a,n.offsetMatrix=h,n.transformOrigin=m,n.inverseMatrix=Ua(i,b),n.inverseBeforeMatrix=Ua(a,b),n.absoluteOrigin=Jl(At([c,u],d),b),n.startDragBeforeDist=fr(n.inverseBeforeMatrix,n.absoluteOrigin,b),n.startDragDist=fr(n.inverseMatrix,n.absoluteOrigin,b)}function uW(t){return wu(t.datas.beforeTransform,[50,50],100,100).direction}function G0(t,e,n){var r=e.datas,i=e.originalDatas.beforeRenderable,a=r.transformIndex,o=i.nextTransforms,c=o.length,u=i.nextTransformAppendedIndexes,d=-1;a===-1?(n==="translate"?d=0:n==="rotate"&&(d=Ds(o,function(b){return b.match(/scale\(/g)})),d===-1&&(d=o.length),r.transformIndex=d):zr(u,function(b){return b.index===a&&b.functionName===n})?d=a:d=a+u.filter(function(b){return b.index<a}).length;var h=jK(o,t.state,d),p=h.targetFunction,m=n==="rotate"?"rotateZ":n;r.beforeFunctionTexts=h.beforeFunctionTexts,r.afterFunctionTexts=h.afterFunctionTexts,r.beforeTransform=h.beforeFunctionMatrix,r.beforeTransform2=h.beforeFunctionMatrix2,r.targetTansform=h.targetFunctionMatrix,r.afterTransform=h.afterFunctionMatrix,r.afterTransform2=h.afterFunctionMatrix2,r.targetAllTransform=h.allFunctionMatrix,p.functionName===m?(r.afterFunctionTexts.splice(0,1),r.isAppendTransform=!1):c>d&&(r.isAppendTransform=!0,i.nextTransformAppendedIndexes=Ce(Ce([],ne(u),!1),[{functionName:n,index:d,isAppend:!0}],!1))}function H0(t,e,n){return"".concat(t.beforeFunctionTexts.join(" ")," ").concat(t.isAppendTransform?n:e," ").concat(t.afterFunctionTexts.join(" "))}function dW(t){var e=t.datas,n=t.distX,r=t.distY,i=ne(kO({datas:e,distX:n,distY:r}),2),a=i[0],o=i[1],c=CO(e,gX([a,o],4));return fr(c,Jl([0,0,0],4),4)}function CO(t,e,n){var r=t.beforeTransform,i=t.afterTransform,a=t.beforeTransform2,o=t.afterTransform2,c=t.targetAllTransform,u=n?Gt(c,e,4):Gt(e,c,4),d=Gt(Ua(n?a:r,4),u,4),h=Gt(d,Ua(n?o:i,4),4);return h}function kO(t){var e=t.datas,n=t.distX,r=t.distY,i=e.inverseBeforeMatrix,a=e.is3d,o=e.startDragBeforeDist,c=e.absoluteOrigin,u=a?4:3;return He(fr(i,At(c,[n,r]),u),o)}function Ha(t,e){var n=t.datas,r=t.distX,i=t.distY,a=n.inverseBeforeMatrix,o=n.inverseMatrix,c=n.is3d,u=n.startDragBeforeDist,d=n.startDragDist,h=n.absoluteOrigin,p=c?4:3;return He(fr(e?a:o,At(h,[r,i]),p),e?u:d)}function fW(t,e){var n=t.datas,r=t.distX,i=t.distY;n.beforeMatrix;var a=n.matrix,o=n.is3d;n.startDragBeforeDist;var c=n.startDragDist,u=n.absoluteOrigin,d=o?4:3;return He(fr(a,At(c,[r,i]),d),u)}function hW(t,e,n,r,i,a){return r===void 0&&(r=e),i===void 0&&(i=n),a===void 0&&(a=[0,0]),t?t.map(function(o,c){var u=jh(o),d=u.value,h=u.unit,p=c?i:r,m=c?n:e;if(o==="%"||isNaN(d)){var b=p?a[c]/p:0;return m*b}else if(h!=="%")return d;return m*d/100}):a}function RO(t){var e=[];return t[1]>=0&&(t[0]>=0&&e.push(3),t[0]<=0&&e.push(2)),t[1]<=0&&(t[0]>=0&&e.push(1),t[0]<=0&&e.push(0)),e}function pW(t,e){return RO(e).map(function(n){return t[n]})}function Fb(t,e){var n=(e+1)/2;return[Um(t[0][0],t[1][0],n,1-n),Um(t[0][1],t[1][1],n,1-n)]}function Fn(t,e){var n=Fb([t[0],t[1]],e[0]),r=Fb([t[2],t[3]],e[0]);return Fb([n,r],e[1])}function gW(t,e,n,r,i,a){var o=cc(e,n,r,i),c=Fn(o,a),u=t[0]-c[0],d=t[1]-c[1];return[u,d]}function Hh(t,e,n,r){return Gt(t,jf(e,r,n),r)}function mW(t,e,n,r){var i=t.transformOrigin,a=t.offsetMatrix,o=t.is3d,c=o?4:3,u;if(Vr(n)){var d=e.beforeTransform,h=e.afterTransform;r?u=ta(sh(n),4,c):u=ta(Gt(Gt(d,sh([n]),4),h,4),4,c)}else u=n;return Hh(a,u,i,c)}function vW(t,e){var n=t.transformOrigin,r=t.offsetMatrix,i=t.is3d,a=t.targetMatrix,o=t.targetAllTransform,c=i?4:3;return Hh(r,Gt(o||a,M_(e,c),c),n,c)}function q0(t,e){var n=rd(e);return{setTransform:function(r,i){i===void 0&&(i=-1),n.startTransforms=Vn(r)?r:Yo(r),y1(t,e,i)},setTransformIndex:function(r){y1(t,e,r)}}}function Y0(t,e,n){var r=rd(e),i=r.startTransforms;y1(t,e,Ds(i,function(a){return a.indexOf("".concat(n,"("))===0}))}function y1(t,e,n){var r=rd(e),i=e.datas;if(i.transformIndex=n,n!==-1){var a=r.startTransforms[n];if(a){var o=t.state,c=Mu([a],{"x%":function(u){return u/100*o.offsetWidth},"y%":function(u){return u/100*o.offsetHeight}});i.startValue=c[0].functionValue}}}function L_(t,e){var n=rd(t);n.nextTransforms=Yo(e)}function rd(t){return t.originalDatas.beforeRenderable}function Hm(t){var e=t.originalDatas.beforeRenderable;return e.nextTransforms}function Og(t){return(Hm(t)||[]).join(" ")}function Pg(t){return rd(t).nextStyle}function NO(t,e,n,r,i){L_(i,e);var a=yr.drag(t,Gh(i,t.state,n,r)),o=a?a.transform:e;return ee(ee({transform:e,drag:a},wr({transform:o},i)),{afterTransform:o})}function B_(t,e,n,r,i,a){var o=mW(t.state,i,e,a),c=xW(t,n,r,o);return c}function DO(t,e,n,r,i,a,o){var c=B_(t,e,n,i,a,o),u=t.state,d=u.left,h=u.top,p=t.props.groupable,m=p?d:0,b=p?h:0,w=He(r,c);return He(w,[m,b])}function yW(t,e,n,r,i,a,o){var c=DO(t,e,n,r,i,a,o);return c}function bW(t,e,n){return[e?-1+t[0]/(e/2):0,n?-1+t[1]/(n/2):0]}function xW(t,e,n,r){r===void 0&&(r=t.state.allMatrix);var i=t.state,a=i.width,o=i.height,c=i.is3d,u=c?4:3,d=[a/2*(1+e[0])+n[0],o/2*(1+e[1])+n[1]];return an(r,d,u)}function wW(t,e,n){var r=n.fixedDirection,i=n.fixedPosition,a=n.fixedOffset;return DO(t,"rotate(".concat(e,"deg)"),r,i,a,n)}function _W(t,e,n,r,i,a){var o=t.props.groupable,c=t.state,u=c.transformOrigin,d=c.offsetMatrix,h=c.is3d,p=c.width,m=c.height,b=c.left,w=c.top,S=a.fixedDirection,E=a.nextTargetMatrix||c.targetMatrix,T=h?4:3,C=hW(i,e,n,p,m,u),N=o?b:0,j=o?w:0,O=Hh(d,E,C,T),M=gW(r,O,e,n,T,S);return He(M,[N,j])}function SW(t,e){return Fn(Di(t.state),e)}function EW(t,e){var n=t.targetGesto,r=t.controlGesto,i;return n?.isFlag()&&(i=n.getEventData()[e]),!i&&r?.isFlag()&&(i=r.getEventData()[e]),i||{}}function TW(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function AW(t){var e=t("scale"),n=t("rotate"),r=t("translate"),i=[];return r&&r!=="0px"&&r!=="none"&&i.push("translate(".concat(r.split(/\s+/).join(","),")")),n&&n!=="1"&&n!=="none"&&i.push("rotate(".concat(n,")")),e&&e!=="1"&&e!=="none"&&i.push("scale(".concat(e.split(/\s+/).join(","),")")),i}function IO(t,e,n){for(var r=t,i=[],a=A_(t)||nl(t),o=!n&&t===e||t===a,c=o,u=!1,d=3,h,p,m,b=!1,w=lh(e,e,!0).offsetParent,S=1;r&&!c;){c=o;var E=Lr(r),T=E("position"),C=nP(r),N=T==="fixed",j=AW(E),O=mX(SK(C)),M=void 0,A=!1,k=!1,D=0,V=0,L=0,U=0,P={hasTransform:!1,fixedContainer:null};N&&(b=!0,P=kK(r),w=P.fixedContainer);var K=O.length;!u&&(K===16||j.length)&&(u=!0,d=4,E1(i),m&&(m=ta(m,3,4))),u&&K===9&&(O=ta(O,3,4));var X=CK(r,t),q=X.tagName,Q=X.hasOffset,te=X.isSVG,se=X.origin,G=X.targetOrigin,F=X.offset,Y=ne(F,2),Z=Y[0],W=Y[1];q==="svg"&&!r.ownerSVGElement&&m&&(i.push({type:"target",target:r,matrix:RK(r,d)}),i.push({type:"offset",target:r,matrix:Qt(d)}));var le=parseFloat(E("zoom"))||1;if(N)M=P.fixedContainer,A=!0;else{var ie=lh(r,e,!1,!0,E),pe=ie.offsetZoom;if(M=ie.offsetParent,A=ie.isEnd,k=ie.isStatic,S*=pe,(ie.isCustomElement||pe!==1)&&k)Z-=M.offsetLeft,W-=M.offsetTop;else if(iW||rW){var ce=ie.parentSlotElement;if(ce){for(var xe=M,Re=0,ae=0;xe&&TW(xe);)Re+=xe.offsetLeft,ae+=xe.offsetTop,xe=xe.offsetParent;Z-=Re,W-=ae}}}if(xO&&!aW&&Q&&!te&&k&&(T==="relative"||T==="static")&&(Z-=M.offsetLeft,W-=M.offsetTop,o=o||A),N)Q&&P.hasTransform&&(L=M.clientLeft,U=M.clientTop);else if(Q&&w!==M&&(D=M.clientLeft,V=M.clientTop),Q&&M===a){var Ee=rP(r,!1);Z+=Ee[0],W+=Ee[1]}if(i.push({type:"target",target:r,matrix:jf(O,d,se)}),j.length&&(i.push({type:"offset",target:r,matrix:Qt(d)}),i.push({type:"target",target:r,matrix:jf(sh(j),d,se)})),Q){var Ne=r===t,Ie=Ne?0:r.scrollLeft,Oe=Ne?0:r.scrollTop;i.push({type:"offset",target:r,matrix:ec([Z-Ie+D-L,W-Oe+V-U],d)})}else i.push({type:"offset",target:r,origin:se});if(le!==1&&i.push({type:"zoom",target:r,matrix:jf(M_([le,le],d),d,[0,0])}),m||(m=O),h||(h=se),p||(p=G),c||N)break;r=M,o=A,(!n||r===a)&&(c=o)}return m||(m=Qt(d)),h||(h=[0,0]),p||(p=[0,0]),{zoom:S,offsetContainer:w,matrixes:i,targetMatrix:m,transformOrigin:h,targetOrigin:p,is3d:u,hasFixed:b}}var Pl=null,jl=null,uu=null;function Pu(t){t?(window.Map&&(Pl=new Map,jl=new Map),uu=[]):(Pl=null,uu=null,jl=null)}function CW(t){var e=jl?.get(t);if(e)return e;var n=Vf(t,!0);return jl&&jl.set(t,n),n}function kW(t,e){if(uu){var n=zr(uu,function(i){return i[0][0]==t&&i[0][1]==e});if(n)return n[1]}var r=IO(t,e,!0);return uu&&uu.push([[t,e],r]),r}function Lr(t){var e=Pl?.get(t);if(!e){var n=Oo(t).getComputedStyle(t);if(!Pl)return function(a){return n[a]};e={style:n,cached:{}},Pl.set(t,e)}var r=e.cached,i=e.style;return function(a){return a in r||(r[a]=i[a]),r[a]}}function Wi(t,e,n){var r=n.originalDatas;r.groupable=r.groupable||{};var i=r.groupable;i.childDatas=i.childDatas||[];var a=i.childDatas;return t.moveables.map(function(o,c){return a[c]=a[c]||{},a[c][e]=a[c][e]||{},ee(ee({},n),{isRequestChild:!0,datas:a[c][e],originalDatas:a[c]})})}function $b(t,e,n,r,i,a,o){var c=!!n.match(/Start$/g),u=!!n.match(/End$/g),d=i.isPinch,h=i.datas,p=Wi(t,e.name,i),m=t.moveables,b=[],w=p.map(function(S,E){var T=m[E],C=T.state,N=C.gestos,j=S;if(c)j=new Ou(o).dragStart(r,S),b.push(j);else{if(N[o]||(N[o]=h.childGestos[E]),!N[o])return;j=Gh(S,C,r,d,a,o),b.push(j)}var O=e[n](T,ee(ee({},j),{parentFlag:!0}));return u&&(N[o]=null),O});return c&&(h.childGestos=m.map(function(S){return S.state.gestos[o]})),{eventParams:w,childEvents:b}}function Ss(t,e,n,r,i,a){i===void 0&&(i=function(h,p){return p});var o=!!n.match(/End$/g),c=Wi(t,e.name,r),u=t.moveables,d=c.map(function(h,p){var m=u[p],b=h;b=i(m,h);var w=e[n](m,ee(ee({},b),{parentFlag:!0}));return o&&(m.state.gestos={}),w});return d}function qm(t,e,n,r){var i=n.fixedDirection,a=n.fixedPosition,o=r.datas.startPositions||Di(e.state),c=Fn(o,i),u=ne(fr(Uh(-t.rotation/180*Math.PI,3),[c[0]-a[0],c[1]-a[1],1],3),2),d=u[0],h=u[1];return r.datas.originalX=d,r.datas.originalY=h,r}function MO(t,e,n,r){var i=t.getState(),a=i.renderPoses,o=i.rotation,c=i.direction,u=nc(t.props,e).zoom,d=Pf(o/Math.PI*180),h={},p=t.renderState;p.renderDirectionMap||(p.renderDirectionMap={});var m=p.renderDirectionMap;n.forEach(function(w){var S=w.dir;h[S]=!0});var b=br(c);return n.map(function(w){var S=w.data,E=w.classNames,T=w.dir,C=z_[T];if(!C||!h[T])return null;m[T]=!0;var N=(rt(d,15)+b*EO[T]+720)%180,j={};return Is(S).forEach(function(O){j["data-".concat(O)]=S[O]}),r.createElement("div",ee({className:Fe.apply(void 0,Ce(["control","direction",T,e],ne(E),!1)),"data-rotation":N,"data-direction":T},j,{key:"direction-".concat(T),style:Km.apply(void 0,Ce([o,u],ne(C.map(function(O){return a[O]})),!1))}))})}function OO(t,e,n,r){var i=nc(t.props,n),a=i.renderDirections,o=a===void 0?e:a,c=i.displayAroundControls;if(!o)return[];var u=o===!0?j_:o;return Ce(Ce([],ne(c?zO(t,r,n,u):[]),!1),ne(MO(t,n,u.map(function(d){return{data:{},classNames:[],dir:d}}),r)),!1)}function oh(t,e,n,r,i,a){for(var o=[],c=6;c<arguments.length;c++)o[c-6]=arguments[c];var u=wn(n,r),d=e?rt(u/Math.PI*180,15)%180:-1;return t.createElement("div",{key:"line-".concat(a),className:Fe.apply(void 0,Ce(["line","direction",e?"edge":"",e],ne(o),!1)),"data-rotation":d,"data-line-key":a,"data-direction":e,style:xf(n,r,i,u)})}function PO(t,e,n,r,i){var a=n===!0?QX:n;return a.map(function(o,c){var u=ne(z_[o],2),d=u[0],h=u[1];if(h!=null)return oh(t,o,r[d],r[h],i,"".concat(e,"Edge").concat(c),e)}).filter(Boolean)}function jO(t){return function(e,n){var r=nc(e.props,t).edge;return r&&(r===!0||r.length)?Ce(Ce([],ne(PO(n,t,r,e.getState().renderPoses,e.props.zoom)),!1),ne(RW(e,t,n)),!1):VO(e,t,n)}}function VO(t,e,n){return OO(t,j_,e,n)}function RW(t,e,n){return OO(t,["nw","ne","sw","se"],e,n)}function zO(t,e,n,r){var i=t.renderState;i.renderDirectionMap||(i.renderDirectionMap={});var a=t.getState(),o=a.renderPoses,c=a.rotation,u=a.direction,d=i.renderDirectionMap,h=t.props.zoom,p=br(u),m=c/Math.PI*180;return(r||Is(d)).map(function(b){var w=z_[b];if(!w)return null;var S=(rt(m,15)+p*EO[b]+720)%180,E=["around-control"];return n&&E.push("direction",n),e.createElement("div",{className:Fe.apply(void 0,Ce([],ne(E),!1)),"data-rotation":S,"data-direction":b,key:"direction-around-".concat(b),style:Km.apply(void 0,Ce([c,h],ne(w.map(function(T){return o[T]})),!1))})})}function U_(t,e,n){var r=t||{},i=r.position,a=i===void 0?"client":i,o=r.left,c=o===void 0?-1/0:o,u=r.top,d=u===void 0?-1/0:u,h=r.right,p=h===void 0?1/0:h,m=r.bottom,b=m===void 0?1/0:m,w={position:a,left:c,top:d,right:p,bottom:b};return{vertical:pR(w,e,!0),horizontal:pR(w,n,!1)}}function X0(t,e){var n=t.state,r=n.containerClientRect,i=r.clientHeight,a=r.clientWidth,o=r.clientLeft,c=r.clientTop,u=n.snapOffset,d=u.left,h=u.top,p=u.right,m=u.bottom,b=e||t.props.bounds||{},w=b.position||"client",S=w==="css",E=b.left,T=E===void 0?-1/0:E,C=b.top,N=C===void 0?-1/0:C,j=b.right,O=j===void 0?S?-1/0:1/0:j,M=b.bottom,A=M===void 0?S?-1/0:1/0:M;return S&&(O=a+p-d-O,A=i+m-h-A),{left:T+d-o,right:O+d-o,top:N+h-c,bottom:A+h-c}}function NW(t,e,n){var r=X0(t),i=r.left,a=r.top,o=r.right,c=r.bottom,u=ne(n,2),d=u[0],h=u[1],p=ne(He(n,e),2),m=p[0],b=p[1];Te(m)<Er&&(m=0),Te(b)<Er&&(b=0);var w=b>0,S=m>0,E={isBound:!1,offset:0,pos:0},T={isBound:!1,offset:0,pos:0};if(m===0&&b===0)return{vertical:E,horizontal:T};if(m===0)w?c<h&&(T.pos=c,T.offset=h-c):a>h&&(T.pos=a,T.offset=h-a);else if(b===0)S?o<d&&(E.pos=o,E.offset=d-o):i>d&&(E.pos=i,E.offset=d-i);else{var C=b/m,N=n[1]-C*d,j=0,O=0,M=!1;S&&o<=d?(j=C*o+N,O=o,M=!0):!S&&d<=i&&(j=C*i+N,O=i,M=!0),M&&(j<a||j>c)&&(M=!1),M||(w&&c<=h?(j=c,O=(j-N)/C,M=!0):!w&&h<=a&&(j=a,O=(j-N)/C,M=!0)),M&&(E.isBound=!0,E.pos=O,E.offset=d-O,T.isBound=!0,T.pos=j,T.offset=h-j)}return{vertical:E,horizontal:T}}function pR(t,e,n){var r=t[n?"left":"top"],i=t[n?"right":"bottom"],a=Math.min.apply(Math,Ce([],ne(e),!1)),o=Math.max.apply(Math,Ce([],ne(e),!1)),c=[];return r+1>a&&c.push({direction:"start",isBound:!0,offset:a-r,pos:r}),i-1<o&&c.push({direction:"end",isBound:!0,offset:o-i,pos:i}),c.length||c.push({isBound:!1,offset:0,pos:0}),c.sort(function(u,d){return Te(d.offset)-Te(u.offset)})}function gR(t,e,n){var r=n?t.map(function(i){return Bh(i,n)}):t;return r.some(function(i){return i[0]<e.left&&Te(i[0]-e.left)>.1||i[0]>e.right&&Te(i[0]-e.right)>.1||i[1]<e.top&&Te(i[1]-e.top)>.1||i[1]>e.bottom&&Te(i[1]-e.bottom)>.1})}function DW(t,e,n){var r=Ni(t),i=Math.sqrt(r*r-e*e)||0;return[i,-i].sort(function(a,o){return Te(a-t[n?0:1])-Te(o-t[n?0:1])}).map(function(a){return wn([0,0],n?[a,e]:[e,a])})}function IW(t,e,n,r,i){if(!t.props.bounds)return[];var a=i*Math.PI/180,o=X0(t),c=o.left,u=o.top,d=o.right,h=o.bottom,p=c-r[0],m=d-r[0],b=u-r[1],w=h-r[1],S={left:p,top:b,right:m,bottom:w};if(!gR(n,S,0))return[];var E=[];return[[p,0],[m,0],[b,1],[w,1]].forEach(function(T){var C=ne(T,2),N=C[0],j=C[1];n.forEach(function(O){var M=wn([0,0],O);E.push.apply(E,Ce([],ne(DW(O,N,j).map(function(A){return a+A-M}).filter(function(A){return!gR(e,S,A)}).map(function(A){return rt(A*180/Math.PI,Er)})),!1))})}),E}var MW=["left","right","center"],OW=["top","bottom","middle"],mR={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},Xo={start:"left",end:"right",center:"center"},Wo={start:"top",end:"bottom",center:"middle"};function du(){return{left:!1,top:!1,right:!1,bottom:!1}}function id(t,e){var n=t.props,r=n.snappable,i=n.bounds,a=n.innerBounds,o=n.verticalGuidelines,c=n.horizontalGuidelines,u=n.snapGridWidth,d=n.snapGridHeight,h=t.state,p=h.guidelines,m=h.enableSnap;return!r||!m||e&&r!==!0&&r.indexOf(e)<0?!1:!!(u||d||i||a||p&&p.length||o&&o.length||c&&c.length)}function F_(t){return t===!1?{}:t===!0||!t?{left:!0,right:!0,top:!0,bottom:!0}:t}function PW(t,e){var n=F_(t),r={};for(var i in n)i in e&&n[i]&&(r[i]=e[i]);return r}function $_(t,e){var n=PW(t,e),r=OW.filter(function(a){return a in n}),i=MW.filter(function(a){return a in n});return{horizontalNames:r,verticalNames:i,horizontal:r.map(function(a){return n[a]}),vertical:i.map(function(a){return n[a]})}}function jW(t,e,n){var r=an(t,[e.clientLeft,e.clientTop],n);return[e.left+r[0],e.top+r[1]]}function VW(t){var e=ne(t,2),n=e[0],r=e[1],i=r[0]-n[0],a=r[1]-n[1];Math.abs(i)<Pn&&(i=0),Math.abs(a)<Pn&&(a=0);var o=0,c=0,u=0;return i?a?(o=-a/i,c=1,u=o*n[0]-n[1]):(c=1,u=-n[1]):(o=-1,u=n[0]),[o,c,u].map(function(d){return rt(d,Pn)})}var LO="snapRotationThreshold",BO="snapRotationDegrees",UO="snapHorizontalThreshold",FO="snapVerticalThreshold";function W0(t,e,n,r,i,a,o){var c;r===void 0&&(r=[]),i===void 0&&(i=[]);var u=t.props,d=((c=t.state.snapThresholdInfo)===null||c===void 0?void 0:c.multiples)||[1,1],h=DR(o,u[UO],5),p=DR(a,u[FO],5);return $O(t.state.guidelines,e,n,r,i,h,p,d)}function $O(t,e,n,r,i,a,o,c){return{vertical:yR(t,"vertical",e,o*c[0],r),horizontal:yR(t,"horizontal",n,a*c[1],i)}}function zW(t,e,n){var r=ne(n,2),i=r[0],a=r[1],o=ne(e,2),c=o[0],u=o[1],d=ne(He(n,e),2),h=d[0],p=d[1],m=p>0,b=h>0;h=Qm(h),p=Qm(p);var w={isSnap:!1,offset:0,pos:0},S={isSnap:!1,offset:0,pos:0};if(h===0&&p===0)return{vertical:w,horizontal:S};var E=W0(t,h?[i]:[],p?[a]:[],[],[],void 0,void 0),T=E.vertical,C=E.horizontal;T.posInfos.filter(function(q){var Q=q.pos;return b?Q>=c:Q<=c}),C.posInfos.filter(function(q){var Q=q.pos;return m?Q>=u:Q<=u}),T.isSnap=T.posInfos.length>0,C.isSnap=C.posInfos.length>0;var N=b1(T),j=N.isSnap,O=N.guideline,M=b1(C),A=M.isSnap,k=M.guideline,D=A?k.pos[1]:0,V=j?O.pos[0]:0;if(h===0)A&&(S.isSnap=!0,S.pos=k.pos[1],S.offset=a-S.pos);else if(p===0)j&&(w.isSnap=!0,w.pos=V,w.offset=i-V);else{var L=p/h,U=n[1]-L*i,P=0,K=0,X=!1;j?(K=V,P=L*K+U,X=!0):A&&(P=D,K=(P-U)/L,X=!0),X&&(w.isSnap=!0,w.pos=K,w.offset=i-K,S.isSnap=!0,S.pos=P,S.offset=a-P)}return{vertical:w,horizontal:S}}function To(t){var e="";return t===-1||t==="top"||t==="left"?e="start":t===0||t==="center"||t==="middle"?e="center":(t===1||t==="right"||t==="bottom")&&(e="end"),e}function vR(t,e,n,r){var i=$_(t.props.snapDirections,e),a=W0(t,i.vertical,i.horizontal,i.verticalNames.map(function(u){return To(u)}),i.horizontalNames.map(function(u){return To(u)}),n,r),o=To(i.horizontalNames[a.horizontal.index]),c=To(i.verticalNames[a.vertical.index]);return{vertical:ee(ee({},a.vertical),{direction:c}),horizontal:ee(ee({},a.horizontal),{direction:o})}}function b1(t){var e=t.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var n=t.posInfos[0],r=n.guidelineInfos[0],i=r.offset,a=r.dist,o=r.guideline;return{isSnap:e,offset:i,dist:a,pos:n.pos,guideline:o}}function yR(t,e,n,r,i){var a,o;if(i===void 0&&(i=[]),!t||!t.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var c=e==="vertical",u=c?0:1,d=n.map(function(p,m){var b=i[m]||"",w=t.map(function(S){var E=S.pos,T=p-E[u];return{offset:T,dist:Te(T),guideline:S,direction:b}}).filter(function(S){var E=S.guideline,T=S.dist,C=E.type;return!(C!==e||T>r)}).sort(function(S,E){return S.dist-E.dist});return{pos:p,index:m,guidelineInfos:w,direction:b}}).filter(function(p){return p.guidelineInfos.length>0}).sort(function(p,m){return p.guidelineInfos[0].dist-m.guidelineInfos[0].dist}),h=d.length>0;return{isSnap:h,index:h?d[0].index:-1,direction:(o=(a=d[0])===null||a===void 0?void 0:a.direction)!==null&&o!==void 0?o:"",posInfos:d}}function LW(t,e,n,r,i){var a=[];n[0]&&n[1]?a=[n,[-n[0],n[1]],[n[0],-n[1]]]:!n[0]&&!n[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(m,b,w){var S=w[b+1]||w[0];a.push(m),a.push([(m[0]+S[0])/2,(m[1]+S[1])/2])}):t.props.keepRatio?a.push([-1,-1],[-1,1],[1,-1],[1,1],n):(a.push.apply(a,Ce([],ne(pW([[-1,-1],[1,-1],[-1,-1],[1,1]],n)),!1)),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var o=a.map(function(m){return Fn(e,m)}),c=o.map(function(m){return m[0]}),u=o.map(function(m){return m[1]}),d=W0(t,c,u,a.map(function(m){return To(m[0])}),a.map(function(m){return To(m[1])}),r,i),h=To(a.map(function(m){return m[0]})[d.vertical.index]),p=To(a.map(function(m){return m[1]})[d.horizontal.index]);return{vertical:ee(ee({},d.vertical),{direction:h}),horizontal:ee(ee({},d.horizontal),{direction:p})}}function GO(t,e){var n=Te(t.offset),r=Te(e.offset);return t.isBound&&e.isBound?r-n:t.isBound?-1:e.isBound?1:t.isSnap&&e.isSnap?r-n:t.isSnap?-1:e.isSnap||n<Er?1:r<Er?-1:n-r}function Ym(t,e){return t.slice().sort(function(n,r){var i=n.sign[e],a=r.sign[e],o=n.offset[e],c=r.offset[e];if(i){if(!a)return-1}else return 1;return GO({isBound:n.isBound,isSnap:n.isSnap,offset:o},{isBound:r.isBound,isSnap:r.isSnap,offset:c})})[0]}function BW(t,e,n){var r=[];if(n)Te(e[0])!==1||Te(e[1])!==1?r.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):r.push([e,[t[0],-t[1]]],[e,[-t[0],t[1]]]),r.push([e,t]);else if(t[0]&&t[1]||!t[0]&&!t[1]){var i=t[0]?t:[1,1];[1,-1].forEach(function(o){[1,-1].forEach(function(c){var u=[o*i[0],c*i[1]];e[0]===u[0]&&e[1]===u[1]||r.push([e,u])})})}else if(t[0]){var a=Te(e[0])===1?[1]:[1,-1];a.forEach(function(o){r.push([[e[0],-1],[o*t[0],-1]],[[e[0],0],[o*t[0],0]],[[e[0],1],[o*t[0],1]])})}else if(t[1]){var a=Te(e[1])===1?[1]:[1,-1];a.forEach(function(c){r.push([[-1,e[1]],[-1,c*t[1]]],[[0,e[1]],[0,c*t[1]]],[[1,e[1]],[1,c*t[1]]])})}return r}function HO(t,e){var n=i1([e[0][0],e[1][0]]),r=i1([e[0][1],e[1][1]]);return{vertical:n<=t[0],horizontal:r<=t[1]}}function G_(t,e){var n=ne(e,2),r=n[0],i=n[1],a=i[0]-r[0],o=i[1]-r[1];Te(a)<Er&&(a=0),Te(o)<Er&&(o=0);var c,u;if(!a)c=r[0],u=t[0];else if(!o)c=r[1],u=t[1];else{var d=o/a;c=d*(t[0]-r[0])+r[1],u=t[1]}return c-u}function qO(t,e,n,r){return r===void 0&&(r=Er),t.every(function(i){var a=G_(i,e),o=a<=0;return o===n||Te(a)<=r})}function bR(t,e,n,r,i){return i===void 0&&(i=0),r&&e-i<=t||!r&&t<=n+i?{isBound:!0,offset:r?e-t:n-t}:{isBound:!1,offset:0}}function UW(t,e){var n=e.line,r=e.centerSign,i=e.verticalSign,a=e.horizontalSign,o=e.lineConstants,c=t.props.innerBounds;if(!c)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var u=c.left,d=c.top,h=c.width,p=c.height,m=[[u,d],[u,d+p]],b=[[u,d],[u+h,d]],w=[[u+h,d],[u+h,d+p]],S=[[u,d+p],[u+h,d+p]];if(qO([[u,d],[u+h,d],[u,d+p],[u+h,d+p]],n,r))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var E=Ao(n,o,b,i),T=Ao(n,o,S,i),C=Ao(n,o,m,a),N=Ao(n,o,w,a),j=E.isBound&&T.isBound,O=E.isBound||T.isBound,M=C.isBound&&N.isBound,A=C.isBound||N.isBound,k=ju(E.offset,T.offset),D=ju(C.offset,N.offset),V=[0,0],L=!1,U=!1;return Te(D)<Te(k)?(V=[k,0],L=O,U=j):(V=[0,D],L=A,U=M),{isAllBound:U,isVerticalBound:O,isHorizontalBound:A,isBound:L,offset:V}}function Ao(t,e,n,r,i,a){var o=ne(e,2),c=o[0],u=o[1],d=t[0],h=n[0],p=n[1],m=Qm(p[1]-h[1]),b=Qm(p[0]-h[0]),w=u,S=c,E=-c/u;if(b){if(!m){if(a&&!w)return{isBound:!1,offset:0};if(S){var j=(h[1]-d[1])/E+d[0];return bR(j,h[0],p[0],r,i)}else{var C=h[1]-d[1],N=Te(C)<=(i||0);return{isBound:N,offset:N?C:0}}}}else{if(a&&!S)return{isBound:!1,offset:0};if(w){var T=E*(h[0]-d[0])+d[1];return bR(T,h[1],p[1],r,i)}else{var C=h[0]-d[0],N=Te(C)<=(i||0);return{isBound:N,offset:N?C:0}}}return{isBound:!1,offset:0}}function YO(t,e,n){return e.map(function(r){var i=UW(t,r),a=i.isBound,o=i.offset,c=i.isVerticalBound,u=i.isHorizontalBound,d=r.multiple,h=Ha({datas:n,distX:o[0],distY:o[1]}).map(function(p,m){return p*(d[m]?2/d[m]:0)});return{sign:d,isBound:a,isVerticalBound:c,isHorizontalBound:u,isSnap:!1,offset:h}})}function FW(t,e,n){var r,i=H_(t,e,[0,0],!1).map(function(m){return ee(ee({},m),{multiple:m.multiple.map(function(b){return Te(b)*2})})}),a=YO(t,i,n),o=Ym(a,0),c=Ym(a,1),u=0,d=0,h=o.isVerticalBound||c.isVerticalBound,p=o.isHorizontalBound||c.isHorizontalBound;return(h||p)&&(r=ne(fW({datas:n,distX:-o.offset[0],distY:-c.offset[1]}),2),u=r[0],d=r[1]),{vertical:{isBound:h,offset:u},horizontal:{isBound:p,offset:d}}}function $W(t,e){var n=[],r=t[0],i=t[1];return r&&i?n.push([[0,i*2],t,[-r,i]],[[r*2,0],t,[r,-i]]):r?(n.push([[r*2,0],[r,1],[r,-1]]),e&&n.push([[0,-1],[r,-1],[-r,-1]],[[0,1],[r,1],[-r,1]])):i?(n.push([[0,i*2],[1,i],[-1,i]]),e&&n.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):n.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),n}function H_(t,e,n,r){var i=t.state,a=i.allMatrix,o=i.is3d,c=cc(a,100,100,o?4:3),u=Fn(c,[0,0]);return $W(n,r).map(function(d){var h=ne(d,3),p=h[0],m=h[1],b=h[2],w=[Fn(c,m),Fn(c,b)],S=VW(w),E=HO(u,w),T=E.vertical,C=E.horizontal,N=G_(u,w)<=0;return{multiple:p,centerSign:N,verticalSign:T,horizontalSign:C,lineConstants:S,line:[Fn(e,m),Fn(e,b)]}})}function xR(t,e,n,r){var i=r?t.map(function(a){return Bh(a,r)}):t;return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some(function(a){var o=G_(n,a)<=0;return!qO(e,a,o)})}function GW(t){var e=ne(t,2),n=e[0],r=e[1],i=r[0]-n[0],a=r[1]-n[1];if(!i)return Te(n[0]);if(!a)return Te(n[1]);var o=a/i;return Te((-o*n[0]+n[1])/Math.sqrt(Math.pow(o,2)+1))}function HW(t){var e=ne(t,2),n=e[0],r=e[1],i=r[0]-n[0],a=r[1]-n[1];if(!i)return[n[0],0];if(!a)return[0,n[1]];var o=a/i,c=-o*n[0]+n[1];return[-c/(o+1/o),c/(o*o+1)]}function qW(t,e,n,r,i){var a=t.props.innerBounds,o=i*Math.PI/180;if(!a)return[];var c=a.left,u=a.top,d=a.width,h=a.height,p=c-r[0],m=c+d-r[0],b=u-r[1],w=u+h-r[1],S=[[p,b],[m,b],[p,w],[m,w]],E=Fn(n,[0,0]);if(!xR(n,S,E,0))return[];var T=[],C=S.map(function(N){return[Ni(N),wn([0,0],N)]});return[[n[0],n[1]],[n[1],n[3]],[n[3],n[2]],[n[2],n[0]]].forEach(function(N){var j=wn([0,0],HW(N)),O=GW(N);T.push.apply(T,Ce([],ne(C.filter(function(M){var A=ne(M,1),k=A[0];return k&&O<=k}).map(function(M){var A=ne(M,2),k=A[0],D=A[1],V=Math.acos(k?O/k:0),L=D+V,U=D-V;return[o+L-j,o+U-j]}).reduce(function(M,A){return M.push.apply(M,Ce([],ne(A),!1)),M},[]).filter(function(M){return!xR(e,S,E,M)}).map(function(M){return rt(M*180/Math.PI,Er)})),!1))}),T}function YW(t){var e=t.props.innerBounds,n=du();if(!e)return{boundMap:n,vertical:[],horizontal:[]};var r=t.getRect(),i=r.pos1,a=r.pos2,o=r.pos3,c=r.pos4,u=[i,a,o,c],d=Fn(u,[0,0]),h=e.left,p=e.top,m=e.width,b=e.height,w=[[h,p],[h,p+b]],S=[[h,p],[h+m,p]],E=[[h+m,p],[h+m,p+b]],T=[[h,p+b],[h+m,p+b]],C=H_(t,u,[0,0],!1),N=[],j=[];return C.forEach(function(O){var M=O.line,A=O.lineConstants,k=HO(d,M),D=k.horizontal,V=k.vertical,L=Ao(M,A,S,V,1,!0),U=Ao(M,A,T,V,1,!0),P=Ao(M,A,w,D,1,!0),K=Ao(M,A,E,D,1,!0);L.isBound&&!n.top&&(N.push(p),n.top=!0),U.isBound&&!n.bottom&&(N.push(p+b),n.bottom=!0),P.isBound&&!n.left&&(j.push(h),n.left=!0),K.isBound&&!n.right&&(j.push(h+m),n.right=!0)}),{boundMap:n,horizontal:N,vertical:j}}function XW(t,e,n,r){var i=e[0]-t[0],a=e[1]-t[1];if(Te(i)<Pn&&(i=0),Te(a)<Pn&&(a=0),!i)return r?[0,0]:[0,n];if(!a)return r?[n,0]:[0,0];var o=a/i,c=t[1]-o*t[0];if(r){var u=o*(e[0]+n)+c;return[n,u-e[1]]}else{var d=(e[1]+n-c)/o;return[d-e[0],n]}}function x1(t,e,n,r,i){var a=XW(t,e,n,r);if(!a)return{isOutside:!1,offset:[0,0]};var o=_s(t,e),c=_s(a,t),u=_s(a,e),d=c>o||u>o,h=ne(Ha({datas:i,distX:a[0],distY:a[1]}),2),p=h[0],m=h[1];return{offset:[p,m],isOutside:d}}function Xm(t,e){return t.isBound?t.offset:e.isSnap?b1(e).offset:0}function WW(t,e,n,r,i){var a=ne(e,2),o=a[0],c=a[1],u=ne(n,2),d=u[0],h=u[1],p=ne(r,2),m=p[0],b=p[1],w=ne(i,2),S=w[0],E=w[1],T=-S,C=-E;if(t&&o&&c){T=0,C=0;var N=[];if(d&&h?N.push([0,E],[S,0]):d?N.push([S,0]):h?N.push([0,E]):m&&b?N.push([0,E],[S,0]):m?N.push([S,0]):b&&N.push([0,E]),N.length){N.sort(function(A,k){return Ni(He([o,c],A))-Ni(He([o,c],k))});var j=N[0];if(j[0]&&Te(o)>Pn)T=-j[0],C=c*Te(o+T)/Te(o)-c;else if(j[1]&&Te(c)>Pn){var O=c;C=-j[1],T=o*Te(c+C)/Te(O)-o}if(t&&h&&d)if(Te(T)>Pn&&Te(T)<Te(S)){var M=Te(S)/Te(T);T*=M,C*=M}else if(Te(C)>Pn&&Te(C)<Te(E)){var M=Te(E)/Te(C);T*=M,C*=M}else T=ju(-S,T),C=ju(-E,C)}}else T=o||d?-S:0,C=c||h?-E:0;return[T,C]}function KW(t,e,n,r,i,a){if(!id(t,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var o=X_(a.absolutePoses,[e,n]),c=ki(o),u=c.left,d=c.right,h=c.top,p=c.bottom,m={horizontal:o.map(function(K){return K[1]}),vertical:o.map(function(K){return K[0]})},b=F_(t.props.snapDirections),w=$_(b,{left:u,right:d,top:h,bottom:p,center:(u+d)/2,middle:(h+p)/2}),S=K0(t,i,w,m),E=S.vertical,T=S.horizontal,C=FW(t,o,a),N=C.vertical,j=C.horizontal,O=E.isSnap,M=T.isSnap,A=E.isBound||N.isBound,k=T.isBound||j.isBound,D=ju(E.offset,N.offset),V=ju(T.offset,j.offset),L=ne(WW(r,[e,n],[A,k],[O,M],[D,V]),2),U=L[0],P=L[1];return[{isBound:A,isSnap:O,offset:U},{isBound:k,isSnap:M,offset:P}]}function K0(t,e,n,r){r===void 0&&(r=n);var i=U_(X0(t),r.vertical,r.horizontal),a=i.horizontal,o=i.vertical,c=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:W0(t,n.vertical,n.horizontal,void 0,void 0,void 0,void 0),u=c.horizontal,d=c.vertical,h=Xm(a[0],u),p=Xm(o[0],d),m=Te(h),b=Te(p);return{horizontal:{isBound:a[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:h,dist:m,bounds:a,snap:u},vertical:{isBound:o[0].isBound,isSnap:d.isSnap,snapIndex:d.index,offset:p,dist:b,bounds:o,snap:d}}}function wR(t,e,n,r,i,a,o){o===void 0&&(o=[1,1]);var c=U_(e,n,r),u=c.horizontal,d=c.vertical,h=$O(t,n,r,[],[],i,a,o),p=h.horizontal,m=h.vertical,b=Xm(u[0],p),w=Xm(d[0],m),S=Te(b),E=Te(w);return{horizontal:{isBound:u[0].isBound,isSnap:p.isSnap,snapIndex:p.index,offset:b,dist:S,bounds:u,snap:p},vertical:{isBound:d[0].isBound,isSnap:m.isSnap,snapIndex:m.index,offset:w,dist:E,bounds:d,snap:m}}}function QW(t,e,n,r){var i=wn(t,e)/Math.PI*180,a=n.vertical,o=a.isBound,c=a.isSnap,u=a.dist,d=n.horizontal,h=d.isBound,p=d.isSnap,m=d.dist,b=i%180,w=b<3||b>177,S=b>87&&b<93;return m<u&&(o||c&&!S&&(!r||!w))?"vertical":h||p&&!w&&(!r||!S)?"horizontal":""}function ZW(t,e,n,r,i,a){return n.map(function(o){var c=ne(o,2),u=c[0],d=c[1],h=Fn(e,u),p=Fn(e,d),m=r?JW(t,h,p,i):K0(t,i,{vertical:[p[0]],horizontal:[p[1]]}),b=m.horizontal,w=b.offset,S=b.isBound,E=b.isSnap,T=m.vertical,C=T.offset,N=T.isBound,j=T.isSnap,O=He(d,u);if(!C&&!w)return{isBound:N||S,isSnap:j||E,sign:O,offset:[0,0]};var M=QW(h,p,m,r);if(!M)return{sign:O,isBound:!1,isSnap:!1,offset:[0,0]};var A=M==="vertical",k=[0,0];return!r&&Te(d[0])===1&&Te(d[1])===1&&u[0]!==d[0]&&u[1]!==d[1]?k=Ha({datas:a,distX:-C,distY:-w}):k=x1(h,p,-(A?C:w),A,a).offset,k=k.map(function(D,V){return D*(O[V]?2/O[V]:0)}),{sign:O,isBound:A?N:S,isSnap:A?j:E,offset:k}})}function _R(t,e){return t.isBound?t.offset:e.isSnap?e.offset:0}function JW(t,e,n,r){var i=NW(t,e,n),a=i.horizontal,o=i.vertical,c=r?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:zW(t,e,n),u=c.horizontal,d=c.vertical,h=_R(a,u),p=_R(o,d),m=Te(h),b=Te(p);return{horizontal:{isBound:a.isBound,isSnap:u.isSnap,offset:h,dist:m},vertical:{isBound:o.isBound,isSnap:d.isSnap,offset:p,dist:b}}}function eK(t,e,n,r,i){var a=[-n[0],-n[1]],o=t.state,c=o.width,u=o.height,d=t.props.bounds,h=1/0,p=1/0;if(d){var m=[[n[0],-n[1]],[-n[0],n[1]]],b=d.left,w=b===void 0?-1/0:b,S=d.top,E=S===void 0?-1/0:S,T=d.right,C=T===void 0?1/0:T,N=d.bottom,j=N===void 0?1/0:N;m.forEach(function(O){var M=O[0]!==a[0],A=O[1]!==a[1],k=Fn(e,O),D=wn(r,k)*360/Math.PI;if(A){var V=k.slice();(Te(D-360)<2||Te(D-180)<2)&&(V[1]=r[1]);var L=x1(r,V,(r[1]<k[1]?j:E)-k[1],!1,i),U=ne(L.offset,2),P=U[1],K=L.isOutside;isNaN(P)||(p=u+(K?1:-1)*Te(P))}if(M){var V=k.slice();(Te(D-90)<2||Te(D-270)<2)&&(V[0]=r[0]);var X=x1(r,V,(r[0]<k[0]?C:w)-k[0],!0,i),q=ne(X.offset,1),Q=q[0],te=X.isOutside;isNaN(Q)||(h=c+(te?1:-1)*Te(Q))}})}return{maxWidth:h,maxHeight:p}}var yr={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(t,e){var n=t.props,r=n.hideThrottleDragRotateLine,i=n.throttleDragRotate,a=n.zoom,o=t.getState(),c=o.dragInfo,u=o.beforeOrigin;if(r||!i||!c)return[];var d=c.dist;if(!d[0]&&!d[1])return[];var h=Ni(d),p=wn(d,[0,0]);return[e.createElement("div",{className:Fe("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(h,"px"),transform:"translate(".concat(u[0],"px, ").concat(u[1],"px) rotate(").concat(p,"rad) scaleY(").concat(a,")")}})]},dragStart:function(t,e){var n=e.datas,r=e.parentEvent,i=e.parentGesto,a=t.state,o=a.gestos,c=a.style;if(o.draggable)return!1;o.draggable=i||t.targetGesto,n.datas={},n.left=parseFloat(c.left||"")||0,n.top=parseFloat(c.top||"")||0,n.bottom=parseFloat(c.bottom||"")||0,n.right=parseFloat(c.right||"")||0,n.startValue=[0,0],lc(t,e),Y0(t,e,"translate"),bK(t,n),n.prevDist=[0,0],n.prevBeforeDist=[0,0],n.isDrag=!1,n.deltaOffset=[0,0];var u=ct(t,e,ee({set:function(h){n.startValue=h}},q0(t,e))),d=r||je(t,"onDragStart",u);return d!==!1?(n.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(o.draggable=null,n.isPinch=!1),n.isDrag?u:!1},drag:function(t,e){if(e){G0(t,e,"translate");var n=e.datas,r=e.parentEvent,i=e.parentFlag,a=e.isPinch,o=e.deltaOffset,c=e.useSnap,u=e.isRequest,d=e.isGroup,h=e.parentThrottleDrag,p=e.distX,m=e.distY,b=n.isDrag,w=n.prevDist,S=n.prevBeforeDist,E=n.startValue;if(b){o&&(p+=o[0],m+=o[1]);var T=t.props,C=T.parentMoveable,N=d?0:T.throttleDrag||h||0,j=r?0:T.throttleDragRotate||0,O=0,M=!1,A=!1,k=!1,D=!1;if(!r&&j>0&&(p||m)){var V=T.startDragRotate||0,L=rt(V+wn([0,0],[p,m])*180/Math.PI,j)-V,U=m*Math.abs(Math.cos((L-90)/180*Math.PI)),P=p*Math.abs(Math.cos(L/180*Math.PI)),K=Ni([P,U]);O=L*Math.PI/180,p=K*Math.cos(O),m=K*Math.sin(O)}if(!a&&!r&&!i){var X=ne(KW(t,p,m,j,!c&&u||o,n),2),q=X[0],Q=X[1];M=q.isSnap,A=q.isBound,k=Q.isSnap,D=Q.isBound;var te=q.offset,se=Q.offset;p+=te,m+=se}var G=At(kO({datas:n,distX:p,distY:m}),E),F=At(dW({datas:n,distX:p,distY:m}),E);tR(F,Er),tR(G,Er),j||(!M&&!A&&(F[0]=rt(F[0],N),G[0]=rt(G[0],N)),!k&&!D&&(F[1]=rt(F[1],N),G[1]=rt(G[1],N)));var Y=He(G,E),Z=He(F,E),W=He(Z,w),le=He(Y,S);n.prevDist=Z,n.prevBeforeDist=Y,n.passDelta=W,n.passDist=Z;var ie=n.left+Y[0],pe=n.top+Y[1],ce=n.right-Y[0],xe=n.bottom-Y[1],Re=H0(n,"translate(".concat(F[0],"px, ").concat(F[1],"px)"),"translate(".concat(Z[0],"px, ").concat(Z[1],"px)"));if(L_(e,Re),t.state.dragInfo.dist=r?[0,0]:Z,!(!r&&!C&&W.every(function(Oe){return!Oe})&&le.some(function(Oe){return!Oe}))){var ae=t.state,Ee=ae.width,Ne=ae.height,Ie=ct(t,e,ee({transform:Re,dist:Z,delta:W,translate:F,beforeDist:Y,beforeDelta:le,beforeTranslate:G,left:ie,top:pe,right:ce,bottom:xe,width:Ee,height:Ne,isPinch:a},wr({transform:Re},e)));return!r&&je(t,"onDrag",Ie),Ie}}}},dragAfter:function(t,e){var n=e.datas,r=n.deltaOffset;return r[0]||r[1]?(n.deltaOffset=[0,0],this.drag(t,ee(ee({},e),{deltaOffset:r}))):!1},dragEnd:function(t,e){var n=e.parentEvent,r=e.datas;if(t.state.dragInfo=null,!!r.isDrag){r.isDrag=!1;var i=ri(t,e,{});return!n&&je(t,"onDragEnd",i),i}},dragGroupStart:function(t,e){var n,r,i=e.datas,a=e.clientX,o=e.clientY,c=this.dragStart(t,e);if(!c)return!1;var u=$b(t,this,"dragStart",[a||0,o||0],e,!1,"draggable"),d=u.childEvents,h=u.eventParams,p=ee(ee({},c),{targets:t.props.targets,events:h}),m=je(t,"onDragGroupStart",p);i.isDrag=m!==!1;var b=(r=(n=d[0])===null||n===void 0?void 0:n.datas.startValue)!==null&&r!==void 0?r:[0,0];return i.throttleOffset=[b[0]%1,b[1]%1],i.isDrag?c:!1},dragGroup:function(t,e){var n=e.datas;if(n.isDrag){var r=this.drag(t,ee(ee({},e),{parentThrottleDrag:t.props.throttleDrag})),i=e.datas.passDelta,a=$b(t,this,"drag",i,e,!1,"draggable").eventParams;if(r){var o=ee({targets:t.props.targets,events:a},r);return je(t,"onDragGroup",o),o}}},dragGroupEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isDrag){this.dragEnd(t,e);var i=$b(t,this,"dragEnd",[0,0],e,!1,"draggable").eventParams;return je(t,"onDragGroupEnd",ri(t,e,{targets:t.props.targets,events:i})),n}},request:function(t){var e={},n=t.getRect(),r=0,i=0,a=!1;return{isControl:!1,requestStart:function(o){return a=o.useSnap,{datas:e,useSnap:a}},request:function(o){return"x"in o?r=o.x-n.left:"deltaX"in o&&(r+=o.deltaX),"y"in o?i=o.y-n.top:"deltaY"in o&&(i+=o.deltaY),{datas:e,distX:r,distY:i,useSnap:a}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:a}}}},unset:function(t){t.state.gestos.draggable=null,t.state.dragInfo=null}};function XO(t,e){var n=Fn(t,e),r=[0,0];return{fixedPosition:n,fixedDirection:e,fixedOffset:r}}function tK(t,e){var n=t.allMatrix,r=t.is3d,i=t.width,a=t.height,o=r?4:3,c=[i/2*(1+e[0]),a/2*(1+e[1])],u=an(n,c,o),d=[0,0];return{fixedPosition:u,fixedDirection:e,fixedOffset:d}}function WO(t,e){var n=t.allMatrix,r=t.is3d,i=t.width,a=t.height,o=r?4:3,c=bW(e,i,a),u=an(n,e,o),d=[i?0:e[0],a?0:e[1]];return{fixedPosition:u,fixedDirection:c,fixedOffset:d}}var SR=Q_("resizable"),w1={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:jO("resizable"),dragControlCondition:SR,viewClassName:K_("resizable"),dragControlStart:function(t,e){var n,r=e.inputEvent,i=e.isPinch,a=e.isGroup,o=e.parentDirection,c=e.parentGesto,u=e.datas,d=e.parentFixedDirection,h=e.parentEvent,p=lP(o,i,r,u),m=t.state,b=m.target,w=m.width,S=m.height,E=m.gestos;if(!p||!b||E.resizable)return!1;E.resizable=c||t.controlGesto,!i&&lc(t,e),u.datas={},u.direction=p,u.startOffsetWidth=w,u.startOffsetHeight=S,u.prevWidth=0,u.prevHeight=0,u.minSize=[0,0],u.startWidth=m.inlineCSSWidth||m.cssWidth,u.startHeight=m.inlineCSSHeight||m.cssHeight,u.maxSize=[1/0,1/0],a||(u.minSize=[m.minOffsetWidth,m.minOffsetHeight],u.maxSize=[m.maxOffsetWidth,m.maxOffsetHeight]);var T=t.props.transformOrigin||"% %";u.transformOrigin=Vr(T)?T.split(" "):T,u.startOffsetMatrix=m.offsetMatrix,u.startTransformOrigin=m.transformOrigin,u.isWidth=(n=e?.parentIsWidth)!==null&&n!==void 0?n:!p[0]&&!p[1]||p[0]||!p[1];function C(D){u.ratio=D&&isFinite(D)?D:0}u.startPositions=Di(t.state);function N(D){var V=XO(u.startPositions,D);u.fixedDirection=V.fixedDirection,u.fixedPosition=V.fixedPosition,u.fixedOffset=V.fixedOffset}function j(D){var V=WO(t.state,D);u.fixedDirection=V.fixedDirection,u.fixedPosition=V.fixedPosition,u.fixedOffset=V.fixedOffset}function O(D){u.minSize=[$t("".concat(D[0]),0)||0,$t("".concat(D[1]),0)||0]}function M(D){var V=[D[0]||1/0,D[1]||1/0];(!Iu(V[0])||isFinite(V[0]))&&(V[0]=$t("".concat(V[0]),0)||1/0),(!Iu(V[1])||isFinite(V[1]))&&(V[1]=$t("".concat(V[1]),0)||1/0),u.maxSize=V}C(w/S),N(d||[-p[0],-p[1]]),u.setFixedDirection=N,u.setFixedPosition=j,u.setMin=O,u.setMax=M;var A=ct(t,e,{direction:p,startRatio:u.ratio,set:function(D){var V=ne(D,2),L=V[0],U=V[1];u.startWidth=L,u.startHeight=U},setMin:O,setMax:M,setRatio:C,setFixedDirection:N,setFixedPosition:j,setOrigin:function(D){u.transformOrigin=D},dragStart:yr.dragStart(t,new Ou().dragStart([0,0],e))}),k=h||je(t,"onResizeStart",A);return u.startFixedDirection=u.fixedDirection,u.startFixedPosition=u.fixedPosition,k!==!1&&(u.isResize=!0,t.state.snapRenderInfo={request:e.isRequest,direction:p}),u.isResize?A:!1},dragControl:function(t,e){var n,r=e.datas,i=e.parentFlag,a=e.isPinch,o=e.parentKeepRatio,c=e.dragClient,u=e.parentDist,d=e.useSnap,h=e.isRequest,p=e.isGroup,m=e.parentEvent,b=e.resolveMatrix,w=r.isResize,S=r.transformOrigin,E=r.startWidth,T=r.startHeight,C=r.prevWidth,N=r.prevHeight,j=r.minSize,O=r.maxSize,M=r.ratio,A=r.startOffsetWidth,k=r.startOffsetHeight,D=r.isWidth;if(!w)return;if(b){var V=t.state.is3d,L=r.startOffsetMatrix,U=r.startTransformOrigin,P=V?4:3,K=sh(Hm(e)),X=Math.sqrt(K.length);P!==X&&(K=ta(K,X,P));var q=Hh(L,K,U,P),Q=cc(q,A,k,P);r.startPositions=Q,r.nextTargetMatrix=K,r.nextAllMatrix=q}var te=nc(t.props,"resizable"),se=te.resizeFormat,G=te.throttleResize,F=G===void 0?i?0:1:G,Y=te.parentMoveable,Z=te.keepRatioFinally,W=r.direction,le=W,ie=0,pe=0;!W[0]&&!W[1]&&(le=[1,1]);var ce=M&&(o??te.keepRatio)||!1;function xe(){var ut=r.fixedDirection,Rt=pP(le,ce,r,e);ie=Rt.distWidth,pe=Rt.distHeight;var cn=le[0]-ut[0]||ce?Math.max(A+ie,Er):A,It=le[1]-ut[1]||ce?Math.max(k+pe,Er):k;return ce&&A&&k&&(D?It=cn/M:cn=It*M),[cn,It]}var Re=ne(xe(),2),ae=Re[0],Ee=Re[1];m||(r.setFixedDirection(r.fixedDirection),je(t,"onBeforeResize",ct(t,e,{startFixedDirection:r.startFixedDirection,startFixedPosition:r.startFixedPosition,setFixedDirection:function(ut){var Rt;return r.setFixedDirection(ut),Rt=ne(xe(),2),ae=Rt[0],Ee=Rt[1],[ae,Ee]},setFixedPosition:function(ut){var Rt;return r.setFixedPosition(ut),Rt=ne(xe(),2),ae=Rt[0],Ee=Rt[1],[ae,Ee]},boundingWidth:ae,boundingHeight:Ee,setSize:function(ut){var Rt;Rt=ne(ut,2),ae=Rt[0],Ee=Rt[1]}},!0)));var Ne=c;c||(!i&&a?Ne=SW(t,[0,0]):Ne=r.fixedPosition);var Ie=[0,0];a||(Ie=vK(t,ae,Ee,W,Ne,!d&&h,r)),u&&(!u[0]&&(Ie[0]=0),!u[1]&&(Ie[1]=0));function Oe(){var ut;se&&(ut=ne(se([ae,Ee]),2),ae=ut[0],Ee=ut[1]),ae=rt(ae,F),Ee=rt(Ee,F)}if(ce){le[0]&&le[1]&&Ie[0]&&Ie[1]&&(Te(Ie[0])>Te(Ie[1])?Ie[1]=0:Ie[0]=0);var Ve=!Ie[0]&&!Ie[1];Ve&&Oe(),le[0]&&!le[1]||Ie[0]&&!Ie[1]||Ve&&D?(ae+=Ie[0],Ee=ae/M):(!le[0]&&le[1]||!Ie[0]&&Ie[1]||Ve&&!D)&&(Ee+=Ie[1],ae=Ee*M)}else ae+=Ie[0],Ee+=Ie[1],ae=Math.max(0,ae),Ee=Math.max(0,Ee);n=ne(B4([ae,Ee],j,O,ce?M:!1),2),ae=n[0],Ee=n[1],Oe(),ce&&(p||Z)&&(D?Ee=ae/M:ae=Ee*M),ie=ae-A,pe=Ee-k;var Se=[ie-C,pe-N];r.prevWidth=ie,r.prevHeight=pe;var Le=_W(t,ae,Ee,Ne,S,r);if(!(!Y&&Se.every(function(ut){return!ut})&&Le.every(function(ut){return!ut}))){var Me=yr.drag(t,Gh(e,t.state,Le,!!a,!1,"draggable")),Be=Me.transform,st=E+ie,_t=T+pe,Ze=ct(t,e,ee({width:st,height:_t,offsetWidth:Math.round(ae),offsetHeight:Math.round(Ee),startRatio:M,boundingWidth:ae,boundingHeight:Ee,direction:W,dist:[ie,pe],delta:Se,isPinch:!!a,drag:Me},uP({style:{width:"".concat(st,"px"),height:"".concat(_t,"px")},transform:Be},Me,e)));return!m&&je(t,"onResize",Ze),Ze}},dragControlAfter:function(t,e){var n=e.datas,r=n.isResize,i=n.startOffsetWidth,a=n.startOffsetHeight,o=n.prevWidth,c=n.prevHeight;if(!(!r||t.props.checkResizableError===!1)){var u=t.state,d=u.width,h=u.height,p=d-(i+o),m=h-(a+c),b=Te(p)>3,w=Te(m)>3;if(b&&(n.startWidth+=p,n.startOffsetWidth+=p,n.prevWidth+=p),w&&(n.startHeight+=m,n.startOffsetHeight+=m,n.prevHeight+=m),b||w)return this.dragControl(t,e)}},dragControlEnd:function(t,e){var n=e.datas,r=e.parentEvent;if(n.isResize){n.isResize=!1;var i=ri(t,e,{});return!r&&je(t,"onResizeEnd",i),i}},dragGroupControlCondition:SR,dragGroupControlStart:function(t,e){var n=e.datas,r=this.dragControlStart(t,ee(ee({},e),{isGroup:!0}));if(!r)return!1;var i=Wi(t,"resizable",e),a=n.startOffsetWidth,o=n.startOffsetHeight;function c(){var b=n.minSize;i.forEach(function(w){var S=w.datas,E=S.minSize,T=S.startOffsetWidth,C=S.startOffsetHeight,N=a*(T?E[0]/T:0),j=o*(C?E[1]/C:0);b[0]=Math.max(b[0],N),b[1]=Math.max(b[1],j)})}function u(){var b=n.maxSize;i.forEach(function(w){var S=w.datas,E=S.maxSize,T=S.startOffsetWidth,C=S.startOffsetHeight,N=a*(T?E[0]/T:0),j=o*(C?E[1]/C:0);b[0]=Math.min(b[0],N),b[1]=Math.min(b[1],j)})}var d=Ss(t,this,"dragControlStart",e,function(b,w){return qm(t,b,n,w)});c(),u();var h=function(b){r.setFixedDirection(b),d.forEach(function(w,S){w.setFixedDirection(b),qm(t,w.moveable,n,i[S])})};n.setFixedDirection=h;var p=ee(ee({},r),{targets:t.props.targets,events:d.map(function(b){return ee(ee({},b),{setMin:function(w){b.setMin(w),c()},setMax:function(w){b.setMax(w),u()}})}),setFixedDirection:h,setMin:function(b){r.setMin(b),c()},setMax:function(b){r.setMax(b),u()}}),m=je(t,"onResizeGroupStart",p);return n.isResize=m!==!1,n.isResize?r:!1},dragGroupControl:function(t,e){var n=e.datas;if(n.isResize){var r=nc(t.props,"resizable");Z0(t,"onBeforeResize",function(b){je(t,"onBeforeResizeGroup",ct(t,e,ee(ee({},b),{targets:r.targets}),!0))});var i=this.dragControl(t,ee(ee({},e),{isGroup:!0}));if(i){var a=i.boundingWidth,o=i.boundingHeight,c=i.dist,u=r.keepRatio,d=[a/(a-c[0]),o/(o-c[1])],h=n.fixedPosition,p=Ss(t,this,"dragControl",e,function(b,w){var S=ne(fr(Uh(t.rotation/180*Math.PI,3),[w.datas.originalX*d[0],w.datas.originalY*d[1],1],3),2),E=S[0],T=S[1];return ee(ee({},w),{parentDist:null,parentScale:d,dragClient:At(h,[E,T]),parentKeepRatio:u})}),m=ee({targets:r.targets,events:p},i);return je(t,"onResizeGroup",m),m}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isResize){this.dragControlEnd(t,e);var i=Ss(t,this,"dragControlEnd",e),a=ri(t,e,{targets:t.props.targets,events:i});return je(t,"onResizeGroupEnd",a),n}},request:function(t){var e={},n=0,r=0,i=!1,a=t.getRect();return{isControl:!0,requestStart:function(o){var c;return i=o.useSnap,{datas:e,parentDirection:o.direction||[1,1],parentIsWidth:(c=o?.horizontal)!==null&&c!==void 0?c:!0,useSnap:i}},request:function(o){return"offsetWidth"in o?n=o.offsetWidth-a.offsetWidth:"deltaWidth"in o&&(n+=o.deltaWidth),"offsetHeight"in o?r=o.offsetHeight-a.offsetHeight:"deltaHeight"in o&&(r+=o.deltaHeight),{datas:e,parentDist:[n,r],parentKeepRatio:o.keepRatio,useSnap:i}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:i}}}},unset:function(t){t.state.gestos.resizable=null}};function Gb(t,e,n,r,i){var a=t.props.groupable,o=t.state,c=o.is3d?4:3,u=e.origin,d=an(t.state.rootMatrix,He([u[0],u[1]],a?[0,0]:[o.left,o.top]),c),h=At([i.left,i.top],d);e.startAbsoluteOrigin=h,e.prevDeg=wn(h,[n,r])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=_s(h,[n,r])}function sm(t,e,n){var r=n.defaultDeg,i=n.prevDeg,a=i%360,o=Math.floor(i/360);a<0&&(a+=360),a>t&&a>270&&t<90?++o:a<t&&a<90&&t>270&&--o;var c=e*(o*360+t-r);return n.prevDeg=r+c,c}function Hb(t,e,n,r){return sm(wn(r.startAbsoluteOrigin,[t,e])/Math.PI*180,n,r)}function qb(t,e,n,r,i,a){var o=t.props.throttleRotate,c=o===void 0?0:o,u=n.prevSnapDeg,d=0,h=!1;if(a){var p=mK(t,e,r,i+r);h=p.isSnap,d=i+p.dist}h||(d=rt(i+r,c));var m=d-i;return n.prevSnapDeg=m,[m-u,m,d]}function KO(t,e,n){var r=ne(e,4),i=r[0],a=r[1],o=r[2],c=r[3];if(t==="none")return[];if(Vn(t))return t.map(function(E){return KO(E,[i,a,o,c],n)[0]});var u=ne((t||"top").split("-"),2),d=u[0],h=u[1],p=[i,a];d==="left"?p=[o,i]:d==="right"?p=[a,c]:d==="bottom"&&(p=[c,o]);var m=[(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2],b=sP(p,n);if(h){var w=h==="top"||h==="left",S=d==="bottom"||d==="left";m=p[w&&!S||!w&&S?0:1]}return[[m,b]]}function _1(t,e){if(e.isRequest)return e.requestAble==="rotatable";var n=e.inputEvent.target;if(Un(n,Fe("rotation-control"))||t.props.rotateAroundControls&&Un(n,Fe("around-control"))||Un(n,Fe("control"))&&Un(n,Fe("rotatable")))return!0;var r=t.props.rotationTarget;return r?Z_(r,!0).some(function(i){return i?n===i||n.contains(i):!1}):!1}var nK=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,rK={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[nK],viewClassName:function(t){return t.isDragging("rotatable")?Fe("view-rotation-dragging"):""},render:function(t,e){var n=nc(t.props,"rotatable"),r=n.rotatable,i=n.rotationPosition,a=n.zoom,o=n.renderDirections,c=n.rotateAroundControls,u=n.resolveAblesWithRotatable,d=t.getState(),h=d.renderPoses,p=d.direction;if(!r)return null;var m=KO(i,h,p),b=[];if(m.forEach(function(T,C){var N=ne(T,2),j=N[0],O=N[1];b.push(e.createElement("div",{key:"rotation".concat(C),className:Fe("rotation"),style:{transform:"translate(-50%) translate(".concat(j[0],"px, ").concat(j[1],"px) rotate(").concat(O,"rad)")}},e.createElement("div",{className:Fe("line rotation-line"),style:{transform:"scaleX(".concat(a,")")}}),e.createElement("div",{className:Fe("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(a,")")}})))}),o){var w=Is(u||{}),S={};w.forEach(function(T){u[T].forEach(function(C){S[C]=T})});var E=[];Vn(o)&&(E=o.map(function(T){var C=S[T];return{data:C?{resolve:C}:{},classNames:C?["move"]:[],dir:T}})),b.push.apply(b,Ce([],ne(MO(t,"rotatable",E,e)),!1))}return c&&b.push.apply(b,Ce([],ne(zO(t,e)),!1)),b},dragControlCondition:_1,dragControlStart:function(t,e){var n,r,i=e.datas,a=e.clientX,o=e.clientY,c=e.parentRotate,u=e.parentFlag,d=e.isPinch,h=e.isRequest,p=t.state,m=p.target,b=p.left,w=p.top,S=p.direction,E=p.beforeDirection,T=p.targetTransform,C=p.moveableClientRect,N=p.offsetMatrix,j=p.targetMatrix,O=p.allMatrix,M=p.width,A=p.height;if(!h&&!m)return!1;var k=t.getRect();i.rect=k,i.transform=T,i.left=b,i.top=w;var D=function(le){var ie=WO(t.state,le);i.fixedDirection=ie.fixedDirection,i.fixedOffset=ie.fixedOffset,i.fixedPosition=ie.fixedPosition,F&&F.setFixedPosition(le)},V=function(le){var ie=tK(t.state,le);i.fixedDirection=ie.fixedDirection,i.fixedOffset=ie.fixedOffset,i.fixedPosition=ie.fixedPosition,F&&F.setFixedDirection(le)},L=a,U=o;if(h||d||u){var P=c||0;i.beforeInfo={origin:k.beforeOrigin,prevDeg:P,defaultDeg:P,prevSnapDeg:0,startDist:0},i.afterInfo=ee(ee({},i.beforeInfo),{origin:k.origin}),i.absoluteInfo=ee(ee({},i.beforeInfo),{origin:k.origin,startValue:P})}else{var K=(r=e.inputEvent)===null||r===void 0?void 0:r.target;if(K){var X=K.getAttribute("data-direction")||"",q=cW[X];if(q){i.isControl=!0,i.isAroundControl=Un(K,Fe("around-control")),i.controlDirection=q;var Q=K.getAttribute("data-resolve");Q&&(i.resolveAble=Q);var te=IK(p.rootMatrix,p.renderPoses,C);n=ne(Fn(te,q),2),L=n[0],U=n[1]}}i.beforeInfo={origin:k.beforeOrigin},i.afterInfo={origin:k.origin},i.absoluteInfo={origin:k.origin,startValue:k.rotation};var se=D;D=function(le){var ie=p.is3d?4:3,pe=ne(At(fO(j,ie),le),2),ce=pe[0],xe=pe[1],Re=fr(N,Jl([ce,xe],ie)),ae=fr(O,Jl([le[0],le[1]],ie));se(le);var Ee=p.posDelta;i.beforeInfo.origin=He(Re,Ee),i.afterInfo.origin=He(ae,Ee),i.absoluteInfo.origin=He(ae,Ee),Gb(t,i.beforeInfo,L,U,C),Gb(t,i.afterInfo,L,U,C),Gb(t,i.absoluteInfo,L,U,C)},V=function(le){var ie=Fn([[0,0],[M,0],[0,A],[M,A]],le);D(ie)}}i.startClientX=L,i.startClientY=U,i.direction=S,i.beforeDirection=E,i.startValue=0,i.datas={},Y0(t,e,"rotate");var G=!1,F=!1;if(i.isControl&&i.resolveAble){var Y=i.resolveAble;Y==="resizable"&&(F=w1.dragControlStart(t,ee(ee({},new Ou("resizable").dragStart([0,0],e)),{parentPosition:i.controlPosition,parentFixedPosition:i.fixedPosition})))}F||(G=yr.dragStart(t,new Ou().dragStart([0,0],e))),D(MK(t));var Z=ct(t,e,ee(ee({set:function(le){i.startValue=le*Math.PI/180},setFixedDirection:V,setFixedPosition:D},q0(t,e)),{dragStart:G,resizeStart:F})),W=je(t,"onRotateStart",Z);return i.isRotate=W!==!1,p.snapRenderInfo={request:e.isRequest},i.isRotate?Z:!1},dragControl:function(t,e){var n,r,i,a=e.datas,o=e.clientDistX,c=e.clientDistY,u=e.parentRotate,d=e.parentFlag,h=e.isPinch,p=e.groupDelta,m=e.resolveMatrix,b=a.beforeDirection,w=a.beforeInfo,S=a.afterInfo,E=a.absoluteInfo,T=a.isRotate,C=a.startValue,N=a.rect,j=a.startClientX,O=a.startClientY;if(T){G0(t,e,"rotate");var M=uW(e),A=b*M,k=t.props.parentMoveable,D=0,V,L,U=0,P,K,X=0,q,Q,te=180/Math.PI*C,se=E.startValue,G=!1,F=j+o,Y=O+c;if(!d&&"parentDist"in e){var Z=e.parentDist;V=Z,P=Z,q=Z}else h||d?(V=sm(u,b,w),P=sm(u,A,S),q=sm(u,A,E)):(V=Hb(F,Y,b,w),P=Hb(F,Y,A,S),q=Hb(F,Y,A,E),G=!0);if(L=te+V,K=te+P,Q=se+q,je(t,"onBeforeRotate",ct(t,e,{beforeRotation:L,rotation:K,absoluteRotation:Q,setRotation:function(Ne){P=Ne-te,V=P,q=P}},!0)),n=ne(qb(t,N,w,V,te,G),3),D=n[0],V=n[1],L=n[2],r=ne(qb(t,N,S,P,te,G),3),U=r[0],P=r[1],K=r[2],i=ne(qb(t,N,E,q,se,G),3),X=i[0],q=i[1],Q=i[2],!(!X&&!U&&!D&&!k&&!m)){var W=H0(a,"rotate(".concat(K,"deg)"),"rotate(".concat(P,"deg)"));m&&(a.fixedPosition=B_(t,a.targetAllTransform,a.fixedDirection,a.fixedOffset,a));var le=wW(t,P,a),ie=He(At(p||[0,0],le),a.prevInverseDist||[0,0]);a.prevInverseDist=le,a.requestValue=null;var pe=NO(t,W,ie,h,e),ce=pe,xe=_s([F,Y],E.startAbsoluteOrigin)-E.startDist,Re=void 0;if(a.resolveAble==="resizable"){var ae=w1.dragControl(t,ee(ee({},Gh(e,t.state,[e.deltaX,e.deltaY],!!h,!1,"resizable")),{resolveMatrix:!0,parentDistance:xe}));ae&&(Re=ae,ce=uP(ce,ae,e))}var Ee=ct(t,e,ee(ee({delta:U,dist:P,rotate:K,rotation:K,beforeDist:V,beforeDelta:D,beforeRotate:L,beforeRotation:L,absoluteDist:q,absoluteDelta:X,absoluteRotate:Q,absoluteRotation:Q,isPinch:!!h,resize:Re},pe),ce));return je(t,"onRotate",Ee),Ee}}},dragControlEnd:function(t,e){var n=e.datas;if(n.isRotate){n.isRotate=!1;var r=ri(t,e,{});return je(t,"onRotateEnd",r),r}},dragGroupControlCondition:_1,dragGroupControlStart:function(t,e){var n=e.datas,r=t.state,i=r.left,a=r.top,o=r.beforeOrigin,c=this.dragControlStart(t,e);if(!c)return!1;c.set(n.beforeDirection*t.rotation);var u=Ss(t,this,"dragControlStart",e,function(p,m){var b=p.state,w=b.left,S=b.top,E=b.beforeOrigin,T=At(He([w,S],[i,a]),He(E,o));return m.datas.startGroupClient=T,m.datas.groupClient=T,ee(ee({},m),{parentRotate:0})}),d=ee(ee({},c),{targets:t.props.targets,events:u}),h=je(t,"onRotateGroupStart",d);return n.isRotate=h!==!1,n.isRotate?c:!1},dragGroupControl:function(t,e){var n=e.datas;if(n.isRotate){Z0(t,"onBeforeRotate",function(d){je(t,"onBeforeRotateGroup",ct(t,e,ee(ee({},d),{targets:t.props.targets}),!0))});var r=this.dragControl(t,e);if(r){var i=n.beforeDirection,a=r.beforeDist,o=a/180*Math.PI,c=Ss(t,this,"dragControl",e,function(d,h){var p=h.datas.startGroupClient,m=ne(h.datas.groupClient,2),b=m[0],w=m[1],S=ne(Bh(p,o*i),2),E=S[0],T=S[1],C=[E-b,T-w];return h.datas.groupClient=[E,T],ee(ee({},h),{parentRotate:a,groupDelta:C})});t.rotation=i*r.beforeRotation;var u=ee({targets:t.props.targets,events:c,set:function(d){t.rotation=d},setGroupRotation:function(d){t.rotation=d}},r);return je(t,"onRotateGroup",u),u}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isRotate){this.dragControlEnd(t,e);var i=Ss(t,this,"dragControlEnd",e),a=ri(t,e,{targets:t.props.targets,events:i});return je(t,"onRotateGroupEnd",a),n}},request:function(t){var e={},n=0,r=t.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(i){return"deltaRotate"in i?n+=i.deltaRotate:"rotate"in i&&(n=i.rotate-r),{datas:e,parentDist:n}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function iK(t,e){var n,r=t.direction,i=t.classNames,a=t.size,o=t.pos,c=t.zoom,u=t.key,d=r==="horizontal",h=d?"Y":"X";return e.createElement("div",{key:u,className:i.join(" "),style:(n={},n[d?"width":"height"]="".concat(a),n.transform="translate(".concat(o[0],", ").concat(o[1],") translate").concat(h,"(-50%) scale").concat(h,"(").concat(c,")"),n)})}function q_(t,e){return iK(ee(ee({},t),{classNames:Ce([Fe("line","guideline",t.direction)],ne(t.classNames),!1).filter(function(n){return n}),size:t.size||"".concat(t.sizeValue,"px"),pos:t.pos||t.posValue.map(function(n){return"".concat(rt(n,.1),"px")})}),e)}function ER(t,e,n,r,i,a,o,c){var u=t.props.zoom;return n.map(function(d,h){var p=d.type,m=d.pos,b=[0,0];return b[o]=r,b[o?0:1]=-i+m,q_({key:"".concat(e,"TargetGuideline").concat(h),classNames:[Fe("target","bold",p)],posValue:b,sizeValue:a,zoom:u,direction:e},c)})}function TR(t,e,n,r,i,a){var o=t.props,c=o.zoom,u=o.isDisplayInnerSnapDigit,d=e==="horizontal"?Xo:Wo,h=i[d.start],p=i[d.end];return n.filter(function(m){var b=m.hide,w=m.elementRect;if(b)return!1;if(u&&w){var S=w.rect;if(S[d.start]<=h&&p<=S[d.end])return!1}return!0}).map(function(m,b){var w=m.pos,S=m.size,E=m.element,T=m.className,C=[-r[0]+w[0],-r[1]+w[1]];return q_({key:"".concat(e,"-default-guideline-").concat(b),classNames:E?[Fe("bold"),T]:[Fe("normal"),T],direction:e,posValue:C,sizeValue:S,zoom:c},a)})}function bf(t,e,n,r,i,a,o,c){var u,d=t.props,h=d.snapDigit,p=h===void 0?0:h,m=d.isDisplaySnapDigit,b=m===void 0?!0:m,w=d.snapDistFormat,S=w===void 0?function(O,M){return O}:w,E=d.zoom,T=e==="horizontal"?"X":"Y",C=e==="vertical"?"height":"width",N=Math.abs(i),j=b?parseFloat(N.toFixed(p)):0;return c.createElement("div",{key:"".concat(e,"-").concat(n,"-guideline-").concat(r),className:Fe("guideline-group",e),style:(u={left:"".concat(a[0],"px"),top:"".concat(a[1],"px")},u[C]="".concat(N,"px"),u)},q_({direction:e,classNames:[Fe(n),o],size:"100%",posValue:[0,0],sizeValue:N,zoom:E},c),c.createElement("div",{className:Fe("size-value","gap"),style:{transform:"translate".concat(T,"(-50%) scale(").concat(E,")")}},j>0?S(j,e):""))}function aK(t,e,n,r){var i=t==="vertical"?0:1,a=t==="vertical"?1:0,o=i?Xo:Wo,c=n[o.start],u=n[o.end];return dP(e,function(d){return d.pos[i]}).map(function(d){var h=[],p=[],m=[];return d.forEach(function(b){var w,S,E=b.element,T=b.elementRect.rect;if(T[o.end]<c)h.push(b);else if(u<T[o.start])p.push(b);else if(T[o.start]<=c&&u<=T[o.end]&&r){var C=b.pos,N={element:E,rect:ee(ee({},T),(w={},w[o.end]=T[o.start],w))},j={element:E,rect:ee(ee({},T),(S={},S[o.start]=T[o.end],S))},O=[0,0],M=[0,0];O[i]=C[i],O[a]=C[a],M[i]=C[i],M[a]=C[a]+b.size,h.push({type:t,pos:O,size:0,elementRect:N,direction:"",elementDirection:"end"}),p.push({type:t,pos:M,size:0,elementRect:j,direction:"",elementDirection:"start"})}}),h.sort(function(b,w){return w.pos[a]-b.pos[a]}),p.sort(function(b,w){return b.pos[a]-w.pos[a]}),{total:d,start:h,end:p,inner:m}})}function sK(t,e,n,r,i){var a=t.props.isDisplayInnerSnapDigit,o=[];return["vertical","horizontal"].forEach(function(c){var u=e.filter(function(E){return E.type===c}),d=c==="vertical"?1:0,h=d?0:1,p=aK(c,u,r,a),m=d?Wo:Xo,b=d?Xo:Wo,w=r[m.start],S=r[m.end];p.forEach(function(E){var T=E.total,C=E.start,N=E.end,j=E.inner,O=n[h]+T[0].pos[h]-r[b.start],M=r;C.forEach(function(A){var k=A.elementRect.rect,D=M[m.start]-k[m.end];if(D>0){var V=[0,0];V[d]=n[d]+M[m.start]-w-D,V[h]=O,o.push(bf(t,c,"dashed",o.length,D,V,A.className,i))}M=k}),M=r,N.forEach(function(A){var k=A.elementRect.rect,D=k[m.start]-M[m.end];if(D>0){var V=[0,0];V[d]=n[d]+M[m.end]-w,V[h]=O,o.push(bf(t,c,"dashed",o.length,D,V,A.className,i))}M=k}),j.forEach(function(A){var k=A.elementRect.rect,D=w-k[m.start],V=k[m.end]-S,L=[0,0],U=[0,0];L[d]=n[d]-D,L[h]=O,U[d]=n[d]+S-w,U[h]=O,o.push(bf(t,c,"dashed",o.length,D,L,A.className,i)),o.push(bf(t,c,"dashed",o.length,V,U,A.className,i))})})}),o}function oK(t,e,n,r,i){var a=[];return["horizontal","vertical"].forEach(function(o){var c=e.filter(function(E){return E.type===o}).slice(0,1),u=o==="vertical"?0:1,d=u?0:1,h=u?Wo:Xo,p=u?Xo:Wo,m=r[h.start],b=r[h.end],w=r[p.start],S=r[p.end];c.forEach(function(E){var T=E.gap,C=E.gapRects,N=Math.max.apply(Math,Ce([w],ne(C.map(function(M){var A=M.rect;return A[p.start]})),!1)),j=Math.min.apply(Math,Ce([S],ne(C.map(function(M){var A=M.rect;return A[p.end]})),!1)),O=(N+j)/2;N===j||O===(w+S)/2||C.forEach(function(M){var A=M.rect,k=M.className,D=[n[0],n[1]];if(A[h.end]<m)D[u]+=A[h.end]-m;else if(b<A[h.start])D[u]+=A[h.start]-m-T;else return;D[d]+=O-w,a.push(bf(t,u?"vertical":"horizontal","gap",a.length,T,D,k,i))})})}),a}function S1(t){var e,n,r=t.state,i=r.containerClientRect,a=r.hasFixed,o=i.overflow,c=i.scrollHeight,u=i.scrollWidth,d=i.clientHeight,h=i.clientWidth,p=i.clientLeft,m=i.clientTop,b=t.props,w=b.snapGap,S=w===void 0?!0:w,E=b.verticalGuidelines,T=b.horizontalGuidelines,C=b.snapThreshold,N=C===void 0?5:C,j=b.maxSnapElementGuidelineDistance,O=j===void 0?1/0:j,M=b.isDisplayGridGuidelines,A=ki(Di(t.state)),k=A.top,D=A.left,V=A.bottom,L=A.right,U={top:k,left:D,bottom:V,right:L,center:(D+L)/2,middle:(k+V)/2},P=dK(t),K=Ce([],ne(P),!1),X=((n=(e=r.snapThresholdInfo)===null||e===void 0?void 0:e.multiples)!==null&&n!==void 0?n:[1,1]).map(function(se){return se*N});S&&K.push.apply(K,Ce([],ne(lK(t,U,X)),!1));var q=ee({},r.snapOffset||{left:0,top:0,bottom:0,right:0});if(K.push.apply(K,Ce([],ne(uK(t,o?u:h,o?c:d,p,m,q,M)),!1)),a){var Q=i.left,te=i.top;q.left+=Q,q.top+=te,q.right+=Q,q.bottom+=te}return K.push.apply(K,Ce([],ne(ZO(T||!1,E||!1,o?u:h,o?c:d,p,m,q)),!1)),K=K.filter(function(se){var G=se.element,F=se.elementRect,Y=se.type;if(!G||!F)return!0;var Z=F.rect;return QO(U,Z,Y,O)}),K}function lK(t,e,n){var r=t.props,i=r.maxSnapElementGuidelineDistance,a=i===void 0?1/0:i,o=r.maxSnapElementGapDistance,c=o===void 0?1/0:o,u=t.state.elementRects,d=[];return[["vertical",Xo,Wo],["horizontal",Wo,Xo]].forEach(function(h){var p=ne(h,3),m=p[0],b=p[1],w=p[2],S=e[b.start],E=e[b.end],T=e[b.center],C=e[w.start],N=e[w.end],j={left:n[0],top:n[1]};function O(k){var D=k.rect,V=j[b.start];return D[b.end]<S+V?S-D[b.end]:E-V<D[b.start]?D[b.start]-E:-1}var M=u.filter(function(k){var D=k.rect;return D[w.start]>N||D[w.end]<C?!1:O(k)>0}).sort(function(k,D){return O(k)-O(D)}),A=[];M.forEach(function(k){M.forEach(function(D){if(k!==D){var V=k.rect,L=D.rect,U=V[w.start],P=V[w.end],K=L[w.start],X=L[w.end];U>X||K>P||A.push([k,D])}})}),A.forEach(function(k){var D=ne(k,2),V=D[0],L=D[1],U=V.rect,P=L.rect,K=U[b.start],X=U[b.end],q=P[b.start],Q=P[b.end],te=j[b.start],se=0,G=0,F=!1,Y=!1,Z=!1;if(X<=S&&E<=q){if(Y=!0,se=(q-X-(E-S))/2,G=X+se+(E-S)/2,Te(G-T)>te)return}else if(X<q&&Q<S+te){if(F=!0,se=q-X,G=Q+se,Te(G-S)>te)return}else if(X<q&&E-te<K){if(Z=!0,se=q-X,G=K-se,Te(G-E)>te)return}else return;se&&QO(e,P,m,a)&&(se>c||d.push({type:m,pos:m==="vertical"?[G,0]:[0,G],element:L.element,size:0,className:L.className,isStart:F,isCenter:Y,isEnd:Z,gap:se,hide:!0,gapRects:[V,L],direction:"",elementDirection:""}))})}),d}function cK(t,e,n,r){var i,a,o=t.props,c=t.state,u=o.snapGridAll,d=o.snapGridWidth,h=d===void 0?0:d,p=o.snapGridHeight,m=p===void 0?0:p,b=c.snapRenderInfo,w=b&&(((i=b.direction)===null||i===void 0?void 0:i[0])||((a=b.direction)===null||a===void 0?void 0:a[1])),S=t.moveables;if(u&&S&&w&&(h||m)){if(c.snapThresholdInfo)return;c.snapThresholdInfo={multiples:[1,1],offset:[0,0]};var E=t.getRect(),T=E.children,C=b.direction;if(T){var N=C.map(function(O,M){var A=M===0?{snapSize:h,posName:"left",sizeName:"width",clientOffset:r.left-e}:{snapSize:m,posName:"top",sizeName:"height",clientOffset:r.top-n},k=A.snapSize,D=A.posName,V=A.sizeName,L=A.clientOffset;if(!k)return{dir:O,multiple:1,snapSize:k,snapOffset:0};var U=E[V],P=E[D],K=U4(T.map(function(F){return[F[D]-P,F[V],U-F[V]-F[D]+P]})).filter(function(F){return F}).sort(function(F,Y){return F-Y}),X=K[0],q=K.map(function(F){return rt(F/X,.1)*k}),Q=1,te=rt(U/X,.1);for(Q=1;Q<=10&&!q.every(function(F){return F*Q%1===0});++Q);var se=(-O+1)/2,G=Um(P-L,P-L+U,se,1-se);return{multiple:te*Q,dir:O,snapSize:k,snapOffset:Math.round(G/k)}}),j=N.map(function(O){return O.multiple||1});c.snapThresholdInfo.multiples=j,c.snapThresholdInfo.offset=N.map(function(O){return O.snapOffset}),N.forEach(function(O,M){O.snapSize})}}else c.snapThresholdInfo=null}function uK(t,e,n,r,i,a,o){r===void 0&&(r=0),i===void 0&&(i=0);var c=t.props,u=t.state,d=c.snapGridWidth,h=d===void 0?0:d,p=c.snapGridHeight,m=p===void 0?0:p,b=[],w=a.left,S=a.top,E=[0,0];cK(t,r,i,a);var T=u.snapThresholdInfo,C=h,N=m;if(T&&(h*=T.multiples[0]||1,m*=T.multiples[1]||1,E=T.offset),m){for(var j=function(M){b.push({type:"horizontal",pos:[w,rt(E[1]*N+M-i+S,.1)],className:Fe("grid-guideline"),size:e,hide:!o,direction:"",grid:!0})},O=0;O<=n*2;O+=m)j(O);for(var O=-m;O>=-n;O-=m)j(O)}if(h){for(var j=function(A){b.push({type:"vertical",pos:[rt(E[0]*C+A-r+w,.1),S],className:Fe("grid-guideline"),size:n,hide:!o,direction:"",grid:!0})},O=0;O<=e*2;O+=h)j(O);for(var O=-h;O>=-e;O-=h)j(O)}return b}function QO(t,e,n,r){return n==="horizontal"?Te(t.right-e.left)<=r||Te(t.left-e.right)<=r||t.left<=e.right&&e.left<=t.right:n==="vertical"?Te(t.bottom-e.top)<=r||Te(t.top-e.bottom)<=r||t.top<=e.bottom&&e.top<=t.bottom:!0}function dK(t){var e=t.state,n=t.props.elementGuidelines,r=n===void 0?[]:n;if(!r.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter(function(m){return!m.refresh}),a=r.map(function(m){return ea(m)&&"element"in m?ee(ee({},m),{element:za(m.element,!0)}):{element:za(m,!0)}}).filter(function(m){return m.element}),o=SX(i.map(function(m){return m.element}),a.map(function(m){return m.element})),c=o.maintained,u=o.added,d=[];c.forEach(function(m){var b=ne(m,2),w=b[0],S=b[1];d[S]=i[w]}),fK(t,u.map(function(m){return a[m]})).map(function(m,b){d[u[b]]=m}),e.elementRects=d;var h=F_(t.props.elementSnapDirections),p=[];return d.forEach(function(m){var b=m.element,w=m.top,S=w===void 0?h.top:w,E=m.left,T=E===void 0?h.left:E,C=m.right,N=C===void 0?h.right:C,j=m.bottom,O=j===void 0?h.bottom:j,M=m.center,A=M===void 0?h.center:M,k=m.middle,D=k===void 0?h.middle:k,V=m.className,L=m.rect,U=$_({top:S,right:N,left:T,bottom:O,center:A,middle:D},L),P=U.horizontal,K=U.vertical,X=U.horizontalNames,q=U.verticalNames,Q=L.top,te=L.left,se=L.right-te,G=L.bottom-Q,F=[se,G];K.forEach(function(Y,Z){p.push({type:"vertical",element:b,pos:[rt(Y,.1),Q],size:G,sizes:F,className:V,elementRect:m,elementDirection:mR[q[Z]]||q[Z],direction:""})}),P.forEach(function(Y,Z){p.push({type:"horizontal",element:b,pos:[te,rt(Y,.1)],size:se,sizes:F,className:V,elementRect:m,elementDirection:mR[X[Z]]||X[Z],direction:""})})}),p}function AR(t,e){return t?t.map(function(n){var r=ea(n)?n:{pos:n},i=r.pos;return Iu(i)?r:ee(ee({},r),{pos:$t(i,e)})}):[]}function ZO(t,e,n,r,i,a,o){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o={left:0,top:0,right:0,bottom:0});var c=[],u=o.left,d=o.top,h=o.bottom,p=o.right,m=n+p-u,b=r+h-d;return AR(t,b).forEach(function(w){c.push({type:"horizontal",pos:[u,rt(w.pos-a+d,.1)],size:m,className:w.className,direction:""})}),AR(e,m).forEach(function(w){c.push({type:"vertical",pos:[rt(w.pos-i+u,.1),d],size:b,className:w.className,direction:""})}),c}function fK(t,e){if(!e.length)return[];var n=t.props.groupable,r=t.state,i=r.containerClientRect,a=r.rootMatrix,o=r.is3d,c=r.offsetDelta,u=o?4:3,d=ne(jW(a,i,u),2),h=d[0],p=d[1],m=n?0:c[0],b=n?0:c[1];return e.map(function(w){var S=w.element.getBoundingClientRect(),E=S.left-h-m,T=S.top-p-b,C=T+S.height,N=E+S.width,j=ne(Vu(a,[E,T],u),2),O=j[0],M=j[1],A=ne(Vu(a,[N,C],u),2),k=A[0],D=A[1];return ee(ee({},w),{rect:{left:O,right:k,top:M,bottom:D,center:(O+k)/2,middle:(M+D)/2}})})}function jg(t){var e=t.state,n=e.container,r=t.props.snapContainer||n;if(e.snapContainer===r&&e.guidelines&&e.guidelines.length)return!1;var i=e.containerClientRect,a={left:0,top:0,bottom:0,right:0};if(n!==r){var o=za(r,!0);if(o){var c=Vf(o),u=IR(e,[c.left-i.left,c.top-i.top]),d=IR(e,[c.right-i.right,c.bottom-i.bottom]);a.left=rt(u[0],1e-5),a.top=rt(u[1],1e-5),a.right=rt(d[0],1e-5),a.bottom=rt(d[1],1e-5)}}return e.snapContainer=r,e.snapOffset=a,e.guidelines=S1(t),e.enableSnap=!0,!0}function JO(t,e,n,r,i,a){var o=cc(t,e,n,a?4:3),c=Fn(o,r);return X_(o,He(i,c))}function CR(t){return t?t/Te(t):0}function hK(t,e,n,r,i,a){var o=a.fixedDirection,c=BW(n,o,r),u=H_(t,e,n,r),d=Ce(Ce([],ne(ZW(t,e,c,r,i,a)),!1),ne(YO(t,u,a)),!1),h=Ym(d,0),p=Ym(d,1);return{width:{isBound:h.isBound,offset:h.offset[0]},height:{isBound:p.isBound,offset:p.offset[1]}}}function pK(t,e,n,r,i,a,o,c,u){var d=Fn(e,o),h=K0(t,c,{vertical:[d[0]],horizontal:[d[1]]}),p=h.horizontal.offset,m=h.vertical.offset;if(rt(m,m1)||rt(p,m1)){var b=ne(Ha({datas:u,distX:-m,distY:-p}),2),w=b[0],S=b[1],E=Math.min(i||1/0,n+o[0]*w),T=Math.min(a||1/0,r+o[1]*S);return[E-n,T-r]}return[0,0]}function eP(t,e,n,r,i,a,o,c){for(var u=Di(t.state),d=t.props.keepRatio,h=0,p=0,m=0;m<2;++m){var b=e(h,p),w=hK(t,b,i,d,o,c),S=w.width,E=w.height,T=S.isBound,C=E.isBound,N=S.offset,j=E.offset;if(m===1&&(T||(N=0),C||(j=0)),m===0&&o&&!T&&!C)return[0,0];if(d){var O=Te(N)*(n?1/n:1),M=Te(j)*(r?1/r:1),A=T&&C?O<M:C||!T&&O<M;A?N=n*j/r:j=r*N/n}h+=N,p+=j}if(!d&&i[0]&&i[1]){var k=eK(t,u,i,a,c),D=k.maxWidth,V=k.maxHeight,L=ne(pK(t,e(h,p).map(function(K){return K.map(function(X){return rt(X,m1)})}),n+h,r+p,D,V,i,o,c),2),N=L[0],j=L[1];h+=N,p+=j}return[h,p]}function Pf(t){return t<0&&(t=t%360+360),t%=360,t}function gK(t,e){e=Pf(e);var n=Math.floor(t/360),r=n*360+360-e,i=n*360+e;return Te(t-r)<Te(t-i)?r:i}function Yb(t,e){t=Pf(t),e=Pf(e);var n=Pf(t-e);return Math.min(n,360-n)}function mK(t,e,n,r){var i,a=t.props,o=(i=a[LO])!==null&&i!==void 0?i:5,c=a[BO];if(id(t,"rotatable")){var u=e.pos1,d=e.pos2,h=e.pos3,p=e.pos4,m=e.origin,b=n*Math.PI/180,w=[u,d,h,p].map(function(j){return He(j,m)}),S=w.map(function(j){return Bh(j,b)}),E=Ce(Ce([],ne(IW(t,w,S,m,n)),!1),ne(qW(t,w,S,m,n)),!1);E.sort(function(j,O){return Te(j-n)-Te(O-n)});var T=E.length>0;if(T)return{isSnap:T,dist:T?E[0]:n}}if(c?.length&&o){var C=c.slice().sort(function(j,O){return Yb(j,r)-Yb(O,r)}),N=C[0];if(Yb(N,r)<=o)return{isSnap:!0,dist:n+gK(r,N)-r}}return{isSnap:!1,dist:n}}function vK(t,e,n,r,i,a,o){if(!id(t,"resizable"))return[0,0];var c=o.fixedDirection,u=o.nextAllMatrix,d=t.state,h=d.allMatrix,p=d.is3d;return eP(t,function(m,b){return JO(u||h,e+m,n+b,c,i,p)},e,n,r,i,a,o)}function yK(t,e,n,r,i){if(!id(t,"scalable"))return[0,0];var a=i.startOffsetWidth,o=i.startOffsetHeight,c=i.fixedPosition,u=i.fixedDirection,d=i.is3d,h=eP(t,function(p,m){return JO(vW(i,At(e,[p/a,m/o])),a,o,u,c,d)},a,o,n,c,r,i);return[h[0]/a,h[1]/o]}function bK(t,e){e.absolutePoses=Di(t.state)}function kR(t){var e=[];return t.forEach(function(n){n.guidelineInfos.forEach(function(r){var i=r.guideline;zr(e,function(a){return a.guideline===i})||(i.direction="",e.push({guideline:i,posInfo:n}))})}),e.map(function(n){var r=n.guideline,i=n.posInfo;return ee(ee({},r),{direction:i.direction})})}function RR(t,e,n,r,i,a){var o=U_(X0(t,a),e,n),c=o.vertical,u=o.horizontal,d=du();c.forEach(function(w){w.isBound&&(w.direction==="start"&&(d.left=!0),w.direction==="end"&&(d.right=!0),r.push({type:"bounds",pos:w.pos}))}),u.forEach(function(w){w.isBound&&(w.direction==="start"&&(d.top=!0),w.direction==="end"&&(d.bottom=!0),i.push({type:"bounds",pos:w.pos}))});var h=YW(t),p=h.boundMap,m=h.vertical,b=h.horizontal;return m.forEach(function(w){Ds(r,function(S){var E=S.type,T=S.pos;return E==="bounds"&&T===w})>=0||r.push({type:"bounds",pos:w})}),b.forEach(function(w){Ds(i,function(S){var E=S.type,T=S.pos;return E==="bounds"&&T===w})>=0||i.push({type:"bounds",pos:w})}),{boundMap:d,innerBoundMap:p}}var xK=Q_("",["resizable","scalable"]),wK={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold","snapGridAll",LO,BO,UO,FO,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(t,e){var n=t.state,r=n.top,i=n.left,a=n.pos1,o=n.pos2,c=n.pos3,u=n.pos4,d=n.snapRenderInfo,h=t.props.snapRenderThreshold,p=h===void 0?1:h;if(!d||!d.render||!id(t,""))return hu(t,"boundMap",du(),function(W){return JSON.stringify(W)}),hu(t,"innerBoundMap",du(),function(W){return JSON.stringify(W)}),[];n.guidelines=S1(t);var m=Math.min(a[0],o[0],c[0],u[0]),b=Math.min(a[1],o[1],c[1],u[1]),w=d.externalPoses||[],S=Di(t.state),E=[],T=[],C=[],N=[],j=[],O=ki(S),M=O.width,A=O.height,k=O.top,D=O.left,V=O.bottom,L=O.right,U={left:D,right:L,top:k,bottom:V,center:(D+L)/2,middle:(k+V)/2},P=w.length>0,K=P?ki(w):{};if(!d.request){if(d.direction&&j.push(LW(t,S,d.direction,p,p)),d.snap){var X=ki(S);d.center&&(X.middle=(X.top+X.bottom)/2,X.center=(X.left+X.right)/2),j.push(vR(t,X,p,p))}P&&(d.center&&(K.middle=(K.top+K.bottom)/2,K.center=(K.left+K.right)/2),j.push(vR(t,K,p,p))),j.forEach(function(W){var le=W.vertical.posInfos,ie=W.horizontal.posInfos;E.push.apply(E,Ce([],ne(le.filter(function(pe){var ce=pe.guidelineInfos;return ce.some(function(xe){var Re=xe.guideline;return!Re.hide})}).map(function(pe){return{type:"snap",pos:pe.pos}})),!1)),T.push.apply(T,Ce([],ne(ie.filter(function(pe){var ce=pe.guidelineInfos;return ce.some(function(xe){var Re=xe.guideline;return!Re.hide})}).map(function(pe){return{type:"snap",pos:pe.pos}})),!1)),C.push.apply(C,Ce([],ne(kR(le)),!1)),N.push.apply(N,Ce([],ne(kR(ie)),!1))})}var q=RR(t,[D,L],[k,V],E,T),Q=q.boundMap,te=q.innerBoundMap;P&&RR(t,[K.left,K.right],[K.top,K.bottom],E,T,d.externalBounds);var se=Ce(Ce([],ne(C),!1),ne(N),!1),G=se.filter(function(W){return W.element&&!W.gapRects}),F=se.filter(function(W){return W.gapRects}).sort(function(W,le){return W.gap-le.gap});je(t,"onSnap",{guidelines:se.filter(function(W){var le=W.element;return!le}),elements:G,gaps:F},!0);var Y=hu(t,"boundMap",Q,function(W){return JSON.stringify(W)},du()),Z=hu(t,"innerBoundMap",te,function(W){return JSON.stringify(W)},du());return(Q===Y||te===Z)&&je(t,"onBound",{bounds:Q,innerBounds:te},!0),Ce(Ce(Ce(Ce(Ce(Ce([],ne(sK(t,G,[m,b],U,e)),!1),ne(oK(t,F,[m,b],U,e)),!1),ne(TR(t,"horizontal",N,[i,r],U,e)),!1),ne(TR(t,"vertical",C,[i,r],U,e)),!1),ne(ER(t,"horizontal",T,m,r,M,0,e)),!1),ne(ER(t,"vertical",E,b,i,A,1,e)),!1)},dragStart:function(t,e){t.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},jg(t)},drag:function(t){var e=t.state;jg(t)||(e.guidelines=S1(t)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart:function(t){this.unset(t)},dragEnd:function(t){this.unset(t)},dragControlCondition:function(t,e){if(xK(t,e)||_1(t,e))return!0;if(!e.isRequest&&e.inputEvent)return Un(e.inputEvent.target,Fe("snap-control"))},dragControlStart:function(t){t.state.snapRenderInfo=null,jg(t)},dragControl:function(t){this.drag(t)},dragControlEnd:function(t){this.unset(t)},dragGroupStart:function(t,e){this.dragStart(t,e)},dragGroup:function(t){this.drag(t)},dragGroupEnd:function(t){this.unset(t)},dragGroupControlStart:function(t){t.state.snapRenderInfo=null,jg(t)},dragGroupControl:function(t){this.drag(t)},dragGroupControlEnd:function(t){this.unset(t)},unset:function(t){var e=t.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function _K(t,e){return[t[0]*e[0],t[1]*e[1]]}function Fe(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return vY.apply(void 0,Ce([V_],ne(t),!1))}function tP(t){t()}function SK(t){return!t||t==="none"?[1,0,0,1,0,0]:ea(t)?t:sh(t)}function jf(t,e,n){return $m(e,ec(n,e),t,ec(n.map(function(r){return-r}),e))}function EK(t,e,n){if(e==="%"){var r=Y_(t.ownerSVGElement);return r[n?"width":"height"]/100}return 1}function TK(t){var e=AK(W_(t,":before"));return e.map(function(n,r){var i=jh(n),a=i.value,o=i.unit;return a*EK(t,o,r===0)})}function Wm(t){return t?t.split(" "):["0","0"]}function AK(t){return Wm(t.transformOrigin)}function nP(t){var e=Lr(t),n=e("transform");if(n&&n!=="none")return n;if("transform"in t){var r=t.transform,i=r.baseVal;if(!i)return"";var a=i.length;if(!a)return"";for(var o=[],c=function(d){var h=i[d].matrix;o.push("matrix(".concat(["a","b","c","d","e","f"].map(function(p){return h[p]}).join(", "),")"))},u=0;u<a;++u)c(u);return o.join(" ")}return""}function lh(t,e,n,r,i){var a,o,c=A_(t)||nl(t),u=!1,d,h;if(!t||n)d=t;else{var p=(a=t?.assignedSlot)===null||a===void 0?void 0:a.parentElement,m=t.parentElement;p?(u=!0,h=m,d=p):d=m}for(var b=!1,w=t===e||d===e,S="relative",E=1,T=parseFloat(i?.("zoom"))||1,C=i?.("position");d&&d!==c;){e===d&&(w=!0);var N=Lr(d),j=d.tagName.toLowerCase(),O=nP(d),M=N("willChange"),A=parseFloat(N("zoom"))||1;if(S=N("position"),r&&A!==1){E=A;break}if(!n&&r&&T!==1&&C&&C!=="absolute"||j==="svg"||j==="foreignobject"||S!=="static"||O&&O!=="none"||M==="transform")break;var k=(o=t?.assignedSlot)===null||o===void 0?void 0:o.parentNode,D=d.parentNode;k&&(u=!0,h=D);var V=D;if(V&&V.nodeType===11){d=V.host,b=!0,S=Lr(d)("position");break}d=V,S="relative"}return{offsetZoom:E,hasSlot:u,parentSlotElement:h,isCustomElement:b,isStatic:S==="static",isEnd:w||!d||d===c,offsetParent:d||c}}function CK(t,e){var n,r=t.tagName.toLowerCase(),i=t.offsetLeft,a=t.offsetTop,o=Lr(t),c=B0(i),u=!c,d,h;return!u&&(r!=="svg"||t.ownerSVGElement)?(d=wO?TK(t):Wm(o("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice(),u=!0,r==="svg"?(i=0,a=0):(n=ne(NK(t,d,t===e&&e.tagName.toLowerCase()==="g"),4),i=n[0],a=n[1],d[0]=n[2],d[1]=n[3])):(d=Wm(o("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice()),{tagName:r,isSVG:c,hasOffset:u,offset:[i||0,a||0],origin:d,targetOrigin:h}}function rP(t,e){var n=Lr(t),r=Lr(nl(t)),i=r("position");if(!e&&(!i||i==="static"))return[0,0];var a=parseInt(r("marginLeft"),10),o=parseInt(r("marginTop"),10);return n("position")==="absolute"&&((n("top")!=="auto"||n("bottom")!=="auto")&&(o=0),(n("left")!=="auto"||n("right")!=="auto")&&(a=0)),[a,o]}function E1(t){t.forEach(function(e){var n=e.matrix;n&&(e.matrix=ta(n,3,4))})}function kK(t){for(var e=t.parentElement,n=!1,r=nl(t);e;){var i=W_(e).transform;if(i&&i!=="none"){n=!0;break}if(e===r)break;e=e.parentElement}return{fixedContainer:e||r,hasTransform:n}}function Q0(t,e){return e===void 0&&(e=t.length>9),"".concat(e?"matrix3d":"matrix","(").concat(hO(t,!e).join(","),")")}function Y_(t){var e=t.clientWidth,n=t.clientHeight;if(!t)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:n};var r=t.viewBox,i=r&&r.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||n,clientWidth:e,clientHeight:n}}function RK(t,e){var n,r=Y_(t),i=r.width,a=r.height,o=r.clientWidth,c=r.clientHeight,u=o/i,d=c/a,h=t.preserveAspectRatio.baseVal,p=h.align,m=h.meetOrSlice,b=[0,0],w=[u,d],S=[0,0];if(p!==1){var E=(p-2)%3,T=Math.floor((p-2)/3);b[0]=i*E/2,b[1]=a*T/2;var C=m===2?Math.max(d,u):Math.min(u,d);w[0]=C,w[1]=C,S[0]=(o-i)/2*E,S[1]=(c-a)/2*T}var N=M_(w,e);return n=ne(S,2),N[e*(e-1)]=n[0],N[e*(e-1)+1]=n[1],jf(N,e,b)}function NK(t,e,n){var r=t.tagName.toLowerCase();if(!t.getBBox||!n&&r==="g")return[0,0,0,0];var i=Lr(t),a=i("transform-box")==="fill-box",o=t.getBBox(),c=Y_(t.ownerSVGElement),u=o.x,d=o.y;r==="foreignobject"&&!u&&!d&&(u=parseFloat(t.getAttribute("x"))||0,d=parseFloat(t.getAttribute("y"))||0);var h=u-c.x,p=d-c.y,m=a?e[0]:e[0]-h,b=a?e[1]:e[1]-p;return[h,p,m,b]}function an(t,e,n){return fr(t,Jl(e,n),n)}function cc(t,e,n,r){return[[0,0],[e,0],[0,n],[e,n]].map(function(i){return an(t,i,r)})}function ki(t){var e=t.map(function(d){return d[0]}),n=t.map(function(d){return d[1]}),r=Math.min.apply(Math,Ce([],ne(e),!1)),i=Math.min.apply(Math,Ce([],ne(n),!1)),a=Math.max.apply(Math,Ce([],ne(e),!1)),o=Math.max.apply(Math,Ce([],ne(n),!1)),c=a-r,u=o-i;return{left:r,top:i,right:a,bottom:o,width:c,height:u}}function NR(t,e,n,r){var i=cc(t,e,n,r);return ki(i)}function DK(t,e,n,r,i){var a,o=t.target,c=t.origin,u=e.matrix,d=aP(o),h=d.offsetWidth,p=d.offsetHeight,m=n.getBoundingClientRect(),b=[0,0];n===nl(n)&&(b=rP(o,!0));for(var w=o.getBoundingClientRect(),S=w.left-m.left+n.scrollLeft-(n.clientLeft||0)+b[0],E=w.top-m.top+n.scrollTop-(n.clientTop||0)+b[1],T=w.width,C=w.height,N=$m(r,i,u),j=NR(N,h,p,r),O=j.left,M=j.top,A=j.width,k=j.height,D=an(N,c,r),V=He(D,[O,M]),L=[S+V[0]*T/A,E+V[1]*C/k],U=[0,0],P=0;++P<10;){var K=Ua(i,r);a=ne(He(an(K,L,r),an(K,D,r)),2),U[0]=a[0],U[1]=a[1];var X=$m(r,i,ec(U,r),u),q=NR(X,h,p,r),Q=q.left,te=q.top,se=Q-S,G=te-E;if(Te(se)<2&&Te(G)<2)break;L[0]-=se,L[1]-=G}return U.map(function(F){return Math.round(F)})}function IK(t,e,n){var r=t.length===16,i=r?4:3,a=e.map(function(u){return an(t,u,i)}),o=n.left,c=n.top;return a.map(function(u){return[u[0]+o,u[1]+c]})}function Ni(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function iP(t,e){return Ni([e[0]-t[0],e[1]-t[1]])}function xf(t,e,n,r){n===void 0&&(n=1),r===void 0&&(r=wn(t,e));var i=iP(t,e);return{transform:"translateY(-50%) translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(r,"rad) scaleY(").concat(n,")"),width:"".concat(i,"px")}}function Km(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n.length,a=n.reduce(function(c,u){return c+u[0]},0)/i,o=n.reduce(function(c,u){return c+u[1]},0)/i;return{transform:"translateZ(0px) translate(".concat(a,"px, ").concat(o,"px) rotate(").concat(t,"rad) scale(").concat(e,")")}}function nc(t,e){var n=t[e];return ea(n)?ee(ee({},t),n):t}function aP(t){var e=t&&!B0(t.offsetWidth),n=0,r=0,i=0,a=0,o=0,c=0,u=0,d=0,h=0,p=0,m=0,b=0,w=1/0,S=1/0,E=1/0,T=1/0,C=0,N=0,j=!1;if(t)if(!e&&t.ownerSVGElement){var O=t.getBBox();j=!0,n=O.width,r=O.height,o=n,c=r,u=n,d=r,i=n,a=r}else{var M=Lr(t),A=t.style,k=M("boxSizing")==="border-box",D=parseFloat(M("borderLeftWidth"))||0,V=parseFloat(M("borderRightWidth"))||0,L=parseFloat(M("borderTopWidth"))||0,U=parseFloat(M("borderBottomWidth"))||0,P=parseFloat(M("paddingLeft"))||0,K=parseFloat(M("paddingRight"))||0,X=parseFloat(M("paddingTop"))||0,q=parseFloat(M("paddingBottom"))||0,Q=P+K,te=X+q,se=D+V,G=L+U,F=Q+se,Y=te+G,Z=M("position"),W=0,le=0;if("clientLeft"in t){var ie=null;if(Z==="absolute"){var pe=lh(t,nl(t));ie=pe.offsetParent}else ie=t.parentElement;if(ie){var ce=Lr(ie);W=parseFloat(ce("width")),le=parseFloat(ce("height"))}}h=Math.max(Q,$t(M("minWidth"),W)||0),p=Math.max(te,$t(M("minHeight"),le)||0),w=$t(M("maxWidth"),W),S=$t(M("maxHeight"),le),isNaN(w)&&(w=1/0),isNaN(S)&&(S=1/0),C=$t(A.width,0)||0,N=$t(A.height,0)||0,o=parseFloat(M("width"))||0,c=parseFloat(M("height"))||0,u=Te(o-C)<1?r1(h,C||o,w):o,d=Te(c-N)<1?r1(p,N||c,S):c,n=u,r=d,i=u,a=d,k?(E=w,T=S,m=h,b=p,u=n-F,d=r-Y):(E=w+F,T=S+Y,m=h+F,b=p+Y,n=u+F,r=d+Y),i=u+Q,a=d+te}return{svg:j,offsetWidth:n,offsetHeight:r,clientWidth:i,clientHeight:a,contentWidth:u,contentHeight:d,inlineCSSWidth:C,inlineCSSHeight:N,cssWidth:o,cssHeight:c,minWidth:h,minHeight:p,maxWidth:w,maxHeight:S,minOffsetWidth:m,minOffsetHeight:b,maxOffsetWidth:E,maxOffsetHeight:T}}function sP(t,e){return wn(e>0?t[0]:t[1],e>0?t[1]:t[0])}function Vg(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function oP(t,e){var n=t===nl(t)||t===A_(t),r={clientLeft:t.clientLeft,clientTop:t.clientTop,clientWidth:t.clientWidth,clientHeight:t.clientHeight,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight,overflow:!1};return n&&(r.clientHeight=Math.max(e.height,r.clientHeight),r.scrollHeight=Math.max(e.height,r.scrollHeight)),r.overflow=Lr(t)("overflow")!=="visible",ee(ee({},e),r)}function Xb(t,e,n,r){var i=t.left,a=t.right,o=t.top,c=t.bottom,u=e.top,d=e.left,h={left:d+i,top:u+o,right:d+a,bottom:u+c,width:a-i,height:c-o};return n&&r?oP(n,h):h}function Vf(t,e){var n=0,r=0,i=0,a=0;if(t){var o=t.getBoundingClientRect();n=o.left,r=o.top,i=o.width,a=o.height}var c={left:n,top:r,width:i,height:a,right:n+i,bottom:r+a};return t&&e?oP(t,c):c}function MK(t){var e=t.props,n=e.groupable,r=e.svgOrigin,i=t.getState(),a=i.offsetWidth,o=i.offsetHeight,c=i.svg,u=i.transformOrigin;return!n&&c&&r?J_(r,a,o):u}function lP(t,e,n,r){var i;if(t)i=t;else if(e)i=[0,0];else{var a=n.target;i=cP(a,r)}return i}function cP(t,e){if(t){var n=t.getAttribute("data-rotation")||"",r=t.getAttribute("data-direction");if(e.deg=n,!!r){var i=[0,0];return r.indexOf("w")>-1&&(i[0]=-1),r.indexOf("e")>-1&&(i[0]=1),r.indexOf("n")>-1&&(i[1]=-1),r.indexOf("s")>-1&&(i[1]=1),i}}}function X_(t,e){return[At(e,t[0]),At(e,t[1]),At(e,t[2]),At(e,t[3])]}function Di(t){var e=t.left,n=t.top,r=t.pos1,i=t.pos2,a=t.pos3,o=t.pos4;return X_([r,i,a,o],[e,n])}function T1(t,e){t[e?"controlAbles":"targetAbles"].forEach(function(n){n.unset&&n.unset(t)})}function fu(t,e){var n=e?"controlGesto":"targetGesto",r=t[n];r?.isIdle()===!1&&T1(t,e),r?.unset(),t[n]=null}function wr(t,e){if(e){var n=rd(e);n.nextStyle=ee(ee({},n.nextStyle),t)}return{style:t,cssText:Is(t).map(function(r){return"".concat(am(r,"-"),": ").concat(t[r],";")}).join("")}}function uP(t,e,n){var r=e.afterTransform||e.transform;return ee(ee({},wr(ee(ee(ee({},t.style),e.style),{transform:r}),n)),{afterTransform:r,transform:t.transform})}function ct(t,e,n,r){var i=e.datas;i.datas||(i.datas={});var a=ee(ee({},n),{target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,moveable:t,datas:i.datas,isRequest:e.isRequest,isRequestChild:e.isRequestChild,isFirstDrag:!!e.isFirstDrag,isTrusted:e.isTrusted!==!1,stopAble:function(){i.isEventStart=!1},stopDrag:function(){var o;(o=e.stop)===null||o===void 0||o.call(e)}});return i.isStartEvent?r||(i.lastEvent=a):i.isStartEvent=!0,a}function ri(t,e,n){var r=e.datas,i="isDrag"in n?n.isDrag:e.isDrag;return r.datas||(r.datas={}),ee(ee({isDrag:i},n),{moveable:t,target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,lastEvent:r.lastEvent,isDouble:e.isDouble,datas:r.datas,isFirstDrag:!!e.isFirstDrag})}function Z0(t,e,n){t._emitter.on(e,n)}function je(t,e,n,r,i){return t.triggerEvent(e,n,r,i)}function W_(t,e){return Oo(t).getComputedStyle(t,e)}function zg(t,e,n){var r={},i={};return t.filter(function(a){var o=a.name;if(r[o]||!e.some(function(c){return a[c]}))return!1;if(!n&&a.ableGroup){if(i[a.ableGroup])return!1;i[a.ableGroup]=!0}return r[o]=!0,!0})}function A1(t,e){return t===e||t==null&&e==null}function DR(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=t.length-1,r=0;r<n;++r){var i=t[r];if(!B0(i))return i}return t[n]}function dP(t,e){var n=[],r=[];return t.forEach(function(i,a){var o=e(i,a,t),c=r.indexOf(o),u=n[c]||[];c===-1&&(r.push(o),n.push(u)),u.push(i)}),n}function OK(t,e){var n=[],r={};return t.forEach(function(i,a){var o=e(i,a,t),c=r[o];c||(c=[],r[o]=c,n.push(c)),c.push(i)}),n}function fP(t){return t.reduce(function(e,n){return e.concat(n)},[])}function ju(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.sort(function(n,r){return Te(r)-Te(n)}),t[0]}function Vu(t,e,n){return fr(Ua(t,n),Jl(e,n),n)}function PK(t,e){var n,r=t.is3d,i=t.rootMatrix,a=r?4:3;return n=ne(Vu(i,[e.distX,e.distY],a),2),e.distX=n[0],e.distY=n[1],e}function bi(t,e,n,r){if(!n[0]&&!n[1])return e;var i=an(t,[CR(n[0]||1),0],r),a=an(t,[0,CR(n[1]||1)],r),o=an(t,[n[0]/Ni(i),n[1]/Ni(a)],r);return At(e,o)}function Hi(t,e,n){return n?"".concat(t/e*100,"%"):"".concat(t,"px")}function Qm(t){return Te(t)<=Er?0:t}function K_(t){return function(e){if(!e.isDragging(t))return"";var n=EW(e,t),r=n.deg;return r?Fe("view-control-rotation".concat(r)):""}}function Q_(t,e){return e===void 0&&(e=[t]),function(n,r){if(r.isRequest)return e.some(function(a){return r.requestAble===a})?r.parentDirection:!1;var i=r.inputEvent.target;return Un(i,Fe("direction"))&&(!t||Un(i,Fe(t)))}}function jK(t,e,n){var r,i=Mu(t,{"x%":function(O){return O/100*e.offsetWidth},"y%":function(O){return O/100*e.offsetHeight}}),a=t.slice(0,n<0?void 0:n),o=t.slice(0,n<0?void 0:n+1),c=t[n]||"",u=n<0?[]:t.slice(n),d=n<0?[]:t.slice(n+1),h=i.slice(0,n<0?void 0:n),p=i.slice(0,n<0?void 0:n+1),m=(r=i[n])!==null&&r!==void 0?r:Mu([""])[0],b=n<0?[]:i.slice(n),w=n<0?[]:i.slice(n+1),S=m?[m]:[],E=nu(h),T=nu(p),C=nu(b),N=nu(w),j=Gt(E,C,4);return{transforms:t,beforeFunctionMatrix:E,beforeFunctionMatrix2:T,targetFunctionMatrix:nu(S),afterFunctionMatrix:C,afterFunctionMatrix2:N,allFunctionMatrix:j,beforeFunctions:h,beforeFunctions2:p,targetFunction:S[0],afterFunctions:b,afterFunctions2:w,beforeFunctionTexts:a,beforeFunctionTexts2:o,targetFunctionText:c,afterFunctionTexts:u,afterFunctionTexts2:d}}function VK(t){return!t||!ea(t)||td(t)?!1:Vn(t)||"length"in t}function za(t,e){return t?td(t)?t:Vr(t)?e?document.querySelector(t):t:S_(t)?t():H4(t)?t:"current"in t?t.current:t:null}function Z_(t,e){if(!t)return[];var n=VK(t)?[].slice.call(t):[t];return n.reduce(function(r,i){return Vr(i)&&e?Ce(Ce([],ne(r),!1),ne([].slice.call(document.querySelectorAll(i))),!1):(Vn(i)?r.push(Z_(i,e)):r.push(za(i,e)),r)},[])}function zK(t,e,n){var r=wn(t,e)/Math.PI*180;return r=n>=0?r:180-r,r=r>=0?r:360+r,r}function IR(t,e){var n=t.rootMatrix,r=t.is3d,i=r?4:3,a=Ua(n,i);return r||(a=ta(a,3,4)),a[12]=0,a[13]=0,a[14]=0,wX(a,e)}function hP(t,e,n,r,i){var a=ne(t,2),o=a[0],c=a[1],u=0,d=0;if(i&&o&&c){var h=wn([0,0],e),p=wn([0,0],r),m=Ni(e),b=Math.cos(h-p)*m;if(!r[0])d=b,u=d*n;else if(!r[1])u=b,d=u/n;else{var w=r[0]*o,S=r[1]*c,E=Math.atan2(w+e[0],S+e[1]),T=Math.atan2(w,S);E<0&&(E+=Math.PI*2),T<0&&(T+=Math.PI*2);var C=0;Te(E-T)<Math.PI/2||Te(E-T)>Math.PI/2*3||(T+=Math.PI),C=E-T,C>Math.PI*2?C-=Math.PI*2:C>Math.PI?C=2*Math.PI-C:C<-Math.PI&&(C=-2*Math.PI-C);var N=Ni([w+e[0],S+e[1]])*Math.cos(C);u=N*Math.sin(T)-w,d=N*Math.cos(T)-S,r[0]<0&&(u*=-1),r[1]<0&&(d*=-1)}}else u=r[0]*e[0],d=r[1]*e[1];return[u,d]}function pP(t,e,n,r){var i,a=n.ratio,o=n.startOffsetWidth,c=n.startOffsetHeight,u=0,d=0,h=r.distX,p=r.distY,m=r.pinchScale,b=r.parentDistance,w=r.parentDist,S=r.parentScale,E=n.fixedDirection,T=[0,1].map(function(A){return Te(t[A]-E[A])}),C=[0,1].map(function(A){var k=T[A];return k!==0&&(k=2/k),k});if(w)u=w[0],d=w[1],e&&(u?d||(d=u/a):u=d*a);else if(Iu(m))u=(m-1)*o,d=(m-1)*c;else if(S)u=(S[0]-1)*o,d=(S[1]-1)*c;else if(b){var N=o*T[0],j=c*T[1],O=Ni([N,j]);u=b/O*N*C[0],d=b/O*j*C[1]}else{var M=Ha({datas:n,distX:h,distY:p});M=C.map(function(A,k){return M[k]*A}),i=ne(hP([o,c],M,a,t,e),2),u=i[0],d=i[1]}return{distWidth:u,distHeight:d}}function C1(t,e){if(e){if(t==="left")return{x:"0%",y:"50%"};if(t==="top")return{x:"50%",y:"50%"};if(t==="center")return{x:"50%",y:"50%"};if(t==="right")return{x:"100%",y:"50%"};if(t==="bottom")return{x:"50%",y:"100%"};var n=ne(t.split(" "),2),r=n[0],i=n[1],a=C1(r||""),o=C1(i||""),c=ee(ee({},a),o),u={x:"50%",y:"50%"};return c.x&&(u.x=c.x),c.y&&(u.y=c.y),c.value&&(c.x&&!c.y&&(u.y=c.value),!c.x&&c.y&&(u.x=c.value)),u}return t==="left"?{x:"0%"}:t==="right"?{x:"100%"}:t==="top"?{y:"0%"}:t==="bottom"?{y:"100%"}:t?t==="center"?{value:"50%"}:{value:t}:{}}function J_(t,e,n){var r=C1(t,!0),i=r.x,a=r.y;return[$t(i,e)||0,$t(a,n)||0]}function LK(t,e,n){var r=t.map(function(a){return He(a,e)}),i=r.map(function(a){return Bh(a,n)});return{prev:r,next:i,result:i.map(function(a){return At(a,e)})}}function gP(t,e){return t.length===e.length&&t.every(function(n,r){var i=e[r],a=Vn(n),o=Vn(i);return a&&o?gP(n,i):!a&&!o?n===i:!1})}function hu(t,e,n,r,i){var a=t._store,o=a[e];if(!(e in a))if(i!=null)a[e]=i,o=i;else return a[e]=n,n;return o===n||r(o)===r(n)?o:(a[e]=n,n)}function br(t){return t>=0?1:-1}function Te(t){return Math.abs(t)}function Wb(t,e){return OY(t).map(function(n){return e(n)})}function mP(t){return Iu(t)?{top:t,left:t,right:t,bottom:t}:{left:t.left||0,top:t.top||0,right:t.right||0,bottom:t.bottom||0}}var BK=$h("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(t,e){var n=e.datas,r=e.targets,i=e.angle,a=e.originalDatas,o=t.props,c=o.pinchable,u=o.ables;if(!c)return!1;var d="onPinch".concat(r?"Group":"","Start"),h="drag".concat(r?"Group":"","ControlStart"),p=(c===!0?t.controlAbles:u.filter(function(S){return c.indexOf(S.name)>-1})).filter(function(S){return S.canPinch&&S[h]}),m=ct(t,e,{});r&&(m.targets=r);var b=je(t,d,m);n.isPinch=b!==!1,n.ables=p;var w=n.isPinch;return w?(p.forEach(function(S){if(a[S.name]=a[S.name]||{},!!S[h]){var E=ee(ee({},e),{datas:a[S.name],parentRotate:i,isPinch:!0});S[h](t,E)}}),t.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},w):!1},pinch:function(t,e){var n=e.datas,r=e.scale,i=e.distance,a=e.originalDatas,o=e.inputEvent,c=e.targets,u=e.angle;if(n.isPinch){var d=i*(1-1/r),h=ct(t,e,{});c&&(h.targets=c);var p="onPinch".concat(c?"Group":"");je(t,p,h);var m=n.ables,b="drag".concat(c?"Group":"","Control");return m.forEach(function(w){w[b]&&w[b](t,ee(ee({},e),{datas:a[w.name],inputEvent:o,resolveMatrix:!0,pinchScale:r,parentDistance:d,parentRotate:u,isPinch:!0}))}),h}},pinchEnd:function(t,e){var n=e.datas,r=e.isPinch,i=e.inputEvent,a=e.targets,o=e.originalDatas;if(n.isPinch){var c="onPinch".concat(a?"Group":"","End"),u=ri(t,e,{isDrag:r});a&&(u.targets=a),je(t,c,u);var d=n.ables,h="drag".concat(a?"Group":"","ControlEnd");return d.forEach(function(p){p[h]&&p[h](t,ee(ee({},e),{isDrag:r,datas:o[p.name],inputEvent:i,isPinch:!0}))}),r}},pinchGroupStart:function(t,e){return this.pinchStart(t,ee(ee({},e),{targets:t.props.targets}))},pinchGroup:function(t,e){return this.pinch(t,ee(ee({},e),{targets:t.props.targets}))},pinchGroupEnd:function(t,e){return this.pinchEnd(t,ee(ee({},e),{targets:t.props.targets}))}}),MR=Q_("scalable"),UK={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:jO("scalable"),dragControlCondition:MR,viewClassName:K_("scalable"),dragControlStart:function(t,e){var n=e.datas,r=e.isPinch,i=e.inputEvent,a=e.parentDirection,o=lP(a,r,i,n),c=t.state,u=c.width,d=c.height,h=c.targetTransform,p=c.target,m=c.pos1,b=c.pos2,w=c.pos4;if(!o||!p)return!1;r||lc(t,e),n.datas={},n.transform=h,n.prevDist=[1,1],n.direction=o,n.startOffsetWidth=u,n.startOffsetHeight=d,n.startValue=[1,1];var S=!o[0]&&!o[1]||o[0]||!o[1];Y0(t,e,"scale"),n.isWidth=S;function E(M){n.ratio=M&&isFinite(M)?M:0}n.startPositions=Di(t.state);function T(M){var A=XO(n.startPositions,M);n.fixedDirection=A.fixedDirection,n.fixedPosition=A.fixedPosition,n.fixedOffset=A.fixedOffset}n.setFixedDirection=T,E(_s(m,b)/_s(b,w)),T([-o[0],-o[1]]);var C=function(M){n.minScaleSize=M},N=function(M){n.maxScaleSize=M};C([-1/0,-1/0]),N([1/0,1/0]);var j=ct(t,e,ee(ee({direction:o,set:function(M){n.startValue=M},setRatio:E,setFixedDirection:T,setMinScaleSize:C,setMaxScaleSize:N},q0(t,e)),{dragStart:yr.dragStart(t,new Ou().dragStart([0,0],e))})),O=je(t,"onScaleStart",j);return n.startFixedDirection=n.fixedDirection,O!==!1&&(n.isScale=!0,t.state.snapRenderInfo={request:e.isRequest,direction:o}),n.isScale?j:!1},dragControl:function(t,e){G0(t,e,"scale");var n=e.datas,r=e.parentKeepRatio,i=e.parentFlag,a=e.isPinch,o=e.dragClient,c=e.isRequest,u=e.useSnap,d=e.resolveMatrix,h=n.prevDist,p=n.direction,m=n.startOffsetWidth,b=n.startOffsetHeight,w=n.isScale,S=n.startValue,E=n.isWidth,T=n.ratio;if(!w)return!1;var C=t.props,N=C.throttleScale,j=C.parentMoveable,O=p;!p[0]&&!p[1]&&(O=[1,1]);var M=T&&(r??C.keepRatio)||!1,A=t.state,k=[S[0],S[1]];function D(){var ae=pP(O,M,n,e),Ee=ae.distWidth,Ne=ae.distHeight,Ie=m?(m+Ee)/m:1,Oe=b?(b+Ne)/b:1;S[0]||(k[0]=Ee/m),S[1]||(k[1]=Ne/b);var Ve=(O[0]||M?Ie:1)*k[0],Se=(O[1]||M?Oe:1)*k[1];return Ve===0&&(Ve=br(h[0])*Mg),Se===0&&(Se=br(h[1])*Mg),[Ve,Se]}var V=D();if(!a&&t.props.groupable){var L=A.snapRenderInfo||{},U=L.direction;Vn(U)&&(U[0]||U[1])&&(A.snapRenderInfo={direction:p,request:e.isRequest})}je(t,"onBeforeScale",ct(t,e,{scale:V,setFixedDirection:function(ae){return n.setFixedDirection(ae),V=D(),V},startFixedDirection:n.startFixedDirection,setScale:function(ae){V=ae}},!0));var P=[V[0]/k[0],V[1]/k[1]],K=o,X=[0,0],q=br(P[0]*P[1]),Q=!o&&!i&&a;if(Q||d?K=B_(t,n.targetAllTransform,[0,0],[0,0],n):o||(K=n.fixedPosition),a||(X=yK(t,P,p,!u&&c,n)),M){O[0]&&O[1]&&X[0]&&X[1]&&(Math.abs(X[0]*m)>Math.abs(X[1]*b)?X[1]=0:X[0]=0);var te=!X[0]&&!X[1];if(te&&(E?P[0]=rt(P[0]*k[0],N)/k[0]:P[1]=rt(P[1]*k[1],N)/k[1]),O[0]&&!O[1]||X[0]&&!X[1]||te&&E){P[0]+=X[0];var se=m*P[0]*k[0]/T;P[1]=br(q*P[0])*Te(se/b/k[1])}else if(!O[0]&&O[1]||!X[0]&&X[1]||te&&!E){P[1]+=X[1];var G=b*P[1]*k[1]*T;P[0]=br(q*P[1])*Te(G/m/k[0])}}else P[0]+=X[0],P[1]+=X[1],X[0]||(P[0]=rt(P[0]*k[0],N)/k[0]),X[1]||(P[1]=rt(P[1]*k[1],N)/k[1]);P[0]===0&&(P[0]=br(h[0])*Mg),P[1]===0&&(P[1]=br(h[1])*Mg),V=_K(P,[k[0],k[1]]);var F=[m,b],Y=[m*V[0],b*V[1]];Y=B4(Y,n.minScaleSize,n.maxScaleSize,M?T:!1),V=Wb(2,function(ae){return F[ae]?Y[ae]/F[ae]:Y[ae]}),P=Wb(2,function(ae){return V[ae]/k[ae]});var Z=Wb(2,function(ae){return h[ae]?P[ae]/h[ae]:P[ae]}),W="scale(".concat(P.join(", "),")"),le="scale(".concat(V.join(", "),")"),ie=H0(n,le,W),pe=!S[0]||!S[1],ce=yW(t,pe?le:W,n.fixedDirection,K,n.fixedOffset,n,pe),xe=Q?ce:He(ce,n.prevInverseDist||[0,0]);if(n.prevDist=P,n.prevInverseDist=ce,V[0]===h[0]&&V[1]===h[1]&&xe.every(function(ae){return!ae})&&!j&&!Q)return!1;var Re=ct(t,e,ee({offsetWidth:m,offsetHeight:b,direction:p,scale:V,dist:P,delta:Z,isPinch:!!a},NO(t,ie,xe,a,e)));return je(t,"onScale",Re),Re},dragControlEnd:function(t,e){var n=e.datas;if(!n.isScale)return!1;n.isScale=!1;var r=ri(t,e,{});return je(t,"onScaleEnd",r),r},dragGroupControlCondition:MR,dragGroupControlStart:function(t,e){var n=e.datas,r=this.dragControlStart(t,e);if(!r)return!1;var i=Wi(t,"resizable",e);n.moveableScale=t.scale;var a=Ss(t,this,"dragControlStart",e,function(d,h){return qm(t,d,n,h)}),o=function(d){r.setFixedDirection(d),a.forEach(function(h,p){h.setFixedDirection(d),qm(t,h.moveable,n,i[p])})};n.setFixedDirection=o;var c=ee(ee({},r),{targets:t.props.targets,events:a,setFixedDirection:o}),u=je(t,"onScaleGroupStart",c);return n.isScale=u!==!1,n.isScale?c:!1},dragGroupControl:function(t,e){var n=e.datas;if(n.isScale){Z0(t,"onBeforeScale",function(h){je(t,"onBeforeScaleGroup",ct(t,e,ee(ee({},h),{targets:t.props.targets}),!0))});var r=this.dragControl(t,e);if(r){var i=r.dist,a=n.moveableScale;t.scale=[i[0]*a[0],i[1]*a[1]];var o=t.props.keepRatio,c=n.fixedPosition,u=Ss(t,this,"dragControl",e,function(h,p){var m=ne(fr(Uh(t.rotation/180*Math.PI,3),[p.datas.originalX*i[0],p.datas.originalY*i[1],1],3),2),b=m[0],w=m[1];return ee(ee({},p),{parentDist:null,parentScale:i,parentKeepRatio:o,dragClient:At(c,[b,w])})}),d=ee({targets:t.props.targets,events:u},r);return je(t,"onScaleGroup",d),d}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isScale){this.dragControlEnd(t,e);var i=Ss(t,this,"dragControlEnd",e),a=ri(t,e,{targets:t.props.targets,events:i});return je(t,"onScaleGroupEnd",a),n}},request:function(){var t={},e=0,n=0,r=!1;return{isControl:!0,requestStart:function(i){return r=i.useSnap,{datas:t,parentDirection:i.direction||[1,1],useSnap:r}},request:function(i){return e+=i.deltaWidth,n+=i.deltaHeight,{datas:t,parentDist:[e,n],parentKeepRatio:i.keepRatio,useSnap:r}},requestEnd:function(){return{datas:t,isDrag:!0,useSnap:r}}}}};function mo(t,e){return t.map(function(n,r){return Um(n,e[r],1,2)})}function OR(t,e,n){var r=wn(t,e),i=wn(t,n),a=i-r;return a>=0?a:a+2*Math.PI}function FK(t,e){var n=OR(t[0],t[1],t[2]),r=OR(e[0],e[1],e[2]),i=Math.PI;return!(n>=i&&r<=i||n<=i&&r>=i)}var $K={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:K_("warpable"),render:function(t,e){var n=t.props,r=n.resizable,i=n.scalable,a=n.warpable,o=n.zoom;if(r||i||!a)return[];var c=t.state,u=c.pos1,d=c.pos2,h=c.pos3,p=c.pos4,m=mo(u,d),b=mo(d,u),w=mo(u,h),S=mo(h,u),E=mo(h,p),T=mo(p,h),C=mo(d,p),N=mo(p,d);return Ce([e.createElement("div",{className:Fe("line"),key:"middeLine1",style:xf(m,E,o)}),e.createElement("div",{className:Fe("line"),key:"middeLine2",style:xf(b,T,o)}),e.createElement("div",{className:Fe("line"),key:"middeLine3",style:xf(w,C,o)}),e.createElement("div",{className:Fe("line"),key:"middeLine4",style:xf(S,N,o)})],ne(VO(t,"warpable",e)),!1)},dragControlCondition:function(t,e){if(e.isRequest)return!1;var n=e.inputEvent.target;return Un(n,Fe("direction"))&&Un(n,Fe("warpable"))},dragControlStart:function(t,e){var n=e.datas,r=e.inputEvent,i=t.props.target,a=r.target,o=cP(a,n);if(!o||!i)return!1;var c=t.state,u=c.transformOrigin,d=c.is3d,h=c.targetTransform,p=c.targetMatrix,m=c.width,b=c.height,w=c.left,S=c.top;n.datas={},n.targetTransform=h,n.warpTargetMatrix=d?p:ta(p,3,4),n.targetInverseMatrix=dO(Ua(n.warpTargetMatrix,4),3,4),n.direction=o,n.left=w,n.top=S,n.poses=[[0,0],[m,0],[0,b],[m,b]].map(function(C){return He(C,u)}),n.nextPoses=n.poses.map(function(C){var N=ne(C,2),j=N[0],O=N[1];return fr(n.warpTargetMatrix,[j,O,0,1],4)}),n.startValue=Qt(4),n.prevMatrix=Qt(4),n.absolutePoses=Di(c),n.posIndexes=RO(o),lc(t,e),Y0(t,e,"matrix3d"),c.snapRenderInfo={request:e.isRequest,direction:o};var E=ct(t,e,ee({set:function(C){n.startValue=C}},q0(t,e))),T=je(t,"onWarpStart",E);return T!==!1&&(n.isWarp=!0),n.isWarp},dragControl:function(t,e){var n=e.datas,r=e.isRequest,i=e.distX,a=e.distY,o=n.targetInverseMatrix,c=n.prevMatrix,u=n.isWarp,d=n.startValue,h=n.poses,p=n.posIndexes,m=n.absolutePoses;if(!u)return!1;if(G0(t,e,"matrix3d"),id(t,"warpable")){var b=p.map(function(D){return m[D]});b.length>1&&b.push([(b[0][0]+b[1][0])/2,(b[0][1]+b[1][1])/2]);var w=K0(t,r,{horizontal:b.map(function(D){return D[1]+a}),vertical:b.map(function(D){return D[0]+i})}),S=w.horizontal,E=w.vertical;a-=S.offset,i-=E.offset}var T=Ha({datas:n,distX:i,distY:a},!0),C=n.nextPoses.slice();if(p.forEach(function(D){C[D]=At(C[D],T)}),!lW.every(function(D){return FK(D.map(function(V){return h[V]}),D.map(function(V){return C[V]}))}))return!1;var N=O_(h[0],h[2],h[1],h[3],C[0],C[2],C[1],C[3]);if(!N.length)return!1;var j=Gt(o,N,4),O=CO(n,j,!0),M=Gt(Ua(c,4),O,4);n.prevMatrix=O;var A=Gt(d,O,4),k=H0(n,"matrix3d(".concat(A.join(", "),")"),"matrix3d(".concat(O.join(", "),")"));return L_(e,k),je(t,"onWarp",ct(t,e,ee({delta:M,matrix:A,dist:O,multiply:Gt,transform:k},wr({transform:k},e)))),!0},dragControlEnd:function(t,e){var n=e.datas,r=e.isDrag;return n.isWarp?(n.isWarp=!1,je(t,"onWarpEnd",ri(t,e,{})),r):!1}},GK=Fe("area-pieces"),Lg=Fe("area-piece"),vP=Fe("avoid"),HK=Fe("view-dragging");function Kb(t){var e=t.areaElement;if(e){var n=t.state,r=n.width,i=n.height;G4(e,vP),e.style.cssText+="left: 0px; top: 0px; width: ".concat(r,"px; height: ").concat(i,"px")}}function PR(t){return t.createElement("div",{key:"area_pieces",className:GK},t.createElement("div",{className:Lg}),t.createElement("div",{className:Lg}),t.createElement("div",{className:Lg}),t.createElement("div",{className:Lg}))}var yP={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(t,e){var n=t.props,r=n.target,i=n.dragArea,a=n.groupable,o=n.passDragArea,c=t.getState(),u=c.width,d=c.height,h=c.renderPoses,p=o?Fe("area","pass"):Fe("area");if(a)return[e.createElement("div",{key:"area",ref:ws(t,"areaElement"),className:p}),PR(e)];if(!r||!i)return[];var m=O_([0,0],[u,0],[0,d],[u,d],h[0],h[1],h[2],h[3]),b=m.length?Q0(m,!0):"none";return[e.createElement("div",{key:"area",ref:ws(t,"areaElement"),className:p,style:{top:"0px",left:"0px",width:"".concat(u,"px"),height:"".concat(d,"px"),transformOrigin:"0 0",transform:b}}),PR(e)]},dragStart:function(t,e){var n=e.datas,r=e.clientX,i=e.clientY,a=e.inputEvent;if(!a)return!1;n.isDragArea=!1;var o=t.areaElement,c=t.state,u=c.moveableClientRect,d=c.renderPoses,h=c.rootMatrix,p=c.is3d,m=u.left,b=u.top,w=ki(d),S=w.left,E=w.top,T=w.width,C=w.height,N=p?4:3,j=ne(Vu(h,[r-m,i-b],N),2),O=j[0],M=j[1];O-=S,M-=E;var A=[{left:S,top:E,width:T,height:M-10},{left:S,top:E,width:O-10,height:C},{left:S,top:E+M+10,width:T,height:C-M-10},{left:S+O+10,top:E,width:T-O-10,height:C}],k=[].slice.call(o.nextElementSibling.children);A.forEach(function(D,V){k[V].style.cssText="left: ".concat(D.left,"px;top: ").concat(D.top,"px; width: ").concat(D.width,"px; height: ").concat(D.height,"px;")}),$4(o,vP),c.disableNativeEvent=!0},drag:function(t,e){var n=e.datas,r=e.inputEvent;if(this.enableNativeEvent(t),!r)return!1;n.isDragArea||(n.isDragArea=!0,Kb(t))},dragEnd:function(t,e){this.enableNativeEvent(t);var n=e.inputEvent,r=e.datas;if(!n)return!1;r.isDragArea||Kb(t)},dragGroupStart:function(t,e){return this.dragStart(t,e)},dragGroup:function(t,e){return this.drag(t,e)},dragGroupEnd:function(t,e){return this.dragEnd(t,e)},unset:function(t){Kb(t),t.state.disableNativeEvent=!1},enableNativeEvent:function(t){var e=t.state;e.disableNativeEvent&&L4(function(){e.disableNativeEvent=!1})}},qK=$h("origin",{props:["origin","svgOrigin"],render:function(t,e){var n=t.props,r=n.zoom,i=n.svgOrigin,a=n.groupable,o=t.getState(),c=o.beforeOrigin,u=o.rotation,d=o.svg,h=o.allMatrix,p=o.is3d,m=o.left,b=o.top,w=o.offsetWidth,S=o.offsetHeight,E;if(!a&&d&&i){var T=ne(J_(i,w,S),2),C=T[0],N=T[1],j=p?4:3,O=an(h,[C,N],j);E=Km(u,r,He(O,[m,b]))}else E=Km(u,r,c);return[e.createElement("div",{className:Fe("control","origin"),style:E,key:"beforeOrigin"})]}});function YK(t){var e=t.scrollContainer;return[e.scrollLeft,e.scrollTop]}var XK={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(t,e){var n=t.props,r=n.scrollContainer,i=r===void 0?t.getContainer():r,a=n.scrollOptions,o=new CX,c=za(i,!0);e.datas.dragScroll=o,t.state.dragScroll=o;var u=e.isControl?"controlGesto":"targetGesto",d=e.targets;o.on("scroll",function(h){var p=h.container,m=h.direction,b=ct(t,e,{scrollContainer:p,direction:m}),w=d?"onScrollGroup":"onScroll";d&&(b.targets=d),je(t,w,b)}).on("move",function(h){var p=h.offsetX,m=h.offsetY,b=h.inputEvent;t[u].scrollBy(p,m,b.inputEvent,!1)}).on("scrollDrag",function(h){var p=h.next;p(t[u].getCurrentEvent())}),o.dragStart(e,ee({container:c},a))},checkScroll:function(t,e){var n=e.datas.dragScroll;if(n){var r=t.props,i=r.scrollContainer,a=i===void 0?t.getContainer():i,o=r.scrollThreshold,c=o===void 0?0:o,u=r.scrollThrottleTime,d=u===void 0?0:u,h=r.getScrollPosition,p=h===void 0?YK:h,m=r.scrollOptions;return n.drag(e,ee({container:a,threshold:c,throttleTime:d,getScrollPosition:function(b){return p({scrollContainer:b.container,direction:b.direction})}},m)),!0}},drag:function(t,e){return this.checkScroll(t,e)},dragEnd:function(t,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(t,e){return this.dragStart(t,ee(ee({},e),{isControl:!0}))},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupStart:function(t,e){return this.dragStart(t,ee(ee({},e),{targets:t.props.targets}))},dragGroup:function(t,e){return this.drag(t,ee(ee({},e),{targets:t.props.targets}))},dragGroupEnd:function(t,e){return this.dragEnd(t,ee(ee({},e),{targets:t.props.targets}))},dragGroupControlStart:function(t,e){return this.dragStart(t,ee(ee({},e),{targets:t.props.targets,isControl:!0}))},dragGroupControl:function(t,e){return this.drag(t,ee(ee({},e),{targets:t.props.targets}))},dragGroupControEnd:function(t,e){return this.dragEnd(t,ee(ee({},e),{targets:t.props.targets}))},unset:function(t){var e,n=t.state;(e=n.dragScroll)===null||e===void 0||e.dragEnd(),n.dragScroll=null}},bP={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","preventRightClick","preventWheelClick","requestStyles"],events:["changeTargets"]},WK=$h("padding",{props:["padding"],render:function(t,e){var n=t.props;if(n.dragArea)return[];var r=mP(n.padding||{}),i=r.left,a=r.top,o=r.right,c=r.bottom,u=t.getState(),d=u.renderPoses,h=u.pos1,p=u.pos2,m=u.pos3,b=u.pos4,w=[h,p,m,b],S=[];return i>0&&S.push([0,2]),a>0&&S.push([0,1]),o>0&&S.push([1,3]),c>0&&S.push([2,3]),S.map(function(E,T){var C=ne(E,2),N=C[0],j=C[1],O=w[N],M=w[j],A=d[N],k=d[j],D=O_([0,0],[100,0],[0,100],[100,100],O,M,A,k);if(D.length)return e.createElement("div",{key:"padding".concat(T),className:Fe("padding"),style:{transform:Q0(D,!0)}})})}}),jR=["nw","ne","se","sw"];function Bg(t,e){var n=t[0]+t[1],r=n>e?e/n:1;return t[0]*=r,t[1]=e-t[1]*r,t}var KK=[1,2,5,6],QK=[0,3,4,7],Vl=[1,-1,-1,1],zl=[1,1,-1,-1];function eS(t,e,n,r,i,a,o,c){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=n),c===void 0&&(c=r);var u=[],d=!1,h=t.filter(function(m){return!m.virtual}),p=h.map(function(m){var b=m.horizontal,w=m.vertical,S=m.pos;if(w&&!d&&(d=!0,u.push("/")),d){var E=Math.max(0,w===1?S[1]-a:c-S[1]);return u.push(Hi(E,r,e)),E}else{var E=Math.max(0,b===1?S[0]-i:o-S[0]);return u.push(Hi(E,n,e)),E}});return{radiusPoses:h,styles:u,raws:p}}function xP(t){for(var e=[0,0],n=[0,0],r=t.length,i=0;i<r;++i){var a=t[i];a.sub&&(a.horizontal&&(e[1]===0&&(e[0]=i),e[1]=i-e[0]+1,n[0]=i+1),a.vertical&&(n[1]===0&&(n[0]=i),n[1]=i-n[0]+1))}return{horizontalRange:e,verticalRange:n}}function wP(t,e,n,r,i,a,o){var c,u,d,h;a===void 0&&(a=[0,0]),o===void 0&&(o=!1);var p=t.indexOf("/"),m=(p>-1?t.slice(0,p):t).length,b=t.slice(0,m),w=t.slice(m+1),S=b.length,E=w.length,T=E>0,C=ne(b,4),N=C[0],j=N===void 0?"0px":N,O=C[1],M=O===void 0?j:O,A=C[2],k=A===void 0?j:A,D=C[3],V=D===void 0?M:D,L=ne(w,4),U=L[0],P=U===void 0?j:U,K=L[1],X=K===void 0?T?P:M:K,q=L[2],Q=q===void 0?T?P:k:q,te=L[3],se=te===void 0?T?X:V:te,G=[j,M,k,V].map(function(ie){return $t(ie,e)}),F=[P,X,Q,se].map(function(ie){return $t(ie,n)}),Y=G.slice(),Z=F.slice();c=ne(Bg([Y[0],Y[1]],e),2),Y[0]=c[0],Y[1]=c[1],u=ne(Bg([Y[3],Y[2]],e),2),Y[3]=u[0],Y[2]=u[1],d=ne(Bg([Z[0],Z[3]],n),2),Z[0]=d[0],Z[3]=d[1],h=ne(Bg([Z[1],Z[2]],n),2),Z[1]=h[0],Z[2]=h[1];var W=o?Y:Y.slice(0,Math.max(a[0],S)),le=o?Z:Z.slice(0,Math.max(a[1],E));return Ce(Ce([],ne(W.map(function(ie,pe){var ce=jR[pe];return{virtual:pe>=S,horizontal:Vl[pe],vertical:0,pos:[r+ie,i+(zl[pe]===-1?n:0)],sub:!0,raw:G[pe],direction:ce}})),!1),ne(le.map(function(ie,pe){var ce=jR[pe];return{virtual:pe>=E,horizontal:0,vertical:zl[pe],pos:[r+(Vl[pe]===-1?e:0),i+ie],sub:!0,raw:F[pe],direction:ce}})),!1)}function ZK(t,e,n,r,i){i===void 0&&(i=e.length);var a=xP(t.slice(r)),o=a.horizontalRange,c=a.verticalRange,u=n-r,d=0;if(u===0)d=i;else if(u>0&&u<o[1])d=o[1]-u;else if(u>=c[0])d=c[0]+c[1]-u;else return;t.splice(n,d),e.splice(n,d)}function JK(t,e,n,r,i,a,o,c,u,d,h){d===void 0&&(d=0),h===void 0&&(h=0);var p=xP(t.slice(n)),m=p.horizontalRange,b=p.verticalRange;if(r>-1)for(var w=Vl[r]===1?a-d:c-a,S=m[1];S<=r;++S){var E=zl[S]===1?h:u,T=0;if(r===S?T=a:S===0?T=d+w:Vl[S]===-1&&(T=c-(e[n][0]-d)),t.splice(n+S,0,{horizontal:Vl[S],vertical:0,pos:[T,E]}),e.splice(n+S,0,[T,E]),S===0)break}else if(i>-1){var C=zl[i]===1?o-h:u-o;if(m[1]===0&&b[1]===0){var N=[d+C,h];t.push({horizontal:Vl[0],vertical:0,pos:N}),e.push(N)}for(var j=b[0],S=b[1];S<=i;++S){var T=Vl[S]===1?d:c,E=0;if(i===S?E=o:S===0?E=h+C:zl[S]===1?E=e[n+j][1]:zl[S]===-1&&(E=u-(e[n+j][1]-h)),t.push({horizontal:0,vertical:zl[S],pos:[T,E]}),e.push([T,E]),S===0)break}}}function eQ(t,e){e===void 0&&(e=t.map(function(i){return i.raw}));var n=t.map(function(i,a){return i.horizontal?e[a]:null}).filter(function(i){return i!=null}),r=t.map(function(i,a){return i.vertical?e[a]:null}).filter(function(i){return i!=null});return{horizontals:n,verticals:r}}var tQ=[[0,-1,"n"],[1,0,"e"]],nQ=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function tS(t,e,n){var r=t.props.clipRelative,i=t.state,a=i.width,o=i.height,c=e,u=c.type,d=c.poses,h=u==="rect",p=u==="circle";if(u==="polygon")return n.map(function(M){return"".concat(Hi(M[0],a,r)," ").concat(Hi(M[1],o,r))});if(h||u==="inset"){var m=n[1][1],b=n[3][0],w=n[7][0],S=n[5][1];if(h)return[m,b,S,w].map(function(M){return"".concat(M,"px")});var E=[m,a-b,o-S,w].map(function(M,A){return Hi(M,A%2?a:o,r)});if(n.length>8){var T=ne(He(n[4],n[0]),2),C=T[0],N=T[1];E.push.apply(E,Ce(["round"],ne(eS(d.slice(8).map(function(M,A){return ee(ee({},M),{pos:n[A]})}),r,C,N,w,m,b,S).styles),!1))}return E}else if(p||u==="ellipse"){var j=n[0],O=Hi(Te(n[1][1]-j[1]),p?Math.sqrt((a*a+o*o)/2):o,r),E=p?[O]:[Hi(Te(n[2][0]-j[0]),a,r),O];return E.push("at",Hi(j[0],a,r),Hi(j[1],o,r)),E}}function Zm(t,e,n,r){var i=[r,(r+e)/2,e],a=[t,(t+n)/2,n];return nQ.map(function(o){var c=ne(o,3),u=c[0],d=c[1],h=c[2],p=i[u+1],m=a[d+1];return{vertical:Te(d),horizontal:Te(u),direction:h,pos:[p,m]}})}function _P(t){var e=[1/0,-1/0],n=[1/0,-1/0];return t.forEach(function(r){var i=r.pos;e[0]=Math.min(e[0],i[0]),e[1]=Math.max(e[1],i[0]),n[0]=Math.min(n[0],i[1]),n[1]=Math.max(n[1],i[1])}),[Te(e[1]-e[0]),Te(n[1]-n[0])]}function VR(t,e,n,r,i){var a,o,c,u,d,h,p,m,b;if(t){var w=i;if(!w){var S=Lr(t),E=S("clipPath");w=E!=="none"?E:S("clip")}if(!((!w||w==="none"||w==="auto")&&(w=r,!w))){var T=z4(w),C=T.prefix,N=C===void 0?w:C,j=T.value,O=j===void 0?"":j,M=N==="circle",A=" ";if(N==="polygon"){var k=Fl(O||"0% 0%, 100% 0%, 100% 100%, 0% 100%");A=",";var D=k.map(function(st){var _t=ne(st.split(" "),2),Ze=_t[0],ut=_t[1];return{vertical:1,horizontal:1,pos:[$t(Ze,e),$t(ut,n)]}}),V=tc(D.map(function(st){return st.pos}));return{type:N,clipText:w,poses:D,splitter:A,left:V.minX,right:V.maxX,top:V.minY,bottom:V.maxY}}else if(M||N==="ellipse"){var L="",U="",P=0,K=0,k=Yo(O);if(M){var X="";a=ne(k,4),o=a[0],X=o===void 0?"50%":o,c=a[2],L=c===void 0?"50%":c,u=a[3],U=u===void 0?"50%":u,P=$t(X,Math.sqrt((e*e+n*n)/2)),K=P}else{var q="",Q="";d=ne(k,5),h=d[0],q=h===void 0?"50%":h,p=d[1],Q=p===void 0?"50%":p,m=d[3],L=m===void 0?"50%":m,b=d[4],U=b===void 0?"50%":b,P=$t(q,e),K=$t(Q,n)}var te=[$t(L,e),$t(U,n)],D=Ce([{vertical:1,horizontal:1,pos:te,direction:"nesw"}],ne(tQ.slice(0,M?1:2).map(function(Ze){return{vertical:Te(Ze[1]),horizontal:Ze[0],direction:Ze[2],sub:!0,pos:[te[0]+Ze[0]*P,te[1]+Ze[1]*K]}})),!1);return{type:N,clipText:w,radiusX:P,radiusY:K,left:te[0]-P,top:te[1]-K,right:te[0]+P,bottom:te[1]+K,poses:D,splitter:A}}else if(N==="inset"){var k=Yo(O||"0 0 0 0"),se=k.indexOf("round"),G=(se>-1?k.slice(0,se):k).length,F=k.slice(G+1),Y=ne(k.slice(0,G),4),Z=Y[0],W=Y[1],le=W===void 0?Z:W,ie=Y[2],pe=ie===void 0?Z:ie,ce=Y[3],xe=ce===void 0?le:ce,Re=ne([Z,pe].map(function(Ze){return $t(Ze,n)}),2),ae=Re[0],Ee=Re[1],Ne=ne([xe,le].map(function(Ze){return $t(Ze,e)}),2),Ie=Ne[0],Oe=Ne[1],Ve=e-Oe,Se=n-Ee,Le=wP(F,Ve-Ie,Se-ae,Ie,ae),D=Ce(Ce([],ne(Zm(ae,Ve,Se,Ie)),!1),ne(Le),!1);return{type:"inset",clipText:w,poses:D,top:ae,left:Ie,right:Ve,bottom:Se,radius:F,splitter:A}}else if(N==="rect"){var k=Fl(O||"0px, ".concat(e,"px, ").concat(n,"px, 0px"));A=",";var Me=ne(k.map(function(cn){var It=jh(cn).value;return It}),4),Be=Me[0],Oe=Me[1],Ee=Me[2],Ie=Me[3],D=Zm(Be,Oe,Ee,Ie);return{type:"rect",clipText:w,poses:D,top:Be,right:Oe,bottom:Ee,left:Ie,values:k,splitter:A}}}}}function rQ(t,e,n,r,i){var a=t[e],o=a.direction,c=a.sub,u=t.map(function(){return[0,0]}),d=o?o.split(""):[];if(r&&e<8){var h=d.filter(function(P){return P==="w"||P==="e"}),p=d.filter(function(P){return P==="n"||P==="s"}),m=h[0],b=p[0];u[e]=n;var w=ne(_P(t),2),S=w[0],E=w[1],T=S&&E?S/E:0;if(T&&i){var C=(e+4)%8,N=t[C].pos,j=[0,0];o.indexOf("w")>-1?j[0]=-1:o.indexOf("e")>-1&&(j[0]=1),o.indexOf("n")>-1?j[1]=-1:o.indexOf("s")>-1&&(j[1]=1);var O=hP([S,E],n,T,j,!0),M=S+O[0],A=E+O[1],k=N[1],D=N[1],V=N[0],L=N[0];j[0]===-1?V=L-M:j[0]===1?L=V+M:(V=V-M/2,L=L+M/2),j[1]===-1?k=D-A:(j[1]===1||(k=D-A/2),D=k+A);var U=Zm(k,L,D,V);t.forEach(function(P,K){u[K][0]=U[K].pos[0]-P.pos[0],u[K][1]=U[K].pos[1]-P.pos[1]})}else t.forEach(function(P,K){var X=P.direction;X&&(X.indexOf(m)>-1&&(u[K][0]=n[0]),X.indexOf(b)>-1&&(u[K][1]=n[1]))}),m&&(u[1][0]=n[0]/2,u[5][0]=n[0]/2),b&&(u[3][1]=n[1]/2,u[7][1]=n[1]/2)}else o&&!c?d.forEach(function(P){var K=P==="n"||P==="s";t.forEach(function(X,q){var Q=X.direction,te=X.horizontal,se=X.vertical;!Q||Q.indexOf(P)===-1||(u[q]=[K||!te?0:n[0],!K||!se?0:n[1]])})}):u[e]=n;return u}function iQ(t,e){var n=ne(AO(t,e),2),r=n[0],i=n[1],a=e.datas,o=a.clipPath,c=a.clipIndex,u=o,d=u.type,h=u.poses,p=u.splitter,m=h.map(function(C){return C.pos});if(d==="polygon")m.splice(c,0,[r,i]);else if(d==="inset"){var b=KK.indexOf(c),w=QK.indexOf(c),S=h.length;if(JK(h,m,8,b,w,r,i,m[4][0],m[4][1],m[0][0],m[0][1]),S===h.length)return}else return;var E=tS(t,o,m),T="".concat(d,"(").concat(E.join(p),")");je(t,"onClip",ct(t,e,ee({clipEventType:"added",clipType:d,poses:m,clipStyles:E,clipStyle:T,distX:0,distY:0},wr({clipPath:T},e))))}function aQ(t,e){var n=e.datas,r=n.clipPath,i=n.clipIndex,a=r,o=a.type,c=a.poses,u=a.splitter,d=c.map(function(b){return b.pos}),h=d.length;if(o==="polygon")c.splice(i,1),d.splice(i,1);else if(o==="inset"){if(i<8||(ZK(c,d,i,8,h),h===c.length))return}else return;var p=tS(t,r,d),m="".concat(o,"(").concat(p.join(u),")");je(t,"onClip",ct(t,e,ee({clipEventType:"removed",clipType:o,poses:d,clipStyles:p,clipStyle:m,distX:0,distY:0},wr({clipPath:m},e))))}var sQ={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(t,e){var n=t.props,r=n.customClipPath,i=n.defaultClipPath,a=n.clipArea,o=n.zoom,c=n.groupable,u=t.getState(),d=u.target,h=u.width,p=u.height,m=u.allMatrix,b=u.is3d,w=u.left,S=u.top,E=u.pos1,T=u.pos2,C=u.pos3,N=u.pos4,j=u.clipPathState,O=u.snapBoundInfos,M=u.rotation;if(!d||c)return[];var A=VR(d,h,p,i||"inset",j||r);if(!A)return[];var k=b?4:3,D=A.type,V=A.poses,L=V.map(function(Oe){var Ve=an(m,Oe.pos,k);return[Ve[0]-w,Ve[1]-S]}),U=[],P=[],K=D==="rect",X=D==="inset",q=D==="polygon";if(K||X||q){var Q=X?L.slice(0,8):L;P=Q.map(function(Oe,Ve){var Se=Ve===0?Q[Q.length-1]:Q[Ve-1],Le=wn(Se,Oe),Me=iP(Se,Oe);return e.createElement("div",{key:"clipLine".concat(Ve),className:Fe("line","clip-line","snap-control"),"data-clip-index":Ve,style:{width:"".concat(Me,"px"),transform:"translate(".concat(Se[0],"px, ").concat(Se[1],"px) rotate(").concat(Le,"rad) scaleY(").concat(o,")")}})})}if(U=L.map(function(Oe,Ve){return e.createElement("div",{key:"clipControl".concat(Ve),className:Fe("control","clip-control","snap-control"),"data-clip-index":Ve,style:{transform:"translate(".concat(Oe[0],"px, ").concat(Oe[1],"px) rotate(").concat(M,"rad) scale(").concat(o,")")}})}),X&&U.push.apply(U,Ce([],ne(L.slice(8).map(function(Oe,Ve){return e.createElement("div",{key:"clipRadiusControl".concat(Ve),className:Fe("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+Ve,style:{transform:"translate(".concat(Oe[0],"px, ").concat(Oe[1],"px) rotate(").concat(M,"rad) scale(").concat(o,")")}})})),!1)),D==="circle"||D==="ellipse"){var te=A.left,se=A.top,G=A.radiusX,F=A.radiusY,Y=ne(He(an(m,[te,se],k),an(m,[0,0],k)),2),Z=Y[0],W=Y[1],le="none";if(!a){for(var ie=Math.max(10,G/5,F/5),pe=[],ce=0;ce<=ie;++ce){var xe=Math.PI*2/ie*ce;pe.push([G+(G-o)*Math.cos(xe),F+(F-o)*Math.sin(xe)])}pe.push([G,-2]),pe.push([-2,-2]),pe.push([-2,F*2+2]),pe.push([G*2+2,F*2+2]),pe.push([G*2+2,-2]),pe.push([G,-2]),le="polygon(".concat(pe.map(function(Oe){return"".concat(Oe[0],"px ").concat(Oe[1],"px")}).join(", "),")")}U.push(e.createElement("div",{key:"clipEllipse",className:Fe("clip-ellipse","snap-control"),style:{width:"".concat(G*2,"px"),height:"".concat(F*2,"px"),clipPath:le,transform:"translate(".concat(-w+Z,"px, ").concat(-S+W,"px) ").concat(Q0(m))}}))}if(a){var Re=ki(Ce([E,T,C,N],ne(L),!1)),ae=Re.width,Ee=Re.height,Ne=Re.left,Ie=Re.top;if(q||K||X){var pe=X?L.slice(0,8):L;U.push(e.createElement("div",{key:"clipArea",className:Fe("clip-area","snap-control"),style:{width:"".concat(ae,"px"),height:"".concat(Ee,"px"),transform:"translate(".concat(Ne,"px, ").concat(Ie,"px)"),clipPath:"polygon(".concat(pe.map(function(Ve){return"".concat(Ve[0]-Ne,"px ").concat(Ve[1]-Ie,"px")}).join(", "),")")}}))}}return O&&["vertical","horizontal"].forEach(function(Oe){var Ve=O[Oe],Se=Oe==="horizontal";Ve.isSnap&&P.push.apply(P,Ce([],ne(Ve.snap.posInfos.map(function(Le,Me){var Be=Le.pos,st=He(an(m,Se?[0,Be]:[Be,0],k),[w,S]),_t=He(an(m,Se?[h,Be]:[Be,p],k),[w,S]);return oh(e,"",st,_t,o,"clip".concat(Oe,"snap").concat(Me),"guideline")})),!1)),Ve.isBound&&P.push.apply(P,Ce([],ne(Ve.bounds.map(function(Le,Me){var Be=Le.pos,st=He(an(m,Se?[0,Be]:[Be,0],k),[w,S]),_t=He(an(m,Se?[h,Be]:[Be,p],k),[w,S]);return oh(e,"",st,_t,o,"clip".concat(Oe,"bounds").concat(Me),"guideline","bounds","bold")})),!1))}),Ce(Ce([],ne(U),!1),ne(P),!1)},dragControlCondition:function(t,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(t,e){var n=t.props,r=n.dragWithClip,i=r===void 0?!0:r;return i?!1:this.dragControlStart(t,e)},drag:function(t,e){return this.dragControl(t,ee(ee({},e),{isDragTarget:!0}))},dragEnd:function(t,e){return this.dragControlEnd(t,e)},dragControlStart:function(t,e){var n=t.state,r=t.props,i=r.defaultClipPath,a=r.customClipPath,o=n.target,c=n.width,u=n.height,d=e.inputEvent?e.inputEvent.target:null,h=d&&d.getAttribute("class")||"",p=e.datas,m=VR(o,c,u,i||"inset",a);if(!m)return!1;var b=m.clipText,w=m.type,S=m.poses,E=je(t,"onClipStart",ct(t,e,{clipType:w,clipStyle:b,poses:S.map(function(T){return T.pos})}));return E===!1?(p.isClipStart=!1,!1):(p.isControl=h&&h.indexOf("clip-control")>-1,p.isLine=h.indexOf("clip-line")>-1,p.isArea=h.indexOf("clip-area")>-1||h.indexOf("clip-ellipse")>-1,p.clipIndex=d?parseInt(d.getAttribute("data-clip-index"),10):-1,p.clipPath=m,p.isClipStart=!0,n.clipPathState=b,lc(t,e),!0)},dragControl:function(t,e){var n,r,i,a=e.datas,o=e.originalDatas,c=e.isDragTarget;if(!a.isClipStart)return!1;var u=a,d=u.isControl,h=u.isLine,p=u.isArea,m=u.clipIndex,b=u.clipPath;if(!b)return!1;var w=nc(t.props,"clippable"),S=w.keepRatio,E=0,T=0,C=o.draggable,N=Ha(e);c&&C?(n=ne(C.prevBeforeDist,2),E=n[0],T=n[1]):(r=ne(N,2),E=r[0],T=r[1]);var j=[E,T],O=t.state,M=O.width,A=O.height,k=!p&&!d&&!h,D=b.type,V=b.poses,L=b.splitter,U=V.map(function(ft){return ft.pos});k&&(E=-E,T=-T);var P=!d||V[m].direction==="nesw",K=D==="inset"||D==="rect",X=V.map(function(){return[0,0]});if(d&&!P){var q=V[m],Q=q.horizontal,te=q.vertical,se=[E*Te(Q),T*Te(te)];X=rQ(V,m,se,K,S)}else P&&(X=U.map(function(){return[E,T]}));var G=U.map(function(ft,nn){return At(ft,X[nn])}),F=Ce([],ne(G),!1);O.snapBoundInfos=null;var Y=b.type==="circle",Z=b.type==="ellipse";if(Y||Z){var W=ki(G),le=Te(W.bottom-W.top),ie=Te(Z?W.right-W.left:le),pe=G[0][1]+le,ce=G[0][0]-ie,xe=G[0][0]+ie;Y&&(F.push([xe,W.bottom]),X.push([1,0])),F.push([W.left,pe]),X.push([0,1]),F.push([ce,W.bottom]),X.push([1,0])}var Re=ZO((w.clipHorizontalGuidelines||[]).map(function(ft){return $t("".concat(ft),A)}),(w.clipVerticalGuidelines||[]).map(function(ft){return $t("".concat(ft),M)}),M,A),ae=[],Ee=[];if(Y||Z)ae=[F[4][0],F[2][0]],Ee=[F[1][1],F[3][1]];else if(K){var Ne=[F[0],F[2],F[4],F[6]],Ie=[X[0],X[2],X[4],X[6]];ae=Ne.filter(function(ft,nn){return Ie[nn][0]}).map(function(ft){return ft[0]}),Ee=Ne.filter(function(ft,nn){return Ie[nn][1]}).map(function(ft){return ft[1]})}else ae=F.filter(function(ft,nn){return X[nn][0]}).map(function(ft){return ft[0]}),Ee=F.filter(function(ft,nn){return X[nn][1]}).map(function(ft){return ft[1]});var Oe=[0,0],Ve=wR(Re,w.clipTargetBounds&&{left:0,top:0,right:M,bottom:A},ae,Ee,5,5),Se=Ve.horizontal,Le=Ve.vertical,Me=Se.offset,Be=Le.offset;if(Se.isBound&&(Oe[1]+=Me),Le.isBound&&(Oe[0]+=Be),(Z||Y)&&X[0][0]===0&&X[0][1]===0){var W=ki(G),st=W.bottom-W.top,_t=Z?W.right-W.left:st,Ze=Le.isBound?Te(Be):Le.snapIndex===0?-Be:Be,ut=Se.isBound?Te(Me):Se.snapIndex===0?-Me:Me;_t-=Ze,st-=ut,Y&&(st=GO(Le,Se)>0?st:_t,_t=st);var Rt=F[0];F[1][1]=Rt[1]-st,F[2][0]=Rt[0]+_t,F[3][1]=Rt[1]+st,F[4][0]=Rt[0]-_t}else if(K&&S&&d){var cn=ne(_P(V),2),It=cn[0],_n=cn[1],Ur=It&&_n?It/_n:0,aa=V[m],qa=aa.direction||"",Os=F[1][1],pe=F[5][1],ce=F[7][0],xe=F[3][0];Te(Me)<=Te(Be)?Me=br(Me)*Te(Be)/Ur:Be=br(Be)*Te(Me)*Ur,qa.indexOf("w")>-1?ce-=Be:qa.indexOf("e")>-1?xe-=Be:(ce+=Be/2,xe-=Be/2),qa.indexOf("n")>-1?Os-=Me:qa.indexOf("s")>-1?pe-=Me:(Os+=Me/2,pe-=Me/2);var Fr=Zm(Os,xe,pe,ce);F.forEach(function($r,ai){var pr;pr=ne(Fr[ai].pos,2),$r[0]=pr[0],$r[1]=pr[1]})}else F.forEach(function(ft,nn){var rn=X[nn];rn[0]&&(ft[0]-=Be),rn[1]&&(ft[1]-=Me)});var Sn=tS(t,b,G),ar="".concat(D,"(").concat(Sn.join(L),")");if(O.clipPathState=ar,Y||Z)ae=[F[4][0],F[2][0]],Ee=[F[1][1],F[3][1]];else if(K){var Ne=[F[0],F[2],F[4],F[6]];ae=Ne.map(function(nn){return nn[0]}),Ee=Ne.map(function(nn){return nn[1]})}else ae=F.map(function(ft){return ft[0]}),Ee=F.map(function(ft){return ft[1]});if(O.snapBoundInfos=wR(Re,w.clipTargetBounds&&{left:0,top:0,right:M,bottom:A},ae,Ee,1,1),C){var tn=O.is3d,uc=O.allMatrix,Ps=tn?4:3,js=Oe;c&&(js=[j[0]+Oe[0]-N[0],j[1]+Oe[1]-N[1]]),C.deltaOffset=Gt(uc,[js[0],js[1],0,0],Ps)}return je(t,"onClip",ct(t,e,ee({clipEventType:"changed",clipType:D,poses:G,clipStyle:ar,clipStyles:Sn,distX:E,distY:T},wr((i={},i[D==="rect"?"clip":"clipPath"]=ar,i),e)))),!0},dragControlEnd:function(t,e){this.unset(t);var n=e.isDrag,r=e.datas,i=e.isDouble,a=r.isLine,o=r.isClipStart,c=r.isControl;return o?(je(t,"onClipEnd",ri(t,e,{})),i&&(c?aQ(t,e):a&&iQ(t,e)),i||n):!1},unset:function(t){t.state.clipPathState="",t.state.snapBoundInfos=null}},oQ={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(t,e){return e.isRequest?e.requestAble==="originDraggable":Un(e.inputEvent.target,Fe("origin"))},dragControlStart:function(t,e){var n=e.datas;lc(t,e);var r=ct(t,e,{dragStart:yr.dragStart(t,new Ou().dragStart([0,0],e))}),i=je(t,"onDragOriginStart",r);return n.startOrigin=t.state.transformOrigin,n.startTargetOrigin=t.state.targetOrigin,n.prevOrigin=[0,0],n.isDragOrigin=!0,i===!1?(n.isDragOrigin=!1,!1):r},dragControl:function(t,e){var n=e.datas,r=e.isPinch,i=e.isRequest;if(!n.isDragOrigin)return!1;var a=ne(Ha(e),2),o=a[0],c=a[1],u=t.state,d=u.width,h=u.height,p=u.offsetMatrix,m=u.targetMatrix,b=u.is3d,w=t.props.originRelative,S=w===void 0?!0:w,E=b?4:3,T=[o,c];if(i){var C=e.distOrigin;(C[0]||C[1])&&(T=C)}var N=At(n.startOrigin,T),j=At(n.startTargetOrigin,T),O=He(T,n.prevOrigin),M=Hh(p,m,N,E),A=t.getRect(),k=ki(cc(M,d,h,E)),D=[A.left-k.left,A.top-k.top];n.prevOrigin=T;var V=[Hi(j[0],d,S),Hi(j[1],h,S)].join(" "),L=yr.drag(t,Gh(e,t.state,D,!!r)),U=ct(t,e,ee(ee({width:d,height:h,origin:N,dist:T,delta:O,transformOrigin:V,drag:L},wr({transformOrigin:V,transform:L.transform},e)),{afterTransform:L.transform}));return je(t,"onDragOrigin",U),U},dragControlEnd:function(t,e){var n=e.datas;return n.isDragOrigin?(je(t,"onDragOriginEnd",ri(t,e,{})),!0):!1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragGroupControlStart:function(t,e){var n=this.dragControlStart(t,e);return!!n},dragGroupControl:function(t,e){var n=this.dragControl(t,e);return n?(t.transformOrigin=n.transformOrigin,!0):!1},request:function(t){var e={},n=t.getRect(),r=0,i=0,a=n.transformOrigin,o=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(c){return"deltaOrigin"in c?(o[0]+=c.deltaOrigin[0],o[1]+=c.deltaOrigin[1]):"origin"in c?(o[0]=c.origin[0]-a[0],o[1]=c.origin[1]-a[1]):("x"in c?r=c.x-n.left:"deltaX"in c&&(r+=c.deltaX),"y"in c?i=c.y-n.top:"deltaY"in c&&(i+=c.deltaY)),{datas:e,distX:r,distY:i,distOrigin:o}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function lQ(t,e,n,r){var i=t.filter(function(u){var d=u.virtual,h=u.horizontal;return h&&!d}).length,a=t.filter(function(u){var d=u.virtual,h=u.vertical;return h&&!d}).length,o=-1;if(e===0&&(i===0?o=0:i===1&&(o=1)),e===2&&(i<=2?o=2:i<=3&&(o=3)),e===3&&(a===0?o=4:a<4&&(o=7)),e===1&&(a<=1?o=5:a<=2&&(o=6)),!(o===-1||!t[o].virtual)){var c=t[o];cQ(t,o),o<4?c.pos[0]=n:c.pos[1]=r}}function cQ(t,e){e<4?t.slice(0,e+1).forEach(function(n){n.virtual=!1}):(t[0].virtual&&(t[0].virtual=!1),t.slice(4,e+1).forEach(function(n){n.virtual=!1}))}function uQ(t,e){e<4?t.slice(e,4).forEach(function(n){n.virtual=!0}):t.slice(e).forEach(function(n){n.virtual=!0})}function zR(t,e,n,r,i){r===void 0&&(r=[0,0]);var a=[];return!t||t==="0px"?a=[]:a=Yo(t),wP(a,e,n,0,0,r,i)}function LR(t,e,n,r,i){var a=t.state,o=a.width,c=a.height,u=eS(i,t.props.roundRelative,o,c),d=u.raws,h=u.styles,p=u.radiusPoses,m=eQ(p,d),b=m.horizontals,w=m.verticals,S=h.join(" ");a.borderRadiusState=S;var E=ct(t,e,ee({horizontals:b,verticals:w,borderRadius:S,width:o,height:c,delta:r,dist:n},wr({borderRadius:S},e)));return je(t,"onRound",E),E}function BR(t){var e,n,r=t.getState().style,i=r.borderRadius||"";if(!i&&t.props.groupable){var a=t.moveables[0],o=t.getTargets()[0];o&&(a?.props.target===o?(i=(n=(e=t.moveables[0])===null||e===void 0?void 0:e.state.style.borderRadius)!==null&&n!==void 0?n:"",r.borderRadius=i):(i=W_(o).borderRadius,r.borderRadius=i))}return i}var dQ={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(t){var e=t.props.roundClickable;return e===!0||e==="line"?Fe("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(t,e){var n=t.getState(),r=n.target,i=n.width,a=n.height,o=n.allMatrix,c=n.is3d,u=n.left,d=n.top,h=n.borderRadiusState,p=t.props,m=p.minRoundControls,b=m===void 0?[0,0]:m,w=p.maxRoundControls,S=w===void 0?[4,4]:w,E=p.zoom,T=p.roundPadding,C=T===void 0?0:T,N=p.isDisplayShadowRoundControls,j=p.groupable;if(!r)return null;var O=h||BR(t),M=c?4:3,A=zR(O,i,a,b,!0);if(!A)return null;var k=0,D=0,V=j?[0,0]:[u,d];return A.map(function(L,U){var P=L.horizontal,K=L.vertical,X=L.direction||"",q=Ce([],ne(L.pos),!1);D+=Math.abs(P),k+=Math.abs(K),P&&X.indexOf("n")>-1&&(q[1]-=C),K&&X.indexOf("w")>-1&&(q[0]-=C),P&&X.indexOf("s")>-1&&(q[1]+=C),K&&X.indexOf("e")>-1&&(q[0]+=C);var Q=He(an(o,q,M),V),te=N&&N!=="horizontal",se=L.vertical?k<=S[1]&&(te||!L.virtual):D<=S[0]&&(N||!L.virtual);return e.createElement("div",{key:"borderRadiusControl".concat(U),className:Fe("control","border-radius",L.vertical?"vertical":"",L.virtual?"virtual":""),"data-radius-index":U,style:{display:se?"block":"none",transform:"translate(".concat(Q[0],"px, ").concat(Q[1],"px) scale(").concat(E,")")}})})},dragControlCondition:function(t,e){if(!e.inputEvent||e.isRequest)return!1;var n=e.inputEvent.target.getAttribute("class")||"";return n.indexOf("border-radius")>-1||n.indexOf("moveable-line")>-1&&n.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragControlStart:function(t,e){var n=e.inputEvent,r=e.datas,i=n.target,a=i.getAttribute("class")||"",o=a.indexOf("border-radius")>-1,c=a.indexOf("moveable-line")>-1&&a.indexOf("moveable-direction")>-1,u=o?parseInt(i.getAttribute("data-radius-index"),10):-1,d=-1;if(c){var h=i.getAttribute("data-line-key")||"";h&&(d=parseInt(h.replace(/render-line-/g,""),10),isNaN(d)&&(d=-1))}if(!o&&!c)return!1;var p=ct(t,e,{}),m=je(t,"onRoundStart",p);if(m===!1)return!1;r.lineIndex=d,r.controlIndex=u,r.isControl=o,r.isLine=c,lc(t,e);var b=t.props,w=b.roundRelative,S=b.minRoundControls,E=S===void 0?[0,0]:S,T=t.state,C=T.width,N=T.height;r.isRound=!0,r.prevDist=[0,0];var j=BR(t),O=zR(j||"",C,N,E,!0)||[];return r.controlPoses=O,T.borderRadiusState=eS(O,w,C,N).styles.join(" "),p},dragControl:function(t,e){var n=e.datas,r=n.controlPoses;if(!n.isRound||!n.isControl||!r.length)return!1;var i=n.controlIndex,a=ne(Ha(e),2),o=a[0],c=a[1],u=[o,c],d=He(u,n.prevDist),h=t.props.maxRoundControls,p=h===void 0?[4,4]:h,m=t.state,b=m.width,w=m.height,S=r[i],E=S.vertical,T=S.horizontal,C=r.map(function(j){var O=j.horizontal,M=j.vertical,A=[O*T*u[0],M*E*u[1]];if(O){if(p[0]===1)return A;if(p[0]<4&&O!==T)return A}else{if(p[1]===0)return A[1]=M*T*u[0]/b*w,A;if(E){if(p[1]===1)return A;if(p[1]<4&&M!==E)return A}}return[0,0]});C[i]=u;var N=r.map(function(j,O){return ee(ee({},j),{pos:At(j.pos,C[O])})});return i<4?N.slice(0,i+1).forEach(function(j){j.virtual=!1}):N.slice(4,i+1).forEach(function(j){j.virtual=!1}),n.prevDist=[o,c],LR(t,e,u,d,N)},dragControlEnd:function(t,e){var n=t.state;n.borderRadiusState="";var r=e.datas,i=e.isDouble;if(!r.isRound)return!1;var a=r.isControl,o=r.controlIndex,c=r.isLine,u=r.lineIndex,d=r.controlPoses,h=d.filter(function(T){var C=T.virtual;return C}).length,p=t.props.roundClickable,m=p===void 0?!0:p;if(i&&m){if(a&&(m===!0||m==="control"))uQ(d,o);else if(c&&(m===!0||m==="line")){var b=ne(AO(t,e),2),w=b[0],S=b[1];lQ(d,u,w,S)}h!==d.filter(function(T){var C=T.virtual;return C}).length&&LR(t,e,[0,0],[0,0],d)}var E=ri(t,e,{});return je(t,"onRoundEnd",E),n.borderRadiusState="",E},dragGroupControlStart:function(t,e){var n=this.dragControlStart(t,e);if(!n)return!1;var r=t.moveables,i=t.props.targets,a=Wi(t,"roundable",e),o=ee({targets:t.props.targets,events:a.map(function(c,u){return ee(ee({},c),{target:i[u],moveable:r[u],currentTarget:r[u]})})},n);return je(t,"onRoundGroupStart",o),n},dragGroupControl:function(t,e){var n=this.dragControl(t,e);if(!n)return!1;var r=t.moveables,i=t.props.targets,a=Wi(t,"roundable",e),o=ee({targets:t.props.targets,events:a.map(function(c,u){return ee(ee(ee({},c),{target:i[u],moveable:r[u],currentTarget:r[u]}),wr({borderRadius:n.borderRadius},c))})},n);return je(t,"onRoundGroup",o),o},dragGroupControlEnd:function(t,e){var n=t.moveables,r=t.props.targets,i=Wi(t,"roundable",e);Z0(t,"onRound",function(c){var u=ee({targets:t.props.targets,events:i.map(function(d,h){return ee(ee(ee({},d),{target:r[h],moveable:n[h],currentTarget:n[h]}),wr({borderRadius:c.borderRadius},d))})},c);je(t,"onRoundGroup",u)});var a=this.dragControlEnd(t,e);if(!a)return!1;var o=ee({targets:t.props.targets,events:i.map(function(c,u){var d;return ee(ee({},c),{target:r[u],moveable:n[u],currentTarget:n[u],lastEvent:(d=c.datas)===null||d===void 0?void 0:d.lastEvent})})},a);return je(t,"onRoundGroupEnd",o),o},unset:function(t){t.state.borderRadiusState=""}};function fQ(t,e){var n=e?4:3,r=Qt(n),i="matrix".concat(e?"3d":"","(").concat(r.join(","),")");return t===i||t==="matrix(1,0,0,1,0,0)"}var SP={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(t,e){var n=t.state,r=n.is3d,i=n.targetMatrix,a=n.inlineTransform,o=r?"matrix3d(".concat(i.join(","),")"):"matrix(".concat(hO(i,!0),")"),c=!a||a==="none"?o:a;e.datas.startTransforms=fQ(c,r)?[]:Yo(c)},resetStyle:function(t){var e=t.datas;e.nextStyle={},e.nextTransforms=t.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(t,e){return ct(t,e,{setTransform:function(n){e.datas.startTransforms=Vn(n)?n:Yo(n)},isPinch:!!e.isPinch})},fillDragParams:function(t,e){return ct(t,e,{isPinch:!!e.isPinch})},dragStart:function(t,e){this.setTransform(t,e),this.resetStyle(e),je(t,"onBeforeRenderStart",this.fillDragStartParams(t,e))},drag:function(t,e){e.datas.startTransforms||this.setTransform(t,e),this.resetStyle(e),je(t,"onBeforeRender",ct(t,e,{isPinch:!!e.isPinch}))},dragEnd:function(t,e){e.datas.startTransforms||(this.setTransform(t,e),this.resetStyle(e)),je(t,"onBeforeRenderEnd",ct(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(t,e){var n=this;this.dragStart(t,e);var r=Wi(t,"beforeRenderable",e),i=t.moveables,a=r.map(function(o,c){var u=i[c];return n.setTransform(u,o),n.resetStyle(o),n.fillDragStartParams(u,o)});je(t,"onBeforeRenderGroupStart",ct(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,setTransform:function(){},events:a}))},dragGroup:function(t,e){var n=this;this.drag(t,e);var r=Wi(t,"beforeRenderable",e),i=t.moveables,a=r.map(function(o,c){var u=i[c];return n.resetStyle(o),n.fillDragParams(u,o)});je(t,"onBeforeRenderGroup",ct(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,events:a}))},dragGroupEnd:function(t,e){this.dragEnd(t,e),je(t,"onBeforeRenderGroupEnd",ct(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets}))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)}},EP={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(t,e){je(t,"onRenderStart",ct(t,e,{isPinch:!!e.isPinch}))},drag:function(t,e){je(t,"onRender",this.fillDragParams(t,e))},dragAfter:function(t,e){return this.drag(t,e)},dragEnd:function(t,e){je(t,"onRenderEnd",this.fillDragEndParams(t,e))},dragGroupStart:function(t,e){je(t,"onRenderGroupStart",ct(t,e,{isPinch:!!e.isPinch,targets:t.props.targets}))},dragGroup:function(t,e){var n=this,r=Wi(t,"beforeRenderable",e),i=t.moveables,a=r.map(function(o,c){var u=i[c];return n.fillDragParams(u,o)});je(t,"onRenderGroup",ct(t,e,ee(ee({isPinch:!!e.isPinch,targets:t.props.targets,transform:Og(e),transformObject:{}},wr(Pg(e))),{events:a})))},dragGroupEnd:function(t,e){var n=this,r=Wi(t,"beforeRenderable",e),i=t.moveables,a=r.map(function(o,c){var u=i[c];return n.fillDragEndParams(u,o)});je(t,"onRenderGroupEnd",ct(t,e,ee({isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets,events:a,transformObject:{},transform:Og(e)},wr(Pg(e)))))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlAfter:function(t,e){return this.dragAfter(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)},fillDragParams:function(t,e){var n={};return Mu(Hm(e)||[]).forEach(function(r){n[r.name]=r.functionValue}),ct(t,e,ee({isPinch:!!e.isPinch,transformObject:n,transform:Og(e)},wr(Pg(e))))},fillDragEndParams:function(t,e){var n={};return Mu(Hm(e)||[]).forEach(function(r){n[r.name]=r.functionValue}),ct(t,e,ee({isPinch:!!e.isPinch,isDrag:e.isDrag,transformObject:n,transform:Og(e)},wr(Pg(e))))}};function zf(t,e,n,r,i,a,o){a.clientDistX=a.distX,a.clientDistY=a.distY;var c=i==="Start",u=i==="End",d=i==="After",h=t.state.target,p=a.isRequest,m=r.indexOf("Control")>-1;if(!h||c&&m&&!p&&t.areaElement===a.inputEvent.target)return!1;var b=Ce([],ne(e),!1);if(p){var w=a.requestAble;b.some(function(U){return U.name===w})||b.push.apply(b,Ce([],ne(t.props.ables.filter(function(U){return U.name===w})),!1))}if(!b.length||b.every(function(U){return U.dragRelation}))return!1;var S=a.inputEvent,E;u&&S&&(E=document.elementFromPoint(a.clientX,a.clientY)||S.target);var T=!1,C=function(){var U;T=!0,(U=a.stop)===null||U===void 0||U.call(a)},N=c&&(!t.targetGesto||!t.controlGesto||!t.targetGesto.isFlag()||!t.controlGesto.isFlag());N&&t.updateRect(i,!0,!1);var j=a.datas,O=m?"controlGesto":"targetGesto",M=t[O],A=function(U,P,K){if(!(P in U)||M!==t[O])return!1;var X=U.name,q=j[X]||(j[X]={});if(c&&(q.isEventStart=!K||!U[K]||U[K](t,a)),!q.isEventStart)return!1;var Q=U[P](t,ee(ee({},a),{stop:C,datas:q,originalDatas:j,inputTarget:E}));return t._emitter.off(),c&&Q===!1&&(q.isEventStart=!1),Q};N&&b.forEach(function(U){U.unset&&U.unset(t)}),A(SP,"drag".concat(r).concat(i));var k=0,D=0;n.forEach(function(U){if(T)return!1;var P="".concat(U).concat(r).concat(i),K="".concat(U).concat(r,"Condition");i===""&&!p&&PK(t.state,a);var X=b.filter(function(te){return te[P]});X=X.filter(function(te,se){return te.name&&X.indexOf(te)===se});var q=X.filter(function(te){return A(te,P,K)}),Q=q.length;T&&++k,Q&&++D,!T&&c&&X.length&&!Q&&(k+=X.filter(function(te){var se=te.name,G=j[se];return G.isEventStart?te.dragRelation!=="strong":!1}).length?1:0)}),(!d||D)&&A(EP,"drag".concat(r).concat(i));var V=M!==t[O]||k===n.length;if((u||T||V)&&(t.state.gestos={},t.moveables&&t.moveables.forEach(function(U){U.state.gestos={}}),b.forEach(function(U){U.unset&&U.unset(t)})),c&&!V&&!p&&D&&t.props.preventDefault&&a?.preventDefault(),t.isUnmounted||V)return!1;if(!c&&D&&!o||u){var L=t.props.flushSync||tP;L(function(){t.updateRect(u?i:"",!0,!1),t.forceUpdate()})}return!c&&!u&&!d&&D&&!o&&zf(t,e,n,r,i+"After",a),!0}function nS(t,e){return function(n,r){var i;r===void 0&&(r=n.inputEvent.target);var a=r,o=t.areaElement,c=t._dragTarget;return!c||!e&&(!((i=t.controlGesto)===null||i===void 0)&&i.isFlag())?!1:a===c||c.contains(a)||a===o||!t.isMoveableElement(a)&&!t.controlBox.contains(a)||Un(a,"moveable-area")||Un(a,"moveable-padding")||Un(a,"moveable-edgeDraggable")}}function TP(t,e,n){var r=t.controlBox,i=[],a=t.props,o=a.dragArea,c=t.state.target,u=a.dragTarget;i.push(r),(!o||u)&&i.push(e),!o&&u&&c&&e!==c&&a.dragTargetSelf&&i.push(c);var d=nS(t);return CP(t,i,"targetAbles",n,{dragStart:d,pinchStart:d})}function AP(t,e){var n=t.controlBox,r=[];r.push(n);var i=nS(t,!0),a=function(o,c){if(c===void 0&&(c=o.inputEvent.target),c===n)return!0;var u=i(o,c);return!u};return CP(t,r,"controlAbles",e,{dragStart:a,pinchStart:a})}function CP(t,e,n,r,i){i===void 0&&(i={});var a=n==="targetAbles",o=t.props,c=o.pinchOutside,u=o.pinchThreshold,d=o.preventClickEventOnDrag,h=o.preventClickDefault,p=o.checkInput,m=o.dragFocusedInput,b=o.preventDefault,w=b===void 0?!0:b,S=o.preventRightClick,E=S===void 0?!0:S,T=o.preventWheelClick,C=T===void 0?!0:T,N=o.dragContainer,j=za(N,!0),O={preventDefault:w,preventRightClick:E,preventWheelClick:C,container:j||Oo(t.getControlBoxElement()),pinchThreshold:u,pinchOutside:c,preventClickEventOnDrag:a?d:!1,preventClickEventOnDragStart:a?h:!1,preventClickEventByCondition:a?null:function(k){return t.controlBox.contains(k.target)},checkInput:a?p:!1,dragFocusedInput:m},M=new LX(e,O),A=r==="Control";return["drag","pinch"].forEach(function(k){["Start","","End"].forEach(function(D){M.on("".concat(k).concat(D),function(V){var L,U=V.eventType,P=k==="drag"&&V.isPinch;if(i[U]&&!i[U](V)){V.stop();return}if(!P){var K=k==="drag"?[k]:["drag",k],X=Ce([],ne(t[n]),!1),q=zf(t,X,K,r,D,V);q?(t.props.stopPropagation||D==="Start"&&A)&&((L=V?.inputEvent)===null||L===void 0||L.stopPropagation()):V.stop()}})})}),M}var hQ=(function(){function t(e,n,r){var i=this;this.target=e,this.moveable=n,this.eventName=r,this.ables=[],this._onEvent=function(a){var o=i.eventName,c=i.moveable;c.state.disableNativeEvent||i.ables.forEach(function(u){u[o](c,{inputEvent:a})})},e.addEventListener(r.toLowerCase(),this._onEvent)}return t.prototype.setAbles=function(e){this.ables=e},t.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},t})();function pQ(t,e,n,r){var i;n===void 0&&(n=e);var a=IO(t,e),o=a.matrixes,c=a.is3d,u=a.targetMatrix,d=a.transformOrigin,h=a.targetOrigin,p=a.offsetContainer,m=a.hasFixed,b=a.zoom,w=kW(p,n),S=w.matrixes,E=w.is3d,T=w.offsetContainer,C=w.zoom,N=r,j=4,O=t.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in t,M=u,A=Qt(j),k=Qt(j),D=Qt(j),V=Qt(j),L=o.length,U=S.map(function(se){return ee(ee({},se),{matrix:se.matrix?Ce([],ne(se.matrix),!1):void 0})}).reverse();o.reverse(),!c&&N&&(M=ta(M,3,4),E1(o)),!E&&N&&E1(U),U.forEach(function(se){k=Gt(k,se.matrix,j)});var P=n||nl(t),K=((i=U[0])===null||i===void 0?void 0:i.target)||lh(P,P,!0).offsetParent,X=U.slice(1).reduce(function(se,G){return Gt(se,G.matrix,j)},Qt(j));o.forEach(function(se,G){if(L-2===G&&(D=A.slice()),L-1===G&&(V=A.slice()),!se.matrix){var F=o[G+1],Y=DK(se,F,K,j,Gt(X,A,j));se.matrix=ec(Y,j)}A=Gt(A,se.matrix,j)});var q=!O&&c;M||(M=Qt(q?4:3));var Q=Q0(O&&M.length===16?ta(M,4,3):M,q),te=k;return k=dO(k,j,j),{hasZoom:b!==1||C!==1,hasFixed:m,matrixes:o,rootMatrix:k,originalRootMatrix:te,beforeMatrix:D,offsetMatrix:V,allMatrix:A,targetMatrix:M,targetTransform:Q,inlineTransform:t.style.transform,transformOrigin:d,targetOrigin:h,is3d:N,offsetContainer:p,offsetRootContainer:T}}function gQ(t,e,n,r){n===void 0&&(n=e);var i=0,a=0,o=0,c={},u=aP(t);if(t&&(i=u.offsetWidth,a=u.offsetHeight),t){var d=pQ(t,e,n,r),h=wu(d.allMatrix,d.transformOrigin,i,a);c=ee(ee({},d),h);var p=wu(d.allMatrix,[50,50],100,100);o=sP([p.pos1,p.pos2],p.direction)}var m=4;return ee(ee(ee({hasZoom:!1,width:i,height:a,rotation:o},u),{originalRootMatrix:Qt(m),rootMatrix:Qt(m),beforeMatrix:Qt(m),offsetMatrix:Qt(m),allMatrix:Qt(m),targetMatrix:Qt(m),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!0,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),c)}function k1(t,e,n,r,i,a){a===void 0&&(a=[]);var o=1,c=[0,0],u=Vg(),d=Vg(),h=Vg(),p=Vg(),m=[0,0],b={},w=gQ(e,n,i,!0);if(e){var S=Lr(e);a.forEach(function(U){b[U]=S(U)});var E=w.is3d?4:3,T=wu(w.offsetMatrix,At(w.transformOrigin,fO(w.targetMatrix,E)),w.width,w.height);o=T.direction,c=At(T.origin,[T.left-w.left,T.top-w.top]),p=Vf(w.offsetRootContainer);var C=lh(r,r,!0).offsetParent||w.offsetRootContainer;if(w.hasZoom){var N=wu(Gt(w.originalRootMatrix,w.allMatrix),w.transformOrigin,w.width,w.height),j=wu(w.originalRootMatrix,Wm(Lr(C)("transformOrigin")).map(function(U){return parseFloat(U)}),C.offsetWidth,C.offsetHeight);if(u=Xb(N,p),h=Xb(j,p,C,!0),t){var O=N.left,M=N.top;d=Xb({left:O,top:M,bottom:M,right:M},p)}}else{u=Vf(e),h=CW(C),t&&(d=Vf(t));var A=h.left,k=h.top,D=h.clientLeft,V=h.clientTop,L=[u.left-A,u.top-k];m=He(Vu(w.rootMatrix,L,4),[D+w.left,V+w.top])}}return ee({targetClientRect:u,containerClientRect:h,moveableClientRect:d,rootContainerClientRect:p,beforeDirection:o,beforeOrigin:c,originalBeforeOrigin:c,target:e,style:b,offsetDelta:m},w)}function UR(t){var e=t.pos1,n=t.pos2,r=t.pos3,i=t.pos4;if(!e||!n||!r||!i)return null;var a=tc([e,n,r,i]),o=[a.minX,a.minY],c=He(t.origin,o);return e=He(e,o),n=He(n,o),r=He(r,o),i=He(i,o),ee(ee({},t),{left:t.left,top:t.top,posDelta:o,pos1:e,pos2:n,pos3:r,pos4:i,origin:c,beforeOrigin:c,isPersisted:!0})}var zu=(function(t){Fh(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.state=ee({container:null,gestos:{},renderLines:[[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]]],renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},k1(null)),n.renderState={},n.enabledAbles=[],n.targetAbles=[],n.controlAbles=[],n.rotation=0,n.scale=[1,1],n.isMoveableMounted=!1,n.isUnmounted=!1,n.events={mouseEnter:null,mouseLeave:null},n._emitter=new $0,n._prevOriginalDragTarget=null,n._originalDragTarget=null,n._prevDragTarget=null,n._dragTarget=null,n._prevPropTarget=null,n._propTarget=null,n._prevDragArea=!1,n._isPropTargetChanged=!1,n._hasFirstTarget=!1,n._reiszeObserver=null,n._observerId=0,n._mutationObserver=null,n._rootContainer=null,n._viewContainer=null,n._viewClassNames=[],n._store={},n.checkUpdateRect=function(){if(!n.isDragging()){var r=n.props.parentMoveable;if(r){r.checkUpdateRect();return}NY(n._observerId),n._observerId=L4(function(){n.isDragging()||n.updateRect()})}},n._onPreventClick=function(r){r.stopPropagation(),r.preventDefault()},n}return e.prototype.render=function(){var n=this.props,r=this.getState(),i=n.parentPosition,a=n.className,o=n.target,c=n.zoom,u=n.cspNonce,d=n.translateZ,h=n.cssStyled,p=n.groupable,m=n.linePadding,b=n.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var w=ne(i||[0,0],2),S=w[0],E=w[1],T=r.left,C=r.top,N=r.target,j=r.direction,O=r.hasFixed,M=r.offsetDelta,A=n.targets,k=this.isDragging(),D={};this.getEnabledAbles().forEach(function(X){D["data-able-".concat(X.name.toLowerCase())]=!0});var V=this._getAbleClassName(),L=A&&A.length&&(N||p)||o||!this._hasFirstTarget&&this.state.isPersisted,U=this.controlBox||this.props.firstRenderState||this.props.persistData,P=[T-S,C-E];!p&&n.useAccuratePosition&&(P[0]+=M[0],P[1]+=M[1]);var K={position:O?"fixed":"absolute",display:L?"block":"none",visibility:U?"visible":"hidden",transform:"translate3d(".concat(P[0],"px, ").concat(P[1],"px, ").concat(d,")"),"--zoom":c,"--zoompx":"".concat(c,"px")};return m&&(K["--moveable-line-padding"]=m),b&&(K["--moveable-control-padding"]=b),Xi(h,ee({cspNonce:u,ref:ws(this,"controlBox"),className:"".concat(Fe("control-box",j===-1?"reverse":"",k?"dragging":"")," ").concat(V," ").concat(a)},D,{onClick:this._onPreventClick,style:K}),this.renderAbles(),this._renderLines())},e.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var n=this.props,r=n.parentMoveable,i=n.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!r&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},e.prototype.componentDidUpdate=function(n){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(n)},e.prototype.componentWillUnmount=function(){var n,r;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(n=this._reiszeObserver)===null||n===void 0||n.disconnect(),(r=this._mutationObserver)===null||r===void 0||r.disconnect();var i=this._viewContainer;i&&this._changeAbleViewClassNames([]),fu(this,!1),fu(this,!0);var a=this.events;for(var o in a){var c=a[o];c&&c.destroy()}},e.prototype.getTargets=function(){var n=this.props.target;return n?[n]:[]},e.prototype.getAble=function(n){var r=this.props.ables||[];return zr(r,function(i){return i.name===n})},e.prototype.getContainer=function(){var n=this.props,r=n.parentMoveable,i=n.wrapperMoveable,a=n.container;return a||i&&i.getContainer()||r&&r.getContainer()||this.controlBox.parentElement},e.prototype.getControlBoxElement=function(){return this.controlBox},e.prototype.getDragElement=function(){return this._dragTarget},e.prototype.isMoveableElement=function(n){var r;return n&&(((r=n.getAttribute)===null||r===void 0?void 0:r.call(n,"class"))||"").indexOf(V_)>-1},e.prototype.dragStart=function(n,r){r===void 0&&(r=n.target);var i=this.targetGesto,a=this.controlGesto;return i&&nS(this)({inputEvent:n},r)?i.isFlag()||i.triggerDragStart(n):a&&this.isMoveableElement(r)&&(a.isFlag()||a.triggerDragStart(n)),this},e.prototype.hitTest=function(n){var r=this.state,i=r.target,a=r.pos1,o=r.pos2,c=r.pos3,u=r.pos4,d=r.targetClientRect;if(!i)return 0;var h;if(td(n)){var p=n.getBoundingClientRect();h={left:p.left,top:p.top,width:p.width,height:p.height}}else h=ee({width:0,height:0},n);var m=h.left,b=h.top,w=h.width,S=h.height,E=uR([a,o,u,c],d),T=MX(E,[[m,b],[m+w,b],[m+w,b+S],[m,b+S]]),C=mO(E);return!T||!C?0:Math.min(100,T/C*100)},e.prototype.isInside=function(n,r){var i=this.state,a=i.target,o=i.pos1,c=i.pos2,u=i.pos3,d=i.pos4,h=i.targetClientRect;return a?d1([n,r],uR([o,c,d,u],h)):!1},e.prototype.updateRect=function(n,r,i){i===void 0&&(i=!0);var a=this.props,o=!a.parentPosition&&!a.wrapperMoveable;o&&Pu(!0);var c=a.parentMoveable,u=this.state,d=u.target||a.target,h=this.getContainer(),p=c?c._rootContainer:this._rootContainer,m=k1(this.controlBox,d,h,h,p||h,this._getRequestStyles());if(!d&&this._hasFirstTarget&&a.persistData){var b=UR(a.persistData);for(var w in b)m[w]=b[w]}o&&Pu(),this.updateState(m,c?!1:i)},e.prototype.isDragging=function(n){var r,i,a=this.targetGesto,o=this.controlGesto;if(a?.isFlag()){if(!n)return!0;var c=a.getEventData();return!!(!((r=c[n])===null||r===void 0)&&r.isEventStart)}if(o?.isFlag()){if(!n)return!0;var c=o.getEventData();return!!(!((i=c[n])===null||i===void 0)&&i.isEventStart)}return!1},e.prototype.updateTarget=function(n){this.updateRect(n,!0)},e.prototype.getRect=function(){var n=this.state,r=Di(this.state),i=ne(r,4),a=i[0],o=i[1],c=i[2],u=i[3],d=ki(r),h=n.width,p=n.height,m=d.width,b=d.height,w=d.left,S=d.top,E=[n.left,n.top],T=At(E,n.origin),C=At(E,n.beforeOrigin),N=n.transformOrigin;return{width:m,height:b,left:w,top:S,pos1:a,pos2:o,pos3:c,pos4:u,offsetWidth:h,offsetHeight:p,beforeOrigin:C,origin:T,transformOrigin:N,rotation:this.getRotation()}},e.prototype.getManager=function(){return this},e.prototype.stopDrag=function(n){if(!n||n==="target"){var r=this.targetGesto;r?.isIdle()===!1&&T1(this,!1),r?.stop()}if(!n||n==="control"){var r=this.controlGesto;r?.isIdle()===!1&&T1(this,!0),r?.stop()}},e.prototype.getRotation=function(){var n=this.state,r=n.pos1,i=n.pos2,a=n.direction;return zK(r,i,a)},e.prototype.request=function(n,r,i){r===void 0&&(r={});var a=this,o=a.props,c=o.parentMoveable||o.wrapperMoveable||a,u=c.props.ables,d=o.groupable,h=zr(u,function(T){return T.name===n});if(this.isDragging()||!h||!h.request)return{request:function(){return this},requestEnd:function(){return this}};var p=h.request(a),m=i||r.isInstant,b=p.isControl?"controlAbles":"targetAbles",w="".concat(d?"Group":"").concat(p.isControl?"Control":""),S=Ce([],ne(c[b]),!1),E={request:function(T){return zf(a,S,["drag"],w,"",ee(ee({},p.request(T)),{requestAble:n,isRequest:!0}),m),E},requestEnd:function(){return zf(a,S,["drag"],w,"End",ee(ee({},p.requestEnd()),{requestAble:n,isRequest:!0}),m),E}};return zf(a,S,["drag"],w,"Start",ee(ee({},p.requestStart(r)),{requestAble:n,isRequest:!0}),m),m?E.request(r).requestEnd():E},e.prototype.getMoveables=function(){return[this]},e.prototype.destroy=function(){this.componentWillUnmount()},e.prototype.updateRenderPoses=function(){var n=this.getState(),r=this.props,i=r.padding,a=n.originalBeforeOrigin,o=n.transformOrigin,c=n.allMatrix,u=n.is3d,d=n.pos1,h=n.pos2,p=n.pos3,m=n.pos4,b=n.left,w=n.top,S=n.isPersisted,E=r.zoom||1;if(!i&&E<=1){n.renderPoses=[d,h,p,m],n.renderLines=[[d,h],[h,m],[m,p],[p,d]];return}var T=mP(i||{}),C=T.left,N=T.top,j=T.bottom,O=T.right,M=u?4:3,A=[];S?A=o:this.controlBox&&r.groupable?A=a:A=At(a,[b,w]);var k=$m(M,ec(A.map(function(K){return-K}),M),c,ec(o,M)),D=bi(k,d,[-C,-N],M),V=bi(k,h,[O,-N],M),L=bi(k,p,[-C,j],M),U=bi(k,m,[O,j],M);n.renderPoses=[D,V,L,U],n.renderLines=[[D,V],[V,U],[U,L],[L,D]];{var P=E/2;n.renderLines=[[bi(k,d,[-C-P,-N],M),bi(k,h,[O+P,-N],M)],[bi(k,h,[O,-N-P],M),bi(k,m,[O,j+P],M)],[bi(k,m,[O+P,j],M),bi(k,p,[-C-P,j],M)],[bi(k,p,[-C,j+P],M),bi(k,d,[-C,-N-P],M)]]}},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var n=this.props,r=n.target,i=n.container,a=n.parentMoveable,o=this.state,c=o.target,u=o.container;if(!(!c&&!r)){this.updateAbles();var d=!A1(c,r),h=d||!A1(u,i);if(h){var p=i||this.controlBox;p&&this.unsetAbles(),this.updateState({target:r,container:i}),!a&&p&&this.updateRect("End",!1,!1),this._isPropTargetChanged=d}}},e.prototype.waitToChangeTarget=function(){return new Promise(function(){})},e.prototype.triggerEvent=function(n,r){var i=this.props;if(this._emitter.trigger(n,r),i.parentMoveable&&r.isRequest&&!r.isRequestChild)return i.parentMoveable.triggerEvent(n,r,!0);var a=i[n];return a&&a(r)},e.prototype.useCSS=function(n,r){var i=this.props.customStyledMap,a=n+r;return i[a]||(i[a]=bO(n,r)),i[a]},e.prototype.getState=function(){var n,r=this.props;(r.target||!((n=r.targets)===null||n===void 0)&&n.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,a=r.persistData,o=r.firstRenderState;if(o&&!i)return o;if(!this._hasFirstTarget&&a){var c=UR(a);if(c)return this.updateState(c,!1),this.state}return this.state.isPersisted=!1,this.state},e.prototype.updateSelectors=function(){},e.prototype.unsetAbles=function(){var n=this;this.targetAbles.forEach(function(r){r.unset&&r.unset(n)})},e.prototype.updateAbles=function(n,r){n===void 0&&(n=this.props.ables),r===void 0&&(r="");var i=this.props,a=i.triggerAblesSimultaneously,o=this.getEnabledAbles(n),c="drag".concat(r,"Start"),u="pinch".concat(r,"Start"),d="drag".concat(r,"ControlStart"),h=zg(o,[c,u],a),p=zg(o,[d],a);this.enabledAbles=o,this.targetAbles=h,this.controlAbles=p},e.prototype.updateState=function(n,r){if(r){if(this.isUnmounted)return;this.setState(n)}else{var i=this.state;for(var a in n)i[a]=n[a]}},e.prototype.getEnabledAbles=function(n){n===void 0&&(n=this.props.ables);var r=this.props;return n.filter(function(i){return i&&(i.always&&r[i.name]!==!1||r[i.name])})},e.prototype.renderAbles=function(){var n=this,r=this.props,i=r.triggerAblesSimultaneously,a={createElement:Xi};return this.renderState={},OK(fP(zg(this.getEnabledAbles(),["render"],i).map(function(o){var c=o.render;return c(n,a)||[]})).filter(function(o){return o}),function(o){var c=o.key;return c}).map(function(o){return o[0]})},e.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},e.prototype._getRequestStyles=function(){var n=this.getEnabledAbles().reduce(function(r,i){var a,o,c=(o=(a=i.requestStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return Ce(Ce([],ne(r),!1),ne(c),!1)},Ce([],ne(this.props.requestStyles||[]),!1));return n},e.prototype._updateObserver=function(n){this._updateResizeObserver(n),this._updateMutationObserver(n)},e.prototype._updateEvents=function(){var n=this.targetAbles.length,r=this.controlAbles.length,i=this._dragTarget,a=!n&&this.targetGesto||this._isTargetChanged(!0);a&&(fu(this,!1),this.updateState({gestos:{}})),r||fu(this,!0),i&&n&&!this.targetGesto&&(this.targetGesto=TP(this,i,"")),!this.controlGesto&&r&&(this.controlGesto=AP(this,"Control"))},e.prototype._updateTargets=function(){var n=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=n.dragArea,this._propTarget=n.target,this._originalDragTarget=n.dragTarget||n.target,this._dragTarget=za(this._originalDragTarget,!0)},e.prototype._renderLines=function(){var n=this.props,r=n,i=r.zoom,a=r.hideDefaultLines,o=r.hideChildMoveableDefaultLines,c=r.parentMoveable;if(a||c&&o)return[];var u=this.getState(),d={createElement:Xi};return u.renderLines.map(function(h,p){return oh(d,"",h[0],h[1],i,"render-line-".concat(p))})},e.prototype._isTargetChanged=function(n){var r=this.props,i=r.dragTarget||r.target,a=this._prevOriginalDragTarget,o=this._prevDragArea,c=r.dragArea,u=!c&&a!==i,d=(n||c)&&o!==c;return u||d||this._prevPropTarget!=this._propTarget},e.prototype._updateNativeEvents=function(){var n=this,r=this.props,i=r.dragArea?this.areaElement:this.state.target,a=this.events,o=Is(a);if(this._isTargetChanged())for(var c in a){var u=a[c];u&&u.destroy(),a[c]=null}if(i){var d=this.enabledAbles;o.forEach(function(h){var p=zg(d,[h]),m=p.length>0,b=a[h];if(!m){b&&(b.destroy(),a[h]=null);return}b||(b=new hQ(i,n,h),a[h]=b),b.setAbles(p)})}},e.prototype._checkUpdateRootContainer=function(){var n=this.props.rootContainer;!this._rootContainer&&n&&(this._rootContainer=za(n,!0))},e.prototype._checkUpdateViewContainer=function(){var n=this.props.viewContainer;!this._viewContainer&&n&&(this._viewContainer=za(n,!0));var r=this._viewContainer;r&&this._changeAbleViewClassNames(Ce(Ce([],ne(this._getAbleViewClassNames()),!1),[this.isDragging()?HK:""],!1))},e.prototype._changeAbleViewClassNames=function(n){var r=this._viewContainer,i=dP(n.filter(Boolean),function(d){return d}).map(function(d){var h=ne(d,1),p=h[0];return p}),a=this._viewClassNames,o=Vh(a,i),c=o.removed,u=o.added;c.forEach(function(d){G4(r,a[d])}),u.forEach(function(d){$4(r,i[d])}),this._viewClassNames=i},e.prototype._getAbleViewClassNames=function(){var n=this;return(this.getEnabledAbles().map(function(r){var i;return((i=r.viewClassName)===null||i===void 0?void 0:i.call(r,n))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},e.prototype._getAbleClassName=function(n){var r=this;n===void 0&&(n="");var i=this.getEnabledAbles(),a=this.targetGesto,o=this.controlGesto,c=a?.isFlag()?a.getEventData():{},u=o?.isFlag()?o.getEventData():{};return i.map(function(d){var h,p,m,b=d.name,w=((h=d.className)===null||h===void 0?void 0:h.call(d,r))||"";return(!((p=c[b])===null||p===void 0)&&p.isEventStart||!((m=u[b])===null||m===void 0)&&m.isEventStart)&&(w+=" ".concat(Fe("".concat(b).concat(n,"-dragging")))),w.trim()}).filter(Boolean).join(" ")},e.prototype._updateResizeObserver=function(n){var r,i=this.props,a=i.target,o=Oo(this.getControlBoxElement());if(!o.ResizeObserver||!a||!i.useResizeObserver){(r=this._reiszeObserver)===null||r===void 0||r.disconnect();return}if(!(n.target===a&&this._reiszeObserver)){var c=new o.ResizeObserver(this.checkUpdateRect);c.observe(a,{box:"border-box"}),this._reiszeObserver=c}},e.prototype._updateMutationObserver=function(n){var r=this,i,a=this.props,o=a.target,c=Oo(this.getControlBoxElement());if(!c.MutationObserver||!o||!a.useMutationObserver){(i=this._mutationObserver)===null||i===void 0||i.disconnect();return}if(!(n.target===o&&this._mutationObserver)){var u=new c.MutationObserver(function(d){var h,p;try{for(var m=KX(d),b=m.next();!b.done;b=m.next()){var w=b.value;w.type==="attributes"&&w.attributeName==="style"&&r.checkUpdateRect()}}catch(S){h={error:S}}finally{try{b&&!b.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}});u.observe(o,{attributes:!0}),this._mutationObserver=u}},e.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:tP,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},e})(Q4),rS={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(t,e){var n,r=t.props,i=r.targets||[],a=t.getState(),o=a.left,c=a.top,u=a.isPersisted,d=r.zoom||1,h=t.renderGroupRects,p=((n=r.persistData)===null||n===void 0?void 0:n.children)||[];u?i=p.map(function(){return null}):p=[];var m=hu(t,"parentPosition",[o,c],function(w){return w.join(",")}),b=hu(t,"requestStyles",t.getRequestChildStyles(),function(w){return w.join(",")});return t.moveables=t.moveables.slice(0,i.length),Ce(Ce([],ne(i.map(function(w,S){return e.createElement(zu,{key:"moveable"+S,ref:P4(t,"moveables",S),target:w,origin:!1,requestStyles:b,cssStyled:r.cssStyled,customStyledMap:r.customStyledMap,useResizeObserver:r.useResizeObserver,useMutationObserver:r.useMutationObserver,hideChildMoveableDefaultLines:r.hideChildMoveableDefaultLines,parentMoveable:t,parentPosition:[o,c],persistData:p[S],zoom:d})})),!1),ne(fP(h.map(function(w,S){var E=w.pos1,T=w.pos2,C=w.pos3,N=w.pos4,j=[E,T,C,N];return[[0,1],[1,3],[3,2],[2,0]].map(function(O,M){var A=ne(O,2),k=A[0],D=A[1];return oh(e,"",He(j[k],m),He(j[D],m),d,"group-rect-".concat(S,"-").concat(M))})}))),!1)}},mQ=$h("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(t,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(t,e){var n=t.props.target,r=e.inputEvent,i=e.inputTarget,a=t.isMoveableElement(i),o=!a&&t.controlBox.contains(i);if(!(!r||!i||e.isDrag||t.isMoveableElement(i)||o)){var c=n.contains(i);je(t,"onClick",ct(t,e,{isDouble:e.isDouble,inputTarget:i,isTarget:n===i,moveableTarget:t.props.target,containsTarget:c}))}},dragGroupEnd:function(t,e){var n=e.inputEvent,r=e.inputTarget;if(!(!n||!r||e.isDrag||t.isMoveableElement(r)||e.datas.inputTarget===r)){var i=t.props.targets,a=i.indexOf(r),o=a>-1,c=!1;a===-1&&(a=Ds(i,function(u){return u.contains(r)}),c=a>-1),je(t,"onClickGroup",ct(t,e,{isDouble:e.isDouble,targets:i,inputTarget:r,targetIndex:a,isTarget:o,containsTarget:c,moveableTarget:i[a]}))}},dragControlEnd:function(t,e){this.dragEnd(t,e)},dragGroupControlEnd:function(t,e){this.dragEnd(t,e)}});function Qc(t){var e=t.originalDatas.draggable;return e||(t.originalDatas.draggable={},e=t.originalDatas.draggable),ee(ee({},t),{datas:e})}var vQ=$h("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(t,e){var n=t.props,r=n.edgeDraggable;return r?PO(e,"edgeDraggable",r,t.getState().renderPoses,n.zoom):[]},dragCondition:function(t,e){var n,r=t.props,i=(n=e.inputEvent)===null||n===void 0?void 0:n.target;return!r.edgeDraggable||!i?!1:!r.draggable&&Un(i,Fe("direction"))&&Un(i,Fe("edge"))&&Un(i,Fe("edgeDraggable"))},dragStart:function(t,e){return yr.dragStart(t,Qc(e))},drag:function(t,e){return yr.drag(t,Qc(e))},dragEnd:function(t,e){return yr.dragEnd(t,Qc(e))},dragGroupCondition:function(t,e){var n,r=t.props,i=(n=e.inputEvent)===null||n===void 0?void 0:n.target;return!r.edgeDraggable||!i?!1:!r.draggable&&Un(i,Fe("direction"))&&Un(i,Fe("line"))},dragGroupStart:function(t,e){return yr.dragGroupStart(t,Qc(e))},dragGroup:function(t,e){return yr.dragGroup(t,Qc(e))},dragGroupEnd:function(t,e){return yr.dragGroupEnd(t,Qc(e))},unset:function(t){return yr.unset(t)}}),kP={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},iS=[SP,bP,wK,BK,yr,vQ,w1,UK,$K,rK,XK,WK,qK,oQ,sQ,dQ,rS,kP,mQ,yP,EP],yQ=iS.reduce(function(t,e){return(e.events||[]).forEach(function(n){F4(t,n)}),t},[]),bQ=iS.reduce(function(t,e){return(e.props||[]).forEach(function(n){F4(t,n)}),t},[]);function FR(t,e){var n=ne(t,3),r=n[0],i=n[1],a=n[2];return(r*e[0]+i*e[1]+a)/Math.sqrt(r*r+i*i)}function Ug(t,e){var n=ne(t,2),r=n[0],i=n[1];return-r*e[0]-i*e[1]}function $R(t,e){return Math.max.apply(Math,Ce([],ne(t.map(function(n){var r=ne(n,4),i=r[0],a=r[1],o=r[2],c=r[3];return Math.max(i[e],a[e],o[e],c[e])})),!1))}function GR(t,e){return Math.min.apply(Math,Ce([],ne(t.map(function(n){var r=ne(n,4),i=r[0],a=r[1],o=r[2],c=r[3];return Math.min(i[e],a[e],o[e],c[e])})),!1))}function xQ(t,e){var n,r,i,a=[0,0],o=[0,0],c=[0,0],u=[0,0],d=0,h=0;if(!t.length)return{pos1:a,pos2:o,pos3:c,pos4:u,minX:0,minY:0,maxX:0,maxY:0,width:d,height:h,rotation:e};var p=rt(e,Er);if(p%90){var m=p/180*Math.PI,b=Math.tan(m),w=-1/b,S=[v1,hR],E=[[0,0],[0,0]],T=[v1,hR],C=[[0,0],[0,0]];t.forEach(function(Z){Z.forEach(function(W){var le=FR([-b,1,0],W),ie=FR([-w,1,0],W);S[0]>le&&(E[0]=W,S[0]=le),S[1]<le&&(E[1]=W,S[1]=le),T[0]>ie&&(C[0]=W,T[0]=ie),T[1]<ie&&(C[1]=W,T[1]=ie)})});var N=ne(E,2),j=N[0],O=N[1],M=ne(C,2),A=M[0],k=M[1],D=[-b,1,Ug([-b,1],j)],V=[-b,1,Ug([-b,1],O)],L=[-w,1,Ug([-w,1],A)],U=[-w,1,Ug([-w,1],k)];n=ne([[D,L],[D,U],[V,L],[V,U]].map(function(Z){var W=ne(Z,2),le=W[0],ie=W[1];return P_(le,ie)[0]}),4),a=n[0],o=n[1],c=n[2],u=n[3],d=T[1]-T[0],h=S[1]-S[0]}else{var P=GR(t,0),K=GR(t,1),X=$R(t,0),q=$R(t,1);if(a=[P,K],o=[X,K],c=[P,q],u=[X,q],d=X-P,h=q-K,p%180){var Q=[c,a,u,o];r=ne(Q,4),a=r[0],o=r[1],c=r[2],u=r[3],d=q-K,h=X-P}}if(p%360>180){var Q=[u,c,o,a];i=ne(Q,4),a=i[0],o=i[1],c=i[2],u=i[3]}var te=tc([a,o,c,u]),se=te.minX,G=te.minY,F=te.maxX,Y=te.maxY;return{pos1:a,pos2:o,pos3:c,pos4:u,width:d,height:h,minX:se,minY:G,maxX:F,maxY:Y,rotation:e}}function RP(t,e){var n=e.map(function(r){if(Vn(r)){var i=RP(t,r),a=i.length;return a>1?i:a===1?i[0]:null}else{var o=zr(t,function(c){var u=c.manager;return u.props.target===r});return o?(o.finded=!0,o.manager):null}}).filter(Boolean);return n.length===1&&Vn(n[0])?n[0]:n}var wQ=(function(t){Fh(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.differ=new gO,n.moveables=[],n.transformOrigin="50% 50%",n.renderGroupRects=[],n._targetGroups=[],n._hasFirstTargets=!1,n}return e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this)},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(n,r,i){var a;i===void 0&&(i=!0);var o=this.state;if(!this.controlBox||o.isPersisted)return;Pu(!0),this.moveables.forEach(function(ce){ce.updateRect(n,!1,!1)});var c=this.props,u=this.moveables,d=o.target||c.target,h=u.map(function(ce){return{finded:!1,manager:ce}}),p=this.props.targetGroups||[],m=RP(h,p),b=c.useDefaultGroupRotate;m.push.apply(m,Ce([],ne(h.filter(function(ce){var xe=ce.finded;return!xe}).map(function(ce){var xe=ce.manager;return xe})),!1));var w=[],S=!r||n!==""&&c.updateGroup,E=c.defaultGroupRotate||0;if(!this._hasFirstTargets){var T=(a=c.persistData)===null||a===void 0?void 0:a.rotation;T!=null&&(E=T)}function C(ce,xe,Re){var ae=ce.map(function(Le){if(Vn(Le)){var Me=C(Le,xe),Be=[Me.pos1,Me.pos2,Me.pos3,Me.pos4];return w.push(Me),{poses:Be,rotation:Me.rotation}}else return{poses:Di(Le.state),rotation:Le.getRotation()}}),Ee=ae.map(function(Le){var Me=Le.rotation;return Me}),Ne=0,Ie=Ee[0],Oe=Ee.every(function(Le){return Math.abs(Ie-Le)<.1});S?Ne=!b&&Oe?Ie:E:Ne=!b&&!Re&&Oe?Ie:xe;var Ve=ae.map(function(Le){var Me=Le.poses;return Me}),Se=xQ(Ve,Ne);return Se}var N=C(m,this.rotation,!0);S&&(this.rotation=N.rotation,this.transformOrigin=c.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=p,this.renderGroupRects=w;var j=this.transformOrigin,O=this.rotation,M=this.scale,A=N.width,k=N.height,D=N.minX,V=N.minY,L=LK([[0,0],[A,0],[0,k],[A,k]],J_(j,A,k),this.rotation/180*Math.PI),U=tc(L.result),P=U.minX,K=U.minY,X=" rotate(".concat(O,"deg)")+" scale(".concat(br(M[0]),", ").concat(br(M[1]),")"),q="translate(".concat(-P,"px, ").concat(-K,"px)").concat(X);this.controlBox.style.transform="translate3d(".concat(D,"px, ").concat(V,"px, ").concat(this.props.translateZ||0,")"),d.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(j,";")+"width:".concat(A,"px;height:").concat(k,"px;")+"transform: ".concat(q),o.width=A,o.height=k;var Q=this.getContainer(),te=k1(this.controlBox,d,this.controlBox,this.getContainer(),this._rootContainer||Q,[]),se=[te.left,te.top],G=ne(Di(te),4),F=G[0],Y=G[1],Z=G[2],W=G[3],le=tc([F,Y,Z,W]),ie=[le.minX,le.minY],pe=br(M[0]*M[1]);te.pos1=He(F,ie),te.pos2=He(Y,ie),te.pos3=He(Z,ie),te.pos4=He(W,ie),te.left=D-te.left+ie[0],te.top=V-te.top+ie[1],te.origin=He(At(se,te.origin),ie),te.beforeOrigin=He(At(se,te.beforeOrigin),ie),te.originalBeforeOrigin=At(se,te.originalBeforeOrigin),te.transformOrigin=He(At(se,te.transformOrigin),ie),d.style.transform="translate(".concat(-P-ie[0],"px, ").concat(-K-ie[1],"px)")+X,Pu(),this.updateState(ee(ee({},te),{posDelta:ie,direction:pe,beforeDirection:pe}),i)},e.prototype.getRect=function(){return ee(ee({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(n){return n.getRect()})})},e.prototype.triggerEvent=function(n,r,i){if(i||n.indexOf("Group")>-1)return t.prototype.triggerEvent.call(this,n,r);this._emitter.trigger(n,r)},e.prototype.getRequestChildStyles=function(){var n=this.getEnabledAbles().reduce(function(r,i){var a,o,c=(o=(a=i.requestChildStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return Ce(Ce([],ne(r),!1),ne(c),!1)},[]);return n},e.prototype.getMoveables=function(){return Ce([],ne(this.moveables),!1)},e.prototype.updateAbles=function(){t.prototype.updateAbles.call(this,Ce(Ce([],ne(this.props.ables),!1),[rS],!1),"Group")},e.prototype._updateTargets=function(){t.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=za(this._originalDragTarget,!0)},e.prototype._updateEvents=function(){var n=this.state,r=this.props,i=this._prevDragTarget,a=r.dragTarget||this.areaElement,o=r.targets,c=this.differ.update(o),u=c.added,d=c.changed,h=c.removed,p=u.length||h.length;(p||this._prevOriginalDragTarget!==this._originalDragTarget)&&(fu(this,!1),fu(this,!0),this.updateState({gestos:{}})),i!==a&&(n.target=null),n.target||(n.target=this.areaElement,this.controlBox.style.display="block"),n.target&&(this.targetGesto||(this.targetGesto=TP(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=AP(this,"GroupControl")));var m=!A1(n.container,r.container);m&&(n.container=r.container),(m||p||this.transformOrigin!==(r.defaultGroupOrigin||"50% 50%")||d.length||o.length&&!gP(this._targetGroups,r.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!p},e.prototype._updateObserver=function(){},e.defaultProps=ee(ee({},zu.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e})(zu),_Q=(function(t){Fh(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.moveables=[],n}return e.prototype.render=function(){var n=this,r,i=this.props,a=i.cspNonce,o=i.cssStyled,c=i.persistData,u=i.targets||[],d=u.length,h=this.isUnmounted||!d,p=(r=c?.children)!==null&&r!==void 0?r:[];return h&&!d&&p.length?u=p.map(function(){return null}):h||(p=[]),Xi(o,{cspNonce:a,ref:ws(this,"controlBox"),className:Fe("control-box")},u.map(function(m,b){var w,S,E=(S=(w=i.individualGroupableProps)===null||w===void 0?void 0:w.call(i,m,b))!==null&&S!==void 0?S:{};return Xi(zu,ee({key:"moveable"+b,ref:P4(n,"moveables",b)},i,E,{target:m,wrapperMoveable:n,isWrapperMounted:n.isMoveableMounted,persistData:p[b]}))}))},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(n,r,i){i===void 0&&(i=!0),Pu(!0),this.moveables.forEach(function(a){a.updateRect(n,r,i)}),Pu()},e.prototype.getRect=function(){return ee(ee({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(n){return n.getRect()})})},e.prototype.request=function(n,r,i){r===void 0&&(r={});var a=this.moveables.map(function(u){return u.request(n,ee(ee({},r),{isInstant:!1}),!1)}),o=i||r.isInstant,c={request:function(u){return a.forEach(function(d){return d.request(u)}),this},requestEnd:function(){return a.forEach(function(u){return u.requestEnd()}),this}};return o?c.request(r).requestEnd():c},e.prototype.dragStart=function(n,r){r===void 0&&(r=n.target);var i=r,a=zr(this.moveables,function(o){var c=o.getTargets()[0],u=o.getControlBoxElement(),d=o.getDragElement();return!c||!d?!1:d===i||d.contains(i)||d!==c&&c===i||c.contains(i)||u===i||u.contains(i)});return a&&a.dragStart(n,r),this},e.prototype.hitTest=function(){return 0},e.prototype.isInside=function(){return!1},e.prototype.isDragging=function(){return!1},e.prototype.getDragElement=function(){return null},e.prototype.getMoveables=function(){return Ce([],ne(this.moveables),!1)},e.prototype.updateRenderPoses=function(){},e.prototype.checkUpdate=function(){},e.prototype.triggerEvent=function(){},e.prototype.updateAbles=function(){},e.prototype._updateEvents=function(){},e.prototype._updateObserver=function(){},e})(zu);function NP(t,e){var n=[];return t.forEach(function(r){if(r){if(Vr(r)){e[r]&&n.push.apply(n,Ce([],ne(e[r]),!1));return}Vn(r)?n.push.apply(n,Ce([],ne(NP(r,e)),!1)):n.push(r)}}),n}function DP(t,e){var n=[];return t.forEach(function(r){if(r){if(Vr(r)){e[r]&&n.push.apply(n,Ce([],ne(e[r]),!1));return}Vn(r)?n.push(DP(r,e)):n.push(r)}}),n}function IP(t,e){return t.length!==e.length||t.some(function(n,r){var i=e[r];return!n&&!i?!1:n!=i?Vn(n)&&Vn(i)?IP(n,i):!0:!1})}var SQ=(function(t){Fh(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.refTargets=[],n.selectorMap={},n._differ=new gO,n._elementTargets=[],n._tmpRefTargets=[],n._tmpSelectorMap={},n._onChangeTargets=null,n}return e.makeStyled=function(){var n={},r=this.getTotalAbles();r.forEach(function(a){var o=a.css;o&&o.forEach(function(c){n[c]=!0})});var i=Is(n).join(`
`);this.defaultStyled=bO("div",yY(V_,oW+i))},e.getTotalAbles=function(){return Ce([bP,rS,kP,yP],ne(this.defaultAbles),!1)},e.prototype.render=function(){var n,r=this.constructor;r.defaultStyled||r.makeStyled();var i=this.props,a=i.ables,o=i.props,c=XX(i,["ables","props"]),u=ne(this._updateRefs(!0),2),d=u[0],h=u[1],p=NP(d,h),m=p.length>1,b=r.getTotalAbles(),w=Ce(Ce([],ne(b),!1),ne(a||[]),!1),S=ee(ee(ee({},c),o||{}),{ables:w,cssStyled:r.defaultStyled,customStyledMap:r.customStyledMap});this._elementTargets=p;var E=null,T=this.moveable,C=c.persistData;if(C?.children&&(m=!0),c.individualGroupable)return Xi(_Q,ee({key:"individual-group",ref:ws(this,"moveable")},S,{target:null,targets:p}));if(m){var N=DP(d,h);if(T&&!T.props.groupable&&!T.props.individualGroupable){var j=T.props.target;j&&p.indexOf(j)>-1&&(E=ee({},T.state))}return Xi(wQ,ee({key:"group",ref:ws(this,"moveable")},S,(n=c.groupableProps)!==null&&n!==void 0?n:{},{target:null,targets:p,targetGroups:N,firstRenderState:E}))}else{var O=p[0];if(T&&(T.props.groupable||T.props.individualGroupable)){var M=T.moveables||[],A=zr(M,function(k){return k.props.target===O});A&&(E=ee({},A.state))}return Xi(zu,ee({key:"single",ref:ws(this,"moveable")},S,{target:O,firstRenderState:E}))}},e.prototype.componentDidMount=function(){this._checkChangeTargets()},e.prototype.componentDidUpdate=function(){this._checkChangeTargets()},e.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},e.prototype.getTargets=function(){var n,r;return(r=(n=this.moveable)===null||n===void 0?void 0:n.getTargets())!==null&&r!==void 0?r:[]},e.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs(),this.forceUpdate()},e.prototype.waitToChangeTarget=function(){var n=this,r;return this._onChangeTargets=function(){n._onChangeTargets=null,r()},new Promise(function(i){r=i})},e.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},e.prototype.getManager=function(){return this.moveable},e.prototype.getMoveables=function(){return this.moveable.getMoveables()},e.prototype.getDragElement=function(){return this.moveable.getDragElement()},e.prototype._updateRefs=function(n){var r=this.refTargets,i=Z_(this.props.target||this.props.targets),a=typeof document<"u",o=IP(r,i),c=this.selectorMap,u={};return this.refTargets.forEach(function d(h){if(Vr(h)){var p=c[h];p?u[h]=c[h]:a&&(o=!0,u[h]=[].slice.call(document.querySelectorAll(h)))}else Vn(h)&&h.forEach(d)}),this._tmpRefTargets=i,this._tmpSelectorMap=u,[i,u,!n&&o]},e.prototype._checkChangeTargets=function(){var n,r,i;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var a=this._differ.update(this._elementTargets),o=a.added,c=a.removed,u=o.length||c.length;u&&((r=(n=this.props).onChangeTargets)===null||r===void 0||r.call(n,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this));var d=ne(this._updateRefs(),3),h=d[0],p=d[1],m=d[2];this.refTargets=h,this.selectorMap=p,m&&this.forceUpdate()},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,WX([bY(TO)],e.prototype,"moveable",void 0),e})(Q4),EQ=(function(t){Fh(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.defaultAbles=iS,e})(SQ),R1=function(t,e){return R1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},R1(t,e)};function aS(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");R1(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var ch=function(){return ch=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ch.apply(this,arguments)};function TQ(t,e,n,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}var AQ=(function(t){aS(e,t);function e(r){var i=t.call(this,r)||this;return i.state={},i.state=i.props,i}var n=e.prototype;return n.render=function(){return Xi(EQ,ch({ref:ws(this,"moveable")},this.state))},e})(R_),CQ=bQ,kQ=TO,RQ=yQ,NQ=(function(t){aS(e,t);function e(r,i){i===void 0&&(i={});var a=t.call(this)||this;a.containerProvider=null,a.selfElement=null,a._warp=!1;var o=ch({},i),c={};RQ.forEach(function(h){c[RY("on ".concat(h))]=function(p){return a.trigger(h,p)}});var u;i.warpSelf?(delete i.warpSelf,a._warp=!0,u=r):(u=ed(r).createElement("div"),r.appendChild(u)),a.containerProvider=oR(Xi(AQ,ch({ref:ws(a,"innerMoveable")},o,c)),u),a.selfElement=u;var d=o.target;return Vn(d)&&d.length>1&&a.updateRect(),a}var n=e.prototype;return n.setState=function(r,i){this.innerMoveable.setState(r,i)},n.forceUpdate=function(r){this.innerMoveable.forceUpdate(r)},n.dragStart=function(r,i){i===void 0&&(i=r.target);var a=this.innerMoveable;a.$_timer&&this.forceUpdate(),this.getMoveable().dragStart(r,i)},n.destroy=function(){var r,i=this.selfElement;oR(null,i,this.containerProvider),this._warp||(r=i?.parentElement)===null||r===void 0||r.removeChild(i),this.containerProvider=null,this.off(),this.selfElement=null,this.innerMoveable=null},n.getMoveable=function(){return this.innerMoveable.moveable},e=TQ([Zk(kQ,function(r,i){r[i]||(r[i]=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];var c=this.getMoveable();if(!(!c||!c[i]))return c[i].apply(c,a)})}),Zk(CQ,function(r,i){Object.defineProperty(r,i,{get:function(){return this.getMoveable().props[i]},set:function(a){var o;this.setState((o={},o[i]=a,o))},enumerable:!0,configurable:!0})})],e),e})($0),MP=(function(t){aS(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(NQ),Co=(t=>(t.Mouse="mouse",t.Touch="touch",t.Pointer="pointer",t))(Co||{}),wf=(t=>(t.CancelledByMovement="cancelled-by-movement",t.CancelledByRelease="cancelled-by-release",t.CancelledOutsideElement="cancelled-outside-element",t))(wf||{});const DQ=["mousedown","mousemove","mouseup","mouseleave","mouseout"],IQ=["touchstart","touchmove","touchend","touchcancel"],MQ=["pointerdown","pointermove","pointerup","pointerleave","pointerout"];function OQ(t){return typeof t=="object"&&t!==null&&"pageX"in t&&typeof t.pageX=="number"&&"pageY"in t&&typeof t.pageY=="number"}function PQ(t){var e;return DQ.includes((e=t?.nativeEvent)==null?void 0:e.type)}function OP(t){var e;return IQ.includes((e=t?.nativeEvent)==null?void 0:e.type)||"touches"in t}function jQ(t){const{nativeEvent:e}=t;return e?MQ.includes(e?.type)||"pointerId"in e:!1}function Qb(t){return PQ(t)||OP(t)||jQ(t)}function HR(t){var e;const n=OP(t)?(e=t?.touches)==null?void 0:e[0]:t;return OQ(n)?{x:n.pageX,y:n.pageY}:null}function VQ(t){return{target:t.target,currentTarget:t.currentTarget,nativeEvent:t,persist:()=>{}}}function sS(t,{threshold:e=400,captureEvent:n=!1,detect:r=Co.Pointer,cancelOnMovement:i=!1,cancelOutsideElement:a=!0,filterEvents:o,onStart:c,onMove:u,onFinish:d,onCancel:h}={}){const p=B.useRef(!1),m=B.useRef(!1),b=B.useRef(),w=B.useRef(),S=B.useRef(t),E=B.useRef(null),T=B.useCallback(O=>M=>{m.current||Qb(M)&&(o!==void 0&&!o(M)||(n&&M.persist(),c?.(M,{context:O}),E.current=HR(M),m.current=!0,b.current=M.currentTarget,w.current=setTimeout(()=>{S.current&&(S.current(M,{context:O}),p.current=!0)},e)))},[n,o,c,e]),C=B.useCallback(O=>(M,A)=>{Qb(M)&&m.current&&(E.current=null,n&&M.persist(),p.current?d?.(M,{context:O}):m.current&&h?.(M,{context:O,reason:A??wf.CancelledByRelease}),p.current=!1,m.current=!1,w.current!==void 0&&clearTimeout(w.current))},[n,d,h]),N=B.useCallback(O=>M=>{if(Qb(M)&&(u?.(M,{context:O}),i!==!1&&E.current)){const A=HR(M);if(A){const k=i===!0?25:i,D={x:Math.abs(A.x-E.current.x),y:Math.abs(A.y-E.current.y)};(D.x>k||D.y>k)&&C(O)(M,wf.CancelledByMovement)}}},[C,i,u]),j=B.useCallback(O=>{if(t===null)return{};switch(r){case Co.Mouse:{const M={onMouseDown:T(O),onMouseMove:N(O),onMouseUp:C(O)};return a&&(M.onMouseLeave=A=>{C(O)(A,wf.CancelledOutsideElement)}),M}case Co.Touch:return{onTouchStart:T(O),onTouchMove:N(O),onTouchEnd:C(O)};case Co.Pointer:{const M={onPointerDown:T(O),onPointerMove:N(O),onPointerUp:C(O)};return a&&(M.onPointerLeave=A=>C(O)(A,wf.CancelledOutsideElement)),M}}},[t,C,a,r,N,T]);return B.useEffect(()=>{function O(M){const A=VQ(M);C()(A)}return window.addEventListener("mouseup",O),window.addEventListener("touchend",O),window.addEventListener("pointerup",O),()=>{window.removeEventListener("mouseup",O),window.removeEventListener("touchend",O),window.removeEventListener("pointerup",O)}},[C]),B.useEffect(()=>()=>{w.current!==void 0&&clearTimeout(w.current)},[]),B.useEffect(()=>{S.current=t},[t]),j}const PP=()=>{if(/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream){const e=document.getElementById("ios-haptic-trigger");e&&e.click()}else typeof navigator<"u"&&navigator.vibrate&&navigator.vibrate(50)},Jm=t=>t?t instanceof Date?t:typeof t=="string"?new Date(t):typeof t=="number"?new Date(t):t?.toDate&&typeof t.toDate=="function"?t.toDate():new Date:new Date,Ol=t=>Jm(t).toISOString(),zQ=t=>{const e=Jm(t);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`},LQ=t=>{const e=t.toLowerCase();return e==="income"?"Income":e==="expense"?"Expense":e==="transfer"?"Transfer":"Expense"},oS=t=>{const e=t;let n=0;typeof e.amount=="number"?n=e.amount:typeof e.amount=="string"&&(n=parseFloat(e.amount)),isNaN(n)&&(n=0);const r=Ol(e.date);return{id:e.id||"",userId:e.userId||"",envelopeId:e.envelopeId||"",amount:n,date:r,month:e.month||zQ(r),description:e.description||"",merchant:e.merchant||void 0,type:LQ(e.type||"expense"),reconciled:e.reconciled??!1,transferId:e.transferId||void 0,isAutomatic:e.isAutomatic||void 0,paymentMethod:e.paymentMethod?typeof e.paymentMethod=="string"?{id:e.paymentMethod,name:e.paymentMethod,network:"Visa",last4:"****",color:"#000000"}:e.paymentMethod:void 0}};class $l{static instance;static getInstance(){return $l.instance||($l.instance=new $l),$l.instance}async restoreUserData(e,n){try{console.log(" BudgetService.restoreUserData: STARTING RESTORE for user:",e),await this.deleteAllUserData(e);const r=[{name:"envelopes",data:n.envelopes||[]},{name:"transactions",data:n.transactions||[]},{name:"envelopeAllocations",data:n.allocations?Object.values(n.allocations).flat():[]},{name:"monthlyBudgets",data:this.prepareMonthlyBudgetsData(n.allocations,n.incomeSources)},{name:"appSettings",data:n.appSettings?[n.appSettings]:[]}],i=[];for(const{name:o,data:c}of r)if(Array.isArray(c))for(const u of c){if(!u.id&&o!=="monthlyBudgets")continue;const d={...u,userId:e};let h=u.id;o==="monthlyBudgets"&&u.month&&(h=u.month);const p=gt(We,"users",e,o,h);i.push({ref:p,data:d})}console.log(` Prepared ${i.length} items for restoration.`);const a=450;for(let o=0;o<i.length;o+=a){const c=Ox(We);i.slice(o,o+a).forEach(d=>{c.set(d.ref,d.data)}),console.log(` Committing batch ${Math.floor(o/a)+1}/${Math.ceil(i.length/a)}...`),await c.commit()}console.log(" Restore completed successfully.")}catch(r){throw console.error(" BudgetService.restoreUserData failed:",r),new Error(`Failed to restore user data: ${r instanceof Error?r.message:"Unknown error"}`)}}async getEnvelopes(e){try{console.log(" BudgetService.getEnvelopes called for user:",e);const n=vr(We,"users",e,"envelopes"),a=(await qi(n)).docs.map((o,c)=>({id:o.id,...o.data(),orderIndex:o.data().orderIndex??c})).sort((o,c)=>{const u=o.orderIndex??0,d=c.orderIndex??0;return u-d});return console.log(" Fetched envelopes:",a.length),a}catch(n){throw console.error(" BudgetService.getEnvelopes failed:",n),new Error(`Failed to fetch envelopes: ${n instanceof Error?n.message:"Unknown error"}`)}}async getTransactions(e){try{console.log(" BudgetService.getTransactions: Fetching for user",e);const n=vr(We,"users",e,"transactions"),r=Ji(n,Go("date","desc")),a=(await qi(r)).docs.map(o=>{const c={id:o.id,...o.data()};return oS(c)});return console.log(` Fetched ${a.length} transactions`),a}catch(n){throw console.error(" BudgetService.getTransactions failed:",n),new Error(`Failed to fetch transactions: ${n instanceof Error?n.message:"Unknown error"}`)}}async createEnvelope(e){try{console.log(" BudgetService.createEnvelope called for user:",e.userId);const n=vr(We,"users",e.userId,"envelopes"),r=gt(n),i=mt.now(),a={...e,createdAt:i,lastUpdated:i};Jr(r,a).catch(c=>console.error("Create env failed",c));const o={...e,id:r.id,createdAt:Ol(i),lastUpdated:Ol(i)};return console.log(" Created envelope (optimistic):",o.id),o}catch(n){throw console.error(" BudgetService.createEnvelope failed:",n),new Error(`Failed to create envelope: ${n instanceof Error?n.message:"Unknown error"}`)}}async updateEnvelope(e,n){try{console.log(" BudgetService.updateEnvelope called for envelope:",n.id);const r=gt(We,"users",e,"envelopes",n.id);Jr(r,{...n,lastUpdated:mt.now()},{merge:!0}).catch(i=>console.error("Update env failed",i)),console.log(" Updated envelope (optimistic):",n.id)}catch(r){throw console.error(" BudgetService.updateEnvelope failed:",r),new Error(`Failed to update envelope: ${r instanceof Error?r.message:"Unknown error"}`)}}async deleteEnvelope(e,n){try{const r=gt(We,"users",e,"envelopes",n),i=Ji(vr(We,"users",e,"transactions"),S7("envelopeId","==",n)),o=(await qi(i)).docs.map(c=>ei(c.ref));await Promise.all([ei(r),...o]),console.log(" Deleted envelope and associated transactions from Firestore:",n)}catch(r){throw console.error(" BudgetService.deleteEnvelope failed:",r),new Error(`Failed to delete envelope: ${r instanceof Error?r.message:"Unknown error"}`)}}async reorderEnvelopes(e,n){try{console.log(" BudgetService.reorderEnvelopes called for user:",e);const r=n.map(i=>{const a=gt(We,"users",e,"envelopes",i.id);return Jr(a,{orderIndex:i.orderIndex,lastUpdated:mt.now()},{merge:!0})});Promise.all(r).catch(i=>console.error("Reorder env failed",i)),console.log(" Reordered envelopes (optimistic)")}catch(r){throw console.error(" BudgetService.reorderEnvelopes failed:",r),new Error(`Failed to reorder envelopes: ${r instanceof Error?r.message:"Unknown error"}`)}}async createTransaction(e){try{console.log(" BudgetService.createTransaction called for user:",e.userId);const n=vr(We,"users",e.userId,"transactions"),r=gt(n),i=mt.now();if(e.paymentMethod){const u={...e.paymentMethod};u.last4===void 0&&delete u.last4,e.paymentMethod=u}const o={...Object.fromEntries(Object.entries(e).filter(([u,d])=>d!==void 0)),createdAt:i};Jr(r,o).catch(u=>console.error("Create tx failed",u));const c={...e,id:r.id};return console.log(" Created transaction (optimistic):",c.id),c}catch(n){throw console.error(" BudgetService.createTransaction failed:",n),new Error(`Failed to create transaction: ${n instanceof Error?n.message:"Unknown error"}`)}}async updateTransaction(e,n){try{if(console.log(" BudgetService.updateTransaction called for transaction:",n.id),n.paymentMethod){const a={...n.paymentMethod};a.last4===void 0&&delete a.last4,n.paymentMethod=a}const r=Object.fromEntries(Object.entries(n).filter(([a,o])=>o!==void 0)),i=gt(We,"users",e,"transactions",n.id);Jr(i,r,{merge:!0}).catch(a=>console.error("Update tx failed",a)),console.log(" Updated transaction (optimistic):",n.id)}catch(r){throw console.error(" BudgetService.updateTransaction failed:",r),new Error(`Failed to update transaction: ${r instanceof Error?r.message:"Unknown error"}`)}}async deleteTransaction(e,n){try{console.log(" BudgetService.deleteTransaction called for transaction:",n);const r=gt(We,"users",e,"transactions",n);ei(r).catch(i=>console.error("Delete tx failed",i)),console.log(" Deleted transaction (optimistic):",n)}catch(r){throw console.error(" BudgetService.deleteTransaction failed:",r),new Error(`Failed to delete transaction: ${r instanceof Error?r.message:"Unknown error"}`)}}async createIncomeSource(e){try{console.log(" BudgetService.createIncomeSource (Embedded) called for user:",e.userId);const n=gt(We,"users",e.userId,"monthlyBudgets",e.month),r=mt.now(),i=`inc_${r.toMillis()}_${Math.random().toString(36).substring(2,9)}`,a={...e,id:i,amount:Number(e.amount),createdAt:r,updatedAt:r};Aa(n,{incomeSources:C7(a),updatedAt:r}).catch(c=>{c.code==="not-found"?Jr(n,{id:`${e.userId}_${e.month}`,userId:e.userId,month:e.month,createdAt:r,updatedAt:r,incomeSources:[a],allocations:{},totalIncome:0,availableToBudget:0}).catch(u=>console.error("Failed to create monthly budget doc",u)):console.error("Create income failed",c)});const o={...e,id:i,amount:Number(e.amount),createdAt:Ol(r),updatedAt:Ol(r)};return console.log(" Created income source (optimistic/embedded):",o.id),o}catch(n){throw console.error(" BudgetService.createIncomeSource failed:",n),new Error(`Failed to create income source: ${n instanceof Error?n.message:"Unknown error"}`)}}async updateIncomeSource(e,n,r,i){try{console.log(" BudgetService.updateIncomeSource (Embedded) called for source:",n);const a=gt(We,"users",e,"monthlyBudgets",r);em(a).then(o=>{if(!o.exists())return;const d=(o.data().incomeSources||[]).map(h=>{if(h.id===n){const p={...h,...i,updatedAt:mt.now()};return i.amount!==void 0&&(p.amount=Number(i.amount)),p}return h});Aa(a,{incomeSources:d,updatedAt:mt.now()})}).catch(o=>console.error("Update income failed",o)),console.log(" Updated income source (optimistic/embedded):",n)}catch(a){throw console.error(" BudgetService.updateIncomeSource failed:",a),a}}async deleteIncomeSource(e,n,r){try{console.log(" BudgetService.deleteIncomeSource (Embedded) called for source:",n);const i=gt(We,"users",e,"monthlyBudgets",r);em(i).then(a=>{if(!a.exists())return;const u=(a.data().incomeSources||[]).filter(d=>d.id!==n);Aa(i,{incomeSources:u,updatedAt:mt.now()})}).catch(a=>console.error("Delete income failed",a)),console.log(" Deleted income source (optimistic/embedded):",n)}catch(i){throw console.error(" BudgetService.deleteIncomeSource failed:",i),new Error(`Failed to delete income source: ${i instanceof Error?i.message:"Unknown error"}`)}}async createEnvelopeAllocation(e){try{console.log(" BudgetService.createEnvelopeAllocation (Embedded) called for user:",e.userId);const n=gt(We,"users",e.userId,"monthlyBudgets",e.month),r=mt.now(),i={[`allocations.${e.envelopeId}`]:Number(e.budgetedAmount),updatedAt:r};Aa(n,i).catch(o=>{o.code==="not-found"?Jr(n,{id:`${e.userId}_${e.month}`,userId:e.userId,month:e.month,createdAt:r,updatedAt:r,incomeSources:[],allocations:{[e.envelopeId]:Number(e.budgetedAmount)},totalIncome:0,availableToBudget:0}).catch(c=>console.error("Failed to create monthly budget doc",c)):console.error("Create allocation failed",o)});const a={...e,id:e.envelopeId,createdAt:Ol(r),updatedAt:Ol(r)};return console.log(" Created allocation (optimistic/embedded):",a.id),a}catch(n){throw console.error(" BudgetService.createEnvelopeAllocation failed:",n),new Error(`Failed to create envelope allocation: ${n instanceof Error?n.message:"Unknown error"}`)}}async updateEnvelopeAllocation(e,n,r,i){try{console.log(" BudgetService.updateEnvelopeAllocation (Embedded) called for envelope:",n);const a=gt(We,"users",e,"monthlyBudgets",r),o={updatedAt:mt.now()};i.budgetedAmount!==void 0&&(o[`allocations.${n}`]=Number(i.budgetedAmount)),Aa(a,o).catch(c=>console.error("Update allocation failed",c)),console.log(" Updated allocation (optimistic/embedded):",n)}catch(a){throw console.error(" BudgetService.updateEnvelopeAllocation failed:",a),new Error(`Failed to update envelope allocation: ${a instanceof Error?a.message:"Unknown error"}`)}}async deleteEnvelopeAllocation(e,n,r){try{console.log(" BudgetService.deleteEnvelopeAllocation (Embedded) called for envelope:",n);const i=gt(We,"users",e,"monthlyBudgets",r);Aa(i,{[`allocations.${n}`]:V2(),updatedAt:mt.now()}).catch(a=>console.error("Delete allocation failed",a)),console.log(" Deleted allocation (optimistic/embedded):",n)}catch(i){throw console.error(" BudgetService.deleteEnvelopeAllocation failed:",i),new Error(`Failed to delete envelope allocation: ${i instanceof Error?i.message:"Unknown error"}`)}}async getMonthData(e,n){try{console.log(` BudgetService.getMonthData (Embedded): Fetching for user ${e}, month ${n}`);const r=gt(We,"users",e,"monthlyBudgets",n),i=await em(r);if(!i.exists())return console.log(` No budget data found for ${n}, returning empty defaults.`),{incomeSources:[],allocations:[]};const a=i.data(),o=(a.incomeSources||[]).map(d=>({...d,amount:Number(d.amount),createdAt:d.createdAt?.toDate?d.createdAt.toDate().toISOString():d.createdAt||new Date().toISOString(),updatedAt:d.updatedAt?.toDate?d.updatedAt.toDate().toISOString():d.updatedAt||new Date().toISOString()})).sort((d,h)=>new Date(d.createdAt).getTime()-new Date(h.createdAt).getTime()),c=a.allocations||{},u=Object.entries(c).map(([d,h])=>({id:d,userId:e,envelopeId:d,month:n,budgetedAmount:Number(h),createdAt:a.createdAt?.toDate?a.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:a.updatedAt?.toDate?a.updatedAt.toDate().toISOString():new Date().toISOString()})).sort((d,h)=>new Date(d.createdAt).getTime()-new Date(h.createdAt).getTime());return console.log(` Fetched ${o.length} income sources and ${u.length} allocations for ${n}`),{incomeSources:o,allocations:u}}catch(r){throw console.error(" BudgetService.getMonthData failed:",r),new Error(`Failed to fetch month data: ${r instanceof Error?r.message:"Unknown error"}`)}}async cleanupOrphanedData(e){try{console.log(" BudgetService.cleanupOrphanedData: Starting cleanup for user:",e);const n={orphanedAllocationsDeleted:0,orphanedTransactionsDeleted:0,details:{deletedAllocationIds:[],deletedTransactionIds:[],monthsProcessed:[]}},r=await this.getEnvelopes(e),i=new Set(r.map(b=>b.id));console.log(` Found ${r.length} existing envelopes`);const a=vr(We,"users",e,"envelopeAllocations"),o=await qi(a),c=[],u=new Set;for(const b of o.docs){const w=b.data();u.add(w.month),i.has(w.envelopeId)||(c.push(b.id),console.log(` Found orphaned allocation: ${b.id} for envelope ${w.envelopeId} in month ${w.month}`))}if(c.length>0){const b=c.map(w=>ei(gt(We,"users",e,"envelopeAllocations",w)));await Promise.all(b),n.orphanedAllocationsDeleted+=c.length,n.details.deletedAllocationIds.push(...c),console.log(` Deleted ${c.length} orphaned allocations (legacy)`)}const d=vr(We,"users",e,"monthlyBudgets"),h=await qi(d);for(const b of h.docs){const S=b.data().allocations||{},E={};let T=!1;Object.keys(S).forEach(C=>{i.has(C)||(E[`allocations.${C}`]=V2(),T=!0,console.log(` Found orphaned embedded allocation in ${b.id} for envelope ${C}`),n.orphanedAllocationsDeleted++,n.details.deletedAllocationIds.push(`${b.id}_${C}`))}),T&&(E.updatedAt=mt.now(),await Aa(b.ref,E),u.add(b.id))}const p=await this.getTransactions(e),m=[];for(const b of p)i.has(b.envelopeId)||(m.push(b.id),console.log(` Found orphaned transaction: ${b.id} for envelope ${b.envelopeId}`));if(m.length>0){const b=m.map(w=>ei(gt(We,"users",e,"transactions",w)));await Promise.all(b),n.orphanedTransactionsDeleted=m.length,n.details.deletedTransactionIds=m,console.log(` Deleted ${m.length} orphaned transactions`)}return n.details.monthsProcessed=Array.from(u),console.log(" Cleanup completed:",{orphanedAllocationsDeleted:n.orphanedAllocationsDeleted,orphanedTransactionsDeleted:n.orphanedTransactionsDeleted,monthsProcessed:n.details.monthsProcessed.length}),n}catch(n){throw console.error(" BudgetService.cleanupOrphanedData failed:",n),new Error(`Failed to cleanup orphaned data: ${n instanceof Error?n.message:"Unknown error"}`)}}subscribeToMonthlyBudget(e,n,r){const i=gt(We,"users",e,"monthlyBudgets",n);return Ku(i,a=>{if(!a.exists()){r({incomeSources:[],allocations:[]});return}const o=a.data(),c=(o.incomeSources||[]).map(h=>({...h,amount:Number(h.amount),createdAt:h.createdAt?.toDate?h.createdAt.toDate().toISOString():h.createdAt||new Date().toISOString(),updatedAt:h.updatedAt?.toDate?h.updatedAt.toDate().toISOString():h.updatedAt||new Date().toISOString()})).sort((h,p)=>new Date(h.createdAt).getTime()-new Date(p.createdAt).getTime()),u=o.allocations||{},d=Object.entries(u).map(([h,p])=>({id:h,userId:e,envelopeId:h,month:n,budgetedAmount:Number(p),createdAt:o.createdAt?.toDate?o.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:o.updatedAt?.toDate?o.updatedAt.toDate().toISOString():new Date().toISOString()})).sort((h,p)=>new Date(h.createdAt).getTime()-new Date(p.createdAt).getTime());r({incomeSources:c,allocations:d})})}prepareMonthlyBudgetsData(e,n){const r=[],i=new Set;return e&&Object.keys(e).forEach(a=>i.add(a)),n&&Object.keys(n).forEach(a=>i.add(a)),i.forEach(a=>{const o=e?.[a]||[],c=n?.[a]||[],u={};o.forEach(h=>{u[h.envelopeId]=h.budgetedAmount});const d={month:a,userId:"",incomeSources:c,allocations:u,totalIncome:c.reduce((h,p)=>h+Number(p.amount||0),0),availableToBudget:c.reduce((h,p)=>h+Number(p.amount||0),0)-o.reduce((h,p)=>h+Number(p.budgetedAmount||0),0),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};r.push(d)}),r}async deleteAllUserData(e){try{console.log(" BudgetService.deleteAllUserData: STARTING DELETION for user:",e);const n=["envelopes","transactions","incomeSources","envelopeAllocations","monthlyBudgets","appSettings"];for(const r of n){console.log(` Deleting collection: ${r}...`);const i=vr(We,"users",e,r),a=await qi(i);if(a.empty){console.log("   (Empty collection)");continue}const o=a.docs.map(c=>ei(c.ref));await Promise.all(o),console.log(`    Deleted ${a.size} documents from ${r}`)}console.log(" All user data deleted successfully.")}catch(n){throw console.error(" BudgetService.deleteAllUserData failed:",n),new Error(`Failed to delete all user data: ${n instanceof Error?n.message:"Unknown error"}`)}}}const lS=$l.getInstance();class ko{static instance;constructor(){}static getInstance(){return ko.instance||(ko.instance=new ko),ko.instance}createId(){return gt(vr(We,"temp")).id}async createCategory(e){const n=gt(We,`users/${e.userId}/categories`,e.id);return await Jr(n,e),e}async getCategories(e){const n=Ji(vr(We,`users/${e}/categories`),Go("orderIndex","asc"));return(await qi(n)).docs.map(i=>i.data())}async updateCategory(e,n){const r=gt(We,`users/${e}/categories`,n.id);await Jr(r,n,{merge:!0})}async deleteCategory(e,n){const r=gt(We,`users/${e}/categories`,n);await ei(r)}async reorderCategories(e,n){const r=Ox(We);n.forEach((i,a)=>{const o=gt(We,`users/${e}/categories`,i.id);r.update(o,{orderIndex:a})}),await r.commit()}async deduplicateCategories(e){const n=await this.getCategories(e),r=new Map,i=[];for(const o of n){const c=o.name.toLowerCase().trim();r.has(c)?i.push(o.id):r.set(c,o)}if(i.length===0)return console.log(" No duplicate categories found"),0;console.log(` Found ${i.length} duplicate categories to remove`);const a=450;for(let o=0;o<i.length;o+=a){const c=Ox(We);i.slice(o,o+a).forEach(d=>{const h=gt(We,`users/${e}/categories`,d);c.delete(h)}),await c.commit(),console.log(` Deleted batch ${Math.floor(o/a)+1}`)}return console.log(` Removed ${i.length} duplicate categories`),i.length}subscribeToCategories(e,n){const r=Ji(vr(We,`users/${e}/categories`),Go("orderIndex","asc"));return Ku(r,i=>{const a=i.docs.map(o=>o.data());n(a)},i=>{console.error(" Category subscription error:",i)})}}ko.getInstance();const Zb=t=>vr(We,"users",t,"transactions"),BQ={subscribeToTransactions:(t,e)=>{const n=Ji(Zb(t),Go("date","desc"));return Ku(n,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllTransactions:async t=>{console.log(` TransactionService.getAllTransactions: Fetching for user ${t}`);const e=Ji(Zb(t),Go("date","desc")),r=(await qi(e)).docs.map(i=>{const a={id:i.id,...i.data()};return oS(a)});return console.log(` Fetched ${r.length} transactions:`,r.map(i=>({id:i.id,description:i.description,month:i.month}))),r},addTransaction:async t=>{const{userId:e,id:n,...r}=t;if(!e)throw new Error("User ID is required to create transaction");console.log(` TransactionService.addTransaction: Adding transaction for user ${e}:`,r),console.log(` Original transaction had temp ID: ${n}`);try{console.log(" About to call addDoc with:",r);const i=await M0(Zb(e),r);console.log(" addDoc succeeded, docRef:",i),console.log(` Document ID: ${i.id}`),console.log(` Document path: ${i.path}`);const a={id:i.id,...r,userId:e};return console.log(" Final result object:",a),a}catch(i){throw console.error(" addDoc failed:",i),console.error("Error message:",i.message),i}},updateTransaction:async(t,e,n)=>{const r=gt(We,"users",t,"transactions",e);return await Aa(r,n)},deleteTransaction:async(t,e)=>{console.log(` TransactionService.deleteTransaction: Deleting transaction ${e} for user ${t}`);try{const n=gt(We,"users",t,"transactions",e);console.log(` Deleting document at path: ${n.path}`),await ei(n),console.log(` TransactionService.deleteTransaction: Successfully deleted transaction ${e}`)}catch(n){throw console.error(` TransactionService.deleteTransaction: Failed to delete transaction ${e}:`,n),console.error("Error message:",n.message),n}}},Jb=t=>vr(We,"users",t,"envelopes"),UQ={subscribeToEnvelopes:(t,e)=>{const n=Ji(Jb(t),Go("orderIndex","asc"));return Ku(n,i=>{const a=i.docs.map(o=>{const c=o.data();return{id:o.id,...c,createdAt:c.createdAt?.toDate?.()?c.createdAt.toDate().toISOString():c.createdAt,lastUpdated:c.lastUpdated?.toDate?.()?c.lastUpdated.toDate().toISOString():c.lastUpdated}});e(a)})},getAllEnvelopes:async t=>{try{console.log(" EnvelopeService.getAllEnvelopes called for user:",t);const e=Jb(t),i=(await qi(e)).docs.map((a,o)=>{const c=a.data();return{id:a.id,...c,createdAt:c.createdAt?.toDate?.()?c.createdAt.toDate().toISOString():c.createdAt,lastUpdated:c.lastUpdated?.toDate?.()?c.lastUpdated.toDate().toISOString():c.lastUpdated,orderIndex:c.orderIndex??o}}).sort((a,o)=>{const c=a.orderIndex??0,u=o.orderIndex??0;return c-u});return console.log(" Fetched envelopes:",i.length),i}catch(e){return console.error(" EnvelopeService.getAllEnvelopes failed:",e),[]}},createEnvelope:async t=>{const{userId:e,id:n,...r}=t;if(!e)throw new Error("User ID is required to create envelope");try{return{id:(await M0(Jb(e),r)).id,...r,userId:e}}catch(i){throw console.error(" Envelope addDoc failed:",i),i}},saveEnvelope:async(t,e)=>{if(!e.id)throw new Error("Envelope ID is required for save operation");const n=gt(We,"users",t,"envelopes",e.id);return await Jr(n,e,{merge:!0})},updateBalance:async(t,e,n)=>{const r=gt(We,"users",t,"envelopes",e);return await Aa(r,{currentBalance:n,lastUpdated:new Date().toISOString()})},deleteEnvelope:async(t,e)=>{console.log(` EnvelopeService.deleteEnvelope: Deleting envelope ${e} for user ${t}`);const n=gt(We,"users",t,"envelopes",e);await ei(n),console.log(` EnvelopeService.deleteEnvelope: Successfully deleted envelope ${e}`)}},ex=t=>vr(We,"users",t,"distributionTemplates"),FQ={subscribeToDistributionTemplates:(t,e)=>{const n=Ji(ex(t),Go("lastUsed","desc"));return Ku(n,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllDistributionTemplates:async t=>{const e=Ji(ex(t),Go("lastUsed","desc"));return(await qi(e)).docs.map(r=>({id:r.id,...r.data()}))},createDistributionTemplate:async t=>{const{userId:e,id:n,...r}=t;if(!e)throw new Error("User ID is required to create distribution template");console.log(` DistributionTemplateService.createDistributionTemplate: Adding template for user ${e}:`,r);try{const i=await M0(ex(e),r);console.log(" Template addDoc succeeded, docRef:",i);const a={id:i.id,...r,userId:e};return console.log(" Final template result object:",a),a}catch(i){throw console.error(" Template addDoc failed:",i),i}},saveDistributionTemplate:async(t,e)=>{const n=gt(We,"users",t,"distributionTemplates",e.id);return await Jr(n,e,{merge:!0})},updateDistributionTemplate:async(t,e,n)=>{const r=gt(We,"users",t,"distributionTemplates",e);return await Aa(r,n)},deleteDistributionTemplate:async(t,e)=>{console.log(` DistributionTemplateService.deleteDistributionTemplate: Deleting template ${e} for user ${t}`);const n=gt(We,"users",t,"distributionTemplates",e);await ei(n),console.log(` DistributionTemplateService.deleteDistributionTemplate: Successfully deleted template ${e}`)}},tx=t=>vr(We,"users",t,"appSettings"),jP={subscribeToAppSettings:(t,e)=>{const n=Ji(tx(t),O2(1));return Ku(n,i=>{if(i.empty){e(null);return}const a=i.docs.map(o=>({id:o.id,...o.data()}))[0];e(a)})},getAppSettings:async t=>{const e=Ji(tx(t),O2(1)),n=await qi(e);if(n.empty)return null;const r=n.docs[0];return{id:r.id,...r.data()}},createAppSettings:async t=>{const{userId:e,...n}=t;if(!e)throw new Error("User ID is required to create app settings");console.log(` AppSettingsService.createAppSettings: Creating settings for user ${e}:`,n);try{const r=await M0(tx(e),n);console.log(" Settings addDoc succeeded, docRef:",r);const i={id:r.id,...n,userId:e};return console.log(" Final settings result object:",i),i}catch(r){throw console.error(" Settings addDoc failed:",r),r}},saveAppSettings:async(t,e)=>{const n=gt(We,"users",t,"appSettings",e.id);return await Jr(n,e,{merge:!0})},updateAppSettings:async(t,e,n)=>{const r=gt(We,"users",t,"appSettings",e);return await Jr(r,n,{merge:!0})},deleteAppSettings:async(t,e)=>{console.log(` AppSettingsService.deleteAppSettings: Deleting settings ${e} for user ${t}`);const n=gt(We,"users",t,"appSettings",e);await ei(n),console.log(` AppSettingsService.deleteAppSettings: Successfully deleted settings ${e}`)}},qR=Object.freeze(Object.defineProperty({__proto__:null,AppSettingsService:jP},Symbol.toStringTag,{value:"Module"})),$Q=t=>oS(t),GQ=t=>({id:t.id,name:t.name||"",currentBalance:t.currentBalance||0,lastUpdated:t.lastUpdated?.toDate?.()?t.lastUpdated.toDate().toISOString():t.lastUpdated,isActive:t.isActive??!0,orderIndex:t.orderIndex??0,userId:t.userId||void 0,createdAt:t.createdAt?.toDate?.()?t.createdAt.toDate().toISOString():t.createdAt,isPiggybank:t.isPiggybank,piggybankConfig:t.piggybankConfig,categoryId:t.categoryId}),HQ=t=>({id:t.id,userId:t.userId,name:t.name,orderIndex:t.orderIndex,isArchived:t.isArchived,createdAt:t.createdAt?.toDate?.()?t.createdAt.toDate().toISOString():t.createdAt,updatedAt:t.updatedAt?.toDate?.()?t.updatedAt.toDate().toISOString():t.updatedAt}),YR=(t,e)=>{if(window.__firebaseUnsubscribers){console.log(" Real-time subscriptions already active, skipping setup");return}console.log(" Setting up real-time Firebase subscriptions...");const n=t.getState().currentMonth;console.log(" Current month for subscriptions:",n);const r=UQ.subscribeToEnvelopes(e,h=>{console.log(" Real-time sync: Envelopes updated",h.length);const p=h.map(GQ),m=t.getState(),b=new Set(m.envelopes.map(E=>E.id)),w=new Set(p.map(E=>E.id)),S=[...p.filter(E=>b.has(E.id)),...m.envelopes.filter(E=>!w.has(E.id))];t.setState({envelopes:S})}),i=BQ.subscribeToTransactions(e,h=>{console.log(" Real-time sync: Transactions updated",h.length);const p=h.map($Q),m=t.getState(),b=new Set(m.transactions.map(E=>`${E.id}-${E.month}`)),w=new Set(p.map(E=>`${E.id}-${E.month}`)),S=[...p.filter(E=>b.has(`${E.id}-${E.month}`)),...m.transactions.filter(E=>!w.has(`${E.id}-${E.month}`))];t.setState({transactions:S})}),o=ko.getInstance().subscribeToCategories(e,h=>{console.log(" Real-time sync: Categories updated",h.length);const p=h.map(HQ),m=Array.from(new Map(p.map(b=>[b.id,b])).values());m.length!==p.length&&console.warn(" Duplicate categories detected in real-time update, deduplicating..."),t.setState({categories:m})}),c=FQ.subscribeToDistributionTemplates(e,h=>{console.log(" Real-time sync: Templates updated from Firebase",h.length)}),u=jP.subscribeToAppSettings(e,h=>{console.log(" Real-time sync: Settings updated",h?"found":"null");const p=t.getState();if(h){const m={...p.appSettings,...h,paymentSources:h.paymentSources??p.appSettings?.paymentSources??[]};t.setState({appSettings:m})}else console.log(" Firebase settings null, preserving local state")}),d=lS.subscribeToMonthlyBudget(e,n,h=>{console.log(` Real-time sync: Monthly budget updated (${h.incomeSources.length} sources, ${h.allocations.length} allocations)`);const p=t.getState();t.setState({incomeSources:{...p.incomeSources,[n]:h.incomeSources},allocations:{...p.allocations,[n]:h.allocations}})});window.__firebaseUnsubscribers={envelopes:r,transactions:i,categories:o,templates:c,settings:u,monthlyBudget:d},console.log(" Real-time subscriptions active - cross-device sync enabled")},qQ=t=>{const{useBudgetStore:e,useAuthStore:n,getCurrentUserId:r}=t;if(typeof window>"u")return;window.addEventListener("online",async()=>{console.log(" Browser online event detected"),e.setState({isOnline:!0})}),window.addEventListener("offline",()=>{console.log(" Browser offline event detected"),e.setState({isOnline:!1})}),e.setState({isOnline:navigator.onLine});const i=n.getState();i.isAuthenticated&&i.currentUser&&(console.log(" User already authenticated on app load, setting up real-time subscriptions"),YR(e,r())),n.subscribe(o=>{if(o.isAuthenticated&&o.currentUser)console.log(" User authenticated, setting up real-time subscriptions"),YR(e,r());else if(!o.isAuthenticated&&!o.isLoading){if(console.log(" User logged out, clearing data and unsubscribing"),window.__firebaseUnsubscribers){const c=window.__firebaseUnsubscribers;c.envelopes&&c.envelopes(),c.transactions&&c.transactions(),c.categories&&c.categories(),c.templates&&c.templates(),c.settings&&c.settings(),c.monthlyBudget&&c.monthlyBudget(),delete window.__firebaseUnsubscribers,console.log(" Cleaned up Firebase subscriptions")}e.getState().handleUserLogout()}});let a=e.getState().currentMonth;e.subscribe(o=>{if(o.currentMonth!==a&&o.isAuthenticated){console.log(" Month changed from",a,"to",o.currentMonth),a=o.currentMonth;const c=r();if(c&&window.__firebaseUnsubscribers){const u=window.__firebaseUnsubscribers;u.monthlyBudget&&u.monthlyBudget(),console.log(" Unsubscribed from old month data"),u.monthlyBudget=lS.subscribeToMonthlyBudget(c,o.currentMonth,d=>{console.log(" Real-time sync: Monthly budget updated for new month");const h=e.getState();e.setState({incomeSources:{...h.incomeSources,[o.currentMonth]:d.incomeSources},allocations:{...h.allocations,[o.currentMonth]:d.allocations}})}),console.log(" Subscribed to monthly data for new month:",o.currentMonth)}}})},om=()=>Ai.getState().currentUser?.id||"",fn=$l.getInstance(),fs=ko.getInstance(),Xt=tw()(fU(wD((t,e)=>({envelopes:[],transactions:[],categories:[],appSettings:null,incomeSources:{},allocations:{},currentMonth:new Date().toISOString().slice(0,7),isOnline:typeof navigator<"u"?navigator.onLine:!0,isOnboardingActive:!1,isOnboardingCompleted:!1,isLoading:!1,error:null,setIsOnboardingActive:n=>{t({isOnboardingActive:n})},checkAndStartOnboarding:async()=>{const n=om();if(!n){console.log(" No user ID, skipping onboarding check");return}const r=`onboardingCompleted_${n}`,i=typeof localStorage<"u"?localStorage.getItem(r)==="true":!1;if(console.log(" checkAndStartOnboarding called:",{userId:n,isOnboardingCompleted:i,isOnboardingActive:e().isOnboardingActive,localStorage_key:r,localStorage_value:localStorage.getItem(r)}),i){t({isOnboardingCompleted:!0}),console.log(" Skipping onboarding: already completed (localStorage)");return}try{if((await fn.getEnvelopes(n)).length>0){console.log(" Existing user detected on new device  skipping onboarding, setting localStorage"),localStorage.setItem(r,"true"),t({isOnboardingCompleted:!0,isOnboardingActive:!1});return}}catch(a){console.error(" Failed to check existing envelopes for onboarding:",a),t({isOnboardingCompleted:!0,isOnboardingActive:!1});return}e().isOnboardingActive||(console.log(" Starting onboarding for new user - setting isOnboardingActive to TRUE"),t({isOnboardingCompleted:!1,isOnboardingActive:!0}),console.log(" isOnboardingActive set to:",e().isOnboardingActive))},completeOnboarding:()=>{const n=om();if(n){const r=`onboardingCompleted_${n}`;localStorage.setItem(r,"true"),console.log(" Onboarding completed for user:",n)}t({isOnboardingCompleted:!0,isOnboardingActive:!1})},resetOnboarding:()=>{const n=om();if(n){const r=`onboardingCompleted_${n}`;localStorage.removeItem(r),console.log(" Onboarding reset for user:",n)}t({isOnboardingCompleted:!1,isOnboardingActive:!0})},clearMonthData:async n=>{try{t({isLoading:!0,error:null}),console.log(` Clearing all data for month: ${n}`);const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const{monthlyBudgetService:a}=await Tt(async()=>{const{monthlyBudgetService:o}=await import("./MonthlyBudgetService-DBstpJHG.js");return{monthlyBudgetService:o}},[]);await a.clearMonthData(i.id,n),await e().init(),console.log(` Cleared month data for ${n}`),t({isLoading:!1})}catch(r){throw console.error(" clearMonthData failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to clear month data"}),r}},fetchMonthData:async n=>{try{const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i){console.log("No user logged in, skipping month data fetch");return}console.log(`Fetching month data for: ${n}`);const a=await fn.getMonthData(i.id,n),o=e();t({incomeSources:{...o.incomeSources,[n]:a.incomeSources},allocations:{...o.allocations,[n]:a.allocations}}),console.log(` Fetched month data for ${n}`),(async()=>{const u=e(),d=u.allocations[n]||[],h=u.transactions.filter(m=>m.month===n);let p=0;for(const m of d){const b=u.envelopes.find(S=>S.id===m.envelopeId);if(b?.isPiggybank)continue;const w=h.find(S=>S.envelopeId===m.envelopeId&&(S.description==="Monthly Budget Allocation"||S.description==="Monthly Allocation"||S.description==="Budgeted"||S.description==="Piggybank Contribution"));w?w.amount!==m.budgetedAmount&&(console.log(` Repairing mismatch for envelope ${b?.name||m.envelopeId}: Alloc ${m.budgetedAmount} vs Tx ${w.amount}`),await u.updateTransaction({...w,amount:m.budgetedAmount}),p++):m.budgetedAmount>0&&(console.log(` Repairing missing transaction for envelope ${b?.name||m.envelopeId}`),await u.addTransaction({description:"Budgeted",amount:m.budgetedAmount,envelopeId:m.envelopeId,type:"Income",month:n,date:`${n}-01T00:00:00`,reconciled:!1,isAutomatic:!0}),p++)}p>0&&console.log(` Repaired ${p} allocation discrepancies for ${n}`)})().catch(u=>console.error("Verification failed:",u))}catch(r){console.error(` Failed to fetch month data for ${n}:`,r)}},removeEnvelopeFromMonth:async(n,r)=>{try{t({isLoading:!0,error:null}),console.log(` Removing envelope ${n} from month ${r}`);const i=e(),a=i.allocations[r]?.find(c=>c.envelopeId===n);a?await e().deleteEnvelopeAllocation(a.id):console.log(` No allocation found for envelope ${n} in ${r}`);const o=i.transactions.filter(c=>c.envelopeId===n&&(c.month===r||c.date.startsWith(r)));o.length>0&&(console.log(` Deleting ${o.length} transactions for envelope ${n} in ${r}`),await Promise.all(o.map(c=>e().deleteTransaction(c.id)))),t({isLoading:!1}),console.log(` Removed envelope ${n} from month ${r}`)}catch(i){throw console.error(" removeEnvelopeFromMonth failed:",i),t({isLoading:!1,error:i instanceof Error?i.message:"Failed to remove envelope from month"}),i}},setMonth:async n=>{t({currentMonth:n});const r=e();(r.incomeSources[n]===void 0||r.allocations[n]===void 0)&&(console.log(`Month ${n} data missing in store, fetching...`),t({isLoading:!0}),await e().fetchMonthData(n),t({isLoading:!1}))},init:async()=>{console.log("BudgetStore initializing...");const n=e();try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(m=>m.useAuthStore.getState())).currentUser;if(!i){console.log("No user logged in, skipping data fetch"),t({isLoading:!1});return}console.log(`Fetching data for user: ${i.id}, month: ${n.currentMonth}`);const[a,o,c,u]=await Promise.all([fn.getEnvelopes(i.id),fn.getTransactions(i.id),fs.getCategories(i.id).catch(m=>(console.error(" Failed to load categories:",m),[])),fn.getMonthData(i.id,n.currentMonth)]);let d=Array.from(new Map(c.map(m=>[m.id,m])).values());const h=new Set;let p=!1;for(const m of d){const b=m.name.toLowerCase().trim();if(h.has(b)){p=!0;break}h.add(b)}p&&i&&(console.log(" Duplicate category names detected, running Firestore cleanup..."),await fs.deduplicateCategories(i.id)>0&&(d=await fs.getCategories(i.id))),t({envelopes:a,transactions:o,categories:d,incomeSources:{...n.incomeSources,[n.currentMonth]:u.incomeSources},allocations:{...n.allocations,[n.currentMonth]:u.allocations},isLoading:!1,error:null}),console.log(` BudgetStore initialized: ${a.length} envelopes, ${o.length} transactions, ${c.length} categories, ${u.incomeSources.length} income sources, ${u.allocations.length} allocations`)}catch(r){console.error(" BudgetStore initialization failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to initialize budget data"})}},fetchCategories:async()=>{try{t({isLoading:!0,error:null});const r=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!r)return;const i=await fs.getCategories(r.id),a=Array.from(new Map(i.map(o=>[o.id,o])).values());t({categories:a,isLoading:!1})}catch(n){console.error("Failed to fetch categories:",n),t({isLoading:!1})}},addCategory:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i)throw new Error("No user logged in");const a=e().categories.find(u=>u.name.toLowerCase().trim()===(n.name||"").toLowerCase().trim());if(a)return console.log(` Category "${n.name}" already exists, skipping creation`),t({isLoading:!1}),a.id;const o=fs.createId(),c={...n,id:o,userId:i.id,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),orderIndex:e().categories.length};return await fs.createCategory(c),t(u=>u.categories.some(h=>h.id===o)?{isLoading:!1}:{categories:[...u.categories,c],isLoading:!1}),o}catch(r){throw console.error("Failed to add category:",r),t({isLoading:!1}),r}},updateCategory:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!i)throw new Error("No user logged in");const a={...n,updatedAt:new Date().toISOString()};await fs.updateCategory(i.id,a),t(o=>({categories:o.categories.map(c=>c.id===n.id?a:c),isLoading:!1}))}catch(r){throw console.error("Failed to update category:",r),t({isLoading:!1}),r}},deleteCategory:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No user logged in");await fs.deleteCategory(i.id,n),t(a=>({categories:a.categories.filter(o=>o.id!==n),isLoading:!1}))}catch(r){throw console.error("Failed to delete category:",r),t({isLoading:!1}),r}},reorderCategories:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i)throw new Error("No user logged in");const a=e(),o=new Map;n.forEach((u,d)=>o.set(u,d));const c=a.categories.map(u=>{if(!o.has(u.id))return u;const d=o.get(u.id);return u.orderIndex===d?u:{...u,orderIndex:d}});t({categories:c.sort((u,d)=>u.orderIndex-d.orderIndex)}),await fs.reorderCategories(i.id,c),t({isLoading:!1})}catch(r){throw console.error("Failed to reorder categories:",r),t({isLoading:!1}),r}},addEnvelope:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a={...n,userId:i.id},o=await fn.createEnvelope(a);return t(c=>c.envelopes.some(d=>d.id===o.id)?{isLoading:!1}:{envelopes:[...c.envelopes,o],isLoading:!1}),console.log(" Added envelope:",o.id),o.id}catch(r){throw console.error(" addEnvelope failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to add envelope"}),r}},updateEnvelope:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await fn.updateEnvelope(i.id,n),t(a=>({envelopes:a.envelopes.map(o=>o.id===n.id?n:o),isLoading:!1})),console.log(" Updated envelope:",n.id)}catch(r){throw console.error(" updateEnvelope failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to update envelope"}),r}},deleteEnvelope:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await fn.deleteEnvelope(i.id,n),t(a=>({envelopes:a.envelopes.filter(o=>o.id!==n),transactions:a.transactions.filter(o=>o.envelopeId!==n),isLoading:!1})),console.log(" Deleted envelope:",n)}catch(r){throw console.error(" deleteEnvelope failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete envelope"}),r}},reorderEnvelopes:async n=>{try{t({isLoading:!0,error:null});const r=e(),i=new Map;n.forEach((d,h)=>{i.set(d,h)});const a=r.envelopes.map(d=>{if(!i.has(d.id))return d;const h=i.get(d.id);return d.orderIndex===h?d:{...d,orderIndex:h}}),o=a.filter((d,h)=>d!==r.envelopes[h]);if(!o.length){t({isLoading:!1});return}const u=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!u)throw new Error("No authenticated user found");await fn.reorderEnvelopes(u.id,o),t({envelopes:a,isLoading:!1}),console.log(" Reordered envelopes")}catch(r){throw console.error(" reorderEnvelopes failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to reorder envelopes"}),r}},addTransaction:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=new Date(n.date),o=n.month||`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,c={...n,userId:i.id,month:o},u=await fn.createTransaction(c);t(d=>d.transactions.some(p=>p.id===u.id)?{isLoading:!1}:{transactions:[...d.transactions,u],isLoading:!1}),console.log(" Added transaction:",u.id)}catch(r){throw console.error(" addTransaction failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to add transaction"}),r}},updateTransaction:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=new Date(n.date),o=n.month||`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,c={...n,month:o};await fn.updateTransaction(i.id,c),t(u=>({transactions:u.transactions.map(d=>d.id===n.id?c:d),isLoading:!1})),console.log(" Updated transaction:",n.id)}catch(r){throw console.error(" updateTransaction failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to update transaction"}),r}},deleteTransaction:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await fn.deleteTransaction(i.id,n),t(a=>({transactions:a.transactions.filter(o=>o.id!==n),isLoading:!1})),console.log(" Deleted transaction:",n)}catch(r){throw console.error(" deleteTransaction failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete transaction"}),r}},restoreTransaction:async n=>{await e().updateTransaction(n)},transferFunds:async(n,r,i,a,o)=>{try{const c=o?typeof o=="string"?o:o.toISOString():new Date().toISOString(),u=`transfer-${Date.now()}-${Math.random()}`;await e().addTransaction({description:`Transfer to ${e().envelopes.find(d=>d.id===r)?.name||"envelope"}`,amount:i,envelopeId:n,date:c,type:"Expense",transferId:u,reconciled:!1}),await e().addTransaction({description:`Transfer from ${e().envelopes.find(d=>d.id===n)?.name||"envelope"}`,amount:i,envelopeId:r,date:c,type:"Income",transferId:u,reconciled:!1}),console.log(" Transfer completed")}catch(c){throw console.error(" transferFunds failed:",c),c}},fetchData:async()=>{await e().init()},renameEnvelope:async(n,r)=>{try{t({isLoading:!0,error:null});const a=e().envelopes.find(d=>d.id===n);if(!a)throw new Error("Envelope not found");t(d=>({envelopes:d.envelopes.map(h=>h.id===n?{...h,name:r}:h),isLoading:!0}));const c=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!c)throw new Error("No authenticated user found");const u={...a,name:r};await fn.updateEnvelope(c.id,u),t({isLoading:!1}),console.log(" Renamed envelope:",n)}catch(i){throw console.error(" renameEnvelope failed:",i),t({isLoading:!1,error:i instanceof Error?i.message:"Failed to rename envelope"}),i}},getEnvelopeBalance:(n,r)=>{const i=e(),a=i.envelopes.find(o=>o.id===n);if(!a)return console.log(` getEnvelopeBalance: Envelope ${n} not found`),0;if(a.isPiggybank){const o=i.transactions.filter(p=>p.envelopeId===n),c=o.filter(p=>p.type==="Expense"),u=o.filter(p=>p.type==="Income"),d=c.reduce((p,m)=>p+(m.amount||0),0);return u.reduce((p,m)=>p+(m.amount||0),0)-d}if(r){const o=i.transactions.filter(p=>p.envelopeId===n&&p.month===r),c=o.filter(p=>p.type==="Expense"),u=o.filter(p=>p.type==="Income"),d=c.reduce((p,m)=>p+(m.amount||0),0);return u.reduce((p,m)=>p+(m.amount||0),0)-d}return console.warn(` getEnvelopeBalance: Month not provided for non-piggybank envelope ${n}. Returning 0.`),0},resetData:async()=>{console.log(" Resetting all data"),t({isLoading:!0});try{const r=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(i=>i.useAuthStore.getState())).currentUser;r?(console.log(" Deleting all data from Firestore for user:",r.id),await fn.deleteAllUserData(r.id)):console.warn(" No user logged in, only clearing local state"),t({envelopes:[],transactions:[],appSettings:null,incomeSources:{},allocations:{},isLoading:!1,error:null}),console.log(" Reset data complete")}catch(n){throw console.error(" resetData failed:",n),t({isLoading:!1,error:n instanceof Error?n.message:"Failed to reset data"}),n}},importData:async n=>{try{if(t({isLoading:!0,error:null}),!n||typeof n!="object")throw new Error("Invalid data format");const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("You must be logged in to restore data.");return console.log(" Starting Time Machine Restore for user:",i.id),await fn.restoreUserData(i.id,n),console.log(" Reloading app state from cloud..."),await e().init(),t({isLoading:!1}),{success:!0,message:"Data restored successfully from backup."}}catch(r){return console.error(" importData failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to import data"}),{success:!1,message:r instanceof Error?r.message:"Import failed"}}},updateAppSettings:async n=>{try{t({isLoading:!0,error:null});const r=e(),i={id:r.appSettings?.id||"default",theme:n.theme??r.appSettings?.theme??"system",fontSize:n.fontSize??r.appSettings?.fontSize??"medium",enableMoveableReorder:n.enableMoveableReorder??r.appSettings?.enableMoveableReorder??!0,paymentSources:n.paymentSources??r.appSettings?.paymentSources??[],siriToken:n.siriToken??r.appSettings?.siriToken};(n.userId||r.appSettings?.userId)&&(i.userId=n.userId??r.appSettings?.userId),i.paymentSources&&(i.paymentSources=i.paymentSources.map(c=>{const u={...c};return u.last4===void 0&&delete u.last4,u}));const o=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(o){const{AppSettingsService:c}=await Tt(async()=>{const{AppSettingsService:u}=await Promise.resolve().then(()=>qR);return{AppSettingsService:u}},void 0);await c.updateAppSettings(o.id,i.id,i)}t({appSettings:i,isLoading:!1}),console.log(" Updated app settings")}catch(r){throw console.error(" updateAppSettings failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to update settings"}),r}},initializeAppSettings:async()=>{try{if(e().appSettings)return;const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(i){const{AppSettingsService:o}=await Tt(async()=>{const{AppSettingsService:u}=await Promise.resolve().then(()=>qR);return{AppSettingsService:u}},void 0),c=await o.getAppSettings(i.id);if(c){t({appSettings:c}),console.log(" Loaded app settings from Firestore");return}}const a={id:"default",theme:"system",fontSize:"medium",enableMoveableReorder:!0,paymentSources:[]};i&&(a.userId=i.id),t({appSettings:a}),console.log(" Initialized default app settings")}catch(n){console.error(" initializeAppSettings failed:",n),t({error:n instanceof Error?n.message:"Failed to initialize settings"})}},updatePiggybankContribution:async(n,r)=>{try{t({isLoading:!0,error:null}),console.log(" Updating piggybank contribution:",{envelopeId:n,newAmount:r});const a=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");const o=e().envelopes.find(u=>u.id===n&&u.isPiggybank);if(!o)throw new Error("Piggybank not found");const c={...o,lastUpdated:new Date().toISOString(),piggybankConfig:{monthlyContribution:r,targetAmount:o.piggybankConfig?.targetAmount,color:o.piggybankConfig?.color,icon:o.piggybankConfig?.icon,paused:o.piggybankConfig?.paused??!1}};if(console.log(" Updating envelope in Firestore:",c),await fn.updateEnvelope(a.id,c),console.log(" Envelope updated successfully"),t(u=>({envelopes:u.envelopes.map(d=>d.id===n?c:d),isLoading:!1})),!o.piggybankConfig?.paused)try{await e().setEnvelopeAllocation(n,r),setTimeout(()=>{e().transactions.find(d=>d.envelopeId===n&&(d.description==="Monthly Allocation"||d.description==="Piggybank Contribution"))||console.warn(" Piggybank contribution transaction not found after update")},1e3)}catch(u){console.error(" Failed to update piggybank contribution:",u)}console.log(" Piggybank contribution updated successfully")}catch(i){throw console.error(" updatePiggybankContribution failed:",i),t({isLoading:!1,error:i instanceof Error?i.message:"Failed to update piggybank contribution"}),i}},addIncomeSource:async(n,r)=>{try{t({isLoading:!0,error:null});const a=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");console.log(" Adding income source:",{month:n,source:r});const o=await fn.createIncomeSource({...r,userId:a.id,month:n});t(c=>{const u=c.incomeSources[n]||[];return u.some(h=>h.id===o.id)?{isLoading:!1}:{incomeSources:{...c.incomeSources,[n]:[...u,o]},isLoading:!1}}),console.log(" Added income source:",o.id)}catch(i){throw console.error(" addIncomeSource failed:",i),t({isLoading:!1,error:i instanceof Error?i.message:"Failed to add income source"}),i}},updateIncomeSource:async(n,r)=>{try{t({isLoading:!0,error:null}),console.log(" Updating income source:",{month:n,sourceId:r.id}),t(o=>({incomeSources:{...o.incomeSources,[n]:o.incomeSources[n]?.map(c=>c.id===r.id?{...r,updatedAt:new Date().toISOString()}:c)||[]},isLoading:!1}));const a=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!a)return;await fn.updateIncomeSource(a.id,r.id,n,r),console.log(" Updated income source:",r.id)}catch(i){throw console.error(" updateIncomeSource failed:",i),t({isLoading:!1,error:i instanceof Error?i.message:"Failed to update income source"}),i}},deleteIncomeSource:async(n,r)=>{try{t({isLoading:!0,error:null}),console.log(" Deleting income source:",{month:n,sourceId:r}),t(o=>({incomeSources:{...o.incomeSources,[n]:o.incomeSources[n]?.filter(c=>c.id!==r)||[]},isLoading:!1}));const a=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!a)return;await fn.deleteIncomeSource(a.id,r,n),console.log(" Deleted income source:",r)}catch(i){throw console.error(" deleteIncomeSource failed:",i),t({isLoading:!1,error:i instanceof Error?i.message:"Failed to delete income source"}),i}},copyPreviousMonthAllocations:async n=>{try{t({isLoading:!0,error:null});const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(w=>w.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");console.log(" Copying allocations from previous month:",n);const[a,o]=n.split("-").map(Number);let c=a,u=o-1;u<1&&(c=a-1,u=12);const d=`${c}-${String(u).padStart(2,"0")}`;(!e().incomeSources[d]||!e().allocations[d])&&(console.log(` Previous month ${d} data missing, fetching...`),await e().fetchMonthData(d));const h=e().incomeSources[d]||[];if(console.log(` Found ${h.length} income sources from ${d}`),h.length>0){for(const w of h){const{id:S,...E}=w;await e().addIncomeSource(n,E)}console.log(` Copied ${h.length} income sources to ${n}`)}const p=e().allocations[d]||[];console.log(` Found ${p.length} allocations from ${d}`);const m=p.filter(w=>{const S=e().envelopes.find(E=>E.id===w.envelopeId);return!!S&&!S.isPiggybank});if(m.length>0){for(const w of m)await e().createEnvelopeAllocation({envelopeId:w.envelopeId,budgetedAmount:w.budgetedAmount,userId:i.id,month:n,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),w.budgetedAmount>0&&await e().addTransaction({description:"Budgeted",amount:w.budgetedAmount,envelopeId:w.envelopeId,type:"Income",month:n,date:`${n}-01T00:00:00`,reconciled:!1,isAutomatic:!0});console.log(` Copied ${m.length} regular allocations to ${n}`)}const b=e().envelopes.filter(w=>w.isPiggybank);console.log(` Processing ${b.length} piggybanks for ${n}`);for(const w of b){const S=w.piggybankConfig?.monthlyContribution,E=w.piggybankConfig?.paused??!1;if(!E&&S&&S>0)try{console.log(` Setting piggybank allocation for ${w.name}: ${S}`),await e().setEnvelopeAllocation(w.id,S)}catch(T){console.error(` Failed to set allocation for piggybank ${w.name}:`,T)}else console.log(` Skipping piggybank ${w.name} (paused=${E}, contribution=${S})`)}t({isLoading:!1}),console.log(` Complete monthly setup copied to ${n}`)}catch(r){throw console.error(" copyPreviousMonthAllocations failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to copy allocations"}),r}},setEnvelopeAllocation:async(n,r)=>{try{t({isLoading:!0,error:null});const a=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(h=>h.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");const o=e().currentMonth,c=e().envelopes.find(h=>h.id===n);if(!c){console.error(` setEnvelopeAllocation: Envelope ${n} not found in store! Aborting.`),t({isLoading:!1});return}const u=!!c.isPiggybank;console.log(` setEnvelopeAllocation called: envelopeId=${n}, amount=${r}, currentMonth=${o}, isPiggybank=${u}`);const d=e().allocations[o]?.find(h=>h.envelopeId===n);if(d?await e().updateEnvelopeAllocation(d.id,{budgetedAmount:r}):await e().createEnvelopeAllocation({envelopeId:n,budgetedAmount:r,userId:a.id,month:o,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),u&&r>0&&!c?.piggybankConfig?.paused){const h=e().transactions.find(p=>p.envelopeId===n&&p.month===o&&(p.description==="Monthly Allocation"||p.description==="Piggybank Contribution"));if(h){const p={...h,amount:r,description:"Piggybank Contribution"};await e().updateTransaction(p)}else{const p={description:"Piggybank Contribution",amount:r,envelopeId:n,type:"Income",month:o,date:`${o}-01T00:00:00`,reconciled:!1,isAutomatic:!0};await e().addTransaction(p)}}if(!u&&r>0){const h=e().transactions.find(p=>p.envelopeId===n&&p.month===o&&(p.description==="Monthly Budget Allocation"||p.description==="Budgeted"));if(h){const p={...h,amount:r,description:"Budgeted"};await e().updateTransaction(p)}else{const p={description:"Budgeted",amount:r,envelopeId:n,type:"Income",month:o,date:`${o}-01T00:00:00`,reconciled:!1,isAutomatic:!0};await e().addTransaction(p)}}console.log(" Envelope allocation set successfully")}catch(i){throw console.error(" setEnvelopeAllocation failed:",i),t({isLoading:!1,error:i instanceof Error?i.message:"Failed to set envelope allocation"}),i}},createEnvelopeAllocation:async n=>{try{const i=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=e().currentMonth,o=await fn.createEnvelopeAllocation({envelopeId:n.envelopeId,budgetedAmount:n.budgetedAmount,userId:i.id,month:a});t(c=>{const u=c.allocations[a]||[];return u.some(h=>h.id===o.id)?{isLoading:!1}:{allocations:{...c.allocations,[a]:[...u,o]},isLoading:!1}}),console.log(" Created envelope allocation:",o.id)}catch(r){throw console.error(" createEnvelopeAllocation failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to create envelope allocation"}),r}},updateEnvelopeAllocation:async(n,r)=>{try{console.log(" Updating envelope allocation:",{id:n,updates:r});const i=e().currentMonth,o=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(h=>h.useAuthStore.getState())).currentUser;if(!o)throw new Error("No authenticated user found");const c=e().allocations[i]?.find(h=>h.id===n);if(!c)throw new Error("Allocation not found");const u=e().envelopes.find(h=>h.id===c.envelopeId),d=u?.isPiggybank;if(await fn.updateEnvelopeAllocation(o.id,c.envelopeId,i,{budgetedAmount:r.budgetedAmount}),t(h=>({allocations:{...h.allocations,[i]:h.allocations[i]?.map(p=>p.id===n?{...p,...r,updatedAt:new Date().toISOString()}:p)||[]},isLoading:!1})),d&&r.budgetedAmount!==void 0){const h=e().transactions.find(p=>p.envelopeId===c.envelopeId&&p.month===i&&(p.description==="Monthly Allocation"||p.description==="Piggybank Contribution"));h?r.budgetedAmount>0&&!u?.piggybankConfig?.paused?await e().updateTransaction({...h,amount:r.budgetedAmount,description:"Piggybank Contribution"}):(r.budgetedAmount===0||u?.piggybankConfig?.paused)&&await e().deleteTransaction(h.id):r.budgetedAmount>0&&!u?.piggybankConfig?.paused&&await e().addTransaction({description:"Piggybank Contribution",amount:r.budgetedAmount,envelopeId:c.envelopeId,type:"Income",month:i,date:`${i}-01T00:00:00`,reconciled:!1,isAutomatic:!0})}if(!d&&r.budgetedAmount!==void 0){const h=e().transactions.find(p=>p.envelopeId===c.envelopeId&&p.month===i&&(p.description==="Monthly Budget Allocation"||p.description==="Budgeted"));h?r.budgetedAmount>0?await e().updateTransaction({...h,amount:r.budgetedAmount,description:"Budgeted"}):r.budgetedAmount===0&&await e().deleteTransaction(h.id):r.budgetedAmount>0&&await e().addTransaction({description:"Budgeted",amount:r.budgetedAmount,envelopeId:c.envelopeId,type:"Income",month:i,date:`${i}-01T00:00:00`,reconciled:!1,isAutomatic:!0})}console.log(" Updated envelope allocation:",n)}catch(i){throw console.error(" updateEnvelopeAllocation failed:",i),t({isLoading:!1,error:i instanceof Error?i.message:"Failed to update envelope allocation"}),i}},deleteEnvelopeAllocation:async n=>{try{console.log(" Deleting envelope allocation:",n);const r=e().currentMonth,i=e().allocations[r]?.find(c=>c.id===n);if(!i){console.warn("Allocation not found in store, skipping delete");return}const o=(await Tt(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!o)throw new Error("No authenticated user found");await fn.deleteEnvelopeAllocation(o.id,i.envelopeId,r),t(c=>({allocations:{...c.allocations,[r]:c.allocations[r]?.filter(u=>u.id!==n)||[]},isLoading:!1})),console.log(" Deleted envelope allocation:",n)}catch(r){throw console.error(" deleteEnvelopeAllocation failed:",r),t({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete envelope allocation"}),r}},refreshAvailableToBudget:async()=>{try{const n=e().currentMonth,r=e().allocations[n]||[],i=e().incomeSources[n]||[],a=r.reduce((u,d)=>u+d.budgetedAmount,0);return i.reduce((u,d)=>u+d.amount,0)-a}catch(n){throw console.error(" refreshAvailableToBudget failed:",n),t({error:n instanceof Error?n.message:"Failed to refresh available to budget"}),n}},updateOnlineStatus:async()=>{try{const n=typeof navigator<"u"?navigator.onLine:!0;t({isOnline:n}),console.log(" Online status updated:",n)}catch(n){console.error(" Failed to update online status:",n)}},handleUserLogout:()=>{console.log(" Clearing user data on logout"),t({envelopes:[],transactions:[],categories:[],incomeSources:{},allocations:{},isOnboardingActive:!1,isOnboardingCompleted:!1,isLoading:!1,error:null})}}),{name:"budget-storage",partialize:t=>({envelopes:t.envelopes,transactions:t.transactions,categories:t.categories,appSettings:t.appSettings,incomeSources:t.incomeSources,allocations:t.allocations,currentMonth:t.currentMonth,isOnline:t.isOnline})})));qQ({useBudgetStore:Xt,useAuthStore:Ai,getCurrentUserId:om});const YQ=Object.freeze(Object.defineProperty({__proto__:null,useBudgetStore:Xt},Symbol.toStringTag,{value:"Module"}));var pu=9e15,rl=1e9,N1="0123456789abcdef",e0="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",t0="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",D1={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-pu,maxE:pu,crypto:!1},VP,vs,tt=!0,J0="[DecimalError] ",Ko=J0+"Invalid argument: ",zP=J0+"Precision limit exceeded",LP=J0+"crypto unavailable",BP="[object Decimal]",hr=Math.floor,Bn=Math.pow,XQ=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,WQ=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,KQ=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,UP=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ki=1e7,Ke=7,QQ=9007199254740991,ZQ=e0.length-1,I1=t0.length-1,Ae={toStringTag:BP};Ae.absoluteValue=Ae.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),$e(t)};Ae.ceil=function(){return $e(new this.constructor(this),this.e+1,2)};Ae.clampedTo=Ae.clamp=function(t,e){var n,r=this,i=r.constructor;if(t=new i(t),e=new i(e),!t.s||!e.s)return new i(NaN);if(t.gt(e))throw Error(Ko+e);return n=r.cmp(t),n<0?t:r.cmp(e)>0?e:new i(r)};Ae.comparedTo=Ae.cmp=function(t){var e,n,r,i,a=this,o=a.d,c=(t=new a.constructor(t)).d,u=a.s,d=t.s;if(!o||!c)return!u||!d?NaN:u!==d?u:o===c?0:!o^u<0?1:-1;if(!o[0]||!c[0])return o[0]?u:c[0]?-d:0;if(u!==d)return u;if(a.e!==t.e)return a.e>t.e^u<0?1:-1;for(r=o.length,i=c.length,e=0,n=r<i?r:i;e<n;++e)if(o[e]!==c[e])return o[e]>c[e]^u<0?1:-1;return r===i?0:r>i^u<0?1:-1};Ae.cosine=Ae.cos=function(){var t,e,n=this,r=n.constructor;return n.d?n.d[0]?(t=r.precision,e=r.rounding,r.precision=t+Math.max(n.e,n.sd())+Ke,r.rounding=1,n=JQ(r,qP(r,n)),r.precision=t,r.rounding=e,$e(vs==2||vs==3?n.neg():n,t,e,!0)):new r(1):new r(NaN)};Ae.cubeRoot=Ae.cbrt=function(){var t,e,n,r,i,a,o,c,u,d,h=this,p=h.constructor;if(!h.isFinite()||h.isZero())return new p(h);for(tt=!1,a=h.s*Bn(h.s*h,1/3),!a||Math.abs(a)==1/0?(n=rr(h.d),t=h.e,(a=(t-n.length+1)%3)&&(n+=a==1||a==-2?"0":"00"),a=Bn(n,1/3),t=hr((t+1)/3)-(t%3==(t<0?-1:2)),a==1/0?n="5e"+t:(n=a.toExponential(),n=n.slice(0,n.indexOf("e")+1)+t),r=new p(n),r.s=h.s):r=new p(a.toString()),o=(t=p.precision)+3;;)if(c=r,u=c.times(c).times(c),d=u.plus(h),r=qt(d.plus(h).times(c),d.plus(u),o+2,1),rr(c.d).slice(0,o)===(n=rr(r.d)).slice(0,o))if(n=n.slice(o-3,o+1),n=="9999"||!i&&n=="4999"){if(!i&&($e(c,t+1,0),c.times(c).times(c).eq(h))){r=c;break}o+=4,i=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&($e(r,t+1,1),e=!r.times(r).times(r).eq(h));break}return tt=!0,$e(r,t,p.rounding,e)};Ae.decimalPlaces=Ae.dp=function(){var t,e=this.d,n=NaN;if(e){if(t=e.length-1,n=(t-hr(this.e/Ke))*Ke,t=e[t],t)for(;t%10==0;t/=10)n--;n<0&&(n=0)}return n};Ae.dividedBy=Ae.div=function(t){return qt(this,new this.constructor(t))};Ae.dividedToIntegerBy=Ae.divToInt=function(t){var e=this,n=e.constructor;return $e(qt(e,new n(t),0,1,1),n.precision,n.rounding)};Ae.equals=Ae.eq=function(t){return this.cmp(t)===0};Ae.floor=function(){return $e(new this.constructor(this),this.e+1,3)};Ae.greaterThan=Ae.gt=function(t){return this.cmp(t)>0};Ae.greaterThanOrEqualTo=Ae.gte=function(t){var e=this.cmp(t);return e==1||e===0};Ae.hyperbolicCosine=Ae.cosh=function(){var t,e,n,r,i,a=this,o=a.constructor,c=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return c;n=o.precision,r=o.rounding,o.precision=n+Math.max(a.e,a.sd())+4,o.rounding=1,i=a.d.length,i<32?(t=Math.ceil(i/3),e=(1/tv(4,t)).toString()):(t=16,e="2.3283064365386962890625e-10"),a=Lu(o,1,a.times(e),new o(1),!0);for(var u,d=t,h=new o(8);d--;)u=a.times(a),a=c.minus(u.times(h.minus(u.times(h))));return $e(a,o.precision=n,o.rounding=r,!0)};Ae.hyperbolicSine=Ae.sinh=function(){var t,e,n,r,i=this,a=i.constructor;if(!i.isFinite()||i.isZero())return new a(i);if(e=a.precision,n=a.rounding,a.precision=e+Math.max(i.e,i.sd())+4,a.rounding=1,r=i.d.length,r<3)i=Lu(a,2,i,i,!0);else{t=1.4*Math.sqrt(r),t=t>16?16:t|0,i=i.times(1/tv(5,t)),i=Lu(a,2,i,i,!0);for(var o,c=new a(5),u=new a(16),d=new a(20);t--;)o=i.times(i),i=i.times(c.plus(o.times(u.times(o).plus(d))))}return a.precision=e,a.rounding=n,$e(i,e,n,!0)};Ae.hyperbolicTangent=Ae.tanh=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+7,r.rounding=1,qt(n.sinh(),n.cosh(),r.precision=t,r.rounding=e)):new r(n.s)};Ae.inverseCosine=Ae.acos=function(){var t=this,e=t.constructor,n=t.abs().cmp(1),r=e.precision,i=e.rounding;return n!==-1?n===0?t.isNeg()?ka(e,r,i):new e(0):new e(NaN):t.isZero()?ka(e,r+4,i).times(.5):(e.precision=r+6,e.rounding=1,t=new e(1).minus(t).div(t.plus(1)).sqrt().atan(),e.precision=r,e.rounding=i,t.times(2))};Ae.inverseHyperbolicCosine=Ae.acosh=function(){var t,e,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(t=r.precision,e=r.rounding,r.precision=t+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,tt=!1,n=n.times(n).minus(1).sqrt().plus(n),tt=!0,r.precision=t,r.rounding=e,n.ln()):new r(n)};Ae.inverseHyperbolicSine=Ae.asinh=function(){var t,e,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,tt=!1,n=n.times(n).plus(1).sqrt().plus(n),tt=!0,r.precision=t,r.rounding=e,n.ln())};Ae.inverseHyperbolicTangent=Ae.atanh=function(){var t,e,n,r,i=this,a=i.constructor;return i.isFinite()?i.e>=0?new a(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(t=a.precision,e=a.rounding,r=i.sd(),Math.max(r,t)<2*-i.e-1?$e(new a(i),t,e,!0):(a.precision=n=r-i.e,i=qt(i.plus(1),new a(1).minus(i),n+t,1),a.precision=t+4,a.rounding=1,i=i.ln(),a.precision=t,a.rounding=e,i.times(.5))):new a(NaN)};Ae.inverseSine=Ae.asin=function(){var t,e,n,r,i=this,a=i.constructor;return i.isZero()?new a(i):(e=i.abs().cmp(1),n=a.precision,r=a.rounding,e!==-1?e===0?(t=ka(a,n+4,r).times(.5),t.s=i.s,t):new a(NaN):(a.precision=n+6,a.rounding=1,i=i.div(new a(1).minus(i.times(i)).sqrt().plus(1)).atan(),a.precision=n,a.rounding=r,i.times(2)))};Ae.inverseTangent=Ae.atan=function(){var t,e,n,r,i,a,o,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding;if(d.isFinite()){if(d.isZero())return new h(d);if(d.abs().eq(1)&&p+4<=I1)return o=ka(h,p+4,m).times(.25),o.s=d.s,o}else{if(!d.s)return new h(NaN);if(p+4<=I1)return o=ka(h,p+4,m).times(.5),o.s=d.s,o}for(h.precision=c=p+10,h.rounding=1,n=Math.min(28,c/Ke+2|0),t=n;t;--t)d=d.div(d.times(d).plus(1).sqrt().plus(1));for(tt=!1,e=Math.ceil(c/Ke),r=1,u=d.times(d),o=new h(d),i=d;t!==-1;)if(i=i.times(u),a=o.minus(i.div(r+=2)),i=i.times(u),o=a.plus(i.div(r+=2)),o.d[e]!==void 0)for(t=e;o.d[t]===a.d[t]&&t--;);return n&&(o=o.times(2<<n-1)),tt=!0,$e(o,h.precision=p,h.rounding=m,!0)};Ae.isFinite=function(){return!!this.d};Ae.isInteger=Ae.isInt=function(){return!!this.d&&hr(this.e/Ke)>this.d.length-2};Ae.isNaN=function(){return!this.s};Ae.isNegative=Ae.isNeg=function(){return this.s<0};Ae.isPositive=Ae.isPos=function(){return this.s>0};Ae.isZero=function(){return!!this.d&&this.d[0]===0};Ae.lessThan=Ae.lt=function(t){return this.cmp(t)<0};Ae.lessThanOrEqualTo=Ae.lte=function(t){return this.cmp(t)<1};Ae.logarithm=Ae.log=function(t){var e,n,r,i,a,o,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding,b=5;if(t==null)t=new h(10),e=!0;else{if(t=new h(t),n=t.d,t.s<0||!n||!n[0]||t.eq(1))return new h(NaN);e=t.eq(10)}if(n=d.d,d.s<0||!n||!n[0]||d.eq(1))return new h(n&&!n[0]?-1/0:d.s!=1?NaN:n?0:1/0);if(e)if(n.length>1)a=!0;else{for(i=n[0];i%10===0;)i/=10;a=i!==1}if(tt=!1,c=p+b,o=Ro(d,c),r=e?n0(h,c+10):Ro(t,c),u=qt(o,r,c,1),uh(u.d,i=p,m))do if(c+=10,o=Ro(d,c),r=e?n0(h,c+10):Ro(t,c),u=qt(o,r,c,1),!a){+rr(u.d).slice(i+1,i+15)+1==1e14&&(u=$e(u,p+1,0));break}while(uh(u.d,i+=10,m));return tt=!0,$e(u,p,m)};Ae.minus=Ae.sub=function(t){var e,n,r,i,a,o,c,u,d,h,p,m,b=this,w=b.constructor;if(t=new w(t),!b.d||!t.d)return!b.s||!t.s?t=new w(NaN):b.d?t.s=-t.s:t=new w(t.d||b.s!==t.s?b:NaN),t;if(b.s!=t.s)return t.s=-t.s,b.plus(t);if(d=b.d,m=t.d,c=w.precision,u=w.rounding,!d[0]||!m[0]){if(m[0])t.s=-t.s;else if(d[0])t=new w(b);else return new w(u===3?-0:0);return tt?$e(t,c,u):t}if(n=hr(t.e/Ke),h=hr(b.e/Ke),d=d.slice(),a=h-n,a){for(p=a<0,p?(e=d,a=-a,o=m.length):(e=m,n=h,o=d.length),r=Math.max(Math.ceil(c/Ke),o)+2,a>r&&(a=r,e.length=1),e.reverse(),r=a;r--;)e.push(0);e.reverse()}else{for(r=d.length,o=m.length,p=r<o,p&&(o=r),r=0;r<o;r++)if(d[r]!=m[r]){p=d[r]<m[r];break}a=0}for(p&&(e=d,d=m,m=e,t.s=-t.s),o=d.length,r=m.length-o;r>0;--r)d[o++]=0;for(r=m.length;r>a;){if(d[--r]<m[r]){for(i=r;i&&d[--i]===0;)d[i]=Ki-1;--d[i],d[r]+=Ki}d[r]-=m[r]}for(;d[--o]===0;)d.pop();for(;d[0]===0;d.shift())--n;return d[0]?(t.d=d,t.e=ev(d,n),tt?$e(t,c,u):t):new w(u===3?-0:0)};Ae.modulo=Ae.mod=function(t){var e,n=this,r=n.constructor;return t=new r(t),!n.d||!t.s||t.d&&!t.d[0]?new r(NaN):!t.d||n.d&&!n.d[0]?$e(new r(n),r.precision,r.rounding):(tt=!1,r.modulo==9?(e=qt(n,t.abs(),0,3,1),e.s*=t.s):e=qt(n,t,0,r.modulo,1),e=e.times(t),tt=!0,n.minus(e))};Ae.naturalExponential=Ae.exp=function(){return M1(this)};Ae.naturalLogarithm=Ae.ln=function(){return Ro(this)};Ae.negated=Ae.neg=function(){var t=new this.constructor(this);return t.s=-t.s,$e(t)};Ae.plus=Ae.add=function(t){var e,n,r,i,a,o,c,u,d,h,p=this,m=p.constructor;if(t=new m(t),!p.d||!t.d)return!p.s||!t.s?t=new m(NaN):p.d||(t=new m(t.d||p.s===t.s?p:NaN)),t;if(p.s!=t.s)return t.s=-t.s,p.minus(t);if(d=p.d,h=t.d,c=m.precision,u=m.rounding,!d[0]||!h[0])return h[0]||(t=new m(p)),tt?$e(t,c,u):t;if(a=hr(p.e/Ke),r=hr(t.e/Ke),d=d.slice(),i=a-r,i){for(i<0?(n=d,i=-i,o=h.length):(n=h,r=a,o=d.length),a=Math.ceil(c/Ke),o=a>o?a+1:o+1,i>o&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(o=d.length,i=h.length,o-i<0&&(i=o,n=h,h=d,d=n),e=0;i;)e=(d[--i]=d[i]+h[i]+e)/Ki|0,d[i]%=Ki;for(e&&(d.unshift(e),++r),o=d.length;d[--o]==0;)d.pop();return t.d=d,t.e=ev(d,r),tt?$e(t,c,u):t};Ae.precision=Ae.sd=function(t){var e,n=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Ko+t);return n.d?(e=FP(n.d),t&&n.e+1>e&&(e=n.e+1)):e=NaN,e};Ae.round=function(){var t=this,e=t.constructor;return $e(new e(t),t.e+1,e.rounding)};Ae.sine=Ae.sin=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+Math.max(n.e,n.sd())+Ke,r.rounding=1,n=tZ(r,qP(r,n)),r.precision=t,r.rounding=e,$e(vs>2?n.neg():n,t,e,!0)):new r(NaN)};Ae.squareRoot=Ae.sqrt=function(){var t,e,n,r,i,a,o=this,c=o.d,u=o.e,d=o.s,h=o.constructor;if(d!==1||!c||!c[0])return new h(!d||d<0&&(!c||c[0])?NaN:c?o:1/0);for(tt=!1,d=Math.sqrt(+o),d==0||d==1/0?(e=rr(c),(e.length+u)%2==0&&(e+="0"),d=Math.sqrt(e),u=hr((u+1)/2)-(u<0||u%2),d==1/0?e="5e"+u:(e=d.toExponential(),e=e.slice(0,e.indexOf("e")+1)+u),r=new h(e)):r=new h(d.toString()),n=(u=h.precision)+3;;)if(a=r,r=a.plus(qt(o,a,n+2,1)).times(.5),rr(a.d).slice(0,n)===(e=rr(r.d)).slice(0,n))if(e=e.slice(n-3,n+1),e=="9999"||!i&&e=="4999"){if(!i&&($e(a,u+1,0),a.times(a).eq(o))){r=a;break}n+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&($e(r,u+1,1),t=!r.times(r).eq(o));break}return tt=!0,$e(r,u,h.rounding,t)};Ae.tangent=Ae.tan=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+10,r.rounding=1,n=n.sin(),n.s=1,n=qt(n,new r(1).minus(n.times(n)).sqrt(),t+10,0),r.precision=t,r.rounding=e,$e(vs==2||vs==4?n.neg():n,t,e,!0)):new r(NaN)};Ae.times=Ae.mul=function(t){var e,n,r,i,a,o,c,u,d,h=this,p=h.constructor,m=h.d,b=(t=new p(t)).d;if(t.s*=h.s,!m||!m[0]||!b||!b[0])return new p(!t.s||m&&!m[0]&&!b||b&&!b[0]&&!m?NaN:!m||!b?t.s/0:t.s*0);for(n=hr(h.e/Ke)+hr(t.e/Ke),u=m.length,d=b.length,u<d&&(a=m,m=b,b=a,o=u,u=d,d=o),a=[],o=u+d,r=o;r--;)a.push(0);for(r=d;--r>=0;){for(e=0,i=u+r;i>r;)c=a[i]+b[r]*m[i-r-1]+e,a[i--]=c%Ki|0,e=c/Ki|0;a[i]=(a[i]+e)%Ki|0}for(;!a[--o];)a.pop();return e?++n:a.shift(),t.d=a,t.e=ev(a,n),tt?$e(t,p.precision,p.rounding):t};Ae.toBinary=function(t,e){return cS(this,2,t,e)};Ae.toDecimalPlaces=Ae.toDP=function(t,e){var n=this,r=n.constructor;return n=new r(n),t===void 0?n:(Br(t,0,rl),e===void 0?e=r.rounding:Br(e,0,8),$e(n,t+n.e+1,e))};Ae.toExponential=function(t,e){var n,r=this,i=r.constructor;return t===void 0?n=Fa(r,!0):(Br(t,0,rl),e===void 0?e=i.rounding:Br(e,0,8),r=$e(new i(r),t+1,e),n=Fa(r,!0,t+1)),r.isNeg()&&!r.isZero()?"-"+n:n};Ae.toFixed=function(t,e){var n,r,i=this,a=i.constructor;return t===void 0?n=Fa(i):(Br(t,0,rl),e===void 0?e=a.rounding:Br(e,0,8),r=$e(new a(i),t+i.e+1,e),n=Fa(r,!1,t+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n};Ae.toFraction=function(t){var e,n,r,i,a,o,c,u,d,h,p,m,b=this,w=b.d,S=b.constructor;if(!w)return new S(b);if(d=n=new S(1),r=u=new S(0),e=new S(r),a=e.e=FP(w)-b.e-1,o=a%Ke,e.d[0]=Bn(10,o<0?Ke+o:o),t==null)t=a>0?e:d;else{if(c=new S(t),!c.isInt()||c.lt(d))throw Error(Ko+c);t=c.gt(e)?a>0?e:d:c}for(tt=!1,c=new S(rr(w)),h=S.precision,S.precision=a=w.length*Ke*2;p=qt(c,e,0,1,1),i=n.plus(p.times(r)),i.cmp(t)!=1;)n=r,r=i,i=d,d=u.plus(p.times(i)),u=i,i=e,e=c.minus(p.times(i)),c=i;return i=qt(t.minus(n),r,0,1,1),u=u.plus(i.times(d)),n=n.plus(i.times(r)),u.s=d.s=b.s,m=qt(d,r,a,1).minus(b).abs().cmp(qt(u,n,a,1).minus(b).abs())<1?[d,r]:[u,n],S.precision=h,tt=!0,m};Ae.toHexadecimal=Ae.toHex=function(t,e){return cS(this,16,t,e)};Ae.toNearest=function(t,e){var n=this,r=n.constructor;if(n=new r(n),t==null){if(!n.d)return n;t=new r(1),e=r.rounding}else{if(t=new r(t),e===void 0?e=r.rounding:Br(e,0,8),!n.d)return t.s?n:t;if(!t.d)return t.s&&(t.s=n.s),t}return t.d[0]?(tt=!1,n=qt(n,t,0,e,1).times(t),tt=!0,$e(n)):(t.s=n.s,n=t),n};Ae.toNumber=function(){return+this};Ae.toOctal=function(t,e){return cS(this,8,t,e)};Ae.toPower=Ae.pow=function(t){var e,n,r,i,a,o,c=this,u=c.constructor,d=+(t=new u(t));if(!c.d||!t.d||!c.d[0]||!t.d[0])return new u(Bn(+c,d));if(c=new u(c),c.eq(1))return c;if(r=u.precision,a=u.rounding,t.eq(1))return $e(c,r,a);if(e=hr(t.e/Ke),e>=t.d.length-1&&(n=d<0?-d:d)<=QQ)return i=$P(u,c,n,r),t.s<0?new u(1).div(i):$e(i,r,a);if(o=c.s,o<0){if(e<t.d.length-1)return new u(NaN);if((t.d[e]&1)==0&&(o=1),c.e==0&&c.d[0]==1&&c.d.length==1)return c.s=o,c}return n=Bn(+c,d),e=n==0||!isFinite(n)?hr(d*(Math.log("0."+rr(c.d))/Math.LN10+c.e+1)):new u(n+"").e,e>u.maxE+1||e<u.minE-1?new u(e>0?o/0:0):(tt=!1,u.rounding=c.s=1,n=Math.min(12,(e+"").length),i=M1(t.times(Ro(c,r+n)),r),i.d&&(i=$e(i,r+5,1),uh(i.d,r,a)&&(e=r+10,i=$e(M1(t.times(Ro(c,e+n)),e),e+5,1),+rr(i.d).slice(r+1,r+15)+1==1e14&&(i=$e(i,r+1,0)))),i.s=o,tt=!0,u.rounding=a,$e(i,r,a))};Ae.toPrecision=function(t,e){var n,r=this,i=r.constructor;return t===void 0?n=Fa(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(Br(t,1,rl),e===void 0?e=i.rounding:Br(e,0,8),r=$e(new i(r),t,e),n=Fa(r,t<=r.e||r.e<=i.toExpNeg,t)),r.isNeg()&&!r.isZero()?"-"+n:n};Ae.toSignificantDigits=Ae.toSD=function(t,e){var n=this,r=n.constructor;return t===void 0?(t=r.precision,e=r.rounding):(Br(t,1,rl),e===void 0?e=r.rounding:Br(e,0,8)),$e(new r(n),t,e)};Ae.toString=function(){var t=this,e=t.constructor,n=Fa(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()&&!t.isZero()?"-"+n:n};Ae.truncated=Ae.trunc=function(){return $e(new this.constructor(this),this.e+1,1)};Ae.valueOf=Ae.toJSON=function(){var t=this,e=t.constructor,n=Fa(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()?"-"+n:n};function rr(t){var e,n,r,i=t.length-1,a="",o=t[0];if(i>0){for(a+=o,e=1;e<i;e++)r=t[e]+"",n=Ke-r.length,n&&(a+=bo(n)),a+=r;o=t[e],r=o+"",n=Ke-r.length,n&&(a+=bo(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}function Br(t,e,n){if(t!==~~t||t<e||t>n)throw Error(Ko+t)}function uh(t,e,n,r){var i,a,o,c;for(a=t[0];a>=10;a/=10)--e;return--e<0?(e+=Ke,i=0):(i=Math.ceil((e+1)/Ke),e%=Ke),a=Bn(10,Ke-e),c=t[i]%a|0,r==null?e<3?(e==0?c=c/100|0:e==1&&(c=c/10|0),o=n<4&&c==99999||n>3&&c==49999||c==5e4||c==0):o=(n<4&&c+1==a||n>3&&c+1==a/2)&&(t[i+1]/a/100|0)==Bn(10,e-2)-1||(c==a/2||c==0)&&(t[i+1]/a/100|0)==0:e<4?(e==0?c=c/1e3|0:e==1?c=c/100|0:e==2&&(c=c/10|0),o=(r||n<4)&&c==9999||!r&&n>3&&c==4999):o=((r||n<4)&&c+1==a||!r&&n>3&&c+1==a/2)&&(t[i+1]/a/1e3|0)==Bn(10,e-3)-1,o}function lm(t,e,n){for(var r,i=[0],a,o=0,c=t.length;o<c;){for(a=i.length;a--;)i[a]*=e;for(i[0]+=N1.indexOf(t.charAt(o++)),r=0;r<i.length;r++)i[r]>n-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/n|0,i[r]%=n)}return i.reverse()}function JQ(t,e){var n,r,i;if(e.isZero())return e;r=e.d.length,r<32?(n=Math.ceil(r/3),i=(1/tv(4,n)).toString()):(n=16,i="2.3283064365386962890625e-10"),t.precision+=n,e=Lu(t,1,e.times(i),new t(1));for(var a=n;a--;){var o=e.times(e);e=o.times(o).minus(o).times(8).plus(1)}return t.precision-=n,e}var qt=(function(){function t(r,i,a){var o,c=0,u=r.length;for(r=r.slice();u--;)o=r[u]*i+c,r[u]=o%a|0,c=o/a|0;return c&&r.unshift(c),r}function e(r,i,a,o){var c,u;if(a!=o)u=a>o?1:-1;else for(c=u=0;c<a;c++)if(r[c]!=i[c]){u=r[c]>i[c]?1:-1;break}return u}function n(r,i,a,o){for(var c=0;a--;)r[a]-=c,c=r[a]<i[a]?1:0,r[a]=c*o+r[a]-i[a];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,a,o,c,u){var d,h,p,m,b,w,S,E,T,C,N,j,O,M,A,k,D,V,L,U,P=r.constructor,K=r.s==i.s?1:-1,X=r.d,q=i.d;if(!X||!X[0]||!q||!q[0])return new P(!r.s||!i.s||(X?q&&X[0]==q[0]:!q)?NaN:X&&X[0]==0||!q?K*0:K/0);for(u?(b=1,h=r.e-i.e):(u=Ki,b=Ke,h=hr(r.e/b)-hr(i.e/b)),L=q.length,D=X.length,T=new P(K),C=T.d=[],p=0;q[p]==(X[p]||0);p++);if(q[p]>(X[p]||0)&&h--,a==null?(M=a=P.precision,o=P.rounding):c?M=a+(r.e-i.e)+1:M=a,M<0)C.push(1),w=!0;else{if(M=M/b+2|0,p=0,L==1){for(m=0,q=q[0],M++;(p<D||m)&&M--;p++)A=m*u+(X[p]||0),C[p]=A/q|0,m=A%q|0;w=m||p<D}else{for(m=u/(q[0]+1)|0,m>1&&(q=t(q,m,u),X=t(X,m,u),L=q.length,D=X.length),k=L,N=X.slice(0,L),j=N.length;j<L;)N[j++]=0;U=q.slice(),U.unshift(0),V=q[0],q[1]>=u/2&&++V;do m=0,d=e(q,N,L,j),d<0?(O=N[0],L!=j&&(O=O*u+(N[1]||0)),m=O/V|0,m>1?(m>=u&&(m=u-1),S=t(q,m,u),E=S.length,j=N.length,d=e(S,N,E,j),d==1&&(m--,n(S,L<E?U:q,E,u))):(m==0&&(d=m=1),S=q.slice()),E=S.length,E<j&&S.unshift(0),n(N,S,j,u),d==-1&&(j=N.length,d=e(q,N,L,j),d<1&&(m++,n(N,L<j?U:q,j,u))),j=N.length):d===0&&(m++,N=[0]),C[p++]=m,d&&N[0]?N[j++]=X[k]||0:(N=[X[k]],j=1);while((k++<D||N[0]!==void 0)&&M--);w=N[0]!==void 0}C[0]||C.shift()}if(b==1)T.e=h,VP=w;else{for(p=1,m=C[0];m>=10;m/=10)p++;T.e=p+h*b-1,$e(T,c?a+T.e+1:a,o,w)}return T}})();function $e(t,e,n,r){var i,a,o,c,u,d,h,p,m,b=t.constructor;e:if(e!=null){if(p=t.d,!p)return t;for(i=1,c=p[0];c>=10;c/=10)i++;if(a=e-i,a<0)a+=Ke,o=e,h=p[m=0],u=h/Bn(10,i-o-1)%10|0;else if(m=Math.ceil((a+1)/Ke),c=p.length,m>=c)if(r){for(;c++<=m;)p.push(0);h=u=0,i=1,a%=Ke,o=a-Ke+1}else break e;else{for(h=c=p[m],i=1;c>=10;c/=10)i++;a%=Ke,o=a-Ke+i,u=o<0?0:h/Bn(10,i-o-1)%10|0}if(r=r||e<0||p[m+1]!==void 0||(o<0?h:h%Bn(10,i-o-1)),d=n<4?(u||r)&&(n==0||n==(t.s<0?3:2)):u>5||u==5&&(n==4||r||n==6&&(a>0?o>0?h/Bn(10,i-o):0:p[m-1])%10&1||n==(t.s<0?8:7)),e<1||!p[0])return p.length=0,d?(e-=t.e+1,p[0]=Bn(10,(Ke-e%Ke)%Ke),t.e=-e||0):p[0]=t.e=0,t;if(a==0?(p.length=m,c=1,m--):(p.length=m+1,c=Bn(10,Ke-a),p[m]=o>0?(h/Bn(10,i-o)%Bn(10,o)|0)*c:0),d)for(;;)if(m==0){for(a=1,o=p[0];o>=10;o/=10)a++;for(o=p[0]+=c,c=1;o>=10;o/=10)c++;a!=c&&(t.e++,p[0]==Ki&&(p[0]=1));break}else{if(p[m]+=c,p[m]!=Ki)break;p[m--]=0,c=1}for(a=p.length;p[--a]===0;)p.pop()}return tt&&(t.e>b.maxE?(t.d=null,t.e=NaN):t.e<b.minE&&(t.e=0,t.d=[0])),t}function Fa(t,e,n){if(!t.isFinite())return HP(t);var r,i=t.e,a=rr(t.d),o=a.length;return e?(n&&(r=n-o)>0?a=a.charAt(0)+"."+a.slice(1)+bo(r):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(t.e<0?"e":"e+")+t.e):i<0?(a="0."+bo(-i-1)+a,n&&(r=n-o)>0&&(a+=bo(r))):i>=o?(a+=bo(i+1-o),n&&(r=n-i-1)>0&&(a=a+"."+bo(r))):((r=i+1)<o&&(a=a.slice(0,r)+"."+a.slice(r)),n&&(r=n-o)>0&&(i+1===o&&(a+="."),a+=bo(r))),a}function ev(t,e){var n=t[0];for(e*=Ke;n>=10;n/=10)e++;return e}function n0(t,e,n){if(e>ZQ)throw tt=!0,n&&(t.precision=n),Error(zP);return $e(new t(e0),e,1,!0)}function ka(t,e,n){if(e>I1)throw Error(zP);return $e(new t(t0),e,n,!0)}function FP(t){var e=t.length-1,n=e*Ke+1;if(e=t[e],e){for(;e%10==0;e/=10)n--;for(e=t[0];e>=10;e/=10)n++}return n}function bo(t){for(var e="";t--;)e+="0";return e}function $P(t,e,n,r){var i,a=new t(1),o=Math.ceil(r/Ke+4);for(tt=!1;;){if(n%2&&(a=a.times(e),WR(a.d,o)&&(i=!0)),n=hr(n/2),n===0){n=a.d.length-1,i&&a.d[n]===0&&++a.d[n];break}e=e.times(e),WR(e.d,o)}return tt=!0,a}function XR(t){return t.d[t.d.length-1]&1}function GP(t,e,n){for(var r,i,a=new t(e[0]),o=0;++o<e.length;){if(i=new t(e[o]),!i.s){a=i;break}r=a.cmp(i),(r===n||r===0&&a.s===n)&&(a=i)}return a}function M1(t,e){var n,r,i,a,o,c,u,d=0,h=0,p=0,m=t.constructor,b=m.rounding,w=m.precision;if(!t.d||!t.d[0]||t.e>17)return new m(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(e==null?(tt=!1,u=w):u=e,c=new m(.03125);t.e>-2;)t=t.times(c),p+=5;for(r=Math.log(Bn(2,p))/Math.LN10*2+5|0,u+=r,n=a=o=new m(1),m.precision=u;;){if(a=$e(a.times(t),u,1),n=n.times(++h),c=o.plus(qt(a,n,u,1)),rr(c.d).slice(0,u)===rr(o.d).slice(0,u)){for(i=p;i--;)o=$e(o.times(o),u,1);if(e==null)if(d<3&&uh(o.d,u-r,b,d))m.precision=u+=10,n=a=c=new m(1),h=0,d++;else return $e(o,m.precision=w,b,tt=!0);else return m.precision=w,o}o=c}}function Ro(t,e){var n,r,i,a,o,c,u,d,h,p,m,b=1,w=10,S=t,E=S.d,T=S.constructor,C=T.rounding,N=T.precision;if(S.s<0||!E||!E[0]||!S.e&&E[0]==1&&E.length==1)return new T(E&&!E[0]?-1/0:S.s!=1?NaN:E?0:S);if(e==null?(tt=!1,h=N):h=e,T.precision=h+=w,n=rr(E),r=n.charAt(0),Math.abs(a=S.e)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)S=S.times(t),n=rr(S.d),r=n.charAt(0),b++;a=S.e,r>1?(S=new T("0."+n),a++):S=new T(r+"."+n.slice(1))}else return d=n0(T,h+2,N).times(a+""),S=Ro(new T(r+"."+n.slice(1)),h-w).plus(d),T.precision=N,e==null?$e(S,N,C,tt=!0):S;for(p=S,u=o=S=qt(S.minus(1),S.plus(1),h,1),m=$e(S.times(S),h,1),i=3;;){if(o=$e(o.times(m),h,1),d=u.plus(qt(o,new T(i),h,1)),rr(d.d).slice(0,h)===rr(u.d).slice(0,h))if(u=u.times(2),a!==0&&(u=u.plus(n0(T,h+2,N).times(a+""))),u=qt(u,new T(b),h,1),e==null)if(uh(u.d,h-w,C,c))T.precision=h+=w,d=o=S=qt(p.minus(1),p.plus(1),h,1),m=$e(S.times(S),h,1),i=c=1;else return $e(u,T.precision=N,C,tt=!0);else return T.precision=N,u;u=d,i+=2}}function HP(t){return String(t.s*t.s/0)}function cm(t,e){var n,r,i;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),r=0;e.charCodeAt(r)===48;r++);for(i=e.length;e.charCodeAt(i-1)===48;--i);if(e=e.slice(r,i),e){if(i-=r,t.e=n=n-r-1,t.d=[],r=(n+1)%Ke,n<0&&(r+=Ke),r<i){for(r&&t.d.push(+e.slice(0,r)),i-=Ke;r<i;)t.d.push(+e.slice(r,r+=Ke));e=e.slice(r),r=Ke-e.length}else r-=i;for(;r--;)e+="0";t.d.push(+e),tt&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function eZ(t,e){var n,r,i,a,o,c,u,d,h;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),UP.test(e))return cm(t,e)}else if(e==="Infinity"||e==="NaN")return+e||(t.s=NaN),t.e=NaN,t.d=null,t;if(WQ.test(e))n=16,e=e.toLowerCase();else if(XQ.test(e))n=2;else if(KQ.test(e))n=8;else throw Error(Ko+e);for(a=e.search(/p/i),a>0?(u=+e.slice(a+1),e=e.substring(2,a)):e=e.slice(2),a=e.indexOf("."),o=a>=0,r=t.constructor,o&&(e=e.replace(".",""),c=e.length,a=c-a,i=$P(r,new r(n),a,a*2)),d=lm(e,n,Ki),h=d.length-1,a=h;d[a]===0;--a)d.pop();return a<0?new r(t.s*0):(t.e=ev(d,h),t.d=d,tt=!1,o&&(t=qt(t,i,c*4)),u&&(t=t.times(Math.abs(u)<54?Bn(2,u):Bu.pow(2,u))),tt=!0,t)}function tZ(t,e){var n,r=e.d.length;if(r<3)return e.isZero()?e:Lu(t,2,e,e);n=1.4*Math.sqrt(r),n=n>16?16:n|0,e=e.times(1/tv(5,n)),e=Lu(t,2,e,e);for(var i,a=new t(5),o=new t(16),c=new t(20);n--;)i=e.times(e),e=e.times(a.plus(i.times(o.times(i).minus(c))));return e}function Lu(t,e,n,r,i){var a,o,c,u,d=t.precision,h=Math.ceil(d/Ke);for(tt=!1,u=n.times(n),c=new t(r);;){if(o=qt(c.times(u),new t(e++*e++),d,1),c=i?r.plus(o):r.minus(o),r=qt(o.times(u),new t(e++*e++),d,1),o=c.plus(r),o.d[h]!==void 0){for(a=h;o.d[a]===c.d[a]&&a--;);if(a==-1)break}a=c,c=r,r=o,o=a}return tt=!0,o.d.length=h+1,o}function tv(t,e){for(var n=t;--e;)n*=t;return n}function qP(t,e){var n,r=e.s<0,i=ka(t,t.precision,1),a=i.times(.5);if(e=e.abs(),e.lte(a))return vs=r?4:1,e;if(n=e.divToInt(i),n.isZero())vs=r?3:2;else{if(e=e.minus(n.times(i)),e.lte(a))return vs=XR(n)?r?2:3:r?4:1,e;vs=XR(n)?r?1:4:r?3:2}return e.minus(i).abs()}function cS(t,e,n,r){var i,a,o,c,u,d,h,p,m,b=t.constructor,w=n!==void 0;if(w?(Br(n,1,rl),r===void 0?r=b.rounding:Br(r,0,8)):(n=b.precision,r=b.rounding),!t.isFinite())h=HP(t);else{for(h=Fa(t),o=h.indexOf("."),w?(i=2,e==16?n=n*4-3:e==8&&(n=n*3-2)):i=e,o>=0&&(h=h.replace(".",""),m=new b(1),m.e=h.length-o,m.d=lm(Fa(m),10,i),m.e=m.d.length),p=lm(h,10,i),a=u=p.length;p[--u]==0;)p.pop();if(!p[0])h=w?"0p+0":"0";else{if(o<0?a--:(t=new b(t),t.d=p,t.e=a,t=qt(t,m,n,r,0,i),p=t.d,a=t.e,d=VP),o=p[n],c=i/2,d=d||p[n+1]!==void 0,d=r<4?(o!==void 0||d)&&(r===0||r===(t.s<0?3:2)):o>c||o===c&&(r===4||d||r===6&&p[n-1]&1||r===(t.s<0?8:7)),p.length=n,d)for(;++p[--n]>i-1;)p[n]=0,n||(++a,p.unshift(1));for(u=p.length;!p[u-1];--u);for(o=0,h="";o<u;o++)h+=N1.charAt(p[o]);if(w){if(u>1)if(e==16||e==8){for(o=e==16?4:3,--u;u%o;u++)h+="0";for(p=lm(h,i,e),u=p.length;!p[u-1];--u);for(o=1,h="1.";o<u;o++)h+=N1.charAt(p[o])}else h=h.charAt(0)+"."+h.slice(1);h=h+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)h="0"+h;h="0."+h}else if(++a>u)for(a-=u;a--;)h+="0";else a<u&&(h=h.slice(0,a)+"."+h.slice(a))}h=(e==16?"0x":e==2?"0b":e==8?"0o":"")+h}return t.s<0?"-"+h:h}function WR(t,e){if(t.length>e)return t.length=e,!0}function nZ(t){return new this(t).abs()}function rZ(t){return new this(t).acos()}function iZ(t){return new this(t).acosh()}function aZ(t,e){return new this(t).plus(e)}function sZ(t){return new this(t).asin()}function oZ(t){return new this(t).asinh()}function lZ(t){return new this(t).atan()}function cZ(t){return new this(t).atanh()}function uZ(t,e){t=new this(t),e=new this(e);var n,r=this.precision,i=this.rounding,a=r+4;return!t.s||!e.s?n=new this(NaN):!t.d&&!e.d?(n=ka(this,a,1).times(e.s>0?.25:.75),n.s=t.s):!e.d||t.isZero()?(n=e.s<0?ka(this,r,i):new this(0),n.s=t.s):!t.d||e.isZero()?(n=ka(this,a,1).times(.5),n.s=t.s):e.s<0?(this.precision=a,this.rounding=1,n=this.atan(qt(t,e,a,1)),e=ka(this,a,1),this.precision=r,this.rounding=i,n=t.s<0?n.minus(e):n.plus(e)):n=this.atan(qt(t,e,a,1)),n}function dZ(t){return new this(t).cbrt()}function fZ(t){return $e(t=new this(t),t.e+1,2)}function hZ(t,e,n){return new this(t).clamp(e,n)}function pZ(t){if(!t||typeof t!="object")throw Error(J0+"Object expected");var e,n,r,i=t.defaults===!0,a=["precision",1,rl,"rounding",0,8,"toExpNeg",-pu,0,"toExpPos",0,pu,"maxE",0,pu,"minE",-pu,0,"modulo",0,9];for(e=0;e<a.length;e+=3)if(n=a[e],i&&(this[n]=D1[n]),(r=t[n])!==void 0)if(hr(r)===r&&r>=a[e+1]&&r<=a[e+2])this[n]=r;else throw Error(Ko+n+": "+r);if(n="crypto",i&&(this[n]=D1[n]),(r=t[n])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(LP);else this[n]=!1;else throw Error(Ko+n+": "+r);return this}function gZ(t){return new this(t).cos()}function mZ(t){return new this(t).cosh()}function YP(t){var e,n,r;function i(a){var o,c,u,d=this;if(!(d instanceof i))return new i(a);if(d.constructor=i,KR(a)){d.s=a.s,tt?!a.d||a.e>i.maxE?(d.e=NaN,d.d=null):a.e<i.minE?(d.e=0,d.d=[0]):(d.e=a.e,d.d=a.d.slice()):(d.e=a.e,d.d=a.d?a.d.slice():a.d);return}if(u=typeof a,u==="number"){if(a===0){d.s=1/a<0?-1:1,d.e=0,d.d=[0];return}if(a<0?(a=-a,d.s=-1):d.s=1,a===~~a&&a<1e7){for(o=0,c=a;c>=10;c/=10)o++;tt?o>i.maxE?(d.e=NaN,d.d=null):o<i.minE?(d.e=0,d.d=[0]):(d.e=o,d.d=[a]):(d.e=o,d.d=[a]);return}if(a*0!==0){a||(d.s=NaN),d.e=NaN,d.d=null;return}return cm(d,a.toString())}if(u==="string")return(c=a.charCodeAt(0))===45?(a=a.slice(1),d.s=-1):(c===43&&(a=a.slice(1)),d.s=1),UP.test(a)?cm(d,a):eZ(d,a);if(u==="bigint")return a<0?(a=-a,d.s=-1):d.s=1,cm(d,a.toString());throw Error(Ko+a)}if(i.prototype=Ae,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=pZ,i.clone=YP,i.isDecimal=KR,i.abs=nZ,i.acos=rZ,i.acosh=iZ,i.add=aZ,i.asin=sZ,i.asinh=oZ,i.atan=lZ,i.atanh=cZ,i.atan2=uZ,i.cbrt=dZ,i.ceil=fZ,i.clamp=hZ,i.cos=gZ,i.cosh=mZ,i.div=vZ,i.exp=yZ,i.floor=bZ,i.hypot=xZ,i.ln=wZ,i.log=_Z,i.log10=EZ,i.log2=SZ,i.max=TZ,i.min=AZ,i.mod=CZ,i.mul=kZ,i.pow=RZ,i.random=NZ,i.round=DZ,i.sign=IZ,i.sin=MZ,i.sinh=OZ,i.sqrt=PZ,i.sub=jZ,i.sum=VZ,i.tan=zZ,i.tanh=LZ,i.trunc=BZ,t===void 0&&(t={}),t&&t.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<r.length;)t.hasOwnProperty(n=r[e++])||(t[n]=this[n]);return i.config(t),i}function vZ(t,e){return new this(t).div(e)}function yZ(t){return new this(t).exp()}function bZ(t){return $e(t=new this(t),t.e+1,3)}function xZ(){var t,e,n=new this(0);for(tt=!1,t=0;t<arguments.length;)if(e=new this(arguments[t++]),e.d)n.d&&(n=n.plus(e.times(e)));else{if(e.s)return tt=!0,new this(1/0);n=e}return tt=!0,n.sqrt()}function KR(t){return t instanceof Bu||t&&t.toStringTag===BP||!1}function wZ(t){return new this(t).ln()}function _Z(t,e){return new this(t).log(e)}function SZ(t){return new this(t).log(2)}function EZ(t){return new this(t).log(10)}function TZ(){return GP(this,arguments,-1)}function AZ(){return GP(this,arguments,1)}function CZ(t,e){return new this(t).mod(e)}function kZ(t,e){return new this(t).mul(e)}function RZ(t,e){return new this(t).pow(e)}function NZ(t){var e,n,r,i,a=0,o=new this(1),c=[];if(t===void 0?t=this.precision:Br(t,1,rl),r=Math.ceil(t/Ke),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));a<r;)i=e[a],i>=429e7?e[a]=crypto.getRandomValues(new Uint32Array(1))[0]:c[a++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(r*=4);a<r;)i=e[a]+(e[a+1]<<8)+(e[a+2]<<16)+((e[a+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(e,a):(c.push(i%1e7),a+=4);a=r/4}else throw Error(LP);else for(;a<r;)c[a++]=Math.random()*1e7|0;for(r=c[--a],t%=Ke,r&&t&&(i=Bn(10,Ke-t),c[a]=(r/i|0)*i);c[a]===0;a--)c.pop();if(a<0)n=0,c=[0];else{for(n=-1;c[0]===0;n-=Ke)c.shift();for(r=1,i=c[0];i>=10;i/=10)r++;r<Ke&&(n-=Ke-r)}return o.e=n,o.d=c,o}function DZ(t){return $e(t=new this(t),t.e+1,this.rounding)}function IZ(t){return t=new this(t),t.d?t.d[0]?t.s:0*t.s:t.s||NaN}function MZ(t){return new this(t).sin()}function OZ(t){return new this(t).sinh()}function PZ(t){return new this(t).sqrt()}function jZ(t,e){return new this(t).sub(e)}function VZ(){var t=0,e=arguments,n=new this(e[t]);for(tt=!1;n.s&&++t<e.length;)n=n.plus(e[t]);return tt=!0,$e(n,this.precision,this.rounding)}function zZ(t){return new this(t).tan()}function LZ(t){return new this(t).tanh()}function BZ(t){return $e(t=new this(t),t.e+1,1)}Ae[Symbol.for("nodejs.util.inspect.custom")]=Ae.toString;Ae[Symbol.toStringTag]="Decimal";var Bu=Ae.constructor=YP(D1);e0=new Bu(e0);t0=new Bu(t0);const QR=t=>{if(!t)return null;if(t instanceof Date)return t;if(typeof t=="object"&&typeof t.toDate=="function")return t.toDate();if(typeof t=="object"&&t.seconds!==void 0)return new Date(t.seconds*1e3);if(typeof t=="string"){const e=new Date(t);return isNaN(e.getTime())?null:e}if(typeof t=="number"){const e=new Date(t);return isNaN(e.getTime())?null:e}return null},UZ=()=>{const{envelopes:t,transactions:e,fetchData:n,isLoading:r,isOnline:i,reorderEnvelopes:a}=Xt(),{currentUser:o}=Ai(),{currentMonth:c,incomeSources:u,allocations:d,deleteIncomeSource:h,setEnvelopeAllocation:p,copyPreviousMonthAllocations:m,isLoading:b}=Xt(),{showToast:w}=oc(),[S,E]=B.useState(!1),T=B.useRef(null),[C,N]=B.useState(!1),j=!C||r||b,[O,M]=B.useState([]),A=B.useRef([]),[k,D]=B.useState([]),V=B.useRef([]),L=B.useCallback(Z=>{if(t.find(ie=>ie.id===Z)?.isPiggybank){const ie=Xt.getState().getEnvelopeBalance(Z);return new Bu(ie)}const le=Xt.getState().getEnvelopeBalance(Z,c);return new Bu(le)},[t,c]);B.useEffect(()=>{const Z=t.filter(W=>{if(!W.isPiggybank||!W.isActive)return!1;if(W.createdAt)try{const le=QR(W.createdAt);if(!le)return console.error(` Invalid creation date for piggybank ${W.name}:`,W.createdAt),!1;const ie=`${le.getFullYear()}-${String(le.getMonth()+1).padStart(2,"0")}`;return c>=ie}catch(le){return console.error(` Error processing piggybank ${W.name}:`,le,{createdAt:W.createdAt,typeofCreatedAt:typeof W.createdAt}),!1}return!0}).sort((W,le)=>{const ie=W.orderIndex??0,pe=le.orderIndex??0;return ie-pe});D(Z),V.current=Z},[t,c]);const U=k,P=O;B.useEffect(()=>(T.current=setTimeout(()=>{E(!0)},8e3),n(),N(!0),()=>{T.current&&clearTimeout(T.current)}),[]),B.useEffect(()=>{C&&!r&&!b&&(E(!1),T.current&&clearTimeout(T.current))},[C,r,b]),B.useEffect(()=>{const Z=t.filter(W=>{if(W.isPiggybank||W.isActive===!1)return!1;const ie=(d[c]||[]).some(ce=>ce.envelopeId===W.id),pe=e.some(ce=>ce.envelopeId===W.id&&(ce.month===c||ce.date.startsWith(c)));return ie||pe}).sort((W,le)=>{const ie=W.orderIndex??0,pe=le.orderIndex??0;return ie-pe});M(Z),A.current=Z},[t,d,c,e]);const K=(u[c]||[]).reduce((Z,W)=>Z+W.amount,0),X=(d[c]||[]).filter(Z=>P.some(W=>W.id===Z.envelopeId)||U.some(W=>W.id===Z.envelopeId)).reduce((Z,W)=>Z+W.budgetedAmount,0),q=K-X,Q=B.useCallback(async Z=>{if(!Z.length)return;const W=Z.map(le=>le.id);try{await a(W)}catch(le){console.error("Failed to persist envelope order:",le),w("Failed to save envelope order","error")}},[a,w]),te=B.useCallback(async Z=>{await Q(Z)},[Q]),se=B.useCallback(Z=>{h(c,Z.id).catch(console.error),w(`Deleted "${Z.name}"`,"neutral")},[h,c,w]),G=B.useCallback(async Z=>{try{const W=Z||c;console.log(" Copying to month:",W),await m(W),w("Previous month budget copied","success")}catch(W){console.error("Error copying previous month:",W),w("Failed to copy previous month","error")}},[m,w,c]),F=B.useCallback(async()=>{if(!o||!c){w("Cannot clear data: not logged in or no month selected","error");return}try{await Xt.getState().clearMonthData(c),w(`"${c}" budget and transactions cleared successfully`,"success")}catch(Z){console.error("Error clearing month data:",Z),w("Failed to clear month data","error")}},[o,c,w]),Y=B.useCallback(async(Z,W)=>{try{await p(Z,W),setTimeout(()=>{const le=Xt.getState(),ie=le.currentMonth,pe=le.incomeSources[ie]||[],ce=le.allocations[ie]||[],xe=new Set(le.envelopes.filter(Ne=>{if(Ne.isPiggybank){if(!Ne.isActive)return!1;if(Ne.createdAt){const Ie=QR(Ne.createdAt);if(!Ie)return!1;const Oe=`${Ie.getFullYear()}-${String(Ie.getMonth()+1).padStart(2,"0")}`;return ie>=Oe}return!0}return Ne.isActive!==!1}).map(Ne=>Ne.id)),Re=ce.filter(Ne=>xe.has(Ne.envelopeId)),ae=pe.reduce((Ne,Ie)=>Ne+Ie.amount,0),Ee=Re.reduce((Ne,Ie)=>Ne+Ie.budgetedAmount,0);ae-Ee<-.005?w(`You can't spend more than you make.
You're not in Congress!`,"error"):Math.abs(ae-Ee)<.005&&ae>0&&w("Every dollar has a job ","success")},100)}catch(le){console.error("Failed to set allocation:",le),w("Failed to update budget","error")}},[p,w]);return{visibleEnvelopes:P,piggybanks:U,incomeSources:u,availableToBudget:q,currentMonth:c,allocations:d,transactions:e,isLoading:r,isInitialLoading:j,isOnline:i,showTimeoutMessage:S,getEnvelopeBalance:L,fetchData:n,reorderEnvelopes:te,deleteIncomeSource:se,clearMonthData:F,copyFromPreviousMonth:G,setEnvelopeAllocation:Y,localOrderRef:A,setLocalEnvelopes:M,localPiggybankOrderRef:V,setLocalPiggybanks:D}},FZ=({currentMonth:t,onMonthChange:e,budgetStatus:n})=>{const[r,i]=t.split("-").map(Number),o=["January","February","March","April","May","June","July","August","September","October","November","December"][i-1],c=()=>{let p=r,m=i-1;m<1&&(p=r-1,m=12);const b=`${p}-${m.toString().padStart(2,"0")}`;e(b)},u=()=>{let p=r,m=i+1;m>12&&(p=r+1,m=1);const b=`${p}-${m.toString().padStart(2,"0")}`;e(b)},d=()=>{const p=new Date,m=`${p.getFullYear()}-${(p.getMonth()+1).toString().padStart(2,"0")}`;e(m)},h=()=>{if(!n)return null;const{amount:p,totalIncome:m,totalAllocated:b}=n,w=typeof p=="number"?p:0,S=typeof m=="number"?m:0,E=typeof b=="number"?b:0,T=Math.abs(w)<.005,C=w<-.005,N=S>0?E/S*100:0;let j="text-gray-900 dark:text-white",O="bg-green-500",M="Left to Budget",A=S>0?Math.min(N,100):0,k=!0;return S===0?(M="Add income to start budgeting",A=0,k=!1,j="text-gray-500 dark:text-zinc-500"):T?(j="text-green-600 dark:text-emerald-400",O="bg-green-500",M="Perfect! Every dollar has a job ",A=100,k=!1):C&&(j="text-red-600 dark:text-red-400",O="bg-red-500",M="You're not in Congress! Try again.",A=100),v.jsxs("div",{className:"flex flex-col justify-center min-w-0 w-full",children:[v.jsxs("div",{className:"flex items-baseline justify-start mb-1",children:[v.jsx("span",{className:`text-xs font-medium truncate mr-1.5 ${j}`,children:M}),k&&v.jsxs("span",{className:`text-sm font-bold truncate ${j}`,children:[C?"-":"","$",Math.abs(w).toFixed(2)]})]}),v.jsx("div",{className:"w-full h-1.5 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:v.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${O}`,style:{width:`${A}%`}})})]})};return v.jsxs("div",{className:"py-2 space-y-3",children:[v.jsxs("div",{className:"flex items-center justify-center gap-4",children:[v.jsx("button",{onClick:c,className:"p-1.5 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Previous month",children:v.jsx(Q9,{size:20})}),v.jsx("div",{className:"text-center",children:v.jsxs("button",{onClick:d,className:"text-base font-semibold text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors whitespace-nowrap",title:"Click to go to current month",children:[o," ",r]})}),v.jsx("button",{onClick:u,className:"p-1.5 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Next month",children:v.jsx(Ea,{size:20})})]}),n&&v.jsx("div",{className:"px-1",children:h()})]})},nv=({children:t,onDelete:e,threshold:n=-100,disabled:r=!1})=>{const i=pY(),[a,o]=B.useState(!1),c=B.useRef(0),u=()=>{r||(o(!0),c.current=Date.now())},d=async(h,p)=>{if(r)return;const m=p.offset.x,b=p.velocity.x;if(setTimeout(()=>o(!1),100),m<n||m<-50&&b<-500){const w=e();w===!1?i.start({x:0}):w instanceof Promise&&w.then(S=>{S===!1&&i.start({x:0})})}else i.start({x:0})};return v.jsxs("div",{className:"relative w-full overflow-hidden mb-2 rounded-xl group",children:[v.jsx("div",{className:"absolute inset-0 bg-red-500 flex items-center justify-end pr-6 rounded-xl",children:v.jsx(wm,{className:"text-white w-6 h-6"})}),v.jsx(gn.div,{drag:r?!1:"x",dragConstraints:{left:-500,right:0},dragElastic:.1,onDragStart:u,onDragEnd:d,animate:i,className:`relative bg-white dark:bg-zinc-900 rounded-xl ${a?"z-20":"z-10"}`,style:{touchAction:"pan-y",pointerEvents:a?"none":"auto"},children:t})]})},$Z=({isVisible:t,onClose:e,mode:n,initialIncomeSource:r})=>{const{addIncomeSource:i,updateIncomeSource:a,currentMonth:o}=Xt(),{showToast:c}=oc(),[u,d]=B.useState(""),[h,p]=B.useState(""),[m,b]=B.useState(!1);B.useEffect(()=>{if(!t)return;const S=window.setTimeout(()=>{n==="edit"&&r?(d(r.name),p(r.amount.toString())):(d(""),p(""))},0);return()=>window.clearTimeout(S)},[t,n,r]);const w=async S=>{if(S.preventDefault(),!u.trim()||!h||parseFloat(h)<=0){c("Please fill in all required fields with valid values","error");return}b(!0);try{if(n==="add")await i(o,{name:u.trim(),amount:parseFloat(h),month:o,userId:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),c("Income source added successfully","success");else{if(!r){c("Error: No income source to edit","error");return}await a(o,{...r,name:u.trim(),amount:parseFloat(h),updatedAt:new Date().toISOString()}),c(`Updated "${u.trim()}" income source`,"success")}e()}catch(E){console.error("Error saving income source:",E),c("Failed to save income source. Please try again.","error")}finally{b(!1)}};return v.jsx(ii,{children:t&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(gn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black bg-opacity-50"}),v.jsxs(gn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n==="add"?"Add Income Source":"Edit Income Source"}),v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",children:""})]}),v.jsxs("form",{onSubmit:w,className:"p-6 space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Income Source Name *"}),v.jsx("input",{type:"text",value:u,onChange:S=>d(S.target.value),placeholder:"e.g., Primary Job, Freelance, Investments",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Amount *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-zinc-400",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:h,onChange:S=>{const E=S.target.value.replace(/\D/g,"");if(!E){p("");return}const C=(parseInt(E,10)/100).toFixed(2);p(C)},placeholder:"0.00",className:"w-full pl-8 pr-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"submit",disabled:m||!u.trim()||!h||parseFloat(h)<=0,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m?"Saving...":n==="add"?"Add Income":"Save Changes"})]})]})]})]})})},GZ=({currentMonth:t,onCopy:e,isLoading:n=!1})=>{const r=c=>{const[u,d]=c.split("-");return new Date(parseInt(u),parseInt(d)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},i=c=>{const[u,d]=c.split("-").map(Number);let h=u,p=d-1;return p<1&&(h=u-1,p=12),r(`${h}-${p.toString().padStart(2,"0")}`)},a=r(t),o=i(t);return v.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6 py-12 space-y-6 animate-in fade-in zoom-in-95 duration-300",children:[v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-0 bg-blue-100 dark:bg-blue-900/30 blur-2xl rounded-full opacity-50"}),v.jsxs("div",{className:"relative bg-white dark:bg-zinc-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-700",children:[v.jsx($9,{className:"w-12 h-12 text-blue-500"}),v.jsx("div",{className:"absolute -top-2 -right-2 bg-blue-500 text-white p-1.5 rounded-full border-2 border-white dark:border-zinc-900",children:v.jsx(Gf,{size:14})})]})]}),v.jsxs("div",{className:"max-w-xs mx-auto space-y-2",children:[v.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["It looks like you need a budget for ",a]}),v.jsxs("p",{className:"text-gray-500 dark:text-zinc-400",children:["We can copy your budget from ",o," to get you started right away."]})]}),v.jsx("div",{className:"w-full max-w-xs space-y-3 pt-2",children:v.jsx("button",{onClick:e,disabled:n,className:"w-full py-3.5 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-sm transition-all active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:n?"Creating...":v.jsx(v.Fragment,{children:v.jsxs("span",{children:["Create ",a," Budget"]})})})})]})},HZ="/personal-budget-pwa/icon-512.png",nx="/personal-budget-pwa/images/budget-balanced.png",ZR=["Giving","Savings","Housing","Transportation","Food","Personal","Health","Insurance","Debt"],qZ=({currentMonth:t,onComplete:e})=>{const[n,r]=B.useState(0),[i,a]=B.useState(0),[o,c]=B.useState(2500),[u,d]=B.useState(ZR),{addCategory:h}=Xt(),p=M=>{d(A=>A.includes(M)?A.filter(k=>k!==M):[...A,M])},m=async()=>{for(let M=0;M<u.length;M++)await h({name:u[M],orderIndex:M,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()});e()};B.useEffect(()=>{if(console.log("Animation effect triggered:",{currentStep:n,animationKey:i}),n===5){console.log("Starting animation from $2500 to $0"),c(2500);const M=2e3,A=20,k=M/A,D=2500/A;let V=0;const L=setInterval(()=>{V++;const U=Math.max(0,2500-D*V);console.log("Phase 1 - Animation step:",V,"New amount:",U),c(U),V>=A&&(clearInterval(L),console.log("Phase 1 completed - Perfect budget reached"),setTimeout(()=>{console.log("Starting Phase 2 - Over budget demonstration");let P=0;const K=10,X=200,q=500/K,Q=setInterval(()=>{P++;const te=-(q*P);console.log("Phase 2 - Over budget step:",P,"Over budget amount:",te),c(te),P>=K&&(clearInterval(Q),console.log("Animation completed - Over budget scenario demonstrated"))},X)},1e3))},k);return()=>{console.log("Cleaning up animation timers"),clearInterval(L)}}},[i,n]);const w=(M=>{const[A,k]=M.split("-");return new Date(parseInt(A),parseInt(k)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})})(t),S=[{icon:Gf,title:"Welcome to Dollars At Work!",description:`Let's set up your budget for ${w}`,content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["Dollars At Work helps you take control of your money using the ",v.jsx("strong",{children:"zero-based budgeting"})," method."]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Every dollar gets a job, and you'll know exactly where your money is going."}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4",children:v.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-200 font-medium",children:" This quick guide will show you how to get started in just a few steps!"})})]}),color:"blue"},{icon:GB,title:"Step 1: Choose Categories",description:"Select categories to organize your spending",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Categories help group your envelopes. Select the ones you need:"}),v.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-60 overflow-y-auto pr-1",children:ZR.map(M=>v.jsxs("button",{onClick:()=>p(M),className:`p-3 rounded-xl border text-sm font-medium transition-all flex items-center gap-2 ${u.includes(M)?"bg-blue-50 border-blue-200 text-blue-700 dark:bg-blue-900/30 dark:border-blue-800 dark:text-blue-300":"bg-white border-gray-200 text-gray-600 dark:bg-zinc-800 dark:border-zinc-700 dark:text-zinc-400"}`,children:[v.jsx("div",{className:`w-4 h-4 rounded-full border flex items-center justify-center ${u.includes(M)?"border-blue-500 bg-blue-500":"border-gray-400"}`,children:u.includes(M)&&v.jsx(ps,{size:12,className:"text-white"})}),M]},M))}),u.length===0&&v.jsx("p",{className:"text-red-500 text-xs",children:"Please select at least one category."})]}),color:"blue"},{icon:kC,title:"Step 2: Add Your Income",description:"Tell us how much money you have to work with",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"First, you'll add your income sources for the month. This could be:"}),v.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-zinc-400",children:[v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ps,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Salary"})," - Your regular paycheck"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ps,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Freelance"})," - Side gig income"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ps,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Other Income"})," - Any other money coming in"]})]})]}),v.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-green-900 dark:text-green-200",children:[v.jsx("strong",{children:'Look for the "Income Sources" section'})," at the top of your budget and tap the ",v.jsx(wh,{className:"w-4 h-4 inline"})," button to add income."]})})]}),color:"green"},{icon:f0,title:"Step 3: Create Spending Envelopes",description:"Organize your spending into categories",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Spending envelopes are where you track expenses. You'll assign each envelope to a category."}),v.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-zinc-400",children:[v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ps,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Groceries"})," (Food)"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ps,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Rent/Mortgage"})," (Housing)"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ps,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Gas"})," (Transportation)"]})]})]}),v.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-purple-900 dark:text-purple-200",children:[v.jsx("strong",{children:'Tap "+" on a category section'})," to add an envelope to it."]})})]}),color:"purple"},{icon:Ff,title:"Step 4: Organize Your Budget",description:"Reorder categories and envelopes to match your preferences",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["Your budget should work the way ",v.jsx("strong",{children:"you"})," think about money. Customize the order to match your priorities!"]}),v.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-200 dark:border-indigo-800 rounded-xl p-4",children:[v.jsxs("h4",{className:"font-medium text-indigo-900 dark:text-indigo-200 mb-3 flex items-center gap-2",children:[v.jsx(Ff,{className:"w-4 h-4"}),"Drag to Reorder"]}),v.jsx("p",{className:"text-sm text-indigo-800 dark:text-indigo-300 mb-3",children:"Both categories and envelopes can be reordered the same way:"}),v.jsxs("div",{className:"space-y-2 mb-3",children:[v.jsxs("p",{className:"text-sm text-indigo-800 dark:text-indigo-300",children:[v.jsx("strong",{children:"Mobile:"})," Long-press and drag"]}),v.jsxs("p",{className:"text-sm text-indigo-800 dark:text-indigo-300",children:[v.jsx("strong",{children:"PC:"})," Click and hold on the ",v.jsx("strong",{children:""})," dots, then drag"]})]}),v.jsxs("div",{className:"bg-white dark:bg-indigo-950/30 rounded-lg p-3 mb-3 border border-indigo-300 dark:border-indigo-700",children:[v.jsxs("div",{className:"flex items-center gap-2 text-xs mb-2",children:[v.jsx("div",{className:"text-indigo-600 dark:text-indigo-400 font-bold",children:""}),v.jsxs("div",{className:"flex-1",children:[v.jsx("div",{className:"font-medium text-indigo-900 dark:text-indigo-200",children:"Food"}),v.jsx("div",{className:"text-indigo-700 dark:text-indigo-400 text-xs",children:"Category"})]})]}),v.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[v.jsx("div",{className:"text-indigo-600 dark:text-indigo-400 font-bold",children:""}),v.jsxs("div",{className:"flex-1",children:[v.jsx("div",{className:"font-medium text-indigo-900 dark:text-indigo-200",children:"Groceries"}),v.jsx("div",{className:"text-indigo-700 dark:text-indigo-400 text-xs",children:"$450 / $500"})]})]}),v.jsx("p",{className:"text-xs text-indigo-600 dark:text-indigo-400 mt-2 italic",children:" Click and hold these dots to drag"})]}),v.jsxs("ul",{className:"space-y-1 text-sm text-indigo-700 dark:text-indigo-400",children:[v.jsx("li",{children:" Reorder categories: Settings  Manage Categories"}),v.jsx("li",{children:" Reorder envelopes: On the main budget screen"}),v.jsx("li",{children:" Organize by priority, frequency, or preference"})]})]}),v.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-amber-900 dark:text-amber-200",children:[" ",v.jsx("strong",{children:"Pro tip:"})," Try organizing your budget like this: Income  Fixed Expenses  Variable Expenses  Savings Goals"]})})]}),color:"indigo"},{icon:_m,title:"Step 5: Allocate Your Budget",description:"Assign money to each envelope",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Now comes the fun part - giving every dollar a job!"}),v.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500 rounded-r-xl p-4 relative",children:[v.jsx("button",{onClick:()=>a(M=>M+1),className:"absolute top-2 right-2 p-1.5 text-blue-600 dark:text-blue-400 hover:bg-blue-100 dark:hover:bg-blue-800 rounded-lg transition-colors",title:"Replay animation",children:v.jsx(VB,{className:"w-4 h-4"})}),v.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-200 font-medium mb-2",children:'The "Left to Budget" amount shows unassigned money'}),v.jsxs("p",{className:"text-sm text-blue-900 dark:text-blue-200 mb-3",children:["Your goal is to get this to ",v.jsx("strong",{children:"$0.00"})," by allocating all your income to envelopes."]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex justify-between text-xs text-blue-700 dark:text-blue-300 font-medium",children:[v.jsx("span",{children:"Left to Budget"}),v.jsxs("span",{className:`font-bold ${o<0?"text-red-600 dark:text-red-400":""}`,children:["$",o.toFixed(2)]})]}),v.jsx("div",{className:"w-full bg-blue-200 dark:bg-blue-800 rounded-full h-2 overflow-hidden",children:v.jsx(gn.div,{className:`h-full rounded-full ${o<0?"bg-red-500":"bg-green-500"}`,initial:{width:"0%"},animate:{width:o<0?"100%":`${(2500-o)/2500*100}%`},transition:{duration:.3,ease:"easeInOut"}})}),v.jsxs(gn.div,{className:`text-xs font-medium text-center mt-1 ${o===0?"text-green-600 dark:text-emerald-400":o<0?"text-red-600 dark:text-red-400":"text-blue-700 dark:text-blue-300"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:2,duration:.5},children:[o===0&&"Perfect! Every dollar has a job ",o<0&&"You're not in Congress! Try again.",o>0&&"Keep allocating until you reach $0"]})]},i)]}),v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:[v.jsx("strong",{children:"To allocate money:"})," Tap the budget amount on any envelope and enter how much you want to assign to it."]}),v.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-amber-900 dark:text-amber-200",children:[" ",v.jsx("strong",{children:"Pro tip:"})," Start with your essential expenses (rent, utilities, groceries) first, then allocate what's left to other categories."]})})]}),color:"blue"},{icon:xh,title:"Bonus: Piggybanks (Savings Goals)",description:"Save for future goals",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["Piggybanks are special envelopes for ",v.jsx("strong",{children:"savings goals"})," that carry over month-to-month."]}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(qB,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Set a Goal"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Vacation, emergency fund, new car - whatever you're saving for"})]})]}),v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(kC,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Monthly Contributions"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Set an automatic monthly amount to save"})]})]}),v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(_m,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Track Progress"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Watch your savings grow toward your goal"})]})]})]}),v.jsx("div",{className:"bg-pink-50 dark:bg-pink-900/20 border border-pink-200 dark:border-pink-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-pink-900 dark:text-pink-200",children:[v.jsx("strong",{children:"Find Piggybanks"})," at the bottom of your budget. They're optional but powerful for reaching your goals!"]})})]}),color:"pink"},{icon:nx,title:"You're Ready to Budget!",description:"Start taking control of your money",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"That's it! You now know the basics of Dollars At Work:"}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"1"})}),v.jsx("span",{children:"Choose your categories"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"2"})}),v.jsx("span",{children:"Add your income sources"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"3"})}),v.jsx("span",{children:"Create envelopes in categories"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"4"})}),v.jsx("span",{children:"Organize your budget order"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"5"})}),v.jsx("span",{children:"Allocate until Left to Budget = $0"})]})]}),v.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4 mt-6",children:v.jsx("p",{className:"text-sm text-center text-blue-900 dark:text-blue-200 font-medium",children:' Click "Start Budgeting" below to create your first budget!'})})]}),color:"green",useCustomIcon:!0}],E=S[n],T=E.useCustomIcon?nx:E.icon,C=n===S.length-1,N=n===0,O={blue:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-600 dark:text-blue-400",button:"bg-blue-600 hover:bg-blue-700"},green:{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-600 dark:text-green-400",button:"bg-green-600 hover:bg-green-700"},purple:{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-600 dark:text-purple-400",button:"bg-purple-600 hover:bg-purple-700"},indigo:{bg:"bg-indigo-100 dark:bg-indigo-900/30",text:"text-indigo-600 dark:text-indigo-400",button:"bg-indigo-600 hover:bg-indigo-700"},pink:{bg:"bg-pink-100 dark:bg-pink-900/30",text:"text-pink-600 dark:text-pink-400",button:"bg-pink-600 hover:bg-pink-700"}}[E.color];return v.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex items-center justify-center p-4",children:v.jsx("div",{className:"w-full max-w-2xl",children:v.jsx(ii,{mode:"wait",children:v.jsxs(gn.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-xl border border-gray-200 dark:border-zinc-800 overflow-hidden",children:[v.jsx("div",{className:"p-6 pb-2",children:v.jsxs("div",{className:"flex items-center justify-between mb-4",children:[v.jsxs("div",{className:"flex-1",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:E.title}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:E.description})]}),v.jsx("div",{className:"flex flex-col items-center mx-4",children:n===0?v.jsx("img",{src:HZ,alt:"Dollars At Work",className:`w-20 h-20 ${O.text}`}):E.useCustomIcon?v.jsx("img",{src:nx,alt:"Budget Balanced",className:`w-32 h-32 ${O.text}`}):v.jsx("div",{className:`${O.bg} p-3 rounded-xl`,children:v.jsx(T,{className:`w-8 h-8 ${O.text}`})})}),v.jsxs("div",{className:"text-sm text-gray-500 dark:text-zinc-400 whitespace-nowrap",children:["Step ",n+1," of ",S.length]})]})}),v.jsx("div",{className:"px-6 pb-6 pt-2",children:E.content}),v.jsx("div",{className:"px-6 pb-4 flex justify-center gap-2",children:S.map((M,A)=>v.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${A===n?`w-8 ${O.button}`:A<n?"w-2 bg-gray-400 dark:bg-zinc-600":"w-2 bg-gray-200 dark:bg-zinc-700"}`},A))}),v.jsxs("div",{className:"p-6 pt-0 flex gap-3",children:[!N&&v.jsxs("button",{onClick:()=>r(M=>M-1),className:"flex-1 py-3 px-4 border border-gray-300 dark:border-zinc-700 text-gray-700 dark:text-zinc-300 rounded-xl font-medium hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors flex items-center justify-center gap-2",children:[v.jsx(Vo,{className:"w-5 h-5"}),"Back"]}),v.jsx("button",{onClick:()=>{if(C)m();else{if(E.title.includes("Choose Categories")&&u.length===0)return;r(M=>M+1)}},disabled:E.title.includes("Choose Categories")&&u.length===0,className:`${N?"flex-1":"flex-[2]"} py-3 px-4 ${O.button} text-white rounded-xl font-semibold transition-all active:scale-[0.98] flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed`,children:C?v.jsxs(v.Fragment,{children:[v.jsx(Gf,{className:"w-5 h-5"}),"Start Budgeting"]}):v.jsxs(v.Fragment,{children:["Next",v.jsx(U9,{className:"w-5 h-5"})]})})]})]},n)})})})},YZ=({piggybank:t,balance:e,onNavigate:n,setMoveableRef:r,isReorderingActive:i,activelyDraggingId:a,onItemDragStart:o,onLongPressTrigger:c})=>{const u=B.useRef(null),[d,h]=B.useState(!1),p=sS(D=>{PP(),c(D,t.id)},{threshold:500,cancelOnMovement:25,detect:Co.Touch}),m=t.piggybankConfig?.targetAmount,b=t.piggybankConfig?.monthlyContribution??0,w=t.piggybankConfig?.color||"#3B82F6",S=t.piggybankConfig?.paused||!1,E=typeof e=="number"?e:e.toNumber(),T=(D,V=1)=>{const L=D.replace("#",""),U=parseInt(L,16),P=U>>16&255,K=U>>8&255,X=U&255;return`rgba(${P}, ${K}, ${X}, ${V})`},C=`linear-gradient(135deg, ${T(w,.14)} 0%, ${T(w,.05)} 100%)`,N=T(w,.4),j=m&&m>0?Math.min(E/m*100,100):0,O=m&&E>=m;B.useEffect(()=>{a&&a!==t.id&&h(!1)},[a,t.id]),B.useEffect(()=>{a===t.id&&(h(!0),o&&o(t.id))},[a,t.id,o]),B.useEffect(()=>{if(!a&&d){const D=setTimeout(()=>{h(!1)},300);return()=>clearTimeout(D)}},[a,d]);const M=D=>{if(d||i){D.preventDefault(),D.stopPropagation();return}n(t.id)},A=a===t.id,k=v.jsxs("div",{className:"flex items-center gap-3 w-full",children:[v.jsx("div",{className:"hidden md:flex items-center justify-center p-1 text-gray-400 opacity-0 group-hover:opacity-100 cursor-grab active:cursor-grabbing transition-all duration-200",onMouseDown:D=>c(D,t.id),children:v.jsx(Ff,{size:20})}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsxs("div",{className:"flex items-center justify-between gap-3 mb-1",children:[v.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[v.jsx("div",{className:"w-6 h-6 rounded-full flex-shrink-0 flex items-center justify-center",style:{backgroundColor:`${w}20`},children:v.jsx(xh,{size:12,style:{color:w}})}),v.jsxs("div",{className:"min-w-0",children:[v.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white truncate leading-tight",children:t.name}),v.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[v.jsx(_m,{size:10,style:{color:w}}),v.jsxs("span",{className:"text-[10px] text-gray-500 dark:text-zinc-400 font-medium",children:["$",b.toFixed(2),"/mo"]}),S&&v.jsxs("span",{className:"text-[9px] text-orange-600 dark:text-orange-400 font-bold ml-1 flex items-center gap-0.5",children:[v.jsx(NB,{size:8})," PAUSED"]})]})]})]}),v.jsxs("div",{className:"text-right flex-shrink-0",children:[v.jsxs("div",{className:"text-sm font-bold text-gray-900 dark:text-white leading-none",children:["$",E.toFixed(2)]}),v.jsxs("div",{className:"text-[9px] text-gray-400 dark:text-zinc-500 mt-1",children:["of $",m?.toFixed(0)||"0"]})]})]}),m&&m>0&&v.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-800/50 rounded-full h-0.5 overflow-hidden",children:v.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${j}%`,backgroundColor:w}})}),O&&!m&&v.jsx("div",{className:"text-[9px] text-green-600 dark:text-green-400 font-bold mt-0.5",children:" GOAL REACHED"})]})]});return v.jsx(gn.div,{...p(),layout:!A,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},ref:D=>{r&&r(D),u.current=D},onClick:M,style:{background:C,borderColor:N,boxShadow:A?"0 18px 45px rgba(15,23,42,0.35)":"0 1px 2px rgba(15,23,42,0.08)",zIndex:A?50:1,scale:A?1.02:1},className:"rounded-xl py-1.5 px-3 border transition-all cursor-pointer shadow-sm hover:shadow-md select-none active:scale-[0.99] group",children:k})},cf=(t,e=1)=>{const n=t.replace("#",""),r=parseInt(n,16),i=r>>16&255,a=r>>8&255,o=r&255;return`rgba(${i}, ${a}, ${o}, ${e})`},XZ=12,WZ=(t,e,n)=>Math.min(Math.max(t,e),n),KZ=({env:t,budgetedAmount:e,remainingBalance:n,navigate:r,transactions:i,currentMonth:a,setMoveableRef:o,isReorderingActive:c,activelyDraggingId:u,onItemDragStart:d,onLongPressTrigger:h})=>{const p=!!t.isPiggybank,m=t.piggybankConfig?.color||"#3B82F6",b=p?`linear-gradient(135deg, ${cf(m,.18)} 0%, ${cf(m,.08)} 100%)`:void 0,w=p?cf(m,.5):void 0,[S,E]=B.useState(!1),T=sS(L=>{PP(),h(L,t.id)},{threshold:500,cancelOnMovement:25,detect:Co.Touch}),C=i.filter(L=>L.envelopeId===t.id&&L.month===a),N=C.filter(L=>L.type==="Expense"),j=C.filter(L=>L.type==="Income"),O=N.reduce((L,U)=>L+(U.amount||0),0),M=j.reduce((L,U)=>L+(U.amount||0),0),A=M>0?Math.max(0,O/M*100):0,k=L=>{if(S||c){L.preventDefault(),L.stopPropagation();return}r(`/envelope/${t.id}`)};B.useEffect(()=>{u&&u!==t.id&&E(!1)},[u,t.id]),B.useEffect(()=>{u===t.id&&(E(!0),d(t.id))},[u,t.id,d]),B.useEffect(()=>{if(!u&&S){const L=setTimeout(()=>{E(!1)},300);return()=>clearTimeout(L)}},[u,S]);const D=v.jsxs("div",{className:"flex items-center gap-3 w-full",children:[v.jsx("div",{className:"hidden md:flex items-center justify-center p-1 text-gray-400 opacity-0 group-hover:opacity-100 cursor-grab active:cursor-grabbing transition-all duration-200",onMouseDown:L=>h(L,t.id),children:v.jsx(Ff,{size:20})}),v.jsxs("div",{className:"flex-1",children:[v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[p&&v.jsx("span",{className:"w-5 h-5 rounded-full flex items-center justify-center border",style:{borderColor:cf(m,.4),backgroundColor:cf(m,.15),color:m},children:v.jsx(xh,{size:10})}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white leading-tight",children:t.name}),v.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[v.jsx("span",{className:"text-[10px] text-gray-500 dark:text-zinc-400",children:"Budgeted:"}),v.jsxs("span",{className:"text-[10px] font-medium text-gray-700 dark:text-zinc-300",children:["$",e.toFixed(2)]})]})]})]}),v.jsxs("div",{className:"text-right",children:[v.jsxs("span",{className:`text-sm font-bold leading-none ${(typeof n=="number"?n:n.toNumber())<0||100-A<=5?"text-red-500":A>=80?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-emerald-400"}`,children:["$",(typeof n=="number"?n:n.toNumber()).toFixed(2)]}),v.jsx("span",{className:"text-[9px] text-gray-400 dark:text-zinc-500 block uppercase tracking-wider mt-0.5",children:"Remaining"})]})]}),e>0&&v.jsx("div",{className:"mt-1",children:v.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-700/50 rounded-full h-0.5 overflow-hidden",children:v.jsx("div",{className:`h-full transition-all duration-300 ease-out ${(typeof n=="number"?n:n.toNumber())<0||100-A<=5?"bg-red-500":A>=80?"bg-yellow-500":"bg-green-400"}`,style:{width:`${Math.max(100-A,2)}%`}})})})]})]}),V=u===t.id;return v.jsx(gn.div,{...T(),layout:!V,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},"data-envelope-id":t.id,ref:o(t.id),onClick:k,style:{boxShadow:V?"0 18px 45px rgba(15,23,42,0.35)":"0 1px 2px rgba(15,23,42,0.08)",background:b,borderColor:w,cursor:V?"grabbing":"pointer",zIndex:V?50:1,scale:V?1.02:1},className:`py-1.5 px-3 rounded-xl active:scale-[0.99] transition-all select-none border group ${p?"bg-white/70 dark:bg-zinc-800/80":"bg-gray-50 dark:bg-zinc-800 border-transparent"}`,children:D})},JR=({category:t,envelopes:e,allocations:n,currentMonth:r,transactions:i,navigate:a,getEnvelopeBalance:o,onReorderGlobal:c})=>{if(e.length===0&&t.id==="uncategorized")return null;const[u,d]=B.useState(e),h=B.useRef(e),[p,m]=B.useState(!1),[b,w]=B.useState(null),S=B.useRef(!1),E=B.useRef(null),T=B.useRef({}),C=B.useRef({}),N=B.useRef({activeId:null,startIndex:0,currentIndex:0,itemHeight:0});B.useEffect(()=>{p||(d(e),h.current=e)},[e,p]);const j=B.useCallback((M,A)=>{const k=C.current[A];if(k){S.current=!0;const D=M.nativeEvent||M;k.dragStart(D)}},[]),O=B.useCallback(M=>A=>{A?T.current[M]=A:delete T.current[M]},[]);return B.useEffect(()=>{const M=()=>{Object.values(C.current).forEach(D=>D?.destroy()),C.current={}};if(!u.length)return;const A=()=>{u.forEach(D=>{const V=T.current[D.id];if(!V||!E.current)return;const L=new MP(E.current,{target:V,draggable:!0,throttleDrag:0,snappable:!0,snapThreshold:5,snapDirections:{top:!0,bottom:!0},elementSnapDirections:{top:!0,bottom:!0},clickable:!0,dragArea:!1,hideDefaultLines:!0,renderDirections:[]});L.on("dragStart",P=>{if(!S.current){P.stop();return}const K=P.inputEvent.target;if(K.closest(".js-budget-target")||K.tagName==="INPUT"){P.stop();return}const X=h.current.findIndex(te=>te.id===D.id),q=P.target,Q=q.getBoundingClientRect();w(D.id),N.current={activeId:D.id,startIndex:X,currentIndex:X,itemHeight:Q.height+XZ},q.style.transition="none",q.style.boxShadow="0 18px 45px rgba(15,23,42,0.35)",q.style.zIndex="20",m(!0)});let U=null;L.on("drag",P=>{const K=P.target;U!==null&&cancelAnimationFrame(U),U=requestAnimationFrame(()=>{const X=N.current;if(X.activeId!==D.id)return;const q=P.beforeTranslate[1];K.style.transform=`translateY(${q}px)`,K.style.transition="none";const{itemHeight:Q,startIndex:te}=X,se=Math.round(q/Q),G=WZ(te+se,0,h.current.length-1);G!==X.currentIndex&&(X.currentIndex=G,h.current.forEach((F,Y)=>{if(F.id===D.id)return;const Z=T.current[F.id];if(!Z)return;let W=0;te<G&&Y>te&&Y<=G?W=-Q:te>G&&Y>=G&&Y<te&&(W=Q),Z.style.transform=W?`translateY(${W}px)`:"",Z.style.transition="transform 0.2s ease"})),U=null})}),L.on("dragEnd",P=>{U!==null&&(cancelAnimationFrame(U),U=null);const K=P.target,{startIndex:X,currentIndex:q}=N.current;if(K.style.transform="",K.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease",K.style.boxShadow="",h.current.forEach(Q=>{const te=T.current[Q.id];te&&(te.style.transform="",te.style.transition="")}),X!==q){const Q=[...h.current],[te]=Q.splice(X,1);Q.splice(q,0,te),h.current=Q,d(Q),c(Q.map(se=>se.id))}setTimeout(()=>{K.style.zIndex="",w(null),m(!1),S.current=!1},300)}),L.on("click",()=>{const P=window.event?.target;P&&(P.closest(".js-budget-target")||P.tagName==="INPUT")||a(`/envelope/${D.id}`)}),C.current[D.id]=L})},k=window.setTimeout(A,80);return()=>{clearTimeout(k),M()}},[u,a,c]),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-3 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-2 px-1",children:[v.jsx("h2",{className:"text-base font-bold text-gray-900 dark:text-white flex items-center gap-2",children:t.name}),v.jsx("button",{onClick:()=>a(t.id==="uncategorized"?"/add-envelope":`/add-envelope?categoryId=${t.id}`),className:"text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 p-1 rounded-full transition-colors",title:`Add to ${t.name}`,children:v.jsx(wh,{size:20})})]}),v.jsx("div",{ref:E,className:"space-y-2 relative",children:u.length===0?v.jsx("div",{className:"py-2 text-center border border-dashed border-gray-100 dark:border-zinc-800 rounded-xl",children:v.jsx("p",{className:"text-[10px] text-gray-400 dark:text-zinc-500",children:"Empty category"})}):v.jsx(ii,{initial:!1,children:u.map(M=>{const k=(n[r]||[]).find(V=>V.envelopeId===M.id)?.budgetedAmount||0,D=o(M.id);return M.isPiggybank?v.jsx(YZ,{piggybank:M,balance:D,onNavigate:V=>a(`/envelope/${V}`),setMoveableRef:O(M.id),isReorderingActive:p,activelyDraggingId:b,onItemDragStart:()=>{},onLongPressTrigger:j},M.id):v.jsx(KZ,{env:M,budgetedAmount:k,remainingBalance:D,navigate:a,transactions:i,currentMonth:r,setMoveableRef:O,isReorderingActive:p,activelyDraggingId:b,onItemDragStart:()=>{},onLongPressTrigger:j},M.id)})})})]})},QZ=()=>{const{visibleEnvelopes:t,piggybanks:e,incomeSources:n,availableToBudget:r,currentMonth:i,allocations:a,transactions:o,isLoading:c,isInitialLoading:u,showTimeoutMessage:d,getEnvelopeBalance:h,deleteIncomeSource:p}=UZ(),{setMonth:m,setIsOnboardingActive:b,isOnboardingActive:w,isOnboardingCompleted:S,completeOnboarding:E,categories:T,fetchCategories:C,envelopes:N,reorderEnvelopes:j}=Xt(),O=ia(),[M,A]=B.useState(!1),[k,D]=B.useState("add"),[V,L]=B.useState(null),[U,P]=B.useState(!1),[K,X]=B.useState(!1),q=B.useRef(null),Q=B.useRef(null),[te,se]=B.useState(0);B.useEffect(()=>{T.length===0&&C()},[T.length,C]);const G=B.useMemo(()=>{const ce={},xe=[];return T.forEach(ae=>ce[ae.id]=[]),[...t,...e].sort((ae,Ee)=>(ae.orderIndex??0)-(Ee.orderIndex??0)).forEach(ae=>{ae.categoryId&&ce[ae.categoryId]?ce[ae.categoryId].push(ae):xe.push(ae)}),{groups:ce,uncategorized:xe}},[T,t,e]),F=B.useCallback(async ce=>{const xe=[...N.map(Ne=>Ne.id)],Re=new Set(ce),ae=[];let Ee=0;xe.forEach(Ne=>{Re.has(Ne)?ae.push(ce[Ee++]):ae.push(Ne)}),await j(ae)},[N,j]);B.useLayoutEffect(()=>{if(w)return;const ce=Q.current;if(!ce)return;const xe=()=>se(ce.getBoundingClientRect().height);xe();const Re=new ResizeObserver(()=>xe());return Re.observe(ce),window.addEventListener("resize",xe),()=>{window.removeEventListener("resize",xe),Re.disconnect()}},[w,i,n,a,t,e,r]),B.useEffect(()=>{if(!u&&!c){const ce=setTimeout(()=>{if(w)return;if(S){b(!1);const ae=(n[i]||[]).length===0&&(a[i]||[]).length===0,Ee=Object.keys(n).some(Ne=>(n[Ne]||[]).length>0)||Object.keys(a).some(Ne=>(a[Ne]||[]).length>0);X(!!(ae&&Ee));return}const xe=(n[i]||[]).length===0&&(a[i]||[]).length===0,Re=Object.keys(n).some(ae=>(n[ae]||[]).length>0)||Object.keys(a).some(ae=>(a[ae]||[]).length>0);xe?Re?(X(!0),b(!1)):(b(!0),X(!1)):(X(!1),b(!1))},500);return()=>clearTimeout(ce)}},[u,c,i,n,a,S]);const Y=()=>{D("add"),L(null),A(!0)},Z=ce=>{q.current&&clearTimeout(q.current),!U&&(D("edit"),L(ce),A(!0))},W=ce=>{q.current&&clearTimeout(q.current),P(!0),p(ce),setTimeout(()=>P(!1),500)},le=()=>{A(!1),L(null)},ie=async()=>{X(!1);const{copyPreviousMonthAllocations:ce}=Xt.getState();await ce(i)},pe=()=>{E(),b(!1)};return u?v.jsx(nM,{message:d?"Still loading...":"Loading your budget...",showTimeout:d}):v.jsxs(v.Fragment,{children:[v.jsx("style",{dangerouslySetInnerHTML:{__html:".moveable-control, .moveable-origin, .moveable-line { display: none !important; }"}}),v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-20",children:[!w&&v.jsx("header",{ref:Q,className:"fixed top-0 left-0 right-0 z-50 bg-white dark:bg-zinc-900 border-b border-gray-100 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+4px)] pb-1",children:v.jsx(FZ,{currentMonth:i,onMonthChange:ce=>{X(!1),m(ce)},budgetStatus:{amount:r,totalIncome:(n[i]||[]).reduce((ce,xe)=>ce+xe.amount,0),totalAllocated:(a[i]||[]).filter(ce=>t.some(xe=>xe.id===ce.envelopeId)||e.some(xe=>xe.id===ce.envelopeId)).reduce((ce,xe)=>ce+xe.budgetedAmount,0)}})}),v.jsxs("div",{className:"pb-[calc(8rem+env(safe-area-inset-bottom))] px-4 max-w-4xl mx-auto space-y-4",style:w?void 0:{paddingTop:Math.max(0,te+16)},children:[w?v.jsx(qZ,{currentMonth:i,onComplete:pe}):K?v.jsx(GZ,{currentMonth:i,onCopy:ie}):v.jsxs(v.Fragment,{children:[v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-3 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-2 px-1",children:[v.jsx("h2",{className:"text-base font-bold text-gray-900 dark:text-white",children:"Income Sources"}),v.jsx("button",{onClick:Y,className:"text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 p-1 rounded-full transition-colors",children:v.jsx(wh,{size:20})})]}),(n[i]||[]).length===0?v.jsx("div",{className:"text-center py-4",children:v.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-[10px]",children:"No income sources yet."})}):v.jsx("div",{className:"space-y-2",children:v.jsx(ii,{initial:!1,mode:"popLayout",children:(n[i]||[]).map(ce=>v.jsx(gn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(nv,{onDelete:()=>W(ce),children:v.jsxs("div",{className:"flex justify-between items-center py-2 px-3 bg-gray-50 dark:bg-zinc-800 rounded-xl cursor-pointer",onClick:()=>Z(ce),children:[v.jsx("div",{className:"flex-1",children:v.jsx("p",{className:"text-xs font-medium text-gray-900 dark:text-white",children:ce.name})}),v.jsxs("p",{className:"text-xs font-bold text-green-600 dark:text-emerald-400",children:["$",ce.amount.toFixed(2)]})]})})},ce.id))})})]}),T.map(ce=>v.jsx(JR,{category:ce,envelopes:G.groups[ce.id]||[],allocations:a,currentMonth:i,transactions:o,navigate:O,getEnvelopeBalance:h,onReorderGlobal:F},ce.id)),G.uncategorized.length>0&&v.jsx(JR,{category:{id:"uncategorized",name:"Uncategorized"},envelopes:G.uncategorized,allocations:a,currentMonth:i,transactions:o,navigate:O,getEnvelopeBalance:h,onReorderGlobal:F}),T.length===0&&G.uncategorized.length===0&&v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800 text-center py-12",children:[v.jsx(f0,{className:"w-12 h-12 text-gray-300 dark:text-zinc-700 mx-auto mb-3"}),v.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-sm mb-4",children:"No envelopes yet."}),v.jsx("button",{onClick:()=>O("/add-envelope"),className:"text-blue-600 dark:text-blue-300 font-medium hover:text-blue-700 dark:hover:text-blue-200 transition-colors",children:"Create First Envelope"})]})]}),v.jsx($Z,{isVisible:M,onClose:le,mode:k,initialIncomeSource:V})]})]})]})},ZZ=[],XP=({selectedCard:t,onCardSelect:e,initialCards:n=ZZ,disabled:r=!1,isUserSelected:i=!1})=>{const a=Xt(G=>G.appSettings),o=Xt(G=>G.updateAppSettings),[c,u]=B.useState(n.length>0?n[0]:{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}),[d,h]=B.useState(!1),[p,m]=B.useState(!1),[b,w]=B.useState(n),[S,E]=B.useState(null),[T,C]=B.useState({name:"",network:"Visa",last4:"",color:"#3b82f6"}),[N,j]=B.useState(null),[O,M]=B.useState(null);B.useEffect(()=>{a?.paymentSources&&(w(a.paymentSources),a.paymentSources.length>0&&!t&&u(a.paymentSources[0]))},[a,t]);const A=t||c;B.useEffect(()=>{!t&&e&&b.length>0&&e(b[0])},[t,e,b]);const k=G=>{r||(G.id==="add-new"?m(!0):(u(G),e?.(G),h(!1)))},D=()=>{r||h(!d)},V=G=>{r||E(G)},L=async()=>{if(S&&!r){const G=b.filter(F=>F.id!==S.id);if(w(G),A?.id===S.id){const F=G.length>0?G[0]:{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"};u(F),e?.(F)}E(null),h(!1);try{await o({paymentSources:G})}catch(F){console.error("Failed to delete card from app settings:",F),w(b),alert("Failed to delete card. Please try again.");return}}},U=()=>{E(null)},P=async()=>{if(r)return;const G=!["Cash","Venmo"].includes(T.network);if(G&&(T.last4.length!==4||!/^\d{4}$/.test(T.last4))){alert("Please enter exactly 4 digits for the last 4 digits");return}if(!T.name.trim()){alert("Please enter a name");return}const F={id:`custom-${Date.now()}`,name:T.name.trim(),network:T.network,last4:G?T.last4:void 0,color:T.color},Y=[...b,F];w(Y),u(F),e?.(F),m(!1),h(!1);try{await o({paymentSources:Y})}catch(Z){console.error("Failed to save card to app settings:",Z),w(b),u(A),alert("Failed to save card. Please try again.");return}C({name:"",network:"Visa",last4:"",color:"#3b82f6"})},K=(G,F)=>{r||(j(F),G.dataTransfer.effectAllowed="move")},X=(G,F)=>{r||!N||(G.preventDefault(),G.dataTransfer.dropEffect="move",M(F))},q=()=>{M(null)},Q=async(G,F)=>{if(r||!N)return;G.preventDefault(),M(null);const Y=b.findIndex(W=>W.id===N.id);if(Y===-1||Y===F)return;const Z=[...b];Z.splice(Y,1),Z.splice(F,0,N),w(Z),j(null);try{await o({paymentSources:Z})}catch(W){console.error("Failed to reorder cards:",W),w(b),alert("Failed to reorder cards. Please try again.")}},te=()=>{j(null),M(null)},se=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#6b7280","#0f4c81","#fdbb30","#7fb5b5","#232f3e","#e3e3e3"];return v.jsxs(v.Fragment,{children:[v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Payment Method",!i&&v.jsx("span",{className:"ml-2 text-xs text-blue-600 dark:text-blue-400 font-medium",children:"(Default selected)"})]}),v.jsxs("div",{onClick:D,className:`flex items-center gap-4 p-3 border rounded-lg transition-colors ${r?"cursor-not-allowed opacity-50 border-gray-300 dark:border-gray-600":"cursor-pointer hover:bg-gray-50 dark:hover:bg-zinc-800 border-gray-300 dark:border-gray-600"} ${i?"":"ring-2 ring-blue-200 dark:ring-blue-800"}`,children:[v.jsxs("div",{className:"w-[70px] h-[40px] rounded-lg flex flex-col justify-between p-[6px] shadow-lg text-white font-mono text-xs",style:{backgroundColor:A.color},children:[v.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:A.network}),v.jsx("span",{className:"text-left text-[9px] leading-none",children:["Cash","Venmo"].includes(A.network)?A.network==="Cash"?"$$$":"@":` ${A.last4||""}`})]}),v.jsxs("div",{className:"flex-1",children:[v.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:A.name}),v.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Cash","Venmo"].includes(A.network)?A.network:`(...${A.last4})`})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"text-gray-400",children:d?"":""}),!i&&v.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",title:"Default payment method - tap to change"})]})]}),d&&v.jsxs("div",{className:"card-stack-dropdown",children:[b.length>1&&v.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2 text-center",children:" Drag and drop cards to reorder"}),v.jsx("div",{className:"card-stack",children:v.jsx(ii,{initial:!1,mode:"popLayout",children:[...b,{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}].map((G,F)=>{const Y=A.id===G.id,Z=G.id==="add-new",W=["Cash","Venmo"].includes(G.network);return v.jsx(gn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(nv,{onDelete:()=>!Z&&!r&&V(G),threshold:-80,children:v.jsxs("div",{className:`card-stack-item ${Y?"selected":""} ${Z?"add-new-card":""} ${N?.id===G.id?"dragging":""} ${O===F?"drag-over":""}`,onClick:()=>k(G),draggable:!Z&&!r,onDragStart:Z?void 0:le=>K(le,G),onDragOver:Z?void 0:le=>X(le,F),onDragLeave:Z?void 0:q,onDrop:Z?void 0:le=>Q(le,F),onDragEnd:Z?void 0:te,style:{backgroundColor:Z?"#f3f4f6":G.color,color:Z?"#374151":G.color==="#e3e3e3"?"#000":"#fff",zIndex:b.length-F,opacity:N?.id===G.id?.5:1,transform:O===F?"scale(1.02)":"scale(1)"},children:[v.jsxs("div",{className:"card-header",children:[v.jsx("span",{className:"card-network",children:Z?"":G.network}),Y&&!Z&&v.jsx("span",{className:"selected-indicator",children:""})]}),v.jsxs("div",{className:"card-details",children:[v.jsx("div",{className:"card-name",children:G.name}),v.jsx("div",{className:"card-number",children:Z?"":W?G.network==="Cash"?"$$$":"@":` ${G.last4}`})]}),Z&&v.jsx("div",{className:"add-icon",children:v.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[v.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),v.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})})},G.id)})})})]})]}),p&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-md mx-4",children:[v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Add New Payment Method"}),v.jsx("button",{type:"button",onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:""})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Name"}),v.jsx("input",{type:"text",value:T.name,onChange:G=>C({...T,name:G.target.value}),placeholder:"e.g., Wallet Cash, My Venmo",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type"}),v.jsxs("select",{value:T.network,onChange:G=>C({...T,network:G.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[v.jsx("option",{value:"Visa",children:"Visa"}),v.jsx("option",{value:"Mastercard",children:"Mastercard"}),v.jsx("option",{value:"Amex",children:"Amex"}),v.jsx("option",{value:"Cash",children:"Cash"}),v.jsx("option",{value:"Venmo",children:"Venmo"})]})]}),!["Cash","Venmo"].includes(T.network)&&v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Last 4 Digits"}),v.jsx("input",{type:"text",value:T.last4,onChange:G=>C({...T,last4:G.target.value.replace(/\D/g,"").slice(0,4)}),placeholder:"1234",maxLength:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:se.map(G=>v.jsx("button",{type:"button",onClick:()=>C({...T,color:G}),className:`w-full h-10 rounded-lg border-2 transition-all ${T.color===G?"border-blue-500 scale-110":"border-gray-300 dark:border-gray-600"}`,style:{backgroundColor:G}},G))})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Preview"}),v.jsxs("div",{className:"w-full h-20 rounded-lg flex flex-col justify-between p-3 shadow-lg text-white font-mono text-xs",style:{backgroundColor:T.color},children:[v.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:T.network}),v.jsx("span",{className:"text-left text-[9px] leading-none",children:["Cash","Venmo"].includes(T.network)?T.network==="Cash"?"$$$":"@":` ${T.last4||"0000"}`})]})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{type:"button",onClick:()=>m(!1),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"button",onClick:P,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors",children:"Add"})]})]})]})}),S&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-sm mx-4",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center mx-auto mb-4",children:v.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Delete Card"}),v.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Are you sure you want to delete ",v.jsx("span",{className:"font-medium",children:S.name}),"?"]}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{type:"button",onClick:U,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"button",onClick:L,className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md transition-colors",children:"Delete"})]})]})})})]})},WP=({isVisible:t,onClose:e,mode:n,currentEnvelope:r,initialTransaction:i})=>{const{addTransaction:a,updateTransaction:o,deleteTransaction:c,currentMonth:u}=Xt(),[d,h]=B.useState(""),[p,m]=B.useState(""),[b,w]=B.useState(""),[S,E]=B.useState(new Date().toISOString().split("T")[0]),[T,C]=B.useState(null);B.useEffect(()=>{if(t)if(n==="edit"&&i){h(i.amount.toString()),m(i.merchant||""),w(i.description),C(i.paymentMethod||null);try{const A=new Date(i.date);isNaN(A.getTime())?(console.warn("Invalid date in transaction:",i.date),E(new Date().toISOString().split("T")[0])):E(A.toISOString().split("T")[0])}catch(A){console.error("Error parsing transaction date:",A),E(new Date().toISOString().split("T")[0])}}else h(""),m(""),w(""),E(new Date().toISOString().split("T")[0])},[t,n,i]);const N=async A=>{A.preventDefault();const k=parseFloat(d);if(isNaN(k)||k<=0){console.log(" Invalid amount:",d);return}console.log(" Saving transaction:",{mode:n,amount:k,note:b,date:S,envelopeId:r.id,paymentMethod:T});try{const D=new Date(S),V=`${D.getFullYear()}-${(D.getMonth()+1).toString().padStart(2,"0")}`;if(V!==u){const L=`This transaction date (${V}) does not match the current budget month (${u}). Are you sure you want to save it?`;if(!window.confirm(L))return}n==="add"?(console.log(" Adding income transaction"),await a({amount:k,description:b,merchant:p||void 0,date:new Date(S).toISOString(),envelopeId:r.id,type:"Income",reconciled:!1,paymentMethod:T||void 0})):n==="spend"?(console.log(" Adding expense transaction"),await a({amount:k,description:b,merchant:p||void 0,date:new Date(S).toISOString(),envelopeId:r.id,type:"Expense",reconciled:!1,paymentMethod:T||void 0})):n==="edit"&&i&&(console.log(" Updating transaction"),await o({...i,amount:k,description:b,merchant:p||void 0,date:new Date(S).toISOString(),paymentMethod:T||void 0})),console.log(" Transaction saved successfully"),e()}catch(D){console.error(" Error saving transaction:",D),alert("Failed to save transaction: "+(D instanceof Error?D.message:"Unknown error"))}},j=()=>{!i||!i.id||window.confirm("Are you sure you want to delete this transaction?")&&(c(i.id),e())},O=n==="add"?"Add Money":n==="spend"?"Spend Money":"Edit Transaction",M=n==="add"?"text-green-500":"text-red-500";return v.jsx(ii,{children:t&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(gn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),v.jsxs(gn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden relative z-10",children:[v.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),v.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:O}),v.jsx("button",{onClick:N,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!d||parseFloat(d)<=0||i?.isAutomatic,children:i?.isAutomatic?"":"Save"})]}),v.jsxs("form",{onSubmit:N,className:"p-6 space-y-6",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${M}`,children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:d,onChange:A=>{const k=A.target.value.replace(/\D/g,"");if(!k){h("");return}const V=(parseInt(k,10)/100).toFixed(2);h(V)},onKeyDown:A=>{(A.key==="e"||A.key==="E"||A.key==="+"||A.key==="-")&&A.preventDefault()},placeholder:"0.00",autoFocus:!0,disabled:i?.isAutomatic,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${M} placeholder-gray-700 ${i?.isAutomatic?"cursor-not-allowed opacity-80":""}`})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),v.jsx("input",{type:"text",value:p,onChange:A=>m(A.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none",disabled:i?.isAutomatic})]}),!i?.isAutomatic&&v.jsx(XP,{selectedCard:T,onCardSelect:C}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),v.jsx("input",{type:"text",value:b,onChange:A=>w(A.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none",disabled:i?.isAutomatic})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const A=new Date(S);return`${A.getFullYear()}-${(A.getMonth()+1).toString().padStart(2,"0")}`!==u?v.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[v.jsx(yu,{size:14}),v.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),v.jsx("input",{type:"date",value:S,onChange:A=>{console.log("Date changed to:",A.target.value),E(A.target.value)},required:!0,disabled:i?.isAutomatic,className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark] disabled:opacity-80"})]}),n==="edit"&&!i?.isAutomatic&&v.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-zinc-800",children:v.jsxs("button",{type:"button",onClick:j,className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-50 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-200 dark:border-zinc-800",children:[v.jsx(xD,{className:"w-5 h-5 mr-2"}),"Delete Transaction"]})})]})]})]})})},JZ=({isVisible:t,onClose:e,sourceEnvelope:n})=>{const{envelopes:r,transferFunds:i}=Xt(),[a,o]=B.useState(""),[c,u]=B.useState(""),[d,h]=B.useState(""),[p,m]=B.useState(new Date().toISOString().split("T")[0]),b=r.filter(E=>E.id!==n.id);B.useEffect(()=>{if(!t)return;const E=window.setTimeout(()=>{o(""),u(""),h(""),m(new Date().toISOString().split("T")[0])},0);return()=>window.clearTimeout(E)},[t]);const w=E=>{E.preventDefault();const T=parseFloat(c);isNaN(T)||T<=0||!a||(i(n.id,a,T,d,new Date(p)),e())},S=r.find(E=>E.id===a);return v.jsx(ii,{children:t&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(gn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),v.jsxs(gn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden relative z-10",children:[v.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),v.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:"Transfer Money"}),v.jsx("button",{onClick:w,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!c||parseFloat(c)<=0||!a,children:"Transfer"})]}),v.jsxs("form",{onSubmit:w,className:"p-6 space-y-6",children:[v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"From"}),v.jsx("div",{className:"text-gray-900 dark:text-white font-medium",children:n.name})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"To"}),v.jsxs("select",{value:a,onChange:E=>o(E.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none cursor-pointer",children:[v.jsx("option",{value:"",className:"bg-white dark:bg-zinc-900",children:"Select envelope..."}),b.map(E=>v.jsx("option",{value:E.id,className:"bg-white dark:bg-zinc-900",children:E.name},E.id))]})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl text-blue-600 dark:text-blue-400",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:c,onChange:E=>{const T=E.target.value.replace(/\D/g,"");if(!T){u("");return}const N=(parseInt(T,10)/100).toFixed(2);u(N)},onKeyDown:E=>{(E.key==="e"||E.key==="E"||E.key==="+"||E.key==="-")&&E.preventDefault()},placeholder:"0.00",autoFocus:!0,className:"bg-transparent text-4xl font-bold text-center w-40 focus:outline-none text-blue-600 dark:text-blue-400 placeholder-gray-400 dark:placeholder-gray-600"})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note (Optional)"}),v.jsx("input",{type:"text",value:d,onChange:E=>h(E.target.value),placeholder:"What is this transfer for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Date"}),v.jsx("input",{type:"date",value:p,onChange:E=>m(E.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),S&&c&&parseFloat(c)>0&&v.jsxs("div",{className:"text-center text-sm text-gray-500 dark:text-zinc-400 pt-2 border-t border-gray-200 dark:border-zinc-800",children:["Moving ",v.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-bold",children:["$",parseFloat(c).toFixed(2)]})," from"," ",v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:n.name})," to"," ",v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:S.name})]})]})]})]})})},eJ=({isOpen:t,onClose:e,onSave:n,existingPiggybank:r})=>{const[i,a]=B.useState(""),[o,c]=B.useState(""),[u,d]=B.useState(""),[h,p]=B.useState("#3B82F6"),[m,b]=B.useState("piggy-bank"),[w,S]=B.useState(!1),[E,T]=B.useState(!1);B.useEffect(()=>{r?(a(r.name),c(r.piggybankConfig?.targetAmount?.toString()||""),d(r.piggybankConfig?.monthlyContribution.toString()||"0"),p(r.piggybankConfig?.color||"#3B82F6"),b(r.piggybankConfig?.icon||"piggy-bank"),S(r.piggybankConfig?.paused||!1)):(a(""),c(""),d(""),p("#3B82F6"),b("piggy-bank"),S(!1))},[r,t]);const C=async j=>{if(j.preventDefault(),!(!i.trim()||!u)){T(!0);try{const O={name:i.trim(),isPiggybank:!0,piggybankConfig:{monthlyContribution:parseFloat(u),color:h,icon:m,paused:w}};o&&parseFloat(o)>0&&(O.piggybankConfig.targetAmount=parseFloat(o)),r&&(O.id=r.id,O.currentBalance=r.currentBalance,O.lastUpdated=new Date().toISOString(),O.isActive=r.isActive,O.orderIndex=r.orderIndex,O.userId=r.userId),await n(O),e()}catch(O){console.error("Error saving piggybank:",O),alert("Failed to save piggybank")}finally{T(!1)}}},N=[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#F59E0B",label:"Amber"},{value:"#EF4444",label:"Red"},{value:"#8B5CF6",label:"Purple"},{value:"#EC4899",label:"Pink"}];return v.jsx(ii,{children:t&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(gn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),v.jsxs(gn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"sticky top-0 bg-white dark:bg-zinc-900 border-b border-gray-200 dark:border-zinc-800 px-6 py-4 flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center",children:v.jsx(xh,{size:20,className:"text-blue-600 dark:text-blue-400"})}),v.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:r?"Edit Piggybank":"New Piggybank"})]}),v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:v.jsx(h0,{size:24})})]}),v.jsxs("form",{onSubmit:C,className:"p-6 space-y-5",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"piggybank-name",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Piggybank Name *"}),v.jsx("input",{type:"text",id:"piggybank-name",value:i,onChange:j=>a(j.target.value),placeholder:"e.g. Vacation Fund, Emergency Savings",className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:!0,autoFocus:!0})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"monthly-contribution",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Monthly Auto-Contribution *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",id:"monthly-contribution",value:u,onChange:j=>{const O=j.target.value.replace(/\D/g,"");if(!O){d("");return}const A=(parseInt(O,10)/100).toFixed(2);d(A)},placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:!0})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"This amount will be automatically added each month and deducted from Available to Budget"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Target Goal (Optional)"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",id:"target-amount",value:o,onChange:j=>{const O=j.target.value.replace(/\D/g,"");if(!O){c("");return}const A=(parseInt(O,10)/100).toFixed(2);c(A)},placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Set a savings goal to track progress"})]}),v.jsx("div",{className:"space-y-2",children:v.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[v.jsx("input",{type:"checkbox",checked:w,onChange:j=>S(j.target.checked),className:"w-5 h-5 rounded border-gray-300 dark:border-zinc-700 text-blue-600 focus:ring-2 focus:ring-blue-500"}),v.jsxs("div",{children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Pause auto-contributions"}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Monthly contributions will be skipped while paused"})]})]})}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:N.map(j=>v.jsx("button",{type:"button",onClick:()=>p(j.value),className:`w-full aspect-square rounded-lg transition-all ${h===j.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-zinc-900":"hover:scale-110"}`,style:{backgroundColor:j.value},title:j.label},j.value))})]}),v.jsxs("div",{className:"pt-4 flex gap-3",children:[v.jsx("button",{type:"button",onClick:e,className:"flex-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 font-semibold bg-white dark:bg-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",disabled:E,children:"Cancel"}),v.jsx("button",{type:"submit",disabled:!i.trim()||!u||E,className:`flex-1 py-3 px-4 rounded-xl font-semibold shadow-sm text-white transition-colors ${i.trim()&&u&&!E?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-300 dark:bg-zinc-600 cursor-not-allowed"}`,children:E?"Saving...":r?"Update":"Create"})]})]})]})]})})},tJ=t=>{if(!t)return"No Date";try{let e;return t&&typeof t=="object"&&t.toDate&&typeof t.toDate=="function"?e=t.toDate():typeof t=="number"?t<1e10?e=new Date((t+978307200)*1e3):e=new Date(t):e=new Date(t),isNaN(e.getTime())?"Invalid Date":new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(e)}catch(e){return console.error("Date error:",e),"Error"}},nJ=t=>{const e=typeof t=="string"?parseFloat(t):t;return typeof e!="number"||isNaN(e)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.abs(e))},KP=({transaction:t,envelopeName:e,onReconcile:n,onEdit:r})=>{if(!t)return null;console.log(" Transaction payment method:",t.paymentMethod);const i=t.type==="Income",a=t.type==="Expense";let o="text-gray-900 dark:text-white";return i&&(o="text-green-600 dark:text-green-400"),a&&(o="text-red-600 dark:text-red-400"),v.jsxs("div",{onClick:r,className:"flex items-center justify-between p-4 bg-white dark:bg-zinc-900 active:bg-gray-50 dark:active:bg-zinc-800 active:scale-[0.99] transition-all cursor-pointer group border-b border-gray-100 dark:border-zinc-800 last:border-0",children:[v.jsxs("div",{className:"flex flex-col gap-1 overflow-hidden",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"font-semibold text-gray-900 dark:text-white truncate",children:t.merchant||t.description||"No Description"}),t.reconciled&&v.jsx("span",{className:"text-[10px] bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 px-1.5 py-0.5 rounded-full font-bold uppercase tracking-wide",children:"R"})]}),t.merchant&&t.description&&t.description!==t.merchant&&v.jsx("div",{className:"text-xs text-gray-600 dark:text-zinc-400 truncate",children:t.description}),v.jsxs("div",{className:"text-xs text-gray-500 dark:text-zinc-500 flex items-center gap-1 flex-wrap",children:[v.jsx("span",{children:tJ(t.date)}),e&&v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""}),v.jsx("span",{className:"text-blue-500 dark:text-blue-400 truncate max-w-[150px]",children:e})]}),t.paymentMethod&&v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""}),v.jsxs("span",{className:"flex items-center gap-1",children:[v.jsx("span",{className:"w-[12px] h-[8px] rounded-[2px] flex-shrink-0",style:{backgroundColor:t.paymentMethod.color}}),v.jsx("span",{className:"truncate max-w-[80px]",children:t.paymentMethod.name})]})]})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("div",{className:`font-bold font-mono whitespace-nowrap ${o}`,children:[a?"-":i?"+":"",nJ(t.amount)]}),n?v.jsx("button",{type:"button",onClick:c=>{c.stopPropagation(),n()},className:"p-1.5 rounded-full border border-transparent hover:border-green-200 dark:hover:border-green-500 transition-colors","aria-label":t.reconciled?"Mark as unreconciled":"Mark as reconciled",children:t.reconciled?v.jsx(ps,{className:"text-green-500",size:20}):v.jsx(CC,{className:"text-gray-400",size:20})}):v.jsx("span",{children:t.reconciled?v.jsx(ps,{className:"text-green-500",size:20}):v.jsx(CC,{className:"text-gray-400",size:20})})]})]})},rx=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t),rJ=()=>{const{id:t}=jL(),{envelopes:e,transactions:n,fetchData:r,isLoading:i,deleteEnvelope:a,renameEnvelope:o,updateTransaction:c,deleteTransaction:u,restoreTransaction:d,getEnvelopeBalance:h,currentMonth:p,allocations:m,incomeSources:b,setEnvelopeAllocation:w,updatePiggybankContribution:S,updateEnvelope:E}=Xt(),{showToast:T}=oc(),C=ia(),N=ra(),[j,O]=B.useState(!1),[M,A]=B.useState(!1),[k,D]=B.useState(!1),[V,L]=B.useState(null),[U,P]=B.useState(!1),[K,X]=B.useState(!1),[q,Q]=B.useState(""),te=B.useRef(null),se=B.useRef(!1);B.useEffect(()=>{e.length===0&&r()},[]);const G=e.find(ae=>ae.id===t),F=async ae=>{if(G)try{const Ee={...G,...ae,id:G.id,userId:G.userId,currentBalance:G.currentBalance,lastUpdated:new Date().toISOString(),isActive:G.isActive,orderIndex:G.orderIndex};await E(Ee),T("Piggybank updated successfully","success"),P(!1)}catch(Ee){console.error("Failed to update piggybank:",Ee),T("Failed to update piggybank","error")}},Y=G?.isPiggybank?G.piggybankConfig?.monthlyContribution||0:m[p]?.find(ae=>ae.envelopeId===t)?.budgetedAmount||0;B.useEffect(()=>{K&&(Q(Y.toString()),setTimeout(()=>{te.current?.focus(),te.current?.select()},50))},[K,Y]);const Z=ae=>{const Ee=(b[p]||[]).reduce((Ve,Se)=>Ve+Se.amount,0),Ne=m[p]||[];let Oe=Ne.map(Ve=>G&&Ve.envelopeId===G.id&&ae!==void 0?{...Ve,budgetedAmount:ae}:Ve).filter(Ve=>{const Se=e.find(Le=>Le.id===Ve.envelopeId);return Se?Se.isActive!==!1:!1}).reduce((Ve,Se)=>Ve+Se.budgetedAmount,0);return ae!==void 0&&G&&(Ne.some(Se=>Se.envelopeId===G.id)||(Oe+=ae)),Ee-Oe},le=K?Z(parseFloat(q)||0):Z(),ie=async()=>{if(!G||se.current)return;const ae=parseFloat(q);if(isNaN(ae)||ae<0){T("Please enter a valid positive number","error");return}se.current=!0;try{G.isPiggybank?await S(G.id,ae):await w(G.id,ae),X(!1)}catch(Ee){console.error("Failed to save budget:",Ee),T("Failed to update budget","error")}finally{se.current=!1}};if(!G)return i?v.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:v.jsx("p",{children:"Loading envelope..."})}):v.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:v.jsx("p",{children:"Envelope not found."})});if(G.isPiggybank){const ae=n.filter(Ee=>Ee.envelopeId===G.id);console.log(" Piggybank:",G.name),console.log(" Created at:",G.createdAt),console.log(" Transactions:",ae.map(Ee=>({date:Ee.date,description:Ee.description,amount:Ee.amount})))}const pe=n.filter(ae=>ae.envelopeId===G.id).filter(ae=>{if(ae.description==="Budgeted"||ae.description==="Piggybank Contribution")return!1;if(G.isPiggybank){if(!G.createdAt)return!0;const Ee=Jm(G.createdAt).toISOString().split("T")[0];return Jm(ae.date).toISOString().split("T")[0]>=Ee}return ae.month===p||!ae.month}).sort((ae,Ee)=>new Date(Ee.date).getTime()-new Date(ae.date).getTime()),ce=()=>{N.state?.fromGlobalFAB?C("/"):C(-1)},xe=()=>{t&&(a(t),C(-1))},Re=ae=>{const Ee={...ae,reconciled:!ae.reconciled};c(Ee)};return v.jsxs("div",{className:"min-h-screen bg-white dark:bg-black text-gray-900 dark:text-white p-4 pb-[calc(8rem+env(safe-area-inset-bottom))] max-w-4xl mx-auto",children:[v.jsxs("header",{className:"flex justify-between items-center pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 bg-white dark:bg-black z-10 border-b border-gray-100 dark:border-zinc-800",children:[v.jsx("button",{onClick:()=>{if(G.isPiggybank)P(!0);else{const ae=prompt("Rename envelope:",G.name);ae&&ae.trim()&&t&&o(t,ae)}},className:"text-blue-600 dark:text-blue-400 font-medium",children:G.isPiggybank?"Edit":"Rename"}),v.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:G.name}),v.jsx("button",{onClick:ce,className:"text-blue-600 dark:text-blue-400 font-bold",children:"Done"})]}),v.jsxs("section",{className:"mt-4 bg-white dark:bg-zinc-900 rounded-lg p-4 shadow-lg mb-4 border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-2",children:[v.jsx("span",{className:"text-lg font-headline text-gray-900 dark:text-white",children:"Current Balance"}),(()=>{const ae=G.isPiggybank?h(G.id):h(G.id,p);return console.log(`Debug: Envelope ${G.name} Balance:`,ae),v.jsx("span",{className:`text-xl font-bold ${ae<0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:rx(ae)})})()]}),v.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("span",{className:"text-sm font-medium text-gray-500 dark:text-zinc-400",children:G.isPiggybank?"Monthly Contribution":"Budgeted This Month"}),K?v.jsx("form",{onSubmit:ae=>{ae.preventDefault(),ie()},className:"flex items-center gap-2",children:v.jsx("input",{ref:te,type:"number",step:"0.01",value:q,onChange:ae=>Q(ae.target.value),onBlur:ie,className:"w-24 px-2 py-1 text-right font-semibold bg-gray-100 dark:bg-zinc-800 rounded border border-blue-500 focus:outline-none"})}):v.jsx("div",{onClick:()=>X(!0),className:"px-2 py-1 -mr-2 rounded hover:bg-gray-100 dark:hover:bg-zinc-800 cursor-pointer transition-colors",children:v.jsx("span",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:rx(Y)})})]}),v.jsxs("div",{className:`mt-3 py-1.5 px-3 rounded-md flex justify-between items-center text-xs font-medium transition-colors ${le<0?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":le===0?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300"}`,children:[v.jsx("span",{children:"Left to Budget:"}),v.jsx("span",{children:rx(le)})]})]})]}),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg mb-4 divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:[v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-green-600 dark:text-green-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>O(!0),children:[v.jsx(nB,{className:"w-5 h-5 mr-3"}),"Add Money"]}),v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>A(!0),children:[v.jsx(eB,{className:"w-5 h-5 mr-3"}),"Spend Money"]}),v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>D(!0),children:[v.jsx(L9,{className:"w-5 h-5 mr-3"}),"Transfer Money"]})]}),v.jsxs("section",{className:"mt-6",children:[v.jsx("h2",{className:"text-sm font-semibold uppercase text-gray-500 dark:text-zinc-400 mb-2 px-2",children:"Transaction History"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:pe.length===0?v.jsx("p",{className:"p-4 text-center text-gray-500 dark:text-zinc-400",children:"No transactions yet for this envelope."}):v.jsx(ii,{initial:!1,mode:"popLayout",children:pe.map(ae=>v.jsx(gn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(nv,{disabled:ae.isAutomatic,onDelete:()=>{if(!ae.id)return;const Ee={...ae};u(ae.id),T("Transaction deleted","neutral",()=>d(Ee))},children:v.jsx(KP,{transaction:ae,onReconcile:()=>Re(ae),onEdit:()=>{ae.isAutomatic||L(ae)}})})},ae.id))})})]}),v.jsx("div",{className:"mt-8",children:v.jsxs("button",{className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-100 dark:border-zinc-800",onClick:()=>{const ae=G.isPiggybank?`Are you sure you want to delete "${G.name}"? This will delete the piggybank and all its history.`:`Are you sure you want to remove "${G.name}" from ${p}? This will delete all transactions for this month only.`;confirm(ae)&&xe()},children:[v.jsx(xD,{className:"w-5 h-5 mr-2"}),"Delete Envelope"]})}),v.jsx(WP,{isVisible:j||M||!!V,onClose:()=>{O(!1),A(!1),L(null)},mode:j?"add":M?"spend":"edit",currentEnvelope:G,initialTransaction:V}),v.jsx(JZ,{isVisible:k,onClose:()=>D(!1),sourceEnvelope:G}),v.jsx(eJ,{isOpen:U,onClose:()=>P(!1),onSave:F,existingPiggybank:G})]})},iJ=({isVisible:t,onClose:e,onConfirm:n,currentMonth:r,incomeCount:i,totalIncome:a,allocationCount:o,totalAllocated:c,transactionCount:u,totalTransactionAmount:d,isLoading:h=!1})=>{const[p,m]=B.useState("confirm"),b=E=>{const[T,C]=E.split("-");return new Date(parseInt(T),parseInt(C)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},w=()=>{p==="confirm"?m("final_confirm"):p==="final_confirm"&&n()},S=()=>{m("confirm"),e()};return v.jsx(ii,{children:t&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(gn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:S,className:"absolute inset-0 bg-black bg-opacity-50"}),v.jsxs(gn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[v.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Start Fresh for ",b(r)]}),v.jsx("button",{onClick:S,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",disabled:h,children:""})]}),v.jsx("div",{className:"p-6 space-y-4",children:p==="confirm"?v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),v.jsxs("div",{className:"ml-3",children:[v.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"This action will permanently delete:"}),v.jsx("div",{className:"mt-2 text-sm text-red-700 dark:text-red-300",children:v.jsxs("ul",{className:"space-y-1",children:[v.jsxs("li",{children:[" ",i," income source",i!==1?"s":""," (totaling $",a.toFixed(2),"/month)"]}),v.jsxs("li",{children:[" ",o," envelope allocation",o!==1?"s":""," (totaling $",c.toFixed(2),")"]}),v.jsxs("li",{children:[" ",u," transaction",u!==1?"s":""," (totaling $",d.toFixed(2),")"]})]})})]})]})}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),v.jsx("div",{className:"ml-3",children:v.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[v.jsx("strong",{children:"All other months will remain completely unchanged."})," This only affects the current month's budget data, income sources, allocations, and all transactions."]})})]})})]}):v.jsxs("div",{className:"text-center py-4",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900 mb-4",children:v.jsx("svg",{className:"h-6 w-6 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),v.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 dark:text-white mb-2",children:"Are you absolutely sure?"}),v.jsxs("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:["This action cannot be undone. All budget data and transactions for ",v.jsx("strong",{children:b(r)})," will be permanently removed."]})]})}),v.jsxs("div",{className:"flex gap-3 p-6 border-t border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{type:"button",onClick:S,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",disabled:h,children:"Cancel"}),v.jsx("button",{type:"button",onClick:w,disabled:h,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:h?"Clearing...":p==="confirm"?"Continue":"Yes, Start Fresh"})]})]})]})})},aJ=()=>{const t=ia(),e=B.useRef(null),{envelopes:n,transactions:r,resetData:i,importData:a,getEnvelopeBalance:o,appSettings:c,updateAppSettings:u,initializeAppSettings:d,incomeSources:h,allocations:p,currentMonth:m,clearMonthData:b,handleUserLogout:w,resetOnboarding:S}=Xt(),{deleteAccount:E,currentUser:T,logout:C}=Ai(),[N,j]=B.useState(null),[O,M]=B.useState(()=>localStorage.getItem("lastBackupDate")||"Never"),[A,k]=B.useState(!1),[D,V]=B.useState(""),[L,U]=B.useState(!1),[P,K]=B.useState(!1),[X,q]=B.useState(null),[Q,te]=B.useState(!1),[se,G]=B.useState(!1),F=978307200,Y=c?.theme??"system",Z=c?.fontSize??"medium";B.useEffect(()=>{c||d().catch(Se=>{console.error("Failed to initialize app settings:",Se)})},[d,c]);const W=(Se,Le)=>{j({type:Se,text:Le}),setTimeout(()=>j(null),3500)},le=B.useMemo(()=>{const Se=n.length,Le=r.length,Me=m?p[m]||[]:[],Be=Object.values(h).reduce((cn,It)=>cn+It.length,0),st=Me.length,_t=n.reduce((cn,It)=>{const _n=It.isPiggybank?o(It.id):o(It.id,m);return cn+(typeof _n=="number"?_n:0)},0),Ze=0,ut=r.reduce((cn,It)=>{let _n=0;if(typeof It.date=="string"){const Ur=Date.parse(It.date);_n=Number.isNaN(Ur)?0:Ur}else typeof It.date=="number"&&(_n=It.date<2e9?(It.date+F)*1e3:It.date);return Math.max(cn,_n)},0),Rt=Ze||ut?new Date(Math.max(Ze,ut)).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"Never";return{envelopeCount:Se,transactionCount:Le,incomeSourceCount:Be,allocationCount:st,totalBalance:_t,lastUpdated:Rt}},[n,r,h,p,m]),ie=()=>{try{console.log(" Creating backup...");const Se={appVersion:"1.7.0",backupDate:Date.now(),appSettings:c||{theme:"system"},envelopes:n.map(_t=>({..._t,currentBalance:(()=>{const Ze=_t.isPiggybank?o(_t.id):o(_t.id,m);return typeof Ze=="number"?Ze:0})(),lastUpdated:new Date().toISOString()})),transactions:r,allocations:p,incomeSources:h},Le=new Blob([JSON.stringify(Se,null,2)],{type:"application/json"}),Me=URL.createObjectURL(Le),Be=document.createElement("a");Be.href=Me,Be.download=`HouseBudget_Backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(Be),Be.click(),document.body.removeChild(Be),URL.revokeObjectURL(Me);const st=new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});localStorage.setItem("lastBackupDate",st),M(st),q({success:!0,message:"Backup downloaded successfully."})}catch(Se){console.error(Se),q({success:!1,message:"Failed to create backup file.",onRetry:ie})}},pe=()=>{K(!0),q(null);try{const Se=["Date","Merchant","Payment Method","Notes","Amount","Type","Envelope","Reconciled"],Le=r.filter(Ze=>Ze.description!=="Budgeted"&&Ze.description!=="Piggybank Contribution").map(Ze=>{const ut=n.find(aa=>aa.id===Ze.envelopeId)?.name||"Unknown",Rt=(Ze.merchant||"").replace(/"/g,'""'),cn=(Ze.description||"").replace(/"/g,'""');let It="";Ze.paymentMethod&&(It=`${Ze.paymentMethod.name} (...${Ze.paymentMethod.last4})`);const _n=It.replace(/"/g,'""');let Ur="Invalid Date";if(Ze.date){if(typeof Ze.date=="string")Ur=Ze.date.split("T")[0];else if(typeof Ze.date=="number"){const aa=Ze.date<2e9?(Ze.date+F)*1e3:Ze.date;Ur=new Date(aa).toISOString().split("T")[0]}}return[Ur,`"${Rt}"`,`"${_n}"`,`"${cn}"`,Ze.amount.toFixed(2),Ze.type,`"${ut}"`,Ze.reconciled?"Yes":"No"].join(",")}),Me=[Se.join(","),...Le].join(`
`),Be=new Blob([Me],{type:"text/csv;charset=utf-8;"}),st=URL.createObjectURL(Be),_t=document.createElement("a");_t.href=st,_t.download=`HouseBudget_Transactions_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(_t),_t.click(),document.body.removeChild(_t),URL.revokeObjectURL(st),q({success:!0,message:"Transactions CSV exported successfully."})}catch(Se){console.error(Se),q({success:!1,message:"Failed to export CSV. Please try again.",onRetry:pe})}finally{K(!1)}},ce=()=>{e.current?.click()},xe=Se=>{const Le=Se.target.files?.[0];if(!Le)return;const Me=new FileReader;Me.onload=async Be=>{try{const st=JSON.parse(Be.target?.result),_t=await a(st);if(!_t.success){W("error",_t.message);return}if(st.appSettings?.theme)try{await u({theme:st.appSettings.theme})}catch(Ze){console.error("Failed to update imported settings:",Ze)}W("success",`Loaded ${st.envelopes?.length??0} envelopes, ${st.transactions?.length??0} transactions.`)}catch(st){console.error(st),W("error","Invalid backup file. Please verify the JSON.")}},Me.readAsText(Le),Se.target.value=""},Re=async()=>{if(window.confirm("Are you sure? This will permanently delete all envelopes, transactions, budget allocations, income sources, and settings from the cloud. This action cannot be undone."))try{await i(),W("success","All data has been permanently deleted."),t("/")}catch(Se){console.error("Reset failed:",Se),W("error","Failed to delete all data. Some data may remain.")}},ae=async()=>{if(!D.trim()){W("error","Please enter your password to confirm account deletion.");return}k(!0);try{await i(),await E(D)?W("success","Your account has been permanently deleted."):W("error","Failed to delete account. Please try again.")}catch(Se){console.error("Account deletion failed:",Se),W("error","Failed to delete account. Please try again.")}finally{k(!1),U(!1),V("")}},Ee=async()=>{if(!T){W("error","You must be logged in to clean up data.");return}te(!0);try{const Se=await lS.cleanupOrphanedData(T.id),Le=Se.orphanedAllocationsDeleted+Se.orphanedTransactionsDeleted;Le>0?W("success",`Cleaned ${Le} orphaned items: ${Se.orphanedAllocationsDeleted} allocations and ${Se.orphanedTransactionsDeleted} transactions.`):W("success","No orphaned data found. Your database is already clean!")}catch(Se){console.error("Cleanup failed:",Se),W("error","Failed to clean up orphaned data. Please try again.")}finally{te(!1)}},Ne=()=>{G(!0)},Ie=async()=>{G(!1),await b(m),W("success","Month data has been reset.")},Oe=async()=>{if(window.confirm("Are you sure you want to log out? This will clear all your data from the app until you log back in."))try{w(),C(),t("/")}catch(Se){console.error("Logout failed:",Se)}},Ve=T?.displayName?.charAt(0)?.toUpperCase()||T?.email?.charAt(0)?.toUpperCase()||"U";return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black transition-colors duration-200",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-center shadow-sm relative",children:[v.jsx("button",{onClick:()=>t(-1),className:"absolute left-4 text-blue-600 dark:text-blue-400 font-medium",children:"Done"}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Settings"})]}),v.jsxs("div",{className:"p-4 space-y-6 max-w-4xl mx-auto pb-[calc(8rem+env(safe-area-inset-bottom))]",children:[N&&v.jsxs("div",{className:`px-4 py-3 rounded-2xl text-sm font-medium flex items-center gap-2 ${N.type==="success"?"bg-green-50 text-green-700 dark:bg-emerald-900/30 dark:text-emerald-200":"bg-red-50 text-red-700 dark:bg-red-900/30 dark:text-red-200"}`,children:[N.type==="success"?v.jsx(xm,{size:18}):v.jsx(wm,{size:18}),N.text]}),v.jsx("section",{children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4 flex items-center gap-4",children:[v.jsx("div",{className:"w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center text-white text-2xl font-semibold shadow-md",children:Ve}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white truncate",children:T?.displayName||T?.email?.split("@")[0]||"User"}),v.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400 truncate",children:T?.email}),v.jsxs("button",{onClick:Oe,className:"mt-2 text-sm text-red-600 dark:text-red-400 font-medium flex items-center gap-1 hover:underline",children:[v.jsx(AB,{size:14})," Log Out"]})]})]})}),v.jsx("section",{children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-5 space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(RC,{className:"text-blue-500",size:22}),v.jsxs("div",{children:[v.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Backup & Restore"}),v.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Create backups of all your data including envelopes, transactions, budget allocations, income sources, and settings."})]})]}),v.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 pt-2",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Envelopes"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:le.envelopeCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Transactions"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:le.transactionCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Income Sources"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:le.incomeSourceCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Allocations"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:le.allocationCount})]})]})]})}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Categories"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:v.jsxs("button",{onClick:()=>t("/settings/categories"),className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("span",{className:"text-xl",children:""}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Manage Categories"})]}),v.jsx(Ea,{className:"text-gray-400",size:18})]})})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Appearance"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4 space-y-4",children:[v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[Y==="light"&&v.jsx("span",{className:"text-orange-500 text-lg",children:""}),Y==="dark"&&v.jsx("span",{className:"text-purple-500 text-lg",children:""}),Y==="system"&&v.jsx("span",{className:"text-gray-500 text-lg",children:""}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Theme"})]}),v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 capitalize",children:Y})]}),v.jsx("div",{className:"flex gap-2",children:[{label:"Light",value:"light"},{label:"Dark",value:"dark"},{label:"System",value:"system"}].map(Se=>v.jsx("button",{onClick:async()=>{try{await u({theme:Se.value})}catch(Le){console.error("Failed to update theme setting:",Le)}},className:`flex-1 py-2 rounded-lg text-sm font-medium border transition-colors ${Y===Se.value?"bg-blue-50 dark:bg-blue-900/30 border-blue-500 text-blue-700 dark:text-blue-200":"border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 hover:border-gray-300 dark:hover:border-zinc-600"}`,children:Se.label},Se.value))})]}),v.jsx("div",{className:"h-px bg-gray-100 dark:bg-zinc-800"}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("span",{className:"text-gray-500 text-lg",children:"Aa"}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Font Size"})]}),v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 capitalize",children:Z})]}),v.jsx("div",{className:"flex gap-2",children:[{label:"A",value:"extra-small",sizeClass:"text-[10px]"},{label:"A",value:"small",sizeClass:"text-xs"},{label:"A",value:"medium",sizeClass:"text-base"},{label:"A",value:"large",sizeClass:"text-xl"},{label:"A",value:"extra-large",sizeClass:"text-2xl"}].map(Se=>v.jsx("button",{onClick:async()=>{try{await u({fontSize:Se.value})}catch(Le){console.error("Failed to update font size setting:",Le)}},className:`flex-1 py-2 rounded-lg font-medium border transition-colors flex items-center justify-center ${Z===Se.value?"bg-blue-50 dark:bg-blue-900/30 border-blue-500 text-blue-700 dark:text-blue-200":"border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 hover:border-gray-300 dark:hover:border-zinc-600"}`,children:v.jsx("span",{className:Se.sizeClass,children:Se.label})},Se.value))})]})]})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Help & Guide"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:v.jsxs("button",{onClick:()=>{S(),t("/")},className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Gf,{className:"text-purple-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Restart Onboarding Guide"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"View the welcome tutorial again"})]})]}),v.jsx(Ea,{className:"text-gray-400",size:18})]})})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Actions"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:[v.jsxs("button",{onClick:ie,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(RC,{className:"text-blue-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Create Backup"}),v.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["Last backup: ",O]})]})]}),v.jsx(Ea,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:ce,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(eU,{className:"text-blue-500",size:20}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Restore from Backup"})]}),v.jsx(Ea,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:pe,disabled:P,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[P?v.jsx(NC,{className:"text-blue-500 animate-spin",size:20}):v.jsx(hB,{className:"text-blue-500",size:20}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:P?"Preparing CSV":"Export Transactions (CSV)"})]}),v.jsx(Ea,{className:"text-gray-400",size:18})]}),v.jsx("input",{type:"file",ref:e,onChange:xe,accept:".json",className:"hidden"})]})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Danger Zone"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm",children:[v.jsxs("button",{onClick:Ne,className:"w-full p-4 flex items-center justify-between hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx($f,{className:"text-orange-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Start Fresh (This Month)"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Clear all allocations and data for the current month only"})]})]}),v.jsx(Ea,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:Ee,disabled:Q,className:"w-full p-4 flex items-center justify-between hover:bg-yellow-50 dark:hover:bg-yellow-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800 disabled:opacity-60 disabled:cursor-not-allowed",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[Q?v.jsx(NC,{className:"text-yellow-500 animate-spin",size:20}):v.jsx(Gf,{className:"text-yellow-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:Q?"Cleaning Data...":"Purge Orphaned Data"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Remove allocations and transactions pointing to deleted envelopes"})]})]}),v.jsx(Ea,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:Re,className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(wm,{className:"text-red-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Reset All Data"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Permanently delete everything"})]})]}),v.jsx(Ea,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:()=>U(!0),className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(yu,{className:"text-red-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Delete Account"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Permanently delete your account and all data"})]})]}),v.jsx(Ea,{className:"text-gray-400",size:18})]})]})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-semibold text-gray-500 dark:text-zinc-400 uppercase tracking-wider px-4 mb-2",children:"Siri Integration"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-200 dark:border-zinc-800",children:v.jsxs("div",{className:"p-4",children:[v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400 mb-3",children:"Use this token in your Siri Shortcut to add transactions by voice."}),c?.siriToken?v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("code",{className:"flex-1 bg-gray-100 dark:bg-zinc-800 px-3 py-2 rounded-lg text-sm font-mono text-gray-900 dark:text-white select-all",children:c.siriToken}),v.jsx("button",{onClick:()=>{navigator.clipboard.writeText(c.siriToken),W("success","Token copied to clipboard")},className:"px-3 py-2 bg-blue-500 text-white rounded-lg text-sm font-medium hover:bg-blue-600 transition-colors",children:"Copy"})]}):v.jsx("button",{onClick:async()=>{const Se=crypto.randomUUID().replace(/-/g,"").slice(0,16);await u({siriToken:Se}),W("success","Siri token generated")},className:"w-full py-2 px-4 bg-purple-500 text-white rounded-lg font-medium hover:bg-purple-600 transition-colors",children:"Generate Siri Token"})]})})]}),v.jsxs("div",{className:"text-center py-4",children:[v.jsxs("p",{className:"text-xs text-gray-400 dark:text-zinc-500",children:["Version ","1.7.0"," (PWA)"]}),"        "]}),X&&v.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 max-w-sm w-full",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[X.success?v.jsx(xm,{className:"text-green-500",size:24}):v.jsx(yu,{className:"text-red-500",size:24}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:X.success?"Success":"Error"})]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-300 mb-4",children:X.message}),v.jsxs("div",{className:"flex gap-2",children:[X.onRetry&&v.jsx("button",{onClick:()=>{q(null),X.onRetry?.()},className:"flex-1 py-2 px-4 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors",children:"Retry"}),v.jsx("button",{onClick:()=>q(null),className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-zinc-700 text-gray-900 dark:text-white rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-zinc-600 transition-colors",children:"Close"})]})]})}),v.jsx(iJ,{isVisible:se,onClose:()=>G(!1),onConfirm:Ie,currentMonth:m,incomeCount:(h[m]||[]).length,totalIncome:(h[m]||[]).reduce((Se,Le)=>Se+Le.amount,0),allocationCount:(p[m]||[]).filter(Se=>n.some(Le=>Le.id===Se.envelopeId)).length,totalAllocated:(p[m]||[]).filter(Se=>n.some(Le=>Le.id===Se.envelopeId)).reduce((Se,Le)=>Se+Le.budgetedAmount,0),transactionCount:r.filter(Se=>Se.month===m).length,totalTransactionAmount:r.filter(Se=>Se.month===m).reduce((Se,Le)=>Se+Le.amount,0)}),L&&v.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 max-w-sm w-full",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[v.jsx(yu,{className:"text-red-500",size:24}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Account"})]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-300 mb-4",children:"This action cannot be undone. This will permanently delete your account and remove all data from our servers."}),v.jsx("input",{type:"password",value:D,onChange:Se=>V(Se.target.value),placeholder:"Enter your password",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 mb-4"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>{U(!1),V("")},className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-zinc-700 text-gray-900 dark:text-white rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-zinc-600 transition-colors",children:"Cancel"}),v.jsx("button",{onClick:ae,disabled:A||!D.trim(),className:"flex-1 py-2 px-4 bg-red-500 text-white rounded-lg font-medium hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:A?"Deleting...":"Delete Account"})]})]})})]})]})},sJ=()=>{const t=ia(),{categories:e,addCategory:n,updateCategory:r,deleteCategory:i,reorderCategories:a}=Xt(),{showToast:o}=oc(),[c,u]=B.useState(!1),[d,h]=B.useState(""),[p,m]=B.useState(null),[b,w]=B.useState(""),[S,E]=B.useState(e),T=B.useRef(e),[C,N]=B.useState(!1),[j,O]=B.useState(null),M=B.useRef(!1),A=B.useRef(null),k=B.useRef({}),D=B.useRef({}),V=B.useRef({activeId:null,startIndex:0,currentIndex:0,itemHeight:0});B.useEffect(()=>{C||(E(e),T.current=e)},[e,C]),B.useEffect(()=>(C?(document.body.style.overflow="hidden",document.body.style.touchAction="none"):(document.body.style.overflow="",document.body.style.touchAction=""),()=>{document.body.style.overflow="",document.body.style.touchAction=""}),[C]);const L=B.useCallback((se,G)=>{console.log(" Long press triggered for category:",G);const F=D.current[G];if(F){console.log(" Moveable instance found, starting drag"),M.current=!0;const Y=se.nativeEvent||se;F.dragStart(Y)}else console.log(" No moveable instance found for:",G)},[]),U=B.useCallback(se=>G=>{G?k.current[se]=G:delete k.current[se]},[]),P=async se=>{if(se.preventDefault(),!!d.trim())try{await n({name:d.trim(),orderIndex:e.length,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),h(""),u(!1),o("Category added","success")}catch(G){console.error(G),o("Failed to add category","error")}},K=async se=>{if(!b.trim())return;const G=e.find(F=>F.id===se);if(G)try{await r({...G,name:b.trim()}),m(null),o("Category updated","success")}catch(F){console.error(F),o("Failed to update category","error")}},X=async se=>{if(confirm("Are you sure? Envelopes in this category will become Uncategorized."))try{await i(se),o("Category deleted","success")}catch(G){console.error(G),o("Failed to delete category","error")}},q=8,Q=(se,G,F)=>Math.max(G,Math.min(F,se)),te=B.useCallback(async se=>{if(!se.length)return;const G=se.map(F=>F.id);try{await a(G)}catch(F){console.error("Failed to persist category order:",F),o("Failed to save category order","error")}},[a,o]);return B.useEffect(()=>{const se=()=>{Object.values(D.current).forEach(Y=>Y?.destroy()),D.current={}};if(!S.length)return;const G=()=>{S.forEach(Y=>{const Z=k.current[Y.id];if(!Z||!A.current)return;const W=new MP(A.current,{target:Z,draggable:!0,throttleDrag:0,snappable:!0,snapThreshold:5,snapDirections:{top:!0,bottom:!0},elementSnapDirections:{top:!0,bottom:!0},clickable:!0,dragArea:!1,hideDefaultLines:!0,renderDirections:[],edge:!1,origin:!1});W.on("dragStart",ie=>{if(console.log(" Moveable dragStart event",{isManualDrag:M.current,categoryId:Y.id}),!M.current){console.log(" Stopping drag - not manual"),ie.stop();return}const pe=ie.inputEvent.target;if(pe.tagName==="INPUT"||pe.tagName==="BUTTON"||pe.closest("button")){console.log(" Stopping drag - clicked on button/input"),ie.stop();return}console.log(" Drag starting for category:",Y.id);const ce=T.current.findIndex(ae=>ae.id===Y.id),xe=ie.target,Re=xe.getBoundingClientRect();O(Y.id),V.current={activeId:Y.id,startIndex:ce,currentIndex:ce,itemHeight:Re.height+q},xe.style.transition="none",xe.style.boxShadow="0 18px 45px rgba(15,23,42,0.35)",xe.style.zIndex="20",N(!0)});let le=null;W.on("drag",ie=>{const pe=ie.target;le!==null&&cancelAnimationFrame(le),le=requestAnimationFrame(()=>{const ce=V.current;if(ce.activeId!==Y.id)return;const xe=ie.beforeTranslate[1];pe.style.transform=`translateY(${xe}px)`,pe.style.transition="none";const{itemHeight:Re,startIndex:ae}=ce,Ee=Math.round(xe/Re),Ne=Q(ae+Ee,0,T.current.length-1);Ne!==ce.currentIndex&&(ce.currentIndex=Ne,T.current.forEach((Ie,Oe)=>{if(Ie.id===Y.id)return;const Ve=k.current[Ie.id];if(!Ve)return;let Se=0;ae<Ne&&Oe>ae&&Oe<=Ne?Se=-Re:ae>Ne&&Oe>=Ne&&Oe<ae&&(Se=Re),Ve.style.transform=Se?`translateY(${Se}px)`:"",Ve.style.transition="transform 0.2s ease"})),le=null})}),W.on("dragEnd",ie=>{le!==null&&(cancelAnimationFrame(le),le=null);const pe=ie.target,{startIndex:ce,currentIndex:xe}=V.current;if(pe.style.transform="",pe.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease",pe.style.boxShadow="",T.current.forEach(Re=>{const ae=k.current[Re.id];ae&&(ae.style.transform="",ae.style.transition="")}),ce!==xe){const Re=[...T.current],[ae]=Re.splice(ce,1);Re.splice(xe,0,ae),T.current=Re,E(Re),te(Re)}setTimeout(()=>{pe.style.zIndex="",O(null),N(!1),M.current=!1},300)}),D.current[Y.id]=W})},F=window.setTimeout(G,80);return()=>{clearTimeout(F),se()}},[S,te]),v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-20",children:[v.jsx("style",{children:`
        .moveable-control-box,
        .moveable-line,
        .moveable-direction {
          display: none !important;
        }
      `}),v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-10 flex items-center shadow-sm",children:[v.jsx("button",{onClick:()=>t(-1),className:"mr-3 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white",children:v.jsx(Vo,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Manage Categories"})]}),v.jsxs("div",{className:"p-4 max-w-2xl mx-auto space-y-4",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:c?v.jsxs("form",{onSubmit:P,className:"flex gap-2",children:[v.jsx("input",{type:"text",value:d,onChange:se=>h(se.target.value),placeholder:"Category Name",className:"flex-1 px-3 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg outline-none dark:text-white",autoFocus:!0}),v.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium",children:"Save"}),v.jsx("button",{type:"button",onClick:()=>u(!1),className:"text-gray-500 px-2",children:"Cancel"})]}):v.jsxs("button",{onClick:()=>u(!0),className:"w-full flex items-center justify-center gap-2 text-blue-600 dark:text-blue-400 font-medium py-2",children:[v.jsx(wh,{size:20}),"Add Category"]})}),v.jsxs("div",{ref:A,className:"space-y-2",style:{touchAction:C?"none":"auto"},children:[S.map(se=>{const G=sS(Y=>{L(Y,se.id)},{threshold:500,cancelOnMovement:25,detect:Co.Touch}),F=j===se.id;return v.jsx("div",{...G(),ref:U(se.id),style:{cursor:F?"grabbing":"pointer"},className:"bg-white dark:bg-zinc-900 rounded-xl p-4 border border-gray-100 dark:border-zinc-800 flex items-center justify-between group select-none",children:p===se.id?v.jsxs("div",{className:"flex-1 flex gap-2",children:[v.jsx("input",{type:"text",value:b,onChange:Y=>w(Y.target.value),className:"flex-1 px-3 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg outline-none dark:text-white",autoFocus:!0}),v.jsx("button",{onClick:()=>K(se.id),className:"bg-green-600 text-white px-3 py-2 rounded-lg text-sm",children:"Save"}),v.jsx("button",{onClick:()=>m(null),className:"text-gray-500 px-2 text-sm",children:"Cancel"})]}):v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"text-gray-400 dark:text-zinc-600 cursor-grab active:cursor-grabbing",onMouseDown:Y=>L(Y,se.id),children:v.jsx(Ff,{size:20})}),v.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:se.name})]}),v.jsxs("div",{className:"flex gap-2 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity",children:[v.jsx("button",{onClick:()=>{m(se.id),w(se.name)},className:"p-2 text-gray-500 hover:text-blue-600 dark:hover:text-blue-400",children:v.jsx(IB,{size:18})}),v.jsx("button",{onClick:()=>X(se.id),className:"p-2 text-gray-500 hover:text-red-600 dark:hover:text-red-400",children:v.jsx(wm,{size:18})})]})]})},se.id)}),S.length===0&&!c&&v.jsx("div",{className:"text-center text-gray-500 dark:text-zinc-500 py-8",children:"No categories yet. Add one to get started."})]})]})]})},oJ=()=>{const{addEnvelope:t,setEnvelopeAllocation:e,currentMonth:n,categories:r,fetchCategories:i}=Xt(),{showToast:a}=oc(),o=ia(),[c]=mD();uf.useEffect(()=>{r.length===0&&i()},[r.length,i]);const[u,d]=B.useState(""),[h,p]=B.useState(c.get("type")==="piggybank"),[m,b]=B.useState(c.get("categoryId")||""),[w,S]=B.useState(""),[E,T]=B.useState(""),[C,N]=B.useState("#3B82F6"),[j,O]=B.useState(!1),M=async A=>{if(A.preventDefault(),!u.trim()||j)return;O(!0);const k=Xt.getState().envelopes,V=(k.length>0?Math.max(...k.map(K=>K.orderIndex??0)):-1)+1,L=h?new Date(`${n}-01T00:00:00`):new Date,U={name:u,currentBalance:0,lastUpdated:new Date().toISOString(),createdAt:L.toISOString(),isActive:!0,orderIndex:V,categoryId:m||void 0};if(h){U.isPiggybank=!0;const K={monthlyContribution:parseFloat(E||"0"),color:C,icon:"piggy-bank"};w&&parseFloat(w)>0&&(K.targetAmount=parseFloat(w)),U.piggybankConfig=K}t(U).then(K=>{if(K){const X=h?parseFloat(E||"0"):0;e(K,X).catch(q=>console.error("Failed to create allocation:",q)),setTimeout(()=>{o("/")},50)}}).catch(K=>{console.error("Failed to create envelope:",K),a(K.message||"Failed to create envelope","error"),O(!1)})};return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-[calc(8rem+env(safe-area-inset-bottom))]",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-10 flex items-center shadow-sm",children:[v.jsx("button",{onClick:()=>o("/"),className:"mr-3 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white",children:v.jsx(Vo,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:h?"New Piggybank":"New Envelope"})]}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:[v.jsx("div",{className:"p-6 bg-blue-50 dark:bg-zinc-800 border-b border-blue-100 dark:border-zinc-700 flex justify-center py-8",children:v.jsx("div",{className:"w-20 h-20 bg-blue-100 dark:bg-zinc-700 text-blue-600 dark:text-blue-400 rounded-full flex items-center justify-center",children:h?v.jsx(xh,{size:40}):v.jsx(gB,{size:40})})}),v.jsxs("form",{onSubmit:M,className:"p-6 space-y-6 pb-6",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Type"}),v.jsxs("div",{className:"flex bg-gray-100 dark:bg-zinc-800 p-1 rounded-xl",children:[v.jsx("button",{type:"button",onClick:()=>p(!1),className:`flex-1 py-2 px-4 rounded-lg text-sm font-semibold transition-all ${h?"text-gray-500 dark:text-zinc-400 hover:text-gray-700 dark:hover:text-zinc-300":"bg-white dark:bg-zinc-700 text-blue-600 dark:text-blue-400 shadow-sm"}`,children:"Spending"}),v.jsx("button",{type:"button",onClick:()=>p(!0),className:`flex-1 py-2 px-4 rounded-lg text-sm font-semibold transition-all ${h?"bg-white dark:bg-zinc-700 text-blue-600 dark:text-blue-400 shadow-sm":"text-gray-500 dark:text-zinc-400 hover:text-gray-700 dark:hover:text-zinc-300"}`,children:"Piggybank"})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Category"}),v.jsxs("select",{id:"category",value:m,onChange:A=>b(A.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all appearance-none",children:[v.jsx("option",{value:"",children:"Uncategorized"}),r.map(A=>v.jsx("option",{value:A.id,children:A.name},A.id))]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:h?"Piggybank Name":"Envelope Name"}),v.jsx("input",{type:"text",id:"name",value:u,onChange:A=>d(A.target.value),placeholder:h?"e.g. Vacation Fund, Emergency Savings":"e.g. Groceries, Rent, Fun Money",className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",autoFocus:!0,required:!0})]}),h&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"monthly-contribution",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Monthly Auto-Contribution *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"number",id:"monthly-contribution",value:E,onChange:A=>T(A.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:h})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"This amount will be automatically added each month and deducted from Available to Budget"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Target Goal (Optional)"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"number",id:"target-amount",value:w,onChange:A=>S(A.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Set a savings goal to track progress"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#F59E0B",label:"Amber"},{value:"#EF4444",label:"Red"},{value:"#8B5CF6",label:"Purple"},{value:"#EC4899",label:"Pink"}].map(A=>v.jsx("button",{type:"button",onClick:()=>N(A.value),className:`w-full aspect-square rounded-lg transition-all ${C===A.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-zinc-900":"hover:scale-110"}`,style:{backgroundColor:A.value},title:A.label},A.value))})]})]}),v.jsxs("div",{className:"pt-4 flex gap-3",children:[v.jsx("button",{type:"button",onClick:()=>o("/"),className:"flex-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 font-semibold bg-white dark:bg-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",children:"Cancel"}),v.jsx("button",{type:"submit",disabled:!u.trim()||h&&!E||j,className:`flex-1 py-3 px-4 rounded-xl font-semibold shadow-sm text-white transition-colors ${u.trim()&&(!h||E)&&!j?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-300 dark:bg-zinc-600 cursor-not-allowed"}`,children:j?"Creating...":h?"Create Piggybank":"Create Envelope"})]})]})]})})]})},lJ=({envelopes:t,transactionAmount:e,onSplitChange:n,initialSelectedEnvelopeId:r})=>{const[i,a]=B.useState([]),[o,c]=B.useState(!1);B.useEffect(()=>{r&&!o&&t.some(C=>C.id===r)&&(a([r]),c(!0))},[r,t,o]);const[u,d]=B.useState({}),[h,p]=B.useState(e),m=T=>{a(C=>C.includes(T)?C.filter(N=>N!==T):[...C,T])},b=(T,C)=>{d(N=>({...N,[T]:C}))};B.useEffect(()=>{if(i.length===1){const T=i[0];d({[T]:e})}},[i.length,e]),B.useEffect(()=>{const T=Object.values(u).reduce((C,N)=>C+(N||0),0);p(e-T),n(u)},[u,e,n]),B.useEffect(()=>{const T={...u};Object.keys(T).forEach(C=>{i.includes(C)||delete T[C]}),Object.keys(T).length!==Object.keys(u).length&&d(T)},[i,u]);const w=()=>{a([]),d({})},S=Math.abs(h)<.01&&i.length>0,E=i.length>0&&Math.abs(h)>.01;return v.jsxs("div",{className:"space-y-3",children:[i.length>1&&v.jsxs("div",{className:`p-3 rounded-lg ${E?"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800":S?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-zinc-800 border border-gray-200 dark:border-zinc-700"}`,children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Remaining to Split:"}),v.jsxs("span",{className:`font-bold text-lg ${E?"text-red-600 dark:text-red-400":S?"text-green-600 dark:text-green-400":"text-gray-900 dark:text-white"}`,children:["$",h.toFixed(2)]})]}),E&&v.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Split amounts must equal transaction total"})]}),v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("label",{className:"text-xs text-gray-500 dark:text-zinc-400",children:i.length>1?"Split Across Envelopes":"Select Envelope"}),i.length>0&&v.jsx("button",{type:"button",onClick:w,className:"text-xs text-blue-600 dark:text-blue-400",children:"Clear All"})]}),v.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-200 dark:border-zinc-800 rounded-lg",children:t.map(T=>v.jsxs("div",{className:"flex items-center py-3 px-3 border-b border-gray-100 dark:border-zinc-800 last:border-b-0 hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsx("input",{type:"checkbox",checked:i.includes(T.id),onChange:()=>m(T.id),className:"mr-3 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),v.jsx("span",{className:"flex-1 text-gray-900 dark:text-white",children:T.name}),i.includes(T.id)&&i.length>1&&v.jsxs("div",{className:"flex items-center",children:[v.jsx("span",{className:"mr-1 text-gray-500 dark:text-zinc-400",children:"$"}),v.jsx("input",{type:"number",min:"0",step:"0.01",value:u[T.id]||"",onChange:C=>b(T.id,parseFloat(C.target.value)||0),className:"w-24 px-2 py-1 border border-gray-300 dark:border-zinc-700 rounded bg-white dark:bg-zinc-900 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]})]},T.id))})]})};const cJ="type.googleapis.com/google.protobuf.Int64Value",uJ="type.googleapis.com/google.protobuf.UInt64Value";function QP(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function r0(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>r0(e));if(typeof t=="function"||typeof t=="object")return QP(t,e=>r0(e));throw new Error("Data cannot be encoded in JSON: "+t)}function Uu(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case cJ:case uJ:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>Uu(e)):typeof t=="function"||typeof t=="object"?QP(t,e=>Uu(e)):t}const uS="functions";const eN={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class jr extends $a{constructor(e,n,r){super(`${uS}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,jr.prototype)}}function dJ(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function i0(t,e){let n=dJ(t),r=n,i;try{const a=e&&e.error;if(a){const o=a.status;if(typeof o=="string"){if(!eN[o])return new jr("internal","internal");n=eN[o],r=o}const c=a.message;typeof c=="string"&&(r=c),i=a.details,i!==void 0&&(i=Uu(i))}}catch{}return n==="ok"?null:new jr(n,r,i)}class fJ{constructor(e,n,r,i){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,ti(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(a=>this.auth=a,()=>{}),this.messaging||r.get().then(a=>this.messaging=a,()=>{}),this.appCheck||i?.get().then(a=>this.appCheck=a,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:i}}}const O1="us-central1",hJ=/^data: (.*?)(?:\n|$)/;function pJ(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new jr("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class gJ{constructor(e,n,r,i,a=O1,o=(...c)=>fetch(...c)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new fJ(e,n,r,i),this.cancelAllRequests=new Promise(c=>{this.deleteService=()=>Promise.resolve(c())});try{const c=new URL(a);this.customDomain=c.origin+(c.pathname==="/"?"":c.pathname),this.region=O1}catch{this.customDomain=null,this.region=a}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function mJ(t,e,n){const r=Qo(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(j1(t.emulatorOrigin+"/backends"),V1("Functions",!0))}function vJ(t,e,n){const r=i=>bJ(t,e,i,{});return r.stream=(i,a)=>wJ(t,e,i,a),r}function ZP(t){return t.emulatorOrigin&&Qo(t.emulatorOrigin)?"include":void 0}async function yJ(t,e,n,r,i){n["Content-Type"]="application/json";let a;try{a=await r(t,{method:"POST",body:JSON.stringify(e),headers:n,credentials:ZP(i)})}catch{return{status:0,json:null}}let o=null;try{o=await a.json()}catch{}return{status:a.status,json:o}}async function JP(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function bJ(t,e,n,r){const i=t._url(e);return xJ(t,i,n,r)}async function xJ(t,e,n,r){n=r0(n);const i={data:n},a=await JP(t,r),o=r.timeout||7e4,c=pJ(o),u=await Promise.race([yJ(e,i,a,t.fetchImpl,t),c.promise,t.cancelAllRequests]);if(c.cancel(),!u)throw new jr("cancelled","Firebase Functions instance was deleted.");const d=i0(u.status,u.json);if(d)throw d;if(!u.json)throw new jr("internal","Response is not valid JSON object.");let h=u.json.data;if(typeof h>"u"&&(h=u.json.result),typeof h>"u")throw new jr("internal","Response is missing data field.");return{data:Uu(h)}}function wJ(t,e,n,r){const i=t._url(e);return _J(t,i,n,r||{})}async function _J(t,e,n,r){n=r0(n);const i={data:n},a=await JP(t,r);a["Content-Type"]="application/json",a.Accept="text/event-stream";let o;try{o=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(i),headers:a,signal:r?.signal,credentials:ZP(t)})}catch(m){if(m instanceof Error&&m.name==="AbortError"){const w=new jr("cancelled","Request was cancelled.");return{data:Promise.reject(w),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(w)}}}}}}const b=i0(0,null);return{data:Promise.reject(b),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(b)}}}}}}let c,u;const d=new Promise((m,b)=>{c=m,u=b});r?.signal?.addEventListener("abort",()=>{const m=new jr("cancelled","Request was cancelled.");u(m)});const h=o.body.getReader(),p=SJ(h,c,u,r?.signal);return{stream:{[Symbol.asyncIterator](){const m=p.getReader();return{async next(){const{value:b,done:w}=await m.read();return{value:b,done:w}},async return(){return await m.cancel(),{done:!0,value:void 0}}}}},data:d}}function SJ(t,e,n,r){const i=(o,c)=>{const u=o.match(hJ);if(!u)return;const d=u[1];try{const h=JSON.parse(d);if("result"in h){e(Uu(h.result));return}if("message"in h){c.enqueue(Uu(h.message));return}if("error"in h){const p=i0(0,h);c.error(p),n(p);return}}catch(h){if(h instanceof jr){c.error(h),n(h);return}}},a=new TextDecoder;return new ReadableStream({start(o){let c="";return u();async function u(){if(r?.aborted){const d=new jr("cancelled","Request was cancelled");return o.error(d),n(d),Promise.resolve()}try{const{value:d,done:h}=await t.read();if(h){c.trim()&&i(c.trim(),o),o.close();return}if(r?.aborted){const m=new jr("cancelled","Request was cancelled");o.error(m),n(m),await t.cancel();return}c+=a.decode(d,{stream:!0});const p=c.split(`
`);c=p.pop()||"";for(const m of p)m.trim()&&i(m.trim(),o);return u()}catch(d){const h=d instanceof jr?d:i0(0,null);o.error(h),n(h)}}},cancel(){return t.cancel()}})}const tN="@firebase/functions",nN="0.13.1";const EJ="auth-internal",TJ="app-check-internal",AJ="messaging-internal";function CJ(t){const e=(n,{instanceIdentifier:r})=>{const i=n.getProvider("app").getImmediate(),a=n.getProvider(EJ),o=n.getProvider(AJ),c=n.getProvider(TJ);return new gJ(i,a,o,c,r)};Xl(new jo(uS,e,"PUBLIC").setMultipleInstances(!0)),Ra(tN,nN,t),Ra(tN,nN,"esm2020")}function kJ(t=B1(),e=O1){const r=s0(Ot(t),uS).getImmediate({identifier:e}),i=oN("functions");return i&&RJ(r,...i),r}function RJ(t,e,n){mJ(Ot(t),e,n)}function NJ(t,e,n){return vJ(Ot(t),e)}CJ();function e3(t,e){const n={amount:null,merchant:null,envelope:null,envelopeId:null,description:null,paymentMethodName:null,type:"Expense",confidence:0};if(!t||t.trim().length===0)return n;const r=t.trim();let i=r,a=0;const o=r.match(/\b(?:with|using)\s+(.+)$/i);if(o&&o[1]){const b=o[1].trim();b.length>0&&b.length<60&&(n.paymentMethodName=b,i=i.replace(o[0]," ").trim(),a++)}/\b(income|earned|received|got paid|paycheck|salary|deposit|refund)\b/i.test(r)&&(n.type="Income",a++);const u=[/\$\s?(\d{1,}(?:,\d{3})*(?:\.\d{1,2})?)/,/(\d{1,}(?:,\d{3})*\.\d{1,2})\s*(?:dollars?)?/,/\b(\d{1,}(?:,\d{3})*)\s*(?:dollars?|bucks?)\b/i,/(?:for|of|spent|paid|cost|was)\s+\$?(\d{1,}(?:,\d{3})*(?:\.\d{1,2})?)/i];for(const b of u){const w=r.match(b);if(w){const S=w[1].replace(/,/g,""),E=parseFloat(S);if(!isNaN(E)&&E>0){n.amount=E,i=i.replace(w[0]," ").trim(),a++;break}}}if(n.amount===null){const b=r.match(/\b(\d{1,}(?:\.\d{1,2})?)\b/);if(b){const w=parseFloat(b[1]);!isNaN(w)&&w>0&&w<1e6&&(n.amount=w,i=i.replace(b[0]," ").trim(),a++)}}const d=e.filter(b=>b.isActive!==!1);let h=null;for(const b of d){const w=b.name.toLowerCase(),S=r.toLowerCase();if(S.includes(w)){const C=w.length/S.length;(!h||C>h.score)&&(h={envelope:b,score:Math.max(C,.8)});continue}const E=S.split(/\s+/),T=w.split(/\s+/);for(const C of T)if(!(C.length<3)){for(const N of E)if(!(N.length<3)&&(N.startsWith(C.slice(0,-1))||C.startsWith(N.slice(0,-1)))){const j=Math.min(N.length,C.length)/Math.max(N.length,C.length);j>=.6&&(!h||j>h.score)&&(h={envelope:b,score:j})}}}if(h){n.envelope=h.envelope.name,n.envelopeId=h.envelope.id,a++;const b=new RegExp(h.envelope.name.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"i");i=i.replace(b," ").trim()}const p=/\b(at|for|from|to|the|a|an|on|in|my|spent|paid|bought|got|transaction|purchase|payment|income|earned|received)\b/gi;let m=i.replace(p," ").replace(/\s+/g," ").trim();return m=m.replace(/^[^a-zA-Z0-9]+|[^a-zA-Z0-9]+$/g,"").trim(),m.length>0&&m.length<100&&(n.merchant=m,a++),n.description=r,n.confidence=0,n.amount!==null&&(n.confidence+=.35),n.envelopeId!==null&&(n.confidence+=.3),n.merchant!==null&&(n.confidence+=.2),n.paymentMethodName!==null&&(n.confidence+=.1),a>0&&(n.confidence+=.05),n.confidence=Math.min(n.confidence,1),n}async function DJ(t,e){const n=e.filter(i=>i.isActive!==!1),r=n.map(i=>i.name);try{console.log(" Siri: Calling Cloud Function to parse:",t);const i=kJ(),c=(await NJ(i,"parseTransaction")({text:t,userEnvelopes:r})).data;console.log(" Siri: Cloud Function response:",c);let u=null,d=c.envelope;if(c.envelope){const h=n.find(p=>p.name.toLowerCase()===c.envelope.toLowerCase());h&&(u=h.id,d=h.name)}return{amount:c.amount,merchant:c.merchant,envelope:d,envelopeId:u,description:c.description||t,paymentMethodName:c.paymentMethodName||null,type:c.type||"Expense",confidence:.9}}catch(i){return console.warn(" Siri: Cloud Function failed, falling back to regex parser:",i.message),e3(t,e)}}function IJ(t,e){return console.log(" Siri: Parsing locally with regex:",t),e3(t,e)}async function t3(t,e){return typeof navigator<"u"&&!navigator.onLine?(console.log(" Siri: Offline  using local parser"),IJ(t,e)):DJ(t,e)}function MJ(){const[t,e]=mD(),{envelopes:n}=Xt(),[r,i]=B.useState(null),[a,o]=B.useState(!1),[c,u]=B.useState(null);B.useEffect(()=>{const h=t.get("query");if(!h||h.trim().length===0){u(null);return}u(h),o(!0),t3(h,n).then(m=>{console.log(" Siri: Parsed result:",m),i(m)}).catch(m=>{console.error(" Siri: Parse failed:",m),i(null)}).finally(()=>{o(!1)});const p=new URLSearchParams(t);p.delete("query"),e(p,{replace:!0})},[]);const d=B.useCallback(()=>{i(null),u(null)},[]);return{parsedData:r,isParsing:a,siriQuery:c,clearParsedData:d}}const n3=({onClose:t,onSaved:e})=>{const n=ia(),{envelopes:r,addTransaction:i,currentMonth:a,appSettings:o}=Xt(),{parsedData:c,isParsing:u,siriQuery:d,clearParsedData:h}=MJ();B.useEffect(()=>{const ie=sessionStorage.getItem("siriParsedData"),pe=sessionStorage.getItem("siriQuery");if(ie&&pe&&!c&&!d)try{const ce=JSON.parse(ie);if(console.log(" Siri: Loaded stored data from sessionStorage:",ce),ce.amount!==null&&m(ce.amount.toFixed(2)),ce.merchant&&w(ce.merchant),ce.description&&E(ce.description),ce.type&&k(ce.type==="Income"?"income":"expense"),ce.envelopeId&&q(ce.envelopeId),ce.paymentMethodName&&o?.paymentSources?.length){const xe=ce.paymentMethodName.toLowerCase(),Re=o.paymentSources.find(ae=>{const Ee=ae.name.toLowerCase();return Ee===xe||Ee.includes(xe)||xe.includes(Ee)});Re&&(U(Re),K(!1))}C(!0),j(pe),console.log(" Siri: Pre-filled form from sessionStorage"),sessionStorage.removeItem("siriParsedData"),sessionStorage.removeItem("siriQuery")}catch(ce){console.error(" Siri: Failed to parse stored data:",ce)}},[c,d,o?.paymentSources]);const[p,m]=B.useState(""),[b,w]=B.useState(""),[S,E]=B.useState(""),[T,C]=B.useState(!1),[N,j]=B.useState(null),[O,M]=B.useState(()=>{const ie=new Date;return new Date(ie.getTime()-ie.getTimezoneOffset()*6e4).toISOString().split("T")[0]}),[A,k]=B.useState("expense"),[D,V]=B.useState({}),[L,U]=B.useState(null),[P,K]=B.useState(!1),[X,q]=B.useState(null);B.useEffect(()=>{if(!(!c||T)){if(c.amount!==null&&m(c.amount.toFixed(2)),c.merchant&&w(c.merchant),c.description&&E(c.description),c.type&&k(c.type==="Income"?"income":"expense"),c.envelopeId&&q(c.envelopeId),c.paymentMethodName&&o?.paymentSources?.length){const ie=c.paymentMethodName.toLowerCase(),pe=o.paymentSources.find(ce=>{const xe=ce.name.toLowerCase();return xe===ie||xe.includes(ie)||ie.includes(xe)});pe&&(U(pe),K(!1))}C(!0),console.log(" Siri: Pre-filled form with parsed data:",c)}},[c,T,o?.paymentSources]);const Q=()=>{if(t){t();return}n("/")},te=ie=>{U(ie),L&&K(!0)},se=Object.keys(D).length>0,G=Object.values(D).reduce((ie,pe)=>ie+(pe||0),0),F=Math.abs(G-parseFloat(p||"0"))<.01,Y=p&&parseFloat(p)>0&&se&&F,Z=async ie=>{if(ie.preventDefault(),!Y)return;const[pe,ce,xe]=O.split("-").map(Number),Re=new Date(pe,ce-1,xe,12,0,0);console.log(" Selected date:",O),console.log(" Parsed date:",Re.toISOString());try{const[ae,Ee]=O.split("-").map(Number),Ne=`${ae}-${Ee.toString().padStart(2,"0")}`;if(Ne!==a){const Oe=`This transaction date (${Ne}) does not match the current budget month (${a}). Are you sure you want to save it?`;if(!window.confirm(Oe))return}const Ie=Object.entries(D).filter(([Oe,Ve])=>Ve>0);Promise.all(Ie.map(([Oe,Ve])=>i({amount:Ve,description:S,merchant:b||void 0,date:Re.toISOString(),envelopeId:Oe,type:A==="income"?"Income":"Expense",reconciled:!1,paymentMethod:L||void 0}).catch(Se=>console.error("Failed to create transaction:",Se)))).catch(Oe=>console.error("Failed to create transactions:",Oe)),e&&e(),t?t():n("/")}catch(ae){console.error("Error saving transaction:",ae),alert("Failed to save transaction: "+(ae instanceof Error?ae.message:"Unknown error"))}},W=[...r].filter(ie=>ie.isActive!==!1).sort((ie,pe)=>{const ce=ie.orderIndex??0,xe=pe.orderIndex??0;return ce!==xe?ce-xe:ie.name.localeCompare(pe.name)}),le=A==="income"?"text-green-500":"text-red-500";return v.jsxs("div",{className:"h-screen overflow-y-auto bg-gray-50 dark:bg-black overscroll-contain",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b border-gray-200 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 z-20 flex items-center justify-between",children:[v.jsx("button",{onClick:Q,className:"text-blue-600 dark:text-blue-400 font-medium",children:"Cancel"}),v.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"New Transaction"}),v.jsx("button",{onClick:Z,disabled:!Y,className:"text-blue-600 dark:text-blue-400 font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:"Save"})]}),u&&v.jsxs("div",{className:"mx-4 mt-3 p-3 bg-purple-50 dark:bg-purple-900/30 border border-purple-200 dark:border-purple-800 rounded-xl flex items-center gap-3",children:[v.jsx(IC,{size:18,className:"text-purple-500 animate-pulse"}),v.jsx("span",{className:"text-sm text-purple-700 dark:text-purple-300",children:"Parsing voice input..."})]}),T&&!u&&(d||N)&&v.jsxs("div",{className:"mx-4 mt-3 p-3 bg-purple-50 dark:bg-purple-900/30 border border-purple-200 dark:border-purple-800 rounded-xl",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[v.jsx(IC,{size:14,className:"text-purple-500"}),v.jsx("span",{className:"text-xs font-semibold text-purple-700 dark:text-purple-300",children:"Siri Shortcut"}),c&&v.jsxs("span",{className:"ml-auto text-[10px] text-purple-500 dark:text-purple-400",children:[Math.round(c.confidence*100),"% confidence"]})]}),v.jsxs("p",{className:"text-xs text-purple-600 dark:text-purple-400 italic truncate",children:['"',d||N,'"']}),v.jsx("button",{type:"button",onClick:()=>{h(),C(!1),j(null)},className:"text-[10px] text-purple-500 dark:text-purple-400 underline mt-1",children:"Clear pre-filled data"})]}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto pb-[calc(8rem+env(safe-area-inset-bottom))]",children:v.jsxs("form",{onSubmit:Z,className:"space-y-6",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl border border-gray-200 dark:border-zinc-800 overflow-hidden",children:v.jsxs("div",{className:"flex",children:[v.jsx("button",{type:"button",onClick:()=>k("expense"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${A==="expense"?"bg-red-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Expense"}),v.jsx("button",{type:"button",onClick:()=>k("income"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${A==="income"?"bg-green-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Income"})]})}),v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${le}`,children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:p,onChange:ie=>{const pe=ie.target.value.replace(/\D/g,"");if(!pe){m("");return}const xe=(parseInt(pe,10)/100).toFixed(2);m(xe)},onKeyDown:ie=>{(ie.key==="e"||ie.key==="E"||ie.key==="+"||ie.key==="-")&&ie.preventDefault()},placeholder:"0.00",autoFocus:!0,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${le} placeholder-gray-700`})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),v.jsx("input",{type:"text",value:b,onChange:ie=>w(ie.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsx(XP,{selectedCard:L,onCardSelect:te,isUserSelected:P}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),v.jsx("input",{type:"text",value:S,onChange:ie=>E(ie.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const[ie,pe]=O.split("-").map(Number);return`${ie}-${pe.toString().padStart(2,"0")}`!==a?v.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[v.jsx(yu,{size:14}),v.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),v.jsx("input",{type:"date",value:O,onChange:ie=>M(ie.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 transition-colors",children:v.jsx(lJ,{envelopes:W,transactionAmount:parseFloat(p)||0,onSplitChange:V,initialSelectedEnvelopeId:X})})]})})]})},OJ=()=>{const t=ia(),{transactions:e,envelopes:n,updateTransaction:r,deleteTransaction:i,restoreTransaction:a,currentMonth:o,appSettings:c}=Xt(),{showToast:u}=oc(),[d,h]=B.useState(!1),[p,m]=B.useState(""),[b,w]=B.useState("all"),[S,E]=B.useState("All"),[T,C]=B.useState(!1),[N,j]=B.useState("all"),[O,M]=B.useState(!1),[A,k]=B.useState("all"),[D,V]=B.useState(!1),[L,U]=B.useState(()=>{const G=new Date;return G.setMonth(G.getMonth()-1),G.toISOString().split("T")[0]}),[P,K]=B.useState(()=>new Date().toISOString().split("T")[0]),[X,q]=B.useState(null),Q=B.useMemo(()=>{console.log(" Filtering transactions:",{totalTransactions:e.length,showAllTime:O,currentMonth:o,transactionMonths:e.map(Y=>({id:Y.id,month:Y.month,date:Y.date,description:Y.description}))});let G=e;return O||(G=e.filter(Y=>Y.month===o||!Y.month),console.log(" After month filter:",{remaining:G.length,currentMonth:o,filteredTransactions:G.map(Y=>({id:Y.id,description:Y.description,month:Y.month,matchesCurrentMonth:Y.month===o}))})),G.map(Y=>{if(!Y)return null;let Z=Y.date;if(typeof Y.date=="number"){const le=(Y.date+978307200)*1e3;Z=new Date(le).toISOString()}else if(!Y.date||typeof Y.date!="string")return null;return{...Y,date:Z}}).filter(Boolean).filter(Y=>{if(Y.description==="Budgeted"||Y.description==="Piggybank Contribution")return!1;if(p){const W=p.toLowerCase(),le=n.find(ce=>ce.id===Y.envelopeId)?.name.toLowerCase()||"",ie=Y.amount.toFixed(2);if(!(Y.description.toLowerCase().includes(W)||le.includes(W)||ie.includes(W)))return!1}if(b!=="all"&&Y.envelopeId!==b||S!=="All"&&Y.type!==S||A!=="all"&&(!Y.paymentMethod||Y.paymentMethod.id!==A)||!Y.date||typeof Y.date!="string")return!1;const Z=Y.date.split("T")[0];return!(D&&(Z<L||Z>P)||N!=="all"&&new Date(Z).getMonth()!==parseInt(N)||T&&!Y.reconciled)}).sort((Y,Z)=>new Date(Z.date).getTime()-new Date(Y.date).getTime())},[e,n,p,b,S,A,L,P,T,O,o,D]);console.log(" Final filtered transactions:",{count:Q.length,transactions:Q.map(G=>({id:G.id,description:G.description,amount:G.amount,date:G.date,month:G.month,type:G.type}))});const te=X?n.find(G=>G.id===X.envelopeId):null,se=G=>{const F={...G,reconciled:!G.reconciled};r(F)};return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-[calc(8rem+env(safe-area-inset-bottom))] transition-colors duration-200",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-between shadow-sm",children:[v.jsxs("div",{className:"flex items-center",children:[v.jsx("button",{onClick:()=>t(-1),className:"mr-3 text-gray-600 hover:text-gray-900 dark:text-zinc-400 dark:hover:text-white transition-colors",children:v.jsx(Vo,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"All Transactions"})]}),v.jsx("button",{onClick:()=>h(!d),className:`p-2 rounded-full transition-colors ${d?"bg-blue-100 text-blue-600 dark:bg-blue-900/40 dark:text-blue-400":"text-gray-400 dark:text-zinc-600 hover:bg-gray-100 dark:hover:bg-zinc-800"}`,children:v.jsx(vB,{size:20,className:d?"fill-current":""})})]}),v.jsxs("div",{className:"px-4 py-2 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 flex justify-between items-center",children:[v.jsxs("div",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:["Month: ",o]}),v.jsx("button",{onClick:()=>M(!O),className:`text-sm px-3 py-1 rounded-md ${O?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-800 dark:bg-zinc-800 dark:text-zinc-300"}`,children:O?"Current Month Only":"All Time"})]}),v.jsx("div",{className:"px-4 py-3 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800",children:v.jsxs("div",{className:"relative",children:[v.jsx(LB,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),v.jsx("input",{type:"text",placeholder:"Search transactions...",value:p,onChange:G=>m(G.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none dark:text-white"}),p&&v.jsx("button",{onClick:()=>m(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",children:v.jsx(h0,{size:16})})]})}),v.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 ${d?"max-h-[600px] opacity-100":"max-h-0 opacity-0"}`,children:v.jsxs("div",{className:"p-4 space-y-4",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Payment Method"}),v.jsxs("select",{value:A,onChange:G=>k(G.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Payment Methods"}),c?.paymentSources?.map(G=>v.jsx("option",{value:G.id,children:G.name},G.id))]})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Envelope"}),v.jsxs("select",{value:b,onChange:G=>w(G.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Envelopes"}),n.sort((G,F)=>G.name.localeCompare(F.name)).map(G=>v.jsx("option",{value:G.id,children:G.name},G.id))]})]}),v.jsx("div",{className:"bg-gray-100 dark:bg-zinc-800 p-1 rounded-lg flex",children:["All","Income","Expense"].map(G=>v.jsx("button",{onClick:()=>E(G),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${S===G?"bg-white dark:bg-zinc-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-zinc-500 hover:text-gray-700"}`,children:G},G))}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Month"}),v.jsxs("select",{value:N,onChange:G=>j(G.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Months"}),Array.from({length:12},(G,F)=>F).map(G=>v.jsx("option",{value:G,children:new Date(2022,G).toLocaleString("default",{month:"long"})},G))]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Date Range"}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("label",{className:"text-xs text-gray-600 dark:text-zinc-400",children:"Enable"}),v.jsx("button",{onClick:()=>V(!D),className:`w-9 h-5 rounded-full transition-colors relative ${D?"bg-blue-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-3 h-3 bg-white rounded-full transition-transform ${D?"translate-x-4":"translate-x-0"}`})})]})]}),v.jsxs("div",{className:`grid grid-cols-2 gap-4 transition-opacity ${D?"opacity-100":"opacity-50 pointer-events-none"}`,children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-[10px] font-medium text-gray-500 dark:text-zinc-500 uppercase",children:"From"}),v.jsx("div",{className:"relative",children:v.jsx("input",{type:"date",value:L,onChange:G=>U(G.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-[10px] font-medium text-gray-500 dark:text-zinc-500 uppercase",children:"To"}),v.jsx("div",{className:"relative",children:v.jsx("input",{type:"date",value:P,onChange:G=>K(G.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]})]})]}),v.jsxs("div",{className:"flex items-center justify-between pt-2",children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show only reconciled"}),v.jsx("button",{onClick:()=>C(!T),className:`w-11 h-6 rounded-full transition-colors relative ${T?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${T?"translate-x-5":"translate-x-0"}`})})]}),v.jsxs("div",{className:"flex items-center justify-between pt-2",children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show all time"}),v.jsx("button",{onClick:()=>M(!O),className:`w-11 h-6 rounded-full transition-colors relative ${O?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${O?"translate-x-5":"translate-x-0"}`})})]})]})}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:Q.length===0?v.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-zinc-500",children:"No transactions match your filters."}):v.jsx(ii,{initial:!1,mode:"popLayout",children:Q.map(G=>{const F=n.find(Y=>Y.id===G.envelopeId);return v.jsx(gn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(nv,{disabled:G.isAutomatic,onDelete:()=>{if(!G.id)return;const Y={...G};i(G.id),u("Transaction deleted","neutral",()=>a(Y))},children:v.jsx(KP,{transaction:G,envelopeName:F?.name||"Unknown Envelope",onReconcile:()=>se(G),onEdit:()=>{G.isAutomatic||(F?q(G):alert("Cannot edit: Envelope deleted."))}})})},G.id)})})})}),v.jsx(WP,{isVisible:!!X&&!!te,onClose:()=>q(null),mode:"edit",currentEnvelope:te||{},initialTransaction:X})]})},vo=({children:t})=>v.jsx(gn.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2,ease:"easeInOut"},className:"w-full h-full bg-gray-50 dark:bg-black",children:t}),PJ=()=>{const t=ra();return v.jsx(ii,{mode:"wait",children:v.jsxs(QL,{location:t,children:[v.jsx(hs,{path:"/",element:v.jsx(vo,{children:v.jsx(Si,{children:v.jsx(QZ,{})})})}),v.jsx(hs,{path:"/envelope/:id",element:v.jsx(vo,{children:v.jsx(Si,{children:v.jsx(rJ,{})})})}),v.jsx(hs,{path:"/add-envelope",element:v.jsx(vo,{children:v.jsx(Si,{children:v.jsx(oJ,{})})})}),v.jsx(hs,{path:"/add-transaction",element:v.jsx(vo,{children:v.jsx(Si,{children:v.jsx(n3,{})})})}),v.jsx(hs,{path:"/transactions",element:v.jsx(vo,{children:v.jsx(Si,{children:v.jsx(OJ,{})})})}),v.jsx(hs,{path:"/settings",element:v.jsx(vo,{children:v.jsx(Si,{children:v.jsx(aJ,{})})})}),v.jsx(hs,{path:"/settings/categories",element:v.jsx(vo,{children:v.jsx(Si,{children:v.jsx(sJ,{})})})}),v.jsx(hs,{path:"/verify-email",element:v.jsx(vo,{children:v.jsx(Si,{children:v.jsx(tM,{})})})})]},t.pathname)})};function xi(t){console.log(" Siri Debug:",t);const e=document.createElement("div");e.textContent=t,e.style.cssText="position:fixed;top:50px;left:10px;right:10px;z-index:99999;background:#333;color:#0f0;padding:8px 12px;border-radius:8px;font-size:11px;font-family:monospace;opacity:0.95;pointer-events:none;",document.body.appendChild(e),setTimeout(()=>e.remove(),4e3)}const jJ=()=>{const t=ia(),{envelopes:e,appSettings:n}=Xt(),r=B.useRef(!1),i=B.useRef(!1),a=B.useCallback(async()=>{const o=n?.siriToken;if(!o){xi("No siriToken in settings");return}if(e.length===0){xi("Envelopes not loaded yet");return}if(!r.current&&!i.current){r.current=!0;try{xi(`Checking Firestore... token=${o.slice(0,6)}...`);const c=gt(We,"siriQueries",o),u=await em(c);if(!u.exists()){xi("No doc found in siriQueries");return}const d=u.data();if(!d?.query||d.consumed){xi("Doc found but empty/consumed");return}const h=Date.now()-(d.timestamp||0);if(h>12e4){xi(`Doc too old: ${Math.round(h/1e3)}s`),await ei(c);return}xi(`Found query: "${d.query.slice(0,30)}..."`),i.current=!0,await ei(c);const p=await t3(d.query,e);xi("Parsed! Navigating to /add-transaction"),sessionStorage.setItem("siriParsedData",JSON.stringify(p)),sessionStorage.setItem("siriQuery",d.query),t("/add-transaction")}catch(c){xi(`ERROR: ${c.message||c}`)}finally{r.current=!1}}},[e,n?.siriToken,t]);return B.useEffect(()=>{if(!n?.siriToken||e.length===0)return;const o=[setTimeout(a,1e3),setTimeout(a,3e3),setTimeout(a,6e3)];return()=>o.forEach(clearTimeout)},[n?.siriToken,e,a]),B.useEffect(()=>{const o=()=>{document.visibilityState==="visible"&&(xi("App became visible"),i.current=!1,setTimeout(a,500),setTimeout(a,2e3),setTimeout(a,5e3))},c=()=>{xi("App got focus"),i.current=!1,setTimeout(a,500),setTimeout(a,2e3)};return document.addEventListener("visibilitychange",o),window.addEventListener("focus",c),()=>{document.removeEventListener("visibilitychange",o),window.removeEventListener("focus",c)}},[a]),B.useEffect(()=>{xi(`SiriQueryHandler mounted. token=${n?.siriToken?"yes":"no"}, envelopes=${e.length}`)},[]),null};function VJ(){const[t,e]=B.useState(!0),[n,r]=B.useState(!1),[i,a]=B.useState(null),{appSettings:o,isOnboardingActive:c}=Xt(),{isAuthenticated:u,isInitialized:d,initializeAuth:h,lastAuthTime:p,offlineGracePeriod:m,currentUser:b}=Ai();if(B.useEffect(()=>{const E=setTimeout(()=>{e(!1)},2e3);return()=>clearTimeout(E)},[]),B.useEffect(()=>h(),[h]),B.useEffect(()=>{(async()=>{const T=new URLSearchParams(window.location.search),C=T.get("mode"),N=T.get("oobCode");if(C==="resetPassword"&&N){console.log(" Processing password reset from URL"),a(N);return}if(C==="verifyEmail"&&N){console.log(" Processing email verification from URL");try{await M6(wi,N),console.log(" Email verification successful");const j=window.location.pathname;window.history.replaceState({},document.title,j),alert("Email verified successfully! You can now sign in.")}catch(j){console.error(" Email verification failed:",j),alert("Email verification failed. The link may be expired or invalid.")}}})()},[]),B.useEffect(()=>{const E=document.documentElement,T=window.matchMedia("(prefers-color-scheme: dark)"),C=()=>{const N=o?.theme??"system",j=T.matches;N==="dark"||N==="system"&&j?E.classList.add("dark"):E.classList.remove("dark")};if(C(),o?.theme==="system")return T.addEventListener("change",C),()=>T.removeEventListener("change",C)},[o]),B.useEffect(()=>{const E=document.documentElement;switch(o?.fontSize??"medium"){case"extra-small":E.style.fontSize="75%";break;case"small":E.style.fontSize="87.5%";break;case"large":E.style.fontSize="112.5%";break;case"extra-large":E.style.fontSize="125%";break;default:E.style.fontSize="100%"}},[o?.fontSize]),t||!d)return v.jsx(nM,{message:"Initializing Personal Budget..."});if(i)return v.jsx(Si,{children:v.jsx(D7,{oobCode:i,onSuccess:()=>{a(null);const E=window.location.pathname;window.history.replaceState({},document.title,E)},onCancel:()=>{a(null);const E=window.location.pathname;window.history.replaceState({},document.title,E)}})});if(!u)return b?v.jsx(Si,{children:v.jsx(tM,{})}):v.jsx(Si,{children:v.jsx(N7,{})});const S=typeof navigator<"u"&&!navigator.onLine&&u&&p&&Date.now()-p<m;return v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"fixed opacity-0 pointer-events-none -z-50",children:v.jsx("label",{id:"ios-haptic-trigger",htmlFor:"ios-haptic-checkbox",children:v.jsx("input",{type:"checkbox",id:"ios-haptic-checkbox",switch:"true"})})}),v.jsxs(Si,{children:[S&&v.jsx("div",{className:"bg-yellow-100 dark:bg-yellow-900 border-l-4 border-yellow-500 text-yellow-700 dark:text-yellow-200 p-4",children:v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),v.jsx("div",{className:"ml-3",children:v.jsxs("p",{className:"text-sm",children:[v.jsx("strong",{children:"Offline Access:"})," You're using cached authentication. Expires in"," ",Math.ceil((m-(Date.now()-p))/(1440*60*1e3))," ","days. Connect to internet to refresh."]})})]})}),v.jsxs(_9,{children:[v.jsx(jJ,{}),v.jsx(PJ,{}),n&&v.jsxs("div",{className:"fixed inset-0 z-[60]",children:[v.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>r(!1)}),v.jsx("div",{className:"absolute inset-0",children:v.jsx(n3,{onClose:()=>r(!1),onSaved:()=>r(!1)})})]}),!c&&v.jsx(mY,{onAddTransaction:()=>r(!0)})]}),v.jsx(gY,{})]})]})}qj({onNeedRefresh(){},onOfflineReady(){console.log("App is ready for offline work")}});$j.createRoot(document.getElementById("root")).render(v.jsx(B.StrictMode,{children:v.jsx(VJ,{})}));export{mt as T,We as a,C7 as b,V2 as c,gt as d,vr as e,qi as f,em as g,ei as h,Ku as o,Ji as q,Jr as s,Ol as t,Aa as u,S7 as w};
