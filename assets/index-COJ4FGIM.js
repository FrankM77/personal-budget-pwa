(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function Hz(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var kx={exports:{}},Jf={};var PI;function Yz(){if(PI)return Jf;PI=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,i,a){var s=null;if(a!==void 0&&(s=""+a),i.key!==void 0&&(s=""+i.key),"key"in i){a={};for(var c in i)c!=="key"&&(a[c]=i[c])}else a=i;return i=a.ref,{$$typeof:n,type:r,key:s,ref:i!==void 0?i:null,props:a}}return Jf.Fragment=e,Jf.jsx=t,Jf.jsxs=t,Jf}var OI;function Kz(){return OI||(OI=1,kx.exports=Yz()),kx.exports}var v=Kz(),Dx={exports:{}},ot={};var jI;function Xz(){if(jI)return ot;jI=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),s=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),m=Symbol.iterator;function b(F){return F===null||typeof F!="object"?null:(F=m&&F[m]||F["@@iterator"],typeof F=="function"?F:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,E={};function T(F,Y,ne){this.props=F,this.context=Y,this.refs=E,this.updater=ne||_}T.prototype.isReactComponent={},T.prototype.setState=function(F,Y){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,Y,"setState")},T.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function C(){}C.prototype=T.prototype;function k(F,Y,ne){this.props=F,this.context=Y,this.refs=E,this.updater=ne||_}var j=k.prototype=new C;j.constructor=k,w(j,T.prototype),j.isPureReactComponent=!0;var P=Array.isArray;function N(){}var A={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function D(F,Y,ne){var Z=ne.ref;return{$$typeof:n,type:F,key:Y,ref:Z!==void 0?Z:null,props:ne}}function z(F,Y){return D(F.type,Y,F.props)}function V(F){return typeof F=="object"&&F!==null&&F.$$typeof===n}function B(F){var Y={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(ne){return Y[ne]})}var O=/\/+/g;function X(F,Y){return typeof F=="object"&&F!==null&&F.key!=null?B(""+F.key):Y.toString(36)}function K(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(N,N):(F.status="pending",F.then(function(Y){F.status==="pending"&&(F.status="fulfilled",F.value=Y)},function(Y){F.status==="pending"&&(F.status="rejected",F.reason=Y)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function $(F,Y,ne,Z,oe){var ue=typeof F;(ue==="undefined"||ue==="boolean")&&(F=null);var ye=!1;if(F===null)ye=!0;else switch(ue){case"bigint":case"string":case"number":ye=!0;break;case"object":switch(F.$$typeof){case n:case e:ye=!0;break;case h:return ye=F._init,$(ye(F._payload),Y,ne,Z,oe)}}if(ye)return oe=oe(F),ye=Z===""?"."+X(F,0):Z,P(oe)?(ne="",ye!=null&&(ne=ye.replace(O,"$&/")+"/"),$(oe,Y,ne,"",function(Me){return Me})):oe!=null&&(V(oe)&&(oe=z(oe,ne+(oe.key==null||F&&F.key===oe.key?"":(""+oe.key).replace(O,"$&/")+"/")+ye)),Y.push(oe)),1;ye=0;var me=Z===""?".":Z+":";if(P(F))for(var Te=0;Te<F.length;Te++)Z=F[Te],ue=me+X(Z,Te),ye+=$(Z,Y,ne,ue,oe);else if(Te=b(F),typeof Te=="function")for(F=Te.call(F),Te=0;!(Z=F.next()).done;)Z=Z.value,ue=me+X(Z,Te++),ye+=$(Z,Y,ne,ue,oe);else if(ue==="object"){if(typeof F.then=="function")return $(K(F),Y,ne,Z,oe);throw Y=String(F),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.")}return ye}function W(F,Y,ne){if(F==null)return F;var Z=[],oe=0;return $(F,Z,"","",function(ue){return Y.call(ne,ue,oe++)}),Z}function ee(F){if(F._status===-1){var Y=F._result;Y=Y(),Y.then(function(ne){(F._status===0||F._status===-1)&&(F._status=1,F._result=ne)},function(ne){(F._status===0||F._status===-1)&&(F._status=2,F._result=ne)}),F._status===-1&&(F._status=0,F._result=Y)}if(F._status===1)return F._result.default;throw F._result}var ie=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent(Y))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)},H={map:W,forEach:function(F,Y,ne){W(F,function(){Y.apply(this,arguments)},ne)},count:function(F){var Y=0;return W(F,function(){Y++}),Y},toArray:function(F){return W(F,function(Y){return Y})||[]},only:function(F){if(!V(F))throw Error("React.Children.only expected to receive a single React element child.");return F}};return ot.Activity=p,ot.Children=H,ot.Component=T,ot.Fragment=t,ot.Profiler=i,ot.PureComponent=k,ot.StrictMode=r,ot.Suspense=u,ot.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,ot.__COMPILER_RUNTIME={__proto__:null,c:function(F){return A.H.useMemoCache(F)}},ot.cache=function(F){return function(){return F.apply(null,arguments)}},ot.cacheSignal=function(){return null},ot.cloneElement=function(F,Y,ne){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var Z=w({},F.props),oe=F.key;if(Y!=null)for(ue in Y.key!==void 0&&(oe=""+Y.key),Y)!I.call(Y,ue)||ue==="key"||ue==="__self"||ue==="__source"||ue==="ref"&&Y.ref===void 0||(Z[ue]=Y[ue]);var ue=arguments.length-2;if(ue===1)Z.children=ne;else if(1<ue){for(var ye=Array(ue),me=0;me<ue;me++)ye[me]=arguments[me+2];Z.children=ye}return D(F.type,oe,Z)},ot.createContext=function(F){return F={$$typeof:s,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:a,_context:F},F},ot.createElement=function(F,Y,ne){var Z,oe={},ue=null;if(Y!=null)for(Z in Y.key!==void 0&&(ue=""+Y.key),Y)I.call(Y,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(oe[Z]=Y[Z]);var ye=arguments.length-2;if(ye===1)oe.children=ne;else if(1<ye){for(var me=Array(ye),Te=0;Te<ye;Te++)me[Te]=arguments[Te+2];oe.children=me}if(F&&F.defaultProps)for(Z in ye=F.defaultProps,ye)oe[Z]===void 0&&(oe[Z]=ye[Z]);return D(F,ue,oe)},ot.createRef=function(){return{current:null}},ot.forwardRef=function(F){return{$$typeof:c,render:F}},ot.isValidElement=V,ot.lazy=function(F){return{$$typeof:h,_payload:{_status:-1,_result:F},_init:ee}},ot.memo=function(F,Y){return{$$typeof:d,type:F,compare:Y===void 0?null:Y}},ot.startTransition=function(F){var Y=A.T,ne={};A.T=ne;try{var Z=F(),oe=A.S;oe!==null&&oe(ne,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(N,ie)}catch(ue){ie(ue)}finally{Y!==null&&ne.types!==null&&(Y.types=ne.types),A.T=Y}},ot.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},ot.use=function(F){return A.H.use(F)},ot.useActionState=function(F,Y,ne){return A.H.useActionState(F,Y,ne)},ot.useCallback=function(F,Y){return A.H.useCallback(F,Y)},ot.useContext=function(F){return A.H.useContext(F)},ot.useDebugValue=function(){},ot.useDeferredValue=function(F,Y){return A.H.useDeferredValue(F,Y)},ot.useEffect=function(F,Y){return A.H.useEffect(F,Y)},ot.useEffectEvent=function(F){return A.H.useEffectEvent(F)},ot.useId=function(){return A.H.useId()},ot.useImperativeHandle=function(F,Y,ne){return A.H.useImperativeHandle(F,Y,ne)},ot.useInsertionEffect=function(F,Y){return A.H.useInsertionEffect(F,Y)},ot.useLayoutEffect=function(F,Y){return A.H.useLayoutEffect(F,Y)},ot.useMemo=function(F,Y){return A.H.useMemo(F,Y)},ot.useOptimistic=function(F,Y){return A.H.useOptimistic(F,Y)},ot.useReducer=function(F,Y,ne){return A.H.useReducer(F,Y,ne)},ot.useRef=function(F){return A.H.useRef(F)},ot.useState=function(F){return A.H.useState(F)},ot.useSyncExternalStore=function(F,Y,ne){return A.H.useSyncExternalStore(F,Y,ne)},ot.useTransition=function(){return A.H.useTransition()},ot.version="19.2.0",ot}var VI;function Aw(){return VI||(VI=1,Dx.exports=Xz()),Dx.exports}var U=Aw();const ch=Hz(U);var Nx={exports:{}},eh={},Mx={exports:{}},Px={};var zI;function Wz(){return zI||(zI=1,(function(n){function e($,W){var ee=$.length;$.push(W);e:for(;0<ee;){var ie=ee-1>>>1,H=$[ie];if(0<i(H,W))$[ie]=W,$[ee]=H,ee=ie;else break e}}function t($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var W=$[0],ee=$.pop();if(ee!==W){$[0]=ee;e:for(var ie=0,H=$.length,F=H>>>1;ie<F;){var Y=2*(ie+1)-1,ne=$[Y],Z=Y+1,oe=$[Z];if(0>i(ne,ee))Z<H&&0>i(oe,ne)?($[ie]=oe,$[Z]=ee,ie=Z):($[ie]=ne,$[Y]=ee,ie=Y);else if(Z<H&&0>i(oe,ee))$[ie]=oe,$[Z]=ee,ie=Z;else break e}}return W}function i($,W){var ee=$.sortIndex-W.sortIndex;return ee!==0?ee:$.id-W.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var s=Date,c=s.now();n.unstable_now=function(){return s.now()-c}}var u=[],d=[],h=1,p=null,m=3,b=!1,_=!1,w=!1,E=!1,T=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function j($){for(var W=t(d);W!==null;){if(W.callback===null)r(d);else if(W.startTime<=$)r(d),W.sortIndex=W.expirationTime,e(u,W);else break;W=t(d)}}function P($){if(w=!1,j($),!_)if(t(u)!==null)_=!0,N||(N=!0,B());else{var W=t(d);W!==null&&K(P,W.startTime-$)}}var N=!1,A=-1,I=5,D=-1;function z(){return E?!0:!(n.unstable_now()-D<I)}function V(){if(E=!1,N){var $=n.unstable_now();D=$;var W=!0;try{e:{_=!1,w&&(w=!1,C(A),A=-1),b=!0;var ee=m;try{t:{for(j($),p=t(u);p!==null&&!(p.expirationTime>$&&z());){var ie=p.callback;if(typeof ie=="function"){p.callback=null,m=p.priorityLevel;var H=ie(p.expirationTime<=$);if($=n.unstable_now(),typeof H=="function"){p.callback=H,j($),W=!0;break t}p===t(u)&&r(u),j($)}else r(u);p=t(u)}if(p!==null)W=!0;else{var F=t(d);F!==null&&K(P,F.startTime-$),W=!1}}break e}finally{p=null,m=ee,b=!1}W=void 0}}finally{W?B():N=!1}}}var B;if(typeof k=="function")B=function(){k(V)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,X=O.port2;O.port1.onmessage=V,B=function(){X.postMessage(null)}}else B=function(){T(V,0)};function K($,W){A=T(function(){$(n.unstable_now())},W)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function($){switch(m){case 1:case 2:case 3:var W=3;break;default:W=m}var ee=m;m=W;try{return $()}finally{m=ee}},n.unstable_requestPaint=function(){E=!0},n.unstable_runWithPriority=function($,W){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var ee=m;m=$;try{return W()}finally{m=ee}},n.unstable_scheduleCallback=function($,W,ee){var ie=n.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?ie+ee:ie):ee=ie,$){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=ee+H,$={id:h++,callback:W,priorityLevel:$,startTime:ee,expirationTime:H,sortIndex:-1},ee>ie?($.sortIndex=ee,e(d,$),t(u)===null&&$===t(d)&&(w?(C(A),A=-1):w=!0,K(P,ee-ie))):($.sortIndex=H,e(u,$),_||b||(_=!0,N||(N=!0,B()))),$},n.unstable_shouldYield=z,n.unstable_wrapCallback=function($){var W=m;return function(){var ee=m;m=W;try{return $.apply(this,arguments)}finally{m=ee}}}})(Px)),Px}var LI;function Qz(){return LI||(LI=1,Mx.exports=Wz()),Mx.exports}var Ox={exports:{}},fr={};var BI;function Zz(){if(BI)return fr;BI=1;var n=Aw();function e(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)d+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(u,d,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:p==null?null:""+p,children:u,containerInfo:d,implementation:h}}var s=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return fr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,fr.createPortal=function(u,d){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return a(u,d,null,h)},fr.flushSync=function(u){var d=s.T,h=r.p;try{if(s.T=null,r.p=2,u)return u()}finally{s.T=d,r.p=h,r.d.f()}},fr.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(u,d))},fr.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},fr.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin),m=typeof d.integrity=="string"?d.integrity:void 0,b=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;h==="style"?r.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:b}):h==="script"&&r.d.X(u,{crossOrigin:p,integrity:m,fetchPriority:b,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},fr.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var h=c(d.as,d.crossOrigin);r.d.M(u,{crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(u)},fr.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin);r.d.L(u,h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},fr.preloadModule=function(u,d){if(typeof u=="string")if(d){var h=c(d.as,d.crossOrigin);r.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(u)},fr.requestFormReset=function(u){r.d.r(u)},fr.unstable_batchedUpdates=function(u,d){return u(d)},fr.useFormState=function(u,d,h){return s.H.useFormState(u,d,h)},fr.useFormStatus=function(){return s.H.useHostTransitionStatus()},fr.version="19.2.0",fr}var UI;function Jz(){if(UI)return Ox.exports;UI=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Ox.exports=Zz(),Ox.exports}var FI;function e6(){if(FI)return eh;FI=1;var n=Qz(),e=Aw(),t=Jz();function r(o){var l="https://react.dev/errors/"+o;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+o+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function a(o){var l=o,f=o;if(o.alternate)for(;l.return;)l=l.return;else{o=l;do l=o,(l.flags&4098)!==0&&(f=l.return),o=l.return;while(o)}return l.tag===3?f:null}function s(o){if(o.tag===13){var l=o.memoizedState;if(l===null&&(o=o.alternate,o!==null&&(l=o.memoizedState)),l!==null)return l.dehydrated}return null}function c(o){if(o.tag===31){var l=o.memoizedState;if(l===null&&(o=o.alternate,o!==null&&(l=o.memoizedState)),l!==null)return l.dehydrated}return null}function u(o){if(a(o)!==o)throw Error(r(188))}function d(o){var l=o.alternate;if(!l){if(l=a(o),l===null)throw Error(r(188));return l!==o?null:o}for(var f=o,g=l;;){var x=f.return;if(x===null)break;var S=x.alternate;if(S===null){if(g=x.return,g!==null){f=g;continue}break}if(x.child===S.child){for(S=x.child;S;){if(S===f)return u(x),o;if(S===g)return u(x),l;S=S.sibling}throw Error(r(188))}if(f.return!==g.return)f=x,g=S;else{for(var M=!1,G=x.child;G;){if(G===f){M=!0,f=x,g=S;break}if(G===g){M=!0,g=x,f=S;break}G=G.sibling}if(!M){for(G=S.child;G;){if(G===f){M=!0,f=S,g=x;break}if(G===g){M=!0,g=S,f=x;break}G=G.sibling}if(!M)throw Error(r(189))}}if(f.alternate!==g)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?o:l}function h(o){var l=o.tag;if(l===5||l===26||l===27||l===6)return o;for(o=o.child;o!==null;){if(l=h(o),l!==null)return l;o=o.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),k=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),z=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function B(o){return o===null||typeof o!="object"?null:(o=V&&o[V]||o["@@iterator"],typeof o=="function"?o:null)}var O=Symbol.for("react.client.reference");function X(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===O?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case w:return"Fragment";case T:return"Profiler";case E:return"StrictMode";case P:return"Suspense";case N:return"SuspenseList";case D:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case _:return"Portal";case k:return o.displayName||"Context";case C:return(o._context.displayName||"Context")+".Consumer";case j:var l=o.render;return o=o.displayName,o||(o=l.displayName||l.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case A:return l=o.displayName||null,l!==null?l:X(o.type)||"Memo";case I:l=o._payload,o=o._init;try{return X(o(l))}catch{}}return null}var K=Array.isArray,$=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee={pending:!1,data:null,method:null,action:null},ie=[],H=-1;function F(o){return{current:o}}function Y(o){0>H||(o.current=ie[H],ie[H]=null,H--)}function ne(o,l){H++,ie[H]=o.current,o.current=l}var Z=F(null),oe=F(null),ue=F(null),ye=F(null);function me(o,l){switch(ne(ue,l),ne(oe,o),ne(Z,null),l.nodeType){case 9:case 11:o=(o=l.documentElement)&&(o=o.namespaceURI)?rI(o):0;break;default:if(o=l.tagName,l=l.namespaceURI)l=rI(l),o=iI(l,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}Y(Z),ne(Z,o)}function Te(){Y(Z),Y(oe),Y(ue)}function Me(o){o.memoizedState!==null&&ne(ye,o);var l=Z.current,f=iI(l,o.type);l!==f&&(ne(oe,o),ne(Z,f))}function ae(o){oe.current===o&&(Y(Z),Y(oe)),ye.current===o&&(Y(ye),Xf._currentValue=ee)}var Ce,Ne;function Oe(o){if(Ce===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);Ce=l&&l[1]||"",Ne=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ce+o+Ne}var Ge=!1;function Le(o,l){if(!o||Ge)return"";Ge=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(l){var _e=function(){throw Error()};if(Object.defineProperty(_e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_e,[])}catch(ge){var he=ge}Reflect.construct(o,[],_e)}else{try{_e.call()}catch(ge){he=ge}o.call(_e.prototype)}}else{try{throw Error()}catch(ge){he=ge}(_e=o())&&typeof _e.catch=="function"&&_e.catch(function(){})}}catch(ge){if(ge&&he&&typeof ge.stack=="string")return[ge.stack,he.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=g.DetermineComponentFrameRoot(),M=S[0],G=S[1];if(M&&G){var Q=M.split(`
`),fe=G.split(`
`);for(x=g=0;g<Q.length&&!Q[g].includes("DetermineComponentFrameRoot");)g++;for(;x<fe.length&&!fe[x].includes("DetermineComponentFrameRoot");)x++;if(g===Q.length||x===fe.length)for(g=Q.length-1,x=fe.length-1;1<=g&&0<=x&&Q[g]!==fe[x];)x--;for(;1<=g&&0<=x;g--,x--)if(Q[g]!==fe[x]){if(g!==1||x!==1)do if(g--,x--,0>x||Q[g]!==fe[x]){var be=`
`+Q[g].replace(" at new "," at ");return o.displayName&&be.includes("<anonymous>")&&(be=be.replace("<anonymous>",o.displayName)),be}while(1<=g&&0<=x);break}}}finally{Ge=!1,Error.prepareStackTrace=f}return(f=o?o.displayName||o.name:"")?Oe(f):""}function Se(o,l){switch(o.tag){case 26:case 27:case 5:return Oe(o.type);case 16:return Oe("Lazy");case 13:return o.child!==l&&l!==null?Oe("Suspense Fallback"):Oe("Suspense");case 19:return Oe("SuspenseList");case 0:case 15:return Le(o.type,!1);case 11:return Le(o.type.render,!1);case 1:return Le(o.type,!0);case 31:return Oe("Activity");default:return""}}function Be(o){try{var l="",f=null;do l+=Se(o,f),f=o,o=o.return;while(o);return l}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var Pe=Object.prototype.hasOwnProperty,Ue=n.unstable_scheduleCallback,lt=n.unstable_cancelCallback,Et=n.unstable_shouldYield,tt=n.unstable_requestPaint,ft=n.unstable_now,Dt=n.unstable_getCurrentPriorityLevel,pn=n.unstable_ImmediatePriority,Ot=n.unstable_UserBlockingPriority,Rn=n.unstable_NormalPriority,Yr=n.unstable_LowPriority,fa=n.unstable_IdlePriority,es=n.log,$s=n.unstable_setDisableYieldValue,Kr=null,kn=null;function dr(o){if(typeof es=="function"&&$s(o),kn&&typeof kn.setStrictMode=="function")try{kn.setStrictMode(Kr,o)}catch{}}var on=Math.clz32?Math.clz32:Ys,Bc=Math.log,Hs=Math.LN2;function Ys(o){return o>>>=0,o===0?32:31-(Bc(o)/Hs|0)|0}var mt=256,ln=262144,cn=4194304;function Xr(o){var l=o&42;if(l!==0)return l;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return o&261888;case 262144:case 524288:case 1048576:case 2097152:return o&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function fi(o,l,f){var g=o.pendingLanes;if(g===0)return 0;var x=0,S=o.suspendedLanes,M=o.pingedLanes;o=o.warmLanes;var G=g&134217727;return G!==0?(g=G&~S,g!==0?x=Xr(g):(M&=G,M!==0?x=Xr(M):f||(f=G&~o,f!==0&&(x=Xr(f))))):(G=g&~S,G!==0?x=Xr(G):M!==0?x=Xr(M):f||(f=g&~o,f!==0&&(x=Xr(f)))),x===0?0:l!==0&&l!==x&&(l&S)===0&&(S=x&-x,f=l&-l,S>=f||S===32&&(f&4194048)!==0)?l:x}function _r(o,l){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&l)===0}function Py(o,l){switch(o){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ug(){var o=cn;return cn<<=1,(cn&62914560)===0&&(cn=4194304),o}function ha(o){for(var l=[],f=0;31>f;f++)l.push(o);return l}function bl(o,l){o.pendingLanes|=l,l!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function Oy(o,l,f,g,x,S){var M=o.pendingLanes;o.pendingLanes=f,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=f,o.entangledLanes&=f,o.errorRecoveryDisabledLanes&=f,o.shellSuspendCounter=0;var G=o.entanglements,Q=o.expirationTimes,fe=o.hiddenUpdates;for(f=M&~f;0<f;){var be=31-on(f),_e=1<<be;G[be]=0,Q[be]=-1;var he=fe[be];if(he!==null)for(fe[be]=null,be=0;be<he.length;be++){var ge=he[be];ge!==null&&(ge.lane&=-536870913)}f&=~_e}g!==0&&xl(o,g,0),S!==0&&x===0&&o.tag!==0&&(o.suspendedLanes|=S&~(M&~l))}function xl(o,l,f){o.pendingLanes|=l,o.suspendedLanes&=~l;var g=31-on(l);o.entangledLanes|=l,o.entanglements[g]=o.entanglements[g]|1073741824|f&261930}function Jd(o,l){var f=o.entangledLanes|=l;for(o=o.entanglements;f;){var g=31-on(f),x=1<<g;x&l|o[g]&l&&(o[g]|=l),f&=~x}}function ef(o,l){var f=l&-l;return f=(f&42)!==0?1:_l(f),(f&(o.suspendedLanes|l))!==0?0:f}function _l(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function ts(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function dg(){var o=W.p;return o!==0?o:(o=window.event,o===void 0?32:CI(o.type))}function Ui(o,l){var f=W.p;try{return W.p=o,l()}finally{W.p=f}}var Fi=Math.random().toString(36).slice(2),Dn="__reactFiber$"+Fi,Zn="__reactProps$"+Fi,pa="__reactContainer$"+Fi,Uc="__reactEvents$"+Fi,jy="__reactListeners$"+Fi,fg="__reactHandles$"+Fi,hg="__reactResources$"+Fi,ga="__reactMarker$"+Fi;function Fc(o){delete o[Dn],delete o[Zn],delete o[Uc],delete o[jy],delete o[fg]}function ma(o){var l=o[Dn];if(l)return l;for(var f=o.parentNode;f;){if(l=f[pa]||f[Dn]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(o=dI(o);o!==null;){if(f=o[Dn])return f;o=dI(o)}return l}o=f,f=o.parentNode}return null}function hi(o){if(o=o[Dn]||o[pa]){var l=o.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return o}return null}function Wr(o){var l=o.tag;if(l===5||l===26||l===27||l===6)return o.stateNode;throw Error(r(33))}function va(o){var l=o[hg];return l||(l=o[hg]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Nn(o){o[ga]=!0}var tf=new Set,nf={};function ya(o,l){ba(o,l),ba(o+"Capture",l)}function ba(o,l){for(nf[o]=l,o=0;o<l.length;o++)tf.add(l[o])}var rf=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),af={},sf={};function pg(o){return Pe.call(sf,o)?!0:Pe.call(af,o)?!1:rf.test(o)?sf[o]=!0:(af[o]=!0,!1)}function Gc(o,l,f){if(pg(l))if(f===null)o.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":o.removeAttribute(l);return;case"boolean":var g=l.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){o.removeAttribute(l);return}}o.setAttribute(l,""+f)}}function Qr(o,l,f){if(f===null)o.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(l);return}o.setAttribute(l,""+f)}}function Mn(o,l,f,g){if(g===null)o.removeAttribute(f);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(f);return}o.setAttributeNS(l,f,""+g)}}function Jn(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function Ks(o){var l=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function of(o,l,f){var g=Object.getOwnPropertyDescriptor(o.constructor.prototype,l);if(!o.hasOwnProperty(l)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var x=g.get,S=g.set;return Object.defineProperty(o,l,{configurable:!0,get:function(){return x.call(this)},set:function(M){f=""+M,S.call(this,M)}}),Object.defineProperty(o,l,{enumerable:g.enumerable}),{getValue:function(){return f},setValue:function(M){f=""+M},stopTracking:function(){o._valueTracker=null,delete o[l]}}}}function jt(o){if(!o._valueTracker){var l=Ks(o)?"checked":"value";o._valueTracker=of(o,l,""+o[l])}}function wl(o){if(!o)return!1;var l=o._valueTracker;if(!l)return!0;var f=l.getValue(),g="";return o&&(g=Ks(o)?o.checked?"true":"false":o.value),o=g,o!==f?(l.setValue(o),!0):!1}function xa(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var Sl=/[\n"\\]/g;function Dr(o){return o.replace(Sl,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function qc(o,l,f,g,x,S,M,G){o.name="",M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?o.type=M:o.removeAttribute("type"),l!=null?M==="number"?(l===0&&o.value===""||o.value!=l)&&(o.value=""+Jn(l)):o.value!==""+Jn(l)&&(o.value=""+Jn(l)):M!=="submit"&&M!=="reset"||o.removeAttribute("value"),l!=null?lf(o,M,Jn(l)):f!=null?lf(o,M,Jn(f)):g!=null&&o.removeAttribute("value"),x==null&&S!=null&&(o.defaultChecked=!!S),x!=null&&(o.checked=x&&typeof x!="function"&&typeof x!="symbol"),G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"?o.name=""+Jn(G):o.removeAttribute("name")}function gg(o,l,f,g,x,S,M,G){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(o.type=S),l!=null||f!=null){if(!(S!=="submit"&&S!=="reset"||l!=null)){jt(o);return}f=f!=null?""+Jn(f):"",l=l!=null?""+Jn(l):f,G||l===o.value||(o.value=l),o.defaultValue=l}g=g??x,g=typeof g!="function"&&typeof g!="symbol"&&!!g,o.checked=G?o.checked:!!g,o.defaultChecked=!!g,M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"&&(o.name=M),jt(o)}function lf(o,l,f){l==="number"&&xa(o.ownerDocument)===o||o.defaultValue===""+f||(o.defaultValue=""+f)}function Xs(o,l,f,g){if(o=o.options,l){l={};for(var x=0;x<f.length;x++)l["$"+f[x]]=!0;for(f=0;f<o.length;f++)x=l.hasOwnProperty("$"+o[f].value),o[f].selected!==x&&(o[f].selected=x),x&&g&&(o[f].defaultSelected=!0)}else{for(f=""+Jn(f),l=null,x=0;x<o.length;x++){if(o[x].value===f){o[x].selected=!0,g&&(o[x].defaultSelected=!0);return}l!==null||o[x].disabled||(l=o[x])}l!==null&&(l.selected=!0)}}function mg(o,l,f){if(l!=null&&(l=""+Jn(l),l!==o.value&&(o.value=l),f==null)){o.defaultValue!==l&&(o.defaultValue=l);return}o.defaultValue=f!=null?""+Jn(f):""}function Ws(o,l,f,g){if(l==null){if(g!=null){if(f!=null)throw Error(r(92));if(K(g)){if(1<g.length)throw Error(r(93));g=g[0]}f=g}f==null&&(f=""),l=f}f=Jn(l),o.defaultValue=f,g=o.textContent,g===f&&g!==""&&g!==null&&(o.value=g),jt(o)}function Nr(o,l){if(l){var f=o.firstChild;if(f&&f===o.lastChild&&f.nodeType===3){f.nodeValue=l;return}}o.textContent=l}var vg=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function cf(o,l,f){var g=l.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?g?o.setProperty(l,""):l==="float"?o.cssFloat="":o[l]="":g?o.setProperty(l,f):typeof f!="number"||f===0||vg.has(l)?l==="float"?o.cssFloat=f:o[l]=(""+f).trim():o[l]=f+"px"}function uf(o,l,f){if(l!=null&&typeof l!="object")throw Error(r(62));if(o=o.style,f!=null){for(var g in f)!f.hasOwnProperty(g)||l!=null&&l.hasOwnProperty(g)||(g.indexOf("--")===0?o.setProperty(g,""):g==="float"?o.cssFloat="":o[g]="");for(var x in l)g=l[x],l.hasOwnProperty(x)&&f[x]!==g&&cf(o,x,g)}else for(var S in l)l.hasOwnProperty(S)&&cf(o,S,l[S])}function $c(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yg=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Qs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Hc(o){return Qs.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}function Gi(){}var df=null;function pi(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Zs=null,_a=null;function El(o){var l=hi(o);if(l&&(o=l.stateNode)){var f=o[Zn]||null;e:switch(o=l.stateNode,l.type){case"input":if(qc(o,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),l=f.name,f.type==="radio"&&l!=null){for(f=o;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Dr(""+l)+'"][type="radio"]'),l=0;l<f.length;l++){var g=f[l];if(g!==o&&g.form===o.form){var x=g[Zn]||null;if(!x)throw Error(r(90));qc(g,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(l=0;l<f.length;l++)g=f[l],g.form===o.form&&wl(g)}break e;case"textarea":mg(o,f.value,f.defaultValue);break e;case"select":l=f.value,l!=null&&Xs(o,!!f.multiple,l,!1)}}}var Yc=!1;function Js(o,l,f){if(Yc)return o(l,f);Yc=!0;try{var g=o(l);return g}finally{if(Yc=!1,(Zs!==null||_a!==null)&&(dm(),Zs&&(l=Zs,o=_a,_a=Zs=null,El(l),o)))for(l=0;l<o.length;l++)El(o[l])}}function qi(o,l){var f=o.stateNode;if(f===null)return null;var g=f[Zn]||null;if(g===null)return null;f=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(o=o.type,g=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!g;break e;default:o=!1}if(o)return null;if(f&&typeof f!="function")throw Error(r(231,l,typeof f));return f}var gi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tl=!1;if(gi)try{var Ft={};Object.defineProperty(Ft,"passive",{get:function(){Tl=!0}}),window.addEventListener("test",Ft,Ft),window.removeEventListener("test",Ft,Ft)}catch{Tl=!1}var wa=null,ff=null,Al=null;function hf(){if(Al)return Al;var o,l=ff,f=l.length,g,x="value"in wa?wa.value:wa.textContent,S=x.length;for(o=0;o<f&&l[o]===x[o];o++);var M=f-o;for(g=1;g<=M&&l[f-g]===x[S-g];g++);return Al=x.slice(o,1<g?1-g:void 0)}function Cl(o){var l=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&l===13&&(o=13)):o=l,o===10&&(o=13),32<=o||o===13?o:0}function ns(){return!0}function $i(){return!1}function nr(o){function l(f,g,x,S,M){this._reactName=f,this._targetInst=x,this.type=g,this.nativeEvent=S,this.target=M,this.currentTarget=null;for(var G in o)o.hasOwnProperty(G)&&(f=o[G],this[G]=f?f(S):S[G]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?ns:$i,this.isPropagationStopped=$i,this}return p(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=ns)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=ns)},persist:function(){},isPersistent:ns}),l}var rs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sa=nr(rs),eo=p({},rs,{view:0,detail:0}),pf=nr(eo),to,Kc,Ea,Xc=p({},eo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:no,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Ea&&(Ea&&o.type==="mousemove"?(to=o.screenX-Ea.screenX,Kc=o.screenY-Ea.screenY):Kc=to=0,Ea=o),to)},movementY:function(o){return"movementY"in o?o.movementY:Kc}}),gf=nr(Xc),Il=p({},Xc,{dataTransfer:0}),bg=nr(Il),xg=p({},eo,{relatedTarget:0}),Rl=nr(xg),mf=p({},rs,{animationName:0,elapsedTime:0,pseudoElement:0}),_g=nr(mf),Wc=p({},rs,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),wg=nr(Wc),Sg=p({},rs,{data:0}),Ta=nr(Sg),Eg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Tg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ag={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cg(o){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(o):(o=Ag[o])?!!l[o]:!1}function no(){return Cg}var wr=p({},eo,{key:function(o){if(o.key){var l=Eg[o.key]||o.key;if(l!=="Unidentified")return l}return o.type==="keypress"?(o=Cl(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?Tg[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:no,charCode:function(o){return o.type==="keypress"?Cl(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Cl(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),Ig=nr(wr),Rg=p({},Xc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),is=nr(Rg),y=p({},eo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:no}),R=nr(y),L=p({},rs,{propertyName:0,elapsedTime:0,pseudoElement:0}),q=nr(L),ce=p({},Xc,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),pe=nr(ce),ke=p({},rs,{newState:0,oldState:0}),ct=nr(ke),wn=[9,13,27,32],Nt=gi&&"CompositionEvent"in window,tn=null;gi&&"documentMode"in document&&(tn=document.documentMode);var mi=gi&&"TextEvent"in window&&!tn,Aa=gi&&(!Nt||tn&&8<tn&&11>=tn),Hi=" ",Yi=!1;function kl(o,l){switch(o){case"keyup":return wn.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qc(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var Zc=!1;function m5(o,l){switch(o){case"compositionend":return Qc(l);case"keypress":return l.which!==32?null:(Yi=!0,Hi);case"textInput":return o=l.data,o===Hi&&Yi?null:o;default:return null}}function v5(o,l){if(Zc)return o==="compositionend"||!Nt&&kl(o,l)?(o=hf(),Al=ff=wa=null,Zc=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Aa&&l.locale!=="ko"?null:l.data;default:return null}}var y5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pT(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l==="input"?!!y5[o.type]:l==="textarea"}function gT(o,l,f,g){Zs?_a?_a.push(g):_a=[g]:Zs=g,l=ym(l,"onChange"),0<l.length&&(f=new Sa("onChange","change",null,f,g),o.push({event:f,listeners:l}))}var vf=null,yf=null;function b5(o){QC(o,0)}function kg(o){var l=Wr(o);if(wl(l))return o}function mT(o,l){if(o==="change")return l}var vT=!1;if(gi){var Vy;if(gi){var zy="oninput"in document;if(!zy){var yT=document.createElement("div");yT.setAttribute("oninput","return;"),zy=typeof yT.oninput=="function"}Vy=zy}else Vy=!1;vT=Vy&&(!document.documentMode||9<document.documentMode)}function bT(){vf&&(vf.detachEvent("onpropertychange",xT),yf=vf=null)}function xT(o){if(o.propertyName==="value"&&kg(yf)){var l=[];gT(l,yf,o,pi(o)),Js(b5,l)}}function x5(o,l,f){o==="focusin"?(bT(),vf=l,yf=f,vf.attachEvent("onpropertychange",xT)):o==="focusout"&&bT()}function _5(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return kg(yf)}function w5(o,l){if(o==="click")return kg(l)}function S5(o,l){if(o==="input"||o==="change")return kg(l)}function E5(o,l){return o===l&&(o!==0||1/o===1/l)||o!==o&&l!==l}var Zr=typeof Object.is=="function"?Object.is:E5;function bf(o,l){if(Zr(o,l))return!0;if(typeof o!="object"||o===null||typeof l!="object"||l===null)return!1;var f=Object.keys(o),g=Object.keys(l);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var x=f[g];if(!Pe.call(l,x)||!Zr(o[x],l[x]))return!1}return!0}function _T(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function wT(o,l){var f=_T(o);o=0;for(var g;f;){if(f.nodeType===3){if(g=o+f.textContent.length,o<=l&&g>=l)return{node:f,offset:l-o};o=g}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=_T(f)}}function ST(o,l){return o&&l?o===l?!0:o&&o.nodeType===3?!1:l&&l.nodeType===3?ST(o,l.parentNode):"contains"in o?o.contains(l):o.compareDocumentPosition?!!(o.compareDocumentPosition(l)&16):!1:!1}function ET(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var l=xa(o.document);l instanceof o.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)o=l.contentWindow;else break;l=xa(o.document)}return l}function Ly(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l&&(l==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||l==="textarea"||o.contentEditable==="true")}var T5=gi&&"documentMode"in document&&11>=document.documentMode,Jc=null,By=null,xf=null,Uy=!1;function TT(o,l,f){var g=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Uy||Jc==null||Jc!==xa(g)||(g=Jc,"selectionStart"in g&&Ly(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),xf&&bf(xf,g)||(xf=g,g=ym(By,"onSelect"),0<g.length&&(l=new Sa("onSelect","select",null,l,f),o.push({event:l,listeners:g}),l.target=Jc)))}function Dl(o,l){var f={};return f[o.toLowerCase()]=l.toLowerCase(),f["Webkit"+o]="webkit"+l,f["Moz"+o]="moz"+l,f}var eu={animationend:Dl("Animation","AnimationEnd"),animationiteration:Dl("Animation","AnimationIteration"),animationstart:Dl("Animation","AnimationStart"),transitionrun:Dl("Transition","TransitionRun"),transitionstart:Dl("Transition","TransitionStart"),transitioncancel:Dl("Transition","TransitionCancel"),transitionend:Dl("Transition","TransitionEnd")},Fy={},AT={};gi&&(AT=document.createElement("div").style,"AnimationEvent"in window||(delete eu.animationend.animation,delete eu.animationiteration.animation,delete eu.animationstart.animation),"TransitionEvent"in window||delete eu.transitionend.transition);function Nl(o){if(Fy[o])return Fy[o];if(!eu[o])return o;var l=eu[o],f;for(f in l)if(l.hasOwnProperty(f)&&f in AT)return Fy[o]=l[f];return o}var CT=Nl("animationend"),IT=Nl("animationiteration"),RT=Nl("animationstart"),A5=Nl("transitionrun"),C5=Nl("transitionstart"),I5=Nl("transitioncancel"),kT=Nl("transitionend"),DT=new Map,Gy="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Gy.push("scrollEnd");function Ki(o,l){DT.set(o,l),ya(l,[o])}var Dg=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)},vi=[],tu=0,qy=0;function Ng(){for(var o=tu,l=qy=tu=0;l<o;){var f=vi[l];vi[l++]=null;var g=vi[l];vi[l++]=null;var x=vi[l];vi[l++]=null;var S=vi[l];if(vi[l++]=null,g!==null&&x!==null){var M=g.pending;M===null?x.next=x:(x.next=M.next,M.next=x),g.pending=x}S!==0&&NT(f,x,S)}}function Mg(o,l,f,g){vi[tu++]=o,vi[tu++]=l,vi[tu++]=f,vi[tu++]=g,qy|=g,o.lanes|=g,o=o.alternate,o!==null&&(o.lanes|=g)}function $y(o,l,f,g){return Mg(o,l,f,g),Pg(o)}function Ml(o,l){return Mg(o,null,null,l),Pg(o)}function NT(o,l,f){o.lanes|=f;var g=o.alternate;g!==null&&(g.lanes|=f);for(var x=!1,S=o.return;S!==null;)S.childLanes|=f,g=S.alternate,g!==null&&(g.childLanes|=f),S.tag===22&&(o=S.stateNode,o===null||o._visibility&1||(x=!0)),o=S,S=S.return;return o.tag===3?(S=o.stateNode,x&&l!==null&&(x=31-on(f),o=S.hiddenUpdates,g=o[x],g===null?o[x]=[l]:g.push(l),l.lane=f|536870912),S):null}function Pg(o){if(50<Ff)throw Ff=0,ex=null,Error(r(185));for(var l=o.return;l!==null;)o=l,l=o.return;return o.tag===3?o.stateNode:null}var nu={};function R5(o,l,f,g){this.tag=o,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jr(o,l,f,g){return new R5(o,l,f,g)}function Hy(o){return o=o.prototype,!(!o||!o.isReactComponent)}function as(o,l){var f=o.alternate;return f===null?(f=Jr(o.tag,l,o.key,o.mode),f.elementType=o.elementType,f.type=o.type,f.stateNode=o.stateNode,f.alternate=o,o.alternate=f):(f.pendingProps=l,f.type=o.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=o.flags&65011712,f.childLanes=o.childLanes,f.lanes=o.lanes,f.child=o.child,f.memoizedProps=o.memoizedProps,f.memoizedState=o.memoizedState,f.updateQueue=o.updateQueue,l=o.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=o.sibling,f.index=o.index,f.ref=o.ref,f.refCleanup=o.refCleanup,f}function MT(o,l){o.flags&=65011714;var f=o.alternate;return f===null?(o.childLanes=0,o.lanes=l,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=f.childLanes,o.lanes=f.lanes,o.child=f.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=f.memoizedProps,o.memoizedState=f.memoizedState,o.updateQueue=f.updateQueue,o.type=f.type,l=f.dependencies,o.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),o}function Og(o,l,f,g,x,S){var M=0;if(g=o,typeof o=="function")Hy(o)&&(M=1);else if(typeof o=="string")M=Pz(o,f,Z.current)?26:o==="html"||o==="head"||o==="body"?27:5;else e:switch(o){case D:return o=Jr(31,f,l,x),o.elementType=D,o.lanes=S,o;case w:return Pl(f.children,x,S,l);case E:M=8,x|=24;break;case T:return o=Jr(12,f,l,x|2),o.elementType=T,o.lanes=S,o;case P:return o=Jr(13,f,l,x),o.elementType=P,o.lanes=S,o;case N:return o=Jr(19,f,l,x),o.elementType=N,o.lanes=S,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case k:M=10;break e;case C:M=9;break e;case j:M=11;break e;case A:M=14;break e;case I:M=16,g=null;break e}M=29,f=Error(r(130,o===null?"null":typeof o,"")),g=null}return l=Jr(M,f,l,x),l.elementType=o,l.type=g,l.lanes=S,l}function Pl(o,l,f,g){return o=Jr(7,o,g,l),o.lanes=f,o}function Yy(o,l,f){return o=Jr(6,o,null,l),o.lanes=f,o}function PT(o){var l=Jr(18,null,null,0);return l.stateNode=o,l}function Ky(o,l,f){return l=Jr(4,o.children!==null?o.children:[],o.key,l),l.lanes=f,l.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},l}var OT=new WeakMap;function yi(o,l){if(typeof o=="object"&&o!==null){var f=OT.get(o);return f!==void 0?f:(l={value:o,source:l,stack:Be(l)},OT.set(o,l),l)}return{value:o,source:l,stack:Be(l)}}var ru=[],iu=0,jg=null,_f=0,bi=[],xi=0,ro=null,Ca=1,Ia="";function ss(o,l){ru[iu++]=_f,ru[iu++]=jg,jg=o,_f=l}function jT(o,l,f){bi[xi++]=Ca,bi[xi++]=Ia,bi[xi++]=ro,ro=o;var g=Ca;o=Ia;var x=32-on(g)-1;g&=~(1<<x),f+=1;var S=32-on(l)+x;if(30<S){var M=x-x%5;S=(g&(1<<M)-1).toString(32),g>>=M,x-=M,Ca=1<<32-on(l)+x|f<<x|g,Ia=S+o}else Ca=1<<S|f<<x|g,Ia=o}function Xy(o){o.return!==null&&(ss(o,1),jT(o,1,0))}function Wy(o){for(;o===jg;)jg=ru[--iu],ru[iu]=null,_f=ru[--iu],ru[iu]=null;for(;o===ro;)ro=bi[--xi],bi[xi]=null,Ia=bi[--xi],bi[xi]=null,Ca=bi[--xi],bi[xi]=null}function VT(o,l){bi[xi++]=Ca,bi[xi++]=Ia,bi[xi++]=ro,Ca=l.id,Ia=l.overflow,ro=o}var rr=null,Zt=null,Tt=!1,io=null,_i=!1,Qy=Error(r(519));function ao(o){var l=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw wf(yi(l,o)),Qy}function zT(o){var l=o.stateNode,f=o.type,g=o.memoizedProps;switch(l[Dn]=o,l[Zn]=g,f){case"dialog":yt("cancel",l),yt("close",l);break;case"iframe":case"object":case"embed":yt("load",l);break;case"video":case"audio":for(f=0;f<qf.length;f++)yt(qf[f],l);break;case"source":yt("error",l);break;case"img":case"image":case"link":yt("error",l),yt("load",l);break;case"details":yt("toggle",l);break;case"input":yt("invalid",l),gg(l,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":yt("invalid",l);break;case"textarea":yt("invalid",l),Ws(l,g.value,g.defaultValue,g.children)}f=g.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||l.textContent===""+f||g.suppressHydrationWarning===!0||tI(l.textContent,f)?(g.popover!=null&&(yt("beforetoggle",l),yt("toggle",l)),g.onScroll!=null&&yt("scroll",l),g.onScrollEnd!=null&&yt("scrollend",l),g.onClick!=null&&(l.onclick=Gi),l=!0):l=!1,l||ao(o,!0)}function LT(o){for(rr=o.return;rr;)switch(rr.tag){case 5:case 31:case 13:_i=!1;return;case 27:case 3:_i=!0;return;default:rr=rr.return}}function au(o){if(o!==rr)return!1;if(!Tt)return LT(o),Tt=!0,!1;var l=o.tag,f;if((f=l!==3&&l!==27)&&((f=l===5)&&(f=o.type,f=!(f!=="form"&&f!=="button")||gx(o.type,o.memoizedProps)),f=!f),f&&Zt&&ao(o),LT(o),l===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(r(317));Zt=uI(o)}else if(l===31){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(r(317));Zt=uI(o)}else l===27?(l=Zt,xo(o.type)?(o=xx,xx=null,Zt=o):Zt=l):Zt=rr?Si(o.stateNode.nextSibling):null;return!0}function Ol(){Zt=rr=null,Tt=!1}function Zy(){var o=io;return o!==null&&(jr===null?jr=o:jr.push.apply(jr,o),io=null),o}function wf(o){io===null?io=[o]:io.push(o)}var Jy=F(null),jl=null,os=null;function so(o,l,f){ne(Jy,l._currentValue),l._currentValue=f}function ls(o){o._currentValue=Jy.current,Y(Jy)}function eb(o,l,f){for(;o!==null;){var g=o.alternate;if((o.childLanes&l)!==l?(o.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),o===f)break;o=o.return}}function tb(o,l,f,g){var x=o.child;for(x!==null&&(x.return=o);x!==null;){var S=x.dependencies;if(S!==null){var M=x.child;S=S.firstContext;e:for(;S!==null;){var G=S;S=x;for(var Q=0;Q<l.length;Q++)if(G.context===l[Q]){S.lanes|=f,G=S.alternate,G!==null&&(G.lanes|=f),eb(S.return,f,o),g||(M=null);break e}S=G.next}}else if(x.tag===18){if(M=x.return,M===null)throw Error(r(341));M.lanes|=f,S=M.alternate,S!==null&&(S.lanes|=f),eb(M,f,o),M=null}else M=x.child;if(M!==null)M.return=x;else for(M=x;M!==null;){if(M===o){M=null;break}if(x=M.sibling,x!==null){x.return=M.return,M=x;break}M=M.return}x=M}}function su(o,l,f,g){o=null;for(var x=l,S=!1;x!==null;){if(!S){if((x.flags&524288)!==0)S=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var M=x.alternate;if(M===null)throw Error(r(387));if(M=M.memoizedProps,M!==null){var G=x.type;Zr(x.pendingProps.value,M.value)||(o!==null?o.push(G):o=[G])}}else if(x===ye.current){if(M=x.alternate,M===null)throw Error(r(387));M.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(o!==null?o.push(Xf):o=[Xf])}x=x.return}o!==null&&tb(l,o,f,g),l.flags|=262144}function Vg(o){for(o=o.firstContext;o!==null;){if(!Zr(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function Vl(o){jl=o,os=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function ir(o){return BT(jl,o)}function zg(o,l){return jl===null&&Vl(o),BT(o,l)}function BT(o,l){var f=l._currentValue;if(l={context:l,memoizedValue:f,next:null},os===null){if(o===null)throw Error(r(308));os=l,o.dependencies={lanes:0,firstContext:l},o.flags|=524288}else os=os.next=l;return f}var k5=typeof AbortController<"u"?AbortController:function(){var o=[],l=this.signal={aborted:!1,addEventListener:function(f,g){o.push(g)}};this.abort=function(){l.aborted=!0,o.forEach(function(f){return f()})}},D5=n.unstable_scheduleCallback,N5=n.unstable_NormalPriority,Pn={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function nb(){return{controller:new k5,data:new Map,refCount:0}}function Sf(o){o.refCount--,o.refCount===0&&D5(N5,function(){o.controller.abort()})}var Ef=null,rb=0,ou=0,lu=null;function M5(o,l){if(Ef===null){var f=Ef=[];rb=0,ou=sx(),lu={status:"pending",value:void 0,then:function(g){f.push(g)}}}return rb++,l.then(UT,UT),l}function UT(){if(--rb===0&&Ef!==null){lu!==null&&(lu.status="fulfilled");var o=Ef;Ef=null,ou=0,lu=null;for(var l=0;l<o.length;l++)(0,o[l])()}}function P5(o,l){var f=[],g={status:"pending",value:null,reason:null,then:function(x){f.push(x)}};return o.then(function(){g.status="fulfilled",g.value=l;for(var x=0;x<f.length;x++)(0,f[x])(l)},function(x){for(g.status="rejected",g.reason=x,x=0;x<f.length;x++)(0,f[x])(void 0)}),g}var FT=$.S;$.S=function(o,l){TC=ft(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&M5(o,l),FT!==null&&FT(o,l)};var zl=F(null);function ib(){var o=zl.current;return o!==null?o:Kt.pooledCache}function Lg(o,l){l===null?ne(zl,zl.current):ne(zl,l.pool)}function GT(){var o=ib();return o===null?null:{parent:Pn._currentValue,pool:o}}var cu=Error(r(460)),ab=Error(r(474)),Bg=Error(r(542)),Ug={then:function(){}};function qT(o){return o=o.status,o==="fulfilled"||o==="rejected"}function $T(o,l,f){switch(f=o[f],f===void 0?o.push(l):f!==l&&(l.then(Gi,Gi),l=f),l.status){case"fulfilled":return l.value;case"rejected":throw o=l.reason,YT(o),o;default:if(typeof l.status=="string")l.then(Gi,Gi);else{if(o=Kt,o!==null&&100<o.shellSuspendCounter)throw Error(r(482));o=l,o.status="pending",o.then(function(g){if(l.status==="pending"){var x=l;x.status="fulfilled",x.value=g}},function(g){if(l.status==="pending"){var x=l;x.status="rejected",x.reason=g}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw o=l.reason,YT(o),o}throw Bl=l,cu}}function Ll(o){try{var l=o._init;return l(o._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(Bl=f,cu):f}}var Bl=null;function HT(){if(Bl===null)throw Error(r(459));var o=Bl;return Bl=null,o}function YT(o){if(o===cu||o===Bg)throw Error(r(483))}var uu=null,Tf=0;function Fg(o){var l=Tf;return Tf+=1,uu===null&&(uu=[]),$T(uu,o,l)}function Af(o,l){l=l.props.ref,o.ref=l!==void 0?l:null}function Gg(o,l){throw l.$$typeof===m?Error(r(525)):(o=Object.prototype.toString.call(l),Error(r(31,o==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":o)))}function KT(o){function l(se,re){if(o){var de=se.deletions;de===null?(se.deletions=[re],se.flags|=16):de.push(re)}}function f(se,re){if(!o)return null;for(;re!==null;)l(se,re),re=re.sibling;return null}function g(se){for(var re=new Map;se!==null;)se.key!==null?re.set(se.key,se):re.set(se.index,se),se=se.sibling;return re}function x(se,re){return se=as(se,re),se.index=0,se.sibling=null,se}function S(se,re,de){return se.index=de,o?(de=se.alternate,de!==null?(de=de.index,de<re?(se.flags|=67108866,re):de):(se.flags|=67108866,re)):(se.flags|=1048576,re)}function M(se){return o&&se.alternate===null&&(se.flags|=67108866),se}function G(se,re,de,xe){return re===null||re.tag!==6?(re=Yy(de,se.mode,xe),re.return=se,re):(re=x(re,de),re.return=se,re)}function Q(se,re,de,xe){var Ke=de.type;return Ke===w?be(se,re,de.props.children,xe,de.key):re!==null&&(re.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===I&&Ll(Ke)===re.type)?(re=x(re,de.props),Af(re,de),re.return=se,re):(re=Og(de.type,de.key,de.props,null,se.mode,xe),Af(re,de),re.return=se,re)}function fe(se,re,de,xe){return re===null||re.tag!==4||re.stateNode.containerInfo!==de.containerInfo||re.stateNode.implementation!==de.implementation?(re=Ky(de,se.mode,xe),re.return=se,re):(re=x(re,de.children||[]),re.return=se,re)}function be(se,re,de,xe,Ke){return re===null||re.tag!==7?(re=Pl(de,se.mode,xe,Ke),re.return=se,re):(re=x(re,de),re.return=se,re)}function _e(se,re,de){if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return re=Yy(""+re,se.mode,de),re.return=se,re;if(typeof re=="object"&&re!==null){switch(re.$$typeof){case b:return de=Og(re.type,re.key,re.props,null,se.mode,de),Af(de,re),de.return=se,de;case _:return re=Ky(re,se.mode,de),re.return=se,re;case I:return re=Ll(re),_e(se,re,de)}if(K(re)||B(re))return re=Pl(re,se.mode,de,null),re.return=se,re;if(typeof re.then=="function")return _e(se,Fg(re),de);if(re.$$typeof===k)return _e(se,zg(se,re),de);Gg(se,re)}return null}function he(se,re,de,xe){var Ke=re!==null?re.key:null;if(typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint")return Ke!==null?null:G(se,re,""+de,xe);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case b:return de.key===Ke?Q(se,re,de,xe):null;case _:return de.key===Ke?fe(se,re,de,xe):null;case I:return de=Ll(de),he(se,re,de,xe)}if(K(de)||B(de))return Ke!==null?null:be(se,re,de,xe,null);if(typeof de.then=="function")return he(se,re,Fg(de),xe);if(de.$$typeof===k)return he(se,re,zg(se,de),xe);Gg(se,de)}return null}function ge(se,re,de,xe,Ke){if(typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint")return se=se.get(de)||null,G(re,se,""+xe,Ke);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case b:return se=se.get(xe.key===null?de:xe.key)||null,Q(re,se,xe,Ke);case _:return se=se.get(xe.key===null?de:xe.key)||null,fe(re,se,xe,Ke);case I:return xe=Ll(xe),ge(se,re,de,xe,Ke)}if(K(xe)||B(xe))return se=se.get(de)||null,be(re,se,xe,Ke,null);if(typeof xe.then=="function")return ge(se,re,de,Fg(xe),Ke);if(xe.$$typeof===k)return ge(se,re,de,zg(re,xe),Ke);Gg(re,xe)}return null}function ze(se,re,de,xe){for(var Ke=null,Rt=null,qe=re,ht=re=0,xt=null;qe!==null&&ht<de.length;ht++){qe.index>ht?(xt=qe,qe=null):xt=qe.sibling;var kt=he(se,qe,de[ht],xe);if(kt===null){qe===null&&(qe=xt);break}o&&qe&&kt.alternate===null&&l(se,qe),re=S(kt,re,ht),Rt===null?Ke=kt:Rt.sibling=kt,Rt=kt,qe=xt}if(ht===de.length)return f(se,qe),Tt&&ss(se,ht),Ke;if(qe===null){for(;ht<de.length;ht++)qe=_e(se,de[ht],xe),qe!==null&&(re=S(qe,re,ht),Rt===null?Ke=qe:Rt.sibling=qe,Rt=qe);return Tt&&ss(se,ht),Ke}for(qe=g(qe);ht<de.length;ht++)xt=ge(qe,se,ht,de[ht],xe),xt!==null&&(o&&xt.alternate!==null&&qe.delete(xt.key===null?ht:xt.key),re=S(xt,re,ht),Rt===null?Ke=xt:Rt.sibling=xt,Rt=xt);return o&&qe.forEach(function(To){return l(se,To)}),Tt&&ss(se,ht),Ke}function Ze(se,re,de,xe){if(de==null)throw Error(r(151));for(var Ke=null,Rt=null,qe=re,ht=re=0,xt=null,kt=de.next();qe!==null&&!kt.done;ht++,kt=de.next()){qe.index>ht?(xt=qe,qe=null):xt=qe.sibling;var To=he(se,qe,kt.value,xe);if(To===null){qe===null&&(qe=xt);break}o&&qe&&To.alternate===null&&l(se,qe),re=S(To,re,ht),Rt===null?Ke=To:Rt.sibling=To,Rt=To,qe=xt}if(kt.done)return f(se,qe),Tt&&ss(se,ht),Ke;if(qe===null){for(;!kt.done;ht++,kt=de.next())kt=_e(se,kt.value,xe),kt!==null&&(re=S(kt,re,ht),Rt===null?Ke=kt:Rt.sibling=kt,Rt=kt);return Tt&&ss(se,ht),Ke}for(qe=g(qe);!kt.done;ht++,kt=de.next())kt=ge(qe,se,ht,kt.value,xe),kt!==null&&(o&&kt.alternate!==null&&qe.delete(kt.key===null?ht:kt.key),re=S(kt,re,ht),Rt===null?Ke=kt:Rt.sibling=kt,Rt=kt);return o&&qe.forEach(function($z){return l(se,$z)}),Tt&&ss(se,ht),Ke}function $t(se,re,de,xe){if(typeof de=="object"&&de!==null&&de.type===w&&de.key===null&&(de=de.props.children),typeof de=="object"&&de!==null){switch(de.$$typeof){case b:e:{for(var Ke=de.key;re!==null;){if(re.key===Ke){if(Ke=de.type,Ke===w){if(re.tag===7){f(se,re.sibling),xe=x(re,de.props.children),xe.return=se,se=xe;break e}}else if(re.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===I&&Ll(Ke)===re.type){f(se,re.sibling),xe=x(re,de.props),Af(xe,de),xe.return=se,se=xe;break e}f(se,re);break}else l(se,re);re=re.sibling}de.type===w?(xe=Pl(de.props.children,se.mode,xe,de.key),xe.return=se,se=xe):(xe=Og(de.type,de.key,de.props,null,se.mode,xe),Af(xe,de),xe.return=se,se=xe)}return M(se);case _:e:{for(Ke=de.key;re!==null;){if(re.key===Ke)if(re.tag===4&&re.stateNode.containerInfo===de.containerInfo&&re.stateNode.implementation===de.implementation){f(se,re.sibling),xe=x(re,de.children||[]),xe.return=se,se=xe;break e}else{f(se,re);break}else l(se,re);re=re.sibling}xe=Ky(de,se.mode,xe),xe.return=se,se=xe}return M(se);case I:return de=Ll(de),$t(se,re,de,xe)}if(K(de))return ze(se,re,de,xe);if(B(de)){if(Ke=B(de),typeof Ke!="function")throw Error(r(150));return de=Ke.call(de),Ze(se,re,de,xe)}if(typeof de.then=="function")return $t(se,re,Fg(de),xe);if(de.$$typeof===k)return $t(se,re,zg(se,de),xe);Gg(se,de)}return typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint"?(de=""+de,re!==null&&re.tag===6?(f(se,re.sibling),xe=x(re,de),xe.return=se,se=xe):(f(se,re),xe=Yy(de,se.mode,xe),xe.return=se,se=xe),M(se)):f(se,re)}return function(se,re,de,xe){try{Tf=0;var Ke=$t(se,re,de,xe);return uu=null,Ke}catch(qe){if(qe===cu||qe===Bg)throw qe;var Rt=Jr(29,qe,null,se.mode);return Rt.lanes=xe,Rt.return=se,Rt}finally{}}}var Ul=KT(!0),XT=KT(!1),oo=!1;function sb(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ob(o,l){o=o.updateQueue,l.updateQueue===o&&(l.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function lo(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function co(o,l,f){var g=o.updateQueue;if(g===null)return null;if(g=g.shared,(Mt&2)!==0){var x=g.pending;return x===null?l.next=l:(l.next=x.next,x.next=l),g.pending=l,l=Pg(o),NT(o,null,f),l}return Mg(o,g,l,f),Pg(o)}function Cf(o,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194048)!==0)){var g=l.lanes;g&=o.pendingLanes,f|=g,l.lanes=f,Jd(o,f)}}function lb(o,l){var f=o.updateQueue,g=o.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var x=null,S=null;if(f=f.firstBaseUpdate,f!==null){do{var M={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};S===null?x=S=M:S=S.next=M,f=f.next}while(f!==null);S===null?x=S=l:S=S.next=l}else x=S=l;f={baseState:g.baseState,firstBaseUpdate:x,lastBaseUpdate:S,shared:g.shared,callbacks:g.callbacks},o.updateQueue=f;return}o=f.lastBaseUpdate,o===null?f.firstBaseUpdate=l:o.next=l,f.lastBaseUpdate=l}var cb=!1;function If(){if(cb){var o=lu;if(o!==null)throw o}}function Rf(o,l,f,g){cb=!1;var x=o.updateQueue;oo=!1;var S=x.firstBaseUpdate,M=x.lastBaseUpdate,G=x.shared.pending;if(G!==null){x.shared.pending=null;var Q=G,fe=Q.next;Q.next=null,M===null?S=fe:M.next=fe,M=Q;var be=o.alternate;be!==null&&(be=be.updateQueue,G=be.lastBaseUpdate,G!==M&&(G===null?be.firstBaseUpdate=fe:G.next=fe,be.lastBaseUpdate=Q))}if(S!==null){var _e=x.baseState;M=0,be=fe=Q=null,G=S;do{var he=G.lane&-536870913,ge=he!==G.lane;if(ge?(bt&he)===he:(g&he)===he){he!==0&&he===ou&&(cb=!0),be!==null&&(be=be.next={lane:0,tag:G.tag,payload:G.payload,callback:null,next:null});e:{var ze=o,Ze=G;he=l;var $t=f;switch(Ze.tag){case 1:if(ze=Ze.payload,typeof ze=="function"){_e=ze.call($t,_e,he);break e}_e=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=Ze.payload,he=typeof ze=="function"?ze.call($t,_e,he):ze,he==null)break e;_e=p({},_e,he);break e;case 2:oo=!0}}he=G.callback,he!==null&&(o.flags|=64,ge&&(o.flags|=8192),ge=x.callbacks,ge===null?x.callbacks=[he]:ge.push(he))}else ge={lane:he,tag:G.tag,payload:G.payload,callback:G.callback,next:null},be===null?(fe=be=ge,Q=_e):be=be.next=ge,M|=he;if(G=G.next,G===null){if(G=x.shared.pending,G===null)break;ge=G,G=ge.next,ge.next=null,x.lastBaseUpdate=ge,x.shared.pending=null}}while(!0);be===null&&(Q=_e),x.baseState=Q,x.firstBaseUpdate=fe,x.lastBaseUpdate=be,S===null&&(x.shared.lanes=0),go|=M,o.lanes=M,o.memoizedState=_e}}function WT(o,l){if(typeof o!="function")throw Error(r(191,o));o.call(l)}function QT(o,l){var f=o.callbacks;if(f!==null)for(o.callbacks=null,o=0;o<f.length;o++)WT(f[o],l)}var du=F(null),qg=F(0);function ZT(o,l){o=vs,ne(qg,o),ne(du,l),vs=o|l.baseLanes}function ub(){ne(qg,vs),ne(du,du.current)}function db(){vs=qg.current,Y(du),Y(qg)}var ei=F(null),wi=null;function uo(o){var l=o.alternate;ne(Sn,Sn.current&1),ne(ei,o),wi===null&&(l===null||du.current!==null||l.memoizedState!==null)&&(wi=o)}function fb(o){ne(Sn,Sn.current),ne(ei,o),wi===null&&(wi=o)}function JT(o){o.tag===22?(ne(Sn,Sn.current),ne(ei,o),wi===null&&(wi=o)):fo()}function fo(){ne(Sn,Sn.current),ne(ei,ei.current)}function ti(o){Y(ei),wi===o&&(wi=null),Y(Sn)}var Sn=F(0);function $g(o){for(var l=o;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||yx(f)||bx(f)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var cs=0,ut=null,Gt=null,On=null,Hg=!1,fu=!1,Fl=!1,Yg=0,kf=0,hu=null,O5=0;function gn(){throw Error(r(321))}function hb(o,l){if(l===null)return!1;for(var f=0;f<l.length&&f<o.length;f++)if(!Zr(o[f],l[f]))return!1;return!0}function pb(o,l,f,g,x,S){return cs=S,ut=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,$.H=o===null||o.memoizedState===null?jA:Rb,Fl=!1,S=f(g,x),Fl=!1,fu&&(S=tA(l,f,g,x)),eA(o),S}function eA(o){$.H=Mf;var l=Gt!==null&&Gt.next!==null;if(cs=0,On=Gt=ut=null,Hg=!1,kf=0,hu=null,l)throw Error(r(300));o===null||jn||(o=o.dependencies,o!==null&&Vg(o)&&(jn=!0))}function tA(o,l,f,g){ut=o;var x=0;do{if(fu&&(hu=null),kf=0,fu=!1,25<=x)throw Error(r(301));if(x+=1,On=Gt=null,o.updateQueue!=null){var S=o.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}$.H=VA,S=l(f,g)}while(fu);return S}function j5(){var o=$.H,l=o.useState()[0];return l=typeof l.then=="function"?Df(l):l,o=o.useState()[0],(Gt!==null?Gt.memoizedState:null)!==o&&(ut.flags|=1024),l}function gb(){var o=Yg!==0;return Yg=0,o}function mb(o,l,f){l.updateQueue=o.updateQueue,l.flags&=-2053,o.lanes&=~f}function vb(o){if(Hg){for(o=o.memoizedState;o!==null;){var l=o.queue;l!==null&&(l.pending=null),o=o.next}Hg=!1}cs=0,On=Gt=ut=null,fu=!1,kf=Yg=0,hu=null}function Sr(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return On===null?ut.memoizedState=On=o:On=On.next=o,On}function En(){if(Gt===null){var o=ut.alternate;o=o!==null?o.memoizedState:null}else o=Gt.next;var l=On===null?ut.memoizedState:On.next;if(l!==null)On=l,Gt=o;else{if(o===null)throw ut.alternate===null?Error(r(467)):Error(r(310));Gt=o,o={memoizedState:Gt.memoizedState,baseState:Gt.baseState,baseQueue:Gt.baseQueue,queue:Gt.queue,next:null},On===null?ut.memoizedState=On=o:On=On.next=o}return On}function Kg(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Df(o){var l=kf;return kf+=1,hu===null&&(hu=[]),o=$T(hu,o,l),l=ut,(On===null?l.memoizedState:On.next)===null&&(l=l.alternate,$.H=l===null||l.memoizedState===null?jA:Rb),o}function Xg(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return Df(o);if(o.$$typeof===k)return ir(o)}throw Error(r(438,String(o)))}function yb(o){var l=null,f=ut.updateQueue;if(f!==null&&(l=f.memoCache),l==null){var g=ut.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(l={data:g.data.map(function(x){return x.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),f===null&&(f=Kg(),ut.updateQueue=f),f.memoCache=l,f=l.data[l.index],f===void 0)for(f=l.data[l.index]=Array(o),g=0;g<o;g++)f[g]=z;return l.index++,f}function us(o,l){return typeof l=="function"?l(o):l}function Wg(o){var l=En();return bb(l,Gt,o)}function bb(o,l,f){var g=o.queue;if(g===null)throw Error(r(311));g.lastRenderedReducer=f;var x=o.baseQueue,S=g.pending;if(S!==null){if(x!==null){var M=x.next;x.next=S.next,S.next=M}l.baseQueue=x=S,g.pending=null}if(S=o.baseState,x===null)o.memoizedState=S;else{l=x.next;var G=M=null,Q=null,fe=l,be=!1;do{var _e=fe.lane&-536870913;if(_e!==fe.lane?(bt&_e)===_e:(cs&_e)===_e){var he=fe.revertLane;if(he===0)Q!==null&&(Q=Q.next={lane:0,revertLane:0,gesture:null,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null}),_e===ou&&(be=!0);else if((cs&he)===he){fe=fe.next,he===ou&&(be=!0);continue}else _e={lane:0,revertLane:fe.revertLane,gesture:null,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null},Q===null?(G=Q=_e,M=S):Q=Q.next=_e,ut.lanes|=he,go|=he;_e=fe.action,Fl&&f(S,_e),S=fe.hasEagerState?fe.eagerState:f(S,_e)}else he={lane:_e,revertLane:fe.revertLane,gesture:fe.gesture,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null},Q===null?(G=Q=he,M=S):Q=Q.next=he,ut.lanes|=_e,go|=_e;fe=fe.next}while(fe!==null&&fe!==l);if(Q===null?M=S:Q.next=G,!Zr(S,o.memoizedState)&&(jn=!0,be&&(f=lu,f!==null)))throw f;o.memoizedState=S,o.baseState=M,o.baseQueue=Q,g.lastRenderedState=S}return x===null&&(g.lanes=0),[o.memoizedState,g.dispatch]}function xb(o){var l=En(),f=l.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=o;var g=f.dispatch,x=f.pending,S=l.memoizedState;if(x!==null){f.pending=null;var M=x=x.next;do S=o(S,M.action),M=M.next;while(M!==x);Zr(S,l.memoizedState)||(jn=!0),l.memoizedState=S,l.baseQueue===null&&(l.baseState=S),f.lastRenderedState=S}return[S,g]}function nA(o,l,f){var g=ut,x=En(),S=Tt;if(S){if(f===void 0)throw Error(r(407));f=f()}else f=l();var M=!Zr((Gt||x).memoizedState,f);if(M&&(x.memoizedState=f,jn=!0),x=x.queue,Sb(aA.bind(null,g,x,o),[o]),x.getSnapshot!==l||M||On!==null&&On.memoizedState.tag&1){if(g.flags|=2048,pu(9,{destroy:void 0},iA.bind(null,g,x,f,l),null),Kt===null)throw Error(r(349));S||(cs&127)!==0||rA(g,l,f)}return f}function rA(o,l,f){o.flags|=16384,o={getSnapshot:l,value:f},l=ut.updateQueue,l===null?(l=Kg(),ut.updateQueue=l,l.stores=[o]):(f=l.stores,f===null?l.stores=[o]:f.push(o))}function iA(o,l,f,g){l.value=f,l.getSnapshot=g,sA(l)&&oA(o)}function aA(o,l,f){return f(function(){sA(l)&&oA(o)})}function sA(o){var l=o.getSnapshot;o=o.value;try{var f=l();return!Zr(o,f)}catch{return!0}}function oA(o){var l=Ml(o,2);l!==null&&Vr(l,o,2)}function _b(o){var l=Sr();if(typeof o=="function"){var f=o;if(o=f(),Fl){dr(!0);try{f()}finally{dr(!1)}}}return l.memoizedState=l.baseState=o,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:us,lastRenderedState:o},l}function lA(o,l,f,g){return o.baseState=f,bb(o,Gt,typeof g=="function"?g:us)}function V5(o,l,f,g,x){if(Jg(o))throw Error(r(485));if(o=l.action,o!==null){var S={payload:x,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(M){S.listeners.push(M)}};$.T!==null?f(!0):S.isTransition=!1,g(S),f=l.pending,f===null?(S.next=l.pending=S,cA(l,S)):(S.next=f.next,l.pending=f.next=S)}}function cA(o,l){var f=l.action,g=l.payload,x=o.state;if(l.isTransition){var S=$.T,M={};$.T=M;try{var G=f(x,g),Q=$.S;Q!==null&&Q(M,G),uA(o,l,G)}catch(fe){wb(o,l,fe)}finally{S!==null&&M.types!==null&&(S.types=M.types),$.T=S}}else try{S=f(x,g),uA(o,l,S)}catch(fe){wb(o,l,fe)}}function uA(o,l,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(g){dA(o,l,g)},function(g){return wb(o,l,g)}):dA(o,l,f)}function dA(o,l,f){l.status="fulfilled",l.value=f,fA(l),o.state=f,l=o.pending,l!==null&&(f=l.next,f===l?o.pending=null:(f=f.next,l.next=f,cA(o,f)))}function wb(o,l,f){var g=o.pending;if(o.pending=null,g!==null){g=g.next;do l.status="rejected",l.reason=f,fA(l),l=l.next;while(l!==g)}o.action=null}function fA(o){o=o.listeners;for(var l=0;l<o.length;l++)(0,o[l])()}function hA(o,l){return l}function pA(o,l){if(Tt){var f=Kt.formState;if(f!==null){e:{var g=ut;if(Tt){if(Zt){t:{for(var x=Zt,S=_i;x.nodeType!==8;){if(!S){x=null;break t}if(x=Si(x.nextSibling),x===null){x=null;break t}}S=x.data,x=S==="F!"||S==="F"?x:null}if(x){Zt=Si(x.nextSibling),g=x.data==="F!";break e}}ao(g)}g=!1}g&&(l=f[0])}}return f=Sr(),f.memoizedState=f.baseState=l,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hA,lastRenderedState:l},f.queue=g,f=MA.bind(null,ut,g),g.dispatch=f,g=_b(!1),S=Ib.bind(null,ut,!1,g.queue),g=Sr(),x={state:l,dispatch:null,action:o,pending:null},g.queue=x,f=V5.bind(null,ut,x,S,f),x.dispatch=f,g.memoizedState=o,[l,f,!1]}function gA(o){var l=En();return mA(l,Gt,o)}function mA(o,l,f){if(l=bb(o,l,hA)[0],o=Wg(us)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var g=Df(l)}catch(M){throw M===cu?Bg:M}else g=l;l=En();var x=l.queue,S=x.dispatch;return f!==l.memoizedState&&(ut.flags|=2048,pu(9,{destroy:void 0},z5.bind(null,x,f),null)),[g,S,o]}function z5(o,l){o.action=l}function vA(o){var l=En(),f=Gt;if(f!==null)return mA(l,f,o);En(),l=l.memoizedState,f=En();var g=f.queue.dispatch;return f.memoizedState=o,[l,g,!1]}function pu(o,l,f,g){return o={tag:o,create:f,deps:g,inst:l,next:null},l=ut.updateQueue,l===null&&(l=Kg(),ut.updateQueue=l),f=l.lastEffect,f===null?l.lastEffect=o.next=o:(g=f.next,f.next=o,o.next=g,l.lastEffect=o),o}function yA(){return En().memoizedState}function Qg(o,l,f,g){var x=Sr();ut.flags|=o,x.memoizedState=pu(1|l,{destroy:void 0},f,g===void 0?null:g)}function Zg(o,l,f,g){var x=En();g=g===void 0?null:g;var S=x.memoizedState.inst;Gt!==null&&g!==null&&hb(g,Gt.memoizedState.deps)?x.memoizedState=pu(l,S,f,g):(ut.flags|=o,x.memoizedState=pu(1|l,S,f,g))}function bA(o,l){Qg(8390656,8,o,l)}function Sb(o,l){Zg(2048,8,o,l)}function L5(o){ut.flags|=4;var l=ut.updateQueue;if(l===null)l=Kg(),ut.updateQueue=l,l.events=[o];else{var f=l.events;f===null?l.events=[o]:f.push(o)}}function xA(o){var l=En().memoizedState;return L5({ref:l,nextImpl:o}),function(){if((Mt&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}function _A(o,l){return Zg(4,2,o,l)}function wA(o,l){return Zg(4,4,o,l)}function SA(o,l){if(typeof l=="function"){o=o();var f=l(o);return function(){typeof f=="function"?f():l(null)}}if(l!=null)return o=o(),l.current=o,function(){l.current=null}}function EA(o,l,f){f=f!=null?f.concat([o]):null,Zg(4,4,SA.bind(null,l,o),f)}function Eb(){}function TA(o,l){var f=En();l=l===void 0?null:l;var g=f.memoizedState;return l!==null&&hb(l,g[1])?g[0]:(f.memoizedState=[o,l],o)}function AA(o,l){var f=En();l=l===void 0?null:l;var g=f.memoizedState;if(l!==null&&hb(l,g[1]))return g[0];if(g=o(),Fl){dr(!0);try{o()}finally{dr(!1)}}return f.memoizedState=[g,l],g}function Tb(o,l,f){return f===void 0||(cs&1073741824)!==0&&(bt&261930)===0?o.memoizedState=l:(o.memoizedState=f,o=CC(),ut.lanes|=o,go|=o,f)}function CA(o,l,f,g){return Zr(f,l)?f:du.current!==null?(o=Tb(o,f,g),Zr(o,l)||(jn=!0),o):(cs&42)===0||(cs&1073741824)!==0&&(bt&261930)===0?(jn=!0,o.memoizedState=f):(o=CC(),ut.lanes|=o,go|=o,l)}function IA(o,l,f,g,x){var S=W.p;W.p=S!==0&&8>S?S:8;var M=$.T,G={};$.T=G,Ib(o,!1,l,f);try{var Q=x(),fe=$.S;if(fe!==null&&fe(G,Q),Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var be=P5(Q,g);Nf(o,l,be,ii(o))}else Nf(o,l,g,ii(o))}catch(_e){Nf(o,l,{then:function(){},status:"rejected",reason:_e},ii())}finally{W.p=S,M!==null&&G.types!==null&&(M.types=G.types),$.T=M}}function B5(){}function Ab(o,l,f,g){if(o.tag!==5)throw Error(r(476));var x=RA(o).queue;IA(o,x,l,ee,f===null?B5:function(){return kA(o),f(g)})}function RA(o){var l=o.memoizedState;if(l!==null)return l;l={memoizedState:ee,baseState:ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:us,lastRenderedState:ee},next:null};var f={};return l.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:us,lastRenderedState:f},next:null},o.memoizedState=l,o=o.alternate,o!==null&&(o.memoizedState=l),l}function kA(o){var l=RA(o);l.next===null&&(l=o.alternate.memoizedState),Nf(o,l.next.queue,{},ii())}function Cb(){return ir(Xf)}function DA(){return En().memoizedState}function NA(){return En().memoizedState}function U5(o){for(var l=o.return;l!==null;){switch(l.tag){case 24:case 3:var f=ii();o=lo(f);var g=co(l,o,f);g!==null&&(Vr(g,l,f),Cf(g,l,f)),l={cache:nb()},o.payload=l;return}l=l.return}}function F5(o,l,f){var g=ii();f={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Jg(o)?PA(l,f):(f=$y(o,l,f,g),f!==null&&(Vr(f,o,g),OA(f,l,g)))}function MA(o,l,f){var g=ii();Nf(o,l,f,g)}function Nf(o,l,f,g){var x={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Jg(o))PA(l,x);else{var S=o.alternate;if(o.lanes===0&&(S===null||S.lanes===0)&&(S=l.lastRenderedReducer,S!==null))try{var M=l.lastRenderedState,G=S(M,f);if(x.hasEagerState=!0,x.eagerState=G,Zr(G,M))return Mg(o,l,x,0),Kt===null&&Ng(),!1}catch{}finally{}if(f=$y(o,l,x,g),f!==null)return Vr(f,o,g),OA(f,l,g),!0}return!1}function Ib(o,l,f,g){if(g={lane:2,revertLane:sx(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Jg(o)){if(l)throw Error(r(479))}else l=$y(o,f,g,2),l!==null&&Vr(l,o,2)}function Jg(o){var l=o.alternate;return o===ut||l!==null&&l===ut}function PA(o,l){fu=Hg=!0;var f=o.pending;f===null?l.next=l:(l.next=f.next,f.next=l),o.pending=l}function OA(o,l,f){if((f&4194048)!==0){var g=l.lanes;g&=o.pendingLanes,f|=g,l.lanes=f,Jd(o,f)}}var Mf={readContext:ir,use:Xg,useCallback:gn,useContext:gn,useEffect:gn,useImperativeHandle:gn,useLayoutEffect:gn,useInsertionEffect:gn,useMemo:gn,useReducer:gn,useRef:gn,useState:gn,useDebugValue:gn,useDeferredValue:gn,useTransition:gn,useSyncExternalStore:gn,useId:gn,useHostTransitionStatus:gn,useFormState:gn,useActionState:gn,useOptimistic:gn,useMemoCache:gn,useCacheRefresh:gn};Mf.useEffectEvent=gn;var jA={readContext:ir,use:Xg,useCallback:function(o,l){return Sr().memoizedState=[o,l===void 0?null:l],o},useContext:ir,useEffect:bA,useImperativeHandle:function(o,l,f){f=f!=null?f.concat([o]):null,Qg(4194308,4,SA.bind(null,l,o),f)},useLayoutEffect:function(o,l){return Qg(4194308,4,o,l)},useInsertionEffect:function(o,l){Qg(4,2,o,l)},useMemo:function(o,l){var f=Sr();l=l===void 0?null:l;var g=o();if(Fl){dr(!0);try{o()}finally{dr(!1)}}return f.memoizedState=[g,l],g},useReducer:function(o,l,f){var g=Sr();if(f!==void 0){var x=f(l);if(Fl){dr(!0);try{f(l)}finally{dr(!1)}}}else x=l;return g.memoizedState=g.baseState=x,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:x},g.queue=o,o=o.dispatch=F5.bind(null,ut,o),[g.memoizedState,o]},useRef:function(o){var l=Sr();return o={current:o},l.memoizedState=o},useState:function(o){o=_b(o);var l=o.queue,f=MA.bind(null,ut,l);return l.dispatch=f,[o.memoizedState,f]},useDebugValue:Eb,useDeferredValue:function(o,l){var f=Sr();return Tb(f,o,l)},useTransition:function(){var o=_b(!1);return o=IA.bind(null,ut,o.queue,!0,!1),Sr().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,l,f){var g=ut,x=Sr();if(Tt){if(f===void 0)throw Error(r(407));f=f()}else{if(f=l(),Kt===null)throw Error(r(349));(bt&127)!==0||rA(g,l,f)}x.memoizedState=f;var S={value:f,getSnapshot:l};return x.queue=S,bA(aA.bind(null,g,S,o),[o]),g.flags|=2048,pu(9,{destroy:void 0},iA.bind(null,g,S,f,l),null),f},useId:function(){var o=Sr(),l=Kt.identifierPrefix;if(Tt){var f=Ia,g=Ca;f=(g&~(1<<32-on(g)-1)).toString(32)+f,l="_"+l+"R_"+f,f=Yg++,0<f&&(l+="H"+f.toString(32)),l+="_"}else f=O5++,l="_"+l+"r_"+f.toString(32)+"_";return o.memoizedState=l},useHostTransitionStatus:Cb,useFormState:pA,useActionState:pA,useOptimistic:function(o){var l=Sr();l.memoizedState=l.baseState=o;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=f,l=Ib.bind(null,ut,!0,f),f.dispatch=l,[o,l]},useMemoCache:yb,useCacheRefresh:function(){return Sr().memoizedState=U5.bind(null,ut)},useEffectEvent:function(o){var l=Sr(),f={impl:o};return l.memoizedState=f,function(){if((Mt&2)!==0)throw Error(r(440));return f.impl.apply(void 0,arguments)}}},Rb={readContext:ir,use:Xg,useCallback:TA,useContext:ir,useEffect:Sb,useImperativeHandle:EA,useInsertionEffect:_A,useLayoutEffect:wA,useMemo:AA,useReducer:Wg,useRef:yA,useState:function(){return Wg(us)},useDebugValue:Eb,useDeferredValue:function(o,l){var f=En();return CA(f,Gt.memoizedState,o,l)},useTransition:function(){var o=Wg(us)[0],l=En().memoizedState;return[typeof o=="boolean"?o:Df(o),l]},useSyncExternalStore:nA,useId:DA,useHostTransitionStatus:Cb,useFormState:gA,useActionState:gA,useOptimistic:function(o,l){var f=En();return lA(f,Gt,o,l)},useMemoCache:yb,useCacheRefresh:NA};Rb.useEffectEvent=xA;var VA={readContext:ir,use:Xg,useCallback:TA,useContext:ir,useEffect:Sb,useImperativeHandle:EA,useInsertionEffect:_A,useLayoutEffect:wA,useMemo:AA,useReducer:xb,useRef:yA,useState:function(){return xb(us)},useDebugValue:Eb,useDeferredValue:function(o,l){var f=En();return Gt===null?Tb(f,o,l):CA(f,Gt.memoizedState,o,l)},useTransition:function(){var o=xb(us)[0],l=En().memoizedState;return[typeof o=="boolean"?o:Df(o),l]},useSyncExternalStore:nA,useId:DA,useHostTransitionStatus:Cb,useFormState:vA,useActionState:vA,useOptimistic:function(o,l){var f=En();return Gt!==null?lA(f,Gt,o,l):(f.baseState=o,[o,f.queue.dispatch])},useMemoCache:yb,useCacheRefresh:NA};VA.useEffectEvent=xA;function kb(o,l,f,g){l=o.memoizedState,f=f(g,l),f=f==null?l:p({},l,f),o.memoizedState=f,o.lanes===0&&(o.updateQueue.baseState=f)}var Db={enqueueSetState:function(o,l,f){o=o._reactInternals;var g=ii(),x=lo(g);x.payload=l,f!=null&&(x.callback=f),l=co(o,x,g),l!==null&&(Vr(l,o,g),Cf(l,o,g))},enqueueReplaceState:function(o,l,f){o=o._reactInternals;var g=ii(),x=lo(g);x.tag=1,x.payload=l,f!=null&&(x.callback=f),l=co(o,x,g),l!==null&&(Vr(l,o,g),Cf(l,o,g))},enqueueForceUpdate:function(o,l){o=o._reactInternals;var f=ii(),g=lo(f);g.tag=2,l!=null&&(g.callback=l),l=co(o,g,f),l!==null&&(Vr(l,o,f),Cf(l,o,f))}};function zA(o,l,f,g,x,S,M){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(g,S,M):l.prototype&&l.prototype.isPureReactComponent?!bf(f,g)||!bf(x,S):!0}function LA(o,l,f,g){o=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,g),l.state!==o&&Db.enqueueReplaceState(l,l.state,null)}function Gl(o,l){var f=l;if("ref"in l){f={};for(var g in l)g!=="ref"&&(f[g]=l[g])}if(o=o.defaultProps){f===l&&(f=p({},f));for(var x in o)f[x]===void 0&&(f[x]=o[x])}return f}function BA(o){Dg(o)}function UA(o){console.error(o)}function FA(o){Dg(o)}function em(o,l){try{var f=o.onUncaughtError;f(l.value,{componentStack:l.stack})}catch(g){setTimeout(function(){throw g})}}function GA(o,l,f){try{var g=o.onCaughtError;g(f.value,{componentStack:f.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Nb(o,l,f){return f=lo(f),f.tag=3,f.payload={element:null},f.callback=function(){em(o,l)},f}function qA(o){return o=lo(o),o.tag=3,o}function $A(o,l,f,g){var x=f.type.getDerivedStateFromError;if(typeof x=="function"){var S=g.value;o.payload=function(){return x(S)},o.callback=function(){GA(l,f,g)}}var M=f.stateNode;M!==null&&typeof M.componentDidCatch=="function"&&(o.callback=function(){GA(l,f,g),typeof x!="function"&&(mo===null?mo=new Set([this]):mo.add(this));var G=g.stack;this.componentDidCatch(g.value,{componentStack:G!==null?G:""})})}function G5(o,l,f,g,x){if(f.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(l=f.alternate,l!==null&&su(l,f,x,!0),f=ei.current,f!==null){switch(f.tag){case 31:case 13:return wi===null?fm():f.alternate===null&&mn===0&&(mn=3),f.flags&=-257,f.flags|=65536,f.lanes=x,g===Ug?f.flags|=16384:(l=f.updateQueue,l===null?f.updateQueue=new Set([g]):l.add(g),rx(o,g,x)),!1;case 22:return f.flags|=65536,g===Ug?f.flags|=16384:(l=f.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([g])},f.updateQueue=l):(f=l.retryQueue,f===null?l.retryQueue=new Set([g]):f.add(g)),rx(o,g,x)),!1}throw Error(r(435,f.tag))}return rx(o,g,x),fm(),!1}if(Tt)return l=ei.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=x,g!==Qy&&(o=Error(r(422),{cause:g}),wf(yi(o,f)))):(g!==Qy&&(l=Error(r(423),{cause:g}),wf(yi(l,f))),o=o.current.alternate,o.flags|=65536,x&=-x,o.lanes|=x,g=yi(g,f),x=Nb(o.stateNode,g,x),lb(o,x),mn!==4&&(mn=2)),!1;var S=Error(r(520),{cause:g});if(S=yi(S,f),Uf===null?Uf=[S]:Uf.push(S),mn!==4&&(mn=2),l===null)return!0;g=yi(g,f),f=l;do{switch(f.tag){case 3:return f.flags|=65536,o=x&-x,f.lanes|=o,o=Nb(f.stateNode,g,o),lb(f,o),!1;case 1:if(l=f.type,S=f.stateNode,(f.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(mo===null||!mo.has(S))))return f.flags|=65536,x&=-x,f.lanes|=x,x=qA(x),$A(x,o,f,g),lb(f,x),!1}f=f.return}while(f!==null);return!1}var Mb=Error(r(461)),jn=!1;function ar(o,l,f,g){l.child=o===null?XT(l,null,f,g):Ul(l,o.child,f,g)}function HA(o,l,f,g,x){f=f.render;var S=l.ref;if("ref"in g){var M={};for(var G in g)G!=="ref"&&(M[G]=g[G])}else M=g;return Vl(l),g=pb(o,l,f,M,S,x),G=gb(),o!==null&&!jn?(mb(o,l,x),ds(o,l,x)):(Tt&&G&&Xy(l),l.flags|=1,ar(o,l,g,x),l.child)}function YA(o,l,f,g,x){if(o===null){var S=f.type;return typeof S=="function"&&!Hy(S)&&S.defaultProps===void 0&&f.compare===null?(l.tag=15,l.type=S,KA(o,l,S,g,x)):(o=Og(f.type,null,g,l,l.mode,x),o.ref=l.ref,o.return=l,l.child=o)}if(S=o.child,!Ub(o,x)){var M=S.memoizedProps;if(f=f.compare,f=f!==null?f:bf,f(M,g)&&o.ref===l.ref)return ds(o,l,x)}return l.flags|=1,o=as(S,g),o.ref=l.ref,o.return=l,l.child=o}function KA(o,l,f,g,x){if(o!==null){var S=o.memoizedProps;if(bf(S,g)&&o.ref===l.ref)if(jn=!1,l.pendingProps=g=S,Ub(o,x))(o.flags&131072)!==0&&(jn=!0);else return l.lanes=o.lanes,ds(o,l,x)}return Pb(o,l,f,g,x)}function XA(o,l,f,g){var x=g.children,S=o!==null?o.memoizedState:null;if(o===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((l.flags&128)!==0){if(S=S!==null?S.baseLanes|f:f,o!==null){for(g=l.child=o.child,x=0;g!==null;)x=x|g.lanes|g.childLanes,g=g.sibling;g=x&~S}else g=0,l.child=null;return WA(o,l,S,f,g)}if((f&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},o!==null&&Lg(l,S!==null?S.cachePool:null),S!==null?ZT(l,S):ub(),JT(l);else return g=l.lanes=536870912,WA(o,l,S!==null?S.baseLanes|f:f,f,g)}else S!==null?(Lg(l,S.cachePool),ZT(l,S),fo(),l.memoizedState=null):(o!==null&&Lg(l,null),ub(),fo());return ar(o,l,x,f),l.child}function Pf(o,l){return o!==null&&o.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function WA(o,l,f,g,x){var S=ib();return S=S===null?null:{parent:Pn._currentValue,pool:S},l.memoizedState={baseLanes:f,cachePool:S},o!==null&&Lg(l,null),ub(),JT(l),o!==null&&su(o,l,g,!0),l.childLanes=x,null}function tm(o,l){return l=rm({mode:l.mode,children:l.children},o.mode),l.ref=o.ref,o.child=l,l.return=o,l}function QA(o,l,f){return Ul(l,o.child,null,f),o=tm(l,l.pendingProps),o.flags|=2,ti(l),l.memoizedState=null,o}function q5(o,l,f){var g=l.pendingProps,x=(l.flags&128)!==0;if(l.flags&=-129,o===null){if(Tt){if(g.mode==="hidden")return o=tm(l,g),l.lanes=536870912,Pf(null,o);if(fb(l),(o=Zt)?(o=cI(o,_i),o=o!==null&&o.data==="&"?o:null,o!==null&&(l.memoizedState={dehydrated:o,treeContext:ro!==null?{id:Ca,overflow:Ia}:null,retryLane:536870912,hydrationErrors:null},f=PT(o),f.return=l,l.child=f,rr=l,Zt=null)):o=null,o===null)throw ao(l);return l.lanes=536870912,null}return tm(l,g)}var S=o.memoizedState;if(S!==null){var M=S.dehydrated;if(fb(l),x)if(l.flags&256)l.flags&=-257,l=QA(o,l,f);else if(l.memoizedState!==null)l.child=o.child,l.flags|=128,l=null;else throw Error(r(558));else if(jn||su(o,l,f,!1),x=(f&o.childLanes)!==0,jn||x){if(g=Kt,g!==null&&(M=ef(g,f),M!==0&&M!==S.retryLane))throw S.retryLane=M,Ml(o,M),Vr(g,o,M),Mb;fm(),l=QA(o,l,f)}else o=S.treeContext,Zt=Si(M.nextSibling),rr=l,Tt=!0,io=null,_i=!1,o!==null&&VT(l,o),l=tm(l,g),l.flags|=4096;return l}return o=as(o.child,{mode:g.mode,children:g.children}),o.ref=l.ref,l.child=o,o.return=l,o}function nm(o,l){var f=l.ref;if(f===null)o!==null&&o.ref!==null&&(l.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(r(284));(o===null||o.ref!==f)&&(l.flags|=4194816)}}function Pb(o,l,f,g,x){return Vl(l),f=pb(o,l,f,g,void 0,x),g=gb(),o!==null&&!jn?(mb(o,l,x),ds(o,l,x)):(Tt&&g&&Xy(l),l.flags|=1,ar(o,l,f,x),l.child)}function ZA(o,l,f,g,x,S){return Vl(l),l.updateQueue=null,f=tA(l,g,f,x),eA(o),g=gb(),o!==null&&!jn?(mb(o,l,S),ds(o,l,S)):(Tt&&g&&Xy(l),l.flags|=1,ar(o,l,f,S),l.child)}function JA(o,l,f,g,x){if(Vl(l),l.stateNode===null){var S=nu,M=f.contextType;typeof M=="object"&&M!==null&&(S=ir(M)),S=new f(g,S),l.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=Db,l.stateNode=S,S._reactInternals=l,S=l.stateNode,S.props=g,S.state=l.memoizedState,S.refs={},sb(l),M=f.contextType,S.context=typeof M=="object"&&M!==null?ir(M):nu,S.state=l.memoizedState,M=f.getDerivedStateFromProps,typeof M=="function"&&(kb(l,f,M,g),S.state=l.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(M=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),M!==S.state&&Db.enqueueReplaceState(S,S.state,null),Rf(l,g,S,x),If(),S.state=l.memoizedState),typeof S.componentDidMount=="function"&&(l.flags|=4194308),g=!0}else if(o===null){S=l.stateNode;var G=l.memoizedProps,Q=Gl(f,G);S.props=Q;var fe=S.context,be=f.contextType;M=nu,typeof be=="object"&&be!==null&&(M=ir(be));var _e=f.getDerivedStateFromProps;be=typeof _e=="function"||typeof S.getSnapshotBeforeUpdate=="function",G=l.pendingProps!==G,be||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(G||fe!==M)&&LA(l,S,g,M),oo=!1;var he=l.memoizedState;S.state=he,Rf(l,g,S,x),If(),fe=l.memoizedState,G||he!==fe||oo?(typeof _e=="function"&&(kb(l,f,_e,g),fe=l.memoizedState),(Q=oo||zA(l,f,Q,g,he,fe,M))?(be||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(l.flags|=4194308)):(typeof S.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=fe),S.props=g,S.state=fe,S.context=M,g=Q):(typeof S.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{S=l.stateNode,ob(o,l),M=l.memoizedProps,be=Gl(f,M),S.props=be,_e=l.pendingProps,he=S.context,fe=f.contextType,Q=nu,typeof fe=="object"&&fe!==null&&(Q=ir(fe)),G=f.getDerivedStateFromProps,(fe=typeof G=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(M!==_e||he!==Q)&&LA(l,S,g,Q),oo=!1,he=l.memoizedState,S.state=he,Rf(l,g,S,x),If();var ge=l.memoizedState;M!==_e||he!==ge||oo||o!==null&&o.dependencies!==null&&Vg(o.dependencies)?(typeof G=="function"&&(kb(l,f,G,g),ge=l.memoizedState),(be=oo||zA(l,f,be,g,he,ge,Q)||o!==null&&o.dependencies!==null&&Vg(o.dependencies))?(fe||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(g,ge,Q),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(g,ge,Q)),typeof S.componentDidUpdate=="function"&&(l.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof S.componentDidUpdate!="function"||M===o.memoizedProps&&he===o.memoizedState||(l.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||M===o.memoizedProps&&he===o.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=ge),S.props=g,S.state=ge,S.context=Q,g=be):(typeof S.componentDidUpdate!="function"||M===o.memoizedProps&&he===o.memoizedState||(l.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||M===o.memoizedProps&&he===o.memoizedState||(l.flags|=1024),g=!1)}return S=g,nm(o,l),g=(l.flags&128)!==0,S||g?(S=l.stateNode,f=g&&typeof f.getDerivedStateFromError!="function"?null:S.render(),l.flags|=1,o!==null&&g?(l.child=Ul(l,o.child,null,x),l.child=Ul(l,null,f,x)):ar(o,l,f,x),l.memoizedState=S.state,o=l.child):o=ds(o,l,x),o}function eC(o,l,f,g){return Ol(),l.flags|=256,ar(o,l,f,g),l.child}var Ob={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function jb(o){return{baseLanes:o,cachePool:GT()}}function Vb(o,l,f){return o=o!==null?o.childLanes&~f:0,l&&(o|=ri),o}function tC(o,l,f){var g=l.pendingProps,x=!1,S=(l.flags&128)!==0,M;if((M=S)||(M=o!==null&&o.memoizedState===null?!1:(Sn.current&2)!==0),M&&(x=!0,l.flags&=-129),M=(l.flags&32)!==0,l.flags&=-33,o===null){if(Tt){if(x?uo(l):fo(),(o=Zt)?(o=cI(o,_i),o=o!==null&&o.data!=="&"?o:null,o!==null&&(l.memoizedState={dehydrated:o,treeContext:ro!==null?{id:Ca,overflow:Ia}:null,retryLane:536870912,hydrationErrors:null},f=PT(o),f.return=l,l.child=f,rr=l,Zt=null)):o=null,o===null)throw ao(l);return bx(o)?l.lanes=32:l.lanes=536870912,null}var G=g.children;return g=g.fallback,x?(fo(),x=l.mode,G=rm({mode:"hidden",children:G},x),g=Pl(g,x,f,null),G.return=l,g.return=l,G.sibling=g,l.child=G,g=l.child,g.memoizedState=jb(f),g.childLanes=Vb(o,M,f),l.memoizedState=Ob,Pf(null,g)):(uo(l),zb(l,G))}var Q=o.memoizedState;if(Q!==null&&(G=Q.dehydrated,G!==null)){if(S)l.flags&256?(uo(l),l.flags&=-257,l=Lb(o,l,f)):l.memoizedState!==null?(fo(),l.child=o.child,l.flags|=128,l=null):(fo(),G=g.fallback,x=l.mode,g=rm({mode:"visible",children:g.children},x),G=Pl(G,x,f,null),G.flags|=2,g.return=l,G.return=l,g.sibling=G,l.child=g,Ul(l,o.child,null,f),g=l.child,g.memoizedState=jb(f),g.childLanes=Vb(o,M,f),l.memoizedState=Ob,l=Pf(null,g));else if(uo(l),bx(G)){if(M=G.nextSibling&&G.nextSibling.dataset,M)var fe=M.dgst;M=fe,g=Error(r(419)),g.stack="",g.digest=M,wf({value:g,source:null,stack:null}),l=Lb(o,l,f)}else if(jn||su(o,l,f,!1),M=(f&o.childLanes)!==0,jn||M){if(M=Kt,M!==null&&(g=ef(M,f),g!==0&&g!==Q.retryLane))throw Q.retryLane=g,Ml(o,g),Vr(M,o,g),Mb;yx(G)||fm(),l=Lb(o,l,f)}else yx(G)?(l.flags|=192,l.child=o.child,l=null):(o=Q.treeContext,Zt=Si(G.nextSibling),rr=l,Tt=!0,io=null,_i=!1,o!==null&&VT(l,o),l=zb(l,g.children),l.flags|=4096);return l}return x?(fo(),G=g.fallback,x=l.mode,Q=o.child,fe=Q.sibling,g=as(Q,{mode:"hidden",children:g.children}),g.subtreeFlags=Q.subtreeFlags&65011712,fe!==null?G=as(fe,G):(G=Pl(G,x,f,null),G.flags|=2),G.return=l,g.return=l,g.sibling=G,l.child=g,Pf(null,g),g=l.child,G=o.child.memoizedState,G===null?G=jb(f):(x=G.cachePool,x!==null?(Q=Pn._currentValue,x=x.parent!==Q?{parent:Q,pool:Q}:x):x=GT(),G={baseLanes:G.baseLanes|f,cachePool:x}),g.memoizedState=G,g.childLanes=Vb(o,M,f),l.memoizedState=Ob,Pf(o.child,g)):(uo(l),f=o.child,o=f.sibling,f=as(f,{mode:"visible",children:g.children}),f.return=l,f.sibling=null,o!==null&&(M=l.deletions,M===null?(l.deletions=[o],l.flags|=16):M.push(o)),l.child=f,l.memoizedState=null,f)}function zb(o,l){return l=rm({mode:"visible",children:l},o.mode),l.return=o,o.child=l}function rm(o,l){return o=Jr(22,o,null,l),o.lanes=0,o}function Lb(o,l,f){return Ul(l,o.child,null,f),o=zb(l,l.pendingProps.children),o.flags|=2,l.memoizedState=null,o}function nC(o,l,f){o.lanes|=l;var g=o.alternate;g!==null&&(g.lanes|=l),eb(o.return,l,f)}function Bb(o,l,f,g,x,S){var M=o.memoizedState;M===null?o.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:x,treeForkCount:S}:(M.isBackwards=l,M.rendering=null,M.renderingStartTime=0,M.last=g,M.tail=f,M.tailMode=x,M.treeForkCount=S)}function rC(o,l,f){var g=l.pendingProps,x=g.revealOrder,S=g.tail;g=g.children;var M=Sn.current,G=(M&2)!==0;if(G?(M=M&1|2,l.flags|=128):M&=1,ne(Sn,M),ar(o,l,g,f),g=Tt?_f:0,!G&&o!==null&&(o.flags&128)!==0)e:for(o=l.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&nC(o,f,l);else if(o.tag===19)nC(o,f,l);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===l)break e;for(;o.sibling===null;){if(o.return===null||o.return===l)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}switch(x){case"forwards":for(f=l.child,x=null;f!==null;)o=f.alternate,o!==null&&$g(o)===null&&(x=f),f=f.sibling;f=x,f===null?(x=l.child,l.child=null):(x=f.sibling,f.sibling=null),Bb(l,!1,x,f,S,g);break;case"backwards":case"unstable_legacy-backwards":for(f=null,x=l.child,l.child=null;x!==null;){if(o=x.alternate,o!==null&&$g(o)===null){l.child=x;break}o=x.sibling,x.sibling=f,f=x,x=o}Bb(l,!0,f,null,S,g);break;case"together":Bb(l,!1,null,null,void 0,g);break;default:l.memoizedState=null}return l.child}function ds(o,l,f){if(o!==null&&(l.dependencies=o.dependencies),go|=l.lanes,(f&l.childLanes)===0)if(o!==null){if(su(o,l,f,!1),(f&l.childLanes)===0)return null}else return null;if(o!==null&&l.child!==o.child)throw Error(r(153));if(l.child!==null){for(o=l.child,f=as(o,o.pendingProps),l.child=f,f.return=l;o.sibling!==null;)o=o.sibling,f=f.sibling=as(o,o.pendingProps),f.return=l;f.sibling=null}return l.child}function Ub(o,l){return(o.lanes&l)!==0?!0:(o=o.dependencies,!!(o!==null&&Vg(o)))}function $5(o,l,f){switch(l.tag){case 3:me(l,l.stateNode.containerInfo),so(l,Pn,o.memoizedState.cache),Ol();break;case 27:case 5:Me(l);break;case 4:me(l,l.stateNode.containerInfo);break;case 10:so(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,fb(l),null;break;case 13:var g=l.memoizedState;if(g!==null)return g.dehydrated!==null?(uo(l),l.flags|=128,null):(f&l.child.childLanes)!==0?tC(o,l,f):(uo(l),o=ds(o,l,f),o!==null?o.sibling:null);uo(l);break;case 19:var x=(o.flags&128)!==0;if(g=(f&l.childLanes)!==0,g||(su(o,l,f,!1),g=(f&l.childLanes)!==0),x){if(g)return rC(o,l,f);l.flags|=128}if(x=l.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),ne(Sn,Sn.current),g)break;return null;case 22:return l.lanes=0,XA(o,l,f,l.pendingProps);case 24:so(l,Pn,o.memoizedState.cache)}return ds(o,l,f)}function iC(o,l,f){if(o!==null)if(o.memoizedProps!==l.pendingProps)jn=!0;else{if(!Ub(o,f)&&(l.flags&128)===0)return jn=!1,$5(o,l,f);jn=(o.flags&131072)!==0}else jn=!1,Tt&&(l.flags&1048576)!==0&&jT(l,_f,l.index);switch(l.lanes=0,l.tag){case 16:e:{var g=l.pendingProps;if(o=Ll(l.elementType),l.type=o,typeof o=="function")Hy(o)?(g=Gl(o,g),l.tag=1,l=JA(null,l,o,g,f)):(l.tag=0,l=Pb(null,l,o,g,f));else{if(o!=null){var x=o.$$typeof;if(x===j){l.tag=11,l=HA(null,l,o,g,f);break e}else if(x===A){l.tag=14,l=YA(null,l,o,g,f);break e}}throw l=X(o)||o,Error(r(306,l,""))}}return l;case 0:return Pb(o,l,l.type,l.pendingProps,f);case 1:return g=l.type,x=Gl(g,l.pendingProps),JA(o,l,g,x,f);case 3:e:{if(me(l,l.stateNode.containerInfo),o===null)throw Error(r(387));g=l.pendingProps;var S=l.memoizedState;x=S.element,ob(o,l),Rf(l,g,null,f);var M=l.memoizedState;if(g=M.cache,so(l,Pn,g),g!==S.cache&&tb(l,[Pn],f,!0),If(),g=M.element,S.isDehydrated)if(S={element:g,isDehydrated:!1,cache:M.cache},l.updateQueue.baseState=S,l.memoizedState=S,l.flags&256){l=eC(o,l,g,f);break e}else if(g!==x){x=yi(Error(r(424)),l),wf(x),l=eC(o,l,g,f);break e}else{switch(o=l.stateNode.containerInfo,o.nodeType){case 9:o=o.body;break;default:o=o.nodeName==="HTML"?o.ownerDocument.body:o}for(Zt=Si(o.firstChild),rr=l,Tt=!0,io=null,_i=!0,f=XT(l,null,g,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(Ol(),g===x){l=ds(o,l,f);break e}ar(o,l,g,f)}l=l.child}return l;case 26:return nm(o,l),o===null?(f=gI(l.type,null,l.pendingProps,null))?l.memoizedState=f:Tt||(f=l.type,o=l.pendingProps,g=bm(ue.current).createElement(f),g[Dn]=l,g[Zn]=o,sr(g,f,o),Nn(g),l.stateNode=g):l.memoizedState=gI(l.type,o.memoizedProps,l.pendingProps,o.memoizedState),null;case 27:return Me(l),o===null&&Tt&&(g=l.stateNode=fI(l.type,l.pendingProps,ue.current),rr=l,_i=!0,x=Zt,xo(l.type)?(xx=x,Zt=Si(g.firstChild)):Zt=x),ar(o,l,l.pendingProps.children,f),nm(o,l),o===null&&(l.flags|=4194304),l.child;case 5:return o===null&&Tt&&((x=g=Zt)&&(g=_z(g,l.type,l.pendingProps,_i),g!==null?(l.stateNode=g,rr=l,Zt=Si(g.firstChild),_i=!1,x=!0):x=!1),x||ao(l)),Me(l),x=l.type,S=l.pendingProps,M=o!==null?o.memoizedProps:null,g=S.children,gx(x,S)?g=null:M!==null&&gx(x,M)&&(l.flags|=32),l.memoizedState!==null&&(x=pb(o,l,j5,null,null,f),Xf._currentValue=x),nm(o,l),ar(o,l,g,f),l.child;case 6:return o===null&&Tt&&((o=f=Zt)&&(f=wz(f,l.pendingProps,_i),f!==null?(l.stateNode=f,rr=l,Zt=null,o=!0):o=!1),o||ao(l)),null;case 13:return tC(o,l,f);case 4:return me(l,l.stateNode.containerInfo),g=l.pendingProps,o===null?l.child=Ul(l,null,g,f):ar(o,l,g,f),l.child;case 11:return HA(o,l,l.type,l.pendingProps,f);case 7:return ar(o,l,l.pendingProps,f),l.child;case 8:return ar(o,l,l.pendingProps.children,f),l.child;case 12:return ar(o,l,l.pendingProps.children,f),l.child;case 10:return g=l.pendingProps,so(l,l.type,g.value),ar(o,l,g.children,f),l.child;case 9:return x=l.type._context,g=l.pendingProps.children,Vl(l),x=ir(x),g=g(x),l.flags|=1,ar(o,l,g,f),l.child;case 14:return YA(o,l,l.type,l.pendingProps,f);case 15:return KA(o,l,l.type,l.pendingProps,f);case 19:return rC(o,l,f);case 31:return q5(o,l,f);case 22:return XA(o,l,f,l.pendingProps);case 24:return Vl(l),g=ir(Pn),o===null?(x=ib(),x===null&&(x=Kt,S=nb(),x.pooledCache=S,S.refCount++,S!==null&&(x.pooledCacheLanes|=f),x=S),l.memoizedState={parent:g,cache:x},sb(l),so(l,Pn,x)):((o.lanes&f)!==0&&(ob(o,l),Rf(l,null,null,f),If()),x=o.memoizedState,S=l.memoizedState,x.parent!==g?(x={parent:g,cache:g},l.memoizedState=x,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=x),so(l,Pn,g)):(g=S.cache,so(l,Pn,g),g!==x.cache&&tb(l,[Pn],f,!0))),ar(o,l,l.pendingProps.children,f),l.child;case 29:throw l.pendingProps}throw Error(r(156,l.tag))}function fs(o){o.flags|=4}function Fb(o,l,f,g,x){if((l=(o.mode&32)!==0)&&(l=!1),l){if(o.flags|=16777216,(x&335544128)===x)if(o.stateNode.complete)o.flags|=8192;else if(DC())o.flags|=8192;else throw Bl=Ug,ab}else o.flags&=-16777217}function aC(o,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!xI(l))if(DC())o.flags|=8192;else throw Bl=Ug,ab}function im(o,l){l!==null&&(o.flags|=4),o.flags&16384&&(l=o.tag!==22?ug():536870912,o.lanes|=l,yu|=l)}function Of(o,l){if(!Tt)switch(o.tailMode){case"hidden":l=o.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?o.tail=null:f.sibling=null;break;case"collapsed":f=o.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?l||o.tail===null?o.tail=null:o.tail.sibling=null:g.sibling=null}}function Jt(o){var l=o.alternate!==null&&o.alternate.child===o.child,f=0,g=0;if(l)for(var x=o.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags&65011712,g|=x.flags&65011712,x.return=o,x=x.sibling;else for(x=o.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags,g|=x.flags,x.return=o,x=x.sibling;return o.subtreeFlags|=g,o.childLanes=f,l}function H5(o,l,f){var g=l.pendingProps;switch(Wy(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(l),null;case 1:return Jt(l),null;case 3:return f=l.stateNode,g=null,o!==null&&(g=o.memoizedState.cache),l.memoizedState.cache!==g&&(l.flags|=2048),ls(Pn),Te(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(o===null||o.child===null)&&(au(l)?fs(l):o===null||o.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Zy())),Jt(l),null;case 26:var x=l.type,S=l.memoizedState;return o===null?(fs(l),S!==null?(Jt(l),aC(l,S)):(Jt(l),Fb(l,x,null,g,f))):S?S!==o.memoizedState?(fs(l),Jt(l),aC(l,S)):(Jt(l),l.flags&=-16777217):(o=o.memoizedProps,o!==g&&fs(l),Jt(l),Fb(l,x,o,g,f)),null;case 27:if(ae(l),f=ue.current,x=l.type,o!==null&&l.stateNode!=null)o.memoizedProps!==g&&fs(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return Jt(l),null}o=Z.current,au(l)?zT(l):(o=fI(x,g,f),l.stateNode=o,fs(l))}return Jt(l),null;case 5:if(ae(l),x=l.type,o!==null&&l.stateNode!=null)o.memoizedProps!==g&&fs(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return Jt(l),null}if(S=Z.current,au(l))zT(l);else{var M=bm(ue.current);switch(S){case 1:S=M.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:S=M.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":S=M.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":S=M.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":S=M.createElement("div"),S.innerHTML="<script><\/script>",S=S.removeChild(S.firstChild);break;case"select":S=typeof g.is=="string"?M.createElement("select",{is:g.is}):M.createElement("select"),g.multiple?S.multiple=!0:g.size&&(S.size=g.size);break;default:S=typeof g.is=="string"?M.createElement(x,{is:g.is}):M.createElement(x)}}S[Dn]=l,S[Zn]=g;e:for(M=l.child;M!==null;){if(M.tag===5||M.tag===6)S.appendChild(M.stateNode);else if(M.tag!==4&&M.tag!==27&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===l)break e;for(;M.sibling===null;){if(M.return===null||M.return===l)break e;M=M.return}M.sibling.return=M.return,M=M.sibling}l.stateNode=S;e:switch(sr(S,x,g),x){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&fs(l)}}return Jt(l),Fb(l,l.type,o===null?null:o.memoizedProps,l.pendingProps,f),null;case 6:if(o&&l.stateNode!=null)o.memoizedProps!==g&&fs(l);else{if(typeof g!="string"&&l.stateNode===null)throw Error(r(166));if(o=ue.current,au(l)){if(o=l.stateNode,f=l.memoizedProps,g=null,x=rr,x!==null)switch(x.tag){case 27:case 5:g=x.memoizedProps}o[Dn]=l,o=!!(o.nodeValue===f||g!==null&&g.suppressHydrationWarning===!0||tI(o.nodeValue,f)),o||ao(l,!0)}else o=bm(o).createTextNode(g),o[Dn]=l,l.stateNode=o}return Jt(l),null;case 31:if(f=l.memoizedState,o===null||o.memoizedState!==null){if(g=au(l),f!==null){if(o===null){if(!g)throw Error(r(318));if(o=l.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(r(557));o[Dn]=l}else Ol(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Jt(l),o=!1}else f=Zy(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=f),o=!0;if(!o)return l.flags&256?(ti(l),l):(ti(l),null);if((l.flags&128)!==0)throw Error(r(558))}return Jt(l),null;case 13:if(g=l.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(x=au(l),g!==null&&g.dehydrated!==null){if(o===null){if(!x)throw Error(r(318));if(x=l.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[Dn]=l}else Ol(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Jt(l),x=!1}else x=Zy(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=x),x=!0;if(!x)return l.flags&256?(ti(l),l):(ti(l),null)}return ti(l),(l.flags&128)!==0?(l.lanes=f,l):(f=g!==null,o=o!==null&&o.memoizedState!==null,f&&(g=l.child,x=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(x=g.alternate.memoizedState.cachePool.pool),S=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(S=g.memoizedState.cachePool.pool),S!==x&&(g.flags|=2048)),f!==o&&f&&(l.child.flags|=8192),im(l,l.updateQueue),Jt(l),null);case 4:return Te(),o===null&&ux(l.stateNode.containerInfo),Jt(l),null;case 10:return ls(l.type),Jt(l),null;case 19:if(Y(Sn),g=l.memoizedState,g===null)return Jt(l),null;if(x=(l.flags&128)!==0,S=g.rendering,S===null)if(x)Of(g,!1);else{if(mn!==0||o!==null&&(o.flags&128)!==0)for(o=l.child;o!==null;){if(S=$g(o),S!==null){for(l.flags|=128,Of(g,!1),o=S.updateQueue,l.updateQueue=o,im(l,o),l.subtreeFlags=0,o=f,f=l.child;f!==null;)MT(f,o),f=f.sibling;return ne(Sn,Sn.current&1|2),Tt&&ss(l,g.treeForkCount),l.child}o=o.sibling}g.tail!==null&&ft()>cm&&(l.flags|=128,x=!0,Of(g,!1),l.lanes=4194304)}else{if(!x)if(o=$g(S),o!==null){if(l.flags|=128,x=!0,o=o.updateQueue,l.updateQueue=o,im(l,o),Of(g,!0),g.tail===null&&g.tailMode==="hidden"&&!S.alternate&&!Tt)return Jt(l),null}else 2*ft()-g.renderingStartTime>cm&&f!==536870912&&(l.flags|=128,x=!0,Of(g,!1),l.lanes=4194304);g.isBackwards?(S.sibling=l.child,l.child=S):(o=g.last,o!==null?o.sibling=S:l.child=S,g.last=S)}return g.tail!==null?(o=g.tail,g.rendering=o,g.tail=o.sibling,g.renderingStartTime=ft(),o.sibling=null,f=Sn.current,ne(Sn,x?f&1|2:f&1),Tt&&ss(l,g.treeForkCount),o):(Jt(l),null);case 22:case 23:return ti(l),db(),g=l.memoizedState!==null,o!==null?o.memoizedState!==null!==g&&(l.flags|=8192):g&&(l.flags|=8192),g?(f&536870912)!==0&&(l.flags&128)===0&&(Jt(l),l.subtreeFlags&6&&(l.flags|=8192)):Jt(l),f=l.updateQueue,f!==null&&im(l,f.retryQueue),f=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),g=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),g!==f&&(l.flags|=2048),o!==null&&Y(zl),null;case 24:return f=null,o!==null&&(f=o.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),ls(Pn),Jt(l),null;case 25:return null;case 30:return null}throw Error(r(156,l.tag))}function Y5(o,l){switch(Wy(l),l.tag){case 1:return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 3:return ls(Pn),Te(),o=l.flags,(o&65536)!==0&&(o&128)===0?(l.flags=o&-65537|128,l):null;case 26:case 27:case 5:return ae(l),null;case 31:if(l.memoizedState!==null){if(ti(l),l.alternate===null)throw Error(r(340));Ol()}return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 13:if(ti(l),o=l.memoizedState,o!==null&&o.dehydrated!==null){if(l.alternate===null)throw Error(r(340));Ol()}return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 19:return Y(Sn),null;case 4:return Te(),null;case 10:return ls(l.type),null;case 22:case 23:return ti(l),db(),o!==null&&Y(zl),o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 24:return ls(Pn),null;case 25:return null;default:return null}}function sC(o,l){switch(Wy(l),l.tag){case 3:ls(Pn),Te();break;case 26:case 27:case 5:ae(l);break;case 4:Te();break;case 31:l.memoizedState!==null&&ti(l);break;case 13:ti(l);break;case 19:Y(Sn);break;case 10:ls(l.type);break;case 22:case 23:ti(l),db(),o!==null&&Y(zl);break;case 24:ls(Pn)}}function jf(o,l){try{var f=l.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var x=g.next;f=x;do{if((f.tag&o)===o){g=void 0;var S=f.create,M=f.inst;g=S(),M.destroy=g}f=f.next}while(f!==x)}}catch(G){zt(l,l.return,G)}}function ho(o,l,f){try{var g=l.updateQueue,x=g!==null?g.lastEffect:null;if(x!==null){var S=x.next;g=S;do{if((g.tag&o)===o){var M=g.inst,G=M.destroy;if(G!==void 0){M.destroy=void 0,x=l;var Q=f,fe=G;try{fe()}catch(be){zt(x,Q,be)}}}g=g.next}while(g!==S)}}catch(be){zt(l,l.return,be)}}function oC(o){var l=o.updateQueue;if(l!==null){var f=o.stateNode;try{QT(l,f)}catch(g){zt(o,o.return,g)}}}function lC(o,l,f){f.props=Gl(o.type,o.memoizedProps),f.state=o.memoizedState;try{f.componentWillUnmount()}catch(g){zt(o,l,g)}}function Vf(o,l){try{var f=o.ref;if(f!==null){switch(o.tag){case 26:case 27:case 5:var g=o.stateNode;break;case 30:g=o.stateNode;break;default:g=o.stateNode}typeof f=="function"?o.refCleanup=f(g):f.current=g}}catch(x){zt(o,l,x)}}function Ra(o,l){var f=o.ref,g=o.refCleanup;if(f!==null)if(typeof g=="function")try{g()}catch(x){zt(o,l,x)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(x){zt(o,l,x)}else f.current=null}function cC(o){var l=o.type,f=o.memoizedProps,g=o.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":f.autoFocus&&g.focus();break e;case"img":f.src?g.src=f.src:f.srcSet&&(g.srcset=f.srcSet)}}catch(x){zt(o,o.return,x)}}function Gb(o,l,f){try{var g=o.stateNode;gz(g,o.type,f,l),g[Zn]=l}catch(x){zt(o,o.return,x)}}function uC(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&xo(o.type)||o.tag===4}function qb(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||uC(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&xo(o.type)||o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function $b(o,l,f){var g=o.tag;if(g===5||g===6)o=o.stateNode,l?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(o,l):(l=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,l.appendChild(o),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=Gi));else if(g!==4&&(g===27&&xo(o.type)&&(f=o.stateNode,l=null),o=o.child,o!==null))for($b(o,l,f),o=o.sibling;o!==null;)$b(o,l,f),o=o.sibling}function am(o,l,f){var g=o.tag;if(g===5||g===6)o=o.stateNode,l?f.insertBefore(o,l):f.appendChild(o);else if(g!==4&&(g===27&&xo(o.type)&&(f=o.stateNode),o=o.child,o!==null))for(am(o,l,f),o=o.sibling;o!==null;)am(o,l,f),o=o.sibling}function dC(o){var l=o.stateNode,f=o.memoizedProps;try{for(var g=o.type,x=l.attributes;x.length;)l.removeAttributeNode(x[0]);sr(l,g,f),l[Dn]=o,l[Zn]=f}catch(S){zt(o,o.return,S)}}var hs=!1,Vn=!1,Hb=!1,fC=typeof WeakSet=="function"?WeakSet:Set,er=null;function K5(o,l){if(o=o.containerInfo,hx=Am,o=ET(o),Ly(o)){if("selectionStart"in o)var f={start:o.selectionStart,end:o.selectionEnd};else e:{f=(f=o.ownerDocument)&&f.defaultView||window;var g=f.getSelection&&f.getSelection();if(g&&g.rangeCount!==0){f=g.anchorNode;var x=g.anchorOffset,S=g.focusNode;g=g.focusOffset;try{f.nodeType,S.nodeType}catch{f=null;break e}var M=0,G=-1,Q=-1,fe=0,be=0,_e=o,he=null;t:for(;;){for(var ge;_e!==f||x!==0&&_e.nodeType!==3||(G=M+x),_e!==S||g!==0&&_e.nodeType!==3||(Q=M+g),_e.nodeType===3&&(M+=_e.nodeValue.length),(ge=_e.firstChild)!==null;)he=_e,_e=ge;for(;;){if(_e===o)break t;if(he===f&&++fe===x&&(G=M),he===S&&++be===g&&(Q=M),(ge=_e.nextSibling)!==null)break;_e=he,he=_e.parentNode}_e=ge}f=G===-1||Q===-1?null:{start:G,end:Q}}else f=null}f=f||{start:0,end:0}}else f=null;for(px={focusedElem:o,selectionRange:f},Am=!1,er=l;er!==null;)if(l=er,o=l.child,(l.subtreeFlags&1028)!==0&&o!==null)o.return=l,er=o;else for(;er!==null;){switch(l=er,S=l.alternate,o=l.flags,l.tag){case 0:if((o&4)!==0&&(o=l.updateQueue,o=o!==null?o.events:null,o!==null))for(f=0;f<o.length;f++)x=o[f],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((o&1024)!==0&&S!==null){o=void 0,f=l,x=S.memoizedProps,S=S.memoizedState,g=f.stateNode;try{var ze=Gl(f.type,x);o=g.getSnapshotBeforeUpdate(ze,S),g.__reactInternalSnapshotBeforeUpdate=o}catch(Ze){zt(f,f.return,Ze)}}break;case 3:if((o&1024)!==0){if(o=l.stateNode.containerInfo,f=o.nodeType,f===9)vx(o);else if(f===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":vx(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(r(163))}if(o=l.sibling,o!==null){o.return=l.return,er=o;break}er=l.return}}function hC(o,l,f){var g=f.flags;switch(f.tag){case 0:case 11:case 15:gs(o,f),g&4&&jf(5,f);break;case 1:if(gs(o,f),g&4)if(o=f.stateNode,l===null)try{o.componentDidMount()}catch(M){zt(f,f.return,M)}else{var x=Gl(f.type,l.memoizedProps);l=l.memoizedState;try{o.componentDidUpdate(x,l,o.__reactInternalSnapshotBeforeUpdate)}catch(M){zt(f,f.return,M)}}g&64&&oC(f),g&512&&Vf(f,f.return);break;case 3:if(gs(o,f),g&64&&(o=f.updateQueue,o!==null)){if(l=null,f.child!==null)switch(f.child.tag){case 27:case 5:l=f.child.stateNode;break;case 1:l=f.child.stateNode}try{QT(o,l)}catch(M){zt(f,f.return,M)}}break;case 27:l===null&&g&4&&dC(f);case 26:case 5:gs(o,f),l===null&&g&4&&cC(f),g&512&&Vf(f,f.return);break;case 12:gs(o,f);break;case 31:gs(o,f),g&4&&mC(o,f);break;case 13:gs(o,f),g&4&&vC(o,f),g&64&&(o=f.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(f=rz.bind(null,f),Sz(o,f))));break;case 22:if(g=f.memoizedState!==null||hs,!g){l=l!==null&&l.memoizedState!==null||Vn,x=hs;var S=Vn;hs=g,(Vn=l)&&!S?ms(o,f,(f.subtreeFlags&8772)!==0):gs(o,f),hs=x,Vn=S}break;case 30:break;default:gs(o,f)}}function pC(o){var l=o.alternate;l!==null&&(o.alternate=null,pC(l)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(l=o.stateNode,l!==null&&Fc(l)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var nn=null,Mr=!1;function ps(o,l,f){for(f=f.child;f!==null;)gC(o,l,f),f=f.sibling}function gC(o,l,f){if(kn&&typeof kn.onCommitFiberUnmount=="function")try{kn.onCommitFiberUnmount(Kr,f)}catch{}switch(f.tag){case 26:Vn||Ra(f,l),ps(o,l,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:Vn||Ra(f,l);var g=nn,x=Mr;xo(f.type)&&(nn=f.stateNode,Mr=!1),ps(o,l,f),Hf(f.stateNode),nn=g,Mr=x;break;case 5:Vn||Ra(f,l);case 6:if(g=nn,x=Mr,nn=null,ps(o,l,f),nn=g,Mr=x,nn!==null)if(Mr)try{(nn.nodeType===9?nn.body:nn.nodeName==="HTML"?nn.ownerDocument.body:nn).removeChild(f.stateNode)}catch(S){zt(f,l,S)}else try{nn.removeChild(f.stateNode)}catch(S){zt(f,l,S)}break;case 18:nn!==null&&(Mr?(o=nn,oI(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,f.stateNode),Au(o)):oI(nn,f.stateNode));break;case 4:g=nn,x=Mr,nn=f.stateNode.containerInfo,Mr=!0,ps(o,l,f),nn=g,Mr=x;break;case 0:case 11:case 14:case 15:ho(2,f,l),Vn||ho(4,f,l),ps(o,l,f);break;case 1:Vn||(Ra(f,l),g=f.stateNode,typeof g.componentWillUnmount=="function"&&lC(f,l,g)),ps(o,l,f);break;case 21:ps(o,l,f);break;case 22:Vn=(g=Vn)||f.memoizedState!==null,ps(o,l,f),Vn=g;break;default:ps(o,l,f)}}function mC(o,l){if(l.memoizedState===null&&(o=l.alternate,o!==null&&(o=o.memoizedState,o!==null))){o=o.dehydrated;try{Au(o)}catch(f){zt(l,l.return,f)}}}function vC(o,l){if(l.memoizedState===null&&(o=l.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{Au(o)}catch(f){zt(l,l.return,f)}}function X5(o){switch(o.tag){case 31:case 13:case 19:var l=o.stateNode;return l===null&&(l=o.stateNode=new fC),l;case 22:return o=o.stateNode,l=o._retryCache,l===null&&(l=o._retryCache=new fC),l;default:throw Error(r(435,o.tag))}}function sm(o,l){var f=X5(o);l.forEach(function(g){if(!f.has(g)){f.add(g);var x=iz.bind(null,o,g);g.then(x,x)}})}function Pr(o,l){var f=l.deletions;if(f!==null)for(var g=0;g<f.length;g++){var x=f[g],S=o,M=l,G=M;e:for(;G!==null;){switch(G.tag){case 27:if(xo(G.type)){nn=G.stateNode,Mr=!1;break e}break;case 5:nn=G.stateNode,Mr=!1;break e;case 3:case 4:nn=G.stateNode.containerInfo,Mr=!0;break e}G=G.return}if(nn===null)throw Error(r(160));gC(S,M,x),nn=null,Mr=!1,S=x.alternate,S!==null&&(S.return=null),x.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)yC(l,o),l=l.sibling}var Xi=null;function yC(o,l){var f=o.alternate,g=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:Pr(l,o),Or(o),g&4&&(ho(3,o,o.return),jf(3,o),ho(5,o,o.return));break;case 1:Pr(l,o),Or(o),g&512&&(Vn||f===null||Ra(f,f.return)),g&64&&hs&&(o=o.updateQueue,o!==null&&(g=o.callbacks,g!==null&&(f=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=f===null?g:f.concat(g))));break;case 26:var x=Xi;if(Pr(l,o),Or(o),g&512&&(Vn||f===null||Ra(f,f.return)),g&4){var S=f!==null?f.memoizedState:null;if(g=o.memoizedState,f===null)if(g===null)if(o.stateNode===null){e:{g=o.type,f=o.memoizedProps,x=x.ownerDocument||x;t:switch(g){case"title":S=x.getElementsByTagName("title")[0],(!S||S[ga]||S[Dn]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=x.createElement(g),x.head.insertBefore(S,x.querySelector("head > title"))),sr(S,g,f),S[Dn]=o,Nn(S),g=S;break e;case"link":var M=yI("link","href",x).get(g+(f.href||""));if(M){for(var G=0;G<M.length;G++)if(S=M[G],S.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&S.getAttribute("rel")===(f.rel==null?null:f.rel)&&S.getAttribute("title")===(f.title==null?null:f.title)&&S.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){M.splice(G,1);break t}}S=x.createElement(g),sr(S,g,f),x.head.appendChild(S);break;case"meta":if(M=yI("meta","content",x).get(g+(f.content||""))){for(G=0;G<M.length;G++)if(S=M[G],S.getAttribute("content")===(f.content==null?null:""+f.content)&&S.getAttribute("name")===(f.name==null?null:f.name)&&S.getAttribute("property")===(f.property==null?null:f.property)&&S.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&S.getAttribute("charset")===(f.charSet==null?null:f.charSet)){M.splice(G,1);break t}}S=x.createElement(g),sr(S,g,f),x.head.appendChild(S);break;default:throw Error(r(468,g))}S[Dn]=o,Nn(S),g=S}o.stateNode=g}else bI(x,o.type,o.stateNode);else o.stateNode=vI(x,g,o.memoizedProps);else S!==g?(S===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):S.count--,g===null?bI(x,o.type,o.stateNode):vI(x,g,o.memoizedProps)):g===null&&o.stateNode!==null&&Gb(o,o.memoizedProps,f.memoizedProps)}break;case 27:Pr(l,o),Or(o),g&512&&(Vn||f===null||Ra(f,f.return)),f!==null&&g&4&&Gb(o,o.memoizedProps,f.memoizedProps);break;case 5:if(Pr(l,o),Or(o),g&512&&(Vn||f===null||Ra(f,f.return)),o.flags&32){x=o.stateNode;try{Nr(x,"")}catch(ze){zt(o,o.return,ze)}}g&4&&o.stateNode!=null&&(x=o.memoizedProps,Gb(o,x,f!==null?f.memoizedProps:x)),g&1024&&(Hb=!0);break;case 6:if(Pr(l,o),Or(o),g&4){if(o.stateNode===null)throw Error(r(162));g=o.memoizedProps,f=o.stateNode;try{f.nodeValue=g}catch(ze){zt(o,o.return,ze)}}break;case 3:if(wm=null,x=Xi,Xi=xm(l.containerInfo),Pr(l,o),Xi=x,Or(o),g&4&&f!==null&&f.memoizedState.isDehydrated)try{Au(l.containerInfo)}catch(ze){zt(o,o.return,ze)}Hb&&(Hb=!1,bC(o));break;case 4:g=Xi,Xi=xm(o.stateNode.containerInfo),Pr(l,o),Or(o),Xi=g;break;case 12:Pr(l,o),Or(o);break;case 31:Pr(l,o),Or(o),g&4&&(g=o.updateQueue,g!==null&&(o.updateQueue=null,sm(o,g)));break;case 13:Pr(l,o),Or(o),o.child.flags&8192&&o.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(lm=ft()),g&4&&(g=o.updateQueue,g!==null&&(o.updateQueue=null,sm(o,g)));break;case 22:x=o.memoizedState!==null;var Q=f!==null&&f.memoizedState!==null,fe=hs,be=Vn;if(hs=fe||x,Vn=be||Q,Pr(l,o),Vn=be,hs=fe,Or(o),g&8192)e:for(l=o.stateNode,l._visibility=x?l._visibility&-2:l._visibility|1,x&&(f===null||Q||hs||Vn||ql(o)),f=null,l=o;;){if(l.tag===5||l.tag===26){if(f===null){Q=f=l;try{if(S=Q.stateNode,x)M=S.style,typeof M.setProperty=="function"?M.setProperty("display","none","important"):M.display="none";else{G=Q.stateNode;var _e=Q.memoizedProps.style,he=_e!=null&&_e.hasOwnProperty("display")?_e.display:null;G.style.display=he==null||typeof he=="boolean"?"":(""+he).trim()}}catch(ze){zt(Q,Q.return,ze)}}}else if(l.tag===6){if(f===null){Q=l;try{Q.stateNode.nodeValue=x?"":Q.memoizedProps}catch(ze){zt(Q,Q.return,ze)}}}else if(l.tag===18){if(f===null){Q=l;try{var ge=Q.stateNode;x?lI(ge,!0):lI(Q.stateNode,!1)}catch(ze){zt(Q,Q.return,ze)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===o)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break e;for(;l.sibling===null;){if(l.return===null||l.return===o)break e;f===l&&(f=null),l=l.return}f===l&&(f=null),l.sibling.return=l.return,l=l.sibling}g&4&&(g=o.updateQueue,g!==null&&(f=g.retryQueue,f!==null&&(g.retryQueue=null,sm(o,f))));break;case 19:Pr(l,o),Or(o),g&4&&(g=o.updateQueue,g!==null&&(o.updateQueue=null,sm(o,g)));break;case 30:break;case 21:break;default:Pr(l,o),Or(o)}}function Or(o){var l=o.flags;if(l&2){try{for(var f,g=o.return;g!==null;){if(uC(g)){f=g;break}g=g.return}if(f==null)throw Error(r(160));switch(f.tag){case 27:var x=f.stateNode,S=qb(o);am(o,S,x);break;case 5:var M=f.stateNode;f.flags&32&&(Nr(M,""),f.flags&=-33);var G=qb(o);am(o,G,M);break;case 3:case 4:var Q=f.stateNode.containerInfo,fe=qb(o);$b(o,fe,Q);break;default:throw Error(r(161))}}catch(be){zt(o,o.return,be)}o.flags&=-3}l&4096&&(o.flags&=-4097)}function bC(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var l=o;bC(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),o=o.sibling}}function gs(o,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)hC(o,l.alternate,l),l=l.sibling}function ql(o){for(o=o.child;o!==null;){var l=o;switch(l.tag){case 0:case 11:case 14:case 15:ho(4,l,l.return),ql(l);break;case 1:Ra(l,l.return);var f=l.stateNode;typeof f.componentWillUnmount=="function"&&lC(l,l.return,f),ql(l);break;case 27:Hf(l.stateNode);case 26:case 5:Ra(l,l.return),ql(l);break;case 22:l.memoizedState===null&&ql(l);break;case 30:ql(l);break;default:ql(l)}o=o.sibling}}function ms(o,l,f){for(f=f&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var g=l.alternate,x=o,S=l,M=S.flags;switch(S.tag){case 0:case 11:case 15:ms(x,S,f),jf(4,S);break;case 1:if(ms(x,S,f),g=S,x=g.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(fe){zt(g,g.return,fe)}if(g=S,x=g.updateQueue,x!==null){var G=g.stateNode;try{var Q=x.shared.hiddenCallbacks;if(Q!==null)for(x.shared.hiddenCallbacks=null,x=0;x<Q.length;x++)WT(Q[x],G)}catch(fe){zt(g,g.return,fe)}}f&&M&64&&oC(S),Vf(S,S.return);break;case 27:dC(S);case 26:case 5:ms(x,S,f),f&&g===null&&M&4&&cC(S),Vf(S,S.return);break;case 12:ms(x,S,f);break;case 31:ms(x,S,f),f&&M&4&&mC(x,S);break;case 13:ms(x,S,f),f&&M&4&&vC(x,S);break;case 22:S.memoizedState===null&&ms(x,S,f),Vf(S,S.return);break;case 30:break;default:ms(x,S,f)}l=l.sibling}}function Yb(o,l){var f=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),o=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(o=l.memoizedState.cachePool.pool),o!==f&&(o!=null&&o.refCount++,f!=null&&Sf(f))}function Kb(o,l){o=null,l.alternate!==null&&(o=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==o&&(l.refCount++,o!=null&&Sf(o))}function Wi(o,l,f,g){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)xC(o,l,f,g),l=l.sibling}function xC(o,l,f,g){var x=l.flags;switch(l.tag){case 0:case 11:case 15:Wi(o,l,f,g),x&2048&&jf(9,l);break;case 1:Wi(o,l,f,g);break;case 3:Wi(o,l,f,g),x&2048&&(o=null,l.alternate!==null&&(o=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==o&&(l.refCount++,o!=null&&Sf(o)));break;case 12:if(x&2048){Wi(o,l,f,g),o=l.stateNode;try{var S=l.memoizedProps,M=S.id,G=S.onPostCommit;typeof G=="function"&&G(M,l.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(Q){zt(l,l.return,Q)}}else Wi(o,l,f,g);break;case 31:Wi(o,l,f,g);break;case 13:Wi(o,l,f,g);break;case 23:break;case 22:S=l.stateNode,M=l.alternate,l.memoizedState!==null?S._visibility&2?Wi(o,l,f,g):zf(o,l):S._visibility&2?Wi(o,l,f,g):(S._visibility|=2,gu(o,l,f,g,(l.subtreeFlags&10256)!==0||!1)),x&2048&&Yb(M,l);break;case 24:Wi(o,l,f,g),x&2048&&Kb(l.alternate,l);break;default:Wi(o,l,f,g)}}function gu(o,l,f,g,x){for(x=x&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var S=o,M=l,G=f,Q=g,fe=M.flags;switch(M.tag){case 0:case 11:case 15:gu(S,M,G,Q,x),jf(8,M);break;case 23:break;case 22:var be=M.stateNode;M.memoizedState!==null?be._visibility&2?gu(S,M,G,Q,x):zf(S,M):(be._visibility|=2,gu(S,M,G,Q,x)),x&&fe&2048&&Yb(M.alternate,M);break;case 24:gu(S,M,G,Q,x),x&&fe&2048&&Kb(M.alternate,M);break;default:gu(S,M,G,Q,x)}l=l.sibling}}function zf(o,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var f=o,g=l,x=g.flags;switch(g.tag){case 22:zf(f,g),x&2048&&Yb(g.alternate,g);break;case 24:zf(f,g),x&2048&&Kb(g.alternate,g);break;default:zf(f,g)}l=l.sibling}}var Lf=8192;function mu(o,l,f){if(o.subtreeFlags&Lf)for(o=o.child;o!==null;)_C(o,l,f),o=o.sibling}function _C(o,l,f){switch(o.tag){case 26:mu(o,l,f),o.flags&Lf&&o.memoizedState!==null&&Oz(f,Xi,o.memoizedState,o.memoizedProps);break;case 5:mu(o,l,f);break;case 3:case 4:var g=Xi;Xi=xm(o.stateNode.containerInfo),mu(o,l,f),Xi=g;break;case 22:o.memoizedState===null&&(g=o.alternate,g!==null&&g.memoizedState!==null?(g=Lf,Lf=16777216,mu(o,l,f),Lf=g):mu(o,l,f));break;default:mu(o,l,f)}}function wC(o){var l=o.alternate;if(l!==null&&(o=l.child,o!==null)){l.child=null;do l=o.sibling,o.sibling=null,o=l;while(o!==null)}}function Bf(o){var l=o.deletions;if((o.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];er=g,EC(g,o)}wC(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)SC(o),o=o.sibling}function SC(o){switch(o.tag){case 0:case 11:case 15:Bf(o),o.flags&2048&&ho(9,o,o.return);break;case 3:Bf(o);break;case 12:Bf(o);break;case 22:var l=o.stateNode;o.memoizedState!==null&&l._visibility&2&&(o.return===null||o.return.tag!==13)?(l._visibility&=-3,om(o)):Bf(o);break;default:Bf(o)}}function om(o){var l=o.deletions;if((o.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];er=g,EC(g,o)}wC(o)}for(o=o.child;o!==null;){switch(l=o,l.tag){case 0:case 11:case 15:ho(8,l,l.return),om(l);break;case 22:f=l.stateNode,f._visibility&2&&(f._visibility&=-3,om(l));break;default:om(l)}o=o.sibling}}function EC(o,l){for(;er!==null;){var f=er;switch(f.tag){case 0:case 11:case 15:ho(8,f,l);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var g=f.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:Sf(f.memoizedState.cache)}if(g=f.child,g!==null)g.return=f,er=g;else e:for(f=o;er!==null;){g=er;var x=g.sibling,S=g.return;if(pC(g),g===f){er=null;break e}if(x!==null){x.return=S,er=x;break e}er=S}}}var W5={getCacheForType:function(o){var l=ir(Pn),f=l.data.get(o);return f===void 0&&(f=o(),l.data.set(o,f)),f},cacheSignal:function(){return ir(Pn).controller.signal}},Q5=typeof WeakMap=="function"?WeakMap:Map,Mt=0,Kt=null,vt=null,bt=0,Vt=0,ni=null,po=!1,vu=!1,Xb=!1,vs=0,mn=0,go=0,$l=0,Wb=0,ri=0,yu=0,Uf=null,jr=null,Qb=!1,lm=0,TC=0,cm=1/0,um=null,mo=null,qn=0,vo=null,bu=null,ys=0,Zb=0,Jb=null,AC=null,Ff=0,ex=null;function ii(){return(Mt&2)!==0&&bt!==0?bt&-bt:$.T!==null?sx():dg()}function CC(){if(ri===0)if((bt&536870912)===0||Tt){var o=ln;ln<<=1,(ln&3932160)===0&&(ln=262144),ri=o}else ri=536870912;return o=ei.current,o!==null&&(o.flags|=32),ri}function Vr(o,l,f){(o===Kt&&(Vt===2||Vt===9)||o.cancelPendingCommit!==null)&&(xu(o,0),yo(o,bt,ri,!1)),bl(o,f),((Mt&2)===0||o!==Kt)&&(o===Kt&&((Mt&2)===0&&($l|=f),mn===4&&yo(o,bt,ri,!1)),ka(o))}function IC(o,l,f){if((Mt&6)!==0)throw Error(r(327));var g=!f&&(l&127)===0&&(l&o.expiredLanes)===0||_r(o,l),x=g?ez(o,l):nx(o,l,!0),S=g;do{if(x===0){vu&&!g&&yo(o,l,0,!1);break}else{if(f=o.current.alternate,S&&!Z5(f)){x=nx(o,l,!1),S=!1;continue}if(x===2){if(S=l,o.errorRecoveryDisabledLanes&S)var M=0;else M=o.pendingLanes&-536870913,M=M!==0?M:M&536870912?536870912:0;if(M!==0){l=M;e:{var G=o;x=Uf;var Q=G.current.memoizedState.isDehydrated;if(Q&&(xu(G,M).flags|=256),M=nx(G,M,!1),M!==2){if(Xb&&!Q){G.errorRecoveryDisabledLanes|=S,$l|=S,x=4;break e}S=jr,jr=x,S!==null&&(jr===null?jr=S:jr.push.apply(jr,S))}x=M}if(S=!1,x!==2)continue}}if(x===1){xu(o,0),yo(o,l,0,!0);break}e:{switch(g=o,S=x,S){case 0:case 1:throw Error(r(345));case 4:if((l&4194048)!==l)break;case 6:yo(g,l,ri,!po);break e;case 2:jr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((l&62914560)===l&&(x=lm+300-ft(),10<x)){if(yo(g,l,ri,!po),fi(g,0,!0)!==0)break e;ys=l,g.timeoutHandle=aI(RC.bind(null,g,f,jr,um,Qb,l,ri,$l,yu,po,S,"Throttled",-0,0),x);break e}RC(g,f,jr,um,Qb,l,ri,$l,yu,po,S,null,-0,0)}}break}while(!0);ka(o)}function RC(o,l,f,g,x,S,M,G,Q,fe,be,_e,he,ge){if(o.timeoutHandle=-1,_e=l.subtreeFlags,_e&8192||(_e&16785408)===16785408){_e={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Gi},_C(l,S,_e);var ze=(S&62914560)===S?lm-ft():(S&4194048)===S?TC-ft():0;if(ze=jz(_e,ze),ze!==null){ys=S,o.cancelPendingCommit=ze(VC.bind(null,o,l,S,f,g,x,M,G,Q,be,_e,null,he,ge)),yo(o,S,M,!fe);return}}VC(o,l,S,f,g,x,M,G,Q)}function Z5(o){for(var l=o;;){var f=l.tag;if((f===0||f===11||f===15)&&l.flags&16384&&(f=l.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var g=0;g<f.length;g++){var x=f[g],S=x.getSnapshot;x=x.value;try{if(!Zr(S(),x))return!1}catch{return!1}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function yo(o,l,f,g){l&=~Wb,l&=~$l,o.suspendedLanes|=l,o.pingedLanes&=~l,g&&(o.warmLanes|=l),g=o.expirationTimes;for(var x=l;0<x;){var S=31-on(x),M=1<<S;g[S]=-1,x&=~M}f!==0&&xl(o,f,l)}function dm(){return(Mt&6)===0?(Gf(0),!1):!0}function tx(){if(vt!==null){if(Vt===0)var o=vt.return;else o=vt,os=jl=null,vb(o),uu=null,Tf=0,o=vt;for(;o!==null;)sC(o.alternate,o),o=o.return;vt=null}}function xu(o,l){var f=o.timeoutHandle;f!==-1&&(o.timeoutHandle=-1,yz(f)),f=o.cancelPendingCommit,f!==null&&(o.cancelPendingCommit=null,f()),ys=0,tx(),Kt=o,vt=f=as(o.current,null),bt=l,Vt=0,ni=null,po=!1,vu=_r(o,l),Xb=!1,yu=ri=Wb=$l=go=mn=0,jr=Uf=null,Qb=!1,(l&8)!==0&&(l|=l&32);var g=o.entangledLanes;if(g!==0)for(o=o.entanglements,g&=l;0<g;){var x=31-on(g),S=1<<x;l|=o[x],g&=~S}return vs=l,Ng(),f}function kC(o,l){ut=null,$.H=Mf,l===cu||l===Bg?(l=HT(),Vt=3):l===ab?(l=HT(),Vt=4):Vt=l===Mb?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,ni=l,vt===null&&(mn=1,em(o,yi(l,o.current)))}function DC(){var o=ei.current;return o===null?!0:(bt&4194048)===bt?wi===null:(bt&62914560)===bt||(bt&536870912)!==0?o===wi:!1}function NC(){var o=$.H;return $.H=Mf,o===null?Mf:o}function MC(){var o=$.A;return $.A=W5,o}function fm(){mn=4,po||(bt&4194048)!==bt&&ei.current!==null||(vu=!0),(go&134217727)===0&&($l&134217727)===0||Kt===null||yo(Kt,bt,ri,!1)}function nx(o,l,f){var g=Mt;Mt|=2;var x=NC(),S=MC();(Kt!==o||bt!==l)&&(um=null,xu(o,l)),l=!1;var M=mn;e:do try{if(Vt!==0&&vt!==null){var G=vt,Q=ni;switch(Vt){case 8:tx(),M=6;break e;case 3:case 2:case 9:case 6:ei.current===null&&(l=!0);var fe=Vt;if(Vt=0,ni=null,_u(o,G,Q,fe),f&&vu){M=0;break e}break;default:fe=Vt,Vt=0,ni=null,_u(o,G,Q,fe)}}J5(),M=mn;break}catch(be){kC(o,be)}while(!0);return l&&o.shellSuspendCounter++,os=jl=null,Mt=g,$.H=x,$.A=S,vt===null&&(Kt=null,bt=0,Ng()),M}function J5(){for(;vt!==null;)PC(vt)}function ez(o,l){var f=Mt;Mt|=2;var g=NC(),x=MC();Kt!==o||bt!==l?(um=null,cm=ft()+500,xu(o,l)):vu=_r(o,l);e:do try{if(Vt!==0&&vt!==null){l=vt;var S=ni;t:switch(Vt){case 1:Vt=0,ni=null,_u(o,l,S,1);break;case 2:case 9:if(qT(S)){Vt=0,ni=null,OC(l);break}l=function(){Vt!==2&&Vt!==9||Kt!==o||(Vt=7),ka(o)},S.then(l,l);break e;case 3:Vt=7;break e;case 4:Vt=5;break e;case 7:qT(S)?(Vt=0,ni=null,OC(l)):(Vt=0,ni=null,_u(o,l,S,7));break;case 5:var M=null;switch(vt.tag){case 26:M=vt.memoizedState;case 5:case 27:var G=vt;if(M?xI(M):G.stateNode.complete){Vt=0,ni=null;var Q=G.sibling;if(Q!==null)vt=Q;else{var fe=G.return;fe!==null?(vt=fe,hm(fe)):vt=null}break t}}Vt=0,ni=null,_u(o,l,S,5);break;case 6:Vt=0,ni=null,_u(o,l,S,6);break;case 8:tx(),mn=6;break e;default:throw Error(r(462))}}tz();break}catch(be){kC(o,be)}while(!0);return os=jl=null,$.H=g,$.A=x,Mt=f,vt!==null?0:(Kt=null,bt=0,Ng(),mn)}function tz(){for(;vt!==null&&!Et();)PC(vt)}function PC(o){var l=iC(o.alternate,o,vs);o.memoizedProps=o.pendingProps,l===null?hm(o):vt=l}function OC(o){var l=o,f=l.alternate;switch(l.tag){case 15:case 0:l=ZA(f,l,l.pendingProps,l.type,void 0,bt);break;case 11:l=ZA(f,l,l.pendingProps,l.type.render,l.ref,bt);break;case 5:vb(l);default:sC(f,l),l=vt=MT(l,vs),l=iC(f,l,vs)}o.memoizedProps=o.pendingProps,l===null?hm(o):vt=l}function _u(o,l,f,g){os=jl=null,vb(l),uu=null,Tf=0;var x=l.return;try{if(G5(o,x,l,f,bt)){mn=1,em(o,yi(f,o.current)),vt=null;return}}catch(S){if(x!==null)throw vt=x,S;mn=1,em(o,yi(f,o.current)),vt=null;return}l.flags&32768?(Tt||g===1?o=!0:vu||(bt&536870912)!==0?o=!1:(po=o=!0,(g===2||g===9||g===3||g===6)&&(g=ei.current,g!==null&&g.tag===13&&(g.flags|=16384))),jC(l,o)):hm(l)}function hm(o){var l=o;do{if((l.flags&32768)!==0){jC(l,po);return}o=l.return;var f=H5(l.alternate,l,vs);if(f!==null){vt=f;return}if(l=l.sibling,l!==null){vt=l;return}vt=l=o}while(l!==null);mn===0&&(mn=5)}function jC(o,l){do{var f=Y5(o.alternate,o);if(f!==null){f.flags&=32767,vt=f;return}if(f=o.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!l&&(o=o.sibling,o!==null)){vt=o;return}vt=o=f}while(o!==null);mn=6,vt=null}function VC(o,l,f,g,x,S,M,G,Q){o.cancelPendingCommit=null;do pm();while(qn!==0);if((Mt&6)!==0)throw Error(r(327));if(l!==null){if(l===o.current)throw Error(r(177));if(S=l.lanes|l.childLanes,S|=qy,Oy(o,f,S,M,G,Q),o===Kt&&(vt=Kt=null,bt=0),bu=l,vo=o,ys=f,Zb=S,Jb=x,AC=g,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,az(Rn,function(){return FC(),null})):(o.callbackNode=null,o.callbackPriority=0),g=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||g){g=$.T,$.T=null,x=W.p,W.p=2,M=Mt,Mt|=4;try{K5(o,l,f)}finally{Mt=M,W.p=x,$.T=g}}qn=1,zC(),LC(),BC()}}function zC(){if(qn===1){qn=0;var o=vo,l=bu,f=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||f){f=$.T,$.T=null;var g=W.p;W.p=2;var x=Mt;Mt|=4;try{yC(l,o);var S=px,M=ET(o.containerInfo),G=S.focusedElem,Q=S.selectionRange;if(M!==G&&G&&G.ownerDocument&&ST(G.ownerDocument.documentElement,G)){if(Q!==null&&Ly(G)){var fe=Q.start,be=Q.end;if(be===void 0&&(be=fe),"selectionStart"in G)G.selectionStart=fe,G.selectionEnd=Math.min(be,G.value.length);else{var _e=G.ownerDocument||document,he=_e&&_e.defaultView||window;if(he.getSelection){var ge=he.getSelection(),ze=G.textContent.length,Ze=Math.min(Q.start,ze),$t=Q.end===void 0?Ze:Math.min(Q.end,ze);!ge.extend&&Ze>$t&&(M=$t,$t=Ze,Ze=M);var se=wT(G,Ze),re=wT(G,$t);if(se&&re&&(ge.rangeCount!==1||ge.anchorNode!==se.node||ge.anchorOffset!==se.offset||ge.focusNode!==re.node||ge.focusOffset!==re.offset)){var de=_e.createRange();de.setStart(se.node,se.offset),ge.removeAllRanges(),Ze>$t?(ge.addRange(de),ge.extend(re.node,re.offset)):(de.setEnd(re.node,re.offset),ge.addRange(de))}}}}for(_e=[],ge=G;ge=ge.parentNode;)ge.nodeType===1&&_e.push({element:ge,left:ge.scrollLeft,top:ge.scrollTop});for(typeof G.focus=="function"&&G.focus(),G=0;G<_e.length;G++){var xe=_e[G];xe.element.scrollLeft=xe.left,xe.element.scrollTop=xe.top}}Am=!!hx,px=hx=null}finally{Mt=x,W.p=g,$.T=f}}o.current=l,qn=2}}function LC(){if(qn===2){qn=0;var o=vo,l=bu,f=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||f){f=$.T,$.T=null;var g=W.p;W.p=2;var x=Mt;Mt|=4;try{hC(o,l.alternate,l)}finally{Mt=x,W.p=g,$.T=f}}qn=3}}function BC(){if(qn===4||qn===3){qn=0,tt();var o=vo,l=bu,f=ys,g=AC;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?qn=5:(qn=0,bu=vo=null,UC(o,o.pendingLanes));var x=o.pendingLanes;if(x===0&&(mo=null),ts(f),l=l.stateNode,kn&&typeof kn.onCommitFiberRoot=="function")try{kn.onCommitFiberRoot(Kr,l,void 0,(l.current.flags&128)===128)}catch{}if(g!==null){l=$.T,x=W.p,W.p=2,$.T=null;try{for(var S=o.onRecoverableError,M=0;M<g.length;M++){var G=g[M];S(G.value,{componentStack:G.stack})}}finally{$.T=l,W.p=x}}(ys&3)!==0&&pm(),ka(o),x=o.pendingLanes,(f&261930)!==0&&(x&42)!==0?o===ex?Ff++:(Ff=0,ex=o):Ff=0,Gf(0)}}function UC(o,l){(o.pooledCacheLanes&=l)===0&&(l=o.pooledCache,l!=null&&(o.pooledCache=null,Sf(l)))}function pm(){return zC(),LC(),BC(),FC()}function FC(){if(qn!==5)return!1;var o=vo,l=Zb;Zb=0;var f=ts(ys),g=$.T,x=W.p;try{W.p=32>f?32:f,$.T=null,f=Jb,Jb=null;var S=vo,M=ys;if(qn=0,bu=vo=null,ys=0,(Mt&6)!==0)throw Error(r(331));var G=Mt;if(Mt|=4,SC(S.current),xC(S,S.current,M,f),Mt=G,Gf(0,!1),kn&&typeof kn.onPostCommitFiberRoot=="function")try{kn.onPostCommitFiberRoot(Kr,S)}catch{}return!0}finally{W.p=x,$.T=g,UC(o,l)}}function GC(o,l,f){l=yi(f,l),l=Nb(o.stateNode,l,2),o=co(o,l,2),o!==null&&(bl(o,2),ka(o))}function zt(o,l,f){if(o.tag===3)GC(o,o,f);else for(;l!==null;){if(l.tag===3){GC(l,o,f);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(mo===null||!mo.has(g))){o=yi(f,o),f=qA(2),g=co(l,f,2),g!==null&&($A(f,g,l,o),bl(g,2),ka(g));break}}l=l.return}}function rx(o,l,f){var g=o.pingCache;if(g===null){g=o.pingCache=new Q5;var x=new Set;g.set(l,x)}else x=g.get(l),x===void 0&&(x=new Set,g.set(l,x));x.has(f)||(Xb=!0,x.add(f),o=nz.bind(null,o,l,f),l.then(o,o))}function nz(o,l,f){var g=o.pingCache;g!==null&&g.delete(l),o.pingedLanes|=o.suspendedLanes&f,o.warmLanes&=~f,Kt===o&&(bt&f)===f&&(mn===4||mn===3&&(bt&62914560)===bt&&300>ft()-lm?(Mt&2)===0&&xu(o,0):Wb|=f,yu===bt&&(yu=0)),ka(o)}function qC(o,l){l===0&&(l=ug()),o=Ml(o,l),o!==null&&(bl(o,l),ka(o))}function rz(o){var l=o.memoizedState,f=0;l!==null&&(f=l.retryLane),qC(o,f)}function iz(o,l){var f=0;switch(o.tag){case 31:case 13:var g=o.stateNode,x=o.memoizedState;x!==null&&(f=x.retryLane);break;case 19:g=o.stateNode;break;case 22:g=o.stateNode._retryCache;break;default:throw Error(r(314))}g!==null&&g.delete(l),qC(o,f)}function az(o,l){return Ue(o,l)}var gm=null,wu=null,ix=!1,mm=!1,ax=!1,bo=0;function ka(o){o!==wu&&o.next===null&&(wu===null?gm=wu=o:wu=wu.next=o),mm=!0,ix||(ix=!0,oz())}function Gf(o,l){if(!ax&&mm){ax=!0;do for(var f=!1,g=gm;g!==null;){if(o!==0){var x=g.pendingLanes;if(x===0)var S=0;else{var M=g.suspendedLanes,G=g.pingedLanes;S=(1<<31-on(42|o)+1)-1,S&=x&~(M&~G),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(f=!0,KC(g,S))}else S=bt,S=fi(g,g===Kt?S:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(S&3)===0||_r(g,S)||(f=!0,KC(g,S));g=g.next}while(f);ax=!1}}function sz(){$C()}function $C(){mm=ix=!1;var o=0;bo!==0&&vz()&&(o=bo);for(var l=ft(),f=null,g=gm;g!==null;){var x=g.next,S=HC(g,l);S===0?(g.next=null,f===null?gm=x:f.next=x,x===null&&(wu=f)):(f=g,(o!==0||(S&3)!==0)&&(mm=!0)),g=x}qn!==0&&qn!==5||Gf(o),bo!==0&&(bo=0)}function HC(o,l){for(var f=o.suspendedLanes,g=o.pingedLanes,x=o.expirationTimes,S=o.pendingLanes&-62914561;0<S;){var M=31-on(S),G=1<<M,Q=x[M];Q===-1?((G&f)===0||(G&g)!==0)&&(x[M]=Py(G,l)):Q<=l&&(o.expiredLanes|=G),S&=~G}if(l=Kt,f=bt,f=fi(o,o===l?f:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),g=o.callbackNode,f===0||o===l&&(Vt===2||Vt===9)||o.cancelPendingCommit!==null)return g!==null&&g!==null&&lt(g),o.callbackNode=null,o.callbackPriority=0;if((f&3)===0||_r(o,f)){if(l=f&-f,l===o.callbackPriority)return l;switch(g!==null&&lt(g),ts(f)){case 2:case 8:f=Ot;break;case 32:f=Rn;break;case 268435456:f=fa;break;default:f=Rn}return g=YC.bind(null,o),f=Ue(f,g),o.callbackPriority=l,o.callbackNode=f,l}return g!==null&&g!==null&&lt(g),o.callbackPriority=2,o.callbackNode=null,2}function YC(o,l){if(qn!==0&&qn!==5)return o.callbackNode=null,o.callbackPriority=0,null;var f=o.callbackNode;if(pm()&&o.callbackNode!==f)return null;var g=bt;return g=fi(o,o===Kt?g:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),g===0?null:(IC(o,g,l),HC(o,ft()),o.callbackNode!=null&&o.callbackNode===f?YC.bind(null,o):null)}function KC(o,l){if(pm())return null;IC(o,l,!0)}function oz(){bz(function(){(Mt&6)!==0?Ue(pn,sz):$C()})}function sx(){if(bo===0){var o=ou;o===0&&(o=mt,mt<<=1,(mt&261888)===0&&(mt=256)),bo=o}return bo}function XC(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:Hc(""+o)}function WC(o,l){var f=l.ownerDocument.createElement("input");return f.name=l.name,f.value=l.value,o.id&&f.setAttribute("form",o.id),l.parentNode.insertBefore(f,l),o=new FormData(o),f.parentNode.removeChild(f),o}function lz(o,l,f,g,x){if(l==="submit"&&f&&f.stateNode===x){var S=XC((x[Zn]||null).action),M=g.submitter;M&&(l=(l=M[Zn]||null)?XC(l.formAction):M.getAttribute("formAction"),l!==null&&(S=l,M=null));var G=new Sa("action","action",null,g,x);o.push({event:G,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(bo!==0){var Q=M?WC(x,M):new FormData(x);Ab(f,{pending:!0,data:Q,method:x.method,action:S},null,Q)}}else typeof S=="function"&&(G.preventDefault(),Q=M?WC(x,M):new FormData(x),Ab(f,{pending:!0,data:Q,method:x.method,action:S},S,Q))},currentTarget:x}]})}}for(var ox=0;ox<Gy.length;ox++){var lx=Gy[ox],cz=lx.toLowerCase(),uz=lx[0].toUpperCase()+lx.slice(1);Ki(cz,"on"+uz)}Ki(CT,"onAnimationEnd"),Ki(IT,"onAnimationIteration"),Ki(RT,"onAnimationStart"),Ki("dblclick","onDoubleClick"),Ki("focusin","onFocus"),Ki("focusout","onBlur"),Ki(A5,"onTransitionRun"),Ki(C5,"onTransitionStart"),Ki(I5,"onTransitionCancel"),Ki(kT,"onTransitionEnd"),ba("onMouseEnter",["mouseout","mouseover"]),ba("onMouseLeave",["mouseout","mouseover"]),ba("onPointerEnter",["pointerout","pointerover"]),ba("onPointerLeave",["pointerout","pointerover"]),ya("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ya("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ya("onBeforeInput",["compositionend","keypress","textInput","paste"]),ya("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ya("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ya("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dz=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(qf));function QC(o,l){l=(l&4)!==0;for(var f=0;f<o.length;f++){var g=o[f],x=g.event;g=g.listeners;e:{var S=void 0;if(l)for(var M=g.length-1;0<=M;M--){var G=g[M],Q=G.instance,fe=G.currentTarget;if(G=G.listener,Q!==S&&x.isPropagationStopped())break e;S=G,x.currentTarget=fe;try{S(x)}catch(be){Dg(be)}x.currentTarget=null,S=Q}else for(M=0;M<g.length;M++){if(G=g[M],Q=G.instance,fe=G.currentTarget,G=G.listener,Q!==S&&x.isPropagationStopped())break e;S=G,x.currentTarget=fe;try{S(x)}catch(be){Dg(be)}x.currentTarget=null,S=Q}}}}function yt(o,l){var f=l[Uc];f===void 0&&(f=l[Uc]=new Set);var g=o+"__bubble";f.has(g)||(ZC(l,o,2,!1),f.add(g))}function cx(o,l,f){var g=0;l&&(g|=4),ZC(f,o,g,l)}var vm="_reactListening"+Math.random().toString(36).slice(2);function ux(o){if(!o[vm]){o[vm]=!0,tf.forEach(function(f){f!=="selectionchange"&&(dz.has(f)||cx(f,!1,o),cx(f,!0,o))});var l=o.nodeType===9?o:o.ownerDocument;l===null||l[vm]||(l[vm]=!0,cx("selectionchange",!1,l))}}function ZC(o,l,f,g){switch(CI(l)){case 2:var x=Lz;break;case 8:x=Bz;break;default:x=Tx}f=x.bind(null,l,f,o),x=void 0,!Tl||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(x=!0),g?x!==void 0?o.addEventListener(l,f,{capture:!0,passive:x}):o.addEventListener(l,f,!0):x!==void 0?o.addEventListener(l,f,{passive:x}):o.addEventListener(l,f,!1)}function dx(o,l,f,g,x){var S=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var M=g.tag;if(M===3||M===4){var G=g.stateNode.containerInfo;if(G===x)break;if(M===4)for(M=g.return;M!==null;){var Q=M.tag;if((Q===3||Q===4)&&M.stateNode.containerInfo===x)return;M=M.return}for(;G!==null;){if(M=ma(G),M===null)return;if(Q=M.tag,Q===5||Q===6||Q===26||Q===27){g=S=M;continue e}G=G.parentNode}}g=g.return}Js(function(){var fe=S,be=pi(f),_e=[];e:{var he=DT.get(o);if(he!==void 0){var ge=Sa,ze=o;switch(o){case"keypress":if(Cl(f)===0)break e;case"keydown":case"keyup":ge=Ig;break;case"focusin":ze="focus",ge=Rl;break;case"focusout":ze="blur",ge=Rl;break;case"beforeblur":case"afterblur":ge=Rl;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=gf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=bg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=R;break;case CT:case IT:case RT:ge=_g;break;case kT:ge=q;break;case"scroll":case"scrollend":ge=pf;break;case"wheel":ge=pe;break;case"copy":case"cut":case"paste":ge=wg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=is;break;case"toggle":case"beforetoggle":ge=ct}var Ze=(l&4)!==0,$t=!Ze&&(o==="scroll"||o==="scrollend"),se=Ze?he!==null?he+"Capture":null:he;Ze=[];for(var re=fe,de;re!==null;){var xe=re;if(de=xe.stateNode,xe=xe.tag,xe!==5&&xe!==26&&xe!==27||de===null||se===null||(xe=qi(re,se),xe!=null&&Ze.push($f(re,xe,de))),$t)break;re=re.return}0<Ze.length&&(he=new ge(he,ze,null,f,be),_e.push({event:he,listeners:Ze}))}}if((l&7)===0){e:{if(he=o==="mouseover"||o==="pointerover",ge=o==="mouseout"||o==="pointerout",he&&f!==df&&(ze=f.relatedTarget||f.fromElement)&&(ma(ze)||ze[pa]))break e;if((ge||he)&&(he=be.window===be?be:(he=be.ownerDocument)?he.defaultView||he.parentWindow:window,ge?(ze=f.relatedTarget||f.toElement,ge=fe,ze=ze?ma(ze):null,ze!==null&&($t=a(ze),Ze=ze.tag,ze!==$t||Ze!==5&&Ze!==27&&Ze!==6)&&(ze=null)):(ge=null,ze=fe),ge!==ze)){if(Ze=gf,xe="onMouseLeave",se="onMouseEnter",re="mouse",(o==="pointerout"||o==="pointerover")&&(Ze=is,xe="onPointerLeave",se="onPointerEnter",re="pointer"),$t=ge==null?he:Wr(ge),de=ze==null?he:Wr(ze),he=new Ze(xe,re+"leave",ge,f,be),he.target=$t,he.relatedTarget=de,xe=null,ma(be)===fe&&(Ze=new Ze(se,re+"enter",ze,f,be),Ze.target=de,Ze.relatedTarget=$t,xe=Ze),$t=xe,ge&&ze)t:{for(Ze=fz,se=ge,re=ze,de=0,xe=se;xe;xe=Ze(xe))de++;xe=0;for(var Ke=re;Ke;Ke=Ze(Ke))xe++;for(;0<de-xe;)se=Ze(se),de--;for(;0<xe-de;)re=Ze(re),xe--;for(;de--;){if(se===re||re!==null&&se===re.alternate){Ze=se;break t}se=Ze(se),re=Ze(re)}Ze=null}else Ze=null;ge!==null&&JC(_e,he,ge,Ze,!1),ze!==null&&$t!==null&&JC(_e,$t,ze,Ze,!0)}}e:{if(he=fe?Wr(fe):window,ge=he.nodeName&&he.nodeName.toLowerCase(),ge==="select"||ge==="input"&&he.type==="file")var Rt=mT;else if(pT(he))if(vT)Rt=S5;else{Rt=_5;var qe=x5}else ge=he.nodeName,!ge||ge.toLowerCase()!=="input"||he.type!=="checkbox"&&he.type!=="radio"?fe&&$c(fe.elementType)&&(Rt=mT):Rt=w5;if(Rt&&(Rt=Rt(o,fe))){gT(_e,Rt,f,be);break e}qe&&qe(o,he,fe),o==="focusout"&&fe&&he.type==="number"&&fe.memoizedProps.value!=null&&lf(he,"number",he.value)}switch(qe=fe?Wr(fe):window,o){case"focusin":(pT(qe)||qe.contentEditable==="true")&&(Jc=qe,By=fe,xf=null);break;case"focusout":xf=By=Jc=null;break;case"mousedown":Uy=!0;break;case"contextmenu":case"mouseup":case"dragend":Uy=!1,TT(_e,f,be);break;case"selectionchange":if(T5)break;case"keydown":case"keyup":TT(_e,f,be)}var ht;if(Nt)e:{switch(o){case"compositionstart":var xt="onCompositionStart";break e;case"compositionend":xt="onCompositionEnd";break e;case"compositionupdate":xt="onCompositionUpdate";break e}xt=void 0}else Zc?kl(o,f)&&(xt="onCompositionEnd"):o==="keydown"&&f.keyCode===229&&(xt="onCompositionStart");xt&&(Aa&&f.locale!=="ko"&&(Zc||xt!=="onCompositionStart"?xt==="onCompositionEnd"&&Zc&&(ht=hf()):(wa=be,ff="value"in wa?wa.value:wa.textContent,Zc=!0)),qe=ym(fe,xt),0<qe.length&&(xt=new Ta(xt,o,null,f,be),_e.push({event:xt,listeners:qe}),ht?xt.data=ht:(ht=Qc(f),ht!==null&&(xt.data=ht)))),(ht=mi?m5(o,f):v5(o,f))&&(xt=ym(fe,"onBeforeInput"),0<xt.length&&(qe=new Ta("onBeforeInput","beforeinput",null,f,be),_e.push({event:qe,listeners:xt}),qe.data=ht)),lz(_e,o,fe,f,be)}QC(_e,l)})}function $f(o,l,f){return{instance:o,listener:l,currentTarget:f}}function ym(o,l){for(var f=l+"Capture",g=[];o!==null;){var x=o,S=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||S===null||(x=qi(o,f),x!=null&&g.unshift($f(o,x,S)),x=qi(o,l),x!=null&&g.push($f(o,x,S))),o.tag===3)return g;o=o.return}return[]}function fz(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function JC(o,l,f,g,x){for(var S=l._reactName,M=[];f!==null&&f!==g;){var G=f,Q=G.alternate,fe=G.stateNode;if(G=G.tag,Q!==null&&Q===g)break;G!==5&&G!==26&&G!==27||fe===null||(Q=fe,x?(fe=qi(f,S),fe!=null&&M.unshift($f(f,fe,Q))):x||(fe=qi(f,S),fe!=null&&M.push($f(f,fe,Q)))),f=f.return}M.length!==0&&o.push({event:l,listeners:M})}var hz=/\r\n?/g,pz=/\u0000|\uFFFD/g;function eI(o){return(typeof o=="string"?o:""+o).replace(hz,`
`).replace(pz,"")}function tI(o,l){return l=eI(l),eI(o)===l}function qt(o,l,f,g,x,S){switch(f){case"children":typeof g=="string"?l==="body"||l==="textarea"&&g===""||Nr(o,g):(typeof g=="number"||typeof g=="bigint")&&l!=="body"&&Nr(o,""+g);break;case"className":Qr(o,"class",g);break;case"tabIndex":Qr(o,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":Qr(o,f,g);break;case"style":uf(o,g,S);break;case"data":if(l!=="object"){Qr(o,"data",g);break}case"src":case"href":if(g===""&&(l!=="a"||f!=="href")){o.removeAttribute(f);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){o.removeAttribute(f);break}g=Hc(""+g),o.setAttribute(f,g);break;case"action":case"formAction":if(typeof g=="function"){o.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(f==="formAction"?(l!=="input"&&qt(o,l,"name",x.name,x,null),qt(o,l,"formEncType",x.formEncType,x,null),qt(o,l,"formMethod",x.formMethod,x,null),qt(o,l,"formTarget",x.formTarget,x,null)):(qt(o,l,"encType",x.encType,x,null),qt(o,l,"method",x.method,x,null),qt(o,l,"target",x.target,x,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){o.removeAttribute(f);break}g=Hc(""+g),o.setAttribute(f,g);break;case"onClick":g!=null&&(o.onclick=Gi);break;case"onScroll":g!=null&&yt("scroll",o);break;case"onScrollEnd":g!=null&&yt("scrollend",o);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));o.innerHTML=f}}break;case"multiple":o.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":o.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){o.removeAttribute("xlink:href");break}f=Hc(""+g),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?o.setAttribute(f,""+g):o.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?o.setAttribute(f,""):o.removeAttribute(f);break;case"capture":case"download":g===!0?o.setAttribute(f,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?o.setAttribute(f,g):o.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?o.setAttribute(f,g):o.removeAttribute(f);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?o.removeAttribute(f):o.setAttribute(f,g);break;case"popover":yt("beforetoggle",o),yt("toggle",o),Gc(o,"popover",g);break;case"xlinkActuate":Mn(o,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":Mn(o,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":Mn(o,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":Mn(o,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":Mn(o,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":Mn(o,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":Mn(o,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":Mn(o,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":Mn(o,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":Gc(o,"is",g);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=yg.get(f)||f,Gc(o,f,g))}}function fx(o,l,f,g,x,S){switch(f){case"style":uf(o,g,S);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));o.innerHTML=f}}break;case"children":typeof g=="string"?Nr(o,g):(typeof g=="number"||typeof g=="bigint")&&Nr(o,""+g);break;case"onScroll":g!=null&&yt("scroll",o);break;case"onScrollEnd":g!=null&&yt("scrollend",o);break;case"onClick":g!=null&&(o.onclick=Gi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!nf.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(x=f.endsWith("Capture"),l=f.slice(2,x?f.length-7:void 0),S=o[Zn]||null,S=S!=null?S[f]:null,typeof S=="function"&&o.removeEventListener(l,S,x),typeof g=="function")){typeof S!="function"&&S!==null&&(f in o?o[f]=null:o.hasAttribute(f)&&o.removeAttribute(f)),o.addEventListener(l,g,x);break e}f in o?o[f]=g:g===!0?o.setAttribute(f,""):Gc(o,f,g)}}}function sr(o,l,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":yt("error",o),yt("load",o);var g=!1,x=!1,S;for(S in f)if(f.hasOwnProperty(S)){var M=f[S];if(M!=null)switch(S){case"src":g=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:qt(o,l,S,M,f,null)}}x&&qt(o,l,"srcSet",f.srcSet,f,null),g&&qt(o,l,"src",f.src,f,null);return;case"input":yt("invalid",o);var G=S=M=x=null,Q=null,fe=null;for(g in f)if(f.hasOwnProperty(g)){var be=f[g];if(be!=null)switch(g){case"name":x=be;break;case"type":M=be;break;case"checked":Q=be;break;case"defaultChecked":fe=be;break;case"value":S=be;break;case"defaultValue":G=be;break;case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(r(137,l));break;default:qt(o,l,g,be,f,null)}}gg(o,S,G,Q,fe,M,x,!1);return;case"select":yt("invalid",o),g=M=S=null;for(x in f)if(f.hasOwnProperty(x)&&(G=f[x],G!=null))switch(x){case"value":S=G;break;case"defaultValue":M=G;break;case"multiple":g=G;default:qt(o,l,x,G,f,null)}l=S,f=M,o.multiple=!!g,l!=null?Xs(o,!!g,l,!1):f!=null&&Xs(o,!!g,f,!0);return;case"textarea":yt("invalid",o),S=x=g=null;for(M in f)if(f.hasOwnProperty(M)&&(G=f[M],G!=null))switch(M){case"value":g=G;break;case"defaultValue":x=G;break;case"children":S=G;break;case"dangerouslySetInnerHTML":if(G!=null)throw Error(r(91));break;default:qt(o,l,M,G,f,null)}Ws(o,g,x,S);return;case"option":for(Q in f)if(f.hasOwnProperty(Q)&&(g=f[Q],g!=null))switch(Q){case"selected":o.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:qt(o,l,Q,g,f,null)}return;case"dialog":yt("beforetoggle",o),yt("toggle",o),yt("cancel",o),yt("close",o);break;case"iframe":case"object":yt("load",o);break;case"video":case"audio":for(g=0;g<qf.length;g++)yt(qf[g],o);break;case"image":yt("error",o),yt("load",o);break;case"details":yt("toggle",o);break;case"embed":case"source":case"link":yt("error",o),yt("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(fe in f)if(f.hasOwnProperty(fe)&&(g=f[fe],g!=null))switch(fe){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:qt(o,l,fe,g,f,null)}return;default:if($c(l)){for(be in f)f.hasOwnProperty(be)&&(g=f[be],g!==void 0&&fx(o,l,be,g,f,void 0));return}}for(G in f)f.hasOwnProperty(G)&&(g=f[G],g!=null&&qt(o,l,G,g,f,null))}function gz(o,l,f,g){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,S=null,M=null,G=null,Q=null,fe=null,be=null;for(ge in f){var _e=f[ge];if(f.hasOwnProperty(ge)&&_e!=null)switch(ge){case"checked":break;case"value":break;case"defaultValue":Q=_e;default:g.hasOwnProperty(ge)||qt(o,l,ge,null,g,_e)}}for(var he in g){var ge=g[he];if(_e=f[he],g.hasOwnProperty(he)&&(ge!=null||_e!=null))switch(he){case"type":S=ge;break;case"name":x=ge;break;case"checked":fe=ge;break;case"defaultChecked":be=ge;break;case"value":M=ge;break;case"defaultValue":G=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(r(137,l));break;default:ge!==_e&&qt(o,l,he,ge,g,_e)}}qc(o,M,G,Q,fe,be,S,x);return;case"select":ge=M=G=he=null;for(S in f)if(Q=f[S],f.hasOwnProperty(S)&&Q!=null)switch(S){case"value":break;case"multiple":ge=Q;default:g.hasOwnProperty(S)||qt(o,l,S,null,g,Q)}for(x in g)if(S=g[x],Q=f[x],g.hasOwnProperty(x)&&(S!=null||Q!=null))switch(x){case"value":he=S;break;case"defaultValue":G=S;break;case"multiple":M=S;default:S!==Q&&qt(o,l,x,S,g,Q)}l=G,f=M,g=ge,he!=null?Xs(o,!!f,he,!1):!!g!=!!f&&(l!=null?Xs(o,!!f,l,!0):Xs(o,!!f,f?[]:"",!1));return;case"textarea":ge=he=null;for(G in f)if(x=f[G],f.hasOwnProperty(G)&&x!=null&&!g.hasOwnProperty(G))switch(G){case"value":break;case"children":break;default:qt(o,l,G,null,g,x)}for(M in g)if(x=g[M],S=f[M],g.hasOwnProperty(M)&&(x!=null||S!=null))switch(M){case"value":he=x;break;case"defaultValue":ge=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==S&&qt(o,l,M,x,g,S)}mg(o,he,ge);return;case"option":for(var ze in f)if(he=f[ze],f.hasOwnProperty(ze)&&he!=null&&!g.hasOwnProperty(ze))switch(ze){case"selected":o.selected=!1;break;default:qt(o,l,ze,null,g,he)}for(Q in g)if(he=g[Q],ge=f[Q],g.hasOwnProperty(Q)&&he!==ge&&(he!=null||ge!=null))switch(Q){case"selected":o.selected=he&&typeof he!="function"&&typeof he!="symbol";break;default:qt(o,l,Q,he,g,ge)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ze in f)he=f[Ze],f.hasOwnProperty(Ze)&&he!=null&&!g.hasOwnProperty(Ze)&&qt(o,l,Ze,null,g,he);for(fe in g)if(he=g[fe],ge=f[fe],g.hasOwnProperty(fe)&&he!==ge&&(he!=null||ge!=null))switch(fe){case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(r(137,l));break;default:qt(o,l,fe,he,g,ge)}return;default:if($c(l)){for(var $t in f)he=f[$t],f.hasOwnProperty($t)&&he!==void 0&&!g.hasOwnProperty($t)&&fx(o,l,$t,void 0,g,he);for(be in g)he=g[be],ge=f[be],!g.hasOwnProperty(be)||he===ge||he===void 0&&ge===void 0||fx(o,l,be,he,g,ge);return}}for(var se in f)he=f[se],f.hasOwnProperty(se)&&he!=null&&!g.hasOwnProperty(se)&&qt(o,l,se,null,g,he);for(_e in g)he=g[_e],ge=f[_e],!g.hasOwnProperty(_e)||he===ge||he==null&&ge==null||qt(o,l,_e,he,g,ge)}function nI(o){switch(o){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function mz(){if(typeof performance.getEntriesByType=="function"){for(var o=0,l=0,f=performance.getEntriesByType("resource"),g=0;g<f.length;g++){var x=f[g],S=x.transferSize,M=x.initiatorType,G=x.duration;if(S&&G&&nI(M)){for(M=0,G=x.responseEnd,g+=1;g<f.length;g++){var Q=f[g],fe=Q.startTime;if(fe>G)break;var be=Q.transferSize,_e=Q.initiatorType;be&&nI(_e)&&(Q=Q.responseEnd,M+=be*(Q<G?1:(G-fe)/(Q-fe)))}if(--g,l+=8*(S+M)/(x.duration/1e3),o++,10<o)break}}if(0<o)return l/o/1e6}return navigator.connection&&(o=navigator.connection.downlink,typeof o=="number")?o:5}var hx=null,px=null;function bm(o){return o.nodeType===9?o:o.ownerDocument}function rI(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function iI(o,l){if(o===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&l==="foreignObject"?0:o}function gx(o,l){return o==="textarea"||o==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var mx=null;function vz(){var o=window.event;return o&&o.type==="popstate"?o===mx?!1:(mx=o,!0):(mx=null,!1)}var aI=typeof setTimeout=="function"?setTimeout:void 0,yz=typeof clearTimeout=="function"?clearTimeout:void 0,sI=typeof Promise=="function"?Promise:void 0,bz=typeof queueMicrotask=="function"?queueMicrotask:typeof sI<"u"?function(o){return sI.resolve(null).then(o).catch(xz)}:aI;function xz(o){setTimeout(function(){throw o})}function xo(o){return o==="head"}function oI(o,l){var f=l,g=0;do{var x=f.nextSibling;if(o.removeChild(f),x&&x.nodeType===8)if(f=x.data,f==="/$"||f==="/&"){if(g===0){o.removeChild(x),Au(l);return}g--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")g++;else if(f==="html")Hf(o.ownerDocument.documentElement);else if(f==="head"){f=o.ownerDocument.head,Hf(f);for(var S=f.firstChild;S;){var M=S.nextSibling,G=S.nodeName;S[ga]||G==="SCRIPT"||G==="STYLE"||G==="LINK"&&S.rel.toLowerCase()==="stylesheet"||f.removeChild(S),S=M}}else f==="body"&&Hf(o.ownerDocument.body);f=x}while(f);Au(l)}function lI(o,l){var f=o;o=0;do{var g=f.nextSibling;if(f.nodeType===1?l?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(l?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),g&&g.nodeType===8)if(f=g.data,f==="/$"){if(o===0)break;o--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||o++;f=g}while(f)}function vx(o){var l=o.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var f=l;switch(l=l.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":vx(f),Fc(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}o.removeChild(f)}}function _z(o,l,f,g){for(;o.nodeType===1;){var x=f;if(o.nodeName.toLowerCase()!==l.toLowerCase()){if(!g&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(g){if(!o[ga])switch(l){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(S=o.getAttribute("rel"),S==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(S!==x.rel||o.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||o.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||o.getAttribute("title")!==(x.title==null?null:x.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(S=o.getAttribute("src"),(S!==(x.src==null?null:x.src)||o.getAttribute("type")!==(x.type==null?null:x.type)||o.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&S&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(l==="input"&&o.type==="hidden"){var S=x.name==null?null:""+x.name;if(x.type==="hidden"&&o.getAttribute("name")===S)return o}else return o;if(o=Si(o.nextSibling),o===null)break}return null}function wz(o,l,f){if(l==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!f||(o=Si(o.nextSibling),o===null))return null;return o}function cI(o,l){for(;o.nodeType!==8;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!l||(o=Si(o.nextSibling),o===null))return null;return o}function yx(o){return o.data==="$?"||o.data==="$~"}function bx(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState!=="loading"}function Sz(o,l){var f=o.ownerDocument;if(o.data==="$~")o._reactRetry=l;else if(o.data!=="$?"||f.readyState!=="loading")l();else{var g=function(){l(),f.removeEventListener("DOMContentLoaded",g)};f.addEventListener("DOMContentLoaded",g),o._reactRetry=g}}function Si(o){for(;o!=null;o=o.nextSibling){var l=o.nodeType;if(l===1||l===3)break;if(l===8){if(l=o.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return o}var xx=null;function uI(o){o=o.nextSibling;for(var l=0;o;){if(o.nodeType===8){var f=o.data;if(f==="/$"||f==="/&"){if(l===0)return Si(o.nextSibling);l--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||l++}o=o.nextSibling}return null}function dI(o){o=o.previousSibling;for(var l=0;o;){if(o.nodeType===8){var f=o.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(l===0)return o;l--}else f!=="/$"&&f!=="/&"||l++}o=o.previousSibling}return null}function fI(o,l,f){switch(l=bm(f),o){case"html":if(o=l.documentElement,!o)throw Error(r(452));return o;case"head":if(o=l.head,!o)throw Error(r(453));return o;case"body":if(o=l.body,!o)throw Error(r(454));return o;default:throw Error(r(451))}}function Hf(o){for(var l=o.attributes;l.length;)o.removeAttributeNode(l[0]);Fc(o)}var Ei=new Map,hI=new Set;function xm(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var bs=W.d;W.d={f:Ez,r:Tz,D:Az,C:Cz,L:Iz,m:Rz,X:Dz,S:kz,M:Nz};function Ez(){var o=bs.f(),l=dm();return o||l}function Tz(o){var l=hi(o);l!==null&&l.tag===5&&l.type==="form"?kA(l):bs.r(o)}var Su=typeof document>"u"?null:document;function pI(o,l,f){var g=Su;if(g&&typeof l=="string"&&l){var x=Dr(l);x='link[rel="'+o+'"][href="'+x+'"]',typeof f=="string"&&(x+='[crossorigin="'+f+'"]'),hI.has(x)||(hI.add(x),o={rel:o,crossOrigin:f,href:l},g.querySelector(x)===null&&(l=g.createElement("link"),sr(l,"link",o),Nn(l),g.head.appendChild(l)))}}function Az(o){bs.D(o),pI("dns-prefetch",o,null)}function Cz(o,l){bs.C(o,l),pI("preconnect",o,l)}function Iz(o,l,f){bs.L(o,l,f);var g=Su;if(g&&o&&l){var x='link[rel="preload"][as="'+Dr(l)+'"]';l==="image"&&f&&f.imageSrcSet?(x+='[imagesrcset="'+Dr(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(x+='[imagesizes="'+Dr(f.imageSizes)+'"]')):x+='[href="'+Dr(o)+'"]';var S=x;switch(l){case"style":S=Eu(o);break;case"script":S=Tu(o)}Ei.has(S)||(o=p({rel:"preload",href:l==="image"&&f&&f.imageSrcSet?void 0:o,as:l},f),Ei.set(S,o),g.querySelector(x)!==null||l==="style"&&g.querySelector(Yf(S))||l==="script"&&g.querySelector(Kf(S))||(l=g.createElement("link"),sr(l,"link",o),Nn(l),g.head.appendChild(l)))}}function Rz(o,l){bs.m(o,l);var f=Su;if(f&&o){var g=l&&typeof l.as=="string"?l.as:"script",x='link[rel="modulepreload"][as="'+Dr(g)+'"][href="'+Dr(o)+'"]',S=x;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=Tu(o)}if(!Ei.has(S)&&(o=p({rel:"modulepreload",href:o},l),Ei.set(S,o),f.querySelector(x)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Kf(S)))return}g=f.createElement("link"),sr(g,"link",o),Nn(g),f.head.appendChild(g)}}}function kz(o,l,f){bs.S(o,l,f);var g=Su;if(g&&o){var x=va(g).hoistableStyles,S=Eu(o);l=l||"default";var M=x.get(S);if(!M){var G={loading:0,preload:null};if(M=g.querySelector(Yf(S)))G.loading=5;else{o=p({rel:"stylesheet",href:o,"data-precedence":l},f),(f=Ei.get(S))&&_x(o,f);var Q=M=g.createElement("link");Nn(Q),sr(Q,"link",o),Q._p=new Promise(function(fe,be){Q.onload=fe,Q.onerror=be}),Q.addEventListener("load",function(){G.loading|=1}),Q.addEventListener("error",function(){G.loading|=2}),G.loading|=4,_m(M,l,g)}M={type:"stylesheet",instance:M,count:1,state:G},x.set(S,M)}}}function Dz(o,l){bs.X(o,l);var f=Su;if(f&&o){var g=va(f).hoistableScripts,x=Tu(o),S=g.get(x);S||(S=f.querySelector(Kf(x)),S||(o=p({src:o,async:!0},l),(l=Ei.get(x))&&wx(o,l),S=f.createElement("script"),Nn(S),sr(S,"link",o),f.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},g.set(x,S))}}function Nz(o,l){bs.M(o,l);var f=Su;if(f&&o){var g=va(f).hoistableScripts,x=Tu(o),S=g.get(x);S||(S=f.querySelector(Kf(x)),S||(o=p({src:o,async:!0,type:"module"},l),(l=Ei.get(x))&&wx(o,l),S=f.createElement("script"),Nn(S),sr(S,"link",o),f.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},g.set(x,S))}}function gI(o,l,f,g){var x=(x=ue.current)?xm(x):null;if(!x)throw Error(r(446));switch(o){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(l=Eu(f.href),f=va(x).hoistableStyles,g=f.get(l),g||(g={type:"style",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){o=Eu(f.href);var S=va(x).hoistableStyles,M=S.get(o);if(M||(x=x.ownerDocument||x,M={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(o,M),(S=x.querySelector(Yf(o)))&&!S._p&&(M.instance=S,M.state.loading=5),Ei.has(o)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},Ei.set(o,f),S||Mz(x,o,f,M.state))),l&&g===null)throw Error(r(528,""));return M}if(l&&g!==null)throw Error(r(529,""));return null;case"script":return l=f.async,f=f.src,typeof f=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Tu(f),f=va(x).hoistableScripts,g=f.get(l),g||(g={type:"script",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,o))}}function Eu(o){return'href="'+Dr(o)+'"'}function Yf(o){return'link[rel="stylesheet"]['+o+"]"}function mI(o){return p({},o,{"data-precedence":o.precedence,precedence:null})}function Mz(o,l,f,g){o.querySelector('link[rel="preload"][as="style"]['+l+"]")?g.loading=1:(l=o.createElement("link"),g.preload=l,l.addEventListener("load",function(){return g.loading|=1}),l.addEventListener("error",function(){return g.loading|=2}),sr(l,"link",f),Nn(l),o.head.appendChild(l))}function Tu(o){return'[src="'+Dr(o)+'"]'}function Kf(o){return"script[async]"+o}function vI(o,l,f){if(l.count++,l.instance===null)switch(l.type){case"style":var g=o.querySelector('style[data-href~="'+Dr(f.href)+'"]');if(g)return l.instance=g,Nn(g),g;var x=p({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return g=(o.ownerDocument||o).createElement("style"),Nn(g),sr(g,"style",x),_m(g,f.precedence,o),l.instance=g;case"stylesheet":x=Eu(f.href);var S=o.querySelector(Yf(x));if(S)return l.state.loading|=4,l.instance=S,Nn(S),S;g=mI(f),(x=Ei.get(x))&&_x(g,x),S=(o.ownerDocument||o).createElement("link"),Nn(S);var M=S;return M._p=new Promise(function(G,Q){M.onload=G,M.onerror=Q}),sr(S,"link",g),l.state.loading|=4,_m(S,f.precedence,o),l.instance=S;case"script":return S=Tu(f.src),(x=o.querySelector(Kf(S)))?(l.instance=x,Nn(x),x):(g=f,(x=Ei.get(S))&&(g=p({},f),wx(g,x)),o=o.ownerDocument||o,x=o.createElement("script"),Nn(x),sr(x,"link",g),o.head.appendChild(x),l.instance=x);case"void":return null;default:throw Error(r(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(g=l.instance,l.state.loading|=4,_m(g,f.precedence,o));return l.instance}function _m(o,l,f){for(var g=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=g.length?g[g.length-1]:null,S=x,M=0;M<g.length;M++){var G=g[M];if(G.dataset.precedence===l)S=G;else if(S!==x)break}S?S.parentNode.insertBefore(o,S.nextSibling):(l=f.nodeType===9?f.head:f,l.insertBefore(o,l.firstChild))}function _x(o,l){o.crossOrigin==null&&(o.crossOrigin=l.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=l.referrerPolicy),o.title==null&&(o.title=l.title)}function wx(o,l){o.crossOrigin==null&&(o.crossOrigin=l.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=l.referrerPolicy),o.integrity==null&&(o.integrity=l.integrity)}var wm=null;function yI(o,l,f){if(wm===null){var g=new Map,x=wm=new Map;x.set(f,g)}else x=wm,g=x.get(f),g||(g=new Map,x.set(f,g));if(g.has(o))return g;for(g.set(o,null),f=f.getElementsByTagName(o),x=0;x<f.length;x++){var S=f[x];if(!(S[ga]||S[Dn]||o==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var M=S.getAttribute(l)||"";M=o+M;var G=g.get(M);G?G.push(S):g.set(M,[S])}}return g}function bI(o,l,f){o=o.ownerDocument||o,o.head.insertBefore(f,l==="title"?o.querySelector("head > title"):null)}function Pz(o,l,f){if(f===1||l.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return o=l.disabled,typeof l.precedence=="string"&&o==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function xI(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}function Oz(o,l,f,g){if(f.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var x=Eu(g.href),S=l.querySelector(Yf(x));if(S){l=S._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(o.count++,o=Sm.bind(o),l.then(o,o)),f.state.loading|=4,f.instance=S,Nn(S);return}S=l.ownerDocument||l,g=mI(g),(x=Ei.get(x))&&_x(g,x),S=S.createElement("link"),Nn(S);var M=S;M._p=new Promise(function(G,Q){M.onload=G,M.onerror=Q}),sr(S,"link",g),f.instance=S}o.stylesheets===null&&(o.stylesheets=new Map),o.stylesheets.set(f,l),(l=f.state.preload)&&(f.state.loading&3)===0&&(o.count++,f=Sm.bind(o),l.addEventListener("load",f),l.addEventListener("error",f))}}var Sx=0;function jz(o,l){return o.stylesheets&&o.count===0&&Tm(o,o.stylesheets),0<o.count||0<o.imgCount?function(f){var g=setTimeout(function(){if(o.stylesheets&&Tm(o,o.stylesheets),o.unsuspend){var S=o.unsuspend;o.unsuspend=null,S()}},6e4+l);0<o.imgBytes&&Sx===0&&(Sx=62500*mz());var x=setTimeout(function(){if(o.waitingForImages=!1,o.count===0&&(o.stylesheets&&Tm(o,o.stylesheets),o.unsuspend)){var S=o.unsuspend;o.unsuspend=null,S()}},(o.imgBytes>Sx?50:800)+l);return o.unsuspend=f,function(){o.unsuspend=null,clearTimeout(g),clearTimeout(x)}}:null}function Sm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Tm(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var Em=null;function Tm(o,l){o.stylesheets=null,o.unsuspend!==null&&(o.count++,Em=new Map,l.forEach(Vz,o),Em=null,Sm.call(o))}function Vz(o,l){if(!(l.state.loading&4)){var f=Em.get(o);if(f)var g=f.get(null);else{f=new Map,Em.set(o,f);for(var x=o.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<x.length;S++){var M=x[S];(M.nodeName==="LINK"||M.getAttribute("media")!=="not all")&&(f.set(M.dataset.precedence,M),g=M)}g&&f.set(null,g)}x=l.instance,M=x.getAttribute("data-precedence"),S=f.get(M)||g,S===g&&f.set(null,x),f.set(M,x),this.count++,g=Sm.bind(this),x.addEventListener("load",g),x.addEventListener("error",g),S?S.parentNode.insertBefore(x,S.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(x,o.firstChild)),l.state.loading|=4}}var Xf={$$typeof:k,Provider:null,Consumer:null,_currentValue:ee,_currentValue2:ee,_threadCount:0};function zz(o,l,f,g,x,S,M,G,Q){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ha(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ha(0),this.hiddenUpdates=ha(null),this.identifierPrefix=g,this.onUncaughtError=x,this.onCaughtError=S,this.onRecoverableError=M,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Q,this.incompleteTransitions=new Map}function _I(o,l,f,g,x,S,M,G,Q,fe,be,_e){return o=new zz(o,l,f,M,Q,fe,be,_e,G),l=1,S===!0&&(l|=24),S=Jr(3,null,null,l),o.current=S,S.stateNode=o,l=nb(),l.refCount++,o.pooledCache=l,l.refCount++,S.memoizedState={element:g,isDehydrated:f,cache:l},sb(S),o}function wI(o){return o?(o=nu,o):nu}function SI(o,l,f,g,x,S){x=wI(x),g.context===null?g.context=x:g.pendingContext=x,g=lo(l),g.payload={element:f},S=S===void 0?null:S,S!==null&&(g.callback=S),f=co(o,g,l),f!==null&&(Vr(f,o,l),Cf(f,o,l))}function EI(o,l){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var f=o.retryLane;o.retryLane=f!==0&&f<l?f:l}}function Ex(o,l){EI(o,l),(o=o.alternate)&&EI(o,l)}function TI(o){if(o.tag===13||o.tag===31){var l=Ml(o,67108864);l!==null&&Vr(l,o,67108864),Ex(o,67108864)}}function AI(o){if(o.tag===13||o.tag===31){var l=ii();l=_l(l);var f=Ml(o,l);f!==null&&Vr(f,o,l),Ex(o,l)}}var Am=!0;function Lz(o,l,f,g){var x=$.T;$.T=null;var S=W.p;try{W.p=2,Tx(o,l,f,g)}finally{W.p=S,$.T=x}}function Bz(o,l,f,g){var x=$.T;$.T=null;var S=W.p;try{W.p=8,Tx(o,l,f,g)}finally{W.p=S,$.T=x}}function Tx(o,l,f,g){if(Am){var x=Ax(g);if(x===null)dx(o,l,g,Cm,f),II(o,g);else if(Fz(x,o,l,f,g))g.stopPropagation();else if(II(o,g),l&4&&-1<Uz.indexOf(o)){for(;x!==null;){var S=hi(x);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var M=Xr(S.pendingLanes);if(M!==0){var G=S;for(G.pendingLanes|=2,G.entangledLanes|=2;M;){var Q=1<<31-on(M);G.entanglements[1]|=Q,M&=~Q}ka(S),(Mt&6)===0&&(cm=ft()+500,Gf(0))}}break;case 31:case 13:G=Ml(S,2),G!==null&&Vr(G,S,2),dm(),Ex(S,2)}if(S=Ax(g),S===null&&dx(o,l,g,Cm,f),S===x)break;x=S}x!==null&&g.stopPropagation()}else dx(o,l,g,null,f)}}function Ax(o){return o=pi(o),Cx(o)}var Cm=null;function Cx(o){if(Cm=null,o=ma(o),o!==null){var l=a(o);if(l===null)o=null;else{var f=l.tag;if(f===13){if(o=s(l),o!==null)return o;o=null}else if(f===31){if(o=c(l),o!==null)return o;o=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;o=null}else l!==o&&(o=null)}}return Cm=o,null}function CI(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Dt()){case pn:return 2;case Ot:return 8;case Rn:case Yr:return 32;case fa:return 268435456;default:return 32}default:return 32}}var Ix=!1,_o=null,wo=null,So=null,Wf=new Map,Qf=new Map,Eo=[],Uz="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function II(o,l){switch(o){case"focusin":case"focusout":_o=null;break;case"dragenter":case"dragleave":wo=null;break;case"mouseover":case"mouseout":So=null;break;case"pointerover":case"pointerout":Wf.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qf.delete(l.pointerId)}}function Zf(o,l,f,g,x,S){return o===null||o.nativeEvent!==S?(o={blockedOn:l,domEventName:f,eventSystemFlags:g,nativeEvent:S,targetContainers:[x]},l!==null&&(l=hi(l),l!==null&&TI(l)),o):(o.eventSystemFlags|=g,l=o.targetContainers,x!==null&&l.indexOf(x)===-1&&l.push(x),o)}function Fz(o,l,f,g,x){switch(l){case"focusin":return _o=Zf(_o,o,l,f,g,x),!0;case"dragenter":return wo=Zf(wo,o,l,f,g,x),!0;case"mouseover":return So=Zf(So,o,l,f,g,x),!0;case"pointerover":var S=x.pointerId;return Wf.set(S,Zf(Wf.get(S)||null,o,l,f,g,x)),!0;case"gotpointercapture":return S=x.pointerId,Qf.set(S,Zf(Qf.get(S)||null,o,l,f,g,x)),!0}return!1}function RI(o){var l=ma(o.target);if(l!==null){var f=a(l);if(f!==null){if(l=f.tag,l===13){if(l=s(f),l!==null){o.blockedOn=l,Ui(o.priority,function(){AI(f)});return}}else if(l===31){if(l=c(f),l!==null){o.blockedOn=l,Ui(o.priority,function(){AI(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){o.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Im(o){if(o.blockedOn!==null)return!1;for(var l=o.targetContainers;0<l.length;){var f=Ax(o.nativeEvent);if(f===null){f=o.nativeEvent;var g=new f.constructor(f.type,f);df=g,f.target.dispatchEvent(g),df=null}else return l=hi(f),l!==null&&TI(l),o.blockedOn=f,!1;l.shift()}return!0}function kI(o,l,f){Im(o)&&f.delete(l)}function Gz(){Ix=!1,_o!==null&&Im(_o)&&(_o=null),wo!==null&&Im(wo)&&(wo=null),So!==null&&Im(So)&&(So=null),Wf.forEach(kI),Qf.forEach(kI)}function Rm(o,l){o.blockedOn===l&&(o.blockedOn=null,Ix||(Ix=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Gz)))}var km=null;function DI(o){km!==o&&(km=o,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){km===o&&(km=null);for(var l=0;l<o.length;l+=3){var f=o[l],g=o[l+1],x=o[l+2];if(typeof g!="function"){if(Cx(g||f)===null)continue;break}var S=hi(f);S!==null&&(o.splice(l,3),l-=3,Ab(S,{pending:!0,data:x,method:f.method,action:g},g,x))}}))}function Au(o){function l(Q){return Rm(Q,o)}_o!==null&&Rm(_o,o),wo!==null&&Rm(wo,o),So!==null&&Rm(So,o),Wf.forEach(l),Qf.forEach(l);for(var f=0;f<Eo.length;f++){var g=Eo[f];g.blockedOn===o&&(g.blockedOn=null)}for(;0<Eo.length&&(f=Eo[0],f.blockedOn===null);)RI(f),f.blockedOn===null&&Eo.shift();if(f=(o.ownerDocument||o).$$reactFormReplay,f!=null)for(g=0;g<f.length;g+=3){var x=f[g],S=f[g+1],M=x[Zn]||null;if(typeof S=="function")M||DI(f);else if(M){var G=null;if(S&&S.hasAttribute("formAction")){if(x=S,M=S[Zn]||null)G=M.formAction;else if(Cx(x)!==null)continue}else G=M.action;typeof G=="function"?f[g+1]=G:(f.splice(g,3),g-=3),DI(f)}}}function NI(){function o(S){S.canIntercept&&S.info==="react-transition"&&S.intercept({handler:function(){return new Promise(function(M){return x=M})},focusReset:"manual",scroll:"manual"})}function l(){x!==null&&(x(),x=null),g||setTimeout(f,20)}function f(){if(!g&&!navigation.transition){var S=navigation.currentEntry;S&&S.url!=null&&navigation.navigate(S.url,{state:S.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,x=null;return navigation.addEventListener("navigate",o),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(f,100),function(){g=!0,navigation.removeEventListener("navigate",o),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),x!==null&&(x(),x=null)}}}function Rx(o){this._internalRoot=o}Dm.prototype.render=Rx.prototype.render=function(o){var l=this._internalRoot;if(l===null)throw Error(r(409));var f=l.current,g=ii();SI(f,g,o,l,null,null)},Dm.prototype.unmount=Rx.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var l=o.containerInfo;SI(o.current,2,null,o,null,null),dm(),l[pa]=null}};function Dm(o){this._internalRoot=o}Dm.prototype.unstable_scheduleHydration=function(o){if(o){var l=dg();o={blockedOn:null,target:o,priority:l};for(var f=0;f<Eo.length&&l!==0&&l<Eo[f].priority;f++);Eo.splice(f,0,o),f===0&&RI(o)}};var MI=e.version;if(MI!=="19.2.0")throw Error(r(527,MI,"19.2.0"));W.findDOMNode=function(o){var l=o._reactInternals;if(l===void 0)throw typeof o.render=="function"?Error(r(188)):(o=Object.keys(o).join(","),Error(r(268,o)));return o=d(l),o=o!==null?h(o):null,o=o===null?null:o.stateNode,o};var qz={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nm.isDisabled&&Nm.supportsFiber)try{Kr=Nm.inject(qz),kn=Nm}catch{}}return eh.createRoot=function(o,l){if(!i(o))throw Error(r(299));var f=!1,g="",x=BA,S=UA,M=FA;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(S=l.onCaughtError),l.onRecoverableError!==void 0&&(M=l.onRecoverableError)),l=_I(o,1,!1,null,null,f,g,null,x,S,M,NI),o[pa]=l.current,ux(o),new Rx(l)},eh.hydrateRoot=function(o,l,f){if(!i(o))throw Error(r(299));var g=!1,x="",S=BA,M=UA,G=FA,Q=null;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onUncaughtError!==void 0&&(S=f.onUncaughtError),f.onCaughtError!==void 0&&(M=f.onCaughtError),f.onRecoverableError!==void 0&&(G=f.onRecoverableError),f.formState!==void 0&&(Q=f.formState)),l=_I(o,1,!0,l,f??null,g,x,Q,S,M,G,NI),l.context=wI(null),f=l.current,g=ii(),g=_l(g),x=lo(g),x.callback=null,co(f,x,g),f=g,l.current.lanes=f,bl(l,f),ka(l),o[pa]=l.current,ux(o),new Dm(l)},eh.version="19.2.0",eh}var GI;function t6(){if(GI)return Nx.exports;GI=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Nx.exports=e6(),Nx.exports}var n6=t6();const r6="modulepreload",i6=function(n){return"/personal-budget-pwa/"+n},qI={},Ct=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let u=function(d){return Promise.all(d.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),c=s?.nonce||s?.getAttribute("nonce");i=u(t.map(d=>{if(d=i6(d),d in qI)return;qI[d]=!0;const h=d.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${p}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":r6,h||(m.as="script"),m.crossOrigin="",m.href=d,c&&m.setAttribute("nonce",c),document.head.appendChild(m),h)return new Promise((b,_)=>{m.addEventListener("load",b),m.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(s){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=s,window.dispatchEvent(c),!c.defaultPrevented)throw s}return i.then(s=>{for(const c of s||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};function a6(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:r,onRegistered:i,onRegisteredSW:a,onRegisterError:s}=n;let c,u;const d=async(p=!0)=>{await u};async function h(){if("serviceWorker"in navigator){if(c=await Ct(async()=>{const{Workbox:p}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/personal-budget-pwa/sw.js",{scope:"/personal-budget-pwa/",type:"classic"})).catch(p=>{s?.(p)}),!c)return;c.addEventListener("activated",p=>{(p.isUpdate||p.isExternal)&&window.location.reload()}),c.addEventListener("installed",p=>{p.isUpdate||r?.()}),c.register({immediate:e}).then(p=>{a?a("/personal-budget-pwa/sw.js",p):i?.(p)}).catch(p=>{s?.(p)})}}return u=h(),d}const s6=()=>{};var $I={};const TN=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},o6=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=n[t++];e[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=n[t++],s=n[t++],c=n[t++],u=((i&7)<<18|(a&63)<<12|(s&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const a=n[t++],s=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|s&63)}}return e.join("")},AN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const a=n[i],s=i+1<n.length,c=s?n[i+1]:0,u=i+2<n.length,d=u?n[i+2]:0,h=a>>2,p=(a&3)<<4|c>>4;let m=(c&15)<<2|d>>6,b=d&63;u||(b=64,s||(m=64)),r.push(t[h],t[p],t[m],t[b])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(TN(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):o6(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const a=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;const d=i<n.length?t[n.charAt(i)]:64;++i;const p=i<n.length?t[n.charAt(i)]:64;if(++i,a==null||c==null||d==null||p==null)throw new l6;const m=a<<2|c>>4;if(r.push(m),d!==64){const b=c<<4&240|d>>2;if(r.push(b),p!==64){const _=d<<6&192|p;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class l6 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const c6=function(n){const e=TN(n);return AN.encodeByteArray(e,!0)},CN=function(n){return c6(n).replace(/\./g,"")},IN=function(n){try{return AN.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function RN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const u6=()=>RN().__FIREBASE_DEFAULTS__,d6=()=>{if(typeof process>"u"||typeof $I>"u")return;const n=$I.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},f6=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&IN(n[1]);return e&&JSON.parse(e)},Pv=()=>{try{return s6()||u6()||d6()||f6()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},h6=n=>Pv()?.emulatorHosts?.[n],kN=()=>Pv()?.config,DN=n=>Pv()?.[`_${n}`];class p6{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Pd(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function NN(n){return(await fetch(n,{credentials:"include"})).ok}const wh={};function g6(){const n={prod:[],emulator:[]};for(const e of Object.keys(wh))wh[e]?n.emulator.push(e):n.prod.push(e);return n}function m6(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let HI=!1;function v6(n,e){if(typeof window>"u"||typeof document>"u"||!Pd(window.location.host)||wh[n]===e||wh[n]||HI)return;wh[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",a=g6().prod.length>0;function s(){const m=document.getElementById(r);m&&m.remove()}function c(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,b){m.setAttribute("width","24"),m.setAttribute("id",b),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{HI=!0,s()},m}function h(m,b){m.setAttribute("id",b),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=m6(r),b=t("text"),_=document.getElementById(b)||document.createElement("span"),w=t("learnmore"),E=document.getElementById(w)||document.createElement("a"),T=t("preprendIcon"),C=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const k=m.element;c(k),h(E,w);const j=d();u(C,T),k.append(C,_,E,j),document.body.appendChild(k)}a?(_.innerText="Preview backend disconnected.",C.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(C.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function Wn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function y6(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Wn())}function MN(){const n=Pv()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function b6(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function x6(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function _6(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function w6(){const n=Wn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function PN(){return!MN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ON(){return!MN()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function jN(){try{return typeof indexedDB=="object"}catch{return!1}}function S6(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const E6="FirebaseError";class Us extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=E6,Object.setPrototypeOf(this,Us.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Tp.prototype.create)}}class Tp{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,a=this.errors[e],s=a?T6(a,r):"Error",c=`${this.serviceName}: ${s} (${i}).`;return new Us(i,c,r)}}function T6(n,e){return n.replace(A6,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const A6=/\{\$([^}]+)}/g;function C6(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Zo(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const a=n[i],s=e[i];if(YI(a)&&YI(s)){if(!Zo(a,s))return!1}else if(a!==s)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function YI(n){return n!==null&&typeof n=="object"}function Ap(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function uh(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,a]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function dh(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function I6(n,e){const t=new R6(n,e);return t.subscribe.bind(t)}class R6{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");k6(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=jx),i.error===void 0&&(i.error=jx),i.complete===void 0&&(i.complete=jx);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function k6(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function jx(){}function Wt(n){return n&&n._delegate?n._delegate:n}let bc=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};const Kl="[DEFAULT]";let D6=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new p6;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(M6(e))try{this.getOrInitializeService({instanceIdentifier:Kl})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:i});r.resolve(a)}catch{}}}}clearInstance(e=Kl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Kl){return this.instances.has(e)}getOptions(e=Kl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,s]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);r===c&&s.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const a=this.instances.get(r);return a&&e(a,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:N6(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Kl){return this.component?this.component.multipleInstances?e:Kl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function N6(n){return n===Kl?void 0:n}function M6(n){return n.instantiationMode==="EAGER"}class P6{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new D6(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var wt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(wt||(wt={}));const O6={debug:wt.DEBUG,verbose:wt.VERBOSE,info:wt.INFO,warn:wt.WARN,error:wt.ERROR,silent:wt.SILENT},j6=wt.INFO,V6={[wt.DEBUG]:"log",[wt.VERBOSE]:"log",[wt.INFO]:"info",[wt.WARN]:"warn",[wt.ERROR]:"error"},z6=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=V6[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Cw{constructor(e){this.name=e,this._logLevel=j6,this._logHandler=z6,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in wt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?O6[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,wt.DEBUG,...e),this._logHandler(this,wt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,wt.VERBOSE,...e),this._logHandler(this,wt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,wt.INFO,...e),this._logHandler(this,wt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,wt.WARN,...e),this._logHandler(this,wt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,wt.ERROR,...e),this._logHandler(this,wt.ERROR,...e)}}const L6=(n,e)=>e.some(t=>n instanceof t);let KI,XI;function B6(){return KI||(KI=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function U6(){return XI||(XI=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const VN=new WeakMap,B1=new WeakMap,zN=new WeakMap,Vx=new WeakMap,Iw=new WeakMap;function F6(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",a),n.removeEventListener("error",s)},a=()=>{t($o(n.result)),i()},s=()=>{r(n.error),i()};n.addEventListener("success",a),n.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&VN.set(t,n)}).catch(()=>{}),Iw.set(e,n),e}function G6(n){if(B1.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",s),n.removeEventListener("abort",s)},a=()=>{t(),i()},s=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",a),n.addEventListener("error",s),n.addEventListener("abort",s)});B1.set(n,e)}let U1={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return B1.get(n);if(e==="objectStoreNames")return n.objectStoreNames||zN.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return $o(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function q6(n){U1=n(U1)}function $6(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(zx(this),e,...t);return zN.set(r,e.sort?e.sort():[e]),$o(r)}:U6().includes(n)?function(...e){return n.apply(zx(this),e),$o(VN.get(this))}:function(...e){return $o(n.apply(zx(this),e))}}function H6(n){return typeof n=="function"?$6(n):(n instanceof IDBTransaction&&G6(n),L6(n,B6())?new Proxy(n,U1):n)}function $o(n){if(n instanceof IDBRequest)return F6(n);if(Vx.has(n))return Vx.get(n);const e=H6(n);return e!==n&&(Vx.set(n,e),Iw.set(e,n)),e}const zx=n=>Iw.get(n);function Y6(n,e,{blocked:t,upgrade:r,blocking:i,terminated:a}={}){const s=indexedDB.open(n,e),c=$o(s);return r&&s.addEventListener("upgradeneeded",u=>{r($o(s.result),u.oldVersion,u.newVersion,$o(s.transaction),u)}),t&&s.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{a&&u.addEventListener("close",()=>a()),i&&u.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const K6=["get","getKey","getAll","getAllKeys","count"],X6=["put","add","delete","clear"],Lx=new Map;function WI(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Lx.get(e))return Lx.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=X6.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||K6.includes(t)))return;const a=async function(s,...c){const u=this.transaction(s,i?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[t](...c),i&&u.done]))[0]};return Lx.set(e,a),a}q6(n=>({...n,get:(e,t,r)=>WI(e,t)||n.get(e,t,r),has:(e,t)=>!!WI(e,t)||n.has(e,t)}));class W6{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Q6(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function Q6(n){return n.getComponent()?.type==="VERSION"}const F1="@firebase/app",QI="0.14.6";const Ns=new Cw("@firebase/app"),Z6="@firebase/app-compat",J6="@firebase/analytics-compat",eL="@firebase/analytics",tL="@firebase/app-check-compat",nL="@firebase/app-check",rL="@firebase/auth",iL="@firebase/auth-compat",aL="@firebase/database",sL="@firebase/data-connect",oL="@firebase/database-compat",lL="@firebase/functions",cL="@firebase/functions-compat",uL="@firebase/installations",dL="@firebase/installations-compat",fL="@firebase/messaging",hL="@firebase/messaging-compat",pL="@firebase/performance",gL="@firebase/performance-compat",mL="@firebase/remote-config",vL="@firebase/remote-config-compat",yL="@firebase/storage",bL="@firebase/storage-compat",xL="@firebase/firestore",_L="@firebase/ai",wL="@firebase/firestore-compat",SL="firebase",EL="12.6.0";const G1="[DEFAULT]",TL={[F1]:"fire-core",[Z6]:"fire-core-compat",[eL]:"fire-analytics",[J6]:"fire-analytics-compat",[nL]:"fire-app-check",[tL]:"fire-app-check-compat",[rL]:"fire-auth",[iL]:"fire-auth-compat",[aL]:"fire-rtdb",[sL]:"fire-data-connect",[oL]:"fire-rtdb-compat",[lL]:"fire-fn",[cL]:"fire-fn-compat",[uL]:"fire-iid",[dL]:"fire-iid-compat",[fL]:"fire-fcm",[hL]:"fire-fcm-compat",[pL]:"fire-perf",[gL]:"fire-perf-compat",[mL]:"fire-rc",[vL]:"fire-rc-compat",[yL]:"fire-gcs",[bL]:"fire-gcs-compat",[xL]:"fire-fst",[wL]:"fire-fst-compat",[_L]:"fire-vertex","fire-js":"fire-js",[SL]:"fire-js-all"};const O0=new Map,AL=new Map,q1=new Map;function ZI(n,e){try{n.container.addComponent(e)}catch(t){Ns.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ad(n){const e=n.name;if(q1.has(e))return Ns.debug(`There were multiple attempts to register component ${e}.`),!1;q1.set(e,n);for(const t of O0.values())ZI(t,n);for(const t of AL.values())ZI(t,n);return!0}function Rw(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ki(n){return n==null?!1:n.settings!==void 0}const CL={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ho=new Tp("app","Firebase",CL);class IL{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new bc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ho.create("app-deleted",{appName:this._name})}}const Od=EL;function LN(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:G1,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Ho.create("bad-app-name",{appName:String(i)});if(t||(t=kN()),!t)throw Ho.create("no-options");const a=O0.get(i);if(a){if(Zo(t,a.options)&&Zo(r,a.config))return a;throw Ho.create("duplicate-app",{appName:i})}const s=new P6(i);for(const u of q1.values())s.addComponent(u);const c=new IL(t,r,s);return O0.set(i,c),c}function RL(n=G1){const e=O0.get(n);if(!e&&n===G1&&kN())return LN();if(!e)throw Ho.create("no-app",{appName:n});return e}function Yo(n,e,t){let r=TL[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const s=[`Unable to register library "${r}" with version "${e}":`];i&&s.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&s.push("and"),a&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ns.warn(s.join(" "));return}ad(new bc(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const kL="firebase-heartbeat-database",DL=1,qh="firebase-heartbeat-store";let Bx=null;function BN(){return Bx||(Bx=Y6(kL,DL,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(qh)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ho.create("idb-open",{originalErrorMessage:n.message})})),Bx}async function NL(n){try{const t=(await BN()).transaction(qh),r=await t.objectStore(qh).get(UN(n));return await t.done,r}catch(e){if(e instanceof Us)Ns.warn(e.message);else{const t=Ho.create("idb-get",{originalErrorMessage:e?.message});Ns.warn(t.message)}}}async function JI(n,e){try{const r=(await BN()).transaction(qh,"readwrite");await r.objectStore(qh).put(e,UN(n)),await r.done}catch(t){if(t instanceof Us)Ns.warn(t.message);else{const r=Ho.create("idb-set",{originalErrorMessage:t?.message});Ns.warn(r.message)}}}function UN(n){return`${n.name}!${n.options.appId}`}const ML=1024,PL=30;class OL{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new VL(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=e2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>PL){const i=zL(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ns.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=e2(),{heartbeatsToSend:t,unsentEntries:r}=jL(this._heartbeatsCache.heartbeats),i=CN(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Ns.warn(e),""}}}function e2(){return new Date().toISOString().substring(0,10)}function jL(n,e=ML){const t=[];let r=n.slice();for(const i of n){const a=t.find(s=>s.agent===i.agent);if(a){if(a.dates.push(i.date),t2(t)>e){a.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),t2(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class VL{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return jN()?S6().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await NL(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return JI(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return JI(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function t2(n){return CN(JSON.stringify({version:2,heartbeats:n})).length}function zL(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function LL(n){ad(new bc("platform-logger",e=>new W6(e),"PRIVATE")),ad(new bc("heartbeat",e=>new OL(e),"PRIVATE")),Yo(F1,QI,n),Yo(F1,QI,"esm2020"),Yo("fire-js","")}LL("");function FN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const BL=FN,GN=new Tp("auth","Firebase",FN());const j0=new Cw("@firebase/auth");function UL(n,...e){j0.logLevel<=wt.WARN&&j0.warn(`Auth (${Od}): ${n}`,...e)}function l0(n,...e){j0.logLevel<=wt.ERROR&&j0.error(`Auth (${Od}): ${n}`,...e)}function sa(n,...e){throw kw(n,...e)}function La(n,...e){return kw(n,...e)}function qN(n,e,t){const r={...BL(),[e]:t};return new Tp("auth","Firebase",r).create(e,{appName:n.name})}function Cs(n){return qN(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function kw(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return GN.create(n,...e)}function Qe(n,e,...t){if(!n)throw kw(e,...t)}function Ss(n){const e="INTERNAL ASSERTION FAILED: "+n;throw l0(e),new Error(e)}function Ms(n,e){n||Ss(e)}function $1(){return typeof self<"u"&&self.location?.href||""}function FL(){return n2()==="http:"||n2()==="https:"}function n2(){return typeof self<"u"&&self.location?.protocol||null}function GL(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(FL()||x6()||"connection"in navigator)?navigator.onLine:!0}function qL(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Cp{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ms(t>e,"Short delay should be less than long delay!"),this.isMobile=y6()||_6()}get(){return GL()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Dw(n,e){Ms(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class $N{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ss("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ss("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ss("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const $L={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const HL=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],YL=new Cp(3e4,6e4);function ua(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Li(n,e,t,r,i={}){return HN(n,i,async()=>{let a={},s={};r&&(e==="GET"?s=r:a={body:JSON.stringify(r)});const c=Ap({key:n.config.apiKey,...s}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const d={method:e,headers:u,...a};return b6()||(d.referrerPolicy="no-referrer"),n.emulatorConfig&&Pd(n.emulatorConfig.host)&&(d.credentials="include"),$N.fetch()(await YN(n,n.config.apiHost,t,c),d)})}async function HN(n,e,t){n._canInitEmulator=!1;const r={...$L,...e};try{const i=new XL(n),a=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const s=await a.json();if("needConfirmation"in s)throw Mm(n,"account-exists-with-different-credential",s);if(a.ok&&!("errorMessage"in s))return s;{const c=a.ok?s.errorMessage:s.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Mm(n,"credential-already-in-use",s);if(u==="EMAIL_EXISTS")throw Mm(n,"email-already-in-use",s);if(u==="USER_DISABLED")throw Mm(n,"user-disabled",s);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw qN(n,h,d);sa(n,h)}}catch(i){if(i instanceof Us)throw i;sa(n,"network-request-failed",{message:String(i)})}}async function Ip(n,e,t,r,i={}){const a=await Li(n,e,t,r,i);return"mfaPendingCredential"in a&&sa(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function YN(n,e,t,r){const i=`${e}${t}?${r}`,a=n,s=a.config.emulator?Dw(n.config,i):`${n.config.apiScheme}://${i}`;return HL.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(s).toString():s}function KL(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class XL{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(La(this.auth,"network-request-failed")),YL.get())})}}function Mm(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=La(n,e,r);return i.customData._tokenResponse=t,i}function r2(n){return n!==void 0&&n.enterprise!==void 0}class WL{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return KL(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function QL(n,e){return Li(n,"GET","/v2/recaptchaConfig",ua(n,e))}async function ZL(n,e){return Li(n,"POST","/v1/accounts:delete",e)}async function V0(n,e){return Li(n,"POST","/v1/accounts:lookup",e)}function Sh(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function JL(n,e=!1){const t=Wt(n),r=await t.getIdToken(e),i=Nw(r);Qe(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,s=a?.sign_in_provider;return{claims:i,token:r,authTime:Sh(Ux(i.auth_time)),issuedAtTime:Sh(Ux(i.iat)),expirationTime:Sh(Ux(i.exp)),signInProvider:s||null,signInSecondFactor:a?.sign_in_second_factor||null}}function Ux(n){return Number(n)*1e3}function Nw(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return l0("JWT malformed, contained fewer than 3 sections"),null;try{const i=IN(t);return i?JSON.parse(i):(l0("Failed to decode base64 JWT payload"),null)}catch(i){return l0("Caught error parsing JWT payload as JSON",i?.toString()),null}}function i2(n){const e=Nw(n);return Qe(e,"internal-error"),Qe(typeof e.exp<"u","internal-error"),Qe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function sd(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Us&&e9(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function e9({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class t9{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class H1{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Sh(this.lastLoginAt),this.creationTime=Sh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function z0(n){const e=n.auth,t=await n.getIdToken(),r=await sd(n,V0(e,{idToken:t}));Qe(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const a=i.providerUserInfo?.length?KN(i.providerUserInfo):[],s=r9(n.providerData,a),c=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!s?.length,d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new H1(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,h)}async function n9(n){const e=Wt(n);await z0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function r9(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function KN(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function i9(n,e){const t=await HN(n,{},async()=>{const r=Ap({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=n.config,s=await YN(n,i,"/v1/token",`key=${a}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:r};return n.emulatorConfig&&Pd(n.emulatorConfig.host)&&(u.credentials="include"),$N.fetch()(s,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function a9(n,e){return Li(n,"POST","/v2/accounts:revokeToken",ua(n,e))}class Zu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Qe(e.idToken,"internal-error"),Qe(typeof e.idToken<"u","internal-error"),Qe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):i2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Qe(e.length!==0,"internal-error");const t=i2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Qe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:a}=await i9(e,t);this.updateTokensAndExpiration(r,i,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:a}=t,s=new Zu;return r&&(Qe(typeof r=="string","internal-error",{appName:e}),s.refreshToken=r),i&&(Qe(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),a&&(Qe(typeof a=="number","internal-error",{appName:e}),s.expirationTime=a),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Zu,this.toJSON())}_performRefresh(){return Ss("not implemented")}}function Ao(n,e){Qe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class na{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new t9(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new H1(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await sd(this,this.stsTokenManager.getToken(this.auth,e));return Qe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return JL(this,e)}reload(){return n9(this)}_assign(e){this!==e&&(Qe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new na({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Qe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await z0(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ki(this.auth.app))return Promise.reject(Cs(this.auth));const e=await this.getIdToken();return await sd(this,ZL(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,a=t.phoneNumber??void 0,s=t.photoURL??void 0,c=t.tenantId??void 0,u=t._redirectEventId??void 0,d=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:b,providerData:_,stsTokenManager:w}=t;Qe(p&&w,e,"internal-error");const E=Zu.fromJSON(this.name,w);Qe(typeof p=="string",e,"internal-error"),Ao(r,e.name),Ao(i,e.name),Qe(typeof m=="boolean",e,"internal-error"),Qe(typeof b=="boolean",e,"internal-error"),Ao(a,e.name),Ao(s,e.name),Ao(c,e.name),Ao(u,e.name),Ao(d,e.name),Ao(h,e.name);const T=new na({uid:p,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:b,photoURL:s,phoneNumber:a,tenantId:c,stsTokenManager:E,createdAt:d,lastLoginAt:h});return _&&Array.isArray(_)&&(T.providerData=_.map(C=>({...C}))),u&&(T._redirectEventId=u),T}static async _fromIdTokenResponse(e,t,r=!1){const i=new Zu;i.updateFromServerResponse(t);const a=new na({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await z0(a),a}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Qe(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?KN(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!a?.length,c=new Zu;c.updateFromIdToken(r);const u=new na({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:s}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new H1(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(u,d),u}}const a2=new Map;function Es(n){Ms(n instanceof Function,"Expected a class definition");let e=a2.get(n);return e?(Ms(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,a2.set(n,e),e)}class XN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}XN.type="NONE";const s2=XN;function c0(n,e,t){return`firebase:${n}:${e}:${t}`}class Ju{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:a}=this.auth;this.fullUserKey=c0(this.userKey,i.apiKey,a),this.fullPersistenceKey=c0("persistence",i.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await V0(this.auth,{idToken:e}).catch(()=>{});return t?na._fromGetAccountInfoResponse(this.auth,t,e):null}return na._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Ju(Es(s2),e,r);const i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let a=i[0]||Es(s2);const s=c0(r,e.config.apiKey,e.name);let c=null;for(const d of t)try{const h=await d._get(s);if(h){let p;if(typeof h=="string"){const m=await V0(e,{idToken:h}).catch(()=>{});if(!m)break;p=await na._fromGetAccountInfoResponse(e,m,h)}else p=na._fromJSON(e,h);d!==a&&(c=p),a=d;break}}catch{}const u=i.filter(d=>d._shouldAllowMigration);return!a._shouldAllowMigration||!u.length?new Ju(a,e,r):(a=u[0],c&&await a._set(s,c.toJSON()),await Promise.all(t.map(async d=>{if(d!==a)try{await d._remove(s)}catch{}})),new Ju(a,e,r))}}function o2(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(JN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(WN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(tM(e))return"Blackberry";if(nM(e))return"Webos";if(QN(e))return"Safari";if((e.includes("chrome/")||ZN(e))&&!e.includes("edge/"))return"Chrome";if(eM(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function WN(n=Wn()){return/firefox\//i.test(n)}function QN(n=Wn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ZN(n=Wn()){return/crios\//i.test(n)}function JN(n=Wn()){return/iemobile/i.test(n)}function eM(n=Wn()){return/android/i.test(n)}function tM(n=Wn()){return/blackberry/i.test(n)}function nM(n=Wn()){return/webos/i.test(n)}function Mw(n=Wn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function s9(n=Wn()){return Mw(n)&&!!window.navigator?.standalone}function o9(){return w6()&&document.documentMode===10}function rM(n=Wn()){return Mw(n)||eM(n)||nM(n)||tM(n)||/windows phone/i.test(n)||JN(n)}function iM(n,e=[]){let t;switch(n){case"Browser":t=o2(Wn());break;case"Worker":t=`${o2(Wn())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Od}/${r}`}class l9{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((s,c)=>{try{const u=e(a);s(u)}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function c9(n,e={}){return Li(n,"GET","/v2/passwordPolicy",ua(n,e))}const u9=6;class d9{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??u9,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class f9{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new l2(this),this.idTokenSubscription=new l2(this),this.beforeStateQueue=new l9(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=GN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Es(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ju.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await V0(this,{idToken:e}),r=await na._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ki(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(s,s))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,s=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===s)&&c?.user&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Qe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await z0(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=qL()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ki(this.app))return Promise.reject(Cs(this));const t=e?Wt(e):null;return t&&Qe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Qe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ki(this.app)?Promise.reject(Cs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ki(this.app)?Promise.reject(Cs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Es(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await c9(this),t=new d9(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Tp("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await a9(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Es(e)||this._popupRedirectResolver;Qe(t,this,"argument-error"),this.redirectPersistenceManager=await Ju.create(this,[Es(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let s=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(Qe(c,this,"internal-error"),c.then(()=>{s||a(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,i);return()=>{s=!0,u()}}else{const u=e.addObserver(t);return()=>{s=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Qe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=iM(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(ki(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&UL(`Error while retrieving App Check token: ${e.error}`),e?.token}}function dl(n){return Wt(n)}class l2{constructor(e){this.auth=e,this.observer=null,this.addObserver=I6(t=>this.observer=t)}get next(){return Qe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Ov={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function h9(n){Ov=n}function aM(n){return Ov.loadJS(n)}function p9(){return Ov.recaptchaEnterpriseScript}function g9(){return Ov.gapiScript}function m9(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class v9{constructor(){this.enterprise=new y9}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class y9{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const b9="recaptcha-enterprise",sM="NO_RECAPTCHA";class x9{constructor(e){this.type=b9,this.auth=dl(e)}async verify(e="verify",t=!1){async function r(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(s,c)=>{QL(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new WL(u);return a.tenantId==null?a._agentRecaptchaConfig=d:a._tenantRecaptchaConfigs[a.tenantId]=d,s(d.siteKey)}}).catch(u=>{c(u)})})}function i(a,s,c){const u=window.grecaptcha;r2(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:e}).then(d=>{s(d)}).catch(()=>{s(sM)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new v9().execute("siteKey",{action:"verify"}):new Promise((a,s)=>{r(this.auth).then(c=>{if(!t&&r2(window.grecaptcha))i(c,a,s);else{if(typeof window>"u"){s(new Error("RecaptchaVerifier is only supported in browser"));return}let u=p9();u.length!==0&&(u+=c),aM(u).then(()=>{i(c,a,s)}).catch(d=>{s(d)})}}).catch(c=>{s(c)})})}}async function c2(n,e,t,r=!1,i=!1){const a=new x9(n);let s;if(i)s=sM;else try{s=await a.verify(t)}catch{s=await a.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:s}):Object.assign(c,{captchaResponse:s}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function L0(n,e,t,r,i){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await c2(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const s=await c2(n,e,t,t==="getOobCode");return r(n,s)}else return Promise.reject(a)})}function _9(n,e){const t=Rw(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),a=t.getOptions();if(Zo(a,e??{}))return i;sa(i,"already-initialized")}return t.initialize({options:e})}function w9(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Es);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function S9(n,e,t){const r=dl(n);Qe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,a=oM(e),{host:s,port:c}=E9(e),u=c===null?"":`:${c}`,d={url:`${a}//${s}${u}/`},h=Object.freeze({host:s,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Qe(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Qe(Zo(d,r.config.emulator)&&Zo(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Pd(s)?(NN(`${a}//${s}${u}`),v6("Auth",!0)):T9()}function oM(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function E9(n){const e=oM(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const a=i[1];return{host:a,port:u2(r.substr(a.length+1))}}else{const[a,s]=r.split(":");return{host:a,port:u2(s)}}}function u2(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function T9(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Pw{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ss("not implemented")}_getIdTokenResponse(e){return Ss("not implemented")}_linkToIdToken(e,t){return Ss("not implemented")}_getReauthenticationResolver(e){return Ss("not implemented")}}async function A9(n,e){return Li(n,"POST","/v1/accounts:resetPassword",ua(n,e))}async function C9(n,e){return Li(n,"POST","/v1/accounts:signUp",e)}async function I9(n,e){return Li(n,"POST","/v1/accounts:update",ua(n,e))}async function R9(n,e){return Ip(n,"POST","/v1/accounts:signInWithPassword",ua(n,e))}async function lM(n,e){return Li(n,"POST","/v1/accounts:sendOobCode",ua(n,e))}async function k9(n,e){return lM(n,e)}async function D9(n,e){return lM(n,e)}async function N9(n,e){return Ip(n,"POST","/v1/accounts:signInWithEmailLink",ua(n,e))}async function M9(n,e){return Ip(n,"POST","/v1/accounts:signInWithEmailLink",ua(n,e))}class $h extends Pw{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new $h(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new $h(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return L0(e,t,"signInWithPassword",R9);case"emailLink":return N9(e,{email:this._email,oobCode:this._password});default:sa(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return L0(e,r,"signUpPassword",C9);case"emailLink":return M9(e,{idToken:t,email:this._email,oobCode:this._password});default:sa(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ed(n,e){return Ip(n,"POST","/v1/accounts:signInWithIdp",ua(n,e))}const P9="http://localhost";class xc extends Pw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new xc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):sa("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...a}=t;if(!r||!i)return null;const s=new xc(r,i);return s.idToken=a.idToken||void 0,s.accessToken=a.accessToken||void 0,s.secret=a.secret,s.nonce=a.nonce,s.pendingToken=a.pendingToken||null,s}_getIdTokenResponse(e){const t=this.buildRequest();return ed(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,ed(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ed(e,t)}buildRequest(){const e={requestUri:P9,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ap(t)}return e}}function O9(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function j9(n){const e=uh(dh(n)).link,t=e?uh(dh(e)).deep_link_id:null,r=uh(dh(n)).deep_link_id;return(r?uh(dh(r)).link:null)||r||t||e||n}class Ow{constructor(e){const t=uh(dh(e)),r=t.apiKey??null,i=t.oobCode??null,a=O9(t.mode??null);Qe(r&&i&&a,"argument-error"),this.apiKey=r,this.operation=a,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=j9(e);try{return new Ow(t)}catch{return null}}}class Pc{constructor(){this.providerId=Pc.PROVIDER_ID}static credential(e,t){return $h._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Ow.parseLink(t);return Qe(r,"argument-error"),$h._fromEmailAndCode(e,r.code,r.tenantId)}}Pc.PROVIDER_ID="password";Pc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Pc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class cM{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Rp extends cM{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Po extends Rp{constructor(){super("facebook.com")}static credential(e){return xc._fromParams({providerId:Po.PROVIDER_ID,signInMethod:Po.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Po.credentialFromTaggedObject(e)}static credentialFromError(e){return Po.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Po.credential(e.oauthAccessToken)}catch{return null}}}Po.FACEBOOK_SIGN_IN_METHOD="facebook.com";Po.PROVIDER_ID="facebook.com";class Oo extends Rp{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return xc._fromParams({providerId:Oo.PROVIDER_ID,signInMethod:Oo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Oo.credentialFromTaggedObject(e)}static credentialFromError(e){return Oo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Oo.credential(t,r)}catch{return null}}}Oo.GOOGLE_SIGN_IN_METHOD="google.com";Oo.PROVIDER_ID="google.com";class jo extends Rp{constructor(){super("github.com")}static credential(e){return xc._fromParams({providerId:jo.PROVIDER_ID,signInMethod:jo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return jo.credentialFromTaggedObject(e)}static credentialFromError(e){return jo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return jo.credential(e.oauthAccessToken)}catch{return null}}}jo.GITHUB_SIGN_IN_METHOD="github.com";jo.PROVIDER_ID="github.com";class Vo extends Rp{constructor(){super("twitter.com")}static credential(e,t){return xc._fromParams({providerId:Vo.PROVIDER_ID,signInMethod:Vo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Vo.credentialFromTaggedObject(e)}static credentialFromError(e){return Vo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Vo.credential(t,r)}catch{return null}}}Vo.TWITTER_SIGN_IN_METHOD="twitter.com";Vo.PROVIDER_ID="twitter.com";async function V9(n,e){return Ip(n,"POST","/v1/accounts:signUp",ua(n,e))}class _c{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const a=await na._fromIdTokenResponse(e,r,i),s=d2(r);return new _c({user:a,providerId:s,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=d2(r);return new _c({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function d2(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class B0 extends Us{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,B0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new B0(e,t,r,i)}}function uM(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?B0._fromErrorAndOperation(n,a,e,r):a})}async function z9(n,e,t=!1){const r=await sd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return _c._forOperation(n,"link",r)}async function dM(n,e,t=!1){const{auth:r}=n;if(ki(r.app))return Promise.reject(Cs(r));const i="reauthenticate";try{const a=await sd(n,uM(r,i,e,n),t);Qe(a.idToken,r,"internal-error");const s=Nw(a.idToken);Qe(s,r,"internal-error");const{sub:c}=s;return Qe(n.uid===c,r,"user-mismatch"),_c._forOperation(n,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&sa(r,"user-mismatch"),a}}async function fM(n,e,t=!1){if(ki(n.app))return Promise.reject(Cs(n));const r="signIn",i=await uM(n,r,e),a=await _c._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(a.user),a}async function L9(n,e){return fM(dl(n),e)}async function B9(n,e){return dM(Wt(n),e)}function U9(n,e,t){Qe(t.url?.length>0,n,"invalid-continue-uri"),Qe(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),Qe(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(Qe(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(Qe(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}async function jw(n){const e=dl(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function F9(n,e,t){const r=dl(n);await L0(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",D9)}async function G9(n,e,t){await A9(Wt(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&jw(n),r})}async function q9(n,e){await I9(Wt(n),{oobCode:e})}async function $9(n,e,t){if(ki(n.app))return Promise.reject(Cs(n));const r=dl(n),s=await L0(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",V9).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&jw(n),u}),c=await _c._fromIdTokenResponse(r,"signIn",s);return await r._updateCurrentUser(c.user),c}function H9(n,e,t){return ki(n.app)?Promise.reject(Cs(n)):L9(Wt(n),Pc.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&jw(n),r})}async function f2(n,e){const t=Wt(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&U9(t.auth,i,e);const{email:a}=await k9(t.auth,i);a!==n.email&&await n.reload()}async function Y9(n,e){return Li(n,"POST","/v1/accounts:update",e)}async function K9(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=Wt(n),a={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},s=await sd(r,Y9(r.auth,a));r.displayName=s.displayName||null,r.photoURL=s.photoUrl||null;const c=r.providerData.find(({providerId:u})=>u==="password");c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),await r._updateTokensIfNecessary(s)}function X9(n,e,t,r){return Wt(n).onIdTokenChanged(e,t,r)}function W9(n,e,t){return Wt(n).beforeAuthStateChanged(e,t)}function Q9(n,e,t,r){return Wt(n).onAuthStateChanged(e,t,r)}function h2(n){return Wt(n).signOut()}async function Z9(n){return Wt(n).delete()}const U0="__sak";class hM{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(U0,"1"),this.storage.removeItem(U0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const J9=1e3,eB=10;class pM extends hM{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=rM(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((s,c,u)=>{this.notifyListeners(s,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const s=this.storage.getItem(r);!t&&this.localCache[r]===s||this.notifyListeners(r,s)},a=this.storage.getItem(r);o9()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,eB):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},J9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}pM.type="LOCAL";const tB=pM;class gM extends hM{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}gM.type="SESSION";const mM=gM;function nB(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class jv{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new jv(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:a}=t.data,s=this.handlersMap[i];if(!s?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const c=Array.from(s).map(async d=>d(t.origin,a)),u=await nB(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}jv.receivers=[];function Vw(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class rB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,s;return new Promise((c,u)=>{const d=Vw("",20);i.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);s={messageChannel:i,onMessage(p){const m=p;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),a=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(m.data.response);break;default:clearTimeout(h),clearTimeout(a),u(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function Ba(){return window}function iB(n){Ba().location.href=n}function vM(){return typeof Ba().WorkerGlobalScope<"u"&&typeof Ba().importScripts=="function"}async function aB(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function sB(){return navigator?.serviceWorker?.controller||null}function oB(){return vM()?self:null}const yM="firebaseLocalStorageDb",lB=1,F0="firebaseLocalStorage",bM="fbase_key";class kp{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Vv(n,e){return n.transaction([F0],e?"readwrite":"readonly").objectStore(F0)}function cB(){const n=indexedDB.deleteDatabase(yM);return new kp(n).toPromise()}function Y1(){const n=indexedDB.open(yM,lB);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(F0,{keyPath:bM})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(F0)?e(r):(r.close(),await cB(),e(await Y1()))})})}async function p2(n,e,t){const r=Vv(n,!0).put({[bM]:e,value:t});return new kp(r).toPromise()}async function uB(n,e){const t=Vv(n,!1).get(e),r=await new kp(t).toPromise();return r===void 0?null:r.value}function g2(n,e){const t=Vv(n,!0).delete(e);return new kp(t).toPromise()}const dB=800,fB=3;class xM{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Y1(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>fB)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return vM()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=jv._getInstance(oB()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await aB(),!this.activeServiceWorker)return;this.sender=new rB(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||sB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Y1();return await p2(e,U0,"1"),await g2(e,U0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>p2(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>uB(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>g2(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=Vv(i,!1).getAll();return new kp(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),dB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}xM.type="LOCAL";const hB=xM;new Cp(3e4,6e4);function pB(n,e){return e?Es(e):(Qe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class zw extends Pw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ed(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ed(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ed(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function gB(n){return fM(n.auth,new zw(n),n.bypassAuthState)}function mB(n){const{auth:e,user:t}=n;return Qe(t,e,"internal-error"),dM(t,new zw(n),n.bypassAuthState)}async function vB(n){const{auth:e,user:t}=n;return Qe(t,e,"internal-error"),z9(t,new zw(n),n.bypassAuthState)}class _M{constructor(e,t,r,i,a=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:a,error:s,type:c}=e;if(s){this.reject(s);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return gB;case"linkViaPopup":case"linkViaRedirect":return vB;case"reauthViaPopup":case"reauthViaRedirect":return mB;default:sa(this.auth,"internal-error")}}resolve(e){Ms(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ms(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const yB=new Cp(2e3,1e4);class Bu extends _M{constructor(e,t,r,i,a){super(e,t,i,a),this.provider=r,this.authWindow=null,this.pollId=null,Bu.currentPopupAction&&Bu.currentPopupAction.cancel(),Bu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Qe(e,this.auth,"internal-error"),e}async onExecution(){Ms(this.filter.length===1,"Popup operations only handle one event");const e=Vw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(La(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(La(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Bu.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(La(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,yB.get())};e()}}Bu.currentPopupAction=null;const bB="pendingRedirect",u0=new Map;class xB extends _M{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=u0.get(this.auth._key());if(!e){try{const r=await _B(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}u0.set(this.auth._key(),e)}return this.bypassAuthState||u0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _B(n,e){const t=EB(e),r=SB(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function wB(n,e){u0.set(n._key(),e)}function SB(n){return Es(n._redirectPersistence)}function EB(n){return c0(bB,n.config.apiKey,n.name)}async function TB(n,e,t=!1){if(ki(n.app))return Promise.reject(Cs(n));const r=dl(n),i=pB(r,e),s=await new xB(r,i,t).execute();return s&&!t&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,e)),s}const AB=600*1e3;class CB{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!IB(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!wM(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(La(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=AB&&this.cachedEventUids.clear(),this.cachedEventUids.has(m2(e))}saveEventToCache(e){this.cachedEventUids.add(m2(e)),this.lastProcessedEventTime=Date.now()}}function m2(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function wM({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function IB(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return wM(n);default:return!1}}async function RB(n,e={}){return Li(n,"GET","/v1/projects",e)}const kB=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,DB=/^https?/;async function NB(n){if(n.config.emulator)return;const{authorizedDomains:e}=await RB(n);for(const t of e)try{if(MB(t))return}catch{}sa(n,"unauthorized-domain")}function MB(n){const e=$1(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const s=new URL(n);return s.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&s.hostname===r}if(!DB.test(t))return!1;if(kB.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const PB=new Cp(3e4,6e4);function v2(){const n=Ba().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function OB(n){return new Promise((e,t)=>{function r(){v2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{v2(),t(La(n,"network-request-failed"))},timeout:PB.get()})}if(Ba().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ba().gapi?.load)r();else{const i=m9("iframefcb");return Ba()[i]=()=>{gapi.load?r():t(La(n,"network-request-failed"))},aM(`${g9()}?onload=${i}`).catch(a=>t(a))}}).catch(e=>{throw d0=null,e})}let d0=null;function jB(n){return d0=d0||OB(n),d0}const VB=new Cp(5e3,15e3),zB="__/auth/iframe",LB="emulator/auth/iframe",BB={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},UB=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function FB(n){const e=n.config;Qe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Dw(e,LB):`https://${n.config.authDomain}/${zB}`,r={apiKey:e.apiKey,appName:n.name,v:Od},i=UB.get(n.config.apiHost);i&&(r.eid=i);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${Ap(r).slice(1)}`}async function GB(n){const e=await jB(n),t=Ba().gapi;return Qe(t,n,"internal-error"),e.open({where:document.body,url:FB(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:BB,dontclear:!0},r=>new Promise(async(i,a)=>{await r.restyle({setHideOnLeave:!1});const s=La(n,"network-request-failed"),c=Ba().setTimeout(()=>{a(s)},VB.get());function u(){Ba().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{a(s)})}))}const qB={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},$B=500,HB=600,YB="_blank",KB="http://localhost";class y2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function XB(n,e,t,r=$B,i=HB){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u={...qB,width:r.toString(),height:i.toString(),top:a,left:s},d=Wn().toLowerCase();t&&(c=ZN(d)?YB:t),WN(d)&&(e=e||KB,u.scrollbars="yes");const h=Object.entries(u).reduce((m,[b,_])=>`${m}${b}=${_},`,"");if(s9(d)&&c!=="_self")return WB(e||"",c),new y2(null);const p=window.open(e||"",c,h);Qe(p,n,"popup-blocked");try{p.focus()}catch{}return new y2(p)}function WB(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const QB="__/auth/handler",ZB="emulator/auth/handler",JB=encodeURIComponent("fac");async function b2(n,e,t,r,i,a){Qe(n.config.authDomain,n,"auth-domain-config-required"),Qe(n.config.apiKey,n,"invalid-api-key");const s={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Od,eventId:i};if(e instanceof cM){e.setDefaultLanguage(n.languageCode),s.providerId=e.providerId||"",C6(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))s[h]=p}if(e instanceof Rp){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(s.scopes=h.join(","))}n.tenantId&&(s.tid=n.tenantId);const c=s;for(const h of Object.keys(c))c[h]===void 0&&delete c[h];const u=await n._getAppCheckToken(),d=u?`#${JB}=${encodeURIComponent(u)}`:"";return`${e8(n)}?${Ap(c).slice(1)}${d}`}function e8({config:n}){return n.emulator?Dw(n,ZB):`https://${n.authDomain}/${QB}`}const Fx="webStorageSupport";class t8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=mM,this._completeRedirectFn=TB,this._overrideRedirectResult=wB}async _openPopup(e,t,r,i){Ms(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await b2(e,t,r,$1(),i);return XB(e,a,Vw())}async _openRedirect(e,t,r,i){await this._originValidation(e);const a=await b2(e,t,r,$1(),i);return iB(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:a}=this.eventManagers[t];return i?Promise.resolve(i):(Ms(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await GB(e),r=new CB(e);return t.register("authEvent",i=>(Qe(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Fx,{type:Fx},i=>{const a=i?.[0]?.[Fx];a!==void 0&&t(!!a),sa(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=NB(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return rM()||QN()||Mw()}}const n8=t8;var x2="@firebase/auth",_2="1.11.1";class r8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Qe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function i8(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function a8(n){ad(new bc("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:s,authDomain:c}=r.options;Qe(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:s,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:iM(n)},d=new f9(r,i,a,u);return w9(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ad(new bc("auth-internal",e=>{const t=dl(e.getProvider("auth").getImmediate());return(r=>new r8(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Yo(x2,_2,i8(n)),Yo(x2,_2,"esm2020")}const s8=300,o8=DN("authIdTokenMaxAge")||s8;let w2=null;const l8=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>o8)return;const i=t?.token;w2!==i&&(w2=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function c8(n=RL()){const e=Rw(n,"auth");if(e.isInitialized())return e.getImmediate();const t=_9(n,{popupRedirectResolver:n8,persistence:[hB,tB,mM]}),r=DN("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const s=l8(a.toString());W9(t,s,()=>s(t.currentUser)),X9(t,c=>s(c))}}const i=h6("auth");return i&&S9(t,`http://${i}`),t}function u8(){return document.getElementsByTagName("head")?.[0]??document}h9({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const a=La("internal-error");a.customData=i,t(a)},r.type="text/javascript",r.charset="UTF-8",u8().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});a8("Browser");var S2="popstate";function d8(n={}){function e(i,a){let{pathname:s="/",search:c="",hash:u=""}=Oc(i.location.hash.substring(1));return!s.startsWith("/")&&!s.startsWith(".")&&(s="/"+s),K1("",{pathname:s,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(i,a){let s=i.document.querySelector("base"),c="";if(s&&s.getAttribute("href")){let u=i.location.href,d=u.indexOf("#");c=d===-1?u:u.slice(0,d)}return c+"#"+(typeof a=="string"?a:Hh(a))}function r(i,a){ji(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(a)})`)}return h8(e,t,r,n)}function hn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function ji(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function f8(){return Math.random().toString(36).substring(2,10)}function E2(n,e){return{usr:n.state,key:n.key,idx:e}}function K1(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Oc(e):e,state:t,key:e&&e.key||r||f8()}}function Hh({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Oc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function h8(n,e,t,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,s=i.history,c="POP",u=null,d=h();d==null&&(d=0,s.replaceState({...s.state,idx:d},""));function h(){return(s.state||{idx:null}).idx}function p(){c="POP";let E=h(),T=E==null?null:E-d;d=E,u&&u({action:c,location:w.location,delta:T})}function m(E,T){c="PUSH";let C=K1(w.location,E,T);t&&t(C,E),d=h()+1;let k=E2(C,d),j=w.createHref(C);try{s.pushState(k,"",j)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;i.location.assign(j)}a&&u&&u({action:c,location:w.location,delta:1})}function b(E,T){c="REPLACE";let C=K1(w.location,E,T);t&&t(C,E),d=h();let k=E2(C,d),j=w.createHref(C);s.replaceState(k,"",j),a&&u&&u({action:c,location:w.location,delta:0})}function _(E){return p8(E)}let w={get action(){return c},get location(){return n(i,s)},listen(E){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(S2,p),u=E,()=>{i.removeEventListener(S2,p),u=null}},createHref(E){return e(i,E)},createURL:_,encodeLocation(E){let T=_(E);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:m,replace:b,go(E){return s.go(E)}};return w}function p8(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),hn(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:Hh(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function SM(n,e,t="/"){return g8(n,e,t,!1)}function g8(n,e,t,r){let i=typeof e=="string"?Oc(e):e,a=Ps(i.pathname||"/",t);if(a==null)return null;let s=EM(n);m8(s);let c=null;for(let u=0;c==null&&u<s.length;++u){let d=C8(a);c=T8(s[u],d,r)}return c}function EM(n,e=[],t=[],r="",i=!1){let a=(s,c,u=i,d)=>{let h={relativePath:d===void 0?s.path||"":d,caseSensitive:s.caseSensitive===!0,childrenIndex:c,route:s};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&u)return;hn(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let p=Is([r,h.relativePath]),m=t.concat(h);s.children&&s.children.length>0&&(hn(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),EM(s.children,e,m,p,u)),!(s.path==null&&!s.index)&&e.push({path:p,score:S8(p,s.index),routesMeta:m})};return n.forEach((s,c)=>{if(s.path===""||!s.path?.includes("?"))a(s,c);else for(let u of TM(s.path))a(s,c,!0,u)}),e}function TM(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let s=TM(r.join("/")),c=[];return c.push(...s.map(u=>u===""?a:[a,u].join("/"))),i&&c.push(...s),c.map(u=>n.startsWith("/")&&u===""?"/":u)}function m8(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:E8(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var v8=/^:[\w-]+$/,y8=3,b8=2,x8=1,_8=10,w8=-2,T2=n=>n==="*";function S8(n,e){let t=n.split("/"),r=t.length;return t.some(T2)&&(r+=w8),e&&(r+=b8),t.filter(i=>!T2(i)).reduce((i,a)=>i+(v8.test(a)?y8:a===""?x8:_8),r)}function E8(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function T8(n,e,t=!1){let{routesMeta:r}=n,i={},a="/",s=[];for(let c=0;c<r.length;++c){let u=r[c],d=c===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=G0({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),m=u.route;if(!p&&d&&t&&!r[r.length-1].route.index&&(p=G0({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!p)return null;Object.assign(i,p.params),s.push({params:i,pathname:Is([a,p.pathname]),pathnameBase:D8(Is([a,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(a=Is([a,p.pathnameBase]))}return s}function G0(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=A8(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let a=i[0],s=a.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:p},m)=>{if(h==="*"){let _=c[m]||"";s=a.slice(0,a.length-_.length).replace(/(.)\/+$/,"$1")}const b=c[m];return p&&!b?d[h]=void 0:d[h]=(b||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:s,pattern:n}}function A8(n,e=!1,t=!0){ji(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function C8(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ji(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Ps(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}var I8=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function R8(n,e="/"){let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?Oc(n):n,a;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?a=A2(t.substring(1),"/"):a=A2(t,e)):a=e,{pathname:a,search:N8(r),hash:M8(i)}}function A2(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function Gx(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function k8(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function AM(n){let e=k8(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function CM(n,e,t,r=!1){let i;typeof n=="string"?i=Oc(n):(i={...n},hn(!i.pathname||!i.pathname.includes("?"),Gx("?","pathname","search",i)),hn(!i.pathname||!i.pathname.includes("#"),Gx("#","pathname","hash",i)),hn(!i.search||!i.search.includes("#"),Gx("#","search","hash",i)));let a=n===""||i.pathname==="",s=a?"/":i.pathname,c;if(s==null)c=t;else{let p=e.length-1;if(!r&&s.startsWith("..")){let m=s.split("/");for(;m[0]==="..";)m.shift(),p-=1;i.pathname=m.join("/")}c=p>=0?e[p]:"/"}let u=R8(i,c),d=s&&s!=="/"&&s.endsWith("/"),h=(a||s===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}var Is=n=>n.join("/").replace(/\/\/+/g,"/"),D8=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),N8=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,M8=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,P8=class{constructor(n,e,t,r=!1){this.status=n,this.statusText=e||"",this.internal=r,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function O8(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function j8(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var IM=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function RM(n,e){let t=n;if(typeof t!="string"||!I8.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let r=t,i=!1;if(IM)try{let a=new URL(window.location.href),s=t.startsWith("//")?new URL(a.protocol+t):new URL(t),c=Ps(s.pathname,e);s.origin===a.origin&&c!=null?t=c+s.search+s.hash:i=!0}catch{ji(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:i,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var kM=["POST","PUT","PATCH","DELETE"];new Set(kM);var V8=["GET",...kM];new Set(V8);var jd=U.createContext(null);jd.displayName="DataRouter";var zv=U.createContext(null);zv.displayName="DataRouterState";var z8=U.createContext(!1),DM=U.createContext({isTransitioning:!1});DM.displayName="ViewTransition";var L8=U.createContext(new Map);L8.displayName="Fetchers";var B8=U.createContext(null);B8.displayName="Await";var Bi=U.createContext(null);Bi.displayName="Navigation";var Dp=U.createContext(null);Dp.displayName="Location";var Qa=U.createContext({outlet:null,matches:[],isDataRoute:!1});Qa.displayName="Route";var Lw=U.createContext(null);Lw.displayName="RouteError";var NM="REACT_ROUTER_ERROR",U8="REDIRECT",F8="ROUTE_ERROR_RESPONSE";function G8(n){if(n.startsWith(`${NM}:${U8}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function q8(n){if(n.startsWith(`${NM}:${F8}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new P8(e.status,e.statusText,e.data)}catch{}}function $8(n,{relative:e}={}){hn(Np(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=U.useContext(Bi),{hash:i,pathname:a,search:s}=Mp(n,{relative:e}),c=a;return t!=="/"&&(c=a==="/"?t:Is([t,a])),r.createHref({pathname:c,search:s,hash:i})}function Np(){return U.useContext(Dp)!=null}function da(){return hn(Np(),"useLocation() may be used only in the context of a <Router> component."),U.useContext(Dp).location}var MM="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function PM(n){U.useContext(Bi).static||U.useLayoutEffect(n)}function Za(){let{isDataRoute:n}=U.useContext(Qa);return n?aU():H8()}function H8(){hn(Np(),"useNavigate() may be used only in the context of a <Router> component.");let n=U.useContext(jd),{basename:e,navigator:t}=U.useContext(Bi),{matches:r}=U.useContext(Qa),{pathname:i}=da(),a=JSON.stringify(AM(r)),s=U.useRef(!1);return PM(()=>{s.current=!0}),U.useCallback((u,d={})=>{if(ji(s.current,MM),!s.current)return;if(typeof u=="number"){t.go(u);return}let h=CM(u,JSON.parse(a),i,d.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Is([e,h.pathname])),(d.replace?t.replace:t.push)(h,d.state,d)},[e,t,a,i,n])}U.createContext(null);function Y8(){let{matches:n}=U.useContext(Qa),e=n[n.length-1];return e?e.params:{}}function Mp(n,{relative:e}={}){let{matches:t}=U.useContext(Qa),{pathname:r}=da(),i=JSON.stringify(AM(t));return U.useMemo(()=>CM(n,JSON.parse(i),r,e==="path"),[n,i,r,e])}function K8(n,e){return OM(n,e)}function OM(n,e,t,r,i){hn(Np(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=U.useContext(Bi),{matches:s}=U.useContext(Qa),c=s[s.length-1],u=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",p=c&&c.route;{let C=p&&p.path||"";VM(d,!p||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let m=da(),b;if(e){let C=typeof e=="string"?Oc(e):e;hn(h==="/"||C.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${C.pathname}" was given in the \`location\` prop.`),b=C}else b=m;let _=b.pathname||"/",w=_;if(h!=="/"){let C=h.replace(/^\//,"").split("/");w="/"+_.replace(/^\//,"").split("/").slice(C.length).join("/")}let E=SM(n,{pathname:w});ji(p||E!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),ji(E==null||E[E.length-1].route.element!==void 0||E[E.length-1].route.Component!==void 0||E[E.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=J8(E&&E.map(C=>Object.assign({},C,{params:Object.assign({},u,C.params),pathname:Is([h,a.encodeLocation?a.encodeLocation(C.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?h:Is([h,a.encodeLocation?a.encodeLocation(C.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathnameBase])})),s,t,r,i);return e&&T?U.createElement(Dp.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},T):T}function X8(){let n=iU(),e=O8(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},s=null;return console.error("Error handled by React Router default ErrorBoundary:",n),s=U.createElement(U.Fragment,null,U.createElement("p",null," Hey developer "),U.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",U.createElement("code",{style:a},"ErrorBoundary")," or"," ",U.createElement("code",{style:a},"errorElement")," prop on your route.")),U.createElement(U.Fragment,null,U.createElement("h2",null,"Unexpected Application Error!"),U.createElement("h3",{style:{fontStyle:"italic"}},e),t?U.createElement("pre",{style:i},t):null,s)}var W8=U.createElement(X8,null),jM=class extends U.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=q8(n.digest);t&&(n=t)}let e=n!==void 0?U.createElement(Qa.Provider,{value:this.props.routeContext},U.createElement(Lw.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?U.createElement(Q8,{error:n},e):e}};jM.contextType=z8;var qx=new WeakMap;function Q8({children:n,error:e}){let{basename:t}=U.useContext(Bi);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=G8(e.digest);if(r){let i=qx.get(e);if(i)throw i;let a=RM(r.location,t);if(IM&&!qx.get(e))if(a.isExternal||r.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const s=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:r.replace}));throw qx.set(e,s),s}return U.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return n}function Z8({routeContext:n,match:e,children:t}){let r=U.useContext(jd);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),U.createElement(Qa.Provider,{value:n},t)}function J8(n,e=[],t=null,r=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,s=t?.errors;if(s!=null){let h=a.findIndex(p=>p.route.id&&s?.[p.route.id]!==void 0);hn(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let c=!1,u=-1;if(t)for(let h=0;h<a.length;h++){let p=a[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=h),p.route.id){let{loaderData:m,errors:b}=t,_=p.route.loader&&!m.hasOwnProperty(p.route.id)&&(!b||b[p.route.id]===void 0);if(p.route.lazy||_){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}let d=t&&r?(h,p)=>{r(h,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:j8(t.matches),errorInfo:p})}:void 0;return a.reduceRight((h,p,m)=>{let b,_=!1,w=null,E=null;t&&(b=s&&p.route.id?s[p.route.id]:void 0,w=p.route.errorElement||W8,c&&(u<0&&m===0?(VM("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,E=null):u===m&&(_=!0,E=p.route.hydrateFallbackElement||null)));let T=e.concat(a.slice(0,m+1)),C=()=>{let k;return b?k=w:_?k=E:p.route.Component?k=U.createElement(p.route.Component,null):p.route.element?k=p.route.element:k=h,U.createElement(Z8,{match:p,routeContext:{outlet:h,matches:T,isDataRoute:t!=null},children:k})};return t&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?U.createElement(jM,{location:t.location,revalidation:t.revalidation,component:w,error:b,children:C(),routeContext:{outlet:null,matches:T,isDataRoute:!0},onError:d}):C()},null)}function Bw(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function eU(n){let e=U.useContext(jd);return hn(e,Bw(n)),e}function tU(n){let e=U.useContext(zv);return hn(e,Bw(n)),e}function nU(n){let e=U.useContext(Qa);return hn(e,Bw(n)),e}function Uw(n){let e=nU(n),t=e.matches[e.matches.length-1];return hn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function rU(){return Uw("useRouteId")}function iU(){let n=U.useContext(Lw),e=tU("useRouteError"),t=Uw("useRouteError");return n!==void 0?n:e.errors?.[t]}function aU(){let{router:n}=eU("useNavigate"),e=Uw("useNavigate"),t=U.useRef(!1);return PM(()=>{t.current=!0}),U.useCallback(async(i,a={})=>{ji(t.current,MM),t.current&&(typeof i=="number"?await n.navigate(i):await n.navigate(i,{fromRouteId:e,...a}))},[n,e])}var C2={};function VM(n,e,t){!e&&!C2[n]&&(C2[n]=!0,ji(!1,t))}U.memo(sU);function sU({routes:n,future:e,state:t,onError:r}){return OM(n,void 0,t,r,e)}function _s(n){hn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function oU({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:i,static:a=!1,unstable_useTransitions:s}){hn(!Np(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=n.replace(/^\/*/,"/"),u=U.useMemo(()=>({basename:c,navigator:i,static:a,unstable_useTransitions:s,future:{}}),[c,i,a,s]);typeof t=="string"&&(t=Oc(t));let{pathname:d="/",search:h="",hash:p="",state:m=null,key:b="default"}=t,_=U.useMemo(()=>{let w=Ps(d,c);return w==null?null:{location:{pathname:w,search:h,hash:p,state:m,key:b},navigationType:r}},[c,d,h,p,m,b,r]);return ji(_!=null,`<Router basename="${c}"> is not able to match the URL "${d}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:U.createElement(Bi.Provider,{value:u},U.createElement(Dp.Provider,{children:e,value:_}))}function lU({children:n,location:e}){return K8(X1(n),e)}function X1(n,e=[]){let t=[];return U.Children.forEach(n,(r,i)=>{if(!U.isValidElement(r))return;let a=[...e,i];if(r.type===U.Fragment){t.push.apply(t,X1(r.props.children,a));return}hn(r.type===_s,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),hn(!r.props.index||!r.props.children,"An index route cannot have child routes.");let s={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(s.children=X1(r.props.children,a)),t.push(s)}),t}var f0="get",h0="application/x-www-form-urlencoded";function Lv(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function cU(n){return Lv(n)&&n.tagName.toLowerCase()==="button"}function uU(n){return Lv(n)&&n.tagName.toLowerCase()==="form"}function dU(n){return Lv(n)&&n.tagName.toLowerCase()==="input"}function fU(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function hU(n,e){return n.button===0&&(!e||e==="_self")&&!fU(n)}function W1(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let r=n[t];return e.concat(Array.isArray(r)?r.map(i=>[t,i]):[[t,r]])},[]))}function pU(n,e){let t=W1(n);return e&&e.forEach((r,i)=>{t.has(i)||e.getAll(i).forEach(a=>{t.append(i,a)})}),t}var Pm=null;function gU(){if(Pm===null)try{new FormData(document.createElement("form"),0),Pm=!1}catch{Pm=!0}return Pm}var mU=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function $x(n){return n!=null&&!mU.has(n)?(ji(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${h0}"`),null):n}function vU(n,e){let t,r,i,a,s;if(uU(n)){let c=n.getAttribute("action");r=c?Ps(c,e):null,t=n.getAttribute("method")||f0,i=$x(n.getAttribute("enctype"))||h0,a=new FormData(n)}else if(cU(n)||dU(n)&&(n.type==="submit"||n.type==="image")){let c=n.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=n.getAttribute("formaction")||c.getAttribute("action");if(r=u?Ps(u,e):null,t=n.getAttribute("formmethod")||c.getAttribute("method")||f0,i=$x(n.getAttribute("formenctype"))||$x(c.getAttribute("enctype"))||h0,a=new FormData(c,n),!gU()){let{name:d,type:h,value:p}=n;if(h==="image"){let m=d?`${d}.`:"";a.append(`${m}x`,"0"),a.append(`${m}y`,"0")}else d&&a.append(d,p)}}else{if(Lv(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=f0,r=null,i=h0,s=n}return a&&i==="text/plain"&&(s=a,a=void 0),{action:r,method:t.toLowerCase(),encType:i,formData:a,body:s}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Fw(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function yU(n,e,t,r){let i=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?i.pathname.endsWith("/")?i.pathname=`${i.pathname}_.${r}`:i.pathname=`${i.pathname}.${r}`:i.pathname==="/"?i.pathname=`_root.${r}`:e&&Ps(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${r}`,i}async function bU(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function xU(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function _U(n,e,t){let r=await Promise.all(n.map(async i=>{let a=e.routes[i.route.id];if(a){let s=await bU(a,t);return s.links?s.links():[]}return[]}));return TU(r.flat(1).filter(xU).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function I2(n,e,t,r,i,a){let s=(u,d)=>t[d]?u.route.id!==t[d].route.id:!0,c=(u,d)=>t[d].pathname!==u.pathname||t[d].route.path?.endsWith("*")&&t[d].params["*"]!==u.params["*"];return a==="assets"?e.filter((u,d)=>s(u,d)||c(u,d)):a==="data"?e.filter((u,d)=>{let h=r.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(s(u,d)||c(u,d))return!0;if(u.route.shouldRevalidate){let p=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function wU(n,e,{includeHydrateFallback:t}={}){return SU(n.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function SU(n){return[...new Set(n)]}function EU(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function TU(n,e){let t=new Set;return new Set(e),n.reduce((r,i)=>{let a=JSON.stringify(EU(i));return t.has(a)||(t.add(a),r.push({key:a,link:i})),r},[])}function zM(){let n=U.useContext(jd);return Fw(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function AU(){let n=U.useContext(zv);return Fw(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Gw=U.createContext(void 0);Gw.displayName="FrameworkContext";function LM(){let n=U.useContext(Gw);return Fw(n,"You must render this element inside a <HydratedRouter> element"),n}function CU(n,e){let t=U.useContext(Gw),[r,i]=U.useState(!1),[a,s]=U.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:d,onMouseLeave:h,onTouchStart:p}=e,m=U.useRef(null);U.useEffect(()=>{if(n==="render"&&s(!0),n==="viewport"){let w=T=>{T.forEach(C=>{s(C.isIntersecting)})},E=new IntersectionObserver(w,{threshold:.5});return m.current&&E.observe(m.current),()=>{E.disconnect()}}},[n]),U.useEffect(()=>{if(r){let w=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(w)}}},[r]);let b=()=>{i(!0)},_=()=>{i(!1),s(!1)};return t?n!=="intent"?[a,m,{}]:[a,m,{onFocus:th(c,b),onBlur:th(u,_),onMouseEnter:th(d,b),onMouseLeave:th(h,_),onTouchStart:th(p,b)}]:[!1,m,{}]}function th(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function IU({page:n,...e}){let{router:t}=zM(),r=U.useMemo(()=>SM(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?U.createElement(kU,{page:n,matches:r,...e}):null}function RU(n){let{manifest:e,routeModules:t}=LM(),[r,i]=U.useState([]);return U.useEffect(()=>{let a=!1;return _U(n,e,t).then(s=>{a||i(s)}),()=>{a=!0}},[n,e,t]),r}function kU({page:n,matches:e,...t}){let r=da(),{future:i,manifest:a,routeModules:s}=LM(),{basename:c}=zM(),{loaderData:u,matches:d}=AU(),h=U.useMemo(()=>I2(n,e,d,a,r,"data"),[n,e,d,a,r]),p=U.useMemo(()=>I2(n,e,d,a,r,"assets"),[n,e,d,a,r]),m=U.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let w=new Set,E=!1;if(e.forEach(C=>{let k=a.routes[C.route.id];!k||!k.hasLoader||(!h.some(j=>j.route.id===C.route.id)&&C.route.id in u&&s[C.route.id]?.shouldRevalidate||k.hasClientLoader?E=!0:w.add(C.route.id))}),w.size===0)return[];let T=yU(n,c,i.unstable_trailingSlashAwareDataRequests,"data");return E&&w.size>0&&T.searchParams.set("_routes",e.filter(C=>w.has(C.route.id)).map(C=>C.route.id).join(",")),[T.pathname+T.search]},[c,i.unstable_trailingSlashAwareDataRequests,u,r,a,h,e,n,s]),b=U.useMemo(()=>wU(p,a),[p,a]),_=RU(p);return U.createElement(U.Fragment,null,m.map(w=>U.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...t})),b.map(w=>U.createElement("link",{key:w,rel:"modulepreload",href:w,...t})),_.map(({key:w,link:E})=>U.createElement("link",{key:w,nonce:t.nonce,...E,crossOrigin:E.crossOrigin??t.crossOrigin})))}function DU(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var NU=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{NU&&(window.__reactRouterVersion="7.13.0")}catch{}function MU({basename:n,children:e,unstable_useTransitions:t,window:r}){let i=U.useRef();i.current==null&&(i.current=d8({window:r,v5Compat:!0}));let a=i.current,[s,c]=U.useState({action:a.action,location:a.location}),u=U.useCallback(d=>{t===!1?c(d):U.startTransition(()=>c(d))},[t]);return U.useLayoutEffect(()=>a.listen(u),[a,u]),U.createElement(oU,{basename:n,children:e,location:s.location,navigationType:s.action,navigator:a,unstable_useTransitions:t})}var BM=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,UM=U.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:i,reloadDocument:a,replace:s,state:c,target:u,to:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...b},_){let{basename:w,unstable_useTransitions:E}=U.useContext(Bi),T=typeof d=="string"&&BM.test(d),C=RM(d,w);d=C.to;let k=$8(d,{relative:i}),[j,P,N]=CU(r,b),A=VU(d,{replace:s,state:c,target:u,preventScrollReset:h,relative:i,viewTransition:p,unstable_defaultShouldRevalidate:m,unstable_useTransitions:E});function I(z){e&&e(z),z.defaultPrevented||A(z)}let D=U.createElement("a",{...b,...N,href:C.absoluteURL||k,onClick:C.isExternal||a?e:I,ref:DU(_,P),target:u,"data-discover":!T&&t==="render"?"true":void 0});return j&&!T?U.createElement(U.Fragment,null,D,U.createElement(IU,{page:k})):D});UM.displayName="Link";var PU=U.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:i=!1,style:a,to:s,viewTransition:c,children:u,...d},h){let p=Mp(s,{relative:d.relative}),m=da(),b=U.useContext(zv),{navigator:_,basename:w}=U.useContext(Bi),E=b!=null&&GU(p)&&c===!0,T=_.encodeLocation?_.encodeLocation(p).pathname:p.pathname,C=m.pathname,k=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;t||(C=C.toLowerCase(),k=k?k.toLowerCase():null,T=T.toLowerCase()),k&&w&&(k=Ps(k,w)||k);const j=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let P=C===T||!i&&C.startsWith(T)&&C.charAt(j)==="/",N=k!=null&&(k===T||!i&&k.startsWith(T)&&k.charAt(T.length)==="/"),A={isActive:P,isPending:N,isTransitioning:E},I=P?e:void 0,D;typeof r=="function"?D=r(A):D=[r,P?"active":null,N?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let z=typeof a=="function"?a(A):a;return U.createElement(UM,{...d,"aria-current":I,className:D,ref:h,style:z,to:s,viewTransition:c},typeof u=="function"?u(A):u)});PU.displayName="NavLink";var OU=U.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:i,state:a,method:s=f0,action:c,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...b},_)=>{let{unstable_useTransitions:w}=U.useContext(Bi),E=UU(),T=FU(c,{relative:d}),C=s.toLowerCase()==="get"?"get":"post",k=typeof c=="string"&&BM.test(c),j=P=>{if(u&&u(P),P.defaultPrevented)return;P.preventDefault();let N=P.nativeEvent.submitter,A=N?.getAttribute("formmethod")||s,I=()=>E(N||P.currentTarget,{fetcherKey:e,method:A,navigate:t,replace:i,state:a,relative:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m});w&&t!==!1?U.startTransition(()=>I()):I()};return U.createElement("form",{ref:_,method:C,action:T,onSubmit:r?u:j,...b,"data-discover":!k&&n==="render"?"true":void 0})});OU.displayName="Form";function jU(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function FM(n){let e=U.useContext(jd);return hn(e,jU(n)),e}function VU(n,{target:e,replace:t,state:r,preventScrollReset:i,relative:a,viewTransition:s,unstable_defaultShouldRevalidate:c,unstable_useTransitions:u}={}){let d=Za(),h=da(),p=Mp(n,{relative:a});return U.useCallback(m=>{if(hU(m,e)){m.preventDefault();let b=t!==void 0?t:Hh(h)===Hh(p),_=()=>d(n,{replace:b,state:r,preventScrollReset:i,relative:a,viewTransition:s,unstable_defaultShouldRevalidate:c});u?U.startTransition(()=>_()):_()}},[h,d,p,t,r,e,n,i,a,s,c,u])}function zU(n){ji(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=U.useRef(W1(n)),t=U.useRef(!1),r=da(),i=U.useMemo(()=>pU(r.search,t.current?null:e.current),[r.search]),a=Za(),s=U.useCallback((c,u)=>{const d=W1(typeof c=="function"?c(new URLSearchParams(i)):c);t.current=!0,a("?"+d,u)},[a,i]);return[i,s]}var LU=0,BU=()=>`__${String(++LU)}__`;function UU(){let{router:n}=FM("useSubmit"),{basename:e}=U.useContext(Bi),t=rU(),r=n.fetch,i=n.navigate;return U.useCallback(async(a,s={})=>{let{action:c,method:u,encType:d,formData:h,body:p}=vU(a,e);if(s.navigate===!1){let m=s.fetcherKey||BU();await r(m,t,s.action||c,{unstable_defaultShouldRevalidate:s.unstable_defaultShouldRevalidate,preventScrollReset:s.preventScrollReset,formData:h,body:p,formMethod:s.method||u,formEncType:s.encType||d,flushSync:s.flushSync})}else await i(s.action||c,{unstable_defaultShouldRevalidate:s.unstable_defaultShouldRevalidate,preventScrollReset:s.preventScrollReset,formData:h,body:p,formMethod:s.method||u,formEncType:s.encType||d,replace:s.replace,state:s.state,fromRouteId:t,flushSync:s.flushSync,viewTransition:s.viewTransition})},[r,i,e,t])}function FU(n,{relative:e}={}){let{basename:t}=U.useContext(Bi),r=U.useContext(Qa);hn(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),a={...Mp(n||".",{relative:e})},s=da();if(n==null){a.search=s.search;let c=new URLSearchParams(a.search),u=c.getAll("index");if(u.some(h=>h==="")){c.delete("index"),u.filter(p=>p).forEach(p=>c.append("index",p));let h=c.toString();a.search=h?`?${h}`:""}}return(!n||n===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:Is([t,a.pathname])),Hh(a)}function GU(n,{relative:e}={}){let t=U.useContext(DM);hn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=FM("useViewTransitionState"),i=Mp(n,{relative:e});if(!t.isTransitioning)return!1;let a=Ps(t.currentLocation.pathname,r)||t.currentLocation.pathname,s=Ps(t.nextLocation.pathname,r)||t.nextLocation.pathname;return G0(i.pathname,s)!=null||G0(i.pathname,a)!=null}const qU=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),$U=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),R2=n=>{const e=$U(n);return e.charAt(0).toUpperCase()+e.slice(1)},GM=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),HU=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var YU={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const KU=U.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:a,iconNode:s,...c},u)=>U.createElement("svg",{ref:u,...YU,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:GM("lucide",i),...!a&&!HU(c)&&{"aria-hidden":"true"},...c},[...s.map(([d,h])=>U.createElement(d,h)),...Array.isArray(a)?a:[a]]));const nt=(n,e)=>{const t=U.forwardRef(({className:r,...i},a)=>U.createElement(KU,{ref:a,iconNode:e,className:GM(`lucide-${qU(R2(n))}`,`lucide-${n}`,r),...i}));return t.displayName=R2(n),t};const XU=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Jo=nt("arrow-left",XU);const WU=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],QU=nt("arrow-right-left",WU);const ZU=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],JU=nt("arrow-right",ZU);const eF=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],tF=nt("calendar",eF);const nF=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],rF=nt("chart-column",nF);const iF=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],aF=nt("chart-pie",iF);const sF=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],oF=nt("check",sF);const lF=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],cF=nt("chevron-left",lF);const uF=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Da=nt("chevron-right",uF);const dF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]],fF=nt("circle-arrow-down",dF);const hF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],pF=nt("circle-arrow-up",hF);const gF=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],q0=nt("circle-check-big",gF);const mF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ws=nt("circle-check",mF);const vF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],k2=nt("circle",vF);const yF=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],D2=nt("dollar-sign",yF);const bF=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],N2=nt("download",bF);const xF=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],_F=nt("ellipsis",xF);const wF=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],qM=nt("eye-off",wF);const SF=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],$M=nt("eye",SF);const EF=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],TF=nt("file-text",EF);const AF=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],CF=nt("folder",AF);const IF=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],RF=nt("funnel",IF);const kF=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],Yh=nt("grip-vertical",kF);const DF=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],NF=nt("house",DF);const MF=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],PF=nt("list",MF);const OF=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],M2=nt("loader",OF);const jF=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],P2=nt("lock",jF);const VF=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],zF=nt("log-out",VF);const LF=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Q1=nt("mail",LF);const BF=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],UF=nt("pause",BF);const FF=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],GF=nt("pen",FF);const qF=[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]],Pp=nt("piggy-bank",qF);const $F=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Op=nt("plus",$F);const HF=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Kh=nt("refresh-cw",HF);const YF=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],KF=nt("rotate-ccw",YF);const XF=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],WF=nt("search",XF);const QF=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ZF=nt("settings",QF);const JF=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Xh=nt("sparkles",JF);const e7=[["path",{d:"M13.172 2a2 2 0 0 1 1.414.586l6.71 6.71a2.4 2.4 0 0 1 0 3.408l-4.592 4.592a2.4 2.4 0 0 1-3.408 0l-6.71-6.71A2 2 0 0 1 6 9.172V3a1 1 0 0 1 1-1z",key:"16rjxf"}],["path",{d:"M2 7v6.172a2 2 0 0 0 .586 1.414l6.71 6.71a2.4 2.4 0 0 0 3.191.193",key:"178nd4"}],["circle",{cx:"10.5",cy:"6.5",r:".5",fill:"currentColor",key:"12ikhr"}]],t7=nt("tags",e7);const n7=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],r7=nt("target",n7);const i7=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],$0=nt("trash-2",i7);const a7=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],HM=nt("trash",a7);const s7=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],H0=nt("trending-up",s7);const o7=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],td=nt("triangle-alert",o7);const l7=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],c7=nt("undo-2",l7);const u7=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],d7=nt("upload",u7);const f7=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],h7=nt("user-plus",f7);const p7=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],Bv=nt("wallet",p7);const g7=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Uv=nt("x",g7),O2=n=>{let e;const t=new Set,r=(d,h)=>{const p=typeof d=="function"?d(e):d;if(!Object.is(p,e)){const m=e;e=h??(typeof p!="object"||p===null)?p:Object.assign({},e,p),t.forEach(b=>b(e,m))}},i=()=>e,c={setState:r,getState:i,getInitialState:()=>u,subscribe:d=>(t.add(d),()=>t.delete(d))},u=e=n(r,i,c);return c},m7=(n=>n?O2(n):O2),v7=n=>n;function y7(n,e=v7){const t=ch.useSyncExternalStore(n.subscribe,ch.useCallback(()=>e(n.getState()),[n,e]),ch.useCallback(()=>e(n.getInitialState()),[n,e]));return ch.useDebugValue(t),t}const j2=n=>{const e=m7(n),t=r=>y7(e,r);return Object.assign(t,e),t},qw=(n=>n?j2(n):j2),V2={BASE_URL:"/personal-budget-pwa/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyCRHcpbVGQrEZUVdO_Ucn4ZarwwPsrON40",VITE_FIREBASE_APP_ID:"1:137454342284:web:0ae73943f9058a4342aba9",VITE_FIREBASE_AUTH_DOMAIN:"personal-budget-pwa-5defb.firebaseapp.com",VITE_FIREBASE_MEASUREMENT_ID:"G-VMP5DF6273",VITE_FIREBASE_MESSAGING_SENDER_ID:"137454342284",VITE_FIREBASE_PROJECT_ID:"personal-budget-pwa-5defb",VITE_FIREBASE_STORAGE_BUCKET:"personal-budget-pwa-5defb.firebasestorage.app"},Wh=new Map,Om=n=>{const e=Wh.get(n);return e?Object.fromEntries(Object.entries(e.stores).map(([t,r])=>[t,r.getState()])):{}},b7=(n,e,t)=>{if(n===void 0)return{type:"untracked",connection:e.connect(t)};const r=Wh.get(t.name);if(r)return{type:"tracked",store:n,...r};const i={connection:e.connect(t),stores:{}};return Wh.set(t.name,i),{type:"tracked",store:n,...i}},x7=(n,e)=>{if(e===void 0)return;const t=Wh.get(n);t&&(delete t.stores[e],Object.keys(t.stores).length===0&&Wh.delete(n))},_7=n=>{var e,t;if(!n)return;const r=n.split(`
`),i=r.findIndex(s=>s.includes("api.setState"));if(i<0)return;const a=((e=r[i+1])==null?void 0:e.trim())||"";return(t=/.+ (.+) .+/.exec(a))==null?void 0:t[1]},w7=(n,e={})=>(t,r,i)=>{const{enabled:a,anonymousActionType:s,store:c,...u}=e;let d;try{d=(a??(V2?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!d)return n(t,r,i);const{connection:h,...p}=b7(c,d,u);let m=!0;i.setState=((w,E,T)=>{const C=t(w,E);if(!m)return C;const k=T===void 0?{type:s||_7(new Error().stack)||"anonymous"}:typeof T=="string"?{type:T}:T;return c===void 0?(h?.send(k,r()),C):(h?.send({...k,type:`${c}/${k.type}`},{...Om(u.name),[c]:i.getState()}),C)}),i.devtools={cleanup:()=>{h&&typeof h.unsubscribe=="function"&&h.unsubscribe(),x7(u.name,c)}};const b=(...w)=>{const E=m;m=!1,t(...w),m=E},_=n(i.setState,r,i);if(p.type==="untracked"?h?.init(_):(p.stores[p.store]=i,h?.init(Object.fromEntries(Object.entries(p.stores).map(([w,E])=>[w,w===p.store?_:E.getState()])))),i.dispatchFromDevtools&&typeof i.dispatch=="function"){let w=!1;const E=i.dispatch;i.dispatch=(...T)=>{(V2?"production":void 0)!=="production"&&T[0].type==="__setState"&&!w&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),w=!0),E(...T)}}return h.subscribe(w=>{var E;switch(w.type){case"ACTION":if(typeof w.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return Hx(w.payload,T=>{if(T.type==="__setState"){if(c===void 0){b(T.state);return}Object.keys(T.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const C=T.state[c];if(C==null)return;JSON.stringify(i.getState())!==JSON.stringify(C)&&b(C);return}i.dispatchFromDevtools&&typeof i.dispatch=="function"&&i.dispatch(T)});case"DISPATCH":switch(w.payload.type){case"RESET":return b(_),c===void 0?h?.init(i.getState()):h?.init(Om(u.name));case"COMMIT":if(c===void 0){h?.init(i.getState());return}return h?.init(Om(u.name));case"ROLLBACK":return Hx(w.state,T=>{if(c===void 0){b(T),h?.init(i.getState());return}b(T[c]),h?.init(Om(u.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return Hx(w.state,T=>{if(c===void 0){b(T);return}JSON.stringify(i.getState())!==JSON.stringify(T[c])&&b(T[c])});case"IMPORT_STATE":{const{nextLiftedState:T}=w.payload,C=(E=T.computedStates.slice(-1)[0])==null?void 0:E.state;if(!C)return;b(c===void 0?C:C[c]),h?.send(null,T);return}case"PAUSE_RECORDING":return m=!m}return}}),_},S7=w7,Hx=(n,e)=>{let t;try{t=JSON.parse(n)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}t!==void 0&&e(t)};function E7(n,e){let t;try{t=n()}catch{return}return{getItem:i=>{var a;const s=u=>u===null?null:JSON.parse(u,void 0),c=(a=t.getItem(i))!=null?a:null;return c instanceof Promise?c.then(s):s(c)},setItem:(i,a)=>t.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>t.removeItem(i)}}const Z1=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return Z1(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return Z1(r)(t)}}}},T7=(n,e)=>(t,r,i)=>{let a={storage:E7(()=>localStorage),partialize:w=>w,version:0,merge:(w,E)=>({...E,...w}),...e},s=!1;const c=new Set,u=new Set;let d=a.storage;if(!d)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(...w)},r,i);const h=()=>{const w=a.partialize({...r()});return d.setItem(a.name,{state:w,version:a.version})},p=i.setState;i.setState=(w,E)=>(p(w,E),h());const m=n((...w)=>(t(...w),h()),r,i);i.getInitialState=()=>m;let b;const _=()=>{var w,E;if(!d)return;s=!1,c.forEach(C=>{var k;return C((k=r())!=null?k:m)});const T=((E=a.onRehydrateStorage)==null?void 0:E.call(a,(w=r())!=null?w:m))||void 0;return Z1(d.getItem.bind(d))(a.name).then(C=>{if(C)if(typeof C.version=="number"&&C.version!==a.version){if(a.migrate){const k=a.migrate(C.state,C.version);return k instanceof Promise?k.then(j=>[!0,j]):[!0,k]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,C.state];return[!1,void 0]}).then(C=>{var k;const[j,P]=C;if(b=a.merge(P,(k=r())!=null?k:m),t(b,!0),j)return h()}).then(()=>{T?.(b,void 0),b=r(),s=!0,u.forEach(C=>C(b))}).catch(C=>{T?.(void 0,C)})};return i.persist={setOptions:w=>{a={...a,...w},w.storage&&(d=w.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>_(),hasHydrated:()=>s,onHydrate:w=>(c.add(w),()=>{c.delete(w)}),onFinishHydration:w=>(u.add(w),()=>{u.delete(w)})},a.skipHydration||_(),b||m},YM=T7;var A7="firebase",C7="12.6.0";Yo(A7,C7,"app");var z2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ko,KM;(function(){var n;function e(A,I){function D(){}D.prototype=I.prototype,A.F=I.prototype,A.prototype=new D,A.prototype.constructor=A,A.D=function(z,V,B){for(var O=Array(arguments.length-2),X=2;X<arguments.length;X++)O[X-2]=arguments[X];return I.prototype[V].apply(z,O)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,I,D){D||(D=0);const z=Array(16);if(typeof I=="string")for(var V=0;V<16;++V)z[V]=I.charCodeAt(D++)|I.charCodeAt(D++)<<8|I.charCodeAt(D++)<<16|I.charCodeAt(D++)<<24;else for(V=0;V<16;++V)z[V]=I[D++]|I[D++]<<8|I[D++]<<16|I[D++]<<24;I=A.g[0],D=A.g[1],V=A.g[2];let B=A.g[3],O;O=I+(B^D&(V^B))+z[0]+3614090360&4294967295,I=D+(O<<7&4294967295|O>>>25),O=B+(V^I&(D^V))+z[1]+3905402710&4294967295,B=I+(O<<12&4294967295|O>>>20),O=V+(D^B&(I^D))+z[2]+606105819&4294967295,V=B+(O<<17&4294967295|O>>>15),O=D+(I^V&(B^I))+z[3]+3250441966&4294967295,D=V+(O<<22&4294967295|O>>>10),O=I+(B^D&(V^B))+z[4]+4118548399&4294967295,I=D+(O<<7&4294967295|O>>>25),O=B+(V^I&(D^V))+z[5]+1200080426&4294967295,B=I+(O<<12&4294967295|O>>>20),O=V+(D^B&(I^D))+z[6]+2821735955&4294967295,V=B+(O<<17&4294967295|O>>>15),O=D+(I^V&(B^I))+z[7]+4249261313&4294967295,D=V+(O<<22&4294967295|O>>>10),O=I+(B^D&(V^B))+z[8]+1770035416&4294967295,I=D+(O<<7&4294967295|O>>>25),O=B+(V^I&(D^V))+z[9]+2336552879&4294967295,B=I+(O<<12&4294967295|O>>>20),O=V+(D^B&(I^D))+z[10]+4294925233&4294967295,V=B+(O<<17&4294967295|O>>>15),O=D+(I^V&(B^I))+z[11]+2304563134&4294967295,D=V+(O<<22&4294967295|O>>>10),O=I+(B^D&(V^B))+z[12]+1804603682&4294967295,I=D+(O<<7&4294967295|O>>>25),O=B+(V^I&(D^V))+z[13]+4254626195&4294967295,B=I+(O<<12&4294967295|O>>>20),O=V+(D^B&(I^D))+z[14]+2792965006&4294967295,V=B+(O<<17&4294967295|O>>>15),O=D+(I^V&(B^I))+z[15]+1236535329&4294967295,D=V+(O<<22&4294967295|O>>>10),O=I+(V^B&(D^V))+z[1]+4129170786&4294967295,I=D+(O<<5&4294967295|O>>>27),O=B+(D^V&(I^D))+z[6]+3225465664&4294967295,B=I+(O<<9&4294967295|O>>>23),O=V+(I^D&(B^I))+z[11]+643717713&4294967295,V=B+(O<<14&4294967295|O>>>18),O=D+(B^I&(V^B))+z[0]+3921069994&4294967295,D=V+(O<<20&4294967295|O>>>12),O=I+(V^B&(D^V))+z[5]+3593408605&4294967295,I=D+(O<<5&4294967295|O>>>27),O=B+(D^V&(I^D))+z[10]+38016083&4294967295,B=I+(O<<9&4294967295|O>>>23),O=V+(I^D&(B^I))+z[15]+3634488961&4294967295,V=B+(O<<14&4294967295|O>>>18),O=D+(B^I&(V^B))+z[4]+3889429448&4294967295,D=V+(O<<20&4294967295|O>>>12),O=I+(V^B&(D^V))+z[9]+568446438&4294967295,I=D+(O<<5&4294967295|O>>>27),O=B+(D^V&(I^D))+z[14]+3275163606&4294967295,B=I+(O<<9&4294967295|O>>>23),O=V+(I^D&(B^I))+z[3]+4107603335&4294967295,V=B+(O<<14&4294967295|O>>>18),O=D+(B^I&(V^B))+z[8]+1163531501&4294967295,D=V+(O<<20&4294967295|O>>>12),O=I+(V^B&(D^V))+z[13]+2850285829&4294967295,I=D+(O<<5&4294967295|O>>>27),O=B+(D^V&(I^D))+z[2]+4243563512&4294967295,B=I+(O<<9&4294967295|O>>>23),O=V+(I^D&(B^I))+z[7]+1735328473&4294967295,V=B+(O<<14&4294967295|O>>>18),O=D+(B^I&(V^B))+z[12]+2368359562&4294967295,D=V+(O<<20&4294967295|O>>>12),O=I+(D^V^B)+z[5]+4294588738&4294967295,I=D+(O<<4&4294967295|O>>>28),O=B+(I^D^V)+z[8]+2272392833&4294967295,B=I+(O<<11&4294967295|O>>>21),O=V+(B^I^D)+z[11]+1839030562&4294967295,V=B+(O<<16&4294967295|O>>>16),O=D+(V^B^I)+z[14]+4259657740&4294967295,D=V+(O<<23&4294967295|O>>>9),O=I+(D^V^B)+z[1]+2763975236&4294967295,I=D+(O<<4&4294967295|O>>>28),O=B+(I^D^V)+z[4]+1272893353&4294967295,B=I+(O<<11&4294967295|O>>>21),O=V+(B^I^D)+z[7]+4139469664&4294967295,V=B+(O<<16&4294967295|O>>>16),O=D+(V^B^I)+z[10]+3200236656&4294967295,D=V+(O<<23&4294967295|O>>>9),O=I+(D^V^B)+z[13]+681279174&4294967295,I=D+(O<<4&4294967295|O>>>28),O=B+(I^D^V)+z[0]+3936430074&4294967295,B=I+(O<<11&4294967295|O>>>21),O=V+(B^I^D)+z[3]+3572445317&4294967295,V=B+(O<<16&4294967295|O>>>16),O=D+(V^B^I)+z[6]+76029189&4294967295,D=V+(O<<23&4294967295|O>>>9),O=I+(D^V^B)+z[9]+3654602809&4294967295,I=D+(O<<4&4294967295|O>>>28),O=B+(I^D^V)+z[12]+3873151461&4294967295,B=I+(O<<11&4294967295|O>>>21),O=V+(B^I^D)+z[15]+530742520&4294967295,V=B+(O<<16&4294967295|O>>>16),O=D+(V^B^I)+z[2]+3299628645&4294967295,D=V+(O<<23&4294967295|O>>>9),O=I+(V^(D|~B))+z[0]+4096336452&4294967295,I=D+(O<<6&4294967295|O>>>26),O=B+(D^(I|~V))+z[7]+1126891415&4294967295,B=I+(O<<10&4294967295|O>>>22),O=V+(I^(B|~D))+z[14]+2878612391&4294967295,V=B+(O<<15&4294967295|O>>>17),O=D+(B^(V|~I))+z[5]+4237533241&4294967295,D=V+(O<<21&4294967295|O>>>11),O=I+(V^(D|~B))+z[12]+1700485571&4294967295,I=D+(O<<6&4294967295|O>>>26),O=B+(D^(I|~V))+z[3]+2399980690&4294967295,B=I+(O<<10&4294967295|O>>>22),O=V+(I^(B|~D))+z[10]+4293915773&4294967295,V=B+(O<<15&4294967295|O>>>17),O=D+(B^(V|~I))+z[1]+2240044497&4294967295,D=V+(O<<21&4294967295|O>>>11),O=I+(V^(D|~B))+z[8]+1873313359&4294967295,I=D+(O<<6&4294967295|O>>>26),O=B+(D^(I|~V))+z[15]+4264355552&4294967295,B=I+(O<<10&4294967295|O>>>22),O=V+(I^(B|~D))+z[6]+2734768916&4294967295,V=B+(O<<15&4294967295|O>>>17),O=D+(B^(V|~I))+z[13]+1309151649&4294967295,D=V+(O<<21&4294967295|O>>>11),O=I+(V^(D|~B))+z[4]+4149444226&4294967295,I=D+(O<<6&4294967295|O>>>26),O=B+(D^(I|~V))+z[11]+3174756917&4294967295,B=I+(O<<10&4294967295|O>>>22),O=V+(I^(B|~D))+z[2]+718787259&4294967295,V=B+(O<<15&4294967295|O>>>17),O=D+(B^(V|~I))+z[9]+3951481745&4294967295,A.g[0]=A.g[0]+I&4294967295,A.g[1]=A.g[1]+(V+(O<<21&4294967295|O>>>11))&4294967295,A.g[2]=A.g[2]+V&4294967295,A.g[3]=A.g[3]+B&4294967295}r.prototype.v=function(A,I){I===void 0&&(I=A.length);const D=I-this.blockSize,z=this.C;let V=this.h,B=0;for(;B<I;){if(V==0)for(;B<=D;)i(this,A,B),B+=this.blockSize;if(typeof A=="string"){for(;B<I;)if(z[V++]=A.charCodeAt(B++),V==this.blockSize){i(this,z),V=0;break}}else for(;B<I;)if(z[V++]=A[B++],V==this.blockSize){i(this,z),V=0;break}}this.h=V,this.o+=I},r.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var I=1;I<A.length-8;++I)A[I]=0;I=this.o*8;for(var D=A.length-8;D<A.length;++D)A[D]=I&255,I/=256;for(this.v(A),A=Array(16),I=0,D=0;D<4;++D)for(let z=0;z<32;z+=8)A[I++]=this.g[D]>>>z&255;return A};function a(A,I){var D=c;return Object.prototype.hasOwnProperty.call(D,A)?D[A]:D[A]=I(A)}function s(A,I){this.h=I;const D=[];let z=!0;for(let V=A.length-1;V>=0;V--){const B=A[V]|0;z&&B==I||(D[V]=B,z=!1)}this.g=D}var c={};function u(A){return-128<=A&&A<128?a(A,function(I){return new s([I|0],I<0?-1:0)}):new s([A|0],A<0?-1:0)}function d(A){if(isNaN(A)||!isFinite(A))return p;if(A<0)return E(d(-A));const I=[];let D=1;for(let z=0;A>=D;z++)I[z]=A/D|0,D*=4294967296;return new s(I,0)}function h(A,I){if(A.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(A.charAt(0)=="-")return E(h(A.substring(1),I));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=d(Math.pow(I,8));let z=p;for(let B=0;B<A.length;B+=8){var V=Math.min(8,A.length-B);const O=parseInt(A.substring(B,B+V),I);V<8?(V=d(Math.pow(I,V)),z=z.j(V).add(d(O))):(z=z.j(D),z=z.add(d(O)))}return z}var p=u(0),m=u(1),b=u(16777216);n=s.prototype,n.m=function(){if(w(this))return-E(this).m();let A=0,I=1;for(let D=0;D<this.g.length;D++){const z=this.i(D);A+=(z>=0?z:4294967296+z)*I,I*=4294967296}return A},n.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(_(this))return"0";if(w(this))return"-"+E(this).toString(A);const I=d(Math.pow(A,6));var D=this;let z="";for(;;){const V=j(D,I).g;D=T(D,V.j(I));let B=((D.g.length>0?D.g[0]:D.h)>>>0).toString(A);if(D=V,_(D))return B+z;for(;B.length<6;)B="0"+B;z=B+z}},n.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function _(A){if(A.h!=0)return!1;for(let I=0;I<A.g.length;I++)if(A.g[I]!=0)return!1;return!0}function w(A){return A.h==-1}n.l=function(A){return A=T(this,A),w(A)?-1:_(A)?0:1};function E(A){const I=A.g.length,D=[];for(let z=0;z<I;z++)D[z]=~A.g[z];return new s(D,~A.h).add(m)}n.abs=function(){return w(this)?E(this):this},n.add=function(A){const I=Math.max(this.g.length,A.g.length),D=[];let z=0;for(let V=0;V<=I;V++){let B=z+(this.i(V)&65535)+(A.i(V)&65535),O=(B>>>16)+(this.i(V)>>>16)+(A.i(V)>>>16);z=O>>>16,B&=65535,O&=65535,D[V]=O<<16|B}return new s(D,D[D.length-1]&-2147483648?-1:0)};function T(A,I){return A.add(E(I))}n.j=function(A){if(_(this)||_(A))return p;if(w(this))return w(A)?E(this).j(E(A)):E(E(this).j(A));if(w(A))return E(this.j(E(A)));if(this.l(b)<0&&A.l(b)<0)return d(this.m()*A.m());const I=this.g.length+A.g.length,D=[];for(var z=0;z<2*I;z++)D[z]=0;for(z=0;z<this.g.length;z++)for(let V=0;V<A.g.length;V++){const B=this.i(z)>>>16,O=this.i(z)&65535,X=A.i(V)>>>16,K=A.i(V)&65535;D[2*z+2*V]+=O*K,C(D,2*z+2*V),D[2*z+2*V+1]+=B*K,C(D,2*z+2*V+1),D[2*z+2*V+1]+=O*X,C(D,2*z+2*V+1),D[2*z+2*V+2]+=B*X,C(D,2*z+2*V+2)}for(A=0;A<I;A++)D[A]=D[2*A+1]<<16|D[2*A];for(A=I;A<2*I;A++)D[A]=0;return new s(D,0)};function C(A,I){for(;(A[I]&65535)!=A[I];)A[I+1]+=A[I]>>>16,A[I]&=65535,I++}function k(A,I){this.g=A,this.h=I}function j(A,I){if(_(I))throw Error("division by zero");if(_(A))return new k(p,p);if(w(A))return I=j(E(A),I),new k(E(I.g),E(I.h));if(w(I))return I=j(A,E(I)),new k(E(I.g),I.h);if(A.g.length>30){if(w(A)||w(I))throw Error("slowDivide_ only works with positive integers.");for(var D=m,z=I;z.l(A)<=0;)D=P(D),z=P(z);var V=N(D,1),B=N(z,1);for(z=N(z,2),D=N(D,2);!_(z);){var O=B.add(z);O.l(A)<=0&&(V=V.add(D),B=O),z=N(z,1),D=N(D,1)}return I=T(A,V.j(I)),new k(V,I)}for(V=p;A.l(I)>=0;){for(D=Math.max(1,Math.floor(A.m()/I.m())),z=Math.ceil(Math.log(D)/Math.LN2),z=z<=48?1:Math.pow(2,z-48),B=d(D),O=B.j(I);w(O)||O.l(A)>0;)D-=z,B=d(D),O=B.j(I);_(B)&&(B=m),V=V.add(B),A=T(A,O)}return new k(V,A)}n.B=function(A){return j(this,A).h},n.and=function(A){const I=Math.max(this.g.length,A.g.length),D=[];for(let z=0;z<I;z++)D[z]=this.i(z)&A.i(z);return new s(D,this.h&A.h)},n.or=function(A){const I=Math.max(this.g.length,A.g.length),D=[];for(let z=0;z<I;z++)D[z]=this.i(z)|A.i(z);return new s(D,this.h|A.h)},n.xor=function(A){const I=Math.max(this.g.length,A.g.length),D=[];for(let z=0;z<I;z++)D[z]=this.i(z)^A.i(z);return new s(D,this.h^A.h)};function P(A){const I=A.g.length+1,D=[];for(let z=0;z<I;z++)D[z]=A.i(z)<<1|A.i(z-1)>>>31;return new s(D,A.h)}function N(A,I){const D=I>>5;I%=32;const z=A.g.length-D,V=[];for(let B=0;B<z;B++)V[B]=I>0?A.i(B+D)>>>I|A.i(B+D+1)<<32-I:A.i(B+D);return new s(V,A.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,KM=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.B,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=d,s.fromString=h,Ko=s}).apply(typeof z2<"u"?z2:typeof self<"u"?self:typeof window<"u"?window:{});var jm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var XM,fh,WM,p0,J1,QM,ZM,JM;(function(){var n,e=Object.defineProperty;function t(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof jm=="object"&&jm];for(var R=0;R<y.length;++R){var L=y[R];if(L&&L.Math==Math)return L}throw Error("Cannot find global object")}var r=t(this);function i(y,R){if(R)e:{var L=r;y=y.split(".");for(var q=0;q<y.length-1;q++){var ce=y[q];if(!(ce in L))break e;L=L[ce]}y=y[y.length-1],q=L[y],R=R(q),R!=q&&R!=null&&e(L,y,{configurable:!0,writable:!0,value:R})}}i("Symbol.dispose",function(y){return y||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(y){return y||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(y){return y||function(R){var L=[],q;for(q in R)Object.prototype.hasOwnProperty.call(R,q)&&L.push([q,R[q]]);return L}});var a=a||{},s=this||self;function c(y){var R=typeof y;return R=="object"&&y!=null||R=="function"}function u(y,R,L){return y.call.apply(y.bind,arguments)}function d(y,R,L){return d=u,d.apply(null,arguments)}function h(y,R){var L=Array.prototype.slice.call(arguments,1);return function(){var q=L.slice();return q.push.apply(q,arguments),y.apply(this,q)}}function p(y,R){function L(){}L.prototype=R.prototype,y.Z=R.prototype,y.prototype=new L,y.prototype.constructor=y,y.Ob=function(q,ce,pe){for(var ke=Array(arguments.length-2),ct=2;ct<arguments.length;ct++)ke[ct-2]=arguments[ct];return R.prototype[ce].apply(q,ke)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?y=>y&&AsyncContext.Snapshot.wrap(y):y=>y;function b(y){const R=y.length;if(R>0){const L=Array(R);for(let q=0;q<R;q++)L[q]=y[q];return L}return[]}function _(y,R){for(let q=1;q<arguments.length;q++){const ce=arguments[q];var L=typeof ce;if(L=L!="object"?L:ce?Array.isArray(ce)?"array":L:"null",L=="array"||L=="object"&&typeof ce.length=="number"){L=y.length||0;const pe=ce.length||0;y.length=L+pe;for(let ke=0;ke<pe;ke++)y[L+ke]=ce[ke]}else y.push(ce)}}class w{constructor(R,L){this.i=R,this.j=L,this.h=0,this.g=null}get(){let R;return this.h>0?(this.h--,R=this.g,this.g=R.next,R.next=null):R=this.i(),R}}function E(y){s.setTimeout(()=>{throw y},0)}function T(){var y=A;let R=null;return y.g&&(R=y.g,y.g=y.g.next,y.g||(y.h=null),R.next=null),R}class C{constructor(){this.h=this.g=null}add(R,L){const q=k.get();q.set(R,L),this.h?this.h.next=q:this.g=q,this.h=q}}var k=new w(()=>new j,y=>y.reset());class j{constructor(){this.next=this.g=this.h=null}set(R,L){this.h=R,this.g=L,this.next=null}reset(){this.next=this.g=this.h=null}}let P,N=!1,A=new C,I=()=>{const y=Promise.resolve(void 0);P=()=>{y.then(D)}};function D(){for(var y;y=T();){try{y.h.call(y.g)}catch(L){E(L)}var R=k;R.j(y),R.h<100&&(R.h++,y.next=R.g,R.g=y)}N=!1}function z(){this.u=this.u,this.C=this.C}z.prototype.u=!1,z.prototype.dispose=function(){this.u||(this.u=!0,this.N())},z.prototype[Symbol.dispose]=function(){this.dispose()},z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(y,R){this.type=y,this.g=this.target=R,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!s.addEventListener||!Object.defineProperty)return!1;var y=!1,R=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const L=()=>{};s.addEventListener("test",L,R),s.removeEventListener("test",L,R)}catch{}return y})();function O(y){return/^[\s\xa0]*$/.test(y)}function X(y,R){V.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y&&this.init(y,R)}p(X,V),X.prototype.init=function(y,R){const L=this.type=y.type,q=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;this.target=y.target||y.srcElement,this.g=R,R=y.relatedTarget,R||(L=="mouseover"?R=y.fromElement:L=="mouseout"&&(R=y.toElement)),this.relatedTarget=R,q?(this.clientX=q.clientX!==void 0?q.clientX:q.pageX,this.clientY=q.clientY!==void 0?q.clientY:q.pageY,this.screenX=q.screenX||0,this.screenY=q.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=y.pointerType,this.state=y.state,this.i=y,y.defaultPrevented&&X.Z.h.call(this)},X.prototype.h=function(){X.Z.h.call(this);const y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var K="closure_listenable_"+(Math.random()*1e6|0),$=0;function W(y,R,L,q,ce){this.listener=y,this.proxy=null,this.src=R,this.type=L,this.capture=!!q,this.ha=ce,this.key=++$,this.da=this.fa=!1}function ee(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function ie(y,R,L){for(const q in y)R.call(L,y[q],q,y)}function H(y,R){for(const L in y)R.call(void 0,y[L],L,y)}function F(y){const R={};for(const L in y)R[L]=y[L];return R}const Y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ne(y,R){let L,q;for(let ce=1;ce<arguments.length;ce++){q=arguments[ce];for(L in q)y[L]=q[L];for(let pe=0;pe<Y.length;pe++)L=Y[pe],Object.prototype.hasOwnProperty.call(q,L)&&(y[L]=q[L])}}function Z(y){this.src=y,this.g={},this.h=0}Z.prototype.add=function(y,R,L,q,ce){const pe=y.toString();y=this.g[pe],y||(y=this.g[pe]=[],this.h++);const ke=ue(y,R,q,ce);return ke>-1?(R=y[ke],L||(R.fa=!1)):(R=new W(R,this.src,pe,!!q,ce),R.fa=L,y.push(R)),R};function oe(y,R){const L=R.type;if(L in y.g){var q=y.g[L],ce=Array.prototype.indexOf.call(q,R,void 0),pe;(pe=ce>=0)&&Array.prototype.splice.call(q,ce,1),pe&&(ee(R),y.g[L].length==0&&(delete y.g[L],y.h--))}}function ue(y,R,L,q){for(let ce=0;ce<y.length;++ce){const pe=y[ce];if(!pe.da&&pe.listener==R&&pe.capture==!!L&&pe.ha==q)return ce}return-1}var ye="closure_lm_"+(Math.random()*1e6|0),me={};function Te(y,R,L,q,ce){if(Array.isArray(R)){for(let pe=0;pe<R.length;pe++)Te(y,R[pe],L,q,ce);return null}return L=Be(L),y&&y[K]?y.J(R,L,c(q)?!!q.capture:!1,ce):Me(y,R,L,!1,q,ce)}function Me(y,R,L,q,ce,pe){if(!R)throw Error("Invalid event type");const ke=c(ce)?!!ce.capture:!!ce;let ct=Le(y);if(ct||(y[ye]=ct=new Z(y)),L=ct.add(R,L,q,ke,pe),L.proxy)return L;if(q=ae(),L.proxy=q,q.src=y,q.listener=L,y.addEventListener)B||(ce=ke),ce===void 0&&(ce=!1),y.addEventListener(R.toString(),q,ce);else if(y.attachEvent)y.attachEvent(Oe(R.toString()),q);else if(y.addListener&&y.removeListener)y.addListener(q);else throw Error("addEventListener and attachEvent are unavailable.");return L}function ae(){function y(L){return R.call(y.src,y.listener,L)}const R=Ge;return y}function Ce(y,R,L,q,ce){if(Array.isArray(R))for(var pe=0;pe<R.length;pe++)Ce(y,R[pe],L,q,ce);else q=c(q)?!!q.capture:!!q,L=Be(L),y&&y[K]?(y=y.i,pe=String(R).toString(),pe in y.g&&(R=y.g[pe],L=ue(R,L,q,ce),L>-1&&(ee(R[L]),Array.prototype.splice.call(R,L,1),R.length==0&&(delete y.g[pe],y.h--)))):y&&(y=Le(y))&&(R=y.g[R.toString()],y=-1,R&&(y=ue(R,L,q,ce)),(L=y>-1?R[y]:null)&&Ne(L))}function Ne(y){if(typeof y!="number"&&y&&!y.da){var R=y.src;if(R&&R[K])oe(R.i,y);else{var L=y.type,q=y.proxy;R.removeEventListener?R.removeEventListener(L,q,y.capture):R.detachEvent?R.detachEvent(Oe(L),q):R.addListener&&R.removeListener&&R.removeListener(q),(L=Le(R))?(oe(L,y),L.h==0&&(L.src=null,R[ye]=null)):ee(y)}}}function Oe(y){return y in me?me[y]:me[y]="on"+y}function Ge(y,R){if(y.da)y=!0;else{R=new X(R,this);const L=y.listener,q=y.ha||y.src;y.fa&&Ne(y),y=L.call(q,R)}return y}function Le(y){return y=y[ye],y instanceof Z?y:null}var Se="__closure_events_fn_"+(Math.random()*1e9>>>0);function Be(y){return typeof y=="function"?y:(y[Se]||(y[Se]=function(R){return y.handleEvent(R)}),y[Se])}function Pe(){z.call(this),this.i=new Z(this),this.M=this,this.G=null}p(Pe,z),Pe.prototype[K]=!0,Pe.prototype.removeEventListener=function(y,R,L,q){Ce(this,y,R,L,q)};function Ue(y,R){var L,q=y.G;if(q)for(L=[];q;q=q.G)L.push(q);if(y=y.M,q=R.type||R,typeof R=="string")R=new V(R,y);else if(R instanceof V)R.target=R.target||y;else{var ce=R;R=new V(q,y),ne(R,ce)}ce=!0;let pe,ke;if(L)for(ke=L.length-1;ke>=0;ke--)pe=R.g=L[ke],ce=lt(pe,q,!0,R)&&ce;if(pe=R.g=y,ce=lt(pe,q,!0,R)&&ce,ce=lt(pe,q,!1,R)&&ce,L)for(ke=0;ke<L.length;ke++)pe=R.g=L[ke],ce=lt(pe,q,!1,R)&&ce}Pe.prototype.N=function(){if(Pe.Z.N.call(this),this.i){var y=this.i;for(const R in y.g){const L=y.g[R];for(let q=0;q<L.length;q++)ee(L[q]);delete y.g[R],y.h--}}this.G=null},Pe.prototype.J=function(y,R,L,q){return this.i.add(String(y),R,!1,L,q)},Pe.prototype.K=function(y,R,L,q){return this.i.add(String(y),R,!0,L,q)};function lt(y,R,L,q){if(R=y.i.g[String(R)],!R)return!0;R=R.concat();let ce=!0;for(let pe=0;pe<R.length;++pe){const ke=R[pe];if(ke&&!ke.da&&ke.capture==L){const ct=ke.listener,wn=ke.ha||ke.src;ke.fa&&oe(y.i,ke),ce=ct.call(wn,q)!==!1&&ce}}return ce&&!q.defaultPrevented}function Et(y,R){if(typeof y!="function")if(y&&typeof y.handleEvent=="function")y=d(y.handleEvent,y);else throw Error("Invalid listener argument");return Number(R)>2147483647?-1:s.setTimeout(y,R||0)}function tt(y){y.g=Et(()=>{y.g=null,y.i&&(y.i=!1,tt(y))},y.l);const R=y.h;y.h=null,y.m.apply(null,R)}class ft extends z{constructor(R,L){super(),this.m=R,this.l=L,this.h=null,this.i=!1,this.g=null}j(R){this.h=arguments,this.g?this.i=!0:tt(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Dt(y){z.call(this),this.h=y,this.g={}}p(Dt,z);var pn=[];function Ot(y){ie(y.g,function(R,L){this.g.hasOwnProperty(L)&&Ne(R)},y),y.g={}}Dt.prototype.N=function(){Dt.Z.N.call(this),Ot(this)},Dt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Rn=s.JSON.stringify,Yr=s.JSON.parse,fa=class{stringify(y){return s.JSON.stringify(y,void 0)}parse(y){return s.JSON.parse(y,void 0)}};function es(){}function $s(){}var Kr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function kn(){V.call(this,"d")}p(kn,V);function dr(){V.call(this,"c")}p(dr,V);var on={},Bc=null;function Hs(){return Bc=Bc||new Pe}on.Ia="serverreachability";function Ys(y){V.call(this,on.Ia,y)}p(Ys,V);function mt(y){const R=Hs();Ue(R,new Ys(R))}on.STAT_EVENT="statevent";function ln(y,R){V.call(this,on.STAT_EVENT,y),this.stat=R}p(ln,V);function cn(y){const R=Hs();Ue(R,new ln(R,y))}on.Ja="timingevent";function Xr(y,R){V.call(this,on.Ja,y),this.size=R}p(Xr,V);function fi(y,R){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){y()},R)}function _r(){this.g=!0}_r.prototype.ua=function(){this.g=!1};function Py(y,R,L,q,ce,pe){y.info(function(){if(y.g)if(pe){var ke="",ct=pe.split("&");for(let Nt=0;Nt<ct.length;Nt++){var wn=ct[Nt].split("=");if(wn.length>1){const tn=wn[0];wn=wn[1];const mi=tn.split("_");ke=mi.length>=2&&mi[1]=="type"?ke+(tn+"="+wn+"&"):ke+(tn+"=redacted&")}}}else ke=null;else ke=pe;return"XMLHTTP REQ ("+q+") [attempt "+ce+"]: "+R+`
`+L+`
`+ke})}function ug(y,R,L,q,ce,pe,ke){y.info(function(){return"XMLHTTP RESP ("+q+") [ attempt "+ce+"]: "+R+`
`+L+`
`+pe+" "+ke})}function ha(y,R,L,q){y.info(function(){return"XMLHTTP TEXT ("+R+"): "+Oy(y,L)+(q?" "+q:"")})}function bl(y,R){y.info(function(){return"TIMEOUT: "+R})}_r.prototype.info=function(){};function Oy(y,R){if(!y.g)return R;if(!R)return null;try{const pe=JSON.parse(R);if(pe){for(y=0;y<pe.length;y++)if(Array.isArray(pe[y])){var L=pe[y];if(!(L.length<2)){var q=L[1];if(Array.isArray(q)&&!(q.length<1)){var ce=q[0];if(ce!="noop"&&ce!="stop"&&ce!="close")for(let ke=1;ke<q.length;ke++)q[ke]=""}}}}return Rn(pe)}catch{return R}}var xl={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Jd={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ef;function _l(){}p(_l,es),_l.prototype.g=function(){return new XMLHttpRequest},ef=new _l;function ts(y){return encodeURIComponent(String(y))}function dg(y){var R=1;y=y.split(":");const L=[];for(;R>0&&y.length;)L.push(y.shift()),R--;return y.length&&L.push(y.join(":")),L}function Ui(y,R,L,q){this.j=y,this.i=R,this.l=L,this.S=q||1,this.V=new Dt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Fi}function Fi(){this.i=null,this.g="",this.h=!1}var Dn={},Zn={};function pa(y,R,L){y.M=1,y.A=wl(Mn(R)),y.u=L,y.R=!0,Uc(y,null)}function Uc(y,R){y.F=Date.now(),ga(y),y.B=Mn(y.A);var L=y.B,q=y.S;Array.isArray(q)||(q=[String(q)]),$c(L.i,"t",q),y.C=0,L=y.j.L,y.h=new Fi,y.g=Ag(y.j,L?R:null,!y.u),y.P>0&&(y.O=new ft(d(y.Y,y,y.g),y.P)),R=y.V,L=y.g,q=y.ba;var ce="readystatechange";Array.isArray(ce)||(ce&&(pn[0]=ce.toString()),ce=pn);for(let pe=0;pe<ce.length;pe++){const ke=Te(L,ce[pe],q||R.handleEvent,!1,R.h||R);if(!ke)break;R.g[ke.key]=ke}R=y.J?F(y.J):{},y.u?(y.v||(y.v="POST"),R["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.B,y.v,y.u,R)):(y.v="GET",y.g.ea(y.B,y.v,null,R)),mt(),Py(y.i,y.v,y.B,y.l,y.S,y.u)}Ui.prototype.ba=function(y){y=y.target;const R=this.O;R&&$i(y)==3?R.j():this.Y(y)},Ui.prototype.Y=function(y){try{if(y==this.g)e:{const ct=$i(this.g),wn=this.g.ya(),Nt=this.g.ca();if(!(ct<3)&&(ct!=3||this.g&&(this.h.h||this.g.la()||nr(this.g)))){this.K||ct!=4||wn==7||(wn==8||Nt<=0?mt(3):mt(2)),ma(this);var R=this.g.ca();this.X=R;var L=jy(this);if(this.o=R==200,ug(this.i,this.v,this.B,this.l,this.S,ct,R),this.o){if(this.U&&!this.L){t:{if(this.g){var q,ce=this.g;if((q=ce.g?ce.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(q)){var pe=q;break t}}pe=null}if(y=pe)ha(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,va(this,y);else{this.o=!1,this.m=3,cn(12),Wr(this),hi(this);break e}}if(this.R){y=!0;let tn;for(;!this.K&&this.C<L.length;)if(tn=hg(this,L),tn==Zn){ct==4&&(this.m=4,cn(14),y=!1),ha(this.i,this.l,null,"[Incomplete Response]");break}else if(tn==Dn){this.m=4,cn(15),ha(this.i,this.l,L,"[Invalid Chunk]"),y=!1;break}else ha(this.i,this.l,tn,null),va(this,tn);if(fg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ct!=4||L.length!=0||this.h.h||(this.m=1,cn(16),y=!1),this.o=this.o&&y,!y)ha(this.i,this.l,L,"[Invalid Chunked Response]"),Wr(this),hi(this);else if(L.length>0&&!this.W){this.W=!0;var ke=this.j;ke.g==this&&ke.aa&&!ke.P&&(ke.j.info("Great, no buffering proxy detected. Bytes received: "+L.length),mf(ke),ke.P=!0,cn(11))}}else ha(this.i,this.l,L,null),va(this,L);ct==4&&Wr(this),this.o&&!this.K&&(ct==4?wg(this.j,this):(this.o=!1,ga(this)))}else rs(this.g),R==400&&L.indexOf("Unknown SID")>0?(this.m=3,cn(12)):(this.m=0,cn(13)),Wr(this),hi(this)}}}catch{}finally{}};function jy(y){if(!fg(y))return y.g.la();const R=nr(y.g);if(R==="")return"";let L="";const q=R.length,ce=$i(y.g)==4;if(!y.h.i){if(typeof TextDecoder>"u")return Wr(y),hi(y),"";y.h.i=new s.TextDecoder}for(let pe=0;pe<q;pe++)y.h.h=!0,L+=y.h.i.decode(R[pe],{stream:!(ce&&pe==q-1)});return R.length=0,y.h.g+=L,y.C=0,y.h.g}function fg(y){return y.g?y.v=="GET"&&y.M!=2&&y.j.Aa:!1}function hg(y,R){var L=y.C,q=R.indexOf(`
`,L);return q==-1?Zn:(L=Number(R.substring(L,q)),isNaN(L)?Dn:(q+=1,q+L>R.length?Zn:(R=R.slice(q,q+L),y.C=q+L,R)))}Ui.prototype.cancel=function(){this.K=!0,Wr(this)};function ga(y){y.T=Date.now()+y.H,Fc(y,y.H)}function Fc(y,R){if(y.D!=null)throw Error("WatchDog timer not null");y.D=fi(d(y.aa,y),R)}function ma(y){y.D&&(s.clearTimeout(y.D),y.D=null)}Ui.prototype.aa=function(){this.D=null;const y=Date.now();y-this.T>=0?(bl(this.i,this.B),this.M!=2&&(mt(),cn(17)),Wr(this),this.m=2,hi(this)):Fc(this,this.T-y)};function hi(y){y.j.I==0||y.K||wg(y.j,y)}function Wr(y){ma(y);var R=y.O;R&&typeof R.dispose=="function"&&R.dispose(),y.O=null,Ot(y.V),y.g&&(R=y.g,y.g=null,R.abort(),R.dispose())}function va(y,R){try{var L=y.j;if(L.I!=0&&(L.g==y||ba(L.h,y))){if(!y.L&&ba(L.h,y)&&L.I==3){try{var q=L.Ba.g.parse(R)}catch{q=null}if(Array.isArray(q)&&q.length==3){var ce=q;if(ce[0]==0){e:if(!L.v){if(L.g)if(L.g.F+3e3<y.F)Wc(L),to(L);else break e;Rl(L),cn(18)}}else L.xa=ce[1],0<L.xa-L.K&&ce[2]<37500&&L.F&&L.A==0&&!L.C&&(L.C=fi(d(L.Va,L),6e3));ya(L.h)<=1&&L.ta&&(L.ta=void 0)}else Ta(L,11)}else if((y.L||L.g==y)&&Wc(L),!O(R))for(ce=L.Ba.g.parse(R),R=0;R<ce.length;R++){let Nt=ce[R];const tn=Nt[0];if(!(tn<=L.K))if(L.K=tn,Nt=Nt[1],L.I==2)if(Nt[0]=="c"){L.M=Nt[1],L.ba=Nt[2];const mi=Nt[3];mi!=null&&(L.ka=mi,L.j.info("VER="+L.ka));const Aa=Nt[4];Aa!=null&&(L.za=Aa,L.j.info("SVER="+L.za));const Hi=Nt[5];Hi!=null&&typeof Hi=="number"&&Hi>0&&(q=1.5*Hi,L.O=q,L.j.info("backChannelRequestTimeoutMs_="+q)),q=L;const Yi=y.g;if(Yi){const kl=Yi.g?Yi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(kl){var pe=q.h;pe.g||kl.indexOf("spdy")==-1&&kl.indexOf("quic")==-1&&kl.indexOf("h2")==-1||(pe.j=pe.l,pe.g=new Set,pe.h&&(rf(pe,pe.h),pe.h=null))}if(q.G){const Qc=Yi.g?Yi.g.getResponseHeader("X-HTTP-Session-Id"):null;Qc&&(q.wa=Qc,jt(q.J,q.G,Qc))}}L.I=3,L.l&&L.l.ra(),L.aa&&(L.T=Date.now()-y.F,L.j.info("Handshake RTT: "+L.T+"ms")),q=L;var ke=y;if(q.na=Tg(q,q.L?q.ba:null,q.W),ke.L){af(q.h,ke);var ct=ke,wn=q.O;wn&&(ct.H=wn),ct.D&&(ma(ct),ga(ct)),q.g=ke}else xg(q);L.i.length>0&&Ea(L)}else Nt[0]!="stop"&&Nt[0]!="close"||Ta(L,7);else L.I==3&&(Nt[0]=="stop"||Nt[0]=="close"?Nt[0]=="stop"?Ta(L,7):pf(L):Nt[0]!="noop"&&L.l&&L.l.qa(Nt),L.A=0)}}mt(4)}catch{}}var Nn=class{constructor(y,R){this.g=y,this.map=R}};function tf(y){this.l=y||10,s.PerformanceNavigationTiming?(y=s.performance.getEntriesByType("navigation"),y=y.length>0&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function nf(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function ya(y){return y.h?1:y.g?y.g.size:0}function ba(y,R){return y.h?y.h==R:y.g?y.g.has(R):!1}function rf(y,R){y.g?y.g.add(R):y.h=R}function af(y,R){y.h&&y.h==R?y.h=null:y.g&&y.g.has(R)&&y.g.delete(R)}tf.prototype.cancel=function(){if(this.i=sf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function sf(y){if(y.h!=null)return y.i.concat(y.h.G);if(y.g!=null&&y.g.size!==0){let R=y.i;for(const L of y.g.values())R=R.concat(L.G);return R}return b(y.i)}var pg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Gc(y,R){if(y){y=y.split("&");for(let L=0;L<y.length;L++){const q=y[L].indexOf("=");let ce,pe=null;q>=0?(ce=y[L].substring(0,q),pe=y[L].substring(q+1)):ce=y[L],R(ce,pe?decodeURIComponent(pe.replace(/\+/g," ")):"")}}}function Qr(y){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let R;y instanceof Qr?(this.l=y.l,Jn(this,y.j),this.o=y.o,this.g=y.g,Ks(this,y.u),this.h=y.h,of(this,yg(y.i)),this.m=y.m):y&&(R=String(y).match(pg))?(this.l=!1,Jn(this,R[1]||"",!0),this.o=xa(R[2]||""),this.g=xa(R[3]||"",!0),Ks(this,R[4]),this.h=xa(R[5]||"",!0),of(this,R[6]||"",!0),this.m=xa(R[7]||"")):(this.l=!1,this.i=new Ws(null,this.l))}Qr.prototype.toString=function(){const y=[];var R=this.j;R&&y.push(Sl(R,qc,!0),":");var L=this.g;return(L||R=="file")&&(y.push("//"),(R=this.o)&&y.push(Sl(R,qc,!0),"@"),y.push(ts(L).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),L=this.u,L!=null&&y.push(":",String(L))),(L=this.h)&&(this.g&&L.charAt(0)!="/"&&y.push("/"),y.push(Sl(L,L.charAt(0)=="/"?lf:gg,!0))),(L=this.i.toString())&&y.push("?",L),(L=this.m)&&y.push("#",Sl(L,mg)),y.join("")},Qr.prototype.resolve=function(y){const R=Mn(this);let L=!!y.j;L?Jn(R,y.j):L=!!y.o,L?R.o=y.o:L=!!y.g,L?R.g=y.g:L=y.u!=null;var q=y.h;if(L)Ks(R,y.u);else if(L=!!y.h){if(q.charAt(0)!="/")if(this.g&&!this.h)q="/"+q;else{var ce=R.h.lastIndexOf("/");ce!=-1&&(q=R.h.slice(0,ce+1)+q)}if(ce=q,ce==".."||ce==".")q="";else if(ce.indexOf("./")!=-1||ce.indexOf("/.")!=-1){q=ce.lastIndexOf("/",0)==0,ce=ce.split("/");const pe=[];for(let ke=0;ke<ce.length;){const ct=ce[ke++];ct=="."?q&&ke==ce.length&&pe.push(""):ct==".."?((pe.length>1||pe.length==1&&pe[0]!="")&&pe.pop(),q&&ke==ce.length&&pe.push("")):(pe.push(ct),q=!0)}q=pe.join("/")}else q=ce}return L?R.h=q:L=y.i.toString()!=="",L?of(R,yg(y.i)):L=!!y.m,L&&(R.m=y.m),R};function Mn(y){return new Qr(y)}function Jn(y,R,L){y.j=L?xa(R,!0):R,y.j&&(y.j=y.j.replace(/:$/,""))}function Ks(y,R){if(R){if(R=Number(R),isNaN(R)||R<0)throw Error("Bad port number "+R);y.u=R}else y.u=null}function of(y,R,L){R instanceof Ws?(y.i=R,Hc(y.i,y.l)):(L||(R=Sl(R,Xs)),y.i=new Ws(R,y.l))}function jt(y,R,L){y.i.set(R,L)}function wl(y){return jt(y,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),y}function xa(y,R){return y?R?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function Sl(y,R,L){return typeof y=="string"?(y=encodeURI(y).replace(R,Dr),L&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Dr(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var qc=/[#\/\?@]/g,gg=/[#\?:]/g,lf=/[#\?]/g,Xs=/[#\?@]/g,mg=/#/g;function Ws(y,R){this.h=this.g=null,this.i=y||null,this.j=!!R}function Nr(y){y.g||(y.g=new Map,y.h=0,y.i&&Gc(y.i,function(R,L){y.add(decodeURIComponent(R.replace(/\+/g," ")),L)}))}n=Ws.prototype,n.add=function(y,R){Nr(this),this.i=null,y=Qs(this,y);let L=this.g.get(y);return L||this.g.set(y,L=[]),L.push(R),this.h+=1,this};function vg(y,R){Nr(y),R=Qs(y,R),y.g.has(R)&&(y.i=null,y.h-=y.g.get(R).length,y.g.delete(R))}function cf(y,R){return Nr(y),R=Qs(y,R),y.g.has(R)}n.forEach=function(y,R){Nr(this),this.g.forEach(function(L,q){L.forEach(function(ce){y.call(R,ce,q,this)},this)},this)};function uf(y,R){Nr(y);let L=[];if(typeof R=="string")cf(y,R)&&(L=L.concat(y.g.get(Qs(y,R))));else for(y=Array.from(y.g.values()),R=0;R<y.length;R++)L=L.concat(y[R]);return L}n.set=function(y,R){return Nr(this),this.i=null,y=Qs(this,y),cf(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[R]),this.h+=1,this},n.get=function(y,R){return y?(y=uf(this,y),y.length>0?String(y[0]):R):R};function $c(y,R,L){vg(y,R),L.length>0&&(y.i=null,y.g.set(Qs(y,R),b(L)),y.h+=L.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],R=Array.from(this.g.keys());for(let q=0;q<R.length;q++){var L=R[q];const ce=ts(L);L=uf(this,L);for(let pe=0;pe<L.length;pe++){let ke=ce;L[pe]!==""&&(ke+="="+ts(L[pe])),y.push(ke)}}return this.i=y.join("&")};function yg(y){const R=new Ws;return R.i=y.i,y.g&&(R.g=new Map(y.g),R.h=y.h),R}function Qs(y,R){return R=String(R),y.j&&(R=R.toLowerCase()),R}function Hc(y,R){R&&!y.j&&(Nr(y),y.i=null,y.g.forEach(function(L,q){const ce=q.toLowerCase();q!=ce&&(vg(this,q),$c(this,ce,L))},y)),y.j=R}function Gi(y,R){const L=new _r;if(s.Image){const q=new Image;q.onload=h(pi,L,"TestLoadImage: loaded",!0,R,q),q.onerror=h(pi,L,"TestLoadImage: error",!1,R,q),q.onabort=h(pi,L,"TestLoadImage: abort",!1,R,q),q.ontimeout=h(pi,L,"TestLoadImage: timeout",!1,R,q),s.setTimeout(function(){q.ontimeout&&q.ontimeout()},1e4),q.src=y}else R(!1)}function df(y,R){const L=new _r,q=new AbortController,ce=setTimeout(()=>{q.abort(),pi(L,"TestPingServer: timeout",!1,R)},1e4);fetch(y,{signal:q.signal}).then(pe=>{clearTimeout(ce),pe.ok?pi(L,"TestPingServer: ok",!0,R):pi(L,"TestPingServer: server error",!1,R)}).catch(()=>{clearTimeout(ce),pi(L,"TestPingServer: error",!1,R)})}function pi(y,R,L,q,ce){try{ce&&(ce.onload=null,ce.onerror=null,ce.onabort=null,ce.ontimeout=null),q(L)}catch{}}function Zs(){this.g=new fa}function _a(y){this.i=y.Sb||null,this.h=y.ab||!1}p(_a,es),_a.prototype.g=function(){return new El(this.i,this.h)};function El(y,R){Pe.call(this),this.H=y,this.o=R,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(El,Pe),n=El.prototype,n.open=function(y,R){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=y,this.D=R,this.readyState=1,qi(this)},n.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const R={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};y&&(R.body=y),(this.H||s).fetch(new Request(this.D,R)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Js(this)),this.readyState=0},n.Pa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,qi(this)),this.g&&(this.readyState=3,qi(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof s.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Yc(this)}else y.text().then(this.Oa.bind(this),this.ga.bind(this))};function Yc(y){y.j.read().then(y.Ma.bind(y)).catch(y.ga.bind(y))}n.Ma=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var R=y.value?y.value:new Uint8Array(0);(R=this.B.decode(R,{stream:!y.done}))&&(this.response=this.responseText+=R)}y.done?Js(this):qi(this),this.readyState==3&&Yc(this)}},n.Oa=function(y){this.g&&(this.response=this.responseText=y,Js(this))},n.Na=function(y){this.g&&(this.response=y,Js(this))},n.ga=function(){this.g&&Js(this)};function Js(y){y.readyState=4,y.l=null,y.j=null,y.B=null,qi(y)}n.setRequestHeader=function(y,R){this.A.append(y,R)},n.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],R=this.h.entries();for(var L=R.next();!L.done;)L=L.value,y.push(L[0]+": "+L[1]),L=R.next();return y.join(`\r
`)};function qi(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(El.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function gi(y){let R="";return ie(y,function(L,q){R+=q,R+=":",R+=L,R+=`\r
`}),R}function Tl(y,R,L){e:{for(q in L){var q=!1;break e}q=!0}q||(L=gi(L),typeof y=="string"?L!=null&&ts(L):jt(y,R,L))}function Ft(y){Pe.call(this),this.headers=new Map,this.L=y||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(Ft,Pe);var wa=/^https?$/i,ff=["POST","PUT"];n=Ft.prototype,n.Fa=function(y){this.H=y},n.ea=function(y,R,L,q){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);R=R?R.toUpperCase():"GET",this.D=y,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ef.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(R,String(y),!0),this.B=!1}catch(pe){Al(this,pe);return}if(y=L||"",L=new Map(this.headers),q)if(Object.getPrototypeOf(q)===Object.prototype)for(var ce in q)L.set(ce,q[ce]);else if(typeof q.keys=="function"&&typeof q.get=="function")for(const pe of q.keys())L.set(pe,q.get(pe));else throw Error("Unknown input type for opt_headers: "+String(q));q=Array.from(L.keys()).find(pe=>pe.toLowerCase()=="content-type"),ce=s.FormData&&y instanceof s.FormData,!(Array.prototype.indexOf.call(ff,R,void 0)>=0)||q||ce||L.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[pe,ke]of L)this.g.setRequestHeader(pe,ke);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(y),this.v=!1}catch(pe){Al(this,pe)}};function Al(y,R){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=R,y.o=5,hf(y),ns(y)}function hf(y){y.A||(y.A=!0,Ue(y,"complete"),Ue(y,"error"))}n.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=y||7,Ue(this,"complete"),Ue(this,"abort"),ns(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ns(this,!0)),Ft.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Cl(this):this.Xa())},n.Xa=function(){Cl(this)};function Cl(y){if(y.h&&typeof a<"u"){if(y.v&&$i(y)==4)setTimeout(y.Ca.bind(y),0);else if(Ue(y,"readystatechange"),$i(y)==4){y.h=!1;try{const pe=y.ca();e:switch(pe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var R=!0;break e;default:R=!1}var L;if(!(L=R)){var q;if(q=pe===0){let ke=String(y.D).match(pg)[1]||null;!ke&&s.self&&s.self.location&&(ke=s.self.location.protocol.slice(0,-1)),q=!wa.test(ke?ke.toLowerCase():"")}L=q}if(L)Ue(y,"complete"),Ue(y,"success");else{y.o=6;try{var ce=$i(y)>2?y.g.statusText:""}catch{ce=""}y.l=ce+" ["+y.ca()+"]",hf(y)}}finally{ns(y)}}}}function ns(y,R){if(y.g){y.m&&(clearTimeout(y.m),y.m=null);const L=y.g;y.g=null,R||Ue(y,"ready");try{L.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function $i(y){return y.g?y.g.readyState:0}n.ca=function(){try{return $i(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(y){if(this.g){var R=this.g.responseText;return y&&R.indexOf(y)==0&&(R=R.substring(y.length)),Yr(R)}};function nr(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.F){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function rs(y){const R={};y=(y.g&&$i(y)>=2&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let q=0;q<y.length;q++){if(O(y[q]))continue;var L=dg(y[q]);const ce=L[0];if(L=L[1],typeof L!="string")continue;L=L.trim();const pe=R[ce]||[];R[ce]=pe,pe.push(L)}H(R,function(q){return q.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Sa(y,R,L){return L&&L.internalChannelParams&&L.internalChannelParams[y]||R}function eo(y){this.za=0,this.i=[],this.j=new _r,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Sa("failFast",!1,y),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Sa("baseRetryDelayMs",5e3,y),this.Za=Sa("retryDelaySeedMs",1e4,y),this.Ta=Sa("forwardChannelMaxRetries",2,y),this.va=Sa("forwardChannelRequestTimeoutMs",2e4,y),this.ma=y&&y.xmlHttpFactory||void 0,this.Ua=y&&y.Rb||void 0,this.Aa=y&&y.useFetchStreams||!1,this.O=void 0,this.L=y&&y.supportsCrossDomainXhr||!1,this.M="",this.h=new tf(y&&y.concurrentRequestLimit),this.Ba=new Zs,this.S=y&&y.fastHandshake||!1,this.R=y&&y.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=y&&y.Pb||!1,y&&y.ua&&this.j.ua(),y&&y.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&y&&y.detectBufferingProxy||!1,this.ia=void 0,y&&y.longPollingTimeout&&y.longPollingTimeout>0&&(this.ia=y.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=eo.prototype,n.ka=8,n.I=1,n.connect=function(y,R,L,q){cn(0),this.W=y,this.H=R||{},L&&q!==void 0&&(this.H.OSID=L,this.H.OAID=q),this.F=this.X,this.J=Tg(this,null,this.W),Ea(this)};function pf(y){if(Kc(y),y.I==3){var R=y.V++,L=Mn(y.J);if(jt(L,"SID",y.M),jt(L,"RID",R),jt(L,"TYPE","terminate"),Il(y,L),R=new Ui(y,y.j,R),R.M=2,R.A=wl(Mn(L)),L=!1,s.navigator&&s.navigator.sendBeacon)try{L=s.navigator.sendBeacon(R.A.toString(),"")}catch{}!L&&s.Image&&(new Image().src=R.A,L=!0),L||(R.g=Ag(R.j,null),R.g.ea(R.A)),R.F=Date.now(),ga(R)}Eg(y)}function to(y){y.g&&(mf(y),y.g.cancel(),y.g=null)}function Kc(y){to(y),y.v&&(s.clearTimeout(y.v),y.v=null),Wc(y),y.h.cancel(),y.m&&(typeof y.m=="number"&&s.clearTimeout(y.m),y.m=null)}function Ea(y){if(!nf(y.h)&&!y.m){y.m=!0;var R=y.Ea;P||I(),N||(P(),N=!0),A.add(R,y),y.D=0}}function Xc(y,R){return ya(y.h)>=y.h.j-(y.m?1:0)?!1:y.m?(y.i=R.G.concat(y.i),!0):y.I==1||y.I==2||y.D>=(y.Sa?0:y.Ta)?!1:(y.m=fi(d(y.Ea,y,R),Sg(y,y.D)),y.D++,!0)}n.Ea=function(y){if(this.m)if(this.m=null,this.I==1){if(!y){this.V=Math.floor(Math.random()*1e5),y=this.V++;const ce=new Ui(this,this.j,y);let pe=this.o;if(this.U&&(pe?(pe=F(pe),ne(pe,this.U)):pe=this.U),this.u!==null||this.R||(ce.J=pe,pe=null),this.S)e:{for(var R=0,L=0;L<this.i.length;L++){t:{var q=this.i[L];if("__data__"in q.map&&(q=q.map.__data__,typeof q=="string")){q=q.length;break t}q=void 0}if(q===void 0)break;if(R+=q,R>4096){R=L;break e}if(R===4096||L===this.i.length-1){R=L+1;break e}}R=1e3}else R=1e3;R=bg(this,ce,R),L=Mn(this.J),jt(L,"RID",y),jt(L,"CVER",22),this.G&&jt(L,"X-HTTP-Session-Id",this.G),Il(this,L),pe&&(this.R?R="headers="+ts(gi(pe))+"&"+R:this.u&&Tl(L,this.u,pe)),rf(this.h,ce),this.Ra&&jt(L,"TYPE","init"),this.S?(jt(L,"$req",R),jt(L,"SID","null"),ce.U=!0,pa(ce,L,null)):pa(ce,L,R),this.I=2}}else this.I==3&&(y?gf(this,y):this.i.length==0||nf(this.h)||gf(this))};function gf(y,R){var L;R?L=R.l:L=y.V++;const q=Mn(y.J);jt(q,"SID",y.M),jt(q,"RID",L),jt(q,"AID",y.K),Il(y,q),y.u&&y.o&&Tl(q,y.u,y.o),L=new Ui(y,y.j,L,y.D+1),y.u===null&&(L.J=y.o),R&&(y.i=R.G.concat(y.i)),R=bg(y,L,1e3),L.H=Math.round(y.va*.5)+Math.round(y.va*.5*Math.random()),rf(y.h,L),pa(L,q,R)}function Il(y,R){y.H&&ie(y.H,function(L,q){jt(R,q,L)}),y.l&&ie({},function(L,q){jt(R,q,L)})}function bg(y,R,L){L=Math.min(y.i.length,L);const q=y.l?d(y.l.Ka,y.l,y):null;e:{var ce=y.i;let ct=-1;for(;;){const wn=["count="+L];ct==-1?L>0?(ct=ce[0].g,wn.push("ofs="+ct)):ct=0:wn.push("ofs="+ct);let Nt=!0;for(let tn=0;tn<L;tn++){var pe=ce[tn].g;const mi=ce[tn].map;if(pe-=ct,pe<0)ct=Math.max(0,ce[tn].g-100),Nt=!1;else try{pe="req"+pe+"_"||"";try{var ke=mi instanceof Map?mi:Object.entries(mi);for(const[Aa,Hi]of ke){let Yi=Hi;c(Hi)&&(Yi=Rn(Hi)),wn.push(pe+Aa+"="+encodeURIComponent(Yi))}}catch(Aa){throw wn.push(pe+"type="+encodeURIComponent("_badmap")),Aa}}catch{q&&q(mi)}}if(Nt){ke=wn.join("&");break e}}ke=void 0}return y=y.i.splice(0,L),R.G=y,ke}function xg(y){if(!y.g&&!y.v){y.Y=1;var R=y.Da;P||I(),N||(P(),N=!0),A.add(R,y),y.A=0}}function Rl(y){return y.g||y.v||y.A>=3?!1:(y.Y++,y.v=fi(d(y.Da,y),Sg(y,y.A)),y.A++,!0)}n.Da=function(){if(this.v=null,_g(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var y=4*this.T;this.j.info("BP detection timer enabled: "+y),this.B=fi(d(this.Wa,this),y)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,cn(10),to(this),_g(this))};function mf(y){y.B!=null&&(s.clearTimeout(y.B),y.B=null)}function _g(y){y.g=new Ui(y,y.j,"rpc",y.Y),y.u===null&&(y.g.J=y.o),y.g.P=0;var R=Mn(y.na);jt(R,"RID","rpc"),jt(R,"SID",y.M),jt(R,"AID",y.K),jt(R,"CI",y.F?"0":"1"),!y.F&&y.ia&&jt(R,"TO",y.ia),jt(R,"TYPE","xmlhttp"),Il(y,R),y.u&&y.o&&Tl(R,y.u,y.o),y.O&&(y.g.H=y.O);var L=y.g;y=y.ba,L.M=1,L.A=wl(Mn(R)),L.u=null,L.R=!0,Uc(L,y)}n.Va=function(){this.C!=null&&(this.C=null,to(this),Rl(this),cn(19))};function Wc(y){y.C!=null&&(s.clearTimeout(y.C),y.C=null)}function wg(y,R){var L=null;if(y.g==R){Wc(y),mf(y),y.g=null;var q=2}else if(ba(y.h,R))L=R.G,af(y.h,R),q=1;else return;if(y.I!=0){if(R.o)if(q==1){L=R.u?R.u.length:0,R=Date.now()-R.F;var ce=y.D;q=Hs(),Ue(q,new Xr(q,L)),Ea(y)}else xg(y);else if(ce=R.m,ce==3||ce==0&&R.X>0||!(q==1&&Xc(y,R)||q==2&&Rl(y)))switch(L&&L.length>0&&(R=y.h,R.i=R.i.concat(L)),ce){case 1:Ta(y,5);break;case 4:Ta(y,10);break;case 3:Ta(y,6);break;default:Ta(y,2)}}}function Sg(y,R){let L=y.Qa+Math.floor(Math.random()*y.Za);return y.isActive()||(L*=2),L*R}function Ta(y,R){if(y.j.info("Error code "+R),R==2){var L=d(y.bb,y),q=y.Ua;const ce=!q;q=new Qr(q||"//www.google.com/images/cleardot.gif"),s.location&&s.location.protocol=="http"||Jn(q,"https"),wl(q),ce?Gi(q.toString(),L):df(q.toString(),L)}else cn(2);y.I=0,y.l&&y.l.pa(R),Eg(y),Kc(y)}n.bb=function(y){y?(this.j.info("Successfully pinged google.com"),cn(2)):(this.j.info("Failed to ping google.com"),cn(1))};function Eg(y){if(y.I=0,y.ja=[],y.l){const R=sf(y.h);(R.length!=0||y.i.length!=0)&&(_(y.ja,R),_(y.ja,y.i),y.h.i.length=0,b(y.i),y.i.length=0),y.l.oa()}}function Tg(y,R,L){var q=L instanceof Qr?Mn(L):new Qr(L);if(q.g!="")R&&(q.g=R+"."+q.g),Ks(q,q.u);else{var ce=s.location;q=ce.protocol,R=R?R+"."+ce.hostname:ce.hostname,ce=+ce.port;const pe=new Qr(null);q&&Jn(pe,q),R&&(pe.g=R),ce&&Ks(pe,ce),L&&(pe.h=L),q=pe}return L=y.G,R=y.wa,L&&R&&jt(q,L,R),jt(q,"VER",y.ka),Il(y,q),q}function Ag(y,R,L){if(R&&!y.L)throw Error("Can't create secondary domain capable XhrIo object.");return R=y.Aa&&!y.ma?new Ft(new _a({ab:L})):new Ft(y.ma),R.Fa(y.L),R}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Cg(){}n=Cg.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function no(){}no.prototype.g=function(y,R){return new wr(y,R)};function wr(y,R){Pe.call(this),this.g=new eo(R),this.l=y,this.h=R&&R.messageUrlParams||null,y=R&&R.messageHeaders||null,R&&R.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=R&&R.initMessageHeaders||null,R&&R.messageContentType&&(y?y["X-WebChannel-Content-Type"]=R.messageContentType:y={"X-WebChannel-Content-Type":R.messageContentType}),R&&R.sa&&(y?y["X-WebChannel-Client-Profile"]=R.sa:y={"X-WebChannel-Client-Profile":R.sa}),this.g.U=y,(y=R&&R.Qb)&&!O(y)&&(this.g.u=y),this.A=R&&R.supportsCrossDomainXhr||!1,this.v=R&&R.sendRawJson||!1,(R=R&&R.httpSessionIdParam)&&!O(R)&&(this.g.G=R,y=this.h,y!==null&&R in y&&(y=this.h,R in y&&delete y[R])),this.j=new is(this)}p(wr,Pe),wr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},wr.prototype.close=function(){pf(this.g)},wr.prototype.o=function(y){var R=this.g;if(typeof y=="string"){var L={};L.__data__=y,y=L}else this.v&&(L={},L.__data__=Rn(y),y=L);R.i.push(new Nn(R.Ya++,y)),R.I==3&&Ea(R)},wr.prototype.N=function(){this.g.l=null,delete this.j,pf(this.g),delete this.g,wr.Z.N.call(this)};function Ig(y){kn.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var R=y.__sm__;if(R){e:{for(const L in R){y=L;break e}y=void 0}(this.i=y)&&(y=this.i,R=R!==null&&y in R?R[y]:void 0),this.data=R}else this.data=y}p(Ig,kn);function Rg(){dr.call(this),this.status=1}p(Rg,dr);function is(y){this.g=y}p(is,Cg),is.prototype.ra=function(){Ue(this.g,"a")},is.prototype.qa=function(y){Ue(this.g,new Ig(y))},is.prototype.pa=function(y){Ue(this.g,new Rg)},is.prototype.oa=function(){Ue(this.g,"b")},no.prototype.createWebChannel=no.prototype.g,wr.prototype.send=wr.prototype.o,wr.prototype.open=wr.prototype.m,wr.prototype.close=wr.prototype.close,JM=function(){return new no},ZM=function(){return Hs()},QM=on,J1={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},xl.NO_ERROR=0,xl.TIMEOUT=8,xl.HTTP_ERROR=6,p0=xl,Jd.COMPLETE="complete",WM=Jd,$s.EventType=Kr,Kr.OPEN="a",Kr.CLOSE="b",Kr.ERROR="c",Kr.MESSAGE="d",Pe.prototype.listen=Pe.prototype.J,fh=$s,Ft.prototype.listenOnce=Ft.prototype.K,Ft.prototype.getLastError=Ft.prototype.Ha,Ft.prototype.getLastErrorCode=Ft.prototype.ya,Ft.prototype.getStatus=Ft.prototype.ca,Ft.prototype.getResponseJson=Ft.prototype.La,Ft.prototype.getResponseText=Ft.prototype.la,Ft.prototype.send=Ft.prototype.ea,Ft.prototype.setWithCredentials=Ft.prototype.Fa,XM=Ft}).apply(typeof jm<"u"?jm:typeof self<"u"?self:typeof window<"u"?window:{});const L2="@firebase/firestore",B2="4.9.2";class pr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}pr.UNAUTHENTICATED=new pr(null),pr.GOOGLE_CREDENTIALS=new pr("google-credentials-uid"),pr.FIRST_PARTY=new pr("first-party-uid"),pr.MOCK_USER=new pr("mock-user");let Vd="12.3.0";const wc=new Cw("@firebase/firestore");function Pu(){return wc.logLevel}function Ae(n,...e){if(wc.logLevel<=wt.DEBUG){const t=e.map($w);wc.debug(`Firestore (${Vd}): ${n}`,...t)}}function An(n,...e){if(wc.logLevel<=wt.ERROR){const t=e.map($w);wc.error(`Firestore (${Vd}): ${n}`,...t)}}function Qh(n,...e){if(wc.logLevel<=wt.WARN){const t=e.map($w);wc.warn(`Firestore (${Vd}): ${n}`,...t)}}function $w(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Ve(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,eP(n,r,t)}function eP(n,e,t){let r=`FIRESTORE (${Vd}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw An(r),new Error(r)}function $e(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||eP(e,i,r)}function Fe(n,e){return n}const ve={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Re extends Us{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ua{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class I7{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class R7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(pr.UNAUTHENTICATED)))}shutdown(){}}class k7{constructor(e){this.t=e,this.currentUser=pr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){$e(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let a=new Ua;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Ua,e.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const u=a;e.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},c=u=>{Ae("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit((u=>c(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(Ae("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Ua)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Ae("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?($e(typeof r.accessToken=="string",31837,{l:r}),new I7(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return $e(e===null||typeof e=="string",2055,{h:e}),new pr(e)}}class D7{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=pr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class N7{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new D7(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(pr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class U2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class M7{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ki(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){$e(this.o===void 0,3512);const r=a=>{a.error!=null&&Ae("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const s=a.token!==this.m;return this.m=a.token,Ae("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>r(a)))};const i=a=>{Ae("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):Ae("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new U2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?($e(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new U2(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function P7(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class Hw{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=P7(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+=e.charAt(i[a]%62))}return r}}function it(n,e){return n<e?-1:n>e?1:0}function e_(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),a=e.charAt(r);if(i!==a)return Yx(i)===Yx(a)?it(i,a):Yx(i)?1:-1}return it(n.length,e.length)}const O7=55296,j7=57343;function Yx(n){const e=n.charCodeAt(0);return e>=O7&&e<=j7}function od(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function tP(n){return n+"\0"}const F2="__name__";class Na{constructor(e,t,r){t===void 0?t=0:t>e.length&&Ve(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Ve(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Na.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Na?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=Na.compareSegments(e.get(i),t.get(i));if(a!==0)return a}return it(e.length,t.length)}static compareSegments(e,t){const r=Na.isNumericId(e),i=Na.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Na.extractNumericId(e).compare(Na.extractNumericId(t)):e_(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ko.fromString(e.substring(4,e.length-2))}}class Pt extends Na{construct(e,t,r){return new Pt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Re(ve.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new Pt(t)}static emptyPath(){return new Pt([])}}const V7=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class dn extends Na{construct(e,t,r){return new dn(e,t,r)}static isValidIdentifier(e){return V7.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),dn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===F2}static keyField(){return new dn([F2])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(r.length===0)throw new Re(ve.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let s=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new Re(ve.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Re(ve.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(s=!s,i++):c!=="."||s?(r+=c,i++):(a(),i++)}if(a(),s)throw new Re(ve.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new dn(t)}static emptyPath(){return new dn([])}}class De{constructor(e){this.path=e}static fromPath(e){return new De(Pt.fromString(e))}static fromName(e){return new De(Pt.fromString(e).popFirst(5))}static empty(){return new De(Pt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Pt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Pt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new De(new Pt(e.slice()))}}function nP(n,e,t){if(!t)throw new Re(ve.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function z7(n,e,t,r){if(e===!0&&r===!0)throw new Re(ve.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function G2(n){if(!De.isDocumentKey(n))throw new Re(ve.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function q2(n){if(De.isDocumentKey(n))throw new Re(ve.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function rP(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Fv(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ve(12329,{type:typeof n})}function Fr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Re(ve.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Fv(n);throw new Re(ve.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Fn(n,e){const t={typeString:n};return e&&(t.value=e),t}function jp(n,e){if(!rP(n))throw new Re(ve.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const s=n[r];if(i&&typeof s!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(a!==void 0&&s!==a.value){t=`Expected '${r}' field to equal '${a.value}'`;break}}if(t)throw new Re(ve.INVALID_ARGUMENT,t);return!0}const $2=-62135596800,H2=1e6;class pt{static now(){return pt.fromMillis(Date.now())}static fromDate(e){return pt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*H2);return new pt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Re(ve.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Re(ve.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<$2)throw new Re(ve.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Re(ve.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/H2}_compareTo(e){return this.seconds===e.seconds?it(this.nanoseconds,e.nanoseconds):it(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:pt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(jp(e,pt._jsonSchema))return new pt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-$2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}pt._jsonSchemaVersion="firestore/timestamp/1.0",pt._jsonSchema={type:Fn("string",pt._jsonSchemaVersion),seconds:Fn("number"),nanoseconds:Fn("number")};class Xe{static fromTimestamp(e){return new Xe(e)}static min(){return new Xe(new pt(0,0))}static max(){return new Xe(new pt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ld=-1;class Y0{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function t_(n){return n.fields.find((e=>e.kind===2))}function Xl(n){return n.fields.filter((e=>e.kind!==2))}Y0.UNKNOWN_ID=-1;class g0{constructor(e,t){this.fieldPath=e,this.kind=t}}class Zh{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Zh(0,ci.min())}}function iP(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Xe.fromTimestamp(r===1e9?new pt(t+1,0):new pt(t,r));return new ci(i,De.empty(),e)}function aP(n){return new ci(n.readTime,n.key,ld)}class ci{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ci(Xe.min(),De.empty(),ld)}static max(){return new ci(Xe.max(),De.empty(),ld)}}function Yw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=De.comparator(n.documentKey,e.documentKey),t!==0?t:it(n.largestBatchId,e.largestBatchId))}const sP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class oP{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function fl(n){if(n.code!==ve.FAILED_PRECONDITION||n.message!==sP)throw n;Ae("LocalStore","Unexpectedly lost primary lease")}class le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ve(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new le(((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof le?t:le.resolve(t)}catch(t){return le.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):le.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):le.reject(t)}static resolve(e){return new le(((t,r)=>{t(e)}))}static reject(e){return new le(((t,r)=>{r(e)}))}static waitFor(e){return new le(((t,r)=>{let i=0,a=0,s=!1;e.forEach((c=>{++i,c.next((()=>{++a,s&&a===i&&t()}),(u=>r(u)))})),s=!0,a===i&&t()}))}static or(e){let t=le.resolve(!1);for(const r of e)t=t.next((i=>i?le.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,a)=>{r.push(t.call(this,i,a))})),this.waitFor(r)}static mapArray(e,t){return new le(((r,i)=>{const a=e.length,s=new Array(a);let c=0;for(let u=0;u<a;u++){const d=u;t(e[d]).next((h=>{s[d]=h,++c,c===a&&r(s)}),(h=>i(h)))}}))}static doWhile(e,t){return new le(((r,i)=>{const a=()=>{e()===!0?t().next((()=>{a()}),i):r()};a()}))}}const ai="SimpleDb";class Gv{static open(e,t,r,i){try{return new Gv(t,e.transaction(i,r))}catch(a){throw new Eh(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Ua,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Eh(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=Kw(r.target.error);this.S.reject(new Eh(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ae(ai,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new B7(t)}}class Xo{static delete(e){return Ae(ai,"Removing database:",e),Jl(RN().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!jN())return!1;if(Xo.F())return!0;const e=Wn(),t=Xo.M(e),r=0<t&&t<10,i=lP(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,Xo.M(Wn())===12.2&&An("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Ae(ai,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=a=>{const s=a.target.result;t(s)},i.onblocked=()=>{r(new Eh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=a=>{const s=a.target.error;s.name==="VersionError"?r(new Re(ve.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s.name==="InvalidStateError"?r(new Re(ve.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+s)):r(new Eh(e,s))},i.onupgradeneeded=a=>{Ae(ai,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const s=a.target.result;this.N.k(s,i.transaction,a.oldVersion,this.version).next((()=>{Ae(ai,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const a=t==="readonly";let s=0;for(;;){++s;try{this.db=await this.L(e);const c=Gv.open(this.db,e,a?"readonly":"readwrite",r),u=i(c).next((d=>(c.C(),d))).catch((d=>(c.abort(d),le.reject(d)))).toPromise();return u.catch((()=>{})),await c.D,u}catch(c){const u=c,d=u.name!=="FirebaseError"&&s<3;if(Ae(ai,"Transaction failed with error:",u.message,"Retrying:",d),this.close(),!d)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function lP(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class L7{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Jl(this.U.delete())}}class Eh extends Re{constructor(e,t){super(ve.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function hl(n){return n.name==="IndexedDbTransactionError"}class B7{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Ae(ai,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Ae(ai,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Jl(r)}add(e){return Ae(ai,"ADD",this.store.name,e,e),Jl(this.store.add(e))}get(e){return Jl(this.store.get(e)).next((t=>(t===void 0&&(t=null),Ae(ai,"GET",this.store.name,e,t),t)))}delete(e){return Ae(ai,"DELETE",this.store.name,e),Jl(this.store.delete(e))}count(){return Ae(ai,"COUNT",this.store.name),Jl(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const a=i.getAll(r.range);return new le(((s,c)=>{a.onerror=u=>{c(u.target.error)},a.onsuccess=u=>{s(u.target.result)}}))}{const a=this.cursor(r),s=[];return this.H(a,((c,u)=>{s.push(u)})).next((()=>s))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new le(((i,a)=>{r.onerror=s=>{a(s.target.error)},r.onsuccess=s=>{i(s.target.result)}}))}Z(e,t){Ae(ai,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((a,s,c)=>c.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new le(((r,i)=>{t.onerror=a=>{const s=Kw(a.target.error);i(s)},t.onsuccess=a=>{const s=a.target.result;s?e(s.primaryKey,s.value).next((c=>{c?s.continue():r()})):r()}}))}H(e,t){const r=[];return new le(((i,a)=>{e.onerror=s=>{a(s.target.error)},e.onsuccess=s=>{const c=s.target.result;if(!c)return void i();const u=new L7(c),d=t(c.primaryKey,c.value,u);if(d instanceof le){const h=d.catch((p=>(u.done(),le.reject(p))));r.push(h)}u.isDone?i():u.G===null?c.continue():c.continue(u.G)}})).next((()=>le.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Jl(n){return new le(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=Kw(r.target.error);t(i)}}))}let Y2=!1;function Kw(n){const e=Xo.M(Wn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Re("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Y2||(Y2=!0,setTimeout((()=>{throw r}),0)),r}}return n}const Th="IndexBackfiller";class U7{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Ae(Th,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Ae(Th,`Documents written: ${t}`)}catch(t){hl(t)?Ae(Th,"Ignoring IndexedDB error during index backfill: ",t):await fl(t)}await this.re(6e4)}))}}class F7{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,a=!0;return le.doWhile((()=>a===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((s=>{if(s!==null&&!r.has(s))return Ae(Th,`Processing collection: ${s}`),this.oe(e,s,i).next((c=>{i-=c,r.add(s)}));a=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((a=>{const s=a.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next((()=>this._e(i,a))).next((c=>(Ae(Th,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c)))).next((()=>s.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,a)=>{const s=aP(a);Yw(s,r)>0&&(r=s)})),new ci(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Lr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Lr.ce=-1;const fc=-1;function qv(n){return n==null}function Jh(n){return n===0&&1/n==-1/0}function cP(n){return typeof n=="number"&&Number.isInteger(n)&&!Jh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const K0="";function yr(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=K2(e)),e=G7(n.get(t),e);return K2(e)}function G7(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="";break;case K0:t+="";break;default:t+=a}}return t}function K2(n){return n+K0+""}function Oa(n){const e=n.length;if($e(e>=2,64408,{path:n}),e===2)return $e(n.charAt(0)===K0&&n.charAt(1)==="",56145,{path:n}),Pt.emptyPath();const t=e-2,r=[];let i="";for(let a=0;a<e;){const s=n.indexOf(K0,a);switch((s<0||s>t)&&Ve(50515,{path:n}),n.charAt(s+1)){case"":const c=n.substring(a,s);let u;i.length===0?u=c:(i+=c,u=i,i=""),r.push(u);break;case"":i+=n.substring(a,s),i+="\0";break;case"":i+=n.substring(a,s+1);break;default:Ve(61167,{path:n})}a=s+2}return new Pt(r)}const Wl="remoteDocuments",Vp="owner",Cu="owner",ep="mutationQueues",q7="userId",Zi="mutations",X2="batchId",oc="userMutationsIndex",W2=["userId","batchId"];function m0(n,e){return[n,yr(e)]}function uP(n,e,t){return[n,yr(e),t]}const $7={},cd="documentMutations",X0="remoteDocumentsV14",H7=["prefixPath","collectionGroup","readTime","documentId"],v0="documentKeyIndex",Y7=["prefixPath","collectionGroup","documentId"],dP="collectionGroupIndex",K7=["collectionGroup","readTime","prefixPath","documentId"],tp="remoteDocumentGlobal",n_="remoteDocumentGlobalKey",ud="targets",fP="queryTargetsIndex",X7=["canonicalId","targetId"],dd="targetDocuments",W7=["targetId","path"],Xw="documentTargetsIndex",Q7=["path","targetId"],W0="targetGlobalKey",hc="targetGlobal",np="collectionParents",Z7=["collectionId","parent"],fd="clientMetadata",J7="clientId",$v="bundles",eG="bundleId",Hv="namedQueries",tG="name",Ww="indexConfiguration",nG="indexId",r_="collectionGroupIndex",rG="collectionGroup",Ah="indexState",iG=["indexId","uid"],hP="sequenceNumberIndex",aG=["uid","sequenceNumber"],Ch="indexEntries",sG=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],pP="documentKeyIndex",oG=["indexId","uid","orderedDocumentKey"],Yv="documentOverlays",lG=["userId","collectionPath","documentId"],i_="collectionPathOverlayIndex",cG=["userId","collectionPath","largestBatchId"],gP="collectionGroupOverlayIndex",uG=["userId","collectionGroup","largestBatchId"],Qw="globals",dG="name",mP=[ep,Zi,cd,Wl,ud,Vp,hc,dd,fd,tp,np,$v,Hv],fG=[...mP,Yv],vP=[ep,Zi,cd,X0,ud,Vp,hc,dd,fd,tp,np,$v,Hv,Yv],yP=vP,Zw=[...yP,Ww,Ah,Ch],hG=Zw,bP=[...Zw,Qw],pG=bP;class a_ extends oP{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Qn(n,e){const t=Fe(n);return Xo.O(t.le,e)}function Q2(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function pl(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function xP(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Qt{constructor(e,t){this.comparator=e,this.root=t||cr.EMPTY}insert(e,t){return new Qt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,cr.BLACK,null,null))}remove(e){return new Qt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,cr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vm(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vm(this.root,e,this.comparator,!0)}}class Vm{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class cr{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=r??cr.RED,this.left=i??cr.EMPTY,this.right=a??cr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new cr(e??this.key,t??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):a===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return cr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return cr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,cr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,cr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ve(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ve(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ve(27949);return e+(this.isRed()?0:1)}}cr.EMPTY=null,cr.RED=!0,cr.BLACK=!1;cr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ve(57766)}get value(){throw Ve(16141)}get color(){throw Ve(16727)}get left(){throw Ve(29726)}get right(){throw Ve(36894)}copy(e,t,r,i,a){return this}insert(e,t,r){return new cr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ut{constructor(e){this.comparator=e,this.data=new Qt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Z2(this.data.getIterator())}getIteratorFrom(e){return new Z2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Ut)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ut(this.comparator);return t.data=e,t}}class Z2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Iu(n){return n.hasNext()?n.getNext():void 0}class Br{constructor(e){this.fields=e,e.sort(dn.comparator)}static empty(){return new Br([])}unionWith(e){let t=new Ut(dn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Br(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return od(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class _P extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Cn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new _P("Invalid base64 string: "+a):a}})(e);return new Cn(t)}static fromUint8Array(e){const t=(function(i){let a="";for(let s=0;s<i.length;++s)a+=String.fromCharCode(i[s]);return a})(e);return new Cn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return it(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Cn.EMPTY_BYTE_STRING=new Cn("");const gG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Os(n){if($e(!!n,39018),typeof n=="string"){let e=0;const t=gG.exec(n);if($e(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:rn(n.seconds),nanos:rn(n.nanos)}}function rn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function js(n){return typeof n=="string"?Cn.fromBase64String(n):Cn.fromUint8Array(n)}const wP="server_timestamp",SP="__type__",EP="__previous_value__",TP="__local_write_time__";function Jw(n){return(n?.mapValue?.fields||{})[SP]?.stringValue===wP}function Kv(n){const e=n.mapValue.fields[EP];return Jw(e)?Kv(e):e}function rp(n){const e=Os(n.mapValue.fields[TP].timestampValue);return new pt(e.seconds,e.nanos)}class mG{constructor(e,t,r,i,a,s,c,u,d,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=s,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=h}}const Q0="(default)";class Sc{constructor(e,t){this.projectId=e,this.database=t||Q0}static empty(){return new Sc("","")}get isDefaultDatabase(){return this.database===Q0}isEqual(e){return e instanceof Sc&&e.projectId===this.projectId&&e.database===this.database}}const eS="__type__",AP="__max__",Lo={mapValue:{fields:{__type__:{stringValue:AP}}}},tS="__vector__",hd="value",y0={nullValue:"NULL_VALUE"};function el(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Jw(n)?4:CP(n)?9007199254740991:Xv(n)?10:11:Ve(28295,{value:n})}function Ya(n,e){if(n===e)return!0;const t=el(n);if(t!==el(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return rp(n).isEqual(rp(e));case 3:return(function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const s=Os(i.timestampValue),c=Os(a.timestampValue);return s.seconds===c.seconds&&s.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,a){return js(i.bytesValue).isEqual(js(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,a){return rn(i.geoPointValue.latitude)===rn(a.geoPointValue.latitude)&&rn(i.geoPointValue.longitude)===rn(a.geoPointValue.longitude)})(n,e);case 2:return(function(i,a){if("integerValue"in i&&"integerValue"in a)return rn(i.integerValue)===rn(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const s=rn(i.doubleValue),c=rn(a.doubleValue);return s===c?Jh(s)===Jh(c):isNaN(s)&&isNaN(c)}return!1})(n,e);case 9:return od(n.arrayValue.values||[],e.arrayValue.values||[],Ya);case 10:case 11:return(function(i,a){const s=i.mapValue.fields||{},c=a.mapValue.fields||{};if(Q2(s)!==Q2(c))return!1;for(const u in s)if(s.hasOwnProperty(u)&&(c[u]===void 0||!Ya(s[u],c[u])))return!1;return!0})(n,e);default:return Ve(52216,{left:n})}}function ip(n,e){return(n.values||[]).find((t=>Ya(t,e)))!==void 0}function tl(n,e){if(n===e)return 0;const t=el(n),r=el(e);if(t!==r)return it(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return it(n.booleanValue,e.booleanValue);case 2:return(function(a,s){const c=rn(a.integerValue||a.doubleValue),u=rn(s.integerValue||s.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1})(n,e);case 3:return J2(n.timestampValue,e.timestampValue);case 4:return J2(rp(n),rp(e));case 5:return e_(n.stringValue,e.stringValue);case 6:return(function(a,s){const c=js(a),u=js(s);return c.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(a,s){const c=a.split("/"),u=s.split("/");for(let d=0;d<c.length&&d<u.length;d++){const h=it(c[d],u[d]);if(h!==0)return h}return it(c.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,s){const c=it(rn(a.latitude),rn(s.latitude));return c!==0?c:it(rn(a.longitude),rn(s.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return eR(n.arrayValue,e.arrayValue);case 10:return(function(a,s){const c=a.fields||{},u=s.fields||{},d=c[hd]?.arrayValue,h=u[hd]?.arrayValue,p=it(d?.values?.length||0,h?.values?.length||0);return p!==0?p:eR(d,h)})(n.mapValue,e.mapValue);case 11:return(function(a,s){if(a===Lo.mapValue&&s===Lo.mapValue)return 0;if(a===Lo.mapValue)return 1;if(s===Lo.mapValue)return-1;const c=a.fields||{},u=Object.keys(c),d=s.fields||{},h=Object.keys(d);u.sort(),h.sort();for(let p=0;p<u.length&&p<h.length;++p){const m=e_(u[p],h[p]);if(m!==0)return m;const b=tl(c[u[p]],d[h[p]]);if(b!==0)return b}return it(u.length,h.length)})(n.mapValue,e.mapValue);default:throw Ve(23264,{he:t})}}function J2(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return it(n,e);const t=Os(n),r=Os(e),i=it(t.seconds,r.seconds);return i!==0?i:it(t.nanos,r.nanos)}function eR(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const a=tl(t[i],r[i]);if(a)return a}return it(t.length,r.length)}function pd(n){return s_(n)}function s_(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=Os(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return js(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return De.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const a of t.values||[])i?i=!1:r+=",",r+=s_(a);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",a=!0;for(const s of r)a?a=!1:i+=",",i+=`${s}:${s_(t.fields[s])}`;return i+"}"})(n.mapValue):Ve(61005,{value:n})}function b0(n){switch(el(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Kv(n);return e?16+b0(e):16;case 5:return 2*n.stringValue.length;case 6:return js(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,a)=>i+b0(a)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return pl(r.fields,((a,s)=>{i+=a.length+b0(s)})),i})(n.mapValue);default:throw Ve(13486,{value:n})}}function ap(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function o_(n){return!!n&&"integerValue"in n}function sp(n){return!!n&&"arrayValue"in n}function tR(n){return!!n&&"nullValue"in n}function nR(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function x0(n){return!!n&&"mapValue"in n}function Xv(n){return(n?.mapValue?.fields||{})[eS]?.stringValue===tS}function Ih(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return pl(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Ih(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ih(n.arrayValue.values[t]);return e}return{...n}}function CP(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===AP}const IP={mapValue:{fields:{[eS]:{stringValue:tS},[hd]:{arrayValue:{}}}}};function vG(n){return"nullValue"in n?y0:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ap(Sc.empty(),De.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Xv(n)?IP:{mapValue:{}}:Ve(35942,{value:n})}function yG(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ap(Sc.empty(),De.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?IP:"mapValue"in n?Xv(n)?{mapValue:{}}:Lo:Ve(61959,{value:n})}function rR(n,e){const t=tl(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function iR(n,e){const t=tl(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class mr{constructor(e){this.value=e}static empty(){return new mr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!x0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ih(t)}setAll(e){let t=dn.emptyPath(),r={},i=[];e.forEach(((s,c)=>{if(!t.isImmediateParentOf(c)){const u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=c.popLast()}s?r[c.lastSegment()]=Ih(s):i.push(c.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());x0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ya(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];x0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){pl(t,((i,a)=>e[i]=a));for(const i of r)delete e[i]}clone(){return new mr(Ih(this.value))}}function RP(n){const e=[];return pl(n.fields,((t,r)=>{const i=new dn([t]);if(x0(r)){const a=RP(r.mapValue).fields;if(a.length===0)e.push(i);else for(const s of a)e.push(i.child(s))}else e.push(i)})),new Br(e)}class bn{constructor(e,t,r,i,a,s,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=a,this.data=s,this.documentState=c}static newInvalidDocument(e){return new bn(e,0,Xe.min(),Xe.min(),Xe.min(),mr.empty(),0)}static newFoundDocument(e,t,r,i){return new bn(e,1,t,Xe.min(),r,i,0)}static newNoDocument(e,t){return new bn(e,2,t,Xe.min(),Xe.min(),mr.empty(),0)}static newUnknownDocument(e,t){return new bn(e,3,t,Xe.min(),Xe.min(),mr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Xe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=mr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=mr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Xe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof bn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new bn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class gd{constructor(e,t){this.position=e,this.inclusive=t}}function aR(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],s=n.position[i];if(a.field.isKeyField()?r=De.comparator(De.fromName(s.referenceValue),t.key):r=tl(s,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function sR(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ya(n.position[t],e.position[t]))return!1;return!0}class op{constructor(e,t="asc"){this.field=e,this.dir=t}}function bG(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class kP{}class St extends kP{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new xG(e,t,r):t==="array-contains"?new SG(e,r):t==="in"?new jP(e,r):t==="not-in"?new EG(e,r):t==="array-contains-any"?new TG(e,r):new St(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new _G(e,r):new wG(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(tl(t,this.value)):t!==null&&el(this.value)===el(t)&&this.matchesComparison(tl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ve(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Bt extends kP{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Bt(e,t)}matches(e){return md(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function md(n){return n.op==="and"}function l_(n){return n.op==="or"}function nS(n){return DP(n)&&md(n)}function DP(n){for(const e of n.filters)if(e instanceof Bt)return!1;return!0}function c_(n){if(n instanceof St)return n.field.canonicalString()+n.op.toString()+pd(n.value);if(nS(n))return n.filters.map((e=>c_(e))).join(",");{const e=n.filters.map((t=>c_(t))).join(",");return`${n.op}(${e})`}}function NP(n,e){return n instanceof St?(function(r,i){return i instanceof St&&r.op===i.op&&r.field.isEqual(i.field)&&Ya(r.value,i.value)})(n,e):n instanceof Bt?(function(r,i){return i instanceof Bt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((a,s,c)=>a&&NP(s,i.filters[c])),!0):!1})(n,e):void Ve(19439)}function MP(n,e){const t=n.filters.concat(e);return Bt.create(t,n.op)}function PP(n){return n instanceof St?(function(t){return`${t.field.canonicalString()} ${t.op} ${pd(t.value)}`})(n):n instanceof Bt?(function(t){return t.op.toString()+" {"+t.getFilters().map(PP).join(" ,")+"}"})(n):"Filter"}class xG extends St{constructor(e,t,r){super(e,t,r),this.key=De.fromName(r.referenceValue)}matches(e){const t=De.comparator(e.key,this.key);return this.matchesComparison(t)}}class _G extends St{constructor(e,t){super(e,"in",t),this.keys=OP("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class wG extends St{constructor(e,t){super(e,"not-in",t),this.keys=OP("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function OP(n,e){return(e.arrayValue?.values||[]).map((t=>De.fromName(t.referenceValue)))}class SG extends St{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return sp(t)&&ip(t.arrayValue,this.value)}}class jP extends St{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ip(this.value.arrayValue,t)}}class EG extends St{constructor(e,t){super(e,"not-in",t)}matches(e){if(ip(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ip(this.value.arrayValue,t)}}class TG extends St{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!sp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>ip(this.value.arrayValue,r)))}}class AG{constructor(e,t=null,r=[],i=[],a=null,s=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=s,this.endAt=c,this.Te=null}}function u_(n,e=null,t=[],r=[],i=null,a=null,s=null){return new AG(n,e,t,r,i,a,s)}function Ec(n){const e=Fe(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>c_(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(a){return a.field.canonicalString()+a.dir})(r))).join(","),qv(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>pd(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>pd(r))).join(",")),e.Te=t}return e.Te}function zp(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!bG(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!NP(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!sR(n.startAt,e.startAt)&&sR(n.endAt,e.endAt)}function Z0(n){return De.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function J0(n,e){return n.filters.filter((t=>t instanceof St&&t.field.isEqual(e)))}function oR(n,e,t){let r=y0,i=!0;for(const a of J0(n,e)){let s=y0,c=!0;switch(a.op){case"<":case"<=":s=vG(a.value);break;case"==":case"in":case">=":s=a.value;break;case">":s=a.value,c=!1;break;case"!=":case"not-in":s=y0}rR({value:r,inclusive:i},{value:s,inclusive:c})<0&&(r=s,i=c)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const s=t.position[a];rR({value:r,inclusive:i},{value:s,inclusive:t.inclusive})<0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}function lR(n,e,t){let r=Lo,i=!0;for(const a of J0(n,e)){let s=Lo,c=!0;switch(a.op){case">=":case">":s=yG(a.value),c=!1;break;case"==":case"in":case"<=":s=a.value;break;case"<":s=a.value,c=!1;break;case"!=":case"not-in":s=Lo}iR({value:r,inclusive:i},{value:s,inclusive:c})>0&&(r=s,i=c)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const s=t.position[a];iR({value:r,inclusive:i},{value:s,inclusive:t.inclusive})>0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}class zd{constructor(e,t=null,r=[],i=[],a=null,s="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=s,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function VP(n,e,t,r,i,a,s,c){return new zd(n,e,t,r,i,a,s,c)}function Lp(n){return new zd(n)}function cR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function zP(n){return n.collectionGroup!==null}function Rh(n){const e=Fe(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let c=new Ut(dn.comparator);return s.filters.forEach((u=>{u.getFlattenedFilters().forEach((d=>{d.isInequality()&&(c=c.add(d.field))}))})),c})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new op(a,r))})),t.has(dn.keyField().canonicalString())||e.Ie.push(new op(dn.keyField(),r))}return e.Ie}function li(n){const e=Fe(n);return e.Ee||(e.Ee=CG(e,Rh(n))),e.Ee}function CG(n,e){if(n.limitType==="F")return u_(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const a=i.dir==="desc"?"asc":"desc";return new op(i.field,a)}));const t=n.endAt?new gd(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new gd(n.startAt.position,n.startAt.inclusive):null;return u_(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function d_(n,e){const t=n.filters.concat([e]);return new zd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ev(n,e,t){return new zd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Wv(n,e){return zp(li(n),li(e))&&n.limitType===e.limitType}function LP(n){return`${Ec(li(n))}|lt:${n.limitType}`}function Ou(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>PP(i))).join(", ")}]`),qv(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(s){return`${s.field.canonicalString()} (${s.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>pd(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>pd(i))).join(",")),`Target(${r})`})(li(n))}; limitType=${n.limitType})`}function Bp(n,e){return e.isFoundDocument()&&(function(r,i){const a=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):De.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)})(n,e)&&(function(r,i){for(const a of Rh(r))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const a of r.filters)if(!a.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(s,c,u){const d=aR(s,c,u);return s.inclusive?d<=0:d<0})(r.startAt,Rh(r),i)||r.endAt&&!(function(s,c,u){const d=aR(s,c,u);return s.inclusive?d>=0:d>0})(r.endAt,Rh(r),i))})(n,e)}function BP(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function UP(n){return(e,t)=>{let r=!1;for(const i of Rh(n)){const a=IG(i,e,t);if(a!==0)return a;r=r||i.field.isKeyField()}return 0}}function IG(n,e,t){const r=n.field.isKeyField()?De.comparator(e.key,t.key):(function(a,s,c){const u=s.data.field(a),d=c.data.field(a);return u!==null&&d!==null?tl(u,d):Ve(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ve(19790,{direction:n.dir})}}class Fs{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,a]of r)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){pl(this.inner,((t,r)=>{for(const[i,a]of r)e(i,a)}))}isEmpty(){return xP(this.inner)}size(){return this.innerSize}}const RG=new Qt(De.comparator);function oi(){return RG}const FP=new Qt(De.comparator);function hh(...n){let e=FP;for(const t of n)e=e.insert(t.key,t);return e}function GP(n){let e=FP;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function ja(){return kh()}function qP(){return kh()}function kh(){return new Fs((n=>n.toString()),((n,e)=>n.isEqual(e)))}const kG=new Qt(De.comparator),DG=new Ut(De.comparator);function gt(...n){let e=DG;for(const t of n)e=e.add(t);return e}const NG=new Ut(it);function rS(){return NG}function iS(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Jh(e)?"-0":e}}function $P(n){return{integerValue:""+n}}function MG(n,e){return cP(e)?$P(e):iS(n,e)}class Qv{constructor(){this._=void 0}}function PG(n,e,t){return n instanceof lp?(function(i,a){const s={fields:{[SP]:{stringValue:wP},[TP]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Jw(a)&&(a=Kv(a)),a&&(s.fields[EP]=a),{mapValue:s}})(t,e):n instanceof Tc?YP(n,e):n instanceof vd?KP(n,e):(function(i,a){const s=HP(i,a),c=uR(s)+uR(i.Ae);return o_(s)&&o_(i.Ae)?$P(c):iS(i.serializer,c)})(n,e)}function OG(n,e,t){return n instanceof Tc?YP(n,e):n instanceof vd?KP(n,e):t}function HP(n,e){return n instanceof cp?(function(r){return o_(r)||(function(a){return!!a&&"doubleValue"in a})(r)})(e)?e:{integerValue:0}:null}class lp extends Qv{}class Tc extends Qv{constructor(e){super(),this.elements=e}}function YP(n,e){const t=XP(e);for(const r of n.elements)t.some((i=>Ya(i,r)))||t.push(r);return{arrayValue:{values:t}}}class vd extends Qv{constructor(e){super(),this.elements=e}}function KP(n,e){let t=XP(e);for(const r of n.elements)t=t.filter((i=>!Ya(i,r)));return{arrayValue:{values:t}}}class cp extends Qv{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function uR(n){return rn(n.integerValue||n.doubleValue)}function XP(n){return sp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class WP{constructor(e,t){this.field=e,this.transform=t}}function jG(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Tc&&i instanceof Tc||r instanceof vd&&i instanceof vd?od(r.elements,i.elements,Ya):r instanceof cp&&i instanceof cp?Ya(r.Ae,i.Ae):r instanceof lp&&i instanceof lp})(n.transform,e.transform)}class VG{constructor(e,t){this.version=e,this.transformResults=t}}class Xn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Xn}static exists(e){return new Xn(void 0,e)}static updateTime(e){return new Xn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function _0(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Zv{}function QP(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Up(n.key,Xn.none()):new Ld(n.key,n.data,Xn.none());{const t=n.data,r=mr.empty();let i=new Ut(dn.comparator);for(let a of e.fields)if(!i.has(a)){let s=t.field(a);s===null&&a.length>1&&(a=a.popLast(),s=t.field(a)),s===null?r.delete(a):r.set(a,s),i=i.add(a)}return new Gs(n.key,r,new Br(i.toArray()),Xn.none())}}function zG(n,e,t){n instanceof Ld?(function(i,a,s){const c=i.value.clone(),u=fR(i.fieldTransforms,a,s.transformResults);c.setAll(u),a.convertToFoundDocument(s.version,c).setHasCommittedMutations()})(n,e,t):n instanceof Gs?(function(i,a,s){if(!_0(i.precondition,a))return void a.convertToUnknownDocument(s.version);const c=fR(i.fieldTransforms,a,s.transformResults),u=a.data;u.setAll(ZP(i)),u.setAll(c),a.convertToFoundDocument(s.version,u).setHasCommittedMutations()})(n,e,t):(function(i,a,s){a.convertToNoDocument(s.version).setHasCommittedMutations()})(0,e,t)}function Dh(n,e,t,r){return n instanceof Ld?(function(a,s,c,u){if(!_0(a.precondition,s))return c;const d=a.value.clone(),h=hR(a.fieldTransforms,u,s);return d.setAll(h),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof Gs?(function(a,s,c,u){if(!_0(a.precondition,s))return c;const d=hR(a.fieldTransforms,u,s),h=s.data;return h.setAll(ZP(a)),h.setAll(d),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((p=>p.field)))})(n,e,t,r):(function(a,s,c){return _0(a.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):c})(n,e,t)}function LG(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=HP(r.transform,i||null);a!=null&&(t===null&&(t=mr.empty()),t.set(r.field,a))}return t||null}function dR(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&od(r,i,((a,s)=>jG(a,s)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ld extends Zv{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Gs extends Zv{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function ZP(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function fR(n,e,t){const r=new Map;$e(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const a=n[i],s=a.transform,c=e.data.field(a.field);r.set(a.field,OG(s,c,t[i]))}return r}function hR(n,e,t){const r=new Map;for(const i of n){const a=i.transform,s=t.data.field(i.field);r.set(i.field,PG(a,s,e))}return r}class Up extends Zv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class JP extends Zv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class aS{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&zG(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Dh(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Dh(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=qP();return this.mutations.forEach((i=>{const a=e.get(i.key),s=a.overlayedDocument;let c=this.applyToLocalView(s,a.mutatedFields);c=t.has(i.key)?null:c;const u=QP(s,c);u!==null&&r.set(i.key,u),s.isValidDocument()||s.convertToNoDocument(Xe.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),gt())}isEqual(e){return this.batchId===e.batchId&&od(this.mutations,e.mutations,((t,r)=>dR(t,r)))&&od(this.baseMutations,e.baseMutations,((t,r)=>dR(t,r)))}}class sS{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){$e(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return kG})();const a=e.mutations;for(let s=0;s<a.length;s++)i=i.insert(a[s].key,r[s].version);return new sS(e,t,r,i)}}class oS{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class BG{constructor(e,t){this.count=e,this.unchangedNames=t}}var Ln,At;function UG(n){switch(n){case ve.OK:return Ve(64938);case ve.CANCELLED:case ve.UNKNOWN:case ve.DEADLINE_EXCEEDED:case ve.RESOURCE_EXHAUSTED:case ve.INTERNAL:case ve.UNAVAILABLE:case ve.UNAUTHENTICATED:return!1;case ve.INVALID_ARGUMENT:case ve.NOT_FOUND:case ve.ALREADY_EXISTS:case ve.PERMISSION_DENIED:case ve.FAILED_PRECONDITION:case ve.ABORTED:case ve.OUT_OF_RANGE:case ve.UNIMPLEMENTED:case ve.DATA_LOSS:return!0;default:return Ve(15467,{code:n})}}function eO(n){if(n===void 0)return An("GRPC error has no .code"),ve.UNKNOWN;switch(n){case Ln.OK:return ve.OK;case Ln.CANCELLED:return ve.CANCELLED;case Ln.UNKNOWN:return ve.UNKNOWN;case Ln.DEADLINE_EXCEEDED:return ve.DEADLINE_EXCEEDED;case Ln.RESOURCE_EXHAUSTED:return ve.RESOURCE_EXHAUSTED;case Ln.INTERNAL:return ve.INTERNAL;case Ln.UNAVAILABLE:return ve.UNAVAILABLE;case Ln.UNAUTHENTICATED:return ve.UNAUTHENTICATED;case Ln.INVALID_ARGUMENT:return ve.INVALID_ARGUMENT;case Ln.NOT_FOUND:return ve.NOT_FOUND;case Ln.ALREADY_EXISTS:return ve.ALREADY_EXISTS;case Ln.PERMISSION_DENIED:return ve.PERMISSION_DENIED;case Ln.FAILED_PRECONDITION:return ve.FAILED_PRECONDITION;case Ln.ABORTED:return ve.ABORTED;case Ln.OUT_OF_RANGE:return ve.OUT_OF_RANGE;case Ln.UNIMPLEMENTED:return ve.UNIMPLEMENTED;case Ln.DATA_LOSS:return ve.DATA_LOSS;default:return Ve(39323,{code:n})}}(At=Ln||(Ln={}))[At.OK=0]="OK",At[At.CANCELLED=1]="CANCELLED",At[At.UNKNOWN=2]="UNKNOWN",At[At.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",At[At.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",At[At.NOT_FOUND=5]="NOT_FOUND",At[At.ALREADY_EXISTS=6]="ALREADY_EXISTS",At[At.PERMISSION_DENIED=7]="PERMISSION_DENIED",At[At.UNAUTHENTICATED=16]="UNAUTHENTICATED",At[At.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",At[At.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",At[At.ABORTED=10]="ABORTED",At[At.OUT_OF_RANGE=11]="OUT_OF_RANGE",At[At.UNIMPLEMENTED=12]="UNIMPLEMENTED",At[At.INTERNAL=13]="INTERNAL",At[At.UNAVAILABLE=14]="UNAVAILABLE",At[At.DATA_LOSS=15]="DATA_LOSS";function FG(){return new TextEncoder}const GG=new Ko([4294967295,4294967295],0);function pR(n){const e=FG().encode(n),t=new KM;return t.update(e),new Uint8Array(t.digest())}function gR(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Ko([t,r],0),new Ko([i,a],0)]}class lS{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ph(`Invalid padding: ${t}`);if(r<0)throw new ph(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ph(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ph(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ko.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(Ko.fromNumber(r)));return i.compare(GG)===1&&(i=new Ko([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=pR(e),[r,i]=gR(t);for(let a=0;a<this.hashCount;a++){const s=this.ye(r,i,a);if(!this.we(s))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),s=new lS(a,i,t);return r.forEach((c=>s.insert(c))),s}insert(e){if(this.ge===0)return;const t=pR(e),[r,i]=gR(t);for(let a=0;a<this.hashCount;a++){const s=this.ye(r,i,a);this.Se(s)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class ph extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Fp{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Gp.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Fp(Xe.min(),i,new Qt(it),oi(),gt())}}class Gp{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Gp(r,t,gt(),gt(),gt())}}class w0{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class tO{constructor(e,t){this.targetId=e,this.Ce=t}}class nO{constructor(e,t,r=Cn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class mR{constructor(){this.ve=0,this.Fe=vR(),this.Me=Cn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=gt(),t=gt(),r=gt();return this.Fe.forEach(((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Ve(38017,{changeType:a})}})),new Gp(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=vR()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,$e(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class qG{constructor(e){this.Ge=e,this.ze=new Map,this.je=oi(),this.Je=zm(),this.He=zm(),this.Ye=new Qt(it)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Ve(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const a=i.target;if(Z0(a))if(r===0){const s=new De(a.path);this.et(t,s,bn.newNoDocument(s,Xe.min()))}else $e(r===1,20013,{expectedCount:r});else{const s=this._t(t);if(s!==r){const c=this.ut(e),u=c?this.ct(c,e,s):1;if(u!==0){this.it(t);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,d)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:a=0}=t;let s,c;try{s=js(r).toUint8Array()}catch(u){if(u instanceof _P)return Qh("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new lS(s,i,a)}catch(u){return Qh(u instanceof ph?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((a=>{const s=this.Ge.ht(),c=`projects/${s.projectId}/databases/${s.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.et(t,a,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((a,s)=>{const c=this.ot(s);if(c){if(a.current&&Z0(c.target)){const u=new De(c.target.path);this.It(u).has(s)||this.Et(s,u)||this.et(s,u,bn.newNoDocument(u,e))}a.Be&&(t.set(s,a.ke()),a.qe())}}));let r=gt();this.He.forEach(((a,s)=>{let c=!0;s.forEachWhile((u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(a))})),this.je.forEach(((a,s)=>s.setReadTime(e)));const i=new Fp(e,t,this.Ye,this.je,r);return this.je=oi(),this.Je=zm(),this.He=zm(),this.Ye=new Qt(it),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new mR,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Ut(it),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Ut(it),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ae("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new mR),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function zm(){return new Qt(De.comparator)}function vR(){return new Qt(De.comparator)}const $G={asc:"ASCENDING",desc:"DESCENDING"},HG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},YG={and:"AND",or:"OR"};class KG{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function f_(n,e){return n.useProto3Json||qv(e)?e:{value:e}}function yd(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function rO(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function XG(n,e){return yd(n,e.toTimestamp())}function Rr(n){return $e(!!n,49232),Xe.fromTimestamp((function(t){const r=Os(t);return new pt(r.seconds,r.nanos)})(n))}function cS(n,e){return h_(n,e).canonicalString()}function h_(n,e){const t=(function(i){return new Pt(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function iO(n){const e=Pt.fromString(n);return $e(hO(e),10190,{key:e.toString()}),e}function tv(n,e){return cS(n.databaseId,e.path)}function pc(n,e){const t=iO(e);if(t.get(1)!==n.databaseId.projectId)throw new Re(ve.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Re(ve.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new De(oO(t))}function aO(n,e){return cS(n.databaseId,e)}function sO(n){const e=iO(n);return e.length===4?Pt.emptyPath():oO(e)}function p_(n){return new Pt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function oO(n){return $e(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function yR(n,e,t){return{name:tv(n,e),fields:t.value.mapValue.fields}}function WG(n,e,t){const r=pc(n,e.name),i=Rr(e.updateTime),a=e.createTime?Rr(e.createTime):Xe.min(),s=new mr({mapValue:{fields:e.fields}}),c=bn.newFoundDocument(r,i,a,s);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function QG(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Ve(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=(function(d,h){return d.useProto3Json?($e(h===void 0||typeof h=="string",58123),Cn.fromBase64String(h||"")):($e(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Cn.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),s=e.targetChange.cause,c=s&&(function(d){const h=d.code===void 0?ve.UNKNOWN:eO(d.code);return new Re(h,d.message||"")})(s);t=new nO(r,i,a,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=pc(n,r.document.name),a=Rr(r.document.updateTime),s=r.document.createTime?Rr(r.document.createTime):Xe.min(),c=new mr({mapValue:{fields:r.document.fields}}),u=bn.newFoundDocument(i,a,s,c),d=r.targetIds||[],h=r.removedTargetIds||[];t=new w0(d,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=pc(n,r.document),a=r.readTime?Rr(r.readTime):Xe.min(),s=bn.newNoDocument(i,a),c=r.removedTargetIds||[];t=new w0([],c,s.key,s)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=pc(n,r.document),a=r.removedTargetIds||[];t=new w0([],a,i,null)}else{if(!("filter"in e))return Ve(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:a}=r,s=new BG(i,a),c=r.targetId;t=new tO(c,s)}}return t}function nv(n,e){let t;if(e instanceof Ld)t={update:yR(n,e.key,e.value)};else if(e instanceof Up)t={delete:tv(n,e.key)};else if(e instanceof Gs)t={update:yR(n,e.key,e.data),updateMask:rq(e.fieldMask)};else{if(!(e instanceof JP))return Ve(16599,{Vt:e.type});t={verify:tv(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(a,s){const c=s.transform;if(c instanceof lp)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Tc)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof vd)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof cp)return{fieldPath:s.field.canonicalString(),increment:c.Ae};throw Ve(20930,{transform:s.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,a){return a.updateTime!==void 0?{updateTime:XG(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Ve(27497)})(n,e.precondition)),t}function g_(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?Xn.updateTime(Rr(a.updateTime)):a.exists!==void 0?Xn.exists(a.exists):Xn.none()})(e.currentDocument):Xn.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(s,c){let u=null;if("setToServerValue"in c)$e(c.setToServerValue==="REQUEST_TIME",16630,{proto:c}),u=new lp;else if("appendMissingElements"in c){const h=c.appendMissingElements.values||[];u=new Tc(h)}else if("removeAllFromArray"in c){const h=c.removeAllFromArray.values||[];u=new vd(h)}else"increment"in c?u=new cp(s,c.increment):Ve(16584,{proto:c});const d=dn.fromServerFormat(c.fieldPath);return new WP(d,u)})(n,i))):[];if(e.update){e.update.name;const i=pc(n,e.update.name),a=new mr({mapValue:{fields:e.update.fields}});if(e.updateMask){const s=(function(u){const d=u.fieldPaths||[];return new Br(d.map((h=>dn.fromServerFormat(h))))})(e.updateMask);return new Gs(i,a,s,t,r)}return new Ld(i,a,t,r)}if(e.delete){const i=pc(n,e.delete);return new Up(i,t)}if(e.verify){const i=pc(n,e.verify);return new JP(i,t)}return Ve(1463,{proto:e})}function ZG(n,e){return n&&n.length>0?($e(e!==void 0,14353),n.map((t=>(function(i,a){let s=i.updateTime?Rr(i.updateTime):Rr(a);return s.isEqual(Xe.min())&&(s=Rr(a)),new VG(s,i.transformResults||[])})(t,e)))):[]}function lO(n,e){return{documents:[aO(n,e.path)]}}function cO(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=aO(n,i);const a=(function(d){if(d.length!==0)return fO(Bt.create(d,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const s=(function(d){if(d.length!==0)return d.map((h=>(function(m){return{field:ju(m.field),direction:eq(m.dir)}})(h)))})(e.orderBy);s&&(t.structuredQuery.orderBy=s);const c=f_(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:i}}function uO(n){let e=sO(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){$e(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let a=[];t.where&&(a=(function(p){const m=dO(p);return m instanceof Bt&&nS(m)?m.getFilters():[m]})(t.where));let s=[];t.orderBy&&(s=(function(p){return p.map((m=>(function(_){return new op(Vu(_.field),(function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(_.direction))})(m)))})(t.orderBy));let c=null;t.limit&&(c=(function(p){let m;return m=typeof p=="object"?p.value:p,qv(m)?null:m})(t.limit));let u=null;t.startAt&&(u=(function(p){const m=!!p.before,b=p.values||[];return new gd(b,m)})(t.startAt));let d=null;return t.endAt&&(d=(function(p){const m=!p.before,b=p.values||[];return new gd(b,m)})(t.endAt)),VP(e,i,s,a,c,"F",u,d)}function JG(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ve(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function dO(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Vu(t.unaryFilter.field);return St.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Vu(t.unaryFilter.field);return St.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Vu(t.unaryFilter.field);return St.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Vu(t.unaryFilter.field);return St.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ve(61313);default:return Ve(60726)}})(n):n.fieldFilter!==void 0?(function(t){return St.create(Vu(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ve(58110);default:return Ve(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Bt.create(t.compositeFilter.filters.map((r=>dO(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ve(1026)}})(t.compositeFilter.op))})(n):Ve(30097,{filter:n})}function eq(n){return $G[n]}function tq(n){return HG[n]}function nq(n){return YG[n]}function ju(n){return{fieldPath:n.canonicalString()}}function Vu(n){return dn.fromServerFormat(n.fieldPath)}function fO(n){return n instanceof St?(function(t){if(t.op==="=="){if(nR(t.value))return{unaryFilter:{field:ju(t.field),op:"IS_NAN"}};if(tR(t.value))return{unaryFilter:{field:ju(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(nR(t.value))return{unaryFilter:{field:ju(t.field),op:"IS_NOT_NAN"}};if(tR(t.value))return{unaryFilter:{field:ju(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ju(t.field),op:tq(t.op),value:t.value}}})(n):n instanceof Bt?(function(t){const r=t.getFilters().map((i=>fO(i)));return r.length===1?r[0]:{compositeFilter:{op:nq(t.op),filters:r}}})(n):Ve(54877,{filter:n})}function rq(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function hO(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Ts{constructor(e,t,r,i,a=Xe.min(),s=Xe.min(),c=Cn.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Ts(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ts(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ts(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ts(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class pO{constructor(e){this.yt=e}}function iq(n,e){let t;if(e.document)t=WG(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=De.fromSegments(e.noDocument.path),i=Cc(e.noDocument.readTime);t=bn.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ve(56709);{const r=De.fromSegments(e.unknownDocument.path),i=Cc(e.unknownDocument.version);t=bn.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const a=new pt(i[0],i[1]);return Xe.fromTimestamp(a)})(e.readTime)),t}function bR(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:rv(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(a,s){return{name:tv(a,s.key),fields:s.data.value.mapValue.fields,updateTime:yd(a,s.version.toTimestamp()),createTime:yd(a,s.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Ac(e.version)};else{if(!e.isUnknownDocument())return Ve(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Ac(e.version)}}return r}function rv(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ac(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Cc(n){const e=new pt(n.seconds,n.nanoseconds);return Xe.fromTimestamp(e)}function ec(n,e){const t=(e.baseMutations||[]).map((a=>g_(n.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const s=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const c=e.mutations[a+1];s.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const r=e.mutations.map((a=>g_(n.yt,a))),i=pt.fromMillis(e.localWriteTimeMs);return new aS(e.batchId,i,t,r)}function gh(n){const e=Cc(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Cc(n.lastLimboFreeSnapshotVersion):Xe.min();let r;return r=(function(a){return a.documents!==void 0})(n.query)?(function(a){const s=a.documents.length;return $e(s===1,1966,{count:s}),li(Lp(sO(a.documents[0])))})(n.query):(function(a){return li(uO(a))})(n.query),new Ts(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Cn.fromBase64String(n.resumeToken))}function gO(n,e){const t=Ac(e.snapshotVersion),r=Ac(e.lastLimboFreeSnapshotVersion);let i;i=Z0(e.target)?lO(n.yt,e.target):cO(n.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ec(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function mO(n){const e=uO({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ev(e,e.limit,"L"):e}function Kx(n,e){return new oS(e.largestBatchId,g_(n.yt,e.overlayMutation))}function xR(n,e){const t=e.path.lastSegment();return[n,yr(e.path.popLast()),t]}function _R(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ac(r.readTime),documentKey:yr(r.documentKey.path),largestBatchId:r.largestBatchId}}class aq{getBundleMetadata(e,t){return wR(e).get(t).next((r=>{if(r)return(function(a){return{id:a.bundleId,createTime:Cc(a.createTime),version:a.version}})(r)}))}saveBundleMetadata(e,t){return wR(e).put((function(i){return{bundleId:i.id,createTime:Ac(Rr(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return SR(e).get(t).next((r=>{if(r)return(function(a){return{name:a.name,query:mO(a.bundledQuery),readTime:Cc(a.readTime)}})(r)}))}saveNamedQuery(e,t){return SR(e).put((function(i){return{name:i.name,readTime:Ac(Rr(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function wR(n){return Qn(n,$v)}function SR(n){return Qn(n,Hv)}class Jv{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new Jv(e,r)}getOverlay(e,t){return nh(e).get(xR(this.userId,t)).next((r=>r?Kx(this.serializer,r):null))}getOverlays(e,t){const r=ja();return le.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((a,s)=>{const c=new oS(t,s);i.push(this.St(e,c))})),le.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((s=>i.add(yr(s.getCollectionPath()))));const a=[];return i.forEach((s=>{const c=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,r+1],!1,!0);a.push(nh(e).Z(i_,c))})),le.waitFor(a)}getOverlaysForCollection(e,t,r){const i=ja(),a=yr(t),s=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return nh(e).J(i_,s).next((c=>{for(const u of c){const d=Kx(this.serializer,u);i.set(d.getKey(),d)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const a=ja();let s;const c=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return nh(e).ee({index:gP,range:c},((u,d,h)=>{const p=Kx(this.serializer,d);a.size()<i||p.largestBatchId===s?(a.set(p.getKey(),p),s=p.largestBatchId):h.done()})).next((()=>a))}St(e,t){return nh(e).put((function(i,a,s){const[c,u,d]=xR(a,s.mutation.key);return{userId:a,collectionPath:u,documentId:d,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:nv(i.yt,s.mutation)}})(this.serializer,this.userId,t))}}function nh(n){return Qn(n,Yv)}class sq{bt(e){return Qn(e,Qw)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?Cn.fromUint8Array(r):Cn.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class tc{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(rn(e.integerValue));else if("doubleValue"in e){const r=rn(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Jh(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=Os(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(js(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?CP(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Xv(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Ve(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const i=hd,a=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(rn(a)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),De.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}tc.Kt=new tc;const Ru=255;function oq(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function ER(n){const e=64-(function(r){let i=0;for(let a=0;a<8;++a){const s=oq(255&r[a]);if(i+=s,s!==8)break}return i})(n);return Math.ceil(e/8)}class lq{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=ER(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=ER(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(Ru),this.sn(255)}_n(){this.an(Ru),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(a){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,a,!1),new Uint8Array(s.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Ru?(this.sn(Ru),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Ru?(this.an(Ru),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class cq{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class uq{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class rh{constructor(){this.cn=new lq,this.ln=new cq(this.cn),this.hn=new uq(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class nc{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new nc(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:S0(this.En),directionalValue:S0(this.dn),orderedDocumentKey:S0(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Co(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=TR(n.En,e.En),t!==0?t:(t=TR(n.dn,e.dn),t!==0?t:De.comparator(n.In,e.In)))}function TR(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function S0(n){return ON()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function AR(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class CR{constructor(e){this.mn=new Ut(((t,r)=>dn.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if($e(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=t_(e);if(t!==void 0&&!this.wn(t))return!1;const r=Xl(e);let i=new Set,a=0,s=0;for(;a<r.length&&this.wn(r[a]);++a)i=i.add(r[a].fieldPath.canonicalString());if(a===r.length)return!0;if(this.mn.size>0){const c=this.mn.getIterator().getNext();if(!i.has(c.field.canonicalString())){const u=r[a];if(!this.Sn(c,u)||!this.bn(this.fn[s++],u))return!1}++a}for(;a<r.length;++a){const c=r[a];if(s>=this.fn.length||!this.bn(this.fn[s++],c))return!1}return!0}Dn(){if(this.pn)return null;let e=new Ut(dn.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new g0(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new g0(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new g0(r.field,r.dir==="asc"?0:1)));return new Y0(Y0.UNKNOWN_ID,this.collectionId,t,Zh.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function vO(n){if($e(n instanceof St||n instanceof Bt,20012),n instanceof St){if(n instanceof jP){const t=n.value.arrayValue?.values?.map((r=>St.create(n.field,"==",r)))||[];return Bt.create(t,"or")}return n}const e=n.filters.map((t=>vO(t)));return Bt.create(e,n.op)}function dq(n){if(n.getFilters().length===0)return[];const e=y_(vO(n));return $e(yO(e),7391),m_(e)||v_(e)?[e]:e.getFilters()}function m_(n){return n instanceof St}function v_(n){return n instanceof Bt&&nS(n)}function yO(n){return m_(n)||v_(n)||(function(t){if(t instanceof Bt&&l_(t)){for(const r of t.getFilters())if(!m_(r)&&!v_(r))return!1;return!0}return!1})(n)}function y_(n){if($e(n instanceof St||n instanceof Bt,34018),n instanceof St)return n;if(n.filters.length===1)return y_(n.filters[0]);const e=n.filters.map((r=>y_(r)));let t=Bt.create(e,n.op);return t=iv(t),yO(t)?t:($e(t instanceof Bt,64498),$e(md(t),40251),$e(t.filters.length>1,57927),t.filters.reduce(((r,i)=>uS(r,i))))}function uS(n,e){let t;return $e(n instanceof St||n instanceof Bt,38388),$e(e instanceof St||e instanceof Bt,25473),t=n instanceof St?e instanceof St?(function(i,a){return Bt.create([i,a],"and")})(n,e):IR(n,e):e instanceof St?IR(e,n):(function(i,a){if($e(i.filters.length>0&&a.filters.length>0,48005),md(i)&&md(a))return MP(i,a.getFilters());const s=l_(i)?i:a,c=l_(i)?a:i,u=s.filters.map((d=>uS(d,c)));return Bt.create(u,"or")})(n,e),iv(t)}function IR(n,e){if(md(e))return MP(e,n.getFilters());{const t=e.filters.map((r=>uS(n,r)));return Bt.create(t,"or")}}function iv(n){if($e(n instanceof St||n instanceof Bt,11850),n instanceof St)return n;const e=n.getFilters();if(e.length===1)return iv(e[0]);if(DP(n))return n;const t=e.map((i=>iv(i))),r=[];return t.forEach((i=>{i instanceof St?r.push(i):i instanceof Bt&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:Bt.create(r,n.op)}class fq{constructor(){this.Cn=new dS}addToCollectionParentIndex(e,t){return this.Cn.add(t),le.resolve()}getCollectionParents(e,t){return le.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return le.resolve()}deleteFieldIndex(e,t){return le.resolve()}deleteAllFieldIndexes(e){return le.resolve()}createTargetIndexes(e,t){return le.resolve()}getDocumentsMatchingTarget(e,t){return le.resolve(null)}getIndexType(e,t){return le.resolve(0)}getFieldIndexes(e,t){return le.resolve([])}getNextCollectionGroupToUpdate(e){return le.resolve(null)}getMinOffset(e,t){return le.resolve(ci.min())}getMinOffsetFromCollectionGroup(e,t){return le.resolve(ci.min())}updateCollectionGroup(e,t,r){return le.resolve()}updateIndexEntries(e,t){return le.resolve()}}class dS{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ut(Pt.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ut(Pt.comparator)).toArray()}}const RR="IndexedDbIndexManager",Lm=new Uint8Array(0);class hq{constructor(e,t){this.databaseId=t,this.vn=new dS,this.Fn=new Fs((r=>Ec(r)),((r,i)=>zp(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const a={collectionId:r,parent:yr(i)};return kR(e).put(a)}return le.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[tP(t),""],!1,!0);return kR(e).J(i).next((a=>{for(const s of a){if(s.collectionId!==t)break;r.push(Oa(s.parent))}return r}))}addFieldIndex(e,t){const r=ih(e),i=(function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete i.indexId;const a=r.add(i);if(t.indexState){const s=Du(e);return a.next((c=>{s.put(_R(c,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const r=ih(e),i=Du(e),a=ku(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=ih(e),r=ku(e),i=Du(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return le.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const a=new CR(r).Dn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const r=ku(e);let i=!0;const a=new Map;return le.forEach(this.Mn(t),(s=>this.xn(e,s).next((c=>{i&&(i=!!c),a.set(s,c)})))).next((()=>{if(i){let s=gt();const c=[];return le.forEach(a,((u,d)=>{Ae(RR,`Using index ${(function(k){return`id=${k.indexId}|cg=${k.collectionGroup}|f=${k.fields.map((j=>`${j.fieldPath}:${j.kind}`)).join(",")}`})(u)} to execute ${Ec(t)}`);const h=(function(k,j){const P=t_(j);if(P===void 0)return null;for(const N of J0(k,P.fieldPath))switch(N.op){case"array-contains-any":return N.value.arrayValue.values||[];case"array-contains":return[N.value]}return null})(d,u),p=(function(k,j){const P=new Map;for(const N of Xl(j))for(const A of J0(k,N.fieldPath))switch(A.op){case"==":case"in":P.set(N.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return P.set(N.fieldPath.canonicalString(),A.value),Array.from(P.values())}return null})(d,u),m=(function(k,j){const P=[];let N=!0;for(const A of Xl(j)){const I=A.kind===0?oR(k,A.fieldPath,k.startAt):lR(k,A.fieldPath,k.startAt);P.push(I.value),N&&(N=I.inclusive)}return new gd(P,N)})(d,u),b=(function(k,j){const P=[];let N=!0;for(const A of Xl(j)){const I=A.kind===0?lR(k,A.fieldPath,k.endAt):oR(k,A.fieldPath,k.endAt);P.push(I.value),N&&(N=I.inclusive)}return new gd(P,N)})(d,u),_=this.On(u,d,m),w=this.On(u,d,b),E=this.Nn(u,d,p),T=this.Bn(u.indexId,h,_,m.inclusive,w,b.inclusive,E);return le.forEach(T,(C=>r.Y(C,t.limit).next((k=>{k.forEach((j=>{const P=De.fromSegments(j.documentKey);s.has(P)||(s=s.add(P),c.push(P))}))}))))})).next((()=>c))}return le.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=dq(Bt.create(e.filters,"and")).map((r=>u_(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,a,s,c){const u=(t!=null?t.length:1)*Math.max(r.length,a.length),d=u/(t!=null?t.length:1),h=[];for(let p=0;p<u;++p){const m=t?this.Ln(t[p/d]):Lm,b=this.kn(e,m,r[p%d],i),_=this.qn(e,m,a[p%d],s),w=c.map((E=>this.kn(e,m,E,!0)));h.push(...this.createRange(b,_,w))}return h}kn(e,t,r,i){const a=new nc(e,De.empty(),t,r);return i?a:a.An()}qn(e,t,r,i){const a=new nc(e,De.empty(),t,r);return i?a.An():a}xn(e,t){const r=new CR(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((a=>{let s=null;for(const c of a)r.yn(c)&&(!s||c.fields.length>s.fields.length)&&(s=c);return s}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return le.forEach(i,(a=>this.xn(e,a).next((s=>{s?r!==0&&s.fields.length<(function(u){let d=new Ut(dn.comparator),h=!1;for(const p of u.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:d=d.add(m.field));for(const p of u.orderBy)p.field.isKeyField()||(d=d.add(p.field));return d.size+(h?1:0)})(a)&&(r=1):r=0})))).next((()=>(function(s){return s.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new rh;for(const i of Xl(e)){const a=t.data.field(i.fieldPath);if(a==null)return null;const s=r.Pn(i.kind);tc.Kt.Dt(a,s)}return r.un()}Ln(e){const t=new rh;return tc.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new rh;return tc.Kt.Dt(ap(this.databaseId,t),r.Pn((function(a){const s=Xl(a);return s.length===0?0:s[s.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new rh);let a=0;for(const s of Xl(e)){const c=r[a++];for(const u of i)if(this.Un(t,s.fieldPath)&&sp(c))i=this.Kn(i,s,c);else{const d=u.Pn(s.kind);tc.Kt.Dt(c,d)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],a=[];for(const s of r.arrayValue.values||[])for(const c of i){const u=new rh;u.seed(c.un()),tc.Kt.Dt(s,u.Pn(t.kind)),a.push(u)}return a}Un(e,t){return!!e.filters.find((r=>r instanceof St&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=ih(e),i=Du(e);return(t?r.J(r_,IDBKeyRange.bound(t,t)):r.J()).next((a=>{const s=[];return le.forEach(a,(c=>i.get([c.indexId,this.uid]).next((u=>{s.push((function(h,p){const m=p?new Zh(p.sequenceNumber,new ci(Cc(p.readTime),new De(Oa(p.documentKey)),p.largestBatchId)):Zh.empty(),b=h.fields.map((([_,w])=>new g0(dn.fromServerFormat(_),w)));return new Y0(h.indexId,h.collectionGroup,b,m)})(c,u))})))).next((()=>s))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const a=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return a!==0?a:it(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=ih(e),a=Du(e);return this.Gn(e).next((s=>i.J(r_,IDBKeyRange.bound(t,t)).next((c=>le.forEach(c,(u=>a.put(_R(u.indexId,this.uid,s,r))))))))}updateIndexEntries(e,t){const r=new Map;return le.forEach(t,((i,a)=>{const s=r.get(i.collectionGroup);return(s?le.resolve(s):this.getFieldIndexes(e,i.collectionGroup)).next((c=>(r.set(i.collectionGroup,c),le.forEach(c,(u=>this.zn(e,i,u).next((d=>{const h=this.jn(a,u);return d.isEqual(h)?le.resolve():this.Jn(e,a,u,d,h)})))))))}))}Hn(e,t,r,i){return ku(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return ku(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=ku(e);let a=new Ut(Co);return i.ee({index:pP,range:IDBKeyRange.only([r.indexId,this.uid,S0(this.$n(r,t))])},((s,c)=>{a=a.add(new nc(r.indexId,t,AR(c.arrayValue),AR(c.directionalValue)))})).next((()=>a))}jn(e,t){let r=new Ut(Co);const i=this.Qn(t,e);if(i==null)return r;const a=t_(t);if(a!=null){const s=e.data.field(a.fieldPath);if(sp(s))for(const c of s.arrayValue.values||[])r=r.add(new nc(t.indexId,e.key,this.Ln(c),i))}else r=r.add(new nc(t.indexId,e.key,Lm,i));return r}Jn(e,t,r,i,a){Ae(RR,"Updating index entries for document '%s'",t.key);const s=[];return(function(u,d,h,p,m){const b=u.getIterator(),_=d.getIterator();let w=Iu(b),E=Iu(_);for(;w||E;){let T=!1,C=!1;if(w&&E){const k=h(w,E);k<0?C=!0:k>0&&(T=!0)}else w!=null?C=!0:T=!0;T?(p(E),E=Iu(_)):C?(m(w),w=Iu(b)):(w=Iu(b),E=Iu(_))}})(i,a,Co,(c=>{s.push(this.Hn(e,t,r,c))}),(c=>{s.push(this.Yn(e,t,r,c))})),le.waitFor(s)}Gn(e){let t=1;return Du(e).ee({index:hP,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,a)=>{a.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((s,c)=>Co(s,c))).filter(((s,c,u)=>!c||Co(s,u[c-1])!==0));const i=[];i.push(e);for(const s of r){const c=Co(s,e),u=Co(s,t);if(c===0)i[0]=e.An();else if(c>0&&u<0)i.push(s),i.push(s.An());else if(u>0)break}i.push(t);const a=[];for(let s=0;s<i.length;s+=2){if(this.Zn(i[s],i[s+1]))return[];const c=i[s].Vn(this.uid,Lm,De.empty()),u=i[s+1].Vn(this.uid,Lm,De.empty());a.push(IDBKeyRange.bound(c,u))}return a}Zn(e,t){return Co(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(DR)}getMinOffset(e,t){return le.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||Ve(44426))))).next(DR)}}function kR(n){return Qn(n,np)}function ku(n){return Qn(n,Ch)}function ih(n){return Qn(n,Ww)}function Du(n){return Qn(n,Ah)}function DR(n){$e(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;Yw(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new ci(e.readTime,e.documentKey,t)}const NR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},bO=41943040;class gr{static withCacheSize(e){return new gr(e,gr.DEFAULT_COLLECTION_PERCENTILE,gr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function xO(n,e,t){const r=n.store(Zi),i=n.store(cd),a=[],s=IDBKeyRange.only(t.batchId);let c=0;const u=r.ee({range:s},((h,p,m)=>(c++,m.delete())));a.push(u.next((()=>{$e(c===1,47070,{batchId:t.batchId})})));const d=[];for(const h of t.mutations){const p=uP(e,h.key.path,t.batchId);a.push(i.delete(p)),d.push(h.key)}return le.waitFor(a).next((()=>d))}function av(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ve(14731);e=n.noDocument}return JSON.stringify(e).length}gr.DEFAULT_COLLECTION_PERCENTILE=10,gr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,gr.DEFAULT=new gr(bO,gr.DEFAULT_COLLECTION_PERCENTILE,gr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),gr.DISABLED=new gr(-1,0,0);class ey{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){$e(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new ey(a,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Io(e).ee({index:oc,range:r},((i,a,s)=>{t=!1,s.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const a=zu(e),s=Io(e);return s.add({}).next((c=>{$e(typeof c=="number",49019);const u=new aS(c,t,r,i),d=(function(b,_,w){const E=w.baseMutations.map((C=>nv(b.yt,C))),T=w.mutations.map((C=>nv(b.yt,C)));return{userId:_,batchId:w.batchId,localWriteTimeMs:w.localWriteTime.toMillis(),baseMutations:E,mutations:T}})(this.serializer,this.userId,u),h=[];let p=new Ut(((m,b)=>it(m.canonicalString(),b.canonicalString())));for(const m of i){const b=uP(this.userId,m.key.path,c);p=p.add(m.key.path.popLast()),h.push(s.put(d)),h.push(a.put(b,$7))}return p.forEach((m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[c]=u.keys()})),le.waitFor(h).next((()=>u))}))}lookupMutationBatch(e,t){return Io(e).get(t).next((r=>r?($e(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),ec(this.serializer,r)):null))}er(e,t){return this.Xn[t]?le.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return Io(e).ee({index:oc,range:i},((s,c,u)=>{c.userId===this.userId&&($e(c.batchId>=r,47524,{tr:r}),a=ec(this.serializer,c)),u.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=fc;return Io(e).ee({index:oc,range:t,reverse:!0},((i,a,s)=>{r=a.batchId,s.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,fc],[this.userId,Number.POSITIVE_INFINITY]);return Io(e).J(oc,t).next((r=>r.map((i=>ec(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=m0(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return zu(e).ee({range:i},((s,c,u)=>{const[d,h,p]=s,m=Oa(h);if(d===this.userId&&t.path.isEqual(m))return Io(e).get(p).next((b=>{if(!b)throw Ve(61480,{nr:s,batchId:p});$e(b.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:b.userId,batchId:p}),a.push(ec(this.serializer,b))}));u.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ut(it);const i=[];return t.forEach((a=>{const s=m0(this.userId,a.path),c=IDBKeyRange.lowerBound(s),u=zu(e).ee({range:c},((d,h,p)=>{const[m,b,_]=d,w=Oa(b);m===this.userId&&a.path.isEqual(w)?r=r.add(_):p.done()}));i.push(u)})),le.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,a=m0(this.userId,r),s=IDBKeyRange.lowerBound(a);let c=new Ut(it);return zu(e).ee({range:s},((u,d,h)=>{const[p,m,b]=u,_=Oa(m);p===this.userId&&r.isPrefixOf(_)?_.length===i&&(c=c.add(b)):h.done()})).next((()=>this.rr(e,c)))}rr(e,t){const r=[],i=[];return t.forEach((a=>{i.push(Io(e).get(a).next((s=>{if(s===null)throw Ve(35274,{batchId:a});$e(s.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:s.userId,batchId:a}),r.push(ec(this.serializer,s))})))})),le.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return xO(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),le.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return le.resolve();const r=IDBKeyRange.lowerBound((function(s){return[s]})(this.userId)),i=[];return zu(e).ee({range:r},((a,s,c)=>{if(a[0]===this.userId){const u=Oa(a[1]);i.push(u)}else c.done()})).next((()=>{$e(i.length===0,56720,{sr:i.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return _O(e,this.userId,t)}_r(e){return wO(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:fc,lastStreamToken:""}))}}function _O(n,e,t){const r=m0(e,t.path),i=r[1],a=IDBKeyRange.lowerBound(r);let s=!1;return zu(n).ee({range:a,X:!0},((c,u,d)=>{const[h,p,m]=c;h===e&&p===i&&(s=!0),d.done()})).next((()=>s))}function Io(n){return Qn(n,Zi)}function zu(n){return Qn(n,cd)}function wO(n){return Qn(n,ep)}class Ic{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ic(0)}static cr(){return new Ic(-1)}}class pq{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new Ic(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Xe.fromTimestamp(new pt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Nu(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>($e(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const a=[];return Nu(e).ee(((s,c)=>{const u=gh(c);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(i++,a.push(this.removeTargetData(e,u)))})).next((()=>le.waitFor(a))).next((()=>i))}forEachTarget(e,t){return Nu(e).ee(((r,i)=>{const a=gh(i);t(a)}))}lr(e){return MR(e).get(W0).next((t=>($e(t!==null,2888),t)))}hr(e,t){return MR(e).put(W0,t)}Pr(e,t){return Nu(e).put(gO(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=Ec(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return Nu(e).ee({range:i,index:fP},((s,c,u)=>{const d=gh(c);zp(t,d.target)&&(a=d,u.done())})).next((()=>a))}addMatchingKeys(e,t,r){const i=[],a=zo(e);return t.forEach((s=>{const c=yr(s.path);i.push(a.put({targetId:r,path:c})),i.push(this.referenceDelegate.addReference(e,r,s))})),le.waitFor(i)}removeMatchingKeys(e,t,r){const i=zo(e);return le.forEach(t,(a=>{const s=yr(a.path);return le.waitFor([i.delete([r,s]),this.referenceDelegate.removeReference(e,r,a)])}))}removeMatchingKeysForTargetId(e,t){const r=zo(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=zo(e);let a=gt();return i.ee({range:r,X:!0},((s,c,u)=>{const d=Oa(s[1]),h=new De(d);a=a.add(h)})).next((()=>a))}containsKey(e,t){const r=yr(t.path),i=IDBKeyRange.bound([r],[tP(r)],!1,!0);let a=0;return zo(e).ee({index:Xw,X:!0,range:i},(([s,c],u,d)=>{s!==0&&(a++,d.done())})).next((()=>a>0))}At(e,t){return Nu(e).get(t).next((r=>r?gh(r):null))}}function Nu(n){return Qn(n,ud)}function MR(n){return Qn(n,hc)}function zo(n){return Qn(n,dd)}const PR="LruGarbageCollector",SO=1048576;function OR([n,e],[t,r]){const i=it(n,t);return i===0?it(e,r):i}class gq{constructor(e){this.Ir=e,this.buffer=new Ut(OR),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();OR(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class EO{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ae(PR,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){hl(t)?Ae(PR,"Ignoring IndexedDB error during garbage collection: ",t):await fl(t)}await this.Vr(3e5)}))}}class mq{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return le.resolve(Lr.ce);const r=new gq(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ae("LruGarbageCollector","Garbage collection skipped; disabled"),le.resolve(NR)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Ae("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),NR):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,a,s,c,u,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(Ae("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,s=Date.now(),this.nthSequenceNumber(e,i)))).next((p=>(r=p,c=Date.now(),this.removeTargets(e,r,t)))).next((p=>(a=p,u=Date.now(),this.removeOrphanedDocuments(e,r)))).next((p=>(d=Date.now(),Pu()<=wt.DEBUG&&Ae("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${i} in `+(c-s)+`ms
	Removed ${a} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(d-u)+`ms
Total Duration: ${d-h}ms`),le.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:p}))))}}function TO(n,e){return new mq(n,e)}class vq{constructor(e,t){this.db=e,this.garbageCollector=TO(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return Bm(e,r)}removeReference(e,t,r){return Bm(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Bm(e,t)}br(e,t){return(function(i,a){let s=!1;return wO(i).te((c=>_O(i,c,a).next((u=>(u&&(s=!0),le.resolve(!u)))))).next((()=>s))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Sr(e,((s,c)=>{if(c<=t){const u=this.br(e,s).next((d=>{if(!d)return a++,r.getEntry(e,s).next((()=>(r.removeEntry(s,Xe.min()),zo(e).delete((function(p){return[0,yr(p.path)]})(s)))))}));i.push(u)}})).next((()=>le.waitFor(i))).next((()=>r.apply(e))).next((()=>a))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Bm(e,t)}Sr(e,t){const r=zo(e);let i,a=Lr.ce;return r.ee({index:Xw},(([s,c],{path:u,sequenceNumber:d})=>{s===0?(a!==Lr.ce&&t(new De(Oa(i)),a),a=d,i=u):a=Lr.ce})).next((()=>{a!==Lr.ce&&t(new De(Oa(i)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Bm(n,e){return zo(n).put((function(r,i){return{targetId:0,path:yr(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class AO{constructor(){this.changes=new Fs((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,bn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?le.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class yq{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Hl(e).put(r)}removeEntry(e,t,r){return Hl(e).delete((function(a,s){const c=a.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],rv(s),c[c.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=bn.newInvalidDocument(t);return Hl(e).ee({index:v0,range:IDBKeyRange.only(ah(t))},((i,a)=>{r=this.Cr(t,a)})).next((()=>r))}vr(e,t){let r={size:0,document:bn.newInvalidDocument(t)};return Hl(e).ee({index:v0,range:IDBKeyRange.only(ah(t))},((i,a)=>{r={document:this.Cr(t,a),size:av(a)}})).next((()=>r))}getEntries(e,t){let r=oi();return this.Fr(e,t,((i,a)=>{const s=this.Cr(i,a);r=r.insert(i,s)})).next((()=>r))}Mr(e,t){let r=oi(),i=new Qt(De.comparator);return this.Fr(e,t,((a,s)=>{const c=this.Cr(a,s);r=r.insert(a,c),i=i.insert(a,av(s))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return le.resolve();let i=new Ut(zR);t.forEach((u=>i=i.add(u)));const a=IDBKeyRange.bound(ah(i.first()),ah(i.last())),s=i.getIterator();let c=s.getNext();return Hl(e).ee({index:v0,range:a},((u,d,h)=>{const p=De.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;c&&zR(c,p)<0;)r(c,null),c=s.getNext();c&&c.isEqual(p)&&(r(c,d),c=s.hasNext()?s.getNext():null),c?h.j(ah(c)):h.done()})).next((()=>{for(;c;)r(c,null),c=s.hasNext()?s.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,a){const s=t.path,c=[s.popLast().toArray(),s.lastSegment(),rv(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Hl(e).J(IDBKeyRange.bound(c,u,!0)).next((d=>{a?.incrementDocumentReadCount(d.length);let h=oi();for(const p of d){const m=this.Cr(De.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(Bp(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h}))}getAllFromCollectionGroup(e,t,r,i){let a=oi();const s=VR(t,r),c=VR(t,ci.max());return Hl(e).ee({index:dP,range:IDBKeyRange.bound(s,c,!0)},((u,d,h)=>{const p=this.Cr(De.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);a=a.insert(p.key,p),a.size===i&&h.done()})).next((()=>a))}newChangeBuffer(e){return new bq(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return jR(e).get(n_).next((t=>($e(!!t,20021),t)))}Dr(e,t){return jR(e).put(n_,t)}Cr(e,t){if(t){const r=iq(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Xe.min())))return r}return bn.newInvalidDocument(e)}}function CO(n){return new yq(n)}class bq extends AO{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Fs((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new Ut(((a,s)=>it(a.canonicalString(),s.canonicalString())));return this.changes.forEach(((a,s)=>{const c=this.Br.get(a);if(t.push(this.Nr.removeEntry(e,a,c.readTime)),s.isValidDocument()){const u=bR(this.Nr.serializer,s);i=i.add(a.path.popLast());const d=av(u);r+=d-c.size,t.push(this.Nr.addEntry(e,a,u))}else if(r-=c.size,this.trackRemovals){const u=bR(this.Nr.serializer,s.convertToNoDocument(Xe.min()));t.push(this.Nr.addEntry(e,a,u))}})),i.forEach((a=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Nr.updateMetadata(e,r)),le.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((a,s)=>{this.Br.set(a,{size:s,readTime:r.get(a).readTime})})),r)))}}function jR(n){return Qn(n,tp)}function Hl(n){return Qn(n,X0)}function ah(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function VR(n,e){const t=e.documentKey.path.toArray();return[n,rv(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function zR(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(i=it(t[a],r[a]),i)return i;return i=it(t.length,r.length),i||(i=it(t[t.length-2],r[r.length-2]),i||it(t[t.length-1],r[r.length-1]))}class xq{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class IO{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Dh(r.mutation,i,Br.empty(),pt.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,gt()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=gt()){const i=ja();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((a=>{let s=hh();return a.forEach(((c,u)=>{s=s.insert(c,u.overlayedDocument)})),s}))))}getOverlayedDocuments(e,t){const r=ja();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,gt())))}populateOverlays(e,t,r){const i=[];return r.forEach((a=>{t.has(a)||i.push(a)})),this.documentOverlayCache.getOverlays(e,i).next((a=>{a.forEach(((s,c)=>{t.set(s,c)}))}))}computeViews(e,t,r,i){let a=oi();const s=kh(),c=(function(){return kh()})();return t.forEach(((u,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof Gs)?a=a.insert(d.key,d):h!==void 0?(s.set(d.key,h.mutation.getFieldMask()),Dh(h.mutation,d,h.mutation.getFieldMask(),pt.now())):s.set(d.key,Br.empty())})),this.recalculateAndSaveOverlays(e,a).next((u=>(u.forEach(((d,h)=>s.set(d,h))),t.forEach(((d,h)=>c.set(d,new xq(h,s.get(d)??null)))),c)))}recalculateAndSaveOverlays(e,t){const r=kh();let i=new Qt(((s,c)=>s-c)),a=gt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((s=>{for(const c of s)c.keys().forEach((u=>{const d=t.get(u);if(d===null)return;let h=r.get(u)||Br.empty();h=c.applyToLocalView(d,h),r.set(u,h);const p=(i.get(c.batchId)||gt()).add(u);i=i.insert(c.batchId,p)}))})).next((()=>{const s=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,h=u.value,p=qP();h.forEach((m=>{if(!a.has(m)){const b=QP(t.get(m),r.get(m));b!==null&&p.set(m,b),a=a.add(m)}})),s.push(this.documentOverlayCache.saveOverlays(e,d,p))}return le.waitFor(s)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(s){return De.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):zP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((a=>{const s=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):le.resolve(ja());let c=ld,u=a;return s.next((d=>le.forEach(d,((h,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),a.get(h)?le.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{u=u.insert(h,m)}))))).next((()=>this.populateOverlays(e,d,a))).next((()=>this.computeViews(e,u,d,gt()))).next((h=>({batchId:c,changes:GP(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new De(t)).next((r=>{let i=hh();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const a=t.collectionGroup;let s=hh();return this.indexManager.getCollectionParents(e,a).next((c=>le.forEach(c,(u=>{const d=(function(p,m){return new zd(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next((h=>{h.forEach(((p,m)=>{s=s.insert(p,m)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((s=>(a=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,i)))).next((s=>{a.forEach(((u,d)=>{const h=d.getKey();s.get(h)===null&&(s=s.insert(h,bn.newInvalidDocument(h)))}));let c=hh();return s.forEach(((u,d)=>{const h=a.get(u);h!==void 0&&Dh(h.mutation,d,Br.empty(),pt.now()),Bp(t,d)&&(c=c.insert(u,d))})),c}))}}class _q{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return le.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Rr(i.createTime)}})(t)),le.resolve()}getNamedQuery(e,t){return le.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:mO(i.bundledQuery),readTime:Rr(i.readTime)}})(t)),le.resolve()}}class wq{constructor(){this.overlays=new Qt(De.comparator),this.qr=new Map}getOverlay(e,t){return le.resolve(this.overlays.get(t))}getOverlays(e,t){const r=ja();return le.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,a)=>{this.St(e,t,a)})),le.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(r)),le.resolve()}getOverlaysForCollection(e,t,r){const i=ja(),a=t.length+1,s=new De(t.child("")),c=this.overlays.getIteratorFrom(s);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===a&&u.largestBatchId>r&&i.set(u.getKey(),u)}return le.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new Qt(((d,h)=>d-h));const s=this.overlays.getIterator();for(;s.hasNext();){const d=s.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let h=a.get(d.largestBatchId);h===null&&(h=ja(),a=a.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const c=ja(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((d,h)=>c.set(d,h))),!(c.size()>=i)););return le.resolve(c)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const s=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new oS(t,r));let a=this.qr.get(t);a===void 0&&(a=gt(),this.qr.set(t,a)),this.qr.set(t,a.add(r.key))}}class Sq{constructor(){this.sessionToken=Cn.EMPTY_BYTE_STRING}getSessionToken(e){return le.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,le.resolve()}}class fS{constructor(){this.Qr=new Ut(tr.$r),this.Ur=new Ut(tr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new tr(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new tr(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new De(new Pt([])),r=new tr(t,e),i=new tr(t,e+1),a=[];return this.Ur.forEachInRange([r,i],(s=>{this.Gr(s),a.push(s.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new De(new Pt([])),r=new tr(t,e),i=new tr(t,e+1);let a=gt();return this.Ur.forEachInRange([r,i],(s=>{a=a.add(s.key)})),a}containsKey(e){const t=new tr(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class tr{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return De.comparator(e.key,t.key)||it(e.Yr,t.Yr)}static Kr(e,t){return it(e.Yr,t.Yr)||De.comparator(e.key,t.key)}}class Eq{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ut(tr.$r)}checkEmpty(e){return le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new aS(a,t,r,i);this.mutationQueue.push(s);for(const c of i)this.Zr=this.Zr.add(new tr(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return le.resolve(s)}lookupMutationBatch(e,t){return le.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),a=i<0?0:i;return le.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return le.resolve(this.mutationQueue.length===0?fc:this.tr-1)}getAllMutationBatches(e){return le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new tr(t,0),i=new tr(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([r,i],(s=>{const c=this.Xr(s.Yr);a.push(c)})),le.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ut(it);return t.forEach((i=>{const a=new tr(i,0),s=new tr(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,s],(c=>{r=r.add(c.Yr)}))})),le.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;De.isDocumentKey(a)||(a=a.child(""));const s=new tr(new De(a),0);let c=new Ut(it);return this.Zr.forEachWhile((u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(c=c.add(u.Yr)),!0)}),s),le.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){$e(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return le.forEach(t.mutations,(i=>{const a=new tr(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new tr(t,0),i=this.Zr.firstAfterOrEqual(r);return le.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,le.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Tq{constructor(e){this.ri=e,this.docs=(function(){return new Qt(De.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,s=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return le.resolve(r?r.document.mutableCopy():bn.newInvalidDocument(t))}getEntries(e,t){let r=oi();return t.forEach((i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():bn.newInvalidDocument(i))})),le.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let a=oi();const s=t.path,c=new De(s.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:h}}=u.getNext();if(!s.isPrefixOf(d.path))break;d.path.length>s.length+1||Yw(aP(h),r)<=0||(i.has(h.key)||Bp(t,h))&&(a=a.insert(h.key,h.mutableCopy()))}return le.resolve(a)}getAllFromCollectionGroup(e,t,r,i){Ve(9500)}ii(e,t){return le.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new Aq(this)}getSize(e){return le.resolve(this.size)}}class Aq extends AO{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),le.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Cq{constructor(e){this.persistence=e,this.si=new Fs((t=>Ec(t)),zp),this.lastRemoteSnapshotVersion=Xe.min(),this.highestTargetId=0,this.oi=0,this._i=new fS,this.targetCount=0,this.ai=Ic.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),le.resolve()}getLastRemoteSnapshotVersion(e){return le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return le.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),le.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),le.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ic(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,le.resolve()}updateTargetData(e,t){return this.Pr(t),le.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,le.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.si.forEach(((s,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(s),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)})),le.waitFor(a).next((()=>i))}getTargetCount(e){return le.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return le.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),le.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach((s=>{a.push(i.markPotentiallyOrphaned(e,s))})),le.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),le.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return le.resolve(r)}containsKey(e,t){return le.resolve(this._i.containsKey(t))}}class hS{constructor(e,t){this.ui={},this.overlays={},this.ci=new Lr(0),this.li=!1,this.li=!0,this.hi=new Sq,this.referenceDelegate=e(this),this.Pi=new Cq(this),this.indexManager=new fq,this.remoteDocumentCache=(function(i){return new Tq(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new pO(t),this.Ii=new _q(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new wq,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new Eq(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){Ae("MemoryPersistence","Starting transaction:",e);const i=new Iq(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((a=>this.referenceDelegate.di(i).next((()=>a)))).toPromise().then((a=>(i.raiseOnCommittedEvent(),a)))}Ai(e,t){return le.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class Iq extends oP{constructor(e){super(),this.currentSequenceNumber=e}}class ty{constructor(e){this.persistence=e,this.Ri=new fS,this.Vi=null}static mi(e){return new ty(e)}get fi(){if(this.Vi)return this.Vi;throw Ve(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),le.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),le.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),le.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((a=>this.fi.add(a.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return le.forEach(this.fi,(r=>{const i=De.fromPath(r);return this.gi(e,i).next((a=>{a||t.removeEntry(i,Xe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return le.or([()=>le.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class sv{constructor(e,t){this.persistence=e,this.pi=new Fs((r=>yr(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=TO(this,t)}static mi(e,t){return new sv(e,t)}Ei(){}di(e){return le.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return le.forEach(this.pi,((r,i)=>this.br(e,r,i).next((a=>a?le.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,(s=>this.br(e,s,t).next((c=>{c||(r++,a.removeEntry(s,Xe.min()))})))).next((()=>a.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),le.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),le.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),le.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),le.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=b0(e.data.value)),t}br(e,t,r){return le.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return le.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Rq{constructor(e){this.serializer=e}k(e,t,r,i){const a=new Gv("createOrUpgrade",t);r<1&&i>=1&&((function(u){u.createObjectStore(Vp)})(e),(function(u){u.createObjectStore(ep,{keyPath:q7}),u.createObjectStore(Zi,{keyPath:X2,autoIncrement:!0}).createIndex(oc,W2,{unique:!0}),u.createObjectStore(cd)})(e),LR(e),(function(u){u.createObjectStore(Wl)})(e));let s=le.resolve();return r<3&&i>=3&&(r!==0&&((function(u){u.deleteObjectStore(dd),u.deleteObjectStore(ud),u.deleteObjectStore(hc)})(e),LR(e)),s=s.next((()=>(function(u){const d=u.store(hc),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Xe.min().toTimestamp(),targetCount:0};return d.put(W0,h)})(a)))),r<4&&i>=4&&(r!==0&&(s=s.next((()=>(function(u,d){return d.store(Zi).J().next((p=>{u.deleteObjectStore(Zi),u.createObjectStore(Zi,{keyPath:X2,autoIncrement:!0}).createIndex(oc,W2,{unique:!0});const m=d.store(Zi),b=p.map((_=>m.put(_)));return le.waitFor(b)}))})(e,a)))),s=s.next((()=>{(function(u){u.createObjectStore(fd,{keyPath:J7})})(e)}))),r<5&&i>=5&&(s=s.next((()=>this.yi(a)))),r<6&&i>=6&&(s=s.next((()=>((function(u){u.createObjectStore(tp)})(e),this.wi(a))))),r<7&&i>=7&&(s=s.next((()=>this.Si(a)))),r<8&&i>=8&&(s=s.next((()=>this.bi(e,a)))),r<9&&i>=9&&(s=s.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(s=s.next((()=>this.Di(a)))),r<11&&i>=11&&(s=s.next((()=>{(function(u){u.createObjectStore($v,{keyPath:eG})})(e),(function(u){u.createObjectStore(Hv,{keyPath:tG})})(e)}))),r<12&&i>=12&&(s=s.next((()=>{(function(u){const d=u.createObjectStore(Yv,{keyPath:lG});d.createIndex(i_,cG,{unique:!1}),d.createIndex(gP,uG,{unique:!1})})(e)}))),r<13&&i>=13&&(s=s.next((()=>(function(u){const d=u.createObjectStore(X0,{keyPath:H7});d.createIndex(v0,Y7),d.createIndex(dP,K7)})(e))).next((()=>this.Ci(e,a))).next((()=>e.deleteObjectStore(Wl)))),r<14&&i>=14&&(s=s.next((()=>this.Fi(e,a)))),r<15&&i>=15&&(s=s.next((()=>(function(u){u.createObjectStore(Ww,{keyPath:nG,autoIncrement:!0}).createIndex(r_,rG,{unique:!1}),u.createObjectStore(Ah,{keyPath:iG}).createIndex(hP,aG,{unique:!1}),u.createObjectStore(Ch,{keyPath:sG}).createIndex(pP,oG,{unique:!1})})(e)))),r<16&&i>=16&&(s=s.next((()=>{t.objectStore(Ah).clear()})).next((()=>{t.objectStore(Ch).clear()}))),r<17&&i>=17&&(s=s.next((()=>{(function(u){u.createObjectStore(Qw,{keyPath:dG})})(e)}))),r<18&&i>=18&&ON()&&(s=s.next((()=>{t.objectStore(Ah).clear()})).next((()=>{t.objectStore(Ch).clear()}))),s}wi(e){let t=0;return e.store(Wl).ee(((r,i)=>{t+=av(i)})).next((()=>{const r={byteSize:t};return e.store(tp).put(n_,r)}))}yi(e){const t=e.store(ep),r=e.store(Zi);return t.J().next((i=>le.forEach(i,(a=>{const s=IDBKeyRange.bound([a.userId,fc],[a.userId,a.lastAcknowledgedBatchId]);return r.J(oc,s).next((c=>le.forEach(c,(u=>{$e(u.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const d=ec(this.serializer,u);return xO(e,a.userId,d).next((()=>{}))}))))}))))}Si(e){const t=e.store(dd),r=e.store(Wl);return e.store(hc).get(W0).next((i=>{const a=[];return r.ee(((s,c)=>{const u=new Pt(s),d=(function(p){return[0,yr(p)]})(u);a.push(t.get(d).next((h=>h?le.resolve():(p=>t.put({targetId:0,path:yr(p),sequenceNumber:i.highestListenSequenceNumber}))(u))))})).next((()=>le.waitFor(a)))}))}bi(e,t){e.createObjectStore(np,{keyPath:Z7});const r=t.store(np),i=new dS,a=s=>{if(i.add(s)){const c=s.lastSegment(),u=s.popLast();return r.put({collectionId:c,parent:yr(u)})}};return t.store(Wl).ee({X:!0},((s,c)=>{const u=new Pt(s);return a(u.popLast())})).next((()=>t.store(cd).ee({X:!0},(([s,c,u],d)=>{const h=Oa(c);return a(h.popLast())}))))}Di(e){const t=e.store(ud);return t.ee(((r,i)=>{const a=gh(i),s=gO(this.serializer,a);return t.put(s)}))}Ci(e,t){const r=t.store(Wl),i=[];return r.ee(((a,s)=>{const c=t.store(X0),u=(function(p){return p.document?new De(Pt.fromString(p.document.name).popFirst(5)):p.noDocument?De.fromSegments(p.noDocument.path):p.unknownDocument?De.fromSegments(p.unknownDocument.path):Ve(36783)})(s).path.toArray(),d={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:s.readTime||[0,0],unknownDocument:s.unknownDocument,noDocument:s.noDocument,document:s.document,hasCommittedMutations:!!s.hasCommittedMutations};i.push(c.put(d))})).next((()=>le.waitFor(i)))}Fi(e,t){const r=t.store(Zi),i=CO(this.serializer),a=new hS(ty.mi,this.serializer.yt);return r.J().next((s=>{const c=new Map;return s.forEach((u=>{let d=c.get(u.userId)??gt();ec(this.serializer,u).keys().forEach((h=>d=d.add(h))),c.set(u.userId,d)})),le.forEach(c,((u,d)=>{const h=new pr(d),p=Jv.wt(this.serializer,h),m=a.getIndexManager(h),b=ey.wt(h,this.serializer,m,a.referenceDelegate);return new IO(i,b,p,m).recalculateAndSaveOverlaysForDocumentKeys(new a_(t,Lr.ce),u).next()}))}))}}function LR(n){n.createObjectStore(dd,{keyPath:W7}).createIndex(Xw,Q7,{unique:!0}),n.createObjectStore(ud,{keyPath:"targetId"}).createIndex(fP,X7,{unique:!0}),n.createObjectStore(hc)}const Ro="IndexedDbPersistence",Xx=18e5,Wx=5e3,Qx="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",kq="main";class pS{constructor(e,t,r,i,a,s,c,u,d,h,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=a,this.window=s,this.document=c,this.xi=d,this.Oi=h,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!pS.v())throw new Re(ve.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new vq(this,i),this.$i=t+kq,this.serializer=new pO(u),this.Ui=new Xo(this.$i,this.Ni,new Rq(this.serializer)),this.hi=new sq,this.Pi=new pq(this.referenceDelegate,this.serializer),this.remoteDocumentCache=CO(this.serializer),this.Ii=new aq,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&An(Ro,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Re(ve.FAILED_PRECONDITION,Qx);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Lr(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Um(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(hl(e))return Ae(Ro,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ae(Ro,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return sh(e).get(Cu).next((t=>le.resolve(this.es(t))))}ts(e){return Um(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Xx)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=Qn(t,fd);return r.J().next((i=>{const a=this.ss(i,Xx),s=i.filter((c=>a.indexOf(c)===-1));return le.forEach(s,(c=>r.delete(c.clientId))).next((()=>s))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?le.resolve(!0):sh(e).get(Cu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Wx)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Re(ve.FAILED_PRECONDITION,Qx);return!1}}return!(!this.networkEnabled||!this.inForeground)||Um(e).J().next((r=>this.ss(r,Wx).find((i=>{if(this.clientId!==i.clientId){const a=!this.networkEnabled&&i.networkEnabled,s=!this.inForeground&&i.inForeground,c=this.networkEnabled===i.networkEnabled;if(a||s&&c)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Ae(Ro,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Vp,fd],(e=>{const t=new a_(e,Lr.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Um(e).J().next((t=>this.ss(t,Xx).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return ey.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new hq(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Jv.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){Ae(Ro,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",a=(function(u){return u===18?pG:u===17?bP:u===16?hG:u===15?Zw:u===14?yP:u===13?vP:u===12?fG:u===11?mP:void Ve(60245)})(this.Ni);let s;return this.Ui.runTransaction(e,i,a,(c=>(s=new a_(c,this.ci?this.ci.next():Lr.ce),t==="readwrite-primary"?this.Hi(s).next((u=>!!u||this.Yi(s))).next((u=>{if(!u)throw An(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Re(ve.FAILED_PRECONDITION,sP);return r(s)})).next((u=>this.Xi(s).next((()=>u)))):this.Is(s).next((()=>r(s)))))).then((c=>(s.raiseOnCommittedEvent(),c)))}Is(e){return sh(e).get(Cu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Wx)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Re(ve.FAILED_PRECONDITION,Qx)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return sh(e).put(Cu,t)}static v(){return Xo.v()}Zi(e){const t=sh(e);return t.get(Cu).next((r=>this.es(r)?(Ae(Ro,"Releasing primary lease."),t.delete(Cu)):le.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(An(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;PN()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return Ae(Ro,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return An(Ro,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){An("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function sh(n){return Qn(n,Vp)}function Um(n){return Qn(n,fd)}function RO(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class gS{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=gt(),i=gt();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new gS(e,t.fromCache,r,i)}}class Dq{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class kO{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return PN()?8:lP(Wn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const a={result:null};return this.ys(e,t).next((s=>{a.result=s})).next((()=>{if(!a.result)return this.ws(e,t,i,r).next((s=>{a.result=s}))})).next((()=>{if(a.result)return;const s=new Dq;return this.Ss(e,t,s).next((c=>{if(a.result=c,this.Vs)return this.bs(e,t,s,c.size)}))})).next((()=>a.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(Pu()<=wt.DEBUG&&Ae("QueryEngine","SDK will not create cache indexes for query:",Ou(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),le.resolve()):(Pu()<=wt.DEBUG&&Ae("QueryEngine","Query:",Ou(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Pu()<=wt.DEBUG&&Ae("QueryEngine","The SDK decides to create cache indexes for query:",Ou(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,li(t))):le.resolve())}ys(e,t){if(cR(t))return le.resolve(null);let r=li(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=ev(t,null,"F"),r=li(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((a=>{const s=gt(...a);return this.ps.getDocuments(e,s).next((c=>this.indexManager.getMinOffset(e,r).next((u=>{const d=this.Ds(t,c);return this.Cs(t,d,s,u.readTime)?this.ys(e,ev(t,null,"F")):this.vs(e,d,t,u)}))))})))))}ws(e,t,r,i){return cR(t)||i.isEqual(Xe.min())?le.resolve(null):this.ps.getDocuments(e,r).next((a=>{const s=this.Ds(t,a);return this.Cs(t,s,r,i)?le.resolve(null):(Pu()<=wt.DEBUG&&Ae("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ou(t)),this.vs(e,s,t,iP(i,ld)).next((c=>c)))}))}Ds(e,t){let r=new Ut(UP(e));return t.forEach(((i,a)=>{Bp(e,a)&&(r=r.add(a))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,t,r){return Pu()<=wt.DEBUG&&Ae("QueryEngine","Using full collection scan to execute query:",Ou(t)),this.ps.getDocumentsMatchingQuery(e,t,ci.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((a=>(t.forEach((s=>{a=a.insert(s.key,s)})),a)))}}const mS="LocalStore",Nq=3e8;class Mq{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new Qt(it),this.xs=new Fs((a=>Ec(a)),zp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new IO(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function DO(n,e,t,r){return new Mq(n,e,t,r)}async function NO(n,e){const t=Fe(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((a=>(i=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((a=>{const s=[],c=[];let u=gt();for(const d of i){s.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}for(const d of a){c.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}return t.localDocuments.getDocuments(r,u).next((d=>({Ls:d,removedBatchIds:s,addedBatchIds:c})))}))}))}function Pq(n,e){const t=Fe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,u,d,h){const p=d.batch,m=p.keys();let b=le.resolve();return m.forEach((_=>{b=b.next((()=>h.getEntry(u,_))).next((w=>{const E=d.docVersions.get(_);$e(E!==null,48541),w.version.compareTo(E)<0&&(p.applyToRemoteDocument(w,d),w.isValidDocument()&&(w.setReadTime(d.commitVersion),h.addEntry(w)))}))})),b.next((()=>c.mutationQueue.removeMutationBatch(u,p)))})(t,r,e,a).next((()=>a.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let u=gt();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function MO(n){const e=Fe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function Oq(n,e){const t=Fe(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const s=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const c=[];e.targetChanges.forEach(((h,p)=>{const m=i.get(p);if(!m)return;c.push(t.Pi.removeMatchingKeys(a,h.removedDocuments,p).next((()=>t.Pi.addMatchingKeys(a,h.addedDocuments,p))));let b=m.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(p)!==null?b=b.withResumeToken(Cn.EMPTY_BYTE_STRING,Xe.min()).withLastLimboFreeSnapshotVersion(Xe.min()):h.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(h.resumeToken,r)),i=i.insert(p,b),(function(w,E,T){return w.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=Nq?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(m,b,h)&&c.push(t.Pi.updateTargetData(a,b))}));let u=oi(),d=gt();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(a,h))})),c.push(jq(a,s,e.documentUpdates).next((h=>{u=h.ks,d=h.qs}))),!r.isEqual(Xe.min())){const h=t.Pi.getLastRemoteSnapshotVersion(a).next((p=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,r)));c.push(h)}return le.waitFor(c).next((()=>s.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,u,d))).next((()=>u))})).then((a=>(t.Ms=i,a)))}function jq(n,e,t){let r=gt(),i=gt();return t.forEach((a=>r=r.add(a))),e.getEntries(n,r).next((a=>{let s=oi();return t.forEach(((c,u)=>{const d=a.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(Xe.min())?(e.removeEntry(c,u.readTime),s=s.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),s=s.insert(c,u)):Ae(mS,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)})),{ks:s,qs:i}}))}function Vq(n,e){const t=Fe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=fc),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function ov(n,e){const t=Fe(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((a=>a?(i=a,le.resolve(i)):t.Pi.allocateTargetId(r).next((s=>(i=new Ts(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function bd(n,e,t){const r=Fe(n),i=r.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,(s=>r.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!hl(s))throw s;Ae(mS,`Failed to update sequence numbers for target ${e}: ${s}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function b_(n,e,t){const r=Fe(n);let i=Xe.min(),a=gt();return r.persistence.runTransaction("Execute query","readwrite",(s=>(function(u,d,h){const p=Fe(u),m=p.xs.get(h);return m!==void 0?le.resolve(p.Ms.get(m)):p.Pi.getTargetData(d,h)})(r,s,li(e)).next((c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(s,c.targetId).next((u=>{a=u}))})).next((()=>r.Fs.getDocumentsMatchingQuery(s,e,t?i:Xe.min(),t?a:gt()))).next((c=>(jO(r,BP(e),c),{documents:c,Qs:a})))))}function PO(n,e){const t=Fe(n),r=Fe(t.Pi),i=t.Ms.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",(a=>r.At(a,e).next((s=>s?s.target:null))))}function OO(n,e){const t=Fe(n),r=t.Os.get(e)||Xe.min();return t.persistence.runTransaction("Get new document changes","readonly",(i=>t.Ns.getAllFromCollectionGroup(i,e,iP(r,ld),Number.MAX_SAFE_INTEGER))).then((i=>(jO(t,e,i),i)))}function jO(n,e,t){let r=n.Os.get(e)||Xe.min();t.forEach(((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)})),n.Os.set(e,r)}const VO="firestore_clients";function BR(n,e){return`${VO}_${n}_${e}`}const zO="firestore_mutations";function UR(n,e,t){let r=`${zO}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const LO="firestore_targets";function Zx(n,e){return`${LO}_${n}_${e}`}const Pa="SharedClientState";class lv{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ws(e,t,r){const i=JSON.parse(r);let a,s=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return s&&i.error&&(s=typeof i.error.message=="string"&&typeof i.error.code=="string",s&&(a=new Re(i.error.code,i.error.message))),s?new lv(e,t,i.state,a):(An(Pa,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Nh{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ws(e,t){const r=JSON.parse(t);let i,a=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return a&&r.error&&(a=typeof r.error.message=="string"&&typeof r.error.code=="string",a&&(i=new Re(r.error.code,r.error.message))),a?new Nh(e,r.state,i):(An(Pa,`Failed to parse target state for ID '${e}': ${t}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class cv{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const r=JSON.parse(t);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,a=rS();for(let s=0;i&&s<r.activeTargetIds.length;++s)i=cP(r.activeTargetIds[s]),a=a.add(r.activeTargetIds[s]);return i?new cv(e,a):(An(Pa,`Failed to parse client data for instance '${e}': ${t}`),null)}}class vS{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new vS(t.clientId,t.onlineState):(An(Pa,`Failed to parse online state: ${e}`),null)}}class x_{constructor(){this.activeTargetIds=rS()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Jx{constructor(e,t,r,i,a){this.window=e,this.Mi=t,this.persistenceKey=r,this.Js=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new Qt(it),this.started=!1,this.Xs=[];const s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.eo=BR(this.persistenceKey,this.Js),this.no=(function(u){return`firestore_sequence_number_${u}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new x_),this.ro=new RegExp(`^${VO}_${s}_([^_]*)$`),this.io=new RegExp(`^${zO}_${s}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${LO}_${s}_(\\d+)$`),this.oo=(function(u){return`firestore_online_state_${u}`})(this.persistenceKey),this._o=(function(u){return`firestore_bundle_loaded_v2_${u}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const r of e){if(r===this.Js)continue;const i=this.getItem(BR(this.persistenceKey,r));if(i){const a=cv.Ws(r,i);a&&(this.Zs=this.Zs.insert(a.clientId,a))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const r=this.uo(t);r&&this.co(r)}for(const r of this.Xs)this.Ys(r);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach(((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,r){this.ho(e,t,r),this.Po(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Zx(this.persistenceKey,e));if(i){const a=Nh.Ws(e,i);a&&(r=a.state)}}return t&&this.To.zs(e),this.ao(),r}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Zx(this.persistenceKey,e))}updateQueryState(e,t,r){this.Io(e,t,r)}handleUserChange(e,t,r){t.forEach((i=>{this.Po(i)})),this.currentUser=e,r.forEach((i=>{this.addPendingMutation(i)}))}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Ae(Pa,"READ",e,t),t}setItem(e,t){Ae(Pa,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){Ae(Pa,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(Ae(Pa,"EVENT",t.key,t.newValue),t.key===this.eo)return void An("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.ro.test(t.key)){if(t.newValue==null){const r=this.Ro(t.key);return this.Vo(r,null)}{const r=this.mo(t.key,t.newValue);if(r)return this.Vo(r.clientId,r)}}else if(this.io.test(t.key)){if(t.newValue!==null){const r=this.fo(t.key,t.newValue);if(r)return this.po(r)}}else if(this.so.test(t.key)){if(t.newValue!==null){const r=this.yo(t.key,t.newValue);if(r)return this.wo(r)}}else if(t.key===this.oo){if(t.newValue!==null){const r=this.uo(t.newValue);if(r)return this.co(r)}}else if(t.key===this.no){const r=(function(a){let s=Lr.ce;if(a!=null)try{const c=JSON.parse(a);$e(typeof c=="number",30636,{So:a}),s=c}catch(c){An(Pa,"Failed to read sequence number from WebStorage",c)}return s})(t.newValue);r!==Lr.ce&&this.sequenceNumberHandler(r)}else if(t.key===this._o){const r=this.bo(t.newValue);await Promise.all(r.map((i=>this.syncEngine.Do(i))))}}}else this.Xs.push(t)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,r){const i=new lv(this.currentUser,e,t,r),a=UR(this.persistenceKey,this.currentUser,e);this.setItem(a,i.Gs())}Po(e){const t=UR(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,r){const i=Zx(this.persistenceKey,e),a=new Nh(e,t,r);this.setItem(i,a.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const r=this.Ro(e);return cv.Ws(r,t)}fo(e,t){const r=this.io.exec(e),i=Number(r[1]),a=r[2]!==void 0?r[2]:null;return lv.Ws(new pr(a),i,t)}yo(e,t){const r=this.so.exec(e),i=Number(r[1]);return Nh.Ws(i,t)}uo(e){return vS.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);Ae(Pa,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const r=t?this.Zs.insert(e,t):this.Zs.remove(e),i=this.lo(this.Zs),a=this.lo(r),s=[],c=[];return a.forEach((u=>{i.has(u)||s.push(u)})),i.forEach((u=>{a.has(u)||c.push(u)})),this.syncEngine.Fo(s,c).then((()=>{this.Zs=r}))}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=rS();return e.forEach(((r,i)=>{t=t.unionWith(i.activeTargetIds)})),t}}class BO{constructor(){this.Mo=new x_,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new x_,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class zq{Oo(e){}shutdown(){}}const FR="ConnectivityMonitor";class GR{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ae(FR,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ae(FR,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Fm=null;function __(){return Fm===null?Fm=(function(){return 268435456+Math.round(2147483648*Math.random())})():Fm++,"0x"+Fm.toString(16)}const e1="RestConnection",Lq={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Bq{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===Q0?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,a){const s=__(),c=this.zo(e,t.toUriEncodedString());Ae(e1,`Sending RPC '${e}' ${s}:`,c,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,a);const{host:d}=new URL(c),h=Pd(d);return this.Jo(e,c,u,r,h).then((p=>(Ae(e1,`Received RPC '${e}' ${s}: `,p),p)),(p=>{throw Qh(e1,`RPC '${e}' ${s} failed with error: `,p,"url: ",c,"request:",r),p}))}Ho(e,t,r,i,a,s){return this.Go(e,t,r,i,a)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Vd})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,a)=>e[a]=i)),r&&r.headers.forEach(((i,a)=>e[a]=i))}zo(e,t){const r=Lq[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class Uq{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const hr="WebChannelConnection";class Fq extends Bq{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,a){const s=__();return new Promise(((c,u)=>{const d=new XM;d.setWithCredentials(!0),d.listenOnce(WM.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case p0.NO_ERROR:const p=d.getResponseJson();Ae(hr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),c(p);break;case p0.TIMEOUT:Ae(hr,`RPC '${e}' ${s} timed out`),u(new Re(ve.DEADLINE_EXCEEDED,"Request time out"));break;case p0.HTTP_ERROR:const m=d.getStatus();if(Ae(hr,`RPC '${e}' ${s} failed with status:`,m,"response text:",d.getResponseText()),m>0){let b=d.getResponseJson();Array.isArray(b)&&(b=b[0]);const _=b?.error;if(_&&_.status&&_.message){const w=(function(T){const C=T.toLowerCase().replace(/_/g,"-");return Object.values(ve).indexOf(C)>=0?C:ve.UNKNOWN})(_.status);u(new Re(w,_.message))}else u(new Re(ve.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new Re(ve.UNAVAILABLE,"Connection failed."));break;default:Ve(9055,{l_:e,streamId:s,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Ae(hr,`RPC '${e}' ${s} completed.`)}}));const h=JSON.stringify(i);Ae(hr,`RPC '${e}' ${s} sending request:`,i),d.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=__(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=JM(),c=ZM(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const h=a.join("");Ae(hr,`Creating RPC '${e}' stream ${i}: ${h}`,u);const p=s.createWebChannel(h,u);this.I_(p);let m=!1,b=!1;const _=new Uq({Yo:E=>{b?Ae(hr,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(m||(Ae(hr,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),Ae(hr,`RPC '${e}' stream ${i} sending:`,E),p.send(E))},Zo:()=>p.close()}),w=(E,T,C)=>{E.listen(T,(k=>{try{C(k)}catch(j){setTimeout((()=>{throw j}),0)}}))};return w(p,fh.EventType.OPEN,(()=>{b||(Ae(hr,`RPC '${e}' stream ${i} transport opened.`),_.o_())})),w(p,fh.EventType.CLOSE,(()=>{b||(b=!0,Ae(hr,`RPC '${e}' stream ${i} transport closed`),_.a_(),this.E_(p))})),w(p,fh.EventType.ERROR,(E=>{b||(b=!0,Qh(hr,`RPC '${e}' stream ${i} transport errored. Name:`,E.name,"Message:",E.message),_.a_(new Re(ve.UNAVAILABLE,"The operation could not be completed")))})),w(p,fh.EventType.MESSAGE,(E=>{if(!b){const T=E.data[0];$e(!!T,16349);const C=T,k=C?.error||C[0]?.error;if(k){Ae(hr,`RPC '${e}' stream ${i} received error:`,k);const j=k.status;let P=(function(I){const D=Ln[I];if(D!==void 0)return eO(D)})(j),N=k.message;P===void 0&&(P=ve.INTERNAL,N="Unknown error status: "+j+" with message "+k.message),b=!0,_.a_(new Re(P,N)),p.close()}else Ae(hr,`RPC '${e}' stream ${i} received:`,T),_.u_(T)}})),w(c,QM.STAT_EVENT,(E=>{E.stat===J1.PROXY?Ae(hr,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===J1.NOPROXY&&Ae(hr,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{_.__()}),0),_}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function UO(){return typeof window<"u"?window:null}function E0(){return typeof document<"u"?document:null}function ny(n){return new KG(n,!0)}class FO{constructor(e,t,r=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&Ae("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const qR="PersistentStream";class GO{constructor(e,t,r,i,a,s,c,u){this.Mi=e,this.S_=r,this.b_=i,this.connection=a,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new FO(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ve.RESOURCE_EXHAUSTED?(An(t.toString()),An("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ve.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new Re(ve.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ae(qR,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Ae(qR,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Gq extends GO{constructor(e,t,r,i,a,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=QG(this.serializer,e),r=(function(a){if(!("targetChange"in a))return Xe.min();const s=a.targetChange;return s.targetIds&&s.targetIds.length?Xe.min():s.readTime?Rr(s.readTime):Xe.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=p_(this.serializer),t.addTarget=(function(a,s){let c;const u=s.target;if(c=Z0(u)?{documents:lO(a,u)}:{query:cO(a,u).ft},c.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){c.resumeToken=rO(a,s.resumeToken);const d=f_(a,s.expectedCount);d!==null&&(c.expectedCount=d)}else if(s.snapshotVersion.compareTo(Xe.min())>0){c.readTime=yd(a,s.snapshotVersion.toTimestamp());const d=f_(a,s.expectedCount);d!==null&&(c.expectedCount=d)}return c})(this.serializer,e);const r=JG(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=p_(this.serializer),t.removeTarget=e,this.q_(t)}}class qq extends GO{constructor(e,t,r,i,a,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,s),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return $e(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,$e(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){$e(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=ZG(e.writeResults,e.commitTime),r=Rr(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=p_(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>nv(this.serializer,r)))};this.q_(t)}}class $q{}class Hq extends $q{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Re(ve.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,s])=>this.connection.Go(e,h_(t,r),i,a,s))).catch((a=>{throw a.name==="FirebaseError"?(a.code===ve.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Re(ve.UNKNOWN,a.toString())}))}Ho(e,t,r,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,c])=>this.connection.Ho(e,h_(t,r),i,s,c,a))).catch((s=>{throw s.name==="FirebaseError"?(s.code===ve.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Re(ve.UNKNOWN,s.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Yq{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(An(t),this.aa=!1):Ae("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Rc="RemoteStore";class Kq{constructor(e,t,r,i,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((s=>{r.enqueueAndForget((async()=>{jc(this)&&(Ae(Rc,"Restarting streams for network reachability change."),await(async function(u){const d=Fe(u);d.Ea.add(4),await qp(d),d.Ra.set("Unknown"),d.Ea.delete(4),await ry(d)})(this))}))})),this.Ra=new Yq(r,i)}}async function ry(n){if(jc(n))for(const e of n.da)await e(!0)}async function qp(n){for(const e of n.da)await e(!1)}function iy(n,e){const t=Fe(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),xS(t)?bS(t):Ud(t).O_()&&yS(t,e))}function xd(n,e){const t=Fe(n),r=Ud(t);t.Ia.delete(e),r.O_()&&qO(t,e),t.Ia.size===0&&(r.O_()?r.L_():jc(t)&&t.Ra.set("Unknown"))}function yS(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Xe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ud(n).Y_(e)}function qO(n,e){n.Va.Ue(e),Ud(n).Z_(e)}function bS(n){n.Va=new qG({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Ud(n).start(),n.Ra.ua()}function xS(n){return jc(n)&&!Ud(n).x_()&&n.Ia.size>0}function jc(n){return Fe(n).Ea.size===0}function $O(n){n.Va=void 0}async function Xq(n){n.Ra.set("Online")}async function Wq(n){n.Ia.forEach(((e,t)=>{yS(n,e)}))}async function Qq(n,e){$O(n),xS(n)?(n.Ra.ha(e),bS(n)):n.Ra.set("Unknown")}async function Zq(n,e,t){if(n.Ra.set("Online"),e instanceof nO&&e.state===2&&e.cause)try{await(async function(i,a){const s=a.cause;for(const c of a.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,s),i.Ia.delete(c),i.Va.removeTarget(c))})(n,e)}catch(r){Ae(Rc,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await uv(n,r)}else if(e instanceof w0?n.Va.Ze(e):e instanceof tO?n.Va.st(e):n.Va.tt(e),!t.isEqual(Xe.min()))try{const r=await MO(n.localStore);t.compareTo(r)>=0&&await(function(a,s){const c=a.Va.Tt(s);return c.targetChanges.forEach(((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const h=a.Ia.get(d);h&&a.Ia.set(d,h.withResumeToken(u.resumeToken,s))}})),c.targetMismatches.forEach(((u,d)=>{const h=a.Ia.get(u);if(!h)return;a.Ia.set(u,h.withResumeToken(Cn.EMPTY_BYTE_STRING,h.snapshotVersion)),qO(a,u);const p=new Ts(h.target,u,d,h.sequenceNumber);yS(a,p)})),a.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){Ae(Rc,"Failed to raise snapshot:",r),await uv(n,r)}}async function uv(n,e,t){if(!hl(e))throw e;n.Ea.add(1),await qp(n),n.Ra.set("Offline"),t||(t=()=>MO(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Ae(Rc,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await ry(n)}))}function HO(n,e){return e().catch((t=>uv(n,t,e)))}async function Bd(n){const e=Fe(n),t=nl(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:fc;for(;Jq(e);)try{const i=await Vq(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,e$(e,i)}catch(i){await uv(e,i)}YO(e)&&KO(e)}function Jq(n){return jc(n)&&n.Ta.length<10}function e$(n,e){n.Ta.push(e);const t=nl(n);t.O_()&&t.X_&&t.ea(e.mutations)}function YO(n){return jc(n)&&!nl(n).x_()&&n.Ta.length>0}function KO(n){nl(n).start()}async function t$(n){nl(n).ra()}async function n$(n){const e=nl(n);for(const t of n.Ta)e.ea(t.mutations)}async function r$(n,e,t){const r=n.Ta.shift(),i=sS.from(r,e,t);await HO(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await Bd(n)}async function i$(n,e){e&&nl(n).X_&&await(async function(r,i){if((function(s){return UG(s)&&s!==ve.ABORTED})(i.code)){const a=r.Ta.shift();nl(r).B_(),await HO(r,(()=>r.remoteSyncer.rejectFailedWrite(a.batchId,i))),await Bd(r)}})(n,e),YO(n)&&KO(n)}async function $R(n,e){const t=Fe(n);t.asyncQueue.verifyOperationInProgress(),Ae(Rc,"RemoteStore received new credentials");const r=jc(t);t.Ea.add(3),await qp(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await ry(t)}async function w_(n,e){const t=Fe(n);e?(t.Ea.delete(2),await ry(t)):e||(t.Ea.add(2),await qp(t),t.Ra.set("Unknown"))}function Ud(n){return n.ma||(n.ma=(function(t,r,i){const a=Fe(t);return a.sa(),new Gq(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:Xq.bind(null,n),t_:Wq.bind(null,n),r_:Qq.bind(null,n),H_:Zq.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),xS(n)?bS(n):n.Ra.set("Unknown")):(await n.ma.stop(),$O(n))}))),n.ma}function nl(n){return n.fa||(n.fa=(function(t,r,i){const a=Fe(t);return a.sa(),new qq(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:t$.bind(null,n),r_:i$.bind(null,n),ta:n$.bind(null,n),na:r$.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Bd(n)):(await n.fa.stop(),n.Ta.length>0&&(Ae(Rc,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class _S{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Ua,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((s=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,a){const s=Date.now()+r,c=new _S(e,t,s,i,a);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Re(ve.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function wS(n,e){if(An("AsyncQueue",`${e}: ${n}`),hl(n))return new Re(ve.UNAVAILABLE,`${e}: ${n}`);throw n}class nd{static emptySet(e){return new nd(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||De.comparator(t.key,r.key):(t,r)=>De.comparator(t.key,r.key),this.keyedMap=hh(),this.sortedSet=new Qt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof nd)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new nd;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class HR{constructor(){this.ga=new Qt(De.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ve(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class _d{constructor(e,t,r,i,a,s,c,u,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=s,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,a){const s=[];return t.forEach((c=>{s.push({type:0,doc:c})})),new _d(e,t,nd.emptySet(t),s,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Wv(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class a${constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class s${constructor(){this.queries=YR(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=Fe(t),a=i.queries;i.queries=YR(),a.forEach(((s,c)=>{for(const u of c.Sa)u.onError(r)}))})(this,new Re(ve.ABORTED,"Firestore shutting down"))}}function YR(){return new Fs((n=>LP(n)),Wv)}async function SS(n,e){const t=Fe(n);let r=3;const i=e.query;let a=t.queries.get(i);a?!a.ba()&&e.Da()&&(r=2):(a=new a$,r=e.Da()?0:1);try{switch(r){case 0:a.wa=await t.onListen(i,!0);break;case 1:a.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(s){const c=wS(s,`Initialization of query '${Ou(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&TS(t)}async function ES(n,e){const t=Fe(n),r=e.query;let i=3;const a=t.queries.get(r);if(a){const s=a.Sa.indexOf(e);s>=0&&(a.Sa.splice(s,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function o$(n,e){const t=Fe(n);let r=!1;for(const i of e){const a=i.query,s=t.queries.get(a);if(s){for(const c of s.Sa)c.Fa(i)&&(r=!0);s.wa=i}}r&&TS(t)}function l$(n,e,t){const r=Fe(n),i=r.queries.get(e);if(i)for(const a of i.Sa)a.onError(t);r.queries.delete(e)}function TS(n){n.Ca.forEach((e=>{e.next()}))}var S_,KR;(KR=S_||(S_={})).Ma="default",KR.Cache="cache";class AS{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new _d(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=_d.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==S_.Cache}}class XO{constructor(e){this.key=e}}class WO{constructor(e){this.key=e}}class c${constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=gt(),this.mutatedKeys=gt(),this.eu=UP(e),this.tu=new nd(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new HR,i=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,s=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,p)=>{const m=i.get(h),b=Bp(this.query,p)?p:null,_=!!m&&this.mutatedKeys.has(m.key),w=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let E=!1;m&&b?m.data.isEqual(b.data)?_!==w&&(r.track({type:3,doc:b}),E=!0):this.su(m,b)||(r.track({type:2,doc:b}),E=!0,(u&&this.eu(b,u)>0||d&&this.eu(b,d)<0)&&(c=!0)):!m&&b?(r.track({type:0,doc:b}),E=!0):m&&!b&&(r.track({type:1,doc:m}),E=!0,(u||d)&&(c=!0)),E&&(b?(s=s.add(b),a=w?a.add(h):a.delete(h)):(s=s.delete(h),a=a.delete(h)))})),this.query.limit!==null)for(;s.size>this.query.limit;){const h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),a=a.delete(h.key),r.track({type:1,doc:h})}return{tu:s,iu:r,Cs:c,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort(((h,p)=>(function(b,_){const w=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ve(20277,{Rt:E})}};return w(b)-w(_)})(h.type,p.type)||this.eu(h.doc,p.doc))),this.ou(r),i=i??!1;const c=t&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,d=u!==this.Za;return this.Za=u,s.length!==0||d?{snapshot:new _d(this.query,e.tu,a,s,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new HR,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=gt(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new WO(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new XO(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=gt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return _d.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Fd="SyncEngine";class u${constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class d${constructor(e){this.key=e,this.hu=!1}}class f${constructor(e,t,r,i,a,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new Fs((c=>LP(c)),Wv),this.Iu=new Map,this.Eu=new Set,this.du=new Qt(De.comparator),this.Au=new Map,this.Ru=new fS,this.Vu={},this.mu=new Map,this.fu=Ic.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function h$(n,e,t=!0){const r=ay(n);let i;const a=r.Tu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await QO(r,e,t,!0),i}async function p$(n,e){const t=ay(n);await QO(t,e,!0,!1)}async function QO(n,e,t,r){const i=await ov(n.localStore,li(e)),a=i.targetId,s=n.sharedClientState.addLocalQueryTarget(a,t);let c;return r&&(c=await CS(n,e,a,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&iy(n.remoteStore,i),c}async function CS(n,e,t,r,i){n.pu=(p,m,b)=>(async function(w,E,T,C){let k=E.view.ru(T);k.Cs&&(k=await b_(w.localStore,E.query,!1).then((({documents:A})=>E.view.ru(A,k))));const j=C&&C.targetChanges.get(E.targetId),P=C&&C.targetMismatches.get(E.targetId)!=null,N=E.view.applyChanges(k,w.isPrimaryClient,j,P);return E_(w,E.targetId,N.au),N.snapshot})(n,p,m,b);const a=await b_(n.localStore,e,!0),s=new c$(e,a.Qs),c=s.ru(a.documents),u=Gp.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=s.applyChanges(c,n.isPrimaryClient,u);E_(n,t,d.au);const h=new u$(e,t,s);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),d.snapshot}async function g$(n,e,t){const r=Fe(n),i=r.Tu.get(e),a=r.Iu.get(i.targetId);if(a.length>1)return r.Iu.set(i.targetId,a.filter((s=>!Wv(s,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await bd(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&xd(r.remoteStore,i.targetId),wd(r,i.targetId)})).catch(fl)):(wd(r,i.targetId),await bd(r.localStore,i.targetId,!0))}async function m$(n,e){const t=Fe(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),xd(t.remoteStore,r.targetId))}async function v$(n,e,t){const r=DS(n);try{const i=await(function(s,c){const u=Fe(s),d=pt.now(),h=c.reduce(((b,_)=>b.add(_.key)),gt());let p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",(b=>{let _=oi(),w=gt();return u.Ns.getEntries(b,h).next((E=>{_=E,_.forEach(((T,C)=>{C.isValidDocument()||(w=w.add(T))}))})).next((()=>u.localDocuments.getOverlayedDocuments(b,_))).next((E=>{p=E;const T=[];for(const C of c){const k=LG(C,p.get(C.key).overlayedDocument);k!=null&&T.push(new Gs(C.key,k,RP(k.value.mapValue),Xn.exists(!0)))}return u.mutationQueue.addMutationBatch(b,d,T,c)})).next((E=>{m=E;const T=E.applyToLocalDocumentSet(p,w);return u.documentOverlayCache.saveOverlays(b,E.batchId,T)}))})).then((()=>({batchId:m.batchId,changes:GP(p)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(s,c,u){let d=s.Vu[s.currentUser.toKey()];d||(d=new Qt(it)),d=d.insert(c,u),s.Vu[s.currentUser.toKey()]=d})(r,i.batchId,t),await gl(r,i.changes),await Bd(r.remoteStore)}catch(i){const a=wS(i,"Failed to persist write");t.reject(a)}}async function ZO(n,e){const t=Fe(n);try{const r=await Oq(t.localStore,e);e.targetChanges.forEach(((i,a)=>{const s=t.Au.get(a);s&&($e(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.hu=!0:i.modifiedDocuments.size>0?$e(s.hu,14607):i.removedDocuments.size>0&&($e(s.hu,42227),s.hu=!1))})),await gl(t,r,e)}catch(r){await fl(r)}}function XR(n,e,t){const r=Fe(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((a,s)=>{const c=s.view.va(e);c.snapshot&&i.push(c.snapshot)})),(function(s,c){const u=Fe(s);u.onlineState=c;let d=!1;u.queries.forEach(((h,p)=>{for(const m of p.Sa)m.va(c)&&(d=!0)})),d&&TS(u)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function y$(n,e,t){const r=Fe(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),a=i&&i.key;if(a){let s=new Qt(De.comparator);s=s.insert(a,bn.newNoDocument(a,Xe.min()));const c=gt().add(a),u=new Fp(Xe.min(),new Map,new Qt(it),s,c);await ZO(r,u),r.du=r.du.remove(a),r.Au.delete(e),kS(r)}else await bd(r.localStore,e,!1).then((()=>wd(r,e,t))).catch(fl)}async function b$(n,e){const t=Fe(n),r=e.batch.batchId;try{const i=await Pq(t.localStore,e);RS(t,r,null),IS(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await gl(t,i)}catch(i){await fl(i)}}async function x$(n,e,t){const r=Fe(n);try{const i=await(function(s,c){const u=Fe(s);return u.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let h;return u.mutationQueue.lookupMutationBatch(d,c).next((p=>($e(p!==null,37113),h=p.keys(),u.mutationQueue.removeMutationBatch(d,p)))).next((()=>u.mutationQueue.performConsistencyCheck(d))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(d,h,c))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h))).next((()=>u.localDocuments.getDocuments(d,h)))}))})(r.localStore,e);RS(r,e,t),IS(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await gl(r,i)}catch(i){await fl(i)}}function IS(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function RS(n,e,t){const r=Fe(n);let i=r.Vu[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function wd(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||JO(n,r)}))}function JO(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(xd(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),kS(n))}function E_(n,e,t){for(const r of t)r instanceof XO?(n.Ru.addReference(r.key,e),_$(n,r)):r instanceof WO?(Ae(Fd,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||JO(n,r.key)):Ve(19791,{wu:r})}function _$(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(Ae(Fd,"New document in limbo: "+t),n.Eu.add(r),kS(n))}function kS(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new De(Pt.fromString(e)),r=n.fu.next();n.Au.set(r,new d$(t)),n.du=n.du.insert(t,r),iy(n.remoteStore,new Ts(li(Lp(t.path)),r,"TargetPurposeLimboResolution",Lr.ce))}}async function gl(n,e,t){const r=Fe(n),i=[],a=[],s=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,u)=>{s.push(r.pu(u,e,t).then((d=>{if((d||t)&&r.isPrimaryClient){const h=d?!d.fromCache:t?.targetChanges.get(u.targetId)?.current;r.sharedClientState.updateQueryState(u.targetId,h?"current":"not-current")}if(d){i.push(d);const h=gS.As(u.targetId,d);a.push(h)}})))})),await Promise.all(s),r.Pu.H_(i),await(async function(u,d){const h=Fe(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>le.forEach(d,(m=>le.forEach(m.Es,(b=>h.persistence.referenceDelegate.addReference(p,m.targetId,b))).next((()=>le.forEach(m.ds,(b=>h.persistence.referenceDelegate.removeReference(p,m.targetId,b)))))))))}catch(p){if(!hl(p))throw p;Ae(mS,"Failed to update sequence numbers: "+p)}for(const p of d){const m=p.targetId;if(!p.fromCache){const b=h.Ms.get(m),_=b.snapshotVersion,w=b.withLastLimboFreeSnapshotVersion(_);h.Ms=h.Ms.insert(m,w)}}})(r.localStore,a))}async function w$(n,e){const t=Fe(n);if(!t.currentUser.isEqual(e)){Ae(Fd,"User change. New user:",e.toKey());const r=await NO(t.localStore,e);t.currentUser=e,(function(a,s){a.mu.forEach((c=>{c.forEach((u=>{u.reject(new Re(ve.CANCELLED,s))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await gl(t,r.Ls)}}function S$(n,e){const t=Fe(n),r=t.Au.get(e);if(r&&r.hu)return gt().add(r.key);{let i=gt();const a=t.Iu.get(e);if(!a)return i;for(const s of a){const c=t.Tu.get(s);i=i.unionWith(c.view.nu)}return i}}async function E$(n,e){const t=Fe(n),r=await b_(t.localStore,e.query,!0),i=e.view.cu(r);return t.isPrimaryClient&&E_(t,e.targetId,i.au),i}async function T$(n,e){const t=Fe(n);return OO(t.localStore,e).then((r=>gl(t,r)))}async function A$(n,e,t,r){const i=Fe(n),a=await(function(c,u){const d=Fe(c),h=Fe(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",(p=>h.er(p,u).next((m=>m?d.localDocuments.getDocuments(p,m):le.resolve(null)))))})(i.localStore,e);a!==null?(t==="pending"?await Bd(i.remoteStore):t==="acknowledged"||t==="rejected"?(RS(i,e,r||null),IS(i,e),(function(c,u){Fe(Fe(c).mutationQueue).ir(u)})(i.localStore,e)):Ve(6720,"Unknown batchState",{Su:t}),await gl(i,a)):Ae(Fd,"Cannot apply mutation batch with id: "+e)}async function C$(n,e){const t=Fe(n);if(ay(t),DS(t),e===!0&&t.gu!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),i=await WR(t,r.toArray());t.gu=!0,await w_(t.remoteStore,!0);for(const a of i)iy(t.remoteStore,a)}else if(e===!1&&t.gu!==!1){const r=[];let i=Promise.resolve();t.Iu.forEach(((a,s)=>{t.sharedClientState.isLocalQueryTarget(s)?r.push(s):i=i.then((()=>(wd(t,s),bd(t.localStore,s,!0)))),xd(t.remoteStore,s)})),await i,await WR(t,r),(function(s){const c=Fe(s);c.Au.forEach(((u,d)=>{xd(c.remoteStore,d)})),c.Ru.Jr(),c.Au=new Map,c.du=new Qt(De.comparator)})(t),t.gu=!1,await w_(t.remoteStore,!1)}}async function WR(n,e,t){const r=Fe(n),i=[],a=[];for(const s of e){let c;const u=r.Iu.get(s);if(u&&u.length!==0){c=await ov(r.localStore,li(u[0]));for(const d of u){const h=r.Tu.get(d),p=await E$(r,h);p.snapshot&&a.push(p.snapshot)}}else{const d=await PO(r.localStore,s);c=await ov(r.localStore,d),await CS(r,e4(d),s,!1,c.resumeToken)}i.push(c)}return r.Pu.H_(a),i}function e4(n){return VP(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function I$(n){return(function(t){return Fe(Fe(t).persistence).Ts()})(Fe(n).localStore)}async function R$(n,e,t,r){const i=Fe(n);if(i.gu)return void Ae(Fd,"Ignoring unexpected query state notification.");const a=i.Iu.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const s=await OO(i.localStore,BP(a[0])),c=Fp.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Cn.EMPTY_BYTE_STRING);await gl(i,s,c);break}case"rejected":await bd(i.localStore,e,!0),wd(i,e,r);break;default:Ve(64155,t)}}async function k$(n,e,t){const r=ay(n);if(r.gu){for(const i of e){if(r.Iu.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){Ae(Fd,"Adding an already active target "+i);continue}const a=await PO(r.localStore,i),s=await ov(r.localStore,a);await CS(r,e4(a),s.targetId,!1,s.resumeToken),iy(r.remoteStore,s)}for(const i of t)r.Iu.has(i)&&await bd(r.localStore,i,!1).then((()=>{xd(r.remoteStore,i),wd(r,i)})).catch(fl)}}function ay(n){const e=Fe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=ZO.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=S$.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=y$.bind(null,e),e.Pu.H_=o$.bind(null,e.eventManager),e.Pu.yu=l$.bind(null,e.eventManager),e}function DS(n){const e=Fe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=b$.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=x$.bind(null,e),e}class up{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ny(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return DO(this.persistence,new kO,e.initialUser,this.serializer)}Cu(e){return new hS(ty.mi,this.serializer)}Du(e){return new BO}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}up.provider={build:()=>new up};class D$ extends up{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){$e(this.persistence.referenceDelegate instanceof sv,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new EO(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?gr.withCacheSize(this.cacheSizeBytes):gr.DEFAULT;return new hS((r=>sv.mi(r,t)),this.serializer)}}class t4 extends up{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await DS(this.xu.syncEngine),await Bd(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return DO(this.persistence,new kO,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new EO(r,e.asyncQueue,t)}Mu(e,t){const r=new F7(t,this.persistence);return new U7(e.asyncQueue,r)}Cu(e){const t=RO(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?gr.withCacheSize(this.cacheSizeBytes):gr.DEFAULT;return new pS(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,UO(),E0(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new BO}}class N$ extends t4{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Jx&&(this.sharedClientState.syncEngine={Co:A$.bind(null,t),vo:R$.bind(null,t),Fo:k$.bind(null,t),Ts:I$.bind(null,t),Do:T$.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async r=>{await C$(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))}Du(e){const t=UO();if(!Jx.v(t))throw new Re(ve.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=RO(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Jx(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class dp{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>XR(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=w$.bind(null,this.syncEngine),await w_(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new s$})()}createDatastore(e){const t=ny(e.databaseInfo.databaseId),r=(function(a){return new Fq(a)})(e.databaseInfo);return(function(a,s,c,u){return new Hq(a,s,c,u)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,a,s,c){return new Kq(r,i,a,s,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>XR(this.syncEngine,t,0)),(function(){return GR.v()?new GR:new zq})())}createSyncEngine(e,t){return(function(i,a,s,c,u,d,h){const p=new f$(i,a,s,c,u,d);return h&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=Fe(t);Ae(Rc,"RemoteStore shutting down."),r.Ea.add(5),await qp(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}dp.provider={build:()=>new dp};class NS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):An("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const rl="FirestoreClient";class M${constructor(e,t,r,i,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=pr.UNAUTHENTICATED,this.clientId=Hw.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,(async s=>{Ae(rl,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,(s=>(Ae(rl,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ua;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=wS(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function t1(n,e){n.asyncQueue.verifyOperationInProgress(),Ae(rl,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await NO(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function QR(n,e){n.asyncQueue.verifyOperationInProgress();const t=await P$(n);Ae(rl,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>$R(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>$R(e.remoteStore,i))),n._onlineComponents=e}async function P$(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ae(rl,"Using user provided OfflineComponentProvider");try{await t1(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===ve.FAILED_PRECONDITION||i.code===ve.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Qh("Error using user provided cache. Falling back to memory cache: "+t),await t1(n,new up)}}else Ae(rl,"Using default OfflineComponentProvider"),await t1(n,new D$(void 0));return n._offlineComponents}async function n4(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ae(rl,"Using user provided OnlineComponentProvider"),await QR(n,n._uninitializedComponentsProvider._online)):(Ae(rl,"Using default OnlineComponentProvider"),await QR(n,new dp))),n._onlineComponents}function O$(n){return n4(n).then((e=>e.syncEngine))}async function dv(n){const e=await n4(n),t=e.eventManager;return t.onListen=h$.bind(null,e.syncEngine),t.onUnlisten=g$.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=p$.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=m$.bind(null,e.syncEngine),t}function j$(n,e,t={}){const r=new Ua;return n.asyncQueue.enqueueAndForget((async()=>(function(a,s,c,u,d){const h=new NS({next:m=>{h.Nu(),s.enqueueAndForget((()=>ES(a,p)));const b=m.docs.has(c);!b&&m.fromCache?d.reject(new Re(ve.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&m.fromCache&&u&&u.source==="server"?d.reject(new Re(ve.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new AS(Lp(c.path),h,{includeMetadataChanges:!0,qa:!0});return SS(a,p)})(await dv(n),n.asyncQueue,e,t,r))),r.promise}function V$(n,e,t={}){const r=new Ua;return n.asyncQueue.enqueueAndForget((async()=>(function(a,s,c,u,d){const h=new NS({next:m=>{h.Nu(),s.enqueueAndForget((()=>ES(a,p))),m.fromCache&&u.source==="server"?d.reject(new Re(ve.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new AS(c,h,{includeMetadataChanges:!0,qa:!0});return SS(a,p)})(await dv(n),n.asyncQueue,e,t,r))),r.promise}function r4(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const ZR=new Map;const z$="firestore.googleapis.com",JR=!0;class ek{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Re(ve.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=z$,this.ssl=JR}else this.host=e.host,this.ssl=e.ssl??JR;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=bO;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<SO)throw new Re(ve.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}z7("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=r4(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Re(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Re(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Re(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class MS{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ek({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Re(ve.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Re(ve.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ek(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new R7;switch(r.type){case"firstParty":return new N7(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Re(ve.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=ZR.get(t);r&&(Ae("ComponentProvider","Removing Datastore"),ZR.delete(t),r.terminate())})(this),Promise.resolve()}}class qs{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new qs(this.firestore,e,this._query)}}class xn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Wo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new xn(this.firestore,e,this._key)}toJSON(){return{type:xn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(jp(t,xn._jsonSchema))return new xn(e,r||null,new De(Pt.fromString(t.referencePath)))}}xn._jsonSchemaVersion="firestore/documentReference/1.0",xn._jsonSchema={type:Fn("string",xn._jsonSchemaVersion),referencePath:Fn("string")};class Wo extends qs{constructor(e,t,r){super(e,t,Lp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new xn(this.firestore,null,new De(e))}withConverter(e){return new Wo(this.firestore,e,this._path)}}function Er(n,e,...t){if(n=Wt(n),nP("collection","path",e),n instanceof MS){const r=Pt.fromString(e,...t);return q2(r),new Wo(n,null,r)}{if(!(n instanceof xn||n instanceof Wo))throw new Re(ve.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Pt.fromString(e,...t));return q2(r),new Wo(n.firestore,null,r)}}function _t(n,e,...t){if(n=Wt(n),arguments.length===1&&(e=Hw.newId()),nP("doc","path",e),n instanceof MS){const r=Pt.fromString(e,...t);return G2(r),new xn(n,null,new De(r))}{if(!(n instanceof xn||n instanceof Wo))throw new Re(ve.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Pt.fromString(e,...t));return G2(r),new xn(n.firestore,n instanceof Wo?n.converter:null,new De(r))}}const tk="AsyncQueue";class nk{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new FO(this,"async_queue_retry"),this._c=()=>{const r=E0();r&&Ae(tk,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=E0();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=E0();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Ua;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!hl(e))throw e;Ae(tk,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,An("INTERNAL UNHANDLED ERROR: ",rk(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=_S.createAndSchedule(this,e,t,r,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&Ve(47125,{Pc:rk(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function rk(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function ik(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const a of r)if(a in i&&typeof i[a]=="function")return!0;return!1})(n,["next","error","complete"])}class Ka extends MS{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new nk,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new nk(e),this._firestoreClient=void 0,await e}}}function L$(n,e,t){t||(t=Q0);const r=Rw(n,"firestore");if(r.isInitialized(t)){const i=r.getImmediate({identifier:t}),a=r.getOptions(t);if(Zo(a,e))return i;throw new Re(ve.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Re(ve.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<SO)throw new Re(ve.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Pd(e.host)&&NN(e.host),r.initialize({options:e,instanceIdentifier:t})}function $p(n){if(n._terminated)throw new Re(ve.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||B$(n),n._firestoreClient}function B$(n){const e=n._freezeSettings(),t=(function(i,a,s,c){return new mG(i,a,s,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,r4(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new M$(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}})(n._componentsProvider))}class Di{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Di(Cn.fromBase64String(e))}catch(t){throw new Re(ve.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Di(Cn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Di._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(jp(e,Di._jsonSchema))return Di.fromBase64String(e.bytes)}}Di._jsonSchemaVersion="firestore/bytes/1.0",Di._jsonSchema={type:Fn("string",Di._jsonSchemaVersion),bytes:Fn("string")};class Hp{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Re(ve.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class sy{constructor(e){this._methodName=e}}class Fa{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Re(ve.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Re(ve.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return it(this._lat,e._lat)||it(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Fa._jsonSchemaVersion}}static fromJSON(e){if(jp(e,Fa._jsonSchema))return new Fa(e.latitude,e.longitude)}}Fa._jsonSchemaVersion="firestore/geoPoint/1.0",Fa._jsonSchema={type:Fn("string",Fa._jsonSchemaVersion),latitude:Fn("number"),longitude:Fn("number")};class Ga{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ga._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(jp(e,Ga._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Ga(e.vectorValues);throw new Re(ve.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ga._jsonSchemaVersion="firestore/vectorValue/1.0",Ga._jsonSchema={type:Fn("string",Ga._jsonSchemaVersion),vectorValues:Fn("object")};const U$=/^__.*__$/;class F${constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Gs(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ld(e,this.data,t,this.fieldTransforms)}}class i4{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Gs(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function a4(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ve(40011,{Ac:n})}}class oy{constructor(e,t,r,i,a,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new oy({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return fv(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(a4(this.Ac)&&U$.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class G${constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||ny(e)}Cc(e,t,r,i=!1){return new oy({Ac:e,methodName:t,Dc:r,path:dn.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Yp(n){const e=n._freezeSettings(),t=ny(n._databaseId);return new G$(n._databaseId,!!e.ignoreUndefinedProperties,t)}function PS(n,e,t,r,i,a={}){const s=n.Cc(a.merge||a.mergeFields?2:0,e,t,i);jS("Data must be an object, but it was:",s,r);const c=l4(r,s);let u,d;if(a.merge)u=new Br(s.fieldMask),d=s.fieldTransforms;else if(a.mergeFields){const h=[];for(const p of a.mergeFields){const m=T_(e,p,t);if(!s.contains(m))throw new Re(ve.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);u4(h,m)||h.push(m)}u=new Br(h),d=s.fieldTransforms.filter((p=>u.covers(p.field)))}else u=null,d=s.fieldTransforms;return new F$(new mr(c),u,d)}class Kp extends sy{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Kp}}function q$(n,e,t){return new oy({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class OS extends sy{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=q$(this,e,!0),r=this.vc.map((a=>Gd(a,t))),i=new Tc(r);return new WP(e.path,i)}isEqual(e){return e instanceof OS&&Zo(this.vc,e.vc)}}function s4(n,e,t,r){const i=n.Cc(1,e,t);jS("Data must be an object, but it was:",i,r);const a=[],s=mr.empty();pl(r,((u,d)=>{const h=VS(e,u,t);d=Wt(d);const p=i.yc(h);if(d instanceof Kp)a.push(h);else{const m=Gd(d,p);m!=null&&(a.push(h),s.set(h,m))}}));const c=new Br(a);return new i4(s,c,i.fieldTransforms)}function o4(n,e,t,r,i,a){const s=n.Cc(1,e,t),c=[T_(e,r,t)],u=[i];if(a.length%2!=0)throw new Re(ve.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<a.length;m+=2)c.push(T_(e,a[m])),u.push(a[m+1]);const d=[],h=mr.empty();for(let m=c.length-1;m>=0;--m)if(!u4(d,c[m])){const b=c[m];let _=u[m];_=Wt(_);const w=s.yc(b);if(_ instanceof Kp)d.push(b);else{const E=Gd(_,w);E!=null&&(d.push(b),h.set(b,E))}}const p=new Br(d);return new i4(h,p,s.fieldTransforms)}function $$(n,e,t,r=!1){return Gd(t,n.Cc(r?4:3,e))}function Gd(n,e){if(c4(n=Wt(n)))return jS("Unsupported field value:",e,n),l4(n,e);if(n instanceof sy)return(function(r,i){if(!a4(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(i);a&&i.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const a=[];let s=0;for(const c of r){let u=Gd(c,i.wc(s));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),s++}return{arrayValue:{values:a}}})(n,e)}return(function(r,i){if((r=Wt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return MG(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=pt.fromDate(r);return{timestampValue:yd(i.serializer,a)}}if(r instanceof pt){const a=new pt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:yd(i.serializer,a)}}if(r instanceof Fa)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Di)return{bytesValue:rO(i.serializer,r._byteString)};if(r instanceof xn){const a=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(a))throw i.Sc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:cS(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Ga)return(function(s,c){return{mapValue:{fields:{[eS]:{stringValue:tS},[hd]:{arrayValue:{values:s.toArray().map((d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return iS(c.serializer,d)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${Fv(r)}`)})(n,e)}function l4(n,e){const t={};return xP(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):pl(n,((r,i)=>{const a=Gd(i,e.mc(r));a!=null&&(t[r]=a)})),{mapValue:{fields:t}}}function c4(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof pt||n instanceof Fa||n instanceof Di||n instanceof xn||n instanceof sy||n instanceof Ga)}function jS(n,e,t){if(!c4(t)||!rP(t)){const r=Fv(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function T_(n,e,t){if((e=Wt(e))instanceof Hp)return e._internalPath;if(typeof e=="string")return VS(n,e);throw fv("Field path arguments must be of type string or ",n,!1,void 0,t)}const H$=new RegExp("[~\\*/\\[\\]]");function VS(n,e,t){if(e.search(H$)>=0)throw fv(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Hp(...e.split("."))._internalPath}catch{throw fv(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function fv(n,e,t,r,i){const a=r&&!r.isEmpty(),s=i!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(a||s)&&(u+=" (found",a&&(u+=` in field ${r}`),s&&(u+=` in document ${i}`),u+=")"),new Re(ve.INVALID_ARGUMENT,c+n+u)}function u4(n,e){return n.some((t=>t.isEqual(e)))}class d4{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new xn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Y$(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ly("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Y$ extends d4{data(){return super.data()}}function ly(n,e){return typeof e=="string"?VS(n,e):e instanceof Hp?e._internalPath:e._delegate._internalPath}function f4(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Re(ve.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class zS{}class LS extends zS{}function oa(n,e,...t){let r=[];e instanceof zS&&r.push(e),r=r.concat(t),(function(a){const s=a.filter((u=>u instanceof BS)).length,c=a.filter((u=>u instanceof cy)).length;if(s>1||s>0&&c>0)throw new Re(ve.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class cy extends LS{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new cy(e,t,r)}_apply(e){const t=this._parse(e);return h4(e._query,t),new qs(e.firestore,e.converter,d_(e._query,t))}_parse(e){const t=Yp(e.firestore);return(function(a,s,c,u,d,h,p){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Re(ve.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){ok(p,h);const _=[];for(const w of p)_.push(sk(u,a,w));m={arrayValue:{values:_}}}else m=sk(u,a,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||ok(p,h),m=$$(c,s,p,h==="in"||h==="not-in");return St.create(d,h,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function K$(n,e,t){const r=e,i=ly("where",n);return cy._create(i,r,t)}class BS extends zS{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new BS(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Bt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,a){let s=i;const c=a.getFlattenedFilters();for(const u of c)h4(s,u),s=d_(s,u)})(e._query,t),new qs(e.firestore,e.converter,d_(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class US extends LS{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new US(e,t)}_apply(e){const t=(function(i,a,s){if(i.startAt!==null)throw new Re(ve.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Re(ve.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new op(a,s)})(e._query,this._field,this._direction);return new qs(e.firestore,e.converter,(function(i,a){const s=i.explicitOrderBy.concat([a]);return new zd(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}}function il(n,e="asc"){const t=e,r=ly("orderBy",n);return US._create(r,t)}class FS extends LS{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new FS(e,t,r)}_apply(e){return new qs(e.firestore,e.converter,ev(e._query,this._limit,this._limitType))}}function ak(n){return FS._create("limit",n,"F")}function sk(n,e,t){if(typeof(t=Wt(t))=="string"){if(t==="")throw new Re(ve.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!zP(e)&&t.indexOf("/")!==-1)throw new Re(ve.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Pt.fromString(t));if(!De.isDocumentKey(r))throw new Re(ve.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ap(n,new De(r))}if(t instanceof xn)return ap(n,t._key);throw new Re(ve.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Fv(t)}.`)}function ok(n,e){if(!Array.isArray(n)||n.length===0)throw new Re(ve.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function h4(n,e){const t=(function(i,a){for(const s of i)for(const c of s.getFlattenedFilters())if(a.indexOf(c.op)>=0)return c.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Re(ve.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Re(ve.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class X${convertValue(e,t="none"){switch(el(e)){case 0:return null;case 1:return e.booleanValue;case 2:return rn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(js(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ve(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return pl(e,((i,a)=>{r[i]=this.convertValue(a,t)})),r}convertVectorValue(e){const t=e.fields?.[hd].arrayValue?.values?.map((r=>rn(r.doubleValue)));return new Ga(t)}convertGeoPoint(e){return new Fa(rn(e.latitude),rn(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Kv(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(rp(e));default:return null}}convertTimestamp(e){const t=Os(e);return new pt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Pt.fromString(e);$e(hO(r),9688,{name:e});const i=new Sc(r.get(1),r.get(3)),a=new De(r.popFirst(5));return i.isEqual(t)||An(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function GS(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class mh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class gc extends d4{constructor(e,t,r,i,a,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new T0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(ly("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Re(ve.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=gc._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}gc._jsonSchemaVersion="firestore/documentSnapshot/1.0",gc._jsonSchema={type:Fn("string",gc._jsonSchemaVersion),bundleSource:Fn("string","DocumentSnapshot"),bundleName:Fn("string"),bundle:Fn("string")};class T0 extends gc{data(e={}){return super.data(e)}}class mc{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new mh(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new T0(this._firestore,this._userDataWriter,r.key,r,new mh(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Re(ve.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map((c=>{const u=new T0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new mh(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:s++}}))}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((c=>a||c.type!==3)).map((c=>{const u=new T0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new mh(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return c.type!==0&&(d=s.indexOf(c.doc.key),s=s.delete(c.doc.key)),c.type!==1&&(s=s.add(c.doc),h=s.indexOf(c.doc.key)),{type:W$(c.type),doc:u,oldIndex:d,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Re(ve.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=mc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Hw.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function W$(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ve(61501,{type:n})}}function n1(n){n=Fr(n,xn);const e=Fr(n.firestore,Ka);return j$($p(e),n._key).then((t=>p4(e,n,t)))}mc._jsonSchemaVersion="firestore/querySnapshot/1.0",mc._jsonSchema={type:Fn("string",mc._jsonSchemaVersion),bundleSource:Fn("string","QuerySnapshot"),bundleName:Fn("string"),bundle:Fn("string")};class qS extends X${constructor(e){super(),this.firestore=e}convertBytes(e){return new Di(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new xn(this.firestore,null,t)}}function ea(n){n=Fr(n,qs);const e=Fr(n.firestore,Ka),t=$p(e),r=new qS(e);return f4(n._query),V$(t,n._query).then((i=>new mc(e,r,n,i)))}function si(n,e,t){n=Fr(n,xn);const r=Fr(n.firestore,Ka),i=GS(n.converter,e,t);return Xp(r,[PS(Yp(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Xn.none())])}function Ma(n,e,t,...r){n=Fr(n,xn);const i=Fr(n.firestore,Ka),a=Yp(i);let s;return s=typeof(e=Wt(e))=="string"||e instanceof Hp?o4(a,"updateDoc",n._key,e,t,r):s4(a,"updateDoc",n._key,e),Xp(i,[s.toMutation(n._key,Xn.exists(!0))])}function ta(n){return Xp(Fr(n.firestore,Ka),[new Up(n._key,Xn.none())])}function uy(n,e){const t=Fr(n.firestore,Ka),r=_t(n),i=GS(n.converter,e);return Xp(t,[PS(Yp(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Xn.exists(!1))]).then((()=>r))}function qd(n,...e){n=Wt(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||ik(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(ik(e[r])){const u=e[r];e[r]=u.next?.bind(u),e[r+1]=u.error?.bind(u),e[r+2]=u.complete?.bind(u)}let a,s,c;if(n instanceof xn)s=Fr(n.firestore,Ka),c=Lp(n._key.path),a={next:u=>{e[r]&&e[r](p4(s,n,u))},error:e[r+1],complete:e[r+2]};else{const u=Fr(n,qs);s=Fr(u.firestore,Ka),c=u._query;const d=new qS(s);a={next:h=>{e[r]&&e[r](new mc(s,d,u,h))},error:e[r+1],complete:e[r+2]},f4(n._query)}return(function(d,h,p,m){const b=new NS(m),_=new AS(h,b,p);return d.asyncQueue.enqueueAndForget((async()=>SS(await dv(d),_))),()=>{b.Nu(),d.asyncQueue.enqueueAndForget((async()=>ES(await dv(d),_)))}})($p(s),c,i,a)}function Xp(n,e){return(function(r,i){const a=new Ua;return r.asyncQueue.enqueueAndForget((async()=>v$(await O$(r),i,a))),a.promise})($p(n),e)}function p4(n,e,t){const r=t.docs.get(e._key),i=new qS(n);return new gc(n,i,e._key,r,new mh(t.hasPendingWrites,t.fromCache),e.converter)}class Q${constructor(e){let t;this.kind="persistent",e?.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=tH(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function Z$(n){return new Q$(n)}class J${constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=dp.provider,this._offlineComponentProvider={build:t=>new t4(t,e?.cacheSizeBytes,this.forceOwnership)}}}class eH{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=dp.provider,this._offlineComponentProvider={build:t=>new N$(t,e?.cacheSizeBytes)}}}function tH(n){return new J$(n?.forceOwnership)}function nH(){return new eH}class rH{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Yp(e)}set(e,t,r){this._verifyNotCommitted();const i=r1(e,this._firestore),a=GS(i.converter,t,r),s=PS(this._dataReader,"WriteBatch.set",i._key,a,i.converter!==null,r);return this._mutations.push(s.toMutation(i._key,Xn.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const a=r1(e,this._firestore);let s;return s=typeof(t=Wt(t))=="string"||t instanceof Hp?o4(this._dataReader,"WriteBatch.update",a._key,t,r,i):s4(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(s.toMutation(a._key,Xn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=r1(e,this._firestore);return this._mutations=this._mutations.concat(new Up(t._key,Xn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Re(ve.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function r1(n,e){if((n=Wt(n)).firestore!==e)throw new Re(ve.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function lk(){return new Kp("deleteField")}function iH(...n){return new OS("arrayUnion",n)}function A_(n){return $p(n=Fr(n,Ka)),new rH(n,(e=>Xp(n,e)))}(function(e,t=!0){(function(i){Vd=i})(Od),ad(new bc("firestore",((r,{instanceIdentifier:i,options:a})=>{const s=r.getProvider("app").getImmediate(),c=new Ka(new k7(r.getProvider("auth-internal")),new M7(s,r.getProvider("app-check-internal")),(function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Re(ve.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Sc(d.options.projectId,h)})(s,i),s);return a={useFetchStreams:t,...a},c._setSettings(a),c}),"PUBLIC").setMultipleInstances(!0)),Yo(L2,B2,e),Yo(L2,B2,"esm2020")})();const aH={apiKey:"AIzaSyCRHcpbVGQrEZUVdO_Ucn4ZarwwPsrON40",authDomain:"personal-budget-pwa-5defb.firebaseapp.com",projectId:"personal-budget-pwa-5defb",storageBucket:"personal-budget-pwa-5defb.firebasestorage.app",messagingSenderId:"137454342284",appId:"1:137454342284:web:0ae73943f9058a4342aba9",measurementId:"G-VMP5DF6273"},g4=LN(aH),Ci=c8(g4),et=L$(g4,{localCache:Z$({tabManager:nH()})}),ck=()=>({url:window.location.origin+"/personal-budget-pwa/",handleCodeInApp:!1}),Gm=n=>({id:n.uid,username:n.email||n.uid,displayName:n.displayName||n.email?.split("@")[0]||"User",email:n.email||void 0}),Mi=qw()(YM(n=>({currentUser:null,isAuthenticated:!1,loginError:null,isLoading:!1,isInitialized:!1,isInitializing:!0,lastAuthTime:null,offlineGracePeriod:10080*60*1e3,lastVerificationEmailSent:null,login:async(e,t)=>{n({isLoading:!0,loginError:null});try{const i=(await H9(Ci,e,t)).user;if(console.log(` Checking email verification for: ${i.email}`),console.log(" emailVerified status:",i.emailVerified),console.log(" Firebase user object:",{uid:i.uid,email:i.email,emailVerified:i.emailVerified,metadata:i.metadata}),!i.emailVerified)return console.log(` BLOCKING LOGIN: Email not verified for ${i.email}`),await h2(Ci),n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:"Please verify your email address before signing in. Check your email for a verification link."}),console.log(` Login blocked: ${i.email} not verified`),!1;console.log(` EMAIL VERIFIED: Allowing login for ${i.email}`);const a=Gm(i);return n({currentUser:a,isAuthenticated:!0,isLoading:!1,loginError:null,lastAuthTime:Date.now()}),console.log(` User logged in: ${a.email}`),!0}catch(r){console.error("Login error:",r),console.error("Error code:",r.code),console.error("Error message:",r.message);let i="Login failed. Please try again.";if(r.code)switch(r.code){case"auth/invalid-email":i="Invalid email address.";break;case"auth/user-disabled":i="This account has been disabled.";break;case"auth/user-not-found":i="No account found with this email.";break;case"auth/wrong-password":i="Incorrect password.";break;case"auth/too-many-requests":i="Too many failed attempts. Please try again later.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break;case"auth/invalid-credential":i="Invalid email or password.";break;default:console.warn(`Unhandled Firebase error code: ${r.code}`),i="Authentication failed. Please try again.";break}else console.warn("Non-Firebase error in login:",r),i="An unexpected error occurred. Please try again.";return n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:i}),!1}},register:async(e,t,r)=>{n({isLoading:!0,loginError:null});try{const a=(await $9(Ci,e,t)).user;await K9(a,{displayName:r}),await f2(a,ck());const s=Gm(a);return n({currentUser:s,isAuthenticated:!1,isLoading:!1,loginError:null,lastVerificationEmailSent:Date.now()}),console.log(` User registered: ${s.email}, verification email sent`),!0}catch(i){console.error("Registration error:",i);let a="Registration failed. Please try again.";switch(i.code){case"auth/email-already-in-use":a="An account with this email already exists.";break;case"auth/invalid-email":a="Invalid email address.";break;case"auth/weak-password":a="Password should be at least 6 characters.";break;case"auth/operation-not-allowed":a="Email/password accounts are not enabled.";break}return n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:a}),!1}},logout:async()=>{try{await h2(Ci),console.log(" User logged out")}catch(e){console.error("Logout error:",e)}},clearError:()=>{n({loginError:null})},sendPasswordReset:async e=>{n({isLoading:!0,loginError:null});try{return await F9(Ci,e),n({isLoading:!1}),!0}catch(t){console.error("Password reset error:",t);let r="Failed to send password reset email. Please try again.";switch(t.code){case"auth/user-not-found":r="No account found with this email.";break;case"auth/invalid-email":r="Invalid email address.";break;case"auth/too-many-requests":r="Too many attempts. Please try again later.";break}return n({isLoading:!1,loginError:r}),!1}},sendEmailVerification:async()=>{const e=Ci.currentUser;if(!e)return n({loginError:"No user is currently signed in."}),!1;n({isLoading:!0,loginError:null});try{return await f2(e,ck()),n({isLoading:!1,lastVerificationEmailSent:Date.now()}),console.log(` Verification email sent to: ${e.email}`),!0}catch(t){console.error("Email verification error:",t);let r="Failed to send verification email. Please try again.";switch(t.code){case"auth/too-many-requests":r="Too many verification emails sent. Please wait before trying again.";break}return n({isLoading:!1,loginError:r}),!1}},resendEmailVerification:async()=>{const e=Mi.getState();if(e.lastVerificationEmailSent){const t=Date.now()-e.lastVerificationEmailSent,r=60*1e3;if(t<r){const i=Math.ceil((r-t)/1e3);return n({loginError:`Please wait ${i} seconds before requesting another verification email.`}),!1}}return e.sendEmailVerification()},checkVerificationStatus:async()=>{const e=Ci.currentUser;if(!e)return!1;try{await e.reload();const t=Ci.currentUser;if(t?.emailVerified){const r=Gm(t);return n({currentUser:r,isAuthenticated:!0,lastAuthTime:Date.now()}),console.log(` Email verified for: ${t.email}`),!0}return!1}catch(t){return console.error("Error checking verification status:",t),!1}},deleteAccount:async e=>{const t=Ci.currentUser;if(!t||!t.email)return n({loginError:"No user is currently signed in."}),!1;n({isLoading:!0,loginError:null});try{const r=Pc.credential(t.email,e);return await B9(t,r),await Z9(t),n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:null,lastAuthTime:null}),console.log(` Account permanently deleted: ${t.email}`),!0}catch(r){console.error("Account deletion error:",r);let i="Failed to delete account. Please try again.";switch(r.code){case"auth/requires-recent-login":i="For security, please log out and log back in before deleting your account.";break;case"auth/wrong-password":i="Incorrect password. Please enter your current password.";break;case"auth/too-many-requests":i="Too many deletion attempts. Please wait before trying again.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break}return n({isLoading:!1,loginError:i}),!1}},confirmPasswordReset:async(e,t)=>{n({isLoading:!0,loginError:null});try{return await G9(Ci,e,t),n({isLoading:!1}),console.log(" Password reset successful"),!0}catch(r){console.error("Password reset confirmation error:",r);let i="Failed to reset password. The link may be expired or invalid.";switch(r.code){case"auth/expired-action-code":i="The password reset link has expired. Please request a new one.";break;case"auth/invalid-action-code":i="The password reset link is invalid. Please request a new one.";break;case"auth/weak-password":i="Password should be at least 6 characters.";break}return n({isLoading:!1,loginError:i}),!1}},initializeAuth:()=>Mi.getState().isInitialized?()=>{}:(n({isInitialized:!1}),Q9(Ci,async r=>{const i=Date.now(),a=Mi.getState(),s=r?Gm(r):null,c=a.lastAuthTime&&i-a.lastAuthTime<a.offlineGracePeriod,d=typeof navigator<"u"&&!navigator.onLine&&a.isAuthenticated&&c&&!s,h=r?r.emailVerified:!0,p=r&&h||!!d,m=r?s:d?a.currentUser:null;if(n({currentUser:m,isAuthenticated:p,isInitialized:!0,isLoading:!1,loginError:null,lastAuthTime:r&&h?i:a.lastAuthTime}),m)if(console.log(` Auth state: User is signed in (${m.email})`,d?"(offline grace period)":h?"(verified)":"(unverified)"),console.log(" Onboarding check:",{isVerified:h,shouldGrantOfflineAccess:d,willCheckOnboarding:h&&!d}),h&&!d){console.log(" Loading budgetStore to check onboarding...");const b=await Ct(()=>Promise.resolve().then(()=>Ete),[]).then(_=>_.useBudgetStore.getState());console.log(" Calling budgetStore.checkAndStartOnboarding()..."),await b.checkAndStartOnboarding()}else console.log(" Skipping onboarding check (not verified or offline grace period)");else console.log(" Auth state: User is signed out")}))}),{name:"auth-storage",partialize:n=>({isAuthenticated:n.isAuthenticated,currentUser:n.currentUser,lastAuthTime:n.lastAuthTime,offlineGracePeriod:n.offlineGracePeriod,lastVerificationEmailSent:n.lastVerificationEmailSent})})),Lt=Object.freeze(Object.defineProperty({__proto__:null,useAuthStore:Mi},Symbol.toStringTag,{value:"Module"})),m4=[{id:"length",label:"Minimum 12 characters",regex:/^.{12,}$/},{id:"uppercase",label:"At least one uppercase letter (A-Z)",regex:/[A-Z]/},{id:"lowercase",label:"At least one lowercase letter (a-z)",regex:/[a-z]/},{id:"number",label:"At least one number (0-9)",regex:/\d/},{id:"special",label:"At least one special character (!@#$%^&*)",regex:/[!@#$%^&*]/}],sH=n=>{if(!n)return{score:0,level:"weak",color:"text-gray-400",label:"Enter password"};const r=m4.map(c=>({...c,met:c.regex.test(n)})).filter(c=>c.met).length;let i,a,s;return r<=1?(i="weak",a="text-red-500",s="Weak"):r<=3?(i="medium",a="text-yellow-500",s="Medium"):r===4?(i="strong",a="text-blue-500",s="Strong"):(i="very-strong",a="text-green-500",s="Very Strong"),{score:r,level:i,color:a,label:s}},dy=n=>{const e=m4.map(i=>({...i,met:i.regex.test(n)})),t=sH(n),r=e.every(i=>i.met);return{requirements:e,strength:t,isValid:r,isEmpty:!n.trim()}},v4=({password:n,className:e=""})=>{const{strength:t,isEmpty:r}=dy(n);return r?null:v.jsxs("div",{className:`flex items-center gap-2 ${e}`,children:[v.jsx("div",{className:"flex-1",children:v.jsx("div",{className:"flex gap-1",children:[1,2,3,4].map(i=>v.jsx("div",{className:`h-1 flex-1 rounded-full ${i<=t.score?t.score<=1?"bg-red-500":t.score<=3?"bg-yellow-500":t.score===4?"bg-blue-500":"bg-green-500":"bg-gray-200 dark:bg-gray-700"}`},i))})}),v.jsx("span",{className:`text-sm font-medium ${t.color}`,children:t.label})]})},y4=({password:n,className:e=""})=>{const{requirements:t,isEmpty:r}=dy(n);return r?null:v.jsx("div",{className:`space-y-1 ${e}`,children:t.map(i=>v.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.met?v.jsx(oF,{className:"h-4 w-4 text-green-500 flex-shrink-0"}):v.jsx(Uv,{className:"h-4 w-4 text-red-500 flex-shrink-0"}),v.jsx("span",{className:i.met?"text-green-700 dark:text-green-300":"text-gray-600 dark:text-gray-400",children:i.label})]},i.id))})},oH=()=>{const[n,e]=U.useState(""),[t,r]=U.useState(""),[i,a]=U.useState(""),[s,c]=U.useState(!1),[u,d]=U.useState(!1),[h,p]=U.useState(!1),[m,b]=U.useState(!1),{login:_,register:w,sendPasswordReset:E,isLoading:T,loginError:C,clearError:k}=Mi(),j=dy(t),P=async A=>{if(A.preventDefault(),k(),n.trim()&&t.trim())if(u){if(!i.trim()||!j.isValid)return;await w(n.trim(),t,i.trim())}else await _(n.trim(),t)},N=async A=>{A.preventDefault(),n.trim()&&await E(n.trim())&&b(!0)};return U.useEffect(()=>{e(""),r(""),a(""),b(!1)},[u,h]),v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsxs("div",{className:"flex flex-col items-center gap-3 mb-2",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"Personal Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"Personal Budget"})]}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Simple envelope budgeting for personal finance"})]})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:h?v.jsxs("form",{onSubmit:N,className:"space-y-6",children:[v.jsxs("div",{className:"text-center mb-2",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Reset Password"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Enter your email and we'll send you a link to reset your password."})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"reset-email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(Q1,{className:"h-5 w-5 text-gray-400"})}),v.jsx("input",{id:"reset-email",type:"email",value:n,onChange:A=>e(A.target.value),className:"w-full pl-10 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"email"})]})]}),m?v.jsxs("div",{className:"text-center py-4",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 dark:bg-green-900/30",children:v.jsx(Q1,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),v.jsx("h3",{className:"mt-3 text-lg font-medium text-gray-900 dark:text-white",children:"Check your email"}),v.jsxs("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:["We've sent a password reset link to ",v.jsx("span",{className:"font-medium",children:n})]}),v.jsxs("button",{type:"button",onClick:()=>p(!1),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[v.jsx(Jo,{className:"-ml-1 mr-2 h-4 w-4"}),"Back to login"]})]}):v.jsxs(v.Fragment,{children:[v.jsx("button",{type:"submit",disabled:T||!n.trim(),className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?"Sending...":"Send Reset Link"}),v.jsx("div",{className:"mt-4 text-center",children:v.jsxs("button",{type:"button",onClick:()=>p(!1),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:[v.jsx(Jo,{className:"inline-block h-4 w-4 -ml-1 mr-1"}),"Back to login"]})})]})]}):v.jsxs("form",{onSubmit:P,className:"space-y-6",children:[v.jsxs("div",{className:"text-center mb-6",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:u?"Create Account":"Sign In"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:u?"Create a new account to get started":"Sign in to your account"})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),v.jsx("input",{id:"email",type:"email",value:n,onChange:A=>e(A.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"username"})]}),u&&v.jsxs("div",{children:[v.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Display Name"}),v.jsx("input",{id:"displayName",type:"text",value:i,onChange:A=>a(A.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your display name",required:!0,disabled:T})]}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"}),!u&&v.jsx("button",{type:"button",onClick:()=>p(!0),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:"Forgot password?"})]}),v.jsxs("div",{className:"relative",children:[v.jsx("input",{id:"password",type:s?"text":"password",value:t,onChange:A=>r(A.target.value),className:`w-full px-3 py-2 pr-10 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white ${u&&t&&!j.isValid?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"Enter your password",required:!0,disabled:T,autoComplete:u?"new-password":"current-password"}),v.jsx("button",{type:"button",onClick:()=>c(!s),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none",disabled:T,children:s?v.jsx(qM,{className:"h-5 w-5"}):v.jsx($M,{className:"h-5 w-5"})})]}),u&&t&&v.jsx("div",{className:"mt-2",children:v.jsx(v4,{password:t})}),u&&t&&v.jsx("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-md",children:v.jsx(y4,{password:t})})]}),C&&v.jsxs("div",{className:"text-red-600 dark:text-red-400 text-sm text-center bg-red-50 dark:bg-red-900/20 p-3 rounded-md",children:[C,C.includes("verify your email")&&v.jsx("div",{className:"mt-3",children:v.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Please check your email and click the verification link to continue."})})]}),v.jsx("button",{type:"submit",disabled:T||!n.trim()||!t.trim()||u&&!i.trim()||u&&!j.isValid,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?u?"Creating Account...":"Signing in...":u?"Create Account":"Sign In"}),v.jsx("div",{className:"mt-6 text-center",children:v.jsxs("button",{type:"button",onClick:()=>{d(!u),p(!1)},className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",disabled:T,children:[v.jsx(h7,{className:"h-4 w-4"}),u?"Already have an account? Sign In":"Don't have an account? Sign Up"]})})]})})]})})},lH=({oobCode:n,onSuccess:e,onCancel:t})=>{const[r,i]=U.useState(""),[a,s]=U.useState(""),[c,u]=U.useState(!1),[d,h]=U.useState(!1),{confirmPasswordReset:p,isLoading:m,loginError:b,clearError:_}=Mi(),w=dy(r);U.useEffect(()=>{_()},[_]);const E=async T=>{if(T.preventDefault(),r!==a||!w.isValid)return;await p(n,r)&&h(!0)};return d?v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-md p-8 text-center",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/30 mb-6",children:v.jsx(q0,{className:"h-10 w-10 text-green-600 dark:text-green-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Password Reset Complete"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"Your password has been successfully updated. You can now log in with your new password."}),v.jsx("button",{onClick:e,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200",children:"Go to Login"})]})}):v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsxs("div",{className:"flex flex-col items-center gap-3 mb-2",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"Personal Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:"Reset Password"})]}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Create a new password for your account"})]})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:v.jsxs("form",{onSubmit:E,className:"space-y-6",children:[v.jsxs("div",{children:[v.jsx("label",{htmlFor:"new-password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"New Password"}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(P2,{className:"h-5 w-5 text-gray-400"})}),v.jsx("input",{id:"new-password",type:c?"text":"password",value:r,onChange:T=>i(T.target.value),className:"w-full pl-10 pr-10 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white transition-colors",placeholder:"Enter new password",required:!0}),v.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-200",onClick:()=>u(!c),children:c?v.jsx(qM,{className:"h-5 w-5"}):v.jsx($M,{className:"h-5 w-5"})})]}),v.jsx("div",{className:"mt-2",children:v.jsx(v4,{password:r})})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Confirm New Password"}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(P2,{className:"h-5 w-5 text-gray-400"})}),v.jsx("input",{id:"confirm-password",type:c?"text":"password",value:a,onChange:T=>s(T.target.value),className:`w-full pl-10 px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white transition-colors ${a&&r!==a?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"Confirm new password",required:!0})]}),a&&r!==a&&v.jsx("p",{className:"mt-1 text-sm text-red-500",children:"Passwords do not match"})]}),v.jsx(y4,{password:r}),b&&v.jsx("div",{className:"p-3 rounded-md bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-400 text-sm",children:b}),v.jsx("button",{type:"submit",disabled:m||!r||!a||r!==a||!w.isValid,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:m?"Updating Password...":"Reset Password"}),v.jsx("div",{className:"text-center",children:v.jsxs("button",{type:"button",onClick:t,className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium inline-flex items-center",children:[v.jsx(Jo,{className:"h-4 w-4 mr-1"}),"Back to Login"]})})]})})]})})},b4=()=>{const[n,e]=U.useState(!1),[t,r]=U.useState(!1),{currentUser:i,resendEmailVerification:a,checkVerificationStatus:s,logout:c,loginError:u}=Mi();U.useEffect(()=>{i||console.warn("EmailVerificationView: No current user, this should not happen")},[i]),U.useEffect(()=>{const p=()=>{console.log("Window focused, checking verification status..."),s()};return window.addEventListener("focus",p),()=>window.removeEventListener("focus",p)},[s]);const d=async()=>{e(!0),r(!1);const p=await a();e(!1),p&&(r(!0),setTimeout(()=>r(!1),3e3))},h=async()=>{await c()};return i?v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsx("div",{className:"flex flex-col items-center gap-3 mb-2",children:v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"House Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"House Budget"})]})})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/30 mb-4",children:v.jsx(Q1,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Check your email"}),v.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["We've sent a verification link to"," ",v.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:i.email})]}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 mb-6",children:v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(q0,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),v.jsxs("div",{className:"text-left",children:[v.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium",children:"What to do next:"}),v.jsxs("ol",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1 space-y-1",children:[v.jsx("li",{children:"1. Open your email inbox"}),v.jsx("li",{children:"2. Find the email from House Budget"}),v.jsx("li",{children:'3. Click the "Verify Email" link'}),v.jsx("li",{children:"4. Return here and sign in"})]})]})]})}),u&&v.jsx("div",{className:"text-red-600 dark:text-red-400 text-sm mb-4 p-3 bg-red-50 dark:bg-red-900/20 rounded-md",children:u}),t&&v.jsx("div",{className:"text-green-600 dark:text-green-400 text-sm mb-4 p-3 bg-green-50 dark:bg-green-900/20 rounded-md",children:"Verification email sent successfully!"}),v.jsx("button",{onClick:d,disabled:n,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed mb-4 flex items-center justify-center gap-2",children:n?v.jsxs(v.Fragment,{children:[v.jsx(Kh,{className:"h-4 w-4 animate-spin"}),"Sending..."]}):v.jsxs(v.Fragment,{children:[v.jsx(Kh,{className:"h-4 w-4"}),"Resend verification email"]})}),v.jsxs("button",{onClick:h,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",children:[v.jsx(Jo,{className:"h-4 w-4"}),"Back to sign in"]})]})}),v.jsx("div",{className:"text-center",children:v.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Didn't receive the email? Check your spam folder or try resending."})})]})}):null},x4=({message:n="Loading your budget...",showTimeout:e=!1})=>v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex flex-col items-center justify-center px-4",children:[v.jsx("div",{className:"mb-8",children:v.jsxs("div",{className:"relative",children:[v.jsx(Kh,{size:48,className:"text-blue-500 animate-spin"}),v.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:v.jsx(Bv,{size:24,className:"text-blue-600 dark:text-blue-400"})})]})}),v.jsxs("div",{className:"text-center space-y-3",children:[v.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400 max-w-md",children:"This may take a moment on slow connections. We're fetching your budget data securely."})]}),v.jsxs("div",{className:"mt-12 w-full max-w-md space-y-4",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("div",{className:"h-6 bg-gray-200 dark:bg-zinc-700 rounded w-24 animate-pulse"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]})]})}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsx("div",{className:"h-4 bg-gray-200 dark:bg-zinc-700 rounded w-32 mb-2 animate-pulse"}),v.jsx("div",{className:"h-8 bg-gray-200 dark:bg-zinc-700 rounded w-20 animate-pulse"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-28 animate-pulse"}),v.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-32 animate-pulse"}),v.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]})]}),e&&v.jsx("div",{className:"mt-8 p-4 bg-amber-50 dark:bg-amber-900/20 rounded-xl border border-amber-200 dark:border-amber-800 max-w-md",children:v.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200 text-center",children:"This is taking longer than usual. If you're on a very slow connection, this is normal. Your data will load shortly."})}),v.jsx("div",{className:"mt-8 w-full max-w-md",children:v.jsx("div",{className:"h-1 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:v.jsx("div",{className:"h-full bg-blue-500 rounded-full animate-pulse",style:{width:"60%"}})})})]}),$S=U.createContext({});function fy(n){const e=U.useRef(null);return e.current===null&&(e.current=n()),e.current}const HS=typeof window<"u",YS=HS?U.useLayoutEffect:U.useEffect,hy=U.createContext(null);function KS(n,e){n.indexOf(e)===-1&&n.push(e)}function XS(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const Vs=(n,e,t)=>t>e?e:t<n?n:t;let WS=()=>{};const zs={},_4=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function w4(n){return typeof n=="object"&&n!==null}const S4=n=>/^0[^.\s]+$/u.test(n);function QS(n){let e;return()=>(e===void 0&&(e=n()),e)}const Pi=n=>n,cH=(n,e)=>t=>e(n(t)),Wp=(...n)=>n.reduce(cH),fp=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r};class ZS{constructor(){this.subscriptions=[]}add(e){return KS(this.subscriptions,e),()=>XS(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let a=0;a<i;a++){const s=this.subscriptions[a];s&&s(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const qa=n=>n*1e3,Ni=n=>n/1e3;function E4(n,e){return e?n*(1e3/e):0}const T4=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,uH=1e-7,dH=12;function fH(n,e,t,r,i){let a,s,c=0;do s=e+(t-e)/2,a=T4(s,r,i)-n,a>0?t=s:e=s;while(Math.abs(a)>uH&&++c<dH);return s}function Qp(n,e,t,r){if(n===e&&t===r)return Pi;const i=a=>fH(a,0,1,n,t);return a=>a===0||a===1?a:T4(i(a),e,r)}const A4=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,C4=n=>e=>1-n(1-e),I4=Qp(.33,1.53,.69,.99),JS=C4(I4),R4=A4(JS),k4=n=>(n*=2)<1?.5*JS(n):.5*(2-Math.pow(2,-10*(n-1))),eE=n=>1-Math.sin(Math.acos(n)),D4=C4(eE),N4=A4(eE),hH=Qp(.42,0,1,1),pH=Qp(0,0,.58,1),M4=Qp(.42,0,.58,1),gH=n=>Array.isArray(n)&&typeof n[0]!="number",P4=n=>Array.isArray(n)&&typeof n[0]=="number",mH={linear:Pi,easeIn:hH,easeInOut:M4,easeOut:pH,circIn:eE,circInOut:N4,circOut:D4,backIn:JS,backInOut:R4,backOut:I4,anticipate:k4},vH=n=>typeof n=="string",uk=n=>{if(P4(n)){WS(n.length===4);const[e,t,r,i]=n;return Qp(e,t,r,i)}else if(vH(n))return mH[n];return n},qm=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function yH(n,e){let t=new Set,r=new Set,i=!1,a=!1;const s=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function u(h){s.has(h)&&(d.schedule(h),n()),h(c)}const d={schedule:(h,p=!1,m=!1)=>{const _=m&&i?t:r;return p&&s.add(h),_.has(h)||_.add(h),h},cancel:h=>{r.delete(h),s.delete(h)},process:h=>{if(c=h,i){a=!0;return}i=!0,[t,r]=[r,t],t.forEach(u),t.clear(),i=!1,a&&(a=!1,d.process(h))}};return d}const bH=40;function O4(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},a=()=>t=!0,s=qm.reduce((k,j)=>(k[j]=yH(a),k),{}),{setup:c,read:u,resolveKeyframes:d,preUpdate:h,update:p,preRender:m,render:b,postRender:_}=s,w=()=>{const k=zs.useManualTiming?i.timestamp:performance.now();t=!1,zs.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(k-i.timestamp,bH),1)),i.timestamp=k,i.isProcessing=!0,c.process(i),u.process(i),d.process(i),h.process(i),p.process(i),m.process(i),b.process(i),_.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(w))},E=()=>{t=!0,r=!0,i.isProcessing||n(w)};return{schedule:qm.reduce((k,j)=>{const P=s[j];return k[j]=(N,A=!1,I=!1)=>(t||E(),P.schedule(N,A,I)),k},{}),cancel:k=>{for(let j=0;j<qm.length;j++)s[qm[j]].cancel(k)},state:i,steps:s}}const{schedule:sn,cancel:al,state:lr,steps:i1}=O4(typeof requestAnimationFrame<"u"?requestAnimationFrame:Pi,!0);let A0;function xH(){A0=void 0}const Ur={now:()=>(A0===void 0&&Ur.set(lr.isProcessing||zs.useManualTiming?lr.timestamp:performance.now()),A0),set:n=>{A0=n,queueMicrotask(xH)}},j4=n=>e=>typeof e=="string"&&e.startsWith(n),tE=j4("--"),_H=j4("var(--"),nE=n=>_H(n)?wH.test(n.split("/*")[0].trim()):!1,wH=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,$d={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},hp={...$d,transform:n=>Vs(0,1,n)},$m={...$d,default:1},Mh=n=>Math.round(n*1e5)/1e5,rE=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function SH(n){return n==null}const EH=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,iE=(n,e)=>t=>!!(typeof t=="string"&&EH.test(t)&&t.startsWith(n)||e&&!SH(t)&&Object.prototype.hasOwnProperty.call(t,e)),V4=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,a,s,c]=r.match(rE);return{[n]:parseFloat(i),[e]:parseFloat(a),[t]:parseFloat(s),alpha:c!==void 0?parseFloat(c):1}},TH=n=>Vs(0,255,n),a1={...$d,transform:n=>Math.round(TH(n))},lc={test:iE("rgb","red"),parse:V4("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+a1.transform(n)+", "+a1.transform(e)+", "+a1.transform(t)+", "+Mh(hp.transform(r))+")"};function AH(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const C_={test:iE("#"),parse:AH,transform:lc.transform},Zp=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),No=Zp("deg"),$a=Zp("%"),rt=Zp("px"),CH=Zp("vh"),IH=Zp("vw"),dk={...$a,parse:n=>$a.parse(n)/100,transform:n=>$a.transform(n*100)},Uu={test:iE("hsl","hue"),parse:V4("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+$a.transform(Mh(e))+", "+$a.transform(Mh(t))+", "+Mh(hp.transform(r))+")"},Bn={test:n=>lc.test(n)||C_.test(n)||Uu.test(n),parse:n=>lc.test(n)?lc.parse(n):Uu.test(n)?Uu.parse(n):C_.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?lc.transform(n):Uu.transform(n),getAnimatableNone:n=>{const e=Bn.parse(n);return e.alpha=0,Bn.transform(e)}},RH=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function kH(n){return isNaN(n)&&typeof n=="string"&&(n.match(rE)?.length||0)+(n.match(RH)?.length||0)>0}const z4="number",L4="color",DH="var",NH="var(",fk="${}",MH=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function pp(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let a=0;const c=e.replace(MH,u=>(Bn.test(u)?(r.color.push(a),i.push(L4),t.push(Bn.parse(u))):u.startsWith(NH)?(r.var.push(a),i.push(DH),t.push(u)):(r.number.push(a),i.push(z4),t.push(parseFloat(u))),++a,fk)).split(fk);return{values:t,split:c,indexes:r,types:i}}function B4(n){return pp(n).values}function U4(n){const{split:e,types:t}=pp(n),r=e.length;return i=>{let a="";for(let s=0;s<r;s++)if(a+=e[s],i[s]!==void 0){const c=t[s];c===z4?a+=Mh(i[s]):c===L4?a+=Bn.transform(i[s]):a+=i[s]}return a}}const PH=n=>typeof n=="number"?0:Bn.test(n)?Bn.getAnimatableNone(n):n;function OH(n){const e=B4(n);return U4(n)(e.map(PH))}const sl={test:kH,parse:B4,createTransformer:U4,getAnimatableNone:OH};function s1(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function jH({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,a=0,s=0;if(!e)i=a=s=t;else{const c=t<.5?t*(1+e):t+e-t*e,u=2*t-c;i=s1(u,c,n+1/3),a=s1(u,c,n),s=s1(u,c,n-1/3)}return{red:Math.round(i*255),green:Math.round(a*255),blue:Math.round(s*255),alpha:r}}function hv(n,e){return t=>t>0?e:n}const fn=(n,e,t)=>n+(e-n)*t,o1=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},VH=[C_,lc,Uu],zH=n=>VH.find(e=>e.test(n));function hk(n){const e=zH(n);if(!e)return!1;let t=e.parse(n);return e===Uu&&(t=jH(t)),t}const pk=(n,e)=>{const t=hk(n),r=hk(e);if(!t||!r)return hv(n,e);const i={...t};return a=>(i.red=o1(t.red,r.red,a),i.green=o1(t.green,r.green,a),i.blue=o1(t.blue,r.blue,a),i.alpha=fn(t.alpha,r.alpha,a),lc.transform(i))},I_=new Set(["none","hidden"]);function LH(n,e){return I_.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function BH(n,e){return t=>fn(n,e,t)}function aE(n){return typeof n=="number"?BH:typeof n=="string"?nE(n)?hv:Bn.test(n)?pk:GH:Array.isArray(n)?F4:typeof n=="object"?Bn.test(n)?pk:UH:hv}function F4(n,e){const t=[...n],r=t.length,i=n.map((a,s)=>aE(a)(a,e[s]));return a=>{for(let s=0;s<r;s++)t[s]=i[s](a);return t}}function UH(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=aE(n[i])(n[i],e[i]));return i=>{for(const a in r)t[a]=r[a](i);return t}}function FH(n,e){const t=[],r={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const a=e.types[i],s=n.indexes[a][r[a]],c=n.values[s]??0;t[i]=c,r[a]++}return t}const GH=(n,e)=>{const t=sl.createTransformer(e),r=pp(n),i=pp(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?I_.has(n)&&!i.values.length||I_.has(e)&&!r.values.length?LH(n,e):Wp(F4(FH(r,i),i.values),t):hv(n,e)};function G4(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?fn(n,e,t):aE(n)(n,e)}const qH=n=>{const e=({timestamp:t})=>n(t);return{start:(t=!0)=>sn.update(e,t),stop:()=>al(e),now:()=>lr.isProcessing?lr.timestamp:Ur.now()}},q4=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let a=0;a<i;a++)r+=Math.round(n(a/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},pv=2e4;function sE(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<pv;)e+=t,r=n.next(e);return e>=pv?1/0:e}function $H(n,e=100,t){const r=t({...n,keyframes:[0,e]}),i=Math.min(sE(r),pv);return{type:"keyframes",ease:a=>r.next(i*a).value/e,duration:Ni(i)}}const HH=5;function $4(n,e,t){const r=Math.max(e-HH,0);return E4(t-n(r),e-r)}const yn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},l1=.001;function YH({duration:n=yn.duration,bounce:e=yn.bounce,velocity:t=yn.velocity,mass:r=yn.mass}){let i,a,s=1-e;s=Vs(yn.minDamping,yn.maxDamping,s),n=Vs(yn.minDuration,yn.maxDuration,Ni(n)),s<1?(i=d=>{const h=d*s,p=h*n,m=h-t,b=R_(d,s),_=Math.exp(-p);return l1-m/b*_},a=d=>{const p=d*s*n,m=p*t+t,b=Math.pow(s,2)*Math.pow(d,2)*n,_=Math.exp(-p),w=R_(Math.pow(d,2),s);return(-i(d)+l1>0?-1:1)*((m-b)*_)/w}):(i=d=>{const h=Math.exp(-d*n),p=(d-t)*n+1;return-l1+h*p},a=d=>{const h=Math.exp(-d*n),p=(t-d)*(n*n);return h*p});const c=5/n,u=XH(i,a,c);if(n=qa(n),isNaN(u))return{stiffness:yn.stiffness,damping:yn.damping,duration:n};{const d=Math.pow(u,2)*r;return{stiffness:d,damping:s*2*Math.sqrt(r*d),duration:n}}}const KH=12;function XH(n,e,t){let r=t;for(let i=1;i<KH;i++)r=r-n(r)/e(r);return r}function R_(n,e){return n*Math.sqrt(1-e*e)}const WH=["duration","bounce"],QH=["stiffness","damping","mass"];function gk(n,e){return e.some(t=>n[t]!==void 0)}function ZH(n){let e={velocity:yn.velocity,stiffness:yn.stiffness,damping:yn.damping,mass:yn.mass,isResolvedFromDuration:!1,...n};if(!gk(n,QH)&&gk(n,WH))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,a=2*Vs(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:yn.mass,stiffness:i,damping:a}}else{const t=YH(n);e={...e,...t,mass:yn.mass},e.isResolvedFromDuration=!0}return e}function gv(n=yn.visualDuration,e=yn.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const a=t.keyframes[0],s=t.keyframes[t.keyframes.length-1],c={done:!1,value:a},{stiffness:u,damping:d,mass:h,duration:p,velocity:m,isResolvedFromDuration:b}=ZH({...t,velocity:-Ni(t.velocity||0)}),_=m||0,w=d/(2*Math.sqrt(u*h)),E=s-a,T=Ni(Math.sqrt(u/h)),C=Math.abs(E)<5;r||(r=C?yn.restSpeed.granular:yn.restSpeed.default),i||(i=C?yn.restDelta.granular:yn.restDelta.default);let k;if(w<1){const P=R_(T,w);k=N=>{const A=Math.exp(-w*T*N);return s-A*((_+w*T*E)/P*Math.sin(P*N)+E*Math.cos(P*N))}}else if(w===1)k=P=>s-Math.exp(-T*P)*(E+(_+T*E)*P);else{const P=T*Math.sqrt(w*w-1);k=N=>{const A=Math.exp(-w*T*N),I=Math.min(P*N,300);return s-A*((_+w*T*E)*Math.sinh(I)+P*E*Math.cosh(I))/P}}const j={calculatedDuration:b&&p||null,next:P=>{const N=k(P);if(b)c.done=P>=p;else{let A=P===0?_:0;w<1&&(A=P===0?qa(_):$4(k,P,N));const I=Math.abs(A)<=r,D=Math.abs(s-N)<=i;c.done=I&&D}return c.value=c.done?s:N,c},toString:()=>{const P=Math.min(sE(j),pv),N=q4(A=>j.next(P*A).value,P,30);return P+"ms "+N},toTransition:()=>{}};return j}gv.applyToOptions=n=>{const e=$H(n,100,gv);return n.ease=e.ease,n.duration=qa(e.duration),n.type="keyframes",n};function k_({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:a=500,modifyTarget:s,min:c,max:u,restDelta:d=.5,restSpeed:h}){const p=n[0],m={done:!1,value:p},b=I=>c!==void 0&&I<c||u!==void 0&&I>u,_=I=>c===void 0?u:u===void 0||Math.abs(c-I)<Math.abs(u-I)?c:u;let w=t*e;const E=p+w,T=s===void 0?E:s(E);T!==E&&(w=T-p);const C=I=>-w*Math.exp(-I/r),k=I=>T+C(I),j=I=>{const D=C(I),z=k(I);m.done=Math.abs(D)<=d,m.value=m.done?T:z};let P,N;const A=I=>{b(m.value)&&(P=I,N=gv({keyframes:[m.value,_(m.value)],velocity:$4(k,I,m.value),damping:i,stiffness:a,restDelta:d,restSpeed:h}))};return A(0),{calculatedDuration:null,next:I=>{let D=!1;return!N&&P===void 0&&(D=!0,j(I),A(I)),P!==void 0&&I>=P?N.next(I-P):(!D&&j(I),m)}}}function JH(n,e,t){const r=[],i=t||zs.mix||G4,a=n.length-1;for(let s=0;s<a;s++){let c=i(n[s],n[s+1]);if(e){const u=Array.isArray(e)?e[s]||Pi:e;c=Wp(u,c)}r.push(c)}return r}function eY(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const a=n.length;if(WS(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const s=n[0]===n[1];n[0]>n[a-1]&&(n=[...n].reverse(),e=[...e].reverse());const c=JH(e,r,i),u=c.length,d=h=>{if(s&&h<n[0])return e[0];let p=0;if(u>1)for(;p<n.length-2&&!(h<n[p+1]);p++);const m=fp(n[p],n[p+1],h);return c[p](m)};return t?h=>d(Vs(n[0],n[a-1],h)):d}function tY(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=fp(0,e,r);n.push(fn(t,1,i))}}function nY(n){const e=[0];return tY(e,n.length-1),e}function rY(n,e){return n.map(t=>t*e)}function iY(n,e){return n.map(()=>e||M4).splice(0,n.length-1)}function Ph({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=gH(r)?r.map(uk):uk(r),a={done:!1,value:e[0]},s=rY(t&&t.length===e.length?t:nY(e),n),c=eY(s,e,{ease:Array.isArray(i)?i:iY(e,i)});return{calculatedDuration:n,next:u=>(a.value=c(u),a.done=u>=n,a)}}const aY=n=>n!==null;function oE(n,{repeat:e,repeatType:t="loop"},r,i=1){const a=n.filter(aY),c=i<0||e&&t!=="loop"&&e%2===1?0:a.length-1;return!c||r===void 0?a[c]:r}const sY={decay:k_,inertia:k_,tween:Ph,keyframes:Ph,spring:gv};function H4(n){typeof n.type=="string"&&(n.type=sY[n.type])}class lE{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const oY=n=>n/100;class cE extends lE{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:t}=this.options;t&&t.updatedAt!==Ur.now()&&this.tick(Ur.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;H4(e);const{type:t=Ph,repeat:r=0,repeatDelay:i=0,repeatType:a,velocity:s=0}=e;let{keyframes:c}=e;const u=t||Ph;u!==Ph&&typeof c[0]!="number"&&(this.mixKeyframes=Wp(oY,G4(c[0],c[1])),c=[0,100]);const d=u({...e,keyframes:c});a==="mirror"&&(this.mirroredGenerator=u({...e,keyframes:[...c].reverse(),velocity:-s})),d.calculatedDuration===null&&(d.calculatedDuration=sE(d));const{calculatedDuration:h}=d;this.calculatedDuration=h,this.resolvedDuration=h+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=d}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:r,totalDuration:i,mixKeyframes:a,mirroredGenerator:s,resolvedDuration:c,calculatedDuration:u}=this;if(this.startTime===null)return r.next(0);const{delay:d=0,keyframes:h,repeat:p,repeatType:m,repeatDelay:b,type:_,onUpdate:w,finalKeyframe:E}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const T=this.currentTime-d*(this.playbackSpeed>=0?1:-1),C=this.playbackSpeed>=0?T<0:T>i;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let k=this.currentTime,j=r;if(p){const I=Math.min(this.currentTime,i)/c;let D=Math.floor(I),z=I%1;!z&&I>=1&&(z=1),z===1&&D--,D=Math.min(D,p+1),!!(D%2)&&(m==="reverse"?(z=1-z,b&&(z-=b/c)):m==="mirror"&&(j=s)),k=Vs(0,1,z)*c}const P=C?{done:!1,value:h[0]}:j.next(k);a&&(P.value=a(P.value));let{done:N}=P;!C&&u!==null&&(N=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const A=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&N);return A&&_!==k_&&(P.value=oE(h,this.options,E,this.speed)),w&&w(P.value),A&&this.finish(),P}then(e,t){return this.finished.then(e,t)}get duration(){return Ni(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Ni(e)}get time(){return Ni(this.currentTime)}set time(e){e=qa(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Ur.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Ni(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=qH,startTime:t}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=t??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Ur.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function lY(n){for(let e=1;e<n.length;e++)n[e]??(n[e]=n[e-1])}const cc=n=>n*180/Math.PI,D_=n=>{const e=cc(Math.atan2(n[1],n[0]));return N_(e)},cY={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:D_,rotateZ:D_,skewX:n=>cc(Math.atan(n[1])),skewY:n=>cc(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},N_=n=>(n=n%360,n<0&&(n+=360),n),mk=D_,vk=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),yk=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),uY={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:vk,scaleY:yk,scale:n=>(vk(n)+yk(n))/2,rotateX:n=>N_(cc(Math.atan2(n[6],n[5]))),rotateY:n=>N_(cc(Math.atan2(-n[2],n[0]))),rotateZ:mk,rotate:mk,skewX:n=>cc(Math.atan(n[4])),skewY:n=>cc(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function M_(n){return n.includes("scale")?1:0}function P_(n,e){if(!n||n==="none")return M_(e);const t=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(t)r=uY,i=t;else{const c=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=cY,i=c}if(!i)return M_(e);const a=r[e],s=i[1].split(",").map(fY);return typeof a=="function"?a(s):s[a]}const dY=(n,e)=>{const{transform:t="none"}=getComputedStyle(n);return P_(t,e)};function fY(n){return parseFloat(n.trim())}const Hd=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Yd=new Set(Hd),bk=n=>n===$d||n===rt,hY=new Set(["x","y","z"]),pY=Hd.filter(n=>!hY.has(n));function gY(n){const e=[];return pY.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const vc={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:(n,{transform:e})=>P_(e,"x"),y:(n,{transform:e})=>P_(e,"y")};vc.translateX=vc.x;vc.translateY=vc.y;const yc=new Set;let O_=!1,j_=!1,V_=!1;function Y4(){if(j_){const n=Array.from(yc).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=gY(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([a,s])=>{r.getValue(a)?.set(s)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}j_=!1,O_=!1,yc.forEach(n=>n.complete(V_)),yc.clear()}function K4(){yc.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(j_=!0)})}function mY(){V_=!0,K4(),Y4(),V_=!1}class uE{constructor(e,t,r,i,a,s=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=a,this.isAsync=s}scheduleResolve(){this.state="scheduled",this.isAsync?(yc.add(this),O_||(O_=!0,sn.read(K4),sn.resolveKeyframes(Y4))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;if(e[0]===null){const a=i?.get(),s=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&t){const c=r.readValue(t,s);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=s),i&&a===void 0&&i.set(e[0])}lY(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),yc.delete(this)}cancel(){this.state==="scheduled"&&(yc.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const vY=n=>n.startsWith("--");function yY(n,e,t){vY(e)?n.style.setProperty(e,t):n.style[e]=t}const bY=QS(()=>window.ScrollTimeline!==void 0),xY={};function _Y(n,e){const t=QS(n);return()=>xY[e]??t()}const X4=_Y(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),vh=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,xk={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:vh([0,.65,.55,1]),circOut:vh([.55,0,1,.45]),backIn:vh([.31,.01,.66,-.59]),backOut:vh([.33,1.53,.69,.99])};function W4(n,e){if(n)return typeof n=="function"?X4()?q4(n,e):"ease-out":P4(n)?vh(n):Array.isArray(n)?n.map(t=>W4(t,e)||xk.easeOut):xk[n]}function wY(n,e,t,{delay:r=0,duration:i=300,repeat:a=0,repeatType:s="loop",ease:c="easeOut",times:u}={},d=void 0){const h={[e]:t};u&&(h.offset=u);const p=W4(c,i);Array.isArray(p)&&(h.easing=p);const m={delay:r,duration:i,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:a+1,direction:s==="reverse"?"alternate":"normal"};return d&&(m.pseudoElement=d),n.animate(h,m)}function Q4(n){return typeof n=="function"&&"applyToOptions"in n}function SY({type:n,...e}){return Q4(n)&&X4()?n.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class EY extends lE{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:r,keyframes:i,pseudoElement:a,allowFlatten:s=!1,finalKeyframe:c,onComplete:u}=e;this.isPseudoElement=!!a,this.allowFlatten=s,this.options=e,WS(typeof e.type!="string");const d=SY(e);this.animation=wY(t,r,i,d,a),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const h=oE(i,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(h):yY(t,r,h),this.animation.cancel()}u?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return Ni(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Ni(e)}get time(){return Ni(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=qa(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&bY()?(this.animation.timeline=e,Pi):t(this)}}const Z4={anticipate:k4,backInOut:R4,circInOut:N4};function TY(n){return n in Z4}function AY(n){typeof n.ease=="string"&&TY(n.ease)&&(n.ease=Z4[n.ease])}const _k=10;class CY extends EY{constructor(e){AY(e),H4(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:r,onComplete:i,element:a,...s}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const c=new cE({...s,autoplay:!1}),u=qa(this.finishedTime??this.time);t.setWithVelocity(c.sample(u-_k).value,c.sample(u).value,_k),c.stop()}}const wk=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(sl.test(n)||n==="0")&&!n.startsWith("url("));function IY(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function RY(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const a=n[n.length-1],s=wk(i,e),c=wk(a,e);return!s||!c?!1:IY(n)||(t==="spring"||Q4(t))&&r}function z_(n){n.duration=0,n.type="keyframes"}const kY=new Set(["opacity","clipPath","filter","transform"]),DY=QS(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function NY(n){const{motionValue:e,name:t,repeatDelay:r,repeatType:i,damping:a,type:s}=n;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:d}=e.owner.getProps();return DY()&&t&&kY.has(t)&&(t!=="transform"||!d)&&!u&&!r&&i!=="mirror"&&a!==0&&s!=="inertia"}const MY=40;class PY extends lE{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:s="loop",keyframes:c,name:u,motionValue:d,element:h,...p}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Ur.now();const m={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:a,repeatType:s,name:u,motionValue:d,element:h,...p},b=h?.KeyframeResolver||uE;this.keyframeResolver=new b(c,(_,w,E)=>this.onKeyframesResolved(_,w,m,!E),u,d,h),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,t,r,i){this.keyframeResolver=void 0;const{name:a,type:s,velocity:c,delay:u,isHandoff:d,onUpdate:h}=r;this.resolvedAt=Ur.now(),RY(e,a,s,c)||((zs.instantAnimations||!u)&&h?.(oE(e,r,t)),e[0]=e[e.length-1],z_(r),r.repeat=0);const m={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>MY?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...r,keyframes:e},b=!d&&NY(m)?new CY({...m,element:m.motionValue.owner.current}):new cE(m);b.finished.then(()=>this.notifyFinished()).catch(Pi),this.pendingTimeline&&(this.stopTimeline=b.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=b}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),mY()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const OY=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function jY(n){const e=OY.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function J4(n,e,t=1){const[r,i]=jY(n);if(!r)return;const a=window.getComputedStyle(e).getPropertyValue(r);if(a){const s=a.trim();return _4(s)?parseFloat(s):s}return nE(i)?J4(i,e,t+1):i}function dE(n,e){return n?.[e]??n?.default??n}const ej=new Set(["width","height","top","left","right","bottom",...Hd]),VY={test:n=>n==="auto",parse:n=>n},tj=n=>e=>e.test(n),nj=[$d,rt,$a,No,IH,CH,VY],Sk=n=>nj.find(tj(n));function zY(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||S4(n):!0}const LY=new Set(["brightness","contrast","saturate","opacity"]);function BY(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(rE)||[];if(!r)return n;const i=t.replace(r,"");let a=LY.has(e)?1:0;return r!==t&&(a*=100),e+"("+a+i+")"}const UY=/\b([a-z-]*)\(.*?\)/gu,L_={...sl,getAnimatableNone:n=>{const e=n.match(UY);return e?e.map(BY).join(" "):n}},Ek={...$d,transform:Math.round},FY={rotate:No,rotateX:No,rotateY:No,rotateZ:No,scale:$m,scaleX:$m,scaleY:$m,scaleZ:$m,skew:No,skewX:No,skewY:No,distance:rt,translateX:rt,translateY:rt,translateZ:rt,x:rt,y:rt,z:rt,perspective:rt,transformPerspective:rt,opacity:hp,originX:dk,originY:dk,originZ:rt},fE={borderWidth:rt,borderTopWidth:rt,borderRightWidth:rt,borderBottomWidth:rt,borderLeftWidth:rt,borderRadius:rt,radius:rt,borderTopLeftRadius:rt,borderTopRightRadius:rt,borderBottomRightRadius:rt,borderBottomLeftRadius:rt,width:rt,maxWidth:rt,height:rt,maxHeight:rt,top:rt,right:rt,bottom:rt,left:rt,padding:rt,paddingTop:rt,paddingRight:rt,paddingBottom:rt,paddingLeft:rt,margin:rt,marginTop:rt,marginRight:rt,marginBottom:rt,marginLeft:rt,backgroundPositionX:rt,backgroundPositionY:rt,...FY,zIndex:Ek,fillOpacity:hp,strokeOpacity:hp,numOctaves:Ek},GY={...fE,color:Bn,backgroundColor:Bn,outlineColor:Bn,fill:Bn,stroke:Bn,borderColor:Bn,borderTopColor:Bn,borderRightColor:Bn,borderBottomColor:Bn,borderLeftColor:Bn,filter:L_,WebkitFilter:L_},rj=n=>GY[n];function ij(n,e){let t=rj(n);return t!==L_&&(t=sl),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const qY=new Set(["auto","none","0"]);function $Y(n,e,t){let r=0,i;for(;r<n.length&&!i;){const a=n[r];typeof a=="string"&&!qY.has(a)&&pp(a).values.length&&(i=n[r]),r++}if(i&&t)for(const a of e)n[a]=ij(t,i)}class HY extends uE{constructor(e,t,r,i,a){super(e,t,r,i,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let d=e[u];if(typeof d=="string"&&(d=d.trim(),nE(d))){const h=J4(d,t.current);h!==void 0&&(e[u]=h),u===e.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!ej.has(r)||e.length!==2)return;const[i,a]=e,s=Sk(i),c=Sk(a);if(s!==c)if(bk(s)&&bk(c))for(let u=0;u<e.length;u++){const d=e[u];typeof d=="string"&&(e[u]=parseFloat(d))}else vc[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)(e[i]===null||zY(e[i]))&&r.push(i);r.length&&$Y(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=vc[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){const{element:e,name:t,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const i=e.getValue(t);i&&i.jump(this.measuredOrigin,!1);const a=r.length-1,s=r[a];r[a]=vc[t](e.measureViewportBox(),window.getComputedStyle(e.current)),s!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=s),this.removedTransforms?.length&&this.removedTransforms.forEach(([c,u])=>{e.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function YY(n,e,t){if(n instanceof EventTarget)return[n];if(typeof n=="string"){let r=document;const i=t?.[n]??r.querySelectorAll(n);return i?Array.from(i):[]}return Array.from(n)}const aj=(n,e)=>e&&typeof n=="number"?e.transform(n):n;function sj(n){return w4(n)&&"offsetHeight"in n}const Tk=30,KY=n=>!isNaN(parseFloat(n));class XY{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const i=Ur.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=Ur.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=KY(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new ZS);const r=this.events[e].add(t);return e==="change"?()=>{r(),sn.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Ur.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>Tk)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,Tk);return E4(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Sd(n,e){return new XY(n,e)}const{schedule:hE}=O4(queueMicrotask,!1),Qi={x:!1,y:!1};function oj(){return Qi.x||Qi.y}function WY(n){return n==="x"||n==="y"?Qi[n]?null:(Qi[n]=!0,()=>{Qi[n]=!1}):Qi.x||Qi.y?null:(Qi.x=Qi.y=!0,()=>{Qi.x=Qi.y=!1})}function lj(n,e){const t=YY(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function Ak(n){return!(n.pointerType==="touch"||oj())}function QY(n,e,t={}){const[r,i,a]=lj(n,t),s=c=>{if(!Ak(c))return;const{target:u}=c,d=e(u,c);if(typeof d!="function"||!u)return;const h=p=>{Ak(p)&&(d(p),u.removeEventListener("pointerleave",h))};u.addEventListener("pointerleave",h,i)};return r.forEach(c=>{c.addEventListener("pointerenter",s,i)}),a}const cj=(n,e)=>e?n===e?!0:cj(n,e.parentElement):!1,pE=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,ZY=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function JY(n){return ZY.has(n.tagName)||n.tabIndex!==-1}const C0=new WeakSet;function Ck(n){return e=>{e.key==="Enter"&&n(e)}}function c1(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const eK=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=Ck(()=>{if(C0.has(t))return;c1(t,"down");const i=Ck(()=>{c1(t,"up")}),a=()=>c1(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",a,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function Ik(n){return pE(n)&&!oj()}function tK(n,e,t={}){const[r,i,a]=lj(n,t),s=c=>{const u=c.currentTarget;if(!Ik(c))return;C0.add(u);const d=e(u,c),h=(b,_)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",m),C0.has(u)&&C0.delete(u),Ik(b)&&typeof d=="function"&&d(b,{success:_})},p=b=>{h(b,u===window||u===document||t.useGlobalTarget||cj(u,b.target))},m=b=>{h(b,!1)};window.addEventListener("pointerup",p,i),window.addEventListener("pointercancel",m,i)};return r.forEach(c=>{(t.useGlobalTarget?window:c).addEventListener("pointerdown",s,i),sj(c)&&(c.addEventListener("focus",d=>eK(d,i)),!JY(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),a}function uj(n){return w4(n)&&"ownerSVGElement"in n}function nK(n){return uj(n)&&n.tagName==="svg"}const vr=n=>!!(n&&n.getVelocity),rK=[...nj,Bn,sl],iK=n=>rK.find(tj(n)),gE=U.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function Rk(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function aK(...n){return e=>{let t=!1;const r=n.map(i=>{const a=Rk(i,e);return!t&&typeof a=="function"&&(t=!0),a});if(t)return()=>{for(let i=0;i<r.length;i++){const a=r[i];typeof a=="function"?a():Rk(n[i],null)}}}}function sK(...n){return U.useCallback(aK(...n),n)}class oK extends U.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=t.offsetParent,i=sj(r)&&r.offsetWidth||0,a=this.props.sizeRef.current;a.height=t.offsetHeight||0,a.width=t.offsetWidth||0,a.top=t.offsetTop,a.left=t.offsetLeft,a.right=i-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function lK({children:n,isPresent:e,anchorX:t,root:r}){const i=U.useId(),a=U.useRef(null),s=U.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=U.useContext(gE),u=sK(a,n?.ref);return U.useInsertionEffect(()=>{const{width:d,height:h,top:p,left:m,right:b}=s.current;if(e||!a.current||!d||!h)return;const _=t==="left"?`left: ${m}`:`right: ${b}`;a.current.dataset.motionPopId=i;const w=document.createElement("style");c&&(w.nonce=c);const E=r??document.head;return E.appendChild(w),w.sheet&&w.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${h}px !important;
            ${_}px !important;
            top: ${p}px !important;
          }
        `),()=>{E.contains(w)&&E.removeChild(w)}},[e]),v.jsx(oK,{isPresent:e,childRef:a,sizeRef:s,children:U.cloneElement(n,{ref:u})})}const cK=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:a,mode:s,anchorX:c,root:u})=>{const d=fy(uK),h=U.useId();let p=!0,m=U.useMemo(()=>(p=!1,{id:h,initial:e,isPresent:t,custom:i,onExitComplete:b=>{d.set(b,!0);for(const _ of d.values())if(!_)return;r&&r()},register:b=>(d.set(b,!1),()=>d.delete(b))}),[t,d,r]);return a&&p&&(m={...m}),U.useMemo(()=>{d.forEach((b,_)=>d.set(_,!1))},[t]),U.useEffect(()=>{!t&&!d.size&&r&&r()},[t]),s==="popLayout"&&(n=v.jsx(lK,{isPresent:t,anchorX:c,root:u,children:n})),v.jsx(hy.Provider,{value:m,children:n})};function uK(){return new Map}function dj(n=!0){const e=U.useContext(hy);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,a=U.useId();U.useEffect(()=>{if(n)return i(a)},[n]);const s=U.useCallback(()=>n&&r&&r(a),[a,r,n]);return!t&&r?[!1,s]:[!0]}const Hm=n=>n.key||"";function kk(n){const e=[];return U.Children.forEach(n,t=>{U.isValidElement(t)&&e.push(t)}),e}const di=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:a="sync",propagate:s=!1,anchorX:c="left",root:u})=>{const[d,h]=dj(s),p=U.useMemo(()=>kk(n),[n]),m=s&&!d?[]:p.map(Hm),b=U.useRef(!0),_=U.useRef(p),w=fy(()=>new Map),[E,T]=U.useState(p),[C,k]=U.useState(p);YS(()=>{b.current=!1,_.current=p;for(let N=0;N<C.length;N++){const A=Hm(C[N]);m.includes(A)?w.delete(A):w.get(A)!==!0&&w.set(A,!1)}},[C,m.length,m.join("-")]);const j=[];if(p!==E){let N=[...p];for(let A=0;A<C.length;A++){const I=C[A],D=Hm(I);m.includes(D)||(N.splice(A,0,I),j.push(I))}return a==="wait"&&j.length&&(N=j),k(kk(N)),T(p),null}const{forceRender:P}=U.useContext($S);return v.jsx(v.Fragment,{children:C.map(N=>{const A=Hm(N),I=s&&!d?!1:p===C||m.includes(A),D=()=>{if(w.has(A))w.set(A,!0);else return;let z=!0;w.forEach(V=>{V||(z=!1)}),z&&(P?.(),k(_.current),s&&h?.(),r&&r())};return v.jsx(cK,{isPresent:I,initial:!b.current||t?void 0:!1,custom:e,presenceAffectsLayout:i,mode:a,root:u,onExitComplete:I?void 0:D,anchorX:c,children:N},A)})})},fj=U.createContext({strict:!1}),Dk={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ed={};for(const n in Dk)Ed[n]={isEnabled:e=>Dk[n].some(t=>!!e[t])};function dK(n){for(const e in n)Ed[e]={...Ed[e],...n[e]}}const fK=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function mv(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||fK.has(n)}let hj=n=>!mv(n);function hK(n){typeof n=="function"&&(hj=e=>e.startsWith("on")?!mv(e):n(e))}try{hK(require("@emotion/is-prop-valid").default)}catch{}function pK(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(hj(i)||t===!0&&mv(i)||!e&&!mv(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}const py=U.createContext({});function gy(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function gp(n){return typeof n=="string"||Array.isArray(n)}const mE=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],vE=["initial",...mE];function my(n){return gy(n.animate)||vE.some(e=>gp(n[e]))}function pj(n){return!!(my(n)||n.variants)}function gK(n,e){if(my(n)){const{initial:t,animate:r}=n;return{initial:t===!1||gp(t)?t:void 0,animate:gp(r)?r:void 0}}return n.inherit!==!1?e:{}}function mK(n){const{initial:e,animate:t}=gK(n,U.useContext(py));return U.useMemo(()=>({initial:e,animate:t}),[Nk(e),Nk(t)])}function Nk(n){return Array.isArray(n)?n.join(" "):n}const mp={};function vK(n){for(const e in n)mp[e]=n[e],tE(e)&&(mp[e].isCSSVariable=!0)}function gj(n,{layout:e,layoutId:t}){return Yd.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!mp[n]||n==="opacity")}const yK={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},bK=Hd.length;function xK(n,e,t){let r="",i=!0;for(let a=0;a<bK;a++){const s=Hd[a],c=n[s];if(c===void 0)continue;let u=!0;if(typeof c=="number"?u=c===(s.startsWith("scale")?1:0):u=parseFloat(c)===0,!u||t){const d=aj(c,fE[s]);if(!u){i=!1;const h=yK[s]||s;r+=`${h}(${d}) `}t&&(e[s]=d)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function yE(n,e,t){const{style:r,vars:i,transformOrigin:a}=n;let s=!1,c=!1;for(const u in e){const d=e[u];if(Yd.has(u)){s=!0;continue}else if(tE(u)){i[u]=d;continue}else{const h=aj(d,fE[u]);u.startsWith("origin")?(c=!0,a[u]=h):r[u]=h}}if(e.transform||(s||t?r.transform=xK(e,n.transform,t):r.transform&&(r.transform="none")),c){const{originX:u="50%",originY:d="50%",originZ:h=0}=a;r.transformOrigin=`${u} ${d} ${h}`}}const bE=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function mj(n,e,t){for(const r in e)!vr(e[r])&&!gj(r,t)&&(n[r]=e[r])}function _K({transformTemplate:n},e){return U.useMemo(()=>{const t=bE();return yE(t,e,n),Object.assign({},t.vars,t.style)},[e])}function wK(n,e){const t=n.style||{},r={};return mj(r,t,n),Object.assign(r,_K(n,e)),r}function SK(n,e){const t={},r=wK(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}const EK={offset:"stroke-dashoffset",array:"stroke-dasharray"},TK={offset:"strokeDashoffset",array:"strokeDasharray"};function AK(n,e,t=1,r=0,i=!0){n.pathLength=1;const a=i?EK:TK;n[a.offset]=rt.transform(-r);const s=rt.transform(e),c=rt.transform(t);n[a.array]=`${s} ${c}`}function vj(n,{attrX:e,attrY:t,attrScale:r,pathLength:i,pathSpacing:a=1,pathOffset:s=0,...c},u,d,h){if(yE(n,c,d),u){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:p,style:m}=n;p.transform&&(m.transform=p.transform,delete p.transform),(m.transform||p.transformOrigin)&&(m.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),m.transform&&(m.transformBox=h?.transformBox??"fill-box",delete p.transformBox),e!==void 0&&(p.x=e),t!==void 0&&(p.y=t),r!==void 0&&(p.scale=r),i!==void 0&&AK(p,i,a,s,!1)}const yj=()=>({...bE(),attrs:{}}),bj=n=>typeof n=="string"&&n.toLowerCase()==="svg";function CK(n,e,t,r){const i=U.useMemo(()=>{const a=yj();return vj(a,e,bj(r),n.transformTemplate,n.style),{...a.attrs,style:{...a.style}}},[e]);if(n.style){const a={};mj(a,n.style,n),i.style={...a,...i.style}}return i}const IK=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function xE(n){return typeof n!="string"||n.includes("-")?!1:!!(IK.indexOf(n)>-1||/[A-Z]/u.test(n))}function RK(n,e,t,{latestValues:r},i,a=!1){const c=(xE(n)?CK:SK)(e,r,i,n),u=pK(e,typeof n=="string",a),d=n!==U.Fragment?{...u,...c,ref:t}:{},{children:h}=e,p=U.useMemo(()=>vr(h)?h.get():h,[h]);return U.createElement(n,{...d,children:p})}function Mk(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function _E(n,e,t,r){if(typeof e=="function"){const[i,a]=Mk(r);e=e(t!==void 0?t:n.custom,i,a)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,a]=Mk(r);e=e(t!==void 0?t:n.custom,i,a)}return e}function I0(n){return vr(n)?n.get():n}function kK({scrapeMotionValuesFromProps:n,createRenderState:e},t,r,i){return{latestValues:DK(t,r,i,n),renderState:e()}}function DK(n,e,t,r){const i={},a=r(n,{});for(const m in a)i[m]=I0(a[m]);let{initial:s,animate:c}=n;const u=my(n),d=pj(n);e&&d&&!u&&n.inherit!==!1&&(s===void 0&&(s=e.initial),c===void 0&&(c=e.animate));let h=t?t.initial===!1:!1;h=h||s===!1;const p=h?c:s;if(p&&typeof p!="boolean"&&!gy(p)){const m=Array.isArray(p)?p:[p];for(let b=0;b<m.length;b++){const _=_E(n,m[b]);if(_){const{transitionEnd:w,transition:E,...T}=_;for(const C in T){let k=T[C];if(Array.isArray(k)){const j=h?k.length-1:0;k=k[j]}k!==null&&(i[C]=k)}for(const C in w)i[C]=w[C]}}}return i}const xj=n=>(e,t)=>{const r=U.useContext(py),i=U.useContext(hy),a=()=>kK(n,e,r,i);return t?a():fy(a)};function wE(n,e,t){const{style:r}=n,i={};for(const a in r)(vr(r[a])||e.style&&vr(e.style[a])||gj(a,n)||t?.getValue(a)?.liveStyle!==void 0)&&(i[a]=r[a]);return i}const NK=xj({scrapeMotionValuesFromProps:wE,createRenderState:bE});function _j(n,e,t){const r=wE(n,e,t);for(const i in n)if(vr(n[i])||vr(e[i])){const a=Hd.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[a]=n[i]}return r}const MK=xj({scrapeMotionValuesFromProps:_j,createRenderState:yj}),PK=Symbol.for("motionComponentSymbol");function Fu(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function OK(n,e,t){return U.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):Fu(t)&&(t.current=r))},[e])}const SE=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),jK="framerAppearId",wj="data-"+SE(jK),Sj=U.createContext({});function VK(n,e,t,r,i){const{visualElement:a}=U.useContext(py),s=U.useContext(fj),c=U.useContext(hy),u=U.useContext(gE).reducedMotion,d=U.useRef(null);r=r||s.renderer,!d.current&&r&&(d.current=r(n,{visualState:e,parent:a,props:t,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const h=d.current,p=U.useContext(Sj);h&&!h.projection&&i&&(h.type==="html"||h.type==="svg")&&zK(d.current,t,i,p);const m=U.useRef(!1);U.useInsertionEffect(()=>{h&&m.current&&h.update(t,c)});const b=t[wj],_=U.useRef(!!b&&!window.MotionHandoffIsComplete?.(b)&&window.MotionHasOptimisedAnimation?.(b));return YS(()=>{h&&(m.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),h.scheduleRenderMicrotask(),_.current&&h.animationState&&h.animationState.animateChanges())}),U.useEffect(()=>{h&&(!_.current&&h.animationState&&h.animationState.animateChanges(),_.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(b)}),_.current=!1),h.enteringChildren=void 0)}),h}function zK(n,e,t,r){const{layoutId:i,layout:a,drag:s,dragConstraints:c,layoutScroll:u,layoutRoot:d,layoutCrossfade:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:Ej(n.parent)),n.projection.setOptions({layoutId:i,layout:a,alwaysMeasureLayout:!!s||c&&Fu(c),visualElement:n,animationType:typeof a=="string"?a:"both",initialPromotionConfig:r,crossfade:h,layoutScroll:u,layoutRoot:d})}function Ej(n){if(n)return n.options.allowProjection!==!1?n.projection:Ej(n.parent)}function u1(n,{forwardMotionProps:e=!1}={},t,r){t&&dK(t);const i=xE(n)?MK:NK;function a(c,u){let d;const h={...U.useContext(gE),...c,layoutId:LK(c)},{isStatic:p}=h,m=mK(c),b=i(c,p);if(!p&&HS){BK();const _=UK(h);d=_.MeasureLayout,m.visualElement=VK(n,b,h,r,_.ProjectionNode)}return v.jsxs(py.Provider,{value:m,children:[d&&m.visualElement?v.jsx(d,{visualElement:m.visualElement,...h}):null,RK(n,c,OK(b,m.visualElement,u),b,p,e)]})}a.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const s=U.forwardRef(a);return s[PK]=n,s}function LK({layoutId:n}){const e=U.useContext($S).id;return e&&n!==void 0?e+"-"+n:n}function BK(n,e){U.useContext(fj).strict}function UK(n){const{drag:e,layout:t}=Ed;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function FK(n,e){if(typeof Proxy>"u")return u1;const t=new Map,r=(a,s)=>u1(a,s,n,e),i=(a,s)=>r(a,s);return new Proxy(i,{get:(a,s)=>s==="create"?r:(t.has(s)||t.set(s,u1(s,void 0,n,e)),t.get(s))})}function Tj({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function GK({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function qK(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function d1(n){return n===void 0||n===1}function B_({scale:n,scaleX:e,scaleY:t}){return!d1(n)||!d1(e)||!d1(t)}function Ql(n){return B_(n)||Aj(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function Aj(n){return Pk(n.x)||Pk(n.y)}function Pk(n){return n&&n!=="0%"}function vv(n,e,t){const r=n-t,i=e*r;return t+i}function Ok(n,e,t,r,i){return i!==void 0&&(n=vv(n,i,r)),vv(n,t,r)+e}function U_(n,e=0,t=1,r,i){n.min=Ok(n.min,e,t,r,i),n.max=Ok(n.max,e,t,r,i)}function Cj(n,{x:e,y:t}){U_(n.x,e.translate,e.scale,e.originPoint),U_(n.y,t.translate,t.scale,t.originPoint)}const jk=.999999999999,Vk=1.0000000000001;function $K(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let a,s;for(let c=0;c<i;c++){a=t[c],s=a.projectionDelta;const{visualElement:u}=a.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&a.options.layoutScroll&&a.scroll&&a!==a.root&&qu(n,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),s&&(e.x*=s.x.scale,e.y*=s.y.scale,Cj(n,s)),r&&Ql(a.latestValues)&&qu(n,a.latestValues))}e.x<Vk&&e.x>jk&&(e.x=1),e.y<Vk&&e.y>jk&&(e.y=1)}function Gu(n,e){n.min=n.min+e,n.max=n.max+e}function zk(n,e,t,r,i=.5){const a=fn(n.min,n.max,i);U_(n,e,t,a,r)}function qu(n,e){zk(n.x,e.x,e.scaleX,e.scale,e.originX),zk(n.y,e.y,e.scaleY,e.scale,e.originY)}function Ij(n,e){return Tj(qK(n.getBoundingClientRect(),e))}function HK(n,e,t){const r=Ij(n,t),{scroll:i}=e;return i&&(Gu(r.x,i.offset.x),Gu(r.y,i.offset.y)),r}const Lk=()=>({translate:0,scale:1,origin:0,originPoint:0}),$u=()=>({x:Lk(),y:Lk()}),Bk=()=>({min:0,max:0}),Tn=()=>({x:Bk(),y:Bk()}),F_={current:null},Rj={current:!1};function YK(){if(Rj.current=!0,!!HS)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>F_.current=n.matches;n.addEventListener("change",e),e()}else F_.current=!1}const KK=new WeakMap;function XK(n,e,t){for(const r in e){const i=e[r],a=t[r];if(vr(i))n.addValue(r,i);else if(vr(a))n.addValue(r,Sd(i,{owner:n}));else if(a!==i)if(n.hasValue(r)){const s=n.getValue(r);s.liveStyle===!0?s.jump(i):s.hasAnimated||s.set(i)}else{const s=n.getStaticValue(r);n.addValue(r,Sd(s!==void 0?s:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const Uk=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class WK{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:a,visualState:s},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=uE,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=Ur.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,sn.render(this.render,!1,!0))};const{latestValues:u,renderState:d}=s;this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=d,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=c,this.blockInitialAnimation=!!a,this.isControllingVariants=my(t),this.isVariantNode=pj(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...p}=this.scrapeMotionValuesFromProps(t,{},this);for(const m in p){const b=p[m];u[m]!==void 0&&vr(b)&&b.set(u[m])}}mount(e){this.current=e,KK.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),Rj.current||YK(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:F_.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),al(this.notifyUpdate),al(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Yd.has(e);r&&this.onBindTransform&&this.onBindTransform();const i=t.on("change",s=>{this.latestValues[e]=s,this.props.onUpdate&&sn.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Ed){const t=Ed[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Tn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<Uk.length;r++){const i=Uk[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const a="on"+i,s=e[a];s&&(this.propEventSubscriptions[i]=this.on(i,s))}this.prevMotionValues=XK(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=Sd(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(_4(r)||S4(r))?r=parseFloat(r):!iK(r)&&sl.test(t)&&(r=ij(e,t)),this.setBaseTarget(e,vr(r)?r.get():r)),vr(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let r;if(typeof t=="string"||typeof t=="object"){const a=_E(this.props,t,this.presenceContext?.custom);a&&(r=a[e])}if(t&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!vr(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new ZS),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){hE.render(this.render)}}class kj extends WK{constructor(){super(...arguments),this.KeyframeResolver=HY}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;vr(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function Dj(n,{style:e,vars:t},r,i){const a=n.style;let s;for(s in e)a[s]=e[s];i?.applyProjectionStyles(a,r);for(s in t)a.setProperty(s,t[s])}function QK(n){return window.getComputedStyle(n)}class ZK extends kj{constructor(){super(...arguments),this.type="html",this.renderInstance=Dj}readValueFromInstance(e,t){if(Yd.has(t))return this.projection?.isProjecting?M_(t):dY(e,t);{const r=QK(e),i=(tE(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return Ij(e,t)}build(e,t,r){yE(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return wE(e,t,r)}}const Nj=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function JK(n,e,t,r){Dj(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(Nj.has(i)?i:SE(i),e.attrs[i])}class eX extends kj{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Tn}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Yd.has(t)){const r=rj(t);return r&&r.default||0}return t=Nj.has(t)?t:SE(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return _j(e,t,r)}build(e,t,r){vj(e,t,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,t,r,i){JK(e,t,r,i)}mount(e){this.isSVGTag=bj(e.tagName),super.mount(e)}}const tX=(n,e)=>xE(n)?new eX(e):new ZK(e,{allowProjection:n!==U.Fragment});function rd(n,e,t){const r=n.getProps();return _E(r,e,t!==void 0?t:r.custom,n)}const G_=n=>Array.isArray(n);function nX(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,Sd(t))}function rX(n){return G_(n)?n[n.length-1]||0:n}function EE(n,e){const t=rd(n,e);let{transitionEnd:r={},transition:i={},...a}=t||{};a={...a,...r};for(const s in a){const c=rX(a[s]);nX(n,s,c)}}function iX(n){return!!(vr(n)&&n.add)}function q_(n,e){const t=n.getValue("willChange");if(iX(t))return t.add(e);if(!t&&zs.WillChange){const r=new zs.WillChange("auto");n.addValue("willChange",r),r.add(e)}}function Mj(n){return n.props[wj]}const aX=n=>n!==null;function sX(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(aX),a=e&&t!=="loop"&&e%2===1?0:i.length-1;return i[a]}const oX={type:"spring",stiffness:500,damping:25,restSpeed:10},lX=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),cX={type:"keyframes",duration:.8},uX={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},dX=(n,{keyframes:e})=>e.length>2?cX:Yd.has(n)?n.startsWith("scale")?lX(e[1]):oX:uX;function fX({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:a,repeatType:s,repeatDelay:c,from:u,elapsed:d,...h}){return!!Object.keys(h).length}const TE=(n,e,t,r={},i,a)=>s=>{const c=dE(r,n)||{},u=c.delay||r.delay||0;let{elapsed:d=0}=r;d=d-qa(u);const h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...c,delay:-d,onUpdate:m=>{e.set(m),c.onUpdate&&c.onUpdate(m)},onComplete:()=>{s(),c.onComplete&&c.onComplete()},name:n,motionValue:e,element:a?void 0:i};fX(c)||Object.assign(h,dX(n,h)),h.duration&&(h.duration=qa(h.duration)),h.repeatDelay&&(h.repeatDelay=qa(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let p=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(z_(h),h.delay===0&&(p=!0)),(zs.instantAnimations||zs.skipAnimations)&&(p=!0,z_(h),h.delay=0),h.allowFlatten=!c.type&&!c.ease,p&&!a&&e.get()!==void 0){const m=sX(h.keyframes,c);if(m!==void 0){sn.update(()=>{h.onUpdate(m),h.onComplete()});return}}return c.isSync?new cE(h):new PY(h)};function hX({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function Pj(n,e,{delay:t=0,transitionOverride:r,type:i}={}){let{transition:a=n.getDefaultTransition(),transitionEnd:s,...c}=e;r&&(a=r);const u=[],d=i&&n.animationState&&n.animationState.getState()[i];for(const h in c){const p=n.getValue(h,n.latestValues[h]??null),m=c[h];if(m===void 0||d&&hX(d,h))continue;const b={delay:t,...dE(a||{},h)},_=p.get();if(_!==void 0&&!p.isAnimating&&!Array.isArray(m)&&m===_&&!b.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const T=Mj(n);if(T){const C=window.MotionHandoffAnimation(T,h,sn);C!==null&&(b.startTime=C,w=!0)}}q_(n,h),p.start(TE(h,p,m,n.shouldReduceMotion&&ej.has(h)?{type:!1}:b,n,w));const E=p.animation;E&&u.push(E)}return s&&Promise.all(u).then(()=>{sn.update(()=>{s&&EE(n,s)})}),u}function Oj(n,e,t,r=0,i=1){const a=Array.from(n).sort((d,h)=>d.sortNodePosition(h)).indexOf(e),s=n.size,c=(s-1)*r;return typeof t=="function"?t(a,s):i===1?a*r:c-a*r}function $_(n,e,t={}){const r=rd(n,e,t.type==="exit"?n.presenceContext?.custom:void 0);let{transition:i=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(i=t.transitionOverride);const a=r?()=>Promise.all(Pj(n,r,t)):()=>Promise.resolve(),s=n.variantChildren&&n.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:h,staggerDirection:p}=i;return pX(n,e,u,d,h,p,t)}:()=>Promise.resolve(),{when:c}=i;if(c){const[u,d]=c==="beforeChildren"?[a,s]:[s,a];return u().then(()=>d())}else return Promise.all([a(),s(t.delay)])}function pX(n,e,t=0,r=0,i=0,a=1,s){const c=[];for(const u of n.variantChildren)u.notify("AnimationStart",e),c.push($_(u,e,{...s,delay:t+(typeof r=="function"?0:r)+Oj(n.variantChildren,u,r,i,a)}).then(()=>u.notify("AnimationComplete",e)));return Promise.all(c)}function jj(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(a=>$_(n,a,t));r=Promise.all(i)}else if(typeof e=="string")r=$_(n,e,t);else{const i=typeof e=="function"?rd(n,e,t.custom):e;r=Promise.all(Pj(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}function Vj(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}const gX=vE.length;function zj(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?zj(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<gX;t++){const r=vE[t],i=n.props[r];(gp(i)||i===!1)&&(e[r]=i)}return e}const mX=[...mE].reverse(),vX=mE.length;function yX(n){return e=>Promise.all(e.map(({animation:t,options:r})=>jj(n,t,r)))}function bX(n){let e=yX(n),t=Fk(),r=!0;const i=u=>(d,h)=>{const p=rd(n,h,u==="exit"?n.presenceContext?.custom:void 0);if(p){const{transition:m,transitionEnd:b,..._}=p;d={...d,..._,...b}}return d};function a(u){e=u(n)}function s(u){const{props:d}=n,h=zj(n.parent)||{},p=[],m=new Set;let b={},_=1/0;for(let E=0;E<vX;E++){const T=mX[E],C=t[T],k=d[T]!==void 0?d[T]:h[T],j=gp(k),P=T===u?C.isActive:null;P===!1&&(_=E);let N=k===h[T]&&k!==d[T]&&j;if(N&&r&&n.manuallyAnimateOnMount&&(N=!1),C.protectedKeys={...b},!C.isActive&&P===null||!k&&!C.prevProp||gy(k)||typeof k=="boolean")continue;const A=xX(C.prevProp,k);let I=A||T===u&&C.isActive&&!N&&j||E>_&&j,D=!1;const z=Array.isArray(k)?k:[k];let V=z.reduce(i(T),{});P===!1&&(V={});const{prevResolvedValues:B={}}=C,O={...B,...V},X=W=>{I=!0,m.has(W)&&(D=!0,m.delete(W)),C.needsAnimating[W]=!0;const ee=n.getValue(W);ee&&(ee.liveStyle=!1)};for(const W in O){const ee=V[W],ie=B[W];if(b.hasOwnProperty(W))continue;let H=!1;G_(ee)&&G_(ie)?H=!Vj(ee,ie):H=ee!==ie,H?ee!=null?X(W):m.add(W):ee!==void 0&&m.has(W)?X(W):C.protectedKeys[W]=!0}C.prevProp=k,C.prevResolvedValues=V,C.isActive&&(b={...b,...V}),r&&n.blockInitialAnimation&&(I=!1);const K=N&&A;I&&(!K||D)&&p.push(...z.map(W=>{const ee={type:T};if(typeof W=="string"&&r&&!K&&n.manuallyAnimateOnMount&&n.parent){const{parent:ie}=n,H=rd(ie,W);if(ie.enteringChildren&&H){const{delayChildren:F}=H.transition||{};ee.delay=Oj(ie.enteringChildren,n,F)}}return{animation:W,options:ee}}))}if(m.size){const E={};if(typeof d.initial!="boolean"){const T=rd(n,Array.isArray(d.initial)?d.initial[0]:d.initial);T&&T.transition&&(E.transition=T.transition)}m.forEach(T=>{const C=n.getBaseTarget(T),k=n.getValue(T);k&&(k.liveStyle=!0),E[T]=C??null}),p.push({animation:E})}let w=!!p.length;return r&&(d.initial===!1||d.initial===d.animate)&&!n.manuallyAnimateOnMount&&(w=!1),r=!1,w?e(p):Promise.resolve()}function c(u,d){if(t[u].isActive===d)return Promise.resolve();n.variantChildren?.forEach(p=>p.animationState?.setActive(u,d)),t[u].isActive=d;const h=s(u);for(const p in t)t[p].protectedKeys={};return h}return{animateChanges:s,setActive:c,setAnimateFunction:a,getState:()=>t,reset:()=>{t=Fk()}}}function xX(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!Vj(e,n):!1}function Yl(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Fk(){return{animate:Yl(!0),whileInView:Yl(),whileHover:Yl(),whileTap:Yl(),whileDrag:Yl(),whileFocus:Yl(),exit:Yl()}}class ml{constructor(e){this.isMounted=!1,this.node=e}update(){}}class _X extends ml{constructor(e){super(e),e.animationState||(e.animationState=bX(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();gy(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let wX=0;class SX extends ml{constructor(){super(...arguments),this.id=wX++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const EX={animation:{Feature:_X},exit:{Feature:SX}};function vp(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function Jp(n){return{point:{x:n.pageX,y:n.pageY}}}const TX=n=>e=>pE(e)&&n(e,Jp(e));function Oh(n,e,t,r){return vp(n,e,TX(t),r)}const Lj=1e-4,AX=1-Lj,CX=1+Lj,Bj=.01,IX=0-Bj,RX=0+Bj;function Cr(n){return n.max-n.min}function kX(n,e,t){return Math.abs(n-e)<=t}function Gk(n,e,t,r=.5){n.origin=r,n.originPoint=fn(e.min,e.max,n.origin),n.scale=Cr(t)/Cr(e),n.translate=fn(t.min,t.max,n.origin)-n.originPoint,(n.scale>=AX&&n.scale<=CX||isNaN(n.scale))&&(n.scale=1),(n.translate>=IX&&n.translate<=RX||isNaN(n.translate))&&(n.translate=0)}function jh(n,e,t,r){Gk(n.x,e.x,t.x,r?r.originX:void 0),Gk(n.y,e.y,t.y,r?r.originY:void 0)}function qk(n,e,t){n.min=t.min+e.min,n.max=n.min+Cr(e)}function DX(n,e,t){qk(n.x,e.x,t.x),qk(n.y,e.y,t.y)}function $k(n,e,t){n.min=e.min-t.min,n.max=n.min+Cr(e)}function Vh(n,e,t){$k(n.x,e.x,t.x),$k(n.y,e.y,t.y)}function Ii(n){return[n("x"),n("y")]}const Uj=({current:n})=>n?n.ownerDocument.defaultView:null,Hk=(n,e)=>Math.abs(n-e);function NX(n,e){const t=Hk(n.x,e.x),r=Hk(n.y,e.y);return Math.sqrt(t**2+r**2)}class Fj{constructor(e,t,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:a=!1,distanceThreshold:s=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=h1(this.lastMoveEventInfo,this.history),b=this.startEvent!==null,_=NX(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!b&&!_)return;const{point:w}=m,{timestamp:E}=lr;this.history.push({...w,timestamp:E});const{onStart:T,onMove:C}=this.handlers;b||(T&&T(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),C&&C(this.lastMoveEvent,m)},this.handlePointerMove=(m,b)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=f1(b,this.transformPagePoint),sn.update(this.updatePoint,!0)},this.handlePointerUp=(m,b)=>{this.end();const{onEnd:_,onSessionEnd:w,resumeAnimation:E}=this.handlers;if(this.dragSnapToOrigin&&E&&E(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=h1(m.type==="pointercancel"?this.lastMoveEventInfo:f1(b,this.transformPagePoint),this.history);this.startEvent&&_&&_(m,T),w&&w(m,T)},!pE(e))return;this.dragSnapToOrigin=a,this.handlers=t,this.transformPagePoint=r,this.distanceThreshold=s,this.contextWindow=i||window;const c=Jp(e),u=f1(c,this.transformPagePoint),{point:d}=u,{timestamp:h}=lr;this.history=[{...d,timestamp:h}];const{onSessionStart:p}=t;p&&p(e,h1(u,this.history)),this.removeListeners=Wp(Oh(this.contextWindow,"pointermove",this.handlePointerMove),Oh(this.contextWindow,"pointerup",this.handlePointerUp),Oh(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),al(this.updatePoint)}}function f1(n,e){return e?{point:e(n.point)}:n}function Yk(n,e){return{x:n.x-e.x,y:n.y-e.y}}function h1({point:n},e){return{point:n,delta:Yk(n,Gj(e)),offset:Yk(n,MX(e)),velocity:PX(e,.1)}}function MX(n){return n[0]}function Gj(n){return n[n.length-1]}function PX(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=Gj(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>qa(e)));)t--;if(!r)return{x:0,y:0};const a=Ni(i.timestamp-r.timestamp);if(a===0)return{x:0,y:0};const s={x:(i.x-r.x)/a,y:(i.y-r.y)/a};return s.x===1/0&&(s.x=0),s.y===1/0&&(s.y=0),s}function OX(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?fn(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?fn(t,n,r.max):Math.min(n,t)),n}function Kk(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function jX(n,{top:e,left:t,bottom:r,right:i}){return{x:Kk(n.x,t,i),y:Kk(n.y,e,r)}}function Xk(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function VX(n,e){return{x:Xk(n.x,e.x),y:Xk(n.y,e.y)}}function zX(n,e){let t=.5;const r=Cr(n),i=Cr(e);return i>r?t=fp(e.min,e.max-r,n.min):r>i&&(t=fp(n.min,n.max-i,e.min)),Vs(0,1,t)}function LX(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const H_=.35;function BX(n=H_){return n===!1?n=0:n===!0&&(n=H_),{x:Wk(n,"left","right"),y:Wk(n,"top","bottom")}}function Wk(n,e,t){return{min:Qk(n,e),max:Qk(n,t)}}function Qk(n,e){return typeof n=="number"?n:n[e]||0}const UX=new WeakMap;class FX{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Tn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:r}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const a=p=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Jp(p).point)},s=(p,m)=>{const{drag:b,dragPropagation:_,onDragStart:w}=this.getProps();if(b&&!_&&(this.openDragLock&&this.openDragLock(),this.openDragLock=WY(b),!this.openDragLock))return;this.latestPointerEvent=p,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ii(T=>{let C=this.getAxisMotionValue(T).get()||0;if($a.test(C)){const{projection:k}=this.visualElement;if(k&&k.layout){const j=k.layout.layoutBox[T];j&&(C=Cr(j)*(parseFloat(C)/100))}}this.originPoint[T]=C}),w&&sn.postRender(()=>w(p,m)),q_(this.visualElement,"transform");const{animationState:E}=this.visualElement;E&&E.setActive("whileDrag",!0)},c=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m;const{dragPropagation:b,dragDirectionLock:_,onDirectionLock:w,onDrag:E}=this.getProps();if(!b&&!this.openDragLock)return;const{offset:T}=m;if(_&&this.currentDirection===null){this.currentDirection=GX(T),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",m.point,T),this.updateAxis("y",m.point,T),this.visualElement.render(),E&&E(p,m)},u=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m,this.stop(p,m),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>Ii(p=>this.getAnimationState(p)==="paused"&&this.getAxisMotionValue(p).animation?.play()),{dragSnapToOrigin:h}=this.getProps();this.panSession=new Fj(e,{onSessionStart:a,onStart:s,onMove:c,onSessionEnd:u,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,distanceThreshold:r,contextWindow:Uj(this.visualElement)})}stop(e,t){const r=e||this.latestPointerEvent,i=t||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!i||!r)return;const{velocity:s}=i;this.startAnimation(s);const{onDragEnd:c}=this.getProps();c&&sn.postRender(()=>c(r,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!Ym(e,i,this.currentDirection))return;const a=this.getAxisMotionValue(e);let s=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(s=OX(s,this.constraints[e],this.elastic[e])),a.set(s)}resolveConstraints(){const{dragConstraints:e,dragElastic:t}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,i=this.constraints;e&&Fu(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=jX(r.layoutBox,e):this.constraints=!1,this.elastic=BX(t),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Ii(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=LX(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Fu(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const a=HK(r,i.root,this.visualElement.getTransformPagePoint());let s=VX(i.layout.layoutBox,a);if(t){const c=t(GK(s));this.hasMutatedConstraints=!!c,c&&(s=Tj(c))}return s}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:a,dragSnapToOrigin:s,onDragTransitionEnd:c}=this.getProps(),u=this.constraints||{},d=Ii(h=>{if(!Ym(h,t,this.currentDirection))return;let p=u&&u[h]||{};s&&(p={min:0,max:0});const m=i?200:1e6,b=i?40:1e7,_={type:"inertia",velocity:r?e[h]:0,bounceStiffness:m,bounceDamping:b,timeConstant:750,restDelta:1,restSpeed:10,...a,...p};return this.startAxisValueAnimation(h,_)});return Promise.all(d).then(c)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return q_(this.visualElement,e),r.start(TE(e,r,0,t,this.visualElement,!1))}stopAnimation(){Ii(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Ii(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Ii(t=>{const{drag:r}=this.getProps();if(!Ym(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,a=this.getAxisMotionValue(t);if(i&&i.layout){const{min:s,max:c}=i.layout.layoutBox[t];a.set(e[t]-fn(s,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!Fu(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Ii(s=>{const c=this.getAxisMotionValue(s);if(c&&this.constraints!==!1){const u=c.get();i[s]=zX({min:u,max:u},this.constraints[s])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Ii(s=>{if(!Ym(s,e,null))return;const c=this.getAxisMotionValue(s),{min:u,max:d}=this.constraints[s];c.set(fn(u,d,i[s]))})}addListeners(){if(!this.visualElement.current)return;UX.set(this.visualElement,this);const e=this.visualElement.current,t=Oh(e,"pointerdown",u=>{const{drag:d,dragListener:h=!0}=this.getProps();d&&h&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();Fu(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,a=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),sn.read(r);const s=vp(window,"resize",()=>this.scalePositionWithinConstraints()),c=i.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:d})=>{this.isDragging&&d&&(Ii(h=>{const p=this.getAxisMotionValue(h);p&&(this.originPoint[h]+=u[h].translate,p.set(p.get()+u[h].translate))}),this.visualElement.render())}));return()=>{s(),t(),a(),c&&c()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:a=!1,dragElastic:s=H_,dragMomentum:c=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:a,dragElastic:s,dragMomentum:c}}}function Ym(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function GX(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class qX extends ml{constructor(e){super(e),this.removeGroupControls=Pi,this.removeListeners=Pi,this.controls=new FX(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Pi}unmount(){this.removeGroupControls(),this.removeListeners()}}const Zk=n=>(e,t)=>{n&&sn.postRender(()=>n(e,t))};class $X extends ml{constructor(){super(...arguments),this.removePointerDownListener=Pi}onPointerDown(e){this.session=new Fj(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Uj(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:Zk(e),onStart:Zk(t),onMove:r,onEnd:(a,s)=>{delete this.session,i&&sn.postRender(()=>i(a,s))}}}mount(){this.removePointerDownListener=Oh(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const R0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Jk(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const oh={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(rt.test(n))n=parseFloat(n);else return n;const t=Jk(n,e.target.x),r=Jk(n,e.target.y);return`${t}% ${r}%`}},HX={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=sl.parse(n);if(i.length>5)return r;const a=sl.createTransformer(n),s=typeof i[0]!="number"?1:0,c=t.x.scale*e.x,u=t.y.scale*e.y;i[0+s]/=c,i[1+s]/=u;const d=fn(c,u,.5);return typeof i[2+s]=="number"&&(i[2+s]/=d),typeof i[3+s]=="number"&&(i[3+s]/=d),a(i)}};let p1=!1;class YX extends U.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:a}=e;vK(KX),a&&(t.group&&t.group.add(a),r&&r.register&&i&&r.register(a),p1&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),R0.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:a}=this.props,{projection:s}=r;return s&&(s.isPresent=a,p1=!0,i||e.layoutDependency!==t||t===void 0||e.isPresent!==a?s.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?s.promote():s.relegate()||sn.postRender(()=>{const c=s.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),hE.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;p1=!0,i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function qj(n){const[e,t]=dj(),r=U.useContext($S);return v.jsx(YX,{...n,layoutGroup:r,switchLayoutGroup:U.useContext(Sj),isPresent:e,safeToRemove:t})}const KX={borderRadius:{...oh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:oh,borderTopRightRadius:oh,borderBottomLeftRadius:oh,borderBottomRightRadius:oh,boxShadow:HX};function XX(n,e,t){const r=vr(n)?n:Sd(n);return r.start(TE("",r,e,t)),r.animation}const WX=(n,e)=>n.depth-e.depth;class QX{constructor(){this.children=[],this.isDirty=!1}add(e){KS(this.children,e),this.isDirty=!0}remove(e){XS(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(WX),this.isDirty=!1,this.children.forEach(e)}}function ZX(n,e){const t=Ur.now(),r=({timestamp:i})=>{const a=i-t;a>=e&&(al(r),n(a-e))};return sn.setup(r,!0),()=>al(r)}const $j=["TopLeft","TopRight","BottomLeft","BottomRight"],JX=$j.length,eD=n=>typeof n=="string"?parseFloat(n):n,tD=n=>typeof n=="number"||rt.test(n);function eW(n,e,t,r,i,a){i?(n.opacity=fn(0,t.opacity??1,tW(r)),n.opacityExit=fn(e.opacity??1,0,nW(r))):a&&(n.opacity=fn(e.opacity??1,t.opacity??1,r));for(let s=0;s<JX;s++){const c=`border${$j[s]}Radius`;let u=nD(e,c),d=nD(t,c);if(u===void 0&&d===void 0)continue;u||(u=0),d||(d=0),u===0||d===0||tD(u)===tD(d)?(n[c]=Math.max(fn(eD(u),eD(d),r),0),($a.test(d)||$a.test(u))&&(n[c]+="%")):n[c]=d}(e.rotate||t.rotate)&&(n.rotate=fn(e.rotate||0,t.rotate||0,r))}function nD(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const tW=Hj(0,.5,D4),nW=Hj(.5,.95,Pi);function Hj(n,e,t){return r=>r<n?0:r>e?1:t(fp(n,e,r))}function rD(n,e){n.min=e.min,n.max=e.max}function Ti(n,e){rD(n.x,e.x),rD(n.y,e.y)}function iD(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function aD(n,e,t,r,i){return n-=e,n=vv(n,1/t,r),i!==void 0&&(n=vv(n,1/i,r)),n}function rW(n,e=0,t=1,r=.5,i,a=n,s=n){if($a.test(e)&&(e=parseFloat(e),e=fn(s.min,s.max,e/100)-s.min),typeof e!="number")return;let c=fn(a.min,a.max,r);n===a&&(c-=e),n.min=aD(n.min,e,t,c,i),n.max=aD(n.max,e,t,c,i)}function sD(n,e,[t,r,i],a,s){rW(n,e[t],e[r],e[i],e.scale,a,s)}const iW=["x","scaleX","originX"],aW=["y","scaleY","originY"];function oD(n,e,t,r){sD(n.x,e,iW,t?t.x:void 0,r?r.x:void 0),sD(n.y,e,aW,t?t.y:void 0,r?r.y:void 0)}function lD(n){return n.translate===0&&n.scale===1}function Yj(n){return lD(n.x)&&lD(n.y)}function cD(n,e){return n.min===e.min&&n.max===e.max}function sW(n,e){return cD(n.x,e.x)&&cD(n.y,e.y)}function uD(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function Kj(n,e){return uD(n.x,e.x)&&uD(n.y,e.y)}function dD(n){return Cr(n.x)/Cr(n.y)}function fD(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class oW{constructor(){this.members=[]}add(e){KS(this.members,e),e.scheduleRender()}remove(e){if(XS(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const a=this.members[i];if(a.isPresent!==!1){r=a;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function lW(n,e,t){let r="";const i=n.x.translate/e.x,a=n.y.translate/e.y,s=t?.z||0;if((i||a||s)&&(r=`translate3d(${i}px, ${a}px, ${s}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:d,rotate:h,rotateX:p,rotateY:m,skewX:b,skewY:_}=t;d&&(r=`perspective(${d}px) ${r}`),h&&(r+=`rotate(${h}deg) `),p&&(r+=`rotateX(${p}deg) `),m&&(r+=`rotateY(${m}deg) `),b&&(r+=`skewX(${b}deg) `),_&&(r+=`skewY(${_}deg) `)}const c=n.x.scale*e.x,u=n.y.scale*e.y;return(c!==1||u!==1)&&(r+=`scale(${c}, ${u})`),r||"none"}const g1=["","X","Y","Z"],cW=1e3;let uW=0;function m1(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function Xj(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=Mj(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:a}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",sn,!(i||a))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&Xj(r)}function Wj({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(s={},c=e?.()){this.id=uW++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(hW),this.nodes.forEach(vW),this.nodes.forEach(yW),this.nodes.forEach(pW)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=s,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new QX)}addEventListener(s,c){return this.eventHandlers.has(s)||this.eventHandlers.set(s,new ZS),this.eventHandlers.get(s).add(c)}notifyListeners(s,...c){const u=this.eventHandlers.get(s);u&&u.notify(...c)}hasListeners(s){return this.eventHandlers.has(s)}mount(s){if(this.instance)return;this.isSVG=uj(s)&&!nK(s),this.instance=s;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(s),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(u||c)&&(this.isLayoutDirty=!0),n){let h,p=0;const m=()=>this.root.updateBlockedByResize=!1;sn.read(()=>{p=window.innerWidth}),n(s,()=>{const b=window.innerWidth;b!==p&&(p=b,this.root.updateBlockedByResize=!0,h&&h(),h=ZX(m,250),R0.hasAnimatedSinceResize&&(R0.hasAnimatedSinceResize=!1,this.nodes.forEach(gD)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:p,hasRelativeLayoutChanged:m,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||d.getDefaultTransition()||SW,{onLayoutAnimationStart:w,onLayoutAnimationComplete:E}=d.getProps(),T=!this.targetLayout||!Kj(this.targetLayout,b),C=!p&&m;if(this.options.layoutRoot||this.resumeFrom||C||p&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const k={...dE(_,"layout"),onPlay:w,onComplete:E};(d.shouldReduceMotion||this.options.layoutRoot)&&(k.delay=0,k.type=!1),this.startAnimation(k),this.setAnimationOrigin(h,C)}else p||gD(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const s=this.getStack();s&&s.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),al(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(bW),this.animationId++)}getTransformTemplate(){const{visualElement:s}=this.options;return s&&s.getProps().transformTemplate}willUpdate(s=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Xj(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const p=this.path[h];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:c,layout:u}=this.options;if(c===void 0&&!u)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),s&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(hD);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(pD);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(mW),this.nodes.forEach(dW),this.nodes.forEach(fW)):this.nodes.forEach(pD),this.clearAllSnapshots();const c=Ur.now();lr.delta=Vs(0,1e3/60,c-lr.timestamp),lr.timestamp=c,lr.isProcessing=!0,i1.update.process(lr),i1.preRender.process(lr),i1.render.process(lr),lr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,hE.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(gW),this.sharedNodes.forEach(xW)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,sn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){sn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Cr(this.snapshot.measuredBox.x)&&!Cr(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const s=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Tn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,s?s.layoutBox:void 0)}updateScroll(s="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===s&&(c=!1),c&&this.instance){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:s,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!i)return;const s=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!Yj(this.projectionDelta),u=this.getTransformTemplate(),d=u?u(this.latestValues,""):void 0,h=d!==this.prevTransformTemplateValue;s&&this.instance&&(c||Ql(this.latestValues)||h)&&(i(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(s=!0){const c=this.measurePageBox();let u=this.removeElementScroll(c);return s&&(u=this.removeTransform(u)),EW(u),{animationId:this.root.animationId,measuredBox:c,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:s}=this.options;if(!s)return Tn();const c=s.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(TW))){const{scroll:d}=this.root;d&&(Gu(c.x,d.offset.x),Gu(c.y,d.offset.y))}return c}removeElementScroll(s){const c=Tn();if(Ti(c,s),this.scroll?.wasRoot)return c;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:h,options:p}=d;d!==this.root&&h&&p.layoutScroll&&(h.wasRoot&&Ti(c,s),Gu(c.x,h.offset.x),Gu(c.y,h.offset.y))}return c}applyTransform(s,c=!1){const u=Tn();Ti(u,s);for(let d=0;d<this.path.length;d++){const h=this.path[d];!c&&h.options.layoutScroll&&h.scroll&&h!==h.root&&qu(u,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Ql(h.latestValues)&&qu(u,h.latestValues)}return Ql(this.latestValues)&&qu(u,this.latestValues),u}removeTransform(s){const c=Tn();Ti(c,s);for(let u=0;u<this.path.length;u++){const d=this.path[u];if(!d.instance||!Ql(d.latestValues))continue;B_(d.latestValues)&&d.updateSnapshot();const h=Tn(),p=d.measurePageBox();Ti(h,p),oD(c,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,h)}return Ql(this.latestValues)&&oD(c,this.latestValues),c}setTargetDelta(s){this.targetDelta=s,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(s){this.options={...this.options,...s,crossfade:s.crossfade!==void 0?s.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==lr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(s=!1){const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(s||u&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:p}=this.options;if(!(!this.layout||!(h||p))){if(this.resolvedRelativeTargetAt=lr.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Tn(),this.relativeTargetOrigin=Tn(),Vh(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Ti(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Tn(),this.targetWithTransforms=Tn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),DX(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ti(this.target,this.layout.layoutBox),Cj(this.target,this.targetDelta)):Ti(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Tn(),this.relativeTargetOrigin=Tn(),Vh(this.relativeTargetOrigin,this.target,m.target),Ti(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||B_(this.parent.latestValues)||Aj(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const s=this.getLead(),c=!!this.resumingFrom||this!==s;let u=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===lr.timestamp&&(u=!1),u)return;const{layout:d,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||h))return;Ti(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,m=this.treeScale.y;$K(this.layoutCorrected,this.treeScale,this.path,c),s.layout&&!s.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(s.target=s.layout.layoutBox,s.targetWithTransforms=Tn());const{target:b}=s;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(iD(this.prevProjectionDelta.x,this.projectionDelta.x),iD(this.prevProjectionDelta.y,this.projectionDelta.y)),jh(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==m||!fD(this.projectionDelta.x,this.prevProjectionDelta.x)||!fD(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(s=!0){if(this.options.visualElement?.scheduleRender(),s){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=$u(),this.projectionDelta=$u(),this.projectionDeltaWithTransform=$u()}setAnimationOrigin(s,c=!1){const u=this.snapshot,d=u?u.latestValues:{},h={...this.latestValues},p=$u();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const m=Tn(),b=u?u.source:void 0,_=this.layout?this.layout.source:void 0,w=b!==_,E=this.getStack(),T=!E||E.members.length<=1,C=!!(w&&!T&&this.options.crossfade===!0&&!this.path.some(wW));this.animationProgress=0;let k;this.mixTargetDelta=j=>{const P=j/1e3;mD(p.x,s.x,P),mD(p.y,s.y,P),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Vh(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),_W(this.relativeTarget,this.relativeTargetOrigin,m,P),k&&sW(this.relativeTarget,k)&&(this.isProjectionDirty=!1),k||(k=Tn()),Ti(k,this.relativeTarget)),w&&(this.animationValues=h,eW(h,d,this.latestValues,P,C,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=P},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(s){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(al(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=sn.update(()=>{R0.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Sd(0)),this.currentAnimation=XX(this.motionValue,[0,1e3],{...s,velocity:0,isSync:!0,onUpdate:c=>{this.mixTargetDelta(c),s.onUpdate&&s.onUpdate(c)},onStop:()=>{},onComplete:()=>{s.onComplete&&s.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const s=this.getStack();s&&s.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(cW),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const s=this.getLead();let{targetWithTransforms:c,target:u,layout:d,latestValues:h}=s;if(!(!c||!u||!d)){if(this!==s&&this.layout&&d&&Qj(this.options.animationType,this.layout.layoutBox,d.layoutBox)){u=this.target||Tn();const p=Cr(this.layout.layoutBox.x);u.x.min=s.target.x.min,u.x.max=u.x.min+p;const m=Cr(this.layout.layoutBox.y);u.y.min=s.target.y.min,u.y.max=u.y.min+m}Ti(c,u),qu(c,h),jh(this.projectionDeltaWithTransform,this.layoutCorrected,c,h)}}registerSharedNode(s,c){this.sharedNodes.has(s)||this.sharedNodes.set(s,new oW),this.sharedNodes.get(s).add(c);const d=c.options.initialPromotionConfig;c.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(c):void 0})}isLead(){const s=this.getStack();return s?s.lead===this:!0}getLead(){const{layoutId:s}=this.options;return s?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:s}=this.options;return s?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:s}=this.options;if(s)return this.root.sharedNodes.get(s)}promote({needsReset:s,transition:c,preserveFollowOpacity:u}={}){const d=this.getStack();d&&d.promote(this,u),s&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const s=this.getStack();return s?s.relegate(this):!1}resetSkewAndRotation(){const{visualElement:s}=this.options;if(!s)return;let c=!1;const{latestValues:u}=s;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(c=!0),!c)return;const d={};u.z&&m1("z",s,d,this.animationValues);for(let h=0;h<g1.length;h++)m1(`rotate${g1[h]}`,s,d,this.animationValues),m1(`skew${g1[h]}`,s,d,this.animationValues);s.render();for(const h in d)s.setStaticValue(h,d[h]),this.animationValues&&(this.animationValues[h]=d[h]);s.scheduleRender()}applyProjectionStyles(s,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){s.visibility="hidden";return}const u=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,s.visibility="",s.opacity="",s.pointerEvents=I0(c?.pointerEvents)||"",s.transform=u?u(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(s.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,s.pointerEvents=I0(c?.pointerEvents)||""),this.hasProjected&&!Ql(this.latestValues)&&(s.transform=u?u({},""):"none",this.hasProjected=!1);return}s.visibility="";const h=d.animationValues||d.latestValues;this.applyTransformsToTarget();let p=lW(this.projectionDeltaWithTransform,this.treeScale,h);u&&(p=u(h,p)),s.transform=p;const{x:m,y:b}=this.projectionDelta;s.transformOrigin=`${m.origin*100}% ${b.origin*100}% 0`,d.animationValues?s.opacity=d===this?h.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:s.opacity=d===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const _ in mp){if(h[_]===void 0)continue;const{correct:w,applyTo:E,isCSSVariable:T}=mp[_],C=p==="none"?h[_]:w(h[_],d);if(E){const k=E.length;for(let j=0;j<k;j++)s[E[j]]=C}else T?this.options.visualElement.renderState.vars[_]=C:s[_]=C}this.options.layoutId&&(s.pointerEvents=d===this?I0(c?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(s=>s.currentAnimation?.stop()),this.root.nodes.forEach(hD),this.root.sharedNodes.clear()}}}function dW(n){n.updateLayout()}function fW(n){const e=n.resumeFrom?.snapshot||n.snapshot;if(n.isLead()&&n.layout&&e&&n.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:r}=n.layout,{animationType:i}=n.options,a=e.source!==n.layout.source;i==="size"?Ii(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=Cr(p);p.min=t[h].min,p.max=p.min+m}):Qj(i,e.layoutBox,t)&&Ii(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=Cr(t[h]);p.max=p.min+m,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[h].max=n.relativeTarget[h].min+m)});const s=$u();jh(s,t,e.layoutBox);const c=$u();a?jh(c,n.applyTransform(r,!0),e.measuredBox):jh(c,t,e.layoutBox);const u=!Yj(s);let d=!1;if(!n.resumeFrom){const h=n.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:p,layout:m}=h;if(p&&m){const b=Tn();Vh(b,e.layoutBox,p.layoutBox);const _=Tn();Vh(_,t,m.layoutBox),Kj(b,_)||(d=!0),h.options.layoutRoot&&(n.relativeTarget=_,n.relativeTargetOrigin=b,n.relativeParent=h)}}}n.notifyListeners("didUpdate",{layout:t,snapshot:e,delta:c,layoutDelta:s,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(n.isLead()){const{onExitComplete:t}=n.options;t&&t()}n.options.transition=void 0}function hW(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function pW(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function gW(n){n.clearSnapshot()}function hD(n){n.clearMeasurements()}function pD(n){n.isLayoutDirty=!1}function mW(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function gD(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function vW(n){n.resolveTargetDelta()}function yW(n){n.calcProjection()}function bW(n){n.resetSkewAndRotation()}function xW(n){n.removeLeadSnapshot()}function mD(n,e,t){n.translate=fn(e.translate,0,t),n.scale=fn(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function vD(n,e,t,r){n.min=fn(e.min,t.min,r),n.max=fn(e.max,t.max,r)}function _W(n,e,t,r){vD(n.x,e.x,t.x,r),vD(n.y,e.y,t.y,r)}function wW(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const SW={duration:.45,ease:[.4,0,.1,1]},yD=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),bD=yD("applewebkit/")&&!yD("chrome/")?Math.round:Pi;function xD(n){n.min=bD(n.min),n.max=bD(n.max)}function EW(n){xD(n.x),xD(n.y)}function Qj(n,e,t){return n==="position"||n==="preserve-aspect"&&!kX(dD(e),dD(t),.2)}function TW(n){return n!==n.root&&n.scroll?.wasRoot}const AW=Wj({attachResizeListener:(n,e)=>vp(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),v1={current:void 0},Zj=Wj({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!v1.current){const n=new AW({});n.mount(window),n.setOptions({layoutScroll:!0}),v1.current=n}return v1.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),CW={pan:{Feature:$X},drag:{Feature:qX,ProjectionNode:Zj,MeasureLayout:qj}};function _D(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,a=r[i];a&&sn.postRender(()=>a(e,Jp(e)))}class IW extends ml{mount(){const{current:e}=this.node;e&&(this.unmount=QY(e,(t,r)=>(_D(this.node,r,"Start"),i=>_D(this.node,i,"End"))))}unmount(){}}class RW extends ml{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Wp(vp(this.node.current,"focus",()=>this.onFocus()),vp(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function wD(n,e,t){const{props:r}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),a=r[i];a&&sn.postRender(()=>a(e,Jp(e)))}class kW extends ml{mount(){const{current:e}=this.node;e&&(this.unmount=tK(e,(t,r)=>(wD(this.node,r,"Start"),(i,{success:a})=>wD(this.node,i,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Y_=new WeakMap,y1=new WeakMap,DW=n=>{const e=Y_.get(n.target);e&&e(n)},NW=n=>{n.forEach(DW)};function MW({root:n,...e}){const t=n||document;y1.has(t)||y1.set(t,{});const r=y1.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(NW,{root:n,...e})),r[i]}function PW(n,e,t){const r=MW(e);return Y_.set(n,t),r.observe(n),()=>{Y_.delete(n),r.unobserve(n)}}const OW={some:0,all:1};class jW extends ml{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:a}=e,s={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:OW[i]},c=u=>{const{isIntersecting:d}=u;if(this.isInView===d||(this.isInView=d,a&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:h,onViewportLeave:p}=this.node.getProps(),m=d?h:p;m&&m(u)};return PW(this.node.current,s,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(VW(e,t))&&this.startObserver()}unmount(){}}function VW({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const zW={inView:{Feature:jW},tap:{Feature:kW},focus:{Feature:RW},hover:{Feature:IW}},LW={layout:{ProjectionNode:Zj,MeasureLayout:qj}},BW={...EX,...zW,...CW,...LW},_n=FK(BW,tX);function UW(n){n.values.forEach(e=>e.stop())}function K_(n,e){[...e].reverse().forEach(r=>{const i=n.getVariant(r);i&&EE(n,i),n.variantChildren&&n.variantChildren.forEach(a=>{K_(a,e)})})}function FW(n,e){if(Array.isArray(e))return K_(n,e);if(typeof e=="string")return K_(n,[e]);EE(n,e)}function GW(){const n=new Set,e={subscribe(t){return n.add(t),()=>void n.delete(t)},start(t,r){const i=[];return n.forEach(a=>{i.push(jj(a,t,{transitionOverride:r}))}),Promise.all(i)},set(t){return n.forEach(r=>{FW(r,t)})},stop(){n.forEach(t=>{UW(t)})},mount(){return()=>{e.stop()}}};return e}function qW(){const n=fy(GW);return YS(n.mount,[]),n}const $W=qW,Vc=qw((n,e)=>({message:"",type:"neutral",isVisible:!1,undoAction:void 0,showToast:(t,r="neutral",i)=>{n({message:t,type:r,isVisible:!0,undoAction:i}),setTimeout(()=>{e().hideToast()},2e3)},hideToast:()=>{n({isVisible:!1})}})),HW=()=>{const{message:n,type:e,isVisible:t,undoAction:r,hideToast:i}=Vc(),a=()=>{switch(e){case"success":return"bg-green-500 dark:bg-green-600 text-white";case"error":return"bg-red-500 dark:bg-red-600 text-white";case"neutral":default:return"bg-gray-800 dark:bg-gray-900 text-white border border-gray-200 dark:border-gray-700"}};return v.jsx(di,{children:t&&v.jsx(_n.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-24 right-6 z-[110] max-w-xs",children:v.jsxs("div",{className:`rounded-lg shadow-lg p-3 flex items-center justify-between ${a()}`,children:[v.jsx("div",{className:"flex items-center flex-1 min-w-0",children:v.jsx("span",{className:"text-xs font-medium whitespace-pre-line pr-2",children:n})}),v.jsxs("div",{className:"flex items-center gap-1 ml-2 flex-shrink-0",children:[r&&v.jsxs("button",{onClick:()=>{r(),i()},className:"px-2 py-1 bg-white/20 hover:bg-white/30 rounded text-xs font-bold transition-colors",children:[v.jsx(c7,{size:12,className:"inline mr-1"}),"Undo"]}),v.jsx("button",{onClick:i,className:"p-0.5 hover:bg-black/10 dark:hover:bg-white/10 rounded-full transition-colors",children:v.jsx(Uv,{size:14})})]})]})})})};class Ri extends U.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t),this.setState({error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t)}componentDidUpdate(e){this.props.resetKeys&&this.props.resetOnPropsChange&&this.props.resetKeys.some((r,i)=>r!==e.resetKeys?.[i])&&this.state.hasError&&this.resetErrorBoundary()}resetErrorBoundary=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[v.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 dark:bg-red-900/30 rounded-full",children:v.jsx(td,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white text-center mb-2",children:"Something went wrong"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-6",children:"We're sorry, but something unexpected happened. You can try refreshing or going back to the home screen."}),!1,v.jsxs("div",{className:"flex flex-col gap-3",children:[v.jsxs("button",{onClick:this.resetErrorBoundary,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors",children:[v.jsx(Kh,{className:"h-4 w-4"}),"Try Again"]}),v.jsxs("button",{onClick:()=>window.location.href="/#/",className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white font-medium rounded-md transition-colors",children:[v.jsx(NF,{className:"h-4 w-4"}),"Go to Home"]})]})]})}):this.props.children}}const YW=({onAddTransaction:n})=>{const e=Za(),t=da(),[r,i]=U.useState(!1),a=U.useRef(null),s=d=>t.pathname===d;U.useEffect(()=>{const d=h=>{a.current&&!a.current.contains(h.target)&&i(!1)};if(r)return document.addEventListener("mousedown",d),document.addEventListener("touchstart",d),()=>{document.removeEventListener("mousedown",d),document.removeEventListener("touchstart",d)}},[r]);const c=[{path:"/reports",icon:v.jsx(rF,{className:"w-5 h-5"}),label:"Reports"},{path:"/analytics",icon:v.jsx(H0,{className:"w-5 h-5"}),label:"Analytics"},{path:"/budget-breakdown",icon:v.jsx(aF,{className:"w-5 h-5"}),label:"Budget Breakdown"}],u=({path:d,icon:h,label:p})=>{const m=s(d);return v.jsxs("button",{onClick:b=>{b.stopPropagation(),e(d)},className:`
          relative group flex flex-col items-center justify-center
          w-12 h-12 rounded-2xl transition-all duration-300
          ${m?"text-blue-500 bg-blue-50 dark:bg-blue-500/20 dark:text-blue-400":"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-800"}
        `,children:[v.jsx("div",{className:`transition-transform duration-300 ${m?"scale-110":"group-hover:scale-105"}`,children:h}),v.jsx("span",{className:"sr-only",children:p}),m&&v.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-current rounded-full opacity-80"})]})};return v.jsx("div",{className:"fixed bottom-6 left-0 right-0 flex justify-center z-[100] pointer-events-none safe-area-inset-bottom",children:v.jsxs("nav",{className:`
          pointer-events-auto
          flex items-center gap-1 p-2 pl-4 pr-4
          bg-white/60 dark:bg-zinc-900/60 backdrop-blur-xl
          border border-zinc-200/30 dark:border-zinc-800/30
          rounded-full shadow-2xl shadow-zinc-900/10
          transform transition-all duration-500 ease-out
        `,onClick:d=>d.stopPropagation(),onTouchStart:d=>d.stopPropagation(),onTouchEnd:d=>d.stopPropagation(),children:[v.jsx(u,{path:"/",label:"Budget",icon:v.jsx(Bv,{className:"w-6 h-6"})}),v.jsx(u,{path:"/transactions",label:"Transactions",icon:v.jsx(PF,{className:"w-6 h-6"})}),v.jsx("div",{className:"w-px h-8 bg-zinc-200 dark:bg-zinc-800 mx-2"}),v.jsx("button",{onClick:d=>{if(d.stopPropagation(),i(!1),n){n();return}e("/add-transaction")},className:`
            -mt-8 mb-2 mx-1
            group relative flex items-center justify-center
            w-16 h-16 rounded-full
            bg-blue-600 text-white
            shadow-xl shadow-blue-600/30
            hover:shadow-blue-600/50 hover:scale-105 hover:-translate-y-1
            active:scale-95 active:translate-y-0
            transition-all duration-300 cubic-bezier(0.175, 0.885, 0.32, 1.275)
          `,children:v.jsx(Op,{className:"w-8 h-8 transition-transform duration-300 group-hover:rotate-90"})}),v.jsx("div",{className:"w-px h-8 bg-zinc-200 dark:bg-zinc-800 mx-2"}),v.jsxs("div",{className:"relative",ref:a,children:[v.jsxs("button",{onClick:d=>{d.stopPropagation(),i(!r)},className:`
              relative group flex flex-col items-center justify-center
              w-12 h-12 rounded-2xl transition-all duration-300
              ${r?"text-blue-500 bg-blue-50 dark:bg-blue-500/20 dark:text-blue-400":"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-800"}
            `,children:[v.jsx("div",{className:`transition-transform duration-300 ${r?"scale-110":"group-hover:scale-105"}`,children:v.jsx(_F,{className:"w-6 h-6"})}),v.jsx("span",{className:"sr-only",children:"More"}),r&&v.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-current rounded-full opacity-80"})]}),r&&v.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-56 bg-white dark:bg-zinc-900 rounded-2xl shadow-2xl border border-zinc-200/50 dark:border-zinc-800/50 backdrop-blur-xl z-50 overflow-hidden",onClick:d=>d.stopPropagation(),onTouchStart:d=>d.stopPropagation(),onTouchEnd:d=>d.stopPropagation(),children:v.jsx("div",{className:"p-2 space-y-1",children:c.map((d,h)=>v.jsxs("button",{onClick:p=>{p.stopPropagation(),e(d.path),i(!1)},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[v.jsx("div",{className:"text-zinc-600 dark:text-zinc-400",children:d.icon}),v.jsx("span",{className:"text-sm font-medium text-zinc-900 dark:text-white",children:d.label})]},h))})})]}),v.jsx(u,{path:"/settings",label:"Settings",icon:v.jsx(ZF,{className:"w-6 h-6"})})]})})};function KW(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.map(function(r){return r.split(" ").map(function(i){return i?""+n+i:""}).join(" ")}).join(" ")}function XW(n,e){return e.replace(/([^}{]*){/gm,function(t,r){return r.replace(/\.([^{,\s\d.]+)/g,"."+n+"$1")+"{"})}function Rs(n,e){return function(t){t&&(n[e]=t)}}function Jj(n,e,t){return function(r){r&&(n[e][t]=r)}}function SD(n,e){return function(t){var r=t.prototype;n.forEach(function(i){e(r,i)})}}function WW(n,e){return e===void 0&&(e={}),function(t,r){n.forEach(function(i){var a=e[i]||i;a in t||(t[a]=function(){for(var s,c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];var d=(s=this[r])[i].apply(s,c);return d===this[r]?this:d})})}}var QW="function",ZW="object",JW="string",eQ="number",AE="undefined",e3=typeof window!==AE,tQ=typeof document!==AE&&document,nQ=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],Un=1e-7,Km={cm:function(n){return n*96/2.54},mm:function(n){return n*96/254},in:function(n){return n*96},pt:function(n){return n*96/72},pc:function(n){return n*96/6},"%":function(n,e){return n*e/100},vw:function(n,e){return e===void 0&&(e=window.innerWidth),n/100*e},vh:function(n,e){return e===void 0&&(e=window.innerHeight),n/100*e},vmax:function(n,e){return e===void 0&&(e=Math.max(window.innerWidth,window.innerHeight)),n/100*e},vmin:function(n,e){return e===void 0&&(e=Math.min(window.innerWidth,window.innerHeight)),n/100*e}};function rQ(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],s=0,c=a.length;s<c;s++,i++)r[i]=a[s];return r}function yv(n,e,t,r){return(n*r+e*t)/(t+r)}function vy(n){return typeof n===AE}function la(n){return n&&typeof n===ZW}function Gn(n){return Array.isArray(n)}function Gr(n){return typeof n===JW}function Td(n){return typeof n===eQ}function CE(n){return typeof n===QW}function iQ(n,e){var t=n===""||n==" ",r=e===""||e==" ";return r&&t||n===e}function t3(n,e,t,r,i){var a=IE(n,e,t);return a?t:aQ(n,e,t+1,r,i)}function IE(n,e,t){if(!n.ignore)return null;var r=e.slice(Math.max(t-3,0),t+3).join("");return new RegExp(n.ignore).exec(r)}function aQ(n,e,t,r,i){for(var a=function(d){var h=e[d].trim();if(h===n.close&&!IE(n,e,d))return{value:d};var p=d,m=qr(i,function(b){var _=b.open;return _===h});if(m&&(p=t3(m,e,d,r,i)),p===-1)return s=d,"break";d=p,s=d},s,c=t;c<r;++c){var u=a(c);if(c=s,typeof u=="object")return u.value;if(u==="break")break}return-1}function RE(n,e){var t=Gr(e)?{separator:e}:e,r=t.separator,i=r===void 0?",":r,a=t.isSeparateFirst,s=t.isSeparateOnlyOpenClose,c=t.isSeparateOpenClose,u=c===void 0?s:c,d=t.openCloseCharacters,h=d===void 0?nQ:d,p=h.map(function(A){var I=A.open,D=A.close;return I===D?I:I+"|"+D}).join("|"),m="(\\s*"+i+"\\s*|"+p+"|\\s+)",b=new RegExp(m,"g"),_=n.split(b).filter(function(A){return A&&A!=="undefined"}),w=_.length,E=[],T=[];function C(){return T.length?(E.push(T.join("")),T=[],!0):!1}for(var k=function(A){var I=_[A].trim(),D=A,z=qr(h,function(O){var X=O.open;return X===I}),V=qr(h,function(O){var X=O.close;return X===I});if(z){if(D=t3(z,_,A,w,h),D!==-1&&u)return C()&&a||(E.push(_.slice(A,D+1).join("")),A=D,a)?(j=A,"break"):(j=A,"continue")}else if(V&&!IE(V,_,A)){var B=rQ(h);return B.splice(h.indexOf(V),1),{value:RE(n,{separator:i,isSeparateFirst:a,isSeparateOnlyOpenClose:s,isSeparateOpenClose:u,openCloseCharacters:B})}}else if(iQ(I,i)&&!s)return C(),a?(j=A,"break"):(j=A,"continue");D===-1&&(D=w-1),T.push(_.slice(A,D+1).join("")),A=D,j=A},j,P=0;P<w;++P){var N=k(P);if(P=j,typeof N=="object")return N.value;if(N==="break")break}return T.length&&E.push(T.join("")),E}function ol(n){return RE(n,"")}function uc(n){return RE(n,",")}function n3(n){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(n);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function eg(n){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(n);if(!e)return{prefix:"",unit:"",value:NaN};var t=e[1],r=e[2],i=e[3];return{prefix:t,unit:i,value:parseFloat(r)}}function sQ(n){return n.replace(/[\s-_]+([^\s-_])/g,function(e,t){return t.toUpperCase()})}function k0(n,e){return n.replace(/([a-z])([A-Z])/g,function(t,r,i){return""+r+e+i.toLowerCase()})}function yp(){return Date.now?Date.now():new Date().getTime()}function Ls(n,e,t){t===void 0&&(t=-1);for(var r=n.length,i=0;i<r;++i)if(e(n[i],i,n))return i;return t}function qr(n,e,t){var r=Ls(n,e);return r>-1?n[r]:t}var r3=(function(){var n=yp(),e=e3&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(t){var r=yp(),i=setTimeout(function(){t(r-n)},1e3/60);return i}})(),oQ=(function(){var n=e3&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return n?n.bind(window):function(e){clearTimeout(e)}})();function Bs(n){return Object.keys(n)}function lQ(n){var e=Bs(n);return e.map(function(t){return n[t]})}function Ht(n,e){var t=eg(n),r=t.value,i=t.unit;if(la(e)){var a=e[i];if(a){if(CE(a))return a(r);if(Km[i])return Km[i](r,a)}}else if(i==="%")return r*e/100;return Km[i]?Km[i](r):r}function X_(n,e,t){return Math.max(e,Math.min(n,t))}function ED(n,e,t,r){return r===void 0&&(r=n[0]/n[1]),[[st(e[0],Un),st(e[0]/r,Un)],[st(e[1]*r,Un),st(e[1],Un)]].filter(function(i){return i.every(function(a,s){var c=e[s],u=st(c,Un);return t?a<=c||a<=u:a>=c||a>=u})})[0]||n}function i3(n,e,t,r){if(!r)return n.map(function(b,_){return X_(b,e[_],t[_])});var i=n[0],a=n[1],s=r===!0?i/a:r,c=ED(n,e,!1,s),u=c[0],d=c[1],h=ED(n,t,!0,s),p=h[0],m=h[1];return i<u||a<d?(i=u,a=d):(i>p||a>m)&&(i=p,a=m),[i,a]}function cQ(n){for(var e=n.length,t=0,r=e-1;r>=0;--r)t+=n[r];return t}function W_(n){for(var e=n.length,t=0,r=e-1;r>=0;--r)t+=n[r];return e?t/e:0}function In(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=Math.atan2(r,t);return i>=0?i:i+Math.PI*2}function uQ(n){return[0,1].map(function(e){return W_(n.map(function(t){return t[e]}))})}function TD(n){var e=uQ(n),t=In(e,n[0]),r=In(e,n[1]);return t<r&&r-t<Math.PI||t>r&&r-t<-Math.PI?1:-1}function ks(n,e){return Math.sqrt(Math.pow((e?e[0]:0)-n[0],2)+Math.pow((e?e[1]:0)-n[1],2))}function st(n,e){if(!e)return n;var t=1/e;return Math.round(n/e)/t}function AD(n,e){return n.forEach(function(t,r){n[r]=st(n[r],e)}),n}function dQ(n){for(var e=[],t=0;t<n;++t)e.push(t);return e}function a3(n){return n.reduce(function(e,t){return e.concat(t)},[])}function s3(n,e){n.indexOf(e)===-1&&n.push(e)}function Yn(n,e){return n.classList?n.classList.contains(e):!!n.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function o3(n,e){n.classList?n.classList.add(e):n.className+=" "+e}function l3(n,e){if(n.classList)n.classList.remove(e);else{var t=new RegExp("(\\s|^)"+e+"(\\s|$)");n.className=n.className.replace(t," ")}}function or(n,e,t,r){n.addEventListener(e,t,r)}function $n(n,e,t,r){n.removeEventListener(e,t,r)}function Kd(n){return n?.ownerDocument||tQ}function kE(n){return Kd(n).documentElement}function vl(n){return Kd(n).body}function Qo(n){var e;return((e=n?.ownerDocument)===null||e===void 0?void 0:e.defaultView)||window}function c3(n){return n&&"postMessage"in n&&"blur"in n&&"self"in n}function Xd(n){return la(n)&&n.nodeName&&n.nodeType&&"ownerDocument"in n}var fQ=(function(){function n(){this.keys=[],this.values=[]}var e=n.prototype;return e.get=function(t){return this.values[this.keys.indexOf(t)]},e.set=function(t,r){var i=this.keys,a=this.values,s=i.indexOf(t),c=s===-1?i.length:s;i[c]=t,a[c]=r},n})(),hQ=(function(){function n(){this.object={}}var e=n.prototype;return e.get=function(t){return this.object[t]},e.set=function(t,r){this.object[t]=r},n})(),pQ=typeof Map=="function",gQ=(function(){function n(){}var e=n.prototype;return e.connect=function(t,r){this.prev=t,this.next=r,t&&(t.next=this),r&&(r.prev=this)},e.disconnect=function(){var t=this.prev,r=this.next;t&&(t.next=r),r&&(r.prev=t)},e.getIndex=function(){for(var t=this,r=-1;t;)t=t.prev,++r;return r},n})();function mQ(n,e){var t=[],r=[];return n.forEach(function(i){var a=i[0],s=i[1],c=new gQ;t[a]=c,r[s]=c}),t.forEach(function(i,a){i.connect(t[a-1])}),n.filter(function(i,a){return!e[a]}).map(function(i,a){var s=i[0],c=i[1];if(s===c)return[0,0];var u=t[s],d=r[c-1],h=u.getIndex();u.disconnect(),d?u.connect(d,d.next):u.connect(void 0,t[0]);var p=u.getIndex();return[h,p]})}var vQ=(function(){function n(t,r,i,a,s,c,u,d){this.prevList=t,this.list=r,this.added=i,this.removed=a,this.changed=s,this.maintained=c,this.changedBeforeAdded=u,this.fixed=d}var e=n.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var t=mQ(this.changedBeforeAdded,this.fixed),r=this.changed,i=[];this.cacheOrdered=t.filter(function(a,s){var c=a[0],u=a[1],d=r[s],h=d[0],p=d[1];if(c!==u)return i.push([h,p]),!0}),this.cachePureChanged=i},n})();function tg(n,e,t){var r=pQ?Map:t?hQ:fQ,i=t||function(C){return C},a=[],s=[],c=[],u=n.map(i),d=e.map(i),h=new r,p=new r,m=[],b=[],_={},w=[],E=0,T=0;return u.forEach(function(C,k){h.set(C,k)}),d.forEach(function(C,k){p.set(C,k)}),u.forEach(function(C,k){var j=p.get(C);typeof j>"u"?(++T,s.push(k)):_[j]=T}),d.forEach(function(C,k){var j=h.get(C);typeof j>"u"?(a.push(k),++E):(c.push([j,k]),T=_[k]||0,m.push([j-T,k-E]),b.push(k===j),j!==k&&w.push([j,k]))}),s.reverse(),new vQ(n,e,a,s,w,c,m,b)}var yQ=(function(){function n(t,r){t===void 0&&(t=[]),this.findKeyCallback=r,this.list=[].slice.call(t)}var e=n.prototype;return e.update=function(t){var r=[].slice.call(t),i=tg(this.list,r,this.findKeyCallback);return this.list=r,i},n})(),Q_=function(n,e){return Q_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},Q_(n,e)};function ng(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Q_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Va=function(){return Va=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Va.apply(this,arguments)};function u3(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function CD(n,e,t){for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function ID(n){var e=0;return n.map(function(t){return t==null?"$compat".concat(++e):"".concat(t)})}function d3(n){var e=[];return n.forEach(function(t){e=e.concat(Gn(t)?d3(t):t)}),e}function b1(n,e){if(!e)return n;for(var t in e)vy(n[t])&&(n[t]=e[t]);return n}function bv(n,e){if(n===e)return!1;for(var t in n)if(!(t in e))return!0;for(var t in e)if(n[t]!==e[t])return!0;return!1}function RD(n){var e=n.className,t=u3(n,["className"]);return e!=null&&(t.class=e),delete t.style,delete t.children,t}function kD(n){var e={},t={};for(var r in n)r.indexOf("on")===0?t[r]=n[r]:e[r]=n[r];return[e,t]}function yy(n){if(!n)return null;var e=n.b;return Xd(e)?e:yy(n.c)}function f3(n){var e=n.parentNode;e&&e.removeChild(n)}function h3(n){n.forEach(function(e){e()})}function bQ(){return this.constructor(this.props,this.context)}var DE=0,by=(function(){function n(t,r,i,a,s,c,u){u===void 0&&(u={}),this.t=t,this.d=r,this.k=i,this.i=a,this.c=s,this.ref=c,this.ps=u,this.typ="prov",this._ps=[],this._cs={},this._hyd=null,this._sel=!1}var e=n.prototype;return e.s=function(){return!0},e.u=function(t,r,i,a,s){var c=this,u=c.d,d=lQ(r).filter(function(_){return _.$_req}),h=d3(d.map(function(_){return _.$_subs})),p=qr(h,function(_){return _.d===u});if(c.b&&!Gr(i)&&!s&&!c.s(i.props,a)&&!p){var m=h.reduce(function(_,w){var E=w.d;return _[0]?_[0].d===E&&_.push(w):E>u&&_.push(w),_},[]);return m.forEach(function(_){rg(_,_._ps,[_.o],t,r,!0)}),!1}c.o=i,c.ss(a);var b=c.ps;return Gr(i)||(c.ps=i.props,c.ref=i.ref),NE(this),c.r(t,r,c.b?b:{},a),!0},e.md=function(){this.rr()},e.ss=function(){},e.ud=function(){this.rr()},e.rr=function(){var t=this,r=t.ref,i=t.fr;r&&r(i?i.current:t.b)},n})();function p3(){return Object.__CROACT_CURRENT_INSTNACE__}function xQ(){return DE}function _Q(n){DE=n}function NE(n){return Object.__CROACT_CURRENT_INSTNACE__=n,DE=0,n}var ME=(function(){function n(t,r){t===void 0&&(t={}),this.props=t,this.context=r,this.state={},this.$_timer=0,this.$_state={},this.$_subs=[],this.$_cs={}}var e=n.prototype;return e.render=function(){return null},e.shouldComponentUpdate=function(t,r){return this.props!==t||this.state!==r},e.setState=function(t,r,i){var a=this;a.$_timer||(a.$_state={}),clearTimeout(a.$_timer),a.$_timer=0,a.$_state=Va(Va({},a.$_state),t),i?a.$_setState(r,i):a.$_timer=window.setTimeout(function(){a.$_timer=0,a.$_setState(r,i)})},e.forceUpdate=function(t){this.setState({},t,!0)},e.componentDidMount=function(){},e.componentDidUpdate=function(t,r){},e.componentWillUnmount=function(){},e.$_setState=function(t,r){var i=[],a=this.$_p,s=rg(a.c,[a],[a.o],i,a._cs,Va(Va({},this.state),this.$_state),r);s&&(t&&i.push(t),h3(i),NE(null))},n})(),g3=(function(n){ng(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}var t=e.prototype;return t.shouldComponentUpdate=function(r,i){return bv(this.props,r)||bv(this.state,i)},e})(ME);function m3(n){var e=function(t){e.current=t};return e.current=n,e}function wQ(n){return n._fr=!0,n}function SQ(n,e,t,r){var i,a;return!((i=n?.prototype)===null||i===void 0)&&i.render?a=new n(e,t):(a=new ME(e,t),a.constructor=n,n._fr?(r.fr=m3(),a.render=function(){return this.constructor(this.props,r.fr)}):a.render=bQ),a.$_p=r,a}var EQ=(function(n){ng(e,n);function e(r,i,a,s,c,u,d){d===void 0&&(d={});var h=n.call(this,r,i,a,s,c,u,b1(d,r.defaultProps))||this;return h.typ="comp",h._usefs=[],h._uefs=[],h._defs=[],h}var t=e.prototype;return t.s=function(r,i){var a=this.b;return a.shouldComponentUpdate(b1(r,this.t.defaultProps),i||a.state)!==!1},t.r=function(r,i,a){var s,c,u=this,d=u.t;u.ps=b1(u.ps,u.t.defaultProps);var h=u.ps,p=!u.b,m=d.contextType,b=u.b,_=m?.get(u);u._cs=i,p?(b=SQ(d,h,_,u),u.b=b):(b.props=h,b.context=_);var w=b.state;u._usefs=[],u._uefs=[];var E=b.render();((c=(s=E?.props)===null||s===void 0?void 0:s.children)===null||c===void 0?void 0:c.length)===0&&(E.props.children=u.ps.children);var T=Va(Va({},i),b.$_cs);rg(u,u._ps,E?[E]:[],r,T),p?u._uefs.push(function(){m?.register(u),b.componentDidMount()}):u._uefs.push(function(){b.componentDidUpdate(a,w)}),r.push(function(){u._usefs.forEach(function(C){C()}),p?u.md():u.ud(),u._defs=u._uefs.map(function(C){return C()})})},t.ss=function(r){var i=this.b;!i||!r||(i.state=r)},t.un=function(){var r,i=this;i._ps.forEach(function(s){s.un()});var a=i.t;(r=a.contextType)===null||r===void 0||r.unregister(i),clearTimeout(i.b.$_timer),i._defs.forEach(function(s){s&&s()}),i.b.componentWillUnmount()},e})(by);function TQ(n,e,t){var r=PE(RD(n),RD(e)),i=r.added,a=r.removed,s=r.changed;for(var c in i)t.setAttribute(c,i[c]);for(var u in s)t.setAttribute(u,s[u][1]);for(var d in a)t.removeAttribute(d)}function AQ(n,e,t){var r=PE(n,e),i=r.added,a=r.removed;for(var s in a)t.e(s,!0);for(var c in i)t.e(c)}function PE(n,e){var t=Bs(n),r=Bs(e),i=tg(t,r,function(u){return u}),a={},s={},c={};return i.added.forEach(function(u){var d=r[u];a[d]=e[d]}),i.removed.forEach(function(u){var d=t[u];s[d]=n[d]}),i.maintained.forEach(function(u){var d=u[0],h=t[d],p=[n[h],e[h]];n[h]!==e[h]&&(c[h]=p)}),{added:a,removed:s,changed:c}}function CQ(n,e,t){var r=t.style,i=PE(n,e),a=i.added,s=i.removed,c=i.changed;for(var u in a){var d=k0(u,"-");r.setProperty(d,a[u])}for(var u in c){var h=k0(u,"-");r.setProperty(h,c[u][1])}for(var u in s){var p=k0(u,"-");r.removeProperty(p)}}function IQ(n){return n.replace(/^on/g,"").toLowerCase()}var RQ=(function(n){ng(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r.typ="elem",r._es={},r._svg=!1,r}var t=e.prototype;return t.e=function(r,i){var a=this,s=a._es,c=a.b,u=IQ(r);i?($n(c,u,s[r]),delete s[r]):(s[r]=function(d){var h,p;(p=(h=a.ps)[r])===null||p===void 0||p.call(h,d)},or(c,u,s[r]))},t.s=function(r){return bv(this.ps,r)},t.r=function(r,i,a){var s,c=this,u=!c.b,d=c.ps;if(u){var h=yy(c.c),p=!1;c._svg||c.t==="svg"?p=!0:p=h&&h.ownerSVGElement,c._svg=p;var m=(s=c._hyd)===null||s===void 0?void 0:s.splice(0,1)[0],b=c.t;if(m)c._hyd=[].slice.call(m.children||[]);else{var _=Kd(h);p?m=_.createElementNS("http://www.w3.org/2000/svg",b):m=_.createElement(b)}c.b=m}rg(c,c._ps,d.children,r,i);var w=c.b,E=kD(a),T=E[0],C=E[1],k=kD(d),j=k[0],P=k[1];return TQ(T,j,w),AQ(C,P,c),CQ(a.style||{},d.style||{},w),r.push(function(){u?c.md():c.ud()}),!0},t.un=function(){var r=this,i=r._es,a=r.b;for(var s in i)$n(a,s,i[s]);r._ps.forEach(function(c){c.un()}),r._es={},r._sel||f3(a)},e})(by);function bp(n){if(!n||Xd(n))return n;var e=n.$_p._ps;return e.length?bp(e[0].b):null}function v3(n){if(n){if(n.b&&Xd(n.b))return n;var e=n._ps;return e.length?v3(e[0]):null}}function ra(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=e||{},a=i.key,s=i.ref,c=u3(i,["key","ref"]);return{type:n,key:a,ref:s,props:Va(Va({},c),{children:a3(t).filter(function(u){return u!=null&&u!==!1})})}}var y3=(function(n){ng(e,n);function e(r,i){i===void 0&&(i=0);var a=n.call(this,"container",i,"container",0,null)||this;return a.typ="container",a.b=r,a}var t=e.prototype;return t.r=function(){return!0},t.un=function(){},e})(by),kQ=(function(n){ng(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r.typ="text",r}var t=e.prototype;return t.r=function(r){var i,a=this,s=!a.b;if(s){var c=yy(a.c),u=(i=a._hyd)===null||i===void 0?void 0:i.splice(0,1)[0];a.b=u||Kd(c).createTextNode(a.t.replace("text_",""))}return r.push(function(){s?a.md():a.ud()}),!0},t.un=function(){f3(this.b)},e})(by);function DQ(n,e,t){var r=t.map(function(u){return Gr(u)?null:u.key}),i=ID(e.map(function(u){return u.k})),a=ID(r),s=tg(i,a,function(u){return u});s.removed.forEach(function(u){e.splice(u,1)[0].un()}),s.ordered.forEach(function(u){var d=u[0],h=u[1],p=e.splice(d,1)[0];e.splice(h,0,p);var m=bp(p.b),b=bp(e[h+1]&&e[h+1].b);m&&m.parentNode.insertBefore(m,b)}),s.added.forEach(function(u){e.splice(u,0,DD(t[u],r[u],u,n))});var c=s.maintained.filter(function(u){u[0];var d=u[1],h=t[d],p=e[d],m=Gr(h)?"text_".concat(h):h.type;return m!==p.t?(p.un(),e.splice(d,1,DD(h,r[d],d,n)),!0):(p.i=d,!1)});return CD(CD([],s.added,!0),c.map(function(u){u[0];var d=u[1];return d}))}function NQ(n,e){for(var t=n._ps,r=t.length,i=e.i+1;i<r;++i){var a=bp(t[i].b);if(a)return a}return null}function DD(n,e,t,r){var i=r.d+1;if(Gr(n)||Td(n))return new kQ("text_".concat(n),i,e,t,r,null,{});var a=n.type,s=typeof a=="string"?RQ:EQ;return new s(a,i,e,t,r,n.ref,n.props)}function rg(n,e,t,r,i,a,s){var c=DQ(n,e,t),u=n._hyd,d=e.filter(function(p,m){return p._hyd=u,p.u(r,i,t[m],a,s)});n.typ==="container"&&n._sel&&e.forEach(function(p){var m=v3(p);m&&(m._sel=!0)}),n._hyd=null;var h=yy(n);return h&&c.reverse().forEach(function(p){var m=e[p],b=bp(m.b);if(b&&h!==b&&!b.parentNode){var _=NQ(n,m);h.insertBefore(b,_)}}),d.length>0}function MQ(n,e,t,r){t===void 0&&(t=e.__CROACT__),r===void 0&&(r={});var i=!!t;t||(t=new y3(e));var a=[];return rg(t,t._ps,n?[n]:[],a,r,void 0,void 0),h3(a),NE(null),i||(e.__CROACT__=t),t}function ND(n,e,t){return!t&&n&&(t=new y3(e.parentElement),t._hyd=[e],t._sel=!0),MQ(n,e,t),t}function b3(n){var e=p3(),t=e._hs||(e._hs=[]),r=xQ(),i=t[r];if(_Q(r+1),i){if(!bv(i.deps,n.deps))return i.updated=!1,i;t[r]=n}else t.push(n);return n.value=n.func(),n.updated=!0,n}function PQ(n,e){var t=b3({func:n,deps:e});return t.value}function OQ(n){return PQ(function(){return m3(n)},[])}function x3(n,e,t){var r=p3(),i=b3({func:function(){return n},deps:e}),a=t?r._usefs:r._uefs;i.updated?a.push(function(){return i.effect&&i.effect(),i.effect=n(),i.effect}):a.push(function(){return i.effect})}function jQ(n,e,t){x3(function(){n?.(e())},t,!0)}function OE(n,e){for(var t=n.length,r=0;r<t;++r)if(e(n[r],r))return!0;return!1}function _3(n,e){for(var t=n.length,r=0;r<t;++r)if(e(n[r],r))return n[r];return null}function w3(n){var e=n;if(typeof e>"u"){if(typeof navigator>"u"||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function jE(n,e){try{return new RegExp(n,"g").exec(e)}catch{return null}}function VQ(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var n=navigator.userAgentData,e=n.brands||n.uaList;return!!(e&&e.length)}function zQ(n,e){var t=jE("("+n+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return t?t[3]:""}function Z_(n){return n.replace(/_/g,".")}function yh(n,e){var t=null,r="-1";return OE(n,function(i){var a=jE("("+i.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!a||i.brand?!1:(t=i,r=a[3]||"-1",i.versionAlias?r=i.versionAlias:i.versionTest&&(r=zQ(i.versionTest.toLowerCase(),e)||r),r=Z_(r),!0)}),{preset:t,version:r}}function Xm(n,e){var t={brand:"",version:"-1"};return OE(n,function(r){var i=S3(e,r);return i?(t.brand=r.id,t.version=r.versionAlias||i.version,t.version!=="-1"):!1}),t}function S3(n,e){return _3(n,function(t){var r=t.brand;return jE(""+e.test,r.toLowerCase())})}var E3=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],T3=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],J_=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],A3=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],C3=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function I3(n){return!!yh(A3,n).preset}function LQ(n){var e=w3(n),t=!!/mobi/g.exec(e),r={name:"unknown",version:"-1",majorVersion:-1,webview:I3(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},a=yh(E3,e),s=a.preset,c=a.version,u=yh(C3,e),d=u.preset,h=u.version,p=yh(T3,e);if(r.chromium=!!p.preset,r.chromiumVersion=p.version,!r.chromium){var m=yh(J_,e);r.webkit=!!m.preset,r.webkitVersion=m.version}return d&&(i.name=d.id,i.version=h,i.majorVersion=parseInt(h,10)),s&&(r.name=s.id,r.version=c,r.webview&&i.name==="ios"&&r.name!=="safari"&&(r.webview=!1)),r.majorVersion=parseInt(r.version,10),{browser:r,os:i,isMobile:t,isHints:!1}}function BQ(n){var e=navigator.userAgentData,t=(e.uaList||e.brands).slice(),r=e.mobile||!1,i=t[0],a=(e.platform||navigator.platform).toLowerCase(),s={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!Xm(A3,t).brand||I3(w3())},c={name:"unknown",version:"-1",majorVersion:-1};s.webkit=!s.chromium&&OE(J_,function(m){return S3(t,m)});var u=Xm(T3,t);if(s.chromium=!!u.brand,s.chromiumVersion=u.version||"-1",!s.chromium){var d=Xm(J_,t);s.webkit=!!d.brand,s.webkitVersion=d.version||"-1"}var h=_3(C3,function(m){return new RegExp(""+m.test,"g").exec(a)});c.name=h?h.id:"";{var p=Xm(E3,t);s.name=p.brand||s.name,s.version=p.brand&&n?n.uaFullVersion:p.version}return s.webkit&&(c.name=r?"ios":"mac"),c.name==="ios"&&s.webview&&(s.version="-1"),c.version=Z_(c.version),s.version=Z_(s.version),c.majorVersion=parseInt(c.version,10),s.majorVersion=parseInt(s.version,10),{browser:s,os:c,isMobile:r,isHints:!0}}function UQ(n){return VQ()?BQ():LQ(n)}function FQ(n,e,t,r,i,a){for(var s=0;s<i;++s){var c=t+s*i,u=r+s*i;n[c]+=n[u]*a,e[c]+=e[u]*a}}function GQ(n,e,t,r,i){for(var a=0;a<i;++a){var s=t+a*i,c=r+a*i,u=n[s],d=e[s];n[s]=n[c],n[c]=u,e[s]=e[c],e[c]=d}}function qQ(n,e,t,r,i){for(var a=0;a<r;++a){var s=t+a*r;n[s]/=i,e[s]/=i}}function R3(n,e,t){for(var r=n.slice(),i=0;i<t;++i)r[i*t+e-1]=0,r[(e-1)*t+i]=0;return r[(e-1)*(t+1)]=1,r}function Xa(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=n.slice(),r=en(e),i=0;i<e;++i){var a=e*i+i;if(!st(t[a],Un)){for(var s=i+1;s<e;++s)if(t[e*i+s]){GQ(t,r,i,s,e);break}}if(!st(t[a],Un))return[];qQ(t,r,i,e,t[a]);for(var s=0;s<e;++s){var c=s,u=s+i*e,d=t[u];!st(d,Un)||i===s||FQ(t,r,c,i,e,-d)}}return r}function $Q(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=[],r=0;r<e;++r)for(var i=0;i<e;++i)t[i*e+r]=n[e*r+i];return t}function k3(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=[],r=n[e*e-1],i=0;i<e-1;++i)t[i]=n[e*(e-1)+i]/r;return t[e-1]=0,t}function HQ(n,e){for(var t=en(e),r=0;r<e-1;++r)t[e*(e-1)+r]=n[r]||0;return t}function kc(n,e){for(var t=n.slice(),r=n.length;r<e-1;++r)t[r]=0;return t[e-1]=1,t}function ca(n,e,t){if(e===void 0&&(e=Math.sqrt(n.length)),e===t)return n;for(var r=en(t),i=Math.min(e,t),a=0;a<i-1;++a){for(var s=0;s<i-1;++s)r[a*t+s]=n[a*e+s];r[(a+1)*t-1]=n[(a+1)*e-1],r[(t-1)*t+a]=n[(e-1)*e+a]}return r[t*t-1]=n[e*e-1],r}function xv(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var r=en(n);return e.forEach(function(i){r=Yt(r,i,n)}),r}function Yt(n,e,t){t===void 0&&(t=Math.sqrt(n.length));var r=[],i=n.length/t,a=e.length/i;if(i){if(!a)return n}else return e;for(var s=0;s<t;++s)for(var c=0;c<a;++c){r[c*t+s]=0;for(var u=0;u<i;++u)r[c*t+s]+=n[u*t+s]*e[c*i+u]}return r}function It(n,e){for(var t=Math.min(n.length,e.length),r=n.slice(),i=0;i<t;++i)r[i]=r[i]+e[i];return r}function We(n,e){for(var t=Math.min(n.length,e.length),r=n.slice(),i=0;i<t;++i)r[i]=r[i]-e[i];return r}function YQ(n,e){return e===void 0&&(e=n.length===6),e?[n[0],n[1],0,n[2],n[3],0,n[4],n[5],1]:n}function D3(n,e){return e===void 0&&(e=n.length===9),e?[n[0],n[1],n[3],n[4],n[6],n[7]]:n}function br(n,e,t){t===void 0&&(t=e.length);var r=Yt(n,e,t),i=r[t-1];return r.map(function(a){return a/i})}function KQ(n,e){return Yt(n,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function XQ(n,e){return Yt(n,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function WQ(n,e){return Yt(n,ag(e,4))}function Wm(n,e){var t=e[0],r=t===void 0?1:t,i=e[1],a=i===void 0?1:i,s=e[2],c=s===void 0?1:s;return Yt(n,[r,0,0,0,0,a,0,0,0,0,c,0,0,0,0,1],4)}function ig(n,e){return br(ag(e,3),kc(n,3))}function x1(n,e){var t=e[0],r=t===void 0?0:t,i=e[1],a=i===void 0?0:i,s=e[2],c=s===void 0?0:s;return Yt(n,[1,0,0,0,0,1,0,0,0,0,1,0,r,a,c,1],4)}function MD(n,e){return Yt(n,e,4)}function ag(n,e){var t=Math.cos(n),r=Math.sin(n),i=en(e);return i[0]=t,i[1]=r,i[e]=-r,i[e+1]=t,i}function en(n){for(var e=n*n,t=[],r=0;r<e;++r)t[r]=r%(n+1)?0:1;return t}function VE(n,e){for(var t=en(e),r=Math.min(n.length,e-1),i=0;i<r;++i)t[(e+1)*i]=n[i];return t}function Dc(n,e){for(var t=en(e),r=Math.min(n.length,e-1),i=0;i<r;++i)t[e*(e-1)+i]=n[i];return t}function zE(n,e,t,r,i,a,s,c){var u=n[0],d=n[1],h=e[0],p=e[1],m=t[0],b=t[1],_=r[0],w=r[1],E=i[0],T=i[1],C=a[0],k=a[1],j=s[0],P=s[1],N=c[0],A=c[1],I=[u,0,h,0,m,0,_,0,d,0,p,0,b,0,w,0,1,0,1,0,1,0,1,0,0,u,0,h,0,m,0,_,0,d,0,p,0,b,0,w,0,1,0,1,0,1,0,1,-E*u,-T*u,-C*h,-k*h,-j*m,-P*m,-N*_,-A*_,-E*d,-T*d,-C*p,-k*p,-j*b,-P*b,-N*w,-A*w],D=Xa(I,8);if(!D.length)return[];var z=Yt(D,[E,T,C,k,j,P,N,A],8);return z[8]=1,ca($Q(z),3,4)}var zh=function(){return zh=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},zh.apply(this,arguments)};function QQ(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function xp(n,e){return e===void 0&&(e=0),Lu(Ad(n,e))}function ZQ(n,e){var t=br(n,[e[0],e[1]||0,e[2]||0,1],4),r=t[3]||1;return[t[0]/r,t[1]/r,t[2]/r]}function Lu(n){var e=QQ();return n.forEach(function(t){var r=t.matrixFunction,i=t.functionValue;r&&(e=r(e,i))}),e}function Ad(n,e){e===void 0&&(e=0);var t=Gn(n)?n:ol(n);return t.map(function(r){var i=n3(r),a=i.prefix,s=i.value,c=null,u=a,d="";if(a==="translate"||a==="translateX"||a==="translate3d"){var h=la(e)?zh(zh({},e),{"o%":e["%"]}):{"%":e,"o%":e},p=uc(s).map(function(O,X){return X===0&&"x%"in h?h["%"]=e["x%"]:X===1&&"y%"in h?h["%"]=e["y%"]:h["%"]=e["o%"],Ht(O,h)}),m=p[0],b=p[1],_=b===void 0?0:b,w=p[2],E=w===void 0?0:w;c=x1,d=[m,_,E]}else if(a==="translateY"){var T=la(e)?zh({"%":e["y%"]},e):{"%":e},_=Ht(s,T);c=x1,d=[0,_,0]}else if(a==="translateZ"){var E=parseFloat(s);c=x1,d=[0,0,E]}else if(a==="scale"||a==="scale3d"){var C=uc(s).map(function(O){return parseFloat(O)}),k=C[0],j=C[1],P=j===void 0?k:j,N=C[2],A=N===void 0?1:N;c=Wm,d=[k,P,A]}else if(a==="scaleX"){var k=parseFloat(s);c=Wm,d=[k,1,1]}else if(a==="scaleY"){var P=parseFloat(s);c=Wm,d=[1,P,1]}else if(a==="scaleZ"){var A=parseFloat(s);c=Wm,d=[1,1,A]}else if(a==="rotate"||a==="rotateZ"||a==="rotateX"||a==="rotateY"){var I=eg(s),D=I.unit,z=I.value,V=D==="rad"?z:z*Math.PI/180;a==="rotate"||a==="rotateZ"?(u="rotateZ",c=WQ):a==="rotateX"?c=KQ:a==="rotateY"&&(c=XQ),d=V}else if(a==="matrix3d")c=MD,d=uc(s).map(function(O){return parseFloat(O)});else if(a==="matrix"){var B=uc(s).map(function(O){return parseFloat(O)});c=MD,d=[B[0],B[1],0,0,B[2],B[3],0,0,0,0,1,0,B[4],B[5],0,1]}else u="";return{name:a,functionName:u,value:s,matrixFunction:c,functionValue:d}})}var ew=function(n,e){return ew=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},ew(n,e)};function JQ(n,e){ew(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var N3=typeof Map=="function"?void 0:(function(){var n=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++n)}})(),M3=(function(n){JQ(e,n);function e(t){return t===void 0&&(t=[]),n.call(this,t,N3)||this}return e})(yQ);function eZ(n,e){return tg(n,e,N3)}var tw=function(){return tw=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},tw.apply(this,arguments)};function tZ(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],s=0,c=a.length;s<c;s++,i++)r[i]=a[s];return r}var xy=(function(){function n(){this._events={}}var e=n.prototype;return e.on=function(t,r){if(la(t))for(var i in t)this.on(i,t[i]);else this._addEvent(t,r,{});return this},e.off=function(t,r){if(!t)this._events={};else if(la(t))for(var i in t)this.off(i);else if(!r)this._events[t]=[];else{var a=this._events[t];if(a){var s=Ls(a,function(c){return c.listener===r});s>-1&&a.splice(s,1)}}return this},e.once=function(t,r){var i=this;return r&&this._addEvent(t,r,{once:!0}),new Promise(function(a){i._addEvent(t,a,{once:!0})})},e.emit=function(t,r){var i=this;r===void 0&&(r={});var a=this._events[t];if(!t||!a)return!0;var s=!1;return r.eventType=t,r.stop=function(){s=!0},r.currentTarget=this,tZ(a).forEach(function(c){c.listener(r),c.once&&i.off(t,c.listener)}),!s},e.trigger=function(t,r){return r===void 0&&(r={}),this.emit(t,r)},e._addEvent=function(t,r,i){var a=this._events;a[t]=a[t]||[];var s=a[t];s.push(tw({listener:r},i))},n})();var nw=function(n,e){return nw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},nw(n,e)};function nZ(n,e){nw(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Hu=function(){return Hu=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Hu.apply(this,arguments)};function rZ(n){var e=n.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function PD(n,e){return n.addEventListener("scroll",e),function(){n.removeEventListener("scroll",e)}}function Qm(n){if(n){if(Gr(n))return document.querySelector(n)}else return null;if(CE(n))return n();if(n instanceof Element)return n;if("current"in n)return n.current;if("value"in n)return n.value}var iZ=(function(n){nZ(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r._startRect=null,r._startPos=[],r._prevTime=0,r._timer=0,r._prevScrollPos=[0,0],r._isWait=!1,r._flag=!1,r._currentOptions=null,r._lock=!1,r._unregister=null,r._onScroll=function(){var i=r._currentOptions;r._lock||!i||r.emit("scrollDrag",{next:function(a){r.checkScroll({container:i.container,inputEvent:a})}})},r}var t=e.prototype;return t.dragStart=function(r,i){var a=Qm(i.container);if(!a){this._flag=!1;return}var s=0,c=0,u=0,d=0;if(a===document.body)u=window.innerWidth,d=window.innerHeight;else{var h=a.getBoundingClientRect();s=h.top,c=h.left,u=h.width,d=h.height}this._flag=!0,this._startPos=[r.clientX,r.clientY],this._startRect={top:s,left:c,width:u,height:d},this._prevScrollPos=this._getScrollPosition([0,0],i),this._currentOptions=i,this._registerScrollEvent(i)},t.drag=function(r,i){if(clearTimeout(this._timer),!!this._flag){var a=r.clientX,s=r.clientY,c=i.threshold,u=c===void 0?0:c,d=this,h=d._startRect,p=d._startPos;this._currentOptions=i;var m=[0,0];return h.top>s-u?(p[1]>h.top||s<p[1])&&(m[1]=-1):h.top+h.height<s+u&&(p[1]<h.top+h.height||s>p[1])&&(m[1]=1),h.left>a-u?(p[0]>h.left||a<p[0])&&(m[0]=-1):h.left+h.width<a+u&&(p[0]<h.left+h.width||a>p[0])&&(m[0]=1),!m[0]&&!m[1]?!1:this._continueDrag(Hu(Hu({},i),{direction:m,inputEvent:r,isDrag:!0}))}},t.checkScroll=function(r){var i=this;if(this._isWait)return!1;var a=r.prevScrollPos,s=a===void 0?this._prevScrollPos:a,c=r.direction,u=r.throttleTime,d=u===void 0?0:u,h=r.inputEvent,p=r.isDrag,m=this._getScrollPosition(c||[0,0],r),b=m[0]-s[0],_=m[1]-s[1],w=c||[b?Math.abs(b)/b:0,_?Math.abs(_)/_:0];return this._prevScrollPos=m,this._lock=!1,!b&&!_?!1:(this.emit("move",{offsetX:w[0]?b:0,offsetY:w[1]?_:0,inputEvent:h}),d&&p&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},d)),!0)},t.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},t._getScrollPosition=function(r,i){var a=i.container,s=i.getScrollPosition,c=s===void 0?rZ:s;return c({container:Qm(a),direction:r})},t._continueDrag=function(r){var i=this,a,s=r.container,c=r.direction,u=r.throttleTime,d=r.useScroll,h=r.isDrag,p=r.inputEvent;if(!(!this._flag||h&&this._isWait)){var m=yp(),b=Math.max(u+this._prevTime-m,0);if(b>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},b),!1;this._prevTime=m;var _=this._getScrollPosition(c,r);this._prevScrollPos=_,h&&(this._isWait=!0),d||(this._lock=!0);var w={container:Qm(s),direction:c,inputEvent:p};return(a=r.requestScroll)===null||a===void 0||a.call(r,w),this.emit("scroll",w),this._isWait=!1,d||this.checkScroll(Hu(Hu({},r),{prevScrollPos:_,direction:c,inputEvent:p}))}},t._registerScrollEvent=function(r){this._unregisterScrollEvent();var i=r.checkScrollEvent;if(i){var a=i===!0?PD:i,s=Qm(r.container);i===!0&&(s===document.body||s===document.documentElement)?this._unregister=PD(window,this._onScroll):this._unregister=a(s,this._onScroll)}},t._unregisterScrollEvent=function(){var r;(r=this._unregister)===null||r===void 0||r.call(this),this._unregister=null},e})(xy);function aZ(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],s=0,c=a.length;s<c;s++,i++)r[i]=a[s];return r}function zr(n){return st(n,Un)}function sZ(n,e){return n.every(function(t,r){return zr(t-e[r])===0})}function oZ(n,e){return!zr(n[0]-e[0])&&!zr(n[1]-e[1])}function P3(n){return n.length<3?0:Math.abs(cQ(n.map(function(e,t){var r=n[t+1]||n[0];return e[0]*r[1]-r[0]*e[1]})))/2}function OD(n,e){var t=e.width,r=e.height,i=e.left,a=e.top,s=Nc(n),c=s.minX,u=s.minY,d=s.maxX,h=s.maxY,p=t/(d-c),m=r/(h-u);return n.map(function(b){return[i+(b[0]-c)*p,a+(b[1]-u)*m]})}function Nc(n){var e=n.map(function(r){return r[0]}),t=n.map(function(r){return r[1]});return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,t),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,t)}}function rw(n,e,t){var r=n[0],i=n[1],a=Nc(e),s=a.minX,c=a.maxX,u=[[s,i],[c,i]],d=_v(u[0],u[1]),h=iw(e),p=[];if(h.forEach(function(_){var w=_v(_[0],_[1]),E=_[0];if(sZ(d,w))p.push({pos:n,line:_,type:"line"});else{var T=O3(LE(d,w),[u,_]);T.forEach(function(C){_.some(function(k){return oZ(k,C)})?p.push({pos:C,line:_,type:"point"}):zr(E[1]-i)!==0&&p.push({pos:C,line:_,type:"intersection"})})}}),qr(p,function(_){return _[0]===r}))return!0;var m=0,b={};return p.forEach(function(_){var w=_.pos,E=_.type,T=_.line;if(!(w[0]>r))if(E==="intersection")++m;else{if(E==="line")return;if(E==="point"){var C=qr(T,function(P){return P[1]!==i}),k=b[w[0]],j=C[1]>i?1:-1;k?k!==j&&++m:b[w[0]]=j}}}),m%2===1}function _v(n,e){var t=n[0],r=n[1],i=e[0],a=e[1],s=i-t,c=a-r;Math.abs(s)<Un&&(s=0),Math.abs(c)<Un&&(c=0);var u=0,d=0,h=0;return s?c?(u=-c/s,d=1,h=-u*t-r):(d=1,h=-r):c&&(u=-1,h=t),[u,d,h]}function LE(n,e){var t=n[0],r=n[1],i=n[2],a=e[0],s=e[1],c=e[2],u=t===0&&a===0,d=r===0&&s===0,h=[];if(u&&d)return[];if(u){var p=-i/r,m=-c/s;return p!==m?[]:[[-1/0,p],[1/0,p]]}else if(d){var b=-i/t,_=-c/a;return b!==_?[]:[[b,-1/0],[b,1/0]]}else if(t===0){var w=-i/r,E=-(s*w+c)/a;h=[[E,w]]}else if(a===0){var w=-c/s,E=-(r*w+i)/t;h=[[E,w]]}else if(r===0){var E=-i/t,w=-(a*E+c)/s;h=[[E,w]]}else if(s===0){var E=-c/a,w=-(t*E+i)/r;h=[[E,w]]}else{var E=(r*c-s*i)/(s*t-r*a),w=-(t*E+i)/r;h=[[E,w]]}return h.map(function(T){return[T[0],T[1]]})}function O3(n,e){var t=e.map(function(p){return[0,1].map(function(m){return[Math.min(p[0][m],p[1][m]),Math.max(p[0][m],p[1][m])]})}),r=[];if(n.length===2){var i=n[0],a=i[0],s=i[1];if(zr(a-n[1][0])){if(!zr(s-n[1][1])){var d=Math.max.apply(Math,t.map(function(p){return p[0][0]})),h=Math.min.apply(Math,t.map(function(p){return p[0][1]}));if(zr(d-h)>0)return[];r=[[d,s],[h,s]]}}else{var c=Math.max.apply(Math,t.map(function(p){return p[1][0]})),u=Math.min.apply(Math,t.map(function(p){return p[1][1]}));if(zr(c-u)>0)return[];r=[[a,c],[a,u]]}}return r.length||(r=n.filter(function(p){var m=p[0],b=p[1];return t.every(function(_){return 0<=zr(m-_[0][0])&&0<=zr(_[0][1]-m)&&0<=zr(b-_[1][0])&&0<=zr(_[1][1]-b)})})),r.map(function(p){return[zr(p[0]),zr(p[1])]})}function iw(n){return aZ(n.slice(1),[n[0]]).map(function(e,t){return[n[t],e]})}function lZ(n,e){var t=n.slice(),r=e.slice();TD(t)===-1&&t.reverse(),TD(r)===-1&&r.reverse();var i=iw(t),a=iw(r),s=i.map(function(h){return _v(h[0],h[1])}),c=a.map(function(h){return _v(h[0],h[1])}),u=[];s.forEach(function(h,p){var m=i[p],b=[];c.forEach(function(_,w){var E=LE(h,_),T=O3(E,[m,a[w]]);b.push.apply(b,T.map(function(C){return{index1:p,index2:w,pos:C,type:"intersection"}}))}),b.sort(function(_,w){return ks(m[0],_.pos)-ks(m[0],w.pos)}),u.push.apply(u,b),rw(m[1],r)&&u.push({index1:p,index2:-1,pos:m[1],type:"inside"})}),a.forEach(function(h,p){if(rw(h[1],t)){var m=!1,b=Ls(u,function(_){var w=_.index2;return w===p?(m=!0,!1):!!m});b===-1&&(m=!1,b=Ls(u,function(_){var w=_.index1,E=_.index2;return w===-1&&E+1===p?(m=!0,!1):!!m})),b===-1?u.push({index1:-1,index2:p,pos:h[1],type:"inside"}):u.splice(b,0,{index1:-1,index2:p,pos:h[1],type:"inside"})}});var d={};return u.filter(function(h){var p=h.pos,m=p[0]+"x"+p[1];return d[m]?!1:(d[m]=!0,!0)})}function cZ(n,e){var t=lZ(n,e);return t.map(function(r){var i=r.pos;return i})}function uZ(n,e){var t=cZ(n,e);return P3(t)}var aw=function(n,e){return aw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},aw(n,e)};function dZ(n,e){aw(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var zn=function(){return zn=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},zn.apply(this,arguments)};function fZ(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=Math.atan2(r,t);return i>=0?i:i+Math.PI*2}function _1(n){return fZ([n[0].clientX,n[0].clientY],[n[1].clientX,n[1].clientY])/Math.PI*180}function hZ(n){return n.touches&&n.touches.length>=2}function Zm(n){return n?n.touches?gZ(n.touches):[j3(n)]:[]}function pZ(n){return n&&(n.type.indexOf("mouse")>-1||"button"in n)}function jD(n,e,t){var r=t.length,i=Lh(n,r),a=i.clientX,s=i.clientY,c=i.originalClientX,u=i.originalClientY,d=Lh(e,r),h=d.clientX,p=d.clientY,m=Lh(t,r),b=m.clientX,_=m.clientY,w=a-h,E=s-p,T=a-b,C=s-_;return{clientX:c,clientY:u,deltaX:w,deltaY:E,distX:T,distY:C}}function w1(n){return Math.sqrt(Math.pow(n[0].clientX-n[1].clientX,2)+Math.pow(n[0].clientY-n[1].clientY,2))}function gZ(n){for(var e=Math.min(n.length,2),t=[],r=0;r<e;++r)t.push(j3(n[r]));return t}function j3(n){return{clientX:n.clientX,clientY:n.clientY}}function Lh(n,e){e===void 0&&(e=n.length);for(var t={clientX:0,clientY:0,originalClientX:0,originalClientY:0},r=Math.min(n.length,e),i=0;i<r;++i){var a=n[i];t.originalClientX+="originalClientX"in a?a.originalClientX:a.clientX,t.originalClientY+="originalClientY"in a?a.originalClientY:a.clientY,t.clientX+=a.clientX,t.clientY+=a.clientY}return e?{clientX:t.clientX/e,clientY:t.clientY/e,originalClientX:t.originalClientX/e,originalClientY:t.originalClientY/e}:t}var S1=(function(){function n(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return n.prototype.getAngle=function(e){return e===void 0&&(e=this.prevClients),_1(e)},n.prototype.getRotation=function(e){return e===void 0&&(e=this.prevClients),_1(e)-_1(this.startClients)},n.prototype.getPosition=function(e,t){e===void 0&&(e=this.prevClients);var r=jD(e||this.prevClients,this.prevClients,this.startClients),i=r.deltaX,a=r.deltaY;return this.movement+=Math.sqrt(i*i+a*a),this.prevClients=e,r},n.prototype.getPositions=function(e){e===void 0&&(e=this.prevClients);for(var t=this.prevClients,r=this.startClients,i=Math.min(this.length,t.length),a=[],s=0;s<i;++s)a[s]=jD([e[s]],[t[s]],[r[s]]);return a},n.prototype.getMovement=function(e){var t=this.movement;if(!e)return t;var r=Lh(e,this.length),i=Lh(this.prevClients,this.length),a=r.clientX-i.clientX,s=r.clientY-i.clientY;return Math.sqrt(a*a+s*s)+t},n.prototype.getDistance=function(e){return e===void 0&&(e=this.prevClients),w1(e)},n.prototype.getScale=function(e){return e===void 0&&(e=this.prevClients),w1(e)/w1(this.startClients)},n.prototype.move=function(e,t){this.startClients.forEach(function(r){r.clientX-=e,r.clientY-=t}),this.prevClients.forEach(function(r){r.clientX-=e,r.clientY-=t})},n})(),VD=["textarea","input"],mZ=(function(n){dZ(e,n);function e(t,r){r===void 0&&(r={});var i=n.call(this)||this;i.options={},i.flag=!1,i.pinchFlag=!1,i.data={},i.isDrag=!1,i.isPinch=!1,i.clientStores=[],i.targets=[],i.prevTime=0,i.doubleFlag=!1,i._useMouse=!1,i._useTouch=!1,i._useDrag=!1,i._dragFlag=!1,i._isTrusted=!1,i._isMouseEvent=!1,i._isSecondaryButton=!1,i._preventMouseEvent=!1,i._prevInputEvent=null,i._isDragAPI=!1,i._isIdle=!0,i._preventMouseEventId=0,i._window=window,i.onDragStart=function(m,b){if(b===void 0&&(b=!0),!(!i.flag&&m.cancelable===!1)){var _=m.type.indexOf("drag")>=-1;if(!(i.flag&&_)){i._isDragAPI=!0;var w=i.options,E=w.container,T=w.pinchOutside,C=w.preventWheelClick,k=w.preventRightClick,j=w.preventDefault,P=w.checkInput,N=w.dragFocusedInput,A=w.preventClickEventOnDragStart,I=w.preventClickEventOnDrag,D=w.preventClickEventByCondition,z=i._useTouch,V=!i.flag;if(i._isSecondaryButton=m.which===3||m.button===2,C&&(m.which===2||m.button===1)||k&&(m.which===3||m.button===2))return i.stop(),!1;if(V){var B=i._window.document.activeElement,O=m.target;if(O){var X=O.tagName.toLowerCase(),K=VD.indexOf(X)>-1,$=O.isContentEditable;if(K||$){if(P||!N&&B===O)return!1;if(B&&(B===O||$&&B.isContentEditable&&B.contains(O)))if(N)O.blur();else return!1}else if((j||m.type==="touchstart")&&B){var W=B.tagName.toLowerCase();(B.isContentEditable||VD.indexOf(W)>-1)&&B.blur()}(A||I||D)&&or(i._window,"click",i._onClick,!0)}i.clientStores=[new S1(Zm(m))],i._isIdle=!1,i.flag=!0,i.isDrag=!1,i._isTrusted=b,i._dragFlag=!0,i._prevInputEvent=m,i.data={},i.doubleFlag=yp()-i.prevTime<200,i._isMouseEvent=pZ(m),!i._isMouseEvent&&i._preventMouseEvent&&i._allowMouseEvent();var ee=i._preventMouseEvent||i.emit("dragStart",zn(zn({data:i.data,datas:i.data,inputEvent:m,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,isTrusted:b,isDouble:i.doubleFlag},i.getCurrentStore().getPosition()),{preventDefault:function(){m.preventDefault()},preventDrag:function(){i._dragFlag=!1}}));ee===!1&&i.stop(),i._isMouseEvent&&i.flag&&j&&m.preventDefault()}if(!i.flag)return!1;var ie=0;if(V?(i._attchDragEvent(),z&&T&&(ie=setTimeout(function(){or(E,"touchstart",i.onDragStart,{passive:!1})}))):z&&T&&$n(E,"touchstart",i.onDragStart),i.flag&&hZ(m)){if(clearTimeout(ie),V&&m.touches.length!==m.changedTouches.length)return;i.pinchFlag||i.onPinchStart(m)}}}},i.onDrag=function(m,b){if(i.flag){var _=i.options.preventDefault;!i._isMouseEvent&&_&&m.preventDefault(),i._prevInputEvent=m;var w=Zm(m),E=i.moveClients(w,m,!1);if(i._dragFlag){if(i.pinchFlag||E.deltaX||E.deltaY){var T=i._preventMouseEvent||i.emit("drag",zn(zn({},E),{isScroll:!!b,inputEvent:m}));if(T===!1){i.stop();return}}i.pinchFlag&&i.onPinch(m,w)}i.getCurrentStore().getPosition(w,!0)}},i.onDragEnd=function(m){if(i.flag){var b=i.options,_=b.pinchOutside,w=b.container,E=b.preventClickEventOnDrag,T=b.preventClickEventOnDragStart,C=b.preventClickEventByCondition,k=i.isDrag;(E||T||C)&&requestAnimationFrame(function(){i._allowClickEvent()}),!C&&!T&&E&&!k&&i._allowClickEvent(),i._useTouch&&_&&$n(w,"touchstart",i.onDragStart),i.pinchFlag&&i.onPinchEnd(m);var j=m?.touches?Zm(m):[],P=j.length;P===0||!i.options.keepDragging?i.flag=!1:i._addStore(new S1(j));var N=i._getPosition(),A=yp(),I=!k&&i.doubleFlag;i._prevInputEvent=null,i.prevTime=k||I?0:A,i.flag||(i._dettachDragEvent(),i._preventMouseEvent||i.emit("dragEnd",zn({data:i.data,datas:i.data,isDouble:I,isDrag:k,isClick:!k,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,inputEvent:m,isTrusted:i._isTrusted},N)),i.clientStores=[],i._isMouseEvent||(i._preventMouseEvent=!0,clearTimeout(i._preventMouseEventId),i._preventMouseEventId=setTimeout(function(){i._preventMouseEvent=!1},200)),i._isIdle=!0)}},i.onBlur=function(){i.onDragEnd()},i._allowClickEvent=function(){$n(i._window,"click",i._onClick,!0)},i._onClick=function(m){i._allowClickEvent(),i._allowMouseEvent();var b=i.options.preventClickEventByCondition;b?.(m)||(m.stopPropagation(),m.preventDefault())},i._onContextMenu=function(m){var b=i.options;b.preventRightClick?i.onDragEnd(m):m.preventDefault()},i._passCallback=function(){};var a=[].concat(t),s=a[0];i._window=c3(s)?s:Qo(s),i.options=zn({checkInput:!1,container:s&&!("document"in s)?Qo(s):s,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},r);var c=i.options,u=c.container,d=c.events,h=c.checkWindowBlur;if(i._useDrag=d.indexOf("drag")>-1,i._useTouch=d.indexOf("touch")>-1,i._useMouse=d.indexOf("mouse")>-1,i.targets=a,i._useDrag&&a.forEach(function(m){or(m,"dragstart",i.onDragStart)}),i._useMouse&&(a.forEach(function(m){or(m,"mousedown",i.onDragStart),or(m,"mousemove",i._passCallback)}),or(u,"contextmenu",i._onContextMenu)),h&&or(Qo(),"blur",i.onBlur),i._useTouch){var p={passive:!1};a.forEach(function(m){or(m,"touchstart",i.onDragStart,p),or(m,"touchmove",i._passCallback,p)})}return i}return e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(t){return this.getCurrentStore().getMovement(t)+this.clientStores.slice(1).reduce(function(r,i){return r+i.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(t,r,i,a){a===void 0&&(a=!0),this.flag&&(this.clientStores[0].move(t,r),a&&this.onDrag(i,!0))},e.prototype.move=function(t,r){var i=t[0],a=t[1],s=this.getCurrentStore(),c=s.prevClients;return this.moveClients(c.map(function(u){var d=u.clientX,h=u.clientY;return{clientX:d+i,clientY:h+a,originalClientX:d,originalClientY:h}}),r,!0)},e.prototype.triggerDragStart=function(t){this.onDragStart(t,!1)},e.prototype.setEventData=function(t){var r=this.data;for(var i in t)r[i]=t[i];return this},e.prototype.setEventDatas=function(t){return this.setEventData(t)},e.prototype.getCurrentEvent=function(t){return t===void 0&&(t=this._prevInputEvent),zn(zn({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:t})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var t=this,r=this.targets,i=this.options.container;this.off(),$n(this._window,"blur",this.onBlur),this._useDrag&&r.forEach(function(a){$n(a,"dragstart",t.onDragStart)}),this._useMouse&&(r.forEach(function(a){$n(a,"mousedown",t.onDragStart)}),$n(i,"contextmenu",this._onContextMenu)),this._useTouch&&(r.forEach(function(a){$n(a,"touchstart",t.onDragStart)}),$n(i,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(t){var r=this,i=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>i)){var a=new S1(Zm(t));this.pinchFlag=!0,this._addStore(a);var s=this.emit("pinchStart",zn(zn({data:this.data,datas:this.data,angle:a.getAngle(),touches:this.getCurrentStore().getPositions()},a.getPosition()),{inputEvent:t,isTrusted:this._isTrusted,preventDefault:function(){t.preventDefault()},preventDrag:function(){r._dragFlag=!1}}));s===!1&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(t,r){if(!(!this.flag||!this.pinchFlag||r.length<2)){var i=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",zn(zn({data:this.data,datas:this.data,movement:this.getMovement(r),angle:i.getAngle(r),rotation:i.getRotation(r),touches:i.getPositions(r),scale:i.getScale(r),distance:i.getDistance(r)},i.getPosition(r)),{inputEvent:t,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(t){if(this.pinchFlag){var r=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var i=this.getCurrentStore();this.emit("pinchEnd",zn(zn({data:this.data,datas:this.data,isPinch:r,touches:i.getPositions()},i.getPosition()),{inputEvent:t}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(t,r,i){var a=this._getPosition(t,i),s=this.isDrag;(a.deltaX||a.deltaY)&&(this.isDrag=!0);var c=!1;return!s&&this.isDrag&&(c=!0),zn(zn({data:this.data,datas:this.data},a),{movement:this.getMovement(t),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:r,isTrusted:this._isTrusted,isFirstDrag:c})},e.prototype._addStore=function(t){this.clientStores.splice(0,0,t)},e.prototype._getPosition=function(t,r){var i=this.getCurrentStore(),a=i.getPosition(t,r),s=this.clientStores.slice(1).reduce(function(d,h){var p=h.getPosition();return d.distX+=p.distX,d.distY+=p.distY,d},a),c=s.distX,u=s.distY;return zn(zn({},a),{distX:c,distY:u})},e.prototype._attchDragEvent=function(){var t=this._window,r=this.options.container,i={passive:!1};this._isDragAPI&&(or(r,"dragover",this.onDrag,i),or(t,"dragend",this.onDragEnd)),this._useMouse&&(or(r,"mousemove",this.onDrag),or(t,"mouseup",this.onDragEnd)),this._useTouch&&(or(r,"touchmove",this.onDrag,i),or(t,"touchend",this.onDragEnd,i),or(t,"touchcancel",this.onDragEnd,i))},e.prototype._dettachDragEvent=function(){var t=this._window,r=this.options.container;this._isDragAPI&&($n(r,"dragover",this.onDrag),$n(t,"dragend",this.onDragEnd)),this._useMouse&&($n(r,"mousemove",this.onDrag),$n(t,"mouseup",this.onDragEnd)),this._useTouch&&($n(r,"touchstart",this.onDragStart),$n(r,"touchmove",this.onDrag),$n(t,"touchend",this.onDragEnd),$n(t,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e})(xy);function vZ(n){for(var e=5381,t=n.length;t;)e=e*33^n.charCodeAt(--t);return e>>>0}var yZ=vZ;function bZ(n){return yZ(n).toString(36)}function xZ(n){if(n&&n.getRootNode){var e=n.getRootNode();if(e.nodeType===11)return e}}function _Z(n,e,t){return t.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(r,i){var a=i.trim();return(a?uc(a):[""]).map(function(s){var c=s.trim();return c.indexOf("@")===0?c:c.indexOf(":global")>-1?c.replace(/\:global/g,""):c.indexOf(":host")>-1?"".concat(c.replace(/\:host/g,".".concat(n))):c?".".concat(n," ").concat(c):".".concat(n)}).join(", ")+" {"})}function wZ(n,e,t,r,i){var a=Kd(r),s=a.createElement("style");return s.setAttribute("type","text/css"),s.setAttribute("data-styled-id",n),s.setAttribute("data-styled-count","1"),t.nonce&&s.setAttribute("nonce",t.nonce),s.innerHTML=_Z(n,e,t),(i||a.head||a.body).appendChild(s),s}function SZ(n){var e="rCS"+bZ(n);return{className:e,inject:function(t,r){r===void 0&&(r={});var i=xZ(t),a=(i||t.ownerDocument||document).querySelector('style[data-styled-id="'.concat(e,'"]'));if(!a)a=wZ(e,n,r,t,i);else{var s=parseFloat(a.getAttribute("data-styled-count"))||0;a.setAttribute("data-styled-count","".concat(s+1))}return{destroy:function(){var c,u=parseFloat(a.getAttribute("data-styled-count"))||0;u<=1?(a.remove?a.remove():(c=a.parentNode)===null||c===void 0||c.removeChild(a),a=null):a.setAttribute("data-styled-count","".concat(u-1))}}}}}var sw=function(){return sw=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},sw.apply(this,arguments)};function EZ(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function V3(n,e){var t=SZ(e),r=t.className;return wQ(function(i,a){var s=i.className,c=s===void 0?"":s;i.cspNonce;var u=EZ(i,["className","cspNonce"]),d=OQ();return jQ(a,function(){return d.current},[]),x3(function(){var h=t.inject(d.current,{nonce:i.cspNonce});return function(){h.destroy()}},[]),ra(n,sw({ref:d,"data-styled-id":r,className:"".concat(c," ").concat(r)},u))})}var ow=function(n,e){return ow=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},ow(n,e)};function sg(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");ow(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var J=function(){return J=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},J.apply(this,arguments)};function TZ(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function AZ(n,e,t,r){var i=arguments.length,a=i<3?e:r,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(s=n[c])&&(a=(i<3?s(a):i>3?s(e,t,a):s(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function CZ(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function te(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,a=[],s;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(c){s={error:c}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(s)throw s.error}}return a}function Ie(n,e,t){if(arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function og(n,e){return J({events:[],props:[],name:n},e)}var IZ=["n","w","s","e"],BE=["n","w","s","e","nw","ne","sw","se"];function RZ(n,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*n,'px" height="').concat(32*n,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}function kZ(n){var e=RZ(1,n),t=Math.round(n/45)*45%180,r="ns-resize";return t===135?r="nwse-resize":t===45?r="nesw-resize":t===90&&(r="ew-resize"),"cursor:".concat(r,";cursor: url('").concat(e,"') 16 16, ").concat(r,";")}var Wd=UQ(),z3=Wd.browser.webkit,L3=z3&&(function(){var n=typeof window>"u"?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(n.userAgent.toLowerCase());return e?parseFloat(e[1])<605:!1})(),B3=Wd.browser.name,U3=parseInt(Wd.browser.version,10),DZ=B3==="chrome",NZ=Wd.browser.chromium,MZ=parseInt(Wd.browser.chromiumVersion,10)||0,PZ=DZ&&U3>=109||NZ&&MZ>=109,OZ=B3==="firefox",jZ=parseInt(Wd.browser.webkitVersion,10)>=612||U3>=15,UE="moveable-",VZ=BE.map(function(n){var e="",t="",r="center",i="center",a="calc(var(--moveable-control-padding, 20) * -1px)";return n.indexOf("n")>-1&&(e="top: ".concat(a,";"),i="bottom"),n.indexOf("s")>-1&&(e="top: 0px;",i="top"),n.indexOf("w")>-1&&(t="left: ".concat(a,";"),r="right"),n.indexOf("e")>-1&&(t="left: 0px;",r="left"),'.around-control[data-direction*="'.concat(n,`"] {
        `).concat(t).concat(e,`
        transform-origin: `).concat(r," ").concat(i,`;
    }`)}).join(`
`),zZ=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(VZ,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(n){return`
.direction[data-rotation="`.concat(n,'"], :global .view-control-rotation').concat(n,` {
`).concat(kZ(n),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(L3?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),LZ=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],lw=1e-4,kr=1e-7,Jm=1e-9,cw=Math.pow(10,10),zD=-cw,BZ={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},FE={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},F3={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},G3=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function lg(n,e,t,r,i,a){var s,c;a===void 0&&(a="draggable");var u=(c=(s=e.gestos[a])===null||s===void 0?void 0:s.move(t,n.inputEvent))!==null&&c!==void 0?c:{},d=u.originalDatas||u.datas,h=d[a]||(d[a]={});return J(J({},u),{isPinch:!!r,parentEvent:!0,datas:h,originalDatas:n.originalDatas})}var Cd=(function(){function n(e){var t;e===void 0&&(e="draggable"),this.ableName=e,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(t={},t[e]={},t)}return n.prototype.dragStart=function(e,t){this.isDrag=!1,this.isFlag=!1;var r=t.originalDatas;return this.datas=r,r[this.ableName]||(r[this.ableName]={}),J(J({},this.move(e,t.inputEvent)),{type:"dragstart"})},n.prototype.drag=function(e,t){return this.move([e[0]-this.prevX,e[1]-this.prevY],t)},n.prototype.move=function(e,t){var r,i,a=!1;if(!this.isFlag)this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],r=e[0],i=e[1],this.isFlag=!0;else{var s=this.isDrag;r=this.prevX+e[0],i=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!s&&this.isDrag&&(a=!0)}return this.prevX=r,this.prevY=i,{type:"drag",clientX:r,clientY:i,inputEvent:t,isFirstDrag:a,isDrag:this.isDrag,distX:r-this.startX,distY:i-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},n})();function id(n,e,t,r){var i=n.length===16,a=i?4:3,s=Lc(n,t,r,a),c=te(s,4),u=te(c[0],2),d=u[0],h=u[1],p=te(c[1],2),m=p[0],b=p[1],_=te(c[2],2),w=_[0],E=_[1],T=te(c[3],2),C=T[0],k=T[1],j=te(un(n,e,a),2),P=j[0],N=j[1],A=Math.min(d,m,w,C),I=Math.min(h,b,E,k),D=Math.max(d,m,w,C),z=Math.max(h,b,E,k);d=d-A||0,m=m-A||0,w=w-A||0,C=C-A||0,h=h-I||0,b=b-I||0,E=E-I||0,k=k-I||0,P=P-A||0,N=N-I||0;var V=n[0],B=n[a+1],O=Ar(V*B);return{left:A,top:I,right:D,bottom:z,origin:[P,N],pos1:[d,h],pos2:[m,b],pos3:[w,E],pos4:[C,k],direction:O}}function q3(n,e){var t=e.clientX,r=e.clientY,i=e.datas,a=n.state,s=a.moveableClientRect,c=a.rootMatrix,u=a.is3d,d=a.pos1,h=s.left,p=s.top,m=u?4:3,b=te(We(kd(c,[t-h,r-p],m),d),2),_=b[0],w=b[1],E=te(Ja({datas:i,distX:_,distY:w}),2),T=E[0],C=E[1];return[T,C]}function zc(n,e){var t=e.datas,r=n.state,i=r.allMatrix,a=r.beforeMatrix,s=r.is3d,c=r.left,u=r.top,d=r.origin,h=r.offsetMatrix,p=r.targetMatrix,m=r.transformOrigin,b=s?4:3;t.is3d=s,t.matrix=i,t.targetMatrix=p,t.beforeMatrix=a,t.offsetMatrix=h,t.transformOrigin=m,t.inverseMatrix=Xa(i,b),t.inverseBeforeMatrix=Xa(a,b),t.absoluteOrigin=kc(It([c,u],d),b),t.startDragBeforeDist=br(t.inverseBeforeMatrix,t.absoluteOrigin,b),t.startDragDist=br(t.inverseMatrix,t.absoluteOrigin,b)}function UZ(n){return id(n.datas.beforeTransform,[50,50],100,100).direction}function _y(n,e,t){var r=e.datas,i=e.originalDatas.beforeRenderable,a=r.transformIndex,s=i.nextTransforms,c=s.length,u=i.nextTransformAppendedIndexes,d=-1;a===-1?(t==="translate"?d=0:t==="rotate"&&(d=Ls(s,function(b){return b.match(/scale\(/g)})),d===-1&&(d=s.length),r.transformIndex=d):qr(u,function(b){return b.index===a&&b.functionName===t})?d=a:d=a+u.filter(function(b){return b.index<a}).length;var h=hee(s,n.state,d),p=h.targetFunction,m=t==="rotate"?"rotateZ":t;r.beforeFunctionTexts=h.beforeFunctionTexts,r.afterFunctionTexts=h.afterFunctionTexts,r.beforeTransform=h.beforeFunctionMatrix,r.beforeTransform2=h.beforeFunctionMatrix2,r.targetTansform=h.targetFunctionMatrix,r.afterTransform=h.afterFunctionMatrix,r.afterTransform2=h.afterFunctionMatrix2,r.targetAllTransform=h.allFunctionMatrix,p.functionName===m?(r.afterFunctionTexts.splice(0,1),r.isAppendTransform=!1):c>d&&(r.isAppendTransform=!0,i.nextTransformAppendedIndexes=Ie(Ie([],te(u),!1),[{functionName:t,index:d,isAppend:!0}],!1))}function wy(n,e,t){return"".concat(n.beforeFunctionTexts.join(" ")," ").concat(n.isAppendTransform?t:e," ").concat(n.afterFunctionTexts.join(" "))}function FZ(n){var e=n.datas,t=n.distX,r=n.distY,i=te(H3({datas:e,distX:t,distY:r}),2),a=i[0],s=i[1],c=$3(e,HQ([a,s],4));return br(c,kc([0,0,0],4),4)}function $3(n,e,t){var r=n.beforeTransform,i=n.afterTransform,a=n.beforeTransform2,s=n.afterTransform2,c=n.targetAllTransform,u=t?Yt(c,e,4):Yt(e,c,4),d=Yt(Xa(t?a:r,4),u,4),h=Yt(d,Xa(t?s:i,4),4);return h}function H3(n){var e=n.datas,t=n.distX,r=n.distY,i=e.inverseBeforeMatrix,a=e.is3d,s=e.startDragBeforeDist,c=e.absoluteOrigin,u=a?4:3;return We(br(i,It(c,[t,r]),u),s)}function Ja(n,e){var t=n.datas,r=n.distX,i=n.distY,a=t.inverseBeforeMatrix,s=t.inverseMatrix,c=t.is3d,u=t.startDragBeforeDist,d=t.startDragDist,h=t.absoluteOrigin,p=c?4:3;return We(br(e?a:s,It(h,[r,i]),p),e?u:d)}function GZ(n,e){var t=n.datas,r=n.distX,i=n.distY;t.beforeMatrix;var a=t.matrix,s=t.is3d;t.startDragBeforeDist;var c=t.startDragDist,u=t.absoluteOrigin,d=s?4:3;return We(br(a,It(c,[r,i]),d),u)}function qZ(n,e,t,r,i,a){return r===void 0&&(r=e),i===void 0&&(i=t),a===void 0&&(a=[0,0]),n?n.map(function(s,c){var u=eg(s),d=u.value,h=u.unit,p=c?i:r,m=c?t:e;if(s==="%"||isNaN(d)){var b=p?a[c]/p:0;return m*b}else if(h!=="%")return d;return m*d/100}):a}function Y3(n){var e=[];return n[1]>=0&&(n[0]>=0&&e.push(3),n[0]<=0&&e.push(2)),n[1]<=0&&(n[0]>=0&&e.push(1),n[0]<=0&&e.push(0)),e}function $Z(n,e){return Y3(e).map(function(t){return n[t]})}function E1(n,e){var t=(e+1)/2;return[yv(n[0][0],n[1][0],t,1-t),yv(n[0][1],n[1][1],t,1-t)]}function Kn(n,e){var t=E1([n[0],n[1]],e[0]),r=E1([n[2],n[3]],e[0]);return E1([t,r],e[1])}function HZ(n,e,t,r,i,a){var s=Lc(e,t,r,i),c=Kn(s,a),u=n[0]-c[0],d=n[1]-c[1];return[u,d]}function cg(n,e,t,r){return Yt(n,Uh(e,r,t),r)}function YZ(n,e,t,r){var i=n.transformOrigin,a=n.offsetMatrix,s=n.is3d,c=s?4:3,u;if(Gr(t)){var d=e.beforeTransform,h=e.afterTransform;r?u=ca(xp(t),4,c):u=ca(Yt(Yt(d,xp([t]),4),h,4),4,c)}else u=t;return cg(a,u,i,c)}function KZ(n,e){var t=n.transformOrigin,r=n.offsetMatrix,i=n.is3d,a=n.targetMatrix,s=n.targetAllTransform,c=i?4:3;return cg(r,Yt(s||a,VE(e,c),c),t,c)}function Sy(n,e){var t=Qd(e);return{setTransform:function(r,i){i===void 0&&(i=-1),t.startTransforms=Gn(r)?r:ol(r),uw(n,e,i)},setTransformIndex:function(r){uw(n,e,r)}}}function Ey(n,e,t){var r=Qd(e),i=r.startTransforms;uw(n,e,Ls(i,function(a){return a.indexOf("".concat(t,"("))===0}))}function uw(n,e,t){var r=Qd(e),i=e.datas;if(i.transformIndex=t,t!==-1){var a=r.startTransforms[t];if(a){var s=n.state,c=Ad([a],{"x%":function(u){return u/100*s.offsetWidth},"y%":function(u){return u/100*s.offsetHeight}});i.startValue=c[0].functionValue}}}function GE(n,e){var t=Qd(n);t.nextTransforms=ol(e)}function Qd(n){return n.originalDatas.beforeRenderable}function wv(n){var e=n.originalDatas.beforeRenderable;return e.nextTransforms}function e0(n){return(wv(n)||[]).join(" ")}function t0(n){return Qd(n).nextStyle}function K3(n,e,t,r,i){GE(i,e);var a=Tr.drag(n,lg(i,n.state,t,r)),s=a?a.transform:e;return J(J({transform:e,drag:a},Ir({transform:s},i)),{afterTransform:s})}function qE(n,e,t,r,i,a){var s=YZ(n.state,i,e,a),c=QZ(n,t,r,s);return c}function X3(n,e,t,r,i,a,s){var c=qE(n,e,t,i,a,s),u=n.state,d=u.left,h=u.top,p=n.props.groupable,m=p?d:0,b=p?h:0,_=We(r,c);return We(_,[m,b])}function XZ(n,e,t,r,i,a,s){var c=X3(n,e,t,r,i,a,s);return c}function WZ(n,e,t){return[e?-1+n[0]/(e/2):0,t?-1+n[1]/(t/2):0]}function QZ(n,e,t,r){r===void 0&&(r=n.state.allMatrix);var i=n.state,a=i.width,s=i.height,c=i.is3d,u=c?4:3,d=[a/2*(1+e[0])+t[0],s/2*(1+e[1])+t[1]];return un(r,d,u)}function ZZ(n,e,t){var r=t.fixedDirection,i=t.fixedPosition,a=t.fixedOffset;return X3(n,"rotate(".concat(e,"deg)"),r,i,a,t)}function JZ(n,e,t,r,i,a){var s=n.props.groupable,c=n.state,u=c.transformOrigin,d=c.offsetMatrix,h=c.is3d,p=c.width,m=c.height,b=c.left,_=c.top,w=a.fixedDirection,E=a.nextTargetMatrix||c.targetMatrix,T=h?4:3,C=qZ(i,e,t,p,m,u),k=s?b:0,j=s?_:0,P=cg(d,E,C,T),N=HZ(r,P,e,t,T,w);return We(N,[k,j])}function eJ(n,e){return Kn(zi(n.state),e)}function tJ(n,e){var t=n.targetGesto,r=n.controlGesto,i;return t?.isFlag()&&(i=t.getEventData()[e]),!i&&r?.isFlag()&&(i=r.getEventData()[e]),i||{}}function nJ(n){if(n&&n.getRootNode){var e=n.getRootNode();if(e.nodeType===11)return e}}function rJ(n){var e=n("scale"),t=n("rotate"),r=n("translate"),i=[];return r&&r!=="0px"&&r!=="none"&&i.push("translate(".concat(r.split(/\s+/).join(","),")")),t&&t!=="1"&&t!=="none"&&i.push("rotate(".concat(t,")")),e&&e!=="1"&&e!=="none"&&i.push("scale(".concat(e.split(/\s+/).join(","),")")),i}function W3(n,e,t){for(var r=n,i=[],a=kE(n)||vl(n),s=!t&&n===e||n===a,c=s,u=!1,d=3,h,p,m,b=!1,_=wp(e,e,!0).offsetParent,w=1;r&&!c;){c=s;var E=$r(r),T=E("position"),C=xV(r),k=T==="fixed",j=rJ(E),P=YQ(eee(C)),N=void 0,A=!1,I=!1,D=0,z=0,V=0,B=0,O={hasTransform:!1,fixedContainer:null};k&&(b=!0,O=aee(r),_=O.fixedContainer);var X=P.length;!u&&(X===16||j.length)&&(u=!0,d=4,mw(i),m&&(m=ca(m,3,4))),u&&X===9&&(P=ca(P,3,4));var K=iee(r,n),$=K.tagName,W=K.hasOffset,ee=K.isSVG,ie=K.origin,H=K.targetOrigin,F=K.offset,Y=te(F,2),ne=Y[0],Z=Y[1];$==="svg"&&!r.ownerSVGElement&&m&&(i.push({type:"target",target:r,matrix:see(r,d)}),i.push({type:"offset",target:r,matrix:en(d)}));var oe=parseFloat(E("zoom"))||1;if(k)N=O.fixedContainer,A=!0;else{var ue=wp(r,e,!1,!0,E),ye=ue.offsetZoom;if(N=ue.offsetParent,A=ue.isEnd,I=ue.isStatic,w*=ye,(ue.isCustomElement||ye!==1)&&I)ne-=N.offsetLeft,Z-=N.offsetTop;else if(OZ||PZ){var me=ue.parentSlotElement;if(me){for(var Te=N,Me=0,ae=0;Te&&nJ(Te);)Me+=Te.offsetLeft,ae+=Te.offsetTop,Te=Te.offsetParent;ne-=Me,Z-=ae}}}if(z3&&!jZ&&W&&!ee&&I&&(T==="relative"||T==="static")&&(ne-=N.offsetLeft,Z-=N.offsetTop,s=s||A),k)W&&O.hasTransform&&(V=N.clientLeft,B=N.clientTop);else if(W&&_!==N&&(D=N.clientLeft,z=N.clientTop),W&&N===a){var Ce=_V(r,!1);ne+=Ce[0],Z+=Ce[1]}if(i.push({type:"target",target:r,matrix:Uh(P,d,ie)}),j.length&&(i.push({type:"offset",target:r,matrix:en(d)}),i.push({type:"target",target:r,matrix:Uh(xp(j),d,ie)})),W){var Ne=r===n,Oe=Ne?0:r.scrollLeft,Ge=Ne?0:r.scrollTop;i.push({type:"offset",target:r,matrix:Dc([ne-Oe+D-V,Z-Ge+z-B],d)})}else i.push({type:"offset",target:r,origin:ie});if(oe!==1&&i.push({type:"zoom",target:r,matrix:Uh(VE([oe,oe],d),d,[0,0])}),m||(m=P),h||(h=ie),p||(p=H),c||k)break;r=N,s=A,(!t||r===a)&&(c=s)}return m||(m=en(d)),h||(h=[0,0]),p||(p=[0,0]),{zoom:w,offsetContainer:_,matrixes:i,targetMatrix:m,transformOrigin:h,targetOrigin:p,is3d:u,hasFixed:b}}var rc=null,ic=null,Yu=null;function Id(n){n?(window.Map&&(rc=new Map,ic=new Map),Yu=[]):(rc=null,Yu=null,ic=null)}function iJ(n){var e=ic?.get(n);if(e)return e;var t=Fh(n,!0);return ic&&ic.set(n,t),t}function aJ(n,e){if(Yu){var t=qr(Yu,function(i){return i[0][0]==n&&i[0][1]==e});if(t)return t[1]}var r=W3(n,e,!0);return Yu&&Yu.push([[n,e],r]),r}function $r(n){var e=rc?.get(n);if(!e){var t=Qo(n).getComputedStyle(n);if(!rc)return function(a){return t[a]};e={style:t,cached:{}},rc.set(n,e)}var r=e.cached,i=e.style;return function(a){return a in r||(r[a]=i[a]),r[a]}}function ia(n,e,t){var r=t.originalDatas;r.groupable=r.groupable||{};var i=r.groupable;i.childDatas=i.childDatas||[];var a=i.childDatas;return n.moveables.map(function(s,c){return a[c]=a[c]||{},a[c][e]=a[c][e]||{},J(J({},t),{isRequestChild:!0,datas:a[c][e],originalDatas:a[c]})})}function T1(n,e,t,r,i,a,s){var c=!!t.match(/Start$/g),u=!!t.match(/End$/g),d=i.isPinch,h=i.datas,p=ia(n,e.name,i),m=n.moveables,b=[],_=p.map(function(w,E){var T=m[E],C=T.state,k=C.gestos,j=w;if(c)j=new Cd(s).dragStart(r,w),b.push(j);else{if(k[s]||(k[s]=h.childGestos[E]),!k[s])return;j=lg(w,C,r,d,a,s),b.push(j)}var P=e[t](T,J(J({},j),{parentFlag:!0}));return u&&(k[s]=null),P});return c&&(h.childGestos=m.map(function(w){return w.state.gestos[s]})),{eventParams:_,childEvents:b}}function Ds(n,e,t,r,i,a){i===void 0&&(i=function(h,p){return p});var s=!!t.match(/End$/g),c=ia(n,e.name,r),u=n.moveables,d=c.map(function(h,p){var m=u[p],b=h;b=i(m,h);var _=e[t](m,J(J({},b),{parentFlag:!0}));return s&&(m.state.gestos={}),_});return d}function Sv(n,e,t,r){var i=t.fixedDirection,a=t.fixedPosition,s=r.datas.startPositions||zi(e.state),c=Kn(s,i),u=te(br(ag(-n.rotation/180*Math.PI,3),[c[0]-a[0],c[1]-a[1],1],3),2),d=u[0],h=u[1];return r.datas.originalX=d,r.datas.originalY=h,r}function Q3(n,e,t,r){var i=n.getState(),a=i.renderPoses,s=i.rotation,c=i.direction,u=Mc(n.props,e).zoom,d=Bh(s/Math.PI*180),h={},p=n.renderState;p.renderDirectionMap||(p.renderDirectionMap={});var m=p.renderDirectionMap;t.forEach(function(_){var w=_.dir;h[w]=!0});var b=Ar(c);return t.map(function(_){var w=_.data,E=_.classNames,T=_.dir,C=FE[T];if(!C||!h[T])return null;m[T]=!0;var k=(st(d,15)+b*F3[T]+720)%180,j={};return Bs(w).forEach(function(P){j["data-".concat(P)]=w[P]}),r.createElement("div",J({className:He.apply(void 0,Ie(["control","direction",T,e],te(E),!1)),"data-rotation":k,"data-direction":T},j,{key:"direction-".concat(T),style:Cv.apply(void 0,Ie([s,u],te(C.map(function(P){return a[P]})),!1))}))})}function Z3(n,e,t,r){var i=Mc(n.props,t),a=i.renderDirections,s=a===void 0?e:a,c=i.displayAroundControls;if(!s)return[];var u=s===!0?BE:s;return Ie(Ie([],te(c?nV(n,r,t,u):[]),!1),te(Q3(n,t,u.map(function(d){return{data:{},classNames:[],dir:d}}),r)),!1)}function _p(n,e,t,r,i,a){for(var s=[],c=6;c<arguments.length;c++)s[c-6]=arguments[c];var u=In(t,r),d=e?st(u/Math.PI*180,15)%180:-1;return n.createElement("div",{key:"line-".concat(a),className:He.apply(void 0,Ie(["line","direction",e?"edge":"",e],te(s),!1)),"data-rotation":d,"data-line-key":a,"data-direction":e,style:xh(t,r,i,u)})}function J3(n,e,t,r,i){var a=t===!0?IZ:t;return a.map(function(s,c){var u=te(FE[s],2),d=u[0],h=u[1];if(h!=null)return _p(n,s,r[d],r[h],i,"".concat(e,"Edge").concat(c),e)}).filter(Boolean)}function eV(n){return function(e,t){var r=Mc(e.props,n).edge;return r&&(r===!0||r.length)?Ie(Ie([],te(J3(t,n,r,e.getState().renderPoses,e.props.zoom)),!1),te(sJ(e,n,t)),!1):tV(e,n,t)}}function tV(n,e,t){return Z3(n,BE,e,t)}function sJ(n,e,t){return Z3(n,["nw","ne","sw","se"],e,t)}function nV(n,e,t,r){var i=n.renderState;i.renderDirectionMap||(i.renderDirectionMap={});var a=n.getState(),s=a.renderPoses,c=a.rotation,u=a.direction,d=i.renderDirectionMap,h=n.props.zoom,p=Ar(u),m=c/Math.PI*180;return(r||Bs(d)).map(function(b){var _=FE[b];if(!_)return null;var w=(st(m,15)+p*F3[b]+720)%180,E=["around-control"];return t&&E.push("direction",t),e.createElement("div",{className:He.apply(void 0,Ie([],te(E),!1)),"data-rotation":w,"data-direction":b,key:"direction-around-".concat(b),style:Cv.apply(void 0,Ie([c,h],te(_.map(function(T){return s[T]})),!1))})})}function $E(n,e,t){var r=n||{},i=r.position,a=i===void 0?"client":i,s=r.left,c=s===void 0?-1/0:s,u=r.top,d=u===void 0?-1/0:u,h=r.right,p=h===void 0?1/0:h,m=r.bottom,b=m===void 0?1/0:m,_={position:a,left:c,top:d,right:p,bottom:b};return{vertical:LD(_,e,!0),horizontal:LD(_,t,!1)}}function Ty(n,e){var t=n.state,r=t.containerClientRect,i=r.clientHeight,a=r.clientWidth,s=r.clientLeft,c=r.clientTop,u=t.snapOffset,d=u.left,h=u.top,p=u.right,m=u.bottom,b=e||n.props.bounds||{},_=b.position||"client",w=_==="css",E=b.left,T=E===void 0?-1/0:E,C=b.top,k=C===void 0?-1/0:C,j=b.right,P=j===void 0?w?-1/0:1/0:j,N=b.bottom,A=N===void 0?w?-1/0:1/0:N;return w&&(P=a+p-d-P,A=i+m-h-A),{left:T+d-s,right:P+d-s,top:k+h-c,bottom:A+h-c}}function oJ(n,e,t){var r=Ty(n),i=r.left,a=r.top,s=r.right,c=r.bottom,u=te(t,2),d=u[0],h=u[1],p=te(We(t,e),2),m=p[0],b=p[1];we(m)<kr&&(m=0),we(b)<kr&&(b=0);var _=b>0,w=m>0,E={isBound:!1,offset:0,pos:0},T={isBound:!1,offset:0,pos:0};if(m===0&&b===0)return{vertical:E,horizontal:T};if(m===0)_?c<h&&(T.pos=c,T.offset=h-c):a>h&&(T.pos=a,T.offset=h-a);else if(b===0)w?s<d&&(E.pos=s,E.offset=d-s):i>d&&(E.pos=i,E.offset=d-i);else{var C=b/m,k=t[1]-C*d,j=0,P=0,N=!1;w&&s<=d?(j=C*s+k,P=s,N=!0):!w&&d<=i&&(j=C*i+k,P=i,N=!0),N&&(j<a||j>c)&&(N=!1),N||(_&&c<=h?(j=c,P=(j-k)/C,N=!0):!_&&h<=a&&(j=a,P=(j-k)/C,N=!0)),N&&(E.isBound=!0,E.pos=P,E.offset=d-P,T.isBound=!0,T.pos=j,T.offset=h-j)}return{vertical:E,horizontal:T}}function LD(n,e,t){var r=n[t?"left":"top"],i=n[t?"right":"bottom"],a=Math.min.apply(Math,Ie([],te(e),!1)),s=Math.max.apply(Math,Ie([],te(e),!1)),c=[];return r+1>a&&c.push({direction:"start",isBound:!0,offset:a-r,pos:r}),i-1<s&&c.push({direction:"end",isBound:!0,offset:s-i,pos:i}),c.length||c.push({isBound:!1,offset:0,pos:0}),c.sort(function(u,d){return we(d.offset)-we(u.offset)})}function BD(n,e,t){var r=t?n.map(function(i){return ig(i,t)}):n;return r.some(function(i){return i[0]<e.left&&we(i[0]-e.left)>.1||i[0]>e.right&&we(i[0]-e.right)>.1||i[1]<e.top&&we(i[1]-e.top)>.1||i[1]>e.bottom&&we(i[1]-e.bottom)>.1})}function lJ(n,e,t){var r=Vi(n),i=Math.sqrt(r*r-e*e)||0;return[i,-i].sort(function(a,s){return we(a-n[t?0:1])-we(s-n[t?0:1])}).map(function(a){return In([0,0],t?[a,e]:[e,a])})}function cJ(n,e,t,r,i){if(!n.props.bounds)return[];var a=i*Math.PI/180,s=Ty(n),c=s.left,u=s.top,d=s.right,h=s.bottom,p=c-r[0],m=d-r[0],b=u-r[1],_=h-r[1],w={left:p,top:b,right:m,bottom:_};if(!BD(t,w,0))return[];var E=[];return[[p,0],[m,0],[b,1],[_,1]].forEach(function(T){var C=te(T,2),k=C[0],j=C[1];t.forEach(function(P){var N=In([0,0],P);E.push.apply(E,Ie([],te(lJ(P,k,j).map(function(A){return a+A-N}).filter(function(A){return!BD(e,w,A)}).map(function(A){return st(A*180/Math.PI,kr)})),!1))})}),E}var uJ=["left","right","center"],dJ=["top","bottom","middle"],UD={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},ll={start:"left",end:"right",center:"center"},cl={start:"top",end:"bottom",center:"middle"};function Ku(){return{left:!1,top:!1,right:!1,bottom:!1}}function Zd(n,e){var t=n.props,r=t.snappable,i=t.bounds,a=t.innerBounds,s=t.verticalGuidelines,c=t.horizontalGuidelines,u=t.snapGridWidth,d=t.snapGridHeight,h=n.state,p=h.guidelines,m=h.enableSnap;return!r||!m||e&&r!==!0&&r.indexOf(e)<0?!1:!!(u||d||i||a||p&&p.length||s&&s.length||c&&c.length)}function HE(n){return n===!1?{}:n===!0||!n?{left:!0,right:!0,top:!0,bottom:!0}:n}function fJ(n,e){var t=HE(n),r={};for(var i in t)i in e&&t[i]&&(r[i]=e[i]);return r}function YE(n,e){var t=fJ(n,e),r=dJ.filter(function(a){return a in t}),i=uJ.filter(function(a){return a in t});return{horizontalNames:r,verticalNames:i,horizontal:r.map(function(a){return t[a]}),vertical:i.map(function(a){return t[a]})}}function hJ(n,e,t){var r=un(n,[e.clientLeft,e.clientTop],t);return[e.left+r[0],e.top+r[1]]}function pJ(n){var e=te(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];Math.abs(i)<Un&&(i=0),Math.abs(a)<Un&&(a=0);var s=0,c=0,u=0;return i?a?(s=-a/i,c=1,u=s*t[0]-t[1]):(c=1,u=-t[1]):(s=-1,u=t[0]),[s,c,u].map(function(d){return st(d,Un)})}var rV="snapRotationThreshold",iV="snapRotationDegrees",aV="snapHorizontalThreshold",sV="snapVerticalThreshold";function Ay(n,e,t,r,i,a,s){var c;r===void 0&&(r=[]),i===void 0&&(i=[]);var u=n.props,d=((c=n.state.snapThresholdInfo)===null||c===void 0?void 0:c.multiples)||[1,1],h=nN(s,u[aV],5),p=nN(a,u[sV],5);return oV(n.state.guidelines,e,t,r,i,h,p,d)}function oV(n,e,t,r,i,a,s,c){return{vertical:GD(n,"vertical",e,s*c[0],r),horizontal:GD(n,"horizontal",t,a*c[1],i)}}function gJ(n,e,t){var r=te(t,2),i=r[0],a=r[1],s=te(e,2),c=s[0],u=s[1],d=te(We(t,e),2),h=d[0],p=d[1],m=p>0,b=h>0;h=Iv(h),p=Iv(p);var _={isSnap:!1,offset:0,pos:0},w={isSnap:!1,offset:0,pos:0};if(h===0&&p===0)return{vertical:_,horizontal:w};var E=Ay(n,h?[i]:[],p?[a]:[],[],[],void 0,void 0),T=E.vertical,C=E.horizontal;T.posInfos.filter(function($){var W=$.pos;return b?W>=c:W<=c}),C.posInfos.filter(function($){var W=$.pos;return m?W>=u:W<=u}),T.isSnap=T.posInfos.length>0,C.isSnap=C.posInfos.length>0;var k=dw(T),j=k.isSnap,P=k.guideline,N=dw(C),A=N.isSnap,I=N.guideline,D=A?I.pos[1]:0,z=j?P.pos[0]:0;if(h===0)A&&(w.isSnap=!0,w.pos=I.pos[1],w.offset=a-w.pos);else if(p===0)j&&(_.isSnap=!0,_.pos=z,_.offset=i-z);else{var V=p/h,B=t[1]-V*i,O=0,X=0,K=!1;j?(X=z,O=V*X+B,K=!0):A&&(O=D,X=(O-B)/V,K=!0),K&&(_.isSnap=!0,_.pos=X,_.offset=i-X,w.isSnap=!0,w.pos=O,w.offset=a-O)}return{vertical:_,horizontal:w}}function Bo(n){var e="";return n===-1||n==="top"||n==="left"?e="start":n===0||n==="center"||n==="middle"?e="center":(n===1||n==="right"||n==="bottom")&&(e="end"),e}function FD(n,e,t,r){var i=YE(n.props.snapDirections,e),a=Ay(n,i.vertical,i.horizontal,i.verticalNames.map(function(u){return Bo(u)}),i.horizontalNames.map(function(u){return Bo(u)}),t,r),s=Bo(i.horizontalNames[a.horizontal.index]),c=Bo(i.verticalNames[a.vertical.index]);return{vertical:J(J({},a.vertical),{direction:c}),horizontal:J(J({},a.horizontal),{direction:s})}}function dw(n){var e=n.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var t=n.posInfos[0],r=t.guidelineInfos[0],i=r.offset,a=r.dist,s=r.guideline;return{isSnap:e,offset:i,dist:a,pos:t.pos,guideline:s}}function GD(n,e,t,r,i){var a,s;if(i===void 0&&(i=[]),!n||!n.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var c=e==="vertical",u=c?0:1,d=t.map(function(p,m){var b=i[m]||"",_=n.map(function(w){var E=w.pos,T=p-E[u];return{offset:T,dist:we(T),guideline:w,direction:b}}).filter(function(w){var E=w.guideline,T=w.dist,C=E.type;return!(C!==e||T>r)}).sort(function(w,E){return w.dist-E.dist});return{pos:p,index:m,guidelineInfos:_,direction:b}}).filter(function(p){return p.guidelineInfos.length>0}).sort(function(p,m){return p.guidelineInfos[0].dist-m.guidelineInfos[0].dist}),h=d.length>0;return{isSnap:h,index:h?d[0].index:-1,direction:(s=(a=d[0])===null||a===void 0?void 0:a.direction)!==null&&s!==void 0?s:"",posInfos:d}}function mJ(n,e,t,r,i){var a=[];t[0]&&t[1]?a=[t,[-t[0],t[1]],[t[0],-t[1]]]:!t[0]&&!t[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(m,b,_){var w=_[b+1]||_[0];a.push(m),a.push([(m[0]+w[0])/2,(m[1]+w[1])/2])}):n.props.keepRatio?a.push([-1,-1],[-1,1],[1,-1],[1,1],t):(a.push.apply(a,Ie([],te($Z([[-1,-1],[1,-1],[-1,-1],[1,1]],t)),!1)),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var s=a.map(function(m){return Kn(e,m)}),c=s.map(function(m){return m[0]}),u=s.map(function(m){return m[1]}),d=Ay(n,c,u,a.map(function(m){return Bo(m[0])}),a.map(function(m){return Bo(m[1])}),r,i),h=Bo(a.map(function(m){return m[0]})[d.vertical.index]),p=Bo(a.map(function(m){return m[1]})[d.horizontal.index]);return{vertical:J(J({},d.vertical),{direction:h}),horizontal:J(J({},d.horizontal),{direction:p})}}function lV(n,e){var t=we(n.offset),r=we(e.offset);return n.isBound&&e.isBound?r-t:n.isBound?-1:e.isBound?1:n.isSnap&&e.isSnap?r-t:n.isSnap?-1:e.isSnap||t<kr?1:r<kr?-1:t-r}function Ev(n,e){return n.slice().sort(function(t,r){var i=t.sign[e],a=r.sign[e],s=t.offset[e],c=r.offset[e];if(i){if(!a)return-1}else return 1;return lV({isBound:t.isBound,isSnap:t.isSnap,offset:s},{isBound:r.isBound,isSnap:r.isSnap,offset:c})})[0]}function vJ(n,e,t){var r=[];if(t)we(e[0])!==1||we(e[1])!==1?r.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):r.push([e,[n[0],-n[1]]],[e,[-n[0],n[1]]]),r.push([e,n]);else if(n[0]&&n[1]||!n[0]&&!n[1]){var i=n[0]?n:[1,1];[1,-1].forEach(function(s){[1,-1].forEach(function(c){var u=[s*i[0],c*i[1]];e[0]===u[0]&&e[1]===u[1]||r.push([e,u])})})}else if(n[0]){var a=we(e[0])===1?[1]:[1,-1];a.forEach(function(s){r.push([[e[0],-1],[s*n[0],-1]],[[e[0],0],[s*n[0],0]],[[e[0],1],[s*n[0],1]])})}else if(n[1]){var a=we(e[1])===1?[1]:[1,-1];a.forEach(function(c){r.push([[-1,e[1]],[-1,c*n[1]]],[[0,e[1]],[0,c*n[1]]],[[1,e[1]],[1,c*n[1]]])})}return r}function cV(n,e){var t=W_([e[0][0],e[1][0]]),r=W_([e[0][1],e[1][1]]);return{vertical:t<=n[0],horizontal:r<=n[1]}}function KE(n,e){var t=te(e,2),r=t[0],i=t[1],a=i[0]-r[0],s=i[1]-r[1];we(a)<kr&&(a=0),we(s)<kr&&(s=0);var c,u;if(!a)c=r[0],u=n[0];else if(!s)c=r[1],u=n[1];else{var d=s/a;c=d*(n[0]-r[0])+r[1],u=n[1]}return c-u}function uV(n,e,t,r){return r===void 0&&(r=kr),n.every(function(i){var a=KE(i,e),s=a<=0;return s===t||we(a)<=r})}function qD(n,e,t,r,i){return i===void 0&&(i=0),r&&e-i<=n||!r&&n<=t+i?{isBound:!0,offset:r?e-n:t-n}:{isBound:!1,offset:0}}function yJ(n,e){var t=e.line,r=e.centerSign,i=e.verticalSign,a=e.horizontalSign,s=e.lineConstants,c=n.props.innerBounds;if(!c)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var u=c.left,d=c.top,h=c.width,p=c.height,m=[[u,d],[u,d+p]],b=[[u,d],[u+h,d]],_=[[u+h,d],[u+h,d+p]],w=[[u,d+p],[u+h,d+p]];if(uV([[u,d],[u+h,d],[u,d+p],[u+h,d+p]],t,r))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var E=Uo(t,s,b,i),T=Uo(t,s,w,i),C=Uo(t,s,m,a),k=Uo(t,s,_,a),j=E.isBound&&T.isBound,P=E.isBound||T.isBound,N=C.isBound&&k.isBound,A=C.isBound||k.isBound,I=Rd(E.offset,T.offset),D=Rd(C.offset,k.offset),z=[0,0],V=!1,B=!1;return we(D)<we(I)?(z=[I,0],V=P,B=j):(z=[0,D],V=A,B=N),{isAllBound:B,isVerticalBound:P,isHorizontalBound:A,isBound:V,offset:z}}function Uo(n,e,t,r,i,a){var s=te(e,2),c=s[0],u=s[1],d=n[0],h=t[0],p=t[1],m=Iv(p[1]-h[1]),b=Iv(p[0]-h[0]),_=u,w=c,E=-c/u;if(b){if(!m){if(a&&!_)return{isBound:!1,offset:0};if(w){var j=(h[1]-d[1])/E+d[0];return qD(j,h[0],p[0],r,i)}else{var C=h[1]-d[1],k=we(C)<=(i||0);return{isBound:k,offset:k?C:0}}}}else{if(a&&!w)return{isBound:!1,offset:0};if(_){var T=E*(h[0]-d[0])+d[1];return qD(T,h[1],p[1],r,i)}else{var C=h[0]-d[0],k=we(C)<=(i||0);return{isBound:k,offset:k?C:0}}}return{isBound:!1,offset:0}}function dV(n,e,t){return e.map(function(r){var i=yJ(n,r),a=i.isBound,s=i.offset,c=i.isVerticalBound,u=i.isHorizontalBound,d=r.multiple,h=Ja({datas:t,distX:s[0],distY:s[1]}).map(function(p,m){return p*(d[m]?2/d[m]:0)});return{sign:d,isBound:a,isVerticalBound:c,isHorizontalBound:u,isSnap:!1,offset:h}})}function bJ(n,e,t){var r,i=XE(n,e,[0,0],!1).map(function(m){return J(J({},m),{multiple:m.multiple.map(function(b){return we(b)*2})})}),a=dV(n,i,t),s=Ev(a,0),c=Ev(a,1),u=0,d=0,h=s.isVerticalBound||c.isVerticalBound,p=s.isHorizontalBound||c.isHorizontalBound;return(h||p)&&(r=te(GZ({datas:t,distX:-s.offset[0],distY:-c.offset[1]}),2),u=r[0],d=r[1]),{vertical:{isBound:h,offset:u},horizontal:{isBound:p,offset:d}}}function xJ(n,e){var t=[],r=n[0],i=n[1];return r&&i?t.push([[0,i*2],n,[-r,i]],[[r*2,0],n,[r,-i]]):r?(t.push([[r*2,0],[r,1],[r,-1]]),e&&t.push([[0,-1],[r,-1],[-r,-1]],[[0,1],[r,1],[-r,1]])):i?(t.push([[0,i*2],[1,i],[-1,i]]),e&&t.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):t.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),t}function XE(n,e,t,r){var i=n.state,a=i.allMatrix,s=i.is3d,c=Lc(a,100,100,s?4:3),u=Kn(c,[0,0]);return xJ(t,r).map(function(d){var h=te(d,3),p=h[0],m=h[1],b=h[2],_=[Kn(c,m),Kn(c,b)],w=pJ(_),E=cV(u,_),T=E.vertical,C=E.horizontal,k=KE(u,_)<=0;return{multiple:p,centerSign:k,verticalSign:T,horizontalSign:C,lineConstants:w,line:[Kn(e,m),Kn(e,b)]}})}function $D(n,e,t,r){var i=r?n.map(function(a){return ig(a,r)}):n;return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some(function(a){var s=KE(t,a)<=0;return!uV(e,a,s)})}function _J(n){var e=te(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];if(!i)return we(t[0]);if(!a)return we(t[1]);var s=a/i;return we((-s*t[0]+t[1])/Math.sqrt(Math.pow(s,2)+1))}function wJ(n){var e=te(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];if(!i)return[t[0],0];if(!a)return[0,t[1]];var s=a/i,c=-s*t[0]+t[1];return[-c/(s+1/s),c/(s*s+1)]}function SJ(n,e,t,r,i){var a=n.props.innerBounds,s=i*Math.PI/180;if(!a)return[];var c=a.left,u=a.top,d=a.width,h=a.height,p=c-r[0],m=c+d-r[0],b=u-r[1],_=u+h-r[1],w=[[p,b],[m,b],[p,_],[m,_]],E=Kn(t,[0,0]);if(!$D(t,w,E,0))return[];var T=[],C=w.map(function(k){return[Vi(k),In([0,0],k)]});return[[t[0],t[1]],[t[1],t[3]],[t[3],t[2]],[t[2],t[0]]].forEach(function(k){var j=In([0,0],wJ(k)),P=_J(k);T.push.apply(T,Ie([],te(C.filter(function(N){var A=te(N,1),I=A[0];return I&&P<=I}).map(function(N){var A=te(N,2),I=A[0],D=A[1],z=Math.acos(I?P/I:0),V=D+z,B=D-z;return[s+V-j,s+B-j]}).reduce(function(N,A){return N.push.apply(N,Ie([],te(A),!1)),N},[]).filter(function(N){return!$D(e,w,E,N)}).map(function(N){return st(N*180/Math.PI,kr)})),!1))}),T}function EJ(n){var e=n.props.innerBounds,t=Ku();if(!e)return{boundMap:t,vertical:[],horizontal:[]};var r=n.getRect(),i=r.pos1,a=r.pos2,s=r.pos3,c=r.pos4,u=[i,a,s,c],d=Kn(u,[0,0]),h=e.left,p=e.top,m=e.width,b=e.height,_=[[h,p],[h,p+b]],w=[[h,p],[h+m,p]],E=[[h+m,p],[h+m,p+b]],T=[[h,p+b],[h+m,p+b]],C=XE(n,u,[0,0],!1),k=[],j=[];return C.forEach(function(P){var N=P.line,A=P.lineConstants,I=cV(d,N),D=I.horizontal,z=I.vertical,V=Uo(N,A,w,z,1,!0),B=Uo(N,A,T,z,1,!0),O=Uo(N,A,_,D,1,!0),X=Uo(N,A,E,D,1,!0);V.isBound&&!t.top&&(k.push(p),t.top=!0),B.isBound&&!t.bottom&&(k.push(p+b),t.bottom=!0),O.isBound&&!t.left&&(j.push(h),t.left=!0),X.isBound&&!t.right&&(j.push(h+m),t.right=!0)}),{boundMap:t,horizontal:k,vertical:j}}function TJ(n,e,t,r){var i=e[0]-n[0],a=e[1]-n[1];if(we(i)<Un&&(i=0),we(a)<Un&&(a=0),!i)return r?[0,0]:[0,t];if(!a)return r?[t,0]:[0,0];var s=a/i,c=n[1]-s*n[0];if(r){var u=s*(e[0]+t)+c;return[t,u-e[1]]}else{var d=(e[1]+t-c)/s;return[d-e[0],t]}}function fw(n,e,t,r,i){var a=TJ(n,e,t,r);if(!a)return{isOutside:!1,offset:[0,0]};var s=ks(n,e),c=ks(a,n),u=ks(a,e),d=c>s||u>s,h=te(Ja({datas:i,distX:a[0],distY:a[1]}),2),p=h[0],m=h[1];return{offset:[p,m],isOutside:d}}function Tv(n,e){return n.isBound?n.offset:e.isSnap?dw(e).offset:0}function AJ(n,e,t,r,i){var a=te(e,2),s=a[0],c=a[1],u=te(t,2),d=u[0],h=u[1],p=te(r,2),m=p[0],b=p[1],_=te(i,2),w=_[0],E=_[1],T=-w,C=-E;if(n&&s&&c){T=0,C=0;var k=[];if(d&&h?k.push([0,E],[w,0]):d?k.push([w,0]):h?k.push([0,E]):m&&b?k.push([0,E],[w,0]):m?k.push([w,0]):b&&k.push([0,E]),k.length){k.sort(function(A,I){return Vi(We([s,c],A))-Vi(We([s,c],I))});var j=k[0];if(j[0]&&we(s)>Un)T=-j[0],C=c*we(s+T)/we(s)-c;else if(j[1]&&we(c)>Un){var P=c;C=-j[1],T=s*we(c+C)/we(P)-s}if(n&&h&&d)if(we(T)>Un&&we(T)<we(w)){var N=we(w)/we(T);T*=N,C*=N}else if(we(C)>Un&&we(C)<we(E)){var N=we(E)/we(C);T*=N,C*=N}else T=Rd(-w,T),C=Rd(-E,C)}}else T=s||d?-w:0,C=c||h?-E:0;return[T,C]}function CJ(n,e,t,r,i,a){if(!Zd(n,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var s=ZE(a.absolutePoses,[e,t]),c=Oi(s),u=c.left,d=c.right,h=c.top,p=c.bottom,m={horizontal:s.map(function(X){return X[1]}),vertical:s.map(function(X){return X[0]})},b=HE(n.props.snapDirections),_=YE(b,{left:u,right:d,top:h,bottom:p,center:(u+d)/2,middle:(h+p)/2}),w=Cy(n,i,_,m),E=w.vertical,T=w.horizontal,C=bJ(n,s,a),k=C.vertical,j=C.horizontal,P=E.isSnap,N=T.isSnap,A=E.isBound||k.isBound,I=T.isBound||j.isBound,D=Rd(E.offset,k.offset),z=Rd(T.offset,j.offset),V=te(AJ(r,[e,t],[A,I],[P,N],[D,z]),2),B=V[0],O=V[1];return[{isBound:A,isSnap:P,offset:B},{isBound:I,isSnap:N,offset:O}]}function Cy(n,e,t,r){r===void 0&&(r=t);var i=$E(Ty(n),r.vertical,r.horizontal),a=i.horizontal,s=i.vertical,c=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:Ay(n,t.vertical,t.horizontal,void 0,void 0,void 0,void 0),u=c.horizontal,d=c.vertical,h=Tv(a[0],u),p=Tv(s[0],d),m=we(h),b=we(p);return{horizontal:{isBound:a[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:h,dist:m,bounds:a,snap:u},vertical:{isBound:s[0].isBound,isSnap:d.isSnap,snapIndex:d.index,offset:p,dist:b,bounds:s,snap:d}}}function HD(n,e,t,r,i,a,s){s===void 0&&(s=[1,1]);var c=$E(e,t,r),u=c.horizontal,d=c.vertical,h=oV(n,t,r,[],[],i,a,s),p=h.horizontal,m=h.vertical,b=Tv(u[0],p),_=Tv(d[0],m),w=we(b),E=we(_);return{horizontal:{isBound:u[0].isBound,isSnap:p.isSnap,snapIndex:p.index,offset:b,dist:w,bounds:u,snap:p},vertical:{isBound:d[0].isBound,isSnap:m.isSnap,snapIndex:m.index,offset:_,dist:E,bounds:d,snap:m}}}function IJ(n,e,t,r){var i=In(n,e)/Math.PI*180,a=t.vertical,s=a.isBound,c=a.isSnap,u=a.dist,d=t.horizontal,h=d.isBound,p=d.isSnap,m=d.dist,b=i%180,_=b<3||b>177,w=b>87&&b<93;return m<u&&(s||c&&!w&&(!r||!_))?"vertical":h||p&&!_&&(!r||!w)?"horizontal":""}function RJ(n,e,t,r,i,a){return t.map(function(s){var c=te(s,2),u=c[0],d=c[1],h=Kn(e,u),p=Kn(e,d),m=r?kJ(n,h,p,i):Cy(n,i,{vertical:[p[0]],horizontal:[p[1]]}),b=m.horizontal,_=b.offset,w=b.isBound,E=b.isSnap,T=m.vertical,C=T.offset,k=T.isBound,j=T.isSnap,P=We(d,u);if(!C&&!_)return{isBound:k||w,isSnap:j||E,sign:P,offset:[0,0]};var N=IJ(h,p,m,r);if(!N)return{sign:P,isBound:!1,isSnap:!1,offset:[0,0]};var A=N==="vertical",I=[0,0];return!r&&we(d[0])===1&&we(d[1])===1&&u[0]!==d[0]&&u[1]!==d[1]?I=Ja({datas:a,distX:-C,distY:-_}):I=fw(h,p,-(A?C:_),A,a).offset,I=I.map(function(D,z){return D*(P[z]?2/P[z]:0)}),{sign:P,isBound:A?k:w,isSnap:A?j:E,offset:I}})}function YD(n,e){return n.isBound?n.offset:e.isSnap?e.offset:0}function kJ(n,e,t,r){var i=oJ(n,e,t),a=i.horizontal,s=i.vertical,c=r?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:gJ(n,e,t),u=c.horizontal,d=c.vertical,h=YD(a,u),p=YD(s,d),m=we(h),b=we(p);return{horizontal:{isBound:a.isBound,isSnap:u.isSnap,offset:h,dist:m},vertical:{isBound:s.isBound,isSnap:d.isSnap,offset:p,dist:b}}}function DJ(n,e,t,r,i){var a=[-t[0],-t[1]],s=n.state,c=s.width,u=s.height,d=n.props.bounds,h=1/0,p=1/0;if(d){var m=[[t[0],-t[1]],[-t[0],t[1]]],b=d.left,_=b===void 0?-1/0:b,w=d.top,E=w===void 0?-1/0:w,T=d.right,C=T===void 0?1/0:T,k=d.bottom,j=k===void 0?1/0:k;m.forEach(function(P){var N=P[0]!==a[0],A=P[1]!==a[1],I=Kn(e,P),D=In(r,I)*360/Math.PI;if(A){var z=I.slice();(we(D-360)<2||we(D-180)<2)&&(z[1]=r[1]);var V=fw(r,z,(r[1]<I[1]?j:E)-I[1],!1,i),B=te(V.offset,2),O=B[1],X=V.isOutside;isNaN(O)||(p=u+(X?1:-1)*we(O))}if(N){var z=I.slice();(we(D-90)<2||we(D-270)<2)&&(z[0]=r[0]);var K=fw(r,z,(r[0]<I[0]?C:_)-I[0],!0,i),$=te(K.offset,1),W=$[0],ee=K.isOutside;isNaN(W)||(h=c+(ee?1:-1)*we(W))}})}return{maxWidth:h,maxHeight:p}}var Tr={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(n,e){var t=n.props,r=t.hideThrottleDragRotateLine,i=t.throttleDragRotate,a=t.zoom,s=n.getState(),c=s.dragInfo,u=s.beforeOrigin;if(r||!i||!c)return[];var d=c.dist;if(!d[0]&&!d[1])return[];var h=Vi(d),p=In(d,[0,0]);return[e.createElement("div",{className:He("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(h,"px"),transform:"translate(".concat(u[0],"px, ").concat(u[1],"px) rotate(").concat(p,"rad) scaleY(").concat(a,")")}})]},dragStart:function(n,e){var t=e.datas,r=e.parentEvent,i=e.parentGesto,a=n.state,s=a.gestos,c=a.style;if(s.draggable)return!1;s.draggable=i||n.targetGesto,t.datas={},t.left=parseFloat(c.left||"")||0,t.top=parseFloat(c.top||"")||0,t.bottom=parseFloat(c.bottom||"")||0,t.right=parseFloat(c.right||"")||0,t.startValue=[0,0],zc(n,e),Ey(n,e,"translate"),WJ(n,t),t.prevDist=[0,0],t.prevBeforeDist=[0,0],t.isDrag=!1,t.deltaOffset=[0,0];var u=dt(n,e,J({set:function(h){t.startValue=h}},Sy(n,e))),d=r||je(n,"onDragStart",u);return d!==!1?(t.isDrag=!0,n.state.dragInfo={startRect:n.getRect(),dist:[0,0]}):(s.draggable=null,t.isPinch=!1),t.isDrag?u:!1},drag:function(n,e){if(e){_y(n,e,"translate");var t=e.datas,r=e.parentEvent,i=e.parentFlag,a=e.isPinch,s=e.deltaOffset,c=e.useSnap,u=e.isRequest,d=e.isGroup,h=e.parentThrottleDrag,p=e.distX,m=e.distY,b=t.isDrag,_=t.prevDist,w=t.prevBeforeDist,E=t.startValue;if(b){s&&(p+=s[0],m+=s[1]);var T=n.props,C=T.parentMoveable,k=d?0:T.throttleDrag||h||0,j=r?0:T.throttleDragRotate||0,P=0,N=!1,A=!1,I=!1,D=!1;if(!r&&j>0&&(p||m)){var z=T.startDragRotate||0,V=st(z+In([0,0],[p,m])*180/Math.PI,j)-z,B=m*Math.abs(Math.cos((V-90)/180*Math.PI)),O=p*Math.abs(Math.cos(V/180*Math.PI)),X=Vi([O,B]);P=V*Math.PI/180,p=X*Math.cos(P),m=X*Math.sin(P)}if(!a&&!r&&!i){var K=te(CJ(n,p,m,j,!c&&u||s,t),2),$=K[0],W=K[1];N=$.isSnap,A=$.isBound,I=W.isSnap,D=W.isBound;var ee=$.offset,ie=W.offset;p+=ee,m+=ie}var H=It(H3({datas:t,distX:p,distY:m}),E),F=It(FZ({datas:t,distX:p,distY:m}),E);AD(F,kr),AD(H,kr),j||(!N&&!A&&(F[0]=st(F[0],k),H[0]=st(H[0],k)),!I&&!D&&(F[1]=st(F[1],k),H[1]=st(H[1],k)));var Y=We(H,E),ne=We(F,E),Z=We(ne,_),oe=We(Y,w);t.prevDist=ne,t.prevBeforeDist=Y,t.passDelta=Z,t.passDist=ne;var ue=t.left+Y[0],ye=t.top+Y[1],me=t.right-Y[0],Te=t.bottom-Y[1],Me=wy(t,"translate(".concat(F[0],"px, ").concat(F[1],"px)"),"translate(".concat(ne[0],"px, ").concat(ne[1],"px)"));if(GE(e,Me),n.state.dragInfo.dist=r?[0,0]:ne,!(!r&&!C&&Z.every(function(Ge){return!Ge})&&oe.some(function(Ge){return!Ge}))){var ae=n.state,Ce=ae.width,Ne=ae.height,Oe=dt(n,e,J({transform:Me,dist:ne,delta:Z,translate:F,beforeDist:Y,beforeDelta:oe,beforeTranslate:H,left:ue,top:ye,right:me,bottom:Te,width:Ce,height:Ne,isPinch:a},Ir({transform:Me},e)));return!r&&je(n,"onDrag",Oe),Oe}}}},dragAfter:function(n,e){var t=e.datas,r=t.deltaOffset;return r[0]||r[1]?(t.deltaOffset=[0,0],this.drag(n,J(J({},e),{deltaOffset:r}))):!1},dragEnd:function(n,e){var t=e.parentEvent,r=e.datas;if(n.state.dragInfo=null,!!r.isDrag){r.isDrag=!1;var i=ui(n,e,{});return!t&&je(n,"onDragEnd",i),i}},dragGroupStart:function(n,e){var t,r,i=e.datas,a=e.clientX,s=e.clientY,c=this.dragStart(n,e);if(!c)return!1;var u=T1(n,this,"dragStart",[a||0,s||0],e,!1,"draggable"),d=u.childEvents,h=u.eventParams,p=J(J({},c),{targets:n.props.targets,events:h}),m=je(n,"onDragGroupStart",p);i.isDrag=m!==!1;var b=(r=(t=d[0])===null||t===void 0?void 0:t.datas.startValue)!==null&&r!==void 0?r:[0,0];return i.throttleOffset=[b[0]%1,b[1]%1],i.isDrag?c:!1},dragGroup:function(n,e){var t=e.datas;if(t.isDrag){var r=this.drag(n,J(J({},e),{parentThrottleDrag:n.props.throttleDrag})),i=e.datas.passDelta,a=T1(n,this,"drag",i,e,!1,"draggable").eventParams;if(r){var s=J({targets:n.props.targets,events:a},r);return je(n,"onDragGroup",s),s}}},dragGroupEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isDrag){this.dragEnd(n,e);var i=T1(n,this,"dragEnd",[0,0],e,!1,"draggable").eventParams;return je(n,"onDragGroupEnd",ui(n,e,{targets:n.props.targets,events:i})),t}},request:function(n){var e={},t=n.getRect(),r=0,i=0,a=!1;return{isControl:!1,requestStart:function(s){return a=s.useSnap,{datas:e,useSnap:a}},request:function(s){return"x"in s?r=s.x-t.left:"deltaX"in s&&(r+=s.deltaX),"y"in s?i=s.y-t.top:"deltaY"in s&&(i+=s.deltaY),{datas:e,distX:r,distY:i,useSnap:a}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:a}}}},unset:function(n){n.state.gestos.draggable=null,n.state.dragInfo=null}};function fV(n,e){var t=Kn(n,e),r=[0,0];return{fixedPosition:t,fixedDirection:e,fixedOffset:r}}function NJ(n,e){var t=n.allMatrix,r=n.is3d,i=n.width,a=n.height,s=r?4:3,c=[i/2*(1+e[0]),a/2*(1+e[1])],u=un(t,c,s),d=[0,0];return{fixedPosition:u,fixedDirection:e,fixedOffset:d}}function hV(n,e){var t=n.allMatrix,r=n.is3d,i=n.width,a=n.height,s=r?4:3,c=WZ(e,i,a),u=un(t,e,s),d=[i?0:e[0],a?0:e[1]];return{fixedPosition:u,fixedDirection:c,fixedOffset:d}}var KD=tT("resizable"),hw={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:eV("resizable"),dragControlCondition:KD,viewClassName:eT("resizable"),dragControlStart:function(n,e){var t,r=e.inputEvent,i=e.isPinch,a=e.isGroup,s=e.parentDirection,c=e.parentGesto,u=e.datas,d=e.parentFixedDirection,h=e.parentEvent,p=AV(s,i,r,u),m=n.state,b=m.target,_=m.width,w=m.height,E=m.gestos;if(!p||!b||E.resizable)return!1;E.resizable=c||n.controlGesto,!i&&zc(n,e),u.datas={},u.direction=p,u.startOffsetWidth=_,u.startOffsetHeight=w,u.prevWidth=0,u.prevHeight=0,u.minSize=[0,0],u.startWidth=m.inlineCSSWidth||m.cssWidth,u.startHeight=m.inlineCSSHeight||m.cssHeight,u.maxSize=[1/0,1/0],a||(u.minSize=[m.minOffsetWidth,m.minOffsetHeight],u.maxSize=[m.maxOffsetWidth,m.maxOffsetHeight]);var T=n.props.transformOrigin||"% %";u.transformOrigin=Gr(T)?T.split(" "):T,u.startOffsetMatrix=m.offsetMatrix,u.startTransformOrigin=m.transformOrigin,u.isWidth=(t=e?.parentIsWidth)!==null&&t!==void 0?t:!p[0]&&!p[1]||p[0]||!p[1];function C(D){u.ratio=D&&isFinite(D)?D:0}u.startPositions=zi(n.state);function k(D){var z=fV(u.startPositions,D);u.fixedDirection=z.fixedDirection,u.fixedPosition=z.fixedPosition,u.fixedOffset=z.fixedOffset}function j(D){var z=hV(n.state,D);u.fixedDirection=z.fixedDirection,u.fixedPosition=z.fixedPosition,u.fixedOffset=z.fixedOffset}function P(D){u.minSize=[Ht("".concat(D[0]),0)||0,Ht("".concat(D[1]),0)||0]}function N(D){var z=[D[0]||1/0,D[1]||1/0];(!Td(z[0])||isFinite(z[0]))&&(z[0]=Ht("".concat(z[0]),0)||1/0),(!Td(z[1])||isFinite(z[1]))&&(z[1]=Ht("".concat(z[1]),0)||1/0),u.maxSize=z}C(_/w),k(d||[-p[0],-p[1]]),u.setFixedDirection=k,u.setFixedPosition=j,u.setMin=P,u.setMax=N;var A=dt(n,e,{direction:p,startRatio:u.ratio,set:function(D){var z=te(D,2),V=z[0],B=z[1];u.startWidth=V,u.startHeight=B},setMin:P,setMax:N,setRatio:C,setFixedDirection:k,setFixedPosition:j,setOrigin:function(D){u.transformOrigin=D},dragStart:Tr.dragStart(n,new Cd().dragStart([0,0],e))}),I=h||je(n,"onResizeStart",A);return u.startFixedDirection=u.fixedDirection,u.startFixedPosition=u.fixedPosition,I!==!1&&(u.isResize=!0,n.state.snapRenderInfo={request:e.isRequest,direction:p}),u.isResize?A:!1},dragControl:function(n,e){var t,r=e.datas,i=e.parentFlag,a=e.isPinch,s=e.parentKeepRatio,c=e.dragClient,u=e.parentDist,d=e.useSnap,h=e.isRequest,p=e.isGroup,m=e.parentEvent,b=e.resolveMatrix,_=r.isResize,w=r.transformOrigin,E=r.startWidth,T=r.startHeight,C=r.prevWidth,k=r.prevHeight,j=r.minSize,P=r.maxSize,N=r.ratio,A=r.startOffsetWidth,I=r.startOffsetHeight,D=r.isWidth;if(!_)return;if(b){var z=n.state.is3d,V=r.startOffsetMatrix,B=r.startTransformOrigin,O=z?4:3,X=xp(wv(e)),K=Math.sqrt(X.length);O!==K&&(X=ca(X,K,O));var $=cg(V,X,B,O),W=Lc($,A,I,O);r.startPositions=W,r.nextTargetMatrix=X,r.nextAllMatrix=$}var ee=Mc(n.props,"resizable"),ie=ee.resizeFormat,H=ee.throttleResize,F=H===void 0?i?0:1:H,Y=ee.parentMoveable,ne=ee.keepRatioFinally,Z=r.direction,oe=Z,ue=0,ye=0;!Z[0]&&!Z[1]&&(oe=[1,1]);var me=N&&(s??ee.keepRatio)||!1;function Te(){var ft=r.fixedDirection,Dt=NV(oe,me,r,e);ue=Dt.distWidth,ye=Dt.distHeight;var pn=oe[0]-ft[0]||me?Math.max(A+ue,kr):A,Ot=oe[1]-ft[1]||me?Math.max(I+ye,kr):I;return me&&A&&I&&(D?Ot=pn/N:pn=Ot*N),[pn,Ot]}var Me=te(Te(),2),ae=Me[0],Ce=Me[1];m||(r.setFixedDirection(r.fixedDirection),je(n,"onBeforeResize",dt(n,e,{startFixedDirection:r.startFixedDirection,startFixedPosition:r.startFixedPosition,setFixedDirection:function(ft){var Dt;return r.setFixedDirection(ft),Dt=te(Te(),2),ae=Dt[0],Ce=Dt[1],[ae,Ce]},setFixedPosition:function(ft){var Dt;return r.setFixedPosition(ft),Dt=te(Te(),2),ae=Dt[0],Ce=Dt[1],[ae,Ce]},boundingWidth:ae,boundingHeight:Ce,setSize:function(ft){var Dt;Dt=te(ft,2),ae=Dt[0],Ce=Dt[1]}},!0)));var Ne=c;c||(!i&&a?Ne=eJ(n,[0,0]):Ne=r.fixedPosition);var Oe=[0,0];a||(Oe=KJ(n,ae,Ce,Z,Ne,!d&&h,r)),u&&(!u[0]&&(Oe[0]=0),!u[1]&&(Oe[1]=0));function Ge(){var ft;ie&&(ft=te(ie([ae,Ce]),2),ae=ft[0],Ce=ft[1]),ae=st(ae,F),Ce=st(Ce,F)}if(me){oe[0]&&oe[1]&&Oe[0]&&Oe[1]&&(we(Oe[0])>we(Oe[1])?Oe[1]=0:Oe[0]=0);var Le=!Oe[0]&&!Oe[1];Le&&Ge(),oe[0]&&!oe[1]||Oe[0]&&!Oe[1]||Le&&D?(ae+=Oe[0],Ce=ae/N):(!oe[0]&&oe[1]||!Oe[0]&&Oe[1]||Le&&!D)&&(Ce+=Oe[1],ae=Ce*N)}else ae+=Oe[0],Ce+=Oe[1],ae=Math.max(0,ae),Ce=Math.max(0,Ce);t=te(i3([ae,Ce],j,P,me?N:!1),2),ae=t[0],Ce=t[1],Ge(),me&&(p||ne)&&(D?Ce=ae/N:ae=Ce*N),ue=ae-A,ye=Ce-I;var Se=[ue-C,ye-k];r.prevWidth=ue,r.prevHeight=ye;var Be=JZ(n,ae,Ce,Ne,w,r);if(!(!Y&&Se.every(function(ft){return!ft})&&Be.every(function(ft){return!ft}))){var Pe=Tr.drag(n,lg(e,n.state,Be,!!a,!1,"draggable")),Ue=Pe.transform,lt=E+ue,Et=T+ye,tt=dt(n,e,J({width:lt,height:Et,offsetWidth:Math.round(ae),offsetHeight:Math.round(Ce),startRatio:N,boundingWidth:ae,boundingHeight:Ce,direction:Z,dist:[ue,ye],delta:Se,isPinch:!!a,drag:Pe},IV({style:{width:"".concat(lt,"px"),height:"".concat(Et,"px")},transform:Ue},Pe,e)));return!m&&je(n,"onResize",tt),tt}},dragControlAfter:function(n,e){var t=e.datas,r=t.isResize,i=t.startOffsetWidth,a=t.startOffsetHeight,s=t.prevWidth,c=t.prevHeight;if(!(!r||n.props.checkResizableError===!1)){var u=n.state,d=u.width,h=u.height,p=d-(i+s),m=h-(a+c),b=we(p)>3,_=we(m)>3;if(b&&(t.startWidth+=p,t.startOffsetWidth+=p,t.prevWidth+=p),_&&(t.startHeight+=m,t.startOffsetHeight+=m,t.prevHeight+=m),b||_)return this.dragControl(n,e)}},dragControlEnd:function(n,e){var t=e.datas,r=e.parentEvent;if(t.isResize){t.isResize=!1;var i=ui(n,e,{});return!r&&je(n,"onResizeEnd",i),i}},dragGroupControlCondition:KD,dragGroupControlStart:function(n,e){var t=e.datas,r=this.dragControlStart(n,J(J({},e),{isGroup:!0}));if(!r)return!1;var i=ia(n,"resizable",e),a=t.startOffsetWidth,s=t.startOffsetHeight;function c(){var b=t.minSize;i.forEach(function(_){var w=_.datas,E=w.minSize,T=w.startOffsetWidth,C=w.startOffsetHeight,k=a*(T?E[0]/T:0),j=s*(C?E[1]/C:0);b[0]=Math.max(b[0],k),b[1]=Math.max(b[1],j)})}function u(){var b=t.maxSize;i.forEach(function(_){var w=_.datas,E=w.maxSize,T=w.startOffsetWidth,C=w.startOffsetHeight,k=a*(T?E[0]/T:0),j=s*(C?E[1]/C:0);b[0]=Math.min(b[0],k),b[1]=Math.min(b[1],j)})}var d=Ds(n,this,"dragControlStart",e,function(b,_){return Sv(n,b,t,_)});c(),u();var h=function(b){r.setFixedDirection(b),d.forEach(function(_,w){_.setFixedDirection(b),Sv(n,_.moveable,t,i[w])})};t.setFixedDirection=h;var p=J(J({},r),{targets:n.props.targets,events:d.map(function(b){return J(J({},b),{setMin:function(_){b.setMin(_),c()},setMax:function(_){b.setMax(_),u()}})}),setFixedDirection:h,setMin:function(b){r.setMin(b),c()},setMax:function(b){r.setMax(b),u()}}),m=je(n,"onResizeGroupStart",p);return t.isResize=m!==!1,t.isResize?r:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isResize){var r=Mc(n.props,"resizable");Ry(n,"onBeforeResize",function(b){je(n,"onBeforeResizeGroup",dt(n,e,J(J({},b),{targets:r.targets}),!0))});var i=this.dragControl(n,J(J({},e),{isGroup:!0}));if(i){var a=i.boundingWidth,s=i.boundingHeight,c=i.dist,u=r.keepRatio,d=[a/(a-c[0]),s/(s-c[1])],h=t.fixedPosition,p=Ds(n,this,"dragControl",e,function(b,_){var w=te(br(ag(n.rotation/180*Math.PI,3),[_.datas.originalX*d[0],_.datas.originalY*d[1],1],3),2),E=w[0],T=w[1];return J(J({},_),{parentDist:null,parentScale:d,dragClient:It(h,[E,T]),parentKeepRatio:u})}),m=J({targets:r.targets,events:p},i);return je(n,"onResizeGroup",m),m}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isResize){this.dragControlEnd(n,e);var i=Ds(n,this,"dragControlEnd",e),a=ui(n,e,{targets:n.props.targets,events:i});return je(n,"onResizeGroupEnd",a),t}},request:function(n){var e={},t=0,r=0,i=!1,a=n.getRect();return{isControl:!0,requestStart:function(s){var c;return i=s.useSnap,{datas:e,parentDirection:s.direction||[1,1],parentIsWidth:(c=s?.horizontal)!==null&&c!==void 0?c:!0,useSnap:i}},request:function(s){return"offsetWidth"in s?t=s.offsetWidth-a.offsetWidth:"deltaWidth"in s&&(t+=s.deltaWidth),"offsetHeight"in s?r=s.offsetHeight-a.offsetHeight:"deltaHeight"in s&&(r+=s.deltaHeight),{datas:e,parentDist:[t,r],parentKeepRatio:s.keepRatio,useSnap:i}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:i}}}},unset:function(n){n.state.gestos.resizable=null}};function A1(n,e,t,r,i){var a=n.props.groupable,s=n.state,c=s.is3d?4:3,u=e.origin,d=un(n.state.rootMatrix,We([u[0],u[1]],a?[0,0]:[s.left,s.top]),c),h=It([i.left,i.top],d);e.startAbsoluteOrigin=h,e.prevDeg=In(h,[t,r])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=ks(h,[t,r])}function D0(n,e,t){var r=t.defaultDeg,i=t.prevDeg,a=i%360,s=Math.floor(i/360);a<0&&(a+=360),a>n&&a>270&&n<90?++s:a<n&&a<90&&n>270&&--s;var c=e*(s*360+n-r);return t.prevDeg=r+c,c}function C1(n,e,t,r){return D0(In(r.startAbsoluteOrigin,[n,e])/Math.PI*180,t,r)}function I1(n,e,t,r,i,a){var s=n.props.throttleRotate,c=s===void 0?0:s,u=t.prevSnapDeg,d=0,h=!1;if(a){var p=YJ(n,e,r,i+r);h=p.isSnap,d=i+p.dist}h||(d=st(i+r,c));var m=d-i;return t.prevSnapDeg=m,[m-u,m,d]}function pV(n,e,t){var r=te(e,4),i=r[0],a=r[1],s=r[2],c=r[3];if(n==="none")return[];if(Gn(n))return n.map(function(E){return pV(E,[i,a,s,c],t)[0]});var u=te((n||"top").split("-"),2),d=u[0],h=u[1],p=[i,a];d==="left"?p=[s,i]:d==="right"?p=[a,c]:d==="bottom"&&(p=[c,s]);var m=[(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2],b=EV(p,t);if(h){var _=h==="top"||h==="left",w=d==="bottom"||d==="left";m=p[_&&!w||!_&&w?0:1]}return[[m,b]]}function pw(n,e){if(e.isRequest)return e.requestAble==="rotatable";var t=e.inputEvent.target;if(Yn(t,He("rotation-control"))||n.props.rotateAroundControls&&Yn(t,He("around-control"))||Yn(t,He("control"))&&Yn(t,He("rotatable")))return!0;var r=n.props.rotationTarget;return r?nT(r,!0).some(function(i){return i?t===i||t.contains(i):!1}):!1}var MJ=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,PJ={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[MJ],viewClassName:function(n){return n.isDragging("rotatable")?He("view-rotation-dragging"):""},render:function(n,e){var t=Mc(n.props,"rotatable"),r=t.rotatable,i=t.rotationPosition,a=t.zoom,s=t.renderDirections,c=t.rotateAroundControls,u=t.resolveAblesWithRotatable,d=n.getState(),h=d.renderPoses,p=d.direction;if(!r)return null;var m=pV(i,h,p),b=[];if(m.forEach(function(T,C){var k=te(T,2),j=k[0],P=k[1];b.push(e.createElement("div",{key:"rotation".concat(C),className:He("rotation"),style:{transform:"translate(-50%) translate(".concat(j[0],"px, ").concat(j[1],"px) rotate(").concat(P,"rad)")}},e.createElement("div",{className:He("line rotation-line"),style:{transform:"scaleX(".concat(a,")")}}),e.createElement("div",{className:He("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(a,")")}})))}),s){var _=Bs(u||{}),w={};_.forEach(function(T){u[T].forEach(function(C){w[C]=T})});var E=[];Gn(s)&&(E=s.map(function(T){var C=w[T];return{data:C?{resolve:C}:{},classNames:C?["move"]:[],dir:T}})),b.push.apply(b,Ie([],te(Q3(n,"rotatable",E,e)),!1))}return c&&b.push.apply(b,Ie([],te(nV(n,e)),!1)),b},dragControlCondition:pw,dragControlStart:function(n,e){var t,r,i=e.datas,a=e.clientX,s=e.clientY,c=e.parentRotate,u=e.parentFlag,d=e.isPinch,h=e.isRequest,p=n.state,m=p.target,b=p.left,_=p.top,w=p.direction,E=p.beforeDirection,T=p.targetTransform,C=p.moveableClientRect,k=p.offsetMatrix,j=p.targetMatrix,P=p.allMatrix,N=p.width,A=p.height;if(!h&&!m)return!1;var I=n.getRect();i.rect=I,i.transform=T,i.left=b,i.top=_;var D=function(oe){var ue=hV(n.state,oe);i.fixedDirection=ue.fixedDirection,i.fixedOffset=ue.fixedOffset,i.fixedPosition=ue.fixedPosition,F&&F.setFixedPosition(oe)},z=function(oe){var ue=NJ(n.state,oe);i.fixedDirection=ue.fixedDirection,i.fixedOffset=ue.fixedOffset,i.fixedPosition=ue.fixedPosition,F&&F.setFixedDirection(oe)},V=a,B=s;if(h||d||u){var O=c||0;i.beforeInfo={origin:I.beforeOrigin,prevDeg:O,defaultDeg:O,prevSnapDeg:0,startDist:0},i.afterInfo=J(J({},i.beforeInfo),{origin:I.origin}),i.absoluteInfo=J(J({},i.beforeInfo),{origin:I.origin,startValue:O})}else{var X=(r=e.inputEvent)===null||r===void 0?void 0:r.target;if(X){var K=X.getAttribute("data-direction")||"",$=BZ[K];if($){i.isControl=!0,i.isAroundControl=Yn(X,He("around-control")),i.controlDirection=$;var W=X.getAttribute("data-resolve");W&&(i.resolveAble=W);var ee=cee(p.rootMatrix,p.renderPoses,C);t=te(Kn(ee,$),2),V=t[0],B=t[1]}}i.beforeInfo={origin:I.beforeOrigin},i.afterInfo={origin:I.origin},i.absoluteInfo={origin:I.origin,startValue:I.rotation};var ie=D;D=function(oe){var ue=p.is3d?4:3,ye=te(It(k3(j,ue),oe),2),me=ye[0],Te=ye[1],Me=br(k,kc([me,Te],ue)),ae=br(P,kc([oe[0],oe[1]],ue));ie(oe);var Ce=p.posDelta;i.beforeInfo.origin=We(Me,Ce),i.afterInfo.origin=We(ae,Ce),i.absoluteInfo.origin=We(ae,Ce),A1(n,i.beforeInfo,V,B,C),A1(n,i.afterInfo,V,B,C),A1(n,i.absoluteInfo,V,B,C)},z=function(oe){var ue=Kn([[0,0],[N,0],[0,A],[N,A]],oe);D(ue)}}i.startClientX=V,i.startClientY=B,i.direction=w,i.beforeDirection=E,i.startValue=0,i.datas={},Ey(n,e,"rotate");var H=!1,F=!1;if(i.isControl&&i.resolveAble){var Y=i.resolveAble;Y==="resizable"&&(F=hw.dragControlStart(n,J(J({},new Cd("resizable").dragStart([0,0],e)),{parentPosition:i.controlPosition,parentFixedPosition:i.fixedPosition})))}F||(H=Tr.dragStart(n,new Cd().dragStart([0,0],e))),D(uee(n));var ne=dt(n,e,J(J({set:function(oe){i.startValue=oe*Math.PI/180},setFixedDirection:z,setFixedPosition:D},Sy(n,e)),{dragStart:H,resizeStart:F})),Z=je(n,"onRotateStart",ne);return i.isRotate=Z!==!1,p.snapRenderInfo={request:e.isRequest},i.isRotate?ne:!1},dragControl:function(n,e){var t,r,i,a=e.datas,s=e.clientDistX,c=e.clientDistY,u=e.parentRotate,d=e.parentFlag,h=e.isPinch,p=e.groupDelta,m=e.resolveMatrix,b=a.beforeDirection,_=a.beforeInfo,w=a.afterInfo,E=a.absoluteInfo,T=a.isRotate,C=a.startValue,k=a.rect,j=a.startClientX,P=a.startClientY;if(T){_y(n,e,"rotate");var N=UZ(e),A=b*N,I=n.props.parentMoveable,D=0,z,V,B=0,O,X,K=0,$,W,ee=180/Math.PI*C,ie=E.startValue,H=!1,F=j+s,Y=P+c;if(!d&&"parentDist"in e){var ne=e.parentDist;z=ne,O=ne,$=ne}else h||d?(z=D0(u,b,_),O=D0(u,A,w),$=D0(u,A,E)):(z=C1(F,Y,b,_),O=C1(F,Y,A,w),$=C1(F,Y,A,E),H=!0);if(V=ee+z,X=ee+O,W=ie+$,je(n,"onBeforeRotate",dt(n,e,{beforeRotation:V,rotation:X,absoluteRotation:W,setRotation:function(Ne){O=Ne-ee,z=O,$=O}},!0)),t=te(I1(n,k,_,z,ee,H),3),D=t[0],z=t[1],V=t[2],r=te(I1(n,k,w,O,ee,H),3),B=r[0],O=r[1],X=r[2],i=te(I1(n,k,E,$,ie,H),3),K=i[0],$=i[1],W=i[2],!(!K&&!B&&!D&&!I&&!m)){var Z=wy(a,"rotate(".concat(X,"deg)"),"rotate(".concat(O,"deg)"));m&&(a.fixedPosition=qE(n,a.targetAllTransform,a.fixedDirection,a.fixedOffset,a));var oe=ZZ(n,O,a),ue=We(It(p||[0,0],oe),a.prevInverseDist||[0,0]);a.prevInverseDist=oe,a.requestValue=null;var ye=K3(n,Z,ue,h,e),me=ye,Te=ks([F,Y],E.startAbsoluteOrigin)-E.startDist,Me=void 0;if(a.resolveAble==="resizable"){var ae=hw.dragControl(n,J(J({},lg(e,n.state,[e.deltaX,e.deltaY],!!h,!1,"resizable")),{resolveMatrix:!0,parentDistance:Te}));ae&&(Me=ae,me=IV(me,ae,e))}var Ce=dt(n,e,J(J({delta:B,dist:O,rotate:X,rotation:X,beforeDist:z,beforeDelta:D,beforeRotate:V,beforeRotation:V,absoluteDist:$,absoluteDelta:K,absoluteRotate:W,absoluteRotation:W,isPinch:!!h,resize:Me},ye),me));return je(n,"onRotate",Ce),Ce}}},dragControlEnd:function(n,e){var t=e.datas;if(t.isRotate){t.isRotate=!1;var r=ui(n,e,{});return je(n,"onRotateEnd",r),r}},dragGroupControlCondition:pw,dragGroupControlStart:function(n,e){var t=e.datas,r=n.state,i=r.left,a=r.top,s=r.beforeOrigin,c=this.dragControlStart(n,e);if(!c)return!1;c.set(t.beforeDirection*n.rotation);var u=Ds(n,this,"dragControlStart",e,function(p,m){var b=p.state,_=b.left,w=b.top,E=b.beforeOrigin,T=It(We([_,w],[i,a]),We(E,s));return m.datas.startGroupClient=T,m.datas.groupClient=T,J(J({},m),{parentRotate:0})}),d=J(J({},c),{targets:n.props.targets,events:u}),h=je(n,"onRotateGroupStart",d);return t.isRotate=h!==!1,t.isRotate?c:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isRotate){Ry(n,"onBeforeRotate",function(d){je(n,"onBeforeRotateGroup",dt(n,e,J(J({},d),{targets:n.props.targets}),!0))});var r=this.dragControl(n,e);if(r){var i=t.beforeDirection,a=r.beforeDist,s=a/180*Math.PI,c=Ds(n,this,"dragControl",e,function(d,h){var p=h.datas.startGroupClient,m=te(h.datas.groupClient,2),b=m[0],_=m[1],w=te(ig(p,s*i),2),E=w[0],T=w[1],C=[E-b,T-_];return h.datas.groupClient=[E,T],J(J({},h),{parentRotate:a,groupDelta:C})});n.rotation=i*r.beforeRotation;var u=J({targets:n.props.targets,events:c,set:function(d){n.rotation=d},setGroupRotation:function(d){n.rotation=d}},r);return je(n,"onRotateGroup",u),u}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isRotate){this.dragControlEnd(n,e);var i=Ds(n,this,"dragControlEnd",e),a=ui(n,e,{targets:n.props.targets,events:i});return je(n,"onRotateGroupEnd",a),t}},request:function(n){var e={},t=0,r=n.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(i){return"deltaRotate"in i?t+=i.deltaRotate:"rotate"in i&&(t=i.rotate-r),{datas:e,parentDist:t}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function OJ(n,e){var t,r=n.direction,i=n.classNames,a=n.size,s=n.pos,c=n.zoom,u=n.key,d=r==="horizontal",h=d?"Y":"X";return e.createElement("div",{key:u,className:i.join(" "),style:(t={},t[d?"width":"height"]="".concat(a),t.transform="translate(".concat(s[0],", ").concat(s[1],") translate").concat(h,"(-50%) scale").concat(h,"(").concat(c,")"),t)})}function WE(n,e){return OJ(J(J({},n),{classNames:Ie([He("line","guideline",n.direction)],te(n.classNames),!1).filter(function(t){return t}),size:n.size||"".concat(n.sizeValue,"px"),pos:n.pos||n.posValue.map(function(t){return"".concat(st(t,.1),"px")})}),e)}function XD(n,e,t,r,i,a,s,c){var u=n.props.zoom;return t.map(function(d,h){var p=d.type,m=d.pos,b=[0,0];return b[s]=r,b[s?0:1]=-i+m,WE({key:"".concat(e,"TargetGuideline").concat(h),classNames:[He("target","bold",p)],posValue:b,sizeValue:a,zoom:u,direction:e},c)})}function WD(n,e,t,r,i,a){var s=n.props,c=s.zoom,u=s.isDisplayInnerSnapDigit,d=e==="horizontal"?ll:cl,h=i[d.start],p=i[d.end];return t.filter(function(m){var b=m.hide,_=m.elementRect;if(b)return!1;if(u&&_){var w=_.rect;if(w[d.start]<=h&&p<=w[d.end])return!1}return!0}).map(function(m,b){var _=m.pos,w=m.size,E=m.element,T=m.className,C=[-r[0]+_[0],-r[1]+_[1]];return WE({key:"".concat(e,"-default-guideline-").concat(b),classNames:E?[He("bold"),T]:[He("normal"),T],direction:e,posValue:C,sizeValue:w,zoom:c},a)})}function bh(n,e,t,r,i,a,s,c){var u,d=n.props,h=d.snapDigit,p=h===void 0?0:h,m=d.isDisplaySnapDigit,b=m===void 0?!0:m,_=d.snapDistFormat,w=_===void 0?function(P,N){return P}:_,E=d.zoom,T=e==="horizontal"?"X":"Y",C=e==="vertical"?"height":"width",k=Math.abs(i),j=b?parseFloat(k.toFixed(p)):0;return c.createElement("div",{key:"".concat(e,"-").concat(t,"-guideline-").concat(r),className:He("guideline-group",e),style:(u={left:"".concat(a[0],"px"),top:"".concat(a[1],"px")},u[C]="".concat(k,"px"),u)},WE({direction:e,classNames:[He(t),s],size:"100%",posValue:[0,0],sizeValue:k,zoom:E},c),c.createElement("div",{className:He("size-value","gap"),style:{transform:"translate".concat(T,"(-50%) scale(").concat(E,")")}},j>0?w(j,e):""))}function jJ(n,e,t,r){var i=n==="vertical"?0:1,a=n==="vertical"?1:0,s=i?ll:cl,c=t[s.start],u=t[s.end];return RV(e,function(d){return d.pos[i]}).map(function(d){var h=[],p=[],m=[];return d.forEach(function(b){var _,w,E=b.element,T=b.elementRect.rect;if(T[s.end]<c)h.push(b);else if(u<T[s.start])p.push(b);else if(T[s.start]<=c&&u<=T[s.end]&&r){var C=b.pos,k={element:E,rect:J(J({},T),(_={},_[s.end]=T[s.start],_))},j={element:E,rect:J(J({},T),(w={},w[s.start]=T[s.end],w))},P=[0,0],N=[0,0];P[i]=C[i],P[a]=C[a],N[i]=C[i],N[a]=C[a]+b.size,h.push({type:n,pos:P,size:0,elementRect:k,direction:"",elementDirection:"end"}),p.push({type:n,pos:N,size:0,elementRect:j,direction:"",elementDirection:"start"})}}),h.sort(function(b,_){return _.pos[a]-b.pos[a]}),p.sort(function(b,_){return b.pos[a]-_.pos[a]}),{total:d,start:h,end:p,inner:m}})}function VJ(n,e,t,r,i){var a=n.props.isDisplayInnerSnapDigit,s=[];return["vertical","horizontal"].forEach(function(c){var u=e.filter(function(E){return E.type===c}),d=c==="vertical"?1:0,h=d?0:1,p=jJ(c,u,r,a),m=d?cl:ll,b=d?ll:cl,_=r[m.start],w=r[m.end];p.forEach(function(E){var T=E.total,C=E.start,k=E.end,j=E.inner,P=t[h]+T[0].pos[h]-r[b.start],N=r;C.forEach(function(A){var I=A.elementRect.rect,D=N[m.start]-I[m.end];if(D>0){var z=[0,0];z[d]=t[d]+N[m.start]-_-D,z[h]=P,s.push(bh(n,c,"dashed",s.length,D,z,A.className,i))}N=I}),N=r,k.forEach(function(A){var I=A.elementRect.rect,D=I[m.start]-N[m.end];if(D>0){var z=[0,0];z[d]=t[d]+N[m.end]-_,z[h]=P,s.push(bh(n,c,"dashed",s.length,D,z,A.className,i))}N=I}),j.forEach(function(A){var I=A.elementRect.rect,D=_-I[m.start],z=I[m.end]-w,V=[0,0],B=[0,0];V[d]=t[d]-D,V[h]=P,B[d]=t[d]+w-_,B[h]=P,s.push(bh(n,c,"dashed",s.length,D,V,A.className,i)),s.push(bh(n,c,"dashed",s.length,z,B,A.className,i))})})}),s}function zJ(n,e,t,r,i){var a=[];return["horizontal","vertical"].forEach(function(s){var c=e.filter(function(E){return E.type===s}).slice(0,1),u=s==="vertical"?0:1,d=u?0:1,h=u?cl:ll,p=u?ll:cl,m=r[h.start],b=r[h.end],_=r[p.start],w=r[p.end];c.forEach(function(E){var T=E.gap,C=E.gapRects,k=Math.max.apply(Math,Ie([_],te(C.map(function(N){var A=N.rect;return A[p.start]})),!1)),j=Math.min.apply(Math,Ie([w],te(C.map(function(N){var A=N.rect;return A[p.end]})),!1)),P=(k+j)/2;k===j||P===(_+w)/2||C.forEach(function(N){var A=N.rect,I=N.className,D=[t[0],t[1]];if(A[h.end]<m)D[u]+=A[h.end]-m;else if(b<A[h.start])D[u]+=A[h.start]-m-T;else return;D[d]+=P-_,a.push(bh(n,u?"vertical":"horizontal","gap",a.length,T,D,I,i))})})}),a}function gw(n){var e,t,r=n.state,i=r.containerClientRect,a=r.hasFixed,s=i.overflow,c=i.scrollHeight,u=i.scrollWidth,d=i.clientHeight,h=i.clientWidth,p=i.clientLeft,m=i.clientTop,b=n.props,_=b.snapGap,w=_===void 0?!0:_,E=b.verticalGuidelines,T=b.horizontalGuidelines,C=b.snapThreshold,k=C===void 0?5:C,j=b.maxSnapElementGuidelineDistance,P=j===void 0?1/0:j,N=b.isDisplayGridGuidelines,A=Oi(zi(n.state)),I=A.top,D=A.left,z=A.bottom,V=A.right,B={top:I,left:D,bottom:z,right:V,center:(D+V)/2,middle:(I+z)/2},O=FJ(n),X=Ie([],te(O),!1),K=((t=(e=r.snapThresholdInfo)===null||e===void 0?void 0:e.multiples)!==null&&t!==void 0?t:[1,1]).map(function(ie){return ie*k});w&&X.push.apply(X,Ie([],te(LJ(n,B,K)),!1));var $=J({},r.snapOffset||{left:0,top:0,bottom:0,right:0});if(X.push.apply(X,Ie([],te(UJ(n,s?u:h,s?c:d,p,m,$,N)),!1)),a){var W=i.left,ee=i.top;$.left+=W,$.top+=ee,$.right+=W,$.bottom+=ee}return X.push.apply(X,Ie([],te(mV(T||!1,E||!1,s?u:h,s?c:d,p,m,$)),!1)),X=X.filter(function(ie){var H=ie.element,F=ie.elementRect,Y=ie.type;if(!H||!F)return!0;var ne=F.rect;return gV(B,ne,Y,P)}),X}function LJ(n,e,t){var r=n.props,i=r.maxSnapElementGuidelineDistance,a=i===void 0?1/0:i,s=r.maxSnapElementGapDistance,c=s===void 0?1/0:s,u=n.state.elementRects,d=[];return[["vertical",ll,cl],["horizontal",cl,ll]].forEach(function(h){var p=te(h,3),m=p[0],b=p[1],_=p[2],w=e[b.start],E=e[b.end],T=e[b.center],C=e[_.start],k=e[_.end],j={left:t[0],top:t[1]};function P(I){var D=I.rect,z=j[b.start];return D[b.end]<w+z?w-D[b.end]:E-z<D[b.start]?D[b.start]-E:-1}var N=u.filter(function(I){var D=I.rect;return D[_.start]>k||D[_.end]<C?!1:P(I)>0}).sort(function(I,D){return P(I)-P(D)}),A=[];N.forEach(function(I){N.forEach(function(D){if(I!==D){var z=I.rect,V=D.rect,B=z[_.start],O=z[_.end],X=V[_.start],K=V[_.end];B>K||X>O||A.push([I,D])}})}),A.forEach(function(I){var D=te(I,2),z=D[0],V=D[1],B=z.rect,O=V.rect,X=B[b.start],K=B[b.end],$=O[b.start],W=O[b.end],ee=j[b.start],ie=0,H=0,F=!1,Y=!1,ne=!1;if(K<=w&&E<=$){if(Y=!0,ie=($-K-(E-w))/2,H=K+ie+(E-w)/2,we(H-T)>ee)return}else if(K<$&&W<w+ee){if(F=!0,ie=$-K,H=W+ie,we(H-w)>ee)return}else if(K<$&&E-ee<X){if(ne=!0,ie=$-K,H=X-ie,we(H-E)>ee)return}else return;ie&&gV(e,O,m,a)&&(ie>c||d.push({type:m,pos:m==="vertical"?[H,0]:[0,H],element:V.element,size:0,className:V.className,isStart:F,isCenter:Y,isEnd:ne,gap:ie,hide:!0,gapRects:[z,V],direction:"",elementDirection:""}))})}),d}function BJ(n,e,t,r){var i,a,s=n.props,c=n.state,u=s.snapGridAll,d=s.snapGridWidth,h=d===void 0?0:d,p=s.snapGridHeight,m=p===void 0?0:p,b=c.snapRenderInfo,_=b&&(((i=b.direction)===null||i===void 0?void 0:i[0])||((a=b.direction)===null||a===void 0?void 0:a[1])),w=n.moveables;if(u&&w&&_&&(h||m)){if(c.snapThresholdInfo)return;c.snapThresholdInfo={multiples:[1,1],offset:[0,0]};var E=n.getRect(),T=E.children,C=b.direction;if(T){var k=C.map(function(P,N){var A=N===0?{snapSize:h,posName:"left",sizeName:"width",clientOffset:r.left-e}:{snapSize:m,posName:"top",sizeName:"height",clientOffset:r.top-t},I=A.snapSize,D=A.posName,z=A.sizeName,V=A.clientOffset;if(!I)return{dir:P,multiple:1,snapSize:I,snapOffset:0};var B=E[z],O=E[D],X=a3(T.map(function(F){return[F[D]-O,F[z],B-F[z]-F[D]+O]})).filter(function(F){return F}).sort(function(F,Y){return F-Y}),K=X[0],$=X.map(function(F){return st(F/K,.1)*I}),W=1,ee=st(B/K,.1);for(W=1;W<=10&&!$.every(function(F){return F*W%1===0});++W);var ie=(-P+1)/2,H=yv(O-V,O-V+B,ie,1-ie);return{multiple:ee*W,dir:P,snapSize:I,snapOffset:Math.round(H/I)}}),j=k.map(function(P){return P.multiple||1});c.snapThresholdInfo.multiples=j,c.snapThresholdInfo.offset=k.map(function(P){return P.snapOffset}),k.forEach(function(P,N){P.snapSize})}}else c.snapThresholdInfo=null}function UJ(n,e,t,r,i,a,s){r===void 0&&(r=0),i===void 0&&(i=0);var c=n.props,u=n.state,d=c.snapGridWidth,h=d===void 0?0:d,p=c.snapGridHeight,m=p===void 0?0:p,b=[],_=a.left,w=a.top,E=[0,0];BJ(n,r,i,a);var T=u.snapThresholdInfo,C=h,k=m;if(T&&(h*=T.multiples[0]||1,m*=T.multiples[1]||1,E=T.offset),m){for(var j=function(N){b.push({type:"horizontal",pos:[_,st(E[1]*k+N-i+w,.1)],className:He("grid-guideline"),size:e,hide:!s,direction:"",grid:!0})},P=0;P<=t*2;P+=m)j(P);for(var P=-m;P>=-t;P-=m)j(P)}if(h){for(var j=function(A){b.push({type:"vertical",pos:[st(E[0]*C+A-r+_,.1),w],className:He("grid-guideline"),size:t,hide:!s,direction:"",grid:!0})},P=0;P<=e*2;P+=h)j(P);for(var P=-h;P>=-e;P-=h)j(P)}return b}function gV(n,e,t,r){return t==="horizontal"?we(n.right-e.left)<=r||we(n.left-e.right)<=r||n.left<=e.right&&e.left<=n.right:t==="vertical"?we(n.bottom-e.top)<=r||we(n.top-e.bottom)<=r||n.top<=e.bottom&&e.top<=n.bottom:!0}function FJ(n){var e=n.state,t=n.props.elementGuidelines,r=t===void 0?[]:t;if(!r.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter(function(m){return!m.refresh}),a=r.map(function(m){return la(m)&&"element"in m?J(J({},m),{element:Ha(m.element,!0)}):{element:Ha(m,!0)}}).filter(function(m){return m.element}),s=eZ(i.map(function(m){return m.element}),a.map(function(m){return m.element})),c=s.maintained,u=s.added,d=[];c.forEach(function(m){var b=te(m,2),_=b[0],w=b[1];d[w]=i[_]}),GJ(n,u.map(function(m){return a[m]})).map(function(m,b){d[u[b]]=m}),e.elementRects=d;var h=HE(n.props.elementSnapDirections),p=[];return d.forEach(function(m){var b=m.element,_=m.top,w=_===void 0?h.top:_,E=m.left,T=E===void 0?h.left:E,C=m.right,k=C===void 0?h.right:C,j=m.bottom,P=j===void 0?h.bottom:j,N=m.center,A=N===void 0?h.center:N,I=m.middle,D=I===void 0?h.middle:I,z=m.className,V=m.rect,B=YE({top:w,right:k,left:T,bottom:P,center:A,middle:D},V),O=B.horizontal,X=B.vertical,K=B.horizontalNames,$=B.verticalNames,W=V.top,ee=V.left,ie=V.right-ee,H=V.bottom-W,F=[ie,H];X.forEach(function(Y,ne){p.push({type:"vertical",element:b,pos:[st(Y,.1),W],size:H,sizes:F,className:z,elementRect:m,elementDirection:UD[$[ne]]||$[ne],direction:""})}),O.forEach(function(Y,ne){p.push({type:"horizontal",element:b,pos:[ee,st(Y,.1)],size:ie,sizes:F,className:z,elementRect:m,elementDirection:UD[K[ne]]||K[ne],direction:""})})}),p}function QD(n,e){return n?n.map(function(t){var r=la(t)?t:{pos:t},i=r.pos;return Td(i)?r:J(J({},r),{pos:Ht(i,e)})}):[]}function mV(n,e,t,r,i,a,s){i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s={left:0,top:0,right:0,bottom:0});var c=[],u=s.left,d=s.top,h=s.bottom,p=s.right,m=t+p-u,b=r+h-d;return QD(n,b).forEach(function(_){c.push({type:"horizontal",pos:[u,st(_.pos-a+d,.1)],size:m,className:_.className,direction:""})}),QD(e,m).forEach(function(_){c.push({type:"vertical",pos:[st(_.pos-i+u,.1),d],size:b,className:_.className,direction:""})}),c}function GJ(n,e){if(!e.length)return[];var t=n.props.groupable,r=n.state,i=r.containerClientRect,a=r.rootMatrix,s=r.is3d,c=r.offsetDelta,u=s?4:3,d=te(hJ(a,i,u),2),h=d[0],p=d[1],m=t?0:c[0],b=t?0:c[1];return e.map(function(_){var w=_.element.getBoundingClientRect(),E=w.left-h-m,T=w.top-p-b,C=T+w.height,k=E+w.width,j=te(kd(a,[E,T],u),2),P=j[0],N=j[1],A=te(kd(a,[k,C],u),2),I=A[0],D=A[1];return J(J({},_),{rect:{left:P,right:I,top:N,bottom:D,center:(P+I)/2,middle:(N+D)/2}})})}function n0(n){var e=n.state,t=e.container,r=n.props.snapContainer||t;if(e.snapContainer===r&&e.guidelines&&e.guidelines.length)return!1;var i=e.containerClientRect,a={left:0,top:0,bottom:0,right:0};if(t!==r){var s=Ha(r,!0);if(s){var c=Fh(s),u=rN(e,[c.left-i.left,c.top-i.top]),d=rN(e,[c.right-i.right,c.bottom-i.bottom]);a.left=st(u[0],1e-5),a.top=st(u[1],1e-5),a.right=st(d[0],1e-5),a.bottom=st(d[1],1e-5)}}return e.snapContainer=r,e.snapOffset=a,e.guidelines=gw(n),e.enableSnap=!0,!0}function vV(n,e,t,r,i,a){var s=Lc(n,e,t,a?4:3),c=Kn(s,r);return ZE(s,We(i,c))}function ZD(n){return n?n/we(n):0}function qJ(n,e,t,r,i,a){var s=a.fixedDirection,c=vJ(t,s,r),u=XE(n,e,t,r),d=Ie(Ie([],te(RJ(n,e,c,r,i,a)),!1),te(dV(n,u,a)),!1),h=Ev(d,0),p=Ev(d,1);return{width:{isBound:h.isBound,offset:h.offset[0]},height:{isBound:p.isBound,offset:p.offset[1]}}}function $J(n,e,t,r,i,a,s,c,u){var d=Kn(e,s),h=Cy(n,c,{vertical:[d[0]],horizontal:[d[1]]}),p=h.horizontal.offset,m=h.vertical.offset;if(st(m,lw)||st(p,lw)){var b=te(Ja({datas:u,distX:-m,distY:-p}),2),_=b[0],w=b[1],E=Math.min(i||1/0,t+s[0]*_),T=Math.min(a||1/0,r+s[1]*w);return[E-t,T-r]}return[0,0]}function yV(n,e,t,r,i,a,s,c){for(var u=zi(n.state),d=n.props.keepRatio,h=0,p=0,m=0;m<2;++m){var b=e(h,p),_=qJ(n,b,i,d,s,c),w=_.width,E=_.height,T=w.isBound,C=E.isBound,k=w.offset,j=E.offset;if(m===1&&(T||(k=0),C||(j=0)),m===0&&s&&!T&&!C)return[0,0];if(d){var P=we(k)*(t?1/t:1),N=we(j)*(r?1/r:1),A=T&&C?P<N:C||!T&&P<N;A?k=t*j/r:j=r*k/t}h+=k,p+=j}if(!d&&i[0]&&i[1]){var I=DJ(n,u,i,a,c),D=I.maxWidth,z=I.maxHeight,V=te($J(n,e(h,p).map(function(X){return X.map(function(K){return st(K,lw)})}),t+h,r+p,D,z,i,s,c),2),k=V[0],j=V[1];h+=k,p+=j}return[h,p]}function Bh(n){return n<0&&(n=n%360+360),n%=360,n}function HJ(n,e){e=Bh(e);var t=Math.floor(n/360),r=t*360+360-e,i=t*360+e;return we(n-r)<we(n-i)?r:i}function R1(n,e){n=Bh(n),e=Bh(e);var t=Bh(n-e);return Math.min(t,360-t)}function YJ(n,e,t,r){var i,a=n.props,s=(i=a[rV])!==null&&i!==void 0?i:5,c=a[iV];if(Zd(n,"rotatable")){var u=e.pos1,d=e.pos2,h=e.pos3,p=e.pos4,m=e.origin,b=t*Math.PI/180,_=[u,d,h,p].map(function(j){return We(j,m)}),w=_.map(function(j){return ig(j,b)}),E=Ie(Ie([],te(cJ(n,_,w,m,t)),!1),te(SJ(n,_,w,m,t)),!1);E.sort(function(j,P){return we(j-t)-we(P-t)});var T=E.length>0;if(T)return{isSnap:T,dist:T?E[0]:t}}if(c?.length&&s){var C=c.slice().sort(function(j,P){return R1(j,r)-R1(P,r)}),k=C[0];if(R1(k,r)<=s)return{isSnap:!0,dist:t+HJ(r,k)-r}}return{isSnap:!1,dist:t}}function KJ(n,e,t,r,i,a,s){if(!Zd(n,"resizable"))return[0,0];var c=s.fixedDirection,u=s.nextAllMatrix,d=n.state,h=d.allMatrix,p=d.is3d;return yV(n,function(m,b){return vV(u||h,e+m,t+b,c,i,p)},e,t,r,i,a,s)}function XJ(n,e,t,r,i){if(!Zd(n,"scalable"))return[0,0];var a=i.startOffsetWidth,s=i.startOffsetHeight,c=i.fixedPosition,u=i.fixedDirection,d=i.is3d,h=yV(n,function(p,m){return vV(KZ(i,It(e,[p/a,m/s])),a,s,u,c,d)},a,s,t,c,r,i);return[h[0]/a,h[1]/s]}function WJ(n,e){e.absolutePoses=zi(n.state)}function JD(n){var e=[];return n.forEach(function(t){t.guidelineInfos.forEach(function(r){var i=r.guideline;qr(e,function(a){return a.guideline===i})||(i.direction="",e.push({guideline:i,posInfo:t}))})}),e.map(function(t){var r=t.guideline,i=t.posInfo;return J(J({},r),{direction:i.direction})})}function eN(n,e,t,r,i,a){var s=$E(Ty(n,a),e,t),c=s.vertical,u=s.horizontal,d=Ku();c.forEach(function(_){_.isBound&&(_.direction==="start"&&(d.left=!0),_.direction==="end"&&(d.right=!0),r.push({type:"bounds",pos:_.pos}))}),u.forEach(function(_){_.isBound&&(_.direction==="start"&&(d.top=!0),_.direction==="end"&&(d.bottom=!0),i.push({type:"bounds",pos:_.pos}))});var h=EJ(n),p=h.boundMap,m=h.vertical,b=h.horizontal;return m.forEach(function(_){Ls(r,function(w){var E=w.type,T=w.pos;return E==="bounds"&&T===_})>=0||r.push({type:"bounds",pos:_})}),b.forEach(function(_){Ls(i,function(w){var E=w.type,T=w.pos;return E==="bounds"&&T===_})>=0||i.push({type:"bounds",pos:_})}),{boundMap:d,innerBoundMap:p}}var QJ=tT("",["resizable","scalable"]),ZJ={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold","snapGridAll",rV,iV,aV,sV,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(n,e){var t=n.state,r=t.top,i=t.left,a=t.pos1,s=t.pos2,c=t.pos3,u=t.pos4,d=t.snapRenderInfo,h=n.props.snapRenderThreshold,p=h===void 0?1:h;if(!d||!d.render||!Zd(n,""))return Wu(n,"boundMap",Ku(),function(Z){return JSON.stringify(Z)}),Wu(n,"innerBoundMap",Ku(),function(Z){return JSON.stringify(Z)}),[];t.guidelines=gw(n);var m=Math.min(a[0],s[0],c[0],u[0]),b=Math.min(a[1],s[1],c[1],u[1]),_=d.externalPoses||[],w=zi(n.state),E=[],T=[],C=[],k=[],j=[],P=Oi(w),N=P.width,A=P.height,I=P.top,D=P.left,z=P.bottom,V=P.right,B={left:D,right:V,top:I,bottom:z,center:(D+V)/2,middle:(I+z)/2},O=_.length>0,X=O?Oi(_):{};if(!d.request){if(d.direction&&j.push(mJ(n,w,d.direction,p,p)),d.snap){var K=Oi(w);d.center&&(K.middle=(K.top+K.bottom)/2,K.center=(K.left+K.right)/2),j.push(FD(n,K,p,p))}O&&(d.center&&(X.middle=(X.top+X.bottom)/2,X.center=(X.left+X.right)/2),j.push(FD(n,X,p,p))),j.forEach(function(Z){var oe=Z.vertical.posInfos,ue=Z.horizontal.posInfos;E.push.apply(E,Ie([],te(oe.filter(function(ye){var me=ye.guidelineInfos;return me.some(function(Te){var Me=Te.guideline;return!Me.hide})}).map(function(ye){return{type:"snap",pos:ye.pos}})),!1)),T.push.apply(T,Ie([],te(ue.filter(function(ye){var me=ye.guidelineInfos;return me.some(function(Te){var Me=Te.guideline;return!Me.hide})}).map(function(ye){return{type:"snap",pos:ye.pos}})),!1)),C.push.apply(C,Ie([],te(JD(oe)),!1)),k.push.apply(k,Ie([],te(JD(ue)),!1))})}var $=eN(n,[D,V],[I,z],E,T),W=$.boundMap,ee=$.innerBoundMap;O&&eN(n,[X.left,X.right],[X.top,X.bottom],E,T,d.externalBounds);var ie=Ie(Ie([],te(C),!1),te(k),!1),H=ie.filter(function(Z){return Z.element&&!Z.gapRects}),F=ie.filter(function(Z){return Z.gapRects}).sort(function(Z,oe){return Z.gap-oe.gap});je(n,"onSnap",{guidelines:ie.filter(function(Z){var oe=Z.element;return!oe}),elements:H,gaps:F},!0);var Y=Wu(n,"boundMap",W,function(Z){return JSON.stringify(Z)},Ku()),ne=Wu(n,"innerBoundMap",ee,function(Z){return JSON.stringify(Z)},Ku());return(W===Y||ee===ne)&&je(n,"onBound",{bounds:W,innerBounds:ee},!0),Ie(Ie(Ie(Ie(Ie(Ie([],te(VJ(n,H,[m,b],B,e)),!1),te(zJ(n,F,[m,b],B,e)),!1),te(WD(n,"horizontal",k,[i,r],B,e)),!1),te(WD(n,"vertical",C,[i,r],B,e)),!1),te(XD(n,"horizontal",T,m,r,N,0,e)),!1),te(XD(n,"vertical",E,b,i,A,1,e)),!1)},dragStart:function(n,e){n.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},n0(n)},drag:function(n){var e=n.state;n0(n)||(e.guidelines=gw(n)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart:function(n){this.unset(n)},dragEnd:function(n){this.unset(n)},dragControlCondition:function(n,e){if(QJ(n,e)||pw(n,e))return!0;if(!e.isRequest&&e.inputEvent)return Yn(e.inputEvent.target,He("snap-control"))},dragControlStart:function(n){n.state.snapRenderInfo=null,n0(n)},dragControl:function(n){this.drag(n)},dragControlEnd:function(n){this.unset(n)},dragGroupStart:function(n,e){this.dragStart(n,e)},dragGroup:function(n){this.drag(n)},dragGroupEnd:function(n){this.unset(n)},dragGroupControlStart:function(n){n.state.snapRenderInfo=null,n0(n)},dragGroupControl:function(n){this.drag(n)},dragGroupControlEnd:function(n){this.unset(n)},unset:function(n){var e=n.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function JJ(n,e){return[n[0]*e[0],n[1]*e[1]]}function He(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return KW.apply(void 0,Ie([UE],te(n),!1))}function bV(n){n()}function eee(n){return!n||n==="none"?[1,0,0,1,0,0]:la(n)?n:xp(n)}function Uh(n,e,t){return xv(e,Dc(t,e),n,Dc(t.map(function(r){return-r}),e))}function tee(n,e,t){if(e==="%"){var r=QE(n.ownerSVGElement);return r[t?"width":"height"]/100}return 1}function nee(n){var e=ree(JE(n,":before"));return e.map(function(t,r){var i=eg(t),a=i.value,s=i.unit;return a*tee(n,s,r===0)})}function Av(n){return n?n.split(" "):["0","0"]}function ree(n){return Av(n.transformOrigin)}function xV(n){var e=$r(n),t=e("transform");if(t&&t!=="none")return t;if("transform"in n){var r=n.transform,i=r.baseVal;if(!i)return"";var a=i.length;if(!a)return"";for(var s=[],c=function(d){var h=i[d].matrix;s.push("matrix(".concat(["a","b","c","d","e","f"].map(function(p){return h[p]}).join(", "),")"))},u=0;u<a;++u)c(u);return s.join(" ")}return""}function wp(n,e,t,r,i){var a,s,c=kE(n)||vl(n),u=!1,d,h;if(!n||t)d=n;else{var p=(a=n?.assignedSlot)===null||a===void 0?void 0:a.parentElement,m=n.parentElement;p?(u=!0,h=m,d=p):d=m}for(var b=!1,_=n===e||d===e,w="relative",E=1,T=parseFloat(i?.("zoom"))||1,C=i?.("position");d&&d!==c;){e===d&&(_=!0);var k=$r(d),j=d.tagName.toLowerCase(),P=xV(d),N=k("willChange"),A=parseFloat(k("zoom"))||1;if(w=k("position"),r&&A!==1){E=A;break}if(!t&&r&&T!==1&&C&&C!=="absolute"||j==="svg"||j==="foreignobject"||w!=="static"||P&&P!=="none"||N==="transform")break;var I=(s=n?.assignedSlot)===null||s===void 0?void 0:s.parentNode,D=d.parentNode;I&&(u=!0,h=D);var z=D;if(z&&z.nodeType===11){d=z.host,b=!0,w=$r(d)("position");break}d=z,w="relative"}return{offsetZoom:E,hasSlot:u,parentSlotElement:h,isCustomElement:b,isStatic:w==="static",isEnd:_||!d||d===c,offsetParent:d||c}}function iee(n,e){var t,r=n.tagName.toLowerCase(),i=n.offsetLeft,a=n.offsetTop,s=$r(n),c=vy(i),u=!c,d,h;return!u&&(r!=="svg"||n.ownerSVGElement)?(d=L3?nee(n):Av(s("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice(),u=!0,r==="svg"?(i=0,a=0):(t=te(oee(n,d,n===e&&e.tagName.toLowerCase()==="g"),4),i=t[0],a=t[1],d[0]=t[2],d[1]=t[3])):(d=Av(s("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice()),{tagName:r,isSVG:c,hasOffset:u,offset:[i||0,a||0],origin:d,targetOrigin:h}}function _V(n,e){var t=$r(n),r=$r(vl(n)),i=r("position");if(!e&&(!i||i==="static"))return[0,0];var a=parseInt(r("marginLeft"),10),s=parseInt(r("marginTop"),10);return t("position")==="absolute"&&((t("top")!=="auto"||t("bottom")!=="auto")&&(s=0),(t("left")!=="auto"||t("right")!=="auto")&&(a=0)),[a,s]}function mw(n){n.forEach(function(e){var t=e.matrix;t&&(e.matrix=ca(t,3,4))})}function aee(n){for(var e=n.parentElement,t=!1,r=vl(n);e;){var i=JE(e).transform;if(i&&i!=="none"){t=!0;break}if(e===r)break;e=e.parentElement}return{fixedContainer:e||r,hasTransform:t}}function Iy(n,e){return e===void 0&&(e=n.length>9),"".concat(e?"matrix3d":"matrix","(").concat(D3(n,!e).join(","),")")}function QE(n){var e=n.clientWidth,t=n.clientHeight;if(!n)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:t};var r=n.viewBox,i=r&&r.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||t,clientWidth:e,clientHeight:t}}function see(n,e){var t,r=QE(n),i=r.width,a=r.height,s=r.clientWidth,c=r.clientHeight,u=s/i,d=c/a,h=n.preserveAspectRatio.baseVal,p=h.align,m=h.meetOrSlice,b=[0,0],_=[u,d],w=[0,0];if(p!==1){var E=(p-2)%3,T=Math.floor((p-2)/3);b[0]=i*E/2,b[1]=a*T/2;var C=m===2?Math.max(d,u):Math.min(u,d);_[0]=C,_[1]=C,w[0]=(s-i)/2*E,w[1]=(c-a)/2*T}var k=VE(_,e);return t=te(w,2),k[e*(e-1)]=t[0],k[e*(e-1)+1]=t[1],Uh(k,e,b)}function oee(n,e,t){var r=n.tagName.toLowerCase();if(!n.getBBox||!t&&r==="g")return[0,0,0,0];var i=$r(n),a=i("transform-box")==="fill-box",s=n.getBBox(),c=QE(n.ownerSVGElement),u=s.x,d=s.y;r==="foreignobject"&&!u&&!d&&(u=parseFloat(n.getAttribute("x"))||0,d=parseFloat(n.getAttribute("y"))||0);var h=u-c.x,p=d-c.y,m=a?e[0]:e[0]-h,b=a?e[1]:e[1]-p;return[h,p,m,b]}function un(n,e,t){return br(n,kc(e,t),t)}function Lc(n,e,t,r){return[[0,0],[e,0],[0,t],[e,t]].map(function(i){return un(n,i,r)})}function Oi(n){var e=n.map(function(d){return d[0]}),t=n.map(function(d){return d[1]}),r=Math.min.apply(Math,Ie([],te(e),!1)),i=Math.min.apply(Math,Ie([],te(t),!1)),a=Math.max.apply(Math,Ie([],te(e),!1)),s=Math.max.apply(Math,Ie([],te(t),!1)),c=a-r,u=s-i;return{left:r,top:i,right:a,bottom:s,width:c,height:u}}function tN(n,e,t,r){var i=Lc(n,e,t,r);return Oi(i)}function lee(n,e,t,r,i){var a,s=n.target,c=n.origin,u=e.matrix,d=SV(s),h=d.offsetWidth,p=d.offsetHeight,m=t.getBoundingClientRect(),b=[0,0];t===vl(t)&&(b=_V(s,!0));for(var _=s.getBoundingClientRect(),w=_.left-m.left+t.scrollLeft-(t.clientLeft||0)+b[0],E=_.top-m.top+t.scrollTop-(t.clientTop||0)+b[1],T=_.width,C=_.height,k=xv(r,i,u),j=tN(k,h,p,r),P=j.left,N=j.top,A=j.width,I=j.height,D=un(k,c,r),z=We(D,[P,N]),V=[w+z[0]*T/A,E+z[1]*C/I],B=[0,0],O=0;++O<10;){var X=Xa(i,r);a=te(We(un(X,V,r),un(X,D,r)),2),B[0]=a[0],B[1]=a[1];var K=xv(r,i,Dc(B,r),u),$=tN(K,h,p,r),W=$.left,ee=$.top,ie=W-w,H=ee-E;if(we(ie)<2&&we(H)<2)break;V[0]-=ie,V[1]-=H}return B.map(function(F){return Math.round(F)})}function cee(n,e,t){var r=n.length===16,i=r?4:3,a=e.map(function(u){return un(n,u,i)}),s=t.left,c=t.top;return a.map(function(u){return[u[0]+s,u[1]+c]})}function Vi(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function wV(n,e){return Vi([e[0]-n[0],e[1]-n[1]])}function xh(n,e,t,r){t===void 0&&(t=1),r===void 0&&(r=In(n,e));var i=wV(n,e);return{transform:"translateY(-50%) translate(".concat(n[0],"px, ").concat(n[1],"px) rotate(").concat(r,"rad) scaleY(").concat(t,")"),width:"".concat(i,"px")}}function Cv(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=t.length,a=t.reduce(function(c,u){return c+u[0]},0)/i,s=t.reduce(function(c,u){return c+u[1]},0)/i;return{transform:"translateZ(0px) translate(".concat(a,"px, ").concat(s,"px) rotate(").concat(n,"rad) scale(").concat(e,")")}}function Mc(n,e){var t=n[e];return la(t)?J(J({},n),t):n}function SV(n){var e=n&&!vy(n.offsetWidth),t=0,r=0,i=0,a=0,s=0,c=0,u=0,d=0,h=0,p=0,m=0,b=0,_=1/0,w=1/0,E=1/0,T=1/0,C=0,k=0,j=!1;if(n)if(!e&&n.ownerSVGElement){var P=n.getBBox();j=!0,t=P.width,r=P.height,s=t,c=r,u=t,d=r,i=t,a=r}else{var N=$r(n),A=n.style,I=N("boxSizing")==="border-box",D=parseFloat(N("borderLeftWidth"))||0,z=parseFloat(N("borderRightWidth"))||0,V=parseFloat(N("borderTopWidth"))||0,B=parseFloat(N("borderBottomWidth"))||0,O=parseFloat(N("paddingLeft"))||0,X=parseFloat(N("paddingRight"))||0,K=parseFloat(N("paddingTop"))||0,$=parseFloat(N("paddingBottom"))||0,W=O+X,ee=K+$,ie=D+z,H=V+B,F=W+ie,Y=ee+H,ne=N("position"),Z=0,oe=0;if("clientLeft"in n){var ue=null;if(ne==="absolute"){var ye=wp(n,vl(n));ue=ye.offsetParent}else ue=n.parentElement;if(ue){var me=$r(ue);Z=parseFloat(me("width")),oe=parseFloat(me("height"))}}h=Math.max(W,Ht(N("minWidth"),Z)||0),p=Math.max(ee,Ht(N("minHeight"),oe)||0),_=Ht(N("maxWidth"),Z),w=Ht(N("maxHeight"),oe),isNaN(_)&&(_=1/0),isNaN(w)&&(w=1/0),C=Ht(A.width,0)||0,k=Ht(A.height,0)||0,s=parseFloat(N("width"))||0,c=parseFloat(N("height"))||0,u=we(s-C)<1?X_(h,C||s,_):s,d=we(c-k)<1?X_(p,k||c,w):c,t=u,r=d,i=u,a=d,I?(E=_,T=w,m=h,b=p,u=t-F,d=r-Y):(E=_+F,T=w+Y,m=h+F,b=p+Y,t=u+F,r=d+Y),i=u+W,a=d+ee}return{svg:j,offsetWidth:t,offsetHeight:r,clientWidth:i,clientHeight:a,contentWidth:u,contentHeight:d,inlineCSSWidth:C,inlineCSSHeight:k,cssWidth:s,cssHeight:c,minWidth:h,minHeight:p,maxWidth:_,maxHeight:w,minOffsetWidth:m,minOffsetHeight:b,maxOffsetWidth:E,maxOffsetHeight:T}}function EV(n,e){return In(e>0?n[0]:n[1],e>0?n[1]:n[0])}function r0(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function TV(n,e){var t=n===vl(n)||n===kE(n),r={clientLeft:n.clientLeft,clientTop:n.clientTop,clientWidth:n.clientWidth,clientHeight:n.clientHeight,scrollWidth:n.scrollWidth,scrollHeight:n.scrollHeight,overflow:!1};return t&&(r.clientHeight=Math.max(e.height,r.clientHeight),r.scrollHeight=Math.max(e.height,r.scrollHeight)),r.overflow=$r(n)("overflow")!=="visible",J(J({},e),r)}function k1(n,e,t,r){var i=n.left,a=n.right,s=n.top,c=n.bottom,u=e.top,d=e.left,h={left:d+i,top:u+s,right:d+a,bottom:u+c,width:a-i,height:c-s};return t&&r?TV(t,h):h}function Fh(n,e){var t=0,r=0,i=0,a=0;if(n){var s=n.getBoundingClientRect();t=s.left,r=s.top,i=s.width,a=s.height}var c={left:t,top:r,width:i,height:a,right:t+i,bottom:r+a};return n&&e?TV(n,c):c}function uee(n){var e=n.props,t=e.groupable,r=e.svgOrigin,i=n.getState(),a=i.offsetWidth,s=i.offsetHeight,c=i.svg,u=i.transformOrigin;return!t&&c&&r?rT(r,a,s):u}function AV(n,e,t,r){var i;if(n)i=n;else if(e)i=[0,0];else{var a=t.target;i=CV(a,r)}return i}function CV(n,e){if(n){var t=n.getAttribute("data-rotation")||"",r=n.getAttribute("data-direction");if(e.deg=t,!!r){var i=[0,0];return r.indexOf("w")>-1&&(i[0]=-1),r.indexOf("e")>-1&&(i[0]=1),r.indexOf("n")>-1&&(i[1]=-1),r.indexOf("s")>-1&&(i[1]=1),i}}}function ZE(n,e){return[It(e,n[0]),It(e,n[1]),It(e,n[2]),It(e,n[3])]}function zi(n){var e=n.left,t=n.top,r=n.pos1,i=n.pos2,a=n.pos3,s=n.pos4;return ZE([r,i,a,s],[e,t])}function vw(n,e){n[e?"controlAbles":"targetAbles"].forEach(function(t){t.unset&&t.unset(n)})}function Xu(n,e){var t=e?"controlGesto":"targetGesto",r=n[t];r?.isIdle()===!1&&vw(n,e),r?.unset(),n[t]=null}function Ir(n,e){if(e){var t=Qd(e);t.nextStyle=J(J({},t.nextStyle),n)}return{style:n,cssText:Bs(n).map(function(r){return"".concat(k0(r,"-"),": ").concat(n[r],";")}).join("")}}function IV(n,e,t){var r=e.afterTransform||e.transform;return J(J({},Ir(J(J(J({},n.style),e.style),{transform:r}),t)),{afterTransform:r,transform:n.transform})}function dt(n,e,t,r){var i=e.datas;i.datas||(i.datas={});var a=J(J({},t),{target:n.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:n,moveable:n,datas:i.datas,isRequest:e.isRequest,isRequestChild:e.isRequestChild,isFirstDrag:!!e.isFirstDrag,isTrusted:e.isTrusted!==!1,stopAble:function(){i.isEventStart=!1},stopDrag:function(){var s;(s=e.stop)===null||s===void 0||s.call(e)}});return i.isStartEvent?r||(i.lastEvent=a):i.isStartEvent=!0,a}function ui(n,e,t){var r=e.datas,i="isDrag"in t?t.isDrag:e.isDrag;return r.datas||(r.datas={}),J(J({isDrag:i},t),{moveable:n,target:n.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:n,lastEvent:r.lastEvent,isDouble:e.isDouble,datas:r.datas,isFirstDrag:!!e.isFirstDrag})}function Ry(n,e,t){n._emitter.on(e,t)}function je(n,e,t,r,i){return n.triggerEvent(e,t,r,i)}function JE(n,e){return Qo(n).getComputedStyle(n,e)}function i0(n,e,t){var r={},i={};return n.filter(function(a){var s=a.name;if(r[s]||!e.some(function(c){return a[c]}))return!1;if(!t&&a.ableGroup){if(i[a.ableGroup])return!1;i[a.ableGroup]=!0}return r[s]=!0,!0})}function yw(n,e){return n===e||n==null&&e==null}function nN(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(var t=n.length-1,r=0;r<t;++r){var i=n[r];if(!vy(i))return i}return n[t]}function RV(n,e){var t=[],r=[];return n.forEach(function(i,a){var s=e(i,a,n),c=r.indexOf(s),u=t[c]||[];c===-1&&(r.push(s),t.push(u)),u.push(i)}),t}function dee(n,e){var t=[],r={};return n.forEach(function(i,a){var s=e(i,a,n),c=r[s];c||(c=[],r[s]=c,t.push(c)),c.push(i)}),t}function kV(n){return n.reduce(function(e,t){return e.concat(t)},[])}function Rd(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return n.sort(function(t,r){return we(r)-we(t)}),n[0]}function kd(n,e,t){return br(Xa(n,t),kc(e,t),t)}function fee(n,e){var t,r=n.is3d,i=n.rootMatrix,a=r?4:3;return t=te(kd(i,[e.distX,e.distY],a),2),e.distX=t[0],e.distY=t[1],e}function Ai(n,e,t,r){if(!t[0]&&!t[1])return e;var i=un(n,[ZD(t[0]||1),0],r),a=un(n,[0,ZD(t[1]||1)],r),s=un(n,[t[0]/Vi(i),t[1]/Vi(a)],r);return It(e,s)}function Ji(n,e,t){return t?"".concat(n/e*100,"%"):"".concat(n,"px")}function Iv(n){return we(n)<=kr?0:n}function eT(n){return function(e){if(!e.isDragging(n))return"";var t=tJ(e,n),r=t.deg;return r?He("view-control-rotation".concat(r)):""}}function tT(n,e){return e===void 0&&(e=[n]),function(t,r){if(r.isRequest)return e.some(function(a){return r.requestAble===a})?r.parentDirection:!1;var i=r.inputEvent.target;return Yn(i,He("direction"))&&(!n||Yn(i,He(n)))}}function hee(n,e,t){var r,i=Ad(n,{"x%":function(P){return P/100*e.offsetWidth},"y%":function(P){return P/100*e.offsetHeight}}),a=n.slice(0,t<0?void 0:t),s=n.slice(0,t<0?void 0:t+1),c=n[t]||"",u=t<0?[]:n.slice(t),d=t<0?[]:n.slice(t+1),h=i.slice(0,t<0?void 0:t),p=i.slice(0,t<0?void 0:t+1),m=(r=i[t])!==null&&r!==void 0?r:Ad([""])[0],b=t<0?[]:i.slice(t),_=t<0?[]:i.slice(t+1),w=m?[m]:[],E=Lu(h),T=Lu(p),C=Lu(b),k=Lu(_),j=Yt(E,C,4);return{transforms:n,beforeFunctionMatrix:E,beforeFunctionMatrix2:T,targetFunctionMatrix:Lu(w),afterFunctionMatrix:C,afterFunctionMatrix2:k,allFunctionMatrix:j,beforeFunctions:h,beforeFunctions2:p,targetFunction:w[0],afterFunctions:b,afterFunctions2:_,beforeFunctionTexts:a,beforeFunctionTexts2:s,targetFunctionText:c,afterFunctionTexts:u,afterFunctionTexts2:d}}function pee(n){return!n||!la(n)||Xd(n)?!1:Gn(n)||"length"in n}function Ha(n,e){return n?Xd(n)?n:Gr(n)?e?document.querySelector(n):n:CE(n)?n():c3(n)?n:"current"in n?n.current:n:null}function nT(n,e){if(!n)return[];var t=pee(n)?[].slice.call(n):[n];return t.reduce(function(r,i){return Gr(i)&&e?Ie(Ie([],te(r),!1),te([].slice.call(document.querySelectorAll(i))),!1):(Gn(i)?r.push(nT(i,e)):r.push(Ha(i,e)),r)},[])}function gee(n,e,t){var r=In(n,e)/Math.PI*180;return r=t>=0?r:180-r,r=r>=0?r:360+r,r}function rN(n,e){var t=n.rootMatrix,r=n.is3d,i=r?4:3,a=Xa(t,i);return r||(a=ca(a,3,4)),a[12]=0,a[13]=0,a[14]=0,ZQ(a,e)}function DV(n,e,t,r,i){var a=te(n,2),s=a[0],c=a[1],u=0,d=0;if(i&&s&&c){var h=In([0,0],e),p=In([0,0],r),m=Vi(e),b=Math.cos(h-p)*m;if(!r[0])d=b,u=d*t;else if(!r[1])u=b,d=u/t;else{var _=r[0]*s,w=r[1]*c,E=Math.atan2(_+e[0],w+e[1]),T=Math.atan2(_,w);E<0&&(E+=Math.PI*2),T<0&&(T+=Math.PI*2);var C=0;we(E-T)<Math.PI/2||we(E-T)>Math.PI/2*3||(T+=Math.PI),C=E-T,C>Math.PI*2?C-=Math.PI*2:C>Math.PI?C=2*Math.PI-C:C<-Math.PI&&(C=-2*Math.PI-C);var k=Vi([_+e[0],w+e[1]])*Math.cos(C);u=k*Math.sin(T)-_,d=k*Math.cos(T)-w,r[0]<0&&(u*=-1),r[1]<0&&(d*=-1)}}else u=r[0]*e[0],d=r[1]*e[1];return[u,d]}function NV(n,e,t,r){var i,a=t.ratio,s=t.startOffsetWidth,c=t.startOffsetHeight,u=0,d=0,h=r.distX,p=r.distY,m=r.pinchScale,b=r.parentDistance,_=r.parentDist,w=r.parentScale,E=t.fixedDirection,T=[0,1].map(function(A){return we(n[A]-E[A])}),C=[0,1].map(function(A){var I=T[A];return I!==0&&(I=2/I),I});if(_)u=_[0],d=_[1],e&&(u?d||(d=u/a):u=d*a);else if(Td(m))u=(m-1)*s,d=(m-1)*c;else if(w)u=(w[0]-1)*s,d=(w[1]-1)*c;else if(b){var k=s*T[0],j=c*T[1],P=Vi([k,j]);u=b/P*k*C[0],d=b/P*j*C[1]}else{var N=Ja({datas:t,distX:h,distY:p});N=C.map(function(A,I){return N[I]*A}),i=te(DV([s,c],N,a,n,e),2),u=i[0],d=i[1]}return{distWidth:u,distHeight:d}}function bw(n,e){if(e){if(n==="left")return{x:"0%",y:"50%"};if(n==="top")return{x:"50%",y:"50%"};if(n==="center")return{x:"50%",y:"50%"};if(n==="right")return{x:"100%",y:"50%"};if(n==="bottom")return{x:"50%",y:"100%"};var t=te(n.split(" "),2),r=t[0],i=t[1],a=bw(r||""),s=bw(i||""),c=J(J({},a),s),u={x:"50%",y:"50%"};return c.x&&(u.x=c.x),c.y&&(u.y=c.y),c.value&&(c.x&&!c.y&&(u.y=c.value),!c.x&&c.y&&(u.x=c.value)),u}return n==="left"?{x:"0%"}:n==="right"?{x:"100%"}:n==="top"?{y:"0%"}:n==="bottom"?{y:"100%"}:n?n==="center"?{value:"50%"}:{value:n}:{}}function rT(n,e,t){var r=bw(n,!0),i=r.x,a=r.y;return[Ht(i,e)||0,Ht(a,t)||0]}function mee(n,e,t){var r=n.map(function(a){return We(a,e)}),i=r.map(function(a){return ig(a,t)});return{prev:r,next:i,result:i.map(function(a){return It(a,e)})}}function MV(n,e){return n.length===e.length&&n.every(function(t,r){var i=e[r],a=Gn(t),s=Gn(i);return a&&s?MV(t,i):!a&&!s?t===i:!1})}function Wu(n,e,t,r,i){var a=n._store,s=a[e];if(!(e in a))if(i!=null)a[e]=i,s=i;else return a[e]=t,t;return s===t||r(s)===r(t)?s:(a[e]=t,t)}function Ar(n){return n>=0?1:-1}function we(n){return Math.abs(n)}function D1(n,e){return dQ(n).map(function(t){return e(t)})}function PV(n){return Td(n)?{top:n,left:n,right:n,bottom:n}:{left:n.left||0,top:n.top||0,right:n.right||0,bottom:n.bottom||0}}var vee=og("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(n,e){var t=e.datas,r=e.targets,i=e.angle,a=e.originalDatas,s=n.props,c=s.pinchable,u=s.ables;if(!c)return!1;var d="onPinch".concat(r?"Group":"","Start"),h="drag".concat(r?"Group":"","ControlStart"),p=(c===!0?n.controlAbles:u.filter(function(w){return c.indexOf(w.name)>-1})).filter(function(w){return w.canPinch&&w[h]}),m=dt(n,e,{});r&&(m.targets=r);var b=je(n,d,m);t.isPinch=b!==!1,t.ables=p;var _=t.isPinch;return _?(p.forEach(function(w){if(a[w.name]=a[w.name]||{},!!w[h]){var E=J(J({},e),{datas:a[w.name],parentRotate:i,isPinch:!0});w[h](n,E)}}),n.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},_):!1},pinch:function(n,e){var t=e.datas,r=e.scale,i=e.distance,a=e.originalDatas,s=e.inputEvent,c=e.targets,u=e.angle;if(t.isPinch){var d=i*(1-1/r),h=dt(n,e,{});c&&(h.targets=c);var p="onPinch".concat(c?"Group":"");je(n,p,h);var m=t.ables,b="drag".concat(c?"Group":"","Control");return m.forEach(function(_){_[b]&&_[b](n,J(J({},e),{datas:a[_.name],inputEvent:s,resolveMatrix:!0,pinchScale:r,parentDistance:d,parentRotate:u,isPinch:!0}))}),h}},pinchEnd:function(n,e){var t=e.datas,r=e.isPinch,i=e.inputEvent,a=e.targets,s=e.originalDatas;if(t.isPinch){var c="onPinch".concat(a?"Group":"","End"),u=ui(n,e,{isDrag:r});a&&(u.targets=a),je(n,c,u);var d=t.ables,h="drag".concat(a?"Group":"","ControlEnd");return d.forEach(function(p){p[h]&&p[h](n,J(J({},e),{isDrag:r,datas:s[p.name],inputEvent:i,isPinch:!0}))}),r}},pinchGroupStart:function(n,e){return this.pinchStart(n,J(J({},e),{targets:n.props.targets}))},pinchGroup:function(n,e){return this.pinch(n,J(J({},e),{targets:n.props.targets}))},pinchGroupEnd:function(n,e){return this.pinchEnd(n,J(J({},e),{targets:n.props.targets}))}}),iN=tT("scalable"),yee={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:eV("scalable"),dragControlCondition:iN,viewClassName:eT("scalable"),dragControlStart:function(n,e){var t=e.datas,r=e.isPinch,i=e.inputEvent,a=e.parentDirection,s=AV(a,r,i,t),c=n.state,u=c.width,d=c.height,h=c.targetTransform,p=c.target,m=c.pos1,b=c.pos2,_=c.pos4;if(!s||!p)return!1;r||zc(n,e),t.datas={},t.transform=h,t.prevDist=[1,1],t.direction=s,t.startOffsetWidth=u,t.startOffsetHeight=d,t.startValue=[1,1];var w=!s[0]&&!s[1]||s[0]||!s[1];Ey(n,e,"scale"),t.isWidth=w;function E(N){t.ratio=N&&isFinite(N)?N:0}t.startPositions=zi(n.state);function T(N){var A=fV(t.startPositions,N);t.fixedDirection=A.fixedDirection,t.fixedPosition=A.fixedPosition,t.fixedOffset=A.fixedOffset}t.setFixedDirection=T,E(ks(m,b)/ks(b,_)),T([-s[0],-s[1]]);var C=function(N){t.minScaleSize=N},k=function(N){t.maxScaleSize=N};C([-1/0,-1/0]),k([1/0,1/0]);var j=dt(n,e,J(J({direction:s,set:function(N){t.startValue=N},setRatio:E,setFixedDirection:T,setMinScaleSize:C,setMaxScaleSize:k},Sy(n,e)),{dragStart:Tr.dragStart(n,new Cd().dragStart([0,0],e))})),P=je(n,"onScaleStart",j);return t.startFixedDirection=t.fixedDirection,P!==!1&&(t.isScale=!0,n.state.snapRenderInfo={request:e.isRequest,direction:s}),t.isScale?j:!1},dragControl:function(n,e){_y(n,e,"scale");var t=e.datas,r=e.parentKeepRatio,i=e.parentFlag,a=e.isPinch,s=e.dragClient,c=e.isRequest,u=e.useSnap,d=e.resolveMatrix,h=t.prevDist,p=t.direction,m=t.startOffsetWidth,b=t.startOffsetHeight,_=t.isScale,w=t.startValue,E=t.isWidth,T=t.ratio;if(!_)return!1;var C=n.props,k=C.throttleScale,j=C.parentMoveable,P=p;!p[0]&&!p[1]&&(P=[1,1]);var N=T&&(r??C.keepRatio)||!1,A=n.state,I=[w[0],w[1]];function D(){var ae=NV(P,N,t,e),Ce=ae.distWidth,Ne=ae.distHeight,Oe=m?(m+Ce)/m:1,Ge=b?(b+Ne)/b:1;w[0]||(I[0]=Ce/m),w[1]||(I[1]=Ne/b);var Le=(P[0]||N?Oe:1)*I[0],Se=(P[1]||N?Ge:1)*I[1];return Le===0&&(Le=Ar(h[0])*Jm),Se===0&&(Se=Ar(h[1])*Jm),[Le,Se]}var z=D();if(!a&&n.props.groupable){var V=A.snapRenderInfo||{},B=V.direction;Gn(B)&&(B[0]||B[1])&&(A.snapRenderInfo={direction:p,request:e.isRequest})}je(n,"onBeforeScale",dt(n,e,{scale:z,setFixedDirection:function(ae){return t.setFixedDirection(ae),z=D(),z},startFixedDirection:t.startFixedDirection,setScale:function(ae){z=ae}},!0));var O=[z[0]/I[0],z[1]/I[1]],X=s,K=[0,0],$=Ar(O[0]*O[1]),W=!s&&!i&&a;if(W||d?X=qE(n,t.targetAllTransform,[0,0],[0,0],t):s||(X=t.fixedPosition),a||(K=XJ(n,O,p,!u&&c,t)),N){P[0]&&P[1]&&K[0]&&K[1]&&(Math.abs(K[0]*m)>Math.abs(K[1]*b)?K[1]=0:K[0]=0);var ee=!K[0]&&!K[1];if(ee&&(E?O[0]=st(O[0]*I[0],k)/I[0]:O[1]=st(O[1]*I[1],k)/I[1]),P[0]&&!P[1]||K[0]&&!K[1]||ee&&E){O[0]+=K[0];var ie=m*O[0]*I[0]/T;O[1]=Ar($*O[0])*we(ie/b/I[1])}else if(!P[0]&&P[1]||!K[0]&&K[1]||ee&&!E){O[1]+=K[1];var H=b*O[1]*I[1]*T;O[0]=Ar($*O[1])*we(H/m/I[0])}}else O[0]+=K[0],O[1]+=K[1],K[0]||(O[0]=st(O[0]*I[0],k)/I[0]),K[1]||(O[1]=st(O[1]*I[1],k)/I[1]);O[0]===0&&(O[0]=Ar(h[0])*Jm),O[1]===0&&(O[1]=Ar(h[1])*Jm),z=JJ(O,[I[0],I[1]]);var F=[m,b],Y=[m*z[0],b*z[1]];Y=i3(Y,t.minScaleSize,t.maxScaleSize,N?T:!1),z=D1(2,function(ae){return F[ae]?Y[ae]/F[ae]:Y[ae]}),O=D1(2,function(ae){return z[ae]/I[ae]});var ne=D1(2,function(ae){return h[ae]?O[ae]/h[ae]:O[ae]}),Z="scale(".concat(O.join(", "),")"),oe="scale(".concat(z.join(", "),")"),ue=wy(t,oe,Z),ye=!w[0]||!w[1],me=XZ(n,ye?oe:Z,t.fixedDirection,X,t.fixedOffset,t,ye),Te=W?me:We(me,t.prevInverseDist||[0,0]);if(t.prevDist=O,t.prevInverseDist=me,z[0]===h[0]&&z[1]===h[1]&&Te.every(function(ae){return!ae})&&!j&&!W)return!1;var Me=dt(n,e,J({offsetWidth:m,offsetHeight:b,direction:p,scale:z,dist:O,delta:ne,isPinch:!!a},K3(n,ue,Te,a,e)));return je(n,"onScale",Me),Me},dragControlEnd:function(n,e){var t=e.datas;if(!t.isScale)return!1;t.isScale=!1;var r=ui(n,e,{});return je(n,"onScaleEnd",r),r},dragGroupControlCondition:iN,dragGroupControlStart:function(n,e){var t=e.datas,r=this.dragControlStart(n,e);if(!r)return!1;var i=ia(n,"resizable",e);t.moveableScale=n.scale;var a=Ds(n,this,"dragControlStart",e,function(d,h){return Sv(n,d,t,h)}),s=function(d){r.setFixedDirection(d),a.forEach(function(h,p){h.setFixedDirection(d),Sv(n,h.moveable,t,i[p])})};t.setFixedDirection=s;var c=J(J({},r),{targets:n.props.targets,events:a,setFixedDirection:s}),u=je(n,"onScaleGroupStart",c);return t.isScale=u!==!1,t.isScale?c:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isScale){Ry(n,"onBeforeScale",function(h){je(n,"onBeforeScaleGroup",dt(n,e,J(J({},h),{targets:n.props.targets}),!0))});var r=this.dragControl(n,e);if(r){var i=r.dist,a=t.moveableScale;n.scale=[i[0]*a[0],i[1]*a[1]];var s=n.props.keepRatio,c=t.fixedPosition,u=Ds(n,this,"dragControl",e,function(h,p){var m=te(br(ag(n.rotation/180*Math.PI,3),[p.datas.originalX*i[0],p.datas.originalY*i[1],1],3),2),b=m[0],_=m[1];return J(J({},p),{parentDist:null,parentScale:i,parentKeepRatio:s,dragClient:It(c,[b,_])})}),d=J({targets:n.props.targets,events:u},r);return je(n,"onScaleGroup",d),d}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isScale){this.dragControlEnd(n,e);var i=Ds(n,this,"dragControlEnd",e),a=ui(n,e,{targets:n.props.targets,events:i});return je(n,"onScaleGroupEnd",a),t}},request:function(){var n={},e=0,t=0,r=!1;return{isControl:!0,requestStart:function(i){return r=i.useSnap,{datas:n,parentDirection:i.direction||[1,1],useSnap:r}},request:function(i){return e+=i.deltaWidth,t+=i.deltaHeight,{datas:n,parentDist:[e,t],parentKeepRatio:i.keepRatio,useSnap:r}},requestEnd:function(){return{datas:n,isDrag:!0,useSnap:r}}}}};function ko(n,e){return n.map(function(t,r){return yv(t,e[r],1,2)})}function aN(n,e,t){var r=In(n,e),i=In(n,t),a=i-r;return a>=0?a:a+2*Math.PI}function bee(n,e){var t=aN(n[0],n[1],n[2]),r=aN(e[0],e[1],e[2]),i=Math.PI;return!(t>=i&&r<=i||t<=i&&r>=i)}var xee={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:eT("warpable"),render:function(n,e){var t=n.props,r=t.resizable,i=t.scalable,a=t.warpable,s=t.zoom;if(r||i||!a)return[];var c=n.state,u=c.pos1,d=c.pos2,h=c.pos3,p=c.pos4,m=ko(u,d),b=ko(d,u),_=ko(u,h),w=ko(h,u),E=ko(h,p),T=ko(p,h),C=ko(d,p),k=ko(p,d);return Ie([e.createElement("div",{className:He("line"),key:"middeLine1",style:xh(m,E,s)}),e.createElement("div",{className:He("line"),key:"middeLine2",style:xh(b,T,s)}),e.createElement("div",{className:He("line"),key:"middeLine3",style:xh(_,C,s)}),e.createElement("div",{className:He("line"),key:"middeLine4",style:xh(w,k,s)})],te(tV(n,"warpable",e)),!1)},dragControlCondition:function(n,e){if(e.isRequest)return!1;var t=e.inputEvent.target;return Yn(t,He("direction"))&&Yn(t,He("warpable"))},dragControlStart:function(n,e){var t=e.datas,r=e.inputEvent,i=n.props.target,a=r.target,s=CV(a,t);if(!s||!i)return!1;var c=n.state,u=c.transformOrigin,d=c.is3d,h=c.targetTransform,p=c.targetMatrix,m=c.width,b=c.height,_=c.left,w=c.top;t.datas={},t.targetTransform=h,t.warpTargetMatrix=d?p:ca(p,3,4),t.targetInverseMatrix=R3(Xa(t.warpTargetMatrix,4),3,4),t.direction=s,t.left=_,t.top=w,t.poses=[[0,0],[m,0],[0,b],[m,b]].map(function(C){return We(C,u)}),t.nextPoses=t.poses.map(function(C){var k=te(C,2),j=k[0],P=k[1];return br(t.warpTargetMatrix,[j,P,0,1],4)}),t.startValue=en(4),t.prevMatrix=en(4),t.absolutePoses=zi(c),t.posIndexes=Y3(s),zc(n,e),Ey(n,e,"matrix3d"),c.snapRenderInfo={request:e.isRequest,direction:s};var E=dt(n,e,J({set:function(C){t.startValue=C}},Sy(n,e))),T=je(n,"onWarpStart",E);return T!==!1&&(t.isWarp=!0),t.isWarp},dragControl:function(n,e){var t=e.datas,r=e.isRequest,i=e.distX,a=e.distY,s=t.targetInverseMatrix,c=t.prevMatrix,u=t.isWarp,d=t.startValue,h=t.poses,p=t.posIndexes,m=t.absolutePoses;if(!u)return!1;if(_y(n,e,"matrix3d"),Zd(n,"warpable")){var b=p.map(function(D){return m[D]});b.length>1&&b.push([(b[0][0]+b[1][0])/2,(b[0][1]+b[1][1])/2]);var _=Cy(n,r,{horizontal:b.map(function(D){return D[1]+a}),vertical:b.map(function(D){return D[0]+i})}),w=_.horizontal,E=_.vertical;a-=w.offset,i-=E.offset}var T=Ja({datas:t,distX:i,distY:a},!0),C=t.nextPoses.slice();if(p.forEach(function(D){C[D]=It(C[D],T)}),!LZ.every(function(D){return bee(D.map(function(z){return h[z]}),D.map(function(z){return C[z]}))}))return!1;var k=zE(h[0],h[2],h[1],h[3],C[0],C[2],C[1],C[3]);if(!k.length)return!1;var j=Yt(s,k,4),P=$3(t,j,!0),N=Yt(Xa(c,4),P,4);t.prevMatrix=P;var A=Yt(d,P,4),I=wy(t,"matrix3d(".concat(A.join(", "),")"),"matrix3d(".concat(P.join(", "),")"));return GE(e,I),je(n,"onWarp",dt(n,e,J({delta:N,matrix:A,dist:P,multiply:Yt,transform:I},Ir({transform:I},e)))),!0},dragControlEnd:function(n,e){var t=e.datas,r=e.isDrag;return t.isWarp?(t.isWarp=!1,je(n,"onWarpEnd",ui(n,e,{})),r):!1}},_ee=He("area-pieces"),a0=He("area-piece"),OV=He("avoid"),wee=He("view-dragging");function N1(n){var e=n.areaElement;if(e){var t=n.state,r=t.width,i=t.height;l3(e,OV),e.style.cssText+="left: 0px; top: 0px; width: ".concat(r,"px; height: ").concat(i,"px")}}function sN(n){return n.createElement("div",{key:"area_pieces",className:_ee},n.createElement("div",{className:a0}),n.createElement("div",{className:a0}),n.createElement("div",{className:a0}),n.createElement("div",{className:a0}))}var jV={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(n,e){var t=n.props,r=t.target,i=t.dragArea,a=t.groupable,s=t.passDragArea,c=n.getState(),u=c.width,d=c.height,h=c.renderPoses,p=s?He("area","pass"):He("area");if(a)return[e.createElement("div",{key:"area",ref:Rs(n,"areaElement"),className:p}),sN(e)];if(!r||!i)return[];var m=zE([0,0],[u,0],[0,d],[u,d],h[0],h[1],h[2],h[3]),b=m.length?Iy(m,!0):"none";return[e.createElement("div",{key:"area",ref:Rs(n,"areaElement"),className:p,style:{top:"0px",left:"0px",width:"".concat(u,"px"),height:"".concat(d,"px"),transformOrigin:"0 0",transform:b}}),sN(e)]},dragStart:function(n,e){var t=e.datas,r=e.clientX,i=e.clientY,a=e.inputEvent;if(!a)return!1;t.isDragArea=!1;var s=n.areaElement,c=n.state,u=c.moveableClientRect,d=c.renderPoses,h=c.rootMatrix,p=c.is3d,m=u.left,b=u.top,_=Oi(d),w=_.left,E=_.top,T=_.width,C=_.height,k=p?4:3,j=te(kd(h,[r-m,i-b],k),2),P=j[0],N=j[1];P-=w,N-=E;var A=[{left:w,top:E,width:T,height:N-10},{left:w,top:E,width:P-10,height:C},{left:w,top:E+N+10,width:T,height:C-N-10},{left:w+P+10,top:E,width:T-P-10,height:C}],I=[].slice.call(s.nextElementSibling.children);A.forEach(function(D,z){I[z].style.cssText="left: ".concat(D.left,"px;top: ").concat(D.top,"px; width: ").concat(D.width,"px; height: ").concat(D.height,"px;")}),o3(s,OV),c.disableNativeEvent=!0},drag:function(n,e){var t=e.datas,r=e.inputEvent;if(this.enableNativeEvent(n),!r)return!1;t.isDragArea||(t.isDragArea=!0,N1(n))},dragEnd:function(n,e){this.enableNativeEvent(n);var t=e.inputEvent,r=e.datas;if(!t)return!1;r.isDragArea||N1(n)},dragGroupStart:function(n,e){return this.dragStart(n,e)},dragGroup:function(n,e){return this.drag(n,e)},dragGroupEnd:function(n,e){return this.dragEnd(n,e)},unset:function(n){N1(n),n.state.disableNativeEvent=!1},enableNativeEvent:function(n){var e=n.state;e.disableNativeEvent&&r3(function(){e.disableNativeEvent=!1})}},See=og("origin",{props:["origin","svgOrigin"],render:function(n,e){var t=n.props,r=t.zoom,i=t.svgOrigin,a=t.groupable,s=n.getState(),c=s.beforeOrigin,u=s.rotation,d=s.svg,h=s.allMatrix,p=s.is3d,m=s.left,b=s.top,_=s.offsetWidth,w=s.offsetHeight,E;if(!a&&d&&i){var T=te(rT(i,_,w),2),C=T[0],k=T[1],j=p?4:3,P=un(h,[C,k],j);E=Cv(u,r,We(P,[m,b]))}else E=Cv(u,r,c);return[e.createElement("div",{className:He("control","origin"),style:E,key:"beforeOrigin"})]}});function Eee(n){var e=n.scrollContainer;return[e.scrollLeft,e.scrollTop]}var Tee={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(n,e){var t=n.props,r=t.scrollContainer,i=r===void 0?n.getContainer():r,a=t.scrollOptions,s=new iZ,c=Ha(i,!0);e.datas.dragScroll=s,n.state.dragScroll=s;var u=e.isControl?"controlGesto":"targetGesto",d=e.targets;s.on("scroll",function(h){var p=h.container,m=h.direction,b=dt(n,e,{scrollContainer:p,direction:m}),_=d?"onScrollGroup":"onScroll";d&&(b.targets=d),je(n,_,b)}).on("move",function(h){var p=h.offsetX,m=h.offsetY,b=h.inputEvent;n[u].scrollBy(p,m,b.inputEvent,!1)}).on("scrollDrag",function(h){var p=h.next;p(n[u].getCurrentEvent())}),s.dragStart(e,J({container:c},a))},checkScroll:function(n,e){var t=e.datas.dragScroll;if(t){var r=n.props,i=r.scrollContainer,a=i===void 0?n.getContainer():i,s=r.scrollThreshold,c=s===void 0?0:s,u=r.scrollThrottleTime,d=u===void 0?0:u,h=r.getScrollPosition,p=h===void 0?Eee:h,m=r.scrollOptions;return t.drag(e,J({container:a,threshold:c,throttleTime:d,getScrollPosition:function(b){return p({scrollContainer:b.container,direction:b.direction})}},m)),!0}},drag:function(n,e){return this.checkScroll(n,e)},dragEnd:function(n,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(n,e){return this.dragStart(n,J(J({},e),{isControl:!0}))},dragControl:function(n,e){return this.drag(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupStart:function(n,e){return this.dragStart(n,J(J({},e),{targets:n.props.targets}))},dragGroup:function(n,e){return this.drag(n,J(J({},e),{targets:n.props.targets}))},dragGroupEnd:function(n,e){return this.dragEnd(n,J(J({},e),{targets:n.props.targets}))},dragGroupControlStart:function(n,e){return this.dragStart(n,J(J({},e),{targets:n.props.targets,isControl:!0}))},dragGroupControl:function(n,e){return this.drag(n,J(J({},e),{targets:n.props.targets}))},dragGroupControEnd:function(n,e){return this.dragEnd(n,J(J({},e),{targets:n.props.targets}))},unset:function(n){var e,t=n.state;(e=t.dragScroll)===null||e===void 0||e.dragEnd(),t.dragScroll=null}},VV={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","preventRightClick","preventWheelClick","requestStyles"],events:["changeTargets"]},Aee=og("padding",{props:["padding"],render:function(n,e){var t=n.props;if(t.dragArea)return[];var r=PV(t.padding||{}),i=r.left,a=r.top,s=r.right,c=r.bottom,u=n.getState(),d=u.renderPoses,h=u.pos1,p=u.pos2,m=u.pos3,b=u.pos4,_=[h,p,m,b],w=[];return i>0&&w.push([0,2]),a>0&&w.push([0,1]),s>0&&w.push([1,3]),c>0&&w.push([2,3]),w.map(function(E,T){var C=te(E,2),k=C[0],j=C[1],P=_[k],N=_[j],A=d[k],I=d[j],D=zE([0,0],[100,0],[0,100],[100,100],P,N,A,I);if(D.length)return e.createElement("div",{key:"padding".concat(T),className:He("padding"),style:{transform:Iy(D,!0)}})})}}),oN=["nw","ne","se","sw"];function s0(n,e){var t=n[0]+n[1],r=t>e?e/t:1;return n[0]*=r,n[1]=e-n[1]*r,n}var Cee=[1,2,5,6],Iee=[0,3,4,7],ac=[1,-1,-1,1],sc=[1,1,-1,-1];function iT(n,e,t,r,i,a,s,c){i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=t),c===void 0&&(c=r);var u=[],d=!1,h=n.filter(function(m){return!m.virtual}),p=h.map(function(m){var b=m.horizontal,_=m.vertical,w=m.pos;if(_&&!d&&(d=!0,u.push("/")),d){var E=Math.max(0,_===1?w[1]-a:c-w[1]);return u.push(Ji(E,r,e)),E}else{var E=Math.max(0,b===1?w[0]-i:s-w[0]);return u.push(Ji(E,t,e)),E}});return{radiusPoses:h,styles:u,raws:p}}function zV(n){for(var e=[0,0],t=[0,0],r=n.length,i=0;i<r;++i){var a=n[i];a.sub&&(a.horizontal&&(e[1]===0&&(e[0]=i),e[1]=i-e[0]+1,t[0]=i+1),a.vertical&&(t[1]===0&&(t[0]=i),t[1]=i-t[0]+1))}return{horizontalRange:e,verticalRange:t}}function LV(n,e,t,r,i,a,s){var c,u,d,h;a===void 0&&(a=[0,0]),s===void 0&&(s=!1);var p=n.indexOf("/"),m=(p>-1?n.slice(0,p):n).length,b=n.slice(0,m),_=n.slice(m+1),w=b.length,E=_.length,T=E>0,C=te(b,4),k=C[0],j=k===void 0?"0px":k,P=C[1],N=P===void 0?j:P,A=C[2],I=A===void 0?j:A,D=C[3],z=D===void 0?N:D,V=te(_,4),B=V[0],O=B===void 0?j:B,X=V[1],K=X===void 0?T?O:N:X,$=V[2],W=$===void 0?T?O:I:$,ee=V[3],ie=ee===void 0?T?K:z:ee,H=[j,N,I,z].map(function(ue){return Ht(ue,e)}),F=[O,K,W,ie].map(function(ue){return Ht(ue,t)}),Y=H.slice(),ne=F.slice();c=te(s0([Y[0],Y[1]],e),2),Y[0]=c[0],Y[1]=c[1],u=te(s0([Y[3],Y[2]],e),2),Y[3]=u[0],Y[2]=u[1],d=te(s0([ne[0],ne[3]],t),2),ne[0]=d[0],ne[3]=d[1],h=te(s0([ne[1],ne[2]],t),2),ne[1]=h[0],ne[2]=h[1];var Z=s?Y:Y.slice(0,Math.max(a[0],w)),oe=s?ne:ne.slice(0,Math.max(a[1],E));return Ie(Ie([],te(Z.map(function(ue,ye){var me=oN[ye];return{virtual:ye>=w,horizontal:ac[ye],vertical:0,pos:[r+ue,i+(sc[ye]===-1?t:0)],sub:!0,raw:H[ye],direction:me}})),!1),te(oe.map(function(ue,ye){var me=oN[ye];return{virtual:ye>=E,horizontal:0,vertical:sc[ye],pos:[r+(ac[ye]===-1?e:0),i+ue],sub:!0,raw:F[ye],direction:me}})),!1)}function Ree(n,e,t,r,i){i===void 0&&(i=e.length);var a=zV(n.slice(r)),s=a.horizontalRange,c=a.verticalRange,u=t-r,d=0;if(u===0)d=i;else if(u>0&&u<s[1])d=s[1]-u;else if(u>=c[0])d=c[0]+c[1]-u;else return;n.splice(t,d),e.splice(t,d)}function kee(n,e,t,r,i,a,s,c,u,d,h){d===void 0&&(d=0),h===void 0&&(h=0);var p=zV(n.slice(t)),m=p.horizontalRange,b=p.verticalRange;if(r>-1)for(var _=ac[r]===1?a-d:c-a,w=m[1];w<=r;++w){var E=sc[w]===1?h:u,T=0;if(r===w?T=a:w===0?T=d+_:ac[w]===-1&&(T=c-(e[t][0]-d)),n.splice(t+w,0,{horizontal:ac[w],vertical:0,pos:[T,E]}),e.splice(t+w,0,[T,E]),w===0)break}else if(i>-1){var C=sc[i]===1?s-h:u-s;if(m[1]===0&&b[1]===0){var k=[d+C,h];n.push({horizontal:ac[0],vertical:0,pos:k}),e.push(k)}for(var j=b[0],w=b[1];w<=i;++w){var T=ac[w]===1?d:c,E=0;if(i===w?E=s:w===0?E=h+C:sc[w]===1?E=e[t+j][1]:sc[w]===-1&&(E=u-(e[t+j][1]-h)),n.push({horizontal:0,vertical:sc[w],pos:[T,E]}),e.push([T,E]),w===0)break}}}function Dee(n,e){e===void 0&&(e=n.map(function(i){return i.raw}));var t=n.map(function(i,a){return i.horizontal?e[a]:null}).filter(function(i){return i!=null}),r=n.map(function(i,a){return i.vertical?e[a]:null}).filter(function(i){return i!=null});return{horizontals:t,verticals:r}}var Nee=[[0,-1,"n"],[1,0,"e"]],Mee=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function aT(n,e,t){var r=n.props.clipRelative,i=n.state,a=i.width,s=i.height,c=e,u=c.type,d=c.poses,h=u==="rect",p=u==="circle";if(u==="polygon")return t.map(function(N){return"".concat(Ji(N[0],a,r)," ").concat(Ji(N[1],s,r))});if(h||u==="inset"){var m=t[1][1],b=t[3][0],_=t[7][0],w=t[5][1];if(h)return[m,b,w,_].map(function(N){return"".concat(N,"px")});var E=[m,a-b,s-w,_].map(function(N,A){return Ji(N,A%2?a:s,r)});if(t.length>8){var T=te(We(t[4],t[0]),2),C=T[0],k=T[1];E.push.apply(E,Ie(["round"],te(iT(d.slice(8).map(function(N,A){return J(J({},N),{pos:t[A]})}),r,C,k,_,m,b,w).styles),!1))}return E}else if(p||u==="ellipse"){var j=t[0],P=Ji(we(t[1][1]-j[1]),p?Math.sqrt((a*a+s*s)/2):s,r),E=p?[P]:[Ji(we(t[2][0]-j[0]),a,r),P];return E.push("at",Ji(j[0],a,r),Ji(j[1],s,r)),E}}function Rv(n,e,t,r){var i=[r,(r+e)/2,e],a=[n,(n+t)/2,t];return Mee.map(function(s){var c=te(s,3),u=c[0],d=c[1],h=c[2],p=i[u+1],m=a[d+1];return{vertical:we(d),horizontal:we(u),direction:h,pos:[p,m]}})}function BV(n){var e=[1/0,-1/0],t=[1/0,-1/0];return n.forEach(function(r){var i=r.pos;e[0]=Math.min(e[0],i[0]),e[1]=Math.max(e[1],i[0]),t[0]=Math.min(t[0],i[1]),t[1]=Math.max(t[1],i[1])}),[we(e[1]-e[0]),we(t[1]-t[0])]}function lN(n,e,t,r,i){var a,s,c,u,d,h,p,m,b;if(n){var _=i;if(!_){var w=$r(n),E=w("clipPath");_=E!=="none"?E:w("clip")}if(!((!_||_==="none"||_==="auto")&&(_=r,!_))){var T=n3(_),C=T.prefix,k=C===void 0?_:C,j=T.value,P=j===void 0?"":j,N=k==="circle",A=" ";if(k==="polygon"){var I=uc(P||"0% 0%, 100% 0%, 100% 100%, 0% 100%");A=",";var D=I.map(function(lt){var Et=te(lt.split(" "),2),tt=Et[0],ft=Et[1];return{vertical:1,horizontal:1,pos:[Ht(tt,e),Ht(ft,t)]}}),z=Nc(D.map(function(lt){return lt.pos}));return{type:k,clipText:_,poses:D,splitter:A,left:z.minX,right:z.maxX,top:z.minY,bottom:z.maxY}}else if(N||k==="ellipse"){var V="",B="",O=0,X=0,I=ol(P);if(N){var K="";a=te(I,4),s=a[0],K=s===void 0?"50%":s,c=a[2],V=c===void 0?"50%":c,u=a[3],B=u===void 0?"50%":u,O=Ht(K,Math.sqrt((e*e+t*t)/2)),X=O}else{var $="",W="";d=te(I,5),h=d[0],$=h===void 0?"50%":h,p=d[1],W=p===void 0?"50%":p,m=d[3],V=m===void 0?"50%":m,b=d[4],B=b===void 0?"50%":b,O=Ht($,e),X=Ht(W,t)}var ee=[Ht(V,e),Ht(B,t)],D=Ie([{vertical:1,horizontal:1,pos:ee,direction:"nesw"}],te(Nee.slice(0,N?1:2).map(function(tt){return{vertical:we(tt[1]),horizontal:tt[0],direction:tt[2],sub:!0,pos:[ee[0]+tt[0]*O,ee[1]+tt[1]*X]}})),!1);return{type:k,clipText:_,radiusX:O,radiusY:X,left:ee[0]-O,top:ee[1]-X,right:ee[0]+O,bottom:ee[1]+X,poses:D,splitter:A}}else if(k==="inset"){var I=ol(P||"0 0 0 0"),ie=I.indexOf("round"),H=(ie>-1?I.slice(0,ie):I).length,F=I.slice(H+1),Y=te(I.slice(0,H),4),ne=Y[0],Z=Y[1],oe=Z===void 0?ne:Z,ue=Y[2],ye=ue===void 0?ne:ue,me=Y[3],Te=me===void 0?oe:me,Me=te([ne,ye].map(function(tt){return Ht(tt,t)}),2),ae=Me[0],Ce=Me[1],Ne=te([Te,oe].map(function(tt){return Ht(tt,e)}),2),Oe=Ne[0],Ge=Ne[1],Le=e-Ge,Se=t-Ce,Be=LV(F,Le-Oe,Se-ae,Oe,ae),D=Ie(Ie([],te(Rv(ae,Le,Se,Oe)),!1),te(Be),!1);return{type:"inset",clipText:_,poses:D,top:ae,left:Oe,right:Le,bottom:Se,radius:F,splitter:A}}else if(k==="rect"){var I=uc(P||"0px, ".concat(e,"px, ").concat(t,"px, 0px"));A=",";var Pe=te(I.map(function(pn){var Ot=eg(pn).value;return Ot}),4),Ue=Pe[0],Ge=Pe[1],Ce=Pe[2],Oe=Pe[3],D=Rv(Ue,Ge,Ce,Oe);return{type:"rect",clipText:_,poses:D,top:Ue,right:Ge,bottom:Ce,left:Oe,values:I,splitter:A}}}}}function Pee(n,e,t,r,i){var a=n[e],s=a.direction,c=a.sub,u=n.map(function(){return[0,0]}),d=s?s.split(""):[];if(r&&e<8){var h=d.filter(function(O){return O==="w"||O==="e"}),p=d.filter(function(O){return O==="n"||O==="s"}),m=h[0],b=p[0];u[e]=t;var _=te(BV(n),2),w=_[0],E=_[1],T=w&&E?w/E:0;if(T&&i){var C=(e+4)%8,k=n[C].pos,j=[0,0];s.indexOf("w")>-1?j[0]=-1:s.indexOf("e")>-1&&(j[0]=1),s.indexOf("n")>-1?j[1]=-1:s.indexOf("s")>-1&&(j[1]=1);var P=DV([w,E],t,T,j,!0),N=w+P[0],A=E+P[1],I=k[1],D=k[1],z=k[0],V=k[0];j[0]===-1?z=V-N:j[0]===1?V=z+N:(z=z-N/2,V=V+N/2),j[1]===-1?I=D-A:(j[1]===1||(I=D-A/2),D=I+A);var B=Rv(I,V,D,z);n.forEach(function(O,X){u[X][0]=B[X].pos[0]-O.pos[0],u[X][1]=B[X].pos[1]-O.pos[1]})}else n.forEach(function(O,X){var K=O.direction;K&&(K.indexOf(m)>-1&&(u[X][0]=t[0]),K.indexOf(b)>-1&&(u[X][1]=t[1]))}),m&&(u[1][0]=t[0]/2,u[5][0]=t[0]/2),b&&(u[3][1]=t[1]/2,u[7][1]=t[1]/2)}else s&&!c?d.forEach(function(O){var X=O==="n"||O==="s";n.forEach(function(K,$){var W=K.direction,ee=K.horizontal,ie=K.vertical;!W||W.indexOf(O)===-1||(u[$]=[X||!ee?0:t[0],!X||!ie?0:t[1]])})}):u[e]=t;return u}function Oee(n,e){var t=te(q3(n,e),2),r=t[0],i=t[1],a=e.datas,s=a.clipPath,c=a.clipIndex,u=s,d=u.type,h=u.poses,p=u.splitter,m=h.map(function(C){return C.pos});if(d==="polygon")m.splice(c,0,[r,i]);else if(d==="inset"){var b=Cee.indexOf(c),_=Iee.indexOf(c),w=h.length;if(kee(h,m,8,b,_,r,i,m[4][0],m[4][1],m[0][0],m[0][1]),w===h.length)return}else return;var E=aT(n,s,m),T="".concat(d,"(").concat(E.join(p),")");je(n,"onClip",dt(n,e,J({clipEventType:"added",clipType:d,poses:m,clipStyles:E,clipStyle:T,distX:0,distY:0},Ir({clipPath:T},e))))}function jee(n,e){var t=e.datas,r=t.clipPath,i=t.clipIndex,a=r,s=a.type,c=a.poses,u=a.splitter,d=c.map(function(b){return b.pos}),h=d.length;if(s==="polygon")c.splice(i,1),d.splice(i,1);else if(s==="inset"){if(i<8||(Ree(c,d,i,8,h),h===c.length))return}else return;var p=aT(n,r,d),m="".concat(s,"(").concat(p.join(u),")");je(n,"onClip",dt(n,e,J({clipEventType:"removed",clipType:s,poses:d,clipStyles:p,clipStyle:m,distX:0,distY:0},Ir({clipPath:m},e))))}var Vee={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(n,e){var t=n.props,r=t.customClipPath,i=t.defaultClipPath,a=t.clipArea,s=t.zoom,c=t.groupable,u=n.getState(),d=u.target,h=u.width,p=u.height,m=u.allMatrix,b=u.is3d,_=u.left,w=u.top,E=u.pos1,T=u.pos2,C=u.pos3,k=u.pos4,j=u.clipPathState,P=u.snapBoundInfos,N=u.rotation;if(!d||c)return[];var A=lN(d,h,p,i||"inset",j||r);if(!A)return[];var I=b?4:3,D=A.type,z=A.poses,V=z.map(function(Ge){var Le=un(m,Ge.pos,I);return[Le[0]-_,Le[1]-w]}),B=[],O=[],X=D==="rect",K=D==="inset",$=D==="polygon";if(X||K||$){var W=K?V.slice(0,8):V;O=W.map(function(Ge,Le){var Se=Le===0?W[W.length-1]:W[Le-1],Be=In(Se,Ge),Pe=wV(Se,Ge);return e.createElement("div",{key:"clipLine".concat(Le),className:He("line","clip-line","snap-control"),"data-clip-index":Le,style:{width:"".concat(Pe,"px"),transform:"translate(".concat(Se[0],"px, ").concat(Se[1],"px) rotate(").concat(Be,"rad) scaleY(").concat(s,")")}})})}if(B=V.map(function(Ge,Le){return e.createElement("div",{key:"clipControl".concat(Le),className:He("control","clip-control","snap-control"),"data-clip-index":Le,style:{transform:"translate(".concat(Ge[0],"px, ").concat(Ge[1],"px) rotate(").concat(N,"rad) scale(").concat(s,")")}})}),K&&B.push.apply(B,Ie([],te(V.slice(8).map(function(Ge,Le){return e.createElement("div",{key:"clipRadiusControl".concat(Le),className:He("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+Le,style:{transform:"translate(".concat(Ge[0],"px, ").concat(Ge[1],"px) rotate(").concat(N,"rad) scale(").concat(s,")")}})})),!1)),D==="circle"||D==="ellipse"){var ee=A.left,ie=A.top,H=A.radiusX,F=A.radiusY,Y=te(We(un(m,[ee,ie],I),un(m,[0,0],I)),2),ne=Y[0],Z=Y[1],oe="none";if(!a){for(var ue=Math.max(10,H/5,F/5),ye=[],me=0;me<=ue;++me){var Te=Math.PI*2/ue*me;ye.push([H+(H-s)*Math.cos(Te),F+(F-s)*Math.sin(Te)])}ye.push([H,-2]),ye.push([-2,-2]),ye.push([-2,F*2+2]),ye.push([H*2+2,F*2+2]),ye.push([H*2+2,-2]),ye.push([H,-2]),oe="polygon(".concat(ye.map(function(Ge){return"".concat(Ge[0],"px ").concat(Ge[1],"px")}).join(", "),")")}B.push(e.createElement("div",{key:"clipEllipse",className:He("clip-ellipse","snap-control"),style:{width:"".concat(H*2,"px"),height:"".concat(F*2,"px"),clipPath:oe,transform:"translate(".concat(-_+ne,"px, ").concat(-w+Z,"px) ").concat(Iy(m))}}))}if(a){var Me=Oi(Ie([E,T,C,k],te(V),!1)),ae=Me.width,Ce=Me.height,Ne=Me.left,Oe=Me.top;if($||X||K){var ye=K?V.slice(0,8):V;B.push(e.createElement("div",{key:"clipArea",className:He("clip-area","snap-control"),style:{width:"".concat(ae,"px"),height:"".concat(Ce,"px"),transform:"translate(".concat(Ne,"px, ").concat(Oe,"px)"),clipPath:"polygon(".concat(ye.map(function(Le){return"".concat(Le[0]-Ne,"px ").concat(Le[1]-Oe,"px")}).join(", "),")")}}))}}return P&&["vertical","horizontal"].forEach(function(Ge){var Le=P[Ge],Se=Ge==="horizontal";Le.isSnap&&O.push.apply(O,Ie([],te(Le.snap.posInfos.map(function(Be,Pe){var Ue=Be.pos,lt=We(un(m,Se?[0,Ue]:[Ue,0],I),[_,w]),Et=We(un(m,Se?[h,Ue]:[Ue,p],I),[_,w]);return _p(e,"",lt,Et,s,"clip".concat(Ge,"snap").concat(Pe),"guideline")})),!1)),Le.isBound&&O.push.apply(O,Ie([],te(Le.bounds.map(function(Be,Pe){var Ue=Be.pos,lt=We(un(m,Se?[0,Ue]:[Ue,0],I),[_,w]),Et=We(un(m,Se?[h,Ue]:[Ue,p],I),[_,w]);return _p(e,"",lt,Et,s,"clip".concat(Ge,"bounds").concat(Pe),"guideline","bounds","bold")})),!1))}),Ie(Ie([],te(B),!1),te(O),!1)},dragControlCondition:function(n,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(n,e){var t=n.props,r=t.dragWithClip,i=r===void 0?!0:r;return i?!1:this.dragControlStart(n,e)},drag:function(n,e){return this.dragControl(n,J(J({},e),{isDragTarget:!0}))},dragEnd:function(n,e){return this.dragControlEnd(n,e)},dragControlStart:function(n,e){var t=n.state,r=n.props,i=r.defaultClipPath,a=r.customClipPath,s=t.target,c=t.width,u=t.height,d=e.inputEvent?e.inputEvent.target:null,h=d&&d.getAttribute("class")||"",p=e.datas,m=lN(s,c,u,i||"inset",a);if(!m)return!1;var b=m.clipText,_=m.type,w=m.poses,E=je(n,"onClipStart",dt(n,e,{clipType:_,clipStyle:b,poses:w.map(function(T){return T.pos})}));return E===!1?(p.isClipStart=!1,!1):(p.isControl=h&&h.indexOf("clip-control")>-1,p.isLine=h.indexOf("clip-line")>-1,p.isArea=h.indexOf("clip-area")>-1||h.indexOf("clip-ellipse")>-1,p.clipIndex=d?parseInt(d.getAttribute("data-clip-index"),10):-1,p.clipPath=m,p.isClipStart=!0,t.clipPathState=b,zc(n,e),!0)},dragControl:function(n,e){var t,r,i,a=e.datas,s=e.originalDatas,c=e.isDragTarget;if(!a.isClipStart)return!1;var u=a,d=u.isControl,h=u.isLine,p=u.isArea,m=u.clipIndex,b=u.clipPath;if(!b)return!1;var _=Mc(n.props,"clippable"),w=_.keepRatio,E=0,T=0,C=s.draggable,k=Ja(e);c&&C?(t=te(C.prevBeforeDist,2),E=t[0],T=t[1]):(r=te(k,2),E=r[0],T=r[1]);var j=[E,T],P=n.state,N=P.width,A=P.height,I=!p&&!d&&!h,D=b.type,z=b.poses,V=b.splitter,B=z.map(function(mt){return mt.pos});I&&(E=-E,T=-T);var O=!d||z[m].direction==="nesw",X=D==="inset"||D==="rect",K=z.map(function(){return[0,0]});if(d&&!O){var $=z[m],W=$.horizontal,ee=$.vertical,ie=[E*we(W),T*we(ee)];K=Pee(z,m,ie,X,w)}else O&&(K=B.map(function(){return[E,T]}));var H=B.map(function(mt,ln){return It(mt,K[ln])}),F=Ie([],te(H),!1);P.snapBoundInfos=null;var Y=b.type==="circle",ne=b.type==="ellipse";if(Y||ne){var Z=Oi(H),oe=we(Z.bottom-Z.top),ue=we(ne?Z.right-Z.left:oe),ye=H[0][1]+oe,me=H[0][0]-ue,Te=H[0][0]+ue;Y&&(F.push([Te,Z.bottom]),K.push([1,0])),F.push([Z.left,ye]),K.push([0,1]),F.push([me,Z.bottom]),K.push([1,0])}var Me=mV((_.clipHorizontalGuidelines||[]).map(function(mt){return Ht("".concat(mt),A)}),(_.clipVerticalGuidelines||[]).map(function(mt){return Ht("".concat(mt),N)}),N,A),ae=[],Ce=[];if(Y||ne)ae=[F[4][0],F[2][0]],Ce=[F[1][1],F[3][1]];else if(X){var Ne=[F[0],F[2],F[4],F[6]],Oe=[K[0],K[2],K[4],K[6]];ae=Ne.filter(function(mt,ln){return Oe[ln][0]}).map(function(mt){return mt[0]}),Ce=Ne.filter(function(mt,ln){return Oe[ln][1]}).map(function(mt){return mt[1]})}else ae=F.filter(function(mt,ln){return K[ln][0]}).map(function(mt){return mt[0]}),Ce=F.filter(function(mt,ln){return K[ln][1]}).map(function(mt){return mt[1]});var Ge=[0,0],Le=HD(Me,_.clipTargetBounds&&{left:0,top:0,right:N,bottom:A},ae,Ce,5,5),Se=Le.horizontal,Be=Le.vertical,Pe=Se.offset,Ue=Be.offset;if(Se.isBound&&(Ge[1]+=Pe),Be.isBound&&(Ge[0]+=Ue),(ne||Y)&&K[0][0]===0&&K[0][1]===0){var Z=Oi(H),lt=Z.bottom-Z.top,Et=ne?Z.right-Z.left:lt,tt=Be.isBound?we(Ue):Be.snapIndex===0?-Ue:Ue,ft=Se.isBound?we(Pe):Se.snapIndex===0?-Pe:Pe;Et-=tt,lt-=ft,Y&&(lt=lV(Be,Se)>0?lt:Et,Et=lt);var Dt=F[0];F[1][1]=Dt[1]-lt,F[2][0]=Dt[0]+Et,F[3][1]=Dt[1]+lt,F[4][0]=Dt[0]-Et}else if(X&&w&&d){var pn=te(BV(z),2),Ot=pn[0],Rn=pn[1],Yr=Ot&&Rn?Ot/Rn:0,fa=z[m],es=fa.direction||"",$s=F[1][1],ye=F[5][1],me=F[7][0],Te=F[3][0];we(Pe)<=we(Ue)?Pe=Ar(Pe)*we(Ue)/Yr:Ue=Ar(Ue)*we(Pe)*Yr,es.indexOf("w")>-1?me-=Ue:es.indexOf("e")>-1?Te-=Ue:(me+=Ue/2,Te-=Ue/2),es.indexOf("n")>-1?$s-=Pe:es.indexOf("s")>-1?ye-=Pe:($s+=Pe/2,ye-=Pe/2);var Kr=Rv($s,Te,ye,me);F.forEach(function(Xr,fi){var _r;_r=te(Kr[fi].pos,2),Xr[0]=_r[0],Xr[1]=_r[1]})}else F.forEach(function(mt,ln){var cn=K[ln];cn[0]&&(mt[0]-=Ue),cn[1]&&(mt[1]-=Pe)});var kn=aT(n,b,H),dr="".concat(D,"(").concat(kn.join(V),")");if(P.clipPathState=dr,Y||ne)ae=[F[4][0],F[2][0]],Ce=[F[1][1],F[3][1]];else if(X){var Ne=[F[0],F[2],F[4],F[6]];ae=Ne.map(function(ln){return ln[0]}),Ce=Ne.map(function(ln){return ln[1]})}else ae=F.map(function(mt){return mt[0]}),Ce=F.map(function(mt){return mt[1]});if(P.snapBoundInfos=HD(Me,_.clipTargetBounds&&{left:0,top:0,right:N,bottom:A},ae,Ce,1,1),C){var on=P.is3d,Bc=P.allMatrix,Hs=on?4:3,Ys=Ge;c&&(Ys=[j[0]+Ge[0]-k[0],j[1]+Ge[1]-k[1]]),C.deltaOffset=Yt(Bc,[Ys[0],Ys[1],0,0],Hs)}return je(n,"onClip",dt(n,e,J({clipEventType:"changed",clipType:D,poses:H,clipStyle:dr,clipStyles:kn,distX:E,distY:T},Ir((i={},i[D==="rect"?"clip":"clipPath"]=dr,i),e)))),!0},dragControlEnd:function(n,e){this.unset(n);var t=e.isDrag,r=e.datas,i=e.isDouble,a=r.isLine,s=r.isClipStart,c=r.isControl;return s?(je(n,"onClipEnd",ui(n,e,{})),i&&(c?jee(n,e):a&&Oee(n,e)),i||t):!1},unset:function(n){n.state.clipPathState="",n.state.snapBoundInfos=null}},zee={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(n,e){return e.isRequest?e.requestAble==="originDraggable":Yn(e.inputEvent.target,He("origin"))},dragControlStart:function(n,e){var t=e.datas;zc(n,e);var r=dt(n,e,{dragStart:Tr.dragStart(n,new Cd().dragStart([0,0],e))}),i=je(n,"onDragOriginStart",r);return t.startOrigin=n.state.transformOrigin,t.startTargetOrigin=n.state.targetOrigin,t.prevOrigin=[0,0],t.isDragOrigin=!0,i===!1?(t.isDragOrigin=!1,!1):r},dragControl:function(n,e){var t=e.datas,r=e.isPinch,i=e.isRequest;if(!t.isDragOrigin)return!1;var a=te(Ja(e),2),s=a[0],c=a[1],u=n.state,d=u.width,h=u.height,p=u.offsetMatrix,m=u.targetMatrix,b=u.is3d,_=n.props.originRelative,w=_===void 0?!0:_,E=b?4:3,T=[s,c];if(i){var C=e.distOrigin;(C[0]||C[1])&&(T=C)}var k=It(t.startOrigin,T),j=It(t.startTargetOrigin,T),P=We(T,t.prevOrigin),N=cg(p,m,k,E),A=n.getRect(),I=Oi(Lc(N,d,h,E)),D=[A.left-I.left,A.top-I.top];t.prevOrigin=T;var z=[Ji(j[0],d,w),Ji(j[1],h,w)].join(" "),V=Tr.drag(n,lg(e,n.state,D,!!r)),B=dt(n,e,J(J({width:d,height:h,origin:k,dist:T,delta:P,transformOrigin:z,drag:V},Ir({transformOrigin:z,transform:V.transform},e)),{afterTransform:V.transform}));return je(n,"onDragOrigin",B),B},dragControlEnd:function(n,e){var t=e.datas;return t.isDragOrigin?(je(n,"onDragOriginEnd",ui(n,e,{})),!0):!1},dragGroupControlCondition:function(n,e){return this.dragControlCondition(n,e)},dragGroupControlStart:function(n,e){var t=this.dragControlStart(n,e);return!!t},dragGroupControl:function(n,e){var t=this.dragControl(n,e);return t?(n.transformOrigin=t.transformOrigin,!0):!1},request:function(n){var e={},t=n.getRect(),r=0,i=0,a=t.transformOrigin,s=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(c){return"deltaOrigin"in c?(s[0]+=c.deltaOrigin[0],s[1]+=c.deltaOrigin[1]):"origin"in c?(s[0]=c.origin[0]-a[0],s[1]=c.origin[1]-a[1]):("x"in c?r=c.x-t.left:"deltaX"in c&&(r+=c.deltaX),"y"in c?i=c.y-t.top:"deltaY"in c&&(i+=c.deltaY)),{datas:e,distX:r,distY:i,distOrigin:s}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function Lee(n,e,t,r){var i=n.filter(function(u){var d=u.virtual,h=u.horizontal;return h&&!d}).length,a=n.filter(function(u){var d=u.virtual,h=u.vertical;return h&&!d}).length,s=-1;if(e===0&&(i===0?s=0:i===1&&(s=1)),e===2&&(i<=2?s=2:i<=3&&(s=3)),e===3&&(a===0?s=4:a<4&&(s=7)),e===1&&(a<=1?s=5:a<=2&&(s=6)),!(s===-1||!n[s].virtual)){var c=n[s];Bee(n,s),s<4?c.pos[0]=t:c.pos[1]=r}}function Bee(n,e){e<4?n.slice(0,e+1).forEach(function(t){t.virtual=!1}):(n[0].virtual&&(n[0].virtual=!1),n.slice(4,e+1).forEach(function(t){t.virtual=!1}))}function Uee(n,e){e<4?n.slice(e,4).forEach(function(t){t.virtual=!0}):n.slice(e).forEach(function(t){t.virtual=!0})}function cN(n,e,t,r,i){r===void 0&&(r=[0,0]);var a=[];return!n||n==="0px"?a=[]:a=ol(n),LV(a,e,t,0,0,r,i)}function uN(n,e,t,r,i){var a=n.state,s=a.width,c=a.height,u=iT(i,n.props.roundRelative,s,c),d=u.raws,h=u.styles,p=u.radiusPoses,m=Dee(p,d),b=m.horizontals,_=m.verticals,w=h.join(" ");a.borderRadiusState=w;var E=dt(n,e,J({horizontals:b,verticals:_,borderRadius:w,width:s,height:c,delta:r,dist:t},Ir({borderRadius:w},e)));return je(n,"onRound",E),E}function dN(n){var e,t,r=n.getState().style,i=r.borderRadius||"";if(!i&&n.props.groupable){var a=n.moveables[0],s=n.getTargets()[0];s&&(a?.props.target===s?(i=(t=(e=n.moveables[0])===null||e===void 0?void 0:e.state.style.borderRadius)!==null&&t!==void 0?t:"",r.borderRadius=i):(i=JE(s).borderRadius,r.borderRadius=i))}return i}var Fee={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(n){var e=n.props.roundClickable;return e===!0||e==="line"?He("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(n,e){var t=n.getState(),r=t.target,i=t.width,a=t.height,s=t.allMatrix,c=t.is3d,u=t.left,d=t.top,h=t.borderRadiusState,p=n.props,m=p.minRoundControls,b=m===void 0?[0,0]:m,_=p.maxRoundControls,w=_===void 0?[4,4]:_,E=p.zoom,T=p.roundPadding,C=T===void 0?0:T,k=p.isDisplayShadowRoundControls,j=p.groupable;if(!r)return null;var P=h||dN(n),N=c?4:3,A=cN(P,i,a,b,!0);if(!A)return null;var I=0,D=0,z=j?[0,0]:[u,d];return A.map(function(V,B){var O=V.horizontal,X=V.vertical,K=V.direction||"",$=Ie([],te(V.pos),!1);D+=Math.abs(O),I+=Math.abs(X),O&&K.indexOf("n")>-1&&($[1]-=C),X&&K.indexOf("w")>-1&&($[0]-=C),O&&K.indexOf("s")>-1&&($[1]+=C),X&&K.indexOf("e")>-1&&($[0]+=C);var W=We(un(s,$,N),z),ee=k&&k!=="horizontal",ie=V.vertical?I<=w[1]&&(ee||!V.virtual):D<=w[0]&&(k||!V.virtual);return e.createElement("div",{key:"borderRadiusControl".concat(B),className:He("control","border-radius",V.vertical?"vertical":"",V.virtual?"virtual":""),"data-radius-index":B,style:{display:ie?"block":"none",transform:"translate(".concat(W[0],"px, ").concat(W[1],"px) scale(").concat(E,")")}})})},dragControlCondition:function(n,e){if(!e.inputEvent||e.isRequest)return!1;var t=e.inputEvent.target.getAttribute("class")||"";return t.indexOf("border-radius")>-1||t.indexOf("moveable-line")>-1&&t.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(n,e){return this.dragControlCondition(n,e)},dragControlStart:function(n,e){var t=e.inputEvent,r=e.datas,i=t.target,a=i.getAttribute("class")||"",s=a.indexOf("border-radius")>-1,c=a.indexOf("moveable-line")>-1&&a.indexOf("moveable-direction")>-1,u=s?parseInt(i.getAttribute("data-radius-index"),10):-1,d=-1;if(c){var h=i.getAttribute("data-line-key")||"";h&&(d=parseInt(h.replace(/render-line-/g,""),10),isNaN(d)&&(d=-1))}if(!s&&!c)return!1;var p=dt(n,e,{}),m=je(n,"onRoundStart",p);if(m===!1)return!1;r.lineIndex=d,r.controlIndex=u,r.isControl=s,r.isLine=c,zc(n,e);var b=n.props,_=b.roundRelative,w=b.minRoundControls,E=w===void 0?[0,0]:w,T=n.state,C=T.width,k=T.height;r.isRound=!0,r.prevDist=[0,0];var j=dN(n),P=cN(j||"",C,k,E,!0)||[];return r.controlPoses=P,T.borderRadiusState=iT(P,_,C,k).styles.join(" "),p},dragControl:function(n,e){var t=e.datas,r=t.controlPoses;if(!t.isRound||!t.isControl||!r.length)return!1;var i=t.controlIndex,a=te(Ja(e),2),s=a[0],c=a[1],u=[s,c],d=We(u,t.prevDist),h=n.props.maxRoundControls,p=h===void 0?[4,4]:h,m=n.state,b=m.width,_=m.height,w=r[i],E=w.vertical,T=w.horizontal,C=r.map(function(j){var P=j.horizontal,N=j.vertical,A=[P*T*u[0],N*E*u[1]];if(P){if(p[0]===1)return A;if(p[0]<4&&P!==T)return A}else{if(p[1]===0)return A[1]=N*T*u[0]/b*_,A;if(E){if(p[1]===1)return A;if(p[1]<4&&N!==E)return A}}return[0,0]});C[i]=u;var k=r.map(function(j,P){return J(J({},j),{pos:It(j.pos,C[P])})});return i<4?k.slice(0,i+1).forEach(function(j){j.virtual=!1}):k.slice(4,i+1).forEach(function(j){j.virtual=!1}),t.prevDist=[s,c],uN(n,e,u,d,k)},dragControlEnd:function(n,e){var t=n.state;t.borderRadiusState="";var r=e.datas,i=e.isDouble;if(!r.isRound)return!1;var a=r.isControl,s=r.controlIndex,c=r.isLine,u=r.lineIndex,d=r.controlPoses,h=d.filter(function(T){var C=T.virtual;return C}).length,p=n.props.roundClickable,m=p===void 0?!0:p;if(i&&m){if(a&&(m===!0||m==="control"))Uee(d,s);else if(c&&(m===!0||m==="line")){var b=te(q3(n,e),2),_=b[0],w=b[1];Lee(d,u,_,w)}h!==d.filter(function(T){var C=T.virtual;return C}).length&&uN(n,e,[0,0],[0,0],d)}var E=ui(n,e,{});return je(n,"onRoundEnd",E),t.borderRadiusState="",E},dragGroupControlStart:function(n,e){var t=this.dragControlStart(n,e);if(!t)return!1;var r=n.moveables,i=n.props.targets,a=ia(n,"roundable",e),s=J({targets:n.props.targets,events:a.map(function(c,u){return J(J({},c),{target:i[u],moveable:r[u],currentTarget:r[u]})})},t);return je(n,"onRoundGroupStart",s),t},dragGroupControl:function(n,e){var t=this.dragControl(n,e);if(!t)return!1;var r=n.moveables,i=n.props.targets,a=ia(n,"roundable",e),s=J({targets:n.props.targets,events:a.map(function(c,u){return J(J(J({},c),{target:i[u],moveable:r[u],currentTarget:r[u]}),Ir({borderRadius:t.borderRadius},c))})},t);return je(n,"onRoundGroup",s),s},dragGroupControlEnd:function(n,e){var t=n.moveables,r=n.props.targets,i=ia(n,"roundable",e);Ry(n,"onRound",function(c){var u=J({targets:n.props.targets,events:i.map(function(d,h){return J(J(J({},d),{target:r[h],moveable:t[h],currentTarget:t[h]}),Ir({borderRadius:c.borderRadius},d))})},c);je(n,"onRoundGroup",u)});var a=this.dragControlEnd(n,e);if(!a)return!1;var s=J({targets:n.props.targets,events:i.map(function(c,u){var d;return J(J({},c),{target:r[u],moveable:t[u],currentTarget:t[u],lastEvent:(d=c.datas)===null||d===void 0?void 0:d.lastEvent})})},a);return je(n,"onRoundGroupEnd",s),s},unset:function(n){n.state.borderRadiusState=""}};function Gee(n,e){var t=e?4:3,r=en(t),i="matrix".concat(e?"3d":"","(").concat(r.join(","),")");return n===i||n==="matrix(1,0,0,1,0,0)"}var UV={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(n,e){var t=n.state,r=t.is3d,i=t.targetMatrix,a=t.inlineTransform,s=r?"matrix3d(".concat(i.join(","),")"):"matrix(".concat(D3(i,!0),")"),c=!a||a==="none"?s:a;e.datas.startTransforms=Gee(c,r)?[]:ol(c)},resetStyle:function(n){var e=n.datas;e.nextStyle={},e.nextTransforms=n.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(n,e){return dt(n,e,{setTransform:function(t){e.datas.startTransforms=Gn(t)?t:ol(t)},isPinch:!!e.isPinch})},fillDragParams:function(n,e){return dt(n,e,{isPinch:!!e.isPinch})},dragStart:function(n,e){this.setTransform(n,e),this.resetStyle(e),je(n,"onBeforeRenderStart",this.fillDragStartParams(n,e))},drag:function(n,e){e.datas.startTransforms||this.setTransform(n,e),this.resetStyle(e),je(n,"onBeforeRender",dt(n,e,{isPinch:!!e.isPinch}))},dragEnd:function(n,e){e.datas.startTransforms||(this.setTransform(n,e),this.resetStyle(e)),je(n,"onBeforeRenderEnd",dt(n,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(n,e){var t=this;this.dragStart(n,e);var r=ia(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(s,c){var u=i[c];return t.setTransform(u,s),t.resetStyle(s),t.fillDragStartParams(u,s)});je(n,"onBeforeRenderGroupStart",dt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets,setTransform:function(){},events:a}))},dragGroup:function(n,e){var t=this;this.drag(n,e);var r=ia(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(s,c){var u=i[c];return t.resetStyle(s),t.fillDragParams(u,s)});je(n,"onBeforeRenderGroup",dt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets,events:a}))},dragGroupEnd:function(n,e){this.dragEnd(n,e),je(n,"onBeforeRenderGroupEnd",dt(n,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:n.props.targets}))},dragControlStart:function(n,e){return this.dragStart(n,e)},dragControl:function(n,e){return this.drag(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupControlStart:function(n,e){return this.dragGroupStart(n,e)},dragGroupControl:function(n,e){return this.dragGroup(n,e)},dragGroupControlEnd:function(n,e){return this.dragGroupEnd(n,e)}},FV={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(n,e){je(n,"onRenderStart",dt(n,e,{isPinch:!!e.isPinch}))},drag:function(n,e){je(n,"onRender",this.fillDragParams(n,e))},dragAfter:function(n,e){return this.drag(n,e)},dragEnd:function(n,e){je(n,"onRenderEnd",this.fillDragEndParams(n,e))},dragGroupStart:function(n,e){je(n,"onRenderGroupStart",dt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets}))},dragGroup:function(n,e){var t=this,r=ia(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(s,c){var u=i[c];return t.fillDragParams(u,s)});je(n,"onRenderGroup",dt(n,e,J(J({isPinch:!!e.isPinch,targets:n.props.targets,transform:e0(e),transformObject:{}},Ir(t0(e))),{events:a})))},dragGroupEnd:function(n,e){var t=this,r=ia(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(s,c){var u=i[c];return t.fillDragEndParams(u,s)});je(n,"onRenderGroupEnd",dt(n,e,J({isPinch:!!e.isPinch,isDrag:e.isDrag,targets:n.props.targets,events:a,transformObject:{},transform:e0(e)},Ir(t0(e)))))},dragControlStart:function(n,e){return this.dragStart(n,e)},dragControl:function(n,e){return this.drag(n,e)},dragControlAfter:function(n,e){return this.dragAfter(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupControlStart:function(n,e){return this.dragGroupStart(n,e)},dragGroupControl:function(n,e){return this.dragGroup(n,e)},dragGroupControlEnd:function(n,e){return this.dragGroupEnd(n,e)},fillDragParams:function(n,e){var t={};return Ad(wv(e)||[]).forEach(function(r){t[r.name]=r.functionValue}),dt(n,e,J({isPinch:!!e.isPinch,transformObject:t,transform:e0(e)},Ir(t0(e))))},fillDragEndParams:function(n,e){var t={};return Ad(wv(e)||[]).forEach(function(r){t[r.name]=r.functionValue}),dt(n,e,J({isPinch:!!e.isPinch,isDrag:e.isDrag,transformObject:t,transform:e0(e)},Ir(t0(e))))}};function Gh(n,e,t,r,i,a,s){a.clientDistX=a.distX,a.clientDistY=a.distY;var c=i==="Start",u=i==="End",d=i==="After",h=n.state.target,p=a.isRequest,m=r.indexOf("Control")>-1;if(!h||c&&m&&!p&&n.areaElement===a.inputEvent.target)return!1;var b=Ie([],te(e),!1);if(p){var _=a.requestAble;b.some(function(B){return B.name===_})||b.push.apply(b,Ie([],te(n.props.ables.filter(function(B){return B.name===_})),!1))}if(!b.length||b.every(function(B){return B.dragRelation}))return!1;var w=a.inputEvent,E;u&&w&&(E=document.elementFromPoint(a.clientX,a.clientY)||w.target);var T=!1,C=function(){var B;T=!0,(B=a.stop)===null||B===void 0||B.call(a)},k=c&&(!n.targetGesto||!n.controlGesto||!n.targetGesto.isFlag()||!n.controlGesto.isFlag());k&&n.updateRect(i,!0,!1);var j=a.datas,P=m?"controlGesto":"targetGesto",N=n[P],A=function(B,O,X){if(!(O in B)||N!==n[P])return!1;var K=B.name,$=j[K]||(j[K]={});if(c&&($.isEventStart=!X||!B[X]||B[X](n,a)),!$.isEventStart)return!1;var W=B[O](n,J(J({},a),{stop:C,datas:$,originalDatas:j,inputTarget:E}));return n._emitter.off(),c&&W===!1&&($.isEventStart=!1),W};k&&b.forEach(function(B){B.unset&&B.unset(n)}),A(UV,"drag".concat(r).concat(i));var I=0,D=0;t.forEach(function(B){if(T)return!1;var O="".concat(B).concat(r).concat(i),X="".concat(B).concat(r,"Condition");i===""&&!p&&fee(n.state,a);var K=b.filter(function(ee){return ee[O]});K=K.filter(function(ee,ie){return ee.name&&K.indexOf(ee)===ie});var $=K.filter(function(ee){return A(ee,O,X)}),W=$.length;T&&++I,W&&++D,!T&&c&&K.length&&!W&&(I+=K.filter(function(ee){var ie=ee.name,H=j[ie];return H.isEventStart?ee.dragRelation!=="strong":!1}).length?1:0)}),(!d||D)&&A(FV,"drag".concat(r).concat(i));var z=N!==n[P]||I===t.length;if((u||T||z)&&(n.state.gestos={},n.moveables&&n.moveables.forEach(function(B){B.state.gestos={}}),b.forEach(function(B){B.unset&&B.unset(n)})),c&&!z&&!p&&D&&n.props.preventDefault&&a?.preventDefault(),n.isUnmounted||z)return!1;if(!c&&D&&!s||u){var V=n.props.flushSync||bV;V(function(){n.updateRect(u?i:"",!0,!1),n.forceUpdate()})}return!c&&!u&&!d&&D&&!s&&Gh(n,e,t,r,i+"After",a),!0}function sT(n,e){return function(t,r){var i;r===void 0&&(r=t.inputEvent.target);var a=r,s=n.areaElement,c=n._dragTarget;return!c||!e&&(!((i=n.controlGesto)===null||i===void 0)&&i.isFlag())?!1:a===c||c.contains(a)||a===s||!n.isMoveableElement(a)&&!n.controlBox.contains(a)||Yn(a,"moveable-area")||Yn(a,"moveable-padding")||Yn(a,"moveable-edgeDraggable")}}function GV(n,e,t){var r=n.controlBox,i=[],a=n.props,s=a.dragArea,c=n.state.target,u=a.dragTarget;i.push(r),(!s||u)&&i.push(e),!s&&u&&c&&e!==c&&a.dragTargetSelf&&i.push(c);var d=sT(n);return $V(n,i,"targetAbles",t,{dragStart:d,pinchStart:d})}function qV(n,e){var t=n.controlBox,r=[];r.push(t);var i=sT(n,!0),a=function(s,c){if(c===void 0&&(c=s.inputEvent.target),c===t)return!0;var u=i(s,c);return!u};return $V(n,r,"controlAbles",e,{dragStart:a,pinchStart:a})}function $V(n,e,t,r,i){i===void 0&&(i={});var a=t==="targetAbles",s=n.props,c=s.pinchOutside,u=s.pinchThreshold,d=s.preventClickEventOnDrag,h=s.preventClickDefault,p=s.checkInput,m=s.dragFocusedInput,b=s.preventDefault,_=b===void 0?!0:b,w=s.preventRightClick,E=w===void 0?!0:w,T=s.preventWheelClick,C=T===void 0?!0:T,k=s.dragContainer,j=Ha(k,!0),P={preventDefault:_,preventRightClick:E,preventWheelClick:C,container:j||Qo(n.getControlBoxElement()),pinchThreshold:u,pinchOutside:c,preventClickEventOnDrag:a?d:!1,preventClickEventOnDragStart:a?h:!1,preventClickEventByCondition:a?null:function(I){return n.controlBox.contains(I.target)},checkInput:a?p:!1,dragFocusedInput:m},N=new mZ(e,P),A=r==="Control";return["drag","pinch"].forEach(function(I){["Start","","End"].forEach(function(D){N.on("".concat(I).concat(D),function(z){var V,B=z.eventType,O=I==="drag"&&z.isPinch;if(i[B]&&!i[B](z)){z.stop();return}if(!O){var X=I==="drag"?[I]:["drag",I],K=Ie([],te(n[t]),!1),$=Gh(n,K,X,r,D,z);$?(n.props.stopPropagation||D==="Start"&&A)&&((V=z?.inputEvent)===null||V===void 0||V.stopPropagation()):z.stop()}})})}),N}var qee=(function(){function n(e,t,r){var i=this;this.target=e,this.moveable=t,this.eventName=r,this.ables=[],this._onEvent=function(a){var s=i.eventName,c=i.moveable;c.state.disableNativeEvent||i.ables.forEach(function(u){u[s](c,{inputEvent:a})})},e.addEventListener(r.toLowerCase(),this._onEvent)}return n.prototype.setAbles=function(e){this.ables=e},n.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},n})();function $ee(n,e,t,r){var i;t===void 0&&(t=e);var a=W3(n,e),s=a.matrixes,c=a.is3d,u=a.targetMatrix,d=a.transformOrigin,h=a.targetOrigin,p=a.offsetContainer,m=a.hasFixed,b=a.zoom,_=aJ(p,t),w=_.matrixes,E=_.is3d,T=_.offsetContainer,C=_.zoom,k=r,j=4,P=n.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in n,N=u,A=en(j),I=en(j),D=en(j),z=en(j),V=s.length,B=w.map(function(ie){return J(J({},ie),{matrix:ie.matrix?Ie([],te(ie.matrix),!1):void 0})}).reverse();s.reverse(),!c&&k&&(N=ca(N,3,4),mw(s)),!E&&k&&mw(B),B.forEach(function(ie){I=Yt(I,ie.matrix,j)});var O=t||vl(n),X=((i=B[0])===null||i===void 0?void 0:i.target)||wp(O,O,!0).offsetParent,K=B.slice(1).reduce(function(ie,H){return Yt(ie,H.matrix,j)},en(j));s.forEach(function(ie,H){if(V-2===H&&(D=A.slice()),V-1===H&&(z=A.slice()),!ie.matrix){var F=s[H+1],Y=lee(ie,F,X,j,Yt(K,A,j));ie.matrix=Dc(Y,j)}A=Yt(A,ie.matrix,j)});var $=!P&&c;N||(N=en($?4:3));var W=Iy(P&&N.length===16?ca(N,4,3):N,$),ee=I;return I=R3(I,j,j),{hasZoom:b!==1||C!==1,hasFixed:m,matrixes:s,rootMatrix:I,originalRootMatrix:ee,beforeMatrix:D,offsetMatrix:z,allMatrix:A,targetMatrix:N,targetTransform:W,inlineTransform:n.style.transform,transformOrigin:d,targetOrigin:h,is3d:k,offsetContainer:p,offsetRootContainer:T}}function Hee(n,e,t,r){t===void 0&&(t=e);var i=0,a=0,s=0,c={},u=SV(n);if(n&&(i=u.offsetWidth,a=u.offsetHeight),n){var d=$ee(n,e,t,r),h=id(d.allMatrix,d.transformOrigin,i,a);c=J(J({},d),h);var p=id(d.allMatrix,[50,50],100,100);s=EV([p.pos1,p.pos2],p.direction)}var m=4;return J(J(J({hasZoom:!1,width:i,height:a,rotation:s},u),{originalRootMatrix:en(m),rootMatrix:en(m),beforeMatrix:en(m),offsetMatrix:en(m),allMatrix:en(m),targetMatrix:en(m),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!0,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),c)}function xw(n,e,t,r,i,a){a===void 0&&(a=[]);var s=1,c=[0,0],u=r0(),d=r0(),h=r0(),p=r0(),m=[0,0],b={},_=Hee(e,t,i,!0);if(e){var w=$r(e);a.forEach(function(B){b[B]=w(B)});var E=_.is3d?4:3,T=id(_.offsetMatrix,It(_.transformOrigin,k3(_.targetMatrix,E)),_.width,_.height);s=T.direction,c=It(T.origin,[T.left-_.left,T.top-_.top]),p=Fh(_.offsetRootContainer);var C=wp(r,r,!0).offsetParent||_.offsetRootContainer;if(_.hasZoom){var k=id(Yt(_.originalRootMatrix,_.allMatrix),_.transformOrigin,_.width,_.height),j=id(_.originalRootMatrix,Av($r(C)("transformOrigin")).map(function(B){return parseFloat(B)}),C.offsetWidth,C.offsetHeight);if(u=k1(k,p),h=k1(j,p,C,!0),n){var P=k.left,N=k.top;d=k1({left:P,top:N,bottom:N,right:N},p)}}else{u=Fh(e),h=iJ(C),n&&(d=Fh(n));var A=h.left,I=h.top,D=h.clientLeft,z=h.clientTop,V=[u.left-A,u.top-I];m=We(kd(_.rootMatrix,V,4),[D+_.left,z+_.top])}}return J({targetClientRect:u,containerClientRect:h,moveableClientRect:d,rootContainerClientRect:p,beforeDirection:s,beforeOrigin:c,originalBeforeOrigin:c,target:e,style:b,offsetDelta:m},_)}function fN(n){var e=n.pos1,t=n.pos2,r=n.pos3,i=n.pos4;if(!e||!t||!r||!i)return null;var a=Nc([e,t,r,i]),s=[a.minX,a.minY],c=We(n.origin,s);return e=We(e,s),t=We(t,s),r=We(r,s),i=We(i,s),J(J({},n),{left:n.left,top:n.top,posDelta:s,pos1:e,pos2:t,pos3:r,pos4:i,origin:c,beforeOrigin:c,isPersisted:!0})}var Dd=(function(n){sg(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.state=J({container:null,gestos:{},renderLines:[[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]]],renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},xw(null)),t.renderState={},t.enabledAbles=[],t.targetAbles=[],t.controlAbles=[],t.rotation=0,t.scale=[1,1],t.isMoveableMounted=!1,t.isUnmounted=!1,t.events={mouseEnter:null,mouseLeave:null},t._emitter=new xy,t._prevOriginalDragTarget=null,t._originalDragTarget=null,t._prevDragTarget=null,t._dragTarget=null,t._prevPropTarget=null,t._propTarget=null,t._prevDragArea=!1,t._isPropTargetChanged=!1,t._hasFirstTarget=!1,t._reiszeObserver=null,t._observerId=0,t._mutationObserver=null,t._rootContainer=null,t._viewContainer=null,t._viewClassNames=[],t._store={},t.checkUpdateRect=function(){if(!t.isDragging()){var r=t.props.parentMoveable;if(r){r.checkUpdateRect();return}oQ(t._observerId),t._observerId=r3(function(){t.isDragging()||t.updateRect()})}},t._onPreventClick=function(r){r.stopPropagation(),r.preventDefault()},t}return e.prototype.render=function(){var t=this.props,r=this.getState(),i=t.parentPosition,a=t.className,s=t.target,c=t.zoom,u=t.cspNonce,d=t.translateZ,h=t.cssStyled,p=t.groupable,m=t.linePadding,b=t.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var _=te(i||[0,0],2),w=_[0],E=_[1],T=r.left,C=r.top,k=r.target,j=r.direction,P=r.hasFixed,N=r.offsetDelta,A=t.targets,I=this.isDragging(),D={};this.getEnabledAbles().forEach(function(K){D["data-able-".concat(K.name.toLowerCase())]=!0});var z=this._getAbleClassName(),V=A&&A.length&&(k||p)||s||!this._hasFirstTarget&&this.state.isPersisted,B=this.controlBox||this.props.firstRenderState||this.props.persistData,O=[T-w,C-E];!p&&t.useAccuratePosition&&(O[0]+=N[0],O[1]+=N[1]);var X={position:P?"fixed":"absolute",display:V?"block":"none",visibility:B?"visible":"hidden",transform:"translate3d(".concat(O[0],"px, ").concat(O[1],"px, ").concat(d,")"),"--zoom":c,"--zoompx":"".concat(c,"px")};return m&&(X["--moveable-line-padding"]=m),b&&(X["--moveable-control-padding"]=b),ra(h,J({cspNonce:u,ref:Rs(this,"controlBox"),className:"".concat(He("control-box",j===-1?"reverse":"",I?"dragging":"")," ").concat(z," ").concat(a)},D,{onClick:this._onPreventClick,style:X}),this.renderAbles(),this._renderLines())},e.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var t=this.props,r=t.parentMoveable,i=t.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!r&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},e.prototype.componentDidUpdate=function(t){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(t)},e.prototype.componentWillUnmount=function(){var t,r;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(t=this._reiszeObserver)===null||t===void 0||t.disconnect(),(r=this._mutationObserver)===null||r===void 0||r.disconnect();var i=this._viewContainer;i&&this._changeAbleViewClassNames([]),Xu(this,!1),Xu(this,!0);var a=this.events;for(var s in a){var c=a[s];c&&c.destroy()}},e.prototype.getTargets=function(){var t=this.props.target;return t?[t]:[]},e.prototype.getAble=function(t){var r=this.props.ables||[];return qr(r,function(i){return i.name===t})},e.prototype.getContainer=function(){var t=this.props,r=t.parentMoveable,i=t.wrapperMoveable,a=t.container;return a||i&&i.getContainer()||r&&r.getContainer()||this.controlBox.parentElement},e.prototype.getControlBoxElement=function(){return this.controlBox},e.prototype.getDragElement=function(){return this._dragTarget},e.prototype.isMoveableElement=function(t){var r;return t&&(((r=t.getAttribute)===null||r===void 0?void 0:r.call(t,"class"))||"").indexOf(UE)>-1},e.prototype.dragStart=function(t,r){r===void 0&&(r=t.target);var i=this.targetGesto,a=this.controlGesto;return i&&sT(this)({inputEvent:t},r)?i.isFlag()||i.triggerDragStart(t):a&&this.isMoveableElement(r)&&(a.isFlag()||a.triggerDragStart(t)),this},e.prototype.hitTest=function(t){var r=this.state,i=r.target,a=r.pos1,s=r.pos2,c=r.pos3,u=r.pos4,d=r.targetClientRect;if(!i)return 0;var h;if(Xd(t)){var p=t.getBoundingClientRect();h={left:p.left,top:p.top,width:p.width,height:p.height}}else h=J({width:0,height:0},t);var m=h.left,b=h.top,_=h.width,w=h.height,E=OD([a,s,u,c],d),T=uZ(E,[[m,b],[m+_,b],[m+_,b+w],[m,b+w]]),C=P3(E);return!T||!C?0:Math.min(100,T/C*100)},e.prototype.isInside=function(t,r){var i=this.state,a=i.target,s=i.pos1,c=i.pos2,u=i.pos3,d=i.pos4,h=i.targetClientRect;return a?rw([t,r],OD([s,c,d,u],h)):!1},e.prototype.updateRect=function(t,r,i){i===void 0&&(i=!0);var a=this.props,s=!a.parentPosition&&!a.wrapperMoveable;s&&Id(!0);var c=a.parentMoveable,u=this.state,d=u.target||a.target,h=this.getContainer(),p=c?c._rootContainer:this._rootContainer,m=xw(this.controlBox,d,h,h,p||h,this._getRequestStyles());if(!d&&this._hasFirstTarget&&a.persistData){var b=fN(a.persistData);for(var _ in b)m[_]=b[_]}s&&Id(),this.updateState(m,c?!1:i)},e.prototype.isDragging=function(t){var r,i,a=this.targetGesto,s=this.controlGesto;if(a?.isFlag()){if(!t)return!0;var c=a.getEventData();return!!(!((r=c[t])===null||r===void 0)&&r.isEventStart)}if(s?.isFlag()){if(!t)return!0;var c=s.getEventData();return!!(!((i=c[t])===null||i===void 0)&&i.isEventStart)}return!1},e.prototype.updateTarget=function(t){this.updateRect(t,!0)},e.prototype.getRect=function(){var t=this.state,r=zi(this.state),i=te(r,4),a=i[0],s=i[1],c=i[2],u=i[3],d=Oi(r),h=t.width,p=t.height,m=d.width,b=d.height,_=d.left,w=d.top,E=[t.left,t.top],T=It(E,t.origin),C=It(E,t.beforeOrigin),k=t.transformOrigin;return{width:m,height:b,left:_,top:w,pos1:a,pos2:s,pos3:c,pos4:u,offsetWidth:h,offsetHeight:p,beforeOrigin:C,origin:T,transformOrigin:k,rotation:this.getRotation()}},e.prototype.getManager=function(){return this},e.prototype.stopDrag=function(t){if(!t||t==="target"){var r=this.targetGesto;r?.isIdle()===!1&&vw(this,!1),r?.stop()}if(!t||t==="control"){var r=this.controlGesto;r?.isIdle()===!1&&vw(this,!0),r?.stop()}},e.prototype.getRotation=function(){var t=this.state,r=t.pos1,i=t.pos2,a=t.direction;return gee(r,i,a)},e.prototype.request=function(t,r,i){r===void 0&&(r={});var a=this,s=a.props,c=s.parentMoveable||s.wrapperMoveable||a,u=c.props.ables,d=s.groupable,h=qr(u,function(T){return T.name===t});if(this.isDragging()||!h||!h.request)return{request:function(){return this},requestEnd:function(){return this}};var p=h.request(a),m=i||r.isInstant,b=p.isControl?"controlAbles":"targetAbles",_="".concat(d?"Group":"").concat(p.isControl?"Control":""),w=Ie([],te(c[b]),!1),E={request:function(T){return Gh(a,w,["drag"],_,"",J(J({},p.request(T)),{requestAble:t,isRequest:!0}),m),E},requestEnd:function(){return Gh(a,w,["drag"],_,"End",J(J({},p.requestEnd()),{requestAble:t,isRequest:!0}),m),E}};return Gh(a,w,["drag"],_,"Start",J(J({},p.requestStart(r)),{requestAble:t,isRequest:!0}),m),m?E.request(r).requestEnd():E},e.prototype.getMoveables=function(){return[this]},e.prototype.destroy=function(){this.componentWillUnmount()},e.prototype.updateRenderPoses=function(){var t=this.getState(),r=this.props,i=r.padding,a=t.originalBeforeOrigin,s=t.transformOrigin,c=t.allMatrix,u=t.is3d,d=t.pos1,h=t.pos2,p=t.pos3,m=t.pos4,b=t.left,_=t.top,w=t.isPersisted,E=r.zoom||1;if(!i&&E<=1){t.renderPoses=[d,h,p,m],t.renderLines=[[d,h],[h,m],[m,p],[p,d]];return}var T=PV(i||{}),C=T.left,k=T.top,j=T.bottom,P=T.right,N=u?4:3,A=[];w?A=s:this.controlBox&&r.groupable?A=a:A=It(a,[b,_]);var I=xv(N,Dc(A.map(function(X){return-X}),N),c,Dc(s,N)),D=Ai(I,d,[-C,-k],N),z=Ai(I,h,[P,-k],N),V=Ai(I,p,[-C,j],N),B=Ai(I,m,[P,j],N);t.renderPoses=[D,z,V,B],t.renderLines=[[D,z],[z,B],[B,V],[V,D]];{var O=E/2;t.renderLines=[[Ai(I,d,[-C-O,-k],N),Ai(I,h,[P+O,-k],N)],[Ai(I,h,[P,-k-O],N),Ai(I,m,[P,j+O],N)],[Ai(I,m,[P+O,j],N),Ai(I,p,[-C-O,j],N)],[Ai(I,p,[-C,j+O],N),Ai(I,d,[-C,-k-O],N)]]}},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var t=this.props,r=t.target,i=t.container,a=t.parentMoveable,s=this.state,c=s.target,u=s.container;if(!(!c&&!r)){this.updateAbles();var d=!yw(c,r),h=d||!yw(u,i);if(h){var p=i||this.controlBox;p&&this.unsetAbles(),this.updateState({target:r,container:i}),!a&&p&&this.updateRect("End",!1,!1),this._isPropTargetChanged=d}}},e.prototype.waitToChangeTarget=function(){return new Promise(function(){})},e.prototype.triggerEvent=function(t,r){var i=this.props;if(this._emitter.trigger(t,r),i.parentMoveable&&r.isRequest&&!r.isRequestChild)return i.parentMoveable.triggerEvent(t,r,!0);var a=i[t];return a&&a(r)},e.prototype.useCSS=function(t,r){var i=this.props.customStyledMap,a=t+r;return i[a]||(i[a]=V3(t,r)),i[a]},e.prototype.getState=function(){var t,r=this.props;(r.target||!((t=r.targets)===null||t===void 0)&&t.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,a=r.persistData,s=r.firstRenderState;if(s&&!i)return s;if(!this._hasFirstTarget&&a){var c=fN(a);if(c)return this.updateState(c,!1),this.state}return this.state.isPersisted=!1,this.state},e.prototype.updateSelectors=function(){},e.prototype.unsetAbles=function(){var t=this;this.targetAbles.forEach(function(r){r.unset&&r.unset(t)})},e.prototype.updateAbles=function(t,r){t===void 0&&(t=this.props.ables),r===void 0&&(r="");var i=this.props,a=i.triggerAblesSimultaneously,s=this.getEnabledAbles(t),c="drag".concat(r,"Start"),u="pinch".concat(r,"Start"),d="drag".concat(r,"ControlStart"),h=i0(s,[c,u],a),p=i0(s,[d],a);this.enabledAbles=s,this.targetAbles=h,this.controlAbles=p},e.prototype.updateState=function(t,r){if(r){if(this.isUnmounted)return;this.setState(t)}else{var i=this.state;for(var a in t)i[a]=t[a]}},e.prototype.getEnabledAbles=function(t){t===void 0&&(t=this.props.ables);var r=this.props;return t.filter(function(i){return i&&(i.always&&r[i.name]!==!1||r[i.name])})},e.prototype.renderAbles=function(){var t=this,r=this.props,i=r.triggerAblesSimultaneously,a={createElement:ra};return this.renderState={},dee(kV(i0(this.getEnabledAbles(),["render"],i).map(function(s){var c=s.render;return c(t,a)||[]})).filter(function(s){return s}),function(s){var c=s.key;return c}).map(function(s){return s[0]})},e.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},e.prototype._getRequestStyles=function(){var t=this.getEnabledAbles().reduce(function(r,i){var a,s,c=(s=(a=i.requestStyle)===null||a===void 0?void 0:a.call(i))!==null&&s!==void 0?s:[];return Ie(Ie([],te(r),!1),te(c),!1)},Ie([],te(this.props.requestStyles||[]),!1));return t},e.prototype._updateObserver=function(t){this._updateResizeObserver(t),this._updateMutationObserver(t)},e.prototype._updateEvents=function(){var t=this.targetAbles.length,r=this.controlAbles.length,i=this._dragTarget,a=!t&&this.targetGesto||this._isTargetChanged(!0);a&&(Xu(this,!1),this.updateState({gestos:{}})),r||Xu(this,!0),i&&t&&!this.targetGesto&&(this.targetGesto=GV(this,i,"")),!this.controlGesto&&r&&(this.controlGesto=qV(this,"Control"))},e.prototype._updateTargets=function(){var t=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=t.dragArea,this._propTarget=t.target,this._originalDragTarget=t.dragTarget||t.target,this._dragTarget=Ha(this._originalDragTarget,!0)},e.prototype._renderLines=function(){var t=this.props,r=t,i=r.zoom,a=r.hideDefaultLines,s=r.hideChildMoveableDefaultLines,c=r.parentMoveable;if(a||c&&s)return[];var u=this.getState(),d={createElement:ra};return u.renderLines.map(function(h,p){return _p(d,"",h[0],h[1],i,"render-line-".concat(p))})},e.prototype._isTargetChanged=function(t){var r=this.props,i=r.dragTarget||r.target,a=this._prevOriginalDragTarget,s=this._prevDragArea,c=r.dragArea,u=!c&&a!==i,d=(t||c)&&s!==c;return u||d||this._prevPropTarget!=this._propTarget},e.prototype._updateNativeEvents=function(){var t=this,r=this.props,i=r.dragArea?this.areaElement:this.state.target,a=this.events,s=Bs(a);if(this._isTargetChanged())for(var c in a){var u=a[c];u&&u.destroy(),a[c]=null}if(i){var d=this.enabledAbles;s.forEach(function(h){var p=i0(d,[h]),m=p.length>0,b=a[h];if(!m){b&&(b.destroy(),a[h]=null);return}b||(b=new qee(i,t,h),a[h]=b),b.setAbles(p)})}},e.prototype._checkUpdateRootContainer=function(){var t=this.props.rootContainer;!this._rootContainer&&t&&(this._rootContainer=Ha(t,!0))},e.prototype._checkUpdateViewContainer=function(){var t=this.props.viewContainer;!this._viewContainer&&t&&(this._viewContainer=Ha(t,!0));var r=this._viewContainer;r&&this._changeAbleViewClassNames(Ie(Ie([],te(this._getAbleViewClassNames()),!1),[this.isDragging()?wee:""],!1))},e.prototype._changeAbleViewClassNames=function(t){var r=this._viewContainer,i=RV(t.filter(Boolean),function(d){return d}).map(function(d){var h=te(d,1),p=h[0];return p}),a=this._viewClassNames,s=tg(a,i),c=s.removed,u=s.added;c.forEach(function(d){l3(r,a[d])}),u.forEach(function(d){o3(r,i[d])}),this._viewClassNames=i},e.prototype._getAbleViewClassNames=function(){var t=this;return(this.getEnabledAbles().map(function(r){var i;return((i=r.viewClassName)===null||i===void 0?void 0:i.call(r,t))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},e.prototype._getAbleClassName=function(t){var r=this;t===void 0&&(t="");var i=this.getEnabledAbles(),a=this.targetGesto,s=this.controlGesto,c=a?.isFlag()?a.getEventData():{},u=s?.isFlag()?s.getEventData():{};return i.map(function(d){var h,p,m,b=d.name,_=((h=d.className)===null||h===void 0?void 0:h.call(d,r))||"";return(!((p=c[b])===null||p===void 0)&&p.isEventStart||!((m=u[b])===null||m===void 0)&&m.isEventStart)&&(_+=" ".concat(He("".concat(b).concat(t,"-dragging")))),_.trim()}).filter(Boolean).join(" ")},e.prototype._updateResizeObserver=function(t){var r,i=this.props,a=i.target,s=Qo(this.getControlBoxElement());if(!s.ResizeObserver||!a||!i.useResizeObserver){(r=this._reiszeObserver)===null||r===void 0||r.disconnect();return}if(!(t.target===a&&this._reiszeObserver)){var c=new s.ResizeObserver(this.checkUpdateRect);c.observe(a,{box:"border-box"}),this._reiszeObserver=c}},e.prototype._updateMutationObserver=function(t){var r=this,i,a=this.props,s=a.target,c=Qo(this.getControlBoxElement());if(!c.MutationObserver||!s||!a.useMutationObserver){(i=this._mutationObserver)===null||i===void 0||i.disconnect();return}if(!(t.target===s&&this._mutationObserver)){var u=new c.MutationObserver(function(d){var h,p;try{for(var m=CZ(d),b=m.next();!b.done;b=m.next()){var _=b.value;_.type==="attributes"&&_.attributeName==="style"&&r.checkUpdateRect()}}catch(w){h={error:w}}finally{try{b&&!b.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}});u.observe(s,{attributes:!0}),this._mutationObserver=u}},e.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:bV,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},e})(g3),oT={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(n,e){var t,r=n.props,i=r.targets||[],a=n.getState(),s=a.left,c=a.top,u=a.isPersisted,d=r.zoom||1,h=n.renderGroupRects,p=((t=r.persistData)===null||t===void 0?void 0:t.children)||[];u?i=p.map(function(){return null}):p=[];var m=Wu(n,"parentPosition",[s,c],function(_){return _.join(",")}),b=Wu(n,"requestStyles",n.getRequestChildStyles(),function(_){return _.join(",")});return n.moveables=n.moveables.slice(0,i.length),Ie(Ie([],te(i.map(function(_,w){return e.createElement(Dd,{key:"moveable"+w,ref:Jj(n,"moveables",w),target:_,origin:!1,requestStyles:b,cssStyled:r.cssStyled,customStyledMap:r.customStyledMap,useResizeObserver:r.useResizeObserver,useMutationObserver:r.useMutationObserver,hideChildMoveableDefaultLines:r.hideChildMoveableDefaultLines,parentMoveable:n,parentPosition:[s,c],persistData:p[w],zoom:d})})),!1),te(kV(h.map(function(_,w){var E=_.pos1,T=_.pos2,C=_.pos3,k=_.pos4,j=[E,T,C,k];return[[0,1],[1,3],[3,2],[2,0]].map(function(P,N){var A=te(P,2),I=A[0],D=A[1];return _p(e,"",We(j[I],m),We(j[D],m),d,"group-rect-".concat(w,"-").concat(N))})}))),!1)}},Yee=og("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(n,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(n,e){var t=n.props.target,r=e.inputEvent,i=e.inputTarget,a=n.isMoveableElement(i),s=!a&&n.controlBox.contains(i);if(!(!r||!i||e.isDrag||n.isMoveableElement(i)||s)){var c=t.contains(i);je(n,"onClick",dt(n,e,{isDouble:e.isDouble,inputTarget:i,isTarget:t===i,moveableTarget:n.props.target,containsTarget:c}))}},dragGroupEnd:function(n,e){var t=e.inputEvent,r=e.inputTarget;if(!(!t||!r||e.isDrag||n.isMoveableElement(r)||e.datas.inputTarget===r)){var i=n.props.targets,a=i.indexOf(r),s=a>-1,c=!1;a===-1&&(a=Ls(i,function(u){return u.contains(r)}),c=a>-1),je(n,"onClickGroup",dt(n,e,{isDouble:e.isDouble,targets:i,inputTarget:r,targetIndex:a,isTarget:s,containsTarget:c,moveableTarget:i[a]}))}},dragControlEnd:function(n,e){this.dragEnd(n,e)},dragGroupControlEnd:function(n,e){this.dragEnd(n,e)}});function Mu(n){var e=n.originalDatas.draggable;return e||(n.originalDatas.draggable={},e=n.originalDatas.draggable),J(J({},n),{datas:e})}var Kee=og("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(n,e){var t=n.props,r=t.edgeDraggable;return r?J3(e,"edgeDraggable",r,n.getState().renderPoses,t.zoom):[]},dragCondition:function(n,e){var t,r=n.props,i=(t=e.inputEvent)===null||t===void 0?void 0:t.target;return!r.edgeDraggable||!i?!1:!r.draggable&&Yn(i,He("direction"))&&Yn(i,He("edge"))&&Yn(i,He("edgeDraggable"))},dragStart:function(n,e){return Tr.dragStart(n,Mu(e))},drag:function(n,e){return Tr.drag(n,Mu(e))},dragEnd:function(n,e){return Tr.dragEnd(n,Mu(e))},dragGroupCondition:function(n,e){var t,r=n.props,i=(t=e.inputEvent)===null||t===void 0?void 0:t.target;return!r.edgeDraggable||!i?!1:!r.draggable&&Yn(i,He("direction"))&&Yn(i,He("line"))},dragGroupStart:function(n,e){return Tr.dragGroupStart(n,Mu(e))},dragGroup:function(n,e){return Tr.dragGroup(n,Mu(e))},dragGroupEnd:function(n,e){return Tr.dragGroupEnd(n,Mu(e))},unset:function(n){return Tr.unset(n)}}),HV={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},lT=[UV,VV,ZJ,vee,Tr,Kee,hw,yee,xee,PJ,Tee,Aee,See,zee,Vee,Fee,oT,HV,Yee,jV,FV],Xee=lT.reduce(function(n,e){return(e.events||[]).forEach(function(t){s3(n,t)}),n},[]),Wee=lT.reduce(function(n,e){return(e.props||[]).forEach(function(t){s3(n,t)}),n},[]);function hN(n,e){var t=te(n,3),r=t[0],i=t[1],a=t[2];return(r*e[0]+i*e[1]+a)/Math.sqrt(r*r+i*i)}function o0(n,e){var t=te(n,2),r=t[0],i=t[1];return-r*e[0]-i*e[1]}function pN(n,e){return Math.max.apply(Math,Ie([],te(n.map(function(t){var r=te(t,4),i=r[0],a=r[1],s=r[2],c=r[3];return Math.max(i[e],a[e],s[e],c[e])})),!1))}function gN(n,e){return Math.min.apply(Math,Ie([],te(n.map(function(t){var r=te(t,4),i=r[0],a=r[1],s=r[2],c=r[3];return Math.min(i[e],a[e],s[e],c[e])})),!1))}function Qee(n,e){var t,r,i,a=[0,0],s=[0,0],c=[0,0],u=[0,0],d=0,h=0;if(!n.length)return{pos1:a,pos2:s,pos3:c,pos4:u,minX:0,minY:0,maxX:0,maxY:0,width:d,height:h,rotation:e};var p=st(e,kr);if(p%90){var m=p/180*Math.PI,b=Math.tan(m),_=-1/b,w=[cw,zD],E=[[0,0],[0,0]],T=[cw,zD],C=[[0,0],[0,0]];n.forEach(function(ne){ne.forEach(function(Z){var oe=hN([-b,1,0],Z),ue=hN([-_,1,0],Z);w[0]>oe&&(E[0]=Z,w[0]=oe),w[1]<oe&&(E[1]=Z,w[1]=oe),T[0]>ue&&(C[0]=Z,T[0]=ue),T[1]<ue&&(C[1]=Z,T[1]=ue)})});var k=te(E,2),j=k[0],P=k[1],N=te(C,2),A=N[0],I=N[1],D=[-b,1,o0([-b,1],j)],z=[-b,1,o0([-b,1],P)],V=[-_,1,o0([-_,1],A)],B=[-_,1,o0([-_,1],I)];t=te([[D,V],[D,B],[z,V],[z,B]].map(function(ne){var Z=te(ne,2),oe=Z[0],ue=Z[1];return LE(oe,ue)[0]}),4),a=t[0],s=t[1],c=t[2],u=t[3],d=T[1]-T[0],h=w[1]-w[0]}else{var O=gN(n,0),X=gN(n,1),K=pN(n,0),$=pN(n,1);if(a=[O,X],s=[K,X],c=[O,$],u=[K,$],d=K-O,h=$-X,p%180){var W=[c,a,u,s];r=te(W,4),a=r[0],s=r[1],c=r[2],u=r[3],d=$-X,h=K-O}}if(p%360>180){var W=[u,c,s,a];i=te(W,4),a=i[0],s=i[1],c=i[2],u=i[3]}var ee=Nc([a,s,c,u]),ie=ee.minX,H=ee.minY,F=ee.maxX,Y=ee.maxY;return{pos1:a,pos2:s,pos3:c,pos4:u,width:d,height:h,minX:ie,minY:H,maxX:F,maxY:Y,rotation:e}}function YV(n,e){var t=e.map(function(r){if(Gn(r)){var i=YV(n,r),a=i.length;return a>1?i:a===1?i[0]:null}else{var s=qr(n,function(c){var u=c.manager;return u.props.target===r});return s?(s.finded=!0,s.manager):null}}).filter(Boolean);return t.length===1&&Gn(t[0])?t[0]:t}var Zee=(function(n){sg(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.differ=new M3,t.moveables=[],t.transformOrigin="50% 50%",t.renderGroupRects=[],t._targetGroups=[],t._hasFirstTargets=!1,t}return e.prototype.componentDidMount=function(){n.prototype.componentDidMount.call(this)},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(t,r,i){var a;i===void 0&&(i=!0);var s=this.state;if(!this.controlBox||s.isPersisted)return;Id(!0),this.moveables.forEach(function(me){me.updateRect(t,!1,!1)});var c=this.props,u=this.moveables,d=s.target||c.target,h=u.map(function(me){return{finded:!1,manager:me}}),p=this.props.targetGroups||[],m=YV(h,p),b=c.useDefaultGroupRotate;m.push.apply(m,Ie([],te(h.filter(function(me){var Te=me.finded;return!Te}).map(function(me){var Te=me.manager;return Te})),!1));var _=[],w=!r||t!==""&&c.updateGroup,E=c.defaultGroupRotate||0;if(!this._hasFirstTargets){var T=(a=c.persistData)===null||a===void 0?void 0:a.rotation;T!=null&&(E=T)}function C(me,Te,Me){var ae=me.map(function(Be){if(Gn(Be)){var Pe=C(Be,Te),Ue=[Pe.pos1,Pe.pos2,Pe.pos3,Pe.pos4];return _.push(Pe),{poses:Ue,rotation:Pe.rotation}}else return{poses:zi(Be.state),rotation:Be.getRotation()}}),Ce=ae.map(function(Be){var Pe=Be.rotation;return Pe}),Ne=0,Oe=Ce[0],Ge=Ce.every(function(Be){return Math.abs(Oe-Be)<.1});w?Ne=!b&&Ge?Oe:E:Ne=!b&&!Me&&Ge?Oe:Te;var Le=ae.map(function(Be){var Pe=Be.poses;return Pe}),Se=Qee(Le,Ne);return Se}var k=C(m,this.rotation,!0);w&&(this.rotation=k.rotation,this.transformOrigin=c.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=p,this.renderGroupRects=_;var j=this.transformOrigin,P=this.rotation,N=this.scale,A=k.width,I=k.height,D=k.minX,z=k.minY,V=mee([[0,0],[A,0],[0,I],[A,I]],rT(j,A,I),this.rotation/180*Math.PI),B=Nc(V.result),O=B.minX,X=B.minY,K=" rotate(".concat(P,"deg)")+" scale(".concat(Ar(N[0]),", ").concat(Ar(N[1]),")"),$="translate(".concat(-O,"px, ").concat(-X,"px)").concat(K);this.controlBox.style.transform="translate3d(".concat(D,"px, ").concat(z,"px, ").concat(this.props.translateZ||0,")"),d.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(j,";")+"width:".concat(A,"px;height:").concat(I,"px;")+"transform: ".concat($),s.width=A,s.height=I;var W=this.getContainer(),ee=xw(this.controlBox,d,this.controlBox,this.getContainer(),this._rootContainer||W,[]),ie=[ee.left,ee.top],H=te(zi(ee),4),F=H[0],Y=H[1],ne=H[2],Z=H[3],oe=Nc([F,Y,ne,Z]),ue=[oe.minX,oe.minY],ye=Ar(N[0]*N[1]);ee.pos1=We(F,ue),ee.pos2=We(Y,ue),ee.pos3=We(ne,ue),ee.pos4=We(Z,ue),ee.left=D-ee.left+ue[0],ee.top=z-ee.top+ue[1],ee.origin=We(It(ie,ee.origin),ue),ee.beforeOrigin=We(It(ie,ee.beforeOrigin),ue),ee.originalBeforeOrigin=It(ie,ee.originalBeforeOrigin),ee.transformOrigin=We(It(ie,ee.transformOrigin),ue),d.style.transform="translate(".concat(-O-ue[0],"px, ").concat(-X-ue[1],"px)")+K,Id(),this.updateState(J(J({},ee),{posDelta:ue,direction:ye,beforeDirection:ye}),i)},e.prototype.getRect=function(){return J(J({},n.prototype.getRect.call(this)),{children:this.moveables.map(function(t){return t.getRect()})})},e.prototype.triggerEvent=function(t,r,i){if(i||t.indexOf("Group")>-1)return n.prototype.triggerEvent.call(this,t,r);this._emitter.trigger(t,r)},e.prototype.getRequestChildStyles=function(){var t=this.getEnabledAbles().reduce(function(r,i){var a,s,c=(s=(a=i.requestChildStyle)===null||a===void 0?void 0:a.call(i))!==null&&s!==void 0?s:[];return Ie(Ie([],te(r),!1),te(c),!1)},[]);return t},e.prototype.getMoveables=function(){return Ie([],te(this.moveables),!1)},e.prototype.updateAbles=function(){n.prototype.updateAbles.call(this,Ie(Ie([],te(this.props.ables),!1),[oT],!1),"Group")},e.prototype._updateTargets=function(){n.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=Ha(this._originalDragTarget,!0)},e.prototype._updateEvents=function(){var t=this.state,r=this.props,i=this._prevDragTarget,a=r.dragTarget||this.areaElement,s=r.targets,c=this.differ.update(s),u=c.added,d=c.changed,h=c.removed,p=u.length||h.length;(p||this._prevOriginalDragTarget!==this._originalDragTarget)&&(Xu(this,!1),Xu(this,!0),this.updateState({gestos:{}})),i!==a&&(t.target=null),t.target||(t.target=this.areaElement,this.controlBox.style.display="block"),t.target&&(this.targetGesto||(this.targetGesto=GV(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=qV(this,"GroupControl")));var m=!yw(t.container,r.container);m&&(t.container=r.container),(m||p||this.transformOrigin!==(r.defaultGroupOrigin||"50% 50%")||d.length||s.length&&!MV(this._targetGroups,r.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!p},e.prototype._updateObserver=function(){},e.defaultProps=J(J({},Dd.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e})(Dd),Jee=(function(n){sg(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.moveables=[],t}return e.prototype.render=function(){var t=this,r,i=this.props,a=i.cspNonce,s=i.cssStyled,c=i.persistData,u=i.targets||[],d=u.length,h=this.isUnmounted||!d,p=(r=c?.children)!==null&&r!==void 0?r:[];return h&&!d&&p.length?u=p.map(function(){return null}):h||(p=[]),ra(s,{cspNonce:a,ref:Rs(this,"controlBox"),className:He("control-box")},u.map(function(m,b){var _,w,E=(w=(_=i.individualGroupableProps)===null||_===void 0?void 0:_.call(i,m,b))!==null&&w!==void 0?w:{};return ra(Dd,J({key:"moveable"+b,ref:Jj(t,"moveables",b)},i,E,{target:m,wrapperMoveable:t,isWrapperMounted:t.isMoveableMounted,persistData:p[b]}))}))},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(t,r,i){i===void 0&&(i=!0),Id(!0),this.moveables.forEach(function(a){a.updateRect(t,r,i)}),Id()},e.prototype.getRect=function(){return J(J({},n.prototype.getRect.call(this)),{children:this.moveables.map(function(t){return t.getRect()})})},e.prototype.request=function(t,r,i){r===void 0&&(r={});var a=this.moveables.map(function(u){return u.request(t,J(J({},r),{isInstant:!1}),!1)}),s=i||r.isInstant,c={request:function(u){return a.forEach(function(d){return d.request(u)}),this},requestEnd:function(){return a.forEach(function(u){return u.requestEnd()}),this}};return s?c.request(r).requestEnd():c},e.prototype.dragStart=function(t,r){r===void 0&&(r=t.target);var i=r,a=qr(this.moveables,function(s){var c=s.getTargets()[0],u=s.getControlBoxElement(),d=s.getDragElement();return!c||!d?!1:d===i||d.contains(i)||d!==c&&c===i||c.contains(i)||u===i||u.contains(i)});return a&&a.dragStart(t,r),this},e.prototype.hitTest=function(){return 0},e.prototype.isInside=function(){return!1},e.prototype.isDragging=function(){return!1},e.prototype.getDragElement=function(){return null},e.prototype.getMoveables=function(){return Ie([],te(this.moveables),!1)},e.prototype.updateRenderPoses=function(){},e.prototype.checkUpdate=function(){},e.prototype.triggerEvent=function(){},e.prototype.updateAbles=function(){},e.prototype._updateEvents=function(){},e.prototype._updateObserver=function(){},e})(Dd);function KV(n,e){var t=[];return n.forEach(function(r){if(r){if(Gr(r)){e[r]&&t.push.apply(t,Ie([],te(e[r]),!1));return}Gn(r)?t.push.apply(t,Ie([],te(KV(r,e)),!1)):t.push(r)}}),t}function XV(n,e){var t=[];return n.forEach(function(r){if(r){if(Gr(r)){e[r]&&t.push.apply(t,Ie([],te(e[r]),!1));return}Gn(r)?t.push(XV(r,e)):t.push(r)}}),t}function WV(n,e){return n.length!==e.length||n.some(function(t,r){var i=e[r];return!t&&!i?!1:t!=i?Gn(t)&&Gn(i)?WV(t,i):!0:!1})}var ete=(function(n){sg(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.refTargets=[],t.selectorMap={},t._differ=new M3,t._elementTargets=[],t._tmpRefTargets=[],t._tmpSelectorMap={},t._onChangeTargets=null,t}return e.makeStyled=function(){var t={},r=this.getTotalAbles();r.forEach(function(a){var s=a.css;s&&s.forEach(function(c){t[c]=!0})});var i=Bs(t).join(`
`);this.defaultStyled=V3("div",XW(UE,zZ+i))},e.getTotalAbles=function(){return Ie([VV,oT,HV,jV],te(this.defaultAbles),!1)},e.prototype.render=function(){var t,r=this.constructor;r.defaultStyled||r.makeStyled();var i=this.props,a=i.ables,s=i.props,c=TZ(i,["ables","props"]),u=te(this._updateRefs(!0),2),d=u[0],h=u[1],p=KV(d,h),m=p.length>1,b=r.getTotalAbles(),_=Ie(Ie([],te(b),!1),te(a||[]),!1),w=J(J(J({},c),s||{}),{ables:_,cssStyled:r.defaultStyled,customStyledMap:r.customStyledMap});this._elementTargets=p;var E=null,T=this.moveable,C=c.persistData;if(C?.children&&(m=!0),c.individualGroupable)return ra(Jee,J({key:"individual-group",ref:Rs(this,"moveable")},w,{target:null,targets:p}));if(m){var k=XV(d,h);if(T&&!T.props.groupable&&!T.props.individualGroupable){var j=T.props.target;j&&p.indexOf(j)>-1&&(E=J({},T.state))}return ra(Zee,J({key:"group",ref:Rs(this,"moveable")},w,(t=c.groupableProps)!==null&&t!==void 0?t:{},{target:null,targets:p,targetGroups:k,firstRenderState:E}))}else{var P=p[0];if(T&&(T.props.groupable||T.props.individualGroupable)){var N=T.moveables||[],A=qr(N,function(I){return I.props.target===P});A&&(E=J({},A.state))}return ra(Dd,J({key:"single",ref:Rs(this,"moveable")},w,{target:P,firstRenderState:E}))}},e.prototype.componentDidMount=function(){this._checkChangeTargets()},e.prototype.componentDidUpdate=function(){this._checkChangeTargets()},e.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},e.prototype.getTargets=function(){var t,r;return(r=(t=this.moveable)===null||t===void 0?void 0:t.getTargets())!==null&&r!==void 0?r:[]},e.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs(),this.forceUpdate()},e.prototype.waitToChangeTarget=function(){var t=this,r;return this._onChangeTargets=function(){t._onChangeTargets=null,r()},new Promise(function(i){r=i})},e.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},e.prototype.getManager=function(){return this.moveable},e.prototype.getMoveables=function(){return this.moveable.getMoveables()},e.prototype.getDragElement=function(){return this.moveable.getDragElement()},e.prototype._updateRefs=function(t){var r=this.refTargets,i=nT(this.props.target||this.props.targets),a=typeof document<"u",s=WV(r,i),c=this.selectorMap,u={};return this.refTargets.forEach(function d(h){if(Gr(h)){var p=c[h];p?u[h]=c[h]:a&&(s=!0,u[h]=[].slice.call(document.querySelectorAll(h)))}else Gn(h)&&h.forEach(d)}),this._tmpRefTargets=i,this._tmpSelectorMap=u,[i,u,!t&&s]},e.prototype._checkChangeTargets=function(){var t,r,i;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var a=this._differ.update(this._elementTargets),s=a.added,c=a.removed,u=s.length||c.length;u&&((r=(t=this.props).onChangeTargets)===null||r===void 0||r.call(t,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this));var d=te(this._updateRefs(),3),h=d[0],p=d[1],m=d[2];this.refTargets=h,this.selectorMap=p,m&&this.forceUpdate()},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,AZ([WW(G3)],e.prototype,"moveable",void 0),e})(g3),tte=(function(n){sg(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.defaultAbles=lT,e})(ete),_w=function(n,e){return _w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},_w(n,e)};function cT(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");_w(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Sp=function(){return Sp=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Sp.apply(this,arguments)};function nte(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(s=n[c])&&(a=(i<3?s(a):i>3?s(e,t,a):s(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}var rte=(function(n){cT(e,n);function e(r){var i=n.call(this,r)||this;return i.state={},i.state=i.props,i}var t=e.prototype;return t.render=function(){return ra(tte,Sp({ref:Rs(this,"moveable")},this.state))},e})(ME),ite=Wee,ate=G3,ste=Xee,ote=(function(n){cT(e,n);function e(r,i){i===void 0&&(i={});var a=n.call(this)||this;a.containerProvider=null,a.selfElement=null,a._warp=!1;var s=Sp({},i),c={};ste.forEach(function(h){c[sQ("on ".concat(h))]=function(p){return a.trigger(h,p)}});var u;i.warpSelf?(delete i.warpSelf,a._warp=!0,u=r):(u=Kd(r).createElement("div"),r.appendChild(u)),a.containerProvider=ND(ra(rte,Sp({ref:Rs(a,"innerMoveable")},s,c)),u),a.selfElement=u;var d=s.target;return Gn(d)&&d.length>1&&a.updateRect(),a}var t=e.prototype;return t.setState=function(r,i){this.innerMoveable.setState(r,i)},t.forceUpdate=function(r){this.innerMoveable.forceUpdate(r)},t.dragStart=function(r,i){i===void 0&&(i=r.target);var a=this.innerMoveable;a.$_timer&&this.forceUpdate(),this.getMoveable().dragStart(r,i)},t.destroy=function(){var r,i=this.selfElement;ND(null,i,this.containerProvider),this._warp||(r=i?.parentElement)===null||r===void 0||r.removeChild(i),this.containerProvider=null,this.off(),this.selfElement=null,this.innerMoveable=null},t.getMoveable=function(){return this.innerMoveable.moveable},e=nte([SD(ate,function(r,i){r[i]||(r[i]=function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var c=this.getMoveable();if(!(!c||!c[i]))return c[i].apply(c,a)})}),SD(ite,function(r,i){Object.defineProperty(r,i,{get:function(){return this.getMoveable().props[i]},set:function(a){var s;this.setState((s={},s[i]=a,s))},enumerable:!0,configurable:!0})})],e),e})(xy),QV=(function(n){cT(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e})(ote),Fo=(n=>(n.Mouse="mouse",n.Touch="touch",n.Pointer="pointer",n))(Fo||{}),_h=(n=>(n.CancelledByMovement="cancelled-by-movement",n.CancelledByRelease="cancelled-by-release",n.CancelledOutsideElement="cancelled-outside-element",n))(_h||{});const lte=["mousedown","mousemove","mouseup","mouseleave","mouseout"],cte=["touchstart","touchmove","touchend","touchcancel"],ute=["pointerdown","pointermove","pointerup","pointerleave","pointerout"];function dte(n){return typeof n=="object"&&n!==null&&"pageX"in n&&typeof n.pageX=="number"&&"pageY"in n&&typeof n.pageY=="number"}function fte(n){var e;return lte.includes((e=n?.nativeEvent)==null?void 0:e.type)}function ZV(n){var e;return cte.includes((e=n?.nativeEvent)==null?void 0:e.type)||"touches"in n}function hte(n){const{nativeEvent:e}=n;return e?ute.includes(e?.type)||"pointerId"in e:!1}function M1(n){return fte(n)||ZV(n)||hte(n)}function mN(n){var e;const t=ZV(n)?(e=n?.touches)==null?void 0:e[0]:n;return dte(t)?{x:t.pageX,y:t.pageY}:null}function pte(n){return{target:n.target,currentTarget:n.currentTarget,nativeEvent:n,persist:()=>{}}}function uT(n,{threshold:e=400,captureEvent:t=!1,detect:r=Fo.Pointer,cancelOnMovement:i=!1,cancelOutsideElement:a=!0,filterEvents:s,onStart:c,onMove:u,onFinish:d,onCancel:h}={}){const p=U.useRef(!1),m=U.useRef(!1),b=U.useRef(),_=U.useRef(),w=U.useRef(n),E=U.useRef(null),T=U.useCallback(P=>N=>{m.current||M1(N)&&(s!==void 0&&!s(N)||(t&&N.persist(),c?.(N,{context:P}),E.current=mN(N),m.current=!0,b.current=N.currentTarget,_.current=setTimeout(()=>{w.current&&(w.current(N,{context:P}),p.current=!0)},e)))},[t,s,c,e]),C=U.useCallback(P=>(N,A)=>{M1(N)&&m.current&&(E.current=null,t&&N.persist(),p.current?d?.(N,{context:P}):m.current&&h?.(N,{context:P,reason:A??_h.CancelledByRelease}),p.current=!1,m.current=!1,_.current!==void 0&&clearTimeout(_.current))},[t,d,h]),k=U.useCallback(P=>N=>{if(M1(N)&&(u?.(N,{context:P}),i!==!1&&E.current)){const A=mN(N);if(A){const I=i===!0?25:i,D={x:Math.abs(A.x-E.current.x),y:Math.abs(A.y-E.current.y)};(D.x>I||D.y>I)&&C(P)(N,_h.CancelledByMovement)}}},[C,i,u]),j=U.useCallback(P=>{if(n===null)return{};switch(r){case Fo.Mouse:{const N={onMouseDown:T(P),onMouseMove:k(P),onMouseUp:C(P)};return a&&(N.onMouseLeave=A=>{C(P)(A,_h.CancelledOutsideElement)}),N}case Fo.Touch:return{onTouchStart:T(P),onTouchMove:k(P),onTouchEnd:C(P)};case Fo.Pointer:{const N={onPointerDown:T(P),onPointerMove:k(P),onPointerUp:C(P)};return a&&(N.onPointerLeave=A=>C(P)(A,_h.CancelledOutsideElement)),N}}},[n,C,a,r,k,T]);return U.useEffect(()=>{function P(N){const A=pte(N);C()(A)}return window.addEventListener("mouseup",P),window.addEventListener("touchend",P),window.addEventListener("pointerup",P),()=>{window.removeEventListener("mouseup",P),window.removeEventListener("touchend",P),window.removeEventListener("pointerup",P)}},[C]),U.useEffect(()=>()=>{_.current!==void 0&&clearTimeout(_.current)},[]),U.useEffect(()=>{w.current=n},[n]),j}const JV=()=>{if(/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream){const e=document.getElementById("ios-haptic-trigger");e&&e.click()}else typeof navigator<"u"&&navigator.vibrate&&navigator.vibrate(50)},kv=n=>n?n instanceof Date?n:typeof n=="string"?new Date(n):typeof n=="number"?new Date(n):n?.toDate&&typeof n.toDate=="function"?n.toDate():new Date:new Date,Zl=n=>kv(n).toISOString(),gte=n=>{const e=kv(n);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`},mte=n=>{const e=n.toLowerCase();return e==="income"?"Income":e==="expense"?"Expense":e==="transfer"?"Transfer":"Expense"},dT=n=>{const e=n;let t=0;typeof e.amount=="number"?t=e.amount:typeof e.amount=="string"&&(t=parseFloat(e.amount)),isNaN(t)&&(t=0);const r=Zl(e.date);return{id:e.id||"",userId:e.userId||"",envelopeId:e.envelopeId||"",amount:t,date:r,month:e.month||gte(r),description:e.description||"",merchant:e.merchant||void 0,type:mte(e.type||"expense"),reconciled:e.reconciled??!1,transferId:e.transferId||void 0,isAutomatic:e.isAutomatic||void 0,paymentMethod:e.paymentMethod?typeof e.paymentMethod=="string"?{id:e.paymentMethod,name:e.paymentMethod,network:"Visa",last4:"****",color:"#000000"}:e.paymentMethod:void 0}};class dc{static instance;static getInstance(){return dc.instance||(dc.instance=new dc),dc.instance}async restoreUserData(e,t){try{console.log(" BudgetService.restoreUserData: STARTING RESTORE for user:",e),await this.deleteAllUserData(e);const r=[{name:"envelopes",data:t.envelopes||[]},{name:"transactions",data:t.transactions||[]},{name:"envelopeAllocations",data:t.allocations?Object.values(t.allocations).flat():[]},{name:"monthlyBudgets",data:this.prepareMonthlyBudgetsData(t.allocations,t.incomeSources)},{name:"appSettings",data:t.appSettings?[t.appSettings]:[]}],i=[];for(const{name:s,data:c}of r)if(Array.isArray(c))for(const u of c){if(!u.id&&s!=="monthlyBudgets")continue;const d={...u,userId:e};let h=u.id;s==="monthlyBudgets"&&u.month&&(h=u.month);const p=_t(et,"users",e,s,h);i.push({ref:p,data:d})}console.log(` Prepared ${i.length} items for restoration.`);const a=450;for(let s=0;s<i.length;s+=a){const c=A_(et);i.slice(s,s+a).forEach(d=>{c.set(d.ref,d.data)}),console.log(` Committing batch ${Math.floor(s/a)+1}/${Math.ceil(i.length/a)}...`),await c.commit()}console.log(" Restore completed successfully.")}catch(r){throw console.error(" BudgetService.restoreUserData failed:",r),new Error(`Failed to restore user data: ${r instanceof Error?r.message:"Unknown error"}`)}}async getEnvelopes(e){try{console.log(" BudgetService.getEnvelopes called for user:",e);const t=Er(et,"users",e,"envelopes"),a=(await ea(t)).docs.map((s,c)=>({id:s.id,...s.data(),orderIndex:s.data().orderIndex??c})).sort((s,c)=>{const u=s.orderIndex??0,d=c.orderIndex??0;return u-d});return console.log(" Fetched envelopes:",a.length),a}catch(t){throw console.error(" BudgetService.getEnvelopes failed:",t),new Error(`Failed to fetch envelopes: ${t instanceof Error?t.message:"Unknown error"}`)}}async getTransactions(e){try{console.log(" BudgetService.getTransactions: Fetching for user",e);const t=Er(et,"users",e,"transactions"),r=oa(t,il("date","desc")),a=(await ea(r)).docs.map(s=>{const c={id:s.id,...s.data()};return dT(c)});return console.log(` Fetched ${a.length} transactions`),a}catch(t){throw console.error(" BudgetService.getTransactions failed:",t),new Error(`Failed to fetch transactions: ${t instanceof Error?t.message:"Unknown error"}`)}}async createEnvelope(e){try{console.log(" BudgetService.createEnvelope called for user:",e.userId);const t=Er(et,"users",e.userId,"envelopes"),r=_t(t),i=pt.now(),a={...e,createdAt:i,lastUpdated:i};si(r,a).catch(c=>console.error("Create env failed",c));const s={...e,id:r.id,createdAt:Zl(i),lastUpdated:Zl(i)};return console.log(" Created envelope (optimistic):",s.id),s}catch(t){throw console.error(" BudgetService.createEnvelope failed:",t),new Error(`Failed to create envelope: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateEnvelope(e,t){try{console.log(" BudgetService.updateEnvelope called for envelope:",t.id);const r=_t(et,"users",e,"envelopes",t.id);si(r,{...t,lastUpdated:pt.now()},{merge:!0}).catch(i=>console.error("Update env failed",i)),console.log(" Updated envelope (optimistic):",t.id)}catch(r){throw console.error(" BudgetService.updateEnvelope failed:",r),new Error(`Failed to update envelope: ${r instanceof Error?r.message:"Unknown error"}`)}}async deleteEnvelope(e,t){try{const r=_t(et,"users",e,"envelopes",t),i=oa(Er(et,"users",e,"transactions"),K$("envelopeId","==",t)),s=(await ea(i)).docs.map(c=>ta(c.ref));await Promise.all([ta(r),...s]),console.log(" Deleted envelope and associated transactions from Firestore:",t)}catch(r){throw console.error(" BudgetService.deleteEnvelope failed:",r),new Error(`Failed to delete envelope: ${r instanceof Error?r.message:"Unknown error"}`)}}async reorderEnvelopes(e,t){try{console.log(" BudgetService.reorderEnvelopes called for user:",e);const r=t.map(i=>{const a=_t(et,"users",e,"envelopes",i.id);return si(a,{orderIndex:i.orderIndex,lastUpdated:pt.now()},{merge:!0})});Promise.all(r).catch(i=>console.error("Reorder env failed",i)),console.log(" Reordered envelopes (optimistic)")}catch(r){throw console.error(" BudgetService.reorderEnvelopes failed:",r),new Error(`Failed to reorder envelopes: ${r instanceof Error?r.message:"Unknown error"}`)}}async createTransaction(e){try{console.log(" BudgetService.createTransaction called for user:",e.userId);const t=Er(et,"users",e.userId,"transactions"),r=_t(t),i=pt.now();if(e.paymentMethod){const u={...e.paymentMethod};u.last4===void 0&&delete u.last4,e.paymentMethod=u}const s={...Object.fromEntries(Object.entries(e).filter(([u,d])=>d!==void 0)),createdAt:i};si(r,s).catch(u=>console.error("Create tx failed",u));const c={...e,id:r.id};return console.log(" Created transaction (optimistic):",c.id),c}catch(t){throw console.error(" BudgetService.createTransaction failed:",t),new Error(`Failed to create transaction: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateTransaction(e,t){try{if(console.log(" BudgetService.updateTransaction called for transaction:",t.id),t.paymentMethod){const a={...t.paymentMethod};a.last4===void 0&&delete a.last4,t.paymentMethod=a}const r=Object.fromEntries(Object.entries(t).filter(([a,s])=>s!==void 0)),i=_t(et,"users",e,"transactions",t.id);si(i,r,{merge:!0}).catch(a=>console.error("Update tx failed",a)),console.log(" Updated transaction (optimistic):",t.id)}catch(r){throw console.error(" BudgetService.updateTransaction failed:",r),new Error(`Failed to update transaction: ${r instanceof Error?r.message:"Unknown error"}`)}}async deleteTransaction(e,t){try{console.log(" BudgetService.deleteTransaction called for transaction:",t);const r=_t(et,"users",e,"transactions",t);ta(r).catch(i=>console.error("Delete tx failed",i)),console.log(" Deleted transaction (optimistic):",t)}catch(r){throw console.error(" BudgetService.deleteTransaction failed:",r),new Error(`Failed to delete transaction: ${r instanceof Error?r.message:"Unknown error"}`)}}async createIncomeSource(e){try{console.log(" BudgetService.createIncomeSource (Embedded) called for user:",e.userId);const t=_t(et,"users",e.userId,"monthlyBudgets",e.month),r=pt.now(),i=`inc_${r.toMillis()}_${Math.random().toString(36).substring(2,9)}`,a={...e,id:i,amount:Number(e.amount),createdAt:r,updatedAt:r};Ma(t,{incomeSources:iH(a),updatedAt:r}).catch(c=>{c.code==="not-found"?si(t,{id:`${e.userId}_${e.month}`,userId:e.userId,month:e.month,createdAt:r,updatedAt:r,incomeSources:[a],allocations:{},totalIncome:0,availableToBudget:0}).catch(u=>console.error("Failed to create monthly budget doc",u)):console.error("Create income failed",c)});const s={...e,id:i,amount:Number(e.amount),createdAt:Zl(r),updatedAt:Zl(r)};return console.log(" Created income source (optimistic/embedded):",s.id),s}catch(t){throw console.error(" BudgetService.createIncomeSource failed:",t),new Error(`Failed to create income source: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateIncomeSource(e,t,r,i){try{console.log(" BudgetService.updateIncomeSource (Embedded) called for source:",t);const a=_t(et,"users",e,"monthlyBudgets",r);n1(a).then(s=>{if(!s.exists())return;const d=(s.data().incomeSources||[]).map(h=>{if(h.id===t){const p={...h,...i,updatedAt:pt.now()};return i.amount!==void 0&&(p.amount=Number(i.amount)),p}return h});Ma(a,{incomeSources:d,updatedAt:pt.now()})}).catch(s=>console.error("Update income failed",s)),console.log(" Updated income source (optimistic/embedded):",t)}catch(a){throw console.error(" BudgetService.updateIncomeSource failed:",a),a}}async deleteIncomeSource(e,t,r){try{console.log(" BudgetService.deleteIncomeSource (Embedded) called for source:",t);const i=_t(et,"users",e,"monthlyBudgets",r);n1(i).then(a=>{if(!a.exists())return;const u=(a.data().incomeSources||[]).filter(d=>d.id!==t);Ma(i,{incomeSources:u,updatedAt:pt.now()})}).catch(a=>console.error("Delete income failed",a)),console.log(" Deleted income source (optimistic/embedded):",t)}catch(i){throw console.error(" BudgetService.deleteIncomeSource failed:",i),new Error(`Failed to delete income source: ${i instanceof Error?i.message:"Unknown error"}`)}}async createEnvelopeAllocation(e){try{console.log(" BudgetService.createEnvelopeAllocation (Embedded) called for user:",e.userId);const t=_t(et,"users",e.userId,"monthlyBudgets",e.month),r=pt.now(),i={[`allocations.${e.envelopeId}`]:Number(e.budgetedAmount),updatedAt:r};Ma(t,i).catch(s=>{s.code==="not-found"?si(t,{id:`${e.userId}_${e.month}`,userId:e.userId,month:e.month,createdAt:r,updatedAt:r,incomeSources:[],allocations:{[e.envelopeId]:Number(e.budgetedAmount)},totalIncome:0,availableToBudget:0}).catch(c=>console.error("Failed to create monthly budget doc",c)):console.error("Create allocation failed",s)});const a={...e,id:e.envelopeId,createdAt:Zl(r),updatedAt:Zl(r)};return console.log(" Created allocation (optimistic/embedded):",a.id),a}catch(t){throw console.error(" BudgetService.createEnvelopeAllocation failed:",t),new Error(`Failed to create envelope allocation: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateEnvelopeAllocation(e,t,r,i){try{console.log(" BudgetService.updateEnvelopeAllocation (Embedded) called for envelope:",t);const a=_t(et,"users",e,"monthlyBudgets",r),s={updatedAt:pt.now()};i.budgetedAmount!==void 0&&(s[`allocations.${t}`]=Number(i.budgetedAmount)),Ma(a,s).catch(c=>console.error("Update allocation failed",c)),console.log(" Updated allocation (optimistic/embedded):",t)}catch(a){throw console.error(" BudgetService.updateEnvelopeAllocation failed:",a),new Error(`Failed to update envelope allocation: ${a instanceof Error?a.message:"Unknown error"}`)}}async deleteEnvelopeAllocation(e,t,r){try{console.log(" BudgetService.deleteEnvelopeAllocation (Embedded) called for envelope:",t);const i=_t(et,"users",e,"monthlyBudgets",r);Ma(i,{[`allocations.${t}`]:lk(),updatedAt:pt.now()}).catch(a=>console.error("Delete allocation failed",a)),console.log(" Deleted allocation (optimistic/embedded):",t)}catch(i){throw console.error(" BudgetService.deleteEnvelopeAllocation failed:",i),new Error(`Failed to delete envelope allocation: ${i instanceof Error?i.message:"Unknown error"}`)}}async getMonthData(e,t){try{console.log(` BudgetService.getMonthData (Embedded): Fetching for user ${e}, month ${t}`);const r=_t(et,"users",e,"monthlyBudgets",t),i=await n1(r);if(!i.exists())return console.log(` No budget data found for ${t}, returning empty defaults.`),{incomeSources:[],allocations:[]};const a=i.data(),s=(a.incomeSources||[]).map(d=>({...d,amount:Number(d.amount),createdAt:d.createdAt?.toDate?d.createdAt.toDate().toISOString():d.createdAt||new Date().toISOString(),updatedAt:d.updatedAt?.toDate?d.updatedAt.toDate().toISOString():d.updatedAt||new Date().toISOString()})).sort((d,h)=>new Date(d.createdAt).getTime()-new Date(h.createdAt).getTime()),c=a.allocations||{},u=Object.entries(c).map(([d,h])=>({id:d,userId:e,envelopeId:d,month:t,budgetedAmount:Number(h),createdAt:a.createdAt?.toDate?a.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:a.updatedAt?.toDate?a.updatedAt.toDate().toISOString():new Date().toISOString()})).sort((d,h)=>new Date(d.createdAt).getTime()-new Date(h.createdAt).getTime());return console.log(` Fetched ${s.length} income sources and ${u.length} allocations for ${t}`),{incomeSources:s,allocations:u}}catch(r){throw console.error(" BudgetService.getMonthData failed:",r),new Error(`Failed to fetch month data: ${r instanceof Error?r.message:"Unknown error"}`)}}async cleanupOrphanedData(e){try{console.log(" BudgetService.cleanupOrphanedData: Starting cleanup for user:",e);const t={orphanedAllocationsDeleted:0,orphanedTransactionsDeleted:0,details:{deletedAllocationIds:[],deletedTransactionIds:[],monthsProcessed:[]}},r=await this.getEnvelopes(e),i=new Set(r.map(b=>b.id));console.log(` Found ${r.length} existing envelopes`);const a=Er(et,"users",e,"envelopeAllocations"),s=await ea(a),c=[],u=new Set;for(const b of s.docs){const _=b.data();u.add(_.month),i.has(_.envelopeId)||(c.push(b.id),console.log(` Found orphaned allocation: ${b.id} for envelope ${_.envelopeId} in month ${_.month}`))}if(c.length>0){const b=c.map(_=>ta(_t(et,"users",e,"envelopeAllocations",_)));await Promise.all(b),t.orphanedAllocationsDeleted+=c.length,t.details.deletedAllocationIds.push(...c),console.log(` Deleted ${c.length} orphaned allocations (legacy)`)}const d=Er(et,"users",e,"monthlyBudgets"),h=await ea(d);for(const b of h.docs){const w=b.data().allocations||{},E={};let T=!1;Object.keys(w).forEach(C=>{i.has(C)||(E[`allocations.${C}`]=lk(),T=!0,console.log(` Found orphaned embedded allocation in ${b.id} for envelope ${C}`),t.orphanedAllocationsDeleted++,t.details.deletedAllocationIds.push(`${b.id}_${C}`))}),T&&(E.updatedAt=pt.now(),await Ma(b.ref,E),u.add(b.id))}const p=await this.getTransactions(e),m=[];for(const b of p)i.has(b.envelopeId)||(m.push(b.id),console.log(` Found orphaned transaction: ${b.id} for envelope ${b.envelopeId}`));if(m.length>0){const b=m.map(_=>ta(_t(et,"users",e,"transactions",_)));await Promise.all(b),t.orphanedTransactionsDeleted=m.length,t.details.deletedTransactionIds=m,console.log(` Deleted ${m.length} orphaned transactions`)}return t.details.monthsProcessed=Array.from(u),console.log(" Cleanup completed:",{orphanedAllocationsDeleted:t.orphanedAllocationsDeleted,orphanedTransactionsDeleted:t.orphanedTransactionsDeleted,monthsProcessed:t.details.monthsProcessed.length}),t}catch(t){throw console.error(" BudgetService.cleanupOrphanedData failed:",t),new Error(`Failed to cleanup orphaned data: ${t instanceof Error?t.message:"Unknown error"}`)}}subscribeToMonthlyBudget(e,t,r){const i=_t(et,"users",e,"monthlyBudgets",t);return qd(i,a=>{if(!a.exists()){r({incomeSources:[],allocations:[]});return}const s=a.data(),c=(s.incomeSources||[]).map(h=>({...h,amount:Number(h.amount),createdAt:h.createdAt?.toDate?h.createdAt.toDate().toISOString():h.createdAt||new Date().toISOString(),updatedAt:h.updatedAt?.toDate?h.updatedAt.toDate().toISOString():h.updatedAt||new Date().toISOString()})).sort((h,p)=>new Date(h.createdAt).getTime()-new Date(p.createdAt).getTime()),u=s.allocations||{},d=Object.entries(u).map(([h,p])=>({id:h,userId:e,envelopeId:h,month:t,budgetedAmount:Number(p),createdAt:s.createdAt?.toDate?s.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:s.updatedAt?.toDate?s.updatedAt.toDate().toISOString():new Date().toISOString()})).sort((h,p)=>new Date(h.createdAt).getTime()-new Date(p.createdAt).getTime());r({incomeSources:c,allocations:d})})}prepareMonthlyBudgetsData(e,t){const r=[],i=new Set;return e&&Object.keys(e).forEach(a=>i.add(a)),t&&Object.keys(t).forEach(a=>i.add(a)),i.forEach(a=>{const s=e?.[a]||[],c=t?.[a]||[],u={};s.forEach(h=>{u[h.envelopeId]=h.budgetedAmount});const d={month:a,userId:"",incomeSources:c,allocations:u,totalIncome:c.reduce((h,p)=>h+Number(p.amount||0),0),availableToBudget:c.reduce((h,p)=>h+Number(p.amount||0),0)-s.reduce((h,p)=>h+Number(p.budgetedAmount||0),0),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};r.push(d)}),r}async deleteAllUserData(e){try{console.log(" BudgetService.deleteAllUserData: STARTING DELETION for user:",e);const t=["envelopes","transactions","incomeSources","envelopeAllocations","monthlyBudgets","appSettings"];for(const r of t){console.log(` Deleting collection: ${r}...`);const i=Er(et,"users",e,r),a=await ea(i);if(a.empty){console.log("   (Empty collection)");continue}const s=a.docs.map(c=>ta(c.ref));await Promise.all(s),console.log(`    Deleted ${a.size} documents from ${r}`)}console.log(" All user data deleted successfully.")}catch(t){throw console.error(" BudgetService.deleteAllUserData failed:",t),new Error(`Failed to delete all user data: ${t instanceof Error?t.message:"Unknown error"}`)}}}const fT=dc.getInstance();class Go{static instance;constructor(){}static getInstance(){return Go.instance||(Go.instance=new Go),Go.instance}createId(){return _t(Er(et,"temp")).id}async createCategory(e){const t=_t(et,`users/${e.userId}/categories`,e.id);return await si(t,e),e}async getCategories(e){const t=oa(Er(et,`users/${e}/categories`),il("orderIndex","asc"));return(await ea(t)).docs.map(i=>i.data())}async updateCategory(e,t){const r=_t(et,`users/${e}/categories`,t.id);await si(r,t,{merge:!0})}async deleteCategory(e,t){const r=_t(et,`users/${e}/categories`,t);await ta(r)}async reorderCategories(e,t){const r=A_(et);t.forEach((i,a)=>{const s=_t(et,`users/${e}/categories`,i.id);r.update(s,{orderIndex:a})}),await r.commit()}async deduplicateCategories(e){const t=await this.getCategories(e),r=new Map,i=[];for(const s of t){const c=s.name.toLowerCase().trim();r.has(c)?i.push(s.id):r.set(c,s)}if(i.length===0)return console.log(" No duplicate categories found"),0;console.log(` Found ${i.length} duplicate categories to remove`);const a=450;for(let s=0;s<i.length;s+=a){const c=A_(et);i.slice(s,s+a).forEach(d=>{const h=_t(et,`users/${e}/categories`,d);c.delete(h)}),await c.commit(),console.log(` Deleted batch ${Math.floor(s/a)+1}`)}return console.log(` Removed ${i.length} duplicate categories`),i.length}subscribeToCategories(e,t){const r=oa(Er(et,`users/${e}/categories`),il("orderIndex","asc"));return qd(r,i=>{const a=i.docs.map(s=>s.data());t(a)},i=>{console.error(" Category subscription error:",i)})}}Go.getInstance();const P1=n=>Er(et,"users",n,"transactions"),vte={subscribeToTransactions:(n,e)=>{const t=oa(P1(n),il("date","desc"));return qd(t,i=>{const a=i.docs.map(s=>({id:s.id,...s.data()}));e(a)})},getAllTransactions:async n=>{console.log(` TransactionService.getAllTransactions: Fetching for user ${n}`);const e=oa(P1(n),il("date","desc")),r=(await ea(e)).docs.map(i=>{const a={id:i.id,...i.data()};return dT(a)});return console.log(` Fetched ${r.length} transactions:`,r.map(i=>({id:i.id,description:i.description,month:i.month}))),r},addTransaction:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create transaction");console.log(` TransactionService.addTransaction: Adding transaction for user ${e}:`,r),console.log(` Original transaction had temp ID: ${t}`);try{console.log(" About to call addDoc with:",r);const i=await uy(P1(e),r);console.log(" addDoc succeeded, docRef:",i),console.log(` Document ID: ${i.id}`),console.log(` Document path: ${i.path}`);const a={id:i.id,...r,userId:e};return console.log(" Final result object:",a),a}catch(i){throw console.error(" addDoc failed:",i),console.error("Error message:",i.message),i}},updateTransaction:async(n,e,t)=>{const r=_t(et,"users",n,"transactions",e);return await Ma(r,t)},deleteTransaction:async(n,e)=>{console.log(` TransactionService.deleteTransaction: Deleting transaction ${e} for user ${n}`);try{const t=_t(et,"users",n,"transactions",e);console.log(` Deleting document at path: ${t.path}`),await ta(t),console.log(` TransactionService.deleteTransaction: Successfully deleted transaction ${e}`)}catch(t){throw console.error(` TransactionService.deleteTransaction: Failed to delete transaction ${e}:`,t),console.error("Error message:",t.message),t}}},O1=n=>Er(et,"users",n,"envelopes"),yte={subscribeToEnvelopes:(n,e)=>{const t=oa(O1(n),il("orderIndex","asc"));return qd(t,i=>{const a=i.docs.map(s=>{const c=s.data();return{id:s.id,...c,createdAt:c.createdAt?.toDate?.()?c.createdAt.toDate().toISOString():c.createdAt,lastUpdated:c.lastUpdated?.toDate?.()?c.lastUpdated.toDate().toISOString():c.lastUpdated}});e(a)})},getAllEnvelopes:async n=>{try{console.log(" EnvelopeService.getAllEnvelopes called for user:",n);const e=O1(n),i=(await ea(e)).docs.map((a,s)=>{const c=a.data();return{id:a.id,...c,createdAt:c.createdAt?.toDate?.()?c.createdAt.toDate().toISOString():c.createdAt,lastUpdated:c.lastUpdated?.toDate?.()?c.lastUpdated.toDate().toISOString():c.lastUpdated,orderIndex:c.orderIndex??s}}).sort((a,s)=>{const c=a.orderIndex??0,u=s.orderIndex??0;return c-u});return console.log(" Fetched envelopes:",i.length),i}catch(e){return console.error(" EnvelopeService.getAllEnvelopes failed:",e),[]}},createEnvelope:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create envelope");try{return{id:(await uy(O1(e),r)).id,...r,userId:e}}catch(i){throw console.error(" Envelope addDoc failed:",i),i}},saveEnvelope:async(n,e)=>{if(!e.id)throw new Error("Envelope ID is required for save operation");const t=_t(et,"users",n,"envelopes",e.id);return await si(t,e,{merge:!0})},updateBalance:async(n,e,t)=>{const r=_t(et,"users",n,"envelopes",e);return await Ma(r,{currentBalance:t,lastUpdated:new Date().toISOString()})},deleteEnvelope:async(n,e)=>{console.log(` EnvelopeService.deleteEnvelope: Deleting envelope ${e} for user ${n}`);const t=_t(et,"users",n,"envelopes",e);await ta(t),console.log(` EnvelopeService.deleteEnvelope: Successfully deleted envelope ${e}`)}},j1=n=>Er(et,"users",n,"distributionTemplates"),bte={subscribeToDistributionTemplates:(n,e)=>{const t=oa(j1(n),il("lastUsed","desc"));return qd(t,i=>{const a=i.docs.map(s=>({id:s.id,...s.data()}));e(a)})},getAllDistributionTemplates:async n=>{const e=oa(j1(n),il("lastUsed","desc"));return(await ea(e)).docs.map(r=>({id:r.id,...r.data()}))},createDistributionTemplate:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create distribution template");console.log(` DistributionTemplateService.createDistributionTemplate: Adding template for user ${e}:`,r);try{const i=await uy(j1(e),r);console.log(" Template addDoc succeeded, docRef:",i);const a={id:i.id,...r,userId:e};return console.log(" Final template result object:",a),a}catch(i){throw console.error(" Template addDoc failed:",i),i}},saveDistributionTemplate:async(n,e)=>{const t=_t(et,"users",n,"distributionTemplates",e.id);return await si(t,e,{merge:!0})},updateDistributionTemplate:async(n,e,t)=>{const r=_t(et,"users",n,"distributionTemplates",e);return await Ma(r,t)},deleteDistributionTemplate:async(n,e)=>{console.log(` DistributionTemplateService.deleteDistributionTemplate: Deleting template ${e} for user ${n}`);const t=_t(et,"users",n,"distributionTemplates",e);await ta(t),console.log(` DistributionTemplateService.deleteDistributionTemplate: Successfully deleted template ${e}`)}},V1=n=>Er(et,"users",n,"appSettings"),e5={subscribeToAppSettings:(n,e)=>{const t=oa(V1(n),ak(1));return qd(t,i=>{if(i.empty){e(null);return}const a=i.docs.map(s=>({id:s.id,...s.data()}))[0];e(a)})},getAppSettings:async n=>{const e=oa(V1(n),ak(1)),t=await ea(e);if(t.empty)return null;const r=t.docs[0];return{id:r.id,...r.data()}},createAppSettings:async n=>{const{userId:e,...t}=n;if(!e)throw new Error("User ID is required to create app settings");console.log(` AppSettingsService.createAppSettings: Creating settings for user ${e}:`,t);try{const r=await uy(V1(e),t);console.log(" Settings addDoc succeeded, docRef:",r);const i={id:r.id,...t,userId:e};return console.log(" Final settings result object:",i),i}catch(r){throw console.error(" Settings addDoc failed:",r),r}},saveAppSettings:async(n,e)=>{const t=_t(et,"users",n,"appSettings",e.id);return await si(t,e,{merge:!0})},updateAppSettings:async(n,e,t)=>{const r=_t(et,"users",n,"appSettings",e);return await si(r,t,{merge:!0})},deleteAppSettings:async(n,e)=>{console.log(` AppSettingsService.deleteAppSettings: Deleting settings ${e} for user ${n}`);const t=_t(et,"users",n,"appSettings",e);await ta(t),console.log(` AppSettingsService.deleteAppSettings: Successfully deleted settings ${e}`)}},vN=Object.freeze(Object.defineProperty({__proto__:null,AppSettingsService:e5},Symbol.toStringTag,{value:"Module"})),xte=n=>dT(n),_te=n=>({id:n.id,name:n.name||"",currentBalance:n.currentBalance||0,lastUpdated:n.lastUpdated?.toDate?.()?n.lastUpdated.toDate().toISOString():n.lastUpdated,isActive:n.isActive??!0,orderIndex:n.orderIndex??0,userId:n.userId||void 0,createdAt:n.createdAt?.toDate?.()?n.createdAt.toDate().toISOString():n.createdAt,isPiggybank:n.isPiggybank,piggybankConfig:n.piggybankConfig,categoryId:n.categoryId}),wte=n=>({id:n.id,userId:n.userId,name:n.name,orderIndex:n.orderIndex,isArchived:n.isArchived,createdAt:n.createdAt?.toDate?.()?n.createdAt.toDate().toISOString():n.createdAt,updatedAt:n.updatedAt?.toDate?.()?n.updatedAt.toDate().toISOString():n.updatedAt}),yN=(n,e)=>{if(window.__firebaseUnsubscribers){console.log(" Real-time subscriptions already active, skipping setup");return}console.log(" Setting up real-time Firebase subscriptions...");const t=n.getState().currentMonth;console.log(" Current month for subscriptions:",t);const r=yte.subscribeToEnvelopes(e,h=>{console.log(" Real-time sync: Envelopes updated",h.length);const p=h.map(_te),m=n.getState(),b=new Set(m.envelopes.map(E=>E.id)),_=new Set(p.map(E=>E.id)),w=[...p.filter(E=>b.has(E.id)),...m.envelopes.filter(E=>!_.has(E.id))];n.setState({envelopes:w})}),i=vte.subscribeToTransactions(e,h=>{console.log(" Real-time sync: Transactions updated",h.length);const p=h.map(xte),m=n.getState(),b=new Set(m.transactions.map(E=>`${E.id}-${E.month}`)),_=new Set(p.map(E=>`${E.id}-${E.month}`)),w=[...p.filter(E=>b.has(`${E.id}-${E.month}`)),...m.transactions.filter(E=>!_.has(`${E.id}-${E.month}`))];n.setState({transactions:w})}),s=Go.getInstance().subscribeToCategories(e,h=>{console.log(" Real-time sync: Categories updated",h.length);const p=h.map(wte),m=Array.from(new Map(p.map(b=>[b.id,b])).values());m.length!==p.length&&console.warn(" Duplicate categories detected in real-time update, deduplicating..."),n.setState({categories:m})}),c=bte.subscribeToDistributionTemplates(e,h=>{console.log(" Real-time sync: Templates updated from Firebase",h.length)}),u=e5.subscribeToAppSettings(e,h=>{console.log(" Real-time sync: Settings updated",h?"found":"null");const p=n.getState();if(h){const m={...p.appSettings,...h,paymentSources:h.paymentSources??p.appSettings?.paymentSources??[]};n.setState({appSettings:m})}else console.log(" Firebase settings null, preserving local state")}),d=fT.subscribeToMonthlyBudget(e,t,h=>{console.log(` Real-time sync: Monthly budget updated (${h.incomeSources.length} sources, ${h.allocations.length} allocations)`);const p=n.getState();n.setState({incomeSources:{...p.incomeSources,[t]:h.incomeSources},allocations:{...p.allocations,[t]:h.allocations}})});window.__firebaseUnsubscribers={envelopes:r,transactions:i,categories:s,templates:c,settings:u,monthlyBudget:d},console.log(" Real-time subscriptions active - cross-device sync enabled")},Ste=n=>{const{useBudgetStore:e,useAuthStore:t,getCurrentUserId:r}=n;if(typeof window>"u")return;window.addEventListener("online",async()=>{console.log(" Browser online event detected"),e.setState({isOnline:!0})}),window.addEventListener("offline",()=>{console.log(" Browser offline event detected"),e.setState({isOnline:!1})}),e.setState({isOnline:navigator.onLine});const i=t.getState();i.isAuthenticated&&i.currentUser&&(console.log(" User already authenticated on app load, setting up real-time subscriptions"),yN(e,r())),t.subscribe(s=>{if(s.isAuthenticated&&s.currentUser)console.log(" User authenticated, setting up real-time subscriptions"),yN(e,r());else if(!s.isAuthenticated&&!s.isLoading){if(console.log(" User logged out, clearing data and unsubscribing"),window.__firebaseUnsubscribers){const c=window.__firebaseUnsubscribers;c.envelopes&&c.envelopes(),c.transactions&&c.transactions(),c.categories&&c.categories(),c.templates&&c.templates(),c.settings&&c.settings(),c.monthlyBudget&&c.monthlyBudget(),delete window.__firebaseUnsubscribers,console.log(" Cleaned up Firebase subscriptions")}e.getState().handleUserLogout()}});let a=e.getState().currentMonth;e.subscribe(s=>{if(s.currentMonth!==a&&s.isAuthenticated){console.log(" Month changed from",a,"to",s.currentMonth),a=s.currentMonth;const c=r();if(c&&window.__firebaseUnsubscribers){const u=window.__firebaseUnsubscribers;u.monthlyBudget&&u.monthlyBudget(),console.log(" Unsubscribed from old month data"),u.monthlyBudget=fT.subscribeToMonthlyBudget(c,s.currentMonth,d=>{console.log(" Real-time sync: Monthly budget updated for new month");const h=e.getState();e.setState({incomeSources:{...h.incomeSources,[s.currentMonth]:d.incomeSources},allocations:{...h.allocations,[s.currentMonth]:d.allocations}})}),console.log(" Subscribed to monthly data for new month:",s.currentMonth)}}})},N0=()=>Mi.getState().currentUser?.id||"",vn=dc.getInstance(),xs=Go.getInstance(),an=qw()(S7(YM((n,e)=>({envelopes:[],transactions:[],categories:[],appSettings:null,incomeSources:{},allocations:{},currentMonth:new Date().toISOString().slice(0,7),isOnline:typeof navigator<"u"?navigator.onLine:!0,isOnboardingActive:!1,isOnboardingCompleted:!1,isLoading:!1,error:null,setIsOnboardingActive:t=>{n({isOnboardingActive:t})},checkAndStartOnboarding:async()=>{const t=N0();if(!t){console.log(" No user ID, skipping onboarding check");return}const r=`onboardingCompleted_${t}`,i=typeof localStorage<"u"?localStorage.getItem(r)==="true":!1;if(console.log(" checkAndStartOnboarding called:",{userId:t,isOnboardingCompleted:i,isOnboardingActive:e().isOnboardingActive,localStorage_key:r,localStorage_value:localStorage.getItem(r)}),i){n({isOnboardingCompleted:!0}),console.log(" Skipping onboarding: already completed (localStorage)");return}try{if((await vn.getEnvelopes(t)).length>0){console.log(" Existing user detected on new device  skipping onboarding, setting localStorage"),localStorage.setItem(r,"true"),n({isOnboardingCompleted:!0,isOnboardingActive:!1});return}}catch(a){console.error(" Failed to check existing envelopes for onboarding:",a),n({isOnboardingCompleted:!0,isOnboardingActive:!1});return}e().isOnboardingActive||(console.log(" Starting onboarding for new user - setting isOnboardingActive to TRUE"),n({isOnboardingCompleted:!1,isOnboardingActive:!0}),console.log(" isOnboardingActive set to:",e().isOnboardingActive))},completeOnboarding:()=>{const t=N0();if(t){const r=`onboardingCompleted_${t}`;localStorage.setItem(r,"true"),console.log(" Onboarding completed for user:",t)}n({isOnboardingCompleted:!0,isOnboardingActive:!1})},resetOnboarding:()=>{const t=N0();if(t){const r=`onboardingCompleted_${t}`;localStorage.removeItem(r),console.log(" Onboarding reset for user:",t)}n({isOnboardingCompleted:!1,isOnboardingActive:!0})},clearMonthData:async t=>{try{n({isLoading:!0,error:null}),console.log(` Clearing all data for month: ${t}`);const i=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(s=>s.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const{monthlyBudgetService:a}=await Ct(async()=>{const{monthlyBudgetService:s}=await import("./MonthlyBudgetService-Bv8qC-az.js");return{monthlyBudgetService:s}},[]);await a.clearMonthData(i.id,t),await e().init(),console.log(` Cleared month data for ${t}`),n({isLoading:!1})}catch(r){throw console.error(" clearMonthData failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to clear month data"}),r}},fetchMonthData:async t=>{try{const i=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i){console.log("No user logged in, skipping month data fetch");return}console.log(`Fetching month data for: ${t}`);const a=await vn.getMonthData(i.id,t),s=e();n({incomeSources:{...s.incomeSources,[t]:a.incomeSources},allocations:{...s.allocations,[t]:a.allocations}}),console.log(` Fetched month data for ${t}`),(async()=>{const u=e(),d=u.allocations[t]||[],h=u.transactions.filter(m=>m.month===t);let p=0;for(const m of d){const b=u.envelopes.find(w=>w.id===m.envelopeId);if(b?.isPiggybank)continue;const _=h.find(w=>w.envelopeId===m.envelopeId&&(w.description==="Monthly Budget Allocation"||w.description==="Monthly Allocation"||w.description==="Budgeted"||w.description==="Piggybank Contribution"));_?_.amount!==m.budgetedAmount&&(console.log(` Repairing mismatch for envelope ${b?.name||m.envelopeId}: Alloc ${m.budgetedAmount} vs Tx ${_.amount}`),await u.updateTransaction({..._,amount:m.budgetedAmount}),p++):m.budgetedAmount>0&&(console.log(` Repairing missing transaction for envelope ${b?.name||m.envelopeId}`),await u.addTransaction({description:"Budgeted",amount:m.budgetedAmount,envelopeId:m.envelopeId,type:"Income",month:t,date:`${t}-01T00:00:00`,reconciled:!1,isAutomatic:!0}),p++)}p>0&&console.log(` Repaired ${p} allocation discrepancies for ${t}`)})().catch(u=>console.error("Verification failed:",u))}catch(r){console.error(` Failed to fetch month data for ${t}:`,r)}},removeEnvelopeFromMonth:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(` Removing envelope ${t} from month ${r}`);const i=e(),a=i.allocations[r]?.find(c=>c.envelopeId===t);a?await e().deleteEnvelopeAllocation(a.id):console.log(` No allocation found for envelope ${t} in ${r}`);const s=i.transactions.filter(c=>c.envelopeId===t&&(c.month===r||c.date.startsWith(r)));s.length>0&&(console.log(` Deleting ${s.length} transactions for envelope ${t} in ${r}`),await Promise.all(s.map(c=>e().deleteTransaction(c.id)))),n({isLoading:!1}),console.log(` Removed envelope ${t} from month ${r}`)}catch(i){throw console.error(" removeEnvelopeFromMonth failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to remove envelope from month"}),i}},setMonth:async t=>{n({currentMonth:t});const r=e();(r.incomeSources[t]===void 0||r.allocations[t]===void 0)&&(console.log(`Month ${t} data missing in store, fetching...`),n({isLoading:!0}),await e().fetchMonthData(t),n({isLoading:!1}))},init:async()=>{console.log("BudgetStore initializing...");const t=e();try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(m=>m.useAuthStore.getState())).currentUser;if(!i){console.log("No user logged in, skipping data fetch"),n({isLoading:!1});return}console.log(`Fetching data for user: ${i.id}, month: ${t.currentMonth}`);const[a,s,c,u]=await Promise.all([vn.getEnvelopes(i.id),vn.getTransactions(i.id),xs.getCategories(i.id).catch(m=>(console.error(" Failed to load categories:",m),[])),vn.getMonthData(i.id,t.currentMonth)]);let d=Array.from(new Map(c.map(m=>[m.id,m])).values());const h=new Set;let p=!1;for(const m of d){const b=m.name.toLowerCase().trim();if(h.has(b)){p=!0;break}h.add(b)}p&&i&&(console.log(" Duplicate category names detected, running Firestore cleanup..."),await xs.deduplicateCategories(i.id)>0&&(d=await xs.getCategories(i.id))),n({envelopes:a,transactions:s,categories:d,incomeSources:{...t.incomeSources,[t.currentMonth]:u.incomeSources},allocations:{...t.allocations,[t.currentMonth]:u.allocations},isLoading:!1,error:null}),console.log(` BudgetStore initialized: ${a.length} envelopes, ${s.length} transactions, ${c.length} categories, ${u.incomeSources.length} income sources, ${u.allocations.length} allocations`)}catch(r){console.error(" BudgetStore initialization failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to initialize budget data"})}},fetchCategories:async()=>{try{n({isLoading:!0,error:null});const r=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(s=>s.useAuthStore.getState())).currentUser;if(!r)return;const i=await xs.getCategories(r.id),a=Array.from(new Map(i.map(s=>[s.id,s])).values());n({categories:a,isLoading:!1})}catch(t){console.error("Failed to fetch categories:",t),n({isLoading:!1})}},addCategory:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i)throw new Error("No user logged in");const a=e().categories.find(u=>u.name.toLowerCase().trim()===(t.name||"").toLowerCase().trim());if(a)return console.log(` Category "${t.name}" already exists, skipping creation`),n({isLoading:!1}),a.id;const s=xs.createId(),c={...t,id:s,userId:i.id,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),orderIndex:e().categories.length};return await xs.createCategory(c),n(u=>u.categories.some(h=>h.id===s)?{isLoading:!1}:{categories:[...u.categories,c],isLoading:!1}),s}catch(r){throw console.error("Failed to add category:",r),n({isLoading:!1}),r}},updateCategory:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(s=>s.useAuthStore.getState())).currentUser;if(!i)throw new Error("No user logged in");const a={...t,updatedAt:new Date().toISOString()};await xs.updateCategory(i.id,a),n(s=>({categories:s.categories.map(c=>c.id===t.id?a:c),isLoading:!1}))}catch(r){throw console.error("Failed to update category:",r),n({isLoading:!1}),r}},deleteCategory:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No user logged in");await xs.deleteCategory(i.id,t),n(a=>({categories:a.categories.filter(s=>s.id!==t),isLoading:!1}))}catch(r){throw console.error("Failed to delete category:",r),n({isLoading:!1}),r}},reorderCategories:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i)throw new Error("No user logged in");const a=e(),s=new Map;t.forEach((u,d)=>s.set(u,d));const c=a.categories.map(u=>{if(!s.has(u.id))return u;const d=s.get(u.id);return u.orderIndex===d?u:{...u,orderIndex:d}});n({categories:c.sort((u,d)=>u.orderIndex-d.orderIndex)}),await xs.reorderCategories(i.id,c),n({isLoading:!1})}catch(r){throw console.error("Failed to reorder categories:",r),n({isLoading:!1}),r}},addEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a={...t,userId:i.id},s=await vn.createEnvelope(a);return n(c=>c.envelopes.some(d=>d.id===s.id)?{isLoading:!1}:{envelopes:[...c.envelopes,s],isLoading:!1}),console.log(" Added envelope:",s.id),s.id}catch(r){throw console.error(" addEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to add envelope"}),r}},updateEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await vn.updateEnvelope(i.id,t),n(a=>({envelopes:a.envelopes.map(s=>s.id===t.id?t:s),isLoading:!1})),console.log(" Updated envelope:",t.id)}catch(r){throw console.error(" updateEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update envelope"}),r}},deleteEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await vn.deleteEnvelope(i.id,t),n(a=>({envelopes:a.envelopes.filter(s=>s.id!==t),transactions:a.transactions.filter(s=>s.envelopeId!==t),isLoading:!1})),console.log(" Deleted envelope:",t)}catch(r){throw console.error(" deleteEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete envelope"}),r}},reorderEnvelopes:async t=>{try{n({isLoading:!0,error:null});const r=e(),i=new Map;t.forEach((d,h)=>{i.set(d,h)});const a=r.envelopes.map(d=>{if(!i.has(d.id))return d;const h=i.get(d.id);return d.orderIndex===h?d:{...d,orderIndex:h}}),s=a.filter((d,h)=>d!==r.envelopes[h]);if(!s.length){n({isLoading:!1});return}const u=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!u)throw new Error("No authenticated user found");await vn.reorderEnvelopes(u.id,s),n({envelopes:a,isLoading:!1}),console.log(" Reordered envelopes")}catch(r){throw console.error(" reorderEnvelopes failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to reorder envelopes"}),r}},addTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=new Date(t.date),s=t.month||`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,c={...t,userId:i.id,month:s},u=await vn.createTransaction(c);n(d=>d.transactions.some(p=>p.id===u.id)?{isLoading:!1}:{transactions:[...d.transactions,u],isLoading:!1}),console.log(" Added transaction:",u.id)}catch(r){throw console.error(" addTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to add transaction"}),r}},updateTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=new Date(t.date),s=t.month||`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,c={...t,month:s};await vn.updateTransaction(i.id,c),n(u=>({transactions:u.transactions.map(d=>d.id===t.id?c:d),isLoading:!1})),console.log(" Updated transaction:",t.id)}catch(r){throw console.error(" updateTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update transaction"}),r}},deleteTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await vn.deleteTransaction(i.id,t),n(a=>({transactions:a.transactions.filter(s=>s.id!==t),isLoading:!1})),console.log(" Deleted transaction:",t)}catch(r){throw console.error(" deleteTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete transaction"}),r}},restoreTransaction:async t=>{await e().updateTransaction(t)},transferFunds:async(t,r,i,a,s)=>{try{const c=s?typeof s=="string"?s:s.toISOString():new Date().toISOString(),u=`transfer-${Date.now()}-${Math.random()}`;await e().addTransaction({description:`Transfer to ${e().envelopes.find(d=>d.id===r)?.name||"envelope"}`,amount:i,envelopeId:t,date:c,type:"Expense",transferId:u,reconciled:!1}),await e().addTransaction({description:`Transfer from ${e().envelopes.find(d=>d.id===t)?.name||"envelope"}`,amount:i,envelopeId:r,date:c,type:"Income",transferId:u,reconciled:!1}),console.log(" Transfer completed")}catch(c){throw console.error(" transferFunds failed:",c),c}},fetchData:async()=>{await e().init()},renameEnvelope:async(t,r)=>{try{n({isLoading:!0,error:null});const a=e().envelopes.find(d=>d.id===t);if(!a)throw new Error("Envelope not found");n(d=>({envelopes:d.envelopes.map(h=>h.id===t?{...h,name:r}:h),isLoading:!0}));const c=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!c)throw new Error("No authenticated user found");const u={...a,name:r};await vn.updateEnvelope(c.id,u),n({isLoading:!1}),console.log(" Renamed envelope:",t)}catch(i){throw console.error(" renameEnvelope failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to rename envelope"}),i}},getEnvelopeBalance:(t,r)=>{const i=e(),a=i.envelopes.find(s=>s.id===t);if(!a)return console.log(` getEnvelopeBalance: Envelope ${t} not found`),0;if(a.isPiggybank){const s=i.transactions.filter(p=>p.envelopeId===t),c=s.filter(p=>p.type==="Expense"),u=s.filter(p=>p.type==="Income"),d=c.reduce((p,m)=>p+(m.amount||0),0);return u.reduce((p,m)=>p+(m.amount||0),0)-d}if(r){const s=i.transactions.filter(p=>p.envelopeId===t&&p.month===r),c=s.filter(p=>p.type==="Expense"),u=s.filter(p=>p.type==="Income"),d=c.reduce((p,m)=>p+(m.amount||0),0);return u.reduce((p,m)=>p+(m.amount||0),0)-d}return console.warn(` getEnvelopeBalance: Month not provided for non-piggybank envelope ${t}. Returning 0.`),0},resetData:async()=>{console.log(" Resetting all data"),n({isLoading:!0});try{const r=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(i=>i.useAuthStore.getState())).currentUser;r?(console.log(" Deleting all data from Firestore for user:",r.id),await vn.deleteAllUserData(r.id)):console.warn(" No user logged in, only clearing local state"),n({envelopes:[],transactions:[],appSettings:null,incomeSources:{},allocations:{},isLoading:!1,error:null}),console.log(" Reset data complete")}catch(t){throw console.error(" resetData failed:",t),n({isLoading:!1,error:t instanceof Error?t.message:"Failed to reset data"}),t}},importData:async t=>{try{if(n({isLoading:!0,error:null}),!t||typeof t!="object")throw new Error("Invalid data format");const i=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("You must be logged in to restore data.");return console.log(" Starting Time Machine Restore for user:",i.id),await vn.restoreUserData(i.id,t),console.log(" Reloading app state from cloud..."),await e().init(),n({isLoading:!1}),{success:!0,message:"Data restored successfully from backup."}}catch(r){return console.error(" importData failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to import data"}),{success:!1,message:r instanceof Error?r.message:"Import failed"}}},updateAppSettings:async t=>{try{n({isLoading:!0,error:null});const r=e(),i={id:r.appSettings?.id||"default",theme:t.theme??r.appSettings?.theme??"system",fontSize:t.fontSize??r.appSettings?.fontSize??"medium",enableMoveableReorder:t.enableMoveableReorder??r.appSettings?.enableMoveableReorder??!0,paymentSources:t.paymentSources??r.appSettings?.paymentSources??[]};(t.userId||r.appSettings?.userId)&&(i.userId=t.userId??r.appSettings?.userId),i.paymentSources&&(i.paymentSources=i.paymentSources.map(c=>{const u={...c};return u.last4===void 0&&delete u.last4,u}));const s=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(s){const{AppSettingsService:c}=await Ct(async()=>{const{AppSettingsService:u}=await Promise.resolve().then(()=>vN);return{AppSettingsService:u}},void 0);await c.updateAppSettings(s.id,i.id,i)}n({appSettings:i,isLoading:!1}),console.log(" Updated app settings")}catch(r){throw console.error(" updateAppSettings failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update settings"}),r}},initializeAppSettings:async()=>{try{if(e().appSettings)return;const i=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(s=>s.useAuthStore.getState())).currentUser;if(i){const{AppSettingsService:s}=await Ct(async()=>{const{AppSettingsService:u}=await Promise.resolve().then(()=>vN);return{AppSettingsService:u}},void 0),c=await s.getAppSettings(i.id);if(c){n({appSettings:c}),console.log(" Loaded app settings from Firestore");return}}const a={id:"default",theme:"system",fontSize:"medium",enableMoveableReorder:!0,paymentSources:[]};i&&(a.userId=i.id),n({appSettings:a}),console.log(" Initialized default app settings")}catch(t){console.error(" initializeAppSettings failed:",t),n({error:t instanceof Error?t.message:"Failed to initialize settings"})}},updatePiggybankContribution:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Updating piggybank contribution:",{envelopeId:t,newAmount:r});const a=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");const s=e().envelopes.find(u=>u.id===t&&u.isPiggybank);if(!s)throw new Error("Piggybank not found");const c={...s,lastUpdated:new Date().toISOString(),piggybankConfig:{monthlyContribution:r,targetAmount:s.piggybankConfig?.targetAmount,color:s.piggybankConfig?.color,icon:s.piggybankConfig?.icon,paused:s.piggybankConfig?.paused??!1}};if(console.log(" Updating envelope in Firestore:",c),await vn.updateEnvelope(a.id,c),console.log(" Envelope updated successfully"),n(u=>({envelopes:u.envelopes.map(d=>d.id===t?c:d),isLoading:!1})),!s.piggybankConfig?.paused)try{await e().setEnvelopeAllocation(t,r),setTimeout(()=>{e().transactions.find(d=>d.envelopeId===t&&(d.description==="Monthly Allocation"||d.description==="Piggybank Contribution"))||console.warn(" Piggybank contribution transaction not found after update")},1e3)}catch(u){console.error(" Failed to update piggybank contribution:",u)}console.log(" Piggybank contribution updated successfully")}catch(i){throw console.error(" updatePiggybankContribution failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update piggybank contribution"}),i}},addIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null});const a=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");console.log(" Adding income source:",{month:t,source:r});const s=await vn.createIncomeSource({...r,userId:a.id,month:t});n(c=>{const u=c.incomeSources[t]||[];return u.some(h=>h.id===s.id)?{isLoading:!1}:{incomeSources:{...c.incomeSources,[t]:[...u,s]},isLoading:!1}}),console.log(" Added income source:",s.id)}catch(i){throw console.error(" addIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to add income source"}),i}},updateIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Updating income source:",{month:t,sourceId:r.id}),n(s=>({incomeSources:{...s.incomeSources,[t]:s.incomeSources[t]?.map(c=>c.id===r.id?{...r,updatedAt:new Date().toISOString()}:c)||[]},isLoading:!1}));const a=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(s=>s.useAuthStore.getState())).currentUser;if(!a)return;await vn.updateIncomeSource(a.id,r.id,t,r),console.log(" Updated income source:",r.id)}catch(i){throw console.error(" updateIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update income source"}),i}},deleteIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Deleting income source:",{month:t,sourceId:r}),n(s=>({incomeSources:{...s.incomeSources,[t]:s.incomeSources[t]?.filter(c=>c.id!==r)||[]},isLoading:!1}));const a=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(s=>s.useAuthStore.getState())).currentUser;if(!a)return;await vn.deleteIncomeSource(a.id,r,t),console.log(" Deleted income source:",r)}catch(i){throw console.error(" deleteIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to delete income source"}),i}},copyPreviousMonthAllocations:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(_=>_.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");console.log(" Copying allocations from previous month:",t);const[a,s]=t.split("-").map(Number);let c=a,u=s-1;u<1&&(c=a-1,u=12);const d=`${c}-${String(u).padStart(2,"0")}`;(!e().incomeSources[d]||!e().allocations[d])&&(console.log(` Previous month ${d} data missing, fetching...`),await e().fetchMonthData(d));const h=e().incomeSources[d]||[];if(console.log(` Found ${h.length} income sources from ${d}`),h.length>0){for(const _ of h){const{id:w,...E}=_;await e().addIncomeSource(t,E)}console.log(` Copied ${h.length} income sources to ${t}`)}const p=e().allocations[d]||[];console.log(` Found ${p.length} allocations from ${d}`);const m=p.filter(_=>{const w=e().envelopes.find(E=>E.id===_.envelopeId);return!!w&&!w.isPiggybank});if(m.length>0){for(const _ of m)await e().createEnvelopeAllocation({envelopeId:_.envelopeId,budgetedAmount:_.budgetedAmount,userId:i.id,month:t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),_.budgetedAmount>0&&await e().addTransaction({description:"Budgeted",amount:_.budgetedAmount,envelopeId:_.envelopeId,type:"Income",month:t,date:`${t}-01T00:00:00`,reconciled:!1,isAutomatic:!0});console.log(` Copied ${m.length} regular allocations to ${t}`)}const b=e().envelopes.filter(_=>_.isPiggybank);console.log(` Processing ${b.length} piggybanks for ${t}`);for(const _ of b){const w=_.piggybankConfig?.monthlyContribution,E=_.piggybankConfig?.paused??!1;if(!E&&w&&w>0)try{console.log(` Setting piggybank allocation for ${_.name}: ${w}`),await e().setEnvelopeAllocation(_.id,w)}catch(T){console.error(` Failed to set allocation for piggybank ${_.name}:`,T)}else console.log(` Skipping piggybank ${_.name} (paused=${E}, contribution=${w})`)}n({isLoading:!1}),console.log(` Complete monthly setup copied to ${t}`)}catch(r){throw console.error(" copyPreviousMonthAllocations failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to copy allocations"}),r}},setEnvelopeAllocation:async(t,r)=>{try{n({isLoading:!0,error:null});const a=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(h=>h.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");const s=e().currentMonth,c=e().envelopes.find(h=>h.id===t);if(!c){console.error(` setEnvelopeAllocation: Envelope ${t} not found in store! Aborting.`),n({isLoading:!1});return}const u=!!c.isPiggybank;console.log(` setEnvelopeAllocation called: envelopeId=${t}, amount=${r}, currentMonth=${s}, isPiggybank=${u}`);const d=e().allocations[s]?.find(h=>h.envelopeId===t);if(d?await e().updateEnvelopeAllocation(d.id,{budgetedAmount:r}):await e().createEnvelopeAllocation({envelopeId:t,budgetedAmount:r,userId:a.id,month:s,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),u&&r>0&&!c?.piggybankConfig?.paused){const h=e().transactions.find(p=>p.envelopeId===t&&p.month===s&&(p.description==="Monthly Allocation"||p.description==="Piggybank Contribution"));if(h){const p={...h,amount:r,description:"Piggybank Contribution"};await e().updateTransaction(p)}else{const p={description:"Piggybank Contribution",amount:r,envelopeId:t,type:"Income",month:s,date:`${s}-01T00:00:00`,reconciled:!1,isAutomatic:!0};await e().addTransaction(p)}}if(!u&&r>0){const h=e().transactions.find(p=>p.envelopeId===t&&p.month===s&&(p.description==="Monthly Budget Allocation"||p.description==="Budgeted"));if(h){const p={...h,amount:r,description:"Budgeted"};await e().updateTransaction(p)}else{const p={description:"Budgeted",amount:r,envelopeId:t,type:"Income",month:s,date:`${s}-01T00:00:00`,reconciled:!1,isAutomatic:!0};await e().addTransaction(p)}}console.log(" Envelope allocation set successfully")}catch(i){throw console.error(" setEnvelopeAllocation failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to set envelope allocation"}),i}},createEnvelopeAllocation:async t=>{try{const i=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=e().currentMonth,s=await vn.createEnvelopeAllocation({envelopeId:t.envelopeId,budgetedAmount:t.budgetedAmount,userId:i.id,month:a});n(c=>{const u=c.allocations[a]||[];return u.some(h=>h.id===s.id)?{isLoading:!1}:{allocations:{...c.allocations,[a]:[...u,s]},isLoading:!1}}),console.log(" Created envelope allocation:",s.id)}catch(r){throw console.error(" createEnvelopeAllocation failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to create envelope allocation"}),r}},updateEnvelopeAllocation:async(t,r)=>{try{console.log(" Updating envelope allocation:",{id:t,updates:r});const i=e().currentMonth,s=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(h=>h.useAuthStore.getState())).currentUser;if(!s)throw new Error("No authenticated user found");const c=e().allocations[i]?.find(h=>h.id===t);if(!c)throw new Error("Allocation not found");const u=e().envelopes.find(h=>h.id===c.envelopeId),d=u?.isPiggybank;if(await vn.updateEnvelopeAllocation(s.id,c.envelopeId,i,{budgetedAmount:r.budgetedAmount}),n(h=>({allocations:{...h.allocations,[i]:h.allocations[i]?.map(p=>p.id===t?{...p,...r,updatedAt:new Date().toISOString()}:p)||[]},isLoading:!1})),d&&r.budgetedAmount!==void 0){const h=e().transactions.find(p=>p.envelopeId===c.envelopeId&&p.month===i&&(p.description==="Monthly Allocation"||p.description==="Piggybank Contribution"));h?r.budgetedAmount>0&&!u?.piggybankConfig?.paused?await e().updateTransaction({...h,amount:r.budgetedAmount,description:"Piggybank Contribution"}):(r.budgetedAmount===0||u?.piggybankConfig?.paused)&&await e().deleteTransaction(h.id):r.budgetedAmount>0&&!u?.piggybankConfig?.paused&&await e().addTransaction({description:"Piggybank Contribution",amount:r.budgetedAmount,envelopeId:c.envelopeId,type:"Income",month:i,date:`${i}-01T00:00:00`,reconciled:!1,isAutomatic:!0})}if(!d&&r.budgetedAmount!==void 0){const h=e().transactions.find(p=>p.envelopeId===c.envelopeId&&p.month===i&&(p.description==="Monthly Budget Allocation"||p.description==="Budgeted"));h?r.budgetedAmount>0?await e().updateTransaction({...h,amount:r.budgetedAmount,description:"Budgeted"}):r.budgetedAmount===0&&await e().deleteTransaction(h.id):r.budgetedAmount>0&&await e().addTransaction({description:"Budgeted",amount:r.budgetedAmount,envelopeId:c.envelopeId,type:"Income",month:i,date:`${i}-01T00:00:00`,reconciled:!1,isAutomatic:!0})}console.log(" Updated envelope allocation:",t)}catch(i){throw console.error(" updateEnvelopeAllocation failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update envelope allocation"}),i}},deleteEnvelopeAllocation:async t=>{try{console.log(" Deleting envelope allocation:",t);const r=e().currentMonth,i=e().allocations[r]?.find(c=>c.id===t);if(!i){console.warn("Allocation not found in store, skipping delete");return}const s=(await Ct(()=>Promise.resolve().then(()=>Lt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!s)throw new Error("No authenticated user found");await vn.deleteEnvelopeAllocation(s.id,i.envelopeId,r),n(c=>({allocations:{...c.allocations,[r]:c.allocations[r]?.filter(u=>u.id!==t)||[]},isLoading:!1})),console.log(" Deleted envelope allocation:",t)}catch(r){throw console.error(" deleteEnvelopeAllocation failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete envelope allocation"}),r}},refreshAvailableToBudget:async()=>{try{const t=e().currentMonth,r=e().allocations[t]||[],i=e().incomeSources[t]||[],a=r.reduce((u,d)=>u+d.budgetedAmount,0);return i.reduce((u,d)=>u+d.amount,0)-a}catch(t){throw console.error(" refreshAvailableToBudget failed:",t),n({error:t instanceof Error?t.message:"Failed to refresh available to budget"}),t}},updateOnlineStatus:async()=>{try{const t=typeof navigator<"u"?navigator.onLine:!0;n({isOnline:t}),console.log(" Online status updated:",t)}catch(t){console.error(" Failed to update online status:",t)}},handleUserLogout:()=>{console.log(" Clearing user data on logout"),n({envelopes:[],transactions:[],categories:[],incomeSources:{},allocations:{},isOnboardingActive:!1,isOnboardingCompleted:!1,isLoading:!1,error:null})}}),{name:"budget-storage",partialize:n=>({envelopes:n.envelopes,transactions:n.transactions,categories:n.categories,appSettings:n.appSettings,incomeSources:n.incomeSources,allocations:n.allocations,currentMonth:n.currentMonth,isOnline:n.isOnline})})));Ste({useBudgetStore:an,useAuthStore:Mi,getCurrentUserId:N0});const Ete=Object.freeze(Object.defineProperty({__proto__:null,useBudgetStore:an},Symbol.toStringTag,{value:"Module"}));var Qu=9e15,yl=1e9,ww="0123456789abcdef",Dv="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Nv="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Sw={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Qu,maxE:Qu,crypto:!1},t5,As,at=!0,ky="[DecimalError] ",ul=ky+"Invalid argument: ",n5=ky+"Precision limit exceeded",r5=ky+"crypto unavailable",i5="[object Decimal]",xr=Math.floor,Hn=Math.pow,Tte=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Ate=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Cte=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,a5=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,aa=1e7,Je=7,Ite=9007199254740991,Rte=Dv.length-1,Ew=Nv.length-1,Ee={toStringTag:i5};Ee.absoluteValue=Ee.abs=function(){var n=new this.constructor(this);return n.s<0&&(n.s=1),Ye(n)};Ee.ceil=function(){return Ye(new this.constructor(this),this.e+1,2)};Ee.clampedTo=Ee.clamp=function(n,e){var t,r=this,i=r.constructor;if(n=new i(n),e=new i(e),!n.s||!e.s)return new i(NaN);if(n.gt(e))throw Error(ul+e);return t=r.cmp(n),t<0?n:r.cmp(e)>0?e:new i(r)};Ee.comparedTo=Ee.cmp=function(n){var e,t,r,i,a=this,s=a.d,c=(n=new a.constructor(n)).d,u=a.s,d=n.s;if(!s||!c)return!u||!d?NaN:u!==d?u:s===c?0:!s^u<0?1:-1;if(!s[0]||!c[0])return s[0]?u:c[0]?-d:0;if(u!==d)return u;if(a.e!==n.e)return a.e>n.e^u<0?1:-1;for(r=s.length,i=c.length,e=0,t=r<i?r:i;e<t;++e)if(s[e]!==c[e])return s[e]>c[e]^u<0?1:-1;return r===i?0:r>i^u<0?1:-1};Ee.cosine=Ee.cos=function(){var n,e,t=this,r=t.constructor;return t.d?t.d[0]?(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+Je,r.rounding=1,t=kte(r,u5(r,t)),r.precision=n,r.rounding=e,Ye(As==2||As==3?t.neg():t,n,e,!0)):new r(1):new r(NaN)};Ee.cubeRoot=Ee.cbrt=function(){var n,e,t,r,i,a,s,c,u,d,h=this,p=h.constructor;if(!h.isFinite()||h.isZero())return new p(h);for(at=!1,a=h.s*Hn(h.s*h,1/3),!a||Math.abs(a)==1/0?(t=ur(h.d),n=h.e,(a=(n-t.length+1)%3)&&(t+=a==1||a==-2?"0":"00"),a=Hn(t,1/3),n=xr((n+1)/3)-(n%3==(n<0?-1:2)),a==1/0?t="5e"+n:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+n),r=new p(t),r.s=h.s):r=new p(a.toString()),s=(n=p.precision)+3;;)if(c=r,u=c.times(c).times(c),d=u.plus(h),r=Xt(d.plus(h).times(c),d.plus(u),s+2,1),ur(c.d).slice(0,s)===(t=ur(r.d)).slice(0,s))if(t=t.slice(s-3,s+1),t=="9999"||!i&&t=="4999"){if(!i&&(Ye(c,n+1,0),c.times(c).times(c).eq(h))){r=c;break}s+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(Ye(r,n+1,1),e=!r.times(r).times(r).eq(h));break}return at=!0,Ye(r,n,p.rounding,e)};Ee.decimalPlaces=Ee.dp=function(){var n,e=this.d,t=NaN;if(e){if(n=e.length-1,t=(n-xr(this.e/Je))*Je,n=e[n],n)for(;n%10==0;n/=10)t--;t<0&&(t=0)}return t};Ee.dividedBy=Ee.div=function(n){return Xt(this,new this.constructor(n))};Ee.dividedToIntegerBy=Ee.divToInt=function(n){var e=this,t=e.constructor;return Ye(Xt(e,new t(n),0,1,1),t.precision,t.rounding)};Ee.equals=Ee.eq=function(n){return this.cmp(n)===0};Ee.floor=function(){return Ye(new this.constructor(this),this.e+1,3)};Ee.greaterThan=Ee.gt=function(n){return this.cmp(n)>0};Ee.greaterThanOrEqualTo=Ee.gte=function(n){var e=this.cmp(n);return e==1||e===0};Ee.hyperbolicCosine=Ee.cosh=function(){var n,e,t,r,i,a=this,s=a.constructor,c=new s(1);if(!a.isFinite())return new s(a.s?1/0:NaN);if(a.isZero())return c;t=s.precision,r=s.rounding,s.precision=t+Math.max(a.e,a.sd())+4,s.rounding=1,i=a.d.length,i<32?(n=Math.ceil(i/3),e=(1/Ny(4,n)).toString()):(n=16,e="2.3283064365386962890625e-10"),a=Nd(s,1,a.times(e),new s(1),!0);for(var u,d=n,h=new s(8);d--;)u=a.times(a),a=c.minus(u.times(h.minus(u.times(h))));return Ye(a,s.precision=t,s.rounding=r,!0)};Ee.hyperbolicSine=Ee.sinh=function(){var n,e,t,r,i=this,a=i.constructor;if(!i.isFinite()||i.isZero())return new a(i);if(e=a.precision,t=a.rounding,a.precision=e+Math.max(i.e,i.sd())+4,a.rounding=1,r=i.d.length,r<3)i=Nd(a,2,i,i,!0);else{n=1.4*Math.sqrt(r),n=n>16?16:n|0,i=i.times(1/Ny(5,n)),i=Nd(a,2,i,i,!0);for(var s,c=new a(5),u=new a(16),d=new a(20);n--;)s=i.times(i),i=i.times(c.plus(s.times(u.times(s).plus(d))))}return a.precision=e,a.rounding=t,Ye(i,e,t,!0)};Ee.hyperbolicTangent=Ee.tanh=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+7,r.rounding=1,Xt(t.sinh(),t.cosh(),r.precision=n,r.rounding=e)):new r(t.s)};Ee.inverseCosine=Ee.acos=function(){var n=this,e=n.constructor,t=n.abs().cmp(1),r=e.precision,i=e.rounding;return t!==-1?t===0?n.isNeg()?za(e,r,i):new e(0):new e(NaN):n.isZero()?za(e,r+4,i).times(.5):(e.precision=r+6,e.rounding=1,n=new e(1).minus(n).div(n.plus(1)).sqrt().atan(),e.precision=r,e.rounding=i,n.times(2))};Ee.inverseHyperbolicCosine=Ee.acosh=function(){var n,e,t=this,r=t.constructor;return t.lte(1)?new r(t.eq(1)?0:NaN):t.isFinite()?(n=r.precision,e=r.rounding,r.precision=n+Math.max(Math.abs(t.e),t.sd())+4,r.rounding=1,at=!1,t=t.times(t).minus(1).sqrt().plus(t),at=!0,r.precision=n,r.rounding=e,t.ln()):new r(t)};Ee.inverseHyperbolicSine=Ee.asinh=function(){var n,e,t=this,r=t.constructor;return!t.isFinite()||t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+2*Math.max(Math.abs(t.e),t.sd())+6,r.rounding=1,at=!1,t=t.times(t).plus(1).sqrt().plus(t),at=!0,r.precision=n,r.rounding=e,t.ln())};Ee.inverseHyperbolicTangent=Ee.atanh=function(){var n,e,t,r,i=this,a=i.constructor;return i.isFinite()?i.e>=0?new a(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(n=a.precision,e=a.rounding,r=i.sd(),Math.max(r,n)<2*-i.e-1?Ye(new a(i),n,e,!0):(a.precision=t=r-i.e,i=Xt(i.plus(1),new a(1).minus(i),t+n,1),a.precision=n+4,a.rounding=1,i=i.ln(),a.precision=n,a.rounding=e,i.times(.5))):new a(NaN)};Ee.inverseSine=Ee.asin=function(){var n,e,t,r,i=this,a=i.constructor;return i.isZero()?new a(i):(e=i.abs().cmp(1),t=a.precision,r=a.rounding,e!==-1?e===0?(n=za(a,t+4,r).times(.5),n.s=i.s,n):new a(NaN):(a.precision=t+6,a.rounding=1,i=i.div(new a(1).minus(i.times(i)).sqrt().plus(1)).atan(),a.precision=t,a.rounding=r,i.times(2)))};Ee.inverseTangent=Ee.atan=function(){var n,e,t,r,i,a,s,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding;if(d.isFinite()){if(d.isZero())return new h(d);if(d.abs().eq(1)&&p+4<=Ew)return s=za(h,p+4,m).times(.25),s.s=d.s,s}else{if(!d.s)return new h(NaN);if(p+4<=Ew)return s=za(h,p+4,m).times(.5),s.s=d.s,s}for(h.precision=c=p+10,h.rounding=1,t=Math.min(28,c/Je+2|0),n=t;n;--n)d=d.div(d.times(d).plus(1).sqrt().plus(1));for(at=!1,e=Math.ceil(c/Je),r=1,u=d.times(d),s=new h(d),i=d;n!==-1;)if(i=i.times(u),a=s.minus(i.div(r+=2)),i=i.times(u),s=a.plus(i.div(r+=2)),s.d[e]!==void 0)for(n=e;s.d[n]===a.d[n]&&n--;);return t&&(s=s.times(2<<t-1)),at=!0,Ye(s,h.precision=p,h.rounding=m,!0)};Ee.isFinite=function(){return!!this.d};Ee.isInteger=Ee.isInt=function(){return!!this.d&&xr(this.e/Je)>this.d.length-2};Ee.isNaN=function(){return!this.s};Ee.isNegative=Ee.isNeg=function(){return this.s<0};Ee.isPositive=Ee.isPos=function(){return this.s>0};Ee.isZero=function(){return!!this.d&&this.d[0]===0};Ee.lessThan=Ee.lt=function(n){return this.cmp(n)<0};Ee.lessThanOrEqualTo=Ee.lte=function(n){return this.cmp(n)<1};Ee.logarithm=Ee.log=function(n){var e,t,r,i,a,s,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding,b=5;if(n==null)n=new h(10),e=!0;else{if(n=new h(n),t=n.d,n.s<0||!t||!t[0]||n.eq(1))return new h(NaN);e=n.eq(10)}if(t=d.d,d.s<0||!t||!t[0]||d.eq(1))return new h(t&&!t[0]?-1/0:d.s!=1?NaN:t?0:1/0);if(e)if(t.length>1)a=!0;else{for(i=t[0];i%10===0;)i/=10;a=i!==1}if(at=!1,c=p+b,s=qo(d,c),r=e?Mv(h,c+10):qo(n,c),u=Xt(s,r,c,1),Ep(u.d,i=p,m))do if(c+=10,s=qo(d,c),r=e?Mv(h,c+10):qo(n,c),u=Xt(s,r,c,1),!a){+ur(u.d).slice(i+1,i+15)+1==1e14&&(u=Ye(u,p+1,0));break}while(Ep(u.d,i+=10,m));return at=!0,Ye(u,p,m)};Ee.minus=Ee.sub=function(n){var e,t,r,i,a,s,c,u,d,h,p,m,b=this,_=b.constructor;if(n=new _(n),!b.d||!n.d)return!b.s||!n.s?n=new _(NaN):b.d?n.s=-n.s:n=new _(n.d||b.s!==n.s?b:NaN),n;if(b.s!=n.s)return n.s=-n.s,b.plus(n);if(d=b.d,m=n.d,c=_.precision,u=_.rounding,!d[0]||!m[0]){if(m[0])n.s=-n.s;else if(d[0])n=new _(b);else return new _(u===3?-0:0);return at?Ye(n,c,u):n}if(t=xr(n.e/Je),h=xr(b.e/Je),d=d.slice(),a=h-t,a){for(p=a<0,p?(e=d,a=-a,s=m.length):(e=m,t=h,s=d.length),r=Math.max(Math.ceil(c/Je),s)+2,a>r&&(a=r,e.length=1),e.reverse(),r=a;r--;)e.push(0);e.reverse()}else{for(r=d.length,s=m.length,p=r<s,p&&(s=r),r=0;r<s;r++)if(d[r]!=m[r]){p=d[r]<m[r];break}a=0}for(p&&(e=d,d=m,m=e,n.s=-n.s),s=d.length,r=m.length-s;r>0;--r)d[s++]=0;for(r=m.length;r>a;){if(d[--r]<m[r]){for(i=r;i&&d[--i]===0;)d[i]=aa-1;--d[i],d[r]+=aa}d[r]-=m[r]}for(;d[--s]===0;)d.pop();for(;d[0]===0;d.shift())--t;return d[0]?(n.d=d,n.e=Dy(d,t),at?Ye(n,c,u):n):new _(u===3?-0:0)};Ee.modulo=Ee.mod=function(n){var e,t=this,r=t.constructor;return n=new r(n),!t.d||!n.s||n.d&&!n.d[0]?new r(NaN):!n.d||t.d&&!t.d[0]?Ye(new r(t),r.precision,r.rounding):(at=!1,r.modulo==9?(e=Xt(t,n.abs(),0,3,1),e.s*=n.s):e=Xt(t,n,0,r.modulo,1),e=e.times(n),at=!0,t.minus(e))};Ee.naturalExponential=Ee.exp=function(){return Tw(this)};Ee.naturalLogarithm=Ee.ln=function(){return qo(this)};Ee.negated=Ee.neg=function(){var n=new this.constructor(this);return n.s=-n.s,Ye(n)};Ee.plus=Ee.add=function(n){var e,t,r,i,a,s,c,u,d,h,p=this,m=p.constructor;if(n=new m(n),!p.d||!n.d)return!p.s||!n.s?n=new m(NaN):p.d||(n=new m(n.d||p.s===n.s?p:NaN)),n;if(p.s!=n.s)return n.s=-n.s,p.minus(n);if(d=p.d,h=n.d,c=m.precision,u=m.rounding,!d[0]||!h[0])return h[0]||(n=new m(p)),at?Ye(n,c,u):n;if(a=xr(p.e/Je),r=xr(n.e/Je),d=d.slice(),i=a-r,i){for(i<0?(t=d,i=-i,s=h.length):(t=h,r=a,s=d.length),a=Math.ceil(c/Je),s=a>s?a+1:s+1,i>s&&(i=s,t.length=1),t.reverse();i--;)t.push(0);t.reverse()}for(s=d.length,i=h.length,s-i<0&&(i=s,t=h,h=d,d=t),e=0;i;)e=(d[--i]=d[i]+h[i]+e)/aa|0,d[i]%=aa;for(e&&(d.unshift(e),++r),s=d.length;d[--s]==0;)d.pop();return n.d=d,n.e=Dy(d,r),at?Ye(n,c,u):n};Ee.precision=Ee.sd=function(n){var e,t=this;if(n!==void 0&&n!==!!n&&n!==1&&n!==0)throw Error(ul+n);return t.d?(e=s5(t.d),n&&t.e+1>e&&(e=t.e+1)):e=NaN,e};Ee.round=function(){var n=this,e=n.constructor;return Ye(new e(n),n.e+1,e.rounding)};Ee.sine=Ee.sin=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+Je,r.rounding=1,t=Nte(r,u5(r,t)),r.precision=n,r.rounding=e,Ye(As>2?t.neg():t,n,e,!0)):new r(NaN)};Ee.squareRoot=Ee.sqrt=function(){var n,e,t,r,i,a,s=this,c=s.d,u=s.e,d=s.s,h=s.constructor;if(d!==1||!c||!c[0])return new h(!d||d<0&&(!c||c[0])?NaN:c?s:1/0);for(at=!1,d=Math.sqrt(+s),d==0||d==1/0?(e=ur(c),(e.length+u)%2==0&&(e+="0"),d=Math.sqrt(e),u=xr((u+1)/2)-(u<0||u%2),d==1/0?e="5e"+u:(e=d.toExponential(),e=e.slice(0,e.indexOf("e")+1)+u),r=new h(e)):r=new h(d.toString()),t=(u=h.precision)+3;;)if(a=r,r=a.plus(Xt(s,a,t+2,1)).times(.5),ur(a.d).slice(0,t)===(e=ur(r.d)).slice(0,t))if(e=e.slice(t-3,t+1),e=="9999"||!i&&e=="4999"){if(!i&&(Ye(a,u+1,0),a.times(a).eq(s))){r=a;break}t+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(Ye(r,u+1,1),n=!r.times(r).eq(s));break}return at=!0,Ye(r,u,h.rounding,n)};Ee.tangent=Ee.tan=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+10,r.rounding=1,t=t.sin(),t.s=1,t=Xt(t,new r(1).minus(t.times(t)).sqrt(),n+10,0),r.precision=n,r.rounding=e,Ye(As==2||As==4?t.neg():t,n,e,!0)):new r(NaN)};Ee.times=Ee.mul=function(n){var e,t,r,i,a,s,c,u,d,h=this,p=h.constructor,m=h.d,b=(n=new p(n)).d;if(n.s*=h.s,!m||!m[0]||!b||!b[0])return new p(!n.s||m&&!m[0]&&!b||b&&!b[0]&&!m?NaN:!m||!b?n.s/0:n.s*0);for(t=xr(h.e/Je)+xr(n.e/Je),u=m.length,d=b.length,u<d&&(a=m,m=b,b=a,s=u,u=d,d=s),a=[],s=u+d,r=s;r--;)a.push(0);for(r=d;--r>=0;){for(e=0,i=u+r;i>r;)c=a[i]+b[r]*m[i-r-1]+e,a[i--]=c%aa|0,e=c/aa|0;a[i]=(a[i]+e)%aa|0}for(;!a[--s];)a.pop();return e?++t:a.shift(),n.d=a,n.e=Dy(a,t),at?Ye(n,p.precision,p.rounding):n};Ee.toBinary=function(n,e){return hT(this,2,n,e)};Ee.toDecimalPlaces=Ee.toDP=function(n,e){var t=this,r=t.constructor;return t=new r(t),n===void 0?t:(Hr(n,0,yl),e===void 0?e=r.rounding:Hr(e,0,8),Ye(t,n+t.e+1,e))};Ee.toExponential=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=Wa(r,!0):(Hr(n,0,yl),e===void 0?e=i.rounding:Hr(e,0,8),r=Ye(new i(r),n+1,e),t=Wa(r,!0,n+1)),r.isNeg()&&!r.isZero()?"-"+t:t};Ee.toFixed=function(n,e){var t,r,i=this,a=i.constructor;return n===void 0?t=Wa(i):(Hr(n,0,yl),e===void 0?e=a.rounding:Hr(e,0,8),r=Ye(new a(i),n+i.e+1,e),t=Wa(r,!1,n+r.e+1)),i.isNeg()&&!i.isZero()?"-"+t:t};Ee.toFraction=function(n){var e,t,r,i,a,s,c,u,d,h,p,m,b=this,_=b.d,w=b.constructor;if(!_)return new w(b);if(d=t=new w(1),r=u=new w(0),e=new w(r),a=e.e=s5(_)-b.e-1,s=a%Je,e.d[0]=Hn(10,s<0?Je+s:s),n==null)n=a>0?e:d;else{if(c=new w(n),!c.isInt()||c.lt(d))throw Error(ul+c);n=c.gt(e)?a>0?e:d:c}for(at=!1,c=new w(ur(_)),h=w.precision,w.precision=a=_.length*Je*2;p=Xt(c,e,0,1,1),i=t.plus(p.times(r)),i.cmp(n)!=1;)t=r,r=i,i=d,d=u.plus(p.times(i)),u=i,i=e,e=c.minus(p.times(i)),c=i;return i=Xt(n.minus(t),r,0,1,1),u=u.plus(i.times(d)),t=t.plus(i.times(r)),u.s=d.s=b.s,m=Xt(d,r,a,1).minus(b).abs().cmp(Xt(u,t,a,1).minus(b).abs())<1?[d,r]:[u,t],w.precision=h,at=!0,m};Ee.toHexadecimal=Ee.toHex=function(n,e){return hT(this,16,n,e)};Ee.toNearest=function(n,e){var t=this,r=t.constructor;if(t=new r(t),n==null){if(!t.d)return t;n=new r(1),e=r.rounding}else{if(n=new r(n),e===void 0?e=r.rounding:Hr(e,0,8),!t.d)return n.s?t:n;if(!n.d)return n.s&&(n.s=t.s),n}return n.d[0]?(at=!1,t=Xt(t,n,0,e,1).times(n),at=!0,Ye(t)):(n.s=t.s,t=n),t};Ee.toNumber=function(){return+this};Ee.toOctal=function(n,e){return hT(this,8,n,e)};Ee.toPower=Ee.pow=function(n){var e,t,r,i,a,s,c=this,u=c.constructor,d=+(n=new u(n));if(!c.d||!n.d||!c.d[0]||!n.d[0])return new u(Hn(+c,d));if(c=new u(c),c.eq(1))return c;if(r=u.precision,a=u.rounding,n.eq(1))return Ye(c,r,a);if(e=xr(n.e/Je),e>=n.d.length-1&&(t=d<0?-d:d)<=Ite)return i=o5(u,c,t,r),n.s<0?new u(1).div(i):Ye(i,r,a);if(s=c.s,s<0){if(e<n.d.length-1)return new u(NaN);if((n.d[e]&1)==0&&(s=1),c.e==0&&c.d[0]==1&&c.d.length==1)return c.s=s,c}return t=Hn(+c,d),e=t==0||!isFinite(t)?xr(d*(Math.log("0."+ur(c.d))/Math.LN10+c.e+1)):new u(t+"").e,e>u.maxE+1||e<u.minE-1?new u(e>0?s/0:0):(at=!1,u.rounding=c.s=1,t=Math.min(12,(e+"").length),i=Tw(n.times(qo(c,r+t)),r),i.d&&(i=Ye(i,r+5,1),Ep(i.d,r,a)&&(e=r+10,i=Ye(Tw(n.times(qo(c,e+t)),e),e+5,1),+ur(i.d).slice(r+1,r+15)+1==1e14&&(i=Ye(i,r+1,0)))),i.s=s,at=!0,u.rounding=a,Ye(i,r,a))};Ee.toPrecision=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=Wa(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(Hr(n,1,yl),e===void 0?e=i.rounding:Hr(e,0,8),r=Ye(new i(r),n,e),t=Wa(r,n<=r.e||r.e<=i.toExpNeg,n)),r.isNeg()&&!r.isZero()?"-"+t:t};Ee.toSignificantDigits=Ee.toSD=function(n,e){var t=this,r=t.constructor;return n===void 0?(n=r.precision,e=r.rounding):(Hr(n,1,yl),e===void 0?e=r.rounding:Hr(e,0,8)),Ye(new r(t),n,e)};Ee.toString=function(){var n=this,e=n.constructor,t=Wa(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()&&!n.isZero()?"-"+t:t};Ee.truncated=Ee.trunc=function(){return Ye(new this.constructor(this),this.e+1,1)};Ee.valueOf=Ee.toJSON=function(){var n=this,e=n.constructor,t=Wa(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()?"-"+t:t};function ur(n){var e,t,r,i=n.length-1,a="",s=n[0];if(i>0){for(a+=s,e=1;e<i;e++)r=n[e]+"",t=Je-r.length,t&&(a+=Mo(t)),a+=r;s=n[e],r=s+"",t=Je-r.length,t&&(a+=Mo(t))}else if(s===0)return"0";for(;s%10===0;)s/=10;return a+s}function Hr(n,e,t){if(n!==~~n||n<e||n>t)throw Error(ul+n)}function Ep(n,e,t,r){var i,a,s,c;for(a=n[0];a>=10;a/=10)--e;return--e<0?(e+=Je,i=0):(i=Math.ceil((e+1)/Je),e%=Je),a=Hn(10,Je-e),c=n[i]%a|0,r==null?e<3?(e==0?c=c/100|0:e==1&&(c=c/10|0),s=t<4&&c==99999||t>3&&c==49999||c==5e4||c==0):s=(t<4&&c+1==a||t>3&&c+1==a/2)&&(n[i+1]/a/100|0)==Hn(10,e-2)-1||(c==a/2||c==0)&&(n[i+1]/a/100|0)==0:e<4?(e==0?c=c/1e3|0:e==1?c=c/100|0:e==2&&(c=c/10|0),s=(r||t<4)&&c==9999||!r&&t>3&&c==4999):s=((r||t<4)&&c+1==a||!r&&t>3&&c+1==a/2)&&(n[i+1]/a/1e3|0)==Hn(10,e-3)-1,s}function M0(n,e,t){for(var r,i=[0],a,s=0,c=n.length;s<c;){for(a=i.length;a--;)i[a]*=e;for(i[0]+=ww.indexOf(n.charAt(s++)),r=0;r<i.length;r++)i[r]>t-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/t|0,i[r]%=t)}return i.reverse()}function kte(n,e){var t,r,i;if(e.isZero())return e;r=e.d.length,r<32?(t=Math.ceil(r/3),i=(1/Ny(4,t)).toString()):(t=16,i="2.3283064365386962890625e-10"),n.precision+=t,e=Nd(n,1,e.times(i),new n(1));for(var a=t;a--;){var s=e.times(e);e=s.times(s).minus(s).times(8).plus(1)}return n.precision-=t,e}var Xt=(function(){function n(r,i,a){var s,c=0,u=r.length;for(r=r.slice();u--;)s=r[u]*i+c,r[u]=s%a|0,c=s/a|0;return c&&r.unshift(c),r}function e(r,i,a,s){var c,u;if(a!=s)u=a>s?1:-1;else for(c=u=0;c<a;c++)if(r[c]!=i[c]){u=r[c]>i[c]?1:-1;break}return u}function t(r,i,a,s){for(var c=0;a--;)r[a]-=c,c=r[a]<i[a]?1:0,r[a]=c*s+r[a]-i[a];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,a,s,c,u){var d,h,p,m,b,_,w,E,T,C,k,j,P,N,A,I,D,z,V,B,O=r.constructor,X=r.s==i.s?1:-1,K=r.d,$=i.d;if(!K||!K[0]||!$||!$[0])return new O(!r.s||!i.s||(K?$&&K[0]==$[0]:!$)?NaN:K&&K[0]==0||!$?X*0:X/0);for(u?(b=1,h=r.e-i.e):(u=aa,b=Je,h=xr(r.e/b)-xr(i.e/b)),V=$.length,D=K.length,T=new O(X),C=T.d=[],p=0;$[p]==(K[p]||0);p++);if($[p]>(K[p]||0)&&h--,a==null?(N=a=O.precision,s=O.rounding):c?N=a+(r.e-i.e)+1:N=a,N<0)C.push(1),_=!0;else{if(N=N/b+2|0,p=0,V==1){for(m=0,$=$[0],N++;(p<D||m)&&N--;p++)A=m*u+(K[p]||0),C[p]=A/$|0,m=A%$|0;_=m||p<D}else{for(m=u/($[0]+1)|0,m>1&&($=n($,m,u),K=n(K,m,u),V=$.length,D=K.length),I=V,k=K.slice(0,V),j=k.length;j<V;)k[j++]=0;B=$.slice(),B.unshift(0),z=$[0],$[1]>=u/2&&++z;do m=0,d=e($,k,V,j),d<0?(P=k[0],V!=j&&(P=P*u+(k[1]||0)),m=P/z|0,m>1?(m>=u&&(m=u-1),w=n($,m,u),E=w.length,j=k.length,d=e(w,k,E,j),d==1&&(m--,t(w,V<E?B:$,E,u))):(m==0&&(d=m=1),w=$.slice()),E=w.length,E<j&&w.unshift(0),t(k,w,j,u),d==-1&&(j=k.length,d=e($,k,V,j),d<1&&(m++,t(k,V<j?B:$,j,u))),j=k.length):d===0&&(m++,k=[0]),C[p++]=m,d&&k[0]?k[j++]=K[I]||0:(k=[K[I]],j=1);while((I++<D||k[0]!==void 0)&&N--);_=k[0]!==void 0}C[0]||C.shift()}if(b==1)T.e=h,t5=_;else{for(p=1,m=C[0];m>=10;m/=10)p++;T.e=p+h*b-1,Ye(T,c?a+T.e+1:a,s,_)}return T}})();function Ye(n,e,t,r){var i,a,s,c,u,d,h,p,m,b=n.constructor;e:if(e!=null){if(p=n.d,!p)return n;for(i=1,c=p[0];c>=10;c/=10)i++;if(a=e-i,a<0)a+=Je,s=e,h=p[m=0],u=h/Hn(10,i-s-1)%10|0;else if(m=Math.ceil((a+1)/Je),c=p.length,m>=c)if(r){for(;c++<=m;)p.push(0);h=u=0,i=1,a%=Je,s=a-Je+1}else break e;else{for(h=c=p[m],i=1;c>=10;c/=10)i++;a%=Je,s=a-Je+i,u=s<0?0:h/Hn(10,i-s-1)%10|0}if(r=r||e<0||p[m+1]!==void 0||(s<0?h:h%Hn(10,i-s-1)),d=t<4?(u||r)&&(t==0||t==(n.s<0?3:2)):u>5||u==5&&(t==4||r||t==6&&(a>0?s>0?h/Hn(10,i-s):0:p[m-1])%10&1||t==(n.s<0?8:7)),e<1||!p[0])return p.length=0,d?(e-=n.e+1,p[0]=Hn(10,(Je-e%Je)%Je),n.e=-e||0):p[0]=n.e=0,n;if(a==0?(p.length=m,c=1,m--):(p.length=m+1,c=Hn(10,Je-a),p[m]=s>0?(h/Hn(10,i-s)%Hn(10,s)|0)*c:0),d)for(;;)if(m==0){for(a=1,s=p[0];s>=10;s/=10)a++;for(s=p[0]+=c,c=1;s>=10;s/=10)c++;a!=c&&(n.e++,p[0]==aa&&(p[0]=1));break}else{if(p[m]+=c,p[m]!=aa)break;p[m--]=0,c=1}for(a=p.length;p[--a]===0;)p.pop()}return at&&(n.e>b.maxE?(n.d=null,n.e=NaN):n.e<b.minE&&(n.e=0,n.d=[0])),n}function Wa(n,e,t){if(!n.isFinite())return c5(n);var r,i=n.e,a=ur(n.d),s=a.length;return e?(t&&(r=t-s)>0?a=a.charAt(0)+"."+a.slice(1)+Mo(r):s>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(n.e<0?"e":"e+")+n.e):i<0?(a="0."+Mo(-i-1)+a,t&&(r=t-s)>0&&(a+=Mo(r))):i>=s?(a+=Mo(i+1-s),t&&(r=t-i-1)>0&&(a=a+"."+Mo(r))):((r=i+1)<s&&(a=a.slice(0,r)+"."+a.slice(r)),t&&(r=t-s)>0&&(i+1===s&&(a+="."),a+=Mo(r))),a}function Dy(n,e){var t=n[0];for(e*=Je;t>=10;t/=10)e++;return e}function Mv(n,e,t){if(e>Rte)throw at=!0,t&&(n.precision=t),Error(n5);return Ye(new n(Dv),e,1,!0)}function za(n,e,t){if(e>Ew)throw Error(n5);return Ye(new n(Nv),e,t,!0)}function s5(n){var e=n.length-1,t=e*Je+1;if(e=n[e],e){for(;e%10==0;e/=10)t--;for(e=n[0];e>=10;e/=10)t++}return t}function Mo(n){for(var e="";n--;)e+="0";return e}function o5(n,e,t,r){var i,a=new n(1),s=Math.ceil(r/Je+4);for(at=!1;;){if(t%2&&(a=a.times(e),xN(a.d,s)&&(i=!0)),t=xr(t/2),t===0){t=a.d.length-1,i&&a.d[t]===0&&++a.d[t];break}e=e.times(e),xN(e.d,s)}return at=!0,a}function bN(n){return n.d[n.d.length-1]&1}function l5(n,e,t){for(var r,i,a=new n(e[0]),s=0;++s<e.length;){if(i=new n(e[s]),!i.s){a=i;break}r=a.cmp(i),(r===t||r===0&&a.s===t)&&(a=i)}return a}function Tw(n,e){var t,r,i,a,s,c,u,d=0,h=0,p=0,m=n.constructor,b=m.rounding,_=m.precision;if(!n.d||!n.d[0]||n.e>17)return new m(n.d?n.d[0]?n.s<0?0:1/0:1:n.s?n.s<0?0:n:NaN);for(e==null?(at=!1,u=_):u=e,c=new m(.03125);n.e>-2;)n=n.times(c),p+=5;for(r=Math.log(Hn(2,p))/Math.LN10*2+5|0,u+=r,t=a=s=new m(1),m.precision=u;;){if(a=Ye(a.times(n),u,1),t=t.times(++h),c=s.plus(Xt(a,t,u,1)),ur(c.d).slice(0,u)===ur(s.d).slice(0,u)){for(i=p;i--;)s=Ye(s.times(s),u,1);if(e==null)if(d<3&&Ep(s.d,u-r,b,d))m.precision=u+=10,t=a=c=new m(1),h=0,d++;else return Ye(s,m.precision=_,b,at=!0);else return m.precision=_,s}s=c}}function qo(n,e){var t,r,i,a,s,c,u,d,h,p,m,b=1,_=10,w=n,E=w.d,T=w.constructor,C=T.rounding,k=T.precision;if(w.s<0||!E||!E[0]||!w.e&&E[0]==1&&E.length==1)return new T(E&&!E[0]?-1/0:w.s!=1?NaN:E?0:w);if(e==null?(at=!1,h=k):h=e,T.precision=h+=_,t=ur(E),r=t.charAt(0),Math.abs(a=w.e)<15e14){for(;r<7&&r!=1||r==1&&t.charAt(1)>3;)w=w.times(n),t=ur(w.d),r=t.charAt(0),b++;a=w.e,r>1?(w=new T("0."+t),a++):w=new T(r+"."+t.slice(1))}else return d=Mv(T,h+2,k).times(a+""),w=qo(new T(r+"."+t.slice(1)),h-_).plus(d),T.precision=k,e==null?Ye(w,k,C,at=!0):w;for(p=w,u=s=w=Xt(w.minus(1),w.plus(1),h,1),m=Ye(w.times(w),h,1),i=3;;){if(s=Ye(s.times(m),h,1),d=u.plus(Xt(s,new T(i),h,1)),ur(d.d).slice(0,h)===ur(u.d).slice(0,h))if(u=u.times(2),a!==0&&(u=u.plus(Mv(T,h+2,k).times(a+""))),u=Xt(u,new T(b),h,1),e==null)if(Ep(u.d,h-_,C,c))T.precision=h+=_,d=s=w=Xt(p.minus(1),p.plus(1),h,1),m=Ye(w.times(w),h,1),i=c=1;else return Ye(u,T.precision=k,C,at=!0);else return T.precision=k,u;u=d,i+=2}}function c5(n){return String(n.s*n.s/0)}function P0(n,e){var t,r,i;for((t=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(t<0&&(t=r),t+=+e.slice(r+1),e=e.substring(0,r)):t<0&&(t=e.length),r=0;e.charCodeAt(r)===48;r++);for(i=e.length;e.charCodeAt(i-1)===48;--i);if(e=e.slice(r,i),e){if(i-=r,n.e=t=t-r-1,n.d=[],r=(t+1)%Je,t<0&&(r+=Je),r<i){for(r&&n.d.push(+e.slice(0,r)),i-=Je;r<i;)n.d.push(+e.slice(r,r+=Je));e=e.slice(r),r=Je-e.length}else r-=i;for(;r--;)e+="0";n.d.push(+e),at&&(n.e>n.constructor.maxE?(n.d=null,n.e=NaN):n.e<n.constructor.minE&&(n.e=0,n.d=[0]))}else n.e=0,n.d=[0];return n}function Dte(n,e){var t,r,i,a,s,c,u,d,h;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),a5.test(e))return P0(n,e)}else if(e==="Infinity"||e==="NaN")return+e||(n.s=NaN),n.e=NaN,n.d=null,n;if(Ate.test(e))t=16,e=e.toLowerCase();else if(Tte.test(e))t=2;else if(Cte.test(e))t=8;else throw Error(ul+e);for(a=e.search(/p/i),a>0?(u=+e.slice(a+1),e=e.substring(2,a)):e=e.slice(2),a=e.indexOf("."),s=a>=0,r=n.constructor,s&&(e=e.replace(".",""),c=e.length,a=c-a,i=o5(r,new r(t),a,a*2)),d=M0(e,t,aa),h=d.length-1,a=h;d[a]===0;--a)d.pop();return a<0?new r(n.s*0):(n.e=Dy(d,h),n.d=d,at=!1,s&&(n=Xt(n,i,c*4)),u&&(n=n.times(Math.abs(u)<54?Hn(2,u):Md.pow(2,u))),at=!0,n)}function Nte(n,e){var t,r=e.d.length;if(r<3)return e.isZero()?e:Nd(n,2,e,e);t=1.4*Math.sqrt(r),t=t>16?16:t|0,e=e.times(1/Ny(5,t)),e=Nd(n,2,e,e);for(var i,a=new n(5),s=new n(16),c=new n(20);t--;)i=e.times(e),e=e.times(a.plus(i.times(s.times(i).minus(c))));return e}function Nd(n,e,t,r,i){var a,s,c,u,d=n.precision,h=Math.ceil(d/Je);for(at=!1,u=t.times(t),c=new n(r);;){if(s=Xt(c.times(u),new n(e++*e++),d,1),c=i?r.plus(s):r.minus(s),r=Xt(s.times(u),new n(e++*e++),d,1),s=c.plus(r),s.d[h]!==void 0){for(a=h;s.d[a]===c.d[a]&&a--;);if(a==-1)break}a=c,c=r,r=s,s=a}return at=!0,s.d.length=h+1,s}function Ny(n,e){for(var t=n;--e;)t*=n;return t}function u5(n,e){var t,r=e.s<0,i=za(n,n.precision,1),a=i.times(.5);if(e=e.abs(),e.lte(a))return As=r?4:1,e;if(t=e.divToInt(i),t.isZero())As=r?3:2;else{if(e=e.minus(t.times(i)),e.lte(a))return As=bN(t)?r?2:3:r?4:1,e;As=bN(t)?r?1:4:r?3:2}return e.minus(i).abs()}function hT(n,e,t,r){var i,a,s,c,u,d,h,p,m,b=n.constructor,_=t!==void 0;if(_?(Hr(t,1,yl),r===void 0?r=b.rounding:Hr(r,0,8)):(t=b.precision,r=b.rounding),!n.isFinite())h=c5(n);else{for(h=Wa(n),s=h.indexOf("."),_?(i=2,e==16?t=t*4-3:e==8&&(t=t*3-2)):i=e,s>=0&&(h=h.replace(".",""),m=new b(1),m.e=h.length-s,m.d=M0(Wa(m),10,i),m.e=m.d.length),p=M0(h,10,i),a=u=p.length;p[--u]==0;)p.pop();if(!p[0])h=_?"0p+0":"0";else{if(s<0?a--:(n=new b(n),n.d=p,n.e=a,n=Xt(n,m,t,r,0,i),p=n.d,a=n.e,d=t5),s=p[t],c=i/2,d=d||p[t+1]!==void 0,d=r<4?(s!==void 0||d)&&(r===0||r===(n.s<0?3:2)):s>c||s===c&&(r===4||d||r===6&&p[t-1]&1||r===(n.s<0?8:7)),p.length=t,d)for(;++p[--t]>i-1;)p[t]=0,t||(++a,p.unshift(1));for(u=p.length;!p[u-1];--u);for(s=0,h="";s<u;s++)h+=ww.charAt(p[s]);if(_){if(u>1)if(e==16||e==8){for(s=e==16?4:3,--u;u%s;u++)h+="0";for(p=M0(h,i,e),u=p.length;!p[u-1];--u);for(s=1,h="1.";s<u;s++)h+=ww.charAt(p[s])}else h=h.charAt(0)+"."+h.slice(1);h=h+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)h="0"+h;h="0."+h}else if(++a>u)for(a-=u;a--;)h+="0";else a<u&&(h=h.slice(0,a)+"."+h.slice(a))}h=(e==16?"0x":e==2?"0b":e==8?"0o":"")+h}return n.s<0?"-"+h:h}function xN(n,e){if(n.length>e)return n.length=e,!0}function Mte(n){return new this(n).abs()}function Pte(n){return new this(n).acos()}function Ote(n){return new this(n).acosh()}function jte(n,e){return new this(n).plus(e)}function Vte(n){return new this(n).asin()}function zte(n){return new this(n).asinh()}function Lte(n){return new this(n).atan()}function Bte(n){return new this(n).atanh()}function Ute(n,e){n=new this(n),e=new this(e);var t,r=this.precision,i=this.rounding,a=r+4;return!n.s||!e.s?t=new this(NaN):!n.d&&!e.d?(t=za(this,a,1).times(e.s>0?.25:.75),t.s=n.s):!e.d||n.isZero()?(t=e.s<0?za(this,r,i):new this(0),t.s=n.s):!n.d||e.isZero()?(t=za(this,a,1).times(.5),t.s=n.s):e.s<0?(this.precision=a,this.rounding=1,t=this.atan(Xt(n,e,a,1)),e=za(this,a,1),this.precision=r,this.rounding=i,t=n.s<0?t.minus(e):t.plus(e)):t=this.atan(Xt(n,e,a,1)),t}function Fte(n){return new this(n).cbrt()}function Gte(n){return Ye(n=new this(n),n.e+1,2)}function qte(n,e,t){return new this(n).clamp(e,t)}function $te(n){if(!n||typeof n!="object")throw Error(ky+"Object expected");var e,t,r,i=n.defaults===!0,a=["precision",1,yl,"rounding",0,8,"toExpNeg",-Qu,0,"toExpPos",0,Qu,"maxE",0,Qu,"minE",-Qu,0,"modulo",0,9];for(e=0;e<a.length;e+=3)if(t=a[e],i&&(this[t]=Sw[t]),(r=n[t])!==void 0)if(xr(r)===r&&r>=a[e+1]&&r<=a[e+2])this[t]=r;else throw Error(ul+t+": "+r);if(t="crypto",i&&(this[t]=Sw[t]),(r=n[t])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[t]=!0;else throw Error(r5);else this[t]=!1;else throw Error(ul+t+": "+r);return this}function Hte(n){return new this(n).cos()}function Yte(n){return new this(n).cosh()}function d5(n){var e,t,r;function i(a){var s,c,u,d=this;if(!(d instanceof i))return new i(a);if(d.constructor=i,_N(a)){d.s=a.s,at?!a.d||a.e>i.maxE?(d.e=NaN,d.d=null):a.e<i.minE?(d.e=0,d.d=[0]):(d.e=a.e,d.d=a.d.slice()):(d.e=a.e,d.d=a.d?a.d.slice():a.d);return}if(u=typeof a,u==="number"){if(a===0){d.s=1/a<0?-1:1,d.e=0,d.d=[0];return}if(a<0?(a=-a,d.s=-1):d.s=1,a===~~a&&a<1e7){for(s=0,c=a;c>=10;c/=10)s++;at?s>i.maxE?(d.e=NaN,d.d=null):s<i.minE?(d.e=0,d.d=[0]):(d.e=s,d.d=[a]):(d.e=s,d.d=[a]);return}if(a*0!==0){a||(d.s=NaN),d.e=NaN,d.d=null;return}return P0(d,a.toString())}if(u==="string")return(c=a.charCodeAt(0))===45?(a=a.slice(1),d.s=-1):(c===43&&(a=a.slice(1)),d.s=1),a5.test(a)?P0(d,a):Dte(d,a);if(u==="bigint")return a<0?(a=-a,d.s=-1):d.s=1,P0(d,a.toString());throw Error(ul+a)}if(i.prototype=Ee,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=$te,i.clone=d5,i.isDecimal=_N,i.abs=Mte,i.acos=Pte,i.acosh=Ote,i.add=jte,i.asin=Vte,i.asinh=zte,i.atan=Lte,i.atanh=Bte,i.atan2=Ute,i.cbrt=Fte,i.ceil=Gte,i.clamp=qte,i.cos=Hte,i.cosh=Yte,i.div=Kte,i.exp=Xte,i.floor=Wte,i.hypot=Qte,i.ln=Zte,i.log=Jte,i.log10=tne,i.log2=ene,i.max=nne,i.min=rne,i.mod=ine,i.mul=ane,i.pow=sne,i.random=one,i.round=lne,i.sign=cne,i.sin=une,i.sinh=dne,i.sqrt=fne,i.sub=hne,i.sum=pne,i.tan=gne,i.tanh=mne,i.trunc=vne,n===void 0&&(n={}),n&&n.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<r.length;)n.hasOwnProperty(t=r[e++])||(n[t]=this[t]);return i.config(n),i}function Kte(n,e){return new this(n).div(e)}function Xte(n){return new this(n).exp()}function Wte(n){return Ye(n=new this(n),n.e+1,3)}function Qte(){var n,e,t=new this(0);for(at=!1,n=0;n<arguments.length;)if(e=new this(arguments[n++]),e.d)t.d&&(t=t.plus(e.times(e)));else{if(e.s)return at=!0,new this(1/0);t=e}return at=!0,t.sqrt()}function _N(n){return n instanceof Md||n&&n.toStringTag===i5||!1}function Zte(n){return new this(n).ln()}function Jte(n,e){return new this(n).log(e)}function ene(n){return new this(n).log(2)}function tne(n){return new this(n).log(10)}function nne(){return l5(this,arguments,-1)}function rne(){return l5(this,arguments,1)}function ine(n,e){return new this(n).mod(e)}function ane(n,e){return new this(n).mul(e)}function sne(n,e){return new this(n).pow(e)}function one(n){var e,t,r,i,a=0,s=new this(1),c=[];if(n===void 0?n=this.precision:Hr(n,1,yl),r=Math.ceil(n/Je),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));a<r;)i=e[a],i>=429e7?e[a]=crypto.getRandomValues(new Uint32Array(1))[0]:c[a++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(r*=4);a<r;)i=e[a]+(e[a+1]<<8)+(e[a+2]<<16)+((e[a+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(e,a):(c.push(i%1e7),a+=4);a=r/4}else throw Error(r5);else for(;a<r;)c[a++]=Math.random()*1e7|0;for(r=c[--a],n%=Je,r&&n&&(i=Hn(10,Je-n),c[a]=(r/i|0)*i);c[a]===0;a--)c.pop();if(a<0)t=0,c=[0];else{for(t=-1;c[0]===0;t-=Je)c.shift();for(r=1,i=c[0];i>=10;i/=10)r++;r<Je&&(t-=Je-r)}return s.e=t,s.d=c,s}function lne(n){return Ye(n=new this(n),n.e+1,this.rounding)}function cne(n){return n=new this(n),n.d?n.d[0]?n.s:0*n.s:n.s||NaN}function une(n){return new this(n).sin()}function dne(n){return new this(n).sinh()}function fne(n){return new this(n).sqrt()}function hne(n,e){return new this(n).sub(e)}function pne(){var n=0,e=arguments,t=new this(e[n]);for(at=!1;t.s&&++n<e.length;)t=t.plus(e[n]);return at=!0,Ye(t,this.precision,this.rounding)}function gne(n){return new this(n).tan()}function mne(n){return new this(n).tanh()}function vne(n){return Ye(n=new this(n),n.e+1,1)}Ee[Symbol.for("nodejs.util.inspect.custom")]=Ee.toString;Ee[Symbol.toStringTag]="Decimal";var Md=Ee.constructor=d5(Sw);Dv=new Md(Dv);Nv=new Md(Nv);const wN=n=>{if(!n)return null;if(n instanceof Date)return n;if(typeof n=="object"&&typeof n.toDate=="function")return n.toDate();if(typeof n=="object"&&n.seconds!==void 0)return new Date(n.seconds*1e3);if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?null:e}if(typeof n=="number"){const e=new Date(n);return isNaN(e.getTime())?null:e}return null},yne=()=>{const{envelopes:n,transactions:e,fetchData:t,isLoading:r,isOnline:i,reorderEnvelopes:a}=an(),{currentUser:s}=Mi(),{currentMonth:c,incomeSources:u,allocations:d,deleteIncomeSource:h,setEnvelopeAllocation:p,copyPreviousMonthAllocations:m,isLoading:b}=an(),{showToast:_}=Vc(),[w,E]=U.useState(!1),T=U.useRef(null),[C,k]=U.useState(!1),j=!C||r||b,[P,N]=U.useState([]),A=U.useRef([]),[I,D]=U.useState([]),z=U.useRef([]),V=U.useCallback(ne=>{if(n.find(ue=>ue.id===ne)?.isPiggybank){const ue=an.getState().getEnvelopeBalance(ne);return new Md(ue)}const oe=an.getState().getEnvelopeBalance(ne,c);return new Md(oe)},[n,c]);U.useEffect(()=>{const ne=n.filter(Z=>{if(!Z.isPiggybank||!Z.isActive)return!1;if(Z.createdAt)try{const oe=wN(Z.createdAt);if(!oe)return console.error(` Invalid creation date for piggybank ${Z.name}:`,Z.createdAt),!1;const ue=`${oe.getFullYear()}-${String(oe.getMonth()+1).padStart(2,"0")}`;return c>=ue}catch(oe){return console.error(` Error processing piggybank ${Z.name}:`,oe,{createdAt:Z.createdAt,typeofCreatedAt:typeof Z.createdAt}),!1}return!0}).sort((Z,oe)=>{const ue=Z.orderIndex??0,ye=oe.orderIndex??0;return ue-ye});D(ne),z.current=ne},[n,c]);const B=I,O=P;U.useEffect(()=>(T.current=setTimeout(()=>{E(!0)},8e3),t(),k(!0),()=>{T.current&&clearTimeout(T.current)}),[]),U.useEffect(()=>{C&&!r&&!b&&(E(!1),T.current&&clearTimeout(T.current))},[C,r,b]),U.useEffect(()=>{const ne=n.filter(Z=>{if(Z.isPiggybank||Z.isActive===!1)return!1;const ue=(d[c]||[]).some(me=>me.envelopeId===Z.id),ye=e.some(me=>me.envelopeId===Z.id&&(me.month===c||me.date.startsWith(c)));return ue||ye}).sort((Z,oe)=>{const ue=Z.orderIndex??0,ye=oe.orderIndex??0;return ue-ye});N(ne),A.current=ne},[n,d,c,e]);const X=(u[c]||[]).reduce((ne,Z)=>ne+Z.amount,0),K=(d[c]||[]).filter(ne=>O.some(Z=>Z.id===ne.envelopeId)||B.some(Z=>Z.id===ne.envelopeId)).reduce((ne,Z)=>ne+Z.budgetedAmount,0),$=X-K,W=U.useCallback(async ne=>{if(!ne.length)return;const Z=ne.map(oe=>oe.id);try{await a(Z)}catch(oe){console.error("Failed to persist envelope order:",oe),_("Failed to save envelope order","error")}},[a,_]),ee=U.useCallback(async ne=>{await W(ne)},[W]),ie=U.useCallback(ne=>{h(c,ne.id).catch(console.error),_(`Deleted "${ne.name}"`,"neutral")},[h,c,_]),H=U.useCallback(async ne=>{try{const Z=ne||c;console.log(" Copying to month:",Z),await m(Z),_("Previous month budget copied","success")}catch(Z){console.error("Error copying previous month:",Z),_("Failed to copy previous month","error")}},[m,_,c]),F=U.useCallback(async()=>{if(!s||!c){_("Cannot clear data: not logged in or no month selected","error");return}try{await an.getState().clearMonthData(c),_(`"${c}" budget and transactions cleared successfully`,"success")}catch(ne){console.error("Error clearing month data:",ne),_("Failed to clear month data","error")}},[s,c,_]),Y=U.useCallback(async(ne,Z)=>{try{await p(ne,Z),setTimeout(()=>{const oe=an.getState(),ue=oe.currentMonth,ye=oe.incomeSources[ue]||[],me=oe.allocations[ue]||[],Te=new Set(oe.envelopes.filter(Ne=>{if(Ne.isPiggybank){if(!Ne.isActive)return!1;if(Ne.createdAt){const Oe=wN(Ne.createdAt);if(!Oe)return!1;const Ge=`${Oe.getFullYear()}-${String(Oe.getMonth()+1).padStart(2,"0")}`;return ue>=Ge}return!0}return Ne.isActive!==!1}).map(Ne=>Ne.id)),Me=me.filter(Ne=>Te.has(Ne.envelopeId)),ae=ye.reduce((Ne,Oe)=>Ne+Oe.amount,0),Ce=Me.reduce((Ne,Oe)=>Ne+Oe.budgetedAmount,0);ae-Ce<-.005?_(`You can't spend more than you make.
You're not in Congress!`,"error"):Math.abs(ae-Ce)<.005&&ae>0&&_("Every dollar has a job ","success")},100)}catch(oe){console.error("Failed to set allocation:",oe),_("Failed to update budget","error")}},[p,_]);return{visibleEnvelopes:O,piggybanks:B,incomeSources:u,availableToBudget:$,currentMonth:c,allocations:d,transactions:e,isLoading:r,isInitialLoading:j,isOnline:i,showTimeoutMessage:w,getEnvelopeBalance:V,fetchData:t,reorderEnvelopes:ee,deleteIncomeSource:ie,clearMonthData:F,copyFromPreviousMonth:H,setEnvelopeAllocation:Y,localOrderRef:A,setLocalEnvelopes:N,localPiggybankOrderRef:z,setLocalPiggybanks:D}},bne=({currentMonth:n,onMonthChange:e,budgetStatus:t})=>{const[r,i]=n.split("-").map(Number),s=["January","February","March","April","May","June","July","August","September","October","November","December"][i-1],c=()=>{let p=r,m=i-1;m<1&&(p=r-1,m=12);const b=`${p}-${m.toString().padStart(2,"0")}`;e(b)},u=()=>{let p=r,m=i+1;m>12&&(p=r+1,m=1);const b=`${p}-${m.toString().padStart(2,"0")}`;e(b)},d=()=>{const p=new Date,m=`${p.getFullYear()}-${(p.getMonth()+1).toString().padStart(2,"0")}`;e(m)},h=()=>{if(!t)return null;const{amount:p,totalIncome:m,totalAllocated:b}=t,_=typeof p=="number"?p:0,w=typeof m=="number"?m:0,E=typeof b=="number"?b:0,T=Math.abs(_)<.005,C=_<-.005,k=w>0?E/w*100:0;let j="text-gray-900 dark:text-white",P="bg-green-500",N="Left to Budget",A=w>0?Math.min(k,100):0,I=!0;return w===0?(N="Add income to start budgeting",A=0,I=!1,j="text-gray-500 dark:text-zinc-500"):T?(j="text-green-600 dark:text-emerald-400",P="bg-green-500",N="Perfect! Every dollar has a job ",A=100,I=!1):C&&(j="text-red-600 dark:text-red-400",P="bg-red-500",N="You're not in Congress! Try again.",A=100),v.jsxs("div",{className:"flex flex-col justify-center min-w-0 w-full",children:[v.jsxs("div",{className:"flex items-baseline justify-start mb-1",children:[v.jsx("span",{className:`text-xs font-medium truncate mr-1.5 ${j}`,children:N}),I&&v.jsxs("span",{className:`text-sm font-bold truncate ${j}`,children:[C?"-":"","$",Math.abs(_).toFixed(2)]})]}),v.jsx("div",{className:"w-full h-1.5 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:v.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${P}`,style:{width:`${A}%`}})})]})};return v.jsxs("div",{className:"py-2 space-y-3",children:[v.jsxs("div",{className:"flex items-center justify-center gap-4",children:[v.jsx("button",{onClick:c,className:"p-1.5 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Previous month",children:v.jsx(cF,{size:20})}),v.jsx("div",{className:"text-center",children:v.jsxs("button",{onClick:d,className:"text-base font-semibold text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors whitespace-nowrap",title:"Click to go to current month",children:[s," ",r]})}),v.jsx("button",{onClick:u,className:"p-1.5 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Next month",children:v.jsx(Da,{size:20})})]}),t&&v.jsx("div",{className:"px-1",children:h()})]})},My=({children:n,onDelete:e,threshold:t=-100,disabled:r=!1})=>{const i=$W(),[a,s]=U.useState(!1),c=U.useRef(0),u=()=>{r||(s(!0),c.current=Date.now())},d=async(h,p)=>{if(r)return;const m=p.offset.x,b=p.velocity.x;if(setTimeout(()=>s(!1),100),m<t||m<-50&&b<-500){const _=e();_===!1?i.start({x:0}):_ instanceof Promise&&_.then(w=>{w===!1&&i.start({x:0})})}else i.start({x:0})};return v.jsxs("div",{className:"relative w-full overflow-hidden mb-2 rounded-xl group",children:[v.jsx("div",{className:"absolute inset-0 bg-red-500 flex items-center justify-end pr-6 rounded-xl",children:v.jsx($0,{className:"text-white w-6 h-6"})}),v.jsx(_n.div,{drag:r?!1:"x",dragConstraints:{left:-500,right:0},dragElastic:.1,onDragStart:u,onDragEnd:d,animate:i,className:`relative bg-white dark:bg-zinc-900 rounded-xl ${a?"z-20":"z-10"}`,style:{touchAction:"pan-y",pointerEvents:a?"none":"auto"},children:n})]})},xne=({isVisible:n,onClose:e,mode:t,initialIncomeSource:r})=>{const{addIncomeSource:i,updateIncomeSource:a,currentMonth:s}=an(),{showToast:c}=Vc(),[u,d]=U.useState(""),[h,p]=U.useState(""),[m,b]=U.useState(!1);U.useEffect(()=>{if(!n)return;const w=window.setTimeout(()=>{t==="edit"&&r?(d(r.name),p(r.amount.toString())):(d(""),p(""))},0);return()=>window.clearTimeout(w)},[n,t,r]);const _=async w=>{if(w.preventDefault(),!u.trim()||!h||parseFloat(h)<=0){c("Please fill in all required fields with valid values","error");return}b(!0);try{if(t==="add")await i(s,{name:u.trim(),amount:parseFloat(h),month:s,userId:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),c("Income source added successfully","success");else{if(!r){c("Error: No income source to edit","error");return}await a(s,{...r,name:u.trim(),amount:parseFloat(h),updatedAt:new Date().toISOString()}),c(`Updated "${u.trim()}" income source`,"success")}e()}catch(E){console.error("Error saving income source:",E),c("Failed to save income source. Please try again.","error")}finally{b(!1)}};return v.jsx(di,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(_n.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black bg-opacity-50"}),v.jsxs(_n.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:t==="add"?"Add Income Source":"Edit Income Source"}),v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",children:""})]}),v.jsxs("form",{onSubmit:_,className:"p-6 space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Income Source Name *"}),v.jsx("input",{type:"text",value:u,onChange:w=>d(w.target.value),placeholder:"e.g., Primary Job, Freelance, Investments",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Amount *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-zinc-400",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:h,onChange:w=>{const E=w.target.value.replace(/\D/g,"");if(!E){p("");return}const C=(parseInt(E,10)/100).toFixed(2);p(C)},placeholder:"0.00",className:"w-full pl-8 pr-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"submit",disabled:m||!u.trim()||!h||parseFloat(h)<=0,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m?"Saving...":t==="add"?"Add Income":"Save Changes"})]})]})]})]})})},_ne=({currentMonth:n,onCopy:e,isLoading:t=!1})=>{const r=c=>{const[u,d]=c.split("-");return new Date(parseInt(u),parseInt(d)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},i=c=>{const[u,d]=c.split("-").map(Number);let h=u,p=d-1;return p<1&&(h=u-1,p=12),r(`${h}-${p.toString().padStart(2,"0")}`)},a=r(n),s=i(n);return v.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6 py-12 space-y-6 animate-in fade-in zoom-in-95 duration-300",children:[v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-0 bg-blue-100 dark:bg-blue-900/30 blur-2xl rounded-full opacity-50"}),v.jsxs("div",{className:"relative bg-white dark:bg-zinc-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-700",children:[v.jsx(tF,{className:"w-12 h-12 text-blue-500"}),v.jsx("div",{className:"absolute -top-2 -right-2 bg-blue-500 text-white p-1.5 rounded-full border-2 border-white dark:border-zinc-900",children:v.jsx(Xh,{size:14})})]})]}),v.jsxs("div",{className:"max-w-xs mx-auto space-y-2",children:[v.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["It looks like you need a budget for ",a]}),v.jsxs("p",{className:"text-gray-500 dark:text-zinc-400",children:["We can copy your budget from ",s," to get you started right away."]})]}),v.jsx("div",{className:"w-full max-w-xs space-y-3 pt-2",children:v.jsx("button",{onClick:e,disabled:t,className:"w-full py-3.5 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-sm transition-all active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:t?"Creating...":v.jsx(v.Fragment,{children:v.jsxs("span",{children:["Create ",a," Budget"]})})})})]})},wne="/personal-budget-pwa/icon-512.png",z1="/personal-budget-pwa/images/budget-balanced.png",SN=["Giving","Savings","Housing","Transportation","Food","Personal","Health","Insurance","Debt"],Sne=({currentMonth:n,onComplete:e})=>{const[t,r]=U.useState(0),[i,a]=U.useState(0),[s,c]=U.useState(2500),[u,d]=U.useState(SN),{addCategory:h}=an(),p=N=>{d(A=>A.includes(N)?A.filter(I=>I!==N):[...A,N])},m=async()=>{for(let N=0;N<u.length;N++)await h({name:u[N],orderIndex:N,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()});e()};U.useEffect(()=>{if(console.log("Animation effect triggered:",{currentStep:t,animationKey:i}),t===5){console.log("Starting animation from $2500 to $0"),c(2500);const N=2e3,A=20,I=N/A,D=2500/A;let z=0;const V=setInterval(()=>{z++;const B=Math.max(0,2500-D*z);console.log("Phase 1 - Animation step:",z,"New amount:",B),c(B),z>=A&&(clearInterval(V),console.log("Phase 1 completed - Perfect budget reached"),setTimeout(()=>{console.log("Starting Phase 2 - Over budget demonstration");let O=0;const X=10,K=200,$=500/X,W=setInterval(()=>{O++;const ee=-($*O);console.log("Phase 2 - Over budget step:",O,"Over budget amount:",ee),c(ee),O>=X&&(clearInterval(W),console.log("Animation completed - Over budget scenario demonstrated"))},K)},1e3))},I);return()=>{console.log("Cleaning up animation timers"),clearInterval(V)}}},[i,t]);const _=(N=>{const[A,I]=N.split("-");return new Date(parseInt(A),parseInt(I)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})})(n),w=[{icon:Xh,title:"Welcome to Dollars At Work!",description:`Let's set up your budget for ${_}`,content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["Dollars At Work helps you take control of your money using the ",v.jsx("strong",{children:"zero-based budgeting"})," method."]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Every dollar gets a job, and you'll know exactly where your money is going."}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4",children:v.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-200 font-medium",children:" This quick guide will show you how to get started in just a few steps!"})})]}),color:"blue"},{icon:t7,title:"Step 1: Choose Categories",description:"Select categories to organize your spending",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Categories help group your envelopes. Select the ones you need:"}),v.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-60 overflow-y-auto pr-1",children:SN.map(N=>v.jsxs("button",{onClick:()=>p(N),className:`p-3 rounded-xl border text-sm font-medium transition-all flex items-center gap-2 ${u.includes(N)?"bg-blue-50 border-blue-200 text-blue-700 dark:bg-blue-900/30 dark:border-blue-800 dark:text-blue-300":"bg-white border-gray-200 text-gray-600 dark:bg-zinc-800 dark:border-zinc-700 dark:text-zinc-400"}`,children:[v.jsx("div",{className:`w-4 h-4 rounded-full border flex items-center justify-center ${u.includes(N)?"border-blue-500 bg-blue-500":"border-gray-400"}`,children:u.includes(N)&&v.jsx(ws,{size:12,className:"text-white"})}),N]},N))}),u.length===0&&v.jsx("p",{className:"text-red-500 text-xs",children:"Please select at least one category."})]}),color:"blue"},{icon:D2,title:"Step 2: Add Your Income",description:"Tell us how much money you have to work with",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"First, you'll add your income sources for the month. This could be:"}),v.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-zinc-400",children:[v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ws,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Salary"})," - Your regular paycheck"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ws,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Freelance"})," - Side gig income"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ws,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Other Income"})," - Any other money coming in"]})]})]}),v.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-green-900 dark:text-green-200",children:[v.jsx("strong",{children:'Look for the "Income Sources" section'})," at the top of your budget and tap the ",v.jsx(Op,{className:"w-4 h-4 inline"})," button to add income."]})})]}),color:"green"},{icon:Bv,title:"Step 3: Create Spending Envelopes",description:"Organize your spending into categories",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Spending envelopes are where you track expenses. You'll assign each envelope to a category."}),v.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-zinc-400",children:[v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ws,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Groceries"})," (Food)"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ws,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Rent/Mortgage"})," (Housing)"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ws,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Gas"})," (Transportation)"]})]})]}),v.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-purple-900 dark:text-purple-200",children:[v.jsx("strong",{children:'Tap "+" on a category section'})," to add an envelope to it."]})})]}),color:"purple"},{icon:Yh,title:"Step 4: Organize Your Budget",description:"Reorder categories and envelopes to match your preferences",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["Your budget should work the way ",v.jsx("strong",{children:"you"})," think about money. Customize the order to match your priorities!"]}),v.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-200 dark:border-indigo-800 rounded-xl p-4",children:[v.jsxs("h4",{className:"font-medium text-indigo-900 dark:text-indigo-200 mb-3 flex items-center gap-2",children:[v.jsx(Yh,{className:"w-4 h-4"}),"Drag to Reorder"]}),v.jsx("p",{className:"text-sm text-indigo-800 dark:text-indigo-300 mb-3",children:"Both categories and envelopes can be reordered the same way:"}),v.jsxs("div",{className:"space-y-2 mb-3",children:[v.jsxs("p",{className:"text-sm text-indigo-800 dark:text-indigo-300",children:[v.jsx("strong",{children:"Mobile:"})," Long-press and drag"]}),v.jsxs("p",{className:"text-sm text-indigo-800 dark:text-indigo-300",children:[v.jsx("strong",{children:"PC:"})," Click and hold on the ",v.jsx("strong",{children:""})," dots, then drag"]})]}),v.jsxs("div",{className:"bg-white dark:bg-indigo-950/30 rounded-lg p-3 mb-3 border border-indigo-300 dark:border-indigo-700",children:[v.jsxs("div",{className:"flex items-center gap-2 text-xs mb-2",children:[v.jsx("div",{className:"text-indigo-600 dark:text-indigo-400 font-bold",children:""}),v.jsxs("div",{className:"flex-1",children:[v.jsx("div",{className:"font-medium text-indigo-900 dark:text-indigo-200",children:"Food"}),v.jsx("div",{className:"text-indigo-700 dark:text-indigo-400 text-xs",children:"Category"})]})]}),v.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[v.jsx("div",{className:"text-indigo-600 dark:text-indigo-400 font-bold",children:""}),v.jsxs("div",{className:"flex-1",children:[v.jsx("div",{className:"font-medium text-indigo-900 dark:text-indigo-200",children:"Groceries"}),v.jsx("div",{className:"text-indigo-700 dark:text-indigo-400 text-xs",children:"$450 / $500"})]})]}),v.jsx("p",{className:"text-xs text-indigo-600 dark:text-indigo-400 mt-2 italic",children:" Click and hold these dots to drag"})]}),v.jsxs("ul",{className:"space-y-1 text-sm text-indigo-700 dark:text-indigo-400",children:[v.jsx("li",{children:" Reorder categories: Settings  Manage Categories"}),v.jsx("li",{children:" Reorder envelopes: On the main budget screen"}),v.jsx("li",{children:" Organize by priority, frequency, or preference"})]})]}),v.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-amber-900 dark:text-amber-200",children:[" ",v.jsx("strong",{children:"Pro tip:"})," Try organizing your budget like this: Income  Fixed Expenses  Variable Expenses  Savings Goals"]})})]}),color:"indigo"},{icon:H0,title:"Step 5: Allocate Your Budget",description:"Assign money to each envelope",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Now comes the fun part - giving every dollar a job!"}),v.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500 rounded-r-xl p-4 relative",children:[v.jsx("button",{onClick:()=>a(N=>N+1),className:"absolute top-2 right-2 p-1.5 text-blue-600 dark:text-blue-400 hover:bg-blue-100 dark:hover:bg-blue-800 rounded-lg transition-colors",title:"Replay animation",children:v.jsx(KF,{className:"w-4 h-4"})}),v.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-200 font-medium mb-2",children:'The "Left to Budget" amount shows unassigned money'}),v.jsxs("p",{className:"text-sm text-blue-900 dark:text-blue-200 mb-3",children:["Your goal is to get this to ",v.jsx("strong",{children:"$0.00"})," by allocating all your income to envelopes."]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex justify-between text-xs text-blue-700 dark:text-blue-300 font-medium",children:[v.jsx("span",{children:"Left to Budget"}),v.jsxs("span",{className:`font-bold ${s<0?"text-red-600 dark:text-red-400":""}`,children:["$",s.toFixed(2)]})]}),v.jsx("div",{className:"w-full bg-blue-200 dark:bg-blue-800 rounded-full h-2 overflow-hidden",children:v.jsx(_n.div,{className:`h-full rounded-full ${s<0?"bg-red-500":"bg-green-500"}`,initial:{width:"0%"},animate:{width:s<0?"100%":`${(2500-s)/2500*100}%`},transition:{duration:.3,ease:"easeInOut"}})}),v.jsxs(_n.div,{className:`text-xs font-medium text-center mt-1 ${s===0?"text-green-600 dark:text-emerald-400":s<0?"text-red-600 dark:text-red-400":"text-blue-700 dark:text-blue-300"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:2,duration:.5},children:[s===0&&"Perfect! Every dollar has a job ",s<0&&"You're not in Congress! Try again.",s>0&&"Keep allocating until you reach $0"]})]},i)]}),v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:[v.jsx("strong",{children:"To allocate money:"})," Tap the budget amount on any envelope and enter how much you want to assign to it."]}),v.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-amber-900 dark:text-amber-200",children:[" ",v.jsx("strong",{children:"Pro tip:"})," Start with your essential expenses (rent, utilities, groceries) first, then allocate what's left to other categories."]})})]}),color:"blue"},{icon:Pp,title:"Bonus: Piggybanks (Savings Goals)",description:"Save for future goals",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["Piggybanks are special envelopes for ",v.jsx("strong",{children:"savings goals"})," that carry over month-to-month."]}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(r7,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Set a Goal"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Vacation, emergency fund, new car - whatever you're saving for"})]})]}),v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(D2,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Monthly Contributions"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Set an automatic monthly amount to save"})]})]}),v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(H0,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Track Progress"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Watch your savings grow toward your goal"})]})]})]}),v.jsx("div",{className:"bg-pink-50 dark:bg-pink-900/20 border border-pink-200 dark:border-pink-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-pink-900 dark:text-pink-200",children:[v.jsx("strong",{children:"Find Piggybanks"})," at the bottom of your budget. They're optional but powerful for reaching your goals!"]})})]}),color:"pink"},{icon:z1,title:"You're Ready to Budget!",description:"Start taking control of your money",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"That's it! You now know the basics of Dollars At Work:"}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"1"})}),v.jsx("span",{children:"Choose your categories"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"2"})}),v.jsx("span",{children:"Add your income sources"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"3"})}),v.jsx("span",{children:"Create envelopes in categories"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"4"})}),v.jsx("span",{children:"Organize your budget order"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"5"})}),v.jsx("span",{children:"Allocate until Left to Budget = $0"})]})]}),v.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4 mt-6",children:v.jsx("p",{className:"text-sm text-center text-blue-900 dark:text-blue-200 font-medium",children:' Click "Start Budgeting" below to create your first budget!'})})]}),color:"green",useCustomIcon:!0}],E=w[t],T=E.useCustomIcon?z1:E.icon,C=t===w.length-1,k=t===0,P={blue:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-600 dark:text-blue-400",button:"bg-blue-600 hover:bg-blue-700"},green:{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-600 dark:text-green-400",button:"bg-green-600 hover:bg-green-700"},purple:{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-600 dark:text-purple-400",button:"bg-purple-600 hover:bg-purple-700"},indigo:{bg:"bg-indigo-100 dark:bg-indigo-900/30",text:"text-indigo-600 dark:text-indigo-400",button:"bg-indigo-600 hover:bg-indigo-700"},pink:{bg:"bg-pink-100 dark:bg-pink-900/30",text:"text-pink-600 dark:text-pink-400",button:"bg-pink-600 hover:bg-pink-700"}}[E.color];return v.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex items-center justify-center p-4",children:v.jsx("div",{className:"w-full max-w-2xl",children:v.jsx(di,{mode:"wait",children:v.jsxs(_n.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-xl border border-gray-200 dark:border-zinc-800 overflow-hidden",children:[v.jsx("div",{className:"p-6 pb-2",children:v.jsxs("div",{className:"flex items-center justify-between mb-4",children:[v.jsxs("div",{className:"flex-1",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:E.title}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:E.description})]}),v.jsx("div",{className:"flex flex-col items-center mx-4",children:t===0?v.jsx("img",{src:wne,alt:"Dollars At Work",className:`w-20 h-20 ${P.text}`}):E.useCustomIcon?v.jsx("img",{src:z1,alt:"Budget Balanced",className:`w-32 h-32 ${P.text}`}):v.jsx("div",{className:`${P.bg} p-3 rounded-xl`,children:v.jsx(T,{className:`w-8 h-8 ${P.text}`})})}),v.jsxs("div",{className:"text-sm text-gray-500 dark:text-zinc-400 whitespace-nowrap",children:["Step ",t+1," of ",w.length]})]})}),v.jsx("div",{className:"px-6 pb-6 pt-2",children:E.content}),v.jsx("div",{className:"px-6 pb-4 flex justify-center gap-2",children:w.map((N,A)=>v.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${A===t?`w-8 ${P.button}`:A<t?"w-2 bg-gray-400 dark:bg-zinc-600":"w-2 bg-gray-200 dark:bg-zinc-700"}`},A))}),v.jsxs("div",{className:"p-6 pt-0 flex gap-3",children:[!k&&v.jsxs("button",{onClick:()=>r(N=>N-1),className:"flex-1 py-3 px-4 border border-gray-300 dark:border-zinc-700 text-gray-700 dark:text-zinc-300 rounded-xl font-medium hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors flex items-center justify-center gap-2",children:[v.jsx(Jo,{className:"w-5 h-5"}),"Back"]}),v.jsx("button",{onClick:()=>{if(C)m();else{if(E.title.includes("Choose Categories")&&u.length===0)return;r(N=>N+1)}},disabled:E.title.includes("Choose Categories")&&u.length===0,className:`${k?"flex-1":"flex-[2]"} py-3 px-4 ${P.button} text-white rounded-xl font-semibold transition-all active:scale-[0.98] flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed`,children:C?v.jsxs(v.Fragment,{children:[v.jsx(Xh,{className:"w-5 h-5"}),"Start Budgeting"]}):v.jsxs(v.Fragment,{children:["Next",v.jsx(JU,{className:"w-5 h-5"})]})})]})]},t)})})})},Ene=({piggybank:n,balance:e,onNavigate:t,setMoveableRef:r,isReorderingActive:i,activelyDraggingId:a,onItemDragStart:s,onLongPressTrigger:c})=>{const u=U.useRef(null),[d,h]=U.useState(!1),p=uT(D=>{JV(),c(D,n.id)},{threshold:500,cancelOnMovement:25,detect:Fo.Touch}),m=n.piggybankConfig?.targetAmount,b=n.piggybankConfig?.monthlyContribution??0,_=n.piggybankConfig?.color||"#3B82F6",w=n.piggybankConfig?.paused||!1,E=typeof e=="number"?e:e.toNumber(),T=(D,z=1)=>{const V=D.replace("#",""),B=parseInt(V,16),O=B>>16&255,X=B>>8&255,K=B&255;return`rgba(${O}, ${X}, ${K}, ${z})`},C=`linear-gradient(135deg, ${T(_,.14)} 0%, ${T(_,.05)} 100%)`,k=T(_,.4),j=m&&m>0?Math.min(E/m*100,100):0,P=m&&E>=m;U.useEffect(()=>{a&&a!==n.id&&h(!1)},[a,n.id]),U.useEffect(()=>{a===n.id&&(h(!0),s&&s(n.id))},[a,n.id,s]),U.useEffect(()=>{if(!a&&d){const D=setTimeout(()=>{h(!1)},300);return()=>clearTimeout(D)}},[a,d]);const N=D=>{if(d||i){D.preventDefault(),D.stopPropagation();return}t(n.id)},A=a===n.id,I=v.jsxs("div",{className:"flex items-center gap-3 w-full",children:[v.jsx("div",{className:"hidden md:flex items-center justify-center p-1 text-gray-400 opacity-0 group-hover:opacity-100 cursor-grab active:cursor-grabbing transition-all duration-200",onMouseDown:D=>c(D,n.id),children:v.jsx(Yh,{size:20})}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsxs("div",{className:"flex items-center justify-between gap-3 mb-1",children:[v.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[v.jsx("div",{className:"w-6 h-6 rounded-full flex-shrink-0 flex items-center justify-center",style:{backgroundColor:`${_}20`},children:v.jsx(Pp,{size:12,style:{color:_}})}),v.jsxs("div",{className:"min-w-0",children:[v.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white truncate leading-tight",children:n.name}),v.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[v.jsx(H0,{size:10,style:{color:_}}),v.jsxs("span",{className:"text-[10px] text-gray-500 dark:text-zinc-400 font-medium",children:["$",b.toFixed(2),"/mo"]}),w&&v.jsxs("span",{className:"text-[9px] text-orange-600 dark:text-orange-400 font-bold ml-1 flex items-center gap-0.5",children:[v.jsx(UF,{size:8})," PAUSED"]})]})]})]}),v.jsxs("div",{className:"text-right flex-shrink-0",children:[v.jsxs("div",{className:"text-sm font-bold text-gray-900 dark:text-white leading-none",children:["$",E.toFixed(2)]}),v.jsxs("div",{className:"text-[9px] text-gray-400 dark:text-zinc-500 mt-1",children:["of $",m?.toFixed(0)||"0"]})]})]}),m&&m>0&&v.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-800/50 rounded-full h-0.5 overflow-hidden",children:v.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${j}%`,backgroundColor:_}})}),P&&!m&&v.jsx("div",{className:"text-[9px] text-green-600 dark:text-green-400 font-bold mt-0.5",children:" GOAL REACHED"})]})]});return v.jsx(_n.div,{...p(),layout:!A,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},ref:D=>{r&&r(D),u.current=D},onClick:N,style:{background:C,borderColor:k,boxShadow:A?"0 18px 45px rgba(15,23,42,0.35)":"0 1px 2px rgba(15,23,42,0.08)",zIndex:A?50:1,scale:A?1.02:1},className:"rounded-xl py-1.5 px-3 border transition-all cursor-pointer shadow-sm hover:shadow-md select-none active:scale-[0.99] group",children:I})},lh=(n,e=1)=>{const t=n.replace("#",""),r=parseInt(t,16),i=r>>16&255,a=r>>8&255,s=r&255;return`rgba(${i}, ${a}, ${s}, ${e})`},Tne=12,Ane=(n,e,t)=>Math.min(Math.max(n,e),t),Cne=({env:n,budgetedAmount:e,remainingBalance:t,navigate:r,transactions:i,currentMonth:a,setMoveableRef:s,isReorderingActive:c,activelyDraggingId:u,onItemDragStart:d,onLongPressTrigger:h})=>{const p=!!n.isPiggybank,m=n.piggybankConfig?.color||"#3B82F6",b=p?`linear-gradient(135deg, ${lh(m,.18)} 0%, ${lh(m,.08)} 100%)`:void 0,_=p?lh(m,.5):void 0,[w,E]=U.useState(!1),T=uT(V=>{JV(),h(V,n.id)},{threshold:500,cancelOnMovement:25,detect:Fo.Touch}),C=i.filter(V=>V.envelopeId===n.id&&V.month===a),k=C.filter(V=>V.type==="Expense"),j=C.filter(V=>V.type==="Income"),P=k.reduce((V,B)=>V+(B.amount||0),0),N=j.reduce((V,B)=>V+(B.amount||0),0),A=N>0?Math.max(0,P/N*100):0,I=V=>{if(w||c){V.preventDefault(),V.stopPropagation();return}r(`/envelope/${n.id}`)};U.useEffect(()=>{u&&u!==n.id&&E(!1)},[u,n.id]),U.useEffect(()=>{u===n.id&&(E(!0),d(n.id))},[u,n.id,d]),U.useEffect(()=>{if(!u&&w){const V=setTimeout(()=>{E(!1)},300);return()=>clearTimeout(V)}},[u,w]);const D=v.jsxs("div",{className:"flex items-center gap-3 w-full",children:[v.jsx("div",{className:"hidden md:flex items-center justify-center p-1 text-gray-400 opacity-0 group-hover:opacity-100 cursor-grab active:cursor-grabbing transition-all duration-200",onMouseDown:V=>h(V,n.id),children:v.jsx(Yh,{size:20})}),v.jsxs("div",{className:"flex-1",children:[v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[p&&v.jsx("span",{className:"w-5 h-5 rounded-full flex items-center justify-center border",style:{borderColor:lh(m,.4),backgroundColor:lh(m,.15),color:m},children:v.jsx(Pp,{size:10})}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white leading-tight",children:n.name}),v.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[v.jsx("span",{className:"text-[10px] text-gray-500 dark:text-zinc-400",children:"Budgeted:"}),v.jsxs("span",{className:"text-[10px] font-medium text-gray-700 dark:text-zinc-300",children:["$",e.toFixed(2)]})]})]})]}),v.jsxs("div",{className:"text-right",children:[v.jsxs("span",{className:`text-sm font-bold leading-none ${(typeof t=="number"?t:t.toNumber())<0||100-A<=5?"text-red-500":A>=80?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-emerald-400"}`,children:["$",(typeof t=="number"?t:t.toNumber()).toFixed(2)]}),v.jsx("span",{className:"text-[9px] text-gray-400 dark:text-zinc-500 block uppercase tracking-wider mt-0.5",children:"Remaining"})]})]}),e>0&&v.jsx("div",{className:"mt-1",children:v.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-700/50 rounded-full h-0.5 overflow-hidden",children:v.jsx("div",{className:`h-full transition-all duration-300 ease-out ${(typeof t=="number"?t:t.toNumber())<0||100-A<=5?"bg-red-500":A>=80?"bg-yellow-500":"bg-green-400"}`,style:{width:`${Math.max(100-A,2)}%`}})})})]})]}),z=u===n.id;return v.jsx(_n.div,{...T(),layout:!z,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},"data-envelope-id":n.id,ref:s(n.id),onClick:I,style:{boxShadow:z?"0 18px 45px rgba(15,23,42,0.35)":"0 1px 2px rgba(15,23,42,0.08)",background:b,borderColor:_,cursor:z?"grabbing":"pointer",zIndex:z?50:1,scale:z?1.02:1},className:`py-1.5 px-3 rounded-xl active:scale-[0.99] transition-all select-none border group ${p?"bg-white/70 dark:bg-zinc-800/80":"bg-gray-50 dark:bg-zinc-800 border-transparent"}`,children:D})},EN=({category:n,envelopes:e,allocations:t,currentMonth:r,transactions:i,navigate:a,getEnvelopeBalance:s,onReorderGlobal:c})=>{if(e.length===0&&n.id==="uncategorized")return null;const[u,d]=U.useState(e),h=U.useRef(e),[p,m]=U.useState(!1),[b,_]=U.useState(null),w=U.useRef(!1),E=U.useRef(null),T=U.useRef({}),C=U.useRef({}),k=U.useRef({activeId:null,startIndex:0,currentIndex:0,itemHeight:0});U.useEffect(()=>{p||(d(e),h.current=e)},[e,p]);const j=U.useCallback((N,A)=>{const I=C.current[A];if(I){w.current=!0;const D=N.nativeEvent||N;I.dragStart(D)}},[]),P=U.useCallback(N=>A=>{A?T.current[N]=A:delete T.current[N]},[]);return U.useEffect(()=>{const N=()=>{Object.values(C.current).forEach(D=>D?.destroy()),C.current={}};if(!u.length)return;const A=()=>{u.forEach(D=>{const z=T.current[D.id];if(!z||!E.current)return;const V=new QV(E.current,{target:z,draggable:!0,throttleDrag:0,snappable:!0,snapThreshold:5,snapDirections:{top:!0,bottom:!0},elementSnapDirections:{top:!0,bottom:!0},clickable:!0,dragArea:!1,hideDefaultLines:!0,renderDirections:[]});V.on("dragStart",O=>{if(!w.current){O.stop();return}const X=O.inputEvent.target;if(X.closest(".js-budget-target")||X.tagName==="INPUT"){O.stop();return}const K=h.current.findIndex(ee=>ee.id===D.id),$=O.target,W=$.getBoundingClientRect();_(D.id),k.current={activeId:D.id,startIndex:K,currentIndex:K,itemHeight:W.height+Tne},$.style.transition="none",$.style.boxShadow="0 18px 45px rgba(15,23,42,0.35)",$.style.zIndex="20",m(!0)});let B=null;V.on("drag",O=>{const X=O.target;B!==null&&cancelAnimationFrame(B),B=requestAnimationFrame(()=>{const K=k.current;if(K.activeId!==D.id)return;const $=O.beforeTranslate[1];X.style.transform=`translateY(${$}px)`,X.style.transition="none";const{itemHeight:W,startIndex:ee}=K,ie=Math.round($/W),H=Ane(ee+ie,0,h.current.length-1);H!==K.currentIndex&&(K.currentIndex=H,h.current.forEach((F,Y)=>{if(F.id===D.id)return;const ne=T.current[F.id];if(!ne)return;let Z=0;ee<H&&Y>ee&&Y<=H?Z=-W:ee>H&&Y>=H&&Y<ee&&(Z=W),ne.style.transform=Z?`translateY(${Z}px)`:"",ne.style.transition="transform 0.2s ease"})),B=null})}),V.on("dragEnd",O=>{B!==null&&(cancelAnimationFrame(B),B=null);const X=O.target,{startIndex:K,currentIndex:$}=k.current;if(X.style.transform="",X.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease",X.style.boxShadow="",h.current.forEach(W=>{const ee=T.current[W.id];ee&&(ee.style.transform="",ee.style.transition="")}),K!==$){const W=[...h.current],[ee]=W.splice(K,1);W.splice($,0,ee),h.current=W,d(W),c(W.map(ie=>ie.id))}setTimeout(()=>{X.style.zIndex="",_(null),m(!1),w.current=!1},300)}),V.on("click",()=>{const O=window.event?.target;O&&(O.closest(".js-budget-target")||O.tagName==="INPUT")||a(`/envelope/${D.id}`)}),C.current[D.id]=V})},I=window.setTimeout(A,80);return()=>{clearTimeout(I),N()}},[u,a,c]),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-3 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-2 px-1",children:[v.jsx("h2",{className:"text-base font-bold text-gray-900 dark:text-white flex items-center gap-2",children:n.name}),v.jsx("button",{onClick:()=>a(n.id==="uncategorized"?"/add-envelope":`/add-envelope?categoryId=${n.id}`),className:"text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 p-1 rounded-full transition-colors",title:`Add to ${n.name}`,children:v.jsx(Op,{size:20})})]}),v.jsx("div",{ref:E,className:"space-y-2 relative",children:u.length===0?v.jsx("div",{className:"py-2 text-center border border-dashed border-gray-100 dark:border-zinc-800 rounded-xl",children:v.jsx("p",{className:"text-[10px] text-gray-400 dark:text-zinc-500",children:"Empty category"})}):v.jsx(di,{initial:!1,children:u.map(N=>{const I=(t[r]||[]).find(z=>z.envelopeId===N.id)?.budgetedAmount||0,D=s(N.id);return N.isPiggybank?v.jsx(Ene,{piggybank:N,balance:D,onNavigate:z=>a(`/envelope/${z}`),setMoveableRef:P(N.id),isReorderingActive:p,activelyDraggingId:b,onItemDragStart:()=>{},onLongPressTrigger:j},N.id):v.jsx(Cne,{env:N,budgetedAmount:I,remainingBalance:D,navigate:a,transactions:i,currentMonth:r,setMoveableRef:P,isReorderingActive:p,activelyDraggingId:b,onItemDragStart:()=>{},onLongPressTrigger:j},N.id)})})})]})},Ine=()=>{const{visibleEnvelopes:n,piggybanks:e,incomeSources:t,availableToBudget:r,currentMonth:i,allocations:a,transactions:s,isLoading:c,isInitialLoading:u,showTimeoutMessage:d,getEnvelopeBalance:h,deleteIncomeSource:p}=yne(),{setMonth:m,setIsOnboardingActive:b,isOnboardingActive:_,isOnboardingCompleted:w,completeOnboarding:E,categories:T,fetchCategories:C,envelopes:k,reorderEnvelopes:j}=an(),P=Za(),[N,A]=U.useState(!1),[I,D]=U.useState("add"),[z,V]=U.useState(null),[B,O]=U.useState(!1),[X,K]=U.useState(!1),$=U.useRef(null),W=U.useRef(null),[ee,ie]=U.useState(0);U.useEffect(()=>{T.length===0&&C()},[T.length,C]);const H=U.useMemo(()=>{const me={},Te=[];return T.forEach(ae=>me[ae.id]=[]),[...n,...e].sort((ae,Ce)=>(ae.orderIndex??0)-(Ce.orderIndex??0)).forEach(ae=>{ae.categoryId&&me[ae.categoryId]?me[ae.categoryId].push(ae):Te.push(ae)}),{groups:me,uncategorized:Te}},[T,n,e]),F=U.useCallback(async me=>{const Te=[...k.map(Ne=>Ne.id)],Me=new Set(me),ae=[];let Ce=0;Te.forEach(Ne=>{Me.has(Ne)?ae.push(me[Ce++]):ae.push(Ne)}),await j(ae)},[k,j]);U.useLayoutEffect(()=>{if(_)return;const me=W.current;if(!me)return;const Te=()=>ie(me.getBoundingClientRect().height);Te();const Me=new ResizeObserver(()=>Te());return Me.observe(me),window.addEventListener("resize",Te),()=>{window.removeEventListener("resize",Te),Me.disconnect()}},[_,i,t,a,n,e,r]),U.useEffect(()=>{if(!u&&!c){const me=setTimeout(()=>{if(_)return;if(w){b(!1);const ae=(t[i]||[]).length===0&&(a[i]||[]).length===0,Ce=Object.keys(t).some(Ne=>(t[Ne]||[]).length>0)||Object.keys(a).some(Ne=>(a[Ne]||[]).length>0);K(!!(ae&&Ce));return}const Te=(t[i]||[]).length===0&&(a[i]||[]).length===0,Me=Object.keys(t).some(ae=>(t[ae]||[]).length>0)||Object.keys(a).some(ae=>(a[ae]||[]).length>0);Te?Me?(K(!0),b(!1)):(b(!0),K(!1)):(K(!1),b(!1))},500);return()=>clearTimeout(me)}},[u,c,i,t,a,w]);const Y=()=>{D("add"),V(null),A(!0)},ne=me=>{$.current&&clearTimeout($.current),!B&&(D("edit"),V(me),A(!0))},Z=me=>{$.current&&clearTimeout($.current),O(!0),p(me),setTimeout(()=>O(!1),500)},oe=()=>{A(!1),V(null)},ue=async()=>{K(!1);const{copyPreviousMonthAllocations:me}=an.getState();await me(i)},ye=()=>{E(),b(!1)};return u?v.jsx(x4,{message:d?"Still loading...":"Loading your budget...",showTimeout:d}):v.jsxs(v.Fragment,{children:[v.jsx("style",{dangerouslySetInnerHTML:{__html:".moveable-control, .moveable-origin, .moveable-line { display: none !important; }"}}),v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-20",children:[!_&&v.jsx("header",{ref:W,className:"fixed top-0 left-0 right-0 z-50 bg-white dark:bg-zinc-900 border-b border-gray-100 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+4px)] pb-1",children:v.jsx(bne,{currentMonth:i,onMonthChange:me=>{K(!1),m(me)},budgetStatus:{amount:r,totalIncome:(t[i]||[]).reduce((me,Te)=>me+Te.amount,0),totalAllocated:(a[i]||[]).filter(me=>n.some(Te=>Te.id===me.envelopeId)||e.some(Te=>Te.id===me.envelopeId)).reduce((me,Te)=>me+Te.budgetedAmount,0)}})}),v.jsxs("div",{className:"pb-[calc(8rem+env(safe-area-inset-bottom))] px-4 max-w-4xl mx-auto space-y-4",style:_?void 0:{paddingTop:Math.max(0,ee+16)},children:[_?v.jsx(Sne,{currentMonth:i,onComplete:ye}):X?v.jsx(_ne,{currentMonth:i,onCopy:ue}):v.jsxs(v.Fragment,{children:[v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-3 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-2 px-1",children:[v.jsx("h2",{className:"text-base font-bold text-gray-900 dark:text-white",children:"Income Sources"}),v.jsx("button",{onClick:Y,className:"text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 p-1 rounded-full transition-colors",children:v.jsx(Op,{size:20})})]}),(t[i]||[]).length===0?v.jsx("div",{className:"text-center py-4",children:v.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-[10px]",children:"No income sources yet."})}):v.jsx("div",{className:"space-y-2",children:v.jsx(di,{initial:!1,mode:"popLayout",children:(t[i]||[]).map(me=>v.jsx(_n.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(My,{onDelete:()=>Z(me),children:v.jsxs("div",{className:"flex justify-between items-center py-2 px-3 bg-gray-50 dark:bg-zinc-800 rounded-xl cursor-pointer",onClick:()=>ne(me),children:[v.jsx("div",{className:"flex-1",children:v.jsx("p",{className:"text-xs font-medium text-gray-900 dark:text-white",children:me.name})}),v.jsxs("p",{className:"text-xs font-bold text-green-600 dark:text-emerald-400",children:["$",me.amount.toFixed(2)]})]})})},me.id))})})]}),T.map(me=>v.jsx(EN,{category:me,envelopes:H.groups[me.id]||[],allocations:a,currentMonth:i,transactions:s,navigate:P,getEnvelopeBalance:h,onReorderGlobal:F},me.id)),H.uncategorized.length>0&&v.jsx(EN,{category:{id:"uncategorized",name:"Uncategorized"},envelopes:H.uncategorized,allocations:a,currentMonth:i,transactions:s,navigate:P,getEnvelopeBalance:h,onReorderGlobal:F}),T.length===0&&H.uncategorized.length===0&&v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800 text-center py-12",children:[v.jsx(Bv,{className:"w-12 h-12 text-gray-300 dark:text-zinc-700 mx-auto mb-3"}),v.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-sm mb-4",children:"No envelopes yet."}),v.jsx("button",{onClick:()=>P("/add-envelope"),className:"text-blue-600 dark:text-blue-300 font-medium hover:text-blue-700 dark:hover:text-blue-200 transition-colors",children:"Create First Envelope"})]})]}),v.jsx(xne,{isVisible:N,onClose:oe,mode:I,initialIncomeSource:z})]})]})]})},Rne=[],f5=({selectedCard:n,onCardSelect:e,initialCards:t=Rne,disabled:r=!1,isUserSelected:i=!1})=>{const a=an(V=>V.appSettings),s=an(V=>V.updateAppSettings),[c,u]=U.useState(t.length>0?t[0]:{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}),[d,h]=U.useState(!1),[p,m]=U.useState(!1),[b,_]=U.useState(t),[w,E]=U.useState(null),[T,C]=U.useState({name:"",network:"Visa",last4:"",color:"#3b82f6"});U.useEffect(()=>{a?.paymentSources&&(_(a.paymentSources),a.paymentSources.length>0&&!n&&u(a.paymentSources[0]))},[a,n]);const k=n||c;U.useEffect(()=>{!n&&e&&b.length>0&&e(b[0])},[n,e,b]);const j=V=>{r||(V.id==="add-new"?m(!0):(u(V),e?.(V),h(!1)))},P=()=>{r||h(!d)},N=V=>{r||E(V)},A=async()=>{if(w&&!r){const V=b.filter(B=>B.id!==w.id);if(_(V),k?.id===w.id){const B=V.length>0?V[0]:{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"};u(B),e?.(B)}E(null),h(!1);try{await s({paymentSources:V})}catch(B){console.error("Failed to delete card from app settings:",B),_(b),alert("Failed to delete card. Please try again.");return}}},I=()=>{E(null)},D=async()=>{if(r)return;const V=!["Cash","Venmo"].includes(T.network);if(V&&(T.last4.length!==4||!/^\d{4}$/.test(T.last4))){alert("Please enter exactly 4 digits for the last 4 digits");return}if(!T.name.trim()){alert("Please enter a name");return}const B={id:`custom-${Date.now()}`,name:T.name.trim(),network:T.network,last4:V?T.last4:void 0,color:T.color},O=[...b,B];_(O),u(B),e?.(B),m(!1),h(!1);try{await s({paymentSources:O})}catch(X){console.error("Failed to save card to app settings:",X),_(b),u(k),alert("Failed to save card. Please try again.");return}C({name:"",network:"Visa",last4:"",color:"#3b82f6"})},z=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#6b7280","#0f4c81","#fdbb30","#7fb5b5","#232f3e","#e3e3e3"];return v.jsxs(v.Fragment,{children:[v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Payment Method",!i&&v.jsx("span",{className:"ml-2 text-xs text-blue-600 dark:text-blue-400 font-medium",children:"(Default selected)"})]}),v.jsxs("div",{onClick:P,className:`flex items-center gap-4 p-3 border rounded-lg transition-colors ${r?"cursor-not-allowed opacity-50 border-gray-300 dark:border-gray-600":"cursor-pointer hover:bg-gray-50 dark:hover:bg-zinc-800 border-gray-300 dark:border-gray-600"} ${i?"":"ring-2 ring-blue-200 dark:ring-blue-800"}`,children:[v.jsxs("div",{className:"w-[70px] h-[40px] rounded-lg flex flex-col justify-between p-[6px] shadow-lg text-white font-mono text-xs",style:{backgroundColor:k.color},children:[v.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:k.network}),v.jsx("span",{className:"text-left text-[9px] leading-none",children:["Cash","Venmo"].includes(k.network)?k.network==="Cash"?"$$$":"@":` ${k.last4||""}`})]}),v.jsxs("div",{className:"flex-1",children:[v.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:k.name}),v.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Cash","Venmo"].includes(k.network)?k.network:`(...${k.last4})`})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"text-gray-400",children:d?"":""}),!i&&v.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",title:"Default payment method - tap to change"})]})]}),d&&v.jsx("div",{className:"card-stack-dropdown",children:v.jsx("div",{className:"card-stack",children:v.jsx(di,{initial:!1,mode:"popLayout",children:[...b,{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}].map((V,B)=>{const O=k.id===V.id,X=V.id==="add-new",K=["Cash","Venmo"].includes(V.network);return v.jsx(_n.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(My,{onDelete:()=>!X&&!r&&N(V),threshold:-80,children:v.jsxs("div",{className:`card-stack-item ${O?"selected":""} ${X?"add-new-card":""}`,onClick:()=>j(V),style:{backgroundColor:X?"#f3f4f6":V.color,color:X?"#374151":V.color==="#e3e3e3"?"#000":"#fff",zIndex:b.length-B},children:[v.jsxs("div",{className:"card-header",children:[v.jsx("span",{className:"card-network",children:X?"":V.network}),O&&!X&&v.jsx("span",{className:"selected-indicator",children:""})]}),v.jsxs("div",{className:"card-details",children:[v.jsx("div",{className:"card-name",children:V.name}),v.jsx("div",{className:"card-number",children:X?"":K?V.network==="Cash"?"$$$":"@":` ${V.last4}`})]}),X&&v.jsx("div",{className:"add-icon",children:v.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[v.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),v.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})})},V.id)})})})})]}),p&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-md mx-4",children:[v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Add New Payment Method"}),v.jsx("button",{type:"button",onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:""})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Name"}),v.jsx("input",{type:"text",value:T.name,onChange:V=>C({...T,name:V.target.value}),placeholder:"e.g., Wallet Cash, My Venmo",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type"}),v.jsxs("select",{value:T.network,onChange:V=>C({...T,network:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[v.jsx("option",{value:"Visa",children:"Visa"}),v.jsx("option",{value:"Mastercard",children:"Mastercard"}),v.jsx("option",{value:"Amex",children:"Amex"}),v.jsx("option",{value:"Cash",children:"Cash"}),v.jsx("option",{value:"Venmo",children:"Venmo"})]})]}),!["Cash","Venmo"].includes(T.network)&&v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Last 4 Digits"}),v.jsx("input",{type:"text",value:T.last4,onChange:V=>C({...T,last4:V.target.value.replace(/\D/g,"").slice(0,4)}),placeholder:"1234",maxLength:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:z.map(V=>v.jsx("button",{type:"button",onClick:()=>C({...T,color:V}),className:`w-full h-10 rounded-lg border-2 transition-all ${T.color===V?"border-blue-500 scale-110":"border-gray-300 dark:border-gray-600"}`,style:{backgroundColor:V}},V))})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Preview"}),v.jsxs("div",{className:"w-full h-20 rounded-lg flex flex-col justify-between p-3 shadow-lg text-white font-mono text-xs",style:{backgroundColor:T.color},children:[v.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:T.network}),v.jsx("span",{className:"text-left text-[9px] leading-none",children:["Cash","Venmo"].includes(T.network)?T.network==="Cash"?"$$$":"@":` ${T.last4||"0000"}`})]})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{type:"button",onClick:()=>m(!1),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"button",onClick:D,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors",children:"Add"})]})]})]})}),w&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-sm mx-4",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center mx-auto mb-4",children:v.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Delete Card"}),v.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Are you sure you want to delete ",v.jsx("span",{className:"font-medium",children:w.name}),"?"]}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{type:"button",onClick:I,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"button",onClick:A,className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md transition-colors",children:"Delete"})]})]})})})]})},h5=({isVisible:n,onClose:e,mode:t,currentEnvelope:r,initialTransaction:i})=>{const{addTransaction:a,updateTransaction:s,deleteTransaction:c,currentMonth:u}=an(),[d,h]=U.useState(""),[p,m]=U.useState(""),[b,_]=U.useState(""),[w,E]=U.useState(new Date().toISOString().split("T")[0]),[T,C]=U.useState(null);U.useEffect(()=>{if(n)if(t==="edit"&&i){h(i.amount.toString()),m(i.merchant||""),_(i.description),C(i.paymentMethod||null);try{const A=new Date(i.date);isNaN(A.getTime())?(console.warn("Invalid date in transaction:",i.date),E(new Date().toISOString().split("T")[0])):E(A.toISOString().split("T")[0])}catch(A){console.error("Error parsing transaction date:",A),E(new Date().toISOString().split("T")[0])}}else h(""),m(""),_(""),E(new Date().toISOString().split("T")[0])},[n,t,i]);const k=async A=>{A.preventDefault();const I=parseFloat(d);if(isNaN(I)||I<=0){console.log(" Invalid amount:",d);return}console.log(" Saving transaction:",{mode:t,amount:I,note:b,date:w,envelopeId:r.id,paymentMethod:T});try{const D=new Date(w),z=`${D.getFullYear()}-${(D.getMonth()+1).toString().padStart(2,"0")}`;if(z!==u){const V=`This transaction date (${z}) does not match the current budget month (${u}). Are you sure you want to save it?`;if(!window.confirm(V))return}t==="add"?(console.log(" Adding income transaction"),await a({amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),envelopeId:r.id,type:"Income",reconciled:!1,paymentMethod:T||void 0})):t==="spend"?(console.log(" Adding expense transaction"),await a({amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),envelopeId:r.id,type:"Expense",reconciled:!1,paymentMethod:T||void 0})):t==="edit"&&i&&(console.log(" Updating transaction"),await s({...i,amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),paymentMethod:T||void 0})),console.log(" Transaction saved successfully"),e()}catch(D){console.error(" Error saving transaction:",D),alert("Failed to save transaction: "+(D instanceof Error?D.message:"Unknown error"))}},j=()=>{!i||!i.id||window.confirm("Are you sure you want to delete this transaction?")&&(c(i.id),e())},P=t==="add"?"Add Money":t==="spend"?"Spend Money":"Edit Transaction",N=t==="add"?"text-green-500":"text-red-500";return v.jsx(di,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(_n.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),v.jsxs(_n.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden relative z-10",children:[v.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),v.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:P}),v.jsx("button",{onClick:k,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!d||parseFloat(d)<=0||i?.isAutomatic,children:i?.isAutomatic?"":"Save"})]}),v.jsxs("form",{onSubmit:k,className:"p-6 space-y-6",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${N}`,children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:d,onChange:A=>{const I=A.target.value.replace(/\D/g,"");if(!I){h("");return}const z=(parseInt(I,10)/100).toFixed(2);h(z)},onKeyDown:A=>{(A.key==="e"||A.key==="E"||A.key==="+"||A.key==="-")&&A.preventDefault()},placeholder:"0.00",autoFocus:!0,disabled:i?.isAutomatic,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${N} placeholder-gray-700 ${i?.isAutomatic?"cursor-not-allowed opacity-80":""}`})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),v.jsx("input",{type:"text",value:p,onChange:A=>m(A.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none",disabled:i?.isAutomatic})]}),!i?.isAutomatic&&v.jsx(f5,{selectedCard:T,onCardSelect:C}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),v.jsx("input",{type:"text",value:b,onChange:A=>_(A.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none",disabled:i?.isAutomatic})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const A=new Date(w);return`${A.getFullYear()}-${(A.getMonth()+1).toString().padStart(2,"0")}`!==u?v.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[v.jsx(td,{size:14}),v.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),v.jsx("input",{type:"date",value:w,onChange:A=>{console.log("Date changed to:",A.target.value),E(A.target.value)},required:!0,disabled:i?.isAutomatic,className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark] disabled:opacity-80"})]}),t==="edit"&&!i?.isAutomatic&&v.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-zinc-800",children:v.jsxs("button",{type:"button",onClick:j,className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-50 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-200 dark:border-zinc-800",children:[v.jsx(HM,{className:"w-5 h-5 mr-2"}),"Delete Transaction"]})})]})]})]})})},kne=({isVisible:n,onClose:e,sourceEnvelope:t})=>{const{envelopes:r,transferFunds:i}=an(),[a,s]=U.useState(""),[c,u]=U.useState(""),[d,h]=U.useState(""),[p,m]=U.useState(new Date().toISOString().split("T")[0]),b=r.filter(E=>E.id!==t.id);U.useEffect(()=>{if(!n)return;const E=window.setTimeout(()=>{s(""),u(""),h(""),m(new Date().toISOString().split("T")[0])},0);return()=>window.clearTimeout(E)},[n]);const _=E=>{E.preventDefault();const T=parseFloat(c);isNaN(T)||T<=0||!a||(i(t.id,a,T,d,new Date(p)),e())},w=r.find(E=>E.id===a);return v.jsx(di,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(_n.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),v.jsxs(_n.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden relative z-10",children:[v.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),v.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:"Transfer Money"}),v.jsx("button",{onClick:_,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!c||parseFloat(c)<=0||!a,children:"Transfer"})]}),v.jsxs("form",{onSubmit:_,className:"p-6 space-y-6",children:[v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"From"}),v.jsx("div",{className:"text-gray-900 dark:text-white font-medium",children:t.name})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"To"}),v.jsxs("select",{value:a,onChange:E=>s(E.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none cursor-pointer",children:[v.jsx("option",{value:"",className:"bg-white dark:bg-zinc-900",children:"Select envelope..."}),b.map(E=>v.jsx("option",{value:E.id,className:"bg-white dark:bg-zinc-900",children:E.name},E.id))]})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl text-blue-600 dark:text-blue-400",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:c,onChange:E=>{const T=E.target.value.replace(/\D/g,"");if(!T){u("");return}const k=(parseInt(T,10)/100).toFixed(2);u(k)},onKeyDown:E=>{(E.key==="e"||E.key==="E"||E.key==="+"||E.key==="-")&&E.preventDefault()},placeholder:"0.00",autoFocus:!0,className:"bg-transparent text-4xl font-bold text-center w-40 focus:outline-none text-blue-600 dark:text-blue-400 placeholder-gray-400 dark:placeholder-gray-600"})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note (Optional)"}),v.jsx("input",{type:"text",value:d,onChange:E=>h(E.target.value),placeholder:"What is this transfer for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Date"}),v.jsx("input",{type:"date",value:p,onChange:E=>m(E.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),w&&c&&parseFloat(c)>0&&v.jsxs("div",{className:"text-center text-sm text-gray-500 dark:text-zinc-400 pt-2 border-t border-gray-200 dark:border-zinc-800",children:["Moving ",v.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-bold",children:["$",parseFloat(c).toFixed(2)]})," from"," ",v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:t.name})," to"," ",v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:w.name})]})]})]})]})})},Dne=({isOpen:n,onClose:e,onSave:t,existingPiggybank:r})=>{const[i,a]=U.useState(""),[s,c]=U.useState(""),[u,d]=U.useState(""),[h,p]=U.useState("#3B82F6"),[m,b]=U.useState("piggy-bank"),[_,w]=U.useState(!1),[E,T]=U.useState(!1);U.useEffect(()=>{r?(a(r.name),c(r.piggybankConfig?.targetAmount?.toString()||""),d(r.piggybankConfig?.monthlyContribution.toString()||"0"),p(r.piggybankConfig?.color||"#3B82F6"),b(r.piggybankConfig?.icon||"piggy-bank"),w(r.piggybankConfig?.paused||!1)):(a(""),c(""),d(""),p("#3B82F6"),b("piggy-bank"),w(!1))},[r,n]);const C=async j=>{if(j.preventDefault(),!(!i.trim()||!u)){T(!0);try{const P={name:i.trim(),isPiggybank:!0,piggybankConfig:{monthlyContribution:parseFloat(u),color:h,icon:m,paused:_}};s&&parseFloat(s)>0&&(P.piggybankConfig.targetAmount=parseFloat(s)),r&&(P.id=r.id,P.currentBalance=r.currentBalance,P.lastUpdated=new Date().toISOString(),P.isActive=r.isActive,P.orderIndex=r.orderIndex,P.userId=r.userId),await t(P),e()}catch(P){console.error("Error saving piggybank:",P),alert("Failed to save piggybank")}finally{T(!1)}}},k=[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#F59E0B",label:"Amber"},{value:"#EF4444",label:"Red"},{value:"#8B5CF6",label:"Purple"},{value:"#EC4899",label:"Pink"}];return v.jsx(di,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(_n.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),v.jsxs(_n.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"sticky top-0 bg-white dark:bg-zinc-900 border-b border-gray-200 dark:border-zinc-800 px-6 py-4 flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center",children:v.jsx(Pp,{size:20,className:"text-blue-600 dark:text-blue-400"})}),v.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:r?"Edit Piggybank":"New Piggybank"})]}),v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:v.jsx(Uv,{size:24})})]}),v.jsxs("form",{onSubmit:C,className:"p-6 space-y-5",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"piggybank-name",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Piggybank Name *"}),v.jsx("input",{type:"text",id:"piggybank-name",value:i,onChange:j=>a(j.target.value),placeholder:"e.g. Vacation Fund, Emergency Savings",className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:!0,autoFocus:!0})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"monthly-contribution",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Monthly Auto-Contribution *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",id:"monthly-contribution",value:u,onChange:j=>{const P=j.target.value.replace(/\D/g,"");if(!P){d("");return}const A=(parseInt(P,10)/100).toFixed(2);d(A)},placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:!0})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"This amount will be automatically added each month and deducted from Available to Budget"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Target Goal (Optional)"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",id:"target-amount",value:s,onChange:j=>{const P=j.target.value.replace(/\D/g,"");if(!P){c("");return}const A=(parseInt(P,10)/100).toFixed(2);c(A)},placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Set a savings goal to track progress"})]}),v.jsx("div",{className:"space-y-2",children:v.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[v.jsx("input",{type:"checkbox",checked:_,onChange:j=>w(j.target.checked),className:"w-5 h-5 rounded border-gray-300 dark:border-zinc-700 text-blue-600 focus:ring-2 focus:ring-blue-500"}),v.jsxs("div",{children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Pause auto-contributions"}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Monthly contributions will be skipped while paused"})]})]})}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:k.map(j=>v.jsx("button",{type:"button",onClick:()=>p(j.value),className:`w-full aspect-square rounded-lg transition-all ${h===j.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-zinc-900":"hover:scale-110"}`,style:{backgroundColor:j.value},title:j.label},j.value))})]}),v.jsxs("div",{className:"pt-4 flex gap-3",children:[v.jsx("button",{type:"button",onClick:e,className:"flex-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 font-semibold bg-white dark:bg-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",disabled:E,children:"Cancel"}),v.jsx("button",{type:"submit",disabled:!i.trim()||!u||E,className:`flex-1 py-3 px-4 rounded-xl font-semibold shadow-sm text-white transition-colors ${i.trim()&&u&&!E?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-300 dark:bg-zinc-600 cursor-not-allowed"}`,children:E?"Saving...":r?"Update":"Create"})]})]})]})]})})},Nne=n=>{if(!n)return"No Date";try{let e;return n&&typeof n=="object"&&n.toDate&&typeof n.toDate=="function"?e=n.toDate():typeof n=="number"?n<1e10?e=new Date((n+978307200)*1e3):e=new Date(n):e=new Date(n),isNaN(e.getTime())?"Invalid Date":new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(e)}catch(e){return console.error("Date error:",e),"Error"}},Mne=n=>{const e=typeof n=="string"?parseFloat(n):n;return typeof e!="number"||isNaN(e)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.abs(e))},p5=({transaction:n,envelopeName:e,onReconcile:t,onEdit:r})=>{if(!n)return null;console.log(" Transaction payment method:",n.paymentMethod);const i=n.type==="Income",a=n.type==="Expense";let s="text-gray-900 dark:text-white";return i&&(s="text-green-600 dark:text-green-400"),a&&(s="text-red-600 dark:text-red-400"),v.jsxs("div",{onClick:r,className:"flex items-center justify-between p-4 bg-white dark:bg-zinc-900 active:bg-gray-50 dark:active:bg-zinc-800 active:scale-[0.99] transition-all cursor-pointer group border-b border-gray-100 dark:border-zinc-800 last:border-0",children:[v.jsxs("div",{className:"flex flex-col gap-1 overflow-hidden",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"font-semibold text-gray-900 dark:text-white truncate",children:n.merchant||n.description||"No Description"}),n.reconciled&&v.jsx("span",{className:"text-[10px] bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 px-1.5 py-0.5 rounded-full font-bold uppercase tracking-wide",children:"R"})]}),n.merchant&&n.description&&n.description!==n.merchant&&v.jsx("div",{className:"text-xs text-gray-600 dark:text-zinc-400 truncate",children:n.description}),v.jsxs("div",{className:"text-xs text-gray-500 dark:text-zinc-500 flex items-center gap-1 flex-wrap",children:[v.jsx("span",{children:Nne(n.date)}),e&&v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""}),v.jsx("span",{className:"text-blue-500 dark:text-blue-400 truncate max-w-[150px]",children:e})]}),n.paymentMethod&&v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""}),v.jsxs("span",{className:"flex items-center gap-1",children:[v.jsx("span",{className:"w-[12px] h-[8px] rounded-[2px] flex-shrink-0",style:{backgroundColor:n.paymentMethod.color}}),v.jsx("span",{className:"truncate max-w-[80px]",children:n.paymentMethod.name})]})]})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("div",{className:`font-bold font-mono whitespace-nowrap ${s}`,children:[a?"-":i?"+":"",Mne(n.amount)]}),t?v.jsx("button",{type:"button",onClick:c=>{c.stopPropagation(),t()},className:"p-1.5 rounded-full border border-transparent hover:border-green-200 dark:hover:border-green-500 transition-colors","aria-label":n.reconciled?"Mark as unreconciled":"Mark as reconciled",children:n.reconciled?v.jsx(ws,{className:"text-green-500",size:20}):v.jsx(k2,{className:"text-gray-400",size:20})}):v.jsx("span",{children:n.reconciled?v.jsx(ws,{className:"text-green-500",size:20}):v.jsx(k2,{className:"text-gray-400",size:20})})]})]})},L1=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n),Pne=()=>{const{id:n}=Y8(),{envelopes:e,transactions:t,fetchData:r,isLoading:i,deleteEnvelope:a,renameEnvelope:s,updateTransaction:c,deleteTransaction:u,restoreTransaction:d,getEnvelopeBalance:h,currentMonth:p,allocations:m,incomeSources:b,setEnvelopeAllocation:_,updatePiggybankContribution:w,updateEnvelope:E}=an(),{showToast:T}=Vc(),C=Za(),k=da(),[j,P]=U.useState(!1),[N,A]=U.useState(!1),[I,D]=U.useState(!1),[z,V]=U.useState(null),[B,O]=U.useState(!1),[X,K]=U.useState(!1),[$,W]=U.useState(""),ee=U.useRef(null),ie=U.useRef(!1);U.useEffect(()=>{e.length===0&&r()},[]);const H=e.find(ae=>ae.id===n),F=async ae=>{if(H)try{const Ce={...H,...ae,id:H.id,userId:H.userId,currentBalance:H.currentBalance,lastUpdated:new Date().toISOString(),isActive:H.isActive,orderIndex:H.orderIndex};await E(Ce),T("Piggybank updated successfully","success"),O(!1)}catch(Ce){console.error("Failed to update piggybank:",Ce),T("Failed to update piggybank","error")}},Y=H?.isPiggybank?H.piggybankConfig?.monthlyContribution||0:m[p]?.find(ae=>ae.envelopeId===n)?.budgetedAmount||0;U.useEffect(()=>{X&&(W(Y.toString()),setTimeout(()=>{ee.current?.focus(),ee.current?.select()},50))},[X,Y]);const ne=ae=>{const Ce=(b[p]||[]).reduce((Le,Se)=>Le+Se.amount,0),Ne=m[p]||[];let Ge=Ne.map(Le=>H&&Le.envelopeId===H.id&&ae!==void 0?{...Le,budgetedAmount:ae}:Le).filter(Le=>{const Se=e.find(Be=>Be.id===Le.envelopeId);return Se?Se.isActive!==!1:!1}).reduce((Le,Se)=>Le+Se.budgetedAmount,0);return ae!==void 0&&H&&(Ne.some(Se=>Se.envelopeId===H.id)||(Ge+=ae)),Ce-Ge},oe=X?ne(parseFloat($)||0):ne(),ue=async()=>{if(!H||ie.current)return;const ae=parseFloat($);if(isNaN(ae)||ae<0){T("Please enter a valid positive number","error");return}ie.current=!0;try{H.isPiggybank?await w(H.id,ae):await _(H.id,ae),K(!1)}catch(Ce){console.error("Failed to save budget:",Ce),T("Failed to update budget","error")}finally{ie.current=!1}};if(!H)return i?v.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:v.jsx("p",{children:"Loading envelope..."})}):v.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:v.jsx("p",{children:"Envelope not found."})});if(H.isPiggybank){const ae=t.filter(Ce=>Ce.envelopeId===H.id);console.log(" Piggybank:",H.name),console.log(" Created at:",H.createdAt),console.log(" Transactions:",ae.map(Ce=>({date:Ce.date,description:Ce.description,amount:Ce.amount})))}const ye=t.filter(ae=>ae.envelopeId===H.id).filter(ae=>{if(ae.description==="Budgeted"||ae.description==="Piggybank Contribution")return!1;if(H.isPiggybank){if(!H.createdAt)return!0;const Ce=kv(H.createdAt).toISOString().split("T")[0];return kv(ae.date).toISOString().split("T")[0]>=Ce}return ae.month===p||!ae.month}).sort((ae,Ce)=>new Date(Ce.date).getTime()-new Date(ae.date).getTime()),me=()=>{k.state?.fromGlobalFAB?C("/"):C(-1)},Te=()=>{n&&(a(n),C(-1))},Me=ae=>{const Ce={...ae,reconciled:!ae.reconciled};c(Ce)};return v.jsxs("div",{className:"min-h-screen bg-white dark:bg-black text-gray-900 dark:text-white p-4 pb-[calc(8rem+env(safe-area-inset-bottom))] max-w-4xl mx-auto",children:[v.jsxs("header",{className:"flex justify-between items-center pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 bg-white dark:bg-black z-10 border-b border-gray-100 dark:border-zinc-800",children:[v.jsx("button",{onClick:()=>{if(H.isPiggybank)O(!0);else{const ae=prompt("Rename envelope:",H.name);ae&&ae.trim()&&n&&s(n,ae)}},className:"text-blue-600 dark:text-blue-400 font-medium",children:H.isPiggybank?"Edit":"Rename"}),v.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:H.name}),v.jsx("button",{onClick:me,className:"text-blue-600 dark:text-blue-400 font-bold",children:"Done"})]}),v.jsxs("section",{className:"mt-4 bg-white dark:bg-zinc-900 rounded-lg p-4 shadow-lg mb-4 border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-2",children:[v.jsx("span",{className:"text-lg font-headline text-gray-900 dark:text-white",children:"Current Balance"}),(()=>{const ae=H.isPiggybank?h(H.id):h(H.id,p);return console.log(`Debug: Envelope ${H.name} Balance:`,ae),v.jsx("span",{className:`text-xl font-bold ${ae<0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:L1(ae)})})()]}),v.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("span",{className:"text-sm font-medium text-gray-500 dark:text-zinc-400",children:H.isPiggybank?"Monthly Contribution":"Budgeted This Month"}),X?v.jsx("form",{onSubmit:ae=>{ae.preventDefault(),ue()},className:"flex items-center gap-2",children:v.jsx("input",{ref:ee,type:"number",step:"0.01",value:$,onChange:ae=>W(ae.target.value),onBlur:ue,className:"w-24 px-2 py-1 text-right font-semibold bg-gray-100 dark:bg-zinc-800 rounded border border-blue-500 focus:outline-none"})}):v.jsx("div",{onClick:()=>K(!0),className:"px-2 py-1 -mr-2 rounded hover:bg-gray-100 dark:hover:bg-zinc-800 cursor-pointer transition-colors",children:v.jsx("span",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:L1(Y)})})]}),v.jsxs("div",{className:`mt-3 py-1.5 px-3 rounded-md flex justify-between items-center text-xs font-medium transition-colors ${oe<0?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":oe===0?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300"}`,children:[v.jsx("span",{children:"Left to Budget:"}),v.jsx("span",{children:L1(oe)})]})]})]}),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg mb-4 divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:[v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-green-600 dark:text-green-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>P(!0),children:[v.jsx(pF,{className:"w-5 h-5 mr-3"}),"Add Money"]}),v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>A(!0),children:[v.jsx(fF,{className:"w-5 h-5 mr-3"}),"Spend Money"]}),v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>D(!0),children:[v.jsx(QU,{className:"w-5 h-5 mr-3"}),"Transfer Money"]})]}),v.jsxs("section",{className:"mt-6",children:[v.jsx("h2",{className:"text-sm font-semibold uppercase text-gray-500 dark:text-zinc-400 mb-2 px-2",children:"Transaction History"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:ye.length===0?v.jsx("p",{className:"p-4 text-center text-gray-500 dark:text-zinc-400",children:"No transactions yet for this envelope."}):v.jsx(di,{initial:!1,mode:"popLayout",children:ye.map(ae=>v.jsx(_n.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(My,{disabled:ae.isAutomatic,onDelete:()=>{if(!ae.id)return;const Ce={...ae};u(ae.id),T("Transaction deleted","neutral",()=>d(Ce))},children:v.jsx(p5,{transaction:ae,onReconcile:()=>Me(ae),onEdit:()=>{ae.isAutomatic||V(ae)}})})},ae.id))})})]}),v.jsx("div",{className:"mt-8",children:v.jsxs("button",{className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-100 dark:border-zinc-800",onClick:()=>{const ae=H.isPiggybank?`Are you sure you want to delete "${H.name}"? This will delete the piggybank and all its history.`:`Are you sure you want to remove "${H.name}" from ${p}? This will delete all transactions for this month only.`;confirm(ae)&&Te()},children:[v.jsx(HM,{className:"w-5 h-5 mr-2"}),"Delete Envelope"]})}),v.jsx(h5,{isVisible:j||N||!!z,onClose:()=>{P(!1),A(!1),V(null)},mode:j?"add":N?"spend":"edit",currentEnvelope:H,initialTransaction:z}),v.jsx(kne,{isVisible:I,onClose:()=>D(!1),sourceEnvelope:H}),v.jsx(Dne,{isOpen:B,onClose:()=>O(!1),onSave:F,existingPiggybank:H})]})},One=({isVisible:n,onClose:e,onConfirm:t,currentMonth:r,incomeCount:i,totalIncome:a,allocationCount:s,totalAllocated:c,transactionCount:u,totalTransactionAmount:d,isLoading:h=!1})=>{const[p,m]=U.useState("confirm"),b=E=>{const[T,C]=E.split("-");return new Date(parseInt(T),parseInt(C)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},_=()=>{p==="confirm"?m("final_confirm"):p==="final_confirm"&&t()},w=()=>{m("confirm"),e()};return v.jsx(di,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(_n.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:w,className:"absolute inset-0 bg-black bg-opacity-50"}),v.jsxs(_n.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[v.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Start Fresh for ",b(r)]}),v.jsx("button",{onClick:w,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",disabled:h,children:""})]}),v.jsx("div",{className:"p-6 space-y-4",children:p==="confirm"?v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),v.jsxs("div",{className:"ml-3",children:[v.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"This action will permanently delete:"}),v.jsx("div",{className:"mt-2 text-sm text-red-700 dark:text-red-300",children:v.jsxs("ul",{className:"space-y-1",children:[v.jsxs("li",{children:[" ",i," income source",i!==1?"s":""," (totaling $",a.toFixed(2),"/month)"]}),v.jsxs("li",{children:[" ",s," envelope allocation",s!==1?"s":""," (totaling $",c.toFixed(2),")"]}),v.jsxs("li",{children:[" ",u," transaction",u!==1?"s":""," (totaling $",d.toFixed(2),")"]})]})})]})]})}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),v.jsx("div",{className:"ml-3",children:v.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[v.jsx("strong",{children:"All other months will remain completely unchanged."})," This only affects the current month's budget data, income sources, allocations, and all transactions."]})})]})})]}):v.jsxs("div",{className:"text-center py-4",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900 mb-4",children:v.jsx("svg",{className:"h-6 w-6 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),v.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 dark:text-white mb-2",children:"Are you absolutely sure?"}),v.jsxs("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:["This action cannot be undone. All budget data and transactions for ",v.jsx("strong",{children:b(r)})," will be permanently removed."]})]})}),v.jsxs("div",{className:"flex gap-3 p-6 border-t border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{type:"button",onClick:w,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",disabled:h,children:"Cancel"}),v.jsx("button",{type:"button",onClick:_,disabled:h,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:h?"Clearing...":p==="confirm"?"Continue":"Yes, Start Fresh"})]})]})]})})},jne=()=>{const n=Za(),e=U.useRef(null),{envelopes:t,transactions:r,resetData:i,importData:a,getEnvelopeBalance:s,appSettings:c,updateAppSettings:u,initializeAppSettings:d,incomeSources:h,allocations:p,currentMonth:m,clearMonthData:b,handleUserLogout:_,resetOnboarding:w}=an(),{deleteAccount:E,currentUser:T,logout:C}=Mi(),[k,j]=U.useState(null),[P,N]=U.useState(()=>localStorage.getItem("lastBackupDate")||"Never"),[A,I]=U.useState(!1),[D,z]=U.useState(""),[V,B]=U.useState(!1),[O,X]=U.useState(!1),[K,$]=U.useState(null),[W,ee]=U.useState(!1),[ie,H]=U.useState(!1),F=978307200,Y=c?.theme??"system",ne=c?.fontSize??"medium";U.useEffect(()=>{c||d().catch(Se=>{console.error("Failed to initialize app settings:",Se)})},[d,c]);const Z=(Se,Be)=>{j({type:Se,text:Be}),setTimeout(()=>j(null),3500)},oe=U.useMemo(()=>{const Se=t.length,Be=r.length,Pe=m?p[m]||[]:[],Ue=Object.values(h).reduce((pn,Ot)=>pn+Ot.length,0),lt=Pe.length,Et=t.reduce((pn,Ot)=>{const Rn=Ot.isPiggybank?s(Ot.id):s(Ot.id,m);return pn+(typeof Rn=="number"?Rn:0)},0),tt=0,ft=r.reduce((pn,Ot)=>{let Rn=0;if(typeof Ot.date=="string"){const Yr=Date.parse(Ot.date);Rn=Number.isNaN(Yr)?0:Yr}else typeof Ot.date=="number"&&(Rn=Ot.date<2e9?(Ot.date+F)*1e3:Ot.date);return Math.max(pn,Rn)},0),Dt=tt||ft?new Date(Math.max(tt,ft)).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"Never";return{envelopeCount:Se,transactionCount:Be,incomeSourceCount:Ue,allocationCount:lt,totalBalance:Et,lastUpdated:Dt}},[t,r,h,p,m]),ue=()=>{try{console.log(" Creating backup...");const Se={appVersion:"1.6.8",backupDate:Date.now(),appSettings:c||{theme:"system"},envelopes:t.map(Et=>({...Et,currentBalance:(()=>{const tt=Et.isPiggybank?s(Et.id):s(Et.id,m);return typeof tt=="number"?tt:0})(),lastUpdated:new Date().toISOString()})),transactions:r,allocations:p,incomeSources:h},Be=new Blob([JSON.stringify(Se,null,2)],{type:"application/json"}),Pe=URL.createObjectURL(Be),Ue=document.createElement("a");Ue.href=Pe,Ue.download=`HouseBudget_Backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(Ue),Ue.click(),document.body.removeChild(Ue),URL.revokeObjectURL(Pe);const lt=new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});localStorage.setItem("lastBackupDate",lt),N(lt),$({success:!0,message:"Backup downloaded successfully."})}catch(Se){console.error(Se),$({success:!1,message:"Failed to create backup file.",onRetry:ue})}},ye=()=>{X(!0),$(null);try{const Se=["Date","Merchant","Payment Method","Notes","Amount","Type","Envelope","Reconciled"],Be=r.filter(tt=>tt.description!=="Budgeted"&&tt.description!=="Piggybank Contribution").map(tt=>{const ft=t.find(fa=>fa.id===tt.envelopeId)?.name||"Unknown",Dt=(tt.merchant||"").replace(/"/g,'""'),pn=(tt.description||"").replace(/"/g,'""');let Ot="";tt.paymentMethod&&(Ot=`${tt.paymentMethod.name} (...${tt.paymentMethod.last4})`);const Rn=Ot.replace(/"/g,'""');let Yr="Invalid Date";if(tt.date){if(typeof tt.date=="string")Yr=tt.date.split("T")[0];else if(typeof tt.date=="number"){const fa=tt.date<2e9?(tt.date+F)*1e3:tt.date;Yr=new Date(fa).toISOString().split("T")[0]}}return[Yr,`"${Dt}"`,`"${Rn}"`,`"${pn}"`,tt.amount.toFixed(2),tt.type,`"${ft}"`,tt.reconciled?"Yes":"No"].join(",")}),Pe=[Se.join(","),...Be].join(`
`),Ue=new Blob([Pe],{type:"text/csv;charset=utf-8;"}),lt=URL.createObjectURL(Ue),Et=document.createElement("a");Et.href=lt,Et.download=`HouseBudget_Transactions_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(Et),Et.click(),document.body.removeChild(Et),URL.revokeObjectURL(lt),$({success:!0,message:"Transactions CSV exported successfully."})}catch(Se){console.error(Se),$({success:!1,message:"Failed to export CSV. Please try again.",onRetry:ye})}finally{X(!1)}},me=()=>{e.current?.click()},Te=Se=>{const Be=Se.target.files?.[0];if(!Be)return;const Pe=new FileReader;Pe.onload=async Ue=>{try{const lt=JSON.parse(Ue.target?.result),Et=await a(lt);if(!Et.success){Z("error",Et.message);return}if(lt.appSettings?.theme)try{await u({theme:lt.appSettings.theme})}catch(tt){console.error("Failed to update imported settings:",tt)}Z("success",`Loaded ${lt.envelopes?.length??0} envelopes, ${lt.transactions?.length??0} transactions.`)}catch(lt){console.error(lt),Z("error","Invalid backup file. Please verify the JSON.")}},Pe.readAsText(Be),Se.target.value=""},Me=async()=>{if(window.confirm("Are you sure? This will permanently delete all envelopes, transactions, budget allocations, income sources, and settings from the cloud. This action cannot be undone."))try{await i(),Z("success","All data has been permanently deleted."),n("/")}catch(Se){console.error("Reset failed:",Se),Z("error","Failed to delete all data. Some data may remain.")}},ae=async()=>{if(!D.trim()){Z("error","Please enter your password to confirm account deletion.");return}I(!0);try{await i(),await E(D)?Z("success","Your account has been permanently deleted."):Z("error","Failed to delete account. Please try again.")}catch(Se){console.error("Account deletion failed:",Se),Z("error","Failed to delete account. Please try again.")}finally{I(!1),B(!1),z("")}},Ce=async()=>{if(!T){Z("error","You must be logged in to clean up data.");return}ee(!0);try{const Se=await fT.cleanupOrphanedData(T.id),Be=Se.orphanedAllocationsDeleted+Se.orphanedTransactionsDeleted;Be>0?Z("success",`Cleaned ${Be} orphaned items: ${Se.orphanedAllocationsDeleted} allocations and ${Se.orphanedTransactionsDeleted} transactions.`):Z("success","No orphaned data found. Your database is already clean!")}catch(Se){console.error("Cleanup failed:",Se),Z("error","Failed to clean up orphaned data. Please try again.")}finally{ee(!1)}},Ne=()=>{H(!0)},Oe=async()=>{H(!1),await b(m),Z("success","Month data has been reset.")},Ge=async()=>{if(window.confirm("Are you sure you want to log out? This will clear all your data from the app until you log back in."))try{_(),C(),n("/")}catch(Se){console.error("Logout failed:",Se)}},Le=T?.displayName?.charAt(0)?.toUpperCase()||T?.email?.charAt(0)?.toUpperCase()||"U";return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black transition-colors duration-200",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-center shadow-sm relative",children:[v.jsx("button",{onClick:()=>n(-1),className:"absolute left-4 text-blue-600 dark:text-blue-400 font-medium",children:"Done"}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Settings"})]}),v.jsxs("div",{className:"p-4 space-y-6 max-w-4xl mx-auto pb-[calc(8rem+env(safe-area-inset-bottom))]",children:[k&&v.jsxs("div",{className:`px-4 py-3 rounded-2xl text-sm font-medium flex items-center gap-2 ${k.type==="success"?"bg-green-50 text-green-700 dark:bg-emerald-900/30 dark:text-emerald-200":"bg-red-50 text-red-700 dark:bg-red-900/30 dark:text-red-200"}`,children:[k.type==="success"?v.jsx(q0,{size:18}):v.jsx($0,{size:18}),k.text]}),v.jsx("section",{children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4 flex items-center gap-4",children:[v.jsx("div",{className:"w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center text-white text-2xl font-semibold shadow-md",children:Le}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white truncate",children:T?.displayName||T?.email?.split("@")[0]||"User"}),v.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400 truncate",children:T?.email}),v.jsxs("button",{onClick:Ge,className:"mt-2 text-sm text-red-600 dark:text-red-400 font-medium flex items-center gap-1 hover:underline",children:[v.jsx(zF,{size:14})," Log Out"]})]})]})}),v.jsx("section",{children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-5 space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(N2,{className:"text-blue-500",size:22}),v.jsxs("div",{children:[v.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Backup & Restore"}),v.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Create backups of all your data including envelopes, transactions, budget allocations, income sources, and settings."})]})]}),v.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 pt-2",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Envelopes"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:oe.envelopeCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Transactions"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:oe.transactionCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Income Sources"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:oe.incomeSourceCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Allocations"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:oe.allocationCount})]})]})]})}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Categories"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:v.jsxs("button",{onClick:()=>n("/settings/categories"),className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("span",{className:"text-xl",children:""}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Manage Categories"})]}),v.jsx(Da,{className:"text-gray-400",size:18})]})})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Appearance"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4 space-y-4",children:[v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[Y==="light"&&v.jsx("span",{className:"text-orange-500 text-lg",children:""}),Y==="dark"&&v.jsx("span",{className:"text-purple-500 text-lg",children:""}),Y==="system"&&v.jsx("span",{className:"text-gray-500 text-lg",children:""}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Theme"})]}),v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 capitalize",children:Y})]}),v.jsx("div",{className:"flex gap-2",children:[{label:"Light",value:"light"},{label:"Dark",value:"dark"},{label:"System",value:"system"}].map(Se=>v.jsx("button",{onClick:async()=>{try{await u({theme:Se.value})}catch(Be){console.error("Failed to update theme setting:",Be)}},className:`flex-1 py-2 rounded-lg text-sm font-medium border transition-colors ${Y===Se.value?"bg-blue-50 dark:bg-blue-900/30 border-blue-500 text-blue-700 dark:text-blue-200":"border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 hover:border-gray-300 dark:hover:border-zinc-600"}`,children:Se.label},Se.value))})]}),v.jsx("div",{className:"h-px bg-gray-100 dark:bg-zinc-800"}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("span",{className:"text-gray-500 text-lg",children:"Aa"}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Font Size"})]}),v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 capitalize",children:ne})]}),v.jsx("div",{className:"flex gap-2",children:[{label:"A",value:"extra-small",sizeClass:"text-[10px]"},{label:"A",value:"small",sizeClass:"text-xs"},{label:"A",value:"medium",sizeClass:"text-base"},{label:"A",value:"large",sizeClass:"text-xl"},{label:"A",value:"extra-large",sizeClass:"text-2xl"}].map(Se=>v.jsx("button",{onClick:async()=>{try{await u({fontSize:Se.value})}catch(Be){console.error("Failed to update font size setting:",Be)}},className:`flex-1 py-2 rounded-lg font-medium border transition-colors flex items-center justify-center ${ne===Se.value?"bg-blue-50 dark:bg-blue-900/30 border-blue-500 text-blue-700 dark:text-blue-200":"border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 hover:border-gray-300 dark:hover:border-zinc-600"}`,children:v.jsx("span",{className:Se.sizeClass,children:Se.label})},Se.value))})]})]})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Help & Guide"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:v.jsxs("button",{onClick:()=>{w(),n("/")},className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Xh,{className:"text-purple-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Restart Onboarding Guide"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"View the welcome tutorial again"})]})]}),v.jsx(Da,{className:"text-gray-400",size:18})]})})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Actions"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:[v.jsxs("button",{onClick:ue,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(N2,{className:"text-blue-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Create Backup"}),v.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["Last backup: ",P]})]})]}),v.jsx(Da,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:me,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(d7,{className:"text-blue-500",size:20}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Restore from Backup"})]}),v.jsx(Da,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:ye,disabled:O,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[O?v.jsx(M2,{className:"text-blue-500 animate-spin",size:20}):v.jsx(TF,{className:"text-blue-500",size:20}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:O?"Preparing CSV":"Export Transactions (CSV)"})]}),v.jsx(Da,{className:"text-gray-400",size:18})]}),v.jsx("input",{type:"file",ref:e,onChange:Te,accept:".json",className:"hidden"})]})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Danger Zone"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm",children:[v.jsxs("button",{onClick:Ne,className:"w-full p-4 flex items-center justify-between hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Kh,{className:"text-orange-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Start Fresh (This Month)"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Clear all allocations and data for the current month only"})]})]}),v.jsx(Da,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:Ce,disabled:W,className:"w-full p-4 flex items-center justify-between hover:bg-yellow-50 dark:hover:bg-yellow-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800 disabled:opacity-60 disabled:cursor-not-allowed",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[W?v.jsx(M2,{className:"text-yellow-500 animate-spin",size:20}):v.jsx(Xh,{className:"text-yellow-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:W?"Cleaning Data...":"Purge Orphaned Data"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Remove allocations and transactions pointing to deleted envelopes"})]})]}),v.jsx(Da,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:Me,className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx($0,{className:"text-red-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Reset All Data"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Permanently delete everything"})]})]}),v.jsx(Da,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:()=>B(!0),className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(td,{className:"text-red-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Delete Account"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Permanently delete your account and all data"})]})]}),v.jsx(Da,{className:"text-gray-400",size:18})]})]})]}),v.jsxs("div",{className:"text-center py-4",children:[v.jsxs("p",{className:"text-xs text-gray-400 dark:text-zinc-500",children:["Version ","1.6.8"," (PWA)"]}),"        "]}),K&&v.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 max-w-sm w-full",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[K.success?v.jsx(q0,{className:"text-green-500",size:24}):v.jsx(td,{className:"text-red-500",size:24}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:K.success?"Success":"Error"})]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-300 mb-4",children:K.message}),v.jsxs("div",{className:"flex gap-2",children:[K.onRetry&&v.jsx("button",{onClick:()=>{$(null),K.onRetry?.()},className:"flex-1 py-2 px-4 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors",children:"Retry"}),v.jsx("button",{onClick:()=>$(null),className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-zinc-700 text-gray-900 dark:text-white rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-zinc-600 transition-colors",children:"Close"})]})]})}),v.jsx(One,{isVisible:ie,onClose:()=>H(!1),onConfirm:Oe,currentMonth:m,incomeCount:(h[m]||[]).length,totalIncome:(h[m]||[]).reduce((Se,Be)=>Se+Be.amount,0),allocationCount:(p[m]||[]).filter(Se=>t.some(Be=>Be.id===Se.envelopeId)).length,totalAllocated:(p[m]||[]).filter(Se=>t.some(Be=>Be.id===Se.envelopeId)).reduce((Se,Be)=>Se+Be.budgetedAmount,0),transactionCount:r.filter(Se=>Se.month===m).length,totalTransactionAmount:r.filter(Se=>Se.month===m).reduce((Se,Be)=>Se+Be.amount,0)}),V&&v.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 max-w-sm w-full",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[v.jsx(td,{className:"text-red-500",size:24}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Account"})]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-300 mb-4",children:"This action cannot be undone. This will permanently delete your account and remove all data from our servers."}),v.jsx("input",{type:"password",value:D,onChange:Se=>z(Se.target.value),placeholder:"Enter your password",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 mb-4"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>{B(!1),z("")},className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-zinc-700 text-gray-900 dark:text-white rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-zinc-600 transition-colors",children:"Cancel"}),v.jsx("button",{onClick:ae,disabled:A||!D.trim(),className:"flex-1 py-2 px-4 bg-red-500 text-white rounded-lg font-medium hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:A?"Deleting...":"Delete Account"})]})]})})]})]})},Vne=()=>{const n=Za(),{categories:e,addCategory:t,updateCategory:r,deleteCategory:i,reorderCategories:a}=an(),{showToast:s}=Vc(),[c,u]=U.useState(!1),[d,h]=U.useState(""),[p,m]=U.useState(null),[b,_]=U.useState(""),[w,E]=U.useState(e),T=U.useRef(e),[C,k]=U.useState(!1),[j,P]=U.useState(null),N=U.useRef(!1),A=U.useRef(null),I=U.useRef({}),D=U.useRef({}),z=U.useRef({activeId:null,startIndex:0,currentIndex:0,itemHeight:0});U.useEffect(()=>{C||(E(e),T.current=e)},[e,C]),U.useEffect(()=>(C?(document.body.style.overflow="hidden",document.body.style.touchAction="none"):(document.body.style.overflow="",document.body.style.touchAction=""),()=>{document.body.style.overflow="",document.body.style.touchAction=""}),[C]);const V=U.useCallback((ie,H)=>{console.log(" Long press triggered for category:",H);const F=D.current[H];if(F){console.log(" Moveable instance found, starting drag"),N.current=!0;const Y=ie.nativeEvent||ie;F.dragStart(Y)}else console.log(" No moveable instance found for:",H)},[]),B=U.useCallback(ie=>H=>{H?I.current[ie]=H:delete I.current[ie]},[]),O=async ie=>{if(ie.preventDefault(),!!d.trim())try{await t({name:d.trim(),orderIndex:e.length,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),h(""),u(!1),s("Category added","success")}catch(H){console.error(H),s("Failed to add category","error")}},X=async ie=>{if(!b.trim())return;const H=e.find(F=>F.id===ie);if(H)try{await r({...H,name:b.trim()}),m(null),s("Category updated","success")}catch(F){console.error(F),s("Failed to update category","error")}},K=async ie=>{if(confirm("Are you sure? Envelopes in this category will become Uncategorized."))try{await i(ie),s("Category deleted","success")}catch(H){console.error(H),s("Failed to delete category","error")}},$=8,W=(ie,H,F)=>Math.max(H,Math.min(F,ie)),ee=U.useCallback(async ie=>{if(!ie.length)return;const H=ie.map(F=>F.id);try{await a(H)}catch(F){console.error("Failed to persist category order:",F),s("Failed to save category order","error")}},[a,s]);return U.useEffect(()=>{const ie=()=>{Object.values(D.current).forEach(Y=>Y?.destroy()),D.current={}};if(!w.length)return;const H=()=>{w.forEach(Y=>{const ne=I.current[Y.id];if(!ne||!A.current)return;const Z=new QV(A.current,{target:ne,draggable:!0,throttleDrag:0,snappable:!0,snapThreshold:5,snapDirections:{top:!0,bottom:!0},elementSnapDirections:{top:!0,bottom:!0},clickable:!0,dragArea:!1,hideDefaultLines:!0,renderDirections:[],edge:!1,origin:!1});Z.on("dragStart",ue=>{if(console.log(" Moveable dragStart event",{isManualDrag:N.current,categoryId:Y.id}),!N.current){console.log(" Stopping drag - not manual"),ue.stop();return}const ye=ue.inputEvent.target;if(ye.tagName==="INPUT"||ye.tagName==="BUTTON"||ye.closest("button")){console.log(" Stopping drag - clicked on button/input"),ue.stop();return}console.log(" Drag starting for category:",Y.id);const me=T.current.findIndex(ae=>ae.id===Y.id),Te=ue.target,Me=Te.getBoundingClientRect();P(Y.id),z.current={activeId:Y.id,startIndex:me,currentIndex:me,itemHeight:Me.height+$},Te.style.transition="none",Te.style.boxShadow="0 18px 45px rgba(15,23,42,0.35)",Te.style.zIndex="20",k(!0)});let oe=null;Z.on("drag",ue=>{const ye=ue.target;oe!==null&&cancelAnimationFrame(oe),oe=requestAnimationFrame(()=>{const me=z.current;if(me.activeId!==Y.id)return;const Te=ue.beforeTranslate[1];ye.style.transform=`translateY(${Te}px)`,ye.style.transition="none";const{itemHeight:Me,startIndex:ae}=me,Ce=Math.round(Te/Me),Ne=W(ae+Ce,0,T.current.length-1);Ne!==me.currentIndex&&(me.currentIndex=Ne,T.current.forEach((Oe,Ge)=>{if(Oe.id===Y.id)return;const Le=I.current[Oe.id];if(!Le)return;let Se=0;ae<Ne&&Ge>ae&&Ge<=Ne?Se=-Me:ae>Ne&&Ge>=Ne&&Ge<ae&&(Se=Me),Le.style.transform=Se?`translateY(${Se}px)`:"",Le.style.transition="transform 0.2s ease"})),oe=null})}),Z.on("dragEnd",ue=>{oe!==null&&(cancelAnimationFrame(oe),oe=null);const ye=ue.target,{startIndex:me,currentIndex:Te}=z.current;if(ye.style.transform="",ye.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease",ye.style.boxShadow="",T.current.forEach(Me=>{const ae=I.current[Me.id];ae&&(ae.style.transform="",ae.style.transition="")}),me!==Te){const Me=[...T.current],[ae]=Me.splice(me,1);Me.splice(Te,0,ae),T.current=Me,E(Me),ee(Me)}setTimeout(()=>{ye.style.zIndex="",P(null),k(!1),N.current=!1},300)}),D.current[Y.id]=Z})},F=window.setTimeout(H,80);return()=>{clearTimeout(F),ie()}},[w,ee]),v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-20",children:[v.jsx("style",{children:`
        .moveable-control-box,
        .moveable-line,
        .moveable-direction {
          display: none !important;
        }
      `}),v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-10 flex items-center shadow-sm",children:[v.jsx("button",{onClick:()=>n(-1),className:"mr-3 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white",children:v.jsx(Jo,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Manage Categories"})]}),v.jsxs("div",{className:"p-4 max-w-2xl mx-auto space-y-4",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:c?v.jsxs("form",{onSubmit:O,className:"flex gap-2",children:[v.jsx("input",{type:"text",value:d,onChange:ie=>h(ie.target.value),placeholder:"Category Name",className:"flex-1 px-3 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg outline-none dark:text-white",autoFocus:!0}),v.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium",children:"Save"}),v.jsx("button",{type:"button",onClick:()=>u(!1),className:"text-gray-500 px-2",children:"Cancel"})]}):v.jsxs("button",{onClick:()=>u(!0),className:"w-full flex items-center justify-center gap-2 text-blue-600 dark:text-blue-400 font-medium py-2",children:[v.jsx(Op,{size:20}),"Add Category"]})}),v.jsxs("div",{ref:A,className:"space-y-2",style:{touchAction:C?"none":"auto"},children:[w.map(ie=>{const H=uT(Y=>{V(Y,ie.id)},{threshold:500,cancelOnMovement:25,detect:Fo.Touch}),F=j===ie.id;return v.jsx("div",{...H(),ref:B(ie.id),style:{cursor:F?"grabbing":"pointer"},className:"bg-white dark:bg-zinc-900 rounded-xl p-4 border border-gray-100 dark:border-zinc-800 flex items-center justify-between group select-none",children:p===ie.id?v.jsxs("div",{className:"flex-1 flex gap-2",children:[v.jsx("input",{type:"text",value:b,onChange:Y=>_(Y.target.value),className:"flex-1 px-3 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg outline-none dark:text-white",autoFocus:!0}),v.jsx("button",{onClick:()=>X(ie.id),className:"bg-green-600 text-white px-3 py-2 rounded-lg text-sm",children:"Save"}),v.jsx("button",{onClick:()=>m(null),className:"text-gray-500 px-2 text-sm",children:"Cancel"})]}):v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"text-gray-400 dark:text-zinc-600 cursor-grab active:cursor-grabbing",onMouseDown:Y=>V(Y,ie.id),children:v.jsx(Yh,{size:20})}),v.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:ie.name})]}),v.jsxs("div",{className:"flex gap-2 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity",children:[v.jsx("button",{onClick:()=>{m(ie.id),_(ie.name)},className:"p-2 text-gray-500 hover:text-blue-600 dark:hover:text-blue-400",children:v.jsx(GF,{size:18})}),v.jsx("button",{onClick:()=>K(ie.id),className:"p-2 text-gray-500 hover:text-red-600 dark:hover:text-red-400",children:v.jsx($0,{size:18})})]})]})},ie.id)}),w.length===0&&!c&&v.jsx("div",{className:"text-center text-gray-500 dark:text-zinc-500 py-8",children:"No categories yet. Add one to get started."})]})]})]})},zne=()=>{const{addEnvelope:n,setEnvelopeAllocation:e,currentMonth:t,categories:r,fetchCategories:i}=an(),{showToast:a}=Vc(),s=Za(),[c]=zU();ch.useEffect(()=>{r.length===0&&i()},[r.length,i]);const[u,d]=U.useState(""),[h,p]=U.useState(c.get("type")==="piggybank"),[m,b]=U.useState(c.get("categoryId")||""),[_,w]=U.useState(""),[E,T]=U.useState(""),[C,k]=U.useState("#3B82F6"),[j,P]=U.useState(!1),N=async A=>{if(A.preventDefault(),!u.trim()||j)return;P(!0);const I=an.getState().envelopes,z=(I.length>0?Math.max(...I.map(X=>X.orderIndex??0)):-1)+1,V=h?new Date(`${t}-01T00:00:00`):new Date,B={name:u,currentBalance:0,lastUpdated:new Date().toISOString(),createdAt:V.toISOString(),isActive:!0,orderIndex:z,categoryId:m||void 0};if(h){B.isPiggybank=!0;const X={monthlyContribution:parseFloat(E||"0"),color:C,icon:"piggy-bank"};_&&parseFloat(_)>0&&(X.targetAmount=parseFloat(_)),B.piggybankConfig=X}n(B).then(X=>{if(X){const K=h?parseFloat(E||"0"):0;e(X,K).catch($=>console.error("Failed to create allocation:",$)),setTimeout(()=>{s("/")},50)}}).catch(X=>{console.error("Failed to create envelope:",X),a(X.message||"Failed to create envelope","error"),P(!1)})};return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-[calc(8rem+env(safe-area-inset-bottom))]",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-10 flex items-center shadow-sm",children:[v.jsx("button",{onClick:()=>s("/"),className:"mr-3 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white",children:v.jsx(Jo,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:h?"New Piggybank":"New Envelope"})]}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:[v.jsx("div",{className:"p-6 bg-blue-50 dark:bg-zinc-800 border-b border-blue-100 dark:border-zinc-700 flex justify-center py-8",children:v.jsx("div",{className:"w-20 h-20 bg-blue-100 dark:bg-zinc-700 text-blue-600 dark:text-blue-400 rounded-full flex items-center justify-center",children:h?v.jsx(Pp,{size:40}):v.jsx(CF,{size:40})})}),v.jsxs("form",{onSubmit:N,className:"p-6 space-y-6 pb-6",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Type"}),v.jsxs("div",{className:"flex bg-gray-100 dark:bg-zinc-800 p-1 rounded-xl",children:[v.jsx("button",{type:"button",onClick:()=>p(!1),className:`flex-1 py-2 px-4 rounded-lg text-sm font-semibold transition-all ${h?"text-gray-500 dark:text-zinc-400 hover:text-gray-700 dark:hover:text-zinc-300":"bg-white dark:bg-zinc-700 text-blue-600 dark:text-blue-400 shadow-sm"}`,children:"Spending"}),v.jsx("button",{type:"button",onClick:()=>p(!0),className:`flex-1 py-2 px-4 rounded-lg text-sm font-semibold transition-all ${h?"bg-white dark:bg-zinc-700 text-blue-600 dark:text-blue-400 shadow-sm":"text-gray-500 dark:text-zinc-400 hover:text-gray-700 dark:hover:text-zinc-300"}`,children:"Piggybank"})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Category"}),v.jsxs("select",{id:"category",value:m,onChange:A=>b(A.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all appearance-none",children:[v.jsx("option",{value:"",children:"Uncategorized"}),r.map(A=>v.jsx("option",{value:A.id,children:A.name},A.id))]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:h?"Piggybank Name":"Envelope Name"}),v.jsx("input",{type:"text",id:"name",value:u,onChange:A=>d(A.target.value),placeholder:h?"e.g. Vacation Fund, Emergency Savings":"e.g. Groceries, Rent, Fun Money",className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",autoFocus:!0,required:!0})]}),h&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"monthly-contribution",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Monthly Auto-Contribution *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"number",id:"monthly-contribution",value:E,onChange:A=>T(A.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:h})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"This amount will be automatically added each month and deducted from Available to Budget"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Target Goal (Optional)"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"number",id:"target-amount",value:_,onChange:A=>w(A.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Set a savings goal to track progress"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#F59E0B",label:"Amber"},{value:"#EF4444",label:"Red"},{value:"#8B5CF6",label:"Purple"},{value:"#EC4899",label:"Pink"}].map(A=>v.jsx("button",{type:"button",onClick:()=>k(A.value),className:`w-full aspect-square rounded-lg transition-all ${C===A.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-zinc-900":"hover:scale-110"}`,style:{backgroundColor:A.value},title:A.label},A.value))})]})]}),v.jsxs("div",{className:"pt-4 flex gap-3",children:[v.jsx("button",{type:"button",onClick:()=>s("/"),className:"flex-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 font-semibold bg-white dark:bg-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",children:"Cancel"}),v.jsx("button",{type:"submit",disabled:!u.trim()||h&&!E||j,className:`flex-1 py-3 px-4 rounded-xl font-semibold shadow-sm text-white transition-colors ${u.trim()&&(!h||E)&&!j?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-300 dark:bg-zinc-600 cursor-not-allowed"}`,children:j?"Creating...":h?"Create Piggybank":"Create Envelope"})]})]})]})})]})},Lne=({envelopes:n,transactionAmount:e,onSplitChange:t})=>{const[r,i]=U.useState([]),[a,s]=U.useState({}),[c,u]=U.useState(e),d=_=>{i(w=>w.includes(_)?w.filter(E=>E!==_):[...w,_])},h=(_,w)=>{s(E=>({...E,[_]:w}))};U.useEffect(()=>{if(r.length===1){const _=r[0];s({[_]:e})}},[r.length,e]),U.useEffect(()=>{const _=Object.values(a).reduce((w,E)=>w+(E||0),0);u(e-_),t(a)},[a,e,t]),U.useEffect(()=>{const _={...a};Object.keys(_).forEach(w=>{r.includes(w)||delete _[w]}),Object.keys(_).length!==Object.keys(a).length&&s(_)},[r,a]);const p=()=>{i([]),s({})},m=Math.abs(c)<.01&&r.length>0,b=r.length>0&&Math.abs(c)>.01;return v.jsxs("div",{className:"space-y-3",children:[r.length>1&&v.jsxs("div",{className:`p-3 rounded-lg ${b?"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800":m?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-zinc-800 border border-gray-200 dark:border-zinc-700"}`,children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Remaining to Split:"}),v.jsxs("span",{className:`font-bold text-lg ${b?"text-red-600 dark:text-red-400":m?"text-green-600 dark:text-green-400":"text-gray-900 dark:text-white"}`,children:["$",c.toFixed(2)]})]}),b&&v.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Split amounts must equal transaction total"})]}),v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("label",{className:"text-xs text-gray-500 dark:text-zinc-400",children:r.length>1?"Split Across Envelopes":"Select Envelope"}),r.length>0&&v.jsx("button",{type:"button",onClick:p,className:"text-xs text-blue-600 dark:text-blue-400",children:"Clear All"})]}),v.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-200 dark:border-zinc-800 rounded-lg",children:n.map(_=>v.jsxs("div",{className:"flex items-center py-3 px-3 border-b border-gray-100 dark:border-zinc-800 last:border-b-0 hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsx("input",{type:"checkbox",checked:r.includes(_.id),onChange:()=>d(_.id),className:"mr-3 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),v.jsx("span",{className:"flex-1 text-gray-900 dark:text-white",children:_.name}),r.includes(_.id)&&r.length>1&&v.jsxs("div",{className:"flex items-center",children:[v.jsx("span",{className:"mr-1 text-gray-500 dark:text-zinc-400",children:"$"}),v.jsx("input",{type:"number",min:"0",step:"0.01",value:a[_.id]||"",onChange:w=>h(_.id,parseFloat(w.target.value)||0),className:"w-24 px-2 py-1 border border-gray-300 dark:border-zinc-700 rounded bg-white dark:bg-zinc-900 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]})]},_.id))})]})},g5=({onClose:n,onSaved:e})=>{const t=Za(),{envelopes:r,addTransaction:i,currentMonth:a}=an(),[s,c]=U.useState(""),[u,d]=U.useState(""),[h,p]=U.useState(""),[m,b]=U.useState(()=>{const K=new Date;return new Date(K.getTime()-K.getTimezoneOffset()*6e4).toISOString().split("T")[0]}),[_,w]=U.useState("expense"),[E,T]=U.useState({}),[C,k]=U.useState(null),[j,P]=U.useState(!1),N=()=>{if(n){n();return}t(-1)},A=K=>{k(K),C&&P(!0)},I=Object.keys(E).length>0,D=Object.values(E).reduce((K,$)=>K+($||0),0),z=Math.abs(D-parseFloat(s||"0"))<.01,V=s&&parseFloat(s)>0&&I&&z,B=async K=>{if(K.preventDefault(),!V)return;const[$,W,ee]=m.split("-").map(Number),ie=new Date($,W-1,ee,12,0,0);console.log(" Selected date:",m),console.log(" Parsed date:",ie.toISOString());try{const[H,F]=m.split("-").map(Number),Y=`${H}-${F.toString().padStart(2,"0")}`;if(Y!==a){const Z=`This transaction date (${Y}) does not match the current budget month (${a}). Are you sure you want to save it?`;if(!window.confirm(Z))return}const ne=Object.entries(E).filter(([Z,oe])=>oe>0);Promise.all(ne.map(([Z,oe])=>i({amount:oe,description:h,merchant:u||void 0,date:ie.toISOString(),envelopeId:Z,type:_==="income"?"Income":"Expense",reconciled:!1,paymentMethod:C||void 0}).catch(ue=>console.error("Failed to create transaction:",ue)))).catch(Z=>console.error("Failed to create transactions:",Z)),e&&e(),n?n():t("/")}catch(H){console.error("Error saving transaction:",H),alert("Failed to save transaction: "+(H instanceof Error?H.message:"Unknown error"))}},O=[...r].filter(K=>K.isActive!==!1).sort((K,$)=>{const W=K.orderIndex??0,ee=$.orderIndex??0;return W!==ee?W-ee:K.name.localeCompare($.name)}),X=_==="income"?"text-green-500":"text-red-500";return v.jsxs("div",{className:"h-screen overflow-y-auto bg-gray-50 dark:bg-black overscroll-contain",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b border-gray-200 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 z-20 flex items-center justify-between",children:[v.jsx("button",{onClick:N,className:"text-blue-600 dark:text-blue-400 font-medium",children:"Cancel"}),v.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"New Transaction"}),v.jsx("button",{onClick:B,disabled:!V,className:"text-blue-600 dark:text-blue-400 font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:"Save"})]}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto pb-[calc(8rem+env(safe-area-inset-bottom))]",children:v.jsxs("form",{onSubmit:B,className:"space-y-6",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl border border-gray-200 dark:border-zinc-800 overflow-hidden",children:v.jsxs("div",{className:"flex",children:[v.jsx("button",{type:"button",onClick:()=>w("expense"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${_==="expense"?"bg-red-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Expense"}),v.jsx("button",{type:"button",onClick:()=>w("income"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${_==="income"?"bg-green-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Income"})]})}),v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${X}`,children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:s,onChange:K=>{const $=K.target.value.replace(/\D/g,"");if(!$){c("");return}const ee=(parseInt($,10)/100).toFixed(2);c(ee)},onKeyDown:K=>{(K.key==="e"||K.key==="E"||K.key==="+"||K.key==="-")&&K.preventDefault()},placeholder:"0.00",autoFocus:!0,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${X} placeholder-gray-700`})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),v.jsx("input",{type:"text",value:u,onChange:K=>d(K.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsx(f5,{selectedCard:C,onCardSelect:A,isUserSelected:j}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),v.jsx("input",{type:"text",value:h,onChange:K=>p(K.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const[K,$]=m.split("-").map(Number);return`${K}-${$.toString().padStart(2,"0")}`!==a?v.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[v.jsx(td,{size:14}),v.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),v.jsx("input",{type:"date",value:m,onChange:K=>b(K.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 transition-colors",children:v.jsx(Lne,{envelopes:O,transactionAmount:parseFloat(s)||0,onSplitChange:T})})]})})]})},Bne=()=>{const n=Za(),{transactions:e,envelopes:t,updateTransaction:r,deleteTransaction:i,restoreTransaction:a,currentMonth:s,appSettings:c}=an(),{showToast:u}=Vc(),[d,h]=U.useState(!1),[p,m]=U.useState(""),[b,_]=U.useState("all"),[w,E]=U.useState("All"),[T,C]=U.useState(!1),[k,j]=U.useState("all"),[P,N]=U.useState(!1),[A,I]=U.useState("all"),[D,z]=U.useState(!1),[V,B]=U.useState(()=>{const H=new Date;return H.setMonth(H.getMonth()-1),H.toISOString().split("T")[0]}),[O,X]=U.useState(()=>new Date().toISOString().split("T")[0]),[K,$]=U.useState(null),W=U.useMemo(()=>{console.log(" Filtering transactions:",{totalTransactions:e.length,showAllTime:P,currentMonth:s,transactionMonths:e.map(Y=>({id:Y.id,month:Y.month,date:Y.date,description:Y.description}))});let H=e;return P||(H=e.filter(Y=>Y.month===s||!Y.month),console.log(" After month filter:",{remaining:H.length,currentMonth:s,filteredTransactions:H.map(Y=>({id:Y.id,description:Y.description,month:Y.month,matchesCurrentMonth:Y.month===s}))})),H.map(Y=>{if(!Y)return null;let ne=Y.date;if(typeof Y.date=="number"){const oe=(Y.date+978307200)*1e3;ne=new Date(oe).toISOString()}else if(!Y.date||typeof Y.date!="string")return null;return{...Y,date:ne}}).filter(Boolean).filter(Y=>{if(Y.description==="Budgeted"||Y.description==="Piggybank Contribution")return!1;if(p){const Z=p.toLowerCase(),oe=t.find(me=>me.id===Y.envelopeId)?.name.toLowerCase()||"",ue=Y.amount.toFixed(2);if(!(Y.description.toLowerCase().includes(Z)||oe.includes(Z)||ue.includes(Z)))return!1}if(b!=="all"&&Y.envelopeId!==b||w!=="All"&&Y.type!==w||A!=="all"&&(!Y.paymentMethod||Y.paymentMethod.id!==A)||!Y.date||typeof Y.date!="string")return!1;const ne=Y.date.split("T")[0];return!(D&&(ne<V||ne>O)||k!=="all"&&new Date(ne).getMonth()!==parseInt(k)||T&&!Y.reconciled)}).sort((Y,ne)=>new Date(ne.date).getTime()-new Date(Y.date).getTime())},[e,t,p,b,w,A,V,O,T,P,s,D]);console.log(" Final filtered transactions:",{count:W.length,transactions:W.map(H=>({id:H.id,description:H.description,amount:H.amount,date:H.date,month:H.month,type:H.type}))});const ee=K?t.find(H=>H.id===K.envelopeId):null,ie=H=>{const F={...H,reconciled:!H.reconciled};r(F)};return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-[calc(8rem+env(safe-area-inset-bottom))] transition-colors duration-200",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-between shadow-sm",children:[v.jsxs("div",{className:"flex items-center",children:[v.jsx("button",{onClick:()=>n(-1),className:"mr-3 text-gray-600 hover:text-gray-900 dark:text-zinc-400 dark:hover:text-white transition-colors",children:v.jsx(Jo,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"All Transactions"})]}),v.jsx("button",{onClick:()=>h(!d),className:`p-2 rounded-full transition-colors ${d?"bg-blue-100 text-blue-600 dark:bg-blue-900/40 dark:text-blue-400":"text-gray-400 dark:text-zinc-600 hover:bg-gray-100 dark:hover:bg-zinc-800"}`,children:v.jsx(RF,{size:20,className:d?"fill-current":""})})]}),v.jsxs("div",{className:"px-4 py-2 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 flex justify-between items-center",children:[v.jsxs("div",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:["Month: ",s]}),v.jsx("button",{onClick:()=>N(!P),className:`text-sm px-3 py-1 rounded-md ${P?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-800 dark:bg-zinc-800 dark:text-zinc-300"}`,children:P?"Current Month Only":"All Time"})]}),v.jsx("div",{className:"px-4 py-3 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800",children:v.jsxs("div",{className:"relative",children:[v.jsx(WF,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),v.jsx("input",{type:"text",placeholder:"Search transactions...",value:p,onChange:H=>m(H.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none dark:text-white"}),p&&v.jsx("button",{onClick:()=>m(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",children:v.jsx(Uv,{size:16})})]})}),v.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 ${d?"max-h-[600px] opacity-100":"max-h-0 opacity-0"}`,children:v.jsxs("div",{className:"p-4 space-y-4",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Payment Method"}),v.jsxs("select",{value:A,onChange:H=>I(H.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Payment Methods"}),c?.paymentSources?.map(H=>v.jsx("option",{value:H.id,children:H.name},H.id))]})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Envelope"}),v.jsxs("select",{value:b,onChange:H=>_(H.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Envelopes"}),t.sort((H,F)=>H.name.localeCompare(F.name)).map(H=>v.jsx("option",{value:H.id,children:H.name},H.id))]})]}),v.jsx("div",{className:"bg-gray-100 dark:bg-zinc-800 p-1 rounded-lg flex",children:["All","Income","Expense"].map(H=>v.jsx("button",{onClick:()=>E(H),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${w===H?"bg-white dark:bg-zinc-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-zinc-500 hover:text-gray-700"}`,children:H},H))}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Month"}),v.jsxs("select",{value:k,onChange:H=>j(H.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Months"}),Array.from({length:12},(H,F)=>F).map(H=>v.jsx("option",{value:H,children:new Date(2022,H).toLocaleString("default",{month:"long"})},H))]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Date Range"}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("label",{className:"text-xs text-gray-600 dark:text-zinc-400",children:"Enable"}),v.jsx("button",{onClick:()=>z(!D),className:`w-9 h-5 rounded-full transition-colors relative ${D?"bg-blue-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-3 h-3 bg-white rounded-full transition-transform ${D?"translate-x-4":"translate-x-0"}`})})]})]}),v.jsxs("div",{className:`grid grid-cols-2 gap-4 transition-opacity ${D?"opacity-100":"opacity-50 pointer-events-none"}`,children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-[10px] font-medium text-gray-500 dark:text-zinc-500 uppercase",children:"From"}),v.jsx("div",{className:"relative",children:v.jsx("input",{type:"date",value:V,onChange:H=>B(H.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-[10px] font-medium text-gray-500 dark:text-zinc-500 uppercase",children:"To"}),v.jsx("div",{className:"relative",children:v.jsx("input",{type:"date",value:O,onChange:H=>X(H.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]})]})]}),v.jsxs("div",{className:"flex items-center justify-between pt-2",children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show only reconciled"}),v.jsx("button",{onClick:()=>C(!T),className:`w-11 h-6 rounded-full transition-colors relative ${T?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${T?"translate-x-5":"translate-x-0"}`})})]}),v.jsxs("div",{className:"flex items-center justify-between pt-2",children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show all time"}),v.jsx("button",{onClick:()=>N(!P),className:`w-11 h-6 rounded-full transition-colors relative ${P?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${P?"translate-x-5":"translate-x-0"}`})})]})]})}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:W.length===0?v.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-zinc-500",children:"No transactions match your filters."}):v.jsx(di,{initial:!1,mode:"popLayout",children:W.map(H=>{const F=t.find(Y=>Y.id===H.envelopeId);return v.jsx(_n.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(My,{disabled:H.isAutomatic,onDelete:()=>{if(!H.id)return;const Y={...H};i(H.id),u("Transaction deleted","neutral",()=>a(Y))},children:v.jsx(p5,{transaction:H,envelopeName:F?.name||"Unknown Envelope",onReconcile:()=>ie(H),onEdit:()=>{H.isAutomatic||(F?$(H):alert("Cannot edit: Envelope deleted."))}})})},H.id)})})})}),v.jsx(h5,{isVisible:!!K&&!!ee,onClose:()=>$(null),mode:"edit",currentEnvelope:ee||{},initialTransaction:K})]})},Do=({children:n})=>v.jsx(_n.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2,ease:"easeInOut"},className:"w-full h-full bg-gray-50 dark:bg-black",children:n}),Une=()=>{const n=da();return v.jsx(di,{mode:"wait",children:v.jsxs(lU,{location:n,children:[v.jsx(_s,{path:"/",element:v.jsx(Do,{children:v.jsx(Ri,{children:v.jsx(Ine,{})})})}),v.jsx(_s,{path:"/envelope/:id",element:v.jsx(Do,{children:v.jsx(Ri,{children:v.jsx(Pne,{})})})}),v.jsx(_s,{path:"/add-envelope",element:v.jsx(Do,{children:v.jsx(Ri,{children:v.jsx(zne,{})})})}),v.jsx(_s,{path:"/add-transaction",element:v.jsx(Do,{children:v.jsx(Ri,{children:v.jsx(g5,{})})})}),v.jsx(_s,{path:"/transactions",element:v.jsx(Do,{children:v.jsx(Ri,{children:v.jsx(Bne,{})})})}),v.jsx(_s,{path:"/settings",element:v.jsx(Do,{children:v.jsx(Ri,{children:v.jsx(jne,{})})})}),v.jsx(_s,{path:"/settings/categories",element:v.jsx(Do,{children:v.jsx(Ri,{children:v.jsx(Vne,{})})})}),v.jsx(_s,{path:"/verify-email",element:v.jsx(Do,{children:v.jsx(Ri,{children:v.jsx(b4,{})})})})]},n.pathname)})};function Fne(){const[n,e]=U.useState(!0),[t,r]=U.useState(!1),[i,a]=U.useState(null),{appSettings:s,isOnboardingActive:c}=an(),{isAuthenticated:u,isInitialized:d,initializeAuth:h,lastAuthTime:p,offlineGracePeriod:m,currentUser:b}=Mi();if(U.useEffect(()=>{const E=setTimeout(()=>{e(!1)},2e3);return()=>clearTimeout(E)},[]),U.useEffect(()=>h(),[h]),U.useEffect(()=>{(async()=>{const T=new URLSearchParams(window.location.search),C=T.get("mode"),k=T.get("oobCode");if(C==="resetPassword"&&k){console.log(" Processing password reset from URL"),a(k);return}if(C==="verifyEmail"&&k){console.log(" Processing email verification from URL");try{await q9(Ci,k),console.log(" Email verification successful");const j=window.location.pathname;window.history.replaceState({},document.title,j),alert("Email verified successfully! You can now sign in.")}catch(j){console.error(" Email verification failed:",j),alert("Email verification failed. The link may be expired or invalid.")}}})()},[]),U.useEffect(()=>{const E=document.documentElement,T=window.matchMedia("(prefers-color-scheme: dark)"),C=()=>{const k=s?.theme??"system",j=T.matches;k==="dark"||k==="system"&&j?E.classList.add("dark"):E.classList.remove("dark")};if(C(),s?.theme==="system")return T.addEventListener("change",C),()=>T.removeEventListener("change",C)},[s]),U.useEffect(()=>{const E=document.documentElement;switch(s?.fontSize??"medium"){case"extra-small":E.style.fontSize="75%";break;case"small":E.style.fontSize="87.5%";break;case"large":E.style.fontSize="112.5%";break;case"extra-large":E.style.fontSize="125%";break;default:E.style.fontSize="100%"}},[s?.fontSize]),n||!d)return v.jsx(x4,{message:"Initializing Personal Budget..."});if(i)return v.jsx(Ri,{children:v.jsx(lH,{oobCode:i,onSuccess:()=>{a(null);const E=window.location.pathname;window.history.replaceState({},document.title,E)},onCancel:()=>{a(null);const E=window.location.pathname;window.history.replaceState({},document.title,E)}})});if(!u)return b?v.jsx(Ri,{children:v.jsx(b4,{})}):v.jsx(Ri,{children:v.jsx(oH,{})});const w=typeof navigator<"u"&&!navigator.onLine&&u&&p&&Date.now()-p<m;return v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"fixed opacity-0 pointer-events-none -z-50",children:v.jsx("label",{id:"ios-haptic-trigger",htmlFor:"ios-haptic-checkbox",children:v.jsx("input",{type:"checkbox",id:"ios-haptic-checkbox",switch:"true"})})}),v.jsxs(Ri,{children:[w&&v.jsx("div",{className:"bg-yellow-100 dark:bg-yellow-900 border-l-4 border-yellow-500 text-yellow-700 dark:text-yellow-200 p-4",children:v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),v.jsx("div",{className:"ml-3",children:v.jsxs("p",{className:"text-sm",children:[v.jsx("strong",{children:"Offline Access:"})," You're using cached authentication. Expires in"," ",Math.ceil((m-(Date.now()-p))/(1440*60*1e3))," ","days. Connect to internet to refresh."]})})]})}),v.jsxs(MU,{children:[v.jsx(Une,{}),t&&v.jsxs("div",{className:"fixed inset-0 z-[60]",children:[v.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>r(!1)}),v.jsx("div",{className:"absolute inset-0",children:v.jsx(g5,{onClose:()=>r(!1),onSaved:()=>r(!1)})})]}),!c&&v.jsx(YW,{onAddTransaction:()=>r(!0)})]}),v.jsx(HW,{})]})]})}a6({onNeedRefresh(){},onOfflineReady(){console.log("App is ready for offline work")}});n6.createRoot(document.getElementById("root")).render(v.jsx(U.StrictMode,{children:v.jsx(Fne,{})}));export{pt as T,et as a,iH as b,lk as c,_t as d,Er as e,ea as f,n1 as g,ta as h,qd as o,oa as q,si as s,Zl as t,Ma as u,K$ as w};
