(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function t6(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var o1={exports:{}},Kf={};var n2;function n6(){if(n2)return Kf;n2=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,i,a){var o=null;if(a!==void 0&&(o=""+a),i.key!==void 0&&(o=""+i.key),"key"in i){a={};for(var c in i)c!=="key"&&(a[c]=i[c])}else a=i;return i=a.ref,{$$typeof:n,type:r,key:o,ref:i!==void 0?i:null,props:a}}return Kf.Fragment=e,Kf.jsx=t,Kf.jsxs=t,Kf}var r2;function r6(){return r2||(r2=1,o1.exports=n6()),o1.exports}var y=r6(),l1={exports:{}},ft={};var i2;function i6(){if(i2)return ft;i2=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),m=Symbol.iterator;function b(U){return U===null||typeof U!="object"?null:(U=m&&U[m]||U["@@iterator"],typeof U=="function"?U:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function T(U,Y,ne){this.props=U,this.context=Y,this.refs=S,this.updater=ne||_}T.prototype.isReactComponent={},T.prototype.setState=function(U,Y){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,Y,"setState")},T.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function C(){}C.prototype=T.prototype;function R(U,Y,ne){this.props=U,this.context=Y,this.refs=S,this.updater=ne||_}var j=R.prototype=new C;j.constructor=R,w(j,T.prototype),j.isPureReactComponent=!0;var z=Array.isArray;function V(){}var I={H:null,A:null,T:null,S:null},A=Object.prototype.hasOwnProperty;function k(U,Y,ne){var ie=ne.ref;return{$$typeof:n,type:U,key:Y,ref:ie!==void 0?ie:null,props:ne}}function O(U,Y){return k(U.type,Y,U.props)}function L(U){return typeof U=="object"&&U!==null&&U.$$typeof===n}function B(U){var Y={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(ne){return Y[ne]})}var M=/\/+/g;function Q(U,Y){return typeof U=="object"&&U!==null&&U.key!=null?B(""+U.key):Y.toString(36)}function X(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(V,V):(U.status="pending",U.then(function(Y){U.status==="pending"&&(U.status="fulfilled",U.value=Y)},function(Y){U.status==="pending"&&(U.status="rejected",U.reason=Y)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function $(U,Y,ne,ie,te){var se=typeof U;(se==="undefined"||se==="boolean")&&(U=null);var me=!1;if(U===null)me=!0;else switch(se){case"bigint":case"string":case"number":me=!0;break;case"object":switch(U.$$typeof){case n:case e:me=!0;break;case h:return me=U._init,$(me(U._payload),Y,ne,ie,te)}}if(me)return te=te(U),me=ie===""?"."+Q(U,0):ie,z(te)?(ne="",me!=null&&(ne=me.replace(M,"$&/")+"/"),$(te,Y,ne,"",function(Ne){return Ne})):te!=null&&(L(te)&&(te=O(te,ne+(te.key==null||U&&U.key===te.key?"":(""+te.key).replace(M,"$&/")+"/")+me)),Y.push(te)),1;me=0;var Te=ie===""?".":ie+":";if(z(U))for(var Ce=0;Ce<U.length;Ce++)ie=U[Ce],se=Te+Q(ie,Ce),me+=$(ie,Y,ne,se,te);else if(Ce=b(U),typeof Ce=="function")for(U=Ce.call(U),Ce=0;!(ie=U.next()).done;)ie=ie.value,se=Te+Q(ie,Ce++),me+=$(ie,Y,ne,se,te);else if(se==="object"){if(typeof U.then=="function")return $(X(U),Y,ne,ie,te);throw Y=String(U),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.")}return me}function H(U,Y,ne){if(U==null)return U;var ie=[],te=0;return $(U,ie,"","",function(se){return Y.call(ne,se,te++)}),ie}function Z(U){if(U._status===-1){var Y=U._result;Y=Y(),Y.then(function(ne){(U._status===0||U._status===-1)&&(U._status=1,U._result=ne)},function(ne){(U._status===0||U._status===-1)&&(U._status=2,U._result=ne)}),U._status===-1&&(U._status=0,U._result=Y)}if(U._status===1)return U._result.default;throw U._result}var re=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(Y))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},de={map:H,forEach:function(U,Y,ne){H(U,function(){Y.apply(this,arguments)},ne)},count:function(U){var Y=0;return H(U,function(){Y++}),Y},toArray:function(U){return H(U,function(Y){return Y})||[]},only:function(U){if(!L(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return ft.Activity=p,ft.Children=de,ft.Component=T,ft.Fragment=t,ft.Profiler=i,ft.PureComponent=R,ft.StrictMode=r,ft.Suspense=u,ft.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,ft.__COMPILER_RUNTIME={__proto__:null,c:function(U){return I.H.useMemoCache(U)}},ft.cache=function(U){return function(){return U.apply(null,arguments)}},ft.cacheSignal=function(){return null},ft.cloneElement=function(U,Y,ne){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var ie=w({},U.props),te=U.key;if(Y!=null)for(se in Y.key!==void 0&&(te=""+Y.key),Y)!A.call(Y,se)||se==="key"||se==="__self"||se==="__source"||se==="ref"&&Y.ref===void 0||(ie[se]=Y[se]);var se=arguments.length-2;if(se===1)ie.children=ne;else if(1<se){for(var me=Array(se),Te=0;Te<se;Te++)me[Te]=arguments[Te+2];ie.children=me}return k(U.type,te,ie)},ft.createContext=function(U){return U={$$typeof:o,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:a,_context:U},U},ft.createElement=function(U,Y,ne){var ie,te={},se=null;if(Y!=null)for(ie in Y.key!==void 0&&(se=""+Y.key),Y)A.call(Y,ie)&&ie!=="key"&&ie!=="__self"&&ie!=="__source"&&(te[ie]=Y[ie]);var me=arguments.length-2;if(me===1)te.children=ne;else if(1<me){for(var Te=Array(me),Ce=0;Ce<me;Ce++)Te[Ce]=arguments[Ce+2];te.children=Te}if(U&&U.defaultProps)for(ie in me=U.defaultProps,me)te[ie]===void 0&&(te[ie]=me[ie]);return k(U,se,te)},ft.createRef=function(){return{current:null}},ft.forwardRef=function(U){return{$$typeof:c,render:U}},ft.isValidElement=L,ft.lazy=function(U){return{$$typeof:h,_payload:{_status:-1,_result:U},_init:Z}},ft.memo=function(U,Y){return{$$typeof:d,type:U,compare:Y===void 0?null:Y}},ft.startTransition=function(U){var Y=I.T,ne={};I.T=ne;try{var ie=U(),te=I.S;te!==null&&te(ne,ie),typeof ie=="object"&&ie!==null&&typeof ie.then=="function"&&ie.then(V,re)}catch(se){re(se)}finally{Y!==null&&ne.types!==null&&(Y.types=ne.types),I.T=Y}},ft.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},ft.use=function(U){return I.H.use(U)},ft.useActionState=function(U,Y,ne){return I.H.useActionState(U,Y,ne)},ft.useCallback=function(U,Y){return I.H.useCallback(U,Y)},ft.useContext=function(U){return I.H.useContext(U)},ft.useDebugValue=function(){},ft.useDeferredValue=function(U,Y){return I.H.useDeferredValue(U,Y)},ft.useEffect=function(U,Y){return I.H.useEffect(U,Y)},ft.useEffectEvent=function(U){return I.H.useEffectEvent(U)},ft.useId=function(){return I.H.useId()},ft.useImperativeHandle=function(U,Y,ne){return I.H.useImperativeHandle(U,Y,ne)},ft.useInsertionEffect=function(U,Y){return I.H.useInsertionEffect(U,Y)},ft.useLayoutEffect=function(U,Y){return I.H.useLayoutEffect(U,Y)},ft.useMemo=function(U,Y){return I.H.useMemo(U,Y)},ft.useOptimistic=function(U,Y){return I.H.useOptimistic(U,Y)},ft.useReducer=function(U,Y,ne){return I.H.useReducer(U,Y,ne)},ft.useRef=function(U){return I.H.useRef(U)},ft.useState=function(U){return I.H.useState(U)},ft.useSyncExternalStore=function(U,Y,ne){return I.H.useSyncExternalStore(U,Y,ne)},ft.useTransition=function(){return I.H.useTransition()},ft.version="19.2.0",ft}var a2;function Q_(){return a2||(a2=1,l1.exports=i6()),l1.exports}var F=Q_();const _m=t6(F);var c1={exports:{}},Xf={},u1={exports:{}},d1={};var s2;function a6(){return s2||(s2=1,(function(n){function e($,H){var Z=$.length;$.push(H);e:for(;0<Z;){var re=Z-1>>>1,de=$[re];if(0<i(de,H))$[re]=H,$[Z]=de,Z=re;else break e}}function t($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var H=$[0],Z=$.pop();if(Z!==H){$[0]=Z;e:for(var re=0,de=$.length,U=de>>>1;re<U;){var Y=2*(re+1)-1,ne=$[Y],ie=Y+1,te=$[ie];if(0>i(ne,Z))ie<de&&0>i(te,ne)?($[re]=te,$[ie]=Z,re=ie):($[re]=ne,$[Y]=Z,re=Y);else if(ie<de&&0>i(te,Z))$[re]=te,$[ie]=Z,re=ie;else break e}}return H}function i($,H){var Z=$.sortIndex-H.sortIndex;return Z!==0?Z:$.id-H.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();n.unstable_now=function(){return o.now()-c}}var u=[],d=[],h=1,p=null,m=3,b=!1,_=!1,w=!1,S=!1,T=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function j($){for(var H=t(d);H!==null;){if(H.callback===null)r(d);else if(H.startTime<=$)r(d),H.sortIndex=H.expirationTime,e(u,H);else break;H=t(d)}}function z($){if(w=!1,j($),!_)if(t(u)!==null)_=!0,V||(V=!0,B());else{var H=t(d);H!==null&&X(z,H.startTime-$)}}var V=!1,I=-1,A=5,k=-1;function O(){return S?!0:!(n.unstable_now()-k<A)}function L(){if(S=!1,V){var $=n.unstable_now();k=$;var H=!0;try{e:{_=!1,w&&(w=!1,C(I),I=-1),b=!0;var Z=m;try{t:{for(j($),p=t(u);p!==null&&!(p.expirationTime>$&&O());){var re=p.callback;if(typeof re=="function"){p.callback=null,m=p.priorityLevel;var de=re(p.expirationTime<=$);if($=n.unstable_now(),typeof de=="function"){p.callback=de,j($),H=!0;break t}p===t(u)&&r(u),j($)}else r(u);p=t(u)}if(p!==null)H=!0;else{var U=t(d);U!==null&&X(z,U.startTime-$),H=!1}}break e}finally{p=null,m=Z,b=!1}H=void 0}}finally{H?B():V=!1}}}var B;if(typeof R=="function")B=function(){R(L)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,Q=M.port2;M.port1.onmessage=L,B=function(){Q.postMessage(null)}}else B=function(){T(L,0)};function X($,H){I=T(function(){$(n.unstable_now())},H)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function($){switch(m){case 1:case 2:case 3:var H=3;break;default:H=m}var Z=m;m=H;try{return $()}finally{m=Z}},n.unstable_requestPaint=function(){S=!0},n.unstable_runWithPriority=function($,H){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var Z=m;m=$;try{return H()}finally{m=Z}},n.unstable_scheduleCallback=function($,H,Z){var re=n.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?re+Z:re):Z=re,$){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=Z+de,$={id:h++,callback:H,priorityLevel:$,startTime:Z,expirationTime:de,sortIndex:-1},Z>re?($.sortIndex=Z,e(d,$),t(u)===null&&$===t(d)&&(w?(C(I),I=-1):w=!0,X(z,Z-re))):($.sortIndex=de,e(u,$),_||b||(_=!0,V||(V=!0,B()))),$},n.unstable_shouldYield=O,n.unstable_wrapCallback=function($){var H=m;return function(){var Z=m;m=H;try{return $.apply(this,arguments)}finally{m=Z}}}})(d1)),d1}var o2;function s6(){return o2||(o2=1,u1.exports=a6()),u1.exports}var f1={exports:{}},Ir={};var l2;function o6(){if(l2)return Ir;l2=1;var n=Q_();function e(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)d+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(u,d,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:p==null?null:""+p,children:u,containerInfo:d,implementation:h}}var o=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Ir.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Ir.createPortal=function(u,d){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return a(u,d,null,h)},Ir.flushSync=function(u){var d=o.T,h=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=d,r.p=h,r.d.f()}},Ir.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(u,d))},Ir.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},Ir.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin),m=typeof d.integrity=="string"?d.integrity:void 0,b=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;h==="style"?r.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:b}):h==="script"&&r.d.X(u,{crossOrigin:p,integrity:m,fetchPriority:b,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Ir.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var h=c(d.as,d.crossOrigin);r.d.M(u,{crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(u)},Ir.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin);r.d.L(u,h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Ir.preloadModule=function(u,d){if(typeof u=="string")if(d){var h=c(d.as,d.crossOrigin);r.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(u)},Ir.requestFormReset=function(u){r.d.r(u)},Ir.unstable_batchedUpdates=function(u,d){return u(d)},Ir.useFormState=function(u,d,h){return o.H.useFormState(u,d,h)},Ir.useFormStatus=function(){return o.H.useHostTransitionStatus()},Ir.version="19.2.0",Ir}var c2;function l6(){if(c2)return f1.exports;c2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),f1.exports=o6(),f1.exports}var u2;function c6(){if(u2)return Xf;u2=1;var n=s6(),e=Q_(),t=l6();function r(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var l=s,f=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(f=l.return),s=l.return;while(s)}return l.tag===3?f:null}function o(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function c(s){if(s.tag===31){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function u(s){if(a(s)!==s)throw Error(r(188))}function d(s){var l=s.alternate;if(!l){if(l=a(s),l===null)throw Error(r(188));return l!==s?null:s}for(var f=s,g=l;;){var x=f.return;if(x===null)break;var E=x.alternate;if(E===null){if(g=x.return,g!==null){f=g;continue}break}if(x.child===E.child){for(E=x.child;E;){if(E===f)return u(x),s;if(E===g)return u(x),l;E=E.sibling}throw Error(r(188))}if(f.return!==g.return)f=x,g=E;else{for(var N=!1,G=x.child;G;){if(G===f){N=!0,f=x,g=E;break}if(G===g){N=!0,g=x,f=E;break}G=G.sibling}if(!N){for(G=E.child;G;){if(G===f){N=!0,f=E,g=x;break}if(G===g){N=!0,g=E,f=x;break}G=G.sibling}if(!N)throw Error(r(189))}}if(f.alternate!==g)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?s:l}function h(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=h(s),l!==null)return l;s=s.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),R=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),V=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function B(s){return s===null||typeof s!="object"?null:(s=L&&s[L]||s["@@iterator"],typeof s=="function"?s:null)}var M=Symbol.for("react.client.reference");function Q(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===M?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case w:return"Fragment";case T:return"Profiler";case S:return"StrictMode";case z:return"Suspense";case V:return"SuspenseList";case k:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case _:return"Portal";case R:return s.displayName||"Context";case C:return(s._context.displayName||"Context")+".Consumer";case j:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case I:return l=s.displayName||null,l!==null?l:Q(s.type)||"Memo";case A:l=s._payload,s=s._init;try{return Q(s(l))}catch{}}return null}var X=Array.isArray,$=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z={pending:!1,data:null,method:null,action:null},re=[],de=-1;function U(s){return{current:s}}function Y(s){0>de||(s.current=re[de],re[de]=null,de--)}function ne(s,l){de++,re[de]=s.current,s.current=l}var ie=U(null),te=U(null),se=U(null),me=U(null);function Te(s,l){switch(ne(se,l),ne(te,s),ne(ie,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?TC(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=TC(l),s=AC(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}Y(ie),ne(ie,s)}function Ce(){Y(ie),Y(te),Y(se)}function Ne(s){s.memoizedState!==null&&ne(me,s);var l=ie.current,f=AC(l,s.type);l!==f&&(ne(te,s),ne(ie,f))}function xe(s){te.current===s&&(Y(ie),Y(te)),me.current===s&&(Y(me),qf._currentValue=Z)}var Ee,Qe;function Oe(s){if(Ee===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);Ee=l&&l[1]||"",Qe=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ee+s+Qe}var Be=!1;function ze(s,l){if(!s||Be)return"";Be=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(l){var be=function(){throw Error()};if(Object.defineProperty(be.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(be,[])}catch(pe){var fe=pe}Reflect.construct(s,[],be)}else{try{be.call()}catch(pe){fe=pe}s.call(be.prototype)}}else{try{throw Error()}catch(pe){fe=pe}(be=s())&&typeof be.catch=="function"&&be.catch(function(){})}}catch(pe){if(pe&&fe&&typeof pe.stack=="string")return[pe.stack,fe.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=g.DetermineComponentFrameRoot(),N=E[0],G=E[1];if(N&&G){var K=N.split(`
`),ue=G.split(`
`);for(x=g=0;g<K.length&&!K[g].includes("DetermineComponentFrameRoot");)g++;for(;x<ue.length&&!ue[x].includes("DetermineComponentFrameRoot");)x++;if(g===K.length||x===ue.length)for(g=K.length-1,x=ue.length-1;1<=g&&0<=x&&K[g]!==ue[x];)x--;for(;1<=g&&0<=x;g--,x--)if(K[g]!==ue[x]){if(g!==1||x!==1)do if(g--,x--,0>x||K[g]!==ue[x]){var ve=`
`+K[g].replace(" at new "," at ");return s.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",s.displayName)),ve}while(1<=g&&0<=x);break}}}finally{Be=!1,Error.prepareStackTrace=f}return(f=s?s.displayName||s.name:"")?Oe(f):""}function st(s,l){switch(s.tag){case 26:case 27:case 5:return Oe(s.type);case 16:return Oe("Lazy");case 13:return s.child!==l&&l!==null?Oe("Suspense Fallback"):Oe("Suspense");case 19:return Oe("SuspenseList");case 0:case 15:return ze(s.type,!1);case 11:return ze(s.type.render,!1);case 1:return ze(s.type,!0);case 31:return Oe("Activity");default:return""}}function yt(s){try{var l="",f=null;do l+=st(s,f),f=s,s=s.return;while(s);return l}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var Ve=Object.prototype.hasOwnProperty,Ke=n.unstable_scheduleCallback,Mt=n.unstable_cancelCallback,vn=n.unstable_shouldYield,dn=n.unstable_requestPaint,bt=n.unstable_now,Lt=n.unstable_getCurrentPriorityLevel,Cr=n.unstable_ImmediatePriority,Qn=n.unstable_UserBlockingPriority,Yr=n.unstable_NormalPriority,ls=n.unstable_LowPriority,Zs=n.unstable_IdlePriority,Zi=n.log,_a=n.unstable_setDisableYieldValue,jr=null,yn=null;function cr(s){if(typeof Zi=="function"&&_a(s),yn&&typeof yn.setStrictMode=="function")try{yn.setStrictMode(jr,s)}catch{}}var en=Math.clz32?Math.clz32:Me,Js=Math.log,ke=Math.LN2;function Me(s){return s>>>=0,s===0?32:31-(Js(s)/ke|0)|0}var dt=256,Xe=262144,Ze=4194304;function Tn(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Jt(s,l,f){var g=s.pendingLanes;if(g===0)return 0;var x=0,E=s.suspendedLanes,N=s.pingedLanes;s=s.warmLanes;var G=g&134217727;return G!==0?(g=G&~E,g!==0?x=Tn(g):(N&=G,N!==0?x=Tn(N):f||(f=G&~s,f!==0&&(x=Tn(f))))):(G=g&~E,G!==0?x=Tn(G):N!==0?x=Tn(N):f||(f=g&~s,f!==0&&(x=Tn(f)))),x===0?0:l!==0&&l!==x&&(l&E)===0&&(E=x&-x,f=l&-l,E>=f||E===32&&(f&4194048)!==0)?l:x}function nt(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function An(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rt(){var s=Ze;return Ze<<=1,(Ze&62914560)===0&&(Ze=4194304),s}function St(s){for(var l=[],f=0;31>f;f++)l.push(s);return l}function Cn(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function fn(s,l,f,g,x,E){var N=s.pendingLanes;s.pendingLanes=f,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=f,s.entangledLanes&=f,s.errorRecoveryDisabledLanes&=f,s.shellSuspendCounter=0;var G=s.entanglements,K=s.expirationTimes,ue=s.hiddenUpdates;for(f=N&~f;0<f;){var ve=31-en(f),be=1<<ve;G[ve]=0,K[ve]=-1;var fe=ue[ve];if(fe!==null)for(ue[ve]=null,ve=0;ve<fe.length;ve++){var pe=fe[ve];pe!==null&&(pe.lane&=-536870913)}f&=~be}g!==0&&xt(s,g,0),E!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=E&~(N&~l))}function xt(s,l,f){s.pendingLanes|=l,s.suspendedLanes&=~l;var g=31-en(l);s.entangledLanes|=l,s.entanglements[g]=s.entanglements[g]|1073741824|f&261930}function In(s,l){var f=s.entangledLanes|=l;for(s=s.entanglements;f;){var g=31-en(f),x=1<<g;x&l|s[g]&l&&(s[g]|=l),f&=~x}}function Zn(s,l){var f=l&-l;return f=(f&42)!==0?1:li(f),(f&(s.suspendedLanes|l))!==0?0:f}function li(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Jn(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Si(){var s=H.p;return s!==0?s:(s=window.event,s===void 0?32:XC(s.type))}function Rn(s,l){var f=H.p;try{return H.p=s,l()}finally{H.p=f}}var Ji=Math.random().toString(36).slice(2),jn="__reactFiber$"+Ji,ur="__reactProps$"+Ji,wa="__reactContainer$"+Ji,Uc="__reactEvents$"+Ji,hy="__reactListeners$"+Ji,eg="__reactHandles$"+Ji,tg="__reactResources$"+Ji,Ea="__reactMarker$"+Ji;function Fc(s){delete s[jn],delete s[ur],delete s[Uc],delete s[hy],delete s[eg]}function Sa(s){var l=s[jn];if(l)return l;for(var f=s.parentNode;f;){if(l=f[wa]||f[jn]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(s=MC(s);s!==null;){if(f=s[jn])return f;s=MC(s)}return l}s=f,f=s.parentNode}return null}function Ti(s){if(s=s[jn]||s[wa]){var l=s.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return s}return null}function ci(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(r(33))}function Ta(s){var l=s[tg];return l||(l=s[tg]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function zn(s){s[Ea]=!0}var Wd=new Set,Qd={};function Aa(s,l){Ca(s,l),Ca(s+"Capture",l)}function Ca(s,l){for(Qd[s]=l,s=0;s<l.length;s++)Wd.add(l[s])}var Zd=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Jd={},ef={};function ng(s){return Ve.call(ef,s)?!0:Ve.call(Jd,s)?!1:Zd.test(s)?ef[s]=!0:(Jd[s]=!0,!1)}function Gc(s,l,f){if(ng(l))if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var g=l.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+f)}}function ui(s,l,f){if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+f)}}function Ln(s,l,f,g){if(g===null)s.removeAttribute(f);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(f);return}s.setAttributeNS(l,f,""+g)}}function dr(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function eo(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function tf(s,l,f){var g=Object.getOwnPropertyDescriptor(s.constructor.prototype,l);if(!s.hasOwnProperty(l)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var x=g.get,E=g.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return x.call(this)},set:function(N){f=""+N,E.call(this,N)}}),Object.defineProperty(s,l,{enumerable:g.enumerable}),{getValue:function(){return f},setValue:function(N){f=""+N},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function Bt(s){if(!s._valueTracker){var l=eo(s)?"checked":"value";s._valueTracker=tf(s,l,""+s[l])}}function xl(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var f=l.getValue(),g="";return s&&(g=eo(s)?s.checked?"true":"false":s.value),s=g,s!==f?(l.setValue(s),!0):!1}function Ia(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var _l=/[\n"\\]/g;function Kr(s){return s.replace(_l,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function qc(s,l,f,g,x,E,N,G){s.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.type=N:s.removeAttribute("type"),l!=null?N==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+dr(l)):s.value!==""+dr(l)&&(s.value=""+dr(l)):N!=="submit"&&N!=="reset"||s.removeAttribute("value"),l!=null?nf(s,N,dr(l)):f!=null?nf(s,N,dr(f)):g!=null&&s.removeAttribute("value"),x==null&&E!=null&&(s.defaultChecked=!!E),x!=null&&(s.checked=x&&typeof x!="function"&&typeof x!="symbol"),G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"?s.name=""+dr(G):s.removeAttribute("name")}function rg(s,l,f,g,x,E,N,G){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(s.type=E),l!=null||f!=null){if(!(E!=="submit"&&E!=="reset"||l!=null)){Bt(s);return}f=f!=null?""+dr(f):"",l=l!=null?""+dr(l):f,G||l===s.value||(s.value=l),s.defaultValue=l}g=g??x,g=typeof g!="function"&&typeof g!="symbol"&&!!g,s.checked=G?s.checked:!!g,s.defaultChecked=!!g,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(s.name=N),Bt(s)}function nf(s,l,f){l==="number"&&Ia(s.ownerDocument)===s||s.defaultValue===""+f||(s.defaultValue=""+f)}function to(s,l,f,g){if(s=s.options,l){l={};for(var x=0;x<f.length;x++)l["$"+f[x]]=!0;for(f=0;f<s.length;f++)x=l.hasOwnProperty("$"+s[f].value),s[f].selected!==x&&(s[f].selected=x),x&&g&&(s[f].defaultSelected=!0)}else{for(f=""+dr(f),l=null,x=0;x<s.length;x++){if(s[x].value===f){s[x].selected=!0,g&&(s[x].defaultSelected=!0);return}l!==null||s[x].disabled||(l=s[x])}l!==null&&(l.selected=!0)}}function ig(s,l,f){if(l!=null&&(l=""+dr(l),l!==s.value&&(s.value=l),f==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=f!=null?""+dr(f):""}function no(s,l,f,g){if(l==null){if(g!=null){if(f!=null)throw Error(r(92));if(X(g)){if(1<g.length)throw Error(r(93));g=g[0]}f=g}f==null&&(f=""),l=f}f=dr(l),s.defaultValue=f,g=s.textContent,g===f&&g!==""&&g!==null&&(s.value=g),Bt(s)}function Xr(s,l){if(l){var f=s.firstChild;if(f&&f===s.lastChild&&f.nodeType===3){f.nodeValue=l;return}}s.textContent=l}var ag=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function rf(s,l,f){var g=l.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?g?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":g?s.setProperty(l,f):typeof f!="number"||f===0||ag.has(l)?l==="float"?s.cssFloat=f:s[l]=(""+f).trim():s[l]=f+"px"}function af(s,l,f){if(l!=null&&typeof l!="object")throw Error(r(62));if(s=s.style,f!=null){for(var g in f)!f.hasOwnProperty(g)||l!=null&&l.hasOwnProperty(g)||(g.indexOf("--")===0?s.setProperty(g,""):g==="float"?s.cssFloat="":s[g]="");for(var x in l)g=l[x],l.hasOwnProperty(x)&&f[x]!==g&&rf(s,x,g)}else for(var E in l)l.hasOwnProperty(E)&&rf(s,E,l[E])}function Hc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sg=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ro=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function $c(s){return ro.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function ea(){}var sf=null;function Ai(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var io=null,Ra=null;function wl(s){var l=Ti(s);if(l&&(s=l.stateNode)){var f=s[ur]||null;e:switch(s=l.stateNode,l.type){case"input":if(qc(s,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),l=f.name,f.type==="radio"&&l!=null){for(f=s;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Kr(""+l)+'"][type="radio"]'),l=0;l<f.length;l++){var g=f[l];if(g!==s&&g.form===s.form){var x=g[ur]||null;if(!x)throw Error(r(90));qc(g,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(l=0;l<f.length;l++)g=f[l],g.form===s.form&&xl(g)}break e;case"textarea":ig(s,f.value,f.defaultValue);break e;case"select":l=f.value,l!=null&&to(s,!!f.multiple,l,!1)}}}var Yc=!1;function ao(s,l,f){if(Yc)return s(l,f);Yc=!0;try{var g=s(l);return g}finally{if(Yc=!1,(io!==null||Ra!==null)&&(Jg(),io&&(l=io,s=Ra,Ra=io=null,wl(l),s)))for(l=0;l<s.length;l++)wl(s[l])}}function ta(s,l){var f=s.stateNode;if(f===null)return null;var g=f[ur]||null;if(g===null)return null;f=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(s=s.type,g=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!g;break e;default:s=!1}if(s)return null;if(f&&typeof f!="function")throw Error(r(231,l,typeof f));return f}var Ci=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),El=!1;if(Ci)try{var Ht={};Object.defineProperty(Ht,"passive",{get:function(){El=!0}}),window.addEventListener("test",Ht,Ht),window.removeEventListener("test",Ht,Ht)}catch{El=!1}var Da=null,of=null,Sl=null;function lf(){if(Sl)return Sl;var s,l=of,f=l.length,g,x="value"in Da?Da.value:Da.textContent,E=x.length;for(s=0;s<f&&l[s]===x[s];s++);var N=f-s;for(g=1;g<=N&&l[f-g]===x[E-g];g++);return Sl=x.slice(s,1<g?1-g:void 0)}function Tl(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function cs(){return!0}function na(){return!1}function vr(s){function l(f,g,x,E,N){this._reactName=f,this._targetInst=x,this.type=g,this.nativeEvent=E,this.target=N,this.currentTarget=null;for(var G in s)s.hasOwnProperty(G)&&(f=s[G],this[G]=f?f(E):E[G]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?cs:na,this.isPropagationStopped=na,this}return p(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=cs)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=cs)},persist:function(){},isPersistent:cs}),l}var us={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ka=vr(us),so=p({},us,{view:0,detail:0}),cf=vr(so),oo,Kc,Na,Xc=p({},so,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lo,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Na&&(Na&&s.type==="mousemove"?(oo=s.screenX-Na.screenX,Kc=s.screenY-Na.screenY):Kc=oo=0,Na=s),oo)},movementY:function(s){return"movementY"in s?s.movementY:Kc}}),uf=vr(Xc),Al=p({},Xc,{dataTransfer:0}),og=vr(Al),lg=p({},so,{relatedTarget:0}),Cl=vr(lg),df=p({},us,{animationName:0,elapsedTime:0,pseudoElement:0}),cg=vr(df),Wc=p({},us,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),ug=vr(Wc),dg=p({},us,{data:0}),Ma=vr(dg),fg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gg(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=pg[s])?!!l[s]:!1}function lo(){return gg}var zr=p({},so,{key:function(s){if(s.key){var l=fg[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=Tl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?hg[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lo,charCode:function(s){return s.type==="keypress"?Tl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Tl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),mg=vr(zr),vg=p({},Xc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ds=vr(vg),v=p({},so,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lo}),D=vr(v),P=p({},us,{propertyName:0,elapsedTime:0,pseudoElement:0}),q=vr(P),le=p({},Xc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),he=vr(le),Re=p({},us,{newState:0,oldState:0}),ht=vr(Re),Dn=[9,13,27,32],Vt=Ci&&"CompositionEvent"in window,sn=null;Ci&&"documentMode"in document&&(sn=document.documentMode);var Ii=Ci&&"TextEvent"in window&&!sn,Pa=Ci&&(!Vt||sn&&8<sn&&11>=sn),ra=" ",ia=!1;function Il(s,l){switch(s){case"keyup":return Dn.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qc(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Zc=!1;function T5(s,l){switch(s){case"compositionend":return Qc(l);case"keypress":return l.which!==32?null:(ia=!0,ra);case"textInput":return s=l.data,s===ra&&ia?null:s;default:return null}}function A5(s,l){if(Zc)return s==="compositionend"||!Vt&&Il(s,l)?(s=lf(),Sl=of=Da=null,Zc=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Pa&&l.locale!=="ko"?null:l.data;default:return null}}var C5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function VS(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!C5[s.type]:l==="textarea"}function jS(s,l,f,g){io?Ra?Ra.push(g):Ra=[g]:io=g,l=sm(l,"onChange"),0<l.length&&(f=new ka("onChange","change",null,f,g),s.push({event:f,listeners:l}))}var ff=null,hf=null;function I5(s){bC(s,0)}function yg(s){var l=ci(s);if(xl(l))return s}function zS(s,l){if(s==="change")return l}var LS=!1;if(Ci){var py;if(Ci){var gy="oninput"in document;if(!gy){var BS=document.createElement("div");BS.setAttribute("oninput","return;"),gy=typeof BS.oninput=="function"}py=gy}else py=!1;LS=py&&(!document.documentMode||9<document.documentMode)}function US(){ff&&(ff.detachEvent("onpropertychange",FS),hf=ff=null)}function FS(s){if(s.propertyName==="value"&&yg(hf)){var l=[];jS(l,hf,s,Ai(s)),ao(I5,l)}}function R5(s,l,f){s==="focusin"?(US(),ff=l,hf=f,ff.attachEvent("onpropertychange",FS)):s==="focusout"&&US()}function D5(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return yg(hf)}function k5(s,l){if(s==="click")return yg(l)}function N5(s,l){if(s==="input"||s==="change")return yg(l)}function M5(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var di=typeof Object.is=="function"?Object.is:M5;function pf(s,l){if(di(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var f=Object.keys(s),g=Object.keys(l);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var x=f[g];if(!Ve.call(l,x)||!di(s[x],l[x]))return!1}return!0}function GS(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function qS(s,l){var f=GS(s);s=0;for(var g;f;){if(f.nodeType===3){if(g=s+f.textContent.length,s<=l&&g>=l)return{node:f,offset:l-s};s=g}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=GS(f)}}function HS(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?HS(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function $S(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=Ia(s.document);l instanceof s.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)s=l.contentWindow;else break;l=Ia(s.document)}return l}function my(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var P5=Ci&&"documentMode"in document&&11>=document.documentMode,Jc=null,vy=null,gf=null,yy=!1;function YS(s,l,f){var g=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;yy||Jc==null||Jc!==Ia(g)||(g=Jc,"selectionStart"in g&&my(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),gf&&pf(gf,g)||(gf=g,g=sm(vy,"onSelect"),0<g.length&&(l=new ka("onSelect","select",null,l,f),s.push({event:l,listeners:g}),l.target=Jc)))}function Rl(s,l){var f={};return f[s.toLowerCase()]=l.toLowerCase(),f["Webkit"+s]="webkit"+l,f["Moz"+s]="moz"+l,f}var eu={animationend:Rl("Animation","AnimationEnd"),animationiteration:Rl("Animation","AnimationIteration"),animationstart:Rl("Animation","AnimationStart"),transitionrun:Rl("Transition","TransitionRun"),transitionstart:Rl("Transition","TransitionStart"),transitioncancel:Rl("Transition","TransitionCancel"),transitionend:Rl("Transition","TransitionEnd")},by={},KS={};Ci&&(KS=document.createElement("div").style,"AnimationEvent"in window||(delete eu.animationend.animation,delete eu.animationiteration.animation,delete eu.animationstart.animation),"TransitionEvent"in window||delete eu.transitionend.transition);function Dl(s){if(by[s])return by[s];if(!eu[s])return s;var l=eu[s],f;for(f in l)if(l.hasOwnProperty(f)&&f in KS)return by[s]=l[f];return s}var XS=Dl("animationend"),WS=Dl("animationiteration"),QS=Dl("animationstart"),O5=Dl("transitionrun"),V5=Dl("transitionstart"),j5=Dl("transitioncancel"),ZS=Dl("transitionend"),JS=new Map,xy="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");xy.push("scrollEnd");function aa(s,l){JS.set(s,l),Aa(l,[s])}var bg=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Ri=[],tu=0,_y=0;function xg(){for(var s=tu,l=_y=tu=0;l<s;){var f=Ri[l];Ri[l++]=null;var g=Ri[l];Ri[l++]=null;var x=Ri[l];Ri[l++]=null;var E=Ri[l];if(Ri[l++]=null,g!==null&&x!==null){var N=g.pending;N===null?x.next=x:(x.next=N.next,N.next=x),g.pending=x}E!==0&&eT(f,x,E)}}function _g(s,l,f,g){Ri[tu++]=s,Ri[tu++]=l,Ri[tu++]=f,Ri[tu++]=g,_y|=g,s.lanes|=g,s=s.alternate,s!==null&&(s.lanes|=g)}function wy(s,l,f,g){return _g(s,l,f,g),wg(s)}function kl(s,l){return _g(s,null,null,l),wg(s)}function eT(s,l,f){s.lanes|=f;var g=s.alternate;g!==null&&(g.lanes|=f);for(var x=!1,E=s.return;E!==null;)E.childLanes|=f,g=E.alternate,g!==null&&(g.childLanes|=f),E.tag===22&&(s=E.stateNode,s===null||s._visibility&1||(x=!0)),s=E,E=E.return;return s.tag===3?(E=s.stateNode,x&&l!==null&&(x=31-en(f),s=E.hiddenUpdates,g=s[x],g===null?s[x]=[l]:g.push(l),l.lane=f|536870912),E):null}function wg(s){if(50<jf)throw jf=0,kb=null,Error(r(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var nu={};function z5(s,l,f,g){this.tag=s,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fi(s,l,f,g){return new z5(s,l,f,g)}function Ey(s){return s=s.prototype,!(!s||!s.isReactComponent)}function fs(s,l){var f=s.alternate;return f===null?(f=fi(s.tag,l,s.key,s.mode),f.elementType=s.elementType,f.type=s.type,f.stateNode=s.stateNode,f.alternate=s,s.alternate=f):(f.pendingProps=l,f.type=s.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=s.flags&65011712,f.childLanes=s.childLanes,f.lanes=s.lanes,f.child=s.child,f.memoizedProps=s.memoizedProps,f.memoizedState=s.memoizedState,f.updateQueue=s.updateQueue,l=s.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=s.sibling,f.index=s.index,f.ref=s.ref,f.refCleanup=s.refCleanup,f}function tT(s,l){s.flags&=65011714;var f=s.alternate;return f===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=f.childLanes,s.lanes=f.lanes,s.child=f.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=f.memoizedProps,s.memoizedState=f.memoizedState,s.updateQueue=f.updateQueue,s.type=f.type,l=f.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function Eg(s,l,f,g,x,E){var N=0;if(g=s,typeof s=="function")Ey(s)&&(N=1);else if(typeof s=="string")N=Gj(s,f,ie.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case k:return s=fi(31,f,l,x),s.elementType=k,s.lanes=E,s;case w:return Nl(f.children,x,E,l);case S:N=8,x|=24;break;case T:return s=fi(12,f,l,x|2),s.elementType=T,s.lanes=E,s;case z:return s=fi(13,f,l,x),s.elementType=z,s.lanes=E,s;case V:return s=fi(19,f,l,x),s.elementType=V,s.lanes=E,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case R:N=10;break e;case C:N=9;break e;case j:N=11;break e;case I:N=14;break e;case A:N=16,g=null;break e}N=29,f=Error(r(130,s===null?"null":typeof s,"")),g=null}return l=fi(N,f,l,x),l.elementType=s,l.type=g,l.lanes=E,l}function Nl(s,l,f,g){return s=fi(7,s,g,l),s.lanes=f,s}function Sy(s,l,f){return s=fi(6,s,null,l),s.lanes=f,s}function nT(s){var l=fi(18,null,null,0);return l.stateNode=s,l}function Ty(s,l,f){return l=fi(4,s.children!==null?s.children:[],s.key,l),l.lanes=f,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var rT=new WeakMap;function Di(s,l){if(typeof s=="object"&&s!==null){var f=rT.get(s);return f!==void 0?f:(l={value:s,source:l,stack:yt(l)},rT.set(s,l),l)}return{value:s,source:l,stack:yt(l)}}var ru=[],iu=0,Sg=null,mf=0,ki=[],Ni=0,co=null,Oa=1,Va="";function hs(s,l){ru[iu++]=mf,ru[iu++]=Sg,Sg=s,mf=l}function iT(s,l,f){ki[Ni++]=Oa,ki[Ni++]=Va,ki[Ni++]=co,co=s;var g=Oa;s=Va;var x=32-en(g)-1;g&=~(1<<x),f+=1;var E=32-en(l)+x;if(30<E){var N=x-x%5;E=(g&(1<<N)-1).toString(32),g>>=N,x-=N,Oa=1<<32-en(l)+x|f<<x|g,Va=E+s}else Oa=1<<E|f<<x|g,Va=s}function Ay(s){s.return!==null&&(hs(s,1),iT(s,1,0))}function Cy(s){for(;s===Sg;)Sg=ru[--iu],ru[iu]=null,mf=ru[--iu],ru[iu]=null;for(;s===co;)co=ki[--Ni],ki[Ni]=null,Va=ki[--Ni],ki[Ni]=null,Oa=ki[--Ni],ki[Ni]=null}function aT(s,l){ki[Ni++]=Oa,ki[Ni++]=Va,ki[Ni++]=co,Oa=l.id,Va=l.overflow,co=s}var yr=null,tn=null,Dt=!1,uo=null,Mi=!1,Iy=Error(r(519));function fo(s){var l=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw vf(Di(l,s)),Iy}function sT(s){var l=s.stateNode,f=s.type,g=s.memoizedProps;switch(l[jn]=s,l[ur]=g,f){case"dialog":Et("cancel",l),Et("close",l);break;case"iframe":case"object":case"embed":Et("load",l);break;case"video":case"audio":for(f=0;f<Lf.length;f++)Et(Lf[f],l);break;case"source":Et("error",l);break;case"img":case"image":case"link":Et("error",l),Et("load",l);break;case"details":Et("toggle",l);break;case"input":Et("invalid",l),rg(l,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":Et("invalid",l);break;case"textarea":Et("invalid",l),no(l,g.value,g.defaultValue,g.children)}f=g.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||l.textContent===""+f||g.suppressHydrationWarning===!0||EC(l.textContent,f)?(g.popover!=null&&(Et("beforetoggle",l),Et("toggle",l)),g.onScroll!=null&&Et("scroll",l),g.onScrollEnd!=null&&Et("scrollend",l),g.onClick!=null&&(l.onclick=ea),l=!0):l=!1,l||fo(s,!0)}function oT(s){for(yr=s.return;yr;)switch(yr.tag){case 5:case 31:case 13:Mi=!1;return;case 27:case 3:Mi=!0;return;default:yr=yr.return}}function au(s){if(s!==yr)return!1;if(!Dt)return oT(s),Dt=!0,!1;var l=s.tag,f;if((f=l!==3&&l!==27)&&((f=l===5)&&(f=s.type,f=!(f!=="form"&&f!=="button")||$b(s.type,s.memoizedProps)),f=!f),f&&tn&&fo(s),oT(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));tn=NC(s)}else if(l===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));tn=NC(s)}else l===27?(l=tn,Ao(s.type)?(s=Qb,Qb=null,tn=s):tn=l):tn=yr?Oi(s.stateNode.nextSibling):null;return!0}function Ml(){tn=yr=null,Dt=!1}function Ry(){var s=uo;return s!==null&&(Jr===null?Jr=s:Jr.push.apply(Jr,s),uo=null),s}function vf(s){uo===null?uo=[s]:uo.push(s)}var Dy=U(null),Pl=null,ps=null;function ho(s,l,f){ne(Dy,l._currentValue),l._currentValue=f}function gs(s){s._currentValue=Dy.current,Y(Dy)}function ky(s,l,f){for(;s!==null;){var g=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),s===f)break;s=s.return}}function Ny(s,l,f,g){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var E=x.dependencies;if(E!==null){var N=x.child;E=E.firstContext;e:for(;E!==null;){var G=E;E=x;for(var K=0;K<l.length;K++)if(G.context===l[K]){E.lanes|=f,G=E.alternate,G!==null&&(G.lanes|=f),ky(E.return,f,s),g||(N=null);break e}E=G.next}}else if(x.tag===18){if(N=x.return,N===null)throw Error(r(341));N.lanes|=f,E=N.alternate,E!==null&&(E.lanes|=f),ky(N,f,s),N=null}else N=x.child;if(N!==null)N.return=x;else for(N=x;N!==null;){if(N===s){N=null;break}if(x=N.sibling,x!==null){x.return=N.return,N=x;break}N=N.return}x=N}}function su(s,l,f,g){s=null;for(var x=l,E=!1;x!==null;){if(!E){if((x.flags&524288)!==0)E=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var N=x.alternate;if(N===null)throw Error(r(387));if(N=N.memoizedProps,N!==null){var G=x.type;di(x.pendingProps.value,N.value)||(s!==null?s.push(G):s=[G])}}else if(x===me.current){if(N=x.alternate,N===null)throw Error(r(387));N.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(qf):s=[qf])}x=x.return}s!==null&&Ny(l,s,f,g),l.flags|=262144}function Tg(s){for(s=s.firstContext;s!==null;){if(!di(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Ol(s){Pl=s,ps=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function br(s){return lT(Pl,s)}function Ag(s,l){return Pl===null&&Ol(s),lT(s,l)}function lT(s,l){var f=l._currentValue;if(l={context:l,memoizedValue:f,next:null},ps===null){if(s===null)throw Error(r(308));ps=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else ps=ps.next=l;return f}var L5=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(f,g){s.push(g)}};this.abort=function(){l.aborted=!0,s.forEach(function(f){return f()})}},B5=n.unstable_scheduleCallback,U5=n.unstable_NormalPriority,Bn={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function My(){return{controller:new L5,data:new Map,refCount:0}}function yf(s){s.refCount--,s.refCount===0&&B5(U5,function(){s.controller.abort()})}var bf=null,Py=0,ou=0,lu=null;function F5(s,l){if(bf===null){var f=bf=[];Py=0,ou=jb(),lu={status:"pending",value:void 0,then:function(g){f.push(g)}}}return Py++,l.then(cT,cT),l}function cT(){if(--Py===0&&bf!==null){lu!==null&&(lu.status="fulfilled");var s=bf;bf=null,ou=0,lu=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function G5(s,l){var f=[],g={status:"pending",value:null,reason:null,then:function(x){f.push(x)}};return s.then(function(){g.status="fulfilled",g.value=l;for(var x=0;x<f.length;x++)(0,f[x])(l)},function(x){for(g.status="rejected",g.reason=x,x=0;x<f.length;x++)(0,f[x])(void 0)}),g}var uT=$.S;$.S=function(s,l){YA=bt(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&F5(s,l),uT!==null&&uT(s,l)};var Vl=U(null);function Oy(){var s=Vl.current;return s!==null?s:Qt.pooledCache}function Cg(s,l){l===null?ne(Vl,Vl.current):ne(Vl,l.pool)}function dT(){var s=Oy();return s===null?null:{parent:Bn._currentValue,pool:s}}var cu=Error(r(460)),Vy=Error(r(474)),Ig=Error(r(542)),Rg={then:function(){}};function fT(s){return s=s.status,s==="fulfilled"||s==="rejected"}function hT(s,l,f){switch(f=s[f],f===void 0?s.push(l):f!==l&&(l.then(ea,ea),l=f),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,gT(s),s;default:if(typeof l.status=="string")l.then(ea,ea);else{if(s=Qt,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=l,s.status="pending",s.then(function(g){if(l.status==="pending"){var x=l;x.status="fulfilled",x.value=g}},function(g){if(l.status==="pending"){var x=l;x.status="rejected",x.reason=g}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,gT(s),s}throw zl=l,cu}}function jl(s){try{var l=s._init;return l(s._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(zl=f,cu):f}}var zl=null;function pT(){if(zl===null)throw Error(r(459));var s=zl;return zl=null,s}function gT(s){if(s===cu||s===Ig)throw Error(r(483))}var uu=null,xf=0;function Dg(s){var l=xf;return xf+=1,uu===null&&(uu=[]),hT(uu,s,l)}function _f(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function kg(s,l){throw l.$$typeof===m?Error(r(525)):(s=Object.prototype.toString.call(l),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function mT(s){function l(ae,ee){if(s){var ce=ae.deletions;ce===null?(ae.deletions=[ee],ae.flags|=16):ce.push(ee)}}function f(ae,ee){if(!s)return null;for(;ee!==null;)l(ae,ee),ee=ee.sibling;return null}function g(ae){for(var ee=new Map;ae!==null;)ae.key!==null?ee.set(ae.key,ae):ee.set(ae.index,ae),ae=ae.sibling;return ee}function x(ae,ee){return ae=fs(ae,ee),ae.index=0,ae.sibling=null,ae}function E(ae,ee,ce){return ae.index=ce,s?(ce=ae.alternate,ce!==null?(ce=ce.index,ce<ee?(ae.flags|=67108866,ee):ce):(ae.flags|=67108866,ee)):(ae.flags|=1048576,ee)}function N(ae){return s&&ae.alternate===null&&(ae.flags|=67108866),ae}function G(ae,ee,ce,ye){return ee===null||ee.tag!==6?(ee=Sy(ce,ae.mode,ye),ee.return=ae,ee):(ee=x(ee,ce),ee.return=ae,ee)}function K(ae,ee,ce,ye){var He=ce.type;return He===w?ve(ae,ee,ce.props.children,ye,ce.key):ee!==null&&(ee.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===A&&jl(He)===ee.type)?(ee=x(ee,ce.props),_f(ee,ce),ee.return=ae,ee):(ee=Eg(ce.type,ce.key,ce.props,null,ae.mode,ye),_f(ee,ce),ee.return=ae,ee)}function ue(ae,ee,ce,ye){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==ce.containerInfo||ee.stateNode.implementation!==ce.implementation?(ee=Ty(ce,ae.mode,ye),ee.return=ae,ee):(ee=x(ee,ce.children||[]),ee.return=ae,ee)}function ve(ae,ee,ce,ye,He){return ee===null||ee.tag!==7?(ee=Nl(ce,ae.mode,ye,He),ee.return=ae,ee):(ee=x(ee,ce),ee.return=ae,ee)}function be(ae,ee,ce){if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return ee=Sy(""+ee,ae.mode,ce),ee.return=ae,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case b:return ce=Eg(ee.type,ee.key,ee.props,null,ae.mode,ce),_f(ce,ee),ce.return=ae,ce;case _:return ee=Ty(ee,ae.mode,ce),ee.return=ae,ee;case A:return ee=jl(ee),be(ae,ee,ce)}if(X(ee)||B(ee))return ee=Nl(ee,ae.mode,ce,null),ee.return=ae,ee;if(typeof ee.then=="function")return be(ae,Dg(ee),ce);if(ee.$$typeof===R)return be(ae,Ag(ae,ee),ce);kg(ae,ee)}return null}function fe(ae,ee,ce,ye){var He=ee!==null?ee.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return He!==null?null:G(ae,ee,""+ce,ye);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case b:return ce.key===He?K(ae,ee,ce,ye):null;case _:return ce.key===He?ue(ae,ee,ce,ye):null;case A:return ce=jl(ce),fe(ae,ee,ce,ye)}if(X(ce)||B(ce))return He!==null?null:ve(ae,ee,ce,ye,null);if(typeof ce.then=="function")return fe(ae,ee,Dg(ce),ye);if(ce.$$typeof===R)return fe(ae,ee,Ag(ae,ce),ye);kg(ae,ce)}return null}function pe(ae,ee,ce,ye,He){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return ae=ae.get(ce)||null,G(ee,ae,""+ye,He);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case b:return ae=ae.get(ye.key===null?ce:ye.key)||null,K(ee,ae,ye,He);case _:return ae=ae.get(ye.key===null?ce:ye.key)||null,ue(ee,ae,ye,He);case A:return ye=jl(ye),pe(ae,ee,ce,ye,He)}if(X(ye)||B(ye))return ae=ae.get(ce)||null,ve(ee,ae,ye,He,null);if(typeof ye.then=="function")return pe(ae,ee,ce,Dg(ye),He);if(ye.$$typeof===R)return pe(ae,ee,ce,Ag(ee,ye),He);kg(ee,ye)}return null}function je(ae,ee,ce,ye){for(var He=null,Pt=null,Ue=ee,vt=ee=0,At=null;Ue!==null&&vt<ce.length;vt++){Ue.index>vt?(At=Ue,Ue=null):At=Ue.sibling;var Ot=fe(ae,Ue,ce[vt],ye);if(Ot===null){Ue===null&&(Ue=At);break}s&&Ue&&Ot.alternate===null&&l(ae,Ue),ee=E(Ot,ee,vt),Pt===null?He=Ot:Pt.sibling=Ot,Pt=Ot,Ue=At}if(vt===ce.length)return f(ae,Ue),Dt&&hs(ae,vt),He;if(Ue===null){for(;vt<ce.length;vt++)Ue=be(ae,ce[vt],ye),Ue!==null&&(ee=E(Ue,ee,vt),Pt===null?He=Ue:Pt.sibling=Ue,Pt=Ue);return Dt&&hs(ae,vt),He}for(Ue=g(Ue);vt<ce.length;vt++)At=pe(Ue,ae,vt,ce[vt],ye),At!==null&&(s&&At.alternate!==null&&Ue.delete(At.key===null?vt:At.key),ee=E(At,ee,vt),Pt===null?He=At:Pt.sibling=At,Pt=At);return s&&Ue.forEach(function(ko){return l(ae,ko)}),Dt&&hs(ae,vt),He}function Je(ae,ee,ce,ye){if(ce==null)throw Error(r(151));for(var He=null,Pt=null,Ue=ee,vt=ee=0,At=null,Ot=ce.next();Ue!==null&&!Ot.done;vt++,Ot=ce.next()){Ue.index>vt?(At=Ue,Ue=null):At=Ue.sibling;var ko=fe(ae,Ue,Ot.value,ye);if(ko===null){Ue===null&&(Ue=At);break}s&&Ue&&ko.alternate===null&&l(ae,Ue),ee=E(ko,ee,vt),Pt===null?He=ko:Pt.sibling=ko,Pt=ko,Ue=At}if(Ot.done)return f(ae,Ue),Dt&&hs(ae,vt),He;if(Ue===null){for(;!Ot.done;vt++,Ot=ce.next())Ot=be(ae,Ot.value,ye),Ot!==null&&(ee=E(Ot,ee,vt),Pt===null?He=Ot:Pt.sibling=Ot,Pt=Ot);return Dt&&hs(ae,vt),He}for(Ue=g(Ue);!Ot.done;vt++,Ot=ce.next())Ot=pe(Ue,ae,vt,Ot.value,ye),Ot!==null&&(s&&Ot.alternate!==null&&Ue.delete(Ot.key===null?vt:Ot.key),ee=E(Ot,ee,vt),Pt===null?He=Ot:Pt.sibling=Ot,Pt=Ot);return s&&Ue.forEach(function(e6){return l(ae,e6)}),Dt&&hs(ae,vt),He}function Kt(ae,ee,ce,ye){if(typeof ce=="object"&&ce!==null&&ce.type===w&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case b:e:{for(var He=ce.key;ee!==null;){if(ee.key===He){if(He=ce.type,He===w){if(ee.tag===7){f(ae,ee.sibling),ye=x(ee,ce.props.children),ye.return=ae,ae=ye;break e}}else if(ee.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===A&&jl(He)===ee.type){f(ae,ee.sibling),ye=x(ee,ce.props),_f(ye,ce),ye.return=ae,ae=ye;break e}f(ae,ee);break}else l(ae,ee);ee=ee.sibling}ce.type===w?(ye=Nl(ce.props.children,ae.mode,ye,ce.key),ye.return=ae,ae=ye):(ye=Eg(ce.type,ce.key,ce.props,null,ae.mode,ye),_f(ye,ce),ye.return=ae,ae=ye)}return N(ae);case _:e:{for(He=ce.key;ee!==null;){if(ee.key===He)if(ee.tag===4&&ee.stateNode.containerInfo===ce.containerInfo&&ee.stateNode.implementation===ce.implementation){f(ae,ee.sibling),ye=x(ee,ce.children||[]),ye.return=ae,ae=ye;break e}else{f(ae,ee);break}else l(ae,ee);ee=ee.sibling}ye=Ty(ce,ae.mode,ye),ye.return=ae,ae=ye}return N(ae);case A:return ce=jl(ce),Kt(ae,ee,ce,ye)}if(X(ce))return je(ae,ee,ce,ye);if(B(ce)){if(He=B(ce),typeof He!="function")throw Error(r(150));return ce=He.call(ce),Je(ae,ee,ce,ye)}if(typeof ce.then=="function")return Kt(ae,ee,Dg(ce),ye);if(ce.$$typeof===R)return Kt(ae,ee,Ag(ae,ce),ye);kg(ae,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint"?(ce=""+ce,ee!==null&&ee.tag===6?(f(ae,ee.sibling),ye=x(ee,ce),ye.return=ae,ae=ye):(f(ae,ee),ye=Sy(ce,ae.mode,ye),ye.return=ae,ae=ye),N(ae)):f(ae,ee)}return function(ae,ee,ce,ye){try{xf=0;var He=Kt(ae,ee,ce,ye);return uu=null,He}catch(Ue){if(Ue===cu||Ue===Ig)throw Ue;var Pt=fi(29,Ue,null,ae.mode);return Pt.lanes=ye,Pt.return=ae,Pt}finally{}}}var Ll=mT(!0),vT=mT(!1),po=!1;function jy(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function zy(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function go(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function mo(s,l,f){var g=s.updateQueue;if(g===null)return null;if(g=g.shared,(jt&2)!==0){var x=g.pending;return x===null?l.next=l:(l.next=x.next,x.next=l),g.pending=l,l=wg(s),eT(s,null,f),l}return _g(s,g,l,f),wg(s)}function wf(s,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194048)!==0)){var g=l.lanes;g&=s.pendingLanes,f|=g,l.lanes=f,In(s,f)}}function Ly(s,l){var f=s.updateQueue,g=s.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var x=null,E=null;if(f=f.firstBaseUpdate,f!==null){do{var N={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};E===null?x=E=N:E=E.next=N,f=f.next}while(f!==null);E===null?x=E=l:E=E.next=l}else x=E=l;f={baseState:g.baseState,firstBaseUpdate:x,lastBaseUpdate:E,shared:g.shared,callbacks:g.callbacks},s.updateQueue=f;return}s=f.lastBaseUpdate,s===null?f.firstBaseUpdate=l:s.next=l,f.lastBaseUpdate=l}var By=!1;function Ef(){if(By){var s=lu;if(s!==null)throw s}}function Sf(s,l,f,g){By=!1;var x=s.updateQueue;po=!1;var E=x.firstBaseUpdate,N=x.lastBaseUpdate,G=x.shared.pending;if(G!==null){x.shared.pending=null;var K=G,ue=K.next;K.next=null,N===null?E=ue:N.next=ue,N=K;var ve=s.alternate;ve!==null&&(ve=ve.updateQueue,G=ve.lastBaseUpdate,G!==N&&(G===null?ve.firstBaseUpdate=ue:G.next=ue,ve.lastBaseUpdate=K))}if(E!==null){var be=x.baseState;N=0,ve=ue=K=null,G=E;do{var fe=G.lane&-536870913,pe=fe!==G.lane;if(pe?(Tt&fe)===fe:(g&fe)===fe){fe!==0&&fe===ou&&(By=!0),ve!==null&&(ve=ve.next={lane:0,tag:G.tag,payload:G.payload,callback:null,next:null});e:{var je=s,Je=G;fe=l;var Kt=f;switch(Je.tag){case 1:if(je=Je.payload,typeof je=="function"){be=je.call(Kt,be,fe);break e}be=je;break e;case 3:je.flags=je.flags&-65537|128;case 0:if(je=Je.payload,fe=typeof je=="function"?je.call(Kt,be,fe):je,fe==null)break e;be=p({},be,fe);break e;case 2:po=!0}}fe=G.callback,fe!==null&&(s.flags|=64,pe&&(s.flags|=8192),pe=x.callbacks,pe===null?x.callbacks=[fe]:pe.push(fe))}else pe={lane:fe,tag:G.tag,payload:G.payload,callback:G.callback,next:null},ve===null?(ue=ve=pe,K=be):ve=ve.next=pe,N|=fe;if(G=G.next,G===null){if(G=x.shared.pending,G===null)break;pe=G,G=pe.next,pe.next=null,x.lastBaseUpdate=pe,x.shared.pending=null}}while(!0);ve===null&&(K=be),x.baseState=K,x.firstBaseUpdate=ue,x.lastBaseUpdate=ve,E===null&&(x.shared.lanes=0),_o|=N,s.lanes=N,s.memoizedState=be}}function yT(s,l){if(typeof s!="function")throw Error(r(191,s));s.call(l)}function bT(s,l){var f=s.callbacks;if(f!==null)for(s.callbacks=null,s=0;s<f.length;s++)yT(f[s],l)}var du=U(null),Ng=U(0);function xT(s,l){s=Ss,ne(Ng,s),ne(du,l),Ss=s|l.baseLanes}function Uy(){ne(Ng,Ss),ne(du,du.current)}function Fy(){Ss=Ng.current,Y(du),Y(Ng)}var hi=U(null),Pi=null;function vo(s){var l=s.alternate;ne(kn,kn.current&1),ne(hi,s),Pi===null&&(l===null||du.current!==null||l.memoizedState!==null)&&(Pi=s)}function Gy(s){ne(kn,kn.current),ne(hi,s),Pi===null&&(Pi=s)}function _T(s){s.tag===22?(ne(kn,kn.current),ne(hi,s),Pi===null&&(Pi=s)):yo()}function yo(){ne(kn,kn.current),ne(hi,hi.current)}function pi(s){Y(hi),Pi===s&&(Pi=null),Y(kn)}var kn=U(0);function Mg(s){for(var l=s;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||Xb(f)||Wb(f)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var ms=0,pt=null,$t=null,Un=null,Pg=!1,fu=!1,Bl=!1,Og=0,Tf=0,hu=null,q5=0;function bn(){throw Error(r(321))}function qy(s,l){if(l===null)return!1;for(var f=0;f<l.length&&f<s.length;f++)if(!di(s[f],l[f]))return!1;return!0}function Hy(s,l,f,g,x,E){return ms=E,pt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,$.H=s===null||s.memoizedState===null?iA:sb,Bl=!1,E=f(g,x),Bl=!1,fu&&(E=ET(l,f,g,x)),wT(s),E}function wT(s){$.H=If;var l=$t!==null&&$t.next!==null;if(ms=0,Un=$t=pt=null,Pg=!1,Tf=0,hu=null,l)throw Error(r(300));s===null||Fn||(s=s.dependencies,s!==null&&Tg(s)&&(Fn=!0))}function ET(s,l,f,g){pt=s;var x=0;do{if(fu&&(hu=null),Tf=0,fu=!1,25<=x)throw Error(r(301));if(x+=1,Un=$t=null,s.updateQueue!=null){var E=s.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}$.H=aA,E=l(f,g)}while(fu);return E}function H5(){var s=$.H,l=s.useState()[0];return l=typeof l.then=="function"?Af(l):l,s=s.useState()[0],($t!==null?$t.memoizedState:null)!==s&&(pt.flags|=1024),l}function $y(){var s=Og!==0;return Og=0,s}function Yy(s,l,f){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~f}function Ky(s){if(Pg){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}Pg=!1}ms=0,Un=$t=pt=null,fu=!1,Tf=Og=0,hu=null}function Lr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Un===null?pt.memoizedState=Un=s:Un=Un.next=s,Un}function Nn(){if($t===null){var s=pt.alternate;s=s!==null?s.memoizedState:null}else s=$t.next;var l=Un===null?pt.memoizedState:Un.next;if(l!==null)Un=l,$t=s;else{if(s===null)throw pt.alternate===null?Error(r(467)):Error(r(310));$t=s,s={memoizedState:$t.memoizedState,baseState:$t.baseState,baseQueue:$t.baseQueue,queue:$t.queue,next:null},Un===null?pt.memoizedState=Un=s:Un=Un.next=s}return Un}function Vg(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Af(s){var l=Tf;return Tf+=1,hu===null&&(hu=[]),s=hT(hu,s,l),l=pt,(Un===null?l.memoizedState:Un.next)===null&&(l=l.alternate,$.H=l===null||l.memoizedState===null?iA:sb),s}function jg(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Af(s);if(s.$$typeof===R)return br(s)}throw Error(r(438,String(s)))}function Xy(s){var l=null,f=pt.updateQueue;if(f!==null&&(l=f.memoCache),l==null){var g=pt.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(l={data:g.data.map(function(x){return x.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),f===null&&(f=Vg(),pt.updateQueue=f),f.memoCache=l,f=l.data[l.index],f===void 0)for(f=l.data[l.index]=Array(s),g=0;g<s;g++)f[g]=O;return l.index++,f}function vs(s,l){return typeof l=="function"?l(s):l}function zg(s){var l=Nn();return Wy(l,$t,s)}function Wy(s,l,f){var g=s.queue;if(g===null)throw Error(r(311));g.lastRenderedReducer=f;var x=s.baseQueue,E=g.pending;if(E!==null){if(x!==null){var N=x.next;x.next=E.next,E.next=N}l.baseQueue=x=E,g.pending=null}if(E=s.baseState,x===null)s.memoizedState=E;else{l=x.next;var G=N=null,K=null,ue=l,ve=!1;do{var be=ue.lane&-536870913;if(be!==ue.lane?(Tt&be)===be:(ms&be)===be){var fe=ue.revertLane;if(fe===0)K!==null&&(K=K.next={lane:0,revertLane:0,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),be===ou&&(ve=!0);else if((ms&fe)===fe){ue=ue.next,fe===ou&&(ve=!0);continue}else be={lane:0,revertLane:ue.revertLane,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},K===null?(G=K=be,N=E):K=K.next=be,pt.lanes|=fe,_o|=fe;be=ue.action,Bl&&f(E,be),E=ue.hasEagerState?ue.eagerState:f(E,be)}else fe={lane:be,revertLane:ue.revertLane,gesture:ue.gesture,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},K===null?(G=K=fe,N=E):K=K.next=fe,pt.lanes|=be,_o|=be;ue=ue.next}while(ue!==null&&ue!==l);if(K===null?N=E:K.next=G,!di(E,s.memoizedState)&&(Fn=!0,ve&&(f=lu,f!==null)))throw f;s.memoizedState=E,s.baseState=N,s.baseQueue=K,g.lastRenderedState=E}return x===null&&(g.lanes=0),[s.memoizedState,g.dispatch]}function Qy(s){var l=Nn(),f=l.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=s;var g=f.dispatch,x=f.pending,E=l.memoizedState;if(x!==null){f.pending=null;var N=x=x.next;do E=s(E,N.action),N=N.next;while(N!==x);di(E,l.memoizedState)||(Fn=!0),l.memoizedState=E,l.baseQueue===null&&(l.baseState=E),f.lastRenderedState=E}return[E,g]}function ST(s,l,f){var g=pt,x=Nn(),E=Dt;if(E){if(f===void 0)throw Error(r(407));f=f()}else f=l();var N=!di(($t||x).memoizedState,f);if(N&&(x.memoizedState=f,Fn=!0),x=x.queue,eb(CT.bind(null,g,x,s),[s]),x.getSnapshot!==l||N||Un!==null&&Un.memoizedState.tag&1){if(g.flags|=2048,pu(9,{destroy:void 0},AT.bind(null,g,x,f,l),null),Qt===null)throw Error(r(349));E||(ms&127)!==0||TT(g,l,f)}return f}function TT(s,l,f){s.flags|=16384,s={getSnapshot:l,value:f},l=pt.updateQueue,l===null?(l=Vg(),pt.updateQueue=l,l.stores=[s]):(f=l.stores,f===null?l.stores=[s]:f.push(s))}function AT(s,l,f,g){l.value=f,l.getSnapshot=g,IT(l)&&RT(s)}function CT(s,l,f){return f(function(){IT(l)&&RT(s)})}function IT(s){var l=s.getSnapshot;s=s.value;try{var f=l();return!di(s,f)}catch{return!0}}function RT(s){var l=kl(s,2);l!==null&&ei(l,s,2)}function Zy(s){var l=Lr();if(typeof s=="function"){var f=s;if(s=f(),Bl){cr(!0);try{f()}finally{cr(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vs,lastRenderedState:s},l}function DT(s,l,f,g){return s.baseState=f,Wy(s,$t,typeof g=="function"?g:vs)}function $5(s,l,f,g,x){if(Ug(s))throw Error(r(485));if(s=l.action,s!==null){var E={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){E.listeners.push(N)}};$.T!==null?f(!0):E.isTransition=!1,g(E),f=l.pending,f===null?(E.next=l.pending=E,kT(l,E)):(E.next=f.next,l.pending=f.next=E)}}function kT(s,l){var f=l.action,g=l.payload,x=s.state;if(l.isTransition){var E=$.T,N={};$.T=N;try{var G=f(x,g),K=$.S;K!==null&&K(N,G),NT(s,l,G)}catch(ue){Jy(s,l,ue)}finally{E!==null&&N.types!==null&&(E.types=N.types),$.T=E}}else try{E=f(x,g),NT(s,l,E)}catch(ue){Jy(s,l,ue)}}function NT(s,l,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(g){MT(s,l,g)},function(g){return Jy(s,l,g)}):MT(s,l,f)}function MT(s,l,f){l.status="fulfilled",l.value=f,PT(l),s.state=f,l=s.pending,l!==null&&(f=l.next,f===l?s.pending=null:(f=f.next,l.next=f,kT(s,f)))}function Jy(s,l,f){var g=s.pending;if(s.pending=null,g!==null){g=g.next;do l.status="rejected",l.reason=f,PT(l),l=l.next;while(l!==g)}s.action=null}function PT(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function OT(s,l){return l}function VT(s,l){if(Dt){var f=Qt.formState;if(f!==null){e:{var g=pt;if(Dt){if(tn){t:{for(var x=tn,E=Mi;x.nodeType!==8;){if(!E){x=null;break t}if(x=Oi(x.nextSibling),x===null){x=null;break t}}E=x.data,x=E==="F!"||E==="F"?x:null}if(x){tn=Oi(x.nextSibling),g=x.data==="F!";break e}}fo(g)}g=!1}g&&(l=f[0])}}return f=Lr(),f.memoizedState=f.baseState=l,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:OT,lastRenderedState:l},f.queue=g,f=tA.bind(null,pt,g),g.dispatch=f,g=Zy(!1),E=ab.bind(null,pt,!1,g.queue),g=Lr(),x={state:l,dispatch:null,action:s,pending:null},g.queue=x,f=$5.bind(null,pt,x,E,f),x.dispatch=f,g.memoizedState=s,[l,f,!1]}function jT(s){var l=Nn();return zT(l,$t,s)}function zT(s,l,f){if(l=Wy(s,l,OT)[0],s=zg(vs)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var g=Af(l)}catch(N){throw N===cu?Ig:N}else g=l;l=Nn();var x=l.queue,E=x.dispatch;return f!==l.memoizedState&&(pt.flags|=2048,pu(9,{destroy:void 0},Y5.bind(null,x,f),null)),[g,E,s]}function Y5(s,l){s.action=l}function LT(s){var l=Nn(),f=$t;if(f!==null)return zT(l,f,s);Nn(),l=l.memoizedState,f=Nn();var g=f.queue.dispatch;return f.memoizedState=s,[l,g,!1]}function pu(s,l,f,g){return s={tag:s,create:f,deps:g,inst:l,next:null},l=pt.updateQueue,l===null&&(l=Vg(),pt.updateQueue=l),f=l.lastEffect,f===null?l.lastEffect=s.next=s:(g=f.next,f.next=s,s.next=g,l.lastEffect=s),s}function BT(){return Nn().memoizedState}function Lg(s,l,f,g){var x=Lr();pt.flags|=s,x.memoizedState=pu(1|l,{destroy:void 0},f,g===void 0?null:g)}function Bg(s,l,f,g){var x=Nn();g=g===void 0?null:g;var E=x.memoizedState.inst;$t!==null&&g!==null&&qy(g,$t.memoizedState.deps)?x.memoizedState=pu(l,E,f,g):(pt.flags|=s,x.memoizedState=pu(1|l,E,f,g))}function UT(s,l){Lg(8390656,8,s,l)}function eb(s,l){Bg(2048,8,s,l)}function K5(s){pt.flags|=4;var l=pt.updateQueue;if(l===null)l=Vg(),pt.updateQueue=l,l.events=[s];else{var f=l.events;f===null?l.events=[s]:f.push(s)}}function FT(s){var l=Nn().memoizedState;return K5({ref:l,nextImpl:s}),function(){if((jt&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}function GT(s,l){return Bg(4,2,s,l)}function qT(s,l){return Bg(4,4,s,l)}function HT(s,l){if(typeof l=="function"){s=s();var f=l(s);return function(){typeof f=="function"?f():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function $T(s,l,f){f=f!=null?f.concat([s]):null,Bg(4,4,HT.bind(null,l,s),f)}function tb(){}function YT(s,l){var f=Nn();l=l===void 0?null:l;var g=f.memoizedState;return l!==null&&qy(l,g[1])?g[0]:(f.memoizedState=[s,l],s)}function KT(s,l){var f=Nn();l=l===void 0?null:l;var g=f.memoizedState;if(l!==null&&qy(l,g[1]))return g[0];if(g=s(),Bl){cr(!0);try{s()}finally{cr(!1)}}return f.memoizedState=[g,l],g}function nb(s,l,f){return f===void 0||(ms&1073741824)!==0&&(Tt&261930)===0?s.memoizedState=l:(s.memoizedState=f,s=XA(),pt.lanes|=s,_o|=s,f)}function XT(s,l,f,g){return di(f,l)?f:du.current!==null?(s=nb(s,f,g),di(s,l)||(Fn=!0),s):(ms&42)===0||(ms&1073741824)!==0&&(Tt&261930)===0?(Fn=!0,s.memoizedState=f):(s=XA(),pt.lanes|=s,_o|=s,l)}function WT(s,l,f,g,x){var E=H.p;H.p=E!==0&&8>E?E:8;var N=$.T,G={};$.T=G,ab(s,!1,l,f);try{var K=x(),ue=$.S;if(ue!==null&&ue(G,K),K!==null&&typeof K=="object"&&typeof K.then=="function"){var ve=G5(K,g);Cf(s,l,ve,vi(s))}else Cf(s,l,g,vi(s))}catch(be){Cf(s,l,{then:function(){},status:"rejected",reason:be},vi())}finally{H.p=E,N!==null&&G.types!==null&&(N.types=G.types),$.T=N}}function X5(){}function rb(s,l,f,g){if(s.tag!==5)throw Error(r(476));var x=QT(s).queue;WT(s,x,l,Z,f===null?X5:function(){return ZT(s),f(g)})}function QT(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:Z,baseState:Z,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vs,lastRenderedState:Z},next:null};var f={};return l.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vs,lastRenderedState:f},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function ZT(s){var l=QT(s);l.next===null&&(l=s.alternate.memoizedState),Cf(s,l.next.queue,{},vi())}function ib(){return br(qf)}function JT(){return Nn().memoizedState}function eA(){return Nn().memoizedState}function W5(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var f=vi();s=go(f);var g=mo(l,s,f);g!==null&&(ei(g,l,f),wf(g,l,f)),l={cache:My()},s.payload=l;return}l=l.return}}function Q5(s,l,f){var g=vi();f={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Ug(s)?nA(l,f):(f=wy(s,l,f,g),f!==null&&(ei(f,s,g),rA(f,l,g)))}function tA(s,l,f){var g=vi();Cf(s,l,f,g)}function Cf(s,l,f,g){var x={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Ug(s))nA(l,x);else{var E=s.alternate;if(s.lanes===0&&(E===null||E.lanes===0)&&(E=l.lastRenderedReducer,E!==null))try{var N=l.lastRenderedState,G=E(N,f);if(x.hasEagerState=!0,x.eagerState=G,di(G,N))return _g(s,l,x,0),Qt===null&&xg(),!1}catch{}finally{}if(f=wy(s,l,x,g),f!==null)return ei(f,s,g),rA(f,l,g),!0}return!1}function ab(s,l,f,g){if(g={lane:2,revertLane:jb(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Ug(s)){if(l)throw Error(r(479))}else l=wy(s,f,g,2),l!==null&&ei(l,s,2)}function Ug(s){var l=s.alternate;return s===pt||l!==null&&l===pt}function nA(s,l){fu=Pg=!0;var f=s.pending;f===null?l.next=l:(l.next=f.next,f.next=l),s.pending=l}function rA(s,l,f){if((f&4194048)!==0){var g=l.lanes;g&=s.pendingLanes,f|=g,l.lanes=f,In(s,f)}}var If={readContext:br,use:jg,useCallback:bn,useContext:bn,useEffect:bn,useImperativeHandle:bn,useLayoutEffect:bn,useInsertionEffect:bn,useMemo:bn,useReducer:bn,useRef:bn,useState:bn,useDebugValue:bn,useDeferredValue:bn,useTransition:bn,useSyncExternalStore:bn,useId:bn,useHostTransitionStatus:bn,useFormState:bn,useActionState:bn,useOptimistic:bn,useMemoCache:bn,useCacheRefresh:bn};If.useEffectEvent=bn;var iA={readContext:br,use:jg,useCallback:function(s,l){return Lr().memoizedState=[s,l===void 0?null:l],s},useContext:br,useEffect:UT,useImperativeHandle:function(s,l,f){f=f!=null?f.concat([s]):null,Lg(4194308,4,HT.bind(null,l,s),f)},useLayoutEffect:function(s,l){return Lg(4194308,4,s,l)},useInsertionEffect:function(s,l){Lg(4,2,s,l)},useMemo:function(s,l){var f=Lr();l=l===void 0?null:l;var g=s();if(Bl){cr(!0);try{s()}finally{cr(!1)}}return f.memoizedState=[g,l],g},useReducer:function(s,l,f){var g=Lr();if(f!==void 0){var x=f(l);if(Bl){cr(!0);try{f(l)}finally{cr(!1)}}}else x=l;return g.memoizedState=g.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},g.queue=s,s=s.dispatch=Q5.bind(null,pt,s),[g.memoizedState,s]},useRef:function(s){var l=Lr();return s={current:s},l.memoizedState=s},useState:function(s){s=Zy(s);var l=s.queue,f=tA.bind(null,pt,l);return l.dispatch=f,[s.memoizedState,f]},useDebugValue:tb,useDeferredValue:function(s,l){var f=Lr();return nb(f,s,l)},useTransition:function(){var s=Zy(!1);return s=WT.bind(null,pt,s.queue,!0,!1),Lr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,f){var g=pt,x=Lr();if(Dt){if(f===void 0)throw Error(r(407));f=f()}else{if(f=l(),Qt===null)throw Error(r(349));(Tt&127)!==0||TT(g,l,f)}x.memoizedState=f;var E={value:f,getSnapshot:l};return x.queue=E,UT(CT.bind(null,g,E,s),[s]),g.flags|=2048,pu(9,{destroy:void 0},AT.bind(null,g,E,f,l),null),f},useId:function(){var s=Lr(),l=Qt.identifierPrefix;if(Dt){var f=Va,g=Oa;f=(g&~(1<<32-en(g)-1)).toString(32)+f,l="_"+l+"R_"+f,f=Og++,0<f&&(l+="H"+f.toString(32)),l+="_"}else f=q5++,l="_"+l+"r_"+f.toString(32)+"_";return s.memoizedState=l},useHostTransitionStatus:ib,useFormState:VT,useActionState:VT,useOptimistic:function(s){var l=Lr();l.memoizedState=l.baseState=s;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=f,l=ab.bind(null,pt,!0,f),f.dispatch=l,[s,l]},useMemoCache:Xy,useCacheRefresh:function(){return Lr().memoizedState=W5.bind(null,pt)},useEffectEvent:function(s){var l=Lr(),f={impl:s};return l.memoizedState=f,function(){if((jt&2)!==0)throw Error(r(440));return f.impl.apply(void 0,arguments)}}},sb={readContext:br,use:jg,useCallback:YT,useContext:br,useEffect:eb,useImperativeHandle:$T,useInsertionEffect:GT,useLayoutEffect:qT,useMemo:KT,useReducer:zg,useRef:BT,useState:function(){return zg(vs)},useDebugValue:tb,useDeferredValue:function(s,l){var f=Nn();return XT(f,$t.memoizedState,s,l)},useTransition:function(){var s=zg(vs)[0],l=Nn().memoizedState;return[typeof s=="boolean"?s:Af(s),l]},useSyncExternalStore:ST,useId:JT,useHostTransitionStatus:ib,useFormState:jT,useActionState:jT,useOptimistic:function(s,l){var f=Nn();return DT(f,$t,s,l)},useMemoCache:Xy,useCacheRefresh:eA};sb.useEffectEvent=FT;var aA={readContext:br,use:jg,useCallback:YT,useContext:br,useEffect:eb,useImperativeHandle:$T,useInsertionEffect:GT,useLayoutEffect:qT,useMemo:KT,useReducer:Qy,useRef:BT,useState:function(){return Qy(vs)},useDebugValue:tb,useDeferredValue:function(s,l){var f=Nn();return $t===null?nb(f,s,l):XT(f,$t.memoizedState,s,l)},useTransition:function(){var s=Qy(vs)[0],l=Nn().memoizedState;return[typeof s=="boolean"?s:Af(s),l]},useSyncExternalStore:ST,useId:JT,useHostTransitionStatus:ib,useFormState:LT,useActionState:LT,useOptimistic:function(s,l){var f=Nn();return $t!==null?DT(f,$t,s,l):(f.baseState=s,[s,f.queue.dispatch])},useMemoCache:Xy,useCacheRefresh:eA};aA.useEffectEvent=FT;function ob(s,l,f,g){l=s.memoizedState,f=f(g,l),f=f==null?l:p({},l,f),s.memoizedState=f,s.lanes===0&&(s.updateQueue.baseState=f)}var lb={enqueueSetState:function(s,l,f){s=s._reactInternals;var g=vi(),x=go(g);x.payload=l,f!=null&&(x.callback=f),l=mo(s,x,g),l!==null&&(ei(l,s,g),wf(l,s,g))},enqueueReplaceState:function(s,l,f){s=s._reactInternals;var g=vi(),x=go(g);x.tag=1,x.payload=l,f!=null&&(x.callback=f),l=mo(s,x,g),l!==null&&(ei(l,s,g),wf(l,s,g))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var f=vi(),g=go(f);g.tag=2,l!=null&&(g.callback=l),l=mo(s,g,f),l!==null&&(ei(l,s,f),wf(l,s,f))}};function sA(s,l,f,g,x,E,N){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(g,E,N):l.prototype&&l.prototype.isPureReactComponent?!pf(f,g)||!pf(x,E):!0}function oA(s,l,f,g){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,g),l.state!==s&&lb.enqueueReplaceState(l,l.state,null)}function Ul(s,l){var f=l;if("ref"in l){f={};for(var g in l)g!=="ref"&&(f[g]=l[g])}if(s=s.defaultProps){f===l&&(f=p({},f));for(var x in s)f[x]===void 0&&(f[x]=s[x])}return f}function lA(s){bg(s)}function cA(s){console.error(s)}function uA(s){bg(s)}function Fg(s,l){try{var f=s.onUncaughtError;f(l.value,{componentStack:l.stack})}catch(g){setTimeout(function(){throw g})}}function dA(s,l,f){try{var g=s.onCaughtError;g(f.value,{componentStack:f.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function cb(s,l,f){return f=go(f),f.tag=3,f.payload={element:null},f.callback=function(){Fg(s,l)},f}function fA(s){return s=go(s),s.tag=3,s}function hA(s,l,f,g){var x=f.type.getDerivedStateFromError;if(typeof x=="function"){var E=g.value;s.payload=function(){return x(E)},s.callback=function(){dA(l,f,g)}}var N=f.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(s.callback=function(){dA(l,f,g),typeof x!="function"&&(wo===null?wo=new Set([this]):wo.add(this));var G=g.stack;this.componentDidCatch(g.value,{componentStack:G!==null?G:""})})}function Z5(s,l,f,g,x){if(f.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(l=f.alternate,l!==null&&su(l,f,x,!0),f=hi.current,f!==null){switch(f.tag){case 31:case 13:return Pi===null?em():f.alternate===null&&xn===0&&(xn=3),f.flags&=-257,f.flags|=65536,f.lanes=x,g===Rg?f.flags|=16384:(l=f.updateQueue,l===null?f.updateQueue=new Set([g]):l.add(g),Pb(s,g,x)),!1;case 22:return f.flags|=65536,g===Rg?f.flags|=16384:(l=f.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([g])},f.updateQueue=l):(f=l.retryQueue,f===null?l.retryQueue=new Set([g]):f.add(g)),Pb(s,g,x)),!1}throw Error(r(435,f.tag))}return Pb(s,g,x),em(),!1}if(Dt)return l=hi.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=x,g!==Iy&&(s=Error(r(422),{cause:g}),vf(Di(s,f)))):(g!==Iy&&(l=Error(r(423),{cause:g}),vf(Di(l,f))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,g=Di(g,f),x=cb(s.stateNode,g,x),Ly(s,x),xn!==4&&(xn=2)),!1;var E=Error(r(520),{cause:g});if(E=Di(E,f),Vf===null?Vf=[E]:Vf.push(E),xn!==4&&(xn=2),l===null)return!0;g=Di(g,f),f=l;do{switch(f.tag){case 3:return f.flags|=65536,s=x&-x,f.lanes|=s,s=cb(f.stateNode,g,s),Ly(f,s),!1;case 1:if(l=f.type,E=f.stateNode,(f.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(wo===null||!wo.has(E))))return f.flags|=65536,x&=-x,f.lanes|=x,x=fA(x),hA(x,s,f,g),Ly(f,x),!1}f=f.return}while(f!==null);return!1}var ub=Error(r(461)),Fn=!1;function xr(s,l,f,g){l.child=s===null?vT(l,null,f,g):Ll(l,s.child,f,g)}function pA(s,l,f,g,x){f=f.render;var E=l.ref;if("ref"in g){var N={};for(var G in g)G!=="ref"&&(N[G]=g[G])}else N=g;return Ol(l),g=Hy(s,l,f,N,E,x),G=$y(),s!==null&&!Fn?(Yy(s,l,x),ys(s,l,x)):(Dt&&G&&Ay(l),l.flags|=1,xr(s,l,g,x),l.child)}function gA(s,l,f,g,x){if(s===null){var E=f.type;return typeof E=="function"&&!Ey(E)&&E.defaultProps===void 0&&f.compare===null?(l.tag=15,l.type=E,mA(s,l,E,g,x)):(s=Eg(f.type,null,g,l,l.mode,x),s.ref=l.ref,s.return=l,l.child=s)}if(E=s.child,!yb(s,x)){var N=E.memoizedProps;if(f=f.compare,f=f!==null?f:pf,f(N,g)&&s.ref===l.ref)return ys(s,l,x)}return l.flags|=1,s=fs(E,g),s.ref=l.ref,s.return=l,l.child=s}function mA(s,l,f,g,x){if(s!==null){var E=s.memoizedProps;if(pf(E,g)&&s.ref===l.ref)if(Fn=!1,l.pendingProps=g=E,yb(s,x))(s.flags&131072)!==0&&(Fn=!0);else return l.lanes=s.lanes,ys(s,l,x)}return db(s,l,f,g,x)}function vA(s,l,f,g){var x=g.children,E=s!==null?s.memoizedState:null;if(s===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((l.flags&128)!==0){if(E=E!==null?E.baseLanes|f:f,s!==null){for(g=l.child=s.child,x=0;g!==null;)x=x|g.lanes|g.childLanes,g=g.sibling;g=x&~E}else g=0,l.child=null;return yA(s,l,E,f,g)}if((f&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&Cg(l,E!==null?E.cachePool:null),E!==null?xT(l,E):Uy(),_T(l);else return g=l.lanes=536870912,yA(s,l,E!==null?E.baseLanes|f:f,f,g)}else E!==null?(Cg(l,E.cachePool),xT(l,E),yo(),l.memoizedState=null):(s!==null&&Cg(l,null),Uy(),yo());return xr(s,l,x,f),l.child}function Rf(s,l){return s!==null&&s.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function yA(s,l,f,g,x){var E=Oy();return E=E===null?null:{parent:Bn._currentValue,pool:E},l.memoizedState={baseLanes:f,cachePool:E},s!==null&&Cg(l,null),Uy(),_T(l),s!==null&&su(s,l,g,!0),l.childLanes=x,null}function Gg(s,l){return l=Hg({mode:l.mode,children:l.children},s.mode),l.ref=s.ref,s.child=l,l.return=s,l}function bA(s,l,f){return Ll(l,s.child,null,f),s=Gg(l,l.pendingProps),s.flags|=2,pi(l),l.memoizedState=null,s}function J5(s,l,f){var g=l.pendingProps,x=(l.flags&128)!==0;if(l.flags&=-129,s===null){if(Dt){if(g.mode==="hidden")return s=Gg(l,g),l.lanes=536870912,Rf(null,s);if(Gy(l),(s=tn)?(s=kC(s,Mi),s=s!==null&&s.data==="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:co!==null?{id:Oa,overflow:Va}:null,retryLane:536870912,hydrationErrors:null},f=nT(s),f.return=l,l.child=f,yr=l,tn=null)):s=null,s===null)throw fo(l);return l.lanes=536870912,null}return Gg(l,g)}var E=s.memoizedState;if(E!==null){var N=E.dehydrated;if(Gy(l),x)if(l.flags&256)l.flags&=-257,l=bA(s,l,f);else if(l.memoizedState!==null)l.child=s.child,l.flags|=128,l=null;else throw Error(r(558));else if(Fn||su(s,l,f,!1),x=(f&s.childLanes)!==0,Fn||x){if(g=Qt,g!==null&&(N=Zn(g,f),N!==0&&N!==E.retryLane))throw E.retryLane=N,kl(s,N),ei(g,s,N),ub;em(),l=bA(s,l,f)}else s=E.treeContext,tn=Oi(N.nextSibling),yr=l,Dt=!0,uo=null,Mi=!1,s!==null&&aT(l,s),l=Gg(l,g),l.flags|=4096;return l}return s=fs(s.child,{mode:g.mode,children:g.children}),s.ref=l.ref,l.child=s,s.return=l,s}function qg(s,l){var f=l.ref;if(f===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(r(284));(s===null||s.ref!==f)&&(l.flags|=4194816)}}function db(s,l,f,g,x){return Ol(l),f=Hy(s,l,f,g,void 0,x),g=$y(),s!==null&&!Fn?(Yy(s,l,x),ys(s,l,x)):(Dt&&g&&Ay(l),l.flags|=1,xr(s,l,f,x),l.child)}function xA(s,l,f,g,x,E){return Ol(l),l.updateQueue=null,f=ET(l,g,f,x),wT(s),g=$y(),s!==null&&!Fn?(Yy(s,l,E),ys(s,l,E)):(Dt&&g&&Ay(l),l.flags|=1,xr(s,l,f,E),l.child)}function _A(s,l,f,g,x){if(Ol(l),l.stateNode===null){var E=nu,N=f.contextType;typeof N=="object"&&N!==null&&(E=br(N)),E=new f(g,E),l.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=lb,l.stateNode=E,E._reactInternals=l,E=l.stateNode,E.props=g,E.state=l.memoizedState,E.refs={},jy(l),N=f.contextType,E.context=typeof N=="object"&&N!==null?br(N):nu,E.state=l.memoizedState,N=f.getDerivedStateFromProps,typeof N=="function"&&(ob(l,f,N,g),E.state=l.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(N=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),N!==E.state&&lb.enqueueReplaceState(E,E.state,null),Sf(l,g,E,x),Ef(),E.state=l.memoizedState),typeof E.componentDidMount=="function"&&(l.flags|=4194308),g=!0}else if(s===null){E=l.stateNode;var G=l.memoizedProps,K=Ul(f,G);E.props=K;var ue=E.context,ve=f.contextType;N=nu,typeof ve=="object"&&ve!==null&&(N=br(ve));var be=f.getDerivedStateFromProps;ve=typeof be=="function"||typeof E.getSnapshotBeforeUpdate=="function",G=l.pendingProps!==G,ve||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(G||ue!==N)&&oA(l,E,g,N),po=!1;var fe=l.memoizedState;E.state=fe,Sf(l,g,E,x),Ef(),ue=l.memoizedState,G||fe!==ue||po?(typeof be=="function"&&(ob(l,f,be,g),ue=l.memoizedState),(K=po||sA(l,f,K,g,fe,ue,N))?(ve||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(l.flags|=4194308)):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=ue),E.props=g,E.state=ue,E.context=N,g=K):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{E=l.stateNode,zy(s,l),N=l.memoizedProps,ve=Ul(f,N),E.props=ve,be=l.pendingProps,fe=E.context,ue=f.contextType,K=nu,typeof ue=="object"&&ue!==null&&(K=br(ue)),G=f.getDerivedStateFromProps,(ue=typeof G=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(N!==be||fe!==K)&&oA(l,E,g,K),po=!1,fe=l.memoizedState,E.state=fe,Sf(l,g,E,x),Ef();var pe=l.memoizedState;N!==be||fe!==pe||po||s!==null&&s.dependencies!==null&&Tg(s.dependencies)?(typeof G=="function"&&(ob(l,f,G,g),pe=l.memoizedState),(ve=po||sA(l,f,ve,g,fe,pe,K)||s!==null&&s.dependencies!==null&&Tg(s.dependencies))?(ue||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(g,pe,K),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(g,pe,K)),typeof E.componentDidUpdate=="function"&&(l.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof E.componentDidUpdate!="function"||N===s.memoizedProps&&fe===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&fe===s.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=pe),E.props=g,E.state=pe,E.context=K,g=ve):(typeof E.componentDidUpdate!="function"||N===s.memoizedProps&&fe===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&fe===s.memoizedState||(l.flags|=1024),g=!1)}return E=g,qg(s,l),g=(l.flags&128)!==0,E||g?(E=l.stateNode,f=g&&typeof f.getDerivedStateFromError!="function"?null:E.render(),l.flags|=1,s!==null&&g?(l.child=Ll(l,s.child,null,x),l.child=Ll(l,null,f,x)):xr(s,l,f,x),l.memoizedState=E.state,s=l.child):s=ys(s,l,x),s}function wA(s,l,f,g){return Ml(),l.flags|=256,xr(s,l,f,g),l.child}var fb={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function hb(s){return{baseLanes:s,cachePool:dT()}}function pb(s,l,f){return s=s!==null?s.childLanes&~f:0,l&&(s|=mi),s}function EA(s,l,f){var g=l.pendingProps,x=!1,E=(l.flags&128)!==0,N;if((N=E)||(N=s!==null&&s.memoizedState===null?!1:(kn.current&2)!==0),N&&(x=!0,l.flags&=-129),N=(l.flags&32)!==0,l.flags&=-33,s===null){if(Dt){if(x?vo(l):yo(),(s=tn)?(s=kC(s,Mi),s=s!==null&&s.data!=="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:co!==null?{id:Oa,overflow:Va}:null,retryLane:536870912,hydrationErrors:null},f=nT(s),f.return=l,l.child=f,yr=l,tn=null)):s=null,s===null)throw fo(l);return Wb(s)?l.lanes=32:l.lanes=536870912,null}var G=g.children;return g=g.fallback,x?(yo(),x=l.mode,G=Hg({mode:"hidden",children:G},x),g=Nl(g,x,f,null),G.return=l,g.return=l,G.sibling=g,l.child=G,g=l.child,g.memoizedState=hb(f),g.childLanes=pb(s,N,f),l.memoizedState=fb,Rf(null,g)):(vo(l),gb(l,G))}var K=s.memoizedState;if(K!==null&&(G=K.dehydrated,G!==null)){if(E)l.flags&256?(vo(l),l.flags&=-257,l=mb(s,l,f)):l.memoizedState!==null?(yo(),l.child=s.child,l.flags|=128,l=null):(yo(),G=g.fallback,x=l.mode,g=Hg({mode:"visible",children:g.children},x),G=Nl(G,x,f,null),G.flags|=2,g.return=l,G.return=l,g.sibling=G,l.child=g,Ll(l,s.child,null,f),g=l.child,g.memoizedState=hb(f),g.childLanes=pb(s,N,f),l.memoizedState=fb,l=Rf(null,g));else if(vo(l),Wb(G)){if(N=G.nextSibling&&G.nextSibling.dataset,N)var ue=N.dgst;N=ue,g=Error(r(419)),g.stack="",g.digest=N,vf({value:g,source:null,stack:null}),l=mb(s,l,f)}else if(Fn||su(s,l,f,!1),N=(f&s.childLanes)!==0,Fn||N){if(N=Qt,N!==null&&(g=Zn(N,f),g!==0&&g!==K.retryLane))throw K.retryLane=g,kl(s,g),ei(N,s,g),ub;Xb(G)||em(),l=mb(s,l,f)}else Xb(G)?(l.flags|=192,l.child=s.child,l=null):(s=K.treeContext,tn=Oi(G.nextSibling),yr=l,Dt=!0,uo=null,Mi=!1,s!==null&&aT(l,s),l=gb(l,g.children),l.flags|=4096);return l}return x?(yo(),G=g.fallback,x=l.mode,K=s.child,ue=K.sibling,g=fs(K,{mode:"hidden",children:g.children}),g.subtreeFlags=K.subtreeFlags&65011712,ue!==null?G=fs(ue,G):(G=Nl(G,x,f,null),G.flags|=2),G.return=l,g.return=l,g.sibling=G,l.child=g,Rf(null,g),g=l.child,G=s.child.memoizedState,G===null?G=hb(f):(x=G.cachePool,x!==null?(K=Bn._currentValue,x=x.parent!==K?{parent:K,pool:K}:x):x=dT(),G={baseLanes:G.baseLanes|f,cachePool:x}),g.memoizedState=G,g.childLanes=pb(s,N,f),l.memoizedState=fb,Rf(s.child,g)):(vo(l),f=s.child,s=f.sibling,f=fs(f,{mode:"visible",children:g.children}),f.return=l,f.sibling=null,s!==null&&(N=l.deletions,N===null?(l.deletions=[s],l.flags|=16):N.push(s)),l.child=f,l.memoizedState=null,f)}function gb(s,l){return l=Hg({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function Hg(s,l){return s=fi(22,s,null,l),s.lanes=0,s}function mb(s,l,f){return Ll(l,s.child,null,f),s=gb(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function SA(s,l,f){s.lanes|=l;var g=s.alternate;g!==null&&(g.lanes|=l),ky(s.return,l,f)}function vb(s,l,f,g,x,E){var N=s.memoizedState;N===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:x,treeForkCount:E}:(N.isBackwards=l,N.rendering=null,N.renderingStartTime=0,N.last=g,N.tail=f,N.tailMode=x,N.treeForkCount=E)}function TA(s,l,f){var g=l.pendingProps,x=g.revealOrder,E=g.tail;g=g.children;var N=kn.current,G=(N&2)!==0;if(G?(N=N&1|2,l.flags|=128):N&=1,ne(kn,N),xr(s,l,g,f),g=Dt?mf:0,!G&&s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&SA(s,f,l);else if(s.tag===19)SA(s,f,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(x){case"forwards":for(f=l.child,x=null;f!==null;)s=f.alternate,s!==null&&Mg(s)===null&&(x=f),f=f.sibling;f=x,f===null?(x=l.child,l.child=null):(x=f.sibling,f.sibling=null),vb(l,!1,x,f,E,g);break;case"backwards":case"unstable_legacy-backwards":for(f=null,x=l.child,l.child=null;x!==null;){if(s=x.alternate,s!==null&&Mg(s)===null){l.child=x;break}s=x.sibling,x.sibling=f,f=x,x=s}vb(l,!0,f,null,E,g);break;case"together":vb(l,!1,null,null,void 0,g);break;default:l.memoizedState=null}return l.child}function ys(s,l,f){if(s!==null&&(l.dependencies=s.dependencies),_o|=l.lanes,(f&l.childLanes)===0)if(s!==null){if(su(s,l,f,!1),(f&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(r(153));if(l.child!==null){for(s=l.child,f=fs(s,s.pendingProps),l.child=f,f.return=l;s.sibling!==null;)s=s.sibling,f=f.sibling=fs(s,s.pendingProps),f.return=l;f.sibling=null}return l.child}function yb(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&Tg(s)))}function ej(s,l,f){switch(l.tag){case 3:Te(l,l.stateNode.containerInfo),ho(l,Bn,s.memoizedState.cache),Ml();break;case 27:case 5:Ne(l);break;case 4:Te(l,l.stateNode.containerInfo);break;case 10:ho(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,Gy(l),null;break;case 13:var g=l.memoizedState;if(g!==null)return g.dehydrated!==null?(vo(l),l.flags|=128,null):(f&l.child.childLanes)!==0?EA(s,l,f):(vo(l),s=ys(s,l,f),s!==null?s.sibling:null);vo(l);break;case 19:var x=(s.flags&128)!==0;if(g=(f&l.childLanes)!==0,g||(su(s,l,f,!1),g=(f&l.childLanes)!==0),x){if(g)return TA(s,l,f);l.flags|=128}if(x=l.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),ne(kn,kn.current),g)break;return null;case 22:return l.lanes=0,vA(s,l,f,l.pendingProps);case 24:ho(l,Bn,s.memoizedState.cache)}return ys(s,l,f)}function AA(s,l,f){if(s!==null)if(s.memoizedProps!==l.pendingProps)Fn=!0;else{if(!yb(s,f)&&(l.flags&128)===0)return Fn=!1,ej(s,l,f);Fn=(s.flags&131072)!==0}else Fn=!1,Dt&&(l.flags&1048576)!==0&&iT(l,mf,l.index);switch(l.lanes=0,l.tag){case 16:e:{var g=l.pendingProps;if(s=jl(l.elementType),l.type=s,typeof s=="function")Ey(s)?(g=Ul(s,g),l.tag=1,l=_A(null,l,s,g,f)):(l.tag=0,l=db(null,l,s,g,f));else{if(s!=null){var x=s.$$typeof;if(x===j){l.tag=11,l=pA(null,l,s,g,f);break e}else if(x===I){l.tag=14,l=gA(null,l,s,g,f);break e}}throw l=Q(s)||s,Error(r(306,l,""))}}return l;case 0:return db(s,l,l.type,l.pendingProps,f);case 1:return g=l.type,x=Ul(g,l.pendingProps),_A(s,l,g,x,f);case 3:e:{if(Te(l,l.stateNode.containerInfo),s===null)throw Error(r(387));g=l.pendingProps;var E=l.memoizedState;x=E.element,zy(s,l),Sf(l,g,null,f);var N=l.memoizedState;if(g=N.cache,ho(l,Bn,g),g!==E.cache&&Ny(l,[Bn],f,!0),Ef(),g=N.element,E.isDehydrated)if(E={element:g,isDehydrated:!1,cache:N.cache},l.updateQueue.baseState=E,l.memoizedState=E,l.flags&256){l=wA(s,l,g,f);break e}else if(g!==x){x=Di(Error(r(424)),l),vf(x),l=wA(s,l,g,f);break e}else{switch(s=l.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(tn=Oi(s.firstChild),yr=l,Dt=!0,uo=null,Mi=!0,f=vT(l,null,g,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(Ml(),g===x){l=ys(s,l,f);break e}xr(s,l,g,f)}l=l.child}return l;case 26:return qg(s,l),s===null?(f=jC(l.type,null,l.pendingProps,null))?l.memoizedState=f:Dt||(f=l.type,s=l.pendingProps,g=om(se.current).createElement(f),g[jn]=l,g[ur]=s,_r(g,f,s),zn(g),l.stateNode=g):l.memoizedState=jC(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return Ne(l),s===null&&Dt&&(g=l.stateNode=PC(l.type,l.pendingProps,se.current),yr=l,Mi=!0,x=tn,Ao(l.type)?(Qb=x,tn=Oi(g.firstChild)):tn=x),xr(s,l,l.pendingProps.children,f),qg(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&Dt&&((x=g=tn)&&(g=Dj(g,l.type,l.pendingProps,Mi),g!==null?(l.stateNode=g,yr=l,tn=Oi(g.firstChild),Mi=!1,x=!0):x=!1),x||fo(l)),Ne(l),x=l.type,E=l.pendingProps,N=s!==null?s.memoizedProps:null,g=E.children,$b(x,E)?g=null:N!==null&&$b(x,N)&&(l.flags|=32),l.memoizedState!==null&&(x=Hy(s,l,H5,null,null,f),qf._currentValue=x),qg(s,l),xr(s,l,g,f),l.child;case 6:return s===null&&Dt&&((s=f=tn)&&(f=kj(f,l.pendingProps,Mi),f!==null?(l.stateNode=f,yr=l,tn=null,s=!0):s=!1),s||fo(l)),null;case 13:return EA(s,l,f);case 4:return Te(l,l.stateNode.containerInfo),g=l.pendingProps,s===null?l.child=Ll(l,null,g,f):xr(s,l,g,f),l.child;case 11:return pA(s,l,l.type,l.pendingProps,f);case 7:return xr(s,l,l.pendingProps,f),l.child;case 8:return xr(s,l,l.pendingProps.children,f),l.child;case 12:return xr(s,l,l.pendingProps.children,f),l.child;case 10:return g=l.pendingProps,ho(l,l.type,g.value),xr(s,l,g.children,f),l.child;case 9:return x=l.type._context,g=l.pendingProps.children,Ol(l),x=br(x),g=g(x),l.flags|=1,xr(s,l,g,f),l.child;case 14:return gA(s,l,l.type,l.pendingProps,f);case 15:return mA(s,l,l.type,l.pendingProps,f);case 19:return TA(s,l,f);case 31:return J5(s,l,f);case 22:return vA(s,l,f,l.pendingProps);case 24:return Ol(l),g=br(Bn),s===null?(x=Oy(),x===null&&(x=Qt,E=My(),x.pooledCache=E,E.refCount++,E!==null&&(x.pooledCacheLanes|=f),x=E),l.memoizedState={parent:g,cache:x},jy(l),ho(l,Bn,x)):((s.lanes&f)!==0&&(zy(s,l),Sf(l,null,null,f),Ef()),x=s.memoizedState,E=l.memoizedState,x.parent!==g?(x={parent:g,cache:g},l.memoizedState=x,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=x),ho(l,Bn,g)):(g=E.cache,ho(l,Bn,g),g!==x.cache&&Ny(l,[Bn],f,!0))),xr(s,l,l.pendingProps.children,f),l.child;case 29:throw l.pendingProps}throw Error(r(156,l.tag))}function bs(s){s.flags|=4}function bb(s,l,f,g,x){if((l=(s.mode&32)!==0)&&(l=!1),l){if(s.flags|=16777216,(x&335544128)===x)if(s.stateNode.complete)s.flags|=8192;else if(JA())s.flags|=8192;else throw zl=Rg,Vy}else s.flags&=-16777217}function CA(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!FC(l))if(JA())s.flags|=8192;else throw zl=Rg,Vy}function $g(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?Rt():536870912,s.lanes|=l,yu|=l)}function Df(s,l){if(!Dt)switch(s.tailMode){case"hidden":l=s.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s.tail=null:f.sibling=null;break;case"collapsed":f=s.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:g.sibling=null}}function nn(s){var l=s.alternate!==null&&s.alternate.child===s.child,f=0,g=0;if(l)for(var x=s.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags&65011712,g|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags,g|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=g,s.childLanes=f,l}function tj(s,l,f){var g=l.pendingProps;switch(Cy(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nn(l),null;case 1:return nn(l),null;case 3:return f=l.stateNode,g=null,s!==null&&(g=s.memoizedState.cache),l.memoizedState.cache!==g&&(l.flags|=2048),gs(Bn),Ce(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(au(l)?bs(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Ry())),nn(l),null;case 26:var x=l.type,E=l.memoizedState;return s===null?(bs(l),E!==null?(nn(l),CA(l,E)):(nn(l),bb(l,x,null,g,f))):E?E!==s.memoizedState?(bs(l),nn(l),CA(l,E)):(nn(l),l.flags&=-16777217):(s=s.memoizedProps,s!==g&&bs(l),nn(l),bb(l,x,s,g,f)),null;case 27:if(xe(l),f=se.current,x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==g&&bs(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return nn(l),null}s=ie.current,au(l)?sT(l):(s=PC(x,g,f),l.stateNode=s,bs(l))}return nn(l),null;case 5:if(xe(l),x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==g&&bs(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return nn(l),null}if(E=ie.current,au(l))sT(l);else{var N=om(se.current);switch(E){case 1:E=N.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:E=N.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":E=N.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":E=N.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":E=N.createElement("div"),E.innerHTML="<script><\/script>",E=E.removeChild(E.firstChild);break;case"select":E=typeof g.is=="string"?N.createElement("select",{is:g.is}):N.createElement("select"),g.multiple?E.multiple=!0:g.size&&(E.size=g.size);break;default:E=typeof g.is=="string"?N.createElement(x,{is:g.is}):N.createElement(x)}}E[jn]=l,E[ur]=g;e:for(N=l.child;N!==null;){if(N.tag===5||N.tag===6)E.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===l)break e;for(;N.sibling===null;){if(N.return===null||N.return===l)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}l.stateNode=E;e:switch(_r(E,x,g),x){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&bs(l)}}return nn(l),bb(l,l.type,s===null?null:s.memoizedProps,l.pendingProps,f),null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==g&&bs(l);else{if(typeof g!="string"&&l.stateNode===null)throw Error(r(166));if(s=se.current,au(l)){if(s=l.stateNode,f=l.memoizedProps,g=null,x=yr,x!==null)switch(x.tag){case 27:case 5:g=x.memoizedProps}s[jn]=l,s=!!(s.nodeValue===f||g!==null&&g.suppressHydrationWarning===!0||EC(s.nodeValue,f)),s||fo(l,!0)}else s=om(s).createTextNode(g),s[jn]=l,l.stateNode=s}return nn(l),null;case 31:if(f=l.memoizedState,s===null||s.memoizedState!==null){if(g=au(l),f!==null){if(s===null){if(!g)throw Error(r(318));if(s=l.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(557));s[jn]=l}else Ml(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;nn(l),s=!1}else f=Ry(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),s=!0;if(!s)return l.flags&256?(pi(l),l):(pi(l),null);if((l.flags&128)!==0)throw Error(r(558))}return nn(l),null;case 13:if(g=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=au(l),g!==null&&g.dehydrated!==null){if(s===null){if(!x)throw Error(r(318));if(x=l.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[jn]=l}else Ml(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;nn(l),x=!1}else x=Ry(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return l.flags&256?(pi(l),l):(pi(l),null)}return pi(l),(l.flags&128)!==0?(l.lanes=f,l):(f=g!==null,s=s!==null&&s.memoizedState!==null,f&&(g=l.child,x=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(x=g.alternate.memoizedState.cachePool.pool),E=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(E=g.memoizedState.cachePool.pool),E!==x&&(g.flags|=2048)),f!==s&&f&&(l.child.flags|=8192),$g(l,l.updateQueue),nn(l),null);case 4:return Ce(),s===null&&Ub(l.stateNode.containerInfo),nn(l),null;case 10:return gs(l.type),nn(l),null;case 19:if(Y(kn),g=l.memoizedState,g===null)return nn(l),null;if(x=(l.flags&128)!==0,E=g.rendering,E===null)if(x)Df(g,!1);else{if(xn!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(E=Mg(s),E!==null){for(l.flags|=128,Df(g,!1),s=E.updateQueue,l.updateQueue=s,$g(l,s),l.subtreeFlags=0,s=f,f=l.child;f!==null;)tT(f,s),f=f.sibling;return ne(kn,kn.current&1|2),Dt&&hs(l,g.treeForkCount),l.child}s=s.sibling}g.tail!==null&&bt()>Qg&&(l.flags|=128,x=!0,Df(g,!1),l.lanes=4194304)}else{if(!x)if(s=Mg(E),s!==null){if(l.flags|=128,x=!0,s=s.updateQueue,l.updateQueue=s,$g(l,s),Df(g,!0),g.tail===null&&g.tailMode==="hidden"&&!E.alternate&&!Dt)return nn(l),null}else 2*bt()-g.renderingStartTime>Qg&&f!==536870912&&(l.flags|=128,x=!0,Df(g,!1),l.lanes=4194304);g.isBackwards?(E.sibling=l.child,l.child=E):(s=g.last,s!==null?s.sibling=E:l.child=E,g.last=E)}return g.tail!==null?(s=g.tail,g.rendering=s,g.tail=s.sibling,g.renderingStartTime=bt(),s.sibling=null,f=kn.current,ne(kn,x?f&1|2:f&1),Dt&&hs(l,g.treeForkCount),s):(nn(l),null);case 22:case 23:return pi(l),Fy(),g=l.memoizedState!==null,s!==null?s.memoizedState!==null!==g&&(l.flags|=8192):g&&(l.flags|=8192),g?(f&536870912)!==0&&(l.flags&128)===0&&(nn(l),l.subtreeFlags&6&&(l.flags|=8192)):nn(l),f=l.updateQueue,f!==null&&$g(l,f.retryQueue),f=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),g=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),g!==f&&(l.flags|=2048),s!==null&&Y(Vl),null;case 24:return f=null,s!==null&&(f=s.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),gs(Bn),nn(l),null;case 25:return null;case 30:return null}throw Error(r(156,l.tag))}function nj(s,l){switch(Cy(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return gs(Bn),Ce(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return xe(l),null;case 31:if(l.memoizedState!==null){if(pi(l),l.alternate===null)throw Error(r(340));Ml()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 13:if(pi(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(r(340));Ml()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return Y(kn),null;case 4:return Ce(),null;case 10:return gs(l.type),null;case 22:case 23:return pi(l),Fy(),s!==null&&Y(Vl),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return gs(Bn),null;case 25:return null;default:return null}}function IA(s,l){switch(Cy(l),l.tag){case 3:gs(Bn),Ce();break;case 26:case 27:case 5:xe(l);break;case 4:Ce();break;case 31:l.memoizedState!==null&&pi(l);break;case 13:pi(l);break;case 19:Y(kn);break;case 10:gs(l.type);break;case 22:case 23:pi(l),Fy(),s!==null&&Y(Vl);break;case 24:gs(Bn)}}function kf(s,l){try{var f=l.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var x=g.next;f=x;do{if((f.tag&s)===s){g=void 0;var E=f.create,N=f.inst;g=E(),N.destroy=g}f=f.next}while(f!==x)}}catch(G){Ft(l,l.return,G)}}function bo(s,l,f){try{var g=l.updateQueue,x=g!==null?g.lastEffect:null;if(x!==null){var E=x.next;g=E;do{if((g.tag&s)===s){var N=g.inst,G=N.destroy;if(G!==void 0){N.destroy=void 0,x=l;var K=f,ue=G;try{ue()}catch(ve){Ft(x,K,ve)}}}g=g.next}while(g!==E)}}catch(ve){Ft(l,l.return,ve)}}function RA(s){var l=s.updateQueue;if(l!==null){var f=s.stateNode;try{bT(l,f)}catch(g){Ft(s,s.return,g)}}}function DA(s,l,f){f.props=Ul(s.type,s.memoizedProps),f.state=s.memoizedState;try{f.componentWillUnmount()}catch(g){Ft(s,l,g)}}function Nf(s,l){try{var f=s.ref;if(f!==null){switch(s.tag){case 26:case 27:case 5:var g=s.stateNode;break;case 30:g=s.stateNode;break;default:g=s.stateNode}typeof f=="function"?s.refCleanup=f(g):f.current=g}}catch(x){Ft(s,l,x)}}function ja(s,l){var f=s.ref,g=s.refCleanup;if(f!==null)if(typeof g=="function")try{g()}catch(x){Ft(s,l,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(x){Ft(s,l,x)}else f.current=null}function kA(s){var l=s.type,f=s.memoizedProps,g=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":f.autoFocus&&g.focus();break e;case"img":f.src?g.src=f.src:f.srcSet&&(g.srcset=f.srcSet)}}catch(x){Ft(s,s.return,x)}}function xb(s,l,f){try{var g=s.stateNode;Sj(g,s.type,f,l),g[ur]=l}catch(x){Ft(s,s.return,x)}}function NA(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Ao(s.type)||s.tag===4}function _b(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||NA(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Ao(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function wb(s,l,f){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(s,l):(l=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,l.appendChild(s),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=ea));else if(g!==4&&(g===27&&Ao(s.type)&&(f=s.stateNode,l=null),s=s.child,s!==null))for(wb(s,l,f),s=s.sibling;s!==null;)wb(s,l,f),s=s.sibling}function Yg(s,l,f){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?f.insertBefore(s,l):f.appendChild(s);else if(g!==4&&(g===27&&Ao(s.type)&&(f=s.stateNode),s=s.child,s!==null))for(Yg(s,l,f),s=s.sibling;s!==null;)Yg(s,l,f),s=s.sibling}function MA(s){var l=s.stateNode,f=s.memoizedProps;try{for(var g=s.type,x=l.attributes;x.length;)l.removeAttributeNode(x[0]);_r(l,g,f),l[jn]=s,l[ur]=f}catch(E){Ft(s,s.return,E)}}var xs=!1,Gn=!1,Eb=!1,PA=typeof WeakSet=="function"?WeakSet:Set,fr=null;function rj(s,l){if(s=s.containerInfo,qb=pm,s=$S(s),my(s)){if("selectionStart"in s)var f={start:s.selectionStart,end:s.selectionEnd};else e:{f=(f=s.ownerDocument)&&f.defaultView||window;var g=f.getSelection&&f.getSelection();if(g&&g.rangeCount!==0){f=g.anchorNode;var x=g.anchorOffset,E=g.focusNode;g=g.focusOffset;try{f.nodeType,E.nodeType}catch{f=null;break e}var N=0,G=-1,K=-1,ue=0,ve=0,be=s,fe=null;t:for(;;){for(var pe;be!==f||x!==0&&be.nodeType!==3||(G=N+x),be!==E||g!==0&&be.nodeType!==3||(K=N+g),be.nodeType===3&&(N+=be.nodeValue.length),(pe=be.firstChild)!==null;)fe=be,be=pe;for(;;){if(be===s)break t;if(fe===f&&++ue===x&&(G=N),fe===E&&++ve===g&&(K=N),(pe=be.nextSibling)!==null)break;be=fe,fe=be.parentNode}be=pe}f=G===-1||K===-1?null:{start:G,end:K}}else f=null}f=f||{start:0,end:0}}else f=null;for(Hb={focusedElem:s,selectionRange:f},pm=!1,fr=l;fr!==null;)if(l=fr,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,fr=s;else for(;fr!==null;){switch(l=fr,E=l.alternate,s=l.flags,l.tag){case 0:if((s&4)!==0&&(s=l.updateQueue,s=s!==null?s.events:null,s!==null))for(f=0;f<s.length;f++)x=s[f],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&E!==null){s=void 0,f=l,x=E.memoizedProps,E=E.memoizedState,g=f.stateNode;try{var je=Ul(f.type,x);s=g.getSnapshotBeforeUpdate(je,E),g.__reactInternalSnapshotBeforeUpdate=s}catch(Je){Ft(f,f.return,Je)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,f=s.nodeType,f===9)Kb(s);else if(f===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Kb(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=l.sibling,s!==null){s.return=l.return,fr=s;break}fr=l.return}}function OA(s,l,f){var g=f.flags;switch(f.tag){case 0:case 11:case 15:ws(s,f),g&4&&kf(5,f);break;case 1:if(ws(s,f),g&4)if(s=f.stateNode,l===null)try{s.componentDidMount()}catch(N){Ft(f,f.return,N)}else{var x=Ul(f.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(x,l,s.__reactInternalSnapshotBeforeUpdate)}catch(N){Ft(f,f.return,N)}}g&64&&RA(f),g&512&&Nf(f,f.return);break;case 3:if(ws(s,f),g&64&&(s=f.updateQueue,s!==null)){if(l=null,f.child!==null)switch(f.child.tag){case 27:case 5:l=f.child.stateNode;break;case 1:l=f.child.stateNode}try{bT(s,l)}catch(N){Ft(f,f.return,N)}}break;case 27:l===null&&g&4&&MA(f);case 26:case 5:ws(s,f),l===null&&g&4&&kA(f),g&512&&Nf(f,f.return);break;case 12:ws(s,f);break;case 31:ws(s,f),g&4&&zA(s,f);break;case 13:ws(s,f),g&4&&LA(s,f),g&64&&(s=f.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(f=fj.bind(null,f),Nj(s,f))));break;case 22:if(g=f.memoizedState!==null||xs,!g){l=l!==null&&l.memoizedState!==null||Gn,x=xs;var E=Gn;xs=g,(Gn=l)&&!E?Es(s,f,(f.subtreeFlags&8772)!==0):ws(s,f),xs=x,Gn=E}break;case 30:break;default:ws(s,f)}}function VA(s){var l=s.alternate;l!==null&&(s.alternate=null,VA(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&Fc(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var on=null,Wr=!1;function _s(s,l,f){for(f=f.child;f!==null;)jA(s,l,f),f=f.sibling}function jA(s,l,f){if(yn&&typeof yn.onCommitFiberUnmount=="function")try{yn.onCommitFiberUnmount(jr,f)}catch{}switch(f.tag){case 26:Gn||ja(f,l),_s(s,l,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:Gn||ja(f,l);var g=on,x=Wr;Ao(f.type)&&(on=f.stateNode,Wr=!1),_s(s,l,f),Uf(f.stateNode),on=g,Wr=x;break;case 5:Gn||ja(f,l);case 6:if(g=on,x=Wr,on=null,_s(s,l,f),on=g,Wr=x,on!==null)if(Wr)try{(on.nodeType===9?on.body:on.nodeName==="HTML"?on.ownerDocument.body:on).removeChild(f.stateNode)}catch(E){Ft(f,l,E)}else try{on.removeChild(f.stateNode)}catch(E){Ft(f,l,E)}break;case 18:on!==null&&(Wr?(s=on,RC(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,f.stateNode),Au(s)):RC(on,f.stateNode));break;case 4:g=on,x=Wr,on=f.stateNode.containerInfo,Wr=!0,_s(s,l,f),on=g,Wr=x;break;case 0:case 11:case 14:case 15:bo(2,f,l),Gn||bo(4,f,l),_s(s,l,f);break;case 1:Gn||(ja(f,l),g=f.stateNode,typeof g.componentWillUnmount=="function"&&DA(f,l,g)),_s(s,l,f);break;case 21:_s(s,l,f);break;case 22:Gn=(g=Gn)||f.memoizedState!==null,_s(s,l,f),Gn=g;break;default:_s(s,l,f)}}function zA(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Au(s)}catch(f){Ft(l,l.return,f)}}}function LA(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Au(s)}catch(f){Ft(l,l.return,f)}}function ij(s){switch(s.tag){case 31:case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new PA),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new PA),l;default:throw Error(r(435,s.tag))}}function Kg(s,l){var f=ij(s);l.forEach(function(g){if(!f.has(g)){f.add(g);var x=hj.bind(null,s,g);g.then(x,x)}})}function Qr(s,l){var f=l.deletions;if(f!==null)for(var g=0;g<f.length;g++){var x=f[g],E=s,N=l,G=N;e:for(;G!==null;){switch(G.tag){case 27:if(Ao(G.type)){on=G.stateNode,Wr=!1;break e}break;case 5:on=G.stateNode,Wr=!1;break e;case 3:case 4:on=G.stateNode.containerInfo,Wr=!0;break e}G=G.return}if(on===null)throw Error(r(160));jA(E,N,x),on=null,Wr=!1,E=x.alternate,E!==null&&(E.return=null),x.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)BA(l,s),l=l.sibling}var sa=null;function BA(s,l){var f=s.alternate,g=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Qr(l,s),Zr(s),g&4&&(bo(3,s,s.return),kf(3,s),bo(5,s,s.return));break;case 1:Qr(l,s),Zr(s),g&512&&(Gn||f===null||ja(f,f.return)),g&64&&xs&&(s=s.updateQueue,s!==null&&(g=s.callbacks,g!==null&&(f=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=f===null?g:f.concat(g))));break;case 26:var x=sa;if(Qr(l,s),Zr(s),g&512&&(Gn||f===null||ja(f,f.return)),g&4){var E=f!==null?f.memoizedState:null;if(g=s.memoizedState,f===null)if(g===null)if(s.stateNode===null){e:{g=s.type,f=s.memoizedProps,x=x.ownerDocument||x;t:switch(g){case"title":E=x.getElementsByTagName("title")[0],(!E||E[Ea]||E[jn]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=x.createElement(g),x.head.insertBefore(E,x.querySelector("head > title"))),_r(E,g,f),E[jn]=s,zn(E),g=E;break e;case"link":var N=BC("link","href",x).get(g+(f.href||""));if(N){for(var G=0;G<N.length;G++)if(E=N[G],E.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&E.getAttribute("rel")===(f.rel==null?null:f.rel)&&E.getAttribute("title")===(f.title==null?null:f.title)&&E.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){N.splice(G,1);break t}}E=x.createElement(g),_r(E,g,f),x.head.appendChild(E);break;case"meta":if(N=BC("meta","content",x).get(g+(f.content||""))){for(G=0;G<N.length;G++)if(E=N[G],E.getAttribute("content")===(f.content==null?null:""+f.content)&&E.getAttribute("name")===(f.name==null?null:f.name)&&E.getAttribute("property")===(f.property==null?null:f.property)&&E.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&E.getAttribute("charset")===(f.charSet==null?null:f.charSet)){N.splice(G,1);break t}}E=x.createElement(g),_r(E,g,f),x.head.appendChild(E);break;default:throw Error(r(468,g))}E[jn]=s,zn(E),g=E}s.stateNode=g}else UC(x,s.type,s.stateNode);else s.stateNode=LC(x,g,s.memoizedProps);else E!==g?(E===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):E.count--,g===null?UC(x,s.type,s.stateNode):LC(x,g,s.memoizedProps)):g===null&&s.stateNode!==null&&xb(s,s.memoizedProps,f.memoizedProps)}break;case 27:Qr(l,s),Zr(s),g&512&&(Gn||f===null||ja(f,f.return)),f!==null&&g&4&&xb(s,s.memoizedProps,f.memoizedProps);break;case 5:if(Qr(l,s),Zr(s),g&512&&(Gn||f===null||ja(f,f.return)),s.flags&32){x=s.stateNode;try{Xr(x,"")}catch(je){Ft(s,s.return,je)}}g&4&&s.stateNode!=null&&(x=s.memoizedProps,xb(s,x,f!==null?f.memoizedProps:x)),g&1024&&(Eb=!0);break;case 6:if(Qr(l,s),Zr(s),g&4){if(s.stateNode===null)throw Error(r(162));g=s.memoizedProps,f=s.stateNode;try{f.nodeValue=g}catch(je){Ft(s,s.return,je)}}break;case 3:if(um=null,x=sa,sa=lm(l.containerInfo),Qr(l,s),sa=x,Zr(s),g&4&&f!==null&&f.memoizedState.isDehydrated)try{Au(l.containerInfo)}catch(je){Ft(s,s.return,je)}Eb&&(Eb=!1,UA(s));break;case 4:g=sa,sa=lm(s.stateNode.containerInfo),Qr(l,s),Zr(s),sa=g;break;case 12:Qr(l,s),Zr(s);break;case 31:Qr(l,s),Zr(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Kg(s,g)));break;case 13:Qr(l,s),Zr(s),s.child.flags&8192&&s.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Wg=bt()),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Kg(s,g)));break;case 22:x=s.memoizedState!==null;var K=f!==null&&f.memoizedState!==null,ue=xs,ve=Gn;if(xs=ue||x,Gn=ve||K,Qr(l,s),Gn=ve,xs=ue,Zr(s),g&8192)e:for(l=s.stateNode,l._visibility=x?l._visibility&-2:l._visibility|1,x&&(f===null||K||xs||Gn||Fl(s)),f=null,l=s;;){if(l.tag===5||l.tag===26){if(f===null){K=f=l;try{if(E=K.stateNode,x)N=E.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{G=K.stateNode;var be=K.memoizedProps.style,fe=be!=null&&be.hasOwnProperty("display")?be.display:null;G.style.display=fe==null||typeof fe=="boolean"?"":(""+fe).trim()}}catch(je){Ft(K,K.return,je)}}}else if(l.tag===6){if(f===null){K=l;try{K.stateNode.nodeValue=x?"":K.memoizedProps}catch(je){Ft(K,K.return,je)}}}else if(l.tag===18){if(f===null){K=l;try{var pe=K.stateNode;x?DC(pe,!0):DC(K.stateNode,!1)}catch(je){Ft(K,K.return,je)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;f===l&&(f=null),l=l.return}f===l&&(f=null),l.sibling.return=l.return,l=l.sibling}g&4&&(g=s.updateQueue,g!==null&&(f=g.retryQueue,f!==null&&(g.retryQueue=null,Kg(s,f))));break;case 19:Qr(l,s),Zr(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Kg(s,g)));break;case 30:break;case 21:break;default:Qr(l,s),Zr(s)}}function Zr(s){var l=s.flags;if(l&2){try{for(var f,g=s.return;g!==null;){if(NA(g)){f=g;break}g=g.return}if(f==null)throw Error(r(160));switch(f.tag){case 27:var x=f.stateNode,E=_b(s);Yg(s,E,x);break;case 5:var N=f.stateNode;f.flags&32&&(Xr(N,""),f.flags&=-33);var G=_b(s);Yg(s,G,N);break;case 3:case 4:var K=f.stateNode.containerInfo,ue=_b(s);wb(s,ue,K);break;default:throw Error(r(161))}}catch(ve){Ft(s,s.return,ve)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function UA(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;UA(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function ws(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)OA(s,l.alternate,l),l=l.sibling}function Fl(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:bo(4,l,l.return),Fl(l);break;case 1:ja(l,l.return);var f=l.stateNode;typeof f.componentWillUnmount=="function"&&DA(l,l.return,f),Fl(l);break;case 27:Uf(l.stateNode);case 26:case 5:ja(l,l.return),Fl(l);break;case 22:l.memoizedState===null&&Fl(l);break;case 30:Fl(l);break;default:Fl(l)}s=s.sibling}}function Es(s,l,f){for(f=f&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var g=l.alternate,x=s,E=l,N=E.flags;switch(E.tag){case 0:case 11:case 15:Es(x,E,f),kf(4,E);break;case 1:if(Es(x,E,f),g=E,x=g.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(ue){Ft(g,g.return,ue)}if(g=E,x=g.updateQueue,x!==null){var G=g.stateNode;try{var K=x.shared.hiddenCallbacks;if(K!==null)for(x.shared.hiddenCallbacks=null,x=0;x<K.length;x++)yT(K[x],G)}catch(ue){Ft(g,g.return,ue)}}f&&N&64&&RA(E),Nf(E,E.return);break;case 27:MA(E);case 26:case 5:Es(x,E,f),f&&g===null&&N&4&&kA(E),Nf(E,E.return);break;case 12:Es(x,E,f);break;case 31:Es(x,E,f),f&&N&4&&zA(x,E);break;case 13:Es(x,E,f),f&&N&4&&LA(x,E);break;case 22:E.memoizedState===null&&Es(x,E,f),Nf(E,E.return);break;case 30:break;default:Es(x,E,f)}l=l.sibling}}function Sb(s,l){var f=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==f&&(s!=null&&s.refCount++,f!=null&&yf(f))}function Tb(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&yf(s))}function oa(s,l,f,g){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)FA(s,l,f,g),l=l.sibling}function FA(s,l,f,g){var x=l.flags;switch(l.tag){case 0:case 11:case 15:oa(s,l,f,g),x&2048&&kf(9,l);break;case 1:oa(s,l,f,g);break;case 3:oa(s,l,f,g),x&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&yf(s)));break;case 12:if(x&2048){oa(s,l,f,g),s=l.stateNode;try{var E=l.memoizedProps,N=E.id,G=E.onPostCommit;typeof G=="function"&&G(N,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(K){Ft(l,l.return,K)}}else oa(s,l,f,g);break;case 31:oa(s,l,f,g);break;case 13:oa(s,l,f,g);break;case 23:break;case 22:E=l.stateNode,N=l.alternate,l.memoizedState!==null?E._visibility&2?oa(s,l,f,g):Mf(s,l):E._visibility&2?oa(s,l,f,g):(E._visibility|=2,gu(s,l,f,g,(l.subtreeFlags&10256)!==0||!1)),x&2048&&Sb(N,l);break;case 24:oa(s,l,f,g),x&2048&&Tb(l.alternate,l);break;default:oa(s,l,f,g)}}function gu(s,l,f,g,x){for(x=x&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var E=s,N=l,G=f,K=g,ue=N.flags;switch(N.tag){case 0:case 11:case 15:gu(E,N,G,K,x),kf(8,N);break;case 23:break;case 22:var ve=N.stateNode;N.memoizedState!==null?ve._visibility&2?gu(E,N,G,K,x):Mf(E,N):(ve._visibility|=2,gu(E,N,G,K,x)),x&&ue&2048&&Sb(N.alternate,N);break;case 24:gu(E,N,G,K,x),x&&ue&2048&&Tb(N.alternate,N);break;default:gu(E,N,G,K,x)}l=l.sibling}}function Mf(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var f=s,g=l,x=g.flags;switch(g.tag){case 22:Mf(f,g),x&2048&&Sb(g.alternate,g);break;case 24:Mf(f,g),x&2048&&Tb(g.alternate,g);break;default:Mf(f,g)}l=l.sibling}}var Pf=8192;function mu(s,l,f){if(s.subtreeFlags&Pf)for(s=s.child;s!==null;)GA(s,l,f),s=s.sibling}function GA(s,l,f){switch(s.tag){case 26:mu(s,l,f),s.flags&Pf&&s.memoizedState!==null&&qj(f,sa,s.memoizedState,s.memoizedProps);break;case 5:mu(s,l,f);break;case 3:case 4:var g=sa;sa=lm(s.stateNode.containerInfo),mu(s,l,f),sa=g;break;case 22:s.memoizedState===null&&(g=s.alternate,g!==null&&g.memoizedState!==null?(g=Pf,Pf=16777216,mu(s,l,f),Pf=g):mu(s,l,f));break;default:mu(s,l,f)}}function qA(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function Of(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];fr=g,$A(g,s)}qA(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)HA(s),s=s.sibling}function HA(s){switch(s.tag){case 0:case 11:case 15:Of(s),s.flags&2048&&bo(9,s,s.return);break;case 3:Of(s);break;case 12:Of(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,Xg(s)):Of(s);break;default:Of(s)}}function Xg(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];fr=g,$A(g,s)}qA(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:bo(8,l,l.return),Xg(l);break;case 22:f=l.stateNode,f._visibility&2&&(f._visibility&=-3,Xg(l));break;default:Xg(l)}s=s.sibling}}function $A(s,l){for(;fr!==null;){var f=fr;switch(f.tag){case 0:case 11:case 15:bo(8,f,l);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var g=f.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:yf(f.memoizedState.cache)}if(g=f.child,g!==null)g.return=f,fr=g;else e:for(f=s;fr!==null;){g=fr;var x=g.sibling,E=g.return;if(VA(g),g===f){fr=null;break e}if(x!==null){x.return=E,fr=x;break e}fr=E}}}var aj={getCacheForType:function(s){var l=br(Bn),f=l.data.get(s);return f===void 0&&(f=s(),l.data.set(s,f)),f},cacheSignal:function(){return br(Bn).controller.signal}},sj=typeof WeakMap=="function"?WeakMap:Map,jt=0,Qt=null,wt=null,Tt=0,Ut=0,gi=null,xo=!1,vu=!1,Ab=!1,Ss=0,xn=0,_o=0,Gl=0,Cb=0,mi=0,yu=0,Vf=null,Jr=null,Ib=!1,Wg=0,YA=0,Qg=1/0,Zg=null,wo=null,er=0,Eo=null,bu=null,Ts=0,Rb=0,Db=null,KA=null,jf=0,kb=null;function vi(){return(jt&2)!==0&&Tt!==0?Tt&-Tt:$.T!==null?jb():Si()}function XA(){if(mi===0)if((Tt&536870912)===0||Dt){var s=Xe;Xe<<=1,(Xe&3932160)===0&&(Xe=262144),mi=s}else mi=536870912;return s=hi.current,s!==null&&(s.flags|=32),mi}function ei(s,l,f){(s===Qt&&(Ut===2||Ut===9)||s.cancelPendingCommit!==null)&&(xu(s,0),So(s,Tt,mi,!1)),Cn(s,f),((jt&2)===0||s!==Qt)&&(s===Qt&&((jt&2)===0&&(Gl|=f),xn===4&&So(s,Tt,mi,!1)),za(s))}function WA(s,l,f){if((jt&6)!==0)throw Error(r(327));var g=!f&&(l&127)===0&&(l&s.expiredLanes)===0||nt(s,l),x=g?cj(s,l):Mb(s,l,!0),E=g;do{if(x===0){vu&&!g&&So(s,l,0,!1);break}else{if(f=s.current.alternate,E&&!oj(f)){x=Mb(s,l,!1),E=!1;continue}if(x===2){if(E=l,s.errorRecoveryDisabledLanes&E)var N=0;else N=s.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){l=N;e:{var G=s;x=Vf;var K=G.current.memoizedState.isDehydrated;if(K&&(xu(G,N).flags|=256),N=Mb(G,N,!1),N!==2){if(Ab&&!K){G.errorRecoveryDisabledLanes|=E,Gl|=E,x=4;break e}E=Jr,Jr=x,E!==null&&(Jr===null?Jr=E:Jr.push.apply(Jr,E))}x=N}if(E=!1,x!==2)continue}}if(x===1){xu(s,0),So(s,l,0,!0);break}e:{switch(g=s,E=x,E){case 0:case 1:throw Error(r(345));case 4:if((l&4194048)!==l)break;case 6:So(g,l,mi,!xo);break e;case 2:Jr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((l&62914560)===l&&(x=Wg+300-bt(),10<x)){if(So(g,l,mi,!xo),Jt(g,0,!0)!==0)break e;Ts=l,g.timeoutHandle=CC(QA.bind(null,g,f,Jr,Zg,Ib,l,mi,Gl,yu,xo,E,"Throttled",-0,0),x);break e}QA(g,f,Jr,Zg,Ib,l,mi,Gl,yu,xo,E,null,-0,0)}}break}while(!0);za(s)}function QA(s,l,f,g,x,E,N,G,K,ue,ve,be,fe,pe){if(s.timeoutHandle=-1,be=l.subtreeFlags,be&8192||(be&16785408)===16785408){be={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ea},GA(l,E,be);var je=(E&62914560)===E?Wg-bt():(E&4194048)===E?YA-bt():0;if(je=Hj(be,je),je!==null){Ts=E,s.cancelPendingCommit=je(aC.bind(null,s,l,E,f,g,x,N,G,K,ve,be,null,fe,pe)),So(s,E,N,!ue);return}}aC(s,l,E,f,g,x,N,G,K)}function oj(s){for(var l=s;;){var f=l.tag;if((f===0||f===11||f===15)&&l.flags&16384&&(f=l.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var g=0;g<f.length;g++){var x=f[g],E=x.getSnapshot;x=x.value;try{if(!di(E(),x))return!1}catch{return!1}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function So(s,l,f,g){l&=~Cb,l&=~Gl,s.suspendedLanes|=l,s.pingedLanes&=~l,g&&(s.warmLanes|=l),g=s.expirationTimes;for(var x=l;0<x;){var E=31-en(x),N=1<<E;g[E]=-1,x&=~N}f!==0&&xt(s,f,l)}function Jg(){return(jt&6)===0?(zf(0),!1):!0}function Nb(){if(wt!==null){if(Ut===0)var s=wt.return;else s=wt,ps=Pl=null,Ky(s),uu=null,xf=0,s=wt;for(;s!==null;)IA(s.alternate,s),s=s.return;wt=null}}function xu(s,l){var f=s.timeoutHandle;f!==-1&&(s.timeoutHandle=-1,Cj(f)),f=s.cancelPendingCommit,f!==null&&(s.cancelPendingCommit=null,f()),Ts=0,Nb(),Qt=s,wt=f=fs(s.current,null),Tt=l,Ut=0,gi=null,xo=!1,vu=nt(s,l),Ab=!1,yu=mi=Cb=Gl=_o=xn=0,Jr=Vf=null,Ib=!1,(l&8)!==0&&(l|=l&32);var g=s.entangledLanes;if(g!==0)for(s=s.entanglements,g&=l;0<g;){var x=31-en(g),E=1<<x;l|=s[x],g&=~E}return Ss=l,xg(),f}function ZA(s,l){pt=null,$.H=If,l===cu||l===Ig?(l=pT(),Ut=3):l===Vy?(l=pT(),Ut=4):Ut=l===ub?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,gi=l,wt===null&&(xn=1,Fg(s,Di(l,s.current)))}function JA(){var s=hi.current;return s===null?!0:(Tt&4194048)===Tt?Pi===null:(Tt&62914560)===Tt||(Tt&536870912)!==0?s===Pi:!1}function eC(){var s=$.H;return $.H=If,s===null?If:s}function tC(){var s=$.A;return $.A=aj,s}function em(){xn=4,xo||(Tt&4194048)!==Tt&&hi.current!==null||(vu=!0),(_o&134217727)===0&&(Gl&134217727)===0||Qt===null||So(Qt,Tt,mi,!1)}function Mb(s,l,f){var g=jt;jt|=2;var x=eC(),E=tC();(Qt!==s||Tt!==l)&&(Zg=null,xu(s,l)),l=!1;var N=xn;e:do try{if(Ut!==0&&wt!==null){var G=wt,K=gi;switch(Ut){case 8:Nb(),N=6;break e;case 3:case 2:case 9:case 6:hi.current===null&&(l=!0);var ue=Ut;if(Ut=0,gi=null,_u(s,G,K,ue),f&&vu){N=0;break e}break;default:ue=Ut,Ut=0,gi=null,_u(s,G,K,ue)}}lj(),N=xn;break}catch(ve){ZA(s,ve)}while(!0);return l&&s.shellSuspendCounter++,ps=Pl=null,jt=g,$.H=x,$.A=E,wt===null&&(Qt=null,Tt=0,xg()),N}function lj(){for(;wt!==null;)nC(wt)}function cj(s,l){var f=jt;jt|=2;var g=eC(),x=tC();Qt!==s||Tt!==l?(Zg=null,Qg=bt()+500,xu(s,l)):vu=nt(s,l);e:do try{if(Ut!==0&&wt!==null){l=wt;var E=gi;t:switch(Ut){case 1:Ut=0,gi=null,_u(s,l,E,1);break;case 2:case 9:if(fT(E)){Ut=0,gi=null,rC(l);break}l=function(){Ut!==2&&Ut!==9||Qt!==s||(Ut=7),za(s)},E.then(l,l);break e;case 3:Ut=7;break e;case 4:Ut=5;break e;case 7:fT(E)?(Ut=0,gi=null,rC(l)):(Ut=0,gi=null,_u(s,l,E,7));break;case 5:var N=null;switch(wt.tag){case 26:N=wt.memoizedState;case 5:case 27:var G=wt;if(N?FC(N):G.stateNode.complete){Ut=0,gi=null;var K=G.sibling;if(K!==null)wt=K;else{var ue=G.return;ue!==null?(wt=ue,tm(ue)):wt=null}break t}}Ut=0,gi=null,_u(s,l,E,5);break;case 6:Ut=0,gi=null,_u(s,l,E,6);break;case 8:Nb(),xn=6;break e;default:throw Error(r(462))}}uj();break}catch(ve){ZA(s,ve)}while(!0);return ps=Pl=null,$.H=g,$.A=x,jt=f,wt!==null?0:(Qt=null,Tt=0,xg(),xn)}function uj(){for(;wt!==null&&!vn();)nC(wt)}function nC(s){var l=AA(s.alternate,s,Ss);s.memoizedProps=s.pendingProps,l===null?tm(s):wt=l}function rC(s){var l=s,f=l.alternate;switch(l.tag){case 15:case 0:l=xA(f,l,l.pendingProps,l.type,void 0,Tt);break;case 11:l=xA(f,l,l.pendingProps,l.type.render,l.ref,Tt);break;case 5:Ky(l);default:IA(f,l),l=wt=tT(l,Ss),l=AA(f,l,Ss)}s.memoizedProps=s.pendingProps,l===null?tm(s):wt=l}function _u(s,l,f,g){ps=Pl=null,Ky(l),uu=null,xf=0;var x=l.return;try{if(Z5(s,x,l,f,Tt)){xn=1,Fg(s,Di(f,s.current)),wt=null;return}}catch(E){if(x!==null)throw wt=x,E;xn=1,Fg(s,Di(f,s.current)),wt=null;return}l.flags&32768?(Dt||g===1?s=!0:vu||(Tt&536870912)!==0?s=!1:(xo=s=!0,(g===2||g===9||g===3||g===6)&&(g=hi.current,g!==null&&g.tag===13&&(g.flags|=16384))),iC(l,s)):tm(l)}function tm(s){var l=s;do{if((l.flags&32768)!==0){iC(l,xo);return}s=l.return;var f=tj(l.alternate,l,Ss);if(f!==null){wt=f;return}if(l=l.sibling,l!==null){wt=l;return}wt=l=s}while(l!==null);xn===0&&(xn=5)}function iC(s,l){do{var f=nj(s.alternate,s);if(f!==null){f.flags&=32767,wt=f;return}if(f=s.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!l&&(s=s.sibling,s!==null)){wt=s;return}wt=s=f}while(s!==null);xn=6,wt=null}function aC(s,l,f,g,x,E,N,G,K){s.cancelPendingCommit=null;do nm();while(er!==0);if((jt&6)!==0)throw Error(r(327));if(l!==null){if(l===s.current)throw Error(r(177));if(E=l.lanes|l.childLanes,E|=_y,fn(s,f,E,N,G,K),s===Qt&&(wt=Qt=null,Tt=0),bu=l,Eo=s,Ts=f,Rb=E,Db=x,KA=g,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,pj(Yr,function(){return uC(),null})):(s.callbackNode=null,s.callbackPriority=0),g=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||g){g=$.T,$.T=null,x=H.p,H.p=2,N=jt,jt|=4;try{rj(s,l,f)}finally{jt=N,H.p=x,$.T=g}}er=1,sC(),oC(),lC()}}function sC(){if(er===1){er=0;var s=Eo,l=bu,f=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||f){f=$.T,$.T=null;var g=H.p;H.p=2;var x=jt;jt|=4;try{BA(l,s);var E=Hb,N=$S(s.containerInfo),G=E.focusedElem,K=E.selectionRange;if(N!==G&&G&&G.ownerDocument&&HS(G.ownerDocument.documentElement,G)){if(K!==null&&my(G)){var ue=K.start,ve=K.end;if(ve===void 0&&(ve=ue),"selectionStart"in G)G.selectionStart=ue,G.selectionEnd=Math.min(ve,G.value.length);else{var be=G.ownerDocument||document,fe=be&&be.defaultView||window;if(fe.getSelection){var pe=fe.getSelection(),je=G.textContent.length,Je=Math.min(K.start,je),Kt=K.end===void 0?Je:Math.min(K.end,je);!pe.extend&&Je>Kt&&(N=Kt,Kt=Je,Je=N);var ae=qS(G,Je),ee=qS(G,Kt);if(ae&&ee&&(pe.rangeCount!==1||pe.anchorNode!==ae.node||pe.anchorOffset!==ae.offset||pe.focusNode!==ee.node||pe.focusOffset!==ee.offset)){var ce=be.createRange();ce.setStart(ae.node,ae.offset),pe.removeAllRanges(),Je>Kt?(pe.addRange(ce),pe.extend(ee.node,ee.offset)):(ce.setEnd(ee.node,ee.offset),pe.addRange(ce))}}}}for(be=[],pe=G;pe=pe.parentNode;)pe.nodeType===1&&be.push({element:pe,left:pe.scrollLeft,top:pe.scrollTop});for(typeof G.focus=="function"&&G.focus(),G=0;G<be.length;G++){var ye=be[G];ye.element.scrollLeft=ye.left,ye.element.scrollTop=ye.top}}pm=!!qb,Hb=qb=null}finally{jt=x,H.p=g,$.T=f}}s.current=l,er=2}}function oC(){if(er===2){er=0;var s=Eo,l=bu,f=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||f){f=$.T,$.T=null;var g=H.p;H.p=2;var x=jt;jt|=4;try{OA(s,l.alternate,l)}finally{jt=x,H.p=g,$.T=f}}er=3}}function lC(){if(er===4||er===3){er=0,dn();var s=Eo,l=bu,f=Ts,g=KA;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?er=5:(er=0,bu=Eo=null,cC(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(wo=null),Jn(f),l=l.stateNode,yn&&typeof yn.onCommitFiberRoot=="function")try{yn.onCommitFiberRoot(jr,l,void 0,(l.current.flags&128)===128)}catch{}if(g!==null){l=$.T,x=H.p,H.p=2,$.T=null;try{for(var E=s.onRecoverableError,N=0;N<g.length;N++){var G=g[N];E(G.value,{componentStack:G.stack})}}finally{$.T=l,H.p=x}}(Ts&3)!==0&&nm(),za(s),x=s.pendingLanes,(f&261930)!==0&&(x&42)!==0?s===kb?jf++:(jf=0,kb=s):jf=0,zf(0)}}function cC(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,yf(l)))}function nm(){return sC(),oC(),lC(),uC()}function uC(){if(er!==5)return!1;var s=Eo,l=Rb;Rb=0;var f=Jn(Ts),g=$.T,x=H.p;try{H.p=32>f?32:f,$.T=null,f=Db,Db=null;var E=Eo,N=Ts;if(er=0,bu=Eo=null,Ts=0,(jt&6)!==0)throw Error(r(331));var G=jt;if(jt|=4,HA(E.current),FA(E,E.current,N,f),jt=G,zf(0,!1),yn&&typeof yn.onPostCommitFiberRoot=="function")try{yn.onPostCommitFiberRoot(jr,E)}catch{}return!0}finally{H.p=x,$.T=g,cC(s,l)}}function dC(s,l,f){l=Di(f,l),l=cb(s.stateNode,l,2),s=mo(s,l,2),s!==null&&(Cn(s,2),za(s))}function Ft(s,l,f){if(s.tag===3)dC(s,s,f);else for(;l!==null;){if(l.tag===3){dC(l,s,f);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(wo===null||!wo.has(g))){s=Di(f,s),f=fA(2),g=mo(l,f,2),g!==null&&(hA(f,g,l,s),Cn(g,2),za(g));break}}l=l.return}}function Pb(s,l,f){var g=s.pingCache;if(g===null){g=s.pingCache=new sj;var x=new Set;g.set(l,x)}else x=g.get(l),x===void 0&&(x=new Set,g.set(l,x));x.has(f)||(Ab=!0,x.add(f),s=dj.bind(null,s,l,f),l.then(s,s))}function dj(s,l,f){var g=s.pingCache;g!==null&&g.delete(l),s.pingedLanes|=s.suspendedLanes&f,s.warmLanes&=~f,Qt===s&&(Tt&f)===f&&(xn===4||xn===3&&(Tt&62914560)===Tt&&300>bt()-Wg?(jt&2)===0&&xu(s,0):Cb|=f,yu===Tt&&(yu=0)),za(s)}function fC(s,l){l===0&&(l=Rt()),s=kl(s,l),s!==null&&(Cn(s,l),za(s))}function fj(s){var l=s.memoizedState,f=0;l!==null&&(f=l.retryLane),fC(s,f)}function hj(s,l){var f=0;switch(s.tag){case 31:case 13:var g=s.stateNode,x=s.memoizedState;x!==null&&(f=x.retryLane);break;case 19:g=s.stateNode;break;case 22:g=s.stateNode._retryCache;break;default:throw Error(r(314))}g!==null&&g.delete(l),fC(s,f)}function pj(s,l){return Ke(s,l)}var rm=null,wu=null,Ob=!1,im=!1,Vb=!1,To=0;function za(s){s!==wu&&s.next===null&&(wu===null?rm=wu=s:wu=wu.next=s),im=!0,Ob||(Ob=!0,mj())}function zf(s,l){if(!Vb&&im){Vb=!0;do for(var f=!1,g=rm;g!==null;){if(s!==0){var x=g.pendingLanes;if(x===0)var E=0;else{var N=g.suspendedLanes,G=g.pingedLanes;E=(1<<31-en(42|s)+1)-1,E&=x&~(N&~G),E=E&201326741?E&201326741|1:E?E|2:0}E!==0&&(f=!0,mC(g,E))}else E=Tt,E=Jt(g,g===Qt?E:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(E&3)===0||nt(g,E)||(f=!0,mC(g,E));g=g.next}while(f);Vb=!1}}function gj(){hC()}function hC(){im=Ob=!1;var s=0;To!==0&&Aj()&&(s=To);for(var l=bt(),f=null,g=rm;g!==null;){var x=g.next,E=pC(g,l);E===0?(g.next=null,f===null?rm=x:f.next=x,x===null&&(wu=f)):(f=g,(s!==0||(E&3)!==0)&&(im=!0)),g=x}er!==0&&er!==5||zf(s),To!==0&&(To=0)}function pC(s,l){for(var f=s.suspendedLanes,g=s.pingedLanes,x=s.expirationTimes,E=s.pendingLanes&-62914561;0<E;){var N=31-en(E),G=1<<N,K=x[N];K===-1?((G&f)===0||(G&g)!==0)&&(x[N]=An(G,l)):K<=l&&(s.expiredLanes|=G),E&=~G}if(l=Qt,f=Tt,f=Jt(s,s===l?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g=s.callbackNode,f===0||s===l&&(Ut===2||Ut===9)||s.cancelPendingCommit!==null)return g!==null&&g!==null&&Mt(g),s.callbackNode=null,s.callbackPriority=0;if((f&3)===0||nt(s,f)){if(l=f&-f,l===s.callbackPriority)return l;switch(g!==null&&Mt(g),Jn(f)){case 2:case 8:f=Qn;break;case 32:f=Yr;break;case 268435456:f=Zs;break;default:f=Yr}return g=gC.bind(null,s),f=Ke(f,g),s.callbackPriority=l,s.callbackNode=f,l}return g!==null&&g!==null&&Mt(g),s.callbackPriority=2,s.callbackNode=null,2}function gC(s,l){if(er!==0&&er!==5)return s.callbackNode=null,s.callbackPriority=0,null;var f=s.callbackNode;if(nm()&&s.callbackNode!==f)return null;var g=Tt;return g=Jt(s,s===Qt?g:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g===0?null:(WA(s,g,l),pC(s,bt()),s.callbackNode!=null&&s.callbackNode===f?gC.bind(null,s):null)}function mC(s,l){if(nm())return null;WA(s,l,!0)}function mj(){Ij(function(){(jt&6)!==0?Ke(Cr,gj):hC()})}function jb(){if(To===0){var s=ou;s===0&&(s=dt,dt<<=1,(dt&261888)===0&&(dt=256)),To=s}return To}function vC(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:$c(""+s)}function yC(s,l){var f=l.ownerDocument.createElement("input");return f.name=l.name,f.value=l.value,s.id&&f.setAttribute("form",s.id),l.parentNode.insertBefore(f,l),s=new FormData(s),f.parentNode.removeChild(f),s}function vj(s,l,f,g,x){if(l==="submit"&&f&&f.stateNode===x){var E=vC((x[ur]||null).action),N=g.submitter;N&&(l=(l=N[ur]||null)?vC(l.formAction):N.getAttribute("formAction"),l!==null&&(E=l,N=null));var G=new ka("action","action",null,g,x);s.push({event:G,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(To!==0){var K=N?yC(x,N):new FormData(x);rb(f,{pending:!0,data:K,method:x.method,action:E},null,K)}}else typeof E=="function"&&(G.preventDefault(),K=N?yC(x,N):new FormData(x),rb(f,{pending:!0,data:K,method:x.method,action:E},E,K))},currentTarget:x}]})}}for(var zb=0;zb<xy.length;zb++){var Lb=xy[zb],yj=Lb.toLowerCase(),bj=Lb[0].toUpperCase()+Lb.slice(1);aa(yj,"on"+bj)}aa(XS,"onAnimationEnd"),aa(WS,"onAnimationIteration"),aa(QS,"onAnimationStart"),aa("dblclick","onDoubleClick"),aa("focusin","onFocus"),aa("focusout","onBlur"),aa(O5,"onTransitionRun"),aa(V5,"onTransitionStart"),aa(j5,"onTransitionCancel"),aa(ZS,"onTransitionEnd"),Ca("onMouseEnter",["mouseout","mouseover"]),Ca("onMouseLeave",["mouseout","mouseover"]),Ca("onPointerEnter",["pointerout","pointerover"]),Ca("onPointerLeave",["pointerout","pointerover"]),Aa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Aa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Aa("onBeforeInput",["compositionend","keypress","textInput","paste"]),Aa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Aa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Aa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Lf));function bC(s,l){l=(l&4)!==0;for(var f=0;f<s.length;f++){var g=s[f],x=g.event;g=g.listeners;e:{var E=void 0;if(l)for(var N=g.length-1;0<=N;N--){var G=g[N],K=G.instance,ue=G.currentTarget;if(G=G.listener,K!==E&&x.isPropagationStopped())break e;E=G,x.currentTarget=ue;try{E(x)}catch(ve){bg(ve)}x.currentTarget=null,E=K}else for(N=0;N<g.length;N++){if(G=g[N],K=G.instance,ue=G.currentTarget,G=G.listener,K!==E&&x.isPropagationStopped())break e;E=G,x.currentTarget=ue;try{E(x)}catch(ve){bg(ve)}x.currentTarget=null,E=K}}}}function Et(s,l){var f=l[Uc];f===void 0&&(f=l[Uc]=new Set);var g=s+"__bubble";f.has(g)||(xC(l,s,2,!1),f.add(g))}function Bb(s,l,f){var g=0;l&&(g|=4),xC(f,s,g,l)}var am="_reactListening"+Math.random().toString(36).slice(2);function Ub(s){if(!s[am]){s[am]=!0,Wd.forEach(function(f){f!=="selectionchange"&&(xj.has(f)||Bb(f,!1,s),Bb(f,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[am]||(l[am]=!0,Bb("selectionchange",!1,l))}}function xC(s,l,f,g){switch(XC(l)){case 2:var x=Kj;break;case 8:x=Xj;break;default:x=n1}f=x.bind(null,l,f,s),x=void 0,!El||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(x=!0),g?x!==void 0?s.addEventListener(l,f,{capture:!0,passive:x}):s.addEventListener(l,f,!0):x!==void 0?s.addEventListener(l,f,{passive:x}):s.addEventListener(l,f,!1)}function Fb(s,l,f,g,x){var E=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var N=g.tag;if(N===3||N===4){var G=g.stateNode.containerInfo;if(G===x)break;if(N===4)for(N=g.return;N!==null;){var K=N.tag;if((K===3||K===4)&&N.stateNode.containerInfo===x)return;N=N.return}for(;G!==null;){if(N=Sa(G),N===null)return;if(K=N.tag,K===5||K===6||K===26||K===27){g=E=N;continue e}G=G.parentNode}}g=g.return}ao(function(){var ue=E,ve=Ai(f),be=[];e:{var fe=JS.get(s);if(fe!==void 0){var pe=ka,je=s;switch(s){case"keypress":if(Tl(f)===0)break e;case"keydown":case"keyup":pe=mg;break;case"focusin":je="focus",pe=Cl;break;case"focusout":je="blur",pe=Cl;break;case"beforeblur":case"afterblur":pe=Cl;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pe=uf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pe=og;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pe=D;break;case XS:case WS:case QS:pe=cg;break;case ZS:pe=q;break;case"scroll":case"scrollend":pe=cf;break;case"wheel":pe=he;break;case"copy":case"cut":case"paste":pe=ug;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pe=ds;break;case"toggle":case"beforetoggle":pe=ht}var Je=(l&4)!==0,Kt=!Je&&(s==="scroll"||s==="scrollend"),ae=Je?fe!==null?fe+"Capture":null:fe;Je=[];for(var ee=ue,ce;ee!==null;){var ye=ee;if(ce=ye.stateNode,ye=ye.tag,ye!==5&&ye!==26&&ye!==27||ce===null||ae===null||(ye=ta(ee,ae),ye!=null&&Je.push(Bf(ee,ye,ce))),Kt)break;ee=ee.return}0<Je.length&&(fe=new pe(fe,je,null,f,ve),be.push({event:fe,listeners:Je}))}}if((l&7)===0){e:{if(fe=s==="mouseover"||s==="pointerover",pe=s==="mouseout"||s==="pointerout",fe&&f!==sf&&(je=f.relatedTarget||f.fromElement)&&(Sa(je)||je[wa]))break e;if((pe||fe)&&(fe=ve.window===ve?ve:(fe=ve.ownerDocument)?fe.defaultView||fe.parentWindow:window,pe?(je=f.relatedTarget||f.toElement,pe=ue,je=je?Sa(je):null,je!==null&&(Kt=a(je),Je=je.tag,je!==Kt||Je!==5&&Je!==27&&Je!==6)&&(je=null)):(pe=null,je=ue),pe!==je)){if(Je=uf,ye="onMouseLeave",ae="onMouseEnter",ee="mouse",(s==="pointerout"||s==="pointerover")&&(Je=ds,ye="onPointerLeave",ae="onPointerEnter",ee="pointer"),Kt=pe==null?fe:ci(pe),ce=je==null?fe:ci(je),fe=new Je(ye,ee+"leave",pe,f,ve),fe.target=Kt,fe.relatedTarget=ce,ye=null,Sa(ve)===ue&&(Je=new Je(ae,ee+"enter",je,f,ve),Je.target=ce,Je.relatedTarget=Kt,ye=Je),Kt=ye,pe&&je)t:{for(Je=_j,ae=pe,ee=je,ce=0,ye=ae;ye;ye=Je(ye))ce++;ye=0;for(var He=ee;He;He=Je(He))ye++;for(;0<ce-ye;)ae=Je(ae),ce--;for(;0<ye-ce;)ee=Je(ee),ye--;for(;ce--;){if(ae===ee||ee!==null&&ae===ee.alternate){Je=ae;break t}ae=Je(ae),ee=Je(ee)}Je=null}else Je=null;pe!==null&&_C(be,fe,pe,Je,!1),je!==null&&Kt!==null&&_C(be,Kt,je,Je,!0)}}e:{if(fe=ue?ci(ue):window,pe=fe.nodeName&&fe.nodeName.toLowerCase(),pe==="select"||pe==="input"&&fe.type==="file")var Pt=zS;else if(VS(fe))if(LS)Pt=N5;else{Pt=D5;var Ue=R5}else pe=fe.nodeName,!pe||pe.toLowerCase()!=="input"||fe.type!=="checkbox"&&fe.type!=="radio"?ue&&Hc(ue.elementType)&&(Pt=zS):Pt=k5;if(Pt&&(Pt=Pt(s,ue))){jS(be,Pt,f,ve);break e}Ue&&Ue(s,fe,ue),s==="focusout"&&ue&&fe.type==="number"&&ue.memoizedProps.value!=null&&nf(fe,"number",fe.value)}switch(Ue=ue?ci(ue):window,s){case"focusin":(VS(Ue)||Ue.contentEditable==="true")&&(Jc=Ue,vy=ue,gf=null);break;case"focusout":gf=vy=Jc=null;break;case"mousedown":yy=!0;break;case"contextmenu":case"mouseup":case"dragend":yy=!1,YS(be,f,ve);break;case"selectionchange":if(P5)break;case"keydown":case"keyup":YS(be,f,ve)}var vt;if(Vt)e:{switch(s){case"compositionstart":var At="onCompositionStart";break e;case"compositionend":At="onCompositionEnd";break e;case"compositionupdate":At="onCompositionUpdate";break e}At=void 0}else Zc?Il(s,f)&&(At="onCompositionEnd"):s==="keydown"&&f.keyCode===229&&(At="onCompositionStart");At&&(Pa&&f.locale!=="ko"&&(Zc||At!=="onCompositionStart"?At==="onCompositionEnd"&&Zc&&(vt=lf()):(Da=ve,of="value"in Da?Da.value:Da.textContent,Zc=!0)),Ue=sm(ue,At),0<Ue.length&&(At=new Ma(At,s,null,f,ve),be.push({event:At,listeners:Ue}),vt?At.data=vt:(vt=Qc(f),vt!==null&&(At.data=vt)))),(vt=Ii?T5(s,f):A5(s,f))&&(At=sm(ue,"onBeforeInput"),0<At.length&&(Ue=new Ma("onBeforeInput","beforeinput",null,f,ve),be.push({event:Ue,listeners:At}),Ue.data=vt)),vj(be,s,ue,f,ve)}bC(be,l)})}function Bf(s,l,f){return{instance:s,listener:l,currentTarget:f}}function sm(s,l){for(var f=l+"Capture",g=[];s!==null;){var x=s,E=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||E===null||(x=ta(s,f),x!=null&&g.unshift(Bf(s,x,E)),x=ta(s,l),x!=null&&g.push(Bf(s,x,E))),s.tag===3)return g;s=s.return}return[]}function _j(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function _C(s,l,f,g,x){for(var E=l._reactName,N=[];f!==null&&f!==g;){var G=f,K=G.alternate,ue=G.stateNode;if(G=G.tag,K!==null&&K===g)break;G!==5&&G!==26&&G!==27||ue===null||(K=ue,x?(ue=ta(f,E),ue!=null&&N.unshift(Bf(f,ue,K))):x||(ue=ta(f,E),ue!=null&&N.push(Bf(f,ue,K)))),f=f.return}N.length!==0&&s.push({event:l,listeners:N})}var wj=/\r\n?/g,Ej=/\u0000|\uFFFD/g;function wC(s){return(typeof s=="string"?s:""+s).replace(wj,`
`).replace(Ej,"")}function EC(s,l){return l=wC(l),wC(s)===l}function Yt(s,l,f,g,x,E){switch(f){case"children":typeof g=="string"?l==="body"||l==="textarea"&&g===""||Xr(s,g):(typeof g=="number"||typeof g=="bigint")&&l!=="body"&&Xr(s,""+g);break;case"className":ui(s,"class",g);break;case"tabIndex":ui(s,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":ui(s,f,g);break;case"style":af(s,g,E);break;case"data":if(l!=="object"){ui(s,"data",g);break}case"src":case"href":if(g===""&&(l!=="a"||f!=="href")){s.removeAttribute(f);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(f);break}g=$c(""+g),s.setAttribute(f,g);break;case"action":case"formAction":if(typeof g=="function"){s.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(f==="formAction"?(l!=="input"&&Yt(s,l,"name",x.name,x,null),Yt(s,l,"formEncType",x.formEncType,x,null),Yt(s,l,"formMethod",x.formMethod,x,null),Yt(s,l,"formTarget",x.formTarget,x,null)):(Yt(s,l,"encType",x.encType,x,null),Yt(s,l,"method",x.method,x,null),Yt(s,l,"target",x.target,x,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(f);break}g=$c(""+g),s.setAttribute(f,g);break;case"onClick":g!=null&&(s.onclick=ea);break;case"onScroll":g!=null&&Et("scroll",s);break;case"onScrollEnd":g!=null&&Et("scrollend",s);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"multiple":s.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":s.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){s.removeAttribute("xlink:href");break}f=$c(""+g),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,""+g):s.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,""):s.removeAttribute(f);break;case"capture":case"download":g===!0?s.setAttribute(f,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,g):s.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?s.setAttribute(f,g):s.removeAttribute(f);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?s.removeAttribute(f):s.setAttribute(f,g);break;case"popover":Et("beforetoggle",s),Et("toggle",s),Gc(s,"popover",g);break;case"xlinkActuate":Ln(s,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":Ln(s,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":Ln(s,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":Ln(s,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":Ln(s,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":Ln(s,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":Ln(s,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":Ln(s,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":Ln(s,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":Gc(s,"is",g);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=sg.get(f)||f,Gc(s,f,g))}}function Gb(s,l,f,g,x,E){switch(f){case"style":af(s,g,E);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"children":typeof g=="string"?Xr(s,g):(typeof g=="number"||typeof g=="bigint")&&Xr(s,""+g);break;case"onScroll":g!=null&&Et("scroll",s);break;case"onScrollEnd":g!=null&&Et("scrollend",s);break;case"onClick":g!=null&&(s.onclick=ea);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Qd.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(x=f.endsWith("Capture"),l=f.slice(2,x?f.length-7:void 0),E=s[ur]||null,E=E!=null?E[f]:null,typeof E=="function"&&s.removeEventListener(l,E,x),typeof g=="function")){typeof E!="function"&&E!==null&&(f in s?s[f]=null:s.hasAttribute(f)&&s.removeAttribute(f)),s.addEventListener(l,g,x);break e}f in s?s[f]=g:g===!0?s.setAttribute(f,""):Gc(s,f,g)}}}function _r(s,l,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Et("error",s),Et("load",s);var g=!1,x=!1,E;for(E in f)if(f.hasOwnProperty(E)){var N=f[E];if(N!=null)switch(E){case"src":g=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Yt(s,l,E,N,f,null)}}x&&Yt(s,l,"srcSet",f.srcSet,f,null),g&&Yt(s,l,"src",f.src,f,null);return;case"input":Et("invalid",s);var G=E=N=x=null,K=null,ue=null;for(g in f)if(f.hasOwnProperty(g)){var ve=f[g];if(ve!=null)switch(g){case"name":x=ve;break;case"type":N=ve;break;case"checked":K=ve;break;case"defaultChecked":ue=ve;break;case"value":E=ve;break;case"defaultValue":G=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(r(137,l));break;default:Yt(s,l,g,ve,f,null)}}rg(s,E,G,K,ue,N,x,!1);return;case"select":Et("invalid",s),g=N=E=null;for(x in f)if(f.hasOwnProperty(x)&&(G=f[x],G!=null))switch(x){case"value":E=G;break;case"defaultValue":N=G;break;case"multiple":g=G;default:Yt(s,l,x,G,f,null)}l=E,f=N,s.multiple=!!g,l!=null?to(s,!!g,l,!1):f!=null&&to(s,!!g,f,!0);return;case"textarea":Et("invalid",s),E=x=g=null;for(N in f)if(f.hasOwnProperty(N)&&(G=f[N],G!=null))switch(N){case"value":g=G;break;case"defaultValue":x=G;break;case"children":E=G;break;case"dangerouslySetInnerHTML":if(G!=null)throw Error(r(91));break;default:Yt(s,l,N,G,f,null)}no(s,g,x,E);return;case"option":for(K in f)if(f.hasOwnProperty(K)&&(g=f[K],g!=null))switch(K){case"selected":s.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:Yt(s,l,K,g,f,null)}return;case"dialog":Et("beforetoggle",s),Et("toggle",s),Et("cancel",s),Et("close",s);break;case"iframe":case"object":Et("load",s);break;case"video":case"audio":for(g=0;g<Lf.length;g++)Et(Lf[g],s);break;case"image":Et("error",s),Et("load",s);break;case"details":Et("toggle",s);break;case"embed":case"source":case"link":Et("error",s),Et("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ue in f)if(f.hasOwnProperty(ue)&&(g=f[ue],g!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Yt(s,l,ue,g,f,null)}return;default:if(Hc(l)){for(ve in f)f.hasOwnProperty(ve)&&(g=f[ve],g!==void 0&&Gb(s,l,ve,g,f,void 0));return}}for(G in f)f.hasOwnProperty(G)&&(g=f[G],g!=null&&Yt(s,l,G,g,f,null))}function Sj(s,l,f,g){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,E=null,N=null,G=null,K=null,ue=null,ve=null;for(pe in f){var be=f[pe];if(f.hasOwnProperty(pe)&&be!=null)switch(pe){case"checked":break;case"value":break;case"defaultValue":K=be;default:g.hasOwnProperty(pe)||Yt(s,l,pe,null,g,be)}}for(var fe in g){var pe=g[fe];if(be=f[fe],g.hasOwnProperty(fe)&&(pe!=null||be!=null))switch(fe){case"type":E=pe;break;case"name":x=pe;break;case"checked":ue=pe;break;case"defaultChecked":ve=pe;break;case"value":N=pe;break;case"defaultValue":G=pe;break;case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(r(137,l));break;default:pe!==be&&Yt(s,l,fe,pe,g,be)}}qc(s,N,G,K,ue,ve,E,x);return;case"select":pe=N=G=fe=null;for(E in f)if(K=f[E],f.hasOwnProperty(E)&&K!=null)switch(E){case"value":break;case"multiple":pe=K;default:g.hasOwnProperty(E)||Yt(s,l,E,null,g,K)}for(x in g)if(E=g[x],K=f[x],g.hasOwnProperty(x)&&(E!=null||K!=null))switch(x){case"value":fe=E;break;case"defaultValue":G=E;break;case"multiple":N=E;default:E!==K&&Yt(s,l,x,E,g,K)}l=G,f=N,g=pe,fe!=null?to(s,!!f,fe,!1):!!g!=!!f&&(l!=null?to(s,!!f,l,!0):to(s,!!f,f?[]:"",!1));return;case"textarea":pe=fe=null;for(G in f)if(x=f[G],f.hasOwnProperty(G)&&x!=null&&!g.hasOwnProperty(G))switch(G){case"value":break;case"children":break;default:Yt(s,l,G,null,g,x)}for(N in g)if(x=g[N],E=f[N],g.hasOwnProperty(N)&&(x!=null||E!=null))switch(N){case"value":fe=x;break;case"defaultValue":pe=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==E&&Yt(s,l,N,x,g,E)}ig(s,fe,pe);return;case"option":for(var je in f)if(fe=f[je],f.hasOwnProperty(je)&&fe!=null&&!g.hasOwnProperty(je))switch(je){case"selected":s.selected=!1;break;default:Yt(s,l,je,null,g,fe)}for(K in g)if(fe=g[K],pe=f[K],g.hasOwnProperty(K)&&fe!==pe&&(fe!=null||pe!=null))switch(K){case"selected":s.selected=fe&&typeof fe!="function"&&typeof fe!="symbol";break;default:Yt(s,l,K,fe,g,pe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Je in f)fe=f[Je],f.hasOwnProperty(Je)&&fe!=null&&!g.hasOwnProperty(Je)&&Yt(s,l,Je,null,g,fe);for(ue in g)if(fe=g[ue],pe=f[ue],g.hasOwnProperty(ue)&&fe!==pe&&(fe!=null||pe!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(r(137,l));break;default:Yt(s,l,ue,fe,g,pe)}return;default:if(Hc(l)){for(var Kt in f)fe=f[Kt],f.hasOwnProperty(Kt)&&fe!==void 0&&!g.hasOwnProperty(Kt)&&Gb(s,l,Kt,void 0,g,fe);for(ve in g)fe=g[ve],pe=f[ve],!g.hasOwnProperty(ve)||fe===pe||fe===void 0&&pe===void 0||Gb(s,l,ve,fe,g,pe);return}}for(var ae in f)fe=f[ae],f.hasOwnProperty(ae)&&fe!=null&&!g.hasOwnProperty(ae)&&Yt(s,l,ae,null,g,fe);for(be in g)fe=g[be],pe=f[be],!g.hasOwnProperty(be)||fe===pe||fe==null&&pe==null||Yt(s,l,be,fe,g,pe)}function SC(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Tj(){if(typeof performance.getEntriesByType=="function"){for(var s=0,l=0,f=performance.getEntriesByType("resource"),g=0;g<f.length;g++){var x=f[g],E=x.transferSize,N=x.initiatorType,G=x.duration;if(E&&G&&SC(N)){for(N=0,G=x.responseEnd,g+=1;g<f.length;g++){var K=f[g],ue=K.startTime;if(ue>G)break;var ve=K.transferSize,be=K.initiatorType;ve&&SC(be)&&(K=K.responseEnd,N+=ve*(K<G?1:(G-ue)/(K-ue)))}if(--g,l+=8*(E+N)/(x.duration/1e3),s++,10<s)break}}if(0<s)return l/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var qb=null,Hb=null;function om(s){return s.nodeType===9?s:s.ownerDocument}function TC(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function AC(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function $b(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Yb=null;function Aj(){var s=window.event;return s&&s.type==="popstate"?s===Yb?!1:(Yb=s,!0):(Yb=null,!1)}var CC=typeof setTimeout=="function"?setTimeout:void 0,Cj=typeof clearTimeout=="function"?clearTimeout:void 0,IC=typeof Promise=="function"?Promise:void 0,Ij=typeof queueMicrotask=="function"?queueMicrotask:typeof IC<"u"?function(s){return IC.resolve(null).then(s).catch(Rj)}:CC;function Rj(s){setTimeout(function(){throw s})}function Ao(s){return s==="head"}function RC(s,l){var f=l,g=0;do{var x=f.nextSibling;if(s.removeChild(f),x&&x.nodeType===8)if(f=x.data,f==="/$"||f==="/&"){if(g===0){s.removeChild(x),Au(l);return}g--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")g++;else if(f==="html")Uf(s.ownerDocument.documentElement);else if(f==="head"){f=s.ownerDocument.head,Uf(f);for(var E=f.firstChild;E;){var N=E.nextSibling,G=E.nodeName;E[Ea]||G==="SCRIPT"||G==="STYLE"||G==="LINK"&&E.rel.toLowerCase()==="stylesheet"||f.removeChild(E),E=N}}else f==="body"&&Uf(s.ownerDocument.body);f=x}while(f);Au(l)}function DC(s,l){var f=s;s=0;do{var g=f.nextSibling;if(f.nodeType===1?l?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(l?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),g&&g.nodeType===8)if(f=g.data,f==="/$"){if(s===0)break;s--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||s++;f=g}while(f)}function Kb(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var f=l;switch(l=l.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":Kb(f),Fc(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}s.removeChild(f)}}function Dj(s,l,f,g){for(;s.nodeType===1;){var x=f;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!g&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(g){if(!s[Ea])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(E=s.getAttribute("rel"),E==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(E!==x.rel||s.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||s.getAttribute("title")!==(x.title==null?null:x.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(E=s.getAttribute("src"),(E!==(x.src==null?null:x.src)||s.getAttribute("type")!==(x.type==null?null:x.type)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&E&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var E=x.name==null?null:""+x.name;if(x.type==="hidden"&&s.getAttribute("name")===E)return s}else return s;if(s=Oi(s.nextSibling),s===null)break}return null}function kj(s,l,f){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!f||(s=Oi(s.nextSibling),s===null))return null;return s}function kC(s,l){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Oi(s.nextSibling),s===null))return null;return s}function Xb(s){return s.data==="$?"||s.data==="$~"}function Wb(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function Nj(s,l){var f=s.ownerDocument;if(s.data==="$~")s._reactRetry=l;else if(s.data!=="$?"||f.readyState!=="loading")l();else{var g=function(){l(),f.removeEventListener("DOMContentLoaded",g)};f.addEventListener("DOMContentLoaded",g),s._reactRetry=g}}function Oi(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return s}var Qb=null;function NC(s){s=s.nextSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="/$"||f==="/&"){if(l===0)return Oi(s.nextSibling);l--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||l++}s=s.nextSibling}return null}function MC(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(l===0)return s;l--}else f!=="/$"&&f!=="/&"||l++}s=s.previousSibling}return null}function PC(s,l,f){switch(l=om(f),s){case"html":if(s=l.documentElement,!s)throw Error(r(452));return s;case"head":if(s=l.head,!s)throw Error(r(453));return s;case"body":if(s=l.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function Uf(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);Fc(s)}var Vi=new Map,OC=new Set;function lm(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var As=H.d;H.d={f:Mj,r:Pj,D:Oj,C:Vj,L:jj,m:zj,X:Bj,S:Lj,M:Uj};function Mj(){var s=As.f(),l=Jg();return s||l}function Pj(s){var l=Ti(s);l!==null&&l.tag===5&&l.type==="form"?ZT(l):As.r(s)}var Eu=typeof document>"u"?null:document;function VC(s,l,f){var g=Eu;if(g&&typeof l=="string"&&l){var x=Kr(l);x='link[rel="'+s+'"][href="'+x+'"]',typeof f=="string"&&(x+='[crossorigin="'+f+'"]'),OC.has(x)||(OC.add(x),s={rel:s,crossOrigin:f,href:l},g.querySelector(x)===null&&(l=g.createElement("link"),_r(l,"link",s),zn(l),g.head.appendChild(l)))}}function Oj(s){As.D(s),VC("dns-prefetch",s,null)}function Vj(s,l){As.C(s,l),VC("preconnect",s,l)}function jj(s,l,f){As.L(s,l,f);var g=Eu;if(g&&s&&l){var x='link[rel="preload"][as="'+Kr(l)+'"]';l==="image"&&f&&f.imageSrcSet?(x+='[imagesrcset="'+Kr(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(x+='[imagesizes="'+Kr(f.imageSizes)+'"]')):x+='[href="'+Kr(s)+'"]';var E=x;switch(l){case"style":E=Su(s);break;case"script":E=Tu(s)}Vi.has(E)||(s=p({rel:"preload",href:l==="image"&&f&&f.imageSrcSet?void 0:s,as:l},f),Vi.set(E,s),g.querySelector(x)!==null||l==="style"&&g.querySelector(Ff(E))||l==="script"&&g.querySelector(Gf(E))||(l=g.createElement("link"),_r(l,"link",s),zn(l),g.head.appendChild(l)))}}function zj(s,l){As.m(s,l);var f=Eu;if(f&&s){var g=l&&typeof l.as=="string"?l.as:"script",x='link[rel="modulepreload"][as="'+Kr(g)+'"][href="'+Kr(s)+'"]',E=x;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=Tu(s)}if(!Vi.has(E)&&(s=p({rel:"modulepreload",href:s},l),Vi.set(E,s),f.querySelector(x)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Gf(E)))return}g=f.createElement("link"),_r(g,"link",s),zn(g),f.head.appendChild(g)}}}function Lj(s,l,f){As.S(s,l,f);var g=Eu;if(g&&s){var x=Ta(g).hoistableStyles,E=Su(s);l=l||"default";var N=x.get(E);if(!N){var G={loading:0,preload:null};if(N=g.querySelector(Ff(E)))G.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":l},f),(f=Vi.get(E))&&Zb(s,f);var K=N=g.createElement("link");zn(K),_r(K,"link",s),K._p=new Promise(function(ue,ve){K.onload=ue,K.onerror=ve}),K.addEventListener("load",function(){G.loading|=1}),K.addEventListener("error",function(){G.loading|=2}),G.loading|=4,cm(N,l,g)}N={type:"stylesheet",instance:N,count:1,state:G},x.set(E,N)}}}function Bj(s,l){As.X(s,l);var f=Eu;if(f&&s){var g=Ta(f).hoistableScripts,x=Tu(s),E=g.get(x);E||(E=f.querySelector(Gf(x)),E||(s=p({src:s,async:!0},l),(l=Vi.get(x))&&Jb(s,l),E=f.createElement("script"),zn(E),_r(E,"link",s),f.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},g.set(x,E))}}function Uj(s,l){As.M(s,l);var f=Eu;if(f&&s){var g=Ta(f).hoistableScripts,x=Tu(s),E=g.get(x);E||(E=f.querySelector(Gf(x)),E||(s=p({src:s,async:!0,type:"module"},l),(l=Vi.get(x))&&Jb(s,l),E=f.createElement("script"),zn(E),_r(E,"link",s),f.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},g.set(x,E))}}function jC(s,l,f,g){var x=(x=se.current)?lm(x):null;if(!x)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(l=Su(f.href),f=Ta(x).hoistableStyles,g=f.get(l),g||(g={type:"style",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){s=Su(f.href);var E=Ta(x).hoistableStyles,N=E.get(s);if(N||(x=x.ownerDocument||x,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(s,N),(E=x.querySelector(Ff(s)))&&!E._p&&(N.instance=E,N.state.loading=5),Vi.has(s)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},Vi.set(s,f),E||Fj(x,s,f,N.state))),l&&g===null)throw Error(r(528,""));return N}if(l&&g!==null)throw Error(r(529,""));return null;case"script":return l=f.async,f=f.src,typeof f=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Tu(f),f=Ta(x).hoistableScripts,g=f.get(l),g||(g={type:"script",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Su(s){return'href="'+Kr(s)+'"'}function Ff(s){return'link[rel="stylesheet"]['+s+"]"}function zC(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function Fj(s,l,f,g){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?g.loading=1:(l=s.createElement("link"),g.preload=l,l.addEventListener("load",function(){return g.loading|=1}),l.addEventListener("error",function(){return g.loading|=2}),_r(l,"link",f),zn(l),s.head.appendChild(l))}function Tu(s){return'[src="'+Kr(s)+'"]'}function Gf(s){return"script[async]"+s}function LC(s,l,f){if(l.count++,l.instance===null)switch(l.type){case"style":var g=s.querySelector('style[data-href~="'+Kr(f.href)+'"]');if(g)return l.instance=g,zn(g),g;var x=p({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return g=(s.ownerDocument||s).createElement("style"),zn(g),_r(g,"style",x),cm(g,f.precedence,s),l.instance=g;case"stylesheet":x=Su(f.href);var E=s.querySelector(Ff(x));if(E)return l.state.loading|=4,l.instance=E,zn(E),E;g=zC(f),(x=Vi.get(x))&&Zb(g,x),E=(s.ownerDocument||s).createElement("link"),zn(E);var N=E;return N._p=new Promise(function(G,K){N.onload=G,N.onerror=K}),_r(E,"link",g),l.state.loading|=4,cm(E,f.precedence,s),l.instance=E;case"script":return E=Tu(f.src),(x=s.querySelector(Gf(E)))?(l.instance=x,zn(x),x):(g=f,(x=Vi.get(E))&&(g=p({},f),Jb(g,x)),s=s.ownerDocument||s,x=s.createElement("script"),zn(x),_r(x,"link",g),s.head.appendChild(x),l.instance=x);case"void":return null;default:throw Error(r(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(g=l.instance,l.state.loading|=4,cm(g,f.precedence,s));return l.instance}function cm(s,l,f){for(var g=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=g.length?g[g.length-1]:null,E=x,N=0;N<g.length;N++){var G=g[N];if(G.dataset.precedence===l)E=G;else if(E!==x)break}E?E.parentNode.insertBefore(s,E.nextSibling):(l=f.nodeType===9?f.head:f,l.insertBefore(s,l.firstChild))}function Zb(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function Jb(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var um=null;function BC(s,l,f){if(um===null){var g=new Map,x=um=new Map;x.set(f,g)}else x=um,g=x.get(f),g||(g=new Map,x.set(f,g));if(g.has(s))return g;for(g.set(s,null),f=f.getElementsByTagName(s),x=0;x<f.length;x++){var E=f[x];if(!(E[Ea]||E[jn]||s==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var N=E.getAttribute(l)||"";N=s+N;var G=g.get(N);G?G.push(E):g.set(N,[E])}}return g}function UC(s,l,f){s=s.ownerDocument||s,s.head.insertBefore(f,l==="title"?s.querySelector("head > title"):null)}function Gj(s,l,f){if(f===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return s=l.disabled,typeof l.precedence=="string"&&s==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function FC(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function qj(s,l,f,g){if(f.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var x=Su(g.href),E=l.querySelector(Ff(x));if(E){l=E._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(s.count++,s=dm.bind(s),l.then(s,s)),f.state.loading|=4,f.instance=E,zn(E);return}E=l.ownerDocument||l,g=zC(g),(x=Vi.get(x))&&Zb(g,x),E=E.createElement("link"),zn(E);var N=E;N._p=new Promise(function(G,K){N.onload=G,N.onerror=K}),_r(E,"link",g),f.instance=E}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(f,l),(l=f.state.preload)&&(f.state.loading&3)===0&&(s.count++,f=dm.bind(s),l.addEventListener("load",f),l.addEventListener("error",f))}}var e1=0;function Hj(s,l){return s.stylesheets&&s.count===0&&hm(s,s.stylesheets),0<s.count||0<s.imgCount?function(f){var g=setTimeout(function(){if(s.stylesheets&&hm(s,s.stylesheets),s.unsuspend){var E=s.unsuspend;s.unsuspend=null,E()}},6e4+l);0<s.imgBytes&&e1===0&&(e1=62500*Tj());var x=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&hm(s,s.stylesheets),s.unsuspend)){var E=s.unsuspend;s.unsuspend=null,E()}},(s.imgBytes>e1?50:800)+l);return s.unsuspend=f,function(){s.unsuspend=null,clearTimeout(g),clearTimeout(x)}}:null}function dm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)hm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var fm=null;function hm(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,fm=new Map,l.forEach($j,s),fm=null,dm.call(s))}function $j(s,l){if(!(l.state.loading&4)){var f=fm.get(s);if(f)var g=f.get(null);else{f=new Map,fm.set(s,f);for(var x=s.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<x.length;E++){var N=x[E];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(f.set(N.dataset.precedence,N),g=N)}g&&f.set(null,g)}x=l.instance,N=x.getAttribute("data-precedence"),E=f.get(N)||g,E===g&&f.set(null,x),f.set(N,x),this.count++,g=dm.bind(this),x.addEventListener("load",g),x.addEventListener("error",g),E?E.parentNode.insertBefore(x,E.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(x,s.firstChild)),l.state.loading|=4}}var qf={$$typeof:R,Provider:null,Consumer:null,_currentValue:Z,_currentValue2:Z,_threadCount:0};function Yj(s,l,f,g,x,E,N,G,K){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=St(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=St(0),this.hiddenUpdates=St(null),this.identifierPrefix=g,this.onUncaughtError=x,this.onCaughtError=E,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=K,this.incompleteTransitions=new Map}function GC(s,l,f,g,x,E,N,G,K,ue,ve,be){return s=new Yj(s,l,f,N,K,ue,ve,be,G),l=1,E===!0&&(l|=24),E=fi(3,null,null,l),s.current=E,E.stateNode=s,l=My(),l.refCount++,s.pooledCache=l,l.refCount++,E.memoizedState={element:g,isDehydrated:f,cache:l},jy(E),s}function qC(s){return s?(s=nu,s):nu}function HC(s,l,f,g,x,E){x=qC(x),g.context===null?g.context=x:g.pendingContext=x,g=go(l),g.payload={element:f},E=E===void 0?null:E,E!==null&&(g.callback=E),f=mo(s,g,l),f!==null&&(ei(f,s,l),wf(f,s,l))}function $C(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var f=s.retryLane;s.retryLane=f!==0&&f<l?f:l}}function t1(s,l){$C(s,l),(s=s.alternate)&&$C(s,l)}function YC(s){if(s.tag===13||s.tag===31){var l=kl(s,67108864);l!==null&&ei(l,s,67108864),t1(s,67108864)}}function KC(s){if(s.tag===13||s.tag===31){var l=vi();l=li(l);var f=kl(s,l);f!==null&&ei(f,s,l),t1(s,l)}}var pm=!0;function Kj(s,l,f,g){var x=$.T;$.T=null;var E=H.p;try{H.p=2,n1(s,l,f,g)}finally{H.p=E,$.T=x}}function Xj(s,l,f,g){var x=$.T;$.T=null;var E=H.p;try{H.p=8,n1(s,l,f,g)}finally{H.p=E,$.T=x}}function n1(s,l,f,g){if(pm){var x=r1(g);if(x===null)Fb(s,l,g,gm,f),WC(s,g);else if(Qj(x,s,l,f,g))g.stopPropagation();else if(WC(s,g),l&4&&-1<Wj.indexOf(s)){for(;x!==null;){var E=Ti(x);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var N=Tn(E.pendingLanes);if(N!==0){var G=E;for(G.pendingLanes|=2,G.entangledLanes|=2;N;){var K=1<<31-en(N);G.entanglements[1]|=K,N&=~K}za(E),(jt&6)===0&&(Qg=bt()+500,zf(0))}}break;case 31:case 13:G=kl(E,2),G!==null&&ei(G,E,2),Jg(),t1(E,2)}if(E=r1(g),E===null&&Fb(s,l,g,gm,f),E===x)break;x=E}x!==null&&g.stopPropagation()}else Fb(s,l,g,null,f)}}function r1(s){return s=Ai(s),i1(s)}var gm=null;function i1(s){if(gm=null,s=Sa(s),s!==null){var l=a(s);if(l===null)s=null;else{var f=l.tag;if(f===13){if(s=o(l),s!==null)return s;s=null}else if(f===31){if(s=c(l),s!==null)return s;s=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return gm=s,null}function XC(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Lt()){case Cr:return 2;case Qn:return 8;case Yr:case ls:return 32;case Zs:return 268435456;default:return 32}default:return 32}}var a1=!1,Co=null,Io=null,Ro=null,Hf=new Map,$f=new Map,Do=[],Wj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function WC(s,l){switch(s){case"focusin":case"focusout":Co=null;break;case"dragenter":case"dragleave":Io=null;break;case"mouseover":case"mouseout":Ro=null;break;case"pointerover":case"pointerout":Hf.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":$f.delete(l.pointerId)}}function Yf(s,l,f,g,x,E){return s===null||s.nativeEvent!==E?(s={blockedOn:l,domEventName:f,eventSystemFlags:g,nativeEvent:E,targetContainers:[x]},l!==null&&(l=Ti(l),l!==null&&YC(l)),s):(s.eventSystemFlags|=g,l=s.targetContainers,x!==null&&l.indexOf(x)===-1&&l.push(x),s)}function Qj(s,l,f,g,x){switch(l){case"focusin":return Co=Yf(Co,s,l,f,g,x),!0;case"dragenter":return Io=Yf(Io,s,l,f,g,x),!0;case"mouseover":return Ro=Yf(Ro,s,l,f,g,x),!0;case"pointerover":var E=x.pointerId;return Hf.set(E,Yf(Hf.get(E)||null,s,l,f,g,x)),!0;case"gotpointercapture":return E=x.pointerId,$f.set(E,Yf($f.get(E)||null,s,l,f,g,x)),!0}return!1}function QC(s){var l=Sa(s.target);if(l!==null){var f=a(l);if(f!==null){if(l=f.tag,l===13){if(l=o(f),l!==null){s.blockedOn=l,Rn(s.priority,function(){KC(f)});return}}else if(l===31){if(l=c(f),l!==null){s.blockedOn=l,Rn(s.priority,function(){KC(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){s.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}s.blockedOn=null}function mm(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var f=r1(s.nativeEvent);if(f===null){f=s.nativeEvent;var g=new f.constructor(f.type,f);sf=g,f.target.dispatchEvent(g),sf=null}else return l=Ti(f),l!==null&&YC(l),s.blockedOn=f,!1;l.shift()}return!0}function ZC(s,l,f){mm(s)&&f.delete(l)}function Zj(){a1=!1,Co!==null&&mm(Co)&&(Co=null),Io!==null&&mm(Io)&&(Io=null),Ro!==null&&mm(Ro)&&(Ro=null),Hf.forEach(ZC),$f.forEach(ZC)}function vm(s,l){s.blockedOn===l&&(s.blockedOn=null,a1||(a1=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Zj)))}var ym=null;function JC(s){ym!==s&&(ym=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){ym===s&&(ym=null);for(var l=0;l<s.length;l+=3){var f=s[l],g=s[l+1],x=s[l+2];if(typeof g!="function"){if(i1(g||f)===null)continue;break}var E=Ti(f);E!==null&&(s.splice(l,3),l-=3,rb(E,{pending:!0,data:x,method:f.method,action:g},g,x))}}))}function Au(s){function l(K){return vm(K,s)}Co!==null&&vm(Co,s),Io!==null&&vm(Io,s),Ro!==null&&vm(Ro,s),Hf.forEach(l),$f.forEach(l);for(var f=0;f<Do.length;f++){var g=Do[f];g.blockedOn===s&&(g.blockedOn=null)}for(;0<Do.length&&(f=Do[0],f.blockedOn===null);)QC(f),f.blockedOn===null&&Do.shift();if(f=(s.ownerDocument||s).$$reactFormReplay,f!=null)for(g=0;g<f.length;g+=3){var x=f[g],E=f[g+1],N=x[ur]||null;if(typeof E=="function")N||JC(f);else if(N){var G=null;if(E&&E.hasAttribute("formAction")){if(x=E,N=E[ur]||null)G=N.formAction;else if(i1(x)!==null)continue}else G=N.action;typeof G=="function"?f[g+1]=G:(f.splice(g,3),g-=3),JC(f)}}}function e2(){function s(E){E.canIntercept&&E.info==="react-transition"&&E.intercept({handler:function(){return new Promise(function(N){return x=N})},focusReset:"manual",scroll:"manual"})}function l(){x!==null&&(x(),x=null),g||setTimeout(f,20)}function f(){if(!g&&!navigation.transition){var E=navigation.currentEntry;E&&E.url!=null&&navigation.navigate(E.url,{state:E.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,x=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(f,100),function(){g=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),x!==null&&(x(),x=null)}}}function s1(s){this._internalRoot=s}bm.prototype.render=s1.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(r(409));var f=l.current,g=vi();HC(f,g,s,l,null,null)},bm.prototype.unmount=s1.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;HC(s.current,2,null,s,null,null),Jg(),l[wa]=null}};function bm(s){this._internalRoot=s}bm.prototype.unstable_scheduleHydration=function(s){if(s){var l=Si();s={blockedOn:null,target:s,priority:l};for(var f=0;f<Do.length&&l!==0&&l<Do[f].priority;f++);Do.splice(f,0,s),f===0&&QC(s)}};var t2=e.version;if(t2!=="19.2.0")throw Error(r(527,t2,"19.2.0"));H.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(l),s=s!==null?h(s):null,s=s===null?null:s.stateNode,s};var Jj={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xm.isDisabled&&xm.supportsFiber)try{jr=xm.inject(Jj),yn=xm}catch{}}return Xf.createRoot=function(s,l){if(!i(s))throw Error(r(299));var f=!1,g="",x=lA,E=cA,N=uA;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(E=l.onCaughtError),l.onRecoverableError!==void 0&&(N=l.onRecoverableError)),l=GC(s,1,!1,null,null,f,g,null,x,E,N,e2),s[wa]=l.current,Ub(s),new s1(l)},Xf.hydrateRoot=function(s,l,f){if(!i(s))throw Error(r(299));var g=!1,x="",E=lA,N=cA,G=uA,K=null;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onUncaughtError!==void 0&&(E=f.onUncaughtError),f.onCaughtError!==void 0&&(N=f.onCaughtError),f.onRecoverableError!==void 0&&(G=f.onRecoverableError),f.formState!==void 0&&(K=f.formState)),l=GC(s,1,!0,l,f??null,g,x,K,E,N,G,e2),l.context=qC(null),f=l.current,g=vi(),g=li(g),x=go(g),x.callback=null,mo(f,x,g),f=g,l.current.lanes=f,Cn(l,f),za(l),s[wa]=l.current,Ub(s),new bm(l)},Xf.version="19.2.0",Xf}var d2;function u6(){if(d2)return c1.exports;d2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),c1.exports=c6(),c1.exports}var d6=u6();const f6="modulepreload",h6=function(n){return"/personal-budget-pwa/"+n},f2={},_n=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let d=function(h){return Promise.all(h.map(p=>Promise.resolve(p).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};var o=d;document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),u=c?.nonce||c?.getAttribute("nonce");i=d(t.map(h=>{if(h=h6(h),h in f2)return;f2[h]=!0;const p=h.endsWith(".css"),m=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${m}`))return;const b=document.createElement("link");if(b.rel=p?"stylesheet":f6,p||(b.as="script"),b.crossOrigin="",b.href=h,u&&b.setAttribute("nonce",u),document.head.appendChild(b),p)return new Promise((_,w)=>{b.addEventListener("load",_),b.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${h}`)))})}))}function a(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return i.then(c=>{for(const u of c||[])u.status==="rejected"&&a(u.reason);return e().catch(a)})};function p6(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:r,onRegistered:i,onRegisteredSW:a,onRegisterError:o}=n;let c,u;const d=async(p=!0)=>{await u};async function h(){if("serviceWorker"in navigator){if(c=await _n(async()=>{const{Workbox:p}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/personal-budget-pwa/sw.js",{scope:"/personal-budget-pwa/",type:"classic"})).catch(p=>{o?.(p)}),!c)return;c.addEventListener("activated",p=>{(p.isUpdate||p.isExternal)&&window.location.reload()}),c.addEventListener("installed",p=>{p.isUpdate||r?.()}),c.register({immediate:e}).then(p=>{a?a("/personal-budget-pwa/sw.js",p):i?.(p)}).catch(p=>{o?.(p)})}}return u=h(),d}var h2="popstate";function g6(n={}){function e(i,a){let{pathname:o="/",search:c="",hash:u=""}=Pc(i.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),dx("",{pathname:o,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(i,a){let o=i.document.querySelector("base"),c="";if(o&&o.getAttribute("href")){let u=i.location.href,d=u.indexOf("#");c=d===-1?u:u.slice(0,d)}return c+"#"+(typeof a=="string"?a:Vh(a))}function r(i,a){_i(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(a)})`)}return v6(e,t,r,n)}function mn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function _i(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function m6(){return Math.random().toString(36).substring(2,10)}function p2(n,e){return{usr:n.state,key:n.key,idx:e}}function dx(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Pc(e):e,state:t,key:e&&e.key||r||m6()}}function Vh({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Pc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function v6(n,e,t,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,c="POP",u=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function p(){c="POP";let S=h(),T=S==null?null:S-d;d=S,u&&u({action:c,location:w.location,delta:T})}function m(S,T){c="PUSH";let C=dx(w.location,S,T);t&&t(C,S),d=h()+1;let R=p2(C,d),j=w.createHref(C);try{o.pushState(R,"",j)}catch(z){if(z instanceof DOMException&&z.name==="DataCloneError")throw z;i.location.assign(j)}a&&u&&u({action:c,location:w.location,delta:1})}function b(S,T){c="REPLACE";let C=dx(w.location,S,T);t&&t(C,S),d=h();let R=p2(C,d),j=w.createHref(C);o.replaceState(R,"",j),a&&u&&u({action:c,location:w.location,delta:0})}function _(S){return y6(S)}let w={get action(){return c},get location(){return n(i,o)},listen(S){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(h2,p),u=S,()=>{i.removeEventListener(h2,p),u=null}},createHref(S){return e(i,S)},createURL:_,encodeLocation(S){let T=_(S);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:m,replace:b,go(S){return o.go(S)}};return w}function y6(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),mn(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:Vh(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function Gk(n,e,t="/"){return b6(n,e,t,!1)}function b6(n,e,t,r){let i=typeof e=="string"?Pc(e):e,a=js(i.pathname||"/",t);if(a==null)return null;let o=qk(n);x6(o);let c=null;for(let u=0;c==null&&u<o.length;++u){let d=k6(a);c=R6(o[u],d,r)}return c}function qk(n,e=[],t=[],r="",i=!1){let a=(o,c,u=i,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&u)return;mn(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let p=Ns([r,h.relativePath]),m=t.concat(h);o.children&&o.children.length>0&&(mn(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),qk(o.children,e,m,p,u)),!(o.path==null&&!o.index)&&e.push({path:p,score:C6(p,o.index),routesMeta:m})};return n.forEach((o,c)=>{if(o.path===""||!o.path?.includes("?"))a(o,c);else for(let u of Hk(o.path))a(o,c,!0,u)}),e}function Hk(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=Hk(r.join("/")),c=[];return c.push(...o.map(u=>u===""?a:[a,u].join("/"))),i&&c.push(...o),c.map(u=>n.startsWith("/")&&u===""?"/":u)}function x6(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:I6(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var _6=/^:[\w-]+$/,w6=3,E6=2,S6=1,T6=10,A6=-2,g2=n=>n==="*";function C6(n,e){let t=n.split("/"),r=t.length;return t.some(g2)&&(r+=A6),e&&(r+=E6),t.filter(i=>!g2(i)).reduce((i,a)=>i+(_6.test(a)?w6:a===""?S6:T6),r)}function I6(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function R6(n,e,t=!1){let{routesMeta:r}=n,i={},a="/",o=[];for(let c=0;c<r.length;++c){let u=r[c],d=c===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=E0({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),m=u.route;if(!p&&d&&t&&!r[r.length-1].route.index&&(p=E0({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:Ns([a,p.pathname]),pathnameBase:V6(Ns([a,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(a=Ns([a,p.pathnameBase]))}return o}function E0(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=D6(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:p},m)=>{if(h==="*"){let _=c[m]||"";o=a.slice(0,a.length-_.length).replace(/(.)\/+$/,"$1")}const b=c[m];return p&&!b?d[h]=void 0:d[h]=(b||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:n}}function D6(n,e=!1,t=!0){_i(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function k6(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return _i(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function js(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}var N6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,M6=n=>N6.test(n);function P6(n,e="/"){let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?Pc(n):n,a;if(t)if(M6(t))a=t;else{if(t.includes("//")){let o=t;t=t.replace(/\/\/+/g,"/"),_i(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${t}`)}t.startsWith("/")?a=m2(t.substring(1),"/"):a=m2(t,e)}else a=e;return{pathname:a,search:j6(r),hash:z6(i)}}function m2(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function h1(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function O6(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function $k(n){let e=O6(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function Yk(n,e,t,r=!1){let i;typeof n=="string"?i=Pc(n):(i={...n},mn(!i.pathname||!i.pathname.includes("?"),h1("?","pathname","search",i)),mn(!i.pathname||!i.pathname.includes("#"),h1("#","pathname","hash",i)),mn(!i.search||!i.search.includes("#"),h1("#","search","hash",i)));let a=n===""||i.pathname==="",o=a?"/":i.pathname,c;if(o==null)c=t;else{let p=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;i.pathname=m.join("/")}c=p>=0?e[p]:"/"}let u=P6(i,c),d=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}var Ns=n=>n.join("/").replace(/\/\/+/g,"/"),V6=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),j6=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,z6=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function L6(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Kk=["POST","PUT","PATCH","DELETE"];new Set(Kk);var B6=["GET",...Kk];new Set(B6);var Md=F.createContext(null);Md.displayName="DataRouter";var vv=F.createContext(null);vv.displayName="DataRouterState";F.createContext(!1);var Xk=F.createContext({isTransitioning:!1});Xk.displayName="ViewTransition";var U6=F.createContext(new Map);U6.displayName="Fetchers";var F6=F.createContext(null);F6.displayName="Await";var rs=F.createContext(null);rs.displayName="Navigation";var gp=F.createContext(null);gp.displayName="Location";var is=F.createContext({outlet:null,matches:[],isDataRoute:!1});is.displayName="Route";var Z_=F.createContext(null);Z_.displayName="RouteError";function G6(n,{relative:e}={}){mn(mp(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=F.useContext(rs),{hash:i,pathname:a,search:o}=vp(n,{relative:e}),c=a;return t!=="/"&&(c=a==="/"?t:Ns([t,a])),r.createHref({pathname:c,search:o,hash:i})}function mp(){return F.useContext(gp)!=null}function xa(){return mn(mp(),"useLocation() may be used only in the context of a <Router> component."),F.useContext(gp).location}var Wk="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Qk(n){F.useContext(rs).static||F.useLayoutEffect(n)}function as(){let{isDataRoute:n}=F.useContext(is);return n?rz():q6()}function q6(){mn(mp(),"useNavigate() may be used only in the context of a <Router> component.");let n=F.useContext(Md),{basename:e,navigator:t}=F.useContext(rs),{matches:r}=F.useContext(is),{pathname:i}=xa(),a=JSON.stringify($k(r)),o=F.useRef(!1);return Qk(()=>{o.current=!0}),F.useCallback((u,d={})=>{if(_i(o.current,Wk),!o.current)return;if(typeof u=="number"){t.go(u);return}let h=Yk(u,JSON.parse(a),i,d.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Ns([e,h.pathname])),(d.replace?t.replace:t.push)(h,d.state,d)},[e,t,a,i,n])}F.createContext(null);function H6(){let{matches:n}=F.useContext(is),e=n[n.length-1];return e?e.params:{}}function vp(n,{relative:e}={}){let{matches:t}=F.useContext(is),{pathname:r}=xa(),i=JSON.stringify($k(t));return F.useMemo(()=>Yk(n,JSON.parse(i),r,e==="path"),[n,i,r,e])}function $6(n,e){return Zk(n,e)}function Zk(n,e,t,r,i){mn(mp(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=F.useContext(rs),{matches:o}=F.useContext(is),c=o[o.length-1],u=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",p=c&&c.route;{let C=p&&p.path||"";Jk(d,!p||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let m=xa(),b;if(e){let C=typeof e=="string"?Pc(e):e;mn(h==="/"||C.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${C.pathname}" was given in the \`location\` prop.`),b=C}else b=m;let _=b.pathname||"/",w=_;if(h!=="/"){let C=h.replace(/^\//,"").split("/");w="/"+_.replace(/^\//,"").split("/").slice(C.length).join("/")}let S=Gk(n,{pathname:w});_i(p||S!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),_i(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=Q6(S&&S.map(C=>Object.assign({},C,{params:Object.assign({},u,C.params),pathname:Ns([h,a.encodeLocation?a.encodeLocation(C.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?h:Ns([h,a.encodeLocation?a.encodeLocation(C.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathnameBase])})),o,t,r,i);return e&&T?F.createElement(gp.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},T):T}function Y6(){let n=nz(),e=L6(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",n),o=F.createElement(F.Fragment,null,F.createElement("p",null," Hey developer "),F.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",F.createElement("code",{style:a},"ErrorBoundary")," or"," ",F.createElement("code",{style:a},"errorElement")," prop on your route.")),F.createElement(F.Fragment,null,F.createElement("h2",null,"Unexpected Application Error!"),F.createElement("h3",{style:{fontStyle:"italic"}},e),t?F.createElement("pre",{style:i},t):null,o)}var K6=F.createElement(Y6,null),X6=class extends F.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){return this.state.error!==void 0?F.createElement(is.Provider,{value:this.props.routeContext},F.createElement(Z_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function W6({routeContext:n,match:e,children:t}){let r=F.useContext(Md);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),F.createElement(is.Provider,{value:n},t)}function Q6(n,e=[],t=null,r=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,o=t?.errors;if(o!=null){let h=a.findIndex(p=>p.route.id&&o?.[p.route.id]!==void 0);mn(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let c=!1,u=-1;if(t)for(let h=0;h<a.length;h++){let p=a[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=h),p.route.id){let{loaderData:m,errors:b}=t,_=p.route.loader&&!m.hasOwnProperty(p.route.id)&&(!b||b[p.route.id]===void 0);if(p.route.lazy||_){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}let d=t&&r?(h,p)=>{r(h,{location:t.location,params:t.matches?.[0]?.params??{},errorInfo:p})}:void 0;return a.reduceRight((h,p,m)=>{let b,_=!1,w=null,S=null;t&&(b=o&&p.route.id?o[p.route.id]:void 0,w=p.route.errorElement||K6,c&&(u<0&&m===0?(Jk("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,S=null):u===m&&(_=!0,S=p.route.hydrateFallbackElement||null)));let T=e.concat(a.slice(0,m+1)),C=()=>{let R;return b?R=w:_?R=S:p.route.Component?R=F.createElement(p.route.Component,null):p.route.element?R=p.route.element:R=h,F.createElement(W6,{match:p,routeContext:{outlet:h,matches:T,isDataRoute:t!=null},children:R})};return t&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?F.createElement(X6,{location:t.location,revalidation:t.revalidation,component:w,error:b,children:C(),routeContext:{outlet:null,matches:T,isDataRoute:!0},onError:d}):C()},null)}function J_(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Z6(n){let e=F.useContext(Md);return mn(e,J_(n)),e}function J6(n){let e=F.useContext(vv);return mn(e,J_(n)),e}function ez(n){let e=F.useContext(is);return mn(e,J_(n)),e}function ew(n){let e=ez(n),t=e.matches[e.matches.length-1];return mn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function tz(){return ew("useRouteId")}function nz(){let n=F.useContext(Z_),e=J6("useRouteError"),t=ew("useRouteError");return n!==void 0?n:e.errors?.[t]}function rz(){let{router:n}=Z6("useNavigate"),e=ew("useNavigate"),t=F.useRef(!1);return Qk(()=>{t.current=!0}),F.useCallback(async(i,a={})=>{_i(t.current,Wk),t.current&&(typeof i=="number"?n.navigate(i):await n.navigate(i,{fromRouteId:e,...a}))},[n,e])}var v2={};function Jk(n,e,t){!e&&!v2[n]&&(v2[n]=!0,_i(!1,t))}F.memo(iz);function iz({routes:n,future:e,state:t,unstable_onError:r}){return Zk(n,void 0,t,r,e)}function Cs(n){mn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function az({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:i,static:a=!1}){mn(!mp(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=n.replace(/^\/*/,"/"),c=F.useMemo(()=>({basename:o,navigator:i,static:a,future:{}}),[o,i,a]);typeof t=="string"&&(t=Pc(t));let{pathname:u="/",search:d="",hash:h="",state:p=null,key:m="default"}=t,b=F.useMemo(()=>{let _=js(u,o);return _==null?null:{location:{pathname:_,search:d,hash:h,state:p,key:m},navigationType:r}},[o,u,d,h,p,m,r]);return _i(b!=null,`<Router basename="${o}"> is not able to match the URL "${u}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),b==null?null:F.createElement(rs.Provider,{value:c},F.createElement(gp.Provider,{children:e,value:b}))}function sz({children:n,location:e}){return $6(fx(n),e)}function fx(n,e=[]){let t=[];return F.Children.forEach(n,(r,i)=>{if(!F.isValidElement(r))return;let a=[...e,i];if(r.type===F.Fragment){t.push.apply(t,fx(r.props.children,a));return}mn(r.type===Cs,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),mn(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=fx(r.props.children,a)),t.push(o)}),t}var Wm="get",Qm="application/x-www-form-urlencoded";function yv(n){return n!=null&&typeof n.tagName=="string"}function oz(n){return yv(n)&&n.tagName.toLowerCase()==="button"}function lz(n){return yv(n)&&n.tagName.toLowerCase()==="form"}function cz(n){return yv(n)&&n.tagName.toLowerCase()==="input"}function uz(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function dz(n,e){return n.button===0&&(!e||e==="_self")&&!uz(n)}function hx(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let r=n[t];return e.concat(Array.isArray(r)?r.map(i=>[t,i]):[[t,r]])},[]))}function fz(n,e){let t=hx(n);return e&&e.forEach((r,i)=>{t.has(i)||e.getAll(i).forEach(a=>{t.append(i,a)})}),t}var wm=null;function hz(){if(wm===null)try{new FormData(document.createElement("form"),0),wm=!1}catch{wm=!0}return wm}var pz=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function p1(n){return n!=null&&!pz.has(n)?(_i(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Qm}"`),null):n}function gz(n,e){let t,r,i,a,o;if(lz(n)){let c=n.getAttribute("action");r=c?js(c,e):null,t=n.getAttribute("method")||Wm,i=p1(n.getAttribute("enctype"))||Qm,a=new FormData(n)}else if(oz(n)||cz(n)&&(n.type==="submit"||n.type==="image")){let c=n.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=n.getAttribute("formaction")||c.getAttribute("action");if(r=u?js(u,e):null,t=n.getAttribute("formmethod")||c.getAttribute("method")||Wm,i=p1(n.getAttribute("formenctype"))||p1(c.getAttribute("enctype"))||Qm,a=new FormData(c,n),!hz()){let{name:d,type:h,value:p}=n;if(h==="image"){let m=d?`${d}.`:"";a.append(`${m}x`,"0"),a.append(`${m}y`,"0")}else d&&a.append(d,p)}}else{if(yv(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Wm,r=null,i=Qm,o=n}return a&&i==="text/plain"&&(o=a,a=void 0),{action:r,method:t.toLowerCase(),encType:i,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function tw(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function mz(n,e,t){let r=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return r.pathname==="/"?r.pathname=`_root.${t}`:e&&js(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${t}`,r}async function vz(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function yz(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function bz(n,e,t){let r=await Promise.all(n.map(async i=>{let a=e.routes[i.route.id];if(a){let o=await vz(a,t);return o.links?o.links():[]}return[]}));return Ez(r.flat(1).filter(yz).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function y2(n,e,t,r,i,a){let o=(u,d)=>t[d]?u.route.id!==t[d].route.id:!0,c=(u,d)=>t[d].pathname!==u.pathname||t[d].route.path?.endsWith("*")&&t[d].params["*"]!==u.params["*"];return a==="assets"?e.filter((u,d)=>o(u,d)||c(u,d)):a==="data"?e.filter((u,d)=>{let h=r.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,d)||c(u,d))return!0;if(u.route.shouldRevalidate){let p=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function xz(n,e,{includeHydrateFallback:t}={}){return _z(n.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function _z(n){return[...new Set(n)]}function wz(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function Ez(n,e){let t=new Set;return new Set(e),n.reduce((r,i)=>{let a=JSON.stringify(wz(i));return t.has(a)||(t.add(a),r.push({key:a,link:i})),r},[])}function eN(){let n=F.useContext(Md);return tw(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function Sz(){let n=F.useContext(vv);return tw(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var nw=F.createContext(void 0);nw.displayName="FrameworkContext";function tN(){let n=F.useContext(nw);return tw(n,"You must render this element inside a <HydratedRouter> element"),n}function Tz(n,e){let t=F.useContext(nw),[r,i]=F.useState(!1),[a,o]=F.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:d,onMouseLeave:h,onTouchStart:p}=e,m=F.useRef(null);F.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let w=T=>{T.forEach(C=>{o(C.isIntersecting)})},S=new IntersectionObserver(w,{threshold:.5});return m.current&&S.observe(m.current),()=>{S.disconnect()}}},[n]),F.useEffect(()=>{if(r){let w=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(w)}}},[r]);let b=()=>{i(!0)},_=()=>{i(!1),o(!1)};return t?n!=="intent"?[a,m,{}]:[a,m,{onFocus:Wf(c,b),onBlur:Wf(u,_),onMouseEnter:Wf(d,b),onMouseLeave:Wf(h,_),onTouchStart:Wf(p,b)}]:[!1,m,{}]}function Wf(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function Az({page:n,...e}){let{router:t}=eN(),r=F.useMemo(()=>Gk(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?F.createElement(Iz,{page:n,matches:r,...e}):null}function Cz(n){let{manifest:e,routeModules:t}=tN(),[r,i]=F.useState([]);return F.useEffect(()=>{let a=!1;return bz(n,e,t).then(o=>{a||i(o)}),()=>{a=!0}},[n,e,t]),r}function Iz({page:n,matches:e,...t}){let r=xa(),{manifest:i,routeModules:a}=tN(),{basename:o}=eN(),{loaderData:c,matches:u}=Sz(),d=F.useMemo(()=>y2(n,e,u,i,r,"data"),[n,e,u,i,r]),h=F.useMemo(()=>y2(n,e,u,i,r,"assets"),[n,e,u,i,r]),p=F.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let _=new Set,w=!1;if(e.forEach(T=>{let C=i.routes[T.route.id];!C||!C.hasLoader||(!d.some(R=>R.route.id===T.route.id)&&T.route.id in c&&a[T.route.id]?.shouldRevalidate||C.hasClientLoader?w=!0:_.add(T.route.id))}),_.size===0)return[];let S=mz(n,o,"data");return w&&_.size>0&&S.searchParams.set("_routes",e.filter(T=>_.has(T.route.id)).map(T=>T.route.id).join(",")),[S.pathname+S.search]},[o,c,r,i,d,e,n,a]),m=F.useMemo(()=>xz(h,i),[h,i]),b=Cz(h);return F.createElement(F.Fragment,null,p.map(_=>F.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...t})),m.map(_=>F.createElement("link",{key:_,rel:"modulepreload",href:_,...t})),b.map(({key:_,link:w})=>F.createElement("link",{key:_,nonce:t.nonce,...w})))}function Rz(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var nN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{nN&&(window.__reactRouterVersion="7.9.6")}catch{}function Dz({basename:n,children:e,window:t}){let r=F.useRef();r.current==null&&(r.current=g6({window:t,v5Compat:!0}));let i=r.current,[a,o]=F.useState({action:i.action,location:i.location}),c=F.useCallback(u=>{F.startTransition(()=>o(u))},[o]);return F.useLayoutEffect(()=>i.listen(c),[i,c]),F.createElement(az,{basename:n,children:e,location:a.location,navigationType:a.action,navigator:i})}var rN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,iN=F.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:i,reloadDocument:a,replace:o,state:c,target:u,to:d,preventScrollReset:h,viewTransition:p,...m},b){let{basename:_}=F.useContext(rs),w=typeof d=="string"&&rN.test(d),S,T=!1;if(typeof d=="string"&&w&&(S=d,nN))try{let k=new URL(window.location.href),O=d.startsWith("//")?new URL(k.protocol+d):new URL(d),L=js(O.pathname,_);O.origin===k.origin&&L!=null?d=L+O.search+O.hash:T=!0}catch{_i(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let C=G6(d,{relative:i}),[R,j,z]=Tz(r,m),V=Pz(d,{replace:o,state:c,target:u,preventScrollReset:h,relative:i,viewTransition:p});function I(k){e&&e(k),k.defaultPrevented||V(k)}let A=F.createElement("a",{...m,...z,href:S||C,onClick:T||a?e:I,ref:Rz(b,j),target:u,"data-discover":!w&&t==="render"?"true":void 0});return R&&!w?F.createElement(F.Fragment,null,A,F.createElement(Az,{page:C})):A});iN.displayName="Link";var kz=F.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:i=!1,style:a,to:o,viewTransition:c,children:u,...d},h){let p=vp(o,{relative:d.relative}),m=xa(),b=F.useContext(vv),{navigator:_,basename:w}=F.useContext(rs),S=b!=null&&Bz(p)&&c===!0,T=_.encodeLocation?_.encodeLocation(p).pathname:p.pathname,C=m.pathname,R=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;t||(C=C.toLowerCase(),R=R?R.toLowerCase():null,T=T.toLowerCase()),R&&w&&(R=js(R,w)||R);const j=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let z=C===T||!i&&C.startsWith(T)&&C.charAt(j)==="/",V=R!=null&&(R===T||!i&&R.startsWith(T)&&R.charAt(T.length)==="/"),I={isActive:z,isPending:V,isTransitioning:S},A=z?e:void 0,k;typeof r=="function"?k=r(I):k=[r,z?"active":null,V?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let O=typeof a=="function"?a(I):a;return F.createElement(iN,{...d,"aria-current":A,className:k,ref:h,style:O,to:o,viewTransition:c},typeof u=="function"?u(I):u)});kz.displayName="NavLink";var Nz=F.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:i,state:a,method:o=Wm,action:c,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:p,...m},b)=>{let _=zz(),w=Lz(c,{relative:d}),S=o.toLowerCase()==="get"?"get":"post",T=typeof c=="string"&&rN.test(c),C=R=>{if(u&&u(R),R.defaultPrevented)return;R.preventDefault();let j=R.nativeEvent.submitter,z=j?.getAttribute("formmethod")||o;_(j||R.currentTarget,{fetcherKey:e,method:z,navigate:t,replace:i,state:a,relative:d,preventScrollReset:h,viewTransition:p})};return F.createElement("form",{ref:b,method:S,action:w,onSubmit:r?u:C,...m,"data-discover":!T&&n==="render"?"true":void 0})});Nz.displayName="Form";function Mz(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function aN(n){let e=F.useContext(Md);return mn(e,Mz(n)),e}function Pz(n,{target:e,replace:t,state:r,preventScrollReset:i,relative:a,viewTransition:o}={}){let c=as(),u=xa(),d=vp(n,{relative:a});return F.useCallback(h=>{if(dz(h,e)){h.preventDefault();let p=t!==void 0?t:Vh(u)===Vh(d);c(n,{replace:p,state:r,preventScrollReset:i,relative:a,viewTransition:o})}},[u,c,d,t,r,e,n,i,a,o])}function Oz(n){_i(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=F.useRef(hx(n)),t=F.useRef(!1),r=xa(),i=F.useMemo(()=>fz(r.search,t.current?null:e.current),[r.search]),a=as(),o=F.useCallback((c,u)=>{const d=hx(typeof c=="function"?c(new URLSearchParams(i)):c);t.current=!0,a("?"+d,u)},[a,i]);return[i,o]}var Vz=0,jz=()=>`__${String(++Vz)}__`;function zz(){let{router:n}=aN("useSubmit"),{basename:e}=F.useContext(rs),t=tz();return F.useCallback(async(r,i={})=>{let{action:a,method:o,encType:c,formData:u,body:d}=gz(r,e);if(i.navigate===!1){let h=i.fetcherKey||jz();await n.fetch(h,t,i.action||a,{preventScrollReset:i.preventScrollReset,formData:u,body:d,formMethod:i.method||o,formEncType:i.encType||c,flushSync:i.flushSync})}else await n.navigate(i.action||a,{preventScrollReset:i.preventScrollReset,formData:u,body:d,formMethod:i.method||o,formEncType:i.encType||c,replace:i.replace,state:i.state,fromRouteId:t,flushSync:i.flushSync,viewTransition:i.viewTransition})},[n,e,t])}function Lz(n,{relative:e}={}){let{basename:t}=F.useContext(rs),r=F.useContext(is);mn(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),a={...vp(n||".",{relative:e})},o=xa();if(n==null){a.search=o.search;let c=new URLSearchParams(a.search),u=c.getAll("index");if(u.some(h=>h==="")){c.delete("index"),u.filter(p=>p).forEach(p=>c.append("index",p));let h=c.toString();a.search=h?`?${h}`:""}}return(!n||n===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:Ns([t,a.pathname])),Vh(a)}function Bz(n,{relative:e}={}){let t=F.useContext(Xk);mn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=aN("useViewTransitionState"),i=vp(n,{relative:e});if(!t.isTransitioning)return!1;let a=js(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=js(t.nextLocation.pathname,r)||t.nextLocation.pathname;return E0(i.pathname,o)!=null||E0(i.pathname,a)!=null}const Uz=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Fz=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),b2=n=>{const e=Fz(n);return e.charAt(0).toUpperCase()+e.slice(1)},sN=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),Gz=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var qz={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Hz=F.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:a,iconNode:o,...c},u)=>F.createElement("svg",{ref:u,...qz,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:sN("lucide",i),...!a&&!Gz(c)&&{"aria-hidden":"true"},...c},[...o.map(([d,h])=>F.createElement(d,h)),...Array.isArray(a)?a:[a]]));const at=(n,e)=>{const t=F.forwardRef(({className:r,...i},a)=>F.createElement(Hz,{ref:a,iconNode:e,className:sN(`lucide-${Uz(b2(n))}`,`lucide-${n}`,r),...i}));return t.displayName=b2(n),t};const $z=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],jh=at("arrow-left",$z);const Yz=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],Kz=at("arrow-right-left",Yz);const Xz=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Wz=at("calendar",Xz);const Qz=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Zz=at("chart-column",Qz);const Jz=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],eL=at("chart-pie",Jz);const tL=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],nL=at("check",tL);const rL=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],rw=at("chevron-down",rL);const iL=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],aL=at("chevron-left",iL);const sL=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],$l=at("chevron-right",sL);const oL=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],oN=at("chevron-up",oL);const lL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]],cL=at("circle-arrow-down",lL);const uL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],dL=at("circle-arrow-up",uL);const fL=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],px=at("circle-check-big",fL);const hL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],x2=at("circle-check",hL);const pL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],_2=at("circle",pL);const gL=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],w2=at("download",gL);const mL=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],vL=at("ellipsis",mL);const yL=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],bL=at("eye-off",yL);const xL=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],_L=at("eye",xL);const wL=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],EL=at("file-text",wL);const SL=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],TL=at("folder-plus",SL);const AL=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],CL=at("funnel",AL);const IL=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],RL=at("house",IL);const DL=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],kL=at("list",DL);const NL=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ML=at("loader-circle",NL);const PL=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],E2=at("loader",PL);const OL=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],VL=at("lock-open",OL);const jL=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],zL=at("lock",jL);const LL=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],BL=at("log-out",LL);const UL=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],gx=at("mail",UL);const FL=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],GL=at("pause",FL);const qL=[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]],zh=at("piggy-bank",qL);const HL=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Zm=at("plus",HL);const $L=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],sd=at("refresh-cw",$L);const YL=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],KL=at("search",YL);const XL=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],lN=at("settings",XL);const WL=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],cN=at("sparkles",WL);const QL=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],mx=at("trash-2",QL);const ZL=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],uN=at("trash",ZL);const JL=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],dN=at("trending-up",JL);const e9=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ju=at("triangle-alert",e9);const t9=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],n9=at("undo-2",t9);const r9=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],i9=at("upload",r9);const a9=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],s9=at("user-plus",a9);const o9=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],iw=at("wallet",o9);const l9=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],c9=at("wifi-off",l9);const u9=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],d9=at("wifi",u9);const f9=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],aw=at("x",f9),S2=n=>{let e;const t=new Set,r=(d,h)=>{const p=typeof d=="function"?d(e):d;if(!Object.is(p,e)){const m=e;e=h??(typeof p!="object"||p===null)?p:Object.assign({},e,p),t.forEach(b=>b(e,m))}},i=()=>e,c={setState:r,getState:i,getInitialState:()=>u,subscribe:d=>(t.add(d),()=>t.delete(d))},u=e=n(r,i,c);return c},h9=(n=>n?S2(n):S2),p9=n=>n;function g9(n,e=p9){const t=_m.useSyncExternalStore(n.subscribe,_m.useCallback(()=>e(n.getState()),[n,e]),_m.useCallback(()=>e(n.getInitialState()),[n,e]));return _m.useDebugValue(t),t}const T2=n=>{const e=h9(n),t=r=>g9(e,r);return Object.assign(t,e),t},sw=(n=>n?T2(n):T2),A2={BASE_URL:"/personal-budget-pwa/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyDwUA0paVI6n01aENV5Q2aLwVz1DEDtNuA",VITE_FIREBASE_APP_ID:"1:137454342284:web:ab8b52955e6f0ffd42aba9",VITE_FIREBASE_AUTH_DOMAIN:"personal-budget-pwa-5defb.firebaseapp.com",VITE_FIREBASE_MEASUREMENT_ID:"G-BCLXBQHT9L",VITE_FIREBASE_MESSAGING_SENDER_ID:"137454342284",VITE_FIREBASE_PROJECT_ID:"personal-budget-pwa-5defb",VITE_FIREBASE_STORAGE_BUCKET:"personal-budget-pwa-5defb.firebasestorage.app"},Lh=new Map,Em=n=>{const e=Lh.get(n);return e?Object.fromEntries(Object.entries(e.stores).map(([t,r])=>[t,r.getState()])):{}},m9=(n,e,t)=>{if(n===void 0)return{type:"untracked",connection:e.connect(t)};const r=Lh.get(t.name);if(r)return{type:"tracked",store:n,...r};const i={connection:e.connect(t),stores:{}};return Lh.set(t.name,i),{type:"tracked",store:n,...i}},v9=(n,e)=>{if(e===void 0)return;const t=Lh.get(n);t&&(delete t.stores[e],Object.keys(t.stores).length===0&&Lh.delete(n))},y9=n=>{var e,t;if(!n)return;const r=n.split(`
`),i=r.findIndex(o=>o.includes("api.setState"));if(i<0)return;const a=((e=r[i+1])==null?void 0:e.trim())||"";return(t=/.+ (.+) .+/.exec(a))==null?void 0:t[1]},b9=(n,e={})=>(t,r,i)=>{const{enabled:a,anonymousActionType:o,store:c,...u}=e;let d;try{d=(a??(A2?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!d)return n(t,r,i);const{connection:h,...p}=m9(c,d,u);let m=!0;i.setState=((w,S,T)=>{const C=t(w,S);if(!m)return C;const R=T===void 0?{type:o||y9(new Error().stack)||"anonymous"}:typeof T=="string"?{type:T}:T;return c===void 0?(h?.send(R,r()),C):(h?.send({...R,type:`${c}/${R.type}`},{...Em(u.name),[c]:i.getState()}),C)}),i.devtools={cleanup:()=>{h&&typeof h.unsubscribe=="function"&&h.unsubscribe(),v9(u.name,c)}};const b=(...w)=>{const S=m;m=!1,t(...w),m=S},_=n(i.setState,r,i);if(p.type==="untracked"?h?.init(_):(p.stores[p.store]=i,h?.init(Object.fromEntries(Object.entries(p.stores).map(([w,S])=>[w,w===p.store?_:S.getState()])))),i.dispatchFromDevtools&&typeof i.dispatch=="function"){let w=!1;const S=i.dispatch;i.dispatch=(...T)=>{(A2?"production":void 0)!=="production"&&T[0].type==="__setState"&&!w&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),w=!0),S(...T)}}return h.subscribe(w=>{var S;switch(w.type){case"ACTION":if(typeof w.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return g1(w.payload,T=>{if(T.type==="__setState"){if(c===void 0){b(T.state);return}Object.keys(T.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const C=T.state[c];if(C==null)return;JSON.stringify(i.getState())!==JSON.stringify(C)&&b(C);return}i.dispatchFromDevtools&&typeof i.dispatch=="function"&&i.dispatch(T)});case"DISPATCH":switch(w.payload.type){case"RESET":return b(_),c===void 0?h?.init(i.getState()):h?.init(Em(u.name));case"COMMIT":if(c===void 0){h?.init(i.getState());return}return h?.init(Em(u.name));case"ROLLBACK":return g1(w.state,T=>{if(c===void 0){b(T),h?.init(i.getState());return}b(T[c]),h?.init(Em(u.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return g1(w.state,T=>{if(c===void 0){b(T);return}JSON.stringify(i.getState())!==JSON.stringify(T[c])&&b(T[c])});case"IMPORT_STATE":{const{nextLiftedState:T}=w.payload,C=(S=T.computedStates.slice(-1)[0])==null?void 0:S.state;if(!C)return;b(c===void 0?C:C[c]),h?.send(null,T);return}case"PAUSE_RECORDING":return m=!m}return}}),_},x9=b9,g1=(n,e)=>{let t;try{t=JSON.parse(n)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}t!==void 0&&e(t)};function _9(n,e){let t;try{t=n()}catch{return}return{getItem:i=>{var a;const o=u=>u===null?null:JSON.parse(u,void 0),c=(a=t.getItem(i))!=null?a:null;return c instanceof Promise?c.then(o):o(c)},setItem:(i,a)=>t.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>t.removeItem(i)}}const vx=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return vx(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return vx(r)(t)}}}},w9=(n,e)=>(t,r,i)=>{let a={storage:_9(()=>localStorage),partialize:w=>w,version:0,merge:(w,S)=>({...S,...w}),...e},o=!1;const c=new Set,u=new Set;let d=a.storage;if(!d)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(...w)},r,i);const h=()=>{const w=a.partialize({...r()});return d.setItem(a.name,{state:w,version:a.version})},p=i.setState;i.setState=(w,S)=>(p(w,S),h());const m=n((...w)=>(t(...w),h()),r,i);i.getInitialState=()=>m;let b;const _=()=>{var w,S;if(!d)return;o=!1,c.forEach(C=>{var R;return C((R=r())!=null?R:m)});const T=((S=a.onRehydrateStorage)==null?void 0:S.call(a,(w=r())!=null?w:m))||void 0;return vx(d.getItem.bind(d))(a.name).then(C=>{if(C)if(typeof C.version=="number"&&C.version!==a.version){if(a.migrate){const R=a.migrate(C.state,C.version);return R instanceof Promise?R.then(j=>[!0,j]):[!0,R]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,C.state];return[!1,void 0]}).then(C=>{var R;const[j,z]=C;if(b=a.merge(z,(R=r())!=null?R:m),t(b,!0),j)return h()}).then(()=>{T?.(b,void 0),b=r(),o=!0,u.forEach(C=>C(b))}).catch(C=>{T?.(void 0,C)})};return i.persist={setOptions:w=>{a={...a,...w},w.storage&&(d=w.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:w=>(c.add(w),()=>{c.delete(w)}),onFinishHydration:w=>(u.add(w),()=>{u.delete(w)})},a.skipHydration||_(),b||m},fN=w9,E9=()=>{};var C2={};const hN=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},S9=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=n[t++];e[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=n[t++],o=n[t++],c=n[t++],u=((i&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const a=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return e.join("")},pN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const a=n[i],o=i+1<n.length,c=o?n[i+1]:0,u=i+2<n.length,d=u?n[i+2]:0,h=a>>2,p=(a&3)<<4|c>>4;let m=(c&15)<<2|d>>6,b=d&63;u||(b=64,o||(m=64)),r.push(t[h],t[p],t[m],t[b])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(hN(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):S9(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const a=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;const d=i<n.length?t[n.charAt(i)]:64;++i;const p=i<n.length?t[n.charAt(i)]:64;if(++i,a==null||c==null||d==null||p==null)throw new T9;const m=a<<2|c>>4;if(r.push(m),d!==64){const b=c<<4&240|d>>2;if(r.push(b),p!==64){const _=d<<6&192|p;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class T9 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const A9=function(n){const e=hN(n);return pN.encodeByteArray(e,!0)},S0=function(n){return A9(n).replace(/\./g,"")},gN=function(n){try{return pN.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function mN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const C9=()=>mN().__FIREBASE_DEFAULTS__,I9=()=>{if(typeof process>"u"||typeof C2>"u")return;const n=C2.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},R9=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&gN(n[1]);return e&&JSON.parse(e)},bv=()=>{try{return E9()||C9()||I9()||R9()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},vN=n=>bv()?.emulatorHosts?.[n],D9=n=>{const e=vN(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},yN=()=>bv()?.config,bN=n=>bv()?.[`_${n}`];class k9{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Pd(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function xN(n){return(await fetch(n,{credentials:"include"})).ok}function N9(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...n};return[S0(JSON.stringify(t)),S0(JSON.stringify(o)),""].join(".")}const gh={};function M9(){const n={prod:[],emulator:[]};for(const e of Object.keys(gh))gh[e]?n.emulator.push(e):n.prod.push(e);return n}function P9(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let I2=!1;function _N(n,e){if(typeof window>"u"||typeof document>"u"||!Pd(window.location.host)||gh[n]===e||gh[n]||I2)return;gh[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",a=M9().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function c(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,b){m.setAttribute("width","24"),m.setAttribute("id",b),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{I2=!0,o()},m}function h(m,b){m.setAttribute("id",b),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=P9(r),b=t("text"),_=document.getElementById(b)||document.createElement("span"),w=t("learnmore"),S=document.getElementById(w)||document.createElement("a"),T=t("preprendIcon"),C=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const R=m.element;c(R),h(S,w);const j=d();u(C,T),R.append(C,_,S,j),document.body.appendChild(R)}a?(_.innerText="Preview backend disconnected.",C.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(C.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function or(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function O9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(or())}function wN(){const n=bv()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function V9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function j9(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function z9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function L9(){const n=or();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function EN(){return!wN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function SN(){return!wN()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function TN(){try{return typeof indexedDB=="object"}catch{return!1}}function B9(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const U9="FirebaseError";class Ys extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=U9,Object.setPrototypeOf(this,Ys.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,yp.prototype.create)}}class yp{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,a=this.errors[e],o=a?F9(a,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new Ys(i,c,r)}}function F9(n,e){return n.replace(G9,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const G9=/\{\$([^}]+)}/g;function q9(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function rl(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const a=n[i],o=e[i];if(R2(a)&&R2(o)){if(!rl(a,o))return!1}else if(a!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function R2(n){return n!==null&&typeof n=="object"}function bp(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ih(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,a]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function ah(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function H9(n,e){const t=new $9(n,e);return t.subscribe.bind(t)}class $9{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Y9(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=m1),i.error===void 0&&(i.error=m1),i.complete===void 0&&(i.complete=m1);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Y9(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function m1(){}function an(n){return n&&n._delegate?n._delegate:n}let yc=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};const Yl="[DEFAULT]";let K9=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new k9;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(W9(e))try{this.getOrInitializeService({instanceIdentifier:Yl})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:i});r.resolve(a)}catch{}}}}clearInstance(e=Yl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Yl){return this.instances.has(e)}getOptions(e=Yl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);r===c&&o.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const a=this.instances.get(r);return a&&e(a,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:X9(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Yl){return this.component?this.component.multipleInstances?e:Yl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function X9(n){return n===Yl?void 0:n}function W9(n){return n.instantiationMode==="EAGER"}class Q9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new K9(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Ct;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ct||(Ct={}));const Z9={debug:Ct.DEBUG,verbose:Ct.VERBOSE,info:Ct.INFO,warn:Ct.WARN,error:Ct.ERROR,silent:Ct.SILENT},J9=Ct.INFO,eB={[Ct.DEBUG]:"log",[Ct.VERBOSE]:"log",[Ct.INFO]:"info",[Ct.WARN]:"warn",[Ct.ERROR]:"error"},tB=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=eB[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ow{constructor(e){this.name=e,this._logLevel=J9,this._logHandler=tB,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ct))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Z9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ct.DEBUG,...e),this._logHandler(this,Ct.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ct.VERBOSE,...e),this._logHandler(this,Ct.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ct.INFO,...e),this._logHandler(this,Ct.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ct.WARN,...e),this._logHandler(this,Ct.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ct.ERROR,...e),this._logHandler(this,Ct.ERROR,...e)}}const nB=(n,e)=>e.some(t=>n instanceof t);let D2,k2;function rB(){return D2||(D2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function iB(){return k2||(k2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const AN=new WeakMap,yx=new WeakMap,CN=new WeakMap,v1=new WeakMap,lw=new WeakMap;function aB(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",a),n.removeEventListener("error",o)},a=()=>{t(Wo(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",a),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&AN.set(t,n)}).catch(()=>{}),lw.set(e,n),e}function sB(n){if(yx.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",o),n.removeEventListener("abort",o)},a=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",a),n.addEventListener("error",o),n.addEventListener("abort",o)});yx.set(n,e)}let bx={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return yx.get(n);if(e==="objectStoreNames")return n.objectStoreNames||CN.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Wo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function oB(n){bx=n(bx)}function lB(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(y1(this),e,...t);return CN.set(r,e.sort?e.sort():[e]),Wo(r)}:iB().includes(n)?function(...e){return n.apply(y1(this),e),Wo(AN.get(this))}:function(...e){return Wo(n.apply(y1(this),e))}}function cB(n){return typeof n=="function"?lB(n):(n instanceof IDBTransaction&&sB(n),nB(n,rB())?new Proxy(n,bx):n)}function Wo(n){if(n instanceof IDBRequest)return aB(n);if(v1.has(n))return v1.get(n);const e=cB(n);return e!==n&&(v1.set(n,e),lw.set(e,n)),e}const y1=n=>lw.get(n);function uB(n,e,{blocked:t,upgrade:r,blocking:i,terminated:a}={}){const o=indexedDB.open(n,e),c=Wo(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Wo(o.result),u.oldVersion,u.newVersion,Wo(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{a&&u.addEventListener("close",()=>a()),i&&u.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const dB=["get","getKey","getAll","getAllKeys","count"],fB=["put","add","delete","clear"],b1=new Map;function N2(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(b1.get(e))return b1.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=fB.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||dB.includes(t)))return;const a=async function(o,...c){const u=this.transaction(o,i?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[t](...c),i&&u.done]))[0]};return b1.set(e,a),a}oB(n=>({...n,get:(e,t,r)=>N2(e,t)||n.get(e,t,r),has:(e,t)=>!!N2(e,t)||n.has(e,t)}));class hB{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(pB(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function pB(n){return n.getComponent()?.type==="VERSION"}const xx="@firebase/app",M2="0.14.6";const zs=new ow("@firebase/app"),gB="@firebase/app-compat",mB="@firebase/analytics-compat",vB="@firebase/analytics",yB="@firebase/app-check-compat",bB="@firebase/app-check",xB="@firebase/auth",_B="@firebase/auth-compat",wB="@firebase/database",EB="@firebase/data-connect",SB="@firebase/database-compat",TB="@firebase/functions",AB="@firebase/functions-compat",CB="@firebase/installations",IB="@firebase/installations-compat",RB="@firebase/messaging",DB="@firebase/messaging-compat",kB="@firebase/performance",NB="@firebase/performance-compat",MB="@firebase/remote-config",PB="@firebase/remote-config-compat",OB="@firebase/storage",VB="@firebase/storage-compat",jB="@firebase/firestore",zB="@firebase/ai",LB="@firebase/firestore-compat",BB="firebase",UB="12.6.0";const _x="[DEFAULT]",FB={[xx]:"fire-core",[gB]:"fire-core-compat",[vB]:"fire-analytics",[mB]:"fire-analytics-compat",[bB]:"fire-app-check",[yB]:"fire-app-check-compat",[xB]:"fire-auth",[_B]:"fire-auth-compat",[wB]:"fire-rtdb",[EB]:"fire-data-connect",[SB]:"fire-rtdb-compat",[TB]:"fire-fn",[AB]:"fire-fn-compat",[CB]:"fire-iid",[IB]:"fire-iid-compat",[RB]:"fire-fcm",[DB]:"fire-fcm-compat",[kB]:"fire-perf",[NB]:"fire-perf-compat",[MB]:"fire-rc",[PB]:"fire-rc-compat",[OB]:"fire-gcs",[VB]:"fire-gcs-compat",[jB]:"fire-fst",[LB]:"fire-fst-compat",[zB]:"fire-vertex","fire-js":"fire-js",[BB]:"fire-js-all"};const T0=new Map,GB=new Map,wx=new Map;function P2(n,e){try{n.container.addComponent(e)}catch(t){zs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function od(n){const e=n.name;if(wx.has(e))return zs.debug(`There were multiple attempts to register component ${e}.`),!1;wx.set(e,n);for(const t of T0.values())P2(t,n);for(const t of GB.values())P2(t,n);return!0}function cw(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Fi(n){return n==null?!1:n.settings!==void 0}const qB={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qo=new yp("app","Firebase",qB);class HB{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new yc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qo.create("app-deleted",{appName:this._name})}}const Od=UB;function IN(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:_x,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Qo.create("bad-app-name",{appName:String(i)});if(t||(t=yN()),!t)throw Qo.create("no-options");const a=T0.get(i);if(a){if(rl(t,a.options)&&rl(r,a.config))return a;throw Qo.create("duplicate-app",{appName:i})}const o=new Q9(i);for(const u of wx.values())o.addComponent(u);const c=new HB(t,r,o);return T0.set(i,c),c}function RN(n=_x){const e=T0.get(n);if(!e&&n===_x&&yN())return IN();if(!e)throw Qo.create("no-app",{appName:n});return e}function Zo(n,e,t){let r=FB[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),zs.warn(o.join(" "));return}od(new yc(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const $B="firebase-heartbeat-database",YB=1,Bh="firebase-heartbeat-store";let x1=null;function DN(){return x1||(x1=uB($B,YB,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Bh)}catch(t){console.warn(t)}}}}).catch(n=>{throw Qo.create("idb-open",{originalErrorMessage:n.message})})),x1}async function KB(n){try{const t=(await DN()).transaction(Bh),r=await t.objectStore(Bh).get(kN(n));return await t.done,r}catch(e){if(e instanceof Ys)zs.warn(e.message);else{const t=Qo.create("idb-get",{originalErrorMessage:e?.message});zs.warn(t.message)}}}async function O2(n,e){try{const r=(await DN()).transaction(Bh,"readwrite");await r.objectStore(Bh).put(e,kN(n)),await r.done}catch(t){if(t instanceof Ys)zs.warn(t.message);else{const r=Qo.create("idb-set",{originalErrorMessage:t?.message});zs.warn(r.message)}}}function kN(n){return`${n.name}!${n.options.appId}`}const XB=1024,WB=30;class QB{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new JB(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=V2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>WB){const i=e8(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){zs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=V2(),{heartbeatsToSend:t,unsentEntries:r}=ZB(this._heartbeatsCache.heartbeats),i=S0(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return zs.warn(e),""}}}function V2(){return new Date().toISOString().substring(0,10)}function ZB(n,e=XB){const t=[];let r=n.slice();for(const i of n){const a=t.find(o=>o.agent===i.agent);if(a){if(a.dates.push(i.date),j2(t)>e){a.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),j2(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class JB{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return TN()?B9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await KB(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return O2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return O2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function j2(n){return S0(JSON.stringify({version:2,heartbeats:n})).length}function e8(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function t8(n){od(new yc("platform-logger",e=>new hB(e),"PRIVATE")),od(new yc("heartbeat",e=>new QB(e),"PRIVATE")),Zo(xx,M2,n),Zo(xx,M2,"esm2020"),Zo("fire-js","")}t8("");function NN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const n8=NN,MN=new yp("auth","Firebase",NN());const A0=new ow("@firebase/auth");function r8(n,...e){A0.logLevel<=Ct.WARN&&A0.warn(`Auth (${Od}): ${n}`,...e)}function Jm(n,...e){A0.logLevel<=Ct.ERROR&&A0.error(`Auth (${Od}): ${n}`,...e)}function ma(n,...e){throw uw(n,...e)}function $a(n,...e){return uw(n,...e)}function PN(n,e,t){const r={...n8(),[e]:t};return new yp("auth","Firebase",r).create(e,{appName:n.name})}function Ms(n){return PN(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function uw(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return MN.create(n,...e)}function rt(n,e,...t){if(!n)throw uw(e,...t)}function Is(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Jm(e),new Error(e)}function Ls(n,e){n||Is(e)}function Ex(){return typeof self<"u"&&self.location?.href||""}function i8(){return z2()==="http:"||z2()==="https:"}function z2(){return typeof self<"u"&&self.location?.protocol||null}function a8(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(i8()||j9()||"connection"in navigator)?navigator.onLine:!0}function s8(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class xp{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ls(t>e,"Short delay should be less than long delay!"),this.isMobile=O9()||z9()}get(){return a8()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function dw(n,e){Ls(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class ON{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Is("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Is("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Is("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const o8={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const l8=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],c8=new xp(3e4,6e4);function Ks(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function ss(n,e,t,r,i={}){return VN(n,i,async()=>{let a={},o={};r&&(e==="GET"?o=r:a={body:JSON.stringify(r)});const c=bp({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const d={method:e,headers:u,...a};return V9()||(d.referrerPolicy="no-referrer"),n.emulatorConfig&&Pd(n.emulatorConfig.host)&&(d.credentials="include"),ON.fetch()(await jN(n,n.config.apiHost,t,c),d)})}async function VN(n,e,t){n._canInitEmulator=!1;const r={...o8,...e};try{const i=new d8(n),a=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw Sm(n,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const c=a.ok?o.errorMessage:o.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Sm(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Sm(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Sm(n,"user-disabled",o);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw PN(n,h,d);ma(n,h)}}catch(i){if(i instanceof Ys)throw i;ma(n,"network-request-failed",{message:String(i)})}}async function _p(n,e,t,r,i={}){const a=await ss(n,e,t,r,i);return"mfaPendingCredential"in a&&ma(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function jN(n,e,t,r){const i=`${e}${t}?${r}`,a=n,o=a.config.emulator?dw(n.config,i):`${n.config.apiScheme}://${i}`;return l8.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(o).toString():o}function u8(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class d8{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r($a(this.auth,"network-request-failed")),c8.get())})}}function Sm(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=$a(n,e,r);return i.customData._tokenResponse=t,i}function L2(n){return n!==void 0&&n.enterprise!==void 0}class f8{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return u8(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function h8(n,e){return ss(n,"GET","/v2/recaptchaConfig",Ks(n,e))}async function p8(n,e){return ss(n,"POST","/v1/accounts:delete",e)}async function C0(n,e){return ss(n,"POST","/v1/accounts:lookup",e)}function mh(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function g8(n,e=!1){const t=an(n),r=await t.getIdToken(e),i=fw(r);rt(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,o=a?.sign_in_provider;return{claims:i,token:r,authTime:mh(_1(i.auth_time)),issuedAtTime:mh(_1(i.iat)),expirationTime:mh(_1(i.exp)),signInProvider:o||null,signInSecondFactor:a?.sign_in_second_factor||null}}function _1(n){return Number(n)*1e3}function fw(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Jm("JWT malformed, contained fewer than 3 sections"),null;try{const i=gN(t);return i?JSON.parse(i):(Jm("Failed to decode base64 JWT payload"),null)}catch(i){return Jm("Caught error parsing JWT payload as JSON",i?.toString()),null}}function B2(n){const e=fw(n);return rt(e,"internal-error"),rt(typeof e.exp<"u","internal-error"),rt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ld(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Ys&&m8(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function m8({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class v8{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Sx{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=mh(this.lastLoginAt),this.creationTime=mh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function I0(n){const e=n.auth,t=await n.getIdToken(),r=await ld(n,C0(e,{idToken:t}));rt(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const a=i.providerUserInfo?.length?zN(i.providerUserInfo):[],o=b8(n.providerData,a),c=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!o?.length,d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Sx(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,h)}async function y8(n){const e=an(n);await I0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function b8(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function zN(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function x8(n,e){const t=await VN(n,{},async()=>{const r=bp({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=n.config,o=await jN(n,i,"/v1/token",`key=${a}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:r};return n.emulatorConfig&&Pd(n.emulatorConfig.host)&&(u.credentials="include"),ON.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function _8(n,e){return ss(n,"POST","/v2/accounts:revokeToken",Ks(n,e))}class ed{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){rt(e.idToken,"internal-error"),rt(typeof e.idToken<"u","internal-error"),rt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):B2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){rt(e.length!==0,"internal-error");const t=B2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(rt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:a}=await x8(e,t);this.updateTokensAndExpiration(r,i,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:a}=t,o=new ed;return r&&(rt(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(rt(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),a&&(rt(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ed,this.toJSON())}_performRefresh(){return Is("not implemented")}}function No(n,e){rt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class fa{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new v8(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Sx(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await ld(this,this.stsTokenManager.getToken(this.auth,e));return rt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return g8(this,e)}reload(){return y8(this)}_assign(e){this!==e&&(rt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new fa({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){rt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await I0(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Fi(this.auth.app))return Promise.reject(Ms(this.auth));const e=await this.getIdToken();return await ld(this,p8(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,a=t.phoneNumber??void 0,o=t.photoURL??void 0,c=t.tenantId??void 0,u=t._redirectEventId??void 0,d=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:b,providerData:_,stsTokenManager:w}=t;rt(p&&w,e,"internal-error");const S=ed.fromJSON(this.name,w);rt(typeof p=="string",e,"internal-error"),No(r,e.name),No(i,e.name),rt(typeof m=="boolean",e,"internal-error"),rt(typeof b=="boolean",e,"internal-error"),No(a,e.name),No(o,e.name),No(c,e.name),No(u,e.name),No(d,e.name),No(h,e.name);const T=new fa({uid:p,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:b,photoURL:o,phoneNumber:a,tenantId:c,stsTokenManager:S,createdAt:d,lastLoginAt:h});return _&&Array.isArray(_)&&(T.providerData=_.map(C=>({...C}))),u&&(T._redirectEventId=u),T}static async _fromIdTokenResponse(e,t,r=!1){const i=new ed;i.updateFromServerResponse(t);const a=new fa({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await I0(a),a}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];rt(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?zN(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!a?.length,c=new ed;c.updateFromIdToken(r);const u=new fa({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Sx(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(u,d),u}}const U2=new Map;function Rs(n){Ls(n instanceof Function,"Expected a class definition");let e=U2.get(n);return e?(Ls(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,U2.set(n,e),e)}class LN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}LN.type="NONE";const F2=LN;function e0(n,e,t){return`firebase:${n}:${e}:${t}`}class td{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:a}=this.auth;this.fullUserKey=e0(this.userKey,i.apiKey,a),this.fullPersistenceKey=e0("persistence",i.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await C0(this.auth,{idToken:e}).catch(()=>{});return t?fa._fromGetAccountInfoResponse(this.auth,t,e):null}return fa._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new td(Rs(F2),e,r);const i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let a=i[0]||Rs(F2);const o=e0(r,e.config.apiKey,e.name);let c=null;for(const d of t)try{const h=await d._get(o);if(h){let p;if(typeof h=="string"){const m=await C0(e,{idToken:h}).catch(()=>{});if(!m)break;p=await fa._fromGetAccountInfoResponse(e,m,h)}else p=fa._fromJSON(e,h);d!==a&&(c=p),a=d;break}}catch{}const u=i.filter(d=>d._shouldAllowMigration);return!a._shouldAllowMigration||!u.length?new td(a,e,r):(a=u[0],c&&await a._set(o,c.toJSON()),await Promise.all(t.map(async d=>{if(d!==a)try{await d._remove(o)}catch{}})),new td(a,e,r))}}function G2(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(GN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(BN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(HN(e))return"Blackberry";if($N(e))return"Webos";if(UN(e))return"Safari";if((e.includes("chrome/")||FN(e))&&!e.includes("edge/"))return"Chrome";if(qN(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function BN(n=or()){return/firefox\//i.test(n)}function UN(n=or()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function FN(n=or()){return/crios\//i.test(n)}function GN(n=or()){return/iemobile/i.test(n)}function qN(n=or()){return/android/i.test(n)}function HN(n=or()){return/blackberry/i.test(n)}function $N(n=or()){return/webos/i.test(n)}function hw(n=or()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function w8(n=or()){return hw(n)&&!!window.navigator?.standalone}function E8(){return L9()&&document.documentMode===10}function YN(n=or()){return hw(n)||qN(n)||$N(n)||HN(n)||/windows phone/i.test(n)||GN(n)}function KN(n,e=[]){let t;switch(n){case"Browser":t=G2(or());break;case"Worker":t=`${G2(or())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Od}/${r}`}class S8{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((o,c)=>{try{const u=e(a);o(u)}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function T8(n,e={}){return ss(n,"GET","/v2/passwordPolicy",Ks(n,e))}const A8=6;class C8{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??A8,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class I8{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new q2(this),this.idTokenSubscription=new q2(this),this.beforeStateQueue=new S8(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=MN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Rs(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await td.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await C0(this,{idToken:e}),r=await fa._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Fi(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,o=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===o)&&c?.user&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return rt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await I0(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=s8()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Fi(this.app))return Promise.reject(Ms(this));const t=e?an(e):null;return t&&rt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&rt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Fi(this.app)?Promise.reject(Ms(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Fi(this.app)?Promise.reject(Ms(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Rs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await T8(this),t=new C8(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new yp("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await _8(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Rs(e)||this._popupRedirectResolver;rt(t,this,"argument-error"),this.redirectPersistenceManager=await td.create(this,[Rs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(rt(c,this,"internal-error"),c.then(()=>{o||a(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,i);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return rt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=KN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Fi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&r8(`Error while retrieving App Check token: ${e.error}`),e?.token}}function pl(n){return an(n)}class q2{constructor(e){this.auth=e,this.observer=null,this.addObserver=H9(t=>this.observer=t)}get next(){return rt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let xv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function R8(n){xv=n}function XN(n){return xv.loadJS(n)}function D8(){return xv.recaptchaEnterpriseScript}function k8(){return xv.gapiScript}function N8(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class M8{constructor(){this.enterprise=new P8}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class P8{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const O8="recaptcha-enterprise",WN="NO_RECAPTCHA";class V8{constructor(e){this.type=O8,this.auth=pl(e)}async verify(e="verify",t=!1){async function r(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,c)=>{h8(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new f8(u);return a.tenantId==null?a._agentRecaptchaConfig=d:a._tenantRecaptchaConfigs[a.tenantId]=d,o(d.siteKey)}}).catch(u=>{c(u)})})}function i(a,o,c){const u=window.grecaptcha;L2(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:e}).then(d=>{o(d)}).catch(()=>{o(WN)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new M8().execute("siteKey",{action:"verify"}):new Promise((a,o)=>{r(this.auth).then(c=>{if(!t&&L2(window.grecaptcha))i(c,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=D8();u.length!==0&&(u+=c),XN(u).then(()=>{i(c,a,o)}).catch(d=>{o(d)})}}).catch(c=>{o(c)})})}}async function H2(n,e,t,r=!1,i=!1){const a=new V8(n);let o;if(i)o=WN;else try{o=await a.verify(t)}catch{o=await a.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function R0(n,e,t,r,i){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await H2(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await H2(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(a)})}function j8(n,e){const t=cw(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),a=t.getOptions();if(rl(a,e??{}))return i;ma(i,"already-initialized")}return t.initialize({options:e})}function z8(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Rs);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function L8(n,e,t){const r=pl(n);rt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,a=QN(e),{host:o,port:c}=B8(e),u=c===null?"":`:${c}`,d={url:`${a}//${o}${u}/`},h=Object.freeze({host:o,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){rt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),rt(rl(d,r.config.emulator)&&rl(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Pd(o)?(xN(`${a}//${o}${u}`),_N("Auth",!0)):U8()}function QN(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function B8(n){const e=QN(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const a=i[1];return{host:a,port:$2(r.substr(a.length+1))}}else{const[a,o]=r.split(":");return{host:a,port:$2(o)}}}function $2(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function U8(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class pw{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Is("not implemented")}_getIdTokenResponse(e){return Is("not implemented")}_linkToIdToken(e,t){return Is("not implemented")}_getReauthenticationResolver(e){return Is("not implemented")}}async function F8(n,e){return ss(n,"POST","/v1/accounts:signUp",e)}async function G8(n,e){return _p(n,"POST","/v1/accounts:signInWithPassword",Ks(n,e))}async function ZN(n,e){return ss(n,"POST","/v1/accounts:sendOobCode",Ks(n,e))}async function q8(n,e){return ZN(n,e)}async function H8(n,e){return ZN(n,e)}async function $8(n,e){return _p(n,"POST","/v1/accounts:signInWithEmailLink",Ks(n,e))}async function Y8(n,e){return _p(n,"POST","/v1/accounts:signInWithEmailLink",Ks(n,e))}class Uh extends pw{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Uh(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Uh(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return R0(e,t,"signInWithPassword",G8);case"emailLink":return $8(e,{email:this._email,oobCode:this._password});default:ma(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return R0(e,r,"signUpPassword",F8);case"emailLink":return Y8(e,{idToken:t,email:this._email,oobCode:this._password});default:ma(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function nd(n,e){return _p(n,"POST","/v1/accounts:signInWithIdp",Ks(n,e))}const K8="http://localhost";class bc extends pw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new bc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ma("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...a}=t;if(!r||!i)return null;const o=new bc(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return nd(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,nd(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,nd(e,t)}buildRequest(){const e={requestUri:K8,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=bp(t)}return e}}function X8(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function W8(n){const e=ih(ah(n)).link,t=e?ih(ah(e)).deep_link_id:null,r=ih(ah(n)).deep_link_id;return(r?ih(ah(r)).link:null)||r||t||e||n}class gw{constructor(e){const t=ih(ah(e)),r=t.apiKey??null,i=t.oobCode??null,a=X8(t.mode??null);rt(r&&i&&a,"argument-error"),this.apiKey=r,this.operation=a,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=W8(e);try{return new gw(t)}catch{return null}}}class Oc{constructor(){this.providerId=Oc.PROVIDER_ID}static credential(e,t){return Uh._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=gw.parseLink(t);return rt(r,"argument-error"),Uh._fromEmailAndCode(e,r.code,r.tenantId)}}Oc.PROVIDER_ID="password";Oc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Oc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class JN{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class wp extends JN{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Uo extends wp{constructor(){super("facebook.com")}static credential(e){return bc._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Uo.credential(e.oauthAccessToken)}catch{return null}}}Uo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Uo.PROVIDER_ID="facebook.com";class Fo extends wp{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return bc._fromParams({providerId:Fo.PROVIDER_ID,signInMethod:Fo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Fo.credentialFromTaggedObject(e)}static credentialFromError(e){return Fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Fo.credential(t,r)}catch{return null}}}Fo.GOOGLE_SIGN_IN_METHOD="google.com";Fo.PROVIDER_ID="google.com";class Go extends wp{constructor(){super("github.com")}static credential(e){return bc._fromParams({providerId:Go.PROVIDER_ID,signInMethod:Go.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Go.credentialFromTaggedObject(e)}static credentialFromError(e){return Go.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Go.credential(e.oauthAccessToken)}catch{return null}}}Go.GITHUB_SIGN_IN_METHOD="github.com";Go.PROVIDER_ID="github.com";class qo extends wp{constructor(){super("twitter.com")}static credential(e,t){return bc._fromParams({providerId:qo.PROVIDER_ID,signInMethod:qo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return qo.credentialFromTaggedObject(e)}static credentialFromError(e){return qo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return qo.credential(t,r)}catch{return null}}}qo.TWITTER_SIGN_IN_METHOD="twitter.com";qo.PROVIDER_ID="twitter.com";async function Q8(n,e){return _p(n,"POST","/v1/accounts:signUp",Ks(n,e))}class xc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const a=await fa._fromIdTokenResponse(e,r,i),o=Y2(r);return new xc({user:a,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=Y2(r);return new xc({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function Y2(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class D0 extends Ys{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,D0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new D0(e,t,r,i)}}function eM(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?D0._fromErrorAndOperation(n,a,e,r):a})}async function Z8(n,e,t=!1){const r=await ld(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return xc._forOperation(n,"link",r)}async function tM(n,e,t=!1){const{auth:r}=n;if(Fi(r.app))return Promise.reject(Ms(r));const i="reauthenticate";try{const a=await ld(n,eM(r,i,e,n),t);rt(a.idToken,r,"internal-error");const o=fw(a.idToken);rt(o,r,"internal-error");const{sub:c}=o;return rt(n.uid===c,r,"user-mismatch"),xc._forOperation(n,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&ma(r,"user-mismatch"),a}}async function nM(n,e,t=!1){if(Fi(n.app))return Promise.reject(Ms(n));const r="signIn",i=await eM(n,r,e),a=await xc._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(a.user),a}async function J8(n,e){return nM(pl(n),e)}async function eU(n,e){return tM(an(n),e)}async function rM(n){const e=pl(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function tU(n,e,t){const r=pl(n);await R0(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",H8)}async function nU(n,e,t){if(Fi(n.app))return Promise.reject(Ms(n));const r=pl(n),o=await R0(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Q8).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&rM(n),u}),c=await xc._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(c.user),c}function rU(n,e,t){return Fi(n.app)?Promise.reject(Ms(n)):J8(an(n),Oc.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&rM(n),r})}async function K2(n,e){const t=an(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()},{email:a}=await q8(t.auth,i);a!==n.email&&await n.reload()}async function iU(n,e){return ss(n,"POST","/v1/accounts:update",e)}async function aU(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=an(n),a={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await ld(r,iU(r.auth,a));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const c=r.providerData.find(({providerId:u})=>u==="password");c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function sU(n,e,t,r){return an(n).onIdTokenChanged(e,t,r)}function oU(n,e,t){return an(n).beforeAuthStateChanged(e,t)}function lU(n,e,t,r){return an(n).onAuthStateChanged(e,t,r)}function X2(n){return an(n).signOut()}async function cU(n){return an(n).delete()}const k0="__sak";class iM{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(k0,"1"),this.storage.removeItem(k0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const uU=1e3,dU=10;class aM extends iM{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=YN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},a=this.storage.getItem(r);E8()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,dU):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},uU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}aM.type="LOCAL";const fU=aM;class sM extends iM{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}sM.type="SESSION";const oM=sM;function hU(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class _v{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new _v(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:a}=t.data,o=this.handlersMap[i];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const c=Array.from(o).map(async d=>d(t.origin,a)),u=await hU(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}_v.receivers=[];function mw(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class pU{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,o;return new Promise((c,u)=>{const d=mw("",20);i.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const m=p;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),a=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(m.data.response);break;default:clearTimeout(h),clearTimeout(a),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Ya(){return window}function gU(n){Ya().location.href=n}function lM(){return typeof Ya().WorkerGlobalScope<"u"&&typeof Ya().importScripts=="function"}async function mU(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function vU(){return navigator?.serviceWorker?.controller||null}function yU(){return lM()?self:null}const cM="firebaseLocalStorageDb",bU=1,N0="firebaseLocalStorage",uM="fbase_key";class Ep{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function wv(n,e){return n.transaction([N0],e?"readwrite":"readonly").objectStore(N0)}function xU(){const n=indexedDB.deleteDatabase(cM);return new Ep(n).toPromise()}function Tx(){const n=indexedDB.open(cM,bU);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(N0,{keyPath:uM})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(N0)?e(r):(r.close(),await xU(),e(await Tx()))})})}async function W2(n,e,t){const r=wv(n,!0).put({[uM]:e,value:t});return new Ep(r).toPromise()}async function _U(n,e){const t=wv(n,!1).get(e),r=await new Ep(t).toPromise();return r===void 0?null:r.value}function Q2(n,e){const t=wv(n,!0).delete(e);return new Ep(t).toPromise()}const wU=800,EU=3;class dM{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Tx(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>EU)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return lM()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=_v._getInstance(yU()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await mU(),!this.activeServiceWorker)return;this.sender=new pU(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||vU()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Tx();return await W2(e,k0,"1"),await Q2(e,k0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>W2(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>_U(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Q2(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=wv(i,!1).getAll();return new Ep(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),wU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}dM.type="LOCAL";const SU=dM;new xp(3e4,6e4);function TU(n,e){return e?Rs(e):(rt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class vw extends pw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return nd(e,this._buildIdpRequest())}_linkToIdToken(e,t){return nd(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return nd(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function AU(n){return nM(n.auth,new vw(n),n.bypassAuthState)}function CU(n){const{auth:e,user:t}=n;return rt(t,e,"internal-error"),tM(t,new vw(n),n.bypassAuthState)}async function IU(n){const{auth:e,user:t}=n;return rt(t,e,"internal-error"),Z8(t,new vw(n),n.bypassAuthState)}class fM{constructor(e,t,r,i,a=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:a,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return AU;case"linkViaPopup":case"linkViaRedirect":return IU;case"reauthViaPopup":case"reauthViaRedirect":return CU;default:ma(this.auth,"internal-error")}}resolve(e){Ls(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ls(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const RU=new xp(2e3,1e4);class Bu extends fM{constructor(e,t,r,i,a){super(e,t,i,a),this.provider=r,this.authWindow=null,this.pollId=null,Bu.currentPopupAction&&Bu.currentPopupAction.cancel(),Bu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return rt(e,this.auth,"internal-error"),e}async onExecution(){Ls(this.filter.length===1,"Popup operations only handle one event");const e=mw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject($a(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject($a(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Bu.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject($a(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,RU.get())};e()}}Bu.currentPopupAction=null;const DU="pendingRedirect",t0=new Map;class kU extends fM{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=t0.get(this.auth._key());if(!e){try{const r=await NU(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}t0.set(this.auth._key(),e)}return this.bypassAuthState||t0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function NU(n,e){const t=OU(e),r=PU(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function MU(n,e){t0.set(n._key(),e)}function PU(n){return Rs(n._redirectPersistence)}function OU(n){return e0(DU,n.config.apiKey,n.name)}async function VU(n,e,t=!1){if(Fi(n.app))return Promise.reject(Ms(n));const r=pl(n),i=TU(r,e),o=await new kU(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}const jU=600*1e3;class zU{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!LU(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!hM(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError($a(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=jU&&this.cachedEventUids.clear(),this.cachedEventUids.has(Z2(e))}saveEventToCache(e){this.cachedEventUids.add(Z2(e)),this.lastProcessedEventTime=Date.now()}}function Z2(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function hM({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function LU(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return hM(n);default:return!1}}async function BU(n,e={}){return ss(n,"GET","/v1/projects",e)}const UU=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,FU=/^https?/;async function GU(n){if(n.config.emulator)return;const{authorizedDomains:e}=await BU(n);for(const t of e)try{if(qU(t))return}catch{}ma(n,"unauthorized-domain")}function qU(n){const e=Ex(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!FU.test(t))return!1;if(UU.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const HU=new xp(3e4,6e4);function J2(){const n=Ya().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function $U(n){return new Promise((e,t)=>{function r(){J2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{J2(),t($a(n,"network-request-failed"))},timeout:HU.get()})}if(Ya().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ya().gapi?.load)r();else{const i=N8("iframefcb");return Ya()[i]=()=>{gapi.load?r():t($a(n,"network-request-failed"))},XN(`${k8()}?onload=${i}`).catch(a=>t(a))}}).catch(e=>{throw n0=null,e})}let n0=null;function YU(n){return n0=n0||$U(n),n0}const KU=new xp(5e3,15e3),XU="__/auth/iframe",WU="emulator/auth/iframe",QU={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ZU=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function JU(n){const e=n.config;rt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?dw(e,WU):`https://${n.config.authDomain}/${XU}`,r={apiKey:e.apiKey,appName:n.name,v:Od},i=ZU.get(n.config.apiHost);i&&(r.eid=i);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${bp(r).slice(1)}`}async function eF(n){const e=await YU(n),t=Ya().gapi;return rt(t,n,"internal-error"),e.open({where:document.body,url:JU(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:QU,dontclear:!0},r=>new Promise(async(i,a)=>{await r.restyle({setHideOnLeave:!1});const o=$a(n,"network-request-failed"),c=Ya().setTimeout(()=>{a(o)},KU.get());function u(){Ya().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{a(o)})}))}const tF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},nF=500,rF=600,iF="_blank",aF="http://localhost";class eI{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function sF(n,e,t,r=nF,i=rF){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u={...tF,width:r.toString(),height:i.toString(),top:a,left:o},d=or().toLowerCase();t&&(c=FN(d)?iF:t),BN(d)&&(e=e||aF,u.scrollbars="yes");const h=Object.entries(u).reduce((m,[b,_])=>`${m}${b}=${_},`,"");if(w8(d)&&c!=="_self")return oF(e||"",c),new eI(null);const p=window.open(e||"",c,h);rt(p,n,"popup-blocked");try{p.focus()}catch{}return new eI(p)}function oF(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const lF="__/auth/handler",cF="emulator/auth/handler",uF=encodeURIComponent("fac");async function tI(n,e,t,r,i,a){rt(n.config.authDomain,n,"auth-domain-config-required"),rt(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Od,eventId:i};if(e instanceof JN){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",q9(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))o[h]=p}if(e instanceof wp){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);const c=o;for(const h of Object.keys(c))c[h]===void 0&&delete c[h];const u=await n._getAppCheckToken(),d=u?`#${uF}=${encodeURIComponent(u)}`:"";return`${dF(n)}?${bp(c).slice(1)}${d}`}function dF({config:n}){return n.emulator?dw(n,cF):`https://${n.authDomain}/${lF}`}const w1="webStorageSupport";class fF{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=oM,this._completeRedirectFn=VU,this._overrideRedirectResult=MU}async _openPopup(e,t,r,i){Ls(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await tI(e,t,r,Ex(),i);return sF(e,a,mw())}async _openRedirect(e,t,r,i){await this._originValidation(e);const a=await tI(e,t,r,Ex(),i);return gU(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:a}=this.eventManagers[t];return i?Promise.resolve(i):(Ls(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await eF(e),r=new zU(e);return t.register("authEvent",i=>(rt(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(w1,{type:w1},i=>{const a=i?.[0]?.[w1];a!==void 0&&t(!!a),ma(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=GU(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return YN()||UN()||hw()}}const hF=fF;var nI="@firebase/auth",rI="1.11.1";class pF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){rt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function gF(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function mF(n){od(new yc("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;rt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:KN(n)},d=new I8(r,i,a,u);return z8(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),od(new yc("auth-internal",e=>{const t=pl(e.getProvider("auth").getImmediate());return(r=>new pF(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Zo(nI,rI,gF(n)),Zo(nI,rI,"esm2020")}const vF=300,yF=bN("authIdTokenMaxAge")||vF;let iI=null;const bF=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>yF)return;const i=t?.token;iI!==i&&(iI=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function xF(n=RN()){const e=cw(n,"auth");if(e.isInitialized())return e.getImmediate();const t=j8(n,{popupRedirectResolver:hF,persistence:[SU,fU,oM]}),r=bN("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const o=bF(a.toString());oU(t,o,()=>o(t.currentUser)),sU(t,c=>o(c))}}const i=vN("auth");return i&&L8(t,`http://${i}`),t}function _F(){return document.getElementsByTagName("head")?.[0]??document}R8({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const a=$a("internal-error");a.customData=i,t(a)},r.type="text/javascript",r.charset="UTF-8",_F().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});mF("Browser");var wF="firebase",EF="12.6.0";Zo(wF,EF,"app");var aI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Jo,pM;(function(){var n;function e(I,A){function k(){}k.prototype=A.prototype,I.F=A.prototype,I.prototype=new k,I.prototype.constructor=I,I.D=function(O,L,B){for(var M=Array(arguments.length-2),Q=2;Q<arguments.length;Q++)M[Q-2]=arguments[Q];return A.prototype[L].apply(O,M)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,A,k){k||(k=0);const O=Array(16);if(typeof A=="string")for(var L=0;L<16;++L)O[L]=A.charCodeAt(k++)|A.charCodeAt(k++)<<8|A.charCodeAt(k++)<<16|A.charCodeAt(k++)<<24;else for(L=0;L<16;++L)O[L]=A[k++]|A[k++]<<8|A[k++]<<16|A[k++]<<24;A=I.g[0],k=I.g[1],L=I.g[2];let B=I.g[3],M;M=A+(B^k&(L^B))+O[0]+3614090360&4294967295,A=k+(M<<7&4294967295|M>>>25),M=B+(L^A&(k^L))+O[1]+3905402710&4294967295,B=A+(M<<12&4294967295|M>>>20),M=L+(k^B&(A^k))+O[2]+606105819&4294967295,L=B+(M<<17&4294967295|M>>>15),M=k+(A^L&(B^A))+O[3]+3250441966&4294967295,k=L+(M<<22&4294967295|M>>>10),M=A+(B^k&(L^B))+O[4]+4118548399&4294967295,A=k+(M<<7&4294967295|M>>>25),M=B+(L^A&(k^L))+O[5]+1200080426&4294967295,B=A+(M<<12&4294967295|M>>>20),M=L+(k^B&(A^k))+O[6]+2821735955&4294967295,L=B+(M<<17&4294967295|M>>>15),M=k+(A^L&(B^A))+O[7]+4249261313&4294967295,k=L+(M<<22&4294967295|M>>>10),M=A+(B^k&(L^B))+O[8]+1770035416&4294967295,A=k+(M<<7&4294967295|M>>>25),M=B+(L^A&(k^L))+O[9]+2336552879&4294967295,B=A+(M<<12&4294967295|M>>>20),M=L+(k^B&(A^k))+O[10]+4294925233&4294967295,L=B+(M<<17&4294967295|M>>>15),M=k+(A^L&(B^A))+O[11]+2304563134&4294967295,k=L+(M<<22&4294967295|M>>>10),M=A+(B^k&(L^B))+O[12]+1804603682&4294967295,A=k+(M<<7&4294967295|M>>>25),M=B+(L^A&(k^L))+O[13]+4254626195&4294967295,B=A+(M<<12&4294967295|M>>>20),M=L+(k^B&(A^k))+O[14]+2792965006&4294967295,L=B+(M<<17&4294967295|M>>>15),M=k+(A^L&(B^A))+O[15]+1236535329&4294967295,k=L+(M<<22&4294967295|M>>>10),M=A+(L^B&(k^L))+O[1]+4129170786&4294967295,A=k+(M<<5&4294967295|M>>>27),M=B+(k^L&(A^k))+O[6]+3225465664&4294967295,B=A+(M<<9&4294967295|M>>>23),M=L+(A^k&(B^A))+O[11]+643717713&4294967295,L=B+(M<<14&4294967295|M>>>18),M=k+(B^A&(L^B))+O[0]+3921069994&4294967295,k=L+(M<<20&4294967295|M>>>12),M=A+(L^B&(k^L))+O[5]+3593408605&4294967295,A=k+(M<<5&4294967295|M>>>27),M=B+(k^L&(A^k))+O[10]+38016083&4294967295,B=A+(M<<9&4294967295|M>>>23),M=L+(A^k&(B^A))+O[15]+3634488961&4294967295,L=B+(M<<14&4294967295|M>>>18),M=k+(B^A&(L^B))+O[4]+3889429448&4294967295,k=L+(M<<20&4294967295|M>>>12),M=A+(L^B&(k^L))+O[9]+568446438&4294967295,A=k+(M<<5&4294967295|M>>>27),M=B+(k^L&(A^k))+O[14]+3275163606&4294967295,B=A+(M<<9&4294967295|M>>>23),M=L+(A^k&(B^A))+O[3]+4107603335&4294967295,L=B+(M<<14&4294967295|M>>>18),M=k+(B^A&(L^B))+O[8]+1163531501&4294967295,k=L+(M<<20&4294967295|M>>>12),M=A+(L^B&(k^L))+O[13]+2850285829&4294967295,A=k+(M<<5&4294967295|M>>>27),M=B+(k^L&(A^k))+O[2]+4243563512&4294967295,B=A+(M<<9&4294967295|M>>>23),M=L+(A^k&(B^A))+O[7]+1735328473&4294967295,L=B+(M<<14&4294967295|M>>>18),M=k+(B^A&(L^B))+O[12]+2368359562&4294967295,k=L+(M<<20&4294967295|M>>>12),M=A+(k^L^B)+O[5]+4294588738&4294967295,A=k+(M<<4&4294967295|M>>>28),M=B+(A^k^L)+O[8]+2272392833&4294967295,B=A+(M<<11&4294967295|M>>>21),M=L+(B^A^k)+O[11]+1839030562&4294967295,L=B+(M<<16&4294967295|M>>>16),M=k+(L^B^A)+O[14]+4259657740&4294967295,k=L+(M<<23&4294967295|M>>>9),M=A+(k^L^B)+O[1]+2763975236&4294967295,A=k+(M<<4&4294967295|M>>>28),M=B+(A^k^L)+O[4]+1272893353&4294967295,B=A+(M<<11&4294967295|M>>>21),M=L+(B^A^k)+O[7]+4139469664&4294967295,L=B+(M<<16&4294967295|M>>>16),M=k+(L^B^A)+O[10]+3200236656&4294967295,k=L+(M<<23&4294967295|M>>>9),M=A+(k^L^B)+O[13]+681279174&4294967295,A=k+(M<<4&4294967295|M>>>28),M=B+(A^k^L)+O[0]+3936430074&4294967295,B=A+(M<<11&4294967295|M>>>21),M=L+(B^A^k)+O[3]+3572445317&4294967295,L=B+(M<<16&4294967295|M>>>16),M=k+(L^B^A)+O[6]+76029189&4294967295,k=L+(M<<23&4294967295|M>>>9),M=A+(k^L^B)+O[9]+3654602809&4294967295,A=k+(M<<4&4294967295|M>>>28),M=B+(A^k^L)+O[12]+3873151461&4294967295,B=A+(M<<11&4294967295|M>>>21),M=L+(B^A^k)+O[15]+530742520&4294967295,L=B+(M<<16&4294967295|M>>>16),M=k+(L^B^A)+O[2]+3299628645&4294967295,k=L+(M<<23&4294967295|M>>>9),M=A+(L^(k|~B))+O[0]+4096336452&4294967295,A=k+(M<<6&4294967295|M>>>26),M=B+(k^(A|~L))+O[7]+1126891415&4294967295,B=A+(M<<10&4294967295|M>>>22),M=L+(A^(B|~k))+O[14]+2878612391&4294967295,L=B+(M<<15&4294967295|M>>>17),M=k+(B^(L|~A))+O[5]+4237533241&4294967295,k=L+(M<<21&4294967295|M>>>11),M=A+(L^(k|~B))+O[12]+1700485571&4294967295,A=k+(M<<6&4294967295|M>>>26),M=B+(k^(A|~L))+O[3]+2399980690&4294967295,B=A+(M<<10&4294967295|M>>>22),M=L+(A^(B|~k))+O[10]+4293915773&4294967295,L=B+(M<<15&4294967295|M>>>17),M=k+(B^(L|~A))+O[1]+2240044497&4294967295,k=L+(M<<21&4294967295|M>>>11),M=A+(L^(k|~B))+O[8]+1873313359&4294967295,A=k+(M<<6&4294967295|M>>>26),M=B+(k^(A|~L))+O[15]+4264355552&4294967295,B=A+(M<<10&4294967295|M>>>22),M=L+(A^(B|~k))+O[6]+2734768916&4294967295,L=B+(M<<15&4294967295|M>>>17),M=k+(B^(L|~A))+O[13]+1309151649&4294967295,k=L+(M<<21&4294967295|M>>>11),M=A+(L^(k|~B))+O[4]+4149444226&4294967295,A=k+(M<<6&4294967295|M>>>26),M=B+(k^(A|~L))+O[11]+3174756917&4294967295,B=A+(M<<10&4294967295|M>>>22),M=L+(A^(B|~k))+O[2]+718787259&4294967295,L=B+(M<<15&4294967295|M>>>17),M=k+(B^(L|~A))+O[9]+3951481745&4294967295,I.g[0]=I.g[0]+A&4294967295,I.g[1]=I.g[1]+(L+(M<<21&4294967295|M>>>11))&4294967295,I.g[2]=I.g[2]+L&4294967295,I.g[3]=I.g[3]+B&4294967295}r.prototype.v=function(I,A){A===void 0&&(A=I.length);const k=A-this.blockSize,O=this.C;let L=this.h,B=0;for(;B<A;){if(L==0)for(;B<=k;)i(this,I,B),B+=this.blockSize;if(typeof I=="string"){for(;B<A;)if(O[L++]=I.charCodeAt(B++),L==this.blockSize){i(this,O),L=0;break}}else for(;B<A;)if(O[L++]=I[B++],L==this.blockSize){i(this,O),L=0;break}}this.h=L,this.o+=A},r.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var A=1;A<I.length-8;++A)I[A]=0;A=this.o*8;for(var k=I.length-8;k<I.length;++k)I[k]=A&255,A/=256;for(this.v(I),I=Array(16),A=0,k=0;k<4;++k)for(let O=0;O<32;O+=8)I[A++]=this.g[k]>>>O&255;return I};function a(I,A){var k=c;return Object.prototype.hasOwnProperty.call(k,I)?k[I]:k[I]=A(I)}function o(I,A){this.h=A;const k=[];let O=!0;for(let L=I.length-1;L>=0;L--){const B=I[L]|0;O&&B==A||(k[L]=B,O=!1)}this.g=k}var c={};function u(I){return-128<=I&&I<128?a(I,function(A){return new o([A|0],A<0?-1:0)}):new o([I|0],I<0?-1:0)}function d(I){if(isNaN(I)||!isFinite(I))return p;if(I<0)return S(d(-I));const A=[];let k=1;for(let O=0;I>=k;O++)A[O]=I/k|0,k*=4294967296;return new o(A,0)}function h(I,A){if(I.length==0)throw Error("number format error: empty string");if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(I.charAt(0)=="-")return S(h(I.substring(1),A));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=d(Math.pow(A,8));let O=p;for(let B=0;B<I.length;B+=8){var L=Math.min(8,I.length-B);const M=parseInt(I.substring(B,B+L),A);L<8?(L=d(Math.pow(A,L)),O=O.j(L).add(d(M))):(O=O.j(k),O=O.add(d(M)))}return O}var p=u(0),m=u(1),b=u(16777216);n=o.prototype,n.m=function(){if(w(this))return-S(this).m();let I=0,A=1;for(let k=0;k<this.g.length;k++){const O=this.i(k);I+=(O>=0?O:4294967296+O)*A,A*=4294967296}return I},n.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(_(this))return"0";if(w(this))return"-"+S(this).toString(I);const A=d(Math.pow(I,6));var k=this;let O="";for(;;){const L=j(k,A).g;k=T(k,L.j(A));let B=((k.g.length>0?k.g[0]:k.h)>>>0).toString(I);if(k=L,_(k))return B+O;for(;B.length<6;)B="0"+B;O=B+O}},n.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function _(I){if(I.h!=0)return!1;for(let A=0;A<I.g.length;A++)if(I.g[A]!=0)return!1;return!0}function w(I){return I.h==-1}n.l=function(I){return I=T(this,I),w(I)?-1:_(I)?0:1};function S(I){const A=I.g.length,k=[];for(let O=0;O<A;O++)k[O]=~I.g[O];return new o(k,~I.h).add(m)}n.abs=function(){return w(this)?S(this):this},n.add=function(I){const A=Math.max(this.g.length,I.g.length),k=[];let O=0;for(let L=0;L<=A;L++){let B=O+(this.i(L)&65535)+(I.i(L)&65535),M=(B>>>16)+(this.i(L)>>>16)+(I.i(L)>>>16);O=M>>>16,B&=65535,M&=65535,k[L]=M<<16|B}return new o(k,k[k.length-1]&-2147483648?-1:0)};function T(I,A){return I.add(S(A))}n.j=function(I){if(_(this)||_(I))return p;if(w(this))return w(I)?S(this).j(S(I)):S(S(this).j(I));if(w(I))return S(this.j(S(I)));if(this.l(b)<0&&I.l(b)<0)return d(this.m()*I.m());const A=this.g.length+I.g.length,k=[];for(var O=0;O<2*A;O++)k[O]=0;for(O=0;O<this.g.length;O++)for(let L=0;L<I.g.length;L++){const B=this.i(O)>>>16,M=this.i(O)&65535,Q=I.i(L)>>>16,X=I.i(L)&65535;k[2*O+2*L]+=M*X,C(k,2*O+2*L),k[2*O+2*L+1]+=B*X,C(k,2*O+2*L+1),k[2*O+2*L+1]+=M*Q,C(k,2*O+2*L+1),k[2*O+2*L+2]+=B*Q,C(k,2*O+2*L+2)}for(I=0;I<A;I++)k[I]=k[2*I+1]<<16|k[2*I];for(I=A;I<2*A;I++)k[I]=0;return new o(k,0)};function C(I,A){for(;(I[A]&65535)!=I[A];)I[A+1]+=I[A]>>>16,I[A]&=65535,A++}function R(I,A){this.g=I,this.h=A}function j(I,A){if(_(A))throw Error("division by zero");if(_(I))return new R(p,p);if(w(I))return A=j(S(I),A),new R(S(A.g),S(A.h));if(w(A))return A=j(I,S(A)),new R(S(A.g),A.h);if(I.g.length>30){if(w(I)||w(A))throw Error("slowDivide_ only works with positive integers.");for(var k=m,O=A;O.l(I)<=0;)k=z(k),O=z(O);var L=V(k,1),B=V(O,1);for(O=V(O,2),k=V(k,2);!_(O);){var M=B.add(O);M.l(I)<=0&&(L=L.add(k),B=M),O=V(O,1),k=V(k,1)}return A=T(I,L.j(A)),new R(L,A)}for(L=p;I.l(A)>=0;){for(k=Math.max(1,Math.floor(I.m()/A.m())),O=Math.ceil(Math.log(k)/Math.LN2),O=O<=48?1:Math.pow(2,O-48),B=d(k),M=B.j(A);w(M)||M.l(I)>0;)k-=O,B=d(k),M=B.j(A);_(B)&&(B=m),L=L.add(B),I=T(I,M)}return new R(L,I)}n.B=function(I){return j(this,I).h},n.and=function(I){const A=Math.max(this.g.length,I.g.length),k=[];for(let O=0;O<A;O++)k[O]=this.i(O)&I.i(O);return new o(k,this.h&I.h)},n.or=function(I){const A=Math.max(this.g.length,I.g.length),k=[];for(let O=0;O<A;O++)k[O]=this.i(O)|I.i(O);return new o(k,this.h|I.h)},n.xor=function(I){const A=Math.max(this.g.length,I.g.length),k=[];for(let O=0;O<A;O++)k[O]=this.i(O)^I.i(O);return new o(k,this.h^I.h)};function z(I){const A=I.g.length+1,k=[];for(let O=0;O<A;O++)k[O]=I.i(O)<<1|I.i(O-1)>>>31;return new o(k,I.h)}function V(I,A){const k=A>>5;A%=32;const O=I.g.length-k,L=[];for(let B=0;B<O;B++)L[B]=A>0?I.i(B+k)>>>A|I.i(B+k+1)<<32-A:I.i(B+k);return new o(L,I.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,pM=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Jo=o}).apply(typeof aI<"u"?aI:typeof self<"u"?self:typeof window<"u"?window:{});var Tm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var gM,sh,mM,r0,Ax,vM,yM,bM;(function(){var n,e=Object.defineProperty;function t(v){v=[typeof globalThis=="object"&&globalThis,v,typeof window=="object"&&window,typeof self=="object"&&self,typeof Tm=="object"&&Tm];for(var D=0;D<v.length;++D){var P=v[D];if(P&&P.Math==Math)return P}throw Error("Cannot find global object")}var r=t(this);function i(v,D){if(D)e:{var P=r;v=v.split(".");for(var q=0;q<v.length-1;q++){var le=v[q];if(!(le in P))break e;P=P[le]}v=v[v.length-1],q=P[v],D=D(q),D!=q&&D!=null&&e(P,v,{configurable:!0,writable:!0,value:D})}}i("Symbol.dispose",function(v){return v||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(v){return v||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(v){return v||function(D){var P=[],q;for(q in D)Object.prototype.hasOwnProperty.call(D,q)&&P.push([q,D[q]]);return P}});var a=a||{},o=this||self;function c(v){var D=typeof v;return D=="object"&&v!=null||D=="function"}function u(v,D,P){return v.call.apply(v.bind,arguments)}function d(v,D,P){return d=u,d.apply(null,arguments)}function h(v,D){var P=Array.prototype.slice.call(arguments,1);return function(){var q=P.slice();return q.push.apply(q,arguments),v.apply(this,q)}}function p(v,D){function P(){}P.prototype=D.prototype,v.Z=D.prototype,v.prototype=new P,v.prototype.constructor=v,v.Ob=function(q,le,he){for(var Re=Array(arguments.length-2),ht=2;ht<arguments.length;ht++)Re[ht-2]=arguments[ht];return D.prototype[le].apply(q,Re)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?v=>v&&AsyncContext.Snapshot.wrap(v):v=>v;function b(v){const D=v.length;if(D>0){const P=Array(D);for(let q=0;q<D;q++)P[q]=v[q];return P}return[]}function _(v,D){for(let q=1;q<arguments.length;q++){const le=arguments[q];var P=typeof le;if(P=P!="object"?P:le?Array.isArray(le)?"array":P:"null",P=="array"||P=="object"&&typeof le.length=="number"){P=v.length||0;const he=le.length||0;v.length=P+he;for(let Re=0;Re<he;Re++)v[P+Re]=le[Re]}else v.push(le)}}class w{constructor(D,P){this.i=D,this.j=P,this.h=0,this.g=null}get(){let D;return this.h>0?(this.h--,D=this.g,this.g=D.next,D.next=null):D=this.i(),D}}function S(v){o.setTimeout(()=>{throw v},0)}function T(){var v=I;let D=null;return v.g&&(D=v.g,v.g=v.g.next,v.g||(v.h=null),D.next=null),D}class C{constructor(){this.h=this.g=null}add(D,P){const q=R.get();q.set(D,P),this.h?this.h.next=q:this.g=q,this.h=q}}var R=new w(()=>new j,v=>v.reset());class j{constructor(){this.next=this.g=this.h=null}set(D,P){this.h=D,this.g=P,this.next=null}reset(){this.next=this.g=this.h=null}}let z,V=!1,I=new C,A=()=>{const v=Promise.resolve(void 0);z=()=>{v.then(k)}};function k(){for(var v;v=T();){try{v.h.call(v.g)}catch(P){S(P)}var D=R;D.j(v),D.h<100&&(D.h++,v.next=D.g,D.g=v)}V=!1}function O(){this.u=this.u,this.C=this.C}O.prototype.u=!1,O.prototype.dispose=function(){this.u||(this.u=!0,this.N())},O.prototype[Symbol.dispose]=function(){this.dispose()},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(v,D){this.type=v,this.g=this.target=D,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var v=!1,D=Object.defineProperty({},"passive",{get:function(){v=!0}});try{const P=()=>{};o.addEventListener("test",P,D),o.removeEventListener("test",P,D)}catch{}return v})();function M(v){return/^[\s\xa0]*$/.test(v)}function Q(v,D){L.call(this,v?v.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,v&&this.init(v,D)}p(Q,L),Q.prototype.init=function(v,D){const P=this.type=v.type,q=v.changedTouches&&v.changedTouches.length?v.changedTouches[0]:null;this.target=v.target||v.srcElement,this.g=D,D=v.relatedTarget,D||(P=="mouseover"?D=v.fromElement:P=="mouseout"&&(D=v.toElement)),this.relatedTarget=D,q?(this.clientX=q.clientX!==void 0?q.clientX:q.pageX,this.clientY=q.clientY!==void 0?q.clientY:q.pageY,this.screenX=q.screenX||0,this.screenY=q.screenY||0):(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0),this.button=v.button,this.key=v.key||"",this.ctrlKey=v.ctrlKey,this.altKey=v.altKey,this.shiftKey=v.shiftKey,this.metaKey=v.metaKey,this.pointerId=v.pointerId||0,this.pointerType=v.pointerType,this.state=v.state,this.i=v,v.defaultPrevented&&Q.Z.h.call(this)},Q.prototype.h=function(){Q.Z.h.call(this);const v=this.i;v.preventDefault?v.preventDefault():v.returnValue=!1};var X="closure_listenable_"+(Math.random()*1e6|0),$=0;function H(v,D,P,q,le){this.listener=v,this.proxy=null,this.src=D,this.type=P,this.capture=!!q,this.ha=le,this.key=++$,this.da=this.fa=!1}function Z(v){v.da=!0,v.listener=null,v.proxy=null,v.src=null,v.ha=null}function re(v,D,P){for(const q in v)D.call(P,v[q],q,v)}function de(v,D){for(const P in v)D.call(void 0,v[P],P,v)}function U(v){const D={};for(const P in v)D[P]=v[P];return D}const Y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ne(v,D){let P,q;for(let le=1;le<arguments.length;le++){q=arguments[le];for(P in q)v[P]=q[P];for(let he=0;he<Y.length;he++)P=Y[he],Object.prototype.hasOwnProperty.call(q,P)&&(v[P]=q[P])}}function ie(v){this.src=v,this.g={},this.h=0}ie.prototype.add=function(v,D,P,q,le){const he=v.toString();v=this.g[he],v||(v=this.g[he]=[],this.h++);const Re=se(v,D,q,le);return Re>-1?(D=v[Re],P||(D.fa=!1)):(D=new H(D,this.src,he,!!q,le),D.fa=P,v.push(D)),D};function te(v,D){const P=D.type;if(P in v.g){var q=v.g[P],le=Array.prototype.indexOf.call(q,D,void 0),he;(he=le>=0)&&Array.prototype.splice.call(q,le,1),he&&(Z(D),v.g[P].length==0&&(delete v.g[P],v.h--))}}function se(v,D,P,q){for(let le=0;le<v.length;++le){const he=v[le];if(!he.da&&he.listener==D&&he.capture==!!P&&he.ha==q)return le}return-1}var me="closure_lm_"+(Math.random()*1e6|0),Te={};function Ce(v,D,P,q,le){if(Array.isArray(D)){for(let he=0;he<D.length;he++)Ce(v,D[he],P,q,le);return null}return P=yt(P),v&&v[X]?v.J(D,P,c(q)?!!q.capture:!1,le):Ne(v,D,P,!1,q,le)}function Ne(v,D,P,q,le,he){if(!D)throw Error("Invalid event type");const Re=c(le)?!!le.capture:!!le;let ht=ze(v);if(ht||(v[me]=ht=new ie(v)),P=ht.add(D,P,q,Re,he),P.proxy)return P;if(q=xe(),P.proxy=q,q.src=v,q.listener=P,v.addEventListener)B||(le=Re),le===void 0&&(le=!1),v.addEventListener(D.toString(),q,le);else if(v.attachEvent)v.attachEvent(Oe(D.toString()),q);else if(v.addListener&&v.removeListener)v.addListener(q);else throw Error("addEventListener and attachEvent are unavailable.");return P}function xe(){function v(P){return D.call(v.src,v.listener,P)}const D=Be;return v}function Ee(v,D,P,q,le){if(Array.isArray(D))for(var he=0;he<D.length;he++)Ee(v,D[he],P,q,le);else q=c(q)?!!q.capture:!!q,P=yt(P),v&&v[X]?(v=v.i,he=String(D).toString(),he in v.g&&(D=v.g[he],P=se(D,P,q,le),P>-1&&(Z(D[P]),Array.prototype.splice.call(D,P,1),D.length==0&&(delete v.g[he],v.h--)))):v&&(v=ze(v))&&(D=v.g[D.toString()],v=-1,D&&(v=se(D,P,q,le)),(P=v>-1?D[v]:null)&&Qe(P))}function Qe(v){if(typeof v!="number"&&v&&!v.da){var D=v.src;if(D&&D[X])te(D.i,v);else{var P=v.type,q=v.proxy;D.removeEventListener?D.removeEventListener(P,q,v.capture):D.detachEvent?D.detachEvent(Oe(P),q):D.addListener&&D.removeListener&&D.removeListener(q),(P=ze(D))?(te(P,v),P.h==0&&(P.src=null,D[me]=null)):Z(v)}}}function Oe(v){return v in Te?Te[v]:Te[v]="on"+v}function Be(v,D){if(v.da)v=!0;else{D=new Q(D,this);const P=v.listener,q=v.ha||v.src;v.fa&&Qe(v),v=P.call(q,D)}return v}function ze(v){return v=v[me],v instanceof ie?v:null}var st="__closure_events_fn_"+(Math.random()*1e9>>>0);function yt(v){return typeof v=="function"?v:(v[st]||(v[st]=function(D){return v.handleEvent(D)}),v[st])}function Ve(){O.call(this),this.i=new ie(this),this.M=this,this.G=null}p(Ve,O),Ve.prototype[X]=!0,Ve.prototype.removeEventListener=function(v,D,P,q){Ee(this,v,D,P,q)};function Ke(v,D){var P,q=v.G;if(q)for(P=[];q;q=q.G)P.push(q);if(v=v.M,q=D.type||D,typeof D=="string")D=new L(D,v);else if(D instanceof L)D.target=D.target||v;else{var le=D;D=new L(q,v),ne(D,le)}le=!0;let he,Re;if(P)for(Re=P.length-1;Re>=0;Re--)he=D.g=P[Re],le=Mt(he,q,!0,D)&&le;if(he=D.g=v,le=Mt(he,q,!0,D)&&le,le=Mt(he,q,!1,D)&&le,P)for(Re=0;Re<P.length;Re++)he=D.g=P[Re],le=Mt(he,q,!1,D)&&le}Ve.prototype.N=function(){if(Ve.Z.N.call(this),this.i){var v=this.i;for(const D in v.g){const P=v.g[D];for(let q=0;q<P.length;q++)Z(P[q]);delete v.g[D],v.h--}}this.G=null},Ve.prototype.J=function(v,D,P,q){return this.i.add(String(v),D,!1,P,q)},Ve.prototype.K=function(v,D,P,q){return this.i.add(String(v),D,!0,P,q)};function Mt(v,D,P,q){if(D=v.i.g[String(D)],!D)return!0;D=D.concat();let le=!0;for(let he=0;he<D.length;++he){const Re=D[he];if(Re&&!Re.da&&Re.capture==P){const ht=Re.listener,Dn=Re.ha||Re.src;Re.fa&&te(v.i,Re),le=ht.call(Dn,q)!==!1&&le}}return le&&!q.defaultPrevented}function vn(v,D){if(typeof v!="function")if(v&&typeof v.handleEvent=="function")v=d(v.handleEvent,v);else throw Error("Invalid listener argument");return Number(D)>2147483647?-1:o.setTimeout(v,D||0)}function dn(v){v.g=vn(()=>{v.g=null,v.i&&(v.i=!1,dn(v))},v.l);const D=v.h;v.h=null,v.m.apply(null,D)}class bt extends O{constructor(D,P){super(),this.m=D,this.l=P,this.h=null,this.i=!1,this.g=null}j(D){this.h=arguments,this.g?this.i=!0:dn(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Lt(v){O.call(this),this.h=v,this.g={}}p(Lt,O);var Cr=[];function Qn(v){re(v.g,function(D,P){this.g.hasOwnProperty(P)&&Qe(D)},v),v.g={}}Lt.prototype.N=function(){Lt.Z.N.call(this),Qn(this)},Lt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Yr=o.JSON.stringify,ls=o.JSON.parse,Zs=class{stringify(v){return o.JSON.stringify(v,void 0)}parse(v){return o.JSON.parse(v,void 0)}};function Zi(){}function _a(){}var jr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function yn(){L.call(this,"d")}p(yn,L);function cr(){L.call(this,"c")}p(cr,L);var en={},Js=null;function ke(){return Js=Js||new Ve}en.Ia="serverreachability";function Me(v){L.call(this,en.Ia,v)}p(Me,L);function dt(v){const D=ke();Ke(D,new Me(D))}en.STAT_EVENT="statevent";function Xe(v,D){L.call(this,en.STAT_EVENT,v),this.stat=D}p(Xe,L);function Ze(v){const D=ke();Ke(D,new Xe(D,v))}en.Ja="timingevent";function Tn(v,D){L.call(this,en.Ja,v),this.size=D}p(Tn,L);function Jt(v,D){if(typeof v!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){v()},D)}function nt(){this.g=!0}nt.prototype.ua=function(){this.g=!1};function An(v,D,P,q,le,he){v.info(function(){if(v.g)if(he){var Re="",ht=he.split("&");for(let Vt=0;Vt<ht.length;Vt++){var Dn=ht[Vt].split("=");if(Dn.length>1){const sn=Dn[0];Dn=Dn[1];const Ii=sn.split("_");Re=Ii.length>=2&&Ii[1]=="type"?Re+(sn+"="+Dn+"&"):Re+(sn+"=redacted&")}}}else Re=null;else Re=he;return"XMLHTTP REQ ("+q+") [attempt "+le+"]: "+D+`
`+P+`
`+Re})}function Rt(v,D,P,q,le,he,Re){v.info(function(){return"XMLHTTP RESP ("+q+") [ attempt "+le+"]: "+D+`
`+P+`
`+he+" "+Re})}function St(v,D,P,q){v.info(function(){return"XMLHTTP TEXT ("+D+"): "+fn(v,P)+(q?" "+q:"")})}function Cn(v,D){v.info(function(){return"TIMEOUT: "+D})}nt.prototype.info=function(){};function fn(v,D){if(!v.g)return D;if(!D)return null;try{const he=JSON.parse(D);if(he){for(v=0;v<he.length;v++)if(Array.isArray(he[v])){var P=he[v];if(!(P.length<2)){var q=P[1];if(Array.isArray(q)&&!(q.length<1)){var le=q[0];if(le!="noop"&&le!="stop"&&le!="close")for(let Re=1;Re<q.length;Re++)q[Re]=""}}}}return Yr(he)}catch{return D}}var xt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},In={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Zn;function li(){}p(li,Zi),li.prototype.g=function(){return new XMLHttpRequest},Zn=new li;function Jn(v){return encodeURIComponent(String(v))}function Si(v){var D=1;v=v.split(":");const P=[];for(;D>0&&v.length;)P.push(v.shift()),D--;return v.length&&P.push(v.join(":")),P}function Rn(v,D,P,q){this.j=v,this.i=D,this.l=P,this.S=q||1,this.V=new Lt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ji}function Ji(){this.i=null,this.g="",this.h=!1}var jn={},ur={};function wa(v,D,P){v.M=1,v.A=xl(Ln(D)),v.u=P,v.R=!0,Uc(v,null)}function Uc(v,D){v.F=Date.now(),Ea(v),v.B=Ln(v.A);var P=v.B,q=v.S;Array.isArray(q)||(q=[String(q)]),Hc(P.i,"t",q),v.C=0,P=v.j.L,v.h=new Ji,v.g=pg(v.j,P?D:null,!v.u),v.P>0&&(v.O=new bt(d(v.Y,v,v.g),v.P)),D=v.V,P=v.g,q=v.ba;var le="readystatechange";Array.isArray(le)||(le&&(Cr[0]=le.toString()),le=Cr);for(let he=0;he<le.length;he++){const Re=Ce(P,le[he],q||D.handleEvent,!1,D.h||D);if(!Re)break;D.g[Re.key]=Re}D=v.J?U(v.J):{},v.u?(v.v||(v.v="POST"),D["Content-Type"]="application/x-www-form-urlencoded",v.g.ea(v.B,v.v,v.u,D)):(v.v="GET",v.g.ea(v.B,v.v,null,D)),dt(),An(v.i,v.v,v.B,v.l,v.S,v.u)}Rn.prototype.ba=function(v){v=v.target;const D=this.O;D&&na(v)==3?D.j():this.Y(v)},Rn.prototype.Y=function(v){try{if(v==this.g)e:{const ht=na(this.g),Dn=this.g.ya(),Vt=this.g.ca();if(!(ht<3)&&(ht!=3||this.g&&(this.h.h||this.g.la()||vr(this.g)))){this.K||ht!=4||Dn==7||(Dn==8||Vt<=0?dt(3):dt(2)),Sa(this);var D=this.g.ca();this.X=D;var P=hy(this);if(this.o=D==200,Rt(this.i,this.v,this.B,this.l,this.S,ht,D),this.o){if(this.U&&!this.L){t:{if(this.g){var q,le=this.g;if((q=le.g?le.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(q)){var he=q;break t}}he=null}if(v=he)St(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ta(this,v);else{this.o=!1,this.m=3,Ze(12),ci(this),Ti(this);break e}}if(this.R){v=!0;let sn;for(;!this.K&&this.C<P.length;)if(sn=tg(this,P),sn==ur){ht==4&&(this.m=4,Ze(14),v=!1),St(this.i,this.l,null,"[Incomplete Response]");break}else if(sn==jn){this.m=4,Ze(15),St(this.i,this.l,P,"[Invalid Chunk]"),v=!1;break}else St(this.i,this.l,sn,null),Ta(this,sn);if(eg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ht!=4||P.length!=0||this.h.h||(this.m=1,Ze(16),v=!1),this.o=this.o&&v,!v)St(this.i,this.l,P,"[Invalid Chunked Response]"),ci(this),Ti(this);else if(P.length>0&&!this.W){this.W=!0;var Re=this.j;Re.g==this&&Re.aa&&!Re.P&&(Re.j.info("Great, no buffering proxy detected. Bytes received: "+P.length),df(Re),Re.P=!0,Ze(11))}}else St(this.i,this.l,P,null),Ta(this,P);ht==4&&ci(this),this.o&&!this.K&&(ht==4?ug(this.j,this):(this.o=!1,Ea(this)))}else us(this.g),D==400&&P.indexOf("Unknown SID")>0?(this.m=3,Ze(12)):(this.m=0,Ze(13)),ci(this),Ti(this)}}}catch{}finally{}};function hy(v){if(!eg(v))return v.g.la();const D=vr(v.g);if(D==="")return"";let P="";const q=D.length,le=na(v.g)==4;if(!v.h.i){if(typeof TextDecoder>"u")return ci(v),Ti(v),"";v.h.i=new o.TextDecoder}for(let he=0;he<q;he++)v.h.h=!0,P+=v.h.i.decode(D[he],{stream:!(le&&he==q-1)});return D.length=0,v.h.g+=P,v.C=0,v.h.g}function eg(v){return v.g?v.v=="GET"&&v.M!=2&&v.j.Aa:!1}function tg(v,D){var P=v.C,q=D.indexOf(`
`,P);return q==-1?ur:(P=Number(D.substring(P,q)),isNaN(P)?jn:(q+=1,q+P>D.length?ur:(D=D.slice(q,q+P),v.C=q+P,D)))}Rn.prototype.cancel=function(){this.K=!0,ci(this)};function Ea(v){v.T=Date.now()+v.H,Fc(v,v.H)}function Fc(v,D){if(v.D!=null)throw Error("WatchDog timer not null");v.D=Jt(d(v.aa,v),D)}function Sa(v){v.D&&(o.clearTimeout(v.D),v.D=null)}Rn.prototype.aa=function(){this.D=null;const v=Date.now();v-this.T>=0?(Cn(this.i,this.B),this.M!=2&&(dt(),Ze(17)),ci(this),this.m=2,Ti(this)):Fc(this,this.T-v)};function Ti(v){v.j.I==0||v.K||ug(v.j,v)}function ci(v){Sa(v);var D=v.O;D&&typeof D.dispose=="function"&&D.dispose(),v.O=null,Qn(v.V),v.g&&(D=v.g,v.g=null,D.abort(),D.dispose())}function Ta(v,D){try{var P=v.j;if(P.I!=0&&(P.g==v||Ca(P.h,v))){if(!v.L&&Ca(P.h,v)&&P.I==3){try{var q=P.Ba.g.parse(D)}catch{q=null}if(Array.isArray(q)&&q.length==3){var le=q;if(le[0]==0){e:if(!P.v){if(P.g)if(P.g.F+3e3<v.F)Wc(P),oo(P);else break e;Cl(P),Ze(18)}}else P.xa=le[1],0<P.xa-P.K&&le[2]<37500&&P.F&&P.A==0&&!P.C&&(P.C=Jt(d(P.Va,P),6e3));Aa(P.h)<=1&&P.ta&&(P.ta=void 0)}else Ma(P,11)}else if((v.L||P.g==v)&&Wc(P),!M(D))for(le=P.Ba.g.parse(D),D=0;D<le.length;D++){let Vt=le[D];const sn=Vt[0];if(!(sn<=P.K))if(P.K=sn,Vt=Vt[1],P.I==2)if(Vt[0]=="c"){P.M=Vt[1],P.ba=Vt[2];const Ii=Vt[3];Ii!=null&&(P.ka=Ii,P.j.info("VER="+P.ka));const Pa=Vt[4];Pa!=null&&(P.za=Pa,P.j.info("SVER="+P.za));const ra=Vt[5];ra!=null&&typeof ra=="number"&&ra>0&&(q=1.5*ra,P.O=q,P.j.info("backChannelRequestTimeoutMs_="+q)),q=P;const ia=v.g;if(ia){const Il=ia.g?ia.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Il){var he=q.h;he.g||Il.indexOf("spdy")==-1&&Il.indexOf("quic")==-1&&Il.indexOf("h2")==-1||(he.j=he.l,he.g=new Set,he.h&&(Zd(he,he.h),he.h=null))}if(q.G){const Qc=ia.g?ia.g.getResponseHeader("X-HTTP-Session-Id"):null;Qc&&(q.wa=Qc,Bt(q.J,q.G,Qc))}}P.I=3,P.l&&P.l.ra(),P.aa&&(P.T=Date.now()-v.F,P.j.info("Handshake RTT: "+P.T+"ms")),q=P;var Re=v;if(q.na=hg(q,q.L?q.ba:null,q.W),Re.L){Jd(q.h,Re);var ht=Re,Dn=q.O;Dn&&(ht.H=Dn),ht.D&&(Sa(ht),Ea(ht)),q.g=Re}else lg(q);P.i.length>0&&Na(P)}else Vt[0]!="stop"&&Vt[0]!="close"||Ma(P,7);else P.I==3&&(Vt[0]=="stop"||Vt[0]=="close"?Vt[0]=="stop"?Ma(P,7):cf(P):Vt[0]!="noop"&&P.l&&P.l.qa(Vt),P.A=0)}}dt(4)}catch{}}var zn=class{constructor(v,D){this.g=v,this.map=D}};function Wd(v){this.l=v||10,o.PerformanceNavigationTiming?(v=o.performance.getEntriesByType("navigation"),v=v.length>0&&(v[0].nextHopProtocol=="hq"||v[0].nextHopProtocol=="h2")):v=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=v?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Qd(v){return v.h?!0:v.g?v.g.size>=v.j:!1}function Aa(v){return v.h?1:v.g?v.g.size:0}function Ca(v,D){return v.h?v.h==D:v.g?v.g.has(D):!1}function Zd(v,D){v.g?v.g.add(D):v.h=D}function Jd(v,D){v.h&&v.h==D?v.h=null:v.g&&v.g.has(D)&&v.g.delete(D)}Wd.prototype.cancel=function(){if(this.i=ef(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const v of this.g.values())v.cancel();this.g.clear()}};function ef(v){if(v.h!=null)return v.i.concat(v.h.G);if(v.g!=null&&v.g.size!==0){let D=v.i;for(const P of v.g.values())D=D.concat(P.G);return D}return b(v.i)}var ng=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Gc(v,D){if(v){v=v.split("&");for(let P=0;P<v.length;P++){const q=v[P].indexOf("=");let le,he=null;q>=0?(le=v[P].substring(0,q),he=v[P].substring(q+1)):le=v[P],D(le,he?decodeURIComponent(he.replace(/\+/g," ")):"")}}}function ui(v){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let D;v instanceof ui?(this.l=v.l,dr(this,v.j),this.o=v.o,this.g=v.g,eo(this,v.u),this.h=v.h,tf(this,sg(v.i)),this.m=v.m):v&&(D=String(v).match(ng))?(this.l=!1,dr(this,D[1]||"",!0),this.o=Ia(D[2]||""),this.g=Ia(D[3]||"",!0),eo(this,D[4]),this.h=Ia(D[5]||"",!0),tf(this,D[6]||"",!0),this.m=Ia(D[7]||"")):(this.l=!1,this.i=new no(null,this.l))}ui.prototype.toString=function(){const v=[];var D=this.j;D&&v.push(_l(D,qc,!0),":");var P=this.g;return(P||D=="file")&&(v.push("//"),(D=this.o)&&v.push(_l(D,qc,!0),"@"),v.push(Jn(P).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),P=this.u,P!=null&&v.push(":",String(P))),(P=this.h)&&(this.g&&P.charAt(0)!="/"&&v.push("/"),v.push(_l(P,P.charAt(0)=="/"?nf:rg,!0))),(P=this.i.toString())&&v.push("?",P),(P=this.m)&&v.push("#",_l(P,ig)),v.join("")},ui.prototype.resolve=function(v){const D=Ln(this);let P=!!v.j;P?dr(D,v.j):P=!!v.o,P?D.o=v.o:P=!!v.g,P?D.g=v.g:P=v.u!=null;var q=v.h;if(P)eo(D,v.u);else if(P=!!v.h){if(q.charAt(0)!="/")if(this.g&&!this.h)q="/"+q;else{var le=D.h.lastIndexOf("/");le!=-1&&(q=D.h.slice(0,le+1)+q)}if(le=q,le==".."||le==".")q="";else if(le.indexOf("./")!=-1||le.indexOf("/.")!=-1){q=le.lastIndexOf("/",0)==0,le=le.split("/");const he=[];for(let Re=0;Re<le.length;){const ht=le[Re++];ht=="."?q&&Re==le.length&&he.push(""):ht==".."?((he.length>1||he.length==1&&he[0]!="")&&he.pop(),q&&Re==le.length&&he.push("")):(he.push(ht),q=!0)}q=he.join("/")}else q=le}return P?D.h=q:P=v.i.toString()!=="",P?tf(D,sg(v.i)):P=!!v.m,P&&(D.m=v.m),D};function Ln(v){return new ui(v)}function dr(v,D,P){v.j=P?Ia(D,!0):D,v.j&&(v.j=v.j.replace(/:$/,""))}function eo(v,D){if(D){if(D=Number(D),isNaN(D)||D<0)throw Error("Bad port number "+D);v.u=D}else v.u=null}function tf(v,D,P){D instanceof no?(v.i=D,$c(v.i,v.l)):(P||(D=_l(D,to)),v.i=new no(D,v.l))}function Bt(v,D,P){v.i.set(D,P)}function xl(v){return Bt(v,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),v}function Ia(v,D){return v?D?decodeURI(v.replace(/%25/g,"%2525")):decodeURIComponent(v):""}function _l(v,D,P){return typeof v=="string"?(v=encodeURI(v).replace(D,Kr),P&&(v=v.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v):null}function Kr(v){return v=v.charCodeAt(0),"%"+(v>>4&15).toString(16)+(v&15).toString(16)}var qc=/[#\/\?@]/g,rg=/[#\?:]/g,nf=/[#\?]/g,to=/[#\?@]/g,ig=/#/g;function no(v,D){this.h=this.g=null,this.i=v||null,this.j=!!D}function Xr(v){v.g||(v.g=new Map,v.h=0,v.i&&Gc(v.i,function(D,P){v.add(decodeURIComponent(D.replace(/\+/g," ")),P)}))}n=no.prototype,n.add=function(v,D){Xr(this),this.i=null,v=ro(this,v);let P=this.g.get(v);return P||this.g.set(v,P=[]),P.push(D),this.h+=1,this};function ag(v,D){Xr(v),D=ro(v,D),v.g.has(D)&&(v.i=null,v.h-=v.g.get(D).length,v.g.delete(D))}function rf(v,D){return Xr(v),D=ro(v,D),v.g.has(D)}n.forEach=function(v,D){Xr(this),this.g.forEach(function(P,q){P.forEach(function(le){v.call(D,le,q,this)},this)},this)};function af(v,D){Xr(v);let P=[];if(typeof D=="string")rf(v,D)&&(P=P.concat(v.g.get(ro(v,D))));else for(v=Array.from(v.g.values()),D=0;D<v.length;D++)P=P.concat(v[D]);return P}n.set=function(v,D){return Xr(this),this.i=null,v=ro(this,v),rf(this,v)&&(this.h-=this.g.get(v).length),this.g.set(v,[D]),this.h+=1,this},n.get=function(v,D){return v?(v=af(this,v),v.length>0?String(v[0]):D):D};function Hc(v,D,P){ag(v,D),P.length>0&&(v.i=null,v.g.set(ro(v,D),b(P)),v.h+=P.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const v=[],D=Array.from(this.g.keys());for(let q=0;q<D.length;q++){var P=D[q];const le=Jn(P);P=af(this,P);for(let he=0;he<P.length;he++){let Re=le;P[he]!==""&&(Re+="="+Jn(P[he])),v.push(Re)}}return this.i=v.join("&")};function sg(v){const D=new no;return D.i=v.i,v.g&&(D.g=new Map(v.g),D.h=v.h),D}function ro(v,D){return D=String(D),v.j&&(D=D.toLowerCase()),D}function $c(v,D){D&&!v.j&&(Xr(v),v.i=null,v.g.forEach(function(P,q){const le=q.toLowerCase();q!=le&&(ag(this,q),Hc(this,le,P))},v)),v.j=D}function ea(v,D){const P=new nt;if(o.Image){const q=new Image;q.onload=h(Ai,P,"TestLoadImage: loaded",!0,D,q),q.onerror=h(Ai,P,"TestLoadImage: error",!1,D,q),q.onabort=h(Ai,P,"TestLoadImage: abort",!1,D,q),q.ontimeout=h(Ai,P,"TestLoadImage: timeout",!1,D,q),o.setTimeout(function(){q.ontimeout&&q.ontimeout()},1e4),q.src=v}else D(!1)}function sf(v,D){const P=new nt,q=new AbortController,le=setTimeout(()=>{q.abort(),Ai(P,"TestPingServer: timeout",!1,D)},1e4);fetch(v,{signal:q.signal}).then(he=>{clearTimeout(le),he.ok?Ai(P,"TestPingServer: ok",!0,D):Ai(P,"TestPingServer: server error",!1,D)}).catch(()=>{clearTimeout(le),Ai(P,"TestPingServer: error",!1,D)})}function Ai(v,D,P,q,le){try{le&&(le.onload=null,le.onerror=null,le.onabort=null,le.ontimeout=null),q(P)}catch{}}function io(){this.g=new Zs}function Ra(v){this.i=v.Sb||null,this.h=v.ab||!1}p(Ra,Zi),Ra.prototype.g=function(){return new wl(this.i,this.h)};function wl(v,D){Ve.call(this),this.H=v,this.o=D,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(wl,Ve),n=wl.prototype,n.open=function(v,D){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=v,this.D=D,this.readyState=1,ta(this)},n.send=function(v){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const D={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};v&&(D.body=v),(this.H||o).fetch(new Request(this.D,D)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ao(this)),this.readyState=0},n.Pa=function(v){if(this.g&&(this.l=v,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=v.headers,this.readyState=2,ta(this)),this.g&&(this.readyState=3,ta(this),this.g)))if(this.responseType==="arraybuffer")v.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in v){if(this.j=v.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Yc(this)}else v.text().then(this.Oa.bind(this),this.ga.bind(this))};function Yc(v){v.j.read().then(v.Ma.bind(v)).catch(v.ga.bind(v))}n.Ma=function(v){if(this.g){if(this.o&&v.value)this.response.push(v.value);else if(!this.o){var D=v.value?v.value:new Uint8Array(0);(D=this.B.decode(D,{stream:!v.done}))&&(this.response=this.responseText+=D)}v.done?ao(this):ta(this),this.readyState==3&&Yc(this)}},n.Oa=function(v){this.g&&(this.response=this.responseText=v,ao(this))},n.Na=function(v){this.g&&(this.response=v,ao(this))},n.ga=function(){this.g&&ao(this)};function ao(v){v.readyState=4,v.l=null,v.j=null,v.B=null,ta(v)}n.setRequestHeader=function(v,D){this.A.append(v,D)},n.getResponseHeader=function(v){return this.h&&this.h.get(v.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const v=[],D=this.h.entries();for(var P=D.next();!P.done;)P=P.value,v.push(P[0]+": "+P[1]),P=D.next();return v.join(`\r
`)};function ta(v){v.onreadystatechange&&v.onreadystatechange.call(v)}Object.defineProperty(wl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(v){this.m=v?"include":"same-origin"}});function Ci(v){let D="";return re(v,function(P,q){D+=q,D+=":",D+=P,D+=`\r
`}),D}function El(v,D,P){e:{for(q in P){var q=!1;break e}q=!0}q||(P=Ci(P),typeof v=="string"?P!=null&&Jn(P):Bt(v,D,P))}function Ht(v){Ve.call(this),this.headers=new Map,this.L=v||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(Ht,Ve);var Da=/^https?$/i,of=["POST","PUT"];n=Ht.prototype,n.Fa=function(v){this.H=v},n.ea=function(v,D,P,q){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+v);D=D?D.toUpperCase():"GET",this.D=v,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Zn.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(D,String(v),!0),this.B=!1}catch(he){Sl(this,he);return}if(v=P||"",P=new Map(this.headers),q)if(Object.getPrototypeOf(q)===Object.prototype)for(var le in q)P.set(le,q[le]);else if(typeof q.keys=="function"&&typeof q.get=="function")for(const he of q.keys())P.set(he,q.get(he));else throw Error("Unknown input type for opt_headers: "+String(q));q=Array.from(P.keys()).find(he=>he.toLowerCase()=="content-type"),le=o.FormData&&v instanceof o.FormData,!(Array.prototype.indexOf.call(of,D,void 0)>=0)||q||le||P.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[he,Re]of P)this.g.setRequestHeader(he,Re);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(v),this.v=!1}catch(he){Sl(this,he)}};function Sl(v,D){v.h=!1,v.g&&(v.j=!0,v.g.abort(),v.j=!1),v.l=D,v.o=5,lf(v),cs(v)}function lf(v){v.A||(v.A=!0,Ke(v,"complete"),Ke(v,"error"))}n.abort=function(v){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=v||7,Ke(this,"complete"),Ke(this,"abort"),cs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),cs(this,!0)),Ht.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Tl(this):this.Xa())},n.Xa=function(){Tl(this)};function Tl(v){if(v.h&&typeof a<"u"){if(v.v&&na(v)==4)setTimeout(v.Ca.bind(v),0);else if(Ke(v,"readystatechange"),na(v)==4){v.h=!1;try{const he=v.ca();e:switch(he){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var D=!0;break e;default:D=!1}var P;if(!(P=D)){var q;if(q=he===0){let Re=String(v.D).match(ng)[1]||null;!Re&&o.self&&o.self.location&&(Re=o.self.location.protocol.slice(0,-1)),q=!Da.test(Re?Re.toLowerCase():"")}P=q}if(P)Ke(v,"complete"),Ke(v,"success");else{v.o=6;try{var le=na(v)>2?v.g.statusText:""}catch{le=""}v.l=le+" ["+v.ca()+"]",lf(v)}}finally{cs(v)}}}}function cs(v,D){if(v.g){v.m&&(clearTimeout(v.m),v.m=null);const P=v.g;v.g=null,D||Ke(v,"ready");try{P.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function na(v){return v.g?v.g.readyState:0}n.ca=function(){try{return na(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(v){if(this.g){var D=this.g.responseText;return v&&D.indexOf(v)==0&&(D=D.substring(v.length)),ls(D)}};function vr(v){try{if(!v.g)return null;if("response"in v.g)return v.g.response;switch(v.F){case"":case"text":return v.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in v.g)return v.g.mozResponseArrayBuffer}return null}catch{return null}}function us(v){const D={};v=(v.g&&na(v)>=2&&v.g.getAllResponseHeaders()||"").split(`\r
`);for(let q=0;q<v.length;q++){if(M(v[q]))continue;var P=Si(v[q]);const le=P[0];if(P=P[1],typeof P!="string")continue;P=P.trim();const he=D[le]||[];D[le]=he,he.push(P)}de(D,function(q){return q.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ka(v,D,P){return P&&P.internalChannelParams&&P.internalChannelParams[v]||D}function so(v){this.za=0,this.i=[],this.j=new nt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ka("failFast",!1,v),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ka("baseRetryDelayMs",5e3,v),this.Za=ka("retryDelaySeedMs",1e4,v),this.Ta=ka("forwardChannelMaxRetries",2,v),this.va=ka("forwardChannelRequestTimeoutMs",2e4,v),this.ma=v&&v.xmlHttpFactory||void 0,this.Ua=v&&v.Rb||void 0,this.Aa=v&&v.useFetchStreams||!1,this.O=void 0,this.L=v&&v.supportsCrossDomainXhr||!1,this.M="",this.h=new Wd(v&&v.concurrentRequestLimit),this.Ba=new io,this.S=v&&v.fastHandshake||!1,this.R=v&&v.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=v&&v.Pb||!1,v&&v.ua&&this.j.ua(),v&&v.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&v&&v.detectBufferingProxy||!1,this.ia=void 0,v&&v.longPollingTimeout&&v.longPollingTimeout>0&&(this.ia=v.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=so.prototype,n.ka=8,n.I=1,n.connect=function(v,D,P,q){Ze(0),this.W=v,this.H=D||{},P&&q!==void 0&&(this.H.OSID=P,this.H.OAID=q),this.F=this.X,this.J=hg(this,null,this.W),Na(this)};function cf(v){if(Kc(v),v.I==3){var D=v.V++,P=Ln(v.J);if(Bt(P,"SID",v.M),Bt(P,"RID",D),Bt(P,"TYPE","terminate"),Al(v,P),D=new Rn(v,v.j,D),D.M=2,D.A=xl(Ln(P)),P=!1,o.navigator&&o.navigator.sendBeacon)try{P=o.navigator.sendBeacon(D.A.toString(),"")}catch{}!P&&o.Image&&(new Image().src=D.A,P=!0),P||(D.g=pg(D.j,null),D.g.ea(D.A)),D.F=Date.now(),Ea(D)}fg(v)}function oo(v){v.g&&(df(v),v.g.cancel(),v.g=null)}function Kc(v){oo(v),v.v&&(o.clearTimeout(v.v),v.v=null),Wc(v),v.h.cancel(),v.m&&(typeof v.m=="number"&&o.clearTimeout(v.m),v.m=null)}function Na(v){if(!Qd(v.h)&&!v.m){v.m=!0;var D=v.Ea;z||A(),V||(z(),V=!0),I.add(D,v),v.D=0}}function Xc(v,D){return Aa(v.h)>=v.h.j-(v.m?1:0)?!1:v.m?(v.i=D.G.concat(v.i),!0):v.I==1||v.I==2||v.D>=(v.Sa?0:v.Ta)?!1:(v.m=Jt(d(v.Ea,v,D),dg(v,v.D)),v.D++,!0)}n.Ea=function(v){if(this.m)if(this.m=null,this.I==1){if(!v){this.V=Math.floor(Math.random()*1e5),v=this.V++;const le=new Rn(this,this.j,v);let he=this.o;if(this.U&&(he?(he=U(he),ne(he,this.U)):he=this.U),this.u!==null||this.R||(le.J=he,he=null),this.S)e:{for(var D=0,P=0;P<this.i.length;P++){t:{var q=this.i[P];if("__data__"in q.map&&(q=q.map.__data__,typeof q=="string")){q=q.length;break t}q=void 0}if(q===void 0)break;if(D+=q,D>4096){D=P;break e}if(D===4096||P===this.i.length-1){D=P+1;break e}}D=1e3}else D=1e3;D=og(this,le,D),P=Ln(this.J),Bt(P,"RID",v),Bt(P,"CVER",22),this.G&&Bt(P,"X-HTTP-Session-Id",this.G),Al(this,P),he&&(this.R?D="headers="+Jn(Ci(he))+"&"+D:this.u&&El(P,this.u,he)),Zd(this.h,le),this.Ra&&Bt(P,"TYPE","init"),this.S?(Bt(P,"$req",D),Bt(P,"SID","null"),le.U=!0,wa(le,P,null)):wa(le,P,D),this.I=2}}else this.I==3&&(v?uf(this,v):this.i.length==0||Qd(this.h)||uf(this))};function uf(v,D){var P;D?P=D.l:P=v.V++;const q=Ln(v.J);Bt(q,"SID",v.M),Bt(q,"RID",P),Bt(q,"AID",v.K),Al(v,q),v.u&&v.o&&El(q,v.u,v.o),P=new Rn(v,v.j,P,v.D+1),v.u===null&&(P.J=v.o),D&&(v.i=D.G.concat(v.i)),D=og(v,P,1e3),P.H=Math.round(v.va*.5)+Math.round(v.va*.5*Math.random()),Zd(v.h,P),wa(P,q,D)}function Al(v,D){v.H&&re(v.H,function(P,q){Bt(D,q,P)}),v.l&&re({},function(P,q){Bt(D,q,P)})}function og(v,D,P){P=Math.min(v.i.length,P);const q=v.l?d(v.l.Ka,v.l,v):null;e:{var le=v.i;let ht=-1;for(;;){const Dn=["count="+P];ht==-1?P>0?(ht=le[0].g,Dn.push("ofs="+ht)):ht=0:Dn.push("ofs="+ht);let Vt=!0;for(let sn=0;sn<P;sn++){var he=le[sn].g;const Ii=le[sn].map;if(he-=ht,he<0)ht=Math.max(0,le[sn].g-100),Vt=!1;else try{he="req"+he+"_"||"";try{var Re=Ii instanceof Map?Ii:Object.entries(Ii);for(const[Pa,ra]of Re){let ia=ra;c(ra)&&(ia=Yr(ra)),Dn.push(he+Pa+"="+encodeURIComponent(ia))}}catch(Pa){throw Dn.push(he+"type="+encodeURIComponent("_badmap")),Pa}}catch{q&&q(Ii)}}if(Vt){Re=Dn.join("&");break e}}Re=void 0}return v=v.i.splice(0,P),D.G=v,Re}function lg(v){if(!v.g&&!v.v){v.Y=1;var D=v.Da;z||A(),V||(z(),V=!0),I.add(D,v),v.A=0}}function Cl(v){return v.g||v.v||v.A>=3?!1:(v.Y++,v.v=Jt(d(v.Da,v),dg(v,v.A)),v.A++,!0)}n.Da=function(){if(this.v=null,cg(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var v=4*this.T;this.j.info("BP detection timer enabled: "+v),this.B=Jt(d(this.Wa,this),v)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ze(10),oo(this),cg(this))};function df(v){v.B!=null&&(o.clearTimeout(v.B),v.B=null)}function cg(v){v.g=new Rn(v,v.j,"rpc",v.Y),v.u===null&&(v.g.J=v.o),v.g.P=0;var D=Ln(v.na);Bt(D,"RID","rpc"),Bt(D,"SID",v.M),Bt(D,"AID",v.K),Bt(D,"CI",v.F?"0":"1"),!v.F&&v.ia&&Bt(D,"TO",v.ia),Bt(D,"TYPE","xmlhttp"),Al(v,D),v.u&&v.o&&El(D,v.u,v.o),v.O&&(v.g.H=v.O);var P=v.g;v=v.ba,P.M=1,P.A=xl(Ln(D)),P.u=null,P.R=!0,Uc(P,v)}n.Va=function(){this.C!=null&&(this.C=null,oo(this),Cl(this),Ze(19))};function Wc(v){v.C!=null&&(o.clearTimeout(v.C),v.C=null)}function ug(v,D){var P=null;if(v.g==D){Wc(v),df(v),v.g=null;var q=2}else if(Ca(v.h,D))P=D.G,Jd(v.h,D),q=1;else return;if(v.I!=0){if(D.o)if(q==1){P=D.u?D.u.length:0,D=Date.now()-D.F;var le=v.D;q=ke(),Ke(q,new Tn(q,P)),Na(v)}else lg(v);else if(le=D.m,le==3||le==0&&D.X>0||!(q==1&&Xc(v,D)||q==2&&Cl(v)))switch(P&&P.length>0&&(D=v.h,D.i=D.i.concat(P)),le){case 1:Ma(v,5);break;case 4:Ma(v,10);break;case 3:Ma(v,6);break;default:Ma(v,2)}}}function dg(v,D){let P=v.Qa+Math.floor(Math.random()*v.Za);return v.isActive()||(P*=2),P*D}function Ma(v,D){if(v.j.info("Error code "+D),D==2){var P=d(v.bb,v),q=v.Ua;const le=!q;q=new ui(q||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||dr(q,"https"),xl(q),le?ea(q.toString(),P):sf(q.toString(),P)}else Ze(2);v.I=0,v.l&&v.l.pa(D),fg(v),Kc(v)}n.bb=function(v){v?(this.j.info("Successfully pinged google.com"),Ze(2)):(this.j.info("Failed to ping google.com"),Ze(1))};function fg(v){if(v.I=0,v.ja=[],v.l){const D=ef(v.h);(D.length!=0||v.i.length!=0)&&(_(v.ja,D),_(v.ja,v.i),v.h.i.length=0,b(v.i),v.i.length=0),v.l.oa()}}function hg(v,D,P){var q=P instanceof ui?Ln(P):new ui(P);if(q.g!="")D&&(q.g=D+"."+q.g),eo(q,q.u);else{var le=o.location;q=le.protocol,D=D?D+"."+le.hostname:le.hostname,le=+le.port;const he=new ui(null);q&&dr(he,q),D&&(he.g=D),le&&eo(he,le),P&&(he.h=P),q=he}return P=v.G,D=v.wa,P&&D&&Bt(q,P,D),Bt(q,"VER",v.ka),Al(v,q),q}function pg(v,D,P){if(D&&!v.L)throw Error("Can't create secondary domain capable XhrIo object.");return D=v.Aa&&!v.ma?new Ht(new Ra({ab:P})):new Ht(v.ma),D.Fa(v.L),D}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function gg(){}n=gg.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function lo(){}lo.prototype.g=function(v,D){return new zr(v,D)};function zr(v,D){Ve.call(this),this.g=new so(D),this.l=v,this.h=D&&D.messageUrlParams||null,v=D&&D.messageHeaders||null,D&&D.clientProtocolHeaderRequired&&(v?v["X-Client-Protocol"]="webchannel":v={"X-Client-Protocol":"webchannel"}),this.g.o=v,v=D&&D.initMessageHeaders||null,D&&D.messageContentType&&(v?v["X-WebChannel-Content-Type"]=D.messageContentType:v={"X-WebChannel-Content-Type":D.messageContentType}),D&&D.sa&&(v?v["X-WebChannel-Client-Profile"]=D.sa:v={"X-WebChannel-Client-Profile":D.sa}),this.g.U=v,(v=D&&D.Qb)&&!M(v)&&(this.g.u=v),this.A=D&&D.supportsCrossDomainXhr||!1,this.v=D&&D.sendRawJson||!1,(D=D&&D.httpSessionIdParam)&&!M(D)&&(this.g.G=D,v=this.h,v!==null&&D in v&&(v=this.h,D in v&&delete v[D])),this.j=new ds(this)}p(zr,Ve),zr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},zr.prototype.close=function(){cf(this.g)},zr.prototype.o=function(v){var D=this.g;if(typeof v=="string"){var P={};P.__data__=v,v=P}else this.v&&(P={},P.__data__=Yr(v),v=P);D.i.push(new zn(D.Ya++,v)),D.I==3&&Na(D)},zr.prototype.N=function(){this.g.l=null,delete this.j,cf(this.g),delete this.g,zr.Z.N.call(this)};function mg(v){yn.call(this),v.__headers__&&(this.headers=v.__headers__,this.statusCode=v.__status__,delete v.__headers__,delete v.__status__);var D=v.__sm__;if(D){e:{for(const P in D){v=P;break e}v=void 0}(this.i=v)&&(v=this.i,D=D!==null&&v in D?D[v]:void 0),this.data=D}else this.data=v}p(mg,yn);function vg(){cr.call(this),this.status=1}p(vg,cr);function ds(v){this.g=v}p(ds,gg),ds.prototype.ra=function(){Ke(this.g,"a")},ds.prototype.qa=function(v){Ke(this.g,new mg(v))},ds.prototype.pa=function(v){Ke(this.g,new vg)},ds.prototype.oa=function(){Ke(this.g,"b")},lo.prototype.createWebChannel=lo.prototype.g,zr.prototype.send=zr.prototype.o,zr.prototype.open=zr.prototype.m,zr.prototype.close=zr.prototype.close,bM=function(){return new lo},yM=function(){return ke()},vM=en,Ax={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},xt.NO_ERROR=0,xt.TIMEOUT=8,xt.HTTP_ERROR=6,r0=xt,In.COMPLETE="complete",mM=In,_a.EventType=jr,jr.OPEN="a",jr.CLOSE="b",jr.ERROR="c",jr.MESSAGE="d",Ve.prototype.listen=Ve.prototype.J,sh=_a,Ht.prototype.listenOnce=Ht.prototype.K,Ht.prototype.getLastError=Ht.prototype.Ha,Ht.prototype.getLastErrorCode=Ht.prototype.ya,Ht.prototype.getStatus=Ht.prototype.ca,Ht.prototype.getResponseJson=Ht.prototype.La,Ht.prototype.getResponseText=Ht.prototype.la,Ht.prototype.send=Ht.prototype.ea,Ht.prototype.setWithCredentials=Ht.prototype.Fa,gM=Ht}).apply(typeof Tm<"u"?Tm:typeof self<"u"?self:typeof window<"u"?window:{});const sI="@firebase/firestore",oI="4.9.2";class Sr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Sr.UNAUTHENTICATED=new Sr(null),Sr.GOOGLE_CREDENTIALS=new Sr("google-credentials-uid"),Sr.FIRST_PARTY=new Sr("first-party-uid"),Sr.MOCK_USER=new Sr("mock-user");let Vd="12.3.0";const _c=new ow("@firebase/firestore");function Pu(){return _c.logLevel}function Se(n,...e){if(_c.logLevel<=Ct.DEBUG){const t=e.map(yw);_c.debug(`Firestore (${Vd}): ${n}`,...t)}}function Fr(n,...e){if(_c.logLevel<=Ct.ERROR){const t=e.map(yw);_c.error(`Firestore (${Vd}): ${n}`,...t)}}function wc(n,...e){if(_c.logLevel<=Ct.WARN){const t=e.map(yw);_c.warn(`Firestore (${Vd}): ${n}`,...t)}}function yw(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Le(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,xM(n,r,t)}function xM(n,e,t){let r=`FIRESTORE (${Vd}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Fr(r),new Error(r)}function Fe(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||xM(e,i,r)}function ut(n,e){return n}const ge={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ie extends Ys{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ka{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class _M{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class SF{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Sr.UNAUTHENTICATED)))}shutdown(){}}class TF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class AF{constructor(e){this.t=e,this.currentUser=Sr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Fe(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let a=new Ka;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Ka,e.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const u=a;e.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},c=u=>{Se("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>c(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(Se("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Ka)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Se("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Fe(typeof r.accessToken=="string",31837,{l:r}),new _M(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Fe(e===null||typeof e=="string",2055,{h:e}),new Sr(e)}}class CF{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Sr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class IF{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new CF(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Sr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class lI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class RF{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Fi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Fe(this.o===void 0,3512);const r=a=>{a.error!=null&&Se("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.m;return this.m=a.token,Se("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>r(a)))};const i=a=>{Se("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):Se("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new lI(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Fe(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new lI(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function DF(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class bw{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=DF(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+=e.charAt(i[a]%62))}return r}}function lt(n,e){return n<e?-1:n>e?1:0}function Cx(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),a=e.charAt(r);if(i!==a)return E1(i)===E1(a)?lt(i,a):E1(i)?1:-1}return lt(n.length,e.length)}const kF=55296,NF=57343;function E1(n){const e=n.charCodeAt(0);return e>=kF&&e<=NF}function cd(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function wM(n){return n+"\0"}const cI="__name__";class La{constructor(e,t,r){t===void 0?t=0:t>e.length&&Le(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Le(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return La.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof La?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=La.compareSegments(e.get(i),t.get(i));if(a!==0)return a}return lt(e.length,t.length)}static compareSegments(e,t){const r=La.isNumericId(e),i=La.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?La.extractNumericId(e).compare(La.extractNumericId(t)):Cx(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Jo.fromString(e.substring(4,e.length-2))}}class zt extends La{construct(e,t,r){return new zt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Ie(ge.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new zt(t)}static emptyPath(){return new zt([])}}const MF=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class pn extends La{construct(e,t,r){return new pn(e,t,r)}static isValidIdentifier(e){return MF.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),pn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===cI}static keyField(){return new pn([cI])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(r.length===0)throw new Ie(ge.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new Ie(ge.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Ie(ge.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(r+=c,i++):(a(),i++)}if(a(),o)throw new Ie(ge.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new pn(t)}static emptyPath(){return new pn([])}}class De{constructor(e){this.path=e}static fromPath(e){return new De(zt.fromString(e))}static fromName(e){return new De(zt.fromString(e).popFirst(5))}static empty(){return new De(zt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&zt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return zt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new De(new zt(e.slice()))}}function EM(n,e,t){if(!t)throw new Ie(ge.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function PF(n,e,t,r){if(e===!0&&r===!0)throw new Ie(ge.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function uI(n){if(!De.isDocumentKey(n))throw new Ie(ge.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function dI(n){if(De.isDocumentKey(n))throw new Ie(ge.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function SM(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Ev(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Le(12329,{type:typeof n})}function Mr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ie(ge.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Ev(n);throw new Ie(ge.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Kn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Sp(n,e){if(!SM(n))throw new Ie(ge.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(a!==void 0&&o!==a.value){t=`Expected '${r}' field to equal '${a.value}'`;break}}if(t)throw new Ie(ge.INVALID_ARGUMENT,t);return!0}const fI=-62135596800,hI=1e6;class et{static now(){return et.fromMillis(Date.now())}static fromDate(e){return et.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*hI);return new et(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ie(ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ie(ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<fI)throw new Ie(ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ie(ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/hI}_compareTo(e){return this.seconds===e.seconds?lt(this.nanoseconds,e.nanoseconds):lt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:et._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Sp(e,et._jsonSchema))return new et(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-fI;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}et._jsonSchemaVersion="firestore/timestamp/1.0",et._jsonSchema={type:Kn("string",et._jsonSchemaVersion),seconds:Kn("number"),nanoseconds:Kn("number")};class Ye{static fromTimestamp(e){return new Ye(e)}static min(){return new Ye(new et(0,0))}static max(){return new Ye(new et(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Fh=-1;class M0{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function Ix(n){return n.fields.find((e=>e.kind===2))}function Kl(n){return n.fields.filter((e=>e.kind!==2))}M0.UNKNOWN_ID=-1;class i0{constructor(e,t){this.fieldPath=e,this.kind=t}}class Gh{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Gh(0,wi.min())}}function OF(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Ye.fromTimestamp(r===1e9?new et(t+1,0):new et(t,r));return new wi(i,De.empty(),e)}function TM(n){return new wi(n.readTime,n.key,Fh)}class wi{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new wi(Ye.min(),De.empty(),Fh)}static max(){return new wi(Ye.max(),De.empty(),Fh)}}function xw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=De.comparator(n.documentKey,e.documentKey),t!==0?t:lt(n.largestBatchId,e.largestBatchId))}const AM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class CM{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Vc(n){if(n.code!==ge.FAILED_PRECONDITION||n.message!==AM)throw n;Se("LocalStore","Unexpectedly lost primary lease")}class oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Le(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new oe(((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof oe?t:oe.resolve(t)}catch(t){return oe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):oe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):oe.reject(t)}static resolve(e){return new oe(((t,r)=>{t(e)}))}static reject(e){return new oe(((t,r)=>{r(e)}))}static waitFor(e){return new oe(((t,r)=>{let i=0,a=0,o=!1;e.forEach((c=>{++i,c.next((()=>{++a,o&&a===i&&t()}),(u=>r(u)))})),o=!0,a===i&&t()}))}static or(e){let t=oe.resolve(!1);for(const r of e)t=t.next((i=>i?oe.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,a)=>{r.push(t.call(this,i,a))})),this.waitFor(r)}static mapArray(e,t){return new oe(((r,i)=>{const a=e.length,o=new Array(a);let c=0;for(let u=0;u<a;u++){const d=u;t(e[d]).next((h=>{o[d]=h,++c,c===a&&r(o)}),(h=>i(h)))}}))}static doWhile(e,t){return new oe(((r,i)=>{const a=()=>{e()===!0?t().next((()=>{a()}),i):r()};a()}))}}const yi="SimpleDb";class Sv{static open(e,t,r,i){try{return new Sv(t,e.transaction(i,r))}catch(a){throw new vh(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Ka,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new vh(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=_w(r.target.error);this.S.reject(new vh(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Se(yi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new jF(t)}}class el{static delete(e){return Se(yi,"Removing database:",e),Ql(mN().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!TN())return!1;if(el.F())return!0;const e=or(),t=el.M(e),r=0<t&&t<10,i=IM(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,el.M(or())===12.2&&Fr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Se(yi,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=a=>{const o=a.target.result;t(o)},i.onblocked=()=>{r(new vh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=a=>{const o=a.target.error;o.name==="VersionError"?r(new Ie(ge.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Ie(ge.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new vh(e,o))},i.onupgradeneeded=a=>{Se(yi,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const o=a.target.result;this.N.k(o,i.transaction,a.oldVersion,this.version).next((()=>{Se(yi,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const a=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const c=Sv.open(this.db,e,a?"readonly":"readwrite",r),u=i(c).next((d=>(c.C(),d))).catch((d=>(c.abort(d),oe.reject(d)))).toPromise();return u.catch((()=>{})),await c.D,u}catch(c){const u=c,d=u.name!=="FirebaseError"&&o<3;if(Se(yi,"Transaction failed with error:",u.message,"Retrying:",d),this.close(),!d)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function IM(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class VF{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ql(this.U.delete())}}class vh extends Ie{constructor(e,t){super(ge.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function gl(n){return n.name==="IndexedDbTransactionError"}class jF{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Se(yi,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Se(yi,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ql(r)}add(e){return Se(yi,"ADD",this.store.name,e,e),Ql(this.store.add(e))}get(e){return Ql(this.store.get(e)).next((t=>(t===void 0&&(t=null),Se(yi,"GET",this.store.name,e,t),t)))}delete(e){return Se(yi,"DELETE",this.store.name,e),Ql(this.store.delete(e))}count(){return Se(yi,"COUNT",this.store.name),Ql(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const a=i.getAll(r.range);return new oe(((o,c)=>{a.onerror=u=>{c(u.target.error)},a.onsuccess=u=>{o(u.target.result)}}))}{const a=this.cursor(r),o=[];return this.H(a,((c,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new oe(((i,a)=>{r.onerror=o=>{a(o.target.error)},r.onsuccess=o=>{i(o.target.result)}}))}Z(e,t){Se(yi,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((a,o,c)=>c.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new oe(((r,i)=>{t.onerror=a=>{const o=_w(a.target.error);i(o)},t.onsuccess=a=>{const o=a.target.result;o?e(o.primaryKey,o.value).next((c=>{c?o.continue():r()})):r()}}))}H(e,t){const r=[];return new oe(((i,a)=>{e.onerror=o=>{a(o.target.error)},e.onsuccess=o=>{const c=o.target.result;if(!c)return void i();const u=new VF(c),d=t(c.primaryKey,c.value,u);if(d instanceof oe){const h=d.catch((p=>(u.done(),oe.reject(p))));r.push(h)}u.isDone?i():u.G===null?c.continue():c.continue(u.G)}})).next((()=>oe.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ql(n){return new oe(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=_w(r.target.error);t(i)}}))}let pI=!1;function _w(n){const e=el.M(or());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Ie("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return pI||(pI=!0,setTimeout((()=>{throw r}),0)),r}}return n}const yh="IndexBackfiller";class zF{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Se(yh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Se(yh,`Documents written: ${t}`)}catch(t){gl(t)?Se(yh,"Ignoring IndexedDB error during index backfill: ",t):await Vc(t)}await this.re(6e4)}))}}class LF{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,a=!0;return oe.doWhile((()=>a===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!r.has(o))return Se(yh,`Processing collection: ${o}`),this.oe(e,o,i).next((c=>{i-=c,r.add(o)}));a=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((a=>{const o=a.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(i,a))).next((c=>(Se(yh,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c)))).next((()=>o.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,a)=>{const o=TM(a);xw(o,r)>0&&(r=o)})),new wi(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class qi{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}qi.ce=-1;const dc=-1;function Tv(n){return n==null}function qh(n){return n===0&&1/n==-1/0}function BF(n){return typeof n=="number"&&Number.isInteger(n)&&!qh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const P0="";function Pr(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=gI(e)),e=UF(n.get(t),e);return gI(e)}function UF(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="";break;case P0:t+="";break;default:t+=a}}return t}function gI(n){return n+P0+""}function Fa(n){const e=n.length;if(Fe(e>=2,64408,{path:n}),e===2)return Fe(n.charAt(0)===P0&&n.charAt(1)==="",56145,{path:n}),zt.emptyPath();const t=e-2,r=[];let i="";for(let a=0;a<e;){const o=n.indexOf(P0,a);switch((o<0||o>t)&&Le(50515,{path:n}),n.charAt(o+1)){case"":const c=n.substring(a,o);let u;i.length===0?u=c:(i+=c,u=i,i=""),r.push(u);break;case"":i+=n.substring(a,o),i+="\0";break;case"":i+=n.substring(a,o+1);break;default:Le(61167,{path:n})}a=o+2}return new zt(r)}const Xl="remoteDocuments",Tp="owner",Cu="owner",Hh="mutationQueues",FF="userId",ua="mutations",mI="batchId",ac="userMutationsIndex",vI=["userId","batchId"];function a0(n,e){return[n,Pr(e)]}function RM(n,e,t){return[n,Pr(e),t]}const GF={},ud="documentMutations",O0="remoteDocumentsV14",qF=["prefixPath","collectionGroup","readTime","documentId"],s0="documentKeyIndex",HF=["prefixPath","collectionGroup","documentId"],DM="collectionGroupIndex",$F=["collectionGroup","readTime","prefixPath","documentId"],$h="remoteDocumentGlobal",Rx="remoteDocumentGlobalKey",dd="targets",kM="queryTargetsIndex",YF=["canonicalId","targetId"],fd="targetDocuments",KF=["targetId","path"],ww="documentTargetsIndex",XF=["path","targetId"],V0="targetGlobalKey",fc="targetGlobal",Yh="collectionParents",WF=["collectionId","parent"],hd="clientMetadata",QF="clientId",Av="bundles",ZF="bundleId",Cv="namedQueries",JF="name",Ew="indexConfiguration",e7="indexId",Dx="collectionGroupIndex",t7="collectionGroup",bh="indexState",n7=["indexId","uid"],NM="sequenceNumberIndex",r7=["uid","sequenceNumber"],xh="indexEntries",i7=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],MM="documentKeyIndex",a7=["indexId","uid","orderedDocumentKey"],Iv="documentOverlays",s7=["userId","collectionPath","documentId"],kx="collectionPathOverlayIndex",o7=["userId","collectionPath","largestBatchId"],PM="collectionGroupOverlayIndex",l7=["userId","collectionGroup","largestBatchId"],Sw="globals",c7="name",OM=[Hh,ua,ud,Xl,dd,Tp,fc,fd,hd,$h,Yh,Av,Cv],u7=[...OM,Iv],VM=[Hh,ua,ud,O0,dd,Tp,fc,fd,hd,$h,Yh,Av,Cv,Iv],jM=VM,Tw=[...jM,Ew,bh,xh],d7=Tw,zM=[...Tw,Sw],f7=zM;class Nx extends CM{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function lr(n,e){const t=ut(n);return el.O(t.le,e)}function yI(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ml(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function LM(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class un{constructor(e,t){this.comparator=e,this.root=t||Tr.EMPTY}insert(e,t){return new un(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Tr.BLACK,null,null))}remove(e){return new un(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Tr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Am(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Am(this.root,e,this.comparator,!1)}getReverseIterator(){return new Am(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Am(this.root,e,this.comparator,!0)}}class Am{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Tr{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=r??Tr.RED,this.left=i??Tr.EMPTY,this.right=a??Tr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new Tr(e??this.key,t??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):a===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Tr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Tr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Tr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Tr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Le(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Le(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Le(27949);return e+(this.isRed()?0:1)}}Tr.EMPTY=null,Tr.RED=!0,Tr.BLACK=!1;Tr.EMPTY=new class{constructor(){this.size=0}get key(){throw Le(57766)}get value(){throw Le(16141)}get color(){throw Le(16727)}get left(){throw Le(29726)}get right(){throw Le(36894)}copy(e,t,r,i,a){return this}insert(e,t,r){return new Tr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class qt{constructor(e){this.comparator=e,this.data=new un(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new bI(this.data.getIterator())}getIteratorFrom(e){return new bI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof qt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new qt(this.comparator);return t.data=e,t}}class bI{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Iu(n){return n.hasNext()?n.getNext():void 0}class ni{constructor(e){this.fields=e,e.sort(pn.comparator)}static empty(){return new ni([])}unionWith(e){let t=new qt(pn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new ni(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return cd(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class BM extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Xn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new BM("Invalid base64 string: "+a):a}})(e);return new Xn(t)}static fromUint8Array(e){const t=(function(i){let a="";for(let o=0;o<i.length;++o)a+=String.fromCharCode(i[o]);return a})(e);return new Xn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return lt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Xn.EMPTY_BYTE_STRING=new Xn("");const h7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bs(n){if(Fe(!!n,39018),typeof n=="string"){let e=0;const t=h7.exec(n);if(Fe(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ln(n.seconds),nanos:ln(n.nanos)}}function ln(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Us(n){return typeof n=="string"?Xn.fromBase64String(n):Xn.fromUint8Array(n)}const UM="server_timestamp",FM="__type__",GM="__previous_value__",qM="__local_write_time__";function Aw(n){return(n?.mapValue?.fields||{})[FM]?.stringValue===UM}function Rv(n){const e=n.mapValue.fields[GM];return Aw(e)?Rv(e):e}function Kh(n){const e=Bs(n.mapValue.fields[qM].timestampValue);return new et(e.seconds,e.nanos)}class p7{constructor(e,t,r,i,a,o,c,u,d,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=h}}const j0="(default)";class Ec{constructor(e,t){this.projectId=e,this.database=t||j0}static empty(){return new Ec("","")}get isDefaultDatabase(){return this.database===j0}isEqual(e){return e instanceof Ec&&e.projectId===this.projectId&&e.database===this.database}}const Cw="__type__",HM="__max__",$o={mapValue:{fields:{__type__:{stringValue:HM}}}},Iw="__vector__",pd="value",o0={nullValue:"NULL_VALUE"};function il(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Aw(n)?4:$M(n)?9007199254740991:Dv(n)?10:11:Le(28295,{value:n})}function es(n,e){if(n===e)return!0;const t=il(n);if(t!==il(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Kh(n).isEqual(Kh(e));case 3:return(function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const o=Bs(i.timestampValue),c=Bs(a.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,a){return Us(i.bytesValue).isEqual(Us(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,a){return ln(i.geoPointValue.latitude)===ln(a.geoPointValue.latitude)&&ln(i.geoPointValue.longitude)===ln(a.geoPointValue.longitude)})(n,e);case 2:return(function(i,a){if("integerValue"in i&&"integerValue"in a)return ln(i.integerValue)===ln(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const o=ln(i.doubleValue),c=ln(a.doubleValue);return o===c?qh(o)===qh(c):isNaN(o)&&isNaN(c)}return!1})(n,e);case 9:return cd(n.arrayValue.values||[],e.arrayValue.values||[],es);case 10:case 11:return(function(i,a){const o=i.mapValue.fields||{},c=a.mapValue.fields||{};if(yI(o)!==yI(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!es(o[u],c[u])))return!1;return!0})(n,e);default:return Le(52216,{left:n})}}function Xh(n,e){return(n.values||[]).find((t=>es(t,e)))!==void 0}function al(n,e){if(n===e)return 0;const t=il(n),r=il(e);if(t!==r)return lt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return lt(n.booleanValue,e.booleanValue);case 2:return(function(a,o){const c=ln(a.integerValue||a.doubleValue),u=ln(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1})(n,e);case 3:return xI(n.timestampValue,e.timestampValue);case 4:return xI(Kh(n),Kh(e));case 5:return Cx(n.stringValue,e.stringValue);case 6:return(function(a,o){const c=Us(a),u=Us(o);return c.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(a,o){const c=a.split("/"),u=o.split("/");for(let d=0;d<c.length&&d<u.length;d++){const h=lt(c[d],u[d]);if(h!==0)return h}return lt(c.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,o){const c=lt(ln(a.latitude),ln(o.latitude));return c!==0?c:lt(ln(a.longitude),ln(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return _I(n.arrayValue,e.arrayValue);case 10:return(function(a,o){const c=a.fields||{},u=o.fields||{},d=c[pd]?.arrayValue,h=u[pd]?.arrayValue,p=lt(d?.values?.length||0,h?.values?.length||0);return p!==0?p:_I(d,h)})(n.mapValue,e.mapValue);case 11:return(function(a,o){if(a===$o.mapValue&&o===$o.mapValue)return 0;if(a===$o.mapValue)return 1;if(o===$o.mapValue)return-1;const c=a.fields||{},u=Object.keys(c),d=o.fields||{},h=Object.keys(d);u.sort(),h.sort();for(let p=0;p<u.length&&p<h.length;++p){const m=Cx(u[p],h[p]);if(m!==0)return m;const b=al(c[u[p]],d[h[p]]);if(b!==0)return b}return lt(u.length,h.length)})(n.mapValue,e.mapValue);default:throw Le(23264,{he:t})}}function xI(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return lt(n,e);const t=Bs(n),r=Bs(e),i=lt(t.seconds,r.seconds);return i!==0?i:lt(t.nanos,r.nanos)}function _I(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const a=al(t[i],r[i]);if(a)return a}return lt(t.length,r.length)}function gd(n){return Mx(n)}function Mx(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=Bs(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Us(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return De.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const a of t.values||[])i?i=!1:r+=",",r+=Mx(a);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",a=!0;for(const o of r)a?a=!1:i+=",",i+=`${o}:${Mx(t.fields[o])}`;return i+"}"})(n.mapValue):Le(61005,{value:n})}function l0(n){switch(il(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Rv(n);return e?16+l0(e):16;case 5:return 2*n.stringValue.length;case 6:return Us(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,a)=>i+l0(a)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return ml(r.fields,((a,o)=>{i+=a.length+l0(o)})),i})(n.mapValue);default:throw Le(13486,{value:n})}}function Wh(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Px(n){return!!n&&"integerValue"in n}function Qh(n){return!!n&&"arrayValue"in n}function wI(n){return!!n&&"nullValue"in n}function EI(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function c0(n){return!!n&&"mapValue"in n}function Dv(n){return(n?.mapValue?.fields||{})[Cw]?.stringValue===Iw}function _h(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return ml(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=_h(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=_h(n.arrayValue.values[t]);return e}return{...n}}function $M(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===HM}const YM={mapValue:{fields:{[Cw]:{stringValue:Iw},[pd]:{arrayValue:{}}}}};function g7(n){return"nullValue"in n?o0:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Wh(Ec.empty(),De.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Dv(n)?YM:{mapValue:{}}:Le(35942,{value:n})}function m7(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Wh(Ec.empty(),De.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?YM:"mapValue"in n?Dv(n)?{mapValue:{}}:$o:Le(61959,{value:n})}function SI(n,e){const t=al(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function TI(n,e){const t=al(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class kr{constructor(e){this.value=e}static empty(){return new kr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!c0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=_h(t)}setAll(e){let t=pn.emptyPath(),r={},i=[];e.forEach(((o,c)=>{if(!t.isImmediateParentOf(c)){const u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=c.popLast()}o?r[c.lastSegment()]=_h(o):i.push(c.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());c0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return es(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];c0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ml(t,((i,a)=>e[i]=a));for(const i of r)delete e[i]}clone(){return new kr(_h(this.value))}}function KM(n){const e=[];return ml(n.fields,((t,r)=>{const i=new pn([t]);if(c0(r)){const a=KM(r.mapValue).fields;if(a.length===0)e.push(i);else for(const o of a)e.push(i.child(o))}else e.push(i)})),new ni(e)}class En{constructor(e,t,r,i,a,o,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=a,this.data=o,this.documentState=c}static newInvalidDocument(e){return new En(e,0,Ye.min(),Ye.min(),Ye.min(),kr.empty(),0)}static newFoundDocument(e,t,r,i){return new En(e,1,t,Ye.min(),r,i,0)}static newNoDocument(e,t){return new En(e,2,t,Ye.min(),Ye.min(),kr.empty(),0)}static newUnknownDocument(e,t){return new En(e,3,t,Ye.min(),Ye.min(),kr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ye.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=kr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=kr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ye.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof En&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new En(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class md{constructor(e,t){this.position=e,this.inclusive=t}}function AI(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],o=n.position[i];if(a.field.isKeyField()?r=De.comparator(De.fromName(o.referenceValue),t.key):r=al(o,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function CI(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!es(n.position[t],e.position[t]))return!1;return!0}class Zh{constructor(e,t="asc"){this.field=e,this.dir=t}}function v7(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class XM{}class It extends XM{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new y7(e,t,r):t==="array-contains"?new _7(e,r):t==="in"?new tP(e,r):t==="not-in"?new w7(e,r):t==="array-contains-any"?new E7(e,r):new It(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new b7(e,r):new x7(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(al(t,this.value)):t!==null&&il(this.value)===il(t)&&this.matchesComparison(al(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Le(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Gt extends XM{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Gt(e,t)}matches(e){return vd(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function vd(n){return n.op==="and"}function Ox(n){return n.op==="or"}function Rw(n){return WM(n)&&vd(n)}function WM(n){for(const e of n.filters)if(e instanceof Gt)return!1;return!0}function Vx(n){if(n instanceof It)return n.field.canonicalString()+n.op.toString()+gd(n.value);if(Rw(n))return n.filters.map((e=>Vx(e))).join(",");{const e=n.filters.map((t=>Vx(t))).join(",");return`${n.op}(${e})`}}function QM(n,e){return n instanceof It?(function(r,i){return i instanceof It&&r.op===i.op&&r.field.isEqual(i.field)&&es(r.value,i.value)})(n,e):n instanceof Gt?(function(r,i){return i instanceof Gt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((a,o,c)=>a&&QM(o,i.filters[c])),!0):!1})(n,e):void Le(19439)}function ZM(n,e){const t=n.filters.concat(e);return Gt.create(t,n.op)}function JM(n){return n instanceof It?(function(t){return`${t.field.canonicalString()} ${t.op} ${gd(t.value)}`})(n):n instanceof Gt?(function(t){return t.op.toString()+" {"+t.getFilters().map(JM).join(" ,")+"}"})(n):"Filter"}class y7 extends It{constructor(e,t,r){super(e,t,r),this.key=De.fromName(r.referenceValue)}matches(e){const t=De.comparator(e.key,this.key);return this.matchesComparison(t)}}class b7 extends It{constructor(e,t){super(e,"in",t),this.keys=eP("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class x7 extends It{constructor(e,t){super(e,"not-in",t),this.keys=eP("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function eP(n,e){return(e.arrayValue?.values||[]).map((t=>De.fromName(t.referenceValue)))}class _7 extends It{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Qh(t)&&Xh(t.arrayValue,this.value)}}class tP extends It{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Xh(this.value.arrayValue,t)}}class w7 extends It{constructor(e,t){super(e,"not-in",t)}matches(e){if(Xh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Xh(this.value.arrayValue,t)}}class E7 extends It{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Qh(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Xh(this.value.arrayValue,r)))}}class S7{constructor(e,t=null,r=[],i=[],a=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=c,this.Te=null}}function jx(n,e=null,t=[],r=[],i=null,a=null,o=null){return new S7(n,e,t,r,i,a,o)}function Sc(n){const e=ut(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Vx(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(a){return a.field.canonicalString()+a.dir})(r))).join(","),Tv(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>gd(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>gd(r))).join(",")),e.Te=t}return e.Te}function Ap(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!v7(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!QM(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!CI(n.startAt,e.startAt)&&CI(n.endAt,e.endAt)}function z0(n){return De.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function L0(n,e){return n.filters.filter((t=>t instanceof It&&t.field.isEqual(e)))}function II(n,e,t){let r=o0,i=!0;for(const a of L0(n,e)){let o=o0,c=!0;switch(a.op){case"<":case"<=":o=g7(a.value);break;case"==":case"in":case">=":o=a.value;break;case">":o=a.value,c=!1;break;case"!=":case"not-in":o=o0}SI({value:r,inclusive:i},{value:o,inclusive:c})<0&&(r=o,i=c)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const o=t.position[a];SI({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function RI(n,e,t){let r=$o,i=!0;for(const a of L0(n,e)){let o=$o,c=!0;switch(a.op){case">=":case">":o=m7(a.value),c=!1;break;case"==":case"in":case"<=":o=a.value;break;case"<":o=a.value,c=!1;break;case"!=":case"not-in":o=$o}TI({value:r,inclusive:i},{value:o,inclusive:c})>0&&(r=o,i=c)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const o=t.position[a];TI({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}class jd{constructor(e,t=null,r=[],i=[],a=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function T7(n,e,t,r,i,a,o,c){return new jd(n,e,t,r,i,a,o,c)}function Cp(n){return new jd(n)}function DI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function nP(n){return n.collectionGroup!==null}function wh(n){const e=ut(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new qt(pn.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((d=>{d.isInequality()&&(c=c.add(d.field))}))})),c})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new Zh(a,r))})),t.has(pn.keyField().canonicalString())||e.Ie.push(new Zh(pn.keyField(),r))}return e.Ie}function $i(n){const e=ut(n);return e.Ee||(e.Ee=A7(e,wh(n))),e.Ee}function A7(n,e){if(n.limitType==="F")return jx(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const a=i.dir==="desc"?"asc":"desc";return new Zh(i.field,a)}));const t=n.endAt?new md(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new md(n.startAt.position,n.startAt.inclusive):null;return jx(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function zx(n,e){const t=n.filters.concat([e]);return new jd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function B0(n,e,t){return new jd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function kv(n,e){return Ap($i(n),$i(e))&&n.limitType===e.limitType}function rP(n){return`${Sc($i(n))}|lt:${n.limitType}`}function Ou(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>JM(i))).join(", ")}]`),Tv(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>gd(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>gd(i))).join(",")),`Target(${r})`})($i(n))}; limitType=${n.limitType})`}function Ip(n,e){return e.isFoundDocument()&&(function(r,i){const a=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):De.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)})(n,e)&&(function(r,i){for(const a of wh(r))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const a of r.filters)if(!a.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,c,u){const d=AI(o,c,u);return o.inclusive?d<=0:d<0})(r.startAt,wh(r),i)||r.endAt&&!(function(o,c,u){const d=AI(o,c,u);return o.inclusive?d>=0:d>0})(r.endAt,wh(r),i))})(n,e)}function C7(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function iP(n){return(e,t)=>{let r=!1;for(const i of wh(n)){const a=I7(i,e,t);if(a!==0)return a;r=r||i.field.isKeyField()}return 0}}function I7(n,e,t){const r=n.field.isKeyField()?De.comparator(e.key,t.key):(function(a,o,c){const u=o.data.field(a),d=c.data.field(a);return u!==null&&d!==null?al(u,d):Le(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Le(19790,{direction:n.dir})}}class Xs{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,a]of r)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ml(this.inner,((t,r)=>{for(const[i,a]of r)e(i,a)}))}isEmpty(){return LM(this.inner)}size(){return this.innerSize}}const R7=new un(De.comparator);function bi(){return R7}const aP=new un(De.comparator);function oh(...n){let e=aP;for(const t of n)e=e.insert(t.key,t);return e}function sP(n){let e=aP;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Ga(){return Eh()}function oP(){return Eh()}function Eh(){return new Xs((n=>n.toString()),((n,e)=>n.isEqual(e)))}const D7=new un(De.comparator),k7=new qt(De.comparator);function _t(...n){let e=k7;for(const t of n)e=e.add(t);return e}const N7=new qt(lt);function M7(){return N7}function Dw(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qh(e)?"-0":e}}function lP(n){return{integerValue:""+n}}function P7(n,e){return BF(e)?lP(e):Dw(n,e)}class Nv{constructor(){this._=void 0}}function O7(n,e,t){return n instanceof Jh?(function(i,a){const o={fields:{[FM]:{stringValue:UM},[qM]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Aw(a)&&(a=Rv(a)),a&&(o.fields[GM]=a),{mapValue:o}})(t,e):n instanceof Tc?uP(n,e):n instanceof yd?dP(n,e):(function(i,a){const o=cP(i,a),c=kI(o)+kI(i.Ae);return Px(o)&&Px(i.Ae)?lP(c):Dw(i.serializer,c)})(n,e)}function V7(n,e,t){return n instanceof Tc?uP(n,e):n instanceof yd?dP(n,e):t}function cP(n,e){return n instanceof ep?(function(r){return Px(r)||(function(a){return!!a&&"doubleValue"in a})(r)})(e)?e:{integerValue:0}:null}class Jh extends Nv{}class Tc extends Nv{constructor(e){super(),this.elements=e}}function uP(n,e){const t=fP(e);for(const r of n.elements)t.some((i=>es(i,r)))||t.push(r);return{arrayValue:{values:t}}}class yd extends Nv{constructor(e){super(),this.elements=e}}function dP(n,e){let t=fP(e);for(const r of n.elements)t=t.filter((i=>!es(i,r)));return{arrayValue:{values:t}}}class ep extends Nv{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function kI(n){return ln(n.integerValue||n.doubleValue)}function fP(n){return Qh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class hP{constructor(e,t){this.field=e,this.transform=t}}function j7(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Tc&&i instanceof Tc||r instanceof yd&&i instanceof yd?cd(r.elements,i.elements,es):r instanceof ep&&i instanceof ep?es(r.Ae,i.Ae):r instanceof Jh&&i instanceof Jh})(n.transform,e.transform)}class z7{constructor(e,t){this.version=e,this.transformResults=t}}class sr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new sr}static exists(e){return new sr(void 0,e)}static updateTime(e){return new sr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function u0(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Mv{}function pP(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Rp(n.key,sr.none()):new zd(n.key,n.data,sr.none());{const t=n.data,r=kr.empty();let i=new qt(pn.comparator);for(let a of e.fields)if(!i.has(a)){let o=t.field(a);o===null&&a.length>1&&(a=a.popLast(),o=t.field(a)),o===null?r.delete(a):r.set(a,o),i=i.add(a)}return new Ws(n.key,r,new ni(i.toArray()),sr.none())}}function L7(n,e,t){n instanceof zd?(function(i,a,o){const c=i.value.clone(),u=MI(i.fieldTransforms,a,o.transformResults);c.setAll(u),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):n instanceof Ws?(function(i,a,o){if(!u0(i.precondition,a))return void a.convertToUnknownDocument(o.version);const c=MI(i.fieldTransforms,a,o.transformResults),u=a.data;u.setAll(gP(i)),u.setAll(c),a.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(i,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Sh(n,e,t,r){return n instanceof zd?(function(a,o,c,u){if(!u0(a.precondition,o))return c;const d=a.value.clone(),h=PI(a.fieldTransforms,u,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof Ws?(function(a,o,c,u){if(!u0(a.precondition,o))return c;const d=PI(a.fieldTransforms,u,o),h=o.data;return h.setAll(gP(a)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((p=>p.field)))})(n,e,t,r):(function(a,o,c){return u0(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(n,e,t)}function B7(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=cP(r.transform,i||null);a!=null&&(t===null&&(t=kr.empty()),t.set(r.field,a))}return t||null}function NI(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&cd(r,i,((a,o)=>j7(a,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class zd extends Mv{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ws extends Mv{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function gP(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function MI(n,e,t){const r=new Map;Fe(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const a=n[i],o=a.transform,c=e.data.field(a.field);r.set(a.field,V7(o,c,t[i]))}return r}function PI(n,e,t){const r=new Map;for(const i of n){const a=i.transform,o=t.data.field(i.field);r.set(i.field,O7(a,o,e))}return r}class Rp extends Mv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class mP extends Mv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class kw{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&L7(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Sh(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Sh(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=oP();return this.mutations.forEach((i=>{const a=e.get(i.key),o=a.overlayedDocument;let c=this.applyToLocalView(o,a.mutatedFields);c=t.has(i.key)?null:c;const u=pP(o,c);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Ye.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),_t())}isEqual(e){return this.batchId===e.batchId&&cd(this.mutations,e.mutations,((t,r)=>NI(t,r)))&&cd(this.baseMutations,e.baseMutations,((t,r)=>NI(t,r)))}}class Nw{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Fe(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return D7})();const a=e.mutations;for(let o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new Nw(e,t,r,i)}}class Mw{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class U7{constructor(e,t){this.count=e,this.unchangedNames=t}}var Hn,kt;function F7(n){switch(n){case ge.OK:return Le(64938);case ge.CANCELLED:case ge.UNKNOWN:case ge.DEADLINE_EXCEEDED:case ge.RESOURCE_EXHAUSTED:case ge.INTERNAL:case ge.UNAVAILABLE:case ge.UNAUTHENTICATED:return!1;case ge.INVALID_ARGUMENT:case ge.NOT_FOUND:case ge.ALREADY_EXISTS:case ge.PERMISSION_DENIED:case ge.FAILED_PRECONDITION:case ge.ABORTED:case ge.OUT_OF_RANGE:case ge.UNIMPLEMENTED:case ge.DATA_LOSS:return!0;default:return Le(15467,{code:n})}}function vP(n){if(n===void 0)return Fr("GRPC error has no .code"),ge.UNKNOWN;switch(n){case Hn.OK:return ge.OK;case Hn.CANCELLED:return ge.CANCELLED;case Hn.UNKNOWN:return ge.UNKNOWN;case Hn.DEADLINE_EXCEEDED:return ge.DEADLINE_EXCEEDED;case Hn.RESOURCE_EXHAUSTED:return ge.RESOURCE_EXHAUSTED;case Hn.INTERNAL:return ge.INTERNAL;case Hn.UNAVAILABLE:return ge.UNAVAILABLE;case Hn.UNAUTHENTICATED:return ge.UNAUTHENTICATED;case Hn.INVALID_ARGUMENT:return ge.INVALID_ARGUMENT;case Hn.NOT_FOUND:return ge.NOT_FOUND;case Hn.ALREADY_EXISTS:return ge.ALREADY_EXISTS;case Hn.PERMISSION_DENIED:return ge.PERMISSION_DENIED;case Hn.FAILED_PRECONDITION:return ge.FAILED_PRECONDITION;case Hn.ABORTED:return ge.ABORTED;case Hn.OUT_OF_RANGE:return ge.OUT_OF_RANGE;case Hn.UNIMPLEMENTED:return ge.UNIMPLEMENTED;case Hn.DATA_LOSS:return ge.DATA_LOSS;default:return Le(39323,{code:n})}}(kt=Hn||(Hn={}))[kt.OK=0]="OK",kt[kt.CANCELLED=1]="CANCELLED",kt[kt.UNKNOWN=2]="UNKNOWN",kt[kt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",kt[kt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",kt[kt.NOT_FOUND=5]="NOT_FOUND",kt[kt.ALREADY_EXISTS=6]="ALREADY_EXISTS",kt[kt.PERMISSION_DENIED=7]="PERMISSION_DENIED",kt[kt.UNAUTHENTICATED=16]="UNAUTHENTICATED",kt[kt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",kt[kt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",kt[kt.ABORTED=10]="ABORTED",kt[kt.OUT_OF_RANGE=11]="OUT_OF_RANGE",kt[kt.UNIMPLEMENTED=12]="UNIMPLEMENTED",kt[kt.INTERNAL=13]="INTERNAL",kt[kt.UNAVAILABLE=14]="UNAVAILABLE",kt[kt.DATA_LOSS=15]="DATA_LOSS";function G7(){return new TextEncoder}const q7=new Jo([4294967295,4294967295],0);function OI(n){const e=G7().encode(n),t=new pM;return t.update(e),new Uint8Array(t.digest())}function VI(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Jo([t,r],0),new Jo([i,a],0)]}class Pw{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new lh(`Invalid padding: ${t}`);if(r<0)throw new lh(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new lh(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new lh(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Jo.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(Jo.fromNumber(r)));return i.compare(q7)===1&&(i=new Jo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=OI(e),[r,i]=VI(t);for(let a=0;a<this.hashCount;a++){const o=this.ye(r,i,a);if(!this.we(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new Pw(a,i,t);return r.forEach((c=>o.insert(c))),o}insert(e){if(this.ge===0)return;const t=OI(e),[r,i]=VI(t);for(let a=0;a<this.hashCount;a++){const o=this.ye(r,i,a);this.Se(o)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class lh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Pv{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Dp.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Pv(Ye.min(),i,new un(lt),bi(),_t())}}class Dp{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Dp(r,t,_t(),_t(),_t())}}class d0{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class yP{constructor(e,t){this.targetId=e,this.Ce=t}}class bP{constructor(e,t,r=Xn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class jI{constructor(){this.ve=0,this.Fe=zI(),this.Me=Xn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=_t(),t=_t(),r=_t();return this.Fe.forEach(((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Le(38017,{changeType:a})}})),new Dp(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=zI()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Fe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class H7{constructor(e){this.Ge=e,this.ze=new Map,this.je=bi(),this.Je=Cm(),this.He=Cm(),this.Ye=new un(lt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Le(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const a=i.target;if(z0(a))if(r===0){const o=new De(a.path);this.et(t,o,En.newNoDocument(o,Ye.min()))}else Fe(r===1,20013,{expectedCount:r});else{const o=this._t(t);if(o!==r){const c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(t);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,d)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:a=0}=t;let o,c;try{o=Us(r).toUint8Array()}catch(u){if(u instanceof BM)return wc("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Pw(o,i,a)}catch(u){return wc(u instanceof lh?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((a=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.et(t,a,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((a,o)=>{const c=this.ot(o);if(c){if(a.current&&z0(c.target)){const u=new De(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,En.newNoDocument(u,e))}a.Be&&(t.set(o,a.ke()),a.qe())}}));let r=_t();this.He.forEach(((a,o)=>{let c=!0;o.forEachWhile((u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(a))})),this.je.forEach(((a,o)=>o.setReadTime(e)));const i=new Pv(e,t,this.Ye,this.je,r);return this.je=bi(),this.Je=Cm(),this.He=Cm(),this.Ye=new un(lt),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new jI,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new qt(lt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new qt(lt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Se("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new jI),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Cm(){return new un(De.comparator)}function zI(){return new un(De.comparator)}const $7={asc:"ASCENDING",desc:"DESCENDING"},Y7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},K7={and:"AND",or:"OR"};class X7{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Lx(n,e){return n.useProto3Json||Tv(e)?e:{value:e}}function bd(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function xP(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function W7(n,e){return bd(n,e.toTimestamp())}function Hr(n){return Fe(!!n,49232),Ye.fromTimestamp((function(t){const r=Bs(t);return new et(r.seconds,r.nanos)})(n))}function Ow(n,e){return Bx(n,e).canonicalString()}function Bx(n,e){const t=(function(i){return new zt(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function _P(n){const e=zt.fromString(n);return Fe(DP(e),10190,{key:e.toString()}),e}function U0(n,e){return Ow(n.databaseId,e.path)}function hc(n,e){const t=_P(e);if(t.get(1)!==n.databaseId.projectId)throw new Ie(ge.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ie(ge.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new De(SP(t))}function wP(n,e){return Ow(n.databaseId,e)}function EP(n){const e=_P(n);return e.length===4?zt.emptyPath():SP(e)}function Ux(n){return new zt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function SP(n){return Fe(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function LI(n,e,t){return{name:U0(n,e),fields:t.value.mapValue.fields}}function Q7(n,e,t){const r=hc(n,e.name),i=Hr(e.updateTime),a=e.createTime?Hr(e.createTime):Ye.min(),o=new kr({mapValue:{fields:e.fields}}),c=En.newFoundDocument(r,i,a,o);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function Z7(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Le(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=(function(d,h){return d.useProto3Json?(Fe(h===void 0||typeof h=="string",58123),Xn.fromBase64String(h||"")):(Fe(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Xn.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(d){const h=d.code===void 0?ge.UNKNOWN:vP(d.code);return new Ie(h,d.message||"")})(o);t=new bP(r,i,a,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=hc(n,r.document.name),a=Hr(r.document.updateTime),o=r.document.createTime?Hr(r.document.createTime):Ye.min(),c=new kr({mapValue:{fields:r.document.fields}}),u=En.newFoundDocument(i,a,o,c),d=r.targetIds||[],h=r.removedTargetIds||[];t=new d0(d,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=hc(n,r.document),a=r.readTime?Hr(r.readTime):Ye.min(),o=En.newNoDocument(i,a),c=r.removedTargetIds||[];t=new d0([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=hc(n,r.document),a=r.removedTargetIds||[];t=new d0([],a,i,null)}else{if(!("filter"in e))return Le(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:a}=r,o=new U7(i,a),c=r.targetId;t=new yP(c,o)}}return t}function F0(n,e){let t;if(e instanceof zd)t={update:LI(n,e.key,e.value)};else if(e instanceof Rp)t={delete:U0(n,e.key)};else if(e instanceof Ws)t={update:LI(n,e.key,e.data),updateMask:iG(e.fieldMask)};else{if(!(e instanceof mP))return Le(16599,{Vt:e.type});t={verify:U0(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(a,o){const c=o.transform;if(c instanceof Jh)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Tc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof yd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof ep)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw Le(20930,{transform:o.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,a){return a.updateTime!==void 0?{updateTime:W7(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Le(27497)})(n,e.precondition)),t}function Fx(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?sr.updateTime(Hr(a.updateTime)):a.exists!==void 0?sr.exists(a.exists):sr.none()})(e.currentDocument):sr.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(o,c){let u=null;if("setToServerValue"in c)Fe(c.setToServerValue==="REQUEST_TIME",16630,{proto:c}),u=new Jh;else if("appendMissingElements"in c){const h=c.appendMissingElements.values||[];u=new Tc(h)}else if("removeAllFromArray"in c){const h=c.removeAllFromArray.values||[];u=new yd(h)}else"increment"in c?u=new ep(o,c.increment):Le(16584,{proto:c});const d=pn.fromServerFormat(c.fieldPath);return new hP(d,u)})(n,i))):[];if(e.update){e.update.name;const i=hc(n,e.update.name),a=new kr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const d=u.fieldPaths||[];return new ni(d.map((h=>pn.fromServerFormat(h))))})(e.updateMask);return new Ws(i,a,o,t,r)}return new zd(i,a,t,r)}if(e.delete){const i=hc(n,e.delete);return new Rp(i,t)}if(e.verify){const i=hc(n,e.verify);return new mP(i,t)}return Le(1463,{proto:e})}function J7(n,e){return n&&n.length>0?(Fe(e!==void 0,14353),n.map((t=>(function(i,a){let o=i.updateTime?Hr(i.updateTime):Hr(a);return o.isEqual(Ye.min())&&(o=Hr(a)),new z7(o,i.transformResults||[])})(t,e)))):[]}function TP(n,e){return{documents:[wP(n,e.path)]}}function AP(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=wP(n,i);const a=(function(d){if(d.length!==0)return RP(Gt.create(d,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const o=(function(d){if(d.length!==0)return d.map((h=>(function(m){return{field:Vu(m.field),direction:tG(m.dir)}})(h)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const c=Lx(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:i}}function CP(n){let e=EP(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Fe(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let a=[];t.where&&(a=(function(p){const m=IP(p);return m instanceof Gt&&Rw(m)?m.getFilters():[m]})(t.where));let o=[];t.orderBy&&(o=(function(p){return p.map((m=>(function(_){return new Zh(ju(_.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(_.direction))})(m)))})(t.orderBy));let c=null;t.limit&&(c=(function(p){let m;return m=typeof p=="object"?p.value:p,Tv(m)?null:m})(t.limit));let u=null;t.startAt&&(u=(function(p){const m=!!p.before,b=p.values||[];return new md(b,m)})(t.startAt));let d=null;return t.endAt&&(d=(function(p){const m=!p.before,b=p.values||[];return new md(b,m)})(t.endAt)),T7(e,i,o,a,c,"F",u,d)}function eG(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function IP(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=ju(t.unaryFilter.field);return It.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=ju(t.unaryFilter.field);return It.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=ju(t.unaryFilter.field);return It.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ju(t.unaryFilter.field);return It.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Le(61313);default:return Le(60726)}})(n):n.fieldFilter!==void 0?(function(t){return It.create(ju(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Le(58110);default:return Le(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Gt.create(t.compositeFilter.filters.map((r=>IP(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Le(1026)}})(t.compositeFilter.op))})(n):Le(30097,{filter:n})}function tG(n){return $7[n]}function nG(n){return Y7[n]}function rG(n){return K7[n]}function Vu(n){return{fieldPath:n.canonicalString()}}function ju(n){return pn.fromServerFormat(n.fieldPath)}function RP(n){return n instanceof It?(function(t){if(t.op==="=="){if(EI(t.value))return{unaryFilter:{field:Vu(t.field),op:"IS_NAN"}};if(wI(t.value))return{unaryFilter:{field:Vu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(EI(t.value))return{unaryFilter:{field:Vu(t.field),op:"IS_NOT_NAN"}};if(wI(t.value))return{unaryFilter:{field:Vu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vu(t.field),op:nG(t.op),value:t.value}}})(n):n instanceof Gt?(function(t){const r=t.getFilters().map((i=>RP(i)));return r.length===1?r[0]:{compositeFilter:{op:rG(t.op),filters:r}}})(n):Le(54877,{filter:n})}function iG(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function DP(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Ds{constructor(e,t,r,i,a=Ye.min(),o=Ye.min(),c=Xn.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Ds(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class kP{constructor(e){this.yt=e}}function aG(n,e){let t;if(e.document)t=Q7(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=De.fromSegments(e.noDocument.path),i=Cc(e.noDocument.readTime);t=En.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Le(56709);{const r=De.fromSegments(e.unknownDocument.path),i=Cc(e.unknownDocument.version);t=En.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const a=new et(i[0],i[1]);return Ye.fromTimestamp(a)})(e.readTime)),t}function BI(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:G0(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(a,o){return{name:U0(a,o.key),fields:o.data.value.mapValue.fields,updateTime:bd(a,o.version.toTimestamp()),createTime:bd(a,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Ac(e.version)};else{if(!e.isUnknownDocument())return Le(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Ac(e.version)}}return r}function G0(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ac(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Cc(n){const e=new et(n.seconds,n.nanoseconds);return Ye.fromTimestamp(e)}function Zl(n,e){const t=(e.baseMutations||[]).map((a=>Fx(n.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const o=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const c=e.mutations[a+1];o.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const r=e.mutations.map((a=>Fx(n.yt,a))),i=et.fromMillis(e.localWriteTimeMs);return new kw(e.batchId,i,t,r)}function ch(n){const e=Cc(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Cc(n.lastLimboFreeSnapshotVersion):Ye.min();let r;return r=(function(a){return a.documents!==void 0})(n.query)?(function(a){const o=a.documents.length;return Fe(o===1,1966,{count:o}),$i(Cp(EP(a.documents[0])))})(n.query):(function(a){return $i(CP(a))})(n.query),new Ds(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Xn.fromBase64String(n.resumeToken))}function NP(n,e){const t=Ac(e.snapshotVersion),r=Ac(e.lastLimboFreeSnapshotVersion);let i;i=z0(e.target)?TP(n.yt,e.target):AP(n.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Sc(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function MP(n){const e=CP({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?B0(e,e.limit,"L"):e}function S1(n,e){return new Mw(e.largestBatchId,Fx(n.yt,e.overlayMutation))}function UI(n,e){const t=e.path.lastSegment();return[n,Pr(e.path.popLast()),t]}function FI(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ac(r.readTime),documentKey:Pr(r.documentKey.path),largestBatchId:r.largestBatchId}}class sG{getBundleMetadata(e,t){return GI(e).get(t).next((r=>{if(r)return(function(a){return{id:a.bundleId,createTime:Cc(a.createTime),version:a.version}})(r)}))}saveBundleMetadata(e,t){return GI(e).put((function(i){return{bundleId:i.id,createTime:Ac(Hr(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return qI(e).get(t).next((r=>{if(r)return(function(a){return{name:a.name,query:MP(a.bundledQuery),readTime:Cc(a.readTime)}})(r)}))}saveNamedQuery(e,t){return qI(e).put((function(i){return{name:i.name,readTime:Ac(Hr(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function GI(n){return lr(n,Av)}function qI(n){return lr(n,Cv)}class Ov{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new Ov(e,r)}getOverlay(e,t){return Qf(e).get(UI(this.userId,t)).next((r=>r?S1(this.serializer,r):null))}getOverlays(e,t){const r=Ga();return oe.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((a,o)=>{const c=new Mw(t,o);i.push(this.St(e,c))})),oe.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((o=>i.add(Pr(o.getCollectionPath()))));const a=[];return i.forEach((o=>{const c=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);a.push(Qf(e).Z(kx,c))})),oe.waitFor(a)}getOverlaysForCollection(e,t,r){const i=Ga(),a=Pr(t),o=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Qf(e).J(kx,o).next((c=>{for(const u of c){const d=S1(this.serializer,u);i.set(d.getKey(),d)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const a=Ga();let o;const c=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Qf(e).ee({index:PM,range:c},((u,d,h)=>{const p=S1(this.serializer,d);a.size()<i||p.largestBatchId===o?(a.set(p.getKey(),p),o=p.largestBatchId):h.done()})).next((()=>a))}St(e,t){return Qf(e).put((function(i,a,o){const[c,u,d]=UI(a,o.mutation.key);return{userId:a,collectionPath:u,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:F0(i.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Qf(n){return lr(n,Iv)}class oG{bt(e){return lr(e,Sw)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?Xn.fromUint8Array(r):Xn.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Jl{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(ln(e.integerValue));else if("doubleValue"in e){const r=ln(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),qh(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=Bs(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Us(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?$M(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Dv(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Le(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const i=pd,a=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(ln(a)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),De.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Jl.Kt=new Jl;const Ru=255;function lG(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function HI(n){const e=64-(function(r){let i=0;for(let a=0;a<8;++a){const o=lG(255&r[a]);if(i+=o,o!==8)break}return i})(n);return Math.ceil(e/8)}class cG{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=HI(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=HI(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(Ru),this.sn(255)}_n(){this.an(Ru),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(a){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,a,!1),new Uint8Array(o.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Ru?(this.sn(Ru),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Ru?(this.an(Ru),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class uG{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class dG{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Zf{constructor(){this.cn=new cG,this.ln=new uG(this.cn),this.hn=new dG(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class ec{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new ec(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:f0(this.En),directionalValue:f0(this.dn),orderedDocumentKey:f0(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Mo(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=$I(n.En,e.En),t!==0?t:(t=$I(n.dn,e.dn),t!==0?t:De.comparator(n.In,e.In)))}function $I(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function f0(n){return SN()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function YI(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class KI{constructor(e){this.mn=new qt(((t,r)=>pn.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Fe(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Ix(e);if(t!==void 0&&!this.wn(t))return!1;const r=Kl(e);let i=new Set,a=0,o=0;for(;a<r.length&&this.wn(r[a]);++a)i=i.add(r[a].fieldPath.canonicalString());if(a===r.length)return!0;if(this.mn.size>0){const c=this.mn.getIterator().getNext();if(!i.has(c.field.canonicalString())){const u=r[a];if(!this.Sn(c,u)||!this.bn(this.fn[o++],u))return!1}++a}for(;a<r.length;++a){const c=r[a];if(o>=this.fn.length||!this.bn(this.fn[o++],c))return!1}return!0}Dn(){if(this.pn)return null;let e=new qt(pn.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new i0(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new i0(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new i0(r.field,r.dir==="asc"?0:1)));return new M0(M0.UNKNOWN_ID,this.collectionId,t,Gh.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function PP(n){if(Fe(n instanceof It||n instanceof Gt,20012),n instanceof It){if(n instanceof tP){const t=n.value.arrayValue?.values?.map((r=>It.create(n.field,"==",r)))||[];return Gt.create(t,"or")}return n}const e=n.filters.map((t=>PP(t)));return Gt.create(e,n.op)}function fG(n){if(n.getFilters().length===0)return[];const e=Hx(PP(n));return Fe(OP(e),7391),Gx(e)||qx(e)?[e]:e.getFilters()}function Gx(n){return n instanceof It}function qx(n){return n instanceof Gt&&Rw(n)}function OP(n){return Gx(n)||qx(n)||(function(t){if(t instanceof Gt&&Ox(t)){for(const r of t.getFilters())if(!Gx(r)&&!qx(r))return!1;return!0}return!1})(n)}function Hx(n){if(Fe(n instanceof It||n instanceof Gt,34018),n instanceof It)return n;if(n.filters.length===1)return Hx(n.filters[0]);const e=n.filters.map((r=>Hx(r)));let t=Gt.create(e,n.op);return t=q0(t),OP(t)?t:(Fe(t instanceof Gt,64498),Fe(vd(t),40251),Fe(t.filters.length>1,57927),t.filters.reduce(((r,i)=>Vw(r,i))))}function Vw(n,e){let t;return Fe(n instanceof It||n instanceof Gt,38388),Fe(e instanceof It||e instanceof Gt,25473),t=n instanceof It?e instanceof It?(function(i,a){return Gt.create([i,a],"and")})(n,e):XI(n,e):e instanceof It?XI(e,n):(function(i,a){if(Fe(i.filters.length>0&&a.filters.length>0,48005),vd(i)&&vd(a))return ZM(i,a.getFilters());const o=Ox(i)?i:a,c=Ox(i)?a:i,u=o.filters.map((d=>Vw(d,c)));return Gt.create(u,"or")})(n,e),q0(t)}function XI(n,e){if(vd(e))return ZM(e,n.getFilters());{const t=e.filters.map((r=>Vw(n,r)));return Gt.create(t,"or")}}function q0(n){if(Fe(n instanceof It||n instanceof Gt,11850),n instanceof It)return n;const e=n.getFilters();if(e.length===1)return q0(e[0]);if(WM(n))return n;const t=e.map((i=>q0(i))),r=[];return t.forEach((i=>{i instanceof It?r.push(i):i instanceof Gt&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:Gt.create(r,n.op)}class hG{constructor(){this.Cn=new jw}addToCollectionParentIndex(e,t){return this.Cn.add(t),oe.resolve()}getCollectionParents(e,t){return oe.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return oe.resolve()}deleteFieldIndex(e,t){return oe.resolve()}deleteAllFieldIndexes(e){return oe.resolve()}createTargetIndexes(e,t){return oe.resolve()}getDocumentsMatchingTarget(e,t){return oe.resolve(null)}getIndexType(e,t){return oe.resolve(0)}getFieldIndexes(e,t){return oe.resolve([])}getNextCollectionGroupToUpdate(e){return oe.resolve(null)}getMinOffset(e,t){return oe.resolve(wi.min())}getMinOffsetFromCollectionGroup(e,t){return oe.resolve(wi.min())}updateCollectionGroup(e,t,r){return oe.resolve()}updateIndexEntries(e,t){return oe.resolve()}}class jw{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new qt(zt.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new qt(zt.comparator)).toArray()}}const WI="IndexedDbIndexManager",Im=new Uint8Array(0);class pG{constructor(e,t){this.databaseId=t,this.vn=new jw,this.Fn=new Xs((r=>Sc(r)),((r,i)=>Ap(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const a={collectionId:r,parent:Pr(i)};return QI(e).put(a)}return oe.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[wM(t),""],!1,!0);return QI(e).J(i).next((a=>{for(const o of a){if(o.collectionId!==t)break;r.push(Fa(o.parent))}return r}))}addFieldIndex(e,t){const r=Jf(e),i=(function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete i.indexId;const a=r.add(i);if(t.indexState){const o=ku(e);return a.next((c=>{o.put(FI(c,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const r=Jf(e),i=ku(e),a=Du(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Jf(e),r=Du(e),i=ku(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return oe.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const a=new KI(r).Dn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const r=Du(e);let i=!0;const a=new Map;return oe.forEach(this.Mn(t),(o=>this.xn(e,o).next((c=>{i&&(i=!!c),a.set(o,c)})))).next((()=>{if(i){let o=_t();const c=[];return oe.forEach(a,((u,d)=>{Se(WI,`Using index ${(function(R){return`id=${R.indexId}|cg=${R.collectionGroup}|f=${R.fields.map((j=>`${j.fieldPath}:${j.kind}`)).join(",")}`})(u)} to execute ${Sc(t)}`);const h=(function(R,j){const z=Ix(j);if(z===void 0)return null;for(const V of L0(R,z.fieldPath))switch(V.op){case"array-contains-any":return V.value.arrayValue.values||[];case"array-contains":return[V.value]}return null})(d,u),p=(function(R,j){const z=new Map;for(const V of Kl(j))for(const I of L0(R,V.fieldPath))switch(I.op){case"==":case"in":z.set(V.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return z.set(V.fieldPath.canonicalString(),I.value),Array.from(z.values())}return null})(d,u),m=(function(R,j){const z=[];let V=!0;for(const I of Kl(j)){const A=I.kind===0?II(R,I.fieldPath,R.startAt):RI(R,I.fieldPath,R.startAt);z.push(A.value),V&&(V=A.inclusive)}return new md(z,V)})(d,u),b=(function(R,j){const z=[];let V=!0;for(const I of Kl(j)){const A=I.kind===0?RI(R,I.fieldPath,R.endAt):II(R,I.fieldPath,R.endAt);z.push(A.value),V&&(V=A.inclusive)}return new md(z,V)})(d,u),_=this.On(u,d,m),w=this.On(u,d,b),S=this.Nn(u,d,p),T=this.Bn(u.indexId,h,_,m.inclusive,w,b.inclusive,S);return oe.forEach(T,(C=>r.Y(C,t.limit).next((R=>{R.forEach((j=>{const z=De.fromSegments(j.documentKey);o.has(z)||(o=o.add(z),c.push(z))}))}))))})).next((()=>c))}return oe.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=fG(Gt.create(e.filters,"and")).map((r=>jx(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,a,o,c){const u=(t!=null?t.length:1)*Math.max(r.length,a.length),d=u/(t!=null?t.length:1),h=[];for(let p=0;p<u;++p){const m=t?this.Ln(t[p/d]):Im,b=this.kn(e,m,r[p%d],i),_=this.qn(e,m,a[p%d],o),w=c.map((S=>this.kn(e,m,S,!0)));h.push(...this.createRange(b,_,w))}return h}kn(e,t,r,i){const a=new ec(e,De.empty(),t,r);return i?a:a.An()}qn(e,t,r,i){const a=new ec(e,De.empty(),t,r);return i?a.An():a}xn(e,t){const r=new KI(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((a=>{let o=null;for(const c of a)r.yn(c)&&(!o||c.fields.length>o.fields.length)&&(o=c);return o}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return oe.forEach(i,(a=>this.xn(e,a).next((o=>{o?r!==0&&o.fields.length<(function(u){let d=new qt(pn.comparator),h=!1;for(const p of u.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:d=d.add(m.field));for(const p of u.orderBy)p.field.isKeyField()||(d=d.add(p.field));return d.size+(h?1:0)})(a)&&(r=1):r=0})))).next((()=>(function(o){return o.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new Zf;for(const i of Kl(e)){const a=t.data.field(i.fieldPath);if(a==null)return null;const o=r.Pn(i.kind);Jl.Kt.Dt(a,o)}return r.un()}Ln(e){const t=new Zf;return Jl.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new Zf;return Jl.Kt.Dt(Wh(this.databaseId,t),r.Pn((function(a){const o=Kl(a);return o.length===0?0:o[o.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new Zf);let a=0;for(const o of Kl(e)){const c=r[a++];for(const u of i)if(this.Un(t,o.fieldPath)&&Qh(c))i=this.Kn(i,o,c);else{const d=u.Pn(o.kind);Jl.Kt.Dt(c,d)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],a=[];for(const o of r.arrayValue.values||[])for(const c of i){const u=new Zf;u.seed(c.un()),Jl.Kt.Dt(o,u.Pn(t.kind)),a.push(u)}return a}Un(e,t){return!!e.filters.find((r=>r instanceof It&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=Jf(e),i=ku(e);return(t?r.J(Dx,IDBKeyRange.bound(t,t)):r.J()).next((a=>{const o=[];return oe.forEach(a,(c=>i.get([c.indexId,this.uid]).next((u=>{o.push((function(h,p){const m=p?new Gh(p.sequenceNumber,new wi(Cc(p.readTime),new De(Fa(p.documentKey)),p.largestBatchId)):Gh.empty(),b=h.fields.map((([_,w])=>new i0(pn.fromServerFormat(_),w)));return new M0(h.indexId,h.collectionGroup,b,m)})(c,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const a=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return a!==0?a:lt(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=Jf(e),a=ku(e);return this.Gn(e).next((o=>i.J(Dx,IDBKeyRange.bound(t,t)).next((c=>oe.forEach(c,(u=>a.put(FI(u.indexId,this.uid,o,r))))))))}updateIndexEntries(e,t){const r=new Map;return oe.forEach(t,((i,a)=>{const o=r.get(i.collectionGroup);return(o?oe.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next((c=>(r.set(i.collectionGroup,c),oe.forEach(c,(u=>this.zn(e,i,u).next((d=>{const h=this.jn(a,u);return d.isEqual(h)?oe.resolve():this.Jn(e,a,u,d,h)})))))))}))}Hn(e,t,r,i){return Du(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return Du(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=Du(e);let a=new qt(Mo);return i.ee({index:MM,range:IDBKeyRange.only([r.indexId,this.uid,f0(this.$n(r,t))])},((o,c)=>{a=a.add(new ec(r.indexId,t,YI(c.arrayValue),YI(c.directionalValue)))})).next((()=>a))}jn(e,t){let r=new qt(Mo);const i=this.Qn(t,e);if(i==null)return r;const a=Ix(t);if(a!=null){const o=e.data.field(a.fieldPath);if(Qh(o))for(const c of o.arrayValue.values||[])r=r.add(new ec(t.indexId,e.key,this.Ln(c),i))}else r=r.add(new ec(t.indexId,e.key,Im,i));return r}Jn(e,t,r,i,a){Se(WI,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,d,h,p,m){const b=u.getIterator(),_=d.getIterator();let w=Iu(b),S=Iu(_);for(;w||S;){let T=!1,C=!1;if(w&&S){const R=h(w,S);R<0?C=!0:R>0&&(T=!0)}else w!=null?C=!0:T=!0;T?(p(S),S=Iu(_)):C?(m(w),w=Iu(b)):(w=Iu(b),S=Iu(_))}})(i,a,Mo,(c=>{o.push(this.Hn(e,t,r,c))}),(c=>{o.push(this.Yn(e,t,r,c))})),oe.waitFor(o)}Gn(e){let t=1;return ku(e).ee({index:NM,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,a)=>{a.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((o,c)=>Mo(o,c))).filter(((o,c,u)=>!c||Mo(o,u[c-1])!==0));const i=[];i.push(e);for(const o of r){const c=Mo(o,e),u=Mo(o,t);if(c===0)i[0]=e.An();else if(c>0&&u<0)i.push(o),i.push(o.An());else if(u>0)break}i.push(t);const a=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const c=i[o].Vn(this.uid,Im,De.empty()),u=i[o+1].Vn(this.uid,Im,De.empty());a.push(IDBKeyRange.bound(c,u))}return a}Zn(e,t){return Mo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(ZI)}getMinOffset(e,t){return oe.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||Le(44426))))).next(ZI)}}function QI(n){return lr(n,Yh)}function Du(n){return lr(n,xh)}function Jf(n){return lr(n,Ew)}function ku(n){return lr(n,bh)}function ZI(n){Fe(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;xw(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new wi(e.readTime,e.documentKey,t)}const JI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},VP=41943040;class Dr{static withCacheSize(e){return new Dr(e,Dr.DEFAULT_COLLECTION_PERCENTILE,Dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function jP(n,e,t){const r=n.store(ua),i=n.store(ud),a=[],o=IDBKeyRange.only(t.batchId);let c=0;const u=r.ee({range:o},((h,p,m)=>(c++,m.delete())));a.push(u.next((()=>{Fe(c===1,47070,{batchId:t.batchId})})));const d=[];for(const h of t.mutations){const p=RM(e,h.key.path,t.batchId);a.push(i.delete(p)),d.push(h.key)}return oe.waitFor(a).next((()=>d))}function H0(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Le(14731);e=n.noDocument}return JSON.stringify(e).length}Dr.DEFAULT_COLLECTION_PERCENTILE=10,Dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Dr.DEFAULT=new Dr(VP,Dr.DEFAULT_COLLECTION_PERCENTILE,Dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Dr.DISABLED=new Dr(-1,0,0);class Vv{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){Fe(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new Vv(a,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Po(e).ee({index:ac,range:r},((i,a,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const a=zu(e),o=Po(e);return o.add({}).next((c=>{Fe(typeof c=="number",49019);const u=new kw(c,t,r,i),d=(function(b,_,w){const S=w.baseMutations.map((C=>F0(b.yt,C))),T=w.mutations.map((C=>F0(b.yt,C)));return{userId:_,batchId:w.batchId,localWriteTimeMs:w.localWriteTime.toMillis(),baseMutations:S,mutations:T}})(this.serializer,this.userId,u),h=[];let p=new qt(((m,b)=>lt(m.canonicalString(),b.canonicalString())));for(const m of i){const b=RM(this.userId,m.key.path,c);p=p.add(m.key.path.popLast()),h.push(o.put(d)),h.push(a.put(b,GF))}return p.forEach((m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[c]=u.keys()})),oe.waitFor(h).next((()=>u))}))}lookupMutationBatch(e,t){return Po(e).get(t).next((r=>r?(Fe(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Zl(this.serializer,r)):null))}er(e,t){return this.Xn[t]?oe.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return Po(e).ee({index:ac,range:i},((o,c,u)=>{c.userId===this.userId&&(Fe(c.batchId>=r,47524,{tr:r}),a=Zl(this.serializer,c)),u.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=dc;return Po(e).ee({index:ac,range:t,reverse:!0},((i,a,o)=>{r=a.batchId,o.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,dc],[this.userId,Number.POSITIVE_INFINITY]);return Po(e).J(ac,t).next((r=>r.map((i=>Zl(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=a0(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return zu(e).ee({range:i},((o,c,u)=>{const[d,h,p]=o,m=Fa(h);if(d===this.userId&&t.path.isEqual(m))return Po(e).get(p).next((b=>{if(!b)throw Le(61480,{nr:o,batchId:p});Fe(b.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:b.userId,batchId:p}),a.push(Zl(this.serializer,b))}));u.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new qt(lt);const i=[];return t.forEach((a=>{const o=a0(this.userId,a.path),c=IDBKeyRange.lowerBound(o),u=zu(e).ee({range:c},((d,h,p)=>{const[m,b,_]=d,w=Fa(b);m===this.userId&&a.path.isEqual(w)?r=r.add(_):p.done()}));i.push(u)})),oe.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,a=a0(this.userId,r),o=IDBKeyRange.lowerBound(a);let c=new qt(lt);return zu(e).ee({range:o},((u,d,h)=>{const[p,m,b]=u,_=Fa(m);p===this.userId&&r.isPrefixOf(_)?_.length===i&&(c=c.add(b)):h.done()})).next((()=>this.rr(e,c)))}rr(e,t){const r=[],i=[];return t.forEach((a=>{i.push(Po(e).get(a).next((o=>{if(o===null)throw Le(35274,{batchId:a});Fe(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:a}),r.push(Zl(this.serializer,o))})))})),oe.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return jP(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),oe.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return oe.resolve();const r=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),i=[];return zu(e).ee({range:r},((a,o,c)=>{if(a[0]===this.userId){const u=Fa(a[1]);i.push(u)}else c.done()})).next((()=>{Fe(i.length===0,56720,{sr:i.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return zP(e,this.userId,t)}_r(e){return LP(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:dc,lastStreamToken:""}))}}function zP(n,e,t){const r=a0(e,t.path),i=r[1],a=IDBKeyRange.lowerBound(r);let o=!1;return zu(n).ee({range:a,X:!0},((c,u,d)=>{const[h,p,m]=c;h===e&&p===i&&(o=!0),d.done()})).next((()=>o))}function Po(n){return lr(n,ua)}function zu(n){return lr(n,ud)}function LP(n){return lr(n,Hh)}class Ic{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ic(0)}static cr(){return new Ic(-1)}}class gG{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new Ic(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Ye.fromTimestamp(new et(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Nu(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(Fe(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const a=[];return Nu(e).ee(((o,c)=>{const u=ch(c);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(i++,a.push(this.removeTargetData(e,u)))})).next((()=>oe.waitFor(a))).next((()=>i))}forEachTarget(e,t){return Nu(e).ee(((r,i)=>{const a=ch(i);t(a)}))}lr(e){return eR(e).get(V0).next((t=>(Fe(t!==null,2888),t)))}hr(e,t){return eR(e).put(V0,t)}Pr(e,t){return Nu(e).put(NP(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=Sc(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return Nu(e).ee({range:i,index:kM},((o,c,u)=>{const d=ch(c);Ap(t,d.target)&&(a=d,u.done())})).next((()=>a))}addMatchingKeys(e,t,r){const i=[],a=Ho(e);return t.forEach((o=>{const c=Pr(o.path);i.push(a.put({targetId:r,path:c})),i.push(this.referenceDelegate.addReference(e,r,o))})),oe.waitFor(i)}removeMatchingKeys(e,t,r){const i=Ho(e);return oe.forEach(t,(a=>{const o=Pr(a.path);return oe.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,a)])}))}removeMatchingKeysForTargetId(e,t){const r=Ho(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Ho(e);let a=_t();return i.ee({range:r,X:!0},((o,c,u)=>{const d=Fa(o[1]),h=new De(d);a=a.add(h)})).next((()=>a))}containsKey(e,t){const r=Pr(t.path),i=IDBKeyRange.bound([r],[wM(r)],!1,!0);let a=0;return Ho(e).ee({index:ww,X:!0,range:i},(([o,c],u,d)=>{o!==0&&(a++,d.done())})).next((()=>a>0))}At(e,t){return Nu(e).get(t).next((r=>r?ch(r):null))}}function Nu(n){return lr(n,dd)}function eR(n){return lr(n,fc)}function Ho(n){return lr(n,fd)}const tR="LruGarbageCollector",mG=1048576;function nR([n,e],[t,r]){const i=lt(n,t);return i===0?lt(e,r):i}class vG{constructor(e){this.Ir=e,this.buffer=new qt(nR),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();nR(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class BP{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Se(tR,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){gl(t)?Se(tR,"Ignoring IndexedDB error during garbage collection: ",t):await Vc(t)}await this.Vr(3e5)}))}}class yG{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return oe.resolve(qi.ce);const r=new vG(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Se("LruGarbageCollector","Garbage collection skipped; disabled"),oe.resolve(JI)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Se("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),JI):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,a,o,c,u,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(Se("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i)))).next((p=>(r=p,c=Date.now(),this.removeTargets(e,r,t)))).next((p=>(a=p,u=Date.now(),this.removeOrphanedDocuments(e,r)))).next((p=>(d=Date.now(),Pu()<=Ct.DEBUG&&Se("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${a} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(d-u)+`ms
Total Duration: ${d-h}ms`),oe.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:p}))))}}function UP(n,e){return new yG(n,e)}class bG{constructor(e,t){this.db=e,this.garbageCollector=UP(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return Rm(e,r)}removeReference(e,t,r){return Rm(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Rm(e,t)}br(e,t){return(function(i,a){let o=!1;return LP(i).te((c=>zP(i,c,a).next((u=>(u&&(o=!0),oe.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Sr(e,((o,c)=>{if(c<=t){const u=this.br(e,o).next((d=>{if(!d)return a++,r.getEntry(e,o).next((()=>(r.removeEntry(o,Ye.min()),Ho(e).delete((function(p){return[0,Pr(p.path)]})(o)))))}));i.push(u)}})).next((()=>oe.waitFor(i))).next((()=>r.apply(e))).next((()=>a))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Rm(e,t)}Sr(e,t){const r=Ho(e);let i,a=qi.ce;return r.ee({index:ww},(([o,c],{path:u,sequenceNumber:d})=>{o===0?(a!==qi.ce&&t(new De(Fa(i)),a),a=d,i=u):a=qi.ce})).next((()=>{a!==qi.ce&&t(new De(Fa(i)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Rm(n,e){return Ho(n).put((function(r,i){return{targetId:0,path:Pr(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class FP{constructor(){this.changes=new Xs((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,En.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?oe.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class xG{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return ql(e).put(r)}removeEntry(e,t,r){return ql(e).delete((function(a,o){const c=a.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],G0(o),c[c.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=En.newInvalidDocument(t);return ql(e).ee({index:s0,range:IDBKeyRange.only(eh(t))},((i,a)=>{r=this.Cr(t,a)})).next((()=>r))}vr(e,t){let r={size:0,document:En.newInvalidDocument(t)};return ql(e).ee({index:s0,range:IDBKeyRange.only(eh(t))},((i,a)=>{r={document:this.Cr(t,a),size:H0(a)}})).next((()=>r))}getEntries(e,t){let r=bi();return this.Fr(e,t,((i,a)=>{const o=this.Cr(i,a);r=r.insert(i,o)})).next((()=>r))}Mr(e,t){let r=bi(),i=new un(De.comparator);return this.Fr(e,t,((a,o)=>{const c=this.Cr(a,o);r=r.insert(a,c),i=i.insert(a,H0(o))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return oe.resolve();let i=new qt(aR);t.forEach((u=>i=i.add(u)));const a=IDBKeyRange.bound(eh(i.first()),eh(i.last())),o=i.getIterator();let c=o.getNext();return ql(e).ee({index:s0,range:a},((u,d,h)=>{const p=De.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;c&&aR(c,p)<0;)r(c,null),c=o.getNext();c&&c.isEqual(p)&&(r(c,d),c=o.hasNext()?o.getNext():null),c?h.j(eh(c)):h.done()})).next((()=>{for(;c;)r(c,null),c=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,a){const o=t.path,c=[o.popLast().toArray(),o.lastSegment(),G0(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ql(e).J(IDBKeyRange.bound(c,u,!0)).next((d=>{a?.incrementDocumentReadCount(d.length);let h=bi();for(const p of d){const m=this.Cr(De.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(Ip(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h}))}getAllFromCollectionGroup(e,t,r,i){let a=bi();const o=iR(t,r),c=iR(t,wi.max());return ql(e).ee({index:DM,range:IDBKeyRange.bound(o,c,!0)},((u,d,h)=>{const p=this.Cr(De.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);a=a.insert(p.key,p),a.size===i&&h.done()})).next((()=>a))}newChangeBuffer(e){return new _G(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return rR(e).get(Rx).next((t=>(Fe(!!t,20021),t)))}Dr(e,t){return rR(e).put(Rx,t)}Cr(e,t){if(t){const r=aG(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Ye.min())))return r}return En.newInvalidDocument(e)}}function GP(n){return new xG(n)}class _G extends FP{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Xs((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new qt(((a,o)=>lt(a.canonicalString(),o.canonicalString())));return this.changes.forEach(((a,o)=>{const c=this.Br.get(a);if(t.push(this.Nr.removeEntry(e,a,c.readTime)),o.isValidDocument()){const u=BI(this.Nr.serializer,o);i=i.add(a.path.popLast());const d=H0(u);r+=d-c.size,t.push(this.Nr.addEntry(e,a,u))}else if(r-=c.size,this.trackRemovals){const u=BI(this.Nr.serializer,o.convertToNoDocument(Ye.min()));t.push(this.Nr.addEntry(e,a,u))}})),i.forEach((a=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Nr.updateMetadata(e,r)),oe.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((a,o)=>{this.Br.set(a,{size:o,readTime:r.get(a).readTime})})),r)))}}function rR(n){return lr(n,$h)}function ql(n){return lr(n,O0)}function eh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function iR(n,e){const t=e.documentKey.path.toArray();return[n,G0(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function aR(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(i=lt(t[a],r[a]),i)return i;return i=lt(t.length,r.length),i||(i=lt(t[t.length-2],r[r.length-2]),i||lt(t[t.length-1],r[r.length-1]))}class wG{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class qP{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Sh(r.mutation,i,ni.empty(),et.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,_t()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=_t()){const i=Ga();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((a=>{let o=oh();return a.forEach(((c,u)=>{o=o.insert(c,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const r=Ga();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,_t())))}populateOverlays(e,t,r){const i=[];return r.forEach((a=>{t.has(a)||i.push(a)})),this.documentOverlayCache.getOverlays(e,i).next((a=>{a.forEach(((o,c)=>{t.set(o,c)}))}))}computeViews(e,t,r,i){let a=bi();const o=Eh(),c=(function(){return Eh()})();return t.forEach(((u,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof Ws)?a=a.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Sh(h.mutation,d,h.mutation.getFieldMask(),et.now())):o.set(d.key,ni.empty())})),this.recalculateAndSaveOverlays(e,a).next((u=>(u.forEach(((d,h)=>o.set(d,h))),t.forEach(((d,h)=>c.set(d,new wG(h,o.get(d)??null)))),c)))}recalculateAndSaveOverlays(e,t){const r=Eh();let i=new un(((o,c)=>o-c)),a=_t();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const c of o)c.keys().forEach((u=>{const d=t.get(u);if(d===null)return;let h=r.get(u)||ni.empty();h=c.applyToLocalView(d,h),r.set(u,h);const p=(i.get(c.batchId)||_t()).add(u);i=i.insert(c.batchId,p)}))})).next((()=>{const o=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,h=u.value,p=oP();h.forEach((m=>{if(!a.has(m)){const b=pP(t.get(m),r.get(m));b!==null&&p.set(m,b),a=a.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return oe.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(o){return De.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):nP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((a=>{const o=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):oe.resolve(Ga());let c=Fh,u=a;return o.next((d=>oe.forEach(d,((h,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),a.get(h)?oe.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{u=u.insert(h,m)}))))).next((()=>this.populateOverlays(e,d,a))).next((()=>this.computeViews(e,u,d,_t()))).next((h=>({batchId:c,changes:sP(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new De(t)).next((r=>{let i=oh();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const a=t.collectionGroup;let o=oh();return this.indexManager.getCollectionParents(e,a).next((c=>oe.forEach(c,(u=>{const d=(function(p,m){return new jd(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next((h=>{h.forEach(((p,m)=>{o=o.insert(p,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,i)))).next((o=>{a.forEach(((u,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,En.newInvalidDocument(h)))}));let c=oh();return o.forEach(((u,d)=>{const h=a.get(u);h!==void 0&&Sh(h.mutation,d,ni.empty(),et.now()),Ip(t,d)&&(c=c.insert(u,d))})),c}))}}class EG{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return oe.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Hr(i.createTime)}})(t)),oe.resolve()}getNamedQuery(e,t){return oe.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:MP(i.bundledQuery),readTime:Hr(i.readTime)}})(t)),oe.resolve()}}class SG{constructor(){this.overlays=new un(De.comparator),this.qr=new Map}getOverlay(e,t){return oe.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ga();return oe.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,a)=>{this.St(e,t,a)})),oe.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(r)),oe.resolve()}getOverlaysForCollection(e,t,r){const i=Ga(),a=t.length+1,o=new De(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===a&&u.largestBatchId>r&&i.set(u.getKey(),u)}return oe.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new un(((d,h)=>d-h));const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let h=a.get(d.largestBatchId);h===null&&(h=Ga(),a=a.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const c=Ga(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((d,h)=>c.set(d,h))),!(c.size()>=i)););return oe.resolve(c)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Mw(t,r));let a=this.qr.get(t);a===void 0&&(a=_t(),this.qr.set(t,a)),this.qr.set(t,a.add(r.key))}}class TG{constructor(){this.sessionToken=Xn.EMPTY_BYTE_STRING}getSessionToken(e){return oe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,oe.resolve()}}class zw{constructor(){this.Qr=new qt(hr.$r),this.Ur=new qt(hr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new hr(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new hr(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new De(new zt([])),r=new hr(t,e),i=new hr(t,e+1),a=[];return this.Ur.forEachInRange([r,i],(o=>{this.Gr(o),a.push(o.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new De(new zt([])),r=new hr(t,e),i=new hr(t,e+1);let a=_t();return this.Ur.forEachInRange([r,i],(o=>{a=a.add(o.key)})),a}containsKey(e){const t=new hr(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class hr{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return De.comparator(e.key,t.key)||lt(e.Yr,t.Yr)}static Kr(e,t){return lt(e.Yr,t.Yr)||De.comparator(e.key,t.key)}}class AG{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new qt(hr.$r)}checkEmpty(e){return oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new kw(a,t,r,i);this.mutationQueue.push(o);for(const c of i)this.Zr=this.Zr.add(new hr(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return oe.resolve(o)}lookupMutationBatch(e,t){return oe.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),a=i<0?0:i;return oe.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return oe.resolve(this.mutationQueue.length===0?dc:this.tr-1)}getAllMutationBatches(e){return oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new hr(t,0),i=new hr(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([r,i],(o=>{const c=this.Xr(o.Yr);a.push(c)})),oe.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new qt(lt);return t.forEach((i=>{const a=new hr(i,0),o=new hr(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,o],(c=>{r=r.add(c.Yr)}))})),oe.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;De.isDocumentKey(a)||(a=a.child(""));const o=new hr(new De(a),0);let c=new qt(lt);return this.Zr.forEachWhile((u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(c=c.add(u.Yr)),!0)}),o),oe.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Fe(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return oe.forEach(t.mutations,(i=>{const a=new hr(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new hr(t,0),i=this.Zr.firstAfterOrEqual(r);return oe.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,oe.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class CG{constructor(e){this.ri=e,this.docs=(function(){return new un(De.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,o=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return oe.resolve(r?r.document.mutableCopy():En.newInvalidDocument(t))}getEntries(e,t){let r=bi();return t.forEach((i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():En.newInvalidDocument(i))})),oe.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let a=bi();const o=t.path,c=new De(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:h}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||xw(TM(h),r)<=0||(i.has(h.key)||Ip(t,h))&&(a=a.insert(h.key,h.mutableCopy()))}return oe.resolve(a)}getAllFromCollectionGroup(e,t,r,i){Le(9500)}ii(e,t){return oe.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new IG(this)}getSize(e){return oe.resolve(this.size)}}class IG extends FP{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),oe.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class RG{constructor(e){this.persistence=e,this.si=new Xs((t=>Sc(t)),Ap),this.lastRemoteSnapshotVersion=Ye.min(),this.highestTargetId=0,this.oi=0,this._i=new zw,this.targetCount=0,this.ai=Ic.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),oe.resolve()}getLastRemoteSnapshotVersion(e){return oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return oe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),oe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),oe.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ic(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,oe.resolve()}updateTargetData(e,t){return this.Pr(t),oe.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,oe.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.si.forEach(((o,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(o),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)})),oe.waitFor(a).next((()=>i))}getTargetCount(e){return oe.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return oe.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),oe.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach((o=>{a.push(i.markPotentiallyOrphaned(e,o))})),oe.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),oe.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return oe.resolve(r)}containsKey(e,t){return oe.resolve(this._i.containsKey(t))}}class Lw{constructor(e,t){this.ui={},this.overlays={},this.ci=new qi(0),this.li=!1,this.li=!0,this.hi=new TG,this.referenceDelegate=e(this),this.Pi=new RG(this),this.indexManager=new hG,this.remoteDocumentCache=(function(i){return new CG(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new kP(t),this.Ii=new EG(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new SG,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new AG(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){Se("MemoryPersistence","Starting transaction:",e);const i=new DG(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((a=>this.referenceDelegate.di(i).next((()=>a)))).toPromise().then((a=>(i.raiseOnCommittedEvent(),a)))}Ai(e,t){return oe.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class DG extends CM{constructor(e){super(),this.currentSequenceNumber=e}}class jv{constructor(e){this.persistence=e,this.Ri=new zw,this.Vi=null}static mi(e){return new jv(e)}get fi(){if(this.Vi)return this.Vi;throw Le(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),oe.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),oe.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),oe.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((a=>this.fi.add(a.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return oe.forEach(this.fi,(r=>{const i=De.fromPath(r);return this.gi(e,i).next((a=>{a||t.removeEntry(i,Ye.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return oe.or([()=>oe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class $0{constructor(e,t){this.persistence=e,this.pi=new Xs((r=>Pr(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=UP(this,t)}static mi(e,t){return new $0(e,t)}Ei(){}di(e){return oe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return oe.forEach(this.pi,((r,i)=>this.br(e,r,i).next((a=>a?oe.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,(o=>this.br(e,o,t).next((c=>{c||(r++,a.removeEntry(o,Ye.min()))})))).next((()=>a.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),oe.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),oe.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),oe.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),oe.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=l0(e.data.value)),t}br(e,t,r){return oe.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return oe.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class kG{constructor(e){this.serializer=e}k(e,t,r,i){const a=new Sv("createOrUpgrade",t);r<1&&i>=1&&((function(u){u.createObjectStore(Tp)})(e),(function(u){u.createObjectStore(Hh,{keyPath:FF}),u.createObjectStore(ua,{keyPath:mI,autoIncrement:!0}).createIndex(ac,vI,{unique:!0}),u.createObjectStore(ud)})(e),sR(e),(function(u){u.createObjectStore(Xl)})(e));let o=oe.resolve();return r<3&&i>=3&&(r!==0&&((function(u){u.deleteObjectStore(fd),u.deleteObjectStore(dd),u.deleteObjectStore(fc)})(e),sR(e)),o=o.next((()=>(function(u){const d=u.store(fc),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ye.min().toTimestamp(),targetCount:0};return d.put(V0,h)})(a)))),r<4&&i>=4&&(r!==0&&(o=o.next((()=>(function(u,d){return d.store(ua).J().next((p=>{u.deleteObjectStore(ua),u.createObjectStore(ua,{keyPath:mI,autoIncrement:!0}).createIndex(ac,vI,{unique:!0});const m=d.store(ua),b=p.map((_=>m.put(_)));return oe.waitFor(b)}))})(e,a)))),o=o.next((()=>{(function(u){u.createObjectStore(hd,{keyPath:QF})})(e)}))),r<5&&i>=5&&(o=o.next((()=>this.yi(a)))),r<6&&i>=6&&(o=o.next((()=>((function(u){u.createObjectStore($h)})(e),this.wi(a))))),r<7&&i>=7&&(o=o.next((()=>this.Si(a)))),r<8&&i>=8&&(o=o.next((()=>this.bi(e,a)))),r<9&&i>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(o=o.next((()=>this.Di(a)))),r<11&&i>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(Av,{keyPath:ZF})})(e),(function(u){u.createObjectStore(Cv,{keyPath:JF})})(e)}))),r<12&&i>=12&&(o=o.next((()=>{(function(u){const d=u.createObjectStore(Iv,{keyPath:s7});d.createIndex(kx,o7,{unique:!1}),d.createIndex(PM,l7,{unique:!1})})(e)}))),r<13&&i>=13&&(o=o.next((()=>(function(u){const d=u.createObjectStore(O0,{keyPath:qF});d.createIndex(s0,HF),d.createIndex(DM,$F)})(e))).next((()=>this.Ci(e,a))).next((()=>e.deleteObjectStore(Xl)))),r<14&&i>=14&&(o=o.next((()=>this.Fi(e,a)))),r<15&&i>=15&&(o=o.next((()=>(function(u){u.createObjectStore(Ew,{keyPath:e7,autoIncrement:!0}).createIndex(Dx,t7,{unique:!1}),u.createObjectStore(bh,{keyPath:n7}).createIndex(NM,r7,{unique:!1}),u.createObjectStore(xh,{keyPath:i7}).createIndex(MM,a7,{unique:!1})})(e)))),r<16&&i>=16&&(o=o.next((()=>{t.objectStore(bh).clear()})).next((()=>{t.objectStore(xh).clear()}))),r<17&&i>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(Sw,{keyPath:c7})})(e)}))),r<18&&i>=18&&SN()&&(o=o.next((()=>{t.objectStore(bh).clear()})).next((()=>{t.objectStore(xh).clear()}))),o}wi(e){let t=0;return e.store(Xl).ee(((r,i)=>{t+=H0(i)})).next((()=>{const r={byteSize:t};return e.store($h).put(Rx,r)}))}yi(e){const t=e.store(Hh),r=e.store(ua);return t.J().next((i=>oe.forEach(i,(a=>{const o=IDBKeyRange.bound([a.userId,dc],[a.userId,a.lastAcknowledgedBatchId]);return r.J(ac,o).next((c=>oe.forEach(c,(u=>{Fe(u.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const d=Zl(this.serializer,u);return jP(e,a.userId,d).next((()=>{}))}))))}))))}Si(e){const t=e.store(fd),r=e.store(Xl);return e.store(fc).get(V0).next((i=>{const a=[];return r.ee(((o,c)=>{const u=new zt(o),d=(function(p){return[0,Pr(p)]})(u);a.push(t.get(d).next((h=>h?oe.resolve():(p=>t.put({targetId:0,path:Pr(p),sequenceNumber:i.highestListenSequenceNumber}))(u))))})).next((()=>oe.waitFor(a)))}))}bi(e,t){e.createObjectStore(Yh,{keyPath:WF});const r=t.store(Yh),i=new jw,a=o=>{if(i.add(o)){const c=o.lastSegment(),u=o.popLast();return r.put({collectionId:c,parent:Pr(u)})}};return t.store(Xl).ee({X:!0},((o,c)=>{const u=new zt(o);return a(u.popLast())})).next((()=>t.store(ud).ee({X:!0},(([o,c,u],d)=>{const h=Fa(c);return a(h.popLast())}))))}Di(e){const t=e.store(dd);return t.ee(((r,i)=>{const a=ch(i),o=NP(this.serializer,a);return t.put(o)}))}Ci(e,t){const r=t.store(Xl),i=[];return r.ee(((a,o)=>{const c=t.store(O0),u=(function(p){return p.document?new De(zt.fromString(p.document.name).popFirst(5)):p.noDocument?De.fromSegments(p.noDocument.path):p.unknownDocument?De.fromSegments(p.unknownDocument.path):Le(36783)})(o).path.toArray(),d={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(c.put(d))})).next((()=>oe.waitFor(i)))}Fi(e,t){const r=t.store(ua),i=GP(this.serializer),a=new Lw(jv.mi,this.serializer.yt);return r.J().next((o=>{const c=new Map;return o.forEach((u=>{let d=c.get(u.userId)??_t();Zl(this.serializer,u).keys().forEach((h=>d=d.add(h))),c.set(u.userId,d)})),oe.forEach(c,((u,d)=>{const h=new Sr(d),p=Ov.wt(this.serializer,h),m=a.getIndexManager(h),b=Vv.wt(h,this.serializer,m,a.referenceDelegate);return new qP(i,b,p,m).recalculateAndSaveOverlaysForDocumentKeys(new Nx(t,qi.ce),u).next()}))}))}}function sR(n){n.createObjectStore(fd,{keyPath:KF}).createIndex(ww,XF,{unique:!0}),n.createObjectStore(dd,{keyPath:"targetId"}).createIndex(kM,YF,{unique:!0}),n.createObjectStore(fc)}const Oo="IndexedDbPersistence",T1=18e5,A1=5e3,C1="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",NG="main";class Bw{constructor(e,t,r,i,a,o,c,u,d,h,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=a,this.window=o,this.document=c,this.xi=d,this.Oi=h,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!Bw.v())throw new Ie(ge.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new bG(this,i),this.$i=t+NG,this.serializer=new kP(u),this.Ui=new el(this.$i,this.Ni,new kG(this.serializer)),this.hi=new oG,this.Pi=new gG(this.referenceDelegate,this.serializer),this.remoteDocumentCache=GP(this.serializer),this.Ii=new sG,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&Fr(Oo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ie(ge.FAILED_PRECONDITION,C1);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new qi(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Dm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(gl(e))return Se(Oo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Se(Oo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return th(e).get(Cu).next((t=>oe.resolve(this.es(t))))}ts(e){return Dm(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,T1)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=lr(t,hd);return r.J().next((i=>{const a=this.ss(i,T1),o=i.filter((c=>a.indexOf(c)===-1));return oe.forEach(o,(c=>r.delete(c.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?oe.resolve(!0):th(e).get(Cu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,A1)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Ie(ge.FAILED_PRECONDITION,C1);return!1}}return!(!this.networkEnabled||!this.inForeground)||Dm(e).J().next((r=>this.ss(r,A1).find((i=>{if(this.clientId!==i.clientId){const a=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,c=this.networkEnabled===i.networkEnabled;if(a||o&&c)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Se(Oo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Tp,hd],(e=>{const t=new Nx(e,qi.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Dm(e).J().next((t=>this.ss(t,T1).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return Vv.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new pG(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Ov.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){Se(Oo,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",a=(function(u){return u===18?f7:u===17?zM:u===16?d7:u===15?Tw:u===14?jM:u===13?VM:u===12?u7:u===11?OM:void Le(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,i,a,(c=>(o=new Nx(c,this.ci?this.ci.next():qi.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw Fr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Ie(ge.FAILED_PRECONDITION,AM);return r(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>r(o)))))).then((c=>(o.raiseOnCommittedEvent(),c)))}Is(e){return th(e).get(Cu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,A1)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ie(ge.FAILED_PRECONDITION,C1)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return th(e).put(Cu,t)}static v(){return el.v()}Zi(e){const t=th(e);return t.get(Cu).next((r=>this.es(r)?(Se(Oo,"Releasing primary lease."),t.delete(Cu)):oe.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Fr(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;EN()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return Se(Oo,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Fr(Oo,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Fr("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function th(n){return lr(n,Tp)}function Dm(n){return lr(n,hd)}function MG(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Uw{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=_t(),i=_t();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Uw(e,t.fromCache,r,i)}}class PG{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class HP{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return EN()?8:IM(or())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const a={result:null};return this.ys(e,t).next((o=>{a.result=o})).next((()=>{if(!a.result)return this.ws(e,t,i,r).next((o=>{a.result=o}))})).next((()=>{if(a.result)return;const o=new PG;return this.Ss(e,t,o).next((c=>{if(a.result=c,this.Vs)return this.bs(e,t,o,c.size)}))})).next((()=>a.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(Pu()<=Ct.DEBUG&&Se("QueryEngine","SDK will not create cache indexes for query:",Ou(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),oe.resolve()):(Pu()<=Ct.DEBUG&&Se("QueryEngine","Query:",Ou(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Pu()<=Ct.DEBUG&&Se("QueryEngine","The SDK decides to create cache indexes for query:",Ou(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,$i(t))):oe.resolve())}ys(e,t){if(DI(t))return oe.resolve(null);let r=$i(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=B0(t,null,"F"),r=$i(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((a=>{const o=_t(...a);return this.ps.getDocuments(e,o).next((c=>this.indexManager.getMinOffset(e,r).next((u=>{const d=this.Ds(t,c);return this.Cs(t,d,o,u.readTime)?this.ys(e,B0(t,null,"F")):this.vs(e,d,t,u)}))))})))))}ws(e,t,r,i){return DI(t)||i.isEqual(Ye.min())?oe.resolve(null):this.ps.getDocuments(e,r).next((a=>{const o=this.Ds(t,a);return this.Cs(t,o,r,i)?oe.resolve(null):(Pu()<=Ct.DEBUG&&Se("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ou(t)),this.vs(e,o,t,OF(i,Fh)).next((c=>c)))}))}Ds(e,t){let r=new qt(iP(e));return t.forEach(((i,a)=>{Ip(e,a)&&(r=r.add(a))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,t,r){return Pu()<=Ct.DEBUG&&Se("QueryEngine","Using full collection scan to execute query:",Ou(t)),this.ps.getDocumentsMatchingQuery(e,t,wi.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((a=>(t.forEach((o=>{a=a.insert(o.key,o)})),a)))}}const Fw="LocalStore",OG=3e8;class VG{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new un(lt),this.xs=new Xs((a=>Sc(a)),Ap),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new qP(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function $P(n,e,t,r){return new VG(n,e,t,r)}async function YP(n,e){const t=ut(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((a=>(i=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((a=>{const o=[],c=[];let u=_t();for(const d of i){o.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}for(const d of a){c.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}return t.localDocuments.getDocuments(r,u).next((d=>({Ls:d,removedBatchIds:o,addedBatchIds:c})))}))}))}function jG(n,e){const t=ut(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,u,d,h){const p=d.batch,m=p.keys();let b=oe.resolve();return m.forEach((_=>{b=b.next((()=>h.getEntry(u,_))).next((w=>{const S=d.docVersions.get(_);Fe(S!==null,48541),w.version.compareTo(S)<0&&(p.applyToRemoteDocument(w,d),w.isValidDocument()&&(w.setReadTime(d.commitVersion),h.addEntry(w)))}))})),b.next((()=>c.mutationQueue.removeMutationBatch(u,p)))})(t,r,e,a).next((()=>a.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let u=_t();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function KP(n){const e=ut(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function zG(n,e){const t=ut(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const c=[];e.targetChanges.forEach(((h,p)=>{const m=i.get(p);if(!m)return;c.push(t.Pi.removeMatchingKeys(a,h.removedDocuments,p).next((()=>t.Pi.addMatchingKeys(a,h.addedDocuments,p))));let b=m.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(p)!==null?b=b.withResumeToken(Xn.EMPTY_BYTE_STRING,Ye.min()).withLastLimboFreeSnapshotVersion(Ye.min()):h.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(h.resumeToken,r)),i=i.insert(p,b),(function(w,S,T){return w.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=OG?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(m,b,h)&&c.push(t.Pi.updateTargetData(a,b))}));let u=bi(),d=_t();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(a,h))})),c.push(LG(a,o,e.documentUpdates).next((h=>{u=h.ks,d=h.qs}))),!r.isEqual(Ye.min())){const h=t.Pi.getLastRemoteSnapshotVersion(a).next((p=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,r)));c.push(h)}return oe.waitFor(c).next((()=>o.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,u,d))).next((()=>u))})).then((a=>(t.Ms=i,a)))}function LG(n,e,t){let r=_t(),i=_t();return t.forEach((a=>r=r.add(a))),e.getEntries(n,r).next((a=>{let o=bi();return t.forEach(((c,u)=>{const d=a.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(Ye.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):Se(Fw,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)})),{ks:o,qs:i}}))}function BG(n,e){const t=ut(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=dc),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function UG(n,e){const t=ut(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((a=>a?(i=a,oe.resolve(i)):t.Pi.allocateTargetId(r).next((o=>(i=new Ds(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function $x(n,e,t){const r=ut(n),i=r.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,(o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!gl(o))throw o;Se(Fw,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function oR(n,e,t){const r=ut(n);let i=Ye.min(),a=_t();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(u,d,h){const p=ut(u),m=p.xs.get(h);return m!==void 0?oe.resolve(p.Ms.get(m)):p.Pi.getTargetData(d,h)})(r,o,$i(e)).next((c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,c.targetId).next((u=>{a=u}))})).next((()=>r.Fs.getDocumentsMatchingQuery(o,e,t?i:Ye.min(),t?a:_t()))).next((c=>(FG(r,C7(e),c),{documents:c,Qs:a})))))}function FG(n,e,t){let r=n.Os.get(e)||Ye.min();t.forEach(((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)})),n.Os.set(e,r)}class lR{constructor(){this.activeTargetIds=M7()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class XP{constructor(){this.Mo=new lR,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new lR,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class GG{Oo(e){}shutdown(){}}const cR="ConnectivityMonitor";class uR{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Se(cR,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Se(cR,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let km=null;function Yx(){return km===null?km=(function(){return 268435456+Math.round(2147483648*Math.random())})():km++,"0x"+km.toString(16)}const I1="RestConnection",qG={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class HG{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===j0?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,a){const o=Yx(),c=this.zo(e,t.toUriEncodedString());Se(I1,`Sending RPC '${e}' ${o}:`,c,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,a);const{host:d}=new URL(c),h=Pd(d);return this.Jo(e,c,u,r,h).then((p=>(Se(I1,`Received RPC '${e}' ${o}: `,p),p)),(p=>{throw wc(I1,`RPC '${e}' ${o} failed with error: `,p,"url: ",c,"request:",r),p}))}Ho(e,t,r,i,a,o){return this.Go(e,t,r,i,a)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Vd})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,a)=>e[a]=i)),r&&r.headers.forEach(((i,a)=>e[a]=i))}zo(e,t){const r=qG[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class $G{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Rr="WebChannelConnection";class YG extends HG{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,a){const o=Yx();return new Promise(((c,u)=>{const d=new gM;d.setWithCredentials(!0),d.listenOnce(mM.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case r0.NO_ERROR:const p=d.getResponseJson();Se(Rr,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),c(p);break;case r0.TIMEOUT:Se(Rr,`RPC '${e}' ${o} timed out`),u(new Ie(ge.DEADLINE_EXCEEDED,"Request time out"));break;case r0.HTTP_ERROR:const m=d.getStatus();if(Se(Rr,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let b=d.getResponseJson();Array.isArray(b)&&(b=b[0]);const _=b?.error;if(_&&_.status&&_.message){const w=(function(T){const C=T.toLowerCase().replace(/_/g,"-");return Object.values(ge).indexOf(C)>=0?C:ge.UNKNOWN})(_.status);u(new Ie(w,_.message))}else u(new Ie(ge.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new Ie(ge.UNAVAILABLE,"Connection failed."));break;default:Le(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Se(Rr,`RPC '${e}' ${o} completed.`)}}));const h=JSON.stringify(i);Se(Rr,`RPC '${e}' ${o} sending request:`,i),d.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=Yx(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=bM(),c=yM(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const h=a.join("");Se(Rr,`Creating RPC '${e}' stream ${i}: ${h}`,u);const p=o.createWebChannel(h,u);this.I_(p);let m=!1,b=!1;const _=new $G({Yo:S=>{b?Se(Rr,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(m||(Se(Rr,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),Se(Rr,`RPC '${e}' stream ${i} sending:`,S),p.send(S))},Zo:()=>p.close()}),w=(S,T,C)=>{S.listen(T,(R=>{try{C(R)}catch(j){setTimeout((()=>{throw j}),0)}}))};return w(p,sh.EventType.OPEN,(()=>{b||(Se(Rr,`RPC '${e}' stream ${i} transport opened.`),_.o_())})),w(p,sh.EventType.CLOSE,(()=>{b||(b=!0,Se(Rr,`RPC '${e}' stream ${i} transport closed`),_.a_(),this.E_(p))})),w(p,sh.EventType.ERROR,(S=>{b||(b=!0,wc(Rr,`RPC '${e}' stream ${i} transport errored. Name:`,S.name,"Message:",S.message),_.a_(new Ie(ge.UNAVAILABLE,"The operation could not be completed")))})),w(p,sh.EventType.MESSAGE,(S=>{if(!b){const T=S.data[0];Fe(!!T,16349);const C=T,R=C?.error||C[0]?.error;if(R){Se(Rr,`RPC '${e}' stream ${i} received error:`,R);const j=R.status;let z=(function(A){const k=Hn[A];if(k!==void 0)return vP(k)})(j),V=R.message;z===void 0&&(z=ge.INTERNAL,V="Unknown error status: "+j+" with message "+R.message),b=!0,_.a_(new Ie(z,V)),p.close()}else Se(Rr,`RPC '${e}' stream ${i} received:`,T),_.u_(T)}})),w(c,vM.STAT_EVENT,(S=>{S.stat===Ax.PROXY?Se(Rr,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===Ax.NOPROXY&&Se(Rr,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{_.__()}),0),_}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function KG(){return typeof window<"u"?window:null}function h0(){return typeof document<"u"?document:null}function zv(n){return new X7(n,!0)}class WP{constructor(e,t,r=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&Se("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const dR="PersistentStream";class QP{constructor(e,t,r,i,a,o,c,u){this.Mi=e,this.S_=r,this.b_=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new WP(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ge.RESOURCE_EXHAUSTED?(Fr(t.toString()),Fr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ge.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new Ie(ge.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Se(dR,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Se(dR,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class XG extends QP{constructor(e,t,r,i,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=Z7(this.serializer,e),r=(function(a){if(!("targetChange"in a))return Ye.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?Ye.min():o.readTime?Hr(o.readTime):Ye.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Ux(this.serializer),t.addTarget=(function(a,o){let c;const u=o.target;if(c=z0(u)?{documents:TP(a,u)}:{query:AP(a,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=xP(a,o.resumeToken);const d=Lx(a,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(Ye.min())>0){c.readTime=bd(a,o.snapshotVersion.toTimestamp());const d=Lx(a,o.expectedCount);d!==null&&(c.expectedCount=d)}return c})(this.serializer,e);const r=eG(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Ux(this.serializer),t.removeTarget=e,this.q_(t)}}class WG extends QP{constructor(e,t,r,i,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Fe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Fe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Fe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=J7(e.writeResults,e.commitTime),r=Hr(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Ux(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>F0(this.serializer,r)))};this.q_(t)}}class QG{}class ZG extends QG{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Ie(ge.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Go(e,Bx(t,r),i,a,o))).catch((a=>{throw a.name==="FirebaseError"?(a.code===ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ie(ge.UNKNOWN,a.toString())}))}Ho(e,t,r,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Ho(e,Bx(t,r),i,o,c,a))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ie(ge.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class JG{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Fr(t),this.aa=!1):Se("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Rc="RemoteStore";class eq{constructor(e,t,r,i,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((o=>{r.enqueueAndForget((async()=>{jc(this)&&(Se(Rc,"Restarting streams for network reachability change."),await(async function(u){const d=ut(u);d.Ea.add(4),await kp(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Lv(d)})(this))}))})),this.Ra=new JG(r,i)}}async function Lv(n){if(jc(n))for(const e of n.da)await e(!0)}async function kp(n){for(const e of n.da)await e(!1)}function ZP(n,e){const t=ut(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),$w(t)?Hw(t):Ld(t).O_()&&qw(t,e))}function Gw(n,e){const t=ut(n),r=Ld(t);t.Ia.delete(e),r.O_()&&JP(t,e),t.Ia.size===0&&(r.O_()?r.L_():jc(t)&&t.Ra.set("Unknown"))}function qw(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ye.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ld(n).Y_(e)}function JP(n,e){n.Va.Ue(e),Ld(n).Z_(e)}function Hw(n){n.Va=new H7({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Ld(n).start(),n.Ra.ua()}function $w(n){return jc(n)&&!Ld(n).x_()&&n.Ia.size>0}function jc(n){return ut(n).Ea.size===0}function e4(n){n.Va=void 0}async function tq(n){n.Ra.set("Online")}async function nq(n){n.Ia.forEach(((e,t)=>{qw(n,e)}))}async function rq(n,e){e4(n),$w(n)?(n.Ra.ha(e),Hw(n)):n.Ra.set("Unknown")}async function iq(n,e,t){if(n.Ra.set("Online"),e instanceof bP&&e.state===2&&e.cause)try{await(async function(i,a){const o=a.cause;for(const c of a.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.Ia.delete(c),i.Va.removeTarget(c))})(n,e)}catch(r){Se(Rc,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Y0(n,r)}else if(e instanceof d0?n.Va.Ze(e):e instanceof yP?n.Va.st(e):n.Va.tt(e),!t.isEqual(Ye.min()))try{const r=await KP(n.localStore);t.compareTo(r)>=0&&await(function(a,o){const c=a.Va.Tt(o);return c.targetChanges.forEach(((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const h=a.Ia.get(d);h&&a.Ia.set(d,h.withResumeToken(u.resumeToken,o))}})),c.targetMismatches.forEach(((u,d)=>{const h=a.Ia.get(u);if(!h)return;a.Ia.set(u,h.withResumeToken(Xn.EMPTY_BYTE_STRING,h.snapshotVersion)),JP(a,u);const p=new Ds(h.target,u,d,h.sequenceNumber);qw(a,p)})),a.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){Se(Rc,"Failed to raise snapshot:",r),await Y0(n,r)}}async function Y0(n,e,t){if(!gl(e))throw e;n.Ea.add(1),await kp(n),n.Ra.set("Offline"),t||(t=()=>KP(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Se(Rc,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Lv(n)}))}function t4(n,e){return e().catch((t=>Y0(n,t,e)))}async function Np(n){const e=ut(n),t=sl(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:dc;for(;aq(e);)try{const i=await BG(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,sq(e,i)}catch(i){await Y0(e,i)}n4(e)&&r4(e)}function aq(n){return jc(n)&&n.Ta.length<10}function sq(n,e){n.Ta.push(e);const t=sl(n);t.O_()&&t.X_&&t.ea(e.mutations)}function n4(n){return jc(n)&&!sl(n).x_()&&n.Ta.length>0}function r4(n){sl(n).start()}async function oq(n){sl(n).ra()}async function lq(n){const e=sl(n);for(const t of n.Ta)e.ea(t.mutations)}async function cq(n,e,t){const r=n.Ta.shift(),i=Nw.from(r,e,t);await t4(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await Np(n)}async function uq(n,e){e&&sl(n).X_&&await(async function(r,i){if((function(o){return F7(o)&&o!==ge.ABORTED})(i.code)){const a=r.Ta.shift();sl(r).B_(),await t4(r,(()=>r.remoteSyncer.rejectFailedWrite(a.batchId,i))),await Np(r)}})(n,e),n4(n)&&r4(n)}async function fR(n,e){const t=ut(n);t.asyncQueue.verifyOperationInProgress(),Se(Rc,"RemoteStore received new credentials");const r=jc(t);t.Ea.add(3),await kp(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Lv(t)}async function dq(n,e){const t=ut(n);e?(t.Ea.delete(2),await Lv(t)):e||(t.Ea.add(2),await kp(t),t.Ra.set("Unknown"))}function Ld(n){return n.ma||(n.ma=(function(t,r,i){const a=ut(t);return a.sa(),new XG(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:tq.bind(null,n),t_:nq.bind(null,n),r_:rq.bind(null,n),H_:iq.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),$w(n)?Hw(n):n.Ra.set("Unknown")):(await n.ma.stop(),e4(n))}))),n.ma}function sl(n){return n.fa||(n.fa=(function(t,r,i){const a=ut(t);return a.sa(),new WG(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:oq.bind(null,n),r_:uq.bind(null,n),ta:lq.bind(null,n),na:cq.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Np(n)):(await n.fa.stop(),n.Ta.length>0&&(Se(Rc,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Yw{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Ka,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,a){const o=Date.now()+r,c=new Yw(e,t,o,i,a);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ie(ge.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Kw(n,e){if(Fr("AsyncQueue",`${e}: ${n}`),gl(n))return new Ie(ge.UNAVAILABLE,`${e}: ${n}`);throw n}class rd{static emptySet(e){return new rd(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||De.comparator(t.key,r.key):(t,r)=>De.comparator(t.key,r.key),this.keyedMap=oh(),this.sortedSet=new un(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof rd)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new rd;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class hR{constructor(){this.ga=new un(De.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Le(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class xd{constructor(e,t,r,i,a,o,c,u,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,a){const o=[];return t.forEach((c=>{o.push({type:0,doc:c})})),new xd(e,t,rd.emptySet(t),o,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&kv(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class fq{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class hq{constructor(){this.queries=pR(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=ut(t),a=i.queries;i.queries=pR(),a.forEach(((o,c)=>{for(const u of c.Sa)u.onError(r)}))})(this,new Ie(ge.ABORTED,"Firestore shutting down"))}}function pR(){return new Xs((n=>rP(n)),kv)}async function Xw(n,e){const t=ut(n);let r=3;const i=e.query;let a=t.queries.get(i);a?!a.ba()&&e.Da()&&(r=2):(a=new fq,r=e.Da()?0:1);try{switch(r){case 0:a.wa=await t.onListen(i,!0);break;case 1:a.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const c=Kw(o,`Initialization of query '${Ou(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&Qw(t)}async function Ww(n,e){const t=ut(n),r=e.query;let i=3;const a=t.queries.get(r);if(a){const o=a.Sa.indexOf(e);o>=0&&(a.Sa.splice(o,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function pq(n,e){const t=ut(n);let r=!1;for(const i of e){const a=i.query,o=t.queries.get(a);if(o){for(const c of o.Sa)c.Fa(i)&&(r=!0);o.wa=i}}r&&Qw(t)}function gq(n,e,t){const r=ut(n),i=r.queries.get(e);if(i)for(const a of i.Sa)a.onError(t);r.queries.delete(e)}function Qw(n){n.Ca.forEach((e=>{e.next()}))}var Kx,gR;(gR=Kx||(Kx={})).Ma="default",gR.Cache="cache";class Zw{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new xd(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=xd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Kx.Cache}}class i4{constructor(e){this.key=e}}class a4{constructor(e){this.key=e}}class mq{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=_t(),this.mutatedKeys=_t(),this.eu=iP(e),this.tu=new rd(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new hR,i=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,o=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,p)=>{const m=i.get(h),b=Ip(this.query,p)?p:null,_=!!m&&this.mutatedKeys.has(m.key),w=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let S=!1;m&&b?m.data.isEqual(b.data)?_!==w&&(r.track({type:3,doc:b}),S=!0):this.su(m,b)||(r.track({type:2,doc:b}),S=!0,(u&&this.eu(b,u)>0||d&&this.eu(b,d)<0)&&(c=!0)):!m&&b?(r.track({type:0,doc:b}),S=!0):m&&!b&&(r.track({type:1,doc:m}),S=!0,(u||d)&&(c=!0)),S&&(b?(o=o.add(b),a=w?a.add(h):a.delete(h)):(o=o.delete(h),a=a.delete(h)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),a=a.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:c,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((h,p)=>(function(b,_){const w=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le(20277,{Rt:S})}};return w(b)-w(_)})(h.type,p.type)||this.eu(h.doc,p.doc))),this.ou(r),i=i??!1;const c=t&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,d=u!==this.Za;return this.Za=u,o.length!==0||d?{snapshot:new xd(this.query,e.tu,a,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new hR,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=_t(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new a4(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new i4(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=_t();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return xd.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Jw="SyncEngine";class vq{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class yq{constructor(e){this.key=e,this.hu=!1}}class bq{constructor(e,t,r,i,a,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Xs((c=>rP(c)),kv),this.Iu=new Map,this.Eu=new Set,this.du=new un(De.comparator),this.Au=new Map,this.Ru=new zw,this.Vu={},this.mu=new Map,this.fu=Ic.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function xq(n,e,t=!0){const r=d4(n);let i;const a=r.Tu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await s4(r,e,t,!0),i}async function _q(n,e){const t=d4(n);await s4(t,e,!0,!1)}async function s4(n,e,t,r){const i=await UG(n.localStore,$i(e)),a=i.targetId,o=n.sharedClientState.addLocalQueryTarget(a,t);let c;return r&&(c=await wq(n,e,a,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&ZP(n.remoteStore,i),c}async function wq(n,e,t,r,i){n.pu=(p,m,b)=>(async function(w,S,T,C){let R=S.view.ru(T);R.Cs&&(R=await oR(w.localStore,S.query,!1).then((({documents:I})=>S.view.ru(I,R))));const j=C&&C.targetChanges.get(S.targetId),z=C&&C.targetMismatches.get(S.targetId)!=null,V=S.view.applyChanges(R,w.isPrimaryClient,j,z);return vR(w,S.targetId,V.au),V.snapshot})(n,p,m,b);const a=await oR(n.localStore,e,!0),o=new mq(e,a.Qs),c=o.ru(a.documents),u=Dp.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=o.applyChanges(c,n.isPrimaryClient,u);vR(n,t,d.au);const h=new vq(e,t,o);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),d.snapshot}async function Eq(n,e,t){const r=ut(n),i=r.Tu.get(e),a=r.Iu.get(i.targetId);if(a.length>1)return r.Iu.set(i.targetId,a.filter((o=>!kv(o,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await $x(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Gw(r.remoteStore,i.targetId),Xx(r,i.targetId)})).catch(Vc)):(Xx(r,i.targetId),await $x(r.localStore,i.targetId,!0))}async function Sq(n,e){const t=ut(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Gw(t.remoteStore,r.targetId))}async function Tq(n,e,t){const r=f4(n);try{const i=await(function(o,c){const u=ut(o),d=et.now(),h=c.reduce(((b,_)=>b.add(_.key)),_t());let p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",(b=>{let _=bi(),w=_t();return u.Ns.getEntries(b,h).next((S=>{_=S,_.forEach(((T,C)=>{C.isValidDocument()||(w=w.add(T))}))})).next((()=>u.localDocuments.getOverlayedDocuments(b,_))).next((S=>{p=S;const T=[];for(const C of c){const R=B7(C,p.get(C.key).overlayedDocument);R!=null&&T.push(new Ws(C.key,R,KM(R.value.mapValue),sr.exists(!0)))}return u.mutationQueue.addMutationBatch(b,d,T,c)})).next((S=>{m=S;const T=S.applyToLocalDocumentSet(p,w);return u.documentOverlayCache.saveOverlays(b,S.batchId,T)}))})).then((()=>({batchId:m.batchId,changes:sP(p)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,c,u){let d=o.Vu[o.currentUser.toKey()];d||(d=new un(lt)),d=d.insert(c,u),o.Vu[o.currentUser.toKey()]=d})(r,i.batchId,t),await Mp(r,i.changes),await Np(r.remoteStore)}catch(i){const a=Kw(i,"Failed to persist write");t.reject(a)}}async function o4(n,e){const t=ut(n);try{const r=await zG(t.localStore,e);e.targetChanges.forEach(((i,a)=>{const o=t.Au.get(a);o&&(Fe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?Fe(o.hu,14607):i.removedDocuments.size>0&&(Fe(o.hu,42227),o.hu=!1))})),await Mp(t,r,e)}catch(r){await Vc(r)}}function mR(n,e,t){const r=ut(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((a,o)=>{const c=o.view.va(e);c.snapshot&&i.push(c.snapshot)})),(function(o,c){const u=ut(o);u.onlineState=c;let d=!1;u.queries.forEach(((h,p)=>{for(const m of p.Sa)m.va(c)&&(d=!0)})),d&&Qw(u)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Aq(n,e,t){const r=ut(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),a=i&&i.key;if(a){let o=new un(De.comparator);o=o.insert(a,En.newNoDocument(a,Ye.min()));const c=_t().add(a),u=new Pv(Ye.min(),new Map,new un(lt),o,c);await o4(r,u),r.du=r.du.remove(a),r.Au.delete(e),eE(r)}else await $x(r.localStore,e,!1).then((()=>Xx(r,e,t))).catch(Vc)}async function Cq(n,e){const t=ut(n),r=e.batch.batchId;try{const i=await jG(t.localStore,e);c4(t,r,null),l4(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Mp(t,i)}catch(i){await Vc(i)}}async function Iq(n,e,t){const r=ut(n);try{const i=await(function(o,c){const u=ut(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let h;return u.mutationQueue.lookupMutationBatch(d,c).next((p=>(Fe(p!==null,37113),h=p.keys(),u.mutationQueue.removeMutationBatch(d,p)))).next((()=>u.mutationQueue.performConsistencyCheck(d))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(d,h,c))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h))).next((()=>u.localDocuments.getDocuments(d,h)))}))})(r.localStore,e);c4(r,e,t),l4(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Mp(r,i)}catch(i){await Vc(i)}}function l4(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function c4(n,e,t){const r=ut(n);let i=r.Vu[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function Xx(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||u4(n,r)}))}function u4(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Gw(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),eE(n))}function vR(n,e,t){for(const r of t)r instanceof i4?(n.Ru.addReference(r.key,e),Rq(n,r)):r instanceof a4?(Se(Jw,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||u4(n,r.key)):Le(19791,{wu:r})}function Rq(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(Se(Jw,"New document in limbo: "+t),n.Eu.add(r),eE(n))}function eE(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new De(zt.fromString(e)),r=n.fu.next();n.Au.set(r,new yq(t)),n.du=n.du.insert(t,r),ZP(n.remoteStore,new Ds($i(Cp(t.path)),r,"TargetPurposeLimboResolution",qi.ce))}}async function Mp(n,e,t){const r=ut(n),i=[],a=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,u)=>{o.push(r.pu(u,e,t).then((d=>{if((d||t)&&r.isPrimaryClient){const h=d?!d.fromCache:t?.targetChanges.get(u.targetId)?.current;r.sharedClientState.updateQueryState(u.targetId,h?"current":"not-current")}if(d){i.push(d);const h=Uw.As(u.targetId,d);a.push(h)}})))})),await Promise.all(o),r.Pu.H_(i),await(async function(u,d){const h=ut(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>oe.forEach(d,(m=>oe.forEach(m.Es,(b=>h.persistence.referenceDelegate.addReference(p,m.targetId,b))).next((()=>oe.forEach(m.ds,(b=>h.persistence.referenceDelegate.removeReference(p,m.targetId,b)))))))))}catch(p){if(!gl(p))throw p;Se(Fw,"Failed to update sequence numbers: "+p)}for(const p of d){const m=p.targetId;if(!p.fromCache){const b=h.Ms.get(m),_=b.snapshotVersion,w=b.withLastLimboFreeSnapshotVersion(_);h.Ms=h.Ms.insert(m,w)}}})(r.localStore,a))}async function Dq(n,e){const t=ut(n);if(!t.currentUser.isEqual(e)){Se(Jw,"User change. New user:",e.toKey());const r=await YP(t.localStore,e);t.currentUser=e,(function(a,o){a.mu.forEach((c=>{c.forEach((u=>{u.reject(new Ie(ge.CANCELLED,o))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Mp(t,r.Ls)}}function kq(n,e){const t=ut(n),r=t.Au.get(e);if(r&&r.hu)return _t().add(r.key);{let i=_t();const a=t.Iu.get(e);if(!a)return i;for(const o of a){const c=t.Tu.get(o);i=i.unionWith(c.view.nu)}return i}}function d4(n){const e=ut(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=o4.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=kq.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Aq.bind(null,e),e.Pu.H_=pq.bind(null,e.eventManager),e.Pu.yu=gq.bind(null,e.eventManager),e}function f4(n){const e=ut(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Cq.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Iq.bind(null,e),e}class tp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=zv(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return $P(this.persistence,new HP,e.initialUser,this.serializer)}Cu(e){return new Lw(jv.mi,this.serializer)}Du(e){return new XP}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}tp.provider={build:()=>new tp};class Nq extends tp{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Fe(this.persistence.referenceDelegate instanceof $0,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new BP(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Dr.withCacheSize(this.cacheSizeBytes):Dr.DEFAULT;return new Lw((r=>$0.mi(r,t)),this.serializer)}}class Mq extends tp{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await f4(this.xu.syncEngine),await Np(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return $P(this.persistence,new HP,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new BP(r,e.asyncQueue,t)}Mu(e,t){const r=new LF(t,this.persistence);return new zF(e.asyncQueue,r)}Cu(e){const t=MG(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Dr.withCacheSize(this.cacheSizeBytes):Dr.DEFAULT;return new Bw(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,KG(),h0(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new XP}}class K0{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>mR(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Dq.bind(null,this.syncEngine),await dq(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new hq})()}createDatastore(e){const t=zv(e.databaseInfo.databaseId),r=(function(a){return new YG(a)})(e.databaseInfo);return(function(a,o,c,u){return new ZG(a,o,c,u)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,a,o,c){return new eq(r,i,a,o,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>mR(this.syncEngine,t,0)),(function(){return uR.v()?new uR:new GG})())}createSyncEngine(e,t){return(function(i,a,o,c,u,d,h){const p=new bq(i,a,o,c,u,d);return h&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=ut(t);Se(Rc,"RemoteStore shutting down."),r.Ea.add(5),await kp(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}K0.provider={build:()=>new K0};class tE{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Fr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const ol="FirestoreClient";class Pq{constructor(e,t,r,i,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Sr.UNAUTHENTICATED,this.clientId=bw.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,(async o=>{Se(ol,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(Se(ol,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ka;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Kw(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function R1(n,e){n.asyncQueue.verifyOperationInProgress(),Se(ol,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await YP(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function yR(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Oq(n);Se(ol,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>fR(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>fR(e.remoteStore,i))),n._onlineComponents=e}async function Oq(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Se(ol,"Using user provided OfflineComponentProvider");try{await R1(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===ge.FAILED_PRECONDITION||i.code===ge.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;wc("Error using user provided cache. Falling back to memory cache: "+t),await R1(n,new tp)}}else Se(ol,"Using default OfflineComponentProvider"),await R1(n,new Nq(void 0));return n._offlineComponents}async function h4(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Se(ol,"Using user provided OnlineComponentProvider"),await yR(n,n._uninitializedComponentsProvider._online)):(Se(ol,"Using default OnlineComponentProvider"),await yR(n,new K0))),n._onlineComponents}function Vq(n){return h4(n).then((e=>e.syncEngine))}async function X0(n){const e=await h4(n),t=e.eventManager;return t.onListen=xq.bind(null,e.syncEngine),t.onUnlisten=Eq.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=_q.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Sq.bind(null,e.syncEngine),t}function jq(n,e,t={}){const r=new Ka;return n.asyncQueue.enqueueAndForget((async()=>(function(a,o,c,u,d){const h=new tE({next:m=>{h.Nu(),o.enqueueAndForget((()=>Ww(a,p)));const b=m.docs.has(c);!b&&m.fromCache?d.reject(new Ie(ge.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&m.fromCache&&u&&u.source==="server"?d.reject(new Ie(ge.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new Zw(Cp(c.path),h,{includeMetadataChanges:!0,qa:!0});return Xw(a,p)})(await X0(n),n.asyncQueue,e,t,r))),r.promise}function zq(n,e,t={}){const r=new Ka;return n.asyncQueue.enqueueAndForget((async()=>(function(a,o,c,u,d){const h=new tE({next:m=>{h.Nu(),o.enqueueAndForget((()=>Ww(a,p))),m.fromCache&&u.source==="server"?d.reject(new Ie(ge.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new Zw(c,h,{includeMetadataChanges:!0,qa:!0});return Xw(a,p)})(await X0(n),n.asyncQueue,e,t,r))),r.promise}function p4(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const bR=new Map;const g4="firestore.googleapis.com",xR=!0;class _R{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ie(ge.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=g4,this.ssl=xR}else this.host=e.host,this.ssl=e.ssl??xR;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=VP;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<mG)throw new Ie(ge.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}PF("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=p4(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Ie(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Ie(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Ie(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Bv{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new _R({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ie(ge.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ie(ge.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new _R(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new SF;switch(r.type){case"firstParty":return new IF(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Ie(ge.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=bR.get(t);r&&(Se("ComponentProvider","Removing Datastore"),bR.delete(t),r.terminate())})(this),Promise.resolve()}}function Lq(n,e,t,r={}){n=Mr(n,Bv);const i=Pd(e),a=n._getSettings(),o={...a,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;i&&(xN(`https://${c}`),_N("Firestore",!0)),a.host!==g4&&a.host!==c&&wc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...a,host:c,ssl:i,emulatorOptions:r};if(!rl(u,o)&&(n._setSettings(u),r.mockUserToken)){let d,h;if(typeof r.mockUserToken=="string")d=r.mockUserToken,h=Sr.MOCK_USER;else{d=N9(r.mockUserToken,n._app?.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new Ie(ge.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Sr(p)}n._authCredentials=new TF(new _M(d,h))}}class Qs{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Qs(this.firestore,e,this._query)}}class Sn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new tl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Sn(this.firestore,e,this._key)}toJSON(){return{type:Sn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Sp(t,Sn._jsonSchema))return new Sn(e,r||null,new De(zt.fromString(t.referencePath)))}}Sn._jsonSchemaVersion="firestore/documentReference/1.0",Sn._jsonSchema={type:Kn("string",Sn._jsonSchemaVersion),referencePath:Kn("string")};class tl extends Qs{constructor(e,t,r){super(e,t,Cp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Sn(this.firestore,null,new De(e))}withConverter(e){return new tl(this.firestore,e,this._path)}}function Bi(n,e,...t){if(n=an(n),EM("collection","path",e),n instanceof Bv){const r=zt.fromString(e,...t);return dI(r),new tl(n,null,r)}{if(!(n instanceof Sn||n instanceof tl))throw new Ie(ge.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(zt.fromString(e,...t));return dI(r),new tl(n.firestore,null,r)}}function gt(n,e,...t){if(n=an(n),arguments.length===1&&(e=bw.newId()),EM("doc","path",e),n instanceof Bv){const r=zt.fromString(e,...t);return uI(r),new Sn(n,null,new De(r))}{if(!(n instanceof Sn||n instanceof tl))throw new Ie(ge.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(zt.fromString(e,...t));return uI(r),new Sn(n.firestore,n instanceof tl?n.converter:null,new De(r))}}const wR="AsyncQueue";class ER{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new WP(this,"async_queue_retry"),this._c=()=>{const r=h0();r&&Se(wR,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=h0();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=h0();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Ka;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!gl(e))throw e;Se(wR,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Fr("INTERNAL UNHANDLED ERROR: ",SR(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=Yw.createAndSchedule(this,e,t,r,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&Le(47125,{Pc:SR(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function SR(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function TR(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const a of r)if(a in i&&typeof i[a]=="function")return!0;return!1})(n,["next","error","complete"])}class va extends Bv{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new ER,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ER(e),this._firestoreClient=void 0,await e}}}function Bq(n,e){const t=typeof n=="object"?n:RN(),r=typeof n=="string"?n:j0,i=cw(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const a=D9("firestore");a&&Lq(i,...a)}return i}function Pp(n){if(n._terminated)throw new Ie(ge.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||m4(n),n._firestoreClient}function m4(n){const e=n._freezeSettings(),t=(function(i,a,o,c){return new p7(i,a,o,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,p4(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Pq(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}})(n._componentsProvider))}function Uq(n,e){wc("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return Fq(n,K0.provider,{build:r=>new Mq(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function Fq(n,e,t){if((n=Mr(n,va))._firestoreClient||n._terminated)throw new Ie(ge.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Ie(ge.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},m4(n)}class Gi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gi(Xn.fromBase64String(e))}catch(t){throw new Ie(ge.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Gi(Xn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Gi._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Sp(e,Gi._jsonSchema))return Gi.fromBase64String(e.bytes)}}Gi._jsonSchemaVersion="firestore/bytes/1.0",Gi._jsonSchema={type:Kn("string",Gi._jsonSchemaVersion),bytes:Kn("string")};class Op{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ie(ge.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new pn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Uv{constructor(e){this._methodName=e}}class Xa{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ie(ge.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ie(ge.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return lt(this._lat,e._lat)||lt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Xa._jsonSchemaVersion}}static fromJSON(e){if(Sp(e,Xa._jsonSchema))return new Xa(e.latitude,e.longitude)}}Xa._jsonSchemaVersion="firestore/geoPoint/1.0",Xa._jsonSchema={type:Kn("string",Xa._jsonSchemaVersion),latitude:Kn("number"),longitude:Kn("number")};class Wa{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Wa._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Sp(e,Wa._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Wa(e.vectorValues);throw new Ie(ge.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Wa._jsonSchemaVersion="firestore/vectorValue/1.0",Wa._jsonSchema={type:Kn("string",Wa._jsonSchemaVersion),vectorValues:Kn("object")};const Gq=/^__.*__$/;class qq{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Ws(e,this.data,this.fieldMask,t,this.fieldTransforms):new zd(e,this.data,t,this.fieldTransforms)}}class v4{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Ws(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function y4(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le(40011,{Ac:n})}}class Fv{constructor(e,t,r,i,a,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Fv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return W0(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(y4(this.Ac)&&Gq.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Hq{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||zv(e)}Cc(e,t,r,i=!1){return new Fv({Ac:e,methodName:t,Dc:r,path:pn.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Vp(n){const e=n._freezeSettings(),t=zv(n._databaseId);return new Hq(n._databaseId,!!e.ignoreUndefinedProperties,t)}function nE(n,e,t,r,i,a={}){const o=n.Cc(a.merge||a.mergeFields?2:0,e,t,i);iE("Data must be an object, but it was:",o,r);const c=_4(r,o);let u,d;if(a.merge)u=new ni(o.fieldMask),d=o.fieldTransforms;else if(a.mergeFields){const h=[];for(const p of a.mergeFields){const m=Wx(e,p,t);if(!o.contains(m))throw new Ie(ge.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);E4(h,m)||h.push(m)}u=new ni(h),d=o.fieldTransforms.filter((p=>u.covers(p.field)))}else u=null,d=o.fieldTransforms;return new qq(new kr(c),u,d)}class jp extends Uv{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof jp}}function $q(n,e,t){return new Fv({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class rE extends Uv{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=$q(this,e,!0),r=this.vc.map((a=>Bd(a,t))),i=new Tc(r);return new hP(e.path,i)}isEqual(e){return e instanceof rE&&rl(this.vc,e.vc)}}function b4(n,e,t,r){const i=n.Cc(1,e,t);iE("Data must be an object, but it was:",i,r);const a=[],o=kr.empty();ml(r,((u,d)=>{const h=aE(e,u,t);d=an(d);const p=i.yc(h);if(d instanceof jp)a.push(h);else{const m=Bd(d,p);m!=null&&(a.push(h),o.set(h,m))}}));const c=new ni(a);return new v4(o,c,i.fieldTransforms)}function x4(n,e,t,r,i,a){const o=n.Cc(1,e,t),c=[Wx(e,r,t)],u=[i];if(a.length%2!=0)throw new Ie(ge.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<a.length;m+=2)c.push(Wx(e,a[m])),u.push(a[m+1]);const d=[],h=kr.empty();for(let m=c.length-1;m>=0;--m)if(!E4(d,c[m])){const b=c[m];let _=u[m];_=an(_);const w=o.yc(b);if(_ instanceof jp)d.push(b);else{const S=Bd(_,w);S!=null&&(d.push(b),h.set(b,S))}}const p=new ni(d);return new v4(h,p,o.fieldTransforms)}function Yq(n,e,t,r=!1){return Bd(t,n.Cc(r?4:3,e))}function Bd(n,e){if(w4(n=an(n)))return iE("Unsupported field value:",e,n),_4(n,e);if(n instanceof Uv)return(function(r,i){if(!y4(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(i);a&&i.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const a=[];let o=0;for(const c of r){let u=Bd(c,i.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),o++}return{arrayValue:{values:a}}})(n,e)}return(function(r,i){if((r=an(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return P7(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=et.fromDate(r);return{timestampValue:bd(i.serializer,a)}}if(r instanceof et){const a=new et(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:bd(i.serializer,a)}}if(r instanceof Xa)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Gi)return{bytesValue:xP(i.serializer,r._byteString)};if(r instanceof Sn){const a=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(a))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Ow(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Wa)return(function(o,c){return{mapValue:{fields:{[Cw]:{stringValue:Iw},[pd]:{arrayValue:{values:o.toArray().map((d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return Dw(c.serializer,d)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${Ev(r)}`)})(n,e)}function _4(n,e){const t={};return LM(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ml(n,((r,i)=>{const a=Bd(i,e.mc(r));a!=null&&(t[r]=a)})),{mapValue:{fields:t}}}function w4(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof et||n instanceof Xa||n instanceof Gi||n instanceof Sn||n instanceof Uv||n instanceof Wa)}function iE(n,e,t){if(!w4(t)||!SM(t)){const r=Ev(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function Wx(n,e,t){if((e=an(e))instanceof Op)return e._internalPath;if(typeof e=="string")return aE(n,e);throw W0("Field path arguments must be of type string or ",n,!1,void 0,t)}const Kq=new RegExp("[~\\*/\\[\\]]");function aE(n,e,t){if(e.search(Kq)>=0)throw W0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Op(...e.split("."))._internalPath}catch{throw W0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function W0(n,e,t,r,i){const a=r&&!r.isEmpty(),o=i!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(a||o)&&(u+=" (found",a&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new Ie(ge.INVALID_ARGUMENT,c+n+u)}function E4(n,e){return n.some((t=>t.isEqual(e)))}class S4{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Sn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Xq(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Gv("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Xq extends S4{data(){return super.data()}}function Gv(n,e){return typeof e=="string"?aE(n,e):e instanceof Op?e._internalPath:e._delegate._internalPath}function T4(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ie(ge.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class sE{}class oE extends sE{}function Fs(n,e,...t){let r=[];e instanceof sE&&r.push(e),r=r.concat(t),(function(a){const o=a.filter((u=>u instanceof lE)).length,c=a.filter((u=>u instanceof qv)).length;if(o>1||o>0&&c>0)throw new Ie(ge.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class qv extends oE{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new qv(e,t,r)}_apply(e){const t=this._parse(e);return A4(e._query,t),new Qs(e.firestore,e.converter,zx(e._query,t))}_parse(e){const t=Vp(e.firestore);return(function(a,o,c,u,d,h,p){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Ie(ge.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){IR(p,h);const _=[];for(const w of p)_.push(CR(u,a,w));m={arrayValue:{values:_}}}else m=CR(u,a,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||IR(p,h),m=Yq(c,o,p,h==="in"||h==="not-in");return It.create(d,h,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Wq(n,e,t){const r=e,i=Gv("where",n);return qv._create(i,r,t)}class lE extends sE{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new lE(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Gt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,a){let o=i;const c=a.getFlattenedFilters();for(const u of c)A4(o,u),o=zx(o,u)})(e._query,t),new Qs(e.firestore,e.converter,zx(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class cE extends oE{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new cE(e,t)}_apply(e){const t=(function(i,a,o){if(i.startAt!==null)throw new Ie(ge.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Ie(ge.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Zh(a,o)})(e._query,this._field,this._direction);return new Qs(e.firestore,e.converter,(function(i,a){const o=i.explicitOrderBy.concat([a]);return new jd(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}}function _d(n,e="asc"){const t=e,r=Gv("orderBy",n);return cE._create(r,t)}class uE extends oE{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new uE(e,t,r)}_apply(e){return new Qs(e.firestore,e.converter,B0(e._query,this._limit,this._limitType))}}function AR(n){return uE._create("limit",n,"F")}function CR(n,e,t){if(typeof(t=an(t))=="string"){if(t==="")throw new Ie(ge.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!nP(e)&&t.indexOf("/")!==-1)throw new Ie(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(zt.fromString(t));if(!De.isDocumentKey(r))throw new Ie(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Wh(n,new De(r))}if(t instanceof Sn)return Wh(n,t._key);throw new Ie(ge.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ev(t)}.`)}function IR(n,e){if(!Array.isArray(n)||n.length===0)throw new Ie(ge.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function A4(n,e){const t=(function(i,a){for(const o of i)for(const c of o.getFlattenedFilters())if(a.indexOf(c.op)>=0)return c.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ie(ge.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ie(ge.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Qq{convertValue(e,t="none"){switch(il(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ln(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Us(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Le(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return ml(e,((i,a)=>{r[i]=this.convertValue(a,t)})),r}convertVectorValue(e){const t=e.fields?.[pd].arrayValue?.values?.map((r=>ln(r.doubleValue)));return new Wa(t)}convertGeoPoint(e){return new Xa(ln(e.latitude),ln(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Rv(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Kh(e));default:return null}}convertTimestamp(e){const t=Bs(e);return new et(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=zt.fromString(e);Fe(DP(r),9688,{name:e});const i=new Ec(r.get(1),r.get(3)),a=new De(r.popFirst(5));return i.isEqual(t)||Fr(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function dE(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class uh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class pc extends S4{constructor(e,t,r,i,a,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new p0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Gv("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(ge.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=pc._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}pc._jsonSchemaVersion="firestore/documentSnapshot/1.0",pc._jsonSchema={type:Kn("string",pc._jsonSchemaVersion),bundleSource:Kn("string","DocumentSnapshot"),bundleName:Kn("string"),bundle:Kn("string")};class p0 extends pc{data(e={}){return super.data(e)}}class gc{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new uh(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new p0(this._firestore,this._userDataWriter,r.key,r,new uh(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ie(ge.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((c=>{const u=new p0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new uh(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((c=>a||c.type!==3)).map((c=>{const u=new p0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new uh(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),h=o.indexOf(c.doc.key)),{type:Zq(c.type),doc:u,oldIndex:d,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(ge.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=gc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=bw.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Zq(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Le(61501,{type:n})}}function sc(n){n=Mr(n,Sn);const e=Mr(n.firestore,va);return jq(Pp(e),n._key).then((t=>C4(e,n,t)))}gc._jsonSchemaVersion="firestore/querySnapshot/1.0",gc._jsonSchema={type:Kn("string",gc._jsonSchemaVersion),bundleSource:Kn("string","QuerySnapshot"),bundleName:Kn("string"),bundle:Kn("string")};class fE extends Qq{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Sn(this.firestore,null,t)}}function Ba(n){n=Mr(n,Qs);const e=Mr(n.firestore,va),t=Pp(e),r=new fE(e);return T4(n._query),zq(t,n._query).then((i=>new gc(e,r,n,i)))}function Ui(n,e,t){n=Mr(n,Sn);const r=Mr(n.firestore,va),i=dE(n.converter,e,t);return zp(r,[nE(Vp(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,sr.none())])}function pr(n,e,t,...r){n=Mr(n,Sn);const i=Mr(n.firestore,va),a=Vp(i);let o;return o=typeof(e=an(e))=="string"||e instanceof Op?x4(a,"updateDoc",n._key,e,t,r):b4(a,"updateDoc",n._key,e),zp(i,[o.toMutation(n._key,sr.exists(!0))])}function Ua(n){return zp(Mr(n.firestore,va),[new Rp(n._key,sr.none())])}function Hv(n,e){const t=Mr(n.firestore,va),r=gt(n),i=dE(n.converter,e);return zp(t,[nE(Vp(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,sr.exists(!1))]).then((()=>r))}function Ud(n,...e){n=an(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||TR(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(TR(e[r])){const u=e[r];e[r]=u.next?.bind(u),e[r+1]=u.error?.bind(u),e[r+2]=u.complete?.bind(u)}let a,o,c;if(n instanceof Sn)o=Mr(n.firestore,va),c=Cp(n._key.path),a={next:u=>{e[r]&&e[r](C4(o,n,u))},error:e[r+1],complete:e[r+2]};else{const u=Mr(n,Qs);o=Mr(u.firestore,va),c=u._query;const d=new fE(o);a={next:h=>{e[r]&&e[r](new gc(o,d,u,h))},error:e[r+1],complete:e[r+2]},T4(n._query)}return(function(d,h,p,m){const b=new tE(m),_=new Zw(h,b,p);return d.asyncQueue.enqueueAndForget((async()=>Xw(await X0(d),_))),()=>{b.Nu(),d.asyncQueue.enqueueAndForget((async()=>Ww(await X0(d),_)))}})(Pp(o),c,i,a)}function zp(n,e){return(function(r,i){const a=new Ka;return r.asyncQueue.enqueueAndForget((async()=>Tq(await Vq(r),i,a))),a.promise})(Pp(n),e)}function C4(n,e,t){const r=t.docs.get(e._key),i=new fE(n);return new pc(n,i,e._key,r,new uh(t.hasPendingWrites,t.fromCache),e.converter)}class Jq{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Vp(e)}set(e,t,r){this._verifyNotCommitted();const i=D1(e,this._firestore),a=dE(i.converter,t,r),o=nE(this._dataReader,"WriteBatch.set",i._key,a,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,sr.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const a=D1(e,this._firestore);let o;return o=typeof(t=an(t))=="string"||t instanceof Op?x4(this._dataReader,"WriteBatch.update",a._key,t,r,i):b4(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(o.toMutation(a._key,sr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=D1(e,this._firestore);return this._mutations=this._mutations.concat(new Rp(t._key,sr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ie(ge.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function D1(n,e){if((n=an(n)).firestore!==e)throw new Ie(ge.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function Qx(){return new jp("deleteField")}function I4(...n){return new rE("arrayUnion",n)}function eH(n){return Pp(n=Mr(n,va)),new Jq(n,(e=>zp(n,e)))}(function(e,t=!0){(function(i){Vd=i})(Od),od(new yc("firestore",((r,{instanceIdentifier:i,options:a})=>{const o=r.getProvider("app").getImmediate(),c=new va(new AF(r.getProvider("auth-internal")),new RF(o,r.getProvider("app-check-internal")),(function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Ie(ge.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ec(d.options.projectId,h)})(o,i),o);return a={useFetchStreams:t,...a},c._setSettings(a),c}),"PUBLIC").setMultipleInstances(!0)),Zo(sI,oI,e),Zo(sI,oI,"esm2020")})();const tH={apiKey:"AIzaSyDwUA0paVI6n01aENV5Q2aLwVz1DEDtNuA",authDomain:"personal-budget-pwa-5defb.firebaseapp.com",projectId:"personal-budget-pwa-5defb",storageBucket:"personal-budget-pwa-5defb.firebasestorage.app",messagingSenderId:"137454342284",appId:"1:137454342284:web:d7a8169fd53f437e42aba9"},R4=IN(tH),Vo=xF(R4),We=Bq(R4);Uq(We).catch(n=>{n.code==="failed-precondition"?console.warn(" Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"?console.warn(" Offline persistence not available in this browser"):console.error(" Failed to enable offline persistence:",n)});const k1=n=>({id:n.uid,username:n.email||n.uid,displayName:n.displayName||n.email?.split("@")[0]||"User",email:n.email||void 0}),Yi=sw()(fN(n=>({currentUser:null,isAuthenticated:!1,loginError:null,isLoading:!1,isInitialized:!1,isInitializing:!0,lastAuthTime:null,offlineGracePeriod:10080*60*1e3,lastVerificationEmailSent:null,login:async(e,t)=>{n({isLoading:!0,loginError:null});try{const i=(await rU(Vo,e,t)).user;if(!i.emailVerified)return await X2(Vo),n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:"Please verify your email address before signing in. Check your email for a verification link."}),console.log(` Login blocked: ${i.email} not verified`),!1;const a=k1(i);return n({currentUser:a,isAuthenticated:!0,isLoading:!1,loginError:null,lastAuthTime:Date.now()}),console.log(` User logged in: ${a.email}`),!0}catch(r){console.error("Login error:",r),console.error("Error code:",r.code),console.error("Error message:",r.message);let i="Login failed. Please try again.";if(r.code)switch(r.code){case"auth/invalid-email":i="Invalid email address.";break;case"auth/user-disabled":i="This account has been disabled.";break;case"auth/user-not-found":i="No account found with this email.";break;case"auth/wrong-password":i="Incorrect password.";break;case"auth/too-many-requests":i="Too many failed attempts. Please try again later.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break;case"auth/invalid-credential":i="Invalid email or password.";break;default:console.warn(`Unhandled Firebase error code: ${r.code}`),i="Authentication failed. Please try again.";break}else console.warn("Non-Firebase error in login:",r),i="An unexpected error occurred. Please try again.";return n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:i}),!1}},register:async(e,t,r)=>{n({isLoading:!0,loginError:null});try{const a=(await nU(Vo,e,t)).user;await aU(a,{displayName:r}),await K2(a);const o=k1(a);return n({currentUser:o,isAuthenticated:!1,isLoading:!1,loginError:null,lastVerificationEmailSent:Date.now()}),console.log(` User registered: ${o.email}, verification email sent`),!0}catch(i){console.error("Registration error:",i);let a="Registration failed. Please try again.";switch(i.code){case"auth/email-already-in-use":a="An account with this email already exists.";break;case"auth/invalid-email":a="Invalid email address.";break;case"auth/weak-password":a="Password should be at least 6 characters.";break;case"auth/operation-not-allowed":a="Email/password accounts are not enabled.";break}return n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:a}),!1}},logout:async()=>{try{await X2(Vo),console.log(" User logged out")}catch(e){console.error("Logout error:",e)}},clearError:()=>{n({loginError:null})},sendPasswordReset:async e=>{n({isLoading:!0,loginError:null});try{return await tU(Vo,e),n({isLoading:!1}),!0}catch(t){console.error("Password reset error:",t);let r="Failed to send password reset email. Please try again.";switch(t.code){case"auth/user-not-found":r="No account found with this email.";break;case"auth/invalid-email":r="Invalid email address.";break;case"auth/too-many-requests":r="Too many attempts. Please try again later.";break}return n({isLoading:!1,loginError:r}),!1}},sendEmailVerification:async()=>{const e=Vo.currentUser;if(!e)return n({loginError:"No user is currently signed in."}),!1;n({isLoading:!0,loginError:null});try{return await K2(e),n({isLoading:!1,lastVerificationEmailSent:Date.now()}),console.log(` Verification email sent to: ${e.email}`),!0}catch(t){console.error("Email verification error:",t);let r="Failed to send verification email. Please try again.";switch(t.code){case"auth/too-many-requests":r="Too many verification emails sent. Please wait before trying again.";break}return n({isLoading:!1,loginError:r}),!1}},resendEmailVerification:async()=>{const e=Yi.getState();if(e.lastVerificationEmailSent){const t=Date.now()-e.lastVerificationEmailSent,r=60*1e3;if(t<r){const i=Math.ceil((r-t)/1e3);return n({loginError:`Please wait ${i} seconds before requesting another verification email.`}),!1}}return e.sendEmailVerification()},deleteAccount:async e=>{const t=Vo.currentUser;if(!t||!t.email)return n({loginError:"No user is currently signed in."}),!1;n({isLoading:!0,loginError:null});try{const r=Oc.credential(t.email,e);return await eU(t,r),await cU(t),n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:null,lastAuthTime:null}),console.log(` Account permanently deleted: ${t.email}`),!0}catch(r){console.error("Account deletion error:",r);let i="Failed to delete account. Please try again.";switch(r.code){case"auth/requires-recent-login":i="For security, please log out and log back in before deleting your account.";break;case"auth/wrong-password":i="Incorrect password. Please enter your current password.";break;case"auth/too-many-requests":i="Too many deletion attempts. Please wait before trying again.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break}return n({isLoading:!1,loginError:i}),!1}},initializeAuth:()=>Yi.getState().isInitialized?()=>{}:(n({isInitialized:!1}),lU(Vo,r=>{const i=Date.now(),a=Yi.getState(),o=r?k1(r):null,c=a.lastAuthTime&&i-a.lastAuthTime<a.offlineGracePeriod,d=typeof navigator<"u"&&!navigator.onLine&&a.isAuthenticated&&c&&!o,h=r?r.emailVerified:!0,p=r&&h||!!d,m=r?o:d?a.currentUser:null;n({currentUser:m,isAuthenticated:p,isInitialized:!0,isLoading:!1,loginError:null,lastAuthTime:r&&h?i:a.lastAuthTime}),m?console.log(` Auth state: User is signed in (${m.email})`,d?"(offline grace period)":h?"(verified)":"(unverified)"):console.log(" Auth state: User is signed out")}))}),{name:"auth-storage",partialize:n=>({isAuthenticated:n.isAuthenticated,currentUser:n.currentUser,lastAuthTime:n.lastAuthTime,offlineGracePeriod:n.offlineGracePeriod,lastVerificationEmailSent:n.lastVerificationEmailSent})})),Mn=Object.freeze(Object.defineProperty({__proto__:null,useAuthStore:Yi},Symbol.toStringTag,{value:"Module"})),D4=[{id:"length",label:"Minimum 12 characters",regex:/^.{12,}$/},{id:"uppercase",label:"At least one uppercase letter (A-Z)",regex:/[A-Z]/},{id:"lowercase",label:"At least one lowercase letter (a-z)",regex:/[a-z]/},{id:"number",label:"At least one number (0-9)",regex:/\d/},{id:"special",label:"At least one special character (!@#$%^&*)",regex:/[!@#$%^&*]/}],nH=n=>{if(!n)return{score:0,level:"weak",color:"text-gray-400",label:"Enter password"};const r=D4.map(c=>({...c,met:c.regex.test(n)})).filter(c=>c.met).length;let i,a,o;return r<=1?(i="weak",a="text-red-500",o="Weak"):r<=3?(i="medium",a="text-yellow-500",o="Medium"):r===4?(i="strong",a="text-blue-500",o="Strong"):(i="very-strong",a="text-green-500",o="Very Strong"),{score:r,level:i,color:a,label:o}},hE=n=>{const e=D4.map(i=>({...i,met:i.regex.test(n)})),t=nH(n),r=e.every(i=>i.met);return{requirements:e,strength:t,isValid:r,isEmpty:!n.trim()}},rH=({password:n,className:e=""})=>{const{strength:t,isEmpty:r}=hE(n);return r?null:y.jsxs("div",{className:`flex items-center gap-2 ${e}`,children:[y.jsx("div",{className:"flex-1",children:y.jsx("div",{className:"flex gap-1",children:[1,2,3,4].map(i=>y.jsx("div",{className:`h-1 flex-1 rounded-full ${i<=t.score?t.score<=1?"bg-red-500":t.score<=3?"bg-yellow-500":t.score===4?"bg-blue-500":"bg-green-500":"bg-gray-200 dark:bg-gray-700"}`},i))})}),y.jsx("span",{className:`text-sm font-medium ${t.color}`,children:t.label})]})},iH=({password:n,className:e=""})=>{const{requirements:t,isEmpty:r}=hE(n);return r?null:y.jsx("div",{className:`space-y-1 ${e}`,children:t.map(i=>y.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.met?y.jsx(nL,{className:"h-4 w-4 text-green-500 flex-shrink-0"}):y.jsx(aw,{className:"h-4 w-4 text-red-500 flex-shrink-0"}),y.jsx("span",{className:i.met?"text-green-700 dark:text-green-300":"text-gray-600 dark:text-gray-400",children:i.label})]},i.id))})},aH=()=>{const[n,e]=F.useState(""),[t,r]=F.useState(""),[i,a]=F.useState(""),[o,c]=F.useState(!1),[u,d]=F.useState(!1),[h,p]=F.useState(!1),[m,b]=F.useState(!1),{login:_,register:w,sendPasswordReset:S,isLoading:T,loginError:C,clearError:R}=Yi(),j=hE(t),z=async I=>{if(I.preventDefault(),R(),n.trim()&&t.trim())if(u){if(!i.trim()||!j.isValid)return;await w(n.trim(),t,i.trim())}else await _(n.trim(),t)},V=async I=>{I.preventDefault(),n.trim()&&await S(n.trim())&&b(!0)};return F.useEffect(()=>{e(""),r(""),a(""),b(!1)},[u,h]),y.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:y.jsxs("div",{className:"max-w-md w-full space-y-8",children:[y.jsx("div",{className:"text-center",children:y.jsxs("div",{className:"flex flex-col items-center gap-3 mb-2",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"Personal Budget Logo",className:"w-10 h-10"}),y.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"Personal Budget"})]}),y.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Simple envelope budgeting for personal finance"})]})}),y.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:h?y.jsxs("form",{onSubmit:V,className:"space-y-6",children:[y.jsxs("div",{className:"text-center mb-2",children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Reset Password"}),y.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Enter your email and we'll send you a link to reset your password."})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"reset-email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),y.jsxs("div",{className:"relative",children:[y.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:y.jsx(gx,{className:"h-5 w-5 text-gray-400"})}),y.jsx("input",{id:"reset-email",type:"email",value:n,onChange:I=>e(I.target.value),className:"w-full pl-10 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"email"})]})]}),m?y.jsxs("div",{className:"text-center py-4",children:[y.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 dark:bg-green-900/30",children:y.jsx(gx,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),y.jsx("h3",{className:"mt-3 text-lg font-medium text-gray-900 dark:text-white",children:"Check your email"}),y.jsxs("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:["We've sent a password reset link to ",y.jsx("span",{className:"font-medium",children:n})]}),y.jsxs("button",{type:"button",onClick:()=>p(!1),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[y.jsx(jh,{className:"-ml-1 mr-2 h-4 w-4"}),"Back to login"]})]}):y.jsxs(y.Fragment,{children:[y.jsx("button",{type:"submit",disabled:T||!n.trim(),className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?"Sending...":"Send Reset Link"}),y.jsx("div",{className:"mt-4 text-center",children:y.jsxs("button",{type:"button",onClick:()=>p(!1),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:[y.jsx(jh,{className:"inline-block h-4 w-4 -ml-1 mr-1"}),"Back to login"]})})]})]}):y.jsxs("form",{onSubmit:z,className:"space-y-6",children:[y.jsxs("div",{className:"text-center mb-6",children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:u?"Create Account":"Sign In"}),y.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:u?"Create a new account to get started":"Sign in to your account"})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),y.jsx("input",{id:"email",type:"email",value:n,onChange:I=>e(I.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"username"})]}),u&&y.jsxs("div",{children:[y.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Display Name"}),y.jsx("input",{id:"displayName",type:"text",value:i,onChange:I=>a(I.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your display name",required:!0,disabled:T})]}),y.jsxs("div",{children:[y.jsxs("div",{className:"flex items-center justify-between mb-2",children:[y.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"}),!u&&y.jsx("button",{type:"button",onClick:()=>p(!0),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:"Forgot password?"})]}),y.jsxs("div",{className:"relative",children:[y.jsx("input",{id:"password",type:o?"text":"password",value:t,onChange:I=>r(I.target.value),className:`w-full px-3 py-2 pr-10 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white ${u&&t&&!j.isValid?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"Enter your password",required:!0,disabled:T,autoComplete:u?"new-password":"current-password"}),y.jsx("button",{type:"button",onClick:()=>c(!o),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none",disabled:T,children:o?y.jsx(bL,{className:"h-5 w-5"}):y.jsx(_L,{className:"h-5 w-5"})})]}),u&&t&&y.jsx("div",{className:"mt-2",children:y.jsx(rH,{password:t})}),u&&t&&y.jsx("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-md",children:y.jsx(iH,{password:t})})]}),C&&y.jsxs("div",{className:"text-red-600 dark:text-red-400 text-sm text-center bg-red-50 dark:bg-red-900/20 p-3 rounded-md",children:[C,C.includes("verify your email")&&y.jsx("div",{className:"mt-3",children:y.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Please check your email and click the verification link to continue."})})]}),y.jsx("button",{type:"submit",disabled:T||!n.trim()||!t.trim()||u&&!i.trim()||u&&!j.isValid,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?u?"Creating Account...":"Signing in...":u?"Create Account":"Sign In"}),y.jsx("div",{className:"mt-6 text-center",children:y.jsxs("button",{type:"button",onClick:()=>{d(!u),p(!1)},className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",disabled:T,children:[y.jsx(s9,{className:"h-4 w-4"}),u?"Already have an account? Sign In":"Don't have an account? Sign Up"]})})]})})]})})},k4=()=>{const[n,e]=F.useState(!1),[t,r]=F.useState(!1),{currentUser:i,resendEmailVerification:a,logout:o,loginError:c}=Yi();F.useEffect(()=>{i||console.warn("EmailVerificationView: No current user, this should not happen")},[i]);const u=async()=>{e(!0),r(!1);const h=await a();e(!1),h&&(r(!0),setTimeout(()=>r(!1),3e3))},d=async()=>{await o()};return i?y.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:y.jsxs("div",{className:"max-w-md w-full space-y-8",children:[y.jsx("div",{className:"text-center",children:y.jsx("div",{className:"flex flex-col items-center gap-3 mb-2",children:y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"House Budget Logo",className:"w-10 h-10"}),y.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"House Budget"})]})})}),y.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:y.jsxs("div",{className:"text-center",children:[y.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/30 mb-4",children:y.jsx(gx,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),y.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Check your email"}),y.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["We've sent a verification link to"," ",y.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:i.email})]}),y.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 mb-6",children:y.jsxs("div",{className:"flex items-start gap-3",children:[y.jsx(px,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),y.jsxs("div",{className:"text-left",children:[y.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium",children:"What to do next:"}),y.jsxs("ol",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1 space-y-1",children:[y.jsx("li",{children:"1. Open your email inbox"}),y.jsx("li",{children:"2. Find the email from House Budget"}),y.jsx("li",{children:'3. Click the "Verify Email" link'}),y.jsx("li",{children:"4. Return here and sign in"})]})]})]})}),c&&y.jsx("div",{className:"text-red-600 dark:text-red-400 text-sm mb-4 p-3 bg-red-50 dark:bg-red-900/20 rounded-md",children:c}),t&&y.jsx("div",{className:"text-green-600 dark:text-green-400 text-sm mb-4 p-3 bg-green-50 dark:bg-green-900/20 rounded-md",children:"Verification email sent successfully!"}),y.jsx("button",{onClick:u,disabled:n,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed mb-4 flex items-center justify-center gap-2",children:n?y.jsxs(y.Fragment,{children:[y.jsx(sd,{className:"h-4 w-4 animate-spin"}),"Sending..."]}):y.jsxs(y.Fragment,{children:[y.jsx(sd,{className:"h-4 w-4"}),"Resend verification email"]})}),y.jsxs("button",{onClick:d,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",children:[y.jsx(jh,{className:"h-4 w-4"}),"Back to sign in"]})]})}),y.jsx("div",{className:"text-center",children:y.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Didn't receive the email? Check your spam folder or try resending."})})]})}):null},N4=({message:n="Loading your budget...",showTimeout:e=!1})=>y.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex flex-col items-center justify-center px-4",children:[y.jsx("div",{className:"mb-8",children:y.jsxs("div",{className:"relative",children:[y.jsx(sd,{size:48,className:"text-blue-500 animate-spin"}),y.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:y.jsx(iw,{size:24,className:"text-blue-600 dark:text-blue-400"})})]})}),y.jsxs("div",{className:"text-center space-y-3",children:[y.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n}),y.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400 max-w-md",children:"This may take a moment on slow connections. We're fetching your budget data securely."})]}),y.jsxs("div",{className:"mt-12 w-full max-w-md space-y-4",children:[y.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("div",{className:"h-6 bg-gray-200 dark:bg-zinc-700 rounded w-24 animate-pulse"}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),y.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),y.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]})]})}),y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-zinc-800",children:[y.jsx("div",{className:"h-4 bg-gray-200 dark:bg-zinc-700 rounded w-32 mb-2 animate-pulse"}),y.jsx("div",{className:"h-8 bg-gray-200 dark:bg-zinc-700 rounded w-20 animate-pulse"})]}),y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[y.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-28 animate-pulse"}),y.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),y.jsxs("div",{className:"space-y-3",children:[y.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),y.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]}),y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[y.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-32 animate-pulse"}),y.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),y.jsxs("div",{className:"space-y-3",children:[y.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),y.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),y.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]})]}),e&&y.jsx("div",{className:"mt-8 p-4 bg-amber-50 dark:bg-amber-900/20 rounded-xl border border-amber-200 dark:border-amber-800 max-w-md",children:y.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200 text-center",children:"This is taking longer than usual. If you're on a very slow connection, this is normal. Your data will load shortly."})}),y.jsx("div",{className:"mt-8 w-full max-w-md",children:y.jsx("div",{className:"h-1 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:y.jsx("div",{className:"h-full bg-blue-500 rounded-full animate-pulse",style:{width:"60%"}})})})]}),pE=F.createContext({});function $v(n){const e=F.useRef(null);return e.current===null&&(e.current=n()),e.current}const gE=typeof window<"u",mE=gE?F.useLayoutEffect:F.useEffect,Yv=F.createContext(null);function vE(n,e){n.indexOf(e)===-1&&n.push(e)}function yE(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const Gs=(n,e,t)=>t>e?e:t<n?n:t;let bE=()=>{};const qs={},M4=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function P4(n){return typeof n=="object"&&n!==null}const O4=n=>/^0[^.\s]+$/u.test(n);function xE(n){let e;return()=>(e===void 0&&(e=n()),e)}const Ki=n=>n,sH=(n,e)=>t=>e(n(t)),Lp=(...n)=>n.reduce(sH),np=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r};class _E{constructor(){this.subscriptions=[]}add(e){return vE(this.subscriptions,e),()=>yE(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let a=0;a<i;a++){const o=this.subscriptions[a];o&&o(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Qa=n=>n*1e3,Hi=n=>n/1e3;function V4(n,e){return e?n*(1e3/e):0}const j4=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,oH=1e-7,lH=12;function cH(n,e,t,r,i){let a,o,c=0;do o=e+(t-e)/2,a=j4(o,r,i)-n,a>0?t=o:e=o;while(Math.abs(a)>oH&&++c<lH);return o}function Bp(n,e,t,r){if(n===e&&t===r)return Ki;const i=a=>cH(a,0,1,n,t);return a=>a===0||a===1?a:j4(i(a),e,r)}const z4=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,L4=n=>e=>1-n(1-e),B4=Bp(.33,1.53,.69,.99),wE=L4(B4),U4=z4(wE),F4=n=>(n*=2)<1?.5*wE(n):.5*(2-Math.pow(2,-10*(n-1))),EE=n=>1-Math.sin(Math.acos(n)),G4=L4(EE),q4=z4(EE),uH=Bp(.42,0,1,1),dH=Bp(0,0,.58,1),H4=Bp(.42,0,.58,1),fH=n=>Array.isArray(n)&&typeof n[0]!="number",$4=n=>Array.isArray(n)&&typeof n[0]=="number",hH={linear:Ki,easeIn:uH,easeInOut:H4,easeOut:dH,circIn:EE,circInOut:q4,circOut:G4,backIn:wE,backInOut:U4,backOut:B4,anticipate:F4},pH=n=>typeof n=="string",RR=n=>{if($4(n)){bE(n.length===4);const[e,t,r,i]=n;return Bp(e,t,r,i)}else if(pH(n))return hH[n];return n},Nm=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function gH(n,e){let t=new Set,r=new Set,i=!1,a=!1;const o=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function u(h){o.has(h)&&(d.schedule(h),n()),h(c)}const d={schedule:(h,p=!1,m=!1)=>{const _=m&&i?t:r;return p&&o.add(h),_.has(h)||_.add(h),h},cancel:h=>{r.delete(h),o.delete(h)},process:h=>{if(c=h,i){a=!0;return}i=!0,[t,r]=[r,t],t.forEach(u),t.clear(),i=!1,a&&(a=!1,d.process(h))}};return d}const mH=40;function Y4(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},a=()=>t=!0,o=Nm.reduce((R,j)=>(R[j]=gH(a),R),{}),{setup:c,read:u,resolveKeyframes:d,preUpdate:h,update:p,preRender:m,render:b,postRender:_}=o,w=()=>{const R=qs.useManualTiming?i.timestamp:performance.now();t=!1,qs.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(R-i.timestamp,mH),1)),i.timestamp=R,i.isProcessing=!0,c.process(i),u.process(i),d.process(i),h.process(i),p.process(i),m.process(i),b.process(i),_.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(w))},S=()=>{t=!0,r=!0,i.isProcessing||n(w)};return{schedule:Nm.reduce((R,j)=>{const z=o[j];return R[j]=(V,I=!1,A=!1)=>(t||S(),z.schedule(V,I,A)),R},{}),cancel:R=>{for(let j=0;j<Nm.length;j++)o[Nm[j]].cancel(R)},state:i,steps:o}}const{schedule:cn,cancel:ll,state:Er,steps:N1}=Y4(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ki,!0);let g0;function vH(){g0=void 0}const ri={now:()=>(g0===void 0&&ri.set(Er.isProcessing||qs.useManualTiming?Er.timestamp:performance.now()),g0),set:n=>{g0=n,queueMicrotask(vH)}},K4=n=>e=>typeof e=="string"&&e.startsWith(n),SE=K4("--"),yH=K4("var(--"),TE=n=>yH(n)?bH.test(n.split("/*")[0].trim()):!1,bH=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Fd={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},rp={...Fd,transform:n=>Gs(0,1,n)},Mm={...Fd,default:1},Th=n=>Math.round(n*1e5)/1e5,AE=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function xH(n){return n==null}const _H=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,CE=(n,e)=>t=>!!(typeof t=="string"&&_H.test(t)&&t.startsWith(n)||e&&!xH(t)&&Object.prototype.hasOwnProperty.call(t,e)),X4=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,a,o,c]=r.match(AE);return{[n]:parseFloat(i),[e]:parseFloat(a),[t]:parseFloat(o),alpha:c!==void 0?parseFloat(c):1}},wH=n=>Gs(0,255,n),M1={...Fd,transform:n=>Math.round(wH(n))},oc={test:CE("rgb","red"),parse:X4("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+M1.transform(n)+", "+M1.transform(e)+", "+M1.transform(t)+", "+Th(rp.transform(r))+")"};function EH(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const Zx={test:CE("#"),parse:EH,transform:oc.transform},Up=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Lo=Up("deg"),Za=Up("%"),it=Up("px"),SH=Up("vh"),TH=Up("vw"),DR={...Za,parse:n=>Za.parse(n)/100,transform:n=>Za.transform(n*100)},Uu={test:CE("hsl","hue"),parse:X4("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+Za.transform(Th(e))+", "+Za.transform(Th(t))+", "+Th(rp.transform(r))+")"},$n={test:n=>oc.test(n)||Zx.test(n)||Uu.test(n),parse:n=>oc.test(n)?oc.parse(n):Uu.test(n)?Uu.parse(n):Zx.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?oc.transform(n):Uu.transform(n),getAnimatableNone:n=>{const e=$n.parse(n);return e.alpha=0,$n.transform(e)}},AH=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function CH(n){return isNaN(n)&&typeof n=="string"&&(n.match(AE)?.length||0)+(n.match(AH)?.length||0)>0}const W4="number",Q4="color",IH="var",RH="var(",kR="${}",DH=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ip(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let a=0;const c=e.replace(DH,u=>($n.test(u)?(r.color.push(a),i.push(Q4),t.push($n.parse(u))):u.startsWith(RH)?(r.var.push(a),i.push(IH),t.push(u)):(r.number.push(a),i.push(W4),t.push(parseFloat(u))),++a,kR)).split(kR);return{values:t,split:c,indexes:r,types:i}}function Z4(n){return ip(n).values}function J4(n){const{split:e,types:t}=ip(n),r=e.length;return i=>{let a="";for(let o=0;o<r;o++)if(a+=e[o],i[o]!==void 0){const c=t[o];c===W4?a+=Th(i[o]):c===Q4?a+=$n.transform(i[o]):a+=i[o]}return a}}const kH=n=>typeof n=="number"?0:$n.test(n)?$n.getAnimatableNone(n):n;function NH(n){const e=Z4(n);return J4(n)(e.map(kH))}const cl={test:CH,parse:Z4,createTransformer:J4,getAnimatableNone:NH};function P1(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function MH({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,a=0,o=0;if(!e)i=a=o=t;else{const c=t<.5?t*(1+e):t+e-t*e,u=2*t-c;i=P1(u,c,n+1/3),a=P1(u,c,n),o=P1(u,c,n-1/3)}return{red:Math.round(i*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:r}}function Q0(n,e){return t=>t>0?e:n}const gn=(n,e,t)=>n+(e-n)*t,O1=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},PH=[Zx,oc,Uu],OH=n=>PH.find(e=>e.test(n));function NR(n){const e=OH(n);if(!e)return!1;let t=e.parse(n);return e===Uu&&(t=MH(t)),t}const MR=(n,e)=>{const t=NR(n),r=NR(e);if(!t||!r)return Q0(n,e);const i={...t};return a=>(i.red=O1(t.red,r.red,a),i.green=O1(t.green,r.green,a),i.blue=O1(t.blue,r.blue,a),i.alpha=gn(t.alpha,r.alpha,a),oc.transform(i))},Jx=new Set(["none","hidden"]);function VH(n,e){return Jx.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function jH(n,e){return t=>gn(n,e,t)}function IE(n){return typeof n=="number"?jH:typeof n=="string"?TE(n)?Q0:$n.test(n)?MR:BH:Array.isArray(n)?eO:typeof n=="object"?$n.test(n)?MR:zH:Q0}function eO(n,e){const t=[...n],r=t.length,i=n.map((a,o)=>IE(a)(a,e[o]));return a=>{for(let o=0;o<r;o++)t[o]=i[o](a);return t}}function zH(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=IE(n[i])(n[i],e[i]));return i=>{for(const a in r)t[a]=r[a](i);return t}}function LH(n,e){const t=[],r={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const a=e.types[i],o=n.indexes[a][r[a]],c=n.values[o]??0;t[i]=c,r[a]++}return t}const BH=(n,e)=>{const t=cl.createTransformer(e),r=ip(n),i=ip(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?Jx.has(n)&&!i.values.length||Jx.has(e)&&!r.values.length?VH(n,e):Lp(eO(LH(r,i),i.values),t):Q0(n,e)};function tO(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?gn(n,e,t):IE(n)(n,e)}const UH=n=>{const e=({timestamp:t})=>n(t);return{start:(t=!0)=>cn.update(e,t),stop:()=>ll(e),now:()=>Er.isProcessing?Er.timestamp:ri.now()}},nO=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let a=0;a<i;a++)r+=Math.round(n(a/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},Z0=2e4;function RE(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<Z0;)e+=t,r=n.next(e);return e>=Z0?1/0:e}function FH(n,e=100,t){const r=t({...n,keyframes:[0,e]}),i=Math.min(RE(r),Z0);return{type:"keyframes",ease:a=>r.next(i*a).value/e,duration:Hi(i)}}const GH=5;function rO(n,e,t){const r=Math.max(e-GH,0);return V4(t-n(r),e-r)}const wn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},V1=.001;function qH({duration:n=wn.duration,bounce:e=wn.bounce,velocity:t=wn.velocity,mass:r=wn.mass}){let i,a,o=1-e;o=Gs(wn.minDamping,wn.maxDamping,o),n=Gs(wn.minDuration,wn.maxDuration,Hi(n)),o<1?(i=d=>{const h=d*o,p=h*n,m=h-t,b=e_(d,o),_=Math.exp(-p);return V1-m/b*_},a=d=>{const p=d*o*n,m=p*t+t,b=Math.pow(o,2)*Math.pow(d,2)*n,_=Math.exp(-p),w=e_(Math.pow(d,2),o);return(-i(d)+V1>0?-1:1)*((m-b)*_)/w}):(i=d=>{const h=Math.exp(-d*n),p=(d-t)*n+1;return-V1+h*p},a=d=>{const h=Math.exp(-d*n),p=(t-d)*(n*n);return h*p});const c=5/n,u=$H(i,a,c);if(n=Qa(n),isNaN(u))return{stiffness:wn.stiffness,damping:wn.damping,duration:n};{const d=Math.pow(u,2)*r;return{stiffness:d,damping:o*2*Math.sqrt(r*d),duration:n}}}const HH=12;function $H(n,e,t){let r=t;for(let i=1;i<HH;i++)r=r-n(r)/e(r);return r}function e_(n,e){return n*Math.sqrt(1-e*e)}const YH=["duration","bounce"],KH=["stiffness","damping","mass"];function PR(n,e){return e.some(t=>n[t]!==void 0)}function XH(n){let e={velocity:wn.velocity,stiffness:wn.stiffness,damping:wn.damping,mass:wn.mass,isResolvedFromDuration:!1,...n};if(!PR(n,KH)&&PR(n,YH))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,a=2*Gs(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:wn.mass,stiffness:i,damping:a}}else{const t=qH(n);e={...e,...t,mass:wn.mass},e.isResolvedFromDuration=!0}return e}function J0(n=wn.visualDuration,e=wn.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const a=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],c={done:!1,value:a},{stiffness:u,damping:d,mass:h,duration:p,velocity:m,isResolvedFromDuration:b}=XH({...t,velocity:-Hi(t.velocity||0)}),_=m||0,w=d/(2*Math.sqrt(u*h)),S=o-a,T=Hi(Math.sqrt(u/h)),C=Math.abs(S)<5;r||(r=C?wn.restSpeed.granular:wn.restSpeed.default),i||(i=C?wn.restDelta.granular:wn.restDelta.default);let R;if(w<1){const z=e_(T,w);R=V=>{const I=Math.exp(-w*T*V);return o-I*((_+w*T*S)/z*Math.sin(z*V)+S*Math.cos(z*V))}}else if(w===1)R=z=>o-Math.exp(-T*z)*(S+(_+T*S)*z);else{const z=T*Math.sqrt(w*w-1);R=V=>{const I=Math.exp(-w*T*V),A=Math.min(z*V,300);return o-I*((_+w*T*S)*Math.sinh(A)+z*S*Math.cosh(A))/z}}const j={calculatedDuration:b&&p||null,next:z=>{const V=R(z);if(b)c.done=z>=p;else{let I=z===0?_:0;w<1&&(I=z===0?Qa(_):rO(R,z,V));const A=Math.abs(I)<=r,k=Math.abs(o-V)<=i;c.done=A&&k}return c.value=c.done?o:V,c},toString:()=>{const z=Math.min(RE(j),Z0),V=nO(I=>j.next(z*I).value,z,30);return z+"ms "+V},toTransition:()=>{}};return j}J0.applyToOptions=n=>{const e=FH(n,100,J0);return n.ease=e.ease,n.duration=Qa(e.duration),n.type="keyframes",n};function t_({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:a=500,modifyTarget:o,min:c,max:u,restDelta:d=.5,restSpeed:h}){const p=n[0],m={done:!1,value:p},b=A=>c!==void 0&&A<c||u!==void 0&&A>u,_=A=>c===void 0?u:u===void 0||Math.abs(c-A)<Math.abs(u-A)?c:u;let w=t*e;const S=p+w,T=o===void 0?S:o(S);T!==S&&(w=T-p);const C=A=>-w*Math.exp(-A/r),R=A=>T+C(A),j=A=>{const k=C(A),O=R(A);m.done=Math.abs(k)<=d,m.value=m.done?T:O};let z,V;const I=A=>{b(m.value)&&(z=A,V=J0({keyframes:[m.value,_(m.value)],velocity:rO(R,A,m.value),damping:i,stiffness:a,restDelta:d,restSpeed:h}))};return I(0),{calculatedDuration:null,next:A=>{let k=!1;return!V&&z===void 0&&(k=!0,j(A),I(A)),z!==void 0&&A>=z?V.next(A-z):(!k&&j(A),m)}}}function WH(n,e,t){const r=[],i=t||qs.mix||tO,a=n.length-1;for(let o=0;o<a;o++){let c=i(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||Ki:e;c=Lp(u,c)}r.push(c)}return r}function QH(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const a=n.length;if(bE(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[a-1]&&(n=[...n].reverse(),e=[...e].reverse());const c=WH(e,r,i),u=c.length,d=h=>{if(o&&h<n[0])return e[0];let p=0;if(u>1)for(;p<n.length-2&&!(h<n[p+1]);p++);const m=np(n[p],n[p+1],h);return c[p](m)};return t?h=>d(Gs(n[0],n[a-1],h)):d}function ZH(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=np(0,e,r);n.push(gn(t,1,i))}}function JH(n){const e=[0];return ZH(e,n.length-1),e}function e$(n,e){return n.map(t=>t*e)}function t$(n,e){return n.map(()=>e||H4).splice(0,n.length-1)}function Ah({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=fH(r)?r.map(RR):RR(r),a={done:!1,value:e[0]},o=e$(t&&t.length===e.length?t:JH(e),n),c=QH(o,e,{ease:Array.isArray(i)?i:t$(e,i)});return{calculatedDuration:n,next:u=>(a.value=c(u),a.done=u>=n,a)}}const n$=n=>n!==null;function DE(n,{repeat:e,repeatType:t="loop"},r,i=1){const a=n.filter(n$),c=i<0||e&&t!=="loop"&&e%2===1?0:a.length-1;return!c||r===void 0?a[c]:r}const r$={decay:t_,inertia:t_,tween:Ah,keyframes:Ah,spring:J0};function iO(n){typeof n.type=="string"&&(n.type=r$[n.type])}class kE{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const i$=n=>n/100;class NE extends kE{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:t}=this.options;t&&t.updatedAt!==ri.now()&&this.tick(ri.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;iO(e);const{type:t=Ah,repeat:r=0,repeatDelay:i=0,repeatType:a,velocity:o=0}=e;let{keyframes:c}=e;const u=t||Ah;u!==Ah&&typeof c[0]!="number"&&(this.mixKeyframes=Lp(i$,tO(c[0],c[1])),c=[0,100]);const d=u({...e,keyframes:c});a==="mirror"&&(this.mirroredGenerator=u({...e,keyframes:[...c].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=RE(d));const{calculatedDuration:h}=d;this.calculatedDuration=h,this.resolvedDuration=h+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=d}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:r,totalDuration:i,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:c,calculatedDuration:u}=this;if(this.startTime===null)return r.next(0);const{delay:d=0,keyframes:h,repeat:p,repeatType:m,repeatDelay:b,type:_,onUpdate:w,finalKeyframe:S}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const T=this.currentTime-d*(this.playbackSpeed>=0?1:-1),C=this.playbackSpeed>=0?T<0:T>i;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let R=this.currentTime,j=r;if(p){const A=Math.min(this.currentTime,i)/c;let k=Math.floor(A),O=A%1;!O&&A>=1&&(O=1),O===1&&k--,k=Math.min(k,p+1),!!(k%2)&&(m==="reverse"?(O=1-O,b&&(O-=b/c)):m==="mirror"&&(j=o)),R=Gs(0,1,O)*c}const z=C?{done:!1,value:h[0]}:j.next(R);a&&(z.value=a(z.value));let{done:V}=z;!C&&u!==null&&(V=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const I=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&V);return I&&_!==t_&&(z.value=DE(h,this.options,S,this.speed)),w&&w(z.value),I&&this.finish(),z}then(e,t){return this.finished.then(e,t)}get duration(){return Hi(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Hi(e)}get time(){return Hi(this.currentTime)}set time(e){e=Qa(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(ri.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Hi(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=UH,startTime:t}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=t??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ri.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function a$(n){for(let e=1;e<n.length;e++)n[e]??(n[e]=n[e-1])}const lc=n=>n*180/Math.PI,n_=n=>{const e=lc(Math.atan2(n[1],n[0]));return r_(e)},s$={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:n_,rotateZ:n_,skewX:n=>lc(Math.atan(n[1])),skewY:n=>lc(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},r_=n=>(n=n%360,n<0&&(n+=360),n),OR=n_,VR=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),jR=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),o$={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:VR,scaleY:jR,scale:n=>(VR(n)+jR(n))/2,rotateX:n=>r_(lc(Math.atan2(n[6],n[5]))),rotateY:n=>r_(lc(Math.atan2(-n[2],n[0]))),rotateZ:OR,rotate:OR,skewX:n=>lc(Math.atan(n[4])),skewY:n=>lc(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function i_(n){return n.includes("scale")?1:0}function a_(n,e){if(!n||n==="none")return i_(e);const t=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(t)r=o$,i=t;else{const c=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=s$,i=c}if(!i)return i_(e);const a=r[e],o=i[1].split(",").map(c$);return typeof a=="function"?a(o):o[a]}const l$=(n,e)=>{const{transform:t="none"}=getComputedStyle(n);return a_(t,e)};function c$(n){return parseFloat(n.trim())}const Gd=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],qd=new Set(Gd),zR=n=>n===Fd||n===it,u$=new Set(["x","y","z"]),d$=Gd.filter(n=>!u$.has(n));function f$(n){const e=[];return d$.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const mc={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:(n,{transform:e})=>a_(e,"x"),y:(n,{transform:e})=>a_(e,"y")};mc.translateX=mc.x;mc.translateY=mc.y;const vc=new Set;let s_=!1,o_=!1,l_=!1;function aO(){if(o_){const n=Array.from(vc).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=f$(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([a,o])=>{r.getValue(a)?.set(o)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}o_=!1,s_=!1,vc.forEach(n=>n.complete(l_)),vc.clear()}function sO(){vc.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(o_=!0)})}function h$(){l_=!0,sO(),aO(),l_=!1}class ME{constructor(e,t,r,i,a,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(vc.add(this),s_||(s_=!0,cn.read(sO),cn.resolveKeyframes(aO))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;if(e[0]===null){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&t){const c=r.readValue(t,o);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}a$(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),vc.delete(this)}cancel(){this.state==="scheduled"&&(vc.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const p$=n=>n.startsWith("--");function g$(n,e,t){p$(e)?n.style.setProperty(e,t):n.style[e]=t}const m$=xE(()=>window.ScrollTimeline!==void 0),v$={};function y$(n,e){const t=xE(n);return()=>v$[e]??t()}const oO=y$(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),dh=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,LR={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:dh([0,.65,.55,1]),circOut:dh([.55,0,1,.45]),backIn:dh([.31,.01,.66,-.59]),backOut:dh([.33,1.53,.69,.99])};function lO(n,e){if(n)return typeof n=="function"?oO()?nO(n,e):"ease-out":$4(n)?dh(n):Array.isArray(n)?n.map(t=>lO(t,e)||LR.easeOut):LR[n]}function b$(n,e,t,{delay:r=0,duration:i=300,repeat:a=0,repeatType:o="loop",ease:c="easeOut",times:u}={},d=void 0){const h={[e]:t};u&&(h.offset=u);const p=lO(c,i);Array.isArray(p)&&(h.easing=p);const m={delay:r,duration:i,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};return d&&(m.pseudoElement=d),n.animate(h,m)}function cO(n){return typeof n=="function"&&"applyToOptions"in n}function x$({type:n,...e}){return cO(n)&&oO()?n.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class _$ extends kE{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:r,keyframes:i,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:c,onComplete:u}=e;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=e,bE(typeof e.type!="string");const d=x$(e);this.animation=b$(t,r,i,d,a),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const h=DE(i,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(h):g$(t,r,h),this.animation.cancel()}u?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return Hi(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Hi(e)}get time(){return Hi(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=Qa(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&m$()?(this.animation.timeline=e,Ki):t(this)}}const uO={anticipate:F4,backInOut:U4,circInOut:q4};function w$(n){return n in uO}function E$(n){typeof n.ease=="string"&&w$(n.ease)&&(n.ease=uO[n.ease])}const BR=10;class S$ extends _${constructor(e){E$(e),iO(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:r,onComplete:i,element:a,...o}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const c=new NE({...o,autoplay:!1}),u=Qa(this.finishedTime??this.time);t.setWithVelocity(c.sample(u-BR).value,c.sample(u).value,BR),c.stop()}}const UR=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(cl.test(n)||n==="0")&&!n.startsWith("url("));function T$(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function A$(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const a=n[n.length-1],o=UR(i,e),c=UR(a,e);return!o||!c?!1:T$(n)||(t==="spring"||cO(t))&&r}function c_(n){n.duration=0,n.type="keyframes"}const C$=new Set(["opacity","clipPath","filter","transform"]),I$=xE(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function R$(n){const{motionValue:e,name:t,repeatDelay:r,repeatType:i,damping:a,type:o}=n;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:d}=e.owner.getProps();return I$()&&t&&C$.has(t)&&(t!=="transform"||!d)&&!u&&!r&&i!=="mirror"&&a!==0&&o!=="inertia"}const D$=40;class k$ extends kE{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:o="loop",keyframes:c,name:u,motionValue:d,element:h,...p}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=ri.now();const m={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:a,repeatType:o,name:u,motionValue:d,element:h,...p},b=h?.KeyframeResolver||ME;this.keyframeResolver=new b(c,(_,w,S)=>this.onKeyframesResolved(_,w,m,!S),u,d,h),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,t,r,i){this.keyframeResolver=void 0;const{name:a,type:o,velocity:c,delay:u,isHandoff:d,onUpdate:h}=r;this.resolvedAt=ri.now(),A$(e,a,o,c)||((qs.instantAnimations||!u)&&h?.(DE(e,r,t)),e[0]=e[e.length-1],c_(r),r.repeat=0);const m={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>D$?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...r,keyframes:e},b=!d&&R$(m)?new S$({...m,element:m.motionValue.owner.current}):new NE(m);b.finished.then(()=>this.notifyFinished()).catch(Ki),this.pendingTimeline&&(this.stopTimeline=b.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=b}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),h$()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const N$=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function M$(n){const e=N$.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function dO(n,e,t=1){const[r,i]=M$(n);if(!r)return;const a=window.getComputedStyle(e).getPropertyValue(r);if(a){const o=a.trim();return M4(o)?parseFloat(o):o}return TE(i)?dO(i,e,t+1):i}function PE(n,e){return n?.[e]??n?.default??n}const fO=new Set(["width","height","top","left","right","bottom",...Gd]),P$={test:n=>n==="auto",parse:n=>n},hO=n=>e=>e.test(n),pO=[Fd,it,Za,Lo,TH,SH,P$],FR=n=>pO.find(hO(n));function O$(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||O4(n):!0}const V$=new Set(["brightness","contrast","saturate","opacity"]);function j$(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(AE)||[];if(!r)return n;const i=t.replace(r,"");let a=V$.has(e)?1:0;return r!==t&&(a*=100),e+"("+a+i+")"}const z$=/\b([a-z-]*)\(.*?\)/gu,u_={...cl,getAnimatableNone:n=>{const e=n.match(z$);return e?e.map(j$).join(" "):n}},GR={...Fd,transform:Math.round},L$={rotate:Lo,rotateX:Lo,rotateY:Lo,rotateZ:Lo,scale:Mm,scaleX:Mm,scaleY:Mm,scaleZ:Mm,skew:Lo,skewX:Lo,skewY:Lo,distance:it,translateX:it,translateY:it,translateZ:it,x:it,y:it,z:it,perspective:it,transformPerspective:it,opacity:rp,originX:DR,originY:DR,originZ:it},OE={borderWidth:it,borderTopWidth:it,borderRightWidth:it,borderBottomWidth:it,borderLeftWidth:it,borderRadius:it,radius:it,borderTopLeftRadius:it,borderTopRightRadius:it,borderBottomRightRadius:it,borderBottomLeftRadius:it,width:it,maxWidth:it,height:it,maxHeight:it,top:it,right:it,bottom:it,left:it,padding:it,paddingTop:it,paddingRight:it,paddingBottom:it,paddingLeft:it,margin:it,marginTop:it,marginRight:it,marginBottom:it,marginLeft:it,backgroundPositionX:it,backgroundPositionY:it,...L$,zIndex:GR,fillOpacity:rp,strokeOpacity:rp,numOctaves:GR},B$={...OE,color:$n,backgroundColor:$n,outlineColor:$n,fill:$n,stroke:$n,borderColor:$n,borderTopColor:$n,borderRightColor:$n,borderBottomColor:$n,borderLeftColor:$n,filter:u_,WebkitFilter:u_},gO=n=>B$[n];function mO(n,e){let t=gO(n);return t!==u_&&(t=cl),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const U$=new Set(["auto","none","0"]);function F$(n,e,t){let r=0,i;for(;r<n.length&&!i;){const a=n[r];typeof a=="string"&&!U$.has(a)&&ip(a).values.length&&(i=n[r]),r++}if(i&&t)for(const a of e)n[a]=mO(t,i)}class G$ extends ME{constructor(e,t,r,i,a){super(e,t,r,i,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let d=e[u];if(typeof d=="string"&&(d=d.trim(),TE(d))){const h=dO(d,t.current);h!==void 0&&(e[u]=h),u===e.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!fO.has(r)||e.length!==2)return;const[i,a]=e,o=FR(i),c=FR(a);if(o!==c)if(zR(o)&&zR(c))for(let u=0;u<e.length;u++){const d=e[u];typeof d=="string"&&(e[u]=parseFloat(d))}else mc[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)(e[i]===null||O$(e[i]))&&r.push(i);r.length&&F$(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=mc[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){const{element:e,name:t,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const i=e.getValue(t);i&&i.jump(this.measuredOrigin,!1);const a=r.length-1,o=r[a];r[a]=mc[t](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([c,u])=>{e.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function q$(n,e,t){if(n instanceof EventTarget)return[n];if(typeof n=="string"){let r=document;const i=t?.[n]??r.querySelectorAll(n);return i?Array.from(i):[]}return Array.from(n)}const vO=(n,e)=>e&&typeof n=="number"?e.transform(n):n;function yO(n){return P4(n)&&"offsetHeight"in n}const qR=30,H$=n=>!isNaN(parseFloat(n));class $${constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const i=ri.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=ri.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=H$(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new _E);const r=this.events[e].add(t);return e==="change"?()=>{r(),cn.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ri.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>qR)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,qR);return V4(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function wd(n,e){return new $$(n,e)}const{schedule:VE}=Y4(queueMicrotask,!1),la={x:!1,y:!1};function bO(){return la.x||la.y}function Y$(n){return n==="x"||n==="y"?la[n]?null:(la[n]=!0,()=>{la[n]=!1}):la.x||la.y?null:(la.x=la.y=!0,()=>{la.x=la.y=!1})}function xO(n,e){const t=q$(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function HR(n){return!(n.pointerType==="touch"||bO())}function K$(n,e,t={}){const[r,i,a]=xO(n,t),o=c=>{if(!HR(c))return;const{target:u}=c,d=e(u,c);if(typeof d!="function"||!u)return;const h=p=>{HR(p)&&(d(p),u.removeEventListener("pointerleave",h))};u.addEventListener("pointerleave",h,i)};return r.forEach(c=>{c.addEventListener("pointerenter",o,i)}),a}const _O=(n,e)=>e?n===e?!0:_O(n,e.parentElement):!1,jE=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,X$=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function W$(n){return X$.has(n.tagName)||n.tabIndex!==-1}const m0=new WeakSet;function $R(n){return e=>{e.key==="Enter"&&n(e)}}function j1(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const Q$=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=$R(()=>{if(m0.has(t))return;j1(t,"down");const i=$R(()=>{j1(t,"up")}),a=()=>j1(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",a,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function YR(n){return jE(n)&&!bO()}function Z$(n,e,t={}){const[r,i,a]=xO(n,t),o=c=>{const u=c.currentTarget;if(!YR(c))return;m0.add(u);const d=e(u,c),h=(b,_)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",m),m0.has(u)&&m0.delete(u),YR(b)&&typeof d=="function"&&d(b,{success:_})},p=b=>{h(b,u===window||u===document||t.useGlobalTarget||_O(u,b.target))},m=b=>{h(b,!1)};window.addEventListener("pointerup",p,i),window.addEventListener("pointercancel",m,i)};return r.forEach(c=>{(t.useGlobalTarget?window:c).addEventListener("pointerdown",o,i),yO(c)&&(c.addEventListener("focus",d=>Q$(d,i)),!W$(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),a}function wO(n){return P4(n)&&"ownerSVGElement"in n}function J$(n){return wO(n)&&n.tagName==="svg"}const Nr=n=>!!(n&&n.getVelocity),eY=[...pO,$n,cl],tY=n=>eY.find(hO(n)),zE=F.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function KR(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function nY(...n){return e=>{let t=!1;const r=n.map(i=>{const a=KR(i,e);return!t&&typeof a=="function"&&(t=!0),a});if(t)return()=>{for(let i=0;i<r.length;i++){const a=r[i];typeof a=="function"?a():KR(n[i],null)}}}}function rY(...n){return F.useCallback(nY(...n),n)}class iY extends F.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=t.offsetParent,i=yO(r)&&r.offsetWidth||0,a=this.props.sizeRef.current;a.height=t.offsetHeight||0,a.width=t.offsetWidth||0,a.top=t.offsetTop,a.left=t.offsetLeft,a.right=i-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function aY({children:n,isPresent:e,anchorX:t,root:r}){const i=F.useId(),a=F.useRef(null),o=F.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=F.useContext(zE),u=rY(a,n?.ref);return F.useInsertionEffect(()=>{const{width:d,height:h,top:p,left:m,right:b}=o.current;if(e||!a.current||!d||!h)return;const _=t==="left"?`left: ${m}`:`right: ${b}`;a.current.dataset.motionPopId=i;const w=document.createElement("style");c&&(w.nonce=c);const S=r??document.head;return S.appendChild(w),w.sheet&&w.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${h}px !important;
            ${_}px !important;
            top: ${p}px !important;
          }
        `),()=>{S.contains(w)&&S.removeChild(w)}},[e]),y.jsx(iY,{isPresent:e,childRef:a,sizeRef:o,children:F.cloneElement(n,{ref:u})})}const sY=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:a,mode:o,anchorX:c,root:u})=>{const d=$v(oY),h=F.useId();let p=!0,m=F.useMemo(()=>(p=!1,{id:h,initial:e,isPresent:t,custom:i,onExitComplete:b=>{d.set(b,!0);for(const _ of d.values())if(!_)return;r&&r()},register:b=>(d.set(b,!1),()=>d.delete(b))}),[t,d,r]);return a&&p&&(m={...m}),F.useMemo(()=>{d.forEach((b,_)=>d.set(_,!1))},[t]),F.useEffect(()=>{!t&&!d.size&&r&&r()},[t]),o==="popLayout"&&(n=y.jsx(aY,{isPresent:t,anchorX:c,root:u,children:n})),y.jsx(Yv.Provider,{value:m,children:n})};function oY(){return new Map}function EO(n=!0){const e=F.useContext(Yv);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,a=F.useId();F.useEffect(()=>{if(n)return i(a)},[n]);const o=F.useCallback(()=>n&&r&&r(a),[a,r,n]);return!t&&r?[!1,o]:[!0]}const Pm=n=>n.key||"";function XR(n){const e=[];return F.Children.forEach(n,t=>{F.isValidElement(t)&&e.push(t)}),e}const xi=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:a="sync",propagate:o=!1,anchorX:c="left",root:u})=>{const[d,h]=EO(o),p=F.useMemo(()=>XR(n),[n]),m=o&&!d?[]:p.map(Pm),b=F.useRef(!0),_=F.useRef(p),w=$v(()=>new Map),[S,T]=F.useState(p),[C,R]=F.useState(p);mE(()=>{b.current=!1,_.current=p;for(let V=0;V<C.length;V++){const I=Pm(C[V]);m.includes(I)?w.delete(I):w.get(I)!==!0&&w.set(I,!1)}},[C,m.length,m.join("-")]);const j=[];if(p!==S){let V=[...p];for(let I=0;I<C.length;I++){const A=C[I],k=Pm(A);m.includes(k)||(V.splice(I,0,A),j.push(A))}return a==="wait"&&j.length&&(V=j),R(XR(V)),T(p),null}const{forceRender:z}=F.useContext(pE);return y.jsx(y.Fragment,{children:C.map(V=>{const I=Pm(V),A=o&&!d?!1:p===C||m.includes(I),k=()=>{if(w.has(I))w.set(I,!0);else return;let O=!0;w.forEach(L=>{L||(O=!1)}),O&&(z?.(),R(_.current),o&&h?.(),r&&r())};return y.jsx(sY,{isPresent:A,initial:!b.current||t?void 0:!1,custom:e,presenceAffectsLayout:i,mode:a,root:u,onExitComplete:A?void 0:k,anchorX:c,children:V},I)})})},SO=F.createContext({strict:!1}),WR={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ed={};for(const n in WR)Ed[n]={isEnabled:e=>WR[n].some(t=>!!e[t])};function lY(n){for(const e in n)Ed[e]={...Ed[e],...n[e]}}const cY=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function ev(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||cY.has(n)}let TO=n=>!ev(n);function uY(n){typeof n=="function"&&(TO=e=>e.startsWith("on")?!ev(e):n(e))}try{uY(require("@emotion/is-prop-valid").default)}catch{}function dY(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(TO(i)||t===!0&&ev(i)||!e&&!ev(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}const Kv=F.createContext({});function Xv(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function ap(n){return typeof n=="string"||Array.isArray(n)}const LE=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],BE=["initial",...LE];function Wv(n){return Xv(n.animate)||BE.some(e=>ap(n[e]))}function AO(n){return!!(Wv(n)||n.variants)}function fY(n,e){if(Wv(n)){const{initial:t,animate:r}=n;return{initial:t===!1||ap(t)?t:void 0,animate:ap(r)?r:void 0}}return n.inherit!==!1?e:{}}function hY(n){const{initial:e,animate:t}=fY(n,F.useContext(Kv));return F.useMemo(()=>({initial:e,animate:t}),[QR(e),QR(t)])}function QR(n){return Array.isArray(n)?n.join(" "):n}const sp={};function pY(n){for(const e in n)sp[e]=n[e],SE(e)&&(sp[e].isCSSVariable=!0)}function CO(n,{layout:e,layoutId:t}){return qd.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!sp[n]||n==="opacity")}const gY={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},mY=Gd.length;function vY(n,e,t){let r="",i=!0;for(let a=0;a<mY;a++){const o=Gd[a],c=n[o];if(c===void 0)continue;let u=!0;if(typeof c=="number"?u=c===(o.startsWith("scale")?1:0):u=parseFloat(c)===0,!u||t){const d=vO(c,OE[o]);if(!u){i=!1;const h=gY[o]||o;r+=`${h}(${d}) `}t&&(e[o]=d)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function UE(n,e,t){const{style:r,vars:i,transformOrigin:a}=n;let o=!1,c=!1;for(const u in e){const d=e[u];if(qd.has(u)){o=!0;continue}else if(SE(u)){i[u]=d;continue}else{const h=vO(d,OE[u]);u.startsWith("origin")?(c=!0,a[u]=h):r[u]=h}}if(e.transform||(o||t?r.transform=vY(e,n.transform,t):r.transform&&(r.transform="none")),c){const{originX:u="50%",originY:d="50%",originZ:h=0}=a;r.transformOrigin=`${u} ${d} ${h}`}}const FE=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function IO(n,e,t){for(const r in e)!Nr(e[r])&&!CO(r,t)&&(n[r]=e[r])}function yY({transformTemplate:n},e){return F.useMemo(()=>{const t=FE();return UE(t,e,n),Object.assign({},t.vars,t.style)},[e])}function bY(n,e){const t=n.style||{},r={};return IO(r,t,n),Object.assign(r,yY(n,e)),r}function xY(n,e){const t={},r=bY(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}const _Y={offset:"stroke-dashoffset",array:"stroke-dasharray"},wY={offset:"strokeDashoffset",array:"strokeDasharray"};function EY(n,e,t=1,r=0,i=!0){n.pathLength=1;const a=i?_Y:wY;n[a.offset]=it.transform(-r);const o=it.transform(e),c=it.transform(t);n[a.array]=`${o} ${c}`}function RO(n,{attrX:e,attrY:t,attrScale:r,pathLength:i,pathSpacing:a=1,pathOffset:o=0,...c},u,d,h){if(UE(n,c,d),u){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:p,style:m}=n;p.transform&&(m.transform=p.transform,delete p.transform),(m.transform||p.transformOrigin)&&(m.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),m.transform&&(m.transformBox=h?.transformBox??"fill-box",delete p.transformBox),e!==void 0&&(p.x=e),t!==void 0&&(p.y=t),r!==void 0&&(p.scale=r),i!==void 0&&EY(p,i,a,o,!1)}const DO=()=>({...FE(),attrs:{}}),kO=n=>typeof n=="string"&&n.toLowerCase()==="svg";function SY(n,e,t,r){const i=F.useMemo(()=>{const a=DO();return RO(a,e,kO(r),n.transformTemplate,n.style),{...a.attrs,style:{...a.style}}},[e]);if(n.style){const a={};IO(a,n.style,n),i.style={...a,...i.style}}return i}const TY=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function GE(n){return typeof n!="string"||n.includes("-")?!1:!!(TY.indexOf(n)>-1||/[A-Z]/u.test(n))}function AY(n,e,t,{latestValues:r},i,a=!1){const c=(GE(n)?SY:xY)(e,r,i,n),u=dY(e,typeof n=="string",a),d=n!==F.Fragment?{...u,...c,ref:t}:{},{children:h}=e,p=F.useMemo(()=>Nr(h)?h.get():h,[h]);return F.createElement(n,{...d,children:p})}function ZR(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function qE(n,e,t,r){if(typeof e=="function"){const[i,a]=ZR(r);e=e(t!==void 0?t:n.custom,i,a)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,a]=ZR(r);e=e(t!==void 0?t:n.custom,i,a)}return e}function v0(n){return Nr(n)?n.get():n}function CY({scrapeMotionValuesFromProps:n,createRenderState:e},t,r,i){return{latestValues:IY(t,r,i,n),renderState:e()}}function IY(n,e,t,r){const i={},a=r(n,{});for(const m in a)i[m]=v0(a[m]);let{initial:o,animate:c}=n;const u=Wv(n),d=AO(n);e&&d&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),c===void 0&&(c=e.animate));let h=t?t.initial===!1:!1;h=h||o===!1;const p=h?c:o;if(p&&typeof p!="boolean"&&!Xv(p)){const m=Array.isArray(p)?p:[p];for(let b=0;b<m.length;b++){const _=qE(n,m[b]);if(_){const{transitionEnd:w,transition:S,...T}=_;for(const C in T){let R=T[C];if(Array.isArray(R)){const j=h?R.length-1:0;R=R[j]}R!==null&&(i[C]=R)}for(const C in w)i[C]=w[C]}}}return i}const NO=n=>(e,t)=>{const r=F.useContext(Kv),i=F.useContext(Yv),a=()=>CY(n,e,r,i);return t?a():$v(a)};function HE(n,e,t){const{style:r}=n,i={};for(const a in r)(Nr(r[a])||e.style&&Nr(e.style[a])||CO(a,n)||t?.getValue(a)?.liveStyle!==void 0)&&(i[a]=r[a]);return i}const RY=NO({scrapeMotionValuesFromProps:HE,createRenderState:FE});function MO(n,e,t){const r=HE(n,e,t);for(const i in n)if(Nr(n[i])||Nr(e[i])){const a=Gd.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[a]=n[i]}return r}const DY=NO({scrapeMotionValuesFromProps:MO,createRenderState:DO}),kY=Symbol.for("motionComponentSymbol");function Fu(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function NY(n,e,t){return F.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):Fu(t)&&(t.current=r))},[e])}const $E=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),MY="framerAppearId",PO="data-"+$E(MY),OO=F.createContext({});function PY(n,e,t,r,i){const{visualElement:a}=F.useContext(Kv),o=F.useContext(SO),c=F.useContext(Yv),u=F.useContext(zE).reducedMotion,d=F.useRef(null);r=r||o.renderer,!d.current&&r&&(d.current=r(n,{visualState:e,parent:a,props:t,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const h=d.current,p=F.useContext(OO);h&&!h.projection&&i&&(h.type==="html"||h.type==="svg")&&OY(d.current,t,i,p);const m=F.useRef(!1);F.useInsertionEffect(()=>{h&&m.current&&h.update(t,c)});const b=t[PO],_=F.useRef(!!b&&!window.MotionHandoffIsComplete?.(b)&&window.MotionHasOptimisedAnimation?.(b));return mE(()=>{h&&(m.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),h.scheduleRenderMicrotask(),_.current&&h.animationState&&h.animationState.animateChanges())}),F.useEffect(()=>{h&&(!_.current&&h.animationState&&h.animationState.animateChanges(),_.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(b)}),_.current=!1),h.enteringChildren=void 0)}),h}function OY(n,e,t,r){const{layoutId:i,layout:a,drag:o,dragConstraints:c,layoutScroll:u,layoutRoot:d,layoutCrossfade:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:VO(n.parent)),n.projection.setOptions({layoutId:i,layout:a,alwaysMeasureLayout:!!o||c&&Fu(c),visualElement:n,animationType:typeof a=="string"?a:"both",initialPromotionConfig:r,crossfade:h,layoutScroll:u,layoutRoot:d})}function VO(n){if(n)return n.options.allowProjection!==!1?n.projection:VO(n.parent)}function z1(n,{forwardMotionProps:e=!1}={},t,r){t&&lY(t);const i=GE(n)?DY:RY;function a(c,u){let d;const h={...F.useContext(zE),...c,layoutId:VY(c)},{isStatic:p}=h,m=hY(c),b=i(c,p);if(!p&&gE){jY();const _=zY(h);d=_.MeasureLayout,m.visualElement=PY(n,b,h,r,_.ProjectionNode)}return y.jsxs(Kv.Provider,{value:m,children:[d&&m.visualElement?y.jsx(d,{visualElement:m.visualElement,...h}):null,AY(n,c,NY(b,m.visualElement,u),b,p,e)]})}a.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const o=F.forwardRef(a);return o[kY]=n,o}function VY({layoutId:n}){const e=F.useContext(pE).id;return e&&n!==void 0?e+"-"+n:n}function jY(n,e){F.useContext(SO).strict}function zY(n){const{drag:e,layout:t}=Ed;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function LY(n,e){if(typeof Proxy>"u")return z1;const t=new Map,r=(a,o)=>z1(a,o,n,e),i=(a,o)=>r(a,o);return new Proxy(i,{get:(a,o)=>o==="create"?r:(t.has(o)||t.set(o,z1(o,void 0,n,e)),t.get(o))})}function jO({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function BY({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function UY(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function L1(n){return n===void 0||n===1}function d_({scale:n,scaleX:e,scaleY:t}){return!L1(n)||!L1(e)||!L1(t)}function Wl(n){return d_(n)||zO(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function zO(n){return JR(n.x)||JR(n.y)}function JR(n){return n&&n!=="0%"}function tv(n,e,t){const r=n-t,i=e*r;return t+i}function eD(n,e,t,r,i){return i!==void 0&&(n=tv(n,i,r)),tv(n,t,r)+e}function f_(n,e=0,t=1,r,i){n.min=eD(n.min,e,t,r,i),n.max=eD(n.max,e,t,r,i)}function LO(n,{x:e,y:t}){f_(n.x,e.translate,e.scale,e.originPoint),f_(n.y,t.translate,t.scale,t.originPoint)}const tD=.999999999999,nD=1.0000000000001;function FY(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let a,o;for(let c=0;c<i;c++){a=t[c],o=a.projectionDelta;const{visualElement:u}=a.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&a.options.layoutScroll&&a.scroll&&a!==a.root&&qu(n,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,LO(n,o)),r&&Wl(a.latestValues)&&qu(n,a.latestValues))}e.x<nD&&e.x>tD&&(e.x=1),e.y<nD&&e.y>tD&&(e.y=1)}function Gu(n,e){n.min=n.min+e,n.max=n.max+e}function rD(n,e,t,r,i=.5){const a=gn(n.min,n.max,i);f_(n,e,t,a,r)}function qu(n,e){rD(n.x,e.x,e.scaleX,e.scale,e.originX),rD(n.y,e.y,e.scaleY,e.scale,e.originY)}function BO(n,e){return jO(UY(n.getBoundingClientRect(),e))}function GY(n,e,t){const r=BO(n,t),{scroll:i}=e;return i&&(Gu(r.x,i.offset.x),Gu(r.y,i.offset.y)),r}const iD=()=>({translate:0,scale:1,origin:0,originPoint:0}),Hu=()=>({x:iD(),y:iD()}),aD=()=>({min:0,max:0}),On=()=>({x:aD(),y:aD()}),h_={current:null},UO={current:!1};function qY(){if(UO.current=!0,!!gE)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>h_.current=n.matches;n.addEventListener("change",e),e()}else h_.current=!1}const HY=new WeakMap;function $Y(n,e,t){for(const r in e){const i=e[r],a=t[r];if(Nr(i))n.addValue(r,i);else if(Nr(a))n.addValue(r,wd(i,{owner:n}));else if(a!==i)if(n.hasValue(r)){const o=n.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=n.getStaticValue(r);n.addValue(r,wd(o!==void 0?o:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const sD=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class YY{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:a,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=ME,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=ri.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,cn.render(this.render,!1,!0))};const{latestValues:u,renderState:d}=o;this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=d,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=c,this.blockInitialAnimation=!!a,this.isControllingVariants=Wv(t),this.isVariantNode=AO(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...p}=this.scrapeMotionValuesFromProps(t,{},this);for(const m in p){const b=p[m];u[m]!==void 0&&Nr(b)&&b.set(u[m])}}mount(e){this.current=e,HY.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),UO.current||qY(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:h_.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),ll(this.notifyUpdate),ll(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=qd.has(e);r&&this.onBindTransform&&this.onBindTransform();const i=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&cn.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Ed){const t=Ed[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):On()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<sD.length;r++){const i=sD[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const a="on"+i,o=e[a];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=$Y(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=wd(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(M4(r)||O4(r))?r=parseFloat(r):!tY(r)&&cl.test(t)&&(r=mO(e,t)),this.setBaseTarget(e,Nr(r)?r.get():r)),Nr(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let r;if(typeof t=="string"||typeof t=="object"){const a=qE(this.props,t,this.presenceContext?.custom);a&&(r=a[e])}if(t&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Nr(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new _E),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){VE.render(this.render)}}class FO extends YY{constructor(){super(...arguments),this.KeyframeResolver=G$}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Nr(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function GO(n,{style:e,vars:t},r,i){const a=n.style;let o;for(o in e)a[o]=e[o];i?.applyProjectionStyles(a,r);for(o in t)a.setProperty(o,t[o])}function KY(n){return window.getComputedStyle(n)}class XY extends FO{constructor(){super(...arguments),this.type="html",this.renderInstance=GO}readValueFromInstance(e,t){if(qd.has(t))return this.projection?.isProjecting?i_(t):l$(e,t);{const r=KY(e),i=(SE(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return BO(e,t)}build(e,t,r){UE(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return HE(e,t,r)}}const qO=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function WY(n,e,t,r){GO(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(qO.has(i)?i:$E(i),e.attrs[i])}class QY extends FO{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=On}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(qd.has(t)){const r=gO(t);return r&&r.default||0}return t=qO.has(t)?t:$E(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return MO(e,t,r)}build(e,t,r){RO(e,t,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,t,r,i){WY(e,t,r,i)}mount(e){this.isSVGTag=kO(e.tagName),super.mount(e)}}const ZY=(n,e)=>GE(n)?new QY(e):new XY(e,{allowProjection:n!==F.Fragment});function id(n,e,t){const r=n.getProps();return qE(r,e,t!==void 0?t:r.custom,n)}const p_=n=>Array.isArray(n);function JY(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,wd(t))}function eK(n){return p_(n)?n[n.length-1]||0:n}function YE(n,e){const t=id(n,e);let{transitionEnd:r={},transition:i={},...a}=t||{};a={...a,...r};for(const o in a){const c=eK(a[o]);JY(n,o,c)}}function tK(n){return!!(Nr(n)&&n.add)}function g_(n,e){const t=n.getValue("willChange");if(tK(t))return t.add(e);if(!t&&qs.WillChange){const r=new qs.WillChange("auto");n.addValue("willChange",r),r.add(e)}}function HO(n){return n.props[PO]}const nK=n=>n!==null;function rK(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(nK),a=e&&t!=="loop"&&e%2===1?0:i.length-1;return i[a]}const iK={type:"spring",stiffness:500,damping:25,restSpeed:10},aK=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),sK={type:"keyframes",duration:.8},oK={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},lK=(n,{keyframes:e})=>e.length>2?sK:qd.has(n)?n.startsWith("scale")?aK(e[1]):iK:oK;function cK({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:a,repeatType:o,repeatDelay:c,from:u,elapsed:d,...h}){return!!Object.keys(h).length}const KE=(n,e,t,r={},i,a)=>o=>{const c=PE(r,n)||{},u=c.delay||r.delay||0;let{elapsed:d=0}=r;d=d-Qa(u);const h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...c,delay:-d,onUpdate:m=>{e.set(m),c.onUpdate&&c.onUpdate(m)},onComplete:()=>{o(),c.onComplete&&c.onComplete()},name:n,motionValue:e,element:a?void 0:i};cK(c)||Object.assign(h,lK(n,h)),h.duration&&(h.duration=Qa(h.duration)),h.repeatDelay&&(h.repeatDelay=Qa(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let p=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(c_(h),h.delay===0&&(p=!0)),(qs.instantAnimations||qs.skipAnimations)&&(p=!0,c_(h),h.delay=0),h.allowFlatten=!c.type&&!c.ease,p&&!a&&e.get()!==void 0){const m=rK(h.keyframes,c);if(m!==void 0){cn.update(()=>{h.onUpdate(m),h.onComplete()});return}}return c.isSync?new NE(h):new k$(h)};function uK({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function $O(n,e,{delay:t=0,transitionOverride:r,type:i}={}){let{transition:a=n.getDefaultTransition(),transitionEnd:o,...c}=e;r&&(a=r);const u=[],d=i&&n.animationState&&n.animationState.getState()[i];for(const h in c){const p=n.getValue(h,n.latestValues[h]??null),m=c[h];if(m===void 0||d&&uK(d,h))continue;const b={delay:t,...PE(a||{},h)},_=p.get();if(_!==void 0&&!p.isAnimating&&!Array.isArray(m)&&m===_&&!b.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const T=HO(n);if(T){const C=window.MotionHandoffAnimation(T,h,cn);C!==null&&(b.startTime=C,w=!0)}}g_(n,h),p.start(KE(h,p,m,n.shouldReduceMotion&&fO.has(h)?{type:!1}:b,n,w));const S=p.animation;S&&u.push(S)}return o&&Promise.all(u).then(()=>{cn.update(()=>{o&&YE(n,o)})}),u}function YO(n,e,t,r=0,i=1){const a=Array.from(n).sort((d,h)=>d.sortNodePosition(h)).indexOf(e),o=n.size,c=(o-1)*r;return typeof t=="function"?t(a,o):i===1?a*r:c-a*r}function m_(n,e,t={}){const r=id(n,e,t.type==="exit"?n.presenceContext?.custom:void 0);let{transition:i=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(i=t.transitionOverride);const a=r?()=>Promise.all($O(n,r,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:h,staggerDirection:p}=i;return dK(n,e,u,d,h,p,t)}:()=>Promise.resolve(),{when:c}=i;if(c){const[u,d]=c==="beforeChildren"?[a,o]:[o,a];return u().then(()=>d())}else return Promise.all([a(),o(t.delay)])}function dK(n,e,t=0,r=0,i=0,a=1,o){const c=[];for(const u of n.variantChildren)u.notify("AnimationStart",e),c.push(m_(u,e,{...o,delay:t+(typeof r=="function"?0:r)+YO(n.variantChildren,u,r,i,a)}).then(()=>u.notify("AnimationComplete",e)));return Promise.all(c)}function KO(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(a=>m_(n,a,t));r=Promise.all(i)}else if(typeof e=="string")r=m_(n,e,t);else{const i=typeof e=="function"?id(n,e,t.custom):e;r=Promise.all($O(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}function XO(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}const fK=BE.length;function WO(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?WO(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<fK;t++){const r=BE[t],i=n.props[r];(ap(i)||i===!1)&&(e[r]=i)}return e}const hK=[...LE].reverse(),pK=LE.length;function gK(n){return e=>Promise.all(e.map(({animation:t,options:r})=>KO(n,t,r)))}function mK(n){let e=gK(n),t=oD(),r=!0;const i=u=>(d,h)=>{const p=id(n,h,u==="exit"?n.presenceContext?.custom:void 0);if(p){const{transition:m,transitionEnd:b,..._}=p;d={...d,..._,...b}}return d};function a(u){e=u(n)}function o(u){const{props:d}=n,h=WO(n.parent)||{},p=[],m=new Set;let b={},_=1/0;for(let S=0;S<pK;S++){const T=hK[S],C=t[T],R=d[T]!==void 0?d[T]:h[T],j=ap(R),z=T===u?C.isActive:null;z===!1&&(_=S);let V=R===h[T]&&R!==d[T]&&j;if(V&&r&&n.manuallyAnimateOnMount&&(V=!1),C.protectedKeys={...b},!C.isActive&&z===null||!R&&!C.prevProp||Xv(R)||typeof R=="boolean")continue;const I=vK(C.prevProp,R);let A=I||T===u&&C.isActive&&!V&&j||S>_&&j,k=!1;const O=Array.isArray(R)?R:[R];let L=O.reduce(i(T),{});z===!1&&(L={});const{prevResolvedValues:B={}}=C,M={...B,...L},Q=H=>{A=!0,m.has(H)&&(k=!0,m.delete(H)),C.needsAnimating[H]=!0;const Z=n.getValue(H);Z&&(Z.liveStyle=!1)};for(const H in M){const Z=L[H],re=B[H];if(b.hasOwnProperty(H))continue;let de=!1;p_(Z)&&p_(re)?de=!XO(Z,re):de=Z!==re,de?Z!=null?Q(H):m.add(H):Z!==void 0&&m.has(H)?Q(H):C.protectedKeys[H]=!0}C.prevProp=R,C.prevResolvedValues=L,C.isActive&&(b={...b,...L}),r&&n.blockInitialAnimation&&(A=!1);const X=V&&I;A&&(!X||k)&&p.push(...O.map(H=>{const Z={type:T};if(typeof H=="string"&&r&&!X&&n.manuallyAnimateOnMount&&n.parent){const{parent:re}=n,de=id(re,H);if(re.enteringChildren&&de){const{delayChildren:U}=de.transition||{};Z.delay=YO(re.enteringChildren,n,U)}}return{animation:H,options:Z}}))}if(m.size){const S={};if(typeof d.initial!="boolean"){const T=id(n,Array.isArray(d.initial)?d.initial[0]:d.initial);T&&T.transition&&(S.transition=T.transition)}m.forEach(T=>{const C=n.getBaseTarget(T),R=n.getValue(T);R&&(R.liveStyle=!0),S[T]=C??null}),p.push({animation:S})}let w=!!p.length;return r&&(d.initial===!1||d.initial===d.animate)&&!n.manuallyAnimateOnMount&&(w=!1),r=!1,w?e(p):Promise.resolve()}function c(u,d){if(t[u].isActive===d)return Promise.resolve();n.variantChildren?.forEach(p=>p.animationState?.setActive(u,d)),t[u].isActive=d;const h=o(u);for(const p in t)t[p].protectedKeys={};return h}return{animateChanges:o,setActive:c,setAnimateFunction:a,getState:()=>t,reset:()=>{t=oD()}}}function vK(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!XO(e,n):!1}function Hl(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function oD(){return{animate:Hl(!0),whileInView:Hl(),whileHover:Hl(),whileTap:Hl(),whileDrag:Hl(),whileFocus:Hl(),exit:Hl()}}class vl{constructor(e){this.isMounted=!1,this.node=e}update(){}}class yK extends vl{constructor(e){super(e),e.animationState||(e.animationState=mK(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Xv(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let bK=0;class xK extends vl{constructor(){super(...arguments),this.id=bK++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const _K={animation:{Feature:yK},exit:{Feature:xK}};function op(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function Fp(n){return{point:{x:n.pageX,y:n.pageY}}}const wK=n=>e=>jE(e)&&n(e,Fp(e));function Ch(n,e,t,r){return op(n,e,wK(t),r)}const QO=1e-4,EK=1-QO,SK=1+QO,ZO=.01,TK=0-ZO,AK=0+ZO;function Gr(n){return n.max-n.min}function CK(n,e,t){return Math.abs(n-e)<=t}function lD(n,e,t,r=.5){n.origin=r,n.originPoint=gn(e.min,e.max,n.origin),n.scale=Gr(t)/Gr(e),n.translate=gn(t.min,t.max,n.origin)-n.originPoint,(n.scale>=EK&&n.scale<=SK||isNaN(n.scale))&&(n.scale=1),(n.translate>=TK&&n.translate<=AK||isNaN(n.translate))&&(n.translate=0)}function Ih(n,e,t,r){lD(n.x,e.x,t.x,r?r.originX:void 0),lD(n.y,e.y,t.y,r?r.originY:void 0)}function cD(n,e,t){n.min=t.min+e.min,n.max=n.min+Gr(e)}function IK(n,e,t){cD(n.x,e.x,t.x),cD(n.y,e.y,t.y)}function uD(n,e,t){n.min=e.min-t.min,n.max=n.min+Gr(e)}function Rh(n,e,t){uD(n.x,e.x,t.x),uD(n.y,e.y,t.y)}function Li(n){return[n("x"),n("y")]}const JO=({current:n})=>n?n.ownerDocument.defaultView:null,dD=(n,e)=>Math.abs(n-e);function RK(n,e){const t=dD(n.x,e.x),r=dD(n.y,e.y);return Math.sqrt(t**2+r**2)}class e3{constructor(e,t,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:a=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=U1(this.lastMoveEventInfo,this.history),b=this.startEvent!==null,_=RK(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!b&&!_)return;const{point:w}=m,{timestamp:S}=Er;this.history.push({...w,timestamp:S});const{onStart:T,onMove:C}=this.handlers;b||(T&&T(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),C&&C(this.lastMoveEvent,m)},this.handlePointerMove=(m,b)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=B1(b,this.transformPagePoint),cn.update(this.updatePoint,!0)},this.handlePointerUp=(m,b)=>{this.end();const{onEnd:_,onSessionEnd:w,resumeAnimation:S}=this.handlers;if(this.dragSnapToOrigin&&S&&S(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=U1(m.type==="pointercancel"?this.lastMoveEventInfo:B1(b,this.transformPagePoint),this.history);this.startEvent&&_&&_(m,T),w&&w(m,T)},!jE(e))return;this.dragSnapToOrigin=a,this.handlers=t,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=i||window;const c=Fp(e),u=B1(c,this.transformPagePoint),{point:d}=u,{timestamp:h}=Er;this.history=[{...d,timestamp:h}];const{onSessionStart:p}=t;p&&p(e,U1(u,this.history)),this.removeListeners=Lp(Ch(this.contextWindow,"pointermove",this.handlePointerMove),Ch(this.contextWindow,"pointerup",this.handlePointerUp),Ch(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),ll(this.updatePoint)}}function B1(n,e){return e?{point:e(n.point)}:n}function fD(n,e){return{x:n.x-e.x,y:n.y-e.y}}function U1({point:n},e){return{point:n,delta:fD(n,t3(e)),offset:fD(n,DK(e)),velocity:kK(e,.1)}}function DK(n){return n[0]}function t3(n){return n[n.length-1]}function kK(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=t3(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Qa(e)));)t--;if(!r)return{x:0,y:0};const a=Hi(i.timestamp-r.timestamp);if(a===0)return{x:0,y:0};const o={x:(i.x-r.x)/a,y:(i.y-r.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function NK(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?gn(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?gn(t,n,r.max):Math.min(n,t)),n}function hD(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function MK(n,{top:e,left:t,bottom:r,right:i}){return{x:hD(n.x,t,i),y:hD(n.y,e,r)}}function pD(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function PK(n,e){return{x:pD(n.x,e.x),y:pD(n.y,e.y)}}function OK(n,e){let t=.5;const r=Gr(n),i=Gr(e);return i>r?t=np(e.min,e.max-r,n.min):r>i&&(t=np(n.min,n.max-i,e.min)),Gs(0,1,t)}function VK(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const v_=.35;function jK(n=v_){return n===!1?n=0:n===!0&&(n=v_),{x:gD(n,"left","right"),y:gD(n,"top","bottom")}}function gD(n,e,t){return{min:mD(n,e),max:mD(n,t)}}function mD(n,e){return typeof n=="number"?n:n[e]||0}const zK=new WeakMap;class LK{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=On(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:r}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const a=p=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Fp(p).point)},o=(p,m)=>{const{drag:b,dragPropagation:_,onDragStart:w}=this.getProps();if(b&&!_&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Y$(b),!this.openDragLock))return;this.latestPointerEvent=p,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Li(T=>{let C=this.getAxisMotionValue(T).get()||0;if(Za.test(C)){const{projection:R}=this.visualElement;if(R&&R.layout){const j=R.layout.layoutBox[T];j&&(C=Gr(j)*(parseFloat(C)/100))}}this.originPoint[T]=C}),w&&cn.postRender(()=>w(p,m)),g_(this.visualElement,"transform");const{animationState:S}=this.visualElement;S&&S.setActive("whileDrag",!0)},c=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m;const{dragPropagation:b,dragDirectionLock:_,onDirectionLock:w,onDrag:S}=this.getProps();if(!b&&!this.openDragLock)return;const{offset:T}=m;if(_&&this.currentDirection===null){this.currentDirection=BK(T),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",m.point,T),this.updateAxis("y",m.point,T),this.visualElement.render(),S&&S(p,m)},u=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m,this.stop(p,m),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>Li(p=>this.getAnimationState(p)==="paused"&&this.getAxisMotionValue(p).animation?.play()),{dragSnapToOrigin:h}=this.getProps();this.panSession=new e3(e,{onSessionStart:a,onStart:o,onMove:c,onSessionEnd:u,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,distanceThreshold:r,contextWindow:JO(this.visualElement)})}stop(e,t){const r=e||this.latestPointerEvent,i=t||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!i||!r)return;const{velocity:o}=i;this.startAnimation(o);const{onDragEnd:c}=this.getProps();c&&cn.postRender(()=>c(r,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!Om(e,i,this.currentDirection))return;const a=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=NK(o,this.constraints[e],this.elastic[e])),a.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:t}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,i=this.constraints;e&&Fu(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=MK(r.layoutBox,e):this.constraints=!1,this.elastic=jK(t),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Li(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=VK(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Fu(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const a=GY(r,i.root,this.visualElement.getTransformPagePoint());let o=PK(i.layout.layoutBox,a);if(t){const c=t(BY(o));this.hasMutatedConstraints=!!c,c&&(o=jO(c))}return o}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:c}=this.getProps(),u=this.constraints||{},d=Li(h=>{if(!Om(h,t,this.currentDirection))return;let p=u&&u[h]||{};o&&(p={min:0,max:0});const m=i?200:1e6,b=i?40:1e7,_={type:"inertia",velocity:r?e[h]:0,bounceStiffness:m,bounceDamping:b,timeConstant:750,restDelta:1,restSpeed:10,...a,...p};return this.startAxisValueAnimation(h,_)});return Promise.all(d).then(c)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return g_(this.visualElement,e),r.start(KE(e,r,0,t,this.visualElement,!1))}stopAnimation(){Li(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Li(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Li(t=>{const{drag:r}=this.getProps();if(!Om(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,a=this.getAxisMotionValue(t);if(i&&i.layout){const{min:o,max:c}=i.layout.layoutBox[t];a.set(e[t]-gn(o,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!Fu(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Li(o=>{const c=this.getAxisMotionValue(o);if(c&&this.constraints!==!1){const u=c.get();i[o]=OK({min:u,max:u},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Li(o=>{if(!Om(o,e,null))return;const c=this.getAxisMotionValue(o),{min:u,max:d}=this.constraints[o];c.set(gn(u,d,i[o]))})}addListeners(){if(!this.visualElement.current)return;zK.set(this.visualElement,this);const e=this.visualElement.current,t=Ch(e,"pointerdown",u=>{const{drag:d,dragListener:h=!0}=this.getProps();d&&h&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();Fu(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,a=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),cn.read(r);const o=op(window,"resize",()=>this.scalePositionWithinConstraints()),c=i.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:d})=>{this.isDragging&&d&&(Li(h=>{const p=this.getAxisMotionValue(h);p&&(this.originPoint[h]+=u[h].translate,p.set(p.get()+u[h].translate))}),this.visualElement.render())}));return()=>{o(),t(),a(),c&&c()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:a=!1,dragElastic:o=v_,dragMomentum:c=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:a,dragElastic:o,dragMomentum:c}}}function Om(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function BK(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class UK extends vl{constructor(e){super(e),this.removeGroupControls=Ki,this.removeListeners=Ki,this.controls=new LK(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ki}unmount(){this.removeGroupControls(),this.removeListeners()}}const vD=n=>(e,t)=>{n&&cn.postRender(()=>n(e,t))};class FK extends vl{constructor(){super(...arguments),this.removePointerDownListener=Ki}onPointerDown(e){this.session=new e3(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:JO(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:vD(e),onStart:vD(t),onMove:r,onEnd:(a,o)=>{delete this.session,i&&cn.postRender(()=>i(a,o))}}}mount(){this.removePointerDownListener=Ch(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const y0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function yD(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const nh={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(it.test(n))n=parseFloat(n);else return n;const t=yD(n,e.target.x),r=yD(n,e.target.y);return`${t}% ${r}%`}},GK={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=cl.parse(n);if(i.length>5)return r;const a=cl.createTransformer(n),o=typeof i[0]!="number"?1:0,c=t.x.scale*e.x,u=t.y.scale*e.y;i[0+o]/=c,i[1+o]/=u;const d=gn(c,u,.5);return typeof i[2+o]=="number"&&(i[2+o]/=d),typeof i[3+o]=="number"&&(i[3+o]/=d),a(i)}};let F1=!1;class qK extends F.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:a}=e;pY(HK),a&&(t.group&&t.group.add(a),r&&r.register&&i&&r.register(a),F1&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),y0.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:a}=this.props,{projection:o}=r;return o&&(o.isPresent=a,F1=!0,i||e.layoutDependency!==t||t===void 0||e.isPresent!==a?o.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?o.promote():o.relegate()||cn.postRender(()=>{const c=o.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),VE.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;F1=!0,i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function n3(n){const[e,t]=EO(),r=F.useContext(pE);return y.jsx(qK,{...n,layoutGroup:r,switchLayoutGroup:F.useContext(OO),isPresent:e,safeToRemove:t})}const HK={borderRadius:{...nh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:nh,borderTopRightRadius:nh,borderBottomLeftRadius:nh,borderBottomRightRadius:nh,boxShadow:GK};function $K(n,e,t){const r=Nr(n)?n:wd(n);return r.start(KE("",r,e,t)),r.animation}const YK=(n,e)=>n.depth-e.depth;class KK{constructor(){this.children=[],this.isDirty=!1}add(e){vE(this.children,e),this.isDirty=!0}remove(e){yE(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(YK),this.isDirty=!1,this.children.forEach(e)}}function XK(n,e){const t=ri.now(),r=({timestamp:i})=>{const a=i-t;a>=e&&(ll(r),n(a-e))};return cn.setup(r,!0),()=>ll(r)}const r3=["TopLeft","TopRight","BottomLeft","BottomRight"],WK=r3.length,bD=n=>typeof n=="string"?parseFloat(n):n,xD=n=>typeof n=="number"||it.test(n);function QK(n,e,t,r,i,a){i?(n.opacity=gn(0,t.opacity??1,ZK(r)),n.opacityExit=gn(e.opacity??1,0,JK(r))):a&&(n.opacity=gn(e.opacity??1,t.opacity??1,r));for(let o=0;o<WK;o++){const c=`border${r3[o]}Radius`;let u=_D(e,c),d=_D(t,c);if(u===void 0&&d===void 0)continue;u||(u=0),d||(d=0),u===0||d===0||xD(u)===xD(d)?(n[c]=Math.max(gn(bD(u),bD(d),r),0),(Za.test(d)||Za.test(u))&&(n[c]+="%")):n[c]=d}(e.rotate||t.rotate)&&(n.rotate=gn(e.rotate||0,t.rotate||0,r))}function _D(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const ZK=i3(0,.5,G4),JK=i3(.5,.95,Ki);function i3(n,e,t){return r=>r<n?0:r>e?1:t(np(n,e,r))}function wD(n,e){n.min=e.min,n.max=e.max}function ji(n,e){wD(n.x,e.x),wD(n.y,e.y)}function ED(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function SD(n,e,t,r,i){return n-=e,n=tv(n,1/t,r),i!==void 0&&(n=tv(n,1/i,r)),n}function eX(n,e=0,t=1,r=.5,i,a=n,o=n){if(Za.test(e)&&(e=parseFloat(e),e=gn(o.min,o.max,e/100)-o.min),typeof e!="number")return;let c=gn(a.min,a.max,r);n===a&&(c-=e),n.min=SD(n.min,e,t,c,i),n.max=SD(n.max,e,t,c,i)}function TD(n,e,[t,r,i],a,o){eX(n,e[t],e[r],e[i],e.scale,a,o)}const tX=["x","scaleX","originX"],nX=["y","scaleY","originY"];function AD(n,e,t,r){TD(n.x,e,tX,t?t.x:void 0,r?r.x:void 0),TD(n.y,e,nX,t?t.y:void 0,r?r.y:void 0)}function CD(n){return n.translate===0&&n.scale===1}function a3(n){return CD(n.x)&&CD(n.y)}function ID(n,e){return n.min===e.min&&n.max===e.max}function rX(n,e){return ID(n.x,e.x)&&ID(n.y,e.y)}function RD(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function s3(n,e){return RD(n.x,e.x)&&RD(n.y,e.y)}function DD(n){return Gr(n.x)/Gr(n.y)}function kD(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class iX{constructor(){this.members=[]}add(e){vE(this.members,e),e.scheduleRender()}remove(e){if(yE(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const a=this.members[i];if(a.isPresent!==!1){r=a;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function aX(n,e,t){let r="";const i=n.x.translate/e.x,a=n.y.translate/e.y,o=t?.z||0;if((i||a||o)&&(r=`translate3d(${i}px, ${a}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:d,rotate:h,rotateX:p,rotateY:m,skewX:b,skewY:_}=t;d&&(r=`perspective(${d}px) ${r}`),h&&(r+=`rotate(${h}deg) `),p&&(r+=`rotateX(${p}deg) `),m&&(r+=`rotateY(${m}deg) `),b&&(r+=`skewX(${b}deg) `),_&&(r+=`skewY(${_}deg) `)}const c=n.x.scale*e.x,u=n.y.scale*e.y;return(c!==1||u!==1)&&(r+=`scale(${c}, ${u})`),r||"none"}const G1=["","X","Y","Z"],sX=1e3;let oX=0;function q1(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function o3(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=HO(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:a}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",cn,!(i||a))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&o3(r)}function l3({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},c=e?.()){this.id=oX++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(uX),this.nodes.forEach(pX),this.nodes.forEach(gX),this.nodes.forEach(dX)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new KK)}addEventListener(o,c){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new _E),this.eventHandlers.get(o).add(c)}notifyListeners(o,...c){const u=this.eventHandlers.get(o);u&&u.notify(...c)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=wO(o)&&!J$(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(u||c)&&(this.isLayoutDirty=!0),n){let h,p=0;const m=()=>this.root.updateBlockedByResize=!1;cn.read(()=>{p=window.innerWidth}),n(o,()=>{const b=window.innerWidth;b!==p&&(p=b,this.root.updateBlockedByResize=!0,h&&h(),h=XK(m,250),y0.hasAnimatedSinceResize&&(y0.hasAnimatedSinceResize=!1,this.nodes.forEach(PD)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:p,hasRelativeLayoutChanged:m,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||d.getDefaultTransition()||xX,{onLayoutAnimationStart:w,onLayoutAnimationComplete:S}=d.getProps(),T=!this.targetLayout||!s3(this.targetLayout,b),C=!p&&m;if(this.options.layoutRoot||this.resumeFrom||C||p&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const R={...PE(_,"layout"),onPlay:w,onComplete:S};(d.shouldReduceMotion||this.options.layoutRoot)&&(R.delay=0,R.type=!1),this.startAnimation(R),this.setAnimationOrigin(h,C)}else p||PD(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),ll(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(mX),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&o3(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const p=this.path[h];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:c,layout:u}=this.options;if(c===void 0&&!u)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(ND);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(MD);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(hX),this.nodes.forEach(lX),this.nodes.forEach(cX)):this.nodes.forEach(MD),this.clearAllSnapshots();const c=ri.now();Er.delta=Gs(0,1e3/60,c-Er.timestamp),Er.timestamp=c,Er.isProcessing=!0,N1.update.process(Er),N1.preRender.process(Er),N1.render.process(Er),Er.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,VE.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(fX),this.sharedNodes.forEach(vX)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,cn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){cn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Gr(this.snapshot.measuredBox.x)&&!Gr(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=On(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(c=!1),c&&this.instance){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!a3(this.projectionDelta),u=this.getTransformTemplate(),d=u?u(this.latestValues,""):void 0,h=d!==this.prevTransformTemplateValue;o&&this.instance&&(c||Wl(this.latestValues)||h)&&(i(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const c=this.measurePageBox();let u=this.removeElementScroll(c);return o&&(u=this.removeTransform(u)),_X(u),{animationId:this.root.animationId,measuredBox:c,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return On();const c=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(wX))){const{scroll:d}=this.root;d&&(Gu(c.x,d.offset.x),Gu(c.y,d.offset.y))}return c}removeElementScroll(o){const c=On();if(ji(c,o),this.scroll?.wasRoot)return c;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:h,options:p}=d;d!==this.root&&h&&p.layoutScroll&&(h.wasRoot&&ji(c,o),Gu(c.x,h.offset.x),Gu(c.y,h.offset.y))}return c}applyTransform(o,c=!1){const u=On();ji(u,o);for(let d=0;d<this.path.length;d++){const h=this.path[d];!c&&h.options.layoutScroll&&h.scroll&&h!==h.root&&qu(u,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Wl(h.latestValues)&&qu(u,h.latestValues)}return Wl(this.latestValues)&&qu(u,this.latestValues),u}removeTransform(o){const c=On();ji(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];if(!d.instance||!Wl(d.latestValues))continue;d_(d.latestValues)&&d.updateSnapshot();const h=On(),p=d.measurePageBox();ji(h,p),AD(c,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,h)}return Wl(this.latestValues)&&AD(c,this.latestValues),c}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Er.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:p}=this.options;if(!(!this.layout||!(h||p))){if(this.resolvedRelativeTargetAt=Er.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=On(),this.relativeTargetOrigin=On(),Rh(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),ji(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=On(),this.targetWithTransforms=On()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),IK(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ji(this.target,this.layout.layoutBox),LO(this.target,this.targetDelta)):ji(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=On(),this.relativeTargetOrigin=On(),Rh(this.relativeTargetOrigin,this.target,m.target),ji(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||d_(this.parent.latestValues)||zO(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const o=this.getLead(),c=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===Er.timestamp&&(u=!1),u)return;const{layout:d,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||h))return;ji(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,m=this.treeScale.y;FY(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=On());const{target:b}=o;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(ED(this.prevProjectionDelta.x,this.projectionDelta.x),ED(this.prevProjectionDelta.y,this.projectionDelta.y)),Ih(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==m||!kD(this.projectionDelta.x,this.prevProjectionDelta.x)||!kD(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Hu(),this.projectionDelta=Hu(),this.projectionDeltaWithTransform=Hu()}setAnimationOrigin(o,c=!1){const u=this.snapshot,d=u?u.latestValues:{},h={...this.latestValues},p=Hu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const m=On(),b=u?u.source:void 0,_=this.layout?this.layout.source:void 0,w=b!==_,S=this.getStack(),T=!S||S.members.length<=1,C=!!(w&&!T&&this.options.crossfade===!0&&!this.path.some(bX));this.animationProgress=0;let R;this.mixTargetDelta=j=>{const z=j/1e3;OD(p.x,o.x,z),OD(p.y,o.y,z),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Rh(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),yX(this.relativeTarget,this.relativeTargetOrigin,m,z),R&&rX(this.relativeTarget,R)&&(this.isProjectionDirty=!1),R||(R=On()),ji(R,this.relativeTarget)),w&&(this.animationValues=h,QK(h,d,this.latestValues,z,C,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=z},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(ll(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=cn.update(()=>{y0.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=wd(0)),this.currentAnimation=$K(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:c=>{this.mixTargetDelta(c),o.onUpdate&&o.onUpdate(c)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(sX),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:c,target:u,layout:d,latestValues:h}=o;if(!(!c||!u||!d)){if(this!==o&&this.layout&&d&&c3(this.options.animationType,this.layout.layoutBox,d.layoutBox)){u=this.target||On();const p=Gr(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const m=Gr(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+m}ji(c,u),qu(c,h),Ih(this.projectionDeltaWithTransform,this.layoutCorrected,c,h)}}registerSharedNode(o,c){this.sharedNodes.has(o)||this.sharedNodes.set(o,new iX),this.sharedNodes.get(o).add(c);const d=c.options.initialPromotionConfig;c.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(c):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:c,preserveFollowOpacity:u}={}){const d=this.getStack();d&&d.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let c=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(c=!0),!c)return;const d={};u.z&&q1("z",o,d,this.animationValues);for(let h=0;h<G1.length;h++)q1(`rotate${G1[h]}`,o,d,this.animationValues),q1(`skew${G1[h]}`,o,d,this.animationValues);o.render();for(const h in d)o.setStaticValue(h,d[h]),this.animationValues&&(this.animationValues[h]=d[h]);o.scheduleRender()}applyProjectionStyles(o,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const u=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=v0(c?.pointerEvents)||"",o.transform=u?u(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=v0(c?.pointerEvents)||""),this.hasProjected&&!Wl(this.latestValues)&&(o.transform=u?u({},""):"none",this.hasProjected=!1);return}o.visibility="";const h=d.animationValues||d.latestValues;this.applyTransformsToTarget();let p=aX(this.projectionDeltaWithTransform,this.treeScale,h);u&&(p=u(h,p)),o.transform=p;const{x:m,y:b}=this.projectionDelta;o.transformOrigin=`${m.origin*100}% ${b.origin*100}% 0`,d.animationValues?o.opacity=d===this?h.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:o.opacity=d===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const _ in sp){if(h[_]===void 0)continue;const{correct:w,applyTo:S,isCSSVariable:T}=sp[_],C=p==="none"?h[_]:w(h[_],d);if(S){const R=S.length;for(let j=0;j<R;j++)o[S[j]]=C}else T?this.options.visualElement.renderState.vars[_]=C:o[_]=C}this.options.layoutId&&(o.pointerEvents=d===this?v0(c?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(ND),this.root.sharedNodes.clear()}}}function lX(n){n.updateLayout()}function cX(n){const e=n.resumeFrom?.snapshot||n.snapshot;if(n.isLead()&&n.layout&&e&&n.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:r}=n.layout,{animationType:i}=n.options,a=e.source!==n.layout.source;i==="size"?Li(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=Gr(p);p.min=t[h].min,p.max=p.min+m}):c3(i,e.layoutBox,t)&&Li(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=Gr(t[h]);p.max=p.min+m,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[h].max=n.relativeTarget[h].min+m)});const o=Hu();Ih(o,t,e.layoutBox);const c=Hu();a?Ih(c,n.applyTransform(r,!0),e.measuredBox):Ih(c,t,e.layoutBox);const u=!a3(o);let d=!1;if(!n.resumeFrom){const h=n.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:p,layout:m}=h;if(p&&m){const b=On();Rh(b,e.layoutBox,p.layoutBox);const _=On();Rh(_,t,m.layoutBox),s3(b,_)||(d=!0),h.options.layoutRoot&&(n.relativeTarget=_,n.relativeTargetOrigin=b,n.relativeParent=h)}}}n.notifyListeners("didUpdate",{layout:t,snapshot:e,delta:c,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(n.isLead()){const{onExitComplete:t}=n.options;t&&t()}n.options.transition=void 0}function uX(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function dX(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function fX(n){n.clearSnapshot()}function ND(n){n.clearMeasurements()}function MD(n){n.isLayoutDirty=!1}function hX(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function PD(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function pX(n){n.resolveTargetDelta()}function gX(n){n.calcProjection()}function mX(n){n.resetSkewAndRotation()}function vX(n){n.removeLeadSnapshot()}function OD(n,e,t){n.translate=gn(e.translate,0,t),n.scale=gn(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function VD(n,e,t,r){n.min=gn(e.min,t.min,r),n.max=gn(e.max,t.max,r)}function yX(n,e,t,r){VD(n.x,e.x,t.x,r),VD(n.y,e.y,t.y,r)}function bX(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const xX={duration:.45,ease:[.4,0,.1,1]},jD=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),zD=jD("applewebkit/")&&!jD("chrome/")?Math.round:Ki;function LD(n){n.min=zD(n.min),n.max=zD(n.max)}function _X(n){LD(n.x),LD(n.y)}function c3(n,e,t){return n==="position"||n==="preserve-aspect"&&!CK(DD(e),DD(t),.2)}function wX(n){return n!==n.root&&n.scroll?.wasRoot}const EX=l3({attachResizeListener:(n,e)=>op(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),H1={current:void 0},u3=l3({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!H1.current){const n=new EX({});n.mount(window),n.setOptions({layoutScroll:!0}),H1.current=n}return H1.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),SX={pan:{Feature:FK},drag:{Feature:UK,ProjectionNode:u3,MeasureLayout:n3}};function BD(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,a=r[i];a&&cn.postRender(()=>a(e,Fp(e)))}class TX extends vl{mount(){const{current:e}=this.node;e&&(this.unmount=K$(e,(t,r)=>(BD(this.node,r,"Start"),i=>BD(this.node,i,"End"))))}unmount(){}}class AX extends vl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Lp(op(this.node.current,"focus",()=>this.onFocus()),op(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function UD(n,e,t){const{props:r}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),a=r[i];a&&cn.postRender(()=>a(e,Fp(e)))}class CX extends vl{mount(){const{current:e}=this.node;e&&(this.unmount=Z$(e,(t,r)=>(UD(this.node,r,"Start"),(i,{success:a})=>UD(this.node,i,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const y_=new WeakMap,$1=new WeakMap,IX=n=>{const e=y_.get(n.target);e&&e(n)},RX=n=>{n.forEach(IX)};function DX({root:n,...e}){const t=n||document;$1.has(t)||$1.set(t,{});const r=$1.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(RX,{root:n,...e})),r[i]}function kX(n,e,t){const r=DX(e);return y_.set(n,t),r.observe(n),()=>{y_.delete(n),r.unobserve(n)}}const NX={some:0,all:1};class MX extends vl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:a}=e,o={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:NX[i]},c=u=>{const{isIntersecting:d}=u;if(this.isInView===d||(this.isInView=d,a&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:h,onViewportLeave:p}=this.node.getProps(),m=d?h:p;m&&m(u)};return kX(this.node.current,o,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(PX(e,t))&&this.startObserver()}unmount(){}}function PX({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const OX={inView:{Feature:MX},tap:{Feature:CX},focus:{Feature:AX},hover:{Feature:TX}},VX={layout:{ProjectionNode:u3,MeasureLayout:n3}},jX={..._K,...OX,...SX,...VX},mr=LY(jX,ZY);function zX(n){n.values.forEach(e=>e.stop())}function b_(n,e){[...e].reverse().forEach(r=>{const i=n.getVariant(r);i&&YE(n,i),n.variantChildren&&n.variantChildren.forEach(a=>{b_(a,e)})})}function LX(n,e){if(Array.isArray(e))return b_(n,e);if(typeof e=="string")return b_(n,[e]);YE(n,e)}function BX(){const n=new Set,e={subscribe(t){return n.add(t),()=>void n.delete(t)},start(t,r){const i=[];return n.forEach(a=>{i.push(KO(a,t,{transitionOverride:r}))}),Promise.all(i)},set(t){return n.forEach(r=>{LX(r,t)})},stop(){n.forEach(t=>{zX(t)})},mount(){return()=>{e.stop()}}};return e}function UX(){const n=$v(BX);return mE(n.mount,[]),n}const FX=UX,zc=sw((n,e)=>({message:"",type:"neutral",isVisible:!1,undoAction:void 0,showToast:(t,r="neutral",i)=>{n({message:t,type:r,isVisible:!0,undoAction:i}),setTimeout(()=>{e().hideToast()},6e3)},hideToast:()=>{n({isVisible:!1})}})),GX=()=>{const{message:n,type:e,isVisible:t,undoAction:r,hideToast:i}=zc(),a=()=>{switch(e){case"success":return"bg-green-500 dark:bg-green-600 text-white";case"error":return"bg-red-500 dark:bg-red-600 text-white";case"neutral":default:return"bg-gray-800 dark:bg-gray-900 text-white border border-gray-200 dark:border-gray-700"}};return y.jsx(xi,{children:t&&y.jsx(mr.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-0 left-4 right-4 z-50 mb-[calc(env(safe-area-inset-bottom)+20px)]",children:y.jsxs("div",{className:`rounded-xl shadow-lg p-4 flex items-center justify-between ${a()}`,children:[y.jsx("div",{className:"flex items-center flex-1 min-w-0",children:y.jsx("span",{className:"text-sm font-medium truncate pr-2",children:n})}),y.jsxs("div",{className:"flex items-center gap-2 ml-3 flex-shrink-0",children:[r&&y.jsxs("button",{onClick:()=>{r(),i()},className:"px-3 py-1.5 bg-white/20 hover:bg-white/30 rounded-lg text-xs font-bold transition-colors",children:[y.jsx(n9,{size:14,className:"inline mr-1"}),"Undo"]}),y.jsx("button",{onClick:i,className:"p-1 hover:bg-black/10 dark:hover:bg-white/10 rounded-full transition-colors",children:y.jsx(aw,{size:16})})]})]})})})};class ca extends F.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t),this.setState({error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t)}componentDidUpdate(e){this.props.resetKeys&&this.props.resetOnPropsChange&&this.props.resetKeys.some((r,i)=>r!==e.resetKeys?.[i])&&this.state.hasError&&this.resetErrorBoundary()}resetErrorBoundary=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:y.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:y.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[y.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 dark:bg-red-900/30 rounded-full",children:y.jsx(Ju,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),y.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white text-center mb-2",children:"Something went wrong"}),y.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-6",children:"We're sorry, but something unexpected happened. You can try refreshing or going back to the home screen."}),!1,y.jsxs("div",{className:"flex flex-col gap-3",children:[y.jsxs("button",{onClick:this.resetErrorBoundary,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors",children:[y.jsx(sd,{className:"h-4 w-4"}),"Try Again"]}),y.jsxs("button",{onClick:()=>window.location.href="/#/",className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white font-medium rounded-md transition-colors",children:[y.jsx(RL,{className:"h-4 w-4"}),"Go to Home"]})]})]})}):this.props.children}}const qX=({onAddTransaction:n})=>{const e=as(),t=xa(),[r,i]=F.useState(!1),a=u=>t.pathname===u,o=[{path:"/reports",icon:y.jsx(Zz,{className:"w-5 h-5"}),label:"Reports"},{path:"/analytics",icon:y.jsx(dN,{className:"w-5 h-5"}),label:"Analytics"},{path:"/budget-breakdown",icon:y.jsx(eL,{className:"w-5 h-5"}),label:"Budget Breakdown"}],c=({path:u,icon:d,label:h})=>{const p=a(u);return y.jsxs("button",{onClick:()=>e(u),className:`
          relative group flex flex-col items-center justify-center
          w-12 h-12 rounded-2xl transition-all duration-300
          ${p?"text-blue-500 bg-blue-50 dark:bg-blue-500/20 dark:text-blue-400":"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-800"}
        `,children:[y.jsx("div",{className:`transition-transform duration-300 ${p?"scale-110":"group-hover:scale-105"}`,children:d}),y.jsx("span",{className:"sr-only",children:h}),p&&y.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-current rounded-full opacity-80"})]})};return y.jsx("div",{className:"fixed bottom-6 left-0 right-0 flex justify-center z-50 pointer-events-none safe-area-inset-bottom",children:y.jsxs("nav",{className:`\r
        pointer-events-auto\r
        flex items-center gap-1 p-2 pl-4 pr-4\r
        bg-white/60 dark:bg-zinc-900/60 backdrop-blur-xl\r
        border border-zinc-200/30 dark:border-zinc-800/30\r
        rounded-full shadow-2xl shadow-zinc-900/10\r
        transform transition-all duration-500 ease-out\r
      `,children:[y.jsx(c,{path:"/",label:"Budget",icon:y.jsx(iw,{className:"w-6 h-6"})}),y.jsx(c,{path:"/transactions",label:"Transactions",icon:y.jsx(kL,{className:"w-6 h-6"})}),y.jsx("div",{className:"w-px h-8 bg-zinc-200 dark:bg-zinc-800 mx-2"}),y.jsx("button",{onClick:()=>{if(i(!1),n){n();return}e("/add-transaction")},className:`\r
            -mt-8 mb-2 mx-1\r
            group relative flex items-center justify-center\r
            w-16 h-16 rounded-full\r
            bg-blue-600 text-white\r
            shadow-xl shadow-blue-600/30\r
            hover:shadow-blue-600/50 hover:scale-105 hover:-translate-y-1\r
            active:scale-95 active:translate-y-0\r
            transition-all duration-300 cubic-bezier(0.175, 0.885, 0.32, 1.275)\r
          `,children:y.jsx(Zm,{className:"w-8 h-8 transition-transform duration-300 group-hover:rotate-90"})}),y.jsx("div",{className:"w-px h-8 bg-zinc-200 dark:bg-zinc-800 mx-2"}),y.jsxs("div",{className:"relative",children:[y.jsxs("button",{onClick:()=>i(!r),className:`
              relative group flex flex-col items-center justify-center
              w-12 h-12 rounded-2xl transition-all duration-300
              ${r?"text-blue-500 bg-blue-50 dark:bg-blue-500/20 dark:text-blue-400":"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-800"}
            `,children:[y.jsx("div",{className:`transition-transform duration-300 ${r?"scale-110":"group-hover:scale-105"}`,children:y.jsx(vL,{className:"w-6 h-6"})}),y.jsx("span",{className:"sr-only",children:"More"}),r&&y.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-current rounded-full opacity-80"})]}),r&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>i(!1)}),y.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-48 bg-white dark:bg-zinc-900 rounded-2xl shadow-2xl border border-zinc-200/50 dark:border-zinc-800/50 backdrop-blur-xl z-50",children:y.jsx("div",{className:"p-2",children:o.map((u,d)=>y.jsxs("button",{onClick:()=>{e(u.path),i(!1)},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[y.jsx("div",{className:"text-zinc-600 dark:text-zinc-400",children:u.icon}),y.jsx("span",{className:"text-sm font-medium text-zinc-900 dark:text-white",children:u.label})]},d))})})]})]}),y.jsx(c,{path:"/settings",label:"Settings",icon:y.jsx(lN,{className:"w-6 h-6"})})]})})};function HX(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.map(function(r){return r.split(" ").map(function(i){return i?""+n+i:""}).join(" ")}).join(" ")}function $X(n,e){return e.replace(/([^}{]*){/gm,function(t,r){return r.replace(/\.([^{,\s\d.]+)/g,"."+n+"$1")+"{"})}function Ps(n,e){return function(t){t&&(n[e]=t)}}function d3(n,e,t){return function(r){r&&(n[e][t]=r)}}function FD(n,e){return function(t){var r=t.prototype;n.forEach(function(i){e(r,i)})}}function YX(n,e){return e===void 0&&(e={}),function(t,r){n.forEach(function(i){var a=e[i]||i;a in t||(t[a]=function(){for(var o,c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];var d=(o=this[r])[i].apply(o,c);return d===this[r]?this:d})})}}var KX="function",XX="object",WX="string",QX="number",XE="undefined",f3=typeof window!==XE,ZX=typeof document!==XE&&document,JX=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],Yn=1e-7,Vm={cm:function(n){return n*96/2.54},mm:function(n){return n*96/254},in:function(n){return n*96},pt:function(n){return n*96/72},pc:function(n){return n*96/6},"%":function(n,e){return n*e/100},vw:function(n,e){return e===void 0&&(e=window.innerWidth),n/100*e},vh:function(n,e){return e===void 0&&(e=window.innerHeight),n/100*e},vmax:function(n,e){return e===void 0&&(e=Math.max(window.innerWidth,window.innerHeight)),n/100*e},vmin:function(n,e){return e===void 0&&(e=Math.min(window.innerWidth,window.innerHeight)),n/100*e}};function eW(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}function nv(n,e,t,r){return(n*r+e*t)/(t+r)}function Qv(n){return typeof n===XE}function ya(n){return n&&typeof n===XX}function Wn(n){return Array.isArray(n)}function ii(n){return typeof n===WX}function Sd(n){return typeof n===QX}function WE(n){return typeof n===KX}function tW(n,e){var t=n===""||n==" ",r=e===""||e==" ";return r&&t||n===e}function h3(n,e,t,r,i){var a=QE(n,e,t);return a?t:nW(n,e,t+1,r,i)}function QE(n,e,t){if(!n.ignore)return null;var r=e.slice(Math.max(t-3,0),t+3).join("");return new RegExp(n.ignore).exec(r)}function nW(n,e,t,r,i){for(var a=function(d){var h=e[d].trim();if(h===n.close&&!QE(n,e,d))return{value:d};var p=d,m=ai(i,function(b){var _=b.open;return _===h});if(m&&(p=h3(m,e,d,r,i)),p===-1)return o=d,"break";d=p,o=d},o,c=t;c<r;++c){var u=a(c);if(c=o,typeof u=="object")return u.value;if(u==="break")break}return-1}function ZE(n,e){var t=ii(e)?{separator:e}:e,r=t.separator,i=r===void 0?",":r,a=t.isSeparateFirst,o=t.isSeparateOnlyOpenClose,c=t.isSeparateOpenClose,u=c===void 0?o:c,d=t.openCloseCharacters,h=d===void 0?JX:d,p=h.map(function(I){var A=I.open,k=I.close;return A===k?A:A+"|"+k}).join("|"),m="(\\s*"+i+"\\s*|"+p+"|\\s+)",b=new RegExp(m,"g"),_=n.split(b).filter(function(I){return I&&I!=="undefined"}),w=_.length,S=[],T=[];function C(){return T.length?(S.push(T.join("")),T=[],!0):!1}for(var R=function(I){var A=_[I].trim(),k=I,O=ai(h,function(M){var Q=M.open;return Q===A}),L=ai(h,function(M){var Q=M.close;return Q===A});if(O){if(k=h3(O,_,I,w,h),k!==-1&&u)return C()&&a||(S.push(_.slice(I,k+1).join("")),I=k,a)?(j=I,"break"):(j=I,"continue")}else if(L&&!QE(L,_,I)){var B=eW(h);return B.splice(h.indexOf(L),1),{value:ZE(n,{separator:i,isSeparateFirst:a,isSeparateOnlyOpenClose:o,isSeparateOpenClose:u,openCloseCharacters:B})}}else if(tW(A,i)&&!o)return C(),a?(j=I,"break"):(j=I,"continue");k===-1&&(k=w-1),T.push(_.slice(I,k+1).join("")),I=k,j=I},j,z=0;z<w;++z){var V=R(z);if(z=j,typeof V=="object")return V.value;if(V==="break")break}return T.length&&S.push(T.join("")),S}function ul(n){return ZE(n,"")}function cc(n){return ZE(n,",")}function p3(n){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(n);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function Gp(n){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(n);if(!e)return{prefix:"",unit:"",value:NaN};var t=e[1],r=e[2],i=e[3];return{prefix:t,unit:i,value:parseFloat(r)}}function rW(n){return n.replace(/[\s-_]+([^\s-_])/g,function(e,t){return t.toUpperCase()})}function b0(n,e){return n.replace(/([a-z])([A-Z])/g,function(t,r,i){return""+r+e+i.toLowerCase()})}function lp(){return Date.now?Date.now():new Date().getTime()}function Hs(n,e,t){t===void 0&&(t=-1);for(var r=n.length,i=0;i<r;++i)if(e(n[i],i,n))return i;return t}function ai(n,e,t){var r=Hs(n,e);return r>-1?n[r]:t}var g3=(function(){var n=lp(),e=f3&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(t){var r=lp(),i=setTimeout(function(){t(r-n)},1e3/60);return i}})(),iW=(function(){var n=f3&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return n?n.bind(window):function(e){clearTimeout(e)}})();function $s(n){return Object.keys(n)}function aW(n){var e=$s(n);return e.map(function(t){return n[t]})}function Xt(n,e){var t=Gp(n),r=t.value,i=t.unit;if(ya(e)){var a=e[i];if(a){if(WE(a))return a(r);if(Vm[i])return Vm[i](r,a)}}else if(i==="%")return r*e/100;return Vm[i]?Vm[i](r):r}function x_(n,e,t){return Math.max(e,Math.min(n,t))}function GD(n,e,t,r){return r===void 0&&(r=n[0]/n[1]),[[ct(e[0],Yn),ct(e[0]/r,Yn)],[ct(e[1]*r,Yn),ct(e[1],Yn)]].filter(function(i){return i.every(function(a,o){var c=e[o],u=ct(c,Yn);return t?a<=c||a<=u:a>=c||a>=u})})[0]||n}function m3(n,e,t,r){if(!r)return n.map(function(b,_){return x_(b,e[_],t[_])});var i=n[0],a=n[1],o=r===!0?i/a:r,c=GD(n,e,!1,o),u=c[0],d=c[1],h=GD(n,t,!0,o),p=h[0],m=h[1];return i<u||a<d?(i=u,a=d):(i>p||a>m)&&(i=p,a=m),[i,a]}function sW(n){for(var e=n.length,t=0,r=e-1;r>=0;--r)t+=n[r];return t}function __(n){for(var e=n.length,t=0,r=e-1;r>=0;--r)t+=n[r];return e?t/e:0}function Vn(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=Math.atan2(r,t);return i>=0?i:i+Math.PI*2}function oW(n){return[0,1].map(function(e){return __(n.map(function(t){return t[e]}))})}function qD(n){var e=oW(n),t=Vn(e,n[0]),r=Vn(e,n[1]);return t<r&&r-t<Math.PI||t>r&&r-t<-Math.PI?1:-1}function Os(n,e){return Math.sqrt(Math.pow((e?e[0]:0)-n[0],2)+Math.pow((e?e[1]:0)-n[1],2))}function ct(n,e){if(!e)return n;var t=1/e;return Math.round(n/e)/t}function HD(n,e){return n.forEach(function(t,r){n[r]=ct(n[r],e)}),n}function lW(n){for(var e=[],t=0;t<n;++t)e.push(t);return e}function v3(n){return n.reduce(function(e,t){return e.concat(t)},[])}function y3(n,e){n.indexOf(e)===-1&&n.push(e)}function ir(n,e){return n.classList?n.classList.contains(e):!!n.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function b3(n,e){n.classList?n.classList.add(e):n.className+=" "+e}function x3(n,e){if(n.classList)n.classList.remove(e);else{var t=new RegExp("(\\s|^)"+e+"(\\s|$)");n.className=n.className.replace(t," ")}}function wr(n,e,t,r){n.addEventListener(e,t,r)}function tr(n,e,t,r){n.removeEventListener(e,t,r)}function Hd(n){return n?.ownerDocument||ZX}function JE(n){return Hd(n).documentElement}function yl(n){return Hd(n).body}function nl(n){var e;return((e=n?.ownerDocument)===null||e===void 0?void 0:e.defaultView)||window}function _3(n){return n&&"postMessage"in n&&"blur"in n&&"self"in n}function $d(n){return ya(n)&&n.nodeName&&n.nodeType&&"ownerDocument"in n}var cW=(function(){function n(){this.keys=[],this.values=[]}var e=n.prototype;return e.get=function(t){return this.values[this.keys.indexOf(t)]},e.set=function(t,r){var i=this.keys,a=this.values,o=i.indexOf(t),c=o===-1?i.length:o;i[c]=t,a[c]=r},n})(),uW=(function(){function n(){this.object={}}var e=n.prototype;return e.get=function(t){return this.object[t]},e.set=function(t,r){this.object[t]=r},n})(),dW=typeof Map=="function",fW=(function(){function n(){}var e=n.prototype;return e.connect=function(t,r){this.prev=t,this.next=r,t&&(t.next=this),r&&(r.prev=this)},e.disconnect=function(){var t=this.prev,r=this.next;t&&(t.next=r),r&&(r.prev=t)},e.getIndex=function(){for(var t=this,r=-1;t;)t=t.prev,++r;return r},n})();function hW(n,e){var t=[],r=[];return n.forEach(function(i){var a=i[0],o=i[1],c=new fW;t[a]=c,r[o]=c}),t.forEach(function(i,a){i.connect(t[a-1])}),n.filter(function(i,a){return!e[a]}).map(function(i,a){var o=i[0],c=i[1];if(o===c)return[0,0];var u=t[o],d=r[c-1],h=u.getIndex();u.disconnect(),d?u.connect(d,d.next):u.connect(void 0,t[0]);var p=u.getIndex();return[h,p]})}var pW=(function(){function n(t,r,i,a,o,c,u,d){this.prevList=t,this.list=r,this.added=i,this.removed=a,this.changed=o,this.maintained=c,this.changedBeforeAdded=u,this.fixed=d}var e=n.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var t=hW(this.changedBeforeAdded,this.fixed),r=this.changed,i=[];this.cacheOrdered=t.filter(function(a,o){var c=a[0],u=a[1],d=r[o],h=d[0],p=d[1];if(c!==u)return i.push([h,p]),!0}),this.cachePureChanged=i},n})();function qp(n,e,t){var r=dW?Map:t?uW:cW,i=t||function(C){return C},a=[],o=[],c=[],u=n.map(i),d=e.map(i),h=new r,p=new r,m=[],b=[],_={},w=[],S=0,T=0;return u.forEach(function(C,R){h.set(C,R)}),d.forEach(function(C,R){p.set(C,R)}),u.forEach(function(C,R){var j=p.get(C);typeof j>"u"?(++T,o.push(R)):_[j]=T}),d.forEach(function(C,R){var j=h.get(C);typeof j>"u"?(a.push(R),++S):(c.push([j,R]),T=_[R]||0,m.push([j-T,R-S]),b.push(R===j),j!==R&&w.push([j,R]))}),o.reverse(),new pW(n,e,a,o,w,c,m,b)}var gW=(function(){function n(t,r){t===void 0&&(t=[]),this.findKeyCallback=r,this.list=[].slice.call(t)}var e=n.prototype;return e.update=function(t){var r=[].slice.call(t),i=qp(this.list,r,this.findKeyCallback);return this.list=r,i},n})(),w_=function(n,e){return w_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},w_(n,e)};function Hp(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");w_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var qa=function(){return qa=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},qa.apply(this,arguments)};function w3(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function $D(n,e,t){for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function YD(n){var e=0;return n.map(function(t){return t==null?"$compat".concat(++e):"".concat(t)})}function E3(n){var e=[];return n.forEach(function(t){e=e.concat(Wn(t)?E3(t):t)}),e}function Y1(n,e){if(!e)return n;for(var t in e)Qv(n[t])&&(n[t]=e[t]);return n}function rv(n,e){if(n===e)return!1;for(var t in n)if(!(t in e))return!0;for(var t in e)if(n[t]!==e[t])return!0;return!1}function KD(n){var e=n.className,t=w3(n,["className"]);return e!=null&&(t.class=e),delete t.style,delete t.children,t}function XD(n){var e={},t={};for(var r in n)r.indexOf("on")===0?t[r]=n[r]:e[r]=n[r];return[e,t]}function Zv(n){if(!n)return null;var e=n.b;return $d(e)?e:Zv(n.c)}function S3(n){var e=n.parentNode;e&&e.removeChild(n)}function T3(n){n.forEach(function(e){e()})}function mW(){return this.constructor(this.props,this.context)}var eS=0,Jv=(function(){function n(t,r,i,a,o,c,u){u===void 0&&(u={}),this.t=t,this.d=r,this.k=i,this.i=a,this.c=o,this.ref=c,this.ps=u,this.typ="prov",this._ps=[],this._cs={},this._hyd=null,this._sel=!1}var e=n.prototype;return e.s=function(){return!0},e.u=function(t,r,i,a,o){var c=this,u=c.d,d=aW(r).filter(function(_){return _.$_req}),h=E3(d.map(function(_){return _.$_subs})),p=ai(h,function(_){return _.d===u});if(c.b&&!ii(i)&&!o&&!c.s(i.props,a)&&!p){var m=h.reduce(function(_,w){var S=w.d;return _[0]?_[0].d===S&&_.push(w):S>u&&_.push(w),_},[]);return m.forEach(function(_){$p(_,_._ps,[_.o],t,r,!0)}),!1}c.o=i,c.ss(a);var b=c.ps;return ii(i)||(c.ps=i.props,c.ref=i.ref),tS(this),c.r(t,r,c.b?b:{},a),!0},e.md=function(){this.rr()},e.ss=function(){},e.ud=function(){this.rr()},e.rr=function(){var t=this,r=t.ref,i=t.fr;r&&r(i?i.current:t.b)},n})();function A3(){return Object.__CROACT_CURRENT_INSTNACE__}function vW(){return eS}function yW(n){eS=n}function tS(n){return Object.__CROACT_CURRENT_INSTNACE__=n,eS=0,n}var nS=(function(){function n(t,r){t===void 0&&(t={}),this.props=t,this.context=r,this.state={},this.$_timer=0,this.$_state={},this.$_subs=[],this.$_cs={}}var e=n.prototype;return e.render=function(){return null},e.shouldComponentUpdate=function(t,r){return this.props!==t||this.state!==r},e.setState=function(t,r,i){var a=this;a.$_timer||(a.$_state={}),clearTimeout(a.$_timer),a.$_timer=0,a.$_state=qa(qa({},a.$_state),t),i?a.$_setState(r,i):a.$_timer=window.setTimeout(function(){a.$_timer=0,a.$_setState(r,i)})},e.forceUpdate=function(t){this.setState({},t,!0)},e.componentDidMount=function(){},e.componentDidUpdate=function(t,r){},e.componentWillUnmount=function(){},e.$_setState=function(t,r){var i=[],a=this.$_p,o=$p(a.c,[a],[a.o],i,a._cs,qa(qa({},this.state),this.$_state),r);o&&(t&&i.push(t),T3(i),tS(null))},n})(),C3=(function(n){Hp(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}var t=e.prototype;return t.shouldComponentUpdate=function(r,i){return rv(this.props,r)||rv(this.state,i)},e})(nS);function I3(n){var e=function(t){e.current=t};return e.current=n,e}function bW(n){return n._fr=!0,n}function xW(n,e,t,r){var i,a;return!((i=n?.prototype)===null||i===void 0)&&i.render?a=new n(e,t):(a=new nS(e,t),a.constructor=n,n._fr?(r.fr=I3(),a.render=function(){return this.constructor(this.props,r.fr)}):a.render=mW),a.$_p=r,a}var _W=(function(n){Hp(e,n);function e(r,i,a,o,c,u,d){d===void 0&&(d={});var h=n.call(this,r,i,a,o,c,u,Y1(d,r.defaultProps))||this;return h.typ="comp",h._usefs=[],h._uefs=[],h._defs=[],h}var t=e.prototype;return t.s=function(r,i){var a=this.b;return a.shouldComponentUpdate(Y1(r,this.t.defaultProps),i||a.state)!==!1},t.r=function(r,i,a){var o,c,u=this,d=u.t;u.ps=Y1(u.ps,u.t.defaultProps);var h=u.ps,p=!u.b,m=d.contextType,b=u.b,_=m?.get(u);u._cs=i,p?(b=xW(d,h,_,u),u.b=b):(b.props=h,b.context=_);var w=b.state;u._usefs=[],u._uefs=[];var S=b.render();((c=(o=S?.props)===null||o===void 0?void 0:o.children)===null||c===void 0?void 0:c.length)===0&&(S.props.children=u.ps.children);var T=qa(qa({},i),b.$_cs);$p(u,u._ps,S?[S]:[],r,T),p?u._uefs.push(function(){m?.register(u),b.componentDidMount()}):u._uefs.push(function(){b.componentDidUpdate(a,w)}),r.push(function(){u._usefs.forEach(function(C){C()}),p?u.md():u.ud(),u._defs=u._uefs.map(function(C){return C()})})},t.ss=function(r){var i=this.b;!i||!r||(i.state=r)},t.un=function(){var r,i=this;i._ps.forEach(function(o){o.un()});var a=i.t;(r=a.contextType)===null||r===void 0||r.unregister(i),clearTimeout(i.b.$_timer),i._defs.forEach(function(o){o&&o()}),i.b.componentWillUnmount()},e})(Jv);function wW(n,e,t){var r=rS(KD(n),KD(e)),i=r.added,a=r.removed,o=r.changed;for(var c in i)t.setAttribute(c,i[c]);for(var u in o)t.setAttribute(u,o[u][1]);for(var d in a)t.removeAttribute(d)}function EW(n,e,t){var r=rS(n,e),i=r.added,a=r.removed;for(var o in a)t.e(o,!0);for(var c in i)t.e(c)}function rS(n,e){var t=$s(n),r=$s(e),i=qp(t,r,function(u){return u}),a={},o={},c={};return i.added.forEach(function(u){var d=r[u];a[d]=e[d]}),i.removed.forEach(function(u){var d=t[u];o[d]=n[d]}),i.maintained.forEach(function(u){var d=u[0],h=t[d],p=[n[h],e[h]];n[h]!==e[h]&&(c[h]=p)}),{added:a,removed:o,changed:c}}function SW(n,e,t){var r=t.style,i=rS(n,e),a=i.added,o=i.removed,c=i.changed;for(var u in a){var d=b0(u,"-");r.setProperty(d,a[u])}for(var u in c){var h=b0(u,"-");r.setProperty(h,c[u][1])}for(var u in o){var p=b0(u,"-");r.removeProperty(p)}}function TW(n){return n.replace(/^on/g,"").toLowerCase()}var AW=(function(n){Hp(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r.typ="elem",r._es={},r._svg=!1,r}var t=e.prototype;return t.e=function(r,i){var a=this,o=a._es,c=a.b,u=TW(r);i?(tr(c,u,o[r]),delete o[r]):(o[r]=function(d){var h,p;(p=(h=a.ps)[r])===null||p===void 0||p.call(h,d)},wr(c,u,o[r]))},t.s=function(r){return rv(this.ps,r)},t.r=function(r,i,a){var o,c=this,u=!c.b,d=c.ps;if(u){var h=Zv(c.c),p=!1;c._svg||c.t==="svg"?p=!0:p=h&&h.ownerSVGElement,c._svg=p;var m=(o=c._hyd)===null||o===void 0?void 0:o.splice(0,1)[0],b=c.t;if(m)c._hyd=[].slice.call(m.children||[]);else{var _=Hd(h);p?m=_.createElementNS("http://www.w3.org/2000/svg",b):m=_.createElement(b)}c.b=m}$p(c,c._ps,d.children,r,i);var w=c.b,S=XD(a),T=S[0],C=S[1],R=XD(d),j=R[0],z=R[1];return wW(T,j,w),EW(C,z,c),SW(a.style||{},d.style||{},w),r.push(function(){u?c.md():c.ud()}),!0},t.un=function(){var r=this,i=r._es,a=r.b;for(var o in i)tr(a,o,i[o]);r._ps.forEach(function(c){c.un()}),r._es={},r._sel||S3(a)},e})(Jv);function cp(n){if(!n||$d(n))return n;var e=n.$_p._ps;return e.length?cp(e[0].b):null}function R3(n){if(n){if(n.b&&$d(n.b))return n;var e=n._ps;return e.length?R3(e[0]):null}}function ha(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=e||{},a=i.key,o=i.ref,c=w3(i,["key","ref"]);return{type:n,key:a,ref:o,props:qa(qa({},c),{children:v3(t).filter(function(u){return u!=null&&u!==!1})})}}var D3=(function(n){Hp(e,n);function e(r,i){i===void 0&&(i=0);var a=n.call(this,"container",i,"container",0,null)||this;return a.typ="container",a.b=r,a}var t=e.prototype;return t.r=function(){return!0},t.un=function(){},e})(Jv),CW=(function(n){Hp(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r.typ="text",r}var t=e.prototype;return t.r=function(r){var i,a=this,o=!a.b;if(o){var c=Zv(a.c),u=(i=a._hyd)===null||i===void 0?void 0:i.splice(0,1)[0];a.b=u||Hd(c).createTextNode(a.t.replace("text_",""))}return r.push(function(){o?a.md():a.ud()}),!0},t.un=function(){S3(this.b)},e})(Jv);function IW(n,e,t){var r=t.map(function(u){return ii(u)?null:u.key}),i=YD(e.map(function(u){return u.k})),a=YD(r),o=qp(i,a,function(u){return u});o.removed.forEach(function(u){e.splice(u,1)[0].un()}),o.ordered.forEach(function(u){var d=u[0],h=u[1],p=e.splice(d,1)[0];e.splice(h,0,p);var m=cp(p.b),b=cp(e[h+1]&&e[h+1].b);m&&m.parentNode.insertBefore(m,b)}),o.added.forEach(function(u){e.splice(u,0,WD(t[u],r[u],u,n))});var c=o.maintained.filter(function(u){u[0];var d=u[1],h=t[d],p=e[d],m=ii(h)?"text_".concat(h):h.type;return m!==p.t?(p.un(),e.splice(d,1,WD(h,r[d],d,n)),!0):(p.i=d,!1)});return $D($D([],o.added,!0),c.map(function(u){u[0];var d=u[1];return d}))}function RW(n,e){for(var t=n._ps,r=t.length,i=e.i+1;i<r;++i){var a=cp(t[i].b);if(a)return a}return null}function WD(n,e,t,r){var i=r.d+1;if(ii(n)||Sd(n))return new CW("text_".concat(n),i,e,t,r,null,{});var a=n.type,o=typeof a=="string"?AW:_W;return new o(a,i,e,t,r,n.ref,n.props)}function $p(n,e,t,r,i,a,o){var c=IW(n,e,t),u=n._hyd,d=e.filter(function(p,m){return p._hyd=u,p.u(r,i,t[m],a,o)});n.typ==="container"&&n._sel&&e.forEach(function(p){var m=R3(p);m&&(m._sel=!0)}),n._hyd=null;var h=Zv(n);return h&&c.reverse().forEach(function(p){var m=e[p],b=cp(m.b);if(b&&h!==b&&!b.parentNode){var _=RW(n,m);h.insertBefore(b,_)}}),d.length>0}function DW(n,e,t,r){t===void 0&&(t=e.__CROACT__),r===void 0&&(r={});var i=!!t;t||(t=new D3(e));var a=[];return $p(t,t._ps,n?[n]:[],a,r,void 0,void 0),T3(a),tS(null),i||(e.__CROACT__=t),t}function QD(n,e,t){return!t&&n&&(t=new D3(e.parentElement),t._hyd=[e],t._sel=!0),DW(n,e,t),t}function k3(n){var e=A3(),t=e._hs||(e._hs=[]),r=vW(),i=t[r];if(yW(r+1),i){if(!rv(i.deps,n.deps))return i.updated=!1,i;t[r]=n}else t.push(n);return n.value=n.func(),n.updated=!0,n}function kW(n,e){var t=k3({func:n,deps:e});return t.value}function NW(n){return kW(function(){return I3(n)},[])}function N3(n,e,t){var r=A3(),i=k3({func:function(){return n},deps:e}),a=t?r._usefs:r._uefs;i.updated?a.push(function(){return i.effect&&i.effect(),i.effect=n(),i.effect}):a.push(function(){return i.effect})}function MW(n,e,t){N3(function(){n?.(e())},t,!0)}function iS(n,e){for(var t=n.length,r=0;r<t;++r)if(e(n[r],r))return!0;return!1}function M3(n,e){for(var t=n.length,r=0;r<t;++r)if(e(n[r],r))return n[r];return null}function P3(n){var e=n;if(typeof e>"u"){if(typeof navigator>"u"||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function aS(n,e){try{return new RegExp(n,"g").exec(e)}catch{return null}}function PW(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var n=navigator.userAgentData,e=n.brands||n.uaList;return!!(e&&e.length)}function OW(n,e){var t=aS("("+n+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return t?t[3]:""}function E_(n){return n.replace(/_/g,".")}function fh(n,e){var t=null,r="-1";return iS(n,function(i){var a=aS("("+i.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!a||i.brand?!1:(t=i,r=a[3]||"-1",i.versionAlias?r=i.versionAlias:i.versionTest&&(r=OW(i.versionTest.toLowerCase(),e)||r),r=E_(r),!0)}),{preset:t,version:r}}function jm(n,e){var t={brand:"",version:"-1"};return iS(n,function(r){var i=O3(e,r);return i?(t.brand=r.id,t.version=r.versionAlias||i.version,t.version!=="-1"):!1}),t}function O3(n,e){return M3(n,function(t){var r=t.brand;return aS(""+e.test,r.toLowerCase())})}var V3=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],j3=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],S_=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],z3=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],L3=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function B3(n){return!!fh(z3,n).preset}function VW(n){var e=P3(n),t=!!/mobi/g.exec(e),r={name:"unknown",version:"-1",majorVersion:-1,webview:B3(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},a=fh(V3,e),o=a.preset,c=a.version,u=fh(L3,e),d=u.preset,h=u.version,p=fh(j3,e);if(r.chromium=!!p.preset,r.chromiumVersion=p.version,!r.chromium){var m=fh(S_,e);r.webkit=!!m.preset,r.webkitVersion=m.version}return d&&(i.name=d.id,i.version=h,i.majorVersion=parseInt(h,10)),o&&(r.name=o.id,r.version=c,r.webview&&i.name==="ios"&&r.name!=="safari"&&(r.webview=!1)),r.majorVersion=parseInt(r.version,10),{browser:r,os:i,isMobile:t,isHints:!1}}function jW(n){var e=navigator.userAgentData,t=(e.uaList||e.brands).slice(),r=e.mobile||!1,i=t[0],a=(e.platform||navigator.platform).toLowerCase(),o={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!jm(z3,t).brand||B3(P3())},c={name:"unknown",version:"-1",majorVersion:-1};o.webkit=!o.chromium&&iS(S_,function(m){return O3(t,m)});var u=jm(j3,t);if(o.chromium=!!u.brand,o.chromiumVersion=u.version||"-1",!o.chromium){var d=jm(S_,t);o.webkit=!!d.brand,o.webkitVersion=d.version||"-1"}var h=M3(L3,function(m){return new RegExp(""+m.test,"g").exec(a)});c.name=h?h.id:"";{var p=jm(V3,t);o.name=p.brand||o.name,o.version=p.brand&&n?n.uaFullVersion:p.version}return o.webkit&&(c.name=r?"ios":"mac"),c.name==="ios"&&o.webview&&(o.version="-1"),c.version=E_(c.version),o.version=E_(o.version),c.majorVersion=parseInt(c.version,10),o.majorVersion=parseInt(o.version,10),{browser:o,os:c,isMobile:r,isHints:!0}}function zW(n){return PW()?jW():VW(n)}function LW(n,e,t,r,i,a){for(var o=0;o<i;++o){var c=t+o*i,u=r+o*i;n[c]+=n[u]*a,e[c]+=e[u]*a}}function BW(n,e,t,r,i){for(var a=0;a<i;++a){var o=t+a*i,c=r+a*i,u=n[o],d=e[o];n[o]=n[c],n[c]=u,e[o]=e[c],e[c]=d}}function UW(n,e,t,r,i){for(var a=0;a<r;++a){var o=t+a*r;n[o]/=i,e[o]/=i}}function U3(n,e,t){for(var r=n.slice(),i=0;i<t;++i)r[i*t+e-1]=0,r[(e-1)*t+i]=0;return r[(e-1)*(t+1)]=1,r}function ts(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=n.slice(),r=rn(e),i=0;i<e;++i){var a=e*i+i;if(!ct(t[a],Yn)){for(var o=i+1;o<e;++o)if(t[e*i+o]){BW(t,r,i,o,e);break}}if(!ct(t[a],Yn))return[];UW(t,r,i,e,t[a]);for(var o=0;o<e;++o){var c=o,u=o+i*e,d=t[u];!ct(d,Yn)||i===o||LW(t,r,c,i,e,-d)}}return r}function FW(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=[],r=0;r<e;++r)for(var i=0;i<e;++i)t[i*e+r]=n[e*r+i];return t}function F3(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=[],r=n[e*e-1],i=0;i<e-1;++i)t[i]=n[e*(e-1)+i]/r;return t[e-1]=0,t}function GW(n,e){for(var t=rn(e),r=0;r<e-1;++r)t[e*(e-1)+r]=n[r]||0;return t}function Dc(n,e){for(var t=n.slice(),r=n.length;r<e-1;++r)t[r]=0;return t[e-1]=1,t}function ba(n,e,t){if(e===void 0&&(e=Math.sqrt(n.length)),e===t)return n;for(var r=rn(t),i=Math.min(e,t),a=0;a<i-1;++a){for(var o=0;o<i-1;++o)r[a*t+o]=n[a*e+o];r[(a+1)*t-1]=n[(a+1)*e-1],r[(t-1)*t+a]=n[(e-1)*e+a]}return r[t*t-1]=n[e*e-1],r}function iv(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var r=rn(n);return e.forEach(function(i){r=Wt(r,i,n)}),r}function Wt(n,e,t){t===void 0&&(t=Math.sqrt(n.length));var r=[],i=n.length/t,a=e.length/i;if(i){if(!a)return n}else return e;for(var o=0;o<t;++o)for(var c=0;c<a;++c){r[c*t+o]=0;for(var u=0;u<i;++u)r[c*t+o]+=n[u*t+o]*e[c*i+u]}return r}function Nt(n,e){for(var t=Math.min(n.length,e.length),r=n.slice(),i=0;i<t;++i)r[i]=r[i]+e[i];return r}function $e(n,e){for(var t=Math.min(n.length,e.length),r=n.slice(),i=0;i<t;++i)r[i]=r[i]-e[i];return r}function qW(n,e){return e===void 0&&(e=n.length===6),e?[n[0],n[1],0,n[2],n[3],0,n[4],n[5],1]:n}function G3(n,e){return e===void 0&&(e=n.length===9),e?[n[0],n[1],n[3],n[4],n[6],n[7]]:n}function Or(n,e,t){t===void 0&&(t=e.length);var r=Wt(n,e,t),i=r[t-1];return r.map(function(a){return a/i})}function HW(n,e){return Wt(n,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function $W(n,e){return Wt(n,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function YW(n,e){return Wt(n,Kp(e,4))}function zm(n,e){var t=e[0],r=t===void 0?1:t,i=e[1],a=i===void 0?1:i,o=e[2],c=o===void 0?1:o;return Wt(n,[r,0,0,0,0,a,0,0,0,0,c,0,0,0,0,1],4)}function Yp(n,e){return Or(Kp(e,3),Dc(n,3))}function K1(n,e){var t=e[0],r=t===void 0?0:t,i=e[1],a=i===void 0?0:i,o=e[2],c=o===void 0?0:o;return Wt(n,[1,0,0,0,0,1,0,0,0,0,1,0,r,a,c,1],4)}function ZD(n,e){return Wt(n,e,4)}function Kp(n,e){var t=Math.cos(n),r=Math.sin(n),i=rn(e);return i[0]=t,i[1]=r,i[e]=-r,i[e+1]=t,i}function rn(n){for(var e=n*n,t=[],r=0;r<e;++r)t[r]=r%(n+1)?0:1;return t}function sS(n,e){for(var t=rn(e),r=Math.min(n.length,e-1),i=0;i<r;++i)t[(e+1)*i]=n[i];return t}function kc(n,e){for(var t=rn(e),r=Math.min(n.length,e-1),i=0;i<r;++i)t[e*(e-1)+i]=n[i];return t}function oS(n,e,t,r,i,a,o,c){var u=n[0],d=n[1],h=e[0],p=e[1],m=t[0],b=t[1],_=r[0],w=r[1],S=i[0],T=i[1],C=a[0],R=a[1],j=o[0],z=o[1],V=c[0],I=c[1],A=[u,0,h,0,m,0,_,0,d,0,p,0,b,0,w,0,1,0,1,0,1,0,1,0,0,u,0,h,0,m,0,_,0,d,0,p,0,b,0,w,0,1,0,1,0,1,0,1,-S*u,-T*u,-C*h,-R*h,-j*m,-z*m,-V*_,-I*_,-S*d,-T*d,-C*p,-R*p,-j*b,-z*b,-V*w,-I*w],k=ts(A,8);if(!k.length)return[];var O=Wt(k,[S,T,C,R,j,z,V,I],8);return O[8]=1,ba(FW(O),3,4)}var Dh=function(){return Dh=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Dh.apply(this,arguments)};function KW(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function up(n,e){return e===void 0&&(e=0),Lu(Td(n,e))}function XW(n,e){var t=Or(n,[e[0],e[1]||0,e[2]||0,1],4),r=t[3]||1;return[t[0]/r,t[1]/r,t[2]/r]}function Lu(n){var e=KW();return n.forEach(function(t){var r=t.matrixFunction,i=t.functionValue;r&&(e=r(e,i))}),e}function Td(n,e){e===void 0&&(e=0);var t=Wn(n)?n:ul(n);return t.map(function(r){var i=p3(r),a=i.prefix,o=i.value,c=null,u=a,d="";if(a==="translate"||a==="translateX"||a==="translate3d"){var h=ya(e)?Dh(Dh({},e),{"o%":e["%"]}):{"%":e,"o%":e},p=cc(o).map(function(M,Q){return Q===0&&"x%"in h?h["%"]=e["x%"]:Q===1&&"y%"in h?h["%"]=e["y%"]:h["%"]=e["o%"],Xt(M,h)}),m=p[0],b=p[1],_=b===void 0?0:b,w=p[2],S=w===void 0?0:w;c=K1,d=[m,_,S]}else if(a==="translateY"){var T=ya(e)?Dh({"%":e["y%"]},e):{"%":e},_=Xt(o,T);c=K1,d=[0,_,0]}else if(a==="translateZ"){var S=parseFloat(o);c=K1,d=[0,0,S]}else if(a==="scale"||a==="scale3d"){var C=cc(o).map(function(M){return parseFloat(M)}),R=C[0],j=C[1],z=j===void 0?R:j,V=C[2],I=V===void 0?1:V;c=zm,d=[R,z,I]}else if(a==="scaleX"){var R=parseFloat(o);c=zm,d=[R,1,1]}else if(a==="scaleY"){var z=parseFloat(o);c=zm,d=[1,z,1]}else if(a==="scaleZ"){var I=parseFloat(o);c=zm,d=[1,1,I]}else if(a==="rotate"||a==="rotateZ"||a==="rotateX"||a==="rotateY"){var A=Gp(o),k=A.unit,O=A.value,L=k==="rad"?O:O*Math.PI/180;a==="rotate"||a==="rotateZ"?(u="rotateZ",c=YW):a==="rotateX"?c=HW:a==="rotateY"&&(c=$W),d=L}else if(a==="matrix3d")c=ZD,d=cc(o).map(function(M){return parseFloat(M)});else if(a==="matrix"){var B=cc(o).map(function(M){return parseFloat(M)});c=ZD,d=[B[0],B[1],0,0,B[2],B[3],0,0,0,0,1,0,B[4],B[5],0,1]}else u="";return{name:a,functionName:u,value:o,matrixFunction:c,functionValue:d}})}var T_=function(n,e){return T_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},T_(n,e)};function WW(n,e){T_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var q3=typeof Map=="function"?void 0:(function(){var n=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++n)}})(),H3=(function(n){WW(e,n);function e(t){return t===void 0&&(t=[]),n.call(this,t,q3)||this}return e})(gW);function QW(n,e){return qp(n,e,q3)}var A_=function(){return A_=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},A_.apply(this,arguments)};function ZW(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}var ey=(function(){function n(){this._events={}}var e=n.prototype;return e.on=function(t,r){if(ya(t))for(var i in t)this.on(i,t[i]);else this._addEvent(t,r,{});return this},e.off=function(t,r){if(!t)this._events={};else if(ya(t))for(var i in t)this.off(i);else if(!r)this._events[t]=[];else{var a=this._events[t];if(a){var o=Hs(a,function(c){return c.listener===r});o>-1&&a.splice(o,1)}}return this},e.once=function(t,r){var i=this;return r&&this._addEvent(t,r,{once:!0}),new Promise(function(a){i._addEvent(t,a,{once:!0})})},e.emit=function(t,r){var i=this;r===void 0&&(r={});var a=this._events[t];if(!t||!a)return!0;var o=!1;return r.eventType=t,r.stop=function(){o=!0},r.currentTarget=this,ZW(a).forEach(function(c){c.listener(r),c.once&&i.off(t,c.listener)}),!o},e.trigger=function(t,r){return r===void 0&&(r={}),this.emit(t,r)},e._addEvent=function(t,r,i){var a=this._events;a[t]=a[t]||[];var o=a[t];o.push(A_({listener:r},i))},n})();var C_=function(n,e){return C_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},C_(n,e)};function JW(n,e){C_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var $u=function(){return $u=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},$u.apply(this,arguments)};function eQ(n){var e=n.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function JD(n,e){return n.addEventListener("scroll",e),function(){n.removeEventListener("scroll",e)}}function Lm(n){if(n){if(ii(n))return document.querySelector(n)}else return null;if(WE(n))return n();if(n instanceof Element)return n;if("current"in n)return n.current;if("value"in n)return n.value}var tQ=(function(n){JW(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r._startRect=null,r._startPos=[],r._prevTime=0,r._timer=0,r._prevScrollPos=[0,0],r._isWait=!1,r._flag=!1,r._currentOptions=null,r._lock=!1,r._unregister=null,r._onScroll=function(){var i=r._currentOptions;r._lock||!i||r.emit("scrollDrag",{next:function(a){r.checkScroll({container:i.container,inputEvent:a})}})},r}var t=e.prototype;return t.dragStart=function(r,i){var a=Lm(i.container);if(!a){this._flag=!1;return}var o=0,c=0,u=0,d=0;if(a===document.body)u=window.innerWidth,d=window.innerHeight;else{var h=a.getBoundingClientRect();o=h.top,c=h.left,u=h.width,d=h.height}this._flag=!0,this._startPos=[r.clientX,r.clientY],this._startRect={top:o,left:c,width:u,height:d},this._prevScrollPos=this._getScrollPosition([0,0],i),this._currentOptions=i,this._registerScrollEvent(i)},t.drag=function(r,i){if(clearTimeout(this._timer),!!this._flag){var a=r.clientX,o=r.clientY,c=i.threshold,u=c===void 0?0:c,d=this,h=d._startRect,p=d._startPos;this._currentOptions=i;var m=[0,0];return h.top>o-u?(p[1]>h.top||o<p[1])&&(m[1]=-1):h.top+h.height<o+u&&(p[1]<h.top+h.height||o>p[1])&&(m[1]=1),h.left>a-u?(p[0]>h.left||a<p[0])&&(m[0]=-1):h.left+h.width<a+u&&(p[0]<h.left+h.width||a>p[0])&&(m[0]=1),!m[0]&&!m[1]?!1:this._continueDrag($u($u({},i),{direction:m,inputEvent:r,isDrag:!0}))}},t.checkScroll=function(r){var i=this;if(this._isWait)return!1;var a=r.prevScrollPos,o=a===void 0?this._prevScrollPos:a,c=r.direction,u=r.throttleTime,d=u===void 0?0:u,h=r.inputEvent,p=r.isDrag,m=this._getScrollPosition(c||[0,0],r),b=m[0]-o[0],_=m[1]-o[1],w=c||[b?Math.abs(b)/b:0,_?Math.abs(_)/_:0];return this._prevScrollPos=m,this._lock=!1,!b&&!_?!1:(this.emit("move",{offsetX:w[0]?b:0,offsetY:w[1]?_:0,inputEvent:h}),d&&p&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},d)),!0)},t.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},t._getScrollPosition=function(r,i){var a=i.container,o=i.getScrollPosition,c=o===void 0?eQ:o;return c({container:Lm(a),direction:r})},t._continueDrag=function(r){var i=this,a,o=r.container,c=r.direction,u=r.throttleTime,d=r.useScroll,h=r.isDrag,p=r.inputEvent;if(!(!this._flag||h&&this._isWait)){var m=lp(),b=Math.max(u+this._prevTime-m,0);if(b>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},b),!1;this._prevTime=m;var _=this._getScrollPosition(c,r);this._prevScrollPos=_,h&&(this._isWait=!0),d||(this._lock=!0);var w={container:Lm(o),direction:c,inputEvent:p};return(a=r.requestScroll)===null||a===void 0||a.call(r,w),this.emit("scroll",w),this._isWait=!1,d||this.checkScroll($u($u({},r),{prevScrollPos:_,direction:c,inputEvent:p}))}},t._registerScrollEvent=function(r){this._unregisterScrollEvent();var i=r.checkScrollEvent;if(i){var a=i===!0?JD:i,o=Lm(r.container);i===!0&&(o===document.body||o===document.documentElement)?this._unregister=JD(window,this._onScroll):this._unregister=a(o,this._onScroll)}},t._unregisterScrollEvent=function(){var r;(r=this._unregister)===null||r===void 0||r.call(this),this._unregister=null},e})(ey);function nQ(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}function ti(n){return ct(n,Yn)}function rQ(n,e){return n.every(function(t,r){return ti(t-e[r])===0})}function iQ(n,e){return!ti(n[0]-e[0])&&!ti(n[1]-e[1])}function $3(n){return n.length<3?0:Math.abs(sW(n.map(function(e,t){var r=n[t+1]||n[0];return e[0]*r[1]-r[0]*e[1]})))/2}function ek(n,e){var t=e.width,r=e.height,i=e.left,a=e.top,o=Nc(n),c=o.minX,u=o.minY,d=o.maxX,h=o.maxY,p=t/(d-c),m=r/(h-u);return n.map(function(b){return[i+(b[0]-c)*p,a+(b[1]-u)*m]})}function Nc(n){var e=n.map(function(r){return r[0]}),t=n.map(function(r){return r[1]});return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,t),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,t)}}function I_(n,e,t){var r=n[0],i=n[1],a=Nc(e),o=a.minX,c=a.maxX,u=[[o,i],[c,i]],d=av(u[0],u[1]),h=R_(e),p=[];if(h.forEach(function(_){var w=av(_[0],_[1]),S=_[0];if(rQ(d,w))p.push({pos:n,line:_,type:"line"});else{var T=Y3(lS(d,w),[u,_]);T.forEach(function(C){_.some(function(R){return iQ(R,C)})?p.push({pos:C,line:_,type:"point"}):ti(S[1]-i)!==0&&p.push({pos:C,line:_,type:"intersection"})})}}),ai(p,function(_){return _[0]===r}))return!0;var m=0,b={};return p.forEach(function(_){var w=_.pos,S=_.type,T=_.line;if(!(w[0]>r))if(S==="intersection")++m;else{if(S==="line")return;if(S==="point"){var C=ai(T,function(z){return z[1]!==i}),R=b[w[0]],j=C[1]>i?1:-1;R?R!==j&&++m:b[w[0]]=j}}}),m%2===1}function av(n,e){var t=n[0],r=n[1],i=e[0],a=e[1],o=i-t,c=a-r;Math.abs(o)<Yn&&(o=0),Math.abs(c)<Yn&&(c=0);var u=0,d=0,h=0;return o?c?(u=-c/o,d=1,h=-u*t-r):(d=1,h=-r):c&&(u=-1,h=t),[u,d,h]}function lS(n,e){var t=n[0],r=n[1],i=n[2],a=e[0],o=e[1],c=e[2],u=t===0&&a===0,d=r===0&&o===0,h=[];if(u&&d)return[];if(u){var p=-i/r,m=-c/o;return p!==m?[]:[[-1/0,p],[1/0,p]]}else if(d){var b=-i/t,_=-c/a;return b!==_?[]:[[b,-1/0],[b,1/0]]}else if(t===0){var w=-i/r,S=-(o*w+c)/a;h=[[S,w]]}else if(a===0){var w=-c/o,S=-(r*w+i)/t;h=[[S,w]]}else if(r===0){var S=-i/t,w=-(a*S+c)/o;h=[[S,w]]}else if(o===0){var S=-c/a,w=-(t*S+i)/r;h=[[S,w]]}else{var S=(r*c-o*i)/(o*t-r*a),w=-(t*S+i)/r;h=[[S,w]]}return h.map(function(T){return[T[0],T[1]]})}function Y3(n,e){var t=e.map(function(p){return[0,1].map(function(m){return[Math.min(p[0][m],p[1][m]),Math.max(p[0][m],p[1][m])]})}),r=[];if(n.length===2){var i=n[0],a=i[0],o=i[1];if(ti(a-n[1][0])){if(!ti(o-n[1][1])){var d=Math.max.apply(Math,t.map(function(p){return p[0][0]})),h=Math.min.apply(Math,t.map(function(p){return p[0][1]}));if(ti(d-h)>0)return[];r=[[d,o],[h,o]]}}else{var c=Math.max.apply(Math,t.map(function(p){return p[1][0]})),u=Math.min.apply(Math,t.map(function(p){return p[1][1]}));if(ti(c-u)>0)return[];r=[[a,c],[a,u]]}}return r.length||(r=n.filter(function(p){var m=p[0],b=p[1];return t.every(function(_){return 0<=ti(m-_[0][0])&&0<=ti(_[0][1]-m)&&0<=ti(b-_[1][0])&&0<=ti(_[1][1]-b)})})),r.map(function(p){return[ti(p[0]),ti(p[1])]})}function R_(n){return nQ(n.slice(1),[n[0]]).map(function(e,t){return[n[t],e]})}function aQ(n,e){var t=n.slice(),r=e.slice();qD(t)===-1&&t.reverse(),qD(r)===-1&&r.reverse();var i=R_(t),a=R_(r),o=i.map(function(h){return av(h[0],h[1])}),c=a.map(function(h){return av(h[0],h[1])}),u=[];o.forEach(function(h,p){var m=i[p],b=[];c.forEach(function(_,w){var S=lS(h,_),T=Y3(S,[m,a[w]]);b.push.apply(b,T.map(function(C){return{index1:p,index2:w,pos:C,type:"intersection"}}))}),b.sort(function(_,w){return Os(m[0],_.pos)-Os(m[0],w.pos)}),u.push.apply(u,b),I_(m[1],r)&&u.push({index1:p,index2:-1,pos:m[1],type:"inside"})}),a.forEach(function(h,p){if(I_(h[1],t)){var m=!1,b=Hs(u,function(_){var w=_.index2;return w===p?(m=!0,!1):!!m});b===-1&&(m=!1,b=Hs(u,function(_){var w=_.index1,S=_.index2;return w===-1&&S+1===p?(m=!0,!1):!!m})),b===-1?u.push({index1:-1,index2:p,pos:h[1],type:"inside"}):u.splice(b,0,{index1:-1,index2:p,pos:h[1],type:"inside"})}});var d={};return u.filter(function(h){var p=h.pos,m=p[0]+"x"+p[1];return d[m]?!1:(d[m]=!0,!0)})}function sQ(n,e){var t=aQ(n,e);return t.map(function(r){var i=r.pos;return i})}function oQ(n,e){var t=sQ(n,e);return $3(t)}var D_=function(n,e){return D_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},D_(n,e)};function lQ(n,e){D_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var qn=function(){return qn=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},qn.apply(this,arguments)};function cQ(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=Math.atan2(r,t);return i>=0?i:i+Math.PI*2}function X1(n){return cQ([n[0].clientX,n[0].clientY],[n[1].clientX,n[1].clientY])/Math.PI*180}function uQ(n){return n.touches&&n.touches.length>=2}function Bm(n){return n?n.touches?fQ(n.touches):[K3(n)]:[]}function dQ(n){return n&&(n.type.indexOf("mouse")>-1||"button"in n)}function tk(n,e,t){var r=t.length,i=kh(n,r),a=i.clientX,o=i.clientY,c=i.originalClientX,u=i.originalClientY,d=kh(e,r),h=d.clientX,p=d.clientY,m=kh(t,r),b=m.clientX,_=m.clientY,w=a-h,S=o-p,T=a-b,C=o-_;return{clientX:c,clientY:u,deltaX:w,deltaY:S,distX:T,distY:C}}function W1(n){return Math.sqrt(Math.pow(n[0].clientX-n[1].clientX,2)+Math.pow(n[0].clientY-n[1].clientY,2))}function fQ(n){for(var e=Math.min(n.length,2),t=[],r=0;r<e;++r)t.push(K3(n[r]));return t}function K3(n){return{clientX:n.clientX,clientY:n.clientY}}function kh(n,e){e===void 0&&(e=n.length);for(var t={clientX:0,clientY:0,originalClientX:0,originalClientY:0},r=Math.min(n.length,e),i=0;i<r;++i){var a=n[i];t.originalClientX+="originalClientX"in a?a.originalClientX:a.clientX,t.originalClientY+="originalClientY"in a?a.originalClientY:a.clientY,t.clientX+=a.clientX,t.clientY+=a.clientY}return e?{clientX:t.clientX/e,clientY:t.clientY/e,originalClientX:t.originalClientX/e,originalClientY:t.originalClientY/e}:t}var Q1=(function(){function n(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return n.prototype.getAngle=function(e){return e===void 0&&(e=this.prevClients),X1(e)},n.prototype.getRotation=function(e){return e===void 0&&(e=this.prevClients),X1(e)-X1(this.startClients)},n.prototype.getPosition=function(e,t){e===void 0&&(e=this.prevClients);var r=tk(e||this.prevClients,this.prevClients,this.startClients),i=r.deltaX,a=r.deltaY;return this.movement+=Math.sqrt(i*i+a*a),this.prevClients=e,r},n.prototype.getPositions=function(e){e===void 0&&(e=this.prevClients);for(var t=this.prevClients,r=this.startClients,i=Math.min(this.length,t.length),a=[],o=0;o<i;++o)a[o]=tk([e[o]],[t[o]],[r[o]]);return a},n.prototype.getMovement=function(e){var t=this.movement;if(!e)return t;var r=kh(e,this.length),i=kh(this.prevClients,this.length),a=r.clientX-i.clientX,o=r.clientY-i.clientY;return Math.sqrt(a*a+o*o)+t},n.prototype.getDistance=function(e){return e===void 0&&(e=this.prevClients),W1(e)},n.prototype.getScale=function(e){return e===void 0&&(e=this.prevClients),W1(e)/W1(this.startClients)},n.prototype.move=function(e,t){this.startClients.forEach(function(r){r.clientX-=e,r.clientY-=t}),this.prevClients.forEach(function(r){r.clientX-=e,r.clientY-=t})},n})(),nk=["textarea","input"],hQ=(function(n){lQ(e,n);function e(t,r){r===void 0&&(r={});var i=n.call(this)||this;i.options={},i.flag=!1,i.pinchFlag=!1,i.data={},i.isDrag=!1,i.isPinch=!1,i.clientStores=[],i.targets=[],i.prevTime=0,i.doubleFlag=!1,i._useMouse=!1,i._useTouch=!1,i._useDrag=!1,i._dragFlag=!1,i._isTrusted=!1,i._isMouseEvent=!1,i._isSecondaryButton=!1,i._preventMouseEvent=!1,i._prevInputEvent=null,i._isDragAPI=!1,i._isIdle=!0,i._preventMouseEventId=0,i._window=window,i.onDragStart=function(m,b){if(b===void 0&&(b=!0),!(!i.flag&&m.cancelable===!1)){var _=m.type.indexOf("drag")>=-1;if(!(i.flag&&_)){i._isDragAPI=!0;var w=i.options,S=w.container,T=w.pinchOutside,C=w.preventWheelClick,R=w.preventRightClick,j=w.preventDefault,z=w.checkInput,V=w.dragFocusedInput,I=w.preventClickEventOnDragStart,A=w.preventClickEventOnDrag,k=w.preventClickEventByCondition,O=i._useTouch,L=!i.flag;if(i._isSecondaryButton=m.which===3||m.button===2,C&&(m.which===2||m.button===1)||R&&(m.which===3||m.button===2))return i.stop(),!1;if(L){var B=i._window.document.activeElement,M=m.target;if(M){var Q=M.tagName.toLowerCase(),X=nk.indexOf(Q)>-1,$=M.isContentEditable;if(X||$){if(z||!V&&B===M)return!1;if(B&&(B===M||$&&B.isContentEditable&&B.contains(M)))if(V)M.blur();else return!1}else if((j||m.type==="touchstart")&&B){var H=B.tagName.toLowerCase();(B.isContentEditable||nk.indexOf(H)>-1)&&B.blur()}(I||A||k)&&wr(i._window,"click",i._onClick,!0)}i.clientStores=[new Q1(Bm(m))],i._isIdle=!1,i.flag=!0,i.isDrag=!1,i._isTrusted=b,i._dragFlag=!0,i._prevInputEvent=m,i.data={},i.doubleFlag=lp()-i.prevTime<200,i._isMouseEvent=dQ(m),!i._isMouseEvent&&i._preventMouseEvent&&i._allowMouseEvent();var Z=i._preventMouseEvent||i.emit("dragStart",qn(qn({data:i.data,datas:i.data,inputEvent:m,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,isTrusted:b,isDouble:i.doubleFlag},i.getCurrentStore().getPosition()),{preventDefault:function(){m.preventDefault()},preventDrag:function(){i._dragFlag=!1}}));Z===!1&&i.stop(),i._isMouseEvent&&i.flag&&j&&m.preventDefault()}if(!i.flag)return!1;var re=0;if(L?(i._attchDragEvent(),O&&T&&(re=setTimeout(function(){wr(S,"touchstart",i.onDragStart,{passive:!1})}))):O&&T&&tr(S,"touchstart",i.onDragStart),i.flag&&uQ(m)){if(clearTimeout(re),L&&m.touches.length!==m.changedTouches.length)return;i.pinchFlag||i.onPinchStart(m)}}}},i.onDrag=function(m,b){if(i.flag){var _=i.options.preventDefault;!i._isMouseEvent&&_&&m.preventDefault(),i._prevInputEvent=m;var w=Bm(m),S=i.moveClients(w,m,!1);if(i._dragFlag){if(i.pinchFlag||S.deltaX||S.deltaY){var T=i._preventMouseEvent||i.emit("drag",qn(qn({},S),{isScroll:!!b,inputEvent:m}));if(T===!1){i.stop();return}}i.pinchFlag&&i.onPinch(m,w)}i.getCurrentStore().getPosition(w,!0)}},i.onDragEnd=function(m){if(i.flag){var b=i.options,_=b.pinchOutside,w=b.container,S=b.preventClickEventOnDrag,T=b.preventClickEventOnDragStart,C=b.preventClickEventByCondition,R=i.isDrag;(S||T||C)&&requestAnimationFrame(function(){i._allowClickEvent()}),!C&&!T&&S&&!R&&i._allowClickEvent(),i._useTouch&&_&&tr(w,"touchstart",i.onDragStart),i.pinchFlag&&i.onPinchEnd(m);var j=m?.touches?Bm(m):[],z=j.length;z===0||!i.options.keepDragging?i.flag=!1:i._addStore(new Q1(j));var V=i._getPosition(),I=lp(),A=!R&&i.doubleFlag;i._prevInputEvent=null,i.prevTime=R||A?0:I,i.flag||(i._dettachDragEvent(),i._preventMouseEvent||i.emit("dragEnd",qn({data:i.data,datas:i.data,isDouble:A,isDrag:R,isClick:!R,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,inputEvent:m,isTrusted:i._isTrusted},V)),i.clientStores=[],i._isMouseEvent||(i._preventMouseEvent=!0,clearTimeout(i._preventMouseEventId),i._preventMouseEventId=setTimeout(function(){i._preventMouseEvent=!1},200)),i._isIdle=!0)}},i.onBlur=function(){i.onDragEnd()},i._allowClickEvent=function(){tr(i._window,"click",i._onClick,!0)},i._onClick=function(m){i._allowClickEvent(),i._allowMouseEvent();var b=i.options.preventClickEventByCondition;b?.(m)||(m.stopPropagation(),m.preventDefault())},i._onContextMenu=function(m){var b=i.options;b.preventRightClick?i.onDragEnd(m):m.preventDefault()},i._passCallback=function(){};var a=[].concat(t),o=a[0];i._window=_3(o)?o:nl(o),i.options=qn({checkInput:!1,container:o&&!("document"in o)?nl(o):o,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},r);var c=i.options,u=c.container,d=c.events,h=c.checkWindowBlur;if(i._useDrag=d.indexOf("drag")>-1,i._useTouch=d.indexOf("touch")>-1,i._useMouse=d.indexOf("mouse")>-1,i.targets=a,i._useDrag&&a.forEach(function(m){wr(m,"dragstart",i.onDragStart)}),i._useMouse&&(a.forEach(function(m){wr(m,"mousedown",i.onDragStart),wr(m,"mousemove",i._passCallback)}),wr(u,"contextmenu",i._onContextMenu)),h&&wr(nl(),"blur",i.onBlur),i._useTouch){var p={passive:!1};a.forEach(function(m){wr(m,"touchstart",i.onDragStart,p),wr(m,"touchmove",i._passCallback,p)})}return i}return e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(t){return this.getCurrentStore().getMovement(t)+this.clientStores.slice(1).reduce(function(r,i){return r+i.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(t,r,i,a){a===void 0&&(a=!0),this.flag&&(this.clientStores[0].move(t,r),a&&this.onDrag(i,!0))},e.prototype.move=function(t,r){var i=t[0],a=t[1],o=this.getCurrentStore(),c=o.prevClients;return this.moveClients(c.map(function(u){var d=u.clientX,h=u.clientY;return{clientX:d+i,clientY:h+a,originalClientX:d,originalClientY:h}}),r,!0)},e.prototype.triggerDragStart=function(t){this.onDragStart(t,!1)},e.prototype.setEventData=function(t){var r=this.data;for(var i in t)r[i]=t[i];return this},e.prototype.setEventDatas=function(t){return this.setEventData(t)},e.prototype.getCurrentEvent=function(t){return t===void 0&&(t=this._prevInputEvent),qn(qn({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:t})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var t=this,r=this.targets,i=this.options.container;this.off(),tr(this._window,"blur",this.onBlur),this._useDrag&&r.forEach(function(a){tr(a,"dragstart",t.onDragStart)}),this._useMouse&&(r.forEach(function(a){tr(a,"mousedown",t.onDragStart)}),tr(i,"contextmenu",this._onContextMenu)),this._useTouch&&(r.forEach(function(a){tr(a,"touchstart",t.onDragStart)}),tr(i,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(t){var r=this,i=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>i)){var a=new Q1(Bm(t));this.pinchFlag=!0,this._addStore(a);var o=this.emit("pinchStart",qn(qn({data:this.data,datas:this.data,angle:a.getAngle(),touches:this.getCurrentStore().getPositions()},a.getPosition()),{inputEvent:t,isTrusted:this._isTrusted,preventDefault:function(){t.preventDefault()},preventDrag:function(){r._dragFlag=!1}}));o===!1&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(t,r){if(!(!this.flag||!this.pinchFlag||r.length<2)){var i=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",qn(qn({data:this.data,datas:this.data,movement:this.getMovement(r),angle:i.getAngle(r),rotation:i.getRotation(r),touches:i.getPositions(r),scale:i.getScale(r),distance:i.getDistance(r)},i.getPosition(r)),{inputEvent:t,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(t){if(this.pinchFlag){var r=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var i=this.getCurrentStore();this.emit("pinchEnd",qn(qn({data:this.data,datas:this.data,isPinch:r,touches:i.getPositions()},i.getPosition()),{inputEvent:t}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(t,r,i){var a=this._getPosition(t,i),o=this.isDrag;(a.deltaX||a.deltaY)&&(this.isDrag=!0);var c=!1;return!o&&this.isDrag&&(c=!0),qn(qn({data:this.data,datas:this.data},a),{movement:this.getMovement(t),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:r,isTrusted:this._isTrusted,isFirstDrag:c})},e.prototype._addStore=function(t){this.clientStores.splice(0,0,t)},e.prototype._getPosition=function(t,r){var i=this.getCurrentStore(),a=i.getPosition(t,r),o=this.clientStores.slice(1).reduce(function(d,h){var p=h.getPosition();return d.distX+=p.distX,d.distY+=p.distY,d},a),c=o.distX,u=o.distY;return qn(qn({},a),{distX:c,distY:u})},e.prototype._attchDragEvent=function(){var t=this._window,r=this.options.container,i={passive:!1};this._isDragAPI&&(wr(r,"dragover",this.onDrag,i),wr(t,"dragend",this.onDragEnd)),this._useMouse&&(wr(r,"mousemove",this.onDrag),wr(t,"mouseup",this.onDragEnd)),this._useTouch&&(wr(r,"touchmove",this.onDrag,i),wr(t,"touchend",this.onDragEnd,i),wr(t,"touchcancel",this.onDragEnd,i))},e.prototype._dettachDragEvent=function(){var t=this._window,r=this.options.container;this._isDragAPI&&(tr(r,"dragover",this.onDrag),tr(t,"dragend",this.onDragEnd)),this._useMouse&&(tr(r,"mousemove",this.onDrag),tr(t,"mouseup",this.onDragEnd)),this._useTouch&&(tr(r,"touchstart",this.onDragStart),tr(r,"touchmove",this.onDrag),tr(t,"touchend",this.onDragEnd),tr(t,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e})(ey);function pQ(n){for(var e=5381,t=n.length;t;)e=e*33^n.charCodeAt(--t);return e>>>0}var gQ=pQ;function mQ(n){return gQ(n).toString(36)}function vQ(n){if(n&&n.getRootNode){var e=n.getRootNode();if(e.nodeType===11)return e}}function yQ(n,e,t){return t.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(r,i){var a=i.trim();return(a?cc(a):[""]).map(function(o){var c=o.trim();return c.indexOf("@")===0?c:c.indexOf(":global")>-1?c.replace(/\:global/g,""):c.indexOf(":host")>-1?"".concat(c.replace(/\:host/g,".".concat(n))):c?".".concat(n," ").concat(c):".".concat(n)}).join(", ")+" {"})}function bQ(n,e,t,r,i){var a=Hd(r),o=a.createElement("style");return o.setAttribute("type","text/css"),o.setAttribute("data-styled-id",n),o.setAttribute("data-styled-count","1"),t.nonce&&o.setAttribute("nonce",t.nonce),o.innerHTML=yQ(n,e,t),(i||a.head||a.body).appendChild(o),o}function xQ(n){var e="rCS"+mQ(n);return{className:e,inject:function(t,r){r===void 0&&(r={});var i=vQ(t),a=(i||t.ownerDocument||document).querySelector('style[data-styled-id="'.concat(e,'"]'));if(!a)a=bQ(e,n,r,t,i);else{var o=parseFloat(a.getAttribute("data-styled-count"))||0;a.setAttribute("data-styled-count","".concat(o+1))}return{destroy:function(){var c,u=parseFloat(a.getAttribute("data-styled-count"))||0;u<=1?(a.remove?a.remove():(c=a.parentNode)===null||c===void 0||c.removeChild(a),a=null):a.setAttribute("data-styled-count","".concat(u-1))}}}}}var k_=function(){return k_=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},k_.apply(this,arguments)};function _Q(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function X3(n,e){var t=xQ(e),r=t.className;return bW(function(i,a){var o=i.className,c=o===void 0?"":o;i.cspNonce;var u=_Q(i,["className","cspNonce"]),d=NW();return MW(a,function(){return d.current},[]),N3(function(){var h=t.inject(d.current,{nonce:i.cspNonce});return function(){h.destroy()}},[]),ha(n,k_({ref:d,"data-styled-id":r,className:"".concat(c," ").concat(r)},u))})}var N_=function(n,e){return N_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},N_(n,e)};function Xp(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");N_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var W=function(){return W=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},W.apply(this,arguments)};function wQ(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function EQ(n,e,t,r){var i=arguments.length,a=i<3?e:r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function SQ(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function J(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function Ae(n,e,t){if(arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function Wp(n,e){return W({events:[],props:[],name:n},e)}var TQ=["n","w","s","e"],cS=["n","w","s","e","nw","ne","sw","se"];function AQ(n,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*n,'px" height="').concat(32*n,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}function CQ(n){var e=AQ(1,n),t=Math.round(n/45)*45%180,r="ns-resize";return t===135?r="nwse-resize":t===45?r="nesw-resize":t===90&&(r="ew-resize"),"cursor:".concat(r,";cursor: url('").concat(e,"') 16 16, ").concat(r,";")}var Yd=zW(),W3=Yd.browser.webkit,Q3=W3&&(function(){var n=typeof window>"u"?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(n.userAgent.toLowerCase());return e?parseFloat(e[1])<605:!1})(),Z3=Yd.browser.name,J3=parseInt(Yd.browser.version,10),IQ=Z3==="chrome",RQ=Yd.browser.chromium,DQ=parseInt(Yd.browser.chromiumVersion,10)||0,kQ=IQ&&J3>=109||RQ&&DQ>=109,NQ=Z3==="firefox",MQ=parseInt(Yd.browser.webkitVersion,10)>=612||J3>=15,uS="moveable-",PQ=cS.map(function(n){var e="",t="",r="center",i="center",a="calc(var(--moveable-control-padding, 20) * -1px)";return n.indexOf("n")>-1&&(e="top: ".concat(a,";"),i="bottom"),n.indexOf("s")>-1&&(e="top: 0px;",i="top"),n.indexOf("w")>-1&&(t="left: ".concat(a,";"),r="right"),n.indexOf("e")>-1&&(t="left: 0px;",r="left"),'.around-control[data-direction*="'.concat(n,`"] {
        `).concat(t).concat(e,`
        transform-origin: `).concat(r," ").concat(i,`;
    }`)}).join(`
`),OQ=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(PQ,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(n){return`
.direction[data-rotation="`.concat(n,'"], :global .view-control-rotation').concat(n,` {
`).concat(CQ(n),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(Q3?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),VQ=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],M_=1e-4,$r=1e-7,Um=1e-9,P_=Math.pow(10,10),rk=-P_,jQ={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},dS={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},eV={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},tV=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function Qp(n,e,t,r,i,a){var o,c;a===void 0&&(a="draggable");var u=(c=(o=e.gestos[a])===null||o===void 0?void 0:o.move(t,n.inputEvent))!==null&&c!==void 0?c:{},d=u.originalDatas||u.datas,h=d[a]||(d[a]={});return W(W({},u),{isPinch:!!r,parentEvent:!0,datas:h,originalDatas:n.originalDatas})}var Ad=(function(){function n(e){var t;e===void 0&&(e="draggable"),this.ableName=e,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(t={},t[e]={},t)}return n.prototype.dragStart=function(e,t){this.isDrag=!1,this.isFlag=!1;var r=t.originalDatas;return this.datas=r,r[this.ableName]||(r[this.ableName]={}),W(W({},this.move(e,t.inputEvent)),{type:"dragstart"})},n.prototype.drag=function(e,t){return this.move([e[0]-this.prevX,e[1]-this.prevY],t)},n.prototype.move=function(e,t){var r,i,a=!1;if(!this.isFlag)this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],r=e[0],i=e[1],this.isFlag=!0;else{var o=this.isDrag;r=this.prevX+e[0],i=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!o&&this.isDrag&&(a=!0)}return this.prevX=r,this.prevY=i,{type:"drag",clientX:r,clientY:i,inputEvent:t,isFirstDrag:a,isDrag:this.isDrag,distX:r-this.startX,distY:i-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},n})();function ad(n,e,t,r){var i=n.length===16,a=i?4:3,o=Bc(n,t,r,a),c=J(o,4),u=J(c[0],2),d=u[0],h=u[1],p=J(c[1],2),m=p[0],b=p[1],_=J(c[2],2),w=_[0],S=_[1],T=J(c[3],2),C=T[0],R=T[1],j=J(hn(n,e,a),2),z=j[0],V=j[1],I=Math.min(d,m,w,C),A=Math.min(h,b,S,R),k=Math.max(d,m,w,C),O=Math.max(h,b,S,R);d=d-I||0,m=m-I||0,w=w-I||0,C=C-I||0,h=h-A||0,b=b-A||0,S=S-A||0,R=R-A||0,z=z-I||0,V=V-A||0;var L=n[0],B=n[a+1],M=Ur(L*B);return{left:I,top:A,right:k,bottom:O,origin:[z,V],pos1:[d,h],pos2:[m,b],pos3:[w,S],pos4:[C,R],direction:M}}function nV(n,e){var t=e.clientX,r=e.clientY,i=e.datas,a=n.state,o=a.moveableClientRect,c=a.rootMatrix,u=a.is3d,d=a.pos1,h=o.left,p=o.top,m=u?4:3,b=J($e(Rd(c,[t-h,r-p],m),d),2),_=b[0],w=b[1],S=J(os({datas:i,distX:_,distY:w}),2),T=S[0],C=S[1];return[T,C]}function Lc(n,e){var t=e.datas,r=n.state,i=r.allMatrix,a=r.beforeMatrix,o=r.is3d,c=r.left,u=r.top,d=r.origin,h=r.offsetMatrix,p=r.targetMatrix,m=r.transformOrigin,b=o?4:3;t.is3d=o,t.matrix=i,t.targetMatrix=p,t.beforeMatrix=a,t.offsetMatrix=h,t.transformOrigin=m,t.inverseMatrix=ts(i,b),t.inverseBeforeMatrix=ts(a,b),t.absoluteOrigin=Dc(Nt([c,u],d),b),t.startDragBeforeDist=Or(t.inverseBeforeMatrix,t.absoluteOrigin,b),t.startDragDist=Or(t.inverseMatrix,t.absoluteOrigin,b)}function zQ(n){return ad(n.datas.beforeTransform,[50,50],100,100).direction}function ty(n,e,t){var r=e.datas,i=e.originalDatas.beforeRenderable,a=r.transformIndex,o=i.nextTransforms,c=o.length,u=i.nextTransformAppendedIndexes,d=-1;a===-1?(t==="translate"?d=0:t==="rotate"&&(d=Hs(o,function(b){return b.match(/scale\(/g)})),d===-1&&(d=o.length),r.transformIndex=d):ai(u,function(b){return b.index===a&&b.functionName===t})?d=a:d=a+u.filter(function(b){return b.index<a}).length;var h=uJ(o,n.state,d),p=h.targetFunction,m=t==="rotate"?"rotateZ":t;r.beforeFunctionTexts=h.beforeFunctionTexts,r.afterFunctionTexts=h.afterFunctionTexts,r.beforeTransform=h.beforeFunctionMatrix,r.beforeTransform2=h.beforeFunctionMatrix2,r.targetTansform=h.targetFunctionMatrix,r.afterTransform=h.afterFunctionMatrix,r.afterTransform2=h.afterFunctionMatrix2,r.targetAllTransform=h.allFunctionMatrix,p.functionName===m?(r.afterFunctionTexts.splice(0,1),r.isAppendTransform=!1):c>d&&(r.isAppendTransform=!0,i.nextTransformAppendedIndexes=Ae(Ae([],J(u),!1),[{functionName:t,index:d,isAppend:!0}],!1))}function ny(n,e,t){return"".concat(n.beforeFunctionTexts.join(" ")," ").concat(n.isAppendTransform?t:e," ").concat(n.afterFunctionTexts.join(" "))}function LQ(n){var e=n.datas,t=n.distX,r=n.distY,i=J(iV({datas:e,distX:t,distY:r}),2),a=i[0],o=i[1],c=rV(e,GW([a,o],4));return Or(c,Dc([0,0,0],4),4)}function rV(n,e,t){var r=n.beforeTransform,i=n.afterTransform,a=n.beforeTransform2,o=n.afterTransform2,c=n.targetAllTransform,u=t?Wt(c,e,4):Wt(e,c,4),d=Wt(ts(t?a:r,4),u,4),h=Wt(d,ts(t?o:i,4),4);return h}function iV(n){var e=n.datas,t=n.distX,r=n.distY,i=e.inverseBeforeMatrix,a=e.is3d,o=e.startDragBeforeDist,c=e.absoluteOrigin,u=a?4:3;return $e(Or(i,Nt(c,[t,r]),u),o)}function os(n,e){var t=n.datas,r=n.distX,i=n.distY,a=t.inverseBeforeMatrix,o=t.inverseMatrix,c=t.is3d,u=t.startDragBeforeDist,d=t.startDragDist,h=t.absoluteOrigin,p=c?4:3;return $e(Or(e?a:o,Nt(h,[r,i]),p),e?u:d)}function BQ(n,e){var t=n.datas,r=n.distX,i=n.distY;t.beforeMatrix;var a=t.matrix,o=t.is3d;t.startDragBeforeDist;var c=t.startDragDist,u=t.absoluteOrigin,d=o?4:3;return $e(Or(a,Nt(c,[r,i]),d),u)}function UQ(n,e,t,r,i,a){return r===void 0&&(r=e),i===void 0&&(i=t),a===void 0&&(a=[0,0]),n?n.map(function(o,c){var u=Gp(o),d=u.value,h=u.unit,p=c?i:r,m=c?t:e;if(o==="%"||isNaN(d)){var b=p?a[c]/p:0;return m*b}else if(h!=="%")return d;return m*d/100}):a}function aV(n){var e=[];return n[1]>=0&&(n[0]>=0&&e.push(3),n[0]<=0&&e.push(2)),n[1]<=0&&(n[0]>=0&&e.push(1),n[0]<=0&&e.push(0)),e}function FQ(n,e){return aV(e).map(function(t){return n[t]})}function Z1(n,e){var t=(e+1)/2;return[nv(n[0][0],n[1][0],t,1-t),nv(n[0][1],n[1][1],t,1-t)]}function ar(n,e){var t=Z1([n[0],n[1]],e[0]),r=Z1([n[2],n[3]],e[0]);return Z1([t,r],e[1])}function GQ(n,e,t,r,i,a){var o=Bc(e,t,r,i),c=ar(o,a),u=n[0]-c[0],d=n[1]-c[1];return[u,d]}function Zp(n,e,t,r){return Wt(n,Mh(e,r,t),r)}function qQ(n,e,t,r){var i=n.transformOrigin,a=n.offsetMatrix,o=n.is3d,c=o?4:3,u;if(ii(t)){var d=e.beforeTransform,h=e.afterTransform;r?u=ba(up(t),4,c):u=ba(Wt(Wt(d,up([t]),4),h,4),4,c)}else u=t;return Zp(a,u,i,c)}function HQ(n,e){var t=n.transformOrigin,r=n.offsetMatrix,i=n.is3d,a=n.targetMatrix,o=n.targetAllTransform,c=i?4:3;return Zp(r,Wt(o||a,sS(e,c),c),t,c)}function ry(n,e){var t=Kd(e);return{setTransform:function(r,i){i===void 0&&(i=-1),t.startTransforms=Wn(r)?r:ul(r),O_(n,e,i)},setTransformIndex:function(r){O_(n,e,r)}}}function iy(n,e,t){var r=Kd(e),i=r.startTransforms;O_(n,e,Hs(i,function(a){return a.indexOf("".concat(t,"("))===0}))}function O_(n,e,t){var r=Kd(e),i=e.datas;if(i.transformIndex=t,t!==-1){var a=r.startTransforms[t];if(a){var o=n.state,c=Td([a],{"x%":function(u){return u/100*o.offsetWidth},"y%":function(u){return u/100*o.offsetHeight}});i.startValue=c[0].functionValue}}}function fS(n,e){var t=Kd(n);t.nextTransforms=ul(e)}function Kd(n){return n.originalDatas.beforeRenderable}function sv(n){var e=n.originalDatas.beforeRenderable;return e.nextTransforms}function Fm(n){return(sv(n)||[]).join(" ")}function Gm(n){return Kd(n).nextStyle}function sV(n,e,t,r,i){fS(i,e);var a=Br.drag(n,Qp(i,n.state,t,r)),o=a?a.transform:e;return W(W({transform:e,drag:a},qr({transform:o},i)),{afterTransform:o})}function hS(n,e,t,r,i,a){var o=qQ(n.state,i,e,a),c=KQ(n,t,r,o);return c}function oV(n,e,t,r,i,a,o){var c=hS(n,e,t,i,a,o),u=n.state,d=u.left,h=u.top,p=n.props.groupable,m=p?d:0,b=p?h:0,_=$e(r,c);return $e(_,[m,b])}function $Q(n,e,t,r,i,a,o){var c=oV(n,e,t,r,i,a,o);return c}function YQ(n,e,t){return[e?-1+n[0]/(e/2):0,t?-1+n[1]/(t/2):0]}function KQ(n,e,t,r){r===void 0&&(r=n.state.allMatrix);var i=n.state,a=i.width,o=i.height,c=i.is3d,u=c?4:3,d=[a/2*(1+e[0])+t[0],o/2*(1+e[1])+t[1]];return hn(r,d,u)}function XQ(n,e,t){var r=t.fixedDirection,i=t.fixedPosition,a=t.fixedOffset;return oV(n,"rotate(".concat(e,"deg)"),r,i,a,t)}function WQ(n,e,t,r,i,a){var o=n.props.groupable,c=n.state,u=c.transformOrigin,d=c.offsetMatrix,h=c.is3d,p=c.width,m=c.height,b=c.left,_=c.top,w=a.fixedDirection,S=a.nextTargetMatrix||c.targetMatrix,T=h?4:3,C=UQ(i,e,t,p,m,u),R=o?b:0,j=o?_:0,z=Zp(d,S,C,T),V=GQ(r,z,e,t,T,w);return $e(V,[R,j])}function QQ(n,e){return ar(Qi(n.state),e)}function ZQ(n,e){var t=n.targetGesto,r=n.controlGesto,i;return t?.isFlag()&&(i=t.getEventData()[e]),!i&&r?.isFlag()&&(i=r.getEventData()[e]),i||{}}function JQ(n){if(n&&n.getRootNode){var e=n.getRootNode();if(e.nodeType===11)return e}}function eZ(n){var e=n("scale"),t=n("rotate"),r=n("translate"),i=[];return r&&r!=="0px"&&r!=="none"&&i.push("translate(".concat(r.split(/\s+/).join(","),")")),t&&t!=="1"&&t!=="none"&&i.push("rotate(".concat(t,")")),e&&e!=="1"&&e!=="none"&&i.push("scale(".concat(e.split(/\s+/).join(","),")")),i}function lV(n,e,t){for(var r=n,i=[],a=JE(n)||yl(n),o=!t&&n===e||n===a,c=o,u=!1,d=3,h,p,m,b=!1,_=fp(e,e,!0).offsetParent,w=1;r&&!c;){c=o;var S=si(r),T=S("position"),C=NV(r),R=T==="fixed",j=eZ(S),z=qW(QZ(C)),V=void 0,I=!1,A=!1,k=0,O=0,L=0,B=0,M={hasTransform:!1,fixedContainer:null};R&&(b=!0,M=nJ(r),_=M.fixedContainer);var Q=z.length;!u&&(Q===16||j.length)&&(u=!0,d=4,U_(i),m&&(m=ba(m,3,4))),u&&Q===9&&(z=ba(z,3,4));var X=tJ(r,n),$=X.tagName,H=X.hasOffset,Z=X.isSVG,re=X.origin,de=X.targetOrigin,U=X.offset,Y=J(U,2),ne=Y[0],ie=Y[1];$==="svg"&&!r.ownerSVGElement&&m&&(i.push({type:"target",target:r,matrix:rJ(r,d)}),i.push({type:"offset",target:r,matrix:rn(d)}));var te=parseFloat(S("zoom"))||1;if(R)V=M.fixedContainer,I=!0;else{var se=fp(r,e,!1,!0,S),me=se.offsetZoom;if(V=se.offsetParent,I=se.isEnd,A=se.isStatic,w*=me,(se.isCustomElement||me!==1)&&A)ne-=V.offsetLeft,ie-=V.offsetTop;else if(NQ||kQ){var Te=se.parentSlotElement;if(Te){for(var Ce=V,Ne=0,xe=0;Ce&&JQ(Ce);)Ne+=Ce.offsetLeft,xe+=Ce.offsetTop,Ce=Ce.offsetParent;ne-=Ne,ie-=xe}}}if(W3&&!MQ&&H&&!Z&&A&&(T==="relative"||T==="static")&&(ne-=V.offsetLeft,ie-=V.offsetTop,o=o||I),R)H&&M.hasTransform&&(L=V.clientLeft,B=V.clientTop);else if(H&&_!==V&&(k=V.clientLeft,O=V.clientTop),H&&V===a){var Ee=MV(r,!1);ne+=Ee[0],ie+=Ee[1]}if(i.push({type:"target",target:r,matrix:Mh(z,d,re)}),j.length&&(i.push({type:"offset",target:r,matrix:rn(d)}),i.push({type:"target",target:r,matrix:Mh(up(j),d,re)})),H){var Qe=r===n,Oe=Qe?0:r.scrollLeft,Be=Qe?0:r.scrollTop;i.push({type:"offset",target:r,matrix:kc([ne-Oe+k-L,ie-Be+O-B],d)})}else i.push({type:"offset",target:r,origin:re});if(te!==1&&i.push({type:"zoom",target:r,matrix:Mh(sS([te,te],d),d,[0,0])}),m||(m=z),h||(h=re),p||(p=de),c||R)break;r=V,o=I,(!t||r===a)&&(c=o)}return m||(m=rn(d)),h||(h=[0,0]),p||(p=[0,0]),{zoom:w,offsetContainer:_,matrixes:i,targetMatrix:m,transformOrigin:h,targetOrigin:p,is3d:u,hasFixed:b}}var tc=null,nc=null,Yu=null;function Cd(n){n?(window.Map&&(tc=new Map,nc=new Map),Yu=[]):(tc=null,Yu=null,nc=null)}function tZ(n){var e=nc?.get(n);if(e)return e;var t=Ph(n,!0);return nc&&nc.set(n,t),t}function nZ(n,e){if(Yu){var t=ai(Yu,function(i){return i[0][0]==n&&i[0][1]==e});if(t)return t[1]}var r=lV(n,e,!0);return Yu&&Yu.push([[n,e],r]),r}function si(n){var e=tc?.get(n);if(!e){var t=nl(n).getComputedStyle(n);if(!tc)return function(a){return t[a]};e={style:t,cached:{}},tc.set(n,e)}var r=e.cached,i=e.style;return function(a){return a in r||(r[a]=i[a]),r[a]}}function pa(n,e,t){var r=t.originalDatas;r.groupable=r.groupable||{};var i=r.groupable;i.childDatas=i.childDatas||[];var a=i.childDatas;return n.moveables.map(function(o,c){return a[c]=a[c]||{},a[c][e]=a[c][e]||{},W(W({},t),{isRequestChild:!0,datas:a[c][e],originalDatas:a[c]})})}function J1(n,e,t,r,i,a,o){var c=!!t.match(/Start$/g),u=!!t.match(/End$/g),d=i.isPinch,h=i.datas,p=pa(n,e.name,i),m=n.moveables,b=[],_=p.map(function(w,S){var T=m[S],C=T.state,R=C.gestos,j=w;if(c)j=new Ad(o).dragStart(r,w),b.push(j);else{if(R[o]||(R[o]=h.childGestos[S]),!R[o])return;j=Qp(w,C,r,d,a,o),b.push(j)}var z=e[t](T,W(W({},j),{parentFlag:!0}));return u&&(R[o]=null),z});return c&&(h.childGestos=m.map(function(w){return w.state.gestos[o]})),{eventParams:_,childEvents:b}}function Vs(n,e,t,r,i,a){i===void 0&&(i=function(h,p){return p});var o=!!t.match(/End$/g),c=pa(n,e.name,r),u=n.moveables,d=c.map(function(h,p){var m=u[p],b=h;b=i(m,h);var _=e[t](m,W(W({},b),{parentFlag:!0}));return o&&(m.state.gestos={}),_});return d}function ov(n,e,t,r){var i=t.fixedDirection,a=t.fixedPosition,o=r.datas.startPositions||Qi(e.state),c=ar(o,i),u=J(Or(Kp(-n.rotation/180*Math.PI,3),[c[0]-a[0],c[1]-a[1],1],3),2),d=u[0],h=u[1];return r.datas.originalX=d,r.datas.originalY=h,r}function cV(n,e,t,r){var i=n.getState(),a=i.renderPoses,o=i.rotation,c=i.direction,u=Mc(n.props,e).zoom,d=Nh(o/Math.PI*180),h={},p=n.renderState;p.renderDirectionMap||(p.renderDirectionMap={});var m=p.renderDirectionMap;t.forEach(function(_){var w=_.dir;h[w]=!0});var b=Ur(c);return t.map(function(_){var w=_.data,S=_.classNames,T=_.dir,C=dS[T];if(!C||!h[T])return null;m[T]=!0;var R=(ct(d,15)+b*eV[T]+720)%180,j={};return $s(w).forEach(function(z){j["data-".concat(z)]=w[z]}),r.createElement("div",W({className:Ge.apply(void 0,Ae(["control","direction",T,e],J(S),!1)),"data-rotation":R,"data-direction":T},j,{key:"direction-".concat(T),style:dv.apply(void 0,Ae([o,u],J(C.map(function(z){return a[z]})),!1))}))})}function uV(n,e,t,r){var i=Mc(n.props,t),a=i.renderDirections,o=a===void 0?e:a,c=i.displayAroundControls;if(!o)return[];var u=o===!0?cS:o;return Ae(Ae([],J(c?pV(n,r,t,u):[]),!1),J(cV(n,t,u.map(function(d){return{data:{},classNames:[],dir:d}}),r)),!1)}function dp(n,e,t,r,i,a){for(var o=[],c=6;c<arguments.length;c++)o[c-6]=arguments[c];var u=Vn(t,r),d=e?ct(u/Math.PI*180,15)%180:-1;return n.createElement("div",{key:"line-".concat(a),className:Ge.apply(void 0,Ae(["line","direction",e?"edge":"",e],J(o),!1)),"data-rotation":d,"data-line-key":a,"data-direction":e,style:ph(t,r,i,u)})}function dV(n,e,t,r,i){var a=t===!0?TQ:t;return a.map(function(o,c){var u=J(dS[o],2),d=u[0],h=u[1];if(h!=null)return dp(n,o,r[d],r[h],i,"".concat(e,"Edge").concat(c),e)}).filter(Boolean)}function fV(n){return function(e,t){var r=Mc(e.props,n).edge;return r&&(r===!0||r.length)?Ae(Ae([],J(dV(t,n,r,e.getState().renderPoses,e.props.zoom)),!1),J(rZ(e,n,t)),!1):hV(e,n,t)}}function hV(n,e,t){return uV(n,cS,e,t)}function rZ(n,e,t){return uV(n,["nw","ne","sw","se"],e,t)}function pV(n,e,t,r){var i=n.renderState;i.renderDirectionMap||(i.renderDirectionMap={});var a=n.getState(),o=a.renderPoses,c=a.rotation,u=a.direction,d=i.renderDirectionMap,h=n.props.zoom,p=Ur(u),m=c/Math.PI*180;return(r||$s(d)).map(function(b){var _=dS[b];if(!_)return null;var w=(ct(m,15)+p*eV[b]+720)%180,S=["around-control"];return t&&S.push("direction",t),e.createElement("div",{className:Ge.apply(void 0,Ae([],J(S),!1)),"data-rotation":w,"data-direction":b,key:"direction-around-".concat(b),style:dv.apply(void 0,Ae([c,h],J(_.map(function(T){return o[T]})),!1))})})}function pS(n,e,t){var r=n||{},i=r.position,a=i===void 0?"client":i,o=r.left,c=o===void 0?-1/0:o,u=r.top,d=u===void 0?-1/0:u,h=r.right,p=h===void 0?1/0:h,m=r.bottom,b=m===void 0?1/0:m,_={position:a,left:c,top:d,right:p,bottom:b};return{vertical:ik(_,e,!0),horizontal:ik(_,t,!1)}}function ay(n,e){var t=n.state,r=t.containerClientRect,i=r.clientHeight,a=r.clientWidth,o=r.clientLeft,c=r.clientTop,u=t.snapOffset,d=u.left,h=u.top,p=u.right,m=u.bottom,b=e||n.props.bounds||{},_=b.position||"client",w=_==="css",S=b.left,T=S===void 0?-1/0:S,C=b.top,R=C===void 0?-1/0:C,j=b.right,z=j===void 0?w?-1/0:1/0:j,V=b.bottom,I=V===void 0?w?-1/0:1/0:V;return w&&(z=a+p-d-z,I=i+m-h-I),{left:T+d-o,right:z+d-o,top:R+h-c,bottom:I+h-c}}function iZ(n,e,t){var r=ay(n),i=r.left,a=r.top,o=r.right,c=r.bottom,u=J(t,2),d=u[0],h=u[1],p=J($e(t,e),2),m=p[0],b=p[1];_e(m)<$r&&(m=0),_e(b)<$r&&(b=0);var _=b>0,w=m>0,S={isBound:!1,offset:0,pos:0},T={isBound:!1,offset:0,pos:0};if(m===0&&b===0)return{vertical:S,horizontal:T};if(m===0)_?c<h&&(T.pos=c,T.offset=h-c):a>h&&(T.pos=a,T.offset=h-a);else if(b===0)w?o<d&&(S.pos=o,S.offset=d-o):i>d&&(S.pos=i,S.offset=d-i);else{var C=b/m,R=t[1]-C*d,j=0,z=0,V=!1;w&&o<=d?(j=C*o+R,z=o,V=!0):!w&&d<=i&&(j=C*i+R,z=i,V=!0),V&&(j<a||j>c)&&(V=!1),V||(_&&c<=h?(j=c,z=(j-R)/C,V=!0):!_&&h<=a&&(j=a,z=(j-R)/C,V=!0)),V&&(S.isBound=!0,S.pos=z,S.offset=d-z,T.isBound=!0,T.pos=j,T.offset=h-j)}return{vertical:S,horizontal:T}}function ik(n,e,t){var r=n[t?"left":"top"],i=n[t?"right":"bottom"],a=Math.min.apply(Math,Ae([],J(e),!1)),o=Math.max.apply(Math,Ae([],J(e),!1)),c=[];return r+1>a&&c.push({direction:"start",isBound:!0,offset:a-r,pos:r}),i-1<o&&c.push({direction:"end",isBound:!0,offset:o-i,pos:i}),c.length||c.push({isBound:!1,offset:0,pos:0}),c.sort(function(u,d){return _e(d.offset)-_e(u.offset)})}function ak(n,e,t){var r=t?n.map(function(i){return Yp(i,t)}):n;return r.some(function(i){return i[0]<e.left&&_e(i[0]-e.left)>.1||i[0]>e.right&&_e(i[0]-e.right)>.1||i[1]<e.top&&_e(i[1]-e.top)>.1||i[1]>e.bottom&&_e(i[1]-e.bottom)>.1})}function aZ(n,e,t){var r=Wi(n),i=Math.sqrt(r*r-e*e)||0;return[i,-i].sort(function(a,o){return _e(a-n[t?0:1])-_e(o-n[t?0:1])}).map(function(a){return Vn([0,0],t?[a,e]:[e,a])})}function sZ(n,e,t,r,i){if(!n.props.bounds)return[];var a=i*Math.PI/180,o=ay(n),c=o.left,u=o.top,d=o.right,h=o.bottom,p=c-r[0],m=d-r[0],b=u-r[1],_=h-r[1],w={left:p,top:b,right:m,bottom:_};if(!ak(t,w,0))return[];var S=[];return[[p,0],[m,0],[b,1],[_,1]].forEach(function(T){var C=J(T,2),R=C[0],j=C[1];t.forEach(function(z){var V=Vn([0,0],z);S.push.apply(S,Ae([],J(aZ(z,R,j).map(function(I){return a+I-V}).filter(function(I){return!ak(e,w,I)}).map(function(I){return ct(I*180/Math.PI,$r)})),!1))})}),S}var oZ=["left","right","center"],lZ=["top","bottom","middle"],sk={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},dl={start:"left",end:"right",center:"center"},fl={start:"top",end:"bottom",center:"middle"};function Ku(){return{left:!1,top:!1,right:!1,bottom:!1}}function Xd(n,e){var t=n.props,r=t.snappable,i=t.bounds,a=t.innerBounds,o=t.verticalGuidelines,c=t.horizontalGuidelines,u=t.snapGridWidth,d=t.snapGridHeight,h=n.state,p=h.guidelines,m=h.enableSnap;return!r||!m||e&&r!==!0&&r.indexOf(e)<0?!1:!!(u||d||i||a||p&&p.length||o&&o.length||c&&c.length)}function gS(n){return n===!1?{}:n===!0||!n?{left:!0,right:!0,top:!0,bottom:!0}:n}function cZ(n,e){var t=gS(n),r={};for(var i in t)i in e&&t[i]&&(r[i]=e[i]);return r}function mS(n,e){var t=cZ(n,e),r=lZ.filter(function(a){return a in t}),i=oZ.filter(function(a){return a in t});return{horizontalNames:r,verticalNames:i,horizontal:r.map(function(a){return t[a]}),vertical:i.map(function(a){return t[a]})}}function uZ(n,e,t){var r=hn(n,[e.clientLeft,e.clientTop],t);return[e.left+r[0],e.top+r[1]]}function dZ(n){var e=J(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];Math.abs(i)<Yn&&(i=0),Math.abs(a)<Yn&&(a=0);var o=0,c=0,u=0;return i?a?(o=-a/i,c=1,u=o*t[0]-t[1]):(c=1,u=-t[1]):(o=-1,u=t[0]),[o,c,u].map(function(d){return ct(d,Yn)})}var gV="snapRotationThreshold",mV="snapRotationDegrees",vV="snapHorizontalThreshold",yV="snapVerticalThreshold";function sy(n,e,t,r,i,a,o){var c;r===void 0&&(r=[]),i===void 0&&(i=[]);var u=n.props,d=((c=n.state.snapThresholdInfo)===null||c===void 0?void 0:c.multiples)||[1,1],h=_k(o,u[vV],5),p=_k(a,u[yV],5);return bV(n.state.guidelines,e,t,r,i,h,p,d)}function bV(n,e,t,r,i,a,o,c){return{vertical:lk(n,"vertical",e,o*c[0],r),horizontal:lk(n,"horizontal",t,a*c[1],i)}}function fZ(n,e,t){var r=J(t,2),i=r[0],a=r[1],o=J(e,2),c=o[0],u=o[1],d=J($e(t,e),2),h=d[0],p=d[1],m=p>0,b=h>0;h=fv(h),p=fv(p);var _={isSnap:!1,offset:0,pos:0},w={isSnap:!1,offset:0,pos:0};if(h===0&&p===0)return{vertical:_,horizontal:w};var S=sy(n,h?[i]:[],p?[a]:[],[],[],void 0,void 0),T=S.vertical,C=S.horizontal;T.posInfos.filter(function($){var H=$.pos;return b?H>=c:H<=c}),C.posInfos.filter(function($){var H=$.pos;return m?H>=u:H<=u}),T.isSnap=T.posInfos.length>0,C.isSnap=C.posInfos.length>0;var R=V_(T),j=R.isSnap,z=R.guideline,V=V_(C),I=V.isSnap,A=V.guideline,k=I?A.pos[1]:0,O=j?z.pos[0]:0;if(h===0)I&&(w.isSnap=!0,w.pos=A.pos[1],w.offset=a-w.pos);else if(p===0)j&&(_.isSnap=!0,_.pos=O,_.offset=i-O);else{var L=p/h,B=t[1]-L*i,M=0,Q=0,X=!1;j?(Q=O,M=L*Q+B,X=!0):I&&(M=k,Q=(M-B)/L,X=!0),X&&(_.isSnap=!0,_.pos=Q,_.offset=i-Q,w.isSnap=!0,w.pos=M,w.offset=a-M)}return{vertical:_,horizontal:w}}function Yo(n){var e="";return n===-1||n==="top"||n==="left"?e="start":n===0||n==="center"||n==="middle"?e="center":(n===1||n==="right"||n==="bottom")&&(e="end"),e}function ok(n,e,t,r){var i=mS(n.props.snapDirections,e),a=sy(n,i.vertical,i.horizontal,i.verticalNames.map(function(u){return Yo(u)}),i.horizontalNames.map(function(u){return Yo(u)}),t,r),o=Yo(i.horizontalNames[a.horizontal.index]),c=Yo(i.verticalNames[a.vertical.index]);return{vertical:W(W({},a.vertical),{direction:c}),horizontal:W(W({},a.horizontal),{direction:o})}}function V_(n){var e=n.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var t=n.posInfos[0],r=t.guidelineInfos[0],i=r.offset,a=r.dist,o=r.guideline;return{isSnap:e,offset:i,dist:a,pos:t.pos,guideline:o}}function lk(n,e,t,r,i){var a,o;if(i===void 0&&(i=[]),!n||!n.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var c=e==="vertical",u=c?0:1,d=t.map(function(p,m){var b=i[m]||"",_=n.map(function(w){var S=w.pos,T=p-S[u];return{offset:T,dist:_e(T),guideline:w,direction:b}}).filter(function(w){var S=w.guideline,T=w.dist,C=S.type;return!(C!==e||T>r)}).sort(function(w,S){return w.dist-S.dist});return{pos:p,index:m,guidelineInfos:_,direction:b}}).filter(function(p){return p.guidelineInfos.length>0}).sort(function(p,m){return p.guidelineInfos[0].dist-m.guidelineInfos[0].dist}),h=d.length>0;return{isSnap:h,index:h?d[0].index:-1,direction:(o=(a=d[0])===null||a===void 0?void 0:a.direction)!==null&&o!==void 0?o:"",posInfos:d}}function hZ(n,e,t,r,i){var a=[];t[0]&&t[1]?a=[t,[-t[0],t[1]],[t[0],-t[1]]]:!t[0]&&!t[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(m,b,_){var w=_[b+1]||_[0];a.push(m),a.push([(m[0]+w[0])/2,(m[1]+w[1])/2])}):n.props.keepRatio?a.push([-1,-1],[-1,1],[1,-1],[1,1],t):(a.push.apply(a,Ae([],J(FQ([[-1,-1],[1,-1],[-1,-1],[1,1]],t)),!1)),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var o=a.map(function(m){return ar(e,m)}),c=o.map(function(m){return m[0]}),u=o.map(function(m){return m[1]}),d=sy(n,c,u,a.map(function(m){return Yo(m[0])}),a.map(function(m){return Yo(m[1])}),r,i),h=Yo(a.map(function(m){return m[0]})[d.vertical.index]),p=Yo(a.map(function(m){return m[1]})[d.horizontal.index]);return{vertical:W(W({},d.vertical),{direction:h}),horizontal:W(W({},d.horizontal),{direction:p})}}function xV(n,e){var t=_e(n.offset),r=_e(e.offset);return n.isBound&&e.isBound?r-t:n.isBound?-1:e.isBound?1:n.isSnap&&e.isSnap?r-t:n.isSnap?-1:e.isSnap||t<$r?1:r<$r?-1:t-r}function lv(n,e){return n.slice().sort(function(t,r){var i=t.sign[e],a=r.sign[e],o=t.offset[e],c=r.offset[e];if(i){if(!a)return-1}else return 1;return xV({isBound:t.isBound,isSnap:t.isSnap,offset:o},{isBound:r.isBound,isSnap:r.isSnap,offset:c})})[0]}function pZ(n,e,t){var r=[];if(t)_e(e[0])!==1||_e(e[1])!==1?r.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):r.push([e,[n[0],-n[1]]],[e,[-n[0],n[1]]]),r.push([e,n]);else if(n[0]&&n[1]||!n[0]&&!n[1]){var i=n[0]?n:[1,1];[1,-1].forEach(function(o){[1,-1].forEach(function(c){var u=[o*i[0],c*i[1]];e[0]===u[0]&&e[1]===u[1]||r.push([e,u])})})}else if(n[0]){var a=_e(e[0])===1?[1]:[1,-1];a.forEach(function(o){r.push([[e[0],-1],[o*n[0],-1]],[[e[0],0],[o*n[0],0]],[[e[0],1],[o*n[0],1]])})}else if(n[1]){var a=_e(e[1])===1?[1]:[1,-1];a.forEach(function(c){r.push([[-1,e[1]],[-1,c*n[1]]],[[0,e[1]],[0,c*n[1]]],[[1,e[1]],[1,c*n[1]]])})}return r}function _V(n,e){var t=__([e[0][0],e[1][0]]),r=__([e[0][1],e[1][1]]);return{vertical:t<=n[0],horizontal:r<=n[1]}}function vS(n,e){var t=J(e,2),r=t[0],i=t[1],a=i[0]-r[0],o=i[1]-r[1];_e(a)<$r&&(a=0),_e(o)<$r&&(o=0);var c,u;if(!a)c=r[0],u=n[0];else if(!o)c=r[1],u=n[1];else{var d=o/a;c=d*(n[0]-r[0])+r[1],u=n[1]}return c-u}function wV(n,e,t,r){return r===void 0&&(r=$r),n.every(function(i){var a=vS(i,e),o=a<=0;return o===t||_e(a)<=r})}function ck(n,e,t,r,i){return i===void 0&&(i=0),r&&e-i<=n||!r&&n<=t+i?{isBound:!0,offset:r?e-n:t-n}:{isBound:!1,offset:0}}function gZ(n,e){var t=e.line,r=e.centerSign,i=e.verticalSign,a=e.horizontalSign,o=e.lineConstants,c=n.props.innerBounds;if(!c)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var u=c.left,d=c.top,h=c.width,p=c.height,m=[[u,d],[u,d+p]],b=[[u,d],[u+h,d]],_=[[u+h,d],[u+h,d+p]],w=[[u,d+p],[u+h,d+p]];if(wV([[u,d],[u+h,d],[u,d+p],[u+h,d+p]],t,r))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var S=Ko(t,o,b,i),T=Ko(t,o,w,i),C=Ko(t,o,m,a),R=Ko(t,o,_,a),j=S.isBound&&T.isBound,z=S.isBound||T.isBound,V=C.isBound&&R.isBound,I=C.isBound||R.isBound,A=Id(S.offset,T.offset),k=Id(C.offset,R.offset),O=[0,0],L=!1,B=!1;return _e(k)<_e(A)?(O=[A,0],L=z,B=j):(O=[0,k],L=I,B=V),{isAllBound:B,isVerticalBound:z,isHorizontalBound:I,isBound:L,offset:O}}function Ko(n,e,t,r,i,a){var o=J(e,2),c=o[0],u=o[1],d=n[0],h=t[0],p=t[1],m=fv(p[1]-h[1]),b=fv(p[0]-h[0]),_=u,w=c,S=-c/u;if(b){if(!m){if(a&&!_)return{isBound:!1,offset:0};if(w){var j=(h[1]-d[1])/S+d[0];return ck(j,h[0],p[0],r,i)}else{var C=h[1]-d[1],R=_e(C)<=(i||0);return{isBound:R,offset:R?C:0}}}}else{if(a&&!w)return{isBound:!1,offset:0};if(_){var T=S*(h[0]-d[0])+d[1];return ck(T,h[1],p[1],r,i)}else{var C=h[0]-d[0],R=_e(C)<=(i||0);return{isBound:R,offset:R?C:0}}}return{isBound:!1,offset:0}}function EV(n,e,t){return e.map(function(r){var i=gZ(n,r),a=i.isBound,o=i.offset,c=i.isVerticalBound,u=i.isHorizontalBound,d=r.multiple,h=os({datas:t,distX:o[0],distY:o[1]}).map(function(p,m){return p*(d[m]?2/d[m]:0)});return{sign:d,isBound:a,isVerticalBound:c,isHorizontalBound:u,isSnap:!1,offset:h}})}function mZ(n,e,t){var r,i=yS(n,e,[0,0],!1).map(function(m){return W(W({},m),{multiple:m.multiple.map(function(b){return _e(b)*2})})}),a=EV(n,i,t),o=lv(a,0),c=lv(a,1),u=0,d=0,h=o.isVerticalBound||c.isVerticalBound,p=o.isHorizontalBound||c.isHorizontalBound;return(h||p)&&(r=J(BQ({datas:t,distX:-o.offset[0],distY:-c.offset[1]}),2),u=r[0],d=r[1]),{vertical:{isBound:h,offset:u},horizontal:{isBound:p,offset:d}}}function vZ(n,e){var t=[],r=n[0],i=n[1];return r&&i?t.push([[0,i*2],n,[-r,i]],[[r*2,0],n,[r,-i]]):r?(t.push([[r*2,0],[r,1],[r,-1]]),e&&t.push([[0,-1],[r,-1],[-r,-1]],[[0,1],[r,1],[-r,1]])):i?(t.push([[0,i*2],[1,i],[-1,i]]),e&&t.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):t.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),t}function yS(n,e,t,r){var i=n.state,a=i.allMatrix,o=i.is3d,c=Bc(a,100,100,o?4:3),u=ar(c,[0,0]);return vZ(t,r).map(function(d){var h=J(d,3),p=h[0],m=h[1],b=h[2],_=[ar(c,m),ar(c,b)],w=dZ(_),S=_V(u,_),T=S.vertical,C=S.horizontal,R=vS(u,_)<=0;return{multiple:p,centerSign:R,verticalSign:T,horizontalSign:C,lineConstants:w,line:[ar(e,m),ar(e,b)]}})}function uk(n,e,t,r){var i=r?n.map(function(a){return Yp(a,r)}):n;return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some(function(a){var o=vS(t,a)<=0;return!wV(e,a,o)})}function yZ(n){var e=J(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];if(!i)return _e(t[0]);if(!a)return _e(t[1]);var o=a/i;return _e((-o*t[0]+t[1])/Math.sqrt(Math.pow(o,2)+1))}function bZ(n){var e=J(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];if(!i)return[t[0],0];if(!a)return[0,t[1]];var o=a/i,c=-o*t[0]+t[1];return[-c/(o+1/o),c/(o*o+1)]}function xZ(n,e,t,r,i){var a=n.props.innerBounds,o=i*Math.PI/180;if(!a)return[];var c=a.left,u=a.top,d=a.width,h=a.height,p=c-r[0],m=c+d-r[0],b=u-r[1],_=u+h-r[1],w=[[p,b],[m,b],[p,_],[m,_]],S=ar(t,[0,0]);if(!uk(t,w,S,0))return[];var T=[],C=w.map(function(R){return[Wi(R),Vn([0,0],R)]});return[[t[0],t[1]],[t[1],t[3]],[t[3],t[2]],[t[2],t[0]]].forEach(function(R){var j=Vn([0,0],bZ(R)),z=yZ(R);T.push.apply(T,Ae([],J(C.filter(function(V){var I=J(V,1),A=I[0];return A&&z<=A}).map(function(V){var I=J(V,2),A=I[0],k=I[1],O=Math.acos(A?z/A:0),L=k+O,B=k-O;return[o+L-j,o+B-j]}).reduce(function(V,I){return V.push.apply(V,Ae([],J(I),!1)),V},[]).filter(function(V){return!uk(e,w,S,V)}).map(function(V){return ct(V*180/Math.PI,$r)})),!1))}),T}function _Z(n){var e=n.props.innerBounds,t=Ku();if(!e)return{boundMap:t,vertical:[],horizontal:[]};var r=n.getRect(),i=r.pos1,a=r.pos2,o=r.pos3,c=r.pos4,u=[i,a,o,c],d=ar(u,[0,0]),h=e.left,p=e.top,m=e.width,b=e.height,_=[[h,p],[h,p+b]],w=[[h,p],[h+m,p]],S=[[h+m,p],[h+m,p+b]],T=[[h,p+b],[h+m,p+b]],C=yS(n,u,[0,0],!1),R=[],j=[];return C.forEach(function(z){var V=z.line,I=z.lineConstants,A=_V(d,V),k=A.horizontal,O=A.vertical,L=Ko(V,I,w,O,1,!0),B=Ko(V,I,T,O,1,!0),M=Ko(V,I,_,k,1,!0),Q=Ko(V,I,S,k,1,!0);L.isBound&&!t.top&&(R.push(p),t.top=!0),B.isBound&&!t.bottom&&(R.push(p+b),t.bottom=!0),M.isBound&&!t.left&&(j.push(h),t.left=!0),Q.isBound&&!t.right&&(j.push(h+m),t.right=!0)}),{boundMap:t,horizontal:R,vertical:j}}function wZ(n,e,t,r){var i=e[0]-n[0],a=e[1]-n[1];if(_e(i)<Yn&&(i=0),_e(a)<Yn&&(a=0),!i)return r?[0,0]:[0,t];if(!a)return r?[t,0]:[0,0];var o=a/i,c=n[1]-o*n[0];if(r){var u=o*(e[0]+t)+c;return[t,u-e[1]]}else{var d=(e[1]+t-c)/o;return[d-e[0],t]}}function j_(n,e,t,r,i){var a=wZ(n,e,t,r);if(!a)return{isOutside:!1,offset:[0,0]};var o=Os(n,e),c=Os(a,n),u=Os(a,e),d=c>o||u>o,h=J(os({datas:i,distX:a[0],distY:a[1]}),2),p=h[0],m=h[1];return{offset:[p,m],isOutside:d}}function cv(n,e){return n.isBound?n.offset:e.isSnap?V_(e).offset:0}function EZ(n,e,t,r,i){var a=J(e,2),o=a[0],c=a[1],u=J(t,2),d=u[0],h=u[1],p=J(r,2),m=p[0],b=p[1],_=J(i,2),w=_[0],S=_[1],T=-w,C=-S;if(n&&o&&c){T=0,C=0;var R=[];if(d&&h?R.push([0,S],[w,0]):d?R.push([w,0]):h?R.push([0,S]):m&&b?R.push([0,S],[w,0]):m?R.push([w,0]):b&&R.push([0,S]),R.length){R.sort(function(I,A){return Wi($e([o,c],I))-Wi($e([o,c],A))});var j=R[0];if(j[0]&&_e(o)>Yn)T=-j[0],C=c*_e(o+T)/_e(o)-c;else if(j[1]&&_e(c)>Yn){var z=c;C=-j[1],T=o*_e(c+C)/_e(z)-o}if(n&&h&&d)if(_e(T)>Yn&&_e(T)<_e(w)){var V=_e(w)/_e(T);T*=V,C*=V}else if(_e(C)>Yn&&_e(C)<_e(S)){var V=_e(S)/_e(C);T*=V,C*=V}else T=Id(-w,T),C=Id(-S,C)}}else T=o||d?-w:0,C=c||h?-S:0;return[T,C]}function SZ(n,e,t,r,i,a){if(!Xd(n,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var o=_S(a.absolutePoses,[e,t]),c=Xi(o),u=c.left,d=c.right,h=c.top,p=c.bottom,m={horizontal:o.map(function(Q){return Q[1]}),vertical:o.map(function(Q){return Q[0]})},b=gS(n.props.snapDirections),_=mS(b,{left:u,right:d,top:h,bottom:p,center:(u+d)/2,middle:(h+p)/2}),w=oy(n,i,_,m),S=w.vertical,T=w.horizontal,C=mZ(n,o,a),R=C.vertical,j=C.horizontal,z=S.isSnap,V=T.isSnap,I=S.isBound||R.isBound,A=T.isBound||j.isBound,k=Id(S.offset,R.offset),O=Id(T.offset,j.offset),L=J(EZ(r,[e,t],[I,A],[z,V],[k,O]),2),B=L[0],M=L[1];return[{isBound:I,isSnap:z,offset:B},{isBound:A,isSnap:V,offset:M}]}function oy(n,e,t,r){r===void 0&&(r=t);var i=pS(ay(n),r.vertical,r.horizontal),a=i.horizontal,o=i.vertical,c=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:sy(n,t.vertical,t.horizontal,void 0,void 0,void 0,void 0),u=c.horizontal,d=c.vertical,h=cv(a[0],u),p=cv(o[0],d),m=_e(h),b=_e(p);return{horizontal:{isBound:a[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:h,dist:m,bounds:a,snap:u},vertical:{isBound:o[0].isBound,isSnap:d.isSnap,snapIndex:d.index,offset:p,dist:b,bounds:o,snap:d}}}function dk(n,e,t,r,i,a,o){o===void 0&&(o=[1,1]);var c=pS(e,t,r),u=c.horizontal,d=c.vertical,h=bV(n,t,r,[],[],i,a,o),p=h.horizontal,m=h.vertical,b=cv(u[0],p),_=cv(d[0],m),w=_e(b),S=_e(_);return{horizontal:{isBound:u[0].isBound,isSnap:p.isSnap,snapIndex:p.index,offset:b,dist:w,bounds:u,snap:p},vertical:{isBound:d[0].isBound,isSnap:m.isSnap,snapIndex:m.index,offset:_,dist:S,bounds:d,snap:m}}}function TZ(n,e,t,r){var i=Vn(n,e)/Math.PI*180,a=t.vertical,o=a.isBound,c=a.isSnap,u=a.dist,d=t.horizontal,h=d.isBound,p=d.isSnap,m=d.dist,b=i%180,_=b<3||b>177,w=b>87&&b<93;return m<u&&(o||c&&!w&&(!r||!_))?"vertical":h||p&&!_&&(!r||!w)?"horizontal":""}function AZ(n,e,t,r,i,a){return t.map(function(o){var c=J(o,2),u=c[0],d=c[1],h=ar(e,u),p=ar(e,d),m=r?CZ(n,h,p,i):oy(n,i,{vertical:[p[0]],horizontal:[p[1]]}),b=m.horizontal,_=b.offset,w=b.isBound,S=b.isSnap,T=m.vertical,C=T.offset,R=T.isBound,j=T.isSnap,z=$e(d,u);if(!C&&!_)return{isBound:R||w,isSnap:j||S,sign:z,offset:[0,0]};var V=TZ(h,p,m,r);if(!V)return{sign:z,isBound:!1,isSnap:!1,offset:[0,0]};var I=V==="vertical",A=[0,0];return!r&&_e(d[0])===1&&_e(d[1])===1&&u[0]!==d[0]&&u[1]!==d[1]?A=os({datas:a,distX:-C,distY:-_}):A=j_(h,p,-(I?C:_),I,a).offset,A=A.map(function(k,O){return k*(z[O]?2/z[O]:0)}),{sign:z,isBound:I?R:w,isSnap:I?j:S,offset:A}})}function fk(n,e){return n.isBound?n.offset:e.isSnap?e.offset:0}function CZ(n,e,t,r){var i=iZ(n,e,t),a=i.horizontal,o=i.vertical,c=r?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:fZ(n,e,t),u=c.horizontal,d=c.vertical,h=fk(a,u),p=fk(o,d),m=_e(h),b=_e(p);return{horizontal:{isBound:a.isBound,isSnap:u.isSnap,offset:h,dist:m},vertical:{isBound:o.isBound,isSnap:d.isSnap,offset:p,dist:b}}}function IZ(n,e,t,r,i){var a=[-t[0],-t[1]],o=n.state,c=o.width,u=o.height,d=n.props.bounds,h=1/0,p=1/0;if(d){var m=[[t[0],-t[1]],[-t[0],t[1]]],b=d.left,_=b===void 0?-1/0:b,w=d.top,S=w===void 0?-1/0:w,T=d.right,C=T===void 0?1/0:T,R=d.bottom,j=R===void 0?1/0:R;m.forEach(function(z){var V=z[0]!==a[0],I=z[1]!==a[1],A=ar(e,z),k=Vn(r,A)*360/Math.PI;if(I){var O=A.slice();(_e(k-360)<2||_e(k-180)<2)&&(O[1]=r[1]);var L=j_(r,O,(r[1]<A[1]?j:S)-A[1],!1,i),B=J(L.offset,2),M=B[1],Q=L.isOutside;isNaN(M)||(p=u+(Q?1:-1)*_e(M))}if(V){var O=A.slice();(_e(k-90)<2||_e(k-270)<2)&&(O[0]=r[0]);var X=j_(r,O,(r[0]<A[0]?C:_)-A[0],!0,i),$=J(X.offset,1),H=$[0],Z=X.isOutside;isNaN(H)||(h=c+(Z?1:-1)*_e(H))}})}return{maxWidth:h,maxHeight:p}}var Br={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(n,e){var t=n.props,r=t.hideThrottleDragRotateLine,i=t.throttleDragRotate,a=t.zoom,o=n.getState(),c=o.dragInfo,u=o.beforeOrigin;if(r||!i||!c)return[];var d=c.dist;if(!d[0]&&!d[1])return[];var h=Wi(d),p=Vn(d,[0,0]);return[e.createElement("div",{className:Ge("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(h,"px"),transform:"translate(".concat(u[0],"px, ").concat(u[1],"px) rotate(").concat(p,"rad) scaleY(").concat(a,")")}})]},dragStart:function(n,e){var t=e.datas,r=e.parentEvent,i=e.parentGesto,a=n.state,o=a.gestos,c=a.style;if(o.draggable)return!1;o.draggable=i||n.targetGesto,t.datas={},t.left=parseFloat(c.left||"")||0,t.top=parseFloat(c.top||"")||0,t.bottom=parseFloat(c.bottom||"")||0,t.right=parseFloat(c.right||"")||0,t.startValue=[0,0],Lc(n,e),iy(n,e,"translate"),YZ(n,t),t.prevDist=[0,0],t.prevBeforeDist=[0,0],t.isDrag=!1,t.deltaOffset=[0,0];var u=mt(n,e,W({set:function(h){t.startValue=h}},ry(n,e))),d=r||Pe(n,"onDragStart",u);return d!==!1?(t.isDrag=!0,n.state.dragInfo={startRect:n.getRect(),dist:[0,0]}):(o.draggable=null,t.isPinch=!1),t.isDrag?u:!1},drag:function(n,e){if(e){ty(n,e,"translate");var t=e.datas,r=e.parentEvent,i=e.parentFlag,a=e.isPinch,o=e.deltaOffset,c=e.useSnap,u=e.isRequest,d=e.isGroup,h=e.parentThrottleDrag,p=e.distX,m=e.distY,b=t.isDrag,_=t.prevDist,w=t.prevBeforeDist,S=t.startValue;if(b){o&&(p+=o[0],m+=o[1]);var T=n.props,C=T.parentMoveable,R=d?0:T.throttleDrag||h||0,j=r?0:T.throttleDragRotate||0,z=0,V=!1,I=!1,A=!1,k=!1;if(!r&&j>0&&(p||m)){var O=T.startDragRotate||0,L=ct(O+Vn([0,0],[p,m])*180/Math.PI,j)-O,B=m*Math.abs(Math.cos((L-90)/180*Math.PI)),M=p*Math.abs(Math.cos(L/180*Math.PI)),Q=Wi([M,B]);z=L*Math.PI/180,p=Q*Math.cos(z),m=Q*Math.sin(z)}if(!a&&!r&&!i){var X=J(SZ(n,p,m,j,!c&&u||o,t),2),$=X[0],H=X[1];V=$.isSnap,I=$.isBound,A=H.isSnap,k=H.isBound;var Z=$.offset,re=H.offset;p+=Z,m+=re}var de=Nt(iV({datas:t,distX:p,distY:m}),S),U=Nt(LQ({datas:t,distX:p,distY:m}),S);HD(U,$r),HD(de,$r),j||(!V&&!I&&(U[0]=ct(U[0],R),de[0]=ct(de[0],R)),!A&&!k&&(U[1]=ct(U[1],R),de[1]=ct(de[1],R)));var Y=$e(de,S),ne=$e(U,S),ie=$e(ne,_),te=$e(Y,w);t.prevDist=ne,t.prevBeforeDist=Y,t.passDelta=ie,t.passDist=ne;var se=t.left+Y[0],me=t.top+Y[1],Te=t.right-Y[0],Ce=t.bottom-Y[1],Ne=ny(t,"translate(".concat(U[0],"px, ").concat(U[1],"px)"),"translate(".concat(ne[0],"px, ").concat(ne[1],"px)"));if(fS(e,Ne),n.state.dragInfo.dist=r?[0,0]:ne,!(!r&&!C&&ie.every(function(Be){return!Be})&&te.some(function(Be){return!Be}))){var xe=n.state,Ee=xe.width,Qe=xe.height,Oe=mt(n,e,W({transform:Ne,dist:ne,delta:ie,translate:U,beforeDist:Y,beforeDelta:te,beforeTranslate:de,left:se,top:me,right:Te,bottom:Ce,width:Ee,height:Qe,isPinch:a},qr({transform:Ne},e)));return!r&&Pe(n,"onDrag",Oe),Oe}}}},dragAfter:function(n,e){var t=e.datas,r=t.deltaOffset;return r[0]||r[1]?(t.deltaOffset=[0,0],this.drag(n,W(W({},e),{deltaOffset:r}))):!1},dragEnd:function(n,e){var t=e.parentEvent,r=e.datas;if(n.state.dragInfo=null,!!r.isDrag){r.isDrag=!1;var i=Ei(n,e,{});return!t&&Pe(n,"onDragEnd",i),i}},dragGroupStart:function(n,e){var t,r,i=e.datas,a=e.clientX,o=e.clientY,c=this.dragStart(n,e);if(!c)return!1;var u=J1(n,this,"dragStart",[a||0,o||0],e,!1,"draggable"),d=u.childEvents,h=u.eventParams,p=W(W({},c),{targets:n.props.targets,events:h}),m=Pe(n,"onDragGroupStart",p);i.isDrag=m!==!1;var b=(r=(t=d[0])===null||t===void 0?void 0:t.datas.startValue)!==null&&r!==void 0?r:[0,0];return i.throttleOffset=[b[0]%1,b[1]%1],i.isDrag?c:!1},dragGroup:function(n,e){var t=e.datas;if(t.isDrag){var r=this.drag(n,W(W({},e),{parentThrottleDrag:n.props.throttleDrag})),i=e.datas.passDelta,a=J1(n,this,"drag",i,e,!1,"draggable").eventParams;if(r){var o=W({targets:n.props.targets,events:a},r);return Pe(n,"onDragGroup",o),o}}},dragGroupEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isDrag){this.dragEnd(n,e);var i=J1(n,this,"dragEnd",[0,0],e,!1,"draggable").eventParams;return Pe(n,"onDragGroupEnd",Ei(n,e,{targets:n.props.targets,events:i})),t}},request:function(n){var e={},t=n.getRect(),r=0,i=0,a=!1;return{isControl:!1,requestStart:function(o){return a=o.useSnap,{datas:e,useSnap:a}},request:function(o){return"x"in o?r=o.x-t.left:"deltaX"in o&&(r+=o.deltaX),"y"in o?i=o.y-t.top:"deltaY"in o&&(i+=o.deltaY),{datas:e,distX:r,distY:i,useSnap:a}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:a}}}},unset:function(n){n.state.gestos.draggable=null,n.state.dragInfo=null}};function SV(n,e){var t=ar(n,e),r=[0,0];return{fixedPosition:t,fixedDirection:e,fixedOffset:r}}function RZ(n,e){var t=n.allMatrix,r=n.is3d,i=n.width,a=n.height,o=r?4:3,c=[i/2*(1+e[0]),a/2*(1+e[1])],u=hn(t,c,o),d=[0,0];return{fixedPosition:u,fixedDirection:e,fixedOffset:d}}function TV(n,e){var t=n.allMatrix,r=n.is3d,i=n.width,a=n.height,o=r?4:3,c=YQ(e,i,a),u=hn(t,e,o),d=[i?0:e[0],a?0:e[1]];return{fixedPosition:u,fixedDirection:c,fixedOffset:d}}var hk=SS("resizable"),z_={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:fV("resizable"),dragControlCondition:hk,viewClassName:ES("resizable"),dragControlStart:function(n,e){var t,r=e.inputEvent,i=e.isPinch,a=e.isGroup,o=e.parentDirection,c=e.parentGesto,u=e.datas,d=e.parentFixedDirection,h=e.parentEvent,p=zV(o,i,r,u),m=n.state,b=m.target,_=m.width,w=m.height,S=m.gestos;if(!p||!b||S.resizable)return!1;S.resizable=c||n.controlGesto,!i&&Lc(n,e),u.datas={},u.direction=p,u.startOffsetWidth=_,u.startOffsetHeight=w,u.prevWidth=0,u.prevHeight=0,u.minSize=[0,0],u.startWidth=m.inlineCSSWidth||m.cssWidth,u.startHeight=m.inlineCSSHeight||m.cssHeight,u.maxSize=[1/0,1/0],a||(u.minSize=[m.minOffsetWidth,m.minOffsetHeight],u.maxSize=[m.maxOffsetWidth,m.maxOffsetHeight]);var T=n.props.transformOrigin||"% %";u.transformOrigin=ii(T)?T.split(" "):T,u.startOffsetMatrix=m.offsetMatrix,u.startTransformOrigin=m.transformOrigin,u.isWidth=(t=e?.parentIsWidth)!==null&&t!==void 0?t:!p[0]&&!p[1]||p[0]||!p[1];function C(k){u.ratio=k&&isFinite(k)?k:0}u.startPositions=Qi(n.state);function R(k){var O=SV(u.startPositions,k);u.fixedDirection=O.fixedDirection,u.fixedPosition=O.fixedPosition,u.fixedOffset=O.fixedOffset}function j(k){var O=TV(n.state,k);u.fixedDirection=O.fixedDirection,u.fixedPosition=O.fixedPosition,u.fixedOffset=O.fixedOffset}function z(k){u.minSize=[Xt("".concat(k[0]),0)||0,Xt("".concat(k[1]),0)||0]}function V(k){var O=[k[0]||1/0,k[1]||1/0];(!Sd(O[0])||isFinite(O[0]))&&(O[0]=Xt("".concat(O[0]),0)||1/0),(!Sd(O[1])||isFinite(O[1]))&&(O[1]=Xt("".concat(O[1]),0)||1/0),u.maxSize=O}C(_/w),R(d||[-p[0],-p[1]]),u.setFixedDirection=R,u.setFixedPosition=j,u.setMin=z,u.setMax=V;var I=mt(n,e,{direction:p,startRatio:u.ratio,set:function(k){var O=J(k,2),L=O[0],B=O[1];u.startWidth=L,u.startHeight=B},setMin:z,setMax:V,setRatio:C,setFixedDirection:R,setFixedPosition:j,setOrigin:function(k){u.transformOrigin=k},dragStart:Br.dragStart(n,new Ad().dragStart([0,0],e))}),A=h||Pe(n,"onResizeStart",I);return u.startFixedDirection=u.fixedDirection,u.startFixedPosition=u.fixedPosition,A!==!1&&(u.isResize=!0,n.state.snapRenderInfo={request:e.isRequest,direction:p}),u.isResize?I:!1},dragControl:function(n,e){var t,r=e.datas,i=e.parentFlag,a=e.isPinch,o=e.parentKeepRatio,c=e.dragClient,u=e.parentDist,d=e.useSnap,h=e.isRequest,p=e.isGroup,m=e.parentEvent,b=e.resolveMatrix,_=r.isResize,w=r.transformOrigin,S=r.startWidth,T=r.startHeight,C=r.prevWidth,R=r.prevHeight,j=r.minSize,z=r.maxSize,V=r.ratio,I=r.startOffsetWidth,A=r.startOffsetHeight,k=r.isWidth;if(!_)return;if(b){var O=n.state.is3d,L=r.startOffsetMatrix,B=r.startTransformOrigin,M=O?4:3,Q=up(sv(e)),X=Math.sqrt(Q.length);M!==X&&(Q=ba(Q,X,M));var $=Zp(L,Q,B,M),H=Bc($,I,A,M);r.startPositions=H,r.nextTargetMatrix=Q,r.nextAllMatrix=$}var Z=Mc(n.props,"resizable"),re=Z.resizeFormat,de=Z.throttleResize,U=de===void 0?i?0:1:de,Y=Z.parentMoveable,ne=Z.keepRatioFinally,ie=r.direction,te=ie,se=0,me=0;!ie[0]&&!ie[1]&&(te=[1,1]);var Te=V&&(o??Z.keepRatio)||!1;function Ce(){var bt=r.fixedDirection,Lt=qV(te,Te,r,e);se=Lt.distWidth,me=Lt.distHeight;var Cr=te[0]-bt[0]||Te?Math.max(I+se,$r):I,Qn=te[1]-bt[1]||Te?Math.max(A+me,$r):A;return Te&&I&&A&&(k?Qn=Cr/V:Cr=Qn*V),[Cr,Qn]}var Ne=J(Ce(),2),xe=Ne[0],Ee=Ne[1];m||(r.setFixedDirection(r.fixedDirection),Pe(n,"onBeforeResize",mt(n,e,{startFixedDirection:r.startFixedDirection,startFixedPosition:r.startFixedPosition,setFixedDirection:function(bt){var Lt;return r.setFixedDirection(bt),Lt=J(Ce(),2),xe=Lt[0],Ee=Lt[1],[xe,Ee]},setFixedPosition:function(bt){var Lt;return r.setFixedPosition(bt),Lt=J(Ce(),2),xe=Lt[0],Ee=Lt[1],[xe,Ee]},boundingWidth:xe,boundingHeight:Ee,setSize:function(bt){var Lt;Lt=J(bt,2),xe=Lt[0],Ee=Lt[1]}},!0)));var Qe=c;c||(!i&&a?Qe=QQ(n,[0,0]):Qe=r.fixedPosition);var Oe=[0,0];a||(Oe=HZ(n,xe,Ee,ie,Qe,!d&&h,r)),u&&(!u[0]&&(Oe[0]=0),!u[1]&&(Oe[1]=0));function Be(){var bt;re&&(bt=J(re([xe,Ee]),2),xe=bt[0],Ee=bt[1]),xe=ct(xe,U),Ee=ct(Ee,U)}if(Te){te[0]&&te[1]&&Oe[0]&&Oe[1]&&(_e(Oe[0])>_e(Oe[1])?Oe[1]=0:Oe[0]=0);var ze=!Oe[0]&&!Oe[1];ze&&Be(),te[0]&&!te[1]||Oe[0]&&!Oe[1]||ze&&k?(xe+=Oe[0],Ee=xe/V):(!te[0]&&te[1]||!Oe[0]&&Oe[1]||ze&&!k)&&(Ee+=Oe[1],xe=Ee*V)}else xe+=Oe[0],Ee+=Oe[1],xe=Math.max(0,xe),Ee=Math.max(0,Ee);t=J(m3([xe,Ee],j,z,Te?V:!1),2),xe=t[0],Ee=t[1],Be(),Te&&(p||ne)&&(k?Ee=xe/V:xe=Ee*V),se=xe-I,me=Ee-A;var st=[se-C,me-R];r.prevWidth=se,r.prevHeight=me;var yt=WQ(n,xe,Ee,Qe,w,r);if(!(!Y&&st.every(function(bt){return!bt})&&yt.every(function(bt){return!bt}))){var Ve=Br.drag(n,Qp(e,n.state,yt,!!a,!1,"draggable")),Ke=Ve.transform,Mt=S+se,vn=T+me,dn=mt(n,e,W({width:Mt,height:vn,offsetWidth:Math.round(xe),offsetHeight:Math.round(Ee),startRatio:V,boundingWidth:xe,boundingHeight:Ee,direction:ie,dist:[se,me],delta:st,isPinch:!!a,drag:Ve},BV({style:{width:"".concat(Mt,"px"),height:"".concat(vn,"px")},transform:Ke},Ve,e)));return!m&&Pe(n,"onResize",dn),dn}},dragControlAfter:function(n,e){var t=e.datas,r=t.isResize,i=t.startOffsetWidth,a=t.startOffsetHeight,o=t.prevWidth,c=t.prevHeight;if(!(!r||n.props.checkResizableError===!1)){var u=n.state,d=u.width,h=u.height,p=d-(i+o),m=h-(a+c),b=_e(p)>3,_=_e(m)>3;if(b&&(t.startWidth+=p,t.startOffsetWidth+=p,t.prevWidth+=p),_&&(t.startHeight+=m,t.startOffsetHeight+=m,t.prevHeight+=m),b||_)return this.dragControl(n,e)}},dragControlEnd:function(n,e){var t=e.datas,r=e.parentEvent;if(t.isResize){t.isResize=!1;var i=Ei(n,e,{});return!r&&Pe(n,"onResizeEnd",i),i}},dragGroupControlCondition:hk,dragGroupControlStart:function(n,e){var t=e.datas,r=this.dragControlStart(n,W(W({},e),{isGroup:!0}));if(!r)return!1;var i=pa(n,"resizable",e),a=t.startOffsetWidth,o=t.startOffsetHeight;function c(){var b=t.minSize;i.forEach(function(_){var w=_.datas,S=w.minSize,T=w.startOffsetWidth,C=w.startOffsetHeight,R=a*(T?S[0]/T:0),j=o*(C?S[1]/C:0);b[0]=Math.max(b[0],R),b[1]=Math.max(b[1],j)})}function u(){var b=t.maxSize;i.forEach(function(_){var w=_.datas,S=w.maxSize,T=w.startOffsetWidth,C=w.startOffsetHeight,R=a*(T?S[0]/T:0),j=o*(C?S[1]/C:0);b[0]=Math.min(b[0],R),b[1]=Math.min(b[1],j)})}var d=Vs(n,this,"dragControlStart",e,function(b,_){return ov(n,b,t,_)});c(),u();var h=function(b){r.setFixedDirection(b),d.forEach(function(_,w){_.setFixedDirection(b),ov(n,_.moveable,t,i[w])})};t.setFixedDirection=h;var p=W(W({},r),{targets:n.props.targets,events:d.map(function(b){return W(W({},b),{setMin:function(_){b.setMin(_),c()},setMax:function(_){b.setMax(_),u()}})}),setFixedDirection:h,setMin:function(b){r.setMin(b),c()},setMax:function(b){r.setMax(b),u()}}),m=Pe(n,"onResizeGroupStart",p);return t.isResize=m!==!1,t.isResize?r:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isResize){var r=Mc(n.props,"resizable");cy(n,"onBeforeResize",function(b){Pe(n,"onBeforeResizeGroup",mt(n,e,W(W({},b),{targets:r.targets}),!0))});var i=this.dragControl(n,W(W({},e),{isGroup:!0}));if(i){var a=i.boundingWidth,o=i.boundingHeight,c=i.dist,u=r.keepRatio,d=[a/(a-c[0]),o/(o-c[1])],h=t.fixedPosition,p=Vs(n,this,"dragControl",e,function(b,_){var w=J(Or(Kp(n.rotation/180*Math.PI,3),[_.datas.originalX*d[0],_.datas.originalY*d[1],1],3),2),S=w[0],T=w[1];return W(W({},_),{parentDist:null,parentScale:d,dragClient:Nt(h,[S,T]),parentKeepRatio:u})}),m=W({targets:r.targets,events:p},i);return Pe(n,"onResizeGroup",m),m}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isResize){this.dragControlEnd(n,e);var i=Vs(n,this,"dragControlEnd",e),a=Ei(n,e,{targets:n.props.targets,events:i});return Pe(n,"onResizeGroupEnd",a),t}},request:function(n){var e={},t=0,r=0,i=!1,a=n.getRect();return{isControl:!0,requestStart:function(o){var c;return i=o.useSnap,{datas:e,parentDirection:o.direction||[1,1],parentIsWidth:(c=o?.horizontal)!==null&&c!==void 0?c:!0,useSnap:i}},request:function(o){return"offsetWidth"in o?t=o.offsetWidth-a.offsetWidth:"deltaWidth"in o&&(t+=o.deltaWidth),"offsetHeight"in o?r=o.offsetHeight-a.offsetHeight:"deltaHeight"in o&&(r+=o.deltaHeight),{datas:e,parentDist:[t,r],parentKeepRatio:o.keepRatio,useSnap:i}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:i}}}},unset:function(n){n.state.gestos.resizable=null}};function ex(n,e,t,r,i){var a=n.props.groupable,o=n.state,c=o.is3d?4:3,u=e.origin,d=hn(n.state.rootMatrix,$e([u[0],u[1]],a?[0,0]:[o.left,o.top]),c),h=Nt([i.left,i.top],d);e.startAbsoluteOrigin=h,e.prevDeg=Vn(h,[t,r])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=Os(h,[t,r])}function x0(n,e,t){var r=t.defaultDeg,i=t.prevDeg,a=i%360,o=Math.floor(i/360);a<0&&(a+=360),a>n&&a>270&&n<90?++o:a<n&&a<90&&n>270&&--o;var c=e*(o*360+n-r);return t.prevDeg=r+c,c}function tx(n,e,t,r){return x0(Vn(r.startAbsoluteOrigin,[n,e])/Math.PI*180,t,r)}function nx(n,e,t,r,i,a){var o=n.props.throttleRotate,c=o===void 0?0:o,u=t.prevSnapDeg,d=0,h=!1;if(a){var p=qZ(n,e,r,i+r);h=p.isSnap,d=i+p.dist}h||(d=ct(i+r,c));var m=d-i;return t.prevSnapDeg=m,[m-u,m,d]}function AV(n,e,t){var r=J(e,4),i=r[0],a=r[1],o=r[2],c=r[3];if(n==="none")return[];if(Wn(n))return n.map(function(S){return AV(S,[i,a,o,c],t)[0]});var u=J((n||"top").split("-"),2),d=u[0],h=u[1],p=[i,a];d==="left"?p=[o,i]:d==="right"?p=[a,c]:d==="bottom"&&(p=[c,o]);var m=[(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2],b=VV(p,t);if(h){var _=h==="top"||h==="left",w=d==="bottom"||d==="left";m=p[_&&!w||!_&&w?0:1]}return[[m,b]]}function L_(n,e){if(e.isRequest)return e.requestAble==="rotatable";var t=e.inputEvent.target;if(ir(t,Ge("rotation-control"))||n.props.rotateAroundControls&&ir(t,Ge("around-control"))||ir(t,Ge("control"))&&ir(t,Ge("rotatable")))return!0;var r=n.props.rotationTarget;return r?TS(r,!0).some(function(i){return i?t===i||t.contains(i):!1}):!1}var DZ=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,kZ={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[DZ],viewClassName:function(n){return n.isDragging("rotatable")?Ge("view-rotation-dragging"):""},render:function(n,e){var t=Mc(n.props,"rotatable"),r=t.rotatable,i=t.rotationPosition,a=t.zoom,o=t.renderDirections,c=t.rotateAroundControls,u=t.resolveAblesWithRotatable,d=n.getState(),h=d.renderPoses,p=d.direction;if(!r)return null;var m=AV(i,h,p),b=[];if(m.forEach(function(T,C){var R=J(T,2),j=R[0],z=R[1];b.push(e.createElement("div",{key:"rotation".concat(C),className:Ge("rotation"),style:{transform:"translate(-50%) translate(".concat(j[0],"px, ").concat(j[1],"px) rotate(").concat(z,"rad)")}},e.createElement("div",{className:Ge("line rotation-line"),style:{transform:"scaleX(".concat(a,")")}}),e.createElement("div",{className:Ge("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(a,")")}})))}),o){var _=$s(u||{}),w={};_.forEach(function(T){u[T].forEach(function(C){w[C]=T})});var S=[];Wn(o)&&(S=o.map(function(T){var C=w[T];return{data:C?{resolve:C}:{},classNames:C?["move"]:[],dir:T}})),b.push.apply(b,Ae([],J(cV(n,"rotatable",S,e)),!1))}return c&&b.push.apply(b,Ae([],J(pV(n,e)),!1)),b},dragControlCondition:L_,dragControlStart:function(n,e){var t,r,i=e.datas,a=e.clientX,o=e.clientY,c=e.parentRotate,u=e.parentFlag,d=e.isPinch,h=e.isRequest,p=n.state,m=p.target,b=p.left,_=p.top,w=p.direction,S=p.beforeDirection,T=p.targetTransform,C=p.moveableClientRect,R=p.offsetMatrix,j=p.targetMatrix,z=p.allMatrix,V=p.width,I=p.height;if(!h&&!m)return!1;var A=n.getRect();i.rect=A,i.transform=T,i.left=b,i.top=_;var k=function(te){var se=TV(n.state,te);i.fixedDirection=se.fixedDirection,i.fixedOffset=se.fixedOffset,i.fixedPosition=se.fixedPosition,U&&U.setFixedPosition(te)},O=function(te){var se=RZ(n.state,te);i.fixedDirection=se.fixedDirection,i.fixedOffset=se.fixedOffset,i.fixedPosition=se.fixedPosition,U&&U.setFixedDirection(te)},L=a,B=o;if(h||d||u){var M=c||0;i.beforeInfo={origin:A.beforeOrigin,prevDeg:M,defaultDeg:M,prevSnapDeg:0,startDist:0},i.afterInfo=W(W({},i.beforeInfo),{origin:A.origin}),i.absoluteInfo=W(W({},i.beforeInfo),{origin:A.origin,startValue:M})}else{var Q=(r=e.inputEvent)===null||r===void 0?void 0:r.target;if(Q){var X=Q.getAttribute("data-direction")||"",$=jQ[X];if($){i.isControl=!0,i.isAroundControl=ir(Q,Ge("around-control")),i.controlDirection=$;var H=Q.getAttribute("data-resolve");H&&(i.resolveAble=H);var Z=sJ(p.rootMatrix,p.renderPoses,C);t=J(ar(Z,$),2),L=t[0],B=t[1]}}i.beforeInfo={origin:A.beforeOrigin},i.afterInfo={origin:A.origin},i.absoluteInfo={origin:A.origin,startValue:A.rotation};var re=k;k=function(te){var se=p.is3d?4:3,me=J(Nt(F3(j,se),te),2),Te=me[0],Ce=me[1],Ne=Or(R,Dc([Te,Ce],se)),xe=Or(z,Dc([te[0],te[1]],se));re(te);var Ee=p.posDelta;i.beforeInfo.origin=$e(Ne,Ee),i.afterInfo.origin=$e(xe,Ee),i.absoluteInfo.origin=$e(xe,Ee),ex(n,i.beforeInfo,L,B,C),ex(n,i.afterInfo,L,B,C),ex(n,i.absoluteInfo,L,B,C)},O=function(te){var se=ar([[0,0],[V,0],[0,I],[V,I]],te);k(se)}}i.startClientX=L,i.startClientY=B,i.direction=w,i.beforeDirection=S,i.startValue=0,i.datas={},iy(n,e,"rotate");var de=!1,U=!1;if(i.isControl&&i.resolveAble){var Y=i.resolveAble;Y==="resizable"&&(U=z_.dragControlStart(n,W(W({},new Ad("resizable").dragStart([0,0],e)),{parentPosition:i.controlPosition,parentFixedPosition:i.fixedPosition})))}U||(de=Br.dragStart(n,new Ad().dragStart([0,0],e))),k(oJ(n));var ne=mt(n,e,W(W({set:function(te){i.startValue=te*Math.PI/180},setFixedDirection:O,setFixedPosition:k},ry(n,e)),{dragStart:de,resizeStart:U})),ie=Pe(n,"onRotateStart",ne);return i.isRotate=ie!==!1,p.snapRenderInfo={request:e.isRequest},i.isRotate?ne:!1},dragControl:function(n,e){var t,r,i,a=e.datas,o=e.clientDistX,c=e.clientDistY,u=e.parentRotate,d=e.parentFlag,h=e.isPinch,p=e.groupDelta,m=e.resolveMatrix,b=a.beforeDirection,_=a.beforeInfo,w=a.afterInfo,S=a.absoluteInfo,T=a.isRotate,C=a.startValue,R=a.rect,j=a.startClientX,z=a.startClientY;if(T){ty(n,e,"rotate");var V=zQ(e),I=b*V,A=n.props.parentMoveable,k=0,O,L,B=0,M,Q,X=0,$,H,Z=180/Math.PI*C,re=S.startValue,de=!1,U=j+o,Y=z+c;if(!d&&"parentDist"in e){var ne=e.parentDist;O=ne,M=ne,$=ne}else h||d?(O=x0(u,b,_),M=x0(u,I,w),$=x0(u,I,S)):(O=tx(U,Y,b,_),M=tx(U,Y,I,w),$=tx(U,Y,I,S),de=!0);if(L=Z+O,Q=Z+M,H=re+$,Pe(n,"onBeforeRotate",mt(n,e,{beforeRotation:L,rotation:Q,absoluteRotation:H,setRotation:function(Qe){M=Qe-Z,O=M,$=M}},!0)),t=J(nx(n,R,_,O,Z,de),3),k=t[0],O=t[1],L=t[2],r=J(nx(n,R,w,M,Z,de),3),B=r[0],M=r[1],Q=r[2],i=J(nx(n,R,S,$,re,de),3),X=i[0],$=i[1],H=i[2],!(!X&&!B&&!k&&!A&&!m)){var ie=ny(a,"rotate(".concat(Q,"deg)"),"rotate(".concat(M,"deg)"));m&&(a.fixedPosition=hS(n,a.targetAllTransform,a.fixedDirection,a.fixedOffset,a));var te=XQ(n,M,a),se=$e(Nt(p||[0,0],te),a.prevInverseDist||[0,0]);a.prevInverseDist=te,a.requestValue=null;var me=sV(n,ie,se,h,e),Te=me,Ce=Os([U,Y],S.startAbsoluteOrigin)-S.startDist,Ne=void 0;if(a.resolveAble==="resizable"){var xe=z_.dragControl(n,W(W({},Qp(e,n.state,[e.deltaX,e.deltaY],!!h,!1,"resizable")),{resolveMatrix:!0,parentDistance:Ce}));xe&&(Ne=xe,Te=BV(Te,xe,e))}var Ee=mt(n,e,W(W({delta:B,dist:M,rotate:Q,rotation:Q,beforeDist:O,beforeDelta:k,beforeRotate:L,beforeRotation:L,absoluteDist:$,absoluteDelta:X,absoluteRotate:H,absoluteRotation:H,isPinch:!!h,resize:Ne},me),Te));return Pe(n,"onRotate",Ee),Ee}}},dragControlEnd:function(n,e){var t=e.datas;if(t.isRotate){t.isRotate=!1;var r=Ei(n,e,{});return Pe(n,"onRotateEnd",r),r}},dragGroupControlCondition:L_,dragGroupControlStart:function(n,e){var t=e.datas,r=n.state,i=r.left,a=r.top,o=r.beforeOrigin,c=this.dragControlStart(n,e);if(!c)return!1;c.set(t.beforeDirection*n.rotation);var u=Vs(n,this,"dragControlStart",e,function(p,m){var b=p.state,_=b.left,w=b.top,S=b.beforeOrigin,T=Nt($e([_,w],[i,a]),$e(S,o));return m.datas.startGroupClient=T,m.datas.groupClient=T,W(W({},m),{parentRotate:0})}),d=W(W({},c),{targets:n.props.targets,events:u}),h=Pe(n,"onRotateGroupStart",d);return t.isRotate=h!==!1,t.isRotate?c:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isRotate){cy(n,"onBeforeRotate",function(d){Pe(n,"onBeforeRotateGroup",mt(n,e,W(W({},d),{targets:n.props.targets}),!0))});var r=this.dragControl(n,e);if(r){var i=t.beforeDirection,a=r.beforeDist,o=a/180*Math.PI,c=Vs(n,this,"dragControl",e,function(d,h){var p=h.datas.startGroupClient,m=J(h.datas.groupClient,2),b=m[0],_=m[1],w=J(Yp(p,o*i),2),S=w[0],T=w[1],C=[S-b,T-_];return h.datas.groupClient=[S,T],W(W({},h),{parentRotate:a,groupDelta:C})});n.rotation=i*r.beforeRotation;var u=W({targets:n.props.targets,events:c,set:function(d){n.rotation=d},setGroupRotation:function(d){n.rotation=d}},r);return Pe(n,"onRotateGroup",u),u}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isRotate){this.dragControlEnd(n,e);var i=Vs(n,this,"dragControlEnd",e),a=Ei(n,e,{targets:n.props.targets,events:i});return Pe(n,"onRotateGroupEnd",a),t}},request:function(n){var e={},t=0,r=n.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(i){return"deltaRotate"in i?t+=i.deltaRotate:"rotate"in i&&(t=i.rotate-r),{datas:e,parentDist:t}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function NZ(n,e){var t,r=n.direction,i=n.classNames,a=n.size,o=n.pos,c=n.zoom,u=n.key,d=r==="horizontal",h=d?"Y":"X";return e.createElement("div",{key:u,className:i.join(" "),style:(t={},t[d?"width":"height"]="".concat(a),t.transform="translate(".concat(o[0],", ").concat(o[1],") translate").concat(h,"(-50%) scale").concat(h,"(").concat(c,")"),t)})}function bS(n,e){return NZ(W(W({},n),{classNames:Ae([Ge("line","guideline",n.direction)],J(n.classNames),!1).filter(function(t){return t}),size:n.size||"".concat(n.sizeValue,"px"),pos:n.pos||n.posValue.map(function(t){return"".concat(ct(t,.1),"px")})}),e)}function pk(n,e,t,r,i,a,o,c){var u=n.props.zoom;return t.map(function(d,h){var p=d.type,m=d.pos,b=[0,0];return b[o]=r,b[o?0:1]=-i+m,bS({key:"".concat(e,"TargetGuideline").concat(h),classNames:[Ge("target","bold",p)],posValue:b,sizeValue:a,zoom:u,direction:e},c)})}function gk(n,e,t,r,i,a){var o=n.props,c=o.zoom,u=o.isDisplayInnerSnapDigit,d=e==="horizontal"?dl:fl,h=i[d.start],p=i[d.end];return t.filter(function(m){var b=m.hide,_=m.elementRect;if(b)return!1;if(u&&_){var w=_.rect;if(w[d.start]<=h&&p<=w[d.end])return!1}return!0}).map(function(m,b){var _=m.pos,w=m.size,S=m.element,T=m.className,C=[-r[0]+_[0],-r[1]+_[1]];return bS({key:"".concat(e,"-default-guideline-").concat(b),classNames:S?[Ge("bold"),T]:[Ge("normal"),T],direction:e,posValue:C,sizeValue:w,zoom:c},a)})}function hh(n,e,t,r,i,a,o,c){var u,d=n.props,h=d.snapDigit,p=h===void 0?0:h,m=d.isDisplaySnapDigit,b=m===void 0?!0:m,_=d.snapDistFormat,w=_===void 0?function(z,V){return z}:_,S=d.zoom,T=e==="horizontal"?"X":"Y",C=e==="vertical"?"height":"width",R=Math.abs(i),j=b?parseFloat(R.toFixed(p)):0;return c.createElement("div",{key:"".concat(e,"-").concat(t,"-guideline-").concat(r),className:Ge("guideline-group",e),style:(u={left:"".concat(a[0],"px"),top:"".concat(a[1],"px")},u[C]="".concat(R,"px"),u)},bS({direction:e,classNames:[Ge(t),o],size:"100%",posValue:[0,0],sizeValue:R,zoom:S},c),c.createElement("div",{className:Ge("size-value","gap"),style:{transform:"translate".concat(T,"(-50%) scale(").concat(S,")")}},j>0?w(j,e):""))}function MZ(n,e,t,r){var i=n==="vertical"?0:1,a=n==="vertical"?1:0,o=i?dl:fl,c=t[o.start],u=t[o.end];return UV(e,function(d){return d.pos[i]}).map(function(d){var h=[],p=[],m=[];return d.forEach(function(b){var _,w,S=b.element,T=b.elementRect.rect;if(T[o.end]<c)h.push(b);else if(u<T[o.start])p.push(b);else if(T[o.start]<=c&&u<=T[o.end]&&r){var C=b.pos,R={element:S,rect:W(W({},T),(_={},_[o.end]=T[o.start],_))},j={element:S,rect:W(W({},T),(w={},w[o.start]=T[o.end],w))},z=[0,0],V=[0,0];z[i]=C[i],z[a]=C[a],V[i]=C[i],V[a]=C[a]+b.size,h.push({type:n,pos:z,size:0,elementRect:R,direction:"",elementDirection:"end"}),p.push({type:n,pos:V,size:0,elementRect:j,direction:"",elementDirection:"start"})}}),h.sort(function(b,_){return _.pos[a]-b.pos[a]}),p.sort(function(b,_){return b.pos[a]-_.pos[a]}),{total:d,start:h,end:p,inner:m}})}function PZ(n,e,t,r,i){var a=n.props.isDisplayInnerSnapDigit,o=[];return["vertical","horizontal"].forEach(function(c){var u=e.filter(function(S){return S.type===c}),d=c==="vertical"?1:0,h=d?0:1,p=MZ(c,u,r,a),m=d?fl:dl,b=d?dl:fl,_=r[m.start],w=r[m.end];p.forEach(function(S){var T=S.total,C=S.start,R=S.end,j=S.inner,z=t[h]+T[0].pos[h]-r[b.start],V=r;C.forEach(function(I){var A=I.elementRect.rect,k=V[m.start]-A[m.end];if(k>0){var O=[0,0];O[d]=t[d]+V[m.start]-_-k,O[h]=z,o.push(hh(n,c,"dashed",o.length,k,O,I.className,i))}V=A}),V=r,R.forEach(function(I){var A=I.elementRect.rect,k=A[m.start]-V[m.end];if(k>0){var O=[0,0];O[d]=t[d]+V[m.end]-_,O[h]=z,o.push(hh(n,c,"dashed",o.length,k,O,I.className,i))}V=A}),j.forEach(function(I){var A=I.elementRect.rect,k=_-A[m.start],O=A[m.end]-w,L=[0,0],B=[0,0];L[d]=t[d]-k,L[h]=z,B[d]=t[d]+w-_,B[h]=z,o.push(hh(n,c,"dashed",o.length,k,L,I.className,i)),o.push(hh(n,c,"dashed",o.length,O,B,I.className,i))})})}),o}function OZ(n,e,t,r,i){var a=[];return["horizontal","vertical"].forEach(function(o){var c=e.filter(function(S){return S.type===o}).slice(0,1),u=o==="vertical"?0:1,d=u?0:1,h=u?fl:dl,p=u?dl:fl,m=r[h.start],b=r[h.end],_=r[p.start],w=r[p.end];c.forEach(function(S){var T=S.gap,C=S.gapRects,R=Math.max.apply(Math,Ae([_],J(C.map(function(V){var I=V.rect;return I[p.start]})),!1)),j=Math.min.apply(Math,Ae([w],J(C.map(function(V){var I=V.rect;return I[p.end]})),!1)),z=(R+j)/2;R===j||z===(_+w)/2||C.forEach(function(V){var I=V.rect,A=V.className,k=[t[0],t[1]];if(I[h.end]<m)k[u]+=I[h.end]-m;else if(b<I[h.start])k[u]+=I[h.start]-m-T;else return;k[d]+=z-_,a.push(hh(n,u?"vertical":"horizontal","gap",a.length,T,k,A,i))})})}),a}function B_(n){var e,t,r=n.state,i=r.containerClientRect,a=r.hasFixed,o=i.overflow,c=i.scrollHeight,u=i.scrollWidth,d=i.clientHeight,h=i.clientWidth,p=i.clientLeft,m=i.clientTop,b=n.props,_=b.snapGap,w=_===void 0?!0:_,S=b.verticalGuidelines,T=b.horizontalGuidelines,C=b.snapThreshold,R=C===void 0?5:C,j=b.maxSnapElementGuidelineDistance,z=j===void 0?1/0:j,V=b.isDisplayGridGuidelines,I=Xi(Qi(n.state)),A=I.top,k=I.left,O=I.bottom,L=I.right,B={top:A,left:k,bottom:O,right:L,center:(k+L)/2,middle:(A+O)/2},M=LZ(n),Q=Ae([],J(M),!1),X=((t=(e=r.snapThresholdInfo)===null||e===void 0?void 0:e.multiples)!==null&&t!==void 0?t:[1,1]).map(function(re){return re*R});w&&Q.push.apply(Q,Ae([],J(VZ(n,B,X)),!1));var $=W({},r.snapOffset||{left:0,top:0,bottom:0,right:0});if(Q.push.apply(Q,Ae([],J(zZ(n,o?u:h,o?c:d,p,m,$,V)),!1)),a){var H=i.left,Z=i.top;$.left+=H,$.top+=Z,$.right+=H,$.bottom+=Z}return Q.push.apply(Q,Ae([],J(IV(T||!1,S||!1,o?u:h,o?c:d,p,m,$)),!1)),Q=Q.filter(function(re){var de=re.element,U=re.elementRect,Y=re.type;if(!de||!U)return!0;var ne=U.rect;return CV(B,ne,Y,z)}),Q}function VZ(n,e,t){var r=n.props,i=r.maxSnapElementGuidelineDistance,a=i===void 0?1/0:i,o=r.maxSnapElementGapDistance,c=o===void 0?1/0:o,u=n.state.elementRects,d=[];return[["vertical",dl,fl],["horizontal",fl,dl]].forEach(function(h){var p=J(h,3),m=p[0],b=p[1],_=p[2],w=e[b.start],S=e[b.end],T=e[b.center],C=e[_.start],R=e[_.end],j={left:t[0],top:t[1]};function z(A){var k=A.rect,O=j[b.start];return k[b.end]<w+O?w-k[b.end]:S-O<k[b.start]?k[b.start]-S:-1}var V=u.filter(function(A){var k=A.rect;return k[_.start]>R||k[_.end]<C?!1:z(A)>0}).sort(function(A,k){return z(A)-z(k)}),I=[];V.forEach(function(A){V.forEach(function(k){if(A!==k){var O=A.rect,L=k.rect,B=O[_.start],M=O[_.end],Q=L[_.start],X=L[_.end];B>X||Q>M||I.push([A,k])}})}),I.forEach(function(A){var k=J(A,2),O=k[0],L=k[1],B=O.rect,M=L.rect,Q=B[b.start],X=B[b.end],$=M[b.start],H=M[b.end],Z=j[b.start],re=0,de=0,U=!1,Y=!1,ne=!1;if(X<=w&&S<=$){if(Y=!0,re=($-X-(S-w))/2,de=X+re+(S-w)/2,_e(de-T)>Z)return}else if(X<$&&H<w+Z){if(U=!0,re=$-X,de=H+re,_e(de-w)>Z)return}else if(X<$&&S-Z<Q){if(ne=!0,re=$-X,de=Q-re,_e(de-S)>Z)return}else return;re&&CV(e,M,m,a)&&(re>c||d.push({type:m,pos:m==="vertical"?[de,0]:[0,de],element:L.element,size:0,className:L.className,isStart:U,isCenter:Y,isEnd:ne,gap:re,hide:!0,gapRects:[O,L],direction:"",elementDirection:""}))})}),d}function jZ(n,e,t,r){var i,a,o=n.props,c=n.state,u=o.snapGridAll,d=o.snapGridWidth,h=d===void 0?0:d,p=o.snapGridHeight,m=p===void 0?0:p,b=c.snapRenderInfo,_=b&&(((i=b.direction)===null||i===void 0?void 0:i[0])||((a=b.direction)===null||a===void 0?void 0:a[1])),w=n.moveables;if(u&&w&&_&&(h||m)){if(c.snapThresholdInfo)return;c.snapThresholdInfo={multiples:[1,1],offset:[0,0]};var S=n.getRect(),T=S.children,C=b.direction;if(T){var R=C.map(function(z,V){var I=V===0?{snapSize:h,posName:"left",sizeName:"width",clientOffset:r.left-e}:{snapSize:m,posName:"top",sizeName:"height",clientOffset:r.top-t},A=I.snapSize,k=I.posName,O=I.sizeName,L=I.clientOffset;if(!A)return{dir:z,multiple:1,snapSize:A,snapOffset:0};var B=S[O],M=S[k],Q=v3(T.map(function(U){return[U[k]-M,U[O],B-U[O]-U[k]+M]})).filter(function(U){return U}).sort(function(U,Y){return U-Y}),X=Q[0],$=Q.map(function(U){return ct(U/X,.1)*A}),H=1,Z=ct(B/X,.1);for(H=1;H<=10&&!$.every(function(U){return U*H%1===0});++H);var re=(-z+1)/2,de=nv(M-L,M-L+B,re,1-re);return{multiple:Z*H,dir:z,snapSize:A,snapOffset:Math.round(de/A)}}),j=R.map(function(z){return z.multiple||1});c.snapThresholdInfo.multiples=j,c.snapThresholdInfo.offset=R.map(function(z){return z.snapOffset}),R.forEach(function(z,V){z.snapSize})}}else c.snapThresholdInfo=null}function zZ(n,e,t,r,i,a,o){r===void 0&&(r=0),i===void 0&&(i=0);var c=n.props,u=n.state,d=c.snapGridWidth,h=d===void 0?0:d,p=c.snapGridHeight,m=p===void 0?0:p,b=[],_=a.left,w=a.top,S=[0,0];jZ(n,r,i,a);var T=u.snapThresholdInfo,C=h,R=m;if(T&&(h*=T.multiples[0]||1,m*=T.multiples[1]||1,S=T.offset),m){for(var j=function(V){b.push({type:"horizontal",pos:[_,ct(S[1]*R+V-i+w,.1)],className:Ge("grid-guideline"),size:e,hide:!o,direction:"",grid:!0})},z=0;z<=t*2;z+=m)j(z);for(var z=-m;z>=-t;z-=m)j(z)}if(h){for(var j=function(I){b.push({type:"vertical",pos:[ct(S[0]*C+I-r+_,.1),w],className:Ge("grid-guideline"),size:t,hide:!o,direction:"",grid:!0})},z=0;z<=e*2;z+=h)j(z);for(var z=-h;z>=-e;z-=h)j(z)}return b}function CV(n,e,t,r){return t==="horizontal"?_e(n.right-e.left)<=r||_e(n.left-e.right)<=r||n.left<=e.right&&e.left<=n.right:t==="vertical"?_e(n.bottom-e.top)<=r||_e(n.top-e.bottom)<=r||n.top<=e.bottom&&e.top<=n.bottom:!0}function LZ(n){var e=n.state,t=n.props.elementGuidelines,r=t===void 0?[]:t;if(!r.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter(function(m){return!m.refresh}),a=r.map(function(m){return ya(m)&&"element"in m?W(W({},m),{element:Ja(m.element,!0)}):{element:Ja(m,!0)}}).filter(function(m){return m.element}),o=QW(i.map(function(m){return m.element}),a.map(function(m){return m.element})),c=o.maintained,u=o.added,d=[];c.forEach(function(m){var b=J(m,2),_=b[0],w=b[1];d[w]=i[_]}),BZ(n,u.map(function(m){return a[m]})).map(function(m,b){d[u[b]]=m}),e.elementRects=d;var h=gS(n.props.elementSnapDirections),p=[];return d.forEach(function(m){var b=m.element,_=m.top,w=_===void 0?h.top:_,S=m.left,T=S===void 0?h.left:S,C=m.right,R=C===void 0?h.right:C,j=m.bottom,z=j===void 0?h.bottom:j,V=m.center,I=V===void 0?h.center:V,A=m.middle,k=A===void 0?h.middle:A,O=m.className,L=m.rect,B=mS({top:w,right:R,left:T,bottom:z,center:I,middle:k},L),M=B.horizontal,Q=B.vertical,X=B.horizontalNames,$=B.verticalNames,H=L.top,Z=L.left,re=L.right-Z,de=L.bottom-H,U=[re,de];Q.forEach(function(Y,ne){p.push({type:"vertical",element:b,pos:[ct(Y,.1),H],size:de,sizes:U,className:O,elementRect:m,elementDirection:sk[$[ne]]||$[ne],direction:""})}),M.forEach(function(Y,ne){p.push({type:"horizontal",element:b,pos:[Z,ct(Y,.1)],size:re,sizes:U,className:O,elementRect:m,elementDirection:sk[X[ne]]||X[ne],direction:""})})}),p}function mk(n,e){return n?n.map(function(t){var r=ya(t)?t:{pos:t},i=r.pos;return Sd(i)?r:W(W({},r),{pos:Xt(i,e)})}):[]}function IV(n,e,t,r,i,a,o){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o={left:0,top:0,right:0,bottom:0});var c=[],u=o.left,d=o.top,h=o.bottom,p=o.right,m=t+p-u,b=r+h-d;return mk(n,b).forEach(function(_){c.push({type:"horizontal",pos:[u,ct(_.pos-a+d,.1)],size:m,className:_.className,direction:""})}),mk(e,m).forEach(function(_){c.push({type:"vertical",pos:[ct(_.pos-i+u,.1),d],size:b,className:_.className,direction:""})}),c}function BZ(n,e){if(!e.length)return[];var t=n.props.groupable,r=n.state,i=r.containerClientRect,a=r.rootMatrix,o=r.is3d,c=r.offsetDelta,u=o?4:3,d=J(uZ(a,i,u),2),h=d[0],p=d[1],m=t?0:c[0],b=t?0:c[1];return e.map(function(_){var w=_.element.getBoundingClientRect(),S=w.left-h-m,T=w.top-p-b,C=T+w.height,R=S+w.width,j=J(Rd(a,[S,T],u),2),z=j[0],V=j[1],I=J(Rd(a,[R,C],u),2),A=I[0],k=I[1];return W(W({},_),{rect:{left:z,right:A,top:V,bottom:k,center:(z+A)/2,middle:(V+k)/2}})})}function qm(n){var e=n.state,t=e.container,r=n.props.snapContainer||t;if(e.snapContainer===r&&e.guidelines&&e.guidelines.length)return!1;var i=e.containerClientRect,a={left:0,top:0,bottom:0,right:0};if(t!==r){var o=Ja(r,!0);if(o){var c=Ph(o),u=wk(e,[c.left-i.left,c.top-i.top]),d=wk(e,[c.right-i.right,c.bottom-i.bottom]);a.left=ct(u[0],1e-5),a.top=ct(u[1],1e-5),a.right=ct(d[0],1e-5),a.bottom=ct(d[1],1e-5)}}return e.snapContainer=r,e.snapOffset=a,e.guidelines=B_(n),e.enableSnap=!0,!0}function RV(n,e,t,r,i,a){var o=Bc(n,e,t,a?4:3),c=ar(o,r);return _S(o,$e(i,c))}function vk(n){return n?n/_e(n):0}function UZ(n,e,t,r,i,a){var o=a.fixedDirection,c=pZ(t,o,r),u=yS(n,e,t,r),d=Ae(Ae([],J(AZ(n,e,c,r,i,a)),!1),J(EV(n,u,a)),!1),h=lv(d,0),p=lv(d,1);return{width:{isBound:h.isBound,offset:h.offset[0]},height:{isBound:p.isBound,offset:p.offset[1]}}}function FZ(n,e,t,r,i,a,o,c,u){var d=ar(e,o),h=oy(n,c,{vertical:[d[0]],horizontal:[d[1]]}),p=h.horizontal.offset,m=h.vertical.offset;if(ct(m,M_)||ct(p,M_)){var b=J(os({datas:u,distX:-m,distY:-p}),2),_=b[0],w=b[1],S=Math.min(i||1/0,t+o[0]*_),T=Math.min(a||1/0,r+o[1]*w);return[S-t,T-r]}return[0,0]}function DV(n,e,t,r,i,a,o,c){for(var u=Qi(n.state),d=n.props.keepRatio,h=0,p=0,m=0;m<2;++m){var b=e(h,p),_=UZ(n,b,i,d,o,c),w=_.width,S=_.height,T=w.isBound,C=S.isBound,R=w.offset,j=S.offset;if(m===1&&(T||(R=0),C||(j=0)),m===0&&o&&!T&&!C)return[0,0];if(d){var z=_e(R)*(t?1/t:1),V=_e(j)*(r?1/r:1),I=T&&C?z<V:C||!T&&z<V;I?R=t*j/r:j=r*R/t}h+=R,p+=j}if(!d&&i[0]&&i[1]){var A=IZ(n,u,i,a,c),k=A.maxWidth,O=A.maxHeight,L=J(FZ(n,e(h,p).map(function(Q){return Q.map(function(X){return ct(X,M_)})}),t+h,r+p,k,O,i,o,c),2),R=L[0],j=L[1];h+=R,p+=j}return[h,p]}function Nh(n){return n<0&&(n=n%360+360),n%=360,n}function GZ(n,e){e=Nh(e);var t=Math.floor(n/360),r=t*360+360-e,i=t*360+e;return _e(n-r)<_e(n-i)?r:i}function rx(n,e){n=Nh(n),e=Nh(e);var t=Nh(n-e);return Math.min(t,360-t)}function qZ(n,e,t,r){var i,a=n.props,o=(i=a[gV])!==null&&i!==void 0?i:5,c=a[mV];if(Xd(n,"rotatable")){var u=e.pos1,d=e.pos2,h=e.pos3,p=e.pos4,m=e.origin,b=t*Math.PI/180,_=[u,d,h,p].map(function(j){return $e(j,m)}),w=_.map(function(j){return Yp(j,b)}),S=Ae(Ae([],J(sZ(n,_,w,m,t)),!1),J(xZ(n,_,w,m,t)),!1);S.sort(function(j,z){return _e(j-t)-_e(z-t)});var T=S.length>0;if(T)return{isSnap:T,dist:T?S[0]:t}}if(c?.length&&o){var C=c.slice().sort(function(j,z){return rx(j,r)-rx(z,r)}),R=C[0];if(rx(R,r)<=o)return{isSnap:!0,dist:t+GZ(r,R)-r}}return{isSnap:!1,dist:t}}function HZ(n,e,t,r,i,a,o){if(!Xd(n,"resizable"))return[0,0];var c=o.fixedDirection,u=o.nextAllMatrix,d=n.state,h=d.allMatrix,p=d.is3d;return DV(n,function(m,b){return RV(u||h,e+m,t+b,c,i,p)},e,t,r,i,a,o)}function $Z(n,e,t,r,i){if(!Xd(n,"scalable"))return[0,0];var a=i.startOffsetWidth,o=i.startOffsetHeight,c=i.fixedPosition,u=i.fixedDirection,d=i.is3d,h=DV(n,function(p,m){return RV(HQ(i,Nt(e,[p/a,m/o])),a,o,u,c,d)},a,o,t,c,r,i);return[h[0]/a,h[1]/o]}function YZ(n,e){e.absolutePoses=Qi(n.state)}function yk(n){var e=[];return n.forEach(function(t){t.guidelineInfos.forEach(function(r){var i=r.guideline;ai(e,function(a){return a.guideline===i})||(i.direction="",e.push({guideline:i,posInfo:t}))})}),e.map(function(t){var r=t.guideline,i=t.posInfo;return W(W({},r),{direction:i.direction})})}function bk(n,e,t,r,i,a){var o=pS(ay(n,a),e,t),c=o.vertical,u=o.horizontal,d=Ku();c.forEach(function(_){_.isBound&&(_.direction==="start"&&(d.left=!0),_.direction==="end"&&(d.right=!0),r.push({type:"bounds",pos:_.pos}))}),u.forEach(function(_){_.isBound&&(_.direction==="start"&&(d.top=!0),_.direction==="end"&&(d.bottom=!0),i.push({type:"bounds",pos:_.pos}))});var h=_Z(n),p=h.boundMap,m=h.vertical,b=h.horizontal;return m.forEach(function(_){Hs(r,function(w){var S=w.type,T=w.pos;return S==="bounds"&&T===_})>=0||r.push({type:"bounds",pos:_})}),b.forEach(function(_){Hs(i,function(w){var S=w.type,T=w.pos;return S==="bounds"&&T===_})>=0||i.push({type:"bounds",pos:_})}),{boundMap:d,innerBoundMap:p}}var KZ=SS("",["resizable","scalable"]),XZ={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold","snapGridAll",gV,mV,vV,yV,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(n,e){var t=n.state,r=t.top,i=t.left,a=t.pos1,o=t.pos2,c=t.pos3,u=t.pos4,d=t.snapRenderInfo,h=n.props.snapRenderThreshold,p=h===void 0?1:h;if(!d||!d.render||!Xd(n,""))return Wu(n,"boundMap",Ku(),function(ie){return JSON.stringify(ie)}),Wu(n,"innerBoundMap",Ku(),function(ie){return JSON.stringify(ie)}),[];t.guidelines=B_(n);var m=Math.min(a[0],o[0],c[0],u[0]),b=Math.min(a[1],o[1],c[1],u[1]),_=d.externalPoses||[],w=Qi(n.state),S=[],T=[],C=[],R=[],j=[],z=Xi(w),V=z.width,I=z.height,A=z.top,k=z.left,O=z.bottom,L=z.right,B={left:k,right:L,top:A,bottom:O,center:(k+L)/2,middle:(A+O)/2},M=_.length>0,Q=M?Xi(_):{};if(!d.request){if(d.direction&&j.push(hZ(n,w,d.direction,p,p)),d.snap){var X=Xi(w);d.center&&(X.middle=(X.top+X.bottom)/2,X.center=(X.left+X.right)/2),j.push(ok(n,X,p,p))}M&&(d.center&&(Q.middle=(Q.top+Q.bottom)/2,Q.center=(Q.left+Q.right)/2),j.push(ok(n,Q,p,p))),j.forEach(function(ie){var te=ie.vertical.posInfos,se=ie.horizontal.posInfos;S.push.apply(S,Ae([],J(te.filter(function(me){var Te=me.guidelineInfos;return Te.some(function(Ce){var Ne=Ce.guideline;return!Ne.hide})}).map(function(me){return{type:"snap",pos:me.pos}})),!1)),T.push.apply(T,Ae([],J(se.filter(function(me){var Te=me.guidelineInfos;return Te.some(function(Ce){var Ne=Ce.guideline;return!Ne.hide})}).map(function(me){return{type:"snap",pos:me.pos}})),!1)),C.push.apply(C,Ae([],J(yk(te)),!1)),R.push.apply(R,Ae([],J(yk(se)),!1))})}var $=bk(n,[k,L],[A,O],S,T),H=$.boundMap,Z=$.innerBoundMap;M&&bk(n,[Q.left,Q.right],[Q.top,Q.bottom],S,T,d.externalBounds);var re=Ae(Ae([],J(C),!1),J(R),!1),de=re.filter(function(ie){return ie.element&&!ie.gapRects}),U=re.filter(function(ie){return ie.gapRects}).sort(function(ie,te){return ie.gap-te.gap});Pe(n,"onSnap",{guidelines:re.filter(function(ie){var te=ie.element;return!te}),elements:de,gaps:U},!0);var Y=Wu(n,"boundMap",H,function(ie){return JSON.stringify(ie)},Ku()),ne=Wu(n,"innerBoundMap",Z,function(ie){return JSON.stringify(ie)},Ku());return(H===Y||Z===ne)&&Pe(n,"onBound",{bounds:H,innerBounds:Z},!0),Ae(Ae(Ae(Ae(Ae(Ae([],J(PZ(n,de,[m,b],B,e)),!1),J(OZ(n,U,[m,b],B,e)),!1),J(gk(n,"horizontal",R,[i,r],B,e)),!1),J(gk(n,"vertical",C,[i,r],B,e)),!1),J(pk(n,"horizontal",T,m,r,V,0,e)),!1),J(pk(n,"vertical",S,b,i,I,1,e)),!1)},dragStart:function(n,e){n.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},qm(n)},drag:function(n){var e=n.state;qm(n)||(e.guidelines=B_(n)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart:function(n){this.unset(n)},dragEnd:function(n){this.unset(n)},dragControlCondition:function(n,e){if(KZ(n,e)||L_(n,e))return!0;if(!e.isRequest&&e.inputEvent)return ir(e.inputEvent.target,Ge("snap-control"))},dragControlStart:function(n){n.state.snapRenderInfo=null,qm(n)},dragControl:function(n){this.drag(n)},dragControlEnd:function(n){this.unset(n)},dragGroupStart:function(n,e){this.dragStart(n,e)},dragGroup:function(n){this.drag(n)},dragGroupEnd:function(n){this.unset(n)},dragGroupControlStart:function(n){n.state.snapRenderInfo=null,qm(n)},dragGroupControl:function(n){this.drag(n)},dragGroupControlEnd:function(n){this.unset(n)},unset:function(n){var e=n.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function WZ(n,e){return[n[0]*e[0],n[1]*e[1]]}function Ge(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return HX.apply(void 0,Ae([uS],J(n),!1))}function kV(n){n()}function QZ(n){return!n||n==="none"?[1,0,0,1,0,0]:ya(n)?n:up(n)}function Mh(n,e,t){return iv(e,kc(t,e),n,kc(t.map(function(r){return-r}),e))}function ZZ(n,e,t){if(e==="%"){var r=xS(n.ownerSVGElement);return r[t?"width":"height"]/100}return 1}function JZ(n){var e=eJ(wS(n,":before"));return e.map(function(t,r){var i=Gp(t),a=i.value,o=i.unit;return a*ZZ(n,o,r===0)})}function uv(n){return n?n.split(" "):["0","0"]}function eJ(n){return uv(n.transformOrigin)}function NV(n){var e=si(n),t=e("transform");if(t&&t!=="none")return t;if("transform"in n){var r=n.transform,i=r.baseVal;if(!i)return"";var a=i.length;if(!a)return"";for(var o=[],c=function(d){var h=i[d].matrix;o.push("matrix(".concat(["a","b","c","d","e","f"].map(function(p){return h[p]}).join(", "),")"))},u=0;u<a;++u)c(u);return o.join(" ")}return""}function fp(n,e,t,r,i){var a,o,c=JE(n)||yl(n),u=!1,d,h;if(!n||t)d=n;else{var p=(a=n?.assignedSlot)===null||a===void 0?void 0:a.parentElement,m=n.parentElement;p?(u=!0,h=m,d=p):d=m}for(var b=!1,_=n===e||d===e,w="relative",S=1,T=parseFloat(i?.("zoom"))||1,C=i?.("position");d&&d!==c;){e===d&&(_=!0);var R=si(d),j=d.tagName.toLowerCase(),z=NV(d),V=R("willChange"),I=parseFloat(R("zoom"))||1;if(w=R("position"),r&&I!==1){S=I;break}if(!t&&r&&T!==1&&C&&C!=="absolute"||j==="svg"||j==="foreignobject"||w!=="static"||z&&z!=="none"||V==="transform")break;var A=(o=n?.assignedSlot)===null||o===void 0?void 0:o.parentNode,k=d.parentNode;A&&(u=!0,h=k);var O=k;if(O&&O.nodeType===11){d=O.host,b=!0,w=si(d)("position");break}d=O,w="relative"}return{offsetZoom:S,hasSlot:u,parentSlotElement:h,isCustomElement:b,isStatic:w==="static",isEnd:_||!d||d===c,offsetParent:d||c}}function tJ(n,e){var t,r=n.tagName.toLowerCase(),i=n.offsetLeft,a=n.offsetTop,o=si(n),c=Qv(i),u=!c,d,h;return!u&&(r!=="svg"||n.ownerSVGElement)?(d=Q3?JZ(n):uv(o("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice(),u=!0,r==="svg"?(i=0,a=0):(t=J(iJ(n,d,n===e&&e.tagName.toLowerCase()==="g"),4),i=t[0],a=t[1],d[0]=t[2],d[1]=t[3])):(d=uv(o("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice()),{tagName:r,isSVG:c,hasOffset:u,offset:[i||0,a||0],origin:d,targetOrigin:h}}function MV(n,e){var t=si(n),r=si(yl(n)),i=r("position");if(!e&&(!i||i==="static"))return[0,0];var a=parseInt(r("marginLeft"),10),o=parseInt(r("marginTop"),10);return t("position")==="absolute"&&((t("top")!=="auto"||t("bottom")!=="auto")&&(o=0),(t("left")!=="auto"||t("right")!=="auto")&&(a=0)),[a,o]}function U_(n){n.forEach(function(e){var t=e.matrix;t&&(e.matrix=ba(t,3,4))})}function nJ(n){for(var e=n.parentElement,t=!1,r=yl(n);e;){var i=wS(e).transform;if(i&&i!=="none"){t=!0;break}if(e===r)break;e=e.parentElement}return{fixedContainer:e||r,hasTransform:t}}function ly(n,e){return e===void 0&&(e=n.length>9),"".concat(e?"matrix3d":"matrix","(").concat(G3(n,!e).join(","),")")}function xS(n){var e=n.clientWidth,t=n.clientHeight;if(!n)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:t};var r=n.viewBox,i=r&&r.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||t,clientWidth:e,clientHeight:t}}function rJ(n,e){var t,r=xS(n),i=r.width,a=r.height,o=r.clientWidth,c=r.clientHeight,u=o/i,d=c/a,h=n.preserveAspectRatio.baseVal,p=h.align,m=h.meetOrSlice,b=[0,0],_=[u,d],w=[0,0];if(p!==1){var S=(p-2)%3,T=Math.floor((p-2)/3);b[0]=i*S/2,b[1]=a*T/2;var C=m===2?Math.max(d,u):Math.min(u,d);_[0]=C,_[1]=C,w[0]=(o-i)/2*S,w[1]=(c-a)/2*T}var R=sS(_,e);return t=J(w,2),R[e*(e-1)]=t[0],R[e*(e-1)+1]=t[1],Mh(R,e,b)}function iJ(n,e,t){var r=n.tagName.toLowerCase();if(!n.getBBox||!t&&r==="g")return[0,0,0,0];var i=si(n),a=i("transform-box")==="fill-box",o=n.getBBox(),c=xS(n.ownerSVGElement),u=o.x,d=o.y;r==="foreignobject"&&!u&&!d&&(u=parseFloat(n.getAttribute("x"))||0,d=parseFloat(n.getAttribute("y"))||0);var h=u-c.x,p=d-c.y,m=a?e[0]:e[0]-h,b=a?e[1]:e[1]-p;return[h,p,m,b]}function hn(n,e,t){return Or(n,Dc(e,t),t)}function Bc(n,e,t,r){return[[0,0],[e,0],[0,t],[e,t]].map(function(i){return hn(n,i,r)})}function Xi(n){var e=n.map(function(d){return d[0]}),t=n.map(function(d){return d[1]}),r=Math.min.apply(Math,Ae([],J(e),!1)),i=Math.min.apply(Math,Ae([],J(t),!1)),a=Math.max.apply(Math,Ae([],J(e),!1)),o=Math.max.apply(Math,Ae([],J(t),!1)),c=a-r,u=o-i;return{left:r,top:i,right:a,bottom:o,width:c,height:u}}function xk(n,e,t,r){var i=Bc(n,e,t,r);return Xi(i)}function aJ(n,e,t,r,i){var a,o=n.target,c=n.origin,u=e.matrix,d=OV(o),h=d.offsetWidth,p=d.offsetHeight,m=t.getBoundingClientRect(),b=[0,0];t===yl(t)&&(b=MV(o,!0));for(var _=o.getBoundingClientRect(),w=_.left-m.left+t.scrollLeft-(t.clientLeft||0)+b[0],S=_.top-m.top+t.scrollTop-(t.clientTop||0)+b[1],T=_.width,C=_.height,R=iv(r,i,u),j=xk(R,h,p,r),z=j.left,V=j.top,I=j.width,A=j.height,k=hn(R,c,r),O=$e(k,[z,V]),L=[w+O[0]*T/I,S+O[1]*C/A],B=[0,0],M=0;++M<10;){var Q=ts(i,r);a=J($e(hn(Q,L,r),hn(Q,k,r)),2),B[0]=a[0],B[1]=a[1];var X=iv(r,i,kc(B,r),u),$=xk(X,h,p,r),H=$.left,Z=$.top,re=H-w,de=Z-S;if(_e(re)<2&&_e(de)<2)break;L[0]-=re,L[1]-=de}return B.map(function(U){return Math.round(U)})}function sJ(n,e,t){var r=n.length===16,i=r?4:3,a=e.map(function(u){return hn(n,u,i)}),o=t.left,c=t.top;return a.map(function(u){return[u[0]+o,u[1]+c]})}function Wi(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function PV(n,e){return Wi([e[0]-n[0],e[1]-n[1]])}function ph(n,e,t,r){t===void 0&&(t=1),r===void 0&&(r=Vn(n,e));var i=PV(n,e);return{transform:"translateY(-50%) translate(".concat(n[0],"px, ").concat(n[1],"px) rotate(").concat(r,"rad) scaleY(").concat(t,")"),width:"".concat(i,"px")}}function dv(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=t.length,a=t.reduce(function(c,u){return c+u[0]},0)/i,o=t.reduce(function(c,u){return c+u[1]},0)/i;return{transform:"translateZ(0px) translate(".concat(a,"px, ").concat(o,"px) rotate(").concat(n,"rad) scale(").concat(e,")")}}function Mc(n,e){var t=n[e];return ya(t)?W(W({},n),t):n}function OV(n){var e=n&&!Qv(n.offsetWidth),t=0,r=0,i=0,a=0,o=0,c=0,u=0,d=0,h=0,p=0,m=0,b=0,_=1/0,w=1/0,S=1/0,T=1/0,C=0,R=0,j=!1;if(n)if(!e&&n.ownerSVGElement){var z=n.getBBox();j=!0,t=z.width,r=z.height,o=t,c=r,u=t,d=r,i=t,a=r}else{var V=si(n),I=n.style,A=V("boxSizing")==="border-box",k=parseFloat(V("borderLeftWidth"))||0,O=parseFloat(V("borderRightWidth"))||0,L=parseFloat(V("borderTopWidth"))||0,B=parseFloat(V("borderBottomWidth"))||0,M=parseFloat(V("paddingLeft"))||0,Q=parseFloat(V("paddingRight"))||0,X=parseFloat(V("paddingTop"))||0,$=parseFloat(V("paddingBottom"))||0,H=M+Q,Z=X+$,re=k+O,de=L+B,U=H+re,Y=Z+de,ne=V("position"),ie=0,te=0;if("clientLeft"in n){var se=null;if(ne==="absolute"){var me=fp(n,yl(n));se=me.offsetParent}else se=n.parentElement;if(se){var Te=si(se);ie=parseFloat(Te("width")),te=parseFloat(Te("height"))}}h=Math.max(H,Xt(V("minWidth"),ie)||0),p=Math.max(Z,Xt(V("minHeight"),te)||0),_=Xt(V("maxWidth"),ie),w=Xt(V("maxHeight"),te),isNaN(_)&&(_=1/0),isNaN(w)&&(w=1/0),C=Xt(I.width,0)||0,R=Xt(I.height,0)||0,o=parseFloat(V("width"))||0,c=parseFloat(V("height"))||0,u=_e(o-C)<1?x_(h,C||o,_):o,d=_e(c-R)<1?x_(p,R||c,w):c,t=u,r=d,i=u,a=d,A?(S=_,T=w,m=h,b=p,u=t-U,d=r-Y):(S=_+U,T=w+Y,m=h+U,b=p+Y,t=u+U,r=d+Y),i=u+H,a=d+Z}return{svg:j,offsetWidth:t,offsetHeight:r,clientWidth:i,clientHeight:a,contentWidth:u,contentHeight:d,inlineCSSWidth:C,inlineCSSHeight:R,cssWidth:o,cssHeight:c,minWidth:h,minHeight:p,maxWidth:_,maxHeight:w,minOffsetWidth:m,minOffsetHeight:b,maxOffsetWidth:S,maxOffsetHeight:T}}function VV(n,e){return Vn(e>0?n[0]:n[1],e>0?n[1]:n[0])}function Hm(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function jV(n,e){var t=n===yl(n)||n===JE(n),r={clientLeft:n.clientLeft,clientTop:n.clientTop,clientWidth:n.clientWidth,clientHeight:n.clientHeight,scrollWidth:n.scrollWidth,scrollHeight:n.scrollHeight,overflow:!1};return t&&(r.clientHeight=Math.max(e.height,r.clientHeight),r.scrollHeight=Math.max(e.height,r.scrollHeight)),r.overflow=si(n)("overflow")!=="visible",W(W({},e),r)}function ix(n,e,t,r){var i=n.left,a=n.right,o=n.top,c=n.bottom,u=e.top,d=e.left,h={left:d+i,top:u+o,right:d+a,bottom:u+c,width:a-i,height:c-o};return t&&r?jV(t,h):h}function Ph(n,e){var t=0,r=0,i=0,a=0;if(n){var o=n.getBoundingClientRect();t=o.left,r=o.top,i=o.width,a=o.height}var c={left:t,top:r,width:i,height:a,right:t+i,bottom:r+a};return n&&e?jV(n,c):c}function oJ(n){var e=n.props,t=e.groupable,r=e.svgOrigin,i=n.getState(),a=i.offsetWidth,o=i.offsetHeight,c=i.svg,u=i.transformOrigin;return!t&&c&&r?AS(r,a,o):u}function zV(n,e,t,r){var i;if(n)i=n;else if(e)i=[0,0];else{var a=t.target;i=LV(a,r)}return i}function LV(n,e){if(n){var t=n.getAttribute("data-rotation")||"",r=n.getAttribute("data-direction");if(e.deg=t,!!r){var i=[0,0];return r.indexOf("w")>-1&&(i[0]=-1),r.indexOf("e")>-1&&(i[0]=1),r.indexOf("n")>-1&&(i[1]=-1),r.indexOf("s")>-1&&(i[1]=1),i}}}function _S(n,e){return[Nt(e,n[0]),Nt(e,n[1]),Nt(e,n[2]),Nt(e,n[3])]}function Qi(n){var e=n.left,t=n.top,r=n.pos1,i=n.pos2,a=n.pos3,o=n.pos4;return _S([r,i,a,o],[e,t])}function F_(n,e){n[e?"controlAbles":"targetAbles"].forEach(function(t){t.unset&&t.unset(n)})}function Xu(n,e){var t=e?"controlGesto":"targetGesto",r=n[t];r?.isIdle()===!1&&F_(n,e),r?.unset(),n[t]=null}function qr(n,e){if(e){var t=Kd(e);t.nextStyle=W(W({},t.nextStyle),n)}return{style:n,cssText:$s(n).map(function(r){return"".concat(b0(r,"-"),": ").concat(n[r],";")}).join("")}}function BV(n,e,t){var r=e.afterTransform||e.transform;return W(W({},qr(W(W(W({},n.style),e.style),{transform:r}),t)),{afterTransform:r,transform:n.transform})}function mt(n,e,t,r){var i=e.datas;i.datas||(i.datas={});var a=W(W({},t),{target:n.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:n,moveable:n,datas:i.datas,isRequest:e.isRequest,isRequestChild:e.isRequestChild,isFirstDrag:!!e.isFirstDrag,isTrusted:e.isTrusted!==!1,stopAble:function(){i.isEventStart=!1},stopDrag:function(){var o;(o=e.stop)===null||o===void 0||o.call(e)}});return i.isStartEvent?r||(i.lastEvent=a):i.isStartEvent=!0,a}function Ei(n,e,t){var r=e.datas,i="isDrag"in t?t.isDrag:e.isDrag;return r.datas||(r.datas={}),W(W({isDrag:i},t),{moveable:n,target:n.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:n,lastEvent:r.lastEvent,isDouble:e.isDouble,datas:r.datas,isFirstDrag:!!e.isFirstDrag})}function cy(n,e,t){n._emitter.on(e,t)}function Pe(n,e,t,r,i){return n.triggerEvent(e,t,r,i)}function wS(n,e){return nl(n).getComputedStyle(n,e)}function $m(n,e,t){var r={},i={};return n.filter(function(a){var o=a.name;if(r[o]||!e.some(function(c){return a[c]}))return!1;if(!t&&a.ableGroup){if(i[a.ableGroup])return!1;i[a.ableGroup]=!0}return r[o]=!0,!0})}function G_(n,e){return n===e||n==null&&e==null}function _k(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(var t=n.length-1,r=0;r<t;++r){var i=n[r];if(!Qv(i))return i}return n[t]}function UV(n,e){var t=[],r=[];return n.forEach(function(i,a){var o=e(i,a,n),c=r.indexOf(o),u=t[c]||[];c===-1&&(r.push(o),t.push(u)),u.push(i)}),t}function lJ(n,e){var t=[],r={};return n.forEach(function(i,a){var o=e(i,a,n),c=r[o];c||(c=[],r[o]=c,t.push(c)),c.push(i)}),t}function FV(n){return n.reduce(function(e,t){return e.concat(t)},[])}function Id(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return n.sort(function(t,r){return _e(r)-_e(t)}),n[0]}function Rd(n,e,t){return Or(ts(n,t),Dc(e,t),t)}function cJ(n,e){var t,r=n.is3d,i=n.rootMatrix,a=r?4:3;return t=J(Rd(i,[e.distX,e.distY],a),2),e.distX=t[0],e.distY=t[1],e}function zi(n,e,t,r){if(!t[0]&&!t[1])return e;var i=hn(n,[vk(t[0]||1),0],r),a=hn(n,[0,vk(t[1]||1)],r),o=hn(n,[t[0]/Wi(i),t[1]/Wi(a)],r);return Nt(e,o)}function da(n,e,t){return t?"".concat(n/e*100,"%"):"".concat(n,"px")}function fv(n){return _e(n)<=$r?0:n}function ES(n){return function(e){if(!e.isDragging(n))return"";var t=ZQ(e,n),r=t.deg;return r?Ge("view-control-rotation".concat(r)):""}}function SS(n,e){return e===void 0&&(e=[n]),function(t,r){if(r.isRequest)return e.some(function(a){return r.requestAble===a})?r.parentDirection:!1;var i=r.inputEvent.target;return ir(i,Ge("direction"))&&(!n||ir(i,Ge(n)))}}function uJ(n,e,t){var r,i=Td(n,{"x%":function(z){return z/100*e.offsetWidth},"y%":function(z){return z/100*e.offsetHeight}}),a=n.slice(0,t<0?void 0:t),o=n.slice(0,t<0?void 0:t+1),c=n[t]||"",u=t<0?[]:n.slice(t),d=t<0?[]:n.slice(t+1),h=i.slice(0,t<0?void 0:t),p=i.slice(0,t<0?void 0:t+1),m=(r=i[t])!==null&&r!==void 0?r:Td([""])[0],b=t<0?[]:i.slice(t),_=t<0?[]:i.slice(t+1),w=m?[m]:[],S=Lu(h),T=Lu(p),C=Lu(b),R=Lu(_),j=Wt(S,C,4);return{transforms:n,beforeFunctionMatrix:S,beforeFunctionMatrix2:T,targetFunctionMatrix:Lu(w),afterFunctionMatrix:C,afterFunctionMatrix2:R,allFunctionMatrix:j,beforeFunctions:h,beforeFunctions2:p,targetFunction:w[0],afterFunctions:b,afterFunctions2:_,beforeFunctionTexts:a,beforeFunctionTexts2:o,targetFunctionText:c,afterFunctionTexts:u,afterFunctionTexts2:d}}function dJ(n){return!n||!ya(n)||$d(n)?!1:Wn(n)||"length"in n}function Ja(n,e){return n?$d(n)?n:ii(n)?e?document.querySelector(n):n:WE(n)?n():_3(n)?n:"current"in n?n.current:n:null}function TS(n,e){if(!n)return[];var t=dJ(n)?[].slice.call(n):[n];return t.reduce(function(r,i){return ii(i)&&e?Ae(Ae([],J(r),!1),J([].slice.call(document.querySelectorAll(i))),!1):(Wn(i)?r.push(TS(i,e)):r.push(Ja(i,e)),r)},[])}function fJ(n,e,t){var r=Vn(n,e)/Math.PI*180;return r=t>=0?r:180-r,r=r>=0?r:360+r,r}function wk(n,e){var t=n.rootMatrix,r=n.is3d,i=r?4:3,a=ts(t,i);return r||(a=ba(a,3,4)),a[12]=0,a[13]=0,a[14]=0,XW(a,e)}function GV(n,e,t,r,i){var a=J(n,2),o=a[0],c=a[1],u=0,d=0;if(i&&o&&c){var h=Vn([0,0],e),p=Vn([0,0],r),m=Wi(e),b=Math.cos(h-p)*m;if(!r[0])d=b,u=d*t;else if(!r[1])u=b,d=u/t;else{var _=r[0]*o,w=r[1]*c,S=Math.atan2(_+e[0],w+e[1]),T=Math.atan2(_,w);S<0&&(S+=Math.PI*2),T<0&&(T+=Math.PI*2);var C=0;_e(S-T)<Math.PI/2||_e(S-T)>Math.PI/2*3||(T+=Math.PI),C=S-T,C>Math.PI*2?C-=Math.PI*2:C>Math.PI?C=2*Math.PI-C:C<-Math.PI&&(C=-2*Math.PI-C);var R=Wi([_+e[0],w+e[1]])*Math.cos(C);u=R*Math.sin(T)-_,d=R*Math.cos(T)-w,r[0]<0&&(u*=-1),r[1]<0&&(d*=-1)}}else u=r[0]*e[0],d=r[1]*e[1];return[u,d]}function qV(n,e,t,r){var i,a=t.ratio,o=t.startOffsetWidth,c=t.startOffsetHeight,u=0,d=0,h=r.distX,p=r.distY,m=r.pinchScale,b=r.parentDistance,_=r.parentDist,w=r.parentScale,S=t.fixedDirection,T=[0,1].map(function(I){return _e(n[I]-S[I])}),C=[0,1].map(function(I){var A=T[I];return A!==0&&(A=2/A),A});if(_)u=_[0],d=_[1],e&&(u?d||(d=u/a):u=d*a);else if(Sd(m))u=(m-1)*o,d=(m-1)*c;else if(w)u=(w[0]-1)*o,d=(w[1]-1)*c;else if(b){var R=o*T[0],j=c*T[1],z=Wi([R,j]);u=b/z*R*C[0],d=b/z*j*C[1]}else{var V=os({datas:t,distX:h,distY:p});V=C.map(function(I,A){return V[A]*I}),i=J(GV([o,c],V,a,n,e),2),u=i[0],d=i[1]}return{distWidth:u,distHeight:d}}function q_(n,e){if(e){if(n==="left")return{x:"0%",y:"50%"};if(n==="top")return{x:"50%",y:"50%"};if(n==="center")return{x:"50%",y:"50%"};if(n==="right")return{x:"100%",y:"50%"};if(n==="bottom")return{x:"50%",y:"100%"};var t=J(n.split(" "),2),r=t[0],i=t[1],a=q_(r||""),o=q_(i||""),c=W(W({},a),o),u={x:"50%",y:"50%"};return c.x&&(u.x=c.x),c.y&&(u.y=c.y),c.value&&(c.x&&!c.y&&(u.y=c.value),!c.x&&c.y&&(u.x=c.value)),u}return n==="left"?{x:"0%"}:n==="right"?{x:"100%"}:n==="top"?{y:"0%"}:n==="bottom"?{y:"100%"}:n?n==="center"?{value:"50%"}:{value:n}:{}}function AS(n,e,t){var r=q_(n,!0),i=r.x,a=r.y;return[Xt(i,e)||0,Xt(a,t)||0]}function hJ(n,e,t){var r=n.map(function(a){return $e(a,e)}),i=r.map(function(a){return Yp(a,t)});return{prev:r,next:i,result:i.map(function(a){return Nt(a,e)})}}function HV(n,e){return n.length===e.length&&n.every(function(t,r){var i=e[r],a=Wn(t),o=Wn(i);return a&&o?HV(t,i):!a&&!o?t===i:!1})}function Wu(n,e,t,r,i){var a=n._store,o=a[e];if(!(e in a))if(i!=null)a[e]=i,o=i;else return a[e]=t,t;return o===t||r(o)===r(t)?o:(a[e]=t,t)}function Ur(n){return n>=0?1:-1}function _e(n){return Math.abs(n)}function ax(n,e){return lW(n).map(function(t){return e(t)})}function $V(n){return Sd(n)?{top:n,left:n,right:n,bottom:n}:{left:n.left||0,top:n.top||0,right:n.right||0,bottom:n.bottom||0}}var pJ=Wp("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(n,e){var t=e.datas,r=e.targets,i=e.angle,a=e.originalDatas,o=n.props,c=o.pinchable,u=o.ables;if(!c)return!1;var d="onPinch".concat(r?"Group":"","Start"),h="drag".concat(r?"Group":"","ControlStart"),p=(c===!0?n.controlAbles:u.filter(function(w){return c.indexOf(w.name)>-1})).filter(function(w){return w.canPinch&&w[h]}),m=mt(n,e,{});r&&(m.targets=r);var b=Pe(n,d,m);t.isPinch=b!==!1,t.ables=p;var _=t.isPinch;return _?(p.forEach(function(w){if(a[w.name]=a[w.name]||{},!!w[h]){var S=W(W({},e),{datas:a[w.name],parentRotate:i,isPinch:!0});w[h](n,S)}}),n.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},_):!1},pinch:function(n,e){var t=e.datas,r=e.scale,i=e.distance,a=e.originalDatas,o=e.inputEvent,c=e.targets,u=e.angle;if(t.isPinch){var d=i*(1-1/r),h=mt(n,e,{});c&&(h.targets=c);var p="onPinch".concat(c?"Group":"");Pe(n,p,h);var m=t.ables,b="drag".concat(c?"Group":"","Control");return m.forEach(function(_){_[b]&&_[b](n,W(W({},e),{datas:a[_.name],inputEvent:o,resolveMatrix:!0,pinchScale:r,parentDistance:d,parentRotate:u,isPinch:!0}))}),h}},pinchEnd:function(n,e){var t=e.datas,r=e.isPinch,i=e.inputEvent,a=e.targets,o=e.originalDatas;if(t.isPinch){var c="onPinch".concat(a?"Group":"","End"),u=Ei(n,e,{isDrag:r});a&&(u.targets=a),Pe(n,c,u);var d=t.ables,h="drag".concat(a?"Group":"","ControlEnd");return d.forEach(function(p){p[h]&&p[h](n,W(W({},e),{isDrag:r,datas:o[p.name],inputEvent:i,isPinch:!0}))}),r}},pinchGroupStart:function(n,e){return this.pinchStart(n,W(W({},e),{targets:n.props.targets}))},pinchGroup:function(n,e){return this.pinch(n,W(W({},e),{targets:n.props.targets}))},pinchGroupEnd:function(n,e){return this.pinchEnd(n,W(W({},e),{targets:n.props.targets}))}}),Ek=SS("scalable"),gJ={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:fV("scalable"),dragControlCondition:Ek,viewClassName:ES("scalable"),dragControlStart:function(n,e){var t=e.datas,r=e.isPinch,i=e.inputEvent,a=e.parentDirection,o=zV(a,r,i,t),c=n.state,u=c.width,d=c.height,h=c.targetTransform,p=c.target,m=c.pos1,b=c.pos2,_=c.pos4;if(!o||!p)return!1;r||Lc(n,e),t.datas={},t.transform=h,t.prevDist=[1,1],t.direction=o,t.startOffsetWidth=u,t.startOffsetHeight=d,t.startValue=[1,1];var w=!o[0]&&!o[1]||o[0]||!o[1];iy(n,e,"scale"),t.isWidth=w;function S(V){t.ratio=V&&isFinite(V)?V:0}t.startPositions=Qi(n.state);function T(V){var I=SV(t.startPositions,V);t.fixedDirection=I.fixedDirection,t.fixedPosition=I.fixedPosition,t.fixedOffset=I.fixedOffset}t.setFixedDirection=T,S(Os(m,b)/Os(b,_)),T([-o[0],-o[1]]);var C=function(V){t.minScaleSize=V},R=function(V){t.maxScaleSize=V};C([-1/0,-1/0]),R([1/0,1/0]);var j=mt(n,e,W(W({direction:o,set:function(V){t.startValue=V},setRatio:S,setFixedDirection:T,setMinScaleSize:C,setMaxScaleSize:R},ry(n,e)),{dragStart:Br.dragStart(n,new Ad().dragStart([0,0],e))})),z=Pe(n,"onScaleStart",j);return t.startFixedDirection=t.fixedDirection,z!==!1&&(t.isScale=!0,n.state.snapRenderInfo={request:e.isRequest,direction:o}),t.isScale?j:!1},dragControl:function(n,e){ty(n,e,"scale");var t=e.datas,r=e.parentKeepRatio,i=e.parentFlag,a=e.isPinch,o=e.dragClient,c=e.isRequest,u=e.useSnap,d=e.resolveMatrix,h=t.prevDist,p=t.direction,m=t.startOffsetWidth,b=t.startOffsetHeight,_=t.isScale,w=t.startValue,S=t.isWidth,T=t.ratio;if(!_)return!1;var C=n.props,R=C.throttleScale,j=C.parentMoveable,z=p;!p[0]&&!p[1]&&(z=[1,1]);var V=T&&(r??C.keepRatio)||!1,I=n.state,A=[w[0],w[1]];function k(){var xe=qV(z,V,t,e),Ee=xe.distWidth,Qe=xe.distHeight,Oe=m?(m+Ee)/m:1,Be=b?(b+Qe)/b:1;w[0]||(A[0]=Ee/m),w[1]||(A[1]=Qe/b);var ze=(z[0]||V?Oe:1)*A[0],st=(z[1]||V?Be:1)*A[1];return ze===0&&(ze=Ur(h[0])*Um),st===0&&(st=Ur(h[1])*Um),[ze,st]}var O=k();if(!a&&n.props.groupable){var L=I.snapRenderInfo||{},B=L.direction;Wn(B)&&(B[0]||B[1])&&(I.snapRenderInfo={direction:p,request:e.isRequest})}Pe(n,"onBeforeScale",mt(n,e,{scale:O,setFixedDirection:function(xe){return t.setFixedDirection(xe),O=k(),O},startFixedDirection:t.startFixedDirection,setScale:function(xe){O=xe}},!0));var M=[O[0]/A[0],O[1]/A[1]],Q=o,X=[0,0],$=Ur(M[0]*M[1]),H=!o&&!i&&a;if(H||d?Q=hS(n,t.targetAllTransform,[0,0],[0,0],t):o||(Q=t.fixedPosition),a||(X=$Z(n,M,p,!u&&c,t)),V){z[0]&&z[1]&&X[0]&&X[1]&&(Math.abs(X[0]*m)>Math.abs(X[1]*b)?X[1]=0:X[0]=0);var Z=!X[0]&&!X[1];if(Z&&(S?M[0]=ct(M[0]*A[0],R)/A[0]:M[1]=ct(M[1]*A[1],R)/A[1]),z[0]&&!z[1]||X[0]&&!X[1]||Z&&S){M[0]+=X[0];var re=m*M[0]*A[0]/T;M[1]=Ur($*M[0])*_e(re/b/A[1])}else if(!z[0]&&z[1]||!X[0]&&X[1]||Z&&!S){M[1]+=X[1];var de=b*M[1]*A[1]*T;M[0]=Ur($*M[1])*_e(de/m/A[0])}}else M[0]+=X[0],M[1]+=X[1],X[0]||(M[0]=ct(M[0]*A[0],R)/A[0]),X[1]||(M[1]=ct(M[1]*A[1],R)/A[1]);M[0]===0&&(M[0]=Ur(h[0])*Um),M[1]===0&&(M[1]=Ur(h[1])*Um),O=WZ(M,[A[0],A[1]]);var U=[m,b],Y=[m*O[0],b*O[1]];Y=m3(Y,t.minScaleSize,t.maxScaleSize,V?T:!1),O=ax(2,function(xe){return U[xe]?Y[xe]/U[xe]:Y[xe]}),M=ax(2,function(xe){return O[xe]/A[xe]});var ne=ax(2,function(xe){return h[xe]?M[xe]/h[xe]:M[xe]}),ie="scale(".concat(M.join(", "),")"),te="scale(".concat(O.join(", "),")"),se=ny(t,te,ie),me=!w[0]||!w[1],Te=$Q(n,me?te:ie,t.fixedDirection,Q,t.fixedOffset,t,me),Ce=H?Te:$e(Te,t.prevInverseDist||[0,0]);if(t.prevDist=M,t.prevInverseDist=Te,O[0]===h[0]&&O[1]===h[1]&&Ce.every(function(xe){return!xe})&&!j&&!H)return!1;var Ne=mt(n,e,W({offsetWidth:m,offsetHeight:b,direction:p,scale:O,dist:M,delta:ne,isPinch:!!a},sV(n,se,Ce,a,e)));return Pe(n,"onScale",Ne),Ne},dragControlEnd:function(n,e){var t=e.datas;if(!t.isScale)return!1;t.isScale=!1;var r=Ei(n,e,{});return Pe(n,"onScaleEnd",r),r},dragGroupControlCondition:Ek,dragGroupControlStart:function(n,e){var t=e.datas,r=this.dragControlStart(n,e);if(!r)return!1;var i=pa(n,"resizable",e);t.moveableScale=n.scale;var a=Vs(n,this,"dragControlStart",e,function(d,h){return ov(n,d,t,h)}),o=function(d){r.setFixedDirection(d),a.forEach(function(h,p){h.setFixedDirection(d),ov(n,h.moveable,t,i[p])})};t.setFixedDirection=o;var c=W(W({},r),{targets:n.props.targets,events:a,setFixedDirection:o}),u=Pe(n,"onScaleGroupStart",c);return t.isScale=u!==!1,t.isScale?c:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isScale){cy(n,"onBeforeScale",function(h){Pe(n,"onBeforeScaleGroup",mt(n,e,W(W({},h),{targets:n.props.targets}),!0))});var r=this.dragControl(n,e);if(r){var i=r.dist,a=t.moveableScale;n.scale=[i[0]*a[0],i[1]*a[1]];var o=n.props.keepRatio,c=t.fixedPosition,u=Vs(n,this,"dragControl",e,function(h,p){var m=J(Or(Kp(n.rotation/180*Math.PI,3),[p.datas.originalX*i[0],p.datas.originalY*i[1],1],3),2),b=m[0],_=m[1];return W(W({},p),{parentDist:null,parentScale:i,parentKeepRatio:o,dragClient:Nt(c,[b,_])})}),d=W({targets:n.props.targets,events:u},r);return Pe(n,"onScaleGroup",d),d}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isScale){this.dragControlEnd(n,e);var i=Vs(n,this,"dragControlEnd",e),a=Ei(n,e,{targets:n.props.targets,events:i});return Pe(n,"onScaleGroupEnd",a),t}},request:function(){var n={},e=0,t=0,r=!1;return{isControl:!0,requestStart:function(i){return r=i.useSnap,{datas:n,parentDirection:i.direction||[1,1],useSnap:r}},request:function(i){return e+=i.deltaWidth,t+=i.deltaHeight,{datas:n,parentDist:[e,t],parentKeepRatio:i.keepRatio,useSnap:r}},requestEnd:function(){return{datas:n,isDrag:!0,useSnap:r}}}}};function jo(n,e){return n.map(function(t,r){return nv(t,e[r],1,2)})}function Sk(n,e,t){var r=Vn(n,e),i=Vn(n,t),a=i-r;return a>=0?a:a+2*Math.PI}function mJ(n,e){var t=Sk(n[0],n[1],n[2]),r=Sk(e[0],e[1],e[2]),i=Math.PI;return!(t>=i&&r<=i||t<=i&&r>=i)}var vJ={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:ES("warpable"),render:function(n,e){var t=n.props,r=t.resizable,i=t.scalable,a=t.warpable,o=t.zoom;if(r||i||!a)return[];var c=n.state,u=c.pos1,d=c.pos2,h=c.pos3,p=c.pos4,m=jo(u,d),b=jo(d,u),_=jo(u,h),w=jo(h,u),S=jo(h,p),T=jo(p,h),C=jo(d,p),R=jo(p,d);return Ae([e.createElement("div",{className:Ge("line"),key:"middeLine1",style:ph(m,S,o)}),e.createElement("div",{className:Ge("line"),key:"middeLine2",style:ph(b,T,o)}),e.createElement("div",{className:Ge("line"),key:"middeLine3",style:ph(_,C,o)}),e.createElement("div",{className:Ge("line"),key:"middeLine4",style:ph(w,R,o)})],J(hV(n,"warpable",e)),!1)},dragControlCondition:function(n,e){if(e.isRequest)return!1;var t=e.inputEvent.target;return ir(t,Ge("direction"))&&ir(t,Ge("warpable"))},dragControlStart:function(n,e){var t=e.datas,r=e.inputEvent,i=n.props.target,a=r.target,o=LV(a,t);if(!o||!i)return!1;var c=n.state,u=c.transformOrigin,d=c.is3d,h=c.targetTransform,p=c.targetMatrix,m=c.width,b=c.height,_=c.left,w=c.top;t.datas={},t.targetTransform=h,t.warpTargetMatrix=d?p:ba(p,3,4),t.targetInverseMatrix=U3(ts(t.warpTargetMatrix,4),3,4),t.direction=o,t.left=_,t.top=w,t.poses=[[0,0],[m,0],[0,b],[m,b]].map(function(C){return $e(C,u)}),t.nextPoses=t.poses.map(function(C){var R=J(C,2),j=R[0],z=R[1];return Or(t.warpTargetMatrix,[j,z,0,1],4)}),t.startValue=rn(4),t.prevMatrix=rn(4),t.absolutePoses=Qi(c),t.posIndexes=aV(o),Lc(n,e),iy(n,e,"matrix3d"),c.snapRenderInfo={request:e.isRequest,direction:o};var S=mt(n,e,W({set:function(C){t.startValue=C}},ry(n,e))),T=Pe(n,"onWarpStart",S);return T!==!1&&(t.isWarp=!0),t.isWarp},dragControl:function(n,e){var t=e.datas,r=e.isRequest,i=e.distX,a=e.distY,o=t.targetInverseMatrix,c=t.prevMatrix,u=t.isWarp,d=t.startValue,h=t.poses,p=t.posIndexes,m=t.absolutePoses;if(!u)return!1;if(ty(n,e,"matrix3d"),Xd(n,"warpable")){var b=p.map(function(k){return m[k]});b.length>1&&b.push([(b[0][0]+b[1][0])/2,(b[0][1]+b[1][1])/2]);var _=oy(n,r,{horizontal:b.map(function(k){return k[1]+a}),vertical:b.map(function(k){return k[0]+i})}),w=_.horizontal,S=_.vertical;a-=w.offset,i-=S.offset}var T=os({datas:t,distX:i,distY:a},!0),C=t.nextPoses.slice();if(p.forEach(function(k){C[k]=Nt(C[k],T)}),!VQ.every(function(k){return mJ(k.map(function(O){return h[O]}),k.map(function(O){return C[O]}))}))return!1;var R=oS(h[0],h[2],h[1],h[3],C[0],C[2],C[1],C[3]);if(!R.length)return!1;var j=Wt(o,R,4),z=rV(t,j,!0),V=Wt(ts(c,4),z,4);t.prevMatrix=z;var I=Wt(d,z,4),A=ny(t,"matrix3d(".concat(I.join(", "),")"),"matrix3d(".concat(z.join(", "),")"));return fS(e,A),Pe(n,"onWarp",mt(n,e,W({delta:V,matrix:I,dist:z,multiply:Wt,transform:A},qr({transform:A},e)))),!0},dragControlEnd:function(n,e){var t=e.datas,r=e.isDrag;return t.isWarp?(t.isWarp=!1,Pe(n,"onWarpEnd",Ei(n,e,{})),r):!1}},yJ=Ge("area-pieces"),Ym=Ge("area-piece"),YV=Ge("avoid"),bJ=Ge("view-dragging");function sx(n){var e=n.areaElement;if(e){var t=n.state,r=t.width,i=t.height;x3(e,YV),e.style.cssText+="left: 0px; top: 0px; width: ".concat(r,"px; height: ").concat(i,"px")}}function Tk(n){return n.createElement("div",{key:"area_pieces",className:yJ},n.createElement("div",{className:Ym}),n.createElement("div",{className:Ym}),n.createElement("div",{className:Ym}),n.createElement("div",{className:Ym}))}var KV={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(n,e){var t=n.props,r=t.target,i=t.dragArea,a=t.groupable,o=t.passDragArea,c=n.getState(),u=c.width,d=c.height,h=c.renderPoses,p=o?Ge("area","pass"):Ge("area");if(a)return[e.createElement("div",{key:"area",ref:Ps(n,"areaElement"),className:p}),Tk(e)];if(!r||!i)return[];var m=oS([0,0],[u,0],[0,d],[u,d],h[0],h[1],h[2],h[3]),b=m.length?ly(m,!0):"none";return[e.createElement("div",{key:"area",ref:Ps(n,"areaElement"),className:p,style:{top:"0px",left:"0px",width:"".concat(u,"px"),height:"".concat(d,"px"),transformOrigin:"0 0",transform:b}}),Tk(e)]},dragStart:function(n,e){var t=e.datas,r=e.clientX,i=e.clientY,a=e.inputEvent;if(!a)return!1;t.isDragArea=!1;var o=n.areaElement,c=n.state,u=c.moveableClientRect,d=c.renderPoses,h=c.rootMatrix,p=c.is3d,m=u.left,b=u.top,_=Xi(d),w=_.left,S=_.top,T=_.width,C=_.height,R=p?4:3,j=J(Rd(h,[r-m,i-b],R),2),z=j[0],V=j[1];z-=w,V-=S;var I=[{left:w,top:S,width:T,height:V-10},{left:w,top:S,width:z-10,height:C},{left:w,top:S+V+10,width:T,height:C-V-10},{left:w+z+10,top:S,width:T-z-10,height:C}],A=[].slice.call(o.nextElementSibling.children);I.forEach(function(k,O){A[O].style.cssText="left: ".concat(k.left,"px;top: ").concat(k.top,"px; width: ").concat(k.width,"px; height: ").concat(k.height,"px;")}),b3(o,YV),c.disableNativeEvent=!0},drag:function(n,e){var t=e.datas,r=e.inputEvent;if(this.enableNativeEvent(n),!r)return!1;t.isDragArea||(t.isDragArea=!0,sx(n))},dragEnd:function(n,e){this.enableNativeEvent(n);var t=e.inputEvent,r=e.datas;if(!t)return!1;r.isDragArea||sx(n)},dragGroupStart:function(n,e){return this.dragStart(n,e)},dragGroup:function(n,e){return this.drag(n,e)},dragGroupEnd:function(n,e){return this.dragEnd(n,e)},unset:function(n){sx(n),n.state.disableNativeEvent=!1},enableNativeEvent:function(n){var e=n.state;e.disableNativeEvent&&g3(function(){e.disableNativeEvent=!1})}},xJ=Wp("origin",{props:["origin","svgOrigin"],render:function(n,e){var t=n.props,r=t.zoom,i=t.svgOrigin,a=t.groupable,o=n.getState(),c=o.beforeOrigin,u=o.rotation,d=o.svg,h=o.allMatrix,p=o.is3d,m=o.left,b=o.top,_=o.offsetWidth,w=o.offsetHeight,S;if(!a&&d&&i){var T=J(AS(i,_,w),2),C=T[0],R=T[1],j=p?4:3,z=hn(h,[C,R],j);S=dv(u,r,$e(z,[m,b]))}else S=dv(u,r,c);return[e.createElement("div",{className:Ge("control","origin"),style:S,key:"beforeOrigin"})]}});function _J(n){var e=n.scrollContainer;return[e.scrollLeft,e.scrollTop]}var wJ={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(n,e){var t=n.props,r=t.scrollContainer,i=r===void 0?n.getContainer():r,a=t.scrollOptions,o=new tQ,c=Ja(i,!0);e.datas.dragScroll=o,n.state.dragScroll=o;var u=e.isControl?"controlGesto":"targetGesto",d=e.targets;o.on("scroll",function(h){var p=h.container,m=h.direction,b=mt(n,e,{scrollContainer:p,direction:m}),_=d?"onScrollGroup":"onScroll";d&&(b.targets=d),Pe(n,_,b)}).on("move",function(h){var p=h.offsetX,m=h.offsetY,b=h.inputEvent;n[u].scrollBy(p,m,b.inputEvent,!1)}).on("scrollDrag",function(h){var p=h.next;p(n[u].getCurrentEvent())}),o.dragStart(e,W({container:c},a))},checkScroll:function(n,e){var t=e.datas.dragScroll;if(t){var r=n.props,i=r.scrollContainer,a=i===void 0?n.getContainer():i,o=r.scrollThreshold,c=o===void 0?0:o,u=r.scrollThrottleTime,d=u===void 0?0:u,h=r.getScrollPosition,p=h===void 0?_J:h,m=r.scrollOptions;return t.drag(e,W({container:a,threshold:c,throttleTime:d,getScrollPosition:function(b){return p({scrollContainer:b.container,direction:b.direction})}},m)),!0}},drag:function(n,e){return this.checkScroll(n,e)},dragEnd:function(n,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(n,e){return this.dragStart(n,W(W({},e),{isControl:!0}))},dragControl:function(n,e){return this.drag(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupStart:function(n,e){return this.dragStart(n,W(W({},e),{targets:n.props.targets}))},dragGroup:function(n,e){return this.drag(n,W(W({},e),{targets:n.props.targets}))},dragGroupEnd:function(n,e){return this.dragEnd(n,W(W({},e),{targets:n.props.targets}))},dragGroupControlStart:function(n,e){return this.dragStart(n,W(W({},e),{targets:n.props.targets,isControl:!0}))},dragGroupControl:function(n,e){return this.drag(n,W(W({},e),{targets:n.props.targets}))},dragGroupControEnd:function(n,e){return this.dragEnd(n,W(W({},e),{targets:n.props.targets}))},unset:function(n){var e,t=n.state;(e=t.dragScroll)===null||e===void 0||e.dragEnd(),t.dragScroll=null}},XV={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","preventRightClick","preventWheelClick","requestStyles"],events:["changeTargets"]},EJ=Wp("padding",{props:["padding"],render:function(n,e){var t=n.props;if(t.dragArea)return[];var r=$V(t.padding||{}),i=r.left,a=r.top,o=r.right,c=r.bottom,u=n.getState(),d=u.renderPoses,h=u.pos1,p=u.pos2,m=u.pos3,b=u.pos4,_=[h,p,m,b],w=[];return i>0&&w.push([0,2]),a>0&&w.push([0,1]),o>0&&w.push([1,3]),c>0&&w.push([2,3]),w.map(function(S,T){var C=J(S,2),R=C[0],j=C[1],z=_[R],V=_[j],I=d[R],A=d[j],k=oS([0,0],[100,0],[0,100],[100,100],z,V,I,A);if(k.length)return e.createElement("div",{key:"padding".concat(T),className:Ge("padding"),style:{transform:ly(k,!0)}})})}}),Ak=["nw","ne","se","sw"];function Km(n,e){var t=n[0]+n[1],r=t>e?e/t:1;return n[0]*=r,n[1]=e-n[1]*r,n}var SJ=[1,2,5,6],TJ=[0,3,4,7],rc=[1,-1,-1,1],ic=[1,1,-1,-1];function CS(n,e,t,r,i,a,o,c){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=t),c===void 0&&(c=r);var u=[],d=!1,h=n.filter(function(m){return!m.virtual}),p=h.map(function(m){var b=m.horizontal,_=m.vertical,w=m.pos;if(_&&!d&&(d=!0,u.push("/")),d){var S=Math.max(0,_===1?w[1]-a:c-w[1]);return u.push(da(S,r,e)),S}else{var S=Math.max(0,b===1?w[0]-i:o-w[0]);return u.push(da(S,t,e)),S}});return{radiusPoses:h,styles:u,raws:p}}function WV(n){for(var e=[0,0],t=[0,0],r=n.length,i=0;i<r;++i){var a=n[i];a.sub&&(a.horizontal&&(e[1]===0&&(e[0]=i),e[1]=i-e[0]+1,t[0]=i+1),a.vertical&&(t[1]===0&&(t[0]=i),t[1]=i-t[0]+1))}return{horizontalRange:e,verticalRange:t}}function QV(n,e,t,r,i,a,o){var c,u,d,h;a===void 0&&(a=[0,0]),o===void 0&&(o=!1);var p=n.indexOf("/"),m=(p>-1?n.slice(0,p):n).length,b=n.slice(0,m),_=n.slice(m+1),w=b.length,S=_.length,T=S>0,C=J(b,4),R=C[0],j=R===void 0?"0px":R,z=C[1],V=z===void 0?j:z,I=C[2],A=I===void 0?j:I,k=C[3],O=k===void 0?V:k,L=J(_,4),B=L[0],M=B===void 0?j:B,Q=L[1],X=Q===void 0?T?M:V:Q,$=L[2],H=$===void 0?T?M:A:$,Z=L[3],re=Z===void 0?T?X:O:Z,de=[j,V,A,O].map(function(se){return Xt(se,e)}),U=[M,X,H,re].map(function(se){return Xt(se,t)}),Y=de.slice(),ne=U.slice();c=J(Km([Y[0],Y[1]],e),2),Y[0]=c[0],Y[1]=c[1],u=J(Km([Y[3],Y[2]],e),2),Y[3]=u[0],Y[2]=u[1],d=J(Km([ne[0],ne[3]],t),2),ne[0]=d[0],ne[3]=d[1],h=J(Km([ne[1],ne[2]],t),2),ne[1]=h[0],ne[2]=h[1];var ie=o?Y:Y.slice(0,Math.max(a[0],w)),te=o?ne:ne.slice(0,Math.max(a[1],S));return Ae(Ae([],J(ie.map(function(se,me){var Te=Ak[me];return{virtual:me>=w,horizontal:rc[me],vertical:0,pos:[r+se,i+(ic[me]===-1?t:0)],sub:!0,raw:de[me],direction:Te}})),!1),J(te.map(function(se,me){var Te=Ak[me];return{virtual:me>=S,horizontal:0,vertical:ic[me],pos:[r+(rc[me]===-1?e:0),i+se],sub:!0,raw:U[me],direction:Te}})),!1)}function AJ(n,e,t,r,i){i===void 0&&(i=e.length);var a=WV(n.slice(r)),o=a.horizontalRange,c=a.verticalRange,u=t-r,d=0;if(u===0)d=i;else if(u>0&&u<o[1])d=o[1]-u;else if(u>=c[0])d=c[0]+c[1]-u;else return;n.splice(t,d),e.splice(t,d)}function CJ(n,e,t,r,i,a,o,c,u,d,h){d===void 0&&(d=0),h===void 0&&(h=0);var p=WV(n.slice(t)),m=p.horizontalRange,b=p.verticalRange;if(r>-1)for(var _=rc[r]===1?a-d:c-a,w=m[1];w<=r;++w){var S=ic[w]===1?h:u,T=0;if(r===w?T=a:w===0?T=d+_:rc[w]===-1&&(T=c-(e[t][0]-d)),n.splice(t+w,0,{horizontal:rc[w],vertical:0,pos:[T,S]}),e.splice(t+w,0,[T,S]),w===0)break}else if(i>-1){var C=ic[i]===1?o-h:u-o;if(m[1]===0&&b[1]===0){var R=[d+C,h];n.push({horizontal:rc[0],vertical:0,pos:R}),e.push(R)}for(var j=b[0],w=b[1];w<=i;++w){var T=rc[w]===1?d:c,S=0;if(i===w?S=o:w===0?S=h+C:ic[w]===1?S=e[t+j][1]:ic[w]===-1&&(S=u-(e[t+j][1]-h)),n.push({horizontal:0,vertical:ic[w],pos:[T,S]}),e.push([T,S]),w===0)break}}}function IJ(n,e){e===void 0&&(e=n.map(function(i){return i.raw}));var t=n.map(function(i,a){return i.horizontal?e[a]:null}).filter(function(i){return i!=null}),r=n.map(function(i,a){return i.vertical?e[a]:null}).filter(function(i){return i!=null});return{horizontals:t,verticals:r}}var RJ=[[0,-1,"n"],[1,0,"e"]],DJ=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function IS(n,e,t){var r=n.props.clipRelative,i=n.state,a=i.width,o=i.height,c=e,u=c.type,d=c.poses,h=u==="rect",p=u==="circle";if(u==="polygon")return t.map(function(V){return"".concat(da(V[0],a,r)," ").concat(da(V[1],o,r))});if(h||u==="inset"){var m=t[1][1],b=t[3][0],_=t[7][0],w=t[5][1];if(h)return[m,b,w,_].map(function(V){return"".concat(V,"px")});var S=[m,a-b,o-w,_].map(function(V,I){return da(V,I%2?a:o,r)});if(t.length>8){var T=J($e(t[4],t[0]),2),C=T[0],R=T[1];S.push.apply(S,Ae(["round"],J(CS(d.slice(8).map(function(V,I){return W(W({},V),{pos:t[I]})}),r,C,R,_,m,b,w).styles),!1))}return S}else if(p||u==="ellipse"){var j=t[0],z=da(_e(t[1][1]-j[1]),p?Math.sqrt((a*a+o*o)/2):o,r),S=p?[z]:[da(_e(t[2][0]-j[0]),a,r),z];return S.push("at",da(j[0],a,r),da(j[1],o,r)),S}}function hv(n,e,t,r){var i=[r,(r+e)/2,e],a=[n,(n+t)/2,t];return DJ.map(function(o){var c=J(o,3),u=c[0],d=c[1],h=c[2],p=i[u+1],m=a[d+1];return{vertical:_e(d),horizontal:_e(u),direction:h,pos:[p,m]}})}function ZV(n){var e=[1/0,-1/0],t=[1/0,-1/0];return n.forEach(function(r){var i=r.pos;e[0]=Math.min(e[0],i[0]),e[1]=Math.max(e[1],i[0]),t[0]=Math.min(t[0],i[1]),t[1]=Math.max(t[1],i[1])}),[_e(e[1]-e[0]),_e(t[1]-t[0])]}function Ck(n,e,t,r,i){var a,o,c,u,d,h,p,m,b;if(n){var _=i;if(!_){var w=si(n),S=w("clipPath");_=S!=="none"?S:w("clip")}if(!((!_||_==="none"||_==="auto")&&(_=r,!_))){var T=p3(_),C=T.prefix,R=C===void 0?_:C,j=T.value,z=j===void 0?"":j,V=R==="circle",I=" ";if(R==="polygon"){var A=cc(z||"0% 0%, 100% 0%, 100% 100%, 0% 100%");I=",";var k=A.map(function(Mt){var vn=J(Mt.split(" "),2),dn=vn[0],bt=vn[1];return{vertical:1,horizontal:1,pos:[Xt(dn,e),Xt(bt,t)]}}),O=Nc(k.map(function(Mt){return Mt.pos}));return{type:R,clipText:_,poses:k,splitter:I,left:O.minX,right:O.maxX,top:O.minY,bottom:O.maxY}}else if(V||R==="ellipse"){var L="",B="",M=0,Q=0,A=ul(z);if(V){var X="";a=J(A,4),o=a[0],X=o===void 0?"50%":o,c=a[2],L=c===void 0?"50%":c,u=a[3],B=u===void 0?"50%":u,M=Xt(X,Math.sqrt((e*e+t*t)/2)),Q=M}else{var $="",H="";d=J(A,5),h=d[0],$=h===void 0?"50%":h,p=d[1],H=p===void 0?"50%":p,m=d[3],L=m===void 0?"50%":m,b=d[4],B=b===void 0?"50%":b,M=Xt($,e),Q=Xt(H,t)}var Z=[Xt(L,e),Xt(B,t)],k=Ae([{vertical:1,horizontal:1,pos:Z,direction:"nesw"}],J(RJ.slice(0,V?1:2).map(function(dn){return{vertical:_e(dn[1]),horizontal:dn[0],direction:dn[2],sub:!0,pos:[Z[0]+dn[0]*M,Z[1]+dn[1]*Q]}})),!1);return{type:R,clipText:_,radiusX:M,radiusY:Q,left:Z[0]-M,top:Z[1]-Q,right:Z[0]+M,bottom:Z[1]+Q,poses:k,splitter:I}}else if(R==="inset"){var A=ul(z||"0 0 0 0"),re=A.indexOf("round"),de=(re>-1?A.slice(0,re):A).length,U=A.slice(de+1),Y=J(A.slice(0,de),4),ne=Y[0],ie=Y[1],te=ie===void 0?ne:ie,se=Y[2],me=se===void 0?ne:se,Te=Y[3],Ce=Te===void 0?te:Te,Ne=J([ne,me].map(function(dn){return Xt(dn,t)}),2),xe=Ne[0],Ee=Ne[1],Qe=J([Ce,te].map(function(dn){return Xt(dn,e)}),2),Oe=Qe[0],Be=Qe[1],ze=e-Be,st=t-Ee,yt=QV(U,ze-Oe,st-xe,Oe,xe),k=Ae(Ae([],J(hv(xe,ze,st,Oe)),!1),J(yt),!1);return{type:"inset",clipText:_,poses:k,top:xe,left:Oe,right:ze,bottom:st,radius:U,splitter:I}}else if(R==="rect"){var A=cc(z||"0px, ".concat(e,"px, ").concat(t,"px, 0px"));I=",";var Ve=J(A.map(function(Cr){var Qn=Gp(Cr).value;return Qn}),4),Ke=Ve[0],Be=Ve[1],Ee=Ve[2],Oe=Ve[3],k=hv(Ke,Be,Ee,Oe);return{type:"rect",clipText:_,poses:k,top:Ke,right:Be,bottom:Ee,left:Oe,values:A,splitter:I}}}}}function kJ(n,e,t,r,i){var a=n[e],o=a.direction,c=a.sub,u=n.map(function(){return[0,0]}),d=o?o.split(""):[];if(r&&e<8){var h=d.filter(function(M){return M==="w"||M==="e"}),p=d.filter(function(M){return M==="n"||M==="s"}),m=h[0],b=p[0];u[e]=t;var _=J(ZV(n),2),w=_[0],S=_[1],T=w&&S?w/S:0;if(T&&i){var C=(e+4)%8,R=n[C].pos,j=[0,0];o.indexOf("w")>-1?j[0]=-1:o.indexOf("e")>-1&&(j[0]=1),o.indexOf("n")>-1?j[1]=-1:o.indexOf("s")>-1&&(j[1]=1);var z=GV([w,S],t,T,j,!0),V=w+z[0],I=S+z[1],A=R[1],k=R[1],O=R[0],L=R[0];j[0]===-1?O=L-V:j[0]===1?L=O+V:(O=O-V/2,L=L+V/2),j[1]===-1?A=k-I:(j[1]===1||(A=k-I/2),k=A+I);var B=hv(A,L,k,O);n.forEach(function(M,Q){u[Q][0]=B[Q].pos[0]-M.pos[0],u[Q][1]=B[Q].pos[1]-M.pos[1]})}else n.forEach(function(M,Q){var X=M.direction;X&&(X.indexOf(m)>-1&&(u[Q][0]=t[0]),X.indexOf(b)>-1&&(u[Q][1]=t[1]))}),m&&(u[1][0]=t[0]/2,u[5][0]=t[0]/2),b&&(u[3][1]=t[1]/2,u[7][1]=t[1]/2)}else o&&!c?d.forEach(function(M){var Q=M==="n"||M==="s";n.forEach(function(X,$){var H=X.direction,Z=X.horizontal,re=X.vertical;!H||H.indexOf(M)===-1||(u[$]=[Q||!Z?0:t[0],!Q||!re?0:t[1]])})}):u[e]=t;return u}function NJ(n,e){var t=J(nV(n,e),2),r=t[0],i=t[1],a=e.datas,o=a.clipPath,c=a.clipIndex,u=o,d=u.type,h=u.poses,p=u.splitter,m=h.map(function(C){return C.pos});if(d==="polygon")m.splice(c,0,[r,i]);else if(d==="inset"){var b=SJ.indexOf(c),_=TJ.indexOf(c),w=h.length;if(CJ(h,m,8,b,_,r,i,m[4][0],m[4][1],m[0][0],m[0][1]),w===h.length)return}else return;var S=IS(n,o,m),T="".concat(d,"(").concat(S.join(p),")");Pe(n,"onClip",mt(n,e,W({clipEventType:"added",clipType:d,poses:m,clipStyles:S,clipStyle:T,distX:0,distY:0},qr({clipPath:T},e))))}function MJ(n,e){var t=e.datas,r=t.clipPath,i=t.clipIndex,a=r,o=a.type,c=a.poses,u=a.splitter,d=c.map(function(b){return b.pos}),h=d.length;if(o==="polygon")c.splice(i,1),d.splice(i,1);else if(o==="inset"){if(i<8||(AJ(c,d,i,8,h),h===c.length))return}else return;var p=IS(n,r,d),m="".concat(o,"(").concat(p.join(u),")");Pe(n,"onClip",mt(n,e,W({clipEventType:"removed",clipType:o,poses:d,clipStyles:p,clipStyle:m,distX:0,distY:0},qr({clipPath:m},e))))}var PJ={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(n,e){var t=n.props,r=t.customClipPath,i=t.defaultClipPath,a=t.clipArea,o=t.zoom,c=t.groupable,u=n.getState(),d=u.target,h=u.width,p=u.height,m=u.allMatrix,b=u.is3d,_=u.left,w=u.top,S=u.pos1,T=u.pos2,C=u.pos3,R=u.pos4,j=u.clipPathState,z=u.snapBoundInfos,V=u.rotation;if(!d||c)return[];var I=Ck(d,h,p,i||"inset",j||r);if(!I)return[];var A=b?4:3,k=I.type,O=I.poses,L=O.map(function(Be){var ze=hn(m,Be.pos,A);return[ze[0]-_,ze[1]-w]}),B=[],M=[],Q=k==="rect",X=k==="inset",$=k==="polygon";if(Q||X||$){var H=X?L.slice(0,8):L;M=H.map(function(Be,ze){var st=ze===0?H[H.length-1]:H[ze-1],yt=Vn(st,Be),Ve=PV(st,Be);return e.createElement("div",{key:"clipLine".concat(ze),className:Ge("line","clip-line","snap-control"),"data-clip-index":ze,style:{width:"".concat(Ve,"px"),transform:"translate(".concat(st[0],"px, ").concat(st[1],"px) rotate(").concat(yt,"rad) scaleY(").concat(o,")")}})})}if(B=L.map(function(Be,ze){return e.createElement("div",{key:"clipControl".concat(ze),className:Ge("control","clip-control","snap-control"),"data-clip-index":ze,style:{transform:"translate(".concat(Be[0],"px, ").concat(Be[1],"px) rotate(").concat(V,"rad) scale(").concat(o,")")}})}),X&&B.push.apply(B,Ae([],J(L.slice(8).map(function(Be,ze){return e.createElement("div",{key:"clipRadiusControl".concat(ze),className:Ge("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+ze,style:{transform:"translate(".concat(Be[0],"px, ").concat(Be[1],"px) rotate(").concat(V,"rad) scale(").concat(o,")")}})})),!1)),k==="circle"||k==="ellipse"){var Z=I.left,re=I.top,de=I.radiusX,U=I.radiusY,Y=J($e(hn(m,[Z,re],A),hn(m,[0,0],A)),2),ne=Y[0],ie=Y[1],te="none";if(!a){for(var se=Math.max(10,de/5,U/5),me=[],Te=0;Te<=se;++Te){var Ce=Math.PI*2/se*Te;me.push([de+(de-o)*Math.cos(Ce),U+(U-o)*Math.sin(Ce)])}me.push([de,-2]),me.push([-2,-2]),me.push([-2,U*2+2]),me.push([de*2+2,U*2+2]),me.push([de*2+2,-2]),me.push([de,-2]),te="polygon(".concat(me.map(function(Be){return"".concat(Be[0],"px ").concat(Be[1],"px")}).join(", "),")")}B.push(e.createElement("div",{key:"clipEllipse",className:Ge("clip-ellipse","snap-control"),style:{width:"".concat(de*2,"px"),height:"".concat(U*2,"px"),clipPath:te,transform:"translate(".concat(-_+ne,"px, ").concat(-w+ie,"px) ").concat(ly(m))}}))}if(a){var Ne=Xi(Ae([S,T,C,R],J(L),!1)),xe=Ne.width,Ee=Ne.height,Qe=Ne.left,Oe=Ne.top;if($||Q||X){var me=X?L.slice(0,8):L;B.push(e.createElement("div",{key:"clipArea",className:Ge("clip-area","snap-control"),style:{width:"".concat(xe,"px"),height:"".concat(Ee,"px"),transform:"translate(".concat(Qe,"px, ").concat(Oe,"px)"),clipPath:"polygon(".concat(me.map(function(ze){return"".concat(ze[0]-Qe,"px ").concat(ze[1]-Oe,"px")}).join(", "),")")}}))}}return z&&["vertical","horizontal"].forEach(function(Be){var ze=z[Be],st=Be==="horizontal";ze.isSnap&&M.push.apply(M,Ae([],J(ze.snap.posInfos.map(function(yt,Ve){var Ke=yt.pos,Mt=$e(hn(m,st?[0,Ke]:[Ke,0],A),[_,w]),vn=$e(hn(m,st?[h,Ke]:[Ke,p],A),[_,w]);return dp(e,"",Mt,vn,o,"clip".concat(Be,"snap").concat(Ve),"guideline")})),!1)),ze.isBound&&M.push.apply(M,Ae([],J(ze.bounds.map(function(yt,Ve){var Ke=yt.pos,Mt=$e(hn(m,st?[0,Ke]:[Ke,0],A),[_,w]),vn=$e(hn(m,st?[h,Ke]:[Ke,p],A),[_,w]);return dp(e,"",Mt,vn,o,"clip".concat(Be,"bounds").concat(Ve),"guideline","bounds","bold")})),!1))}),Ae(Ae([],J(B),!1),J(M),!1)},dragControlCondition:function(n,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(n,e){var t=n.props,r=t.dragWithClip,i=r===void 0?!0:r;return i?!1:this.dragControlStart(n,e)},drag:function(n,e){return this.dragControl(n,W(W({},e),{isDragTarget:!0}))},dragEnd:function(n,e){return this.dragControlEnd(n,e)},dragControlStart:function(n,e){var t=n.state,r=n.props,i=r.defaultClipPath,a=r.customClipPath,o=t.target,c=t.width,u=t.height,d=e.inputEvent?e.inputEvent.target:null,h=d&&d.getAttribute("class")||"",p=e.datas,m=Ck(o,c,u,i||"inset",a);if(!m)return!1;var b=m.clipText,_=m.type,w=m.poses,S=Pe(n,"onClipStart",mt(n,e,{clipType:_,clipStyle:b,poses:w.map(function(T){return T.pos})}));return S===!1?(p.isClipStart=!1,!1):(p.isControl=h&&h.indexOf("clip-control")>-1,p.isLine=h.indexOf("clip-line")>-1,p.isArea=h.indexOf("clip-area")>-1||h.indexOf("clip-ellipse")>-1,p.clipIndex=d?parseInt(d.getAttribute("data-clip-index"),10):-1,p.clipPath=m,p.isClipStart=!0,t.clipPathState=b,Lc(n,e),!0)},dragControl:function(n,e){var t,r,i,a=e.datas,o=e.originalDatas,c=e.isDragTarget;if(!a.isClipStart)return!1;var u=a,d=u.isControl,h=u.isLine,p=u.isArea,m=u.clipIndex,b=u.clipPath;if(!b)return!1;var _=Mc(n.props,"clippable"),w=_.keepRatio,S=0,T=0,C=o.draggable,R=os(e);c&&C?(t=J(C.prevBeforeDist,2),S=t[0],T=t[1]):(r=J(R,2),S=r[0],T=r[1]);var j=[S,T],z=n.state,V=z.width,I=z.height,A=!p&&!d&&!h,k=b.type,O=b.poses,L=b.splitter,B=O.map(function(dt){return dt.pos});A&&(S=-S,T=-T);var M=!d||O[m].direction==="nesw",Q=k==="inset"||k==="rect",X=O.map(function(){return[0,0]});if(d&&!M){var $=O[m],H=$.horizontal,Z=$.vertical,re=[S*_e(H),T*_e(Z)];X=kJ(O,m,re,Q,w)}else M&&(X=B.map(function(){return[S,T]}));var de=B.map(function(dt,Xe){return Nt(dt,X[Xe])}),U=Ae([],J(de),!1);z.snapBoundInfos=null;var Y=b.type==="circle",ne=b.type==="ellipse";if(Y||ne){var ie=Xi(de),te=_e(ie.bottom-ie.top),se=_e(ne?ie.right-ie.left:te),me=de[0][1]+te,Te=de[0][0]-se,Ce=de[0][0]+se;Y&&(U.push([Ce,ie.bottom]),X.push([1,0])),U.push([ie.left,me]),X.push([0,1]),U.push([Te,ie.bottom]),X.push([1,0])}var Ne=IV((_.clipHorizontalGuidelines||[]).map(function(dt){return Xt("".concat(dt),I)}),(_.clipVerticalGuidelines||[]).map(function(dt){return Xt("".concat(dt),V)}),V,I),xe=[],Ee=[];if(Y||ne)xe=[U[4][0],U[2][0]],Ee=[U[1][1],U[3][1]];else if(Q){var Qe=[U[0],U[2],U[4],U[6]],Oe=[X[0],X[2],X[4],X[6]];xe=Qe.filter(function(dt,Xe){return Oe[Xe][0]}).map(function(dt){return dt[0]}),Ee=Qe.filter(function(dt,Xe){return Oe[Xe][1]}).map(function(dt){return dt[1]})}else xe=U.filter(function(dt,Xe){return X[Xe][0]}).map(function(dt){return dt[0]}),Ee=U.filter(function(dt,Xe){return X[Xe][1]}).map(function(dt){return dt[1]});var Be=[0,0],ze=dk(Ne,_.clipTargetBounds&&{left:0,top:0,right:V,bottom:I},xe,Ee,5,5),st=ze.horizontal,yt=ze.vertical,Ve=st.offset,Ke=yt.offset;if(st.isBound&&(Be[1]+=Ve),yt.isBound&&(Be[0]+=Ke),(ne||Y)&&X[0][0]===0&&X[0][1]===0){var ie=Xi(de),Mt=ie.bottom-ie.top,vn=ne?ie.right-ie.left:Mt,dn=yt.isBound?_e(Ke):yt.snapIndex===0?-Ke:Ke,bt=st.isBound?_e(Ve):st.snapIndex===0?-Ve:Ve;vn-=dn,Mt-=bt,Y&&(Mt=xV(yt,st)>0?Mt:vn,vn=Mt);var Lt=U[0];U[1][1]=Lt[1]-Mt,U[2][0]=Lt[0]+vn,U[3][1]=Lt[1]+Mt,U[4][0]=Lt[0]-vn}else if(Q&&w&&d){var Cr=J(ZV(O),2),Qn=Cr[0],Yr=Cr[1],ls=Qn&&Yr?Qn/Yr:0,Zs=O[m],Zi=Zs.direction||"",_a=U[1][1],me=U[5][1],Te=U[7][0],Ce=U[3][0];_e(Ve)<=_e(Ke)?Ve=Ur(Ve)*_e(Ke)/ls:Ke=Ur(Ke)*_e(Ve)*ls,Zi.indexOf("w")>-1?Te-=Ke:Zi.indexOf("e")>-1?Ce-=Ke:(Te+=Ke/2,Ce-=Ke/2),Zi.indexOf("n")>-1?_a-=Ve:Zi.indexOf("s")>-1?me-=Ve:(_a+=Ve/2,me-=Ve/2);var jr=hv(_a,Ce,me,Te);U.forEach(function(Tn,Jt){var nt;nt=J(jr[Jt].pos,2),Tn[0]=nt[0],Tn[1]=nt[1]})}else U.forEach(function(dt,Xe){var Ze=X[Xe];Ze[0]&&(dt[0]-=Ke),Ze[1]&&(dt[1]-=Ve)});var yn=IS(n,b,de),cr="".concat(k,"(").concat(yn.join(L),")");if(z.clipPathState=cr,Y||ne)xe=[U[4][0],U[2][0]],Ee=[U[1][1],U[3][1]];else if(Q){var Qe=[U[0],U[2],U[4],U[6]];xe=Qe.map(function(Xe){return Xe[0]}),Ee=Qe.map(function(Xe){return Xe[1]})}else xe=U.map(function(dt){return dt[0]}),Ee=U.map(function(dt){return dt[1]});if(z.snapBoundInfos=dk(Ne,_.clipTargetBounds&&{left:0,top:0,right:V,bottom:I},xe,Ee,1,1),C){var en=z.is3d,Js=z.allMatrix,ke=en?4:3,Me=Be;c&&(Me=[j[0]+Be[0]-R[0],j[1]+Be[1]-R[1]]),C.deltaOffset=Wt(Js,[Me[0],Me[1],0,0],ke)}return Pe(n,"onClip",mt(n,e,W({clipEventType:"changed",clipType:k,poses:de,clipStyle:cr,clipStyles:yn,distX:S,distY:T},qr((i={},i[k==="rect"?"clip":"clipPath"]=cr,i),e)))),!0},dragControlEnd:function(n,e){this.unset(n);var t=e.isDrag,r=e.datas,i=e.isDouble,a=r.isLine,o=r.isClipStart,c=r.isControl;return o?(Pe(n,"onClipEnd",Ei(n,e,{})),i&&(c?MJ(n,e):a&&NJ(n,e)),i||t):!1},unset:function(n){n.state.clipPathState="",n.state.snapBoundInfos=null}},OJ={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(n,e){return e.isRequest?e.requestAble==="originDraggable":ir(e.inputEvent.target,Ge("origin"))},dragControlStart:function(n,e){var t=e.datas;Lc(n,e);var r=mt(n,e,{dragStart:Br.dragStart(n,new Ad().dragStart([0,0],e))}),i=Pe(n,"onDragOriginStart",r);return t.startOrigin=n.state.transformOrigin,t.startTargetOrigin=n.state.targetOrigin,t.prevOrigin=[0,0],t.isDragOrigin=!0,i===!1?(t.isDragOrigin=!1,!1):r},dragControl:function(n,e){var t=e.datas,r=e.isPinch,i=e.isRequest;if(!t.isDragOrigin)return!1;var a=J(os(e),2),o=a[0],c=a[1],u=n.state,d=u.width,h=u.height,p=u.offsetMatrix,m=u.targetMatrix,b=u.is3d,_=n.props.originRelative,w=_===void 0?!0:_,S=b?4:3,T=[o,c];if(i){var C=e.distOrigin;(C[0]||C[1])&&(T=C)}var R=Nt(t.startOrigin,T),j=Nt(t.startTargetOrigin,T),z=$e(T,t.prevOrigin),V=Zp(p,m,R,S),I=n.getRect(),A=Xi(Bc(V,d,h,S)),k=[I.left-A.left,I.top-A.top];t.prevOrigin=T;var O=[da(j[0],d,w),da(j[1],h,w)].join(" "),L=Br.drag(n,Qp(e,n.state,k,!!r)),B=mt(n,e,W(W({width:d,height:h,origin:R,dist:T,delta:z,transformOrigin:O,drag:L},qr({transformOrigin:O,transform:L.transform},e)),{afterTransform:L.transform}));return Pe(n,"onDragOrigin",B),B},dragControlEnd:function(n,e){var t=e.datas;return t.isDragOrigin?(Pe(n,"onDragOriginEnd",Ei(n,e,{})),!0):!1},dragGroupControlCondition:function(n,e){return this.dragControlCondition(n,e)},dragGroupControlStart:function(n,e){var t=this.dragControlStart(n,e);return!!t},dragGroupControl:function(n,e){var t=this.dragControl(n,e);return t?(n.transformOrigin=t.transformOrigin,!0):!1},request:function(n){var e={},t=n.getRect(),r=0,i=0,a=t.transformOrigin,o=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(c){return"deltaOrigin"in c?(o[0]+=c.deltaOrigin[0],o[1]+=c.deltaOrigin[1]):"origin"in c?(o[0]=c.origin[0]-a[0],o[1]=c.origin[1]-a[1]):("x"in c?r=c.x-t.left:"deltaX"in c&&(r+=c.deltaX),"y"in c?i=c.y-t.top:"deltaY"in c&&(i+=c.deltaY)),{datas:e,distX:r,distY:i,distOrigin:o}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function VJ(n,e,t,r){var i=n.filter(function(u){var d=u.virtual,h=u.horizontal;return h&&!d}).length,a=n.filter(function(u){var d=u.virtual,h=u.vertical;return h&&!d}).length,o=-1;if(e===0&&(i===0?o=0:i===1&&(o=1)),e===2&&(i<=2?o=2:i<=3&&(o=3)),e===3&&(a===0?o=4:a<4&&(o=7)),e===1&&(a<=1?o=5:a<=2&&(o=6)),!(o===-1||!n[o].virtual)){var c=n[o];jJ(n,o),o<4?c.pos[0]=t:c.pos[1]=r}}function jJ(n,e){e<4?n.slice(0,e+1).forEach(function(t){t.virtual=!1}):(n[0].virtual&&(n[0].virtual=!1),n.slice(4,e+1).forEach(function(t){t.virtual=!1}))}function zJ(n,e){e<4?n.slice(e,4).forEach(function(t){t.virtual=!0}):n.slice(e).forEach(function(t){t.virtual=!0})}function Ik(n,e,t,r,i){r===void 0&&(r=[0,0]);var a=[];return!n||n==="0px"?a=[]:a=ul(n),QV(a,e,t,0,0,r,i)}function Rk(n,e,t,r,i){var a=n.state,o=a.width,c=a.height,u=CS(i,n.props.roundRelative,o,c),d=u.raws,h=u.styles,p=u.radiusPoses,m=IJ(p,d),b=m.horizontals,_=m.verticals,w=h.join(" ");a.borderRadiusState=w;var S=mt(n,e,W({horizontals:b,verticals:_,borderRadius:w,width:o,height:c,delta:r,dist:t},qr({borderRadius:w},e)));return Pe(n,"onRound",S),S}function Dk(n){var e,t,r=n.getState().style,i=r.borderRadius||"";if(!i&&n.props.groupable){var a=n.moveables[0],o=n.getTargets()[0];o&&(a?.props.target===o?(i=(t=(e=n.moveables[0])===null||e===void 0?void 0:e.state.style.borderRadius)!==null&&t!==void 0?t:"",r.borderRadius=i):(i=wS(o).borderRadius,r.borderRadius=i))}return i}var LJ={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(n){var e=n.props.roundClickable;return e===!0||e==="line"?Ge("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(n,e){var t=n.getState(),r=t.target,i=t.width,a=t.height,o=t.allMatrix,c=t.is3d,u=t.left,d=t.top,h=t.borderRadiusState,p=n.props,m=p.minRoundControls,b=m===void 0?[0,0]:m,_=p.maxRoundControls,w=_===void 0?[4,4]:_,S=p.zoom,T=p.roundPadding,C=T===void 0?0:T,R=p.isDisplayShadowRoundControls,j=p.groupable;if(!r)return null;var z=h||Dk(n),V=c?4:3,I=Ik(z,i,a,b,!0);if(!I)return null;var A=0,k=0,O=j?[0,0]:[u,d];return I.map(function(L,B){var M=L.horizontal,Q=L.vertical,X=L.direction||"",$=Ae([],J(L.pos),!1);k+=Math.abs(M),A+=Math.abs(Q),M&&X.indexOf("n")>-1&&($[1]-=C),Q&&X.indexOf("w")>-1&&($[0]-=C),M&&X.indexOf("s")>-1&&($[1]+=C),Q&&X.indexOf("e")>-1&&($[0]+=C);var H=$e(hn(o,$,V),O),Z=R&&R!=="horizontal",re=L.vertical?A<=w[1]&&(Z||!L.virtual):k<=w[0]&&(R||!L.virtual);return e.createElement("div",{key:"borderRadiusControl".concat(B),className:Ge("control","border-radius",L.vertical?"vertical":"",L.virtual?"virtual":""),"data-radius-index":B,style:{display:re?"block":"none",transform:"translate(".concat(H[0],"px, ").concat(H[1],"px) scale(").concat(S,")")}})})},dragControlCondition:function(n,e){if(!e.inputEvent||e.isRequest)return!1;var t=e.inputEvent.target.getAttribute("class")||"";return t.indexOf("border-radius")>-1||t.indexOf("moveable-line")>-1&&t.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(n,e){return this.dragControlCondition(n,e)},dragControlStart:function(n,e){var t=e.inputEvent,r=e.datas,i=t.target,a=i.getAttribute("class")||"",o=a.indexOf("border-radius")>-1,c=a.indexOf("moveable-line")>-1&&a.indexOf("moveable-direction")>-1,u=o?parseInt(i.getAttribute("data-radius-index"),10):-1,d=-1;if(c){var h=i.getAttribute("data-line-key")||"";h&&(d=parseInt(h.replace(/render-line-/g,""),10),isNaN(d)&&(d=-1))}if(!o&&!c)return!1;var p=mt(n,e,{}),m=Pe(n,"onRoundStart",p);if(m===!1)return!1;r.lineIndex=d,r.controlIndex=u,r.isControl=o,r.isLine=c,Lc(n,e);var b=n.props,_=b.roundRelative,w=b.minRoundControls,S=w===void 0?[0,0]:w,T=n.state,C=T.width,R=T.height;r.isRound=!0,r.prevDist=[0,0];var j=Dk(n),z=Ik(j||"",C,R,S,!0)||[];return r.controlPoses=z,T.borderRadiusState=CS(z,_,C,R).styles.join(" "),p},dragControl:function(n,e){var t=e.datas,r=t.controlPoses;if(!t.isRound||!t.isControl||!r.length)return!1;var i=t.controlIndex,a=J(os(e),2),o=a[0],c=a[1],u=[o,c],d=$e(u,t.prevDist),h=n.props.maxRoundControls,p=h===void 0?[4,4]:h,m=n.state,b=m.width,_=m.height,w=r[i],S=w.vertical,T=w.horizontal,C=r.map(function(j){var z=j.horizontal,V=j.vertical,I=[z*T*u[0],V*S*u[1]];if(z){if(p[0]===1)return I;if(p[0]<4&&z!==T)return I}else{if(p[1]===0)return I[1]=V*T*u[0]/b*_,I;if(S){if(p[1]===1)return I;if(p[1]<4&&V!==S)return I}}return[0,0]});C[i]=u;var R=r.map(function(j,z){return W(W({},j),{pos:Nt(j.pos,C[z])})});return i<4?R.slice(0,i+1).forEach(function(j){j.virtual=!1}):R.slice(4,i+1).forEach(function(j){j.virtual=!1}),t.prevDist=[o,c],Rk(n,e,u,d,R)},dragControlEnd:function(n,e){var t=n.state;t.borderRadiusState="";var r=e.datas,i=e.isDouble;if(!r.isRound)return!1;var a=r.isControl,o=r.controlIndex,c=r.isLine,u=r.lineIndex,d=r.controlPoses,h=d.filter(function(T){var C=T.virtual;return C}).length,p=n.props.roundClickable,m=p===void 0?!0:p;if(i&&m){if(a&&(m===!0||m==="control"))zJ(d,o);else if(c&&(m===!0||m==="line")){var b=J(nV(n,e),2),_=b[0],w=b[1];VJ(d,u,_,w)}h!==d.filter(function(T){var C=T.virtual;return C}).length&&Rk(n,e,[0,0],[0,0],d)}var S=Ei(n,e,{});return Pe(n,"onRoundEnd",S),t.borderRadiusState="",S},dragGroupControlStart:function(n,e){var t=this.dragControlStart(n,e);if(!t)return!1;var r=n.moveables,i=n.props.targets,a=pa(n,"roundable",e),o=W({targets:n.props.targets,events:a.map(function(c,u){return W(W({},c),{target:i[u],moveable:r[u],currentTarget:r[u]})})},t);return Pe(n,"onRoundGroupStart",o),t},dragGroupControl:function(n,e){var t=this.dragControl(n,e);if(!t)return!1;var r=n.moveables,i=n.props.targets,a=pa(n,"roundable",e),o=W({targets:n.props.targets,events:a.map(function(c,u){return W(W(W({},c),{target:i[u],moveable:r[u],currentTarget:r[u]}),qr({borderRadius:t.borderRadius},c))})},t);return Pe(n,"onRoundGroup",o),o},dragGroupControlEnd:function(n,e){var t=n.moveables,r=n.props.targets,i=pa(n,"roundable",e);cy(n,"onRound",function(c){var u=W({targets:n.props.targets,events:i.map(function(d,h){return W(W(W({},d),{target:r[h],moveable:t[h],currentTarget:t[h]}),qr({borderRadius:c.borderRadius},d))})},c);Pe(n,"onRoundGroup",u)});var a=this.dragControlEnd(n,e);if(!a)return!1;var o=W({targets:n.props.targets,events:i.map(function(c,u){var d;return W(W({},c),{target:r[u],moveable:t[u],currentTarget:t[u],lastEvent:(d=c.datas)===null||d===void 0?void 0:d.lastEvent})})},a);return Pe(n,"onRoundGroupEnd",o),o},unset:function(n){n.state.borderRadiusState=""}};function BJ(n,e){var t=e?4:3,r=rn(t),i="matrix".concat(e?"3d":"","(").concat(r.join(","),")");return n===i||n==="matrix(1,0,0,1,0,0)"}var JV={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(n,e){var t=n.state,r=t.is3d,i=t.targetMatrix,a=t.inlineTransform,o=r?"matrix3d(".concat(i.join(","),")"):"matrix(".concat(G3(i,!0),")"),c=!a||a==="none"?o:a;e.datas.startTransforms=BJ(c,r)?[]:ul(c)},resetStyle:function(n){var e=n.datas;e.nextStyle={},e.nextTransforms=n.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(n,e){return mt(n,e,{setTransform:function(t){e.datas.startTransforms=Wn(t)?t:ul(t)},isPinch:!!e.isPinch})},fillDragParams:function(n,e){return mt(n,e,{isPinch:!!e.isPinch})},dragStart:function(n,e){this.setTransform(n,e),this.resetStyle(e),Pe(n,"onBeforeRenderStart",this.fillDragStartParams(n,e))},drag:function(n,e){e.datas.startTransforms||this.setTransform(n,e),this.resetStyle(e),Pe(n,"onBeforeRender",mt(n,e,{isPinch:!!e.isPinch}))},dragEnd:function(n,e){e.datas.startTransforms||(this.setTransform(n,e),this.resetStyle(e)),Pe(n,"onBeforeRenderEnd",mt(n,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(n,e){var t=this;this.dragStart(n,e);var r=pa(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.setTransform(u,o),t.resetStyle(o),t.fillDragStartParams(u,o)});Pe(n,"onBeforeRenderGroupStart",mt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets,setTransform:function(){},events:a}))},dragGroup:function(n,e){var t=this;this.drag(n,e);var r=pa(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.resetStyle(o),t.fillDragParams(u,o)});Pe(n,"onBeforeRenderGroup",mt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets,events:a}))},dragGroupEnd:function(n,e){this.dragEnd(n,e),Pe(n,"onBeforeRenderGroupEnd",mt(n,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:n.props.targets}))},dragControlStart:function(n,e){return this.dragStart(n,e)},dragControl:function(n,e){return this.drag(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupControlStart:function(n,e){return this.dragGroupStart(n,e)},dragGroupControl:function(n,e){return this.dragGroup(n,e)},dragGroupControlEnd:function(n,e){return this.dragGroupEnd(n,e)}},e5={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(n,e){Pe(n,"onRenderStart",mt(n,e,{isPinch:!!e.isPinch}))},drag:function(n,e){Pe(n,"onRender",this.fillDragParams(n,e))},dragAfter:function(n,e){return this.drag(n,e)},dragEnd:function(n,e){Pe(n,"onRenderEnd",this.fillDragEndParams(n,e))},dragGroupStart:function(n,e){Pe(n,"onRenderGroupStart",mt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets}))},dragGroup:function(n,e){var t=this,r=pa(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.fillDragParams(u,o)});Pe(n,"onRenderGroup",mt(n,e,W(W({isPinch:!!e.isPinch,targets:n.props.targets,transform:Fm(e),transformObject:{}},qr(Gm(e))),{events:a})))},dragGroupEnd:function(n,e){var t=this,r=pa(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.fillDragEndParams(u,o)});Pe(n,"onRenderGroupEnd",mt(n,e,W({isPinch:!!e.isPinch,isDrag:e.isDrag,targets:n.props.targets,events:a,transformObject:{},transform:Fm(e)},qr(Gm(e)))))},dragControlStart:function(n,e){return this.dragStart(n,e)},dragControl:function(n,e){return this.drag(n,e)},dragControlAfter:function(n,e){return this.dragAfter(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupControlStart:function(n,e){return this.dragGroupStart(n,e)},dragGroupControl:function(n,e){return this.dragGroup(n,e)},dragGroupControlEnd:function(n,e){return this.dragGroupEnd(n,e)},fillDragParams:function(n,e){var t={};return Td(sv(e)||[]).forEach(function(r){t[r.name]=r.functionValue}),mt(n,e,W({isPinch:!!e.isPinch,transformObject:t,transform:Fm(e)},qr(Gm(e))))},fillDragEndParams:function(n,e){var t={};return Td(sv(e)||[]).forEach(function(r){t[r.name]=r.functionValue}),mt(n,e,W({isPinch:!!e.isPinch,isDrag:e.isDrag,transformObject:t,transform:Fm(e)},qr(Gm(e))))}};function Oh(n,e,t,r,i,a,o){a.clientDistX=a.distX,a.clientDistY=a.distY;var c=i==="Start",u=i==="End",d=i==="After",h=n.state.target,p=a.isRequest,m=r.indexOf("Control")>-1;if(!h||c&&m&&!p&&n.areaElement===a.inputEvent.target)return!1;var b=Ae([],J(e),!1);if(p){var _=a.requestAble;b.some(function(B){return B.name===_})||b.push.apply(b,Ae([],J(n.props.ables.filter(function(B){return B.name===_})),!1))}if(!b.length||b.every(function(B){return B.dragRelation}))return!1;var w=a.inputEvent,S;u&&w&&(S=document.elementFromPoint(a.clientX,a.clientY)||w.target);var T=!1,C=function(){var B;T=!0,(B=a.stop)===null||B===void 0||B.call(a)},R=c&&(!n.targetGesto||!n.controlGesto||!n.targetGesto.isFlag()||!n.controlGesto.isFlag());R&&n.updateRect(i,!0,!1);var j=a.datas,z=m?"controlGesto":"targetGesto",V=n[z],I=function(B,M,Q){if(!(M in B)||V!==n[z])return!1;var X=B.name,$=j[X]||(j[X]={});if(c&&($.isEventStart=!Q||!B[Q]||B[Q](n,a)),!$.isEventStart)return!1;var H=B[M](n,W(W({},a),{stop:C,datas:$,originalDatas:j,inputTarget:S}));return n._emitter.off(),c&&H===!1&&($.isEventStart=!1),H};R&&b.forEach(function(B){B.unset&&B.unset(n)}),I(JV,"drag".concat(r).concat(i));var A=0,k=0;t.forEach(function(B){if(T)return!1;var M="".concat(B).concat(r).concat(i),Q="".concat(B).concat(r,"Condition");i===""&&!p&&cJ(n.state,a);var X=b.filter(function(Z){return Z[M]});X=X.filter(function(Z,re){return Z.name&&X.indexOf(Z)===re});var $=X.filter(function(Z){return I(Z,M,Q)}),H=$.length;T&&++A,H&&++k,!T&&c&&X.length&&!H&&(A+=X.filter(function(Z){var re=Z.name,de=j[re];return de.isEventStart?Z.dragRelation!=="strong":!1}).length?1:0)}),(!d||k)&&I(e5,"drag".concat(r).concat(i));var O=V!==n[z]||A===t.length;if((u||T||O)&&(n.state.gestos={},n.moveables&&n.moveables.forEach(function(B){B.state.gestos={}}),b.forEach(function(B){B.unset&&B.unset(n)})),c&&!O&&!p&&k&&n.props.preventDefault&&a?.preventDefault(),n.isUnmounted||O)return!1;if(!c&&k&&!o||u){var L=n.props.flushSync||kV;L(function(){n.updateRect(u?i:"",!0,!1),n.forceUpdate()})}return!c&&!u&&!d&&k&&!o&&Oh(n,e,t,r,i+"After",a),!0}function RS(n,e){return function(t,r){var i;r===void 0&&(r=t.inputEvent.target);var a=r,o=n.areaElement,c=n._dragTarget;return!c||!e&&(!((i=n.controlGesto)===null||i===void 0)&&i.isFlag())?!1:a===c||c.contains(a)||a===o||!n.isMoveableElement(a)&&!n.controlBox.contains(a)||ir(a,"moveable-area")||ir(a,"moveable-padding")||ir(a,"moveable-edgeDraggable")}}function t5(n,e,t){var r=n.controlBox,i=[],a=n.props,o=a.dragArea,c=n.state.target,u=a.dragTarget;i.push(r),(!o||u)&&i.push(e),!o&&u&&c&&e!==c&&a.dragTargetSelf&&i.push(c);var d=RS(n);return r5(n,i,"targetAbles",t,{dragStart:d,pinchStart:d})}function n5(n,e){var t=n.controlBox,r=[];r.push(t);var i=RS(n,!0),a=function(o,c){if(c===void 0&&(c=o.inputEvent.target),c===t)return!0;var u=i(o,c);return!u};return r5(n,r,"controlAbles",e,{dragStart:a,pinchStart:a})}function r5(n,e,t,r,i){i===void 0&&(i={});var a=t==="targetAbles",o=n.props,c=o.pinchOutside,u=o.pinchThreshold,d=o.preventClickEventOnDrag,h=o.preventClickDefault,p=o.checkInput,m=o.dragFocusedInput,b=o.preventDefault,_=b===void 0?!0:b,w=o.preventRightClick,S=w===void 0?!0:w,T=o.preventWheelClick,C=T===void 0?!0:T,R=o.dragContainer,j=Ja(R,!0),z={preventDefault:_,preventRightClick:S,preventWheelClick:C,container:j||nl(n.getControlBoxElement()),pinchThreshold:u,pinchOutside:c,preventClickEventOnDrag:a?d:!1,preventClickEventOnDragStart:a?h:!1,preventClickEventByCondition:a?null:function(A){return n.controlBox.contains(A.target)},checkInput:a?p:!1,dragFocusedInput:m},V=new hQ(e,z),I=r==="Control";return["drag","pinch"].forEach(function(A){["Start","","End"].forEach(function(k){V.on("".concat(A).concat(k),function(O){var L,B=O.eventType,M=A==="drag"&&O.isPinch;if(i[B]&&!i[B](O)){O.stop();return}if(!M){var Q=A==="drag"?[A]:["drag",A],X=Ae([],J(n[t]),!1),$=Oh(n,X,Q,r,k,O);$?(n.props.stopPropagation||k==="Start"&&I)&&((L=O?.inputEvent)===null||L===void 0||L.stopPropagation()):O.stop()}})})}),V}var UJ=(function(){function n(e,t,r){var i=this;this.target=e,this.moveable=t,this.eventName=r,this.ables=[],this._onEvent=function(a){var o=i.eventName,c=i.moveable;c.state.disableNativeEvent||i.ables.forEach(function(u){u[o](c,{inputEvent:a})})},e.addEventListener(r.toLowerCase(),this._onEvent)}return n.prototype.setAbles=function(e){this.ables=e},n.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},n})();function FJ(n,e,t,r){var i;t===void 0&&(t=e);var a=lV(n,e),o=a.matrixes,c=a.is3d,u=a.targetMatrix,d=a.transformOrigin,h=a.targetOrigin,p=a.offsetContainer,m=a.hasFixed,b=a.zoom,_=nZ(p,t),w=_.matrixes,S=_.is3d,T=_.offsetContainer,C=_.zoom,R=r,j=4,z=n.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in n,V=u,I=rn(j),A=rn(j),k=rn(j),O=rn(j),L=o.length,B=w.map(function(re){return W(W({},re),{matrix:re.matrix?Ae([],J(re.matrix),!1):void 0})}).reverse();o.reverse(),!c&&R&&(V=ba(V,3,4),U_(o)),!S&&R&&U_(B),B.forEach(function(re){A=Wt(A,re.matrix,j)});var M=t||yl(n),Q=((i=B[0])===null||i===void 0?void 0:i.target)||fp(M,M,!0).offsetParent,X=B.slice(1).reduce(function(re,de){return Wt(re,de.matrix,j)},rn(j));o.forEach(function(re,de){if(L-2===de&&(k=I.slice()),L-1===de&&(O=I.slice()),!re.matrix){var U=o[de+1],Y=aJ(re,U,Q,j,Wt(X,I,j));re.matrix=kc(Y,j)}I=Wt(I,re.matrix,j)});var $=!z&&c;V||(V=rn($?4:3));var H=ly(z&&V.length===16?ba(V,4,3):V,$),Z=A;return A=U3(A,j,j),{hasZoom:b!==1||C!==1,hasFixed:m,matrixes:o,rootMatrix:A,originalRootMatrix:Z,beforeMatrix:k,offsetMatrix:O,allMatrix:I,targetMatrix:V,targetTransform:H,inlineTransform:n.style.transform,transformOrigin:d,targetOrigin:h,is3d:R,offsetContainer:p,offsetRootContainer:T}}function GJ(n,e,t,r){t===void 0&&(t=e);var i=0,a=0,o=0,c={},u=OV(n);if(n&&(i=u.offsetWidth,a=u.offsetHeight),n){var d=FJ(n,e,t,r),h=ad(d.allMatrix,d.transformOrigin,i,a);c=W(W({},d),h);var p=ad(d.allMatrix,[50,50],100,100);o=VV([p.pos1,p.pos2],p.direction)}var m=4;return W(W(W({hasZoom:!1,width:i,height:a,rotation:o},u),{originalRootMatrix:rn(m),rootMatrix:rn(m),beforeMatrix:rn(m),offsetMatrix:rn(m),allMatrix:rn(m),targetMatrix:rn(m),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!0,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),c)}function H_(n,e,t,r,i,a){a===void 0&&(a=[]);var o=1,c=[0,0],u=Hm(),d=Hm(),h=Hm(),p=Hm(),m=[0,0],b={},_=GJ(e,t,i,!0);if(e){var w=si(e);a.forEach(function(B){b[B]=w(B)});var S=_.is3d?4:3,T=ad(_.offsetMatrix,Nt(_.transformOrigin,F3(_.targetMatrix,S)),_.width,_.height);o=T.direction,c=Nt(T.origin,[T.left-_.left,T.top-_.top]),p=Ph(_.offsetRootContainer);var C=fp(r,r,!0).offsetParent||_.offsetRootContainer;if(_.hasZoom){var R=ad(Wt(_.originalRootMatrix,_.allMatrix),_.transformOrigin,_.width,_.height),j=ad(_.originalRootMatrix,uv(si(C)("transformOrigin")).map(function(B){return parseFloat(B)}),C.offsetWidth,C.offsetHeight);if(u=ix(R,p),h=ix(j,p,C,!0),n){var z=R.left,V=R.top;d=ix({left:z,top:V,bottom:V,right:V},p)}}else{u=Ph(e),h=tZ(C),n&&(d=Ph(n));var I=h.left,A=h.top,k=h.clientLeft,O=h.clientTop,L=[u.left-I,u.top-A];m=$e(Rd(_.rootMatrix,L,4),[k+_.left,O+_.top])}}return W({targetClientRect:u,containerClientRect:h,moveableClientRect:d,rootContainerClientRect:p,beforeDirection:o,beforeOrigin:c,originalBeforeOrigin:c,target:e,style:b,offsetDelta:m},_)}function kk(n){var e=n.pos1,t=n.pos2,r=n.pos3,i=n.pos4;if(!e||!t||!r||!i)return null;var a=Nc([e,t,r,i]),o=[a.minX,a.minY],c=$e(n.origin,o);return e=$e(e,o),t=$e(t,o),r=$e(r,o),i=$e(i,o),W(W({},n),{left:n.left,top:n.top,posDelta:o,pos1:e,pos2:t,pos3:r,pos4:i,origin:c,beforeOrigin:c,isPersisted:!0})}var Dd=(function(n){Xp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.state=W({container:null,gestos:{},renderLines:[[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]]],renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},H_(null)),t.renderState={},t.enabledAbles=[],t.targetAbles=[],t.controlAbles=[],t.rotation=0,t.scale=[1,1],t.isMoveableMounted=!1,t.isUnmounted=!1,t.events={mouseEnter:null,mouseLeave:null},t._emitter=new ey,t._prevOriginalDragTarget=null,t._originalDragTarget=null,t._prevDragTarget=null,t._dragTarget=null,t._prevPropTarget=null,t._propTarget=null,t._prevDragArea=!1,t._isPropTargetChanged=!1,t._hasFirstTarget=!1,t._reiszeObserver=null,t._observerId=0,t._mutationObserver=null,t._rootContainer=null,t._viewContainer=null,t._viewClassNames=[],t._store={},t.checkUpdateRect=function(){if(!t.isDragging()){var r=t.props.parentMoveable;if(r){r.checkUpdateRect();return}iW(t._observerId),t._observerId=g3(function(){t.isDragging()||t.updateRect()})}},t._onPreventClick=function(r){r.stopPropagation(),r.preventDefault()},t}return e.prototype.render=function(){var t=this.props,r=this.getState(),i=t.parentPosition,a=t.className,o=t.target,c=t.zoom,u=t.cspNonce,d=t.translateZ,h=t.cssStyled,p=t.groupable,m=t.linePadding,b=t.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var _=J(i||[0,0],2),w=_[0],S=_[1],T=r.left,C=r.top,R=r.target,j=r.direction,z=r.hasFixed,V=r.offsetDelta,I=t.targets,A=this.isDragging(),k={};this.getEnabledAbles().forEach(function(X){k["data-able-".concat(X.name.toLowerCase())]=!0});var O=this._getAbleClassName(),L=I&&I.length&&(R||p)||o||!this._hasFirstTarget&&this.state.isPersisted,B=this.controlBox||this.props.firstRenderState||this.props.persistData,M=[T-w,C-S];!p&&t.useAccuratePosition&&(M[0]+=V[0],M[1]+=V[1]);var Q={position:z?"fixed":"absolute",display:L?"block":"none",visibility:B?"visible":"hidden",transform:"translate3d(".concat(M[0],"px, ").concat(M[1],"px, ").concat(d,")"),"--zoom":c,"--zoompx":"".concat(c,"px")};return m&&(Q["--moveable-line-padding"]=m),b&&(Q["--moveable-control-padding"]=b),ha(h,W({cspNonce:u,ref:Ps(this,"controlBox"),className:"".concat(Ge("control-box",j===-1?"reverse":"",A?"dragging":"")," ").concat(O," ").concat(a)},k,{onClick:this._onPreventClick,style:Q}),this.renderAbles(),this._renderLines())},e.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var t=this.props,r=t.parentMoveable,i=t.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!r&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},e.prototype.componentDidUpdate=function(t){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(t)},e.prototype.componentWillUnmount=function(){var t,r;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(t=this._reiszeObserver)===null||t===void 0||t.disconnect(),(r=this._mutationObserver)===null||r===void 0||r.disconnect();var i=this._viewContainer;i&&this._changeAbleViewClassNames([]),Xu(this,!1),Xu(this,!0);var a=this.events;for(var o in a){var c=a[o];c&&c.destroy()}},e.prototype.getTargets=function(){var t=this.props.target;return t?[t]:[]},e.prototype.getAble=function(t){var r=this.props.ables||[];return ai(r,function(i){return i.name===t})},e.prototype.getContainer=function(){var t=this.props,r=t.parentMoveable,i=t.wrapperMoveable,a=t.container;return a||i&&i.getContainer()||r&&r.getContainer()||this.controlBox.parentElement},e.prototype.getControlBoxElement=function(){return this.controlBox},e.prototype.getDragElement=function(){return this._dragTarget},e.prototype.isMoveableElement=function(t){var r;return t&&(((r=t.getAttribute)===null||r===void 0?void 0:r.call(t,"class"))||"").indexOf(uS)>-1},e.prototype.dragStart=function(t,r){r===void 0&&(r=t.target);var i=this.targetGesto,a=this.controlGesto;return i&&RS(this)({inputEvent:t},r)?i.isFlag()||i.triggerDragStart(t):a&&this.isMoveableElement(r)&&(a.isFlag()||a.triggerDragStart(t)),this},e.prototype.hitTest=function(t){var r=this.state,i=r.target,a=r.pos1,o=r.pos2,c=r.pos3,u=r.pos4,d=r.targetClientRect;if(!i)return 0;var h;if($d(t)){var p=t.getBoundingClientRect();h={left:p.left,top:p.top,width:p.width,height:p.height}}else h=W({width:0,height:0},t);var m=h.left,b=h.top,_=h.width,w=h.height,S=ek([a,o,u,c],d),T=oQ(S,[[m,b],[m+_,b],[m+_,b+w],[m,b+w]]),C=$3(S);return!T||!C?0:Math.min(100,T/C*100)},e.prototype.isInside=function(t,r){var i=this.state,a=i.target,o=i.pos1,c=i.pos2,u=i.pos3,d=i.pos4,h=i.targetClientRect;return a?I_([t,r],ek([o,c,d,u],h)):!1},e.prototype.updateRect=function(t,r,i){i===void 0&&(i=!0);var a=this.props,o=!a.parentPosition&&!a.wrapperMoveable;o&&Cd(!0);var c=a.parentMoveable,u=this.state,d=u.target||a.target,h=this.getContainer(),p=c?c._rootContainer:this._rootContainer,m=H_(this.controlBox,d,h,h,p||h,this._getRequestStyles());if(!d&&this._hasFirstTarget&&a.persistData){var b=kk(a.persistData);for(var _ in b)m[_]=b[_]}o&&Cd(),this.updateState(m,c?!1:i)},e.prototype.isDragging=function(t){var r,i,a=this.targetGesto,o=this.controlGesto;if(a?.isFlag()){if(!t)return!0;var c=a.getEventData();return!!(!((r=c[t])===null||r===void 0)&&r.isEventStart)}if(o?.isFlag()){if(!t)return!0;var c=o.getEventData();return!!(!((i=c[t])===null||i===void 0)&&i.isEventStart)}return!1},e.prototype.updateTarget=function(t){this.updateRect(t,!0)},e.prototype.getRect=function(){var t=this.state,r=Qi(this.state),i=J(r,4),a=i[0],o=i[1],c=i[2],u=i[3],d=Xi(r),h=t.width,p=t.height,m=d.width,b=d.height,_=d.left,w=d.top,S=[t.left,t.top],T=Nt(S,t.origin),C=Nt(S,t.beforeOrigin),R=t.transformOrigin;return{width:m,height:b,left:_,top:w,pos1:a,pos2:o,pos3:c,pos4:u,offsetWidth:h,offsetHeight:p,beforeOrigin:C,origin:T,transformOrigin:R,rotation:this.getRotation()}},e.prototype.getManager=function(){return this},e.prototype.stopDrag=function(t){if(!t||t==="target"){var r=this.targetGesto;r?.isIdle()===!1&&F_(this,!1),r?.stop()}if(!t||t==="control"){var r=this.controlGesto;r?.isIdle()===!1&&F_(this,!0),r?.stop()}},e.prototype.getRotation=function(){var t=this.state,r=t.pos1,i=t.pos2,a=t.direction;return fJ(r,i,a)},e.prototype.request=function(t,r,i){r===void 0&&(r={});var a=this,o=a.props,c=o.parentMoveable||o.wrapperMoveable||a,u=c.props.ables,d=o.groupable,h=ai(u,function(T){return T.name===t});if(this.isDragging()||!h||!h.request)return{request:function(){return this},requestEnd:function(){return this}};var p=h.request(a),m=i||r.isInstant,b=p.isControl?"controlAbles":"targetAbles",_="".concat(d?"Group":"").concat(p.isControl?"Control":""),w=Ae([],J(c[b]),!1),S={request:function(T){return Oh(a,w,["drag"],_,"",W(W({},p.request(T)),{requestAble:t,isRequest:!0}),m),S},requestEnd:function(){return Oh(a,w,["drag"],_,"End",W(W({},p.requestEnd()),{requestAble:t,isRequest:!0}),m),S}};return Oh(a,w,["drag"],_,"Start",W(W({},p.requestStart(r)),{requestAble:t,isRequest:!0}),m),m?S.request(r).requestEnd():S},e.prototype.getMoveables=function(){return[this]},e.prototype.destroy=function(){this.componentWillUnmount()},e.prototype.updateRenderPoses=function(){var t=this.getState(),r=this.props,i=r.padding,a=t.originalBeforeOrigin,o=t.transformOrigin,c=t.allMatrix,u=t.is3d,d=t.pos1,h=t.pos2,p=t.pos3,m=t.pos4,b=t.left,_=t.top,w=t.isPersisted,S=r.zoom||1;if(!i&&S<=1){t.renderPoses=[d,h,p,m],t.renderLines=[[d,h],[h,m],[m,p],[p,d]];return}var T=$V(i||{}),C=T.left,R=T.top,j=T.bottom,z=T.right,V=u?4:3,I=[];w?I=o:this.controlBox&&r.groupable?I=a:I=Nt(a,[b,_]);var A=iv(V,kc(I.map(function(Q){return-Q}),V),c,kc(o,V)),k=zi(A,d,[-C,-R],V),O=zi(A,h,[z,-R],V),L=zi(A,p,[-C,j],V),B=zi(A,m,[z,j],V);t.renderPoses=[k,O,L,B],t.renderLines=[[k,O],[O,B],[B,L],[L,k]];{var M=S/2;t.renderLines=[[zi(A,d,[-C-M,-R],V),zi(A,h,[z+M,-R],V)],[zi(A,h,[z,-R-M],V),zi(A,m,[z,j+M],V)],[zi(A,m,[z+M,j],V),zi(A,p,[-C-M,j],V)],[zi(A,p,[-C,j+M],V),zi(A,d,[-C,-R-M],V)]]}},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var t=this.props,r=t.target,i=t.container,a=t.parentMoveable,o=this.state,c=o.target,u=o.container;if(!(!c&&!r)){this.updateAbles();var d=!G_(c,r),h=d||!G_(u,i);if(h){var p=i||this.controlBox;p&&this.unsetAbles(),this.updateState({target:r,container:i}),!a&&p&&this.updateRect("End",!1,!1),this._isPropTargetChanged=d}}},e.prototype.waitToChangeTarget=function(){return new Promise(function(){})},e.prototype.triggerEvent=function(t,r){var i=this.props;if(this._emitter.trigger(t,r),i.parentMoveable&&r.isRequest&&!r.isRequestChild)return i.parentMoveable.triggerEvent(t,r,!0);var a=i[t];return a&&a(r)},e.prototype.useCSS=function(t,r){var i=this.props.customStyledMap,a=t+r;return i[a]||(i[a]=X3(t,r)),i[a]},e.prototype.getState=function(){var t,r=this.props;(r.target||!((t=r.targets)===null||t===void 0)&&t.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,a=r.persistData,o=r.firstRenderState;if(o&&!i)return o;if(!this._hasFirstTarget&&a){var c=kk(a);if(c)return this.updateState(c,!1),this.state}return this.state.isPersisted=!1,this.state},e.prototype.updateSelectors=function(){},e.prototype.unsetAbles=function(){var t=this;this.targetAbles.forEach(function(r){r.unset&&r.unset(t)})},e.prototype.updateAbles=function(t,r){t===void 0&&(t=this.props.ables),r===void 0&&(r="");var i=this.props,a=i.triggerAblesSimultaneously,o=this.getEnabledAbles(t),c="drag".concat(r,"Start"),u="pinch".concat(r,"Start"),d="drag".concat(r,"ControlStart"),h=$m(o,[c,u],a),p=$m(o,[d],a);this.enabledAbles=o,this.targetAbles=h,this.controlAbles=p},e.prototype.updateState=function(t,r){if(r){if(this.isUnmounted)return;this.setState(t)}else{var i=this.state;for(var a in t)i[a]=t[a]}},e.prototype.getEnabledAbles=function(t){t===void 0&&(t=this.props.ables);var r=this.props;return t.filter(function(i){return i&&(i.always&&r[i.name]!==!1||r[i.name])})},e.prototype.renderAbles=function(){var t=this,r=this.props,i=r.triggerAblesSimultaneously,a={createElement:ha};return this.renderState={},lJ(FV($m(this.getEnabledAbles(),["render"],i).map(function(o){var c=o.render;return c(t,a)||[]})).filter(function(o){return o}),function(o){var c=o.key;return c}).map(function(o){return o[0]})},e.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},e.prototype._getRequestStyles=function(){var t=this.getEnabledAbles().reduce(function(r,i){var a,o,c=(o=(a=i.requestStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return Ae(Ae([],J(r),!1),J(c),!1)},Ae([],J(this.props.requestStyles||[]),!1));return t},e.prototype._updateObserver=function(t){this._updateResizeObserver(t),this._updateMutationObserver(t)},e.prototype._updateEvents=function(){var t=this.targetAbles.length,r=this.controlAbles.length,i=this._dragTarget,a=!t&&this.targetGesto||this._isTargetChanged(!0);a&&(Xu(this,!1),this.updateState({gestos:{}})),r||Xu(this,!0),i&&t&&!this.targetGesto&&(this.targetGesto=t5(this,i,"")),!this.controlGesto&&r&&(this.controlGesto=n5(this,"Control"))},e.prototype._updateTargets=function(){var t=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=t.dragArea,this._propTarget=t.target,this._originalDragTarget=t.dragTarget||t.target,this._dragTarget=Ja(this._originalDragTarget,!0)},e.prototype._renderLines=function(){var t=this.props,r=t,i=r.zoom,a=r.hideDefaultLines,o=r.hideChildMoveableDefaultLines,c=r.parentMoveable;if(a||c&&o)return[];var u=this.getState(),d={createElement:ha};return u.renderLines.map(function(h,p){return dp(d,"",h[0],h[1],i,"render-line-".concat(p))})},e.prototype._isTargetChanged=function(t){var r=this.props,i=r.dragTarget||r.target,a=this._prevOriginalDragTarget,o=this._prevDragArea,c=r.dragArea,u=!c&&a!==i,d=(t||c)&&o!==c;return u||d||this._prevPropTarget!=this._propTarget},e.prototype._updateNativeEvents=function(){var t=this,r=this.props,i=r.dragArea?this.areaElement:this.state.target,a=this.events,o=$s(a);if(this._isTargetChanged())for(var c in a){var u=a[c];u&&u.destroy(),a[c]=null}if(i){var d=this.enabledAbles;o.forEach(function(h){var p=$m(d,[h]),m=p.length>0,b=a[h];if(!m){b&&(b.destroy(),a[h]=null);return}b||(b=new UJ(i,t,h),a[h]=b),b.setAbles(p)})}},e.prototype._checkUpdateRootContainer=function(){var t=this.props.rootContainer;!this._rootContainer&&t&&(this._rootContainer=Ja(t,!0))},e.prototype._checkUpdateViewContainer=function(){var t=this.props.viewContainer;!this._viewContainer&&t&&(this._viewContainer=Ja(t,!0));var r=this._viewContainer;r&&this._changeAbleViewClassNames(Ae(Ae([],J(this._getAbleViewClassNames()),!1),[this.isDragging()?bJ:""],!1))},e.prototype._changeAbleViewClassNames=function(t){var r=this._viewContainer,i=UV(t.filter(Boolean),function(d){return d}).map(function(d){var h=J(d,1),p=h[0];return p}),a=this._viewClassNames,o=qp(a,i),c=o.removed,u=o.added;c.forEach(function(d){x3(r,a[d])}),u.forEach(function(d){b3(r,i[d])}),this._viewClassNames=i},e.prototype._getAbleViewClassNames=function(){var t=this;return(this.getEnabledAbles().map(function(r){var i;return((i=r.viewClassName)===null||i===void 0?void 0:i.call(r,t))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},e.prototype._getAbleClassName=function(t){var r=this;t===void 0&&(t="");var i=this.getEnabledAbles(),a=this.targetGesto,o=this.controlGesto,c=a?.isFlag()?a.getEventData():{},u=o?.isFlag()?o.getEventData():{};return i.map(function(d){var h,p,m,b=d.name,_=((h=d.className)===null||h===void 0?void 0:h.call(d,r))||"";return(!((p=c[b])===null||p===void 0)&&p.isEventStart||!((m=u[b])===null||m===void 0)&&m.isEventStart)&&(_+=" ".concat(Ge("".concat(b).concat(t,"-dragging")))),_.trim()}).filter(Boolean).join(" ")},e.prototype._updateResizeObserver=function(t){var r,i=this.props,a=i.target,o=nl(this.getControlBoxElement());if(!o.ResizeObserver||!a||!i.useResizeObserver){(r=this._reiszeObserver)===null||r===void 0||r.disconnect();return}if(!(t.target===a&&this._reiszeObserver)){var c=new o.ResizeObserver(this.checkUpdateRect);c.observe(a,{box:"border-box"}),this._reiszeObserver=c}},e.prototype._updateMutationObserver=function(t){var r=this,i,a=this.props,o=a.target,c=nl(this.getControlBoxElement());if(!c.MutationObserver||!o||!a.useMutationObserver){(i=this._mutationObserver)===null||i===void 0||i.disconnect();return}if(!(t.target===o&&this._mutationObserver)){var u=new c.MutationObserver(function(d){var h,p;try{for(var m=SQ(d),b=m.next();!b.done;b=m.next()){var _=b.value;_.type==="attributes"&&_.attributeName==="style"&&r.checkUpdateRect()}}catch(w){h={error:w}}finally{try{b&&!b.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}});u.observe(o,{attributes:!0}),this._mutationObserver=u}},e.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:kV,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},e})(C3),DS={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(n,e){var t,r=n.props,i=r.targets||[],a=n.getState(),o=a.left,c=a.top,u=a.isPersisted,d=r.zoom||1,h=n.renderGroupRects,p=((t=r.persistData)===null||t===void 0?void 0:t.children)||[];u?i=p.map(function(){return null}):p=[];var m=Wu(n,"parentPosition",[o,c],function(_){return _.join(",")}),b=Wu(n,"requestStyles",n.getRequestChildStyles(),function(_){return _.join(",")});return n.moveables=n.moveables.slice(0,i.length),Ae(Ae([],J(i.map(function(_,w){return e.createElement(Dd,{key:"moveable"+w,ref:d3(n,"moveables",w),target:_,origin:!1,requestStyles:b,cssStyled:r.cssStyled,customStyledMap:r.customStyledMap,useResizeObserver:r.useResizeObserver,useMutationObserver:r.useMutationObserver,hideChildMoveableDefaultLines:r.hideChildMoveableDefaultLines,parentMoveable:n,parentPosition:[o,c],persistData:p[w],zoom:d})})),!1),J(FV(h.map(function(_,w){var S=_.pos1,T=_.pos2,C=_.pos3,R=_.pos4,j=[S,T,C,R];return[[0,1],[1,3],[3,2],[2,0]].map(function(z,V){var I=J(z,2),A=I[0],k=I[1];return dp(e,"",$e(j[A],m),$e(j[k],m),d,"group-rect-".concat(w,"-").concat(V))})}))),!1)}},qJ=Wp("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(n,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(n,e){var t=n.props.target,r=e.inputEvent,i=e.inputTarget,a=n.isMoveableElement(i),o=!a&&n.controlBox.contains(i);if(!(!r||!i||e.isDrag||n.isMoveableElement(i)||o)){var c=t.contains(i);Pe(n,"onClick",mt(n,e,{isDouble:e.isDouble,inputTarget:i,isTarget:t===i,moveableTarget:n.props.target,containsTarget:c}))}},dragGroupEnd:function(n,e){var t=e.inputEvent,r=e.inputTarget;if(!(!t||!r||e.isDrag||n.isMoveableElement(r)||e.datas.inputTarget===r)){var i=n.props.targets,a=i.indexOf(r),o=a>-1,c=!1;a===-1&&(a=Hs(i,function(u){return u.contains(r)}),c=a>-1),Pe(n,"onClickGroup",mt(n,e,{isDouble:e.isDouble,targets:i,inputTarget:r,targetIndex:a,isTarget:o,containsTarget:c,moveableTarget:i[a]}))}},dragControlEnd:function(n,e){this.dragEnd(n,e)},dragGroupControlEnd:function(n,e){this.dragEnd(n,e)}});function Mu(n){var e=n.originalDatas.draggable;return e||(n.originalDatas.draggable={},e=n.originalDatas.draggable),W(W({},n),{datas:e})}var HJ=Wp("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(n,e){var t=n.props,r=t.edgeDraggable;return r?dV(e,"edgeDraggable",r,n.getState().renderPoses,t.zoom):[]},dragCondition:function(n,e){var t,r=n.props,i=(t=e.inputEvent)===null||t===void 0?void 0:t.target;return!r.edgeDraggable||!i?!1:!r.draggable&&ir(i,Ge("direction"))&&ir(i,Ge("edge"))&&ir(i,Ge("edgeDraggable"))},dragStart:function(n,e){return Br.dragStart(n,Mu(e))},drag:function(n,e){return Br.drag(n,Mu(e))},dragEnd:function(n,e){return Br.dragEnd(n,Mu(e))},dragGroupCondition:function(n,e){var t,r=n.props,i=(t=e.inputEvent)===null||t===void 0?void 0:t.target;return!r.edgeDraggable||!i?!1:!r.draggable&&ir(i,Ge("direction"))&&ir(i,Ge("line"))},dragGroupStart:function(n,e){return Br.dragGroupStart(n,Mu(e))},dragGroup:function(n,e){return Br.dragGroup(n,Mu(e))},dragGroupEnd:function(n,e){return Br.dragGroupEnd(n,Mu(e))},unset:function(n){return Br.unset(n)}}),i5={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},kS=[JV,XV,XZ,pJ,Br,HJ,z_,gJ,vJ,kZ,wJ,EJ,xJ,OJ,PJ,LJ,DS,i5,qJ,KV,e5],$J=kS.reduce(function(n,e){return(e.events||[]).forEach(function(t){y3(n,t)}),n},[]),YJ=kS.reduce(function(n,e){return(e.props||[]).forEach(function(t){y3(n,t)}),n},[]);function Nk(n,e){var t=J(n,3),r=t[0],i=t[1],a=t[2];return(r*e[0]+i*e[1]+a)/Math.sqrt(r*r+i*i)}function Xm(n,e){var t=J(n,2),r=t[0],i=t[1];return-r*e[0]-i*e[1]}function Mk(n,e){return Math.max.apply(Math,Ae([],J(n.map(function(t){var r=J(t,4),i=r[0],a=r[1],o=r[2],c=r[3];return Math.max(i[e],a[e],o[e],c[e])})),!1))}function Pk(n,e){return Math.min.apply(Math,Ae([],J(n.map(function(t){var r=J(t,4),i=r[0],a=r[1],o=r[2],c=r[3];return Math.min(i[e],a[e],o[e],c[e])})),!1))}function KJ(n,e){var t,r,i,a=[0,0],o=[0,0],c=[0,0],u=[0,0],d=0,h=0;if(!n.length)return{pos1:a,pos2:o,pos3:c,pos4:u,minX:0,minY:0,maxX:0,maxY:0,width:d,height:h,rotation:e};var p=ct(e,$r);if(p%90){var m=p/180*Math.PI,b=Math.tan(m),_=-1/b,w=[P_,rk],S=[[0,0],[0,0]],T=[P_,rk],C=[[0,0],[0,0]];n.forEach(function(ne){ne.forEach(function(ie){var te=Nk([-b,1,0],ie),se=Nk([-_,1,0],ie);w[0]>te&&(S[0]=ie,w[0]=te),w[1]<te&&(S[1]=ie,w[1]=te),T[0]>se&&(C[0]=ie,T[0]=se),T[1]<se&&(C[1]=ie,T[1]=se)})});var R=J(S,2),j=R[0],z=R[1],V=J(C,2),I=V[0],A=V[1],k=[-b,1,Xm([-b,1],j)],O=[-b,1,Xm([-b,1],z)],L=[-_,1,Xm([-_,1],I)],B=[-_,1,Xm([-_,1],A)];t=J([[k,L],[k,B],[O,L],[O,B]].map(function(ne){var ie=J(ne,2),te=ie[0],se=ie[1];return lS(te,se)[0]}),4),a=t[0],o=t[1],c=t[2],u=t[3],d=T[1]-T[0],h=w[1]-w[0]}else{var M=Pk(n,0),Q=Pk(n,1),X=Mk(n,0),$=Mk(n,1);if(a=[M,Q],o=[X,Q],c=[M,$],u=[X,$],d=X-M,h=$-Q,p%180){var H=[c,a,u,o];r=J(H,4),a=r[0],o=r[1],c=r[2],u=r[3],d=$-Q,h=X-M}}if(p%360>180){var H=[u,c,o,a];i=J(H,4),a=i[0],o=i[1],c=i[2],u=i[3]}var Z=Nc([a,o,c,u]),re=Z.minX,de=Z.minY,U=Z.maxX,Y=Z.maxY;return{pos1:a,pos2:o,pos3:c,pos4:u,width:d,height:h,minX:re,minY:de,maxX:U,maxY:Y,rotation:e}}function a5(n,e){var t=e.map(function(r){if(Wn(r)){var i=a5(n,r),a=i.length;return a>1?i:a===1?i[0]:null}else{var o=ai(n,function(c){var u=c.manager;return u.props.target===r});return o?(o.finded=!0,o.manager):null}}).filter(Boolean);return t.length===1&&Wn(t[0])?t[0]:t}var XJ=(function(n){Xp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.differ=new H3,t.moveables=[],t.transformOrigin="50% 50%",t.renderGroupRects=[],t._targetGroups=[],t._hasFirstTargets=!1,t}return e.prototype.componentDidMount=function(){n.prototype.componentDidMount.call(this)},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(t,r,i){var a;i===void 0&&(i=!0);var o=this.state;if(!this.controlBox||o.isPersisted)return;Cd(!0),this.moveables.forEach(function(Te){Te.updateRect(t,!1,!1)});var c=this.props,u=this.moveables,d=o.target||c.target,h=u.map(function(Te){return{finded:!1,manager:Te}}),p=this.props.targetGroups||[],m=a5(h,p),b=c.useDefaultGroupRotate;m.push.apply(m,Ae([],J(h.filter(function(Te){var Ce=Te.finded;return!Ce}).map(function(Te){var Ce=Te.manager;return Ce})),!1));var _=[],w=!r||t!==""&&c.updateGroup,S=c.defaultGroupRotate||0;if(!this._hasFirstTargets){var T=(a=c.persistData)===null||a===void 0?void 0:a.rotation;T!=null&&(S=T)}function C(Te,Ce,Ne){var xe=Te.map(function(yt){if(Wn(yt)){var Ve=C(yt,Ce),Ke=[Ve.pos1,Ve.pos2,Ve.pos3,Ve.pos4];return _.push(Ve),{poses:Ke,rotation:Ve.rotation}}else return{poses:Qi(yt.state),rotation:yt.getRotation()}}),Ee=xe.map(function(yt){var Ve=yt.rotation;return Ve}),Qe=0,Oe=Ee[0],Be=Ee.every(function(yt){return Math.abs(Oe-yt)<.1});w?Qe=!b&&Be?Oe:S:Qe=!b&&!Ne&&Be?Oe:Ce;var ze=xe.map(function(yt){var Ve=yt.poses;return Ve}),st=KJ(ze,Qe);return st}var R=C(m,this.rotation,!0);w&&(this.rotation=R.rotation,this.transformOrigin=c.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=p,this.renderGroupRects=_;var j=this.transformOrigin,z=this.rotation,V=this.scale,I=R.width,A=R.height,k=R.minX,O=R.minY,L=hJ([[0,0],[I,0],[0,A],[I,A]],AS(j,I,A),this.rotation/180*Math.PI),B=Nc(L.result),M=B.minX,Q=B.minY,X=" rotate(".concat(z,"deg)")+" scale(".concat(Ur(V[0]),", ").concat(Ur(V[1]),")"),$="translate(".concat(-M,"px, ").concat(-Q,"px)").concat(X);this.controlBox.style.transform="translate3d(".concat(k,"px, ").concat(O,"px, ").concat(this.props.translateZ||0,")"),d.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(j,";")+"width:".concat(I,"px;height:").concat(A,"px;")+"transform: ".concat($),o.width=I,o.height=A;var H=this.getContainer(),Z=H_(this.controlBox,d,this.controlBox,this.getContainer(),this._rootContainer||H,[]),re=[Z.left,Z.top],de=J(Qi(Z),4),U=de[0],Y=de[1],ne=de[2],ie=de[3],te=Nc([U,Y,ne,ie]),se=[te.minX,te.minY],me=Ur(V[0]*V[1]);Z.pos1=$e(U,se),Z.pos2=$e(Y,se),Z.pos3=$e(ne,se),Z.pos4=$e(ie,se),Z.left=k-Z.left+se[0],Z.top=O-Z.top+se[1],Z.origin=$e(Nt(re,Z.origin),se),Z.beforeOrigin=$e(Nt(re,Z.beforeOrigin),se),Z.originalBeforeOrigin=Nt(re,Z.originalBeforeOrigin),Z.transformOrigin=$e(Nt(re,Z.transformOrigin),se),d.style.transform="translate(".concat(-M-se[0],"px, ").concat(-Q-se[1],"px)")+X,Cd(),this.updateState(W(W({},Z),{posDelta:se,direction:me,beforeDirection:me}),i)},e.prototype.getRect=function(){return W(W({},n.prototype.getRect.call(this)),{children:this.moveables.map(function(t){return t.getRect()})})},e.prototype.triggerEvent=function(t,r,i){if(i||t.indexOf("Group")>-1)return n.prototype.triggerEvent.call(this,t,r);this._emitter.trigger(t,r)},e.prototype.getRequestChildStyles=function(){var t=this.getEnabledAbles().reduce(function(r,i){var a,o,c=(o=(a=i.requestChildStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return Ae(Ae([],J(r),!1),J(c),!1)},[]);return t},e.prototype.getMoveables=function(){return Ae([],J(this.moveables),!1)},e.prototype.updateAbles=function(){n.prototype.updateAbles.call(this,Ae(Ae([],J(this.props.ables),!1),[DS],!1),"Group")},e.prototype._updateTargets=function(){n.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=Ja(this._originalDragTarget,!0)},e.prototype._updateEvents=function(){var t=this.state,r=this.props,i=this._prevDragTarget,a=r.dragTarget||this.areaElement,o=r.targets,c=this.differ.update(o),u=c.added,d=c.changed,h=c.removed,p=u.length||h.length;(p||this._prevOriginalDragTarget!==this._originalDragTarget)&&(Xu(this,!1),Xu(this,!0),this.updateState({gestos:{}})),i!==a&&(t.target=null),t.target||(t.target=this.areaElement,this.controlBox.style.display="block"),t.target&&(this.targetGesto||(this.targetGesto=t5(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=n5(this,"GroupControl")));var m=!G_(t.container,r.container);m&&(t.container=r.container),(m||p||this.transformOrigin!==(r.defaultGroupOrigin||"50% 50%")||d.length||o.length&&!HV(this._targetGroups,r.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!p},e.prototype._updateObserver=function(){},e.defaultProps=W(W({},Dd.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e})(Dd),WJ=(function(n){Xp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.moveables=[],t}return e.prototype.render=function(){var t=this,r,i=this.props,a=i.cspNonce,o=i.cssStyled,c=i.persistData,u=i.targets||[],d=u.length,h=this.isUnmounted||!d,p=(r=c?.children)!==null&&r!==void 0?r:[];return h&&!d&&p.length?u=p.map(function(){return null}):h||(p=[]),ha(o,{cspNonce:a,ref:Ps(this,"controlBox"),className:Ge("control-box")},u.map(function(m,b){var _,w,S=(w=(_=i.individualGroupableProps)===null||_===void 0?void 0:_.call(i,m,b))!==null&&w!==void 0?w:{};return ha(Dd,W({key:"moveable"+b,ref:d3(t,"moveables",b)},i,S,{target:m,wrapperMoveable:t,isWrapperMounted:t.isMoveableMounted,persistData:p[b]}))}))},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(t,r,i){i===void 0&&(i=!0),Cd(!0),this.moveables.forEach(function(a){a.updateRect(t,r,i)}),Cd()},e.prototype.getRect=function(){return W(W({},n.prototype.getRect.call(this)),{children:this.moveables.map(function(t){return t.getRect()})})},e.prototype.request=function(t,r,i){r===void 0&&(r={});var a=this.moveables.map(function(u){return u.request(t,W(W({},r),{isInstant:!1}),!1)}),o=i||r.isInstant,c={request:function(u){return a.forEach(function(d){return d.request(u)}),this},requestEnd:function(){return a.forEach(function(u){return u.requestEnd()}),this}};return o?c.request(r).requestEnd():c},e.prototype.dragStart=function(t,r){r===void 0&&(r=t.target);var i=r,a=ai(this.moveables,function(o){var c=o.getTargets()[0],u=o.getControlBoxElement(),d=o.getDragElement();return!c||!d?!1:d===i||d.contains(i)||d!==c&&c===i||c.contains(i)||u===i||u.contains(i)});return a&&a.dragStart(t,r),this},e.prototype.hitTest=function(){return 0},e.prototype.isInside=function(){return!1},e.prototype.isDragging=function(){return!1},e.prototype.getDragElement=function(){return null},e.prototype.getMoveables=function(){return Ae([],J(this.moveables),!1)},e.prototype.updateRenderPoses=function(){},e.prototype.checkUpdate=function(){},e.prototype.triggerEvent=function(){},e.prototype.updateAbles=function(){},e.prototype._updateEvents=function(){},e.prototype._updateObserver=function(){},e})(Dd);function s5(n,e){var t=[];return n.forEach(function(r){if(r){if(ii(r)){e[r]&&t.push.apply(t,Ae([],J(e[r]),!1));return}Wn(r)?t.push.apply(t,Ae([],J(s5(r,e)),!1)):t.push(r)}}),t}function o5(n,e){var t=[];return n.forEach(function(r){if(r){if(ii(r)){e[r]&&t.push.apply(t,Ae([],J(e[r]),!1));return}Wn(r)?t.push(o5(r,e)):t.push(r)}}),t}function l5(n,e){return n.length!==e.length||n.some(function(t,r){var i=e[r];return!t&&!i?!1:t!=i?Wn(t)&&Wn(i)?l5(t,i):!0:!1})}var QJ=(function(n){Xp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.refTargets=[],t.selectorMap={},t._differ=new H3,t._elementTargets=[],t._tmpRefTargets=[],t._tmpSelectorMap={},t._onChangeTargets=null,t}return e.makeStyled=function(){var t={},r=this.getTotalAbles();r.forEach(function(a){var o=a.css;o&&o.forEach(function(c){t[c]=!0})});var i=$s(t).join(`
`);this.defaultStyled=X3("div",$X(uS,OQ+i))},e.getTotalAbles=function(){return Ae([XV,DS,i5,KV],J(this.defaultAbles),!1)},e.prototype.render=function(){var t,r=this.constructor;r.defaultStyled||r.makeStyled();var i=this.props,a=i.ables,o=i.props,c=wQ(i,["ables","props"]),u=J(this._updateRefs(!0),2),d=u[0],h=u[1],p=s5(d,h),m=p.length>1,b=r.getTotalAbles(),_=Ae(Ae([],J(b),!1),J(a||[]),!1),w=W(W(W({},c),o||{}),{ables:_,cssStyled:r.defaultStyled,customStyledMap:r.customStyledMap});this._elementTargets=p;var S=null,T=this.moveable,C=c.persistData;if(C?.children&&(m=!0),c.individualGroupable)return ha(WJ,W({key:"individual-group",ref:Ps(this,"moveable")},w,{target:null,targets:p}));if(m){var R=o5(d,h);if(T&&!T.props.groupable&&!T.props.individualGroupable){var j=T.props.target;j&&p.indexOf(j)>-1&&(S=W({},T.state))}return ha(XJ,W({key:"group",ref:Ps(this,"moveable")},w,(t=c.groupableProps)!==null&&t!==void 0?t:{},{target:null,targets:p,targetGroups:R,firstRenderState:S}))}else{var z=p[0];if(T&&(T.props.groupable||T.props.individualGroupable)){var V=T.moveables||[],I=ai(V,function(A){return A.props.target===z});I&&(S=W({},I.state))}return ha(Dd,W({key:"single",ref:Ps(this,"moveable")},w,{target:z,firstRenderState:S}))}},e.prototype.componentDidMount=function(){this._checkChangeTargets()},e.prototype.componentDidUpdate=function(){this._checkChangeTargets()},e.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},e.prototype.getTargets=function(){var t,r;return(r=(t=this.moveable)===null||t===void 0?void 0:t.getTargets())!==null&&r!==void 0?r:[]},e.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs(),this.forceUpdate()},e.prototype.waitToChangeTarget=function(){var t=this,r;return this._onChangeTargets=function(){t._onChangeTargets=null,r()},new Promise(function(i){r=i})},e.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},e.prototype.getManager=function(){return this.moveable},e.prototype.getMoveables=function(){return this.moveable.getMoveables()},e.prototype.getDragElement=function(){return this.moveable.getDragElement()},e.prototype._updateRefs=function(t){var r=this.refTargets,i=TS(this.props.target||this.props.targets),a=typeof document<"u",o=l5(r,i),c=this.selectorMap,u={};return this.refTargets.forEach(function d(h){if(ii(h)){var p=c[h];p?u[h]=c[h]:a&&(o=!0,u[h]=[].slice.call(document.querySelectorAll(h)))}else Wn(h)&&h.forEach(d)}),this._tmpRefTargets=i,this._tmpSelectorMap=u,[i,u,!t&&o]},e.prototype._checkChangeTargets=function(){var t,r,i;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var a=this._differ.update(this._elementTargets),o=a.added,c=a.removed,u=o.length||c.length;u&&((r=(t=this.props).onChangeTargets)===null||r===void 0||r.call(t,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this));var d=J(this._updateRefs(),3),h=d[0],p=d[1],m=d[2];this.refTargets=h,this.selectorMap=p,m&&this.forceUpdate()},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,EQ([YX(tV)],e.prototype,"moveable",void 0),e})(C3),ZJ=(function(n){Xp(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.defaultAbles=kS,e})(QJ),$_=function(n,e){return $_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},$_(n,e)};function NS(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");$_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var hp=function(){return hp=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},hp.apply(this,arguments)};function JJ(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}var eee=(function(n){NS(e,n);function e(r){var i=n.call(this,r)||this;return i.state={},i.state=i.props,i}var t=e.prototype;return t.render=function(){return ha(ZJ,hp({ref:Ps(this,"moveable")},this.state))},e})(nS),tee=YJ,nee=tV,ree=$J,iee=(function(n){NS(e,n);function e(r,i){i===void 0&&(i={});var a=n.call(this)||this;a.containerProvider=null,a.selfElement=null,a._warp=!1;var o=hp({},i),c={};ree.forEach(function(h){c[rW("on ".concat(h))]=function(p){return a.trigger(h,p)}});var u;i.warpSelf?(delete i.warpSelf,a._warp=!0,u=r):(u=Hd(r).createElement("div"),r.appendChild(u)),a.containerProvider=QD(ha(eee,hp({ref:Ps(a,"innerMoveable")},o,c)),u),a.selfElement=u;var d=o.target;return Wn(d)&&d.length>1&&a.updateRect(),a}var t=e.prototype;return t.setState=function(r,i){this.innerMoveable.setState(r,i)},t.forceUpdate=function(r){this.innerMoveable.forceUpdate(r)},t.dragStart=function(r,i){i===void 0&&(i=r.target);var a=this.innerMoveable;a.$_timer&&this.forceUpdate(),this.getMoveable().dragStart(r,i)},t.destroy=function(){var r,i=this.selfElement;QD(null,i,this.containerProvider),this._warp||(r=i?.parentElement)===null||r===void 0||r.removeChild(i),this.containerProvider=null,this.off(),this.selfElement=null,this.innerMoveable=null},t.getMoveable=function(){return this.innerMoveable.moveable},e=JJ([FD(nee,function(r,i){r[i]||(r[i]=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];var c=this.getMoveable();if(!(!c||!c[i]))return c[i].apply(c,a)})}),FD(tee,function(r,i){Object.defineProperty(r,i,{get:function(){return this.getMoveable().props[i]},set:function(a){var o;this.setState((o={},o[i]=a,o))},enumerable:!0,configurable:!0})})],e),e})(ey),Ok=(function(n){NS(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e})(iee);const c5=n=>n?n instanceof Date?n:typeof n=="string"?new Date(n):typeof n=="number"?new Date(n):n?.toDate&&typeof n.toDate=="function"?n.toDate():new Date:new Date,nr=n=>c5(n).toISOString(),aee=n=>{const e=c5(n);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`},see=n=>{const e=n.toLowerCase();return e==="income"?"Income":e==="expense"?"Expense":e==="transfer"?"Transfer":"Expense"},MS=n=>{const e=n;let t=0;typeof e.amount=="number"?t=e.amount:typeof e.amount=="string"&&(t=parseFloat(e.amount)),isNaN(t)&&(t=0);const r=nr(e.date);return{id:e.id||"",userId:e.userId||"",envelopeId:e.envelopeId||"",amount:t,date:r,month:e.month||aee(r),description:e.description||"",merchant:e.merchant||void 0,type:see(e.type||"expense"),reconciled:e.reconciled??!1,transferId:e.transferId||void 0,isAutomatic:e.isAutomatic||void 0,paymentMethod:e.paymentMethod?typeof e.paymentMethod=="string"?{id:e.paymentMethod,name:e.paymentMethod,network:"Visa",last4:"****",color:"#000000"}:e.paymentMethod:void 0}};class uc{static instance;static getInstance(){return uc.instance||(uc.instance=new uc),uc.instance}async restoreUserData(e,t){try{console.log(" BudgetService.restoreUserData: STARTING RESTORE for user:",e),await this.deleteAllUserData(e);const r=[{name:"envelopes",data:t.envelopes||[]},{name:"transactions",data:t.transactions||[]},{name:"incomeSources",data:t.incomeSources?Object.values(t.incomeSources).flat():[]},{name:"envelopeAllocations",data:t.allocations?Object.values(t.allocations).flat():[]},{name:"appSettings",data:t.appSettings?[t.appSettings]:[]}],i=[];for(const{name:o,data:c}of r)if(Array.isArray(c))for(const u of c){if(!u.id)continue;const d={...u,userId:e},h=u.id,p=gt(We,"users",e,o,h);i.push({ref:p,data:d})}console.log(` Prepared ${i.length} items for restoration.`);const a=450;for(let o=0;o<i.length;o+=a){const c=eH(We);i.slice(o,o+a).forEach(d=>{c.set(d.ref,d.data)}),console.log(` Committing batch ${Math.floor(o/a)+1}/${Math.ceil(i.length/a)}...`),await c.commit()}console.log(" Restore completed successfully.")}catch(r){throw console.error(" BudgetService.restoreUserData failed:",r),new Error(`Failed to restore user data: ${r instanceof Error?r.message:"Unknown error"}`)}}async getEnvelopes(e){try{console.log(" BudgetService.getEnvelopes called for user:",e);const t=Bi(We,"users",e,"envelopes"),a=(await Ba(t)).docs.map((o,c)=>({id:o.id,...o.data(),orderIndex:o.data().orderIndex??c})).sort((o,c)=>{const u=o.orderIndex??0,d=c.orderIndex??0;return u-d});return console.log(" Fetched envelopes:",a.length),a}catch(t){throw console.error(" BudgetService.getEnvelopes failed:",t),new Error(`Failed to fetch envelopes: ${t instanceof Error?t.message:"Unknown error"}`)}}async getTransactions(e){try{console.log(" BudgetService.getTransactions: Fetching for user",e);const t=Bi(We,"users",e,"transactions"),r=Fs(t,_d("date","desc")),a=(await Ba(r)).docs.map(o=>{const c={id:o.id,...o.data()};return MS(c)});return console.log(` Fetched ${a.length} transactions`),a}catch(t){throw console.error(" BudgetService.getTransactions failed:",t),new Error(`Failed to fetch transactions: ${t instanceof Error?t.message:"Unknown error"}`)}}async createEnvelope(e){try{console.log(" BudgetService.createEnvelope called for user:",e.userId);const t=Bi(We,"users",e.userId,"envelopes"),r=gt(t),i=et.now(),a={...e,createdAt:i,lastUpdated:i};Ui(r,a).catch(c=>console.error("Create env failed",c));const o={...e,id:r.id,createdAt:nr(i),lastUpdated:nr(i)};return console.log(" Created envelope (optimistic):",o.id),o}catch(t){throw console.error(" BudgetService.createEnvelope failed:",t),new Error(`Failed to create envelope: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateEnvelope(e,t){try{console.log(" BudgetService.updateEnvelope called for envelope:",t.id);const r=gt(We,"users",e,"envelopes",t.id);Ui(r,{...t,lastUpdated:et.now()},{merge:!0}).catch(i=>console.error("Update env failed",i)),console.log(" Updated envelope (optimistic):",t.id)}catch(r){throw console.error(" BudgetService.updateEnvelope failed:",r),new Error(`Failed to update envelope: ${r instanceof Error?r.message:"Unknown error"}`)}}async deleteEnvelope(e,t){try{console.log(" BudgetService.deleteEnvelope called for envelope:",t);const r=gt(We,"users",e,"envelopes",t);Ua(r).catch(i=>console.error("Delete env failed",i)),console.log(" Deleted envelope (optimistic):",t)}catch(r){throw console.error(" BudgetService.deleteEnvelope failed:",r),new Error(`Failed to delete envelope: ${r instanceof Error?r.message:"Unknown error"}`)}}async reorderEnvelopes(e,t){try{console.log(" BudgetService.reorderEnvelopes called for user:",e);const r=t.map(i=>{const a=gt(We,"users",e,"envelopes",i.id);return Ui(a,{orderIndex:i.orderIndex,lastUpdated:et.now()},{merge:!0})});Promise.all(r).catch(i=>console.error("Reorder env failed",i)),console.log(" Reordered envelopes (optimistic)")}catch(r){throw console.error(" BudgetService.reorderEnvelopes failed:",r),new Error(`Failed to reorder envelopes: ${r instanceof Error?r.message:"Unknown error"}`)}}async createTransaction(e){try{console.log(" BudgetService.createTransaction called for user:",e.userId);const t=Bi(We,"users",e.userId,"transactions"),r=gt(t),i=et.now(),o={...Object.fromEntries(Object.entries(e).filter(([u,d])=>d!==void 0)),createdAt:i};Ui(r,o).catch(u=>console.error("Create tx failed",u));const c={...e,id:r.id};return console.log(" Created transaction (optimistic):",c.id),c}catch(t){throw console.error(" BudgetService.createTransaction failed:",t),new Error(`Failed to create transaction: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateTransaction(e,t){try{console.log(" BudgetService.updateTransaction called for transaction:",t.id);const r=Object.fromEntries(Object.entries(t).filter(([a,o])=>o!==void 0)),i=gt(We,"users",e,"transactions",t.id);Ui(i,r,{merge:!0}).catch(a=>console.error("Update tx failed",a)),console.log(" Updated transaction (optimistic):",t.id)}catch(r){throw console.error(" BudgetService.updateTransaction failed:",r),new Error(`Failed to update transaction: ${r instanceof Error?r.message:"Unknown error"}`)}}async deleteTransaction(e,t){try{console.log(" BudgetService.deleteTransaction called for transaction:",t);const r=gt(We,"users",e,"transactions",t);Ua(r).catch(i=>console.error("Delete tx failed",i)),console.log(" Deleted transaction (optimistic):",t)}catch(r){throw console.error(" BudgetService.deleteTransaction failed:",r),new Error(`Failed to delete transaction: ${r instanceof Error?r.message:"Unknown error"}`)}}async createIncomeSource(e){try{console.log(" BudgetService.createIncomeSource (Embedded) called for user:",e.userId);const t=gt(We,"users",e.userId,"monthlyBudgets",e.month),r=et.now(),i=`inc_${r.toMillis()}_${Math.random().toString(36).substring(2,9)}`,a={...e,id:i,amount:Number(e.amount),createdAt:r,updatedAt:r};pr(t,{incomeSources:I4(a),updatedAt:r}).catch(c=>{c.code==="not-found"?Ui(t,{id:`${e.userId}_${e.month}`,userId:e.userId,month:e.month,createdAt:r,updatedAt:r,incomeSources:[a],allocations:{},totalIncome:0,availableToBudget:0}).catch(u=>console.error("Failed to create monthly budget doc",u)):console.error("Create income failed",c)});const o={...e,id:i,amount:Number(e.amount),createdAt:nr(r),updatedAt:nr(r)};return console.log(" Created income source (optimistic/embedded):",o.id),o}catch(t){throw console.error(" BudgetService.createIncomeSource failed:",t),new Error(`Failed to create income source: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateIncomeSource(e,t,r,i){try{console.log(" BudgetService.updateIncomeSource (Embedded) called for source:",t);const a=gt(We,"users",e,"monthlyBudgets",r);sc(a).then(o=>{if(!o.exists())return;const d=(o.data().incomeSources||[]).map(h=>{if(h.id===t){const p={...h,...i,updatedAt:et.now()};return i.amount!==void 0&&(p.amount=Number(i.amount)),p}return h});pr(a,{incomeSources:d,updatedAt:et.now()})}).catch(o=>console.error("Update income failed",o)),console.log(" Updated income source (optimistic/embedded):",t)}catch(a){throw console.error(" BudgetService.updateIncomeSource failed:",a),a}}async deleteIncomeSource(e,t,r){try{console.log(" BudgetService.deleteIncomeSource (Embedded) called for source:",t);const i=gt(We,"users",e,"monthlyBudgets",r);sc(i).then(a=>{if(!a.exists())return;const u=(a.data().incomeSources||[]).filter(d=>d.id!==t);pr(i,{incomeSources:u,updatedAt:et.now()})}).catch(a=>console.error("Delete income failed",a)),console.log(" Deleted income source (optimistic/embedded):",t)}catch(i){throw console.error(" BudgetService.deleteIncomeSource failed:",i),new Error(`Failed to delete income source: ${i instanceof Error?i.message:"Unknown error"}`)}}async createEnvelopeAllocation(e){try{console.log(" BudgetService.createEnvelopeAllocation (Embedded) called for user:",e.userId);const t=gt(We,"users",e.userId,"monthlyBudgets",e.month),r=et.now(),i={[`allocations.${e.envelopeId}`]:Number(e.budgetedAmount),updatedAt:r};pr(t,i).catch(o=>{o.code==="not-found"?Ui(t,{id:`${e.userId}_${e.month}`,userId:e.userId,month:e.month,createdAt:r,updatedAt:r,incomeSources:[],allocations:{[e.envelopeId]:Number(e.budgetedAmount)},totalIncome:0,availableToBudget:0}).catch(c=>console.error("Failed to create monthly budget doc",c)):console.error("Create allocation failed",o)});const a={...e,id:e.envelopeId,createdAt:nr(r),updatedAt:nr(r)};return console.log(" Created allocation (optimistic/embedded):",a.id),a}catch(t){throw console.error(" BudgetService.createEnvelopeAllocation failed:",t),new Error(`Failed to create envelope allocation: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateEnvelopeAllocation(e,t,r,i){try{console.log(" BudgetService.updateEnvelopeAllocation (Embedded) called for envelope:",t);const a=gt(We,"users",e,"monthlyBudgets",r),o={updatedAt:et.now()};i.budgetedAmount!==void 0&&(o[`allocations.${t}`]=Number(i.budgetedAmount)),pr(a,o).catch(c=>console.error("Update allocation failed",c)),console.log(" Updated allocation (optimistic/embedded):",t)}catch(a){throw console.error(" BudgetService.updateEnvelopeAllocation failed:",a),new Error(`Failed to update envelope allocation: ${a instanceof Error?a.message:"Unknown error"}`)}}async deleteEnvelopeAllocation(e,t,r){try{console.log(" BudgetService.deleteEnvelopeAllocation (Embedded) called for envelope:",t);const i=gt(We,"users",e,"monthlyBudgets",r);pr(i,{[`allocations.${t}`]:Qx(),updatedAt:et.now()}).catch(a=>console.error("Delete allocation failed",a)),console.log(" Deleted allocation (optimistic/embedded):",t)}catch(i){throw console.error(" BudgetService.deleteEnvelopeAllocation failed:",i),new Error(`Failed to delete envelope allocation: ${i instanceof Error?i.message:"Unknown error"}`)}}async getMonthData(e,t){try{console.log(` BudgetService.getMonthData (Embedded): Fetching for user ${e}, month ${t}`);const r=gt(We,"users",e,"monthlyBudgets",t),i=await sc(r);if(!i.exists())return console.log(` No budget data found for ${t}, returning empty defaults.`),{incomeSources:[],allocations:[]};const a=i.data(),o=(a.incomeSources||[]).map(d=>({...d,amount:Number(d.amount),createdAt:d.createdAt?.toDate?d.createdAt.toDate().toISOString():d.createdAt||new Date().toISOString(),updatedAt:d.updatedAt?.toDate?d.updatedAt.toDate().toISOString():d.updatedAt||new Date().toISOString()})).sort((d,h)=>new Date(d.createdAt).getTime()-new Date(h.createdAt).getTime()),c=a.allocations||{},u=Object.entries(c).map(([d,h])=>({id:d,userId:e,envelopeId:d,month:t,budgetedAmount:Number(h),createdAt:a.createdAt?.toDate?a.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:a.updatedAt?.toDate?a.updatedAt.toDate().toISOString():new Date().toISOString()})).sort((d,h)=>new Date(d.createdAt).getTime()-new Date(h.createdAt).getTime());return console.log(` Fetched ${o.length} income sources and ${u.length} allocations for ${t}`),{incomeSources:o,allocations:u}}catch(r){throw console.error(" BudgetService.getMonthData failed:",r),new Error(`Failed to fetch month data: ${r instanceof Error?r.message:"Unknown error"}`)}}async cleanupOrphanedData(e){try{console.log(" BudgetService.cleanupOrphanedData: Starting cleanup for user:",e);const t={orphanedAllocationsDeleted:0,orphanedTransactionsDeleted:0,details:{deletedAllocationIds:[],deletedTransactionIds:[],monthsProcessed:[]}},r=await this.getEnvelopes(e),i=new Set(r.map(b=>b.id));console.log(` Found ${r.length} existing envelopes`);const a=Bi(We,"users",e,"envelopeAllocations"),o=await Ba(a),c=[],u=new Set;for(const b of o.docs){const _=b.data();u.add(_.month),i.has(_.envelopeId)||(c.push(b.id),console.log(` Found orphaned allocation: ${b.id} for envelope ${_.envelopeId} in month ${_.month}`))}if(c.length>0){const b=c.map(_=>Ua(gt(We,"users",e,"envelopeAllocations",_)));await Promise.all(b),t.orphanedAllocationsDeleted+=c.length,t.details.deletedAllocationIds.push(...c),console.log(` Deleted ${c.length} orphaned allocations (legacy)`)}const d=Bi(We,"users",e,"monthlyBudgets"),h=await Ba(d);for(const b of h.docs){const w=b.data().allocations||{},S={};let T=!1;Object.keys(w).forEach(C=>{i.has(C)||(S[`allocations.${C}`]=Qx(),T=!0,console.log(` Found orphaned embedded allocation in ${b.id} for envelope ${C}`),t.orphanedAllocationsDeleted++,t.details.deletedAllocationIds.push(`${b.id}_${C}`))}),T&&(S.updatedAt=et.now(),await pr(b.ref,S),u.add(b.id))}const p=await this.getTransactions(e),m=[];for(const b of p)i.has(b.envelopeId)||(m.push(b.id),console.log(` Found orphaned transaction: ${b.id} for envelope ${b.envelopeId}`));if(m.length>0){const b=m.map(_=>Ua(gt(We,"users",e,"transactions",_)));await Promise.all(b),t.orphanedTransactionsDeleted=m.length,t.details.deletedTransactionIds=m,console.log(` Deleted ${m.length} orphaned transactions`)}return t.details.monthsProcessed=Array.from(u),console.log(" Cleanup completed:",{orphanedAllocationsDeleted:t.orphanedAllocationsDeleted,orphanedTransactionsDeleted:t.orphanedTransactionsDeleted,monthsProcessed:t.details.monthsProcessed.length}),t}catch(t){throw console.error(" BudgetService.cleanupOrphanedData failed:",t),new Error(`Failed to cleanup orphaned data: ${t instanceof Error?t.message:"Unknown error"}`)}}subscribeToMonthlyBudget(e,t,r){const i=gt(We,"users",e,"monthlyBudgets",t);return Ud(i,a=>{if(!a.exists()){r({incomeSources:[],allocations:[]});return}const o=a.data(),c=(o.incomeSources||[]).map(h=>({...h,amount:Number(h.amount),createdAt:h.createdAt?.toDate?h.createdAt.toDate().toISOString():h.createdAt||new Date().toISOString(),updatedAt:h.updatedAt?.toDate?h.updatedAt.toDate().toISOString():h.updatedAt||new Date().toISOString()})).sort((h,p)=>new Date(h.createdAt).getTime()-new Date(p.createdAt).getTime()),u=o.allocations||{},d=Object.entries(u).map(([h,p])=>({id:h,userId:e,envelopeId:h,month:t,budgetedAmount:Number(p),createdAt:o.createdAt?.toDate?o.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:o.updatedAt?.toDate?o.updatedAt.toDate().toISOString():new Date().toISOString()})).sort((h,p)=>new Date(h.createdAt).getTime()-new Date(p.createdAt).getTime());r({incomeSources:c,allocations:d})})}async deleteAllUserData(e){try{console.log(" BudgetService.deleteAllUserData: STARTING DELETION for user:",e);const t=["envelopes","transactions","incomeSources","envelopeAllocations","monthlyBudgets","appSettings"];for(const r of t){console.log(` Deleting collection: ${r}...`);const i=Bi(We,"users",e,r),a=await Ba(i);if(a.empty){console.log("   (Empty collection)");continue}const o=a.docs.map(c=>Ua(c.ref));await Promise.all(o),console.log(`    Deleted ${a.size} documents from ${r}`)}console.log(" All user data deleted successfully.")}catch(t){throw console.error(" BudgetService.deleteAllUserData failed:",t),new Error(`Failed to delete all user data: ${t instanceof Error?t.message:"Unknown error"}`)}}}const PS=uc.getInstance(),ox=n=>Bi(We,"users",n,"transactions"),oee={subscribeToTransactions:(n,e)=>{const t=Fs(ox(n),_d("date","desc"));return Ud(t,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllTransactions:async n=>{console.log(` TransactionService.getAllTransactions: Fetching for user ${n}`);const e=Fs(ox(n),_d("date","desc")),r=(await Ba(e)).docs.map(i=>{const a={id:i.id,...i.data()};return MS(a)});return console.log(` Fetched ${r.length} transactions:`,r.map(i=>({id:i.id,description:i.description,month:i.month}))),r},addTransaction:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create transaction");console.log(` TransactionService.addTransaction: Adding transaction for user ${e}:`,r),console.log(` Original transaction had temp ID: ${t}`);try{console.log(" About to call addDoc with:",r);const i=await Hv(ox(e),r);console.log(" addDoc succeeded, docRef:",i),console.log(` Document ID: ${i.id}`),console.log(` Document path: ${i.path}`);const a={id:i.id,...r,userId:e};return console.log(" Final result object:",a),a}catch(i){throw console.error(" addDoc failed:",i),console.error("Error message:",i.message),i}},updateTransaction:async(n,e,t)=>{const r=gt(We,"users",n,"transactions",e);return await pr(r,t)},deleteTransaction:async(n,e)=>{console.log(` TransactionService.deleteTransaction: Deleting transaction ${e} for user ${n}`);try{const t=gt(We,"users",n,"transactions",e);console.log(` Deleting document at path: ${t.path}`),await Ua(t),console.log(` TransactionService.deleteTransaction: Successfully deleted transaction ${e}`)}catch(t){throw console.error(` TransactionService.deleteTransaction: Failed to delete transaction ${e}:`,t),console.error("Error message:",t.message),t}}},lx=n=>Bi(We,"users",n,"envelopes"),lee={subscribeToEnvelopes:(n,e)=>{const t=Fs(lx(n),_d("orderIndex","asc"));return Ud(t,i=>{const a=i.docs.map(o=>{const c=o.data();return{id:o.id,...c,createdAt:c.createdAt?.toDate?.()?c.createdAt.toDate().toISOString():c.createdAt,lastUpdated:c.lastUpdated?.toDate?.()?c.lastUpdated.toDate().toISOString():c.lastUpdated}});e(a)})},getAllEnvelopes:async n=>{try{console.log(" EnvelopeService.getAllEnvelopes called for user:",n);const e=lx(n),i=(await Ba(e)).docs.map((a,o)=>{const c=a.data();return{id:a.id,...c,createdAt:c.createdAt?.toDate?.()?c.createdAt.toDate().toISOString():c.createdAt,lastUpdated:c.lastUpdated?.toDate?.()?c.lastUpdated.toDate().toISOString():c.lastUpdated,orderIndex:c.orderIndex??o}}).sort((a,o)=>{const c=a.orderIndex??0,u=o.orderIndex??0;return c-u});return console.log(" Fetched envelopes:",i.length),i}catch(e){return console.error(" EnvelopeService.getAllEnvelopes failed:",e),[]}},createEnvelope:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create envelope");try{return{id:(await Hv(lx(e),r)).id,...r,userId:e}}catch(i){throw console.error(" Envelope addDoc failed:",i),i}},saveEnvelope:async(n,e)=>{if(!e.id)throw new Error("Envelope ID is required for save operation");const t=gt(We,"users",n,"envelopes",e.id);return await Ui(t,e,{merge:!0})},updateBalance:async(n,e,t)=>{const r=gt(We,"users",n,"envelopes",e);return await pr(r,{currentBalance:t,lastUpdated:new Date().toISOString()})},deleteEnvelope:async(n,e)=>{console.log(` EnvelopeService.deleteEnvelope: Deleting envelope ${e} for user ${n}`);const t=gt(We,"users",n,"envelopes",e);await Ua(t),console.log(` EnvelopeService.deleteEnvelope: Successfully deleted envelope ${e}`)}},cx=n=>Bi(We,"users",n,"distributionTemplates"),cee={subscribeToDistributionTemplates:(n,e)=>{const t=Fs(cx(n),_d("lastUsed","desc"));return Ud(t,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllDistributionTemplates:async n=>{const e=Fs(cx(n),_d("lastUsed","desc"));return(await Ba(e)).docs.map(r=>({id:r.id,...r.data()}))},createDistributionTemplate:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create distribution template");console.log(` DistributionTemplateService.createDistributionTemplate: Adding template for user ${e}:`,r);try{const i=await Hv(cx(e),r);console.log(" Template addDoc succeeded, docRef:",i);const a={id:i.id,...r,userId:e};return console.log(" Final template result object:",a),a}catch(i){throw console.error(" Template addDoc failed:",i),i}},saveDistributionTemplate:async(n,e)=>{const t=gt(We,"users",n,"distributionTemplates",e.id);return await Ui(t,e,{merge:!0})},updateDistributionTemplate:async(n,e,t)=>{const r=gt(We,"users",n,"distributionTemplates",e);return await pr(r,t)},deleteDistributionTemplate:async(n,e)=>{console.log(` DistributionTemplateService.deleteDistributionTemplate: Deleting template ${e} for user ${n}`);const t=gt(We,"users",n,"distributionTemplates",e);await Ua(t),console.log(` DistributionTemplateService.deleteDistributionTemplate: Successfully deleted template ${e}`)}},ux=n=>Bi(We,"users",n,"appSettings"),uee={subscribeToAppSettings:(n,e)=>{const t=Fs(ux(n),AR(1));return Ud(t,i=>{if(i.empty){e(null);return}const a=i.docs.map(o=>({id:o.id,...o.data()}))[0];e(a)})},getAppSettings:async n=>{const e=Fs(ux(n),AR(1)),t=await Ba(e);if(t.empty)return null;const r=t.docs[0];return{id:r.id,...r.data()}},createAppSettings:async n=>{const{userId:e,...t}=n;if(!e)throw new Error("User ID is required to create app settings");console.log(` AppSettingsService.createAppSettings: Creating settings for user ${e}:`,t);try{const r=await Hv(ux(e),t);console.log(" Settings addDoc succeeded, docRef:",r);const i={id:r.id,...t,userId:e};return console.log(" Final settings result object:",i),i}catch(r){throw console.error(" Settings addDoc failed:",r),r}},saveAppSettings:async(n,e)=>{const t=gt(We,"users",n,"appSettings",e.id);return await Ui(t,e,{merge:!0})},updateAppSettings:async(n,e,t)=>{const r=gt(We,"users",n,"appSettings",e);return await pr(r,t)},deleteAppSettings:async(n,e)=>{console.log(` AppSettingsService.deleteAppSettings: Deleting settings ${e} for user ${n}`);const t=gt(We,"users",n,"appSettings",e);await Ua(t),console.log(` AppSettingsService.deleteAppSettings: Successfully deleted settings ${e}`)}},dee=n=>MS(n),fee=n=>({id:n.id,name:n.name||"",currentBalance:n.currentBalance||0,lastUpdated:n.lastUpdated?.toDate?.()?n.lastUpdated.toDate().toISOString():n.lastUpdated,isActive:n.isActive??!0,orderIndex:n.orderIndex??0,userId:n.userId||void 0,createdAt:n.createdAt?.toDate?.()?n.createdAt.toDate().toISOString():n.createdAt,isPiggybank:n.isPiggybank,piggybankConfig:n.piggybankConfig}),Vk=(n,e)=>{if(window.__firebaseUnsubscribers){console.log(" Real-time subscriptions already active, skipping setup");return}console.log(" Setting up real-time Firebase subscriptions...");const t=n.getState().currentMonth;console.log(" Current month for subscriptions:",t);const r=lee.subscribeToEnvelopes(e,u=>{console.log(" Real-time sync: Envelopes updated",u.length);const d=u.map(fee);n.setState({envelopes:d})}),i=oee.subscribeToTransactions(e,u=>{console.log(" Real-time sync: Transactions updated",u.length);const d=u.map(dee);n.setState({transactions:d})}),a=cee.subscribeToDistributionTemplates(e,u=>{console.log(" Real-time sync: Templates updated from Firebase",u.length)}),o=uee.subscribeToAppSettings(e,u=>{console.log(" Real-time sync: Settings updated",u?"found":"null"),n.setState({appSettings:u})}),c=PS.subscribeToMonthlyBudget(e,t,u=>{console.log(` Real-time sync: Monthly budget updated (${u.incomeSources.length} sources, ${u.allocations.length} allocations)`);const d=n.getState();n.setState({incomeSources:{...d.incomeSources,[t]:u.incomeSources},allocations:{...d.allocations,[t]:u.allocations}})});window.__firebaseUnsubscribers={envelopes:r,transactions:i,templates:a,settings:o,monthlyBudget:c},console.log(" Real-time subscriptions active - cross-device sync enabled")},hee=n=>{const{useBudgetStore:e,useAuthStore:t,getCurrentUserId:r}=n;if(typeof window>"u")return;window.addEventListener("online",async()=>{console.log(" Browser online event detected"),e.setState({isOnline:!0})}),window.addEventListener("offline",()=>{console.log(" Browser offline event detected"),e.setState({isOnline:!1})}),e.setState({isOnline:navigator.onLine});const i=t.getState();i.isAuthenticated&&i.currentUser&&(console.log(" User already authenticated on app load, setting up real-time subscriptions"),Vk(e,r())),t.subscribe(o=>{if(o.isAuthenticated&&o.currentUser)console.log(" User authenticated, setting up real-time subscriptions"),Vk(e,r());else if(!o.isAuthenticated&&!o.isLoading){if(console.log(" User logged out, clearing data and unsubscribing"),window.__firebaseUnsubscribers){const c=window.__firebaseUnsubscribers;c.envelopes&&c.envelopes(),c.transactions&&c.transactions(),c.templates&&c.templates(),c.settings&&c.settings(),c.monthlyBudget&&c.monthlyBudget(),delete window.__firebaseUnsubscribers,console.log(" Cleaned up Firebase subscriptions")}e.getState().handleUserLogout()}});let a=e.getState().currentMonth;e.subscribe(o=>{if(o.currentMonth!==a&&o.isAuthenticated){console.log(" Month changed from",a,"to",o.currentMonth),a=o.currentMonth;const c=r();if(c&&window.__firebaseUnsubscribers){const u=window.__firebaseUnsubscribers;u.monthlyBudget&&u.monthlyBudget(),console.log(" Unsubscribed from old month data"),u.monthlyBudget=PS.subscribeToMonthlyBudget(c,o.currentMonth,d=>{console.log(" Real-time sync: Monthly budget updated for new month");const h=e.getState();e.setState({incomeSources:{...h.incomeSources,[o.currentMonth]:d.incomeSources},allocations:{...h.allocations,[o.currentMonth]:d.allocations}})}),console.log(" Subscribed to monthly data for new month:",o.currentMonth)}}})},pee=()=>Yi.getState().currentUser?.id||"",Pn=uc.getInstance(),gr=sw()(x9(fN((n,e)=>({envelopes:[],transactions:[],appSettings:null,incomeSources:{},allocations:{},currentMonth:new Date().toISOString().slice(0,7),isOnline:typeof navigator<"u"?navigator.onLine:!0,isLoading:!1,error:null,fetchMonthData:async t=>{try{const i=(await _n(()=>Promise.resolve().then(()=>Mn),[]).then(u=>u.useAuthStore.getState())).currentUser;if(!i){console.log("No user logged in, skipping month data fetch");return}console.log(`Fetching month data for: ${t}`);const a=await Pn.getMonthData(i.id,t),o=e();n({incomeSources:{...o.incomeSources,[t]:a.incomeSources},allocations:{...o.allocations,[t]:a.allocations}}),console.log(` Fetched month data for ${t}`),(async()=>{const u=e(),d=u.allocations[t]||[],h=u.transactions.filter(m=>m.month===t);let p=0;for(const m of d){const b=u.envelopes.find(w=>w.id===m.envelopeId);if(b?.isPiggybank)continue;const _=h.find(w=>w.envelopeId===m.envelopeId&&(w.description==="Monthly Budget Allocation"||w.description==="Monthly Allocation"||w.description==="Budgeted"||w.description==="Piggybank Contribution"));_?_.amount!==m.budgetedAmount&&(console.log(` Repairing mismatch for envelope ${b?.name||m.envelopeId}: Alloc ${m.budgetedAmount} vs Tx ${_.amount}`),await u.updateTransaction({..._,amount:m.budgetedAmount}),p++):m.budgetedAmount>0&&(console.log(` Repairing missing transaction for envelope ${b?.name||m.envelopeId}`),await u.addTransaction({description:"Budgeted",amount:m.budgetedAmount,envelopeId:m.envelopeId,type:"Income",month:t,date:`${t}-01T00:00:00`,reconciled:!1,isAutomatic:!0}),p++)}p>0&&console.log(` Repaired ${p} allocation discrepancies for ${t}`)})().catch(u=>console.error("Verification failed:",u))}catch(r){console.error(` Failed to fetch month data for ${t}:`,r)}},removeEnvelopeFromMonth:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(` Removing envelope ${t} from month ${r}`);const i=e(),a=i.allocations[r]?.find(c=>c.envelopeId===t);a?await e().deleteEnvelopeAllocation(a.id):console.log(` No allocation found for envelope ${t} in ${r}`);const o=i.transactions.filter(c=>c.envelopeId===t&&(c.month===r||c.date.startsWith(r)));o.length>0&&(console.log(` Deleting ${o.length} transactions for envelope ${t} in ${r}`),await Promise.all(o.map(c=>e().deleteTransaction(c.id)))),n({isLoading:!1}),console.log(` Removed envelope ${t} from month ${r}`)}catch(i){throw console.error(" removeEnvelopeFromMonth failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to remove envelope from month"}),i}},setMonth:async t=>{n({currentMonth:t});const r=e();(r.incomeSources[t]===void 0||r.allocations[t]===void 0)&&(console.log(`Month ${t} data missing in store, fetching...`),n({isLoading:!0}),await e().fetchMonthData(t),n({isLoading:!1}))},init:async()=>{console.log("BudgetStore initializing...");const t=e();try{n({isLoading:!0,error:null});const i=(await _n(()=>Promise.resolve().then(()=>Mn),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i){console.log("No user logged in, skipping data fetch"),n({isLoading:!1});return}console.log(`Fetching data for user: ${i.id}, month: ${t.currentMonth}`);const[a,o,c]=await Promise.all([Pn.getEnvelopes(i.id),Pn.getTransactions(i.id),Pn.getMonthData(i.id,t.currentMonth)]);n({envelopes:a,transactions:o,incomeSources:{...t.incomeSources,[t.currentMonth]:c.incomeSources},allocations:{...t.allocations,[t.currentMonth]:c.allocations},isLoading:!1,error:null}),console.log(` BudgetStore initialized: ${a.length} envelopes, ${o.length} transactions, ${c.incomeSources.length} income sources, ${c.allocations.length} allocations`)}catch(r){console.error(" BudgetStore initialization failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to initialize budget data"})}},addEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await _n(()=>Promise.resolve().then(()=>Mn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a={...t,userId:i.id},o=await Pn.createEnvelope(a);return n(c=>c.envelopes.some(d=>d.id===o.id)?{isLoading:!1}:{envelopes:[...c.envelopes,o],isLoading:!1}),console.log(" Added envelope:",o.id),o.id}catch(r){throw console.error(" addEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to add envelope"}),r}},updateEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await _n(()=>Promise.resolve().then(()=>Mn),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Pn.updateEnvelope(i.id,t),n(a=>({envelopes:a.envelopes.map(o=>o.id===t.id?t:o),isLoading:!1})),console.log(" Updated envelope:",t.id)}catch(r){throw console.error(" updateEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update envelope"}),r}},deleteEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await _n(()=>Promise.resolve().then(()=>Mn),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Pn.deleteEnvelope(i.id,t),n(a=>({envelopes:a.envelopes.filter(o=>o.id!==t),transactions:a.transactions.filter(o=>o.envelopeId!==t),isLoading:!1})),console.log(" Deleted envelope:",t)}catch(r){throw console.error(" deleteEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete envelope"}),r}},reorderEnvelopes:async t=>{try{n({isLoading:!0,error:null});const r=e(),i=new Map;t.forEach((d,h)=>{i.set(d,h)});const a=r.envelopes.map(d=>{if(!i.has(d.id))return d;const h=i.get(d.id);return d.orderIndex===h?d:{...d,orderIndex:h}}),o=a.filter((d,h)=>d!==r.envelopes[h]);if(!o.length){n({isLoading:!1});return}const u=(await _n(()=>Promise.resolve().then(()=>Mn),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!u)throw new Error("No authenticated user found");await Pn.reorderEnvelopes(u.id,o),n({envelopes:a,isLoading:!1}),console.log(" Reordered envelopes")}catch(r){throw console.error(" reorderEnvelopes failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to reorder envelopes"}),r}},addTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await _n(()=>Promise.resolve().then(()=>Mn),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=new Date(t.date),o=t.month||`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,c={...t,userId:i.id,month:o},u=await Pn.createTransaction(c);n(d=>d.transactions.some(p=>p.id===u.id)?{isLoading:!1}:{transactions:[...d.transactions,u],isLoading:!1}),console.log(" Added transaction:",u.id)}catch(r){throw console.error(" addTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to add transaction"}),r}},updateTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await _n(()=>Promise.resolve().then(()=>Mn),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=new Date(t.date),o=t.month||`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,c={...t,month:o};await Pn.updateTransaction(i.id,c),n(u=>({transactions:u.transactions.map(d=>d.id===t.id?c:d),isLoading:!1})),console.log(" Updated transaction:",t.id)}catch(r){throw console.error(" updateTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update transaction"}),r}},deleteTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await _n(()=>Promise.resolve().then(()=>Mn),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Pn.deleteTransaction(i.id,t),n(a=>({transactions:a.transactions.filter(o=>o.id!==t),isLoading:!1})),console.log(" Deleted transaction:",t)}catch(r){throw console.error(" deleteTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete transaction"}),r}},restoreTransaction:async t=>{await e().updateTransaction(t)},transferFunds:async(t,r,i,a,o)=>{try{const c=o?typeof o=="string"?o:o.toISOString():new Date().toISOString(),u=`transfer-${Date.now()}-${Math.random()}`;await e().addTransaction({description:`Transfer to ${e().envelopes.find(d=>d.id===r)?.name||"envelope"}`,amount:i,envelopeId:t,date:c,type:"Expense",transferId:u,reconciled:!1}),await e().addTransaction({description:`Transfer from ${e().envelopes.find(d=>d.id===t)?.name||"envelope"}`,amount:i,envelopeId:r,date:c,type:"Income",transferId:u,reconciled:!1}),console.log(" Transfer completed")}catch(c){throw console.error(" transferFunds failed:",c),c}},fetchData:async()=>{await e().init()},renameEnvelope:async(t,r)=>{try{n({isLoading:!0,error:null});const a=e().envelopes.find(d=>d.id===t);if(!a)throw new Error("Envelope not found");n(d=>({envelopes:d.envelopes.map(h=>h.id===t?{...h,name:r}:h),isLoading:!0}));const c=(await _n(()=>Promise.resolve().then(()=>Mn),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!c)throw new Error("No authenticated user found");const u={...a,name:r};await Pn.updateEnvelope(c.id,u),n({isLoading:!1}),console.log(" Renamed envelope:",t)}catch(i){throw console.error(" renameEnvelope failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to rename envelope"}),i}},getEnvelopeBalance:(t,r)=>{const i=e(),a=i.envelopes.find(o=>o.id===t);if(!a)return console.log(` getEnvelopeBalance: Envelope ${t} not found`),0;if(a.isPiggybank){const o=i.transactions.filter(p=>p.envelopeId===t),c=o.filter(p=>p.type==="Expense"),u=o.filter(p=>p.type==="Income"),d=c.reduce((p,m)=>p+(m.amount||0),0);return u.reduce((p,m)=>p+(m.amount||0),0)-d}if(r){const o=i.transactions.filter(p=>p.envelopeId===t&&p.month===r),c=o.filter(p=>p.type==="Expense"),u=o.filter(p=>p.type==="Income"),d=c.reduce((p,m)=>p+(m.amount||0),0);return u.reduce((p,m)=>p+(m.amount||0),0)-d}return console.warn(` getEnvelopeBalance: Month not provided for non-piggybank envelope ${t}. Returning 0.`),0},resetData:async()=>{console.log(" Resetting all data"),n({isLoading:!0});try{const r=(await _n(()=>Promise.resolve().then(()=>Mn),void 0).then(i=>i.useAuthStore.getState())).currentUser;r?(console.log(" Deleting all data from Firestore for user:",r.id),await Pn.deleteAllUserData(r.id)):console.warn(" No user logged in, only clearing local state"),n({envelopes:[],transactions:[],appSettings:null,incomeSources:{},allocations:{},isLoading:!1,error:null}),console.log(" Reset data complete")}catch(t){throw console.error(" resetData failed:",t),n({isLoading:!1,error:t instanceof Error?t.message:"Failed to reset data"}),t}},importData:async t=>{try{if(n({isLoading:!0,error:null}),!t||typeof t!="object")throw new Error("Invalid data format");const i=(await _n(()=>Promise.resolve().then(()=>Mn),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("You must be logged in to restore data.");return console.log(" Starting Time Machine Restore for user:",i.id),await Pn.restoreUserData(i.id,t),console.log(" Reloading app state from cloud..."),await e().init(),n({isLoading:!1}),{success:!0,message:"Data restored successfully from backup."}}catch(r){return console.error(" importData failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to import data"}),{success:!1,message:r instanceof Error?r.message:"Import failed"}}},updateAppSettings:async t=>{try{n({isLoading:!0,error:null});const r=e(),i={id:r.appSettings?.id||"default",theme:t.theme??r.appSettings?.theme??"system",enableMoveableReorder:t.enableMoveableReorder??r.appSettings?.enableMoveableReorder??!0,userId:t.userId??r.appSettings?.userId};n({appSettings:i,isLoading:!1}),console.log(" Updated app settings")}catch(r){throw console.error(" updateAppSettings failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update settings"}),r}},initializeAppSettings:async()=>{try{if(e().appSettings)return;n({appSettings:{id:"default",theme:"system",enableMoveableReorder:!0}}),console.log(" Initialized app settings")}catch(t){throw console.error(" initializeAppSettings failed:",t),n({error:t instanceof Error?t.message:"Failed to initialize settings"}),t}},updatePiggybankContribution:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Updating piggybank contribution:",{envelopeId:t,newAmount:r});const a=(await _n(()=>Promise.resolve().then(()=>Mn),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");const o=e().envelopes.find(u=>u.id===t&&u.isPiggybank);if(!o)throw new Error("Piggybank not found");const c={...o,lastUpdated:new Date().toISOString(),piggybankConfig:{monthlyContribution:r,targetAmount:o.piggybankConfig?.targetAmount,color:o.piggybankConfig?.color,icon:o.piggybankConfig?.icon,paused:o.piggybankConfig?.paused??!1}};if(console.log(" Updating envelope in Firestore:",c),await Pn.updateEnvelope(a.id,c),console.log(" Envelope updated successfully"),n(u=>({envelopes:u.envelopes.map(d=>d.id===t?c:d),isLoading:!1})),!o.piggybankConfig?.paused)try{await e().setEnvelopeAllocation(t,r),setTimeout(()=>{e().transactions.find(d=>d.envelopeId===t&&(d.description==="Monthly Allocation"||d.description==="Piggybank Contribution"))||console.warn(" Piggybank contribution transaction not found after update")},1e3)}catch(u){console.error(" Failed to update piggybank contribution:",u)}console.log(" Piggybank contribution updated successfully")}catch(i){throw console.error(" updatePiggybankContribution failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update piggybank contribution"}),i}},addIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null});const a=(await _n(()=>Promise.resolve().then(()=>Mn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");console.log(" Adding income source:",{month:t,source:r});const o=await Pn.createIncomeSource({...r,userId:a.id,month:t});n(c=>{const u=c.incomeSources[t]||[];return u.some(h=>h.id===o.id)?{isLoading:!1}:{incomeSources:{...c.incomeSources,[t]:[...u,o]},isLoading:!1}}),console.log(" Added income source:",o.id)}catch(i){throw console.error(" addIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to add income source"}),i}},updateIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Updating income source:",{month:t,sourceId:r.id}),n(o=>({incomeSources:{...o.incomeSources,[t]:o.incomeSources[t]?.map(c=>c.id===r.id?{...r,updatedAt:new Date().toISOString()}:c)||[]},isLoading:!1}));const a=(await _n(()=>Promise.resolve().then(()=>Mn),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!a)return;await Pn.updateIncomeSource(a.id,r.id,t,r),console.log(" Updated income source:",r.id)}catch(i){throw console.error(" updateIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update income source"}),i}},deleteIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Deleting income source:",{month:t,sourceId:r}),n(o=>({incomeSources:{...o.incomeSources,[t]:o.incomeSources[t]?.filter(c=>c.id!==r)||[]},isLoading:!1}));const a=(await _n(()=>Promise.resolve().then(()=>Mn),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!a)return;await Pn.deleteIncomeSource(a.id,r,t),console.log(" Deleted income source:",r)}catch(i){throw console.error(" deleteIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to delete income source"}),i}},copyPreviousMonthAllocations:async t=>{try{n({isLoading:!0,error:null});const i=(await _n(()=>Promise.resolve().then(()=>Mn),void 0).then(_=>_.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");console.log(" Copying allocations from previous month:",t);const[a,o]=t.split("-").map(Number);let c=a,u=o-1;u<1&&(c=a-1,u=12);const d=`${c}-${String(u).padStart(2,"0")}`,h=e().incomeSources[d]||[];if(console.log(` Found ${h.length} income sources from ${d}`),h.length>0){for(const _ of h){const{id:w,...S}=_;await e().addIncomeSource(t,S)}console.log(` Copied ${h.length} income sources to ${t}`)}const p=e().allocations[d]||[];console.log(` Found ${p.length} allocations from ${d}`);const m=p.filter(_=>!e().envelopes.find(S=>S.id===_.envelopeId)?.isPiggybank);if(m.length>0){for(const _ of m)await e().createEnvelopeAllocation({envelopeId:_.envelopeId,budgetedAmount:_.budgetedAmount,userId:i.id,month:t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),_.budgetedAmount>0&&await e().addTransaction({description:"Budgeted",amount:_.budgetedAmount,envelopeId:_.envelopeId,type:"Income",month:t,date:`${t}-01T00:00:00`,reconciled:!1,isAutomatic:!0});console.log(` Copied ${m.length} regular allocations to ${t}`)}const b=e().envelopes.filter(_=>_.isPiggybank);console.log(` Processing ${b.length} piggybanks for ${t}`);for(const _ of b){const w=_.piggybankConfig?.monthlyContribution,S=_.piggybankConfig?.paused??!1;if(!S&&w&&w>0)try{console.log(` Setting piggybank allocation for ${_.name}: ${w}`),await e().setEnvelopeAllocation(_.id,w)}catch(T){console.error(` Failed to set allocation for piggybank ${_.name}:`,T)}else console.log(` Skipping piggybank ${_.name} (paused=${S}, contribution=${w})`)}n({isLoading:!1}),console.log(` Complete monthly setup copied to ${t}`)}catch(r){throw console.error(" copyPreviousMonthAllocations failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to copy allocations"}),r}},setEnvelopeAllocation:async(t,r)=>{try{n({isLoading:!0,error:null});const a=(await _n(()=>Promise.resolve().then(()=>Mn),void 0).then(h=>h.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");const o=e().currentMonth,c=e().envelopes.find(h=>h.id===t),u=c?.isPiggybank;console.log(` setEnvelopeAllocation called: envelopeId=${t}, amount=${r}, currentMonth=${o}, isPiggybank=${u}`);const d=e().allocations[o]?.find(h=>h.envelopeId===t);if(d?await e().updateEnvelopeAllocation(d.id,{budgetedAmount:r}):await e().createEnvelopeAllocation({envelopeId:t,budgetedAmount:r,userId:a.id,month:o,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),u&&r>0&&!c?.piggybankConfig?.paused){const h=e().transactions.find(p=>p.envelopeId===t&&p.month===o&&(p.description==="Monthly Allocation"||p.description==="Piggybank Contribution"));if(h){const p={...h,amount:r,description:"Piggybank Contribution"};await e().updateTransaction(p)}else{const p={description:"Piggybank Contribution",amount:r,envelopeId:t,type:"Income",month:o,date:`${o}-01T00:00:00`,reconciled:!1,isAutomatic:!0};await e().addTransaction(p)}}if(!u&&r>0){const h=e().transactions.find(p=>p.envelopeId===t&&p.month===o&&(p.description==="Monthly Budget Allocation"||p.description==="Budgeted"));if(h){const p={...h,amount:r,description:"Budgeted"};await e().updateTransaction(p)}else{const p={description:"Budgeted",amount:r,envelopeId:t,type:"Income",month:o,date:`${o}-01T00:00:00`,reconciled:!1,isAutomatic:!0};await e().addTransaction(p)}}console.log(" Envelope allocation set successfully")}catch(i){throw console.error(" setEnvelopeAllocation failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to set envelope allocation"}),i}},createEnvelopeAllocation:async t=>{try{const i=(await _n(()=>Promise.resolve().then(()=>Mn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=e().currentMonth,o=await Pn.createEnvelopeAllocation({envelopeId:t.envelopeId,budgetedAmount:t.budgetedAmount,userId:i.id,month:a});n(c=>{const u=c.allocations[a]||[];return u.some(h=>h.id===o.id)?{isLoading:!1}:{allocations:{...c.allocations,[a]:[...u,o]},isLoading:!1}}),console.log(" Created envelope allocation:",o.id)}catch(r){throw console.error(" createEnvelopeAllocation failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to create envelope allocation"}),r}},updateEnvelopeAllocation:async(t,r)=>{try{console.log(" Updating envelope allocation:",{id:t,updates:r});const i=e().currentMonth,o=(await _n(()=>Promise.resolve().then(()=>Mn),void 0).then(h=>h.useAuthStore.getState())).currentUser;if(!o)throw new Error("No authenticated user found");const c=e().allocations[i]?.find(h=>h.id===t);if(!c)throw new Error("Allocation not found");const u=e().envelopes.find(h=>h.id===c.envelopeId),d=u?.isPiggybank;if(await Pn.updateEnvelopeAllocation(o.id,c.envelopeId,i,{budgetedAmount:r.budgetedAmount}),n(h=>({allocations:{...h.allocations,[i]:h.allocations[i]?.map(p=>p.id===t?{...p,...r,updatedAt:new Date().toISOString()}:p)||[]},isLoading:!1})),d&&r.budgetedAmount!==void 0){const h=e().transactions.find(p=>p.envelopeId===c.envelopeId&&p.month===i&&(p.description==="Monthly Allocation"||p.description==="Piggybank Contribution"));h?r.budgetedAmount>0&&!u?.piggybankConfig?.paused?await e().updateTransaction({...h,amount:r.budgetedAmount,description:"Piggybank Contribution"}):(r.budgetedAmount===0||u?.piggybankConfig?.paused)&&await e().deleteTransaction(h.id):r.budgetedAmount>0&&!u?.piggybankConfig?.paused&&await e().addTransaction({description:"Piggybank Contribution",amount:r.budgetedAmount,envelopeId:c.envelopeId,type:"Income",month:i,date:`${i}-01T00:00:00`,reconciled:!1,isAutomatic:!0})}if(!d&&r.budgetedAmount!==void 0){const h=e().transactions.find(p=>p.envelopeId===c.envelopeId&&p.month===i&&(p.description==="Monthly Budget Allocation"||p.description==="Budgeted"));h?r.budgetedAmount>0?await e().updateTransaction({...h,amount:r.budgetedAmount,description:"Budgeted"}):r.budgetedAmount===0&&await e().deleteTransaction(h.id):r.budgetedAmount>0&&await e().addTransaction({description:"Budgeted",amount:r.budgetedAmount,envelopeId:c.envelopeId,type:"Income",month:i,date:`${i}-01T00:00:00`,reconciled:!1,isAutomatic:!0})}console.log(" Updated envelope allocation:",t)}catch(i){throw console.error(" updateEnvelopeAllocation failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update envelope allocation"}),i}},deleteEnvelopeAllocation:async t=>{try{console.log(" Deleting envelope allocation:",t);const r=e().currentMonth,i=e().allocations[r]?.find(c=>c.id===t);if(!i){console.warn("Allocation not found in store, skipping delete");return}const o=(await _n(()=>Promise.resolve().then(()=>Mn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!o)throw new Error("No authenticated user found");await Pn.deleteEnvelopeAllocation(o.id,i.envelopeId,r),n(c=>({allocations:{...c.allocations,[r]:c.allocations[r]?.filter(u=>u.id!==t)||[]},isLoading:!1})),console.log(" Deleted envelope allocation:",t)}catch(r){throw console.error(" deleteEnvelopeAllocation failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete envelope allocation"}),r}},refreshAvailableToBudget:async()=>{try{const t=e().currentMonth,r=e().allocations[t]||[],i=e().incomeSources[t]||[],a=r.reduce((u,d)=>u+d.budgetedAmount,0);return i.reduce((u,d)=>u+d.amount,0)-a}catch(t){throw console.error(" refreshAvailableToBudget failed:",t),n({error:t instanceof Error?t.message:"Failed to refresh available to budget"}),t}},updateOnlineStatus:async()=>{try{const t=typeof navigator<"u"?navigator.onLine:!0;n({isOnline:t}),console.log(" Online status updated:",t)}catch(t){console.error(" Failed to update online status:",t)}},handleUserLogout:()=>{console.log(" Clearing user data on logout"),n({envelopes:[],transactions:[],incomeSources:{},allocations:{},isLoading:!1,error:null})}}),{name:"budget-storage"})));hee({useBudgetStore:gr,useAuthStore:Yi,getCurrentUserId:pee});class Qu{static instance;static getInstance(){return Qu.instance||(Qu.instance=new Qu),Qu.instance}async getMonthlyBudget(e,t){try{const r=gt(We,"users",e,"monthlyBudgets",t),i=await sc(r);if(i.exists()){const a=i.data();return{id:a.id,userId:a.userId,month:a.month,totalIncome:a.totalIncome,availableToBudget:a.availableToBudget,createdAt:nr(a.createdAt),updatedAt:nr(a.updatedAt)}}return null}catch(r){throw console.error("Error getting monthly budget:",r),r}}async createOrUpdateMonthlyBudget(e){try{const t=et.now(),r=`${e.userId}_${e.month}`,i={id:r,userId:e.userId,month:e.month,totalIncome:e.totalIncome,availableToBudget:e.availableToBudget,createdAt:t,updatedAt:t};return await Ui(gt(We,"users",e.userId,"monthlyBudgets",e.month),i),{...e,id:r,createdAt:nr(t),updatedAt:nr(t)}}catch(t){throw console.error("Error creating/updating monthly budget:",t),t}}async getMonthData(e,t){try{if(!await this.getMonthlyBudget(e,t))return{incomeSources:[],allocations:[]};const i=gt(We,"users",e,"monthlyBudgets",t),a=await sc(i);if(!a.exists())return{incomeSources:[],allocations:[]};const o=a.data(),c=(o.incomeSources||[]).map(d=>({id:d.id,userId:d.userId,month:d.month,name:d.name,amount:d.amount,frequency:d.frequency||"monthly",category:d.category,createdAt:nr(d.createdAt),updatedAt:nr(d.updatedAt)})),u=Object.entries(o.allocations||{}).map(([d,h])=>({id:d,userId:e,envelopeId:d,month:t,budgetedAmount:h,createdAt:nr(o.createdAt),updatedAt:nr(o.updatedAt)}));return{incomeSources:c,allocations:u}}catch(r){throw console.error("Error getting month data:",r),r}}async getIncomeSources(e,t){return(await this.getMonthData(e,t)).incomeSources}async createIncomeSource(e){try{const t=et.now(),r=`inc_${t.toMillis()}_${Math.random().toString(36).substr(2,9)}`,i={id:r,userId:e.userId,month:e.month,name:e.name,amount:e.amount,frequency:e.frequency||"monthly",category:e.category,createdAt:t,updatedAt:t},a=gt(We,"users",e.userId,"monthlyBudgets",e.month);return await pr(a,{incomeSources:I4(i)}),{...e,id:r,frequency:e.frequency||"monthly",createdAt:nr(t),updatedAt:nr(t)}}catch(t){throw console.error("Error creating income source:",t),t}}async getEnvelopeAllocations(e,t){return(await this.getMonthData(e,t)).allocations}async createEnvelopeAllocation(e){try{const t=et.now(),r=gt(We,"users",e.userId,"monthlyBudgets",e.month);return await pr(r,{[`allocations.${e.envelopeId}`]:e.budgetedAmount,updatedAt:t}),{...e,id:e.envelopeId,createdAt:nr(t),updatedAt:nr(t)}}catch(t){throw console.error("Error creating envelope allocation:",t),t}}async copyMonthData(e,t,r){try{const i=await this.getMonthData(e,t),a=et.now(),o=i.incomeSources.map(m=>({id:`inc_${a.toMillis()}_${Math.random().toString(36).substr(2,9)}`,userId:e,month:r,name:m.name,amount:m.amount,frequency:m.frequency||"monthly",category:m.category,createdAt:a,updatedAt:a})),c={};i.allocations.forEach(m=>{c[m.envelopeId]=m.budgetedAmount});const u=o.reduce((m,b)=>m+b.amount,0),d=Object.values(c).reduce((m,b)=>m+b,0),p={id:`${e}_${r}`,userId:e,month:r,totalIncome:u,availableToBudget:u-d,createdAt:a,updatedAt:a,allocations:c,incomeSources:o};await Ui(gt(We,"users",e,"monthlyBudgets",r),p)}catch(i){throw console.error("Error copying month data:",i),i}}async deleteIncomeSource(e,t,r){try{const i=gt(We,"users",e,"monthlyBudgets",r),a=await sc(i);if(!a.exists())return;const u=(a.data().incomeSources||[]).filter(d=>d.id!==t);await pr(i,{incomeSources:u,updatedAt:et.now()})}catch(i){throw console.error("Error deleting income source:",i),i}}async updateIncomeSource(e,t,r,i){try{const a=gt(We,"users",e,"monthlyBudgets",r),o=await sc(a);if(!o.exists())return;const d=(o.data().incomeSources||[]).map(h=>h.id===t?{...h,...i,updatedAt:et.now()}:h);await pr(a,{incomeSources:d,updatedAt:et.now()})}catch(a){throw console.error("Error updating income source:",a),a}}async deleteEnvelopeAllocation(e,t,r){try{const i=gt(We,"users",e,"monthlyBudgets",r);await pr(i,{[`allocations.${t}`]:Qx(),updatedAt:et.now()})}catch(i){throw console.error("Error deleting envelope allocation:",i),i}}async updateEnvelopeAllocation(e,t,r,i){try{const a=gt(We,"users",e,"monthlyBudgets",r);i.budgetedAmount!==void 0&&await pr(a,{[`allocations.${t}`]:i.budgetedAmount,updatedAt:et.now()})}catch(a){throw console.error("Error updating envelope allocation:",a),a}}async clearMonthData(e,t){try{const r=gt(We,"users",e,"monthlyBudgets",t);await pr(r,{totalIncome:0,availableToBudget:0,incomeSources:[],allocations:{},updatedAt:et.now()});const i=Fs(Bi(We,"users",e,"transactions"),Wq("month","==",t)),a=await Ba(i);if(a.size>0){const o=a.docs.map(c=>Ua(c.ref));await Promise.all(o),console.log(` Deleted ${a.size} transactions for month ${t}`)}else console.log(` No transactions found for month ${t}`)}catch(r){throw console.error("Error clearing month data:",r),r}}async calculateAvailableToBudget(e,t){try{const r=await this.getMonthData(e,t),i=r.incomeSources.reduce((o,c)=>o+c.amount,0),a=r.allocations.reduce((o,c)=>o+c.budgetedAmount,0);return i-a}catch(r){throw console.error("Error calculating available to budget:",r),r}}subscribeToMonthlyBudget(e,t,r){const i=gt(We,"users",e,"monthlyBudgets",t);return Ud(i,a=>{a.exists()?r(a.data()):r(null)})}}const gee=Qu.getInstance();var Zu=9e15,bl=1e9,Y_="0123456789abcdef",pv="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",gv="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",K_={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Zu,maxE:Zu,crypto:!1},u5,ks,ot=!0,uy="[DecimalError] ",hl=uy+"Invalid argument: ",d5=uy+"Precision limit exceeded",f5=uy+"crypto unavailable",h5="[object Decimal]",Vr=Math.floor,rr=Math.pow,mee=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,vee=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,yee=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,p5=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ga=1e7,tt=7,bee=9007199254740991,xee=pv.length-1,X_=gv.length-1,we={toStringTag:h5};we.absoluteValue=we.abs=function(){var n=new this.constructor(this);return n.s<0&&(n.s=1),qe(n)};we.ceil=function(){return qe(new this.constructor(this),this.e+1,2)};we.clampedTo=we.clamp=function(n,e){var t,r=this,i=r.constructor;if(n=new i(n),e=new i(e),!n.s||!e.s)return new i(NaN);if(n.gt(e))throw Error(hl+e);return t=r.cmp(n),t<0?n:r.cmp(e)>0?e:new i(r)};we.comparedTo=we.cmp=function(n){var e,t,r,i,a=this,o=a.d,c=(n=new a.constructor(n)).d,u=a.s,d=n.s;if(!o||!c)return!u||!d?NaN:u!==d?u:o===c?0:!o^u<0?1:-1;if(!o[0]||!c[0])return o[0]?u:c[0]?-d:0;if(u!==d)return u;if(a.e!==n.e)return a.e>n.e^u<0?1:-1;for(r=o.length,i=c.length,e=0,t=r<i?r:i;e<t;++e)if(o[e]!==c[e])return o[e]>c[e]^u<0?1:-1;return r===i?0:r>i^u<0?1:-1};we.cosine=we.cos=function(){var n,e,t=this,r=t.constructor;return t.d?t.d[0]?(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+tt,r.rounding=1,t=_ee(r,b5(r,t)),r.precision=n,r.rounding=e,qe(ks==2||ks==3?t.neg():t,n,e,!0)):new r(1):new r(NaN)};we.cubeRoot=we.cbrt=function(){var n,e,t,r,i,a,o,c,u,d,h=this,p=h.constructor;if(!h.isFinite()||h.isZero())return new p(h);for(ot=!1,a=h.s*rr(h.s*h,1/3),!a||Math.abs(a)==1/0?(t=Ar(h.d),n=h.e,(a=(n-t.length+1)%3)&&(t+=a==1||a==-2?"0":"00"),a=rr(t,1/3),n=Vr((n+1)/3)-(n%3==(n<0?-1:2)),a==1/0?t="5e"+n:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+n),r=new p(t),r.s=h.s):r=new p(a.toString()),o=(n=p.precision)+3;;)if(c=r,u=c.times(c).times(c),d=u.plus(h),r=Zt(d.plus(h).times(c),d.plus(u),o+2,1),Ar(c.d).slice(0,o)===(t=Ar(r.d)).slice(0,o))if(t=t.slice(o-3,o+1),t=="9999"||!i&&t=="4999"){if(!i&&(qe(c,n+1,0),c.times(c).times(c).eq(h))){r=c;break}o+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(qe(r,n+1,1),e=!r.times(r).times(r).eq(h));break}return ot=!0,qe(r,n,p.rounding,e)};we.decimalPlaces=we.dp=function(){var n,e=this.d,t=NaN;if(e){if(n=e.length-1,t=(n-Vr(this.e/tt))*tt,n=e[n],n)for(;n%10==0;n/=10)t--;t<0&&(t=0)}return t};we.dividedBy=we.div=function(n){return Zt(this,new this.constructor(n))};we.dividedToIntegerBy=we.divToInt=function(n){var e=this,t=e.constructor;return qe(Zt(e,new t(n),0,1,1),t.precision,t.rounding)};we.equals=we.eq=function(n){return this.cmp(n)===0};we.floor=function(){return qe(new this.constructor(this),this.e+1,3)};we.greaterThan=we.gt=function(n){return this.cmp(n)>0};we.greaterThanOrEqualTo=we.gte=function(n){var e=this.cmp(n);return e==1||e===0};we.hyperbolicCosine=we.cosh=function(){var n,e,t,r,i,a=this,o=a.constructor,c=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return c;t=o.precision,r=o.rounding,o.precision=t+Math.max(a.e,a.sd())+4,o.rounding=1,i=a.d.length,i<32?(n=Math.ceil(i/3),e=(1/fy(4,n)).toString()):(n=16,e="2.3283064365386962890625e-10"),a=kd(o,1,a.times(e),new o(1),!0);for(var u,d=n,h=new o(8);d--;)u=a.times(a),a=c.minus(u.times(h.minus(u.times(h))));return qe(a,o.precision=t,o.rounding=r,!0)};we.hyperbolicSine=we.sinh=function(){var n,e,t,r,i=this,a=i.constructor;if(!i.isFinite()||i.isZero())return new a(i);if(e=a.precision,t=a.rounding,a.precision=e+Math.max(i.e,i.sd())+4,a.rounding=1,r=i.d.length,r<3)i=kd(a,2,i,i,!0);else{n=1.4*Math.sqrt(r),n=n>16?16:n|0,i=i.times(1/fy(5,n)),i=kd(a,2,i,i,!0);for(var o,c=new a(5),u=new a(16),d=new a(20);n--;)o=i.times(i),i=i.times(c.plus(o.times(u.times(o).plus(d))))}return a.precision=e,a.rounding=t,qe(i,e,t,!0)};we.hyperbolicTangent=we.tanh=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+7,r.rounding=1,Zt(t.sinh(),t.cosh(),r.precision=n,r.rounding=e)):new r(t.s)};we.inverseCosine=we.acos=function(){var n=this,e=n.constructor,t=n.abs().cmp(1),r=e.precision,i=e.rounding;return t!==-1?t===0?n.isNeg()?Ha(e,r,i):new e(0):new e(NaN):n.isZero()?Ha(e,r+4,i).times(.5):(e.precision=r+6,e.rounding=1,n=new e(1).minus(n).div(n.plus(1)).sqrt().atan(),e.precision=r,e.rounding=i,n.times(2))};we.inverseHyperbolicCosine=we.acosh=function(){var n,e,t=this,r=t.constructor;return t.lte(1)?new r(t.eq(1)?0:NaN):t.isFinite()?(n=r.precision,e=r.rounding,r.precision=n+Math.max(Math.abs(t.e),t.sd())+4,r.rounding=1,ot=!1,t=t.times(t).minus(1).sqrt().plus(t),ot=!0,r.precision=n,r.rounding=e,t.ln()):new r(t)};we.inverseHyperbolicSine=we.asinh=function(){var n,e,t=this,r=t.constructor;return!t.isFinite()||t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+2*Math.max(Math.abs(t.e),t.sd())+6,r.rounding=1,ot=!1,t=t.times(t).plus(1).sqrt().plus(t),ot=!0,r.precision=n,r.rounding=e,t.ln())};we.inverseHyperbolicTangent=we.atanh=function(){var n,e,t,r,i=this,a=i.constructor;return i.isFinite()?i.e>=0?new a(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(n=a.precision,e=a.rounding,r=i.sd(),Math.max(r,n)<2*-i.e-1?qe(new a(i),n,e,!0):(a.precision=t=r-i.e,i=Zt(i.plus(1),new a(1).minus(i),t+n,1),a.precision=n+4,a.rounding=1,i=i.ln(),a.precision=n,a.rounding=e,i.times(.5))):new a(NaN)};we.inverseSine=we.asin=function(){var n,e,t,r,i=this,a=i.constructor;return i.isZero()?new a(i):(e=i.abs().cmp(1),t=a.precision,r=a.rounding,e!==-1?e===0?(n=Ha(a,t+4,r).times(.5),n.s=i.s,n):new a(NaN):(a.precision=t+6,a.rounding=1,i=i.div(new a(1).minus(i.times(i)).sqrt().plus(1)).atan(),a.precision=t,a.rounding=r,i.times(2)))};we.inverseTangent=we.atan=function(){var n,e,t,r,i,a,o,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding;if(d.isFinite()){if(d.isZero())return new h(d);if(d.abs().eq(1)&&p+4<=X_)return o=Ha(h,p+4,m).times(.25),o.s=d.s,o}else{if(!d.s)return new h(NaN);if(p+4<=X_)return o=Ha(h,p+4,m).times(.5),o.s=d.s,o}for(h.precision=c=p+10,h.rounding=1,t=Math.min(28,c/tt+2|0),n=t;n;--n)d=d.div(d.times(d).plus(1).sqrt().plus(1));for(ot=!1,e=Math.ceil(c/tt),r=1,u=d.times(d),o=new h(d),i=d;n!==-1;)if(i=i.times(u),a=o.minus(i.div(r+=2)),i=i.times(u),o=a.plus(i.div(r+=2)),o.d[e]!==void 0)for(n=e;o.d[n]===a.d[n]&&n--;);return t&&(o=o.times(2<<t-1)),ot=!0,qe(o,h.precision=p,h.rounding=m,!0)};we.isFinite=function(){return!!this.d};we.isInteger=we.isInt=function(){return!!this.d&&Vr(this.e/tt)>this.d.length-2};we.isNaN=function(){return!this.s};we.isNegative=we.isNeg=function(){return this.s<0};we.isPositive=we.isPos=function(){return this.s>0};we.isZero=function(){return!!this.d&&this.d[0]===0};we.lessThan=we.lt=function(n){return this.cmp(n)<0};we.lessThanOrEqualTo=we.lte=function(n){return this.cmp(n)<1};we.logarithm=we.log=function(n){var e,t,r,i,a,o,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding,b=5;if(n==null)n=new h(10),e=!0;else{if(n=new h(n),t=n.d,n.s<0||!t||!t[0]||n.eq(1))return new h(NaN);e=n.eq(10)}if(t=d.d,d.s<0||!t||!t[0]||d.eq(1))return new h(t&&!t[0]?-1/0:d.s!=1?NaN:t?0:1/0);if(e)if(t.length>1)a=!0;else{for(i=t[0];i%10===0;)i/=10;a=i!==1}if(ot=!1,c=p+b,o=Xo(d,c),r=e?mv(h,c+10):Xo(n,c),u=Zt(o,r,c,1),pp(u.d,i=p,m))do if(c+=10,o=Xo(d,c),r=e?mv(h,c+10):Xo(n,c),u=Zt(o,r,c,1),!a){+Ar(u.d).slice(i+1,i+15)+1==1e14&&(u=qe(u,p+1,0));break}while(pp(u.d,i+=10,m));return ot=!0,qe(u,p,m)};we.minus=we.sub=function(n){var e,t,r,i,a,o,c,u,d,h,p,m,b=this,_=b.constructor;if(n=new _(n),!b.d||!n.d)return!b.s||!n.s?n=new _(NaN):b.d?n.s=-n.s:n=new _(n.d||b.s!==n.s?b:NaN),n;if(b.s!=n.s)return n.s=-n.s,b.plus(n);if(d=b.d,m=n.d,c=_.precision,u=_.rounding,!d[0]||!m[0]){if(m[0])n.s=-n.s;else if(d[0])n=new _(b);else return new _(u===3?-0:0);return ot?qe(n,c,u):n}if(t=Vr(n.e/tt),h=Vr(b.e/tt),d=d.slice(),a=h-t,a){for(p=a<0,p?(e=d,a=-a,o=m.length):(e=m,t=h,o=d.length),r=Math.max(Math.ceil(c/tt),o)+2,a>r&&(a=r,e.length=1),e.reverse(),r=a;r--;)e.push(0);e.reverse()}else{for(r=d.length,o=m.length,p=r<o,p&&(o=r),r=0;r<o;r++)if(d[r]!=m[r]){p=d[r]<m[r];break}a=0}for(p&&(e=d,d=m,m=e,n.s=-n.s),o=d.length,r=m.length-o;r>0;--r)d[o++]=0;for(r=m.length;r>a;){if(d[--r]<m[r]){for(i=r;i&&d[--i]===0;)d[i]=ga-1;--d[i],d[r]+=ga}d[r]-=m[r]}for(;d[--o]===0;)d.pop();for(;d[0]===0;d.shift())--t;return d[0]?(n.d=d,n.e=dy(d,t),ot?qe(n,c,u):n):new _(u===3?-0:0)};we.modulo=we.mod=function(n){var e,t=this,r=t.constructor;return n=new r(n),!t.d||!n.s||n.d&&!n.d[0]?new r(NaN):!n.d||t.d&&!t.d[0]?qe(new r(t),r.precision,r.rounding):(ot=!1,r.modulo==9?(e=Zt(t,n.abs(),0,3,1),e.s*=n.s):e=Zt(t,n,0,r.modulo,1),e=e.times(n),ot=!0,t.minus(e))};we.naturalExponential=we.exp=function(){return W_(this)};we.naturalLogarithm=we.ln=function(){return Xo(this)};we.negated=we.neg=function(){var n=new this.constructor(this);return n.s=-n.s,qe(n)};we.plus=we.add=function(n){var e,t,r,i,a,o,c,u,d,h,p=this,m=p.constructor;if(n=new m(n),!p.d||!n.d)return!p.s||!n.s?n=new m(NaN):p.d||(n=new m(n.d||p.s===n.s?p:NaN)),n;if(p.s!=n.s)return n.s=-n.s,p.minus(n);if(d=p.d,h=n.d,c=m.precision,u=m.rounding,!d[0]||!h[0])return h[0]||(n=new m(p)),ot?qe(n,c,u):n;if(a=Vr(p.e/tt),r=Vr(n.e/tt),d=d.slice(),i=a-r,i){for(i<0?(t=d,i=-i,o=h.length):(t=h,r=a,o=d.length),a=Math.ceil(c/tt),o=a>o?a+1:o+1,i>o&&(i=o,t.length=1),t.reverse();i--;)t.push(0);t.reverse()}for(o=d.length,i=h.length,o-i<0&&(i=o,t=h,h=d,d=t),e=0;i;)e=(d[--i]=d[i]+h[i]+e)/ga|0,d[i]%=ga;for(e&&(d.unshift(e),++r),o=d.length;d[--o]==0;)d.pop();return n.d=d,n.e=dy(d,r),ot?qe(n,c,u):n};we.precision=we.sd=function(n){var e,t=this;if(n!==void 0&&n!==!!n&&n!==1&&n!==0)throw Error(hl+n);return t.d?(e=g5(t.d),n&&t.e+1>e&&(e=t.e+1)):e=NaN,e};we.round=function(){var n=this,e=n.constructor;return qe(new e(n),n.e+1,e.rounding)};we.sine=we.sin=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+tt,r.rounding=1,t=Eee(r,b5(r,t)),r.precision=n,r.rounding=e,qe(ks>2?t.neg():t,n,e,!0)):new r(NaN)};we.squareRoot=we.sqrt=function(){var n,e,t,r,i,a,o=this,c=o.d,u=o.e,d=o.s,h=o.constructor;if(d!==1||!c||!c[0])return new h(!d||d<0&&(!c||c[0])?NaN:c?o:1/0);for(ot=!1,d=Math.sqrt(+o),d==0||d==1/0?(e=Ar(c),(e.length+u)%2==0&&(e+="0"),d=Math.sqrt(e),u=Vr((u+1)/2)-(u<0||u%2),d==1/0?e="5e"+u:(e=d.toExponential(),e=e.slice(0,e.indexOf("e")+1)+u),r=new h(e)):r=new h(d.toString()),t=(u=h.precision)+3;;)if(a=r,r=a.plus(Zt(o,a,t+2,1)).times(.5),Ar(a.d).slice(0,t)===(e=Ar(r.d)).slice(0,t))if(e=e.slice(t-3,t+1),e=="9999"||!i&&e=="4999"){if(!i&&(qe(a,u+1,0),a.times(a).eq(o))){r=a;break}t+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(qe(r,u+1,1),n=!r.times(r).eq(o));break}return ot=!0,qe(r,u,h.rounding,n)};we.tangent=we.tan=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+10,r.rounding=1,t=t.sin(),t.s=1,t=Zt(t,new r(1).minus(t.times(t)).sqrt(),n+10,0),r.precision=n,r.rounding=e,qe(ks==2||ks==4?t.neg():t,n,e,!0)):new r(NaN)};we.times=we.mul=function(n){var e,t,r,i,a,o,c,u,d,h=this,p=h.constructor,m=h.d,b=(n=new p(n)).d;if(n.s*=h.s,!m||!m[0]||!b||!b[0])return new p(!n.s||m&&!m[0]&&!b||b&&!b[0]&&!m?NaN:!m||!b?n.s/0:n.s*0);for(t=Vr(h.e/tt)+Vr(n.e/tt),u=m.length,d=b.length,u<d&&(a=m,m=b,b=a,o=u,u=d,d=o),a=[],o=u+d,r=o;r--;)a.push(0);for(r=d;--r>=0;){for(e=0,i=u+r;i>r;)c=a[i]+b[r]*m[i-r-1]+e,a[i--]=c%ga|0,e=c/ga|0;a[i]=(a[i]+e)%ga|0}for(;!a[--o];)a.pop();return e?++t:a.shift(),n.d=a,n.e=dy(a,t),ot?qe(n,p.precision,p.rounding):n};we.toBinary=function(n,e){return OS(this,2,n,e)};we.toDecimalPlaces=we.toDP=function(n,e){var t=this,r=t.constructor;return t=new r(t),n===void 0?t:(oi(n,0,bl),e===void 0?e=r.rounding:oi(e,0,8),qe(t,n+t.e+1,e))};we.toExponential=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=ns(r,!0):(oi(n,0,bl),e===void 0?e=i.rounding:oi(e,0,8),r=qe(new i(r),n+1,e),t=ns(r,!0,n+1)),r.isNeg()&&!r.isZero()?"-"+t:t};we.toFixed=function(n,e){var t,r,i=this,a=i.constructor;return n===void 0?t=ns(i):(oi(n,0,bl),e===void 0?e=a.rounding:oi(e,0,8),r=qe(new a(i),n+i.e+1,e),t=ns(r,!1,n+r.e+1)),i.isNeg()&&!i.isZero()?"-"+t:t};we.toFraction=function(n){var e,t,r,i,a,o,c,u,d,h,p,m,b=this,_=b.d,w=b.constructor;if(!_)return new w(b);if(d=t=new w(1),r=u=new w(0),e=new w(r),a=e.e=g5(_)-b.e-1,o=a%tt,e.d[0]=rr(10,o<0?tt+o:o),n==null)n=a>0?e:d;else{if(c=new w(n),!c.isInt()||c.lt(d))throw Error(hl+c);n=c.gt(e)?a>0?e:d:c}for(ot=!1,c=new w(Ar(_)),h=w.precision,w.precision=a=_.length*tt*2;p=Zt(c,e,0,1,1),i=t.plus(p.times(r)),i.cmp(n)!=1;)t=r,r=i,i=d,d=u.plus(p.times(i)),u=i,i=e,e=c.minus(p.times(i)),c=i;return i=Zt(n.minus(t),r,0,1,1),u=u.plus(i.times(d)),t=t.plus(i.times(r)),u.s=d.s=b.s,m=Zt(d,r,a,1).minus(b).abs().cmp(Zt(u,t,a,1).minus(b).abs())<1?[d,r]:[u,t],w.precision=h,ot=!0,m};we.toHexadecimal=we.toHex=function(n,e){return OS(this,16,n,e)};we.toNearest=function(n,e){var t=this,r=t.constructor;if(t=new r(t),n==null){if(!t.d)return t;n=new r(1),e=r.rounding}else{if(n=new r(n),e===void 0?e=r.rounding:oi(e,0,8),!t.d)return n.s?t:n;if(!n.d)return n.s&&(n.s=t.s),n}return n.d[0]?(ot=!1,t=Zt(t,n,0,e,1).times(n),ot=!0,qe(t)):(n.s=t.s,t=n),t};we.toNumber=function(){return+this};we.toOctal=function(n,e){return OS(this,8,n,e)};we.toPower=we.pow=function(n){var e,t,r,i,a,o,c=this,u=c.constructor,d=+(n=new u(n));if(!c.d||!n.d||!c.d[0]||!n.d[0])return new u(rr(+c,d));if(c=new u(c),c.eq(1))return c;if(r=u.precision,a=u.rounding,n.eq(1))return qe(c,r,a);if(e=Vr(n.e/tt),e>=n.d.length-1&&(t=d<0?-d:d)<=bee)return i=m5(u,c,t,r),n.s<0?new u(1).div(i):qe(i,r,a);if(o=c.s,o<0){if(e<n.d.length-1)return new u(NaN);if((n.d[e]&1)==0&&(o=1),c.e==0&&c.d[0]==1&&c.d.length==1)return c.s=o,c}return t=rr(+c,d),e=t==0||!isFinite(t)?Vr(d*(Math.log("0."+Ar(c.d))/Math.LN10+c.e+1)):new u(t+"").e,e>u.maxE+1||e<u.minE-1?new u(e>0?o/0:0):(ot=!1,u.rounding=c.s=1,t=Math.min(12,(e+"").length),i=W_(n.times(Xo(c,r+t)),r),i.d&&(i=qe(i,r+5,1),pp(i.d,r,a)&&(e=r+10,i=qe(W_(n.times(Xo(c,e+t)),e),e+5,1),+Ar(i.d).slice(r+1,r+15)+1==1e14&&(i=qe(i,r+1,0)))),i.s=o,ot=!0,u.rounding=a,qe(i,r,a))};we.toPrecision=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=ns(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(oi(n,1,bl),e===void 0?e=i.rounding:oi(e,0,8),r=qe(new i(r),n,e),t=ns(r,n<=r.e||r.e<=i.toExpNeg,n)),r.isNeg()&&!r.isZero()?"-"+t:t};we.toSignificantDigits=we.toSD=function(n,e){var t=this,r=t.constructor;return n===void 0?(n=r.precision,e=r.rounding):(oi(n,1,bl),e===void 0?e=r.rounding:oi(e,0,8)),qe(new r(t),n,e)};we.toString=function(){var n=this,e=n.constructor,t=ns(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()&&!n.isZero()?"-"+t:t};we.truncated=we.trunc=function(){return qe(new this.constructor(this),this.e+1,1)};we.valueOf=we.toJSON=function(){var n=this,e=n.constructor,t=ns(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()?"-"+t:t};function Ar(n){var e,t,r,i=n.length-1,a="",o=n[0];if(i>0){for(a+=o,e=1;e<i;e++)r=n[e]+"",t=tt-r.length,t&&(a+=Bo(t)),a+=r;o=n[e],r=o+"",t=tt-r.length,t&&(a+=Bo(t))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}function oi(n,e,t){if(n!==~~n||n<e||n>t)throw Error(hl+n)}function pp(n,e,t,r){var i,a,o,c;for(a=n[0];a>=10;a/=10)--e;return--e<0?(e+=tt,i=0):(i=Math.ceil((e+1)/tt),e%=tt),a=rr(10,tt-e),c=n[i]%a|0,r==null?e<3?(e==0?c=c/100|0:e==1&&(c=c/10|0),o=t<4&&c==99999||t>3&&c==49999||c==5e4||c==0):o=(t<4&&c+1==a||t>3&&c+1==a/2)&&(n[i+1]/a/100|0)==rr(10,e-2)-1||(c==a/2||c==0)&&(n[i+1]/a/100|0)==0:e<4?(e==0?c=c/1e3|0:e==1?c=c/100|0:e==2&&(c=c/10|0),o=(r||t<4)&&c==9999||!r&&t>3&&c==4999):o=((r||t<4)&&c+1==a||!r&&t>3&&c+1==a/2)&&(n[i+1]/a/1e3|0)==rr(10,e-3)-1,o}function _0(n,e,t){for(var r,i=[0],a,o=0,c=n.length;o<c;){for(a=i.length;a--;)i[a]*=e;for(i[0]+=Y_.indexOf(n.charAt(o++)),r=0;r<i.length;r++)i[r]>t-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/t|0,i[r]%=t)}return i.reverse()}function _ee(n,e){var t,r,i;if(e.isZero())return e;r=e.d.length,r<32?(t=Math.ceil(r/3),i=(1/fy(4,t)).toString()):(t=16,i="2.3283064365386962890625e-10"),n.precision+=t,e=kd(n,1,e.times(i),new n(1));for(var a=t;a--;){var o=e.times(e);e=o.times(o).minus(o).times(8).plus(1)}return n.precision-=t,e}var Zt=(function(){function n(r,i,a){var o,c=0,u=r.length;for(r=r.slice();u--;)o=r[u]*i+c,r[u]=o%a|0,c=o/a|0;return c&&r.unshift(c),r}function e(r,i,a,o){var c,u;if(a!=o)u=a>o?1:-1;else for(c=u=0;c<a;c++)if(r[c]!=i[c]){u=r[c]>i[c]?1:-1;break}return u}function t(r,i,a,o){for(var c=0;a--;)r[a]-=c,c=r[a]<i[a]?1:0,r[a]=c*o+r[a]-i[a];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,a,o,c,u){var d,h,p,m,b,_,w,S,T,C,R,j,z,V,I,A,k,O,L,B,M=r.constructor,Q=r.s==i.s?1:-1,X=r.d,$=i.d;if(!X||!X[0]||!$||!$[0])return new M(!r.s||!i.s||(X?$&&X[0]==$[0]:!$)?NaN:X&&X[0]==0||!$?Q*0:Q/0);for(u?(b=1,h=r.e-i.e):(u=ga,b=tt,h=Vr(r.e/b)-Vr(i.e/b)),L=$.length,k=X.length,T=new M(Q),C=T.d=[],p=0;$[p]==(X[p]||0);p++);if($[p]>(X[p]||0)&&h--,a==null?(V=a=M.precision,o=M.rounding):c?V=a+(r.e-i.e)+1:V=a,V<0)C.push(1),_=!0;else{if(V=V/b+2|0,p=0,L==1){for(m=0,$=$[0],V++;(p<k||m)&&V--;p++)I=m*u+(X[p]||0),C[p]=I/$|0,m=I%$|0;_=m||p<k}else{for(m=u/($[0]+1)|0,m>1&&($=n($,m,u),X=n(X,m,u),L=$.length,k=X.length),A=L,R=X.slice(0,L),j=R.length;j<L;)R[j++]=0;B=$.slice(),B.unshift(0),O=$[0],$[1]>=u/2&&++O;do m=0,d=e($,R,L,j),d<0?(z=R[0],L!=j&&(z=z*u+(R[1]||0)),m=z/O|0,m>1?(m>=u&&(m=u-1),w=n($,m,u),S=w.length,j=R.length,d=e(w,R,S,j),d==1&&(m--,t(w,L<S?B:$,S,u))):(m==0&&(d=m=1),w=$.slice()),S=w.length,S<j&&w.unshift(0),t(R,w,j,u),d==-1&&(j=R.length,d=e($,R,L,j),d<1&&(m++,t(R,L<j?B:$,j,u))),j=R.length):d===0&&(m++,R=[0]),C[p++]=m,d&&R[0]?R[j++]=X[A]||0:(R=[X[A]],j=1);while((A++<k||R[0]!==void 0)&&V--);_=R[0]!==void 0}C[0]||C.shift()}if(b==1)T.e=h,u5=_;else{for(p=1,m=C[0];m>=10;m/=10)p++;T.e=p+h*b-1,qe(T,c?a+T.e+1:a,o,_)}return T}})();function qe(n,e,t,r){var i,a,o,c,u,d,h,p,m,b=n.constructor;e:if(e!=null){if(p=n.d,!p)return n;for(i=1,c=p[0];c>=10;c/=10)i++;if(a=e-i,a<0)a+=tt,o=e,h=p[m=0],u=h/rr(10,i-o-1)%10|0;else if(m=Math.ceil((a+1)/tt),c=p.length,m>=c)if(r){for(;c++<=m;)p.push(0);h=u=0,i=1,a%=tt,o=a-tt+1}else break e;else{for(h=c=p[m],i=1;c>=10;c/=10)i++;a%=tt,o=a-tt+i,u=o<0?0:h/rr(10,i-o-1)%10|0}if(r=r||e<0||p[m+1]!==void 0||(o<0?h:h%rr(10,i-o-1)),d=t<4?(u||r)&&(t==0||t==(n.s<0?3:2)):u>5||u==5&&(t==4||r||t==6&&(a>0?o>0?h/rr(10,i-o):0:p[m-1])%10&1||t==(n.s<0?8:7)),e<1||!p[0])return p.length=0,d?(e-=n.e+1,p[0]=rr(10,(tt-e%tt)%tt),n.e=-e||0):p[0]=n.e=0,n;if(a==0?(p.length=m,c=1,m--):(p.length=m+1,c=rr(10,tt-a),p[m]=o>0?(h/rr(10,i-o)%rr(10,o)|0)*c:0),d)for(;;)if(m==0){for(a=1,o=p[0];o>=10;o/=10)a++;for(o=p[0]+=c,c=1;o>=10;o/=10)c++;a!=c&&(n.e++,p[0]==ga&&(p[0]=1));break}else{if(p[m]+=c,p[m]!=ga)break;p[m--]=0,c=1}for(a=p.length;p[--a]===0;)p.pop()}return ot&&(n.e>b.maxE?(n.d=null,n.e=NaN):n.e<b.minE&&(n.e=0,n.d=[0])),n}function ns(n,e,t){if(!n.isFinite())return y5(n);var r,i=n.e,a=Ar(n.d),o=a.length;return e?(t&&(r=t-o)>0?a=a.charAt(0)+"."+a.slice(1)+Bo(r):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(n.e<0?"e":"e+")+n.e):i<0?(a="0."+Bo(-i-1)+a,t&&(r=t-o)>0&&(a+=Bo(r))):i>=o?(a+=Bo(i+1-o),t&&(r=t-i-1)>0&&(a=a+"."+Bo(r))):((r=i+1)<o&&(a=a.slice(0,r)+"."+a.slice(r)),t&&(r=t-o)>0&&(i+1===o&&(a+="."),a+=Bo(r))),a}function dy(n,e){var t=n[0];for(e*=tt;t>=10;t/=10)e++;return e}function mv(n,e,t){if(e>xee)throw ot=!0,t&&(n.precision=t),Error(d5);return qe(new n(pv),e,1,!0)}function Ha(n,e,t){if(e>X_)throw Error(d5);return qe(new n(gv),e,t,!0)}function g5(n){var e=n.length-1,t=e*tt+1;if(e=n[e],e){for(;e%10==0;e/=10)t--;for(e=n[0];e>=10;e/=10)t++}return t}function Bo(n){for(var e="";n--;)e+="0";return e}function m5(n,e,t,r){var i,a=new n(1),o=Math.ceil(r/tt+4);for(ot=!1;;){if(t%2&&(a=a.times(e),zk(a.d,o)&&(i=!0)),t=Vr(t/2),t===0){t=a.d.length-1,i&&a.d[t]===0&&++a.d[t];break}e=e.times(e),zk(e.d,o)}return ot=!0,a}function jk(n){return n.d[n.d.length-1]&1}function v5(n,e,t){for(var r,i,a=new n(e[0]),o=0;++o<e.length;){if(i=new n(e[o]),!i.s){a=i;break}r=a.cmp(i),(r===t||r===0&&a.s===t)&&(a=i)}return a}function W_(n,e){var t,r,i,a,o,c,u,d=0,h=0,p=0,m=n.constructor,b=m.rounding,_=m.precision;if(!n.d||!n.d[0]||n.e>17)return new m(n.d?n.d[0]?n.s<0?0:1/0:1:n.s?n.s<0?0:n:NaN);for(e==null?(ot=!1,u=_):u=e,c=new m(.03125);n.e>-2;)n=n.times(c),p+=5;for(r=Math.log(rr(2,p))/Math.LN10*2+5|0,u+=r,t=a=o=new m(1),m.precision=u;;){if(a=qe(a.times(n),u,1),t=t.times(++h),c=o.plus(Zt(a,t,u,1)),Ar(c.d).slice(0,u)===Ar(o.d).slice(0,u)){for(i=p;i--;)o=qe(o.times(o),u,1);if(e==null)if(d<3&&pp(o.d,u-r,b,d))m.precision=u+=10,t=a=c=new m(1),h=0,d++;else return qe(o,m.precision=_,b,ot=!0);else return m.precision=_,o}o=c}}function Xo(n,e){var t,r,i,a,o,c,u,d,h,p,m,b=1,_=10,w=n,S=w.d,T=w.constructor,C=T.rounding,R=T.precision;if(w.s<0||!S||!S[0]||!w.e&&S[0]==1&&S.length==1)return new T(S&&!S[0]?-1/0:w.s!=1?NaN:S?0:w);if(e==null?(ot=!1,h=R):h=e,T.precision=h+=_,t=Ar(S),r=t.charAt(0),Math.abs(a=w.e)<15e14){for(;r<7&&r!=1||r==1&&t.charAt(1)>3;)w=w.times(n),t=Ar(w.d),r=t.charAt(0),b++;a=w.e,r>1?(w=new T("0."+t),a++):w=new T(r+"."+t.slice(1))}else return d=mv(T,h+2,R).times(a+""),w=Xo(new T(r+"."+t.slice(1)),h-_).plus(d),T.precision=R,e==null?qe(w,R,C,ot=!0):w;for(p=w,u=o=w=Zt(w.minus(1),w.plus(1),h,1),m=qe(w.times(w),h,1),i=3;;){if(o=qe(o.times(m),h,1),d=u.plus(Zt(o,new T(i),h,1)),Ar(d.d).slice(0,h)===Ar(u.d).slice(0,h))if(u=u.times(2),a!==0&&(u=u.plus(mv(T,h+2,R).times(a+""))),u=Zt(u,new T(b),h,1),e==null)if(pp(u.d,h-_,C,c))T.precision=h+=_,d=o=w=Zt(p.minus(1),p.plus(1),h,1),m=qe(w.times(w),h,1),i=c=1;else return qe(u,T.precision=R,C,ot=!0);else return T.precision=R,u;u=d,i+=2}}function y5(n){return String(n.s*n.s/0)}function w0(n,e){var t,r,i;for((t=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(t<0&&(t=r),t+=+e.slice(r+1),e=e.substring(0,r)):t<0&&(t=e.length),r=0;e.charCodeAt(r)===48;r++);for(i=e.length;e.charCodeAt(i-1)===48;--i);if(e=e.slice(r,i),e){if(i-=r,n.e=t=t-r-1,n.d=[],r=(t+1)%tt,t<0&&(r+=tt),r<i){for(r&&n.d.push(+e.slice(0,r)),i-=tt;r<i;)n.d.push(+e.slice(r,r+=tt));e=e.slice(r),r=tt-e.length}else r-=i;for(;r--;)e+="0";n.d.push(+e),ot&&(n.e>n.constructor.maxE?(n.d=null,n.e=NaN):n.e<n.constructor.minE&&(n.e=0,n.d=[0]))}else n.e=0,n.d=[0];return n}function wee(n,e){var t,r,i,a,o,c,u,d,h;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),p5.test(e))return w0(n,e)}else if(e==="Infinity"||e==="NaN")return+e||(n.s=NaN),n.e=NaN,n.d=null,n;if(vee.test(e))t=16,e=e.toLowerCase();else if(mee.test(e))t=2;else if(yee.test(e))t=8;else throw Error(hl+e);for(a=e.search(/p/i),a>0?(u=+e.slice(a+1),e=e.substring(2,a)):e=e.slice(2),a=e.indexOf("."),o=a>=0,r=n.constructor,o&&(e=e.replace(".",""),c=e.length,a=c-a,i=m5(r,new r(t),a,a*2)),d=_0(e,t,ga),h=d.length-1,a=h;d[a]===0;--a)d.pop();return a<0?new r(n.s*0):(n.e=dy(d,h),n.d=d,ot=!1,o&&(n=Zt(n,i,c*4)),u&&(n=n.times(Math.abs(u)<54?rr(2,u):Nd.pow(2,u))),ot=!0,n)}function Eee(n,e){var t,r=e.d.length;if(r<3)return e.isZero()?e:kd(n,2,e,e);t=1.4*Math.sqrt(r),t=t>16?16:t|0,e=e.times(1/fy(5,t)),e=kd(n,2,e,e);for(var i,a=new n(5),o=new n(16),c=new n(20);t--;)i=e.times(e),e=e.times(a.plus(i.times(o.times(i).minus(c))));return e}function kd(n,e,t,r,i){var a,o,c,u,d=n.precision,h=Math.ceil(d/tt);for(ot=!1,u=t.times(t),c=new n(r);;){if(o=Zt(c.times(u),new n(e++*e++),d,1),c=i?r.plus(o):r.minus(o),r=Zt(o.times(u),new n(e++*e++),d,1),o=c.plus(r),o.d[h]!==void 0){for(a=h;o.d[a]===c.d[a]&&a--;);if(a==-1)break}a=c,c=r,r=o,o=a}return ot=!0,o.d.length=h+1,o}function fy(n,e){for(var t=n;--e;)t*=n;return t}function b5(n,e){var t,r=e.s<0,i=Ha(n,n.precision,1),a=i.times(.5);if(e=e.abs(),e.lte(a))return ks=r?4:1,e;if(t=e.divToInt(i),t.isZero())ks=r?3:2;else{if(e=e.minus(t.times(i)),e.lte(a))return ks=jk(t)?r?2:3:r?4:1,e;ks=jk(t)?r?1:4:r?3:2}return e.minus(i).abs()}function OS(n,e,t,r){var i,a,o,c,u,d,h,p,m,b=n.constructor,_=t!==void 0;if(_?(oi(t,1,bl),r===void 0?r=b.rounding:oi(r,0,8)):(t=b.precision,r=b.rounding),!n.isFinite())h=y5(n);else{for(h=ns(n),o=h.indexOf("."),_?(i=2,e==16?t=t*4-3:e==8&&(t=t*3-2)):i=e,o>=0&&(h=h.replace(".",""),m=new b(1),m.e=h.length-o,m.d=_0(ns(m),10,i),m.e=m.d.length),p=_0(h,10,i),a=u=p.length;p[--u]==0;)p.pop();if(!p[0])h=_?"0p+0":"0";else{if(o<0?a--:(n=new b(n),n.d=p,n.e=a,n=Zt(n,m,t,r,0,i),p=n.d,a=n.e,d=u5),o=p[t],c=i/2,d=d||p[t+1]!==void 0,d=r<4?(o!==void 0||d)&&(r===0||r===(n.s<0?3:2)):o>c||o===c&&(r===4||d||r===6&&p[t-1]&1||r===(n.s<0?8:7)),p.length=t,d)for(;++p[--t]>i-1;)p[t]=0,t||(++a,p.unshift(1));for(u=p.length;!p[u-1];--u);for(o=0,h="";o<u;o++)h+=Y_.charAt(p[o]);if(_){if(u>1)if(e==16||e==8){for(o=e==16?4:3,--u;u%o;u++)h+="0";for(p=_0(h,i,e),u=p.length;!p[u-1];--u);for(o=1,h="1.";o<u;o++)h+=Y_.charAt(p[o])}else h=h.charAt(0)+"."+h.slice(1);h=h+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)h="0"+h;h="0."+h}else if(++a>u)for(a-=u;a--;)h+="0";else a<u&&(h=h.slice(0,a)+"."+h.slice(a))}h=(e==16?"0x":e==2?"0b":e==8?"0o":"")+h}return n.s<0?"-"+h:h}function zk(n,e){if(n.length>e)return n.length=e,!0}function See(n){return new this(n).abs()}function Tee(n){return new this(n).acos()}function Aee(n){return new this(n).acosh()}function Cee(n,e){return new this(n).plus(e)}function Iee(n){return new this(n).asin()}function Ree(n){return new this(n).asinh()}function Dee(n){return new this(n).atan()}function kee(n){return new this(n).atanh()}function Nee(n,e){n=new this(n),e=new this(e);var t,r=this.precision,i=this.rounding,a=r+4;return!n.s||!e.s?t=new this(NaN):!n.d&&!e.d?(t=Ha(this,a,1).times(e.s>0?.25:.75),t.s=n.s):!e.d||n.isZero()?(t=e.s<0?Ha(this,r,i):new this(0),t.s=n.s):!n.d||e.isZero()?(t=Ha(this,a,1).times(.5),t.s=n.s):e.s<0?(this.precision=a,this.rounding=1,t=this.atan(Zt(n,e,a,1)),e=Ha(this,a,1),this.precision=r,this.rounding=i,t=n.s<0?t.minus(e):t.plus(e)):t=this.atan(Zt(n,e,a,1)),t}function Mee(n){return new this(n).cbrt()}function Pee(n){return qe(n=new this(n),n.e+1,2)}function Oee(n,e,t){return new this(n).clamp(e,t)}function Vee(n){if(!n||typeof n!="object")throw Error(uy+"Object expected");var e,t,r,i=n.defaults===!0,a=["precision",1,bl,"rounding",0,8,"toExpNeg",-Zu,0,"toExpPos",0,Zu,"maxE",0,Zu,"minE",-Zu,0,"modulo",0,9];for(e=0;e<a.length;e+=3)if(t=a[e],i&&(this[t]=K_[t]),(r=n[t])!==void 0)if(Vr(r)===r&&r>=a[e+1]&&r<=a[e+2])this[t]=r;else throw Error(hl+t+": "+r);if(t="crypto",i&&(this[t]=K_[t]),(r=n[t])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[t]=!0;else throw Error(f5);else this[t]=!1;else throw Error(hl+t+": "+r);return this}function jee(n){return new this(n).cos()}function zee(n){return new this(n).cosh()}function x5(n){var e,t,r;function i(a){var o,c,u,d=this;if(!(d instanceof i))return new i(a);if(d.constructor=i,Lk(a)){d.s=a.s,ot?!a.d||a.e>i.maxE?(d.e=NaN,d.d=null):a.e<i.minE?(d.e=0,d.d=[0]):(d.e=a.e,d.d=a.d.slice()):(d.e=a.e,d.d=a.d?a.d.slice():a.d);return}if(u=typeof a,u==="number"){if(a===0){d.s=1/a<0?-1:1,d.e=0,d.d=[0];return}if(a<0?(a=-a,d.s=-1):d.s=1,a===~~a&&a<1e7){for(o=0,c=a;c>=10;c/=10)o++;ot?o>i.maxE?(d.e=NaN,d.d=null):o<i.minE?(d.e=0,d.d=[0]):(d.e=o,d.d=[a]):(d.e=o,d.d=[a]);return}if(a*0!==0){a||(d.s=NaN),d.e=NaN,d.d=null;return}return w0(d,a.toString())}if(u==="string")return(c=a.charCodeAt(0))===45?(a=a.slice(1),d.s=-1):(c===43&&(a=a.slice(1)),d.s=1),p5.test(a)?w0(d,a):wee(d,a);if(u==="bigint")return a<0?(a=-a,d.s=-1):d.s=1,w0(d,a.toString());throw Error(hl+a)}if(i.prototype=we,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=Vee,i.clone=x5,i.isDecimal=Lk,i.abs=See,i.acos=Tee,i.acosh=Aee,i.add=Cee,i.asin=Iee,i.asinh=Ree,i.atan=Dee,i.atanh=kee,i.atan2=Nee,i.cbrt=Mee,i.ceil=Pee,i.clamp=Oee,i.cos=jee,i.cosh=zee,i.div=Lee,i.exp=Bee,i.floor=Uee,i.hypot=Fee,i.ln=Gee,i.log=qee,i.log10=$ee,i.log2=Hee,i.max=Yee,i.min=Kee,i.mod=Xee,i.mul=Wee,i.pow=Qee,i.random=Zee,i.round=Jee,i.sign=ete,i.sin=tte,i.sinh=nte,i.sqrt=rte,i.sub=ite,i.sum=ate,i.tan=ste,i.tanh=ote,i.trunc=lte,n===void 0&&(n={}),n&&n.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<r.length;)n.hasOwnProperty(t=r[e++])||(n[t]=this[t]);return i.config(n),i}function Lee(n,e){return new this(n).div(e)}function Bee(n){return new this(n).exp()}function Uee(n){return qe(n=new this(n),n.e+1,3)}function Fee(){var n,e,t=new this(0);for(ot=!1,n=0;n<arguments.length;)if(e=new this(arguments[n++]),e.d)t.d&&(t=t.plus(e.times(e)));else{if(e.s)return ot=!0,new this(1/0);t=e}return ot=!0,t.sqrt()}function Lk(n){return n instanceof Nd||n&&n.toStringTag===h5||!1}function Gee(n){return new this(n).ln()}function qee(n,e){return new this(n).log(e)}function Hee(n){return new this(n).log(2)}function $ee(n){return new this(n).log(10)}function Yee(){return v5(this,arguments,-1)}function Kee(){return v5(this,arguments,1)}function Xee(n,e){return new this(n).mod(e)}function Wee(n,e){return new this(n).mul(e)}function Qee(n,e){return new this(n).pow(e)}function Zee(n){var e,t,r,i,a=0,o=new this(1),c=[];if(n===void 0?n=this.precision:oi(n,1,bl),r=Math.ceil(n/tt),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));a<r;)i=e[a],i>=429e7?e[a]=crypto.getRandomValues(new Uint32Array(1))[0]:c[a++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(r*=4);a<r;)i=e[a]+(e[a+1]<<8)+(e[a+2]<<16)+((e[a+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(e,a):(c.push(i%1e7),a+=4);a=r/4}else throw Error(f5);else for(;a<r;)c[a++]=Math.random()*1e7|0;for(r=c[--a],n%=tt,r&&n&&(i=rr(10,tt-n),c[a]=(r/i|0)*i);c[a]===0;a--)c.pop();if(a<0)t=0,c=[0];else{for(t=-1;c[0]===0;t-=tt)c.shift();for(r=1,i=c[0];i>=10;i/=10)r++;r<tt&&(t-=tt-r)}return o.e=t,o.d=c,o}function Jee(n){return qe(n=new this(n),n.e+1,this.rounding)}function ete(n){return n=new this(n),n.d?n.d[0]?n.s:0*n.s:n.s||NaN}function tte(n){return new this(n).sin()}function nte(n){return new this(n).sinh()}function rte(n){return new this(n).sqrt()}function ite(n,e){return new this(n).sub(e)}function ate(){var n=0,e=arguments,t=new this(e[n]);for(ot=!1;t.s&&++n<e.length;)t=t.plus(e[n]);return ot=!0,qe(t,this.precision,this.rounding)}function ste(n){return new this(n).tan()}function ote(n){return new this(n).tanh()}function lte(n){return qe(n=new this(n),n.e+1,1)}we[Symbol.for("nodejs.util.inspect.custom")]=we.toString;we[Symbol.toStringTag]="Decimal";var Nd=we.constructor=x5(K_);pv=new Nd(pv);gv=new Nd(gv);const cte=n=>{if(!n)return null;if(n instanceof Date)return n;if(typeof n=="object"&&typeof n.toDate=="function")return n.toDate();if(typeof n=="object"&&n.seconds!==void 0)return new Date(n.seconds*1e3);if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?null:e}if(typeof n=="number"){const e=new Date(n);return isNaN(e.getTime())?null:e}return null},ute=()=>{const{envelopes:n,transactions:e,fetchData:t,isLoading:r,isOnline:i,reorderEnvelopes:a}=gr(),{currentUser:o}=Yi(),{currentMonth:c,incomeSources:u,allocations:d,deleteIncomeSource:h,setEnvelopeAllocation:p,copyPreviousMonthAllocations:m,isLoading:b}=gr(),{showToast:_}=zc(),[w,S]=F.useState(!1),T=F.useRef(null),[C,R]=F.useState(!1),j=!C||r||b,[z,V]=F.useState([]),I=F.useRef([]),[A,k]=F.useState([]),O=F.useRef([]),L=F.useCallback(Y=>{if(n.find(te=>te.id===Y)?.isPiggybank){const te=gr.getState().getEnvelopeBalance(Y);return new Nd(te)}const ie=gr.getState().getEnvelopeBalance(Y,c);return new Nd(ie)},[n,c]);F.useEffect(()=>{const Y=n.filter(ne=>{if(!ne.isPiggybank||!ne.isActive)return!1;if(ne.createdAt)try{const ie=cte(ne.createdAt);if(!ie)return console.error(` Invalid creation date for piggybank ${ne.name}:`,ne.createdAt),!1;const te=`${ie.getFullYear()}-${String(ie.getMonth()+1).padStart(2,"0")}`;return c>=te}catch(ie){return console.error(` Error processing piggybank ${ne.name}:`,ie,{createdAt:ne.createdAt,typeofCreatedAt:typeof ne.createdAt}),!1}return!0}).sort((ne,ie)=>{const te=ne.orderIndex??0,se=ie.orderIndex??0;return te-se});k(Y),O.current=Y},[n,c]);const B=A,M=z;F.useEffect(()=>(T.current=setTimeout(()=>{S(!0)},8e3),t(),R(!0),()=>{T.current&&clearTimeout(T.current)}),[]),F.useEffect(()=>{C&&!r&&!b&&(S(!1),T.current&&clearTimeout(T.current))},[C,r,b]),F.useEffect(()=>{const Y=n.filter(ne=>{if(ne.isPiggybank||ne.isActive===!1)return!1;const te=(d[c]||[]).some(me=>me.envelopeId===ne.id),se=e.some(me=>me.envelopeId===ne.id&&(me.month===c||me.date.startsWith(c)));return te||se}).sort((ne,ie)=>{const te=ne.orderIndex??0,se=ie.orderIndex??0;return te-se});V(Y),I.current=Y},[n,d,c,e]);const Q=(u[c]||[]).reduce((Y,ne)=>Y+ne.amount,0),X=(d[c]||[]).filter(Y=>M.some(ne=>ne.id===Y.envelopeId)||B.some(ne=>ne.id===Y.envelopeId)).reduce((Y,ne)=>Y+ne.budgetedAmount,0),$=Q-X,H=F.useCallback(async Y=>{if(!Y.length)return;const ne=Y.map(ie=>ie.id);try{await a(ne)}catch(ie){console.error("Failed to persist envelope order:",ie),_("Failed to save envelope order","error")}},[a,_]),Z=F.useCallback(async Y=>{await H(Y)},[H]),re=F.useCallback(Y=>{h(c,Y.id).catch(console.error),_(`Deleted "${Y.name}"`,"neutral")},[h,c,_]),de=F.useCallback(async Y=>{try{const ne=Y||c;console.log(" Copying to month:",ne),await m(ne),_("Previous month budget copied","success")}catch(ne){console.error("Error copying previous month:",ne),_("Failed to copy previous month","error")}},[m,_,c]),U=F.useCallback(async()=>{if(!o||!c){_("Cannot clear data: not logged in or no month selected","error");return}try{await gee.clearMonthData(o.id,c),await t(),_(`"${c}" budget and transactions cleared successfully`,"success")}catch(Y){console.error("Error clearing month data:",Y),_("Failed to clear month data","error")}},[o,c,t,_]);return{visibleEnvelopes:M,piggybanks:B,incomeSources:u,availableToBudget:$,currentMonth:c,allocations:d,transactions:e,isLoading:r,isInitialLoading:j,isOnline:i,showTimeoutMessage:w,getEnvelopeBalance:L,fetchData:t,reorderEnvelopes:Z,deleteIncomeSource:re,clearMonthData:U,copyFromPreviousMonth:de,setEnvelopeAllocation:p,localOrderRef:I,setLocalEnvelopes:V,localPiggybankOrderRef:O,setLocalPiggybanks:k}},dte=({currentMonth:n,onMonthChange:e,budgetStatus:t})=>{const[r,i]=n.split("-").map(Number),o=["January","February","March","April","May","June","July","August","September","October","November","December"][i-1],c=()=>{let p=r,m=i-1;m<1&&(p=r-1,m=12);const b=`${p}-${m.toString().padStart(2,"0")}`;e(b)},u=()=>{let p=r,m=i+1;m>12&&(p=r+1,m=1);const b=`${p}-${m.toString().padStart(2,"0")}`;e(b)},d=()=>{const p=new Date,m=`${p.getFullYear()}-${(p.getMonth()+1).toString().padStart(2,"0")}`;e(m)},h=()=>{if(!t)return null;const{amount:p,totalIncome:m,totalAllocated:b}=t,_=typeof p=="number"?p:0,w=typeof m=="number"?m:0,S=typeof b=="number"?b:0,T=Math.abs(_)<=.01,C=_<-.01,R=w>0?S/w*100:0,j=T?100:Math.min(R,100);let z="text-gray-900 dark:text-white",V="bg-green-500",I="Left to Budget";return T?(z="text-green-600 dark:text-emerald-400",V="bg-green-500",I="Every dollar is working "):C?(z="text-red-600 dark:text-red-400",V="bg-red-500",I="You're not in Congress! Try again"):z="text-gray-900 dark:text-white",y.jsxs("div",{className:"flex-1 flex flex-col justify-center ml-4 min-w-0",children:[y.jsxs("div",{className:"flex items-baseline justify-start mb-1",children:[y.jsx("span",{className:`text-xs font-medium truncate mr-1.5 ${C?"text-red-600 dark:text-red-400":T?"text-green-600 dark:text-emerald-400":"text-gray-500 dark:text-zinc-500"}`,children:I}),!T&&y.jsxs("span",{className:`text-sm font-bold truncate ${z}`,children:[C?"-":"","$",Math.abs(_).toFixed(2)]})]}),y.jsx("div",{className:"w-full h-1.5 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:y.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${V}`,style:{width:`${j}%`}})})]})};return y.jsx("div",{className:"py-2",children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{className:`flex items-center ${t?"flex-shrink-0":"w-full justify-between"}`,children:[y.jsx("button",{onClick:c,className:"p-1.5 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Previous month",children:y.jsx(aL,{size:20})}),y.jsx("div",{className:`text-center ${t?"mx-1":"flex-1"}`,children:y.jsxs("button",{onClick:d,className:"text-base font-semibold text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors whitespace-nowrap",title:"Click to go to current month",children:[o," ",r]})}),y.jsx("button",{onClick:u,className:"p-1.5 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Next month",children:y.jsx($l,{size:20})})]}),t&&h()]})})},fte=()=>{const[n,e]=F.useState(!1),t=F.useRef(null),{currentUser:r,logout:i}=Yi(),{handleUserLogout:a}=gr(),o=as();F.useEffect(()=>{const d=h=>{t.current&&!t.current.contains(h.target)&&e(!1)};if(n)return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[n]);const c=async()=>{if(window.confirm("Are you sure you want to log out? This will clear all your data from the app until you log back in."))try{a(),i(),o("/"),e(!1)}catch(d){console.error("Logout failed:",d)}};if(!r)return null;const u=r.displayName?.charAt(0)?.toUpperCase()||r.email?.charAt(0)?.toUpperCase()||"U";return y.jsxs("div",{className:"relative",ref:t,children:[y.jsxs("button",{onClick:()=>e(!n),className:"flex items-center gap-2 px-3 py-1.5 rounded-lg hover:bg-gray-100 dark:hover:bg-zinc-800 transition-colors",children:[y.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-semibold",children:u}),y.jsx("span",{className:"hidden sm:block text-sm font-medium text-gray-700 dark:text-gray-300",children:r.displayName||r.email?.split("@")[0]||"User"}),y.jsx(rw,{size:16,className:`text-gray-500 dark:text-gray-400 transition-transform ${n?"rotate-180":""}`})]}),n&&y.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-zinc-900 rounded-xl shadow-lg border border-gray-200 dark:border-zinc-800 overflow-hidden z-50",children:[y.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-zinc-800",children:y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold",children:u}),y.jsxs("div",{className:"flex-1 min-w-0",children:[y.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-white truncate",children:r.displayName||r.email?.split("@")[0]||"User"}),y.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-400 truncate",children:r.email})]})]})}),y.jsxs("div",{className:"py-1",children:[y.jsxs("button",{onClick:()=>{o("/settings"),e(!1)},className:"w-full px-4 py-2.5 flex items-center gap-3 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:[y.jsx(lN,{size:18,className:"text-gray-500 dark:text-gray-400"}),"Settings"]}),y.jsxs("button",{onClick:c,className:"w-full px-4 py-2.5 flex items-center gap-3 text-left text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/10 transition-colors",children:[y.jsx(BL,{size:18}),"Log Out"]})]})]})]})},Jp=({children:n,onDelete:e,threshold:t=-100})=>{const r=FX(),[i,a]=F.useState(!1),o=F.useRef(0),c=()=>{a(!0),o.current=Date.now()},u=async(d,h)=>{const p=h.offset.x,m=h.velocity.x;if(setTimeout(()=>a(!1),100),p<t||p<-50&&m<-500){const b=e();b===!1?r.start({x:0}):b instanceof Promise&&b.then(_=>{_===!1&&r.start({x:0})})}else r.start({x:0})};return y.jsxs("div",{className:"relative w-full overflow-hidden mb-2 rounded-xl group",children:[y.jsx("div",{className:"absolute inset-0 bg-red-500 flex items-center justify-end pr-6 rounded-xl",children:y.jsx(mx,{className:"text-white w-6 h-6"})}),y.jsx(mr.div,{drag:"x",dragConstraints:{left:-500,right:0},dragElastic:.1,onDragStart:c,onDragEnd:u,animate:r,className:`relative bg-white dark:bg-zinc-900 rounded-xl ${i?"z-20":"z-10"}`,style:{touchAction:"pan-y",pointerEvents:i?"none":"auto"},children:n})]})},hte=({isVisible:n,onClose:e,mode:t,initialIncomeSource:r})=>{const{addIncomeSource:i,updateIncomeSource:a,currentMonth:o}=gr(),{showToast:c}=zc(),[u,d]=F.useState(""),[h,p]=F.useState(""),[m,b]=F.useState(!1);F.useEffect(()=>{if(!n)return;const w=window.setTimeout(()=>{t==="edit"&&r?(d(r.name),p(r.amount.toString())):(d(""),p(""))},0);return()=>window.clearTimeout(w)},[n,t,r]);const _=async w=>{if(w.preventDefault(),!u.trim()||!h||parseFloat(h)<=0){c("Please fill in all required fields with valid values","error");return}b(!0);try{if(t==="add")await i(o,{name:u.trim(),amount:parseFloat(h),month:o,userId:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),c("Income source added successfully","success");else{if(!r){c("Error: No income source to edit","error");return}await a(o,{...r,name:u.trim(),amount:parseFloat(h),updatedAt:new Date().toISOString()}),c(`Updated "${u.trim()}" income source`,"success")}e()}catch(S){console.error("Error saving income source:",S),c("Failed to save income source. Please try again.","error")}finally{b(!1)}};return y.jsx(xi,{children:n&&y.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[y.jsx(mr.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black bg-opacity-50"}),y.jsxs(mr.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[y.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[y.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:t==="add"?"Add Income Source":"Edit Income Source"}),y.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",children:""})]}),y.jsxs("form",{onSubmit:_,className:"p-6 space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Income Source Name *"}),y.jsx("input",{type:"text",value:u,onChange:w=>d(w.target.value),placeholder:"e.g., Primary Job, Freelance, Investments",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Amount *"}),y.jsxs("div",{className:"relative",children:[y.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-zinc-400",children:"$"}),y.jsx("input",{type:"text",inputMode:"numeric",value:h,onChange:w=>{const S=w.target.value.replace(/\D/g,"");if(!S){p("");return}const C=(parseInt(S,10)/100).toFixed(2);p(C)},placeholder:"0.00",className:"w-full pl-8 pr-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]})]}),y.jsxs("div",{className:"flex gap-3 pt-4",children:[y.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),y.jsx("button",{type:"submit",disabled:m||!u.trim()||!h||parseFloat(h)<=0,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m?"Saving...":t==="add"?"Add Income":"Save Changes"})]})]})]})]})})},pte=({isVisible:n,onClose:e,onConfirm:t,currentMonth:r,incomeCount:i,totalIncome:a,allocationCount:o,totalAllocated:c,transactionCount:u,totalTransactionAmount:d,isLoading:h=!1})=>{const[p,m]=F.useState(""),[b,_]=F.useState("confirm"),w=C=>{const[R,j]=C.split("-");return new Date(parseInt(R),parseInt(j)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},S=()=>{b==="confirm"?_("type"):b==="type"&&p==="START FRESH"&&t()},T=()=>{_("confirm"),m(""),e()};return y.jsx(xi,{children:n&&y.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[y.jsx(mr.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:T,className:"absolute inset-0 bg-black bg-opacity-50"}),y.jsxs(mr.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[y.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[y.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Start Fresh for ",w(r)]}),y.jsx("button",{onClick:T,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",disabled:h,children:""})]}),y.jsx("div",{className:"p-6 space-y-4",children:b==="confirm"?y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:y.jsxs("div",{className:"flex items-start",children:[y.jsx("div",{className:"flex-shrink-0",children:y.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:y.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),y.jsxs("div",{className:"ml-3",children:[y.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"This action will permanently delete:"}),y.jsx("div",{className:"mt-2 text-sm text-red-700 dark:text-red-300",children:y.jsxs("ul",{className:"space-y-1",children:[y.jsxs("li",{children:[" ",i," income source",i!==1?"s":""," (totaling $",a.toFixed(2),"/month)"]}),y.jsxs("li",{children:[" ",o," envelope allocation",o!==1?"s":""," (totaling $",c.toFixed(2),")"]}),y.jsxs("li",{children:[" ",u," transaction",u!==1?"s":""," (totaling $",d.toFixed(2),")"]})]})})]})]})}),y.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:y.jsxs("div",{className:"flex",children:[y.jsx("div",{className:"flex-shrink-0",children:y.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:y.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),y.jsx("div",{className:"ml-3",children:y.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[y.jsx("strong",{children:"All other months will remain completely unchanged."})," This only affects the current month's budget data, income sources, allocations, and all transactions."]})})]})}),y.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"You can undo this action within 30 seconds if you change your mind."})]}):y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"text-center",children:[y.jsxs("p",{className:"text-sm text-gray-900 dark:text-white mb-4",children:["Type ",y.jsx("strong",{children:"START FRESH"})," to confirm:"]}),y.jsx("input",{type:"text",value:p,onChange:C=>m(C.target.value),placeholder:"START FRESH",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent dark:bg-zinc-800 dark:text-white text-center font-mono text-lg",autoFocus:!0})]}),y.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500 text-center",children:"This action cannot be undone after 30 seconds"})]})}),y.jsxs("div",{className:"flex gap-3 p-6 border-t border-gray-200 dark:border-zinc-800",children:[y.jsx("button",{type:"button",onClick:T,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",disabled:h,children:"Cancel"}),y.jsx("button",{type:"button",onClick:S,disabled:h||b==="type"&&p!=="START FRESH",className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:h?"Clearing...":b==="confirm"?"Continue":"Start Fresh"})]})]})]})})},gte=({currentMonth:n,onCopy:e,isLoading:t=!1})=>{const r=c=>{const[u,d]=c.split("-");return new Date(parseInt(u),parseInt(d)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},i=c=>{const[u,d]=c.split("-").map(Number);let h=u,p=d-1;return p<1&&(h=u-1,p=12),r(`${h}-${p.toString().padStart(2,"0")}`)},a=r(n),o=i(n);return y.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6 py-12 space-y-6 animate-in fade-in zoom-in-95 duration-300",children:[y.jsxs("div",{className:"relative",children:[y.jsx("div",{className:"absolute inset-0 bg-blue-100 dark:bg-blue-900/30 blur-2xl rounded-full opacity-50"}),y.jsxs("div",{className:"relative bg-white dark:bg-zinc-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-700",children:[y.jsx(Wz,{className:"w-12 h-12 text-blue-500"}),y.jsx("div",{className:"absolute -top-2 -right-2 bg-blue-500 text-white p-1.5 rounded-full border-2 border-white dark:border-zinc-900",children:y.jsx(cN,{size:14})})]})]}),y.jsxs("div",{className:"max-w-xs mx-auto space-y-2",children:[y.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["It looks like you need a budget for ",a]}),y.jsxs("p",{className:"text-gray-500 dark:text-zinc-400",children:["We can copy your budget from ",o," to get you started right away."]})]}),y.jsx("div",{className:"w-full max-w-xs space-y-3 pt-2",children:y.jsx("button",{onClick:e,disabled:t,className:"w-full py-3.5 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-sm transition-all active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:t?"Creating...":y.jsx(y.Fragment,{children:y.jsxs("span",{children:["Create ",a," Budget"]})})})})]})},mte=({piggybank:n,balance:e,onNavigate:t,setMoveableRef:r,isReorderingActive:i,activelyDraggingId:a,onItemDragStart:o,onMoveUp:c,onMoveDown:u,isFirst:d,isLast:h,isReorderUnlocked:p})=>{const m=gr(te=>te.updatePiggybankContribution),b=zc(te=>te.showToast),_=n.piggybankConfig?.targetAmount,w=n.piggybankConfig?.monthlyContribution??0,S=n.piggybankConfig?.color||"#3B82F6",T=n.piggybankConfig?.paused||!1,C=typeof e=="number"?e:e.toNumber(),R=(te,se=1)=>{const me=te.replace("#",""),Te=parseInt(me,16),Ce=Te>>16&255,Ne=Te>>8&255,xe=Te&255;return`rgba(${Ce}, ${Ne}, ${xe}, ${se})`},j=`linear-gradient(135deg, ${R(S,.14)} 0%, ${R(S,.05)} 100%)`,z=R(S,.4),[V,I]=F.useState(!1),[A,k]=F.useState(w?w.toFixed(2):"0.00"),[O,L]=F.useState(!1),B=F.useRef(null),M=F.useRef(null),[Q,X]=F.useState(!1),$=_&&_>0?Math.min(C/_*100,100):0,H=_&&C>=_;F.useEffect(()=>{a&&a!==n.id&&X(!1)},[a,n.id]),F.useEffect(()=>{a===n.id&&(X(!0),o&&o(n.id))},[a,n.id,o]),F.useEffect(()=>{if(!a&&Q){const te=setTimeout(()=>{X(!1)},300);return()=>clearTimeout(te)}},[a,Q]),F.useEffect(()=>{V||k(w?w.toFixed(2):"0.00")},[w,V]),F.useEffect(()=>{V&&B.current&&(B.current.focus(),B.current.select())},[V]);const Z=te=>{te.stopPropagation(),("touches"in te||te.type.startsWith("touch"))&&te.preventDefault(),!O&&(k(w?w.toFixed(2):"0.00"),I(!0))},re=()=>{I(!1),k(w?w.toFixed(2):"0.00")},de=async()=>{if(!V||O)return;const te=parseFloat(A);if(Number.isNaN(te)||te<0){b("Enter a valid contribution amount","error");return}if(te===w){I(!1);return}L(!0);try{await m(n.id,te),b("Monthly contribution updated","success"),k(te.toFixed(2)),I(!1)}catch(se){console.error("Failed to update piggybank contribution",se),b("Failed to update contribution","error")}finally{L(!1)}},U=te=>{te.key==="Enter"?(te.preventDefault(),de()):te.key==="Escape"&&(te.preventDefault(),re())},Y=te=>{if(Q||i){te.preventDefault(),te.stopPropagation();return}if(V){te.preventDefault(),te.stopPropagation();return}t(n.id)},ne=a===n.id,ie=y.jsxs("div",{className:"flex items-center gap-2 w-full",children:[p&&c&&u&&y.jsxs("div",{className:"flex flex-col gap-1 mr-1",children:[y.jsx("button",{onClick:te=>{te.stopPropagation(),c()},disabled:d,className:`p-1 rounded transition-colors ${d?"text-gray-300 dark:text-zinc-700 cursor-not-allowed":"text-gray-500 dark:text-zinc-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20"}`,title:"Move up","aria-label":"Move piggybank up",children:y.jsx(oN,{size:18})}),y.jsx("button",{onClick:te=>{te.stopPropagation(),u()},disabled:h,className:`p-1 rounded transition-colors ${h?"text-gray-300 dark:text-zinc-700 cursor-not-allowed":"text-gray-500 dark:text-zinc-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20"}`,title:"Move down","aria-label":"Move piggybank down",children:y.jsx(rw,{size:18})})]}),y.jsxs("div",{className:"flex-1",children:[y.jsxs("div",{className:"flex items-start justify-between mb-3",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{backgroundColor:`${S}20`},children:y.jsx(zh,{size:20,style:{color:S}})}),y.jsxs("div",{children:[y.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:n.name}),H&&y.jsx("span",{className:"text-xs text-green-600 dark:text-green-400 font-medium",children:" Goal Reached!"})]})]}),y.jsxs("div",{className:"text-right",children:[y.jsxs("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:["$",C.toFixed(2)]}),_&&y.jsxs("div",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["of $",_.toFixed(2)]})]})]}),_&&_>0&&y.jsxs("div",{className:"mb-3",children:[y.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-800 rounded-full h-2 overflow-hidden",children:y.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${$}%`,backgroundColor:S}})}),y.jsxs("div",{className:"flex justify-between items-center mt-1",children:[y.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:[$.toFixed(0),"% complete"]}),y.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["$",(_-C).toFixed(2)," to go"]}),y.jsx("span",{className:"ml-2 px-2 py-0.5 text-[11px] font-semibold rounded-full uppercase tracking-wide",style:{backgroundColor:R(S,.15),color:S},children:"Piggybank"})]})]}),y.jsx("div",{className:"mt-2",children:T?y.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-zinc-400",children:[y.jsx(GL,{size:14,className:"text-orange-500"}),y.jsx("span",{className:"text-orange-600 dark:text-orange-400",children:"Paused"})]}):y.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-zinc-400",children:[y.jsx(dN,{size:14,style:{color:S}}),V?y.jsxs("form",{onSubmit:te=>{te.preventDefault(),de()},className:"flex items-center gap-2",onClick:te=>te.stopPropagation(),children:[y.jsxs("div",{className:"relative",children:[y.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),y.jsx("input",{ref:B,type:"number",min:"0",step:"0.01",value:A,onChange:te=>k(te.target.value),onBlur:de,onKeyDown:U,disabled:O,autoFocus:!0,className:"w-28 pl-6 pr-3 py-1.5 rounded-lg border border-gray-300 dark:border-zinc-600 bg-white dark:bg-zinc-900 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),O&&y.jsx(ML,{size:16,className:"animate-spin text-gray-400"})]}):y.jsxs("div",{onClick:Z,onTouchEnd:Z,className:"font-medium text-gray-900 dark:text-white hover:underline cursor-pointer",children:["$",w.toFixed(2),"/month"]})]})})]})]});return y.jsx(mr.div,{layout:!ne,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},ref:te=>{r&&r(te),M.current=te},onClick:Y,style:{background:j,borderColor:z},className:"rounded-xl p-4 border transition-all cursor-pointer shadow-sm hover:shadow-md select-none active:scale-[0.99]",children:ie})},rh=(n,e=1)=>{const t=n.replace("#",""),r=parseInt(t,16),i=r>>16&255,a=r>>8&255,o=r&255;return`rgba(${i}, ${a}, ${o}, ${e})`},Bk=12,Uk=(n,e,t)=>Math.min(Math.max(n,e),t),vte=({env:n,budgetedAmount:e,remainingBalance:t,editingEnvelopeId:r,setEditingEnvelopeId:i,editingAmount:a,setEditingAmount:o,handleBudgetSave:c,navigate:u,inputRef:d,transactions:h,currentMonth:p,setMoveableRef:m,isReorderingActive:b,activelyDraggingId:_,onItemDragStart:w,onMoveUp:S,onMoveDown:T,isFirst:C,isLast:R,isReorderUnlocked:j})=>{const z=!!n.isPiggybank,V=n.piggybankConfig?.color||"#3B82F6",I=z?`linear-gradient(135deg, ${rh(V,.18)} 0%, ${rh(V,.08)} 100%)`:void 0,A=z?rh(V,.5):void 0,k=F.useRef(null),[O,L]=F.useState(!1),B=h.filter(U=>U.envelopeId===n.id&&U.month===p),M=B.filter(U=>U.type==="Expense"),Q=B.filter(U=>U.type==="Income"),X=M.reduce((U,Y)=>U+(Y.amount||0),0),$=Q.reduce((U,Y)=>U+(Y.amount||0),0),H=Math.max(0,X/$*100),Z=U=>{if(O||b){U.preventDefault(),U.stopPropagation();return}if(r===n.id){U.preventDefault(),U.stopPropagation();return}u(`/envelope/${n.id}`)};F.useEffect(()=>{_&&_!==n.id&&L(!1)},[_,n.id]),F.useEffect(()=>{_===n.id&&(L(!0),w(n.id))},[_,n.id,w]),F.useEffect(()=>{if(!_&&O){const U=setTimeout(()=>{L(!1)},300);return()=>clearTimeout(U)}},[_,O]);const re=y.jsxs("div",{className:"flex items-center gap-2 w-full",children:[j&&y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsx("button",{onClick:U=>{U.stopPropagation(),S()},disabled:C,className:`p-1 rounded transition-colors ${C?"text-gray-300 dark:text-zinc-700 cursor-not-allowed":"text-gray-500 dark:text-zinc-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20"}`,title:"Move up","aria-label":"Move envelope up",children:y.jsx(oN,{size:18})}),y.jsx("button",{onClick:U=>{U.stopPropagation(),T()},disabled:R,className:`p-1 rounded transition-colors ${R?"text-gray-300 dark:text-zinc-700 cursor-not-allowed":"text-gray-500 dark:text-zinc-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20"}`,title:"Move down","aria-label":"Move envelope down",children:y.jsx(rw,{size:18})})]}),y.jsxs("div",{className:"flex-1",children:[y.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[z&&y.jsx("span",{className:"w-8 h-8 rounded-full flex items-center justify-center border",style:{borderColor:rh(V,.4),backgroundColor:rh(V,.15),color:V},children:y.jsx(zh,{size:16})}),y.jsxs("div",{children:[y.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:n.name}),z&&y.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:V},children:"Piggybank"})]})]}),y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("div",{className:"flex items-center gap-x-4",onPointerDown:U=>U.stopPropagation(),children:r===n.id?y.jsxs("div",{className:"flex items-center gap-x-1",children:[y.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Budgeted:"}),y.jsx("form",{onSubmit:U=>{U.preventDefault(),c()},children:y.jsx("input",{ref:d,type:"number",value:a,onChange:U=>o(U.target.value),onBlur:c,className:"w-24 px-2 py-1 text-sm border rounded bg-white dark:bg-zinc-900 text-gray-900 dark:text-white",step:"0.01",autoFocus:!0})})]}):y.jsxs("div",{onClick:U=>{U.preventDefault(),U.stopPropagation(),i(n.id),o(e.toString())},onTouchEnd:U=>{U.preventDefault(),U.stopPropagation(),i(n.id),o(e.toString())},className:"flex items-center gap-x-1 hover:bg-gray-200 dark:hover:bg-zinc-700 px-3 py-2 rounded transition-colors cursor-pointer js-budget-target",children:[y.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Budgeted:"}),y.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:["$",e.toFixed(2)]})]})}),y.jsxs("div",{className:"text-right",children:[y.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 block",children:"Remaining"}),y.jsxs("span",{className:`font-bold ${(typeof t=="number"?t:t.toNumber())<0||100-H<=5?"text-red-500":H>=80?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-emerald-400"}`,children:["$",(typeof t=="number"?t:t.toNumber()).toFixed(2)]})]})]}),e>0&&y.jsx("div",{className:"mt-3",onClick:U=>U.stopPropagation(),children:y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-zinc-400 mb-1",children:[y.jsx("span",{children:"Budget Used"}),y.jsxs("span",{children:[H.toFixed(0),"%"]})]}),y.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-700 rounded-full h-2 overflow-hidden",children:y.jsx("div",{className:`h-full transition-all duration-300 ease-out ${(typeof t=="number"?t:t.toNumber())<0||100-H<=5?"bg-red-500":H>=80?"bg-yellow-500":"bg-green-400"}`,style:{width:`${Math.max(100-H,2)}%`}})})]})})]})]}),de=_===n.id;return y.jsx(mr.div,{layout:!de,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},ref:U=>{m(n.id)(U),k.current=U},onClick:Z,style:{boxShadow:"0 1px 2px rgba(15,23,42,0.08)",background:I,borderColor:A,cursor:"pointer"},className:`p-4 rounded-xl active:scale-[0.99] transition-all select-none border ${z?"bg-white/70 dark:bg-zinc-800/80":"bg-gray-50 dark:bg-zinc-800 border-transparent"}`,children:re})},yte=()=>{const{visibleEnvelopes:n,piggybanks:e,incomeSources:t,availableToBudget:r,currentMonth:i,allocations:a,transactions:o,isLoading:c,isInitialLoading:u,isOnline:d,showTimeoutMessage:h,getEnvelopeBalance:p,reorderEnvelopes:m,deleteIncomeSource:b,clearMonthData:_,copyFromPreviousMonth:w,setEnvelopeAllocation:S,localOrderRef:T,setLocalEnvelopes:C,localPiggybankOrderRef:R,setLocalPiggybanks:j}=ute(),{setMonth:z}=gr(),V=as(),[I,A]=F.useState(!1),[k,O]=F.useState("add"),[L,B]=F.useState(null),[M,Q]=F.useState(!1),[X,$]=F.useState(!1),[H,Z]=F.useState(!1),re=F.useRef(null),[de,U]=F.useState(null),[Y,ne]=F.useState(""),ie=F.useRef(null),[te,se]=F.useState(()=>localStorage.getItem("envelopeReorderUnlocked")==="true");F.useEffect(()=>{localStorage.setItem("envelopeReorderUnlocked",te.toString())},[te]),F.useEffect(()=>{if(!u&&!c){const ke=setTimeout(()=>{const Me=(t[i]||[]).length===0&&(a[i]||[]).length===0;console.log(" Copy prompt check:",{currentMonth:i,hasIncome:(t[i]||[]).length>0,hasAllocations:(a[i]||[]).length>0,showPrompt:Me}),Z(Me)},500);return()=>clearTimeout(ke)}},[u,c,t,a,i]),F.useEffect(()=>{de&&ie.current&&(ie.current.focus(),ie.current.select())},[de]);const me=F.useCallback(ke=>Me=>{Me?Ce.current[ke]=Me:delete Ce.current[ke]},[]),Te=F.useCallback(ke=>Me=>{Me?Oe.current[ke]=Me:delete Oe.current[ke]},[]),Ce=F.useRef({}),Ne=F.useRef({}),[xe,Ee]=F.useState(null),Qe=F.useRef({activeId:null,startIndex:0,currentIndex:0,itemHeight:0}),Oe=F.useRef({}),Be=F.useRef({}),ze=F.useRef(null),[st,yt]=F.useState(null),Ve=F.useRef({activeId:null,startIndex:0,currentIndex:0,itemHeight:0}),[Ke,Mt]=F.useState(!1),vn=F.useRef(null),dn=F.useRef(0),bt=F.useCallback(()=>Mt(!0),[]),Lt=F.useCallback(()=>{Mt(!1),T.current.length&&m(T.current)},[m]),Cr=F.useCallback(ke=>{},[]),Qn=F.useCallback(ke=>{de!==ke&&V(`/envelope/${ke}`)},[de,V]),Yr=F.useCallback(()=>Mt(!0),[]),ls=F.useCallback(()=>{Mt(!1),R.current.length&&m(R.current)},[m]);F.useEffect(()=>{const ke=()=>{Object.values(Be.current).forEach(Xe=>Xe?.destroy()),Be.current={}};if(!e.length)return;const Me=()=>{te&&e.forEach(Xe=>{const Ze=Oe.current[Xe.id];if(!Ze)return;const Tn=Be.current[Xe.id];if(Tn){Tn.target=Ze;return}const Jt=new Ok(ze.current,{target:Ze,draggable:te,throttleDrag:0,edgeDraggable:!1,startDragRotate:0,throttleDragRotate:0,rotatable:!1,scalable:!1,resizable:!1,warpable:!1,pinchable:!1,snappable:!0,snapThreshold:5,isDisplaySnapDigit:!1,isDisplayInnerSnapDigit:!1,snapGap:!0,snapDirections:{top:!0,bottom:!0,left:!1,right:!1},elementSnapDirections:{top:!0,bottom:!0,left:!1,right:!1},clickable:!0,preventClickDefault:!1,preventClickEventOnDrag:!0,checkInput:!1,dragArea:!0,hideDefaultLines:!0,hideChildMoveableDefaultLines:!0,renderDirections:[]});Jt.on("dragStart",An=>{const Rt=R.current.findIndex(xt=>xt.id===Xe.id),St=An.target,fn=St.getBoundingClientRect().height+Bk;yt(Xe.id),Ve.current={activeId:Xe.id,startIndex:Rt,currentIndex:Rt,itemHeight:fn},St&&(St.style.transition="none",St.style.boxShadow="0 18px 45px rgba(15,23,42,0.35)",St.style.zIndex="20"),Yr()});let nt=null;Jt.on("drag",An=>{const Rt=An.target;nt!==null&&cancelAnimationFrame(nt),nt=requestAnimationFrame(()=>{const St=Ve.current;if(St.activeId!==Xe.id)return;const Cn=An.beforeTranslate[1];Rt.style.transform=`translateY(${Cn}px)`,Rt.style.transition="none";const{itemHeight:fn,startIndex:xt}=St;if(!fn)return;const In=Math.round(Cn/fn),Zn=Uk(xt+In,0,R.current.length-1);Zn!==St.currentIndex&&(St.currentIndex=Zn,R.current.forEach((li,Jn)=>{if(li.id===Xe.id)return;const Si=Oe.current[li.id];if(!Si)return;let Rn=0;xt<Zn?Jn>xt&&Jn<=Zn&&(Rn=-fn):xt>Zn&&Jn>=Zn&&Jn<xt&&(Rn=fn),Si.style.transform=Rn?`translateY(${Rn}px)`:"",Si.style.transition="transform 0.2s ease"})),nt=null})}),Jt.on("dragEnd",An=>{nt!==null&&(cancelAnimationFrame(nt),nt=null);const Rt=An.target,St=Ve.current,{startIndex:Cn,currentIndex:fn}=St;if(Rt.style.transform="",Rt.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease",Rt.style.boxShadow="",R.current.forEach(xt=>{if(xt.id===Xe.id)return;const In=Oe.current[xt.id];In&&(In.style.transform="",In.style.transition="")}),Cn!==fn){const xt=[...R.current],[In]=xt.splice(Cn,1);xt.splice(fn,0,In),R.current=xt,j(xt)}setTimeout(()=>{Rt.style.zIndex="",Rt.style.transition="",yt(null)},300),Ve.current={activeId:null,startIndex:0,currentIndex:0,itemHeight:0},ls()}),Jt.on("click",An=>{const Rt=An.inputEvent.target;Rt.closest(".js-budget-target")||Rt.tagName==="INPUT"||Rt.tagName==="BUTTON"||Qn(Xe.id)}),Be.current[Xe.id]=Jt})},dt=window.setTimeout(Me,80);return()=>{clearTimeout(dt),ke()}},[e,Yr,ls,Qn,te]),F.useEffect(()=>{const ke=()=>{Object.values(Ne.current).forEach(Xe=>Xe?.destroy()),Ne.current={}};if(!n.length)return;const Me=()=>{te&&n.forEach(Xe=>{const Ze=Ce.current[Xe.id];if(!Ze)return;const Tn=Ne.current[Xe.id];if(Tn){Tn.target=Ze;return}const Jt=new Ok(vn.current,{target:Ze,draggable:te,throttleDrag:0,edgeDraggable:!1,startDragRotate:0,throttleDragRotate:0,rotatable:!1,scalable:!1,resizable:!1,warpable:!1,pinchable:!1,snappable:!0,snapThreshold:5,isDisplaySnapDigit:!1,isDisplayInnerSnapDigit:!1,snapGap:!0,snapDirections:{top:!0,bottom:!0,left:!1,right:!1},elementSnapDirections:{top:!0,bottom:!0,left:!1,right:!1},clickable:!0,preventClickDefault:!1,preventClickEventOnDrag:!0,checkInput:!1,dragArea:!0,hideDefaultLines:!0,hideChildMoveableDefaultLines:!0,renderDirections:[]});Jt.on("dragStart",An=>{const Rt=T.current.findIndex(xt=>xt.id===Xe.id),St=An.target,fn=St.getBoundingClientRect().height+Bk;Ee(Xe.id),Qe.current={activeId:Xe.id,startIndex:Rt,currentIndex:Rt,itemHeight:fn},St&&(St.style.transition="none",St.style.boxShadow="0 18px 45px rgba(15,23,42,0.35)",St.style.zIndex="20"),bt()});let nt=null;Jt.on("drag",An=>{const Rt=An.target;nt!==null&&cancelAnimationFrame(nt),nt=requestAnimationFrame(()=>{const St=Qe.current;if(St.activeId!==Xe.id)return;const Cn=An.beforeTranslate[1];Rt.style.transform=`translateY(${Cn}px)`,Rt.style.transition="none";const{itemHeight:fn,startIndex:xt}=St;if(!fn)return;const In=Math.round(Cn/fn),Zn=Uk(xt+In,0,T.current.length-1);Zn!==St.currentIndex&&(St.currentIndex=Zn,T.current.forEach((li,Jn)=>{if(li.id===Xe.id)return;const Si=Ce.current[li.id];if(!Si)return;let Rn=0;xt<Zn?Jn>xt&&Jn<=Zn&&(Rn=-fn):xt>Zn&&Jn>=Zn&&Jn<xt&&(Rn=fn),Si.style.transform=Rn?`translateY(${Rn}px)`:"",Si.style.transition="transform 0.2s ease"})),nt=null})}),Jt.on("dragEnd",An=>{nt!==null&&(cancelAnimationFrame(nt),nt=null);const Rt=An.target,St=Qe.current,{startIndex:Cn,currentIndex:fn}=St;if(Rt.style.transform="",Rt.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease",Rt.style.boxShadow="",T.current.forEach(xt=>{if(xt.id===Xe.id)return;const In=Ce.current[xt.id];In&&(In.style.transform="",In.style.transition="")}),Cn!==fn){const xt=[...T.current],[In]=xt.splice(Cn,1);xt.splice(fn,0,In),T.current=xt,C(xt)}setTimeout(()=>{Rt.style.zIndex="",Rt.style.transition="",Ee(null)},300),Qe.current={activeId:null,startIndex:0,currentIndex:0,itemHeight:0},dn.current=Date.now(),Lt()}),Jt.on("click",An=>{const Rt=An.inputEvent.target;Rt.closest(".js-budget-target")||Rt.tagName==="INPUT"||Qn(Xe.id)}),Ne.current[Xe.id]=Jt})},dt=window.setTimeout(Me,80);return()=>{clearTimeout(dt),ke()}},[n,bt,Lt,Qn,te]);const Zs=async()=>{if(de)try{const ke=parseFloat(Y)||0;await S(de,ke)}catch(ke){console.error("Failed to save budget amount:",ke)}finally{U(null),ne("")}},Zi=()=>{O("add"),B(null),A(!0)},_a=ke=>{re.current&&clearTimeout(re.current),!M&&(O("edit"),B(ke),A(!0))},jr=ke=>{re.current&&clearTimeout(re.current),Q(!0),b(ke),setTimeout(()=>Q(!1),500)},yn=()=>{A(!1),B(null)},cr=()=>{$(!0)},en=async()=>{$(!1),await _()},Js=async()=>{Z(!1),await w(i)};return u?y.jsx(N4,{message:h?"Still loading... This is normal on slow connections":"Loading your budget...",showTimeout:h}):y.jsxs(y.Fragment,{children:[y.jsx("style",{dangerouslySetInnerHTML:{__html:`
        .moveable-control { display: none !important; }
        .moveable-origin { display: none !important; }
        .moveable-line { display: none !important; }
      `}}),y.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-20",children:[y.jsxs("header",{className:"fixed top-0 left-0 right-0 z-50 bg-white dark:bg-zinc-900 border-b border-gray-100 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+4px)] pb-1",children:[y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("div",{className:"flex items-center gap-2",children:d?c?y.jsxs("div",{className:"flex items-center gap-1 text-blue-500",children:[y.jsx(sd,{size:16,className:"animate-spin"}),y.jsx("span",{className:"text-sm font-medium",children:"Syncing..."})]}):y.jsxs("div",{className:"flex items-center gap-1 text-green-500",children:[y.jsx(d9,{size:16}),y.jsx("span",{className:"text-sm font-medium",children:"Online"})]}):y.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[y.jsx(c9,{size:16}),y.jsx("span",{className:"text-sm font-medium",children:c?"Saving...":"Offline"})]})}),y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("button",{onClick:()=>se(!te),className:`transition-colors ${te?"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300":"text-gray-500 hover:text-gray-600 dark:text-zinc-400 dark:hover:text-zinc-300"}`,title:te?"Lock envelope order":"Unlock to reorder envelopes",children:te?y.jsx(VL,{size:22}):y.jsx(zL,{size:22})}),y.jsx("button",{onClick:cr,className:"text-orange-500 hover:text-orange-600 dark:hover:text-orange-400 transition-colors",title:"Start Fresh - Clear current month budget",children:y.jsx(sd,{size:22})}),y.jsx(fte,{})]})]}),y.jsx(dte,{currentMonth:i,onMonthChange:ke=>{Z(!1),z(ke)},budgetStatus:{amount:r,totalIncome:(t[i]||[]).reduce((ke,Me)=>ke+Me.amount,0),totalAllocated:(a[i]||[]).filter(ke=>n.some(Me=>Me.id===ke.envelopeId)||e.some(Me=>Me.id===ke.envelopeId)).reduce((ke,Me)=>ke+Me.budgetedAmount,0)}})]}),y.jsxs("div",{className:"pt-[calc(7rem+env(safe-area-inset-top))] p-4 max-w-md mx-auto space-y-6",children:[H?y.jsx(gte,{currentMonth:i,onCopy:Js}):y.jsxs(y.Fragment,{children:[y.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[y.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Income Sources"}),y.jsx("button",{onClick:Zi,className:"text-blue-600 dark:text-blue-300 hover:text-blue-700 dark:hover:text-blue-200 transition-colors",children:y.jsx(Zm,{size:20})})]}),(t[i]||[]).length===0?y.jsx("div",{className:"text-center py-6",children:y.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-sm",children:"No income sources yet. Add your monthly income."})}):y.jsx("div",{className:"space-y-3",children:y.jsx(xi,{initial:!1,mode:"popLayout",children:(t[i]||[]).map(ke=>y.jsx(mr.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:y.jsx(Jp,{onDelete:()=>jr(ke),children:y.jsxs("div",{className:"flex justify-between items-center py-3 px-4 bg-gray-50 dark:bg-zinc-800 rounded-xl cursor-pointer",onClick:()=>_a(ke),children:[y.jsxs("div",{className:"flex-1",children:[y.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:ke.name}),y.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Monthly income"})]}),y.jsxs("p",{className:"font-semibold text-green-600 dark:text-emerald-400",children:["$",ke.amount.toFixed(2)]})]})})},ke.id))})})]}),y.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[y.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Spending Envelopes"}),y.jsx("button",{onClick:()=>V("/add-envelope"),className:"text-blue-600 dark:text-blue-300 hover:text-blue-700 dark:hover:text-blue-200 transition-colors",title:"Create New Envelope",children:y.jsx(Zm,{size:20})})]}),n.length===0?y.jsxs("div",{className:"text-center py-6",children:[y.jsx(iw,{className:"w-12 h-12 text-gray-300 dark:text-zinc-700 mx-auto mb-3"}),y.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-sm mb-4",children:n.length===0?"No envelopes added to this month. Copy from previous month or add new ones.":"No envelopes yet. Create one to get started."}),y.jsx("button",{onClick:()=>V("/add-envelope"),className:"text-blue-600 dark:text-blue-300 font-medium hover:text-blue-700 dark:hover:text-blue-200 transition-colors",children:"Create First Envelope"})]}):y.jsx("div",{ref:vn,children:y.jsx(xi,{initial:!1,children:y.jsx("div",{className:"space-y-3",children:n.map((ke,Me)=>{const Xe=(a[i]||[]).find(nt=>nt.envelopeId===ke.id)?.budgetedAmount||0,Ze=p(ke.id),Tn=()=>{if(Me===0)return;const nt=[...T.current];[nt[Me-1],nt[Me]]=[nt[Me],nt[Me-1]],T.current=nt,C(nt),m(nt)},Jt=()=>{if(Me===n.length-1)return;const nt=[...T.current];[nt[Me],nt[Me+1]]=[nt[Me+1],nt[Me]],T.current=nt,C(nt),m(nt)};return y.jsx(vte,{env:ke,budgetedAmount:Xe,remainingBalance:Ze,editingEnvelopeId:de,setEditingEnvelopeId:U,editingAmount:Y,setEditingAmount:ne,handleBudgetSave:Zs,navigate:V,inputRef:ie,transactions:o,currentMonth:i,setMoveableRef:me,isReorderingActive:Ke,activelyDraggingId:xe,onItemDragStart:Cr,onMoveUp:Tn,onMoveDown:Jt,isFirst:Me===0,isLast:Me===n.length-1,isReorderUnlocked:te},ke.id)})})})})]}),y.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[y.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[y.jsx(zh,{size:20,className:"text-blue-600 dark:text-blue-400"}),"Piggybanks"]}),y.jsx("button",{onClick:()=>V("/add-envelope?type=piggybank"),className:"text-blue-600 dark:text-blue-300 hover:text-blue-700 dark:hover:text-blue-200 transition-colors",title:"Create New Piggybank",children:y.jsx(Zm,{size:20})})]}),e.length>0?y.jsx("div",{ref:ze,className:"relative",children:y.jsx(xi,{initial:!1,children:y.jsx("div",{className:"space-y-3",children:e.map((ke,Me)=>{const dt=()=>{if(Me===0)return;const Ze=[...R.current];[Ze[Me-1],Ze[Me]]=[Ze[Me],Ze[Me-1]],R.current=Ze,j(Ze),m(Ze)},Xe=()=>{if(Me===e.length-1)return;const Ze=[...R.current];[Ze[Me],Ze[Me+1]]=[Ze[Me+1],Ze[Me]],R.current=Ze,j(Ze),m(Ze)};return y.jsx(mte,{piggybank:ke,balance:p(ke.id),onNavigate:Ze=>V(`/envelope/${Ze}`),setMoveableRef:Te(ke.id),isReorderingActive:Ke,activelyDraggingId:st,onItemDragStart:()=>{},onMoveUp:dt,onMoveDown:Xe,isFirst:Me===0,isLast:Me===e.length-1,isReorderUnlocked:te},ke.id)})})})}):y.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-zinc-400",children:[y.jsx(zh,{size:48,className:"mx-auto mb-3 opacity-30"}),y.jsx("p",{className:"text-sm",children:"No piggybanks yet"}),y.jsx("p",{className:"text-xs mt-1",children:"Click the + button above to create your first piggybank"})]})]})]}),y.jsx(hte,{isVisible:I,onClose:yn,mode:k,initialIncomeSource:L}),y.jsx(pte,{isVisible:X,onClose:()=>$(!1),onConfirm:en,currentMonth:i,incomeCount:(t[i]||[]).length,totalIncome:(t[i]||[]).reduce((ke,Me)=>ke+Me.amount,0),allocationCount:(a[i]||[]).filter(ke=>n.some(Me=>Me.id===ke.envelopeId)||e.some(Me=>Me.id===ke.envelopeId)).length,totalAllocated:(a[i]||[]).filter(ke=>n.some(Me=>Me.id===ke.envelopeId)||e.some(Me=>Me.id===ke.envelopeId)).reduce((ke,Me)=>ke+Me.budgetedAmount,0),transactionCount:o.filter(ke=>ke.month===i).length,totalTransactionAmount:o.filter(ke=>ke.month===i).reduce((ke,Me)=>ke+Me.amount,0)})]})]})]})},bte=[{id:"1",name:"Amazon Prime",network:"Visa",last4:"7474",color:"#232f3e"},{id:"2",name:"Apple Card",network:"Mastercard",last4:"0274",color:"#e3e3e3"},{id:"3",name:"AA Credit Union",network:"Visa",last4:"3386",color:"#5494DA"}],_5=({selectedCard:n,onCardSelect:e,initialCards:t=bte,disabled:r=!1,isUserSelected:i=!1})=>{const[a,o]=F.useState(t[0]),[c,u]=F.useState(!1),[d,h]=F.useState(!1),[p,m]=F.useState(t),[b,_]=F.useState(null),[w,S]=F.useState({name:"",network:"Visa",last4:"",color:"#3b82f6"}),T=n||a;F.useEffect(()=>{!n&&e&&p.length>0&&e(p[0])},[n,e,p]);const C=k=>{r||(k.id==="add-new"?h(!0):(o(k),e?.(k),u(!1)))},R=()=>{r||u(!c)},j=k=>{r||_(k)},z=()=>{if(b&&!r){const k=p.filter(O=>O.id!==b.id);if(m(k),T.id===b.id&&k.length>0){const O=k[0];o(O),e?.(O)}_(null)}},V=()=>{_(null)},I=()=>{if(r)return;if(w.last4.length!==4||!/^\d{4}$/.test(w.last4)){alert("Please enter exactly 4 digits for the last 4 digits");return}if(!w.name.trim()){alert("Please enter a card name");return}const k={id:`custom-${Date.now()}`,name:w.name.trim(),network:w.network,last4:w.last4,color:w.color},O=[...p,k];m(O),o(k),e?.(k),h(!1),u(!1),S({name:"",network:"Visa",last4:"",color:"#3b82f6"})},A=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#6b7280","#0f4c81","#fdbb30","#7fb5b5","#232f3e","#e3e3e3"];return y.jsxs(y.Fragment,{children:[y.jsxs("div",{children:[y.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Payment Method",!i&&y.jsx("span",{className:"ml-2 text-xs text-blue-600 dark:text-blue-400 font-medium",children:"(Default selected)"})]}),y.jsxs("div",{onClick:R,className:`flex items-center gap-4 p-3 border rounded-lg transition-colors ${r?"cursor-not-allowed opacity-50 border-gray-300 dark:border-gray-600":"cursor-pointer hover:bg-gray-50 dark:hover:bg-zinc-800 border-gray-300 dark:border-gray-600"} ${i?"":"ring-2 ring-blue-200 dark:ring-blue-800"}`,children:[y.jsxs("div",{className:"w-[70px] h-[40px] rounded-lg flex flex-col justify-between p-[6px] shadow-lg text-white font-mono text-xs",style:{backgroundColor:T.color},children:[y.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:T.network}),y.jsxs("span",{className:"text-left text-[9px] leading-none",children:[" ",T.last4]})]}),y.jsxs("div",{className:"flex-1",children:[y.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:T.name}),y.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(...",T.last4,")"]})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-gray-400",children:c?"":""}),!i&&y.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",title:"Default payment method - tap to change"})]})]}),c&&y.jsx("div",{className:"card-stack-dropdown",children:y.jsx("div",{className:"card-stack",children:y.jsx(xi,{initial:!1,mode:"popLayout",children:[...p,{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}].map((k,O)=>{const L=T.id===k.id,B=k.id==="add-new";return y.jsx(mr.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:y.jsx(Jp,{onDelete:()=>!B&&!r&&j(k),threshold:-80,children:y.jsxs("div",{className:`card-stack-item ${L?"selected":""} ${B?"add-new-card":""}`,onClick:()=>C(k),style:{backgroundColor:B?"#f3f4f6":k.color,color:B?"#374151":k.color==="#e3e3e3"?"#000":"#fff",zIndex:p.length-O},children:[y.jsxs("div",{className:"card-header",children:[y.jsx("span",{className:"card-network",children:B?"":k.network}),L&&!B&&y.jsx("span",{className:"selected-indicator",children:""})]}),y.jsxs("div",{className:"card-details",children:[y.jsx("div",{className:"card-name",children:k.name}),y.jsx("div",{className:"card-number",children:B?"":` ${k.last4}`})]}),B&&y.jsx("div",{className:"add-icon",children:y.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[y.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),y.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})})},k.id)})})})})]}),d&&y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-md mx-4",children:[y.jsxs("div",{className:"flex justify-between items-center mb-6",children:[y.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Add New Card"}),y.jsx("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:""})]}),y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Card Name"}),y.jsx("input",{type:"text",value:w.name,onChange:k=>S({...w,name:k.target.value}),placeholder:"e.g., My Chase Card",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Network"}),y.jsxs("select",{value:w.network,onChange:k=>S({...w,network:k.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[y.jsx("option",{value:"Visa",children:"Visa"}),y.jsx("option",{value:"Mastercard",children:"Mastercard"}),y.jsx("option",{value:"Amex",children:"Amex"})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Last 4 Digits"}),y.jsx("input",{type:"text",value:w.last4,onChange:k=>S({...w,last4:k.target.value.replace(/\D/g,"").slice(0,4)}),placeholder:"1234",maxLength:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Card Color"}),y.jsx("div",{className:"grid grid-cols-6 gap-2",children:A.map(k=>y.jsx("button",{onClick:()=>S({...w,color:k}),className:`w-full h-10 rounded-lg border-2 transition-all ${w.color===k?"border-blue-500 scale-110":"border-gray-300 dark:border-gray-600"}`,style:{backgroundColor:k}},k))})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Preview"}),y.jsxs("div",{className:"w-full h-20 rounded-lg flex flex-col justify-between p-3 shadow-lg text-white font-mono text-xs",style:{backgroundColor:w.color},children:[y.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:w.network}),y.jsxs("span",{className:"text-left text-[9px] leading-none",children:[" ",w.last4||"0000"]})]})]}),y.jsxs("div",{className:"flex gap-3 pt-4",children:[y.jsx("button",{onClick:()=>h(!1),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),y.jsx("button",{onClick:I,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors",children:"Add Card"})]})]})]})}),b&&y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:y.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-sm mx-4",children:y.jsxs("div",{className:"text-center",children:[y.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center mx-auto mb-4",children:y.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),y.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Delete Card"}),y.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Are you sure you want to delete ",y.jsx("span",{className:"font-medium",children:b.name}),"?"]}),y.jsxs("div",{className:"flex gap-3",children:[y.jsx("button",{onClick:V,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),y.jsx("button",{onClick:z,className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md transition-colors",children:"Delete"})]})]})})})]})},w5=({isVisible:n,onClose:e,mode:t,currentEnvelope:r,initialTransaction:i})=>{const{addTransaction:a,updateTransaction:o,deleteTransaction:c,currentMonth:u}=gr(),[d,h]=F.useState(""),[p,m]=F.useState(""),[b,_]=F.useState(""),[w,S]=F.useState(new Date().toISOString().split("T")[0]),[T,C]=F.useState(null);F.useEffect(()=>{if(n)if(t==="edit"&&i){h(i.amount.toString()),m(i.merchant||""),_(i.description),C(i.paymentMethod||null);try{const I=new Date(i.date);isNaN(I.getTime())?(console.warn("Invalid date in transaction:",i.date),S(new Date().toISOString().split("T")[0])):S(I.toISOString().split("T")[0])}catch(I){console.error("Error parsing transaction date:",I),S(new Date().toISOString().split("T")[0])}}else h(""),m(""),_(""),S(new Date().toISOString().split("T")[0])},[n,t,i]);const R=async I=>{I.preventDefault();const A=parseFloat(d);if(isNaN(A)||A<=0){console.log(" Invalid amount:",d);return}console.log(" Saving transaction:",{mode:t,amount:A,note:b,date:w,envelopeId:r.id,paymentMethod:T});try{const k=new Date(w),O=`${k.getFullYear()}-${(k.getMonth()+1).toString().padStart(2,"0")}`;if(O!==u){const L=`This transaction date (${O}) does not match the current budget month (${u}). Are you sure you want to save it?`;if(!window.confirm(L))return}t==="add"?(console.log(" Adding income transaction"),await a({amount:A,description:b,merchant:p||void 0,date:new Date(w).toISOString(),envelopeId:r.id,type:"Income",reconciled:!1,paymentMethod:T||void 0})):t==="spend"?(console.log(" Adding expense transaction"),await a({amount:A,description:b,merchant:p||void 0,date:new Date(w).toISOString(),envelopeId:r.id,type:"Expense",reconciled:!1,paymentMethod:T||void 0})):t==="edit"&&i&&(console.log(" Updating transaction"),await o({...i,amount:A,description:b,merchant:p||void 0,date:new Date(w).toISOString(),paymentMethod:T||void 0})),console.log(" Transaction saved successfully"),e()}catch(k){console.error(" Error saving transaction:",k),alert("Failed to save transaction: "+(k instanceof Error?k.message:"Unknown error"))}},j=()=>{!i||!i.id||window.confirm("Are you sure you want to delete this transaction?")&&(c(i.id),e())},z=t==="add"?"Add Money":t==="spend"?"Spend Money":"Edit Transaction",V=t==="add"?"text-green-500":"text-red-500";return y.jsx(xi,{children:n&&y.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[y.jsx(mr.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),y.jsxs(mr.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden relative z-10",children:[y.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[y.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),y.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:z}),y.jsx("button",{onClick:R,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!d||parseFloat(d)<=0,children:"Save"})]}),y.jsxs("form",{onSubmit:R,className:"p-6 space-y-6",children:[y.jsxs("div",{className:"text-center",children:[y.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),y.jsxs("div",{className:"relative inline-block",children:[y.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${V}`,children:"$"}),y.jsx("input",{type:"text",inputMode:"numeric",value:d,onChange:I=>{const A=I.target.value.replace(/\D/g,"");if(!A){h("");return}const O=(parseInt(A,10)/100).toFixed(2);h(O)},onKeyDown:I=>{(I.key==="e"||I.key==="E"||I.key==="+"||I.key==="-")&&I.preventDefault()},placeholder:"0.00",autoFocus:!0,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${V} placeholder-gray-700`})]})]}),y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[y.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),y.jsx("input",{type:"text",value:p,onChange:I=>m(I.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),y.jsx(_5,{selectedCard:T,onCardSelect:C}),y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[y.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),y.jsx("input",{type:"text",value:b,onChange:I=>_(I.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[y.jsxs("div",{className:"flex justify-between items-center mb-1",children:[y.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const I=new Date(w);return`${I.getFullYear()}-${(I.getMonth()+1).toString().padStart(2,"0")}`!==u?y.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[y.jsx(Ju,{size:14}),y.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),y.jsx("input",{type:"date",value:w,onChange:I=>{console.log("Date changed to:",I.target.value),S(I.target.value)},required:!0,className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),t==="edit"&&y.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-zinc-800",children:y.jsxs("button",{type:"button",onClick:j,className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-50 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-200 dark:border-zinc-800",children:[y.jsx(uN,{className:"w-5 h-5 mr-2"}),"Delete Transaction"]})})]})]})]})})},xte=({isVisible:n,onClose:e,sourceEnvelope:t})=>{const{envelopes:r,transferFunds:i}=gr(),[a,o]=F.useState(""),[c,u]=F.useState(""),[d,h]=F.useState(""),[p,m]=F.useState(new Date().toISOString().split("T")[0]),b=r.filter(S=>S.id!==t.id);F.useEffect(()=>{if(!n)return;const S=window.setTimeout(()=>{o(""),u(""),h(""),m(new Date().toISOString().split("T")[0])},0);return()=>window.clearTimeout(S)},[n]);const _=S=>{S.preventDefault();const T=parseFloat(c);isNaN(T)||T<=0||!a||(i(t.id,a,T,d,new Date(p)),e())},w=r.find(S=>S.id===a);return y.jsx(xi,{children:n&&y.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[y.jsx(mr.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),y.jsxs(mr.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden relative z-10",children:[y.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[y.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),y.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:"Transfer Money"}),y.jsx("button",{onClick:_,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!c||parseFloat(c)<=0||!a,children:"Transfer"})]}),y.jsxs("form",{onSubmit:_,className:"p-6 space-y-6",children:[y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800",children:[y.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"From"}),y.jsx("div",{className:"text-gray-900 dark:text-white font-medium",children:t.name})]}),y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[y.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"To"}),y.jsxs("select",{value:a,onChange:S=>o(S.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none cursor-pointer",children:[y.jsx("option",{value:"",className:"bg-white dark:bg-zinc-900",children:"Select envelope..."}),b.map(S=>y.jsx("option",{value:S.id,className:"bg-white dark:bg-zinc-900",children:S.name},S.id))]})]}),y.jsxs("div",{className:"text-center",children:[y.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),y.jsxs("div",{className:"relative inline-block",children:[y.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl text-blue-600 dark:text-blue-400",children:"$"}),y.jsx("input",{type:"text",inputMode:"numeric",value:c,onChange:S=>{const T=S.target.value.replace(/\D/g,"");if(!T){u("");return}const R=(parseInt(T,10)/100).toFixed(2);u(R)},onKeyDown:S=>{(S.key==="e"||S.key==="E"||S.key==="+"||S.key==="-")&&S.preventDefault()},placeholder:"0.00",autoFocus:!0,className:"bg-transparent text-4xl font-bold text-center w-40 focus:outline-none text-blue-600 dark:text-blue-400 placeholder-gray-400 dark:placeholder-gray-600"})]})]}),y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[y.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note (Optional)"}),y.jsx("input",{type:"text",value:d,onChange:S=>h(S.target.value),placeholder:"What is this transfer for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[y.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Date"}),y.jsx("input",{type:"date",value:p,onChange:S=>m(S.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),w&&c&&parseFloat(c)>0&&y.jsxs("div",{className:"text-center text-sm text-gray-500 dark:text-zinc-400 pt-2 border-t border-gray-200 dark:border-zinc-800",children:["Moving ",y.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-bold",children:["$",parseFloat(c).toFixed(2)]})," from"," ",y.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:t.name})," to"," ",y.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:w.name})]})]})]})]})})},_te=n=>{if(!n)return"No Date";try{let e;return n&&typeof n=="object"&&n.toDate&&typeof n.toDate=="function"?e=n.toDate():typeof n=="number"?n<1e10?e=new Date((n+978307200)*1e3):e=new Date(n):e=new Date(n),isNaN(e.getTime())?"Invalid Date":new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(e)}catch(e){return console.error("Date error:",e),"Error"}},wte=n=>{const e=typeof n=="string"?parseFloat(n):n;return typeof e!="number"||isNaN(e)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.abs(e))},E5=({transaction:n,envelopeName:e,onReconcile:t,onEdit:r})=>{if(!n)return null;console.log(" Transaction payment method:",n.paymentMethod);const i=n.type==="Income",a=n.type==="Expense";let o="text-gray-900 dark:text-white";return i&&(o="text-green-600 dark:text-green-400"),a&&(o="text-red-600 dark:text-red-400"),y.jsxs("div",{onClick:r,className:"flex items-center justify-between p-4 bg-white dark:bg-zinc-900 active:bg-gray-50 dark:active:bg-zinc-800 active:scale-[0.99] transition-all cursor-pointer group border-b border-gray-100 dark:border-zinc-800 last:border-0",children:[y.jsxs("div",{className:"flex flex-col gap-1 overflow-hidden",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"font-semibold text-gray-900 dark:text-white truncate",children:n.merchant||n.description||"No Description"}),n.reconciled&&y.jsx("span",{className:"text-[10px] bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 px-1.5 py-0.5 rounded-full font-bold uppercase tracking-wide",children:"R"})]}),n.merchant&&n.description&&n.description!==n.merchant&&y.jsx("div",{className:"text-xs text-gray-600 dark:text-zinc-400 truncate",children:n.description}),y.jsxs("div",{className:"text-xs text-gray-500 dark:text-zinc-500 flex items-center gap-1 flex-wrap",children:[y.jsx("span",{children:_te(n.date)}),e&&y.jsxs(y.Fragment,{children:[y.jsx("span",{children:""}),y.jsx("span",{className:"text-blue-500 dark:text-blue-400 truncate max-w-[150px]",children:e})]}),n.paymentMethod&&y.jsxs(y.Fragment,{children:[y.jsx("span",{children:""}),y.jsxs("span",{className:"flex items-center gap-1",children:[y.jsx("span",{className:"w-[12px] h-[8px] rounded-[2px] flex-shrink-0",style:{backgroundColor:n.paymentMethod.color}}),y.jsx("span",{className:"truncate max-w-[80px]",children:n.paymentMethod.name})]})]})]})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsxs("div",{className:`font-bold font-mono whitespace-nowrap ${o}`,children:[a?"-":i?"+":"",wte(n.amount)]}),t?y.jsx("button",{type:"button",onClick:c=>{c.stopPropagation(),t()},className:"p-1.5 rounded-full border border-transparent hover:border-green-200 dark:hover:border-green-500 transition-colors","aria-label":n.reconciled?"Mark as unreconciled":"Mark as reconciled",children:n.reconciled?y.jsx(x2,{className:"text-green-500",size:20}):y.jsx(_2,{className:"text-gray-400",size:20})}):y.jsx("span",{children:n.reconciled?y.jsx(x2,{className:"text-green-500",size:20}):y.jsx(_2,{className:"text-gray-400",size:20})})]})]})},Ete=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n),Ste=()=>{const{id:n}=H6(),{envelopes:e,transactions:t,fetchData:r,isLoading:i,deleteEnvelope:a,removeEnvelopeFromMonth:o,renameEnvelope:c,updateTransaction:u,deleteTransaction:d,restoreTransaction:h,getEnvelopeBalance:p,currentMonth:m}=gr(),{showToast:b}=zc(),_=as(),w=xa(),[S,T]=F.useState(!1),[C,R]=F.useState(!1),[j,z]=F.useState(!1),[V,I]=F.useState(null);F.useEffect(()=>{e.length===0&&r()},[]);const A=e.find(M=>M.id===n);if(!A)return i?y.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:y.jsx("p",{children:"Loading envelope..."})}):y.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:y.jsx("p",{children:"Envelope not found."})});if(A.isPiggybank){const M=t.filter(Q=>Q.envelopeId===A.id);console.log(" Piggybank:",A.name),console.log(" Created at:",A.createdAt),console.log(" Transactions:",M.map(Q=>({date:Q.date,description:Q.description,amount:Q.amount})))}const k=t.filter(M=>M.envelopeId===A.id).filter(M=>{if(A.isPiggybank){if((M.description==="Monthly Allocation"||M.description==="Piggybank Contribution")&&M.isAutomatic||!A.createdAt)return!0;const Q=new Date(A.createdAt);return new Date(M.date)>=Q}return M.month===m||!M.month}).sort((M,Q)=>new Date(Q.date).getTime()-new Date(M.date).getTime()),O=()=>{w.state?.fromGlobalFAB?_("/"):_(-1)},L=()=>{n&&(A.isPiggybank?a(n):o(n,m),_(-1))},B=M=>{const Q={...M,reconciled:!M.reconciled};u(Q)};return y.jsxs("div",{className:"min-h-screen bg-white dark:bg-black text-gray-900 dark:text-white p-4 pb-28",children:[y.jsxs("header",{className:"flex justify-between items-center pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 bg-white dark:bg-black z-10 border-b border-gray-100 dark:border-zinc-800",children:[y.jsx("button",{onClick:()=>{const M=prompt("Rename envelope:",A.name);M&&M.trim()&&n&&c(n,M)},className:"text-blue-600 dark:text-blue-400 font-medium",children:"Rename"}),y.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:A.name}),y.jsx("button",{onClick:O,className:"text-blue-600 dark:text-blue-400 font-bold",children:"Done"})]}),y.jsx("section",{className:"mt-4 bg-white dark:bg-zinc-900 rounded-lg p-4 shadow-lg mb-4 border border-gray-100 dark:border-zinc-800",children:y.jsxs("div",{className:"flex justify-between items-center mb-2",children:[y.jsx("span",{className:"text-lg font-headline text-gray-900 dark:text-white",children:"Current Balance"}),(()=>{const M=A.isPiggybank?p(A.id):p(A.id,m);return console.log(`Debug: Envelope ${A.name} Balance:`,M),y.jsx("span",{className:`text-xl font-bold ${M<0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:Ete(M)})})()]})}),y.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg mb-4 divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:[y.jsxs("button",{className:"flex items-center w-full p-4 text-left text-green-600 dark:text-green-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>T(!0),children:[y.jsx(dL,{className:"w-5 h-5 mr-3"}),"Add Money"]}),y.jsxs("button",{className:"flex items-center w-full p-4 text-left text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>R(!0),children:[y.jsx(cL,{className:"w-5 h-5 mr-3"}),"Spend Money"]}),y.jsxs("button",{className:"flex items-center w-full p-4 text-left text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>z(!0),children:[y.jsx(Kz,{className:"w-5 h-5 mr-3"}),"Transfer Money"]})]}),y.jsxs("section",{className:"mt-6",children:[y.jsx("h2",{className:"text-sm font-semibold uppercase text-gray-500 dark:text-zinc-400 mb-2 px-2",children:"Transaction History"}),y.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:k.length===0?y.jsx("p",{className:"p-4 text-center text-gray-500 dark:text-zinc-400",children:"No transactions yet for this envelope."}):y.jsx(xi,{initial:!1,mode:"popLayout",children:k.map(M=>y.jsx(mr.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:y.jsx(Jp,{onDelete:()=>{if(!M.id)return;const Q={...M};d(M.id),b("Transaction deleted","neutral",()=>h(Q))},children:y.jsx(E5,{transaction:M,onReconcile:()=>B(M),onEdit:()=>I(M)})})},M.id))})})]}),y.jsx("div",{className:"mt-8",children:y.jsxs("button",{className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-100 dark:border-zinc-800",onClick:()=>{const M=A.isPiggybank?`Are you sure you want to delete "${A.name}"? This will delete the piggybank and all its history.`:`Are you sure you want to remove "${A.name}" from ${m}? This will delete all transactions for this month only.`;confirm(M)&&L()},children:[y.jsx(uN,{className:"w-5 h-5 mr-2"}),"Delete Envelope"]})}),y.jsx(w5,{isVisible:S||C||!!V,onClose:()=>{T(!1),R(!1),I(null)},mode:S?"add":C?"spend":"edit",currentEnvelope:A,initialTransaction:V}),y.jsx(xte,{isVisible:j,onClose:()=>z(!1),sourceEnvelope:A})]})},Tte=()=>{const n=as(),e=F.useRef(null),{envelopes:t,transactions:r,resetData:i,importData:a,getEnvelopeBalance:o,appSettings:c,updateAppSettings:u,initializeAppSettings:d,incomeSources:h,allocations:p,currentMonth:m}=gr(),{deleteAccount:b,currentUser:_}=Yi(),[w,S]=F.useState(null),[T,C]=F.useState(()=>localStorage.getItem("lastBackupDate")||"Never"),[R,j]=F.useState(!1),[z,V]=F.useState(""),[I,A]=F.useState(!1),[k,O]=F.useState(!1),[L,B]=F.useState(null),[M,Q]=F.useState(!1),X=978307200,$=c?.theme??"system";F.useEffect(()=>{c||d().catch(se=>{console.error("Failed to initialize app settings:",se)})},[d,c]);const H=(se,me)=>{S({type:se,text:me}),setTimeout(()=>S(null),3500)},Z=F.useMemo(()=>{const se=t.length,me=r.length,Te=m?p[m]||[]:[],Ce=Object.values(h).reduce((Be,ze)=>Be+ze.length,0),Ne=Te.length,xe=t.reduce((Be,ze)=>{const st=o(ze.id);return Be+(typeof st=="number"?st:0)},0),Ee=0,Qe=r.reduce((Be,ze)=>{let st=0;if(typeof ze.date=="string"){const yt=Date.parse(ze.date);st=Number.isNaN(yt)?0:yt}else typeof ze.date=="number"&&(st=ze.date<2e9?(ze.date+X)*1e3:ze.date);return Math.max(Be,st)},0),Oe=Ee||Qe?new Date(Math.max(Ee,Qe)).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"Never";return{envelopeCount:se,transactionCount:me,incomeSourceCount:Ce,allocationCount:Ne,totalBalance:xe,lastUpdated:Oe}},[t,r,h,p,m]),re=()=>{try{console.log(" Creating backup..."),console.log(" Envelopes in store:",t.map(xe=>({id:xe.id,name:xe.name,isPiggybank:xe.isPiggybank,hasPiggybankConfig:!!xe.piggybankConfig,piggybankConfig:xe.piggybankConfig})));const se={appVersion:"2.1 (PWA)",backupDate:Date.now(),appSettings:c||{theme:"system"},envelopes:t.map(xe=>({...xe,currentBalance:(()=>{const Ee=o(xe.id);return typeof Ee=="number"?Ee:0})(),lastUpdated:new Date().toISOString()})),transactions:r,allocations:p,incomeSources:h};console.log(" Backup data created:",{envelopeCount:se.envelopes.length,piggybankEnvelopes:se.envelopes.filter(xe=>xe.isPiggybank).length,sampleEnvelope:se.envelopes.find(xe=>xe.isPiggybank)||se.envelopes[0]});const me=new Blob([JSON.stringify(se,null,2)],{type:"application/json"}),Te=URL.createObjectURL(me),Ce=document.createElement("a");Ce.href=Te,Ce.download=`HouseBudget_Backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(Ce),Ce.click(),document.body.removeChild(Ce),URL.revokeObjectURL(Te);const Ne=new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});localStorage.setItem("lastBackupDate",Ne),C(Ne),B({success:!0,message:"Backup downloaded successfully."})}catch(se){console.error(se),B({success:!1,message:"Failed to create backup file.",onRetry:re})}},de=()=>{O(!0),B(null);try{const se=["Date","Merchant","Notes","Amount","Type","Envelope","Reconciled"],me=r.map(Ee=>{const Qe=t.find(st=>st.id===Ee.envelopeId)?.name||"Unknown",Oe=(Ee.merchant||"").replace(/"/g,'""'),Be=(Ee.description||"").replace(/"/g,'""');let ze="Invalid Date";if(Ee.date){if(typeof Ee.date=="string")ze=Ee.date.split("T")[0];else if(typeof Ee.date=="number"){const st=Ee.date<2e9?(Ee.date+X)*1e3:Ee.date;ze=new Date(st).toISOString().split("T")[0]}}return[ze,`"${Oe}"`,`"${Be}"`,Ee.amount.toFixed(2),Ee.type,`"${Qe}"`,Ee.reconciled?"Yes":"No"].join(",")}),Te=[se.join(","),...me].join(`
`),Ce=new Blob([Te],{type:"text/csv;charset=utf-8;"}),Ne=URL.createObjectURL(Ce),xe=document.createElement("a");xe.href=Ne,xe.download=`HouseBudget_Transactions_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(xe),xe.click(),document.body.removeChild(xe),URL.revokeObjectURL(Ne),B({success:!0,message:"Transactions CSV exported successfully."})}catch(se){console.error(se),B({success:!1,message:"Failed to export CSV. Please try again.",onRetry:de})}finally{O(!1)}},U=()=>{e.current?.click()},Y=se=>{const me=se.target.files?.[0];if(!me)return;const Te=new FileReader;Te.onload=async Ce=>{try{const Ne=JSON.parse(Ce.target?.result),xe=await a(Ne);if(!xe.success){H("error",xe.message);return}if(Ne.appSettings?.theme)try{await u({theme:Ne.appSettings.theme})}catch(Ee){console.error("Failed to update imported settings:",Ee)}else if(Ne.appSettings?.isDarkMode!==void 0)try{const Ee=Ne.appSettings.isDarkMode?"dark":"light";await u({theme:Ee})}catch(Ee){console.error("Failed to update imported settings:",Ee)}H("success",`Loaded ${Ne.envelopes?.length??0} envelopes, ${Ne.transactions?.length??0} transactions, ${Ne.allocations?Object.keys(Ne.allocations).reduce((Ee,Qe)=>Ee+(Ne.allocations[Qe]?.length||0),0):0} allocations, and ${Ne.incomeSources?Object.keys(Ne.incomeSources).reduce((Ee,Qe)=>Ee+(Ne.incomeSources[Qe]?.length||0),0):0} income sources.`)}catch(Ne){console.error(Ne),H("error","Invalid backup file. Please verify the JSON.")}},Te.readAsText(me),se.target.value=""},ne=async()=>{if(window.confirm("Are you sure? This will permanently delete all envelopes, transactions, budget allocations, income sources, and settings from the cloud. This action cannot be undone."))try{await i(),H("success","All data has been permanently deleted."),n("/")}catch(se){console.error("Reset failed:",se),H("error","Failed to delete all data. Some data may remain.")}},ie=async()=>{if(!z.trim()){H("error","Please enter your password to confirm account deletion.");return}j(!0);try{await i(),await b(z)?H("success","Your account has been permanently deleted."):H("error","Failed to delete account. Please try again.")}catch(se){console.error("Account deletion failed:",se),H("error","Failed to delete account. Please try again.")}finally{j(!1),A(!1),V("")}},te=async()=>{if(!_){H("error","You must be logged in to clean up data.");return}Q(!0);try{const se=await PS.cleanupOrphanedData(_.id),me=se.orphanedAllocationsDeleted+se.orphanedTransactionsDeleted;me>0?H("success",`Cleaned ${me} orphaned items: ${se.orphanedAllocationsDeleted} allocations and ${se.orphanedTransactionsDeleted} transactions from ${se.details.monthsProcessed.length} months.`):H("success","No orphaned data found. Your database is already clean!")}catch(se){console.error("Cleanup failed:",se),H("error","Failed to clean up orphaned data. Please try again.")}finally{Q(!1)}};return y.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black transition-colors duration-200",children:[y.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-center shadow-sm relative",children:[y.jsx("button",{onClick:()=>n(-1),className:"absolute left-4 text-blue-600 dark:text-blue-400 font-medium",children:"Done"}),y.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Settings"})]}),y.jsxs("div",{className:"p-4 space-y-6 max-w-2xl mx-auto pb-24",children:[w&&y.jsxs("div",{className:`px-4 py-3 rounded-2xl text-sm font-medium flex items-center gap-2 ${w.type==="success"?"bg-green-50 text-green-700 dark:bg-emerald-900/30 dark:text-emerald-200":"bg-red-50 text-red-700 dark:bg-red-900/30 dark:text-red-200"}`,children:[w.type==="success"?y.jsx(px,{size:18}):y.jsx(mx,{size:18}),w.text]}),y.jsx("section",{children:y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-5 space-y-3",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx(w2,{className:"text-blue-500",size:22}),y.jsxs("div",{children:[y.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Backup & Restore"}),y.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Create backups of all your data including envelopes, transactions, budget allocations, income sources, and settings."})]})]}),y.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 pt-2",children:[y.jsxs("div",{className:"text-center",children:[y.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Envelopes"}),y.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:Z.envelopeCount})]}),y.jsxs("div",{className:"text-center",children:[y.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Transactions"}),y.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:Z.transactionCount})]}),y.jsxs("div",{className:"text-center",children:[y.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Income Sources"}),y.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:Z.incomeSourceCount})]}),y.jsxs("div",{className:"text-center",children:[y.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Allocations"}),y.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:Z.allocationCount})]})]})]})}),y.jsxs("section",{children:[y.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Appearance"}),y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4",children:[y.jsxs("div",{className:"flex items-center justify-between mb-3",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[$==="light"&&y.jsx("span",{className:"text-orange-500 text-lg",children:""}),$==="dark"&&y.jsx("span",{className:"text-purple-500 text-lg",children:""}),$==="system"&&y.jsx("span",{className:"text-gray-500 text-lg",children:""}),y.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Theme"})]}),y.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 capitalize",children:$})]}),y.jsx("div",{className:"text-xs text-gray-500 dark:text-zinc-500 mb-3",children:"Choose your preferred appearance."}),y.jsx("div",{className:"flex gap-2",children:[{label:"Light",value:"light"},{label:"Dark",value:"dark"},{label:"System",value:"system"}].map(se=>y.jsx("button",{onClick:async()=>{try{await u({theme:se.value})}catch(me){console.error("Failed to update theme setting:",me)}},className:`flex-1 py-2 rounded-lg text-sm font-medium border transition-colors ${$===se.value?"bg-blue-50 dark:bg-blue-900/30 border-blue-500 text-blue-700 dark:text-blue-200":"border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 hover:border-gray-300 dark:hover:border-zinc-600"}`,children:se.label},se.value))})]})]}),y.jsxs("section",{children:[y.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Actions"}),y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:[y.jsxs("button",{onClick:re,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx(w2,{className:"text-blue-500",size:20}),y.jsxs("div",{className:"flex flex-col items-start",children:[y.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Create Backup"}),y.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["Last backup: ",T]})]})]}),y.jsx($l,{className:"text-gray-400",size:18})]}),y.jsxs("button",{onClick:U,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx(i9,{className:"text-blue-500",size:20}),y.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Restore from Backup"})]}),y.jsx($l,{className:"text-gray-400",size:18})]}),y.jsx("div",{className:"p-4",children:y.jsxs("button",{onClick:de,disabled:k,className:"w-full flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors disabled:opacity-60 disabled:cursor-not-allowed rounded-xl border border-gray-100 dark:border-zinc-800 px-4 py-3 bg-white dark:bg-zinc-900",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[k?y.jsx(E2,{className:"text-blue-500 animate-spin",size:20}):y.jsx(EL,{className:"text-blue-500",size:20}),y.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:k?"Preparing CSV":"Export Transactions (CSV)"})]}),y.jsx($l,{className:"text-gray-400",size:18})]})}),y.jsx("input",{type:"file",ref:e,onChange:Y,accept:".json",className:"hidden"})]})]}),y.jsxs("section",{children:[y.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Tips"}),y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4 text-sm text-gray-600 dark:text-zinc-300 space-y-2",children:[y.jsx("p",{children:"Create regular backups before major changes."}),y.jsx("p",{children:"Store backups in iCloud, Files, or another safe location."}),y.jsx("p",{children:"Backups are plain JSON files and can be inspected in any text editor."}),y.jsx("p",{children:"Restoring replaces all current envelopes, transactions, budget allocations, income sources, and settings."})]})]}),y.jsxs("section",{children:[y.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Danger Zone"}),y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm",children:[y.jsxs("button",{onClick:ne,className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx(mx,{className:"text-red-500",size:20}),y.jsxs("div",{className:"flex flex-col items-start",children:[y.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Reset All Data"}),y.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Permanently delete all envelopes, transactions, allocations, income sources, and settings"})]})]}),y.jsx($l,{className:"text-gray-400",size:18})]}),y.jsxs("button",{onClick:te,disabled:M,className:"w-full p-4 flex items-center justify-between hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800 disabled:opacity-60 disabled:cursor-not-allowed",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[M?y.jsx(E2,{className:"text-orange-500 animate-spin",size:20}):y.jsx(cN,{className:"text-orange-500",size:20}),y.jsxs("div",{className:"flex flex-col items-start",children:[y.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:M?"Cleaning Data...":" Purge Orphaned Data"}),y.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Remove allocations and transactions pointing to deleted envelopes"})]})]}),y.jsx($l,{className:"text-gray-400",size:18})]}),y.jsxs("button",{onClick:()=>A(!0),className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx(Ju,{className:"text-red-500",size:20}),y.jsxs("div",{className:"flex flex-col items-start",children:[y.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Delete Account"}),y.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Permanently delete your account and all data"})]})]}),y.jsx($l,{className:"text-gray-400",size:18})]})]})]}),y.jsxs("div",{className:"text-center py-4",children:[y.jsxs("p",{className:"text-xs text-gray-400 dark:text-zinc-500",children:["Version ","1.4.0"," (PWA)"]}),"        "]}),L&&y.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 max-w-sm w-full",children:[y.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[L.success?y.jsx(px,{className:"text-green-500",size:24}):y.jsx(Ju,{className:"text-red-500",size:24}),y.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:L.success?"Success":"Error"})]}),y.jsx("p",{className:"text-gray-600 dark:text-zinc-300 mb-4",children:L.message}),y.jsxs("div",{className:"flex gap-2",children:[L.onRetry&&y.jsx("button",{onClick:()=>{B(null),L.onRetry?.()},className:"flex-1 py-2 px-4 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors",children:"Retry"}),y.jsx("button",{onClick:()=>B(null),className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-zinc-700 text-gray-900 dark:text-white rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-zinc-600 transition-colors",children:"Close"})]})]})}),I&&y.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 max-w-sm w-full",children:[y.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[y.jsx(Ju,{className:"text-red-500",size:24}),y.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Account"})]}),y.jsx("p",{className:"text-gray-600 dark:text-zinc-300 mb-4",children:"This action cannot be undone. This will permanently delete your account and remove all data from our servers."}),y.jsx("input",{type:"password",value:z,onChange:se=>V(se.target.value),placeholder:"Enter your password",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 mb-4"}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("button",{onClick:()=>{A(!1),V("")},className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-zinc-700 text-gray-900 dark:text-white rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-zinc-600 transition-colors",children:"Cancel"}),y.jsx("button",{onClick:ie,disabled:R||!z.trim(),className:"flex-1 py-2 px-4 bg-red-500 text-white rounded-lg font-medium hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:R?"Deleting...":"Delete Account"})]})]})})]})]})},Ate=()=>{const{addEnvelope:n,setEnvelopeAllocation:e,currentMonth:t}=gr(),{showToast:r}=zc(),i=as(),[a]=Oz(),[o,c]=F.useState(""),u=a.get("type")==="piggybank",[d,h]=F.useState(""),[p,m]=F.useState(""),[b,_]=F.useState("#3B82F6"),[w,S]=F.useState(!1),T=async C=>{if(C.preventDefault(),!o.trim()||w)return;S(!0);const R=gr.getState().envelopes,z=(R.length>0?Math.max(...R.map(k=>k.orderIndex??0)):-1)+1,V=u?new Date(`${t}-01T00:00:00`):new Date,I={name:o,currentBalance:0,lastUpdated:new Date().toISOString(),createdAt:V.toISOString(),isActive:!0,orderIndex:z};u&&(I.isPiggybank=!0,I.piggybankConfig={targetAmount:d?parseFloat(d):void 0,monthlyContribution:parseFloat(p||"0"),color:b,icon:"piggy-bank"}),n(I).then(k=>{if(k){const O=u?parseFloat(p||"0"):0;e(k,O).catch(L=>console.error("Failed to create allocation:",L)),setTimeout(()=>{i("/")},50)}}).catch(k=>{console.error("Failed to create envelope:",k),r(k.message||"Failed to create envelope","error"),S(!1)})};return y.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-28",children:[y.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-10 flex items-center shadow-sm",children:[y.jsx("button",{onClick:()=>i("/"),className:"mr-3 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white",children:y.jsx(jh,{size:24})}),y.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:u?"New Piggybank":"New Envelope"})]}),y.jsx("div",{className:"p-4 max-w-md mx-auto",children:y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:[y.jsx("div",{className:"p-6 bg-blue-50 dark:bg-zinc-800 border-b border-blue-100 dark:border-zinc-700 flex justify-center py-8",children:y.jsx("div",{className:"w-20 h-20 bg-blue-100 dark:bg-zinc-700 text-blue-600 dark:text-blue-400 rounded-full flex items-center justify-center",children:u?y.jsx(zh,{size:40}):y.jsx(TL,{size:40})})}),y.jsxs("form",{onSubmit:T,className:"p-6 space-y-6 pb-6",children:[y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:u?"Piggybank Name":"Envelope Name"}),y.jsx("input",{type:"text",id:"name",value:o,onChange:C=>c(C.target.value),placeholder:u?"e.g. Vacation Fund, Emergency Savings":"e.g. Groceries, Rent, Fun Money",className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",autoFocus:!0,required:!0})]}),u&&y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{htmlFor:"monthly-contribution",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Monthly Auto-Contribution *"}),y.jsxs("div",{className:"relative",children:[y.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),y.jsx("input",{type:"number",id:"monthly-contribution",value:p,onChange:C=>m(C.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:u})]}),y.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"This amount will be automatically added each month and deducted from Available to Budget"})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Target Goal (Optional)"}),y.jsxs("div",{className:"relative",children:[y.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),y.jsx("input",{type:"number",id:"target-amount",value:d,onChange:C=>h(C.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),y.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Set a savings goal to track progress"})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Color"}),y.jsx("div",{className:"grid grid-cols-6 gap-2",children:[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#F59E0B",label:"Amber"},{value:"#EF4444",label:"Red"},{value:"#8B5CF6",label:"Purple"},{value:"#EC4899",label:"Pink"}].map(C=>y.jsx("button",{type:"button",onClick:()=>_(C.value),className:`w-full aspect-square rounded-lg transition-all ${b===C.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-zinc-900":"hover:scale-110"}`,style:{backgroundColor:C.value},title:C.label},C.value))})]})]}),y.jsxs("div",{className:"pt-4 flex gap-3",children:[y.jsx("button",{type:"button",onClick:()=>i("/"),className:"flex-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 font-semibold bg-white dark:bg-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",children:"Cancel"}),y.jsx("button",{type:"submit",disabled:!o.trim()||u&&!p||w,className:`flex-1 py-3 px-4 rounded-xl font-semibold shadow-sm text-white transition-colors ${o.trim()&&(!u||p)&&!w?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-300 dark:bg-zinc-600 cursor-not-allowed"}`,children:w?"Creating...":u?"Create Piggybank":"Create Envelope"})]})]})]})})]})},Cte=({envelopes:n,transactionAmount:e,onSplitChange:t})=>{const[r,i]=F.useState([]),[a,o]=F.useState({}),[c,u]=F.useState(e),d=_=>{i(w=>w.includes(_)?w.filter(S=>S!==_):[...w,_])},h=(_,w)=>{o(S=>({...S,[_]:w}))};F.useEffect(()=>{if(r.length===1){const _=r[0];o({[_]:e})}},[r.length,e]),F.useEffect(()=>{const _=Object.values(a).reduce((w,S)=>w+(S||0),0);u(e-_),t(a)},[a,e,t]),F.useEffect(()=>{const _={...a};Object.keys(_).forEach(w=>{r.includes(w)||delete _[w]}),Object.keys(_).length!==Object.keys(a).length&&o(_)},[r,a]);const p=()=>{i([]),o({})},m=Math.abs(c)<.01&&r.length>0,b=r.length>0&&Math.abs(c)>.01;return y.jsxs("div",{className:"space-y-3",children:[r.length>1&&y.jsxs("div",{className:`p-3 rounded-lg ${b?"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800":m?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-zinc-800 border border-gray-200 dark:border-zinc-700"}`,children:[y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Remaining to Split:"}),y.jsxs("span",{className:`font-bold text-lg ${b?"text-red-600 dark:text-red-400":m?"text-green-600 dark:text-green-400":"text-gray-900 dark:text-white"}`,children:["$",c.toFixed(2)]})]}),b&&y.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Split amounts must equal transaction total"})]}),y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("label",{className:"text-xs text-gray-500 dark:text-zinc-400",children:r.length>1?"Split Across Envelopes":"Select Envelope"}),r.length>0&&y.jsx("button",{type:"button",onClick:p,className:"text-xs text-blue-600 dark:text-blue-400",children:"Clear All"})]}),y.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-200 dark:border-zinc-800 rounded-lg",children:n.map(_=>y.jsxs("div",{className:"flex items-center py-3 px-3 border-b border-gray-100 dark:border-zinc-800 last:border-b-0 hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[y.jsx("input",{type:"checkbox",checked:r.includes(_.id),onChange:()=>d(_.id),className:"mr-3 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),y.jsx("span",{className:"flex-1 text-gray-900 dark:text-white",children:_.name}),r.includes(_.id)&&r.length>1&&y.jsxs("div",{className:"flex items-center",children:[y.jsx("span",{className:"mr-1 text-gray-500 dark:text-zinc-400",children:"$"}),y.jsx("input",{type:"number",min:"0",step:"0.01",value:a[_.id]||"",onChange:w=>h(_.id,parseFloat(w.target.value)||0),className:"w-24 px-2 py-1 border border-gray-300 dark:border-zinc-700 rounded bg-white dark:bg-zinc-900 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]})]},_.id))})]})},S5=({onClose:n,onSaved:e})=>{const t=as(),{envelopes:r,addTransaction:i,currentMonth:a}=gr(),[o,c]=F.useState(""),[u,d]=F.useState(""),[h,p]=F.useState(""),[m,b]=F.useState(new Date().toISOString().split("T")[0]),[_,w]=F.useState("expense"),[S,T]=F.useState({}),[C,R]=F.useState(null),[j,z]=F.useState(!1),V=()=>{if(n){n();return}t(-1)},I=X=>{R(X),C&&z(!0)},A=Object.keys(S).length>0,k=Object.values(S).reduce((X,$)=>X+($||0),0),O=Math.abs(k-parseFloat(o||"0"))<.01,L=o&&parseFloat(o)>0&&A&&O,B=async X=>{if(X.preventDefault(),!L)return;const[$,H,Z]=m.split("-").map(Number),re=new Date($,H-1,Z,12,0,0);console.log(" Selected date:",m),console.log(" Parsed date:",re.toISOString());try{const[de,U]=m.split("-").map(Number),Y=`${de}-${U.toString().padStart(2,"0")}`;if(Y!==a){const ie=`This transaction date (${Y}) does not match the current budget month (${a}). Are you sure you want to save it?`;if(!window.confirm(ie))return}const ne=Object.entries(S).filter(([ie,te])=>te>0);Promise.all(ne.map(([ie,te])=>i({amount:te,description:h,merchant:u||void 0,date:re.toISOString(),envelopeId:ie,type:_==="income"?"Income":"Expense",reconciled:!1,paymentMethod:C||void 0}).catch(se=>console.error("Failed to create transaction:",se)))).catch(ie=>console.error("Failed to create transactions:",ie)),e&&e(),n?n():t("/")}catch(de){console.error("Error saving transaction:",de),alert("Failed to save transaction: "+(de instanceof Error?de.message:"Unknown error"))}},M=[...r].sort((X,$)=>{const H=X.orderIndex??0,Z=$.orderIndex??0;return H!==Z?H-Z:X.name.localeCompare($.name)}),Q=_==="income"?"text-green-500":"text-red-500";return y.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black",children:[y.jsxs("header",{className:"bg-white dark:bg-black border-b border-gray-200 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 z-10 flex items-center justify-between",children:[y.jsx("button",{onClick:V,className:"text-blue-600 dark:text-blue-400 font-medium",children:"Cancel"}),y.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"New Transaction"}),y.jsx("button",{onClick:B,disabled:!L,className:"text-blue-600 dark:text-blue-400 font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:"Save"})]}),y.jsx("div",{className:"p-4 max-w-md mx-auto pb-24",children:y.jsxs("form",{onSubmit:B,className:"space-y-6",children:[y.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl border border-gray-200 dark:border-zinc-800 overflow-hidden",children:y.jsxs("div",{className:"flex",children:[y.jsx("button",{type:"button",onClick:()=>w("expense"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${_==="expense"?"bg-red-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Expense"}),y.jsx("button",{type:"button",onClick:()=>w("income"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${_==="income"?"bg-green-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Income"})]})}),y.jsxs("div",{className:"text-center",children:[y.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),y.jsxs("div",{className:"relative inline-block",children:[y.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${Q}`,children:"$"}),y.jsx("input",{type:"text",inputMode:"numeric",value:o,onChange:X=>{const $=X.target.value.replace(/\D/g,"");if(!$){c("");return}const Z=(parseInt($,10)/100).toFixed(2);c(Z)},onKeyDown:X=>{(X.key==="e"||X.key==="E"||X.key==="+"||X.key==="-")&&X.preventDefault()},placeholder:"0.00",autoFocus:!0,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${Q} placeholder-gray-700`})]})]}),y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[y.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),y.jsx("input",{type:"text",value:u,onChange:X=>d(X.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),y.jsx(_5,{selectedCard:C,onCardSelect:I,isUserSelected:j}),y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[y.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),y.jsx("input",{type:"text",value:h,onChange:X=>p(X.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[y.jsxs("div",{className:"flex justify-between items-center mb-1",children:[y.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const[X,$]=m.split("-").map(Number);return`${X}-${$.toString().padStart(2,"0")}`!==a?y.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[y.jsx(Ju,{size:14}),y.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),y.jsx("input",{type:"date",value:m,onChange:X=>b(X.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),y.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 transition-colors",children:y.jsx(Cte,{envelopes:M,transactionAmount:parseFloat(o)||0,onSplitChange:T})})]})})]})},Ite=()=>{const n=as(),{transactions:e,envelopes:t,updateTransaction:r,deleteTransaction:i,restoreTransaction:a,currentMonth:o}=gr(),{showToast:c}=zc(),[u,d]=F.useState(!1),[h,p]=F.useState(""),[m,b]=F.useState("all"),[_,w]=F.useState("All"),[S,T]=F.useState(!1),[C,R]=F.useState("all"),[j,z]=F.useState(!1),[V,I]=F.useState("all"),[A,k]=F.useState(()=>{const H=new Date;return H.setMonth(H.getMonth()-1),H.toISOString().split("T")[0]}),[O,L]=F.useState(()=>new Date().toISOString().split("T")[0]),[B,M]=F.useState(null),Q=F.useMemo(()=>{console.log(" Filtering transactions:",{totalTransactions:e.length,showAllTime:j,currentMonth:o,transactionMonths:e.map(re=>({id:re.id,month:re.month,date:re.date,description:re.description}))});let H=e;return j||(H=e.filter(re=>re.month===o||!re.month),console.log(" After month filter:",{remaining:H.length,currentMonth:o,filteredTransactions:H.map(re=>({id:re.id,description:re.description,month:re.month,matchesCurrentMonth:re.month===o}))})),H.map(re=>{if(!re)return null;let de=re.date;if(typeof re.date=="number"){const Y=(re.date+978307200)*1e3;de=new Date(Y).toISOString()}else if(!re.date||typeof re.date!="string")return null;return{...re,date:de}}).filter(Boolean).filter(re=>{if(h){const U=h.toLowerCase(),Y=t.find(te=>te.id===re.envelopeId)?.name.toLowerCase()||"",ne=re.amount.toFixed(2);if(!(re.description.toLowerCase().includes(U)||Y.includes(U)||ne.includes(U)))return!1}if(m!=="all"&&re.envelopeId!==m||_!=="All"&&re.type!==_||V!=="all"&&(!re.paymentMethod||re.paymentMethod.id!==V)||!re.date||typeof re.date!="string")return!1;const de=re.date.split("T")[0];return!(C!=="all"&&new Date(de).getMonth()!==parseInt(C)||S&&!re.reconciled)}).sort((re,de)=>new Date(de.date).getTime()-new Date(re.date).getTime())},[e,t,h,m,_,V,A,O,S,j,o]);console.log(" Final filtered transactions:",{count:Q.length,transactions:Q.map(H=>({id:H.id,description:H.description,amount:H.amount,date:H.date,month:H.month,type:H.type}))});const X=B?t.find(H=>H.id===B.envelopeId):null,$=H=>{const Z={...H,reconciled:!H.reconciled};r(Z)};return y.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-20 transition-colors duration-200",children:[y.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-between shadow-sm",children:[y.jsxs("div",{className:"flex items-center",children:[y.jsx("button",{onClick:()=>n(-1),className:"mr-3 text-gray-600 hover:text-gray-900 dark:text-zinc-400 dark:hover:text-white transition-colors",children:y.jsx(jh,{size:24})}),y.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"All Transactions"})]}),y.jsx("button",{onClick:()=>d(!u),className:`p-2 rounded-full transition-colors ${u?"bg-blue-100 text-blue-600 dark:bg-blue-900/40 dark:text-blue-400":"text-gray-400 dark:text-zinc-600 hover:bg-gray-100 dark:hover:bg-zinc-800"}`,children:y.jsx(CL,{size:20,className:u?"fill-current":""})})]}),y.jsxs("div",{className:"px-4 py-2 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 flex justify-between items-center",children:[y.jsxs("div",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:["Month: ",o]}),y.jsx("button",{onClick:()=>z(!j),className:`text-sm px-3 py-1 rounded-md ${j?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-800 dark:bg-zinc-800 dark:text-zinc-300"}`,children:j?"Current Month Only":"All Time"})]}),y.jsx("div",{className:"px-4 py-3 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800",children:y.jsxs("div",{className:"space-y-1",children:[y.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Payment Method"}),y.jsxs("select",{value:V,onChange:H=>I(H.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[y.jsx("option",{value:"all",children:"All Payment Methods"}),[{id:"1",name:"Amazon Prime",network:"Visa",last4:"7474",color:"#232f3e"},{id:"2",name:"Apple Card",network:"Mastercard",last4:"0274",color:"#e3e3e3"},{id:"3",name:"AA Credit Union",network:"Visa",last4:"3386",color:"#5494DA"}].map(H=>y.jsx("option",{value:H.id,children:H.name},H.id))]})]})}),y.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 ${u?"max-h-[500px] opacity-100":"max-h-0 opacity-0"}`,children:y.jsxs("div",{className:"p-4 space-y-4",children:[y.jsxs("div",{className:"relative",children:[y.jsx(KL,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),y.jsx("input",{type:"text",placeholder:"Search transactions...",value:h,onChange:H=>p(H.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none dark:text-white"}),h&&y.jsx("button",{onClick:()=>p(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",children:y.jsx(aw,{size:16})})]}),y.jsxs("div",{className:"space-y-1",children:[y.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Envelope"}),y.jsxs("select",{value:m,onChange:H=>b(H.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[y.jsx("option",{value:"all",children:"All Envelopes"}),t.sort((H,Z)=>H.name.localeCompare(Z.name)).map(H=>y.jsx("option",{value:H.id,children:H.name},H.id))]})]}),y.jsx("div",{className:"bg-gray-100 dark:bg-zinc-800 p-1 rounded-lg flex",children:["All","Income","Expense"].map(H=>y.jsx("button",{onClick:()=>w(H),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${_===H?"bg-white dark:bg-zinc-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-zinc-500 hover:text-gray-700"}`,children:H},H))}),y.jsxs("div",{className:"space-y-1",children:[y.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Month"}),y.jsxs("select",{value:C,onChange:H=>R(H.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[y.jsx("option",{value:"all",children:"All Months"}),Array.from({length:12},(H,Z)=>Z).map(H=>y.jsx("option",{value:H,children:new Date(2022,H).toLocaleString("default",{month:"long"})},H))]})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[y.jsxs("div",{className:"space-y-1",children:[y.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"From"}),y.jsx("div",{className:"relative",children:y.jsx("input",{type:"date",value:A,onChange:H=>k(H.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]}),y.jsxs("div",{className:"space-y-1",children:[y.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"To"}),y.jsx("div",{className:"relative",children:y.jsx("input",{type:"date",value:O,onChange:H=>L(H.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]})]}),y.jsxs("div",{className:"flex items-center justify-between pt-2",children:[y.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show only reconciled"}),y.jsx("button",{onClick:()=>T(!S),className:`w-11 h-6 rounded-full transition-colors relative ${S?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:y.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${S?"translate-x-5":"translate-x-0"}`})})]}),y.jsxs("div",{className:"flex items-center justify-between pt-2",children:[y.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show all time"}),y.jsx("button",{onClick:()=>z(!j),className:`w-11 h-6 rounded-full transition-colors relative ${j?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:y.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${j?"translate-x-5":"translate-x-0"}`})})]})]})}),y.jsx("div",{className:"p-4 max-w-2xl mx-auto",children:y.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:Q.length===0?y.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-zinc-500",children:"No transactions match your filters."}):y.jsx(xi,{initial:!1,mode:"popLayout",children:Q.map(H=>{const Z=t.find(re=>re.id===H.envelopeId);return y.jsx(mr.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:y.jsx(Jp,{onDelete:()=>{if(!H.id)return;const re={...H};i(H.id),c("Transaction deleted","neutral",()=>a(re))},children:y.jsx(E5,{transaction:H,envelopeName:Z?.name||"Unknown Envelope",onReconcile:()=>$(H),onEdit:()=>{Z?M(H):alert("Cannot edit: Envelope deleted.")}})})},H.id)})})})}),y.jsx(w5,{isVisible:!!B&&!!X,onClose:()=>M(null),mode:"edit",currentEnvelope:X||{},initialTransaction:B})]})},Fk=[{id:"1",name:"Amazon Prime",network:"Visa",last4:"7474",color:"#232f3e"},{id:"2",name:"Apple Card",network:"Mastercard",last4:"0274",color:"#e3e3e3"},{id:"3",name:"AA Credit Union",network:"Visa",last4:"3386",color:"#5494DA"}],Rte=()=>{const[n,e]=F.useState(Fk[0]),[t,r]=F.useState(!1),[i,a]=F.useState(!1),[o,c]=F.useState(Fk),[u,d]=F.useState(null),[h,p]=F.useState({name:"",network:"Visa",last4:"",color:"#3b82f6"}),m=R=>{R.id==="add-new"?a(!0):(e(R),r(!1))},b=()=>{r(!t)},_=R=>{d(R)},w=()=>{if(u){const R=o.filter(j=>j.id!==u.id);c(R),n.id===u.id&&R.length>0&&e(R[0]),d(null)}},S=()=>{d(null)},T=()=>{if(h.last4.length!==4||!/^\d{4}$/.test(h.last4)){alert("Please enter exactly 4 digits for the last 4 digits");return}if(!h.name.trim()){alert("Please enter a card name");return}const R={id:`custom-${Date.now()}`,name:h.name.trim(),network:h.network,last4:h.last4,color:h.color};c([...o,R]),e(R),a(!1),r(!1),p({name:"",network:"Visa",last4:"",color:"#3b82f6"})},C=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#6b7280","#0f4c81","#fdbb30","#7fb5b5","#232f3e","#e3e3e3"];return y.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black p-8",children:[y.jsxs("div",{className:"max-w-md mx-auto",children:[y.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:"Apple Wallet-Style Card Stack"}),y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-6 space-y-6",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Payment Method"}),y.jsxs("div",{onClick:b,className:"flex items-center gap-4 p-3 border border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:[y.jsxs("div",{className:"w-[70px] h-[40px] rounded-lg flex flex-col justify-between p-[6px] shadow-lg text-white font-mono text-xs",style:{backgroundColor:n.color},children:[y.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:n.network}),y.jsxs("span",{className:"text-left text-[9px] leading-none",children:[" ",n.last4]})]}),y.jsxs("div",{className:"flex-1",children:[y.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:n.name}),y.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(...",n.last4,")"]})]}),y.jsx("div",{className:"text-gray-400",children:t?"":""})]})]}),t&&y.jsx("div",{className:"card-stack-dropdown",children:y.jsx("div",{className:"card-stack",children:y.jsx(xi,{initial:!1,mode:"popLayout",children:[...o,{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}].map((R,j)=>{const z=n.id===R.id,V=R.id==="add-new";return y.jsx(mr.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:y.jsx(Jp,{onDelete:()=>!V&&_(R),threshold:-80,children:y.jsxs("div",{className:`card-stack-item ${z?"selected":""} ${V?"add-new-card":""}`,onClick:()=>m(R),style:{backgroundColor:V?"#f3f4f6":R.color,color:V?"#374151":R.color==="#e3e3e3"?"#000":"#fff",zIndex:o.length-j},children:[y.jsxs("div",{className:"card-header",children:[y.jsx("span",{className:"card-network",children:V?"":R.network}),z&&!V&&y.jsx("span",{className:"selected-indicator",children:""})]}),y.jsxs("div",{className:"card-details",children:[y.jsx("div",{className:"card-name",children:R.name}),y.jsx("div",{className:"card-number",children:V?"":` ${R.last4}`})]}),V&&y.jsx("div",{className:"add-icon",children:y.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[y.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),y.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})})},R.id)})})})})]})]}),i&&y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:y.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-md mx-4",children:[y.jsxs("div",{className:"flex justify-between items-center mb-6",children:[y.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Add New Card"}),y.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:""})]}),y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Card Name"}),y.jsx("input",{type:"text",value:h.name,onChange:R=>p({...h,name:R.target.value}),placeholder:"e.g., My Chase Card",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Network"}),y.jsxs("select",{value:h.network,onChange:R=>p({...h,network:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[y.jsx("option",{value:"Visa",children:"Visa"}),y.jsx("option",{value:"Mastercard",children:"Mastercard"}),y.jsx("option",{value:"Amex",children:"Amex"})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Last 4 Digits"}),y.jsx("input",{type:"text",value:h.last4,onChange:R=>p({...h,last4:R.target.value.replace(/\D/g,"").slice(0,4)}),placeholder:"1234",maxLength:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Card Color"}),y.jsx("div",{className:"grid grid-cols-6 gap-2",children:C.map(R=>y.jsx("button",{onClick:()=>p({...h,color:R}),className:`w-full h-10 rounded-lg border-2 transition-all ${h.color===R?"border-blue-500 scale-110":"border-gray-300 dark:border-gray-600"}`,style:{backgroundColor:R}},R))})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Preview"}),y.jsxs("div",{className:"w-full h-20 rounded-lg flex flex-col justify-between p-3 shadow-lg text-white font-mono text-xs",style:{backgroundColor:h.color},children:[y.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:h.network}),y.jsxs("span",{className:"text-left text-[9px] leading-none",children:[" ",h.last4||"0000"]})]})]}),y.jsxs("div",{className:"flex gap-3 pt-4",children:[y.jsx("button",{onClick:()=>a(!1),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),y.jsx("button",{onClick:T,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors",children:"Add Card"})]})]})]})}),u&&y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:y.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-sm mx-4",children:y.jsxs("div",{className:"text-center",children:[y.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center mx-auto mb-4",children:y.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),y.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Delete Card"}),y.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Are you sure you want to delete ",y.jsx("span",{className:"font-medium",children:u.name}),"?"]}),y.jsxs("div",{className:"flex gap-3",children:[y.jsx("button",{onClick:S,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),y.jsx("button",{onClick:w,className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md transition-colors",children:"Delete"})]})]})})})]})},zo=({children:n})=>y.jsx(mr.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2,ease:"easeInOut"},className:"w-full h-full bg-gray-50 dark:bg-black",children:n}),Dte=()=>{const n=xa();return y.jsx(xi,{mode:"wait",children:y.jsxs(sz,{location:n,children:[y.jsx(Cs,{path:"/",element:y.jsx(zo,{children:y.jsx(ca,{children:y.jsx(yte,{})})})}),y.jsx(Cs,{path:"/envelope/:id",element:y.jsx(zo,{children:y.jsx(ca,{children:y.jsx(Ste,{})})})}),y.jsx(Cs,{path:"/add-envelope",element:y.jsx(zo,{children:y.jsx(ca,{children:y.jsx(Ate,{})})})}),y.jsx(Cs,{path:"/add-transaction",element:y.jsx(zo,{children:y.jsx(ca,{children:y.jsx(S5,{})})})}),y.jsx(Cs,{path:"/transactions",element:y.jsx(zo,{children:y.jsx(ca,{children:y.jsx(Ite,{})})})}),y.jsx(Cs,{path:"/settings",element:y.jsx(zo,{children:y.jsx(ca,{children:y.jsx(Tte,{})})})}),y.jsx(Cs,{path:"/verify-email",element:y.jsx(zo,{children:y.jsx(ca,{children:y.jsx(k4,{})})})}),y.jsx(Cs,{path:"/card-stack",element:y.jsx(zo,{children:y.jsx(ca,{children:y.jsx(Rte,{})})})})]},n.pathname)})};function kte(){const[n,e]=F.useState(!0),[t,r]=F.useState(!1),{appSettings:i}=gr(),{isAuthenticated:a,isInitialized:o,initializeAuth:c,lastAuthTime:u,offlineGracePeriod:d,currentUser:h}=Yi();if(F.useEffect(()=>{const b=setTimeout(()=>{e(!1)},2e3);return()=>clearTimeout(b)},[]),F.useEffect(()=>c(),[c]),F.useEffect(()=>{const b=document.documentElement,_=window.matchMedia("(prefers-color-scheme: dark)"),w=()=>{const S=i?.theme??"system",T=_.matches;S==="dark"||S==="system"&&T?b.classList.add("dark"):b.classList.remove("dark")};if(w(),i?.theme==="system")return _.addEventListener("change",w),()=>_.removeEventListener("change",w)},[i]),n||!o)return y.jsx(N4,{message:"Initializing Personal Budget..."});if(!a)return h?y.jsx(ca,{children:y.jsx(k4,{})}):y.jsx(ca,{children:y.jsx(aH,{})});const m=typeof navigator<"u"&&!navigator.onLine&&a&&u&&Date.now()-u<d;return y.jsxs(ca,{children:[m&&y.jsx("div",{className:"bg-yellow-100 dark:bg-yellow-900 border-l-4 border-yellow-500 text-yellow-700 dark:text-yellow-200 p-4",children:y.jsxs("div",{className:"flex",children:[y.jsx("div",{className:"flex-shrink-0",children:y.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:y.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),y.jsx("div",{className:"ml-3",children:y.jsxs("p",{className:"text-sm",children:[y.jsx("strong",{children:"Offline Access:"})," You're using cached authentication. Expires in"," ",Math.ceil((d-(Date.now()-u))/(1440*60*1e3))," ","days. Connect to internet to refresh."]})})]})}),y.jsxs(Dz,{children:[y.jsx(Dte,{}),t&&y.jsxs("div",{className:"fixed inset-0 z-[60]",children:[y.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>r(!1)}),y.jsx("div",{className:"absolute inset-0",children:y.jsx(S5,{onClose:()=>r(!1),onSaved:()=>r(!1)})})]}),y.jsx(qX,{onAddTransaction:()=>r(!0)})]}),y.jsx(GX,{})]})}p6({onNeedRefresh(){},onOfflineReady(){console.log("App is ready for offline work")}});d6.createRoot(document.getElementById("root")).render(y.jsx(F.StrictMode,{children:y.jsx(kte,{})}));
