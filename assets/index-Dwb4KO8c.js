(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function gz(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var mx={exports:{}},Hf={};var d2;function mz(){if(d2)return Hf;d2=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,i,a){var o=null;if(a!==void 0&&(o=""+a),i.key!==void 0&&(o=""+i.key),"key"in i){a={};for(var c in i)c!=="key"&&(a[c]=i[c])}else a=i;return i=a.ref,{$$typeof:n,type:r,key:o,ref:i!==void 0?i:null,props:a}}return Hf.Fragment=e,Hf.jsx=t,Hf.jsxs=t,Hf}var f2;function vz(){return f2||(f2=1,mx.exports=mz()),mx.exports}var v=vz(),vx={exports:{}},ot={};var h2;function yz(){if(h2)return ot;h2=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),m=Symbol.iterator;function b(G){return G===null||typeof G!="object"?null:(G=m&&G[m]||G["@@iterator"],typeof G=="function"?G:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function T(G,Y,re){this.props=G,this.context=Y,this.refs=S,this.updater=re||_}T.prototype.isReactComponent={},T.prototype.setState=function(G,Y){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,Y,"setState")},T.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function C(){}C.prototype=T.prototype;function R(G,Y,re){this.props=G,this.context=Y,this.refs=S,this.updater=re||_}var O=R.prototype=new C;O.constructor=R,w(O,T.prototype),O.isPureReactComponent=!0;var P=Array.isArray;function N(){}var A={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function k(G,Y,re){var Z=re.ref;return{$$typeof:n,type:G,key:Y,ref:Z!==void 0?Z:null,props:re}}function z(G,Y){return k(G.type,Y,G.props)}function V(G){return typeof G=="object"&&G!==null&&G.$$typeof===n}function B(G){var Y={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(re){return Y[re]})}var j=/\/+/g;function X(G,Y){return typeof G=="object"&&G!==null&&G.key!=null?B(""+G.key):Y.toString(36)}function H(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(N,N):(G.status="pending",G.then(function(Y){G.status==="pending"&&(G.status="fulfilled",G.value=Y)},function(Y){G.status==="pending"&&(G.status="rejected",G.reason=Y)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function $(G,Y,re,Z,oe){var fe=typeof G;(fe==="undefined"||fe==="boolean")&&(G=null);var be=!1;if(G===null)be=!0;else switch(fe){case"bigint":case"string":case"number":be=!0;break;case"object":switch(G.$$typeof){case n:case e:be=!0;break;case h:return be=G._init,$(be(G._payload),Y,re,Z,oe)}}if(be)return oe=oe(G),be=Z===""?"."+X(G,0):Z,P(oe)?(re="",be!=null&&(re=be.replace(j,"$&/")+"/"),$(oe,Y,re,"",function(Pe){return Pe})):oe!=null&&(V(oe)&&(oe=z(oe,re+(oe.key==null||G&&G.key===oe.key?"":(""+oe.key).replace(j,"$&/")+"/")+be)),Y.push(oe)),1;be=0;var Ce=Z===""?".":Z+":";if(P(G))for(var we=0;we<G.length;we++)Z=G[we],fe=Ce+X(Z,we),be+=$(Z,Y,re,fe,oe);else if(we=b(G),typeof we=="function")for(G=we.call(G),we=0;!(Z=G.next()).done;)Z=Z.value,fe=Ce+X(Z,we++),be+=$(Z,Y,re,fe,oe);else if(fe==="object"){if(typeof G.then=="function")return $(H(G),Y,re,Z,oe);throw Y=String(G),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.")}return be}function W(G,Y,re){if(G==null)return G;var Z=[],oe=0;return $(G,Z,"","",function(fe){return Y.call(re,fe,oe++)}),Z}function ee(G){if(G._status===-1){var Y=G._result;Y=Y(),Y.then(function(re){(G._status===0||G._status===-1)&&(G._status=1,G._result=re)},function(re){(G._status===0||G._status===-1)&&(G._status=2,G._result=re)}),G._status===-1&&(G._status=0,G._result=Y)}if(G._status===1)return G._result.default;throw G._result}var he=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent(Y))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)},K={map:W,forEach:function(G,Y,re){W(G,function(){Y.apply(this,arguments)},re)},count:function(G){var Y=0;return W(G,function(){Y++}),Y},toArray:function(G){return W(G,function(Y){return Y})||[]},only:function(G){if(!V(G))throw Error("React.Children.only expected to receive a single React element child.");return G}};return ot.Activity=p,ot.Children=K,ot.Component=T,ot.Fragment=t,ot.Profiler=i,ot.PureComponent=R,ot.StrictMode=r,ot.Suspense=u,ot.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,ot.__COMPILER_RUNTIME={__proto__:null,c:function(G){return A.H.useMemoCache(G)}},ot.cache=function(G){return function(){return G.apply(null,arguments)}},ot.cacheSignal=function(){return null},ot.cloneElement=function(G,Y,re){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var Z=w({},G.props),oe=G.key;if(Y!=null)for(fe in Y.key!==void 0&&(oe=""+Y.key),Y)!I.call(Y,fe)||fe==="key"||fe==="__self"||fe==="__source"||fe==="ref"&&Y.ref===void 0||(Z[fe]=Y[fe]);var fe=arguments.length-2;if(fe===1)Z.children=re;else if(1<fe){for(var be=Array(fe),Ce=0;Ce<fe;Ce++)be[Ce]=arguments[Ce+2];Z.children=be}return k(G.type,oe,Z)},ot.createContext=function(G){return G={$$typeof:o,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:a,_context:G},G},ot.createElement=function(G,Y,re){var Z,oe={},fe=null;if(Y!=null)for(Z in Y.key!==void 0&&(fe=""+Y.key),Y)I.call(Y,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(oe[Z]=Y[Z]);var be=arguments.length-2;if(be===1)oe.children=re;else if(1<be){for(var Ce=Array(be),we=0;we<be;we++)Ce[we]=arguments[we+2];oe.children=Ce}if(G&&G.defaultProps)for(Z in be=G.defaultProps,be)oe[Z]===void 0&&(oe[Z]=be[Z]);return k(G,fe,oe)},ot.createRef=function(){return{current:null}},ot.forwardRef=function(G){return{$$typeof:c,render:G}},ot.isValidElement=V,ot.lazy=function(G){return{$$typeof:h,_payload:{_status:-1,_result:G},_init:ee}},ot.memo=function(G,Y){return{$$typeof:d,type:G,compare:Y===void 0?null:Y}},ot.startTransition=function(G){var Y=A.T,re={};A.T=re;try{var Z=G(),oe=A.S;oe!==null&&oe(re,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(N,he)}catch(fe){he(fe)}finally{Y!==null&&re.types!==null&&(Y.types=re.types),A.T=Y}},ot.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},ot.use=function(G){return A.H.use(G)},ot.useActionState=function(G,Y,re){return A.H.useActionState(G,Y,re)},ot.useCallback=function(G,Y){return A.H.useCallback(G,Y)},ot.useContext=function(G){return A.H.useContext(G)},ot.useDebugValue=function(){},ot.useDeferredValue=function(G,Y){return A.H.useDeferredValue(G,Y)},ot.useEffect=function(G,Y){return A.H.useEffect(G,Y)},ot.useEffectEvent=function(G){return A.H.useEffectEvent(G)},ot.useId=function(){return A.H.useId()},ot.useImperativeHandle=function(G,Y,re){return A.H.useImperativeHandle(G,Y,re)},ot.useInsertionEffect=function(G,Y){return A.H.useInsertionEffect(G,Y)},ot.useLayoutEffect=function(G,Y){return A.H.useLayoutEffect(G,Y)},ot.useMemo=function(G,Y){return A.H.useMemo(G,Y)},ot.useOptimistic=function(G,Y){return A.H.useOptimistic(G,Y)},ot.useReducer=function(G,Y,re){return A.H.useReducer(G,Y,re)},ot.useRef=function(G){return A.H.useRef(G)},ot.useState=function(G){return A.H.useState(G)},ot.useSyncExternalStore=function(G,Y,re){return A.H.useSyncExternalStore(G,Y,re)},ot.useTransition=function(){return A.H.useTransition()},ot.version="19.2.0",ot}var p2;function cw(){return p2||(p2=1,vx.exports=yz()),vx.exports}var U=cw();const nh=gz(U);var yx={exports:{}},Yf={},bx={exports:{}},xx={};var g2;function bz(){return g2||(g2=1,(function(n){function e($,W){var ee=$.length;$.push(W);e:for(;0<ee;){var he=ee-1>>>1,K=$[he];if(0<i(K,W))$[he]=W,$[ee]=K,ee=he;else break e}}function t($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var W=$[0],ee=$.pop();if(ee!==W){$[0]=ee;e:for(var he=0,K=$.length,G=K>>>1;he<G;){var Y=2*(he+1)-1,re=$[Y],Z=Y+1,oe=$[Z];if(0>i(re,ee))Z<K&&0>i(oe,re)?($[he]=oe,$[Z]=ee,he=Z):($[he]=re,$[Y]=ee,he=Y);else if(Z<K&&0>i(oe,ee))$[he]=oe,$[Z]=ee,he=Z;else break e}}return W}function i($,W){var ee=$.sortIndex-W.sortIndex;return ee!==0?ee:$.id-W.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();n.unstable_now=function(){return o.now()-c}}var u=[],d=[],h=1,p=null,m=3,b=!1,_=!1,w=!1,S=!1,T=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function O($){for(var W=t(d);W!==null;){if(W.callback===null)r(d);else if(W.startTime<=$)r(d),W.sortIndex=W.expirationTime,e(u,W);else break;W=t(d)}}function P($){if(w=!1,O($),!_)if(t(u)!==null)_=!0,N||(N=!0,B());else{var W=t(d);W!==null&&H(P,W.startTime-$)}}var N=!1,A=-1,I=5,k=-1;function z(){return S?!0:!(n.unstable_now()-k<I)}function V(){if(S=!1,N){var $=n.unstable_now();k=$;var W=!0;try{e:{_=!1,w&&(w=!1,C(A),A=-1),b=!0;var ee=m;try{t:{for(O($),p=t(u);p!==null&&!(p.expirationTime>$&&z());){var he=p.callback;if(typeof he=="function"){p.callback=null,m=p.priorityLevel;var K=he(p.expirationTime<=$);if($=n.unstable_now(),typeof K=="function"){p.callback=K,O($),W=!0;break t}p===t(u)&&r(u),O($)}else r(u);p=t(u)}if(p!==null)W=!0;else{var G=t(d);G!==null&&H(P,G.startTime-$),W=!1}}break e}finally{p=null,m=ee,b=!1}W=void 0}}finally{W?B():N=!1}}}var B;if(typeof R=="function")B=function(){R(V)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,X=j.port2;j.port1.onmessage=V,B=function(){X.postMessage(null)}}else B=function(){T(V,0)};function H($,W){A=T(function(){$(n.unstable_now())},W)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function($){switch(m){case 1:case 2:case 3:var W=3;break;default:W=m}var ee=m;m=W;try{return $()}finally{m=ee}},n.unstable_requestPaint=function(){S=!0},n.unstable_runWithPriority=function($,W){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var ee=m;m=$;try{return W()}finally{m=ee}},n.unstable_scheduleCallback=function($,W,ee){var he=n.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?he+ee:he):ee=he,$){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=ee+K,$={id:h++,callback:W,priorityLevel:$,startTime:ee,expirationTime:K,sortIndex:-1},ee>he?($.sortIndex=ee,e(d,$),t(u)===null&&$===t(d)&&(w?(C(A),A=-1):w=!0,H(P,ee-he))):($.sortIndex=K,e(u,$),_||b||(_=!0,N||(N=!0,B()))),$},n.unstable_shouldYield=z,n.unstable_wrapCallback=function($){var W=m;return function(){var ee=m;m=W;try{return $.apply(this,arguments)}finally{m=ee}}}})(xx)),xx}var m2;function xz(){return m2||(m2=1,bx.exports=bz()),bx.exports}var _x={exports:{}},fr={};var v2;function _z(){if(v2)return fr;v2=1;var n=cw();function e(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)d+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(u,d,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:p==null?null:""+p,children:u,containerInfo:d,implementation:h}}var o=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return fr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,fr.createPortal=function(u,d){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return a(u,d,null,h)},fr.flushSync=function(u){var d=o.T,h=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=d,r.p=h,r.d.f()}},fr.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(u,d))},fr.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},fr.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin),m=typeof d.integrity=="string"?d.integrity:void 0,b=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;h==="style"?r.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:b}):h==="script"&&r.d.X(u,{crossOrigin:p,integrity:m,fetchPriority:b,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},fr.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var h=c(d.as,d.crossOrigin);r.d.M(u,{crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(u)},fr.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin);r.d.L(u,h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},fr.preloadModule=function(u,d){if(typeof u=="string")if(d){var h=c(d.as,d.crossOrigin);r.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(u)},fr.requestFormReset=function(u){r.d.r(u)},fr.unstable_batchedUpdates=function(u,d){return u(d)},fr.useFormState=function(u,d,h){return o.H.useFormState(u,d,h)},fr.useFormStatus=function(){return o.H.useHostTransitionStatus()},fr.version="19.2.0",fr}var y2;function wz(){if(y2)return _x.exports;y2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),_x.exports=_z(),_x.exports}var b2;function Ez(){if(b2)return Yf;b2=1;var n=xz(),e=cw(),t=wz();function r(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var l=s,f=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(f=l.return),s=l.return;while(s)}return l.tag===3?f:null}function o(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function c(s){if(s.tag===31){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function u(s){if(a(s)!==s)throw Error(r(188))}function d(s){var l=s.alternate;if(!l){if(l=a(s),l===null)throw Error(r(188));return l!==s?null:s}for(var f=s,g=l;;){var x=f.return;if(x===null)break;var E=x.alternate;if(E===null){if(g=x.return,g!==null){f=g;continue}break}if(x.child===E.child){for(E=x.child;E;){if(E===f)return u(x),s;if(E===g)return u(x),l;E=E.sibling}throw Error(r(188))}if(f.return!==g.return)f=x,g=E;else{for(var M=!1,F=x.child;F;){if(F===f){M=!0,f=x,g=E;break}if(F===g){M=!0,g=x,f=E;break}F=F.sibling}if(!M){for(F=E.child;F;){if(F===f){M=!0,f=E,g=x;break}if(F===g){M=!0,g=E,f=x;break}F=F.sibling}if(!M)throw Error(r(189))}}if(f.alternate!==g)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?s:l}function h(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=h(s),l!==null)return l;s=s.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),R=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),z=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function B(s){return s===null||typeof s!="object"?null:(s=V&&s[V]||s["@@iterator"],typeof s=="function"?s:null)}var j=Symbol.for("react.client.reference");function X(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===j?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case w:return"Fragment";case T:return"Profiler";case S:return"StrictMode";case P:return"Suspense";case N:return"SuspenseList";case k:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case _:return"Portal";case R:return s.displayName||"Context";case C:return(s._context.displayName||"Context")+".Consumer";case O:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case A:return l=s.displayName||null,l!==null?l:X(s.type)||"Memo";case I:l=s._payload,s=s._init;try{return X(s(l))}catch{}}return null}var H=Array.isArray,$=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee={pending:!1,data:null,method:null,action:null},he=[],K=-1;function G(s){return{current:s}}function Y(s){0>K||(s.current=he[K],he[K]=null,K--)}function re(s,l){K++,he[K]=s.current,s.current=l}var Z=G(null),oe=G(null),fe=G(null),be=G(null);function Ce(s,l){switch(re(fe,l),re(oe,s),re(Z,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?PC(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=PC(l),s=OC(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}Y(Z),re(Z,s)}function we(){Y(Z),Y(oe),Y(fe)}function Pe(s){s.memoizedState!==null&&re(be,s);var l=Z.current,f=OC(l,s.type);l!==f&&(re(oe,s),re(Z,f))}function ue(s){oe.current===s&&(Y(Z),Y(oe)),be.current===s&&(Y(be),Ff._currentValue=ee)}var _e,ze;function Ne(s){if(_e===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);_e=l&&l[1]||"",ze=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+_e+s+ze}var qe=!1;function Fe(s,l){if(!s||qe)return"";qe=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(l){var xe=function(){throw Error()};if(Object.defineProperty(xe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xe,[])}catch(ge){var de=ge}Reflect.construct(s,[],xe)}else{try{xe.call()}catch(ge){de=ge}s.call(xe.prototype)}}else{try{throw Error()}catch(ge){de=ge}(xe=s())&&typeof xe.catch=="function"&&xe.catch(function(){})}}catch(ge){if(ge&&de&&typeof ge.stack=="string")return[ge.stack,de.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=g.DetermineComponentFrameRoot(),M=E[0],F=E[1];if(M&&F){var Q=M.split(`
`),ce=F.split(`
`);for(x=g=0;g<Q.length&&!Q[g].includes("DetermineComponentFrameRoot");)g++;for(;x<ce.length&&!ce[x].includes("DetermineComponentFrameRoot");)x++;if(g===Q.length||x===ce.length)for(g=Q.length-1,x=ce.length-1;1<=g&&0<=x&&Q[g]!==ce[x];)x--;for(;1<=g&&0<=x;g--,x--)if(Q[g]!==ce[x]){if(g!==1||x!==1)do if(g--,x--,0>x||Q[g]!==ce[x]){var ve=`
`+Q[g].replace(" at new "," at ");return s.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",s.displayName)),ve}while(1<=g&&0<=x);break}}}finally{qe=!1,Error.prepareStackTrace=f}return(f=s?s.displayName||s.name:"")?Ne(f):""}function Te(s,l){switch(s.tag){case 26:case 27:case 5:return Ne(s.type);case 16:return Ne("Lazy");case 13:return s.child!==l&&l!==null?Ne("Suspense Fallback"):Ne("Suspense");case 19:return Ne("SuspenseList");case 0:case 15:return Fe(s.type,!1);case 11:return Fe(s.type.render,!1);case 1:return Fe(s.type,!0);case 31:return Ne("Activity");default:return""}}function Le(s){try{var l="",f=null;do l+=Te(s,f),f=s,s=s.return;while(s);return l}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var Me=Object.prototype.hasOwnProperty,Be=n.unstable_scheduleCallback,lt=n.unstable_cancelCallback,At=n.unstable_shouldYield,et=n.unstable_requestPaint,ft=n.unstable_now,kt=n.unstable_getCurrentPriorityLevel,pn=n.unstable_ImmediatePriority,Ut=n.unstable_UserBlockingPriority,Cn=n.unstable_NormalPriority,Hr=n.unstable_LowPriority,ua=n.unstable_IdlePriority,Qa=n.log,Fs=n.unstable_setDisableYieldValue,Yr=null,In=null;function dr(s){if(typeof Qa=="function"&&Fs(s),In&&typeof In.setStrictMode=="function")try{In.setStrictMode(Yr,s)}catch{}}var sn=Math.clz32?Math.clz32:qs,Lc=Math.log,Gs=Math.LN2;function qs(s){return s>>>=0,s===0?32:31-(Lc(s)/Gs|0)|0}var mt=256,on=262144,ln=4194304;function Kr(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function ui(s,l,f){var g=s.pendingLanes;if(g===0)return 0;var x=0,E=s.suspendedLanes,M=s.pingedLanes;s=s.warmLanes;var F=g&134217727;return F!==0?(g=F&~E,g!==0?x=Kr(g):(M&=F,M!==0?x=Kr(M):f||(f=F&~s,f!==0&&(x=Kr(f))))):(F=g&~E,F!==0?x=Kr(F):M!==0?x=Kr(M):f||(f=g&~s,f!==0&&(x=Kr(f)))),x===0?0:l!==0&&l!==x&&(l&E)===0&&(E=x&-x,f=l&-l,E>=f||E===32&&(f&4194048)!==0)?l:x}function _r(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function xy(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tg(){var s=ln;return ln<<=1,(ln&62914560)===0&&(ln=4194304),s}function da(s){for(var l=[],f=0;31>f;f++)l.push(s);return l}function fl(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function _y(s,l,f,g,x,E){var M=s.pendingLanes;s.pendingLanes=f,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=f,s.entangledLanes&=f,s.errorRecoveryDisabledLanes&=f,s.shellSuspendCounter=0;var F=s.entanglements,Q=s.expirationTimes,ce=s.hiddenUpdates;for(f=M&~f;0<f;){var ve=31-sn(f),xe=1<<ve;F[ve]=0,Q[ve]=-1;var de=ce[ve];if(de!==null)for(ce[ve]=null,ve=0;ve<de.length;ve++){var ge=de[ve];ge!==null&&(ge.lane&=-536870913)}f&=~xe}g!==0&&hl(s,g,0),E!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=E&~(M&~l))}function hl(s,l,f){s.pendingLanes|=l,s.suspendedLanes&=~l;var g=31-sn(l);s.entangledLanes|=l,s.entanglements[g]=s.entanglements[g]|1073741824|f&261930}function Hd(s,l){var f=s.entangledLanes|=l;for(s=s.entanglements;f;){var g=31-sn(f),x=1<<g;x&l|s[g]&l&&(s[g]|=l),f&=~x}}function Yd(s,l){var f=l&-l;return f=(f&42)!==0?1:pl(f),(f&(s.suspendedLanes|l))!==0?0:f}function pl(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Za(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function ng(){var s=W.p;return s!==0?s:(s=window.event,s===void 0?32:i2(s.type))}function Vi(s,l){var f=W.p;try{return W.p=s,l()}finally{W.p=f}}var zi=Math.random().toString(36).slice(2),Rn="__reactFiber$"+zi,Qn="__reactProps$"+zi,fa="__reactContainer$"+zi,Bc="__reactEvents$"+zi,wy="__reactListeners$"+zi,rg="__reactHandles$"+zi,ig="__reactResources$"+zi,ha="__reactMarker$"+zi;function Uc(s){delete s[Rn],delete s[Qn],delete s[Bc],delete s[wy],delete s[rg]}function pa(s){var l=s[Rn];if(l)return l;for(var f=s.parentNode;f;){if(l=f[fa]||f[Rn]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(s=FC(s);s!==null;){if(f=s[Rn])return f;s=FC(s)}return l}s=f,f=s.parentNode}return null}function di(s){if(s=s[Rn]||s[fa]){var l=s.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return s}return null}function Xr(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(r(33))}function ga(s){var l=s[ig];return l||(l=s[ig]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Dn(s){s[ha]=!0}var Kd=new Set,Xd={};function ma(s,l){va(s,l),va(s+"Capture",l)}function va(s,l){for(Xd[s]=l,s=0;s<l.length;s++)Kd.add(l[s])}var Wd=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Qd={},Zd={};function ag(s){return Me.call(Zd,s)?!0:Me.call(Qd,s)?!1:Wd.test(s)?Zd[s]=!0:(Qd[s]=!0,!1)}function Fc(s,l,f){if(ag(l))if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var g=l.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+f)}}function Wr(s,l,f){if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+f)}}function kn(s,l,f,g){if(g===null)s.removeAttribute(f);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(f);return}s.setAttributeNS(l,f,""+g)}}function Zn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function $s(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Jd(s,l,f){var g=Object.getOwnPropertyDescriptor(s.constructor.prototype,l);if(!s.hasOwnProperty(l)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var x=g.get,E=g.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return x.call(this)},set:function(M){f=""+M,E.call(this,M)}}),Object.defineProperty(s,l,{enumerable:g.enumerable}),{getValue:function(){return f},setValue:function(M){f=""+M},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function Ot(s){if(!s._valueTracker){var l=$s(s)?"checked":"value";s._valueTracker=Jd(s,l,""+s[l])}}function gl(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var f=l.getValue(),g="";return s&&(g=$s(s)?s.checked?"true":"false":s.value),s=g,s!==f?(l.setValue(s),!0):!1}function ya(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var ml=/[\n"\\]/g;function Nr(s){return s.replace(ml,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Gc(s,l,f,g,x,E,M,F){s.name="",M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?s.type=M:s.removeAttribute("type"),l!=null?M==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+Zn(l)):s.value!==""+Zn(l)&&(s.value=""+Zn(l)):M!=="submit"&&M!=="reset"||s.removeAttribute("value"),l!=null?ef(s,M,Zn(l)):f!=null?ef(s,M,Zn(f)):g!=null&&s.removeAttribute("value"),x==null&&E!=null&&(s.defaultChecked=!!E),x!=null&&(s.checked=x&&typeof x!="function"&&typeof x!="symbol"),F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"?s.name=""+Zn(F):s.removeAttribute("name")}function sg(s,l,f,g,x,E,M,F){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(s.type=E),l!=null||f!=null){if(!(E!=="submit"&&E!=="reset"||l!=null)){Ot(s);return}f=f!=null?""+Zn(f):"",l=l!=null?""+Zn(l):f,F||l===s.value||(s.value=l),s.defaultValue=l}g=g??x,g=typeof g!="function"&&typeof g!="symbol"&&!!g,s.checked=F?s.checked:!!g,s.defaultChecked=!!g,M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"&&(s.name=M),Ot(s)}function ef(s,l,f){l==="number"&&ya(s.ownerDocument)===s||s.defaultValue===""+f||(s.defaultValue=""+f)}function Hs(s,l,f,g){if(s=s.options,l){l={};for(var x=0;x<f.length;x++)l["$"+f[x]]=!0;for(f=0;f<s.length;f++)x=l.hasOwnProperty("$"+s[f].value),s[f].selected!==x&&(s[f].selected=x),x&&g&&(s[f].defaultSelected=!0)}else{for(f=""+Zn(f),l=null,x=0;x<s.length;x++){if(s[x].value===f){s[x].selected=!0,g&&(s[x].defaultSelected=!0);return}l!==null||s[x].disabled||(l=s[x])}l!==null&&(l.selected=!0)}}function og(s,l,f){if(l!=null&&(l=""+Zn(l),l!==s.value&&(s.value=l),f==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=f!=null?""+Zn(f):""}function Ys(s,l,f,g){if(l==null){if(g!=null){if(f!=null)throw Error(r(92));if(H(g)){if(1<g.length)throw Error(r(93));g=g[0]}f=g}f==null&&(f=""),l=f}f=Zn(l),s.defaultValue=f,g=s.textContent,g===f&&g!==""&&g!==null&&(s.value=g),Ot(s)}function Mr(s,l){if(l){var f=s.firstChild;if(f&&f===s.lastChild&&f.nodeType===3){f.nodeValue=l;return}}s.textContent=l}var lg=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function tf(s,l,f){var g=l.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?g?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":g?s.setProperty(l,f):typeof f!="number"||f===0||lg.has(l)?l==="float"?s.cssFloat=f:s[l]=(""+f).trim():s[l]=f+"px"}function nf(s,l,f){if(l!=null&&typeof l!="object")throw Error(r(62));if(s=s.style,f!=null){for(var g in f)!f.hasOwnProperty(g)||l!=null&&l.hasOwnProperty(g)||(g.indexOf("--")===0?s.setProperty(g,""):g==="float"?s.cssFloat="":s[g]="");for(var x in l)g=l[x],l.hasOwnProperty(x)&&f[x]!==g&&tf(s,x,g)}else for(var E in l)l.hasOwnProperty(E)&&tf(s,E,l[E])}function qc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cg=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ks=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function $c(s){return Ks.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Li(){}var rf=null;function fi(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Xs=null,ba=null;function vl(s){var l=di(s);if(l&&(s=l.stateNode)){var f=s[Qn]||null;e:switch(s=l.stateNode,l.type){case"input":if(Gc(s,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),l=f.name,f.type==="radio"&&l!=null){for(f=s;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Nr(""+l)+'"][type="radio"]'),l=0;l<f.length;l++){var g=f[l];if(g!==s&&g.form===s.form){var x=g[Qn]||null;if(!x)throw Error(r(90));Gc(g,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(l=0;l<f.length;l++)g=f[l],g.form===s.form&&gl(g)}break e;case"textarea":og(s,f.value,f.defaultValue);break e;case"select":l=f.value,l!=null&&Hs(s,!!f.multiple,l,!1)}}}var Hc=!1;function Ws(s,l,f){if(Hc)return s(l,f);Hc=!0;try{var g=s(l);return g}finally{if(Hc=!1,(Xs!==null||ba!==null)&&(nm(),Xs&&(l=Xs,s=ba,ba=Xs=null,vl(l),s)))for(l=0;l<s.length;l++)vl(s[l])}}function Bi(s,l){var f=s.stateNode;if(f===null)return null;var g=f[Qn]||null;if(g===null)return null;f=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(s=s.type,g=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!g;break e;default:s=!1}if(s)return null;if(f&&typeof f!="function")throw Error(r(231,l,typeof f));return f}var hi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),yl=!1;if(hi)try{var Ft={};Object.defineProperty(Ft,"passive",{get:function(){yl=!0}}),window.addEventListener("test",Ft,Ft),window.removeEventListener("test",Ft,Ft)}catch{yl=!1}var xa=null,af=null,bl=null;function sf(){if(bl)return bl;var s,l=af,f=l.length,g,x="value"in xa?xa.value:xa.textContent,E=x.length;for(s=0;s<f&&l[s]===x[s];s++);var M=f-s;for(g=1;g<=M&&l[f-g]===x[E-g];g++);return bl=x.slice(s,1<g?1-g:void 0)}function xl(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function Ja(){return!0}function Ui(){return!1}function tr(s){function l(f,g,x,E,M){this._reactName=f,this._targetInst=x,this.type=g,this.nativeEvent=E,this.target=M,this.currentTarget=null;for(var F in s)s.hasOwnProperty(F)&&(f=s[F],this[F]=f?f(E):E[F]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?Ja:Ui,this.isPropagationStopped=Ui,this}return p(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Ja)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Ja)},persist:function(){},isPersistent:Ja}),l}var es={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_a=tr(es),Qs=p({},es,{view:0,detail:0}),of=tr(Qs),Zs,Yc,wa,Kc=p({},Qs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Js,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==wa&&(wa&&s.type==="mousemove"?(Zs=s.screenX-wa.screenX,Yc=s.screenY-wa.screenY):Yc=Zs=0,wa=s),Zs)},movementY:function(s){return"movementY"in s?s.movementY:Yc}}),lf=tr(Kc),_l=p({},Kc,{dataTransfer:0}),ug=tr(_l),dg=p({},Qs,{relatedTarget:0}),wl=tr(dg),cf=p({},es,{animationName:0,elapsedTime:0,pseudoElement:0}),fg=tr(cf),Xc=p({},es,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),hg=tr(Xc),pg=p({},es,{data:0}),Ea=tr(pg),gg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yg(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=vg[s])?!!l[s]:!1}function Js(){return yg}var wr=p({},Qs,{key:function(s){if(s.key){var l=gg[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=xl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?mg[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Js,charCode:function(s){return s.type==="keypress"?xl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?xl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),bg=tr(wr),xg=p({},Kc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ts=tr(xg),y=p({},Qs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Js}),D=tr(y),L=p({},es,{propertyName:0,elapsedTime:0,pseudoElement:0}),q=tr(L),se=p({},Kc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),pe=tr(se),De=p({},es,{newState:0,oldState:0}),ct=tr(De),_n=[9,13,27,32],Nt=hi&&"CompositionEvent"in window,en=null;hi&&"documentMode"in document&&(en=document.documentMode);var pi=hi&&"TextEvent"in window&&!en,Sa=hi&&(!Nt||en&&8<en&&11>=en),Fi=" ",Gi=!1;function El(s,l){switch(s){case"keyup":return _n.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wc(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Qc=!1;function L5(s,l){switch(s){case"compositionend":return Wc(l);case"keypress":return l.which!==32?null:(Gi=!0,Fi);case"textInput":return s=l.data,s===Fi&&Gi?null:s;default:return null}}function B5(s,l){if(Qc)return s==="compositionend"||!Nt&&El(s,l)?(s=sf(),bl=af=xa=null,Qc=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Sa&&l.locale!=="ko"?null:l.data;default:return null}}var U5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $S(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!U5[s.type]:l==="textarea"}function HS(s,l,f,g){Xs?ba?ba.push(g):ba=[g]:Xs=g,l=cm(l,"onChange"),0<l.length&&(f=new _a("onChange","change",null,f,g),s.push({event:f,listeners:l}))}var uf=null,df=null;function F5(s){IC(s,0)}function _g(s){var l=Xr(s);if(gl(l))return s}function YS(s,l){if(s==="change")return l}var KS=!1;if(hi){var Ey;if(hi){var Sy="oninput"in document;if(!Sy){var XS=document.createElement("div");XS.setAttribute("oninput","return;"),Sy=typeof XS.oninput=="function"}Ey=Sy}else Ey=!1;KS=Ey&&(!document.documentMode||9<document.documentMode)}function WS(){uf&&(uf.detachEvent("onpropertychange",QS),df=uf=null)}function QS(s){if(s.propertyName==="value"&&_g(df)){var l=[];HS(l,df,s,fi(s)),Ws(F5,l)}}function G5(s,l,f){s==="focusin"?(WS(),uf=l,df=f,uf.attachEvent("onpropertychange",QS)):s==="focusout"&&WS()}function q5(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return _g(df)}function $5(s,l){if(s==="click")return _g(l)}function H5(s,l){if(s==="input"||s==="change")return _g(l)}function Y5(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var Qr=typeof Object.is=="function"?Object.is:Y5;function ff(s,l){if(Qr(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var f=Object.keys(s),g=Object.keys(l);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var x=f[g];if(!Me.call(l,x)||!Qr(s[x],l[x]))return!1}return!0}function ZS(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function JS(s,l){var f=ZS(s);s=0;for(var g;f;){if(f.nodeType===3){if(g=s+f.textContent.length,s<=l&&g>=l)return{node:f,offset:l-s};s=g}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=ZS(f)}}function eT(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?eT(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function tT(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=ya(s.document);l instanceof s.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)s=l.contentWindow;else break;l=ya(s.document)}return l}function Ty(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var K5=hi&&"documentMode"in document&&11>=document.documentMode,Zc=null,Ay=null,hf=null,Cy=!1;function nT(s,l,f){var g=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Cy||Zc==null||Zc!==ya(g)||(g=Zc,"selectionStart"in g&&Ty(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),hf&&ff(hf,g)||(hf=g,g=cm(Ay,"onSelect"),0<g.length&&(l=new _a("onSelect","select",null,l,f),s.push({event:l,listeners:g}),l.target=Zc)))}function Sl(s,l){var f={};return f[s.toLowerCase()]=l.toLowerCase(),f["Webkit"+s]="webkit"+l,f["Moz"+s]="moz"+l,f}var Jc={animationend:Sl("Animation","AnimationEnd"),animationiteration:Sl("Animation","AnimationIteration"),animationstart:Sl("Animation","AnimationStart"),transitionrun:Sl("Transition","TransitionRun"),transitionstart:Sl("Transition","TransitionStart"),transitioncancel:Sl("Transition","TransitionCancel"),transitionend:Sl("Transition","TransitionEnd")},Iy={},rT={};hi&&(rT=document.createElement("div").style,"AnimationEvent"in window||(delete Jc.animationend.animation,delete Jc.animationiteration.animation,delete Jc.animationstart.animation),"TransitionEvent"in window||delete Jc.transitionend.transition);function Tl(s){if(Iy[s])return Iy[s];if(!Jc[s])return s;var l=Jc[s],f;for(f in l)if(l.hasOwnProperty(f)&&f in rT)return Iy[s]=l[f];return s}var iT=Tl("animationend"),aT=Tl("animationiteration"),sT=Tl("animationstart"),X5=Tl("transitionrun"),W5=Tl("transitionstart"),Q5=Tl("transitioncancel"),oT=Tl("transitionend"),lT=new Map,Ry="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ry.push("scrollEnd");function qi(s,l){lT.set(s,l),ma(l,[s])}var wg=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},gi=[],eu=0,Dy=0;function Eg(){for(var s=eu,l=Dy=eu=0;l<s;){var f=gi[l];gi[l++]=null;var g=gi[l];gi[l++]=null;var x=gi[l];gi[l++]=null;var E=gi[l];if(gi[l++]=null,g!==null&&x!==null){var M=g.pending;M===null?x.next=x:(x.next=M.next,M.next=x),g.pending=x}E!==0&&cT(f,x,E)}}function Sg(s,l,f,g){gi[eu++]=s,gi[eu++]=l,gi[eu++]=f,gi[eu++]=g,Dy|=g,s.lanes|=g,s=s.alternate,s!==null&&(s.lanes|=g)}function ky(s,l,f,g){return Sg(s,l,f,g),Tg(s)}function Al(s,l){return Sg(s,null,null,l),Tg(s)}function cT(s,l,f){s.lanes|=f;var g=s.alternate;g!==null&&(g.lanes|=f);for(var x=!1,E=s.return;E!==null;)E.childLanes|=f,g=E.alternate,g!==null&&(g.childLanes|=f),E.tag===22&&(s=E.stateNode,s===null||s._visibility&1||(x=!0)),s=E,E=E.return;return s.tag===3?(E=s.stateNode,x&&l!==null&&(x=31-sn(f),s=E.hiddenUpdates,g=s[x],g===null?s[x]=[l]:g.push(l),l.lane=f|536870912),E):null}function Tg(s){if(50<Of)throw Of=0,Bb=null,Error(r(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var tu={};function Z5(s,l,f,g){this.tag=s,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zr(s,l,f,g){return new Z5(s,l,f,g)}function Ny(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ns(s,l){var f=s.alternate;return f===null?(f=Zr(s.tag,l,s.key,s.mode),f.elementType=s.elementType,f.type=s.type,f.stateNode=s.stateNode,f.alternate=s,s.alternate=f):(f.pendingProps=l,f.type=s.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=s.flags&65011712,f.childLanes=s.childLanes,f.lanes=s.lanes,f.child=s.child,f.memoizedProps=s.memoizedProps,f.memoizedState=s.memoizedState,f.updateQueue=s.updateQueue,l=s.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=s.sibling,f.index=s.index,f.ref=s.ref,f.refCleanup=s.refCleanup,f}function uT(s,l){s.flags&=65011714;var f=s.alternate;return f===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=f.childLanes,s.lanes=f.lanes,s.child=f.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=f.memoizedProps,s.memoizedState=f.memoizedState,s.updateQueue=f.updateQueue,s.type=f.type,l=f.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function Ag(s,l,f,g,x,E){var M=0;if(g=s,typeof s=="function")Ny(s)&&(M=1);else if(typeof s=="string")M=rz(s,f,Z.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case k:return s=Zr(31,f,l,x),s.elementType=k,s.lanes=E,s;case w:return Cl(f.children,x,E,l);case S:M=8,x|=24;break;case T:return s=Zr(12,f,l,x|2),s.elementType=T,s.lanes=E,s;case P:return s=Zr(13,f,l,x),s.elementType=P,s.lanes=E,s;case N:return s=Zr(19,f,l,x),s.elementType=N,s.lanes=E,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case R:M=10;break e;case C:M=9;break e;case O:M=11;break e;case A:M=14;break e;case I:M=16,g=null;break e}M=29,f=Error(r(130,s===null?"null":typeof s,"")),g=null}return l=Zr(M,f,l,x),l.elementType=s,l.type=g,l.lanes=E,l}function Cl(s,l,f,g){return s=Zr(7,s,g,l),s.lanes=f,s}function My(s,l,f){return s=Zr(6,s,null,l),s.lanes=f,s}function dT(s){var l=Zr(18,null,null,0);return l.stateNode=s,l}function Py(s,l,f){return l=Zr(4,s.children!==null?s.children:[],s.key,l),l.lanes=f,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var fT=new WeakMap;function mi(s,l){if(typeof s=="object"&&s!==null){var f=fT.get(s);return f!==void 0?f:(l={value:s,source:l,stack:Le(l)},fT.set(s,l),l)}return{value:s,source:l,stack:Le(l)}}var nu=[],ru=0,Cg=null,pf=0,vi=[],yi=0,eo=null,Ta=1,Aa="";function rs(s,l){nu[ru++]=pf,nu[ru++]=Cg,Cg=s,pf=l}function hT(s,l,f){vi[yi++]=Ta,vi[yi++]=Aa,vi[yi++]=eo,eo=s;var g=Ta;s=Aa;var x=32-sn(g)-1;g&=~(1<<x),f+=1;var E=32-sn(l)+x;if(30<E){var M=x-x%5;E=(g&(1<<M)-1).toString(32),g>>=M,x-=M,Ta=1<<32-sn(l)+x|f<<x|g,Aa=E+s}else Ta=1<<E|f<<x|g,Aa=s}function Oy(s){s.return!==null&&(rs(s,1),hT(s,1,0))}function jy(s){for(;s===Cg;)Cg=nu[--ru],nu[ru]=null,pf=nu[--ru],nu[ru]=null;for(;s===eo;)eo=vi[--yi],vi[yi]=null,Aa=vi[--yi],vi[yi]=null,Ta=vi[--yi],vi[yi]=null}function pT(s,l){vi[yi++]=Ta,vi[yi++]=Aa,vi[yi++]=eo,Ta=l.id,Aa=l.overflow,eo=s}var nr=null,Wt=null,Et=!1,to=null,bi=!1,Vy=Error(r(519));function no(s){var l=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw gf(mi(l,s)),Vy}function gT(s){var l=s.stateNode,f=s.type,g=s.memoizedProps;switch(l[Rn]=s,l[Qn]=g,f){case"dialog":yt("cancel",l),yt("close",l);break;case"iframe":case"object":case"embed":yt("load",l);break;case"video":case"audio":for(f=0;f<Vf.length;f++)yt(Vf[f],l);break;case"source":yt("error",l);break;case"img":case"image":case"link":yt("error",l),yt("load",l);break;case"details":yt("toggle",l);break;case"input":yt("invalid",l),sg(l,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":yt("invalid",l);break;case"textarea":yt("invalid",l),Ys(l,g.value,g.defaultValue,g.children)}f=g.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||l.textContent===""+f||g.suppressHydrationWarning===!0||NC(l.textContent,f)?(g.popover!=null&&(yt("beforetoggle",l),yt("toggle",l)),g.onScroll!=null&&yt("scroll",l),g.onScrollEnd!=null&&yt("scrollend",l),g.onClick!=null&&(l.onclick=Li),l=!0):l=!1,l||no(s,!0)}function mT(s){for(nr=s.return;nr;)switch(nr.tag){case 5:case 31:case 13:bi=!1;return;case 27:case 3:bi=!0;return;default:nr=nr.return}}function iu(s){if(s!==nr)return!1;if(!Et)return mT(s),Et=!0,!1;var l=s.tag,f;if((f=l!==3&&l!==27)&&((f=l===5)&&(f=s.type,f=!(f!=="form"&&f!=="button")||tx(s.type,s.memoizedProps)),f=!f),f&&Wt&&no(s),mT(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Wt=UC(s)}else if(l===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Wt=UC(s)}else l===27?(l=Wt,vo(s.type)?(s=sx,sx=null,Wt=s):Wt=l):Wt=nr?_i(s.stateNode.nextSibling):null;return!0}function Il(){Wt=nr=null,Et=!1}function zy(){var s=to;return s!==null&&(Vr===null?Vr=s:Vr.push.apply(Vr,s),to=null),s}function gf(s){to===null?to=[s]:to.push(s)}var Ly=G(null),Rl=null,is=null;function ro(s,l,f){re(Ly,l._currentValue),l._currentValue=f}function as(s){s._currentValue=Ly.current,Y(Ly)}function By(s,l,f){for(;s!==null;){var g=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),s===f)break;s=s.return}}function Uy(s,l,f,g){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var E=x.dependencies;if(E!==null){var M=x.child;E=E.firstContext;e:for(;E!==null;){var F=E;E=x;for(var Q=0;Q<l.length;Q++)if(F.context===l[Q]){E.lanes|=f,F=E.alternate,F!==null&&(F.lanes|=f),By(E.return,f,s),g||(M=null);break e}E=F.next}}else if(x.tag===18){if(M=x.return,M===null)throw Error(r(341));M.lanes|=f,E=M.alternate,E!==null&&(E.lanes|=f),By(M,f,s),M=null}else M=x.child;if(M!==null)M.return=x;else for(M=x;M!==null;){if(M===s){M=null;break}if(x=M.sibling,x!==null){x.return=M.return,M=x;break}M=M.return}x=M}}function au(s,l,f,g){s=null;for(var x=l,E=!1;x!==null;){if(!E){if((x.flags&524288)!==0)E=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var M=x.alternate;if(M===null)throw Error(r(387));if(M=M.memoizedProps,M!==null){var F=x.type;Qr(x.pendingProps.value,M.value)||(s!==null?s.push(F):s=[F])}}else if(x===be.current){if(M=x.alternate,M===null)throw Error(r(387));M.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(Ff):s=[Ff])}x=x.return}s!==null&&Uy(l,s,f,g),l.flags|=262144}function Ig(s){for(s=s.firstContext;s!==null;){if(!Qr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Dl(s){Rl=s,is=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function rr(s){return vT(Rl,s)}function Rg(s,l){return Rl===null&&Dl(s),vT(s,l)}function vT(s,l){var f=l._currentValue;if(l={context:l,memoizedValue:f,next:null},is===null){if(s===null)throw Error(r(308));is=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else is=is.next=l;return f}var J5=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(f,g){s.push(g)}};this.abort=function(){l.aborted=!0,s.forEach(function(f){return f()})}},eV=n.unstable_scheduleCallback,tV=n.unstable_NormalPriority,Nn={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Fy(){return{controller:new J5,data:new Map,refCount:0}}function mf(s){s.refCount--,s.refCount===0&&eV(tV,function(){s.controller.abort()})}var vf=null,Gy=0,su=0,ou=null;function nV(s,l){if(vf===null){var f=vf=[];Gy=0,su=Hb(),ou={status:"pending",value:void 0,then:function(g){f.push(g)}}}return Gy++,l.then(yT,yT),l}function yT(){if(--Gy===0&&vf!==null){ou!==null&&(ou.status="fulfilled");var s=vf;vf=null,su=0,ou=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function rV(s,l){var f=[],g={status:"pending",value:null,reason:null,then:function(x){f.push(x)}};return s.then(function(){g.status="fulfilled",g.value=l;for(var x=0;x<f.length;x++)(0,f[x])(l)},function(x){for(g.status="rejected",g.reason=x,x=0;x<f.length;x++)(0,f[x])(void 0)}),g}var bT=$.S;$.S=function(s,l){nC=ft(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&nV(s,l),bT!==null&&bT(s,l)};var kl=G(null);function qy(){var s=kl.current;return s!==null?s:Kt.pooledCache}function Dg(s,l){l===null?re(kl,kl.current):re(kl,l.pool)}function xT(){var s=qy();return s===null?null:{parent:Nn._currentValue,pool:s}}var lu=Error(r(460)),$y=Error(r(474)),kg=Error(r(542)),Ng={then:function(){}};function _T(s){return s=s.status,s==="fulfilled"||s==="rejected"}function wT(s,l,f){switch(f=s[f],f===void 0?s.push(l):f!==l&&(l.then(Li,Li),l=f),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,ST(s),s;default:if(typeof l.status=="string")l.then(Li,Li);else{if(s=Kt,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=l,s.status="pending",s.then(function(g){if(l.status==="pending"){var x=l;x.status="fulfilled",x.value=g}},function(g){if(l.status==="pending"){var x=l;x.status="rejected",x.reason=g}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,ST(s),s}throw Ml=l,lu}}function Nl(s){try{var l=s._init;return l(s._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(Ml=f,lu):f}}var Ml=null;function ET(){if(Ml===null)throw Error(r(459));var s=Ml;return Ml=null,s}function ST(s){if(s===lu||s===kg)throw Error(r(483))}var cu=null,yf=0;function Mg(s){var l=yf;return yf+=1,cu===null&&(cu=[]),wT(cu,s,l)}function bf(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function Pg(s,l){throw l.$$typeof===m?Error(r(525)):(s=Object.prototype.toString.call(l),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function TT(s){function l(ie,ne){if(s){var le=ie.deletions;le===null?(ie.deletions=[ne],ie.flags|=16):le.push(ne)}}function f(ie,ne){if(!s)return null;for(;ne!==null;)l(ie,ne),ne=ne.sibling;return null}function g(ie){for(var ne=new Map;ie!==null;)ie.key!==null?ne.set(ie.key,ie):ne.set(ie.index,ie),ie=ie.sibling;return ne}function x(ie,ne){return ie=ns(ie,ne),ie.index=0,ie.sibling=null,ie}function E(ie,ne,le){return ie.index=le,s?(le=ie.alternate,le!==null?(le=le.index,le<ne?(ie.flags|=67108866,ne):le):(ie.flags|=67108866,ne)):(ie.flags|=1048576,ne)}function M(ie){return s&&ie.alternate===null&&(ie.flags|=67108866),ie}function F(ie,ne,le,ye){return ne===null||ne.tag!==6?(ne=My(le,ie.mode,ye),ne.return=ie,ne):(ne=x(ne,le),ne.return=ie,ne)}function Q(ie,ne,le,ye){var Ye=le.type;return Ye===w?ve(ie,ne,le.props.children,ye,le.key):ne!==null&&(ne.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===I&&Nl(Ye)===ne.type)?(ne=x(ne,le.props),bf(ne,le),ne.return=ie,ne):(ne=Ag(le.type,le.key,le.props,null,ie.mode,ye),bf(ne,le),ne.return=ie,ne)}function ce(ie,ne,le,ye){return ne===null||ne.tag!==4||ne.stateNode.containerInfo!==le.containerInfo||ne.stateNode.implementation!==le.implementation?(ne=Py(le,ie.mode,ye),ne.return=ie,ne):(ne=x(ne,le.children||[]),ne.return=ie,ne)}function ve(ie,ne,le,ye,Ye){return ne===null||ne.tag!==7?(ne=Cl(le,ie.mode,ye,Ye),ne.return=ie,ne):(ne=x(ne,le),ne.return=ie,ne)}function xe(ie,ne,le){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return ne=My(""+ne,ie.mode,le),ne.return=ie,ne;if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case b:return le=Ag(ne.type,ne.key,ne.props,null,ie.mode,le),bf(le,ne),le.return=ie,le;case _:return ne=Py(ne,ie.mode,le),ne.return=ie,ne;case I:return ne=Nl(ne),xe(ie,ne,le)}if(H(ne)||B(ne))return ne=Cl(ne,ie.mode,le,null),ne.return=ie,ne;if(typeof ne.then=="function")return xe(ie,Mg(ne),le);if(ne.$$typeof===R)return xe(ie,Rg(ie,ne),le);Pg(ie,ne)}return null}function de(ie,ne,le,ye){var Ye=ne!==null?ne.key:null;if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return Ye!==null?null:F(ie,ne,""+le,ye);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case b:return le.key===Ye?Q(ie,ne,le,ye):null;case _:return le.key===Ye?ce(ie,ne,le,ye):null;case I:return le=Nl(le),de(ie,ne,le,ye)}if(H(le)||B(le))return Ye!==null?null:ve(ie,ne,le,ye,null);if(typeof le.then=="function")return de(ie,ne,Mg(le),ye);if(le.$$typeof===R)return de(ie,ne,Rg(ie,le),ye);Pg(ie,le)}return null}function ge(ie,ne,le,ye,Ye){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return ie=ie.get(le)||null,F(ne,ie,""+ye,Ye);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case b:return ie=ie.get(ye.key===null?le:ye.key)||null,Q(ne,ie,ye,Ye);case _:return ie=ie.get(ye.key===null?le:ye.key)||null,ce(ne,ie,ye,Ye);case I:return ye=Nl(ye),ge(ie,ne,le,ye,Ye)}if(H(ye)||B(ye))return ie=ie.get(le)||null,ve(ne,ie,ye,Ye,null);if(typeof ye.then=="function")return ge(ie,ne,le,Mg(ye),Ye);if(ye.$$typeof===R)return ge(ie,ne,le,Rg(ne,ye),Ye);Pg(ne,ye)}return null}function je(ie,ne,le,ye){for(var Ye=null,Rt=null,Ue=ne,ht=ne=0,xt=null;Ue!==null&&ht<le.length;ht++){Ue.index>ht?(xt=Ue,Ue=null):xt=Ue.sibling;var Dt=de(ie,Ue,le[ht],ye);if(Dt===null){Ue===null&&(Ue=xt);break}s&&Ue&&Dt.alternate===null&&l(ie,Ue),ne=E(Dt,ne,ht),Rt===null?Ye=Dt:Rt.sibling=Dt,Rt=Dt,Ue=xt}if(ht===le.length)return f(ie,Ue),Et&&rs(ie,ht),Ye;if(Ue===null){for(;ht<le.length;ht++)Ue=xe(ie,le[ht],ye),Ue!==null&&(ne=E(Ue,ne,ht),Rt===null?Ye=Ue:Rt.sibling=Ue,Rt=Ue);return Et&&rs(ie,ht),Ye}for(Ue=g(Ue);ht<le.length;ht++)xt=ge(Ue,ie,ht,le[ht],ye),xt!==null&&(s&&xt.alternate!==null&&Ue.delete(xt.key===null?ht:xt.key),ne=E(xt,ne,ht),Rt===null?Ye=xt:Rt.sibling=xt,Rt=xt);return s&&Ue.forEach(function(wo){return l(ie,wo)}),Et&&rs(ie,ht),Ye}function Qe(ie,ne,le,ye){if(le==null)throw Error(r(151));for(var Ye=null,Rt=null,Ue=ne,ht=ne=0,xt=null,Dt=le.next();Ue!==null&&!Dt.done;ht++,Dt=le.next()){Ue.index>ht?(xt=Ue,Ue=null):xt=Ue.sibling;var wo=de(ie,Ue,Dt.value,ye);if(wo===null){Ue===null&&(Ue=xt);break}s&&Ue&&wo.alternate===null&&l(ie,Ue),ne=E(wo,ne,ht),Rt===null?Ye=wo:Rt.sibling=wo,Rt=wo,Ue=xt}if(Dt.done)return f(ie,Ue),Et&&rs(ie,ht),Ye;if(Ue===null){for(;!Dt.done;ht++,Dt=le.next())Dt=xe(ie,Dt.value,ye),Dt!==null&&(ne=E(Dt,ne,ht),Rt===null?Ye=Dt:Rt.sibling=Dt,Rt=Dt);return Et&&rs(ie,ht),Ye}for(Ue=g(Ue);!Dt.done;ht++,Dt=le.next())Dt=ge(Ue,ie,ht,Dt.value,ye),Dt!==null&&(s&&Dt.alternate!==null&&Ue.delete(Dt.key===null?ht:Dt.key),ne=E(Dt,ne,ht),Rt===null?Ye=Dt:Rt.sibling=Dt,Rt=Dt);return s&&Ue.forEach(function(pz){return l(ie,pz)}),Et&&rs(ie,ht),Ye}function $t(ie,ne,le,ye){if(typeof le=="object"&&le!==null&&le.type===w&&le.key===null&&(le=le.props.children),typeof le=="object"&&le!==null){switch(le.$$typeof){case b:e:{for(var Ye=le.key;ne!==null;){if(ne.key===Ye){if(Ye=le.type,Ye===w){if(ne.tag===7){f(ie,ne.sibling),ye=x(ne,le.props.children),ye.return=ie,ie=ye;break e}}else if(ne.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===I&&Nl(Ye)===ne.type){f(ie,ne.sibling),ye=x(ne,le.props),bf(ye,le),ye.return=ie,ie=ye;break e}f(ie,ne);break}else l(ie,ne);ne=ne.sibling}le.type===w?(ye=Cl(le.props.children,ie.mode,ye,le.key),ye.return=ie,ie=ye):(ye=Ag(le.type,le.key,le.props,null,ie.mode,ye),bf(ye,le),ye.return=ie,ie=ye)}return M(ie);case _:e:{for(Ye=le.key;ne!==null;){if(ne.key===Ye)if(ne.tag===4&&ne.stateNode.containerInfo===le.containerInfo&&ne.stateNode.implementation===le.implementation){f(ie,ne.sibling),ye=x(ne,le.children||[]),ye.return=ie,ie=ye;break e}else{f(ie,ne);break}else l(ie,ne);ne=ne.sibling}ye=Py(le,ie.mode,ye),ye.return=ie,ie=ye}return M(ie);case I:return le=Nl(le),$t(ie,ne,le,ye)}if(H(le))return je(ie,ne,le,ye);if(B(le)){if(Ye=B(le),typeof Ye!="function")throw Error(r(150));return le=Ye.call(le),Qe(ie,ne,le,ye)}if(typeof le.then=="function")return $t(ie,ne,Mg(le),ye);if(le.$$typeof===R)return $t(ie,ne,Rg(ie,le),ye);Pg(ie,le)}return typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint"?(le=""+le,ne!==null&&ne.tag===6?(f(ie,ne.sibling),ye=x(ne,le),ye.return=ie,ie=ye):(f(ie,ne),ye=My(le,ie.mode,ye),ye.return=ie,ie=ye),M(ie)):f(ie,ne)}return function(ie,ne,le,ye){try{yf=0;var Ye=$t(ie,ne,le,ye);return cu=null,Ye}catch(Ue){if(Ue===lu||Ue===kg)throw Ue;var Rt=Zr(29,Ue,null,ie.mode);return Rt.lanes=ye,Rt.return=ie,Rt}finally{}}}var Pl=TT(!0),AT=TT(!1),io=!1;function Hy(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Yy(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function ao(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function so(s,l,f){var g=s.updateQueue;if(g===null)return null;if(g=g.shared,(Mt&2)!==0){var x=g.pending;return x===null?l.next=l:(l.next=x.next,x.next=l),g.pending=l,l=Tg(s),cT(s,null,f),l}return Sg(s,g,l,f),Tg(s)}function xf(s,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194048)!==0)){var g=l.lanes;g&=s.pendingLanes,f|=g,l.lanes=f,Hd(s,f)}}function Ky(s,l){var f=s.updateQueue,g=s.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var x=null,E=null;if(f=f.firstBaseUpdate,f!==null){do{var M={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};E===null?x=E=M:E=E.next=M,f=f.next}while(f!==null);E===null?x=E=l:E=E.next=l}else x=E=l;f={baseState:g.baseState,firstBaseUpdate:x,lastBaseUpdate:E,shared:g.shared,callbacks:g.callbacks},s.updateQueue=f;return}s=f.lastBaseUpdate,s===null?f.firstBaseUpdate=l:s.next=l,f.lastBaseUpdate=l}var Xy=!1;function _f(){if(Xy){var s=ou;if(s!==null)throw s}}function wf(s,l,f,g){Xy=!1;var x=s.updateQueue;io=!1;var E=x.firstBaseUpdate,M=x.lastBaseUpdate,F=x.shared.pending;if(F!==null){x.shared.pending=null;var Q=F,ce=Q.next;Q.next=null,M===null?E=ce:M.next=ce,M=Q;var ve=s.alternate;ve!==null&&(ve=ve.updateQueue,F=ve.lastBaseUpdate,F!==M&&(F===null?ve.firstBaseUpdate=ce:F.next=ce,ve.lastBaseUpdate=Q))}if(E!==null){var xe=x.baseState;M=0,ve=ce=Q=null,F=E;do{var de=F.lane&-536870913,ge=de!==F.lane;if(ge?(bt&de)===de:(g&de)===de){de!==0&&de===su&&(Xy=!0),ve!==null&&(ve=ve.next={lane:0,tag:F.tag,payload:F.payload,callback:null,next:null});e:{var je=s,Qe=F;de=l;var $t=f;switch(Qe.tag){case 1:if(je=Qe.payload,typeof je=="function"){xe=je.call($t,xe,de);break e}xe=je;break e;case 3:je.flags=je.flags&-65537|128;case 0:if(je=Qe.payload,de=typeof je=="function"?je.call($t,xe,de):je,de==null)break e;xe=p({},xe,de);break e;case 2:io=!0}}de=F.callback,de!==null&&(s.flags|=64,ge&&(s.flags|=8192),ge=x.callbacks,ge===null?x.callbacks=[de]:ge.push(de))}else ge={lane:de,tag:F.tag,payload:F.payload,callback:F.callback,next:null},ve===null?(ce=ve=ge,Q=xe):ve=ve.next=ge,M|=de;if(F=F.next,F===null){if(F=x.shared.pending,F===null)break;ge=F,F=ge.next,ge.next=null,x.lastBaseUpdate=ge,x.shared.pending=null}}while(!0);ve===null&&(Q=xe),x.baseState=Q,x.firstBaseUpdate=ce,x.lastBaseUpdate=ve,E===null&&(x.shared.lanes=0),fo|=M,s.lanes=M,s.memoizedState=xe}}function CT(s,l){if(typeof s!="function")throw Error(r(191,s));s.call(l)}function IT(s,l){var f=s.callbacks;if(f!==null)for(s.callbacks=null,s=0;s<f.length;s++)CT(f[s],l)}var uu=G(null),Og=G(0);function RT(s,l){s=ps,re(Og,s),re(uu,l),ps=s|l.baseLanes}function Wy(){re(Og,ps),re(uu,uu.current)}function Qy(){ps=Og.current,Y(uu),Y(Og)}var Jr=G(null),xi=null;function oo(s){var l=s.alternate;re(wn,wn.current&1),re(Jr,s),xi===null&&(l===null||uu.current!==null||l.memoizedState!==null)&&(xi=s)}function Zy(s){re(wn,wn.current),re(Jr,s),xi===null&&(xi=s)}function DT(s){s.tag===22?(re(wn,wn.current),re(Jr,s),xi===null&&(xi=s)):lo()}function lo(){re(wn,wn.current),re(Jr,Jr.current)}function ei(s){Y(Jr),xi===s&&(xi=null),Y(wn)}var wn=G(0);function jg(s){for(var l=s;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||ix(f)||ax(f)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var ss=0,ut=null,Gt=null,Mn=null,Vg=!1,du=!1,Ol=!1,zg=0,Ef=0,fu=null,iV=0;function gn(){throw Error(r(321))}function Jy(s,l){if(l===null)return!1;for(var f=0;f<l.length&&f<s.length;f++)if(!Qr(s[f],l[f]))return!1;return!0}function eb(s,l,f,g,x,E){return ss=E,ut=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,$.H=s===null||s.memoizedState===null?hA:gb,Ol=!1,E=f(g,x),Ol=!1,du&&(E=NT(l,f,g,x)),kT(s),E}function kT(s){$.H=Af;var l=Gt!==null&&Gt.next!==null;if(ss=0,Mn=Gt=ut=null,Vg=!1,Ef=0,fu=null,l)throw Error(r(300));s===null||Pn||(s=s.dependencies,s!==null&&Ig(s)&&(Pn=!0))}function NT(s,l,f,g){ut=s;var x=0;do{if(du&&(fu=null),Ef=0,du=!1,25<=x)throw Error(r(301));if(x+=1,Mn=Gt=null,s.updateQueue!=null){var E=s.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}$.H=pA,E=l(f,g)}while(du);return E}function aV(){var s=$.H,l=s.useState()[0];return l=typeof l.then=="function"?Sf(l):l,s=s.useState()[0],(Gt!==null?Gt.memoizedState:null)!==s&&(ut.flags|=1024),l}function tb(){var s=zg!==0;return zg=0,s}function nb(s,l,f){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~f}function rb(s){if(Vg){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}Vg=!1}ss=0,Mn=Gt=ut=null,du=!1,Ef=zg=0,fu=null}function Er(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mn===null?ut.memoizedState=Mn=s:Mn=Mn.next=s,Mn}function En(){if(Gt===null){var s=ut.alternate;s=s!==null?s.memoizedState:null}else s=Gt.next;var l=Mn===null?ut.memoizedState:Mn.next;if(l!==null)Mn=l,Gt=s;else{if(s===null)throw ut.alternate===null?Error(r(467)):Error(r(310));Gt=s,s={memoizedState:Gt.memoizedState,baseState:Gt.baseState,baseQueue:Gt.baseQueue,queue:Gt.queue,next:null},Mn===null?ut.memoizedState=Mn=s:Mn=Mn.next=s}return Mn}function Lg(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Sf(s){var l=Ef;return Ef+=1,fu===null&&(fu=[]),s=wT(fu,s,l),l=ut,(Mn===null?l.memoizedState:Mn.next)===null&&(l=l.alternate,$.H=l===null||l.memoizedState===null?hA:gb),s}function Bg(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Sf(s);if(s.$$typeof===R)return rr(s)}throw Error(r(438,String(s)))}function ib(s){var l=null,f=ut.updateQueue;if(f!==null&&(l=f.memoCache),l==null){var g=ut.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(l={data:g.data.map(function(x){return x.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),f===null&&(f=Lg(),ut.updateQueue=f),f.memoCache=l,f=l.data[l.index],f===void 0)for(f=l.data[l.index]=Array(s),g=0;g<s;g++)f[g]=z;return l.index++,f}function os(s,l){return typeof l=="function"?l(s):l}function Ug(s){var l=En();return ab(l,Gt,s)}function ab(s,l,f){var g=s.queue;if(g===null)throw Error(r(311));g.lastRenderedReducer=f;var x=s.baseQueue,E=g.pending;if(E!==null){if(x!==null){var M=x.next;x.next=E.next,E.next=M}l.baseQueue=x=E,g.pending=null}if(E=s.baseState,x===null)s.memoizedState=E;else{l=x.next;var F=M=null,Q=null,ce=l,ve=!1;do{var xe=ce.lane&-536870913;if(xe!==ce.lane?(bt&xe)===xe:(ss&xe)===xe){var de=ce.revertLane;if(de===0)Q!==null&&(Q=Q.next={lane:0,revertLane:0,gesture:null,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null}),xe===su&&(ve=!0);else if((ss&de)===de){ce=ce.next,de===su&&(ve=!0);continue}else xe={lane:0,revertLane:ce.revertLane,gesture:null,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null},Q===null?(F=Q=xe,M=E):Q=Q.next=xe,ut.lanes|=de,fo|=de;xe=ce.action,Ol&&f(E,xe),E=ce.hasEagerState?ce.eagerState:f(E,xe)}else de={lane:xe,revertLane:ce.revertLane,gesture:ce.gesture,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null},Q===null?(F=Q=de,M=E):Q=Q.next=de,ut.lanes|=xe,fo|=xe;ce=ce.next}while(ce!==null&&ce!==l);if(Q===null?M=E:Q.next=F,!Qr(E,s.memoizedState)&&(Pn=!0,ve&&(f=ou,f!==null)))throw f;s.memoizedState=E,s.baseState=M,s.baseQueue=Q,g.lastRenderedState=E}return x===null&&(g.lanes=0),[s.memoizedState,g.dispatch]}function sb(s){var l=En(),f=l.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=s;var g=f.dispatch,x=f.pending,E=l.memoizedState;if(x!==null){f.pending=null;var M=x=x.next;do E=s(E,M.action),M=M.next;while(M!==x);Qr(E,l.memoizedState)||(Pn=!0),l.memoizedState=E,l.baseQueue===null&&(l.baseState=E),f.lastRenderedState=E}return[E,g]}function MT(s,l,f){var g=ut,x=En(),E=Et;if(E){if(f===void 0)throw Error(r(407));f=f()}else f=l();var M=!Qr((Gt||x).memoizedState,f);if(M&&(x.memoizedState=f,Pn=!0),x=x.queue,cb(jT.bind(null,g,x,s),[s]),x.getSnapshot!==l||M||Mn!==null&&Mn.memoizedState.tag&1){if(g.flags|=2048,hu(9,{destroy:void 0},OT.bind(null,g,x,f,l),null),Kt===null)throw Error(r(349));E||(ss&127)!==0||PT(g,l,f)}return f}function PT(s,l,f){s.flags|=16384,s={getSnapshot:l,value:f},l=ut.updateQueue,l===null?(l=Lg(),ut.updateQueue=l,l.stores=[s]):(f=l.stores,f===null?l.stores=[s]:f.push(s))}function OT(s,l,f,g){l.value=f,l.getSnapshot=g,VT(l)&&zT(s)}function jT(s,l,f){return f(function(){VT(l)&&zT(s)})}function VT(s){var l=s.getSnapshot;s=s.value;try{var f=l();return!Qr(s,f)}catch{return!0}}function zT(s){var l=Al(s,2);l!==null&&zr(l,s,2)}function ob(s){var l=Er();if(typeof s=="function"){var f=s;if(s=f(),Ol){dr(!0);try{f()}finally{dr(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:os,lastRenderedState:s},l}function LT(s,l,f,g){return s.baseState=f,ab(s,Gt,typeof g=="function"?g:os)}function sV(s,l,f,g,x){if(qg(s))throw Error(r(485));if(s=l.action,s!==null){var E={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(M){E.listeners.push(M)}};$.T!==null?f(!0):E.isTransition=!1,g(E),f=l.pending,f===null?(E.next=l.pending=E,BT(l,E)):(E.next=f.next,l.pending=f.next=E)}}function BT(s,l){var f=l.action,g=l.payload,x=s.state;if(l.isTransition){var E=$.T,M={};$.T=M;try{var F=f(x,g),Q=$.S;Q!==null&&Q(M,F),UT(s,l,F)}catch(ce){lb(s,l,ce)}finally{E!==null&&M.types!==null&&(E.types=M.types),$.T=E}}else try{E=f(x,g),UT(s,l,E)}catch(ce){lb(s,l,ce)}}function UT(s,l,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(g){FT(s,l,g)},function(g){return lb(s,l,g)}):FT(s,l,f)}function FT(s,l,f){l.status="fulfilled",l.value=f,GT(l),s.state=f,l=s.pending,l!==null&&(f=l.next,f===l?s.pending=null:(f=f.next,l.next=f,BT(s,f)))}function lb(s,l,f){var g=s.pending;if(s.pending=null,g!==null){g=g.next;do l.status="rejected",l.reason=f,GT(l),l=l.next;while(l!==g)}s.action=null}function GT(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function qT(s,l){return l}function $T(s,l){if(Et){var f=Kt.formState;if(f!==null){e:{var g=ut;if(Et){if(Wt){t:{for(var x=Wt,E=bi;x.nodeType!==8;){if(!E){x=null;break t}if(x=_i(x.nextSibling),x===null){x=null;break t}}E=x.data,x=E==="F!"||E==="F"?x:null}if(x){Wt=_i(x.nextSibling),g=x.data==="F!";break e}}no(g)}g=!1}g&&(l=f[0])}}return f=Er(),f.memoizedState=f.baseState=l,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qT,lastRenderedState:l},f.queue=g,f=uA.bind(null,ut,g),g.dispatch=f,g=ob(!1),E=pb.bind(null,ut,!1,g.queue),g=Er(),x={state:l,dispatch:null,action:s,pending:null},g.queue=x,f=sV.bind(null,ut,x,E,f),x.dispatch=f,g.memoizedState=s,[l,f,!1]}function HT(s){var l=En();return YT(l,Gt,s)}function YT(s,l,f){if(l=ab(s,l,qT)[0],s=Ug(os)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var g=Sf(l)}catch(M){throw M===lu?kg:M}else g=l;l=En();var x=l.queue,E=x.dispatch;return f!==l.memoizedState&&(ut.flags|=2048,hu(9,{destroy:void 0},oV.bind(null,x,f),null)),[g,E,s]}function oV(s,l){s.action=l}function KT(s){var l=En(),f=Gt;if(f!==null)return YT(l,f,s);En(),l=l.memoizedState,f=En();var g=f.queue.dispatch;return f.memoizedState=s,[l,g,!1]}function hu(s,l,f,g){return s={tag:s,create:f,deps:g,inst:l,next:null},l=ut.updateQueue,l===null&&(l=Lg(),ut.updateQueue=l),f=l.lastEffect,f===null?l.lastEffect=s.next=s:(g=f.next,f.next=s,s.next=g,l.lastEffect=s),s}function XT(){return En().memoizedState}function Fg(s,l,f,g){var x=Er();ut.flags|=s,x.memoizedState=hu(1|l,{destroy:void 0},f,g===void 0?null:g)}function Gg(s,l,f,g){var x=En();g=g===void 0?null:g;var E=x.memoizedState.inst;Gt!==null&&g!==null&&Jy(g,Gt.memoizedState.deps)?x.memoizedState=hu(l,E,f,g):(ut.flags|=s,x.memoizedState=hu(1|l,E,f,g))}function WT(s,l){Fg(8390656,8,s,l)}function cb(s,l){Gg(2048,8,s,l)}function lV(s){ut.flags|=4;var l=ut.updateQueue;if(l===null)l=Lg(),ut.updateQueue=l,l.events=[s];else{var f=l.events;f===null?l.events=[s]:f.push(s)}}function QT(s){var l=En().memoizedState;return lV({ref:l,nextImpl:s}),function(){if((Mt&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}function ZT(s,l){return Gg(4,2,s,l)}function JT(s,l){return Gg(4,4,s,l)}function eA(s,l){if(typeof l=="function"){s=s();var f=l(s);return function(){typeof f=="function"?f():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function tA(s,l,f){f=f!=null?f.concat([s]):null,Gg(4,4,eA.bind(null,l,s),f)}function ub(){}function nA(s,l){var f=En();l=l===void 0?null:l;var g=f.memoizedState;return l!==null&&Jy(l,g[1])?g[0]:(f.memoizedState=[s,l],s)}function rA(s,l){var f=En();l=l===void 0?null:l;var g=f.memoizedState;if(l!==null&&Jy(l,g[1]))return g[0];if(g=s(),Ol){dr(!0);try{s()}finally{dr(!1)}}return f.memoizedState=[g,l],g}function db(s,l,f){return f===void 0||(ss&1073741824)!==0&&(bt&261930)===0?s.memoizedState=l:(s.memoizedState=f,s=iC(),ut.lanes|=s,fo|=s,f)}function iA(s,l,f,g){return Qr(f,l)?f:uu.current!==null?(s=db(s,f,g),Qr(s,l)||(Pn=!0),s):(ss&42)===0||(ss&1073741824)!==0&&(bt&261930)===0?(Pn=!0,s.memoizedState=f):(s=iC(),ut.lanes|=s,fo|=s,l)}function aA(s,l,f,g,x){var E=W.p;W.p=E!==0&&8>E?E:8;var M=$.T,F={};$.T=F,pb(s,!1,l,f);try{var Q=x(),ce=$.S;if(ce!==null&&ce(F,Q),Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var ve=rV(Q,g);Tf(s,l,ve,ri(s))}else Tf(s,l,g,ri(s))}catch(xe){Tf(s,l,{then:function(){},status:"rejected",reason:xe},ri())}finally{W.p=E,M!==null&&F.types!==null&&(M.types=F.types),$.T=M}}function cV(){}function fb(s,l,f,g){if(s.tag!==5)throw Error(r(476));var x=sA(s).queue;aA(s,x,l,ee,f===null?cV:function(){return oA(s),f(g)})}function sA(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:ee,baseState:ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:os,lastRenderedState:ee},next:null};var f={};return l.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:os,lastRenderedState:f},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function oA(s){var l=sA(s);l.next===null&&(l=s.alternate.memoizedState),Tf(s,l.next.queue,{},ri())}function hb(){return rr(Ff)}function lA(){return En().memoizedState}function cA(){return En().memoizedState}function uV(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var f=ri();s=ao(f);var g=so(l,s,f);g!==null&&(zr(g,l,f),xf(g,l,f)),l={cache:Fy()},s.payload=l;return}l=l.return}}function dV(s,l,f){var g=ri();f={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},qg(s)?dA(l,f):(f=ky(s,l,f,g),f!==null&&(zr(f,s,g),fA(f,l,g)))}function uA(s,l,f){var g=ri();Tf(s,l,f,g)}function Tf(s,l,f,g){var x={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(qg(s))dA(l,x);else{var E=s.alternate;if(s.lanes===0&&(E===null||E.lanes===0)&&(E=l.lastRenderedReducer,E!==null))try{var M=l.lastRenderedState,F=E(M,f);if(x.hasEagerState=!0,x.eagerState=F,Qr(F,M))return Sg(s,l,x,0),Kt===null&&Eg(),!1}catch{}finally{}if(f=ky(s,l,x,g),f!==null)return zr(f,s,g),fA(f,l,g),!0}return!1}function pb(s,l,f,g){if(g={lane:2,revertLane:Hb(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},qg(s)){if(l)throw Error(r(479))}else l=ky(s,f,g,2),l!==null&&zr(l,s,2)}function qg(s){var l=s.alternate;return s===ut||l!==null&&l===ut}function dA(s,l){du=Vg=!0;var f=s.pending;f===null?l.next=l:(l.next=f.next,f.next=l),s.pending=l}function fA(s,l,f){if((f&4194048)!==0){var g=l.lanes;g&=s.pendingLanes,f|=g,l.lanes=f,Hd(s,f)}}var Af={readContext:rr,use:Bg,useCallback:gn,useContext:gn,useEffect:gn,useImperativeHandle:gn,useLayoutEffect:gn,useInsertionEffect:gn,useMemo:gn,useReducer:gn,useRef:gn,useState:gn,useDebugValue:gn,useDeferredValue:gn,useTransition:gn,useSyncExternalStore:gn,useId:gn,useHostTransitionStatus:gn,useFormState:gn,useActionState:gn,useOptimistic:gn,useMemoCache:gn,useCacheRefresh:gn};Af.useEffectEvent=gn;var hA={readContext:rr,use:Bg,useCallback:function(s,l){return Er().memoizedState=[s,l===void 0?null:l],s},useContext:rr,useEffect:WT,useImperativeHandle:function(s,l,f){f=f!=null?f.concat([s]):null,Fg(4194308,4,eA.bind(null,l,s),f)},useLayoutEffect:function(s,l){return Fg(4194308,4,s,l)},useInsertionEffect:function(s,l){Fg(4,2,s,l)},useMemo:function(s,l){var f=Er();l=l===void 0?null:l;var g=s();if(Ol){dr(!0);try{s()}finally{dr(!1)}}return f.memoizedState=[g,l],g},useReducer:function(s,l,f){var g=Er();if(f!==void 0){var x=f(l);if(Ol){dr(!0);try{f(l)}finally{dr(!1)}}}else x=l;return g.memoizedState=g.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},g.queue=s,s=s.dispatch=dV.bind(null,ut,s),[g.memoizedState,s]},useRef:function(s){var l=Er();return s={current:s},l.memoizedState=s},useState:function(s){s=ob(s);var l=s.queue,f=uA.bind(null,ut,l);return l.dispatch=f,[s.memoizedState,f]},useDebugValue:ub,useDeferredValue:function(s,l){var f=Er();return db(f,s,l)},useTransition:function(){var s=ob(!1);return s=aA.bind(null,ut,s.queue,!0,!1),Er().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,f){var g=ut,x=Er();if(Et){if(f===void 0)throw Error(r(407));f=f()}else{if(f=l(),Kt===null)throw Error(r(349));(bt&127)!==0||PT(g,l,f)}x.memoizedState=f;var E={value:f,getSnapshot:l};return x.queue=E,WT(jT.bind(null,g,E,s),[s]),g.flags|=2048,hu(9,{destroy:void 0},OT.bind(null,g,E,f,l),null),f},useId:function(){var s=Er(),l=Kt.identifierPrefix;if(Et){var f=Aa,g=Ta;f=(g&~(1<<32-sn(g)-1)).toString(32)+f,l="_"+l+"R_"+f,f=zg++,0<f&&(l+="H"+f.toString(32)),l+="_"}else f=iV++,l="_"+l+"r_"+f.toString(32)+"_";return s.memoizedState=l},useHostTransitionStatus:hb,useFormState:$T,useActionState:$T,useOptimistic:function(s){var l=Er();l.memoizedState=l.baseState=s;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=f,l=pb.bind(null,ut,!0,f),f.dispatch=l,[s,l]},useMemoCache:ib,useCacheRefresh:function(){return Er().memoizedState=uV.bind(null,ut)},useEffectEvent:function(s){var l=Er(),f={impl:s};return l.memoizedState=f,function(){if((Mt&2)!==0)throw Error(r(440));return f.impl.apply(void 0,arguments)}}},gb={readContext:rr,use:Bg,useCallback:nA,useContext:rr,useEffect:cb,useImperativeHandle:tA,useInsertionEffect:ZT,useLayoutEffect:JT,useMemo:rA,useReducer:Ug,useRef:XT,useState:function(){return Ug(os)},useDebugValue:ub,useDeferredValue:function(s,l){var f=En();return iA(f,Gt.memoizedState,s,l)},useTransition:function(){var s=Ug(os)[0],l=En().memoizedState;return[typeof s=="boolean"?s:Sf(s),l]},useSyncExternalStore:MT,useId:lA,useHostTransitionStatus:hb,useFormState:HT,useActionState:HT,useOptimistic:function(s,l){var f=En();return LT(f,Gt,s,l)},useMemoCache:ib,useCacheRefresh:cA};gb.useEffectEvent=QT;var pA={readContext:rr,use:Bg,useCallback:nA,useContext:rr,useEffect:cb,useImperativeHandle:tA,useInsertionEffect:ZT,useLayoutEffect:JT,useMemo:rA,useReducer:sb,useRef:XT,useState:function(){return sb(os)},useDebugValue:ub,useDeferredValue:function(s,l){var f=En();return Gt===null?db(f,s,l):iA(f,Gt.memoizedState,s,l)},useTransition:function(){var s=sb(os)[0],l=En().memoizedState;return[typeof s=="boolean"?s:Sf(s),l]},useSyncExternalStore:MT,useId:lA,useHostTransitionStatus:hb,useFormState:KT,useActionState:KT,useOptimistic:function(s,l){var f=En();return Gt!==null?LT(f,Gt,s,l):(f.baseState=s,[s,f.queue.dispatch])},useMemoCache:ib,useCacheRefresh:cA};pA.useEffectEvent=QT;function mb(s,l,f,g){l=s.memoizedState,f=f(g,l),f=f==null?l:p({},l,f),s.memoizedState=f,s.lanes===0&&(s.updateQueue.baseState=f)}var vb={enqueueSetState:function(s,l,f){s=s._reactInternals;var g=ri(),x=ao(g);x.payload=l,f!=null&&(x.callback=f),l=so(s,x,g),l!==null&&(zr(l,s,g),xf(l,s,g))},enqueueReplaceState:function(s,l,f){s=s._reactInternals;var g=ri(),x=ao(g);x.tag=1,x.payload=l,f!=null&&(x.callback=f),l=so(s,x,g),l!==null&&(zr(l,s,g),xf(l,s,g))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var f=ri(),g=ao(f);g.tag=2,l!=null&&(g.callback=l),l=so(s,g,f),l!==null&&(zr(l,s,f),xf(l,s,f))}};function gA(s,l,f,g,x,E,M){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(g,E,M):l.prototype&&l.prototype.isPureReactComponent?!ff(f,g)||!ff(x,E):!0}function mA(s,l,f,g){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,g),l.state!==s&&vb.enqueueReplaceState(l,l.state,null)}function jl(s,l){var f=l;if("ref"in l){f={};for(var g in l)g!=="ref"&&(f[g]=l[g])}if(s=s.defaultProps){f===l&&(f=p({},f));for(var x in s)f[x]===void 0&&(f[x]=s[x])}return f}function vA(s){wg(s)}function yA(s){console.error(s)}function bA(s){wg(s)}function $g(s,l){try{var f=s.onUncaughtError;f(l.value,{componentStack:l.stack})}catch(g){setTimeout(function(){throw g})}}function xA(s,l,f){try{var g=s.onCaughtError;g(f.value,{componentStack:f.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function yb(s,l,f){return f=ao(f),f.tag=3,f.payload={element:null},f.callback=function(){$g(s,l)},f}function _A(s){return s=ao(s),s.tag=3,s}function wA(s,l,f,g){var x=f.type.getDerivedStateFromError;if(typeof x=="function"){var E=g.value;s.payload=function(){return x(E)},s.callback=function(){xA(l,f,g)}}var M=f.stateNode;M!==null&&typeof M.componentDidCatch=="function"&&(s.callback=function(){xA(l,f,g),typeof x!="function"&&(ho===null?ho=new Set([this]):ho.add(this));var F=g.stack;this.componentDidCatch(g.value,{componentStack:F!==null?F:""})})}function fV(s,l,f,g,x){if(f.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(l=f.alternate,l!==null&&au(l,f,x,!0),f=Jr.current,f!==null){switch(f.tag){case 31:case 13:return xi===null?rm():f.alternate===null&&mn===0&&(mn=3),f.flags&=-257,f.flags|=65536,f.lanes=x,g===Ng?f.flags|=16384:(l=f.updateQueue,l===null?f.updateQueue=new Set([g]):l.add(g),Gb(s,g,x)),!1;case 22:return f.flags|=65536,g===Ng?f.flags|=16384:(l=f.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([g])},f.updateQueue=l):(f=l.retryQueue,f===null?l.retryQueue=new Set([g]):f.add(g)),Gb(s,g,x)),!1}throw Error(r(435,f.tag))}return Gb(s,g,x),rm(),!1}if(Et)return l=Jr.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=x,g!==Vy&&(s=Error(r(422),{cause:g}),gf(mi(s,f)))):(g!==Vy&&(l=Error(r(423),{cause:g}),gf(mi(l,f))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,g=mi(g,f),x=yb(s.stateNode,g,x),Ky(s,x),mn!==4&&(mn=2)),!1;var E=Error(r(520),{cause:g});if(E=mi(E,f),Pf===null?Pf=[E]:Pf.push(E),mn!==4&&(mn=2),l===null)return!0;g=mi(g,f),f=l;do{switch(f.tag){case 3:return f.flags|=65536,s=x&-x,f.lanes|=s,s=yb(f.stateNode,g,s),Ky(f,s),!1;case 1:if(l=f.type,E=f.stateNode,(f.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(ho===null||!ho.has(E))))return f.flags|=65536,x&=-x,f.lanes|=x,x=_A(x),wA(x,s,f,g),Ky(f,x),!1}f=f.return}while(f!==null);return!1}var bb=Error(r(461)),Pn=!1;function ir(s,l,f,g){l.child=s===null?AT(l,null,f,g):Pl(l,s.child,f,g)}function EA(s,l,f,g,x){f=f.render;var E=l.ref;if("ref"in g){var M={};for(var F in g)F!=="ref"&&(M[F]=g[F])}else M=g;return Dl(l),g=eb(s,l,f,M,E,x),F=tb(),s!==null&&!Pn?(nb(s,l,x),ls(s,l,x)):(Et&&F&&Oy(l),l.flags|=1,ir(s,l,g,x),l.child)}function SA(s,l,f,g,x){if(s===null){var E=f.type;return typeof E=="function"&&!Ny(E)&&E.defaultProps===void 0&&f.compare===null?(l.tag=15,l.type=E,TA(s,l,E,g,x)):(s=Ag(f.type,null,g,l,l.mode,x),s.ref=l.ref,s.return=l,l.child=s)}if(E=s.child,!Cb(s,x)){var M=E.memoizedProps;if(f=f.compare,f=f!==null?f:ff,f(M,g)&&s.ref===l.ref)return ls(s,l,x)}return l.flags|=1,s=ns(E,g),s.ref=l.ref,s.return=l,l.child=s}function TA(s,l,f,g,x){if(s!==null){var E=s.memoizedProps;if(ff(E,g)&&s.ref===l.ref)if(Pn=!1,l.pendingProps=g=E,Cb(s,x))(s.flags&131072)!==0&&(Pn=!0);else return l.lanes=s.lanes,ls(s,l,x)}return xb(s,l,f,g,x)}function AA(s,l,f,g){var x=g.children,E=s!==null?s.memoizedState:null;if(s===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((l.flags&128)!==0){if(E=E!==null?E.baseLanes|f:f,s!==null){for(g=l.child=s.child,x=0;g!==null;)x=x|g.lanes|g.childLanes,g=g.sibling;g=x&~E}else g=0,l.child=null;return CA(s,l,E,f,g)}if((f&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&Dg(l,E!==null?E.cachePool:null),E!==null?RT(l,E):Wy(),DT(l);else return g=l.lanes=536870912,CA(s,l,E!==null?E.baseLanes|f:f,f,g)}else E!==null?(Dg(l,E.cachePool),RT(l,E),lo(),l.memoizedState=null):(s!==null&&Dg(l,null),Wy(),lo());return ir(s,l,x,f),l.child}function Cf(s,l){return s!==null&&s.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function CA(s,l,f,g,x){var E=qy();return E=E===null?null:{parent:Nn._currentValue,pool:E},l.memoizedState={baseLanes:f,cachePool:E},s!==null&&Dg(l,null),Wy(),DT(l),s!==null&&au(s,l,g,!0),l.childLanes=x,null}function Hg(s,l){return l=Kg({mode:l.mode,children:l.children},s.mode),l.ref=s.ref,s.child=l,l.return=s,l}function IA(s,l,f){return Pl(l,s.child,null,f),s=Hg(l,l.pendingProps),s.flags|=2,ei(l),l.memoizedState=null,s}function hV(s,l,f){var g=l.pendingProps,x=(l.flags&128)!==0;if(l.flags&=-129,s===null){if(Et){if(g.mode==="hidden")return s=Hg(l,g),l.lanes=536870912,Cf(null,s);if(Zy(l),(s=Wt)?(s=BC(s,bi),s=s!==null&&s.data==="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:eo!==null?{id:Ta,overflow:Aa}:null,retryLane:536870912,hydrationErrors:null},f=dT(s),f.return=l,l.child=f,nr=l,Wt=null)):s=null,s===null)throw no(l);return l.lanes=536870912,null}return Hg(l,g)}var E=s.memoizedState;if(E!==null){var M=E.dehydrated;if(Zy(l),x)if(l.flags&256)l.flags&=-257,l=IA(s,l,f);else if(l.memoizedState!==null)l.child=s.child,l.flags|=128,l=null;else throw Error(r(558));else if(Pn||au(s,l,f,!1),x=(f&s.childLanes)!==0,Pn||x){if(g=Kt,g!==null&&(M=Yd(g,f),M!==0&&M!==E.retryLane))throw E.retryLane=M,Al(s,M),zr(g,s,M),bb;rm(),l=IA(s,l,f)}else s=E.treeContext,Wt=_i(M.nextSibling),nr=l,Et=!0,to=null,bi=!1,s!==null&&pT(l,s),l=Hg(l,g),l.flags|=4096;return l}return s=ns(s.child,{mode:g.mode,children:g.children}),s.ref=l.ref,l.child=s,s.return=l,s}function Yg(s,l){var f=l.ref;if(f===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(r(284));(s===null||s.ref!==f)&&(l.flags|=4194816)}}function xb(s,l,f,g,x){return Dl(l),f=eb(s,l,f,g,void 0,x),g=tb(),s!==null&&!Pn?(nb(s,l,x),ls(s,l,x)):(Et&&g&&Oy(l),l.flags|=1,ir(s,l,f,x),l.child)}function RA(s,l,f,g,x,E){return Dl(l),l.updateQueue=null,f=NT(l,g,f,x),kT(s),g=tb(),s!==null&&!Pn?(nb(s,l,E),ls(s,l,E)):(Et&&g&&Oy(l),l.flags|=1,ir(s,l,f,E),l.child)}function DA(s,l,f,g,x){if(Dl(l),l.stateNode===null){var E=tu,M=f.contextType;typeof M=="object"&&M!==null&&(E=rr(M)),E=new f(g,E),l.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=vb,l.stateNode=E,E._reactInternals=l,E=l.stateNode,E.props=g,E.state=l.memoizedState,E.refs={},Hy(l),M=f.contextType,E.context=typeof M=="object"&&M!==null?rr(M):tu,E.state=l.memoizedState,M=f.getDerivedStateFromProps,typeof M=="function"&&(mb(l,f,M,g),E.state=l.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(M=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),M!==E.state&&vb.enqueueReplaceState(E,E.state,null),wf(l,g,E,x),_f(),E.state=l.memoizedState),typeof E.componentDidMount=="function"&&(l.flags|=4194308),g=!0}else if(s===null){E=l.stateNode;var F=l.memoizedProps,Q=jl(f,F);E.props=Q;var ce=E.context,ve=f.contextType;M=tu,typeof ve=="object"&&ve!==null&&(M=rr(ve));var xe=f.getDerivedStateFromProps;ve=typeof xe=="function"||typeof E.getSnapshotBeforeUpdate=="function",F=l.pendingProps!==F,ve||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(F||ce!==M)&&mA(l,E,g,M),io=!1;var de=l.memoizedState;E.state=de,wf(l,g,E,x),_f(),ce=l.memoizedState,F||de!==ce||io?(typeof xe=="function"&&(mb(l,f,xe,g),ce=l.memoizedState),(Q=io||gA(l,f,Q,g,de,ce,M))?(ve||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(l.flags|=4194308)):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=ce),E.props=g,E.state=ce,E.context=M,g=Q):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{E=l.stateNode,Yy(s,l),M=l.memoizedProps,ve=jl(f,M),E.props=ve,xe=l.pendingProps,de=E.context,ce=f.contextType,Q=tu,typeof ce=="object"&&ce!==null&&(Q=rr(ce)),F=f.getDerivedStateFromProps,(ce=typeof F=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(M!==xe||de!==Q)&&mA(l,E,g,Q),io=!1,de=l.memoizedState,E.state=de,wf(l,g,E,x),_f();var ge=l.memoizedState;M!==xe||de!==ge||io||s!==null&&s.dependencies!==null&&Ig(s.dependencies)?(typeof F=="function"&&(mb(l,f,F,g),ge=l.memoizedState),(ve=io||gA(l,f,ve,g,de,ge,Q)||s!==null&&s.dependencies!==null&&Ig(s.dependencies))?(ce||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(g,ge,Q),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(g,ge,Q)),typeof E.componentDidUpdate=="function"&&(l.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof E.componentDidUpdate!="function"||M===s.memoizedProps&&de===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||M===s.memoizedProps&&de===s.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=ge),E.props=g,E.state=ge,E.context=Q,g=ve):(typeof E.componentDidUpdate!="function"||M===s.memoizedProps&&de===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||M===s.memoizedProps&&de===s.memoizedState||(l.flags|=1024),g=!1)}return E=g,Yg(s,l),g=(l.flags&128)!==0,E||g?(E=l.stateNode,f=g&&typeof f.getDerivedStateFromError!="function"?null:E.render(),l.flags|=1,s!==null&&g?(l.child=Pl(l,s.child,null,x),l.child=Pl(l,null,f,x)):ir(s,l,f,x),l.memoizedState=E.state,s=l.child):s=ls(s,l,x),s}function kA(s,l,f,g){return Il(),l.flags|=256,ir(s,l,f,g),l.child}var _b={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function wb(s){return{baseLanes:s,cachePool:xT()}}function Eb(s,l,f){return s=s!==null?s.childLanes&~f:0,l&&(s|=ni),s}function NA(s,l,f){var g=l.pendingProps,x=!1,E=(l.flags&128)!==0,M;if((M=E)||(M=s!==null&&s.memoizedState===null?!1:(wn.current&2)!==0),M&&(x=!0,l.flags&=-129),M=(l.flags&32)!==0,l.flags&=-33,s===null){if(Et){if(x?oo(l):lo(),(s=Wt)?(s=BC(s,bi),s=s!==null&&s.data!=="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:eo!==null?{id:Ta,overflow:Aa}:null,retryLane:536870912,hydrationErrors:null},f=dT(s),f.return=l,l.child=f,nr=l,Wt=null)):s=null,s===null)throw no(l);return ax(s)?l.lanes=32:l.lanes=536870912,null}var F=g.children;return g=g.fallback,x?(lo(),x=l.mode,F=Kg({mode:"hidden",children:F},x),g=Cl(g,x,f,null),F.return=l,g.return=l,F.sibling=g,l.child=F,g=l.child,g.memoizedState=wb(f),g.childLanes=Eb(s,M,f),l.memoizedState=_b,Cf(null,g)):(oo(l),Sb(l,F))}var Q=s.memoizedState;if(Q!==null&&(F=Q.dehydrated,F!==null)){if(E)l.flags&256?(oo(l),l.flags&=-257,l=Tb(s,l,f)):l.memoizedState!==null?(lo(),l.child=s.child,l.flags|=128,l=null):(lo(),F=g.fallback,x=l.mode,g=Kg({mode:"visible",children:g.children},x),F=Cl(F,x,f,null),F.flags|=2,g.return=l,F.return=l,g.sibling=F,l.child=g,Pl(l,s.child,null,f),g=l.child,g.memoizedState=wb(f),g.childLanes=Eb(s,M,f),l.memoizedState=_b,l=Cf(null,g));else if(oo(l),ax(F)){if(M=F.nextSibling&&F.nextSibling.dataset,M)var ce=M.dgst;M=ce,g=Error(r(419)),g.stack="",g.digest=M,gf({value:g,source:null,stack:null}),l=Tb(s,l,f)}else if(Pn||au(s,l,f,!1),M=(f&s.childLanes)!==0,Pn||M){if(M=Kt,M!==null&&(g=Yd(M,f),g!==0&&g!==Q.retryLane))throw Q.retryLane=g,Al(s,g),zr(M,s,g),bb;ix(F)||rm(),l=Tb(s,l,f)}else ix(F)?(l.flags|=192,l.child=s.child,l=null):(s=Q.treeContext,Wt=_i(F.nextSibling),nr=l,Et=!0,to=null,bi=!1,s!==null&&pT(l,s),l=Sb(l,g.children),l.flags|=4096);return l}return x?(lo(),F=g.fallback,x=l.mode,Q=s.child,ce=Q.sibling,g=ns(Q,{mode:"hidden",children:g.children}),g.subtreeFlags=Q.subtreeFlags&65011712,ce!==null?F=ns(ce,F):(F=Cl(F,x,f,null),F.flags|=2),F.return=l,g.return=l,g.sibling=F,l.child=g,Cf(null,g),g=l.child,F=s.child.memoizedState,F===null?F=wb(f):(x=F.cachePool,x!==null?(Q=Nn._currentValue,x=x.parent!==Q?{parent:Q,pool:Q}:x):x=xT(),F={baseLanes:F.baseLanes|f,cachePool:x}),g.memoizedState=F,g.childLanes=Eb(s,M,f),l.memoizedState=_b,Cf(s.child,g)):(oo(l),f=s.child,s=f.sibling,f=ns(f,{mode:"visible",children:g.children}),f.return=l,f.sibling=null,s!==null&&(M=l.deletions,M===null?(l.deletions=[s],l.flags|=16):M.push(s)),l.child=f,l.memoizedState=null,f)}function Sb(s,l){return l=Kg({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function Kg(s,l){return s=Zr(22,s,null,l),s.lanes=0,s}function Tb(s,l,f){return Pl(l,s.child,null,f),s=Sb(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function MA(s,l,f){s.lanes|=l;var g=s.alternate;g!==null&&(g.lanes|=l),By(s.return,l,f)}function Ab(s,l,f,g,x,E){var M=s.memoizedState;M===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:x,treeForkCount:E}:(M.isBackwards=l,M.rendering=null,M.renderingStartTime=0,M.last=g,M.tail=f,M.tailMode=x,M.treeForkCount=E)}function PA(s,l,f){var g=l.pendingProps,x=g.revealOrder,E=g.tail;g=g.children;var M=wn.current,F=(M&2)!==0;if(F?(M=M&1|2,l.flags|=128):M&=1,re(wn,M),ir(s,l,g,f),g=Et?pf:0,!F&&s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&MA(s,f,l);else if(s.tag===19)MA(s,f,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(x){case"forwards":for(f=l.child,x=null;f!==null;)s=f.alternate,s!==null&&jg(s)===null&&(x=f),f=f.sibling;f=x,f===null?(x=l.child,l.child=null):(x=f.sibling,f.sibling=null),Ab(l,!1,x,f,E,g);break;case"backwards":case"unstable_legacy-backwards":for(f=null,x=l.child,l.child=null;x!==null;){if(s=x.alternate,s!==null&&jg(s)===null){l.child=x;break}s=x.sibling,x.sibling=f,f=x,x=s}Ab(l,!0,f,null,E,g);break;case"together":Ab(l,!1,null,null,void 0,g);break;default:l.memoizedState=null}return l.child}function ls(s,l,f){if(s!==null&&(l.dependencies=s.dependencies),fo|=l.lanes,(f&l.childLanes)===0)if(s!==null){if(au(s,l,f,!1),(f&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(r(153));if(l.child!==null){for(s=l.child,f=ns(s,s.pendingProps),l.child=f,f.return=l;s.sibling!==null;)s=s.sibling,f=f.sibling=ns(s,s.pendingProps),f.return=l;f.sibling=null}return l.child}function Cb(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&Ig(s)))}function pV(s,l,f){switch(l.tag){case 3:Ce(l,l.stateNode.containerInfo),ro(l,Nn,s.memoizedState.cache),Il();break;case 27:case 5:Pe(l);break;case 4:Ce(l,l.stateNode.containerInfo);break;case 10:ro(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,Zy(l),null;break;case 13:var g=l.memoizedState;if(g!==null)return g.dehydrated!==null?(oo(l),l.flags|=128,null):(f&l.child.childLanes)!==0?NA(s,l,f):(oo(l),s=ls(s,l,f),s!==null?s.sibling:null);oo(l);break;case 19:var x=(s.flags&128)!==0;if(g=(f&l.childLanes)!==0,g||(au(s,l,f,!1),g=(f&l.childLanes)!==0),x){if(g)return PA(s,l,f);l.flags|=128}if(x=l.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),re(wn,wn.current),g)break;return null;case 22:return l.lanes=0,AA(s,l,f,l.pendingProps);case 24:ro(l,Nn,s.memoizedState.cache)}return ls(s,l,f)}function OA(s,l,f){if(s!==null)if(s.memoizedProps!==l.pendingProps)Pn=!0;else{if(!Cb(s,f)&&(l.flags&128)===0)return Pn=!1,pV(s,l,f);Pn=(s.flags&131072)!==0}else Pn=!1,Et&&(l.flags&1048576)!==0&&hT(l,pf,l.index);switch(l.lanes=0,l.tag){case 16:e:{var g=l.pendingProps;if(s=Nl(l.elementType),l.type=s,typeof s=="function")Ny(s)?(g=jl(s,g),l.tag=1,l=DA(null,l,s,g,f)):(l.tag=0,l=xb(null,l,s,g,f));else{if(s!=null){var x=s.$$typeof;if(x===O){l.tag=11,l=EA(null,l,s,g,f);break e}else if(x===A){l.tag=14,l=SA(null,l,s,g,f);break e}}throw l=X(s)||s,Error(r(306,l,""))}}return l;case 0:return xb(s,l,l.type,l.pendingProps,f);case 1:return g=l.type,x=jl(g,l.pendingProps),DA(s,l,g,x,f);case 3:e:{if(Ce(l,l.stateNode.containerInfo),s===null)throw Error(r(387));g=l.pendingProps;var E=l.memoizedState;x=E.element,Yy(s,l),wf(l,g,null,f);var M=l.memoizedState;if(g=M.cache,ro(l,Nn,g),g!==E.cache&&Uy(l,[Nn],f,!0),_f(),g=M.element,E.isDehydrated)if(E={element:g,isDehydrated:!1,cache:M.cache},l.updateQueue.baseState=E,l.memoizedState=E,l.flags&256){l=kA(s,l,g,f);break e}else if(g!==x){x=mi(Error(r(424)),l),gf(x),l=kA(s,l,g,f);break e}else{switch(s=l.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Wt=_i(s.firstChild),nr=l,Et=!0,to=null,bi=!0,f=AT(l,null,g,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(Il(),g===x){l=ls(s,l,f);break e}ir(s,l,g,f)}l=l.child}return l;case 26:return Yg(s,l),s===null?(f=HC(l.type,null,l.pendingProps,null))?l.memoizedState=f:Et||(f=l.type,s=l.pendingProps,g=um(fe.current).createElement(f),g[Rn]=l,g[Qn]=s,ar(g,f,s),Dn(g),l.stateNode=g):l.memoizedState=HC(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return Pe(l),s===null&&Et&&(g=l.stateNode=GC(l.type,l.pendingProps,fe.current),nr=l,bi=!0,x=Wt,vo(l.type)?(sx=x,Wt=_i(g.firstChild)):Wt=x),ir(s,l,l.pendingProps.children,f),Yg(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&Et&&((x=g=Wt)&&(g=qV(g,l.type,l.pendingProps,bi),g!==null?(l.stateNode=g,nr=l,Wt=_i(g.firstChild),bi=!1,x=!0):x=!1),x||no(l)),Pe(l),x=l.type,E=l.pendingProps,M=s!==null?s.memoizedProps:null,g=E.children,tx(x,E)?g=null:M!==null&&tx(x,M)&&(l.flags|=32),l.memoizedState!==null&&(x=eb(s,l,aV,null,null,f),Ff._currentValue=x),Yg(s,l),ir(s,l,g,f),l.child;case 6:return s===null&&Et&&((s=f=Wt)&&(f=$V(f,l.pendingProps,bi),f!==null?(l.stateNode=f,nr=l,Wt=null,s=!0):s=!1),s||no(l)),null;case 13:return NA(s,l,f);case 4:return Ce(l,l.stateNode.containerInfo),g=l.pendingProps,s===null?l.child=Pl(l,null,g,f):ir(s,l,g,f),l.child;case 11:return EA(s,l,l.type,l.pendingProps,f);case 7:return ir(s,l,l.pendingProps,f),l.child;case 8:return ir(s,l,l.pendingProps.children,f),l.child;case 12:return ir(s,l,l.pendingProps.children,f),l.child;case 10:return g=l.pendingProps,ro(l,l.type,g.value),ir(s,l,g.children,f),l.child;case 9:return x=l.type._context,g=l.pendingProps.children,Dl(l),x=rr(x),g=g(x),l.flags|=1,ir(s,l,g,f),l.child;case 14:return SA(s,l,l.type,l.pendingProps,f);case 15:return TA(s,l,l.type,l.pendingProps,f);case 19:return PA(s,l,f);case 31:return hV(s,l,f);case 22:return AA(s,l,f,l.pendingProps);case 24:return Dl(l),g=rr(Nn),s===null?(x=qy(),x===null&&(x=Kt,E=Fy(),x.pooledCache=E,E.refCount++,E!==null&&(x.pooledCacheLanes|=f),x=E),l.memoizedState={parent:g,cache:x},Hy(l),ro(l,Nn,x)):((s.lanes&f)!==0&&(Yy(s,l),wf(l,null,null,f),_f()),x=s.memoizedState,E=l.memoizedState,x.parent!==g?(x={parent:g,cache:g},l.memoizedState=x,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=x),ro(l,Nn,g)):(g=E.cache,ro(l,Nn,g),g!==x.cache&&Uy(l,[Nn],f,!0))),ir(s,l,l.pendingProps.children,f),l.child;case 29:throw l.pendingProps}throw Error(r(156,l.tag))}function cs(s){s.flags|=4}function Ib(s,l,f,g,x){if((l=(s.mode&32)!==0)&&(l=!1),l){if(s.flags|=16777216,(x&335544128)===x)if(s.stateNode.complete)s.flags|=8192;else if(lC())s.flags|=8192;else throw Ml=Ng,$y}else s.flags&=-16777217}function jA(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!QC(l))if(lC())s.flags|=8192;else throw Ml=Ng,$y}function Xg(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?tg():536870912,s.lanes|=l,vu|=l)}function If(s,l){if(!Et)switch(s.tailMode){case"hidden":l=s.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s.tail=null:f.sibling=null;break;case"collapsed":f=s.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:g.sibling=null}}function Qt(s){var l=s.alternate!==null&&s.alternate.child===s.child,f=0,g=0;if(l)for(var x=s.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags&65011712,g|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags,g|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=g,s.childLanes=f,l}function gV(s,l,f){var g=l.pendingProps;switch(jy(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(l),null;case 1:return Qt(l),null;case 3:return f=l.stateNode,g=null,s!==null&&(g=s.memoizedState.cache),l.memoizedState.cache!==g&&(l.flags|=2048),as(Nn),we(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(iu(l)?cs(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,zy())),Qt(l),null;case 26:var x=l.type,E=l.memoizedState;return s===null?(cs(l),E!==null?(Qt(l),jA(l,E)):(Qt(l),Ib(l,x,null,g,f))):E?E!==s.memoizedState?(cs(l),Qt(l),jA(l,E)):(Qt(l),l.flags&=-16777217):(s=s.memoizedProps,s!==g&&cs(l),Qt(l),Ib(l,x,s,g,f)),null;case 27:if(ue(l),f=fe.current,x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==g&&cs(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return Qt(l),null}s=Z.current,iu(l)?gT(l):(s=GC(x,g,f),l.stateNode=s,cs(l))}return Qt(l),null;case 5:if(ue(l),x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==g&&cs(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return Qt(l),null}if(E=Z.current,iu(l))gT(l);else{var M=um(fe.current);switch(E){case 1:E=M.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:E=M.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":E=M.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":E=M.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":E=M.createElement("div"),E.innerHTML="<script><\/script>",E=E.removeChild(E.firstChild);break;case"select":E=typeof g.is=="string"?M.createElement("select",{is:g.is}):M.createElement("select"),g.multiple?E.multiple=!0:g.size&&(E.size=g.size);break;default:E=typeof g.is=="string"?M.createElement(x,{is:g.is}):M.createElement(x)}}E[Rn]=l,E[Qn]=g;e:for(M=l.child;M!==null;){if(M.tag===5||M.tag===6)E.appendChild(M.stateNode);else if(M.tag!==4&&M.tag!==27&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===l)break e;for(;M.sibling===null;){if(M.return===null||M.return===l)break e;M=M.return}M.sibling.return=M.return,M=M.sibling}l.stateNode=E;e:switch(ar(E,x,g),x){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&cs(l)}}return Qt(l),Ib(l,l.type,s===null?null:s.memoizedProps,l.pendingProps,f),null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==g&&cs(l);else{if(typeof g!="string"&&l.stateNode===null)throw Error(r(166));if(s=fe.current,iu(l)){if(s=l.stateNode,f=l.memoizedProps,g=null,x=nr,x!==null)switch(x.tag){case 27:case 5:g=x.memoizedProps}s[Rn]=l,s=!!(s.nodeValue===f||g!==null&&g.suppressHydrationWarning===!0||NC(s.nodeValue,f)),s||no(l,!0)}else s=um(s).createTextNode(g),s[Rn]=l,l.stateNode=s}return Qt(l),null;case 31:if(f=l.memoizedState,s===null||s.memoizedState!==null){if(g=iu(l),f!==null){if(s===null){if(!g)throw Error(r(318));if(s=l.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(557));s[Rn]=l}else Il(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Qt(l),s=!1}else f=zy(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),s=!0;if(!s)return l.flags&256?(ei(l),l):(ei(l),null);if((l.flags&128)!==0)throw Error(r(558))}return Qt(l),null;case 13:if(g=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=iu(l),g!==null&&g.dehydrated!==null){if(s===null){if(!x)throw Error(r(318));if(x=l.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[Rn]=l}else Il(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Qt(l),x=!1}else x=zy(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return l.flags&256?(ei(l),l):(ei(l),null)}return ei(l),(l.flags&128)!==0?(l.lanes=f,l):(f=g!==null,s=s!==null&&s.memoizedState!==null,f&&(g=l.child,x=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(x=g.alternate.memoizedState.cachePool.pool),E=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(E=g.memoizedState.cachePool.pool),E!==x&&(g.flags|=2048)),f!==s&&f&&(l.child.flags|=8192),Xg(l,l.updateQueue),Qt(l),null);case 4:return we(),s===null&&Wb(l.stateNode.containerInfo),Qt(l),null;case 10:return as(l.type),Qt(l),null;case 19:if(Y(wn),g=l.memoizedState,g===null)return Qt(l),null;if(x=(l.flags&128)!==0,E=g.rendering,E===null)if(x)If(g,!1);else{if(mn!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(E=jg(s),E!==null){for(l.flags|=128,If(g,!1),s=E.updateQueue,l.updateQueue=s,Xg(l,s),l.subtreeFlags=0,s=f,f=l.child;f!==null;)uT(f,s),f=f.sibling;return re(wn,wn.current&1|2),Et&&rs(l,g.treeForkCount),l.child}s=s.sibling}g.tail!==null&&ft()>em&&(l.flags|=128,x=!0,If(g,!1),l.lanes=4194304)}else{if(!x)if(s=jg(E),s!==null){if(l.flags|=128,x=!0,s=s.updateQueue,l.updateQueue=s,Xg(l,s),If(g,!0),g.tail===null&&g.tailMode==="hidden"&&!E.alternate&&!Et)return Qt(l),null}else 2*ft()-g.renderingStartTime>em&&f!==536870912&&(l.flags|=128,x=!0,If(g,!1),l.lanes=4194304);g.isBackwards?(E.sibling=l.child,l.child=E):(s=g.last,s!==null?s.sibling=E:l.child=E,g.last=E)}return g.tail!==null?(s=g.tail,g.rendering=s,g.tail=s.sibling,g.renderingStartTime=ft(),s.sibling=null,f=wn.current,re(wn,x?f&1|2:f&1),Et&&rs(l,g.treeForkCount),s):(Qt(l),null);case 22:case 23:return ei(l),Qy(),g=l.memoizedState!==null,s!==null?s.memoizedState!==null!==g&&(l.flags|=8192):g&&(l.flags|=8192),g?(f&536870912)!==0&&(l.flags&128)===0&&(Qt(l),l.subtreeFlags&6&&(l.flags|=8192)):Qt(l),f=l.updateQueue,f!==null&&Xg(l,f.retryQueue),f=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),g=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),g!==f&&(l.flags|=2048),s!==null&&Y(kl),null;case 24:return f=null,s!==null&&(f=s.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),as(Nn),Qt(l),null;case 25:return null;case 30:return null}throw Error(r(156,l.tag))}function mV(s,l){switch(jy(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return as(Nn),we(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return ue(l),null;case 31:if(l.memoizedState!==null){if(ei(l),l.alternate===null)throw Error(r(340));Il()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 13:if(ei(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(r(340));Il()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return Y(wn),null;case 4:return we(),null;case 10:return as(l.type),null;case 22:case 23:return ei(l),Qy(),s!==null&&Y(kl),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return as(Nn),null;case 25:return null;default:return null}}function VA(s,l){switch(jy(l),l.tag){case 3:as(Nn),we();break;case 26:case 27:case 5:ue(l);break;case 4:we();break;case 31:l.memoizedState!==null&&ei(l);break;case 13:ei(l);break;case 19:Y(wn);break;case 10:as(l.type);break;case 22:case 23:ei(l),Qy(),s!==null&&Y(kl);break;case 24:as(Nn)}}function Rf(s,l){try{var f=l.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var x=g.next;f=x;do{if((f.tag&s)===s){g=void 0;var E=f.create,M=f.inst;g=E(),M.destroy=g}f=f.next}while(f!==x)}}catch(F){Vt(l,l.return,F)}}function co(s,l,f){try{var g=l.updateQueue,x=g!==null?g.lastEffect:null;if(x!==null){var E=x.next;g=E;do{if((g.tag&s)===s){var M=g.inst,F=M.destroy;if(F!==void 0){M.destroy=void 0,x=l;var Q=f,ce=F;try{ce()}catch(ve){Vt(x,Q,ve)}}}g=g.next}while(g!==E)}}catch(ve){Vt(l,l.return,ve)}}function zA(s){var l=s.updateQueue;if(l!==null){var f=s.stateNode;try{IT(l,f)}catch(g){Vt(s,s.return,g)}}}function LA(s,l,f){f.props=jl(s.type,s.memoizedProps),f.state=s.memoizedState;try{f.componentWillUnmount()}catch(g){Vt(s,l,g)}}function Df(s,l){try{var f=s.ref;if(f!==null){switch(s.tag){case 26:case 27:case 5:var g=s.stateNode;break;case 30:g=s.stateNode;break;default:g=s.stateNode}typeof f=="function"?s.refCleanup=f(g):f.current=g}}catch(x){Vt(s,l,x)}}function Ca(s,l){var f=s.ref,g=s.refCleanup;if(f!==null)if(typeof g=="function")try{g()}catch(x){Vt(s,l,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(x){Vt(s,l,x)}else f.current=null}function BA(s){var l=s.type,f=s.memoizedProps,g=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":f.autoFocus&&g.focus();break e;case"img":f.src?g.src=f.src:f.srcSet&&(g.srcset=f.srcSet)}}catch(x){Vt(s,s.return,x)}}function Rb(s,l,f){try{var g=s.stateNode;zV(g,s.type,f,l),g[Qn]=l}catch(x){Vt(s,s.return,x)}}function UA(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&vo(s.type)||s.tag===4}function Db(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||UA(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&vo(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function kb(s,l,f){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(s,l):(l=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,l.appendChild(s),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=Li));else if(g!==4&&(g===27&&vo(s.type)&&(f=s.stateNode,l=null),s=s.child,s!==null))for(kb(s,l,f),s=s.sibling;s!==null;)kb(s,l,f),s=s.sibling}function Wg(s,l,f){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?f.insertBefore(s,l):f.appendChild(s);else if(g!==4&&(g===27&&vo(s.type)&&(f=s.stateNode),s=s.child,s!==null))for(Wg(s,l,f),s=s.sibling;s!==null;)Wg(s,l,f),s=s.sibling}function FA(s){var l=s.stateNode,f=s.memoizedProps;try{for(var g=s.type,x=l.attributes;x.length;)l.removeAttributeNode(x[0]);ar(l,g,f),l[Rn]=s,l[Qn]=f}catch(E){Vt(s,s.return,E)}}var us=!1,On=!1,Nb=!1,GA=typeof WeakSet=="function"?WeakSet:Set,Jn=null;function vV(s,l){if(s=s.containerInfo,Jb=vm,s=tT(s),Ty(s)){if("selectionStart"in s)var f={start:s.selectionStart,end:s.selectionEnd};else e:{f=(f=s.ownerDocument)&&f.defaultView||window;var g=f.getSelection&&f.getSelection();if(g&&g.rangeCount!==0){f=g.anchorNode;var x=g.anchorOffset,E=g.focusNode;g=g.focusOffset;try{f.nodeType,E.nodeType}catch{f=null;break e}var M=0,F=-1,Q=-1,ce=0,ve=0,xe=s,de=null;t:for(;;){for(var ge;xe!==f||x!==0&&xe.nodeType!==3||(F=M+x),xe!==E||g!==0&&xe.nodeType!==3||(Q=M+g),xe.nodeType===3&&(M+=xe.nodeValue.length),(ge=xe.firstChild)!==null;)de=xe,xe=ge;for(;;){if(xe===s)break t;if(de===f&&++ce===x&&(F=M),de===E&&++ve===g&&(Q=M),(ge=xe.nextSibling)!==null)break;xe=de,de=xe.parentNode}xe=ge}f=F===-1||Q===-1?null:{start:F,end:Q}}else f=null}f=f||{start:0,end:0}}else f=null;for(ex={focusedElem:s,selectionRange:f},vm=!1,Jn=l;Jn!==null;)if(l=Jn,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,Jn=s;else for(;Jn!==null;){switch(l=Jn,E=l.alternate,s=l.flags,l.tag){case 0:if((s&4)!==0&&(s=l.updateQueue,s=s!==null?s.events:null,s!==null))for(f=0;f<s.length;f++)x=s[f],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&E!==null){s=void 0,f=l,x=E.memoizedProps,E=E.memoizedState,g=f.stateNode;try{var je=jl(f.type,x);s=g.getSnapshotBeforeUpdate(je,E),g.__reactInternalSnapshotBeforeUpdate=s}catch(Qe){Vt(f,f.return,Qe)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,f=s.nodeType,f===9)rx(s);else if(f===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":rx(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=l.sibling,s!==null){s.return=l.return,Jn=s;break}Jn=l.return}}function qA(s,l,f){var g=f.flags;switch(f.tag){case 0:case 11:case 15:fs(s,f),g&4&&Rf(5,f);break;case 1:if(fs(s,f),g&4)if(s=f.stateNode,l===null)try{s.componentDidMount()}catch(M){Vt(f,f.return,M)}else{var x=jl(f.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(x,l,s.__reactInternalSnapshotBeforeUpdate)}catch(M){Vt(f,f.return,M)}}g&64&&zA(f),g&512&&Df(f,f.return);break;case 3:if(fs(s,f),g&64&&(s=f.updateQueue,s!==null)){if(l=null,f.child!==null)switch(f.child.tag){case 27:case 5:l=f.child.stateNode;break;case 1:l=f.child.stateNode}try{IT(s,l)}catch(M){Vt(f,f.return,M)}}break;case 27:l===null&&g&4&&FA(f);case 26:case 5:fs(s,f),l===null&&g&4&&BA(f),g&512&&Df(f,f.return);break;case 12:fs(s,f);break;case 31:fs(s,f),g&4&&YA(s,f);break;case 13:fs(s,f),g&4&&KA(s,f),g&64&&(s=f.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(f=AV.bind(null,f),HV(s,f))));break;case 22:if(g=f.memoizedState!==null||us,!g){l=l!==null&&l.memoizedState!==null||On,x=us;var E=On;us=g,(On=l)&&!E?hs(s,f,(f.subtreeFlags&8772)!==0):fs(s,f),us=x,On=E}break;case 30:break;default:fs(s,f)}}function $A(s){var l=s.alternate;l!==null&&(s.alternate=null,$A(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&Uc(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var tn=null,Pr=!1;function ds(s,l,f){for(f=f.child;f!==null;)HA(s,l,f),f=f.sibling}function HA(s,l,f){if(In&&typeof In.onCommitFiberUnmount=="function")try{In.onCommitFiberUnmount(Yr,f)}catch{}switch(f.tag){case 26:On||Ca(f,l),ds(s,l,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:On||Ca(f,l);var g=tn,x=Pr;vo(f.type)&&(tn=f.stateNode,Pr=!1),ds(s,l,f),Lf(f.stateNode),tn=g,Pr=x;break;case 5:On||Ca(f,l);case 6:if(g=tn,x=Pr,tn=null,ds(s,l,f),tn=g,Pr=x,tn!==null)if(Pr)try{(tn.nodeType===9?tn.body:tn.nodeName==="HTML"?tn.ownerDocument.body:tn).removeChild(f.stateNode)}catch(E){Vt(f,l,E)}else try{tn.removeChild(f.stateNode)}catch(E){Vt(f,l,E)}break;case 18:tn!==null&&(Pr?(s=tn,zC(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,f.stateNode),Tu(s)):zC(tn,f.stateNode));break;case 4:g=tn,x=Pr,tn=f.stateNode.containerInfo,Pr=!0,ds(s,l,f),tn=g,Pr=x;break;case 0:case 11:case 14:case 15:co(2,f,l),On||co(4,f,l),ds(s,l,f);break;case 1:On||(Ca(f,l),g=f.stateNode,typeof g.componentWillUnmount=="function"&&LA(f,l,g)),ds(s,l,f);break;case 21:ds(s,l,f);break;case 22:On=(g=On)||f.memoizedState!==null,ds(s,l,f),On=g;break;default:ds(s,l,f)}}function YA(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Tu(s)}catch(f){Vt(l,l.return,f)}}}function KA(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Tu(s)}catch(f){Vt(l,l.return,f)}}function yV(s){switch(s.tag){case 31:case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new GA),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new GA),l;default:throw Error(r(435,s.tag))}}function Qg(s,l){var f=yV(s);l.forEach(function(g){if(!f.has(g)){f.add(g);var x=CV.bind(null,s,g);g.then(x,x)}})}function Or(s,l){var f=l.deletions;if(f!==null)for(var g=0;g<f.length;g++){var x=f[g],E=s,M=l,F=M;e:for(;F!==null;){switch(F.tag){case 27:if(vo(F.type)){tn=F.stateNode,Pr=!1;break e}break;case 5:tn=F.stateNode,Pr=!1;break e;case 3:case 4:tn=F.stateNode.containerInfo,Pr=!0;break e}F=F.return}if(tn===null)throw Error(r(160));HA(E,M,x),tn=null,Pr=!1,E=x.alternate,E!==null&&(E.return=null),x.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)XA(l,s),l=l.sibling}var $i=null;function XA(s,l){var f=s.alternate,g=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Or(l,s),jr(s),g&4&&(co(3,s,s.return),Rf(3,s),co(5,s,s.return));break;case 1:Or(l,s),jr(s),g&512&&(On||f===null||Ca(f,f.return)),g&64&&us&&(s=s.updateQueue,s!==null&&(g=s.callbacks,g!==null&&(f=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=f===null?g:f.concat(g))));break;case 26:var x=$i;if(Or(l,s),jr(s),g&512&&(On||f===null||Ca(f,f.return)),g&4){var E=f!==null?f.memoizedState:null;if(g=s.memoizedState,f===null)if(g===null)if(s.stateNode===null){e:{g=s.type,f=s.memoizedProps,x=x.ownerDocument||x;t:switch(g){case"title":E=x.getElementsByTagName("title")[0],(!E||E[ha]||E[Rn]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=x.createElement(g),x.head.insertBefore(E,x.querySelector("head > title"))),ar(E,g,f),E[Rn]=s,Dn(E),g=E;break e;case"link":var M=XC("link","href",x).get(g+(f.href||""));if(M){for(var F=0;F<M.length;F++)if(E=M[F],E.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&E.getAttribute("rel")===(f.rel==null?null:f.rel)&&E.getAttribute("title")===(f.title==null?null:f.title)&&E.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){M.splice(F,1);break t}}E=x.createElement(g),ar(E,g,f),x.head.appendChild(E);break;case"meta":if(M=XC("meta","content",x).get(g+(f.content||""))){for(F=0;F<M.length;F++)if(E=M[F],E.getAttribute("content")===(f.content==null?null:""+f.content)&&E.getAttribute("name")===(f.name==null?null:f.name)&&E.getAttribute("property")===(f.property==null?null:f.property)&&E.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&E.getAttribute("charset")===(f.charSet==null?null:f.charSet)){M.splice(F,1);break t}}E=x.createElement(g),ar(E,g,f),x.head.appendChild(E);break;default:throw Error(r(468,g))}E[Rn]=s,Dn(E),g=E}s.stateNode=g}else WC(x,s.type,s.stateNode);else s.stateNode=KC(x,g,s.memoizedProps);else E!==g?(E===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):E.count--,g===null?WC(x,s.type,s.stateNode):KC(x,g,s.memoizedProps)):g===null&&s.stateNode!==null&&Rb(s,s.memoizedProps,f.memoizedProps)}break;case 27:Or(l,s),jr(s),g&512&&(On||f===null||Ca(f,f.return)),f!==null&&g&4&&Rb(s,s.memoizedProps,f.memoizedProps);break;case 5:if(Or(l,s),jr(s),g&512&&(On||f===null||Ca(f,f.return)),s.flags&32){x=s.stateNode;try{Mr(x,"")}catch(je){Vt(s,s.return,je)}}g&4&&s.stateNode!=null&&(x=s.memoizedProps,Rb(s,x,f!==null?f.memoizedProps:x)),g&1024&&(Nb=!0);break;case 6:if(Or(l,s),jr(s),g&4){if(s.stateNode===null)throw Error(r(162));g=s.memoizedProps,f=s.stateNode;try{f.nodeValue=g}catch(je){Vt(s,s.return,je)}}break;case 3:if(hm=null,x=$i,$i=dm(l.containerInfo),Or(l,s),$i=x,jr(s),g&4&&f!==null&&f.memoizedState.isDehydrated)try{Tu(l.containerInfo)}catch(je){Vt(s,s.return,je)}Nb&&(Nb=!1,WA(s));break;case 4:g=$i,$i=dm(s.stateNode.containerInfo),Or(l,s),jr(s),$i=g;break;case 12:Or(l,s),jr(s);break;case 31:Or(l,s),jr(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Qg(s,g)));break;case 13:Or(l,s),jr(s),s.child.flags&8192&&s.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Jg=ft()),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Qg(s,g)));break;case 22:x=s.memoizedState!==null;var Q=f!==null&&f.memoizedState!==null,ce=us,ve=On;if(us=ce||x,On=ve||Q,Or(l,s),On=ve,us=ce,jr(s),g&8192)e:for(l=s.stateNode,l._visibility=x?l._visibility&-2:l._visibility|1,x&&(f===null||Q||us||On||Vl(s)),f=null,l=s;;){if(l.tag===5||l.tag===26){if(f===null){Q=f=l;try{if(E=Q.stateNode,x)M=E.style,typeof M.setProperty=="function"?M.setProperty("display","none","important"):M.display="none";else{F=Q.stateNode;var xe=Q.memoizedProps.style,de=xe!=null&&xe.hasOwnProperty("display")?xe.display:null;F.style.display=de==null||typeof de=="boolean"?"":(""+de).trim()}}catch(je){Vt(Q,Q.return,je)}}}else if(l.tag===6){if(f===null){Q=l;try{Q.stateNode.nodeValue=x?"":Q.memoizedProps}catch(je){Vt(Q,Q.return,je)}}}else if(l.tag===18){if(f===null){Q=l;try{var ge=Q.stateNode;x?LC(ge,!0):LC(Q.stateNode,!1)}catch(je){Vt(Q,Q.return,je)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;f===l&&(f=null),l=l.return}f===l&&(f=null),l.sibling.return=l.return,l=l.sibling}g&4&&(g=s.updateQueue,g!==null&&(f=g.retryQueue,f!==null&&(g.retryQueue=null,Qg(s,f))));break;case 19:Or(l,s),jr(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Qg(s,g)));break;case 30:break;case 21:break;default:Or(l,s),jr(s)}}function jr(s){var l=s.flags;if(l&2){try{for(var f,g=s.return;g!==null;){if(UA(g)){f=g;break}g=g.return}if(f==null)throw Error(r(160));switch(f.tag){case 27:var x=f.stateNode,E=Db(s);Wg(s,E,x);break;case 5:var M=f.stateNode;f.flags&32&&(Mr(M,""),f.flags&=-33);var F=Db(s);Wg(s,F,M);break;case 3:case 4:var Q=f.stateNode.containerInfo,ce=Db(s);kb(s,ce,Q);break;default:throw Error(r(161))}}catch(ve){Vt(s,s.return,ve)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function WA(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;WA(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function fs(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)qA(s,l.alternate,l),l=l.sibling}function Vl(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:co(4,l,l.return),Vl(l);break;case 1:Ca(l,l.return);var f=l.stateNode;typeof f.componentWillUnmount=="function"&&LA(l,l.return,f),Vl(l);break;case 27:Lf(l.stateNode);case 26:case 5:Ca(l,l.return),Vl(l);break;case 22:l.memoizedState===null&&Vl(l);break;case 30:Vl(l);break;default:Vl(l)}s=s.sibling}}function hs(s,l,f){for(f=f&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var g=l.alternate,x=s,E=l,M=E.flags;switch(E.tag){case 0:case 11:case 15:hs(x,E,f),Rf(4,E);break;case 1:if(hs(x,E,f),g=E,x=g.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(ce){Vt(g,g.return,ce)}if(g=E,x=g.updateQueue,x!==null){var F=g.stateNode;try{var Q=x.shared.hiddenCallbacks;if(Q!==null)for(x.shared.hiddenCallbacks=null,x=0;x<Q.length;x++)CT(Q[x],F)}catch(ce){Vt(g,g.return,ce)}}f&&M&64&&zA(E),Df(E,E.return);break;case 27:FA(E);case 26:case 5:hs(x,E,f),f&&g===null&&M&4&&BA(E),Df(E,E.return);break;case 12:hs(x,E,f);break;case 31:hs(x,E,f),f&&M&4&&YA(x,E);break;case 13:hs(x,E,f),f&&M&4&&KA(x,E);break;case 22:E.memoizedState===null&&hs(x,E,f),Df(E,E.return);break;case 30:break;default:hs(x,E,f)}l=l.sibling}}function Mb(s,l){var f=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==f&&(s!=null&&s.refCount++,f!=null&&mf(f))}function Pb(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&mf(s))}function Hi(s,l,f,g){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)QA(s,l,f,g),l=l.sibling}function QA(s,l,f,g){var x=l.flags;switch(l.tag){case 0:case 11:case 15:Hi(s,l,f,g),x&2048&&Rf(9,l);break;case 1:Hi(s,l,f,g);break;case 3:Hi(s,l,f,g),x&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&mf(s)));break;case 12:if(x&2048){Hi(s,l,f,g),s=l.stateNode;try{var E=l.memoizedProps,M=E.id,F=E.onPostCommit;typeof F=="function"&&F(M,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(Q){Vt(l,l.return,Q)}}else Hi(s,l,f,g);break;case 31:Hi(s,l,f,g);break;case 13:Hi(s,l,f,g);break;case 23:break;case 22:E=l.stateNode,M=l.alternate,l.memoizedState!==null?E._visibility&2?Hi(s,l,f,g):kf(s,l):E._visibility&2?Hi(s,l,f,g):(E._visibility|=2,pu(s,l,f,g,(l.subtreeFlags&10256)!==0||!1)),x&2048&&Mb(M,l);break;case 24:Hi(s,l,f,g),x&2048&&Pb(l.alternate,l);break;default:Hi(s,l,f,g)}}function pu(s,l,f,g,x){for(x=x&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var E=s,M=l,F=f,Q=g,ce=M.flags;switch(M.tag){case 0:case 11:case 15:pu(E,M,F,Q,x),Rf(8,M);break;case 23:break;case 22:var ve=M.stateNode;M.memoizedState!==null?ve._visibility&2?pu(E,M,F,Q,x):kf(E,M):(ve._visibility|=2,pu(E,M,F,Q,x)),x&&ce&2048&&Mb(M.alternate,M);break;case 24:pu(E,M,F,Q,x),x&&ce&2048&&Pb(M.alternate,M);break;default:pu(E,M,F,Q,x)}l=l.sibling}}function kf(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var f=s,g=l,x=g.flags;switch(g.tag){case 22:kf(f,g),x&2048&&Mb(g.alternate,g);break;case 24:kf(f,g),x&2048&&Pb(g.alternate,g);break;default:kf(f,g)}l=l.sibling}}var Nf=8192;function gu(s,l,f){if(s.subtreeFlags&Nf)for(s=s.child;s!==null;)ZA(s,l,f),s=s.sibling}function ZA(s,l,f){switch(s.tag){case 26:gu(s,l,f),s.flags&Nf&&s.memoizedState!==null&&iz(f,$i,s.memoizedState,s.memoizedProps);break;case 5:gu(s,l,f);break;case 3:case 4:var g=$i;$i=dm(s.stateNode.containerInfo),gu(s,l,f),$i=g;break;case 22:s.memoizedState===null&&(g=s.alternate,g!==null&&g.memoizedState!==null?(g=Nf,Nf=16777216,gu(s,l,f),Nf=g):gu(s,l,f));break;default:gu(s,l,f)}}function JA(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function Mf(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];Jn=g,tC(g,s)}JA(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)eC(s),s=s.sibling}function eC(s){switch(s.tag){case 0:case 11:case 15:Mf(s),s.flags&2048&&co(9,s,s.return);break;case 3:Mf(s);break;case 12:Mf(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,Zg(s)):Mf(s);break;default:Mf(s)}}function Zg(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];Jn=g,tC(g,s)}JA(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:co(8,l,l.return),Zg(l);break;case 22:f=l.stateNode,f._visibility&2&&(f._visibility&=-3,Zg(l));break;default:Zg(l)}s=s.sibling}}function tC(s,l){for(;Jn!==null;){var f=Jn;switch(f.tag){case 0:case 11:case 15:co(8,f,l);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var g=f.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:mf(f.memoizedState.cache)}if(g=f.child,g!==null)g.return=f,Jn=g;else e:for(f=s;Jn!==null;){g=Jn;var x=g.sibling,E=g.return;if($A(g),g===f){Jn=null;break e}if(x!==null){x.return=E,Jn=x;break e}Jn=E}}}var bV={getCacheForType:function(s){var l=rr(Nn),f=l.data.get(s);return f===void 0&&(f=s(),l.data.set(s,f)),f},cacheSignal:function(){return rr(Nn).controller.signal}},xV=typeof WeakMap=="function"?WeakMap:Map,Mt=0,Kt=null,vt=null,bt=0,jt=0,ti=null,uo=!1,mu=!1,Ob=!1,ps=0,mn=0,fo=0,zl=0,jb=0,ni=0,vu=0,Pf=null,Vr=null,Vb=!1,Jg=0,nC=0,em=1/0,tm=null,ho=null,Gn=0,po=null,yu=null,gs=0,zb=0,Lb=null,rC=null,Of=0,Bb=null;function ri(){return(Mt&2)!==0&&bt!==0?bt&-bt:$.T!==null?Hb():ng()}function iC(){if(ni===0)if((bt&536870912)===0||Et){var s=on;on<<=1,(on&3932160)===0&&(on=262144),ni=s}else ni=536870912;return s=Jr.current,s!==null&&(s.flags|=32),ni}function zr(s,l,f){(s===Kt&&(jt===2||jt===9)||s.cancelPendingCommit!==null)&&(bu(s,0),go(s,bt,ni,!1)),fl(s,f),((Mt&2)===0||s!==Kt)&&(s===Kt&&((Mt&2)===0&&(zl|=f),mn===4&&go(s,bt,ni,!1)),Ia(s))}function aC(s,l,f){if((Mt&6)!==0)throw Error(r(327));var g=!f&&(l&127)===0&&(l&s.expiredLanes)===0||_r(s,l),x=g?EV(s,l):Fb(s,l,!0),E=g;do{if(x===0){mu&&!g&&go(s,l,0,!1);break}else{if(f=s.current.alternate,E&&!_V(f)){x=Fb(s,l,!1),E=!1;continue}if(x===2){if(E=l,s.errorRecoveryDisabledLanes&E)var M=0;else M=s.pendingLanes&-536870913,M=M!==0?M:M&536870912?536870912:0;if(M!==0){l=M;e:{var F=s;x=Pf;var Q=F.current.memoizedState.isDehydrated;if(Q&&(bu(F,M).flags|=256),M=Fb(F,M,!1),M!==2){if(Ob&&!Q){F.errorRecoveryDisabledLanes|=E,zl|=E,x=4;break e}E=Vr,Vr=x,E!==null&&(Vr===null?Vr=E:Vr.push.apply(Vr,E))}x=M}if(E=!1,x!==2)continue}}if(x===1){bu(s,0),go(s,l,0,!0);break}e:{switch(g=s,E=x,E){case 0:case 1:throw Error(r(345));case 4:if((l&4194048)!==l)break;case 6:go(g,l,ni,!uo);break e;case 2:Vr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((l&62914560)===l&&(x=Jg+300-ft(),10<x)){if(go(g,l,ni,!uo),ui(g,0,!0)!==0)break e;gs=l,g.timeoutHandle=jC(sC.bind(null,g,f,Vr,tm,Vb,l,ni,zl,vu,uo,E,"Throttled",-0,0),x);break e}sC(g,f,Vr,tm,Vb,l,ni,zl,vu,uo,E,null,-0,0)}}break}while(!0);Ia(s)}function sC(s,l,f,g,x,E,M,F,Q,ce,ve,xe,de,ge){if(s.timeoutHandle=-1,xe=l.subtreeFlags,xe&8192||(xe&16785408)===16785408){xe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Li},ZA(l,E,xe);var je=(E&62914560)===E?Jg-ft():(E&4194048)===E?nC-ft():0;if(je=az(xe,je),je!==null){gs=E,s.cancelPendingCommit=je(pC.bind(null,s,l,E,f,g,x,M,F,Q,ve,xe,null,de,ge)),go(s,E,M,!ce);return}}pC(s,l,E,f,g,x,M,F,Q)}function _V(s){for(var l=s;;){var f=l.tag;if((f===0||f===11||f===15)&&l.flags&16384&&(f=l.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var g=0;g<f.length;g++){var x=f[g],E=x.getSnapshot;x=x.value;try{if(!Qr(E(),x))return!1}catch{return!1}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function go(s,l,f,g){l&=~jb,l&=~zl,s.suspendedLanes|=l,s.pingedLanes&=~l,g&&(s.warmLanes|=l),g=s.expirationTimes;for(var x=l;0<x;){var E=31-sn(x),M=1<<E;g[E]=-1,x&=~M}f!==0&&hl(s,f,l)}function nm(){return(Mt&6)===0?(jf(0),!1):!0}function Ub(){if(vt!==null){if(jt===0)var s=vt.return;else s=vt,is=Rl=null,rb(s),cu=null,yf=0,s=vt;for(;s!==null;)VA(s.alternate,s),s=s.return;vt=null}}function bu(s,l){var f=s.timeoutHandle;f!==-1&&(s.timeoutHandle=-1,UV(f)),f=s.cancelPendingCommit,f!==null&&(s.cancelPendingCommit=null,f()),gs=0,Ub(),Kt=s,vt=f=ns(s.current,null),bt=l,jt=0,ti=null,uo=!1,mu=_r(s,l),Ob=!1,vu=ni=jb=zl=fo=mn=0,Vr=Pf=null,Vb=!1,(l&8)!==0&&(l|=l&32);var g=s.entangledLanes;if(g!==0)for(s=s.entanglements,g&=l;0<g;){var x=31-sn(g),E=1<<x;l|=s[x],g&=~E}return ps=l,Eg(),f}function oC(s,l){ut=null,$.H=Af,l===lu||l===kg?(l=ET(),jt=3):l===$y?(l=ET(),jt=4):jt=l===bb?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,ti=l,vt===null&&(mn=1,$g(s,mi(l,s.current)))}function lC(){var s=Jr.current;return s===null?!0:(bt&4194048)===bt?xi===null:(bt&62914560)===bt||(bt&536870912)!==0?s===xi:!1}function cC(){var s=$.H;return $.H=Af,s===null?Af:s}function uC(){var s=$.A;return $.A=bV,s}function rm(){mn=4,uo||(bt&4194048)!==bt&&Jr.current!==null||(mu=!0),(fo&134217727)===0&&(zl&134217727)===0||Kt===null||go(Kt,bt,ni,!1)}function Fb(s,l,f){var g=Mt;Mt|=2;var x=cC(),E=uC();(Kt!==s||bt!==l)&&(tm=null,bu(s,l)),l=!1;var M=mn;e:do try{if(jt!==0&&vt!==null){var F=vt,Q=ti;switch(jt){case 8:Ub(),M=6;break e;case 3:case 2:case 9:case 6:Jr.current===null&&(l=!0);var ce=jt;if(jt=0,ti=null,xu(s,F,Q,ce),f&&mu){M=0;break e}break;default:ce=jt,jt=0,ti=null,xu(s,F,Q,ce)}}wV(),M=mn;break}catch(ve){oC(s,ve)}while(!0);return l&&s.shellSuspendCounter++,is=Rl=null,Mt=g,$.H=x,$.A=E,vt===null&&(Kt=null,bt=0,Eg()),M}function wV(){for(;vt!==null;)dC(vt)}function EV(s,l){var f=Mt;Mt|=2;var g=cC(),x=uC();Kt!==s||bt!==l?(tm=null,em=ft()+500,bu(s,l)):mu=_r(s,l);e:do try{if(jt!==0&&vt!==null){l=vt;var E=ti;t:switch(jt){case 1:jt=0,ti=null,xu(s,l,E,1);break;case 2:case 9:if(_T(E)){jt=0,ti=null,fC(l);break}l=function(){jt!==2&&jt!==9||Kt!==s||(jt=7),Ia(s)},E.then(l,l);break e;case 3:jt=7;break e;case 4:jt=5;break e;case 7:_T(E)?(jt=0,ti=null,fC(l)):(jt=0,ti=null,xu(s,l,E,7));break;case 5:var M=null;switch(vt.tag){case 26:M=vt.memoizedState;case 5:case 27:var F=vt;if(M?QC(M):F.stateNode.complete){jt=0,ti=null;var Q=F.sibling;if(Q!==null)vt=Q;else{var ce=F.return;ce!==null?(vt=ce,im(ce)):vt=null}break t}}jt=0,ti=null,xu(s,l,E,5);break;case 6:jt=0,ti=null,xu(s,l,E,6);break;case 8:Ub(),mn=6;break e;default:throw Error(r(462))}}SV();break}catch(ve){oC(s,ve)}while(!0);return is=Rl=null,$.H=g,$.A=x,Mt=f,vt!==null?0:(Kt=null,bt=0,Eg(),mn)}function SV(){for(;vt!==null&&!At();)dC(vt)}function dC(s){var l=OA(s.alternate,s,ps);s.memoizedProps=s.pendingProps,l===null?im(s):vt=l}function fC(s){var l=s,f=l.alternate;switch(l.tag){case 15:case 0:l=RA(f,l,l.pendingProps,l.type,void 0,bt);break;case 11:l=RA(f,l,l.pendingProps,l.type.render,l.ref,bt);break;case 5:rb(l);default:VA(f,l),l=vt=uT(l,ps),l=OA(f,l,ps)}s.memoizedProps=s.pendingProps,l===null?im(s):vt=l}function xu(s,l,f,g){is=Rl=null,rb(l),cu=null,yf=0;var x=l.return;try{if(fV(s,x,l,f,bt)){mn=1,$g(s,mi(f,s.current)),vt=null;return}}catch(E){if(x!==null)throw vt=x,E;mn=1,$g(s,mi(f,s.current)),vt=null;return}l.flags&32768?(Et||g===1?s=!0:mu||(bt&536870912)!==0?s=!1:(uo=s=!0,(g===2||g===9||g===3||g===6)&&(g=Jr.current,g!==null&&g.tag===13&&(g.flags|=16384))),hC(l,s)):im(l)}function im(s){var l=s;do{if((l.flags&32768)!==0){hC(l,uo);return}s=l.return;var f=gV(l.alternate,l,ps);if(f!==null){vt=f;return}if(l=l.sibling,l!==null){vt=l;return}vt=l=s}while(l!==null);mn===0&&(mn=5)}function hC(s,l){do{var f=mV(s.alternate,s);if(f!==null){f.flags&=32767,vt=f;return}if(f=s.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!l&&(s=s.sibling,s!==null)){vt=s;return}vt=s=f}while(s!==null);mn=6,vt=null}function pC(s,l,f,g,x,E,M,F,Q){s.cancelPendingCommit=null;do am();while(Gn!==0);if((Mt&6)!==0)throw Error(r(327));if(l!==null){if(l===s.current)throw Error(r(177));if(E=l.lanes|l.childLanes,E|=Dy,_y(s,f,E,M,F,Q),s===Kt&&(vt=Kt=null,bt=0),yu=l,po=s,gs=f,zb=E,Lb=x,rC=g,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,IV(Cn,function(){return bC(),null})):(s.callbackNode=null,s.callbackPriority=0),g=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||g){g=$.T,$.T=null,x=W.p,W.p=2,M=Mt,Mt|=4;try{vV(s,l,f)}finally{Mt=M,W.p=x,$.T=g}}Gn=1,gC(),mC(),vC()}}function gC(){if(Gn===1){Gn=0;var s=po,l=yu,f=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||f){f=$.T,$.T=null;var g=W.p;W.p=2;var x=Mt;Mt|=4;try{XA(l,s);var E=ex,M=tT(s.containerInfo),F=E.focusedElem,Q=E.selectionRange;if(M!==F&&F&&F.ownerDocument&&eT(F.ownerDocument.documentElement,F)){if(Q!==null&&Ty(F)){var ce=Q.start,ve=Q.end;if(ve===void 0&&(ve=ce),"selectionStart"in F)F.selectionStart=ce,F.selectionEnd=Math.min(ve,F.value.length);else{var xe=F.ownerDocument||document,de=xe&&xe.defaultView||window;if(de.getSelection){var ge=de.getSelection(),je=F.textContent.length,Qe=Math.min(Q.start,je),$t=Q.end===void 0?Qe:Math.min(Q.end,je);!ge.extend&&Qe>$t&&(M=$t,$t=Qe,Qe=M);var ie=JS(F,Qe),ne=JS(F,$t);if(ie&&ne&&(ge.rangeCount!==1||ge.anchorNode!==ie.node||ge.anchorOffset!==ie.offset||ge.focusNode!==ne.node||ge.focusOffset!==ne.offset)){var le=xe.createRange();le.setStart(ie.node,ie.offset),ge.removeAllRanges(),Qe>$t?(ge.addRange(le),ge.extend(ne.node,ne.offset)):(le.setEnd(ne.node,ne.offset),ge.addRange(le))}}}}for(xe=[],ge=F;ge=ge.parentNode;)ge.nodeType===1&&xe.push({element:ge,left:ge.scrollLeft,top:ge.scrollTop});for(typeof F.focus=="function"&&F.focus(),F=0;F<xe.length;F++){var ye=xe[F];ye.element.scrollLeft=ye.left,ye.element.scrollTop=ye.top}}vm=!!Jb,ex=Jb=null}finally{Mt=x,W.p=g,$.T=f}}s.current=l,Gn=2}}function mC(){if(Gn===2){Gn=0;var s=po,l=yu,f=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||f){f=$.T,$.T=null;var g=W.p;W.p=2;var x=Mt;Mt|=4;try{qA(s,l.alternate,l)}finally{Mt=x,W.p=g,$.T=f}}Gn=3}}function vC(){if(Gn===4||Gn===3){Gn=0,et();var s=po,l=yu,f=gs,g=rC;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?Gn=5:(Gn=0,yu=po=null,yC(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(ho=null),Za(f),l=l.stateNode,In&&typeof In.onCommitFiberRoot=="function")try{In.onCommitFiberRoot(Yr,l,void 0,(l.current.flags&128)===128)}catch{}if(g!==null){l=$.T,x=W.p,W.p=2,$.T=null;try{for(var E=s.onRecoverableError,M=0;M<g.length;M++){var F=g[M];E(F.value,{componentStack:F.stack})}}finally{$.T=l,W.p=x}}(gs&3)!==0&&am(),Ia(s),x=s.pendingLanes,(f&261930)!==0&&(x&42)!==0?s===Bb?Of++:(Of=0,Bb=s):Of=0,jf(0)}}function yC(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,mf(l)))}function am(){return gC(),mC(),vC(),bC()}function bC(){if(Gn!==5)return!1;var s=po,l=zb;zb=0;var f=Za(gs),g=$.T,x=W.p;try{W.p=32>f?32:f,$.T=null,f=Lb,Lb=null;var E=po,M=gs;if(Gn=0,yu=po=null,gs=0,(Mt&6)!==0)throw Error(r(331));var F=Mt;if(Mt|=4,eC(E.current),QA(E,E.current,M,f),Mt=F,jf(0,!1),In&&typeof In.onPostCommitFiberRoot=="function")try{In.onPostCommitFiberRoot(Yr,E)}catch{}return!0}finally{W.p=x,$.T=g,yC(s,l)}}function xC(s,l,f){l=mi(f,l),l=yb(s.stateNode,l,2),s=so(s,l,2),s!==null&&(fl(s,2),Ia(s))}function Vt(s,l,f){if(s.tag===3)xC(s,s,f);else for(;l!==null;){if(l.tag===3){xC(l,s,f);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(ho===null||!ho.has(g))){s=mi(f,s),f=_A(2),g=so(l,f,2),g!==null&&(wA(f,g,l,s),fl(g,2),Ia(g));break}}l=l.return}}function Gb(s,l,f){var g=s.pingCache;if(g===null){g=s.pingCache=new xV;var x=new Set;g.set(l,x)}else x=g.get(l),x===void 0&&(x=new Set,g.set(l,x));x.has(f)||(Ob=!0,x.add(f),s=TV.bind(null,s,l,f),l.then(s,s))}function TV(s,l,f){var g=s.pingCache;g!==null&&g.delete(l),s.pingedLanes|=s.suspendedLanes&f,s.warmLanes&=~f,Kt===s&&(bt&f)===f&&(mn===4||mn===3&&(bt&62914560)===bt&&300>ft()-Jg?(Mt&2)===0&&bu(s,0):jb|=f,vu===bt&&(vu=0)),Ia(s)}function _C(s,l){l===0&&(l=tg()),s=Al(s,l),s!==null&&(fl(s,l),Ia(s))}function AV(s){var l=s.memoizedState,f=0;l!==null&&(f=l.retryLane),_C(s,f)}function CV(s,l){var f=0;switch(s.tag){case 31:case 13:var g=s.stateNode,x=s.memoizedState;x!==null&&(f=x.retryLane);break;case 19:g=s.stateNode;break;case 22:g=s.stateNode._retryCache;break;default:throw Error(r(314))}g!==null&&g.delete(l),_C(s,f)}function IV(s,l){return Be(s,l)}var sm=null,_u=null,qb=!1,om=!1,$b=!1,mo=0;function Ia(s){s!==_u&&s.next===null&&(_u===null?sm=_u=s:_u=_u.next=s),om=!0,qb||(qb=!0,DV())}function jf(s,l){if(!$b&&om){$b=!0;do for(var f=!1,g=sm;g!==null;){if(s!==0){var x=g.pendingLanes;if(x===0)var E=0;else{var M=g.suspendedLanes,F=g.pingedLanes;E=(1<<31-sn(42|s)+1)-1,E&=x&~(M&~F),E=E&201326741?E&201326741|1:E?E|2:0}E!==0&&(f=!0,TC(g,E))}else E=bt,E=ui(g,g===Kt?E:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(E&3)===0||_r(g,E)||(f=!0,TC(g,E));g=g.next}while(f);$b=!1}}function RV(){wC()}function wC(){om=qb=!1;var s=0;mo!==0&&BV()&&(s=mo);for(var l=ft(),f=null,g=sm;g!==null;){var x=g.next,E=EC(g,l);E===0?(g.next=null,f===null?sm=x:f.next=x,x===null&&(_u=f)):(f=g,(s!==0||(E&3)!==0)&&(om=!0)),g=x}Gn!==0&&Gn!==5||jf(s),mo!==0&&(mo=0)}function EC(s,l){for(var f=s.suspendedLanes,g=s.pingedLanes,x=s.expirationTimes,E=s.pendingLanes&-62914561;0<E;){var M=31-sn(E),F=1<<M,Q=x[M];Q===-1?((F&f)===0||(F&g)!==0)&&(x[M]=xy(F,l)):Q<=l&&(s.expiredLanes|=F),E&=~F}if(l=Kt,f=bt,f=ui(s,s===l?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g=s.callbackNode,f===0||s===l&&(jt===2||jt===9)||s.cancelPendingCommit!==null)return g!==null&&g!==null&&lt(g),s.callbackNode=null,s.callbackPriority=0;if((f&3)===0||_r(s,f)){if(l=f&-f,l===s.callbackPriority)return l;switch(g!==null&&lt(g),Za(f)){case 2:case 8:f=Ut;break;case 32:f=Cn;break;case 268435456:f=ua;break;default:f=Cn}return g=SC.bind(null,s),f=Be(f,g),s.callbackPriority=l,s.callbackNode=f,l}return g!==null&&g!==null&&lt(g),s.callbackPriority=2,s.callbackNode=null,2}function SC(s,l){if(Gn!==0&&Gn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var f=s.callbackNode;if(am()&&s.callbackNode!==f)return null;var g=bt;return g=ui(s,s===Kt?g:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g===0?null:(aC(s,g,l),EC(s,ft()),s.callbackNode!=null&&s.callbackNode===f?SC.bind(null,s):null)}function TC(s,l){if(am())return null;aC(s,l,!0)}function DV(){FV(function(){(Mt&6)!==0?Be(pn,RV):wC()})}function Hb(){if(mo===0){var s=su;s===0&&(s=mt,mt<<=1,(mt&261888)===0&&(mt=256)),mo=s}return mo}function AC(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:$c(""+s)}function CC(s,l){var f=l.ownerDocument.createElement("input");return f.name=l.name,f.value=l.value,s.id&&f.setAttribute("form",s.id),l.parentNode.insertBefore(f,l),s=new FormData(s),f.parentNode.removeChild(f),s}function kV(s,l,f,g,x){if(l==="submit"&&f&&f.stateNode===x){var E=AC((x[Qn]||null).action),M=g.submitter;M&&(l=(l=M[Qn]||null)?AC(l.formAction):M.getAttribute("formAction"),l!==null&&(E=l,M=null));var F=new _a("action","action",null,g,x);s.push({event:F,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(mo!==0){var Q=M?CC(x,M):new FormData(x);fb(f,{pending:!0,data:Q,method:x.method,action:E},null,Q)}}else typeof E=="function"&&(F.preventDefault(),Q=M?CC(x,M):new FormData(x),fb(f,{pending:!0,data:Q,method:x.method,action:E},E,Q))},currentTarget:x}]})}}for(var Yb=0;Yb<Ry.length;Yb++){var Kb=Ry[Yb],NV=Kb.toLowerCase(),MV=Kb[0].toUpperCase()+Kb.slice(1);qi(NV,"on"+MV)}qi(iT,"onAnimationEnd"),qi(aT,"onAnimationIteration"),qi(sT,"onAnimationStart"),qi("dblclick","onDoubleClick"),qi("focusin","onFocus"),qi("focusout","onBlur"),qi(X5,"onTransitionRun"),qi(W5,"onTransitionStart"),qi(Q5,"onTransitionCancel"),qi(oT,"onTransitionEnd"),va("onMouseEnter",["mouseout","mouseover"]),va("onMouseLeave",["mouseout","mouseover"]),va("onPointerEnter",["pointerout","pointerover"]),va("onPointerLeave",["pointerout","pointerover"]),ma("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ma("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ma("onBeforeInput",["compositionend","keypress","textInput","paste"]),ma("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ma("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ma("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),PV=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Vf));function IC(s,l){l=(l&4)!==0;for(var f=0;f<s.length;f++){var g=s[f],x=g.event;g=g.listeners;e:{var E=void 0;if(l)for(var M=g.length-1;0<=M;M--){var F=g[M],Q=F.instance,ce=F.currentTarget;if(F=F.listener,Q!==E&&x.isPropagationStopped())break e;E=F,x.currentTarget=ce;try{E(x)}catch(ve){wg(ve)}x.currentTarget=null,E=Q}else for(M=0;M<g.length;M++){if(F=g[M],Q=F.instance,ce=F.currentTarget,F=F.listener,Q!==E&&x.isPropagationStopped())break e;E=F,x.currentTarget=ce;try{E(x)}catch(ve){wg(ve)}x.currentTarget=null,E=Q}}}}function yt(s,l){var f=l[Bc];f===void 0&&(f=l[Bc]=new Set);var g=s+"__bubble";f.has(g)||(RC(l,s,2,!1),f.add(g))}function Xb(s,l,f){var g=0;l&&(g|=4),RC(f,s,g,l)}var lm="_reactListening"+Math.random().toString(36).slice(2);function Wb(s){if(!s[lm]){s[lm]=!0,Kd.forEach(function(f){f!=="selectionchange"&&(PV.has(f)||Xb(f,!1,s),Xb(f,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[lm]||(l[lm]=!0,Xb("selectionchange",!1,l))}}function RC(s,l,f,g){switch(i2(l)){case 2:var x=lz;break;case 8:x=cz;break;default:x=dx}f=x.bind(null,l,f,s),x=void 0,!yl||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(x=!0),g?x!==void 0?s.addEventListener(l,f,{capture:!0,passive:x}):s.addEventListener(l,f,!0):x!==void 0?s.addEventListener(l,f,{passive:x}):s.addEventListener(l,f,!1)}function Qb(s,l,f,g,x){var E=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var M=g.tag;if(M===3||M===4){var F=g.stateNode.containerInfo;if(F===x)break;if(M===4)for(M=g.return;M!==null;){var Q=M.tag;if((Q===3||Q===4)&&M.stateNode.containerInfo===x)return;M=M.return}for(;F!==null;){if(M=pa(F),M===null)return;if(Q=M.tag,Q===5||Q===6||Q===26||Q===27){g=E=M;continue e}F=F.parentNode}}g=g.return}Ws(function(){var ce=E,ve=fi(f),xe=[];e:{var de=lT.get(s);if(de!==void 0){var ge=_a,je=s;switch(s){case"keypress":if(xl(f)===0)break e;case"keydown":case"keyup":ge=bg;break;case"focusin":je="focus",ge=wl;break;case"focusout":je="blur",ge=wl;break;case"beforeblur":case"afterblur":ge=wl;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=lf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=ug;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=D;break;case iT:case aT:case sT:ge=fg;break;case oT:ge=q;break;case"scroll":case"scrollend":ge=of;break;case"wheel":ge=pe;break;case"copy":case"cut":case"paste":ge=hg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=ts;break;case"toggle":case"beforetoggle":ge=ct}var Qe=(l&4)!==0,$t=!Qe&&(s==="scroll"||s==="scrollend"),ie=Qe?de!==null?de+"Capture":null:de;Qe=[];for(var ne=ce,le;ne!==null;){var ye=ne;if(le=ye.stateNode,ye=ye.tag,ye!==5&&ye!==26&&ye!==27||le===null||ie===null||(ye=Bi(ne,ie),ye!=null&&Qe.push(zf(ne,ye,le))),$t)break;ne=ne.return}0<Qe.length&&(de=new ge(de,je,null,f,ve),xe.push({event:de,listeners:Qe}))}}if((l&7)===0){e:{if(de=s==="mouseover"||s==="pointerover",ge=s==="mouseout"||s==="pointerout",de&&f!==rf&&(je=f.relatedTarget||f.fromElement)&&(pa(je)||je[fa]))break e;if((ge||de)&&(de=ve.window===ve?ve:(de=ve.ownerDocument)?de.defaultView||de.parentWindow:window,ge?(je=f.relatedTarget||f.toElement,ge=ce,je=je?pa(je):null,je!==null&&($t=a(je),Qe=je.tag,je!==$t||Qe!==5&&Qe!==27&&Qe!==6)&&(je=null)):(ge=null,je=ce),ge!==je)){if(Qe=lf,ye="onMouseLeave",ie="onMouseEnter",ne="mouse",(s==="pointerout"||s==="pointerover")&&(Qe=ts,ye="onPointerLeave",ie="onPointerEnter",ne="pointer"),$t=ge==null?de:Xr(ge),le=je==null?de:Xr(je),de=new Qe(ye,ne+"leave",ge,f,ve),de.target=$t,de.relatedTarget=le,ye=null,pa(ve)===ce&&(Qe=new Qe(ie,ne+"enter",je,f,ve),Qe.target=le,Qe.relatedTarget=$t,ye=Qe),$t=ye,ge&&je)t:{for(Qe=OV,ie=ge,ne=je,le=0,ye=ie;ye;ye=Qe(ye))le++;ye=0;for(var Ye=ne;Ye;Ye=Qe(Ye))ye++;for(;0<le-ye;)ie=Qe(ie),le--;for(;0<ye-le;)ne=Qe(ne),ye--;for(;le--;){if(ie===ne||ne!==null&&ie===ne.alternate){Qe=ie;break t}ie=Qe(ie),ne=Qe(ne)}Qe=null}else Qe=null;ge!==null&&DC(xe,de,ge,Qe,!1),je!==null&&$t!==null&&DC(xe,$t,je,Qe,!0)}}e:{if(de=ce?Xr(ce):window,ge=de.nodeName&&de.nodeName.toLowerCase(),ge==="select"||ge==="input"&&de.type==="file")var Rt=YS;else if($S(de))if(KS)Rt=H5;else{Rt=q5;var Ue=G5}else ge=de.nodeName,!ge||ge.toLowerCase()!=="input"||de.type!=="checkbox"&&de.type!=="radio"?ce&&qc(ce.elementType)&&(Rt=YS):Rt=$5;if(Rt&&(Rt=Rt(s,ce))){HS(xe,Rt,f,ve);break e}Ue&&Ue(s,de,ce),s==="focusout"&&ce&&de.type==="number"&&ce.memoizedProps.value!=null&&ef(de,"number",de.value)}switch(Ue=ce?Xr(ce):window,s){case"focusin":($S(Ue)||Ue.contentEditable==="true")&&(Zc=Ue,Ay=ce,hf=null);break;case"focusout":hf=Ay=Zc=null;break;case"mousedown":Cy=!0;break;case"contextmenu":case"mouseup":case"dragend":Cy=!1,nT(xe,f,ve);break;case"selectionchange":if(K5)break;case"keydown":case"keyup":nT(xe,f,ve)}var ht;if(Nt)e:{switch(s){case"compositionstart":var xt="onCompositionStart";break e;case"compositionend":xt="onCompositionEnd";break e;case"compositionupdate":xt="onCompositionUpdate";break e}xt=void 0}else Qc?El(s,f)&&(xt="onCompositionEnd"):s==="keydown"&&f.keyCode===229&&(xt="onCompositionStart");xt&&(Sa&&f.locale!=="ko"&&(Qc||xt!=="onCompositionStart"?xt==="onCompositionEnd"&&Qc&&(ht=sf()):(xa=ve,af="value"in xa?xa.value:xa.textContent,Qc=!0)),Ue=cm(ce,xt),0<Ue.length&&(xt=new Ea(xt,s,null,f,ve),xe.push({event:xt,listeners:Ue}),ht?xt.data=ht:(ht=Wc(f),ht!==null&&(xt.data=ht)))),(ht=pi?L5(s,f):B5(s,f))&&(xt=cm(ce,"onBeforeInput"),0<xt.length&&(Ue=new Ea("onBeforeInput","beforeinput",null,f,ve),xe.push({event:Ue,listeners:xt}),Ue.data=ht)),kV(xe,s,ce,f,ve)}IC(xe,l)})}function zf(s,l,f){return{instance:s,listener:l,currentTarget:f}}function cm(s,l){for(var f=l+"Capture",g=[];s!==null;){var x=s,E=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||E===null||(x=Bi(s,f),x!=null&&g.unshift(zf(s,x,E)),x=Bi(s,l),x!=null&&g.push(zf(s,x,E))),s.tag===3)return g;s=s.return}return[]}function OV(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function DC(s,l,f,g,x){for(var E=l._reactName,M=[];f!==null&&f!==g;){var F=f,Q=F.alternate,ce=F.stateNode;if(F=F.tag,Q!==null&&Q===g)break;F!==5&&F!==26&&F!==27||ce===null||(Q=ce,x?(ce=Bi(f,E),ce!=null&&M.unshift(zf(f,ce,Q))):x||(ce=Bi(f,E),ce!=null&&M.push(zf(f,ce,Q)))),f=f.return}M.length!==0&&s.push({event:l,listeners:M})}var jV=/\r\n?/g,VV=/\u0000|\uFFFD/g;function kC(s){return(typeof s=="string"?s:""+s).replace(jV,`
`).replace(VV,"")}function NC(s,l){return l=kC(l),kC(s)===l}function qt(s,l,f,g,x,E){switch(f){case"children":typeof g=="string"?l==="body"||l==="textarea"&&g===""||Mr(s,g):(typeof g=="number"||typeof g=="bigint")&&l!=="body"&&Mr(s,""+g);break;case"className":Wr(s,"class",g);break;case"tabIndex":Wr(s,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":Wr(s,f,g);break;case"style":nf(s,g,E);break;case"data":if(l!=="object"){Wr(s,"data",g);break}case"src":case"href":if(g===""&&(l!=="a"||f!=="href")){s.removeAttribute(f);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(f);break}g=$c(""+g),s.setAttribute(f,g);break;case"action":case"formAction":if(typeof g=="function"){s.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(f==="formAction"?(l!=="input"&&qt(s,l,"name",x.name,x,null),qt(s,l,"formEncType",x.formEncType,x,null),qt(s,l,"formMethod",x.formMethod,x,null),qt(s,l,"formTarget",x.formTarget,x,null)):(qt(s,l,"encType",x.encType,x,null),qt(s,l,"method",x.method,x,null),qt(s,l,"target",x.target,x,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(f);break}g=$c(""+g),s.setAttribute(f,g);break;case"onClick":g!=null&&(s.onclick=Li);break;case"onScroll":g!=null&&yt("scroll",s);break;case"onScrollEnd":g!=null&&yt("scrollend",s);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"multiple":s.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":s.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){s.removeAttribute("xlink:href");break}f=$c(""+g),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,""+g):s.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,""):s.removeAttribute(f);break;case"capture":case"download":g===!0?s.setAttribute(f,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,g):s.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?s.setAttribute(f,g):s.removeAttribute(f);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?s.removeAttribute(f):s.setAttribute(f,g);break;case"popover":yt("beforetoggle",s),yt("toggle",s),Fc(s,"popover",g);break;case"xlinkActuate":kn(s,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":kn(s,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":kn(s,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":kn(s,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":kn(s,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":kn(s,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":kn(s,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":kn(s,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":kn(s,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":Fc(s,"is",g);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=cg.get(f)||f,Fc(s,f,g))}}function Zb(s,l,f,g,x,E){switch(f){case"style":nf(s,g,E);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"children":typeof g=="string"?Mr(s,g):(typeof g=="number"||typeof g=="bigint")&&Mr(s,""+g);break;case"onScroll":g!=null&&yt("scroll",s);break;case"onScrollEnd":g!=null&&yt("scrollend",s);break;case"onClick":g!=null&&(s.onclick=Li);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Xd.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(x=f.endsWith("Capture"),l=f.slice(2,x?f.length-7:void 0),E=s[Qn]||null,E=E!=null?E[f]:null,typeof E=="function"&&s.removeEventListener(l,E,x),typeof g=="function")){typeof E!="function"&&E!==null&&(f in s?s[f]=null:s.hasAttribute(f)&&s.removeAttribute(f)),s.addEventListener(l,g,x);break e}f in s?s[f]=g:g===!0?s.setAttribute(f,""):Fc(s,f,g)}}}function ar(s,l,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":yt("error",s),yt("load",s);var g=!1,x=!1,E;for(E in f)if(f.hasOwnProperty(E)){var M=f[E];if(M!=null)switch(E){case"src":g=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:qt(s,l,E,M,f,null)}}x&&qt(s,l,"srcSet",f.srcSet,f,null),g&&qt(s,l,"src",f.src,f,null);return;case"input":yt("invalid",s);var F=E=M=x=null,Q=null,ce=null;for(g in f)if(f.hasOwnProperty(g)){var ve=f[g];if(ve!=null)switch(g){case"name":x=ve;break;case"type":M=ve;break;case"checked":Q=ve;break;case"defaultChecked":ce=ve;break;case"value":E=ve;break;case"defaultValue":F=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(r(137,l));break;default:qt(s,l,g,ve,f,null)}}sg(s,E,F,Q,ce,M,x,!1);return;case"select":yt("invalid",s),g=M=E=null;for(x in f)if(f.hasOwnProperty(x)&&(F=f[x],F!=null))switch(x){case"value":E=F;break;case"defaultValue":M=F;break;case"multiple":g=F;default:qt(s,l,x,F,f,null)}l=E,f=M,s.multiple=!!g,l!=null?Hs(s,!!g,l,!1):f!=null&&Hs(s,!!g,f,!0);return;case"textarea":yt("invalid",s),E=x=g=null;for(M in f)if(f.hasOwnProperty(M)&&(F=f[M],F!=null))switch(M){case"value":g=F;break;case"defaultValue":x=F;break;case"children":E=F;break;case"dangerouslySetInnerHTML":if(F!=null)throw Error(r(91));break;default:qt(s,l,M,F,f,null)}Ys(s,g,x,E);return;case"option":for(Q in f)if(f.hasOwnProperty(Q)&&(g=f[Q],g!=null))switch(Q){case"selected":s.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:qt(s,l,Q,g,f,null)}return;case"dialog":yt("beforetoggle",s),yt("toggle",s),yt("cancel",s),yt("close",s);break;case"iframe":case"object":yt("load",s);break;case"video":case"audio":for(g=0;g<Vf.length;g++)yt(Vf[g],s);break;case"image":yt("error",s),yt("load",s);break;case"details":yt("toggle",s);break;case"embed":case"source":case"link":yt("error",s),yt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ce in f)if(f.hasOwnProperty(ce)&&(g=f[ce],g!=null))switch(ce){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:qt(s,l,ce,g,f,null)}return;default:if(qc(l)){for(ve in f)f.hasOwnProperty(ve)&&(g=f[ve],g!==void 0&&Zb(s,l,ve,g,f,void 0));return}}for(F in f)f.hasOwnProperty(F)&&(g=f[F],g!=null&&qt(s,l,F,g,f,null))}function zV(s,l,f,g){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,E=null,M=null,F=null,Q=null,ce=null,ve=null;for(ge in f){var xe=f[ge];if(f.hasOwnProperty(ge)&&xe!=null)switch(ge){case"checked":break;case"value":break;case"defaultValue":Q=xe;default:g.hasOwnProperty(ge)||qt(s,l,ge,null,g,xe)}}for(var de in g){var ge=g[de];if(xe=f[de],g.hasOwnProperty(de)&&(ge!=null||xe!=null))switch(de){case"type":E=ge;break;case"name":x=ge;break;case"checked":ce=ge;break;case"defaultChecked":ve=ge;break;case"value":M=ge;break;case"defaultValue":F=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(r(137,l));break;default:ge!==xe&&qt(s,l,de,ge,g,xe)}}Gc(s,M,F,Q,ce,ve,E,x);return;case"select":ge=M=F=de=null;for(E in f)if(Q=f[E],f.hasOwnProperty(E)&&Q!=null)switch(E){case"value":break;case"multiple":ge=Q;default:g.hasOwnProperty(E)||qt(s,l,E,null,g,Q)}for(x in g)if(E=g[x],Q=f[x],g.hasOwnProperty(x)&&(E!=null||Q!=null))switch(x){case"value":de=E;break;case"defaultValue":F=E;break;case"multiple":M=E;default:E!==Q&&qt(s,l,x,E,g,Q)}l=F,f=M,g=ge,de!=null?Hs(s,!!f,de,!1):!!g!=!!f&&(l!=null?Hs(s,!!f,l,!0):Hs(s,!!f,f?[]:"",!1));return;case"textarea":ge=de=null;for(F in f)if(x=f[F],f.hasOwnProperty(F)&&x!=null&&!g.hasOwnProperty(F))switch(F){case"value":break;case"children":break;default:qt(s,l,F,null,g,x)}for(M in g)if(x=g[M],E=f[M],g.hasOwnProperty(M)&&(x!=null||E!=null))switch(M){case"value":de=x;break;case"defaultValue":ge=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==E&&qt(s,l,M,x,g,E)}og(s,de,ge);return;case"option":for(var je in f)if(de=f[je],f.hasOwnProperty(je)&&de!=null&&!g.hasOwnProperty(je))switch(je){case"selected":s.selected=!1;break;default:qt(s,l,je,null,g,de)}for(Q in g)if(de=g[Q],ge=f[Q],g.hasOwnProperty(Q)&&de!==ge&&(de!=null||ge!=null))switch(Q){case"selected":s.selected=de&&typeof de!="function"&&typeof de!="symbol";break;default:qt(s,l,Q,de,g,ge)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Qe in f)de=f[Qe],f.hasOwnProperty(Qe)&&de!=null&&!g.hasOwnProperty(Qe)&&qt(s,l,Qe,null,g,de);for(ce in g)if(de=g[ce],ge=f[ce],g.hasOwnProperty(ce)&&de!==ge&&(de!=null||ge!=null))switch(ce){case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(r(137,l));break;default:qt(s,l,ce,de,g,ge)}return;default:if(qc(l)){for(var $t in f)de=f[$t],f.hasOwnProperty($t)&&de!==void 0&&!g.hasOwnProperty($t)&&Zb(s,l,$t,void 0,g,de);for(ve in g)de=g[ve],ge=f[ve],!g.hasOwnProperty(ve)||de===ge||de===void 0&&ge===void 0||Zb(s,l,ve,de,g,ge);return}}for(var ie in f)de=f[ie],f.hasOwnProperty(ie)&&de!=null&&!g.hasOwnProperty(ie)&&qt(s,l,ie,null,g,de);for(xe in g)de=g[xe],ge=f[xe],!g.hasOwnProperty(xe)||de===ge||de==null&&ge==null||qt(s,l,xe,de,g,ge)}function MC(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function LV(){if(typeof performance.getEntriesByType=="function"){for(var s=0,l=0,f=performance.getEntriesByType("resource"),g=0;g<f.length;g++){var x=f[g],E=x.transferSize,M=x.initiatorType,F=x.duration;if(E&&F&&MC(M)){for(M=0,F=x.responseEnd,g+=1;g<f.length;g++){var Q=f[g],ce=Q.startTime;if(ce>F)break;var ve=Q.transferSize,xe=Q.initiatorType;ve&&MC(xe)&&(Q=Q.responseEnd,M+=ve*(Q<F?1:(F-ce)/(Q-ce)))}if(--g,l+=8*(E+M)/(x.duration/1e3),s++,10<s)break}}if(0<s)return l/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Jb=null,ex=null;function um(s){return s.nodeType===9?s:s.ownerDocument}function PC(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function OC(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function tx(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var nx=null;function BV(){var s=window.event;return s&&s.type==="popstate"?s===nx?!1:(nx=s,!0):(nx=null,!1)}var jC=typeof setTimeout=="function"?setTimeout:void 0,UV=typeof clearTimeout=="function"?clearTimeout:void 0,VC=typeof Promise=="function"?Promise:void 0,FV=typeof queueMicrotask=="function"?queueMicrotask:typeof VC<"u"?function(s){return VC.resolve(null).then(s).catch(GV)}:jC;function GV(s){setTimeout(function(){throw s})}function vo(s){return s==="head"}function zC(s,l){var f=l,g=0;do{var x=f.nextSibling;if(s.removeChild(f),x&&x.nodeType===8)if(f=x.data,f==="/$"||f==="/&"){if(g===0){s.removeChild(x),Tu(l);return}g--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")g++;else if(f==="html")Lf(s.ownerDocument.documentElement);else if(f==="head"){f=s.ownerDocument.head,Lf(f);for(var E=f.firstChild;E;){var M=E.nextSibling,F=E.nodeName;E[ha]||F==="SCRIPT"||F==="STYLE"||F==="LINK"&&E.rel.toLowerCase()==="stylesheet"||f.removeChild(E),E=M}}else f==="body"&&Lf(s.ownerDocument.body);f=x}while(f);Tu(l)}function LC(s,l){var f=s;s=0;do{var g=f.nextSibling;if(f.nodeType===1?l?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(l?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),g&&g.nodeType===8)if(f=g.data,f==="/$"){if(s===0)break;s--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||s++;f=g}while(f)}function rx(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var f=l;switch(l=l.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":rx(f),Uc(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}s.removeChild(f)}}function qV(s,l,f,g){for(;s.nodeType===1;){var x=f;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!g&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(g){if(!s[ha])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(E=s.getAttribute("rel"),E==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(E!==x.rel||s.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||s.getAttribute("title")!==(x.title==null?null:x.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(E=s.getAttribute("src"),(E!==(x.src==null?null:x.src)||s.getAttribute("type")!==(x.type==null?null:x.type)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&E&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var E=x.name==null?null:""+x.name;if(x.type==="hidden"&&s.getAttribute("name")===E)return s}else return s;if(s=_i(s.nextSibling),s===null)break}return null}function $V(s,l,f){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!f||(s=_i(s.nextSibling),s===null))return null;return s}function BC(s,l){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=_i(s.nextSibling),s===null))return null;return s}function ix(s){return s.data==="$?"||s.data==="$~"}function ax(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function HV(s,l){var f=s.ownerDocument;if(s.data==="$~")s._reactRetry=l;else if(s.data!=="$?"||f.readyState!=="loading")l();else{var g=function(){l(),f.removeEventListener("DOMContentLoaded",g)};f.addEventListener("DOMContentLoaded",g),s._reactRetry=g}}function _i(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return s}var sx=null;function UC(s){s=s.nextSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="/$"||f==="/&"){if(l===0)return _i(s.nextSibling);l--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||l++}s=s.nextSibling}return null}function FC(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(l===0)return s;l--}else f!=="/$"&&f!=="/&"||l++}s=s.previousSibling}return null}function GC(s,l,f){switch(l=um(f),s){case"html":if(s=l.documentElement,!s)throw Error(r(452));return s;case"head":if(s=l.head,!s)throw Error(r(453));return s;case"body":if(s=l.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function Lf(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);Uc(s)}var wi=new Map,qC=new Set;function dm(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ms=W.d;W.d={f:YV,r:KV,D:XV,C:WV,L:QV,m:ZV,X:ez,S:JV,M:tz};function YV(){var s=ms.f(),l=nm();return s||l}function KV(s){var l=di(s);l!==null&&l.tag===5&&l.type==="form"?oA(l):ms.r(s)}var wu=typeof document>"u"?null:document;function $C(s,l,f){var g=wu;if(g&&typeof l=="string"&&l){var x=Nr(l);x='link[rel="'+s+'"][href="'+x+'"]',typeof f=="string"&&(x+='[crossorigin="'+f+'"]'),qC.has(x)||(qC.add(x),s={rel:s,crossOrigin:f,href:l},g.querySelector(x)===null&&(l=g.createElement("link"),ar(l,"link",s),Dn(l),g.head.appendChild(l)))}}function XV(s){ms.D(s),$C("dns-prefetch",s,null)}function WV(s,l){ms.C(s,l),$C("preconnect",s,l)}function QV(s,l,f){ms.L(s,l,f);var g=wu;if(g&&s&&l){var x='link[rel="preload"][as="'+Nr(l)+'"]';l==="image"&&f&&f.imageSrcSet?(x+='[imagesrcset="'+Nr(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(x+='[imagesizes="'+Nr(f.imageSizes)+'"]')):x+='[href="'+Nr(s)+'"]';var E=x;switch(l){case"style":E=Eu(s);break;case"script":E=Su(s)}wi.has(E)||(s=p({rel:"preload",href:l==="image"&&f&&f.imageSrcSet?void 0:s,as:l},f),wi.set(E,s),g.querySelector(x)!==null||l==="style"&&g.querySelector(Bf(E))||l==="script"&&g.querySelector(Uf(E))||(l=g.createElement("link"),ar(l,"link",s),Dn(l),g.head.appendChild(l)))}}function ZV(s,l){ms.m(s,l);var f=wu;if(f&&s){var g=l&&typeof l.as=="string"?l.as:"script",x='link[rel="modulepreload"][as="'+Nr(g)+'"][href="'+Nr(s)+'"]',E=x;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=Su(s)}if(!wi.has(E)&&(s=p({rel:"modulepreload",href:s},l),wi.set(E,s),f.querySelector(x)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Uf(E)))return}g=f.createElement("link"),ar(g,"link",s),Dn(g),f.head.appendChild(g)}}}function JV(s,l,f){ms.S(s,l,f);var g=wu;if(g&&s){var x=ga(g).hoistableStyles,E=Eu(s);l=l||"default";var M=x.get(E);if(!M){var F={loading:0,preload:null};if(M=g.querySelector(Bf(E)))F.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":l},f),(f=wi.get(E))&&ox(s,f);var Q=M=g.createElement("link");Dn(Q),ar(Q,"link",s),Q._p=new Promise(function(ce,ve){Q.onload=ce,Q.onerror=ve}),Q.addEventListener("load",function(){F.loading|=1}),Q.addEventListener("error",function(){F.loading|=2}),F.loading|=4,fm(M,l,g)}M={type:"stylesheet",instance:M,count:1,state:F},x.set(E,M)}}}function ez(s,l){ms.X(s,l);var f=wu;if(f&&s){var g=ga(f).hoistableScripts,x=Su(s),E=g.get(x);E||(E=f.querySelector(Uf(x)),E||(s=p({src:s,async:!0},l),(l=wi.get(x))&&lx(s,l),E=f.createElement("script"),Dn(E),ar(E,"link",s),f.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},g.set(x,E))}}function tz(s,l){ms.M(s,l);var f=wu;if(f&&s){var g=ga(f).hoistableScripts,x=Su(s),E=g.get(x);E||(E=f.querySelector(Uf(x)),E||(s=p({src:s,async:!0,type:"module"},l),(l=wi.get(x))&&lx(s,l),E=f.createElement("script"),Dn(E),ar(E,"link",s),f.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},g.set(x,E))}}function HC(s,l,f,g){var x=(x=fe.current)?dm(x):null;if(!x)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(l=Eu(f.href),f=ga(x).hoistableStyles,g=f.get(l),g||(g={type:"style",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){s=Eu(f.href);var E=ga(x).hoistableStyles,M=E.get(s);if(M||(x=x.ownerDocument||x,M={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(s,M),(E=x.querySelector(Bf(s)))&&!E._p&&(M.instance=E,M.state.loading=5),wi.has(s)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},wi.set(s,f),E||nz(x,s,f,M.state))),l&&g===null)throw Error(r(528,""));return M}if(l&&g!==null)throw Error(r(529,""));return null;case"script":return l=f.async,f=f.src,typeof f=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Su(f),f=ga(x).hoistableScripts,g=f.get(l),g||(g={type:"script",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Eu(s){return'href="'+Nr(s)+'"'}function Bf(s){return'link[rel="stylesheet"]['+s+"]"}function YC(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function nz(s,l,f,g){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?g.loading=1:(l=s.createElement("link"),g.preload=l,l.addEventListener("load",function(){return g.loading|=1}),l.addEventListener("error",function(){return g.loading|=2}),ar(l,"link",f),Dn(l),s.head.appendChild(l))}function Su(s){return'[src="'+Nr(s)+'"]'}function Uf(s){return"script[async]"+s}function KC(s,l,f){if(l.count++,l.instance===null)switch(l.type){case"style":var g=s.querySelector('style[data-href~="'+Nr(f.href)+'"]');if(g)return l.instance=g,Dn(g),g;var x=p({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return g=(s.ownerDocument||s).createElement("style"),Dn(g),ar(g,"style",x),fm(g,f.precedence,s),l.instance=g;case"stylesheet":x=Eu(f.href);var E=s.querySelector(Bf(x));if(E)return l.state.loading|=4,l.instance=E,Dn(E),E;g=YC(f),(x=wi.get(x))&&ox(g,x),E=(s.ownerDocument||s).createElement("link"),Dn(E);var M=E;return M._p=new Promise(function(F,Q){M.onload=F,M.onerror=Q}),ar(E,"link",g),l.state.loading|=4,fm(E,f.precedence,s),l.instance=E;case"script":return E=Su(f.src),(x=s.querySelector(Uf(E)))?(l.instance=x,Dn(x),x):(g=f,(x=wi.get(E))&&(g=p({},f),lx(g,x)),s=s.ownerDocument||s,x=s.createElement("script"),Dn(x),ar(x,"link",g),s.head.appendChild(x),l.instance=x);case"void":return null;default:throw Error(r(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(g=l.instance,l.state.loading|=4,fm(g,f.precedence,s));return l.instance}function fm(s,l,f){for(var g=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=g.length?g[g.length-1]:null,E=x,M=0;M<g.length;M++){var F=g[M];if(F.dataset.precedence===l)E=F;else if(E!==x)break}E?E.parentNode.insertBefore(s,E.nextSibling):(l=f.nodeType===9?f.head:f,l.insertBefore(s,l.firstChild))}function ox(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function lx(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var hm=null;function XC(s,l,f){if(hm===null){var g=new Map,x=hm=new Map;x.set(f,g)}else x=hm,g=x.get(f),g||(g=new Map,x.set(f,g));if(g.has(s))return g;for(g.set(s,null),f=f.getElementsByTagName(s),x=0;x<f.length;x++){var E=f[x];if(!(E[ha]||E[Rn]||s==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var M=E.getAttribute(l)||"";M=s+M;var F=g.get(M);F?F.push(E):g.set(M,[E])}}return g}function WC(s,l,f){s=s.ownerDocument||s,s.head.insertBefore(f,l==="title"?s.querySelector("head > title"):null)}function rz(s,l,f){if(f===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return s=l.disabled,typeof l.precedence=="string"&&s==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function QC(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function iz(s,l,f,g){if(f.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var x=Eu(g.href),E=l.querySelector(Bf(x));if(E){l=E._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(s.count++,s=pm.bind(s),l.then(s,s)),f.state.loading|=4,f.instance=E,Dn(E);return}E=l.ownerDocument||l,g=YC(g),(x=wi.get(x))&&ox(g,x),E=E.createElement("link"),Dn(E);var M=E;M._p=new Promise(function(F,Q){M.onload=F,M.onerror=Q}),ar(E,"link",g),f.instance=E}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(f,l),(l=f.state.preload)&&(f.state.loading&3)===0&&(s.count++,f=pm.bind(s),l.addEventListener("load",f),l.addEventListener("error",f))}}var cx=0;function az(s,l){return s.stylesheets&&s.count===0&&mm(s,s.stylesheets),0<s.count||0<s.imgCount?function(f){var g=setTimeout(function(){if(s.stylesheets&&mm(s,s.stylesheets),s.unsuspend){var E=s.unsuspend;s.unsuspend=null,E()}},6e4+l);0<s.imgBytes&&cx===0&&(cx=62500*LV());var x=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&mm(s,s.stylesheets),s.unsuspend)){var E=s.unsuspend;s.unsuspend=null,E()}},(s.imgBytes>cx?50:800)+l);return s.unsuspend=f,function(){s.unsuspend=null,clearTimeout(g),clearTimeout(x)}}:null}function pm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)mm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var gm=null;function mm(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,gm=new Map,l.forEach(sz,s),gm=null,pm.call(s))}function sz(s,l){if(!(l.state.loading&4)){var f=gm.get(s);if(f)var g=f.get(null);else{f=new Map,gm.set(s,f);for(var x=s.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<x.length;E++){var M=x[E];(M.nodeName==="LINK"||M.getAttribute("media")!=="not all")&&(f.set(M.dataset.precedence,M),g=M)}g&&f.set(null,g)}x=l.instance,M=x.getAttribute("data-precedence"),E=f.get(M)||g,E===g&&f.set(null,x),f.set(M,x),this.count++,g=pm.bind(this),x.addEventListener("load",g),x.addEventListener("error",g),E?E.parentNode.insertBefore(x,E.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(x,s.firstChild)),l.state.loading|=4}}var Ff={$$typeof:R,Provider:null,Consumer:null,_currentValue:ee,_currentValue2:ee,_threadCount:0};function oz(s,l,f,g,x,E,M,F,Q){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=da(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=da(0),this.hiddenUpdates=da(null),this.identifierPrefix=g,this.onUncaughtError=x,this.onCaughtError=E,this.onRecoverableError=M,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Q,this.incompleteTransitions=new Map}function ZC(s,l,f,g,x,E,M,F,Q,ce,ve,xe){return s=new oz(s,l,f,M,Q,ce,ve,xe,F),l=1,E===!0&&(l|=24),E=Zr(3,null,null,l),s.current=E,E.stateNode=s,l=Fy(),l.refCount++,s.pooledCache=l,l.refCount++,E.memoizedState={element:g,isDehydrated:f,cache:l},Hy(E),s}function JC(s){return s?(s=tu,s):tu}function e2(s,l,f,g,x,E){x=JC(x),g.context===null?g.context=x:g.pendingContext=x,g=ao(l),g.payload={element:f},E=E===void 0?null:E,E!==null&&(g.callback=E),f=so(s,g,l),f!==null&&(zr(f,s,l),xf(f,s,l))}function t2(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var f=s.retryLane;s.retryLane=f!==0&&f<l?f:l}}function ux(s,l){t2(s,l),(s=s.alternate)&&t2(s,l)}function n2(s){if(s.tag===13||s.tag===31){var l=Al(s,67108864);l!==null&&zr(l,s,67108864),ux(s,67108864)}}function r2(s){if(s.tag===13||s.tag===31){var l=ri();l=pl(l);var f=Al(s,l);f!==null&&zr(f,s,l),ux(s,l)}}var vm=!0;function lz(s,l,f,g){var x=$.T;$.T=null;var E=W.p;try{W.p=2,dx(s,l,f,g)}finally{W.p=E,$.T=x}}function cz(s,l,f,g){var x=$.T;$.T=null;var E=W.p;try{W.p=8,dx(s,l,f,g)}finally{W.p=E,$.T=x}}function dx(s,l,f,g){if(vm){var x=fx(g);if(x===null)Qb(s,l,g,ym,f),a2(s,g);else if(dz(x,s,l,f,g))g.stopPropagation();else if(a2(s,g),l&4&&-1<uz.indexOf(s)){for(;x!==null;){var E=di(x);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var M=Kr(E.pendingLanes);if(M!==0){var F=E;for(F.pendingLanes|=2,F.entangledLanes|=2;M;){var Q=1<<31-sn(M);F.entanglements[1]|=Q,M&=~Q}Ia(E),(Mt&6)===0&&(em=ft()+500,jf(0))}}break;case 31:case 13:F=Al(E,2),F!==null&&zr(F,E,2),nm(),ux(E,2)}if(E=fx(g),E===null&&Qb(s,l,g,ym,f),E===x)break;x=E}x!==null&&g.stopPropagation()}else Qb(s,l,g,null,f)}}function fx(s){return s=fi(s),hx(s)}var ym=null;function hx(s){if(ym=null,s=pa(s),s!==null){var l=a(s);if(l===null)s=null;else{var f=l.tag;if(f===13){if(s=o(l),s!==null)return s;s=null}else if(f===31){if(s=c(l),s!==null)return s;s=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return ym=s,null}function i2(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(kt()){case pn:return 2;case Ut:return 8;case Cn:case Hr:return 32;case ua:return 268435456;default:return 32}default:return 32}}var px=!1,yo=null,bo=null,xo=null,Gf=new Map,qf=new Map,_o=[],uz="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function a2(s,l){switch(s){case"focusin":case"focusout":yo=null;break;case"dragenter":case"dragleave":bo=null;break;case"mouseover":case"mouseout":xo=null;break;case"pointerover":case"pointerout":Gf.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":qf.delete(l.pointerId)}}function $f(s,l,f,g,x,E){return s===null||s.nativeEvent!==E?(s={blockedOn:l,domEventName:f,eventSystemFlags:g,nativeEvent:E,targetContainers:[x]},l!==null&&(l=di(l),l!==null&&n2(l)),s):(s.eventSystemFlags|=g,l=s.targetContainers,x!==null&&l.indexOf(x)===-1&&l.push(x),s)}function dz(s,l,f,g,x){switch(l){case"focusin":return yo=$f(yo,s,l,f,g,x),!0;case"dragenter":return bo=$f(bo,s,l,f,g,x),!0;case"mouseover":return xo=$f(xo,s,l,f,g,x),!0;case"pointerover":var E=x.pointerId;return Gf.set(E,$f(Gf.get(E)||null,s,l,f,g,x)),!0;case"gotpointercapture":return E=x.pointerId,qf.set(E,$f(qf.get(E)||null,s,l,f,g,x)),!0}return!1}function s2(s){var l=pa(s.target);if(l!==null){var f=a(l);if(f!==null){if(l=f.tag,l===13){if(l=o(f),l!==null){s.blockedOn=l,Vi(s.priority,function(){r2(f)});return}}else if(l===31){if(l=c(f),l!==null){s.blockedOn=l,Vi(s.priority,function(){r2(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){s.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}s.blockedOn=null}function bm(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var f=fx(s.nativeEvent);if(f===null){f=s.nativeEvent;var g=new f.constructor(f.type,f);rf=g,f.target.dispatchEvent(g),rf=null}else return l=di(f),l!==null&&n2(l),s.blockedOn=f,!1;l.shift()}return!0}function o2(s,l,f){bm(s)&&f.delete(l)}function fz(){px=!1,yo!==null&&bm(yo)&&(yo=null),bo!==null&&bm(bo)&&(bo=null),xo!==null&&bm(xo)&&(xo=null),Gf.forEach(o2),qf.forEach(o2)}function xm(s,l){s.blockedOn===l&&(s.blockedOn=null,px||(px=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,fz)))}var _m=null;function l2(s){_m!==s&&(_m=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){_m===s&&(_m=null);for(var l=0;l<s.length;l+=3){var f=s[l],g=s[l+1],x=s[l+2];if(typeof g!="function"){if(hx(g||f)===null)continue;break}var E=di(f);E!==null&&(s.splice(l,3),l-=3,fb(E,{pending:!0,data:x,method:f.method,action:g},g,x))}}))}function Tu(s){function l(Q){return xm(Q,s)}yo!==null&&xm(yo,s),bo!==null&&xm(bo,s),xo!==null&&xm(xo,s),Gf.forEach(l),qf.forEach(l);for(var f=0;f<_o.length;f++){var g=_o[f];g.blockedOn===s&&(g.blockedOn=null)}for(;0<_o.length&&(f=_o[0],f.blockedOn===null);)s2(f),f.blockedOn===null&&_o.shift();if(f=(s.ownerDocument||s).$$reactFormReplay,f!=null)for(g=0;g<f.length;g+=3){var x=f[g],E=f[g+1],M=x[Qn]||null;if(typeof E=="function")M||l2(f);else if(M){var F=null;if(E&&E.hasAttribute("formAction")){if(x=E,M=E[Qn]||null)F=M.formAction;else if(hx(x)!==null)continue}else F=M.action;typeof F=="function"?f[g+1]=F:(f.splice(g,3),g-=3),l2(f)}}}function c2(){function s(E){E.canIntercept&&E.info==="react-transition"&&E.intercept({handler:function(){return new Promise(function(M){return x=M})},focusReset:"manual",scroll:"manual"})}function l(){x!==null&&(x(),x=null),g||setTimeout(f,20)}function f(){if(!g&&!navigation.transition){var E=navigation.currentEntry;E&&E.url!=null&&navigation.navigate(E.url,{state:E.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,x=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(f,100),function(){g=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),x!==null&&(x(),x=null)}}}function gx(s){this._internalRoot=s}wm.prototype.render=gx.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(r(409));var f=l.current,g=ri();e2(f,g,s,l,null,null)},wm.prototype.unmount=gx.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;e2(s.current,2,null,s,null,null),nm(),l[fa]=null}};function wm(s){this._internalRoot=s}wm.prototype.unstable_scheduleHydration=function(s){if(s){var l=ng();s={blockedOn:null,target:s,priority:l};for(var f=0;f<_o.length&&l!==0&&l<_o[f].priority;f++);_o.splice(f,0,s),f===0&&s2(s)}};var u2=e.version;if(u2!=="19.2.0")throw Error(r(527,u2,"19.2.0"));W.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(l),s=s!==null?h(s):null,s=s===null?null:s.stateNode,s};var hz={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Em=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Em.isDisabled&&Em.supportsFiber)try{Yr=Em.inject(hz),In=Em}catch{}}return Yf.createRoot=function(s,l){if(!i(s))throw Error(r(299));var f=!1,g="",x=vA,E=yA,M=bA;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(E=l.onCaughtError),l.onRecoverableError!==void 0&&(M=l.onRecoverableError)),l=ZC(s,1,!1,null,null,f,g,null,x,E,M,c2),s[fa]=l.current,Wb(s),new gx(l)},Yf.hydrateRoot=function(s,l,f){if(!i(s))throw Error(r(299));var g=!1,x="",E=vA,M=yA,F=bA,Q=null;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onUncaughtError!==void 0&&(E=f.onUncaughtError),f.onCaughtError!==void 0&&(M=f.onCaughtError),f.onRecoverableError!==void 0&&(F=f.onRecoverableError),f.formState!==void 0&&(Q=f.formState)),l=ZC(s,1,!0,l,f??null,g,x,Q,E,M,F,c2),l.context=JC(null),f=l.current,g=ri(),g=pl(g),x=ao(g),x.callback=null,so(f,x,g),f=g,l.current.lanes=f,fl(l,f),Ia(l),s[fa]=l.current,Wb(s),new wm(l)},Yf.version="19.2.0",Yf}var x2;function Sz(){if(x2)return yx.exports;x2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),yx.exports=Ez(),yx.exports}var Tz=Sz();const Az="modulepreload",Cz=function(n){return"/personal-budget-pwa/"+n},_2={},Ct=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let u=function(d){return Promise.all(d.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");i=u(t.map(d=>{if(d=Cz(d),d in _2)return;_2[d]=!0;const h=d.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${p}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":Az,h||(m.as="script"),m.crossOrigin="",m.href=d,c&&m.setAttribute("nonce",c),document.head.appendChild(m),h)return new Promise((b,_)=>{m.addEventListener("load",b),m.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return i.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};function Iz(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:r,onRegistered:i,onRegisteredSW:a,onRegisterError:o}=n;let c,u;const d=async(p=!0)=>{await u};async function h(){if("serviceWorker"in navigator){if(c=await Ct(async()=>{const{Workbox:p}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/personal-budget-pwa/sw.js",{scope:"/personal-budget-pwa/",type:"classic"})).catch(p=>{o?.(p)}),!c)return;c.addEventListener("activated",p=>{(p.isUpdate||p.isExternal)&&window.location.reload()}),c.addEventListener("installed",p=>{p.isUpdate||r?.()}),c.register({immediate:e}).then(p=>{a?a("/personal-budget-pwa/sw.js",p):i?.(p)}).catch(p=>{o?.(p)})}}return u=h(),d}var w2="popstate";function Rz(n={}){function e(i,a){let{pathname:o="/",search:c="",hash:u=""}=Nc(i.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),T1("",{pathname:o,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(i,a){let o=i.document.querySelector("base"),c="";if(o&&o.getAttribute("href")){let u=i.location.href,d=u.indexOf("#");c=d===-1?u:u.slice(0,d)}return c+"#"+(typeof a=="string"?a:jh(a))}function r(i,a){Mi(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(a)})`)}return kz(e,t,r,n)}function hn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Mi(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Dz(){return Math.random().toString(36).substring(2,10)}function E2(n,e){return{usr:n.state,key:n.key,idx:e}}function T1(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Nc(e):e,state:t,key:e&&e.key||r||Dz()}}function jh({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Nc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function kz(n,e,t,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,c="POP",u=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function p(){c="POP";let S=h(),T=S==null?null:S-d;d=S,u&&u({action:c,location:w.location,delta:T})}function m(S,T){c="PUSH";let C=T1(w.location,S,T);t&&t(C,S),d=h()+1;let R=E2(C,d),O=w.createHref(C);try{o.pushState(R,"",O)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;i.location.assign(O)}a&&u&&u({action:c,location:w.location,delta:1})}function b(S,T){c="REPLACE";let C=T1(w.location,S,T);t&&t(C,S),d=h();let R=E2(C,d),O=w.createHref(C);o.replaceState(R,"",O),a&&u&&u({action:c,location:w.location,delta:0})}function _(S){return Nz(S)}let w={get action(){return c},get location(){return n(i,o)},listen(S){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(w2,p),u=S,()=>{i.removeEventListener(w2,p),u=null}},createHref(S){return e(i,S)},createURL:_,encodeLocation(S){let T=_(S);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:m,replace:b,go(S){return o.go(S)}};return w}function Nz(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),hn(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:jh(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function eN(n,e,t="/"){return Mz(n,e,t,!1)}function Mz(n,e,t,r){let i=typeof e=="string"?Nc(e):e,a=Is(i.pathname||"/",t);if(a==null)return null;let o=tN(n);Pz(o);let c=null;for(let u=0;c==null&&u<o.length;++u){let d=$z(a);c=Gz(o[u],d,r)}return c}function tN(n,e=[],t=[],r="",i=!1){let a=(o,c,u=i,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&u)return;hn(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let p=Es([r,h.relativePath]),m=t.concat(h);o.children&&o.children.length>0&&(hn(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),tN(o.children,e,m,p,u)),!(o.path==null&&!o.index)&&e.push({path:p,score:Uz(p,o.index),routesMeta:m})};return n.forEach((o,c)=>{if(o.path===""||!o.path?.includes("?"))a(o,c);else for(let u of nN(o.path))a(o,c,!0,u)}),e}function nN(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=nN(r.join("/")),c=[];return c.push(...o.map(u=>u===""?a:[a,u].join("/"))),i&&c.push(...o),c.map(u=>n.startsWith("/")&&u===""?"/":u)}function Pz(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:Fz(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var Oz=/^:[\w-]+$/,jz=3,Vz=2,zz=1,Lz=10,Bz=-2,S2=n=>n==="*";function Uz(n,e){let t=n.split("/"),r=t.length;return t.some(S2)&&(r+=Bz),e&&(r+=Vz),t.filter(i=>!S2(i)).reduce((i,a)=>i+(Oz.test(a)?jz:a===""?zz:Lz),r)}function Fz(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function Gz(n,e,t=!1){let{routesMeta:r}=n,i={},a="/",o=[];for(let c=0;c<r.length;++c){let u=r[c],d=c===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=S0({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),m=u.route;if(!p&&d&&t&&!r[r.length-1].route.index&&(p=S0({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:Es([a,p.pathname]),pathnameBase:Xz(Es([a,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(a=Es([a,p.pathnameBase]))}return o}function S0(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=qz(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:p},m)=>{if(h==="*"){let _=c[m]||"";o=a.slice(0,a.length-_.length).replace(/(.)\/+$/,"$1")}const b=c[m];return p&&!b?d[h]=void 0:d[h]=(b||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:n}}function qz(n,e=!1,t=!0){Mi(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function $z(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Mi(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Is(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}var Hz=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function Yz(n,e="/"){let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?Nc(n):n,a;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?a=T2(t.substring(1),"/"):a=T2(t,e)):a=e,{pathname:a,search:Wz(r),hash:Qz(i)}}function T2(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function wx(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Kz(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function rN(n){let e=Kz(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function iN(n,e,t,r=!1){let i;typeof n=="string"?i=Nc(n):(i={...n},hn(!i.pathname||!i.pathname.includes("?"),wx("?","pathname","search",i)),hn(!i.pathname||!i.pathname.includes("#"),wx("#","pathname","hash",i)),hn(!i.search||!i.search.includes("#"),wx("#","search","hash",i)));let a=n===""||i.pathname==="",o=a?"/":i.pathname,c;if(o==null)c=t;else{let p=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;i.pathname=m.join("/")}c=p>=0?e[p]:"/"}let u=Yz(i,c),d=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}var Es=n=>n.join("/").replace(/\/\/+/g,"/"),Xz=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Wz=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,Qz=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,Zz=class{constructor(n,e,t,r=!1){this.status=n,this.statusText=e||"",this.internal=r,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function Jz(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function e6(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var aN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function sN(n,e){let t=n;if(typeof t!="string"||!Hz.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let r=t,i=!1;if(aN)try{let a=new URL(window.location.href),o=t.startsWith("//")?new URL(a.protocol+t):new URL(t),c=Is(o.pathname,e);o.origin===a.origin&&c!=null?t=c+o.search+o.hash:i=!0}catch{Mi(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:i,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var oN=["POST","PUT","PATCH","DELETE"];new Set(oN);var t6=["GET",...oN];new Set(t6);var Rd=U.createContext(null);Rd.displayName="DataRouter";var _v=U.createContext(null);_v.displayName="DataRouterState";var n6=U.createContext(!1),lN=U.createContext({isTransitioning:!1});lN.displayName="ViewTransition";var r6=U.createContext(new Map);r6.displayName="Fetchers";var i6=U.createContext(null);i6.displayName="Await";var ji=U.createContext(null);ji.displayName="Navigation";var gp=U.createContext(null);gp.displayName="Location";var Ya=U.createContext({outlet:null,matches:[],isDataRoute:!1});Ya.displayName="Route";var uw=U.createContext(null);uw.displayName="RouteError";var cN="REACT_ROUTER_ERROR",a6="REDIRECT",s6="ROUTE_ERROR_RESPONSE";function o6(n){if(n.startsWith(`${cN}:${a6}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function l6(n){if(n.startsWith(`${cN}:${s6}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new Zz(e.status,e.statusText,e.data)}catch{}}function c6(n,{relative:e}={}){hn(mp(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=U.useContext(ji),{hash:i,pathname:a,search:o}=vp(n,{relative:e}),c=a;return t!=="/"&&(c=a==="/"?t:Es([t,a])),r.createHref({pathname:c,search:o,hash:i})}function mp(){return U.useContext(gp)!=null}function ca(){return hn(mp(),"useLocation() may be used only in the context of a <Router> component."),U.useContext(gp).location}var uN="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function dN(n){U.useContext(ji).static||U.useLayoutEffect(n)}function Ka(){let{isDataRoute:n}=U.useContext(Ya);return n?E6():u6()}function u6(){hn(mp(),"useNavigate() may be used only in the context of a <Router> component.");let n=U.useContext(Rd),{basename:e,navigator:t}=U.useContext(ji),{matches:r}=U.useContext(Ya),{pathname:i}=ca(),a=JSON.stringify(rN(r)),o=U.useRef(!1);return dN(()=>{o.current=!0}),U.useCallback((u,d={})=>{if(Mi(o.current,uN),!o.current)return;if(typeof u=="number"){t.go(u);return}let h=iN(u,JSON.parse(a),i,d.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Es([e,h.pathname])),(d.replace?t.replace:t.push)(h,d.state,d)},[e,t,a,i,n])}U.createContext(null);function d6(){let{matches:n}=U.useContext(Ya),e=n[n.length-1];return e?e.params:{}}function vp(n,{relative:e}={}){let{matches:t}=U.useContext(Ya),{pathname:r}=ca(),i=JSON.stringify(rN(t));return U.useMemo(()=>iN(n,JSON.parse(i),r,e==="path"),[n,i,r,e])}function f6(n,e){return fN(n,e)}function fN(n,e,t,r,i){hn(mp(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=U.useContext(ji),{matches:o}=U.useContext(Ya),c=o[o.length-1],u=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",p=c&&c.route;{let C=p&&p.path||"";pN(d,!p||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let m=ca(),b;if(e){let C=typeof e=="string"?Nc(e):e;hn(h==="/"||C.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${C.pathname}" was given in the \`location\` prop.`),b=C}else b=m;let _=b.pathname||"/",w=_;if(h!=="/"){let C=h.replace(/^\//,"").split("/");w="/"+_.replace(/^\//,"").split("/").slice(C.length).join("/")}let S=eN(n,{pathname:w});Mi(p||S!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),Mi(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=v6(S&&S.map(C=>Object.assign({},C,{params:Object.assign({},u,C.params),pathname:Es([h,a.encodeLocation?a.encodeLocation(C.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?h:Es([h,a.encodeLocation?a.encodeLocation(C.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathnameBase])})),o,t,r,i);return e&&T?U.createElement(gp.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},T):T}function h6(){let n=w6(),e=Jz(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",n),o=U.createElement(U.Fragment,null,U.createElement("p",null," Hey developer "),U.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",U.createElement("code",{style:a},"ErrorBoundary")," or"," ",U.createElement("code",{style:a},"errorElement")," prop on your route.")),U.createElement(U.Fragment,null,U.createElement("h2",null,"Unexpected Application Error!"),U.createElement("h3",{style:{fontStyle:"italic"}},e),t?U.createElement("pre",{style:i},t):null,o)}var p6=U.createElement(h6,null),hN=class extends U.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=l6(n.digest);t&&(n=t)}let e=n!==void 0?U.createElement(Ya.Provider,{value:this.props.routeContext},U.createElement(uw.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?U.createElement(g6,{error:n},e):e}};hN.contextType=n6;var Ex=new WeakMap;function g6({children:n,error:e}){let{basename:t}=U.useContext(ji);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=o6(e.digest);if(r){let i=Ex.get(e);if(i)throw i;let a=sN(r.location,t);if(aN&&!Ex.get(e))if(a.isExternal||r.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:r.replace}));throw Ex.set(e,o),o}return U.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return n}function m6({routeContext:n,match:e,children:t}){let r=U.useContext(Rd);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),U.createElement(Ya.Provider,{value:n},t)}function v6(n,e=[],t=null,r=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,o=t?.errors;if(o!=null){let h=a.findIndex(p=>p.route.id&&o?.[p.route.id]!==void 0);hn(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let c=!1,u=-1;if(t)for(let h=0;h<a.length;h++){let p=a[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=h),p.route.id){let{loaderData:m,errors:b}=t,_=p.route.loader&&!m.hasOwnProperty(p.route.id)&&(!b||b[p.route.id]===void 0);if(p.route.lazy||_){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}let d=t&&r?(h,p)=>{r(h,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:e6(t.matches),errorInfo:p})}:void 0;return a.reduceRight((h,p,m)=>{let b,_=!1,w=null,S=null;t&&(b=o&&p.route.id?o[p.route.id]:void 0,w=p.route.errorElement||p6,c&&(u<0&&m===0?(pN("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,S=null):u===m&&(_=!0,S=p.route.hydrateFallbackElement||null)));let T=e.concat(a.slice(0,m+1)),C=()=>{let R;return b?R=w:_?R=S:p.route.Component?R=U.createElement(p.route.Component,null):p.route.element?R=p.route.element:R=h,U.createElement(m6,{match:p,routeContext:{outlet:h,matches:T,isDataRoute:t!=null},children:R})};return t&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?U.createElement(hN,{location:t.location,revalidation:t.revalidation,component:w,error:b,children:C(),routeContext:{outlet:null,matches:T,isDataRoute:!0},onError:d}):C()},null)}function dw(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function y6(n){let e=U.useContext(Rd);return hn(e,dw(n)),e}function b6(n){let e=U.useContext(_v);return hn(e,dw(n)),e}function x6(n){let e=U.useContext(Ya);return hn(e,dw(n)),e}function fw(n){let e=x6(n),t=e.matches[e.matches.length-1];return hn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function _6(){return fw("useRouteId")}function w6(){let n=U.useContext(uw),e=b6("useRouteError"),t=fw("useRouteError");return n!==void 0?n:e.errors?.[t]}function E6(){let{router:n}=y6("useNavigate"),e=fw("useNavigate"),t=U.useRef(!1);return dN(()=>{t.current=!0}),U.useCallback(async(i,a={})=>{Mi(t.current,uN),t.current&&(typeof i=="number"?await n.navigate(i):await n.navigate(i,{fromRouteId:e,...a}))},[n,e])}var A2={};function pN(n,e,t){!e&&!A2[n]&&(A2[n]=!0,Mi(!1,t))}U.memo(S6);function S6({routes:n,future:e,state:t,onError:r}){return fN(n,void 0,t,r,e)}function vs(n){hn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function T6({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:i,static:a=!1,unstable_useTransitions:o}){hn(!mp(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=n.replace(/^\/*/,"/"),u=U.useMemo(()=>({basename:c,navigator:i,static:a,unstable_useTransitions:o,future:{}}),[c,i,a,o]);typeof t=="string"&&(t=Nc(t));let{pathname:d="/",search:h="",hash:p="",state:m=null,key:b="default"}=t,_=U.useMemo(()=>{let w=Is(d,c);return w==null?null:{location:{pathname:w,search:h,hash:p,state:m,key:b},navigationType:r}},[c,d,h,p,m,b,r]);return Mi(_!=null,`<Router basename="${c}"> is not able to match the URL "${d}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:U.createElement(ji.Provider,{value:u},U.createElement(gp.Provider,{children:e,value:_}))}function A6({children:n,location:e}){return f6(A1(n),e)}function A1(n,e=[]){let t=[];return U.Children.forEach(n,(r,i)=>{if(!U.isValidElement(r))return;let a=[...e,i];if(r.type===U.Fragment){t.push.apply(t,A1(r.props.children,a));return}hn(r.type===vs,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),hn(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=A1(r.props.children,a)),t.push(o)}),t}var Zm="get",Jm="application/x-www-form-urlencoded";function wv(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function C6(n){return wv(n)&&n.tagName.toLowerCase()==="button"}function I6(n){return wv(n)&&n.tagName.toLowerCase()==="form"}function R6(n){return wv(n)&&n.tagName.toLowerCase()==="input"}function D6(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function k6(n,e){return n.button===0&&(!e||e==="_self")&&!D6(n)}function C1(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let r=n[t];return e.concat(Array.isArray(r)?r.map(i=>[t,i]):[[t,r]])},[]))}function N6(n,e){let t=C1(n);return e&&e.forEach((r,i)=>{t.has(i)||e.getAll(i).forEach(a=>{t.append(i,a)})}),t}var Sm=null;function M6(){if(Sm===null)try{new FormData(document.createElement("form"),0),Sm=!1}catch{Sm=!0}return Sm}var P6=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Sx(n){return n!=null&&!P6.has(n)?(Mi(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Jm}"`),null):n}function O6(n,e){let t,r,i,a,o;if(I6(n)){let c=n.getAttribute("action");r=c?Is(c,e):null,t=n.getAttribute("method")||Zm,i=Sx(n.getAttribute("enctype"))||Jm,a=new FormData(n)}else if(C6(n)||R6(n)&&(n.type==="submit"||n.type==="image")){let c=n.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=n.getAttribute("formaction")||c.getAttribute("action");if(r=u?Is(u,e):null,t=n.getAttribute("formmethod")||c.getAttribute("method")||Zm,i=Sx(n.getAttribute("formenctype"))||Sx(c.getAttribute("enctype"))||Jm,a=new FormData(c,n),!M6()){let{name:d,type:h,value:p}=n;if(h==="image"){let m=d?`${d}.`:"";a.append(`${m}x`,"0"),a.append(`${m}y`,"0")}else d&&a.append(d,p)}}else{if(wv(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Zm,r=null,i=Jm,o=n}return a&&i==="text/plain"&&(o=a,a=void 0),{action:r,method:t.toLowerCase(),encType:i,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function hw(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function j6(n,e,t,r){let i=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?i.pathname.endsWith("/")?i.pathname=`${i.pathname}_.${r}`:i.pathname=`${i.pathname}.${r}`:i.pathname==="/"?i.pathname=`_root.${r}`:e&&Is(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${r}`,i}async function V6(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function z6(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function L6(n,e,t){let r=await Promise.all(n.map(async i=>{let a=e.routes[i.route.id];if(a){let o=await V6(a,t);return o.links?o.links():[]}return[]}));return G6(r.flat(1).filter(z6).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function C2(n,e,t,r,i,a){let o=(u,d)=>t[d]?u.route.id!==t[d].route.id:!0,c=(u,d)=>t[d].pathname!==u.pathname||t[d].route.path?.endsWith("*")&&t[d].params["*"]!==u.params["*"];return a==="assets"?e.filter((u,d)=>o(u,d)||c(u,d)):a==="data"?e.filter((u,d)=>{let h=r.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,d)||c(u,d))return!0;if(u.route.shouldRevalidate){let p=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function B6(n,e,{includeHydrateFallback:t}={}){return U6(n.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function U6(n){return[...new Set(n)]}function F6(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function G6(n,e){let t=new Set;return new Set(e),n.reduce((r,i)=>{let a=JSON.stringify(F6(i));return t.has(a)||(t.add(a),r.push({key:a,link:i})),r},[])}function gN(){let n=U.useContext(Rd);return hw(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function q6(){let n=U.useContext(_v);return hw(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var pw=U.createContext(void 0);pw.displayName="FrameworkContext";function mN(){let n=U.useContext(pw);return hw(n,"You must render this element inside a <HydratedRouter> element"),n}function $6(n,e){let t=U.useContext(pw),[r,i]=U.useState(!1),[a,o]=U.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:d,onMouseLeave:h,onTouchStart:p}=e,m=U.useRef(null);U.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let w=T=>{T.forEach(C=>{o(C.isIntersecting)})},S=new IntersectionObserver(w,{threshold:.5});return m.current&&S.observe(m.current),()=>{S.disconnect()}}},[n]),U.useEffect(()=>{if(r){let w=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(w)}}},[r]);let b=()=>{i(!0)},_=()=>{i(!1),o(!1)};return t?n!=="intent"?[a,m,{}]:[a,m,{onFocus:Kf(c,b),onBlur:Kf(u,_),onMouseEnter:Kf(d,b),onMouseLeave:Kf(h,_),onTouchStart:Kf(p,b)}]:[!1,m,{}]}function Kf(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function H6({page:n,...e}){let{router:t}=gN(),r=U.useMemo(()=>eN(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?U.createElement(K6,{page:n,matches:r,...e}):null}function Y6(n){let{manifest:e,routeModules:t}=mN(),[r,i]=U.useState([]);return U.useEffect(()=>{let a=!1;return L6(n,e,t).then(o=>{a||i(o)}),()=>{a=!0}},[n,e,t]),r}function K6({page:n,matches:e,...t}){let r=ca(),{future:i,manifest:a,routeModules:o}=mN(),{basename:c}=gN(),{loaderData:u,matches:d}=q6(),h=U.useMemo(()=>C2(n,e,d,a,r,"data"),[n,e,d,a,r]),p=U.useMemo(()=>C2(n,e,d,a,r,"assets"),[n,e,d,a,r]),m=U.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let w=new Set,S=!1;if(e.forEach(C=>{let R=a.routes[C.route.id];!R||!R.hasLoader||(!h.some(O=>O.route.id===C.route.id)&&C.route.id in u&&o[C.route.id]?.shouldRevalidate||R.hasClientLoader?S=!0:w.add(C.route.id))}),w.size===0)return[];let T=j6(n,c,i.unstable_trailingSlashAwareDataRequests,"data");return S&&w.size>0&&T.searchParams.set("_routes",e.filter(C=>w.has(C.route.id)).map(C=>C.route.id).join(",")),[T.pathname+T.search]},[c,i.unstable_trailingSlashAwareDataRequests,u,r,a,h,e,n,o]),b=U.useMemo(()=>B6(p,a),[p,a]),_=Y6(p);return U.createElement(U.Fragment,null,m.map(w=>U.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...t})),b.map(w=>U.createElement("link",{key:w,rel:"modulepreload",href:w,...t})),_.map(({key:w,link:S})=>U.createElement("link",{key:w,nonce:t.nonce,...S,crossOrigin:S.crossOrigin??t.crossOrigin})))}function X6(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var W6=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{W6&&(window.__reactRouterVersion="7.13.0")}catch{}function Q6({basename:n,children:e,unstable_useTransitions:t,window:r}){let i=U.useRef();i.current==null&&(i.current=Rz({window:r,v5Compat:!0}));let a=i.current,[o,c]=U.useState({action:a.action,location:a.location}),u=U.useCallback(d=>{t===!1?c(d):U.startTransition(()=>c(d))},[t]);return U.useLayoutEffect(()=>a.listen(u),[a,u]),U.createElement(T6,{basename:n,children:e,location:o.location,navigationType:o.action,navigator:a,unstable_useTransitions:t})}var vN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,yN=U.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:i,reloadDocument:a,replace:o,state:c,target:u,to:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...b},_){let{basename:w,unstable_useTransitions:S}=U.useContext(ji),T=typeof d=="string"&&vN.test(d),C=sN(d,w);d=C.to;let R=c6(d,{relative:i}),[O,P,N]=$6(r,b),A=tL(d,{replace:o,state:c,target:u,preventScrollReset:h,relative:i,viewTransition:p,unstable_defaultShouldRevalidate:m,unstable_useTransitions:S});function I(z){e&&e(z),z.defaultPrevented||A(z)}let k=U.createElement("a",{...b,...N,href:C.absoluteURL||R,onClick:C.isExternal||a?e:I,ref:X6(_,P),target:u,"data-discover":!T&&t==="render"?"true":void 0});return O&&!T?U.createElement(U.Fragment,null,k,U.createElement(H6,{page:R})):k});yN.displayName="Link";var Z6=U.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:i=!1,style:a,to:o,viewTransition:c,children:u,...d},h){let p=vp(o,{relative:d.relative}),m=ca(),b=U.useContext(_v),{navigator:_,basename:w}=U.useContext(ji),S=b!=null&&oL(p)&&c===!0,T=_.encodeLocation?_.encodeLocation(p).pathname:p.pathname,C=m.pathname,R=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;t||(C=C.toLowerCase(),R=R?R.toLowerCase():null,T=T.toLowerCase()),R&&w&&(R=Is(R,w)||R);const O=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let P=C===T||!i&&C.startsWith(T)&&C.charAt(O)==="/",N=R!=null&&(R===T||!i&&R.startsWith(T)&&R.charAt(T.length)==="/"),A={isActive:P,isPending:N,isTransitioning:S},I=P?e:void 0,k;typeof r=="function"?k=r(A):k=[r,P?"active":null,N?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let z=typeof a=="function"?a(A):a;return U.createElement(yN,{...d,"aria-current":I,className:k,ref:h,style:z,to:o,viewTransition:c},typeof u=="function"?u(A):u)});Z6.displayName="NavLink";var J6=U.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:i,state:a,method:o=Zm,action:c,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...b},_)=>{let{unstable_useTransitions:w}=U.useContext(ji),S=aL(),T=sL(c,{relative:d}),C=o.toLowerCase()==="get"?"get":"post",R=typeof c=="string"&&vN.test(c),O=P=>{if(u&&u(P),P.defaultPrevented)return;P.preventDefault();let N=P.nativeEvent.submitter,A=N?.getAttribute("formmethod")||o,I=()=>S(N||P.currentTarget,{fetcherKey:e,method:A,navigate:t,replace:i,state:a,relative:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m});w&&t!==!1?U.startTransition(()=>I()):I()};return U.createElement("form",{ref:_,method:C,action:T,onSubmit:r?u:O,...b,"data-discover":!R&&n==="render"?"true":void 0})});J6.displayName="Form";function eL(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function bN(n){let e=U.useContext(Rd);return hn(e,eL(n)),e}function tL(n,{target:e,replace:t,state:r,preventScrollReset:i,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:c,unstable_useTransitions:u}={}){let d=Ka(),h=ca(),p=vp(n,{relative:a});return U.useCallback(m=>{if(k6(m,e)){m.preventDefault();let b=t!==void 0?t:jh(h)===jh(p),_=()=>d(n,{replace:b,state:r,preventScrollReset:i,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:c});u?U.startTransition(()=>_()):_()}},[h,d,p,t,r,e,n,i,a,o,c,u])}function nL(n){Mi(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=U.useRef(C1(n)),t=U.useRef(!1),r=ca(),i=U.useMemo(()=>N6(r.search,t.current?null:e.current),[r.search]),a=Ka(),o=U.useCallback((c,u)=>{const d=C1(typeof c=="function"?c(new URLSearchParams(i)):c);t.current=!0,a("?"+d,u)},[a,i]);return[i,o]}var rL=0,iL=()=>`__${String(++rL)}__`;function aL(){let{router:n}=bN("useSubmit"),{basename:e}=U.useContext(ji),t=_6(),r=n.fetch,i=n.navigate;return U.useCallback(async(a,o={})=>{let{action:c,method:u,encType:d,formData:h,body:p}=O6(a,e);if(o.navigate===!1){let m=o.fetcherKey||iL();await r(m,t,o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:p,formMethod:o.method||u,formEncType:o.encType||d,flushSync:o.flushSync})}else await i(o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:p,formMethod:o.method||u,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:t,flushSync:o.flushSync,viewTransition:o.viewTransition})},[r,i,e,t])}function sL(n,{relative:e}={}){let{basename:t}=U.useContext(ji),r=U.useContext(Ya);hn(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),a={...vp(n||".",{relative:e})},o=ca();if(n==null){a.search=o.search;let c=new URLSearchParams(a.search),u=c.getAll("index");if(u.some(h=>h==="")){c.delete("index"),u.filter(p=>p).forEach(p=>c.append("index",p));let h=c.toString();a.search=h?`?${h}`:""}}return(!n||n===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:Es([t,a.pathname])),jh(a)}function oL(n,{relative:e}={}){let t=U.useContext(lN);hn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=bN("useViewTransitionState"),i=vp(n,{relative:e});if(!t.isTransitioning)return!1;let a=Is(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=Is(t.nextLocation.pathname,r)||t.nextLocation.pathname;return S0(i.pathname,o)!=null||S0(i.pathname,a)!=null}const lL=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),cL=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),I2=n=>{const e=cL(n);return e.charAt(0).toUpperCase()+e.slice(1)},xN=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),uL=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var dL={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const fL=U.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:a,iconNode:o,...c},u)=>U.createElement("svg",{ref:u,...dL,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:xN("lucide",i),...!a&&!uL(c)&&{"aria-hidden":"true"},...c},[...o.map(([d,h])=>U.createElement(d,h)),...Array.isArray(a)?a:[a]]));const Je=(n,e)=>{const t=U.forwardRef(({className:r,...i},a)=>U.createElement(fL,{ref:a,iconNode:e,className:xN(`lucide-${lL(I2(n))}`,`lucide-${n}`,r),...i}));return t.displayName=I2(n),t};const hL=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],pL=Je("arrow-down",hL);const gL=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],gc=Je("arrow-left",gL);const mL=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],vL=Je("arrow-right-left",mL);const yL=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],bL=Je("arrow-right",yL);const xL=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],_L=Je("arrow-up",xL);const wL=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],EL=Je("calendar",wL);const SL=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],TL=Je("chart-column",SL);const AL=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],CL=Je("chart-pie",AL);const IL=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],RL=Je("check",IL);const DL=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],kL=Je("chevron-left",DL);const NL=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Ra=Je("chevron-right",NL);const ML=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]],PL=Je("circle-arrow-down",ML);const OL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],jL=Je("circle-arrow-up",OL);const VL=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],I1=Je("circle-check-big",VL);const zL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ys=Je("circle-check",zL);const LL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],R2=Je("circle",LL);const BL=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],D2=Je("dollar-sign",BL);const UL=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],k2=Je("download",UL);const FL=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],GL=Je("ellipsis",FL);const qL=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],$L=Je("eye-off",qL);const HL=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],YL=Je("eye",HL);const KL=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],XL=Je("file-text",KL);const WL=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],QL=Je("folder",WL);const ZL=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],JL=Je("funnel",ZL);const e9=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],_N=Je("grip-vertical",e9);const t9=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],n9=Je("house",t9);const r9=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],i9=Je("list",r9);const a9=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],N2=Je("loader",a9);const s9=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],o9=Je("log-out",s9);const l9=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],R1=Je("mail",l9);const c9=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],u9=Je("pause",c9);const d9=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],f9=Je("pen",d9);const h9=[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]],yp=Je("piggy-bank",h9);const p9=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],bp=Je("plus",p9);const g9=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Vh=Je("refresh-cw",g9);const m9=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],v9=Je("rotate-ccw",m9);const y9=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],b9=Je("search",y9);const x9=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],_9=Je("settings",x9);const w9=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],zh=Je("sparkles",w9);const E9=[["path",{d:"M13.172 2a2 2 0 0 1 1.414.586l6.71 6.71a2.4 2.4 0 0 1 0 3.408l-4.592 4.592a2.4 2.4 0 0 1-3.408 0l-6.71-6.71A2 2 0 0 1 6 9.172V3a1 1 0 0 1 1-1z",key:"16rjxf"}],["path",{d:"M2 7v6.172a2 2 0 0 0 .586 1.414l6.71 6.71a2.4 2.4 0 0 0 3.191.193",key:"178nd4"}],["circle",{cx:"10.5",cy:"6.5",r:".5",fill:"currentColor",key:"12ikhr"}]],S9=Je("tags",E9);const T9=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],A9=Je("target",T9);const C9=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],T0=Je("trash-2",C9);const I9=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],wN=Je("trash",I9);const R9=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],A0=Je("trending-up",R9);const D9=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Qu=Je("triangle-alert",D9);const k9=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],N9=Je("undo-2",k9);const M9=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],P9=Je("upload",M9);const O9=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],j9=Je("user-plus",O9);const V9=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],Ev=Je("wallet",V9);const z9=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Sv=Je("x",z9),M2=n=>{let e;const t=new Set,r=(d,h)=>{const p=typeof d=="function"?d(e):d;if(!Object.is(p,e)){const m=e;e=h??(typeof p!="object"||p===null)?p:Object.assign({},e,p),t.forEach(b=>b(e,m))}},i=()=>e,c={setState:r,getState:i,getInitialState:()=>u,subscribe:d=>(t.add(d),()=>t.delete(d))},u=e=n(r,i,c);return c},L9=(n=>n?M2(n):M2),B9=n=>n;function U9(n,e=B9){const t=nh.useSyncExternalStore(n.subscribe,nh.useCallback(()=>e(n.getState()),[n,e]),nh.useCallback(()=>e(n.getInitialState()),[n,e]));return nh.useDebugValue(t),t}const P2=n=>{const e=L9(n),t=r=>U9(e,r);return Object.assign(t,e),t},gw=(n=>n?P2(n):P2),O2={BASE_URL:"/personal-budget-pwa/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyCRHcpbVGQrEZUVdO_Ucn4ZarwwPsrON40",VITE_FIREBASE_APP_ID:"1:137454342284:web:ab8b52955e6f0ffd42aba9",VITE_FIREBASE_AUTH_DOMAIN:"personal-budget-pwa-5defb.firebaseapp.com",VITE_FIREBASE_MEASUREMENT_ID:"G-BCLXBQHT9L",VITE_FIREBASE_MESSAGING_SENDER_ID:"137454342284",VITE_FIREBASE_PROJECT_ID:"personal-budget-pwa-5defb",VITE_FIREBASE_STORAGE_BUCKET:"personal-budget-pwa-5defb.firebasestorage.app"},Lh=new Map,Tm=n=>{const e=Lh.get(n);return e?Object.fromEntries(Object.entries(e.stores).map(([t,r])=>[t,r.getState()])):{}},F9=(n,e,t)=>{if(n===void 0)return{type:"untracked",connection:e.connect(t)};const r=Lh.get(t.name);if(r)return{type:"tracked",store:n,...r};const i={connection:e.connect(t),stores:{}};return Lh.set(t.name,i),{type:"tracked",store:n,...i}},G9=(n,e)=>{if(e===void 0)return;const t=Lh.get(n);t&&(delete t.stores[e],Object.keys(t.stores).length===0&&Lh.delete(n))},q9=n=>{var e,t;if(!n)return;const r=n.split(`
`),i=r.findIndex(o=>o.includes("api.setState"));if(i<0)return;const a=((e=r[i+1])==null?void 0:e.trim())||"";return(t=/.+ (.+) .+/.exec(a))==null?void 0:t[1]},$9=(n,e={})=>(t,r,i)=>{const{enabled:a,anonymousActionType:o,store:c,...u}=e;let d;try{d=(a??(O2?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!d)return n(t,r,i);const{connection:h,...p}=F9(c,d,u);let m=!0;i.setState=((w,S,T)=>{const C=t(w,S);if(!m)return C;const R=T===void 0?{type:o||q9(new Error().stack)||"anonymous"}:typeof T=="string"?{type:T}:T;return c===void 0?(h?.send(R,r()),C):(h?.send({...R,type:`${c}/${R.type}`},{...Tm(u.name),[c]:i.getState()}),C)}),i.devtools={cleanup:()=>{h&&typeof h.unsubscribe=="function"&&h.unsubscribe(),G9(u.name,c)}};const b=(...w)=>{const S=m;m=!1,t(...w),m=S},_=n(i.setState,r,i);if(p.type==="untracked"?h?.init(_):(p.stores[p.store]=i,h?.init(Object.fromEntries(Object.entries(p.stores).map(([w,S])=>[w,w===p.store?_:S.getState()])))),i.dispatchFromDevtools&&typeof i.dispatch=="function"){let w=!1;const S=i.dispatch;i.dispatch=(...T)=>{(O2?"production":void 0)!=="production"&&T[0].type==="__setState"&&!w&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),w=!0),S(...T)}}return h.subscribe(w=>{var S;switch(w.type){case"ACTION":if(typeof w.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return Tx(w.payload,T=>{if(T.type==="__setState"){if(c===void 0){b(T.state);return}Object.keys(T.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const C=T.state[c];if(C==null)return;JSON.stringify(i.getState())!==JSON.stringify(C)&&b(C);return}i.dispatchFromDevtools&&typeof i.dispatch=="function"&&i.dispatch(T)});case"DISPATCH":switch(w.payload.type){case"RESET":return b(_),c===void 0?h?.init(i.getState()):h?.init(Tm(u.name));case"COMMIT":if(c===void 0){h?.init(i.getState());return}return h?.init(Tm(u.name));case"ROLLBACK":return Tx(w.state,T=>{if(c===void 0){b(T),h?.init(i.getState());return}b(T[c]),h?.init(Tm(u.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return Tx(w.state,T=>{if(c===void 0){b(T);return}JSON.stringify(i.getState())!==JSON.stringify(T[c])&&b(T[c])});case"IMPORT_STATE":{const{nextLiftedState:T}=w.payload,C=(S=T.computedStates.slice(-1)[0])==null?void 0:S.state;if(!C)return;b(c===void 0?C:C[c]),h?.send(null,T);return}case"PAUSE_RECORDING":return m=!m}return}}),_},H9=$9,Tx=(n,e)=>{let t;try{t=JSON.parse(n)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}t!==void 0&&e(t)};function Y9(n,e){let t;try{t=n()}catch{return}return{getItem:i=>{var a;const o=u=>u===null?null:JSON.parse(u,void 0),c=(a=t.getItem(i))!=null?a:null;return c instanceof Promise?c.then(o):o(c)},setItem:(i,a)=>t.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>t.removeItem(i)}}const D1=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return D1(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return D1(r)(t)}}}},K9=(n,e)=>(t,r,i)=>{let a={storage:Y9(()=>localStorage),partialize:w=>w,version:0,merge:(w,S)=>({...S,...w}),...e},o=!1;const c=new Set,u=new Set;let d=a.storage;if(!d)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(...w)},r,i);const h=()=>{const w=a.partialize({...r()});return d.setItem(a.name,{state:w,version:a.version})},p=i.setState;i.setState=(w,S)=>(p(w,S),h());const m=n((...w)=>(t(...w),h()),r,i);i.getInitialState=()=>m;let b;const _=()=>{var w,S;if(!d)return;o=!1,c.forEach(C=>{var R;return C((R=r())!=null?R:m)});const T=((S=a.onRehydrateStorage)==null?void 0:S.call(a,(w=r())!=null?w:m))||void 0;return D1(d.getItem.bind(d))(a.name).then(C=>{if(C)if(typeof C.version=="number"&&C.version!==a.version){if(a.migrate){const R=a.migrate(C.state,C.version);return R instanceof Promise?R.then(O=>[!0,O]):[!0,R]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,C.state];return[!1,void 0]}).then(C=>{var R;const[O,P]=C;if(b=a.merge(P,(R=r())!=null?R:m),t(b,!0),O)return h()}).then(()=>{T?.(b,void 0),b=r(),o=!0,u.forEach(C=>C(b))}).catch(C=>{T?.(void 0,C)})};return i.persist={setOptions:w=>{a={...a,...w},w.storage&&(d=w.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:w=>(c.add(w),()=>{c.delete(w)}),onFinishHydration:w=>(u.add(w),()=>{u.delete(w)})},a.skipHydration||_(),b||m},EN=K9,X9=()=>{};var j2={};const SN=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},W9=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=n[t++];e[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=n[t++],o=n[t++],c=n[t++],u=((i&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const a=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return e.join("")},TN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const a=n[i],o=i+1<n.length,c=o?n[i+1]:0,u=i+2<n.length,d=u?n[i+2]:0,h=a>>2,p=(a&3)<<4|c>>4;let m=(c&15)<<2|d>>6,b=d&63;u||(b=64,o||(m=64)),r.push(t[h],t[p],t[m],t[b])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(SN(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):W9(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const a=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;const d=i<n.length?t[n.charAt(i)]:64;++i;const p=i<n.length?t[n.charAt(i)]:64;if(++i,a==null||c==null||d==null||p==null)throw new Q9;const m=a<<2|c>>4;if(r.push(m),d!==64){const b=c<<4&240|d>>2;if(r.push(b),p!==64){const _=d<<6&192|p;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Q9 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Z9=function(n){const e=SN(n);return TN.encodeByteArray(e,!0)},C0=function(n){return Z9(n).replace(/\./g,"")},AN=function(n){try{return TN.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function CN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const J9=()=>CN().__FIREBASE_DEFAULTS__,eB=()=>{if(typeof process>"u"||typeof j2>"u")return;const n=j2.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},tB=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&AN(n[1]);return e&&JSON.parse(e)},Tv=()=>{try{return X9()||J9()||eB()||tB()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},IN=n=>Tv()?.emulatorHosts?.[n],nB=n=>{const e=IN(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},RN=()=>Tv()?.config,DN=n=>Tv()?.[`_${n}`];class rB{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Dd(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function kN(n){return(await fetch(n,{credentials:"include"})).ok}function iB(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...n};return[C0(JSON.stringify(t)),C0(JSON.stringify(o)),""].join(".")}const gh={};function aB(){const n={prod:[],emulator:[]};for(const e of Object.keys(gh))gh[e]?n.emulator.push(e):n.prod.push(e);return n}function sB(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let V2=!1;function NN(n,e){if(typeof window>"u"||typeof document>"u"||!Dd(window.location.host)||gh[n]===e||gh[n]||V2)return;gh[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",a=aB().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function c(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,b){m.setAttribute("width","24"),m.setAttribute("id",b),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{V2=!0,o()},m}function h(m,b){m.setAttribute("id",b),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=sB(r),b=t("text"),_=document.getElementById(b)||document.createElement("span"),w=t("learnmore"),S=document.getElementById(w)||document.createElement("a"),T=t("preprendIcon"),C=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const R=m.element;c(R),h(S,w);const O=d();u(C,T),R.append(C,_,S,O),document.body.appendChild(R)}a?(_.innerText="Preview backend disconnected.",C.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(C.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function Xn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function oB(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xn())}function MN(){const n=Tv()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function lB(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function cB(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function uB(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function dB(){const n=Xn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function PN(){return!MN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ON(){return!MN()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function jN(){try{return typeof indexedDB=="object"}catch{return!1}}function fB(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const hB="FirebaseError";class Vs extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=hB,Object.setPrototypeOf(this,Vs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xp.prototype.create)}}class xp{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,a=this.errors[e],o=a?pB(a,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new Vs(i,c,r)}}function pB(n,e){return n.replace(gB,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const gB=/\{\$([^}]+)}/g;function mB(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ko(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const a=n[i],o=e[i];if(z2(a)&&z2(o)){if(!Ko(a,o))return!1}else if(a!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function z2(n){return n!==null&&typeof n=="object"}function _p(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function rh(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,a]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function ih(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function vB(n,e){const t=new yB(n,e);return t.subscribe.bind(t)}class yB{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");bB(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Ax),i.error===void 0&&(i.error=Ax),i.complete===void 0&&(i.complete=Ax);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function bB(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ax(){}function Jt(n){return n&&n._delegate?n._delegate:n}let mc=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};const Gl="[DEFAULT]";let xB=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new rB;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(wB(e))try{this.getOrInitializeService({instanceIdentifier:Gl})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:i});r.resolve(a)}catch{}}}}clearInstance(e=Gl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Gl){return this.instances.has(e)}getOptions(e=Gl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);r===c&&o.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const a=this.instances.get(r);return a&&e(a,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:_B(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Gl){return this.component?this.component.multipleInstances?e:Gl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function _B(n){return n===Gl?void 0:n}function wB(n){return n.instantiationMode==="EAGER"}class EB{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new xB(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var _t;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(_t||(_t={}));const SB={debug:_t.DEBUG,verbose:_t.VERBOSE,info:_t.INFO,warn:_t.WARN,error:_t.ERROR,silent:_t.SILENT},TB=_t.INFO,AB={[_t.DEBUG]:"log",[_t.VERBOSE]:"log",[_t.INFO]:"info",[_t.WARN]:"warn",[_t.ERROR]:"error"},CB=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=AB[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class mw{constructor(e){this.name=e,this._logLevel=TB,this._logHandler=CB,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in _t))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?SB[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,_t.DEBUG,...e),this._logHandler(this,_t.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,_t.VERBOSE,...e),this._logHandler(this,_t.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,_t.INFO,...e),this._logHandler(this,_t.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,_t.WARN,...e),this._logHandler(this,_t.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,_t.ERROR,...e),this._logHandler(this,_t.ERROR,...e)}}const IB=(n,e)=>e.some(t=>n instanceof t);let L2,B2;function RB(){return L2||(L2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function DB(){return B2||(B2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const VN=new WeakMap,k1=new WeakMap,zN=new WeakMap,Cx=new WeakMap,vw=new WeakMap;function kB(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",a),n.removeEventListener("error",o)},a=()=>{t(Uo(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",a),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&VN.set(t,n)}).catch(()=>{}),vw.set(e,n),e}function NB(n){if(k1.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",o),n.removeEventListener("abort",o)},a=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",a),n.addEventListener("error",o),n.addEventListener("abort",o)});k1.set(n,e)}let N1={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return k1.get(n);if(e==="objectStoreNames")return n.objectStoreNames||zN.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Uo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function MB(n){N1=n(N1)}function PB(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Ix(this),e,...t);return zN.set(r,e.sort?e.sort():[e]),Uo(r)}:DB().includes(n)?function(...e){return n.apply(Ix(this),e),Uo(VN.get(this))}:function(...e){return Uo(n.apply(Ix(this),e))}}function OB(n){return typeof n=="function"?PB(n):(n instanceof IDBTransaction&&NB(n),IB(n,RB())?new Proxy(n,N1):n)}function Uo(n){if(n instanceof IDBRequest)return kB(n);if(Cx.has(n))return Cx.get(n);const e=OB(n);return e!==n&&(Cx.set(n,e),vw.set(e,n)),e}const Ix=n=>vw.get(n);function jB(n,e,{blocked:t,upgrade:r,blocking:i,terminated:a}={}){const o=indexedDB.open(n,e),c=Uo(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Uo(o.result),u.oldVersion,u.newVersion,Uo(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{a&&u.addEventListener("close",()=>a()),i&&u.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const VB=["get","getKey","getAll","getAllKeys","count"],zB=["put","add","delete","clear"],Rx=new Map;function U2(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Rx.get(e))return Rx.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=zB.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||VB.includes(t)))return;const a=async function(o,...c){const u=this.transaction(o,i?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[t](...c),i&&u.done]))[0]};return Rx.set(e,a),a}MB(n=>({...n,get:(e,t,r)=>U2(e,t)||n.get(e,t,r),has:(e,t)=>!!U2(e,t)||n.has(e,t)}));class LB{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(BB(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function BB(n){return n.getComponent()?.type==="VERSION"}const M1="@firebase/app",F2="0.14.6";const Rs=new mw("@firebase/app"),UB="@firebase/app-compat",FB="@firebase/analytics-compat",GB="@firebase/analytics",qB="@firebase/app-check-compat",$B="@firebase/app-check",HB="@firebase/auth",YB="@firebase/auth-compat",KB="@firebase/database",XB="@firebase/data-connect",WB="@firebase/database-compat",QB="@firebase/functions",ZB="@firebase/functions-compat",JB="@firebase/installations",e8="@firebase/installations-compat",t8="@firebase/messaging",n8="@firebase/messaging-compat",r8="@firebase/performance",i8="@firebase/performance-compat",a8="@firebase/remote-config",s8="@firebase/remote-config-compat",o8="@firebase/storage",l8="@firebase/storage-compat",c8="@firebase/firestore",u8="@firebase/ai",d8="@firebase/firestore-compat",f8="firebase",h8="12.6.0";const P1="[DEFAULT]",p8={[M1]:"fire-core",[UB]:"fire-core-compat",[GB]:"fire-analytics",[FB]:"fire-analytics-compat",[$B]:"fire-app-check",[qB]:"fire-app-check-compat",[HB]:"fire-auth",[YB]:"fire-auth-compat",[KB]:"fire-rtdb",[XB]:"fire-data-connect",[WB]:"fire-rtdb-compat",[QB]:"fire-fn",[ZB]:"fire-fn-compat",[JB]:"fire-iid",[e8]:"fire-iid-compat",[t8]:"fire-fcm",[n8]:"fire-fcm-compat",[r8]:"fire-perf",[i8]:"fire-perf-compat",[a8]:"fire-rc",[s8]:"fire-rc-compat",[o8]:"fire-gcs",[l8]:"fire-gcs-compat",[c8]:"fire-fst",[d8]:"fire-fst-compat",[u8]:"fire-vertex","fire-js":"fire-js",[f8]:"fire-js-all"};const I0=new Map,g8=new Map,O1=new Map;function G2(n,e){try{n.container.addComponent(e)}catch(t){Rs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function id(n){const e=n.name;if(O1.has(e))return Rs.debug(`There were multiple attempts to register component ${e}.`),!1;O1.set(e,n);for(const t of I0.values())G2(t,n);for(const t of g8.values())G2(t,n);return!0}function yw(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ai(n){return n==null?!1:n.settings!==void 0}const m8={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Fo=new xp("app","Firebase",m8);class v8{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new mc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Fo.create("app-deleted",{appName:this._name})}}const kd=h8;function LN(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:P1,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Fo.create("bad-app-name",{appName:String(i)});if(t||(t=RN()),!t)throw Fo.create("no-options");const a=I0.get(i);if(a){if(Ko(t,a.options)&&Ko(r,a.config))return a;throw Fo.create("duplicate-app",{appName:i})}const o=new EB(i);for(const u of O1.values())o.addComponent(u);const c=new v8(t,r,o);return I0.set(i,c),c}function BN(n=P1){const e=I0.get(n);if(!e&&n===P1&&RN())return LN();if(!e)throw Fo.create("no-app",{appName:n});return e}function Go(n,e,t){let r=p8[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Rs.warn(o.join(" "));return}id(new mc(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const y8="firebase-heartbeat-database",b8=1,Bh="firebase-heartbeat-store";let Dx=null;function UN(){return Dx||(Dx=jB(y8,b8,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Bh)}catch(t){console.warn(t)}}}}).catch(n=>{throw Fo.create("idb-open",{originalErrorMessage:n.message})})),Dx}async function x8(n){try{const t=(await UN()).transaction(Bh),r=await t.objectStore(Bh).get(FN(n));return await t.done,r}catch(e){if(e instanceof Vs)Rs.warn(e.message);else{const t=Fo.create("idb-get",{originalErrorMessage:e?.message});Rs.warn(t.message)}}}async function q2(n,e){try{const r=(await UN()).transaction(Bh,"readwrite");await r.objectStore(Bh).put(e,FN(n)),await r.done}catch(t){if(t instanceof Vs)Rs.warn(t.message);else{const r=Fo.create("idb-set",{originalErrorMessage:t?.message});Rs.warn(r.message)}}}function FN(n){return`${n.name}!${n.options.appId}`}const _8=1024,w8=30;class E8{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new T8(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=$2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>w8){const i=A8(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Rs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=$2(),{heartbeatsToSend:t,unsentEntries:r}=S8(this._heartbeatsCache.heartbeats),i=C0(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Rs.warn(e),""}}}function $2(){return new Date().toISOString().substring(0,10)}function S8(n,e=_8){const t=[];let r=n.slice();for(const i of n){const a=t.find(o=>o.agent===i.agent);if(a){if(a.dates.push(i.date),H2(t)>e){a.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),H2(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class T8{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return jN()?fB().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await x8(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return q2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return q2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function H2(n){return C0(JSON.stringify({version:2,heartbeats:n})).length}function A8(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function C8(n){id(new mc("platform-logger",e=>new LB(e),"PRIVATE")),id(new mc("heartbeat",e=>new E8(e),"PRIVATE")),Go(M1,F2,n),Go(M1,F2,"esm2020"),Go("fire-js","")}C8("");function GN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const I8=GN,qN=new xp("auth","Firebase",GN());const R0=new mw("@firebase/auth");function R8(n,...e){R0.logLevel<=_t.WARN&&R0.warn(`Auth (${kd}): ${n}`,...e)}function e0(n,...e){R0.logLevel<=_t.ERROR&&R0.error(`Auth (${kd}): ${n}`,...e)}function ia(n,...e){throw bw(n,...e)}function ja(n,...e){return bw(n,...e)}function $N(n,e,t){const r={...I8(),[e]:t};return new xp("auth","Firebase",r).create(e,{appName:n.name})}function Ss(n){return $N(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function bw(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return qN.create(n,...e)}function We(n,e,...t){if(!n)throw bw(e,...t)}function bs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw e0(e),new Error(e)}function Ds(n,e){n||bs(e)}function j1(){return typeof self<"u"&&self.location?.href||""}function D8(){return Y2()==="http:"||Y2()==="https:"}function Y2(){return typeof self<"u"&&self.location?.protocol||null}function k8(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(D8()||cB()||"connection"in navigator)?navigator.onLine:!0}function N8(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class wp{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ds(t>e,"Short delay should be less than long delay!"),this.isMobile=oB()||uB()}get(){return k8()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function xw(n,e){Ds(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class HN{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;bs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;bs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;bs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const M8={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const P8=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],O8=new wp(3e4,6e4);function zs(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Xa(n,e,t,r,i={}){return YN(n,i,async()=>{let a={},o={};r&&(e==="GET"?o=r:a={body:JSON.stringify(r)});const c=_p({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const d={method:e,headers:u,...a};return lB()||(d.referrerPolicy="no-referrer"),n.emulatorConfig&&Dd(n.emulatorConfig.host)&&(d.credentials="include"),HN.fetch()(await KN(n,n.config.apiHost,t,c),d)})}async function YN(n,e,t){n._canInitEmulator=!1;const r={...M8,...e};try{const i=new V8(n),a=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw Am(n,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const c=a.ok?o.errorMessage:o.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Am(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Am(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Am(n,"user-disabled",o);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw $N(n,h,d);ia(n,h)}}catch(i){if(i instanceof Vs)throw i;ia(n,"network-request-failed",{message:String(i)})}}async function Ep(n,e,t,r,i={}){const a=await Xa(n,e,t,r,i);return"mfaPendingCredential"in a&&ia(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function KN(n,e,t,r){const i=`${e}${t}?${r}`,a=n,o=a.config.emulator?xw(n.config,i):`${n.config.apiScheme}://${i}`;return P8.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(o).toString():o}function j8(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class V8{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ja(this.auth,"network-request-failed")),O8.get())})}}function Am(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=ja(n,e,r);return i.customData._tokenResponse=t,i}function K2(n){return n!==void 0&&n.enterprise!==void 0}class z8{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return j8(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function L8(n,e){return Xa(n,"GET","/v2/recaptchaConfig",zs(n,e))}async function B8(n,e){return Xa(n,"POST","/v1/accounts:delete",e)}async function D0(n,e){return Xa(n,"POST","/v1/accounts:lookup",e)}function mh(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function U8(n,e=!1){const t=Jt(n),r=await t.getIdToken(e),i=_w(r);We(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,o=a?.sign_in_provider;return{claims:i,token:r,authTime:mh(kx(i.auth_time)),issuedAtTime:mh(kx(i.iat)),expirationTime:mh(kx(i.exp)),signInProvider:o||null,signInSecondFactor:a?.sign_in_second_factor||null}}function kx(n){return Number(n)*1e3}function _w(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return e0("JWT malformed, contained fewer than 3 sections"),null;try{const i=AN(t);return i?JSON.parse(i):(e0("Failed to decode base64 JWT payload"),null)}catch(i){return e0("Caught error parsing JWT payload as JSON",i?.toString()),null}}function X2(n){const e=_w(n);return We(e,"internal-error"),We(typeof e.exp<"u","internal-error"),We(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ad(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Vs&&F8(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function F8({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class G8{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class V1{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=mh(this.lastLoginAt),this.creationTime=mh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function k0(n){const e=n.auth,t=await n.getIdToken(),r=await ad(n,D0(e,{idToken:t}));We(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const a=i.providerUserInfo?.length?XN(i.providerUserInfo):[],o=$8(n.providerData,a),c=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!o?.length,d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new V1(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,h)}async function q8(n){const e=Jt(n);await k0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function $8(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function XN(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function H8(n,e){const t=await YN(n,{},async()=>{const r=_p({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=n.config,o=await KN(n,i,"/v1/token",`key=${a}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:r};return n.emulatorConfig&&Dd(n.emulatorConfig.host)&&(u.credentials="include"),HN.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Y8(n,e){return Xa(n,"POST","/v2/accounts:revokeToken",zs(n,e))}class Zu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){We(e.idToken,"internal-error"),We(typeof e.idToken<"u","internal-error"),We(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):X2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){We(e.length!==0,"internal-error");const t=X2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(We(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:a}=await H8(e,t);this.updateTokensAndExpiration(r,i,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:a}=t,o=new Zu;return r&&(We(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(We(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),a&&(We(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Zu,this.toJSON())}_performRefresh(){return bs("not implemented")}}function Eo(n,e){We(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ji{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new G8(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new V1(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await ad(this,this.stsTokenManager.getToken(this.auth,e));return We(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return U8(this,e)}reload(){return q8(this)}_assign(e){this!==e&&(We(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ji({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){We(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await k0(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ai(this.auth.app))return Promise.reject(Ss(this.auth));const e=await this.getIdToken();return await ad(this,B8(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,a=t.phoneNumber??void 0,o=t.photoURL??void 0,c=t.tenantId??void 0,u=t._redirectEventId??void 0,d=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:b,providerData:_,stsTokenManager:w}=t;We(p&&w,e,"internal-error");const S=Zu.fromJSON(this.name,w);We(typeof p=="string",e,"internal-error"),Eo(r,e.name),Eo(i,e.name),We(typeof m=="boolean",e,"internal-error"),We(typeof b=="boolean",e,"internal-error"),Eo(a,e.name),Eo(o,e.name),Eo(c,e.name),Eo(u,e.name),Eo(d,e.name),Eo(h,e.name);const T=new Ji({uid:p,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:b,photoURL:o,phoneNumber:a,tenantId:c,stsTokenManager:S,createdAt:d,lastLoginAt:h});return _&&Array.isArray(_)&&(T.providerData=_.map(C=>({...C}))),u&&(T._redirectEventId=u),T}static async _fromIdTokenResponse(e,t,r=!1){const i=new Zu;i.updateFromServerResponse(t);const a=new Ji({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await k0(a),a}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];We(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?XN(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!a?.length,c=new Zu;c.updateFromIdToken(r);const u=new Ji({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new V1(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(u,d),u}}const W2=new Map;function xs(n){Ds(n instanceof Function,"Expected a class definition");let e=W2.get(n);return e?(Ds(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,W2.set(n,e),e)}class WN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}WN.type="NONE";const Q2=WN;function t0(n,e,t){return`firebase:${n}:${e}:${t}`}class Ju{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:a}=this.auth;this.fullUserKey=t0(this.userKey,i.apiKey,a),this.fullPersistenceKey=t0("persistence",i.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await D0(this.auth,{idToken:e}).catch(()=>{});return t?Ji._fromGetAccountInfoResponse(this.auth,t,e):null}return Ji._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Ju(xs(Q2),e,r);const i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let a=i[0]||xs(Q2);const o=t0(r,e.config.apiKey,e.name);let c=null;for(const d of t)try{const h=await d._get(o);if(h){let p;if(typeof h=="string"){const m=await D0(e,{idToken:h}).catch(()=>{});if(!m)break;p=await Ji._fromGetAccountInfoResponse(e,m,h)}else p=Ji._fromJSON(e,h);d!==a&&(c=p),a=d;break}}catch{}const u=i.filter(d=>d._shouldAllowMigration);return!a._shouldAllowMigration||!u.length?new Ju(a,e,r):(a=u[0],c&&await a._set(o,c.toJSON()),await Promise.all(t.map(async d=>{if(d!==a)try{await d._remove(o)}catch{}})),new Ju(a,e,r))}}function Z2(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(eM(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(QN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(nM(e))return"Blackberry";if(rM(e))return"Webos";if(ZN(e))return"Safari";if((e.includes("chrome/")||JN(e))&&!e.includes("edge/"))return"Chrome";if(tM(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function QN(n=Xn()){return/firefox\//i.test(n)}function ZN(n=Xn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function JN(n=Xn()){return/crios\//i.test(n)}function eM(n=Xn()){return/iemobile/i.test(n)}function tM(n=Xn()){return/android/i.test(n)}function nM(n=Xn()){return/blackberry/i.test(n)}function rM(n=Xn()){return/webos/i.test(n)}function ww(n=Xn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function K8(n=Xn()){return ww(n)&&!!window.navigator?.standalone}function X8(){return dB()&&document.documentMode===10}function iM(n=Xn()){return ww(n)||tM(n)||rM(n)||nM(n)||/windows phone/i.test(n)||eM(n)}function aM(n,e=[]){let t;switch(n){case"Browser":t=Z2(Xn());break;case"Worker":t=`${Z2(Xn())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${kd}/${r}`}class W8{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((o,c)=>{try{const u=e(a);o(u)}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function Q8(n,e={}){return Xa(n,"GET","/v2/passwordPolicy",zs(n,e))}const Z8=6;class J8{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Z8,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class eU{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new J2(this),this.idTokenSubscription=new J2(this),this.beforeStateQueue=new W8(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=qN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=xs(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ju.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await D0(this,{idToken:e}),r=await Ji._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ai(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,o=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===o)&&c?.user&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return We(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await k0(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=N8()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ai(this.app))return Promise.reject(Ss(this));const t=e?Jt(e):null;return t&&We(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&We(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ai(this.app)?Promise.reject(Ss(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ai(this.app)?Promise.reject(Ss(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(xs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Q8(this),t=new J8(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new xp("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await Y8(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&xs(e)||this._popupRedirectResolver;We(t,this,"argument-error"),this.redirectPersistenceManager=await Ju.create(this,[xs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(We(c,this,"internal-error"),c.then(()=>{o||a(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,i);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return We(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=aM(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Ai(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&R8(`Error while retrieving App Check token: ${e.error}`),e?.token}}function sl(n){return Jt(n)}class J2{constructor(e){this.auth=e,this.observer=null,this.addObserver=vB(t=>this.observer=t)}get next(){return We(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Av={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function tU(n){Av=n}function sM(n){return Av.loadJS(n)}function nU(){return Av.recaptchaEnterpriseScript}function rU(){return Av.gapiScript}function iU(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class aU{constructor(){this.enterprise=new sU}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class sU{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const oU="recaptcha-enterprise",oM="NO_RECAPTCHA";class lU{constructor(e){this.type=oU,this.auth=sl(e)}async verify(e="verify",t=!1){async function r(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,c)=>{L8(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new z8(u);return a.tenantId==null?a._agentRecaptchaConfig=d:a._tenantRecaptchaConfigs[a.tenantId]=d,o(d.siteKey)}}).catch(u=>{c(u)})})}function i(a,o,c){const u=window.grecaptcha;K2(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:e}).then(d=>{o(d)}).catch(()=>{o(oM)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new aU().execute("siteKey",{action:"verify"}):new Promise((a,o)=>{r(this.auth).then(c=>{if(!t&&K2(window.grecaptcha))i(c,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=nU();u.length!==0&&(u+=c),sM(u).then(()=>{i(c,a,o)}).catch(d=>{o(d)})}}).catch(c=>{o(c)})})}}async function eI(n,e,t,r=!1,i=!1){const a=new lU(n);let o;if(i)o=oM;else try{o=await a.verify(t)}catch{o=await a.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function N0(n,e,t,r,i){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await eI(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await eI(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(a)})}function cU(n,e){const t=yw(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),a=t.getOptions();if(Ko(a,e??{}))return i;ia(i,"already-initialized")}return t.initialize({options:e})}function uU(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(xs);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function dU(n,e,t){const r=sl(n);We(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,a=lM(e),{host:o,port:c}=fU(e),u=c===null?"":`:${c}`,d={url:`${a}//${o}${u}/`},h=Object.freeze({host:o,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){We(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),We(Ko(d,r.config.emulator)&&Ko(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Dd(o)?(kN(`${a}//${o}${u}`),NN("Auth",!0)):hU()}function lM(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function fU(n){const e=lM(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const a=i[1];return{host:a,port:tI(r.substr(a.length+1))}}else{const[a,o]=r.split(":");return{host:a,port:tI(o)}}}function tI(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function hU(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Ew{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return bs("not implemented")}_getIdTokenResponse(e){return bs("not implemented")}_linkToIdToken(e,t){return bs("not implemented")}_getReauthenticationResolver(e){return bs("not implemented")}}async function pU(n,e){return Xa(n,"POST","/v1/accounts:signUp",e)}async function gU(n,e){return Ep(n,"POST","/v1/accounts:signInWithPassword",zs(n,e))}async function cM(n,e){return Xa(n,"POST","/v1/accounts:sendOobCode",zs(n,e))}async function mU(n,e){return cM(n,e)}async function vU(n,e){return cM(n,e)}async function yU(n,e){return Ep(n,"POST","/v1/accounts:signInWithEmailLink",zs(n,e))}async function bU(n,e){return Ep(n,"POST","/v1/accounts:signInWithEmailLink",zs(n,e))}class Uh extends Ew{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Uh(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Uh(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return N0(e,t,"signInWithPassword",gU);case"emailLink":return yU(e,{email:this._email,oobCode:this._password});default:ia(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return N0(e,r,"signUpPassword",pU);case"emailLink":return bU(e,{idToken:t,email:this._email,oobCode:this._password});default:ia(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ed(n,e){return Ep(n,"POST","/v1/accounts:signInWithIdp",zs(n,e))}const xU="http://localhost";class vc extends Ew{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new vc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ia("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...a}=t;if(!r||!i)return null;const o=new vc(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return ed(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,ed(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ed(e,t)}buildRequest(){const e={requestUri:xU,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=_p(t)}return e}}function _U(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function wU(n){const e=rh(ih(n)).link,t=e?rh(ih(e)).deep_link_id:null,r=rh(ih(n)).deep_link_id;return(r?rh(ih(r)).link:null)||r||t||e||n}class Sw{constructor(e){const t=rh(ih(e)),r=t.apiKey??null,i=t.oobCode??null,a=_U(t.mode??null);We(r&&i&&a,"argument-error"),this.apiKey=r,this.operation=a,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=wU(e);try{return new Sw(t)}catch{return null}}}class Mc{constructor(){this.providerId=Mc.PROVIDER_ID}static credential(e,t){return Uh._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Sw.parseLink(t);return We(r,"argument-error"),Uh._fromEmailAndCode(e,r.code,r.tenantId)}}Mc.PROVIDER_ID="password";Mc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Mc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class uM{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Sp extends uM{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ko extends Sp{constructor(){super("facebook.com")}static credential(e){return vc._fromParams({providerId:ko.PROVIDER_ID,signInMethod:ko.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ko.credentialFromTaggedObject(e)}static credentialFromError(e){return ko.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ko.credential(e.oauthAccessToken)}catch{return null}}}ko.FACEBOOK_SIGN_IN_METHOD="facebook.com";ko.PROVIDER_ID="facebook.com";class No extends Sp{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return vc._fromParams({providerId:No.PROVIDER_ID,signInMethod:No.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return No.credentialFromTaggedObject(e)}static credentialFromError(e){return No.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return No.credential(t,r)}catch{return null}}}No.GOOGLE_SIGN_IN_METHOD="google.com";No.PROVIDER_ID="google.com";class Mo extends Sp{constructor(){super("github.com")}static credential(e){return vc._fromParams({providerId:Mo.PROVIDER_ID,signInMethod:Mo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Mo.credentialFromTaggedObject(e)}static credentialFromError(e){return Mo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Mo.credential(e.oauthAccessToken)}catch{return null}}}Mo.GITHUB_SIGN_IN_METHOD="github.com";Mo.PROVIDER_ID="github.com";class Po extends Sp{constructor(){super("twitter.com")}static credential(e,t){return vc._fromParams({providerId:Po.PROVIDER_ID,signInMethod:Po.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Po.credentialFromTaggedObject(e)}static credentialFromError(e){return Po.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Po.credential(t,r)}catch{return null}}}Po.TWITTER_SIGN_IN_METHOD="twitter.com";Po.PROVIDER_ID="twitter.com";async function EU(n,e){return Ep(n,"POST","/v1/accounts:signUp",zs(n,e))}class yc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const a=await Ji._fromIdTokenResponse(e,r,i),o=nI(r);return new yc({user:a,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=nI(r);return new yc({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function nI(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class M0 extends Vs{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,M0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new M0(e,t,r,i)}}function dM(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?M0._fromErrorAndOperation(n,a,e,r):a})}async function SU(n,e,t=!1){const r=await ad(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return yc._forOperation(n,"link",r)}async function fM(n,e,t=!1){const{auth:r}=n;if(Ai(r.app))return Promise.reject(Ss(r));const i="reauthenticate";try{const a=await ad(n,dM(r,i,e,n),t);We(a.idToken,r,"internal-error");const o=_w(a.idToken);We(o,r,"internal-error");const{sub:c}=o;return We(n.uid===c,r,"user-mismatch"),yc._forOperation(n,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&ia(r,"user-mismatch"),a}}async function hM(n,e,t=!1){if(Ai(n.app))return Promise.reject(Ss(n));const r="signIn",i=await dM(n,r,e),a=await yc._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(a.user),a}async function TU(n,e){return hM(sl(n),e)}async function AU(n,e){return fM(Jt(n),e)}function CU(n,e,t){We(t.url?.length>0,n,"invalid-continue-uri"),We(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),We(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(We(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(We(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}async function pM(n){const e=sl(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function IU(n,e,t){const r=sl(n);await N0(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",vU)}async function RU(n,e,t){if(Ai(n.app))return Promise.reject(Ss(n));const r=sl(n),o=await N0(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",EU).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&pM(n),u}),c=await yc._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(c.user),c}function DU(n,e,t){return Ai(n.app)?Promise.reject(Ss(n)):TU(Jt(n),Mc.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&pM(n),r})}async function rI(n,e){const t=Jt(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&CU(t.auth,i,e);const{email:a}=await mU(t.auth,i);a!==n.email&&await n.reload()}async function kU(n,e){return Xa(n,"POST","/v1/accounts:update",e)}async function NU(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=Jt(n),a={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await ad(r,kU(r.auth,a));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const c=r.providerData.find(({providerId:u})=>u==="password");c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function MU(n,e,t,r){return Jt(n).onIdTokenChanged(e,t,r)}function PU(n,e,t){return Jt(n).beforeAuthStateChanged(e,t)}function OU(n,e,t,r){return Jt(n).onAuthStateChanged(e,t,r)}function jU(n){return Jt(n).signOut()}async function VU(n){return Jt(n).delete()}const P0="__sak";class gM{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(P0,"1"),this.storage.removeItem(P0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const zU=1e3,LU=10;class mM extends gM{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=iM(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},a=this.storage.getItem(r);X8()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,LU):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},zU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}mM.type="LOCAL";const BU=mM;class vM extends gM{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}vM.type="SESSION";const yM=vM;function UU(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Cv{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Cv(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:a}=t.data,o=this.handlersMap[i];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const c=Array.from(o).map(async d=>d(t.origin,a)),u=await UU(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Cv.receivers=[];function Tw(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class FU{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,o;return new Promise((c,u)=>{const d=Tw("",20);i.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const m=p;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),a=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(m.data.response);break;default:clearTimeout(h),clearTimeout(a),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Va(){return window}function GU(n){Va().location.href=n}function bM(){return typeof Va().WorkerGlobalScope<"u"&&typeof Va().importScripts=="function"}async function qU(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function $U(){return navigator?.serviceWorker?.controller||null}function HU(){return bM()?self:null}const xM="firebaseLocalStorageDb",YU=1,O0="firebaseLocalStorage",_M="fbase_key";class Tp{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Iv(n,e){return n.transaction([O0],e?"readwrite":"readonly").objectStore(O0)}function KU(){const n=indexedDB.deleteDatabase(xM);return new Tp(n).toPromise()}function z1(){const n=indexedDB.open(xM,YU);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(O0,{keyPath:_M})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(O0)?e(r):(r.close(),await KU(),e(await z1()))})})}async function iI(n,e,t){const r=Iv(n,!0).put({[_M]:e,value:t});return new Tp(r).toPromise()}async function XU(n,e){const t=Iv(n,!1).get(e),r=await new Tp(t).toPromise();return r===void 0?null:r.value}function aI(n,e){const t=Iv(n,!0).delete(e);return new Tp(t).toPromise()}const WU=800,QU=3;class wM{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await z1(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>QU)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return bM()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Cv._getInstance(HU()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await qU(),!this.activeServiceWorker)return;this.sender=new FU(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||$U()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await z1();return await iI(e,P0,"1"),await aI(e,P0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>iI(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>XU(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>aI(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=Iv(i,!1).getAll();return new Tp(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),WU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}wM.type="LOCAL";const ZU=wM;new wp(3e4,6e4);function JU(n,e){return e?xs(e):(We(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Aw extends Ew{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ed(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ed(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ed(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function eF(n){return hM(n.auth,new Aw(n),n.bypassAuthState)}function tF(n){const{auth:e,user:t}=n;return We(t,e,"internal-error"),fM(t,new Aw(n),n.bypassAuthState)}async function nF(n){const{auth:e,user:t}=n;return We(t,e,"internal-error"),SU(t,new Aw(n),n.bypassAuthState)}class EM{constructor(e,t,r,i,a=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:a,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return eF;case"linkViaPopup":case"linkViaRedirect":return nF;case"reauthViaPopup":case"reauthViaRedirect":return tF;default:ia(this.auth,"internal-error")}}resolve(e){Ds(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ds(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const rF=new wp(2e3,1e4);class Lu extends EM{constructor(e,t,r,i,a){super(e,t,i,a),this.provider=r,this.authWindow=null,this.pollId=null,Lu.currentPopupAction&&Lu.currentPopupAction.cancel(),Lu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return We(e,this.auth,"internal-error"),e}async onExecution(){Ds(this.filter.length===1,"Popup operations only handle one event");const e=Tw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ja(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ja(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Lu.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ja(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,rF.get())};e()}}Lu.currentPopupAction=null;const iF="pendingRedirect",n0=new Map;class aF extends EM{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=n0.get(this.auth._key());if(!e){try{const r=await sF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}n0.set(this.auth._key(),e)}return this.bypassAuthState||n0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function sF(n,e){const t=cF(e),r=lF(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function oF(n,e){n0.set(n._key(),e)}function lF(n){return xs(n._redirectPersistence)}function cF(n){return t0(iF,n.config.apiKey,n.name)}async function uF(n,e,t=!1){if(Ai(n.app))return Promise.reject(Ss(n));const r=sl(n),i=JU(r,e),o=await new aF(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}const dF=600*1e3;class fF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!hF(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!SM(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(ja(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=dF&&this.cachedEventUids.clear(),this.cachedEventUids.has(sI(e))}saveEventToCache(e){this.cachedEventUids.add(sI(e)),this.lastProcessedEventTime=Date.now()}}function sI(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function SM({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function hF(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return SM(n);default:return!1}}async function pF(n,e={}){return Xa(n,"GET","/v1/projects",e)}const gF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,mF=/^https?/;async function vF(n){if(n.config.emulator)return;const{authorizedDomains:e}=await pF(n);for(const t of e)try{if(yF(t))return}catch{}ia(n,"unauthorized-domain")}function yF(n){const e=j1(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!mF.test(t))return!1;if(gF.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const bF=new wp(3e4,6e4);function oI(){const n=Va().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function xF(n){return new Promise((e,t)=>{function r(){oI(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{oI(),t(ja(n,"network-request-failed"))},timeout:bF.get()})}if(Va().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Va().gapi?.load)r();else{const i=iU("iframefcb");return Va()[i]=()=>{gapi.load?r():t(ja(n,"network-request-failed"))},sM(`${rU()}?onload=${i}`).catch(a=>t(a))}}).catch(e=>{throw r0=null,e})}let r0=null;function _F(n){return r0=r0||xF(n),r0}const wF=new wp(5e3,15e3),EF="__/auth/iframe",SF="emulator/auth/iframe",TF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},AF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function CF(n){const e=n.config;We(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?xw(e,SF):`https://${n.config.authDomain}/${EF}`,r={apiKey:e.apiKey,appName:n.name,v:kd},i=AF.get(n.config.apiHost);i&&(r.eid=i);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${_p(r).slice(1)}`}async function IF(n){const e=await _F(n),t=Va().gapi;return We(t,n,"internal-error"),e.open({where:document.body,url:CF(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:TF,dontclear:!0},r=>new Promise(async(i,a)=>{await r.restyle({setHideOnLeave:!1});const o=ja(n,"network-request-failed"),c=Va().setTimeout(()=>{a(o)},wF.get());function u(){Va().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{a(o)})}))}const RF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},DF=500,kF=600,NF="_blank",MF="http://localhost";class lI{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function PF(n,e,t,r=DF,i=kF){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u={...RF,width:r.toString(),height:i.toString(),top:a,left:o},d=Xn().toLowerCase();t&&(c=JN(d)?NF:t),QN(d)&&(e=e||MF,u.scrollbars="yes");const h=Object.entries(u).reduce((m,[b,_])=>`${m}${b}=${_},`,"");if(K8(d)&&c!=="_self")return OF(e||"",c),new lI(null);const p=window.open(e||"",c,h);We(p,n,"popup-blocked");try{p.focus()}catch{}return new lI(p)}function OF(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const jF="__/auth/handler",VF="emulator/auth/handler",zF=encodeURIComponent("fac");async function cI(n,e,t,r,i,a){We(n.config.authDomain,n,"auth-domain-config-required"),We(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:kd,eventId:i};if(e instanceof uM){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",mB(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))o[h]=p}if(e instanceof Sp){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);const c=o;for(const h of Object.keys(c))c[h]===void 0&&delete c[h];const u=await n._getAppCheckToken(),d=u?`#${zF}=${encodeURIComponent(u)}`:"";return`${LF(n)}?${_p(c).slice(1)}${d}`}function LF({config:n}){return n.emulator?xw(n,VF):`https://${n.authDomain}/${jF}`}const Nx="webStorageSupport";class BF{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=yM,this._completeRedirectFn=uF,this._overrideRedirectResult=oF}async _openPopup(e,t,r,i){Ds(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await cI(e,t,r,j1(),i);return PF(e,a,Tw())}async _openRedirect(e,t,r,i){await this._originValidation(e);const a=await cI(e,t,r,j1(),i);return GU(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:a}=this.eventManagers[t];return i?Promise.resolve(i):(Ds(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await IF(e),r=new fF(e);return t.register("authEvent",i=>(We(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Nx,{type:Nx},i=>{const a=i?.[0]?.[Nx];a!==void 0&&t(!!a),ia(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=vF(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return iM()||ZN()||ww()}}const UF=BF;var uI="@firebase/auth",dI="1.11.1";class FF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){We(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function GF(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function qF(n){id(new mc("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;We(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:aM(n)},d=new eU(r,i,a,u);return uU(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),id(new mc("auth-internal",e=>{const t=sl(e.getProvider("auth").getImmediate());return(r=>new FF(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Go(uI,dI,GF(n)),Go(uI,dI,"esm2020")}const $F=300,HF=DN("authIdTokenMaxAge")||$F;let fI=null;const YF=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>HF)return;const i=t?.token;fI!==i&&(fI=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function KF(n=BN()){const e=yw(n,"auth");if(e.isInitialized())return e.getImmediate();const t=cU(n,{popupRedirectResolver:UF,persistence:[ZU,BU,yM]}),r=DN("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const o=YF(a.toString());PU(t,o,()=>o(t.currentUser)),MU(t,c=>o(c))}}const i=IN("auth");return i&&dU(t,`http://${i}`),t}function XF(){return document.getElementsByTagName("head")?.[0]??document}tU({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const a=ja("internal-error");a.customData=i,t(a)},r.type="text/javascript",r.charset="UTF-8",XF().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});qF("Browser");var WF="firebase",QF="12.6.0";Go(WF,QF,"app");var hI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var qo,TM;(function(){var n;function e(A,I){function k(){}k.prototype=I.prototype,A.F=I.prototype,A.prototype=new k,A.prototype.constructor=A,A.D=function(z,V,B){for(var j=Array(arguments.length-2),X=2;X<arguments.length;X++)j[X-2]=arguments[X];return I.prototype[V].apply(z,j)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,I,k){k||(k=0);const z=Array(16);if(typeof I=="string")for(var V=0;V<16;++V)z[V]=I.charCodeAt(k++)|I.charCodeAt(k++)<<8|I.charCodeAt(k++)<<16|I.charCodeAt(k++)<<24;else for(V=0;V<16;++V)z[V]=I[k++]|I[k++]<<8|I[k++]<<16|I[k++]<<24;I=A.g[0],k=A.g[1],V=A.g[2];let B=A.g[3],j;j=I+(B^k&(V^B))+z[0]+3614090360&4294967295,I=k+(j<<7&4294967295|j>>>25),j=B+(V^I&(k^V))+z[1]+3905402710&4294967295,B=I+(j<<12&4294967295|j>>>20),j=V+(k^B&(I^k))+z[2]+606105819&4294967295,V=B+(j<<17&4294967295|j>>>15),j=k+(I^V&(B^I))+z[3]+3250441966&4294967295,k=V+(j<<22&4294967295|j>>>10),j=I+(B^k&(V^B))+z[4]+4118548399&4294967295,I=k+(j<<7&4294967295|j>>>25),j=B+(V^I&(k^V))+z[5]+1200080426&4294967295,B=I+(j<<12&4294967295|j>>>20),j=V+(k^B&(I^k))+z[6]+2821735955&4294967295,V=B+(j<<17&4294967295|j>>>15),j=k+(I^V&(B^I))+z[7]+4249261313&4294967295,k=V+(j<<22&4294967295|j>>>10),j=I+(B^k&(V^B))+z[8]+1770035416&4294967295,I=k+(j<<7&4294967295|j>>>25),j=B+(V^I&(k^V))+z[9]+2336552879&4294967295,B=I+(j<<12&4294967295|j>>>20),j=V+(k^B&(I^k))+z[10]+4294925233&4294967295,V=B+(j<<17&4294967295|j>>>15),j=k+(I^V&(B^I))+z[11]+2304563134&4294967295,k=V+(j<<22&4294967295|j>>>10),j=I+(B^k&(V^B))+z[12]+1804603682&4294967295,I=k+(j<<7&4294967295|j>>>25),j=B+(V^I&(k^V))+z[13]+4254626195&4294967295,B=I+(j<<12&4294967295|j>>>20),j=V+(k^B&(I^k))+z[14]+2792965006&4294967295,V=B+(j<<17&4294967295|j>>>15),j=k+(I^V&(B^I))+z[15]+1236535329&4294967295,k=V+(j<<22&4294967295|j>>>10),j=I+(V^B&(k^V))+z[1]+4129170786&4294967295,I=k+(j<<5&4294967295|j>>>27),j=B+(k^V&(I^k))+z[6]+3225465664&4294967295,B=I+(j<<9&4294967295|j>>>23),j=V+(I^k&(B^I))+z[11]+643717713&4294967295,V=B+(j<<14&4294967295|j>>>18),j=k+(B^I&(V^B))+z[0]+3921069994&4294967295,k=V+(j<<20&4294967295|j>>>12),j=I+(V^B&(k^V))+z[5]+3593408605&4294967295,I=k+(j<<5&4294967295|j>>>27),j=B+(k^V&(I^k))+z[10]+38016083&4294967295,B=I+(j<<9&4294967295|j>>>23),j=V+(I^k&(B^I))+z[15]+3634488961&4294967295,V=B+(j<<14&4294967295|j>>>18),j=k+(B^I&(V^B))+z[4]+3889429448&4294967295,k=V+(j<<20&4294967295|j>>>12),j=I+(V^B&(k^V))+z[9]+568446438&4294967295,I=k+(j<<5&4294967295|j>>>27),j=B+(k^V&(I^k))+z[14]+3275163606&4294967295,B=I+(j<<9&4294967295|j>>>23),j=V+(I^k&(B^I))+z[3]+4107603335&4294967295,V=B+(j<<14&4294967295|j>>>18),j=k+(B^I&(V^B))+z[8]+1163531501&4294967295,k=V+(j<<20&4294967295|j>>>12),j=I+(V^B&(k^V))+z[13]+2850285829&4294967295,I=k+(j<<5&4294967295|j>>>27),j=B+(k^V&(I^k))+z[2]+4243563512&4294967295,B=I+(j<<9&4294967295|j>>>23),j=V+(I^k&(B^I))+z[7]+1735328473&4294967295,V=B+(j<<14&4294967295|j>>>18),j=k+(B^I&(V^B))+z[12]+2368359562&4294967295,k=V+(j<<20&4294967295|j>>>12),j=I+(k^V^B)+z[5]+4294588738&4294967295,I=k+(j<<4&4294967295|j>>>28),j=B+(I^k^V)+z[8]+2272392833&4294967295,B=I+(j<<11&4294967295|j>>>21),j=V+(B^I^k)+z[11]+1839030562&4294967295,V=B+(j<<16&4294967295|j>>>16),j=k+(V^B^I)+z[14]+4259657740&4294967295,k=V+(j<<23&4294967295|j>>>9),j=I+(k^V^B)+z[1]+2763975236&4294967295,I=k+(j<<4&4294967295|j>>>28),j=B+(I^k^V)+z[4]+1272893353&4294967295,B=I+(j<<11&4294967295|j>>>21),j=V+(B^I^k)+z[7]+4139469664&4294967295,V=B+(j<<16&4294967295|j>>>16),j=k+(V^B^I)+z[10]+3200236656&4294967295,k=V+(j<<23&4294967295|j>>>9),j=I+(k^V^B)+z[13]+681279174&4294967295,I=k+(j<<4&4294967295|j>>>28),j=B+(I^k^V)+z[0]+3936430074&4294967295,B=I+(j<<11&4294967295|j>>>21),j=V+(B^I^k)+z[3]+3572445317&4294967295,V=B+(j<<16&4294967295|j>>>16),j=k+(V^B^I)+z[6]+76029189&4294967295,k=V+(j<<23&4294967295|j>>>9),j=I+(k^V^B)+z[9]+3654602809&4294967295,I=k+(j<<4&4294967295|j>>>28),j=B+(I^k^V)+z[12]+3873151461&4294967295,B=I+(j<<11&4294967295|j>>>21),j=V+(B^I^k)+z[15]+530742520&4294967295,V=B+(j<<16&4294967295|j>>>16),j=k+(V^B^I)+z[2]+3299628645&4294967295,k=V+(j<<23&4294967295|j>>>9),j=I+(V^(k|~B))+z[0]+4096336452&4294967295,I=k+(j<<6&4294967295|j>>>26),j=B+(k^(I|~V))+z[7]+1126891415&4294967295,B=I+(j<<10&4294967295|j>>>22),j=V+(I^(B|~k))+z[14]+2878612391&4294967295,V=B+(j<<15&4294967295|j>>>17),j=k+(B^(V|~I))+z[5]+4237533241&4294967295,k=V+(j<<21&4294967295|j>>>11),j=I+(V^(k|~B))+z[12]+1700485571&4294967295,I=k+(j<<6&4294967295|j>>>26),j=B+(k^(I|~V))+z[3]+2399980690&4294967295,B=I+(j<<10&4294967295|j>>>22),j=V+(I^(B|~k))+z[10]+4293915773&4294967295,V=B+(j<<15&4294967295|j>>>17),j=k+(B^(V|~I))+z[1]+2240044497&4294967295,k=V+(j<<21&4294967295|j>>>11),j=I+(V^(k|~B))+z[8]+1873313359&4294967295,I=k+(j<<6&4294967295|j>>>26),j=B+(k^(I|~V))+z[15]+4264355552&4294967295,B=I+(j<<10&4294967295|j>>>22),j=V+(I^(B|~k))+z[6]+2734768916&4294967295,V=B+(j<<15&4294967295|j>>>17),j=k+(B^(V|~I))+z[13]+1309151649&4294967295,k=V+(j<<21&4294967295|j>>>11),j=I+(V^(k|~B))+z[4]+4149444226&4294967295,I=k+(j<<6&4294967295|j>>>26),j=B+(k^(I|~V))+z[11]+3174756917&4294967295,B=I+(j<<10&4294967295|j>>>22),j=V+(I^(B|~k))+z[2]+718787259&4294967295,V=B+(j<<15&4294967295|j>>>17),j=k+(B^(V|~I))+z[9]+3951481745&4294967295,A.g[0]=A.g[0]+I&4294967295,A.g[1]=A.g[1]+(V+(j<<21&4294967295|j>>>11))&4294967295,A.g[2]=A.g[2]+V&4294967295,A.g[3]=A.g[3]+B&4294967295}r.prototype.v=function(A,I){I===void 0&&(I=A.length);const k=I-this.blockSize,z=this.C;let V=this.h,B=0;for(;B<I;){if(V==0)for(;B<=k;)i(this,A,B),B+=this.blockSize;if(typeof A=="string"){for(;B<I;)if(z[V++]=A.charCodeAt(B++),V==this.blockSize){i(this,z),V=0;break}}else for(;B<I;)if(z[V++]=A[B++],V==this.blockSize){i(this,z),V=0;break}}this.h=V,this.o+=I},r.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var I=1;I<A.length-8;++I)A[I]=0;I=this.o*8;for(var k=A.length-8;k<A.length;++k)A[k]=I&255,I/=256;for(this.v(A),A=Array(16),I=0,k=0;k<4;++k)for(let z=0;z<32;z+=8)A[I++]=this.g[k]>>>z&255;return A};function a(A,I){var k=c;return Object.prototype.hasOwnProperty.call(k,A)?k[A]:k[A]=I(A)}function o(A,I){this.h=I;const k=[];let z=!0;for(let V=A.length-1;V>=0;V--){const B=A[V]|0;z&&B==I||(k[V]=B,z=!1)}this.g=k}var c={};function u(A){return-128<=A&&A<128?a(A,function(I){return new o([I|0],I<0?-1:0)}):new o([A|0],A<0?-1:0)}function d(A){if(isNaN(A)||!isFinite(A))return p;if(A<0)return S(d(-A));const I=[];let k=1;for(let z=0;A>=k;z++)I[z]=A/k|0,k*=4294967296;return new o(I,0)}function h(A,I){if(A.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(A.charAt(0)=="-")return S(h(A.substring(1),I));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=d(Math.pow(I,8));let z=p;for(let B=0;B<A.length;B+=8){var V=Math.min(8,A.length-B);const j=parseInt(A.substring(B,B+V),I);V<8?(V=d(Math.pow(I,V)),z=z.j(V).add(d(j))):(z=z.j(k),z=z.add(d(j)))}return z}var p=u(0),m=u(1),b=u(16777216);n=o.prototype,n.m=function(){if(w(this))return-S(this).m();let A=0,I=1;for(let k=0;k<this.g.length;k++){const z=this.i(k);A+=(z>=0?z:4294967296+z)*I,I*=4294967296}return A},n.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(_(this))return"0";if(w(this))return"-"+S(this).toString(A);const I=d(Math.pow(A,6));var k=this;let z="";for(;;){const V=O(k,I).g;k=T(k,V.j(I));let B=((k.g.length>0?k.g[0]:k.h)>>>0).toString(A);if(k=V,_(k))return B+z;for(;B.length<6;)B="0"+B;z=B+z}},n.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function _(A){if(A.h!=0)return!1;for(let I=0;I<A.g.length;I++)if(A.g[I]!=0)return!1;return!0}function w(A){return A.h==-1}n.l=function(A){return A=T(this,A),w(A)?-1:_(A)?0:1};function S(A){const I=A.g.length,k=[];for(let z=0;z<I;z++)k[z]=~A.g[z];return new o(k,~A.h).add(m)}n.abs=function(){return w(this)?S(this):this},n.add=function(A){const I=Math.max(this.g.length,A.g.length),k=[];let z=0;for(let V=0;V<=I;V++){let B=z+(this.i(V)&65535)+(A.i(V)&65535),j=(B>>>16)+(this.i(V)>>>16)+(A.i(V)>>>16);z=j>>>16,B&=65535,j&=65535,k[V]=j<<16|B}return new o(k,k[k.length-1]&-2147483648?-1:0)};function T(A,I){return A.add(S(I))}n.j=function(A){if(_(this)||_(A))return p;if(w(this))return w(A)?S(this).j(S(A)):S(S(this).j(A));if(w(A))return S(this.j(S(A)));if(this.l(b)<0&&A.l(b)<0)return d(this.m()*A.m());const I=this.g.length+A.g.length,k=[];for(var z=0;z<2*I;z++)k[z]=0;for(z=0;z<this.g.length;z++)for(let V=0;V<A.g.length;V++){const B=this.i(z)>>>16,j=this.i(z)&65535,X=A.i(V)>>>16,H=A.i(V)&65535;k[2*z+2*V]+=j*H,C(k,2*z+2*V),k[2*z+2*V+1]+=B*H,C(k,2*z+2*V+1),k[2*z+2*V+1]+=j*X,C(k,2*z+2*V+1),k[2*z+2*V+2]+=B*X,C(k,2*z+2*V+2)}for(A=0;A<I;A++)k[A]=k[2*A+1]<<16|k[2*A];for(A=I;A<2*I;A++)k[A]=0;return new o(k,0)};function C(A,I){for(;(A[I]&65535)!=A[I];)A[I+1]+=A[I]>>>16,A[I]&=65535,I++}function R(A,I){this.g=A,this.h=I}function O(A,I){if(_(I))throw Error("division by zero");if(_(A))return new R(p,p);if(w(A))return I=O(S(A),I),new R(S(I.g),S(I.h));if(w(I))return I=O(A,S(I)),new R(S(I.g),I.h);if(A.g.length>30){if(w(A)||w(I))throw Error("slowDivide_ only works with positive integers.");for(var k=m,z=I;z.l(A)<=0;)k=P(k),z=P(z);var V=N(k,1),B=N(z,1);for(z=N(z,2),k=N(k,2);!_(z);){var j=B.add(z);j.l(A)<=0&&(V=V.add(k),B=j),z=N(z,1),k=N(k,1)}return I=T(A,V.j(I)),new R(V,I)}for(V=p;A.l(I)>=0;){for(k=Math.max(1,Math.floor(A.m()/I.m())),z=Math.ceil(Math.log(k)/Math.LN2),z=z<=48?1:Math.pow(2,z-48),B=d(k),j=B.j(I);w(j)||j.l(A)>0;)k-=z,B=d(k),j=B.j(I);_(B)&&(B=m),V=V.add(B),A=T(A,j)}return new R(V,A)}n.B=function(A){return O(this,A).h},n.and=function(A){const I=Math.max(this.g.length,A.g.length),k=[];for(let z=0;z<I;z++)k[z]=this.i(z)&A.i(z);return new o(k,this.h&A.h)},n.or=function(A){const I=Math.max(this.g.length,A.g.length),k=[];for(let z=0;z<I;z++)k[z]=this.i(z)|A.i(z);return new o(k,this.h|A.h)},n.xor=function(A){const I=Math.max(this.g.length,A.g.length),k=[];for(let z=0;z<I;z++)k[z]=this.i(z)^A.i(z);return new o(k,this.h^A.h)};function P(A){const I=A.g.length+1,k=[];for(let z=0;z<I;z++)k[z]=A.i(z)<<1|A.i(z-1)>>>31;return new o(k,A.h)}function N(A,I){const k=I>>5;I%=32;const z=A.g.length-k,V=[];for(let B=0;B<z;B++)V[B]=I>0?A.i(B+k)>>>I|A.i(B+k+1)<<32-I:A.i(B+k);return new o(V,A.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,TM=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,qo=o}).apply(typeof hI<"u"?hI:typeof self<"u"?self:typeof window<"u"?window:{});var Cm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var AM,ah,CM,i0,L1,IM,RM,DM;(function(){var n,e=Object.defineProperty;function t(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof Cm=="object"&&Cm];for(var D=0;D<y.length;++D){var L=y[D];if(L&&L.Math==Math)return L}throw Error("Cannot find global object")}var r=t(this);function i(y,D){if(D)e:{var L=r;y=y.split(".");for(var q=0;q<y.length-1;q++){var se=y[q];if(!(se in L))break e;L=L[se]}y=y[y.length-1],q=L[y],D=D(q),D!=q&&D!=null&&e(L,y,{configurable:!0,writable:!0,value:D})}}i("Symbol.dispose",function(y){return y||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(y){return y||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(y){return y||function(D){var L=[],q;for(q in D)Object.prototype.hasOwnProperty.call(D,q)&&L.push([q,D[q]]);return L}});var a=a||{},o=this||self;function c(y){var D=typeof y;return D=="object"&&y!=null||D=="function"}function u(y,D,L){return y.call.apply(y.bind,arguments)}function d(y,D,L){return d=u,d.apply(null,arguments)}function h(y,D){var L=Array.prototype.slice.call(arguments,1);return function(){var q=L.slice();return q.push.apply(q,arguments),y.apply(this,q)}}function p(y,D){function L(){}L.prototype=D.prototype,y.Z=D.prototype,y.prototype=new L,y.prototype.constructor=y,y.Ob=function(q,se,pe){for(var De=Array(arguments.length-2),ct=2;ct<arguments.length;ct++)De[ct-2]=arguments[ct];return D.prototype[se].apply(q,De)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?y=>y&&AsyncContext.Snapshot.wrap(y):y=>y;function b(y){const D=y.length;if(D>0){const L=Array(D);for(let q=0;q<D;q++)L[q]=y[q];return L}return[]}function _(y,D){for(let q=1;q<arguments.length;q++){const se=arguments[q];var L=typeof se;if(L=L!="object"?L:se?Array.isArray(se)?"array":L:"null",L=="array"||L=="object"&&typeof se.length=="number"){L=y.length||0;const pe=se.length||0;y.length=L+pe;for(let De=0;De<pe;De++)y[L+De]=se[De]}else y.push(se)}}class w{constructor(D,L){this.i=D,this.j=L,this.h=0,this.g=null}get(){let D;return this.h>0?(this.h--,D=this.g,this.g=D.next,D.next=null):D=this.i(),D}}function S(y){o.setTimeout(()=>{throw y},0)}function T(){var y=A;let D=null;return y.g&&(D=y.g,y.g=y.g.next,y.g||(y.h=null),D.next=null),D}class C{constructor(){this.h=this.g=null}add(D,L){const q=R.get();q.set(D,L),this.h?this.h.next=q:this.g=q,this.h=q}}var R=new w(()=>new O,y=>y.reset());class O{constructor(){this.next=this.g=this.h=null}set(D,L){this.h=D,this.g=L,this.next=null}reset(){this.next=this.g=this.h=null}}let P,N=!1,A=new C,I=()=>{const y=Promise.resolve(void 0);P=()=>{y.then(k)}};function k(){for(var y;y=T();){try{y.h.call(y.g)}catch(L){S(L)}var D=R;D.j(y),D.h<100&&(D.h++,y.next=D.g,D.g=y)}N=!1}function z(){this.u=this.u,this.C=this.C}z.prototype.u=!1,z.prototype.dispose=function(){this.u||(this.u=!0,this.N())},z.prototype[Symbol.dispose]=function(){this.dispose()},z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(y,D){this.type=y,this.g=this.target=D,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var y=!1,D=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const L=()=>{};o.addEventListener("test",L,D),o.removeEventListener("test",L,D)}catch{}return y})();function j(y){return/^[\s\xa0]*$/.test(y)}function X(y,D){V.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y&&this.init(y,D)}p(X,V),X.prototype.init=function(y,D){const L=this.type=y.type,q=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;this.target=y.target||y.srcElement,this.g=D,D=y.relatedTarget,D||(L=="mouseover"?D=y.fromElement:L=="mouseout"&&(D=y.toElement)),this.relatedTarget=D,q?(this.clientX=q.clientX!==void 0?q.clientX:q.pageX,this.clientY=q.clientY!==void 0?q.clientY:q.pageY,this.screenX=q.screenX||0,this.screenY=q.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=y.pointerType,this.state=y.state,this.i=y,y.defaultPrevented&&X.Z.h.call(this)},X.prototype.h=function(){X.Z.h.call(this);const y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var H="closure_listenable_"+(Math.random()*1e6|0),$=0;function W(y,D,L,q,se){this.listener=y,this.proxy=null,this.src=D,this.type=L,this.capture=!!q,this.ha=se,this.key=++$,this.da=this.fa=!1}function ee(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function he(y,D,L){for(const q in y)D.call(L,y[q],q,y)}function K(y,D){for(const L in y)D.call(void 0,y[L],L,y)}function G(y){const D={};for(const L in y)D[L]=y[L];return D}const Y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function re(y,D){let L,q;for(let se=1;se<arguments.length;se++){q=arguments[se];for(L in q)y[L]=q[L];for(let pe=0;pe<Y.length;pe++)L=Y[pe],Object.prototype.hasOwnProperty.call(q,L)&&(y[L]=q[L])}}function Z(y){this.src=y,this.g={},this.h=0}Z.prototype.add=function(y,D,L,q,se){const pe=y.toString();y=this.g[pe],y||(y=this.g[pe]=[],this.h++);const De=fe(y,D,q,se);return De>-1?(D=y[De],L||(D.fa=!1)):(D=new W(D,this.src,pe,!!q,se),D.fa=L,y.push(D)),D};function oe(y,D){const L=D.type;if(L in y.g){var q=y.g[L],se=Array.prototype.indexOf.call(q,D,void 0),pe;(pe=se>=0)&&Array.prototype.splice.call(q,se,1),pe&&(ee(D),y.g[L].length==0&&(delete y.g[L],y.h--))}}function fe(y,D,L,q){for(let se=0;se<y.length;++se){const pe=y[se];if(!pe.da&&pe.listener==D&&pe.capture==!!L&&pe.ha==q)return se}return-1}var be="closure_lm_"+(Math.random()*1e6|0),Ce={};function we(y,D,L,q,se){if(Array.isArray(D)){for(let pe=0;pe<D.length;pe++)we(y,D[pe],L,q,se);return null}return L=Le(L),y&&y[H]?y.J(D,L,c(q)?!!q.capture:!1,se):Pe(y,D,L,!1,q,se)}function Pe(y,D,L,q,se,pe){if(!D)throw Error("Invalid event type");const De=c(se)?!!se.capture:!!se;let ct=Fe(y);if(ct||(y[be]=ct=new Z(y)),L=ct.add(D,L,q,De,pe),L.proxy)return L;if(q=ue(),L.proxy=q,q.src=y,q.listener=L,y.addEventListener)B||(se=De),se===void 0&&(se=!1),y.addEventListener(D.toString(),q,se);else if(y.attachEvent)y.attachEvent(Ne(D.toString()),q);else if(y.addListener&&y.removeListener)y.addListener(q);else throw Error("addEventListener and attachEvent are unavailable.");return L}function ue(){function y(L){return D.call(y.src,y.listener,L)}const D=qe;return y}function _e(y,D,L,q,se){if(Array.isArray(D))for(var pe=0;pe<D.length;pe++)_e(y,D[pe],L,q,se);else q=c(q)?!!q.capture:!!q,L=Le(L),y&&y[H]?(y=y.i,pe=String(D).toString(),pe in y.g&&(D=y.g[pe],L=fe(D,L,q,se),L>-1&&(ee(D[L]),Array.prototype.splice.call(D,L,1),D.length==0&&(delete y.g[pe],y.h--)))):y&&(y=Fe(y))&&(D=y.g[D.toString()],y=-1,D&&(y=fe(D,L,q,se)),(L=y>-1?D[y]:null)&&ze(L))}function ze(y){if(typeof y!="number"&&y&&!y.da){var D=y.src;if(D&&D[H])oe(D.i,y);else{var L=y.type,q=y.proxy;D.removeEventListener?D.removeEventListener(L,q,y.capture):D.detachEvent?D.detachEvent(Ne(L),q):D.addListener&&D.removeListener&&D.removeListener(q),(L=Fe(D))?(oe(L,y),L.h==0&&(L.src=null,D[be]=null)):ee(y)}}}function Ne(y){return y in Ce?Ce[y]:Ce[y]="on"+y}function qe(y,D){if(y.da)y=!0;else{D=new X(D,this);const L=y.listener,q=y.ha||y.src;y.fa&&ze(y),y=L.call(q,D)}return y}function Fe(y){return y=y[be],y instanceof Z?y:null}var Te="__closure_events_fn_"+(Math.random()*1e9>>>0);function Le(y){return typeof y=="function"?y:(y[Te]||(y[Te]=function(D){return y.handleEvent(D)}),y[Te])}function Me(){z.call(this),this.i=new Z(this),this.M=this,this.G=null}p(Me,z),Me.prototype[H]=!0,Me.prototype.removeEventListener=function(y,D,L,q){_e(this,y,D,L,q)};function Be(y,D){var L,q=y.G;if(q)for(L=[];q;q=q.G)L.push(q);if(y=y.M,q=D.type||D,typeof D=="string")D=new V(D,y);else if(D instanceof V)D.target=D.target||y;else{var se=D;D=new V(q,y),re(D,se)}se=!0;let pe,De;if(L)for(De=L.length-1;De>=0;De--)pe=D.g=L[De],se=lt(pe,q,!0,D)&&se;if(pe=D.g=y,se=lt(pe,q,!0,D)&&se,se=lt(pe,q,!1,D)&&se,L)for(De=0;De<L.length;De++)pe=D.g=L[De],se=lt(pe,q,!1,D)&&se}Me.prototype.N=function(){if(Me.Z.N.call(this),this.i){var y=this.i;for(const D in y.g){const L=y.g[D];for(let q=0;q<L.length;q++)ee(L[q]);delete y.g[D],y.h--}}this.G=null},Me.prototype.J=function(y,D,L,q){return this.i.add(String(y),D,!1,L,q)},Me.prototype.K=function(y,D,L,q){return this.i.add(String(y),D,!0,L,q)};function lt(y,D,L,q){if(D=y.i.g[String(D)],!D)return!0;D=D.concat();let se=!0;for(let pe=0;pe<D.length;++pe){const De=D[pe];if(De&&!De.da&&De.capture==L){const ct=De.listener,_n=De.ha||De.src;De.fa&&oe(y.i,De),se=ct.call(_n,q)!==!1&&se}}return se&&!q.defaultPrevented}function At(y,D){if(typeof y!="function")if(y&&typeof y.handleEvent=="function")y=d(y.handleEvent,y);else throw Error("Invalid listener argument");return Number(D)>2147483647?-1:o.setTimeout(y,D||0)}function et(y){y.g=At(()=>{y.g=null,y.i&&(y.i=!1,et(y))},y.l);const D=y.h;y.h=null,y.m.apply(null,D)}class ft extends z{constructor(D,L){super(),this.m=D,this.l=L,this.h=null,this.i=!1,this.g=null}j(D){this.h=arguments,this.g?this.i=!0:et(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function kt(y){z.call(this),this.h=y,this.g={}}p(kt,z);var pn=[];function Ut(y){he(y.g,function(D,L){this.g.hasOwnProperty(L)&&ze(D)},y),y.g={}}kt.prototype.N=function(){kt.Z.N.call(this),Ut(this)},kt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Cn=o.JSON.stringify,Hr=o.JSON.parse,ua=class{stringify(y){return o.JSON.stringify(y,void 0)}parse(y){return o.JSON.parse(y,void 0)}};function Qa(){}function Fs(){}var Yr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function In(){V.call(this,"d")}p(In,V);function dr(){V.call(this,"c")}p(dr,V);var sn={},Lc=null;function Gs(){return Lc=Lc||new Me}sn.Ia="serverreachability";function qs(y){V.call(this,sn.Ia,y)}p(qs,V);function mt(y){const D=Gs();Be(D,new qs(D))}sn.STAT_EVENT="statevent";function on(y,D){V.call(this,sn.STAT_EVENT,y),this.stat=D}p(on,V);function ln(y){const D=Gs();Be(D,new on(D,y))}sn.Ja="timingevent";function Kr(y,D){V.call(this,sn.Ja,y),this.size=D}p(Kr,V);function ui(y,D){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){y()},D)}function _r(){this.g=!0}_r.prototype.ua=function(){this.g=!1};function xy(y,D,L,q,se,pe){y.info(function(){if(y.g)if(pe){var De="",ct=pe.split("&");for(let Nt=0;Nt<ct.length;Nt++){var _n=ct[Nt].split("=");if(_n.length>1){const en=_n[0];_n=_n[1];const pi=en.split("_");De=pi.length>=2&&pi[1]=="type"?De+(en+"="+_n+"&"):De+(en+"=redacted&")}}}else De=null;else De=pe;return"XMLHTTP REQ ("+q+") [attempt "+se+"]: "+D+`
`+L+`
`+De})}function tg(y,D,L,q,se,pe,De){y.info(function(){return"XMLHTTP RESP ("+q+") [ attempt "+se+"]: "+D+`
`+L+`
`+pe+" "+De})}function da(y,D,L,q){y.info(function(){return"XMLHTTP TEXT ("+D+"): "+_y(y,L)+(q?" "+q:"")})}function fl(y,D){y.info(function(){return"TIMEOUT: "+D})}_r.prototype.info=function(){};function _y(y,D){if(!y.g)return D;if(!D)return null;try{const pe=JSON.parse(D);if(pe){for(y=0;y<pe.length;y++)if(Array.isArray(pe[y])){var L=pe[y];if(!(L.length<2)){var q=L[1];if(Array.isArray(q)&&!(q.length<1)){var se=q[0];if(se!="noop"&&se!="stop"&&se!="close")for(let De=1;De<q.length;De++)q[De]=""}}}}return Cn(pe)}catch{return D}}var hl={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Hd={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Yd;function pl(){}p(pl,Qa),pl.prototype.g=function(){return new XMLHttpRequest},Yd=new pl;function Za(y){return encodeURIComponent(String(y))}function ng(y){var D=1;y=y.split(":");const L=[];for(;D>0&&y.length;)L.push(y.shift()),D--;return y.length&&L.push(y.join(":")),L}function Vi(y,D,L,q){this.j=y,this.i=D,this.l=L,this.S=q||1,this.V=new kt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new zi}function zi(){this.i=null,this.g="",this.h=!1}var Rn={},Qn={};function fa(y,D,L){y.M=1,y.A=gl(kn(D)),y.u=L,y.R=!0,Bc(y,null)}function Bc(y,D){y.F=Date.now(),ha(y),y.B=kn(y.A);var L=y.B,q=y.S;Array.isArray(q)||(q=[String(q)]),qc(L.i,"t",q),y.C=0,L=y.j.L,y.h=new zi,y.g=vg(y.j,L?D:null,!y.u),y.P>0&&(y.O=new ft(d(y.Y,y,y.g),y.P)),D=y.V,L=y.g,q=y.ba;var se="readystatechange";Array.isArray(se)||(se&&(pn[0]=se.toString()),se=pn);for(let pe=0;pe<se.length;pe++){const De=we(L,se[pe],q||D.handleEvent,!1,D.h||D);if(!De)break;D.g[De.key]=De}D=y.J?G(y.J):{},y.u?(y.v||(y.v="POST"),D["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.B,y.v,y.u,D)):(y.v="GET",y.g.ea(y.B,y.v,null,D)),mt(),xy(y.i,y.v,y.B,y.l,y.S,y.u)}Vi.prototype.ba=function(y){y=y.target;const D=this.O;D&&Ui(y)==3?D.j():this.Y(y)},Vi.prototype.Y=function(y){try{if(y==this.g)e:{const ct=Ui(this.g),_n=this.g.ya(),Nt=this.g.ca();if(!(ct<3)&&(ct!=3||this.g&&(this.h.h||this.g.la()||tr(this.g)))){this.K||ct!=4||_n==7||(_n==8||Nt<=0?mt(3):mt(2)),pa(this);var D=this.g.ca();this.X=D;var L=wy(this);if(this.o=D==200,tg(this.i,this.v,this.B,this.l,this.S,ct,D),this.o){if(this.U&&!this.L){t:{if(this.g){var q,se=this.g;if((q=se.g?se.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(q)){var pe=q;break t}}pe=null}if(y=pe)da(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ga(this,y);else{this.o=!1,this.m=3,ln(12),Xr(this),di(this);break e}}if(this.R){y=!0;let en;for(;!this.K&&this.C<L.length;)if(en=ig(this,L),en==Qn){ct==4&&(this.m=4,ln(14),y=!1),da(this.i,this.l,null,"[Incomplete Response]");break}else if(en==Rn){this.m=4,ln(15),da(this.i,this.l,L,"[Invalid Chunk]"),y=!1;break}else da(this.i,this.l,en,null),ga(this,en);if(rg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ct!=4||L.length!=0||this.h.h||(this.m=1,ln(16),y=!1),this.o=this.o&&y,!y)da(this.i,this.l,L,"[Invalid Chunked Response]"),Xr(this),di(this);else if(L.length>0&&!this.W){this.W=!0;var De=this.j;De.g==this&&De.aa&&!De.P&&(De.j.info("Great, no buffering proxy detected. Bytes received: "+L.length),cf(De),De.P=!0,ln(11))}}else da(this.i,this.l,L,null),ga(this,L);ct==4&&Xr(this),this.o&&!this.K&&(ct==4?hg(this.j,this):(this.o=!1,ha(this)))}else es(this.g),D==400&&L.indexOf("Unknown SID")>0?(this.m=3,ln(12)):(this.m=0,ln(13)),Xr(this),di(this)}}}catch{}finally{}};function wy(y){if(!rg(y))return y.g.la();const D=tr(y.g);if(D==="")return"";let L="";const q=D.length,se=Ui(y.g)==4;if(!y.h.i){if(typeof TextDecoder>"u")return Xr(y),di(y),"";y.h.i=new o.TextDecoder}for(let pe=0;pe<q;pe++)y.h.h=!0,L+=y.h.i.decode(D[pe],{stream:!(se&&pe==q-1)});return D.length=0,y.h.g+=L,y.C=0,y.h.g}function rg(y){return y.g?y.v=="GET"&&y.M!=2&&y.j.Aa:!1}function ig(y,D){var L=y.C,q=D.indexOf(`
`,L);return q==-1?Qn:(L=Number(D.substring(L,q)),isNaN(L)?Rn:(q+=1,q+L>D.length?Qn:(D=D.slice(q,q+L),y.C=q+L,D)))}Vi.prototype.cancel=function(){this.K=!0,Xr(this)};function ha(y){y.T=Date.now()+y.H,Uc(y,y.H)}function Uc(y,D){if(y.D!=null)throw Error("WatchDog timer not null");y.D=ui(d(y.aa,y),D)}function pa(y){y.D&&(o.clearTimeout(y.D),y.D=null)}Vi.prototype.aa=function(){this.D=null;const y=Date.now();y-this.T>=0?(fl(this.i,this.B),this.M!=2&&(mt(),ln(17)),Xr(this),this.m=2,di(this)):Uc(this,this.T-y)};function di(y){y.j.I==0||y.K||hg(y.j,y)}function Xr(y){pa(y);var D=y.O;D&&typeof D.dispose=="function"&&D.dispose(),y.O=null,Ut(y.V),y.g&&(D=y.g,y.g=null,D.abort(),D.dispose())}function ga(y,D){try{var L=y.j;if(L.I!=0&&(L.g==y||va(L.h,y))){if(!y.L&&va(L.h,y)&&L.I==3){try{var q=L.Ba.g.parse(D)}catch{q=null}if(Array.isArray(q)&&q.length==3){var se=q;if(se[0]==0){e:if(!L.v){if(L.g)if(L.g.F+3e3<y.F)Xc(L),Zs(L);else break e;wl(L),ln(18)}}else L.xa=se[1],0<L.xa-L.K&&se[2]<37500&&L.F&&L.A==0&&!L.C&&(L.C=ui(d(L.Va,L),6e3));ma(L.h)<=1&&L.ta&&(L.ta=void 0)}else Ea(L,11)}else if((y.L||L.g==y)&&Xc(L),!j(D))for(se=L.Ba.g.parse(D),D=0;D<se.length;D++){let Nt=se[D];const en=Nt[0];if(!(en<=L.K))if(L.K=en,Nt=Nt[1],L.I==2)if(Nt[0]=="c"){L.M=Nt[1],L.ba=Nt[2];const pi=Nt[3];pi!=null&&(L.ka=pi,L.j.info("VER="+L.ka));const Sa=Nt[4];Sa!=null&&(L.za=Sa,L.j.info("SVER="+L.za));const Fi=Nt[5];Fi!=null&&typeof Fi=="number"&&Fi>0&&(q=1.5*Fi,L.O=q,L.j.info("backChannelRequestTimeoutMs_="+q)),q=L;const Gi=y.g;if(Gi){const El=Gi.g?Gi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(El){var pe=q.h;pe.g||El.indexOf("spdy")==-1&&El.indexOf("quic")==-1&&El.indexOf("h2")==-1||(pe.j=pe.l,pe.g=new Set,pe.h&&(Wd(pe,pe.h),pe.h=null))}if(q.G){const Wc=Gi.g?Gi.g.getResponseHeader("X-HTTP-Session-Id"):null;Wc&&(q.wa=Wc,Ot(q.J,q.G,Wc))}}L.I=3,L.l&&L.l.ra(),L.aa&&(L.T=Date.now()-y.F,L.j.info("Handshake RTT: "+L.T+"ms")),q=L;var De=y;if(q.na=mg(q,q.L?q.ba:null,q.W),De.L){Qd(q.h,De);var ct=De,_n=q.O;_n&&(ct.H=_n),ct.D&&(pa(ct),ha(ct)),q.g=De}else dg(q);L.i.length>0&&wa(L)}else Nt[0]!="stop"&&Nt[0]!="close"||Ea(L,7);else L.I==3&&(Nt[0]=="stop"||Nt[0]=="close"?Nt[0]=="stop"?Ea(L,7):of(L):Nt[0]!="noop"&&L.l&&L.l.qa(Nt),L.A=0)}}mt(4)}catch{}}var Dn=class{constructor(y,D){this.g=y,this.map=D}};function Kd(y){this.l=y||10,o.PerformanceNavigationTiming?(y=o.performance.getEntriesByType("navigation"),y=y.length>0&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Xd(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function ma(y){return y.h?1:y.g?y.g.size:0}function va(y,D){return y.h?y.h==D:y.g?y.g.has(D):!1}function Wd(y,D){y.g?y.g.add(D):y.h=D}function Qd(y,D){y.h&&y.h==D?y.h=null:y.g&&y.g.has(D)&&y.g.delete(D)}Kd.prototype.cancel=function(){if(this.i=Zd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function Zd(y){if(y.h!=null)return y.i.concat(y.h.G);if(y.g!=null&&y.g.size!==0){let D=y.i;for(const L of y.g.values())D=D.concat(L.G);return D}return b(y.i)}var ag=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Fc(y,D){if(y){y=y.split("&");for(let L=0;L<y.length;L++){const q=y[L].indexOf("=");let se,pe=null;q>=0?(se=y[L].substring(0,q),pe=y[L].substring(q+1)):se=y[L],D(se,pe?decodeURIComponent(pe.replace(/\+/g," ")):"")}}}function Wr(y){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let D;y instanceof Wr?(this.l=y.l,Zn(this,y.j),this.o=y.o,this.g=y.g,$s(this,y.u),this.h=y.h,Jd(this,cg(y.i)),this.m=y.m):y&&(D=String(y).match(ag))?(this.l=!1,Zn(this,D[1]||"",!0),this.o=ya(D[2]||""),this.g=ya(D[3]||"",!0),$s(this,D[4]),this.h=ya(D[5]||"",!0),Jd(this,D[6]||"",!0),this.m=ya(D[7]||"")):(this.l=!1,this.i=new Ys(null,this.l))}Wr.prototype.toString=function(){const y=[];var D=this.j;D&&y.push(ml(D,Gc,!0),":");var L=this.g;return(L||D=="file")&&(y.push("//"),(D=this.o)&&y.push(ml(D,Gc,!0),"@"),y.push(Za(L).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),L=this.u,L!=null&&y.push(":",String(L))),(L=this.h)&&(this.g&&L.charAt(0)!="/"&&y.push("/"),y.push(ml(L,L.charAt(0)=="/"?ef:sg,!0))),(L=this.i.toString())&&y.push("?",L),(L=this.m)&&y.push("#",ml(L,og)),y.join("")},Wr.prototype.resolve=function(y){const D=kn(this);let L=!!y.j;L?Zn(D,y.j):L=!!y.o,L?D.o=y.o:L=!!y.g,L?D.g=y.g:L=y.u!=null;var q=y.h;if(L)$s(D,y.u);else if(L=!!y.h){if(q.charAt(0)!="/")if(this.g&&!this.h)q="/"+q;else{var se=D.h.lastIndexOf("/");se!=-1&&(q=D.h.slice(0,se+1)+q)}if(se=q,se==".."||se==".")q="";else if(se.indexOf("./")!=-1||se.indexOf("/.")!=-1){q=se.lastIndexOf("/",0)==0,se=se.split("/");const pe=[];for(let De=0;De<se.length;){const ct=se[De++];ct=="."?q&&De==se.length&&pe.push(""):ct==".."?((pe.length>1||pe.length==1&&pe[0]!="")&&pe.pop(),q&&De==se.length&&pe.push("")):(pe.push(ct),q=!0)}q=pe.join("/")}else q=se}return L?D.h=q:L=y.i.toString()!=="",L?Jd(D,cg(y.i)):L=!!y.m,L&&(D.m=y.m),D};function kn(y){return new Wr(y)}function Zn(y,D,L){y.j=L?ya(D,!0):D,y.j&&(y.j=y.j.replace(/:$/,""))}function $s(y,D){if(D){if(D=Number(D),isNaN(D)||D<0)throw Error("Bad port number "+D);y.u=D}else y.u=null}function Jd(y,D,L){D instanceof Ys?(y.i=D,$c(y.i,y.l)):(L||(D=ml(D,Hs)),y.i=new Ys(D,y.l))}function Ot(y,D,L){y.i.set(D,L)}function gl(y){return Ot(y,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),y}function ya(y,D){return y?D?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function ml(y,D,L){return typeof y=="string"?(y=encodeURI(y).replace(D,Nr),L&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Nr(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var Gc=/[#\/\?@]/g,sg=/[#\?:]/g,ef=/[#\?]/g,Hs=/[#\?@]/g,og=/#/g;function Ys(y,D){this.h=this.g=null,this.i=y||null,this.j=!!D}function Mr(y){y.g||(y.g=new Map,y.h=0,y.i&&Fc(y.i,function(D,L){y.add(decodeURIComponent(D.replace(/\+/g," ")),L)}))}n=Ys.prototype,n.add=function(y,D){Mr(this),this.i=null,y=Ks(this,y);let L=this.g.get(y);return L||this.g.set(y,L=[]),L.push(D),this.h+=1,this};function lg(y,D){Mr(y),D=Ks(y,D),y.g.has(D)&&(y.i=null,y.h-=y.g.get(D).length,y.g.delete(D))}function tf(y,D){return Mr(y),D=Ks(y,D),y.g.has(D)}n.forEach=function(y,D){Mr(this),this.g.forEach(function(L,q){L.forEach(function(se){y.call(D,se,q,this)},this)},this)};function nf(y,D){Mr(y);let L=[];if(typeof D=="string")tf(y,D)&&(L=L.concat(y.g.get(Ks(y,D))));else for(y=Array.from(y.g.values()),D=0;D<y.length;D++)L=L.concat(y[D]);return L}n.set=function(y,D){return Mr(this),this.i=null,y=Ks(this,y),tf(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[D]),this.h+=1,this},n.get=function(y,D){return y?(y=nf(this,y),y.length>0?String(y[0]):D):D};function qc(y,D,L){lg(y,D),L.length>0&&(y.i=null,y.g.set(Ks(y,D),b(L)),y.h+=L.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],D=Array.from(this.g.keys());for(let q=0;q<D.length;q++){var L=D[q];const se=Za(L);L=nf(this,L);for(let pe=0;pe<L.length;pe++){let De=se;L[pe]!==""&&(De+="="+Za(L[pe])),y.push(De)}}return this.i=y.join("&")};function cg(y){const D=new Ys;return D.i=y.i,y.g&&(D.g=new Map(y.g),D.h=y.h),D}function Ks(y,D){return D=String(D),y.j&&(D=D.toLowerCase()),D}function $c(y,D){D&&!y.j&&(Mr(y),y.i=null,y.g.forEach(function(L,q){const se=q.toLowerCase();q!=se&&(lg(this,q),qc(this,se,L))},y)),y.j=D}function Li(y,D){const L=new _r;if(o.Image){const q=new Image;q.onload=h(fi,L,"TestLoadImage: loaded",!0,D,q),q.onerror=h(fi,L,"TestLoadImage: error",!1,D,q),q.onabort=h(fi,L,"TestLoadImage: abort",!1,D,q),q.ontimeout=h(fi,L,"TestLoadImage: timeout",!1,D,q),o.setTimeout(function(){q.ontimeout&&q.ontimeout()},1e4),q.src=y}else D(!1)}function rf(y,D){const L=new _r,q=new AbortController,se=setTimeout(()=>{q.abort(),fi(L,"TestPingServer: timeout",!1,D)},1e4);fetch(y,{signal:q.signal}).then(pe=>{clearTimeout(se),pe.ok?fi(L,"TestPingServer: ok",!0,D):fi(L,"TestPingServer: server error",!1,D)}).catch(()=>{clearTimeout(se),fi(L,"TestPingServer: error",!1,D)})}function fi(y,D,L,q,se){try{se&&(se.onload=null,se.onerror=null,se.onabort=null,se.ontimeout=null),q(L)}catch{}}function Xs(){this.g=new ua}function ba(y){this.i=y.Sb||null,this.h=y.ab||!1}p(ba,Qa),ba.prototype.g=function(){return new vl(this.i,this.h)};function vl(y,D){Me.call(this),this.H=y,this.o=D,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(vl,Me),n=vl.prototype,n.open=function(y,D){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=y,this.D=D,this.readyState=1,Bi(this)},n.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const D={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};y&&(D.body=y),(this.H||o).fetch(new Request(this.D,D)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ws(this)),this.readyState=0},n.Pa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,Bi(this)),this.g&&(this.readyState=3,Bi(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Hc(this)}else y.text().then(this.Oa.bind(this),this.ga.bind(this))};function Hc(y){y.j.read().then(y.Ma.bind(y)).catch(y.ga.bind(y))}n.Ma=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var D=y.value?y.value:new Uint8Array(0);(D=this.B.decode(D,{stream:!y.done}))&&(this.response=this.responseText+=D)}y.done?Ws(this):Bi(this),this.readyState==3&&Hc(this)}},n.Oa=function(y){this.g&&(this.response=this.responseText=y,Ws(this))},n.Na=function(y){this.g&&(this.response=y,Ws(this))},n.ga=function(){this.g&&Ws(this)};function Ws(y){y.readyState=4,y.l=null,y.j=null,y.B=null,Bi(y)}n.setRequestHeader=function(y,D){this.A.append(y,D)},n.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],D=this.h.entries();for(var L=D.next();!L.done;)L=L.value,y.push(L[0]+": "+L[1]),L=D.next();return y.join(`\r
`)};function Bi(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(vl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function hi(y){let D="";return he(y,function(L,q){D+=q,D+=":",D+=L,D+=`\r
`}),D}function yl(y,D,L){e:{for(q in L){var q=!1;break e}q=!0}q||(L=hi(L),typeof y=="string"?L!=null&&Za(L):Ot(y,D,L))}function Ft(y){Me.call(this),this.headers=new Map,this.L=y||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(Ft,Me);var xa=/^https?$/i,af=["POST","PUT"];n=Ft.prototype,n.Fa=function(y){this.H=y},n.ea=function(y,D,L,q){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);D=D?D.toUpperCase():"GET",this.D=y,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Yd.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(D,String(y),!0),this.B=!1}catch(pe){bl(this,pe);return}if(y=L||"",L=new Map(this.headers),q)if(Object.getPrototypeOf(q)===Object.prototype)for(var se in q)L.set(se,q[se]);else if(typeof q.keys=="function"&&typeof q.get=="function")for(const pe of q.keys())L.set(pe,q.get(pe));else throw Error("Unknown input type for opt_headers: "+String(q));q=Array.from(L.keys()).find(pe=>pe.toLowerCase()=="content-type"),se=o.FormData&&y instanceof o.FormData,!(Array.prototype.indexOf.call(af,D,void 0)>=0)||q||se||L.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[pe,De]of L)this.g.setRequestHeader(pe,De);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(y),this.v=!1}catch(pe){bl(this,pe)}};function bl(y,D){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=D,y.o=5,sf(y),Ja(y)}function sf(y){y.A||(y.A=!0,Be(y,"complete"),Be(y,"error"))}n.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=y||7,Be(this,"complete"),Be(this,"abort"),Ja(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ja(this,!0)),Ft.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?xl(this):this.Xa())},n.Xa=function(){xl(this)};function xl(y){if(y.h&&typeof a<"u"){if(y.v&&Ui(y)==4)setTimeout(y.Ca.bind(y),0);else if(Be(y,"readystatechange"),Ui(y)==4){y.h=!1;try{const pe=y.ca();e:switch(pe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var D=!0;break e;default:D=!1}var L;if(!(L=D)){var q;if(q=pe===0){let De=String(y.D).match(ag)[1]||null;!De&&o.self&&o.self.location&&(De=o.self.location.protocol.slice(0,-1)),q=!xa.test(De?De.toLowerCase():"")}L=q}if(L)Be(y,"complete"),Be(y,"success");else{y.o=6;try{var se=Ui(y)>2?y.g.statusText:""}catch{se=""}y.l=se+" ["+y.ca()+"]",sf(y)}}finally{Ja(y)}}}}function Ja(y,D){if(y.g){y.m&&(clearTimeout(y.m),y.m=null);const L=y.g;y.g=null,D||Be(y,"ready");try{L.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Ui(y){return y.g?y.g.readyState:0}n.ca=function(){try{return Ui(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(y){if(this.g){var D=this.g.responseText;return y&&D.indexOf(y)==0&&(D=D.substring(y.length)),Hr(D)}};function tr(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.F){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function es(y){const D={};y=(y.g&&Ui(y)>=2&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let q=0;q<y.length;q++){if(j(y[q]))continue;var L=ng(y[q]);const se=L[0];if(L=L[1],typeof L!="string")continue;L=L.trim();const pe=D[se]||[];D[se]=pe,pe.push(L)}K(D,function(q){return q.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function _a(y,D,L){return L&&L.internalChannelParams&&L.internalChannelParams[y]||D}function Qs(y){this.za=0,this.i=[],this.j=new _r,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=_a("failFast",!1,y),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=_a("baseRetryDelayMs",5e3,y),this.Za=_a("retryDelaySeedMs",1e4,y),this.Ta=_a("forwardChannelMaxRetries",2,y),this.va=_a("forwardChannelRequestTimeoutMs",2e4,y),this.ma=y&&y.xmlHttpFactory||void 0,this.Ua=y&&y.Rb||void 0,this.Aa=y&&y.useFetchStreams||!1,this.O=void 0,this.L=y&&y.supportsCrossDomainXhr||!1,this.M="",this.h=new Kd(y&&y.concurrentRequestLimit),this.Ba=new Xs,this.S=y&&y.fastHandshake||!1,this.R=y&&y.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=y&&y.Pb||!1,y&&y.ua&&this.j.ua(),y&&y.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&y&&y.detectBufferingProxy||!1,this.ia=void 0,y&&y.longPollingTimeout&&y.longPollingTimeout>0&&(this.ia=y.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Qs.prototype,n.ka=8,n.I=1,n.connect=function(y,D,L,q){ln(0),this.W=y,this.H=D||{},L&&q!==void 0&&(this.H.OSID=L,this.H.OAID=q),this.F=this.X,this.J=mg(this,null,this.W),wa(this)};function of(y){if(Yc(y),y.I==3){var D=y.V++,L=kn(y.J);if(Ot(L,"SID",y.M),Ot(L,"RID",D),Ot(L,"TYPE","terminate"),_l(y,L),D=new Vi(y,y.j,D),D.M=2,D.A=gl(kn(L)),L=!1,o.navigator&&o.navigator.sendBeacon)try{L=o.navigator.sendBeacon(D.A.toString(),"")}catch{}!L&&o.Image&&(new Image().src=D.A,L=!0),L||(D.g=vg(D.j,null),D.g.ea(D.A)),D.F=Date.now(),ha(D)}gg(y)}function Zs(y){y.g&&(cf(y),y.g.cancel(),y.g=null)}function Yc(y){Zs(y),y.v&&(o.clearTimeout(y.v),y.v=null),Xc(y),y.h.cancel(),y.m&&(typeof y.m=="number"&&o.clearTimeout(y.m),y.m=null)}function wa(y){if(!Xd(y.h)&&!y.m){y.m=!0;var D=y.Ea;P||I(),N||(P(),N=!0),A.add(D,y),y.D=0}}function Kc(y,D){return ma(y.h)>=y.h.j-(y.m?1:0)?!1:y.m?(y.i=D.G.concat(y.i),!0):y.I==1||y.I==2||y.D>=(y.Sa?0:y.Ta)?!1:(y.m=ui(d(y.Ea,y,D),pg(y,y.D)),y.D++,!0)}n.Ea=function(y){if(this.m)if(this.m=null,this.I==1){if(!y){this.V=Math.floor(Math.random()*1e5),y=this.V++;const se=new Vi(this,this.j,y);let pe=this.o;if(this.U&&(pe?(pe=G(pe),re(pe,this.U)):pe=this.U),this.u!==null||this.R||(se.J=pe,pe=null),this.S)e:{for(var D=0,L=0;L<this.i.length;L++){t:{var q=this.i[L];if("__data__"in q.map&&(q=q.map.__data__,typeof q=="string")){q=q.length;break t}q=void 0}if(q===void 0)break;if(D+=q,D>4096){D=L;break e}if(D===4096||L===this.i.length-1){D=L+1;break e}}D=1e3}else D=1e3;D=ug(this,se,D),L=kn(this.J),Ot(L,"RID",y),Ot(L,"CVER",22),this.G&&Ot(L,"X-HTTP-Session-Id",this.G),_l(this,L),pe&&(this.R?D="headers="+Za(hi(pe))+"&"+D:this.u&&yl(L,this.u,pe)),Wd(this.h,se),this.Ra&&Ot(L,"TYPE","init"),this.S?(Ot(L,"$req",D),Ot(L,"SID","null"),se.U=!0,fa(se,L,null)):fa(se,L,D),this.I=2}}else this.I==3&&(y?lf(this,y):this.i.length==0||Xd(this.h)||lf(this))};function lf(y,D){var L;D?L=D.l:L=y.V++;const q=kn(y.J);Ot(q,"SID",y.M),Ot(q,"RID",L),Ot(q,"AID",y.K),_l(y,q),y.u&&y.o&&yl(q,y.u,y.o),L=new Vi(y,y.j,L,y.D+1),y.u===null&&(L.J=y.o),D&&(y.i=D.G.concat(y.i)),D=ug(y,L,1e3),L.H=Math.round(y.va*.5)+Math.round(y.va*.5*Math.random()),Wd(y.h,L),fa(L,q,D)}function _l(y,D){y.H&&he(y.H,function(L,q){Ot(D,q,L)}),y.l&&he({},function(L,q){Ot(D,q,L)})}function ug(y,D,L){L=Math.min(y.i.length,L);const q=y.l?d(y.l.Ka,y.l,y):null;e:{var se=y.i;let ct=-1;for(;;){const _n=["count="+L];ct==-1?L>0?(ct=se[0].g,_n.push("ofs="+ct)):ct=0:_n.push("ofs="+ct);let Nt=!0;for(let en=0;en<L;en++){var pe=se[en].g;const pi=se[en].map;if(pe-=ct,pe<0)ct=Math.max(0,se[en].g-100),Nt=!1;else try{pe="req"+pe+"_"||"";try{var De=pi instanceof Map?pi:Object.entries(pi);for(const[Sa,Fi]of De){let Gi=Fi;c(Fi)&&(Gi=Cn(Fi)),_n.push(pe+Sa+"="+encodeURIComponent(Gi))}}catch(Sa){throw _n.push(pe+"type="+encodeURIComponent("_badmap")),Sa}}catch{q&&q(pi)}}if(Nt){De=_n.join("&");break e}}De=void 0}return y=y.i.splice(0,L),D.G=y,De}function dg(y){if(!y.g&&!y.v){y.Y=1;var D=y.Da;P||I(),N||(P(),N=!0),A.add(D,y),y.A=0}}function wl(y){return y.g||y.v||y.A>=3?!1:(y.Y++,y.v=ui(d(y.Da,y),pg(y,y.A)),y.A++,!0)}n.Da=function(){if(this.v=null,fg(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var y=4*this.T;this.j.info("BP detection timer enabled: "+y),this.B=ui(d(this.Wa,this),y)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ln(10),Zs(this),fg(this))};function cf(y){y.B!=null&&(o.clearTimeout(y.B),y.B=null)}function fg(y){y.g=new Vi(y,y.j,"rpc",y.Y),y.u===null&&(y.g.J=y.o),y.g.P=0;var D=kn(y.na);Ot(D,"RID","rpc"),Ot(D,"SID",y.M),Ot(D,"AID",y.K),Ot(D,"CI",y.F?"0":"1"),!y.F&&y.ia&&Ot(D,"TO",y.ia),Ot(D,"TYPE","xmlhttp"),_l(y,D),y.u&&y.o&&yl(D,y.u,y.o),y.O&&(y.g.H=y.O);var L=y.g;y=y.ba,L.M=1,L.A=gl(kn(D)),L.u=null,L.R=!0,Bc(L,y)}n.Va=function(){this.C!=null&&(this.C=null,Zs(this),wl(this),ln(19))};function Xc(y){y.C!=null&&(o.clearTimeout(y.C),y.C=null)}function hg(y,D){var L=null;if(y.g==D){Xc(y),cf(y),y.g=null;var q=2}else if(va(y.h,D))L=D.G,Qd(y.h,D),q=1;else return;if(y.I!=0){if(D.o)if(q==1){L=D.u?D.u.length:0,D=Date.now()-D.F;var se=y.D;q=Gs(),Be(q,new Kr(q,L)),wa(y)}else dg(y);else if(se=D.m,se==3||se==0&&D.X>0||!(q==1&&Kc(y,D)||q==2&&wl(y)))switch(L&&L.length>0&&(D=y.h,D.i=D.i.concat(L)),se){case 1:Ea(y,5);break;case 4:Ea(y,10);break;case 3:Ea(y,6);break;default:Ea(y,2)}}}function pg(y,D){let L=y.Qa+Math.floor(Math.random()*y.Za);return y.isActive()||(L*=2),L*D}function Ea(y,D){if(y.j.info("Error code "+D),D==2){var L=d(y.bb,y),q=y.Ua;const se=!q;q=new Wr(q||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Zn(q,"https"),gl(q),se?Li(q.toString(),L):rf(q.toString(),L)}else ln(2);y.I=0,y.l&&y.l.pa(D),gg(y),Yc(y)}n.bb=function(y){y?(this.j.info("Successfully pinged google.com"),ln(2)):(this.j.info("Failed to ping google.com"),ln(1))};function gg(y){if(y.I=0,y.ja=[],y.l){const D=Zd(y.h);(D.length!=0||y.i.length!=0)&&(_(y.ja,D),_(y.ja,y.i),y.h.i.length=0,b(y.i),y.i.length=0),y.l.oa()}}function mg(y,D,L){var q=L instanceof Wr?kn(L):new Wr(L);if(q.g!="")D&&(q.g=D+"."+q.g),$s(q,q.u);else{var se=o.location;q=se.protocol,D=D?D+"."+se.hostname:se.hostname,se=+se.port;const pe=new Wr(null);q&&Zn(pe,q),D&&(pe.g=D),se&&$s(pe,se),L&&(pe.h=L),q=pe}return L=y.G,D=y.wa,L&&D&&Ot(q,L,D),Ot(q,"VER",y.ka),_l(y,q),q}function vg(y,D,L){if(D&&!y.L)throw Error("Can't create secondary domain capable XhrIo object.");return D=y.Aa&&!y.ma?new Ft(new ba({ab:L})):new Ft(y.ma),D.Fa(y.L),D}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function yg(){}n=yg.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Js(){}Js.prototype.g=function(y,D){return new wr(y,D)};function wr(y,D){Me.call(this),this.g=new Qs(D),this.l=y,this.h=D&&D.messageUrlParams||null,y=D&&D.messageHeaders||null,D&&D.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=D&&D.initMessageHeaders||null,D&&D.messageContentType&&(y?y["X-WebChannel-Content-Type"]=D.messageContentType:y={"X-WebChannel-Content-Type":D.messageContentType}),D&&D.sa&&(y?y["X-WebChannel-Client-Profile"]=D.sa:y={"X-WebChannel-Client-Profile":D.sa}),this.g.U=y,(y=D&&D.Qb)&&!j(y)&&(this.g.u=y),this.A=D&&D.supportsCrossDomainXhr||!1,this.v=D&&D.sendRawJson||!1,(D=D&&D.httpSessionIdParam)&&!j(D)&&(this.g.G=D,y=this.h,y!==null&&D in y&&(y=this.h,D in y&&delete y[D])),this.j=new ts(this)}p(wr,Me),wr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},wr.prototype.close=function(){of(this.g)},wr.prototype.o=function(y){var D=this.g;if(typeof y=="string"){var L={};L.__data__=y,y=L}else this.v&&(L={},L.__data__=Cn(y),y=L);D.i.push(new Dn(D.Ya++,y)),D.I==3&&wa(D)},wr.prototype.N=function(){this.g.l=null,delete this.j,of(this.g),delete this.g,wr.Z.N.call(this)};function bg(y){In.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var D=y.__sm__;if(D){e:{for(const L in D){y=L;break e}y=void 0}(this.i=y)&&(y=this.i,D=D!==null&&y in D?D[y]:void 0),this.data=D}else this.data=y}p(bg,In);function xg(){dr.call(this),this.status=1}p(xg,dr);function ts(y){this.g=y}p(ts,yg),ts.prototype.ra=function(){Be(this.g,"a")},ts.prototype.qa=function(y){Be(this.g,new bg(y))},ts.prototype.pa=function(y){Be(this.g,new xg)},ts.prototype.oa=function(){Be(this.g,"b")},Js.prototype.createWebChannel=Js.prototype.g,wr.prototype.send=wr.prototype.o,wr.prototype.open=wr.prototype.m,wr.prototype.close=wr.prototype.close,DM=function(){return new Js},RM=function(){return Gs()},IM=sn,L1={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},hl.NO_ERROR=0,hl.TIMEOUT=8,hl.HTTP_ERROR=6,i0=hl,Hd.COMPLETE="complete",CM=Hd,Fs.EventType=Yr,Yr.OPEN="a",Yr.CLOSE="b",Yr.ERROR="c",Yr.MESSAGE="d",Me.prototype.listen=Me.prototype.J,ah=Fs,Ft.prototype.listenOnce=Ft.prototype.K,Ft.prototype.getLastError=Ft.prototype.Ha,Ft.prototype.getLastErrorCode=Ft.prototype.ya,Ft.prototype.getStatus=Ft.prototype.ca,Ft.prototype.getResponseJson=Ft.prototype.La,Ft.prototype.getResponseText=Ft.prototype.la,Ft.prototype.send=Ft.prototype.ea,Ft.prototype.setWithCredentials=Ft.prototype.Fa,AM=Ft}).apply(typeof Cm<"u"?Cm:typeof self<"u"?self:typeof window<"u"?window:{});const pI="@firebase/firestore",gI="4.9.2";class lr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}lr.UNAUTHENTICATED=new lr(null),lr.GOOGLE_CREDENTIALS=new lr("google-credentials-uid"),lr.FIRST_PARTY=new lr("first-party-uid"),lr.MOCK_USER=new lr("mock-user");let Nd="12.3.0";const bc=new mw("@firebase/firestore");function Mu(){return bc.logLevel}function Ae(n,...e){if(bc.logLevel<=_t.DEBUG){const t=e.map(Cw);bc.debug(`Firestore (${Nd}): ${n}`,...t)}}function Cr(n,...e){if(bc.logLevel<=_t.ERROR){const t=e.map(Cw);bc.error(`Firestore (${Nd}): ${n}`,...t)}}function xc(n,...e){if(bc.logLevel<=_t.WARN){const t=e.map(Cw);bc.warn(`Firestore (${Nd}): ${n}`,...t)}}function Cw(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Ve(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,kM(n,r,t)}function kM(n,e,t){let r=`FIRESTORE (${Nd}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Cr(r),new Error(r)}function Ge(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||kM(e,i,r)}function st(n,e){return n}const me={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Re extends Vs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class za{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class NM{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ZF{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(lr.UNAUTHENTICATED)))}shutdown(){}}class JF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class e7{constructor(e){this.t=e,this.currentUser=lr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ge(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let a=new za;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new za,e.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const u=a;e.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},c=u=>{Ae("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>c(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(Ae("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new za)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Ae("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ge(typeof r.accessToken=="string",31837,{l:r}),new NM(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ge(e===null||typeof e=="string",2055,{h:e}),new lr(e)}}class t7{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=lr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class n7{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new t7(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(lr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class mI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class r7{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ai(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ge(this.o===void 0,3512);const r=a=>{a.error!=null&&Ae("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.m;return this.m=a.token,Ae("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>r(a)))};const i=a=>{Ae("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):Ae("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new mI(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ge(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new mI(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function i7(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class Iw{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=i7(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+=e.charAt(i[a]%62))}return r}}function it(n,e){return n<e?-1:n>e?1:0}function B1(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),a=e.charAt(r);if(i!==a)return Mx(i)===Mx(a)?it(i,a):Mx(i)?1:-1}return it(n.length,e.length)}const a7=55296,s7=57343;function Mx(n){const e=n.charCodeAt(0);return e>=a7&&e<=s7}function sd(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function MM(n){return n+"\0"}const vI="__name__";class Da{constructor(e,t,r){t===void 0?t=0:t>e.length&&Ve(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Ve(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Da.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Da?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=Da.compareSegments(e.get(i),t.get(i));if(a!==0)return a}return it(e.length,t.length)}static compareSegments(e,t){const r=Da.isNumericId(e),i=Da.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Da.extractNumericId(e).compare(Da.extractNumericId(t)):B1(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return qo.fromString(e.substring(4,e.length-2))}}class Pt extends Da{construct(e,t,r){return new Pt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Re(me.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new Pt(t)}static emptyPath(){return new Pt([])}}const o7=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class dn extends Da{construct(e,t,r){return new dn(e,t,r)}static isValidIdentifier(e){return o7.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),dn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===vI}static keyField(){return new dn([vI])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(r.length===0)throw new Re(me.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new Re(me.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Re(me.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(r+=c,i++):(a(),i++)}if(a(),o)throw new Re(me.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new dn(t)}static emptyPath(){return new dn([])}}class ke{constructor(e){this.path=e}static fromPath(e){return new ke(Pt.fromString(e))}static fromName(e){return new ke(Pt.fromString(e).popFirst(5))}static empty(){return new ke(Pt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Pt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Pt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ke(new Pt(e.slice()))}}function PM(n,e,t){if(!t)throw new Re(me.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function l7(n,e,t,r){if(e===!0&&r===!0)throw new Re(me.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function yI(n){if(!ke.isDocumentKey(n))throw new Re(me.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function bI(n){if(ke.isDocumentKey(n))throw new Re(me.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function OM(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Rv(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ve(12329,{type:typeof n})}function vr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Re(me.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Rv(n);throw new Re(me.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Bn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Ap(n,e){if(!OM(n))throw new Re(me.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(a!==void 0&&o!==a.value){t=`Expected '${r}' field to equal '${a.value}'`;break}}if(t)throw new Re(me.INVALID_ARGUMENT,t);return!0}const xI=-62135596800,_I=1e6;class pt{static now(){return pt.fromMillis(Date.now())}static fromDate(e){return pt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*_I);return new pt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Re(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Re(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<xI)throw new Re(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Re(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/_I}_compareTo(e){return this.seconds===e.seconds?it(this.nanoseconds,e.nanoseconds):it(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:pt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ap(e,pt._jsonSchema))return new pt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-xI;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}pt._jsonSchemaVersion="firestore/timestamp/1.0",pt._jsonSchema={type:Bn("string",pt._jsonSchemaVersion),seconds:Bn("number"),nanoseconds:Bn("number")};class Xe{static fromTimestamp(e){return new Xe(e)}static min(){return new Xe(new pt(0,0))}static max(){return new Xe(new pt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Fh=-1;class j0{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function U1(n){return n.fields.find((e=>e.kind===2))}function ql(n){return n.fields.filter((e=>e.kind!==2))}j0.UNKNOWN_ID=-1;class a0{constructor(e,t){this.fieldPath=e,this.kind=t}}class Gh{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Gh(0,oi.min())}}function c7(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Xe.fromTimestamp(r===1e9?new pt(t+1,0):new pt(t,r));return new oi(i,ke.empty(),e)}function jM(n){return new oi(n.readTime,n.key,Fh)}class oi{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new oi(Xe.min(),ke.empty(),Fh)}static max(){return new oi(Xe.max(),ke.empty(),Fh)}}function Rw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ke.comparator(n.documentKey,e.documentKey),t!==0?t:it(n.largestBatchId,e.largestBatchId))}const VM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class zM{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Pc(n){if(n.code!==me.FAILED_PRECONDITION||n.message!==VM)throw n;Ae("LocalStore","Unexpectedly lost primary lease")}class ae{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ve(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ae(((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ae?t:ae.resolve(t)}catch(t){return ae.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.reject(t)}static resolve(e){return new ae(((t,r)=>{t(e)}))}static reject(e){return new ae(((t,r)=>{r(e)}))}static waitFor(e){return new ae(((t,r)=>{let i=0,a=0,o=!1;e.forEach((c=>{++i,c.next((()=>{++a,o&&a===i&&t()}),(u=>r(u)))})),o=!0,a===i&&t()}))}static or(e){let t=ae.resolve(!1);for(const r of e)t=t.next((i=>i?ae.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,a)=>{r.push(t.call(this,i,a))})),this.waitFor(r)}static mapArray(e,t){return new ae(((r,i)=>{const a=e.length,o=new Array(a);let c=0;for(let u=0;u<a;u++){const d=u;t(e[d]).next((h=>{o[d]=h,++c,c===a&&r(o)}),(h=>i(h)))}}))}static doWhile(e,t){return new ae(((r,i)=>{const a=()=>{e()===!0?t().next((()=>{a()}),i):r()};a()}))}}const ii="SimpleDb";class Dv{static open(e,t,r,i){try{return new Dv(t,e.transaction(i,r))}catch(a){throw new vh(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new za,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new vh(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=Dw(r.target.error);this.S.reject(new vh(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ae(ii,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new d7(t)}}class $o{static delete(e){return Ae(ii,"Removing database:",e),Kl(CN().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!jN())return!1;if($o.F())return!0;const e=Xn(),t=$o.M(e),r=0<t&&t<10,i=LM(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,$o.M(Xn())===12.2&&Cr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Ae(ii,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=a=>{const o=a.target.result;t(o)},i.onblocked=()=>{r(new vh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=a=>{const o=a.target.error;o.name==="VersionError"?r(new Re(me.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Re(me.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new vh(e,o))},i.onupgradeneeded=a=>{Ae(ii,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const o=a.target.result;this.N.k(o,i.transaction,a.oldVersion,this.version).next((()=>{Ae(ii,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const a=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const c=Dv.open(this.db,e,a?"readonly":"readwrite",r),u=i(c).next((d=>(c.C(),d))).catch((d=>(c.abort(d),ae.reject(d)))).toPromise();return u.catch((()=>{})),await c.D,u}catch(c){const u=c,d=u.name!=="FirebaseError"&&o<3;if(Ae(ii,"Transaction failed with error:",u.message,"Retrying:",d),this.close(),!d)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function LM(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class u7{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Kl(this.U.delete())}}class vh extends Re{constructor(e,t){super(me.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ol(n){return n.name==="IndexedDbTransactionError"}class d7{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Ae(ii,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Ae(ii,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Kl(r)}add(e){return Ae(ii,"ADD",this.store.name,e,e),Kl(this.store.add(e))}get(e){return Kl(this.store.get(e)).next((t=>(t===void 0&&(t=null),Ae(ii,"GET",this.store.name,e,t),t)))}delete(e){return Ae(ii,"DELETE",this.store.name,e),Kl(this.store.delete(e))}count(){return Ae(ii,"COUNT",this.store.name),Kl(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const a=i.getAll(r.range);return new ae(((o,c)=>{a.onerror=u=>{c(u.target.error)},a.onsuccess=u=>{o(u.target.result)}}))}{const a=this.cursor(r),o=[];return this.H(a,((c,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new ae(((i,a)=>{r.onerror=o=>{a(o.target.error)},r.onsuccess=o=>{i(o.target.result)}}))}Z(e,t){Ae(ii,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((a,o,c)=>c.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new ae(((r,i)=>{t.onerror=a=>{const o=Dw(a.target.error);i(o)},t.onsuccess=a=>{const o=a.target.result;o?e(o.primaryKey,o.value).next((c=>{c?o.continue():r()})):r()}}))}H(e,t){const r=[];return new ae(((i,a)=>{e.onerror=o=>{a(o.target.error)},e.onsuccess=o=>{const c=o.target.result;if(!c)return void i();const u=new u7(c),d=t(c.primaryKey,c.value,u);if(d instanceof ae){const h=d.catch((p=>(u.done(),ae.reject(p))));r.push(h)}u.isDone?i():u.G===null?c.continue():c.continue(u.G)}})).next((()=>ae.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Kl(n){return new ae(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=Dw(r.target.error);t(i)}}))}let wI=!1;function Dw(n){const e=$o.M(Xn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Re("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return wI||(wI=!0,setTimeout((()=>{throw r}),0)),r}}return n}const yh="IndexBackfiller";class f7{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Ae(yh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Ae(yh,`Documents written: ${t}`)}catch(t){ol(t)?Ae(yh,"Ignoring IndexedDB error during index backfill: ",t):await Pc(t)}await this.re(6e4)}))}}class h7{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,a=!0;return ae.doWhile((()=>a===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!r.has(o))return Ae(yh,`Processing collection: ${o}`),this.oe(e,o,i).next((c=>{i-=c,r.add(o)}));a=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((a=>{const o=a.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(i,a))).next((c=>(Ae(yh,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c)))).next((()=>o.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,a)=>{const o=jM(a);Rw(o,r)>0&&(r=o)})),new oi(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Ii{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ii.ce=-1;const lc=-1;function kv(n){return n==null}function qh(n){return n===0&&1/n==-1/0}function p7(n){return typeof n=="number"&&Number.isInteger(n)&&!qh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const V0="";function yr(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=EI(e)),e=g7(n.get(t),e);return EI(e)}function g7(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="";break;case V0:t+="";break;default:t+=a}}return t}function EI(n){return n+V0+""}function Na(n){const e=n.length;if(Ge(e>=2,64408,{path:n}),e===2)return Ge(n.charAt(0)===V0&&n.charAt(1)==="",56145,{path:n}),Pt.emptyPath();const t=e-2,r=[];let i="";for(let a=0;a<e;){const o=n.indexOf(V0,a);switch((o<0||o>t)&&Ve(50515,{path:n}),n.charAt(o+1)){case"":const c=n.substring(a,o);let u;i.length===0?u=c:(i+=c,u=i,i=""),r.push(u);break;case"":i+=n.substring(a,o),i+="\0";break;case"":i+=n.substring(a,o+1);break;default:Ve(61167,{path:n})}a=o+2}return new Pt(r)}const $l="remoteDocuments",Cp="owner",Au="owner",$h="mutationQueues",m7="userId",Xi="mutations",SI="batchId",nc="userMutationsIndex",TI=["userId","batchId"];function s0(n,e){return[n,yr(e)]}function BM(n,e,t){return[n,yr(e),t]}const v7={},od="documentMutations",z0="remoteDocumentsV14",y7=["prefixPath","collectionGroup","readTime","documentId"],o0="documentKeyIndex",b7=["prefixPath","collectionGroup","documentId"],UM="collectionGroupIndex",x7=["collectionGroup","readTime","prefixPath","documentId"],Hh="remoteDocumentGlobal",F1="remoteDocumentGlobalKey",ld="targets",FM="queryTargetsIndex",_7=["canonicalId","targetId"],cd="targetDocuments",w7=["targetId","path"],kw="documentTargetsIndex",E7=["path","targetId"],L0="targetGlobalKey",cc="targetGlobal",Yh="collectionParents",S7=["collectionId","parent"],ud="clientMetadata",T7="clientId",Nv="bundles",A7="bundleId",Mv="namedQueries",C7="name",Nw="indexConfiguration",I7="indexId",G1="collectionGroupIndex",R7="collectionGroup",bh="indexState",D7=["indexId","uid"],GM="sequenceNumberIndex",k7=["uid","sequenceNumber"],xh="indexEntries",N7=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],qM="documentKeyIndex",M7=["indexId","uid","orderedDocumentKey"],Pv="documentOverlays",P7=["userId","collectionPath","documentId"],q1="collectionPathOverlayIndex",O7=["userId","collectionPath","largestBatchId"],$M="collectionGroupOverlayIndex",j7=["userId","collectionGroup","largestBatchId"],Mw="globals",V7="name",HM=[$h,Xi,od,$l,ld,Cp,cc,cd,ud,Hh,Yh,Nv,Mv],z7=[...HM,Pv],YM=[$h,Xi,od,z0,ld,Cp,cc,cd,ud,Hh,Yh,Nv,Mv,Pv],KM=YM,Pw=[...KM,Nw,bh,xh],L7=Pw,XM=[...Pw,Mw],B7=XM;class $1 extends zM{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Wn(n,e){const t=st(n);return $o.O(t.le,e)}function AI(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ll(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function WM(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class an{constructor(e,t){this.comparator=e,this.root=t||cr.EMPTY}insert(e,t){return new an(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,cr.BLACK,null,null))}remove(e){return new an(this.comparator,this.root.remove(e,this.comparator).copy(null,null,cr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Im(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Im(this.root,e,this.comparator,!1)}getReverseIterator(){return new Im(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Im(this.root,e,this.comparator,!0)}}class Im{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class cr{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=r??cr.RED,this.left=i??cr.EMPTY,this.right=a??cr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new cr(e??this.key,t??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):a===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return cr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return cr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,cr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,cr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ve(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ve(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ve(27949);return e+(this.isRed()?0:1)}}cr.EMPTY=null,cr.RED=!0,cr.BLACK=!1;cr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ve(57766)}get value(){throw Ve(16141)}get color(){throw Ve(16727)}get left(){throw Ve(29726)}get right(){throw Ve(36894)}copy(e,t,r,i,a){return this}insert(e,t,r){return new cr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Bt{constructor(e){this.comparator=e,this.data=new an(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new CI(this.data.getIterator())}getIteratorFrom(e){return new CI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Bt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Bt(this.comparator);return t.data=e,t}}class CI{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Cu(n){return n.hasNext()?n.getNext():void 0}class Br{constructor(e){this.fields=e,e.sort(dn.comparator)}static empty(){return new Br([])}unionWith(e){let t=new Bt(dn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Br(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return sd(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class QM extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Un{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new QM("Invalid base64 string: "+a):a}})(e);return new Un(t)}static fromUint8Array(e){const t=(function(i){let a="";for(let o=0;o<i.length;++o)a+=String.fromCharCode(i[o]);return a})(e);return new Un(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return it(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Un.EMPTY_BYTE_STRING=new Un("");const U7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ks(n){if(Ge(!!n,39018),typeof n=="string"){let e=0;const t=U7.exec(n);if(Ge(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:nn(n.seconds),nanos:nn(n.nanos)}}function nn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ns(n){return typeof n=="string"?Un.fromBase64String(n):Un.fromUint8Array(n)}const ZM="server_timestamp",JM="__type__",eP="__previous_value__",tP="__local_write_time__";function Ow(n){return(n?.mapValue?.fields||{})[JM]?.stringValue===ZM}function Ov(n){const e=n.mapValue.fields[eP];return Ow(e)?Ov(e):e}function Kh(n){const e=ks(n.mapValue.fields[tP].timestampValue);return new pt(e.seconds,e.nanos)}class F7{constructor(e,t,r,i,a,o,c,u,d,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=h}}const B0="(default)";class _c{constructor(e,t){this.projectId=e,this.database=t||B0}static empty(){return new _c("","")}get isDefaultDatabase(){return this.database===B0}isEqual(e){return e instanceof _c&&e.projectId===this.projectId&&e.database===this.database}}const jw="__type__",nP="__max__",jo={mapValue:{fields:{__type__:{stringValue:nP}}}},Vw="__vector__",dd="value",l0={nullValue:"NULL_VALUE"};function Xo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Ow(n)?4:rP(n)?9007199254740991:jv(n)?10:11:Ve(28295,{value:n})}function qa(n,e){if(n===e)return!0;const t=Xo(n);if(t!==Xo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Kh(n).isEqual(Kh(e));case 3:return(function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const o=ks(i.timestampValue),c=ks(a.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,a){return Ns(i.bytesValue).isEqual(Ns(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,a){return nn(i.geoPointValue.latitude)===nn(a.geoPointValue.latitude)&&nn(i.geoPointValue.longitude)===nn(a.geoPointValue.longitude)})(n,e);case 2:return(function(i,a){if("integerValue"in i&&"integerValue"in a)return nn(i.integerValue)===nn(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const o=nn(i.doubleValue),c=nn(a.doubleValue);return o===c?qh(o)===qh(c):isNaN(o)&&isNaN(c)}return!1})(n,e);case 9:return sd(n.arrayValue.values||[],e.arrayValue.values||[],qa);case 10:case 11:return(function(i,a){const o=i.mapValue.fields||{},c=a.mapValue.fields||{};if(AI(o)!==AI(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!qa(o[u],c[u])))return!1;return!0})(n,e);default:return Ve(52216,{left:n})}}function Xh(n,e){return(n.values||[]).find((t=>qa(t,e)))!==void 0}function Wo(n,e){if(n===e)return 0;const t=Xo(n),r=Xo(e);if(t!==r)return it(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return it(n.booleanValue,e.booleanValue);case 2:return(function(a,o){const c=nn(a.integerValue||a.doubleValue),u=nn(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1})(n,e);case 3:return II(n.timestampValue,e.timestampValue);case 4:return II(Kh(n),Kh(e));case 5:return B1(n.stringValue,e.stringValue);case 6:return(function(a,o){const c=Ns(a),u=Ns(o);return c.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(a,o){const c=a.split("/"),u=o.split("/");for(let d=0;d<c.length&&d<u.length;d++){const h=it(c[d],u[d]);if(h!==0)return h}return it(c.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,o){const c=it(nn(a.latitude),nn(o.latitude));return c!==0?c:it(nn(a.longitude),nn(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return RI(n.arrayValue,e.arrayValue);case 10:return(function(a,o){const c=a.fields||{},u=o.fields||{},d=c[dd]?.arrayValue,h=u[dd]?.arrayValue,p=it(d?.values?.length||0,h?.values?.length||0);return p!==0?p:RI(d,h)})(n.mapValue,e.mapValue);case 11:return(function(a,o){if(a===jo.mapValue&&o===jo.mapValue)return 0;if(a===jo.mapValue)return 1;if(o===jo.mapValue)return-1;const c=a.fields||{},u=Object.keys(c),d=o.fields||{},h=Object.keys(d);u.sort(),h.sort();for(let p=0;p<u.length&&p<h.length;++p){const m=B1(u[p],h[p]);if(m!==0)return m;const b=Wo(c[u[p]],d[h[p]]);if(b!==0)return b}return it(u.length,h.length)})(n.mapValue,e.mapValue);default:throw Ve(23264,{he:t})}}function II(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return it(n,e);const t=ks(n),r=ks(e),i=it(t.seconds,r.seconds);return i!==0?i:it(t.nanos,r.nanos)}function RI(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const a=Wo(t[i],r[i]);if(a)return a}return it(t.length,r.length)}function fd(n){return H1(n)}function H1(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=ks(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Ns(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ke.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const a of t.values||[])i?i=!1:r+=",",r+=H1(a);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",a=!0;for(const o of r)a?a=!1:i+=",",i+=`${o}:${H1(t.fields[o])}`;return i+"}"})(n.mapValue):Ve(61005,{value:n})}function c0(n){switch(Xo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ov(n);return e?16+c0(e):16;case 5:return 2*n.stringValue.length;case 6:return Ns(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,a)=>i+c0(a)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return ll(r.fields,((a,o)=>{i+=a.length+c0(o)})),i})(n.mapValue);default:throw Ve(13486,{value:n})}}function Wh(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Y1(n){return!!n&&"integerValue"in n}function Qh(n){return!!n&&"arrayValue"in n}function DI(n){return!!n&&"nullValue"in n}function kI(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function u0(n){return!!n&&"mapValue"in n}function jv(n){return(n?.mapValue?.fields||{})[jw]?.stringValue===Vw}function _h(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return ll(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=_h(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=_h(n.arrayValue.values[t]);return e}return{...n}}function rP(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===nP}const iP={mapValue:{fields:{[jw]:{stringValue:Vw},[dd]:{arrayValue:{}}}}};function G7(n){return"nullValue"in n?l0:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Wh(_c.empty(),ke.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?jv(n)?iP:{mapValue:{}}:Ve(35942,{value:n})}function q7(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Wh(_c.empty(),ke.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?iP:"mapValue"in n?jv(n)?{mapValue:{}}:jo:Ve(61959,{value:n})}function NI(n,e){const t=Wo(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function MI(n,e){const t=Wo(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class gr{constructor(e){this.value=e}static empty(){return new gr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!u0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=_h(t)}setAll(e){let t=dn.emptyPath(),r={},i=[];e.forEach(((o,c)=>{if(!t.isImmediateParentOf(c)){const u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=c.popLast()}o?r[c.lastSegment()]=_h(o):i.push(c.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());u0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return qa(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];u0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ll(t,((i,a)=>e[i]=a));for(const i of r)delete e[i]}clone(){return new gr(_h(this.value))}}function aP(n){const e=[];return ll(n.fields,((t,r)=>{const i=new dn([t]);if(u0(r)){const a=aP(r.mapValue).fields;if(a.length===0)e.push(i);else for(const o of a)e.push(i.child(o))}else e.push(i)})),new Br(e)}class yn{constructor(e,t,r,i,a,o,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=a,this.data=o,this.documentState=c}static newInvalidDocument(e){return new yn(e,0,Xe.min(),Xe.min(),Xe.min(),gr.empty(),0)}static newFoundDocument(e,t,r,i){return new yn(e,1,t,Xe.min(),r,i,0)}static newNoDocument(e,t){return new yn(e,2,t,Xe.min(),Xe.min(),gr.empty(),0)}static newUnknownDocument(e,t){return new yn(e,3,t,Xe.min(),Xe.min(),gr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Xe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=gr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=gr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Xe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof yn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new yn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class hd{constructor(e,t){this.position=e,this.inclusive=t}}function PI(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],o=n.position[i];if(a.field.isKeyField()?r=ke.comparator(ke.fromName(o.referenceValue),t.key):r=Wo(o,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function OI(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!qa(n.position[t],e.position[t]))return!1;return!0}class Zh{constructor(e,t="asc"){this.field=e,this.dir=t}}function $7(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class sP{}class wt extends sP{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new H7(e,t,r):t==="array-contains"?new X7(e,r):t==="in"?new fP(e,r):t==="not-in"?new W7(e,r):t==="array-contains-any"?new Q7(e,r):new wt(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Y7(e,r):new K7(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Wo(t,this.value)):t!==null&&Xo(this.value)===Xo(t)&&this.matchesComparison(Wo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ve(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Lt extends sP{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Lt(e,t)}matches(e){return pd(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function pd(n){return n.op==="and"}function K1(n){return n.op==="or"}function zw(n){return oP(n)&&pd(n)}function oP(n){for(const e of n.filters)if(e instanceof Lt)return!1;return!0}function X1(n){if(n instanceof wt)return n.field.canonicalString()+n.op.toString()+fd(n.value);if(zw(n))return n.filters.map((e=>X1(e))).join(",");{const e=n.filters.map((t=>X1(t))).join(",");return`${n.op}(${e})`}}function lP(n,e){return n instanceof wt?(function(r,i){return i instanceof wt&&r.op===i.op&&r.field.isEqual(i.field)&&qa(r.value,i.value)})(n,e):n instanceof Lt?(function(r,i){return i instanceof Lt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((a,o,c)=>a&&lP(o,i.filters[c])),!0):!1})(n,e):void Ve(19439)}function cP(n,e){const t=n.filters.concat(e);return Lt.create(t,n.op)}function uP(n){return n instanceof wt?(function(t){return`${t.field.canonicalString()} ${t.op} ${fd(t.value)}`})(n):n instanceof Lt?(function(t){return t.op.toString()+" {"+t.getFilters().map(uP).join(" ,")+"}"})(n):"Filter"}class H7 extends wt{constructor(e,t,r){super(e,t,r),this.key=ke.fromName(r.referenceValue)}matches(e){const t=ke.comparator(e.key,this.key);return this.matchesComparison(t)}}class Y7 extends wt{constructor(e,t){super(e,"in",t),this.keys=dP("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class K7 extends wt{constructor(e,t){super(e,"not-in",t),this.keys=dP("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function dP(n,e){return(e.arrayValue?.values||[]).map((t=>ke.fromName(t.referenceValue)))}class X7 extends wt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Qh(t)&&Xh(t.arrayValue,this.value)}}class fP extends wt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Xh(this.value.arrayValue,t)}}class W7 extends wt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Xh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Xh(this.value.arrayValue,t)}}class Q7 extends wt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Qh(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Xh(this.value.arrayValue,r)))}}class Z7{constructor(e,t=null,r=[],i=[],a=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=c,this.Te=null}}function W1(n,e=null,t=[],r=[],i=null,a=null,o=null){return new Z7(n,e,t,r,i,a,o)}function wc(n){const e=st(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>X1(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(a){return a.field.canonicalString()+a.dir})(r))).join(","),kv(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>fd(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>fd(r))).join(",")),e.Te=t}return e.Te}function Ip(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!$7(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!lP(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!OI(n.startAt,e.startAt)&&OI(n.endAt,e.endAt)}function U0(n){return ke.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function F0(n,e){return n.filters.filter((t=>t instanceof wt&&t.field.isEqual(e)))}function jI(n,e,t){let r=l0,i=!0;for(const a of F0(n,e)){let o=l0,c=!0;switch(a.op){case"<":case"<=":o=G7(a.value);break;case"==":case"in":case">=":o=a.value;break;case">":o=a.value,c=!1;break;case"!=":case"not-in":o=l0}NI({value:r,inclusive:i},{value:o,inclusive:c})<0&&(r=o,i=c)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const o=t.position[a];NI({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function VI(n,e,t){let r=jo,i=!0;for(const a of F0(n,e)){let o=jo,c=!0;switch(a.op){case">=":case">":o=q7(a.value),c=!1;break;case"==":case"in":case"<=":o=a.value;break;case"<":o=a.value,c=!1;break;case"!=":case"not-in":o=jo}MI({value:r,inclusive:i},{value:o,inclusive:c})>0&&(r=o,i=c)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const o=t.position[a];MI({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}class Md{constructor(e,t=null,r=[],i=[],a=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function J7(n,e,t,r,i,a,o,c){return new Md(n,e,t,r,i,a,o,c)}function Rp(n){return new Md(n)}function zI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function hP(n){return n.collectionGroup!==null}function wh(n){const e=st(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Bt(dn.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((d=>{d.isInequality()&&(c=c.add(d.field))}))})),c})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new Zh(a,r))})),t.has(dn.keyField().canonicalString())||e.Ie.push(new Zh(dn.keyField(),r))}return e.Ie}function Di(n){const e=st(n);return e.Ee||(e.Ee=eG(e,wh(n))),e.Ee}function eG(n,e){if(n.limitType==="F")return W1(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const a=i.dir==="desc"?"asc":"desc";return new Zh(i.field,a)}));const t=n.endAt?new hd(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new hd(n.startAt.position,n.startAt.inclusive):null;return W1(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Q1(n,e){const t=n.filters.concat([e]);return new Md(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function G0(n,e,t){return new Md(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Vv(n,e){return Ip(Di(n),Di(e))&&n.limitType===e.limitType}function pP(n){return`${wc(Di(n))}|lt:${n.limitType}`}function Pu(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>uP(i))).join(", ")}]`),kv(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>fd(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>fd(i))).join(",")),`Target(${r})`})(Di(n))}; limitType=${n.limitType})`}function Dp(n,e){return e.isFoundDocument()&&(function(r,i){const a=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):ke.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)})(n,e)&&(function(r,i){for(const a of wh(r))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const a of r.filters)if(!a.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,c,u){const d=PI(o,c,u);return o.inclusive?d<=0:d<0})(r.startAt,wh(r),i)||r.endAt&&!(function(o,c,u){const d=PI(o,c,u);return o.inclusive?d>=0:d>0})(r.endAt,wh(r),i))})(n,e)}function tG(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function gP(n){return(e,t)=>{let r=!1;for(const i of wh(n)){const a=nG(i,e,t);if(a!==0)return a;r=r||i.field.isKeyField()}return 0}}function nG(n,e,t){const r=n.field.isKeyField()?ke.comparator(e.key,t.key):(function(a,o,c){const u=o.data.field(a),d=c.data.field(a);return u!==null&&d!==null?Wo(u,d):Ve(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ve(19790,{direction:n.dir})}}class Ls{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,a]of r)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ll(this.inner,((t,r)=>{for(const[i,a]of r)e(i,a)}))}isEmpty(){return WM(this.inner)}size(){return this.innerSize}}const rG=new an(ke.comparator);function si(){return rG}const mP=new an(ke.comparator);function sh(...n){let e=mP;for(const t of n)e=e.insert(t.key,t);return e}function vP(n){let e=mP;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Ma(){return Eh()}function yP(){return Eh()}function Eh(){return new Ls((n=>n.toString()),((n,e)=>n.isEqual(e)))}const iG=new an(ke.comparator),aG=new Bt(ke.comparator);function gt(...n){let e=aG;for(const t of n)e=e.add(t);return e}const sG=new Bt(it);function oG(){return sG}function Lw(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qh(e)?"-0":e}}function bP(n){return{integerValue:""+n}}function lG(n,e){return p7(e)?bP(e):Lw(n,e)}class zv{constructor(){this._=void 0}}function cG(n,e,t){return n instanceof Jh?(function(i,a){const o={fields:{[JM]:{stringValue:ZM},[tP]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Ow(a)&&(a=Ov(a)),a&&(o.fields[eP]=a),{mapValue:o}})(t,e):n instanceof Ec?_P(n,e):n instanceof gd?wP(n,e):(function(i,a){const o=xP(i,a),c=LI(o)+LI(i.Ae);return Y1(o)&&Y1(i.Ae)?bP(c):Lw(i.serializer,c)})(n,e)}function uG(n,e,t){return n instanceof Ec?_P(n,e):n instanceof gd?wP(n,e):t}function xP(n,e){return n instanceof ep?(function(r){return Y1(r)||(function(a){return!!a&&"doubleValue"in a})(r)})(e)?e:{integerValue:0}:null}class Jh extends zv{}class Ec extends zv{constructor(e){super(),this.elements=e}}function _P(n,e){const t=EP(e);for(const r of n.elements)t.some((i=>qa(i,r)))||t.push(r);return{arrayValue:{values:t}}}class gd extends zv{constructor(e){super(),this.elements=e}}function wP(n,e){let t=EP(e);for(const r of n.elements)t=t.filter((i=>!qa(i,r)));return{arrayValue:{values:t}}}class ep extends zv{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function LI(n){return nn(n.integerValue||n.doubleValue)}function EP(n){return Qh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class SP{constructor(e,t){this.field=e,this.transform=t}}function dG(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Ec&&i instanceof Ec||r instanceof gd&&i instanceof gd?sd(r.elements,i.elements,qa):r instanceof ep&&i instanceof ep?qa(r.Ae,i.Ae):r instanceof Jh&&i instanceof Jh})(n.transform,e.transform)}class fG{constructor(e,t){this.version=e,this.transformResults=t}}class Kn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Kn}static exists(e){return new Kn(void 0,e)}static updateTime(e){return new Kn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function d0(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Lv{}function TP(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new kp(n.key,Kn.none()):new Pd(n.key,n.data,Kn.none());{const t=n.data,r=gr.empty();let i=new Bt(dn.comparator);for(let a of e.fields)if(!i.has(a)){let o=t.field(a);o===null&&a.length>1&&(a=a.popLast(),o=t.field(a)),o===null?r.delete(a):r.set(a,o),i=i.add(a)}return new Bs(n.key,r,new Br(i.toArray()),Kn.none())}}function hG(n,e,t){n instanceof Pd?(function(i,a,o){const c=i.value.clone(),u=UI(i.fieldTransforms,a,o.transformResults);c.setAll(u),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):n instanceof Bs?(function(i,a,o){if(!d0(i.precondition,a))return void a.convertToUnknownDocument(o.version);const c=UI(i.fieldTransforms,a,o.transformResults),u=a.data;u.setAll(AP(i)),u.setAll(c),a.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(i,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Sh(n,e,t,r){return n instanceof Pd?(function(a,o,c,u){if(!d0(a.precondition,o))return c;const d=a.value.clone(),h=FI(a.fieldTransforms,u,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof Bs?(function(a,o,c,u){if(!d0(a.precondition,o))return c;const d=FI(a.fieldTransforms,u,o),h=o.data;return h.setAll(AP(a)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((p=>p.field)))})(n,e,t,r):(function(a,o,c){return d0(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(n,e,t)}function pG(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=xP(r.transform,i||null);a!=null&&(t===null&&(t=gr.empty()),t.set(r.field,a))}return t||null}function BI(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&sd(r,i,((a,o)=>dG(a,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Pd extends Lv{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Bs extends Lv{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function AP(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function UI(n,e,t){const r=new Map;Ge(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const a=n[i],o=a.transform,c=e.data.field(a.field);r.set(a.field,uG(o,c,t[i]))}return r}function FI(n,e,t){const r=new Map;for(const i of n){const a=i.transform,o=t.data.field(i.field);r.set(i.field,cG(a,o,e))}return r}class kp extends Lv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class CP extends Lv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Bw{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&hG(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Sh(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Sh(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=yP();return this.mutations.forEach((i=>{const a=e.get(i.key),o=a.overlayedDocument;let c=this.applyToLocalView(o,a.mutatedFields);c=t.has(i.key)?null:c;const u=TP(o,c);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Xe.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),gt())}isEqual(e){return this.batchId===e.batchId&&sd(this.mutations,e.mutations,((t,r)=>BI(t,r)))&&sd(this.baseMutations,e.baseMutations,((t,r)=>BI(t,r)))}}class Uw{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Ge(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return iG})();const a=e.mutations;for(let o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new Uw(e,t,r,i)}}class Fw{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class gG{constructor(e,t){this.count=e,this.unchangedNames=t}}var Vn,Tt;function mG(n){switch(n){case me.OK:return Ve(64938);case me.CANCELLED:case me.UNKNOWN:case me.DEADLINE_EXCEEDED:case me.RESOURCE_EXHAUSTED:case me.INTERNAL:case me.UNAVAILABLE:case me.UNAUTHENTICATED:return!1;case me.INVALID_ARGUMENT:case me.NOT_FOUND:case me.ALREADY_EXISTS:case me.PERMISSION_DENIED:case me.FAILED_PRECONDITION:case me.ABORTED:case me.OUT_OF_RANGE:case me.UNIMPLEMENTED:case me.DATA_LOSS:return!0;default:return Ve(15467,{code:n})}}function IP(n){if(n===void 0)return Cr("GRPC error has no .code"),me.UNKNOWN;switch(n){case Vn.OK:return me.OK;case Vn.CANCELLED:return me.CANCELLED;case Vn.UNKNOWN:return me.UNKNOWN;case Vn.DEADLINE_EXCEEDED:return me.DEADLINE_EXCEEDED;case Vn.RESOURCE_EXHAUSTED:return me.RESOURCE_EXHAUSTED;case Vn.INTERNAL:return me.INTERNAL;case Vn.UNAVAILABLE:return me.UNAVAILABLE;case Vn.UNAUTHENTICATED:return me.UNAUTHENTICATED;case Vn.INVALID_ARGUMENT:return me.INVALID_ARGUMENT;case Vn.NOT_FOUND:return me.NOT_FOUND;case Vn.ALREADY_EXISTS:return me.ALREADY_EXISTS;case Vn.PERMISSION_DENIED:return me.PERMISSION_DENIED;case Vn.FAILED_PRECONDITION:return me.FAILED_PRECONDITION;case Vn.ABORTED:return me.ABORTED;case Vn.OUT_OF_RANGE:return me.OUT_OF_RANGE;case Vn.UNIMPLEMENTED:return me.UNIMPLEMENTED;case Vn.DATA_LOSS:return me.DATA_LOSS;default:return Ve(39323,{code:n})}}(Tt=Vn||(Vn={}))[Tt.OK=0]="OK",Tt[Tt.CANCELLED=1]="CANCELLED",Tt[Tt.UNKNOWN=2]="UNKNOWN",Tt[Tt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Tt[Tt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Tt[Tt.NOT_FOUND=5]="NOT_FOUND",Tt[Tt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Tt[Tt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Tt[Tt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Tt[Tt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Tt[Tt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Tt[Tt.ABORTED=10]="ABORTED",Tt[Tt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Tt[Tt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Tt[Tt.INTERNAL=13]="INTERNAL",Tt[Tt.UNAVAILABLE=14]="UNAVAILABLE",Tt[Tt.DATA_LOSS=15]="DATA_LOSS";function vG(){return new TextEncoder}const yG=new qo([4294967295,4294967295],0);function GI(n){const e=vG().encode(n),t=new TM;return t.update(e),new Uint8Array(t.digest())}function qI(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new qo([t,r],0),new qo([i,a],0)]}class Gw{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new oh(`Invalid padding: ${t}`);if(r<0)throw new oh(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new oh(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new oh(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=qo.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(qo.fromNumber(r)));return i.compare(yG)===1&&(i=new qo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=GI(e),[r,i]=qI(t);for(let a=0;a<this.hashCount;a++){const o=this.ye(r,i,a);if(!this.we(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new Gw(a,i,t);return r.forEach((c=>o.insert(c))),o}insert(e){if(this.ge===0)return;const t=GI(e),[r,i]=qI(t);for(let a=0;a<this.hashCount;a++){const o=this.ye(r,i,a);this.Se(o)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class oh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Bv{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Np.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Bv(Xe.min(),i,new an(it),si(),gt())}}class Np{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Np(r,t,gt(),gt(),gt())}}class f0{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class RP{constructor(e,t){this.targetId=e,this.Ce=t}}class DP{constructor(e,t,r=Un.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class $I{constructor(){this.ve=0,this.Fe=HI(),this.Me=Un.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=gt(),t=gt(),r=gt();return this.Fe.forEach(((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Ve(38017,{changeType:a})}})),new Np(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=HI()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ge(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class bG{constructor(e){this.Ge=e,this.ze=new Map,this.je=si(),this.Je=Rm(),this.He=Rm(),this.Ye=new an(it)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Ve(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const a=i.target;if(U0(a))if(r===0){const o=new ke(a.path);this.et(t,o,yn.newNoDocument(o,Xe.min()))}else Ge(r===1,20013,{expectedCount:r});else{const o=this._t(t);if(o!==r){const c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(t);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,d)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:a=0}=t;let o,c;try{o=Ns(r).toUint8Array()}catch(u){if(u instanceof QM)return xc("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Gw(o,i,a)}catch(u){return xc(u instanceof oh?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((a=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.et(t,a,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((a,o)=>{const c=this.ot(o);if(c){if(a.current&&U0(c.target)){const u=new ke(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,yn.newNoDocument(u,e))}a.Be&&(t.set(o,a.ke()),a.qe())}}));let r=gt();this.He.forEach(((a,o)=>{let c=!0;o.forEachWhile((u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(a))})),this.je.forEach(((a,o)=>o.setReadTime(e)));const i=new Bv(e,t,this.Ye,this.je,r);return this.je=si(),this.Je=Rm(),this.He=Rm(),this.Ye=new an(it),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new $I,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Bt(it),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Bt(it),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ae("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new $I),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Rm(){return new an(ke.comparator)}function HI(){return new an(ke.comparator)}const xG={asc:"ASCENDING",desc:"DESCENDING"},_G={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},wG={and:"AND",or:"OR"};class EG{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Z1(n,e){return n.useProto3Json||kv(e)?e:{value:e}}function md(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function kP(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function SG(n,e){return md(n,e.toTimestamp())}function Dr(n){return Ge(!!n,49232),Xe.fromTimestamp((function(t){const r=ks(t);return new pt(r.seconds,r.nanos)})(n))}function qw(n,e){return J1(n,e).canonicalString()}function J1(n,e){const t=(function(i){return new Pt(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function NP(n){const e=Pt.fromString(n);return Ge(UP(e),10190,{key:e.toString()}),e}function q0(n,e){return qw(n.databaseId,e.path)}function uc(n,e){const t=NP(e);if(t.get(1)!==n.databaseId.projectId)throw new Re(me.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Re(me.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ke(OP(t))}function MP(n,e){return qw(n.databaseId,e)}function PP(n){const e=NP(n);return e.length===4?Pt.emptyPath():OP(e)}function e_(n){return new Pt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function OP(n){return Ge(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function YI(n,e,t){return{name:q0(n,e),fields:t.value.mapValue.fields}}function TG(n,e,t){const r=uc(n,e.name),i=Dr(e.updateTime),a=e.createTime?Dr(e.createTime):Xe.min(),o=new gr({mapValue:{fields:e.fields}}),c=yn.newFoundDocument(r,i,a,o);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function AG(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Ve(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=(function(d,h){return d.useProto3Json?(Ge(h===void 0||typeof h=="string",58123),Un.fromBase64String(h||"")):(Ge(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Un.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(d){const h=d.code===void 0?me.UNKNOWN:IP(d.code);return new Re(h,d.message||"")})(o);t=new DP(r,i,a,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=uc(n,r.document.name),a=Dr(r.document.updateTime),o=r.document.createTime?Dr(r.document.createTime):Xe.min(),c=new gr({mapValue:{fields:r.document.fields}}),u=yn.newFoundDocument(i,a,o,c),d=r.targetIds||[],h=r.removedTargetIds||[];t=new f0(d,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=uc(n,r.document),a=r.readTime?Dr(r.readTime):Xe.min(),o=yn.newNoDocument(i,a),c=r.removedTargetIds||[];t=new f0([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=uc(n,r.document),a=r.removedTargetIds||[];t=new f0([],a,i,null)}else{if(!("filter"in e))return Ve(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:a}=r,o=new gG(i,a),c=r.targetId;t=new RP(c,o)}}return t}function $0(n,e){let t;if(e instanceof Pd)t={update:YI(n,e.key,e.value)};else if(e instanceof kp)t={delete:q0(n,e.key)};else if(e instanceof Bs)t={update:YI(n,e.key,e.data),updateMask:NG(e.fieldMask)};else{if(!(e instanceof CP))return Ve(16599,{Vt:e.type});t={verify:q0(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(a,o){const c=o.transform;if(c instanceof Jh)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Ec)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof gd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof ep)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw Ve(20930,{transform:o.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,a){return a.updateTime!==void 0?{updateTime:SG(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Ve(27497)})(n,e.precondition)),t}function t_(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?Kn.updateTime(Dr(a.updateTime)):a.exists!==void 0?Kn.exists(a.exists):Kn.none()})(e.currentDocument):Kn.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(o,c){let u=null;if("setToServerValue"in c)Ge(c.setToServerValue==="REQUEST_TIME",16630,{proto:c}),u=new Jh;else if("appendMissingElements"in c){const h=c.appendMissingElements.values||[];u=new Ec(h)}else if("removeAllFromArray"in c){const h=c.removeAllFromArray.values||[];u=new gd(h)}else"increment"in c?u=new ep(o,c.increment):Ve(16584,{proto:c});const d=dn.fromServerFormat(c.fieldPath);return new SP(d,u)})(n,i))):[];if(e.update){e.update.name;const i=uc(n,e.update.name),a=new gr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const d=u.fieldPaths||[];return new Br(d.map((h=>dn.fromServerFormat(h))))})(e.updateMask);return new Bs(i,a,o,t,r)}return new Pd(i,a,t,r)}if(e.delete){const i=uc(n,e.delete);return new kp(i,t)}if(e.verify){const i=uc(n,e.verify);return new CP(i,t)}return Ve(1463,{proto:e})}function CG(n,e){return n&&n.length>0?(Ge(e!==void 0,14353),n.map((t=>(function(i,a){let o=i.updateTime?Dr(i.updateTime):Dr(a);return o.isEqual(Xe.min())&&(o=Dr(a)),new fG(o,i.transformResults||[])})(t,e)))):[]}function jP(n,e){return{documents:[MP(n,e.path)]}}function VP(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=MP(n,i);const a=(function(d){if(d.length!==0)return BP(Lt.create(d,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const o=(function(d){if(d.length!==0)return d.map((h=>(function(m){return{field:Ou(m.field),direction:RG(m.dir)}})(h)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const c=Z1(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:i}}function zP(n){let e=PP(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Ge(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let a=[];t.where&&(a=(function(p){const m=LP(p);return m instanceof Lt&&zw(m)?m.getFilters():[m]})(t.where));let o=[];t.orderBy&&(o=(function(p){return p.map((m=>(function(_){return new Zh(ju(_.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(_.direction))})(m)))})(t.orderBy));let c=null;t.limit&&(c=(function(p){let m;return m=typeof p=="object"?p.value:p,kv(m)?null:m})(t.limit));let u=null;t.startAt&&(u=(function(p){const m=!!p.before,b=p.values||[];return new hd(b,m)})(t.startAt));let d=null;return t.endAt&&(d=(function(p){const m=!p.before,b=p.values||[];return new hd(b,m)})(t.endAt)),J7(e,i,o,a,c,"F",u,d)}function IG(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ve(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function LP(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=ju(t.unaryFilter.field);return wt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=ju(t.unaryFilter.field);return wt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=ju(t.unaryFilter.field);return wt.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ju(t.unaryFilter.field);return wt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ve(61313);default:return Ve(60726)}})(n):n.fieldFilter!==void 0?(function(t){return wt.create(ju(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ve(58110);default:return Ve(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Lt.create(t.compositeFilter.filters.map((r=>LP(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ve(1026)}})(t.compositeFilter.op))})(n):Ve(30097,{filter:n})}function RG(n){return xG[n]}function DG(n){return _G[n]}function kG(n){return wG[n]}function Ou(n){return{fieldPath:n.canonicalString()}}function ju(n){return dn.fromServerFormat(n.fieldPath)}function BP(n){return n instanceof wt?(function(t){if(t.op==="=="){if(kI(t.value))return{unaryFilter:{field:Ou(t.field),op:"IS_NAN"}};if(DI(t.value))return{unaryFilter:{field:Ou(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(kI(t.value))return{unaryFilter:{field:Ou(t.field),op:"IS_NOT_NAN"}};if(DI(t.value))return{unaryFilter:{field:Ou(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ou(t.field),op:DG(t.op),value:t.value}}})(n):n instanceof Lt?(function(t){const r=t.getFilters().map((i=>BP(i)));return r.length===1?r[0]:{compositeFilter:{op:kG(t.op),filters:r}}})(n):Ve(54877,{filter:n})}function NG(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function UP(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class _s{constructor(e,t,r,i,a=Xe.min(),o=Xe.min(),c=Un.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new _s(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new _s(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _s(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _s(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class FP{constructor(e){this.yt=e}}function MG(n,e){let t;if(e.document)t=TG(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ke.fromSegments(e.noDocument.path),i=Tc(e.noDocument.readTime);t=yn.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ve(56709);{const r=ke.fromSegments(e.unknownDocument.path),i=Tc(e.unknownDocument.version);t=yn.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const a=new pt(i[0],i[1]);return Xe.fromTimestamp(a)})(e.readTime)),t}function KI(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:H0(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(a,o){return{name:q0(a,o.key),fields:o.data.value.mapValue.fields,updateTime:md(a,o.version.toTimestamp()),createTime:md(a,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Sc(e.version)};else{if(!e.isUnknownDocument())return Ve(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Sc(e.version)}}return r}function H0(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Sc(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Tc(n){const e=new pt(n.seconds,n.nanoseconds);return Xe.fromTimestamp(e)}function Xl(n,e){const t=(e.baseMutations||[]).map((a=>t_(n.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const o=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const c=e.mutations[a+1];o.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const r=e.mutations.map((a=>t_(n.yt,a))),i=pt.fromMillis(e.localWriteTimeMs);return new Bw(e.batchId,i,t,r)}function lh(n){const e=Tc(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Tc(n.lastLimboFreeSnapshotVersion):Xe.min();let r;return r=(function(a){return a.documents!==void 0})(n.query)?(function(a){const o=a.documents.length;return Ge(o===1,1966,{count:o}),Di(Rp(PP(a.documents[0])))})(n.query):(function(a){return Di(zP(a))})(n.query),new _s(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Un.fromBase64String(n.resumeToken))}function GP(n,e){const t=Sc(e.snapshotVersion),r=Sc(e.lastLimboFreeSnapshotVersion);let i;i=U0(e.target)?jP(n.yt,e.target):VP(n.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:wc(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function qP(n){const e=zP({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?G0(e,e.limit,"L"):e}function Px(n,e){return new Fw(e.largestBatchId,t_(n.yt,e.overlayMutation))}function XI(n,e){const t=e.path.lastSegment();return[n,yr(e.path.popLast()),t]}function WI(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Sc(r.readTime),documentKey:yr(r.documentKey.path),largestBatchId:r.largestBatchId}}class PG{getBundleMetadata(e,t){return QI(e).get(t).next((r=>{if(r)return(function(a){return{id:a.bundleId,createTime:Tc(a.createTime),version:a.version}})(r)}))}saveBundleMetadata(e,t){return QI(e).put((function(i){return{bundleId:i.id,createTime:Sc(Dr(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return ZI(e).get(t).next((r=>{if(r)return(function(a){return{name:a.name,query:qP(a.bundledQuery),readTime:Tc(a.readTime)}})(r)}))}saveNamedQuery(e,t){return ZI(e).put((function(i){return{name:i.name,readTime:Sc(Dr(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function QI(n){return Wn(n,Nv)}function ZI(n){return Wn(n,Mv)}class Uv{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new Uv(e,r)}getOverlay(e,t){return Xf(e).get(XI(this.userId,t)).next((r=>r?Px(this.serializer,r):null))}getOverlays(e,t){const r=Ma();return ae.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((a,o)=>{const c=new Fw(t,o);i.push(this.St(e,c))})),ae.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((o=>i.add(yr(o.getCollectionPath()))));const a=[];return i.forEach((o=>{const c=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);a.push(Xf(e).Z(q1,c))})),ae.waitFor(a)}getOverlaysForCollection(e,t,r){const i=Ma(),a=yr(t),o=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Xf(e).J(q1,o).next((c=>{for(const u of c){const d=Px(this.serializer,u);i.set(d.getKey(),d)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const a=Ma();let o;const c=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Xf(e).ee({index:$M,range:c},((u,d,h)=>{const p=Px(this.serializer,d);a.size()<i||p.largestBatchId===o?(a.set(p.getKey(),p),o=p.largestBatchId):h.done()})).next((()=>a))}St(e,t){return Xf(e).put((function(i,a,o){const[c,u,d]=XI(a,o.mutation.key);return{userId:a,collectionPath:u,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:$0(i.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Xf(n){return Wn(n,Pv)}class OG{bt(e){return Wn(e,Mw)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?Un.fromUint8Array(r):Un.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Wl{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(nn(e.integerValue));else if("doubleValue"in e){const r=nn(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),qh(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=ks(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Ns(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?rP(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):jv(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Ve(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const i=dd,a=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(nn(a)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),ke.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Wl.Kt=new Wl;const Iu=255;function jG(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function JI(n){const e=64-(function(r){let i=0;for(let a=0;a<8;++a){const o=jG(255&r[a]);if(i+=o,o!==8)break}return i})(n);return Math.ceil(e/8)}class VG{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=JI(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=JI(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(Iu),this.sn(255)}_n(){this.an(Iu),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(a){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,a,!1),new Uint8Array(o.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Iu?(this.sn(Iu),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Iu?(this.an(Iu),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class zG{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class LG{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Wf{constructor(){this.cn=new VG,this.ln=new zG(this.cn),this.hn=new LG(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Ql{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new Ql(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:h0(this.En),directionalValue:h0(this.dn),orderedDocumentKey:h0(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function So(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=eR(n.En,e.En),t!==0?t:(t=eR(n.dn,e.dn),t!==0?t:ke.comparator(n.In,e.In)))}function eR(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function h0(n){return ON()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function tR(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class nR{constructor(e){this.mn=new Bt(((t,r)=>dn.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Ge(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=U1(e);if(t!==void 0&&!this.wn(t))return!1;const r=ql(e);let i=new Set,a=0,o=0;for(;a<r.length&&this.wn(r[a]);++a)i=i.add(r[a].fieldPath.canonicalString());if(a===r.length)return!0;if(this.mn.size>0){const c=this.mn.getIterator().getNext();if(!i.has(c.field.canonicalString())){const u=r[a];if(!this.Sn(c,u)||!this.bn(this.fn[o++],u))return!1}++a}for(;a<r.length;++a){const c=r[a];if(o>=this.fn.length||!this.bn(this.fn[o++],c))return!1}return!0}Dn(){if(this.pn)return null;let e=new Bt(dn.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new a0(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new a0(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new a0(r.field,r.dir==="asc"?0:1)));return new j0(j0.UNKNOWN_ID,this.collectionId,t,Gh.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function $P(n){if(Ge(n instanceof wt||n instanceof Lt,20012),n instanceof wt){if(n instanceof fP){const t=n.value.arrayValue?.values?.map((r=>wt.create(n.field,"==",r)))||[];return Lt.create(t,"or")}return n}const e=n.filters.map((t=>$P(t)));return Lt.create(e,n.op)}function BG(n){if(n.getFilters().length===0)return[];const e=i_($P(n));return Ge(HP(e),7391),n_(e)||r_(e)?[e]:e.getFilters()}function n_(n){return n instanceof wt}function r_(n){return n instanceof Lt&&zw(n)}function HP(n){return n_(n)||r_(n)||(function(t){if(t instanceof Lt&&K1(t)){for(const r of t.getFilters())if(!n_(r)&&!r_(r))return!1;return!0}return!1})(n)}function i_(n){if(Ge(n instanceof wt||n instanceof Lt,34018),n instanceof wt)return n;if(n.filters.length===1)return i_(n.filters[0]);const e=n.filters.map((r=>i_(r)));let t=Lt.create(e,n.op);return t=Y0(t),HP(t)?t:(Ge(t instanceof Lt,64498),Ge(pd(t),40251),Ge(t.filters.length>1,57927),t.filters.reduce(((r,i)=>$w(r,i))))}function $w(n,e){let t;return Ge(n instanceof wt||n instanceof Lt,38388),Ge(e instanceof wt||e instanceof Lt,25473),t=n instanceof wt?e instanceof wt?(function(i,a){return Lt.create([i,a],"and")})(n,e):rR(n,e):e instanceof wt?rR(e,n):(function(i,a){if(Ge(i.filters.length>0&&a.filters.length>0,48005),pd(i)&&pd(a))return cP(i,a.getFilters());const o=K1(i)?i:a,c=K1(i)?a:i,u=o.filters.map((d=>$w(d,c)));return Lt.create(u,"or")})(n,e),Y0(t)}function rR(n,e){if(pd(e))return cP(e,n.getFilters());{const t=e.filters.map((r=>$w(n,r)));return Lt.create(t,"or")}}function Y0(n){if(Ge(n instanceof wt||n instanceof Lt,11850),n instanceof wt)return n;const e=n.getFilters();if(e.length===1)return Y0(e[0]);if(oP(n))return n;const t=e.map((i=>Y0(i))),r=[];return t.forEach((i=>{i instanceof wt?r.push(i):i instanceof Lt&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:Lt.create(r,n.op)}class UG{constructor(){this.Cn=new Hw}addToCollectionParentIndex(e,t){return this.Cn.add(t),ae.resolve()}getCollectionParents(e,t){return ae.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ae.resolve()}deleteFieldIndex(e,t){return ae.resolve()}deleteAllFieldIndexes(e){return ae.resolve()}createTargetIndexes(e,t){return ae.resolve()}getDocumentsMatchingTarget(e,t){return ae.resolve(null)}getIndexType(e,t){return ae.resolve(0)}getFieldIndexes(e,t){return ae.resolve([])}getNextCollectionGroupToUpdate(e){return ae.resolve(null)}getMinOffset(e,t){return ae.resolve(oi.min())}getMinOffsetFromCollectionGroup(e,t){return ae.resolve(oi.min())}updateCollectionGroup(e,t,r){return ae.resolve()}updateIndexEntries(e,t){return ae.resolve()}}class Hw{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Bt(Pt.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Bt(Pt.comparator)).toArray()}}const iR="IndexedDbIndexManager",Dm=new Uint8Array(0);class FG{constructor(e,t){this.databaseId=t,this.vn=new Hw,this.Fn=new Ls((r=>wc(r)),((r,i)=>Ip(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const a={collectionId:r,parent:yr(i)};return aR(e).put(a)}return ae.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[MM(t),""],!1,!0);return aR(e).J(i).next((a=>{for(const o of a){if(o.collectionId!==t)break;r.push(Na(o.parent))}return r}))}addFieldIndex(e,t){const r=Qf(e),i=(function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete i.indexId;const a=r.add(i);if(t.indexState){const o=Du(e);return a.next((c=>{o.put(WI(c,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const r=Qf(e),i=Du(e),a=Ru(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Qf(e),r=Ru(e),i=Du(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return ae.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const a=new nR(r).Dn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const r=Ru(e);let i=!0;const a=new Map;return ae.forEach(this.Mn(t),(o=>this.xn(e,o).next((c=>{i&&(i=!!c),a.set(o,c)})))).next((()=>{if(i){let o=gt();const c=[];return ae.forEach(a,((u,d)=>{Ae(iR,`Using index ${(function(R){return`id=${R.indexId}|cg=${R.collectionGroup}|f=${R.fields.map((O=>`${O.fieldPath}:${O.kind}`)).join(",")}`})(u)} to execute ${wc(t)}`);const h=(function(R,O){const P=U1(O);if(P===void 0)return null;for(const N of F0(R,P.fieldPath))switch(N.op){case"array-contains-any":return N.value.arrayValue.values||[];case"array-contains":return[N.value]}return null})(d,u),p=(function(R,O){const P=new Map;for(const N of ql(O))for(const A of F0(R,N.fieldPath))switch(A.op){case"==":case"in":P.set(N.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return P.set(N.fieldPath.canonicalString(),A.value),Array.from(P.values())}return null})(d,u),m=(function(R,O){const P=[];let N=!0;for(const A of ql(O)){const I=A.kind===0?jI(R,A.fieldPath,R.startAt):VI(R,A.fieldPath,R.startAt);P.push(I.value),N&&(N=I.inclusive)}return new hd(P,N)})(d,u),b=(function(R,O){const P=[];let N=!0;for(const A of ql(O)){const I=A.kind===0?VI(R,A.fieldPath,R.endAt):jI(R,A.fieldPath,R.endAt);P.push(I.value),N&&(N=I.inclusive)}return new hd(P,N)})(d,u),_=this.On(u,d,m),w=this.On(u,d,b),S=this.Nn(u,d,p),T=this.Bn(u.indexId,h,_,m.inclusive,w,b.inclusive,S);return ae.forEach(T,(C=>r.Y(C,t.limit).next((R=>{R.forEach((O=>{const P=ke.fromSegments(O.documentKey);o.has(P)||(o=o.add(P),c.push(P))}))}))))})).next((()=>c))}return ae.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=BG(Lt.create(e.filters,"and")).map((r=>W1(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,a,o,c){const u=(t!=null?t.length:1)*Math.max(r.length,a.length),d=u/(t!=null?t.length:1),h=[];for(let p=0;p<u;++p){const m=t?this.Ln(t[p/d]):Dm,b=this.kn(e,m,r[p%d],i),_=this.qn(e,m,a[p%d],o),w=c.map((S=>this.kn(e,m,S,!0)));h.push(...this.createRange(b,_,w))}return h}kn(e,t,r,i){const a=new Ql(e,ke.empty(),t,r);return i?a:a.An()}qn(e,t,r,i){const a=new Ql(e,ke.empty(),t,r);return i?a.An():a}xn(e,t){const r=new nR(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((a=>{let o=null;for(const c of a)r.yn(c)&&(!o||c.fields.length>o.fields.length)&&(o=c);return o}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return ae.forEach(i,(a=>this.xn(e,a).next((o=>{o?r!==0&&o.fields.length<(function(u){let d=new Bt(dn.comparator),h=!1;for(const p of u.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:d=d.add(m.field));for(const p of u.orderBy)p.field.isKeyField()||(d=d.add(p.field));return d.size+(h?1:0)})(a)&&(r=1):r=0})))).next((()=>(function(o){return o.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new Wf;for(const i of ql(e)){const a=t.data.field(i.fieldPath);if(a==null)return null;const o=r.Pn(i.kind);Wl.Kt.Dt(a,o)}return r.un()}Ln(e){const t=new Wf;return Wl.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new Wf;return Wl.Kt.Dt(Wh(this.databaseId,t),r.Pn((function(a){const o=ql(a);return o.length===0?0:o[o.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new Wf);let a=0;for(const o of ql(e)){const c=r[a++];for(const u of i)if(this.Un(t,o.fieldPath)&&Qh(c))i=this.Kn(i,o,c);else{const d=u.Pn(o.kind);Wl.Kt.Dt(c,d)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],a=[];for(const o of r.arrayValue.values||[])for(const c of i){const u=new Wf;u.seed(c.un()),Wl.Kt.Dt(o,u.Pn(t.kind)),a.push(u)}return a}Un(e,t){return!!e.filters.find((r=>r instanceof wt&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=Qf(e),i=Du(e);return(t?r.J(G1,IDBKeyRange.bound(t,t)):r.J()).next((a=>{const o=[];return ae.forEach(a,(c=>i.get([c.indexId,this.uid]).next((u=>{o.push((function(h,p){const m=p?new Gh(p.sequenceNumber,new oi(Tc(p.readTime),new ke(Na(p.documentKey)),p.largestBatchId)):Gh.empty(),b=h.fields.map((([_,w])=>new a0(dn.fromServerFormat(_),w)));return new j0(h.indexId,h.collectionGroup,b,m)})(c,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const a=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return a!==0?a:it(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=Qf(e),a=Du(e);return this.Gn(e).next((o=>i.J(G1,IDBKeyRange.bound(t,t)).next((c=>ae.forEach(c,(u=>a.put(WI(u.indexId,this.uid,o,r))))))))}updateIndexEntries(e,t){const r=new Map;return ae.forEach(t,((i,a)=>{const o=r.get(i.collectionGroup);return(o?ae.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next((c=>(r.set(i.collectionGroup,c),ae.forEach(c,(u=>this.zn(e,i,u).next((d=>{const h=this.jn(a,u);return d.isEqual(h)?ae.resolve():this.Jn(e,a,u,d,h)})))))))}))}Hn(e,t,r,i){return Ru(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return Ru(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=Ru(e);let a=new Bt(So);return i.ee({index:qM,range:IDBKeyRange.only([r.indexId,this.uid,h0(this.$n(r,t))])},((o,c)=>{a=a.add(new Ql(r.indexId,t,tR(c.arrayValue),tR(c.directionalValue)))})).next((()=>a))}jn(e,t){let r=new Bt(So);const i=this.Qn(t,e);if(i==null)return r;const a=U1(t);if(a!=null){const o=e.data.field(a.fieldPath);if(Qh(o))for(const c of o.arrayValue.values||[])r=r.add(new Ql(t.indexId,e.key,this.Ln(c),i))}else r=r.add(new Ql(t.indexId,e.key,Dm,i));return r}Jn(e,t,r,i,a){Ae(iR,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,d,h,p,m){const b=u.getIterator(),_=d.getIterator();let w=Cu(b),S=Cu(_);for(;w||S;){let T=!1,C=!1;if(w&&S){const R=h(w,S);R<0?C=!0:R>0&&(T=!0)}else w!=null?C=!0:T=!0;T?(p(S),S=Cu(_)):C?(m(w),w=Cu(b)):(w=Cu(b),S=Cu(_))}})(i,a,So,(c=>{o.push(this.Hn(e,t,r,c))}),(c=>{o.push(this.Yn(e,t,r,c))})),ae.waitFor(o)}Gn(e){let t=1;return Du(e).ee({index:GM,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,a)=>{a.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((o,c)=>So(o,c))).filter(((o,c,u)=>!c||So(o,u[c-1])!==0));const i=[];i.push(e);for(const o of r){const c=So(o,e),u=So(o,t);if(c===0)i[0]=e.An();else if(c>0&&u<0)i.push(o),i.push(o.An());else if(u>0)break}i.push(t);const a=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const c=i[o].Vn(this.uid,Dm,ke.empty()),u=i[o+1].Vn(this.uid,Dm,ke.empty());a.push(IDBKeyRange.bound(c,u))}return a}Zn(e,t){return So(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(sR)}getMinOffset(e,t){return ae.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||Ve(44426))))).next(sR)}}function aR(n){return Wn(n,Yh)}function Ru(n){return Wn(n,xh)}function Qf(n){return Wn(n,Nw)}function Du(n){return Wn(n,bh)}function sR(n){Ge(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;Rw(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new oi(e.readTime,e.documentKey,t)}const oR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},YP=41943040;class pr{static withCacheSize(e){return new pr(e,pr.DEFAULT_COLLECTION_PERCENTILE,pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function KP(n,e,t){const r=n.store(Xi),i=n.store(od),a=[],o=IDBKeyRange.only(t.batchId);let c=0;const u=r.ee({range:o},((h,p,m)=>(c++,m.delete())));a.push(u.next((()=>{Ge(c===1,47070,{batchId:t.batchId})})));const d=[];for(const h of t.mutations){const p=BM(e,h.key.path,t.batchId);a.push(i.delete(p)),d.push(h.key)}return ae.waitFor(a).next((()=>d))}function K0(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ve(14731);e=n.noDocument}return JSON.stringify(e).length}pr.DEFAULT_COLLECTION_PERCENTILE=10,pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pr.DEFAULT=new pr(YP,pr.DEFAULT_COLLECTION_PERCENTILE,pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pr.DISABLED=new pr(-1,0,0);class Fv{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){Ge(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new Fv(a,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return To(e).ee({index:nc,range:r},((i,a,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const a=Vu(e),o=To(e);return o.add({}).next((c=>{Ge(typeof c=="number",49019);const u=new Bw(c,t,r,i),d=(function(b,_,w){const S=w.baseMutations.map((C=>$0(b.yt,C))),T=w.mutations.map((C=>$0(b.yt,C)));return{userId:_,batchId:w.batchId,localWriteTimeMs:w.localWriteTime.toMillis(),baseMutations:S,mutations:T}})(this.serializer,this.userId,u),h=[];let p=new Bt(((m,b)=>it(m.canonicalString(),b.canonicalString())));for(const m of i){const b=BM(this.userId,m.key.path,c);p=p.add(m.key.path.popLast()),h.push(o.put(d)),h.push(a.put(b,v7))}return p.forEach((m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[c]=u.keys()})),ae.waitFor(h).next((()=>u))}))}lookupMutationBatch(e,t){return To(e).get(t).next((r=>r?(Ge(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Xl(this.serializer,r)):null))}er(e,t){return this.Xn[t]?ae.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return To(e).ee({index:nc,range:i},((o,c,u)=>{c.userId===this.userId&&(Ge(c.batchId>=r,47524,{tr:r}),a=Xl(this.serializer,c)),u.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=lc;return To(e).ee({index:nc,range:t,reverse:!0},((i,a,o)=>{r=a.batchId,o.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,lc],[this.userId,Number.POSITIVE_INFINITY]);return To(e).J(nc,t).next((r=>r.map((i=>Xl(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=s0(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return Vu(e).ee({range:i},((o,c,u)=>{const[d,h,p]=o,m=Na(h);if(d===this.userId&&t.path.isEqual(m))return To(e).get(p).next((b=>{if(!b)throw Ve(61480,{nr:o,batchId:p});Ge(b.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:b.userId,batchId:p}),a.push(Xl(this.serializer,b))}));u.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Bt(it);const i=[];return t.forEach((a=>{const o=s0(this.userId,a.path),c=IDBKeyRange.lowerBound(o),u=Vu(e).ee({range:c},((d,h,p)=>{const[m,b,_]=d,w=Na(b);m===this.userId&&a.path.isEqual(w)?r=r.add(_):p.done()}));i.push(u)})),ae.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,a=s0(this.userId,r),o=IDBKeyRange.lowerBound(a);let c=new Bt(it);return Vu(e).ee({range:o},((u,d,h)=>{const[p,m,b]=u,_=Na(m);p===this.userId&&r.isPrefixOf(_)?_.length===i&&(c=c.add(b)):h.done()})).next((()=>this.rr(e,c)))}rr(e,t){const r=[],i=[];return t.forEach((a=>{i.push(To(e).get(a).next((o=>{if(o===null)throw Ve(35274,{batchId:a});Ge(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:a}),r.push(Xl(this.serializer,o))})))})),ae.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return KP(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),ae.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return ae.resolve();const r=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),i=[];return Vu(e).ee({range:r},((a,o,c)=>{if(a[0]===this.userId){const u=Na(a[1]);i.push(u)}else c.done()})).next((()=>{Ge(i.length===0,56720,{sr:i.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return XP(e,this.userId,t)}_r(e){return WP(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:lc,lastStreamToken:""}))}}function XP(n,e,t){const r=s0(e,t.path),i=r[1],a=IDBKeyRange.lowerBound(r);let o=!1;return Vu(n).ee({range:a,X:!0},((c,u,d)=>{const[h,p,m]=c;h===e&&p===i&&(o=!0),d.done()})).next((()=>o))}function To(n){return Wn(n,Xi)}function Vu(n){return Wn(n,od)}function WP(n){return Wn(n,$h)}class Ac{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ac(0)}static cr(){return new Ac(-1)}}class GG{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new Ac(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Xe.fromTimestamp(new pt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>ku(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(Ge(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const a=[];return ku(e).ee(((o,c)=>{const u=lh(c);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(i++,a.push(this.removeTargetData(e,u)))})).next((()=>ae.waitFor(a))).next((()=>i))}forEachTarget(e,t){return ku(e).ee(((r,i)=>{const a=lh(i);t(a)}))}lr(e){return lR(e).get(L0).next((t=>(Ge(t!==null,2888),t)))}hr(e,t){return lR(e).put(L0,t)}Pr(e,t){return ku(e).put(GP(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=wc(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return ku(e).ee({range:i,index:FM},((o,c,u)=>{const d=lh(c);Ip(t,d.target)&&(a=d,u.done())})).next((()=>a))}addMatchingKeys(e,t,r){const i=[],a=Oo(e);return t.forEach((o=>{const c=yr(o.path);i.push(a.put({targetId:r,path:c})),i.push(this.referenceDelegate.addReference(e,r,o))})),ae.waitFor(i)}removeMatchingKeys(e,t,r){const i=Oo(e);return ae.forEach(t,(a=>{const o=yr(a.path);return ae.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,a)])}))}removeMatchingKeysForTargetId(e,t){const r=Oo(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Oo(e);let a=gt();return i.ee({range:r,X:!0},((o,c,u)=>{const d=Na(o[1]),h=new ke(d);a=a.add(h)})).next((()=>a))}containsKey(e,t){const r=yr(t.path),i=IDBKeyRange.bound([r],[MM(r)],!1,!0);let a=0;return Oo(e).ee({index:kw,X:!0,range:i},(([o,c],u,d)=>{o!==0&&(a++,d.done())})).next((()=>a>0))}At(e,t){return ku(e).get(t).next((r=>r?lh(r):null))}}function ku(n){return Wn(n,ld)}function lR(n){return Wn(n,cc)}function Oo(n){return Wn(n,cd)}const cR="LruGarbageCollector",qG=1048576;function uR([n,e],[t,r]){const i=it(n,t);return i===0?it(e,r):i}class $G{constructor(e){this.Ir=e,this.buffer=new Bt(uR),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();uR(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class QP{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ae(cR,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ol(t)?Ae(cR,"Ignoring IndexedDB error during garbage collection: ",t):await Pc(t)}await this.Vr(3e5)}))}}class HG{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return ae.resolve(Ii.ce);const r=new $G(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ae("LruGarbageCollector","Garbage collection skipped; disabled"),ae.resolve(oR)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Ae("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),oR):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,a,o,c,u,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(Ae("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i)))).next((p=>(r=p,c=Date.now(),this.removeTargets(e,r,t)))).next((p=>(a=p,u=Date.now(),this.removeOrphanedDocuments(e,r)))).next((p=>(d=Date.now(),Mu()<=_t.DEBUG&&Ae("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${a} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(d-u)+`ms
Total Duration: ${d-h}ms`),ae.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:p}))))}}function ZP(n,e){return new HG(n,e)}class YG{constructor(e,t){this.db=e,this.garbageCollector=ZP(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return km(e,r)}removeReference(e,t,r){return km(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return km(e,t)}br(e,t){return(function(i,a){let o=!1;return WP(i).te((c=>XP(i,c,a).next((u=>(u&&(o=!0),ae.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Sr(e,((o,c)=>{if(c<=t){const u=this.br(e,o).next((d=>{if(!d)return a++,r.getEntry(e,o).next((()=>(r.removeEntry(o,Xe.min()),Oo(e).delete((function(p){return[0,yr(p.path)]})(o)))))}));i.push(u)}})).next((()=>ae.waitFor(i))).next((()=>r.apply(e))).next((()=>a))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return km(e,t)}Sr(e,t){const r=Oo(e);let i,a=Ii.ce;return r.ee({index:kw},(([o,c],{path:u,sequenceNumber:d})=>{o===0?(a!==Ii.ce&&t(new ke(Na(i)),a),a=d,i=u):a=Ii.ce})).next((()=>{a!==Ii.ce&&t(new ke(Na(i)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function km(n,e){return Oo(n).put((function(r,i){return{targetId:0,path:yr(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class JP{constructor(){this.changes=new Ls((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,yn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?ae.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class KG{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Ll(e).put(r)}removeEntry(e,t,r){return Ll(e).delete((function(a,o){const c=a.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],H0(o),c[c.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=yn.newInvalidDocument(t);return Ll(e).ee({index:o0,range:IDBKeyRange.only(Zf(t))},((i,a)=>{r=this.Cr(t,a)})).next((()=>r))}vr(e,t){let r={size:0,document:yn.newInvalidDocument(t)};return Ll(e).ee({index:o0,range:IDBKeyRange.only(Zf(t))},((i,a)=>{r={document:this.Cr(t,a),size:K0(a)}})).next((()=>r))}getEntries(e,t){let r=si();return this.Fr(e,t,((i,a)=>{const o=this.Cr(i,a);r=r.insert(i,o)})).next((()=>r))}Mr(e,t){let r=si(),i=new an(ke.comparator);return this.Fr(e,t,((a,o)=>{const c=this.Cr(a,o);r=r.insert(a,c),i=i.insert(a,K0(o))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return ae.resolve();let i=new Bt(hR);t.forEach((u=>i=i.add(u)));const a=IDBKeyRange.bound(Zf(i.first()),Zf(i.last())),o=i.getIterator();let c=o.getNext();return Ll(e).ee({index:o0,range:a},((u,d,h)=>{const p=ke.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;c&&hR(c,p)<0;)r(c,null),c=o.getNext();c&&c.isEqual(p)&&(r(c,d),c=o.hasNext()?o.getNext():null),c?h.j(Zf(c)):h.done()})).next((()=>{for(;c;)r(c,null),c=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,a){const o=t.path,c=[o.popLast().toArray(),o.lastSegment(),H0(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ll(e).J(IDBKeyRange.bound(c,u,!0)).next((d=>{a?.incrementDocumentReadCount(d.length);let h=si();for(const p of d){const m=this.Cr(ke.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(Dp(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h}))}getAllFromCollectionGroup(e,t,r,i){let a=si();const o=fR(t,r),c=fR(t,oi.max());return Ll(e).ee({index:UM,range:IDBKeyRange.bound(o,c,!0)},((u,d,h)=>{const p=this.Cr(ke.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);a=a.insert(p.key,p),a.size===i&&h.done()})).next((()=>a))}newChangeBuffer(e){return new XG(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return dR(e).get(F1).next((t=>(Ge(!!t,20021),t)))}Dr(e,t){return dR(e).put(F1,t)}Cr(e,t){if(t){const r=MG(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Xe.min())))return r}return yn.newInvalidDocument(e)}}function eO(n){return new KG(n)}class XG extends JP{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Ls((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new Bt(((a,o)=>it(a.canonicalString(),o.canonicalString())));return this.changes.forEach(((a,o)=>{const c=this.Br.get(a);if(t.push(this.Nr.removeEntry(e,a,c.readTime)),o.isValidDocument()){const u=KI(this.Nr.serializer,o);i=i.add(a.path.popLast());const d=K0(u);r+=d-c.size,t.push(this.Nr.addEntry(e,a,u))}else if(r-=c.size,this.trackRemovals){const u=KI(this.Nr.serializer,o.convertToNoDocument(Xe.min()));t.push(this.Nr.addEntry(e,a,u))}})),i.forEach((a=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Nr.updateMetadata(e,r)),ae.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((a,o)=>{this.Br.set(a,{size:o,readTime:r.get(a).readTime})})),r)))}}function dR(n){return Wn(n,Hh)}function Ll(n){return Wn(n,z0)}function Zf(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function fR(n,e){const t=e.documentKey.path.toArray();return[n,H0(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function hR(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(i=it(t[a],r[a]),i)return i;return i=it(t.length,r.length),i||(i=it(t[t.length-2],r[r.length-2]),i||it(t[t.length-1],r[r.length-1]))}class WG{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class tO{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Sh(r.mutation,i,Br.empty(),pt.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,gt()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=gt()){const i=Ma();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((a=>{let o=sh();return a.forEach(((c,u)=>{o=o.insert(c,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const r=Ma();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,gt())))}populateOverlays(e,t,r){const i=[];return r.forEach((a=>{t.has(a)||i.push(a)})),this.documentOverlayCache.getOverlays(e,i).next((a=>{a.forEach(((o,c)=>{t.set(o,c)}))}))}computeViews(e,t,r,i){let a=si();const o=Eh(),c=(function(){return Eh()})();return t.forEach(((u,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof Bs)?a=a.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Sh(h.mutation,d,h.mutation.getFieldMask(),pt.now())):o.set(d.key,Br.empty())})),this.recalculateAndSaveOverlays(e,a).next((u=>(u.forEach(((d,h)=>o.set(d,h))),t.forEach(((d,h)=>c.set(d,new WG(h,o.get(d)??null)))),c)))}recalculateAndSaveOverlays(e,t){const r=Eh();let i=new an(((o,c)=>o-c)),a=gt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const c of o)c.keys().forEach((u=>{const d=t.get(u);if(d===null)return;let h=r.get(u)||Br.empty();h=c.applyToLocalView(d,h),r.set(u,h);const p=(i.get(c.batchId)||gt()).add(u);i=i.insert(c.batchId,p)}))})).next((()=>{const o=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,h=u.value,p=yP();h.forEach((m=>{if(!a.has(m)){const b=TP(t.get(m),r.get(m));b!==null&&p.set(m,b),a=a.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return ae.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(o){return ke.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):hP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((a=>{const o=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):ae.resolve(Ma());let c=Fh,u=a;return o.next((d=>ae.forEach(d,((h,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),a.get(h)?ae.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{u=u.insert(h,m)}))))).next((()=>this.populateOverlays(e,d,a))).next((()=>this.computeViews(e,u,d,gt()))).next((h=>({batchId:c,changes:vP(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ke(t)).next((r=>{let i=sh();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const a=t.collectionGroup;let o=sh();return this.indexManager.getCollectionParents(e,a).next((c=>ae.forEach(c,(u=>{const d=(function(p,m){return new Md(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next((h=>{h.forEach(((p,m)=>{o=o.insert(p,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,i)))).next((o=>{a.forEach(((u,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,yn.newInvalidDocument(h)))}));let c=sh();return o.forEach(((u,d)=>{const h=a.get(u);h!==void 0&&Sh(h.mutation,d,Br.empty(),pt.now()),Dp(t,d)&&(c=c.insert(u,d))})),c}))}}class QG{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ae.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Dr(i.createTime)}})(t)),ae.resolve()}getNamedQuery(e,t){return ae.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:qP(i.bundledQuery),readTime:Dr(i.readTime)}})(t)),ae.resolve()}}class ZG{constructor(){this.overlays=new an(ke.comparator),this.qr=new Map}getOverlay(e,t){return ae.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ma();return ae.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,a)=>{this.St(e,t,a)})),ae.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(r)),ae.resolve()}getOverlaysForCollection(e,t,r){const i=Ma(),a=t.length+1,o=new ke(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===a&&u.largestBatchId>r&&i.set(u.getKey(),u)}return ae.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new an(((d,h)=>d-h));const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let h=a.get(d.largestBatchId);h===null&&(h=Ma(),a=a.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const c=Ma(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((d,h)=>c.set(d,h))),!(c.size()>=i)););return ae.resolve(c)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Fw(t,r));let a=this.qr.get(t);a===void 0&&(a=gt(),this.qr.set(t,a)),this.qr.set(t,a.add(r.key))}}class JG{constructor(){this.sessionToken=Un.EMPTY_BYTE_STRING}getSessionToken(e){return ae.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ae.resolve()}}class Yw{constructor(){this.Qr=new Bt(er.$r),this.Ur=new Bt(er.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new er(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new er(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new ke(new Pt([])),r=new er(t,e),i=new er(t,e+1),a=[];return this.Ur.forEachInRange([r,i],(o=>{this.Gr(o),a.push(o.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ke(new Pt([])),r=new er(t,e),i=new er(t,e+1);let a=gt();return this.Ur.forEachInRange([r,i],(o=>{a=a.add(o.key)})),a}containsKey(e){const t=new er(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class er{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ke.comparator(e.key,t.key)||it(e.Yr,t.Yr)}static Kr(e,t){return it(e.Yr,t.Yr)||ke.comparator(e.key,t.key)}}class eq{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Bt(er.$r)}checkEmpty(e){return ae.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Bw(a,t,r,i);this.mutationQueue.push(o);for(const c of i)this.Zr=this.Zr.add(new er(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return ae.resolve(o)}lookupMutationBatch(e,t){return ae.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),a=i<0?0:i;return ae.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ae.resolve(this.mutationQueue.length===0?lc:this.tr-1)}getAllMutationBatches(e){return ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new er(t,0),i=new er(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([r,i],(o=>{const c=this.Xr(o.Yr);a.push(c)})),ae.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Bt(it);return t.forEach((i=>{const a=new er(i,0),o=new er(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,o],(c=>{r=r.add(c.Yr)}))})),ae.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;ke.isDocumentKey(a)||(a=a.child(""));const o=new er(new ke(a),0);let c=new Bt(it);return this.Zr.forEachWhile((u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(c=c.add(u.Yr)),!0)}),o),ae.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Ge(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return ae.forEach(t.mutations,(i=>{const a=new er(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new er(t,0),i=this.Zr.firstAfterOrEqual(r);return ae.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ae.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class tq{constructor(e){this.ri=e,this.docs=(function(){return new an(ke.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,o=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return ae.resolve(r?r.document.mutableCopy():yn.newInvalidDocument(t))}getEntries(e,t){let r=si();return t.forEach((i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():yn.newInvalidDocument(i))})),ae.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let a=si();const o=t.path,c=new ke(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:h}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||Rw(jM(h),r)<=0||(i.has(h.key)||Dp(t,h))&&(a=a.insert(h.key,h.mutableCopy()))}return ae.resolve(a)}getAllFromCollectionGroup(e,t,r,i){Ve(9500)}ii(e,t){return ae.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new nq(this)}getSize(e){return ae.resolve(this.size)}}class nq extends JP{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),ae.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class rq{constructor(e){this.persistence=e,this.si=new Ls((t=>wc(t)),Ip),this.lastRemoteSnapshotVersion=Xe.min(),this.highestTargetId=0,this.oi=0,this._i=new Yw,this.targetCount=0,this.ai=Ac.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),ae.resolve()}getLastRemoteSnapshotVersion(e){return ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ae.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ae.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),ae.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ac(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ae.resolve()}updateTargetData(e,t){return this.Pr(t),ae.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ae.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.si.forEach(((o,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(o),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)})),ae.waitFor(a).next((()=>i))}getTargetCount(e){return ae.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return ae.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),ae.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach((o=>{a.push(i.markPotentiallyOrphaned(e,o))})),ae.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ae.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return ae.resolve(r)}containsKey(e,t){return ae.resolve(this._i.containsKey(t))}}class Kw{constructor(e,t){this.ui={},this.overlays={},this.ci=new Ii(0),this.li=!1,this.li=!0,this.hi=new JG,this.referenceDelegate=e(this),this.Pi=new rq(this),this.indexManager=new UG,this.remoteDocumentCache=(function(i){return new tq(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new FP(t),this.Ii=new QG(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ZG,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new eq(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){Ae("MemoryPersistence","Starting transaction:",e);const i=new iq(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((a=>this.referenceDelegate.di(i).next((()=>a)))).toPromise().then((a=>(i.raiseOnCommittedEvent(),a)))}Ai(e,t){return ae.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class iq extends zM{constructor(e){super(),this.currentSequenceNumber=e}}class Gv{constructor(e){this.persistence=e,this.Ri=new Yw,this.Vi=null}static mi(e){return new Gv(e)}get fi(){if(this.Vi)return this.Vi;throw Ve(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),ae.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),ae.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ae.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((a=>this.fi.add(a.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ae.forEach(this.fi,(r=>{const i=ke.fromPath(r);return this.gi(e,i).next((a=>{a||t.removeEntry(i,Xe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return ae.or([()=>ae.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class X0{constructor(e,t){this.persistence=e,this.pi=new Ls((r=>yr(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=ZP(this,t)}static mi(e,t){return new X0(e,t)}Ei(){}di(e){return ae.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return ae.forEach(this.pi,((r,i)=>this.br(e,r,i).next((a=>a?ae.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,(o=>this.br(e,o,t).next((c=>{c||(r++,a.removeEntry(o,Xe.min()))})))).next((()=>a.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),ae.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),ae.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),ae.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),ae.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=c0(e.data.value)),t}br(e,t,r){return ae.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return ae.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class aq{constructor(e){this.serializer=e}k(e,t,r,i){const a=new Dv("createOrUpgrade",t);r<1&&i>=1&&((function(u){u.createObjectStore(Cp)})(e),(function(u){u.createObjectStore($h,{keyPath:m7}),u.createObjectStore(Xi,{keyPath:SI,autoIncrement:!0}).createIndex(nc,TI,{unique:!0}),u.createObjectStore(od)})(e),pR(e),(function(u){u.createObjectStore($l)})(e));let o=ae.resolve();return r<3&&i>=3&&(r!==0&&((function(u){u.deleteObjectStore(cd),u.deleteObjectStore(ld),u.deleteObjectStore(cc)})(e),pR(e)),o=o.next((()=>(function(u){const d=u.store(cc),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Xe.min().toTimestamp(),targetCount:0};return d.put(L0,h)})(a)))),r<4&&i>=4&&(r!==0&&(o=o.next((()=>(function(u,d){return d.store(Xi).J().next((p=>{u.deleteObjectStore(Xi),u.createObjectStore(Xi,{keyPath:SI,autoIncrement:!0}).createIndex(nc,TI,{unique:!0});const m=d.store(Xi),b=p.map((_=>m.put(_)));return ae.waitFor(b)}))})(e,a)))),o=o.next((()=>{(function(u){u.createObjectStore(ud,{keyPath:T7})})(e)}))),r<5&&i>=5&&(o=o.next((()=>this.yi(a)))),r<6&&i>=6&&(o=o.next((()=>((function(u){u.createObjectStore(Hh)})(e),this.wi(a))))),r<7&&i>=7&&(o=o.next((()=>this.Si(a)))),r<8&&i>=8&&(o=o.next((()=>this.bi(e,a)))),r<9&&i>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(o=o.next((()=>this.Di(a)))),r<11&&i>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(Nv,{keyPath:A7})})(e),(function(u){u.createObjectStore(Mv,{keyPath:C7})})(e)}))),r<12&&i>=12&&(o=o.next((()=>{(function(u){const d=u.createObjectStore(Pv,{keyPath:P7});d.createIndex(q1,O7,{unique:!1}),d.createIndex($M,j7,{unique:!1})})(e)}))),r<13&&i>=13&&(o=o.next((()=>(function(u){const d=u.createObjectStore(z0,{keyPath:y7});d.createIndex(o0,b7),d.createIndex(UM,x7)})(e))).next((()=>this.Ci(e,a))).next((()=>e.deleteObjectStore($l)))),r<14&&i>=14&&(o=o.next((()=>this.Fi(e,a)))),r<15&&i>=15&&(o=o.next((()=>(function(u){u.createObjectStore(Nw,{keyPath:I7,autoIncrement:!0}).createIndex(G1,R7,{unique:!1}),u.createObjectStore(bh,{keyPath:D7}).createIndex(GM,k7,{unique:!1}),u.createObjectStore(xh,{keyPath:N7}).createIndex(qM,M7,{unique:!1})})(e)))),r<16&&i>=16&&(o=o.next((()=>{t.objectStore(bh).clear()})).next((()=>{t.objectStore(xh).clear()}))),r<17&&i>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(Mw,{keyPath:V7})})(e)}))),r<18&&i>=18&&ON()&&(o=o.next((()=>{t.objectStore(bh).clear()})).next((()=>{t.objectStore(xh).clear()}))),o}wi(e){let t=0;return e.store($l).ee(((r,i)=>{t+=K0(i)})).next((()=>{const r={byteSize:t};return e.store(Hh).put(F1,r)}))}yi(e){const t=e.store($h),r=e.store(Xi);return t.J().next((i=>ae.forEach(i,(a=>{const o=IDBKeyRange.bound([a.userId,lc],[a.userId,a.lastAcknowledgedBatchId]);return r.J(nc,o).next((c=>ae.forEach(c,(u=>{Ge(u.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const d=Xl(this.serializer,u);return KP(e,a.userId,d).next((()=>{}))}))))}))))}Si(e){const t=e.store(cd),r=e.store($l);return e.store(cc).get(L0).next((i=>{const a=[];return r.ee(((o,c)=>{const u=new Pt(o),d=(function(p){return[0,yr(p)]})(u);a.push(t.get(d).next((h=>h?ae.resolve():(p=>t.put({targetId:0,path:yr(p),sequenceNumber:i.highestListenSequenceNumber}))(u))))})).next((()=>ae.waitFor(a)))}))}bi(e,t){e.createObjectStore(Yh,{keyPath:S7});const r=t.store(Yh),i=new Hw,a=o=>{if(i.add(o)){const c=o.lastSegment(),u=o.popLast();return r.put({collectionId:c,parent:yr(u)})}};return t.store($l).ee({X:!0},((o,c)=>{const u=new Pt(o);return a(u.popLast())})).next((()=>t.store(od).ee({X:!0},(([o,c,u],d)=>{const h=Na(c);return a(h.popLast())}))))}Di(e){const t=e.store(ld);return t.ee(((r,i)=>{const a=lh(i),o=GP(this.serializer,a);return t.put(o)}))}Ci(e,t){const r=t.store($l),i=[];return r.ee(((a,o)=>{const c=t.store(z0),u=(function(p){return p.document?new ke(Pt.fromString(p.document.name).popFirst(5)):p.noDocument?ke.fromSegments(p.noDocument.path):p.unknownDocument?ke.fromSegments(p.unknownDocument.path):Ve(36783)})(o).path.toArray(),d={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(c.put(d))})).next((()=>ae.waitFor(i)))}Fi(e,t){const r=t.store(Xi),i=eO(this.serializer),a=new Kw(Gv.mi,this.serializer.yt);return r.J().next((o=>{const c=new Map;return o.forEach((u=>{let d=c.get(u.userId)??gt();Xl(this.serializer,u).keys().forEach((h=>d=d.add(h))),c.set(u.userId,d)})),ae.forEach(c,((u,d)=>{const h=new lr(d),p=Uv.wt(this.serializer,h),m=a.getIndexManager(h),b=Fv.wt(h,this.serializer,m,a.referenceDelegate);return new tO(i,b,p,m).recalculateAndSaveOverlaysForDocumentKeys(new $1(t,Ii.ce),u).next()}))}))}}function pR(n){n.createObjectStore(cd,{keyPath:w7}).createIndex(kw,E7,{unique:!0}),n.createObjectStore(ld,{keyPath:"targetId"}).createIndex(FM,_7,{unique:!0}),n.createObjectStore(cc)}const Ao="IndexedDbPersistence",Ox=18e5,jx=5e3,Vx="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",sq="main";class Xw{constructor(e,t,r,i,a,o,c,u,d,h,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=a,this.window=o,this.document=c,this.xi=d,this.Oi=h,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!Xw.v())throw new Re(me.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new YG(this,i),this.$i=t+sq,this.serializer=new FP(u),this.Ui=new $o(this.$i,this.Ni,new aq(this.serializer)),this.hi=new OG,this.Pi=new GG(this.referenceDelegate,this.serializer),this.remoteDocumentCache=eO(this.serializer),this.Ii=new PG,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&Cr(Ao,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Re(me.FAILED_PRECONDITION,Vx);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Ii(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Nm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(ol(e))return Ae(Ao,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ae(Ao,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Jf(e).get(Au).next((t=>ae.resolve(this.es(t))))}ts(e){return Nm(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Ox)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=Wn(t,ud);return r.J().next((i=>{const a=this.ss(i,Ox),o=i.filter((c=>a.indexOf(c)===-1));return ae.forEach(o,(c=>r.delete(c.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?ae.resolve(!0):Jf(e).get(Au).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,jx)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Re(me.FAILED_PRECONDITION,Vx);return!1}}return!(!this.networkEnabled||!this.inForeground)||Nm(e).J().next((r=>this.ss(r,jx).find((i=>{if(this.clientId!==i.clientId){const a=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,c=this.networkEnabled===i.networkEnabled;if(a||o&&c)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Ae(Ao,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Cp,ud],(e=>{const t=new $1(e,Ii.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Nm(e).J().next((t=>this.ss(t,Ox).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return Fv.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new FG(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Uv.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){Ae(Ao,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",a=(function(u){return u===18?B7:u===17?XM:u===16?L7:u===15?Pw:u===14?KM:u===13?YM:u===12?z7:u===11?HM:void Ve(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,i,a,(c=>(o=new $1(c,this.ci?this.ci.next():Ii.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw Cr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Re(me.FAILED_PRECONDITION,VM);return r(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>r(o)))))).then((c=>(o.raiseOnCommittedEvent(),c)))}Is(e){return Jf(e).get(Au).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,jx)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Re(me.FAILED_PRECONDITION,Vx)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Jf(e).put(Au,t)}static v(){return $o.v()}Zi(e){const t=Jf(e);return t.get(Au).next((r=>this.es(r)?(Ae(Ao,"Releasing primary lease."),t.delete(Au)):ae.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Cr(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;PN()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return Ae(Ao,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Cr(Ao,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Cr("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Jf(n){return Wn(n,Cp)}function Nm(n){return Wn(n,ud)}function oq(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Ww{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=gt(),i=gt();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Ww(e,t.fromCache,r,i)}}class lq{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class nO{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return PN()?8:LM(Xn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const a={result:null};return this.ys(e,t).next((o=>{a.result=o})).next((()=>{if(!a.result)return this.ws(e,t,i,r).next((o=>{a.result=o}))})).next((()=>{if(a.result)return;const o=new lq;return this.Ss(e,t,o).next((c=>{if(a.result=c,this.Vs)return this.bs(e,t,o,c.size)}))})).next((()=>a.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(Mu()<=_t.DEBUG&&Ae("QueryEngine","SDK will not create cache indexes for query:",Pu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ae.resolve()):(Mu()<=_t.DEBUG&&Ae("QueryEngine","Query:",Pu(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Mu()<=_t.DEBUG&&Ae("QueryEngine","The SDK decides to create cache indexes for query:",Pu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Di(t))):ae.resolve())}ys(e,t){if(zI(t))return ae.resolve(null);let r=Di(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=G0(t,null,"F"),r=Di(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((a=>{const o=gt(...a);return this.ps.getDocuments(e,o).next((c=>this.indexManager.getMinOffset(e,r).next((u=>{const d=this.Ds(t,c);return this.Cs(t,d,o,u.readTime)?this.ys(e,G0(t,null,"F")):this.vs(e,d,t,u)}))))})))))}ws(e,t,r,i){return zI(t)||i.isEqual(Xe.min())?ae.resolve(null):this.ps.getDocuments(e,r).next((a=>{const o=this.Ds(t,a);return this.Cs(t,o,r,i)?ae.resolve(null):(Mu()<=_t.DEBUG&&Ae("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Pu(t)),this.vs(e,o,t,c7(i,Fh)).next((c=>c)))}))}Ds(e,t){let r=new Bt(gP(e));return t.forEach(((i,a)=>{Dp(e,a)&&(r=r.add(a))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,t,r){return Mu()<=_t.DEBUG&&Ae("QueryEngine","Using full collection scan to execute query:",Pu(t)),this.ps.getDocumentsMatchingQuery(e,t,oi.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((a=>(t.forEach((o=>{a=a.insert(o.key,o)})),a)))}}const Qw="LocalStore",cq=3e8;class uq{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new an(it),this.xs=new Ls((a=>wc(a)),Ip),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tO(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function rO(n,e,t,r){return new uq(n,e,t,r)}async function iO(n,e){const t=st(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((a=>(i=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((a=>{const o=[],c=[];let u=gt();for(const d of i){o.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}for(const d of a){c.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}return t.localDocuments.getDocuments(r,u).next((d=>({Ls:d,removedBatchIds:o,addedBatchIds:c})))}))}))}function dq(n,e){const t=st(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,u,d,h){const p=d.batch,m=p.keys();let b=ae.resolve();return m.forEach((_=>{b=b.next((()=>h.getEntry(u,_))).next((w=>{const S=d.docVersions.get(_);Ge(S!==null,48541),w.version.compareTo(S)<0&&(p.applyToRemoteDocument(w,d),w.isValidDocument()&&(w.setReadTime(d.commitVersion),h.addEntry(w)))}))})),b.next((()=>c.mutationQueue.removeMutationBatch(u,p)))})(t,r,e,a).next((()=>a.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let u=gt();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function aO(n){const e=st(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function fq(n,e){const t=st(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const c=[];e.targetChanges.forEach(((h,p)=>{const m=i.get(p);if(!m)return;c.push(t.Pi.removeMatchingKeys(a,h.removedDocuments,p).next((()=>t.Pi.addMatchingKeys(a,h.addedDocuments,p))));let b=m.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(p)!==null?b=b.withResumeToken(Un.EMPTY_BYTE_STRING,Xe.min()).withLastLimboFreeSnapshotVersion(Xe.min()):h.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(h.resumeToken,r)),i=i.insert(p,b),(function(w,S,T){return w.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=cq?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(m,b,h)&&c.push(t.Pi.updateTargetData(a,b))}));let u=si(),d=gt();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(a,h))})),c.push(hq(a,o,e.documentUpdates).next((h=>{u=h.ks,d=h.qs}))),!r.isEqual(Xe.min())){const h=t.Pi.getLastRemoteSnapshotVersion(a).next((p=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,r)));c.push(h)}return ae.waitFor(c).next((()=>o.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,u,d))).next((()=>u))})).then((a=>(t.Ms=i,a)))}function hq(n,e,t){let r=gt(),i=gt();return t.forEach((a=>r=r.add(a))),e.getEntries(n,r).next((a=>{let o=si();return t.forEach(((c,u)=>{const d=a.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(Xe.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):Ae(Qw,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)})),{ks:o,qs:i}}))}function pq(n,e){const t=st(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=lc),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function gq(n,e){const t=st(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((a=>a?(i=a,ae.resolve(i)):t.Pi.allocateTargetId(r).next((o=>(i=new _s(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function a_(n,e,t){const r=st(n),i=r.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,(o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!ol(o))throw o;Ae(Qw,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function gR(n,e,t){const r=st(n);let i=Xe.min(),a=gt();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(u,d,h){const p=st(u),m=p.xs.get(h);return m!==void 0?ae.resolve(p.Ms.get(m)):p.Pi.getTargetData(d,h)})(r,o,Di(e)).next((c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,c.targetId).next((u=>{a=u}))})).next((()=>r.Fs.getDocumentsMatchingQuery(o,e,t?i:Xe.min(),t?a:gt()))).next((c=>(mq(r,tG(e),c),{documents:c,Qs:a})))))}function mq(n,e,t){let r=n.Os.get(e)||Xe.min();t.forEach(((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)})),n.Os.set(e,r)}class mR{constructor(){this.activeTargetIds=oG()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class sO{constructor(){this.Mo=new mR,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new mR,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class vq{Oo(e){}shutdown(){}}const vR="ConnectivityMonitor";class yR{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ae(vR,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ae(vR,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Mm=null;function s_(){return Mm===null?Mm=(function(){return 268435456+Math.round(2147483648*Math.random())})():Mm++,"0x"+Mm.toString(16)}const zx="RestConnection",yq={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class bq{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===B0?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,a){const o=s_(),c=this.zo(e,t.toUriEncodedString());Ae(zx,`Sending RPC '${e}' ${o}:`,c,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,a);const{host:d}=new URL(c),h=Dd(d);return this.Jo(e,c,u,r,h).then((p=>(Ae(zx,`Received RPC '${e}' ${o}: `,p),p)),(p=>{throw xc(zx,`RPC '${e}' ${o} failed with error: `,p,"url: ",c,"request:",r),p}))}Ho(e,t,r,i,a,o){return this.Go(e,t,r,i,a)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Nd})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,a)=>e[a]=i)),r&&r.headers.forEach(((i,a)=>e[a]=i))}zo(e,t){const r=yq[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class xq{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const hr="WebChannelConnection";class _q extends bq{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,a){const o=s_();return new Promise(((c,u)=>{const d=new AM;d.setWithCredentials(!0),d.listenOnce(CM.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case i0.NO_ERROR:const p=d.getResponseJson();Ae(hr,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),c(p);break;case i0.TIMEOUT:Ae(hr,`RPC '${e}' ${o} timed out`),u(new Re(me.DEADLINE_EXCEEDED,"Request time out"));break;case i0.HTTP_ERROR:const m=d.getStatus();if(Ae(hr,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let b=d.getResponseJson();Array.isArray(b)&&(b=b[0]);const _=b?.error;if(_&&_.status&&_.message){const w=(function(T){const C=T.toLowerCase().replace(/_/g,"-");return Object.values(me).indexOf(C)>=0?C:me.UNKNOWN})(_.status);u(new Re(w,_.message))}else u(new Re(me.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new Re(me.UNAVAILABLE,"Connection failed."));break;default:Ve(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Ae(hr,`RPC '${e}' ${o} completed.`)}}));const h=JSON.stringify(i);Ae(hr,`RPC '${e}' ${o} sending request:`,i),d.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=s_(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=DM(),c=RM(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const h=a.join("");Ae(hr,`Creating RPC '${e}' stream ${i}: ${h}`,u);const p=o.createWebChannel(h,u);this.I_(p);let m=!1,b=!1;const _=new xq({Yo:S=>{b?Ae(hr,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(m||(Ae(hr,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),Ae(hr,`RPC '${e}' stream ${i} sending:`,S),p.send(S))},Zo:()=>p.close()}),w=(S,T,C)=>{S.listen(T,(R=>{try{C(R)}catch(O){setTimeout((()=>{throw O}),0)}}))};return w(p,ah.EventType.OPEN,(()=>{b||(Ae(hr,`RPC '${e}' stream ${i} transport opened.`),_.o_())})),w(p,ah.EventType.CLOSE,(()=>{b||(b=!0,Ae(hr,`RPC '${e}' stream ${i} transport closed`),_.a_(),this.E_(p))})),w(p,ah.EventType.ERROR,(S=>{b||(b=!0,xc(hr,`RPC '${e}' stream ${i} transport errored. Name:`,S.name,"Message:",S.message),_.a_(new Re(me.UNAVAILABLE,"The operation could not be completed")))})),w(p,ah.EventType.MESSAGE,(S=>{if(!b){const T=S.data[0];Ge(!!T,16349);const C=T,R=C?.error||C[0]?.error;if(R){Ae(hr,`RPC '${e}' stream ${i} received error:`,R);const O=R.status;let P=(function(I){const k=Vn[I];if(k!==void 0)return IP(k)})(O),N=R.message;P===void 0&&(P=me.INTERNAL,N="Unknown error status: "+O+" with message "+R.message),b=!0,_.a_(new Re(P,N)),p.close()}else Ae(hr,`RPC '${e}' stream ${i} received:`,T),_.u_(T)}})),w(c,IM.STAT_EVENT,(S=>{S.stat===L1.PROXY?Ae(hr,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===L1.NOPROXY&&Ae(hr,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{_.__()}),0),_}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function wq(){return typeof window<"u"?window:null}function p0(){return typeof document<"u"?document:null}function qv(n){return new EG(n,!0)}class oO{constructor(e,t,r=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&Ae("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const bR="PersistentStream";class lO{constructor(e,t,r,i,a,o,c,u){this.Mi=e,this.S_=r,this.b_=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new oO(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===me.RESOURCE_EXHAUSTED?(Cr(t.toString()),Cr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===me.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new Re(me.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ae(bR,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Ae(bR,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Eq extends lO{constructor(e,t,r,i,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=AG(this.serializer,e),r=(function(a){if(!("targetChange"in a))return Xe.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?Xe.min():o.readTime?Dr(o.readTime):Xe.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=e_(this.serializer),t.addTarget=(function(a,o){let c;const u=o.target;if(c=U0(u)?{documents:jP(a,u)}:{query:VP(a,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=kP(a,o.resumeToken);const d=Z1(a,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(Xe.min())>0){c.readTime=md(a,o.snapshotVersion.toTimestamp());const d=Z1(a,o.expectedCount);d!==null&&(c.expectedCount=d)}return c})(this.serializer,e);const r=IG(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=e_(this.serializer),t.removeTarget=e,this.q_(t)}}class Sq extends lO{constructor(e,t,r,i,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ge(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ge(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ge(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=CG(e.writeResults,e.commitTime),r=Dr(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=e_(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>$0(this.serializer,r)))};this.q_(t)}}class Tq{}class Aq extends Tq{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Re(me.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Go(e,J1(t,r),i,a,o))).catch((a=>{throw a.name==="FirebaseError"?(a.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Re(me.UNKNOWN,a.toString())}))}Ho(e,t,r,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Ho(e,J1(t,r),i,o,c,a))).catch((o=>{throw o.name==="FirebaseError"?(o.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Re(me.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Cq{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Cr(t),this.aa=!1):Ae("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Cc="RemoteStore";class Iq{constructor(e,t,r,i,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((o=>{r.enqueueAndForget((async()=>{Oc(this)&&(Ae(Cc,"Restarting streams for network reachability change."),await(async function(u){const d=st(u);d.Ea.add(4),await Mp(d),d.Ra.set("Unknown"),d.Ea.delete(4),await $v(d)})(this))}))})),this.Ra=new Cq(r,i)}}async function $v(n){if(Oc(n))for(const e of n.da)await e(!0)}async function Mp(n){for(const e of n.da)await e(!1)}function cO(n,e){const t=st(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),tE(t)?eE(t):Od(t).O_()&&Jw(t,e))}function Zw(n,e){const t=st(n),r=Od(t);t.Ia.delete(e),r.O_()&&uO(t,e),t.Ia.size===0&&(r.O_()?r.L_():Oc(t)&&t.Ra.set("Unknown"))}function Jw(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Xe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Od(n).Y_(e)}function uO(n,e){n.Va.Ue(e),Od(n).Z_(e)}function eE(n){n.Va=new bG({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Od(n).start(),n.Ra.ua()}function tE(n){return Oc(n)&&!Od(n).x_()&&n.Ia.size>0}function Oc(n){return st(n).Ea.size===0}function dO(n){n.Va=void 0}async function Rq(n){n.Ra.set("Online")}async function Dq(n){n.Ia.forEach(((e,t)=>{Jw(n,e)}))}async function kq(n,e){dO(n),tE(n)?(n.Ra.ha(e),eE(n)):n.Ra.set("Unknown")}async function Nq(n,e,t){if(n.Ra.set("Online"),e instanceof DP&&e.state===2&&e.cause)try{await(async function(i,a){const o=a.cause;for(const c of a.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.Ia.delete(c),i.Va.removeTarget(c))})(n,e)}catch(r){Ae(Cc,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await W0(n,r)}else if(e instanceof f0?n.Va.Ze(e):e instanceof RP?n.Va.st(e):n.Va.tt(e),!t.isEqual(Xe.min()))try{const r=await aO(n.localStore);t.compareTo(r)>=0&&await(function(a,o){const c=a.Va.Tt(o);return c.targetChanges.forEach(((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const h=a.Ia.get(d);h&&a.Ia.set(d,h.withResumeToken(u.resumeToken,o))}})),c.targetMismatches.forEach(((u,d)=>{const h=a.Ia.get(u);if(!h)return;a.Ia.set(u,h.withResumeToken(Un.EMPTY_BYTE_STRING,h.snapshotVersion)),uO(a,u);const p=new _s(h.target,u,d,h.sequenceNumber);Jw(a,p)})),a.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){Ae(Cc,"Failed to raise snapshot:",r),await W0(n,r)}}async function W0(n,e,t){if(!ol(e))throw e;n.Ea.add(1),await Mp(n),n.Ra.set("Offline"),t||(t=()=>aO(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Ae(Cc,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await $v(n)}))}function fO(n,e){return e().catch((t=>W0(n,t,e)))}async function Pp(n){const e=st(n),t=Qo(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:lc;for(;Mq(e);)try{const i=await pq(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,Pq(e,i)}catch(i){await W0(e,i)}hO(e)&&pO(e)}function Mq(n){return Oc(n)&&n.Ta.length<10}function Pq(n,e){n.Ta.push(e);const t=Qo(n);t.O_()&&t.X_&&t.ea(e.mutations)}function hO(n){return Oc(n)&&!Qo(n).x_()&&n.Ta.length>0}function pO(n){Qo(n).start()}async function Oq(n){Qo(n).ra()}async function jq(n){const e=Qo(n);for(const t of n.Ta)e.ea(t.mutations)}async function Vq(n,e,t){const r=n.Ta.shift(),i=Uw.from(r,e,t);await fO(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await Pp(n)}async function zq(n,e){e&&Qo(n).X_&&await(async function(r,i){if((function(o){return mG(o)&&o!==me.ABORTED})(i.code)){const a=r.Ta.shift();Qo(r).B_(),await fO(r,(()=>r.remoteSyncer.rejectFailedWrite(a.batchId,i))),await Pp(r)}})(n,e),hO(n)&&pO(n)}async function xR(n,e){const t=st(n);t.asyncQueue.verifyOperationInProgress(),Ae(Cc,"RemoteStore received new credentials");const r=Oc(t);t.Ea.add(3),await Mp(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await $v(t)}async function Lq(n,e){const t=st(n);e?(t.Ea.delete(2),await $v(t)):e||(t.Ea.add(2),await Mp(t),t.Ra.set("Unknown"))}function Od(n){return n.ma||(n.ma=(function(t,r,i){const a=st(t);return a.sa(),new Eq(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:Rq.bind(null,n),t_:Dq.bind(null,n),r_:kq.bind(null,n),H_:Nq.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),tE(n)?eE(n):n.Ra.set("Unknown")):(await n.ma.stop(),dO(n))}))),n.ma}function Qo(n){return n.fa||(n.fa=(function(t,r,i){const a=st(t);return a.sa(),new Sq(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:Oq.bind(null,n),r_:zq.bind(null,n),ta:jq.bind(null,n),na:Vq.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Pp(n)):(await n.fa.stop(),n.Ta.length>0&&(Ae(Cc,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class nE{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new za,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,a){const o=Date.now()+r,c=new nE(e,t,o,i,a);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Re(me.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function rE(n,e){if(Cr("AsyncQueue",`${e}: ${n}`),ol(n))return new Re(me.UNAVAILABLE,`${e}: ${n}`);throw n}class td{static emptySet(e){return new td(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ke.comparator(t.key,r.key):(t,r)=>ke.comparator(t.key,r.key),this.keyedMap=sh(),this.sortedSet=new an(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof td)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new td;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class _R{constructor(){this.ga=new an(ke.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ve(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class vd{constructor(e,t,r,i,a,o,c,u,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,a){const o=[];return t.forEach((c=>{o.push({type:0,doc:c})})),new vd(e,t,td.emptySet(t),o,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Vv(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class Bq{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Uq{constructor(){this.queries=wR(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=st(t),a=i.queries;i.queries=wR(),a.forEach(((o,c)=>{for(const u of c.Sa)u.onError(r)}))})(this,new Re(me.ABORTED,"Firestore shutting down"))}}function wR(){return new Ls((n=>pP(n)),Vv)}async function iE(n,e){const t=st(n);let r=3;const i=e.query;let a=t.queries.get(i);a?!a.ba()&&e.Da()&&(r=2):(a=new Bq,r=e.Da()?0:1);try{switch(r){case 0:a.wa=await t.onListen(i,!0);break;case 1:a.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const c=rE(o,`Initialization of query '${Pu(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&sE(t)}async function aE(n,e){const t=st(n),r=e.query;let i=3;const a=t.queries.get(r);if(a){const o=a.Sa.indexOf(e);o>=0&&(a.Sa.splice(o,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function Fq(n,e){const t=st(n);let r=!1;for(const i of e){const a=i.query,o=t.queries.get(a);if(o){for(const c of o.Sa)c.Fa(i)&&(r=!0);o.wa=i}}r&&sE(t)}function Gq(n,e,t){const r=st(n),i=r.queries.get(e);if(i)for(const a of i.Sa)a.onError(t);r.queries.delete(e)}function sE(n){n.Ca.forEach((e=>{e.next()}))}var o_,ER;(ER=o_||(o_={})).Ma="default",ER.Cache="cache";class oE{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new vd(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=vd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==o_.Cache}}class gO{constructor(e){this.key=e}}class mO{constructor(e){this.key=e}}class qq{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=gt(),this.mutatedKeys=gt(),this.eu=gP(e),this.tu=new td(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new _R,i=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,o=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,p)=>{const m=i.get(h),b=Dp(this.query,p)?p:null,_=!!m&&this.mutatedKeys.has(m.key),w=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let S=!1;m&&b?m.data.isEqual(b.data)?_!==w&&(r.track({type:3,doc:b}),S=!0):this.su(m,b)||(r.track({type:2,doc:b}),S=!0,(u&&this.eu(b,u)>0||d&&this.eu(b,d)<0)&&(c=!0)):!m&&b?(r.track({type:0,doc:b}),S=!0):m&&!b&&(r.track({type:1,doc:m}),S=!0,(u||d)&&(c=!0)),S&&(b?(o=o.add(b),a=w?a.add(h):a.delete(h)):(o=o.delete(h),a=a.delete(h)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),a=a.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:c,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((h,p)=>(function(b,_){const w=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ve(20277,{Rt:S})}};return w(b)-w(_)})(h.type,p.type)||this.eu(h.doc,p.doc))),this.ou(r),i=i??!1;const c=t&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,d=u!==this.Za;return this.Za=u,o.length!==0||d?{snapshot:new vd(this.query,e.tu,a,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new _R,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=gt(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new mO(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new gO(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=gt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return vd.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const lE="SyncEngine";class $q{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Hq{constructor(e){this.key=e,this.hu=!1}}class Yq{constructor(e,t,r,i,a,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Ls((c=>pP(c)),Vv),this.Iu=new Map,this.Eu=new Set,this.du=new an(ke.comparator),this.Au=new Map,this.Ru=new Yw,this.Vu={},this.mu=new Map,this.fu=Ac.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Kq(n,e,t=!0){const r=wO(n);let i;const a=r.Tu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await vO(r,e,t,!0),i}async function Xq(n,e){const t=wO(n);await vO(t,e,!0,!1)}async function vO(n,e,t,r){const i=await gq(n.localStore,Di(e)),a=i.targetId,o=n.sharedClientState.addLocalQueryTarget(a,t);let c;return r&&(c=await Wq(n,e,a,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&cO(n.remoteStore,i),c}async function Wq(n,e,t,r,i){n.pu=(p,m,b)=>(async function(w,S,T,C){let R=S.view.ru(T);R.Cs&&(R=await gR(w.localStore,S.query,!1).then((({documents:A})=>S.view.ru(A,R))));const O=C&&C.targetChanges.get(S.targetId),P=C&&C.targetMismatches.get(S.targetId)!=null,N=S.view.applyChanges(R,w.isPrimaryClient,O,P);return TR(w,S.targetId,N.au),N.snapshot})(n,p,m,b);const a=await gR(n.localStore,e,!0),o=new qq(e,a.Qs),c=o.ru(a.documents),u=Np.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=o.applyChanges(c,n.isPrimaryClient,u);TR(n,t,d.au);const h=new $q(e,t,o);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),d.snapshot}async function Qq(n,e,t){const r=st(n),i=r.Tu.get(e),a=r.Iu.get(i.targetId);if(a.length>1)return r.Iu.set(i.targetId,a.filter((o=>!Vv(o,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await a_(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Zw(r.remoteStore,i.targetId),l_(r,i.targetId)})).catch(Pc)):(l_(r,i.targetId),await a_(r.localStore,i.targetId,!0))}async function Zq(n,e){const t=st(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Zw(t.remoteStore,r.targetId))}async function Jq(n,e,t){const r=EO(n);try{const i=await(function(o,c){const u=st(o),d=pt.now(),h=c.reduce(((b,_)=>b.add(_.key)),gt());let p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",(b=>{let _=si(),w=gt();return u.Ns.getEntries(b,h).next((S=>{_=S,_.forEach(((T,C)=>{C.isValidDocument()||(w=w.add(T))}))})).next((()=>u.localDocuments.getOverlayedDocuments(b,_))).next((S=>{p=S;const T=[];for(const C of c){const R=pG(C,p.get(C.key).overlayedDocument);R!=null&&T.push(new Bs(C.key,R,aP(R.value.mapValue),Kn.exists(!0)))}return u.mutationQueue.addMutationBatch(b,d,T,c)})).next((S=>{m=S;const T=S.applyToLocalDocumentSet(p,w);return u.documentOverlayCache.saveOverlays(b,S.batchId,T)}))})).then((()=>({batchId:m.batchId,changes:vP(p)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,c,u){let d=o.Vu[o.currentUser.toKey()];d||(d=new an(it)),d=d.insert(c,u),o.Vu[o.currentUser.toKey()]=d})(r,i.batchId,t),await Op(r,i.changes),await Pp(r.remoteStore)}catch(i){const a=rE(i,"Failed to persist write");t.reject(a)}}async function yO(n,e){const t=st(n);try{const r=await fq(t.localStore,e);e.targetChanges.forEach(((i,a)=>{const o=t.Au.get(a);o&&(Ge(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?Ge(o.hu,14607):i.removedDocuments.size>0&&(Ge(o.hu,42227),o.hu=!1))})),await Op(t,r,e)}catch(r){await Pc(r)}}function SR(n,e,t){const r=st(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((a,o)=>{const c=o.view.va(e);c.snapshot&&i.push(c.snapshot)})),(function(o,c){const u=st(o);u.onlineState=c;let d=!1;u.queries.forEach(((h,p)=>{for(const m of p.Sa)m.va(c)&&(d=!0)})),d&&sE(u)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function e$(n,e,t){const r=st(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),a=i&&i.key;if(a){let o=new an(ke.comparator);o=o.insert(a,yn.newNoDocument(a,Xe.min()));const c=gt().add(a),u=new Bv(Xe.min(),new Map,new an(it),o,c);await yO(r,u),r.du=r.du.remove(a),r.Au.delete(e),cE(r)}else await a_(r.localStore,e,!1).then((()=>l_(r,e,t))).catch(Pc)}async function t$(n,e){const t=st(n),r=e.batch.batchId;try{const i=await dq(t.localStore,e);xO(t,r,null),bO(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Op(t,i)}catch(i){await Pc(i)}}async function n$(n,e,t){const r=st(n);try{const i=await(function(o,c){const u=st(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let h;return u.mutationQueue.lookupMutationBatch(d,c).next((p=>(Ge(p!==null,37113),h=p.keys(),u.mutationQueue.removeMutationBatch(d,p)))).next((()=>u.mutationQueue.performConsistencyCheck(d))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(d,h,c))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h))).next((()=>u.localDocuments.getDocuments(d,h)))}))})(r.localStore,e);xO(r,e,t),bO(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Op(r,i)}catch(i){await Pc(i)}}function bO(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function xO(n,e,t){const r=st(n);let i=r.Vu[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function l_(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||_O(n,r)}))}function _O(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Zw(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),cE(n))}function TR(n,e,t){for(const r of t)r instanceof gO?(n.Ru.addReference(r.key,e),r$(n,r)):r instanceof mO?(Ae(lE,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||_O(n,r.key)):Ve(19791,{wu:r})}function r$(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(Ae(lE,"New document in limbo: "+t),n.Eu.add(r),cE(n))}function cE(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new ke(Pt.fromString(e)),r=n.fu.next();n.Au.set(r,new Hq(t)),n.du=n.du.insert(t,r),cO(n.remoteStore,new _s(Di(Rp(t.path)),r,"TargetPurposeLimboResolution",Ii.ce))}}async function Op(n,e,t){const r=st(n),i=[],a=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,u)=>{o.push(r.pu(u,e,t).then((d=>{if((d||t)&&r.isPrimaryClient){const h=d?!d.fromCache:t?.targetChanges.get(u.targetId)?.current;r.sharedClientState.updateQueryState(u.targetId,h?"current":"not-current")}if(d){i.push(d);const h=Ww.As(u.targetId,d);a.push(h)}})))})),await Promise.all(o),r.Pu.H_(i),await(async function(u,d){const h=st(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>ae.forEach(d,(m=>ae.forEach(m.Es,(b=>h.persistence.referenceDelegate.addReference(p,m.targetId,b))).next((()=>ae.forEach(m.ds,(b=>h.persistence.referenceDelegate.removeReference(p,m.targetId,b)))))))))}catch(p){if(!ol(p))throw p;Ae(Qw,"Failed to update sequence numbers: "+p)}for(const p of d){const m=p.targetId;if(!p.fromCache){const b=h.Ms.get(m),_=b.snapshotVersion,w=b.withLastLimboFreeSnapshotVersion(_);h.Ms=h.Ms.insert(m,w)}}})(r.localStore,a))}async function i$(n,e){const t=st(n);if(!t.currentUser.isEqual(e)){Ae(lE,"User change. New user:",e.toKey());const r=await iO(t.localStore,e);t.currentUser=e,(function(a,o){a.mu.forEach((c=>{c.forEach((u=>{u.reject(new Re(me.CANCELLED,o))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Op(t,r.Ls)}}function a$(n,e){const t=st(n),r=t.Au.get(e);if(r&&r.hu)return gt().add(r.key);{let i=gt();const a=t.Iu.get(e);if(!a)return i;for(const o of a){const c=t.Tu.get(o);i=i.unionWith(c.view.nu)}return i}}function wO(n){const e=st(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=yO.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=a$.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=e$.bind(null,e),e.Pu.H_=Fq.bind(null,e.eventManager),e.Pu.yu=Gq.bind(null,e.eventManager),e}function EO(n){const e=st(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=t$.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=n$.bind(null,e),e}class tp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=qv(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return rO(this.persistence,new nO,e.initialUser,this.serializer)}Cu(e){return new Kw(Gv.mi,this.serializer)}Du(e){return new sO}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}tp.provider={build:()=>new tp};class s$ extends tp{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ge(this.persistence.referenceDelegate instanceof X0,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new QP(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?pr.withCacheSize(this.cacheSizeBytes):pr.DEFAULT;return new Kw((r=>X0.mi(r,t)),this.serializer)}}class o$ extends tp{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await EO(this.xu.syncEngine),await Pp(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return rO(this.persistence,new nO,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new QP(r,e.asyncQueue,t)}Mu(e,t){const r=new h7(t,this.persistence);return new f7(e.asyncQueue,r)}Cu(e){const t=oq(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?pr.withCacheSize(this.cacheSizeBytes):pr.DEFAULT;return new Xw(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,wq(),p0(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new sO}}class Q0{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>SR(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=i$.bind(null,this.syncEngine),await Lq(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Uq})()}createDatastore(e){const t=qv(e.databaseInfo.databaseId),r=(function(a){return new _q(a)})(e.databaseInfo);return(function(a,o,c,u){return new Aq(a,o,c,u)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,a,o,c){return new Iq(r,i,a,o,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>SR(this.syncEngine,t,0)),(function(){return yR.v()?new yR:new vq})())}createSyncEngine(e,t){return(function(i,a,o,c,u,d,h){const p=new Yq(i,a,o,c,u,d);return h&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=st(t);Ae(Cc,"RemoteStore shutting down."),r.Ea.add(5),await Mp(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Q0.provider={build:()=>new Q0};class uE{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Cr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Zo="FirestoreClient";class l${constructor(e,t,r,i,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=lr.UNAUTHENTICATED,this.clientId=Iw.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,(async o=>{Ae(Zo,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(Ae(Zo,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new za;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=rE(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Lx(n,e){n.asyncQueue.verifyOperationInProgress(),Ae(Zo,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await iO(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function AR(n,e){n.asyncQueue.verifyOperationInProgress();const t=await c$(n);Ae(Zo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>xR(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>xR(e.remoteStore,i))),n._onlineComponents=e}async function c$(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ae(Zo,"Using user provided OfflineComponentProvider");try{await Lx(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===me.FAILED_PRECONDITION||i.code===me.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;xc("Error using user provided cache. Falling back to memory cache: "+t),await Lx(n,new tp)}}else Ae(Zo,"Using default OfflineComponentProvider"),await Lx(n,new s$(void 0));return n._offlineComponents}async function SO(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ae(Zo,"Using user provided OnlineComponentProvider"),await AR(n,n._uninitializedComponentsProvider._online)):(Ae(Zo,"Using default OnlineComponentProvider"),await AR(n,new Q0))),n._onlineComponents}function u$(n){return SO(n).then((e=>e.syncEngine))}async function Z0(n){const e=await SO(n),t=e.eventManager;return t.onListen=Kq.bind(null,e.syncEngine),t.onUnlisten=Qq.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Xq.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Zq.bind(null,e.syncEngine),t}function d$(n,e,t={}){const r=new za;return n.asyncQueue.enqueueAndForget((async()=>(function(a,o,c,u,d){const h=new uE({next:m=>{h.Nu(),o.enqueueAndForget((()=>aE(a,p)));const b=m.docs.has(c);!b&&m.fromCache?d.reject(new Re(me.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&m.fromCache&&u&&u.source==="server"?d.reject(new Re(me.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new oE(Rp(c.path),h,{includeMetadataChanges:!0,qa:!0});return iE(a,p)})(await Z0(n),n.asyncQueue,e,t,r))),r.promise}function f$(n,e,t={}){const r=new za;return n.asyncQueue.enqueueAndForget((async()=>(function(a,o,c,u,d){const h=new uE({next:m=>{h.Nu(),o.enqueueAndForget((()=>aE(a,p))),m.fromCache&&u.source==="server"?d.reject(new Re(me.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new oE(c,h,{includeMetadataChanges:!0,qa:!0});return iE(a,p)})(await Z0(n),n.asyncQueue,e,t,r))),r.promise}function TO(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const CR=new Map;const AO="firestore.googleapis.com",IR=!0;class RR{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Re(me.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=AO,this.ssl=IR}else this.host=e.host,this.ssl=e.ssl??IR;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=YP;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<qG)throw new Re(me.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}l7("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=TO(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Re(me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Re(me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Re(me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Hv{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new RR({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Re(me.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Re(me.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new RR(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new ZF;switch(r.type){case"firstParty":return new n7(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Re(me.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=CR.get(t);r&&(Ae("ComponentProvider","Removing Datastore"),CR.delete(t),r.terminate())})(this),Promise.resolve()}}function h$(n,e,t,r={}){n=vr(n,Hv);const i=Dd(e),a=n._getSettings(),o={...a,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;i&&(kN(`https://${c}`),NN("Firestore",!0)),a.host!==AO&&a.host!==c&&xc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...a,host:c,ssl:i,emulatorOptions:r};if(!Ko(u,o)&&(n._setSettings(u),r.mockUserToken)){let d,h;if(typeof r.mockUserToken=="string")d=r.mockUserToken,h=lr.MOCK_USER;else{d=iB(r.mockUserToken,n._app?.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new Re(me.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new lr(p)}n._authCredentials=new JF(new NM(d,h))}}class Us{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Us(this.firestore,e,this._query)}}class bn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ho(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new bn(this.firestore,e,this._key)}toJSON(){return{type:bn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Ap(t,bn._jsonSchema))return new bn(e,r||null,new ke(Pt.fromString(t.referencePath)))}}bn._jsonSchemaVersion="firestore/documentReference/1.0",bn._jsonSchema={type:Bn("string",bn._jsonSchemaVersion),referencePath:Bn("string")};class Ho extends Us{constructor(e,t,r){super(e,t,Rp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new bn(this.firestore,null,new ke(e))}withConverter(e){return new Ho(this.firestore,e,this._path)}}function Sr(n,e,...t){if(n=Jt(n),PM("collection","path",e),n instanceof Hv){const r=Pt.fromString(e,...t);return bI(r),new Ho(n,null,r)}{if(!(n instanceof bn||n instanceof Ho))throw new Re(me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Pt.fromString(e,...t));return bI(r),new Ho(n.firestore,null,r)}}function St(n,e,...t){if(n=Jt(n),arguments.length===1&&(e=Iw.newId()),PM("doc","path",e),n instanceof Hv){const r=Pt.fromString(e,...t);return yI(r),new bn(n,null,new ke(r))}{if(!(n instanceof bn||n instanceof Ho))throw new Re(me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Pt.fromString(e,...t));return yI(r),new bn(n.firestore,n instanceof Ho?n.converter:null,new ke(r))}}const DR="AsyncQueue";class kR{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new oO(this,"async_queue_retry"),this._c=()=>{const r=p0();r&&Ae(DR,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=p0();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=p0();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new za;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ol(e))throw e;Ae(DR,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Cr("INTERNAL UNHANDLED ERROR: ",NR(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=nE.createAndSchedule(this,e,t,r,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&Ve(47125,{Pc:NR(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function NR(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function MR(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const a of r)if(a in i&&typeof i[a]=="function")return!0;return!1})(n,["next","error","complete"])}class aa extends Hv{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new kR,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new kR(e),this._firestoreClient=void 0,await e}}}function p$(n,e){const t=typeof n=="object"?n:BN(),r=typeof n=="string"?n:B0,i=yw(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const a=nB("firestore");a&&h$(i,...a)}return i}function jp(n){if(n._terminated)throw new Re(me.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||CO(n),n._firestoreClient}function CO(n){const e=n._freezeSettings(),t=(function(i,a,o,c){return new F7(i,a,o,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,TO(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new l$(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}})(n._componentsProvider))}function g$(n,e){xc("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return m$(n,Q0.provider,{build:r=>new o$(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function m$(n,e,t){if((n=vr(n,aa))._firestoreClient||n._terminated)throw new Re(me.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Re(me.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},CO(n)}class Ci{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ci(Un.fromBase64String(e))}catch(t){throw new Re(me.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ci(Un.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ci._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ap(e,Ci._jsonSchema))return Ci.fromBase64String(e.bytes)}}Ci._jsonSchemaVersion="firestore/bytes/1.0",Ci._jsonSchema={type:Bn("string",Ci._jsonSchemaVersion),bytes:Bn("string")};class Vp{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Re(me.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Yv{constructor(e){this._methodName=e}}class La{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Re(me.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Re(me.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return it(this._lat,e._lat)||it(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:La._jsonSchemaVersion}}static fromJSON(e){if(Ap(e,La._jsonSchema))return new La(e.latitude,e.longitude)}}La._jsonSchemaVersion="firestore/geoPoint/1.0",La._jsonSchema={type:Bn("string",La._jsonSchemaVersion),latitude:Bn("number"),longitude:Bn("number")};class Ba{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ba._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ap(e,Ba._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Ba(e.vectorValues);throw new Re(me.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ba._jsonSchemaVersion="firestore/vectorValue/1.0",Ba._jsonSchema={type:Bn("string",Ba._jsonSchemaVersion),vectorValues:Bn("object")};const v$=/^__.*__$/;class y${constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Bs(e,this.data,this.fieldMask,t,this.fieldTransforms):new Pd(e,this.data,t,this.fieldTransforms)}}class IO{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Bs(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function RO(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ve(40011,{Ac:n})}}class Kv{constructor(e,t,r,i,a,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Kv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return J0(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(RO(this.Ac)&&v$.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class b${constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||qv(e)}Cc(e,t,r,i=!1){return new Kv({Ac:e,methodName:t,Dc:r,path:dn.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zp(n){const e=n._freezeSettings(),t=qv(n._databaseId);return new b$(n._databaseId,!!e.ignoreUndefinedProperties,t)}function dE(n,e,t,r,i,a={}){const o=n.Cc(a.merge||a.mergeFields?2:0,e,t,i);hE("Data must be an object, but it was:",o,r);const c=NO(r,o);let u,d;if(a.merge)u=new Br(o.fieldMask),d=o.fieldTransforms;else if(a.mergeFields){const h=[];for(const p of a.mergeFields){const m=c_(e,p,t);if(!o.contains(m))throw new Re(me.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);PO(h,m)||h.push(m)}u=new Br(h),d=o.fieldTransforms.filter((p=>u.covers(p.field)))}else u=null,d=o.fieldTransforms;return new y$(new gr(c),u,d)}class Lp extends Yv{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Lp}}function x$(n,e,t){return new Kv({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class fE extends Yv{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=x$(this,e,!0),r=this.vc.map((a=>jd(a,t))),i=new Ec(r);return new SP(e.path,i)}isEqual(e){return e instanceof fE&&Ko(this.vc,e.vc)}}function DO(n,e,t,r){const i=n.Cc(1,e,t);hE("Data must be an object, but it was:",i,r);const a=[],o=gr.empty();ll(r,((u,d)=>{const h=pE(e,u,t);d=Jt(d);const p=i.yc(h);if(d instanceof Lp)a.push(h);else{const m=jd(d,p);m!=null&&(a.push(h),o.set(h,m))}}));const c=new Br(a);return new IO(o,c,i.fieldTransforms)}function kO(n,e,t,r,i,a){const o=n.Cc(1,e,t),c=[c_(e,r,t)],u=[i];if(a.length%2!=0)throw new Re(me.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<a.length;m+=2)c.push(c_(e,a[m])),u.push(a[m+1]);const d=[],h=gr.empty();for(let m=c.length-1;m>=0;--m)if(!PO(d,c[m])){const b=c[m];let _=u[m];_=Jt(_);const w=o.yc(b);if(_ instanceof Lp)d.push(b);else{const S=jd(_,w);S!=null&&(d.push(b),h.set(b,S))}}const p=new Br(d);return new IO(h,p,o.fieldTransforms)}function _$(n,e,t,r=!1){return jd(t,n.Cc(r?4:3,e))}function jd(n,e){if(MO(n=Jt(n)))return hE("Unsupported field value:",e,n),NO(n,e);if(n instanceof Yv)return(function(r,i){if(!RO(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(i);a&&i.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const a=[];let o=0;for(const c of r){let u=jd(c,i.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),o++}return{arrayValue:{values:a}}})(n,e)}return(function(r,i){if((r=Jt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return lG(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=pt.fromDate(r);return{timestampValue:md(i.serializer,a)}}if(r instanceof pt){const a=new pt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:md(i.serializer,a)}}if(r instanceof La)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ci)return{bytesValue:kP(i.serializer,r._byteString)};if(r instanceof bn){const a=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(a))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:qw(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Ba)return(function(o,c){return{mapValue:{fields:{[jw]:{stringValue:Vw},[dd]:{arrayValue:{values:o.toArray().map((d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return Lw(c.serializer,d)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${Rv(r)}`)})(n,e)}function NO(n,e){const t={};return WM(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ll(n,((r,i)=>{const a=jd(i,e.mc(r));a!=null&&(t[r]=a)})),{mapValue:{fields:t}}}function MO(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof pt||n instanceof La||n instanceof Ci||n instanceof bn||n instanceof Yv||n instanceof Ba)}function hE(n,e,t){if(!MO(t)||!OM(t)){const r=Rv(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function c_(n,e,t){if((e=Jt(e))instanceof Vp)return e._internalPath;if(typeof e=="string")return pE(n,e);throw J0("Field path arguments must be of type string or ",n,!1,void 0,t)}const w$=new RegExp("[~\\*/\\[\\]]");function pE(n,e,t){if(e.search(w$)>=0)throw J0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Vp(...e.split("."))._internalPath}catch{throw J0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function J0(n,e,t,r,i){const a=r&&!r.isEmpty(),o=i!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(a||o)&&(u+=" (found",a&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new Re(me.INVALID_ARGUMENT,c+n+u)}function PO(n,e){return n.some((t=>t.isEqual(e)))}class OO{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new bn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new E$(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Xv("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class E$ extends OO{data(){return super.data()}}function Xv(n,e){return typeof e=="string"?pE(n,e):e instanceof Vp?e._internalPath:e._delegate._internalPath}function jO(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Re(me.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class gE{}class mE extends gE{}function sa(n,e,...t){let r=[];e instanceof gE&&r.push(e),r=r.concat(t),(function(a){const o=a.filter((u=>u instanceof vE)).length,c=a.filter((u=>u instanceof Wv)).length;if(o>1||o>0&&c>0)throw new Re(me.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class Wv extends mE{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Wv(e,t,r)}_apply(e){const t=this._parse(e);return VO(e._query,t),new Us(e.firestore,e.converter,Q1(e._query,t))}_parse(e){const t=zp(e.firestore);return(function(a,o,c,u,d,h,p){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Re(me.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){jR(p,h);const _=[];for(const w of p)_.push(OR(u,a,w));m={arrayValue:{values:_}}}else m=OR(u,a,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||jR(p,h),m=_$(c,o,p,h==="in"||h==="not-in");return wt.create(d,h,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function S$(n,e,t){const r=e,i=Xv("where",n);return Wv._create(i,r,t)}class vE extends gE{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new vE(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Lt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,a){let o=i;const c=a.getFlattenedFilters();for(const u of c)VO(o,u),o=Q1(o,u)})(e._query,t),new Us(e.firestore,e.converter,Q1(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class yE extends mE{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new yE(e,t)}_apply(e){const t=(function(i,a,o){if(i.startAt!==null)throw new Re(me.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Re(me.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Zh(a,o)})(e._query,this._field,this._direction);return new Us(e.firestore,e.converter,(function(i,a){const o=i.explicitOrderBy.concat([a]);return new Md(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}}function Jo(n,e="asc"){const t=e,r=Xv("orderBy",n);return yE._create(r,t)}class bE extends mE{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new bE(e,t,r)}_apply(e){return new Us(e.firestore,e.converter,G0(e._query,this._limit,this._limitType))}}function PR(n){return bE._create("limit",n,"F")}function OR(n,e,t){if(typeof(t=Jt(t))=="string"){if(t==="")throw new Re(me.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!hP(e)&&t.indexOf("/")!==-1)throw new Re(me.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Pt.fromString(t));if(!ke.isDocumentKey(r))throw new Re(me.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Wh(n,new ke(r))}if(t instanceof bn)return Wh(n,t._key);throw new Re(me.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Rv(t)}.`)}function jR(n,e){if(!Array.isArray(n)||n.length===0)throw new Re(me.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function VO(n,e){const t=(function(i,a){for(const o of i)for(const c of o.getFlattenedFilters())if(a.indexOf(c.op)>=0)return c.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Re(me.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Re(me.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class T${convertValue(e,t="none"){switch(Xo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ns(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ve(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return ll(e,((i,a)=>{r[i]=this.convertValue(a,t)})),r}convertVectorValue(e){const t=e.fields?.[dd].arrayValue?.values?.map((r=>nn(r.doubleValue)));return new Ba(t)}convertGeoPoint(e){return new La(nn(e.latitude),nn(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Ov(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Kh(e));default:return null}}convertTimestamp(e){const t=ks(e);return new pt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Pt.fromString(e);Ge(UP(r),9688,{name:e});const i=new _c(r.get(1),r.get(3)),a=new ke(r.popFirst(5));return i.isEqual(t)||Cr(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function xE(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class ch{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class dc extends OO{constructor(e,t,r,i,a,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new g0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Xv("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Re(me.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=dc._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}dc._jsonSchemaVersion="firestore/documentSnapshot/1.0",dc._jsonSchema={type:Bn("string",dc._jsonSchemaVersion),bundleSource:Bn("string","DocumentSnapshot"),bundleName:Bn("string"),bundle:Bn("string")};class g0 extends dc{data(e={}){return super.data(e)}}class fc{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new ch(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new g0(this._firestore,this._userDataWriter,r.key,r,new ch(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Re(me.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((c=>{const u=new g0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new ch(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((c=>a||c.type!==3)).map((c=>{const u=new g0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new ch(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),h=o.indexOf(c.doc.key)),{type:A$(c.type),doc:u,oldIndex:d,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Re(me.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=fc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Iw.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function A$(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ve(61501,{type:n})}}function Bx(n){n=vr(n,bn);const e=vr(n.firestore,aa);return d$(jp(e),n._key).then((t=>zO(e,n,t)))}fc._jsonSchemaVersion="firestore/querySnapshot/1.0",fc._jsonSchema={type:Bn("string",fc._jsonSchemaVersion),bundleSource:Bn("string","QuerySnapshot"),bundleName:Bn("string"),bundle:Bn("string")};class _E extends T${constructor(e){super(),this.firestore=e}convertBytes(e){return new Ci(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new bn(this.firestore,null,t)}}function Qi(n){n=vr(n,Us);const e=vr(n.firestore,aa),t=jp(e),r=new _E(e);return jO(n._query),f$(t,n._query).then((i=>new fc(e,r,n,i)))}function ai(n,e,t){n=vr(n,bn);const r=vr(n.firestore,aa),i=xE(n.converter,e,t);return Bp(r,[dE(zp(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Kn.none())])}function ka(n,e,t,...r){n=vr(n,bn);const i=vr(n.firestore,aa),a=zp(i);let o;return o=typeof(e=Jt(e))=="string"||e instanceof Vp?kO(a,"updateDoc",n._key,e,t,r):DO(a,"updateDoc",n._key,e),Bp(i,[o.toMutation(n._key,Kn.exists(!0))])}function Zi(n){return Bp(vr(n.firestore,aa),[new kp(n._key,Kn.none())])}function Qv(n,e){const t=vr(n.firestore,aa),r=St(n),i=xE(n.converter,e);return Bp(t,[dE(zp(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Kn.exists(!1))]).then((()=>r))}function Vd(n,...e){n=Jt(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||MR(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(MR(e[r])){const u=e[r];e[r]=u.next?.bind(u),e[r+1]=u.error?.bind(u),e[r+2]=u.complete?.bind(u)}let a,o,c;if(n instanceof bn)o=vr(n.firestore,aa),c=Rp(n._key.path),a={next:u=>{e[r]&&e[r](zO(o,n,u))},error:e[r+1],complete:e[r+2]};else{const u=vr(n,Us);o=vr(u.firestore,aa),c=u._query;const d=new _E(o);a={next:h=>{e[r]&&e[r](new fc(o,d,u,h))},error:e[r+1],complete:e[r+2]},jO(n._query)}return(function(d,h,p,m){const b=new uE(m),_=new oE(h,b,p);return d.asyncQueue.enqueueAndForget((async()=>iE(await Z0(d),_))),()=>{b.Nu(),d.asyncQueue.enqueueAndForget((async()=>aE(await Z0(d),_)))}})(jp(o),c,i,a)}function Bp(n,e){return(function(r,i){const a=new za;return r.asyncQueue.enqueueAndForget((async()=>Jq(await u$(r),i,a))),a.promise})(jp(n),e)}function zO(n,e,t){const r=t.docs.get(e._key),i=new _E(n);return new dc(n,i,e._key,r,new ch(t.hasPendingWrites,t.fromCache),e.converter)}class C${constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=zp(e)}set(e,t,r){this._verifyNotCommitted();const i=Ux(e,this._firestore),a=xE(i.converter,t,r),o=dE(this._dataReader,"WriteBatch.set",i._key,a,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Kn.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const a=Ux(e,this._firestore);let o;return o=typeof(t=Jt(t))=="string"||t instanceof Vp?kO(this._dataReader,"WriteBatch.update",a._key,t,r,i):DO(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(o.toMutation(a._key,Kn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Ux(e,this._firestore);return this._mutations=this._mutations.concat(new kp(t._key,Kn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Re(me.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Ux(n,e){if((n=Jt(n)).firestore!==e)throw new Re(me.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function VR(){return new Lp("deleteField")}function I$(...n){return new fE("arrayUnion",n)}function LO(n){return jp(n=vr(n,aa)),new C$(n,(e=>Bp(n,e)))}(function(e,t=!0){(function(i){Nd=i})(kd),id(new mc("firestore",((r,{instanceIdentifier:i,options:a})=>{const o=r.getProvider("app").getImmediate(),c=new aa(new e7(r.getProvider("auth-internal")),new r7(o,r.getProvider("app-check-internal")),(function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Re(me.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new _c(d.options.projectId,h)})(o,i),o);return a={useFetchStreams:t,...a},c._setSettings(a),c}),"PUBLIC").setMultipleInstances(!0)),Go(pI,gI,e),Go(pI,gI,"esm2020")})();const R$={apiKey:"AIzaSyCRHcpbVGQrEZUVdO_Ucn4ZarwwPsrON40",authDomain:"personal-budget-pwa-5defb.firebaseapp.com",projectId:"personal-budget-pwa-5defb",storageBucket:"personal-budget-pwa-5defb.firebasestorage.app",messagingSenderId:"137454342284",appId:"1:137454342284:web:ab8b52955e6f0ffd42aba9",measurementId:"G-BCLXBQHT9L"},BO=LN(R$),Bl=KF(BO),tt=p$(BO);g$(tt).catch(n=>{n.code==="failed-precondition"?console.warn(" Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"?console.warn(" Offline persistence not available in this browser"):console.error(" Failed to enable offline persistence:",n)});const zR=()=>({url:window.location.origin+"/personal-budget-pwa/",handleCodeInApp:!1}),Fx=n=>({id:n.uid,username:n.email||n.uid,displayName:n.displayName||n.email?.split("@")[0]||"User",email:n.email||void 0}),ea=gw()(EN(n=>({currentUser:null,isAuthenticated:!1,loginError:null,isLoading:!1,isInitialized:!1,isInitializing:!0,lastAuthTime:null,offlineGracePeriod:10080*60*1e3,lastVerificationEmailSent:null,login:async(e,t)=>{n({isLoading:!0,loginError:null});try{const i=(await DU(Bl,e,t)).user,a=Fx(i);return n({currentUser:a,isAuthenticated:!0,isLoading:!1,loginError:null,lastAuthTime:Date.now()}),console.log(` User logged in: ${a.email}`),!0}catch(r){console.error("Login error:",r),console.error("Error code:",r.code),console.error("Error message:",r.message);let i="Login failed. Please try again.";if(r.code)switch(r.code){case"auth/invalid-email":i="Invalid email address.";break;case"auth/user-disabled":i="This account has been disabled.";break;case"auth/user-not-found":i="No account found with this email.";break;case"auth/wrong-password":i="Incorrect password.";break;case"auth/too-many-requests":i="Too many failed attempts. Please try again later.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break;case"auth/invalid-credential":i="Invalid email or password.";break;default:console.warn(`Unhandled Firebase error code: ${r.code}`),i="Authentication failed. Please try again.";break}else console.warn("Non-Firebase error in login:",r),i="An unexpected error occurred. Please try again.";return n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:i}),!1}},register:async(e,t,r)=>{n({isLoading:!0,loginError:null});try{const a=(await RU(Bl,e,t)).user;await NU(a,{displayName:r}),await rI(a,zR());const o=Fx(a);return n({currentUser:o,isAuthenticated:!1,isLoading:!1,loginError:null,lastVerificationEmailSent:Date.now()}),console.log(` User registered: ${o.email}, verification email sent`),!0}catch(i){console.error("Registration error:",i);let a="Registration failed. Please try again.";switch(i.code){case"auth/email-already-in-use":a="An account with this email already exists.";break;case"auth/invalid-email":a="Invalid email address.";break;case"auth/weak-password":a="Password should be at least 6 characters.";break;case"auth/operation-not-allowed":a="Email/password accounts are not enabled.";break}return n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:a}),!1}},logout:async()=>{try{await jU(Bl),console.log(" User logged out")}catch(e){console.error("Logout error:",e)}},clearError:()=>{n({loginError:null})},sendPasswordReset:async e=>{n({isLoading:!0,loginError:null});try{return await IU(Bl,e),n({isLoading:!1}),!0}catch(t){console.error("Password reset error:",t);let r="Failed to send password reset email. Please try again.";switch(t.code){case"auth/user-not-found":r="No account found with this email.";break;case"auth/invalid-email":r="Invalid email address.";break;case"auth/too-many-requests":r="Too many attempts. Please try again later.";break}return n({isLoading:!1,loginError:r}),!1}},sendEmailVerification:async()=>{const e=Bl.currentUser;if(!e)return n({loginError:"No user is currently signed in."}),!1;n({isLoading:!0,loginError:null});try{return await rI(e,zR()),n({isLoading:!1,lastVerificationEmailSent:Date.now()}),console.log(` Verification email sent to: ${e.email}`),!0}catch(t){console.error("Email verification error:",t);let r="Failed to send verification email. Please try again.";switch(t.code){case"auth/too-many-requests":r="Too many verification emails sent. Please wait before trying again.";break}return n({isLoading:!1,loginError:r}),!1}},resendEmailVerification:async()=>{const e=ea.getState();if(e.lastVerificationEmailSent){const t=Date.now()-e.lastVerificationEmailSent,r=60*1e3;if(t<r){const i=Math.ceil((r-t)/1e3);return n({loginError:`Please wait ${i} seconds before requesting another verification email.`}),!1}}return e.sendEmailVerification()},deleteAccount:async e=>{const t=Bl.currentUser;if(!t||!t.email)return n({loginError:"No user is currently signed in."}),!1;n({isLoading:!0,loginError:null});try{const r=Mc.credential(t.email,e);return await AU(t,r),await VU(t),n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:null,lastAuthTime:null}),console.log(` Account permanently deleted: ${t.email}`),!0}catch(r){console.error("Account deletion error:",r);let i="Failed to delete account. Please try again.";switch(r.code){case"auth/requires-recent-login":i="For security, please log out and log back in before deleting your account.";break;case"auth/wrong-password":i="Incorrect password. Please enter your current password.";break;case"auth/too-many-requests":i="Too many deletion attempts. Please wait before trying again.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break}return n({isLoading:!1,loginError:i}),!1}},initializeAuth:()=>ea.getState().isInitialized?()=>{}:(n({isInitialized:!1}),OU(Bl,r=>{const i=Date.now(),a=ea.getState(),o=r?Fx(r):null,c=a.lastAuthTime&&i-a.lastAuthTime<a.offlineGracePeriod,d=typeof navigator<"u"&&!navigator.onLine&&a.isAuthenticated&&c&&!o,h=!0,p=r&&h||!!d,m=r?o:d?a.currentUser:null;n({currentUser:m,isAuthenticated:p,isInitialized:!0,isLoading:!1,loginError:null,lastAuthTime:r&&h?i:a.lastAuthTime}),m?console.log(` Auth state: User is signed in (${m.email})`,d?"(offline grace period)":"(verified)"):console.log(" Auth state: User is signed out")}))}),{name:"auth-storage",partialize:n=>({isAuthenticated:n.isAuthenticated,currentUser:n.currentUser,lastAuthTime:n.lastAuthTime,offlineGracePeriod:n.offlineGracePeriod,lastVerificationEmailSent:n.lastVerificationEmailSent})})),zt=Object.freeze(Object.defineProperty({__proto__:null,useAuthStore:ea},Symbol.toStringTag,{value:"Module"})),UO=[{id:"length",label:"Minimum 12 characters",regex:/^.{12,}$/},{id:"uppercase",label:"At least one uppercase letter (A-Z)",regex:/[A-Z]/},{id:"lowercase",label:"At least one lowercase letter (a-z)",regex:/[a-z]/},{id:"number",label:"At least one number (0-9)",regex:/\d/},{id:"special",label:"At least one special character (!@#$%^&*)",regex:/[!@#$%^&*]/}],D$=n=>{if(!n)return{score:0,level:"weak",color:"text-gray-400",label:"Enter password"};const r=UO.map(c=>({...c,met:c.regex.test(n)})).filter(c=>c.met).length;let i,a,o;return r<=1?(i="weak",a="text-red-500",o="Weak"):r<=3?(i="medium",a="text-yellow-500",o="Medium"):r===4?(i="strong",a="text-blue-500",o="Strong"):(i="very-strong",a="text-green-500",o="Very Strong"),{score:r,level:i,color:a,label:o}},wE=n=>{const e=UO.map(i=>({...i,met:i.regex.test(n)})),t=D$(n),r=e.every(i=>i.met);return{requirements:e,strength:t,isValid:r,isEmpty:!n.trim()}},k$=({password:n,className:e=""})=>{const{strength:t,isEmpty:r}=wE(n);return r?null:v.jsxs("div",{className:`flex items-center gap-2 ${e}`,children:[v.jsx("div",{className:"flex-1",children:v.jsx("div",{className:"flex gap-1",children:[1,2,3,4].map(i=>v.jsx("div",{className:`h-1 flex-1 rounded-full ${i<=t.score?t.score<=1?"bg-red-500":t.score<=3?"bg-yellow-500":t.score===4?"bg-blue-500":"bg-green-500":"bg-gray-200 dark:bg-gray-700"}`},i))})}),v.jsx("span",{className:`text-sm font-medium ${t.color}`,children:t.label})]})},N$=({password:n,className:e=""})=>{const{requirements:t,isEmpty:r}=wE(n);return r?null:v.jsx("div",{className:`space-y-1 ${e}`,children:t.map(i=>v.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.met?v.jsx(RL,{className:"h-4 w-4 text-green-500 flex-shrink-0"}):v.jsx(Sv,{className:"h-4 w-4 text-red-500 flex-shrink-0"}),v.jsx("span",{className:i.met?"text-green-700 dark:text-green-300":"text-gray-600 dark:text-gray-400",children:i.label})]},i.id))})},M$=()=>{const[n,e]=U.useState(""),[t,r]=U.useState(""),[i,a]=U.useState(""),[o,c]=U.useState(!1),[u,d]=U.useState(!1),[h,p]=U.useState(!1),[m,b]=U.useState(!1),{login:_,register:w,sendPasswordReset:S,isLoading:T,loginError:C,clearError:R}=ea(),O=wE(t),P=async A=>{if(A.preventDefault(),R(),n.trim()&&t.trim())if(u){if(!i.trim()||!O.isValid)return;await w(n.trim(),t,i.trim())}else await _(n.trim(),t)},N=async A=>{A.preventDefault(),n.trim()&&await S(n.trim())&&b(!0)};return U.useEffect(()=>{e(""),r(""),a(""),b(!1)},[u,h]),v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsxs("div",{className:"flex flex-col items-center gap-3 mb-2",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"Personal Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"Personal Budget"})]}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Simple envelope budgeting for personal finance"})]})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:h?v.jsxs("form",{onSubmit:N,className:"space-y-6",children:[v.jsxs("div",{className:"text-center mb-2",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Reset Password"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Enter your email and we'll send you a link to reset your password."})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"reset-email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(R1,{className:"h-5 w-5 text-gray-400"})}),v.jsx("input",{id:"reset-email",type:"email",value:n,onChange:A=>e(A.target.value),className:"w-full pl-10 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"email"})]})]}),m?v.jsxs("div",{className:"text-center py-4",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 dark:bg-green-900/30",children:v.jsx(R1,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),v.jsx("h3",{className:"mt-3 text-lg font-medium text-gray-900 dark:text-white",children:"Check your email"}),v.jsxs("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:["We've sent a password reset link to ",v.jsx("span",{className:"font-medium",children:n})]}),v.jsxs("button",{type:"button",onClick:()=>p(!1),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[v.jsx(gc,{className:"-ml-1 mr-2 h-4 w-4"}),"Back to login"]})]}):v.jsxs(v.Fragment,{children:[v.jsx("button",{type:"submit",disabled:T||!n.trim(),className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?"Sending...":"Send Reset Link"}),v.jsx("div",{className:"mt-4 text-center",children:v.jsxs("button",{type:"button",onClick:()=>p(!1),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:[v.jsx(gc,{className:"inline-block h-4 w-4 -ml-1 mr-1"}),"Back to login"]})})]})]}):v.jsxs("form",{onSubmit:P,className:"space-y-6",children:[v.jsxs("div",{className:"text-center mb-6",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:u?"Create Account":"Sign In"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:u?"Create a new account to get started":"Sign in to your account"})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),v.jsx("input",{id:"email",type:"email",value:n,onChange:A=>e(A.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"username"})]}),u&&v.jsxs("div",{children:[v.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Display Name"}),v.jsx("input",{id:"displayName",type:"text",value:i,onChange:A=>a(A.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your display name",required:!0,disabled:T})]}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"}),!u&&v.jsx("button",{type:"button",onClick:()=>p(!0),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:"Forgot password?"})]}),v.jsxs("div",{className:"relative",children:[v.jsx("input",{id:"password",type:o?"text":"password",value:t,onChange:A=>r(A.target.value),className:`w-full px-3 py-2 pr-10 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white ${u&&t&&!O.isValid?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"Enter your password",required:!0,disabled:T,autoComplete:u?"new-password":"current-password"}),v.jsx("button",{type:"button",onClick:()=>c(!o),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none",disabled:T,children:o?v.jsx($L,{className:"h-5 w-5"}):v.jsx(YL,{className:"h-5 w-5"})})]}),u&&t&&v.jsx("div",{className:"mt-2",children:v.jsx(k$,{password:t})}),u&&t&&v.jsx("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-md",children:v.jsx(N$,{password:t})})]}),C&&v.jsxs("div",{className:"text-red-600 dark:text-red-400 text-sm text-center bg-red-50 dark:bg-red-900/20 p-3 rounded-md",children:[C,C.includes("verify your email")&&v.jsx("div",{className:"mt-3",children:v.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Please check your email and click the verification link to continue."})})]}),v.jsx("button",{type:"submit",disabled:T||!n.trim()||!t.trim()||u&&!i.trim()||u&&!O.isValid,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?u?"Creating Account...":"Signing in...":u?"Create Account":"Sign In"}),v.jsx("div",{className:"mt-6 text-center",children:v.jsxs("button",{type:"button",onClick:()=>{d(!u),p(!1)},className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",disabled:T,children:[v.jsx(j9,{className:"h-4 w-4"}),u?"Already have an account? Sign In":"Don't have an account? Sign Up"]})})]})})]})})},FO=()=>{const[n,e]=U.useState(!1),[t,r]=U.useState(!1),{currentUser:i,resendEmailVerification:a,logout:o,loginError:c}=ea();U.useEffect(()=>{i||console.warn("EmailVerificationView: No current user, this should not happen")},[i]);const u=async()=>{e(!0),r(!1);const h=await a();e(!1),h&&(r(!0),setTimeout(()=>r(!1),3e3))},d=async()=>{await o()};return i?v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsx("div",{className:"flex flex-col items-center gap-3 mb-2",children:v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"House Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"House Budget"})]})})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/30 mb-4",children:v.jsx(R1,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Check your email"}),v.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["We've sent a verification link to"," ",v.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:i.email})]}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 mb-6",children:v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(I1,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),v.jsxs("div",{className:"text-left",children:[v.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium",children:"What to do next:"}),v.jsxs("ol",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1 space-y-1",children:[v.jsx("li",{children:"1. Open your email inbox"}),v.jsx("li",{children:"2. Find the email from House Budget"}),v.jsx("li",{children:'3. Click the "Verify Email" link'}),v.jsx("li",{children:"4. Return here and sign in"})]})]})]})}),c&&v.jsx("div",{className:"text-red-600 dark:text-red-400 text-sm mb-4 p-3 bg-red-50 dark:bg-red-900/20 rounded-md",children:c}),t&&v.jsx("div",{className:"text-green-600 dark:text-green-400 text-sm mb-4 p-3 bg-green-50 dark:bg-green-900/20 rounded-md",children:"Verification email sent successfully!"}),v.jsx("button",{onClick:u,disabled:n,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed mb-4 flex items-center justify-center gap-2",children:n?v.jsxs(v.Fragment,{children:[v.jsx(Vh,{className:"h-4 w-4 animate-spin"}),"Sending..."]}):v.jsxs(v.Fragment,{children:[v.jsx(Vh,{className:"h-4 w-4"}),"Resend verification email"]})}),v.jsxs("button",{onClick:d,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",children:[v.jsx(gc,{className:"h-4 w-4"}),"Back to sign in"]})]})}),v.jsx("div",{className:"text-center",children:v.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Didn't receive the email? Check your spam folder or try resending."})})]})}):null},GO=({message:n="Loading your budget...",showTimeout:e=!1})=>v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex flex-col items-center justify-center px-4",children:[v.jsx("div",{className:"mb-8",children:v.jsxs("div",{className:"relative",children:[v.jsx(Vh,{size:48,className:"text-blue-500 animate-spin"}),v.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:v.jsx(Ev,{size:24,className:"text-blue-600 dark:text-blue-400"})})]})}),v.jsxs("div",{className:"text-center space-y-3",children:[v.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400 max-w-md",children:"This may take a moment on slow connections. We're fetching your budget data securely."})]}),v.jsxs("div",{className:"mt-12 w-full max-w-md space-y-4",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("div",{className:"h-6 bg-gray-200 dark:bg-zinc-700 rounded w-24 animate-pulse"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]})]})}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsx("div",{className:"h-4 bg-gray-200 dark:bg-zinc-700 rounded w-32 mb-2 animate-pulse"}),v.jsx("div",{className:"h-8 bg-gray-200 dark:bg-zinc-700 rounded w-20 animate-pulse"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-28 animate-pulse"}),v.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-32 animate-pulse"}),v.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]})]}),e&&v.jsx("div",{className:"mt-8 p-4 bg-amber-50 dark:bg-amber-900/20 rounded-xl border border-amber-200 dark:border-amber-800 max-w-md",children:v.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200 text-center",children:"This is taking longer than usual. If you're on a very slow connection, this is normal. Your data will load shortly."})}),v.jsx("div",{className:"mt-8 w-full max-w-md",children:v.jsx("div",{className:"h-1 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:v.jsx("div",{className:"h-full bg-blue-500 rounded-full animate-pulse",style:{width:"60%"}})})})]}),EE=U.createContext({});function Zv(n){const e=U.useRef(null);return e.current===null&&(e.current=n()),e.current}const SE=typeof window<"u",TE=SE?U.useLayoutEffect:U.useEffect,Jv=U.createContext(null);function AE(n,e){n.indexOf(e)===-1&&n.push(e)}function CE(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const Ms=(n,e,t)=>t>e?e:t<n?n:t;let IE=()=>{};const Ps={},qO=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function $O(n){return typeof n=="object"&&n!==null}const HO=n=>/^0[^.\s]+$/u.test(n);function RE(n){let e;return()=>(e===void 0&&(e=n()),e)}const ki=n=>n,P$=(n,e)=>t=>e(n(t)),Up=(...n)=>n.reduce(P$),np=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r};class DE{constructor(){this.subscriptions=[]}add(e){return AE(this.subscriptions,e),()=>CE(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let a=0;a<i;a++){const o=this.subscriptions[a];o&&o(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Ua=n=>n*1e3,Ri=n=>n/1e3;function YO(n,e){return e?n*(1e3/e):0}const KO=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,O$=1e-7,j$=12;function V$(n,e,t,r,i){let a,o,c=0;do o=e+(t-e)/2,a=KO(o,r,i)-n,a>0?t=o:e=o;while(Math.abs(a)>O$&&++c<j$);return o}function Fp(n,e,t,r){if(n===e&&t===r)return ki;const i=a=>V$(a,0,1,n,t);return a=>a===0||a===1?a:KO(i(a),e,r)}const XO=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,WO=n=>e=>1-n(1-e),QO=Fp(.33,1.53,.69,.99),kE=WO(QO),ZO=XO(kE),JO=n=>(n*=2)<1?.5*kE(n):.5*(2-Math.pow(2,-10*(n-1))),NE=n=>1-Math.sin(Math.acos(n)),e4=WO(NE),t4=XO(NE),z$=Fp(.42,0,1,1),L$=Fp(0,0,.58,1),n4=Fp(.42,0,.58,1),B$=n=>Array.isArray(n)&&typeof n[0]!="number",r4=n=>Array.isArray(n)&&typeof n[0]=="number",U$={linear:ki,easeIn:z$,easeInOut:n4,easeOut:L$,circIn:NE,circInOut:t4,circOut:e4,backIn:kE,backInOut:ZO,backOut:QO,anticipate:JO},F$=n=>typeof n=="string",LR=n=>{if(r4(n)){IE(n.length===4);const[e,t,r,i]=n;return Fp(e,t,r,i)}else if(F$(n))return U$[n];return n},Pm=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function G$(n,e){let t=new Set,r=new Set,i=!1,a=!1;const o=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function u(h){o.has(h)&&(d.schedule(h),n()),h(c)}const d={schedule:(h,p=!1,m=!1)=>{const _=m&&i?t:r;return p&&o.add(h),_.has(h)||_.add(h),h},cancel:h=>{r.delete(h),o.delete(h)},process:h=>{if(c=h,i){a=!0;return}i=!0,[t,r]=[r,t],t.forEach(u),t.clear(),i=!1,a&&(a=!1,d.process(h))}};return d}const q$=40;function i4(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},a=()=>t=!0,o=Pm.reduce((R,O)=>(R[O]=G$(a),R),{}),{setup:c,read:u,resolveKeyframes:d,preUpdate:h,update:p,preRender:m,render:b,postRender:_}=o,w=()=>{const R=Ps.useManualTiming?i.timestamp:performance.now();t=!1,Ps.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(R-i.timestamp,q$),1)),i.timestamp=R,i.isProcessing=!0,c.process(i),u.process(i),d.process(i),h.process(i),p.process(i),m.process(i),b.process(i),_.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(w))},S=()=>{t=!0,r=!0,i.isProcessing||n(w)};return{schedule:Pm.reduce((R,O)=>{const P=o[O];return R[O]=(N,A=!1,I=!1)=>(t||S(),P.schedule(N,A,I)),R},{}),cancel:R=>{for(let O=0;O<Pm.length;O++)o[Pm[O]].cancel(R)},state:i,steps:o}}const{schedule:rn,cancel:el,state:or,steps:Gx}=i4(typeof requestAnimationFrame<"u"?requestAnimationFrame:ki,!0);let m0;function $$(){m0=void 0}const Ur={now:()=>(m0===void 0&&Ur.set(or.isProcessing||Ps.useManualTiming?or.timestamp:performance.now()),m0),set:n=>{m0=n,queueMicrotask($$)}},a4=n=>e=>typeof e=="string"&&e.startsWith(n),ME=a4("--"),H$=a4("var(--"),PE=n=>H$(n)?Y$.test(n.split("/*")[0].trim()):!1,Y$=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,zd={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},rp={...zd,transform:n=>Ms(0,1,n)},Om={...zd,default:1},Th=n=>Math.round(n*1e5)/1e5,OE=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function K$(n){return n==null}const X$=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,jE=(n,e)=>t=>!!(typeof t=="string"&&X$.test(t)&&t.startsWith(n)||e&&!K$(t)&&Object.prototype.hasOwnProperty.call(t,e)),s4=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,a,o,c]=r.match(OE);return{[n]:parseFloat(i),[e]:parseFloat(a),[t]:parseFloat(o),alpha:c!==void 0?parseFloat(c):1}},W$=n=>Ms(0,255,n),qx={...zd,transform:n=>Math.round(W$(n))},rc={test:jE("rgb","red"),parse:s4("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+qx.transform(n)+", "+qx.transform(e)+", "+qx.transform(t)+", "+Th(rp.transform(r))+")"};function Q$(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const u_={test:jE("#"),parse:Q$,transform:rc.transform},Gp=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Ro=Gp("deg"),Fa=Gp("%"),nt=Gp("px"),Z$=Gp("vh"),J$=Gp("vw"),BR={...Fa,parse:n=>Fa.parse(n)/100,transform:n=>Fa.transform(n*100)},Bu={test:jE("hsl","hue"),parse:s4("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+Fa.transform(Th(e))+", "+Fa.transform(Th(t))+", "+Th(rp.transform(r))+")"},zn={test:n=>rc.test(n)||u_.test(n)||Bu.test(n),parse:n=>rc.test(n)?rc.parse(n):Bu.test(n)?Bu.parse(n):u_.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?rc.transform(n):Bu.transform(n),getAnimatableNone:n=>{const e=zn.parse(n);return e.alpha=0,zn.transform(e)}},eH=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function tH(n){return isNaN(n)&&typeof n=="string"&&(n.match(OE)?.length||0)+(n.match(eH)?.length||0)>0}const o4="number",l4="color",nH="var",rH="var(",UR="${}",iH=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ip(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let a=0;const c=e.replace(iH,u=>(zn.test(u)?(r.color.push(a),i.push(l4),t.push(zn.parse(u))):u.startsWith(rH)?(r.var.push(a),i.push(nH),t.push(u)):(r.number.push(a),i.push(o4),t.push(parseFloat(u))),++a,UR)).split(UR);return{values:t,split:c,indexes:r,types:i}}function c4(n){return ip(n).values}function u4(n){const{split:e,types:t}=ip(n),r=e.length;return i=>{let a="";for(let o=0;o<r;o++)if(a+=e[o],i[o]!==void 0){const c=t[o];c===o4?a+=Th(i[o]):c===l4?a+=zn.transform(i[o]):a+=i[o]}return a}}const aH=n=>typeof n=="number"?0:zn.test(n)?zn.getAnimatableNone(n):n;function sH(n){const e=c4(n);return u4(n)(e.map(aH))}const tl={test:tH,parse:c4,createTransformer:u4,getAnimatableNone:sH};function $x(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function oH({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,a=0,o=0;if(!e)i=a=o=t;else{const c=t<.5?t*(1+e):t+e-t*e,u=2*t-c;i=$x(u,c,n+1/3),a=$x(u,c,n),o=$x(u,c,n-1/3)}return{red:Math.round(i*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:r}}function ev(n,e){return t=>t>0?e:n}const fn=(n,e,t)=>n+(e-n)*t,Hx=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},lH=[u_,rc,Bu],cH=n=>lH.find(e=>e.test(n));function FR(n){const e=cH(n);if(!e)return!1;let t=e.parse(n);return e===Bu&&(t=oH(t)),t}const GR=(n,e)=>{const t=FR(n),r=FR(e);if(!t||!r)return ev(n,e);const i={...t};return a=>(i.red=Hx(t.red,r.red,a),i.green=Hx(t.green,r.green,a),i.blue=Hx(t.blue,r.blue,a),i.alpha=fn(t.alpha,r.alpha,a),rc.transform(i))},d_=new Set(["none","hidden"]);function uH(n,e){return d_.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function dH(n,e){return t=>fn(n,e,t)}function VE(n){return typeof n=="number"?dH:typeof n=="string"?PE(n)?ev:zn.test(n)?GR:pH:Array.isArray(n)?d4:typeof n=="object"?zn.test(n)?GR:fH:ev}function d4(n,e){const t=[...n],r=t.length,i=n.map((a,o)=>VE(a)(a,e[o]));return a=>{for(let o=0;o<r;o++)t[o]=i[o](a);return t}}function fH(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=VE(n[i])(n[i],e[i]));return i=>{for(const a in r)t[a]=r[a](i);return t}}function hH(n,e){const t=[],r={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const a=e.types[i],o=n.indexes[a][r[a]],c=n.values[o]??0;t[i]=c,r[a]++}return t}const pH=(n,e)=>{const t=tl.createTransformer(e),r=ip(n),i=ip(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?d_.has(n)&&!i.values.length||d_.has(e)&&!r.values.length?uH(n,e):Up(d4(hH(r,i),i.values),t):ev(n,e)};function f4(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?fn(n,e,t):VE(n)(n,e)}const gH=n=>{const e=({timestamp:t})=>n(t);return{start:(t=!0)=>rn.update(e,t),stop:()=>el(e),now:()=>or.isProcessing?or.timestamp:Ur.now()}},h4=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let a=0;a<i;a++)r+=Math.round(n(a/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},tv=2e4;function zE(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<tv;)e+=t,r=n.next(e);return e>=tv?1/0:e}function mH(n,e=100,t){const r=t({...n,keyframes:[0,e]}),i=Math.min(zE(r),tv);return{type:"keyframes",ease:a=>r.next(i*a).value/e,duration:Ri(i)}}const vH=5;function p4(n,e,t){const r=Math.max(e-vH,0);return YO(t-n(r),e-r)}const vn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Yx=.001;function yH({duration:n=vn.duration,bounce:e=vn.bounce,velocity:t=vn.velocity,mass:r=vn.mass}){let i,a,o=1-e;o=Ms(vn.minDamping,vn.maxDamping,o),n=Ms(vn.minDuration,vn.maxDuration,Ri(n)),o<1?(i=d=>{const h=d*o,p=h*n,m=h-t,b=f_(d,o),_=Math.exp(-p);return Yx-m/b*_},a=d=>{const p=d*o*n,m=p*t+t,b=Math.pow(o,2)*Math.pow(d,2)*n,_=Math.exp(-p),w=f_(Math.pow(d,2),o);return(-i(d)+Yx>0?-1:1)*((m-b)*_)/w}):(i=d=>{const h=Math.exp(-d*n),p=(d-t)*n+1;return-Yx+h*p},a=d=>{const h=Math.exp(-d*n),p=(t-d)*(n*n);return h*p});const c=5/n,u=xH(i,a,c);if(n=Ua(n),isNaN(u))return{stiffness:vn.stiffness,damping:vn.damping,duration:n};{const d=Math.pow(u,2)*r;return{stiffness:d,damping:o*2*Math.sqrt(r*d),duration:n}}}const bH=12;function xH(n,e,t){let r=t;for(let i=1;i<bH;i++)r=r-n(r)/e(r);return r}function f_(n,e){return n*Math.sqrt(1-e*e)}const _H=["duration","bounce"],wH=["stiffness","damping","mass"];function qR(n,e){return e.some(t=>n[t]!==void 0)}function EH(n){let e={velocity:vn.velocity,stiffness:vn.stiffness,damping:vn.damping,mass:vn.mass,isResolvedFromDuration:!1,...n};if(!qR(n,wH)&&qR(n,_H))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,a=2*Ms(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:vn.mass,stiffness:i,damping:a}}else{const t=yH(n);e={...e,...t,mass:vn.mass},e.isResolvedFromDuration=!0}return e}function nv(n=vn.visualDuration,e=vn.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const a=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],c={done:!1,value:a},{stiffness:u,damping:d,mass:h,duration:p,velocity:m,isResolvedFromDuration:b}=EH({...t,velocity:-Ri(t.velocity||0)}),_=m||0,w=d/(2*Math.sqrt(u*h)),S=o-a,T=Ri(Math.sqrt(u/h)),C=Math.abs(S)<5;r||(r=C?vn.restSpeed.granular:vn.restSpeed.default),i||(i=C?vn.restDelta.granular:vn.restDelta.default);let R;if(w<1){const P=f_(T,w);R=N=>{const A=Math.exp(-w*T*N);return o-A*((_+w*T*S)/P*Math.sin(P*N)+S*Math.cos(P*N))}}else if(w===1)R=P=>o-Math.exp(-T*P)*(S+(_+T*S)*P);else{const P=T*Math.sqrt(w*w-1);R=N=>{const A=Math.exp(-w*T*N),I=Math.min(P*N,300);return o-A*((_+w*T*S)*Math.sinh(I)+P*S*Math.cosh(I))/P}}const O={calculatedDuration:b&&p||null,next:P=>{const N=R(P);if(b)c.done=P>=p;else{let A=P===0?_:0;w<1&&(A=P===0?Ua(_):p4(R,P,N));const I=Math.abs(A)<=r,k=Math.abs(o-N)<=i;c.done=I&&k}return c.value=c.done?o:N,c},toString:()=>{const P=Math.min(zE(O),tv),N=h4(A=>O.next(P*A).value,P,30);return P+"ms "+N},toTransition:()=>{}};return O}nv.applyToOptions=n=>{const e=mH(n,100,nv);return n.ease=e.ease,n.duration=Ua(e.duration),n.type="keyframes",n};function h_({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:a=500,modifyTarget:o,min:c,max:u,restDelta:d=.5,restSpeed:h}){const p=n[0],m={done:!1,value:p},b=I=>c!==void 0&&I<c||u!==void 0&&I>u,_=I=>c===void 0?u:u===void 0||Math.abs(c-I)<Math.abs(u-I)?c:u;let w=t*e;const S=p+w,T=o===void 0?S:o(S);T!==S&&(w=T-p);const C=I=>-w*Math.exp(-I/r),R=I=>T+C(I),O=I=>{const k=C(I),z=R(I);m.done=Math.abs(k)<=d,m.value=m.done?T:z};let P,N;const A=I=>{b(m.value)&&(P=I,N=nv({keyframes:[m.value,_(m.value)],velocity:p4(R,I,m.value),damping:i,stiffness:a,restDelta:d,restSpeed:h}))};return A(0),{calculatedDuration:null,next:I=>{let k=!1;return!N&&P===void 0&&(k=!0,O(I),A(I)),P!==void 0&&I>=P?N.next(I-P):(!k&&O(I),m)}}}function SH(n,e,t){const r=[],i=t||Ps.mix||f4,a=n.length-1;for(let o=0;o<a;o++){let c=i(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||ki:e;c=Up(u,c)}r.push(c)}return r}function TH(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const a=n.length;if(IE(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[a-1]&&(n=[...n].reverse(),e=[...e].reverse());const c=SH(e,r,i),u=c.length,d=h=>{if(o&&h<n[0])return e[0];let p=0;if(u>1)for(;p<n.length-2&&!(h<n[p+1]);p++);const m=np(n[p],n[p+1],h);return c[p](m)};return t?h=>d(Ms(n[0],n[a-1],h)):d}function AH(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=np(0,e,r);n.push(fn(t,1,i))}}function CH(n){const e=[0];return AH(e,n.length-1),e}function IH(n,e){return n.map(t=>t*e)}function RH(n,e){return n.map(()=>e||n4).splice(0,n.length-1)}function Ah({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=B$(r)?r.map(LR):LR(r),a={done:!1,value:e[0]},o=IH(t&&t.length===e.length?t:CH(e),n),c=TH(o,e,{ease:Array.isArray(i)?i:RH(e,i)});return{calculatedDuration:n,next:u=>(a.value=c(u),a.done=u>=n,a)}}const DH=n=>n!==null;function LE(n,{repeat:e,repeatType:t="loop"},r,i=1){const a=n.filter(DH),c=i<0||e&&t!=="loop"&&e%2===1?0:a.length-1;return!c||r===void 0?a[c]:r}const kH={decay:h_,inertia:h_,tween:Ah,keyframes:Ah,spring:nv};function g4(n){typeof n.type=="string"&&(n.type=kH[n.type])}class BE{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const NH=n=>n/100;class UE extends BE{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:t}=this.options;t&&t.updatedAt!==Ur.now()&&this.tick(Ur.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;g4(e);const{type:t=Ah,repeat:r=0,repeatDelay:i=0,repeatType:a,velocity:o=0}=e;let{keyframes:c}=e;const u=t||Ah;u!==Ah&&typeof c[0]!="number"&&(this.mixKeyframes=Up(NH,f4(c[0],c[1])),c=[0,100]);const d=u({...e,keyframes:c});a==="mirror"&&(this.mirroredGenerator=u({...e,keyframes:[...c].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=zE(d));const{calculatedDuration:h}=d;this.calculatedDuration=h,this.resolvedDuration=h+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=d}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:r,totalDuration:i,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:c,calculatedDuration:u}=this;if(this.startTime===null)return r.next(0);const{delay:d=0,keyframes:h,repeat:p,repeatType:m,repeatDelay:b,type:_,onUpdate:w,finalKeyframe:S}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const T=this.currentTime-d*(this.playbackSpeed>=0?1:-1),C=this.playbackSpeed>=0?T<0:T>i;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let R=this.currentTime,O=r;if(p){const I=Math.min(this.currentTime,i)/c;let k=Math.floor(I),z=I%1;!z&&I>=1&&(z=1),z===1&&k--,k=Math.min(k,p+1),!!(k%2)&&(m==="reverse"?(z=1-z,b&&(z-=b/c)):m==="mirror"&&(O=o)),R=Ms(0,1,z)*c}const P=C?{done:!1,value:h[0]}:O.next(R);a&&(P.value=a(P.value));let{done:N}=P;!C&&u!==null&&(N=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const A=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&N);return A&&_!==h_&&(P.value=LE(h,this.options,S,this.speed)),w&&w(P.value),A&&this.finish(),P}then(e,t){return this.finished.then(e,t)}get duration(){return Ri(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Ri(e)}get time(){return Ri(this.currentTime)}set time(e){e=Ua(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Ur.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Ri(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=gH,startTime:t}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=t??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Ur.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function MH(n){for(let e=1;e<n.length;e++)n[e]??(n[e]=n[e-1])}const ic=n=>n*180/Math.PI,p_=n=>{const e=ic(Math.atan2(n[1],n[0]));return g_(e)},PH={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:p_,rotateZ:p_,skewX:n=>ic(Math.atan(n[1])),skewY:n=>ic(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},g_=n=>(n=n%360,n<0&&(n+=360),n),$R=p_,HR=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),YR=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),OH={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:HR,scaleY:YR,scale:n=>(HR(n)+YR(n))/2,rotateX:n=>g_(ic(Math.atan2(n[6],n[5]))),rotateY:n=>g_(ic(Math.atan2(-n[2],n[0]))),rotateZ:$R,rotate:$R,skewX:n=>ic(Math.atan(n[4])),skewY:n=>ic(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function m_(n){return n.includes("scale")?1:0}function v_(n,e){if(!n||n==="none")return m_(e);const t=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(t)r=OH,i=t;else{const c=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=PH,i=c}if(!i)return m_(e);const a=r[e],o=i[1].split(",").map(VH);return typeof a=="function"?a(o):o[a]}const jH=(n,e)=>{const{transform:t="none"}=getComputedStyle(n);return v_(t,e)};function VH(n){return parseFloat(n.trim())}const Ld=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Bd=new Set(Ld),KR=n=>n===zd||n===nt,zH=new Set(["x","y","z"]),LH=Ld.filter(n=>!zH.has(n));function BH(n){const e=[];return LH.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const hc={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:(n,{transform:e})=>v_(e,"x"),y:(n,{transform:e})=>v_(e,"y")};hc.translateX=hc.x;hc.translateY=hc.y;const pc=new Set;let y_=!1,b_=!1,x_=!1;function m4(){if(b_){const n=Array.from(pc).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=BH(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([a,o])=>{r.getValue(a)?.set(o)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}b_=!1,y_=!1,pc.forEach(n=>n.complete(x_)),pc.clear()}function v4(){pc.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(b_=!0)})}function UH(){x_=!0,v4(),m4(),x_=!1}class FE{constructor(e,t,r,i,a,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(pc.add(this),y_||(y_=!0,rn.read(v4),rn.resolveKeyframes(m4))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;if(e[0]===null){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&t){const c=r.readValue(t,o);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}MH(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),pc.delete(this)}cancel(){this.state==="scheduled"&&(pc.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const FH=n=>n.startsWith("--");function GH(n,e,t){FH(e)?n.style.setProperty(e,t):n.style[e]=t}const qH=RE(()=>window.ScrollTimeline!==void 0),$H={};function HH(n,e){const t=RE(n);return()=>$H[e]??t()}const y4=HH(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),uh=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,XR={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:uh([0,.65,.55,1]),circOut:uh([.55,0,1,.45]),backIn:uh([.31,.01,.66,-.59]),backOut:uh([.33,1.53,.69,.99])};function b4(n,e){if(n)return typeof n=="function"?y4()?h4(n,e):"ease-out":r4(n)?uh(n):Array.isArray(n)?n.map(t=>b4(t,e)||XR.easeOut):XR[n]}function YH(n,e,t,{delay:r=0,duration:i=300,repeat:a=0,repeatType:o="loop",ease:c="easeOut",times:u}={},d=void 0){const h={[e]:t};u&&(h.offset=u);const p=b4(c,i);Array.isArray(p)&&(h.easing=p);const m={delay:r,duration:i,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};return d&&(m.pseudoElement=d),n.animate(h,m)}function x4(n){return typeof n=="function"&&"applyToOptions"in n}function KH({type:n,...e}){return x4(n)&&y4()?n.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class XH extends BE{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:r,keyframes:i,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:c,onComplete:u}=e;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=e,IE(typeof e.type!="string");const d=KH(e);this.animation=YH(t,r,i,d,a),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const h=LE(i,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(h):GH(t,r,h),this.animation.cancel()}u?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return Ri(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Ri(e)}get time(){return Ri(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=Ua(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&qH()?(this.animation.timeline=e,ki):t(this)}}const _4={anticipate:JO,backInOut:ZO,circInOut:t4};function WH(n){return n in _4}function QH(n){typeof n.ease=="string"&&WH(n.ease)&&(n.ease=_4[n.ease])}const WR=10;class ZH extends XH{constructor(e){QH(e),g4(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:r,onComplete:i,element:a,...o}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const c=new UE({...o,autoplay:!1}),u=Ua(this.finishedTime??this.time);t.setWithVelocity(c.sample(u-WR).value,c.sample(u).value,WR),c.stop()}}const QR=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(tl.test(n)||n==="0")&&!n.startsWith("url("));function JH(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function eY(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const a=n[n.length-1],o=QR(i,e),c=QR(a,e);return!o||!c?!1:JH(n)||(t==="spring"||x4(t))&&r}function __(n){n.duration=0,n.type="keyframes"}const tY=new Set(["opacity","clipPath","filter","transform"]),nY=RE(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function rY(n){const{motionValue:e,name:t,repeatDelay:r,repeatType:i,damping:a,type:o}=n;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:d}=e.owner.getProps();return nY()&&t&&tY.has(t)&&(t!=="transform"||!d)&&!u&&!r&&i!=="mirror"&&a!==0&&o!=="inertia"}const iY=40;class aY extends BE{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:o="loop",keyframes:c,name:u,motionValue:d,element:h,...p}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Ur.now();const m={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:a,repeatType:o,name:u,motionValue:d,element:h,...p},b=h?.KeyframeResolver||FE;this.keyframeResolver=new b(c,(_,w,S)=>this.onKeyframesResolved(_,w,m,!S),u,d,h),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,t,r,i){this.keyframeResolver=void 0;const{name:a,type:o,velocity:c,delay:u,isHandoff:d,onUpdate:h}=r;this.resolvedAt=Ur.now(),eY(e,a,o,c)||((Ps.instantAnimations||!u)&&h?.(LE(e,r,t)),e[0]=e[e.length-1],__(r),r.repeat=0);const m={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>iY?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...r,keyframes:e},b=!d&&rY(m)?new ZH({...m,element:m.motionValue.owner.current}):new UE(m);b.finished.then(()=>this.notifyFinished()).catch(ki),this.pendingTimeline&&(this.stopTimeline=b.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=b}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),UH()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const sY=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function oY(n){const e=sY.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function w4(n,e,t=1){const[r,i]=oY(n);if(!r)return;const a=window.getComputedStyle(e).getPropertyValue(r);if(a){const o=a.trim();return qO(o)?parseFloat(o):o}return PE(i)?w4(i,e,t+1):i}function GE(n,e){return n?.[e]??n?.default??n}const E4=new Set(["width","height","top","left","right","bottom",...Ld]),lY={test:n=>n==="auto",parse:n=>n},S4=n=>e=>e.test(n),T4=[zd,nt,Fa,Ro,J$,Z$,lY],ZR=n=>T4.find(S4(n));function cY(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||HO(n):!0}const uY=new Set(["brightness","contrast","saturate","opacity"]);function dY(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(OE)||[];if(!r)return n;const i=t.replace(r,"");let a=uY.has(e)?1:0;return r!==t&&(a*=100),e+"("+a+i+")"}const fY=/\b([a-z-]*)\(.*?\)/gu,w_={...tl,getAnimatableNone:n=>{const e=n.match(fY);return e?e.map(dY).join(" "):n}},JR={...zd,transform:Math.round},hY={rotate:Ro,rotateX:Ro,rotateY:Ro,rotateZ:Ro,scale:Om,scaleX:Om,scaleY:Om,scaleZ:Om,skew:Ro,skewX:Ro,skewY:Ro,distance:nt,translateX:nt,translateY:nt,translateZ:nt,x:nt,y:nt,z:nt,perspective:nt,transformPerspective:nt,opacity:rp,originX:BR,originY:BR,originZ:nt},qE={borderWidth:nt,borderTopWidth:nt,borderRightWidth:nt,borderBottomWidth:nt,borderLeftWidth:nt,borderRadius:nt,radius:nt,borderTopLeftRadius:nt,borderTopRightRadius:nt,borderBottomRightRadius:nt,borderBottomLeftRadius:nt,width:nt,maxWidth:nt,height:nt,maxHeight:nt,top:nt,right:nt,bottom:nt,left:nt,padding:nt,paddingTop:nt,paddingRight:nt,paddingBottom:nt,paddingLeft:nt,margin:nt,marginTop:nt,marginRight:nt,marginBottom:nt,marginLeft:nt,backgroundPositionX:nt,backgroundPositionY:nt,...hY,zIndex:JR,fillOpacity:rp,strokeOpacity:rp,numOctaves:JR},pY={...qE,color:zn,backgroundColor:zn,outlineColor:zn,fill:zn,stroke:zn,borderColor:zn,borderTopColor:zn,borderRightColor:zn,borderBottomColor:zn,borderLeftColor:zn,filter:w_,WebkitFilter:w_},A4=n=>pY[n];function C4(n,e){let t=A4(n);return t!==w_&&(t=tl),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const gY=new Set(["auto","none","0"]);function mY(n,e,t){let r=0,i;for(;r<n.length&&!i;){const a=n[r];typeof a=="string"&&!gY.has(a)&&ip(a).values.length&&(i=n[r]),r++}if(i&&t)for(const a of e)n[a]=C4(t,i)}class vY extends FE{constructor(e,t,r,i,a){super(e,t,r,i,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let d=e[u];if(typeof d=="string"&&(d=d.trim(),PE(d))){const h=w4(d,t.current);h!==void 0&&(e[u]=h),u===e.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!E4.has(r)||e.length!==2)return;const[i,a]=e,o=ZR(i),c=ZR(a);if(o!==c)if(KR(o)&&KR(c))for(let u=0;u<e.length;u++){const d=e[u];typeof d=="string"&&(e[u]=parseFloat(d))}else hc[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)(e[i]===null||cY(e[i]))&&r.push(i);r.length&&mY(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=hc[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){const{element:e,name:t,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const i=e.getValue(t);i&&i.jump(this.measuredOrigin,!1);const a=r.length-1,o=r[a];r[a]=hc[t](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([c,u])=>{e.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function yY(n,e,t){if(n instanceof EventTarget)return[n];if(typeof n=="string"){let r=document;const i=t?.[n]??r.querySelectorAll(n);return i?Array.from(i):[]}return Array.from(n)}const I4=(n,e)=>e&&typeof n=="number"?e.transform(n):n;function R4(n){return $O(n)&&"offsetHeight"in n}const eD=30,bY=n=>!isNaN(parseFloat(n));class xY{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const i=Ur.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=Ur.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=bY(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new DE);const r=this.events[e].add(t);return e==="change"?()=>{r(),rn.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Ur.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>eD)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,eD);return YO(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function yd(n,e){return new xY(n,e)}const{schedule:$E}=i4(queueMicrotask,!1),Yi={x:!1,y:!1};function D4(){return Yi.x||Yi.y}function _Y(n){return n==="x"||n==="y"?Yi[n]?null:(Yi[n]=!0,()=>{Yi[n]=!1}):Yi.x||Yi.y?null:(Yi.x=Yi.y=!0,()=>{Yi.x=Yi.y=!1})}function k4(n,e){const t=yY(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function tD(n){return!(n.pointerType==="touch"||D4())}function wY(n,e,t={}){const[r,i,a]=k4(n,t),o=c=>{if(!tD(c))return;const{target:u}=c,d=e(u,c);if(typeof d!="function"||!u)return;const h=p=>{tD(p)&&(d(p),u.removeEventListener("pointerleave",h))};u.addEventListener("pointerleave",h,i)};return r.forEach(c=>{c.addEventListener("pointerenter",o,i)}),a}const N4=(n,e)=>e?n===e?!0:N4(n,e.parentElement):!1,HE=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,EY=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function SY(n){return EY.has(n.tagName)||n.tabIndex!==-1}const v0=new WeakSet;function nD(n){return e=>{e.key==="Enter"&&n(e)}}function Kx(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const TY=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=nD(()=>{if(v0.has(t))return;Kx(t,"down");const i=nD(()=>{Kx(t,"up")}),a=()=>Kx(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",a,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function rD(n){return HE(n)&&!D4()}function AY(n,e,t={}){const[r,i,a]=k4(n,t),o=c=>{const u=c.currentTarget;if(!rD(c))return;v0.add(u);const d=e(u,c),h=(b,_)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",m),v0.has(u)&&v0.delete(u),rD(b)&&typeof d=="function"&&d(b,{success:_})},p=b=>{h(b,u===window||u===document||t.useGlobalTarget||N4(u,b.target))},m=b=>{h(b,!1)};window.addEventListener("pointerup",p,i),window.addEventListener("pointercancel",m,i)};return r.forEach(c=>{(t.useGlobalTarget?window:c).addEventListener("pointerdown",o,i),R4(c)&&(c.addEventListener("focus",d=>TY(d,i)),!SY(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),a}function M4(n){return $O(n)&&"ownerSVGElement"in n}function CY(n){return M4(n)&&n.tagName==="svg"}const mr=n=>!!(n&&n.getVelocity),IY=[...T4,zn,tl],RY=n=>IY.find(S4(n)),YE=U.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function iD(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function DY(...n){return e=>{let t=!1;const r=n.map(i=>{const a=iD(i,e);return!t&&typeof a=="function"&&(t=!0),a});if(t)return()=>{for(let i=0;i<r.length;i++){const a=r[i];typeof a=="function"?a():iD(n[i],null)}}}}function kY(...n){return U.useCallback(DY(...n),n)}class NY extends U.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=t.offsetParent,i=R4(r)&&r.offsetWidth||0,a=this.props.sizeRef.current;a.height=t.offsetHeight||0,a.width=t.offsetWidth||0,a.top=t.offsetTop,a.left=t.offsetLeft,a.right=i-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function MY({children:n,isPresent:e,anchorX:t,root:r}){const i=U.useId(),a=U.useRef(null),o=U.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=U.useContext(YE),u=kY(a,n?.ref);return U.useInsertionEffect(()=>{const{width:d,height:h,top:p,left:m,right:b}=o.current;if(e||!a.current||!d||!h)return;const _=t==="left"?`left: ${m}`:`right: ${b}`;a.current.dataset.motionPopId=i;const w=document.createElement("style");c&&(w.nonce=c);const S=r??document.head;return S.appendChild(w),w.sheet&&w.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${h}px !important;
            ${_}px !important;
            top: ${p}px !important;
          }
        `),()=>{S.contains(w)&&S.removeChild(w)}},[e]),v.jsx(NY,{isPresent:e,childRef:a,sizeRef:o,children:U.cloneElement(n,{ref:u})})}const PY=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:a,mode:o,anchorX:c,root:u})=>{const d=Zv(OY),h=U.useId();let p=!0,m=U.useMemo(()=>(p=!1,{id:h,initial:e,isPresent:t,custom:i,onExitComplete:b=>{d.set(b,!0);for(const _ of d.values())if(!_)return;r&&r()},register:b=>(d.set(b,!1),()=>d.delete(b))}),[t,d,r]);return a&&p&&(m={...m}),U.useMemo(()=>{d.forEach((b,_)=>d.set(_,!1))},[t]),U.useEffect(()=>{!t&&!d.size&&r&&r()},[t]),o==="popLayout"&&(n=v.jsx(MY,{isPresent:t,anchorX:c,root:u,children:n})),v.jsx(Jv.Provider,{value:m,children:n})};function OY(){return new Map}function P4(n=!0){const e=U.useContext(Jv);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,a=U.useId();U.useEffect(()=>{if(n)return i(a)},[n]);const o=U.useCallback(()=>n&&r&&r(a),[a,r,n]);return!t&&r?[!1,o]:[!0]}const jm=n=>n.key||"";function aD(n){const e=[];return U.Children.forEach(n,t=>{U.isValidElement(t)&&e.push(t)}),e}const ci=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:a="sync",propagate:o=!1,anchorX:c="left",root:u})=>{const[d,h]=P4(o),p=U.useMemo(()=>aD(n),[n]),m=o&&!d?[]:p.map(jm),b=U.useRef(!0),_=U.useRef(p),w=Zv(()=>new Map),[S,T]=U.useState(p),[C,R]=U.useState(p);TE(()=>{b.current=!1,_.current=p;for(let N=0;N<C.length;N++){const A=jm(C[N]);m.includes(A)?w.delete(A):w.get(A)!==!0&&w.set(A,!1)}},[C,m.length,m.join("-")]);const O=[];if(p!==S){let N=[...p];for(let A=0;A<C.length;A++){const I=C[A],k=jm(I);m.includes(k)||(N.splice(A,0,I),O.push(I))}return a==="wait"&&O.length&&(N=O),R(aD(N)),T(p),null}const{forceRender:P}=U.useContext(EE);return v.jsx(v.Fragment,{children:C.map(N=>{const A=jm(N),I=o&&!d?!1:p===C||m.includes(A),k=()=>{if(w.has(A))w.set(A,!0);else return;let z=!0;w.forEach(V=>{V||(z=!1)}),z&&(P?.(),R(_.current),o&&h?.(),r&&r())};return v.jsx(PY,{isPresent:I,initial:!b.current||t?void 0:!1,custom:e,presenceAffectsLayout:i,mode:a,root:u,onExitComplete:I?void 0:k,anchorX:c,children:N},A)})})},O4=U.createContext({strict:!1}),sD={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},bd={};for(const n in sD)bd[n]={isEnabled:e=>sD[n].some(t=>!!e[t])};function jY(n){for(const e in n)bd[e]={...bd[e],...n[e]}}const VY=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function rv(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||VY.has(n)}let j4=n=>!rv(n);function zY(n){typeof n=="function"&&(j4=e=>e.startsWith("on")?!rv(e):n(e))}try{zY(require("@emotion/is-prop-valid").default)}catch{}function LY(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(j4(i)||t===!0&&rv(i)||!e&&!rv(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}const ey=U.createContext({});function ty(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function ap(n){return typeof n=="string"||Array.isArray(n)}const KE=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],XE=["initial",...KE];function ny(n){return ty(n.animate)||XE.some(e=>ap(n[e]))}function V4(n){return!!(ny(n)||n.variants)}function BY(n,e){if(ny(n)){const{initial:t,animate:r}=n;return{initial:t===!1||ap(t)?t:void 0,animate:ap(r)?r:void 0}}return n.inherit!==!1?e:{}}function UY(n){const{initial:e,animate:t}=BY(n,U.useContext(ey));return U.useMemo(()=>({initial:e,animate:t}),[oD(e),oD(t)])}function oD(n){return Array.isArray(n)?n.join(" "):n}const sp={};function FY(n){for(const e in n)sp[e]=n[e],ME(e)&&(sp[e].isCSSVariable=!0)}function z4(n,{layout:e,layoutId:t}){return Bd.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!sp[n]||n==="opacity")}const GY={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},qY=Ld.length;function $Y(n,e,t){let r="",i=!0;for(let a=0;a<qY;a++){const o=Ld[a],c=n[o];if(c===void 0)continue;let u=!0;if(typeof c=="number"?u=c===(o.startsWith("scale")?1:0):u=parseFloat(c)===0,!u||t){const d=I4(c,qE[o]);if(!u){i=!1;const h=GY[o]||o;r+=`${h}(${d}) `}t&&(e[o]=d)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function WE(n,e,t){const{style:r,vars:i,transformOrigin:a}=n;let o=!1,c=!1;for(const u in e){const d=e[u];if(Bd.has(u)){o=!0;continue}else if(ME(u)){i[u]=d;continue}else{const h=I4(d,qE[u]);u.startsWith("origin")?(c=!0,a[u]=h):r[u]=h}}if(e.transform||(o||t?r.transform=$Y(e,n.transform,t):r.transform&&(r.transform="none")),c){const{originX:u="50%",originY:d="50%",originZ:h=0}=a;r.transformOrigin=`${u} ${d} ${h}`}}const QE=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function L4(n,e,t){for(const r in e)!mr(e[r])&&!z4(r,t)&&(n[r]=e[r])}function HY({transformTemplate:n},e){return U.useMemo(()=>{const t=QE();return WE(t,e,n),Object.assign({},t.vars,t.style)},[e])}function YY(n,e){const t=n.style||{},r={};return L4(r,t,n),Object.assign(r,HY(n,e)),r}function KY(n,e){const t={},r=YY(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}const XY={offset:"stroke-dashoffset",array:"stroke-dasharray"},WY={offset:"strokeDashoffset",array:"strokeDasharray"};function QY(n,e,t=1,r=0,i=!0){n.pathLength=1;const a=i?XY:WY;n[a.offset]=nt.transform(-r);const o=nt.transform(e),c=nt.transform(t);n[a.array]=`${o} ${c}`}function B4(n,{attrX:e,attrY:t,attrScale:r,pathLength:i,pathSpacing:a=1,pathOffset:o=0,...c},u,d,h){if(WE(n,c,d),u){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:p,style:m}=n;p.transform&&(m.transform=p.transform,delete p.transform),(m.transform||p.transformOrigin)&&(m.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),m.transform&&(m.transformBox=h?.transformBox??"fill-box",delete p.transformBox),e!==void 0&&(p.x=e),t!==void 0&&(p.y=t),r!==void 0&&(p.scale=r),i!==void 0&&QY(p,i,a,o,!1)}const U4=()=>({...QE(),attrs:{}}),F4=n=>typeof n=="string"&&n.toLowerCase()==="svg";function ZY(n,e,t,r){const i=U.useMemo(()=>{const a=U4();return B4(a,e,F4(r),n.transformTemplate,n.style),{...a.attrs,style:{...a.style}}},[e]);if(n.style){const a={};L4(a,n.style,n),i.style={...a,...i.style}}return i}const JY=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function ZE(n){return typeof n!="string"||n.includes("-")?!1:!!(JY.indexOf(n)>-1||/[A-Z]/u.test(n))}function eK(n,e,t,{latestValues:r},i,a=!1){const c=(ZE(n)?ZY:KY)(e,r,i,n),u=LY(e,typeof n=="string",a),d=n!==U.Fragment?{...u,...c,ref:t}:{},{children:h}=e,p=U.useMemo(()=>mr(h)?h.get():h,[h]);return U.createElement(n,{...d,children:p})}function lD(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function JE(n,e,t,r){if(typeof e=="function"){const[i,a]=lD(r);e=e(t!==void 0?t:n.custom,i,a)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,a]=lD(r);e=e(t!==void 0?t:n.custom,i,a)}return e}function y0(n){return mr(n)?n.get():n}function tK({scrapeMotionValuesFromProps:n,createRenderState:e},t,r,i){return{latestValues:nK(t,r,i,n),renderState:e()}}function nK(n,e,t,r){const i={},a=r(n,{});for(const m in a)i[m]=y0(a[m]);let{initial:o,animate:c}=n;const u=ny(n),d=V4(n);e&&d&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),c===void 0&&(c=e.animate));let h=t?t.initial===!1:!1;h=h||o===!1;const p=h?c:o;if(p&&typeof p!="boolean"&&!ty(p)){const m=Array.isArray(p)?p:[p];for(let b=0;b<m.length;b++){const _=JE(n,m[b]);if(_){const{transitionEnd:w,transition:S,...T}=_;for(const C in T){let R=T[C];if(Array.isArray(R)){const O=h?R.length-1:0;R=R[O]}R!==null&&(i[C]=R)}for(const C in w)i[C]=w[C]}}}return i}const G4=n=>(e,t)=>{const r=U.useContext(ey),i=U.useContext(Jv),a=()=>tK(n,e,r,i);return t?a():Zv(a)};function eS(n,e,t){const{style:r}=n,i={};for(const a in r)(mr(r[a])||e.style&&mr(e.style[a])||z4(a,n)||t?.getValue(a)?.liveStyle!==void 0)&&(i[a]=r[a]);return i}const rK=G4({scrapeMotionValuesFromProps:eS,createRenderState:QE});function q4(n,e,t){const r=eS(n,e,t);for(const i in n)if(mr(n[i])||mr(e[i])){const a=Ld.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[a]=n[i]}return r}const iK=G4({scrapeMotionValuesFromProps:q4,createRenderState:U4}),aK=Symbol.for("motionComponentSymbol");function Uu(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function sK(n,e,t){return U.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):Uu(t)&&(t.current=r))},[e])}const tS=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),oK="framerAppearId",$4="data-"+tS(oK),H4=U.createContext({});function lK(n,e,t,r,i){const{visualElement:a}=U.useContext(ey),o=U.useContext(O4),c=U.useContext(Jv),u=U.useContext(YE).reducedMotion,d=U.useRef(null);r=r||o.renderer,!d.current&&r&&(d.current=r(n,{visualState:e,parent:a,props:t,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const h=d.current,p=U.useContext(H4);h&&!h.projection&&i&&(h.type==="html"||h.type==="svg")&&cK(d.current,t,i,p);const m=U.useRef(!1);U.useInsertionEffect(()=>{h&&m.current&&h.update(t,c)});const b=t[$4],_=U.useRef(!!b&&!window.MotionHandoffIsComplete?.(b)&&window.MotionHasOptimisedAnimation?.(b));return TE(()=>{h&&(m.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),h.scheduleRenderMicrotask(),_.current&&h.animationState&&h.animationState.animateChanges())}),U.useEffect(()=>{h&&(!_.current&&h.animationState&&h.animationState.animateChanges(),_.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(b)}),_.current=!1),h.enteringChildren=void 0)}),h}function cK(n,e,t,r){const{layoutId:i,layout:a,drag:o,dragConstraints:c,layoutScroll:u,layoutRoot:d,layoutCrossfade:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:Y4(n.parent)),n.projection.setOptions({layoutId:i,layout:a,alwaysMeasureLayout:!!o||c&&Uu(c),visualElement:n,animationType:typeof a=="string"?a:"both",initialPromotionConfig:r,crossfade:h,layoutScroll:u,layoutRoot:d})}function Y4(n){if(n)return n.options.allowProjection!==!1?n.projection:Y4(n.parent)}function Xx(n,{forwardMotionProps:e=!1}={},t,r){t&&jY(t);const i=ZE(n)?iK:rK;function a(c,u){let d;const h={...U.useContext(YE),...c,layoutId:uK(c)},{isStatic:p}=h,m=UY(c),b=i(c,p);if(!p&&SE){dK();const _=fK(h);d=_.MeasureLayout,m.visualElement=lK(n,b,h,r,_.ProjectionNode)}return v.jsxs(ey.Provider,{value:m,children:[d&&m.visualElement?v.jsx(d,{visualElement:m.visualElement,...h}):null,eK(n,c,sK(b,m.visualElement,u),b,p,e)]})}a.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const o=U.forwardRef(a);return o[aK]=n,o}function uK({layoutId:n}){const e=U.useContext(EE).id;return e&&n!==void 0?e+"-"+n:n}function dK(n,e){U.useContext(O4).strict}function fK(n){const{drag:e,layout:t}=bd;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function hK(n,e){if(typeof Proxy>"u")return Xx;const t=new Map,r=(a,o)=>Xx(a,o,n,e),i=(a,o)=>r(a,o);return new Proxy(i,{get:(a,o)=>o==="create"?r:(t.has(o)||t.set(o,Xx(o,void 0,n,e)),t.get(o))})}function K4({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function pK({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function gK(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function Wx(n){return n===void 0||n===1}function E_({scale:n,scaleX:e,scaleY:t}){return!Wx(n)||!Wx(e)||!Wx(t)}function Hl(n){return E_(n)||X4(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function X4(n){return cD(n.x)||cD(n.y)}function cD(n){return n&&n!=="0%"}function iv(n,e,t){const r=n-t,i=e*r;return t+i}function uD(n,e,t,r,i){return i!==void 0&&(n=iv(n,i,r)),iv(n,t,r)+e}function S_(n,e=0,t=1,r,i){n.min=uD(n.min,e,t,r,i),n.max=uD(n.max,e,t,r,i)}function W4(n,{x:e,y:t}){S_(n.x,e.translate,e.scale,e.originPoint),S_(n.y,t.translate,t.scale,t.originPoint)}const dD=.999999999999,fD=1.0000000000001;function mK(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let a,o;for(let c=0;c<i;c++){a=t[c],o=a.projectionDelta;const{visualElement:u}=a.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Gu(n,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,W4(n,o)),r&&Hl(a.latestValues)&&Gu(n,a.latestValues))}e.x<fD&&e.x>dD&&(e.x=1),e.y<fD&&e.y>dD&&(e.y=1)}function Fu(n,e){n.min=n.min+e,n.max=n.max+e}function hD(n,e,t,r,i=.5){const a=fn(n.min,n.max,i);S_(n,e,t,a,r)}function Gu(n,e){hD(n.x,e.x,e.scaleX,e.scale,e.originX),hD(n.y,e.y,e.scaleY,e.scale,e.originY)}function Q4(n,e){return K4(gK(n.getBoundingClientRect(),e))}function vK(n,e,t){const r=Q4(n,t),{scroll:i}=e;return i&&(Fu(r.x,i.offset.x),Fu(r.y,i.offset.y)),r}const pD=()=>({translate:0,scale:1,origin:0,originPoint:0}),qu=()=>({x:pD(),y:pD()}),gD=()=>({min:0,max:0}),Tn=()=>({x:gD(),y:gD()}),T_={current:null},Z4={current:!1};function yK(){if(Z4.current=!0,!!SE)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>T_.current=n.matches;n.addEventListener("change",e),e()}else T_.current=!1}const bK=new WeakMap;function xK(n,e,t){for(const r in e){const i=e[r],a=t[r];if(mr(i))n.addValue(r,i);else if(mr(a))n.addValue(r,yd(i,{owner:n}));else if(a!==i)if(n.hasValue(r)){const o=n.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=n.getStaticValue(r);n.addValue(r,yd(o!==void 0?o:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const mD=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class _K{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:a,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=FE,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=Ur.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,rn.render(this.render,!1,!0))};const{latestValues:u,renderState:d}=o;this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=d,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=c,this.blockInitialAnimation=!!a,this.isControllingVariants=ny(t),this.isVariantNode=V4(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...p}=this.scrapeMotionValuesFromProps(t,{},this);for(const m in p){const b=p[m];u[m]!==void 0&&mr(b)&&b.set(u[m])}}mount(e){this.current=e,bK.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),Z4.current||yK(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:T_.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),el(this.notifyUpdate),el(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Bd.has(e);r&&this.onBindTransform&&this.onBindTransform();const i=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&rn.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in bd){const t=bd[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Tn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<mD.length;r++){const i=mD[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const a="on"+i,o=e[a];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=xK(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=yd(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(qO(r)||HO(r))?r=parseFloat(r):!RY(r)&&tl.test(t)&&(r=C4(e,t)),this.setBaseTarget(e,mr(r)?r.get():r)),mr(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let r;if(typeof t=="string"||typeof t=="object"){const a=JE(this.props,t,this.presenceContext?.custom);a&&(r=a[e])}if(t&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!mr(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new DE),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){$E.render(this.render)}}class J4 extends _K{constructor(){super(...arguments),this.KeyframeResolver=vY}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;mr(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function e3(n,{style:e,vars:t},r,i){const a=n.style;let o;for(o in e)a[o]=e[o];i?.applyProjectionStyles(a,r);for(o in t)a.setProperty(o,t[o])}function wK(n){return window.getComputedStyle(n)}class EK extends J4{constructor(){super(...arguments),this.type="html",this.renderInstance=e3}readValueFromInstance(e,t){if(Bd.has(t))return this.projection?.isProjecting?m_(t):jH(e,t);{const r=wK(e),i=(ME(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return Q4(e,t)}build(e,t,r){WE(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return eS(e,t,r)}}const t3=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function SK(n,e,t,r){e3(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(t3.has(i)?i:tS(i),e.attrs[i])}class TK extends J4{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Tn}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Bd.has(t)){const r=A4(t);return r&&r.default||0}return t=t3.has(t)?t:tS(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return q4(e,t,r)}build(e,t,r){B4(e,t,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,t,r,i){SK(e,t,r,i)}mount(e){this.isSVGTag=F4(e.tagName),super.mount(e)}}const AK=(n,e)=>ZE(n)?new TK(e):new EK(e,{allowProjection:n!==U.Fragment});function nd(n,e,t){const r=n.getProps();return JE(r,e,t!==void 0?t:r.custom,n)}const A_=n=>Array.isArray(n);function CK(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,yd(t))}function IK(n){return A_(n)?n[n.length-1]||0:n}function nS(n,e){const t=nd(n,e);let{transitionEnd:r={},transition:i={},...a}=t||{};a={...a,...r};for(const o in a){const c=IK(a[o]);CK(n,o,c)}}function RK(n){return!!(mr(n)&&n.add)}function C_(n,e){const t=n.getValue("willChange");if(RK(t))return t.add(e);if(!t&&Ps.WillChange){const r=new Ps.WillChange("auto");n.addValue("willChange",r),r.add(e)}}function n3(n){return n.props[$4]}const DK=n=>n!==null;function kK(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(DK),a=e&&t!=="loop"&&e%2===1?0:i.length-1;return i[a]}const NK={type:"spring",stiffness:500,damping:25,restSpeed:10},MK=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),PK={type:"keyframes",duration:.8},OK={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},jK=(n,{keyframes:e})=>e.length>2?PK:Bd.has(n)?n.startsWith("scale")?MK(e[1]):NK:OK;function VK({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:a,repeatType:o,repeatDelay:c,from:u,elapsed:d,...h}){return!!Object.keys(h).length}const rS=(n,e,t,r={},i,a)=>o=>{const c=GE(r,n)||{},u=c.delay||r.delay||0;let{elapsed:d=0}=r;d=d-Ua(u);const h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...c,delay:-d,onUpdate:m=>{e.set(m),c.onUpdate&&c.onUpdate(m)},onComplete:()=>{o(),c.onComplete&&c.onComplete()},name:n,motionValue:e,element:a?void 0:i};VK(c)||Object.assign(h,jK(n,h)),h.duration&&(h.duration=Ua(h.duration)),h.repeatDelay&&(h.repeatDelay=Ua(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let p=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(__(h),h.delay===0&&(p=!0)),(Ps.instantAnimations||Ps.skipAnimations)&&(p=!0,__(h),h.delay=0),h.allowFlatten=!c.type&&!c.ease,p&&!a&&e.get()!==void 0){const m=kK(h.keyframes,c);if(m!==void 0){rn.update(()=>{h.onUpdate(m),h.onComplete()});return}}return c.isSync?new UE(h):new aY(h)};function zK({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function r3(n,e,{delay:t=0,transitionOverride:r,type:i}={}){let{transition:a=n.getDefaultTransition(),transitionEnd:o,...c}=e;r&&(a=r);const u=[],d=i&&n.animationState&&n.animationState.getState()[i];for(const h in c){const p=n.getValue(h,n.latestValues[h]??null),m=c[h];if(m===void 0||d&&zK(d,h))continue;const b={delay:t,...GE(a||{},h)},_=p.get();if(_!==void 0&&!p.isAnimating&&!Array.isArray(m)&&m===_&&!b.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const T=n3(n);if(T){const C=window.MotionHandoffAnimation(T,h,rn);C!==null&&(b.startTime=C,w=!0)}}C_(n,h),p.start(rS(h,p,m,n.shouldReduceMotion&&E4.has(h)?{type:!1}:b,n,w));const S=p.animation;S&&u.push(S)}return o&&Promise.all(u).then(()=>{rn.update(()=>{o&&nS(n,o)})}),u}function i3(n,e,t,r=0,i=1){const a=Array.from(n).sort((d,h)=>d.sortNodePosition(h)).indexOf(e),o=n.size,c=(o-1)*r;return typeof t=="function"?t(a,o):i===1?a*r:c-a*r}function I_(n,e,t={}){const r=nd(n,e,t.type==="exit"?n.presenceContext?.custom:void 0);let{transition:i=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(i=t.transitionOverride);const a=r?()=>Promise.all(r3(n,r,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:h,staggerDirection:p}=i;return LK(n,e,u,d,h,p,t)}:()=>Promise.resolve(),{when:c}=i;if(c){const[u,d]=c==="beforeChildren"?[a,o]:[o,a];return u().then(()=>d())}else return Promise.all([a(),o(t.delay)])}function LK(n,e,t=0,r=0,i=0,a=1,o){const c=[];for(const u of n.variantChildren)u.notify("AnimationStart",e),c.push(I_(u,e,{...o,delay:t+(typeof r=="function"?0:r)+i3(n.variantChildren,u,r,i,a)}).then(()=>u.notify("AnimationComplete",e)));return Promise.all(c)}function a3(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(a=>I_(n,a,t));r=Promise.all(i)}else if(typeof e=="string")r=I_(n,e,t);else{const i=typeof e=="function"?nd(n,e,t.custom):e;r=Promise.all(r3(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}function s3(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}const BK=XE.length;function o3(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?o3(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<BK;t++){const r=XE[t],i=n.props[r];(ap(i)||i===!1)&&(e[r]=i)}return e}const UK=[...KE].reverse(),FK=KE.length;function GK(n){return e=>Promise.all(e.map(({animation:t,options:r})=>a3(n,t,r)))}function qK(n){let e=GK(n),t=vD(),r=!0;const i=u=>(d,h)=>{const p=nd(n,h,u==="exit"?n.presenceContext?.custom:void 0);if(p){const{transition:m,transitionEnd:b,..._}=p;d={...d,..._,...b}}return d};function a(u){e=u(n)}function o(u){const{props:d}=n,h=o3(n.parent)||{},p=[],m=new Set;let b={},_=1/0;for(let S=0;S<FK;S++){const T=UK[S],C=t[T],R=d[T]!==void 0?d[T]:h[T],O=ap(R),P=T===u?C.isActive:null;P===!1&&(_=S);let N=R===h[T]&&R!==d[T]&&O;if(N&&r&&n.manuallyAnimateOnMount&&(N=!1),C.protectedKeys={...b},!C.isActive&&P===null||!R&&!C.prevProp||ty(R)||typeof R=="boolean")continue;const A=$K(C.prevProp,R);let I=A||T===u&&C.isActive&&!N&&O||S>_&&O,k=!1;const z=Array.isArray(R)?R:[R];let V=z.reduce(i(T),{});P===!1&&(V={});const{prevResolvedValues:B={}}=C,j={...B,...V},X=W=>{I=!0,m.has(W)&&(k=!0,m.delete(W)),C.needsAnimating[W]=!0;const ee=n.getValue(W);ee&&(ee.liveStyle=!1)};for(const W in j){const ee=V[W],he=B[W];if(b.hasOwnProperty(W))continue;let K=!1;A_(ee)&&A_(he)?K=!s3(ee,he):K=ee!==he,K?ee!=null?X(W):m.add(W):ee!==void 0&&m.has(W)?X(W):C.protectedKeys[W]=!0}C.prevProp=R,C.prevResolvedValues=V,C.isActive&&(b={...b,...V}),r&&n.blockInitialAnimation&&(I=!1);const H=N&&A;I&&(!H||k)&&p.push(...z.map(W=>{const ee={type:T};if(typeof W=="string"&&r&&!H&&n.manuallyAnimateOnMount&&n.parent){const{parent:he}=n,K=nd(he,W);if(he.enteringChildren&&K){const{delayChildren:G}=K.transition||{};ee.delay=i3(he.enteringChildren,n,G)}}return{animation:W,options:ee}}))}if(m.size){const S={};if(typeof d.initial!="boolean"){const T=nd(n,Array.isArray(d.initial)?d.initial[0]:d.initial);T&&T.transition&&(S.transition=T.transition)}m.forEach(T=>{const C=n.getBaseTarget(T),R=n.getValue(T);R&&(R.liveStyle=!0),S[T]=C??null}),p.push({animation:S})}let w=!!p.length;return r&&(d.initial===!1||d.initial===d.animate)&&!n.manuallyAnimateOnMount&&(w=!1),r=!1,w?e(p):Promise.resolve()}function c(u,d){if(t[u].isActive===d)return Promise.resolve();n.variantChildren?.forEach(p=>p.animationState?.setActive(u,d)),t[u].isActive=d;const h=o(u);for(const p in t)t[p].protectedKeys={};return h}return{animateChanges:o,setActive:c,setAnimateFunction:a,getState:()=>t,reset:()=>{t=vD()}}}function $K(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!s3(e,n):!1}function Ul(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function vD(){return{animate:Ul(!0),whileInView:Ul(),whileHover:Ul(),whileTap:Ul(),whileDrag:Ul(),whileFocus:Ul(),exit:Ul()}}class cl{constructor(e){this.isMounted=!1,this.node=e}update(){}}class HK extends cl{constructor(e){super(e),e.animationState||(e.animationState=qK(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();ty(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let YK=0;class KK extends cl{constructor(){super(...arguments),this.id=YK++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const XK={animation:{Feature:HK},exit:{Feature:KK}};function op(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function qp(n){return{point:{x:n.pageX,y:n.pageY}}}const WK=n=>e=>HE(e)&&n(e,qp(e));function Ch(n,e,t,r){return op(n,e,WK(t),r)}const l3=1e-4,QK=1-l3,ZK=1+l3,c3=.01,JK=0-c3,eX=0+c3;function Ir(n){return n.max-n.min}function tX(n,e,t){return Math.abs(n-e)<=t}function yD(n,e,t,r=.5){n.origin=r,n.originPoint=fn(e.min,e.max,n.origin),n.scale=Ir(t)/Ir(e),n.translate=fn(t.min,t.max,n.origin)-n.originPoint,(n.scale>=QK&&n.scale<=ZK||isNaN(n.scale))&&(n.scale=1),(n.translate>=JK&&n.translate<=eX||isNaN(n.translate))&&(n.translate=0)}function Ih(n,e,t,r){yD(n.x,e.x,t.x,r?r.originX:void 0),yD(n.y,e.y,t.y,r?r.originY:void 0)}function bD(n,e,t){n.min=t.min+e.min,n.max=n.min+Ir(e)}function nX(n,e,t){bD(n.x,e.x,t.x),bD(n.y,e.y,t.y)}function xD(n,e,t){n.min=e.min-t.min,n.max=n.min+Ir(e)}function Rh(n,e,t){xD(n.x,e.x,t.x),xD(n.y,e.y,t.y)}function Ti(n){return[n("x"),n("y")]}const u3=({current:n})=>n?n.ownerDocument.defaultView:null,_D=(n,e)=>Math.abs(n-e);function rX(n,e){const t=_D(n.x,e.x),r=_D(n.y,e.y);return Math.sqrt(t**2+r**2)}class d3{constructor(e,t,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:a=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=Zx(this.lastMoveEventInfo,this.history),b=this.startEvent!==null,_=rX(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!b&&!_)return;const{point:w}=m,{timestamp:S}=or;this.history.push({...w,timestamp:S});const{onStart:T,onMove:C}=this.handlers;b||(T&&T(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),C&&C(this.lastMoveEvent,m)},this.handlePointerMove=(m,b)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=Qx(b,this.transformPagePoint),rn.update(this.updatePoint,!0)},this.handlePointerUp=(m,b)=>{this.end();const{onEnd:_,onSessionEnd:w,resumeAnimation:S}=this.handlers;if(this.dragSnapToOrigin&&S&&S(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=Zx(m.type==="pointercancel"?this.lastMoveEventInfo:Qx(b,this.transformPagePoint),this.history);this.startEvent&&_&&_(m,T),w&&w(m,T)},!HE(e))return;this.dragSnapToOrigin=a,this.handlers=t,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=i||window;const c=qp(e),u=Qx(c,this.transformPagePoint),{point:d}=u,{timestamp:h}=or;this.history=[{...d,timestamp:h}];const{onSessionStart:p}=t;p&&p(e,Zx(u,this.history)),this.removeListeners=Up(Ch(this.contextWindow,"pointermove",this.handlePointerMove),Ch(this.contextWindow,"pointerup",this.handlePointerUp),Ch(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),el(this.updatePoint)}}function Qx(n,e){return e?{point:e(n.point)}:n}function wD(n,e){return{x:n.x-e.x,y:n.y-e.y}}function Zx({point:n},e){return{point:n,delta:wD(n,f3(e)),offset:wD(n,iX(e)),velocity:aX(e,.1)}}function iX(n){return n[0]}function f3(n){return n[n.length-1]}function aX(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=f3(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Ua(e)));)t--;if(!r)return{x:0,y:0};const a=Ri(i.timestamp-r.timestamp);if(a===0)return{x:0,y:0};const o={x:(i.x-r.x)/a,y:(i.y-r.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function sX(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?fn(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?fn(t,n,r.max):Math.min(n,t)),n}function ED(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function oX(n,{top:e,left:t,bottom:r,right:i}){return{x:ED(n.x,t,i),y:ED(n.y,e,r)}}function SD(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function lX(n,e){return{x:SD(n.x,e.x),y:SD(n.y,e.y)}}function cX(n,e){let t=.5;const r=Ir(n),i=Ir(e);return i>r?t=np(e.min,e.max-r,n.min):r>i&&(t=np(n.min,n.max-i,e.min)),Ms(0,1,t)}function uX(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const R_=.35;function dX(n=R_){return n===!1?n=0:n===!0&&(n=R_),{x:TD(n,"left","right"),y:TD(n,"top","bottom")}}function TD(n,e,t){return{min:AD(n,e),max:AD(n,t)}}function AD(n,e){return typeof n=="number"?n:n[e]||0}const fX=new WeakMap;class hX{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Tn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:r}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const a=p=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(qp(p).point)},o=(p,m)=>{const{drag:b,dragPropagation:_,onDragStart:w}=this.getProps();if(b&&!_&&(this.openDragLock&&this.openDragLock(),this.openDragLock=_Y(b),!this.openDragLock))return;this.latestPointerEvent=p,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ti(T=>{let C=this.getAxisMotionValue(T).get()||0;if(Fa.test(C)){const{projection:R}=this.visualElement;if(R&&R.layout){const O=R.layout.layoutBox[T];O&&(C=Ir(O)*(parseFloat(C)/100))}}this.originPoint[T]=C}),w&&rn.postRender(()=>w(p,m)),C_(this.visualElement,"transform");const{animationState:S}=this.visualElement;S&&S.setActive("whileDrag",!0)},c=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m;const{dragPropagation:b,dragDirectionLock:_,onDirectionLock:w,onDrag:S}=this.getProps();if(!b&&!this.openDragLock)return;const{offset:T}=m;if(_&&this.currentDirection===null){this.currentDirection=pX(T),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",m.point,T),this.updateAxis("y",m.point,T),this.visualElement.render(),S&&S(p,m)},u=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m,this.stop(p,m),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>Ti(p=>this.getAnimationState(p)==="paused"&&this.getAxisMotionValue(p).animation?.play()),{dragSnapToOrigin:h}=this.getProps();this.panSession=new d3(e,{onSessionStart:a,onStart:o,onMove:c,onSessionEnd:u,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,distanceThreshold:r,contextWindow:u3(this.visualElement)})}stop(e,t){const r=e||this.latestPointerEvent,i=t||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!i||!r)return;const{velocity:o}=i;this.startAnimation(o);const{onDragEnd:c}=this.getProps();c&&rn.postRender(()=>c(r,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!Vm(e,i,this.currentDirection))return;const a=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=sX(o,this.constraints[e],this.elastic[e])),a.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:t}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,i=this.constraints;e&&Uu(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=oX(r.layoutBox,e):this.constraints=!1,this.elastic=dX(t),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Ti(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=uX(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Uu(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const a=vK(r,i.root,this.visualElement.getTransformPagePoint());let o=lX(i.layout.layoutBox,a);if(t){const c=t(pK(o));this.hasMutatedConstraints=!!c,c&&(o=K4(c))}return o}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:c}=this.getProps(),u=this.constraints||{},d=Ti(h=>{if(!Vm(h,t,this.currentDirection))return;let p=u&&u[h]||{};o&&(p={min:0,max:0});const m=i?200:1e6,b=i?40:1e7,_={type:"inertia",velocity:r?e[h]:0,bounceStiffness:m,bounceDamping:b,timeConstant:750,restDelta:1,restSpeed:10,...a,...p};return this.startAxisValueAnimation(h,_)});return Promise.all(d).then(c)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return C_(this.visualElement,e),r.start(rS(e,r,0,t,this.visualElement,!1))}stopAnimation(){Ti(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Ti(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Ti(t=>{const{drag:r}=this.getProps();if(!Vm(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,a=this.getAxisMotionValue(t);if(i&&i.layout){const{min:o,max:c}=i.layout.layoutBox[t];a.set(e[t]-fn(o,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!Uu(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Ti(o=>{const c=this.getAxisMotionValue(o);if(c&&this.constraints!==!1){const u=c.get();i[o]=cX({min:u,max:u},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Ti(o=>{if(!Vm(o,e,null))return;const c=this.getAxisMotionValue(o),{min:u,max:d}=this.constraints[o];c.set(fn(u,d,i[o]))})}addListeners(){if(!this.visualElement.current)return;fX.set(this.visualElement,this);const e=this.visualElement.current,t=Ch(e,"pointerdown",u=>{const{drag:d,dragListener:h=!0}=this.getProps();d&&h&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();Uu(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,a=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),rn.read(r);const o=op(window,"resize",()=>this.scalePositionWithinConstraints()),c=i.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:d})=>{this.isDragging&&d&&(Ti(h=>{const p=this.getAxisMotionValue(h);p&&(this.originPoint[h]+=u[h].translate,p.set(p.get()+u[h].translate))}),this.visualElement.render())}));return()=>{o(),t(),a(),c&&c()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:a=!1,dragElastic:o=R_,dragMomentum:c=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:a,dragElastic:o,dragMomentum:c}}}function Vm(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function pX(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class gX extends cl{constructor(e){super(e),this.removeGroupControls=ki,this.removeListeners=ki,this.controls=new hX(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ki}unmount(){this.removeGroupControls(),this.removeListeners()}}const CD=n=>(e,t)=>{n&&rn.postRender(()=>n(e,t))};class mX extends cl{constructor(){super(...arguments),this.removePointerDownListener=ki}onPointerDown(e){this.session=new d3(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:u3(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:CD(e),onStart:CD(t),onMove:r,onEnd:(a,o)=>{delete this.session,i&&rn.postRender(()=>i(a,o))}}}mount(){this.removePointerDownListener=Ch(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const b0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function ID(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const eh={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(nt.test(n))n=parseFloat(n);else return n;const t=ID(n,e.target.x),r=ID(n,e.target.y);return`${t}% ${r}%`}},vX={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=tl.parse(n);if(i.length>5)return r;const a=tl.createTransformer(n),o=typeof i[0]!="number"?1:0,c=t.x.scale*e.x,u=t.y.scale*e.y;i[0+o]/=c,i[1+o]/=u;const d=fn(c,u,.5);return typeof i[2+o]=="number"&&(i[2+o]/=d),typeof i[3+o]=="number"&&(i[3+o]/=d),a(i)}};let Jx=!1;class yX extends U.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:a}=e;FY(bX),a&&(t.group&&t.group.add(a),r&&r.register&&i&&r.register(a),Jx&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),b0.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:a}=this.props,{projection:o}=r;return o&&(o.isPresent=a,Jx=!0,i||e.layoutDependency!==t||t===void 0||e.isPresent!==a?o.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?o.promote():o.relegate()||rn.postRender(()=>{const c=o.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),$E.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;Jx=!0,i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function h3(n){const[e,t]=P4(),r=U.useContext(EE);return v.jsx(yX,{...n,layoutGroup:r,switchLayoutGroup:U.useContext(H4),isPresent:e,safeToRemove:t})}const bX={borderRadius:{...eh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:eh,borderTopRightRadius:eh,borderBottomLeftRadius:eh,borderBottomRightRadius:eh,boxShadow:vX};function xX(n,e,t){const r=mr(n)?n:yd(n);return r.start(rS("",r,e,t)),r.animation}const _X=(n,e)=>n.depth-e.depth;class wX{constructor(){this.children=[],this.isDirty=!1}add(e){AE(this.children,e),this.isDirty=!0}remove(e){CE(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(_X),this.isDirty=!1,this.children.forEach(e)}}function EX(n,e){const t=Ur.now(),r=({timestamp:i})=>{const a=i-t;a>=e&&(el(r),n(a-e))};return rn.setup(r,!0),()=>el(r)}const p3=["TopLeft","TopRight","BottomLeft","BottomRight"],SX=p3.length,RD=n=>typeof n=="string"?parseFloat(n):n,DD=n=>typeof n=="number"||nt.test(n);function TX(n,e,t,r,i,a){i?(n.opacity=fn(0,t.opacity??1,AX(r)),n.opacityExit=fn(e.opacity??1,0,CX(r))):a&&(n.opacity=fn(e.opacity??1,t.opacity??1,r));for(let o=0;o<SX;o++){const c=`border${p3[o]}Radius`;let u=kD(e,c),d=kD(t,c);if(u===void 0&&d===void 0)continue;u||(u=0),d||(d=0),u===0||d===0||DD(u)===DD(d)?(n[c]=Math.max(fn(RD(u),RD(d),r),0),(Fa.test(d)||Fa.test(u))&&(n[c]+="%")):n[c]=d}(e.rotate||t.rotate)&&(n.rotate=fn(e.rotate||0,t.rotate||0,r))}function kD(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const AX=g3(0,.5,e4),CX=g3(.5,.95,ki);function g3(n,e,t){return r=>r<n?0:r>e?1:t(np(n,e,r))}function ND(n,e){n.min=e.min,n.max=e.max}function Ei(n,e){ND(n.x,e.x),ND(n.y,e.y)}function MD(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function PD(n,e,t,r,i){return n-=e,n=iv(n,1/t,r),i!==void 0&&(n=iv(n,1/i,r)),n}function IX(n,e=0,t=1,r=.5,i,a=n,o=n){if(Fa.test(e)&&(e=parseFloat(e),e=fn(o.min,o.max,e/100)-o.min),typeof e!="number")return;let c=fn(a.min,a.max,r);n===a&&(c-=e),n.min=PD(n.min,e,t,c,i),n.max=PD(n.max,e,t,c,i)}function OD(n,e,[t,r,i],a,o){IX(n,e[t],e[r],e[i],e.scale,a,o)}const RX=["x","scaleX","originX"],DX=["y","scaleY","originY"];function jD(n,e,t,r){OD(n.x,e,RX,t?t.x:void 0,r?r.x:void 0),OD(n.y,e,DX,t?t.y:void 0,r?r.y:void 0)}function VD(n){return n.translate===0&&n.scale===1}function m3(n){return VD(n.x)&&VD(n.y)}function zD(n,e){return n.min===e.min&&n.max===e.max}function kX(n,e){return zD(n.x,e.x)&&zD(n.y,e.y)}function LD(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function v3(n,e){return LD(n.x,e.x)&&LD(n.y,e.y)}function BD(n){return Ir(n.x)/Ir(n.y)}function UD(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class NX{constructor(){this.members=[]}add(e){AE(this.members,e),e.scheduleRender()}remove(e){if(CE(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const a=this.members[i];if(a.isPresent!==!1){r=a;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function MX(n,e,t){let r="";const i=n.x.translate/e.x,a=n.y.translate/e.y,o=t?.z||0;if((i||a||o)&&(r=`translate3d(${i}px, ${a}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:d,rotate:h,rotateX:p,rotateY:m,skewX:b,skewY:_}=t;d&&(r=`perspective(${d}px) ${r}`),h&&(r+=`rotate(${h}deg) `),p&&(r+=`rotateX(${p}deg) `),m&&(r+=`rotateY(${m}deg) `),b&&(r+=`skewX(${b}deg) `),_&&(r+=`skewY(${_}deg) `)}const c=n.x.scale*e.x,u=n.y.scale*e.y;return(c!==1||u!==1)&&(r+=`scale(${c}, ${u})`),r||"none"}const e1=["","X","Y","Z"],PX=1e3;let OX=0;function t1(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function y3(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=n3(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:a}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",rn,!(i||a))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&y3(r)}function b3({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},c=e?.()){this.id=OX++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(zX),this.nodes.forEach(FX),this.nodes.forEach(GX),this.nodes.forEach(LX)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new wX)}addEventListener(o,c){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new DE),this.eventHandlers.get(o).add(c)}notifyListeners(o,...c){const u=this.eventHandlers.get(o);u&&u.notify(...c)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=M4(o)&&!CY(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(u||c)&&(this.isLayoutDirty=!0),n){let h,p=0;const m=()=>this.root.updateBlockedByResize=!1;rn.read(()=>{p=window.innerWidth}),n(o,()=>{const b=window.innerWidth;b!==p&&(p=b,this.root.updateBlockedByResize=!0,h&&h(),h=EX(m,250),b0.hasAnimatedSinceResize&&(b0.hasAnimatedSinceResize=!1,this.nodes.forEach(qD)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:p,hasRelativeLayoutChanged:m,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||d.getDefaultTransition()||KX,{onLayoutAnimationStart:w,onLayoutAnimationComplete:S}=d.getProps(),T=!this.targetLayout||!v3(this.targetLayout,b),C=!p&&m;if(this.options.layoutRoot||this.resumeFrom||C||p&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const R={...GE(_,"layout"),onPlay:w,onComplete:S};(d.shouldReduceMotion||this.options.layoutRoot)&&(R.delay=0,R.type=!1),this.startAnimation(R),this.setAnimationOrigin(h,C)}else p||qD(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),el(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(qX),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&y3(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const p=this.path[h];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:c,layout:u}=this.options;if(c===void 0&&!u)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(FD);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(GD);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(UX),this.nodes.forEach(jX),this.nodes.forEach(VX)):this.nodes.forEach(GD),this.clearAllSnapshots();const c=Ur.now();or.delta=Ms(0,1e3/60,c-or.timestamp),or.timestamp=c,or.isProcessing=!0,Gx.update.process(or),Gx.preRender.process(or),Gx.render.process(or),or.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,$E.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(BX),this.sharedNodes.forEach($X)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,rn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){rn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Ir(this.snapshot.measuredBox.x)&&!Ir(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Tn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(c=!1),c&&this.instance){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!m3(this.projectionDelta),u=this.getTransformTemplate(),d=u?u(this.latestValues,""):void 0,h=d!==this.prevTransformTemplateValue;o&&this.instance&&(c||Hl(this.latestValues)||h)&&(i(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const c=this.measurePageBox();let u=this.removeElementScroll(c);return o&&(u=this.removeTransform(u)),XX(u),{animationId:this.root.animationId,measuredBox:c,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return Tn();const c=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(WX))){const{scroll:d}=this.root;d&&(Fu(c.x,d.offset.x),Fu(c.y,d.offset.y))}return c}removeElementScroll(o){const c=Tn();if(Ei(c,o),this.scroll?.wasRoot)return c;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:h,options:p}=d;d!==this.root&&h&&p.layoutScroll&&(h.wasRoot&&Ei(c,o),Fu(c.x,h.offset.x),Fu(c.y,h.offset.y))}return c}applyTransform(o,c=!1){const u=Tn();Ei(u,o);for(let d=0;d<this.path.length;d++){const h=this.path[d];!c&&h.options.layoutScroll&&h.scroll&&h!==h.root&&Gu(u,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Hl(h.latestValues)&&Gu(u,h.latestValues)}return Hl(this.latestValues)&&Gu(u,this.latestValues),u}removeTransform(o){const c=Tn();Ei(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];if(!d.instance||!Hl(d.latestValues))continue;E_(d.latestValues)&&d.updateSnapshot();const h=Tn(),p=d.measurePageBox();Ei(h,p),jD(c,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,h)}return Hl(this.latestValues)&&jD(c,this.latestValues),c}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==or.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:p}=this.options;if(!(!this.layout||!(h||p))){if(this.resolvedRelativeTargetAt=or.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Tn(),this.relativeTargetOrigin=Tn(),Rh(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Ei(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Tn(),this.targetWithTransforms=Tn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),nX(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ei(this.target,this.layout.layoutBox),W4(this.target,this.targetDelta)):Ei(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Tn(),this.relativeTargetOrigin=Tn(),Rh(this.relativeTargetOrigin,this.target,m.target),Ei(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||E_(this.parent.latestValues)||X4(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const o=this.getLead(),c=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===or.timestamp&&(u=!1),u)return;const{layout:d,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||h))return;Ei(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,m=this.treeScale.y;mK(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Tn());const{target:b}=o;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(MD(this.prevProjectionDelta.x,this.projectionDelta.x),MD(this.prevProjectionDelta.y,this.projectionDelta.y)),Ih(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==m||!UD(this.projectionDelta.x,this.prevProjectionDelta.x)||!UD(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=qu(),this.projectionDelta=qu(),this.projectionDeltaWithTransform=qu()}setAnimationOrigin(o,c=!1){const u=this.snapshot,d=u?u.latestValues:{},h={...this.latestValues},p=qu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const m=Tn(),b=u?u.source:void 0,_=this.layout?this.layout.source:void 0,w=b!==_,S=this.getStack(),T=!S||S.members.length<=1,C=!!(w&&!T&&this.options.crossfade===!0&&!this.path.some(YX));this.animationProgress=0;let R;this.mixTargetDelta=O=>{const P=O/1e3;$D(p.x,o.x,P),$D(p.y,o.y,P),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Rh(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),HX(this.relativeTarget,this.relativeTargetOrigin,m,P),R&&kX(this.relativeTarget,R)&&(this.isProjectionDirty=!1),R||(R=Tn()),Ei(R,this.relativeTarget)),w&&(this.animationValues=h,TX(h,d,this.latestValues,P,C,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=P},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(el(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=rn.update(()=>{b0.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=yd(0)),this.currentAnimation=xX(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:c=>{this.mixTargetDelta(c),o.onUpdate&&o.onUpdate(c)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(PX),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:c,target:u,layout:d,latestValues:h}=o;if(!(!c||!u||!d)){if(this!==o&&this.layout&&d&&x3(this.options.animationType,this.layout.layoutBox,d.layoutBox)){u=this.target||Tn();const p=Ir(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const m=Ir(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+m}Ei(c,u),Gu(c,h),Ih(this.projectionDeltaWithTransform,this.layoutCorrected,c,h)}}registerSharedNode(o,c){this.sharedNodes.has(o)||this.sharedNodes.set(o,new NX),this.sharedNodes.get(o).add(c);const d=c.options.initialPromotionConfig;c.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(c):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:c,preserveFollowOpacity:u}={}){const d=this.getStack();d&&d.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let c=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(c=!0),!c)return;const d={};u.z&&t1("z",o,d,this.animationValues);for(let h=0;h<e1.length;h++)t1(`rotate${e1[h]}`,o,d,this.animationValues),t1(`skew${e1[h]}`,o,d,this.animationValues);o.render();for(const h in d)o.setStaticValue(h,d[h]),this.animationValues&&(this.animationValues[h]=d[h]);o.scheduleRender()}applyProjectionStyles(o,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const u=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=y0(c?.pointerEvents)||"",o.transform=u?u(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=y0(c?.pointerEvents)||""),this.hasProjected&&!Hl(this.latestValues)&&(o.transform=u?u({},""):"none",this.hasProjected=!1);return}o.visibility="";const h=d.animationValues||d.latestValues;this.applyTransformsToTarget();let p=MX(this.projectionDeltaWithTransform,this.treeScale,h);u&&(p=u(h,p)),o.transform=p;const{x:m,y:b}=this.projectionDelta;o.transformOrigin=`${m.origin*100}% ${b.origin*100}% 0`,d.animationValues?o.opacity=d===this?h.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:o.opacity=d===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const _ in sp){if(h[_]===void 0)continue;const{correct:w,applyTo:S,isCSSVariable:T}=sp[_],C=p==="none"?h[_]:w(h[_],d);if(S){const R=S.length;for(let O=0;O<R;O++)o[S[O]]=C}else T?this.options.visualElement.renderState.vars[_]=C:o[_]=C}this.options.layoutId&&(o.pointerEvents=d===this?y0(c?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(FD),this.root.sharedNodes.clear()}}}function jX(n){n.updateLayout()}function VX(n){const e=n.resumeFrom?.snapshot||n.snapshot;if(n.isLead()&&n.layout&&e&&n.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:r}=n.layout,{animationType:i}=n.options,a=e.source!==n.layout.source;i==="size"?Ti(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=Ir(p);p.min=t[h].min,p.max=p.min+m}):x3(i,e.layoutBox,t)&&Ti(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=Ir(t[h]);p.max=p.min+m,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[h].max=n.relativeTarget[h].min+m)});const o=qu();Ih(o,t,e.layoutBox);const c=qu();a?Ih(c,n.applyTransform(r,!0),e.measuredBox):Ih(c,t,e.layoutBox);const u=!m3(o);let d=!1;if(!n.resumeFrom){const h=n.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:p,layout:m}=h;if(p&&m){const b=Tn();Rh(b,e.layoutBox,p.layoutBox);const _=Tn();Rh(_,t,m.layoutBox),v3(b,_)||(d=!0),h.options.layoutRoot&&(n.relativeTarget=_,n.relativeTargetOrigin=b,n.relativeParent=h)}}}n.notifyListeners("didUpdate",{layout:t,snapshot:e,delta:c,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(n.isLead()){const{onExitComplete:t}=n.options;t&&t()}n.options.transition=void 0}function zX(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function LX(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function BX(n){n.clearSnapshot()}function FD(n){n.clearMeasurements()}function GD(n){n.isLayoutDirty=!1}function UX(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function qD(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function FX(n){n.resolveTargetDelta()}function GX(n){n.calcProjection()}function qX(n){n.resetSkewAndRotation()}function $X(n){n.removeLeadSnapshot()}function $D(n,e,t){n.translate=fn(e.translate,0,t),n.scale=fn(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function HD(n,e,t,r){n.min=fn(e.min,t.min,r),n.max=fn(e.max,t.max,r)}function HX(n,e,t,r){HD(n.x,e.x,t.x,r),HD(n.y,e.y,t.y,r)}function YX(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const KX={duration:.45,ease:[.4,0,.1,1]},YD=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),KD=YD("applewebkit/")&&!YD("chrome/")?Math.round:ki;function XD(n){n.min=KD(n.min),n.max=KD(n.max)}function XX(n){XD(n.x),XD(n.y)}function x3(n,e,t){return n==="position"||n==="preserve-aspect"&&!tX(BD(e),BD(t),.2)}function WX(n){return n!==n.root&&n.scroll?.wasRoot}const QX=b3({attachResizeListener:(n,e)=>op(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),n1={current:void 0},_3=b3({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!n1.current){const n=new QX({});n.mount(window),n.setOptions({layoutScroll:!0}),n1.current=n}return n1.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),ZX={pan:{Feature:mX},drag:{Feature:gX,ProjectionNode:_3,MeasureLayout:h3}};function WD(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,a=r[i];a&&rn.postRender(()=>a(e,qp(e)))}class JX extends cl{mount(){const{current:e}=this.node;e&&(this.unmount=wY(e,(t,r)=>(WD(this.node,r,"Start"),i=>WD(this.node,i,"End"))))}unmount(){}}class eW extends cl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Up(op(this.node.current,"focus",()=>this.onFocus()),op(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function QD(n,e,t){const{props:r}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),a=r[i];a&&rn.postRender(()=>a(e,qp(e)))}class tW extends cl{mount(){const{current:e}=this.node;e&&(this.unmount=AY(e,(t,r)=>(QD(this.node,r,"Start"),(i,{success:a})=>QD(this.node,i,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const D_=new WeakMap,r1=new WeakMap,nW=n=>{const e=D_.get(n.target);e&&e(n)},rW=n=>{n.forEach(nW)};function iW({root:n,...e}){const t=n||document;r1.has(t)||r1.set(t,{});const r=r1.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(rW,{root:n,...e})),r[i]}function aW(n,e,t){const r=iW(e);return D_.set(n,t),r.observe(n),()=>{D_.delete(n),r.unobserve(n)}}const sW={some:0,all:1};class oW extends cl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:a}=e,o={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:sW[i]},c=u=>{const{isIntersecting:d}=u;if(this.isInView===d||(this.isInView=d,a&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:h,onViewportLeave:p}=this.node.getProps(),m=d?h:p;m&&m(u)};return aW(this.node.current,o,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(lW(e,t))&&this.startObserver()}unmount(){}}function lW({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const cW={inView:{Feature:oW},tap:{Feature:tW},focus:{Feature:eW},hover:{Feature:JX}},uW={layout:{ProjectionNode:_3,MeasureLayout:h3}},dW={...XK,...cW,...ZX,...uW},xn=hK(dW,AK);function fW(n){n.values.forEach(e=>e.stop())}function k_(n,e){[...e].reverse().forEach(r=>{const i=n.getVariant(r);i&&nS(n,i),n.variantChildren&&n.variantChildren.forEach(a=>{k_(a,e)})})}function hW(n,e){if(Array.isArray(e))return k_(n,e);if(typeof e=="string")return k_(n,[e]);nS(n,e)}function pW(){const n=new Set,e={subscribe(t){return n.add(t),()=>void n.delete(t)},start(t,r){const i=[];return n.forEach(a=>{i.push(a3(a,t,{transitionOverride:r}))}),Promise.all(i)},set(t){return n.forEach(r=>{hW(r,t)})},stop(){n.forEach(t=>{fW(t)})},mount(){return()=>{e.stop()}}};return e}function gW(){const n=Zv(pW);return TE(n.mount,[]),n}const mW=gW,jc=gw((n,e)=>({message:"",type:"neutral",isVisible:!1,undoAction:void 0,showToast:(t,r="neutral",i)=>{n({message:t,type:r,isVisible:!0,undoAction:i}),setTimeout(()=>{e().hideToast()},2e3)},hideToast:()=>{n({isVisible:!1})}})),vW=()=>{const{message:n,type:e,isVisible:t,undoAction:r,hideToast:i}=jc(),a=()=>{switch(e){case"success":return"bg-green-500 dark:bg-green-600 text-white";case"error":return"bg-red-500 dark:bg-red-600 text-white";case"neutral":default:return"bg-gray-800 dark:bg-gray-900 text-white border border-gray-200 dark:border-gray-700"}};return v.jsx(ci,{children:t&&v.jsx(xn.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-24 right-6 z-[110] max-w-xs",children:v.jsxs("div",{className:`rounded-lg shadow-lg p-3 flex items-center justify-between ${a()}`,children:[v.jsx("div",{className:"flex items-center flex-1 min-w-0",children:v.jsx("span",{className:"text-xs font-medium whitespace-pre-line pr-2",children:n})}),v.jsxs("div",{className:"flex items-center gap-1 ml-2 flex-shrink-0",children:[r&&v.jsxs("button",{onClick:()=>{r(),i()},className:"px-2 py-1 bg-white/20 hover:bg-white/30 rounded text-xs font-bold transition-colors",children:[v.jsx(N9,{size:12,className:"inline mr-1"}),"Undo"]}),v.jsx("button",{onClick:i,className:"p-0.5 hover:bg-black/10 dark:hover:bg-white/10 rounded-full transition-colors",children:v.jsx(Sv,{size:14})})]})]})})})};class Ki extends U.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t),this.setState({error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t)}componentDidUpdate(e){this.props.resetKeys&&this.props.resetOnPropsChange&&this.props.resetKeys.some((r,i)=>r!==e.resetKeys?.[i])&&this.state.hasError&&this.resetErrorBoundary()}resetErrorBoundary=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[v.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 dark:bg-red-900/30 rounded-full",children:v.jsx(Qu,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white text-center mb-2",children:"Something went wrong"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-6",children:"We're sorry, but something unexpected happened. You can try refreshing or going back to the home screen."}),!1,v.jsxs("div",{className:"flex flex-col gap-3",children:[v.jsxs("button",{onClick:this.resetErrorBoundary,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors",children:[v.jsx(Vh,{className:"h-4 w-4"}),"Try Again"]}),v.jsxs("button",{onClick:()=>window.location.href="/#/",className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white font-medium rounded-md transition-colors",children:[v.jsx(n9,{className:"h-4 w-4"}),"Go to Home"]})]})]})}):this.props.children}}const yW=({onAddTransaction:n})=>{const e=Ka(),t=ca(),[r,i]=U.useState(!1),a=U.useRef(null),o=d=>t.pathname===d;U.useEffect(()=>{const d=h=>{a.current&&!a.current.contains(h.target)&&i(!1)};if(r)return document.addEventListener("mousedown",d),document.addEventListener("touchstart",d),()=>{document.removeEventListener("mousedown",d),document.removeEventListener("touchstart",d)}},[r]);const c=[{path:"/reports",icon:v.jsx(TL,{className:"w-5 h-5"}),label:"Reports"},{path:"/analytics",icon:v.jsx(A0,{className:"w-5 h-5"}),label:"Analytics"},{path:"/budget-breakdown",icon:v.jsx(CL,{className:"w-5 h-5"}),label:"Budget Breakdown"}],u=({path:d,icon:h,label:p})=>{const m=o(d);return v.jsxs("button",{onClick:b=>{b.stopPropagation(),e(d)},className:`
          relative group flex flex-col items-center justify-center
          w-12 h-12 rounded-2xl transition-all duration-300
          ${m?"text-blue-500 bg-blue-50 dark:bg-blue-500/20 dark:text-blue-400":"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-800"}
        `,children:[v.jsx("div",{className:`transition-transform duration-300 ${m?"scale-110":"group-hover:scale-105"}`,children:h}),v.jsx("span",{className:"sr-only",children:p}),m&&v.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-current rounded-full opacity-80"})]})};return v.jsx("div",{className:"fixed bottom-6 left-0 right-0 flex justify-center z-[100] pointer-events-none safe-area-inset-bottom",children:v.jsxs("nav",{className:`
          pointer-events-auto
          flex items-center gap-1 p-2 pl-4 pr-4
          bg-white/60 dark:bg-zinc-900/60 backdrop-blur-xl
          border border-zinc-200/30 dark:border-zinc-800/30
          rounded-full shadow-2xl shadow-zinc-900/10
          transform transition-all duration-500 ease-out
        `,onClick:d=>d.stopPropagation(),onTouchStart:d=>d.stopPropagation(),onTouchEnd:d=>d.stopPropagation(),children:[v.jsx(u,{path:"/",label:"Budget",icon:v.jsx(Ev,{className:"w-6 h-6"})}),v.jsx(u,{path:"/transactions",label:"Transactions",icon:v.jsx(i9,{className:"w-6 h-6"})}),v.jsx("div",{className:"w-px h-8 bg-zinc-200 dark:bg-zinc-800 mx-2"}),v.jsx("button",{onClick:d=>{if(d.stopPropagation(),i(!1),n){n();return}e("/add-transaction")},className:`
            -mt-8 mb-2 mx-1
            group relative flex items-center justify-center
            w-16 h-16 rounded-full
            bg-blue-600 text-white
            shadow-xl shadow-blue-600/30
            hover:shadow-blue-600/50 hover:scale-105 hover:-translate-y-1
            active:scale-95 active:translate-y-0
            transition-all duration-300 cubic-bezier(0.175, 0.885, 0.32, 1.275)
          `,children:v.jsx(bp,{className:"w-8 h-8 transition-transform duration-300 group-hover:rotate-90"})}),v.jsx("div",{className:"w-px h-8 bg-zinc-200 dark:bg-zinc-800 mx-2"}),v.jsxs("div",{className:"relative",ref:a,children:[v.jsxs("button",{onClick:d=>{d.stopPropagation(),i(!r)},className:`
              relative group flex flex-col items-center justify-center
              w-12 h-12 rounded-2xl transition-all duration-300
              ${r?"text-blue-500 bg-blue-50 dark:bg-blue-500/20 dark:text-blue-400":"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-800"}
            `,children:[v.jsx("div",{className:`transition-transform duration-300 ${r?"scale-110":"group-hover:scale-105"}`,children:v.jsx(GL,{className:"w-6 h-6"})}),v.jsx("span",{className:"sr-only",children:"More"}),r&&v.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-current rounded-full opacity-80"})]}),r&&v.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-56 bg-white dark:bg-zinc-900 rounded-2xl shadow-2xl border border-zinc-200/50 dark:border-zinc-800/50 backdrop-blur-xl z-50 overflow-hidden",onClick:d=>d.stopPropagation(),onTouchStart:d=>d.stopPropagation(),onTouchEnd:d=>d.stopPropagation(),children:v.jsx("div",{className:"p-2 space-y-1",children:c.map((d,h)=>v.jsxs("button",{onClick:p=>{p.stopPropagation(),e(d.path),i(!1)},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[v.jsx("div",{className:"text-zinc-600 dark:text-zinc-400",children:d.icon}),v.jsx("span",{className:"text-sm font-medium text-zinc-900 dark:text-white",children:d.label})]},h))})})]}),v.jsx(u,{path:"/settings",label:"Settings",icon:v.jsx(_9,{className:"w-6 h-6"})})]})})};function bW(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.map(function(r){return r.split(" ").map(function(i){return i?""+n+i:""}).join(" ")}).join(" ")}function xW(n,e){return e.replace(/([^}{]*){/gm,function(t,r){return r.replace(/\.([^{,\s\d.]+)/g,"."+n+"$1")+"{"})}function Ts(n,e){return function(t){t&&(n[e]=t)}}function w3(n,e,t){return function(r){r&&(n[e][t]=r)}}function ZD(n,e){return function(t){var r=t.prototype;n.forEach(function(i){e(r,i)})}}function _W(n,e){return e===void 0&&(e={}),function(t,r){n.forEach(function(i){var a=e[i]||i;a in t||(t[a]=function(){for(var o,c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];var d=(o=this[r])[i].apply(o,c);return d===this[r]?this:d})})}}var wW="function",EW="object",SW="string",TW="number",iS="undefined",E3=typeof window!==iS,AW=typeof document!==iS&&document,CW=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],Ln=1e-7,zm={cm:function(n){return n*96/2.54},mm:function(n){return n*96/254},in:function(n){return n*96},pt:function(n){return n*96/72},pc:function(n){return n*96/6},"%":function(n,e){return n*e/100},vw:function(n,e){return e===void 0&&(e=window.innerWidth),n/100*e},vh:function(n,e){return e===void 0&&(e=window.innerHeight),n/100*e},vmax:function(n,e){return e===void 0&&(e=Math.max(window.innerWidth,window.innerHeight)),n/100*e},vmin:function(n,e){return e===void 0&&(e=Math.min(window.innerWidth,window.innerHeight)),n/100*e}};function IW(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}function av(n,e,t,r){return(n*r+e*t)/(t+r)}function ry(n){return typeof n===iS}function oa(n){return n&&typeof n===EW}function Fn(n){return Array.isArray(n)}function Fr(n){return typeof n===SW}function xd(n){return typeof n===TW}function aS(n){return typeof n===wW}function RW(n,e){var t=n===""||n==" ",r=e===""||e==" ";return r&&t||n===e}function S3(n,e,t,r,i){var a=sS(n,e,t);return a?t:DW(n,e,t+1,r,i)}function sS(n,e,t){if(!n.ignore)return null;var r=e.slice(Math.max(t-3,0),t+3).join("");return new RegExp(n.ignore).exec(r)}function DW(n,e,t,r,i){for(var a=function(d){var h=e[d].trim();if(h===n.close&&!sS(n,e,d))return{value:d};var p=d,m=Gr(i,function(b){var _=b.open;return _===h});if(m&&(p=S3(m,e,d,r,i)),p===-1)return o=d,"break";d=p,o=d},o,c=t;c<r;++c){var u=a(c);if(c=o,typeof u=="object")return u.value;if(u==="break")break}return-1}function oS(n,e){var t=Fr(e)?{separator:e}:e,r=t.separator,i=r===void 0?",":r,a=t.isSeparateFirst,o=t.isSeparateOnlyOpenClose,c=t.isSeparateOpenClose,u=c===void 0?o:c,d=t.openCloseCharacters,h=d===void 0?CW:d,p=h.map(function(A){var I=A.open,k=A.close;return I===k?I:I+"|"+k}).join("|"),m="(\\s*"+i+"\\s*|"+p+"|\\s+)",b=new RegExp(m,"g"),_=n.split(b).filter(function(A){return A&&A!=="undefined"}),w=_.length,S=[],T=[];function C(){return T.length?(S.push(T.join("")),T=[],!0):!1}for(var R=function(A){var I=_[A].trim(),k=A,z=Gr(h,function(j){var X=j.open;return X===I}),V=Gr(h,function(j){var X=j.close;return X===I});if(z){if(k=S3(z,_,A,w,h),k!==-1&&u)return C()&&a||(S.push(_.slice(A,k+1).join("")),A=k,a)?(O=A,"break"):(O=A,"continue")}else if(V&&!sS(V,_,A)){var B=IW(h);return B.splice(h.indexOf(V),1),{value:oS(n,{separator:i,isSeparateFirst:a,isSeparateOnlyOpenClose:o,isSeparateOpenClose:u,openCloseCharacters:B})}}else if(RW(I,i)&&!o)return C(),a?(O=A,"break"):(O=A,"continue");k===-1&&(k=w-1),T.push(_.slice(A,k+1).join("")),A=k,O=A},O,P=0;P<w;++P){var N=R(P);if(P=O,typeof N=="object")return N.value;if(N==="break")break}return T.length&&S.push(T.join("")),S}function nl(n){return oS(n,"")}function ac(n){return oS(n,",")}function T3(n){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(n);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function $p(n){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(n);if(!e)return{prefix:"",unit:"",value:NaN};var t=e[1],r=e[2],i=e[3];return{prefix:t,unit:i,value:parseFloat(r)}}function kW(n){return n.replace(/[\s-_]+([^\s-_])/g,function(e,t){return t.toUpperCase()})}function x0(n,e){return n.replace(/([a-z])([A-Z])/g,function(t,r,i){return""+r+e+i.toLowerCase()})}function lp(){return Date.now?Date.now():new Date().getTime()}function Os(n,e,t){t===void 0&&(t=-1);for(var r=n.length,i=0;i<r;++i)if(e(n[i],i,n))return i;return t}function Gr(n,e,t){var r=Os(n,e);return r>-1?n[r]:t}var A3=(function(){var n=lp(),e=E3&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(t){var r=lp(),i=setTimeout(function(){t(r-n)},1e3/60);return i}})(),NW=(function(){var n=E3&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return n?n.bind(window):function(e){clearTimeout(e)}})();function js(n){return Object.keys(n)}function MW(n){var e=js(n);return e.map(function(t){return n[t]})}function Ht(n,e){var t=$p(n),r=t.value,i=t.unit;if(oa(e)){var a=e[i];if(a){if(aS(a))return a(r);if(zm[i])return zm[i](r,a)}}else if(i==="%")return r*e/100;return zm[i]?zm[i](r):r}function N_(n,e,t){return Math.max(e,Math.min(n,t))}function JD(n,e,t,r){return r===void 0&&(r=n[0]/n[1]),[[at(e[0],Ln),at(e[0]/r,Ln)],[at(e[1]*r,Ln),at(e[1],Ln)]].filter(function(i){return i.every(function(a,o){var c=e[o],u=at(c,Ln);return t?a<=c||a<=u:a>=c||a>=u})})[0]||n}function C3(n,e,t,r){if(!r)return n.map(function(b,_){return N_(b,e[_],t[_])});var i=n[0],a=n[1],o=r===!0?i/a:r,c=JD(n,e,!1,o),u=c[0],d=c[1],h=JD(n,t,!0,o),p=h[0],m=h[1];return i<u||a<d?(i=u,a=d):(i>p||a>m)&&(i=p,a=m),[i,a]}function PW(n){for(var e=n.length,t=0,r=e-1;r>=0;--r)t+=n[r];return t}function M_(n){for(var e=n.length,t=0,r=e-1;r>=0;--r)t+=n[r];return e?t/e:0}function An(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=Math.atan2(r,t);return i>=0?i:i+Math.PI*2}function OW(n){return[0,1].map(function(e){return M_(n.map(function(t){return t[e]}))})}function ek(n){var e=OW(n),t=An(e,n[0]),r=An(e,n[1]);return t<r&&r-t<Math.PI||t>r&&r-t<-Math.PI?1:-1}function As(n,e){return Math.sqrt(Math.pow((e?e[0]:0)-n[0],2)+Math.pow((e?e[1]:0)-n[1],2))}function at(n,e){if(!e)return n;var t=1/e;return Math.round(n/e)/t}function tk(n,e){return n.forEach(function(t,r){n[r]=at(n[r],e)}),n}function jW(n){for(var e=[],t=0;t<n;++t)e.push(t);return e}function I3(n){return n.reduce(function(e,t){return e.concat(t)},[])}function R3(n,e){n.indexOf(e)===-1&&n.push(e)}function Hn(n,e){return n.classList?n.classList.contains(e):!!n.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function D3(n,e){n.classList?n.classList.add(e):n.className+=" "+e}function k3(n,e){if(n.classList)n.classList.remove(e);else{var t=new RegExp("(\\s|^)"+e+"(\\s|$)");n.className=n.className.replace(t," ")}}function sr(n,e,t,r){n.addEventListener(e,t,r)}function qn(n,e,t,r){n.removeEventListener(e,t,r)}function Ud(n){return n?.ownerDocument||AW}function lS(n){return Ud(n).documentElement}function ul(n){return Ud(n).body}function Yo(n){var e;return((e=n?.ownerDocument)===null||e===void 0?void 0:e.defaultView)||window}function N3(n){return n&&"postMessage"in n&&"blur"in n&&"self"in n}function Fd(n){return oa(n)&&n.nodeName&&n.nodeType&&"ownerDocument"in n}var VW=(function(){function n(){this.keys=[],this.values=[]}var e=n.prototype;return e.get=function(t){return this.values[this.keys.indexOf(t)]},e.set=function(t,r){var i=this.keys,a=this.values,o=i.indexOf(t),c=o===-1?i.length:o;i[c]=t,a[c]=r},n})(),zW=(function(){function n(){this.object={}}var e=n.prototype;return e.get=function(t){return this.object[t]},e.set=function(t,r){this.object[t]=r},n})(),LW=typeof Map=="function",BW=(function(){function n(){}var e=n.prototype;return e.connect=function(t,r){this.prev=t,this.next=r,t&&(t.next=this),r&&(r.prev=this)},e.disconnect=function(){var t=this.prev,r=this.next;t&&(t.next=r),r&&(r.prev=t)},e.getIndex=function(){for(var t=this,r=-1;t;)t=t.prev,++r;return r},n})();function UW(n,e){var t=[],r=[];return n.forEach(function(i){var a=i[0],o=i[1],c=new BW;t[a]=c,r[o]=c}),t.forEach(function(i,a){i.connect(t[a-1])}),n.filter(function(i,a){return!e[a]}).map(function(i,a){var o=i[0],c=i[1];if(o===c)return[0,0];var u=t[o],d=r[c-1],h=u.getIndex();u.disconnect(),d?u.connect(d,d.next):u.connect(void 0,t[0]);var p=u.getIndex();return[h,p]})}var FW=(function(){function n(t,r,i,a,o,c,u,d){this.prevList=t,this.list=r,this.added=i,this.removed=a,this.changed=o,this.maintained=c,this.changedBeforeAdded=u,this.fixed=d}var e=n.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var t=UW(this.changedBeforeAdded,this.fixed),r=this.changed,i=[];this.cacheOrdered=t.filter(function(a,o){var c=a[0],u=a[1],d=r[o],h=d[0],p=d[1];if(c!==u)return i.push([h,p]),!0}),this.cachePureChanged=i},n})();function Hp(n,e,t){var r=LW?Map:t?zW:VW,i=t||function(C){return C},a=[],o=[],c=[],u=n.map(i),d=e.map(i),h=new r,p=new r,m=[],b=[],_={},w=[],S=0,T=0;return u.forEach(function(C,R){h.set(C,R)}),d.forEach(function(C,R){p.set(C,R)}),u.forEach(function(C,R){var O=p.get(C);typeof O>"u"?(++T,o.push(R)):_[O]=T}),d.forEach(function(C,R){var O=h.get(C);typeof O>"u"?(a.push(R),++S):(c.push([O,R]),T=_[R]||0,m.push([O-T,R-S]),b.push(R===O),O!==R&&w.push([O,R]))}),o.reverse(),new FW(n,e,a,o,w,c,m,b)}var GW=(function(){function n(t,r){t===void 0&&(t=[]),this.findKeyCallback=r,this.list=[].slice.call(t)}var e=n.prototype;return e.update=function(t){var r=[].slice.call(t),i=Hp(this.list,r,this.findKeyCallback);return this.list=r,i},n})(),P_=function(n,e){return P_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},P_(n,e)};function Yp(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");P_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Pa=function(){return Pa=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Pa.apply(this,arguments)};function M3(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function nk(n,e,t){for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function rk(n){var e=0;return n.map(function(t){return t==null?"$compat".concat(++e):"".concat(t)})}function P3(n){var e=[];return n.forEach(function(t){e=e.concat(Fn(t)?P3(t):t)}),e}function i1(n,e){if(!e)return n;for(var t in e)ry(n[t])&&(n[t]=e[t]);return n}function sv(n,e){if(n===e)return!1;for(var t in n)if(!(t in e))return!0;for(var t in e)if(n[t]!==e[t])return!0;return!1}function ik(n){var e=n.className,t=M3(n,["className"]);return e!=null&&(t.class=e),delete t.style,delete t.children,t}function ak(n){var e={},t={};for(var r in n)r.indexOf("on")===0?t[r]=n[r]:e[r]=n[r];return[e,t]}function iy(n){if(!n)return null;var e=n.b;return Fd(e)?e:iy(n.c)}function O3(n){var e=n.parentNode;e&&e.removeChild(n)}function j3(n){n.forEach(function(e){e()})}function qW(){return this.constructor(this.props,this.context)}var cS=0,ay=(function(){function n(t,r,i,a,o,c,u){u===void 0&&(u={}),this.t=t,this.d=r,this.k=i,this.i=a,this.c=o,this.ref=c,this.ps=u,this.typ="prov",this._ps=[],this._cs={},this._hyd=null,this._sel=!1}var e=n.prototype;return e.s=function(){return!0},e.u=function(t,r,i,a,o){var c=this,u=c.d,d=MW(r).filter(function(_){return _.$_req}),h=P3(d.map(function(_){return _.$_subs})),p=Gr(h,function(_){return _.d===u});if(c.b&&!Fr(i)&&!o&&!c.s(i.props,a)&&!p){var m=h.reduce(function(_,w){var S=w.d;return _[0]?_[0].d===S&&_.push(w):S>u&&_.push(w),_},[]);return m.forEach(function(_){Kp(_,_._ps,[_.o],t,r,!0)}),!1}c.o=i,c.ss(a);var b=c.ps;return Fr(i)||(c.ps=i.props,c.ref=i.ref),uS(this),c.r(t,r,c.b?b:{},a),!0},e.md=function(){this.rr()},e.ss=function(){},e.ud=function(){this.rr()},e.rr=function(){var t=this,r=t.ref,i=t.fr;r&&r(i?i.current:t.b)},n})();function V3(){return Object.__CROACT_CURRENT_INSTNACE__}function $W(){return cS}function HW(n){cS=n}function uS(n){return Object.__CROACT_CURRENT_INSTNACE__=n,cS=0,n}var dS=(function(){function n(t,r){t===void 0&&(t={}),this.props=t,this.context=r,this.state={},this.$_timer=0,this.$_state={},this.$_subs=[],this.$_cs={}}var e=n.prototype;return e.render=function(){return null},e.shouldComponentUpdate=function(t,r){return this.props!==t||this.state!==r},e.setState=function(t,r,i){var a=this;a.$_timer||(a.$_state={}),clearTimeout(a.$_timer),a.$_timer=0,a.$_state=Pa(Pa({},a.$_state),t),i?a.$_setState(r,i):a.$_timer=window.setTimeout(function(){a.$_timer=0,a.$_setState(r,i)})},e.forceUpdate=function(t){this.setState({},t,!0)},e.componentDidMount=function(){},e.componentDidUpdate=function(t,r){},e.componentWillUnmount=function(){},e.$_setState=function(t,r){var i=[],a=this.$_p,o=Kp(a.c,[a],[a.o],i,a._cs,Pa(Pa({},this.state),this.$_state),r);o&&(t&&i.push(t),j3(i),uS(null))},n})(),z3=(function(n){Yp(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}var t=e.prototype;return t.shouldComponentUpdate=function(r,i){return sv(this.props,r)||sv(this.state,i)},e})(dS);function L3(n){var e=function(t){e.current=t};return e.current=n,e}function YW(n){return n._fr=!0,n}function KW(n,e,t,r){var i,a;return!((i=n?.prototype)===null||i===void 0)&&i.render?a=new n(e,t):(a=new dS(e,t),a.constructor=n,n._fr?(r.fr=L3(),a.render=function(){return this.constructor(this.props,r.fr)}):a.render=qW),a.$_p=r,a}var XW=(function(n){Yp(e,n);function e(r,i,a,o,c,u,d){d===void 0&&(d={});var h=n.call(this,r,i,a,o,c,u,i1(d,r.defaultProps))||this;return h.typ="comp",h._usefs=[],h._uefs=[],h._defs=[],h}var t=e.prototype;return t.s=function(r,i){var a=this.b;return a.shouldComponentUpdate(i1(r,this.t.defaultProps),i||a.state)!==!1},t.r=function(r,i,a){var o,c,u=this,d=u.t;u.ps=i1(u.ps,u.t.defaultProps);var h=u.ps,p=!u.b,m=d.contextType,b=u.b,_=m?.get(u);u._cs=i,p?(b=KW(d,h,_,u),u.b=b):(b.props=h,b.context=_);var w=b.state;u._usefs=[],u._uefs=[];var S=b.render();((c=(o=S?.props)===null||o===void 0?void 0:o.children)===null||c===void 0?void 0:c.length)===0&&(S.props.children=u.ps.children);var T=Pa(Pa({},i),b.$_cs);Kp(u,u._ps,S?[S]:[],r,T),p?u._uefs.push(function(){m?.register(u),b.componentDidMount()}):u._uefs.push(function(){b.componentDidUpdate(a,w)}),r.push(function(){u._usefs.forEach(function(C){C()}),p?u.md():u.ud(),u._defs=u._uefs.map(function(C){return C()})})},t.ss=function(r){var i=this.b;!i||!r||(i.state=r)},t.un=function(){var r,i=this;i._ps.forEach(function(o){o.un()});var a=i.t;(r=a.contextType)===null||r===void 0||r.unregister(i),clearTimeout(i.b.$_timer),i._defs.forEach(function(o){o&&o()}),i.b.componentWillUnmount()},e})(ay);function WW(n,e,t){var r=fS(ik(n),ik(e)),i=r.added,a=r.removed,o=r.changed;for(var c in i)t.setAttribute(c,i[c]);for(var u in o)t.setAttribute(u,o[u][1]);for(var d in a)t.removeAttribute(d)}function QW(n,e,t){var r=fS(n,e),i=r.added,a=r.removed;for(var o in a)t.e(o,!0);for(var c in i)t.e(c)}function fS(n,e){var t=js(n),r=js(e),i=Hp(t,r,function(u){return u}),a={},o={},c={};return i.added.forEach(function(u){var d=r[u];a[d]=e[d]}),i.removed.forEach(function(u){var d=t[u];o[d]=n[d]}),i.maintained.forEach(function(u){var d=u[0],h=t[d],p=[n[h],e[h]];n[h]!==e[h]&&(c[h]=p)}),{added:a,removed:o,changed:c}}function ZW(n,e,t){var r=t.style,i=fS(n,e),a=i.added,o=i.removed,c=i.changed;for(var u in a){var d=x0(u,"-");r.setProperty(d,a[u])}for(var u in c){var h=x0(u,"-");r.setProperty(h,c[u][1])}for(var u in o){var p=x0(u,"-");r.removeProperty(p)}}function JW(n){return n.replace(/^on/g,"").toLowerCase()}var eQ=(function(n){Yp(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r.typ="elem",r._es={},r._svg=!1,r}var t=e.prototype;return t.e=function(r,i){var a=this,o=a._es,c=a.b,u=JW(r);i?(qn(c,u,o[r]),delete o[r]):(o[r]=function(d){var h,p;(p=(h=a.ps)[r])===null||p===void 0||p.call(h,d)},sr(c,u,o[r]))},t.s=function(r){return sv(this.ps,r)},t.r=function(r,i,a){var o,c=this,u=!c.b,d=c.ps;if(u){var h=iy(c.c),p=!1;c._svg||c.t==="svg"?p=!0:p=h&&h.ownerSVGElement,c._svg=p;var m=(o=c._hyd)===null||o===void 0?void 0:o.splice(0,1)[0],b=c.t;if(m)c._hyd=[].slice.call(m.children||[]);else{var _=Ud(h);p?m=_.createElementNS("http://www.w3.org/2000/svg",b):m=_.createElement(b)}c.b=m}Kp(c,c._ps,d.children,r,i);var w=c.b,S=ak(a),T=S[0],C=S[1],R=ak(d),O=R[0],P=R[1];return WW(T,O,w),QW(C,P,c),ZW(a.style||{},d.style||{},w),r.push(function(){u?c.md():c.ud()}),!0},t.un=function(){var r=this,i=r._es,a=r.b;for(var o in i)qn(a,o,i[o]);r._ps.forEach(function(c){c.un()}),r._es={},r._sel||O3(a)},e})(ay);function cp(n){if(!n||Fd(n))return n;var e=n.$_p._ps;return e.length?cp(e[0].b):null}function B3(n){if(n){if(n.b&&Fd(n.b))return n;var e=n._ps;return e.length?B3(e[0]):null}}function ta(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=e||{},a=i.key,o=i.ref,c=M3(i,["key","ref"]);return{type:n,key:a,ref:o,props:Pa(Pa({},c),{children:I3(t).filter(function(u){return u!=null&&u!==!1})})}}var U3=(function(n){Yp(e,n);function e(r,i){i===void 0&&(i=0);var a=n.call(this,"container",i,"container",0,null)||this;return a.typ="container",a.b=r,a}var t=e.prototype;return t.r=function(){return!0},t.un=function(){},e})(ay),tQ=(function(n){Yp(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r.typ="text",r}var t=e.prototype;return t.r=function(r){var i,a=this,o=!a.b;if(o){var c=iy(a.c),u=(i=a._hyd)===null||i===void 0?void 0:i.splice(0,1)[0];a.b=u||Ud(c).createTextNode(a.t.replace("text_",""))}return r.push(function(){o?a.md():a.ud()}),!0},t.un=function(){O3(this.b)},e})(ay);function nQ(n,e,t){var r=t.map(function(u){return Fr(u)?null:u.key}),i=rk(e.map(function(u){return u.k})),a=rk(r),o=Hp(i,a,function(u){return u});o.removed.forEach(function(u){e.splice(u,1)[0].un()}),o.ordered.forEach(function(u){var d=u[0],h=u[1],p=e.splice(d,1)[0];e.splice(h,0,p);var m=cp(p.b),b=cp(e[h+1]&&e[h+1].b);m&&m.parentNode.insertBefore(m,b)}),o.added.forEach(function(u){e.splice(u,0,sk(t[u],r[u],u,n))});var c=o.maintained.filter(function(u){u[0];var d=u[1],h=t[d],p=e[d],m=Fr(h)?"text_".concat(h):h.type;return m!==p.t?(p.un(),e.splice(d,1,sk(h,r[d],d,n)),!0):(p.i=d,!1)});return nk(nk([],o.added,!0),c.map(function(u){u[0];var d=u[1];return d}))}function rQ(n,e){for(var t=n._ps,r=t.length,i=e.i+1;i<r;++i){var a=cp(t[i].b);if(a)return a}return null}function sk(n,e,t,r){var i=r.d+1;if(Fr(n)||xd(n))return new tQ("text_".concat(n),i,e,t,r,null,{});var a=n.type,o=typeof a=="string"?eQ:XW;return new o(a,i,e,t,r,n.ref,n.props)}function Kp(n,e,t,r,i,a,o){var c=nQ(n,e,t),u=n._hyd,d=e.filter(function(p,m){return p._hyd=u,p.u(r,i,t[m],a,o)});n.typ==="container"&&n._sel&&e.forEach(function(p){var m=B3(p);m&&(m._sel=!0)}),n._hyd=null;var h=iy(n);return h&&c.reverse().forEach(function(p){var m=e[p],b=cp(m.b);if(b&&h!==b&&!b.parentNode){var _=rQ(n,m);h.insertBefore(b,_)}}),d.length>0}function iQ(n,e,t,r){t===void 0&&(t=e.__CROACT__),r===void 0&&(r={});var i=!!t;t||(t=new U3(e));var a=[];return Kp(t,t._ps,n?[n]:[],a,r,void 0,void 0),j3(a),uS(null),i||(e.__CROACT__=t),t}function ok(n,e,t){return!t&&n&&(t=new U3(e.parentElement),t._hyd=[e],t._sel=!0),iQ(n,e,t),t}function F3(n){var e=V3(),t=e._hs||(e._hs=[]),r=$W(),i=t[r];if(HW(r+1),i){if(!sv(i.deps,n.deps))return i.updated=!1,i;t[r]=n}else t.push(n);return n.value=n.func(),n.updated=!0,n}function aQ(n,e){var t=F3({func:n,deps:e});return t.value}function sQ(n){return aQ(function(){return L3(n)},[])}function G3(n,e,t){var r=V3(),i=F3({func:function(){return n},deps:e}),a=t?r._usefs:r._uefs;i.updated?a.push(function(){return i.effect&&i.effect(),i.effect=n(),i.effect}):a.push(function(){return i.effect})}function oQ(n,e,t){G3(function(){n?.(e())},t,!0)}function hS(n,e){for(var t=n.length,r=0;r<t;++r)if(e(n[r],r))return!0;return!1}function q3(n,e){for(var t=n.length,r=0;r<t;++r)if(e(n[r],r))return n[r];return null}function $3(n){var e=n;if(typeof e>"u"){if(typeof navigator>"u"||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function pS(n,e){try{return new RegExp(n,"g").exec(e)}catch{return null}}function lQ(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var n=navigator.userAgentData,e=n.brands||n.uaList;return!!(e&&e.length)}function cQ(n,e){var t=pS("("+n+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return t?t[3]:""}function O_(n){return n.replace(/_/g,".")}function dh(n,e){var t=null,r="-1";return hS(n,function(i){var a=pS("("+i.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!a||i.brand?!1:(t=i,r=a[3]||"-1",i.versionAlias?r=i.versionAlias:i.versionTest&&(r=cQ(i.versionTest.toLowerCase(),e)||r),r=O_(r),!0)}),{preset:t,version:r}}function Lm(n,e){var t={brand:"",version:"-1"};return hS(n,function(r){var i=H3(e,r);return i?(t.brand=r.id,t.version=r.versionAlias||i.version,t.version!=="-1"):!1}),t}function H3(n,e){return q3(n,function(t){var r=t.brand;return pS(""+e.test,r.toLowerCase())})}var Y3=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],K3=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],j_=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],X3=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],W3=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function Q3(n){return!!dh(X3,n).preset}function uQ(n){var e=$3(n),t=!!/mobi/g.exec(e),r={name:"unknown",version:"-1",majorVersion:-1,webview:Q3(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},a=dh(Y3,e),o=a.preset,c=a.version,u=dh(W3,e),d=u.preset,h=u.version,p=dh(K3,e);if(r.chromium=!!p.preset,r.chromiumVersion=p.version,!r.chromium){var m=dh(j_,e);r.webkit=!!m.preset,r.webkitVersion=m.version}return d&&(i.name=d.id,i.version=h,i.majorVersion=parseInt(h,10)),o&&(r.name=o.id,r.version=c,r.webview&&i.name==="ios"&&r.name!=="safari"&&(r.webview=!1)),r.majorVersion=parseInt(r.version,10),{browser:r,os:i,isMobile:t,isHints:!1}}function dQ(n){var e=navigator.userAgentData,t=(e.uaList||e.brands).slice(),r=e.mobile||!1,i=t[0],a=(e.platform||navigator.platform).toLowerCase(),o={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!Lm(X3,t).brand||Q3($3())},c={name:"unknown",version:"-1",majorVersion:-1};o.webkit=!o.chromium&&hS(j_,function(m){return H3(t,m)});var u=Lm(K3,t);if(o.chromium=!!u.brand,o.chromiumVersion=u.version||"-1",!o.chromium){var d=Lm(j_,t);o.webkit=!!d.brand,o.webkitVersion=d.version||"-1"}var h=q3(W3,function(m){return new RegExp(""+m.test,"g").exec(a)});c.name=h?h.id:"";{var p=Lm(Y3,t);o.name=p.brand||o.name,o.version=p.brand&&n?n.uaFullVersion:p.version}return o.webkit&&(c.name=r?"ios":"mac"),c.name==="ios"&&o.webview&&(o.version="-1"),c.version=O_(c.version),o.version=O_(o.version),c.majorVersion=parseInt(c.version,10),o.majorVersion=parseInt(o.version,10),{browser:o,os:c,isMobile:r,isHints:!0}}function fQ(n){return lQ()?dQ():uQ(n)}function hQ(n,e,t,r,i,a){for(var o=0;o<i;++o){var c=t+o*i,u=r+o*i;n[c]+=n[u]*a,e[c]+=e[u]*a}}function pQ(n,e,t,r,i){for(var a=0;a<i;++a){var o=t+a*i,c=r+a*i,u=n[o],d=e[o];n[o]=n[c],n[c]=u,e[o]=e[c],e[c]=d}}function gQ(n,e,t,r,i){for(var a=0;a<r;++a){var o=t+a*r;n[o]/=i,e[o]/=i}}function Z3(n,e,t){for(var r=n.slice(),i=0;i<t;++i)r[i*t+e-1]=0,r[(e-1)*t+i]=0;return r[(e-1)*(t+1)]=1,r}function $a(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=n.slice(),r=Zt(e),i=0;i<e;++i){var a=e*i+i;if(!at(t[a],Ln)){for(var o=i+1;o<e;++o)if(t[e*i+o]){pQ(t,r,i,o,e);break}}if(!at(t[a],Ln))return[];gQ(t,r,i,e,t[a]);for(var o=0;o<e;++o){var c=o,u=o+i*e,d=t[u];!at(d,Ln)||i===o||hQ(t,r,c,i,e,-d)}}return r}function mQ(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=[],r=0;r<e;++r)for(var i=0;i<e;++i)t[i*e+r]=n[e*r+i];return t}function J3(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=[],r=n[e*e-1],i=0;i<e-1;++i)t[i]=n[e*(e-1)+i]/r;return t[e-1]=0,t}function vQ(n,e){for(var t=Zt(e),r=0;r<e-1;++r)t[e*(e-1)+r]=n[r]||0;return t}function Ic(n,e){for(var t=n.slice(),r=n.length;r<e-1;++r)t[r]=0;return t[e-1]=1,t}function la(n,e,t){if(e===void 0&&(e=Math.sqrt(n.length)),e===t)return n;for(var r=Zt(t),i=Math.min(e,t),a=0;a<i-1;++a){for(var o=0;o<i-1;++o)r[a*t+o]=n[a*e+o];r[(a+1)*t-1]=n[(a+1)*e-1],r[(t-1)*t+a]=n[(e-1)*e+a]}return r[t*t-1]=n[e*e-1],r}function ov(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var r=Zt(n);return e.forEach(function(i){r=Yt(r,i,n)}),r}function Yt(n,e,t){t===void 0&&(t=Math.sqrt(n.length));var r=[],i=n.length/t,a=e.length/i;if(i){if(!a)return n}else return e;for(var o=0;o<t;++o)for(var c=0;c<a;++c){r[c*t+o]=0;for(var u=0;u<i;++u)r[c*t+o]+=n[u*t+o]*e[c*i+u]}return r}function It(n,e){for(var t=Math.min(n.length,e.length),r=n.slice(),i=0;i<t;++i)r[i]=r[i]+e[i];return r}function Ke(n,e){for(var t=Math.min(n.length,e.length),r=n.slice(),i=0;i<t;++i)r[i]=r[i]-e[i];return r}function yQ(n,e){return e===void 0&&(e=n.length===6),e?[n[0],n[1],0,n[2],n[3],0,n[4],n[5],1]:n}function ej(n,e){return e===void 0&&(e=n.length===9),e?[n[0],n[1],n[3],n[4],n[6],n[7]]:n}function br(n,e,t){t===void 0&&(t=e.length);var r=Yt(n,e,t),i=r[t-1];return r.map(function(a){return a/i})}function bQ(n,e){return Yt(n,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function xQ(n,e){return Yt(n,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function _Q(n,e){return Yt(n,Wp(e,4))}function Bm(n,e){var t=e[0],r=t===void 0?1:t,i=e[1],a=i===void 0?1:i,o=e[2],c=o===void 0?1:o;return Yt(n,[r,0,0,0,0,a,0,0,0,0,c,0,0,0,0,1],4)}function Xp(n,e){return br(Wp(e,3),Ic(n,3))}function a1(n,e){var t=e[0],r=t===void 0?0:t,i=e[1],a=i===void 0?0:i,o=e[2],c=o===void 0?0:o;return Yt(n,[1,0,0,0,0,1,0,0,0,0,1,0,r,a,c,1],4)}function lk(n,e){return Yt(n,e,4)}function Wp(n,e){var t=Math.cos(n),r=Math.sin(n),i=Zt(e);return i[0]=t,i[1]=r,i[e]=-r,i[e+1]=t,i}function Zt(n){for(var e=n*n,t=[],r=0;r<e;++r)t[r]=r%(n+1)?0:1;return t}function gS(n,e){for(var t=Zt(e),r=Math.min(n.length,e-1),i=0;i<r;++i)t[(e+1)*i]=n[i];return t}function Rc(n,e){for(var t=Zt(e),r=Math.min(n.length,e-1),i=0;i<r;++i)t[e*(e-1)+i]=n[i];return t}function mS(n,e,t,r,i,a,o,c){var u=n[0],d=n[1],h=e[0],p=e[1],m=t[0],b=t[1],_=r[0],w=r[1],S=i[0],T=i[1],C=a[0],R=a[1],O=o[0],P=o[1],N=c[0],A=c[1],I=[u,0,h,0,m,0,_,0,d,0,p,0,b,0,w,0,1,0,1,0,1,0,1,0,0,u,0,h,0,m,0,_,0,d,0,p,0,b,0,w,0,1,0,1,0,1,0,1,-S*u,-T*u,-C*h,-R*h,-O*m,-P*m,-N*_,-A*_,-S*d,-T*d,-C*p,-R*p,-O*b,-P*b,-N*w,-A*w],k=$a(I,8);if(!k.length)return[];var z=Yt(k,[S,T,C,R,O,P,N,A],8);return z[8]=1,la(mQ(z),3,4)}var Dh=function(){return Dh=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Dh.apply(this,arguments)};function wQ(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function up(n,e){return e===void 0&&(e=0),zu(_d(n,e))}function EQ(n,e){var t=br(n,[e[0],e[1]||0,e[2]||0,1],4),r=t[3]||1;return[t[0]/r,t[1]/r,t[2]/r]}function zu(n){var e=wQ();return n.forEach(function(t){var r=t.matrixFunction,i=t.functionValue;r&&(e=r(e,i))}),e}function _d(n,e){e===void 0&&(e=0);var t=Fn(n)?n:nl(n);return t.map(function(r){var i=T3(r),a=i.prefix,o=i.value,c=null,u=a,d="";if(a==="translate"||a==="translateX"||a==="translate3d"){var h=oa(e)?Dh(Dh({},e),{"o%":e["%"]}):{"%":e,"o%":e},p=ac(o).map(function(j,X){return X===0&&"x%"in h?h["%"]=e["x%"]:X===1&&"y%"in h?h["%"]=e["y%"]:h["%"]=e["o%"],Ht(j,h)}),m=p[0],b=p[1],_=b===void 0?0:b,w=p[2],S=w===void 0?0:w;c=a1,d=[m,_,S]}else if(a==="translateY"){var T=oa(e)?Dh({"%":e["y%"]},e):{"%":e},_=Ht(o,T);c=a1,d=[0,_,0]}else if(a==="translateZ"){var S=parseFloat(o);c=a1,d=[0,0,S]}else if(a==="scale"||a==="scale3d"){var C=ac(o).map(function(j){return parseFloat(j)}),R=C[0],O=C[1],P=O===void 0?R:O,N=C[2],A=N===void 0?1:N;c=Bm,d=[R,P,A]}else if(a==="scaleX"){var R=parseFloat(o);c=Bm,d=[R,1,1]}else if(a==="scaleY"){var P=parseFloat(o);c=Bm,d=[1,P,1]}else if(a==="scaleZ"){var A=parseFloat(o);c=Bm,d=[1,1,A]}else if(a==="rotate"||a==="rotateZ"||a==="rotateX"||a==="rotateY"){var I=$p(o),k=I.unit,z=I.value,V=k==="rad"?z:z*Math.PI/180;a==="rotate"||a==="rotateZ"?(u="rotateZ",c=_Q):a==="rotateX"?c=bQ:a==="rotateY"&&(c=xQ),d=V}else if(a==="matrix3d")c=lk,d=ac(o).map(function(j){return parseFloat(j)});else if(a==="matrix"){var B=ac(o).map(function(j){return parseFloat(j)});c=lk,d=[B[0],B[1],0,0,B[2],B[3],0,0,0,0,1,0,B[4],B[5],0,1]}else u="";return{name:a,functionName:u,value:o,matrixFunction:c,functionValue:d}})}var V_=function(n,e){return V_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},V_(n,e)};function SQ(n,e){V_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var tj=typeof Map=="function"?void 0:(function(){var n=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++n)}})(),nj=(function(n){SQ(e,n);function e(t){return t===void 0&&(t=[]),n.call(this,t,tj)||this}return e})(GW);function TQ(n,e){return Hp(n,e,tj)}var z_=function(){return z_=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},z_.apply(this,arguments)};function AQ(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}var sy=(function(){function n(){this._events={}}var e=n.prototype;return e.on=function(t,r){if(oa(t))for(var i in t)this.on(i,t[i]);else this._addEvent(t,r,{});return this},e.off=function(t,r){if(!t)this._events={};else if(oa(t))for(var i in t)this.off(i);else if(!r)this._events[t]=[];else{var a=this._events[t];if(a){var o=Os(a,function(c){return c.listener===r});o>-1&&a.splice(o,1)}}return this},e.once=function(t,r){var i=this;return r&&this._addEvent(t,r,{once:!0}),new Promise(function(a){i._addEvent(t,a,{once:!0})})},e.emit=function(t,r){var i=this;r===void 0&&(r={});var a=this._events[t];if(!t||!a)return!0;var o=!1;return r.eventType=t,r.stop=function(){o=!0},r.currentTarget=this,AQ(a).forEach(function(c){c.listener(r),c.once&&i.off(t,c.listener)}),!o},e.trigger=function(t,r){return r===void 0&&(r={}),this.emit(t,r)},e._addEvent=function(t,r,i){var a=this._events;a[t]=a[t]||[];var o=a[t];o.push(z_({listener:r},i))},n})();var L_=function(n,e){return L_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},L_(n,e)};function CQ(n,e){L_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var $u=function(){return $u=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},$u.apply(this,arguments)};function IQ(n){var e=n.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function ck(n,e){return n.addEventListener("scroll",e),function(){n.removeEventListener("scroll",e)}}function Um(n){if(n){if(Fr(n))return document.querySelector(n)}else return null;if(aS(n))return n();if(n instanceof Element)return n;if("current"in n)return n.current;if("value"in n)return n.value}var RQ=(function(n){CQ(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r._startRect=null,r._startPos=[],r._prevTime=0,r._timer=0,r._prevScrollPos=[0,0],r._isWait=!1,r._flag=!1,r._currentOptions=null,r._lock=!1,r._unregister=null,r._onScroll=function(){var i=r._currentOptions;r._lock||!i||r.emit("scrollDrag",{next:function(a){r.checkScroll({container:i.container,inputEvent:a})}})},r}var t=e.prototype;return t.dragStart=function(r,i){var a=Um(i.container);if(!a){this._flag=!1;return}var o=0,c=0,u=0,d=0;if(a===document.body)u=window.innerWidth,d=window.innerHeight;else{var h=a.getBoundingClientRect();o=h.top,c=h.left,u=h.width,d=h.height}this._flag=!0,this._startPos=[r.clientX,r.clientY],this._startRect={top:o,left:c,width:u,height:d},this._prevScrollPos=this._getScrollPosition([0,0],i),this._currentOptions=i,this._registerScrollEvent(i)},t.drag=function(r,i){if(clearTimeout(this._timer),!!this._flag){var a=r.clientX,o=r.clientY,c=i.threshold,u=c===void 0?0:c,d=this,h=d._startRect,p=d._startPos;this._currentOptions=i;var m=[0,0];return h.top>o-u?(p[1]>h.top||o<p[1])&&(m[1]=-1):h.top+h.height<o+u&&(p[1]<h.top+h.height||o>p[1])&&(m[1]=1),h.left>a-u?(p[0]>h.left||a<p[0])&&(m[0]=-1):h.left+h.width<a+u&&(p[0]<h.left+h.width||a>p[0])&&(m[0]=1),!m[0]&&!m[1]?!1:this._continueDrag($u($u({},i),{direction:m,inputEvent:r,isDrag:!0}))}},t.checkScroll=function(r){var i=this;if(this._isWait)return!1;var a=r.prevScrollPos,o=a===void 0?this._prevScrollPos:a,c=r.direction,u=r.throttleTime,d=u===void 0?0:u,h=r.inputEvent,p=r.isDrag,m=this._getScrollPosition(c||[0,0],r),b=m[0]-o[0],_=m[1]-o[1],w=c||[b?Math.abs(b)/b:0,_?Math.abs(_)/_:0];return this._prevScrollPos=m,this._lock=!1,!b&&!_?!1:(this.emit("move",{offsetX:w[0]?b:0,offsetY:w[1]?_:0,inputEvent:h}),d&&p&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},d)),!0)},t.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},t._getScrollPosition=function(r,i){var a=i.container,o=i.getScrollPosition,c=o===void 0?IQ:o;return c({container:Um(a),direction:r})},t._continueDrag=function(r){var i=this,a,o=r.container,c=r.direction,u=r.throttleTime,d=r.useScroll,h=r.isDrag,p=r.inputEvent;if(!(!this._flag||h&&this._isWait)){var m=lp(),b=Math.max(u+this._prevTime-m,0);if(b>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},b),!1;this._prevTime=m;var _=this._getScrollPosition(c,r);this._prevScrollPos=_,h&&(this._isWait=!0),d||(this._lock=!0);var w={container:Um(o),direction:c,inputEvent:p};return(a=r.requestScroll)===null||a===void 0||a.call(r,w),this.emit("scroll",w),this._isWait=!1,d||this.checkScroll($u($u({},r),{prevScrollPos:_,direction:c,inputEvent:p}))}},t._registerScrollEvent=function(r){this._unregisterScrollEvent();var i=r.checkScrollEvent;if(i){var a=i===!0?ck:i,o=Um(r.container);i===!0&&(o===document.body||o===document.documentElement)?this._unregister=ck(window,this._onScroll):this._unregister=a(o,this._onScroll)}},t._unregisterScrollEvent=function(){var r;(r=this._unregister)===null||r===void 0||r.call(this),this._unregister=null},e})(sy);function DQ(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}function Lr(n){return at(n,Ln)}function kQ(n,e){return n.every(function(t,r){return Lr(t-e[r])===0})}function NQ(n,e){return!Lr(n[0]-e[0])&&!Lr(n[1]-e[1])}function rj(n){return n.length<3?0:Math.abs(PW(n.map(function(e,t){var r=n[t+1]||n[0];return e[0]*r[1]-r[0]*e[1]})))/2}function uk(n,e){var t=e.width,r=e.height,i=e.left,a=e.top,o=Dc(n),c=o.minX,u=o.minY,d=o.maxX,h=o.maxY,p=t/(d-c),m=r/(h-u);return n.map(function(b){return[i+(b[0]-c)*p,a+(b[1]-u)*m]})}function Dc(n){var e=n.map(function(r){return r[0]}),t=n.map(function(r){return r[1]});return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,t),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,t)}}function B_(n,e,t){var r=n[0],i=n[1],a=Dc(e),o=a.minX,c=a.maxX,u=[[o,i],[c,i]],d=lv(u[0],u[1]),h=U_(e),p=[];if(h.forEach(function(_){var w=lv(_[0],_[1]),S=_[0];if(kQ(d,w))p.push({pos:n,line:_,type:"line"});else{var T=ij(vS(d,w),[u,_]);T.forEach(function(C){_.some(function(R){return NQ(R,C)})?p.push({pos:C,line:_,type:"point"}):Lr(S[1]-i)!==0&&p.push({pos:C,line:_,type:"intersection"})})}}),Gr(p,function(_){return _[0]===r}))return!0;var m=0,b={};return p.forEach(function(_){var w=_.pos,S=_.type,T=_.line;if(!(w[0]>r))if(S==="intersection")++m;else{if(S==="line")return;if(S==="point"){var C=Gr(T,function(P){return P[1]!==i}),R=b[w[0]],O=C[1]>i?1:-1;R?R!==O&&++m:b[w[0]]=O}}}),m%2===1}function lv(n,e){var t=n[0],r=n[1],i=e[0],a=e[1],o=i-t,c=a-r;Math.abs(o)<Ln&&(o=0),Math.abs(c)<Ln&&(c=0);var u=0,d=0,h=0;return o?c?(u=-c/o,d=1,h=-u*t-r):(d=1,h=-r):c&&(u=-1,h=t),[u,d,h]}function vS(n,e){var t=n[0],r=n[1],i=n[2],a=e[0],o=e[1],c=e[2],u=t===0&&a===0,d=r===0&&o===0,h=[];if(u&&d)return[];if(u){var p=-i/r,m=-c/o;return p!==m?[]:[[-1/0,p],[1/0,p]]}else if(d){var b=-i/t,_=-c/a;return b!==_?[]:[[b,-1/0],[b,1/0]]}else if(t===0){var w=-i/r,S=-(o*w+c)/a;h=[[S,w]]}else if(a===0){var w=-c/o,S=-(r*w+i)/t;h=[[S,w]]}else if(r===0){var S=-i/t,w=-(a*S+c)/o;h=[[S,w]]}else if(o===0){var S=-c/a,w=-(t*S+i)/r;h=[[S,w]]}else{var S=(r*c-o*i)/(o*t-r*a),w=-(t*S+i)/r;h=[[S,w]]}return h.map(function(T){return[T[0],T[1]]})}function ij(n,e){var t=e.map(function(p){return[0,1].map(function(m){return[Math.min(p[0][m],p[1][m]),Math.max(p[0][m],p[1][m])]})}),r=[];if(n.length===2){var i=n[0],a=i[0],o=i[1];if(Lr(a-n[1][0])){if(!Lr(o-n[1][1])){var d=Math.max.apply(Math,t.map(function(p){return p[0][0]})),h=Math.min.apply(Math,t.map(function(p){return p[0][1]}));if(Lr(d-h)>0)return[];r=[[d,o],[h,o]]}}else{var c=Math.max.apply(Math,t.map(function(p){return p[1][0]})),u=Math.min.apply(Math,t.map(function(p){return p[1][1]}));if(Lr(c-u)>0)return[];r=[[a,c],[a,u]]}}return r.length||(r=n.filter(function(p){var m=p[0],b=p[1];return t.every(function(_){return 0<=Lr(m-_[0][0])&&0<=Lr(_[0][1]-m)&&0<=Lr(b-_[1][0])&&0<=Lr(_[1][1]-b)})})),r.map(function(p){return[Lr(p[0]),Lr(p[1])]})}function U_(n){return DQ(n.slice(1),[n[0]]).map(function(e,t){return[n[t],e]})}function MQ(n,e){var t=n.slice(),r=e.slice();ek(t)===-1&&t.reverse(),ek(r)===-1&&r.reverse();var i=U_(t),a=U_(r),o=i.map(function(h){return lv(h[0],h[1])}),c=a.map(function(h){return lv(h[0],h[1])}),u=[];o.forEach(function(h,p){var m=i[p],b=[];c.forEach(function(_,w){var S=vS(h,_),T=ij(S,[m,a[w]]);b.push.apply(b,T.map(function(C){return{index1:p,index2:w,pos:C,type:"intersection"}}))}),b.sort(function(_,w){return As(m[0],_.pos)-As(m[0],w.pos)}),u.push.apply(u,b),B_(m[1],r)&&u.push({index1:p,index2:-1,pos:m[1],type:"inside"})}),a.forEach(function(h,p){if(B_(h[1],t)){var m=!1,b=Os(u,function(_){var w=_.index2;return w===p?(m=!0,!1):!!m});b===-1&&(m=!1,b=Os(u,function(_){var w=_.index1,S=_.index2;return w===-1&&S+1===p?(m=!0,!1):!!m})),b===-1?u.push({index1:-1,index2:p,pos:h[1],type:"inside"}):u.splice(b,0,{index1:-1,index2:p,pos:h[1],type:"inside"})}});var d={};return u.filter(function(h){var p=h.pos,m=p[0]+"x"+p[1];return d[m]?!1:(d[m]=!0,!0)})}function PQ(n,e){var t=MQ(n,e);return t.map(function(r){var i=r.pos;return i})}function OQ(n,e){var t=PQ(n,e);return rj(t)}var F_=function(n,e){return F_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},F_(n,e)};function jQ(n,e){F_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var jn=function(){return jn=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},jn.apply(this,arguments)};function VQ(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=Math.atan2(r,t);return i>=0?i:i+Math.PI*2}function s1(n){return VQ([n[0].clientX,n[0].clientY],[n[1].clientX,n[1].clientY])/Math.PI*180}function zQ(n){return n.touches&&n.touches.length>=2}function Fm(n){return n?n.touches?BQ(n.touches):[aj(n)]:[]}function LQ(n){return n&&(n.type.indexOf("mouse")>-1||"button"in n)}function dk(n,e,t){var r=t.length,i=kh(n,r),a=i.clientX,o=i.clientY,c=i.originalClientX,u=i.originalClientY,d=kh(e,r),h=d.clientX,p=d.clientY,m=kh(t,r),b=m.clientX,_=m.clientY,w=a-h,S=o-p,T=a-b,C=o-_;return{clientX:c,clientY:u,deltaX:w,deltaY:S,distX:T,distY:C}}function o1(n){return Math.sqrt(Math.pow(n[0].clientX-n[1].clientX,2)+Math.pow(n[0].clientY-n[1].clientY,2))}function BQ(n){for(var e=Math.min(n.length,2),t=[],r=0;r<e;++r)t.push(aj(n[r]));return t}function aj(n){return{clientX:n.clientX,clientY:n.clientY}}function kh(n,e){e===void 0&&(e=n.length);for(var t={clientX:0,clientY:0,originalClientX:0,originalClientY:0},r=Math.min(n.length,e),i=0;i<r;++i){var a=n[i];t.originalClientX+="originalClientX"in a?a.originalClientX:a.clientX,t.originalClientY+="originalClientY"in a?a.originalClientY:a.clientY,t.clientX+=a.clientX,t.clientY+=a.clientY}return e?{clientX:t.clientX/e,clientY:t.clientY/e,originalClientX:t.originalClientX/e,originalClientY:t.originalClientY/e}:t}var l1=(function(){function n(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return n.prototype.getAngle=function(e){return e===void 0&&(e=this.prevClients),s1(e)},n.prototype.getRotation=function(e){return e===void 0&&(e=this.prevClients),s1(e)-s1(this.startClients)},n.prototype.getPosition=function(e,t){e===void 0&&(e=this.prevClients);var r=dk(e||this.prevClients,this.prevClients,this.startClients),i=r.deltaX,a=r.deltaY;return this.movement+=Math.sqrt(i*i+a*a),this.prevClients=e,r},n.prototype.getPositions=function(e){e===void 0&&(e=this.prevClients);for(var t=this.prevClients,r=this.startClients,i=Math.min(this.length,t.length),a=[],o=0;o<i;++o)a[o]=dk([e[o]],[t[o]],[r[o]]);return a},n.prototype.getMovement=function(e){var t=this.movement;if(!e)return t;var r=kh(e,this.length),i=kh(this.prevClients,this.length),a=r.clientX-i.clientX,o=r.clientY-i.clientY;return Math.sqrt(a*a+o*o)+t},n.prototype.getDistance=function(e){return e===void 0&&(e=this.prevClients),o1(e)},n.prototype.getScale=function(e){return e===void 0&&(e=this.prevClients),o1(e)/o1(this.startClients)},n.prototype.move=function(e,t){this.startClients.forEach(function(r){r.clientX-=e,r.clientY-=t}),this.prevClients.forEach(function(r){r.clientX-=e,r.clientY-=t})},n})(),fk=["textarea","input"],UQ=(function(n){jQ(e,n);function e(t,r){r===void 0&&(r={});var i=n.call(this)||this;i.options={},i.flag=!1,i.pinchFlag=!1,i.data={},i.isDrag=!1,i.isPinch=!1,i.clientStores=[],i.targets=[],i.prevTime=0,i.doubleFlag=!1,i._useMouse=!1,i._useTouch=!1,i._useDrag=!1,i._dragFlag=!1,i._isTrusted=!1,i._isMouseEvent=!1,i._isSecondaryButton=!1,i._preventMouseEvent=!1,i._prevInputEvent=null,i._isDragAPI=!1,i._isIdle=!0,i._preventMouseEventId=0,i._window=window,i.onDragStart=function(m,b){if(b===void 0&&(b=!0),!(!i.flag&&m.cancelable===!1)){var _=m.type.indexOf("drag")>=-1;if(!(i.flag&&_)){i._isDragAPI=!0;var w=i.options,S=w.container,T=w.pinchOutside,C=w.preventWheelClick,R=w.preventRightClick,O=w.preventDefault,P=w.checkInput,N=w.dragFocusedInput,A=w.preventClickEventOnDragStart,I=w.preventClickEventOnDrag,k=w.preventClickEventByCondition,z=i._useTouch,V=!i.flag;if(i._isSecondaryButton=m.which===3||m.button===2,C&&(m.which===2||m.button===1)||R&&(m.which===3||m.button===2))return i.stop(),!1;if(V){var B=i._window.document.activeElement,j=m.target;if(j){var X=j.tagName.toLowerCase(),H=fk.indexOf(X)>-1,$=j.isContentEditable;if(H||$){if(P||!N&&B===j)return!1;if(B&&(B===j||$&&B.isContentEditable&&B.contains(j)))if(N)j.blur();else return!1}else if((O||m.type==="touchstart")&&B){var W=B.tagName.toLowerCase();(B.isContentEditable||fk.indexOf(W)>-1)&&B.blur()}(A||I||k)&&sr(i._window,"click",i._onClick,!0)}i.clientStores=[new l1(Fm(m))],i._isIdle=!1,i.flag=!0,i.isDrag=!1,i._isTrusted=b,i._dragFlag=!0,i._prevInputEvent=m,i.data={},i.doubleFlag=lp()-i.prevTime<200,i._isMouseEvent=LQ(m),!i._isMouseEvent&&i._preventMouseEvent&&i._allowMouseEvent();var ee=i._preventMouseEvent||i.emit("dragStart",jn(jn({data:i.data,datas:i.data,inputEvent:m,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,isTrusted:b,isDouble:i.doubleFlag},i.getCurrentStore().getPosition()),{preventDefault:function(){m.preventDefault()},preventDrag:function(){i._dragFlag=!1}}));ee===!1&&i.stop(),i._isMouseEvent&&i.flag&&O&&m.preventDefault()}if(!i.flag)return!1;var he=0;if(V?(i._attchDragEvent(),z&&T&&(he=setTimeout(function(){sr(S,"touchstart",i.onDragStart,{passive:!1})}))):z&&T&&qn(S,"touchstart",i.onDragStart),i.flag&&zQ(m)){if(clearTimeout(he),V&&m.touches.length!==m.changedTouches.length)return;i.pinchFlag||i.onPinchStart(m)}}}},i.onDrag=function(m,b){if(i.flag){var _=i.options.preventDefault;!i._isMouseEvent&&_&&m.preventDefault(),i._prevInputEvent=m;var w=Fm(m),S=i.moveClients(w,m,!1);if(i._dragFlag){if(i.pinchFlag||S.deltaX||S.deltaY){var T=i._preventMouseEvent||i.emit("drag",jn(jn({},S),{isScroll:!!b,inputEvent:m}));if(T===!1){i.stop();return}}i.pinchFlag&&i.onPinch(m,w)}i.getCurrentStore().getPosition(w,!0)}},i.onDragEnd=function(m){if(i.flag){var b=i.options,_=b.pinchOutside,w=b.container,S=b.preventClickEventOnDrag,T=b.preventClickEventOnDragStart,C=b.preventClickEventByCondition,R=i.isDrag;(S||T||C)&&requestAnimationFrame(function(){i._allowClickEvent()}),!C&&!T&&S&&!R&&i._allowClickEvent(),i._useTouch&&_&&qn(w,"touchstart",i.onDragStart),i.pinchFlag&&i.onPinchEnd(m);var O=m?.touches?Fm(m):[],P=O.length;P===0||!i.options.keepDragging?i.flag=!1:i._addStore(new l1(O));var N=i._getPosition(),A=lp(),I=!R&&i.doubleFlag;i._prevInputEvent=null,i.prevTime=R||I?0:A,i.flag||(i._dettachDragEvent(),i._preventMouseEvent||i.emit("dragEnd",jn({data:i.data,datas:i.data,isDouble:I,isDrag:R,isClick:!R,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,inputEvent:m,isTrusted:i._isTrusted},N)),i.clientStores=[],i._isMouseEvent||(i._preventMouseEvent=!0,clearTimeout(i._preventMouseEventId),i._preventMouseEventId=setTimeout(function(){i._preventMouseEvent=!1},200)),i._isIdle=!0)}},i.onBlur=function(){i.onDragEnd()},i._allowClickEvent=function(){qn(i._window,"click",i._onClick,!0)},i._onClick=function(m){i._allowClickEvent(),i._allowMouseEvent();var b=i.options.preventClickEventByCondition;b?.(m)||(m.stopPropagation(),m.preventDefault())},i._onContextMenu=function(m){var b=i.options;b.preventRightClick?i.onDragEnd(m):m.preventDefault()},i._passCallback=function(){};var a=[].concat(t),o=a[0];i._window=N3(o)?o:Yo(o),i.options=jn({checkInput:!1,container:o&&!("document"in o)?Yo(o):o,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},r);var c=i.options,u=c.container,d=c.events,h=c.checkWindowBlur;if(i._useDrag=d.indexOf("drag")>-1,i._useTouch=d.indexOf("touch")>-1,i._useMouse=d.indexOf("mouse")>-1,i.targets=a,i._useDrag&&a.forEach(function(m){sr(m,"dragstart",i.onDragStart)}),i._useMouse&&(a.forEach(function(m){sr(m,"mousedown",i.onDragStart),sr(m,"mousemove",i._passCallback)}),sr(u,"contextmenu",i._onContextMenu)),h&&sr(Yo(),"blur",i.onBlur),i._useTouch){var p={passive:!1};a.forEach(function(m){sr(m,"touchstart",i.onDragStart,p),sr(m,"touchmove",i._passCallback,p)})}return i}return e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(t){return this.getCurrentStore().getMovement(t)+this.clientStores.slice(1).reduce(function(r,i){return r+i.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(t,r,i,a){a===void 0&&(a=!0),this.flag&&(this.clientStores[0].move(t,r),a&&this.onDrag(i,!0))},e.prototype.move=function(t,r){var i=t[0],a=t[1],o=this.getCurrentStore(),c=o.prevClients;return this.moveClients(c.map(function(u){var d=u.clientX,h=u.clientY;return{clientX:d+i,clientY:h+a,originalClientX:d,originalClientY:h}}),r,!0)},e.prototype.triggerDragStart=function(t){this.onDragStart(t,!1)},e.prototype.setEventData=function(t){var r=this.data;for(var i in t)r[i]=t[i];return this},e.prototype.setEventDatas=function(t){return this.setEventData(t)},e.prototype.getCurrentEvent=function(t){return t===void 0&&(t=this._prevInputEvent),jn(jn({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:t})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var t=this,r=this.targets,i=this.options.container;this.off(),qn(this._window,"blur",this.onBlur),this._useDrag&&r.forEach(function(a){qn(a,"dragstart",t.onDragStart)}),this._useMouse&&(r.forEach(function(a){qn(a,"mousedown",t.onDragStart)}),qn(i,"contextmenu",this._onContextMenu)),this._useTouch&&(r.forEach(function(a){qn(a,"touchstart",t.onDragStart)}),qn(i,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(t){var r=this,i=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>i)){var a=new l1(Fm(t));this.pinchFlag=!0,this._addStore(a);var o=this.emit("pinchStart",jn(jn({data:this.data,datas:this.data,angle:a.getAngle(),touches:this.getCurrentStore().getPositions()},a.getPosition()),{inputEvent:t,isTrusted:this._isTrusted,preventDefault:function(){t.preventDefault()},preventDrag:function(){r._dragFlag=!1}}));o===!1&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(t,r){if(!(!this.flag||!this.pinchFlag||r.length<2)){var i=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",jn(jn({data:this.data,datas:this.data,movement:this.getMovement(r),angle:i.getAngle(r),rotation:i.getRotation(r),touches:i.getPositions(r),scale:i.getScale(r),distance:i.getDistance(r)},i.getPosition(r)),{inputEvent:t,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(t){if(this.pinchFlag){var r=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var i=this.getCurrentStore();this.emit("pinchEnd",jn(jn({data:this.data,datas:this.data,isPinch:r,touches:i.getPositions()},i.getPosition()),{inputEvent:t}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(t,r,i){var a=this._getPosition(t,i),o=this.isDrag;(a.deltaX||a.deltaY)&&(this.isDrag=!0);var c=!1;return!o&&this.isDrag&&(c=!0),jn(jn({data:this.data,datas:this.data},a),{movement:this.getMovement(t),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:r,isTrusted:this._isTrusted,isFirstDrag:c})},e.prototype._addStore=function(t){this.clientStores.splice(0,0,t)},e.prototype._getPosition=function(t,r){var i=this.getCurrentStore(),a=i.getPosition(t,r),o=this.clientStores.slice(1).reduce(function(d,h){var p=h.getPosition();return d.distX+=p.distX,d.distY+=p.distY,d},a),c=o.distX,u=o.distY;return jn(jn({},a),{distX:c,distY:u})},e.prototype._attchDragEvent=function(){var t=this._window,r=this.options.container,i={passive:!1};this._isDragAPI&&(sr(r,"dragover",this.onDrag,i),sr(t,"dragend",this.onDragEnd)),this._useMouse&&(sr(r,"mousemove",this.onDrag),sr(t,"mouseup",this.onDragEnd)),this._useTouch&&(sr(r,"touchmove",this.onDrag,i),sr(t,"touchend",this.onDragEnd,i),sr(t,"touchcancel",this.onDragEnd,i))},e.prototype._dettachDragEvent=function(){var t=this._window,r=this.options.container;this._isDragAPI&&(qn(r,"dragover",this.onDrag),qn(t,"dragend",this.onDragEnd)),this._useMouse&&(qn(r,"mousemove",this.onDrag),qn(t,"mouseup",this.onDragEnd)),this._useTouch&&(qn(r,"touchstart",this.onDragStart),qn(r,"touchmove",this.onDrag),qn(t,"touchend",this.onDragEnd),qn(t,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e})(sy);function FQ(n){for(var e=5381,t=n.length;t;)e=e*33^n.charCodeAt(--t);return e>>>0}var GQ=FQ;function qQ(n){return GQ(n).toString(36)}function $Q(n){if(n&&n.getRootNode){var e=n.getRootNode();if(e.nodeType===11)return e}}function HQ(n,e,t){return t.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(r,i){var a=i.trim();return(a?ac(a):[""]).map(function(o){var c=o.trim();return c.indexOf("@")===0?c:c.indexOf(":global")>-1?c.replace(/\:global/g,""):c.indexOf(":host")>-1?"".concat(c.replace(/\:host/g,".".concat(n))):c?".".concat(n," ").concat(c):".".concat(n)}).join(", ")+" {"})}function YQ(n,e,t,r,i){var a=Ud(r),o=a.createElement("style");return o.setAttribute("type","text/css"),o.setAttribute("data-styled-id",n),o.setAttribute("data-styled-count","1"),t.nonce&&o.setAttribute("nonce",t.nonce),o.innerHTML=HQ(n,e,t),(i||a.head||a.body).appendChild(o),o}function KQ(n){var e="rCS"+qQ(n);return{className:e,inject:function(t,r){r===void 0&&(r={});var i=$Q(t),a=(i||t.ownerDocument||document).querySelector('style[data-styled-id="'.concat(e,'"]'));if(!a)a=YQ(e,n,r,t,i);else{var o=parseFloat(a.getAttribute("data-styled-count"))||0;a.setAttribute("data-styled-count","".concat(o+1))}return{destroy:function(){var c,u=parseFloat(a.getAttribute("data-styled-count"))||0;u<=1?(a.remove?a.remove():(c=a.parentNode)===null||c===void 0||c.removeChild(a),a=null):a.setAttribute("data-styled-count","".concat(u-1))}}}}}var G_=function(){return G_=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},G_.apply(this,arguments)};function XQ(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function sj(n,e){var t=KQ(e),r=t.className;return YW(function(i,a){var o=i.className,c=o===void 0?"":o;i.cspNonce;var u=XQ(i,["className","cspNonce"]),d=sQ();return oQ(a,function(){return d.current},[]),G3(function(){var h=t.inject(d.current,{nonce:i.cspNonce});return function(){h.destroy()}},[]),ta(n,G_({ref:d,"data-styled-id":r,className:"".concat(c," ").concat(r)},u))})}var q_=function(n,e){return q_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},q_(n,e)};function Qp(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");q_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var J=function(){return J=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},J.apply(this,arguments)};function WQ(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function QQ(n,e,t,r){var i=arguments.length,a=i<3?e:r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function ZQ(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function te(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function Ie(n,e,t){if(arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function Zp(n,e){return J({events:[],props:[],name:n},e)}var JQ=["n","w","s","e"],yS=["n","w","s","e","nw","ne","sw","se"];function eZ(n,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*n,'px" height="').concat(32*n,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}function tZ(n){var e=eZ(1,n),t=Math.round(n/45)*45%180,r="ns-resize";return t===135?r="nwse-resize":t===45?r="nesw-resize":t===90&&(r="ew-resize"),"cursor:".concat(r,";cursor: url('").concat(e,"') 16 16, ").concat(r,";")}var Gd=fQ(),oj=Gd.browser.webkit,lj=oj&&(function(){var n=typeof window>"u"?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(n.userAgent.toLowerCase());return e?parseFloat(e[1])<605:!1})(),cj=Gd.browser.name,uj=parseInt(Gd.browser.version,10),nZ=cj==="chrome",rZ=Gd.browser.chromium,iZ=parseInt(Gd.browser.chromiumVersion,10)||0,aZ=nZ&&uj>=109||rZ&&iZ>=109,sZ=cj==="firefox",oZ=parseInt(Gd.browser.webkitVersion,10)>=612||uj>=15,bS="moveable-",lZ=yS.map(function(n){var e="",t="",r="center",i="center",a="calc(var(--moveable-control-padding, 20) * -1px)";return n.indexOf("n")>-1&&(e="top: ".concat(a,";"),i="bottom"),n.indexOf("s")>-1&&(e="top: 0px;",i="top"),n.indexOf("w")>-1&&(t="left: ".concat(a,";"),r="right"),n.indexOf("e")>-1&&(t="left: 0px;",r="left"),'.around-control[data-direction*="'.concat(n,`"] {
        `).concat(t).concat(e,`
        transform-origin: `).concat(r," ").concat(i,`;
    }`)}).join(`
`),cZ=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(lZ,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(n){return`
.direction[data-rotation="`.concat(n,'"], :global .view-control-rotation').concat(n,` {
`).concat(tZ(n),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(lj?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),uZ=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],$_=1e-4,kr=1e-7,Gm=1e-9,H_=Math.pow(10,10),hk=-H_,dZ={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},xS={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},dj={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},fj=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function Jp(n,e,t,r,i,a){var o,c;a===void 0&&(a="draggable");var u=(c=(o=e.gestos[a])===null||o===void 0?void 0:o.move(t,n.inputEvent))!==null&&c!==void 0?c:{},d=u.originalDatas||u.datas,h=d[a]||(d[a]={});return J(J({},u),{isPinch:!!r,parentEvent:!0,datas:h,originalDatas:n.originalDatas})}var wd=(function(){function n(e){var t;e===void 0&&(e="draggable"),this.ableName=e,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(t={},t[e]={},t)}return n.prototype.dragStart=function(e,t){this.isDrag=!1,this.isFlag=!1;var r=t.originalDatas;return this.datas=r,r[this.ableName]||(r[this.ableName]={}),J(J({},this.move(e,t.inputEvent)),{type:"dragstart"})},n.prototype.drag=function(e,t){return this.move([e[0]-this.prevX,e[1]-this.prevY],t)},n.prototype.move=function(e,t){var r,i,a=!1;if(!this.isFlag)this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],r=e[0],i=e[1],this.isFlag=!0;else{var o=this.isDrag;r=this.prevX+e[0],i=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!o&&this.isDrag&&(a=!0)}return this.prevX=r,this.prevY=i,{type:"drag",clientX:r,clientY:i,inputEvent:t,isFirstDrag:a,isDrag:this.isDrag,distX:r-this.startX,distY:i-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},n})();function rd(n,e,t,r){var i=n.length===16,a=i?4:3,o=zc(n,t,r,a),c=te(o,4),u=te(c[0],2),d=u[0],h=u[1],p=te(c[1],2),m=p[0],b=p[1],_=te(c[2],2),w=_[0],S=_[1],T=te(c[3],2),C=T[0],R=T[1],O=te(cn(n,e,a),2),P=O[0],N=O[1],A=Math.min(d,m,w,C),I=Math.min(h,b,S,R),k=Math.max(d,m,w,C),z=Math.max(h,b,S,R);d=d-A||0,m=m-A||0,w=w-A||0,C=C-A||0,h=h-I||0,b=b-I||0,S=S-I||0,R=R-I||0,P=P-A||0,N=N-I||0;var V=n[0],B=n[a+1],j=Ar(V*B);return{left:A,top:I,right:k,bottom:z,origin:[P,N],pos1:[d,h],pos2:[m,b],pos3:[w,S],pos4:[C,R],direction:j}}function hj(n,e){var t=e.clientX,r=e.clientY,i=e.datas,a=n.state,o=a.moveableClientRect,c=a.rootMatrix,u=a.is3d,d=a.pos1,h=o.left,p=o.top,m=u?4:3,b=te(Ke(Td(c,[t-h,r-p],m),d),2),_=b[0],w=b[1],S=te(Wa({datas:i,distX:_,distY:w}),2),T=S[0],C=S[1];return[T,C]}function Vc(n,e){var t=e.datas,r=n.state,i=r.allMatrix,a=r.beforeMatrix,o=r.is3d,c=r.left,u=r.top,d=r.origin,h=r.offsetMatrix,p=r.targetMatrix,m=r.transformOrigin,b=o?4:3;t.is3d=o,t.matrix=i,t.targetMatrix=p,t.beforeMatrix=a,t.offsetMatrix=h,t.transformOrigin=m,t.inverseMatrix=$a(i,b),t.inverseBeforeMatrix=$a(a,b),t.absoluteOrigin=Ic(It([c,u],d),b),t.startDragBeforeDist=br(t.inverseBeforeMatrix,t.absoluteOrigin,b),t.startDragDist=br(t.inverseMatrix,t.absoluteOrigin,b)}function fZ(n){return rd(n.datas.beforeTransform,[50,50],100,100).direction}function oy(n,e,t){var r=e.datas,i=e.originalDatas.beforeRenderable,a=r.transformIndex,o=i.nextTransforms,c=o.length,u=i.nextTransformAppendedIndexes,d=-1;a===-1?(t==="translate"?d=0:t==="rotate"&&(d=Os(o,function(b){return b.match(/scale\(/g)})),d===-1&&(d=o.length),r.transformIndex=d):Gr(u,function(b){return b.index===a&&b.functionName===t})?d=a:d=a+u.filter(function(b){return b.index<a}).length;var h=zJ(o,n.state,d),p=h.targetFunction,m=t==="rotate"?"rotateZ":t;r.beforeFunctionTexts=h.beforeFunctionTexts,r.afterFunctionTexts=h.afterFunctionTexts,r.beforeTransform=h.beforeFunctionMatrix,r.beforeTransform2=h.beforeFunctionMatrix2,r.targetTansform=h.targetFunctionMatrix,r.afterTransform=h.afterFunctionMatrix,r.afterTransform2=h.afterFunctionMatrix2,r.targetAllTransform=h.allFunctionMatrix,p.functionName===m?(r.afterFunctionTexts.splice(0,1),r.isAppendTransform=!1):c>d&&(r.isAppendTransform=!0,i.nextTransformAppendedIndexes=Ie(Ie([],te(u),!1),[{functionName:t,index:d,isAppend:!0}],!1))}function ly(n,e,t){return"".concat(n.beforeFunctionTexts.join(" ")," ").concat(n.isAppendTransform?t:e," ").concat(n.afterFunctionTexts.join(" "))}function hZ(n){var e=n.datas,t=n.distX,r=n.distY,i=te(gj({datas:e,distX:t,distY:r}),2),a=i[0],o=i[1],c=pj(e,vQ([a,o],4));return br(c,Ic([0,0,0],4),4)}function pj(n,e,t){var r=n.beforeTransform,i=n.afterTransform,a=n.beforeTransform2,o=n.afterTransform2,c=n.targetAllTransform,u=t?Yt(c,e,4):Yt(e,c,4),d=Yt($a(t?a:r,4),u,4),h=Yt(d,$a(t?o:i,4),4);return h}function gj(n){var e=n.datas,t=n.distX,r=n.distY,i=e.inverseBeforeMatrix,a=e.is3d,o=e.startDragBeforeDist,c=e.absoluteOrigin,u=a?4:3;return Ke(br(i,It(c,[t,r]),u),o)}function Wa(n,e){var t=n.datas,r=n.distX,i=n.distY,a=t.inverseBeforeMatrix,o=t.inverseMatrix,c=t.is3d,u=t.startDragBeforeDist,d=t.startDragDist,h=t.absoluteOrigin,p=c?4:3;return Ke(br(e?a:o,It(h,[r,i]),p),e?u:d)}function pZ(n,e){var t=n.datas,r=n.distX,i=n.distY;t.beforeMatrix;var a=t.matrix,o=t.is3d;t.startDragBeforeDist;var c=t.startDragDist,u=t.absoluteOrigin,d=o?4:3;return Ke(br(a,It(c,[r,i]),d),u)}function gZ(n,e,t,r,i,a){return r===void 0&&(r=e),i===void 0&&(i=t),a===void 0&&(a=[0,0]),n?n.map(function(o,c){var u=$p(o),d=u.value,h=u.unit,p=c?i:r,m=c?t:e;if(o==="%"||isNaN(d)){var b=p?a[c]/p:0;return m*b}else if(h!=="%")return d;return m*d/100}):a}function mj(n){var e=[];return n[1]>=0&&(n[0]>=0&&e.push(3),n[0]<=0&&e.push(2)),n[1]<=0&&(n[0]>=0&&e.push(1),n[0]<=0&&e.push(0)),e}function mZ(n,e){return mj(e).map(function(t){return n[t]})}function c1(n,e){var t=(e+1)/2;return[av(n[0][0],n[1][0],t,1-t),av(n[0][1],n[1][1],t,1-t)]}function Yn(n,e){var t=c1([n[0],n[1]],e[0]),r=c1([n[2],n[3]],e[0]);return c1([t,r],e[1])}function vZ(n,e,t,r,i,a){var o=zc(e,t,r,i),c=Yn(o,a),u=n[0]-c[0],d=n[1]-c[1];return[u,d]}function eg(n,e,t,r){return Yt(n,Mh(e,r,t),r)}function yZ(n,e,t,r){var i=n.transformOrigin,a=n.offsetMatrix,o=n.is3d,c=o?4:3,u;if(Fr(t)){var d=e.beforeTransform,h=e.afterTransform;r?u=la(up(t),4,c):u=la(Yt(Yt(d,up([t]),4),h,4),4,c)}else u=t;return eg(a,u,i,c)}function bZ(n,e){var t=n.transformOrigin,r=n.offsetMatrix,i=n.is3d,a=n.targetMatrix,o=n.targetAllTransform,c=i?4:3;return eg(r,Yt(o||a,gS(e,c),c),t,c)}function cy(n,e){var t=qd(e);return{setTransform:function(r,i){i===void 0&&(i=-1),t.startTransforms=Fn(r)?r:nl(r),Y_(n,e,i)},setTransformIndex:function(r){Y_(n,e,r)}}}function uy(n,e,t){var r=qd(e),i=r.startTransforms;Y_(n,e,Os(i,function(a){return a.indexOf("".concat(t,"("))===0}))}function Y_(n,e,t){var r=qd(e),i=e.datas;if(i.transformIndex=t,t!==-1){var a=r.startTransforms[t];if(a){var o=n.state,c=_d([a],{"x%":function(u){return u/100*o.offsetWidth},"y%":function(u){return u/100*o.offsetHeight}});i.startValue=c[0].functionValue}}}function _S(n,e){var t=qd(n);t.nextTransforms=nl(e)}function qd(n){return n.originalDatas.beforeRenderable}function cv(n){var e=n.originalDatas.beforeRenderable;return e.nextTransforms}function qm(n){return(cv(n)||[]).join(" ")}function $m(n){return qd(n).nextStyle}function vj(n,e,t,r,i){_S(i,e);var a=Tr.drag(n,Jp(i,n.state,t,r)),o=a?a.transform:e;return J(J({transform:e,drag:a},Rr({transform:o},i)),{afterTransform:o})}function wS(n,e,t,r,i,a){var o=yZ(n.state,i,e,a),c=wZ(n,t,r,o);return c}function yj(n,e,t,r,i,a,o){var c=wS(n,e,t,i,a,o),u=n.state,d=u.left,h=u.top,p=n.props.groupable,m=p?d:0,b=p?h:0,_=Ke(r,c);return Ke(_,[m,b])}function xZ(n,e,t,r,i,a,o){var c=yj(n,e,t,r,i,a,o);return c}function _Z(n,e,t){return[e?-1+n[0]/(e/2):0,t?-1+n[1]/(t/2):0]}function wZ(n,e,t,r){r===void 0&&(r=n.state.allMatrix);var i=n.state,a=i.width,o=i.height,c=i.is3d,u=c?4:3,d=[a/2*(1+e[0])+t[0],o/2*(1+e[1])+t[1]];return cn(r,d,u)}function EZ(n,e,t){var r=t.fixedDirection,i=t.fixedPosition,a=t.fixedOffset;return yj(n,"rotate(".concat(e,"deg)"),r,i,a,t)}function SZ(n,e,t,r,i,a){var o=n.props.groupable,c=n.state,u=c.transformOrigin,d=c.offsetMatrix,h=c.is3d,p=c.width,m=c.height,b=c.left,_=c.top,w=a.fixedDirection,S=a.nextTargetMatrix||c.targetMatrix,T=h?4:3,C=gZ(i,e,t,p,m,u),R=o?b:0,O=o?_:0,P=eg(d,S,C,T),N=vZ(r,P,e,t,T,w);return Ke(N,[R,O])}function TZ(n,e){return Yn(Oi(n.state),e)}function AZ(n,e){var t=n.targetGesto,r=n.controlGesto,i;return t?.isFlag()&&(i=t.getEventData()[e]),!i&&r?.isFlag()&&(i=r.getEventData()[e]),i||{}}function CZ(n){if(n&&n.getRootNode){var e=n.getRootNode();if(e.nodeType===11)return e}}function IZ(n){var e=n("scale"),t=n("rotate"),r=n("translate"),i=[];return r&&r!=="0px"&&r!=="none"&&i.push("translate(".concat(r.split(/\s+/).join(","),")")),t&&t!=="1"&&t!=="none"&&i.push("rotate(".concat(t,")")),e&&e!=="1"&&e!=="none"&&i.push("scale(".concat(e.split(/\s+/).join(","),")")),i}function bj(n,e,t){for(var r=n,i=[],a=lS(n)||ul(n),o=!t&&n===e||n===a,c=o,u=!1,d=3,h,p,m,b=!1,_=fp(e,e,!0).offsetParent,w=1;r&&!c;){c=o;var S=qr(r),T=S("position"),C=Gj(r),R=T==="fixed",O=IZ(S),P=yQ(TJ(C)),N=void 0,A=!1,I=!1,k=0,z=0,V=0,B=0,j={hasTransform:!1,fixedContainer:null};R&&(b=!0,j=DJ(r),_=j.fixedContainer);var X=P.length;!u&&(X===16||O.length)&&(u=!0,d=4,J_(i),m&&(m=la(m,3,4))),u&&X===9&&(P=la(P,3,4));var H=RJ(r,n),$=H.tagName,W=H.hasOffset,ee=H.isSVG,he=H.origin,K=H.targetOrigin,G=H.offset,Y=te(G,2),re=Y[0],Z=Y[1];$==="svg"&&!r.ownerSVGElement&&m&&(i.push({type:"target",target:r,matrix:kJ(r,d)}),i.push({type:"offset",target:r,matrix:Zt(d)}));var oe=parseFloat(S("zoom"))||1;if(R)N=j.fixedContainer,A=!0;else{var fe=fp(r,e,!1,!0,S),be=fe.offsetZoom;if(N=fe.offsetParent,A=fe.isEnd,I=fe.isStatic,w*=be,(fe.isCustomElement||be!==1)&&I)re-=N.offsetLeft,Z-=N.offsetTop;else if(sZ||aZ){var Ce=fe.parentSlotElement;if(Ce){for(var we=N,Pe=0,ue=0;we&&CZ(we);)Pe+=we.offsetLeft,ue+=we.offsetTop,we=we.offsetParent;re-=Pe,Z-=ue}}}if(oj&&!oZ&&W&&!ee&&I&&(T==="relative"||T==="static")&&(re-=N.offsetLeft,Z-=N.offsetTop,o=o||A),R)W&&j.hasTransform&&(V=N.clientLeft,B=N.clientTop);else if(W&&_!==N&&(k=N.clientLeft,z=N.clientTop),W&&N===a){var _e=qj(r,!1);re+=_e[0],Z+=_e[1]}if(i.push({type:"target",target:r,matrix:Mh(P,d,he)}),O.length&&(i.push({type:"offset",target:r,matrix:Zt(d)}),i.push({type:"target",target:r,matrix:Mh(up(O),d,he)})),W){var ze=r===n,Ne=ze?0:r.scrollLeft,qe=ze?0:r.scrollTop;i.push({type:"offset",target:r,matrix:Rc([re-Ne+k-V,Z-qe+z-B],d)})}else i.push({type:"offset",target:r,origin:he});if(oe!==1&&i.push({type:"zoom",target:r,matrix:Mh(gS([oe,oe],d),d,[0,0])}),m||(m=P),h||(h=he),p||(p=K),c||R)break;r=N,o=A,(!t||r===a)&&(c=o)}return m||(m=Zt(d)),h||(h=[0,0]),p||(p=[0,0]),{zoom:w,offsetContainer:_,matrixes:i,targetMatrix:m,transformOrigin:h,targetOrigin:p,is3d:u,hasFixed:b}}var Zl=null,Jl=null,Hu=null;function Ed(n){n?(window.Map&&(Zl=new Map,Jl=new Map),Hu=[]):(Zl=null,Hu=null,Jl=null)}function RZ(n){var e=Jl?.get(n);if(e)return e;var t=Ph(n,!0);return Jl&&Jl.set(n,t),t}function DZ(n,e){if(Hu){var t=Gr(Hu,function(i){return i[0][0]==n&&i[0][1]==e});if(t)return t[1]}var r=bj(n,e,!0);return Hu&&Hu.push([[n,e],r]),r}function qr(n){var e=Zl?.get(n);if(!e){var t=Yo(n).getComputedStyle(n);if(!Zl)return function(a){return t[a]};e={style:t,cached:{}},Zl.set(n,e)}var r=e.cached,i=e.style;return function(a){return a in r||(r[a]=i[a]),r[a]}}function na(n,e,t){var r=t.originalDatas;r.groupable=r.groupable||{};var i=r.groupable;i.childDatas=i.childDatas||[];var a=i.childDatas;return n.moveables.map(function(o,c){return a[c]=a[c]||{},a[c][e]=a[c][e]||{},J(J({},t),{isRequestChild:!0,datas:a[c][e],originalDatas:a[c]})})}function u1(n,e,t,r,i,a,o){var c=!!t.match(/Start$/g),u=!!t.match(/End$/g),d=i.isPinch,h=i.datas,p=na(n,e.name,i),m=n.moveables,b=[],_=p.map(function(w,S){var T=m[S],C=T.state,R=C.gestos,O=w;if(c)O=new wd(o).dragStart(r,w),b.push(O);else{if(R[o]||(R[o]=h.childGestos[S]),!R[o])return;O=Jp(w,C,r,d,a,o),b.push(O)}var P=e[t](T,J(J({},O),{parentFlag:!0}));return u&&(R[o]=null),P});return c&&(h.childGestos=m.map(function(w){return w.state.gestos[o]})),{eventParams:_,childEvents:b}}function Cs(n,e,t,r,i,a){i===void 0&&(i=function(h,p){return p});var o=!!t.match(/End$/g),c=na(n,e.name,r),u=n.moveables,d=c.map(function(h,p){var m=u[p],b=h;b=i(m,h);var _=e[t](m,J(J({},b),{parentFlag:!0}));return o&&(m.state.gestos={}),_});return d}function uv(n,e,t,r){var i=t.fixedDirection,a=t.fixedPosition,o=r.datas.startPositions||Oi(e.state),c=Yn(o,i),u=te(br(Wp(-n.rotation/180*Math.PI,3),[c[0]-a[0],c[1]-a[1],1],3),2),d=u[0],h=u[1];return r.datas.originalX=d,r.datas.originalY=h,r}function xj(n,e,t,r){var i=n.getState(),a=i.renderPoses,o=i.rotation,c=i.direction,u=kc(n.props,e).zoom,d=Nh(o/Math.PI*180),h={},p=n.renderState;p.renderDirectionMap||(p.renderDirectionMap={});var m=p.renderDirectionMap;t.forEach(function(_){var w=_.dir;h[w]=!0});var b=Ar(c);return t.map(function(_){var w=_.data,S=_.classNames,T=_.dir,C=xS[T];if(!C||!h[T])return null;m[T]=!0;var R=(at(d,15)+b*dj[T]+720)%180,O={};return js(w).forEach(function(P){O["data-".concat(P)]=w[P]}),r.createElement("div",J({className:$e.apply(void 0,Ie(["control","direction",T,e],te(S),!1)),"data-rotation":R,"data-direction":T},O,{key:"direction-".concat(T),style:pv.apply(void 0,Ie([o,u],te(C.map(function(P){return a[P]})),!1))}))})}function _j(n,e,t,r){var i=kc(n.props,t),a=i.renderDirections,o=a===void 0?e:a,c=i.displayAroundControls;if(!o)return[];var u=o===!0?yS:o;return Ie(Ie([],te(c?Tj(n,r,t,u):[]),!1),te(xj(n,t,u.map(function(d){return{data:{},classNames:[],dir:d}}),r)),!1)}function dp(n,e,t,r,i,a){for(var o=[],c=6;c<arguments.length;c++)o[c-6]=arguments[c];var u=An(t,r),d=e?at(u/Math.PI*180,15)%180:-1;return n.createElement("div",{key:"line-".concat(a),className:$e.apply(void 0,Ie(["line","direction",e?"edge":"",e],te(o),!1)),"data-rotation":d,"data-line-key":a,"data-direction":e,style:hh(t,r,i,u)})}function wj(n,e,t,r,i){var a=t===!0?JQ:t;return a.map(function(o,c){var u=te(xS[o],2),d=u[0],h=u[1];if(h!=null)return dp(n,o,r[d],r[h],i,"".concat(e,"Edge").concat(c),e)}).filter(Boolean)}function Ej(n){return function(e,t){var r=kc(e.props,n).edge;return r&&(r===!0||r.length)?Ie(Ie([],te(wj(t,n,r,e.getState().renderPoses,e.props.zoom)),!1),te(kZ(e,n,t)),!1):Sj(e,n,t)}}function Sj(n,e,t){return _j(n,yS,e,t)}function kZ(n,e,t){return _j(n,["nw","ne","sw","se"],e,t)}function Tj(n,e,t,r){var i=n.renderState;i.renderDirectionMap||(i.renderDirectionMap={});var a=n.getState(),o=a.renderPoses,c=a.rotation,u=a.direction,d=i.renderDirectionMap,h=n.props.zoom,p=Ar(u),m=c/Math.PI*180;return(r||js(d)).map(function(b){var _=xS[b];if(!_)return null;var w=(at(m,15)+p*dj[b]+720)%180,S=["around-control"];return t&&S.push("direction",t),e.createElement("div",{className:$e.apply(void 0,Ie([],te(S),!1)),"data-rotation":w,"data-direction":b,key:"direction-around-".concat(b),style:pv.apply(void 0,Ie([c,h],te(_.map(function(T){return o[T]})),!1))})})}function ES(n,e,t){var r=n||{},i=r.position,a=i===void 0?"client":i,o=r.left,c=o===void 0?-1/0:o,u=r.top,d=u===void 0?-1/0:u,h=r.right,p=h===void 0?1/0:h,m=r.bottom,b=m===void 0?1/0:m,_={position:a,left:c,top:d,right:p,bottom:b};return{vertical:pk(_,e,!0),horizontal:pk(_,t,!1)}}function dy(n,e){var t=n.state,r=t.containerClientRect,i=r.clientHeight,a=r.clientWidth,o=r.clientLeft,c=r.clientTop,u=t.snapOffset,d=u.left,h=u.top,p=u.right,m=u.bottom,b=e||n.props.bounds||{},_=b.position||"client",w=_==="css",S=b.left,T=S===void 0?-1/0:S,C=b.top,R=C===void 0?-1/0:C,O=b.right,P=O===void 0?w?-1/0:1/0:O,N=b.bottom,A=N===void 0?w?-1/0:1/0:N;return w&&(P=a+p-d-P,A=i+m-h-A),{left:T+d-o,right:P+d-o,top:R+h-c,bottom:A+h-c}}function NZ(n,e,t){var r=dy(n),i=r.left,a=r.top,o=r.right,c=r.bottom,u=te(t,2),d=u[0],h=u[1],p=te(Ke(t,e),2),m=p[0],b=p[1];Ee(m)<kr&&(m=0),Ee(b)<kr&&(b=0);var _=b>0,w=m>0,S={isBound:!1,offset:0,pos:0},T={isBound:!1,offset:0,pos:0};if(m===0&&b===0)return{vertical:S,horizontal:T};if(m===0)_?c<h&&(T.pos=c,T.offset=h-c):a>h&&(T.pos=a,T.offset=h-a);else if(b===0)w?o<d&&(S.pos=o,S.offset=d-o):i>d&&(S.pos=i,S.offset=d-i);else{var C=b/m,R=t[1]-C*d,O=0,P=0,N=!1;w&&o<=d?(O=C*o+R,P=o,N=!0):!w&&d<=i&&(O=C*i+R,P=i,N=!0),N&&(O<a||O>c)&&(N=!1),N||(_&&c<=h?(O=c,P=(O-R)/C,N=!0):!_&&h<=a&&(O=a,P=(O-R)/C,N=!0)),N&&(S.isBound=!0,S.pos=P,S.offset=d-P,T.isBound=!0,T.pos=O,T.offset=h-O)}return{vertical:S,horizontal:T}}function pk(n,e,t){var r=n[t?"left":"top"],i=n[t?"right":"bottom"],a=Math.min.apply(Math,Ie([],te(e),!1)),o=Math.max.apply(Math,Ie([],te(e),!1)),c=[];return r+1>a&&c.push({direction:"start",isBound:!0,offset:a-r,pos:r}),i-1<o&&c.push({direction:"end",isBound:!0,offset:o-i,pos:i}),c.length||c.push({isBound:!1,offset:0,pos:0}),c.sort(function(u,d){return Ee(d.offset)-Ee(u.offset)})}function gk(n,e,t){var r=t?n.map(function(i){return Xp(i,t)}):n;return r.some(function(i){return i[0]<e.left&&Ee(i[0]-e.left)>.1||i[0]>e.right&&Ee(i[0]-e.right)>.1||i[1]<e.top&&Ee(i[1]-e.top)>.1||i[1]>e.bottom&&Ee(i[1]-e.bottom)>.1})}function MZ(n,e,t){var r=Pi(n),i=Math.sqrt(r*r-e*e)||0;return[i,-i].sort(function(a,o){return Ee(a-n[t?0:1])-Ee(o-n[t?0:1])}).map(function(a){return An([0,0],t?[a,e]:[e,a])})}function PZ(n,e,t,r,i){if(!n.props.bounds)return[];var a=i*Math.PI/180,o=dy(n),c=o.left,u=o.top,d=o.right,h=o.bottom,p=c-r[0],m=d-r[0],b=u-r[1],_=h-r[1],w={left:p,top:b,right:m,bottom:_};if(!gk(t,w,0))return[];var S=[];return[[p,0],[m,0],[b,1],[_,1]].forEach(function(T){var C=te(T,2),R=C[0],O=C[1];t.forEach(function(P){var N=An([0,0],P);S.push.apply(S,Ie([],te(MZ(P,R,O).map(function(A){return a+A-N}).filter(function(A){return!gk(e,w,A)}).map(function(A){return at(A*180/Math.PI,kr)})),!1))})}),S}var OZ=["left","right","center"],jZ=["top","bottom","middle"],mk={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},rl={start:"left",end:"right",center:"center"},il={start:"top",end:"bottom",center:"middle"};function Yu(){return{left:!1,top:!1,right:!1,bottom:!1}}function $d(n,e){var t=n.props,r=t.snappable,i=t.bounds,a=t.innerBounds,o=t.verticalGuidelines,c=t.horizontalGuidelines,u=t.snapGridWidth,d=t.snapGridHeight,h=n.state,p=h.guidelines,m=h.enableSnap;return!r||!m||e&&r!==!0&&r.indexOf(e)<0?!1:!!(u||d||i||a||p&&p.length||o&&o.length||c&&c.length)}function SS(n){return n===!1?{}:n===!0||!n?{left:!0,right:!0,top:!0,bottom:!0}:n}function VZ(n,e){var t=SS(n),r={};for(var i in t)i in e&&t[i]&&(r[i]=e[i]);return r}function TS(n,e){var t=VZ(n,e),r=jZ.filter(function(a){return a in t}),i=OZ.filter(function(a){return a in t});return{horizontalNames:r,verticalNames:i,horizontal:r.map(function(a){return t[a]}),vertical:i.map(function(a){return t[a]})}}function zZ(n,e,t){var r=cn(n,[e.clientLeft,e.clientTop],t);return[e.left+r[0],e.top+r[1]]}function LZ(n){var e=te(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];Math.abs(i)<Ln&&(i=0),Math.abs(a)<Ln&&(a=0);var o=0,c=0,u=0;return i?a?(o=-a/i,c=1,u=o*t[0]-t[1]):(c=1,u=-t[1]):(o=-1,u=t[0]),[o,c,u].map(function(d){return at(d,Ln)})}var Aj="snapRotationThreshold",Cj="snapRotationDegrees",Ij="snapHorizontalThreshold",Rj="snapVerticalThreshold";function fy(n,e,t,r,i,a,o){var c;r===void 0&&(r=[]),i===void 0&&(i=[]);var u=n.props,d=((c=n.state.snapThresholdInfo)===null||c===void 0?void 0:c.multiples)||[1,1],h=kk(o,u[Ij],5),p=kk(a,u[Rj],5);return Dj(n.state.guidelines,e,t,r,i,h,p,d)}function Dj(n,e,t,r,i,a,o,c){return{vertical:yk(n,"vertical",e,o*c[0],r),horizontal:yk(n,"horizontal",t,a*c[1],i)}}function BZ(n,e,t){var r=te(t,2),i=r[0],a=r[1],o=te(e,2),c=o[0],u=o[1],d=te(Ke(t,e),2),h=d[0],p=d[1],m=p>0,b=h>0;h=gv(h),p=gv(p);var _={isSnap:!1,offset:0,pos:0},w={isSnap:!1,offset:0,pos:0};if(h===0&&p===0)return{vertical:_,horizontal:w};var S=fy(n,h?[i]:[],p?[a]:[],[],[],void 0,void 0),T=S.vertical,C=S.horizontal;T.posInfos.filter(function($){var W=$.pos;return b?W>=c:W<=c}),C.posInfos.filter(function($){var W=$.pos;return m?W>=u:W<=u}),T.isSnap=T.posInfos.length>0,C.isSnap=C.posInfos.length>0;var R=K_(T),O=R.isSnap,P=R.guideline,N=K_(C),A=N.isSnap,I=N.guideline,k=A?I.pos[1]:0,z=O?P.pos[0]:0;if(h===0)A&&(w.isSnap=!0,w.pos=I.pos[1],w.offset=a-w.pos);else if(p===0)O&&(_.isSnap=!0,_.pos=z,_.offset=i-z);else{var V=p/h,B=t[1]-V*i,j=0,X=0,H=!1;O?(X=z,j=V*X+B,H=!0):A&&(j=k,X=(j-B)/V,H=!0),H&&(_.isSnap=!0,_.pos=X,_.offset=i-X,w.isSnap=!0,w.pos=j,w.offset=a-j)}return{vertical:_,horizontal:w}}function Vo(n){var e="";return n===-1||n==="top"||n==="left"?e="start":n===0||n==="center"||n==="middle"?e="center":(n===1||n==="right"||n==="bottom")&&(e="end"),e}function vk(n,e,t,r){var i=TS(n.props.snapDirections,e),a=fy(n,i.vertical,i.horizontal,i.verticalNames.map(function(u){return Vo(u)}),i.horizontalNames.map(function(u){return Vo(u)}),t,r),o=Vo(i.horizontalNames[a.horizontal.index]),c=Vo(i.verticalNames[a.vertical.index]);return{vertical:J(J({},a.vertical),{direction:c}),horizontal:J(J({},a.horizontal),{direction:o})}}function K_(n){var e=n.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var t=n.posInfos[0],r=t.guidelineInfos[0],i=r.offset,a=r.dist,o=r.guideline;return{isSnap:e,offset:i,dist:a,pos:t.pos,guideline:o}}function yk(n,e,t,r,i){var a,o;if(i===void 0&&(i=[]),!n||!n.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var c=e==="vertical",u=c?0:1,d=t.map(function(p,m){var b=i[m]||"",_=n.map(function(w){var S=w.pos,T=p-S[u];return{offset:T,dist:Ee(T),guideline:w,direction:b}}).filter(function(w){var S=w.guideline,T=w.dist,C=S.type;return!(C!==e||T>r)}).sort(function(w,S){return w.dist-S.dist});return{pos:p,index:m,guidelineInfos:_,direction:b}}).filter(function(p){return p.guidelineInfos.length>0}).sort(function(p,m){return p.guidelineInfos[0].dist-m.guidelineInfos[0].dist}),h=d.length>0;return{isSnap:h,index:h?d[0].index:-1,direction:(o=(a=d[0])===null||a===void 0?void 0:a.direction)!==null&&o!==void 0?o:"",posInfos:d}}function UZ(n,e,t,r,i){var a=[];t[0]&&t[1]?a=[t,[-t[0],t[1]],[t[0],-t[1]]]:!t[0]&&!t[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(m,b,_){var w=_[b+1]||_[0];a.push(m),a.push([(m[0]+w[0])/2,(m[1]+w[1])/2])}):n.props.keepRatio?a.push([-1,-1],[-1,1],[1,-1],[1,1],t):(a.push.apply(a,Ie([],te(mZ([[-1,-1],[1,-1],[-1,-1],[1,1]],t)),!1)),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var o=a.map(function(m){return Yn(e,m)}),c=o.map(function(m){return m[0]}),u=o.map(function(m){return m[1]}),d=fy(n,c,u,a.map(function(m){return Vo(m[0])}),a.map(function(m){return Vo(m[1])}),r,i),h=Vo(a.map(function(m){return m[0]})[d.vertical.index]),p=Vo(a.map(function(m){return m[1]})[d.horizontal.index]);return{vertical:J(J({},d.vertical),{direction:h}),horizontal:J(J({},d.horizontal),{direction:p})}}function kj(n,e){var t=Ee(n.offset),r=Ee(e.offset);return n.isBound&&e.isBound?r-t:n.isBound?-1:e.isBound?1:n.isSnap&&e.isSnap?r-t:n.isSnap?-1:e.isSnap||t<kr?1:r<kr?-1:t-r}function dv(n,e){return n.slice().sort(function(t,r){var i=t.sign[e],a=r.sign[e],o=t.offset[e],c=r.offset[e];if(i){if(!a)return-1}else return 1;return kj({isBound:t.isBound,isSnap:t.isSnap,offset:o},{isBound:r.isBound,isSnap:r.isSnap,offset:c})})[0]}function FZ(n,e,t){var r=[];if(t)Ee(e[0])!==1||Ee(e[1])!==1?r.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):r.push([e,[n[0],-n[1]]],[e,[-n[0],n[1]]]),r.push([e,n]);else if(n[0]&&n[1]||!n[0]&&!n[1]){var i=n[0]?n:[1,1];[1,-1].forEach(function(o){[1,-1].forEach(function(c){var u=[o*i[0],c*i[1]];e[0]===u[0]&&e[1]===u[1]||r.push([e,u])})})}else if(n[0]){var a=Ee(e[0])===1?[1]:[1,-1];a.forEach(function(o){r.push([[e[0],-1],[o*n[0],-1]],[[e[0],0],[o*n[0],0]],[[e[0],1],[o*n[0],1]])})}else if(n[1]){var a=Ee(e[1])===1?[1]:[1,-1];a.forEach(function(c){r.push([[-1,e[1]],[-1,c*n[1]]],[[0,e[1]],[0,c*n[1]]],[[1,e[1]],[1,c*n[1]]])})}return r}function Nj(n,e){var t=M_([e[0][0],e[1][0]]),r=M_([e[0][1],e[1][1]]);return{vertical:t<=n[0],horizontal:r<=n[1]}}function AS(n,e){var t=te(e,2),r=t[0],i=t[1],a=i[0]-r[0],o=i[1]-r[1];Ee(a)<kr&&(a=0),Ee(o)<kr&&(o=0);var c,u;if(!a)c=r[0],u=n[0];else if(!o)c=r[1],u=n[1];else{var d=o/a;c=d*(n[0]-r[0])+r[1],u=n[1]}return c-u}function Mj(n,e,t,r){return r===void 0&&(r=kr),n.every(function(i){var a=AS(i,e),o=a<=0;return o===t||Ee(a)<=r})}function bk(n,e,t,r,i){return i===void 0&&(i=0),r&&e-i<=n||!r&&n<=t+i?{isBound:!0,offset:r?e-n:t-n}:{isBound:!1,offset:0}}function GZ(n,e){var t=e.line,r=e.centerSign,i=e.verticalSign,a=e.horizontalSign,o=e.lineConstants,c=n.props.innerBounds;if(!c)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var u=c.left,d=c.top,h=c.width,p=c.height,m=[[u,d],[u,d+p]],b=[[u,d],[u+h,d]],_=[[u+h,d],[u+h,d+p]],w=[[u,d+p],[u+h,d+p]];if(Mj([[u,d],[u+h,d],[u,d+p],[u+h,d+p]],t,r))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var S=zo(t,o,b,i),T=zo(t,o,w,i),C=zo(t,o,m,a),R=zo(t,o,_,a),O=S.isBound&&T.isBound,P=S.isBound||T.isBound,N=C.isBound&&R.isBound,A=C.isBound||R.isBound,I=Sd(S.offset,T.offset),k=Sd(C.offset,R.offset),z=[0,0],V=!1,B=!1;return Ee(k)<Ee(I)?(z=[I,0],V=P,B=O):(z=[0,k],V=A,B=N),{isAllBound:B,isVerticalBound:P,isHorizontalBound:A,isBound:V,offset:z}}function zo(n,e,t,r,i,a){var o=te(e,2),c=o[0],u=o[1],d=n[0],h=t[0],p=t[1],m=gv(p[1]-h[1]),b=gv(p[0]-h[0]),_=u,w=c,S=-c/u;if(b){if(!m){if(a&&!_)return{isBound:!1,offset:0};if(w){var O=(h[1]-d[1])/S+d[0];return bk(O,h[0],p[0],r,i)}else{var C=h[1]-d[1],R=Ee(C)<=(i||0);return{isBound:R,offset:R?C:0}}}}else{if(a&&!w)return{isBound:!1,offset:0};if(_){var T=S*(h[0]-d[0])+d[1];return bk(T,h[1],p[1],r,i)}else{var C=h[0]-d[0],R=Ee(C)<=(i||0);return{isBound:R,offset:R?C:0}}}return{isBound:!1,offset:0}}function Pj(n,e,t){return e.map(function(r){var i=GZ(n,r),a=i.isBound,o=i.offset,c=i.isVerticalBound,u=i.isHorizontalBound,d=r.multiple,h=Wa({datas:t,distX:o[0],distY:o[1]}).map(function(p,m){return p*(d[m]?2/d[m]:0)});return{sign:d,isBound:a,isVerticalBound:c,isHorizontalBound:u,isSnap:!1,offset:h}})}function qZ(n,e,t){var r,i=CS(n,e,[0,0],!1).map(function(m){return J(J({},m),{multiple:m.multiple.map(function(b){return Ee(b)*2})})}),a=Pj(n,i,t),o=dv(a,0),c=dv(a,1),u=0,d=0,h=o.isVerticalBound||c.isVerticalBound,p=o.isHorizontalBound||c.isHorizontalBound;return(h||p)&&(r=te(pZ({datas:t,distX:-o.offset[0],distY:-c.offset[1]}),2),u=r[0],d=r[1]),{vertical:{isBound:h,offset:u},horizontal:{isBound:p,offset:d}}}function $Z(n,e){var t=[],r=n[0],i=n[1];return r&&i?t.push([[0,i*2],n,[-r,i]],[[r*2,0],n,[r,-i]]):r?(t.push([[r*2,0],[r,1],[r,-1]]),e&&t.push([[0,-1],[r,-1],[-r,-1]],[[0,1],[r,1],[-r,1]])):i?(t.push([[0,i*2],[1,i],[-1,i]]),e&&t.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):t.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),t}function CS(n,e,t,r){var i=n.state,a=i.allMatrix,o=i.is3d,c=zc(a,100,100,o?4:3),u=Yn(c,[0,0]);return $Z(t,r).map(function(d){var h=te(d,3),p=h[0],m=h[1],b=h[2],_=[Yn(c,m),Yn(c,b)],w=LZ(_),S=Nj(u,_),T=S.vertical,C=S.horizontal,R=AS(u,_)<=0;return{multiple:p,centerSign:R,verticalSign:T,horizontalSign:C,lineConstants:w,line:[Yn(e,m),Yn(e,b)]}})}function xk(n,e,t,r){var i=r?n.map(function(a){return Xp(a,r)}):n;return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some(function(a){var o=AS(t,a)<=0;return!Mj(e,a,o)})}function HZ(n){var e=te(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];if(!i)return Ee(t[0]);if(!a)return Ee(t[1]);var o=a/i;return Ee((-o*t[0]+t[1])/Math.sqrt(Math.pow(o,2)+1))}function YZ(n){var e=te(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];if(!i)return[t[0],0];if(!a)return[0,t[1]];var o=a/i,c=-o*t[0]+t[1];return[-c/(o+1/o),c/(o*o+1)]}function KZ(n,e,t,r,i){var a=n.props.innerBounds,o=i*Math.PI/180;if(!a)return[];var c=a.left,u=a.top,d=a.width,h=a.height,p=c-r[0],m=c+d-r[0],b=u-r[1],_=u+h-r[1],w=[[p,b],[m,b],[p,_],[m,_]],S=Yn(t,[0,0]);if(!xk(t,w,S,0))return[];var T=[],C=w.map(function(R){return[Pi(R),An([0,0],R)]});return[[t[0],t[1]],[t[1],t[3]],[t[3],t[2]],[t[2],t[0]]].forEach(function(R){var O=An([0,0],YZ(R)),P=HZ(R);T.push.apply(T,Ie([],te(C.filter(function(N){var A=te(N,1),I=A[0];return I&&P<=I}).map(function(N){var A=te(N,2),I=A[0],k=A[1],z=Math.acos(I?P/I:0),V=k+z,B=k-z;return[o+V-O,o+B-O]}).reduce(function(N,A){return N.push.apply(N,Ie([],te(A),!1)),N},[]).filter(function(N){return!xk(e,w,S,N)}).map(function(N){return at(N*180/Math.PI,kr)})),!1))}),T}function XZ(n){var e=n.props.innerBounds,t=Yu();if(!e)return{boundMap:t,vertical:[],horizontal:[]};var r=n.getRect(),i=r.pos1,a=r.pos2,o=r.pos3,c=r.pos4,u=[i,a,o,c],d=Yn(u,[0,0]),h=e.left,p=e.top,m=e.width,b=e.height,_=[[h,p],[h,p+b]],w=[[h,p],[h+m,p]],S=[[h+m,p],[h+m,p+b]],T=[[h,p+b],[h+m,p+b]],C=CS(n,u,[0,0],!1),R=[],O=[];return C.forEach(function(P){var N=P.line,A=P.lineConstants,I=Nj(d,N),k=I.horizontal,z=I.vertical,V=zo(N,A,w,z,1,!0),B=zo(N,A,T,z,1,!0),j=zo(N,A,_,k,1,!0),X=zo(N,A,S,k,1,!0);V.isBound&&!t.top&&(R.push(p),t.top=!0),B.isBound&&!t.bottom&&(R.push(p+b),t.bottom=!0),j.isBound&&!t.left&&(O.push(h),t.left=!0),X.isBound&&!t.right&&(O.push(h+m),t.right=!0)}),{boundMap:t,horizontal:R,vertical:O}}function WZ(n,e,t,r){var i=e[0]-n[0],a=e[1]-n[1];if(Ee(i)<Ln&&(i=0),Ee(a)<Ln&&(a=0),!i)return r?[0,0]:[0,t];if(!a)return r?[t,0]:[0,0];var o=a/i,c=n[1]-o*n[0];if(r){var u=o*(e[0]+t)+c;return[t,u-e[1]]}else{var d=(e[1]+t-c)/o;return[d-e[0],t]}}function X_(n,e,t,r,i){var a=WZ(n,e,t,r);if(!a)return{isOutside:!1,offset:[0,0]};var o=As(n,e),c=As(a,n),u=As(a,e),d=c>o||u>o,h=te(Wa({datas:i,distX:a[0],distY:a[1]}),2),p=h[0],m=h[1];return{offset:[p,m],isOutside:d}}function fv(n,e){return n.isBound?n.offset:e.isSnap?K_(e).offset:0}function QZ(n,e,t,r,i){var a=te(e,2),o=a[0],c=a[1],u=te(t,2),d=u[0],h=u[1],p=te(r,2),m=p[0],b=p[1],_=te(i,2),w=_[0],S=_[1],T=-w,C=-S;if(n&&o&&c){T=0,C=0;var R=[];if(d&&h?R.push([0,S],[w,0]):d?R.push([w,0]):h?R.push([0,S]):m&&b?R.push([0,S],[w,0]):m?R.push([w,0]):b&&R.push([0,S]),R.length){R.sort(function(A,I){return Pi(Ke([o,c],A))-Pi(Ke([o,c],I))});var O=R[0];if(O[0]&&Ee(o)>Ln)T=-O[0],C=c*Ee(o+T)/Ee(o)-c;else if(O[1]&&Ee(c)>Ln){var P=c;C=-O[1],T=o*Ee(c+C)/Ee(P)-o}if(n&&h&&d)if(Ee(T)>Ln&&Ee(T)<Ee(w)){var N=Ee(w)/Ee(T);T*=N,C*=N}else if(Ee(C)>Ln&&Ee(C)<Ee(S)){var N=Ee(S)/Ee(C);T*=N,C*=N}else T=Sd(-w,T),C=Sd(-S,C)}}else T=o||d?-w:0,C=c||h?-S:0;return[T,C]}function ZZ(n,e,t,r,i,a){if(!$d(n,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var o=DS(a.absolutePoses,[e,t]),c=Ni(o),u=c.left,d=c.right,h=c.top,p=c.bottom,m={horizontal:o.map(function(X){return X[1]}),vertical:o.map(function(X){return X[0]})},b=SS(n.props.snapDirections),_=TS(b,{left:u,right:d,top:h,bottom:p,center:(u+d)/2,middle:(h+p)/2}),w=hy(n,i,_,m),S=w.vertical,T=w.horizontal,C=qZ(n,o,a),R=C.vertical,O=C.horizontal,P=S.isSnap,N=T.isSnap,A=S.isBound||R.isBound,I=T.isBound||O.isBound,k=Sd(S.offset,R.offset),z=Sd(T.offset,O.offset),V=te(QZ(r,[e,t],[A,I],[P,N],[k,z]),2),B=V[0],j=V[1];return[{isBound:A,isSnap:P,offset:B},{isBound:I,isSnap:N,offset:j}]}function hy(n,e,t,r){r===void 0&&(r=t);var i=ES(dy(n),r.vertical,r.horizontal),a=i.horizontal,o=i.vertical,c=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:fy(n,t.vertical,t.horizontal,void 0,void 0,void 0,void 0),u=c.horizontal,d=c.vertical,h=fv(a[0],u),p=fv(o[0],d),m=Ee(h),b=Ee(p);return{horizontal:{isBound:a[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:h,dist:m,bounds:a,snap:u},vertical:{isBound:o[0].isBound,isSnap:d.isSnap,snapIndex:d.index,offset:p,dist:b,bounds:o,snap:d}}}function _k(n,e,t,r,i,a,o){o===void 0&&(o=[1,1]);var c=ES(e,t,r),u=c.horizontal,d=c.vertical,h=Dj(n,t,r,[],[],i,a,o),p=h.horizontal,m=h.vertical,b=fv(u[0],p),_=fv(d[0],m),w=Ee(b),S=Ee(_);return{horizontal:{isBound:u[0].isBound,isSnap:p.isSnap,snapIndex:p.index,offset:b,dist:w,bounds:u,snap:p},vertical:{isBound:d[0].isBound,isSnap:m.isSnap,snapIndex:m.index,offset:_,dist:S,bounds:d,snap:m}}}function JZ(n,e,t,r){var i=An(n,e)/Math.PI*180,a=t.vertical,o=a.isBound,c=a.isSnap,u=a.dist,d=t.horizontal,h=d.isBound,p=d.isSnap,m=d.dist,b=i%180,_=b<3||b>177,w=b>87&&b<93;return m<u&&(o||c&&!w&&(!r||!_))?"vertical":h||p&&!_&&(!r||!w)?"horizontal":""}function eJ(n,e,t,r,i,a){return t.map(function(o){var c=te(o,2),u=c[0],d=c[1],h=Yn(e,u),p=Yn(e,d),m=r?tJ(n,h,p,i):hy(n,i,{vertical:[p[0]],horizontal:[p[1]]}),b=m.horizontal,_=b.offset,w=b.isBound,S=b.isSnap,T=m.vertical,C=T.offset,R=T.isBound,O=T.isSnap,P=Ke(d,u);if(!C&&!_)return{isBound:R||w,isSnap:O||S,sign:P,offset:[0,0]};var N=JZ(h,p,m,r);if(!N)return{sign:P,isBound:!1,isSnap:!1,offset:[0,0]};var A=N==="vertical",I=[0,0];return!r&&Ee(d[0])===1&&Ee(d[1])===1&&u[0]!==d[0]&&u[1]!==d[1]?I=Wa({datas:a,distX:-C,distY:-_}):I=X_(h,p,-(A?C:_),A,a).offset,I=I.map(function(k,z){return k*(P[z]?2/P[z]:0)}),{sign:P,isBound:A?R:w,isSnap:A?O:S,offset:I}})}function wk(n,e){return n.isBound?n.offset:e.isSnap?e.offset:0}function tJ(n,e,t,r){var i=NZ(n,e,t),a=i.horizontal,o=i.vertical,c=r?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:BZ(n,e,t),u=c.horizontal,d=c.vertical,h=wk(a,u),p=wk(o,d),m=Ee(h),b=Ee(p);return{horizontal:{isBound:a.isBound,isSnap:u.isSnap,offset:h,dist:m},vertical:{isBound:o.isBound,isSnap:d.isSnap,offset:p,dist:b}}}function nJ(n,e,t,r,i){var a=[-t[0],-t[1]],o=n.state,c=o.width,u=o.height,d=n.props.bounds,h=1/0,p=1/0;if(d){var m=[[t[0],-t[1]],[-t[0],t[1]]],b=d.left,_=b===void 0?-1/0:b,w=d.top,S=w===void 0?-1/0:w,T=d.right,C=T===void 0?1/0:T,R=d.bottom,O=R===void 0?1/0:R;m.forEach(function(P){var N=P[0]!==a[0],A=P[1]!==a[1],I=Yn(e,P),k=An(r,I)*360/Math.PI;if(A){var z=I.slice();(Ee(k-360)<2||Ee(k-180)<2)&&(z[1]=r[1]);var V=X_(r,z,(r[1]<I[1]?O:S)-I[1],!1,i),B=te(V.offset,2),j=B[1],X=V.isOutside;isNaN(j)||(p=u+(X?1:-1)*Ee(j))}if(N){var z=I.slice();(Ee(k-90)<2||Ee(k-270)<2)&&(z[0]=r[0]);var H=X_(r,z,(r[0]<I[0]?C:_)-I[0],!0,i),$=te(H.offset,1),W=$[0],ee=H.isOutside;isNaN(W)||(h=c+(ee?1:-1)*Ee(W))}})}return{maxWidth:h,maxHeight:p}}var Tr={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(n,e){var t=n.props,r=t.hideThrottleDragRotateLine,i=t.throttleDragRotate,a=t.zoom,o=n.getState(),c=o.dragInfo,u=o.beforeOrigin;if(r||!i||!c)return[];var d=c.dist;if(!d[0]&&!d[1])return[];var h=Pi(d),p=An(d,[0,0]);return[e.createElement("div",{className:$e("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(h,"px"),transform:"translate(".concat(u[0],"px, ").concat(u[1],"px) rotate(").concat(p,"rad) scaleY(").concat(a,")")}})]},dragStart:function(n,e){var t=e.datas,r=e.parentEvent,i=e.parentGesto,a=n.state,o=a.gestos,c=a.style;if(o.draggable)return!1;o.draggable=i||n.targetGesto,t.datas={},t.left=parseFloat(c.left||"")||0,t.top=parseFloat(c.top||"")||0,t.bottom=parseFloat(c.bottom||"")||0,t.right=parseFloat(c.right||"")||0,t.startValue=[0,0],Vc(n,e),uy(n,e,"translate"),_J(n,t),t.prevDist=[0,0],t.prevBeforeDist=[0,0],t.isDrag=!1,t.deltaOffset=[0,0];var u=dt(n,e,J({set:function(h){t.startValue=h}},cy(n,e))),d=r||Oe(n,"onDragStart",u);return d!==!1?(t.isDrag=!0,n.state.dragInfo={startRect:n.getRect(),dist:[0,0]}):(o.draggable=null,t.isPinch=!1),t.isDrag?u:!1},drag:function(n,e){if(e){oy(n,e,"translate");var t=e.datas,r=e.parentEvent,i=e.parentFlag,a=e.isPinch,o=e.deltaOffset,c=e.useSnap,u=e.isRequest,d=e.isGroup,h=e.parentThrottleDrag,p=e.distX,m=e.distY,b=t.isDrag,_=t.prevDist,w=t.prevBeforeDist,S=t.startValue;if(b){o&&(p+=o[0],m+=o[1]);var T=n.props,C=T.parentMoveable,R=d?0:T.throttleDrag||h||0,O=r?0:T.throttleDragRotate||0,P=0,N=!1,A=!1,I=!1,k=!1;if(!r&&O>0&&(p||m)){var z=T.startDragRotate||0,V=at(z+An([0,0],[p,m])*180/Math.PI,O)-z,B=m*Math.abs(Math.cos((V-90)/180*Math.PI)),j=p*Math.abs(Math.cos(V/180*Math.PI)),X=Pi([j,B]);P=V*Math.PI/180,p=X*Math.cos(P),m=X*Math.sin(P)}if(!a&&!r&&!i){var H=te(ZZ(n,p,m,O,!c&&u||o,t),2),$=H[0],W=H[1];N=$.isSnap,A=$.isBound,I=W.isSnap,k=W.isBound;var ee=$.offset,he=W.offset;p+=ee,m+=he}var K=It(gj({datas:t,distX:p,distY:m}),S),G=It(hZ({datas:t,distX:p,distY:m}),S);tk(G,kr),tk(K,kr),O||(!N&&!A&&(G[0]=at(G[0],R),K[0]=at(K[0],R)),!I&&!k&&(G[1]=at(G[1],R),K[1]=at(K[1],R)));var Y=Ke(K,S),re=Ke(G,S),Z=Ke(re,_),oe=Ke(Y,w);t.prevDist=re,t.prevBeforeDist=Y,t.passDelta=Z,t.passDist=re;var fe=t.left+Y[0],be=t.top+Y[1],Ce=t.right-Y[0],we=t.bottom-Y[1],Pe=ly(t,"translate(".concat(G[0],"px, ").concat(G[1],"px)"),"translate(".concat(re[0],"px, ").concat(re[1],"px)"));if(_S(e,Pe),n.state.dragInfo.dist=r?[0,0]:re,!(!r&&!C&&Z.every(function(qe){return!qe})&&oe.some(function(qe){return!qe}))){var ue=n.state,_e=ue.width,ze=ue.height,Ne=dt(n,e,J({transform:Pe,dist:re,delta:Z,translate:G,beforeDist:Y,beforeDelta:oe,beforeTranslate:K,left:fe,top:be,right:Ce,bottom:we,width:_e,height:ze,isPinch:a},Rr({transform:Pe},e)));return!r&&Oe(n,"onDrag",Ne),Ne}}}},dragAfter:function(n,e){var t=e.datas,r=t.deltaOffset;return r[0]||r[1]?(t.deltaOffset=[0,0],this.drag(n,J(J({},e),{deltaOffset:r}))):!1},dragEnd:function(n,e){var t=e.parentEvent,r=e.datas;if(n.state.dragInfo=null,!!r.isDrag){r.isDrag=!1;var i=li(n,e,{});return!t&&Oe(n,"onDragEnd",i),i}},dragGroupStart:function(n,e){var t,r,i=e.datas,a=e.clientX,o=e.clientY,c=this.dragStart(n,e);if(!c)return!1;var u=u1(n,this,"dragStart",[a||0,o||0],e,!1,"draggable"),d=u.childEvents,h=u.eventParams,p=J(J({},c),{targets:n.props.targets,events:h}),m=Oe(n,"onDragGroupStart",p);i.isDrag=m!==!1;var b=(r=(t=d[0])===null||t===void 0?void 0:t.datas.startValue)!==null&&r!==void 0?r:[0,0];return i.throttleOffset=[b[0]%1,b[1]%1],i.isDrag?c:!1},dragGroup:function(n,e){var t=e.datas;if(t.isDrag){var r=this.drag(n,J(J({},e),{parentThrottleDrag:n.props.throttleDrag})),i=e.datas.passDelta,a=u1(n,this,"drag",i,e,!1,"draggable").eventParams;if(r){var o=J({targets:n.props.targets,events:a},r);return Oe(n,"onDragGroup",o),o}}},dragGroupEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isDrag){this.dragEnd(n,e);var i=u1(n,this,"dragEnd",[0,0],e,!1,"draggable").eventParams;return Oe(n,"onDragGroupEnd",li(n,e,{targets:n.props.targets,events:i})),t}},request:function(n){var e={},t=n.getRect(),r=0,i=0,a=!1;return{isControl:!1,requestStart:function(o){return a=o.useSnap,{datas:e,useSnap:a}},request:function(o){return"x"in o?r=o.x-t.left:"deltaX"in o&&(r+=o.deltaX),"y"in o?i=o.y-t.top:"deltaY"in o&&(i+=o.deltaY),{datas:e,distX:r,distY:i,useSnap:a}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:a}}}},unset:function(n){n.state.gestos.draggable=null,n.state.dragInfo=null}};function Oj(n,e){var t=Yn(n,e),r=[0,0];return{fixedPosition:t,fixedDirection:e,fixedOffset:r}}function rJ(n,e){var t=n.allMatrix,r=n.is3d,i=n.width,a=n.height,o=r?4:3,c=[i/2*(1+e[0]),a/2*(1+e[1])],u=cn(t,c,o),d=[0,0];return{fixedPosition:u,fixedDirection:e,fixedOffset:d}}function jj(n,e){var t=n.allMatrix,r=n.is3d,i=n.width,a=n.height,o=r?4:3,c=_Z(e,i,a),u=cn(t,e,o),d=[i?0:e[0],a?0:e[1]];return{fixedPosition:u,fixedDirection:c,fixedOffset:d}}var Ek=MS("resizable"),W_={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:Ej("resizable"),dragControlCondition:Ek,viewClassName:NS("resizable"),dragControlStart:function(n,e){var t,r=e.inputEvent,i=e.isPinch,a=e.isGroup,o=e.parentDirection,c=e.parentGesto,u=e.datas,d=e.parentFixedDirection,h=e.parentEvent,p=Xj(o,i,r,u),m=n.state,b=m.target,_=m.width,w=m.height,S=m.gestos;if(!p||!b||S.resizable)return!1;S.resizable=c||n.controlGesto,!i&&Vc(n,e),u.datas={},u.direction=p,u.startOffsetWidth=_,u.startOffsetHeight=w,u.prevWidth=0,u.prevHeight=0,u.minSize=[0,0],u.startWidth=m.inlineCSSWidth||m.cssWidth,u.startHeight=m.inlineCSSHeight||m.cssHeight,u.maxSize=[1/0,1/0],a||(u.minSize=[m.minOffsetWidth,m.minOffsetHeight],u.maxSize=[m.maxOffsetWidth,m.maxOffsetHeight]);var T=n.props.transformOrigin||"% %";u.transformOrigin=Fr(T)?T.split(" "):T,u.startOffsetMatrix=m.offsetMatrix,u.startTransformOrigin=m.transformOrigin,u.isWidth=(t=e?.parentIsWidth)!==null&&t!==void 0?t:!p[0]&&!p[1]||p[0]||!p[1];function C(k){u.ratio=k&&isFinite(k)?k:0}u.startPositions=Oi(n.state);function R(k){var z=Oj(u.startPositions,k);u.fixedDirection=z.fixedDirection,u.fixedPosition=z.fixedPosition,u.fixedOffset=z.fixedOffset}function O(k){var z=jj(n.state,k);u.fixedDirection=z.fixedDirection,u.fixedPosition=z.fixedPosition,u.fixedOffset=z.fixedOffset}function P(k){u.minSize=[Ht("".concat(k[0]),0)||0,Ht("".concat(k[1]),0)||0]}function N(k){var z=[k[0]||1/0,k[1]||1/0];(!xd(z[0])||isFinite(z[0]))&&(z[0]=Ht("".concat(z[0]),0)||1/0),(!xd(z[1])||isFinite(z[1]))&&(z[1]=Ht("".concat(z[1]),0)||1/0),u.maxSize=z}C(_/w),R(d||[-p[0],-p[1]]),u.setFixedDirection=R,u.setFixedPosition=O,u.setMin=P,u.setMax=N;var A=dt(n,e,{direction:p,startRatio:u.ratio,set:function(k){var z=te(k,2),V=z[0],B=z[1];u.startWidth=V,u.startHeight=B},setMin:P,setMax:N,setRatio:C,setFixedDirection:R,setFixedPosition:O,setOrigin:function(k){u.transformOrigin=k},dragStart:Tr.dragStart(n,new wd().dragStart([0,0],e))}),I=h||Oe(n,"onResizeStart",A);return u.startFixedDirection=u.fixedDirection,u.startFixedPosition=u.fixedPosition,I!==!1&&(u.isResize=!0,n.state.snapRenderInfo={request:e.isRequest,direction:p}),u.isResize?A:!1},dragControl:function(n,e){var t,r=e.datas,i=e.parentFlag,a=e.isPinch,o=e.parentKeepRatio,c=e.dragClient,u=e.parentDist,d=e.useSnap,h=e.isRequest,p=e.isGroup,m=e.parentEvent,b=e.resolveMatrix,_=r.isResize,w=r.transformOrigin,S=r.startWidth,T=r.startHeight,C=r.prevWidth,R=r.prevHeight,O=r.minSize,P=r.maxSize,N=r.ratio,A=r.startOffsetWidth,I=r.startOffsetHeight,k=r.isWidth;if(!_)return;if(b){var z=n.state.is3d,V=r.startOffsetMatrix,B=r.startTransformOrigin,j=z?4:3,X=up(cv(e)),H=Math.sqrt(X.length);j!==H&&(X=la(X,H,j));var $=eg(V,X,B,j),W=zc($,A,I,j);r.startPositions=W,r.nextTargetMatrix=X,r.nextAllMatrix=$}var ee=kc(n.props,"resizable"),he=ee.resizeFormat,K=ee.throttleResize,G=K===void 0?i?0:1:K,Y=ee.parentMoveable,re=ee.keepRatioFinally,Z=r.direction,oe=Z,fe=0,be=0;!Z[0]&&!Z[1]&&(oe=[1,1]);var Ce=N&&(o??ee.keepRatio)||!1;function we(){var ft=r.fixedDirection,kt=t5(oe,Ce,r,e);fe=kt.distWidth,be=kt.distHeight;var pn=oe[0]-ft[0]||Ce?Math.max(A+fe,kr):A,Ut=oe[1]-ft[1]||Ce?Math.max(I+be,kr):I;return Ce&&A&&I&&(k?Ut=pn/N:pn=Ut*N),[pn,Ut]}var Pe=te(we(),2),ue=Pe[0],_e=Pe[1];m||(r.setFixedDirection(r.fixedDirection),Oe(n,"onBeforeResize",dt(n,e,{startFixedDirection:r.startFixedDirection,startFixedPosition:r.startFixedPosition,setFixedDirection:function(ft){var kt;return r.setFixedDirection(ft),kt=te(we(),2),ue=kt[0],_e=kt[1],[ue,_e]},setFixedPosition:function(ft){var kt;return r.setFixedPosition(ft),kt=te(we(),2),ue=kt[0],_e=kt[1],[ue,_e]},boundingWidth:ue,boundingHeight:_e,setSize:function(ft){var kt;kt=te(ft,2),ue=kt[0],_e=kt[1]}},!0)));var ze=c;c||(!i&&a?ze=TZ(n,[0,0]):ze=r.fixedPosition);var Ne=[0,0];a||(Ne=bJ(n,ue,_e,Z,ze,!d&&h,r)),u&&(!u[0]&&(Ne[0]=0),!u[1]&&(Ne[1]=0));function qe(){var ft;he&&(ft=te(he([ue,_e]),2),ue=ft[0],_e=ft[1]),ue=at(ue,G),_e=at(_e,G)}if(Ce){oe[0]&&oe[1]&&Ne[0]&&Ne[1]&&(Ee(Ne[0])>Ee(Ne[1])?Ne[1]=0:Ne[0]=0);var Fe=!Ne[0]&&!Ne[1];Fe&&qe(),oe[0]&&!oe[1]||Ne[0]&&!Ne[1]||Fe&&k?(ue+=Ne[0],_e=ue/N):(!oe[0]&&oe[1]||!Ne[0]&&Ne[1]||Fe&&!k)&&(_e+=Ne[1],ue=_e*N)}else ue+=Ne[0],_e+=Ne[1],ue=Math.max(0,ue),_e=Math.max(0,_e);t=te(C3([ue,_e],O,P,Ce?N:!1),2),ue=t[0],_e=t[1],qe(),Ce&&(p||re)&&(k?_e=ue/N:ue=_e*N),fe=ue-A,be=_e-I;var Te=[fe-C,be-R];r.prevWidth=fe,r.prevHeight=be;var Le=SZ(n,ue,_e,ze,w,r);if(!(!Y&&Te.every(function(ft){return!ft})&&Le.every(function(ft){return!ft}))){var Me=Tr.drag(n,Jp(e,n.state,Le,!!a,!1,"draggable")),Be=Me.transform,lt=S+fe,At=T+be,et=dt(n,e,J({width:lt,height:At,offsetWidth:Math.round(ue),offsetHeight:Math.round(_e),startRatio:N,boundingWidth:ue,boundingHeight:_e,direction:Z,dist:[fe,be],delta:Te,isPinch:!!a,drag:Me},Qj({style:{width:"".concat(lt,"px"),height:"".concat(At,"px")},transform:Be},Me,e)));return!m&&Oe(n,"onResize",et),et}},dragControlAfter:function(n,e){var t=e.datas,r=t.isResize,i=t.startOffsetWidth,a=t.startOffsetHeight,o=t.prevWidth,c=t.prevHeight;if(!(!r||n.props.checkResizableError===!1)){var u=n.state,d=u.width,h=u.height,p=d-(i+o),m=h-(a+c),b=Ee(p)>3,_=Ee(m)>3;if(b&&(t.startWidth+=p,t.startOffsetWidth+=p,t.prevWidth+=p),_&&(t.startHeight+=m,t.startOffsetHeight+=m,t.prevHeight+=m),b||_)return this.dragControl(n,e)}},dragControlEnd:function(n,e){var t=e.datas,r=e.parentEvent;if(t.isResize){t.isResize=!1;var i=li(n,e,{});return!r&&Oe(n,"onResizeEnd",i),i}},dragGroupControlCondition:Ek,dragGroupControlStart:function(n,e){var t=e.datas,r=this.dragControlStart(n,J(J({},e),{isGroup:!0}));if(!r)return!1;var i=na(n,"resizable",e),a=t.startOffsetWidth,o=t.startOffsetHeight;function c(){var b=t.minSize;i.forEach(function(_){var w=_.datas,S=w.minSize,T=w.startOffsetWidth,C=w.startOffsetHeight,R=a*(T?S[0]/T:0),O=o*(C?S[1]/C:0);b[0]=Math.max(b[0],R),b[1]=Math.max(b[1],O)})}function u(){var b=t.maxSize;i.forEach(function(_){var w=_.datas,S=w.maxSize,T=w.startOffsetWidth,C=w.startOffsetHeight,R=a*(T?S[0]/T:0),O=o*(C?S[1]/C:0);b[0]=Math.min(b[0],R),b[1]=Math.min(b[1],O)})}var d=Cs(n,this,"dragControlStart",e,function(b,_){return uv(n,b,t,_)});c(),u();var h=function(b){r.setFixedDirection(b),d.forEach(function(_,w){_.setFixedDirection(b),uv(n,_.moveable,t,i[w])})};t.setFixedDirection=h;var p=J(J({},r),{targets:n.props.targets,events:d.map(function(b){return J(J({},b),{setMin:function(_){b.setMin(_),c()},setMax:function(_){b.setMax(_),u()}})}),setFixedDirection:h,setMin:function(b){r.setMin(b),c()},setMax:function(b){r.setMax(b),u()}}),m=Oe(n,"onResizeGroupStart",p);return t.isResize=m!==!1,t.isResize?r:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isResize){var r=kc(n.props,"resizable");gy(n,"onBeforeResize",function(b){Oe(n,"onBeforeResizeGroup",dt(n,e,J(J({},b),{targets:r.targets}),!0))});var i=this.dragControl(n,J(J({},e),{isGroup:!0}));if(i){var a=i.boundingWidth,o=i.boundingHeight,c=i.dist,u=r.keepRatio,d=[a/(a-c[0]),o/(o-c[1])],h=t.fixedPosition,p=Cs(n,this,"dragControl",e,function(b,_){var w=te(br(Wp(n.rotation/180*Math.PI,3),[_.datas.originalX*d[0],_.datas.originalY*d[1],1],3),2),S=w[0],T=w[1];return J(J({},_),{parentDist:null,parentScale:d,dragClient:It(h,[S,T]),parentKeepRatio:u})}),m=J({targets:r.targets,events:p},i);return Oe(n,"onResizeGroup",m),m}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isResize){this.dragControlEnd(n,e);var i=Cs(n,this,"dragControlEnd",e),a=li(n,e,{targets:n.props.targets,events:i});return Oe(n,"onResizeGroupEnd",a),t}},request:function(n){var e={},t=0,r=0,i=!1,a=n.getRect();return{isControl:!0,requestStart:function(o){var c;return i=o.useSnap,{datas:e,parentDirection:o.direction||[1,1],parentIsWidth:(c=o?.horizontal)!==null&&c!==void 0?c:!0,useSnap:i}},request:function(o){return"offsetWidth"in o?t=o.offsetWidth-a.offsetWidth:"deltaWidth"in o&&(t+=o.deltaWidth),"offsetHeight"in o?r=o.offsetHeight-a.offsetHeight:"deltaHeight"in o&&(r+=o.deltaHeight),{datas:e,parentDist:[t,r],parentKeepRatio:o.keepRatio,useSnap:i}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:i}}}},unset:function(n){n.state.gestos.resizable=null}};function d1(n,e,t,r,i){var a=n.props.groupable,o=n.state,c=o.is3d?4:3,u=e.origin,d=cn(n.state.rootMatrix,Ke([u[0],u[1]],a?[0,0]:[o.left,o.top]),c),h=It([i.left,i.top],d);e.startAbsoluteOrigin=h,e.prevDeg=An(h,[t,r])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=As(h,[t,r])}function _0(n,e,t){var r=t.defaultDeg,i=t.prevDeg,a=i%360,o=Math.floor(i/360);a<0&&(a+=360),a>n&&a>270&&n<90?++o:a<n&&a<90&&n>270&&--o;var c=e*(o*360+n-r);return t.prevDeg=r+c,c}function f1(n,e,t,r){return _0(An(r.startAbsoluteOrigin,[n,e])/Math.PI*180,t,r)}function h1(n,e,t,r,i,a){var o=n.props.throttleRotate,c=o===void 0?0:o,u=t.prevSnapDeg,d=0,h=!1;if(a){var p=yJ(n,e,r,i+r);h=p.isSnap,d=i+p.dist}h||(d=at(i+r,c));var m=d-i;return t.prevSnapDeg=m,[m-u,m,d]}function Vj(n,e,t){var r=te(e,4),i=r[0],a=r[1],o=r[2],c=r[3];if(n==="none")return[];if(Fn(n))return n.map(function(S){return Vj(S,[i,a,o,c],t)[0]});var u=te((n||"top").split("-"),2),d=u[0],h=u[1],p=[i,a];d==="left"?p=[o,i]:d==="right"?p=[a,c]:d==="bottom"&&(p=[c,o]);var m=[(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2],b=Yj(p,t);if(h){var _=h==="top"||h==="left",w=d==="bottom"||d==="left";m=p[_&&!w||!_&&w?0:1]}return[[m,b]]}function Q_(n,e){if(e.isRequest)return e.requestAble==="rotatable";var t=e.inputEvent.target;if(Hn(t,$e("rotation-control"))||n.props.rotateAroundControls&&Hn(t,$e("around-control"))||Hn(t,$e("control"))&&Hn(t,$e("rotatable")))return!0;var r=n.props.rotationTarget;return r?PS(r,!0).some(function(i){return i?t===i||t.contains(i):!1}):!1}var iJ=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,aJ={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[iJ],viewClassName:function(n){return n.isDragging("rotatable")?$e("view-rotation-dragging"):""},render:function(n,e){var t=kc(n.props,"rotatable"),r=t.rotatable,i=t.rotationPosition,a=t.zoom,o=t.renderDirections,c=t.rotateAroundControls,u=t.resolveAblesWithRotatable,d=n.getState(),h=d.renderPoses,p=d.direction;if(!r)return null;var m=Vj(i,h,p),b=[];if(m.forEach(function(T,C){var R=te(T,2),O=R[0],P=R[1];b.push(e.createElement("div",{key:"rotation".concat(C),className:$e("rotation"),style:{transform:"translate(-50%) translate(".concat(O[0],"px, ").concat(O[1],"px) rotate(").concat(P,"rad)")}},e.createElement("div",{className:$e("line rotation-line"),style:{transform:"scaleX(".concat(a,")")}}),e.createElement("div",{className:$e("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(a,")")}})))}),o){var _=js(u||{}),w={};_.forEach(function(T){u[T].forEach(function(C){w[C]=T})});var S=[];Fn(o)&&(S=o.map(function(T){var C=w[T];return{data:C?{resolve:C}:{},classNames:C?["move"]:[],dir:T}})),b.push.apply(b,Ie([],te(xj(n,"rotatable",S,e)),!1))}return c&&b.push.apply(b,Ie([],te(Tj(n,e)),!1)),b},dragControlCondition:Q_,dragControlStart:function(n,e){var t,r,i=e.datas,a=e.clientX,o=e.clientY,c=e.parentRotate,u=e.parentFlag,d=e.isPinch,h=e.isRequest,p=n.state,m=p.target,b=p.left,_=p.top,w=p.direction,S=p.beforeDirection,T=p.targetTransform,C=p.moveableClientRect,R=p.offsetMatrix,O=p.targetMatrix,P=p.allMatrix,N=p.width,A=p.height;if(!h&&!m)return!1;var I=n.getRect();i.rect=I,i.transform=T,i.left=b,i.top=_;var k=function(oe){var fe=jj(n.state,oe);i.fixedDirection=fe.fixedDirection,i.fixedOffset=fe.fixedOffset,i.fixedPosition=fe.fixedPosition,G&&G.setFixedPosition(oe)},z=function(oe){var fe=rJ(n.state,oe);i.fixedDirection=fe.fixedDirection,i.fixedOffset=fe.fixedOffset,i.fixedPosition=fe.fixedPosition,G&&G.setFixedDirection(oe)},V=a,B=o;if(h||d||u){var j=c||0;i.beforeInfo={origin:I.beforeOrigin,prevDeg:j,defaultDeg:j,prevSnapDeg:0,startDist:0},i.afterInfo=J(J({},i.beforeInfo),{origin:I.origin}),i.absoluteInfo=J(J({},i.beforeInfo),{origin:I.origin,startValue:j})}else{var X=(r=e.inputEvent)===null||r===void 0?void 0:r.target;if(X){var H=X.getAttribute("data-direction")||"",$=dZ[H];if($){i.isControl=!0,i.isAroundControl=Hn(X,$e("around-control")),i.controlDirection=$;var W=X.getAttribute("data-resolve");W&&(i.resolveAble=W);var ee=PJ(p.rootMatrix,p.renderPoses,C);t=te(Yn(ee,$),2),V=t[0],B=t[1]}}i.beforeInfo={origin:I.beforeOrigin},i.afterInfo={origin:I.origin},i.absoluteInfo={origin:I.origin,startValue:I.rotation};var he=k;k=function(oe){var fe=p.is3d?4:3,be=te(It(J3(O,fe),oe),2),Ce=be[0],we=be[1],Pe=br(R,Ic([Ce,we],fe)),ue=br(P,Ic([oe[0],oe[1]],fe));he(oe);var _e=p.posDelta;i.beforeInfo.origin=Ke(Pe,_e),i.afterInfo.origin=Ke(ue,_e),i.absoluteInfo.origin=Ke(ue,_e),d1(n,i.beforeInfo,V,B,C),d1(n,i.afterInfo,V,B,C),d1(n,i.absoluteInfo,V,B,C)},z=function(oe){var fe=Yn([[0,0],[N,0],[0,A],[N,A]],oe);k(fe)}}i.startClientX=V,i.startClientY=B,i.direction=w,i.beforeDirection=S,i.startValue=0,i.datas={},uy(n,e,"rotate");var K=!1,G=!1;if(i.isControl&&i.resolveAble){var Y=i.resolveAble;Y==="resizable"&&(G=W_.dragControlStart(n,J(J({},new wd("resizable").dragStart([0,0],e)),{parentPosition:i.controlPosition,parentFixedPosition:i.fixedPosition})))}G||(K=Tr.dragStart(n,new wd().dragStart([0,0],e))),k(OJ(n));var re=dt(n,e,J(J({set:function(oe){i.startValue=oe*Math.PI/180},setFixedDirection:z,setFixedPosition:k},cy(n,e)),{dragStart:K,resizeStart:G})),Z=Oe(n,"onRotateStart",re);return i.isRotate=Z!==!1,p.snapRenderInfo={request:e.isRequest},i.isRotate?re:!1},dragControl:function(n,e){var t,r,i,a=e.datas,o=e.clientDistX,c=e.clientDistY,u=e.parentRotate,d=e.parentFlag,h=e.isPinch,p=e.groupDelta,m=e.resolveMatrix,b=a.beforeDirection,_=a.beforeInfo,w=a.afterInfo,S=a.absoluteInfo,T=a.isRotate,C=a.startValue,R=a.rect,O=a.startClientX,P=a.startClientY;if(T){oy(n,e,"rotate");var N=fZ(e),A=b*N,I=n.props.parentMoveable,k=0,z,V,B=0,j,X,H=0,$,W,ee=180/Math.PI*C,he=S.startValue,K=!1,G=O+o,Y=P+c;if(!d&&"parentDist"in e){var re=e.parentDist;z=re,j=re,$=re}else h||d?(z=_0(u,b,_),j=_0(u,A,w),$=_0(u,A,S)):(z=f1(G,Y,b,_),j=f1(G,Y,A,w),$=f1(G,Y,A,S),K=!0);if(V=ee+z,X=ee+j,W=he+$,Oe(n,"onBeforeRotate",dt(n,e,{beforeRotation:V,rotation:X,absoluteRotation:W,setRotation:function(ze){j=ze-ee,z=j,$=j}},!0)),t=te(h1(n,R,_,z,ee,K),3),k=t[0],z=t[1],V=t[2],r=te(h1(n,R,w,j,ee,K),3),B=r[0],j=r[1],X=r[2],i=te(h1(n,R,S,$,he,K),3),H=i[0],$=i[1],W=i[2],!(!H&&!B&&!k&&!I&&!m)){var Z=ly(a,"rotate(".concat(X,"deg)"),"rotate(".concat(j,"deg)"));m&&(a.fixedPosition=wS(n,a.targetAllTransform,a.fixedDirection,a.fixedOffset,a));var oe=EZ(n,j,a),fe=Ke(It(p||[0,0],oe),a.prevInverseDist||[0,0]);a.prevInverseDist=oe,a.requestValue=null;var be=vj(n,Z,fe,h,e),Ce=be,we=As([G,Y],S.startAbsoluteOrigin)-S.startDist,Pe=void 0;if(a.resolveAble==="resizable"){var ue=W_.dragControl(n,J(J({},Jp(e,n.state,[e.deltaX,e.deltaY],!!h,!1,"resizable")),{resolveMatrix:!0,parentDistance:we}));ue&&(Pe=ue,Ce=Qj(Ce,ue,e))}var _e=dt(n,e,J(J({delta:B,dist:j,rotate:X,rotation:X,beforeDist:z,beforeDelta:k,beforeRotate:V,beforeRotation:V,absoluteDist:$,absoluteDelta:H,absoluteRotate:W,absoluteRotation:W,isPinch:!!h,resize:Pe},be),Ce));return Oe(n,"onRotate",_e),_e}}},dragControlEnd:function(n,e){var t=e.datas;if(t.isRotate){t.isRotate=!1;var r=li(n,e,{});return Oe(n,"onRotateEnd",r),r}},dragGroupControlCondition:Q_,dragGroupControlStart:function(n,e){var t=e.datas,r=n.state,i=r.left,a=r.top,o=r.beforeOrigin,c=this.dragControlStart(n,e);if(!c)return!1;c.set(t.beforeDirection*n.rotation);var u=Cs(n,this,"dragControlStart",e,function(p,m){var b=p.state,_=b.left,w=b.top,S=b.beforeOrigin,T=It(Ke([_,w],[i,a]),Ke(S,o));return m.datas.startGroupClient=T,m.datas.groupClient=T,J(J({},m),{parentRotate:0})}),d=J(J({},c),{targets:n.props.targets,events:u}),h=Oe(n,"onRotateGroupStart",d);return t.isRotate=h!==!1,t.isRotate?c:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isRotate){gy(n,"onBeforeRotate",function(d){Oe(n,"onBeforeRotateGroup",dt(n,e,J(J({},d),{targets:n.props.targets}),!0))});var r=this.dragControl(n,e);if(r){var i=t.beforeDirection,a=r.beforeDist,o=a/180*Math.PI,c=Cs(n,this,"dragControl",e,function(d,h){var p=h.datas.startGroupClient,m=te(h.datas.groupClient,2),b=m[0],_=m[1],w=te(Xp(p,o*i),2),S=w[0],T=w[1],C=[S-b,T-_];return h.datas.groupClient=[S,T],J(J({},h),{parentRotate:a,groupDelta:C})});n.rotation=i*r.beforeRotation;var u=J({targets:n.props.targets,events:c,set:function(d){n.rotation=d},setGroupRotation:function(d){n.rotation=d}},r);return Oe(n,"onRotateGroup",u),u}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isRotate){this.dragControlEnd(n,e);var i=Cs(n,this,"dragControlEnd",e),a=li(n,e,{targets:n.props.targets,events:i});return Oe(n,"onRotateGroupEnd",a),t}},request:function(n){var e={},t=0,r=n.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(i){return"deltaRotate"in i?t+=i.deltaRotate:"rotate"in i&&(t=i.rotate-r),{datas:e,parentDist:t}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function sJ(n,e){var t,r=n.direction,i=n.classNames,a=n.size,o=n.pos,c=n.zoom,u=n.key,d=r==="horizontal",h=d?"Y":"X";return e.createElement("div",{key:u,className:i.join(" "),style:(t={},t[d?"width":"height"]="".concat(a),t.transform="translate(".concat(o[0],", ").concat(o[1],") translate").concat(h,"(-50%) scale").concat(h,"(").concat(c,")"),t)})}function IS(n,e){return sJ(J(J({},n),{classNames:Ie([$e("line","guideline",n.direction)],te(n.classNames),!1).filter(function(t){return t}),size:n.size||"".concat(n.sizeValue,"px"),pos:n.pos||n.posValue.map(function(t){return"".concat(at(t,.1),"px")})}),e)}function Sk(n,e,t,r,i,a,o,c){var u=n.props.zoom;return t.map(function(d,h){var p=d.type,m=d.pos,b=[0,0];return b[o]=r,b[o?0:1]=-i+m,IS({key:"".concat(e,"TargetGuideline").concat(h),classNames:[$e("target","bold",p)],posValue:b,sizeValue:a,zoom:u,direction:e},c)})}function Tk(n,e,t,r,i,a){var o=n.props,c=o.zoom,u=o.isDisplayInnerSnapDigit,d=e==="horizontal"?rl:il,h=i[d.start],p=i[d.end];return t.filter(function(m){var b=m.hide,_=m.elementRect;if(b)return!1;if(u&&_){var w=_.rect;if(w[d.start]<=h&&p<=w[d.end])return!1}return!0}).map(function(m,b){var _=m.pos,w=m.size,S=m.element,T=m.className,C=[-r[0]+_[0],-r[1]+_[1]];return IS({key:"".concat(e,"-default-guideline-").concat(b),classNames:S?[$e("bold"),T]:[$e("normal"),T],direction:e,posValue:C,sizeValue:w,zoom:c},a)})}function fh(n,e,t,r,i,a,o,c){var u,d=n.props,h=d.snapDigit,p=h===void 0?0:h,m=d.isDisplaySnapDigit,b=m===void 0?!0:m,_=d.snapDistFormat,w=_===void 0?function(P,N){return P}:_,S=d.zoom,T=e==="horizontal"?"X":"Y",C=e==="vertical"?"height":"width",R=Math.abs(i),O=b?parseFloat(R.toFixed(p)):0;return c.createElement("div",{key:"".concat(e,"-").concat(t,"-guideline-").concat(r),className:$e("guideline-group",e),style:(u={left:"".concat(a[0],"px"),top:"".concat(a[1],"px")},u[C]="".concat(R,"px"),u)},IS({direction:e,classNames:[$e(t),o],size:"100%",posValue:[0,0],sizeValue:R,zoom:S},c),c.createElement("div",{className:$e("size-value","gap"),style:{transform:"translate".concat(T,"(-50%) scale(").concat(S,")")}},O>0?w(O,e):""))}function oJ(n,e,t,r){var i=n==="vertical"?0:1,a=n==="vertical"?1:0,o=i?rl:il,c=t[o.start],u=t[o.end];return Zj(e,function(d){return d.pos[i]}).map(function(d){var h=[],p=[],m=[];return d.forEach(function(b){var _,w,S=b.element,T=b.elementRect.rect;if(T[o.end]<c)h.push(b);else if(u<T[o.start])p.push(b);else if(T[o.start]<=c&&u<=T[o.end]&&r){var C=b.pos,R={element:S,rect:J(J({},T),(_={},_[o.end]=T[o.start],_))},O={element:S,rect:J(J({},T),(w={},w[o.start]=T[o.end],w))},P=[0,0],N=[0,0];P[i]=C[i],P[a]=C[a],N[i]=C[i],N[a]=C[a]+b.size,h.push({type:n,pos:P,size:0,elementRect:R,direction:"",elementDirection:"end"}),p.push({type:n,pos:N,size:0,elementRect:O,direction:"",elementDirection:"start"})}}),h.sort(function(b,_){return _.pos[a]-b.pos[a]}),p.sort(function(b,_){return b.pos[a]-_.pos[a]}),{total:d,start:h,end:p,inner:m}})}function lJ(n,e,t,r,i){var a=n.props.isDisplayInnerSnapDigit,o=[];return["vertical","horizontal"].forEach(function(c){var u=e.filter(function(S){return S.type===c}),d=c==="vertical"?1:0,h=d?0:1,p=oJ(c,u,r,a),m=d?il:rl,b=d?rl:il,_=r[m.start],w=r[m.end];p.forEach(function(S){var T=S.total,C=S.start,R=S.end,O=S.inner,P=t[h]+T[0].pos[h]-r[b.start],N=r;C.forEach(function(A){var I=A.elementRect.rect,k=N[m.start]-I[m.end];if(k>0){var z=[0,0];z[d]=t[d]+N[m.start]-_-k,z[h]=P,o.push(fh(n,c,"dashed",o.length,k,z,A.className,i))}N=I}),N=r,R.forEach(function(A){var I=A.elementRect.rect,k=I[m.start]-N[m.end];if(k>0){var z=[0,0];z[d]=t[d]+N[m.end]-_,z[h]=P,o.push(fh(n,c,"dashed",o.length,k,z,A.className,i))}N=I}),O.forEach(function(A){var I=A.elementRect.rect,k=_-I[m.start],z=I[m.end]-w,V=[0,0],B=[0,0];V[d]=t[d]-k,V[h]=P,B[d]=t[d]+w-_,B[h]=P,o.push(fh(n,c,"dashed",o.length,k,V,A.className,i)),o.push(fh(n,c,"dashed",o.length,z,B,A.className,i))})})}),o}function cJ(n,e,t,r,i){var a=[];return["horizontal","vertical"].forEach(function(o){var c=e.filter(function(S){return S.type===o}).slice(0,1),u=o==="vertical"?0:1,d=u?0:1,h=u?il:rl,p=u?rl:il,m=r[h.start],b=r[h.end],_=r[p.start],w=r[p.end];c.forEach(function(S){var T=S.gap,C=S.gapRects,R=Math.max.apply(Math,Ie([_],te(C.map(function(N){var A=N.rect;return A[p.start]})),!1)),O=Math.min.apply(Math,Ie([w],te(C.map(function(N){var A=N.rect;return A[p.end]})),!1)),P=(R+O)/2;R===O||P===(_+w)/2||C.forEach(function(N){var A=N.rect,I=N.className,k=[t[0],t[1]];if(A[h.end]<m)k[u]+=A[h.end]-m;else if(b<A[h.start])k[u]+=A[h.start]-m-T;else return;k[d]+=P-_,a.push(fh(n,u?"vertical":"horizontal","gap",a.length,T,k,I,i))})})}),a}function Z_(n){var e,t,r=n.state,i=r.containerClientRect,a=r.hasFixed,o=i.overflow,c=i.scrollHeight,u=i.scrollWidth,d=i.clientHeight,h=i.clientWidth,p=i.clientLeft,m=i.clientTop,b=n.props,_=b.snapGap,w=_===void 0?!0:_,S=b.verticalGuidelines,T=b.horizontalGuidelines,C=b.snapThreshold,R=C===void 0?5:C,O=b.maxSnapElementGuidelineDistance,P=O===void 0?1/0:O,N=b.isDisplayGridGuidelines,A=Ni(Oi(n.state)),I=A.top,k=A.left,z=A.bottom,V=A.right,B={top:I,left:k,bottom:z,right:V,center:(k+V)/2,middle:(I+z)/2},j=hJ(n),X=Ie([],te(j),!1),H=((t=(e=r.snapThresholdInfo)===null||e===void 0?void 0:e.multiples)!==null&&t!==void 0?t:[1,1]).map(function(he){return he*R});w&&X.push.apply(X,Ie([],te(uJ(n,B,H)),!1));var $=J({},r.snapOffset||{left:0,top:0,bottom:0,right:0});if(X.push.apply(X,Ie([],te(fJ(n,o?u:h,o?c:d,p,m,$,N)),!1)),a){var W=i.left,ee=i.top;$.left+=W,$.top+=ee,$.right+=W,$.bottom+=ee}return X.push.apply(X,Ie([],te(Lj(T||!1,S||!1,o?u:h,o?c:d,p,m,$)),!1)),X=X.filter(function(he){var K=he.element,G=he.elementRect,Y=he.type;if(!K||!G)return!0;var re=G.rect;return zj(B,re,Y,P)}),X}function uJ(n,e,t){var r=n.props,i=r.maxSnapElementGuidelineDistance,a=i===void 0?1/0:i,o=r.maxSnapElementGapDistance,c=o===void 0?1/0:o,u=n.state.elementRects,d=[];return[["vertical",rl,il],["horizontal",il,rl]].forEach(function(h){var p=te(h,3),m=p[0],b=p[1],_=p[2],w=e[b.start],S=e[b.end],T=e[b.center],C=e[_.start],R=e[_.end],O={left:t[0],top:t[1]};function P(I){var k=I.rect,z=O[b.start];return k[b.end]<w+z?w-k[b.end]:S-z<k[b.start]?k[b.start]-S:-1}var N=u.filter(function(I){var k=I.rect;return k[_.start]>R||k[_.end]<C?!1:P(I)>0}).sort(function(I,k){return P(I)-P(k)}),A=[];N.forEach(function(I){N.forEach(function(k){if(I!==k){var z=I.rect,V=k.rect,B=z[_.start],j=z[_.end],X=V[_.start],H=V[_.end];B>H||X>j||A.push([I,k])}})}),A.forEach(function(I){var k=te(I,2),z=k[0],V=k[1],B=z.rect,j=V.rect,X=B[b.start],H=B[b.end],$=j[b.start],W=j[b.end],ee=O[b.start],he=0,K=0,G=!1,Y=!1,re=!1;if(H<=w&&S<=$){if(Y=!0,he=($-H-(S-w))/2,K=H+he+(S-w)/2,Ee(K-T)>ee)return}else if(H<$&&W<w+ee){if(G=!0,he=$-H,K=W+he,Ee(K-w)>ee)return}else if(H<$&&S-ee<X){if(re=!0,he=$-H,K=X-he,Ee(K-S)>ee)return}else return;he&&zj(e,j,m,a)&&(he>c||d.push({type:m,pos:m==="vertical"?[K,0]:[0,K],element:V.element,size:0,className:V.className,isStart:G,isCenter:Y,isEnd:re,gap:he,hide:!0,gapRects:[z,V],direction:"",elementDirection:""}))})}),d}function dJ(n,e,t,r){var i,a,o=n.props,c=n.state,u=o.snapGridAll,d=o.snapGridWidth,h=d===void 0?0:d,p=o.snapGridHeight,m=p===void 0?0:p,b=c.snapRenderInfo,_=b&&(((i=b.direction)===null||i===void 0?void 0:i[0])||((a=b.direction)===null||a===void 0?void 0:a[1])),w=n.moveables;if(u&&w&&_&&(h||m)){if(c.snapThresholdInfo)return;c.snapThresholdInfo={multiples:[1,1],offset:[0,0]};var S=n.getRect(),T=S.children,C=b.direction;if(T){var R=C.map(function(P,N){var A=N===0?{snapSize:h,posName:"left",sizeName:"width",clientOffset:r.left-e}:{snapSize:m,posName:"top",sizeName:"height",clientOffset:r.top-t},I=A.snapSize,k=A.posName,z=A.sizeName,V=A.clientOffset;if(!I)return{dir:P,multiple:1,snapSize:I,snapOffset:0};var B=S[z],j=S[k],X=I3(T.map(function(G){return[G[k]-j,G[z],B-G[z]-G[k]+j]})).filter(function(G){return G}).sort(function(G,Y){return G-Y}),H=X[0],$=X.map(function(G){return at(G/H,.1)*I}),W=1,ee=at(B/H,.1);for(W=1;W<=10&&!$.every(function(G){return G*W%1===0});++W);var he=(-P+1)/2,K=av(j-V,j-V+B,he,1-he);return{multiple:ee*W,dir:P,snapSize:I,snapOffset:Math.round(K/I)}}),O=R.map(function(P){return P.multiple||1});c.snapThresholdInfo.multiples=O,c.snapThresholdInfo.offset=R.map(function(P){return P.snapOffset}),R.forEach(function(P,N){P.snapSize})}}else c.snapThresholdInfo=null}function fJ(n,e,t,r,i,a,o){r===void 0&&(r=0),i===void 0&&(i=0);var c=n.props,u=n.state,d=c.snapGridWidth,h=d===void 0?0:d,p=c.snapGridHeight,m=p===void 0?0:p,b=[],_=a.left,w=a.top,S=[0,0];dJ(n,r,i,a);var T=u.snapThresholdInfo,C=h,R=m;if(T&&(h*=T.multiples[0]||1,m*=T.multiples[1]||1,S=T.offset),m){for(var O=function(N){b.push({type:"horizontal",pos:[_,at(S[1]*R+N-i+w,.1)],className:$e("grid-guideline"),size:e,hide:!o,direction:"",grid:!0})},P=0;P<=t*2;P+=m)O(P);for(var P=-m;P>=-t;P-=m)O(P)}if(h){for(var O=function(A){b.push({type:"vertical",pos:[at(S[0]*C+A-r+_,.1),w],className:$e("grid-guideline"),size:t,hide:!o,direction:"",grid:!0})},P=0;P<=e*2;P+=h)O(P);for(var P=-h;P>=-e;P-=h)O(P)}return b}function zj(n,e,t,r){return t==="horizontal"?Ee(n.right-e.left)<=r||Ee(n.left-e.right)<=r||n.left<=e.right&&e.left<=n.right:t==="vertical"?Ee(n.bottom-e.top)<=r||Ee(n.top-e.bottom)<=r||n.top<=e.bottom&&e.top<=n.bottom:!0}function hJ(n){var e=n.state,t=n.props.elementGuidelines,r=t===void 0?[]:t;if(!r.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter(function(m){return!m.refresh}),a=r.map(function(m){return oa(m)&&"element"in m?J(J({},m),{element:Ga(m.element,!0)}):{element:Ga(m,!0)}}).filter(function(m){return m.element}),o=TQ(i.map(function(m){return m.element}),a.map(function(m){return m.element})),c=o.maintained,u=o.added,d=[];c.forEach(function(m){var b=te(m,2),_=b[0],w=b[1];d[w]=i[_]}),pJ(n,u.map(function(m){return a[m]})).map(function(m,b){d[u[b]]=m}),e.elementRects=d;var h=SS(n.props.elementSnapDirections),p=[];return d.forEach(function(m){var b=m.element,_=m.top,w=_===void 0?h.top:_,S=m.left,T=S===void 0?h.left:S,C=m.right,R=C===void 0?h.right:C,O=m.bottom,P=O===void 0?h.bottom:O,N=m.center,A=N===void 0?h.center:N,I=m.middle,k=I===void 0?h.middle:I,z=m.className,V=m.rect,B=TS({top:w,right:R,left:T,bottom:P,center:A,middle:k},V),j=B.horizontal,X=B.vertical,H=B.horizontalNames,$=B.verticalNames,W=V.top,ee=V.left,he=V.right-ee,K=V.bottom-W,G=[he,K];X.forEach(function(Y,re){p.push({type:"vertical",element:b,pos:[at(Y,.1),W],size:K,sizes:G,className:z,elementRect:m,elementDirection:mk[$[re]]||$[re],direction:""})}),j.forEach(function(Y,re){p.push({type:"horizontal",element:b,pos:[ee,at(Y,.1)],size:he,sizes:G,className:z,elementRect:m,elementDirection:mk[H[re]]||H[re],direction:""})})}),p}function Ak(n,e){return n?n.map(function(t){var r=oa(t)?t:{pos:t},i=r.pos;return xd(i)?r:J(J({},r),{pos:Ht(i,e)})}):[]}function Lj(n,e,t,r,i,a,o){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o={left:0,top:0,right:0,bottom:0});var c=[],u=o.left,d=o.top,h=o.bottom,p=o.right,m=t+p-u,b=r+h-d;return Ak(n,b).forEach(function(_){c.push({type:"horizontal",pos:[u,at(_.pos-a+d,.1)],size:m,className:_.className,direction:""})}),Ak(e,m).forEach(function(_){c.push({type:"vertical",pos:[at(_.pos-i+u,.1),d],size:b,className:_.className,direction:""})}),c}function pJ(n,e){if(!e.length)return[];var t=n.props.groupable,r=n.state,i=r.containerClientRect,a=r.rootMatrix,o=r.is3d,c=r.offsetDelta,u=o?4:3,d=te(zZ(a,i,u),2),h=d[0],p=d[1],m=t?0:c[0],b=t?0:c[1];return e.map(function(_){var w=_.element.getBoundingClientRect(),S=w.left-h-m,T=w.top-p-b,C=T+w.height,R=S+w.width,O=te(Td(a,[S,T],u),2),P=O[0],N=O[1],A=te(Td(a,[R,C],u),2),I=A[0],k=A[1];return J(J({},_),{rect:{left:P,right:I,top:N,bottom:k,center:(P+I)/2,middle:(N+k)/2}})})}function Hm(n){var e=n.state,t=e.container,r=n.props.snapContainer||t;if(e.snapContainer===r&&e.guidelines&&e.guidelines.length)return!1;var i=e.containerClientRect,a={left:0,top:0,bottom:0,right:0};if(t!==r){var o=Ga(r,!0);if(o){var c=Ph(o),u=Nk(e,[c.left-i.left,c.top-i.top]),d=Nk(e,[c.right-i.right,c.bottom-i.bottom]);a.left=at(u[0],1e-5),a.top=at(u[1],1e-5),a.right=at(d[0],1e-5),a.bottom=at(d[1],1e-5)}}return e.snapContainer=r,e.snapOffset=a,e.guidelines=Z_(n),e.enableSnap=!0,!0}function Bj(n,e,t,r,i,a){var o=zc(n,e,t,a?4:3),c=Yn(o,r);return DS(o,Ke(i,c))}function Ck(n){return n?n/Ee(n):0}function gJ(n,e,t,r,i,a){var o=a.fixedDirection,c=FZ(t,o,r),u=CS(n,e,t,r),d=Ie(Ie([],te(eJ(n,e,c,r,i,a)),!1),te(Pj(n,u,a)),!1),h=dv(d,0),p=dv(d,1);return{width:{isBound:h.isBound,offset:h.offset[0]},height:{isBound:p.isBound,offset:p.offset[1]}}}function mJ(n,e,t,r,i,a,o,c,u){var d=Yn(e,o),h=hy(n,c,{vertical:[d[0]],horizontal:[d[1]]}),p=h.horizontal.offset,m=h.vertical.offset;if(at(m,$_)||at(p,$_)){var b=te(Wa({datas:u,distX:-m,distY:-p}),2),_=b[0],w=b[1],S=Math.min(i||1/0,t+o[0]*_),T=Math.min(a||1/0,r+o[1]*w);return[S-t,T-r]}return[0,0]}function Uj(n,e,t,r,i,a,o,c){for(var u=Oi(n.state),d=n.props.keepRatio,h=0,p=0,m=0;m<2;++m){var b=e(h,p),_=gJ(n,b,i,d,o,c),w=_.width,S=_.height,T=w.isBound,C=S.isBound,R=w.offset,O=S.offset;if(m===1&&(T||(R=0),C||(O=0)),m===0&&o&&!T&&!C)return[0,0];if(d){var P=Ee(R)*(t?1/t:1),N=Ee(O)*(r?1/r:1),A=T&&C?P<N:C||!T&&P<N;A?R=t*O/r:O=r*R/t}h+=R,p+=O}if(!d&&i[0]&&i[1]){var I=nJ(n,u,i,a,c),k=I.maxWidth,z=I.maxHeight,V=te(mJ(n,e(h,p).map(function(X){return X.map(function(H){return at(H,$_)})}),t+h,r+p,k,z,i,o,c),2),R=V[0],O=V[1];h+=R,p+=O}return[h,p]}function Nh(n){return n<0&&(n=n%360+360),n%=360,n}function vJ(n,e){e=Nh(e);var t=Math.floor(n/360),r=t*360+360-e,i=t*360+e;return Ee(n-r)<Ee(n-i)?r:i}function p1(n,e){n=Nh(n),e=Nh(e);var t=Nh(n-e);return Math.min(t,360-t)}function yJ(n,e,t,r){var i,a=n.props,o=(i=a[Aj])!==null&&i!==void 0?i:5,c=a[Cj];if($d(n,"rotatable")){var u=e.pos1,d=e.pos2,h=e.pos3,p=e.pos4,m=e.origin,b=t*Math.PI/180,_=[u,d,h,p].map(function(O){return Ke(O,m)}),w=_.map(function(O){return Xp(O,b)}),S=Ie(Ie([],te(PZ(n,_,w,m,t)),!1),te(KZ(n,_,w,m,t)),!1);S.sort(function(O,P){return Ee(O-t)-Ee(P-t)});var T=S.length>0;if(T)return{isSnap:T,dist:T?S[0]:t}}if(c?.length&&o){var C=c.slice().sort(function(O,P){return p1(O,r)-p1(P,r)}),R=C[0];if(p1(R,r)<=o)return{isSnap:!0,dist:t+vJ(r,R)-r}}return{isSnap:!1,dist:t}}function bJ(n,e,t,r,i,a,o){if(!$d(n,"resizable"))return[0,0];var c=o.fixedDirection,u=o.nextAllMatrix,d=n.state,h=d.allMatrix,p=d.is3d;return Uj(n,function(m,b){return Bj(u||h,e+m,t+b,c,i,p)},e,t,r,i,a,o)}function xJ(n,e,t,r,i){if(!$d(n,"scalable"))return[0,0];var a=i.startOffsetWidth,o=i.startOffsetHeight,c=i.fixedPosition,u=i.fixedDirection,d=i.is3d,h=Uj(n,function(p,m){return Bj(bZ(i,It(e,[p/a,m/o])),a,o,u,c,d)},a,o,t,c,r,i);return[h[0]/a,h[1]/o]}function _J(n,e){e.absolutePoses=Oi(n.state)}function Ik(n){var e=[];return n.forEach(function(t){t.guidelineInfos.forEach(function(r){var i=r.guideline;Gr(e,function(a){return a.guideline===i})||(i.direction="",e.push({guideline:i,posInfo:t}))})}),e.map(function(t){var r=t.guideline,i=t.posInfo;return J(J({},r),{direction:i.direction})})}function Rk(n,e,t,r,i,a){var o=ES(dy(n,a),e,t),c=o.vertical,u=o.horizontal,d=Yu();c.forEach(function(_){_.isBound&&(_.direction==="start"&&(d.left=!0),_.direction==="end"&&(d.right=!0),r.push({type:"bounds",pos:_.pos}))}),u.forEach(function(_){_.isBound&&(_.direction==="start"&&(d.top=!0),_.direction==="end"&&(d.bottom=!0),i.push({type:"bounds",pos:_.pos}))});var h=XZ(n),p=h.boundMap,m=h.vertical,b=h.horizontal;return m.forEach(function(_){Os(r,function(w){var S=w.type,T=w.pos;return S==="bounds"&&T===_})>=0||r.push({type:"bounds",pos:_})}),b.forEach(function(_){Os(i,function(w){var S=w.type,T=w.pos;return S==="bounds"&&T===_})>=0||i.push({type:"bounds",pos:_})}),{boundMap:d,innerBoundMap:p}}var wJ=MS("",["resizable","scalable"]),EJ={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold","snapGridAll",Aj,Cj,Ij,Rj,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(n,e){var t=n.state,r=t.top,i=t.left,a=t.pos1,o=t.pos2,c=t.pos3,u=t.pos4,d=t.snapRenderInfo,h=n.props.snapRenderThreshold,p=h===void 0?1:h;if(!d||!d.render||!$d(n,""))return Xu(n,"boundMap",Yu(),function(Z){return JSON.stringify(Z)}),Xu(n,"innerBoundMap",Yu(),function(Z){return JSON.stringify(Z)}),[];t.guidelines=Z_(n);var m=Math.min(a[0],o[0],c[0],u[0]),b=Math.min(a[1],o[1],c[1],u[1]),_=d.externalPoses||[],w=Oi(n.state),S=[],T=[],C=[],R=[],O=[],P=Ni(w),N=P.width,A=P.height,I=P.top,k=P.left,z=P.bottom,V=P.right,B={left:k,right:V,top:I,bottom:z,center:(k+V)/2,middle:(I+z)/2},j=_.length>0,X=j?Ni(_):{};if(!d.request){if(d.direction&&O.push(UZ(n,w,d.direction,p,p)),d.snap){var H=Ni(w);d.center&&(H.middle=(H.top+H.bottom)/2,H.center=(H.left+H.right)/2),O.push(vk(n,H,p,p))}j&&(d.center&&(X.middle=(X.top+X.bottom)/2,X.center=(X.left+X.right)/2),O.push(vk(n,X,p,p))),O.forEach(function(Z){var oe=Z.vertical.posInfos,fe=Z.horizontal.posInfos;S.push.apply(S,Ie([],te(oe.filter(function(be){var Ce=be.guidelineInfos;return Ce.some(function(we){var Pe=we.guideline;return!Pe.hide})}).map(function(be){return{type:"snap",pos:be.pos}})),!1)),T.push.apply(T,Ie([],te(fe.filter(function(be){var Ce=be.guidelineInfos;return Ce.some(function(we){var Pe=we.guideline;return!Pe.hide})}).map(function(be){return{type:"snap",pos:be.pos}})),!1)),C.push.apply(C,Ie([],te(Ik(oe)),!1)),R.push.apply(R,Ie([],te(Ik(fe)),!1))})}var $=Rk(n,[k,V],[I,z],S,T),W=$.boundMap,ee=$.innerBoundMap;j&&Rk(n,[X.left,X.right],[X.top,X.bottom],S,T,d.externalBounds);var he=Ie(Ie([],te(C),!1),te(R),!1),K=he.filter(function(Z){return Z.element&&!Z.gapRects}),G=he.filter(function(Z){return Z.gapRects}).sort(function(Z,oe){return Z.gap-oe.gap});Oe(n,"onSnap",{guidelines:he.filter(function(Z){var oe=Z.element;return!oe}),elements:K,gaps:G},!0);var Y=Xu(n,"boundMap",W,function(Z){return JSON.stringify(Z)},Yu()),re=Xu(n,"innerBoundMap",ee,function(Z){return JSON.stringify(Z)},Yu());return(W===Y||ee===re)&&Oe(n,"onBound",{bounds:W,innerBounds:ee},!0),Ie(Ie(Ie(Ie(Ie(Ie([],te(lJ(n,K,[m,b],B,e)),!1),te(cJ(n,G,[m,b],B,e)),!1),te(Tk(n,"horizontal",R,[i,r],B,e)),!1),te(Tk(n,"vertical",C,[i,r],B,e)),!1),te(Sk(n,"horizontal",T,m,r,N,0,e)),!1),te(Sk(n,"vertical",S,b,i,A,1,e)),!1)},dragStart:function(n,e){n.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},Hm(n)},drag:function(n){var e=n.state;Hm(n)||(e.guidelines=Z_(n)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart:function(n){this.unset(n)},dragEnd:function(n){this.unset(n)},dragControlCondition:function(n,e){if(wJ(n,e)||Q_(n,e))return!0;if(!e.isRequest&&e.inputEvent)return Hn(e.inputEvent.target,$e("snap-control"))},dragControlStart:function(n){n.state.snapRenderInfo=null,Hm(n)},dragControl:function(n){this.drag(n)},dragControlEnd:function(n){this.unset(n)},dragGroupStart:function(n,e){this.dragStart(n,e)},dragGroup:function(n){this.drag(n)},dragGroupEnd:function(n){this.unset(n)},dragGroupControlStart:function(n){n.state.snapRenderInfo=null,Hm(n)},dragGroupControl:function(n){this.drag(n)},dragGroupControlEnd:function(n){this.unset(n)},unset:function(n){var e=n.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function SJ(n,e){return[n[0]*e[0],n[1]*e[1]]}function $e(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return bW.apply(void 0,Ie([bS],te(n),!1))}function Fj(n){n()}function TJ(n){return!n||n==="none"?[1,0,0,1,0,0]:oa(n)?n:up(n)}function Mh(n,e,t){return ov(e,Rc(t,e),n,Rc(t.map(function(r){return-r}),e))}function AJ(n,e,t){if(e==="%"){var r=RS(n.ownerSVGElement);return r[t?"width":"height"]/100}return 1}function CJ(n){var e=IJ(kS(n,":before"));return e.map(function(t,r){var i=$p(t),a=i.value,o=i.unit;return a*AJ(n,o,r===0)})}function hv(n){return n?n.split(" "):["0","0"]}function IJ(n){return hv(n.transformOrigin)}function Gj(n){var e=qr(n),t=e("transform");if(t&&t!=="none")return t;if("transform"in n){var r=n.transform,i=r.baseVal;if(!i)return"";var a=i.length;if(!a)return"";for(var o=[],c=function(d){var h=i[d].matrix;o.push("matrix(".concat(["a","b","c","d","e","f"].map(function(p){return h[p]}).join(", "),")"))},u=0;u<a;++u)c(u);return o.join(" ")}return""}function fp(n,e,t,r,i){var a,o,c=lS(n)||ul(n),u=!1,d,h;if(!n||t)d=n;else{var p=(a=n?.assignedSlot)===null||a===void 0?void 0:a.parentElement,m=n.parentElement;p?(u=!0,h=m,d=p):d=m}for(var b=!1,_=n===e||d===e,w="relative",S=1,T=parseFloat(i?.("zoom"))||1,C=i?.("position");d&&d!==c;){e===d&&(_=!0);var R=qr(d),O=d.tagName.toLowerCase(),P=Gj(d),N=R("willChange"),A=parseFloat(R("zoom"))||1;if(w=R("position"),r&&A!==1){S=A;break}if(!t&&r&&T!==1&&C&&C!=="absolute"||O==="svg"||O==="foreignobject"||w!=="static"||P&&P!=="none"||N==="transform")break;var I=(o=n?.assignedSlot)===null||o===void 0?void 0:o.parentNode,k=d.parentNode;I&&(u=!0,h=k);var z=k;if(z&&z.nodeType===11){d=z.host,b=!0,w=qr(d)("position");break}d=z,w="relative"}return{offsetZoom:S,hasSlot:u,parentSlotElement:h,isCustomElement:b,isStatic:w==="static",isEnd:_||!d||d===c,offsetParent:d||c}}function RJ(n,e){var t,r=n.tagName.toLowerCase(),i=n.offsetLeft,a=n.offsetTop,o=qr(n),c=ry(i),u=!c,d,h;return!u&&(r!=="svg"||n.ownerSVGElement)?(d=lj?CJ(n):hv(o("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice(),u=!0,r==="svg"?(i=0,a=0):(t=te(NJ(n,d,n===e&&e.tagName.toLowerCase()==="g"),4),i=t[0],a=t[1],d[0]=t[2],d[1]=t[3])):(d=hv(o("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice()),{tagName:r,isSVG:c,hasOffset:u,offset:[i||0,a||0],origin:d,targetOrigin:h}}function qj(n,e){var t=qr(n),r=qr(ul(n)),i=r("position");if(!e&&(!i||i==="static"))return[0,0];var a=parseInt(r("marginLeft"),10),o=parseInt(r("marginTop"),10);return t("position")==="absolute"&&((t("top")!=="auto"||t("bottom")!=="auto")&&(o=0),(t("left")!=="auto"||t("right")!=="auto")&&(a=0)),[a,o]}function J_(n){n.forEach(function(e){var t=e.matrix;t&&(e.matrix=la(t,3,4))})}function DJ(n){for(var e=n.parentElement,t=!1,r=ul(n);e;){var i=kS(e).transform;if(i&&i!=="none"){t=!0;break}if(e===r)break;e=e.parentElement}return{fixedContainer:e||r,hasTransform:t}}function py(n,e){return e===void 0&&(e=n.length>9),"".concat(e?"matrix3d":"matrix","(").concat(ej(n,!e).join(","),")")}function RS(n){var e=n.clientWidth,t=n.clientHeight;if(!n)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:t};var r=n.viewBox,i=r&&r.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||t,clientWidth:e,clientHeight:t}}function kJ(n,e){var t,r=RS(n),i=r.width,a=r.height,o=r.clientWidth,c=r.clientHeight,u=o/i,d=c/a,h=n.preserveAspectRatio.baseVal,p=h.align,m=h.meetOrSlice,b=[0,0],_=[u,d],w=[0,0];if(p!==1){var S=(p-2)%3,T=Math.floor((p-2)/3);b[0]=i*S/2,b[1]=a*T/2;var C=m===2?Math.max(d,u):Math.min(u,d);_[0]=C,_[1]=C,w[0]=(o-i)/2*S,w[1]=(c-a)/2*T}var R=gS(_,e);return t=te(w,2),R[e*(e-1)]=t[0],R[e*(e-1)+1]=t[1],Mh(R,e,b)}function NJ(n,e,t){var r=n.tagName.toLowerCase();if(!n.getBBox||!t&&r==="g")return[0,0,0,0];var i=qr(n),a=i("transform-box")==="fill-box",o=n.getBBox(),c=RS(n.ownerSVGElement),u=o.x,d=o.y;r==="foreignobject"&&!u&&!d&&(u=parseFloat(n.getAttribute("x"))||0,d=parseFloat(n.getAttribute("y"))||0);var h=u-c.x,p=d-c.y,m=a?e[0]:e[0]-h,b=a?e[1]:e[1]-p;return[h,p,m,b]}function cn(n,e,t){return br(n,Ic(e,t),t)}function zc(n,e,t,r){return[[0,0],[e,0],[0,t],[e,t]].map(function(i){return cn(n,i,r)})}function Ni(n){var e=n.map(function(d){return d[0]}),t=n.map(function(d){return d[1]}),r=Math.min.apply(Math,Ie([],te(e),!1)),i=Math.min.apply(Math,Ie([],te(t),!1)),a=Math.max.apply(Math,Ie([],te(e),!1)),o=Math.max.apply(Math,Ie([],te(t),!1)),c=a-r,u=o-i;return{left:r,top:i,right:a,bottom:o,width:c,height:u}}function Dk(n,e,t,r){var i=zc(n,e,t,r);return Ni(i)}function MJ(n,e,t,r,i){var a,o=n.target,c=n.origin,u=e.matrix,d=Hj(o),h=d.offsetWidth,p=d.offsetHeight,m=t.getBoundingClientRect(),b=[0,0];t===ul(t)&&(b=qj(o,!0));for(var _=o.getBoundingClientRect(),w=_.left-m.left+t.scrollLeft-(t.clientLeft||0)+b[0],S=_.top-m.top+t.scrollTop-(t.clientTop||0)+b[1],T=_.width,C=_.height,R=ov(r,i,u),O=Dk(R,h,p,r),P=O.left,N=O.top,A=O.width,I=O.height,k=cn(R,c,r),z=Ke(k,[P,N]),V=[w+z[0]*T/A,S+z[1]*C/I],B=[0,0],j=0;++j<10;){var X=$a(i,r);a=te(Ke(cn(X,V,r),cn(X,k,r)),2),B[0]=a[0],B[1]=a[1];var H=ov(r,i,Rc(B,r),u),$=Dk(H,h,p,r),W=$.left,ee=$.top,he=W-w,K=ee-S;if(Ee(he)<2&&Ee(K)<2)break;V[0]-=he,V[1]-=K}return B.map(function(G){return Math.round(G)})}function PJ(n,e,t){var r=n.length===16,i=r?4:3,a=e.map(function(u){return cn(n,u,i)}),o=t.left,c=t.top;return a.map(function(u){return[u[0]+o,u[1]+c]})}function Pi(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function $j(n,e){return Pi([e[0]-n[0],e[1]-n[1]])}function hh(n,e,t,r){t===void 0&&(t=1),r===void 0&&(r=An(n,e));var i=$j(n,e);return{transform:"translateY(-50%) translate(".concat(n[0],"px, ").concat(n[1],"px) rotate(").concat(r,"rad) scaleY(").concat(t,")"),width:"".concat(i,"px")}}function pv(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=t.length,a=t.reduce(function(c,u){return c+u[0]},0)/i,o=t.reduce(function(c,u){return c+u[1]},0)/i;return{transform:"translateZ(0px) translate(".concat(a,"px, ").concat(o,"px) rotate(").concat(n,"rad) scale(").concat(e,")")}}function kc(n,e){var t=n[e];return oa(t)?J(J({},n),t):n}function Hj(n){var e=n&&!ry(n.offsetWidth),t=0,r=0,i=0,a=0,o=0,c=0,u=0,d=0,h=0,p=0,m=0,b=0,_=1/0,w=1/0,S=1/0,T=1/0,C=0,R=0,O=!1;if(n)if(!e&&n.ownerSVGElement){var P=n.getBBox();O=!0,t=P.width,r=P.height,o=t,c=r,u=t,d=r,i=t,a=r}else{var N=qr(n),A=n.style,I=N("boxSizing")==="border-box",k=parseFloat(N("borderLeftWidth"))||0,z=parseFloat(N("borderRightWidth"))||0,V=parseFloat(N("borderTopWidth"))||0,B=parseFloat(N("borderBottomWidth"))||0,j=parseFloat(N("paddingLeft"))||0,X=parseFloat(N("paddingRight"))||0,H=parseFloat(N("paddingTop"))||0,$=parseFloat(N("paddingBottom"))||0,W=j+X,ee=H+$,he=k+z,K=V+B,G=W+he,Y=ee+K,re=N("position"),Z=0,oe=0;if("clientLeft"in n){var fe=null;if(re==="absolute"){var be=fp(n,ul(n));fe=be.offsetParent}else fe=n.parentElement;if(fe){var Ce=qr(fe);Z=parseFloat(Ce("width")),oe=parseFloat(Ce("height"))}}h=Math.max(W,Ht(N("minWidth"),Z)||0),p=Math.max(ee,Ht(N("minHeight"),oe)||0),_=Ht(N("maxWidth"),Z),w=Ht(N("maxHeight"),oe),isNaN(_)&&(_=1/0),isNaN(w)&&(w=1/0),C=Ht(A.width,0)||0,R=Ht(A.height,0)||0,o=parseFloat(N("width"))||0,c=parseFloat(N("height"))||0,u=Ee(o-C)<1?N_(h,C||o,_):o,d=Ee(c-R)<1?N_(p,R||c,w):c,t=u,r=d,i=u,a=d,I?(S=_,T=w,m=h,b=p,u=t-G,d=r-Y):(S=_+G,T=w+Y,m=h+G,b=p+Y,t=u+G,r=d+Y),i=u+W,a=d+ee}return{svg:O,offsetWidth:t,offsetHeight:r,clientWidth:i,clientHeight:a,contentWidth:u,contentHeight:d,inlineCSSWidth:C,inlineCSSHeight:R,cssWidth:o,cssHeight:c,minWidth:h,minHeight:p,maxWidth:_,maxHeight:w,minOffsetWidth:m,minOffsetHeight:b,maxOffsetWidth:S,maxOffsetHeight:T}}function Yj(n,e){return An(e>0?n[0]:n[1],e>0?n[1]:n[0])}function Ym(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function Kj(n,e){var t=n===ul(n)||n===lS(n),r={clientLeft:n.clientLeft,clientTop:n.clientTop,clientWidth:n.clientWidth,clientHeight:n.clientHeight,scrollWidth:n.scrollWidth,scrollHeight:n.scrollHeight,overflow:!1};return t&&(r.clientHeight=Math.max(e.height,r.clientHeight),r.scrollHeight=Math.max(e.height,r.scrollHeight)),r.overflow=qr(n)("overflow")!=="visible",J(J({},e),r)}function g1(n,e,t,r){var i=n.left,a=n.right,o=n.top,c=n.bottom,u=e.top,d=e.left,h={left:d+i,top:u+o,right:d+a,bottom:u+c,width:a-i,height:c-o};return t&&r?Kj(t,h):h}function Ph(n,e){var t=0,r=0,i=0,a=0;if(n){var o=n.getBoundingClientRect();t=o.left,r=o.top,i=o.width,a=o.height}var c={left:t,top:r,width:i,height:a,right:t+i,bottom:r+a};return n&&e?Kj(n,c):c}function OJ(n){var e=n.props,t=e.groupable,r=e.svgOrigin,i=n.getState(),a=i.offsetWidth,o=i.offsetHeight,c=i.svg,u=i.transformOrigin;return!t&&c&&r?OS(r,a,o):u}function Xj(n,e,t,r){var i;if(n)i=n;else if(e)i=[0,0];else{var a=t.target;i=Wj(a,r)}return i}function Wj(n,e){if(n){var t=n.getAttribute("data-rotation")||"",r=n.getAttribute("data-direction");if(e.deg=t,!!r){var i=[0,0];return r.indexOf("w")>-1&&(i[0]=-1),r.indexOf("e")>-1&&(i[0]=1),r.indexOf("n")>-1&&(i[1]=-1),r.indexOf("s")>-1&&(i[1]=1),i}}}function DS(n,e){return[It(e,n[0]),It(e,n[1]),It(e,n[2]),It(e,n[3])]}function Oi(n){var e=n.left,t=n.top,r=n.pos1,i=n.pos2,a=n.pos3,o=n.pos4;return DS([r,i,a,o],[e,t])}function ew(n,e){n[e?"controlAbles":"targetAbles"].forEach(function(t){t.unset&&t.unset(n)})}function Ku(n,e){var t=e?"controlGesto":"targetGesto",r=n[t];r?.isIdle()===!1&&ew(n,e),r?.unset(),n[t]=null}function Rr(n,e){if(e){var t=qd(e);t.nextStyle=J(J({},t.nextStyle),n)}return{style:n,cssText:js(n).map(function(r){return"".concat(x0(r,"-"),": ").concat(n[r],";")}).join("")}}function Qj(n,e,t){var r=e.afterTransform||e.transform;return J(J({},Rr(J(J(J({},n.style),e.style),{transform:r}),t)),{afterTransform:r,transform:n.transform})}function dt(n,e,t,r){var i=e.datas;i.datas||(i.datas={});var a=J(J({},t),{target:n.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:n,moveable:n,datas:i.datas,isRequest:e.isRequest,isRequestChild:e.isRequestChild,isFirstDrag:!!e.isFirstDrag,isTrusted:e.isTrusted!==!1,stopAble:function(){i.isEventStart=!1},stopDrag:function(){var o;(o=e.stop)===null||o===void 0||o.call(e)}});return i.isStartEvent?r||(i.lastEvent=a):i.isStartEvent=!0,a}function li(n,e,t){var r=e.datas,i="isDrag"in t?t.isDrag:e.isDrag;return r.datas||(r.datas={}),J(J({isDrag:i},t),{moveable:n,target:n.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:n,lastEvent:r.lastEvent,isDouble:e.isDouble,datas:r.datas,isFirstDrag:!!e.isFirstDrag})}function gy(n,e,t){n._emitter.on(e,t)}function Oe(n,e,t,r,i){return n.triggerEvent(e,t,r,i)}function kS(n,e){return Yo(n).getComputedStyle(n,e)}function Km(n,e,t){var r={},i={};return n.filter(function(a){var o=a.name;if(r[o]||!e.some(function(c){return a[c]}))return!1;if(!t&&a.ableGroup){if(i[a.ableGroup])return!1;i[a.ableGroup]=!0}return r[o]=!0,!0})}function tw(n,e){return n===e||n==null&&e==null}function kk(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(var t=n.length-1,r=0;r<t;++r){var i=n[r];if(!ry(i))return i}return n[t]}function Zj(n,e){var t=[],r=[];return n.forEach(function(i,a){var o=e(i,a,n),c=r.indexOf(o),u=t[c]||[];c===-1&&(r.push(o),t.push(u)),u.push(i)}),t}function jJ(n,e){var t=[],r={};return n.forEach(function(i,a){var o=e(i,a,n),c=r[o];c||(c=[],r[o]=c,t.push(c)),c.push(i)}),t}function Jj(n){return n.reduce(function(e,t){return e.concat(t)},[])}function Sd(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return n.sort(function(t,r){return Ee(r)-Ee(t)}),n[0]}function Td(n,e,t){return br($a(n,t),Ic(e,t),t)}function VJ(n,e){var t,r=n.is3d,i=n.rootMatrix,a=r?4:3;return t=te(Td(i,[e.distX,e.distY],a),2),e.distX=t[0],e.distY=t[1],e}function Si(n,e,t,r){if(!t[0]&&!t[1])return e;var i=cn(n,[Ck(t[0]||1),0],r),a=cn(n,[0,Ck(t[1]||1)],r),o=cn(n,[t[0]/Pi(i),t[1]/Pi(a)],r);return It(e,o)}function Wi(n,e,t){return t?"".concat(n/e*100,"%"):"".concat(n,"px")}function gv(n){return Ee(n)<=kr?0:n}function NS(n){return function(e){if(!e.isDragging(n))return"";var t=AZ(e,n),r=t.deg;return r?$e("view-control-rotation".concat(r)):""}}function MS(n,e){return e===void 0&&(e=[n]),function(t,r){if(r.isRequest)return e.some(function(a){return r.requestAble===a})?r.parentDirection:!1;var i=r.inputEvent.target;return Hn(i,$e("direction"))&&(!n||Hn(i,$e(n)))}}function zJ(n,e,t){var r,i=_d(n,{"x%":function(P){return P/100*e.offsetWidth},"y%":function(P){return P/100*e.offsetHeight}}),a=n.slice(0,t<0?void 0:t),o=n.slice(0,t<0?void 0:t+1),c=n[t]||"",u=t<0?[]:n.slice(t),d=t<0?[]:n.slice(t+1),h=i.slice(0,t<0?void 0:t),p=i.slice(0,t<0?void 0:t+1),m=(r=i[t])!==null&&r!==void 0?r:_d([""])[0],b=t<0?[]:i.slice(t),_=t<0?[]:i.slice(t+1),w=m?[m]:[],S=zu(h),T=zu(p),C=zu(b),R=zu(_),O=Yt(S,C,4);return{transforms:n,beforeFunctionMatrix:S,beforeFunctionMatrix2:T,targetFunctionMatrix:zu(w),afterFunctionMatrix:C,afterFunctionMatrix2:R,allFunctionMatrix:O,beforeFunctions:h,beforeFunctions2:p,targetFunction:w[0],afterFunctions:b,afterFunctions2:_,beforeFunctionTexts:a,beforeFunctionTexts2:o,targetFunctionText:c,afterFunctionTexts:u,afterFunctionTexts2:d}}function LJ(n){return!n||!oa(n)||Fd(n)?!1:Fn(n)||"length"in n}function Ga(n,e){return n?Fd(n)?n:Fr(n)?e?document.querySelector(n):n:aS(n)?n():N3(n)?n:"current"in n?n.current:n:null}function PS(n,e){if(!n)return[];var t=LJ(n)?[].slice.call(n):[n];return t.reduce(function(r,i){return Fr(i)&&e?Ie(Ie([],te(r),!1),te([].slice.call(document.querySelectorAll(i))),!1):(Fn(i)?r.push(PS(i,e)):r.push(Ga(i,e)),r)},[])}function BJ(n,e,t){var r=An(n,e)/Math.PI*180;return r=t>=0?r:180-r,r=r>=0?r:360+r,r}function Nk(n,e){var t=n.rootMatrix,r=n.is3d,i=r?4:3,a=$a(t,i);return r||(a=la(a,3,4)),a[12]=0,a[13]=0,a[14]=0,EQ(a,e)}function e5(n,e,t,r,i){var a=te(n,2),o=a[0],c=a[1],u=0,d=0;if(i&&o&&c){var h=An([0,0],e),p=An([0,0],r),m=Pi(e),b=Math.cos(h-p)*m;if(!r[0])d=b,u=d*t;else if(!r[1])u=b,d=u/t;else{var _=r[0]*o,w=r[1]*c,S=Math.atan2(_+e[0],w+e[1]),T=Math.atan2(_,w);S<0&&(S+=Math.PI*2),T<0&&(T+=Math.PI*2);var C=0;Ee(S-T)<Math.PI/2||Ee(S-T)>Math.PI/2*3||(T+=Math.PI),C=S-T,C>Math.PI*2?C-=Math.PI*2:C>Math.PI?C=2*Math.PI-C:C<-Math.PI&&(C=-2*Math.PI-C);var R=Pi([_+e[0],w+e[1]])*Math.cos(C);u=R*Math.sin(T)-_,d=R*Math.cos(T)-w,r[0]<0&&(u*=-1),r[1]<0&&(d*=-1)}}else u=r[0]*e[0],d=r[1]*e[1];return[u,d]}function t5(n,e,t,r){var i,a=t.ratio,o=t.startOffsetWidth,c=t.startOffsetHeight,u=0,d=0,h=r.distX,p=r.distY,m=r.pinchScale,b=r.parentDistance,_=r.parentDist,w=r.parentScale,S=t.fixedDirection,T=[0,1].map(function(A){return Ee(n[A]-S[A])}),C=[0,1].map(function(A){var I=T[A];return I!==0&&(I=2/I),I});if(_)u=_[0],d=_[1],e&&(u?d||(d=u/a):u=d*a);else if(xd(m))u=(m-1)*o,d=(m-1)*c;else if(w)u=(w[0]-1)*o,d=(w[1]-1)*c;else if(b){var R=o*T[0],O=c*T[1],P=Pi([R,O]);u=b/P*R*C[0],d=b/P*O*C[1]}else{var N=Wa({datas:t,distX:h,distY:p});N=C.map(function(A,I){return N[I]*A}),i=te(e5([o,c],N,a,n,e),2),u=i[0],d=i[1]}return{distWidth:u,distHeight:d}}function nw(n,e){if(e){if(n==="left")return{x:"0%",y:"50%"};if(n==="top")return{x:"50%",y:"50%"};if(n==="center")return{x:"50%",y:"50%"};if(n==="right")return{x:"100%",y:"50%"};if(n==="bottom")return{x:"50%",y:"100%"};var t=te(n.split(" "),2),r=t[0],i=t[1],a=nw(r||""),o=nw(i||""),c=J(J({},a),o),u={x:"50%",y:"50%"};return c.x&&(u.x=c.x),c.y&&(u.y=c.y),c.value&&(c.x&&!c.y&&(u.y=c.value),!c.x&&c.y&&(u.x=c.value)),u}return n==="left"?{x:"0%"}:n==="right"?{x:"100%"}:n==="top"?{y:"0%"}:n==="bottom"?{y:"100%"}:n?n==="center"?{value:"50%"}:{value:n}:{}}function OS(n,e,t){var r=nw(n,!0),i=r.x,a=r.y;return[Ht(i,e)||0,Ht(a,t)||0]}function UJ(n,e,t){var r=n.map(function(a){return Ke(a,e)}),i=r.map(function(a){return Xp(a,t)});return{prev:r,next:i,result:i.map(function(a){return It(a,e)})}}function n5(n,e){return n.length===e.length&&n.every(function(t,r){var i=e[r],a=Fn(t),o=Fn(i);return a&&o?n5(t,i):!a&&!o?t===i:!1})}function Xu(n,e,t,r,i){var a=n._store,o=a[e];if(!(e in a))if(i!=null)a[e]=i,o=i;else return a[e]=t,t;return o===t||r(o)===r(t)?o:(a[e]=t,t)}function Ar(n){return n>=0?1:-1}function Ee(n){return Math.abs(n)}function m1(n,e){return jW(n).map(function(t){return e(t)})}function r5(n){return xd(n)?{top:n,left:n,right:n,bottom:n}:{left:n.left||0,top:n.top||0,right:n.right||0,bottom:n.bottom||0}}var FJ=Zp("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(n,e){var t=e.datas,r=e.targets,i=e.angle,a=e.originalDatas,o=n.props,c=o.pinchable,u=o.ables;if(!c)return!1;var d="onPinch".concat(r?"Group":"","Start"),h="drag".concat(r?"Group":"","ControlStart"),p=(c===!0?n.controlAbles:u.filter(function(w){return c.indexOf(w.name)>-1})).filter(function(w){return w.canPinch&&w[h]}),m=dt(n,e,{});r&&(m.targets=r);var b=Oe(n,d,m);t.isPinch=b!==!1,t.ables=p;var _=t.isPinch;return _?(p.forEach(function(w){if(a[w.name]=a[w.name]||{},!!w[h]){var S=J(J({},e),{datas:a[w.name],parentRotate:i,isPinch:!0});w[h](n,S)}}),n.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},_):!1},pinch:function(n,e){var t=e.datas,r=e.scale,i=e.distance,a=e.originalDatas,o=e.inputEvent,c=e.targets,u=e.angle;if(t.isPinch){var d=i*(1-1/r),h=dt(n,e,{});c&&(h.targets=c);var p="onPinch".concat(c?"Group":"");Oe(n,p,h);var m=t.ables,b="drag".concat(c?"Group":"","Control");return m.forEach(function(_){_[b]&&_[b](n,J(J({},e),{datas:a[_.name],inputEvent:o,resolveMatrix:!0,pinchScale:r,parentDistance:d,parentRotate:u,isPinch:!0}))}),h}},pinchEnd:function(n,e){var t=e.datas,r=e.isPinch,i=e.inputEvent,a=e.targets,o=e.originalDatas;if(t.isPinch){var c="onPinch".concat(a?"Group":"","End"),u=li(n,e,{isDrag:r});a&&(u.targets=a),Oe(n,c,u);var d=t.ables,h="drag".concat(a?"Group":"","ControlEnd");return d.forEach(function(p){p[h]&&p[h](n,J(J({},e),{isDrag:r,datas:o[p.name],inputEvent:i,isPinch:!0}))}),r}},pinchGroupStart:function(n,e){return this.pinchStart(n,J(J({},e),{targets:n.props.targets}))},pinchGroup:function(n,e){return this.pinch(n,J(J({},e),{targets:n.props.targets}))},pinchGroupEnd:function(n,e){return this.pinchEnd(n,J(J({},e),{targets:n.props.targets}))}}),Mk=MS("scalable"),GJ={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:Ej("scalable"),dragControlCondition:Mk,viewClassName:NS("scalable"),dragControlStart:function(n,e){var t=e.datas,r=e.isPinch,i=e.inputEvent,a=e.parentDirection,o=Xj(a,r,i,t),c=n.state,u=c.width,d=c.height,h=c.targetTransform,p=c.target,m=c.pos1,b=c.pos2,_=c.pos4;if(!o||!p)return!1;r||Vc(n,e),t.datas={},t.transform=h,t.prevDist=[1,1],t.direction=o,t.startOffsetWidth=u,t.startOffsetHeight=d,t.startValue=[1,1];var w=!o[0]&&!o[1]||o[0]||!o[1];uy(n,e,"scale"),t.isWidth=w;function S(N){t.ratio=N&&isFinite(N)?N:0}t.startPositions=Oi(n.state);function T(N){var A=Oj(t.startPositions,N);t.fixedDirection=A.fixedDirection,t.fixedPosition=A.fixedPosition,t.fixedOffset=A.fixedOffset}t.setFixedDirection=T,S(As(m,b)/As(b,_)),T([-o[0],-o[1]]);var C=function(N){t.minScaleSize=N},R=function(N){t.maxScaleSize=N};C([-1/0,-1/0]),R([1/0,1/0]);var O=dt(n,e,J(J({direction:o,set:function(N){t.startValue=N},setRatio:S,setFixedDirection:T,setMinScaleSize:C,setMaxScaleSize:R},cy(n,e)),{dragStart:Tr.dragStart(n,new wd().dragStart([0,0],e))})),P=Oe(n,"onScaleStart",O);return t.startFixedDirection=t.fixedDirection,P!==!1&&(t.isScale=!0,n.state.snapRenderInfo={request:e.isRequest,direction:o}),t.isScale?O:!1},dragControl:function(n,e){oy(n,e,"scale");var t=e.datas,r=e.parentKeepRatio,i=e.parentFlag,a=e.isPinch,o=e.dragClient,c=e.isRequest,u=e.useSnap,d=e.resolveMatrix,h=t.prevDist,p=t.direction,m=t.startOffsetWidth,b=t.startOffsetHeight,_=t.isScale,w=t.startValue,S=t.isWidth,T=t.ratio;if(!_)return!1;var C=n.props,R=C.throttleScale,O=C.parentMoveable,P=p;!p[0]&&!p[1]&&(P=[1,1]);var N=T&&(r??C.keepRatio)||!1,A=n.state,I=[w[0],w[1]];function k(){var ue=t5(P,N,t,e),_e=ue.distWidth,ze=ue.distHeight,Ne=m?(m+_e)/m:1,qe=b?(b+ze)/b:1;w[0]||(I[0]=_e/m),w[1]||(I[1]=ze/b);var Fe=(P[0]||N?Ne:1)*I[0],Te=(P[1]||N?qe:1)*I[1];return Fe===0&&(Fe=Ar(h[0])*Gm),Te===0&&(Te=Ar(h[1])*Gm),[Fe,Te]}var z=k();if(!a&&n.props.groupable){var V=A.snapRenderInfo||{},B=V.direction;Fn(B)&&(B[0]||B[1])&&(A.snapRenderInfo={direction:p,request:e.isRequest})}Oe(n,"onBeforeScale",dt(n,e,{scale:z,setFixedDirection:function(ue){return t.setFixedDirection(ue),z=k(),z},startFixedDirection:t.startFixedDirection,setScale:function(ue){z=ue}},!0));var j=[z[0]/I[0],z[1]/I[1]],X=o,H=[0,0],$=Ar(j[0]*j[1]),W=!o&&!i&&a;if(W||d?X=wS(n,t.targetAllTransform,[0,0],[0,0],t):o||(X=t.fixedPosition),a||(H=xJ(n,j,p,!u&&c,t)),N){P[0]&&P[1]&&H[0]&&H[1]&&(Math.abs(H[0]*m)>Math.abs(H[1]*b)?H[1]=0:H[0]=0);var ee=!H[0]&&!H[1];if(ee&&(S?j[0]=at(j[0]*I[0],R)/I[0]:j[1]=at(j[1]*I[1],R)/I[1]),P[0]&&!P[1]||H[0]&&!H[1]||ee&&S){j[0]+=H[0];var he=m*j[0]*I[0]/T;j[1]=Ar($*j[0])*Ee(he/b/I[1])}else if(!P[0]&&P[1]||!H[0]&&H[1]||ee&&!S){j[1]+=H[1];var K=b*j[1]*I[1]*T;j[0]=Ar($*j[1])*Ee(K/m/I[0])}}else j[0]+=H[0],j[1]+=H[1],H[0]||(j[0]=at(j[0]*I[0],R)/I[0]),H[1]||(j[1]=at(j[1]*I[1],R)/I[1]);j[0]===0&&(j[0]=Ar(h[0])*Gm),j[1]===0&&(j[1]=Ar(h[1])*Gm),z=SJ(j,[I[0],I[1]]);var G=[m,b],Y=[m*z[0],b*z[1]];Y=C3(Y,t.minScaleSize,t.maxScaleSize,N?T:!1),z=m1(2,function(ue){return G[ue]?Y[ue]/G[ue]:Y[ue]}),j=m1(2,function(ue){return z[ue]/I[ue]});var re=m1(2,function(ue){return h[ue]?j[ue]/h[ue]:j[ue]}),Z="scale(".concat(j.join(", "),")"),oe="scale(".concat(z.join(", "),")"),fe=ly(t,oe,Z),be=!w[0]||!w[1],Ce=xZ(n,be?oe:Z,t.fixedDirection,X,t.fixedOffset,t,be),we=W?Ce:Ke(Ce,t.prevInverseDist||[0,0]);if(t.prevDist=j,t.prevInverseDist=Ce,z[0]===h[0]&&z[1]===h[1]&&we.every(function(ue){return!ue})&&!O&&!W)return!1;var Pe=dt(n,e,J({offsetWidth:m,offsetHeight:b,direction:p,scale:z,dist:j,delta:re,isPinch:!!a},vj(n,fe,we,a,e)));return Oe(n,"onScale",Pe),Pe},dragControlEnd:function(n,e){var t=e.datas;if(!t.isScale)return!1;t.isScale=!1;var r=li(n,e,{});return Oe(n,"onScaleEnd",r),r},dragGroupControlCondition:Mk,dragGroupControlStart:function(n,e){var t=e.datas,r=this.dragControlStart(n,e);if(!r)return!1;var i=na(n,"resizable",e);t.moveableScale=n.scale;var a=Cs(n,this,"dragControlStart",e,function(d,h){return uv(n,d,t,h)}),o=function(d){r.setFixedDirection(d),a.forEach(function(h,p){h.setFixedDirection(d),uv(n,h.moveable,t,i[p])})};t.setFixedDirection=o;var c=J(J({},r),{targets:n.props.targets,events:a,setFixedDirection:o}),u=Oe(n,"onScaleGroupStart",c);return t.isScale=u!==!1,t.isScale?c:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isScale){gy(n,"onBeforeScale",function(h){Oe(n,"onBeforeScaleGroup",dt(n,e,J(J({},h),{targets:n.props.targets}),!0))});var r=this.dragControl(n,e);if(r){var i=r.dist,a=t.moveableScale;n.scale=[i[0]*a[0],i[1]*a[1]];var o=n.props.keepRatio,c=t.fixedPosition,u=Cs(n,this,"dragControl",e,function(h,p){var m=te(br(Wp(n.rotation/180*Math.PI,3),[p.datas.originalX*i[0],p.datas.originalY*i[1],1],3),2),b=m[0],_=m[1];return J(J({},p),{parentDist:null,parentScale:i,parentKeepRatio:o,dragClient:It(c,[b,_])})}),d=J({targets:n.props.targets,events:u},r);return Oe(n,"onScaleGroup",d),d}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isScale){this.dragControlEnd(n,e);var i=Cs(n,this,"dragControlEnd",e),a=li(n,e,{targets:n.props.targets,events:i});return Oe(n,"onScaleGroupEnd",a),t}},request:function(){var n={},e=0,t=0,r=!1;return{isControl:!0,requestStart:function(i){return r=i.useSnap,{datas:n,parentDirection:i.direction||[1,1],useSnap:r}},request:function(i){return e+=i.deltaWidth,t+=i.deltaHeight,{datas:n,parentDist:[e,t],parentKeepRatio:i.keepRatio,useSnap:r}},requestEnd:function(){return{datas:n,isDrag:!0,useSnap:r}}}}};function Co(n,e){return n.map(function(t,r){return av(t,e[r],1,2)})}function Pk(n,e,t){var r=An(n,e),i=An(n,t),a=i-r;return a>=0?a:a+2*Math.PI}function qJ(n,e){var t=Pk(n[0],n[1],n[2]),r=Pk(e[0],e[1],e[2]),i=Math.PI;return!(t>=i&&r<=i||t<=i&&r>=i)}var $J={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:NS("warpable"),render:function(n,e){var t=n.props,r=t.resizable,i=t.scalable,a=t.warpable,o=t.zoom;if(r||i||!a)return[];var c=n.state,u=c.pos1,d=c.pos2,h=c.pos3,p=c.pos4,m=Co(u,d),b=Co(d,u),_=Co(u,h),w=Co(h,u),S=Co(h,p),T=Co(p,h),C=Co(d,p),R=Co(p,d);return Ie([e.createElement("div",{className:$e("line"),key:"middeLine1",style:hh(m,S,o)}),e.createElement("div",{className:$e("line"),key:"middeLine2",style:hh(b,T,o)}),e.createElement("div",{className:$e("line"),key:"middeLine3",style:hh(_,C,o)}),e.createElement("div",{className:$e("line"),key:"middeLine4",style:hh(w,R,o)})],te(Sj(n,"warpable",e)),!1)},dragControlCondition:function(n,e){if(e.isRequest)return!1;var t=e.inputEvent.target;return Hn(t,$e("direction"))&&Hn(t,$e("warpable"))},dragControlStart:function(n,e){var t=e.datas,r=e.inputEvent,i=n.props.target,a=r.target,o=Wj(a,t);if(!o||!i)return!1;var c=n.state,u=c.transformOrigin,d=c.is3d,h=c.targetTransform,p=c.targetMatrix,m=c.width,b=c.height,_=c.left,w=c.top;t.datas={},t.targetTransform=h,t.warpTargetMatrix=d?p:la(p,3,4),t.targetInverseMatrix=Z3($a(t.warpTargetMatrix,4),3,4),t.direction=o,t.left=_,t.top=w,t.poses=[[0,0],[m,0],[0,b],[m,b]].map(function(C){return Ke(C,u)}),t.nextPoses=t.poses.map(function(C){var R=te(C,2),O=R[0],P=R[1];return br(t.warpTargetMatrix,[O,P,0,1],4)}),t.startValue=Zt(4),t.prevMatrix=Zt(4),t.absolutePoses=Oi(c),t.posIndexes=mj(o),Vc(n,e),uy(n,e,"matrix3d"),c.snapRenderInfo={request:e.isRequest,direction:o};var S=dt(n,e,J({set:function(C){t.startValue=C}},cy(n,e))),T=Oe(n,"onWarpStart",S);return T!==!1&&(t.isWarp=!0),t.isWarp},dragControl:function(n,e){var t=e.datas,r=e.isRequest,i=e.distX,a=e.distY,o=t.targetInverseMatrix,c=t.prevMatrix,u=t.isWarp,d=t.startValue,h=t.poses,p=t.posIndexes,m=t.absolutePoses;if(!u)return!1;if(oy(n,e,"matrix3d"),$d(n,"warpable")){var b=p.map(function(k){return m[k]});b.length>1&&b.push([(b[0][0]+b[1][0])/2,(b[0][1]+b[1][1])/2]);var _=hy(n,r,{horizontal:b.map(function(k){return k[1]+a}),vertical:b.map(function(k){return k[0]+i})}),w=_.horizontal,S=_.vertical;a-=w.offset,i-=S.offset}var T=Wa({datas:t,distX:i,distY:a},!0),C=t.nextPoses.slice();if(p.forEach(function(k){C[k]=It(C[k],T)}),!uZ.every(function(k){return qJ(k.map(function(z){return h[z]}),k.map(function(z){return C[z]}))}))return!1;var R=mS(h[0],h[2],h[1],h[3],C[0],C[2],C[1],C[3]);if(!R.length)return!1;var O=Yt(o,R,4),P=pj(t,O,!0),N=Yt($a(c,4),P,4);t.prevMatrix=P;var A=Yt(d,P,4),I=ly(t,"matrix3d(".concat(A.join(", "),")"),"matrix3d(".concat(P.join(", "),")"));return _S(e,I),Oe(n,"onWarp",dt(n,e,J({delta:N,matrix:A,dist:P,multiply:Yt,transform:I},Rr({transform:I},e)))),!0},dragControlEnd:function(n,e){var t=e.datas,r=e.isDrag;return t.isWarp?(t.isWarp=!1,Oe(n,"onWarpEnd",li(n,e,{})),r):!1}},HJ=$e("area-pieces"),Xm=$e("area-piece"),i5=$e("avoid"),YJ=$e("view-dragging");function v1(n){var e=n.areaElement;if(e){var t=n.state,r=t.width,i=t.height;k3(e,i5),e.style.cssText+="left: 0px; top: 0px; width: ".concat(r,"px; height: ").concat(i,"px")}}function Ok(n){return n.createElement("div",{key:"area_pieces",className:HJ},n.createElement("div",{className:Xm}),n.createElement("div",{className:Xm}),n.createElement("div",{className:Xm}),n.createElement("div",{className:Xm}))}var a5={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(n,e){var t=n.props,r=t.target,i=t.dragArea,a=t.groupable,o=t.passDragArea,c=n.getState(),u=c.width,d=c.height,h=c.renderPoses,p=o?$e("area","pass"):$e("area");if(a)return[e.createElement("div",{key:"area",ref:Ts(n,"areaElement"),className:p}),Ok(e)];if(!r||!i)return[];var m=mS([0,0],[u,0],[0,d],[u,d],h[0],h[1],h[2],h[3]),b=m.length?py(m,!0):"none";return[e.createElement("div",{key:"area",ref:Ts(n,"areaElement"),className:p,style:{top:"0px",left:"0px",width:"".concat(u,"px"),height:"".concat(d,"px"),transformOrigin:"0 0",transform:b}}),Ok(e)]},dragStart:function(n,e){var t=e.datas,r=e.clientX,i=e.clientY,a=e.inputEvent;if(!a)return!1;t.isDragArea=!1;var o=n.areaElement,c=n.state,u=c.moveableClientRect,d=c.renderPoses,h=c.rootMatrix,p=c.is3d,m=u.left,b=u.top,_=Ni(d),w=_.left,S=_.top,T=_.width,C=_.height,R=p?4:3,O=te(Td(h,[r-m,i-b],R),2),P=O[0],N=O[1];P-=w,N-=S;var A=[{left:w,top:S,width:T,height:N-10},{left:w,top:S,width:P-10,height:C},{left:w,top:S+N+10,width:T,height:C-N-10},{left:w+P+10,top:S,width:T-P-10,height:C}],I=[].slice.call(o.nextElementSibling.children);A.forEach(function(k,z){I[z].style.cssText="left: ".concat(k.left,"px;top: ").concat(k.top,"px; width: ").concat(k.width,"px; height: ").concat(k.height,"px;")}),D3(o,i5),c.disableNativeEvent=!0},drag:function(n,e){var t=e.datas,r=e.inputEvent;if(this.enableNativeEvent(n),!r)return!1;t.isDragArea||(t.isDragArea=!0,v1(n))},dragEnd:function(n,e){this.enableNativeEvent(n);var t=e.inputEvent,r=e.datas;if(!t)return!1;r.isDragArea||v1(n)},dragGroupStart:function(n,e){return this.dragStart(n,e)},dragGroup:function(n,e){return this.drag(n,e)},dragGroupEnd:function(n,e){return this.dragEnd(n,e)},unset:function(n){v1(n),n.state.disableNativeEvent=!1},enableNativeEvent:function(n){var e=n.state;e.disableNativeEvent&&A3(function(){e.disableNativeEvent=!1})}},KJ=Zp("origin",{props:["origin","svgOrigin"],render:function(n,e){var t=n.props,r=t.zoom,i=t.svgOrigin,a=t.groupable,o=n.getState(),c=o.beforeOrigin,u=o.rotation,d=o.svg,h=o.allMatrix,p=o.is3d,m=o.left,b=o.top,_=o.offsetWidth,w=o.offsetHeight,S;if(!a&&d&&i){var T=te(OS(i,_,w),2),C=T[0],R=T[1],O=p?4:3,P=cn(h,[C,R],O);S=pv(u,r,Ke(P,[m,b]))}else S=pv(u,r,c);return[e.createElement("div",{className:$e("control","origin"),style:S,key:"beforeOrigin"})]}});function XJ(n){var e=n.scrollContainer;return[e.scrollLeft,e.scrollTop]}var WJ={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(n,e){var t=n.props,r=t.scrollContainer,i=r===void 0?n.getContainer():r,a=t.scrollOptions,o=new RQ,c=Ga(i,!0);e.datas.dragScroll=o,n.state.dragScroll=o;var u=e.isControl?"controlGesto":"targetGesto",d=e.targets;o.on("scroll",function(h){var p=h.container,m=h.direction,b=dt(n,e,{scrollContainer:p,direction:m}),_=d?"onScrollGroup":"onScroll";d&&(b.targets=d),Oe(n,_,b)}).on("move",function(h){var p=h.offsetX,m=h.offsetY,b=h.inputEvent;n[u].scrollBy(p,m,b.inputEvent,!1)}).on("scrollDrag",function(h){var p=h.next;p(n[u].getCurrentEvent())}),o.dragStart(e,J({container:c},a))},checkScroll:function(n,e){var t=e.datas.dragScroll;if(t){var r=n.props,i=r.scrollContainer,a=i===void 0?n.getContainer():i,o=r.scrollThreshold,c=o===void 0?0:o,u=r.scrollThrottleTime,d=u===void 0?0:u,h=r.getScrollPosition,p=h===void 0?XJ:h,m=r.scrollOptions;return t.drag(e,J({container:a,threshold:c,throttleTime:d,getScrollPosition:function(b){return p({scrollContainer:b.container,direction:b.direction})}},m)),!0}},drag:function(n,e){return this.checkScroll(n,e)},dragEnd:function(n,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(n,e){return this.dragStart(n,J(J({},e),{isControl:!0}))},dragControl:function(n,e){return this.drag(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupStart:function(n,e){return this.dragStart(n,J(J({},e),{targets:n.props.targets}))},dragGroup:function(n,e){return this.drag(n,J(J({},e),{targets:n.props.targets}))},dragGroupEnd:function(n,e){return this.dragEnd(n,J(J({},e),{targets:n.props.targets}))},dragGroupControlStart:function(n,e){return this.dragStart(n,J(J({},e),{targets:n.props.targets,isControl:!0}))},dragGroupControl:function(n,e){return this.drag(n,J(J({},e),{targets:n.props.targets}))},dragGroupControEnd:function(n,e){return this.dragEnd(n,J(J({},e),{targets:n.props.targets}))},unset:function(n){var e,t=n.state;(e=t.dragScroll)===null||e===void 0||e.dragEnd(),t.dragScroll=null}},s5={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","preventRightClick","preventWheelClick","requestStyles"],events:["changeTargets"]},QJ=Zp("padding",{props:["padding"],render:function(n,e){var t=n.props;if(t.dragArea)return[];var r=r5(t.padding||{}),i=r.left,a=r.top,o=r.right,c=r.bottom,u=n.getState(),d=u.renderPoses,h=u.pos1,p=u.pos2,m=u.pos3,b=u.pos4,_=[h,p,m,b],w=[];return i>0&&w.push([0,2]),a>0&&w.push([0,1]),o>0&&w.push([1,3]),c>0&&w.push([2,3]),w.map(function(S,T){var C=te(S,2),R=C[0],O=C[1],P=_[R],N=_[O],A=d[R],I=d[O],k=mS([0,0],[100,0],[0,100],[100,100],P,N,A,I);if(k.length)return e.createElement("div",{key:"padding".concat(T),className:$e("padding"),style:{transform:py(k,!0)}})})}}),jk=["nw","ne","se","sw"];function Wm(n,e){var t=n[0]+n[1],r=t>e?e/t:1;return n[0]*=r,n[1]=e-n[1]*r,n}var ZJ=[1,2,5,6],JJ=[0,3,4,7],ec=[1,-1,-1,1],tc=[1,1,-1,-1];function jS(n,e,t,r,i,a,o,c){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=t),c===void 0&&(c=r);var u=[],d=!1,h=n.filter(function(m){return!m.virtual}),p=h.map(function(m){var b=m.horizontal,_=m.vertical,w=m.pos;if(_&&!d&&(d=!0,u.push("/")),d){var S=Math.max(0,_===1?w[1]-a:c-w[1]);return u.push(Wi(S,r,e)),S}else{var S=Math.max(0,b===1?w[0]-i:o-w[0]);return u.push(Wi(S,t,e)),S}});return{radiusPoses:h,styles:u,raws:p}}function o5(n){for(var e=[0,0],t=[0,0],r=n.length,i=0;i<r;++i){var a=n[i];a.sub&&(a.horizontal&&(e[1]===0&&(e[0]=i),e[1]=i-e[0]+1,t[0]=i+1),a.vertical&&(t[1]===0&&(t[0]=i),t[1]=i-t[0]+1))}return{horizontalRange:e,verticalRange:t}}function l5(n,e,t,r,i,a,o){var c,u,d,h;a===void 0&&(a=[0,0]),o===void 0&&(o=!1);var p=n.indexOf("/"),m=(p>-1?n.slice(0,p):n).length,b=n.slice(0,m),_=n.slice(m+1),w=b.length,S=_.length,T=S>0,C=te(b,4),R=C[0],O=R===void 0?"0px":R,P=C[1],N=P===void 0?O:P,A=C[2],I=A===void 0?O:A,k=C[3],z=k===void 0?N:k,V=te(_,4),B=V[0],j=B===void 0?O:B,X=V[1],H=X===void 0?T?j:N:X,$=V[2],W=$===void 0?T?j:I:$,ee=V[3],he=ee===void 0?T?H:z:ee,K=[O,N,I,z].map(function(fe){return Ht(fe,e)}),G=[j,H,W,he].map(function(fe){return Ht(fe,t)}),Y=K.slice(),re=G.slice();c=te(Wm([Y[0],Y[1]],e),2),Y[0]=c[0],Y[1]=c[1],u=te(Wm([Y[3],Y[2]],e),2),Y[3]=u[0],Y[2]=u[1],d=te(Wm([re[0],re[3]],t),2),re[0]=d[0],re[3]=d[1],h=te(Wm([re[1],re[2]],t),2),re[1]=h[0],re[2]=h[1];var Z=o?Y:Y.slice(0,Math.max(a[0],w)),oe=o?re:re.slice(0,Math.max(a[1],S));return Ie(Ie([],te(Z.map(function(fe,be){var Ce=jk[be];return{virtual:be>=w,horizontal:ec[be],vertical:0,pos:[r+fe,i+(tc[be]===-1?t:0)],sub:!0,raw:K[be],direction:Ce}})),!1),te(oe.map(function(fe,be){var Ce=jk[be];return{virtual:be>=S,horizontal:0,vertical:tc[be],pos:[r+(ec[be]===-1?e:0),i+fe],sub:!0,raw:G[be],direction:Ce}})),!1)}function eee(n,e,t,r,i){i===void 0&&(i=e.length);var a=o5(n.slice(r)),o=a.horizontalRange,c=a.verticalRange,u=t-r,d=0;if(u===0)d=i;else if(u>0&&u<o[1])d=o[1]-u;else if(u>=c[0])d=c[0]+c[1]-u;else return;n.splice(t,d),e.splice(t,d)}function tee(n,e,t,r,i,a,o,c,u,d,h){d===void 0&&(d=0),h===void 0&&(h=0);var p=o5(n.slice(t)),m=p.horizontalRange,b=p.verticalRange;if(r>-1)for(var _=ec[r]===1?a-d:c-a,w=m[1];w<=r;++w){var S=tc[w]===1?h:u,T=0;if(r===w?T=a:w===0?T=d+_:ec[w]===-1&&(T=c-(e[t][0]-d)),n.splice(t+w,0,{horizontal:ec[w],vertical:0,pos:[T,S]}),e.splice(t+w,0,[T,S]),w===0)break}else if(i>-1){var C=tc[i]===1?o-h:u-o;if(m[1]===0&&b[1]===0){var R=[d+C,h];n.push({horizontal:ec[0],vertical:0,pos:R}),e.push(R)}for(var O=b[0],w=b[1];w<=i;++w){var T=ec[w]===1?d:c,S=0;if(i===w?S=o:w===0?S=h+C:tc[w]===1?S=e[t+O][1]:tc[w]===-1&&(S=u-(e[t+O][1]-h)),n.push({horizontal:0,vertical:tc[w],pos:[T,S]}),e.push([T,S]),w===0)break}}}function nee(n,e){e===void 0&&(e=n.map(function(i){return i.raw}));var t=n.map(function(i,a){return i.horizontal?e[a]:null}).filter(function(i){return i!=null}),r=n.map(function(i,a){return i.vertical?e[a]:null}).filter(function(i){return i!=null});return{horizontals:t,verticals:r}}var ree=[[0,-1,"n"],[1,0,"e"]],iee=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function VS(n,e,t){var r=n.props.clipRelative,i=n.state,a=i.width,o=i.height,c=e,u=c.type,d=c.poses,h=u==="rect",p=u==="circle";if(u==="polygon")return t.map(function(N){return"".concat(Wi(N[0],a,r)," ").concat(Wi(N[1],o,r))});if(h||u==="inset"){var m=t[1][1],b=t[3][0],_=t[7][0],w=t[5][1];if(h)return[m,b,w,_].map(function(N){return"".concat(N,"px")});var S=[m,a-b,o-w,_].map(function(N,A){return Wi(N,A%2?a:o,r)});if(t.length>8){var T=te(Ke(t[4],t[0]),2),C=T[0],R=T[1];S.push.apply(S,Ie(["round"],te(jS(d.slice(8).map(function(N,A){return J(J({},N),{pos:t[A]})}),r,C,R,_,m,b,w).styles),!1))}return S}else if(p||u==="ellipse"){var O=t[0],P=Wi(Ee(t[1][1]-O[1]),p?Math.sqrt((a*a+o*o)/2):o,r),S=p?[P]:[Wi(Ee(t[2][0]-O[0]),a,r),P];return S.push("at",Wi(O[0],a,r),Wi(O[1],o,r)),S}}function mv(n,e,t,r){var i=[r,(r+e)/2,e],a=[n,(n+t)/2,t];return iee.map(function(o){var c=te(o,3),u=c[0],d=c[1],h=c[2],p=i[u+1],m=a[d+1];return{vertical:Ee(d),horizontal:Ee(u),direction:h,pos:[p,m]}})}function c5(n){var e=[1/0,-1/0],t=[1/0,-1/0];return n.forEach(function(r){var i=r.pos;e[0]=Math.min(e[0],i[0]),e[1]=Math.max(e[1],i[0]),t[0]=Math.min(t[0],i[1]),t[1]=Math.max(t[1],i[1])}),[Ee(e[1]-e[0]),Ee(t[1]-t[0])]}function Vk(n,e,t,r,i){var a,o,c,u,d,h,p,m,b;if(n){var _=i;if(!_){var w=qr(n),S=w("clipPath");_=S!=="none"?S:w("clip")}if(!((!_||_==="none"||_==="auto")&&(_=r,!_))){var T=T3(_),C=T.prefix,R=C===void 0?_:C,O=T.value,P=O===void 0?"":O,N=R==="circle",A=" ";if(R==="polygon"){var I=ac(P||"0% 0%, 100% 0%, 100% 100%, 0% 100%");A=",";var k=I.map(function(lt){var At=te(lt.split(" "),2),et=At[0],ft=At[1];return{vertical:1,horizontal:1,pos:[Ht(et,e),Ht(ft,t)]}}),z=Dc(k.map(function(lt){return lt.pos}));return{type:R,clipText:_,poses:k,splitter:A,left:z.minX,right:z.maxX,top:z.minY,bottom:z.maxY}}else if(N||R==="ellipse"){var V="",B="",j=0,X=0,I=nl(P);if(N){var H="";a=te(I,4),o=a[0],H=o===void 0?"50%":o,c=a[2],V=c===void 0?"50%":c,u=a[3],B=u===void 0?"50%":u,j=Ht(H,Math.sqrt((e*e+t*t)/2)),X=j}else{var $="",W="";d=te(I,5),h=d[0],$=h===void 0?"50%":h,p=d[1],W=p===void 0?"50%":p,m=d[3],V=m===void 0?"50%":m,b=d[4],B=b===void 0?"50%":b,j=Ht($,e),X=Ht(W,t)}var ee=[Ht(V,e),Ht(B,t)],k=Ie([{vertical:1,horizontal:1,pos:ee,direction:"nesw"}],te(ree.slice(0,N?1:2).map(function(et){return{vertical:Ee(et[1]),horizontal:et[0],direction:et[2],sub:!0,pos:[ee[0]+et[0]*j,ee[1]+et[1]*X]}})),!1);return{type:R,clipText:_,radiusX:j,radiusY:X,left:ee[0]-j,top:ee[1]-X,right:ee[0]+j,bottom:ee[1]+X,poses:k,splitter:A}}else if(R==="inset"){var I=nl(P||"0 0 0 0"),he=I.indexOf("round"),K=(he>-1?I.slice(0,he):I).length,G=I.slice(K+1),Y=te(I.slice(0,K),4),re=Y[0],Z=Y[1],oe=Z===void 0?re:Z,fe=Y[2],be=fe===void 0?re:fe,Ce=Y[3],we=Ce===void 0?oe:Ce,Pe=te([re,be].map(function(et){return Ht(et,t)}),2),ue=Pe[0],_e=Pe[1],ze=te([we,oe].map(function(et){return Ht(et,e)}),2),Ne=ze[0],qe=ze[1],Fe=e-qe,Te=t-_e,Le=l5(G,Fe-Ne,Te-ue,Ne,ue),k=Ie(Ie([],te(mv(ue,Fe,Te,Ne)),!1),te(Le),!1);return{type:"inset",clipText:_,poses:k,top:ue,left:Ne,right:Fe,bottom:Te,radius:G,splitter:A}}else if(R==="rect"){var I=ac(P||"0px, ".concat(e,"px, ").concat(t,"px, 0px"));A=",";var Me=te(I.map(function(pn){var Ut=$p(pn).value;return Ut}),4),Be=Me[0],qe=Me[1],_e=Me[2],Ne=Me[3],k=mv(Be,qe,_e,Ne);return{type:"rect",clipText:_,poses:k,top:Be,right:qe,bottom:_e,left:Ne,values:I,splitter:A}}}}}function aee(n,e,t,r,i){var a=n[e],o=a.direction,c=a.sub,u=n.map(function(){return[0,0]}),d=o?o.split(""):[];if(r&&e<8){var h=d.filter(function(j){return j==="w"||j==="e"}),p=d.filter(function(j){return j==="n"||j==="s"}),m=h[0],b=p[0];u[e]=t;var _=te(c5(n),2),w=_[0],S=_[1],T=w&&S?w/S:0;if(T&&i){var C=(e+4)%8,R=n[C].pos,O=[0,0];o.indexOf("w")>-1?O[0]=-1:o.indexOf("e")>-1&&(O[0]=1),o.indexOf("n")>-1?O[1]=-1:o.indexOf("s")>-1&&(O[1]=1);var P=e5([w,S],t,T,O,!0),N=w+P[0],A=S+P[1],I=R[1],k=R[1],z=R[0],V=R[0];O[0]===-1?z=V-N:O[0]===1?V=z+N:(z=z-N/2,V=V+N/2),O[1]===-1?I=k-A:(O[1]===1||(I=k-A/2),k=I+A);var B=mv(I,V,k,z);n.forEach(function(j,X){u[X][0]=B[X].pos[0]-j.pos[0],u[X][1]=B[X].pos[1]-j.pos[1]})}else n.forEach(function(j,X){var H=j.direction;H&&(H.indexOf(m)>-1&&(u[X][0]=t[0]),H.indexOf(b)>-1&&(u[X][1]=t[1]))}),m&&(u[1][0]=t[0]/2,u[5][0]=t[0]/2),b&&(u[3][1]=t[1]/2,u[7][1]=t[1]/2)}else o&&!c?d.forEach(function(j){var X=j==="n"||j==="s";n.forEach(function(H,$){var W=H.direction,ee=H.horizontal,he=H.vertical;!W||W.indexOf(j)===-1||(u[$]=[X||!ee?0:t[0],!X||!he?0:t[1]])})}):u[e]=t;return u}function see(n,e){var t=te(hj(n,e),2),r=t[0],i=t[1],a=e.datas,o=a.clipPath,c=a.clipIndex,u=o,d=u.type,h=u.poses,p=u.splitter,m=h.map(function(C){return C.pos});if(d==="polygon")m.splice(c,0,[r,i]);else if(d==="inset"){var b=ZJ.indexOf(c),_=JJ.indexOf(c),w=h.length;if(tee(h,m,8,b,_,r,i,m[4][0],m[4][1],m[0][0],m[0][1]),w===h.length)return}else return;var S=VS(n,o,m),T="".concat(d,"(").concat(S.join(p),")");Oe(n,"onClip",dt(n,e,J({clipEventType:"added",clipType:d,poses:m,clipStyles:S,clipStyle:T,distX:0,distY:0},Rr({clipPath:T},e))))}function oee(n,e){var t=e.datas,r=t.clipPath,i=t.clipIndex,a=r,o=a.type,c=a.poses,u=a.splitter,d=c.map(function(b){return b.pos}),h=d.length;if(o==="polygon")c.splice(i,1),d.splice(i,1);else if(o==="inset"){if(i<8||(eee(c,d,i,8,h),h===c.length))return}else return;var p=VS(n,r,d),m="".concat(o,"(").concat(p.join(u),")");Oe(n,"onClip",dt(n,e,J({clipEventType:"removed",clipType:o,poses:d,clipStyles:p,clipStyle:m,distX:0,distY:0},Rr({clipPath:m},e))))}var lee={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(n,e){var t=n.props,r=t.customClipPath,i=t.defaultClipPath,a=t.clipArea,o=t.zoom,c=t.groupable,u=n.getState(),d=u.target,h=u.width,p=u.height,m=u.allMatrix,b=u.is3d,_=u.left,w=u.top,S=u.pos1,T=u.pos2,C=u.pos3,R=u.pos4,O=u.clipPathState,P=u.snapBoundInfos,N=u.rotation;if(!d||c)return[];var A=Vk(d,h,p,i||"inset",O||r);if(!A)return[];var I=b?4:3,k=A.type,z=A.poses,V=z.map(function(qe){var Fe=cn(m,qe.pos,I);return[Fe[0]-_,Fe[1]-w]}),B=[],j=[],X=k==="rect",H=k==="inset",$=k==="polygon";if(X||H||$){var W=H?V.slice(0,8):V;j=W.map(function(qe,Fe){var Te=Fe===0?W[W.length-1]:W[Fe-1],Le=An(Te,qe),Me=$j(Te,qe);return e.createElement("div",{key:"clipLine".concat(Fe),className:$e("line","clip-line","snap-control"),"data-clip-index":Fe,style:{width:"".concat(Me,"px"),transform:"translate(".concat(Te[0],"px, ").concat(Te[1],"px) rotate(").concat(Le,"rad) scaleY(").concat(o,")")}})})}if(B=V.map(function(qe,Fe){return e.createElement("div",{key:"clipControl".concat(Fe),className:$e("control","clip-control","snap-control"),"data-clip-index":Fe,style:{transform:"translate(".concat(qe[0],"px, ").concat(qe[1],"px) rotate(").concat(N,"rad) scale(").concat(o,")")}})}),H&&B.push.apply(B,Ie([],te(V.slice(8).map(function(qe,Fe){return e.createElement("div",{key:"clipRadiusControl".concat(Fe),className:$e("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+Fe,style:{transform:"translate(".concat(qe[0],"px, ").concat(qe[1],"px) rotate(").concat(N,"rad) scale(").concat(o,")")}})})),!1)),k==="circle"||k==="ellipse"){var ee=A.left,he=A.top,K=A.radiusX,G=A.radiusY,Y=te(Ke(cn(m,[ee,he],I),cn(m,[0,0],I)),2),re=Y[0],Z=Y[1],oe="none";if(!a){for(var fe=Math.max(10,K/5,G/5),be=[],Ce=0;Ce<=fe;++Ce){var we=Math.PI*2/fe*Ce;be.push([K+(K-o)*Math.cos(we),G+(G-o)*Math.sin(we)])}be.push([K,-2]),be.push([-2,-2]),be.push([-2,G*2+2]),be.push([K*2+2,G*2+2]),be.push([K*2+2,-2]),be.push([K,-2]),oe="polygon(".concat(be.map(function(qe){return"".concat(qe[0],"px ").concat(qe[1],"px")}).join(", "),")")}B.push(e.createElement("div",{key:"clipEllipse",className:$e("clip-ellipse","snap-control"),style:{width:"".concat(K*2,"px"),height:"".concat(G*2,"px"),clipPath:oe,transform:"translate(".concat(-_+re,"px, ").concat(-w+Z,"px) ").concat(py(m))}}))}if(a){var Pe=Ni(Ie([S,T,C,R],te(V),!1)),ue=Pe.width,_e=Pe.height,ze=Pe.left,Ne=Pe.top;if($||X||H){var be=H?V.slice(0,8):V;B.push(e.createElement("div",{key:"clipArea",className:$e("clip-area","snap-control"),style:{width:"".concat(ue,"px"),height:"".concat(_e,"px"),transform:"translate(".concat(ze,"px, ").concat(Ne,"px)"),clipPath:"polygon(".concat(be.map(function(Fe){return"".concat(Fe[0]-ze,"px ").concat(Fe[1]-Ne,"px")}).join(", "),")")}}))}}return P&&["vertical","horizontal"].forEach(function(qe){var Fe=P[qe],Te=qe==="horizontal";Fe.isSnap&&j.push.apply(j,Ie([],te(Fe.snap.posInfos.map(function(Le,Me){var Be=Le.pos,lt=Ke(cn(m,Te?[0,Be]:[Be,0],I),[_,w]),At=Ke(cn(m,Te?[h,Be]:[Be,p],I),[_,w]);return dp(e,"",lt,At,o,"clip".concat(qe,"snap").concat(Me),"guideline")})),!1)),Fe.isBound&&j.push.apply(j,Ie([],te(Fe.bounds.map(function(Le,Me){var Be=Le.pos,lt=Ke(cn(m,Te?[0,Be]:[Be,0],I),[_,w]),At=Ke(cn(m,Te?[h,Be]:[Be,p],I),[_,w]);return dp(e,"",lt,At,o,"clip".concat(qe,"bounds").concat(Me),"guideline","bounds","bold")})),!1))}),Ie(Ie([],te(B),!1),te(j),!1)},dragControlCondition:function(n,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(n,e){var t=n.props,r=t.dragWithClip,i=r===void 0?!0:r;return i?!1:this.dragControlStart(n,e)},drag:function(n,e){return this.dragControl(n,J(J({},e),{isDragTarget:!0}))},dragEnd:function(n,e){return this.dragControlEnd(n,e)},dragControlStart:function(n,e){var t=n.state,r=n.props,i=r.defaultClipPath,a=r.customClipPath,o=t.target,c=t.width,u=t.height,d=e.inputEvent?e.inputEvent.target:null,h=d&&d.getAttribute("class")||"",p=e.datas,m=Vk(o,c,u,i||"inset",a);if(!m)return!1;var b=m.clipText,_=m.type,w=m.poses,S=Oe(n,"onClipStart",dt(n,e,{clipType:_,clipStyle:b,poses:w.map(function(T){return T.pos})}));return S===!1?(p.isClipStart=!1,!1):(p.isControl=h&&h.indexOf("clip-control")>-1,p.isLine=h.indexOf("clip-line")>-1,p.isArea=h.indexOf("clip-area")>-1||h.indexOf("clip-ellipse")>-1,p.clipIndex=d?parseInt(d.getAttribute("data-clip-index"),10):-1,p.clipPath=m,p.isClipStart=!0,t.clipPathState=b,Vc(n,e),!0)},dragControl:function(n,e){var t,r,i,a=e.datas,o=e.originalDatas,c=e.isDragTarget;if(!a.isClipStart)return!1;var u=a,d=u.isControl,h=u.isLine,p=u.isArea,m=u.clipIndex,b=u.clipPath;if(!b)return!1;var _=kc(n.props,"clippable"),w=_.keepRatio,S=0,T=0,C=o.draggable,R=Wa(e);c&&C?(t=te(C.prevBeforeDist,2),S=t[0],T=t[1]):(r=te(R,2),S=r[0],T=r[1]);var O=[S,T],P=n.state,N=P.width,A=P.height,I=!p&&!d&&!h,k=b.type,z=b.poses,V=b.splitter,B=z.map(function(mt){return mt.pos});I&&(S=-S,T=-T);var j=!d||z[m].direction==="nesw",X=k==="inset"||k==="rect",H=z.map(function(){return[0,0]});if(d&&!j){var $=z[m],W=$.horizontal,ee=$.vertical,he=[S*Ee(W),T*Ee(ee)];H=aee(z,m,he,X,w)}else j&&(H=B.map(function(){return[S,T]}));var K=B.map(function(mt,on){return It(mt,H[on])}),G=Ie([],te(K),!1);P.snapBoundInfos=null;var Y=b.type==="circle",re=b.type==="ellipse";if(Y||re){var Z=Ni(K),oe=Ee(Z.bottom-Z.top),fe=Ee(re?Z.right-Z.left:oe),be=K[0][1]+oe,Ce=K[0][0]-fe,we=K[0][0]+fe;Y&&(G.push([we,Z.bottom]),H.push([1,0])),G.push([Z.left,be]),H.push([0,1]),G.push([Ce,Z.bottom]),H.push([1,0])}var Pe=Lj((_.clipHorizontalGuidelines||[]).map(function(mt){return Ht("".concat(mt),A)}),(_.clipVerticalGuidelines||[]).map(function(mt){return Ht("".concat(mt),N)}),N,A),ue=[],_e=[];if(Y||re)ue=[G[4][0],G[2][0]],_e=[G[1][1],G[3][1]];else if(X){var ze=[G[0],G[2],G[4],G[6]],Ne=[H[0],H[2],H[4],H[6]];ue=ze.filter(function(mt,on){return Ne[on][0]}).map(function(mt){return mt[0]}),_e=ze.filter(function(mt,on){return Ne[on][1]}).map(function(mt){return mt[1]})}else ue=G.filter(function(mt,on){return H[on][0]}).map(function(mt){return mt[0]}),_e=G.filter(function(mt,on){return H[on][1]}).map(function(mt){return mt[1]});var qe=[0,0],Fe=_k(Pe,_.clipTargetBounds&&{left:0,top:0,right:N,bottom:A},ue,_e,5,5),Te=Fe.horizontal,Le=Fe.vertical,Me=Te.offset,Be=Le.offset;if(Te.isBound&&(qe[1]+=Me),Le.isBound&&(qe[0]+=Be),(re||Y)&&H[0][0]===0&&H[0][1]===0){var Z=Ni(K),lt=Z.bottom-Z.top,At=re?Z.right-Z.left:lt,et=Le.isBound?Ee(Be):Le.snapIndex===0?-Be:Be,ft=Te.isBound?Ee(Me):Te.snapIndex===0?-Me:Me;At-=et,lt-=ft,Y&&(lt=kj(Le,Te)>0?lt:At,At=lt);var kt=G[0];G[1][1]=kt[1]-lt,G[2][0]=kt[0]+At,G[3][1]=kt[1]+lt,G[4][0]=kt[0]-At}else if(X&&w&&d){var pn=te(c5(z),2),Ut=pn[0],Cn=pn[1],Hr=Ut&&Cn?Ut/Cn:0,ua=z[m],Qa=ua.direction||"",Fs=G[1][1],be=G[5][1],Ce=G[7][0],we=G[3][0];Ee(Me)<=Ee(Be)?Me=Ar(Me)*Ee(Be)/Hr:Be=Ar(Be)*Ee(Me)*Hr,Qa.indexOf("w")>-1?Ce-=Be:Qa.indexOf("e")>-1?we-=Be:(Ce+=Be/2,we-=Be/2),Qa.indexOf("n")>-1?Fs-=Me:Qa.indexOf("s")>-1?be-=Me:(Fs+=Me/2,be-=Me/2);var Yr=mv(Fs,we,be,Ce);G.forEach(function(Kr,ui){var _r;_r=te(Yr[ui].pos,2),Kr[0]=_r[0],Kr[1]=_r[1]})}else G.forEach(function(mt,on){var ln=H[on];ln[0]&&(mt[0]-=Be),ln[1]&&(mt[1]-=Me)});var In=VS(n,b,K),dr="".concat(k,"(").concat(In.join(V),")");if(P.clipPathState=dr,Y||re)ue=[G[4][0],G[2][0]],_e=[G[1][1],G[3][1]];else if(X){var ze=[G[0],G[2],G[4],G[6]];ue=ze.map(function(on){return on[0]}),_e=ze.map(function(on){return on[1]})}else ue=G.map(function(mt){return mt[0]}),_e=G.map(function(mt){return mt[1]});if(P.snapBoundInfos=_k(Pe,_.clipTargetBounds&&{left:0,top:0,right:N,bottom:A},ue,_e,1,1),C){var sn=P.is3d,Lc=P.allMatrix,Gs=sn?4:3,qs=qe;c&&(qs=[O[0]+qe[0]-R[0],O[1]+qe[1]-R[1]]),C.deltaOffset=Yt(Lc,[qs[0],qs[1],0,0],Gs)}return Oe(n,"onClip",dt(n,e,J({clipEventType:"changed",clipType:k,poses:K,clipStyle:dr,clipStyles:In,distX:S,distY:T},Rr((i={},i[k==="rect"?"clip":"clipPath"]=dr,i),e)))),!0},dragControlEnd:function(n,e){this.unset(n);var t=e.isDrag,r=e.datas,i=e.isDouble,a=r.isLine,o=r.isClipStart,c=r.isControl;return o?(Oe(n,"onClipEnd",li(n,e,{})),i&&(c?oee(n,e):a&&see(n,e)),i||t):!1},unset:function(n){n.state.clipPathState="",n.state.snapBoundInfos=null}},cee={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(n,e){return e.isRequest?e.requestAble==="originDraggable":Hn(e.inputEvent.target,$e("origin"))},dragControlStart:function(n,e){var t=e.datas;Vc(n,e);var r=dt(n,e,{dragStart:Tr.dragStart(n,new wd().dragStart([0,0],e))}),i=Oe(n,"onDragOriginStart",r);return t.startOrigin=n.state.transformOrigin,t.startTargetOrigin=n.state.targetOrigin,t.prevOrigin=[0,0],t.isDragOrigin=!0,i===!1?(t.isDragOrigin=!1,!1):r},dragControl:function(n,e){var t=e.datas,r=e.isPinch,i=e.isRequest;if(!t.isDragOrigin)return!1;var a=te(Wa(e),2),o=a[0],c=a[1],u=n.state,d=u.width,h=u.height,p=u.offsetMatrix,m=u.targetMatrix,b=u.is3d,_=n.props.originRelative,w=_===void 0?!0:_,S=b?4:3,T=[o,c];if(i){var C=e.distOrigin;(C[0]||C[1])&&(T=C)}var R=It(t.startOrigin,T),O=It(t.startTargetOrigin,T),P=Ke(T,t.prevOrigin),N=eg(p,m,R,S),A=n.getRect(),I=Ni(zc(N,d,h,S)),k=[A.left-I.left,A.top-I.top];t.prevOrigin=T;var z=[Wi(O[0],d,w),Wi(O[1],h,w)].join(" "),V=Tr.drag(n,Jp(e,n.state,k,!!r)),B=dt(n,e,J(J({width:d,height:h,origin:R,dist:T,delta:P,transformOrigin:z,drag:V},Rr({transformOrigin:z,transform:V.transform},e)),{afterTransform:V.transform}));return Oe(n,"onDragOrigin",B),B},dragControlEnd:function(n,e){var t=e.datas;return t.isDragOrigin?(Oe(n,"onDragOriginEnd",li(n,e,{})),!0):!1},dragGroupControlCondition:function(n,e){return this.dragControlCondition(n,e)},dragGroupControlStart:function(n,e){var t=this.dragControlStart(n,e);return!!t},dragGroupControl:function(n,e){var t=this.dragControl(n,e);return t?(n.transformOrigin=t.transformOrigin,!0):!1},request:function(n){var e={},t=n.getRect(),r=0,i=0,a=t.transformOrigin,o=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(c){return"deltaOrigin"in c?(o[0]+=c.deltaOrigin[0],o[1]+=c.deltaOrigin[1]):"origin"in c?(o[0]=c.origin[0]-a[0],o[1]=c.origin[1]-a[1]):("x"in c?r=c.x-t.left:"deltaX"in c&&(r+=c.deltaX),"y"in c?i=c.y-t.top:"deltaY"in c&&(i+=c.deltaY)),{datas:e,distX:r,distY:i,distOrigin:o}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function uee(n,e,t,r){var i=n.filter(function(u){var d=u.virtual,h=u.horizontal;return h&&!d}).length,a=n.filter(function(u){var d=u.virtual,h=u.vertical;return h&&!d}).length,o=-1;if(e===0&&(i===0?o=0:i===1&&(o=1)),e===2&&(i<=2?o=2:i<=3&&(o=3)),e===3&&(a===0?o=4:a<4&&(o=7)),e===1&&(a<=1?o=5:a<=2&&(o=6)),!(o===-1||!n[o].virtual)){var c=n[o];dee(n,o),o<4?c.pos[0]=t:c.pos[1]=r}}function dee(n,e){e<4?n.slice(0,e+1).forEach(function(t){t.virtual=!1}):(n[0].virtual&&(n[0].virtual=!1),n.slice(4,e+1).forEach(function(t){t.virtual=!1}))}function fee(n,e){e<4?n.slice(e,4).forEach(function(t){t.virtual=!0}):n.slice(e).forEach(function(t){t.virtual=!0})}function zk(n,e,t,r,i){r===void 0&&(r=[0,0]);var a=[];return!n||n==="0px"?a=[]:a=nl(n),l5(a,e,t,0,0,r,i)}function Lk(n,e,t,r,i){var a=n.state,o=a.width,c=a.height,u=jS(i,n.props.roundRelative,o,c),d=u.raws,h=u.styles,p=u.radiusPoses,m=nee(p,d),b=m.horizontals,_=m.verticals,w=h.join(" ");a.borderRadiusState=w;var S=dt(n,e,J({horizontals:b,verticals:_,borderRadius:w,width:o,height:c,delta:r,dist:t},Rr({borderRadius:w},e)));return Oe(n,"onRound",S),S}function Bk(n){var e,t,r=n.getState().style,i=r.borderRadius||"";if(!i&&n.props.groupable){var a=n.moveables[0],o=n.getTargets()[0];o&&(a?.props.target===o?(i=(t=(e=n.moveables[0])===null||e===void 0?void 0:e.state.style.borderRadius)!==null&&t!==void 0?t:"",r.borderRadius=i):(i=kS(o).borderRadius,r.borderRadius=i))}return i}var hee={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(n){var e=n.props.roundClickable;return e===!0||e==="line"?$e("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(n,e){var t=n.getState(),r=t.target,i=t.width,a=t.height,o=t.allMatrix,c=t.is3d,u=t.left,d=t.top,h=t.borderRadiusState,p=n.props,m=p.minRoundControls,b=m===void 0?[0,0]:m,_=p.maxRoundControls,w=_===void 0?[4,4]:_,S=p.zoom,T=p.roundPadding,C=T===void 0?0:T,R=p.isDisplayShadowRoundControls,O=p.groupable;if(!r)return null;var P=h||Bk(n),N=c?4:3,A=zk(P,i,a,b,!0);if(!A)return null;var I=0,k=0,z=O?[0,0]:[u,d];return A.map(function(V,B){var j=V.horizontal,X=V.vertical,H=V.direction||"",$=Ie([],te(V.pos),!1);k+=Math.abs(j),I+=Math.abs(X),j&&H.indexOf("n")>-1&&($[1]-=C),X&&H.indexOf("w")>-1&&($[0]-=C),j&&H.indexOf("s")>-1&&($[1]+=C),X&&H.indexOf("e")>-1&&($[0]+=C);var W=Ke(cn(o,$,N),z),ee=R&&R!=="horizontal",he=V.vertical?I<=w[1]&&(ee||!V.virtual):k<=w[0]&&(R||!V.virtual);return e.createElement("div",{key:"borderRadiusControl".concat(B),className:$e("control","border-radius",V.vertical?"vertical":"",V.virtual?"virtual":""),"data-radius-index":B,style:{display:he?"block":"none",transform:"translate(".concat(W[0],"px, ").concat(W[1],"px) scale(").concat(S,")")}})})},dragControlCondition:function(n,e){if(!e.inputEvent||e.isRequest)return!1;var t=e.inputEvent.target.getAttribute("class")||"";return t.indexOf("border-radius")>-1||t.indexOf("moveable-line")>-1&&t.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(n,e){return this.dragControlCondition(n,e)},dragControlStart:function(n,e){var t=e.inputEvent,r=e.datas,i=t.target,a=i.getAttribute("class")||"",o=a.indexOf("border-radius")>-1,c=a.indexOf("moveable-line")>-1&&a.indexOf("moveable-direction")>-1,u=o?parseInt(i.getAttribute("data-radius-index"),10):-1,d=-1;if(c){var h=i.getAttribute("data-line-key")||"";h&&(d=parseInt(h.replace(/render-line-/g,""),10),isNaN(d)&&(d=-1))}if(!o&&!c)return!1;var p=dt(n,e,{}),m=Oe(n,"onRoundStart",p);if(m===!1)return!1;r.lineIndex=d,r.controlIndex=u,r.isControl=o,r.isLine=c,Vc(n,e);var b=n.props,_=b.roundRelative,w=b.minRoundControls,S=w===void 0?[0,0]:w,T=n.state,C=T.width,R=T.height;r.isRound=!0,r.prevDist=[0,0];var O=Bk(n),P=zk(O||"",C,R,S,!0)||[];return r.controlPoses=P,T.borderRadiusState=jS(P,_,C,R).styles.join(" "),p},dragControl:function(n,e){var t=e.datas,r=t.controlPoses;if(!t.isRound||!t.isControl||!r.length)return!1;var i=t.controlIndex,a=te(Wa(e),2),o=a[0],c=a[1],u=[o,c],d=Ke(u,t.prevDist),h=n.props.maxRoundControls,p=h===void 0?[4,4]:h,m=n.state,b=m.width,_=m.height,w=r[i],S=w.vertical,T=w.horizontal,C=r.map(function(O){var P=O.horizontal,N=O.vertical,A=[P*T*u[0],N*S*u[1]];if(P){if(p[0]===1)return A;if(p[0]<4&&P!==T)return A}else{if(p[1]===0)return A[1]=N*T*u[0]/b*_,A;if(S){if(p[1]===1)return A;if(p[1]<4&&N!==S)return A}}return[0,0]});C[i]=u;var R=r.map(function(O,P){return J(J({},O),{pos:It(O.pos,C[P])})});return i<4?R.slice(0,i+1).forEach(function(O){O.virtual=!1}):R.slice(4,i+1).forEach(function(O){O.virtual=!1}),t.prevDist=[o,c],Lk(n,e,u,d,R)},dragControlEnd:function(n,e){var t=n.state;t.borderRadiusState="";var r=e.datas,i=e.isDouble;if(!r.isRound)return!1;var a=r.isControl,o=r.controlIndex,c=r.isLine,u=r.lineIndex,d=r.controlPoses,h=d.filter(function(T){var C=T.virtual;return C}).length,p=n.props.roundClickable,m=p===void 0?!0:p;if(i&&m){if(a&&(m===!0||m==="control"))fee(d,o);else if(c&&(m===!0||m==="line")){var b=te(hj(n,e),2),_=b[0],w=b[1];uee(d,u,_,w)}h!==d.filter(function(T){var C=T.virtual;return C}).length&&Lk(n,e,[0,0],[0,0],d)}var S=li(n,e,{});return Oe(n,"onRoundEnd",S),t.borderRadiusState="",S},dragGroupControlStart:function(n,e){var t=this.dragControlStart(n,e);if(!t)return!1;var r=n.moveables,i=n.props.targets,a=na(n,"roundable",e),o=J({targets:n.props.targets,events:a.map(function(c,u){return J(J({},c),{target:i[u],moveable:r[u],currentTarget:r[u]})})},t);return Oe(n,"onRoundGroupStart",o),t},dragGroupControl:function(n,e){var t=this.dragControl(n,e);if(!t)return!1;var r=n.moveables,i=n.props.targets,a=na(n,"roundable",e),o=J({targets:n.props.targets,events:a.map(function(c,u){return J(J(J({},c),{target:i[u],moveable:r[u],currentTarget:r[u]}),Rr({borderRadius:t.borderRadius},c))})},t);return Oe(n,"onRoundGroup",o),o},dragGroupControlEnd:function(n,e){var t=n.moveables,r=n.props.targets,i=na(n,"roundable",e);gy(n,"onRound",function(c){var u=J({targets:n.props.targets,events:i.map(function(d,h){return J(J(J({},d),{target:r[h],moveable:t[h],currentTarget:t[h]}),Rr({borderRadius:c.borderRadius},d))})},c);Oe(n,"onRoundGroup",u)});var a=this.dragControlEnd(n,e);if(!a)return!1;var o=J({targets:n.props.targets,events:i.map(function(c,u){var d;return J(J({},c),{target:r[u],moveable:t[u],currentTarget:t[u],lastEvent:(d=c.datas)===null||d===void 0?void 0:d.lastEvent})})},a);return Oe(n,"onRoundGroupEnd",o),o},unset:function(n){n.state.borderRadiusState=""}};function pee(n,e){var t=e?4:3,r=Zt(t),i="matrix".concat(e?"3d":"","(").concat(r.join(","),")");return n===i||n==="matrix(1,0,0,1,0,0)"}var u5={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(n,e){var t=n.state,r=t.is3d,i=t.targetMatrix,a=t.inlineTransform,o=r?"matrix3d(".concat(i.join(","),")"):"matrix(".concat(ej(i,!0),")"),c=!a||a==="none"?o:a;e.datas.startTransforms=pee(c,r)?[]:nl(c)},resetStyle:function(n){var e=n.datas;e.nextStyle={},e.nextTransforms=n.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(n,e){return dt(n,e,{setTransform:function(t){e.datas.startTransforms=Fn(t)?t:nl(t)},isPinch:!!e.isPinch})},fillDragParams:function(n,e){return dt(n,e,{isPinch:!!e.isPinch})},dragStart:function(n,e){this.setTransform(n,e),this.resetStyle(e),Oe(n,"onBeforeRenderStart",this.fillDragStartParams(n,e))},drag:function(n,e){e.datas.startTransforms||this.setTransform(n,e),this.resetStyle(e),Oe(n,"onBeforeRender",dt(n,e,{isPinch:!!e.isPinch}))},dragEnd:function(n,e){e.datas.startTransforms||(this.setTransform(n,e),this.resetStyle(e)),Oe(n,"onBeforeRenderEnd",dt(n,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(n,e){var t=this;this.dragStart(n,e);var r=na(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.setTransform(u,o),t.resetStyle(o),t.fillDragStartParams(u,o)});Oe(n,"onBeforeRenderGroupStart",dt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets,setTransform:function(){},events:a}))},dragGroup:function(n,e){var t=this;this.drag(n,e);var r=na(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.resetStyle(o),t.fillDragParams(u,o)});Oe(n,"onBeforeRenderGroup",dt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets,events:a}))},dragGroupEnd:function(n,e){this.dragEnd(n,e),Oe(n,"onBeforeRenderGroupEnd",dt(n,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:n.props.targets}))},dragControlStart:function(n,e){return this.dragStart(n,e)},dragControl:function(n,e){return this.drag(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupControlStart:function(n,e){return this.dragGroupStart(n,e)},dragGroupControl:function(n,e){return this.dragGroup(n,e)},dragGroupControlEnd:function(n,e){return this.dragGroupEnd(n,e)}},d5={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(n,e){Oe(n,"onRenderStart",dt(n,e,{isPinch:!!e.isPinch}))},drag:function(n,e){Oe(n,"onRender",this.fillDragParams(n,e))},dragAfter:function(n,e){return this.drag(n,e)},dragEnd:function(n,e){Oe(n,"onRenderEnd",this.fillDragEndParams(n,e))},dragGroupStart:function(n,e){Oe(n,"onRenderGroupStart",dt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets}))},dragGroup:function(n,e){var t=this,r=na(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.fillDragParams(u,o)});Oe(n,"onRenderGroup",dt(n,e,J(J({isPinch:!!e.isPinch,targets:n.props.targets,transform:qm(e),transformObject:{}},Rr($m(e))),{events:a})))},dragGroupEnd:function(n,e){var t=this,r=na(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.fillDragEndParams(u,o)});Oe(n,"onRenderGroupEnd",dt(n,e,J({isPinch:!!e.isPinch,isDrag:e.isDrag,targets:n.props.targets,events:a,transformObject:{},transform:qm(e)},Rr($m(e)))))},dragControlStart:function(n,e){return this.dragStart(n,e)},dragControl:function(n,e){return this.drag(n,e)},dragControlAfter:function(n,e){return this.dragAfter(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupControlStart:function(n,e){return this.dragGroupStart(n,e)},dragGroupControl:function(n,e){return this.dragGroup(n,e)},dragGroupControlEnd:function(n,e){return this.dragGroupEnd(n,e)},fillDragParams:function(n,e){var t={};return _d(cv(e)||[]).forEach(function(r){t[r.name]=r.functionValue}),dt(n,e,J({isPinch:!!e.isPinch,transformObject:t,transform:qm(e)},Rr($m(e))))},fillDragEndParams:function(n,e){var t={};return _d(cv(e)||[]).forEach(function(r){t[r.name]=r.functionValue}),dt(n,e,J({isPinch:!!e.isPinch,isDrag:e.isDrag,transformObject:t,transform:qm(e)},Rr($m(e))))}};function Oh(n,e,t,r,i,a,o){a.clientDistX=a.distX,a.clientDistY=a.distY;var c=i==="Start",u=i==="End",d=i==="After",h=n.state.target,p=a.isRequest,m=r.indexOf("Control")>-1;if(!h||c&&m&&!p&&n.areaElement===a.inputEvent.target)return!1;var b=Ie([],te(e),!1);if(p){var _=a.requestAble;b.some(function(B){return B.name===_})||b.push.apply(b,Ie([],te(n.props.ables.filter(function(B){return B.name===_})),!1))}if(!b.length||b.every(function(B){return B.dragRelation}))return!1;var w=a.inputEvent,S;u&&w&&(S=document.elementFromPoint(a.clientX,a.clientY)||w.target);var T=!1,C=function(){var B;T=!0,(B=a.stop)===null||B===void 0||B.call(a)},R=c&&(!n.targetGesto||!n.controlGesto||!n.targetGesto.isFlag()||!n.controlGesto.isFlag());R&&n.updateRect(i,!0,!1);var O=a.datas,P=m?"controlGesto":"targetGesto",N=n[P],A=function(B,j,X){if(!(j in B)||N!==n[P])return!1;var H=B.name,$=O[H]||(O[H]={});if(c&&($.isEventStart=!X||!B[X]||B[X](n,a)),!$.isEventStart)return!1;var W=B[j](n,J(J({},a),{stop:C,datas:$,originalDatas:O,inputTarget:S}));return n._emitter.off(),c&&W===!1&&($.isEventStart=!1),W};R&&b.forEach(function(B){B.unset&&B.unset(n)}),A(u5,"drag".concat(r).concat(i));var I=0,k=0;t.forEach(function(B){if(T)return!1;var j="".concat(B).concat(r).concat(i),X="".concat(B).concat(r,"Condition");i===""&&!p&&VJ(n.state,a);var H=b.filter(function(ee){return ee[j]});H=H.filter(function(ee,he){return ee.name&&H.indexOf(ee)===he});var $=H.filter(function(ee){return A(ee,j,X)}),W=$.length;T&&++I,W&&++k,!T&&c&&H.length&&!W&&(I+=H.filter(function(ee){var he=ee.name,K=O[he];return K.isEventStart?ee.dragRelation!=="strong":!1}).length?1:0)}),(!d||k)&&A(d5,"drag".concat(r).concat(i));var z=N!==n[P]||I===t.length;if((u||T||z)&&(n.state.gestos={},n.moveables&&n.moveables.forEach(function(B){B.state.gestos={}}),b.forEach(function(B){B.unset&&B.unset(n)})),c&&!z&&!p&&k&&n.props.preventDefault&&a?.preventDefault(),n.isUnmounted||z)return!1;if(!c&&k&&!o||u){var V=n.props.flushSync||Fj;V(function(){n.updateRect(u?i:"",!0,!1),n.forceUpdate()})}return!c&&!u&&!d&&k&&!o&&Oh(n,e,t,r,i+"After",a),!0}function zS(n,e){return function(t,r){var i;r===void 0&&(r=t.inputEvent.target);var a=r,o=n.areaElement,c=n._dragTarget;return!c||!e&&(!((i=n.controlGesto)===null||i===void 0)&&i.isFlag())?!1:a===c||c.contains(a)||a===o||!n.isMoveableElement(a)&&!n.controlBox.contains(a)||Hn(a,"moveable-area")||Hn(a,"moveable-padding")||Hn(a,"moveable-edgeDraggable")}}function f5(n,e,t){var r=n.controlBox,i=[],a=n.props,o=a.dragArea,c=n.state.target,u=a.dragTarget;i.push(r),(!o||u)&&i.push(e),!o&&u&&c&&e!==c&&a.dragTargetSelf&&i.push(c);var d=zS(n);return p5(n,i,"targetAbles",t,{dragStart:d,pinchStart:d})}function h5(n,e){var t=n.controlBox,r=[];r.push(t);var i=zS(n,!0),a=function(o,c){if(c===void 0&&(c=o.inputEvent.target),c===t)return!0;var u=i(o,c);return!u};return p5(n,r,"controlAbles",e,{dragStart:a,pinchStart:a})}function p5(n,e,t,r,i){i===void 0&&(i={});var a=t==="targetAbles",o=n.props,c=o.pinchOutside,u=o.pinchThreshold,d=o.preventClickEventOnDrag,h=o.preventClickDefault,p=o.checkInput,m=o.dragFocusedInput,b=o.preventDefault,_=b===void 0?!0:b,w=o.preventRightClick,S=w===void 0?!0:w,T=o.preventWheelClick,C=T===void 0?!0:T,R=o.dragContainer,O=Ga(R,!0),P={preventDefault:_,preventRightClick:S,preventWheelClick:C,container:O||Yo(n.getControlBoxElement()),pinchThreshold:u,pinchOutside:c,preventClickEventOnDrag:a?d:!1,preventClickEventOnDragStart:a?h:!1,preventClickEventByCondition:a?null:function(I){return n.controlBox.contains(I.target)},checkInput:a?p:!1,dragFocusedInput:m},N=new UQ(e,P),A=r==="Control";return["drag","pinch"].forEach(function(I){["Start","","End"].forEach(function(k){N.on("".concat(I).concat(k),function(z){var V,B=z.eventType,j=I==="drag"&&z.isPinch;if(i[B]&&!i[B](z)){z.stop();return}if(!j){var X=I==="drag"?[I]:["drag",I],H=Ie([],te(n[t]),!1),$=Oh(n,H,X,r,k,z);$?(n.props.stopPropagation||k==="Start"&&A)&&((V=z?.inputEvent)===null||V===void 0||V.stopPropagation()):z.stop()}})})}),N}var gee=(function(){function n(e,t,r){var i=this;this.target=e,this.moveable=t,this.eventName=r,this.ables=[],this._onEvent=function(a){var o=i.eventName,c=i.moveable;c.state.disableNativeEvent||i.ables.forEach(function(u){u[o](c,{inputEvent:a})})},e.addEventListener(r.toLowerCase(),this._onEvent)}return n.prototype.setAbles=function(e){this.ables=e},n.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},n})();function mee(n,e,t,r){var i;t===void 0&&(t=e);var a=bj(n,e),o=a.matrixes,c=a.is3d,u=a.targetMatrix,d=a.transformOrigin,h=a.targetOrigin,p=a.offsetContainer,m=a.hasFixed,b=a.zoom,_=DZ(p,t),w=_.matrixes,S=_.is3d,T=_.offsetContainer,C=_.zoom,R=r,O=4,P=n.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in n,N=u,A=Zt(O),I=Zt(O),k=Zt(O),z=Zt(O),V=o.length,B=w.map(function(he){return J(J({},he),{matrix:he.matrix?Ie([],te(he.matrix),!1):void 0})}).reverse();o.reverse(),!c&&R&&(N=la(N,3,4),J_(o)),!S&&R&&J_(B),B.forEach(function(he){I=Yt(I,he.matrix,O)});var j=t||ul(n),X=((i=B[0])===null||i===void 0?void 0:i.target)||fp(j,j,!0).offsetParent,H=B.slice(1).reduce(function(he,K){return Yt(he,K.matrix,O)},Zt(O));o.forEach(function(he,K){if(V-2===K&&(k=A.slice()),V-1===K&&(z=A.slice()),!he.matrix){var G=o[K+1],Y=MJ(he,G,X,O,Yt(H,A,O));he.matrix=Rc(Y,O)}A=Yt(A,he.matrix,O)});var $=!P&&c;N||(N=Zt($?4:3));var W=py(P&&N.length===16?la(N,4,3):N,$),ee=I;return I=Z3(I,O,O),{hasZoom:b!==1||C!==1,hasFixed:m,matrixes:o,rootMatrix:I,originalRootMatrix:ee,beforeMatrix:k,offsetMatrix:z,allMatrix:A,targetMatrix:N,targetTransform:W,inlineTransform:n.style.transform,transformOrigin:d,targetOrigin:h,is3d:R,offsetContainer:p,offsetRootContainer:T}}function vee(n,e,t,r){t===void 0&&(t=e);var i=0,a=0,o=0,c={},u=Hj(n);if(n&&(i=u.offsetWidth,a=u.offsetHeight),n){var d=mee(n,e,t,r),h=rd(d.allMatrix,d.transformOrigin,i,a);c=J(J({},d),h);var p=rd(d.allMatrix,[50,50],100,100);o=Yj([p.pos1,p.pos2],p.direction)}var m=4;return J(J(J({hasZoom:!1,width:i,height:a,rotation:o},u),{originalRootMatrix:Zt(m),rootMatrix:Zt(m),beforeMatrix:Zt(m),offsetMatrix:Zt(m),allMatrix:Zt(m),targetMatrix:Zt(m),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!0,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),c)}function rw(n,e,t,r,i,a){a===void 0&&(a=[]);var o=1,c=[0,0],u=Ym(),d=Ym(),h=Ym(),p=Ym(),m=[0,0],b={},_=vee(e,t,i,!0);if(e){var w=qr(e);a.forEach(function(B){b[B]=w(B)});var S=_.is3d?4:3,T=rd(_.offsetMatrix,It(_.transformOrigin,J3(_.targetMatrix,S)),_.width,_.height);o=T.direction,c=It(T.origin,[T.left-_.left,T.top-_.top]),p=Ph(_.offsetRootContainer);var C=fp(r,r,!0).offsetParent||_.offsetRootContainer;if(_.hasZoom){var R=rd(Yt(_.originalRootMatrix,_.allMatrix),_.transformOrigin,_.width,_.height),O=rd(_.originalRootMatrix,hv(qr(C)("transformOrigin")).map(function(B){return parseFloat(B)}),C.offsetWidth,C.offsetHeight);if(u=g1(R,p),h=g1(O,p,C,!0),n){var P=R.left,N=R.top;d=g1({left:P,top:N,bottom:N,right:N},p)}}else{u=Ph(e),h=RZ(C),n&&(d=Ph(n));var A=h.left,I=h.top,k=h.clientLeft,z=h.clientTop,V=[u.left-A,u.top-I];m=Ke(Td(_.rootMatrix,V,4),[k+_.left,z+_.top])}}return J({targetClientRect:u,containerClientRect:h,moveableClientRect:d,rootContainerClientRect:p,beforeDirection:o,beforeOrigin:c,originalBeforeOrigin:c,target:e,style:b,offsetDelta:m},_)}function Uk(n){var e=n.pos1,t=n.pos2,r=n.pos3,i=n.pos4;if(!e||!t||!r||!i)return null;var a=Dc([e,t,r,i]),o=[a.minX,a.minY],c=Ke(n.origin,o);return e=Ke(e,o),t=Ke(t,o),r=Ke(r,o),i=Ke(i,o),J(J({},n),{left:n.left,top:n.top,posDelta:o,pos1:e,pos2:t,pos3:r,pos4:i,origin:c,beforeOrigin:c,isPersisted:!0})}var Ad=(function(n){Qp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.state=J({container:null,gestos:{},renderLines:[[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]]],renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},rw(null)),t.renderState={},t.enabledAbles=[],t.targetAbles=[],t.controlAbles=[],t.rotation=0,t.scale=[1,1],t.isMoveableMounted=!1,t.isUnmounted=!1,t.events={mouseEnter:null,mouseLeave:null},t._emitter=new sy,t._prevOriginalDragTarget=null,t._originalDragTarget=null,t._prevDragTarget=null,t._dragTarget=null,t._prevPropTarget=null,t._propTarget=null,t._prevDragArea=!1,t._isPropTargetChanged=!1,t._hasFirstTarget=!1,t._reiszeObserver=null,t._observerId=0,t._mutationObserver=null,t._rootContainer=null,t._viewContainer=null,t._viewClassNames=[],t._store={},t.checkUpdateRect=function(){if(!t.isDragging()){var r=t.props.parentMoveable;if(r){r.checkUpdateRect();return}NW(t._observerId),t._observerId=A3(function(){t.isDragging()||t.updateRect()})}},t._onPreventClick=function(r){r.stopPropagation(),r.preventDefault()},t}return e.prototype.render=function(){var t=this.props,r=this.getState(),i=t.parentPosition,a=t.className,o=t.target,c=t.zoom,u=t.cspNonce,d=t.translateZ,h=t.cssStyled,p=t.groupable,m=t.linePadding,b=t.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var _=te(i||[0,0],2),w=_[0],S=_[1],T=r.left,C=r.top,R=r.target,O=r.direction,P=r.hasFixed,N=r.offsetDelta,A=t.targets,I=this.isDragging(),k={};this.getEnabledAbles().forEach(function(H){k["data-able-".concat(H.name.toLowerCase())]=!0});var z=this._getAbleClassName(),V=A&&A.length&&(R||p)||o||!this._hasFirstTarget&&this.state.isPersisted,B=this.controlBox||this.props.firstRenderState||this.props.persistData,j=[T-w,C-S];!p&&t.useAccuratePosition&&(j[0]+=N[0],j[1]+=N[1]);var X={position:P?"fixed":"absolute",display:V?"block":"none",visibility:B?"visible":"hidden",transform:"translate3d(".concat(j[0],"px, ").concat(j[1],"px, ").concat(d,")"),"--zoom":c,"--zoompx":"".concat(c,"px")};return m&&(X["--moveable-line-padding"]=m),b&&(X["--moveable-control-padding"]=b),ta(h,J({cspNonce:u,ref:Ts(this,"controlBox"),className:"".concat($e("control-box",O===-1?"reverse":"",I?"dragging":"")," ").concat(z," ").concat(a)},k,{onClick:this._onPreventClick,style:X}),this.renderAbles(),this._renderLines())},e.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var t=this.props,r=t.parentMoveable,i=t.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!r&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},e.prototype.componentDidUpdate=function(t){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(t)},e.prototype.componentWillUnmount=function(){var t,r;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(t=this._reiszeObserver)===null||t===void 0||t.disconnect(),(r=this._mutationObserver)===null||r===void 0||r.disconnect();var i=this._viewContainer;i&&this._changeAbleViewClassNames([]),Ku(this,!1),Ku(this,!0);var a=this.events;for(var o in a){var c=a[o];c&&c.destroy()}},e.prototype.getTargets=function(){var t=this.props.target;return t?[t]:[]},e.prototype.getAble=function(t){var r=this.props.ables||[];return Gr(r,function(i){return i.name===t})},e.prototype.getContainer=function(){var t=this.props,r=t.parentMoveable,i=t.wrapperMoveable,a=t.container;return a||i&&i.getContainer()||r&&r.getContainer()||this.controlBox.parentElement},e.prototype.getControlBoxElement=function(){return this.controlBox},e.prototype.getDragElement=function(){return this._dragTarget},e.prototype.isMoveableElement=function(t){var r;return t&&(((r=t.getAttribute)===null||r===void 0?void 0:r.call(t,"class"))||"").indexOf(bS)>-1},e.prototype.dragStart=function(t,r){r===void 0&&(r=t.target);var i=this.targetGesto,a=this.controlGesto;return i&&zS(this)({inputEvent:t},r)?i.isFlag()||i.triggerDragStart(t):a&&this.isMoveableElement(r)&&(a.isFlag()||a.triggerDragStart(t)),this},e.prototype.hitTest=function(t){var r=this.state,i=r.target,a=r.pos1,o=r.pos2,c=r.pos3,u=r.pos4,d=r.targetClientRect;if(!i)return 0;var h;if(Fd(t)){var p=t.getBoundingClientRect();h={left:p.left,top:p.top,width:p.width,height:p.height}}else h=J({width:0,height:0},t);var m=h.left,b=h.top,_=h.width,w=h.height,S=uk([a,o,u,c],d),T=OQ(S,[[m,b],[m+_,b],[m+_,b+w],[m,b+w]]),C=rj(S);return!T||!C?0:Math.min(100,T/C*100)},e.prototype.isInside=function(t,r){var i=this.state,a=i.target,o=i.pos1,c=i.pos2,u=i.pos3,d=i.pos4,h=i.targetClientRect;return a?B_([t,r],uk([o,c,d,u],h)):!1},e.prototype.updateRect=function(t,r,i){i===void 0&&(i=!0);var a=this.props,o=!a.parentPosition&&!a.wrapperMoveable;o&&Ed(!0);var c=a.parentMoveable,u=this.state,d=u.target||a.target,h=this.getContainer(),p=c?c._rootContainer:this._rootContainer,m=rw(this.controlBox,d,h,h,p||h,this._getRequestStyles());if(!d&&this._hasFirstTarget&&a.persistData){var b=Uk(a.persistData);for(var _ in b)m[_]=b[_]}o&&Ed(),this.updateState(m,c?!1:i)},e.prototype.isDragging=function(t){var r,i,a=this.targetGesto,o=this.controlGesto;if(a?.isFlag()){if(!t)return!0;var c=a.getEventData();return!!(!((r=c[t])===null||r===void 0)&&r.isEventStart)}if(o?.isFlag()){if(!t)return!0;var c=o.getEventData();return!!(!((i=c[t])===null||i===void 0)&&i.isEventStart)}return!1},e.prototype.updateTarget=function(t){this.updateRect(t,!0)},e.prototype.getRect=function(){var t=this.state,r=Oi(this.state),i=te(r,4),a=i[0],o=i[1],c=i[2],u=i[3],d=Ni(r),h=t.width,p=t.height,m=d.width,b=d.height,_=d.left,w=d.top,S=[t.left,t.top],T=It(S,t.origin),C=It(S,t.beforeOrigin),R=t.transformOrigin;return{width:m,height:b,left:_,top:w,pos1:a,pos2:o,pos3:c,pos4:u,offsetWidth:h,offsetHeight:p,beforeOrigin:C,origin:T,transformOrigin:R,rotation:this.getRotation()}},e.prototype.getManager=function(){return this},e.prototype.stopDrag=function(t){if(!t||t==="target"){var r=this.targetGesto;r?.isIdle()===!1&&ew(this,!1),r?.stop()}if(!t||t==="control"){var r=this.controlGesto;r?.isIdle()===!1&&ew(this,!0),r?.stop()}},e.prototype.getRotation=function(){var t=this.state,r=t.pos1,i=t.pos2,a=t.direction;return BJ(r,i,a)},e.prototype.request=function(t,r,i){r===void 0&&(r={});var a=this,o=a.props,c=o.parentMoveable||o.wrapperMoveable||a,u=c.props.ables,d=o.groupable,h=Gr(u,function(T){return T.name===t});if(this.isDragging()||!h||!h.request)return{request:function(){return this},requestEnd:function(){return this}};var p=h.request(a),m=i||r.isInstant,b=p.isControl?"controlAbles":"targetAbles",_="".concat(d?"Group":"").concat(p.isControl?"Control":""),w=Ie([],te(c[b]),!1),S={request:function(T){return Oh(a,w,["drag"],_,"",J(J({},p.request(T)),{requestAble:t,isRequest:!0}),m),S},requestEnd:function(){return Oh(a,w,["drag"],_,"End",J(J({},p.requestEnd()),{requestAble:t,isRequest:!0}),m),S}};return Oh(a,w,["drag"],_,"Start",J(J({},p.requestStart(r)),{requestAble:t,isRequest:!0}),m),m?S.request(r).requestEnd():S},e.prototype.getMoveables=function(){return[this]},e.prototype.destroy=function(){this.componentWillUnmount()},e.prototype.updateRenderPoses=function(){var t=this.getState(),r=this.props,i=r.padding,a=t.originalBeforeOrigin,o=t.transformOrigin,c=t.allMatrix,u=t.is3d,d=t.pos1,h=t.pos2,p=t.pos3,m=t.pos4,b=t.left,_=t.top,w=t.isPersisted,S=r.zoom||1;if(!i&&S<=1){t.renderPoses=[d,h,p,m],t.renderLines=[[d,h],[h,m],[m,p],[p,d]];return}var T=r5(i||{}),C=T.left,R=T.top,O=T.bottom,P=T.right,N=u?4:3,A=[];w?A=o:this.controlBox&&r.groupable?A=a:A=It(a,[b,_]);var I=ov(N,Rc(A.map(function(X){return-X}),N),c,Rc(o,N)),k=Si(I,d,[-C,-R],N),z=Si(I,h,[P,-R],N),V=Si(I,p,[-C,O],N),B=Si(I,m,[P,O],N);t.renderPoses=[k,z,V,B],t.renderLines=[[k,z],[z,B],[B,V],[V,k]];{var j=S/2;t.renderLines=[[Si(I,d,[-C-j,-R],N),Si(I,h,[P+j,-R],N)],[Si(I,h,[P,-R-j],N),Si(I,m,[P,O+j],N)],[Si(I,m,[P+j,O],N),Si(I,p,[-C-j,O],N)],[Si(I,p,[-C,O+j],N),Si(I,d,[-C,-R-j],N)]]}},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var t=this.props,r=t.target,i=t.container,a=t.parentMoveable,o=this.state,c=o.target,u=o.container;if(!(!c&&!r)){this.updateAbles();var d=!tw(c,r),h=d||!tw(u,i);if(h){var p=i||this.controlBox;p&&this.unsetAbles(),this.updateState({target:r,container:i}),!a&&p&&this.updateRect("End",!1,!1),this._isPropTargetChanged=d}}},e.prototype.waitToChangeTarget=function(){return new Promise(function(){})},e.prototype.triggerEvent=function(t,r){var i=this.props;if(this._emitter.trigger(t,r),i.parentMoveable&&r.isRequest&&!r.isRequestChild)return i.parentMoveable.triggerEvent(t,r,!0);var a=i[t];return a&&a(r)},e.prototype.useCSS=function(t,r){var i=this.props.customStyledMap,a=t+r;return i[a]||(i[a]=sj(t,r)),i[a]},e.prototype.getState=function(){var t,r=this.props;(r.target||!((t=r.targets)===null||t===void 0)&&t.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,a=r.persistData,o=r.firstRenderState;if(o&&!i)return o;if(!this._hasFirstTarget&&a){var c=Uk(a);if(c)return this.updateState(c,!1),this.state}return this.state.isPersisted=!1,this.state},e.prototype.updateSelectors=function(){},e.prototype.unsetAbles=function(){var t=this;this.targetAbles.forEach(function(r){r.unset&&r.unset(t)})},e.prototype.updateAbles=function(t,r){t===void 0&&(t=this.props.ables),r===void 0&&(r="");var i=this.props,a=i.triggerAblesSimultaneously,o=this.getEnabledAbles(t),c="drag".concat(r,"Start"),u="pinch".concat(r,"Start"),d="drag".concat(r,"ControlStart"),h=Km(o,[c,u],a),p=Km(o,[d],a);this.enabledAbles=o,this.targetAbles=h,this.controlAbles=p},e.prototype.updateState=function(t,r){if(r){if(this.isUnmounted)return;this.setState(t)}else{var i=this.state;for(var a in t)i[a]=t[a]}},e.prototype.getEnabledAbles=function(t){t===void 0&&(t=this.props.ables);var r=this.props;return t.filter(function(i){return i&&(i.always&&r[i.name]!==!1||r[i.name])})},e.prototype.renderAbles=function(){var t=this,r=this.props,i=r.triggerAblesSimultaneously,a={createElement:ta};return this.renderState={},jJ(Jj(Km(this.getEnabledAbles(),["render"],i).map(function(o){var c=o.render;return c(t,a)||[]})).filter(function(o){return o}),function(o){var c=o.key;return c}).map(function(o){return o[0]})},e.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},e.prototype._getRequestStyles=function(){var t=this.getEnabledAbles().reduce(function(r,i){var a,o,c=(o=(a=i.requestStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return Ie(Ie([],te(r),!1),te(c),!1)},Ie([],te(this.props.requestStyles||[]),!1));return t},e.prototype._updateObserver=function(t){this._updateResizeObserver(t),this._updateMutationObserver(t)},e.prototype._updateEvents=function(){var t=this.targetAbles.length,r=this.controlAbles.length,i=this._dragTarget,a=!t&&this.targetGesto||this._isTargetChanged(!0);a&&(Ku(this,!1),this.updateState({gestos:{}})),r||Ku(this,!0),i&&t&&!this.targetGesto&&(this.targetGesto=f5(this,i,"")),!this.controlGesto&&r&&(this.controlGesto=h5(this,"Control"))},e.prototype._updateTargets=function(){var t=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=t.dragArea,this._propTarget=t.target,this._originalDragTarget=t.dragTarget||t.target,this._dragTarget=Ga(this._originalDragTarget,!0)},e.prototype._renderLines=function(){var t=this.props,r=t,i=r.zoom,a=r.hideDefaultLines,o=r.hideChildMoveableDefaultLines,c=r.parentMoveable;if(a||c&&o)return[];var u=this.getState(),d={createElement:ta};return u.renderLines.map(function(h,p){return dp(d,"",h[0],h[1],i,"render-line-".concat(p))})},e.prototype._isTargetChanged=function(t){var r=this.props,i=r.dragTarget||r.target,a=this._prevOriginalDragTarget,o=this._prevDragArea,c=r.dragArea,u=!c&&a!==i,d=(t||c)&&o!==c;return u||d||this._prevPropTarget!=this._propTarget},e.prototype._updateNativeEvents=function(){var t=this,r=this.props,i=r.dragArea?this.areaElement:this.state.target,a=this.events,o=js(a);if(this._isTargetChanged())for(var c in a){var u=a[c];u&&u.destroy(),a[c]=null}if(i){var d=this.enabledAbles;o.forEach(function(h){var p=Km(d,[h]),m=p.length>0,b=a[h];if(!m){b&&(b.destroy(),a[h]=null);return}b||(b=new gee(i,t,h),a[h]=b),b.setAbles(p)})}},e.prototype._checkUpdateRootContainer=function(){var t=this.props.rootContainer;!this._rootContainer&&t&&(this._rootContainer=Ga(t,!0))},e.prototype._checkUpdateViewContainer=function(){var t=this.props.viewContainer;!this._viewContainer&&t&&(this._viewContainer=Ga(t,!0));var r=this._viewContainer;r&&this._changeAbleViewClassNames(Ie(Ie([],te(this._getAbleViewClassNames()),!1),[this.isDragging()?YJ:""],!1))},e.prototype._changeAbleViewClassNames=function(t){var r=this._viewContainer,i=Zj(t.filter(Boolean),function(d){return d}).map(function(d){var h=te(d,1),p=h[0];return p}),a=this._viewClassNames,o=Hp(a,i),c=o.removed,u=o.added;c.forEach(function(d){k3(r,a[d])}),u.forEach(function(d){D3(r,i[d])}),this._viewClassNames=i},e.prototype._getAbleViewClassNames=function(){var t=this;return(this.getEnabledAbles().map(function(r){var i;return((i=r.viewClassName)===null||i===void 0?void 0:i.call(r,t))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},e.prototype._getAbleClassName=function(t){var r=this;t===void 0&&(t="");var i=this.getEnabledAbles(),a=this.targetGesto,o=this.controlGesto,c=a?.isFlag()?a.getEventData():{},u=o?.isFlag()?o.getEventData():{};return i.map(function(d){var h,p,m,b=d.name,_=((h=d.className)===null||h===void 0?void 0:h.call(d,r))||"";return(!((p=c[b])===null||p===void 0)&&p.isEventStart||!((m=u[b])===null||m===void 0)&&m.isEventStart)&&(_+=" ".concat($e("".concat(b).concat(t,"-dragging")))),_.trim()}).filter(Boolean).join(" ")},e.prototype._updateResizeObserver=function(t){var r,i=this.props,a=i.target,o=Yo(this.getControlBoxElement());if(!o.ResizeObserver||!a||!i.useResizeObserver){(r=this._reiszeObserver)===null||r===void 0||r.disconnect();return}if(!(t.target===a&&this._reiszeObserver)){var c=new o.ResizeObserver(this.checkUpdateRect);c.observe(a,{box:"border-box"}),this._reiszeObserver=c}},e.prototype._updateMutationObserver=function(t){var r=this,i,a=this.props,o=a.target,c=Yo(this.getControlBoxElement());if(!c.MutationObserver||!o||!a.useMutationObserver){(i=this._mutationObserver)===null||i===void 0||i.disconnect();return}if(!(t.target===o&&this._mutationObserver)){var u=new c.MutationObserver(function(d){var h,p;try{for(var m=ZQ(d),b=m.next();!b.done;b=m.next()){var _=b.value;_.type==="attributes"&&_.attributeName==="style"&&r.checkUpdateRect()}}catch(w){h={error:w}}finally{try{b&&!b.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}});u.observe(o,{attributes:!0}),this._mutationObserver=u}},e.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:Fj,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},e})(z3),LS={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(n,e){var t,r=n.props,i=r.targets||[],a=n.getState(),o=a.left,c=a.top,u=a.isPersisted,d=r.zoom||1,h=n.renderGroupRects,p=((t=r.persistData)===null||t===void 0?void 0:t.children)||[];u?i=p.map(function(){return null}):p=[];var m=Xu(n,"parentPosition",[o,c],function(_){return _.join(",")}),b=Xu(n,"requestStyles",n.getRequestChildStyles(),function(_){return _.join(",")});return n.moveables=n.moveables.slice(0,i.length),Ie(Ie([],te(i.map(function(_,w){return e.createElement(Ad,{key:"moveable"+w,ref:w3(n,"moveables",w),target:_,origin:!1,requestStyles:b,cssStyled:r.cssStyled,customStyledMap:r.customStyledMap,useResizeObserver:r.useResizeObserver,useMutationObserver:r.useMutationObserver,hideChildMoveableDefaultLines:r.hideChildMoveableDefaultLines,parentMoveable:n,parentPosition:[o,c],persistData:p[w],zoom:d})})),!1),te(Jj(h.map(function(_,w){var S=_.pos1,T=_.pos2,C=_.pos3,R=_.pos4,O=[S,T,C,R];return[[0,1],[1,3],[3,2],[2,0]].map(function(P,N){var A=te(P,2),I=A[0],k=A[1];return dp(e,"",Ke(O[I],m),Ke(O[k],m),d,"group-rect-".concat(w,"-").concat(N))})}))),!1)}},yee=Zp("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(n,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(n,e){var t=n.props.target,r=e.inputEvent,i=e.inputTarget,a=n.isMoveableElement(i),o=!a&&n.controlBox.contains(i);if(!(!r||!i||e.isDrag||n.isMoveableElement(i)||o)){var c=t.contains(i);Oe(n,"onClick",dt(n,e,{isDouble:e.isDouble,inputTarget:i,isTarget:t===i,moveableTarget:n.props.target,containsTarget:c}))}},dragGroupEnd:function(n,e){var t=e.inputEvent,r=e.inputTarget;if(!(!t||!r||e.isDrag||n.isMoveableElement(r)||e.datas.inputTarget===r)){var i=n.props.targets,a=i.indexOf(r),o=a>-1,c=!1;a===-1&&(a=Os(i,function(u){return u.contains(r)}),c=a>-1),Oe(n,"onClickGroup",dt(n,e,{isDouble:e.isDouble,targets:i,inputTarget:r,targetIndex:a,isTarget:o,containsTarget:c,moveableTarget:i[a]}))}},dragControlEnd:function(n,e){this.dragEnd(n,e)},dragGroupControlEnd:function(n,e){this.dragEnd(n,e)}});function Nu(n){var e=n.originalDatas.draggable;return e||(n.originalDatas.draggable={},e=n.originalDatas.draggable),J(J({},n),{datas:e})}var bee=Zp("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(n,e){var t=n.props,r=t.edgeDraggable;return r?wj(e,"edgeDraggable",r,n.getState().renderPoses,t.zoom):[]},dragCondition:function(n,e){var t,r=n.props,i=(t=e.inputEvent)===null||t===void 0?void 0:t.target;return!r.edgeDraggable||!i?!1:!r.draggable&&Hn(i,$e("direction"))&&Hn(i,$e("edge"))&&Hn(i,$e("edgeDraggable"))},dragStart:function(n,e){return Tr.dragStart(n,Nu(e))},drag:function(n,e){return Tr.drag(n,Nu(e))},dragEnd:function(n,e){return Tr.dragEnd(n,Nu(e))},dragGroupCondition:function(n,e){var t,r=n.props,i=(t=e.inputEvent)===null||t===void 0?void 0:t.target;return!r.edgeDraggable||!i?!1:!r.draggable&&Hn(i,$e("direction"))&&Hn(i,$e("line"))},dragGroupStart:function(n,e){return Tr.dragGroupStart(n,Nu(e))},dragGroup:function(n,e){return Tr.dragGroup(n,Nu(e))},dragGroupEnd:function(n,e){return Tr.dragGroupEnd(n,Nu(e))},unset:function(n){return Tr.unset(n)}}),g5={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},BS=[u5,s5,EJ,FJ,Tr,bee,W_,GJ,$J,aJ,WJ,QJ,KJ,cee,lee,hee,LS,g5,yee,a5,d5],xee=BS.reduce(function(n,e){return(e.events||[]).forEach(function(t){R3(n,t)}),n},[]),_ee=BS.reduce(function(n,e){return(e.props||[]).forEach(function(t){R3(n,t)}),n},[]);function Fk(n,e){var t=te(n,3),r=t[0],i=t[1],a=t[2];return(r*e[0]+i*e[1]+a)/Math.sqrt(r*r+i*i)}function Qm(n,e){var t=te(n,2),r=t[0],i=t[1];return-r*e[0]-i*e[1]}function Gk(n,e){return Math.max.apply(Math,Ie([],te(n.map(function(t){var r=te(t,4),i=r[0],a=r[1],o=r[2],c=r[3];return Math.max(i[e],a[e],o[e],c[e])})),!1))}function qk(n,e){return Math.min.apply(Math,Ie([],te(n.map(function(t){var r=te(t,4),i=r[0],a=r[1],o=r[2],c=r[3];return Math.min(i[e],a[e],o[e],c[e])})),!1))}function wee(n,e){var t,r,i,a=[0,0],o=[0,0],c=[0,0],u=[0,0],d=0,h=0;if(!n.length)return{pos1:a,pos2:o,pos3:c,pos4:u,minX:0,minY:0,maxX:0,maxY:0,width:d,height:h,rotation:e};var p=at(e,kr);if(p%90){var m=p/180*Math.PI,b=Math.tan(m),_=-1/b,w=[H_,hk],S=[[0,0],[0,0]],T=[H_,hk],C=[[0,0],[0,0]];n.forEach(function(re){re.forEach(function(Z){var oe=Fk([-b,1,0],Z),fe=Fk([-_,1,0],Z);w[0]>oe&&(S[0]=Z,w[0]=oe),w[1]<oe&&(S[1]=Z,w[1]=oe),T[0]>fe&&(C[0]=Z,T[0]=fe),T[1]<fe&&(C[1]=Z,T[1]=fe)})});var R=te(S,2),O=R[0],P=R[1],N=te(C,2),A=N[0],I=N[1],k=[-b,1,Qm([-b,1],O)],z=[-b,1,Qm([-b,1],P)],V=[-_,1,Qm([-_,1],A)],B=[-_,1,Qm([-_,1],I)];t=te([[k,V],[k,B],[z,V],[z,B]].map(function(re){var Z=te(re,2),oe=Z[0],fe=Z[1];return vS(oe,fe)[0]}),4),a=t[0],o=t[1],c=t[2],u=t[3],d=T[1]-T[0],h=w[1]-w[0]}else{var j=qk(n,0),X=qk(n,1),H=Gk(n,0),$=Gk(n,1);if(a=[j,X],o=[H,X],c=[j,$],u=[H,$],d=H-j,h=$-X,p%180){var W=[c,a,u,o];r=te(W,4),a=r[0],o=r[1],c=r[2],u=r[3],d=$-X,h=H-j}}if(p%360>180){var W=[u,c,o,a];i=te(W,4),a=i[0],o=i[1],c=i[2],u=i[3]}var ee=Dc([a,o,c,u]),he=ee.minX,K=ee.minY,G=ee.maxX,Y=ee.maxY;return{pos1:a,pos2:o,pos3:c,pos4:u,width:d,height:h,minX:he,minY:K,maxX:G,maxY:Y,rotation:e}}function m5(n,e){var t=e.map(function(r){if(Fn(r)){var i=m5(n,r),a=i.length;return a>1?i:a===1?i[0]:null}else{var o=Gr(n,function(c){var u=c.manager;return u.props.target===r});return o?(o.finded=!0,o.manager):null}}).filter(Boolean);return t.length===1&&Fn(t[0])?t[0]:t}var Eee=(function(n){Qp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.differ=new nj,t.moveables=[],t.transformOrigin="50% 50%",t.renderGroupRects=[],t._targetGroups=[],t._hasFirstTargets=!1,t}return e.prototype.componentDidMount=function(){n.prototype.componentDidMount.call(this)},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(t,r,i){var a;i===void 0&&(i=!0);var o=this.state;if(!this.controlBox||o.isPersisted)return;Ed(!0),this.moveables.forEach(function(Ce){Ce.updateRect(t,!1,!1)});var c=this.props,u=this.moveables,d=o.target||c.target,h=u.map(function(Ce){return{finded:!1,manager:Ce}}),p=this.props.targetGroups||[],m=m5(h,p),b=c.useDefaultGroupRotate;m.push.apply(m,Ie([],te(h.filter(function(Ce){var we=Ce.finded;return!we}).map(function(Ce){var we=Ce.manager;return we})),!1));var _=[],w=!r||t!==""&&c.updateGroup,S=c.defaultGroupRotate||0;if(!this._hasFirstTargets){var T=(a=c.persistData)===null||a===void 0?void 0:a.rotation;T!=null&&(S=T)}function C(Ce,we,Pe){var ue=Ce.map(function(Le){if(Fn(Le)){var Me=C(Le,we),Be=[Me.pos1,Me.pos2,Me.pos3,Me.pos4];return _.push(Me),{poses:Be,rotation:Me.rotation}}else return{poses:Oi(Le.state),rotation:Le.getRotation()}}),_e=ue.map(function(Le){var Me=Le.rotation;return Me}),ze=0,Ne=_e[0],qe=_e.every(function(Le){return Math.abs(Ne-Le)<.1});w?ze=!b&&qe?Ne:S:ze=!b&&!Pe&&qe?Ne:we;var Fe=ue.map(function(Le){var Me=Le.poses;return Me}),Te=wee(Fe,ze);return Te}var R=C(m,this.rotation,!0);w&&(this.rotation=R.rotation,this.transformOrigin=c.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=p,this.renderGroupRects=_;var O=this.transformOrigin,P=this.rotation,N=this.scale,A=R.width,I=R.height,k=R.minX,z=R.minY,V=UJ([[0,0],[A,0],[0,I],[A,I]],OS(O,A,I),this.rotation/180*Math.PI),B=Dc(V.result),j=B.minX,X=B.minY,H=" rotate(".concat(P,"deg)")+" scale(".concat(Ar(N[0]),", ").concat(Ar(N[1]),")"),$="translate(".concat(-j,"px, ").concat(-X,"px)").concat(H);this.controlBox.style.transform="translate3d(".concat(k,"px, ").concat(z,"px, ").concat(this.props.translateZ||0,")"),d.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(O,";")+"width:".concat(A,"px;height:").concat(I,"px;")+"transform: ".concat($),o.width=A,o.height=I;var W=this.getContainer(),ee=rw(this.controlBox,d,this.controlBox,this.getContainer(),this._rootContainer||W,[]),he=[ee.left,ee.top],K=te(Oi(ee),4),G=K[0],Y=K[1],re=K[2],Z=K[3],oe=Dc([G,Y,re,Z]),fe=[oe.minX,oe.minY],be=Ar(N[0]*N[1]);ee.pos1=Ke(G,fe),ee.pos2=Ke(Y,fe),ee.pos3=Ke(re,fe),ee.pos4=Ke(Z,fe),ee.left=k-ee.left+fe[0],ee.top=z-ee.top+fe[1],ee.origin=Ke(It(he,ee.origin),fe),ee.beforeOrigin=Ke(It(he,ee.beforeOrigin),fe),ee.originalBeforeOrigin=It(he,ee.originalBeforeOrigin),ee.transformOrigin=Ke(It(he,ee.transformOrigin),fe),d.style.transform="translate(".concat(-j-fe[0],"px, ").concat(-X-fe[1],"px)")+H,Ed(),this.updateState(J(J({},ee),{posDelta:fe,direction:be,beforeDirection:be}),i)},e.prototype.getRect=function(){return J(J({},n.prototype.getRect.call(this)),{children:this.moveables.map(function(t){return t.getRect()})})},e.prototype.triggerEvent=function(t,r,i){if(i||t.indexOf("Group")>-1)return n.prototype.triggerEvent.call(this,t,r);this._emitter.trigger(t,r)},e.prototype.getRequestChildStyles=function(){var t=this.getEnabledAbles().reduce(function(r,i){var a,o,c=(o=(a=i.requestChildStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return Ie(Ie([],te(r),!1),te(c),!1)},[]);return t},e.prototype.getMoveables=function(){return Ie([],te(this.moveables),!1)},e.prototype.updateAbles=function(){n.prototype.updateAbles.call(this,Ie(Ie([],te(this.props.ables),!1),[LS],!1),"Group")},e.prototype._updateTargets=function(){n.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=Ga(this._originalDragTarget,!0)},e.prototype._updateEvents=function(){var t=this.state,r=this.props,i=this._prevDragTarget,a=r.dragTarget||this.areaElement,o=r.targets,c=this.differ.update(o),u=c.added,d=c.changed,h=c.removed,p=u.length||h.length;(p||this._prevOriginalDragTarget!==this._originalDragTarget)&&(Ku(this,!1),Ku(this,!0),this.updateState({gestos:{}})),i!==a&&(t.target=null),t.target||(t.target=this.areaElement,this.controlBox.style.display="block"),t.target&&(this.targetGesto||(this.targetGesto=f5(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=h5(this,"GroupControl")));var m=!tw(t.container,r.container);m&&(t.container=r.container),(m||p||this.transformOrigin!==(r.defaultGroupOrigin||"50% 50%")||d.length||o.length&&!n5(this._targetGroups,r.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!p},e.prototype._updateObserver=function(){},e.defaultProps=J(J({},Ad.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e})(Ad),See=(function(n){Qp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.moveables=[],t}return e.prototype.render=function(){var t=this,r,i=this.props,a=i.cspNonce,o=i.cssStyled,c=i.persistData,u=i.targets||[],d=u.length,h=this.isUnmounted||!d,p=(r=c?.children)!==null&&r!==void 0?r:[];return h&&!d&&p.length?u=p.map(function(){return null}):h||(p=[]),ta(o,{cspNonce:a,ref:Ts(this,"controlBox"),className:$e("control-box")},u.map(function(m,b){var _,w,S=(w=(_=i.individualGroupableProps)===null||_===void 0?void 0:_.call(i,m,b))!==null&&w!==void 0?w:{};return ta(Ad,J({key:"moveable"+b,ref:w3(t,"moveables",b)},i,S,{target:m,wrapperMoveable:t,isWrapperMounted:t.isMoveableMounted,persistData:p[b]}))}))},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(t,r,i){i===void 0&&(i=!0),Ed(!0),this.moveables.forEach(function(a){a.updateRect(t,r,i)}),Ed()},e.prototype.getRect=function(){return J(J({},n.prototype.getRect.call(this)),{children:this.moveables.map(function(t){return t.getRect()})})},e.prototype.request=function(t,r,i){r===void 0&&(r={});var a=this.moveables.map(function(u){return u.request(t,J(J({},r),{isInstant:!1}),!1)}),o=i||r.isInstant,c={request:function(u){return a.forEach(function(d){return d.request(u)}),this},requestEnd:function(){return a.forEach(function(u){return u.requestEnd()}),this}};return o?c.request(r).requestEnd():c},e.prototype.dragStart=function(t,r){r===void 0&&(r=t.target);var i=r,a=Gr(this.moveables,function(o){var c=o.getTargets()[0],u=o.getControlBoxElement(),d=o.getDragElement();return!c||!d?!1:d===i||d.contains(i)||d!==c&&c===i||c.contains(i)||u===i||u.contains(i)});return a&&a.dragStart(t,r),this},e.prototype.hitTest=function(){return 0},e.prototype.isInside=function(){return!1},e.prototype.isDragging=function(){return!1},e.prototype.getDragElement=function(){return null},e.prototype.getMoveables=function(){return Ie([],te(this.moveables),!1)},e.prototype.updateRenderPoses=function(){},e.prototype.checkUpdate=function(){},e.prototype.triggerEvent=function(){},e.prototype.updateAbles=function(){},e.prototype._updateEvents=function(){},e.prototype._updateObserver=function(){},e})(Ad);function v5(n,e){var t=[];return n.forEach(function(r){if(r){if(Fr(r)){e[r]&&t.push.apply(t,Ie([],te(e[r]),!1));return}Fn(r)?t.push.apply(t,Ie([],te(v5(r,e)),!1)):t.push(r)}}),t}function y5(n,e){var t=[];return n.forEach(function(r){if(r){if(Fr(r)){e[r]&&t.push.apply(t,Ie([],te(e[r]),!1));return}Fn(r)?t.push(y5(r,e)):t.push(r)}}),t}function b5(n,e){return n.length!==e.length||n.some(function(t,r){var i=e[r];return!t&&!i?!1:t!=i?Fn(t)&&Fn(i)?b5(t,i):!0:!1})}var Tee=(function(n){Qp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.refTargets=[],t.selectorMap={},t._differ=new nj,t._elementTargets=[],t._tmpRefTargets=[],t._tmpSelectorMap={},t._onChangeTargets=null,t}return e.makeStyled=function(){var t={},r=this.getTotalAbles();r.forEach(function(a){var o=a.css;o&&o.forEach(function(c){t[c]=!0})});var i=js(t).join(`
`);this.defaultStyled=sj("div",xW(bS,cZ+i))},e.getTotalAbles=function(){return Ie([s5,LS,g5,a5],te(this.defaultAbles),!1)},e.prototype.render=function(){var t,r=this.constructor;r.defaultStyled||r.makeStyled();var i=this.props,a=i.ables,o=i.props,c=WQ(i,["ables","props"]),u=te(this._updateRefs(!0),2),d=u[0],h=u[1],p=v5(d,h),m=p.length>1,b=r.getTotalAbles(),_=Ie(Ie([],te(b),!1),te(a||[]),!1),w=J(J(J({},c),o||{}),{ables:_,cssStyled:r.defaultStyled,customStyledMap:r.customStyledMap});this._elementTargets=p;var S=null,T=this.moveable,C=c.persistData;if(C?.children&&(m=!0),c.individualGroupable)return ta(See,J({key:"individual-group",ref:Ts(this,"moveable")},w,{target:null,targets:p}));if(m){var R=y5(d,h);if(T&&!T.props.groupable&&!T.props.individualGroupable){var O=T.props.target;O&&p.indexOf(O)>-1&&(S=J({},T.state))}return ta(Eee,J({key:"group",ref:Ts(this,"moveable")},w,(t=c.groupableProps)!==null&&t!==void 0?t:{},{target:null,targets:p,targetGroups:R,firstRenderState:S}))}else{var P=p[0];if(T&&(T.props.groupable||T.props.individualGroupable)){var N=T.moveables||[],A=Gr(N,function(I){return I.props.target===P});A&&(S=J({},A.state))}return ta(Ad,J({key:"single",ref:Ts(this,"moveable")},w,{target:P,firstRenderState:S}))}},e.prototype.componentDidMount=function(){this._checkChangeTargets()},e.prototype.componentDidUpdate=function(){this._checkChangeTargets()},e.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},e.prototype.getTargets=function(){var t,r;return(r=(t=this.moveable)===null||t===void 0?void 0:t.getTargets())!==null&&r!==void 0?r:[]},e.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs(),this.forceUpdate()},e.prototype.waitToChangeTarget=function(){var t=this,r;return this._onChangeTargets=function(){t._onChangeTargets=null,r()},new Promise(function(i){r=i})},e.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},e.prototype.getManager=function(){return this.moveable},e.prototype.getMoveables=function(){return this.moveable.getMoveables()},e.prototype.getDragElement=function(){return this.moveable.getDragElement()},e.prototype._updateRefs=function(t){var r=this.refTargets,i=PS(this.props.target||this.props.targets),a=typeof document<"u",o=b5(r,i),c=this.selectorMap,u={};return this.refTargets.forEach(function d(h){if(Fr(h)){var p=c[h];p?u[h]=c[h]:a&&(o=!0,u[h]=[].slice.call(document.querySelectorAll(h)))}else Fn(h)&&h.forEach(d)}),this._tmpRefTargets=i,this._tmpSelectorMap=u,[i,u,!t&&o]},e.prototype._checkChangeTargets=function(){var t,r,i;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var a=this._differ.update(this._elementTargets),o=a.added,c=a.removed,u=o.length||c.length;u&&((r=(t=this.props).onChangeTargets)===null||r===void 0||r.call(t,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this));var d=te(this._updateRefs(),3),h=d[0],p=d[1],m=d[2];this.refTargets=h,this.selectorMap=p,m&&this.forceUpdate()},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,QQ([_W(fj)],e.prototype,"moveable",void 0),e})(z3),Aee=(function(n){Qp(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.defaultAbles=BS,e})(Tee),iw=function(n,e){return iw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},iw(n,e)};function US(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");iw(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var hp=function(){return hp=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},hp.apply(this,arguments)};function Cee(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}var Iee=(function(n){US(e,n);function e(r){var i=n.call(this,r)||this;return i.state={},i.state=i.props,i}var t=e.prototype;return t.render=function(){return ta(Aee,hp({ref:Ts(this,"moveable")},this.state))},e})(dS),Ree=_ee,Dee=fj,kee=xee,Nee=(function(n){US(e,n);function e(r,i){i===void 0&&(i={});var a=n.call(this)||this;a.containerProvider=null,a.selfElement=null,a._warp=!1;var o=hp({},i),c={};kee.forEach(function(h){c[kW("on ".concat(h))]=function(p){return a.trigger(h,p)}});var u;i.warpSelf?(delete i.warpSelf,a._warp=!0,u=r):(u=Ud(r).createElement("div"),r.appendChild(u)),a.containerProvider=ok(ta(Iee,hp({ref:Ts(a,"innerMoveable")},o,c)),u),a.selfElement=u;var d=o.target;return Fn(d)&&d.length>1&&a.updateRect(),a}var t=e.prototype;return t.setState=function(r,i){this.innerMoveable.setState(r,i)},t.forceUpdate=function(r){this.innerMoveable.forceUpdate(r)},t.dragStart=function(r,i){i===void 0&&(i=r.target);var a=this.innerMoveable;a.$_timer&&this.forceUpdate(),this.getMoveable().dragStart(r,i)},t.destroy=function(){var r,i=this.selfElement;ok(null,i,this.containerProvider),this._warp||(r=i?.parentElement)===null||r===void 0||r.removeChild(i),this.containerProvider=null,this.off(),this.selfElement=null,this.innerMoveable=null},t.getMoveable=function(){return this.innerMoveable.moveable},e=Cee([ZD(Dee,function(r,i){r[i]||(r[i]=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];var c=this.getMoveable();if(!(!c||!c[i]))return c[i].apply(c,a)})}),ZD(Ree,function(r,i){Object.defineProperty(r,i,{get:function(){return this.getMoveable().props[i]},set:function(a){var o;this.setState((o={},o[i]=a,o))},enumerable:!0,configurable:!0})})],e),e})(sy),Mee=(function(n){US(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e})(Nee),sc=(n=>(n.Mouse="mouse",n.Touch="touch",n.Pointer="pointer",n))(sc||{}),ph=(n=>(n.CancelledByMovement="cancelled-by-movement",n.CancelledByRelease="cancelled-by-release",n.CancelledOutsideElement="cancelled-outside-element",n))(ph||{});const Pee=["mousedown","mousemove","mouseup","mouseleave","mouseout"],Oee=["touchstart","touchmove","touchend","touchcancel"],jee=["pointerdown","pointermove","pointerup","pointerleave","pointerout"];function Vee(n){return typeof n=="object"&&n!==null&&"pageX"in n&&typeof n.pageX=="number"&&"pageY"in n&&typeof n.pageY=="number"}function zee(n){var e;return Pee.includes((e=n?.nativeEvent)==null?void 0:e.type)}function x5(n){var e;return Oee.includes((e=n?.nativeEvent)==null?void 0:e.type)||"touches"in n}function Lee(n){const{nativeEvent:e}=n;return e?jee.includes(e?.type)||"pointerId"in e:!1}function y1(n){return zee(n)||x5(n)||Lee(n)}function $k(n){var e;const t=x5(n)?(e=n?.touches)==null?void 0:e[0]:n;return Vee(t)?{x:t.pageX,y:t.pageY}:null}function Bee(n){return{target:n.target,currentTarget:n.currentTarget,nativeEvent:n,persist:()=>{}}}function _5(n,{threshold:e=400,captureEvent:t=!1,detect:r=sc.Pointer,cancelOnMovement:i=!1,cancelOutsideElement:a=!0,filterEvents:o,onStart:c,onMove:u,onFinish:d,onCancel:h}={}){const p=U.useRef(!1),m=U.useRef(!1),b=U.useRef(),_=U.useRef(),w=U.useRef(n),S=U.useRef(null),T=U.useCallback(P=>N=>{m.current||y1(N)&&(o!==void 0&&!o(N)||(t&&N.persist(),c?.(N,{context:P}),S.current=$k(N),m.current=!0,b.current=N.currentTarget,_.current=setTimeout(()=>{w.current&&(w.current(N,{context:P}),p.current=!0)},e)))},[t,o,c,e]),C=U.useCallback(P=>(N,A)=>{y1(N)&&m.current&&(S.current=null,t&&N.persist(),p.current?d?.(N,{context:P}):m.current&&h?.(N,{context:P,reason:A??ph.CancelledByRelease}),p.current=!1,m.current=!1,_.current!==void 0&&clearTimeout(_.current))},[t,d,h]),R=U.useCallback(P=>N=>{if(y1(N)&&(u?.(N,{context:P}),i!==!1&&S.current)){const A=$k(N);if(A){const I=i===!0?25:i,k={x:Math.abs(A.x-S.current.x),y:Math.abs(A.y-S.current.y)};(k.x>I||k.y>I)&&C(P)(N,ph.CancelledByMovement)}}},[C,i,u]),O=U.useCallback(P=>{if(n===null)return{};switch(r){case sc.Mouse:{const N={onMouseDown:T(P),onMouseMove:R(P),onMouseUp:C(P)};return a&&(N.onMouseLeave=A=>{C(P)(A,ph.CancelledOutsideElement)}),N}case sc.Touch:return{onTouchStart:T(P),onTouchMove:R(P),onTouchEnd:C(P)};case sc.Pointer:{const N={onPointerDown:T(P),onPointerMove:R(P),onPointerUp:C(P)};return a&&(N.onPointerLeave=A=>C(P)(A,ph.CancelledOutsideElement)),N}}},[n,C,a,r,R,T]);return U.useEffect(()=>{function P(N){const A=Bee(N);C()(A)}return window.addEventListener("mouseup",P),window.addEventListener("touchend",P),window.addEventListener("pointerup",P),()=>{window.removeEventListener("mouseup",P),window.removeEventListener("touchend",P),window.removeEventListener("pointerup",P)}},[C]),U.useEffect(()=>()=>{_.current!==void 0&&clearTimeout(_.current)},[]),U.useEffect(()=>{w.current=n},[n]),O}const w5=()=>{if(/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream){const e=document.getElementById("ios-haptic-trigger");e&&e.click()}else typeof navigator<"u"&&navigator.vibrate&&navigator.vibrate(50)},vv=n=>n?n instanceof Date?n:typeof n=="string"?new Date(n):typeof n=="number"?new Date(n):n?.toDate&&typeof n.toDate=="function"?n.toDate():new Date:new Date,Yl=n=>vv(n).toISOString(),Uee=n=>{const e=vv(n);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`},Fee=n=>{const e=n.toLowerCase();return e==="income"?"Income":e==="expense"?"Expense":e==="transfer"?"Transfer":"Expense"},FS=n=>{const e=n;let t=0;typeof e.amount=="number"?t=e.amount:typeof e.amount=="string"&&(t=parseFloat(e.amount)),isNaN(t)&&(t=0);const r=Yl(e.date);return{id:e.id||"",userId:e.userId||"",envelopeId:e.envelopeId||"",amount:t,date:r,month:e.month||Uee(r),description:e.description||"",merchant:e.merchant||void 0,type:Fee(e.type||"expense"),reconciled:e.reconciled??!1,transferId:e.transferId||void 0,isAutomatic:e.isAutomatic||void 0,paymentMethod:e.paymentMethod?typeof e.paymentMethod=="string"?{id:e.paymentMethod,name:e.paymentMethod,network:"Visa",last4:"****",color:"#000000"}:e.paymentMethod:void 0}};class oc{static instance;static getInstance(){return oc.instance||(oc.instance=new oc),oc.instance}async restoreUserData(e,t){try{console.log(" BudgetService.restoreUserData: STARTING RESTORE for user:",e),await this.deleteAllUserData(e);const r=[{name:"envelopes",data:t.envelopes||[]},{name:"transactions",data:t.transactions||[]},{name:"envelopeAllocations",data:t.allocations?Object.values(t.allocations).flat():[]},{name:"monthlyBudgets",data:this.prepareMonthlyBudgetsData(t.allocations,t.incomeSources)},{name:"appSettings",data:t.appSettings?[t.appSettings]:[]}],i=[];for(const{name:o,data:c}of r)if(Array.isArray(c))for(const u of c){if(!u.id&&o!=="monthlyBudgets")continue;const d={...u,userId:e};let h=u.id;o==="monthlyBudgets"&&u.month&&(h=u.month);const p=St(tt,"users",e,o,h);i.push({ref:p,data:d})}console.log(` Prepared ${i.length} items for restoration.`);const a=450;for(let o=0;o<i.length;o+=a){const c=LO(tt);i.slice(o,o+a).forEach(d=>{c.set(d.ref,d.data)}),console.log(` Committing batch ${Math.floor(o/a)+1}/${Math.ceil(i.length/a)}...`),await c.commit()}console.log(" Restore completed successfully.")}catch(r){throw console.error(" BudgetService.restoreUserData failed:",r),new Error(`Failed to restore user data: ${r instanceof Error?r.message:"Unknown error"}`)}}async getEnvelopes(e){try{console.log(" BudgetService.getEnvelopes called for user:",e);const t=Sr(tt,"users",e,"envelopes"),a=(await Qi(t)).docs.map((o,c)=>({id:o.id,...o.data(),orderIndex:o.data().orderIndex??c})).sort((o,c)=>{const u=o.orderIndex??0,d=c.orderIndex??0;return u-d});return console.log(" Fetched envelopes:",a.length),a}catch(t){throw console.error(" BudgetService.getEnvelopes failed:",t),new Error(`Failed to fetch envelopes: ${t instanceof Error?t.message:"Unknown error"}`)}}async getTransactions(e){try{console.log(" BudgetService.getTransactions: Fetching for user",e);const t=Sr(tt,"users",e,"transactions"),r=sa(t,Jo("date","desc")),a=(await Qi(r)).docs.map(o=>{const c={id:o.id,...o.data()};return FS(c)});return console.log(` Fetched ${a.length} transactions`),a}catch(t){throw console.error(" BudgetService.getTransactions failed:",t),new Error(`Failed to fetch transactions: ${t instanceof Error?t.message:"Unknown error"}`)}}async createEnvelope(e){try{console.log(" BudgetService.createEnvelope called for user:",e.userId);const t=Sr(tt,"users",e.userId,"envelopes"),r=St(t),i=pt.now(),a={...e,createdAt:i,lastUpdated:i};ai(r,a).catch(c=>console.error("Create env failed",c));const o={...e,id:r.id,createdAt:Yl(i),lastUpdated:Yl(i)};return console.log(" Created envelope (optimistic):",o.id),o}catch(t){throw console.error(" BudgetService.createEnvelope failed:",t),new Error(`Failed to create envelope: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateEnvelope(e,t){try{console.log(" BudgetService.updateEnvelope called for envelope:",t.id);const r=St(tt,"users",e,"envelopes",t.id);ai(r,{...t,lastUpdated:pt.now()},{merge:!0}).catch(i=>console.error("Update env failed",i)),console.log(" Updated envelope (optimistic):",t.id)}catch(r){throw console.error(" BudgetService.updateEnvelope failed:",r),new Error(`Failed to update envelope: ${r instanceof Error?r.message:"Unknown error"}`)}}async deleteEnvelope(e,t){try{const r=St(tt,"users",e,"envelopes",t),i=sa(Sr(tt,"users",e,"transactions"),S$("envelopeId","==",t)),o=(await Qi(i)).docs.map(c=>Zi(c.ref));await Promise.all([Zi(r),...o]),console.log(" Deleted envelope and associated transactions from Firestore:",t)}catch(r){throw console.error(" BudgetService.deleteEnvelope failed:",r),new Error(`Failed to delete envelope: ${r instanceof Error?r.message:"Unknown error"}`)}}async reorderEnvelopes(e,t){try{console.log(" BudgetService.reorderEnvelopes called for user:",e);const r=t.map(i=>{const a=St(tt,"users",e,"envelopes",i.id);return ai(a,{orderIndex:i.orderIndex,lastUpdated:pt.now()},{merge:!0})});Promise.all(r).catch(i=>console.error("Reorder env failed",i)),console.log(" Reordered envelopes (optimistic)")}catch(r){throw console.error(" BudgetService.reorderEnvelopes failed:",r),new Error(`Failed to reorder envelopes: ${r instanceof Error?r.message:"Unknown error"}`)}}async createTransaction(e){try{console.log(" BudgetService.createTransaction called for user:",e.userId);const t=Sr(tt,"users",e.userId,"transactions"),r=St(t),i=pt.now();if(e.paymentMethod){const u={...e.paymentMethod};u.last4===void 0&&delete u.last4,e.paymentMethod=u}const o={...Object.fromEntries(Object.entries(e).filter(([u,d])=>d!==void 0)),createdAt:i};ai(r,o).catch(u=>console.error("Create tx failed",u));const c={...e,id:r.id};return console.log(" Created transaction (optimistic):",c.id),c}catch(t){throw console.error(" BudgetService.createTransaction failed:",t),new Error(`Failed to create transaction: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateTransaction(e,t){try{if(console.log(" BudgetService.updateTransaction called for transaction:",t.id),t.paymentMethod){const a={...t.paymentMethod};a.last4===void 0&&delete a.last4,t.paymentMethod=a}const r=Object.fromEntries(Object.entries(t).filter(([a,o])=>o!==void 0)),i=St(tt,"users",e,"transactions",t.id);ai(i,r,{merge:!0}).catch(a=>console.error("Update tx failed",a)),console.log(" Updated transaction (optimistic):",t.id)}catch(r){throw console.error(" BudgetService.updateTransaction failed:",r),new Error(`Failed to update transaction: ${r instanceof Error?r.message:"Unknown error"}`)}}async deleteTransaction(e,t){try{console.log(" BudgetService.deleteTransaction called for transaction:",t);const r=St(tt,"users",e,"transactions",t);Zi(r).catch(i=>console.error("Delete tx failed",i)),console.log(" Deleted transaction (optimistic):",t)}catch(r){throw console.error(" BudgetService.deleteTransaction failed:",r),new Error(`Failed to delete transaction: ${r instanceof Error?r.message:"Unknown error"}`)}}async createIncomeSource(e){try{console.log(" BudgetService.createIncomeSource (Embedded) called for user:",e.userId);const t=St(tt,"users",e.userId,"monthlyBudgets",e.month),r=pt.now(),i=`inc_${r.toMillis()}_${Math.random().toString(36).substring(2,9)}`,a={...e,id:i,amount:Number(e.amount),createdAt:r,updatedAt:r};ka(t,{incomeSources:I$(a),updatedAt:r}).catch(c=>{c.code==="not-found"?ai(t,{id:`${e.userId}_${e.month}`,userId:e.userId,month:e.month,createdAt:r,updatedAt:r,incomeSources:[a],allocations:{},totalIncome:0,availableToBudget:0}).catch(u=>console.error("Failed to create monthly budget doc",u)):console.error("Create income failed",c)});const o={...e,id:i,amount:Number(e.amount),createdAt:Yl(r),updatedAt:Yl(r)};return console.log(" Created income source (optimistic/embedded):",o.id),o}catch(t){throw console.error(" BudgetService.createIncomeSource failed:",t),new Error(`Failed to create income source: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateIncomeSource(e,t,r,i){try{console.log(" BudgetService.updateIncomeSource (Embedded) called for source:",t);const a=St(tt,"users",e,"monthlyBudgets",r);Bx(a).then(o=>{if(!o.exists())return;const d=(o.data().incomeSources||[]).map(h=>{if(h.id===t){const p={...h,...i,updatedAt:pt.now()};return i.amount!==void 0&&(p.amount=Number(i.amount)),p}return h});ka(a,{incomeSources:d,updatedAt:pt.now()})}).catch(o=>console.error("Update income failed",o)),console.log(" Updated income source (optimistic/embedded):",t)}catch(a){throw console.error(" BudgetService.updateIncomeSource failed:",a),a}}async deleteIncomeSource(e,t,r){try{console.log(" BudgetService.deleteIncomeSource (Embedded) called for source:",t);const i=St(tt,"users",e,"monthlyBudgets",r);Bx(i).then(a=>{if(!a.exists())return;const u=(a.data().incomeSources||[]).filter(d=>d.id!==t);ka(i,{incomeSources:u,updatedAt:pt.now()})}).catch(a=>console.error("Delete income failed",a)),console.log(" Deleted income source (optimistic/embedded):",t)}catch(i){throw console.error(" BudgetService.deleteIncomeSource failed:",i),new Error(`Failed to delete income source: ${i instanceof Error?i.message:"Unknown error"}`)}}async createEnvelopeAllocation(e){try{console.log(" BudgetService.createEnvelopeAllocation (Embedded) called for user:",e.userId);const t=St(tt,"users",e.userId,"monthlyBudgets",e.month),r=pt.now(),i={[`allocations.${e.envelopeId}`]:Number(e.budgetedAmount),updatedAt:r};ka(t,i).catch(o=>{o.code==="not-found"?ai(t,{id:`${e.userId}_${e.month}`,userId:e.userId,month:e.month,createdAt:r,updatedAt:r,incomeSources:[],allocations:{[e.envelopeId]:Number(e.budgetedAmount)},totalIncome:0,availableToBudget:0}).catch(c=>console.error("Failed to create monthly budget doc",c)):console.error("Create allocation failed",o)});const a={...e,id:e.envelopeId,createdAt:Yl(r),updatedAt:Yl(r)};return console.log(" Created allocation (optimistic/embedded):",a.id),a}catch(t){throw console.error(" BudgetService.createEnvelopeAllocation failed:",t),new Error(`Failed to create envelope allocation: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateEnvelopeAllocation(e,t,r,i){try{console.log(" BudgetService.updateEnvelopeAllocation (Embedded) called for envelope:",t);const a=St(tt,"users",e,"monthlyBudgets",r),o={updatedAt:pt.now()};i.budgetedAmount!==void 0&&(o[`allocations.${t}`]=Number(i.budgetedAmount)),ka(a,o).catch(c=>console.error("Update allocation failed",c)),console.log(" Updated allocation (optimistic/embedded):",t)}catch(a){throw console.error(" BudgetService.updateEnvelopeAllocation failed:",a),new Error(`Failed to update envelope allocation: ${a instanceof Error?a.message:"Unknown error"}`)}}async deleteEnvelopeAllocation(e,t,r){try{console.log(" BudgetService.deleteEnvelopeAllocation (Embedded) called for envelope:",t);const i=St(tt,"users",e,"monthlyBudgets",r);ka(i,{[`allocations.${t}`]:VR(),updatedAt:pt.now()}).catch(a=>console.error("Delete allocation failed",a)),console.log(" Deleted allocation (optimistic/embedded):",t)}catch(i){throw console.error(" BudgetService.deleteEnvelopeAllocation failed:",i),new Error(`Failed to delete envelope allocation: ${i instanceof Error?i.message:"Unknown error"}`)}}async getMonthData(e,t){try{console.log(` BudgetService.getMonthData (Embedded): Fetching for user ${e}, month ${t}`);const r=St(tt,"users",e,"monthlyBudgets",t),i=await Bx(r);if(!i.exists())return console.log(` No budget data found for ${t}, returning empty defaults.`),{incomeSources:[],allocations:[]};const a=i.data(),o=(a.incomeSources||[]).map(d=>({...d,amount:Number(d.amount),createdAt:d.createdAt?.toDate?d.createdAt.toDate().toISOString():d.createdAt||new Date().toISOString(),updatedAt:d.updatedAt?.toDate?d.updatedAt.toDate().toISOString():d.updatedAt||new Date().toISOString()})).sort((d,h)=>new Date(d.createdAt).getTime()-new Date(h.createdAt).getTime()),c=a.allocations||{},u=Object.entries(c).map(([d,h])=>({id:d,userId:e,envelopeId:d,month:t,budgetedAmount:Number(h),createdAt:a.createdAt?.toDate?a.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:a.updatedAt?.toDate?a.updatedAt.toDate().toISOString():new Date().toISOString()})).sort((d,h)=>new Date(d.createdAt).getTime()-new Date(h.createdAt).getTime());return console.log(` Fetched ${o.length} income sources and ${u.length} allocations for ${t}`),{incomeSources:o,allocations:u}}catch(r){throw console.error(" BudgetService.getMonthData failed:",r),new Error(`Failed to fetch month data: ${r instanceof Error?r.message:"Unknown error"}`)}}async cleanupOrphanedData(e){try{console.log(" BudgetService.cleanupOrphanedData: Starting cleanup for user:",e);const t={orphanedAllocationsDeleted:0,orphanedTransactionsDeleted:0,details:{deletedAllocationIds:[],deletedTransactionIds:[],monthsProcessed:[]}},r=await this.getEnvelopes(e),i=new Set(r.map(b=>b.id));console.log(` Found ${r.length} existing envelopes`);const a=Sr(tt,"users",e,"envelopeAllocations"),o=await Qi(a),c=[],u=new Set;for(const b of o.docs){const _=b.data();u.add(_.month),i.has(_.envelopeId)||(c.push(b.id),console.log(` Found orphaned allocation: ${b.id} for envelope ${_.envelopeId} in month ${_.month}`))}if(c.length>0){const b=c.map(_=>Zi(St(tt,"users",e,"envelopeAllocations",_)));await Promise.all(b),t.orphanedAllocationsDeleted+=c.length,t.details.deletedAllocationIds.push(...c),console.log(` Deleted ${c.length} orphaned allocations (legacy)`)}const d=Sr(tt,"users",e,"monthlyBudgets"),h=await Qi(d);for(const b of h.docs){const w=b.data().allocations||{},S={};let T=!1;Object.keys(w).forEach(C=>{i.has(C)||(S[`allocations.${C}`]=VR(),T=!0,console.log(` Found orphaned embedded allocation in ${b.id} for envelope ${C}`),t.orphanedAllocationsDeleted++,t.details.deletedAllocationIds.push(`${b.id}_${C}`))}),T&&(S.updatedAt=pt.now(),await ka(b.ref,S),u.add(b.id))}const p=await this.getTransactions(e),m=[];for(const b of p)i.has(b.envelopeId)||(m.push(b.id),console.log(` Found orphaned transaction: ${b.id} for envelope ${b.envelopeId}`));if(m.length>0){const b=m.map(_=>Zi(St(tt,"users",e,"transactions",_)));await Promise.all(b),t.orphanedTransactionsDeleted=m.length,t.details.deletedTransactionIds=m,console.log(` Deleted ${m.length} orphaned transactions`)}return t.details.monthsProcessed=Array.from(u),console.log(" Cleanup completed:",{orphanedAllocationsDeleted:t.orphanedAllocationsDeleted,orphanedTransactionsDeleted:t.orphanedTransactionsDeleted,monthsProcessed:t.details.monthsProcessed.length}),t}catch(t){throw console.error(" BudgetService.cleanupOrphanedData failed:",t),new Error(`Failed to cleanup orphaned data: ${t instanceof Error?t.message:"Unknown error"}`)}}subscribeToMonthlyBudget(e,t,r){const i=St(tt,"users",e,"monthlyBudgets",t);return Vd(i,a=>{if(!a.exists()){r({incomeSources:[],allocations:[]});return}const o=a.data(),c=(o.incomeSources||[]).map(h=>({...h,amount:Number(h.amount),createdAt:h.createdAt?.toDate?h.createdAt.toDate().toISOString():h.createdAt||new Date().toISOString(),updatedAt:h.updatedAt?.toDate?h.updatedAt.toDate().toISOString():h.updatedAt||new Date().toISOString()})).sort((h,p)=>new Date(h.createdAt).getTime()-new Date(p.createdAt).getTime()),u=o.allocations||{},d=Object.entries(u).map(([h,p])=>({id:h,userId:e,envelopeId:h,month:t,budgetedAmount:Number(p),createdAt:o.createdAt?.toDate?o.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:o.updatedAt?.toDate?o.updatedAt.toDate().toISOString():new Date().toISOString()})).sort((h,p)=>new Date(h.createdAt).getTime()-new Date(p.createdAt).getTime());r({incomeSources:c,allocations:d})})}prepareMonthlyBudgetsData(e,t){const r=[],i=new Set;return e&&Object.keys(e).forEach(a=>i.add(a)),t&&Object.keys(t).forEach(a=>i.add(a)),i.forEach(a=>{const o=e?.[a]||[],c=t?.[a]||[],u={};o.forEach(h=>{u[h.envelopeId]=h.budgetedAmount});const d={month:a,userId:"",incomeSources:c,allocations:u,totalIncome:c.reduce((h,p)=>h+Number(p.amount||0),0),availableToBudget:c.reduce((h,p)=>h+Number(p.amount||0),0)-o.reduce((h,p)=>h+Number(p.budgetedAmount||0),0),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};r.push(d)}),r}async deleteAllUserData(e){try{console.log(" BudgetService.deleteAllUserData: STARTING DELETION for user:",e);const t=["envelopes","transactions","incomeSources","envelopeAllocations","monthlyBudgets","appSettings"];for(const r of t){console.log(` Deleting collection: ${r}...`);const i=Sr(tt,"users",e,r),a=await Qi(i);if(a.empty){console.log("   (Empty collection)");continue}const o=a.docs.map(c=>Zi(c.ref));await Promise.all(o),console.log(`    Deleted ${a.size} documents from ${r}`)}console.log(" All user data deleted successfully.")}catch(t){throw console.error(" BudgetService.deleteAllUserData failed:",t),new Error(`Failed to delete all user data: ${t instanceof Error?t.message:"Unknown error"}`)}}}const GS=oc.getInstance();class Lo{static instance;constructor(){}static getInstance(){return Lo.instance||(Lo.instance=new Lo),Lo.instance}createId(){return St(Sr(tt,"temp")).id}async createCategory(e){const t=St(tt,`users/${e.userId}/categories`,e.id);return await ai(t,e),e}async getCategories(e){const t=sa(Sr(tt,`users/${e}/categories`),Jo("orderIndex","asc"));return(await Qi(t)).docs.map(i=>i.data())}async updateCategory(e,t){const r=St(tt,`users/${e}/categories`,t.id);await ai(r,t,{merge:!0})}async deleteCategory(e,t){const r=St(tt,`users/${e}/categories`,t);await Zi(r)}async reorderCategories(e,t){const r=LO(tt);t.forEach((i,a)=>{const o=St(tt,`users/${e}/categories`,i.id);r.update(o,{orderIndex:a})}),await r.commit()}subscribeToCategories(e,t){const r=sa(Sr(tt,`users/${e}/categories`),Jo("orderIndex","asc"));return Vd(r,i=>{const a=i.docs.map(o=>o.data());t(a)},i=>{console.error(" Category subscription error:",i)})}}Lo.getInstance();const b1=n=>Sr(tt,"users",n,"transactions"),Gee={subscribeToTransactions:(n,e)=>{const t=sa(b1(n),Jo("date","desc"));return Vd(t,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllTransactions:async n=>{console.log(` TransactionService.getAllTransactions: Fetching for user ${n}`);const e=sa(b1(n),Jo("date","desc")),r=(await Qi(e)).docs.map(i=>{const a={id:i.id,...i.data()};return FS(a)});return console.log(` Fetched ${r.length} transactions:`,r.map(i=>({id:i.id,description:i.description,month:i.month}))),r},addTransaction:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create transaction");console.log(` TransactionService.addTransaction: Adding transaction for user ${e}:`,r),console.log(` Original transaction had temp ID: ${t}`);try{console.log(" About to call addDoc with:",r);const i=await Qv(b1(e),r);console.log(" addDoc succeeded, docRef:",i),console.log(` Document ID: ${i.id}`),console.log(` Document path: ${i.path}`);const a={id:i.id,...r,userId:e};return console.log(" Final result object:",a),a}catch(i){throw console.error(" addDoc failed:",i),console.error("Error message:",i.message),i}},updateTransaction:async(n,e,t)=>{const r=St(tt,"users",n,"transactions",e);return await ka(r,t)},deleteTransaction:async(n,e)=>{console.log(` TransactionService.deleteTransaction: Deleting transaction ${e} for user ${n}`);try{const t=St(tt,"users",n,"transactions",e);console.log(` Deleting document at path: ${t.path}`),await Zi(t),console.log(` TransactionService.deleteTransaction: Successfully deleted transaction ${e}`)}catch(t){throw console.error(` TransactionService.deleteTransaction: Failed to delete transaction ${e}:`,t),console.error("Error message:",t.message),t}}},x1=n=>Sr(tt,"users",n,"envelopes"),qee={subscribeToEnvelopes:(n,e)=>{const t=sa(x1(n),Jo("orderIndex","asc"));return Vd(t,i=>{const a=i.docs.map(o=>{const c=o.data();return{id:o.id,...c,createdAt:c.createdAt?.toDate?.()?c.createdAt.toDate().toISOString():c.createdAt,lastUpdated:c.lastUpdated?.toDate?.()?c.lastUpdated.toDate().toISOString():c.lastUpdated}});e(a)})},getAllEnvelopes:async n=>{try{console.log(" EnvelopeService.getAllEnvelopes called for user:",n);const e=x1(n),i=(await Qi(e)).docs.map((a,o)=>{const c=a.data();return{id:a.id,...c,createdAt:c.createdAt?.toDate?.()?c.createdAt.toDate().toISOString():c.createdAt,lastUpdated:c.lastUpdated?.toDate?.()?c.lastUpdated.toDate().toISOString():c.lastUpdated,orderIndex:c.orderIndex??o}}).sort((a,o)=>{const c=a.orderIndex??0,u=o.orderIndex??0;return c-u});return console.log(" Fetched envelopes:",i.length),i}catch(e){return console.error(" EnvelopeService.getAllEnvelopes failed:",e),[]}},createEnvelope:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create envelope");try{return{id:(await Qv(x1(e),r)).id,...r,userId:e}}catch(i){throw console.error(" Envelope addDoc failed:",i),i}},saveEnvelope:async(n,e)=>{if(!e.id)throw new Error("Envelope ID is required for save operation");const t=St(tt,"users",n,"envelopes",e.id);return await ai(t,e,{merge:!0})},updateBalance:async(n,e,t)=>{const r=St(tt,"users",n,"envelopes",e);return await ka(r,{currentBalance:t,lastUpdated:new Date().toISOString()})},deleteEnvelope:async(n,e)=>{console.log(` EnvelopeService.deleteEnvelope: Deleting envelope ${e} for user ${n}`);const t=St(tt,"users",n,"envelopes",e);await Zi(t),console.log(` EnvelopeService.deleteEnvelope: Successfully deleted envelope ${e}`)}},_1=n=>Sr(tt,"users",n,"distributionTemplates"),$ee={subscribeToDistributionTemplates:(n,e)=>{const t=sa(_1(n),Jo("lastUsed","desc"));return Vd(t,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllDistributionTemplates:async n=>{const e=sa(_1(n),Jo("lastUsed","desc"));return(await Qi(e)).docs.map(r=>({id:r.id,...r.data()}))},createDistributionTemplate:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create distribution template");console.log(` DistributionTemplateService.createDistributionTemplate: Adding template for user ${e}:`,r);try{const i=await Qv(_1(e),r);console.log(" Template addDoc succeeded, docRef:",i);const a={id:i.id,...r,userId:e};return console.log(" Final template result object:",a),a}catch(i){throw console.error(" Template addDoc failed:",i),i}},saveDistributionTemplate:async(n,e)=>{const t=St(tt,"users",n,"distributionTemplates",e.id);return await ai(t,e,{merge:!0})},updateDistributionTemplate:async(n,e,t)=>{const r=St(tt,"users",n,"distributionTemplates",e);return await ka(r,t)},deleteDistributionTemplate:async(n,e)=>{console.log(` DistributionTemplateService.deleteDistributionTemplate: Deleting template ${e} for user ${n}`);const t=St(tt,"users",n,"distributionTemplates",e);await Zi(t),console.log(` DistributionTemplateService.deleteDistributionTemplate: Successfully deleted template ${e}`)}},w1=n=>Sr(tt,"users",n,"appSettings"),E5={subscribeToAppSettings:(n,e)=>{const t=sa(w1(n),PR(1));return Vd(t,i=>{if(i.empty){e(null);return}const a=i.docs.map(o=>({id:o.id,...o.data()}))[0];e(a)})},getAppSettings:async n=>{const e=sa(w1(n),PR(1)),t=await Qi(e);if(t.empty)return null;const r=t.docs[0];return{id:r.id,...r.data()}},createAppSettings:async n=>{const{userId:e,...t}=n;if(!e)throw new Error("User ID is required to create app settings");console.log(` AppSettingsService.createAppSettings: Creating settings for user ${e}:`,t);try{const r=await Qv(w1(e),t);console.log(" Settings addDoc succeeded, docRef:",r);const i={id:r.id,...t,userId:e};return console.log(" Final settings result object:",i),i}catch(r){throw console.error(" Settings addDoc failed:",r),r}},saveAppSettings:async(n,e)=>{const t=St(tt,"users",n,"appSettings",e.id);return await ai(t,e,{merge:!0})},updateAppSettings:async(n,e,t)=>{const r=St(tt,"users",n,"appSettings",e);return await ai(r,t,{merge:!0})},deleteAppSettings:async(n,e)=>{console.log(` AppSettingsService.deleteAppSettings: Deleting settings ${e} for user ${n}`);const t=St(tt,"users",n,"appSettings",e);await Zi(t),console.log(` AppSettingsService.deleteAppSettings: Successfully deleted settings ${e}`)}},Hk=Object.freeze(Object.defineProperty({__proto__:null,AppSettingsService:E5},Symbol.toStringTag,{value:"Module"})),Hee=n=>FS(n),Yee=n=>({id:n.id,name:n.name||"",currentBalance:n.currentBalance||0,lastUpdated:n.lastUpdated?.toDate?.()?n.lastUpdated.toDate().toISOString():n.lastUpdated,isActive:n.isActive??!0,orderIndex:n.orderIndex??0,userId:n.userId||void 0,createdAt:n.createdAt?.toDate?.()?n.createdAt.toDate().toISOString():n.createdAt,isPiggybank:n.isPiggybank,piggybankConfig:n.piggybankConfig,categoryId:n.categoryId}),Kee=n=>({id:n.id,userId:n.userId,name:n.name,orderIndex:n.orderIndex,isArchived:n.isArchived,createdAt:n.createdAt?.toDate?.()?n.createdAt.toDate().toISOString():n.createdAt,updatedAt:n.updatedAt?.toDate?.()?n.updatedAt.toDate().toISOString():n.updatedAt}),Yk=(n,e)=>{if(window.__firebaseUnsubscribers){console.log(" Real-time subscriptions already active, skipping setup");return}console.log(" Setting up real-time Firebase subscriptions...");const t=n.getState().currentMonth;console.log(" Current month for subscriptions:",t);const r=qee.subscribeToEnvelopes(e,h=>{console.log(" Real-time sync: Envelopes updated",h.length);const p=h.map(Yee),m=n.getState(),b=new Set(m.envelopes.map(S=>S.id)),_=new Set(p.map(S=>S.id)),w=[...p.filter(S=>b.has(S.id)),...m.envelopes.filter(S=>!_.has(S.id))];n.setState({envelopes:w})}),i=Gee.subscribeToTransactions(e,h=>{console.log(" Real-time sync: Transactions updated",h.length);const p=h.map(Hee),m=n.getState(),b=new Set(m.transactions.map(S=>`${S.id}-${S.month}`)),_=new Set(p.map(S=>`${S.id}-${S.month}`)),w=[...p.filter(S=>b.has(`${S.id}-${S.month}`)),...m.transactions.filter(S=>!_.has(`${S.id}-${S.month}`))];n.setState({transactions:w})}),o=Lo.getInstance().subscribeToCategories(e,h=>{console.log(" Real-time sync: Categories updated",h.length);const p=h.map(Kee);n.setState({categories:p})}),c=$ee.subscribeToDistributionTemplates(e,h=>{console.log(" Real-time sync: Templates updated from Firebase",h.length)}),u=E5.subscribeToAppSettings(e,h=>{console.log(" Real-time sync: Settings updated",h?"found":"null");const p=n.getState();if(h){const m={...p.appSettings,...h,paymentSources:h.paymentSources??p.appSettings?.paymentSources??[]};n.setState({appSettings:m})}else console.log(" Firebase settings null, preserving local state")}),d=GS.subscribeToMonthlyBudget(e,t,h=>{console.log(` Real-time sync: Monthly budget updated (${h.incomeSources.length} sources, ${h.allocations.length} allocations)`);const p=n.getState();n.setState({incomeSources:{...p.incomeSources,[t]:h.incomeSources},allocations:{...p.allocations,[t]:h.allocations}})});window.__firebaseUnsubscribers={envelopes:r,transactions:i,categories:o,templates:c,settings:u,monthlyBudget:d},console.log(" Real-time subscriptions active - cross-device sync enabled")},Xee=n=>{const{useBudgetStore:e,useAuthStore:t,getCurrentUserId:r}=n;if(typeof window>"u")return;window.addEventListener("online",async()=>{console.log(" Browser online event detected"),e.setState({isOnline:!0})}),window.addEventListener("offline",()=>{console.log(" Browser offline event detected"),e.setState({isOnline:!1})}),e.setState({isOnline:navigator.onLine});const i=t.getState();i.isAuthenticated&&i.currentUser&&(console.log(" User already authenticated on app load, setting up real-time subscriptions"),Yk(e,r())),t.subscribe(o=>{if(o.isAuthenticated&&o.currentUser)console.log(" User authenticated, setting up real-time subscriptions"),Yk(e,r());else if(!o.isAuthenticated&&!o.isLoading){if(console.log(" User logged out, clearing data and unsubscribing"),window.__firebaseUnsubscribers){const c=window.__firebaseUnsubscribers;c.envelopes&&c.envelopes(),c.transactions&&c.transactions(),c.categories&&c.categories(),c.templates&&c.templates(),c.settings&&c.settings(),c.monthlyBudget&&c.monthlyBudget(),delete window.__firebaseUnsubscribers,console.log(" Cleaned up Firebase subscriptions")}e.getState().handleUserLogout()}});let a=e.getState().currentMonth;e.subscribe(o=>{if(o.currentMonth!==a&&o.isAuthenticated){console.log(" Month changed from",a,"to",o.currentMonth),a=o.currentMonth;const c=r();if(c&&window.__firebaseUnsubscribers){const u=window.__firebaseUnsubscribers;u.monthlyBudget&&u.monthlyBudget(),console.log(" Unsubscribed from old month data"),u.monthlyBudget=GS.subscribeToMonthlyBudget(c,o.currentMonth,d=>{console.log(" Real-time sync: Monthly budget updated for new month");const h=e.getState();e.setState({incomeSources:{...h.incomeSources,[o.currentMonth]:d.incomeSources},allocations:{...h.allocations,[o.currentMonth]:d.allocations}})}),console.log(" Subscribed to monthly data for new month:",o.currentMonth)}}})},Wee=()=>ea.getState().currentUser?.id||"",Sn=oc.getInstance(),Fl=Lo.getInstance(),un=gw()(H9(EN((n,e)=>({envelopes:[],transactions:[],categories:[],appSettings:null,incomeSources:{},allocations:{},currentMonth:new Date().toISOString().slice(0,7),isOnline:typeof navigator<"u"?navigator.onLine:!0,isOnboardingActive:!1,isOnboardingCompleted:typeof localStorage<"u"?localStorage.getItem("onboardingCompleted")==="true":!1,isLoading:!1,error:null,setIsOnboardingActive:t=>{n({isOnboardingActive:t})},completeOnboarding:()=>{n({isOnboardingCompleted:!0,isOnboardingActive:!1}),localStorage.setItem("onboardingCompleted","true")},resetOnboarding:()=>{n({isOnboardingCompleted:!1,isOnboardingActive:!0}),localStorage.removeItem("onboardingCompleted")},clearMonthData:async t=>{try{n({isLoading:!0,error:null}),console.log(` Clearing all data for month: ${t}`);const i=(await Ct(()=>Promise.resolve().then(()=>zt),[]).then(o=>o.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const{monthlyBudgetService:a}=await Ct(async()=>{const{monthlyBudgetService:o}=await import("./MonthlyBudgetService-BkODRNfq.js");return{monthlyBudgetService:o}},[]);await a.clearMonthData(i.id,t),await e().init(),console.log(` Cleared month data for ${t}`),n({isLoading:!1})}catch(r){throw console.error(" clearMonthData failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to clear month data"}),r}},fetchMonthData:async t=>{try{const i=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i){console.log("No user logged in, skipping month data fetch");return}console.log(`Fetching month data for: ${t}`);const a=await Sn.getMonthData(i.id,t),o=e();n({incomeSources:{...o.incomeSources,[t]:a.incomeSources},allocations:{...o.allocations,[t]:a.allocations}}),console.log(` Fetched month data for ${t}`),(async()=>{const u=e(),d=u.allocations[t]||[],h=u.transactions.filter(m=>m.month===t);let p=0;for(const m of d){const b=u.envelopes.find(w=>w.id===m.envelopeId);if(b?.isPiggybank)continue;const _=h.find(w=>w.envelopeId===m.envelopeId&&(w.description==="Monthly Budget Allocation"||w.description==="Monthly Allocation"||w.description==="Budgeted"||w.description==="Piggybank Contribution"));_?_.amount!==m.budgetedAmount&&(console.log(` Repairing mismatch for envelope ${b?.name||m.envelopeId}: Alloc ${m.budgetedAmount} vs Tx ${_.amount}`),await u.updateTransaction({..._,amount:m.budgetedAmount}),p++):m.budgetedAmount>0&&(console.log(` Repairing missing transaction for envelope ${b?.name||m.envelopeId}`),await u.addTransaction({description:"Budgeted",amount:m.budgetedAmount,envelopeId:m.envelopeId,type:"Income",month:t,date:`${t}-01T00:00:00`,reconciled:!1,isAutomatic:!0}),p++)}p>0&&console.log(` Repaired ${p} allocation discrepancies for ${t}`)})().catch(u=>console.error("Verification failed:",u))}catch(r){console.error(` Failed to fetch month data for ${t}:`,r)}},removeEnvelopeFromMonth:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(` Removing envelope ${t} from month ${r}`);const i=e(),a=i.allocations[r]?.find(c=>c.envelopeId===t);a?await e().deleteEnvelopeAllocation(a.id):console.log(` No allocation found for envelope ${t} in ${r}`);const o=i.transactions.filter(c=>c.envelopeId===t&&(c.month===r||c.date.startsWith(r)));o.length>0&&(console.log(` Deleting ${o.length} transactions for envelope ${t} in ${r}`),await Promise.all(o.map(c=>e().deleteTransaction(c.id)))),n({isLoading:!1}),console.log(` Removed envelope ${t} from month ${r}`)}catch(i){throw console.error(" removeEnvelopeFromMonth failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to remove envelope from month"}),i}},setMonth:async t=>{n({currentMonth:t});const r=e();(r.incomeSources[t]===void 0||r.allocations[t]===void 0)&&(console.log(`Month ${t} data missing in store, fetching...`),n({isLoading:!0}),await e().fetchMonthData(t),n({isLoading:!1}))},init:async()=>{console.log("BudgetStore initializing...");const t=e();try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!i){console.log("No user logged in, skipping data fetch"),n({isLoading:!1});return}console.log(`Fetching data for user: ${i.id}, month: ${t.currentMonth}`);const[a,o,c,u]=await Promise.all([Sn.getEnvelopes(i.id),Sn.getTransactions(i.id),Fl.getCategories(i.id).catch(d=>(console.error(" Failed to load categories:",d),[])),Sn.getMonthData(i.id,t.currentMonth)]);n({envelopes:a,transactions:o,categories:c,incomeSources:{...t.incomeSources,[t.currentMonth]:u.incomeSources},allocations:{...t.allocations,[t.currentMonth]:u.allocations},isLoading:!1,error:null}),console.log(` BudgetStore initialized: ${a.length} envelopes, ${o.length} transactions, ${c.length} categories, ${u.incomeSources.length} income sources, ${u.allocations.length} allocations`)}catch(r){console.error(" BudgetStore initialization failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to initialize budget data"})}},fetchCategories:async()=>{try{n({isLoading:!0,error:null});const r=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!r)return;const i=await Fl.getCategories(r.id);n({categories:i,isLoading:!1})}catch(t){console.error("Failed to fetch categories:",t),n({isLoading:!1})}},addCategory:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No user logged in");const a=Fl.createId(),o={...t,id:a,userId:i.id,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),orderIndex:e().categories.length};return await Fl.createCategory(o),n(c=>c.categories.some(d=>d.id===a)?{isLoading:!1}:{categories:[...c.categories,o],isLoading:!1}),a}catch(r){throw console.error("Failed to add category:",r),n({isLoading:!1}),r}},updateCategory:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!i)throw new Error("No user logged in");const a={...t,updatedAt:new Date().toISOString()};await Fl.updateCategory(i.id,a),n(o=>({categories:o.categories.map(c=>c.id===t.id?a:c),isLoading:!1}))}catch(r){throw console.error("Failed to update category:",r),n({isLoading:!1}),r}},deleteCategory:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No user logged in");await Fl.deleteCategory(i.id,t),n(a=>({categories:a.categories.filter(o=>o.id!==t),isLoading:!1}))}catch(r){throw console.error("Failed to delete category:",r),n({isLoading:!1}),r}},reorderCategories:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i)throw new Error("No user logged in");const a=e(),o=new Map;t.forEach((u,d)=>o.set(u,d));const c=a.categories.map(u=>{if(!o.has(u.id))return u;const d=o.get(u.id);return u.orderIndex===d?u:{...u,orderIndex:d}});n({categories:c.sort((u,d)=>u.orderIndex-d.orderIndex)}),await Fl.reorderCategories(i.id,c),n({isLoading:!1})}catch(r){throw console.error("Failed to reorder categories:",r),n({isLoading:!1}),r}},addEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a={...t,userId:i.id},o=await Sn.createEnvelope(a);return n(c=>c.envelopes.some(d=>d.id===o.id)?{isLoading:!1}:{envelopes:[...c.envelopes,o],isLoading:!1}),console.log(" Added envelope:",o.id),o.id}catch(r){throw console.error(" addEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to add envelope"}),r}},updateEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Sn.updateEnvelope(i.id,t),n(a=>({envelopes:a.envelopes.map(o=>o.id===t.id?t:o),isLoading:!1})),console.log(" Updated envelope:",t.id)}catch(r){throw console.error(" updateEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update envelope"}),r}},deleteEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Sn.deleteEnvelope(i.id,t),n(a=>({envelopes:a.envelopes.filter(o=>o.id!==t),transactions:a.transactions.filter(o=>o.envelopeId!==t),isLoading:!1})),console.log(" Deleted envelope:",t)}catch(r){throw console.error(" deleteEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete envelope"}),r}},reorderEnvelopes:async t=>{try{n({isLoading:!0,error:null});const r=e(),i=new Map;t.forEach((d,h)=>{i.set(d,h)});const a=r.envelopes.map(d=>{if(!i.has(d.id))return d;const h=i.get(d.id);return d.orderIndex===h?d:{...d,orderIndex:h}}),o=a.filter((d,h)=>d!==r.envelopes[h]);if(!o.length){n({isLoading:!1});return}const u=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!u)throw new Error("No authenticated user found");await Sn.reorderEnvelopes(u.id,o),n({envelopes:a,isLoading:!1}),console.log(" Reordered envelopes")}catch(r){throw console.error(" reorderEnvelopes failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to reorder envelopes"}),r}},addTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=new Date(t.date),o=t.month||`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,c={...t,userId:i.id,month:o},u=await Sn.createTransaction(c);n(d=>d.transactions.some(p=>p.id===u.id)?{isLoading:!1}:{transactions:[...d.transactions,u],isLoading:!1}),console.log(" Added transaction:",u.id)}catch(r){throw console.error(" addTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to add transaction"}),r}},updateTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=new Date(t.date),o=t.month||`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,c={...t,month:o};await Sn.updateTransaction(i.id,c),n(u=>({transactions:u.transactions.map(d=>d.id===t.id?c:d),isLoading:!1})),console.log(" Updated transaction:",t.id)}catch(r){throw console.error(" updateTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update transaction"}),r}},deleteTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Sn.deleteTransaction(i.id,t),n(a=>({transactions:a.transactions.filter(o=>o.id!==t),isLoading:!1})),console.log(" Deleted transaction:",t)}catch(r){throw console.error(" deleteTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete transaction"}),r}},restoreTransaction:async t=>{await e().updateTransaction(t)},transferFunds:async(t,r,i,a,o)=>{try{const c=o?typeof o=="string"?o:o.toISOString():new Date().toISOString(),u=`transfer-${Date.now()}-${Math.random()}`;await e().addTransaction({description:`Transfer to ${e().envelopes.find(d=>d.id===r)?.name||"envelope"}`,amount:i,envelopeId:t,date:c,type:"Expense",transferId:u,reconciled:!1}),await e().addTransaction({description:`Transfer from ${e().envelopes.find(d=>d.id===t)?.name||"envelope"}`,amount:i,envelopeId:r,date:c,type:"Income",transferId:u,reconciled:!1}),console.log(" Transfer completed")}catch(c){throw console.error(" transferFunds failed:",c),c}},fetchData:async()=>{await e().init()},renameEnvelope:async(t,r)=>{try{n({isLoading:!0,error:null});const a=e().envelopes.find(d=>d.id===t);if(!a)throw new Error("Envelope not found");n(d=>({envelopes:d.envelopes.map(h=>h.id===t?{...h,name:r}:h),isLoading:!0}));const c=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!c)throw new Error("No authenticated user found");const u={...a,name:r};await Sn.updateEnvelope(c.id,u),n({isLoading:!1}),console.log(" Renamed envelope:",t)}catch(i){throw console.error(" renameEnvelope failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to rename envelope"}),i}},getEnvelopeBalance:(t,r)=>{const i=e(),a=i.envelopes.find(o=>o.id===t);if(!a)return console.log(` getEnvelopeBalance: Envelope ${t} not found`),0;if(a.isPiggybank){const o=i.transactions.filter(p=>p.envelopeId===t),c=o.filter(p=>p.type==="Expense"),u=o.filter(p=>p.type==="Income"),d=c.reduce((p,m)=>p+(m.amount||0),0);return u.reduce((p,m)=>p+(m.amount||0),0)-d}if(r){const o=i.transactions.filter(p=>p.envelopeId===t&&p.month===r),c=o.filter(p=>p.type==="Expense"),u=o.filter(p=>p.type==="Income"),d=c.reduce((p,m)=>p+(m.amount||0),0);return u.reduce((p,m)=>p+(m.amount||0),0)-d}return console.warn(` getEnvelopeBalance: Month not provided for non-piggybank envelope ${t}. Returning 0.`),0},resetData:async()=>{console.log(" Resetting all data"),n({isLoading:!0});try{const r=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(i=>i.useAuthStore.getState())).currentUser;r?(console.log(" Deleting all data from Firestore for user:",r.id),await Sn.deleteAllUserData(r.id)):console.warn(" No user logged in, only clearing local state"),n({envelopes:[],transactions:[],appSettings:null,incomeSources:{},allocations:{},isLoading:!1,error:null}),console.log(" Reset data complete")}catch(t){throw console.error(" resetData failed:",t),n({isLoading:!1,error:t instanceof Error?t.message:"Failed to reset data"}),t}},importData:async t=>{try{if(n({isLoading:!0,error:null}),!t||typeof t!="object")throw new Error("Invalid data format");const i=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("You must be logged in to restore data.");return console.log(" Starting Time Machine Restore for user:",i.id),await Sn.restoreUserData(i.id,t),console.log(" Reloading app state from cloud..."),await e().init(),n({isLoading:!1}),{success:!0,message:"Data restored successfully from backup."}}catch(r){return console.error(" importData failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to import data"}),{success:!1,message:r instanceof Error?r.message:"Import failed"}}},updateAppSettings:async t=>{try{n({isLoading:!0,error:null});const r=e(),i={id:r.appSettings?.id||"default",theme:t.theme??r.appSettings?.theme??"system",fontSize:t.fontSize??r.appSettings?.fontSize??"medium",enableMoveableReorder:t.enableMoveableReorder??r.appSettings?.enableMoveableReorder??!0,paymentSources:t.paymentSources??r.appSettings?.paymentSources??[]};(t.userId||r.appSettings?.userId)&&(i.userId=t.userId??r.appSettings?.userId),i.paymentSources&&(i.paymentSources=i.paymentSources.map(c=>{const u={...c};return u.last4===void 0&&delete u.last4,u}));const o=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(o){const{AppSettingsService:c}=await Ct(async()=>{const{AppSettingsService:u}=await Promise.resolve().then(()=>Hk);return{AppSettingsService:u}},void 0);await c.updateAppSettings(o.id,i.id,i)}n({appSettings:i,isLoading:!1}),console.log(" Updated app settings")}catch(r){throw console.error(" updateAppSettings failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update settings"}),r}},initializeAppSettings:async()=>{try{if(e().appSettings)return;const i=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(i){const{AppSettingsService:o}=await Ct(async()=>{const{AppSettingsService:u}=await Promise.resolve().then(()=>Hk);return{AppSettingsService:u}},void 0),c=await o.getAppSettings(i.id);if(c){n({appSettings:c}),console.log(" Loaded app settings from Firestore");return}}const a={id:"default",theme:"system",fontSize:"medium",enableMoveableReorder:!0,paymentSources:[]};i&&(a.userId=i.id),n({appSettings:a}),console.log(" Initialized default app settings")}catch(t){console.error(" initializeAppSettings failed:",t),n({error:t instanceof Error?t.message:"Failed to initialize settings"})}},updatePiggybankContribution:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Updating piggybank contribution:",{envelopeId:t,newAmount:r});const a=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");const o=e().envelopes.find(u=>u.id===t&&u.isPiggybank);if(!o)throw new Error("Piggybank not found");const c={...o,lastUpdated:new Date().toISOString(),piggybankConfig:{monthlyContribution:r,targetAmount:o.piggybankConfig?.targetAmount,color:o.piggybankConfig?.color,icon:o.piggybankConfig?.icon,paused:o.piggybankConfig?.paused??!1}};if(console.log(" Updating envelope in Firestore:",c),await Sn.updateEnvelope(a.id,c),console.log(" Envelope updated successfully"),n(u=>({envelopes:u.envelopes.map(d=>d.id===t?c:d),isLoading:!1})),!o.piggybankConfig?.paused)try{await e().setEnvelopeAllocation(t,r),setTimeout(()=>{e().transactions.find(d=>d.envelopeId===t&&(d.description==="Monthly Allocation"||d.description==="Piggybank Contribution"))||console.warn(" Piggybank contribution transaction not found after update")},1e3)}catch(u){console.error(" Failed to update piggybank contribution:",u)}console.log(" Piggybank contribution updated successfully")}catch(i){throw console.error(" updatePiggybankContribution failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update piggybank contribution"}),i}},addIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null});const a=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");console.log(" Adding income source:",{month:t,source:r});const o=await Sn.createIncomeSource({...r,userId:a.id,month:t});n(c=>{const u=c.incomeSources[t]||[];return u.some(h=>h.id===o.id)?{isLoading:!1}:{incomeSources:{...c.incomeSources,[t]:[...u,o]},isLoading:!1}}),console.log(" Added income source:",o.id)}catch(i){throw console.error(" addIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to add income source"}),i}},updateIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Updating income source:",{month:t,sourceId:r.id}),n(o=>({incomeSources:{...o.incomeSources,[t]:o.incomeSources[t]?.map(c=>c.id===r.id?{...r,updatedAt:new Date().toISOString()}:c)||[]},isLoading:!1}));const a=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!a)return;await Sn.updateIncomeSource(a.id,r.id,t,r),console.log(" Updated income source:",r.id)}catch(i){throw console.error(" updateIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update income source"}),i}},deleteIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Deleting income source:",{month:t,sourceId:r}),n(o=>({incomeSources:{...o.incomeSources,[t]:o.incomeSources[t]?.filter(c=>c.id!==r)||[]},isLoading:!1}));const a=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!a)return;await Sn.deleteIncomeSource(a.id,r,t),console.log(" Deleted income source:",r)}catch(i){throw console.error(" deleteIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to delete income source"}),i}},copyPreviousMonthAllocations:async t=>{try{n({isLoading:!0,error:null});const i=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(_=>_.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");console.log(" Copying allocations from previous month:",t);const[a,o]=t.split("-").map(Number);let c=a,u=o-1;u<1&&(c=a-1,u=12);const d=`${c}-${String(u).padStart(2,"0")}`;(!e().incomeSources[d]||!e().allocations[d])&&(console.log(` Previous month ${d} data missing, fetching...`),await e().fetchMonthData(d));const h=e().incomeSources[d]||[];if(console.log(` Found ${h.length} income sources from ${d}`),h.length>0){for(const _ of h){const{id:w,...S}=_;await e().addIncomeSource(t,S)}console.log(` Copied ${h.length} income sources to ${t}`)}const p=e().allocations[d]||[];console.log(` Found ${p.length} allocations from ${d}`);const m=p.filter(_=>{const w=e().envelopes.find(S=>S.id===_.envelopeId);return!!w&&!w.isPiggybank});if(m.length>0){for(const _ of m)await e().createEnvelopeAllocation({envelopeId:_.envelopeId,budgetedAmount:_.budgetedAmount,userId:i.id,month:t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),_.budgetedAmount>0&&await e().addTransaction({description:"Budgeted",amount:_.budgetedAmount,envelopeId:_.envelopeId,type:"Income",month:t,date:`${t}-01T00:00:00`,reconciled:!1,isAutomatic:!0});console.log(` Copied ${m.length} regular allocations to ${t}`)}const b=e().envelopes.filter(_=>_.isPiggybank);console.log(` Processing ${b.length} piggybanks for ${t}`);for(const _ of b){const w=_.piggybankConfig?.monthlyContribution,S=_.piggybankConfig?.paused??!1;if(!S&&w&&w>0)try{console.log(` Setting piggybank allocation for ${_.name}: ${w}`),await e().setEnvelopeAllocation(_.id,w)}catch(T){console.error(` Failed to set allocation for piggybank ${_.name}:`,T)}else console.log(` Skipping piggybank ${_.name} (paused=${S}, contribution=${w})`)}n({isLoading:!1}),console.log(` Complete monthly setup copied to ${t}`)}catch(r){throw console.error(" copyPreviousMonthAllocations failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to copy allocations"}),r}},setEnvelopeAllocation:async(t,r)=>{try{n({isLoading:!0,error:null});const a=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(h=>h.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");const o=e().currentMonth,c=e().envelopes.find(h=>h.id===t);if(!c){console.error(` setEnvelopeAllocation: Envelope ${t} not found in store! Aborting.`),n({isLoading:!1});return}const u=!!c.isPiggybank;console.log(` setEnvelopeAllocation called: envelopeId=${t}, amount=${r}, currentMonth=${o}, isPiggybank=${u}`);const d=e().allocations[o]?.find(h=>h.envelopeId===t);if(d?await e().updateEnvelopeAllocation(d.id,{budgetedAmount:r}):await e().createEnvelopeAllocation({envelopeId:t,budgetedAmount:r,userId:a.id,month:o,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),u&&r>0&&!c?.piggybankConfig?.paused){const h=e().transactions.find(p=>p.envelopeId===t&&p.month===o&&(p.description==="Monthly Allocation"||p.description==="Piggybank Contribution"));if(h){const p={...h,amount:r,description:"Piggybank Contribution"};await e().updateTransaction(p)}else{const p={description:"Piggybank Contribution",amount:r,envelopeId:t,type:"Income",month:o,date:`${o}-01T00:00:00`,reconciled:!1,isAutomatic:!0};await e().addTransaction(p)}}if(!u&&r>0){const h=e().transactions.find(p=>p.envelopeId===t&&p.month===o&&(p.description==="Monthly Budget Allocation"||p.description==="Budgeted"));if(h){const p={...h,amount:r,description:"Budgeted"};await e().updateTransaction(p)}else{const p={description:"Budgeted",amount:r,envelopeId:t,type:"Income",month:o,date:`${o}-01T00:00:00`,reconciled:!1,isAutomatic:!0};await e().addTransaction(p)}}console.log(" Envelope allocation set successfully")}catch(i){throw console.error(" setEnvelopeAllocation failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to set envelope allocation"}),i}},createEnvelopeAllocation:async t=>{try{const i=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=e().currentMonth,o=await Sn.createEnvelopeAllocation({envelopeId:t.envelopeId,budgetedAmount:t.budgetedAmount,userId:i.id,month:a});n(c=>{const u=c.allocations[a]||[];return u.some(h=>h.id===o.id)?{isLoading:!1}:{allocations:{...c.allocations,[a]:[...u,o]},isLoading:!1}}),console.log(" Created envelope allocation:",o.id)}catch(r){throw console.error(" createEnvelopeAllocation failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to create envelope allocation"}),r}},updateEnvelopeAllocation:async(t,r)=>{try{console.log(" Updating envelope allocation:",{id:t,updates:r});const i=e().currentMonth,o=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(h=>h.useAuthStore.getState())).currentUser;if(!o)throw new Error("No authenticated user found");const c=e().allocations[i]?.find(h=>h.id===t);if(!c)throw new Error("Allocation not found");const u=e().envelopes.find(h=>h.id===c.envelopeId),d=u?.isPiggybank;if(await Sn.updateEnvelopeAllocation(o.id,c.envelopeId,i,{budgetedAmount:r.budgetedAmount}),n(h=>({allocations:{...h.allocations,[i]:h.allocations[i]?.map(p=>p.id===t?{...p,...r,updatedAt:new Date().toISOString()}:p)||[]},isLoading:!1})),d&&r.budgetedAmount!==void 0){const h=e().transactions.find(p=>p.envelopeId===c.envelopeId&&p.month===i&&(p.description==="Monthly Allocation"||p.description==="Piggybank Contribution"));h?r.budgetedAmount>0&&!u?.piggybankConfig?.paused?await e().updateTransaction({...h,amount:r.budgetedAmount,description:"Piggybank Contribution"}):(r.budgetedAmount===0||u?.piggybankConfig?.paused)&&await e().deleteTransaction(h.id):r.budgetedAmount>0&&!u?.piggybankConfig?.paused&&await e().addTransaction({description:"Piggybank Contribution",amount:r.budgetedAmount,envelopeId:c.envelopeId,type:"Income",month:i,date:`${i}-01T00:00:00`,reconciled:!1,isAutomatic:!0})}if(!d&&r.budgetedAmount!==void 0){const h=e().transactions.find(p=>p.envelopeId===c.envelopeId&&p.month===i&&(p.description==="Monthly Budget Allocation"||p.description==="Budgeted"));h?r.budgetedAmount>0?await e().updateTransaction({...h,amount:r.budgetedAmount,description:"Budgeted"}):r.budgetedAmount===0&&await e().deleteTransaction(h.id):r.budgetedAmount>0&&await e().addTransaction({description:"Budgeted",amount:r.budgetedAmount,envelopeId:c.envelopeId,type:"Income",month:i,date:`${i}-01T00:00:00`,reconciled:!1,isAutomatic:!0})}console.log(" Updated envelope allocation:",t)}catch(i){throw console.error(" updateEnvelopeAllocation failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update envelope allocation"}),i}},deleteEnvelopeAllocation:async t=>{try{console.log(" Deleting envelope allocation:",t);const r=e().currentMonth,i=e().allocations[r]?.find(c=>c.id===t);if(!i){console.warn("Allocation not found in store, skipping delete");return}const o=(await Ct(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!o)throw new Error("No authenticated user found");await Sn.deleteEnvelopeAllocation(o.id,i.envelopeId,r),n(c=>({allocations:{...c.allocations,[r]:c.allocations[r]?.filter(u=>u.id!==t)||[]},isLoading:!1})),console.log(" Deleted envelope allocation:",t)}catch(r){throw console.error(" deleteEnvelopeAllocation failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete envelope allocation"}),r}},refreshAvailableToBudget:async()=>{try{const t=e().currentMonth,r=e().allocations[t]||[],i=e().incomeSources[t]||[],a=r.reduce((u,d)=>u+d.budgetedAmount,0);return i.reduce((u,d)=>u+d.amount,0)-a}catch(t){throw console.error(" refreshAvailableToBudget failed:",t),n({error:t instanceof Error?t.message:"Failed to refresh available to budget"}),t}},updateOnlineStatus:async()=>{try{const t=typeof navigator<"u"?navigator.onLine:!0;n({isOnline:t}),console.log(" Online status updated:",t)}catch(t){console.error(" Failed to update online status:",t)}},handleUserLogout:()=>{console.log(" Clearing user data on logout"),n({envelopes:[],transactions:[],incomeSources:{},allocations:{},isLoading:!1,error:null})}}),{name:"budget-storage"})));Xee({useBudgetStore:un,useAuthStore:ea,getCurrentUserId:Wee});var Wu=9e15,dl=1e9,aw="0123456789abcdef",yv="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",bv="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",sw={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Wu,maxE:Wu,crypto:!1},S5,ws,rt=!0,my="[DecimalError] ",al=my+"Invalid argument: ",T5=my+"Precision limit exceeded",A5=my+"crypto unavailable",C5="[object Decimal]",xr=Math.floor,$n=Math.pow,Qee=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Zee=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Jee=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,I5=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ra=1e7,Ze=7,ete=9007199254740991,tte=yv.length-1,ow=bv.length-1,Se={toStringTag:C5};Se.absoluteValue=Se.abs=function(){var n=new this.constructor(this);return n.s<0&&(n.s=1),He(n)};Se.ceil=function(){return He(new this.constructor(this),this.e+1,2)};Se.clampedTo=Se.clamp=function(n,e){var t,r=this,i=r.constructor;if(n=new i(n),e=new i(e),!n.s||!e.s)return new i(NaN);if(n.gt(e))throw Error(al+e);return t=r.cmp(n),t<0?n:r.cmp(e)>0?e:new i(r)};Se.comparedTo=Se.cmp=function(n){var e,t,r,i,a=this,o=a.d,c=(n=new a.constructor(n)).d,u=a.s,d=n.s;if(!o||!c)return!u||!d?NaN:u!==d?u:o===c?0:!o^u<0?1:-1;if(!o[0]||!c[0])return o[0]?u:c[0]?-d:0;if(u!==d)return u;if(a.e!==n.e)return a.e>n.e^u<0?1:-1;for(r=o.length,i=c.length,e=0,t=r<i?r:i;e<t;++e)if(o[e]!==c[e])return o[e]>c[e]^u<0?1:-1;return r===i?0:r>i^u<0?1:-1};Se.cosine=Se.cos=function(){var n,e,t=this,r=t.constructor;return t.d?t.d[0]?(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+Ze,r.rounding=1,t=nte(r,M5(r,t)),r.precision=n,r.rounding=e,He(ws==2||ws==3?t.neg():t,n,e,!0)):new r(1):new r(NaN)};Se.cubeRoot=Se.cbrt=function(){var n,e,t,r,i,a,o,c,u,d,h=this,p=h.constructor;if(!h.isFinite()||h.isZero())return new p(h);for(rt=!1,a=h.s*$n(h.s*h,1/3),!a||Math.abs(a)==1/0?(t=ur(h.d),n=h.e,(a=(n-t.length+1)%3)&&(t+=a==1||a==-2?"0":"00"),a=$n(t,1/3),n=xr((n+1)/3)-(n%3==(n<0?-1:2)),a==1/0?t="5e"+n:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+n),r=new p(t),r.s=h.s):r=new p(a.toString()),o=(n=p.precision)+3;;)if(c=r,u=c.times(c).times(c),d=u.plus(h),r=Xt(d.plus(h).times(c),d.plus(u),o+2,1),ur(c.d).slice(0,o)===(t=ur(r.d)).slice(0,o))if(t=t.slice(o-3,o+1),t=="9999"||!i&&t=="4999"){if(!i&&(He(c,n+1,0),c.times(c).times(c).eq(h))){r=c;break}o+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(He(r,n+1,1),e=!r.times(r).times(r).eq(h));break}return rt=!0,He(r,n,p.rounding,e)};Se.decimalPlaces=Se.dp=function(){var n,e=this.d,t=NaN;if(e){if(n=e.length-1,t=(n-xr(this.e/Ze))*Ze,n=e[n],n)for(;n%10==0;n/=10)t--;t<0&&(t=0)}return t};Se.dividedBy=Se.div=function(n){return Xt(this,new this.constructor(n))};Se.dividedToIntegerBy=Se.divToInt=function(n){var e=this,t=e.constructor;return He(Xt(e,new t(n),0,1,1),t.precision,t.rounding)};Se.equals=Se.eq=function(n){return this.cmp(n)===0};Se.floor=function(){return He(new this.constructor(this),this.e+1,3)};Se.greaterThan=Se.gt=function(n){return this.cmp(n)>0};Se.greaterThanOrEqualTo=Se.gte=function(n){var e=this.cmp(n);return e==1||e===0};Se.hyperbolicCosine=Se.cosh=function(){var n,e,t,r,i,a=this,o=a.constructor,c=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return c;t=o.precision,r=o.rounding,o.precision=t+Math.max(a.e,a.sd())+4,o.rounding=1,i=a.d.length,i<32?(n=Math.ceil(i/3),e=(1/yy(4,n)).toString()):(n=16,e="2.3283064365386962890625e-10"),a=Cd(o,1,a.times(e),new o(1),!0);for(var u,d=n,h=new o(8);d--;)u=a.times(a),a=c.minus(u.times(h.minus(u.times(h))));return He(a,o.precision=t,o.rounding=r,!0)};Se.hyperbolicSine=Se.sinh=function(){var n,e,t,r,i=this,a=i.constructor;if(!i.isFinite()||i.isZero())return new a(i);if(e=a.precision,t=a.rounding,a.precision=e+Math.max(i.e,i.sd())+4,a.rounding=1,r=i.d.length,r<3)i=Cd(a,2,i,i,!0);else{n=1.4*Math.sqrt(r),n=n>16?16:n|0,i=i.times(1/yy(5,n)),i=Cd(a,2,i,i,!0);for(var o,c=new a(5),u=new a(16),d=new a(20);n--;)o=i.times(i),i=i.times(c.plus(o.times(u.times(o).plus(d))))}return a.precision=e,a.rounding=t,He(i,e,t,!0)};Se.hyperbolicTangent=Se.tanh=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+7,r.rounding=1,Xt(t.sinh(),t.cosh(),r.precision=n,r.rounding=e)):new r(t.s)};Se.inverseCosine=Se.acos=function(){var n=this,e=n.constructor,t=n.abs().cmp(1),r=e.precision,i=e.rounding;return t!==-1?t===0?n.isNeg()?Oa(e,r,i):new e(0):new e(NaN):n.isZero()?Oa(e,r+4,i).times(.5):(e.precision=r+6,e.rounding=1,n=new e(1).minus(n).div(n.plus(1)).sqrt().atan(),e.precision=r,e.rounding=i,n.times(2))};Se.inverseHyperbolicCosine=Se.acosh=function(){var n,e,t=this,r=t.constructor;return t.lte(1)?new r(t.eq(1)?0:NaN):t.isFinite()?(n=r.precision,e=r.rounding,r.precision=n+Math.max(Math.abs(t.e),t.sd())+4,r.rounding=1,rt=!1,t=t.times(t).minus(1).sqrt().plus(t),rt=!0,r.precision=n,r.rounding=e,t.ln()):new r(t)};Se.inverseHyperbolicSine=Se.asinh=function(){var n,e,t=this,r=t.constructor;return!t.isFinite()||t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+2*Math.max(Math.abs(t.e),t.sd())+6,r.rounding=1,rt=!1,t=t.times(t).plus(1).sqrt().plus(t),rt=!0,r.precision=n,r.rounding=e,t.ln())};Se.inverseHyperbolicTangent=Se.atanh=function(){var n,e,t,r,i=this,a=i.constructor;return i.isFinite()?i.e>=0?new a(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(n=a.precision,e=a.rounding,r=i.sd(),Math.max(r,n)<2*-i.e-1?He(new a(i),n,e,!0):(a.precision=t=r-i.e,i=Xt(i.plus(1),new a(1).minus(i),t+n,1),a.precision=n+4,a.rounding=1,i=i.ln(),a.precision=n,a.rounding=e,i.times(.5))):new a(NaN)};Se.inverseSine=Se.asin=function(){var n,e,t,r,i=this,a=i.constructor;return i.isZero()?new a(i):(e=i.abs().cmp(1),t=a.precision,r=a.rounding,e!==-1?e===0?(n=Oa(a,t+4,r).times(.5),n.s=i.s,n):new a(NaN):(a.precision=t+6,a.rounding=1,i=i.div(new a(1).minus(i.times(i)).sqrt().plus(1)).atan(),a.precision=t,a.rounding=r,i.times(2)))};Se.inverseTangent=Se.atan=function(){var n,e,t,r,i,a,o,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding;if(d.isFinite()){if(d.isZero())return new h(d);if(d.abs().eq(1)&&p+4<=ow)return o=Oa(h,p+4,m).times(.25),o.s=d.s,o}else{if(!d.s)return new h(NaN);if(p+4<=ow)return o=Oa(h,p+4,m).times(.5),o.s=d.s,o}for(h.precision=c=p+10,h.rounding=1,t=Math.min(28,c/Ze+2|0),n=t;n;--n)d=d.div(d.times(d).plus(1).sqrt().plus(1));for(rt=!1,e=Math.ceil(c/Ze),r=1,u=d.times(d),o=new h(d),i=d;n!==-1;)if(i=i.times(u),a=o.minus(i.div(r+=2)),i=i.times(u),o=a.plus(i.div(r+=2)),o.d[e]!==void 0)for(n=e;o.d[n]===a.d[n]&&n--;);return t&&(o=o.times(2<<t-1)),rt=!0,He(o,h.precision=p,h.rounding=m,!0)};Se.isFinite=function(){return!!this.d};Se.isInteger=Se.isInt=function(){return!!this.d&&xr(this.e/Ze)>this.d.length-2};Se.isNaN=function(){return!this.s};Se.isNegative=Se.isNeg=function(){return this.s<0};Se.isPositive=Se.isPos=function(){return this.s>0};Se.isZero=function(){return!!this.d&&this.d[0]===0};Se.lessThan=Se.lt=function(n){return this.cmp(n)<0};Se.lessThanOrEqualTo=Se.lte=function(n){return this.cmp(n)<1};Se.logarithm=Se.log=function(n){var e,t,r,i,a,o,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding,b=5;if(n==null)n=new h(10),e=!0;else{if(n=new h(n),t=n.d,n.s<0||!t||!t[0]||n.eq(1))return new h(NaN);e=n.eq(10)}if(t=d.d,d.s<0||!t||!t[0]||d.eq(1))return new h(t&&!t[0]?-1/0:d.s!=1?NaN:t?0:1/0);if(e)if(t.length>1)a=!0;else{for(i=t[0];i%10===0;)i/=10;a=i!==1}if(rt=!1,c=p+b,o=Bo(d,c),r=e?xv(h,c+10):Bo(n,c),u=Xt(o,r,c,1),pp(u.d,i=p,m))do if(c+=10,o=Bo(d,c),r=e?xv(h,c+10):Bo(n,c),u=Xt(o,r,c,1),!a){+ur(u.d).slice(i+1,i+15)+1==1e14&&(u=He(u,p+1,0));break}while(pp(u.d,i+=10,m));return rt=!0,He(u,p,m)};Se.minus=Se.sub=function(n){var e,t,r,i,a,o,c,u,d,h,p,m,b=this,_=b.constructor;if(n=new _(n),!b.d||!n.d)return!b.s||!n.s?n=new _(NaN):b.d?n.s=-n.s:n=new _(n.d||b.s!==n.s?b:NaN),n;if(b.s!=n.s)return n.s=-n.s,b.plus(n);if(d=b.d,m=n.d,c=_.precision,u=_.rounding,!d[0]||!m[0]){if(m[0])n.s=-n.s;else if(d[0])n=new _(b);else return new _(u===3?-0:0);return rt?He(n,c,u):n}if(t=xr(n.e/Ze),h=xr(b.e/Ze),d=d.slice(),a=h-t,a){for(p=a<0,p?(e=d,a=-a,o=m.length):(e=m,t=h,o=d.length),r=Math.max(Math.ceil(c/Ze),o)+2,a>r&&(a=r,e.length=1),e.reverse(),r=a;r--;)e.push(0);e.reverse()}else{for(r=d.length,o=m.length,p=r<o,p&&(o=r),r=0;r<o;r++)if(d[r]!=m[r]){p=d[r]<m[r];break}a=0}for(p&&(e=d,d=m,m=e,n.s=-n.s),o=d.length,r=m.length-o;r>0;--r)d[o++]=0;for(r=m.length;r>a;){if(d[--r]<m[r]){for(i=r;i&&d[--i]===0;)d[i]=ra-1;--d[i],d[r]+=ra}d[r]-=m[r]}for(;d[--o]===0;)d.pop();for(;d[0]===0;d.shift())--t;return d[0]?(n.d=d,n.e=vy(d,t),rt?He(n,c,u):n):new _(u===3?-0:0)};Se.modulo=Se.mod=function(n){var e,t=this,r=t.constructor;return n=new r(n),!t.d||!n.s||n.d&&!n.d[0]?new r(NaN):!n.d||t.d&&!t.d[0]?He(new r(t),r.precision,r.rounding):(rt=!1,r.modulo==9?(e=Xt(t,n.abs(),0,3,1),e.s*=n.s):e=Xt(t,n,0,r.modulo,1),e=e.times(n),rt=!0,t.minus(e))};Se.naturalExponential=Se.exp=function(){return lw(this)};Se.naturalLogarithm=Se.ln=function(){return Bo(this)};Se.negated=Se.neg=function(){var n=new this.constructor(this);return n.s=-n.s,He(n)};Se.plus=Se.add=function(n){var e,t,r,i,a,o,c,u,d,h,p=this,m=p.constructor;if(n=new m(n),!p.d||!n.d)return!p.s||!n.s?n=new m(NaN):p.d||(n=new m(n.d||p.s===n.s?p:NaN)),n;if(p.s!=n.s)return n.s=-n.s,p.minus(n);if(d=p.d,h=n.d,c=m.precision,u=m.rounding,!d[0]||!h[0])return h[0]||(n=new m(p)),rt?He(n,c,u):n;if(a=xr(p.e/Ze),r=xr(n.e/Ze),d=d.slice(),i=a-r,i){for(i<0?(t=d,i=-i,o=h.length):(t=h,r=a,o=d.length),a=Math.ceil(c/Ze),o=a>o?a+1:o+1,i>o&&(i=o,t.length=1),t.reverse();i--;)t.push(0);t.reverse()}for(o=d.length,i=h.length,o-i<0&&(i=o,t=h,h=d,d=t),e=0;i;)e=(d[--i]=d[i]+h[i]+e)/ra|0,d[i]%=ra;for(e&&(d.unshift(e),++r),o=d.length;d[--o]==0;)d.pop();return n.d=d,n.e=vy(d,r),rt?He(n,c,u):n};Se.precision=Se.sd=function(n){var e,t=this;if(n!==void 0&&n!==!!n&&n!==1&&n!==0)throw Error(al+n);return t.d?(e=R5(t.d),n&&t.e+1>e&&(e=t.e+1)):e=NaN,e};Se.round=function(){var n=this,e=n.constructor;return He(new e(n),n.e+1,e.rounding)};Se.sine=Se.sin=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+Ze,r.rounding=1,t=ite(r,M5(r,t)),r.precision=n,r.rounding=e,He(ws>2?t.neg():t,n,e,!0)):new r(NaN)};Se.squareRoot=Se.sqrt=function(){var n,e,t,r,i,a,o=this,c=o.d,u=o.e,d=o.s,h=o.constructor;if(d!==1||!c||!c[0])return new h(!d||d<0&&(!c||c[0])?NaN:c?o:1/0);for(rt=!1,d=Math.sqrt(+o),d==0||d==1/0?(e=ur(c),(e.length+u)%2==0&&(e+="0"),d=Math.sqrt(e),u=xr((u+1)/2)-(u<0||u%2),d==1/0?e="5e"+u:(e=d.toExponential(),e=e.slice(0,e.indexOf("e")+1)+u),r=new h(e)):r=new h(d.toString()),t=(u=h.precision)+3;;)if(a=r,r=a.plus(Xt(o,a,t+2,1)).times(.5),ur(a.d).slice(0,t)===(e=ur(r.d)).slice(0,t))if(e=e.slice(t-3,t+1),e=="9999"||!i&&e=="4999"){if(!i&&(He(a,u+1,0),a.times(a).eq(o))){r=a;break}t+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(He(r,u+1,1),n=!r.times(r).eq(o));break}return rt=!0,He(r,u,h.rounding,n)};Se.tangent=Se.tan=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+10,r.rounding=1,t=t.sin(),t.s=1,t=Xt(t,new r(1).minus(t.times(t)).sqrt(),n+10,0),r.precision=n,r.rounding=e,He(ws==2||ws==4?t.neg():t,n,e,!0)):new r(NaN)};Se.times=Se.mul=function(n){var e,t,r,i,a,o,c,u,d,h=this,p=h.constructor,m=h.d,b=(n=new p(n)).d;if(n.s*=h.s,!m||!m[0]||!b||!b[0])return new p(!n.s||m&&!m[0]&&!b||b&&!b[0]&&!m?NaN:!m||!b?n.s/0:n.s*0);for(t=xr(h.e/Ze)+xr(n.e/Ze),u=m.length,d=b.length,u<d&&(a=m,m=b,b=a,o=u,u=d,d=o),a=[],o=u+d,r=o;r--;)a.push(0);for(r=d;--r>=0;){for(e=0,i=u+r;i>r;)c=a[i]+b[r]*m[i-r-1]+e,a[i--]=c%ra|0,e=c/ra|0;a[i]=(a[i]+e)%ra|0}for(;!a[--o];)a.pop();return e?++t:a.shift(),n.d=a,n.e=vy(a,t),rt?He(n,p.precision,p.rounding):n};Se.toBinary=function(n,e){return qS(this,2,n,e)};Se.toDecimalPlaces=Se.toDP=function(n,e){var t=this,r=t.constructor;return t=new r(t),n===void 0?t:($r(n,0,dl),e===void 0?e=r.rounding:$r(e,0,8),He(t,n+t.e+1,e))};Se.toExponential=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=Ha(r,!0):($r(n,0,dl),e===void 0?e=i.rounding:$r(e,0,8),r=He(new i(r),n+1,e),t=Ha(r,!0,n+1)),r.isNeg()&&!r.isZero()?"-"+t:t};Se.toFixed=function(n,e){var t,r,i=this,a=i.constructor;return n===void 0?t=Ha(i):($r(n,0,dl),e===void 0?e=a.rounding:$r(e,0,8),r=He(new a(i),n+i.e+1,e),t=Ha(r,!1,n+r.e+1)),i.isNeg()&&!i.isZero()?"-"+t:t};Se.toFraction=function(n){var e,t,r,i,a,o,c,u,d,h,p,m,b=this,_=b.d,w=b.constructor;if(!_)return new w(b);if(d=t=new w(1),r=u=new w(0),e=new w(r),a=e.e=R5(_)-b.e-1,o=a%Ze,e.d[0]=$n(10,o<0?Ze+o:o),n==null)n=a>0?e:d;else{if(c=new w(n),!c.isInt()||c.lt(d))throw Error(al+c);n=c.gt(e)?a>0?e:d:c}for(rt=!1,c=new w(ur(_)),h=w.precision,w.precision=a=_.length*Ze*2;p=Xt(c,e,0,1,1),i=t.plus(p.times(r)),i.cmp(n)!=1;)t=r,r=i,i=d,d=u.plus(p.times(i)),u=i,i=e,e=c.minus(p.times(i)),c=i;return i=Xt(n.minus(t),r,0,1,1),u=u.plus(i.times(d)),t=t.plus(i.times(r)),u.s=d.s=b.s,m=Xt(d,r,a,1).minus(b).abs().cmp(Xt(u,t,a,1).minus(b).abs())<1?[d,r]:[u,t],w.precision=h,rt=!0,m};Se.toHexadecimal=Se.toHex=function(n,e){return qS(this,16,n,e)};Se.toNearest=function(n,e){var t=this,r=t.constructor;if(t=new r(t),n==null){if(!t.d)return t;n=new r(1),e=r.rounding}else{if(n=new r(n),e===void 0?e=r.rounding:$r(e,0,8),!t.d)return n.s?t:n;if(!n.d)return n.s&&(n.s=t.s),n}return n.d[0]?(rt=!1,t=Xt(t,n,0,e,1).times(n),rt=!0,He(t)):(n.s=t.s,t=n),t};Se.toNumber=function(){return+this};Se.toOctal=function(n,e){return qS(this,8,n,e)};Se.toPower=Se.pow=function(n){var e,t,r,i,a,o,c=this,u=c.constructor,d=+(n=new u(n));if(!c.d||!n.d||!c.d[0]||!n.d[0])return new u($n(+c,d));if(c=new u(c),c.eq(1))return c;if(r=u.precision,a=u.rounding,n.eq(1))return He(c,r,a);if(e=xr(n.e/Ze),e>=n.d.length-1&&(t=d<0?-d:d)<=ete)return i=D5(u,c,t,r),n.s<0?new u(1).div(i):He(i,r,a);if(o=c.s,o<0){if(e<n.d.length-1)return new u(NaN);if((n.d[e]&1)==0&&(o=1),c.e==0&&c.d[0]==1&&c.d.length==1)return c.s=o,c}return t=$n(+c,d),e=t==0||!isFinite(t)?xr(d*(Math.log("0."+ur(c.d))/Math.LN10+c.e+1)):new u(t+"").e,e>u.maxE+1||e<u.minE-1?new u(e>0?o/0:0):(rt=!1,u.rounding=c.s=1,t=Math.min(12,(e+"").length),i=lw(n.times(Bo(c,r+t)),r),i.d&&(i=He(i,r+5,1),pp(i.d,r,a)&&(e=r+10,i=He(lw(n.times(Bo(c,e+t)),e),e+5,1),+ur(i.d).slice(r+1,r+15)+1==1e14&&(i=He(i,r+1,0)))),i.s=o,rt=!0,u.rounding=a,He(i,r,a))};Se.toPrecision=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=Ha(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):($r(n,1,dl),e===void 0?e=i.rounding:$r(e,0,8),r=He(new i(r),n,e),t=Ha(r,n<=r.e||r.e<=i.toExpNeg,n)),r.isNeg()&&!r.isZero()?"-"+t:t};Se.toSignificantDigits=Se.toSD=function(n,e){var t=this,r=t.constructor;return n===void 0?(n=r.precision,e=r.rounding):($r(n,1,dl),e===void 0?e=r.rounding:$r(e,0,8)),He(new r(t),n,e)};Se.toString=function(){var n=this,e=n.constructor,t=Ha(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()&&!n.isZero()?"-"+t:t};Se.truncated=Se.trunc=function(){return He(new this.constructor(this),this.e+1,1)};Se.valueOf=Se.toJSON=function(){var n=this,e=n.constructor,t=Ha(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()?"-"+t:t};function ur(n){var e,t,r,i=n.length-1,a="",o=n[0];if(i>0){for(a+=o,e=1;e<i;e++)r=n[e]+"",t=Ze-r.length,t&&(a+=Do(t)),a+=r;o=n[e],r=o+"",t=Ze-r.length,t&&(a+=Do(t))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}function $r(n,e,t){if(n!==~~n||n<e||n>t)throw Error(al+n)}function pp(n,e,t,r){var i,a,o,c;for(a=n[0];a>=10;a/=10)--e;return--e<0?(e+=Ze,i=0):(i=Math.ceil((e+1)/Ze),e%=Ze),a=$n(10,Ze-e),c=n[i]%a|0,r==null?e<3?(e==0?c=c/100|0:e==1&&(c=c/10|0),o=t<4&&c==99999||t>3&&c==49999||c==5e4||c==0):o=(t<4&&c+1==a||t>3&&c+1==a/2)&&(n[i+1]/a/100|0)==$n(10,e-2)-1||(c==a/2||c==0)&&(n[i+1]/a/100|0)==0:e<4?(e==0?c=c/1e3|0:e==1?c=c/100|0:e==2&&(c=c/10|0),o=(r||t<4)&&c==9999||!r&&t>3&&c==4999):o=((r||t<4)&&c+1==a||!r&&t>3&&c+1==a/2)&&(n[i+1]/a/1e3|0)==$n(10,e-3)-1,o}function w0(n,e,t){for(var r,i=[0],a,o=0,c=n.length;o<c;){for(a=i.length;a--;)i[a]*=e;for(i[0]+=aw.indexOf(n.charAt(o++)),r=0;r<i.length;r++)i[r]>t-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/t|0,i[r]%=t)}return i.reverse()}function nte(n,e){var t,r,i;if(e.isZero())return e;r=e.d.length,r<32?(t=Math.ceil(r/3),i=(1/yy(4,t)).toString()):(t=16,i="2.3283064365386962890625e-10"),n.precision+=t,e=Cd(n,1,e.times(i),new n(1));for(var a=t;a--;){var o=e.times(e);e=o.times(o).minus(o).times(8).plus(1)}return n.precision-=t,e}var Xt=(function(){function n(r,i,a){var o,c=0,u=r.length;for(r=r.slice();u--;)o=r[u]*i+c,r[u]=o%a|0,c=o/a|0;return c&&r.unshift(c),r}function e(r,i,a,o){var c,u;if(a!=o)u=a>o?1:-1;else for(c=u=0;c<a;c++)if(r[c]!=i[c]){u=r[c]>i[c]?1:-1;break}return u}function t(r,i,a,o){for(var c=0;a--;)r[a]-=c,c=r[a]<i[a]?1:0,r[a]=c*o+r[a]-i[a];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,a,o,c,u){var d,h,p,m,b,_,w,S,T,C,R,O,P,N,A,I,k,z,V,B,j=r.constructor,X=r.s==i.s?1:-1,H=r.d,$=i.d;if(!H||!H[0]||!$||!$[0])return new j(!r.s||!i.s||(H?$&&H[0]==$[0]:!$)?NaN:H&&H[0]==0||!$?X*0:X/0);for(u?(b=1,h=r.e-i.e):(u=ra,b=Ze,h=xr(r.e/b)-xr(i.e/b)),V=$.length,k=H.length,T=new j(X),C=T.d=[],p=0;$[p]==(H[p]||0);p++);if($[p]>(H[p]||0)&&h--,a==null?(N=a=j.precision,o=j.rounding):c?N=a+(r.e-i.e)+1:N=a,N<0)C.push(1),_=!0;else{if(N=N/b+2|0,p=0,V==1){for(m=0,$=$[0],N++;(p<k||m)&&N--;p++)A=m*u+(H[p]||0),C[p]=A/$|0,m=A%$|0;_=m||p<k}else{for(m=u/($[0]+1)|0,m>1&&($=n($,m,u),H=n(H,m,u),V=$.length,k=H.length),I=V,R=H.slice(0,V),O=R.length;O<V;)R[O++]=0;B=$.slice(),B.unshift(0),z=$[0],$[1]>=u/2&&++z;do m=0,d=e($,R,V,O),d<0?(P=R[0],V!=O&&(P=P*u+(R[1]||0)),m=P/z|0,m>1?(m>=u&&(m=u-1),w=n($,m,u),S=w.length,O=R.length,d=e(w,R,S,O),d==1&&(m--,t(w,V<S?B:$,S,u))):(m==0&&(d=m=1),w=$.slice()),S=w.length,S<O&&w.unshift(0),t(R,w,O,u),d==-1&&(O=R.length,d=e($,R,V,O),d<1&&(m++,t(R,V<O?B:$,O,u))),O=R.length):d===0&&(m++,R=[0]),C[p++]=m,d&&R[0]?R[O++]=H[I]||0:(R=[H[I]],O=1);while((I++<k||R[0]!==void 0)&&N--);_=R[0]!==void 0}C[0]||C.shift()}if(b==1)T.e=h,S5=_;else{for(p=1,m=C[0];m>=10;m/=10)p++;T.e=p+h*b-1,He(T,c?a+T.e+1:a,o,_)}return T}})();function He(n,e,t,r){var i,a,o,c,u,d,h,p,m,b=n.constructor;e:if(e!=null){if(p=n.d,!p)return n;for(i=1,c=p[0];c>=10;c/=10)i++;if(a=e-i,a<0)a+=Ze,o=e,h=p[m=0],u=h/$n(10,i-o-1)%10|0;else if(m=Math.ceil((a+1)/Ze),c=p.length,m>=c)if(r){for(;c++<=m;)p.push(0);h=u=0,i=1,a%=Ze,o=a-Ze+1}else break e;else{for(h=c=p[m],i=1;c>=10;c/=10)i++;a%=Ze,o=a-Ze+i,u=o<0?0:h/$n(10,i-o-1)%10|0}if(r=r||e<0||p[m+1]!==void 0||(o<0?h:h%$n(10,i-o-1)),d=t<4?(u||r)&&(t==0||t==(n.s<0?3:2)):u>5||u==5&&(t==4||r||t==6&&(a>0?o>0?h/$n(10,i-o):0:p[m-1])%10&1||t==(n.s<0?8:7)),e<1||!p[0])return p.length=0,d?(e-=n.e+1,p[0]=$n(10,(Ze-e%Ze)%Ze),n.e=-e||0):p[0]=n.e=0,n;if(a==0?(p.length=m,c=1,m--):(p.length=m+1,c=$n(10,Ze-a),p[m]=o>0?(h/$n(10,i-o)%$n(10,o)|0)*c:0),d)for(;;)if(m==0){for(a=1,o=p[0];o>=10;o/=10)a++;for(o=p[0]+=c,c=1;o>=10;o/=10)c++;a!=c&&(n.e++,p[0]==ra&&(p[0]=1));break}else{if(p[m]+=c,p[m]!=ra)break;p[m--]=0,c=1}for(a=p.length;p[--a]===0;)p.pop()}return rt&&(n.e>b.maxE?(n.d=null,n.e=NaN):n.e<b.minE&&(n.e=0,n.d=[0])),n}function Ha(n,e,t){if(!n.isFinite())return N5(n);var r,i=n.e,a=ur(n.d),o=a.length;return e?(t&&(r=t-o)>0?a=a.charAt(0)+"."+a.slice(1)+Do(r):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(n.e<0?"e":"e+")+n.e):i<0?(a="0."+Do(-i-1)+a,t&&(r=t-o)>0&&(a+=Do(r))):i>=o?(a+=Do(i+1-o),t&&(r=t-i-1)>0&&(a=a+"."+Do(r))):((r=i+1)<o&&(a=a.slice(0,r)+"."+a.slice(r)),t&&(r=t-o)>0&&(i+1===o&&(a+="."),a+=Do(r))),a}function vy(n,e){var t=n[0];for(e*=Ze;t>=10;t/=10)e++;return e}function xv(n,e,t){if(e>tte)throw rt=!0,t&&(n.precision=t),Error(T5);return He(new n(yv),e,1,!0)}function Oa(n,e,t){if(e>ow)throw Error(T5);return He(new n(bv),e,t,!0)}function R5(n){var e=n.length-1,t=e*Ze+1;if(e=n[e],e){for(;e%10==0;e/=10)t--;for(e=n[0];e>=10;e/=10)t++}return t}function Do(n){for(var e="";n--;)e+="0";return e}function D5(n,e,t,r){var i,a=new n(1),o=Math.ceil(r/Ze+4);for(rt=!1;;){if(t%2&&(a=a.times(e),Xk(a.d,o)&&(i=!0)),t=xr(t/2),t===0){t=a.d.length-1,i&&a.d[t]===0&&++a.d[t];break}e=e.times(e),Xk(e.d,o)}return rt=!0,a}function Kk(n){return n.d[n.d.length-1]&1}function k5(n,e,t){for(var r,i,a=new n(e[0]),o=0;++o<e.length;){if(i=new n(e[o]),!i.s){a=i;break}r=a.cmp(i),(r===t||r===0&&a.s===t)&&(a=i)}return a}function lw(n,e){var t,r,i,a,o,c,u,d=0,h=0,p=0,m=n.constructor,b=m.rounding,_=m.precision;if(!n.d||!n.d[0]||n.e>17)return new m(n.d?n.d[0]?n.s<0?0:1/0:1:n.s?n.s<0?0:n:NaN);for(e==null?(rt=!1,u=_):u=e,c=new m(.03125);n.e>-2;)n=n.times(c),p+=5;for(r=Math.log($n(2,p))/Math.LN10*2+5|0,u+=r,t=a=o=new m(1),m.precision=u;;){if(a=He(a.times(n),u,1),t=t.times(++h),c=o.plus(Xt(a,t,u,1)),ur(c.d).slice(0,u)===ur(o.d).slice(0,u)){for(i=p;i--;)o=He(o.times(o),u,1);if(e==null)if(d<3&&pp(o.d,u-r,b,d))m.precision=u+=10,t=a=c=new m(1),h=0,d++;else return He(o,m.precision=_,b,rt=!0);else return m.precision=_,o}o=c}}function Bo(n,e){var t,r,i,a,o,c,u,d,h,p,m,b=1,_=10,w=n,S=w.d,T=w.constructor,C=T.rounding,R=T.precision;if(w.s<0||!S||!S[0]||!w.e&&S[0]==1&&S.length==1)return new T(S&&!S[0]?-1/0:w.s!=1?NaN:S?0:w);if(e==null?(rt=!1,h=R):h=e,T.precision=h+=_,t=ur(S),r=t.charAt(0),Math.abs(a=w.e)<15e14){for(;r<7&&r!=1||r==1&&t.charAt(1)>3;)w=w.times(n),t=ur(w.d),r=t.charAt(0),b++;a=w.e,r>1?(w=new T("0."+t),a++):w=new T(r+"."+t.slice(1))}else return d=xv(T,h+2,R).times(a+""),w=Bo(new T(r+"."+t.slice(1)),h-_).plus(d),T.precision=R,e==null?He(w,R,C,rt=!0):w;for(p=w,u=o=w=Xt(w.minus(1),w.plus(1),h,1),m=He(w.times(w),h,1),i=3;;){if(o=He(o.times(m),h,1),d=u.plus(Xt(o,new T(i),h,1)),ur(d.d).slice(0,h)===ur(u.d).slice(0,h))if(u=u.times(2),a!==0&&(u=u.plus(xv(T,h+2,R).times(a+""))),u=Xt(u,new T(b),h,1),e==null)if(pp(u.d,h-_,C,c))T.precision=h+=_,d=o=w=Xt(p.minus(1),p.plus(1),h,1),m=He(w.times(w),h,1),i=c=1;else return He(u,T.precision=R,C,rt=!0);else return T.precision=R,u;u=d,i+=2}}function N5(n){return String(n.s*n.s/0)}function E0(n,e){var t,r,i;for((t=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(t<0&&(t=r),t+=+e.slice(r+1),e=e.substring(0,r)):t<0&&(t=e.length),r=0;e.charCodeAt(r)===48;r++);for(i=e.length;e.charCodeAt(i-1)===48;--i);if(e=e.slice(r,i),e){if(i-=r,n.e=t=t-r-1,n.d=[],r=(t+1)%Ze,t<0&&(r+=Ze),r<i){for(r&&n.d.push(+e.slice(0,r)),i-=Ze;r<i;)n.d.push(+e.slice(r,r+=Ze));e=e.slice(r),r=Ze-e.length}else r-=i;for(;r--;)e+="0";n.d.push(+e),rt&&(n.e>n.constructor.maxE?(n.d=null,n.e=NaN):n.e<n.constructor.minE&&(n.e=0,n.d=[0]))}else n.e=0,n.d=[0];return n}function rte(n,e){var t,r,i,a,o,c,u,d,h;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),I5.test(e))return E0(n,e)}else if(e==="Infinity"||e==="NaN")return+e||(n.s=NaN),n.e=NaN,n.d=null,n;if(Zee.test(e))t=16,e=e.toLowerCase();else if(Qee.test(e))t=2;else if(Jee.test(e))t=8;else throw Error(al+e);for(a=e.search(/p/i),a>0?(u=+e.slice(a+1),e=e.substring(2,a)):e=e.slice(2),a=e.indexOf("."),o=a>=0,r=n.constructor,o&&(e=e.replace(".",""),c=e.length,a=c-a,i=D5(r,new r(t),a,a*2)),d=w0(e,t,ra),h=d.length-1,a=h;d[a]===0;--a)d.pop();return a<0?new r(n.s*0):(n.e=vy(d,h),n.d=d,rt=!1,o&&(n=Xt(n,i,c*4)),u&&(n=n.times(Math.abs(u)<54?$n(2,u):Id.pow(2,u))),rt=!0,n)}function ite(n,e){var t,r=e.d.length;if(r<3)return e.isZero()?e:Cd(n,2,e,e);t=1.4*Math.sqrt(r),t=t>16?16:t|0,e=e.times(1/yy(5,t)),e=Cd(n,2,e,e);for(var i,a=new n(5),o=new n(16),c=new n(20);t--;)i=e.times(e),e=e.times(a.plus(i.times(o.times(i).minus(c))));return e}function Cd(n,e,t,r,i){var a,o,c,u,d=n.precision,h=Math.ceil(d/Ze);for(rt=!1,u=t.times(t),c=new n(r);;){if(o=Xt(c.times(u),new n(e++*e++),d,1),c=i?r.plus(o):r.minus(o),r=Xt(o.times(u),new n(e++*e++),d,1),o=c.plus(r),o.d[h]!==void 0){for(a=h;o.d[a]===c.d[a]&&a--;);if(a==-1)break}a=c,c=r,r=o,o=a}return rt=!0,o.d.length=h+1,o}function yy(n,e){for(var t=n;--e;)t*=n;return t}function M5(n,e){var t,r=e.s<0,i=Oa(n,n.precision,1),a=i.times(.5);if(e=e.abs(),e.lte(a))return ws=r?4:1,e;if(t=e.divToInt(i),t.isZero())ws=r?3:2;else{if(e=e.minus(t.times(i)),e.lte(a))return ws=Kk(t)?r?2:3:r?4:1,e;ws=Kk(t)?r?1:4:r?3:2}return e.minus(i).abs()}function qS(n,e,t,r){var i,a,o,c,u,d,h,p,m,b=n.constructor,_=t!==void 0;if(_?($r(t,1,dl),r===void 0?r=b.rounding:$r(r,0,8)):(t=b.precision,r=b.rounding),!n.isFinite())h=N5(n);else{for(h=Ha(n),o=h.indexOf("."),_?(i=2,e==16?t=t*4-3:e==8&&(t=t*3-2)):i=e,o>=0&&(h=h.replace(".",""),m=new b(1),m.e=h.length-o,m.d=w0(Ha(m),10,i),m.e=m.d.length),p=w0(h,10,i),a=u=p.length;p[--u]==0;)p.pop();if(!p[0])h=_?"0p+0":"0";else{if(o<0?a--:(n=new b(n),n.d=p,n.e=a,n=Xt(n,m,t,r,0,i),p=n.d,a=n.e,d=S5),o=p[t],c=i/2,d=d||p[t+1]!==void 0,d=r<4?(o!==void 0||d)&&(r===0||r===(n.s<0?3:2)):o>c||o===c&&(r===4||d||r===6&&p[t-1]&1||r===(n.s<0?8:7)),p.length=t,d)for(;++p[--t]>i-1;)p[t]=0,t||(++a,p.unshift(1));for(u=p.length;!p[u-1];--u);for(o=0,h="";o<u;o++)h+=aw.charAt(p[o]);if(_){if(u>1)if(e==16||e==8){for(o=e==16?4:3,--u;u%o;u++)h+="0";for(p=w0(h,i,e),u=p.length;!p[u-1];--u);for(o=1,h="1.";o<u;o++)h+=aw.charAt(p[o])}else h=h.charAt(0)+"."+h.slice(1);h=h+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)h="0"+h;h="0."+h}else if(++a>u)for(a-=u;a--;)h+="0";else a<u&&(h=h.slice(0,a)+"."+h.slice(a))}h=(e==16?"0x":e==2?"0b":e==8?"0o":"")+h}return n.s<0?"-"+h:h}function Xk(n,e){if(n.length>e)return n.length=e,!0}function ate(n){return new this(n).abs()}function ste(n){return new this(n).acos()}function ote(n){return new this(n).acosh()}function lte(n,e){return new this(n).plus(e)}function cte(n){return new this(n).asin()}function ute(n){return new this(n).asinh()}function dte(n){return new this(n).atan()}function fte(n){return new this(n).atanh()}function hte(n,e){n=new this(n),e=new this(e);var t,r=this.precision,i=this.rounding,a=r+4;return!n.s||!e.s?t=new this(NaN):!n.d&&!e.d?(t=Oa(this,a,1).times(e.s>0?.25:.75),t.s=n.s):!e.d||n.isZero()?(t=e.s<0?Oa(this,r,i):new this(0),t.s=n.s):!n.d||e.isZero()?(t=Oa(this,a,1).times(.5),t.s=n.s):e.s<0?(this.precision=a,this.rounding=1,t=this.atan(Xt(n,e,a,1)),e=Oa(this,a,1),this.precision=r,this.rounding=i,t=n.s<0?t.minus(e):t.plus(e)):t=this.atan(Xt(n,e,a,1)),t}function pte(n){return new this(n).cbrt()}function gte(n){return He(n=new this(n),n.e+1,2)}function mte(n,e,t){return new this(n).clamp(e,t)}function vte(n){if(!n||typeof n!="object")throw Error(my+"Object expected");var e,t,r,i=n.defaults===!0,a=["precision",1,dl,"rounding",0,8,"toExpNeg",-Wu,0,"toExpPos",0,Wu,"maxE",0,Wu,"minE",-Wu,0,"modulo",0,9];for(e=0;e<a.length;e+=3)if(t=a[e],i&&(this[t]=sw[t]),(r=n[t])!==void 0)if(xr(r)===r&&r>=a[e+1]&&r<=a[e+2])this[t]=r;else throw Error(al+t+": "+r);if(t="crypto",i&&(this[t]=sw[t]),(r=n[t])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[t]=!0;else throw Error(A5);else this[t]=!1;else throw Error(al+t+": "+r);return this}function yte(n){return new this(n).cos()}function bte(n){return new this(n).cosh()}function P5(n){var e,t,r;function i(a){var o,c,u,d=this;if(!(d instanceof i))return new i(a);if(d.constructor=i,Wk(a)){d.s=a.s,rt?!a.d||a.e>i.maxE?(d.e=NaN,d.d=null):a.e<i.minE?(d.e=0,d.d=[0]):(d.e=a.e,d.d=a.d.slice()):(d.e=a.e,d.d=a.d?a.d.slice():a.d);return}if(u=typeof a,u==="number"){if(a===0){d.s=1/a<0?-1:1,d.e=0,d.d=[0];return}if(a<0?(a=-a,d.s=-1):d.s=1,a===~~a&&a<1e7){for(o=0,c=a;c>=10;c/=10)o++;rt?o>i.maxE?(d.e=NaN,d.d=null):o<i.minE?(d.e=0,d.d=[0]):(d.e=o,d.d=[a]):(d.e=o,d.d=[a]);return}if(a*0!==0){a||(d.s=NaN),d.e=NaN,d.d=null;return}return E0(d,a.toString())}if(u==="string")return(c=a.charCodeAt(0))===45?(a=a.slice(1),d.s=-1):(c===43&&(a=a.slice(1)),d.s=1),I5.test(a)?E0(d,a):rte(d,a);if(u==="bigint")return a<0?(a=-a,d.s=-1):d.s=1,E0(d,a.toString());throw Error(al+a)}if(i.prototype=Se,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=vte,i.clone=P5,i.isDecimal=Wk,i.abs=ate,i.acos=ste,i.acosh=ote,i.add=lte,i.asin=cte,i.asinh=ute,i.atan=dte,i.atanh=fte,i.atan2=hte,i.cbrt=pte,i.ceil=gte,i.clamp=mte,i.cos=yte,i.cosh=bte,i.div=xte,i.exp=_te,i.floor=wte,i.hypot=Ete,i.ln=Ste,i.log=Tte,i.log10=Cte,i.log2=Ate,i.max=Ite,i.min=Rte,i.mod=Dte,i.mul=kte,i.pow=Nte,i.random=Mte,i.round=Pte,i.sign=Ote,i.sin=jte,i.sinh=Vte,i.sqrt=zte,i.sub=Lte,i.sum=Bte,i.tan=Ute,i.tanh=Fte,i.trunc=Gte,n===void 0&&(n={}),n&&n.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<r.length;)n.hasOwnProperty(t=r[e++])||(n[t]=this[t]);return i.config(n),i}function xte(n,e){return new this(n).div(e)}function _te(n){return new this(n).exp()}function wte(n){return He(n=new this(n),n.e+1,3)}function Ete(){var n,e,t=new this(0);for(rt=!1,n=0;n<arguments.length;)if(e=new this(arguments[n++]),e.d)t.d&&(t=t.plus(e.times(e)));else{if(e.s)return rt=!0,new this(1/0);t=e}return rt=!0,t.sqrt()}function Wk(n){return n instanceof Id||n&&n.toStringTag===C5||!1}function Ste(n){return new this(n).ln()}function Tte(n,e){return new this(n).log(e)}function Ate(n){return new this(n).log(2)}function Cte(n){return new this(n).log(10)}function Ite(){return k5(this,arguments,-1)}function Rte(){return k5(this,arguments,1)}function Dte(n,e){return new this(n).mod(e)}function kte(n,e){return new this(n).mul(e)}function Nte(n,e){return new this(n).pow(e)}function Mte(n){var e,t,r,i,a=0,o=new this(1),c=[];if(n===void 0?n=this.precision:$r(n,1,dl),r=Math.ceil(n/Ze),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));a<r;)i=e[a],i>=429e7?e[a]=crypto.getRandomValues(new Uint32Array(1))[0]:c[a++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(r*=4);a<r;)i=e[a]+(e[a+1]<<8)+(e[a+2]<<16)+((e[a+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(e,a):(c.push(i%1e7),a+=4);a=r/4}else throw Error(A5);else for(;a<r;)c[a++]=Math.random()*1e7|0;for(r=c[--a],n%=Ze,r&&n&&(i=$n(10,Ze-n),c[a]=(r/i|0)*i);c[a]===0;a--)c.pop();if(a<0)t=0,c=[0];else{for(t=-1;c[0]===0;t-=Ze)c.shift();for(r=1,i=c[0];i>=10;i/=10)r++;r<Ze&&(t-=Ze-r)}return o.e=t,o.d=c,o}function Pte(n){return He(n=new this(n),n.e+1,this.rounding)}function Ote(n){return n=new this(n),n.d?n.d[0]?n.s:0*n.s:n.s||NaN}function jte(n){return new this(n).sin()}function Vte(n){return new this(n).sinh()}function zte(n){return new this(n).sqrt()}function Lte(n,e){return new this(n).sub(e)}function Bte(){var n=0,e=arguments,t=new this(e[n]);for(rt=!1;t.s&&++n<e.length;)t=t.plus(e[n]);return rt=!0,He(t,this.precision,this.rounding)}function Ute(n){return new this(n).tan()}function Fte(n){return new this(n).tanh()}function Gte(n){return He(n=new this(n),n.e+1,1)}Se[Symbol.for("nodejs.util.inspect.custom")]=Se.toString;Se[Symbol.toStringTag]="Decimal";var Id=Se.constructor=P5(sw);yv=new Id(yv);bv=new Id(bv);const Qk=n=>{if(!n)return null;if(n instanceof Date)return n;if(typeof n=="object"&&typeof n.toDate=="function")return n.toDate();if(typeof n=="object"&&n.seconds!==void 0)return new Date(n.seconds*1e3);if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?null:e}if(typeof n=="number"){const e=new Date(n);return isNaN(e.getTime())?null:e}return null},qte=()=>{const{envelopes:n,transactions:e,fetchData:t,isLoading:r,isOnline:i,reorderEnvelopes:a}=un(),{currentUser:o}=ea(),{currentMonth:c,incomeSources:u,allocations:d,deleteIncomeSource:h,setEnvelopeAllocation:p,copyPreviousMonthAllocations:m,isLoading:b}=un(),{showToast:_}=jc(),[w,S]=U.useState(!1),T=U.useRef(null),[C,R]=U.useState(!1),O=!C||r||b,[P,N]=U.useState([]),A=U.useRef([]),[I,k]=U.useState([]),z=U.useRef([]),V=U.useCallback(re=>{if(n.find(fe=>fe.id===re)?.isPiggybank){const fe=un.getState().getEnvelopeBalance(re);return new Id(fe)}const oe=un.getState().getEnvelopeBalance(re,c);return new Id(oe)},[n,c]);U.useEffect(()=>{const re=n.filter(Z=>{if(!Z.isPiggybank||!Z.isActive)return!1;if(Z.createdAt)try{const oe=Qk(Z.createdAt);if(!oe)return console.error(` Invalid creation date for piggybank ${Z.name}:`,Z.createdAt),!1;const fe=`${oe.getFullYear()}-${String(oe.getMonth()+1).padStart(2,"0")}`;return c>=fe}catch(oe){return console.error(` Error processing piggybank ${Z.name}:`,oe,{createdAt:Z.createdAt,typeofCreatedAt:typeof Z.createdAt}),!1}return!0}).sort((Z,oe)=>{const fe=Z.orderIndex??0,be=oe.orderIndex??0;return fe-be});k(re),z.current=re},[n,c]);const B=I,j=P;U.useEffect(()=>(T.current=setTimeout(()=>{S(!0)},8e3),t(),R(!0),()=>{T.current&&clearTimeout(T.current)}),[]),U.useEffect(()=>{C&&!r&&!b&&(S(!1),T.current&&clearTimeout(T.current))},[C,r,b]),U.useEffect(()=>{const re=n.filter(Z=>{if(Z.isPiggybank||Z.isActive===!1)return!1;const fe=(d[c]||[]).some(Ce=>Ce.envelopeId===Z.id),be=e.some(Ce=>Ce.envelopeId===Z.id&&(Ce.month===c||Ce.date.startsWith(c)));return fe||be}).sort((Z,oe)=>{const fe=Z.orderIndex??0,be=oe.orderIndex??0;return fe-be});N(re),A.current=re},[n,d,c,e]);const X=(u[c]||[]).reduce((re,Z)=>re+Z.amount,0),H=(d[c]||[]).filter(re=>j.some(Z=>Z.id===re.envelopeId)||B.some(Z=>Z.id===re.envelopeId)).reduce((re,Z)=>re+Z.budgetedAmount,0),$=X-H,W=U.useCallback(async re=>{if(!re.length)return;const Z=re.map(oe=>oe.id);try{await a(Z)}catch(oe){console.error("Failed to persist envelope order:",oe),_("Failed to save envelope order","error")}},[a,_]),ee=U.useCallback(async re=>{await W(re)},[W]),he=U.useCallback(re=>{h(c,re.id).catch(console.error),_(`Deleted "${re.name}"`,"neutral")},[h,c,_]),K=U.useCallback(async re=>{try{const Z=re||c;console.log(" Copying to month:",Z),await m(Z),_("Previous month budget copied","success")}catch(Z){console.error("Error copying previous month:",Z),_("Failed to copy previous month","error")}},[m,_,c]),G=U.useCallback(async()=>{if(!o||!c){_("Cannot clear data: not logged in or no month selected","error");return}try{await un.getState().clearMonthData(c),_(`"${c}" budget and transactions cleared successfully`,"success")}catch(re){console.error("Error clearing month data:",re),_("Failed to clear month data","error")}},[o,c,_]),Y=U.useCallback(async(re,Z)=>{try{await p(re,Z),setTimeout(()=>{const oe=un.getState(),fe=oe.currentMonth,be=oe.incomeSources[fe]||[],Ce=oe.allocations[fe]||[],we=new Set(oe.envelopes.filter(ze=>{if(ze.isPiggybank){if(!ze.isActive)return!1;if(ze.createdAt){const Ne=Qk(ze.createdAt);if(!Ne)return!1;const qe=`${Ne.getFullYear()}-${String(Ne.getMonth()+1).padStart(2,"0")}`;return fe>=qe}return!0}return ze.isActive!==!1}).map(ze=>ze.id)),Pe=Ce.filter(ze=>we.has(ze.envelopeId)),ue=be.reduce((ze,Ne)=>ze+Ne.amount,0),_e=Pe.reduce((ze,Ne)=>ze+Ne.budgetedAmount,0);ue-_e<-.005?_(`You can't spend more than you make.
You're not in Congress!`,"error"):Math.abs(ue-_e)<.005&&ue>0&&_("Every dollar has a job ","success")},100)}catch(oe){console.error("Failed to set allocation:",oe),_("Failed to update budget","error")}},[p,_]);return{visibleEnvelopes:j,piggybanks:B,incomeSources:u,availableToBudget:$,currentMonth:c,allocations:d,transactions:e,isLoading:r,isInitialLoading:O,isOnline:i,showTimeoutMessage:w,getEnvelopeBalance:V,fetchData:t,reorderEnvelopes:ee,deleteIncomeSource:he,clearMonthData:G,copyFromPreviousMonth:K,setEnvelopeAllocation:Y,localOrderRef:A,setLocalEnvelopes:N,localPiggybankOrderRef:z,setLocalPiggybanks:k}},$te=({currentMonth:n,onMonthChange:e,budgetStatus:t})=>{const[r,i]=n.split("-").map(Number),o=["January","February","March","April","May","June","July","August","September","October","November","December"][i-1],c=()=>{let p=r,m=i-1;m<1&&(p=r-1,m=12);const b=`${p}-${m.toString().padStart(2,"0")}`;e(b)},u=()=>{let p=r,m=i+1;m>12&&(p=r+1,m=1);const b=`${p}-${m.toString().padStart(2,"0")}`;e(b)},d=()=>{const p=new Date,m=`${p.getFullYear()}-${(p.getMonth()+1).toString().padStart(2,"0")}`;e(m)},h=()=>{if(!t)return null;const{amount:p,totalIncome:m,totalAllocated:b}=t,_=typeof p=="number"?p:0,w=typeof m=="number"?m:0,S=typeof b=="number"?b:0,T=Math.abs(_)<.005,C=_<-.005,R=w>0?S/w*100:0;let O="text-gray-900 dark:text-white",P="bg-green-500",N="Left to Budget",A=w>0?Math.min(R,100):0,I=!0;return w===0?(N="Add income to start budgeting",A=0,I=!1,O="text-gray-500 dark:text-zinc-500"):T?(O="text-green-600 dark:text-emerald-400",P="bg-green-500",N="Perfect! Every dollar has a job ",A=100,I=!1):C&&(O="text-red-600 dark:text-red-400",P="bg-red-500",N="You're not in Congress! Try again.",A=100),v.jsxs("div",{className:"flex flex-col justify-center min-w-0 w-full",children:[v.jsxs("div",{className:"flex items-baseline justify-start mb-1",children:[v.jsx("span",{className:`text-xs font-medium truncate mr-1.5 ${O}`,children:N}),I&&v.jsxs("span",{className:`text-sm font-bold truncate ${O}`,children:[C?"-":"","$",Math.abs(_).toFixed(2)]})]}),v.jsx("div",{className:"w-full h-1.5 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:v.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${P}`,style:{width:`${A}%`}})})]})};return v.jsxs("div",{className:"py-2 space-y-3",children:[v.jsxs("div",{className:"flex items-center justify-center gap-4",children:[v.jsx("button",{onClick:c,className:"p-1.5 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Previous month",children:v.jsx(kL,{size:20})}),v.jsx("div",{className:"text-center",children:v.jsxs("button",{onClick:d,className:"text-base font-semibold text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors whitespace-nowrap",title:"Click to go to current month",children:[o," ",r]})}),v.jsx("button",{onClick:u,className:"p-1.5 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Next month",children:v.jsx(Ra,{size:20})})]}),t&&v.jsx("div",{className:"px-1",children:h()})]})},by=({children:n,onDelete:e,threshold:t=-100,disabled:r=!1})=>{const i=mW(),[a,o]=U.useState(!1),c=U.useRef(0),u=()=>{r||(o(!0),c.current=Date.now())},d=async(h,p)=>{if(r)return;const m=p.offset.x,b=p.velocity.x;if(setTimeout(()=>o(!1),100),m<t||m<-50&&b<-500){const _=e();_===!1?i.start({x:0}):_ instanceof Promise&&_.then(w=>{w===!1&&i.start({x:0})})}else i.start({x:0})};return v.jsxs("div",{className:"relative w-full overflow-hidden mb-2 rounded-xl group",children:[v.jsx("div",{className:"absolute inset-0 bg-red-500 flex items-center justify-end pr-6 rounded-xl",children:v.jsx(T0,{className:"text-white w-6 h-6"})}),v.jsx(xn.div,{drag:r?!1:"x",dragConstraints:{left:-500,right:0},dragElastic:.1,onDragStart:u,onDragEnd:d,animate:i,className:`relative bg-white dark:bg-zinc-900 rounded-xl ${a?"z-20":"z-10"}`,style:{touchAction:"pan-y",pointerEvents:a?"none":"auto"},children:n})]})},Hte=({isVisible:n,onClose:e,mode:t,initialIncomeSource:r})=>{const{addIncomeSource:i,updateIncomeSource:a,currentMonth:o}=un(),{showToast:c}=jc(),[u,d]=U.useState(""),[h,p]=U.useState(""),[m,b]=U.useState(!1);U.useEffect(()=>{if(!n)return;const w=window.setTimeout(()=>{t==="edit"&&r?(d(r.name),p(r.amount.toString())):(d(""),p(""))},0);return()=>window.clearTimeout(w)},[n,t,r]);const _=async w=>{if(w.preventDefault(),!u.trim()||!h||parseFloat(h)<=0){c("Please fill in all required fields with valid values","error");return}b(!0);try{if(t==="add")await i(o,{name:u.trim(),amount:parseFloat(h),month:o,userId:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),c("Income source added successfully","success");else{if(!r){c("Error: No income source to edit","error");return}await a(o,{...r,name:u.trim(),amount:parseFloat(h),updatedAt:new Date().toISOString()}),c(`Updated "${u.trim()}" income source`,"success")}e()}catch(S){console.error("Error saving income source:",S),c("Failed to save income source. Please try again.","error")}finally{b(!1)}};return v.jsx(ci,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(xn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black bg-opacity-50"}),v.jsxs(xn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:t==="add"?"Add Income Source":"Edit Income Source"}),v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",children:""})]}),v.jsxs("form",{onSubmit:_,className:"p-6 space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Income Source Name *"}),v.jsx("input",{type:"text",value:u,onChange:w=>d(w.target.value),placeholder:"e.g., Primary Job, Freelance, Investments",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Amount *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-zinc-400",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:h,onChange:w=>{const S=w.target.value.replace(/\D/g,"");if(!S){p("");return}const C=(parseInt(S,10)/100).toFixed(2);p(C)},placeholder:"0.00",className:"w-full pl-8 pr-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"submit",disabled:m||!u.trim()||!h||parseFloat(h)<=0,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m?"Saving...":t==="add"?"Add Income":"Save Changes"})]})]})]})]})})},Yte=({currentMonth:n,onCopy:e,isLoading:t=!1})=>{const r=c=>{const[u,d]=c.split("-");return new Date(parseInt(u),parseInt(d)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},i=c=>{const[u,d]=c.split("-").map(Number);let h=u,p=d-1;return p<1&&(h=u-1,p=12),r(`${h}-${p.toString().padStart(2,"0")}`)},a=r(n),o=i(n);return v.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6 py-12 space-y-6 animate-in fade-in zoom-in-95 duration-300",children:[v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-0 bg-blue-100 dark:bg-blue-900/30 blur-2xl rounded-full opacity-50"}),v.jsxs("div",{className:"relative bg-white dark:bg-zinc-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-700",children:[v.jsx(EL,{className:"w-12 h-12 text-blue-500"}),v.jsx("div",{className:"absolute -top-2 -right-2 bg-blue-500 text-white p-1.5 rounded-full border-2 border-white dark:border-zinc-900",children:v.jsx(zh,{size:14})})]})]}),v.jsxs("div",{className:"max-w-xs mx-auto space-y-2",children:[v.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["It looks like you need a budget for ",a]}),v.jsxs("p",{className:"text-gray-500 dark:text-zinc-400",children:["We can copy your budget from ",o," to get you started right away."]})]}),v.jsx("div",{className:"w-full max-w-xs space-y-3 pt-2",children:v.jsx("button",{onClick:e,disabled:t,className:"w-full py-3.5 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-sm transition-all active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:t?"Creating...":v.jsx(v.Fragment,{children:v.jsxs("span",{children:["Create ",a," Budget"]})})})})]})},Kte="/personal-budget-pwa/icon-512.png",E1="/personal-budget-pwa/images/budget-balanced.png",Zk=["Giving","Savings","Housing","Transportation","Food","Personal","Health","Insurance","Debt"],Xte=({currentMonth:n,onComplete:e})=>{const[t,r]=U.useState(0),[i,a]=U.useState(0),[o,c]=U.useState(2500),[u,d]=U.useState(Zk),{addCategory:h}=un(),p=N=>{d(A=>A.includes(N)?A.filter(I=>I!==N):[...A,N])},m=async()=>{for(let N=0;N<u.length;N++)await h({name:u[N],orderIndex:N,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()});e()};U.useEffect(()=>{if(console.log("Animation effect triggered:",{currentStep:t,animationKey:i}),t===4){console.log("Starting animation from $2500 to $0"),c(2500);const N=2e3,A=20,I=N/A,k=2500/A;let z=0;const V=setInterval(()=>{z++;const B=Math.max(0,2500-k*z);console.log("Phase 1 - Animation step:",z,"New amount:",B),c(B),z>=A&&(clearInterval(V),console.log("Phase 1 completed - Perfect budget reached"),setTimeout(()=>{console.log("Starting Phase 2 - Over budget demonstration");let j=0;const X=10,H=200,$=500/X,W=setInterval(()=>{j++;const ee=-($*j);console.log("Phase 2 - Over budget step:",j,"Over budget amount:",ee),c(ee),j>=X&&(clearInterval(W),console.log("Animation completed - Over budget scenario demonstrated"))},H)},1e3))},I);return()=>{console.log("Cleaning up animation timers"),clearInterval(V)}}},[i,t]);const _=(N=>{const[A,I]=N.split("-");return new Date(parseInt(A),parseInt(I)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})})(n),w=[{icon:zh,title:"Welcome to Dollars At Work!",description:`Let's set up your budget for ${_}`,content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["Dollars At Work helps you take control of your money using the ",v.jsx("strong",{children:"zero-based budgeting"})," method."]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Every dollar gets a job, and you'll know exactly where your money is going."}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4",children:v.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-200 font-medium",children:" This quick guide will show you how to get started in just a few steps!"})})]}),color:"blue"},{icon:S9,title:"Step 1: Choose Categories",description:"Select categories to organize your spending",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Categories help group your envelopes. Select the ones you need:"}),v.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-60 overflow-y-auto pr-1",children:Zk.map(N=>v.jsxs("button",{onClick:()=>p(N),className:`p-3 rounded-xl border text-sm font-medium transition-all flex items-center gap-2 ${u.includes(N)?"bg-blue-50 border-blue-200 text-blue-700 dark:bg-blue-900/30 dark:border-blue-800 dark:text-blue-300":"bg-white border-gray-200 text-gray-600 dark:bg-zinc-800 dark:border-zinc-700 dark:text-zinc-400"}`,children:[v.jsx("div",{className:`w-4 h-4 rounded-full border flex items-center justify-center ${u.includes(N)?"border-blue-500 bg-blue-500":"border-gray-400"}`,children:u.includes(N)&&v.jsx(ys,{size:12,className:"text-white"})}),N]},N))}),u.length===0&&v.jsx("p",{className:"text-red-500 text-xs",children:"Please select at least one category."})]}),color:"blue"},{icon:D2,title:"Step 2: Add Your Income",description:"Tell us how much money you have to work with",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"First, you'll add your income sources for the month. This could be:"}),v.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-zinc-400",children:[v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ys,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Salary"})," - Your regular paycheck"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ys,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Freelance"})," - Side gig income"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ys,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Other Income"})," - Any other money coming in"]})]})]}),v.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-green-900 dark:text-green-200",children:[v.jsx("strong",{children:'Look for the "Income Sources" section'})," at the top of your budget and tap the ",v.jsx(bp,{className:"w-4 h-4 inline"})," button to add income."]})})]}),color:"green"},{icon:Ev,title:"Step 3: Create Spending Envelopes",description:"Organize your spending into categories",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Spending envelopes are where you track expenses. You'll assign each envelope to a category."}),v.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-zinc-400",children:[v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ys,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Groceries"})," (Food)"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ys,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Rent/Mortgage"})," (Housing)"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(ys,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Gas"})," (Transportation)"]})]})]}),v.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-purple-900 dark:text-purple-200",children:[v.jsx("strong",{children:'Tap "+" on a category section'})," to add an envelope to it."]})})]}),color:"purple"},{icon:A0,title:"Step 4: Allocate Your Budget",description:"Assign money to each envelope",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Now comes the fun part - giving every dollar a job!"}),v.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500 rounded-r-xl p-4 relative",children:[v.jsx("button",{onClick:()=>a(N=>N+1),className:"absolute top-2 right-2 p-1.5 text-blue-600 dark:text-blue-400 hover:bg-blue-100 dark:hover:bg-blue-800 rounded-lg transition-colors",title:"Replay animation",children:v.jsx(v9,{className:"w-4 h-4"})}),v.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-200 font-medium mb-2",children:'The "Left to Budget" amount shows unassigned money'}),v.jsxs("p",{className:"text-sm text-blue-900 dark:text-blue-200 mb-3",children:["Your goal is to get this to ",v.jsx("strong",{children:"$0.00"})," by allocating all your income to envelopes."]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex justify-between text-xs text-blue-700 dark:text-blue-300 font-medium",children:[v.jsx("span",{children:"Left to Budget"}),v.jsxs("span",{className:`font-bold ${o<0?"text-red-600 dark:text-red-400":""}`,children:["$",o.toFixed(2)]})]}),v.jsx("div",{className:"w-full bg-blue-200 dark:bg-blue-800 rounded-full h-2 overflow-hidden",children:v.jsx(xn.div,{className:`h-full rounded-full ${o<0?"bg-red-500":"bg-green-500"}`,initial:{width:"0%"},animate:{width:o<0?"100%":`${(2500-o)/2500*100}%`},transition:{duration:.3,ease:"easeInOut"}})}),v.jsxs(xn.div,{className:`text-xs font-medium text-center mt-1 ${o===0?"text-green-600 dark:text-emerald-400":o<0?"text-red-600 dark:text-red-400":"text-blue-700 dark:text-blue-300"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:2,duration:.5},children:[o===0&&"Perfect! Every dollar has a job ",o<0&&"You're not in Congress! Try again.",o>0&&"Keep allocating until you reach $0"]})]},i)]}),v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:[v.jsx("strong",{children:"To allocate money:"})," Tap the budget amount on any envelope and enter how much you want to assign to it."]}),v.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-amber-900 dark:text-amber-200",children:[" ",v.jsx("strong",{children:"Pro tip:"})," Start with your essential expenses (rent, utilities, groceries) first, then allocate what's left to other categories."]})})]}),color:"blue"},{icon:yp,title:"Bonus: Piggybanks (Savings Goals)",description:"Save for future goals",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["Piggybanks are special envelopes for ",v.jsx("strong",{children:"savings goals"})," that carry over month-to-month."]}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(A9,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Set a Goal"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Vacation, emergency fund, new car - whatever you're saving for"})]})]}),v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(D2,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Monthly Contributions"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Set an automatic monthly amount to save"})]})]}),v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(A0,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Track Progress"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Watch your savings grow toward your goal"})]})]})]}),v.jsx("div",{className:"bg-pink-50 dark:bg-pink-900/20 border border-pink-200 dark:border-pink-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-pink-900 dark:text-pink-200",children:[v.jsx("strong",{children:"Find Piggybanks"})," at the bottom of your budget. They're optional but powerful for reaching your goals!"]})})]}),color:"pink"},{icon:E1,title:"You're Ready to Budget!",description:"Start taking control of your money",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"That's it! You now know the basics of Dollars At Work:"}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"1"})}),v.jsx("span",{children:"Choose your categories"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"2"})}),v.jsx("span",{children:"Add your income sources"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"3"})}),v.jsx("span",{children:"Create envelopes in categories"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"4"})}),v.jsx("span",{children:"Allocate until Left to Budget = $0"})]})]}),v.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4 mt-6",children:v.jsx("p",{className:"text-sm text-center text-blue-900 dark:text-blue-200 font-medium",children:' Click "Start Budgeting" below to create your first budget!'})})]}),color:"green",useCustomIcon:!0}],S=w[t],T=S.useCustomIcon?E1:S.icon,C=t===w.length-1,R=t===0,P={blue:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-600 dark:text-blue-400",button:"bg-blue-600 hover:bg-blue-700"},green:{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-600 dark:text-green-400",button:"bg-green-600 hover:bg-green-700"},purple:{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-600 dark:text-purple-400",button:"bg-purple-600 hover:bg-purple-700"},pink:{bg:"bg-pink-100 dark:bg-pink-900/30",text:"text-pink-600 dark:text-pink-400",button:"bg-pink-600 hover:bg-pink-700"}}[S.color];return v.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex items-center justify-center p-4",children:v.jsx("div",{className:"w-full max-w-2xl",children:v.jsx(ci,{mode:"wait",children:v.jsxs(xn.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-xl border border-gray-200 dark:border-zinc-800 overflow-hidden",children:[v.jsx("div",{className:"p-6 pb-2",children:v.jsxs("div",{className:"flex items-center justify-between mb-4",children:[v.jsxs("div",{className:"flex-1",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:S.title}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:S.description})]}),v.jsx("div",{className:"flex flex-col items-center mx-4",children:t===0?v.jsx("img",{src:Kte,alt:"Dollars At Work",className:`w-20 h-20 ${P.text}`}):S.useCustomIcon?v.jsx("img",{src:E1,alt:"Budget Balanced",className:`w-32 h-32 ${P.text}`}):v.jsx("div",{className:`${P.bg} p-3 rounded-xl`,children:v.jsx(T,{className:`w-8 h-8 ${P.text}`})})}),v.jsxs("div",{className:"text-sm text-gray-500 dark:text-zinc-400 whitespace-nowrap",children:["Step ",t+1," of ",w.length]})]})}),v.jsx("div",{className:"px-6 pb-6 pt-2",children:S.content}),v.jsx("div",{className:"px-6 pb-4 flex justify-center gap-2",children:w.map((N,A)=>v.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${A===t?`w-8 ${P.button}`:A<t?"w-2 bg-gray-400 dark:bg-zinc-600":"w-2 bg-gray-200 dark:bg-zinc-700"}`},A))}),v.jsxs("div",{className:"p-6 pt-0 flex gap-3",children:[!R&&v.jsxs("button",{onClick:()=>r(N=>N-1),className:"flex-1 py-3 px-4 border border-gray-300 dark:border-zinc-700 text-gray-700 dark:text-zinc-300 rounded-xl font-medium hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors flex items-center justify-center gap-2",children:[v.jsx(gc,{className:"w-5 h-5"}),"Back"]}),v.jsx("button",{onClick:()=>{if(C)m();else{if(S.title.includes("Choose Categories")&&u.length===0)return;r(N=>N+1)}},disabled:S.title.includes("Choose Categories")&&u.length===0,className:`${R?"flex-1":"flex-[2]"} py-3 px-4 ${P.button} text-white rounded-xl font-semibold transition-all active:scale-[0.98] flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed`,children:C?v.jsxs(v.Fragment,{children:[v.jsx(zh,{className:"w-5 h-5"}),"Start Budgeting"]}):v.jsxs(v.Fragment,{children:["Next",v.jsx(bL,{className:"w-5 h-5"})]})})]})]},t)})})})},Wte=({piggybank:n,balance:e,onNavigate:t,setMoveableRef:r,isReorderingActive:i,activelyDraggingId:a,onItemDragStart:o,onLongPressTrigger:c})=>{const u=U.useRef(null),[d,h]=U.useState(!1),p=_5(k=>{w5(),c(k,n.id)},{threshold:500,cancelOnMovement:25,detect:sc.Touch}),m=n.piggybankConfig?.targetAmount,b=n.piggybankConfig?.monthlyContribution??0,_=n.piggybankConfig?.color||"#3B82F6",w=n.piggybankConfig?.paused||!1,S=typeof e=="number"?e:e.toNumber(),T=(k,z=1)=>{const V=k.replace("#",""),B=parseInt(V,16),j=B>>16&255,X=B>>8&255,H=B&255;return`rgba(${j}, ${X}, ${H}, ${z})`},C=`linear-gradient(135deg, ${T(_,.14)} 0%, ${T(_,.05)} 100%)`,R=T(_,.4),O=m&&m>0?Math.min(S/m*100,100):0,P=m&&S>=m;U.useEffect(()=>{a&&a!==n.id&&h(!1)},[a,n.id]),U.useEffect(()=>{a===n.id&&(h(!0),o&&o(n.id))},[a,n.id,o]),U.useEffect(()=>{if(!a&&d){const k=setTimeout(()=>{h(!1)},300);return()=>clearTimeout(k)}},[a,d]);const N=k=>{if(d||i){k.preventDefault(),k.stopPropagation();return}t(n.id)},A=a===n.id,I=v.jsxs("div",{className:"flex items-center gap-3 w-full",children:[v.jsx("div",{className:"hidden md:flex items-center justify-center p-1 text-gray-400 opacity-0 group-hover:opacity-100 cursor-grab active:cursor-grabbing transition-all duration-200",onMouseDown:k=>c(k,n.id),children:v.jsx(_N,{size:20})}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsxs("div",{className:"flex items-center justify-between gap-3 mb-1",children:[v.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[v.jsx("div",{className:"w-6 h-6 rounded-full flex-shrink-0 flex items-center justify-center",style:{backgroundColor:`${_}20`},children:v.jsx(yp,{size:12,style:{color:_}})}),v.jsxs("div",{className:"min-w-0",children:[v.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white truncate leading-tight",children:n.name}),v.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[v.jsx(A0,{size:10,style:{color:_}}),v.jsxs("span",{className:"text-[10px] text-gray-500 dark:text-zinc-400 font-medium",children:["$",b.toFixed(2),"/mo"]}),w&&v.jsxs("span",{className:"text-[9px] text-orange-600 dark:text-orange-400 font-bold ml-1 flex items-center gap-0.5",children:[v.jsx(u9,{size:8})," PAUSED"]})]})]})]}),v.jsxs("div",{className:"text-right flex-shrink-0",children:[v.jsxs("div",{className:"text-sm font-bold text-gray-900 dark:text-white leading-none",children:["$",S.toFixed(2)]}),v.jsxs("div",{className:"text-[9px] text-gray-400 dark:text-zinc-500 mt-1",children:["of $",m?.toFixed(0)||"0"]})]})]}),m&&m>0&&v.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-800/50 rounded-full h-0.5 overflow-hidden",children:v.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${O}%`,backgroundColor:_}})}),P&&!m&&v.jsx("div",{className:"text-[9px] text-green-600 dark:text-green-400 font-bold mt-0.5",children:" GOAL REACHED"})]})]});return v.jsx(xn.div,{...p(),layout:!A,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},ref:k=>{r&&r(k),u.current=k},onClick:N,style:{background:C,borderColor:R,boxShadow:A?"0 18px 45px rgba(15,23,42,0.35)":"0 1px 2px rgba(15,23,42,0.08)",zIndex:A?50:1,scale:A?1.02:1},className:"rounded-xl py-1.5 px-3 border transition-all cursor-pointer shadow-sm hover:shadow-md select-none active:scale-[0.99] group",children:I})},th=(n,e=1)=>{const t=n.replace("#",""),r=parseInt(t,16),i=r>>16&255,a=r>>8&255,o=r&255;return`rgba(${i}, ${a}, ${o}, ${e})`},Qte=12,Zte=(n,e,t)=>Math.min(Math.max(n,e),t),Jte=({env:n,budgetedAmount:e,remainingBalance:t,navigate:r,transactions:i,currentMonth:a,setMoveableRef:o,isReorderingActive:c,activelyDraggingId:u,onItemDragStart:d,onLongPressTrigger:h})=>{const p=!!n.isPiggybank,m=n.piggybankConfig?.color||"#3B82F6",b=p?`linear-gradient(135deg, ${th(m,.18)} 0%, ${th(m,.08)} 100%)`:void 0,_=p?th(m,.5):void 0,[w,S]=U.useState(!1),T=_5(V=>{w5(),h(V,n.id)},{threshold:500,cancelOnMovement:25,detect:sc.Touch}),C=i.filter(V=>V.envelopeId===n.id&&V.month===a),R=C.filter(V=>V.type==="Expense"),O=C.filter(V=>V.type==="Income"),P=R.reduce((V,B)=>V+(B.amount||0),0),N=O.reduce((V,B)=>V+(B.amount||0),0),A=N>0?Math.max(0,P/N*100):0,I=V=>{if(w||c){V.preventDefault(),V.stopPropagation();return}r(`/envelope/${n.id}`)};U.useEffect(()=>{u&&u!==n.id&&S(!1)},[u,n.id]),U.useEffect(()=>{u===n.id&&(S(!0),d(n.id))},[u,n.id,d]),U.useEffect(()=>{if(!u&&w){const V=setTimeout(()=>{S(!1)},300);return()=>clearTimeout(V)}},[u,w]);const k=v.jsxs("div",{className:"flex items-center gap-3 w-full",children:[v.jsx("div",{className:"hidden md:flex items-center justify-center p-1 text-gray-400 opacity-0 group-hover:opacity-100 cursor-grab active:cursor-grabbing transition-all duration-200",onMouseDown:V=>h(V,n.id),children:v.jsx(_N,{size:20})}),v.jsxs("div",{className:"flex-1",children:[v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[p&&v.jsx("span",{className:"w-5 h-5 rounded-full flex items-center justify-center border",style:{borderColor:th(m,.4),backgroundColor:th(m,.15),color:m},children:v.jsx(yp,{size:10})}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white leading-tight",children:n.name}),v.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[v.jsx("span",{className:"text-[10px] text-gray-500 dark:text-zinc-400",children:"Budgeted:"}),v.jsxs("span",{className:"text-[10px] font-medium text-gray-700 dark:text-zinc-300",children:["$",e.toFixed(2)]})]})]})]}),v.jsxs("div",{className:"text-right",children:[v.jsxs("span",{className:`text-sm font-bold leading-none ${(typeof t=="number"?t:t.toNumber())<0||100-A<=5?"text-red-500":A>=80?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-emerald-400"}`,children:["$",(typeof t=="number"?t:t.toNumber()).toFixed(2)]}),v.jsx("span",{className:"text-[9px] text-gray-400 dark:text-zinc-500 block uppercase tracking-wider mt-0.5",children:"Remaining"})]})]}),e>0&&v.jsx("div",{className:"mt-1",children:v.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-700/50 rounded-full h-0.5 overflow-hidden",children:v.jsx("div",{className:`h-full transition-all duration-300 ease-out ${(typeof t=="number"?t:t.toNumber())<0||100-A<=5?"bg-red-500":A>=80?"bg-yellow-500":"bg-green-400"}`,style:{width:`${Math.max(100-A,2)}%`}})})})]})]}),z=u===n.id;return v.jsx(xn.div,{...T(),layout:!z,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},"data-envelope-id":n.id,ref:o(n.id),onClick:I,style:{boxShadow:z?"0 18px 45px rgba(15,23,42,0.35)":"0 1px 2px rgba(15,23,42,0.08)",background:b,borderColor:_,cursor:z?"grabbing":"pointer",zIndex:z?50:1,scale:z?1.02:1},className:`py-1.5 px-3 rounded-xl active:scale-[0.99] transition-all select-none border group ${p?"bg-white/70 dark:bg-zinc-800/80":"bg-gray-50 dark:bg-zinc-800 border-transparent"}`,children:k})},Jk=({category:n,envelopes:e,allocations:t,currentMonth:r,transactions:i,navigate:a,getEnvelopeBalance:o,onReorderGlobal:c})=>{if(e.length===0&&n.id==="uncategorized")return null;const[u,d]=U.useState(e),h=U.useRef(e),[p,m]=U.useState(!1),[b,_]=U.useState(null),w=U.useRef(!1),S=U.useRef(null),T=U.useRef({}),C=U.useRef({}),R=U.useRef({activeId:null,startIndex:0,currentIndex:0,itemHeight:0});U.useEffect(()=>{p||(d(e),h.current=e)},[e,p]);const O=U.useCallback((N,A)=>{const I=C.current[A];if(I){w.current=!0;const k=N.nativeEvent||N;I.dragStart(k)}},[]),P=U.useCallback(N=>A=>{A?T.current[N]=A:delete T.current[N]},[]);return U.useEffect(()=>{const N=()=>{Object.values(C.current).forEach(k=>k?.destroy()),C.current={}};if(!u.length)return;const A=()=>{u.forEach(k=>{const z=T.current[k.id];if(!z||!S.current)return;const V=new Mee(S.current,{target:z,draggable:!0,throttleDrag:0,snappable:!0,snapThreshold:5,snapDirections:{top:!0,bottom:!0},elementSnapDirections:{top:!0,bottom:!0},clickable:!0,dragArea:!1,hideDefaultLines:!0,renderDirections:[]});V.on("dragStart",j=>{if(!w.current){j.stop();return}const X=j.inputEvent.target;if(X.closest(".js-budget-target")||X.tagName==="INPUT"){j.stop();return}const H=h.current.findIndex(ee=>ee.id===k.id),$=j.target,W=$.getBoundingClientRect();_(k.id),R.current={activeId:k.id,startIndex:H,currentIndex:H,itemHeight:W.height+Qte},$.style.transition="none",$.style.boxShadow="0 18px 45px rgba(15,23,42,0.35)",$.style.zIndex="20",m(!0)});let B=null;V.on("drag",j=>{const X=j.target;B!==null&&cancelAnimationFrame(B),B=requestAnimationFrame(()=>{const H=R.current;if(H.activeId!==k.id)return;const $=j.beforeTranslate[1];X.style.transform=`translateY(${$}px)`,X.style.transition="none";const{itemHeight:W,startIndex:ee}=H,he=Math.round($/W),K=Zte(ee+he,0,h.current.length-1);K!==H.currentIndex&&(H.currentIndex=K,h.current.forEach((G,Y)=>{if(G.id===k.id)return;const re=T.current[G.id];if(!re)return;let Z=0;ee<K&&Y>ee&&Y<=K?Z=-W:ee>K&&Y>=K&&Y<ee&&(Z=W),re.style.transform=Z?`translateY(${Z}px)`:"",re.style.transition="transform 0.2s ease"})),B=null})}),V.on("dragEnd",j=>{B!==null&&(cancelAnimationFrame(B),B=null);const X=j.target,{startIndex:H,currentIndex:$}=R.current;if(X.style.transform="",X.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease",X.style.boxShadow="",h.current.forEach(W=>{const ee=T.current[W.id];ee&&(ee.style.transform="",ee.style.transition="")}),H!==$){const W=[...h.current],[ee]=W.splice(H,1);W.splice($,0,ee),h.current=W,d(W),c(W.map(he=>he.id))}setTimeout(()=>{X.style.zIndex="",_(null),m(!1),w.current=!1},300)}),V.on("click",()=>{const j=window.event?.target;j&&(j.closest(".js-budget-target")||j.tagName==="INPUT")||a(`/envelope/${k.id}`)}),C.current[k.id]=V})},I=window.setTimeout(A,80);return()=>{clearTimeout(I),N()}},[u,a,c]),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-3 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-2 px-1",children:[v.jsx("h2",{className:"text-base font-bold text-gray-900 dark:text-white flex items-center gap-2",children:n.name}),v.jsx("button",{onClick:()=>a(n.id==="uncategorized"?"/add-envelope":`/add-envelope?categoryId=${n.id}`),className:"text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 p-1 rounded-full transition-colors",title:`Add to ${n.name}`,children:v.jsx(bp,{size:20})})]}),v.jsx("div",{ref:S,className:"space-y-2 relative",children:u.length===0?v.jsx("div",{className:"py-2 text-center border border-dashed border-gray-100 dark:border-zinc-800 rounded-xl",children:v.jsx("p",{className:"text-[10px] text-gray-400 dark:text-zinc-500",children:"Empty category"})}):v.jsx(ci,{initial:!1,children:u.map(N=>{const I=(t[r]||[]).find(z=>z.envelopeId===N.id)?.budgetedAmount||0,k=o(N.id);return N.isPiggybank?v.jsx(Wte,{piggybank:N,balance:k,onNavigate:z=>a(`/envelope/${z}`),setMoveableRef:P(N.id),isReorderingActive:p,activelyDraggingId:b,onItemDragStart:()=>{},onLongPressTrigger:O},N.id):v.jsx(Jte,{env:N,budgetedAmount:I,remainingBalance:k,navigate:a,transactions:i,currentMonth:r,setMoveableRef:P,isReorderingActive:p,activelyDraggingId:b,onItemDragStart:()=>{},onLongPressTrigger:O},N.id)})})})]})},ene=()=>{const{visibleEnvelopes:n,piggybanks:e,incomeSources:t,availableToBudget:r,currentMonth:i,allocations:a,transactions:o,isLoading:c,isInitialLoading:u,showTimeoutMessage:d,getEnvelopeBalance:h,deleteIncomeSource:p}=qte(),{setMonth:m,setIsOnboardingActive:b,isOnboardingCompleted:_,completeOnboarding:w,categories:S,fetchCategories:T,envelopes:C,reorderEnvelopes:R}=un(),O=Ka(),[P,N]=U.useState(!1),[A,I]=U.useState("add"),[k,z]=U.useState(null),[V,B]=U.useState(!1),[j,X]=U.useState(!1),[H,$]=U.useState(!1),W=U.useRef(null),ee=U.useRef(null),[he,K]=U.useState(0);U.useEffect(()=>{S.length===0&&T()},[S.length,T]);const G=U.useMemo(()=>{const we={},Pe=[];return S.forEach(_e=>we[_e.id]=[]),[...n,...e].sort((_e,ze)=>(_e.orderIndex??0)-(ze.orderIndex??0)).forEach(_e=>{_e.categoryId&&we[_e.categoryId]?we[_e.categoryId].push(_e):Pe.push(_e)}),{groups:we,uncategorized:Pe}},[S,n,e]),Y=U.useCallback(async we=>{const Pe=[...C.map(Ne=>Ne.id)],ue=new Set(we),_e=[];let ze=0;Pe.forEach(Ne=>{ue.has(Ne)?_e.push(we[ze++]):_e.push(Ne)}),await R(_e)},[C,R]);U.useLayoutEffect(()=>{if(H)return;const we=ee.current;if(!we)return;const Pe=()=>K(we.getBoundingClientRect().height);Pe();const ue=new ResizeObserver(()=>Pe());return ue.observe(we),window.addEventListener("resize",Pe),()=>{window.removeEventListener("resize",Pe),ue.disconnect()}},[H,i,t,a,n,e,r]),U.useEffect(()=>(b(H),()=>b(!1)),[H,b]),U.useEffect(()=>{if(!u&&!c){const we=setTimeout(()=>{if(H)return;if(_){$(!1);const _e=(t[i]||[]).length===0&&(a[i]||[]).length===0,ze=Object.keys(t).some(Ne=>(t[Ne]||[]).length>0)||Object.keys(a).some(Ne=>(a[Ne]||[]).length>0);X(!!(_e&&ze));return}const Pe=(t[i]||[]).length===0&&(a[i]||[]).length===0,ue=Object.keys(t).some(_e=>(t[_e]||[]).length>0)||Object.keys(a).some(_e=>(a[_e]||[]).length>0);Pe?ue?(X(!0),$(!1)):($(!0),X(!1)):(X(!1),$(!1))},500);return()=>clearTimeout(we)}},[u,c,i,t,a,_]);const re=()=>{I("add"),z(null),N(!0)},Z=we=>{W.current&&clearTimeout(W.current),!V&&(I("edit"),z(we),N(!0))},oe=we=>{W.current&&clearTimeout(W.current),B(!0),p(we),setTimeout(()=>B(!1),500)},fe=()=>{N(!1),z(null)},be=async()=>{X(!1);const{copyPreviousMonthAllocations:we}=un.getState();await we(i)},Ce=()=>{w(),$(!1)};return u?v.jsx(GO,{message:d?"Still loading...":"Loading your budget...",showTimeout:d}):v.jsxs(v.Fragment,{children:[v.jsx("style",{dangerouslySetInnerHTML:{__html:".moveable-control, .moveable-origin, .moveable-line { display: none !important; }"}}),v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-20",children:[!H&&v.jsx("header",{ref:ee,className:"fixed top-0 left-0 right-0 z-50 bg-white dark:bg-zinc-900 border-b border-gray-100 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+4px)] pb-1",children:v.jsx($te,{currentMonth:i,onMonthChange:we=>{X(!1),m(we)},budgetStatus:{amount:r,totalIncome:(t[i]||[]).reduce((we,Pe)=>we+Pe.amount,0),totalAllocated:(a[i]||[]).filter(we=>n.some(Pe=>Pe.id===we.envelopeId)||e.some(Pe=>Pe.id===we.envelopeId)).reduce((we,Pe)=>we+Pe.budgetedAmount,0)}})}),v.jsxs("div",{className:"pb-[calc(8rem+env(safe-area-inset-bottom))] px-4 max-w-4xl mx-auto space-y-4",style:H?void 0:{paddingTop:Math.max(0,he+16)},children:[H?v.jsx(Xte,{currentMonth:i,onComplete:Ce}):j?v.jsx(Yte,{currentMonth:i,onCopy:be}):v.jsxs(v.Fragment,{children:[v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-3 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-2 px-1",children:[v.jsx("h2",{className:"text-base font-bold text-gray-900 dark:text-white",children:"Income Sources"}),v.jsx("button",{onClick:re,className:"text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 p-1 rounded-full transition-colors",children:v.jsx(bp,{size:20})})]}),(t[i]||[]).length===0?v.jsx("div",{className:"text-center py-4",children:v.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-[10px]",children:"No income sources yet."})}):v.jsx("div",{className:"space-y-2",children:v.jsx(ci,{initial:!1,mode:"popLayout",children:(t[i]||[]).map(we=>v.jsx(xn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(by,{onDelete:()=>oe(we),children:v.jsxs("div",{className:"flex justify-between items-center py-2 px-3 bg-gray-50 dark:bg-zinc-800 rounded-xl cursor-pointer",onClick:()=>Z(we),children:[v.jsx("div",{className:"flex-1",children:v.jsx("p",{className:"text-xs font-medium text-gray-900 dark:text-white",children:we.name})}),v.jsxs("p",{className:"text-xs font-bold text-green-600 dark:text-emerald-400",children:["$",we.amount.toFixed(2)]})]})})},we.id))})})]}),S.map(we=>v.jsx(Jk,{category:we,envelopes:G.groups[we.id]||[],allocations:a,currentMonth:i,transactions:o,navigate:O,getEnvelopeBalance:h,onReorderGlobal:Y},we.id)),G.uncategorized.length>0&&v.jsx(Jk,{category:{id:"uncategorized",name:"Uncategorized"},envelopes:G.uncategorized,allocations:a,currentMonth:i,transactions:o,navigate:O,getEnvelopeBalance:h,onReorderGlobal:Y}),S.length===0&&G.uncategorized.length===0&&v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800 text-center py-12",children:[v.jsx(Ev,{className:"w-12 h-12 text-gray-300 dark:text-zinc-700 mx-auto mb-3"}),v.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-sm mb-4",children:"No envelopes yet."}),v.jsx("button",{onClick:()=>O("/add-envelope"),className:"text-blue-600 dark:text-blue-300 font-medium hover:text-blue-700 dark:hover:text-blue-200 transition-colors",children:"Create First Envelope"})]})]}),v.jsx(Hte,{isVisible:P,onClose:fe,mode:A,initialIncomeSource:k})]})]})]})},tne=[],O5=({selectedCard:n,onCardSelect:e,initialCards:t=tne,disabled:r=!1,isUserSelected:i=!1})=>{const a=un(V=>V.appSettings),o=un(V=>V.updateAppSettings),[c,u]=U.useState(t.length>0?t[0]:{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}),[d,h]=U.useState(!1),[p,m]=U.useState(!1),[b,_]=U.useState(t),[w,S]=U.useState(null),[T,C]=U.useState({name:"",network:"Visa",last4:"",color:"#3b82f6"});U.useEffect(()=>{a?.paymentSources&&(_(a.paymentSources),a.paymentSources.length>0&&!n&&u(a.paymentSources[0]))},[a,n]);const R=n||c;U.useEffect(()=>{!n&&e&&b.length>0&&e(b[0])},[n,e,b]);const O=V=>{r||(V.id==="add-new"?m(!0):(u(V),e?.(V),h(!1)))},P=()=>{r||h(!d)},N=V=>{r||S(V)},A=async()=>{if(w&&!r){const V=b.filter(B=>B.id!==w.id);if(_(V),R?.id===w.id){const B=V.length>0?V[0]:{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"};u(B),e?.(B)}S(null),h(!1);try{await o({paymentSources:V})}catch(B){console.error("Failed to delete card from app settings:",B),_(b),alert("Failed to delete card. Please try again.");return}}},I=()=>{S(null)},k=async()=>{if(r)return;const V=!["Cash","Venmo"].includes(T.network);if(V&&(T.last4.length!==4||!/^\d{4}$/.test(T.last4))){alert("Please enter exactly 4 digits for the last 4 digits");return}if(!T.name.trim()){alert("Please enter a name");return}const B={id:`custom-${Date.now()}`,name:T.name.trim(),network:T.network,last4:V?T.last4:void 0,color:T.color},j=[...b,B];_(j),u(B),e?.(B),m(!1),h(!1);try{await o({paymentSources:j})}catch(X){console.error("Failed to save card to app settings:",X),_(b),u(R),alert("Failed to save card. Please try again.");return}C({name:"",network:"Visa",last4:"",color:"#3b82f6"})},z=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#6b7280","#0f4c81","#fdbb30","#7fb5b5","#232f3e","#e3e3e3"];return v.jsxs(v.Fragment,{children:[v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Payment Method",!i&&v.jsx("span",{className:"ml-2 text-xs text-blue-600 dark:text-blue-400 font-medium",children:"(Default selected)"})]}),v.jsxs("div",{onClick:P,className:`flex items-center gap-4 p-3 border rounded-lg transition-colors ${r?"cursor-not-allowed opacity-50 border-gray-300 dark:border-gray-600":"cursor-pointer hover:bg-gray-50 dark:hover:bg-zinc-800 border-gray-300 dark:border-gray-600"} ${i?"":"ring-2 ring-blue-200 dark:ring-blue-800"}`,children:[v.jsxs("div",{className:"w-[70px] h-[40px] rounded-lg flex flex-col justify-between p-[6px] shadow-lg text-white font-mono text-xs",style:{backgroundColor:R.color},children:[v.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:R.network}),v.jsx("span",{className:"text-left text-[9px] leading-none",children:["Cash","Venmo"].includes(R.network)?R.network==="Cash"?"$$$":"@":` ${R.last4||""}`})]}),v.jsxs("div",{className:"flex-1",children:[v.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:R.name}),v.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Cash","Venmo"].includes(R.network)?R.network:`(...${R.last4})`})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"text-gray-400",children:d?"":""}),!i&&v.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",title:"Default payment method - tap to change"})]})]}),d&&v.jsx("div",{className:"card-stack-dropdown",children:v.jsx("div",{className:"card-stack",children:v.jsx(ci,{initial:!1,mode:"popLayout",children:[...b,{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}].map((V,B)=>{const j=R.id===V.id,X=V.id==="add-new",H=["Cash","Venmo"].includes(V.network);return v.jsx(xn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(by,{onDelete:()=>!X&&!r&&N(V),threshold:-80,children:v.jsxs("div",{className:`card-stack-item ${j?"selected":""} ${X?"add-new-card":""}`,onClick:()=>O(V),style:{backgroundColor:X?"#f3f4f6":V.color,color:X?"#374151":V.color==="#e3e3e3"?"#000":"#fff",zIndex:b.length-B},children:[v.jsxs("div",{className:"card-header",children:[v.jsx("span",{className:"card-network",children:X?"":V.network}),j&&!X&&v.jsx("span",{className:"selected-indicator",children:""})]}),v.jsxs("div",{className:"card-details",children:[v.jsx("div",{className:"card-name",children:V.name}),v.jsx("div",{className:"card-number",children:X?"":H?V.network==="Cash"?"$$$":"@":` ${V.last4}`})]}),X&&v.jsx("div",{className:"add-icon",children:v.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[v.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),v.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})})},V.id)})})})})]}),p&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-md mx-4",children:[v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Add New Payment Method"}),v.jsx("button",{type:"button",onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:""})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Name"}),v.jsx("input",{type:"text",value:T.name,onChange:V=>C({...T,name:V.target.value}),placeholder:"e.g., Wallet Cash, My Venmo",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type"}),v.jsxs("select",{value:T.network,onChange:V=>C({...T,network:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[v.jsx("option",{value:"Visa",children:"Visa"}),v.jsx("option",{value:"Mastercard",children:"Mastercard"}),v.jsx("option",{value:"Amex",children:"Amex"}),v.jsx("option",{value:"Cash",children:"Cash"}),v.jsx("option",{value:"Venmo",children:"Venmo"})]})]}),!["Cash","Venmo"].includes(T.network)&&v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Last 4 Digits"}),v.jsx("input",{type:"text",value:T.last4,onChange:V=>C({...T,last4:V.target.value.replace(/\D/g,"").slice(0,4)}),placeholder:"1234",maxLength:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:z.map(V=>v.jsx("button",{type:"button",onClick:()=>C({...T,color:V}),className:`w-full h-10 rounded-lg border-2 transition-all ${T.color===V?"border-blue-500 scale-110":"border-gray-300 dark:border-gray-600"}`,style:{backgroundColor:V}},V))})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Preview"}),v.jsxs("div",{className:"w-full h-20 rounded-lg flex flex-col justify-between p-3 shadow-lg text-white font-mono text-xs",style:{backgroundColor:T.color},children:[v.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:T.network}),v.jsx("span",{className:"text-left text-[9px] leading-none",children:["Cash","Venmo"].includes(T.network)?T.network==="Cash"?"$$$":"@":` ${T.last4||"0000"}`})]})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{type:"button",onClick:()=>m(!1),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"button",onClick:k,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors",children:"Add"})]})]})]})}),w&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-sm mx-4",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center mx-auto mb-4",children:v.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Delete Card"}),v.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Are you sure you want to delete ",v.jsx("span",{className:"font-medium",children:w.name}),"?"]}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{type:"button",onClick:I,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"button",onClick:A,className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md transition-colors",children:"Delete"})]})]})})})]})},j5=({isVisible:n,onClose:e,mode:t,currentEnvelope:r,initialTransaction:i})=>{const{addTransaction:a,updateTransaction:o,deleteTransaction:c,currentMonth:u}=un(),[d,h]=U.useState(""),[p,m]=U.useState(""),[b,_]=U.useState(""),[w,S]=U.useState(new Date().toISOString().split("T")[0]),[T,C]=U.useState(null);U.useEffect(()=>{if(n)if(t==="edit"&&i){h(i.amount.toString()),m(i.merchant||""),_(i.description),C(i.paymentMethod||null);try{const A=new Date(i.date);isNaN(A.getTime())?(console.warn("Invalid date in transaction:",i.date),S(new Date().toISOString().split("T")[0])):S(A.toISOString().split("T")[0])}catch(A){console.error("Error parsing transaction date:",A),S(new Date().toISOString().split("T")[0])}}else h(""),m(""),_(""),S(new Date().toISOString().split("T")[0])},[n,t,i]);const R=async A=>{A.preventDefault();const I=parseFloat(d);if(isNaN(I)||I<=0){console.log(" Invalid amount:",d);return}console.log(" Saving transaction:",{mode:t,amount:I,note:b,date:w,envelopeId:r.id,paymentMethod:T});try{const k=new Date(w),z=`${k.getFullYear()}-${(k.getMonth()+1).toString().padStart(2,"0")}`;if(z!==u){const V=`This transaction date (${z}) does not match the current budget month (${u}). Are you sure you want to save it?`;if(!window.confirm(V))return}t==="add"?(console.log(" Adding income transaction"),await a({amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),envelopeId:r.id,type:"Income",reconciled:!1,paymentMethod:T||void 0})):t==="spend"?(console.log(" Adding expense transaction"),await a({amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),envelopeId:r.id,type:"Expense",reconciled:!1,paymentMethod:T||void 0})):t==="edit"&&i&&(console.log(" Updating transaction"),await o({...i,amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),paymentMethod:T||void 0})),console.log(" Transaction saved successfully"),e()}catch(k){console.error(" Error saving transaction:",k),alert("Failed to save transaction: "+(k instanceof Error?k.message:"Unknown error"))}},O=()=>{!i||!i.id||window.confirm("Are you sure you want to delete this transaction?")&&(c(i.id),e())},P=t==="add"?"Add Money":t==="spend"?"Spend Money":"Edit Transaction",N=t==="add"?"text-green-500":"text-red-500";return v.jsx(ci,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(xn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),v.jsxs(xn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden relative z-10",children:[v.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),v.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:P}),v.jsx("button",{onClick:R,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!d||parseFloat(d)<=0||i?.isAutomatic,children:i?.isAutomatic?"":"Save"})]}),v.jsxs("form",{onSubmit:R,className:"p-6 space-y-6",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${N}`,children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:d,onChange:A=>{const I=A.target.value.replace(/\D/g,"");if(!I){h("");return}const z=(parseInt(I,10)/100).toFixed(2);h(z)},onKeyDown:A=>{(A.key==="e"||A.key==="E"||A.key==="+"||A.key==="-")&&A.preventDefault()},placeholder:"0.00",autoFocus:!0,disabled:i?.isAutomatic,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${N} placeholder-gray-700 ${i?.isAutomatic?"cursor-not-allowed opacity-80":""}`})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),v.jsx("input",{type:"text",value:p,onChange:A=>m(A.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none",disabled:i?.isAutomatic})]}),!i?.isAutomatic&&v.jsx(O5,{selectedCard:T,onCardSelect:C}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),v.jsx("input",{type:"text",value:b,onChange:A=>_(A.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none",disabled:i?.isAutomatic})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const A=new Date(w);return`${A.getFullYear()}-${(A.getMonth()+1).toString().padStart(2,"0")}`!==u?v.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[v.jsx(Qu,{size:14}),v.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),v.jsx("input",{type:"date",value:w,onChange:A=>{console.log("Date changed to:",A.target.value),S(A.target.value)},required:!0,disabled:i?.isAutomatic,className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark] disabled:opacity-80"})]}),t==="edit"&&!i?.isAutomatic&&v.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-zinc-800",children:v.jsxs("button",{type:"button",onClick:O,className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-50 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-200 dark:border-zinc-800",children:[v.jsx(wN,{className:"w-5 h-5 mr-2"}),"Delete Transaction"]})})]})]})]})})},nne=({isVisible:n,onClose:e,sourceEnvelope:t})=>{const{envelopes:r,transferFunds:i}=un(),[a,o]=U.useState(""),[c,u]=U.useState(""),[d,h]=U.useState(""),[p,m]=U.useState(new Date().toISOString().split("T")[0]),b=r.filter(S=>S.id!==t.id);U.useEffect(()=>{if(!n)return;const S=window.setTimeout(()=>{o(""),u(""),h(""),m(new Date().toISOString().split("T")[0])},0);return()=>window.clearTimeout(S)},[n]);const _=S=>{S.preventDefault();const T=parseFloat(c);isNaN(T)||T<=0||!a||(i(t.id,a,T,d,new Date(p)),e())},w=r.find(S=>S.id===a);return v.jsx(ci,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(xn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),v.jsxs(xn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden relative z-10",children:[v.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),v.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:"Transfer Money"}),v.jsx("button",{onClick:_,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!c||parseFloat(c)<=0||!a,children:"Transfer"})]}),v.jsxs("form",{onSubmit:_,className:"p-6 space-y-6",children:[v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"From"}),v.jsx("div",{className:"text-gray-900 dark:text-white font-medium",children:t.name})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"To"}),v.jsxs("select",{value:a,onChange:S=>o(S.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none cursor-pointer",children:[v.jsx("option",{value:"",className:"bg-white dark:bg-zinc-900",children:"Select envelope..."}),b.map(S=>v.jsx("option",{value:S.id,className:"bg-white dark:bg-zinc-900",children:S.name},S.id))]})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl text-blue-600 dark:text-blue-400",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:c,onChange:S=>{const T=S.target.value.replace(/\D/g,"");if(!T){u("");return}const R=(parseInt(T,10)/100).toFixed(2);u(R)},onKeyDown:S=>{(S.key==="e"||S.key==="E"||S.key==="+"||S.key==="-")&&S.preventDefault()},placeholder:"0.00",autoFocus:!0,className:"bg-transparent text-4xl font-bold text-center w-40 focus:outline-none text-blue-600 dark:text-blue-400 placeholder-gray-400 dark:placeholder-gray-600"})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note (Optional)"}),v.jsx("input",{type:"text",value:d,onChange:S=>h(S.target.value),placeholder:"What is this transfer for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Date"}),v.jsx("input",{type:"date",value:p,onChange:S=>m(S.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),w&&c&&parseFloat(c)>0&&v.jsxs("div",{className:"text-center text-sm text-gray-500 dark:text-zinc-400 pt-2 border-t border-gray-200 dark:border-zinc-800",children:["Moving ",v.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-bold",children:["$",parseFloat(c).toFixed(2)]})," from"," ",v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:t.name})," to"," ",v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:w.name})]})]})]})]})})},rne=({isOpen:n,onClose:e,onSave:t,existingPiggybank:r})=>{const[i,a]=U.useState(""),[o,c]=U.useState(""),[u,d]=U.useState(""),[h,p]=U.useState("#3B82F6"),[m,b]=U.useState("piggy-bank"),[_,w]=U.useState(!1),[S,T]=U.useState(!1);U.useEffect(()=>{r?(a(r.name),c(r.piggybankConfig?.targetAmount?.toString()||""),d(r.piggybankConfig?.monthlyContribution.toString()||"0"),p(r.piggybankConfig?.color||"#3B82F6"),b(r.piggybankConfig?.icon||"piggy-bank"),w(r.piggybankConfig?.paused||!1)):(a(""),c(""),d(""),p("#3B82F6"),b("piggy-bank"),w(!1))},[r,n]);const C=async O=>{if(O.preventDefault(),!(!i.trim()||!u)){T(!0);try{const P={name:i.trim(),isPiggybank:!0,piggybankConfig:{monthlyContribution:parseFloat(u),color:h,icon:m,paused:_}};o&&parseFloat(o)>0&&(P.piggybankConfig.targetAmount=parseFloat(o)),r&&(P.id=r.id,P.currentBalance=r.currentBalance,P.lastUpdated=new Date().toISOString(),P.isActive=r.isActive,P.orderIndex=r.orderIndex,P.userId=r.userId),await t(P),e()}catch(P){console.error("Error saving piggybank:",P),alert("Failed to save piggybank")}finally{T(!1)}}},R=[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#F59E0B",label:"Amber"},{value:"#EF4444",label:"Red"},{value:"#8B5CF6",label:"Purple"},{value:"#EC4899",label:"Pink"}];return v.jsx(ci,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(xn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),v.jsxs(xn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"sticky top-0 bg-white dark:bg-zinc-900 border-b border-gray-200 dark:border-zinc-800 px-6 py-4 flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center",children:v.jsx(yp,{size:20,className:"text-blue-600 dark:text-blue-400"})}),v.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:r?"Edit Piggybank":"New Piggybank"})]}),v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:v.jsx(Sv,{size:24})})]}),v.jsxs("form",{onSubmit:C,className:"p-6 space-y-5",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"piggybank-name",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Piggybank Name *"}),v.jsx("input",{type:"text",id:"piggybank-name",value:i,onChange:O=>a(O.target.value),placeholder:"e.g. Vacation Fund, Emergency Savings",className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:!0,autoFocus:!0})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"monthly-contribution",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Monthly Auto-Contribution *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",id:"monthly-contribution",value:u,onChange:O=>{const P=O.target.value.replace(/\D/g,"");if(!P){d("");return}const A=(parseInt(P,10)/100).toFixed(2);d(A)},placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:!0})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"This amount will be automatically added each month and deducted from Available to Budget"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Target Goal (Optional)"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",id:"target-amount",value:o,onChange:O=>{const P=O.target.value.replace(/\D/g,"");if(!P){c("");return}const A=(parseInt(P,10)/100).toFixed(2);c(A)},placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Set a savings goal to track progress"})]}),v.jsx("div",{className:"space-y-2",children:v.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[v.jsx("input",{type:"checkbox",checked:_,onChange:O=>w(O.target.checked),className:"w-5 h-5 rounded border-gray-300 dark:border-zinc-700 text-blue-600 focus:ring-2 focus:ring-blue-500"}),v.jsxs("div",{children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Pause auto-contributions"}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Monthly contributions will be skipped while paused"})]})]})}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:R.map(O=>v.jsx("button",{type:"button",onClick:()=>p(O.value),className:`w-full aspect-square rounded-lg transition-all ${h===O.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-zinc-900":"hover:scale-110"}`,style:{backgroundColor:O.value},title:O.label},O.value))})]}),v.jsxs("div",{className:"pt-4 flex gap-3",children:[v.jsx("button",{type:"button",onClick:e,className:"flex-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 font-semibold bg-white dark:bg-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",disabled:S,children:"Cancel"}),v.jsx("button",{type:"submit",disabled:!i.trim()||!u||S,className:`flex-1 py-3 px-4 rounded-xl font-semibold shadow-sm text-white transition-colors ${i.trim()&&u&&!S?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-300 dark:bg-zinc-600 cursor-not-allowed"}`,children:S?"Saving...":r?"Update":"Create"})]})]})]})]})})},ine=n=>{if(!n)return"No Date";try{let e;return n&&typeof n=="object"&&n.toDate&&typeof n.toDate=="function"?e=n.toDate():typeof n=="number"?n<1e10?e=new Date((n+978307200)*1e3):e=new Date(n):e=new Date(n),isNaN(e.getTime())?"Invalid Date":new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(e)}catch(e){return console.error("Date error:",e),"Error"}},ane=n=>{const e=typeof n=="string"?parseFloat(n):n;return typeof e!="number"||isNaN(e)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.abs(e))},V5=({transaction:n,envelopeName:e,onReconcile:t,onEdit:r})=>{if(!n)return null;console.log(" Transaction payment method:",n.paymentMethod);const i=n.type==="Income",a=n.type==="Expense";let o="text-gray-900 dark:text-white";return i&&(o="text-green-600 dark:text-green-400"),a&&(o="text-red-600 dark:text-red-400"),v.jsxs("div",{onClick:r,className:"flex items-center justify-between p-4 bg-white dark:bg-zinc-900 active:bg-gray-50 dark:active:bg-zinc-800 active:scale-[0.99] transition-all cursor-pointer group border-b border-gray-100 dark:border-zinc-800 last:border-0",children:[v.jsxs("div",{className:"flex flex-col gap-1 overflow-hidden",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"font-semibold text-gray-900 dark:text-white truncate",children:n.merchant||n.description||"No Description"}),n.reconciled&&v.jsx("span",{className:"text-[10px] bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 px-1.5 py-0.5 rounded-full font-bold uppercase tracking-wide",children:"R"})]}),n.merchant&&n.description&&n.description!==n.merchant&&v.jsx("div",{className:"text-xs text-gray-600 dark:text-zinc-400 truncate",children:n.description}),v.jsxs("div",{className:"text-xs text-gray-500 dark:text-zinc-500 flex items-center gap-1 flex-wrap",children:[v.jsx("span",{children:ine(n.date)}),e&&v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""}),v.jsx("span",{className:"text-blue-500 dark:text-blue-400 truncate max-w-[150px]",children:e})]}),n.paymentMethod&&v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""}),v.jsxs("span",{className:"flex items-center gap-1",children:[v.jsx("span",{className:"w-[12px] h-[8px] rounded-[2px] flex-shrink-0",style:{backgroundColor:n.paymentMethod.color}}),v.jsx("span",{className:"truncate max-w-[80px]",children:n.paymentMethod.name})]})]})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("div",{className:`font-bold font-mono whitespace-nowrap ${o}`,children:[a?"-":i?"+":"",ane(n.amount)]}),t?v.jsx("button",{type:"button",onClick:c=>{c.stopPropagation(),t()},className:"p-1.5 rounded-full border border-transparent hover:border-green-200 dark:hover:border-green-500 transition-colors","aria-label":n.reconciled?"Mark as unreconciled":"Mark as reconciled",children:n.reconciled?v.jsx(ys,{className:"text-green-500",size:20}):v.jsx(R2,{className:"text-gray-400",size:20})}):v.jsx("span",{children:n.reconciled?v.jsx(ys,{className:"text-green-500",size:20}):v.jsx(R2,{className:"text-gray-400",size:20})})]})]})},S1=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n),sne=()=>{const{id:n}=d6(),{envelopes:e,transactions:t,fetchData:r,isLoading:i,deleteEnvelope:a,renameEnvelope:o,updateTransaction:c,deleteTransaction:u,restoreTransaction:d,getEnvelopeBalance:h,currentMonth:p,allocations:m,incomeSources:b,setEnvelopeAllocation:_,updatePiggybankContribution:w,updateEnvelope:S}=un(),{showToast:T}=jc(),C=Ka(),R=ca(),[O,P]=U.useState(!1),[N,A]=U.useState(!1),[I,k]=U.useState(!1),[z,V]=U.useState(null),[B,j]=U.useState(!1),[X,H]=U.useState(!1),[$,W]=U.useState(""),ee=U.useRef(null),he=U.useRef(!1);U.useEffect(()=>{e.length===0&&r()},[]);const K=e.find(ue=>ue.id===n),G=async ue=>{if(K)try{const _e={...K,...ue,id:K.id,userId:K.userId,currentBalance:K.currentBalance,lastUpdated:new Date().toISOString(),isActive:K.isActive,orderIndex:K.orderIndex};await S(_e),T("Piggybank updated successfully","success"),j(!1)}catch(_e){console.error("Failed to update piggybank:",_e),T("Failed to update piggybank","error")}},Y=K?.isPiggybank?K.piggybankConfig?.monthlyContribution||0:m[p]?.find(ue=>ue.envelopeId===n)?.budgetedAmount||0;U.useEffect(()=>{X&&(W(Y.toString()),setTimeout(()=>{ee.current?.focus(),ee.current?.select()},50))},[X,Y]);const re=ue=>{const _e=(b[p]||[]).reduce((Fe,Te)=>Fe+Te.amount,0),ze=m[p]||[];let qe=ze.map(Fe=>K&&Fe.envelopeId===K.id&&ue!==void 0?{...Fe,budgetedAmount:ue}:Fe).filter(Fe=>{const Te=e.find(Le=>Le.id===Fe.envelopeId);return Te?Te.isActive!==!1:!1}).reduce((Fe,Te)=>Fe+Te.budgetedAmount,0);return ue!==void 0&&K&&(ze.some(Te=>Te.envelopeId===K.id)||(qe+=ue)),_e-qe},oe=X?re(parseFloat($)||0):re(),fe=async()=>{if(!K||he.current)return;const ue=parseFloat($);if(isNaN(ue)||ue<0){T("Please enter a valid positive number","error");return}he.current=!0;try{K.isPiggybank?await w(K.id,ue):await _(K.id,ue),H(!1)}catch(_e){console.error("Failed to save budget:",_e),T("Failed to update budget","error")}finally{he.current=!1}};if(!K)return i?v.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:v.jsx("p",{children:"Loading envelope..."})}):v.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:v.jsx("p",{children:"Envelope not found."})});if(K.isPiggybank){const ue=t.filter(_e=>_e.envelopeId===K.id);console.log(" Piggybank:",K.name),console.log(" Created at:",K.createdAt),console.log(" Transactions:",ue.map(_e=>({date:_e.date,description:_e.description,amount:_e.amount})))}const be=t.filter(ue=>ue.envelopeId===K.id).filter(ue=>{if(ue.description==="Budgeted"||ue.description==="Piggybank Contribution")return!1;if(K.isPiggybank){if(!K.createdAt)return!0;const _e=vv(K.createdAt).toISOString().split("T")[0];return vv(ue.date).toISOString().split("T")[0]>=_e}return ue.month===p||!ue.month}).sort((ue,_e)=>new Date(_e.date).getTime()-new Date(ue.date).getTime()),Ce=()=>{R.state?.fromGlobalFAB?C("/"):C(-1)},we=()=>{n&&(a(n),C(-1))},Pe=ue=>{const _e={...ue,reconciled:!ue.reconciled};c(_e)};return v.jsxs("div",{className:"min-h-screen bg-white dark:bg-black text-gray-900 dark:text-white p-4 pb-[calc(8rem+env(safe-area-inset-bottom))] max-w-4xl mx-auto",children:[v.jsxs("header",{className:"flex justify-between items-center pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 bg-white dark:bg-black z-10 border-b border-gray-100 dark:border-zinc-800",children:[v.jsx("button",{onClick:()=>{if(K.isPiggybank)j(!0);else{const ue=prompt("Rename envelope:",K.name);ue&&ue.trim()&&n&&o(n,ue)}},className:"text-blue-600 dark:text-blue-400 font-medium",children:K.isPiggybank?"Edit":"Rename"}),v.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:K.name}),v.jsx("button",{onClick:Ce,className:"text-blue-600 dark:text-blue-400 font-bold",children:"Done"})]}),v.jsxs("section",{className:"mt-4 bg-white dark:bg-zinc-900 rounded-lg p-4 shadow-lg mb-4 border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-2",children:[v.jsx("span",{className:"text-lg font-headline text-gray-900 dark:text-white",children:"Current Balance"}),(()=>{const ue=K.isPiggybank?h(K.id):h(K.id,p);return console.log(`Debug: Envelope ${K.name} Balance:`,ue),v.jsx("span",{className:`text-xl font-bold ${ue<0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:S1(ue)})})()]}),v.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("span",{className:"text-sm font-medium text-gray-500 dark:text-zinc-400",children:K.isPiggybank?"Monthly Contribution":"Budgeted This Month"}),X?v.jsx("form",{onSubmit:ue=>{ue.preventDefault(),fe()},className:"flex items-center gap-2",children:v.jsx("input",{ref:ee,type:"number",step:"0.01",value:$,onChange:ue=>W(ue.target.value),onBlur:fe,className:"w-24 px-2 py-1 text-right font-semibold bg-gray-100 dark:bg-zinc-800 rounded border border-blue-500 focus:outline-none"})}):v.jsx("div",{onClick:()=>H(!0),className:"px-2 py-1 -mr-2 rounded hover:bg-gray-100 dark:hover:bg-zinc-800 cursor-pointer transition-colors",children:v.jsx("span",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:S1(Y)})})]}),v.jsxs("div",{className:`mt-3 py-1.5 px-3 rounded-md flex justify-between items-center text-xs font-medium transition-colors ${oe<0?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":oe===0?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300"}`,children:[v.jsx("span",{children:"Left to Budget:"}),v.jsx("span",{children:S1(oe)})]})]})]}),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg mb-4 divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:[v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-green-600 dark:text-green-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>P(!0),children:[v.jsx(jL,{className:"w-5 h-5 mr-3"}),"Add Money"]}),v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>A(!0),children:[v.jsx(PL,{className:"w-5 h-5 mr-3"}),"Spend Money"]}),v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>k(!0),children:[v.jsx(vL,{className:"w-5 h-5 mr-3"}),"Transfer Money"]})]}),v.jsxs("section",{className:"mt-6",children:[v.jsx("h2",{className:"text-sm font-semibold uppercase text-gray-500 dark:text-zinc-400 mb-2 px-2",children:"Transaction History"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:be.length===0?v.jsx("p",{className:"p-4 text-center text-gray-500 dark:text-zinc-400",children:"No transactions yet for this envelope."}):v.jsx(ci,{initial:!1,mode:"popLayout",children:be.map(ue=>v.jsx(xn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(by,{disabled:ue.isAutomatic,onDelete:()=>{if(!ue.id)return;const _e={...ue};u(ue.id),T("Transaction deleted","neutral",()=>d(_e))},children:v.jsx(V5,{transaction:ue,onReconcile:()=>Pe(ue),onEdit:()=>{ue.isAutomatic||V(ue)}})})},ue.id))})})]}),v.jsx("div",{className:"mt-8",children:v.jsxs("button",{className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-100 dark:border-zinc-800",onClick:()=>{const ue=K.isPiggybank?`Are you sure you want to delete "${K.name}"? This will delete the piggybank and all its history.`:`Are you sure you want to remove "${K.name}" from ${p}? This will delete all transactions for this month only.`;confirm(ue)&&we()},children:[v.jsx(wN,{className:"w-5 h-5 mr-2"}),"Delete Envelope"]})}),v.jsx(j5,{isVisible:O||N||!!z,onClose:()=>{P(!1),A(!1),V(null)},mode:O?"add":N?"spend":"edit",currentEnvelope:K,initialTransaction:z}),v.jsx(nne,{isVisible:I,onClose:()=>k(!1),sourceEnvelope:K}),v.jsx(rne,{isOpen:B,onClose:()=>j(!1),onSave:G,existingPiggybank:K})]})},one=({isVisible:n,onClose:e,onConfirm:t,currentMonth:r,incomeCount:i,totalIncome:a,allocationCount:o,totalAllocated:c,transactionCount:u,totalTransactionAmount:d,isLoading:h=!1})=>{const[p,m]=U.useState("confirm"),b=S=>{const[T,C]=S.split("-");return new Date(parseInt(T),parseInt(C)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},_=()=>{p==="confirm"?m("final_confirm"):p==="final_confirm"&&t()},w=()=>{m("confirm"),e()};return v.jsx(ci,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(xn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:w,className:"absolute inset-0 bg-black bg-opacity-50"}),v.jsxs(xn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[v.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Start Fresh for ",b(r)]}),v.jsx("button",{onClick:w,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",disabled:h,children:""})]}),v.jsx("div",{className:"p-6 space-y-4",children:p==="confirm"?v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),v.jsxs("div",{className:"ml-3",children:[v.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"This action will permanently delete:"}),v.jsx("div",{className:"mt-2 text-sm text-red-700 dark:text-red-300",children:v.jsxs("ul",{className:"space-y-1",children:[v.jsxs("li",{children:[" ",i," income source",i!==1?"s":""," (totaling $",a.toFixed(2),"/month)"]}),v.jsxs("li",{children:[" ",o," envelope allocation",o!==1?"s":""," (totaling $",c.toFixed(2),")"]}),v.jsxs("li",{children:[" ",u," transaction",u!==1?"s":""," (totaling $",d.toFixed(2),")"]})]})})]})]})}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),v.jsx("div",{className:"ml-3",children:v.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[v.jsx("strong",{children:"All other months will remain completely unchanged."})," This only affects the current month's budget data, income sources, allocations, and all transactions."]})})]})})]}):v.jsxs("div",{className:"text-center py-4",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900 mb-4",children:v.jsx("svg",{className:"h-6 w-6 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),v.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 dark:text-white mb-2",children:"Are you absolutely sure?"}),v.jsxs("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:["This action cannot be undone. All budget data and transactions for ",v.jsx("strong",{children:b(r)})," will be permanently removed."]})]})}),v.jsxs("div",{className:"flex gap-3 p-6 border-t border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{type:"button",onClick:w,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",disabled:h,children:"Cancel"}),v.jsx("button",{type:"button",onClick:_,disabled:h,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:h?"Clearing...":p==="confirm"?"Continue":"Yes, Start Fresh"})]})]})]})})},lne=()=>{const n=Ka(),e=U.useRef(null),{envelopes:t,transactions:r,resetData:i,importData:a,getEnvelopeBalance:o,appSettings:c,updateAppSettings:u,initializeAppSettings:d,incomeSources:h,allocations:p,currentMonth:m,clearMonthData:b,handleUserLogout:_,resetOnboarding:w}=un(),{deleteAccount:S,currentUser:T,logout:C}=ea(),[R,O]=U.useState(null),[P,N]=U.useState(()=>localStorage.getItem("lastBackupDate")||"Never"),[A,I]=U.useState(!1),[k,z]=U.useState(""),[V,B]=U.useState(!1),[j,X]=U.useState(!1),[H,$]=U.useState(null),[W,ee]=U.useState(!1),[he,K]=U.useState(!1),G=978307200,Y=c?.theme??"system",re=c?.fontSize??"medium";U.useEffect(()=>{c||d().catch(Te=>{console.error("Failed to initialize app settings:",Te)})},[d,c]);const Z=(Te,Le)=>{O({type:Te,text:Le}),setTimeout(()=>O(null),3500)},oe=U.useMemo(()=>{const Te=t.length,Le=r.length,Me=m?p[m]||[]:[],Be=Object.values(h).reduce((pn,Ut)=>pn+Ut.length,0),lt=Me.length,At=t.reduce((pn,Ut)=>{const Cn=o(Ut.id);return pn+(typeof Cn=="number"?Cn:0)},0),et=0,ft=r.reduce((pn,Ut)=>{let Cn=0;if(typeof Ut.date=="string"){const Hr=Date.parse(Ut.date);Cn=Number.isNaN(Hr)?0:Hr}else typeof Ut.date=="number"&&(Cn=Ut.date<2e9?(Ut.date+G)*1e3:Ut.date);return Math.max(pn,Cn)},0),kt=et||ft?new Date(Math.max(et,ft)).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"Never";return{envelopeCount:Te,transactionCount:Le,incomeSourceCount:Be,allocationCount:lt,totalBalance:At,lastUpdated:kt}},[t,r,h,p,m]),fe=()=>{try{console.log(" Creating backup...");const Te={appVersion:"1.6.8",backupDate:Date.now(),appSettings:c||{theme:"system"},envelopes:t.map(At=>({...At,currentBalance:(()=>{const et=o(At.id);return typeof et=="number"?et:0})(),lastUpdated:new Date().toISOString()})),transactions:r,allocations:p,incomeSources:h},Le=new Blob([JSON.stringify(Te,null,2)],{type:"application/json"}),Me=URL.createObjectURL(Le),Be=document.createElement("a");Be.href=Me,Be.download=`HouseBudget_Backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(Be),Be.click(),document.body.removeChild(Be),URL.revokeObjectURL(Me);const lt=new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});localStorage.setItem("lastBackupDate",lt),N(lt),$({success:!0,message:"Backup downloaded successfully."})}catch(Te){console.error(Te),$({success:!1,message:"Failed to create backup file.",onRetry:fe})}},be=()=>{X(!0),$(null);try{const Te=["Date","Merchant","Payment Method","Notes","Amount","Type","Envelope","Reconciled"],Le=r.filter(et=>et.description!=="Budgeted"&&et.description!=="Piggybank Contribution").map(et=>{const ft=t.find(ua=>ua.id===et.envelopeId)?.name||"Unknown",kt=(et.merchant||"").replace(/"/g,'""'),pn=(et.description||"").replace(/"/g,'""');let Ut="";et.paymentMethod&&(Ut=`${et.paymentMethod.name} (...${et.paymentMethod.last4})`);const Cn=Ut.replace(/"/g,'""');let Hr="Invalid Date";if(et.date){if(typeof et.date=="string")Hr=et.date.split("T")[0];else if(typeof et.date=="number"){const ua=et.date<2e9?(et.date+G)*1e3:et.date;Hr=new Date(ua).toISOString().split("T")[0]}}return[Hr,`"${kt}"`,`"${Cn}"`,`"${pn}"`,et.amount.toFixed(2),et.type,`"${ft}"`,et.reconciled?"Yes":"No"].join(",")}),Me=[Te.join(","),...Le].join(`
`),Be=new Blob([Me],{type:"text/csv;charset=utf-8;"}),lt=URL.createObjectURL(Be),At=document.createElement("a");At.href=lt,At.download=`HouseBudget_Transactions_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(At),At.click(),document.body.removeChild(At),URL.revokeObjectURL(lt),$({success:!0,message:"Transactions CSV exported successfully."})}catch(Te){console.error(Te),$({success:!1,message:"Failed to export CSV. Please try again.",onRetry:be})}finally{X(!1)}},Ce=()=>{e.current?.click()},we=Te=>{const Le=Te.target.files?.[0];if(!Le)return;const Me=new FileReader;Me.onload=async Be=>{try{const lt=JSON.parse(Be.target?.result),At=await a(lt);if(!At.success){Z("error",At.message);return}if(lt.appSettings?.theme)try{await u({theme:lt.appSettings.theme})}catch(et){console.error("Failed to update imported settings:",et)}Z("success",`Loaded ${lt.envelopes?.length??0} envelopes, ${lt.transactions?.length??0} transactions.`)}catch(lt){console.error(lt),Z("error","Invalid backup file. Please verify the JSON.")}},Me.readAsText(Le),Te.target.value=""},Pe=async()=>{if(window.confirm("Are you sure? This will permanently delete all envelopes, transactions, budget allocations, income sources, and settings from the cloud. This action cannot be undone."))try{await i(),Z("success","All data has been permanently deleted."),n("/")}catch(Te){console.error("Reset failed:",Te),Z("error","Failed to delete all data. Some data may remain.")}},ue=async()=>{if(!k.trim()){Z("error","Please enter your password to confirm account deletion.");return}I(!0);try{await i(),await S(k)?Z("success","Your account has been permanently deleted."):Z("error","Failed to delete account. Please try again.")}catch(Te){console.error("Account deletion failed:",Te),Z("error","Failed to delete account. Please try again.")}finally{I(!1),B(!1),z("")}},_e=async()=>{if(!T){Z("error","You must be logged in to clean up data.");return}ee(!0);try{const Te=await GS.cleanupOrphanedData(T.id),Le=Te.orphanedAllocationsDeleted+Te.orphanedTransactionsDeleted;Le>0?Z("success",`Cleaned ${Le} orphaned items: ${Te.orphanedAllocationsDeleted} allocations and ${Te.orphanedTransactionsDeleted} transactions.`):Z("success","No orphaned data found. Your database is already clean!")}catch(Te){console.error("Cleanup failed:",Te),Z("error","Failed to clean up orphaned data. Please try again.")}finally{ee(!1)}},ze=()=>{K(!0)},Ne=async()=>{K(!1),await b(m),Z("success","Month data has been reset.")},qe=async()=>{if(window.confirm("Are you sure you want to log out? This will clear all your data from the app until you log back in."))try{_(),C(),n("/")}catch(Te){console.error("Logout failed:",Te)}},Fe=T?.displayName?.charAt(0)?.toUpperCase()||T?.email?.charAt(0)?.toUpperCase()||"U";return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black transition-colors duration-200",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-center shadow-sm relative",children:[v.jsx("button",{onClick:()=>n(-1),className:"absolute left-4 text-blue-600 dark:text-blue-400 font-medium",children:"Done"}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Settings"})]}),v.jsxs("div",{className:"p-4 space-y-6 max-w-4xl mx-auto pb-[calc(8rem+env(safe-area-inset-bottom))]",children:[R&&v.jsxs("div",{className:`px-4 py-3 rounded-2xl text-sm font-medium flex items-center gap-2 ${R.type==="success"?"bg-green-50 text-green-700 dark:bg-emerald-900/30 dark:text-emerald-200":"bg-red-50 text-red-700 dark:bg-red-900/30 dark:text-red-200"}`,children:[R.type==="success"?v.jsx(I1,{size:18}):v.jsx(T0,{size:18}),R.text]}),v.jsx("section",{children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4 flex items-center gap-4",children:[v.jsx("div",{className:"w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center text-white text-2xl font-semibold shadow-md",children:Fe}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white truncate",children:T?.displayName||T?.email?.split("@")[0]||"User"}),v.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400 truncate",children:T?.email}),v.jsxs("button",{onClick:qe,className:"mt-2 text-sm text-red-600 dark:text-red-400 font-medium flex items-center gap-1 hover:underline",children:[v.jsx(o9,{size:14})," Log Out"]})]})]})}),v.jsx("section",{children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-5 space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(k2,{className:"text-blue-500",size:22}),v.jsxs("div",{children:[v.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Backup & Restore"}),v.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Create backups of all your data including envelopes, transactions, budget allocations, income sources, and settings."})]})]}),v.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 pt-2",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Envelopes"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:oe.envelopeCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Transactions"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:oe.transactionCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Income Sources"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:oe.incomeSourceCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Allocations"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:oe.allocationCount})]})]})]})}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Categories"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:v.jsxs("button",{onClick:()=>n("/settings/categories"),className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("span",{className:"text-xl",children:""}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Manage Categories"})]}),v.jsx(Ra,{className:"text-gray-400",size:18})]})})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Appearance"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4 space-y-4",children:[v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[Y==="light"&&v.jsx("span",{className:"text-orange-500 text-lg",children:""}),Y==="dark"&&v.jsx("span",{className:"text-purple-500 text-lg",children:""}),Y==="system"&&v.jsx("span",{className:"text-gray-500 text-lg",children:""}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Theme"})]}),v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 capitalize",children:Y})]}),v.jsx("div",{className:"flex gap-2",children:[{label:"Light",value:"light"},{label:"Dark",value:"dark"},{label:"System",value:"system"}].map(Te=>v.jsx("button",{onClick:async()=>{try{await u({theme:Te.value})}catch(Le){console.error("Failed to update theme setting:",Le)}},className:`flex-1 py-2 rounded-lg text-sm font-medium border transition-colors ${Y===Te.value?"bg-blue-50 dark:bg-blue-900/30 border-blue-500 text-blue-700 dark:text-blue-200":"border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 hover:border-gray-300 dark:hover:border-zinc-600"}`,children:Te.label},Te.value))})]}),v.jsx("div",{className:"h-px bg-gray-100 dark:bg-zinc-800"}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("span",{className:"text-gray-500 text-lg",children:"Aa"}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Font Size"})]}),v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 capitalize",children:re})]}),v.jsx("div",{className:"flex gap-2",children:[{label:"A",value:"extra-small",sizeClass:"text-[10px]"},{label:"A",value:"small",sizeClass:"text-xs"},{label:"A",value:"medium",sizeClass:"text-base"},{label:"A",value:"large",sizeClass:"text-xl"},{label:"A",value:"extra-large",sizeClass:"text-2xl"}].map(Te=>v.jsx("button",{onClick:async()=>{try{await u({fontSize:Te.value})}catch(Le){console.error("Failed to update font size setting:",Le)}},className:`flex-1 py-2 rounded-lg font-medium border transition-colors flex items-center justify-center ${re===Te.value?"bg-blue-50 dark:bg-blue-900/30 border-blue-500 text-blue-700 dark:text-blue-200":"border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 hover:border-gray-300 dark:hover:border-zinc-600"}`,children:v.jsx("span",{className:Te.sizeClass,children:Te.label})},Te.value))})]})]})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Help & Guide"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:v.jsxs("button",{onClick:()=>{w(),n("/")},className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(zh,{className:"text-purple-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Restart Onboarding Guide"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"View the welcome tutorial again"})]})]}),v.jsx(Ra,{className:"text-gray-400",size:18})]})})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Actions"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:[v.jsxs("button",{onClick:fe,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(k2,{className:"text-blue-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Create Backup"}),v.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["Last backup: ",P]})]})]}),v.jsx(Ra,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:Ce,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(P9,{className:"text-blue-500",size:20}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Restore from Backup"})]}),v.jsx(Ra,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:be,disabled:j,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[j?v.jsx(N2,{className:"text-blue-500 animate-spin",size:20}):v.jsx(XL,{className:"text-blue-500",size:20}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:j?"Preparing CSV":"Export Transactions (CSV)"})]}),v.jsx(Ra,{className:"text-gray-400",size:18})]}),v.jsx("input",{type:"file",ref:e,onChange:we,accept:".json",className:"hidden"})]})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Danger Zone"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm",children:[v.jsxs("button",{onClick:ze,className:"w-full p-4 flex items-center justify-between hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Vh,{className:"text-orange-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Start Fresh (This Month)"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Clear all allocations and data for the current month only"})]})]}),v.jsx(Ra,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:_e,disabled:W,className:"w-full p-4 flex items-center justify-between hover:bg-yellow-50 dark:hover:bg-yellow-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800 disabled:opacity-60 disabled:cursor-not-allowed",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[W?v.jsx(N2,{className:"text-yellow-500 animate-spin",size:20}):v.jsx(zh,{className:"text-yellow-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:W?"Cleaning Data...":"Purge Orphaned Data"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Remove allocations and transactions pointing to deleted envelopes"})]})]}),v.jsx(Ra,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:Pe,className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(T0,{className:"text-red-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Reset All Data"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Permanently delete everything"})]})]}),v.jsx(Ra,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:()=>B(!0),className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Qu,{className:"text-red-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Delete Account"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Permanently delete your account and all data"})]})]}),v.jsx(Ra,{className:"text-gray-400",size:18})]})]})]}),v.jsxs("div",{className:"text-center py-4",children:[v.jsxs("p",{className:"text-xs text-gray-400 dark:text-zinc-500",children:["Version ","1.6.8"," (PWA)"]}),"        "]}),H&&v.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 max-w-sm w-full",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[H.success?v.jsx(I1,{className:"text-green-500",size:24}):v.jsx(Qu,{className:"text-red-500",size:24}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:H.success?"Success":"Error"})]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-300 mb-4",children:H.message}),v.jsxs("div",{className:"flex gap-2",children:[H.onRetry&&v.jsx("button",{onClick:()=>{$(null),H.onRetry?.()},className:"flex-1 py-2 px-4 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors",children:"Retry"}),v.jsx("button",{onClick:()=>$(null),className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-zinc-700 text-gray-900 dark:text-white rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-zinc-600 transition-colors",children:"Close"})]})]})}),v.jsx(one,{isVisible:he,onClose:()=>K(!1),onConfirm:Ne,currentMonth:m,incomeCount:(h[m]||[]).length,totalIncome:(h[m]||[]).reduce((Te,Le)=>Te+Le.amount,0),allocationCount:(p[m]||[]).filter(Te=>t.some(Le=>Le.id===Te.envelopeId)).length,totalAllocated:(p[m]||[]).filter(Te=>t.some(Le=>Le.id===Te.envelopeId)).reduce((Te,Le)=>Te+Le.budgetedAmount,0),transactionCount:r.filter(Te=>Te.month===m).length,totalTransactionAmount:r.filter(Te=>Te.month===m).reduce((Te,Le)=>Te+Le.amount,0)}),V&&v.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 max-w-sm w-full",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[v.jsx(Qu,{className:"text-red-500",size:24}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Account"})]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-300 mb-4",children:"This action cannot be undone. This will permanently delete your account and remove all data from our servers."}),v.jsx("input",{type:"password",value:k,onChange:Te=>z(Te.target.value),placeholder:"Enter your password",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 mb-4"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>{B(!1),z("")},className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-zinc-700 text-gray-900 dark:text-white rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-zinc-600 transition-colors",children:"Cancel"}),v.jsx("button",{onClick:ue,disabled:A||!k.trim(),className:"flex-1 py-2 px-4 bg-red-500 text-white rounded-lg font-medium hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:A?"Deleting...":"Delete Account"})]})]})})]})]})},cne=()=>{const n=Ka(),{categories:e,addCategory:t,updateCategory:r,deleteCategory:i,reorderCategories:a}=un(),{showToast:o}=jc(),[c,u]=U.useState(!1),[d,h]=U.useState(""),[p,m]=U.useState(null),[b,_]=U.useState(""),w=async R=>{if(R.preventDefault(),!!d.trim())try{await t({name:d.trim(),orderIndex:e.length,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),h(""),u(!1),o("Category added","success")}catch(O){console.error(O),o("Failed to add category","error")}},S=async R=>{if(!b.trim())return;const O=e.find(P=>P.id===R);if(O)try{await r({...O,name:b.trim()}),m(null),o("Category updated","success")}catch(P){console.error(P),o("Failed to update category","error")}},T=async R=>{if(confirm("Are you sure? Envelopes in this category will become Uncategorized."))try{await i(R),o("Category deleted","success")}catch(O){console.error(O),o("Failed to delete category","error")}},C=async(R,O)=>{if(O==="up"&&R===0||O==="down"&&R===e.length-1)return;const P=[...e],N=O==="up"?R-1:R+1;[P[R],P[N]]=[P[N],P[R]];const A=P.map(I=>I.id);try{await a(A)}catch(I){console.error(I),o("Failed to reorder","error")}};return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-20",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-10 flex items-center shadow-sm",children:[v.jsx("button",{onClick:()=>n(-1),className:"mr-3 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white",children:v.jsx(gc,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Manage Categories"})]}),v.jsxs("div",{className:"p-4 max-w-2xl mx-auto space-y-4",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:c?v.jsxs("form",{onSubmit:w,className:"flex gap-2",children:[v.jsx("input",{type:"text",value:d,onChange:R=>h(R.target.value),placeholder:"Category Name",className:"flex-1 px-3 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg outline-none dark:text-white",autoFocus:!0}),v.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium",children:"Save"}),v.jsx("button",{type:"button",onClick:()=>u(!1),className:"text-gray-500 px-2",children:"Cancel"})]}):v.jsxs("button",{onClick:()=>u(!0),className:"w-full flex items-center justify-center gap-2 text-blue-600 dark:text-blue-400 font-medium py-2",children:[v.jsx(bp,{size:20}),"Add Category"]})}),v.jsxs("div",{className:"space-y-2",children:[e.map((R,O)=>v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800 flex items-center justify-between group",children:p===R.id?v.jsxs("div",{className:"flex-1 flex gap-2",children:[v.jsx("input",{type:"text",value:b,onChange:P=>_(P.target.value),className:"flex-1 px-3 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg outline-none dark:text-white",autoFocus:!0}),v.jsx("button",{onClick:()=>S(R.id),className:"bg-green-600 text-white px-3 py-2 rounded-lg text-sm",children:"Save"}),v.jsx("button",{onClick:()=>m(null),className:"text-gray-500 px-2 text-sm",children:"Cancel"})]}):v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsxs("div",{className:"flex flex-col gap-1 text-gray-400",children:[v.jsx("button",{onClick:()=>C(O,"up"),disabled:O===0,className:"hover:text-blue-500 disabled:opacity-30 disabled:cursor-not-allowed",children:v.jsx(_L,{size:16})}),v.jsx("button",{onClick:()=>C(O,"down"),disabled:O===e.length-1,className:"hover:text-blue-500 disabled:opacity-30 disabled:cursor-not-allowed",children:v.jsx(pL,{size:16})})]}),v.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:R.name})]}),v.jsxs("div",{className:"flex gap-2 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity",children:[v.jsx("button",{onClick:()=>{m(R.id),_(R.name)},className:"p-2 text-gray-500 hover:text-blue-600 dark:hover:text-blue-400",children:v.jsx(f9,{size:18})}),v.jsx("button",{onClick:()=>T(R.id),className:"p-2 text-gray-500 hover:text-red-600 dark:hover:text-red-400",children:v.jsx(T0,{size:18})})]})]})},R.id)),e.length===0&&!c&&v.jsx("div",{className:"text-center text-gray-500 dark:text-zinc-500 py-8",children:"No categories yet. Add one to get started."})]})]})]})},une=()=>{const{addEnvelope:n,setEnvelopeAllocation:e,currentMonth:t,categories:r,fetchCategories:i}=un(),{showToast:a}=jc(),o=Ka(),[c]=nL();nh.useEffect(()=>{r.length===0&&i()},[r.length,i]);const[u,d]=U.useState(""),[h,p]=U.useState(c.get("type")==="piggybank"),[m,b]=U.useState(c.get("categoryId")||""),[_,w]=U.useState(""),[S,T]=U.useState(""),[C,R]=U.useState("#3B82F6"),[O,P]=U.useState(!1),N=async A=>{if(A.preventDefault(),!u.trim()||O)return;P(!0);const I=un.getState().envelopes,z=(I.length>0?Math.max(...I.map(X=>X.orderIndex??0)):-1)+1,V=h?new Date(`${t}-01T00:00:00`):new Date,B={name:u,currentBalance:0,lastUpdated:new Date().toISOString(),createdAt:V.toISOString(),isActive:!0,orderIndex:z,categoryId:m||void 0};if(h){B.isPiggybank=!0;const X={monthlyContribution:parseFloat(S||"0"),color:C,icon:"piggy-bank"};_&&parseFloat(_)>0&&(X.targetAmount=parseFloat(_)),B.piggybankConfig=X}n(B).then(X=>{if(X){const H=h?parseFloat(S||"0"):0;e(X,H).catch($=>console.error("Failed to create allocation:",$)),setTimeout(()=>{o("/")},50)}}).catch(X=>{console.error("Failed to create envelope:",X),a(X.message||"Failed to create envelope","error"),P(!1)})};return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-[calc(8rem+env(safe-area-inset-bottom))]",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-10 flex items-center shadow-sm",children:[v.jsx("button",{onClick:()=>o("/"),className:"mr-3 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white",children:v.jsx(gc,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:h?"New Piggybank":"New Envelope"})]}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:[v.jsx("div",{className:"p-6 bg-blue-50 dark:bg-zinc-800 border-b border-blue-100 dark:border-zinc-700 flex justify-center py-8",children:v.jsx("div",{className:"w-20 h-20 bg-blue-100 dark:bg-zinc-700 text-blue-600 dark:text-blue-400 rounded-full flex items-center justify-center",children:h?v.jsx(yp,{size:40}):v.jsx(QL,{size:40})})}),v.jsxs("form",{onSubmit:N,className:"p-6 space-y-6 pb-6",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Type"}),v.jsxs("div",{className:"flex bg-gray-100 dark:bg-zinc-800 p-1 rounded-xl",children:[v.jsx("button",{type:"button",onClick:()=>p(!1),className:`flex-1 py-2 px-4 rounded-lg text-sm font-semibold transition-all ${h?"text-gray-500 dark:text-zinc-400 hover:text-gray-700 dark:hover:text-zinc-300":"bg-white dark:bg-zinc-700 text-blue-600 dark:text-blue-400 shadow-sm"}`,children:"Spending"}),v.jsx("button",{type:"button",onClick:()=>p(!0),className:`flex-1 py-2 px-4 rounded-lg text-sm font-semibold transition-all ${h?"bg-white dark:bg-zinc-700 text-blue-600 dark:text-blue-400 shadow-sm":"text-gray-500 dark:text-zinc-400 hover:text-gray-700 dark:hover:text-zinc-300"}`,children:"Piggybank"})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Category"}),v.jsxs("select",{id:"category",value:m,onChange:A=>b(A.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all appearance-none",children:[v.jsx("option",{value:"",children:"Uncategorized"}),r.map(A=>v.jsx("option",{value:A.id,children:A.name},A.id))]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:h?"Piggybank Name":"Envelope Name"}),v.jsx("input",{type:"text",id:"name",value:u,onChange:A=>d(A.target.value),placeholder:h?"e.g. Vacation Fund, Emergency Savings":"e.g. Groceries, Rent, Fun Money",className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",autoFocus:!0,required:!0})]}),h&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"monthly-contribution",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Monthly Auto-Contribution *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"number",id:"monthly-contribution",value:S,onChange:A=>T(A.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:h})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"This amount will be automatically added each month and deducted from Available to Budget"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Target Goal (Optional)"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"number",id:"target-amount",value:_,onChange:A=>w(A.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Set a savings goal to track progress"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#F59E0B",label:"Amber"},{value:"#EF4444",label:"Red"},{value:"#8B5CF6",label:"Purple"},{value:"#EC4899",label:"Pink"}].map(A=>v.jsx("button",{type:"button",onClick:()=>R(A.value),className:`w-full aspect-square rounded-lg transition-all ${C===A.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-zinc-900":"hover:scale-110"}`,style:{backgroundColor:A.value},title:A.label},A.value))})]})]}),v.jsxs("div",{className:"pt-4 flex gap-3",children:[v.jsx("button",{type:"button",onClick:()=>o("/"),className:"flex-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 font-semibold bg-white dark:bg-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",children:"Cancel"}),v.jsx("button",{type:"submit",disabled:!u.trim()||h&&!S||O,className:`flex-1 py-3 px-4 rounded-xl font-semibold shadow-sm text-white transition-colors ${u.trim()&&(!h||S)&&!O?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-300 dark:bg-zinc-600 cursor-not-allowed"}`,children:O?"Creating...":h?"Create Piggybank":"Create Envelope"})]})]})]})})]})},dne=({envelopes:n,transactionAmount:e,onSplitChange:t})=>{const[r,i]=U.useState([]),[a,o]=U.useState({}),[c,u]=U.useState(e),d=_=>{i(w=>w.includes(_)?w.filter(S=>S!==_):[...w,_])},h=(_,w)=>{o(S=>({...S,[_]:w}))};U.useEffect(()=>{if(r.length===1){const _=r[0];o({[_]:e})}},[r.length,e]),U.useEffect(()=>{const _=Object.values(a).reduce((w,S)=>w+(S||0),0);u(e-_),t(a)},[a,e,t]),U.useEffect(()=>{const _={...a};Object.keys(_).forEach(w=>{r.includes(w)||delete _[w]}),Object.keys(_).length!==Object.keys(a).length&&o(_)},[r,a]);const p=()=>{i([]),o({})},m=Math.abs(c)<.01&&r.length>0,b=r.length>0&&Math.abs(c)>.01;return v.jsxs("div",{className:"space-y-3",children:[r.length>1&&v.jsxs("div",{className:`p-3 rounded-lg ${b?"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800":m?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-zinc-800 border border-gray-200 dark:border-zinc-700"}`,children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Remaining to Split:"}),v.jsxs("span",{className:`font-bold text-lg ${b?"text-red-600 dark:text-red-400":m?"text-green-600 dark:text-green-400":"text-gray-900 dark:text-white"}`,children:["$",c.toFixed(2)]})]}),b&&v.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Split amounts must equal transaction total"})]}),v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("label",{className:"text-xs text-gray-500 dark:text-zinc-400",children:r.length>1?"Split Across Envelopes":"Select Envelope"}),r.length>0&&v.jsx("button",{type:"button",onClick:p,className:"text-xs text-blue-600 dark:text-blue-400",children:"Clear All"})]}),v.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-200 dark:border-zinc-800 rounded-lg",children:n.map(_=>v.jsxs("div",{className:"flex items-center py-3 px-3 border-b border-gray-100 dark:border-zinc-800 last:border-b-0 hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsx("input",{type:"checkbox",checked:r.includes(_.id),onChange:()=>d(_.id),className:"mr-3 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),v.jsx("span",{className:"flex-1 text-gray-900 dark:text-white",children:_.name}),r.includes(_.id)&&r.length>1&&v.jsxs("div",{className:"flex items-center",children:[v.jsx("span",{className:"mr-1 text-gray-500 dark:text-zinc-400",children:"$"}),v.jsx("input",{type:"number",min:"0",step:"0.01",value:a[_.id]||"",onChange:w=>h(_.id,parseFloat(w.target.value)||0),className:"w-24 px-2 py-1 border border-gray-300 dark:border-zinc-700 rounded bg-white dark:bg-zinc-900 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]})]},_.id))})]})},z5=({onClose:n,onSaved:e})=>{const t=Ka(),{envelopes:r,addTransaction:i,currentMonth:a}=un(),[o,c]=U.useState(""),[u,d]=U.useState(""),[h,p]=U.useState(""),[m,b]=U.useState(()=>{const H=new Date;return new Date(H.getTime()-H.getTimezoneOffset()*6e4).toISOString().split("T")[0]}),[_,w]=U.useState("expense"),[S,T]=U.useState({}),[C,R]=U.useState(null),[O,P]=U.useState(!1),N=()=>{if(n){n();return}t(-1)},A=H=>{R(H),C&&P(!0)},I=Object.keys(S).length>0,k=Object.values(S).reduce((H,$)=>H+($||0),0),z=Math.abs(k-parseFloat(o||"0"))<.01,V=o&&parseFloat(o)>0&&I&&z,B=async H=>{if(H.preventDefault(),!V)return;const[$,W,ee]=m.split("-").map(Number),he=new Date($,W-1,ee,12,0,0);console.log(" Selected date:",m),console.log(" Parsed date:",he.toISOString());try{const[K,G]=m.split("-").map(Number),Y=`${K}-${G.toString().padStart(2,"0")}`;if(Y!==a){const Z=`This transaction date (${Y}) does not match the current budget month (${a}). Are you sure you want to save it?`;if(!window.confirm(Z))return}const re=Object.entries(S).filter(([Z,oe])=>oe>0);Promise.all(re.map(([Z,oe])=>i({amount:oe,description:h,merchant:u||void 0,date:he.toISOString(),envelopeId:Z,type:_==="income"?"Income":"Expense",reconciled:!1,paymentMethod:C||void 0}).catch(fe=>console.error("Failed to create transaction:",fe)))).catch(Z=>console.error("Failed to create transactions:",Z)),e&&e(),n?n():t("/")}catch(K){console.error("Error saving transaction:",K),alert("Failed to save transaction: "+(K instanceof Error?K.message:"Unknown error"))}},j=[...r].filter(H=>H.isActive!==!1).sort((H,$)=>{const W=H.orderIndex??0,ee=$.orderIndex??0;return W!==ee?W-ee:H.name.localeCompare($.name)}),X=_==="income"?"text-green-500":"text-red-500";return v.jsxs("div",{className:"h-screen overflow-y-auto bg-gray-50 dark:bg-black overscroll-contain",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b border-gray-200 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 z-20 flex items-center justify-between",children:[v.jsx("button",{onClick:N,className:"text-blue-600 dark:text-blue-400 font-medium",children:"Cancel"}),v.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"New Transaction"}),v.jsx("button",{onClick:B,disabled:!V,className:"text-blue-600 dark:text-blue-400 font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:"Save"})]}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto pb-[calc(8rem+env(safe-area-inset-bottom))]",children:v.jsxs("form",{onSubmit:B,className:"space-y-6",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl border border-gray-200 dark:border-zinc-800 overflow-hidden",children:v.jsxs("div",{className:"flex",children:[v.jsx("button",{type:"button",onClick:()=>w("expense"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${_==="expense"?"bg-red-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Expense"}),v.jsx("button",{type:"button",onClick:()=>w("income"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${_==="income"?"bg-green-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Income"})]})}),v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${X}`,children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:o,onChange:H=>{const $=H.target.value.replace(/\D/g,"");if(!$){c("");return}const ee=(parseInt($,10)/100).toFixed(2);c(ee)},onKeyDown:H=>{(H.key==="e"||H.key==="E"||H.key==="+"||H.key==="-")&&H.preventDefault()},placeholder:"0.00",autoFocus:!0,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${X} placeholder-gray-700`})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),v.jsx("input",{type:"text",value:u,onChange:H=>d(H.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsx(O5,{selectedCard:C,onCardSelect:A,isUserSelected:O}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),v.jsx("input",{type:"text",value:h,onChange:H=>p(H.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const[H,$]=m.split("-").map(Number);return`${H}-${$.toString().padStart(2,"0")}`!==a?v.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[v.jsx(Qu,{size:14}),v.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),v.jsx("input",{type:"date",value:m,onChange:H=>b(H.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 transition-colors",children:v.jsx(dne,{envelopes:j,transactionAmount:parseFloat(o)||0,onSplitChange:T})})]})})]})},fne=()=>{const n=Ka(),{transactions:e,envelopes:t,updateTransaction:r,deleteTransaction:i,restoreTransaction:a,currentMonth:o,appSettings:c}=un(),{showToast:u}=jc(),[d,h]=U.useState(!1),[p,m]=U.useState(""),[b,_]=U.useState("all"),[w,S]=U.useState("All"),[T,C]=U.useState(!1),[R,O]=U.useState("all"),[P,N]=U.useState(!1),[A,I]=U.useState("all"),[k,z]=U.useState(!1),[V,B]=U.useState(()=>{const K=new Date;return K.setMonth(K.getMonth()-1),K.toISOString().split("T")[0]}),[j,X]=U.useState(()=>new Date().toISOString().split("T")[0]),[H,$]=U.useState(null),W=U.useMemo(()=>{console.log(" Filtering transactions:",{totalTransactions:e.length,showAllTime:P,currentMonth:o,transactionMonths:e.map(Y=>({id:Y.id,month:Y.month,date:Y.date,description:Y.description}))});let K=e;return P||(K=e.filter(Y=>Y.month===o||!Y.month),console.log(" After month filter:",{remaining:K.length,currentMonth:o,filteredTransactions:K.map(Y=>({id:Y.id,description:Y.description,month:Y.month,matchesCurrentMonth:Y.month===o}))})),K.map(Y=>{if(!Y)return null;let re=Y.date;if(typeof Y.date=="number"){const oe=(Y.date+978307200)*1e3;re=new Date(oe).toISOString()}else if(!Y.date||typeof Y.date!="string")return null;return{...Y,date:re}}).filter(Boolean).filter(Y=>{if(Y.description==="Budgeted"||Y.description==="Piggybank Contribution")return!1;if(p){const Z=p.toLowerCase(),oe=t.find(Ce=>Ce.id===Y.envelopeId)?.name.toLowerCase()||"",fe=Y.amount.toFixed(2);if(!(Y.description.toLowerCase().includes(Z)||oe.includes(Z)||fe.includes(Z)))return!1}if(b!=="all"&&Y.envelopeId!==b||w!=="All"&&Y.type!==w||A!=="all"&&(!Y.paymentMethod||Y.paymentMethod.id!==A)||!Y.date||typeof Y.date!="string")return!1;const re=Y.date.split("T")[0];return!(k&&(re<V||re>j)||R!=="all"&&new Date(re).getMonth()!==parseInt(R)||T&&!Y.reconciled)}).sort((Y,re)=>new Date(re.date).getTime()-new Date(Y.date).getTime())},[e,t,p,b,w,A,V,j,T,P,o,k]);console.log(" Final filtered transactions:",{count:W.length,transactions:W.map(K=>({id:K.id,description:K.description,amount:K.amount,date:K.date,month:K.month,type:K.type}))});const ee=H?t.find(K=>K.id===H.envelopeId):null,he=K=>{const G={...K,reconciled:!K.reconciled};r(G)};return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-[calc(8rem+env(safe-area-inset-bottom))] transition-colors duration-200",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-between shadow-sm",children:[v.jsxs("div",{className:"flex items-center",children:[v.jsx("button",{onClick:()=>n(-1),className:"mr-3 text-gray-600 hover:text-gray-900 dark:text-zinc-400 dark:hover:text-white transition-colors",children:v.jsx(gc,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"All Transactions"})]}),v.jsx("button",{onClick:()=>h(!d),className:`p-2 rounded-full transition-colors ${d?"bg-blue-100 text-blue-600 dark:bg-blue-900/40 dark:text-blue-400":"text-gray-400 dark:text-zinc-600 hover:bg-gray-100 dark:hover:bg-zinc-800"}`,children:v.jsx(JL,{size:20,className:d?"fill-current":""})})]}),v.jsxs("div",{className:"px-4 py-2 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 flex justify-between items-center",children:[v.jsxs("div",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:["Month: ",o]}),v.jsx("button",{onClick:()=>N(!P),className:`text-sm px-3 py-1 rounded-md ${P?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-800 dark:bg-zinc-800 dark:text-zinc-300"}`,children:P?"Current Month Only":"All Time"})]}),v.jsx("div",{className:"px-4 py-3 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800",children:v.jsxs("div",{className:"relative",children:[v.jsx(b9,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),v.jsx("input",{type:"text",placeholder:"Search transactions...",value:p,onChange:K=>m(K.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none dark:text-white"}),p&&v.jsx("button",{onClick:()=>m(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",children:v.jsx(Sv,{size:16})})]})}),v.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 ${d?"max-h-[600px] opacity-100":"max-h-0 opacity-0"}`,children:v.jsxs("div",{className:"p-4 space-y-4",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Payment Method"}),v.jsxs("select",{value:A,onChange:K=>I(K.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Payment Methods"}),c?.paymentSources?.map(K=>v.jsx("option",{value:K.id,children:K.name},K.id))]})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Envelope"}),v.jsxs("select",{value:b,onChange:K=>_(K.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Envelopes"}),t.sort((K,G)=>K.name.localeCompare(G.name)).map(K=>v.jsx("option",{value:K.id,children:K.name},K.id))]})]}),v.jsx("div",{className:"bg-gray-100 dark:bg-zinc-800 p-1 rounded-lg flex",children:["All","Income","Expense"].map(K=>v.jsx("button",{onClick:()=>S(K),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${w===K?"bg-white dark:bg-zinc-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-zinc-500 hover:text-gray-700"}`,children:K},K))}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Month"}),v.jsxs("select",{value:R,onChange:K=>O(K.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Months"}),Array.from({length:12},(K,G)=>G).map(K=>v.jsx("option",{value:K,children:new Date(2022,K).toLocaleString("default",{month:"long"})},K))]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Date Range"}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("label",{className:"text-xs text-gray-600 dark:text-zinc-400",children:"Enable"}),v.jsx("button",{onClick:()=>z(!k),className:`w-9 h-5 rounded-full transition-colors relative ${k?"bg-blue-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-3 h-3 bg-white rounded-full transition-transform ${k?"translate-x-4":"translate-x-0"}`})})]})]}),v.jsxs("div",{className:`grid grid-cols-2 gap-4 transition-opacity ${k?"opacity-100":"opacity-50 pointer-events-none"}`,children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-[10px] font-medium text-gray-500 dark:text-zinc-500 uppercase",children:"From"}),v.jsx("div",{className:"relative",children:v.jsx("input",{type:"date",value:V,onChange:K=>B(K.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-[10px] font-medium text-gray-500 dark:text-zinc-500 uppercase",children:"To"}),v.jsx("div",{className:"relative",children:v.jsx("input",{type:"date",value:j,onChange:K=>X(K.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]})]})]}),v.jsxs("div",{className:"flex items-center justify-between pt-2",children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show only reconciled"}),v.jsx("button",{onClick:()=>C(!T),className:`w-11 h-6 rounded-full transition-colors relative ${T?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${T?"translate-x-5":"translate-x-0"}`})})]}),v.jsxs("div",{className:"flex items-center justify-between pt-2",children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show all time"}),v.jsx("button",{onClick:()=>N(!P),className:`w-11 h-6 rounded-full transition-colors relative ${P?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${P?"translate-x-5":"translate-x-0"}`})})]})]})}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:W.length===0?v.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-zinc-500",children:"No transactions match your filters."}):v.jsx(ci,{initial:!1,mode:"popLayout",children:W.map(K=>{const G=t.find(Y=>Y.id===K.envelopeId);return v.jsx(xn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(by,{disabled:K.isAutomatic,onDelete:()=>{if(!K.id)return;const Y={...K};i(K.id),u("Transaction deleted","neutral",()=>a(Y))},children:v.jsx(V5,{transaction:K,envelopeName:G?.name||"Unknown Envelope",onReconcile:()=>he(K),onEdit:()=>{K.isAutomatic||(G?$(K):alert("Cannot edit: Envelope deleted."))}})})},K.id)})})})}),v.jsx(j5,{isVisible:!!H&&!!ee,onClose:()=>$(null),mode:"edit",currentEnvelope:ee||{},initialTransaction:H})]})},Io=({children:n})=>v.jsx(xn.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2,ease:"easeInOut"},className:"w-full h-full bg-gray-50 dark:bg-black",children:n}),hne=()=>{const n=ca();return v.jsx(ci,{mode:"wait",children:v.jsxs(A6,{location:n,children:[v.jsx(vs,{path:"/",element:v.jsx(Io,{children:v.jsx(Ki,{children:v.jsx(ene,{})})})}),v.jsx(vs,{path:"/envelope/:id",element:v.jsx(Io,{children:v.jsx(Ki,{children:v.jsx(sne,{})})})}),v.jsx(vs,{path:"/add-envelope",element:v.jsx(Io,{children:v.jsx(Ki,{children:v.jsx(une,{})})})}),v.jsx(vs,{path:"/add-transaction",element:v.jsx(Io,{children:v.jsx(Ki,{children:v.jsx(z5,{})})})}),v.jsx(vs,{path:"/transactions",element:v.jsx(Io,{children:v.jsx(Ki,{children:v.jsx(fne,{})})})}),v.jsx(vs,{path:"/settings",element:v.jsx(Io,{children:v.jsx(Ki,{children:v.jsx(lne,{})})})}),v.jsx(vs,{path:"/settings/categories",element:v.jsx(Io,{children:v.jsx(Ki,{children:v.jsx(cne,{})})})}),v.jsx(vs,{path:"/verify-email",element:v.jsx(Io,{children:v.jsx(Ki,{children:v.jsx(FO,{})})})})]},n.pathname)})};function pne(){const[n,e]=U.useState(!0),[t,r]=U.useState(!1),{appSettings:i,isOnboardingActive:a}=un(),{isAuthenticated:o,isInitialized:c,initializeAuth:u,lastAuthTime:d,offlineGracePeriod:h,currentUser:p}=ea();if(U.useEffect(()=>{const _=setTimeout(()=>{e(!1)},2e3);return()=>clearTimeout(_)},[]),U.useEffect(()=>u(),[u]),U.useEffect(()=>{const _=document.documentElement,w=window.matchMedia("(prefers-color-scheme: dark)"),S=()=>{const T=i?.theme??"system",C=w.matches;T==="dark"||T==="system"&&C?_.classList.add("dark"):_.classList.remove("dark")};if(S(),i?.theme==="system")return w.addEventListener("change",S),()=>w.removeEventListener("change",S)},[i]),U.useEffect(()=>{const _=document.documentElement;switch(i?.fontSize??"medium"){case"extra-small":_.style.fontSize="75%";break;case"small":_.style.fontSize="87.5%";break;case"large":_.style.fontSize="112.5%";break;case"extra-large":_.style.fontSize="125%";break;default:_.style.fontSize="100%"}},[i?.fontSize]),n||!c)return v.jsx(GO,{message:"Initializing Personal Budget..."});if(!o)return p?v.jsx(Ki,{children:v.jsx(FO,{})}):v.jsx(Ki,{children:v.jsx(M$,{})});const b=typeof navigator<"u"&&!navigator.onLine&&o&&d&&Date.now()-d<h;return v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"fixed opacity-0 pointer-events-none -z-50",children:v.jsx("label",{id:"ios-haptic-trigger",htmlFor:"ios-haptic-checkbox",children:v.jsx("input",{type:"checkbox",id:"ios-haptic-checkbox",switch:"true"})})}),v.jsxs(Ki,{children:[b&&v.jsx("div",{className:"bg-yellow-100 dark:bg-yellow-900 border-l-4 border-yellow-500 text-yellow-700 dark:text-yellow-200 p-4",children:v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),v.jsx("div",{className:"ml-3",children:v.jsxs("p",{className:"text-sm",children:[v.jsx("strong",{children:"Offline Access:"})," You're using cached authentication. Expires in"," ",Math.ceil((h-(Date.now()-d))/(1440*60*1e3))," ","days. Connect to internet to refresh."]})})]})}),v.jsxs(Q6,{children:[v.jsx(hne,{}),t&&v.jsxs("div",{className:"fixed inset-0 z-[60]",children:[v.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>r(!1)}),v.jsx("div",{className:"absolute inset-0",children:v.jsx(z5,{onClose:()=>r(!1),onSaved:()=>r(!1)})})]}),!a&&v.jsx(yW,{onAddTransaction:()=>r(!0)})]}),v.jsx(vW,{})]})]})}Iz({onNeedRefresh(){},onOfflineReady(){console.log("App is ready for offline work")}});Tz.createRoot(document.getElementById("root")).render(v.jsx(U.StrictMode,{children:v.jsx(pne,{})}));export{pt as T,tt as a,I$ as b,VR as c,St as d,Sr as e,Qi as f,Bx as g,Zi as h,Vd as o,sa as q,ai as s,Yl as t,ka as u,S$ as w};
