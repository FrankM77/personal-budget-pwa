(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();function X5(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var d1={exports:{}},$f={};var eI;function W5(){if(eI)return $f;eI=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,i,a){var o=null;if(a!==void 0&&(o=""+a),i.key!==void 0&&(o=""+i.key),"key"in i){a={};for(var c in i)c!=="key"&&(a[c]=i[c])}else a=i;return i=a.ref,{$$typeof:t,type:r,key:o,ref:i!==void 0?i:null,props:a}}return $f.Fragment=e,$f.jsx=n,$f.jsxs=n,$f}var tI;function Q5(){return tI||(tI=1,d1.exports=W5()),d1.exports}var b=Q5(),f1={exports:{}},at={};var nI;function Z5(){if(nI)return at;nI=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),m=Symbol.iterator;function y(F){return F===null||typeof F!="object"?null:(F=m&&F[m]||F["@@iterator"],typeof F=="function"?F:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,E={};function T(F,Q,Y){this.props=F,this.context=Q,this.refs=E,this.updater=Y||_}T.prototype.isReactComponent={},T.prototype.setState=function(F,Q){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,Q,"setState")},T.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function I(){}I.prototype=T.prototype;function D(F,Q,Y){this.props=F,this.context=Q,this.refs=E,this.updater=Y||_}var O=D.prototype=new I;O.constructor=D,w(O,T.prototype),O.isPureReactComponent=!0;var z=Array.isArray;function P(){}var A={H:null,A:null,T:null,S:null},C=Object.prototype.hasOwnProperty;function k(F,Q,Y){var ne=Y.ref;return{$$typeof:t,type:F,key:Q,ref:ne!==void 0?ne:null,props:Y}}function V(F,Q){return k(F.type,Q,F.props)}function B(F){return typeof F=="object"&&F!==null&&F.$$typeof===t}function j(F){var Q={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(Y){return Q[Y]})}var N=/\/+/g;function K(F,Q){return typeof F=="object"&&F!==null&&F.key!=null?j(""+F.key):Q.toString(36)}function W(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(P,P):(F.status="pending",F.then(function(Q){F.status==="pending"&&(F.status="fulfilled",F.value=Q)},function(Q){F.status==="pending"&&(F.status="rejected",F.reason=Q)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function $(F,Q,Y,ne,pe){var de=typeof F;(de==="undefined"||de==="boolean")&&(F=null);var ge=!1;if(F===null)ge=!0;else switch(de){case"bigint":case"string":case"number":ge=!0;break;case"object":switch(F.$$typeof){case t:case e:ge=!0;break;case h:return ge=F._init,$(ge(F._payload),Q,Y,ne,pe)}}if(ge)return pe=pe(F),ge=ne===""?"."+K(F,0):ne,z(pe)?(Y="",ge!=null&&(Y=ge.replace(N,"$&/")+"/"),$(pe,Q,Y,"",function(Xe){return Xe})):pe!=null&&(B(pe)&&(pe=V(pe,Y+(pe.key==null||F&&F.key===pe.key?"":(""+pe.key).replace(N,"$&/")+"/")+ge)),Q.push(pe)),1;ge=0;var we=ne===""?".":ne+":";if(z(F))for(var Te=0;Te<F.length;Te++)ne=F[Te],de=we+K(ne,Te),ge+=$(ne,Q,Y,de,pe);else if(Te=y(F),typeof Te=="function")for(F=Te.call(F),Te=0;!(ne=F.next()).done;)ne=ne.value,de=we+K(ne,Te++),ge+=$(ne,Q,Y,de,pe);else if(de==="object"){if(typeof F.then=="function")return $(W(F),Q,Y,ne,pe);throw Q=String(F),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.")}return ge}function H(F,Q,Y){if(F==null)return F;var ne=[],pe=0;return $(F,ne,"","",function(de){return Q.call(Y,de,pe++)}),ne}function te(F){if(F._status===-1){var Q=F._result;Q=Q(),Q.then(function(Y){(F._status===0||F._status===-1)&&(F._status=1,F._result=Y)},function(Y){(F._status===0||F._status===-1)&&(F._status=2,F._result=Y)}),F._status===-1&&(F._status=0,F._result=Q)}if(F._status===1)return F._result.default;throw F._result}var re=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent(Q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)},ue={map:H,forEach:function(F,Q,Y){H(F,function(){Q.apply(this,arguments)},Y)},count:function(F){var Q=0;return H(F,function(){Q++}),Q},toArray:function(F){return H(F,function(Q){return Q})||[]},only:function(F){if(!B(F))throw Error("React.Children.only expected to receive a single React element child.");return F}};return at.Activity=p,at.Children=ue,at.Component=T,at.Fragment=n,at.Profiler=i,at.PureComponent=D,at.StrictMode=r,at.Suspense=u,at.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,at.__COMPILER_RUNTIME={__proto__:null,c:function(F){return A.H.useMemoCache(F)}},at.cache=function(F){return function(){return F.apply(null,arguments)}},at.cacheSignal=function(){return null},at.cloneElement=function(F,Q,Y){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var ne=w({},F.props),pe=F.key;if(Q!=null)for(de in Q.key!==void 0&&(pe=""+Q.key),Q)!C.call(Q,de)||de==="key"||de==="__self"||de==="__source"||de==="ref"&&Q.ref===void 0||(ne[de]=Q[de]);var de=arguments.length-2;if(de===1)ne.children=Y;else if(1<de){for(var ge=Array(de),we=0;we<de;we++)ge[we]=arguments[we+2];ne.children=ge}return k(F.type,pe,ne)},at.createContext=function(F){return F={$$typeof:o,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:a,_context:F},F},at.createElement=function(F,Q,Y){var ne,pe={},de=null;if(Q!=null)for(ne in Q.key!==void 0&&(de=""+Q.key),Q)C.call(Q,ne)&&ne!=="key"&&ne!=="__self"&&ne!=="__source"&&(pe[ne]=Q[ne]);var ge=arguments.length-2;if(ge===1)pe.children=Y;else if(1<ge){for(var we=Array(ge),Te=0;Te<ge;Te++)we[Te]=arguments[Te+2];pe.children=we}if(F&&F.defaultProps)for(ne in ge=F.defaultProps,ge)pe[ne]===void 0&&(pe[ne]=ge[ne]);return k(F,de,pe)},at.createRef=function(){return{current:null}},at.forwardRef=function(F){return{$$typeof:c,render:F}},at.isValidElement=B,at.lazy=function(F){return{$$typeof:h,_payload:{_status:-1,_result:F},_init:te}},at.memo=function(F,Q){return{$$typeof:d,type:F,compare:Q===void 0?null:Q}},at.startTransition=function(F){var Q=A.T,Y={};A.T=Y;try{var ne=F(),pe=A.S;pe!==null&&pe(Y,ne),typeof ne=="object"&&ne!==null&&typeof ne.then=="function"&&ne.then(P,re)}catch(de){re(de)}finally{Q!==null&&Y.types!==null&&(Q.types=Y.types),A.T=Q}},at.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},at.use=function(F){return A.H.use(F)},at.useActionState=function(F,Q,Y){return A.H.useActionState(F,Q,Y)},at.useCallback=function(F,Q){return A.H.useCallback(F,Q)},at.useContext=function(F){return A.H.useContext(F)},at.useDebugValue=function(){},at.useDeferredValue=function(F,Q){return A.H.useDeferredValue(F,Q)},at.useEffect=function(F,Q){return A.H.useEffect(F,Q)},at.useEffectEvent=function(F){return A.H.useEffectEvent(F)},at.useId=function(){return A.H.useId()},at.useImperativeHandle=function(F,Q,Y){return A.H.useImperativeHandle(F,Q,Y)},at.useInsertionEffect=function(F,Q){return A.H.useInsertionEffect(F,Q)},at.useLayoutEffect=function(F,Q){return A.H.useLayoutEffect(F,Q)},at.useMemo=function(F,Q){return A.H.useMemo(F,Q)},at.useOptimistic=function(F,Q){return A.H.useOptimistic(F,Q)},at.useReducer=function(F,Q,Y){return A.H.useReducer(F,Q,Y)},at.useRef=function(F){return A.H.useRef(F)},at.useState=function(F){return A.H.useState(F)},at.useSyncExternalStore=function(F,Q,Y){return A.H.useSyncExternalStore(F,Q,Y)},at.useTransition=function(){return A.H.useTransition()},at.version="19.2.0",at}var rI;function Z_(){return rI||(rI=1,f1.exports=Z5()),f1.exports}var G=Z_();const vm=X5(G);var h1={exports:{}},Yf={},p1={exports:{}},g1={};var iI;function J5(){return iI||(iI=1,(function(t){function e($,H){var te=$.length;$.push(H);e:for(;0<te;){var re=te-1>>>1,ue=$[re];if(0<i(ue,H))$[re]=H,$[te]=ue,te=re;else break e}}function n($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var H=$[0],te=$.pop();if(te!==H){$[0]=te;e:for(var re=0,ue=$.length,F=ue>>>1;re<F;){var Q=2*(re+1)-1,Y=$[Q],ne=Q+1,pe=$[ne];if(0>i(Y,te))ne<ue&&0>i(pe,Y)?($[re]=pe,$[ne]=te,re=ne):($[re]=Y,$[Q]=te,re=Q);else if(ne<ue&&0>i(pe,te))$[re]=pe,$[ne]=te,re=ne;else break e}}return H}function i($,H){var te=$.sortIndex-H.sortIndex;return te!==0?te:$.id-H.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],d=[],h=1,p=null,m=3,y=!1,_=!1,w=!1,E=!1,T=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function O($){for(var H=n(d);H!==null;){if(H.callback===null)r(d);else if(H.startTime<=$)r(d),H.sortIndex=H.expirationTime,e(u,H);else break;H=n(d)}}function z($){if(w=!1,O($),!_)if(n(u)!==null)_=!0,P||(P=!0,j());else{var H=n(d);H!==null&&W(z,H.startTime-$)}}var P=!1,A=-1,C=5,k=-1;function V(){return E?!0:!(t.unstable_now()-k<C)}function B(){if(E=!1,P){var $=t.unstable_now();k=$;var H=!0;try{e:{_=!1,w&&(w=!1,I(A),A=-1),y=!0;var te=m;try{t:{for(O($),p=n(u);p!==null&&!(p.expirationTime>$&&V());){var re=p.callback;if(typeof re=="function"){p.callback=null,m=p.priorityLevel;var ue=re(p.expirationTime<=$);if($=t.unstable_now(),typeof ue=="function"){p.callback=ue,O($),H=!0;break t}p===n(u)&&r(u),O($)}else r(u);p=n(u)}if(p!==null)H=!0;else{var F=n(d);F!==null&&W(z,F.startTime-$),H=!1}}break e}finally{p=null,m=te,y=!1}H=void 0}}finally{H?j():P=!1}}}var j;if(typeof D=="function")j=function(){D(B)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,K=N.port2;N.port1.onmessage=B,j=function(){K.postMessage(null)}}else j=function(){T(B,0)};function W($,H){A=T(function(){$(t.unstable_now())},H)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_next=function($){switch(m){case 1:case 2:case 3:var H=3;break;default:H=m}var te=m;m=H;try{return $()}finally{m=te}},t.unstable_requestPaint=function(){E=!0},t.unstable_runWithPriority=function($,H){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var te=m;m=$;try{return H()}finally{m=te}},t.unstable_scheduleCallback=function($,H,te){var re=t.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?re+te:re):te=re,$){case 1:var ue=-1;break;case 2:ue=250;break;case 5:ue=1073741823;break;case 4:ue=1e4;break;default:ue=5e3}return ue=te+ue,$={id:h++,callback:H,priorityLevel:$,startTime:te,expirationTime:ue,sortIndex:-1},te>re?($.sortIndex=te,e(d,$),n(u)===null&&$===n(d)&&(w?(I(A),A=-1):w=!0,W(z,te-re))):($.sortIndex=ue,e(u,$),_||y||(_=!0,P||(P=!0,j()))),$},t.unstable_shouldYield=V,t.unstable_wrapCallback=function($){var H=m;return function(){var te=m;m=H;try{return $.apply(this,arguments)}finally{m=te}}}})(g1)),g1}var aI;function e6(){return aI||(aI=1,p1.exports=J5()),p1.exports}var m1={exports:{}},Sr={};var sI;function t6(){if(sI)return Sr;sI=1;var t=Z_();function e(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)d+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(u,d,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:p==null?null:""+p,children:u,containerInfo:d,implementation:h}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Sr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Sr.createPortal=function(u,d){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return a(u,d,null,h)},Sr.flushSync=function(u){var d=o.T,h=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=d,r.p=h,r.d.f()}},Sr.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(u,d))},Sr.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},Sr.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin),m=typeof d.integrity=="string"?d.integrity:void 0,y=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;h==="style"?r.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:y}):h==="script"&&r.d.X(u,{crossOrigin:p,integrity:m,fetchPriority:y,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Sr.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var h=c(d.as,d.crossOrigin);r.d.M(u,{crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(u)},Sr.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin);r.d.L(u,h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Sr.preloadModule=function(u,d){if(typeof u=="string")if(d){var h=c(d.as,d.crossOrigin);r.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(u)},Sr.requestFormReset=function(u){r.d.r(u)},Sr.unstable_batchedUpdates=function(u,d){return u(d)},Sr.useFormState=function(u,d,h){return o.H.useFormState(u,d,h)},Sr.useFormStatus=function(){return o.H.useHostTransitionStatus()},Sr.version="19.2.0",Sr}var oI;function n6(){if(oI)return m1.exports;oI=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),m1.exports=t6(),m1.exports}var lI;function r6(){if(lI)return Yf;lI=1;var t=e6(),e=Z_(),n=n6();function r(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var l=s,f=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(f=l.return),s=l.return;while(s)}return l.tag===3?f:null}function o(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function c(s){if(s.tag===31){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function u(s){if(a(s)!==s)throw Error(r(188))}function d(s){var l=s.alternate;if(!l){if(l=a(s),l===null)throw Error(r(188));return l!==s?null:s}for(var f=s,g=l;;){var x=f.return;if(x===null)break;var S=x.alternate;if(S===null){if(g=x.return,g!==null){f=g;continue}break}if(x.child===S.child){for(S=x.child;S;){if(S===f)return u(x),s;if(S===g)return u(x),l;S=S.sibling}throw Error(r(188))}if(f.return!==g.return)f=x,g=S;else{for(var M=!1,U=x.child;U;){if(U===f){M=!0,f=x,g=S;break}if(U===g){M=!0,g=x,f=S;break}U=U.sibling}if(!M){for(U=S.child;U;){if(U===f){M=!0,f=S,g=x;break}if(U===g){M=!0,g=S,f=x;break}U=U.sibling}if(!M)throw Error(r(189))}}if(f.alternate!==g)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?s:l}function h(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=h(s),l!==null)return l;s=s.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),I=Symbol.for("react.consumer"),D=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),B=Symbol.iterator;function j(s){return s===null||typeof s!="object"?null:(s=B&&s[B]||s["@@iterator"],typeof s=="function"?s:null)}var N=Symbol.for("react.client.reference");function K(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===N?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case w:return"Fragment";case T:return"Profiler";case E:return"StrictMode";case z:return"Suspense";case P:return"SuspenseList";case k:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case _:return"Portal";case D:return s.displayName||"Context";case I:return(s._context.displayName||"Context")+".Consumer";case O:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case A:return l=s.displayName||null,l!==null?l:K(s.type)||"Memo";case C:l=s._payload,s=s._init;try{return K(s(l))}catch{}}return null}var W=Array.isArray,$=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,te={pending:!1,data:null,method:null,action:null},re=[],ue=-1;function F(s){return{current:s}}function Q(s){0>ue||(s.current=re[ue],re[ue]=null,ue--)}function Y(s,l){ue++,re[ue]=s.current,s.current=l}var ne=F(null),pe=F(null),de=F(null),ge=F(null);function we(s,l){switch(Y(de,l),Y(pe,s),Y(ne,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?SC(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=SC(l),s=EC(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}Q(ne),Y(ne,s)}function Te(){Q(ne),Q(pe),Q(de)}function Xe(s){s.memoizedState!==null&&Y(ge,s);var l=ne.current,f=EC(l,s.type);l!==f&&(Y(pe,s),Y(ne,f))}function Se(s){pe.current===s&&(Q(ne),Q(pe)),ge.current===s&&(Q(ge),Uf._currentValue=te)}var Ie,Je;function Me(s){if(Ie===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);Ie=l&&l[1]||"",Je=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ie+s+Je}var $e=!1;function We(s,l){if(!s||$e)return"";$e=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(l){var be=function(){throw Error()};if(Object.defineProperty(be.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(be,[])}catch(he){var ce=he}Reflect.construct(s,[],be)}else{try{be.call()}catch(he){ce=he}s.call(be.prototype)}}else{try{throw Error()}catch(he){ce=he}(be=s())&&typeof be.catch=="function"&&be.catch(function(){})}}catch(he){if(he&&ce&&typeof he.stack=="string")return[he.stack,ce.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=g.DetermineComponentFrameRoot(),M=S[0],U=S[1];if(M&&U){var X=M.split(`
`),le=U.split(`
`);for(x=g=0;g<X.length&&!X[g].includes("DetermineComponentFrameRoot");)g++;for(;x<le.length&&!le[x].includes("DetermineComponentFrameRoot");)x++;if(g===X.length||x===le.length)for(g=X.length-1,x=le.length-1;1<=g&&0<=x&&X[g]!==le[x];)x--;for(;1<=g&&0<=x;g--,x--)if(X[g]!==le[x]){if(g!==1||x!==1)do if(g--,x--,0>x||X[g]!==le[x]){var ve=`
`+X[g].replace(" at new "," at ");return s.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",s.displayName)),ve}while(1<=g&&0<=x);break}}}finally{$e=!1,Error.prepareStackTrace=f}return(f=s?s.displayName||s.name:"")?Me(f):""}function pt(s,l){switch(s.tag){case 26:case 27:case 5:return Me(s.type);case 16:return Me("Lazy");case 13:return s.child!==l&&l!==null?Me("Suspense Fallback"):Me("Suspense");case 19:return Me("SuspenseList");case 0:case 15:return We(s.type,!1);case 11:return We(s.type.render,!1);case 1:return We(s.type,!0);case 31:return Me("Activity");default:return""}}function _t(s){try{var l="",f=null;do l+=pt(s,f),f=s,s=s.return;while(s);return l}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var Pe=Object.prototype.hasOwnProperty,Ue=t.unstable_scheduleCallback,Pt=t.unstable_cancelCallback,yn=t.unstable_shouldYield,Wt=t.unstable_requestPaint,ht=t.unstable_now,At=t.unstable_getCurrentPriorityLevel,Ft=t.unstable_ImmediatePriority,lr=t.unstable_UserBlockingPriority,Gr=t.unstable_NormalPriority,ls=t.unstable_LowPriority,Zs=t.unstable_IdlePriority,Si=t.log,_r=t.unstable_setDisableYieldValue,Nr=null,bn=null;function tr(s){if(typeof Si=="function"&&_r(s),bn&&typeof bn.setStrictMode=="function")try{bn.setStrictMode(Nr,s)}catch{}}var Qt=Math.clz32?Math.clz32:_a,Js=Math.log,xa=Math.LN2;function _a(s){return s>>>=0,s===0?32:31-(Js(s)/xa|0)|0}var ut=256,Zt=262144,Jt=4194304;function Ae(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function je(s,l,f){var g=s.pendingLanes;if(g===0)return 0;var x=0,S=s.suspendedLanes,M=s.pingedLanes;s=s.warmLanes;var U=g&134217727;return U!==0?(g=U&~S,g!==0?x=Ae(g):(M&=U,M!==0?x=Ae(M):f||(f=U&~s,f!==0&&(x=Ae(f))))):(U=g&~S,U!==0?x=Ae(U):M!==0?x=Ae(M):f||(f=g&~s,f!==0&&(x=Ae(f)))),x===0?0:l!==0&&l!==x&&(l&S)===0&&(S=x&-x,f=l&-l,S>=f||S===32&&(f&4194048)!==0)?l:x}function wt(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function rn(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qr(){var s=Jt;return Jt<<=1,(Jt&62914560)===0&&(Jt=4194304),s}function cr(s){for(var l=[],f=0;31>f;f++)l.push(s);return l}function wr(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Nt(s,l,f,g,x,S){var M=s.pendingLanes;s.pendingLanes=f,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=f,s.entangledLanes&=f,s.errorRecoveryDisabledLanes&=f,s.shellSuspendCounter=0;var U=s.entanglements,X=s.expirationTimes,le=s.hiddenUpdates;for(f=M&~f;0<f;){var ve=31-Qt(f),be=1<<ve;U[ve]=0,X[ve]=-1;var ce=le[ve];if(ce!==null)for(le[ve]=null,ve=0;ve<ce.length;ve++){var he=ce[ve];he!==null&&(he.lane&=-536870913)}f&=~be}g!==0&&Ot(s,g,0),S!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=S&~(M&~l))}function Ot(s,l,f){s.pendingLanes|=l,s.suspendedLanes&=~l;var g=31-Qt(l);s.entangledLanes|=l,s.entanglements[g]=s.entanglements[g]|1073741824|f&261930}function an(s,l){var f=s.entangledLanes|=l;for(s=s.entanglements;f;){var g=31-Qt(f),x=1<<g;x&l|s[g]&l&&(s[g]|=l),f&=~x}}function nr(s,l){var f=l&-l;return f=(f&42)!==0?1:Hr(f),(f&(s.suspendedLanes|l))!==0?0:f}function Hr(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function $n(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Nn(){var s=H.p;return s!==0?s:(s=window.event,s===void 0?32:YC(s.type))}function Yn(s,l){var f=H.p;try{return H.p=s,l()}finally{H.p=f}}var rr=Math.random().toString(36).slice(2),dn="__reactFiber$"+rr,fn="__reactProps$"+rr,$r="__reactContainer$"+rr,Zi="__reactEvents$"+rr,vy="__reactListeners$"+rr,Wp="__reactHandles$"+rr,Qp="__reactResources$"+rr,wa="__reactMarker$"+rr;function Bc(s){delete s[dn],delete s[fn],delete s[Zi],delete s[vy],delete s[Wp]}function Sa(s){var l=s[dn];if(l)return l;for(var f=s.parentNode;f;){if(l=f[$r]||f[dn]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(s=kC(s);s!==null;){if(f=s[dn])return f;s=kC(s)}return l}s=f,f=s.parentNode}return null}function Ei(s){if(s=s[dn]||s[$r]){var l=s.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return s}return null}function li(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(r(33))}function Ea(s){var l=s[Qp];return l||(l=s[Qp]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Mn(s){s[wa]=!0}var Kd=new Set,Xd={};function Ta(s,l){Aa(s,l),Aa(s+"Capture",l)}function Aa(s,l){for(Xd[s]=l,s=0;s<l.length;s++)Kd.add(l[s])}var Wd=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Qd={},Zd={};function Zp(s){return Pe.call(Zd,s)?!0:Pe.call(Qd,s)?!1:Wd.test(s)?Zd[s]=!0:(Qd[s]=!0,!1)}function Fc(s,l,f){if(Zp(l))if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var g=l.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+f)}}function ci(s,l,f){if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+f)}}function Pn(s,l,f,g){if(g===null)s.removeAttribute(f);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(f);return}s.setAttributeNS(l,f,""+g)}}function ir(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function eo(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Jd(s,l,f){var g=Object.getOwnPropertyDescriptor(s.constructor.prototype,l);if(!s.hasOwnProperty(l)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var x=g.get,S=g.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return x.call(this)},set:function(M){f=""+M,S.call(this,M)}}),Object.defineProperty(s,l,{enumerable:g.enumerable}),{getValue:function(){return f},setValue:function(M){f=""+M},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function Vt(s){if(!s._valueTracker){var l=eo(s)?"checked":"value";s._valueTracker=Jd(s,l,""+s[l])}}function xl(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var f=l.getValue(),g="";return s&&(g=eo(s)?s.checked?"true":"false":s.value),s=g,s!==f?(l.setValue(s),!0):!1}function Ca(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var _l=/[\n"\\]/g;function Yr(s){return s.replace(_l,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Uc(s,l,f,g,x,S,M,U){s.name="",M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?s.type=M:s.removeAttribute("type"),l!=null?M==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+ir(l)):s.value!==""+ir(l)&&(s.value=""+ir(l)):M!=="submit"&&M!=="reset"||s.removeAttribute("value"),l!=null?ef(s,M,ir(l)):f!=null?ef(s,M,ir(f)):g!=null&&s.removeAttribute("value"),x==null&&S!=null&&(s.defaultChecked=!!S),x!=null&&(s.checked=x&&typeof x!="function"&&typeof x!="symbol"),U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?s.name=""+ir(U):s.removeAttribute("name")}function Jp(s,l,f,g,x,S,M,U){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(s.type=S),l!=null||f!=null){if(!(S!=="submit"&&S!=="reset"||l!=null)){Vt(s);return}f=f!=null?""+ir(f):"",l=l!=null?""+ir(l):f,U||l===s.value||(s.value=l),s.defaultValue=l}g=g??x,g=typeof g!="function"&&typeof g!="symbol"&&!!g,s.checked=U?s.checked:!!g,s.defaultChecked=!!g,M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"&&(s.name=M),Vt(s)}function ef(s,l,f){l==="number"&&Ca(s.ownerDocument)===s||s.defaultValue===""+f||(s.defaultValue=""+f)}function to(s,l,f,g){if(s=s.options,l){l={};for(var x=0;x<f.length;x++)l["$"+f[x]]=!0;for(f=0;f<s.length;f++)x=l.hasOwnProperty("$"+s[f].value),s[f].selected!==x&&(s[f].selected=x),x&&g&&(s[f].defaultSelected=!0)}else{for(f=""+ir(f),l=null,x=0;x<s.length;x++){if(s[x].value===f){s[x].selected=!0,g&&(s[x].defaultSelected=!0);return}l!==null||s[x].disabled||(l=s[x])}l!==null&&(l.selected=!0)}}function eg(s,l,f){if(l!=null&&(l=""+ir(l),l!==s.value&&(s.value=l),f==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=f!=null?""+ir(f):""}function no(s,l,f,g){if(l==null){if(g!=null){if(f!=null)throw Error(r(92));if(W(g)){if(1<g.length)throw Error(r(93));g=g[0]}f=g}f==null&&(f=""),l=f}f=ir(l),s.defaultValue=f,g=s.textContent,g===f&&g!==""&&g!==null&&(s.value=g),Vt(s)}function Kr(s,l){if(l){var f=s.firstChild;if(f&&f===s.lastChild&&f.nodeType===3){f.nodeValue=l;return}}s.textContent=l}var tg=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function tf(s,l,f){var g=l.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?g?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":g?s.setProperty(l,f):typeof f!="number"||f===0||tg.has(l)?l==="float"?s.cssFloat=f:s[l]=(""+f).trim():s[l]=f+"px"}function nf(s,l,f){if(l!=null&&typeof l!="object")throw Error(r(62));if(s=s.style,f!=null){for(var g in f)!f.hasOwnProperty(g)||l!=null&&l.hasOwnProperty(g)||(g.indexOf("--")===0?s.setProperty(g,""):g==="float"?s.cssFloat="":s[g]="");for(var x in l)g=l[x],l.hasOwnProperty(x)&&f[x]!==g&&tf(s,x,g)}else for(var S in l)l.hasOwnProperty(S)&&tf(s,S,l[S])}function Gc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ng=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ro=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function qc(s){return ro.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Ji(){}var rf=null;function Ti(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var io=null,Ia=null;function wl(s){var l=Ei(s);if(l&&(s=l.stateNode)){var f=s[fn]||null;e:switch(s=l.stateNode,l.type){case"input":if(Uc(s,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),l=f.name,f.type==="radio"&&l!=null){for(f=s;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Yr(""+l)+'"][type="radio"]'),l=0;l<f.length;l++){var g=f[l];if(g!==s&&g.form===s.form){var x=g[fn]||null;if(!x)throw Error(r(90));Uc(g,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(l=0;l<f.length;l++)g=f[l],g.form===s.form&&xl(g)}break e;case"textarea":eg(s,f.value,f.defaultValue);break e;case"select":l=f.value,l!=null&&to(s,!!f.multiple,l,!1)}}}var Hc=!1;function ao(s,l,f){if(Hc)return s(l,f);Hc=!0;try{var g=s(l);return g}finally{if(Hc=!1,(io!==null||Ia!==null)&&(Xg(),io&&(l=io,s=Ia,Ia=io=null,wl(l),s)))for(l=0;l<s.length;l++)wl(s[l])}}function ea(s,l){var f=s.stateNode;if(f===null)return null;var g=f[fn]||null;if(g===null)return null;f=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(s=s.type,g=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!g;break e;default:s=!1}if(s)return null;if(f&&typeof f!="function")throw Error(r(231,l,typeof f));return f}var Ai=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Sl=!1;if(Ai)try{var Ut={};Object.defineProperty(Ut,"passive",{get:function(){Sl=!0}}),window.addEventListener("test",Ut,Ut),window.removeEventListener("test",Ut,Ut)}catch{Sl=!1}var Da=null,af=null,El=null;function sf(){if(El)return El;var s,l=af,f=l.length,g,x="value"in Da?Da.value:Da.textContent,S=x.length;for(s=0;s<f&&l[s]===x[s];s++);var M=f-s;for(g=1;g<=M&&l[f-g]===x[S-g];g++);return El=x.slice(s,1<g?1-g:void 0)}function Tl(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function cs(){return!0}function ta(){return!1}function ur(s){function l(f,g,x,S,M){this._reactName=f,this._targetInst=x,this.type=g,this.nativeEvent=S,this.target=M,this.currentTarget=null;for(var U in s)s.hasOwnProperty(U)&&(f=s[U],this[U]=f?f(S):S[U]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?cs:ta,this.isPropagationStopped=ta,this}return p(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=cs)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=cs)},persist:function(){},isPersistent:cs}),l}var us={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ra=ur(us),so=p({},us,{view:0,detail:0}),of=ur(so),oo,$c,ka,Yc=p({},so,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lo,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ka&&(ka&&s.type==="mousemove"?(oo=s.screenX-ka.screenX,$c=s.screenY-ka.screenY):$c=oo=0,ka=s),oo)},movementY:function(s){return"movementY"in s?s.movementY:$c}}),lf=ur(Yc),Al=p({},Yc,{dataTransfer:0}),rg=ur(Al),ig=p({},so,{relatedTarget:0}),Cl=ur(ig),cf=p({},us,{animationName:0,elapsedTime:0,pseudoElement:0}),ag=ur(cf),Kc=p({},us,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),sg=ur(Kc),og=p({},us,{data:0}),Na=ur(og),lg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ug={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dg(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=ug[s])?!!l[s]:!1}function lo(){return dg}var Mr=p({},so,{key:function(s){if(s.key){var l=lg[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=Tl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?cg[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lo,charCode:function(s){return s.type==="keypress"?Tl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Tl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),fg=ur(Mr),hg=p({},Yc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ds=ur(hg),v=p({},so,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lo}),R=ur(v),L=p({},us,{propertyName:0,elapsedTime:0,pseudoElement:0}),q=ur(L),se=p({},Yc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),fe=ur(se),Re=p({},us,{newState:0,oldState:0}),st=ur(Re),Cn=[9,13,27,32],Dt=Ai&&"CompositionEvent"in window,sn=null;Ai&&"documentMode"in document&&(sn=document.documentMode);var Ci=Ai&&"TextEvent"in window&&!sn,Ma=Ai&&(!Dt||sn&&8<sn&&11>=sn),na=" ",ra=!1;function Il(s,l){switch(s){case"keyup":return Cn.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xc(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Wc=!1;function bj(s,l){switch(s){case"compositionend":return Xc(l);case"keypress":return l.which!==32?null:(ra=!0,na);case"textInput":return s=l.data,s===na&&ra?null:s;default:return null}}function xj(s,l){if(Wc)return s==="compositionend"||!Dt&&Il(s,l)?(s=sf(),El=af=Da=null,Wc=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Ma&&l.locale!=="ko"?null:l.data;default:return null}}var _j={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function PE(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!_j[s.type]:l==="textarea"}function OE(s,l,f,g){io?Ia?Ia.push(g):Ia=[g]:io=g,l=nm(l,"onChange"),0<l.length&&(f=new Ra("onChange","change",null,f,g),s.push({event:f,listeners:l}))}var uf=null,df=null;function wj(s){vC(s,0)}function pg(s){var l=li(s);if(xl(l))return s}function VE(s,l){if(s==="change")return l}var jE=!1;if(Ai){var yy;if(Ai){var by="oninput"in document;if(!by){var zE=document.createElement("div");zE.setAttribute("oninput","return;"),by=typeof zE.oninput=="function"}yy=by}else yy=!1;jE=yy&&(!document.documentMode||9<document.documentMode)}function LE(){uf&&(uf.detachEvent("onpropertychange",BE),df=uf=null)}function BE(s){if(s.propertyName==="value"&&pg(df)){var l=[];OE(l,df,s,Ti(s)),ao(wj,l)}}function Sj(s,l,f){s==="focusin"?(LE(),uf=l,df=f,uf.attachEvent("onpropertychange",BE)):s==="focusout"&&LE()}function Ej(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return pg(df)}function Tj(s,l){if(s==="click")return pg(l)}function Aj(s,l){if(s==="input"||s==="change")return pg(l)}function Cj(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var ui=typeof Object.is=="function"?Object.is:Cj;function ff(s,l){if(ui(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var f=Object.keys(s),g=Object.keys(l);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var x=f[g];if(!Pe.call(l,x)||!ui(s[x],l[x]))return!1}return!0}function FE(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function UE(s,l){var f=FE(s);s=0;for(var g;f;){if(f.nodeType===3){if(g=s+f.textContent.length,s<=l&&g>=l)return{node:f,offset:l-s};s=g}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=FE(f)}}function GE(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?GE(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function qE(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=Ca(s.document);l instanceof s.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)s=l.contentWindow;else break;l=Ca(s.document)}return l}function xy(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var Ij=Ai&&"documentMode"in document&&11>=document.documentMode,Qc=null,_y=null,hf=null,wy=!1;function HE(s,l,f){var g=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;wy||Qc==null||Qc!==Ca(g)||(g=Qc,"selectionStart"in g&&xy(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),hf&&ff(hf,g)||(hf=g,g=nm(_y,"onSelect"),0<g.length&&(l=new Ra("onSelect","select",null,l,f),s.push({event:l,listeners:g}),l.target=Qc)))}function Dl(s,l){var f={};return f[s.toLowerCase()]=l.toLowerCase(),f["Webkit"+s]="webkit"+l,f["Moz"+s]="moz"+l,f}var Zc={animationend:Dl("Animation","AnimationEnd"),animationiteration:Dl("Animation","AnimationIteration"),animationstart:Dl("Animation","AnimationStart"),transitionrun:Dl("Transition","TransitionRun"),transitionstart:Dl("Transition","TransitionStart"),transitioncancel:Dl("Transition","TransitionCancel"),transitionend:Dl("Transition","TransitionEnd")},Sy={},$E={};Ai&&($E=document.createElement("div").style,"AnimationEvent"in window||(delete Zc.animationend.animation,delete Zc.animationiteration.animation,delete Zc.animationstart.animation),"TransitionEvent"in window||delete Zc.transitionend.transition);function Rl(s){if(Sy[s])return Sy[s];if(!Zc[s])return s;var l=Zc[s],f;for(f in l)if(l.hasOwnProperty(f)&&f in $E)return Sy[s]=l[f];return s}var YE=Rl("animationend"),KE=Rl("animationiteration"),XE=Rl("animationstart"),Dj=Rl("transitionrun"),Rj=Rl("transitionstart"),kj=Rl("transitioncancel"),WE=Rl("transitionend"),QE=new Map,Ey="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ey.push("scrollEnd");function ia(s,l){QE.set(s,l),Ta(l,[s])}var gg=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Ii=[],Jc=0,Ty=0;function mg(){for(var s=Jc,l=Ty=Jc=0;l<s;){var f=Ii[l];Ii[l++]=null;var g=Ii[l];Ii[l++]=null;var x=Ii[l];Ii[l++]=null;var S=Ii[l];if(Ii[l++]=null,g!==null&&x!==null){var M=g.pending;M===null?x.next=x:(x.next=M.next,M.next=x),g.pending=x}S!==0&&ZE(f,x,S)}}function vg(s,l,f,g){Ii[Jc++]=s,Ii[Jc++]=l,Ii[Jc++]=f,Ii[Jc++]=g,Ty|=g,s.lanes|=g,s=s.alternate,s!==null&&(s.lanes|=g)}function Ay(s,l,f,g){return vg(s,l,f,g),yg(s)}function kl(s,l){return vg(s,null,null,l),yg(s)}function ZE(s,l,f){s.lanes|=f;var g=s.alternate;g!==null&&(g.lanes|=f);for(var x=!1,S=s.return;S!==null;)S.childLanes|=f,g=S.alternate,g!==null&&(g.childLanes|=f),S.tag===22&&(s=S.stateNode,s===null||s._visibility&1||(x=!0)),s=S,S=S.return;return s.tag===3?(S=s.stateNode,x&&l!==null&&(x=31-Qt(f),s=S.hiddenUpdates,g=s[x],g===null?s[x]=[l]:g.push(l),l.lane=f|536870912),S):null}function yg(s){if(50<Of)throw Of=0,Ob=null,Error(r(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var eu={};function Nj(s,l,f,g){this.tag=s,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function di(s,l,f,g){return new Nj(s,l,f,g)}function Cy(s){return s=s.prototype,!(!s||!s.isReactComponent)}function fs(s,l){var f=s.alternate;return f===null?(f=di(s.tag,l,s.key,s.mode),f.elementType=s.elementType,f.type=s.type,f.stateNode=s.stateNode,f.alternate=s,s.alternate=f):(f.pendingProps=l,f.type=s.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=s.flags&65011712,f.childLanes=s.childLanes,f.lanes=s.lanes,f.child=s.child,f.memoizedProps=s.memoizedProps,f.memoizedState=s.memoizedState,f.updateQueue=s.updateQueue,l=s.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=s.sibling,f.index=s.index,f.ref=s.ref,f.refCleanup=s.refCleanup,f}function JE(s,l){s.flags&=65011714;var f=s.alternate;return f===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=f.childLanes,s.lanes=f.lanes,s.child=f.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=f.memoizedProps,s.memoizedState=f.memoizedState,s.updateQueue=f.updateQueue,s.type=f.type,l=f.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function bg(s,l,f,g,x,S){var M=0;if(g=s,typeof s=="function")Cy(s)&&(M=1);else if(typeof s=="string")M=j5(s,f,ne.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case k:return s=di(31,f,l,x),s.elementType=k,s.lanes=S,s;case w:return Nl(f.children,x,S,l);case E:M=8,x|=24;break;case T:return s=di(12,f,l,x|2),s.elementType=T,s.lanes=S,s;case z:return s=di(13,f,l,x),s.elementType=z,s.lanes=S,s;case P:return s=di(19,f,l,x),s.elementType=P,s.lanes=S,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case D:M=10;break e;case I:M=9;break e;case O:M=11;break e;case A:M=14;break e;case C:M=16,g=null;break e}M=29,f=Error(r(130,s===null?"null":typeof s,"")),g=null}return l=di(M,f,l,x),l.elementType=s,l.type=g,l.lanes=S,l}function Nl(s,l,f,g){return s=di(7,s,g,l),s.lanes=f,s}function Iy(s,l,f){return s=di(6,s,null,l),s.lanes=f,s}function eT(s){var l=di(18,null,null,0);return l.stateNode=s,l}function Dy(s,l,f){return l=di(4,s.children!==null?s.children:[],s.key,l),l.lanes=f,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var tT=new WeakMap;function Di(s,l){if(typeof s=="object"&&s!==null){var f=tT.get(s);return f!==void 0?f:(l={value:s,source:l,stack:_t(l)},tT.set(s,l),l)}return{value:s,source:l,stack:_t(l)}}var tu=[],nu=0,xg=null,pf=0,Ri=[],ki=0,co=null,Pa=1,Oa="";function hs(s,l){tu[nu++]=pf,tu[nu++]=xg,xg=s,pf=l}function nT(s,l,f){Ri[ki++]=Pa,Ri[ki++]=Oa,Ri[ki++]=co,co=s;var g=Pa;s=Oa;var x=32-Qt(g)-1;g&=~(1<<x),f+=1;var S=32-Qt(l)+x;if(30<S){var M=x-x%5;S=(g&(1<<M)-1).toString(32),g>>=M,x-=M,Pa=1<<32-Qt(l)+x|f<<x|g,Oa=S+s}else Pa=1<<S|f<<x|g,Oa=s}function Ry(s){s.return!==null&&(hs(s,1),nT(s,1,0))}function ky(s){for(;s===xg;)xg=tu[--nu],tu[nu]=null,pf=tu[--nu],tu[nu]=null;for(;s===co;)co=Ri[--ki],Ri[ki]=null,Oa=Ri[--ki],Ri[ki]=null,Pa=Ri[--ki],Ri[ki]=null}function rT(s,l){Ri[ki++]=Pa,Ri[ki++]=Oa,Ri[ki++]=co,Pa=l.id,Oa=l.overflow,co=s}var dr=null,en=null,St=!1,uo=null,Ni=!1,Ny=Error(r(519));function fo(s){var l=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw gf(Di(l,s)),Ny}function iT(s){var l=s.stateNode,f=s.type,g=s.memoizedProps;switch(l[dn]=s,l[fn]=g,f){case"dialog":mt("cancel",l),mt("close",l);break;case"iframe":case"object":case"embed":mt("load",l);break;case"video":case"audio":for(f=0;f<jf.length;f++)mt(jf[f],l);break;case"source":mt("error",l);break;case"img":case"image":case"link":mt("error",l),mt("load",l);break;case"details":mt("toggle",l);break;case"input":mt("invalid",l),Jp(l,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":mt("invalid",l);break;case"textarea":mt("invalid",l),no(l,g.value,g.defaultValue,g.children)}f=g.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||l.textContent===""+f||g.suppressHydrationWarning===!0||_C(l.textContent,f)?(g.popover!=null&&(mt("beforetoggle",l),mt("toggle",l)),g.onScroll!=null&&mt("scroll",l),g.onScrollEnd!=null&&mt("scrollend",l),g.onClick!=null&&(l.onclick=Ji),l=!0):l=!1,l||fo(s,!0)}function aT(s){for(dr=s.return;dr;)switch(dr.tag){case 5:case 31:case 13:Ni=!1;return;case 27:case 3:Ni=!0;return;default:dr=dr.return}}function ru(s){if(s!==dr)return!1;if(!St)return aT(s),St=!0,!1;var l=s.tag,f;if((f=l!==3&&l!==27)&&((f=l===5)&&(f=s.type,f=!(f!=="form"&&f!=="button")||Wb(s.type,s.memoizedProps)),f=!f),f&&en&&fo(s),aT(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));en=RC(s)}else if(l===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));en=RC(s)}else l===27?(l=en,Ao(s.type)?(s=t1,t1=null,en=s):en=l):en=dr?Pi(s.stateNode.nextSibling):null;return!0}function Ml(){en=dr=null,St=!1}function My(){var s=uo;return s!==null&&(Zr===null?Zr=s:Zr.push.apply(Zr,s),uo=null),s}function gf(s){uo===null?uo=[s]:uo.push(s)}var Py=F(null),Pl=null,ps=null;function ho(s,l,f){Y(Py,l._currentValue),l._currentValue=f}function gs(s){s._currentValue=Py.current,Q(Py)}function Oy(s,l,f){for(;s!==null;){var g=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),s===f)break;s=s.return}}function Vy(s,l,f,g){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var S=x.dependencies;if(S!==null){var M=x.child;S=S.firstContext;e:for(;S!==null;){var U=S;S=x;for(var X=0;X<l.length;X++)if(U.context===l[X]){S.lanes|=f,U=S.alternate,U!==null&&(U.lanes|=f),Oy(S.return,f,s),g||(M=null);break e}S=U.next}}else if(x.tag===18){if(M=x.return,M===null)throw Error(r(341));M.lanes|=f,S=M.alternate,S!==null&&(S.lanes|=f),Oy(M,f,s),M=null}else M=x.child;if(M!==null)M.return=x;else for(M=x;M!==null;){if(M===s){M=null;break}if(x=M.sibling,x!==null){x.return=M.return,M=x;break}M=M.return}x=M}}function iu(s,l,f,g){s=null;for(var x=l,S=!1;x!==null;){if(!S){if((x.flags&524288)!==0)S=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var M=x.alternate;if(M===null)throw Error(r(387));if(M=M.memoizedProps,M!==null){var U=x.type;ui(x.pendingProps.value,M.value)||(s!==null?s.push(U):s=[U])}}else if(x===ge.current){if(M=x.alternate,M===null)throw Error(r(387));M.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(Uf):s=[Uf])}x=x.return}s!==null&&Vy(l,s,f,g),l.flags|=262144}function _g(s){for(s=s.firstContext;s!==null;){if(!ui(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Ol(s){Pl=s,ps=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function fr(s){return sT(Pl,s)}function wg(s,l){return Pl===null&&Ol(s),sT(s,l)}function sT(s,l){var f=l._currentValue;if(l={context:l,memoizedValue:f,next:null},ps===null){if(s===null)throw Error(r(308));ps=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else ps=ps.next=l;return f}var Mj=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(f,g){s.push(g)}};this.abort=function(){l.aborted=!0,s.forEach(function(f){return f()})}},Pj=t.unstable_scheduleCallback,Oj=t.unstable_NormalPriority,On={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function jy(){return{controller:new Mj,data:new Map,refCount:0}}function mf(s){s.refCount--,s.refCount===0&&Pj(Oj,function(){s.controller.abort()})}var vf=null,zy=0,au=0,su=null;function Vj(s,l){if(vf===null){var f=vf=[];zy=0,au=Fb(),su={status:"pending",value:void 0,then:function(g){f.push(g)}}}return zy++,l.then(oT,oT),l}function oT(){if(--zy===0&&vf!==null){su!==null&&(su.status="fulfilled");var s=vf;vf=null,au=0,su=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function jj(s,l){var f=[],g={status:"pending",value:null,reason:null,then:function(x){f.push(x)}};return s.then(function(){g.status="fulfilled",g.value=l;for(var x=0;x<f.length;x++)(0,f[x])(l)},function(x){for(g.status="rejected",g.reason=x,x=0;x<f.length;x++)(0,f[x])(void 0)}),g}var lT=$.S;$.S=function(s,l){HA=ht(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&Vj(s,l),lT!==null&&lT(s,l)};var Vl=F(null);function Ly(){var s=Vl.current;return s!==null?s:Kt.pooledCache}function Sg(s,l){l===null?Y(Vl,Vl.current):Y(Vl,l.pool)}function cT(){var s=Ly();return s===null?null:{parent:On._currentValue,pool:s}}var ou=Error(r(460)),By=Error(r(474)),Eg=Error(r(542)),Tg={then:function(){}};function uT(s){return s=s.status,s==="fulfilled"||s==="rejected"}function dT(s,l,f){switch(f=s[f],f===void 0?s.push(l):f!==l&&(l.then(Ji,Ji),l=f),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,hT(s),s;default:if(typeof l.status=="string")l.then(Ji,Ji);else{if(s=Kt,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=l,s.status="pending",s.then(function(g){if(l.status==="pending"){var x=l;x.status="fulfilled",x.value=g}},function(g){if(l.status==="pending"){var x=l;x.status="rejected",x.reason=g}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,hT(s),s}throw zl=l,ou}}function jl(s){try{var l=s._init;return l(s._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(zl=f,ou):f}}var zl=null;function fT(){if(zl===null)throw Error(r(459));var s=zl;return zl=null,s}function hT(s){if(s===ou||s===Eg)throw Error(r(483))}var lu=null,yf=0;function Ag(s){var l=yf;return yf+=1,lu===null&&(lu=[]),dT(lu,s,l)}function bf(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function Cg(s,l){throw l.$$typeof===m?Error(r(525)):(s=Object.prototype.toString.call(l),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function pT(s){function l(ie,ee){if(s){var oe=ie.deletions;oe===null?(ie.deletions=[ee],ie.flags|=16):oe.push(ee)}}function f(ie,ee){if(!s)return null;for(;ee!==null;)l(ie,ee),ee=ee.sibling;return null}function g(ie){for(var ee=new Map;ie!==null;)ie.key!==null?ee.set(ie.key,ie):ee.set(ie.index,ie),ie=ie.sibling;return ee}function x(ie,ee){return ie=fs(ie,ee),ie.index=0,ie.sibling=null,ie}function S(ie,ee,oe){return ie.index=oe,s?(oe=ie.alternate,oe!==null?(oe=oe.index,oe<ee?(ie.flags|=67108866,ee):oe):(ie.flags|=67108866,ee)):(ie.flags|=1048576,ee)}function M(ie){return s&&ie.alternate===null&&(ie.flags|=67108866),ie}function U(ie,ee,oe,ye){return ee===null||ee.tag!==6?(ee=Iy(oe,ie.mode,ye),ee.return=ie,ee):(ee=x(ee,oe),ee.return=ie,ee)}function X(ie,ee,oe,ye){var Ge=oe.type;return Ge===w?ve(ie,ee,oe.props.children,ye,oe.key):ee!==null&&(ee.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===C&&jl(Ge)===ee.type)?(ee=x(ee,oe.props),bf(ee,oe),ee.return=ie,ee):(ee=bg(oe.type,oe.key,oe.props,null,ie.mode,ye),bf(ee,oe),ee.return=ie,ee)}function le(ie,ee,oe,ye){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==oe.containerInfo||ee.stateNode.implementation!==oe.implementation?(ee=Dy(oe,ie.mode,ye),ee.return=ie,ee):(ee=x(ee,oe.children||[]),ee.return=ie,ee)}function ve(ie,ee,oe,ye,Ge){return ee===null||ee.tag!==7?(ee=Nl(oe,ie.mode,ye,Ge),ee.return=ie,ee):(ee=x(ee,oe),ee.return=ie,ee)}function be(ie,ee,oe){if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return ee=Iy(""+ee,ie.mode,oe),ee.return=ie,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case y:return oe=bg(ee.type,ee.key,ee.props,null,ie.mode,oe),bf(oe,ee),oe.return=ie,oe;case _:return ee=Dy(ee,ie.mode,oe),ee.return=ie,ee;case C:return ee=jl(ee),be(ie,ee,oe)}if(W(ee)||j(ee))return ee=Nl(ee,ie.mode,oe,null),ee.return=ie,ee;if(typeof ee.then=="function")return be(ie,Ag(ee),oe);if(ee.$$typeof===D)return be(ie,wg(ie,ee),oe);Cg(ie,ee)}return null}function ce(ie,ee,oe,ye){var Ge=ee!==null?ee.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return Ge!==null?null:U(ie,ee,""+oe,ye);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case y:return oe.key===Ge?X(ie,ee,oe,ye):null;case _:return oe.key===Ge?le(ie,ee,oe,ye):null;case C:return oe=jl(oe),ce(ie,ee,oe,ye)}if(W(oe)||j(oe))return Ge!==null?null:ve(ie,ee,oe,ye,null);if(typeof oe.then=="function")return ce(ie,ee,Ag(oe),ye);if(oe.$$typeof===D)return ce(ie,ee,wg(ie,oe),ye);Cg(ie,oe)}return null}function he(ie,ee,oe,ye,Ge){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return ie=ie.get(oe)||null,U(ee,ie,""+ye,Ge);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case y:return ie=ie.get(ye.key===null?oe:ye.key)||null,X(ee,ie,ye,Ge);case _:return ie=ie.get(ye.key===null?oe:ye.key)||null,le(ee,ie,ye,Ge);case C:return ye=jl(ye),he(ie,ee,oe,ye,Ge)}if(W(ye)||j(ye))return ie=ie.get(oe)||null,ve(ee,ie,ye,Ge,null);if(typeof ye.then=="function")return he(ie,ee,oe,Ag(ye),Ge);if(ye.$$typeof===D)return he(ie,ee,oe,wg(ee,ye),Ge);Cg(ee,ye)}return null}function Oe(ie,ee,oe,ye){for(var Ge=null,Ct=null,ze=ee,ct=ee=0,yt=null;ze!==null&&ct<oe.length;ct++){ze.index>ct?(yt=ze,ze=null):yt=ze.sibling;var It=ce(ie,ze,oe[ct],ye);if(It===null){ze===null&&(ze=yt);break}s&&ze&&It.alternate===null&&l(ie,ze),ee=S(It,ee,ct),Ct===null?Ge=It:Ct.sibling=It,Ct=It,ze=yt}if(ct===oe.length)return f(ie,ze),St&&hs(ie,ct),Ge;if(ze===null){for(;ct<oe.length;ct++)ze=be(ie,oe[ct],ye),ze!==null&&(ee=S(ze,ee,ct),Ct===null?Ge=ze:Ct.sibling=ze,Ct=ze);return St&&hs(ie,ct),Ge}for(ze=g(ze);ct<oe.length;ct++)yt=he(ze,ie,ct,oe[ct],ye),yt!==null&&(s&&yt.alternate!==null&&ze.delete(yt.key===null?ct:yt.key),ee=S(yt,ee,ct),Ct===null?Ge=yt:Ct.sibling=yt,Ct=yt);return s&&ze.forEach(function(ko){return l(ie,ko)}),St&&hs(ie,ct),Ge}function Ye(ie,ee,oe,ye){if(oe==null)throw Error(r(151));for(var Ge=null,Ct=null,ze=ee,ct=ee=0,yt=null,It=oe.next();ze!==null&&!It.done;ct++,It=oe.next()){ze.index>ct?(yt=ze,ze=null):yt=ze.sibling;var ko=ce(ie,ze,It.value,ye);if(ko===null){ze===null&&(ze=yt);break}s&&ze&&ko.alternate===null&&l(ie,ze),ee=S(ko,ee,ct),Ct===null?Ge=ko:Ct.sibling=ko,Ct=ko,ze=yt}if(It.done)return f(ie,ze),St&&hs(ie,ct),Ge;if(ze===null){for(;!It.done;ct++,It=oe.next())It=be(ie,It.value,ye),It!==null&&(ee=S(It,ee,ct),Ct===null?Ge=It:Ct.sibling=It,Ct=It);return St&&hs(ie,ct),Ge}for(ze=g(ze);!It.done;ct++,It=oe.next())It=he(ze,ie,ct,It.value,ye),It!==null&&(s&&It.alternate!==null&&ze.delete(It.key===null?ct:It.key),ee=S(It,ee,ct),Ct===null?Ge=It:Ct.sibling=It,Ct=It);return s&&ze.forEach(function(K5){return l(ie,K5)}),St&&hs(ie,ct),Ge}function Ht(ie,ee,oe,ye){if(typeof oe=="object"&&oe!==null&&oe.type===w&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case y:e:{for(var Ge=oe.key;ee!==null;){if(ee.key===Ge){if(Ge=oe.type,Ge===w){if(ee.tag===7){f(ie,ee.sibling),ye=x(ee,oe.props.children),ye.return=ie,ie=ye;break e}}else if(ee.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===C&&jl(Ge)===ee.type){f(ie,ee.sibling),ye=x(ee,oe.props),bf(ye,oe),ye.return=ie,ie=ye;break e}f(ie,ee);break}else l(ie,ee);ee=ee.sibling}oe.type===w?(ye=Nl(oe.props.children,ie.mode,ye,oe.key),ye.return=ie,ie=ye):(ye=bg(oe.type,oe.key,oe.props,null,ie.mode,ye),bf(ye,oe),ye.return=ie,ie=ye)}return M(ie);case _:e:{for(Ge=oe.key;ee!==null;){if(ee.key===Ge)if(ee.tag===4&&ee.stateNode.containerInfo===oe.containerInfo&&ee.stateNode.implementation===oe.implementation){f(ie,ee.sibling),ye=x(ee,oe.children||[]),ye.return=ie,ie=ye;break e}else{f(ie,ee);break}else l(ie,ee);ee=ee.sibling}ye=Dy(oe,ie.mode,ye),ye.return=ie,ie=ye}return M(ie);case C:return oe=jl(oe),Ht(ie,ee,oe,ye)}if(W(oe))return Oe(ie,ee,oe,ye);if(j(oe)){if(Ge=j(oe),typeof Ge!="function")throw Error(r(150));return oe=Ge.call(oe),Ye(ie,ee,oe,ye)}if(typeof oe.then=="function")return Ht(ie,ee,Ag(oe),ye);if(oe.$$typeof===D)return Ht(ie,ee,wg(ie,oe),ye);Cg(ie,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,ee!==null&&ee.tag===6?(f(ie,ee.sibling),ye=x(ee,oe),ye.return=ie,ie=ye):(f(ie,ee),ye=Iy(oe,ie.mode,ye),ye.return=ie,ie=ye),M(ie)):f(ie,ee)}return function(ie,ee,oe,ye){try{yf=0;var Ge=Ht(ie,ee,oe,ye);return lu=null,Ge}catch(ze){if(ze===ou||ze===Eg)throw ze;var Ct=di(29,ze,null,ie.mode);return Ct.lanes=ye,Ct.return=ie,Ct}finally{}}}var Ll=pT(!0),gT=pT(!1),po=!1;function Fy(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Uy(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function go(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function mo(s,l,f){var g=s.updateQueue;if(g===null)return null;if(g=g.shared,(Rt&2)!==0){var x=g.pending;return x===null?l.next=l:(l.next=x.next,x.next=l),g.pending=l,l=yg(s),ZE(s,null,f),l}return vg(s,g,l,f),yg(s)}function xf(s,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194048)!==0)){var g=l.lanes;g&=s.pendingLanes,f|=g,l.lanes=f,an(s,f)}}function Gy(s,l){var f=s.updateQueue,g=s.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var x=null,S=null;if(f=f.firstBaseUpdate,f!==null){do{var M={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};S===null?x=S=M:S=S.next=M,f=f.next}while(f!==null);S===null?x=S=l:S=S.next=l}else x=S=l;f={baseState:g.baseState,firstBaseUpdate:x,lastBaseUpdate:S,shared:g.shared,callbacks:g.callbacks},s.updateQueue=f;return}s=f.lastBaseUpdate,s===null?f.firstBaseUpdate=l:s.next=l,f.lastBaseUpdate=l}var qy=!1;function _f(){if(qy){var s=su;if(s!==null)throw s}}function wf(s,l,f,g){qy=!1;var x=s.updateQueue;po=!1;var S=x.firstBaseUpdate,M=x.lastBaseUpdate,U=x.shared.pending;if(U!==null){x.shared.pending=null;var X=U,le=X.next;X.next=null,M===null?S=le:M.next=le,M=X;var ve=s.alternate;ve!==null&&(ve=ve.updateQueue,U=ve.lastBaseUpdate,U!==M&&(U===null?ve.firstBaseUpdate=le:U.next=le,ve.lastBaseUpdate=X))}if(S!==null){var be=x.baseState;M=0,ve=le=X=null,U=S;do{var ce=U.lane&-536870913,he=ce!==U.lane;if(he?(vt&ce)===ce:(g&ce)===ce){ce!==0&&ce===au&&(qy=!0),ve!==null&&(ve=ve.next={lane:0,tag:U.tag,payload:U.payload,callback:null,next:null});e:{var Oe=s,Ye=U;ce=l;var Ht=f;switch(Ye.tag){case 1:if(Oe=Ye.payload,typeof Oe=="function"){be=Oe.call(Ht,be,ce);break e}be=Oe;break e;case 3:Oe.flags=Oe.flags&-65537|128;case 0:if(Oe=Ye.payload,ce=typeof Oe=="function"?Oe.call(Ht,be,ce):Oe,ce==null)break e;be=p({},be,ce);break e;case 2:po=!0}}ce=U.callback,ce!==null&&(s.flags|=64,he&&(s.flags|=8192),he=x.callbacks,he===null?x.callbacks=[ce]:he.push(ce))}else he={lane:ce,tag:U.tag,payload:U.payload,callback:U.callback,next:null},ve===null?(le=ve=he,X=be):ve=ve.next=he,M|=ce;if(U=U.next,U===null){if(U=x.shared.pending,U===null)break;he=U,U=he.next,he.next=null,x.lastBaseUpdate=he,x.shared.pending=null}}while(!0);ve===null&&(X=be),x.baseState=X,x.firstBaseUpdate=le,x.lastBaseUpdate=ve,S===null&&(x.shared.lanes=0),_o|=M,s.lanes=M,s.memoizedState=be}}function mT(s,l){if(typeof s!="function")throw Error(r(191,s));s.call(l)}function vT(s,l){var f=s.callbacks;if(f!==null)for(s.callbacks=null,s=0;s<f.length;s++)mT(f[s],l)}var cu=F(null),Ig=F(0);function yT(s,l){s=Es,Y(Ig,s),Y(cu,l),Es=s|l.baseLanes}function Hy(){Y(Ig,Es),Y(cu,cu.current)}function $y(){Es=Ig.current,Q(cu),Q(Ig)}var fi=F(null),Mi=null;function vo(s){var l=s.alternate;Y(In,In.current&1),Y(fi,s),Mi===null&&(l===null||cu.current!==null||l.memoizedState!==null)&&(Mi=s)}function Yy(s){Y(In,In.current),Y(fi,s),Mi===null&&(Mi=s)}function bT(s){s.tag===22?(Y(In,In.current),Y(fi,s),Mi===null&&(Mi=s)):yo()}function yo(){Y(In,In.current),Y(fi,fi.current)}function hi(s){Q(fi),Mi===s&&(Mi=null),Q(In)}var In=F(0);function Dg(s){for(var l=s;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||Jb(f)||e1(f)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var ms=0,ot=null,Gt=null,Vn=null,Rg=!1,uu=!1,Bl=!1,kg=0,Sf=0,du=null,zj=0;function xn(){throw Error(r(321))}function Ky(s,l){if(l===null)return!1;for(var f=0;f<l.length&&f<s.length;f++)if(!ui(s[f],l[f]))return!1;return!0}function Xy(s,l,f,g,x,S){return ms=S,ot=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,$.H=s===null||s.memoizedState===null?nA:ub,Bl=!1,S=f(g,x),Bl=!1,uu&&(S=_T(l,f,g,x)),xT(s),S}function xT(s){$.H=Af;var l=Gt!==null&&Gt.next!==null;if(ms=0,Vn=Gt=ot=null,Rg=!1,Sf=0,du=null,l)throw Error(r(300));s===null||jn||(s=s.dependencies,s!==null&&_g(s)&&(jn=!0))}function _T(s,l,f,g){ot=s;var x=0;do{if(uu&&(du=null),Sf=0,uu=!1,25<=x)throw Error(r(301));if(x+=1,Vn=Gt=null,s.updateQueue!=null){var S=s.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}$.H=rA,S=l(f,g)}while(uu);return S}function Lj(){var s=$.H,l=s.useState()[0];return l=typeof l.then=="function"?Ef(l):l,s=s.useState()[0],(Gt!==null?Gt.memoizedState:null)!==s&&(ot.flags|=1024),l}function Wy(){var s=kg!==0;return kg=0,s}function Qy(s,l,f){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~f}function Zy(s){if(Rg){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}Rg=!1}ms=0,Vn=Gt=ot=null,uu=!1,Sf=kg=0,du=null}function Pr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vn===null?ot.memoizedState=Vn=s:Vn=Vn.next=s,Vn}function Dn(){if(Gt===null){var s=ot.alternate;s=s!==null?s.memoizedState:null}else s=Gt.next;var l=Vn===null?ot.memoizedState:Vn.next;if(l!==null)Vn=l,Gt=s;else{if(s===null)throw ot.alternate===null?Error(r(467)):Error(r(310));Gt=s,s={memoizedState:Gt.memoizedState,baseState:Gt.baseState,baseQueue:Gt.baseQueue,queue:Gt.queue,next:null},Vn===null?ot.memoizedState=Vn=s:Vn=Vn.next=s}return Vn}function Ng(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ef(s){var l=Sf;return Sf+=1,du===null&&(du=[]),s=dT(du,s,l),l=ot,(Vn===null?l.memoizedState:Vn.next)===null&&(l=l.alternate,$.H=l===null||l.memoizedState===null?nA:ub),s}function Mg(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Ef(s);if(s.$$typeof===D)return fr(s)}throw Error(r(438,String(s)))}function Jy(s){var l=null,f=ot.updateQueue;if(f!==null&&(l=f.memoCache),l==null){var g=ot.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(l={data:g.data.map(function(x){return x.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),f===null&&(f=Ng(),ot.updateQueue=f),f.memoCache=l,f=l.data[l.index],f===void 0)for(f=l.data[l.index]=Array(s),g=0;g<s;g++)f[g]=V;return l.index++,f}function vs(s,l){return typeof l=="function"?l(s):l}function Pg(s){var l=Dn();return eb(l,Gt,s)}function eb(s,l,f){var g=s.queue;if(g===null)throw Error(r(311));g.lastRenderedReducer=f;var x=s.baseQueue,S=g.pending;if(S!==null){if(x!==null){var M=x.next;x.next=S.next,S.next=M}l.baseQueue=x=S,g.pending=null}if(S=s.baseState,x===null)s.memoizedState=S;else{l=x.next;var U=M=null,X=null,le=l,ve=!1;do{var be=le.lane&-536870913;if(be!==le.lane?(vt&be)===be:(ms&be)===be){var ce=le.revertLane;if(ce===0)X!==null&&(X=X.next={lane:0,revertLane:0,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),be===au&&(ve=!0);else if((ms&ce)===ce){le=le.next,ce===au&&(ve=!0);continue}else be={lane:0,revertLane:le.revertLane,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},X===null?(U=X=be,M=S):X=X.next=be,ot.lanes|=ce,_o|=ce;be=le.action,Bl&&f(S,be),S=le.hasEagerState?le.eagerState:f(S,be)}else ce={lane:be,revertLane:le.revertLane,gesture:le.gesture,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},X===null?(U=X=ce,M=S):X=X.next=ce,ot.lanes|=be,_o|=be;le=le.next}while(le!==null&&le!==l);if(X===null?M=S:X.next=U,!ui(S,s.memoizedState)&&(jn=!0,ve&&(f=su,f!==null)))throw f;s.memoizedState=S,s.baseState=M,s.baseQueue=X,g.lastRenderedState=S}return x===null&&(g.lanes=0),[s.memoizedState,g.dispatch]}function tb(s){var l=Dn(),f=l.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=s;var g=f.dispatch,x=f.pending,S=l.memoizedState;if(x!==null){f.pending=null;var M=x=x.next;do S=s(S,M.action),M=M.next;while(M!==x);ui(S,l.memoizedState)||(jn=!0),l.memoizedState=S,l.baseQueue===null&&(l.baseState=S),f.lastRenderedState=S}return[S,g]}function wT(s,l,f){var g=ot,x=Dn(),S=St;if(S){if(f===void 0)throw Error(r(407));f=f()}else f=l();var M=!ui((Gt||x).memoizedState,f);if(M&&(x.memoizedState=f,jn=!0),x=x.queue,ib(TT.bind(null,g,x,s),[s]),x.getSnapshot!==l||M||Vn!==null&&Vn.memoizedState.tag&1){if(g.flags|=2048,fu(9,{destroy:void 0},ET.bind(null,g,x,f,l),null),Kt===null)throw Error(r(349));S||(ms&127)!==0||ST(g,l,f)}return f}function ST(s,l,f){s.flags|=16384,s={getSnapshot:l,value:f},l=ot.updateQueue,l===null?(l=Ng(),ot.updateQueue=l,l.stores=[s]):(f=l.stores,f===null?l.stores=[s]:f.push(s))}function ET(s,l,f,g){l.value=f,l.getSnapshot=g,AT(l)&&CT(s)}function TT(s,l,f){return f(function(){AT(l)&&CT(s)})}function AT(s){var l=s.getSnapshot;s=s.value;try{var f=l();return!ui(s,f)}catch{return!0}}function CT(s){var l=kl(s,2);l!==null&&Jr(l,s,2)}function nb(s){var l=Pr();if(typeof s=="function"){var f=s;if(s=f(),Bl){tr(!0);try{f()}finally{tr(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vs,lastRenderedState:s},l}function IT(s,l,f,g){return s.baseState=f,eb(s,Gt,typeof g=="function"?g:vs)}function Bj(s,l,f,g,x){if(jg(s))throw Error(r(485));if(s=l.action,s!==null){var S={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(M){S.listeners.push(M)}};$.T!==null?f(!0):S.isTransition=!1,g(S),f=l.pending,f===null?(S.next=l.pending=S,DT(l,S)):(S.next=f.next,l.pending=f.next=S)}}function DT(s,l){var f=l.action,g=l.payload,x=s.state;if(l.isTransition){var S=$.T,M={};$.T=M;try{var U=f(x,g),X=$.S;X!==null&&X(M,U),RT(s,l,U)}catch(le){rb(s,l,le)}finally{S!==null&&M.types!==null&&(S.types=M.types),$.T=S}}else try{S=f(x,g),RT(s,l,S)}catch(le){rb(s,l,le)}}function RT(s,l,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(g){kT(s,l,g)},function(g){return rb(s,l,g)}):kT(s,l,f)}function kT(s,l,f){l.status="fulfilled",l.value=f,NT(l),s.state=f,l=s.pending,l!==null&&(f=l.next,f===l?s.pending=null:(f=f.next,l.next=f,DT(s,f)))}function rb(s,l,f){var g=s.pending;if(s.pending=null,g!==null){g=g.next;do l.status="rejected",l.reason=f,NT(l),l=l.next;while(l!==g)}s.action=null}function NT(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function MT(s,l){return l}function PT(s,l){if(St){var f=Kt.formState;if(f!==null){e:{var g=ot;if(St){if(en){t:{for(var x=en,S=Ni;x.nodeType!==8;){if(!S){x=null;break t}if(x=Pi(x.nextSibling),x===null){x=null;break t}}S=x.data,x=S==="F!"||S==="F"?x:null}if(x){en=Pi(x.nextSibling),g=x.data==="F!";break e}}fo(g)}g=!1}g&&(l=f[0])}}return f=Pr(),f.memoizedState=f.baseState=l,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:MT,lastRenderedState:l},f.queue=g,f=JT.bind(null,ot,g),g.dispatch=f,g=nb(!1),S=cb.bind(null,ot,!1,g.queue),g=Pr(),x={state:l,dispatch:null,action:s,pending:null},g.queue=x,f=Bj.bind(null,ot,x,S,f),x.dispatch=f,g.memoizedState=s,[l,f,!1]}function OT(s){var l=Dn();return VT(l,Gt,s)}function VT(s,l,f){if(l=eb(s,l,MT)[0],s=Pg(vs)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var g=Ef(l)}catch(M){throw M===ou?Eg:M}else g=l;l=Dn();var x=l.queue,S=x.dispatch;return f!==l.memoizedState&&(ot.flags|=2048,fu(9,{destroy:void 0},Fj.bind(null,x,f),null)),[g,S,s]}function Fj(s,l){s.action=l}function jT(s){var l=Dn(),f=Gt;if(f!==null)return VT(l,f,s);Dn(),l=l.memoizedState,f=Dn();var g=f.queue.dispatch;return f.memoizedState=s,[l,g,!1]}function fu(s,l,f,g){return s={tag:s,create:f,deps:g,inst:l,next:null},l=ot.updateQueue,l===null&&(l=Ng(),ot.updateQueue=l),f=l.lastEffect,f===null?l.lastEffect=s.next=s:(g=f.next,f.next=s,s.next=g,l.lastEffect=s),s}function zT(){return Dn().memoizedState}function Og(s,l,f,g){var x=Pr();ot.flags|=s,x.memoizedState=fu(1|l,{destroy:void 0},f,g===void 0?null:g)}function Vg(s,l,f,g){var x=Dn();g=g===void 0?null:g;var S=x.memoizedState.inst;Gt!==null&&g!==null&&Ky(g,Gt.memoizedState.deps)?x.memoizedState=fu(l,S,f,g):(ot.flags|=s,x.memoizedState=fu(1|l,S,f,g))}function LT(s,l){Og(8390656,8,s,l)}function ib(s,l){Vg(2048,8,s,l)}function Uj(s){ot.flags|=4;var l=ot.updateQueue;if(l===null)l=Ng(),ot.updateQueue=l,l.events=[s];else{var f=l.events;f===null?l.events=[s]:f.push(s)}}function BT(s){var l=Dn().memoizedState;return Uj({ref:l,nextImpl:s}),function(){if((Rt&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}function FT(s,l){return Vg(4,2,s,l)}function UT(s,l){return Vg(4,4,s,l)}function GT(s,l){if(typeof l=="function"){s=s();var f=l(s);return function(){typeof f=="function"?f():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function qT(s,l,f){f=f!=null?f.concat([s]):null,Vg(4,4,GT.bind(null,l,s),f)}function ab(){}function HT(s,l){var f=Dn();l=l===void 0?null:l;var g=f.memoizedState;return l!==null&&Ky(l,g[1])?g[0]:(f.memoizedState=[s,l],s)}function $T(s,l){var f=Dn();l=l===void 0?null:l;var g=f.memoizedState;if(l!==null&&Ky(l,g[1]))return g[0];if(g=s(),Bl){tr(!0);try{s()}finally{tr(!1)}}return f.memoizedState=[g,l],g}function sb(s,l,f){return f===void 0||(ms&1073741824)!==0&&(vt&261930)===0?s.memoizedState=l:(s.memoizedState=f,s=YA(),ot.lanes|=s,_o|=s,f)}function YT(s,l,f,g){return ui(f,l)?f:cu.current!==null?(s=sb(s,f,g),ui(s,l)||(jn=!0),s):(ms&42)===0||(ms&1073741824)!==0&&(vt&261930)===0?(jn=!0,s.memoizedState=f):(s=YA(),ot.lanes|=s,_o|=s,l)}function KT(s,l,f,g,x){var S=H.p;H.p=S!==0&&8>S?S:8;var M=$.T,U={};$.T=U,cb(s,!1,l,f);try{var X=x(),le=$.S;if(le!==null&&le(U,X),X!==null&&typeof X=="object"&&typeof X.then=="function"){var ve=jj(X,g);Tf(s,l,ve,mi(s))}else Tf(s,l,g,mi(s))}catch(be){Tf(s,l,{then:function(){},status:"rejected",reason:be},mi())}finally{H.p=S,M!==null&&U.types!==null&&(M.types=U.types),$.T=M}}function Gj(){}function ob(s,l,f,g){if(s.tag!==5)throw Error(r(476));var x=XT(s).queue;KT(s,x,l,te,f===null?Gj:function(){return WT(s),f(g)})}function XT(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:te,baseState:te,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vs,lastRenderedState:te},next:null};var f={};return l.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vs,lastRenderedState:f},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function WT(s){var l=XT(s);l.next===null&&(l=s.alternate.memoizedState),Tf(s,l.next.queue,{},mi())}function lb(){return fr(Uf)}function QT(){return Dn().memoizedState}function ZT(){return Dn().memoizedState}function qj(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var f=mi();s=go(f);var g=mo(l,s,f);g!==null&&(Jr(g,l,f),xf(g,l,f)),l={cache:jy()},s.payload=l;return}l=l.return}}function Hj(s,l,f){var g=mi();f={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},jg(s)?eA(l,f):(f=Ay(s,l,f,g),f!==null&&(Jr(f,s,g),tA(f,l,g)))}function JT(s,l,f){var g=mi();Tf(s,l,f,g)}function Tf(s,l,f,g){var x={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(jg(s))eA(l,x);else{var S=s.alternate;if(s.lanes===0&&(S===null||S.lanes===0)&&(S=l.lastRenderedReducer,S!==null))try{var M=l.lastRenderedState,U=S(M,f);if(x.hasEagerState=!0,x.eagerState=U,ui(U,M))return vg(s,l,x,0),Kt===null&&mg(),!1}catch{}finally{}if(f=Ay(s,l,x,g),f!==null)return Jr(f,s,g),tA(f,l,g),!0}return!1}function cb(s,l,f,g){if(g={lane:2,revertLane:Fb(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},jg(s)){if(l)throw Error(r(479))}else l=Ay(s,f,g,2),l!==null&&Jr(l,s,2)}function jg(s){var l=s.alternate;return s===ot||l!==null&&l===ot}function eA(s,l){uu=Rg=!0;var f=s.pending;f===null?l.next=l:(l.next=f.next,f.next=l),s.pending=l}function tA(s,l,f){if((f&4194048)!==0){var g=l.lanes;g&=s.pendingLanes,f|=g,l.lanes=f,an(s,f)}}var Af={readContext:fr,use:Mg,useCallback:xn,useContext:xn,useEffect:xn,useImperativeHandle:xn,useLayoutEffect:xn,useInsertionEffect:xn,useMemo:xn,useReducer:xn,useRef:xn,useState:xn,useDebugValue:xn,useDeferredValue:xn,useTransition:xn,useSyncExternalStore:xn,useId:xn,useHostTransitionStatus:xn,useFormState:xn,useActionState:xn,useOptimistic:xn,useMemoCache:xn,useCacheRefresh:xn};Af.useEffectEvent=xn;var nA={readContext:fr,use:Mg,useCallback:function(s,l){return Pr().memoizedState=[s,l===void 0?null:l],s},useContext:fr,useEffect:LT,useImperativeHandle:function(s,l,f){f=f!=null?f.concat([s]):null,Og(4194308,4,GT.bind(null,l,s),f)},useLayoutEffect:function(s,l){return Og(4194308,4,s,l)},useInsertionEffect:function(s,l){Og(4,2,s,l)},useMemo:function(s,l){var f=Pr();l=l===void 0?null:l;var g=s();if(Bl){tr(!0);try{s()}finally{tr(!1)}}return f.memoizedState=[g,l],g},useReducer:function(s,l,f){var g=Pr();if(f!==void 0){var x=f(l);if(Bl){tr(!0);try{f(l)}finally{tr(!1)}}}else x=l;return g.memoizedState=g.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},g.queue=s,s=s.dispatch=Hj.bind(null,ot,s),[g.memoizedState,s]},useRef:function(s){var l=Pr();return s={current:s},l.memoizedState=s},useState:function(s){s=nb(s);var l=s.queue,f=JT.bind(null,ot,l);return l.dispatch=f,[s.memoizedState,f]},useDebugValue:ab,useDeferredValue:function(s,l){var f=Pr();return sb(f,s,l)},useTransition:function(){var s=nb(!1);return s=KT.bind(null,ot,s.queue,!0,!1),Pr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,f){var g=ot,x=Pr();if(St){if(f===void 0)throw Error(r(407));f=f()}else{if(f=l(),Kt===null)throw Error(r(349));(vt&127)!==0||ST(g,l,f)}x.memoizedState=f;var S={value:f,getSnapshot:l};return x.queue=S,LT(TT.bind(null,g,S,s),[s]),g.flags|=2048,fu(9,{destroy:void 0},ET.bind(null,g,S,f,l),null),f},useId:function(){var s=Pr(),l=Kt.identifierPrefix;if(St){var f=Oa,g=Pa;f=(g&~(1<<32-Qt(g)-1)).toString(32)+f,l="_"+l+"R_"+f,f=kg++,0<f&&(l+="H"+f.toString(32)),l+="_"}else f=zj++,l="_"+l+"r_"+f.toString(32)+"_";return s.memoizedState=l},useHostTransitionStatus:lb,useFormState:PT,useActionState:PT,useOptimistic:function(s){var l=Pr();l.memoizedState=l.baseState=s;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=f,l=cb.bind(null,ot,!0,f),f.dispatch=l,[s,l]},useMemoCache:Jy,useCacheRefresh:function(){return Pr().memoizedState=qj.bind(null,ot)},useEffectEvent:function(s){var l=Pr(),f={impl:s};return l.memoizedState=f,function(){if((Rt&2)!==0)throw Error(r(440));return f.impl.apply(void 0,arguments)}}},ub={readContext:fr,use:Mg,useCallback:HT,useContext:fr,useEffect:ib,useImperativeHandle:qT,useInsertionEffect:FT,useLayoutEffect:UT,useMemo:$T,useReducer:Pg,useRef:zT,useState:function(){return Pg(vs)},useDebugValue:ab,useDeferredValue:function(s,l){var f=Dn();return YT(f,Gt.memoizedState,s,l)},useTransition:function(){var s=Pg(vs)[0],l=Dn().memoizedState;return[typeof s=="boolean"?s:Ef(s),l]},useSyncExternalStore:wT,useId:QT,useHostTransitionStatus:lb,useFormState:OT,useActionState:OT,useOptimistic:function(s,l){var f=Dn();return IT(f,Gt,s,l)},useMemoCache:Jy,useCacheRefresh:ZT};ub.useEffectEvent=BT;var rA={readContext:fr,use:Mg,useCallback:HT,useContext:fr,useEffect:ib,useImperativeHandle:qT,useInsertionEffect:FT,useLayoutEffect:UT,useMemo:$T,useReducer:tb,useRef:zT,useState:function(){return tb(vs)},useDebugValue:ab,useDeferredValue:function(s,l){var f=Dn();return Gt===null?sb(f,s,l):YT(f,Gt.memoizedState,s,l)},useTransition:function(){var s=tb(vs)[0],l=Dn().memoizedState;return[typeof s=="boolean"?s:Ef(s),l]},useSyncExternalStore:wT,useId:QT,useHostTransitionStatus:lb,useFormState:jT,useActionState:jT,useOptimistic:function(s,l){var f=Dn();return Gt!==null?IT(f,Gt,s,l):(f.baseState=s,[s,f.queue.dispatch])},useMemoCache:Jy,useCacheRefresh:ZT};rA.useEffectEvent=BT;function db(s,l,f,g){l=s.memoizedState,f=f(g,l),f=f==null?l:p({},l,f),s.memoizedState=f,s.lanes===0&&(s.updateQueue.baseState=f)}var fb={enqueueSetState:function(s,l,f){s=s._reactInternals;var g=mi(),x=go(g);x.payload=l,f!=null&&(x.callback=f),l=mo(s,x,g),l!==null&&(Jr(l,s,g),xf(l,s,g))},enqueueReplaceState:function(s,l,f){s=s._reactInternals;var g=mi(),x=go(g);x.tag=1,x.payload=l,f!=null&&(x.callback=f),l=mo(s,x,g),l!==null&&(Jr(l,s,g),xf(l,s,g))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var f=mi(),g=go(f);g.tag=2,l!=null&&(g.callback=l),l=mo(s,g,f),l!==null&&(Jr(l,s,f),xf(l,s,f))}};function iA(s,l,f,g,x,S,M){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(g,S,M):l.prototype&&l.prototype.isPureReactComponent?!ff(f,g)||!ff(x,S):!0}function aA(s,l,f,g){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,g),l.state!==s&&fb.enqueueReplaceState(l,l.state,null)}function Fl(s,l){var f=l;if("ref"in l){f={};for(var g in l)g!=="ref"&&(f[g]=l[g])}if(s=s.defaultProps){f===l&&(f=p({},f));for(var x in s)f[x]===void 0&&(f[x]=s[x])}return f}function sA(s){gg(s)}function oA(s){console.error(s)}function lA(s){gg(s)}function zg(s,l){try{var f=s.onUncaughtError;f(l.value,{componentStack:l.stack})}catch(g){setTimeout(function(){throw g})}}function cA(s,l,f){try{var g=s.onCaughtError;g(f.value,{componentStack:f.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function hb(s,l,f){return f=go(f),f.tag=3,f.payload={element:null},f.callback=function(){zg(s,l)},f}function uA(s){return s=go(s),s.tag=3,s}function dA(s,l,f,g){var x=f.type.getDerivedStateFromError;if(typeof x=="function"){var S=g.value;s.payload=function(){return x(S)},s.callback=function(){cA(l,f,g)}}var M=f.stateNode;M!==null&&typeof M.componentDidCatch=="function"&&(s.callback=function(){cA(l,f,g),typeof x!="function"&&(wo===null?wo=new Set([this]):wo.add(this));var U=g.stack;this.componentDidCatch(g.value,{componentStack:U!==null?U:""})})}function $j(s,l,f,g,x){if(f.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(l=f.alternate,l!==null&&iu(l,f,x,!0),f=fi.current,f!==null){switch(f.tag){case 31:case 13:return Mi===null?Wg():f.alternate===null&&_n===0&&(_n=3),f.flags&=-257,f.flags|=65536,f.lanes=x,g===Tg?f.flags|=16384:(l=f.updateQueue,l===null?f.updateQueue=new Set([g]):l.add(g),zb(s,g,x)),!1;case 22:return f.flags|=65536,g===Tg?f.flags|=16384:(l=f.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([g])},f.updateQueue=l):(f=l.retryQueue,f===null?l.retryQueue=new Set([g]):f.add(g)),zb(s,g,x)),!1}throw Error(r(435,f.tag))}return zb(s,g,x),Wg(),!1}if(St)return l=fi.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=x,g!==Ny&&(s=Error(r(422),{cause:g}),gf(Di(s,f)))):(g!==Ny&&(l=Error(r(423),{cause:g}),gf(Di(l,f))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,g=Di(g,f),x=hb(s.stateNode,g,x),Gy(s,x),_n!==4&&(_n=2)),!1;var S=Error(r(520),{cause:g});if(S=Di(S,f),Pf===null?Pf=[S]:Pf.push(S),_n!==4&&(_n=2),l===null)return!0;g=Di(g,f),f=l;do{switch(f.tag){case 3:return f.flags|=65536,s=x&-x,f.lanes|=s,s=hb(f.stateNode,g,s),Gy(f,s),!1;case 1:if(l=f.type,S=f.stateNode,(f.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(wo===null||!wo.has(S))))return f.flags|=65536,x&=-x,f.lanes|=x,x=uA(x),dA(x,s,f,g),Gy(f,x),!1}f=f.return}while(f!==null);return!1}var pb=Error(r(461)),jn=!1;function hr(s,l,f,g){l.child=s===null?gT(l,null,f,g):Ll(l,s.child,f,g)}function fA(s,l,f,g,x){f=f.render;var S=l.ref;if("ref"in g){var M={};for(var U in g)U!=="ref"&&(M[U]=g[U])}else M=g;return Ol(l),g=Xy(s,l,f,M,S,x),U=Wy(),s!==null&&!jn?(Qy(s,l,x),ys(s,l,x)):(St&&U&&Ry(l),l.flags|=1,hr(s,l,g,x),l.child)}function hA(s,l,f,g,x){if(s===null){var S=f.type;return typeof S=="function"&&!Cy(S)&&S.defaultProps===void 0&&f.compare===null?(l.tag=15,l.type=S,pA(s,l,S,g,x)):(s=bg(f.type,null,g,l,l.mode,x),s.ref=l.ref,s.return=l,l.child=s)}if(S=s.child,!wb(s,x)){var M=S.memoizedProps;if(f=f.compare,f=f!==null?f:ff,f(M,g)&&s.ref===l.ref)return ys(s,l,x)}return l.flags|=1,s=fs(S,g),s.ref=l.ref,s.return=l,l.child=s}function pA(s,l,f,g,x){if(s!==null){var S=s.memoizedProps;if(ff(S,g)&&s.ref===l.ref)if(jn=!1,l.pendingProps=g=S,wb(s,x))(s.flags&131072)!==0&&(jn=!0);else return l.lanes=s.lanes,ys(s,l,x)}return gb(s,l,f,g,x)}function gA(s,l,f,g){var x=g.children,S=s!==null?s.memoizedState:null;if(s===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((l.flags&128)!==0){if(S=S!==null?S.baseLanes|f:f,s!==null){for(g=l.child=s.child,x=0;g!==null;)x=x|g.lanes|g.childLanes,g=g.sibling;g=x&~S}else g=0,l.child=null;return mA(s,l,S,f,g)}if((f&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&Sg(l,S!==null?S.cachePool:null),S!==null?yT(l,S):Hy(),bT(l);else return g=l.lanes=536870912,mA(s,l,S!==null?S.baseLanes|f:f,f,g)}else S!==null?(Sg(l,S.cachePool),yT(l,S),yo(),l.memoizedState=null):(s!==null&&Sg(l,null),Hy(),yo());return hr(s,l,x,f),l.child}function Cf(s,l){return s!==null&&s.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function mA(s,l,f,g,x){var S=Ly();return S=S===null?null:{parent:On._currentValue,pool:S},l.memoizedState={baseLanes:f,cachePool:S},s!==null&&Sg(l,null),Hy(),bT(l),s!==null&&iu(s,l,g,!0),l.childLanes=x,null}function Lg(s,l){return l=Fg({mode:l.mode,children:l.children},s.mode),l.ref=s.ref,s.child=l,l.return=s,l}function vA(s,l,f){return Ll(l,s.child,null,f),s=Lg(l,l.pendingProps),s.flags|=2,hi(l),l.memoizedState=null,s}function Yj(s,l,f){var g=l.pendingProps,x=(l.flags&128)!==0;if(l.flags&=-129,s===null){if(St){if(g.mode==="hidden")return s=Lg(l,g),l.lanes=536870912,Cf(null,s);if(Yy(l),(s=en)?(s=DC(s,Ni),s=s!==null&&s.data==="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:co!==null?{id:Pa,overflow:Oa}:null,retryLane:536870912,hydrationErrors:null},f=eT(s),f.return=l,l.child=f,dr=l,en=null)):s=null,s===null)throw fo(l);return l.lanes=536870912,null}return Lg(l,g)}var S=s.memoizedState;if(S!==null){var M=S.dehydrated;if(Yy(l),x)if(l.flags&256)l.flags&=-257,l=vA(s,l,f);else if(l.memoizedState!==null)l.child=s.child,l.flags|=128,l=null;else throw Error(r(558));else if(jn||iu(s,l,f,!1),x=(f&s.childLanes)!==0,jn||x){if(g=Kt,g!==null&&(M=nr(g,f),M!==0&&M!==S.retryLane))throw S.retryLane=M,kl(s,M),Jr(g,s,M),pb;Wg(),l=vA(s,l,f)}else s=S.treeContext,en=Pi(M.nextSibling),dr=l,St=!0,uo=null,Ni=!1,s!==null&&rT(l,s),l=Lg(l,g),l.flags|=4096;return l}return s=fs(s.child,{mode:g.mode,children:g.children}),s.ref=l.ref,l.child=s,s.return=l,s}function Bg(s,l){var f=l.ref;if(f===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(r(284));(s===null||s.ref!==f)&&(l.flags|=4194816)}}function gb(s,l,f,g,x){return Ol(l),f=Xy(s,l,f,g,void 0,x),g=Wy(),s!==null&&!jn?(Qy(s,l,x),ys(s,l,x)):(St&&g&&Ry(l),l.flags|=1,hr(s,l,f,x),l.child)}function yA(s,l,f,g,x,S){return Ol(l),l.updateQueue=null,f=_T(l,g,f,x),xT(s),g=Wy(),s!==null&&!jn?(Qy(s,l,S),ys(s,l,S)):(St&&g&&Ry(l),l.flags|=1,hr(s,l,f,S),l.child)}function bA(s,l,f,g,x){if(Ol(l),l.stateNode===null){var S=eu,M=f.contextType;typeof M=="object"&&M!==null&&(S=fr(M)),S=new f(g,S),l.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=fb,l.stateNode=S,S._reactInternals=l,S=l.stateNode,S.props=g,S.state=l.memoizedState,S.refs={},Fy(l),M=f.contextType,S.context=typeof M=="object"&&M!==null?fr(M):eu,S.state=l.memoizedState,M=f.getDerivedStateFromProps,typeof M=="function"&&(db(l,f,M,g),S.state=l.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(M=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),M!==S.state&&fb.enqueueReplaceState(S,S.state,null),wf(l,g,S,x),_f(),S.state=l.memoizedState),typeof S.componentDidMount=="function"&&(l.flags|=4194308),g=!0}else if(s===null){S=l.stateNode;var U=l.memoizedProps,X=Fl(f,U);S.props=X;var le=S.context,ve=f.contextType;M=eu,typeof ve=="object"&&ve!==null&&(M=fr(ve));var be=f.getDerivedStateFromProps;ve=typeof be=="function"||typeof S.getSnapshotBeforeUpdate=="function",U=l.pendingProps!==U,ve||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(U||le!==M)&&aA(l,S,g,M),po=!1;var ce=l.memoizedState;S.state=ce,wf(l,g,S,x),_f(),le=l.memoizedState,U||ce!==le||po?(typeof be=="function"&&(db(l,f,be,g),le=l.memoizedState),(X=po||iA(l,f,X,g,ce,le,M))?(ve||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(l.flags|=4194308)):(typeof S.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=le),S.props=g,S.state=le,S.context=M,g=X):(typeof S.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{S=l.stateNode,Uy(s,l),M=l.memoizedProps,ve=Fl(f,M),S.props=ve,be=l.pendingProps,ce=S.context,le=f.contextType,X=eu,typeof le=="object"&&le!==null&&(X=fr(le)),U=f.getDerivedStateFromProps,(le=typeof U=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(M!==be||ce!==X)&&aA(l,S,g,X),po=!1,ce=l.memoizedState,S.state=ce,wf(l,g,S,x),_f();var he=l.memoizedState;M!==be||ce!==he||po||s!==null&&s.dependencies!==null&&_g(s.dependencies)?(typeof U=="function"&&(db(l,f,U,g),he=l.memoizedState),(ve=po||iA(l,f,ve,g,ce,he,X)||s!==null&&s.dependencies!==null&&_g(s.dependencies))?(le||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(g,he,X),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(g,he,X)),typeof S.componentDidUpdate=="function"&&(l.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof S.componentDidUpdate!="function"||M===s.memoizedProps&&ce===s.memoizedState||(l.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||M===s.memoizedProps&&ce===s.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=he),S.props=g,S.state=he,S.context=X,g=ve):(typeof S.componentDidUpdate!="function"||M===s.memoizedProps&&ce===s.memoizedState||(l.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||M===s.memoizedProps&&ce===s.memoizedState||(l.flags|=1024),g=!1)}return S=g,Bg(s,l),g=(l.flags&128)!==0,S||g?(S=l.stateNode,f=g&&typeof f.getDerivedStateFromError!="function"?null:S.render(),l.flags|=1,s!==null&&g?(l.child=Ll(l,s.child,null,x),l.child=Ll(l,null,f,x)):hr(s,l,f,x),l.memoizedState=S.state,s=l.child):s=ys(s,l,x),s}function xA(s,l,f,g){return Ml(),l.flags|=256,hr(s,l,f,g),l.child}var mb={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function vb(s){return{baseLanes:s,cachePool:cT()}}function yb(s,l,f){return s=s!==null?s.childLanes&~f:0,l&&(s|=gi),s}function _A(s,l,f){var g=l.pendingProps,x=!1,S=(l.flags&128)!==0,M;if((M=S)||(M=s!==null&&s.memoizedState===null?!1:(In.current&2)!==0),M&&(x=!0,l.flags&=-129),M=(l.flags&32)!==0,l.flags&=-33,s===null){if(St){if(x?vo(l):yo(),(s=en)?(s=DC(s,Ni),s=s!==null&&s.data!=="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:co!==null?{id:Pa,overflow:Oa}:null,retryLane:536870912,hydrationErrors:null},f=eT(s),f.return=l,l.child=f,dr=l,en=null)):s=null,s===null)throw fo(l);return e1(s)?l.lanes=32:l.lanes=536870912,null}var U=g.children;return g=g.fallback,x?(yo(),x=l.mode,U=Fg({mode:"hidden",children:U},x),g=Nl(g,x,f,null),U.return=l,g.return=l,U.sibling=g,l.child=U,g=l.child,g.memoizedState=vb(f),g.childLanes=yb(s,M,f),l.memoizedState=mb,Cf(null,g)):(vo(l),bb(l,U))}var X=s.memoizedState;if(X!==null&&(U=X.dehydrated,U!==null)){if(S)l.flags&256?(vo(l),l.flags&=-257,l=xb(s,l,f)):l.memoizedState!==null?(yo(),l.child=s.child,l.flags|=128,l=null):(yo(),U=g.fallback,x=l.mode,g=Fg({mode:"visible",children:g.children},x),U=Nl(U,x,f,null),U.flags|=2,g.return=l,U.return=l,g.sibling=U,l.child=g,Ll(l,s.child,null,f),g=l.child,g.memoizedState=vb(f),g.childLanes=yb(s,M,f),l.memoizedState=mb,l=Cf(null,g));else if(vo(l),e1(U)){if(M=U.nextSibling&&U.nextSibling.dataset,M)var le=M.dgst;M=le,g=Error(r(419)),g.stack="",g.digest=M,gf({value:g,source:null,stack:null}),l=xb(s,l,f)}else if(jn||iu(s,l,f,!1),M=(f&s.childLanes)!==0,jn||M){if(M=Kt,M!==null&&(g=nr(M,f),g!==0&&g!==X.retryLane))throw X.retryLane=g,kl(s,g),Jr(M,s,g),pb;Jb(U)||Wg(),l=xb(s,l,f)}else Jb(U)?(l.flags|=192,l.child=s.child,l=null):(s=X.treeContext,en=Pi(U.nextSibling),dr=l,St=!0,uo=null,Ni=!1,s!==null&&rT(l,s),l=bb(l,g.children),l.flags|=4096);return l}return x?(yo(),U=g.fallback,x=l.mode,X=s.child,le=X.sibling,g=fs(X,{mode:"hidden",children:g.children}),g.subtreeFlags=X.subtreeFlags&65011712,le!==null?U=fs(le,U):(U=Nl(U,x,f,null),U.flags|=2),U.return=l,g.return=l,g.sibling=U,l.child=g,Cf(null,g),g=l.child,U=s.child.memoizedState,U===null?U=vb(f):(x=U.cachePool,x!==null?(X=On._currentValue,x=x.parent!==X?{parent:X,pool:X}:x):x=cT(),U={baseLanes:U.baseLanes|f,cachePool:x}),g.memoizedState=U,g.childLanes=yb(s,M,f),l.memoizedState=mb,Cf(s.child,g)):(vo(l),f=s.child,s=f.sibling,f=fs(f,{mode:"visible",children:g.children}),f.return=l,f.sibling=null,s!==null&&(M=l.deletions,M===null?(l.deletions=[s],l.flags|=16):M.push(s)),l.child=f,l.memoizedState=null,f)}function bb(s,l){return l=Fg({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function Fg(s,l){return s=di(22,s,null,l),s.lanes=0,s}function xb(s,l,f){return Ll(l,s.child,null,f),s=bb(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function wA(s,l,f){s.lanes|=l;var g=s.alternate;g!==null&&(g.lanes|=l),Oy(s.return,l,f)}function _b(s,l,f,g,x,S){var M=s.memoizedState;M===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:x,treeForkCount:S}:(M.isBackwards=l,M.rendering=null,M.renderingStartTime=0,M.last=g,M.tail=f,M.tailMode=x,M.treeForkCount=S)}function SA(s,l,f){var g=l.pendingProps,x=g.revealOrder,S=g.tail;g=g.children;var M=In.current,U=(M&2)!==0;if(U?(M=M&1|2,l.flags|=128):M&=1,Y(In,M),hr(s,l,g,f),g=St?pf:0,!U&&s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&wA(s,f,l);else if(s.tag===19)wA(s,f,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(x){case"forwards":for(f=l.child,x=null;f!==null;)s=f.alternate,s!==null&&Dg(s)===null&&(x=f),f=f.sibling;f=x,f===null?(x=l.child,l.child=null):(x=f.sibling,f.sibling=null),_b(l,!1,x,f,S,g);break;case"backwards":case"unstable_legacy-backwards":for(f=null,x=l.child,l.child=null;x!==null;){if(s=x.alternate,s!==null&&Dg(s)===null){l.child=x;break}s=x.sibling,x.sibling=f,f=x,x=s}_b(l,!0,f,null,S,g);break;case"together":_b(l,!1,null,null,void 0,g);break;default:l.memoizedState=null}return l.child}function ys(s,l,f){if(s!==null&&(l.dependencies=s.dependencies),_o|=l.lanes,(f&l.childLanes)===0)if(s!==null){if(iu(s,l,f,!1),(f&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(r(153));if(l.child!==null){for(s=l.child,f=fs(s,s.pendingProps),l.child=f,f.return=l;s.sibling!==null;)s=s.sibling,f=f.sibling=fs(s,s.pendingProps),f.return=l;f.sibling=null}return l.child}function wb(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&_g(s)))}function Kj(s,l,f){switch(l.tag){case 3:we(l,l.stateNode.containerInfo),ho(l,On,s.memoizedState.cache),Ml();break;case 27:case 5:Xe(l);break;case 4:we(l,l.stateNode.containerInfo);break;case 10:ho(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,Yy(l),null;break;case 13:var g=l.memoizedState;if(g!==null)return g.dehydrated!==null?(vo(l),l.flags|=128,null):(f&l.child.childLanes)!==0?_A(s,l,f):(vo(l),s=ys(s,l,f),s!==null?s.sibling:null);vo(l);break;case 19:var x=(s.flags&128)!==0;if(g=(f&l.childLanes)!==0,g||(iu(s,l,f,!1),g=(f&l.childLanes)!==0),x){if(g)return SA(s,l,f);l.flags|=128}if(x=l.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),Y(In,In.current),g)break;return null;case 22:return l.lanes=0,gA(s,l,f,l.pendingProps);case 24:ho(l,On,s.memoizedState.cache)}return ys(s,l,f)}function EA(s,l,f){if(s!==null)if(s.memoizedProps!==l.pendingProps)jn=!0;else{if(!wb(s,f)&&(l.flags&128)===0)return jn=!1,Kj(s,l,f);jn=(s.flags&131072)!==0}else jn=!1,St&&(l.flags&1048576)!==0&&nT(l,pf,l.index);switch(l.lanes=0,l.tag){case 16:e:{var g=l.pendingProps;if(s=jl(l.elementType),l.type=s,typeof s=="function")Cy(s)?(g=Fl(s,g),l.tag=1,l=bA(null,l,s,g,f)):(l.tag=0,l=gb(null,l,s,g,f));else{if(s!=null){var x=s.$$typeof;if(x===O){l.tag=11,l=fA(null,l,s,g,f);break e}else if(x===A){l.tag=14,l=hA(null,l,s,g,f);break e}}throw l=K(s)||s,Error(r(306,l,""))}}return l;case 0:return gb(s,l,l.type,l.pendingProps,f);case 1:return g=l.type,x=Fl(g,l.pendingProps),bA(s,l,g,x,f);case 3:e:{if(we(l,l.stateNode.containerInfo),s===null)throw Error(r(387));g=l.pendingProps;var S=l.memoizedState;x=S.element,Uy(s,l),wf(l,g,null,f);var M=l.memoizedState;if(g=M.cache,ho(l,On,g),g!==S.cache&&Vy(l,[On],f,!0),_f(),g=M.element,S.isDehydrated)if(S={element:g,isDehydrated:!1,cache:M.cache},l.updateQueue.baseState=S,l.memoizedState=S,l.flags&256){l=xA(s,l,g,f);break e}else if(g!==x){x=Di(Error(r(424)),l),gf(x),l=xA(s,l,g,f);break e}else{switch(s=l.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(en=Pi(s.firstChild),dr=l,St=!0,uo=null,Ni=!0,f=gT(l,null,g,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(Ml(),g===x){l=ys(s,l,f);break e}hr(s,l,g,f)}l=l.child}return l;case 26:return Bg(s,l),s===null?(f=OC(l.type,null,l.pendingProps,null))?l.memoizedState=f:St||(f=l.type,s=l.pendingProps,g=rm(de.current).createElement(f),g[dn]=l,g[fn]=s,pr(g,f,s),Mn(g),l.stateNode=g):l.memoizedState=OC(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return Xe(l),s===null&&St&&(g=l.stateNode=NC(l.type,l.pendingProps,de.current),dr=l,Ni=!0,x=en,Ao(l.type)?(t1=x,en=Pi(g.firstChild)):en=x),hr(s,l,l.pendingProps.children,f),Bg(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&St&&((x=g=en)&&(g=E5(g,l.type,l.pendingProps,Ni),g!==null?(l.stateNode=g,dr=l,en=Pi(g.firstChild),Ni=!1,x=!0):x=!1),x||fo(l)),Xe(l),x=l.type,S=l.pendingProps,M=s!==null?s.memoizedProps:null,g=S.children,Wb(x,S)?g=null:M!==null&&Wb(x,M)&&(l.flags|=32),l.memoizedState!==null&&(x=Xy(s,l,Lj,null,null,f),Uf._currentValue=x),Bg(s,l),hr(s,l,g,f),l.child;case 6:return s===null&&St&&((s=f=en)&&(f=T5(f,l.pendingProps,Ni),f!==null?(l.stateNode=f,dr=l,en=null,s=!0):s=!1),s||fo(l)),null;case 13:return _A(s,l,f);case 4:return we(l,l.stateNode.containerInfo),g=l.pendingProps,s===null?l.child=Ll(l,null,g,f):hr(s,l,g,f),l.child;case 11:return fA(s,l,l.type,l.pendingProps,f);case 7:return hr(s,l,l.pendingProps,f),l.child;case 8:return hr(s,l,l.pendingProps.children,f),l.child;case 12:return hr(s,l,l.pendingProps.children,f),l.child;case 10:return g=l.pendingProps,ho(l,l.type,g.value),hr(s,l,g.children,f),l.child;case 9:return x=l.type._context,g=l.pendingProps.children,Ol(l),x=fr(x),g=g(x),l.flags|=1,hr(s,l,g,f),l.child;case 14:return hA(s,l,l.type,l.pendingProps,f);case 15:return pA(s,l,l.type,l.pendingProps,f);case 19:return SA(s,l,f);case 31:return Yj(s,l,f);case 22:return gA(s,l,f,l.pendingProps);case 24:return Ol(l),g=fr(On),s===null?(x=Ly(),x===null&&(x=Kt,S=jy(),x.pooledCache=S,S.refCount++,S!==null&&(x.pooledCacheLanes|=f),x=S),l.memoizedState={parent:g,cache:x},Fy(l),ho(l,On,x)):((s.lanes&f)!==0&&(Uy(s,l),wf(l,null,null,f),_f()),x=s.memoizedState,S=l.memoizedState,x.parent!==g?(x={parent:g,cache:g},l.memoizedState=x,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=x),ho(l,On,g)):(g=S.cache,ho(l,On,g),g!==x.cache&&Vy(l,[On],f,!0))),hr(s,l,l.pendingProps.children,f),l.child;case 29:throw l.pendingProps}throw Error(r(156,l.tag))}function bs(s){s.flags|=4}function Sb(s,l,f,g,x){if((l=(s.mode&32)!==0)&&(l=!1),l){if(s.flags|=16777216,(x&335544128)===x)if(s.stateNode.complete)s.flags|=8192;else if(QA())s.flags|=8192;else throw zl=Tg,By}else s.flags&=-16777217}function TA(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!BC(l))if(QA())s.flags|=8192;else throw zl=Tg,By}function Ug(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?qr():536870912,s.lanes|=l,mu|=l)}function If(s,l){if(!St)switch(s.tailMode){case"hidden":l=s.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s.tail=null:f.sibling=null;break;case"collapsed":f=s.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:g.sibling=null}}function tn(s){var l=s.alternate!==null&&s.alternate.child===s.child,f=0,g=0;if(l)for(var x=s.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags&65011712,g|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags,g|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=g,s.childLanes=f,l}function Xj(s,l,f){var g=l.pendingProps;switch(ky(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tn(l),null;case 1:return tn(l),null;case 3:return f=l.stateNode,g=null,s!==null&&(g=s.memoizedState.cache),l.memoizedState.cache!==g&&(l.flags|=2048),gs(On),Te(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(ru(l)?bs(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,My())),tn(l),null;case 26:var x=l.type,S=l.memoizedState;return s===null?(bs(l),S!==null?(tn(l),TA(l,S)):(tn(l),Sb(l,x,null,g,f))):S?S!==s.memoizedState?(bs(l),tn(l),TA(l,S)):(tn(l),l.flags&=-16777217):(s=s.memoizedProps,s!==g&&bs(l),tn(l),Sb(l,x,s,g,f)),null;case 27:if(Se(l),f=de.current,x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==g&&bs(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return tn(l),null}s=ne.current,ru(l)?iT(l):(s=NC(x,g,f),l.stateNode=s,bs(l))}return tn(l),null;case 5:if(Se(l),x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==g&&bs(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return tn(l),null}if(S=ne.current,ru(l))iT(l);else{var M=rm(de.current);switch(S){case 1:S=M.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:S=M.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":S=M.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":S=M.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":S=M.createElement("div"),S.innerHTML="<script><\/script>",S=S.removeChild(S.firstChild);break;case"select":S=typeof g.is=="string"?M.createElement("select",{is:g.is}):M.createElement("select"),g.multiple?S.multiple=!0:g.size&&(S.size=g.size);break;default:S=typeof g.is=="string"?M.createElement(x,{is:g.is}):M.createElement(x)}}S[dn]=l,S[fn]=g;e:for(M=l.child;M!==null;){if(M.tag===5||M.tag===6)S.appendChild(M.stateNode);else if(M.tag!==4&&M.tag!==27&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===l)break e;for(;M.sibling===null;){if(M.return===null||M.return===l)break e;M=M.return}M.sibling.return=M.return,M=M.sibling}l.stateNode=S;e:switch(pr(S,x,g),x){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&bs(l)}}return tn(l),Sb(l,l.type,s===null?null:s.memoizedProps,l.pendingProps,f),null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==g&&bs(l);else{if(typeof g!="string"&&l.stateNode===null)throw Error(r(166));if(s=de.current,ru(l)){if(s=l.stateNode,f=l.memoizedProps,g=null,x=dr,x!==null)switch(x.tag){case 27:case 5:g=x.memoizedProps}s[dn]=l,s=!!(s.nodeValue===f||g!==null&&g.suppressHydrationWarning===!0||_C(s.nodeValue,f)),s||fo(l,!0)}else s=rm(s).createTextNode(g),s[dn]=l,l.stateNode=s}return tn(l),null;case 31:if(f=l.memoizedState,s===null||s.memoizedState!==null){if(g=ru(l),f!==null){if(s===null){if(!g)throw Error(r(318));if(s=l.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(557));s[dn]=l}else Ml(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;tn(l),s=!1}else f=My(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),s=!0;if(!s)return l.flags&256?(hi(l),l):(hi(l),null);if((l.flags&128)!==0)throw Error(r(558))}return tn(l),null;case 13:if(g=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=ru(l),g!==null&&g.dehydrated!==null){if(s===null){if(!x)throw Error(r(318));if(x=l.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[dn]=l}else Ml(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;tn(l),x=!1}else x=My(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return l.flags&256?(hi(l),l):(hi(l),null)}return hi(l),(l.flags&128)!==0?(l.lanes=f,l):(f=g!==null,s=s!==null&&s.memoizedState!==null,f&&(g=l.child,x=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(x=g.alternate.memoizedState.cachePool.pool),S=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(S=g.memoizedState.cachePool.pool),S!==x&&(g.flags|=2048)),f!==s&&f&&(l.child.flags|=8192),Ug(l,l.updateQueue),tn(l),null);case 4:return Te(),s===null&&Hb(l.stateNode.containerInfo),tn(l),null;case 10:return gs(l.type),tn(l),null;case 19:if(Q(In),g=l.memoizedState,g===null)return tn(l),null;if(x=(l.flags&128)!==0,S=g.rendering,S===null)if(x)If(g,!1);else{if(_n!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(S=Dg(s),S!==null){for(l.flags|=128,If(g,!1),s=S.updateQueue,l.updateQueue=s,Ug(l,s),l.subtreeFlags=0,s=f,f=l.child;f!==null;)JE(f,s),f=f.sibling;return Y(In,In.current&1|2),St&&hs(l,g.treeForkCount),l.child}s=s.sibling}g.tail!==null&&ht()>Yg&&(l.flags|=128,x=!0,If(g,!1),l.lanes=4194304)}else{if(!x)if(s=Dg(S),s!==null){if(l.flags|=128,x=!0,s=s.updateQueue,l.updateQueue=s,Ug(l,s),If(g,!0),g.tail===null&&g.tailMode==="hidden"&&!S.alternate&&!St)return tn(l),null}else 2*ht()-g.renderingStartTime>Yg&&f!==536870912&&(l.flags|=128,x=!0,If(g,!1),l.lanes=4194304);g.isBackwards?(S.sibling=l.child,l.child=S):(s=g.last,s!==null?s.sibling=S:l.child=S,g.last=S)}return g.tail!==null?(s=g.tail,g.rendering=s,g.tail=s.sibling,g.renderingStartTime=ht(),s.sibling=null,f=In.current,Y(In,x?f&1|2:f&1),St&&hs(l,g.treeForkCount),s):(tn(l),null);case 22:case 23:return hi(l),$y(),g=l.memoizedState!==null,s!==null?s.memoizedState!==null!==g&&(l.flags|=8192):g&&(l.flags|=8192),g?(f&536870912)!==0&&(l.flags&128)===0&&(tn(l),l.subtreeFlags&6&&(l.flags|=8192)):tn(l),f=l.updateQueue,f!==null&&Ug(l,f.retryQueue),f=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),g=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),g!==f&&(l.flags|=2048),s!==null&&Q(Vl),null;case 24:return f=null,s!==null&&(f=s.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),gs(On),tn(l),null;case 25:return null;case 30:return null}throw Error(r(156,l.tag))}function Wj(s,l){switch(ky(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return gs(On),Te(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return Se(l),null;case 31:if(l.memoizedState!==null){if(hi(l),l.alternate===null)throw Error(r(340));Ml()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 13:if(hi(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(r(340));Ml()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return Q(In),null;case 4:return Te(),null;case 10:return gs(l.type),null;case 22:case 23:return hi(l),$y(),s!==null&&Q(Vl),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return gs(On),null;case 25:return null;default:return null}}function AA(s,l){switch(ky(l),l.tag){case 3:gs(On),Te();break;case 26:case 27:case 5:Se(l);break;case 4:Te();break;case 31:l.memoizedState!==null&&hi(l);break;case 13:hi(l);break;case 19:Q(In);break;case 10:gs(l.type);break;case 22:case 23:hi(l),$y(),s!==null&&Q(Vl);break;case 24:gs(On)}}function Df(s,l){try{var f=l.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var x=g.next;f=x;do{if((f.tag&s)===s){g=void 0;var S=f.create,M=f.inst;g=S(),M.destroy=g}f=f.next}while(f!==x)}}catch(U){zt(l,l.return,U)}}function bo(s,l,f){try{var g=l.updateQueue,x=g!==null?g.lastEffect:null;if(x!==null){var S=x.next;g=S;do{if((g.tag&s)===s){var M=g.inst,U=M.destroy;if(U!==void 0){M.destroy=void 0,x=l;var X=f,le=U;try{le()}catch(ve){zt(x,X,ve)}}}g=g.next}while(g!==S)}}catch(ve){zt(l,l.return,ve)}}function CA(s){var l=s.updateQueue;if(l!==null){var f=s.stateNode;try{vT(l,f)}catch(g){zt(s,s.return,g)}}}function IA(s,l,f){f.props=Fl(s.type,s.memoizedProps),f.state=s.memoizedState;try{f.componentWillUnmount()}catch(g){zt(s,l,g)}}function Rf(s,l){try{var f=s.ref;if(f!==null){switch(s.tag){case 26:case 27:case 5:var g=s.stateNode;break;case 30:g=s.stateNode;break;default:g=s.stateNode}typeof f=="function"?s.refCleanup=f(g):f.current=g}}catch(x){zt(s,l,x)}}function Va(s,l){var f=s.ref,g=s.refCleanup;if(f!==null)if(typeof g=="function")try{g()}catch(x){zt(s,l,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(x){zt(s,l,x)}else f.current=null}function DA(s){var l=s.type,f=s.memoizedProps,g=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":f.autoFocus&&g.focus();break e;case"img":f.src?g.src=f.src:f.srcSet&&(g.srcset=f.srcSet)}}catch(x){zt(s,s.return,x)}}function Eb(s,l,f){try{var g=s.stateNode;y5(g,s.type,f,l),g[fn]=l}catch(x){zt(s,s.return,x)}}function RA(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Ao(s.type)||s.tag===4}function Tb(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||RA(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Ao(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Ab(s,l,f){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(s,l):(l=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,l.appendChild(s),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=Ji));else if(g!==4&&(g===27&&Ao(s.type)&&(f=s.stateNode,l=null),s=s.child,s!==null))for(Ab(s,l,f),s=s.sibling;s!==null;)Ab(s,l,f),s=s.sibling}function Gg(s,l,f){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?f.insertBefore(s,l):f.appendChild(s);else if(g!==4&&(g===27&&Ao(s.type)&&(f=s.stateNode),s=s.child,s!==null))for(Gg(s,l,f),s=s.sibling;s!==null;)Gg(s,l,f),s=s.sibling}function kA(s){var l=s.stateNode,f=s.memoizedProps;try{for(var g=s.type,x=l.attributes;x.length;)l.removeAttributeNode(x[0]);pr(l,g,f),l[dn]=s,l[fn]=f}catch(S){zt(s,s.return,S)}}var xs=!1,zn=!1,Cb=!1,NA=typeof WeakSet=="function"?WeakSet:Set,ar=null;function Qj(s,l){if(s=s.containerInfo,Kb=um,s=qE(s),xy(s)){if("selectionStart"in s)var f={start:s.selectionStart,end:s.selectionEnd};else e:{f=(f=s.ownerDocument)&&f.defaultView||window;var g=f.getSelection&&f.getSelection();if(g&&g.rangeCount!==0){f=g.anchorNode;var x=g.anchorOffset,S=g.focusNode;g=g.focusOffset;try{f.nodeType,S.nodeType}catch{f=null;break e}var M=0,U=-1,X=-1,le=0,ve=0,be=s,ce=null;t:for(;;){for(var he;be!==f||x!==0&&be.nodeType!==3||(U=M+x),be!==S||g!==0&&be.nodeType!==3||(X=M+g),be.nodeType===3&&(M+=be.nodeValue.length),(he=be.firstChild)!==null;)ce=be,be=he;for(;;){if(be===s)break t;if(ce===f&&++le===x&&(U=M),ce===S&&++ve===g&&(X=M),(he=be.nextSibling)!==null)break;be=ce,ce=be.parentNode}be=he}f=U===-1||X===-1?null:{start:U,end:X}}else f=null}f=f||{start:0,end:0}}else f=null;for(Xb={focusedElem:s,selectionRange:f},um=!1,ar=l;ar!==null;)if(l=ar,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,ar=s;else for(;ar!==null;){switch(l=ar,S=l.alternate,s=l.flags,l.tag){case 0:if((s&4)!==0&&(s=l.updateQueue,s=s!==null?s.events:null,s!==null))for(f=0;f<s.length;f++)x=s[f],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&S!==null){s=void 0,f=l,x=S.memoizedProps,S=S.memoizedState,g=f.stateNode;try{var Oe=Fl(f.type,x);s=g.getSnapshotBeforeUpdate(Oe,S),g.__reactInternalSnapshotBeforeUpdate=s}catch(Ye){zt(f,f.return,Ye)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,f=s.nodeType,f===9)Zb(s);else if(f===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Zb(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=l.sibling,s!==null){s.return=l.return,ar=s;break}ar=l.return}}function MA(s,l,f){var g=f.flags;switch(f.tag){case 0:case 11:case 15:ws(s,f),g&4&&Df(5,f);break;case 1:if(ws(s,f),g&4)if(s=f.stateNode,l===null)try{s.componentDidMount()}catch(M){zt(f,f.return,M)}else{var x=Fl(f.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(x,l,s.__reactInternalSnapshotBeforeUpdate)}catch(M){zt(f,f.return,M)}}g&64&&CA(f),g&512&&Rf(f,f.return);break;case 3:if(ws(s,f),g&64&&(s=f.updateQueue,s!==null)){if(l=null,f.child!==null)switch(f.child.tag){case 27:case 5:l=f.child.stateNode;break;case 1:l=f.child.stateNode}try{vT(s,l)}catch(M){zt(f,f.return,M)}}break;case 27:l===null&&g&4&&kA(f);case 26:case 5:ws(s,f),l===null&&g&4&&DA(f),g&512&&Rf(f,f.return);break;case 12:ws(s,f);break;case 31:ws(s,f),g&4&&VA(s,f);break;case 13:ws(s,f),g&4&&jA(s,f),g&64&&(s=f.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(f=s5.bind(null,f),A5(s,f))));break;case 22:if(g=f.memoizedState!==null||xs,!g){l=l!==null&&l.memoizedState!==null||zn,x=xs;var S=zn;xs=g,(zn=l)&&!S?Ss(s,f,(f.subtreeFlags&8772)!==0):ws(s,f),xs=x,zn=S}break;case 30:break;default:ws(s,f)}}function PA(s){var l=s.alternate;l!==null&&(s.alternate=null,PA(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&Bc(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var on=null,Xr=!1;function _s(s,l,f){for(f=f.child;f!==null;)OA(s,l,f),f=f.sibling}function OA(s,l,f){if(bn&&typeof bn.onCommitFiberUnmount=="function")try{bn.onCommitFiberUnmount(Nr,f)}catch{}switch(f.tag){case 26:zn||Va(f,l),_s(s,l,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:zn||Va(f,l);var g=on,x=Xr;Ao(f.type)&&(on=f.stateNode,Xr=!1),_s(s,l,f),Lf(f.stateNode),on=g,Xr=x;break;case 5:zn||Va(f,l);case 6:if(g=on,x=Xr,on=null,_s(s,l,f),on=g,Xr=x,on!==null)if(Xr)try{(on.nodeType===9?on.body:on.nodeName==="HTML"?on.ownerDocument.body:on).removeChild(f.stateNode)}catch(S){zt(f,l,S)}else try{on.removeChild(f.stateNode)}catch(S){zt(f,l,S)}break;case 18:on!==null&&(Xr?(s=on,CC(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,f.stateNode),Eu(s)):CC(on,f.stateNode));break;case 4:g=on,x=Xr,on=f.stateNode.containerInfo,Xr=!0,_s(s,l,f),on=g,Xr=x;break;case 0:case 11:case 14:case 15:bo(2,f,l),zn||bo(4,f,l),_s(s,l,f);break;case 1:zn||(Va(f,l),g=f.stateNode,typeof g.componentWillUnmount=="function"&&IA(f,l,g)),_s(s,l,f);break;case 21:_s(s,l,f);break;case 22:zn=(g=zn)||f.memoizedState!==null,_s(s,l,f),zn=g;break;default:_s(s,l,f)}}function VA(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Eu(s)}catch(f){zt(l,l.return,f)}}}function jA(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Eu(s)}catch(f){zt(l,l.return,f)}}function Zj(s){switch(s.tag){case 31:case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new NA),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new NA),l;default:throw Error(r(435,s.tag))}}function qg(s,l){var f=Zj(s);l.forEach(function(g){if(!f.has(g)){f.add(g);var x=o5.bind(null,s,g);g.then(x,x)}})}function Wr(s,l){var f=l.deletions;if(f!==null)for(var g=0;g<f.length;g++){var x=f[g],S=s,M=l,U=M;e:for(;U!==null;){switch(U.tag){case 27:if(Ao(U.type)){on=U.stateNode,Xr=!1;break e}break;case 5:on=U.stateNode,Xr=!1;break e;case 3:case 4:on=U.stateNode.containerInfo,Xr=!0;break e}U=U.return}if(on===null)throw Error(r(160));OA(S,M,x),on=null,Xr=!1,S=x.alternate,S!==null&&(S.return=null),x.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)zA(l,s),l=l.sibling}var aa=null;function zA(s,l){var f=s.alternate,g=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Wr(l,s),Qr(s),g&4&&(bo(3,s,s.return),Df(3,s),bo(5,s,s.return));break;case 1:Wr(l,s),Qr(s),g&512&&(zn||f===null||Va(f,f.return)),g&64&&xs&&(s=s.updateQueue,s!==null&&(g=s.callbacks,g!==null&&(f=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=f===null?g:f.concat(g))));break;case 26:var x=aa;if(Wr(l,s),Qr(s),g&512&&(zn||f===null||Va(f,f.return)),g&4){var S=f!==null?f.memoizedState:null;if(g=s.memoizedState,f===null)if(g===null)if(s.stateNode===null){e:{g=s.type,f=s.memoizedProps,x=x.ownerDocument||x;t:switch(g){case"title":S=x.getElementsByTagName("title")[0],(!S||S[wa]||S[dn]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=x.createElement(g),x.head.insertBefore(S,x.querySelector("head > title"))),pr(S,g,f),S[dn]=s,Mn(S),g=S;break e;case"link":var M=zC("link","href",x).get(g+(f.href||""));if(M){for(var U=0;U<M.length;U++)if(S=M[U],S.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&S.getAttribute("rel")===(f.rel==null?null:f.rel)&&S.getAttribute("title")===(f.title==null?null:f.title)&&S.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){M.splice(U,1);break t}}S=x.createElement(g),pr(S,g,f),x.head.appendChild(S);break;case"meta":if(M=zC("meta","content",x).get(g+(f.content||""))){for(U=0;U<M.length;U++)if(S=M[U],S.getAttribute("content")===(f.content==null?null:""+f.content)&&S.getAttribute("name")===(f.name==null?null:f.name)&&S.getAttribute("property")===(f.property==null?null:f.property)&&S.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&S.getAttribute("charset")===(f.charSet==null?null:f.charSet)){M.splice(U,1);break t}}S=x.createElement(g),pr(S,g,f),x.head.appendChild(S);break;default:throw Error(r(468,g))}S[dn]=s,Mn(S),g=S}s.stateNode=g}else LC(x,s.type,s.stateNode);else s.stateNode=jC(x,g,s.memoizedProps);else S!==g?(S===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):S.count--,g===null?LC(x,s.type,s.stateNode):jC(x,g,s.memoizedProps)):g===null&&s.stateNode!==null&&Eb(s,s.memoizedProps,f.memoizedProps)}break;case 27:Wr(l,s),Qr(s),g&512&&(zn||f===null||Va(f,f.return)),f!==null&&g&4&&Eb(s,s.memoizedProps,f.memoizedProps);break;case 5:if(Wr(l,s),Qr(s),g&512&&(zn||f===null||Va(f,f.return)),s.flags&32){x=s.stateNode;try{Kr(x,"")}catch(Oe){zt(s,s.return,Oe)}}g&4&&s.stateNode!=null&&(x=s.memoizedProps,Eb(s,x,f!==null?f.memoizedProps:x)),g&1024&&(Cb=!0);break;case 6:if(Wr(l,s),Qr(s),g&4){if(s.stateNode===null)throw Error(r(162));g=s.memoizedProps,f=s.stateNode;try{f.nodeValue=g}catch(Oe){zt(s,s.return,Oe)}}break;case 3:if(sm=null,x=aa,aa=im(l.containerInfo),Wr(l,s),aa=x,Qr(s),g&4&&f!==null&&f.memoizedState.isDehydrated)try{Eu(l.containerInfo)}catch(Oe){zt(s,s.return,Oe)}Cb&&(Cb=!1,LA(s));break;case 4:g=aa,aa=im(s.stateNode.containerInfo),Wr(l,s),Qr(s),aa=g;break;case 12:Wr(l,s),Qr(s);break;case 31:Wr(l,s),Qr(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,qg(s,g)));break;case 13:Wr(l,s),Qr(s),s.child.flags&8192&&s.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&($g=ht()),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,qg(s,g)));break;case 22:x=s.memoizedState!==null;var X=f!==null&&f.memoizedState!==null,le=xs,ve=zn;if(xs=le||x,zn=ve||X,Wr(l,s),zn=ve,xs=le,Qr(s),g&8192)e:for(l=s.stateNode,l._visibility=x?l._visibility&-2:l._visibility|1,x&&(f===null||X||xs||zn||Ul(s)),f=null,l=s;;){if(l.tag===5||l.tag===26){if(f===null){X=f=l;try{if(S=X.stateNode,x)M=S.style,typeof M.setProperty=="function"?M.setProperty("display","none","important"):M.display="none";else{U=X.stateNode;var be=X.memoizedProps.style,ce=be!=null&&be.hasOwnProperty("display")?be.display:null;U.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(Oe){zt(X,X.return,Oe)}}}else if(l.tag===6){if(f===null){X=l;try{X.stateNode.nodeValue=x?"":X.memoizedProps}catch(Oe){zt(X,X.return,Oe)}}}else if(l.tag===18){if(f===null){X=l;try{var he=X.stateNode;x?IC(he,!0):IC(X.stateNode,!1)}catch(Oe){zt(X,X.return,Oe)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;f===l&&(f=null),l=l.return}f===l&&(f=null),l.sibling.return=l.return,l=l.sibling}g&4&&(g=s.updateQueue,g!==null&&(f=g.retryQueue,f!==null&&(g.retryQueue=null,qg(s,f))));break;case 19:Wr(l,s),Qr(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,qg(s,g)));break;case 30:break;case 21:break;default:Wr(l,s),Qr(s)}}function Qr(s){var l=s.flags;if(l&2){try{for(var f,g=s.return;g!==null;){if(RA(g)){f=g;break}g=g.return}if(f==null)throw Error(r(160));switch(f.tag){case 27:var x=f.stateNode,S=Tb(s);Gg(s,S,x);break;case 5:var M=f.stateNode;f.flags&32&&(Kr(M,""),f.flags&=-33);var U=Tb(s);Gg(s,U,M);break;case 3:case 4:var X=f.stateNode.containerInfo,le=Tb(s);Ab(s,le,X);break;default:throw Error(r(161))}}catch(ve){zt(s,s.return,ve)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function LA(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;LA(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function ws(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)MA(s,l.alternate,l),l=l.sibling}function Ul(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:bo(4,l,l.return),Ul(l);break;case 1:Va(l,l.return);var f=l.stateNode;typeof f.componentWillUnmount=="function"&&IA(l,l.return,f),Ul(l);break;case 27:Lf(l.stateNode);case 26:case 5:Va(l,l.return),Ul(l);break;case 22:l.memoizedState===null&&Ul(l);break;case 30:Ul(l);break;default:Ul(l)}s=s.sibling}}function Ss(s,l,f){for(f=f&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var g=l.alternate,x=s,S=l,M=S.flags;switch(S.tag){case 0:case 11:case 15:Ss(x,S,f),Df(4,S);break;case 1:if(Ss(x,S,f),g=S,x=g.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(le){zt(g,g.return,le)}if(g=S,x=g.updateQueue,x!==null){var U=g.stateNode;try{var X=x.shared.hiddenCallbacks;if(X!==null)for(x.shared.hiddenCallbacks=null,x=0;x<X.length;x++)mT(X[x],U)}catch(le){zt(g,g.return,le)}}f&&M&64&&CA(S),Rf(S,S.return);break;case 27:kA(S);case 26:case 5:Ss(x,S,f),f&&g===null&&M&4&&DA(S),Rf(S,S.return);break;case 12:Ss(x,S,f);break;case 31:Ss(x,S,f),f&&M&4&&VA(x,S);break;case 13:Ss(x,S,f),f&&M&4&&jA(x,S);break;case 22:S.memoizedState===null&&Ss(x,S,f),Rf(S,S.return);break;case 30:break;default:Ss(x,S,f)}l=l.sibling}}function Ib(s,l){var f=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==f&&(s!=null&&s.refCount++,f!=null&&mf(f))}function Db(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&mf(s))}function sa(s,l,f,g){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)BA(s,l,f,g),l=l.sibling}function BA(s,l,f,g){var x=l.flags;switch(l.tag){case 0:case 11:case 15:sa(s,l,f,g),x&2048&&Df(9,l);break;case 1:sa(s,l,f,g);break;case 3:sa(s,l,f,g),x&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&mf(s)));break;case 12:if(x&2048){sa(s,l,f,g),s=l.stateNode;try{var S=l.memoizedProps,M=S.id,U=S.onPostCommit;typeof U=="function"&&U(M,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(X){zt(l,l.return,X)}}else sa(s,l,f,g);break;case 31:sa(s,l,f,g);break;case 13:sa(s,l,f,g);break;case 23:break;case 22:S=l.stateNode,M=l.alternate,l.memoizedState!==null?S._visibility&2?sa(s,l,f,g):kf(s,l):S._visibility&2?sa(s,l,f,g):(S._visibility|=2,hu(s,l,f,g,(l.subtreeFlags&10256)!==0||!1)),x&2048&&Ib(M,l);break;case 24:sa(s,l,f,g),x&2048&&Db(l.alternate,l);break;default:sa(s,l,f,g)}}function hu(s,l,f,g,x){for(x=x&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var S=s,M=l,U=f,X=g,le=M.flags;switch(M.tag){case 0:case 11:case 15:hu(S,M,U,X,x),Df(8,M);break;case 23:break;case 22:var ve=M.stateNode;M.memoizedState!==null?ve._visibility&2?hu(S,M,U,X,x):kf(S,M):(ve._visibility|=2,hu(S,M,U,X,x)),x&&le&2048&&Ib(M.alternate,M);break;case 24:hu(S,M,U,X,x),x&&le&2048&&Db(M.alternate,M);break;default:hu(S,M,U,X,x)}l=l.sibling}}function kf(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var f=s,g=l,x=g.flags;switch(g.tag){case 22:kf(f,g),x&2048&&Ib(g.alternate,g);break;case 24:kf(f,g),x&2048&&Db(g.alternate,g);break;default:kf(f,g)}l=l.sibling}}var Nf=8192;function pu(s,l,f){if(s.subtreeFlags&Nf)for(s=s.child;s!==null;)FA(s,l,f),s=s.sibling}function FA(s,l,f){switch(s.tag){case 26:pu(s,l,f),s.flags&Nf&&s.memoizedState!==null&&z5(f,aa,s.memoizedState,s.memoizedProps);break;case 5:pu(s,l,f);break;case 3:case 4:var g=aa;aa=im(s.stateNode.containerInfo),pu(s,l,f),aa=g;break;case 22:s.memoizedState===null&&(g=s.alternate,g!==null&&g.memoizedState!==null?(g=Nf,Nf=16777216,pu(s,l,f),Nf=g):pu(s,l,f));break;default:pu(s,l,f)}}function UA(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function Mf(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];ar=g,qA(g,s)}UA(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)GA(s),s=s.sibling}function GA(s){switch(s.tag){case 0:case 11:case 15:Mf(s),s.flags&2048&&bo(9,s,s.return);break;case 3:Mf(s);break;case 12:Mf(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,Hg(s)):Mf(s);break;default:Mf(s)}}function Hg(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];ar=g,qA(g,s)}UA(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:bo(8,l,l.return),Hg(l);break;case 22:f=l.stateNode,f._visibility&2&&(f._visibility&=-3,Hg(l));break;default:Hg(l)}s=s.sibling}}function qA(s,l){for(;ar!==null;){var f=ar;switch(f.tag){case 0:case 11:case 15:bo(8,f,l);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var g=f.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:mf(f.memoizedState.cache)}if(g=f.child,g!==null)g.return=f,ar=g;else e:for(f=s;ar!==null;){g=ar;var x=g.sibling,S=g.return;if(PA(g),g===f){ar=null;break e}if(x!==null){x.return=S,ar=x;break e}ar=S}}}var Jj={getCacheForType:function(s){var l=fr(On),f=l.data.get(s);return f===void 0&&(f=s(),l.data.set(s,f)),f},cacheSignal:function(){return fr(On).controller.signal}},e5=typeof WeakMap=="function"?WeakMap:Map,Rt=0,Kt=null,gt=null,vt=0,jt=0,pi=null,xo=!1,gu=!1,Rb=!1,Es=0,_n=0,_o=0,Gl=0,kb=0,gi=0,mu=0,Pf=null,Zr=null,Nb=!1,$g=0,HA=0,Yg=1/0,Kg=null,wo=null,Kn=0,So=null,vu=null,Ts=0,Mb=0,Pb=null,$A=null,Of=0,Ob=null;function mi(){return(Rt&2)!==0&&vt!==0?vt&-vt:$.T!==null?Fb():Nn()}function YA(){if(gi===0)if((vt&536870912)===0||St){var s=Zt;Zt<<=1,(Zt&3932160)===0&&(Zt=262144),gi=s}else gi=536870912;return s=fi.current,s!==null&&(s.flags|=32),gi}function Jr(s,l,f){(s===Kt&&(jt===2||jt===9)||s.cancelPendingCommit!==null)&&(yu(s,0),Eo(s,vt,gi,!1)),wr(s,f),((Rt&2)===0||s!==Kt)&&(s===Kt&&((Rt&2)===0&&(Gl|=f),_n===4&&Eo(s,vt,gi,!1)),ja(s))}function KA(s,l,f){if((Rt&6)!==0)throw Error(r(327));var g=!f&&(l&127)===0&&(l&s.expiredLanes)===0||wt(s,l),x=g?r5(s,l):jb(s,l,!0),S=g;do{if(x===0){gu&&!g&&Eo(s,l,0,!1);break}else{if(f=s.current.alternate,S&&!t5(f)){x=jb(s,l,!1),S=!1;continue}if(x===2){if(S=l,s.errorRecoveryDisabledLanes&S)var M=0;else M=s.pendingLanes&-536870913,M=M!==0?M:M&536870912?536870912:0;if(M!==0){l=M;e:{var U=s;x=Pf;var X=U.current.memoizedState.isDehydrated;if(X&&(yu(U,M).flags|=256),M=jb(U,M,!1),M!==2){if(Rb&&!X){U.errorRecoveryDisabledLanes|=S,Gl|=S,x=4;break e}S=Zr,Zr=x,S!==null&&(Zr===null?Zr=S:Zr.push.apply(Zr,S))}x=M}if(S=!1,x!==2)continue}}if(x===1){yu(s,0),Eo(s,l,0,!0);break}e:{switch(g=s,S=x,S){case 0:case 1:throw Error(r(345));case 4:if((l&4194048)!==l)break;case 6:Eo(g,l,gi,!xo);break e;case 2:Zr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((l&62914560)===l&&(x=$g+300-ht(),10<x)){if(Eo(g,l,gi,!xo),je(g,0,!0)!==0)break e;Ts=l,g.timeoutHandle=TC(XA.bind(null,g,f,Zr,Kg,Nb,l,gi,Gl,mu,xo,S,"Throttled",-0,0),x);break e}XA(g,f,Zr,Kg,Nb,l,gi,Gl,mu,xo,S,null,-0,0)}}break}while(!0);ja(s)}function XA(s,l,f,g,x,S,M,U,X,le,ve,be,ce,he){if(s.timeoutHandle=-1,be=l.subtreeFlags,be&8192||(be&16785408)===16785408){be={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ji},FA(l,S,be);var Oe=(S&62914560)===S?$g-ht():(S&4194048)===S?HA-ht():0;if(Oe=L5(be,Oe),Oe!==null){Ts=S,s.cancelPendingCommit=Oe(rC.bind(null,s,l,S,f,g,x,M,U,X,ve,be,null,ce,he)),Eo(s,S,M,!le);return}}rC(s,l,S,f,g,x,M,U,X)}function t5(s){for(var l=s;;){var f=l.tag;if((f===0||f===11||f===15)&&l.flags&16384&&(f=l.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var g=0;g<f.length;g++){var x=f[g],S=x.getSnapshot;x=x.value;try{if(!ui(S(),x))return!1}catch{return!1}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Eo(s,l,f,g){l&=~kb,l&=~Gl,s.suspendedLanes|=l,s.pingedLanes&=~l,g&&(s.warmLanes|=l),g=s.expirationTimes;for(var x=l;0<x;){var S=31-Qt(x),M=1<<S;g[S]=-1,x&=~M}f!==0&&Ot(s,f,l)}function Xg(){return(Rt&6)===0?(Vf(0),!1):!0}function Vb(){if(gt!==null){if(jt===0)var s=gt.return;else s=gt,ps=Pl=null,Zy(s),lu=null,yf=0,s=gt;for(;s!==null;)AA(s.alternate,s),s=s.return;gt=null}}function yu(s,l){var f=s.timeoutHandle;f!==-1&&(s.timeoutHandle=-1,_5(f)),f=s.cancelPendingCommit,f!==null&&(s.cancelPendingCommit=null,f()),Ts=0,Vb(),Kt=s,gt=f=fs(s.current,null),vt=l,jt=0,pi=null,xo=!1,gu=wt(s,l),Rb=!1,mu=gi=kb=Gl=_o=_n=0,Zr=Pf=null,Nb=!1,(l&8)!==0&&(l|=l&32);var g=s.entangledLanes;if(g!==0)for(s=s.entanglements,g&=l;0<g;){var x=31-Qt(g),S=1<<x;l|=s[x],g&=~S}return Es=l,mg(),f}function WA(s,l){ot=null,$.H=Af,l===ou||l===Eg?(l=fT(),jt=3):l===By?(l=fT(),jt=4):jt=l===pb?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,pi=l,gt===null&&(_n=1,zg(s,Di(l,s.current)))}function QA(){var s=fi.current;return s===null?!0:(vt&4194048)===vt?Mi===null:(vt&62914560)===vt||(vt&536870912)!==0?s===Mi:!1}function ZA(){var s=$.H;return $.H=Af,s===null?Af:s}function JA(){var s=$.A;return $.A=Jj,s}function Wg(){_n=4,xo||(vt&4194048)!==vt&&fi.current!==null||(gu=!0),(_o&134217727)===0&&(Gl&134217727)===0||Kt===null||Eo(Kt,vt,gi,!1)}function jb(s,l,f){var g=Rt;Rt|=2;var x=ZA(),S=JA();(Kt!==s||vt!==l)&&(Kg=null,yu(s,l)),l=!1;var M=_n;e:do try{if(jt!==0&&gt!==null){var U=gt,X=pi;switch(jt){case 8:Vb(),M=6;break e;case 3:case 2:case 9:case 6:fi.current===null&&(l=!0);var le=jt;if(jt=0,pi=null,bu(s,U,X,le),f&&gu){M=0;break e}break;default:le=jt,jt=0,pi=null,bu(s,U,X,le)}}n5(),M=_n;break}catch(ve){WA(s,ve)}while(!0);return l&&s.shellSuspendCounter++,ps=Pl=null,Rt=g,$.H=x,$.A=S,gt===null&&(Kt=null,vt=0,mg()),M}function n5(){for(;gt!==null;)eC(gt)}function r5(s,l){var f=Rt;Rt|=2;var g=ZA(),x=JA();Kt!==s||vt!==l?(Kg=null,Yg=ht()+500,yu(s,l)):gu=wt(s,l);e:do try{if(jt!==0&&gt!==null){l=gt;var S=pi;t:switch(jt){case 1:jt=0,pi=null,bu(s,l,S,1);break;case 2:case 9:if(uT(S)){jt=0,pi=null,tC(l);break}l=function(){jt!==2&&jt!==9||Kt!==s||(jt=7),ja(s)},S.then(l,l);break e;case 3:jt=7;break e;case 4:jt=5;break e;case 7:uT(S)?(jt=0,pi=null,tC(l)):(jt=0,pi=null,bu(s,l,S,7));break;case 5:var M=null;switch(gt.tag){case 26:M=gt.memoizedState;case 5:case 27:var U=gt;if(M?BC(M):U.stateNode.complete){jt=0,pi=null;var X=U.sibling;if(X!==null)gt=X;else{var le=U.return;le!==null?(gt=le,Qg(le)):gt=null}break t}}jt=0,pi=null,bu(s,l,S,5);break;case 6:jt=0,pi=null,bu(s,l,S,6);break;case 8:Vb(),_n=6;break e;default:throw Error(r(462))}}i5();break}catch(ve){WA(s,ve)}while(!0);return ps=Pl=null,$.H=g,$.A=x,Rt=f,gt!==null?0:(Kt=null,vt=0,mg(),_n)}function i5(){for(;gt!==null&&!yn();)eC(gt)}function eC(s){var l=EA(s.alternate,s,Es);s.memoizedProps=s.pendingProps,l===null?Qg(s):gt=l}function tC(s){var l=s,f=l.alternate;switch(l.tag){case 15:case 0:l=yA(f,l,l.pendingProps,l.type,void 0,vt);break;case 11:l=yA(f,l,l.pendingProps,l.type.render,l.ref,vt);break;case 5:Zy(l);default:AA(f,l),l=gt=JE(l,Es),l=EA(f,l,Es)}s.memoizedProps=s.pendingProps,l===null?Qg(s):gt=l}function bu(s,l,f,g){ps=Pl=null,Zy(l),lu=null,yf=0;var x=l.return;try{if($j(s,x,l,f,vt)){_n=1,zg(s,Di(f,s.current)),gt=null;return}}catch(S){if(x!==null)throw gt=x,S;_n=1,zg(s,Di(f,s.current)),gt=null;return}l.flags&32768?(St||g===1?s=!0:gu||(vt&536870912)!==0?s=!1:(xo=s=!0,(g===2||g===9||g===3||g===6)&&(g=fi.current,g!==null&&g.tag===13&&(g.flags|=16384))),nC(l,s)):Qg(l)}function Qg(s){var l=s;do{if((l.flags&32768)!==0){nC(l,xo);return}s=l.return;var f=Xj(l.alternate,l,Es);if(f!==null){gt=f;return}if(l=l.sibling,l!==null){gt=l;return}gt=l=s}while(l!==null);_n===0&&(_n=5)}function nC(s,l){do{var f=Wj(s.alternate,s);if(f!==null){f.flags&=32767,gt=f;return}if(f=s.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!l&&(s=s.sibling,s!==null)){gt=s;return}gt=s=f}while(s!==null);_n=6,gt=null}function rC(s,l,f,g,x,S,M,U,X){s.cancelPendingCommit=null;do Zg();while(Kn!==0);if((Rt&6)!==0)throw Error(r(327));if(l!==null){if(l===s.current)throw Error(r(177));if(S=l.lanes|l.childLanes,S|=Ty,Nt(s,f,S,M,U,X),s===Kt&&(gt=Kt=null,vt=0),vu=l,So=s,Ts=f,Mb=S,Pb=x,$A=g,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,l5(Gr,function(){return lC(),null})):(s.callbackNode=null,s.callbackPriority=0),g=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||g){g=$.T,$.T=null,x=H.p,H.p=2,M=Rt,Rt|=4;try{Qj(s,l,f)}finally{Rt=M,H.p=x,$.T=g}}Kn=1,iC(),aC(),sC()}}function iC(){if(Kn===1){Kn=0;var s=So,l=vu,f=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||f){f=$.T,$.T=null;var g=H.p;H.p=2;var x=Rt;Rt|=4;try{zA(l,s);var S=Xb,M=qE(s.containerInfo),U=S.focusedElem,X=S.selectionRange;if(M!==U&&U&&U.ownerDocument&&GE(U.ownerDocument.documentElement,U)){if(X!==null&&xy(U)){var le=X.start,ve=X.end;if(ve===void 0&&(ve=le),"selectionStart"in U)U.selectionStart=le,U.selectionEnd=Math.min(ve,U.value.length);else{var be=U.ownerDocument||document,ce=be&&be.defaultView||window;if(ce.getSelection){var he=ce.getSelection(),Oe=U.textContent.length,Ye=Math.min(X.start,Oe),Ht=X.end===void 0?Ye:Math.min(X.end,Oe);!he.extend&&Ye>Ht&&(M=Ht,Ht=Ye,Ye=M);var ie=UE(U,Ye),ee=UE(U,Ht);if(ie&&ee&&(he.rangeCount!==1||he.anchorNode!==ie.node||he.anchorOffset!==ie.offset||he.focusNode!==ee.node||he.focusOffset!==ee.offset)){var oe=be.createRange();oe.setStart(ie.node,ie.offset),he.removeAllRanges(),Ye>Ht?(he.addRange(oe),he.extend(ee.node,ee.offset)):(oe.setEnd(ee.node,ee.offset),he.addRange(oe))}}}}for(be=[],he=U;he=he.parentNode;)he.nodeType===1&&be.push({element:he,left:he.scrollLeft,top:he.scrollTop});for(typeof U.focus=="function"&&U.focus(),U=0;U<be.length;U++){var ye=be[U];ye.element.scrollLeft=ye.left,ye.element.scrollTop=ye.top}}um=!!Kb,Xb=Kb=null}finally{Rt=x,H.p=g,$.T=f}}s.current=l,Kn=2}}function aC(){if(Kn===2){Kn=0;var s=So,l=vu,f=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||f){f=$.T,$.T=null;var g=H.p;H.p=2;var x=Rt;Rt|=4;try{MA(s,l.alternate,l)}finally{Rt=x,H.p=g,$.T=f}}Kn=3}}function sC(){if(Kn===4||Kn===3){Kn=0,Wt();var s=So,l=vu,f=Ts,g=$A;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?Kn=5:(Kn=0,vu=So=null,oC(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(wo=null),$n(f),l=l.stateNode,bn&&typeof bn.onCommitFiberRoot=="function")try{bn.onCommitFiberRoot(Nr,l,void 0,(l.current.flags&128)===128)}catch{}if(g!==null){l=$.T,x=H.p,H.p=2,$.T=null;try{for(var S=s.onRecoverableError,M=0;M<g.length;M++){var U=g[M];S(U.value,{componentStack:U.stack})}}finally{$.T=l,H.p=x}}(Ts&3)!==0&&Zg(),ja(s),x=s.pendingLanes,(f&261930)!==0&&(x&42)!==0?s===Ob?Of++:(Of=0,Ob=s):Of=0,Vf(0)}}function oC(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,mf(l)))}function Zg(){return iC(),aC(),sC(),lC()}function lC(){if(Kn!==5)return!1;var s=So,l=Mb;Mb=0;var f=$n(Ts),g=$.T,x=H.p;try{H.p=32>f?32:f,$.T=null,f=Pb,Pb=null;var S=So,M=Ts;if(Kn=0,vu=So=null,Ts=0,(Rt&6)!==0)throw Error(r(331));var U=Rt;if(Rt|=4,GA(S.current),BA(S,S.current,M,f),Rt=U,Vf(0,!1),bn&&typeof bn.onPostCommitFiberRoot=="function")try{bn.onPostCommitFiberRoot(Nr,S)}catch{}return!0}finally{H.p=x,$.T=g,oC(s,l)}}function cC(s,l,f){l=Di(f,l),l=hb(s.stateNode,l,2),s=mo(s,l,2),s!==null&&(wr(s,2),ja(s))}function zt(s,l,f){if(s.tag===3)cC(s,s,f);else for(;l!==null;){if(l.tag===3){cC(l,s,f);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(wo===null||!wo.has(g))){s=Di(f,s),f=uA(2),g=mo(l,f,2),g!==null&&(dA(f,g,l,s),wr(g,2),ja(g));break}}l=l.return}}function zb(s,l,f){var g=s.pingCache;if(g===null){g=s.pingCache=new e5;var x=new Set;g.set(l,x)}else x=g.get(l),x===void 0&&(x=new Set,g.set(l,x));x.has(f)||(Rb=!0,x.add(f),s=a5.bind(null,s,l,f),l.then(s,s))}function a5(s,l,f){var g=s.pingCache;g!==null&&g.delete(l),s.pingedLanes|=s.suspendedLanes&f,s.warmLanes&=~f,Kt===s&&(vt&f)===f&&(_n===4||_n===3&&(vt&62914560)===vt&&300>ht()-$g?(Rt&2)===0&&yu(s,0):kb|=f,mu===vt&&(mu=0)),ja(s)}function uC(s,l){l===0&&(l=qr()),s=kl(s,l),s!==null&&(wr(s,l),ja(s))}function s5(s){var l=s.memoizedState,f=0;l!==null&&(f=l.retryLane),uC(s,f)}function o5(s,l){var f=0;switch(s.tag){case 31:case 13:var g=s.stateNode,x=s.memoizedState;x!==null&&(f=x.retryLane);break;case 19:g=s.stateNode;break;case 22:g=s.stateNode._retryCache;break;default:throw Error(r(314))}g!==null&&g.delete(l),uC(s,f)}function l5(s,l){return Ue(s,l)}var Jg=null,xu=null,Lb=!1,em=!1,Bb=!1,To=0;function ja(s){s!==xu&&s.next===null&&(xu===null?Jg=xu=s:xu=xu.next=s),em=!0,Lb||(Lb=!0,u5())}function Vf(s,l){if(!Bb&&em){Bb=!0;do for(var f=!1,g=Jg;g!==null;){if(s!==0){var x=g.pendingLanes;if(x===0)var S=0;else{var M=g.suspendedLanes,U=g.pingedLanes;S=(1<<31-Qt(42|s)+1)-1,S&=x&~(M&~U),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(f=!0,pC(g,S))}else S=vt,S=je(g,g===Kt?S:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(S&3)===0||wt(g,S)||(f=!0,pC(g,S));g=g.next}while(f);Bb=!1}}function c5(){dC()}function dC(){em=Lb=!1;var s=0;To!==0&&x5()&&(s=To);for(var l=ht(),f=null,g=Jg;g!==null;){var x=g.next,S=fC(g,l);S===0?(g.next=null,f===null?Jg=x:f.next=x,x===null&&(xu=f)):(f=g,(s!==0||(S&3)!==0)&&(em=!0)),g=x}Kn!==0&&Kn!==5||Vf(s),To!==0&&(To=0)}function fC(s,l){for(var f=s.suspendedLanes,g=s.pingedLanes,x=s.expirationTimes,S=s.pendingLanes&-62914561;0<S;){var M=31-Qt(S),U=1<<M,X=x[M];X===-1?((U&f)===0||(U&g)!==0)&&(x[M]=rn(U,l)):X<=l&&(s.expiredLanes|=U),S&=~U}if(l=Kt,f=vt,f=je(s,s===l?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g=s.callbackNode,f===0||s===l&&(jt===2||jt===9)||s.cancelPendingCommit!==null)return g!==null&&g!==null&&Pt(g),s.callbackNode=null,s.callbackPriority=0;if((f&3)===0||wt(s,f)){if(l=f&-f,l===s.callbackPriority)return l;switch(g!==null&&Pt(g),$n(f)){case 2:case 8:f=lr;break;case 32:f=Gr;break;case 268435456:f=Zs;break;default:f=Gr}return g=hC.bind(null,s),f=Ue(f,g),s.callbackPriority=l,s.callbackNode=f,l}return g!==null&&g!==null&&Pt(g),s.callbackPriority=2,s.callbackNode=null,2}function hC(s,l){if(Kn!==0&&Kn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var f=s.callbackNode;if(Zg()&&s.callbackNode!==f)return null;var g=vt;return g=je(s,s===Kt?g:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g===0?null:(KA(s,g,l),fC(s,ht()),s.callbackNode!=null&&s.callbackNode===f?hC.bind(null,s):null)}function pC(s,l){if(Zg())return null;KA(s,l,!0)}function u5(){w5(function(){(Rt&6)!==0?Ue(Ft,c5):dC()})}function Fb(){if(To===0){var s=au;s===0&&(s=ut,ut<<=1,(ut&261888)===0&&(ut=256)),To=s}return To}function gC(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:qc(""+s)}function mC(s,l){var f=l.ownerDocument.createElement("input");return f.name=l.name,f.value=l.value,s.id&&f.setAttribute("form",s.id),l.parentNode.insertBefore(f,l),s=new FormData(s),f.parentNode.removeChild(f),s}function d5(s,l,f,g,x){if(l==="submit"&&f&&f.stateNode===x){var S=gC((x[fn]||null).action),M=g.submitter;M&&(l=(l=M[fn]||null)?gC(l.formAction):M.getAttribute("formAction"),l!==null&&(S=l,M=null));var U=new Ra("action","action",null,g,x);s.push({event:U,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(To!==0){var X=M?mC(x,M):new FormData(x);ob(f,{pending:!0,data:X,method:x.method,action:S},null,X)}}else typeof S=="function"&&(U.preventDefault(),X=M?mC(x,M):new FormData(x),ob(f,{pending:!0,data:X,method:x.method,action:S},S,X))},currentTarget:x}]})}}for(var Ub=0;Ub<Ey.length;Ub++){var Gb=Ey[Ub],f5=Gb.toLowerCase(),h5=Gb[0].toUpperCase()+Gb.slice(1);ia(f5,"on"+h5)}ia(YE,"onAnimationEnd"),ia(KE,"onAnimationIteration"),ia(XE,"onAnimationStart"),ia("dblclick","onDoubleClick"),ia("focusin","onFocus"),ia("focusout","onBlur"),ia(Dj,"onTransitionRun"),ia(Rj,"onTransitionStart"),ia(kj,"onTransitionCancel"),ia(WE,"onTransitionEnd"),Aa("onMouseEnter",["mouseout","mouseover"]),Aa("onMouseLeave",["mouseout","mouseover"]),Aa("onPointerEnter",["pointerout","pointerover"]),Aa("onPointerLeave",["pointerout","pointerover"]),Ta("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ta("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ta("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ta("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ta("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ta("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),p5=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(jf));function vC(s,l){l=(l&4)!==0;for(var f=0;f<s.length;f++){var g=s[f],x=g.event;g=g.listeners;e:{var S=void 0;if(l)for(var M=g.length-1;0<=M;M--){var U=g[M],X=U.instance,le=U.currentTarget;if(U=U.listener,X!==S&&x.isPropagationStopped())break e;S=U,x.currentTarget=le;try{S(x)}catch(ve){gg(ve)}x.currentTarget=null,S=X}else for(M=0;M<g.length;M++){if(U=g[M],X=U.instance,le=U.currentTarget,U=U.listener,X!==S&&x.isPropagationStopped())break e;S=U,x.currentTarget=le;try{S(x)}catch(ve){gg(ve)}x.currentTarget=null,S=X}}}}function mt(s,l){var f=l[Zi];f===void 0&&(f=l[Zi]=new Set);var g=s+"__bubble";f.has(g)||(yC(l,s,2,!1),f.add(g))}function qb(s,l,f){var g=0;l&&(g|=4),yC(f,s,g,l)}var tm="_reactListening"+Math.random().toString(36).slice(2);function Hb(s){if(!s[tm]){s[tm]=!0,Kd.forEach(function(f){f!=="selectionchange"&&(p5.has(f)||qb(f,!1,s),qb(f,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[tm]||(l[tm]=!0,qb("selectionchange",!1,l))}}function yC(s,l,f,g){switch(YC(l)){case 2:var x=U5;break;case 8:x=G5;break;default:x=s1}f=x.bind(null,l,f,s),x=void 0,!Sl||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(x=!0),g?x!==void 0?s.addEventListener(l,f,{capture:!0,passive:x}):s.addEventListener(l,f,!0):x!==void 0?s.addEventListener(l,f,{passive:x}):s.addEventListener(l,f,!1)}function $b(s,l,f,g,x){var S=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var M=g.tag;if(M===3||M===4){var U=g.stateNode.containerInfo;if(U===x)break;if(M===4)for(M=g.return;M!==null;){var X=M.tag;if((X===3||X===4)&&M.stateNode.containerInfo===x)return;M=M.return}for(;U!==null;){if(M=Sa(U),M===null)return;if(X=M.tag,X===5||X===6||X===26||X===27){g=S=M;continue e}U=U.parentNode}}g=g.return}ao(function(){var le=S,ve=Ti(f),be=[];e:{var ce=QE.get(s);if(ce!==void 0){var he=Ra,Oe=s;switch(s){case"keypress":if(Tl(f)===0)break e;case"keydown":case"keyup":he=fg;break;case"focusin":Oe="focus",he=Cl;break;case"focusout":Oe="blur",he=Cl;break;case"beforeblur":case"afterblur":he=Cl;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":he=lf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":he=rg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":he=R;break;case YE:case KE:case XE:he=ag;break;case WE:he=q;break;case"scroll":case"scrollend":he=of;break;case"wheel":he=fe;break;case"copy":case"cut":case"paste":he=sg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":he=ds;break;case"toggle":case"beforetoggle":he=st}var Ye=(l&4)!==0,Ht=!Ye&&(s==="scroll"||s==="scrollend"),ie=Ye?ce!==null?ce+"Capture":null:ce;Ye=[];for(var ee=le,oe;ee!==null;){var ye=ee;if(oe=ye.stateNode,ye=ye.tag,ye!==5&&ye!==26&&ye!==27||oe===null||ie===null||(ye=ea(ee,ie),ye!=null&&Ye.push(zf(ee,ye,oe))),Ht)break;ee=ee.return}0<Ye.length&&(ce=new he(ce,Oe,null,f,ve),be.push({event:ce,listeners:Ye}))}}if((l&7)===0){e:{if(ce=s==="mouseover"||s==="pointerover",he=s==="mouseout"||s==="pointerout",ce&&f!==rf&&(Oe=f.relatedTarget||f.fromElement)&&(Sa(Oe)||Oe[$r]))break e;if((he||ce)&&(ce=ve.window===ve?ve:(ce=ve.ownerDocument)?ce.defaultView||ce.parentWindow:window,he?(Oe=f.relatedTarget||f.toElement,he=le,Oe=Oe?Sa(Oe):null,Oe!==null&&(Ht=a(Oe),Ye=Oe.tag,Oe!==Ht||Ye!==5&&Ye!==27&&Ye!==6)&&(Oe=null)):(he=null,Oe=le),he!==Oe)){if(Ye=lf,ye="onMouseLeave",ie="onMouseEnter",ee="mouse",(s==="pointerout"||s==="pointerover")&&(Ye=ds,ye="onPointerLeave",ie="onPointerEnter",ee="pointer"),Ht=he==null?ce:li(he),oe=Oe==null?ce:li(Oe),ce=new Ye(ye,ee+"leave",he,f,ve),ce.target=Ht,ce.relatedTarget=oe,ye=null,Sa(ve)===le&&(Ye=new Ye(ie,ee+"enter",Oe,f,ve),Ye.target=oe,Ye.relatedTarget=Ht,ye=Ye),Ht=ye,he&&Oe)t:{for(Ye=g5,ie=he,ee=Oe,oe=0,ye=ie;ye;ye=Ye(ye))oe++;ye=0;for(var Ge=ee;Ge;Ge=Ye(Ge))ye++;for(;0<oe-ye;)ie=Ye(ie),oe--;for(;0<ye-oe;)ee=Ye(ee),ye--;for(;oe--;){if(ie===ee||ee!==null&&ie===ee.alternate){Ye=ie;break t}ie=Ye(ie),ee=Ye(ee)}Ye=null}else Ye=null;he!==null&&bC(be,ce,he,Ye,!1),Oe!==null&&Ht!==null&&bC(be,Ht,Oe,Ye,!0)}}e:{if(ce=le?li(le):window,he=ce.nodeName&&ce.nodeName.toLowerCase(),he==="select"||he==="input"&&ce.type==="file")var Ct=VE;else if(PE(ce))if(jE)Ct=Aj;else{Ct=Ej;var ze=Sj}else he=ce.nodeName,!he||he.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?le&&Gc(le.elementType)&&(Ct=VE):Ct=Tj;if(Ct&&(Ct=Ct(s,le))){OE(be,Ct,f,ve);break e}ze&&ze(s,ce,le),s==="focusout"&&le&&ce.type==="number"&&le.memoizedProps.value!=null&&ef(ce,"number",ce.value)}switch(ze=le?li(le):window,s){case"focusin":(PE(ze)||ze.contentEditable==="true")&&(Qc=ze,_y=le,hf=null);break;case"focusout":hf=_y=Qc=null;break;case"mousedown":wy=!0;break;case"contextmenu":case"mouseup":case"dragend":wy=!1,HE(be,f,ve);break;case"selectionchange":if(Ij)break;case"keydown":case"keyup":HE(be,f,ve)}var ct;if(Dt)e:{switch(s){case"compositionstart":var yt="onCompositionStart";break e;case"compositionend":yt="onCompositionEnd";break e;case"compositionupdate":yt="onCompositionUpdate";break e}yt=void 0}else Wc?Il(s,f)&&(yt="onCompositionEnd"):s==="keydown"&&f.keyCode===229&&(yt="onCompositionStart");yt&&(Ma&&f.locale!=="ko"&&(Wc||yt!=="onCompositionStart"?yt==="onCompositionEnd"&&Wc&&(ct=sf()):(Da=ve,af="value"in Da?Da.value:Da.textContent,Wc=!0)),ze=nm(le,yt),0<ze.length&&(yt=new Na(yt,s,null,f,ve),be.push({event:yt,listeners:ze}),ct?yt.data=ct:(ct=Xc(f),ct!==null&&(yt.data=ct)))),(ct=Ci?bj(s,f):xj(s,f))&&(yt=nm(le,"onBeforeInput"),0<yt.length&&(ze=new Na("onBeforeInput","beforeinput",null,f,ve),be.push({event:ze,listeners:yt}),ze.data=ct)),d5(be,s,le,f,ve)}vC(be,l)})}function zf(s,l,f){return{instance:s,listener:l,currentTarget:f}}function nm(s,l){for(var f=l+"Capture",g=[];s!==null;){var x=s,S=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||S===null||(x=ea(s,f),x!=null&&g.unshift(zf(s,x,S)),x=ea(s,l),x!=null&&g.push(zf(s,x,S))),s.tag===3)return g;s=s.return}return[]}function g5(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function bC(s,l,f,g,x){for(var S=l._reactName,M=[];f!==null&&f!==g;){var U=f,X=U.alternate,le=U.stateNode;if(U=U.tag,X!==null&&X===g)break;U!==5&&U!==26&&U!==27||le===null||(X=le,x?(le=ea(f,S),le!=null&&M.unshift(zf(f,le,X))):x||(le=ea(f,S),le!=null&&M.push(zf(f,le,X)))),f=f.return}M.length!==0&&s.push({event:l,listeners:M})}var m5=/\r\n?/g,v5=/\u0000|\uFFFD/g;function xC(s){return(typeof s=="string"?s:""+s).replace(m5,`
`).replace(v5,"")}function _C(s,l){return l=xC(l),xC(s)===l}function qt(s,l,f,g,x,S){switch(f){case"children":typeof g=="string"?l==="body"||l==="textarea"&&g===""||Kr(s,g):(typeof g=="number"||typeof g=="bigint")&&l!=="body"&&Kr(s,""+g);break;case"className":ci(s,"class",g);break;case"tabIndex":ci(s,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":ci(s,f,g);break;case"style":nf(s,g,S);break;case"data":if(l!=="object"){ci(s,"data",g);break}case"src":case"href":if(g===""&&(l!=="a"||f!=="href")){s.removeAttribute(f);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(f);break}g=qc(""+g),s.setAttribute(f,g);break;case"action":case"formAction":if(typeof g=="function"){s.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(f==="formAction"?(l!=="input"&&qt(s,l,"name",x.name,x,null),qt(s,l,"formEncType",x.formEncType,x,null),qt(s,l,"formMethod",x.formMethod,x,null),qt(s,l,"formTarget",x.formTarget,x,null)):(qt(s,l,"encType",x.encType,x,null),qt(s,l,"method",x.method,x,null),qt(s,l,"target",x.target,x,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(f);break}g=qc(""+g),s.setAttribute(f,g);break;case"onClick":g!=null&&(s.onclick=Ji);break;case"onScroll":g!=null&&mt("scroll",s);break;case"onScrollEnd":g!=null&&mt("scrollend",s);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"multiple":s.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":s.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){s.removeAttribute("xlink:href");break}f=qc(""+g),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,""+g):s.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,""):s.removeAttribute(f);break;case"capture":case"download":g===!0?s.setAttribute(f,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,g):s.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?s.setAttribute(f,g):s.removeAttribute(f);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?s.removeAttribute(f):s.setAttribute(f,g);break;case"popover":mt("beforetoggle",s),mt("toggle",s),Fc(s,"popover",g);break;case"xlinkActuate":Pn(s,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":Pn(s,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":Pn(s,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":Pn(s,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":Pn(s,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":Pn(s,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":Pn(s,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":Pn(s,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":Pn(s,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":Fc(s,"is",g);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=ng.get(f)||f,Fc(s,f,g))}}function Yb(s,l,f,g,x,S){switch(f){case"style":nf(s,g,S);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"children":typeof g=="string"?Kr(s,g):(typeof g=="number"||typeof g=="bigint")&&Kr(s,""+g);break;case"onScroll":g!=null&&mt("scroll",s);break;case"onScrollEnd":g!=null&&mt("scrollend",s);break;case"onClick":g!=null&&(s.onclick=Ji);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Xd.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(x=f.endsWith("Capture"),l=f.slice(2,x?f.length-7:void 0),S=s[fn]||null,S=S!=null?S[f]:null,typeof S=="function"&&s.removeEventListener(l,S,x),typeof g=="function")){typeof S!="function"&&S!==null&&(f in s?s[f]=null:s.hasAttribute(f)&&s.removeAttribute(f)),s.addEventListener(l,g,x);break e}f in s?s[f]=g:g===!0?s.setAttribute(f,""):Fc(s,f,g)}}}function pr(s,l,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":mt("error",s),mt("load",s);var g=!1,x=!1,S;for(S in f)if(f.hasOwnProperty(S)){var M=f[S];if(M!=null)switch(S){case"src":g=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:qt(s,l,S,M,f,null)}}x&&qt(s,l,"srcSet",f.srcSet,f,null),g&&qt(s,l,"src",f.src,f,null);return;case"input":mt("invalid",s);var U=S=M=x=null,X=null,le=null;for(g in f)if(f.hasOwnProperty(g)){var ve=f[g];if(ve!=null)switch(g){case"name":x=ve;break;case"type":M=ve;break;case"checked":X=ve;break;case"defaultChecked":le=ve;break;case"value":S=ve;break;case"defaultValue":U=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(r(137,l));break;default:qt(s,l,g,ve,f,null)}}Jp(s,S,U,X,le,M,x,!1);return;case"select":mt("invalid",s),g=M=S=null;for(x in f)if(f.hasOwnProperty(x)&&(U=f[x],U!=null))switch(x){case"value":S=U;break;case"defaultValue":M=U;break;case"multiple":g=U;default:qt(s,l,x,U,f,null)}l=S,f=M,s.multiple=!!g,l!=null?to(s,!!g,l,!1):f!=null&&to(s,!!g,f,!0);return;case"textarea":mt("invalid",s),S=x=g=null;for(M in f)if(f.hasOwnProperty(M)&&(U=f[M],U!=null))switch(M){case"value":g=U;break;case"defaultValue":x=U;break;case"children":S=U;break;case"dangerouslySetInnerHTML":if(U!=null)throw Error(r(91));break;default:qt(s,l,M,U,f,null)}no(s,g,x,S);return;case"option":for(X in f)if(f.hasOwnProperty(X)&&(g=f[X],g!=null))switch(X){case"selected":s.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:qt(s,l,X,g,f,null)}return;case"dialog":mt("beforetoggle",s),mt("toggle",s),mt("cancel",s),mt("close",s);break;case"iframe":case"object":mt("load",s);break;case"video":case"audio":for(g=0;g<jf.length;g++)mt(jf[g],s);break;case"image":mt("error",s),mt("load",s);break;case"details":mt("toggle",s);break;case"embed":case"source":case"link":mt("error",s),mt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(le in f)if(f.hasOwnProperty(le)&&(g=f[le],g!=null))switch(le){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:qt(s,l,le,g,f,null)}return;default:if(Gc(l)){for(ve in f)f.hasOwnProperty(ve)&&(g=f[ve],g!==void 0&&Yb(s,l,ve,g,f,void 0));return}}for(U in f)f.hasOwnProperty(U)&&(g=f[U],g!=null&&qt(s,l,U,g,f,null))}function y5(s,l,f,g){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,S=null,M=null,U=null,X=null,le=null,ve=null;for(he in f){var be=f[he];if(f.hasOwnProperty(he)&&be!=null)switch(he){case"checked":break;case"value":break;case"defaultValue":X=be;default:g.hasOwnProperty(he)||qt(s,l,he,null,g,be)}}for(var ce in g){var he=g[ce];if(be=f[ce],g.hasOwnProperty(ce)&&(he!=null||be!=null))switch(ce){case"type":S=he;break;case"name":x=he;break;case"checked":le=he;break;case"defaultChecked":ve=he;break;case"value":M=he;break;case"defaultValue":U=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(r(137,l));break;default:he!==be&&qt(s,l,ce,he,g,be)}}Uc(s,M,U,X,le,ve,S,x);return;case"select":he=M=U=ce=null;for(S in f)if(X=f[S],f.hasOwnProperty(S)&&X!=null)switch(S){case"value":break;case"multiple":he=X;default:g.hasOwnProperty(S)||qt(s,l,S,null,g,X)}for(x in g)if(S=g[x],X=f[x],g.hasOwnProperty(x)&&(S!=null||X!=null))switch(x){case"value":ce=S;break;case"defaultValue":U=S;break;case"multiple":M=S;default:S!==X&&qt(s,l,x,S,g,X)}l=U,f=M,g=he,ce!=null?to(s,!!f,ce,!1):!!g!=!!f&&(l!=null?to(s,!!f,l,!0):to(s,!!f,f?[]:"",!1));return;case"textarea":he=ce=null;for(U in f)if(x=f[U],f.hasOwnProperty(U)&&x!=null&&!g.hasOwnProperty(U))switch(U){case"value":break;case"children":break;default:qt(s,l,U,null,g,x)}for(M in g)if(x=g[M],S=f[M],g.hasOwnProperty(M)&&(x!=null||S!=null))switch(M){case"value":ce=x;break;case"defaultValue":he=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==S&&qt(s,l,M,x,g,S)}eg(s,ce,he);return;case"option":for(var Oe in f)if(ce=f[Oe],f.hasOwnProperty(Oe)&&ce!=null&&!g.hasOwnProperty(Oe))switch(Oe){case"selected":s.selected=!1;break;default:qt(s,l,Oe,null,g,ce)}for(X in g)if(ce=g[X],he=f[X],g.hasOwnProperty(X)&&ce!==he&&(ce!=null||he!=null))switch(X){case"selected":s.selected=ce&&typeof ce!="function"&&typeof ce!="symbol";break;default:qt(s,l,X,ce,g,he)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ye in f)ce=f[Ye],f.hasOwnProperty(Ye)&&ce!=null&&!g.hasOwnProperty(Ye)&&qt(s,l,Ye,null,g,ce);for(le in g)if(ce=g[le],he=f[le],g.hasOwnProperty(le)&&ce!==he&&(ce!=null||he!=null))switch(le){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(r(137,l));break;default:qt(s,l,le,ce,g,he)}return;default:if(Gc(l)){for(var Ht in f)ce=f[Ht],f.hasOwnProperty(Ht)&&ce!==void 0&&!g.hasOwnProperty(Ht)&&Yb(s,l,Ht,void 0,g,ce);for(ve in g)ce=g[ve],he=f[ve],!g.hasOwnProperty(ve)||ce===he||ce===void 0&&he===void 0||Yb(s,l,ve,ce,g,he);return}}for(var ie in f)ce=f[ie],f.hasOwnProperty(ie)&&ce!=null&&!g.hasOwnProperty(ie)&&qt(s,l,ie,null,g,ce);for(be in g)ce=g[be],he=f[be],!g.hasOwnProperty(be)||ce===he||ce==null&&he==null||qt(s,l,be,ce,g,he)}function wC(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function b5(){if(typeof performance.getEntriesByType=="function"){for(var s=0,l=0,f=performance.getEntriesByType("resource"),g=0;g<f.length;g++){var x=f[g],S=x.transferSize,M=x.initiatorType,U=x.duration;if(S&&U&&wC(M)){for(M=0,U=x.responseEnd,g+=1;g<f.length;g++){var X=f[g],le=X.startTime;if(le>U)break;var ve=X.transferSize,be=X.initiatorType;ve&&wC(be)&&(X=X.responseEnd,M+=ve*(X<U?1:(U-le)/(X-le)))}if(--g,l+=8*(S+M)/(x.duration/1e3),s++,10<s)break}}if(0<s)return l/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Kb=null,Xb=null;function rm(s){return s.nodeType===9?s:s.ownerDocument}function SC(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function EC(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function Wb(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Qb=null;function x5(){var s=window.event;return s&&s.type==="popstate"?s===Qb?!1:(Qb=s,!0):(Qb=null,!1)}var TC=typeof setTimeout=="function"?setTimeout:void 0,_5=typeof clearTimeout=="function"?clearTimeout:void 0,AC=typeof Promise=="function"?Promise:void 0,w5=typeof queueMicrotask=="function"?queueMicrotask:typeof AC<"u"?function(s){return AC.resolve(null).then(s).catch(S5)}:TC;function S5(s){setTimeout(function(){throw s})}function Ao(s){return s==="head"}function CC(s,l){var f=l,g=0;do{var x=f.nextSibling;if(s.removeChild(f),x&&x.nodeType===8)if(f=x.data,f==="/$"||f==="/&"){if(g===0){s.removeChild(x),Eu(l);return}g--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")g++;else if(f==="html")Lf(s.ownerDocument.documentElement);else if(f==="head"){f=s.ownerDocument.head,Lf(f);for(var S=f.firstChild;S;){var M=S.nextSibling,U=S.nodeName;S[wa]||U==="SCRIPT"||U==="STYLE"||U==="LINK"&&S.rel.toLowerCase()==="stylesheet"||f.removeChild(S),S=M}}else f==="body"&&Lf(s.ownerDocument.body);f=x}while(f);Eu(l)}function IC(s,l){var f=s;s=0;do{var g=f.nextSibling;if(f.nodeType===1?l?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(l?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),g&&g.nodeType===8)if(f=g.data,f==="/$"){if(s===0)break;s--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||s++;f=g}while(f)}function Zb(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var f=l;switch(l=l.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":Zb(f),Bc(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}s.removeChild(f)}}function E5(s,l,f,g){for(;s.nodeType===1;){var x=f;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!g&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(g){if(!s[wa])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(S=s.getAttribute("rel"),S==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(S!==x.rel||s.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||s.getAttribute("title")!==(x.title==null?null:x.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(S=s.getAttribute("src"),(S!==(x.src==null?null:x.src)||s.getAttribute("type")!==(x.type==null?null:x.type)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&S&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var S=x.name==null?null:""+x.name;if(x.type==="hidden"&&s.getAttribute("name")===S)return s}else return s;if(s=Pi(s.nextSibling),s===null)break}return null}function T5(s,l,f){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!f||(s=Pi(s.nextSibling),s===null))return null;return s}function DC(s,l){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Pi(s.nextSibling),s===null))return null;return s}function Jb(s){return s.data==="$?"||s.data==="$~"}function e1(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function A5(s,l){var f=s.ownerDocument;if(s.data==="$~")s._reactRetry=l;else if(s.data!=="$?"||f.readyState!=="loading")l();else{var g=function(){l(),f.removeEventListener("DOMContentLoaded",g)};f.addEventListener("DOMContentLoaded",g),s._reactRetry=g}}function Pi(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return s}var t1=null;function RC(s){s=s.nextSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="/$"||f==="/&"){if(l===0)return Pi(s.nextSibling);l--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||l++}s=s.nextSibling}return null}function kC(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(l===0)return s;l--}else f!=="/$"&&f!=="/&"||l++}s=s.previousSibling}return null}function NC(s,l,f){switch(l=rm(f),s){case"html":if(s=l.documentElement,!s)throw Error(r(452));return s;case"head":if(s=l.head,!s)throw Error(r(453));return s;case"body":if(s=l.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function Lf(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);Bc(s)}var Oi=new Map,MC=new Set;function im(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var As=H.d;H.d={f:C5,r:I5,D:D5,C:R5,L:k5,m:N5,X:P5,S:M5,M:O5};function C5(){var s=As.f(),l=Xg();return s||l}function I5(s){var l=Ei(s);l!==null&&l.tag===5&&l.type==="form"?WT(l):As.r(s)}var _u=typeof document>"u"?null:document;function PC(s,l,f){var g=_u;if(g&&typeof l=="string"&&l){var x=Yr(l);x='link[rel="'+s+'"][href="'+x+'"]',typeof f=="string"&&(x+='[crossorigin="'+f+'"]'),MC.has(x)||(MC.add(x),s={rel:s,crossOrigin:f,href:l},g.querySelector(x)===null&&(l=g.createElement("link"),pr(l,"link",s),Mn(l),g.head.appendChild(l)))}}function D5(s){As.D(s),PC("dns-prefetch",s,null)}function R5(s,l){As.C(s,l),PC("preconnect",s,l)}function k5(s,l,f){As.L(s,l,f);var g=_u;if(g&&s&&l){var x='link[rel="preload"][as="'+Yr(l)+'"]';l==="image"&&f&&f.imageSrcSet?(x+='[imagesrcset="'+Yr(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(x+='[imagesizes="'+Yr(f.imageSizes)+'"]')):x+='[href="'+Yr(s)+'"]';var S=x;switch(l){case"style":S=wu(s);break;case"script":S=Su(s)}Oi.has(S)||(s=p({rel:"preload",href:l==="image"&&f&&f.imageSrcSet?void 0:s,as:l},f),Oi.set(S,s),g.querySelector(x)!==null||l==="style"&&g.querySelector(Bf(S))||l==="script"&&g.querySelector(Ff(S))||(l=g.createElement("link"),pr(l,"link",s),Mn(l),g.head.appendChild(l)))}}function N5(s,l){As.m(s,l);var f=_u;if(f&&s){var g=l&&typeof l.as=="string"?l.as:"script",x='link[rel="modulepreload"][as="'+Yr(g)+'"][href="'+Yr(s)+'"]',S=x;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=Su(s)}if(!Oi.has(S)&&(s=p({rel:"modulepreload",href:s},l),Oi.set(S,s),f.querySelector(x)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Ff(S)))return}g=f.createElement("link"),pr(g,"link",s),Mn(g),f.head.appendChild(g)}}}function M5(s,l,f){As.S(s,l,f);var g=_u;if(g&&s){var x=Ea(g).hoistableStyles,S=wu(s);l=l||"default";var M=x.get(S);if(!M){var U={loading:0,preload:null};if(M=g.querySelector(Bf(S)))U.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":l},f),(f=Oi.get(S))&&n1(s,f);var X=M=g.createElement("link");Mn(X),pr(X,"link",s),X._p=new Promise(function(le,ve){X.onload=le,X.onerror=ve}),X.addEventListener("load",function(){U.loading|=1}),X.addEventListener("error",function(){U.loading|=2}),U.loading|=4,am(M,l,g)}M={type:"stylesheet",instance:M,count:1,state:U},x.set(S,M)}}}function P5(s,l){As.X(s,l);var f=_u;if(f&&s){var g=Ea(f).hoistableScripts,x=Su(s),S=g.get(x);S||(S=f.querySelector(Ff(x)),S||(s=p({src:s,async:!0},l),(l=Oi.get(x))&&r1(s,l),S=f.createElement("script"),Mn(S),pr(S,"link",s),f.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},g.set(x,S))}}function O5(s,l){As.M(s,l);var f=_u;if(f&&s){var g=Ea(f).hoistableScripts,x=Su(s),S=g.get(x);S||(S=f.querySelector(Ff(x)),S||(s=p({src:s,async:!0,type:"module"},l),(l=Oi.get(x))&&r1(s,l),S=f.createElement("script"),Mn(S),pr(S,"link",s),f.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},g.set(x,S))}}function OC(s,l,f,g){var x=(x=de.current)?im(x):null;if(!x)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(l=wu(f.href),f=Ea(x).hoistableStyles,g=f.get(l),g||(g={type:"style",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){s=wu(f.href);var S=Ea(x).hoistableStyles,M=S.get(s);if(M||(x=x.ownerDocument||x,M={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(s,M),(S=x.querySelector(Bf(s)))&&!S._p&&(M.instance=S,M.state.loading=5),Oi.has(s)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},Oi.set(s,f),S||V5(x,s,f,M.state))),l&&g===null)throw Error(r(528,""));return M}if(l&&g!==null)throw Error(r(529,""));return null;case"script":return l=f.async,f=f.src,typeof f=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Su(f),f=Ea(x).hoistableScripts,g=f.get(l),g||(g={type:"script",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function wu(s){return'href="'+Yr(s)+'"'}function Bf(s){return'link[rel="stylesheet"]['+s+"]"}function VC(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function V5(s,l,f,g){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?g.loading=1:(l=s.createElement("link"),g.preload=l,l.addEventListener("load",function(){return g.loading|=1}),l.addEventListener("error",function(){return g.loading|=2}),pr(l,"link",f),Mn(l),s.head.appendChild(l))}function Su(s){return'[src="'+Yr(s)+'"]'}function Ff(s){return"script[async]"+s}function jC(s,l,f){if(l.count++,l.instance===null)switch(l.type){case"style":var g=s.querySelector('style[data-href~="'+Yr(f.href)+'"]');if(g)return l.instance=g,Mn(g),g;var x=p({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return g=(s.ownerDocument||s).createElement("style"),Mn(g),pr(g,"style",x),am(g,f.precedence,s),l.instance=g;case"stylesheet":x=wu(f.href);var S=s.querySelector(Bf(x));if(S)return l.state.loading|=4,l.instance=S,Mn(S),S;g=VC(f),(x=Oi.get(x))&&n1(g,x),S=(s.ownerDocument||s).createElement("link"),Mn(S);var M=S;return M._p=new Promise(function(U,X){M.onload=U,M.onerror=X}),pr(S,"link",g),l.state.loading|=4,am(S,f.precedence,s),l.instance=S;case"script":return S=Su(f.src),(x=s.querySelector(Ff(S)))?(l.instance=x,Mn(x),x):(g=f,(x=Oi.get(S))&&(g=p({},f),r1(g,x)),s=s.ownerDocument||s,x=s.createElement("script"),Mn(x),pr(x,"link",g),s.head.appendChild(x),l.instance=x);case"void":return null;default:throw Error(r(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(g=l.instance,l.state.loading|=4,am(g,f.precedence,s));return l.instance}function am(s,l,f){for(var g=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=g.length?g[g.length-1]:null,S=x,M=0;M<g.length;M++){var U=g[M];if(U.dataset.precedence===l)S=U;else if(S!==x)break}S?S.parentNode.insertBefore(s,S.nextSibling):(l=f.nodeType===9?f.head:f,l.insertBefore(s,l.firstChild))}function n1(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function r1(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var sm=null;function zC(s,l,f){if(sm===null){var g=new Map,x=sm=new Map;x.set(f,g)}else x=sm,g=x.get(f),g||(g=new Map,x.set(f,g));if(g.has(s))return g;for(g.set(s,null),f=f.getElementsByTagName(s),x=0;x<f.length;x++){var S=f[x];if(!(S[wa]||S[dn]||s==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var M=S.getAttribute(l)||"";M=s+M;var U=g.get(M);U?U.push(S):g.set(M,[S])}}return g}function LC(s,l,f){s=s.ownerDocument||s,s.head.insertBefore(f,l==="title"?s.querySelector("head > title"):null)}function j5(s,l,f){if(f===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return s=l.disabled,typeof l.precedence=="string"&&s==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function BC(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function z5(s,l,f,g){if(f.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var x=wu(g.href),S=l.querySelector(Bf(x));if(S){l=S._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(s.count++,s=om.bind(s),l.then(s,s)),f.state.loading|=4,f.instance=S,Mn(S);return}S=l.ownerDocument||l,g=VC(g),(x=Oi.get(x))&&n1(g,x),S=S.createElement("link"),Mn(S);var M=S;M._p=new Promise(function(U,X){M.onload=U,M.onerror=X}),pr(S,"link",g),f.instance=S}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(f,l),(l=f.state.preload)&&(f.state.loading&3)===0&&(s.count++,f=om.bind(s),l.addEventListener("load",f),l.addEventListener("error",f))}}var i1=0;function L5(s,l){return s.stylesheets&&s.count===0&&cm(s,s.stylesheets),0<s.count||0<s.imgCount?function(f){var g=setTimeout(function(){if(s.stylesheets&&cm(s,s.stylesheets),s.unsuspend){var S=s.unsuspend;s.unsuspend=null,S()}},6e4+l);0<s.imgBytes&&i1===0&&(i1=62500*b5());var x=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&cm(s,s.stylesheets),s.unsuspend)){var S=s.unsuspend;s.unsuspend=null,S()}},(s.imgBytes>i1?50:800)+l);return s.unsuspend=f,function(){s.unsuspend=null,clearTimeout(g),clearTimeout(x)}}:null}function om(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)cm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var lm=null;function cm(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,lm=new Map,l.forEach(B5,s),lm=null,om.call(s))}function B5(s,l){if(!(l.state.loading&4)){var f=lm.get(s);if(f)var g=f.get(null);else{f=new Map,lm.set(s,f);for(var x=s.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<x.length;S++){var M=x[S];(M.nodeName==="LINK"||M.getAttribute("media")!=="not all")&&(f.set(M.dataset.precedence,M),g=M)}g&&f.set(null,g)}x=l.instance,M=x.getAttribute("data-precedence"),S=f.get(M)||g,S===g&&f.set(null,x),f.set(M,x),this.count++,g=om.bind(this),x.addEventListener("load",g),x.addEventListener("error",g),S?S.parentNode.insertBefore(x,S.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(x,s.firstChild)),l.state.loading|=4}}var Uf={$$typeof:D,Provider:null,Consumer:null,_currentValue:te,_currentValue2:te,_threadCount:0};function F5(s,l,f,g,x,S,M,U,X){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=cr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cr(0),this.hiddenUpdates=cr(null),this.identifierPrefix=g,this.onUncaughtError=x,this.onCaughtError=S,this.onRecoverableError=M,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=X,this.incompleteTransitions=new Map}function FC(s,l,f,g,x,S,M,U,X,le,ve,be){return s=new F5(s,l,f,M,X,le,ve,be,U),l=1,S===!0&&(l|=24),S=di(3,null,null,l),s.current=S,S.stateNode=s,l=jy(),l.refCount++,s.pooledCache=l,l.refCount++,S.memoizedState={element:g,isDehydrated:f,cache:l},Fy(S),s}function UC(s){return s?(s=eu,s):eu}function GC(s,l,f,g,x,S){x=UC(x),g.context===null?g.context=x:g.pendingContext=x,g=go(l),g.payload={element:f},S=S===void 0?null:S,S!==null&&(g.callback=S),f=mo(s,g,l),f!==null&&(Jr(f,s,l),xf(f,s,l))}function qC(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var f=s.retryLane;s.retryLane=f!==0&&f<l?f:l}}function a1(s,l){qC(s,l),(s=s.alternate)&&qC(s,l)}function HC(s){if(s.tag===13||s.tag===31){var l=kl(s,67108864);l!==null&&Jr(l,s,67108864),a1(s,67108864)}}function $C(s){if(s.tag===13||s.tag===31){var l=mi();l=Hr(l);var f=kl(s,l);f!==null&&Jr(f,s,l),a1(s,l)}}var um=!0;function U5(s,l,f,g){var x=$.T;$.T=null;var S=H.p;try{H.p=2,s1(s,l,f,g)}finally{H.p=S,$.T=x}}function G5(s,l,f,g){var x=$.T;$.T=null;var S=H.p;try{H.p=8,s1(s,l,f,g)}finally{H.p=S,$.T=x}}function s1(s,l,f,g){if(um){var x=o1(g);if(x===null)$b(s,l,g,dm,f),KC(s,g);else if(H5(x,s,l,f,g))g.stopPropagation();else if(KC(s,g),l&4&&-1<q5.indexOf(s)){for(;x!==null;){var S=Ei(x);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var M=Ae(S.pendingLanes);if(M!==0){var U=S;for(U.pendingLanes|=2,U.entangledLanes|=2;M;){var X=1<<31-Qt(M);U.entanglements[1]|=X,M&=~X}ja(S),(Rt&6)===0&&(Yg=ht()+500,Vf(0))}}break;case 31:case 13:U=kl(S,2),U!==null&&Jr(U,S,2),Xg(),a1(S,2)}if(S=o1(g),S===null&&$b(s,l,g,dm,f),S===x)break;x=S}x!==null&&g.stopPropagation()}else $b(s,l,g,null,f)}}function o1(s){return s=Ti(s),l1(s)}var dm=null;function l1(s){if(dm=null,s=Sa(s),s!==null){var l=a(s);if(l===null)s=null;else{var f=l.tag;if(f===13){if(s=o(l),s!==null)return s;s=null}else if(f===31){if(s=c(l),s!==null)return s;s=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return dm=s,null}function YC(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(At()){case Ft:return 2;case lr:return 8;case Gr:case ls:return 32;case Zs:return 268435456;default:return 32}default:return 32}}var c1=!1,Co=null,Io=null,Do=null,Gf=new Map,qf=new Map,Ro=[],q5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function KC(s,l){switch(s){case"focusin":case"focusout":Co=null;break;case"dragenter":case"dragleave":Io=null;break;case"mouseover":case"mouseout":Do=null;break;case"pointerover":case"pointerout":Gf.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":qf.delete(l.pointerId)}}function Hf(s,l,f,g,x,S){return s===null||s.nativeEvent!==S?(s={blockedOn:l,domEventName:f,eventSystemFlags:g,nativeEvent:S,targetContainers:[x]},l!==null&&(l=Ei(l),l!==null&&HC(l)),s):(s.eventSystemFlags|=g,l=s.targetContainers,x!==null&&l.indexOf(x)===-1&&l.push(x),s)}function H5(s,l,f,g,x){switch(l){case"focusin":return Co=Hf(Co,s,l,f,g,x),!0;case"dragenter":return Io=Hf(Io,s,l,f,g,x),!0;case"mouseover":return Do=Hf(Do,s,l,f,g,x),!0;case"pointerover":var S=x.pointerId;return Gf.set(S,Hf(Gf.get(S)||null,s,l,f,g,x)),!0;case"gotpointercapture":return S=x.pointerId,qf.set(S,Hf(qf.get(S)||null,s,l,f,g,x)),!0}return!1}function XC(s){var l=Sa(s.target);if(l!==null){var f=a(l);if(f!==null){if(l=f.tag,l===13){if(l=o(f),l!==null){s.blockedOn=l,Yn(s.priority,function(){$C(f)});return}}else if(l===31){if(l=c(f),l!==null){s.blockedOn=l,Yn(s.priority,function(){$C(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){s.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}s.blockedOn=null}function fm(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var f=o1(s.nativeEvent);if(f===null){f=s.nativeEvent;var g=new f.constructor(f.type,f);rf=g,f.target.dispatchEvent(g),rf=null}else return l=Ei(f),l!==null&&HC(l),s.blockedOn=f,!1;l.shift()}return!0}function WC(s,l,f){fm(s)&&f.delete(l)}function $5(){c1=!1,Co!==null&&fm(Co)&&(Co=null),Io!==null&&fm(Io)&&(Io=null),Do!==null&&fm(Do)&&(Do=null),Gf.forEach(WC),qf.forEach(WC)}function hm(s,l){s.blockedOn===l&&(s.blockedOn=null,c1||(c1=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,$5)))}var pm=null;function QC(s){pm!==s&&(pm=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){pm===s&&(pm=null);for(var l=0;l<s.length;l+=3){var f=s[l],g=s[l+1],x=s[l+2];if(typeof g!="function"){if(l1(g||f)===null)continue;break}var S=Ei(f);S!==null&&(s.splice(l,3),l-=3,ob(S,{pending:!0,data:x,method:f.method,action:g},g,x))}}))}function Eu(s){function l(X){return hm(X,s)}Co!==null&&hm(Co,s),Io!==null&&hm(Io,s),Do!==null&&hm(Do,s),Gf.forEach(l),qf.forEach(l);for(var f=0;f<Ro.length;f++){var g=Ro[f];g.blockedOn===s&&(g.blockedOn=null)}for(;0<Ro.length&&(f=Ro[0],f.blockedOn===null);)XC(f),f.blockedOn===null&&Ro.shift();if(f=(s.ownerDocument||s).$$reactFormReplay,f!=null)for(g=0;g<f.length;g+=3){var x=f[g],S=f[g+1],M=x[fn]||null;if(typeof S=="function")M||QC(f);else if(M){var U=null;if(S&&S.hasAttribute("formAction")){if(x=S,M=S[fn]||null)U=M.formAction;else if(l1(x)!==null)continue}else U=M.action;typeof U=="function"?f[g+1]=U:(f.splice(g,3),g-=3),QC(f)}}}function ZC(){function s(S){S.canIntercept&&S.info==="react-transition"&&S.intercept({handler:function(){return new Promise(function(M){return x=M})},focusReset:"manual",scroll:"manual"})}function l(){x!==null&&(x(),x=null),g||setTimeout(f,20)}function f(){if(!g&&!navigation.transition){var S=navigation.currentEntry;S&&S.url!=null&&navigation.navigate(S.url,{state:S.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,x=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(f,100),function(){g=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),x!==null&&(x(),x=null)}}}function u1(s){this._internalRoot=s}gm.prototype.render=u1.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(r(409));var f=l.current,g=mi();GC(f,g,s,l,null,null)},gm.prototype.unmount=u1.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;GC(s.current,2,null,s,null,null),Xg(),l[$r]=null}};function gm(s){this._internalRoot=s}gm.prototype.unstable_scheduleHydration=function(s){if(s){var l=Nn();s={blockedOn:null,target:s,priority:l};for(var f=0;f<Ro.length&&l!==0&&l<Ro[f].priority;f++);Ro.splice(f,0,s),f===0&&XC(s)}};var JC=e.version;if(JC!=="19.2.0")throw Error(r(527,JC,"19.2.0"));H.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(l),s=s!==null?h(s):null,s=s===null?null:s.stateNode,s};var Y5={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mm.isDisabled&&mm.supportsFiber)try{Nr=mm.inject(Y5),bn=mm}catch{}}return Yf.createRoot=function(s,l){if(!i(s))throw Error(r(299));var f=!1,g="",x=sA,S=oA,M=lA;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(S=l.onCaughtError),l.onRecoverableError!==void 0&&(M=l.onRecoverableError)),l=FC(s,1,!1,null,null,f,g,null,x,S,M,ZC),s[$r]=l.current,Hb(s),new u1(l)},Yf.hydrateRoot=function(s,l,f){if(!i(s))throw Error(r(299));var g=!1,x="",S=sA,M=oA,U=lA,X=null;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onUncaughtError!==void 0&&(S=f.onUncaughtError),f.onCaughtError!==void 0&&(M=f.onCaughtError),f.onRecoverableError!==void 0&&(U=f.onRecoverableError),f.formState!==void 0&&(X=f.formState)),l=FC(s,1,!0,l,f??null,g,x,X,S,M,U,ZC),l.context=UC(null),f=l.current,g=mi(),g=Hr(g),x=go(g),x.callback=null,mo(f,x,g),f=g,l.current.lanes=f,wr(l,f),ja(l),s[$r]=l.current,Hb(s),new gm(l)},Yf.version="19.2.0",Yf}var cI;function i6(){if(cI)return h1.exports;cI=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),h1.exports=r6(),h1.exports}var a6=i6();const s6="modulepreload",o6=function(t){return"/personal-budget-pwa/"+t},uI={},vi=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){let d=function(h){return Promise.all(h.map(p=>Promise.resolve(p).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};var o=d;document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),u=c?.nonce||c?.getAttribute("nonce");i=d(n.map(h=>{if(h=o6(h),h in uI)return;uI[h]=!0;const p=h.endsWith(".css"),m=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${m}`))return;const y=document.createElement("link");if(y.rel=p?"stylesheet":s6,p||(y.as="script"),y.crossOrigin="",y.href=h,u&&y.setAttribute("nonce",u),document.head.appendChild(y),p)return new Promise((_,w)=>{y.addEventListener("load",_),y.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${h}`)))})}))}function a(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return i.then(c=>{for(const u of c||[])u.status==="rejected"&&a(u.reason);return e().catch(a)})};function l6(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:a,onRegisterError:o}=t;let c,u;const d=async(p=!0)=>{await u};async function h(){if("serviceWorker"in navigator){if(c=await vi(async()=>{const{Workbox:p}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/personal-budget-pwa/sw.js",{scope:"/personal-budget-pwa/",type:"classic"})).catch(p=>{o?.(p)}),!c)return;c.addEventListener("activated",p=>{(p.isUpdate||p.isExternal)&&window.location.reload()}),c.addEventListener("installed",p=>{p.isUpdate||r?.()}),c.register({immediate:e}).then(p=>{a?a("/personal-budget-pwa/sw.js",p):i?.(p)}).catch(p=>{o?.(p)})}}return u=h(),d}var dI="popstate";function c6(t={}){function e(i,a){let{pathname:o="/",search:c="",hash:u=""}=Pc(i.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),gx("",{pathname:o,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(i,a){let o=i.document.querySelector("base"),c="";if(o&&o.getAttribute("href")){let u=i.location.href,d=u.indexOf("#");c=d===-1?u:u.slice(0,d)}return c+"#"+(typeof a=="string"?a:Oh(a))}function r(i,a){xi(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(a)})`)}return d6(e,n,r,t)}function mn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function xi(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function u6(){return Math.random().toString(36).substring(2,10)}function fI(t,e){return{usr:t.state,key:t.key,idx:e}}function gx(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Pc(e):e,state:n,key:e&&e.key||r||u6()}}function Oh({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Pc(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function d6(t,e,n,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,c="POP",u=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function p(){c="POP";let E=h(),T=E==null?null:E-d;d=E,u&&u({action:c,location:w.location,delta:T})}function m(E,T){c="PUSH";let I=gx(w.location,E,T);n&&n(I,E),d=h()+1;let D=fI(I,d),O=w.createHref(I);try{o.pushState(D,"",O)}catch(z){if(z instanceof DOMException&&z.name==="DataCloneError")throw z;i.location.assign(O)}a&&u&&u({action:c,location:w.location,delta:1})}function y(E,T){c="REPLACE";let I=gx(w.location,E,T);n&&n(I,E),d=h();let D=fI(I,d),O=w.createHref(I);o.replaceState(D,"",O),a&&u&&u({action:c,location:w.location,delta:0})}function _(E){return f6(E)}let w={get action(){return c},get location(){return t(i,o)},listen(E){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(dI,p),u=E,()=>{i.removeEventListener(dI,p),u=null}},createHref(E){return e(i,E)},createURL:_,encodeLocation(E){let T=_(E);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:m,replace:y,go(E){return o.go(E)}};return w}function f6(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),mn(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:Oh(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function Uk(t,e,n="/"){return h6(t,e,n,!1)}function h6(t,e,n,r){let i=typeof e=="string"?Pc(e):e,a=zs(i.pathname||"/",n);if(a==null)return null;let o=Gk(t);p6(o);let c=null;for(let u=0;c==null&&u<o.length;++u){let d=T6(a);c=S6(o[u],d,r)}return c}function Gk(t,e=[],n=[],r="",i=!1){let a=(o,c,u=i,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&u)return;mn(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let p=Ms([r,h.relativePath]),m=n.concat(h);o.children&&o.children.length>0&&(mn(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),Gk(o.children,e,m,p,u)),!(o.path==null&&!o.index)&&e.push({path:p,score:_6(p,o.index),routesMeta:m})};return t.forEach((o,c)=>{if(o.path===""||!o.path?.includes("?"))a(o,c);else for(let u of qk(o.path))a(o,c,!0,u)}),e}function qk(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=qk(r.join("/")),c=[];return c.push(...o.map(u=>u===""?a:[a,u].join("/"))),i&&c.push(...o),c.map(u=>t.startsWith("/")&&u===""?"/":u)}function p6(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:w6(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var g6=/^:[\w-]+$/,m6=3,v6=2,y6=1,b6=10,x6=-2,hI=t=>t==="*";function _6(t,e){let n=t.split("/"),r=n.length;return n.some(hI)&&(r+=x6),e&&(r+=v6),n.filter(i=>!hI(i)).reduce((i,a)=>i+(g6.test(a)?m6:a===""?y6:b6),r)}function w6(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function S6(t,e,n=!1){let{routesMeta:r}=t,i={},a="/",o=[];for(let c=0;c<r.length;++c){let u=r[c],d=c===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=_0({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),m=u.route;if(!p&&d&&n&&!r[r.length-1].route.index&&(p=_0({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:Ms([a,p.pathname]),pathnameBase:R6(Ms([a,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(a=Ms([a,p.pathnameBase]))}return o}function _0(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=E6(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:p},m)=>{if(h==="*"){let _=c[m]||"";o=a.slice(0,a.length-_.length).replace(/(.)\/+$/,"$1")}const y=c[m];return p&&!y?d[h]=void 0:d[h]=(y||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:t}}function E6(t,e=!1,n=!0){xi(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function T6(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return xi(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function zs(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var A6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,C6=t=>A6.test(t);function I6(t,e="/"){let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Pc(t):t,a;if(n)if(C6(n))a=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),xi(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${n}`)}n.startsWith("/")?a=pI(n.substring(1),"/"):a=pI(n,e)}else a=e;return{pathname:a,search:k6(r),hash:N6(i)}}function pI(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function v1(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function D6(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Hk(t){let e=D6(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function $k(t,e,n,r=!1){let i;typeof t=="string"?i=Pc(t):(i={...t},mn(!i.pathname||!i.pathname.includes("?"),v1("?","pathname","search",i)),mn(!i.pathname||!i.pathname.includes("#"),v1("#","pathname","hash",i)),mn(!i.search||!i.search.includes("#"),v1("#","search","hash",i)));let a=t===""||i.pathname==="",o=a?"/":i.pathname,c;if(o==null)c=n;else{let p=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;i.pathname=m.join("/")}c=p>=0?e[p]:"/"}let u=I6(i,c),d=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}var Ms=t=>t.join("/").replace(/\/\/+/g,"/"),R6=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),k6=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,N6=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function M6(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Yk=["POST","PUT","PATCH","DELETE"];new Set(Yk);var P6=["GET",...Yk];new Set(P6);var Nd=G.createContext(null);Nd.displayName="DataRouter";var gv=G.createContext(null);gv.displayName="DataRouterState";G.createContext(!1);var Kk=G.createContext({isTransitioning:!1});Kk.displayName="ViewTransition";var O6=G.createContext(new Map);O6.displayName="Fetchers";var V6=G.createContext(null);V6.displayName="Await";var ns=G.createContext(null);ns.displayName="Navigation";var pp=G.createContext(null);pp.displayName="Location";var rs=G.createContext({outlet:null,matches:[],isDataRoute:!1});rs.displayName="Route";var J_=G.createContext(null);J_.displayName="RouteError";function j6(t,{relative:e}={}){mn(gp(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=G.useContext(ns),{hash:i,pathname:a,search:o}=mp(t,{relative:e}),c=a;return n!=="/"&&(c=a==="/"?n:Ms([n,a])),r.createHref({pathname:c,search:o,hash:i})}function gp(){return G.useContext(pp)!=null}function is(){return mn(gp(),"useLocation() may be used only in the context of a <Router> component."),G.useContext(pp).location}var Xk="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Wk(t){G.useContext(ns).static||G.useLayoutEffect(t)}function as(){let{isDataRoute:t}=G.useContext(rs);return t?Q6():z6()}function z6(){mn(gp(),"useNavigate() may be used only in the context of a <Router> component.");let t=G.useContext(Nd),{basename:e,navigator:n}=G.useContext(ns),{matches:r}=G.useContext(rs),{pathname:i}=is(),a=JSON.stringify(Hk(r)),o=G.useRef(!1);return Wk(()=>{o.current=!0}),G.useCallback((u,d={})=>{if(xi(o.current,Xk),!o.current)return;if(typeof u=="number"){n.go(u);return}let h=$k(u,JSON.parse(a),i,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Ms([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,a,i,t])}G.createContext(null);function L6(){let{matches:t}=G.useContext(rs),e=t[t.length-1];return e?e.params:{}}function mp(t,{relative:e}={}){let{matches:n}=G.useContext(rs),{pathname:r}=is(),i=JSON.stringify(Hk(n));return G.useMemo(()=>$k(t,JSON.parse(i),r,e==="path"),[t,i,r,e])}function B6(t,e){return Qk(t,e)}function Qk(t,e,n,r,i){mn(gp(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=G.useContext(ns),{matches:o}=G.useContext(rs),c=o[o.length-1],u=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",p=c&&c.route;{let I=p&&p.path||"";Zk(d,!p||I.endsWith("*")||I.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${I}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${I}"> to <Route path="${I==="/"?"*":`${I}/*`}">.`)}let m=is(),y;if(e){let I=typeof e=="string"?Pc(e):e;mn(h==="/"||I.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${I.pathname}" was given in the \`location\` prop.`),y=I}else y=m;let _=y.pathname||"/",w=_;if(h!=="/"){let I=h.replace(/^\//,"").split("/");w="/"+_.replace(/^\//,"").split("/").slice(I.length).join("/")}let E=Uk(t,{pathname:w});xi(p||E!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),xi(E==null||E[E.length-1].route.element!==void 0||E[E.length-1].route.Component!==void 0||E[E.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=H6(E&&E.map(I=>Object.assign({},I,{params:Object.assign({},u,I.params),pathname:Ms([h,a.encodeLocation?a.encodeLocation(I.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:I.pathname]),pathnameBase:I.pathnameBase==="/"?h:Ms([h,a.encodeLocation?a.encodeLocation(I.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:I.pathnameBase])})),o,n,r,i);return e&&T?G.createElement(pp.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},T):T}function F6(){let t=W6(),e=M6(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=G.createElement(G.Fragment,null,G.createElement("p",null," Hey developer "),G.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",G.createElement("code",{style:a},"ErrorBoundary")," or"," ",G.createElement("code",{style:a},"errorElement")," prop on your route.")),G.createElement(G.Fragment,null,G.createElement("h2",null,"Unexpected Application Error!"),G.createElement("h3",{style:{fontStyle:"italic"}},e),n?G.createElement("pre",{style:i},n):null,o)}var U6=G.createElement(F6,null),G6=class extends G.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?G.createElement(rs.Provider,{value:this.props.routeContext},G.createElement(J_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function q6({routeContext:t,match:e,children:n}){let r=G.useContext(Nd);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),G.createElement(rs.Provider,{value:t},n)}function H6(t,e=[],n=null,r=null,i=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,o=n?.errors;if(o!=null){let h=a.findIndex(p=>p.route.id&&o?.[p.route.id]!==void 0);mn(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let c=!1,u=-1;if(n)for(let h=0;h<a.length;h++){let p=a[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=h),p.route.id){let{loaderData:m,errors:y}=n,_=p.route.loader&&!m.hasOwnProperty(p.route.id)&&(!y||y[p.route.id]===void 0);if(p.route.lazy||_){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}let d=n&&r?(h,p)=>{r(h,{location:n.location,params:n.matches?.[0]?.params??{},errorInfo:p})}:void 0;return a.reduceRight((h,p,m)=>{let y,_=!1,w=null,E=null;n&&(y=o&&p.route.id?o[p.route.id]:void 0,w=p.route.errorElement||U6,c&&(u<0&&m===0?(Zk("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,E=null):u===m&&(_=!0,E=p.route.hydrateFallbackElement||null)));let T=e.concat(a.slice(0,m+1)),I=()=>{let D;return y?D=w:_?D=E:p.route.Component?D=G.createElement(p.route.Component,null):p.route.element?D=p.route.element:D=h,G.createElement(q6,{match:p,routeContext:{outlet:h,matches:T,isDataRoute:n!=null},children:D})};return n&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?G.createElement(G6,{location:n.location,revalidation:n.revalidation,component:w,error:y,children:I(),routeContext:{outlet:null,matches:T,isDataRoute:!0},onError:d}):I()},null)}function ew(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function $6(t){let e=G.useContext(Nd);return mn(e,ew(t)),e}function Y6(t){let e=G.useContext(gv);return mn(e,ew(t)),e}function K6(t){let e=G.useContext(rs);return mn(e,ew(t)),e}function tw(t){let e=K6(t),n=e.matches[e.matches.length-1];return mn(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function X6(){return tw("useRouteId")}function W6(){let t=G.useContext(J_),e=Y6("useRouteError"),n=tw("useRouteError");return t!==void 0?t:e.errors?.[n]}function Q6(){let{router:t}=$6("useNavigate"),e=tw("useNavigate"),n=G.useRef(!1);return Wk(()=>{n.current=!0}),G.useCallback(async(i,a={})=>{xi(n.current,Xk),n.current&&(typeof i=="number"?t.navigate(i):await t.navigate(i,{fromRouteId:e,...a}))},[t,e])}var gI={};function Zk(t,e,n){!e&&!gI[t]&&(gI[t]=!0,xi(!1,n))}G.memo(Z6);function Z6({routes:t,future:e,state:n,unstable_onError:r}){return Qk(t,void 0,n,r,e)}function Cs(t){mn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function J6({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:i,static:a=!1}){mn(!gp(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),c=G.useMemo(()=>({basename:o,navigator:i,static:a,future:{}}),[o,i,a]);typeof n=="string"&&(n=Pc(n));let{pathname:u="/",search:d="",hash:h="",state:p=null,key:m="default"}=n,y=G.useMemo(()=>{let _=zs(u,o);return _==null?null:{location:{pathname:_,search:d,hash:h,state:p,key:m},navigationType:r}},[o,u,d,h,p,m,r]);return xi(y!=null,`<Router basename="${o}"> is not able to match the URL "${u}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:G.createElement(ns.Provider,{value:c},G.createElement(pp.Provider,{children:e,value:y}))}function ez({children:t,location:e}){return B6(mx(t),e)}function mx(t,e=[]){let n=[];return G.Children.forEach(t,(r,i)=>{if(!G.isValidElement(r))return;let a=[...e,i];if(r.type===G.Fragment){n.push.apply(n,mx(r.props.children,a));return}mn(r.type===Cs,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),mn(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=mx(r.props.children,a)),n.push(o)}),n}var Km="get",Xm="application/x-www-form-urlencoded";function mv(t){return t!=null&&typeof t.tagName=="string"}function tz(t){return mv(t)&&t.tagName.toLowerCase()==="button"}function nz(t){return mv(t)&&t.tagName.toLowerCase()==="form"}function rz(t){return mv(t)&&t.tagName.toLowerCase()==="input"}function iz(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function az(t,e){return t.button===0&&(!e||e==="_self")&&!iz(t)}function vx(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(i=>[n,i]):[[n,r]])},[]))}function sz(t,e){let n=vx(t);return e&&e.forEach((r,i)=>{n.has(i)||e.getAll(i).forEach(a=>{n.append(i,a)})}),n}var ym=null;function oz(){if(ym===null)try{new FormData(document.createElement("form"),0),ym=!1}catch{ym=!0}return ym}var lz=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function y1(t){return t!=null&&!lz.has(t)?(xi(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Xm}"`),null):t}function cz(t,e){let n,r,i,a,o;if(nz(t)){let c=t.getAttribute("action");r=c?zs(c,e):null,n=t.getAttribute("method")||Km,i=y1(t.getAttribute("enctype"))||Xm,a=new FormData(t)}else if(tz(t)||rz(t)&&(t.type==="submit"||t.type==="image")){let c=t.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=t.getAttribute("formaction")||c.getAttribute("action");if(r=u?zs(u,e):null,n=t.getAttribute("formmethod")||c.getAttribute("method")||Km,i=y1(t.getAttribute("formenctype"))||y1(c.getAttribute("enctype"))||Xm,a=new FormData(c,t),!oz()){let{name:d,type:h,value:p}=t;if(h==="image"){let m=d?`${d}.`:"";a.append(`${m}x`,"0"),a.append(`${m}y`,"0")}else d&&a.append(d,p)}}else{if(mv(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Km,r=null,i=Xm,o=t}return a&&i==="text/plain"&&(o=a,a=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function nw(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function uz(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&zs(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function dz(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function fz(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function hz(t,e,n){let r=await Promise.all(t.map(async i=>{let a=e.routes[i.route.id];if(a){let o=await dz(a,n);return o.links?o.links():[]}return[]}));return vz(r.flat(1).filter(fz).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function mI(t,e,n,r,i,a){let o=(u,d)=>n[d]?u.route.id!==n[d].route.id:!0,c=(u,d)=>n[d].pathname!==u.pathname||n[d].route.path?.endsWith("*")&&n[d].params["*"]!==u.params["*"];return a==="assets"?e.filter((u,d)=>o(u,d)||c(u,d)):a==="data"?e.filter((u,d)=>{let h=r.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,d)||c(u,d))return!0;if(u.route.shouldRevalidate){let p=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function pz(t,e,{includeHydrateFallback:n}={}){return gz(t.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function gz(t){return[...new Set(t)]}function mz(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function vz(t,e){let n=new Set;return new Set(e),t.reduce((r,i)=>{let a=JSON.stringify(mz(i));return n.has(a)||(n.add(a),r.push({key:a,link:i})),r},[])}function Jk(){let t=G.useContext(Nd);return nw(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function yz(){let t=G.useContext(gv);return nw(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var rw=G.createContext(void 0);rw.displayName="FrameworkContext";function eN(){let t=G.useContext(rw);return nw(t,"You must render this element inside a <HydratedRouter> element"),t}function bz(t,e){let n=G.useContext(rw),[r,i]=G.useState(!1),[a,o]=G.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:d,onMouseLeave:h,onTouchStart:p}=e,m=G.useRef(null);G.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let w=T=>{T.forEach(I=>{o(I.isIntersecting)})},E=new IntersectionObserver(w,{threshold:.5});return m.current&&E.observe(m.current),()=>{E.disconnect()}}},[t]),G.useEffect(()=>{if(r){let w=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(w)}}},[r]);let y=()=>{i(!0)},_=()=>{i(!1),o(!1)};return n?t!=="intent"?[a,m,{}]:[a,m,{onFocus:Kf(c,y),onBlur:Kf(u,_),onMouseEnter:Kf(d,y),onMouseLeave:Kf(h,_),onTouchStart:Kf(p,y)}]:[!1,m,{}]}function Kf(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function xz({page:t,...e}){let{router:n}=Jk(),r=G.useMemo(()=>Uk(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?G.createElement(wz,{page:t,matches:r,...e}):null}function _z(t){let{manifest:e,routeModules:n}=eN(),[r,i]=G.useState([]);return G.useEffect(()=>{let a=!1;return hz(t,e,n).then(o=>{a||i(o)}),()=>{a=!0}},[t,e,n]),r}function wz({page:t,matches:e,...n}){let r=is(),{manifest:i,routeModules:a}=eN(),{basename:o}=Jk(),{loaderData:c,matches:u}=yz(),d=G.useMemo(()=>mI(t,e,u,i,r,"data"),[t,e,u,i,r]),h=G.useMemo(()=>mI(t,e,u,i,r,"assets"),[t,e,u,i,r]),p=G.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let _=new Set,w=!1;if(e.forEach(T=>{let I=i.routes[T.route.id];!I||!I.hasLoader||(!d.some(D=>D.route.id===T.route.id)&&T.route.id in c&&a[T.route.id]?.shouldRevalidate||I.hasClientLoader?w=!0:_.add(T.route.id))}),_.size===0)return[];let E=uz(t,o,"data");return w&&_.size>0&&E.searchParams.set("_routes",e.filter(T=>_.has(T.route.id)).map(T=>T.route.id).join(",")),[E.pathname+E.search]},[o,c,r,i,d,e,t,a]),m=G.useMemo(()=>pz(h,i),[h,i]),y=_z(h);return G.createElement(G.Fragment,null,p.map(_=>G.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...n})),m.map(_=>G.createElement("link",{key:_,rel:"modulepreload",href:_,...n})),y.map(({key:_,link:w})=>G.createElement("link",{key:_,nonce:n.nonce,...w})))}function Sz(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var tN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{tN&&(window.__reactRouterVersion="7.9.6")}catch{}function Ez({basename:t,children:e,window:n}){let r=G.useRef();r.current==null&&(r.current=c6({window:n,v5Compat:!0}));let i=r.current,[a,o]=G.useState({action:i.action,location:i.location}),c=G.useCallback(u=>{G.startTransition(()=>o(u))},[o]);return G.useLayoutEffect(()=>i.listen(c),[i,c]),G.createElement(J6,{basename:t,children:e,location:a.location,navigationType:a.action,navigator:i})}var nN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,rN=G.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:i,reloadDocument:a,replace:o,state:c,target:u,to:d,preventScrollReset:h,viewTransition:p,...m},y){let{basename:_}=G.useContext(ns),w=typeof d=="string"&&nN.test(d),E,T=!1;if(typeof d=="string"&&w&&(E=d,tN))try{let k=new URL(window.location.href),V=d.startsWith("//")?new URL(k.protocol+d):new URL(d),B=zs(V.pathname,_);V.origin===k.origin&&B!=null?d=B+V.search+V.hash:T=!0}catch{xi(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let I=j6(d,{relative:i}),[D,O,z]=bz(r,m),P=Iz(d,{replace:o,state:c,target:u,preventScrollReset:h,relative:i,viewTransition:p});function A(k){e&&e(k),k.defaultPrevented||P(k)}let C=G.createElement("a",{...m,...z,href:E||I,onClick:T||a?e:A,ref:Sz(y,O),target:u,"data-discover":!w&&n==="render"?"true":void 0});return D&&!w?G.createElement(G.Fragment,null,C,G.createElement(xz,{page:I})):C});rN.displayName="Link";var Tz=G.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:i=!1,style:a,to:o,viewTransition:c,children:u,...d},h){let p=mp(o,{relative:d.relative}),m=is(),y=G.useContext(gv),{navigator:_,basename:w}=G.useContext(ns),E=y!=null&&Pz(p)&&c===!0,T=_.encodeLocation?_.encodeLocation(p).pathname:p.pathname,I=m.pathname,D=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;n||(I=I.toLowerCase(),D=D?D.toLowerCase():null,T=T.toLowerCase()),D&&w&&(D=zs(D,w)||D);const O=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let z=I===T||!i&&I.startsWith(T)&&I.charAt(O)==="/",P=D!=null&&(D===T||!i&&D.startsWith(T)&&D.charAt(T.length)==="/"),A={isActive:z,isPending:P,isTransitioning:E},C=z?e:void 0,k;typeof r=="function"?k=r(A):k=[r,z?"active":null,P?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let V=typeof a=="function"?a(A):a;return G.createElement(rN,{...d,"aria-current":C,className:k,ref:h,style:V,to:o,viewTransition:c},typeof u=="function"?u(A):u)});Tz.displayName="NavLink";var Az=G.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:i,state:a,method:o=Km,action:c,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:p,...m},y)=>{let _=Nz(),w=Mz(c,{relative:d}),E=o.toLowerCase()==="get"?"get":"post",T=typeof c=="string"&&nN.test(c),I=D=>{if(u&&u(D),D.defaultPrevented)return;D.preventDefault();let O=D.nativeEvent.submitter,z=O?.getAttribute("formmethod")||o;_(O||D.currentTarget,{fetcherKey:e,method:z,navigate:n,replace:i,state:a,relative:d,preventScrollReset:h,viewTransition:p})};return G.createElement("form",{ref:y,method:E,action:w,onSubmit:r?u:I,...m,"data-discover":!T&&t==="render"?"true":void 0})});Az.displayName="Form";function Cz(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function iN(t){let e=G.useContext(Nd);return mn(e,Cz(t)),e}function Iz(t,{target:e,replace:n,state:r,preventScrollReset:i,relative:a,viewTransition:o}={}){let c=as(),u=is(),d=mp(t,{relative:a});return G.useCallback(h=>{if(az(h,e)){h.preventDefault();let p=n!==void 0?n:Oh(u)===Oh(d);c(t,{replace:p,state:r,preventScrollReset:i,relative:a,viewTransition:o})}},[u,c,d,n,r,e,t,i,a,o])}function Dz(t){xi(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=G.useRef(vx(t)),n=G.useRef(!1),r=is(),i=G.useMemo(()=>sz(r.search,n.current?null:e.current),[r.search]),a=as(),o=G.useCallback((c,u)=>{const d=vx(typeof c=="function"?c(new URLSearchParams(i)):c);n.current=!0,a("?"+d,u)},[a,i]);return[i,o]}var Rz=0,kz=()=>`__${String(++Rz)}__`;function Nz(){let{router:t}=iN("useSubmit"),{basename:e}=G.useContext(ns),n=X6();return G.useCallback(async(r,i={})=>{let{action:a,method:o,encType:c,formData:u,body:d}=cz(r,e);if(i.navigate===!1){let h=i.fetcherKey||kz();await t.fetch(h,n,i.action||a,{preventScrollReset:i.preventScrollReset,formData:u,body:d,formMethod:i.method||o,formEncType:i.encType||c,flushSync:i.flushSync})}else await t.navigate(i.action||a,{preventScrollReset:i.preventScrollReset,formData:u,body:d,formMethod:i.method||o,formEncType:i.encType||c,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[t,e,n])}function Mz(t,{relative:e}={}){let{basename:n}=G.useContext(ns),r=G.useContext(rs);mn(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),a={...mp(t||".",{relative:e})},o=is();if(t==null){a.search=o.search;let c=new URLSearchParams(a.search),u=c.getAll("index");if(u.some(h=>h==="")){c.delete("index"),u.filter(p=>p).forEach(p=>c.append("index",p));let h=c.toString();a.search=h?`?${h}`:""}}return(!t||t===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(a.pathname=a.pathname==="/"?n:Ms([n,a.pathname])),Oh(a)}function Pz(t,{relative:e}={}){let n=G.useContext(Kk);mn(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=iN("useViewTransitionState"),i=mp(t,{relative:e});if(!n.isTransitioning)return!1;let a=zs(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=zs(n.nextLocation.pathname,r)||n.nextLocation.pathname;return _0(i.pathname,o)!=null||_0(i.pathname,a)!=null}const Oz=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Vz=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),vI=t=>{const e=Vz(t);return e.charAt(0).toUpperCase()+e.slice(1)},aN=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),jz=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var zz={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Lz=G.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:a,iconNode:o,...c},u)=>G.createElement("svg",{ref:u,...zz,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:aN("lucide",i),...!a&&!jz(c)&&{"aria-hidden":"true"},...c},[...o.map(([d,h])=>G.createElement(d,h)),...Array.isArray(a)?a:[a]]));const et=(t,e)=>{const n=G.forwardRef(({className:r,...i},a)=>G.createElement(Lz,{ref:a,iconNode:e,className:aN(`lucide-${Oz(vI(t))}`,`lucide-${t}`,r),...i}));return n.displayName=vI(t),n};const Bz=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Vh=et("arrow-left",Bz);const Fz=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],Uz=et("arrow-right-left",Fz);const Gz=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],qz=et("check",Gz);const Hz=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],sN=et("chevron-down",Hz);const $z=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Yz=et("chevron-left",$z);const Kz=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Nu=et("chevron-right",Kz);const Xz=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Wz=et("chevron-up",Xz);const Qz=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]],Zz=et("circle-arrow-down",Qz);const Jz=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],eL=et("circle-arrow-up",Jz);const tL=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],iw=et("circle-check-big",tL);const nL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],yI=et("circle-check",nL);const rL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],bm=et("circle-plus",rL);const iL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],bI=et("circle-question-mark",iL);const aL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],xI=et("circle",aL);const sL=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],oL=et("copy",sL);const lL=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],_I=et("download",lL);const cL=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],uL=et("eye-off",cL);const dL=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],fL=et("eye",dL);const hL=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],pL=et("file-text",hL);const gL=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],mL=et("folder-plus",gL);const vL=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],yL=et("funnel",vL);const bL=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],xL=et("house",bL);const _L=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],wL=et("list",_L);const SL=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],EL=et("loader-circle",SL);const TL=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],wI=et("loader",TL);const AL=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],CL=et("lock-open",AL);const IL=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],DL=et("lock",IL);const RL=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],kL=et("log-out",RL);const NL=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],yx=et("mail",NL);const ML=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],PL=et("pause",ML);const OL=[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]],jh=et("piggy-bank",OL);const VL=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],lc=et("refresh-cw",VL);const jL=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],zL=et("search",jL);const LL=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],oN=et("settings",LL);const BL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],FL=et("target",BL);const UL=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Wm=et("trash-2",UL);const GL=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],lN=et("trash",GL);const qL=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],HL=et("trending-down",qL);const $L=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],YL=et("trending-up",$L);const KL=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],vv=et("triangle-alert",KL);const XL=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],WL=et("undo-2",XL);const QL=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],ZL=et("upload",QL);const JL=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],e9=et("user-plus",JL);const t9=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],aw=et("wallet",t9);const n9=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],r9=et("wifi-off",n9);const i9=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],a9=et("wifi",i9);const s9=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],vp=et("x",s9),sw=G.createContext({});function yv(t){const e=G.useRef(null);return e.current===null&&(e.current=t()),e.current}const ow=typeof window<"u",lw=ow?G.useLayoutEffect:G.useEffect,bv=G.createContext(null);function cw(t,e){t.indexOf(e)===-1&&t.push(e)}function uw(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const Ls=(t,e,n)=>n>e?e:n<t?t:n;let dw=()=>{};const Bs={},cN=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function uN(t){return typeof t=="object"&&t!==null}const dN=t=>/^0[^.\s]+$/u.test(t);function fw(t){let e;return()=>(e===void 0&&(e=t()),e)}const $i=t=>t,o9=(t,e)=>n=>e(t(n)),yp=(...t)=>t.reduce(o9),zh=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r};class hw{constructor(){this.subscriptions=[]}add(e){return cw(this.subscriptions,e),()=>uw(this.subscriptions,e)}notify(e,n,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,n,r);else for(let a=0;a<i;a++){const o=this.subscriptions[a];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const qa=t=>t*1e3,qi=t=>t/1e3;function fN(t,e){return e?t*(1e3/e):0}const hN=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,l9=1e-7,c9=12;function u9(t,e,n,r,i){let a,o,c=0;do o=e+(n-e)/2,a=hN(o,r,i)-t,a>0?n=o:e=o;while(Math.abs(a)>l9&&++c<c9);return o}function bp(t,e,n,r){if(t===e&&n===r)return $i;const i=a=>u9(a,0,1,t,n);return a=>a===0||a===1?a:hN(i(a),e,r)}const pN=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,gN=t=>e=>1-t(1-e),mN=bp(.33,1.53,.69,.99),pw=gN(mN),vN=pN(pw),yN=t=>(t*=2)<1?.5*pw(t):.5*(2-Math.pow(2,-10*(t-1))),gw=t=>1-Math.sin(Math.acos(t)),bN=gN(gw),xN=pN(gw),d9=bp(.42,0,1,1),f9=bp(0,0,.58,1),_N=bp(.42,0,.58,1),h9=t=>Array.isArray(t)&&typeof t[0]!="number",wN=t=>Array.isArray(t)&&typeof t[0]=="number",p9={linear:$i,easeIn:d9,easeInOut:_N,easeOut:f9,circIn:gw,circInOut:xN,circOut:bN,backIn:pw,backInOut:vN,backOut:mN,anticipate:yN},g9=t=>typeof t=="string",SI=t=>{if(wN(t)){dw(t.length===4);const[e,n,r,i]=t;return bp(e,n,r,i)}else if(g9(t))return p9[t];return t},xm=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function m9(t,e){let n=new Set,r=new Set,i=!1,a=!1;const o=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function u(h){o.has(h)&&(d.schedule(h),t()),h(c)}const d={schedule:(h,p=!1,m=!1)=>{const _=m&&i?n:r;return p&&o.add(h),_.has(h)||_.add(h),h},cancel:h=>{r.delete(h),o.delete(h)},process:h=>{if(c=h,i){a=!0;return}i=!0,[n,r]=[r,n],n.forEach(u),n.clear(),i=!1,a&&(a=!1,d.process(h))}};return d}const v9=40;function SN(t,e){let n=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},a=()=>n=!0,o=xm.reduce((D,O)=>(D[O]=m9(a),D),{}),{setup:c,read:u,resolveKeyframes:d,preUpdate:h,update:p,preRender:m,render:y,postRender:_}=o,w=()=>{const D=Bs.useManualTiming?i.timestamp:performance.now();n=!1,Bs.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(D-i.timestamp,v9),1)),i.timestamp=D,i.isProcessing=!0,c.process(i),u.process(i),d.process(i),h.process(i),p.process(i),m.process(i),y.process(i),_.process(i),i.isProcessing=!1,n&&e&&(r=!1,t(w))},E=()=>{n=!0,r=!0,i.isProcessing||t(w)};return{schedule:xm.reduce((D,O)=>{const z=o[O];return D[O]=(P,A=!1,C=!1)=>(n||E(),z.schedule(P,A,C)),D},{}),cancel:D=>{for(let O=0;O<xm.length;O++)o[xm[O]].cancel(D)},state:i,steps:o}}const{schedule:cn,cancel:rl,state:mr,steps:b1}=SN(typeof requestAnimationFrame<"u"?requestAnimationFrame:$i,!0);let Qm;function y9(){Qm=void 0}const ni={now:()=>(Qm===void 0&&ni.set(mr.isProcessing||Bs.useManualTiming?mr.timestamp:performance.now()),Qm),set:t=>{Qm=t,queueMicrotask(y9)}},EN=t=>e=>typeof e=="string"&&e.startsWith(t),mw=EN("--"),b9=EN("var(--"),vw=t=>b9(t)?x9.test(t.split("/*")[0].trim()):!1,x9=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Md={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Lh={...Md,transform:t=>Ls(0,1,t)},_m={...Md,default:1},hh=t=>Math.round(t*1e5)/1e5,yw=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function _9(t){return t==null}const w9=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,bw=(t,e)=>n=>!!(typeof n=="string"&&w9.test(n)&&n.startsWith(t)||e&&!_9(n)&&Object.prototype.hasOwnProperty.call(n,e)),TN=(t,e,n)=>r=>{if(typeof r!="string")return r;const[i,a,o,c]=r.match(yw);return{[t]:parseFloat(i),[e]:parseFloat(a),[n]:parseFloat(o),alpha:c!==void 0?parseFloat(c):1}},S9=t=>Ls(0,255,t),x1={...Md,transform:t=>Math.round(S9(t))},ic={test:bw("rgb","red"),parse:TN("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+x1.transform(t)+", "+x1.transform(e)+", "+x1.transform(n)+", "+hh(Lh.transform(r))+")"};function E9(t){let e="",n="",r="",i="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),i=t.substring(4,5),e+=e,n+=n,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const bx={test:bw("#"),parse:E9,transform:ic.transform},xp=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),zo=xp("deg"),Ha=xp("%"),Ze=xp("px"),T9=xp("vh"),A9=xp("vw"),EI={...Ha,parse:t=>Ha.parse(t)/100,transform:t=>Ha.transform(t*100)},Bu={test:bw("hsl","hue"),parse:TN("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+Ha.transform(hh(e))+", "+Ha.transform(hh(n))+", "+hh(Lh.transform(r))+")"},Fn={test:t=>ic.test(t)||bx.test(t)||Bu.test(t),parse:t=>ic.test(t)?ic.parse(t):Bu.test(t)?Bu.parse(t):bx.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?ic.transform(t):Bu.transform(t),getAnimatableNone:t=>{const e=Fn.parse(t);return e.alpha=0,Fn.transform(e)}},C9=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function I9(t){return isNaN(t)&&typeof t=="string"&&(t.match(yw)?.length||0)+(t.match(C9)?.length||0)>0}const AN="number",CN="color",D9="var",R9="var(",TI="${}",k9=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Bh(t){const e=t.toString(),n=[],r={color:[],number:[],var:[]},i=[];let a=0;const c=e.replace(k9,u=>(Fn.test(u)?(r.color.push(a),i.push(CN),n.push(Fn.parse(u))):u.startsWith(R9)?(r.var.push(a),i.push(D9),n.push(u)):(r.number.push(a),i.push(AN),n.push(parseFloat(u))),++a,TI)).split(TI);return{values:n,split:c,indexes:r,types:i}}function IN(t){return Bh(t).values}function DN(t){const{split:e,types:n}=Bh(t),r=e.length;return i=>{let a="";for(let o=0;o<r;o++)if(a+=e[o],i[o]!==void 0){const c=n[o];c===AN?a+=hh(i[o]):c===CN?a+=Fn.transform(i[o]):a+=i[o]}return a}}const N9=t=>typeof t=="number"?0:Fn.test(t)?Fn.getAnimatableNone(t):t;function M9(t){const e=IN(t);return DN(t)(e.map(N9))}const il={test:I9,parse:IN,createTransformer:DN,getAnimatableNone:M9};function _1(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function P9({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let i=0,a=0,o=0;if(!e)i=a=o=n;else{const c=n<.5?n*(1+e):n+e-n*e,u=2*n-c;i=_1(u,c,t+1/3),a=_1(u,c,t),o=_1(u,c,t-1/3)}return{red:Math.round(i*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:r}}function w0(t,e){return n=>n>0?e:t}const pn=(t,e,n)=>t+(e-t)*n,w1=(t,e,n)=>{const r=t*t,i=n*(e*e-r)+r;return i<0?0:Math.sqrt(i)},O9=[bx,ic,Bu],V9=t=>O9.find(e=>e.test(t));function AI(t){const e=V9(t);if(!e)return!1;let n=e.parse(t);return e===Bu&&(n=P9(n)),n}const CI=(t,e)=>{const n=AI(t),r=AI(e);if(!n||!r)return w0(t,e);const i={...n};return a=>(i.red=w1(n.red,r.red,a),i.green=w1(n.green,r.green,a),i.blue=w1(n.blue,r.blue,a),i.alpha=pn(n.alpha,r.alpha,a),ic.transform(i))},xx=new Set(["none","hidden"]);function j9(t,e){return xx.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function z9(t,e){return n=>pn(t,e,n)}function xw(t){return typeof t=="number"?z9:typeof t=="string"?vw(t)?w0:Fn.test(t)?CI:F9:Array.isArray(t)?RN:typeof t=="object"?Fn.test(t)?CI:L9:w0}function RN(t,e){const n=[...t],r=n.length,i=t.map((a,o)=>xw(a)(a,e[o]));return a=>{for(let o=0;o<r;o++)n[o]=i[o](a);return n}}function L9(t,e){const n={...t,...e},r={};for(const i in n)t[i]!==void 0&&e[i]!==void 0&&(r[i]=xw(t[i])(t[i],e[i]));return i=>{for(const a in r)n[a]=r[a](i);return n}}function B9(t,e){const n=[],r={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const a=e.types[i],o=t.indexes[a][r[a]],c=t.values[o]??0;n[i]=c,r[a]++}return n}const F9=(t,e)=>{const n=il.createTransformer(e),r=Bh(t),i=Bh(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?xx.has(t)&&!i.values.length||xx.has(e)&&!r.values.length?j9(t,e):yp(RN(B9(r,i),i.values),n):w0(t,e)};function kN(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?pn(t,e,n):xw(t)(t,e)}const U9=t=>{const e=({timestamp:n})=>t(n);return{start:(n=!0)=>cn.update(e,n),stop:()=>rl(e),now:()=>mr.isProcessing?mr.timestamp:ni.now()}},NN=(t,e,n=10)=>{let r="";const i=Math.max(Math.round(e/n),2);for(let a=0;a<i;a++)r+=Math.round(t(a/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},S0=2e4;function _w(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<S0;)e+=n,r=t.next(e);return e>=S0?1/0:e}function G9(t,e=100,n){const r=n({...t,keyframes:[0,e]}),i=Math.min(_w(r),S0);return{type:"keyframes",ease:a=>r.next(i*a).value/e,duration:qi(i)}}const q9=5;function MN(t,e,n){const r=Math.max(e-q9,0);return fN(n-t(r),e-r)}const wn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},S1=.001;function H9({duration:t=wn.duration,bounce:e=wn.bounce,velocity:n=wn.velocity,mass:r=wn.mass}){let i,a,o=1-e;o=Ls(wn.minDamping,wn.maxDamping,o),t=Ls(wn.minDuration,wn.maxDuration,qi(t)),o<1?(i=d=>{const h=d*o,p=h*t,m=h-n,y=_x(d,o),_=Math.exp(-p);return S1-m/y*_},a=d=>{const p=d*o*t,m=p*n+n,y=Math.pow(o,2)*Math.pow(d,2)*t,_=Math.exp(-p),w=_x(Math.pow(d,2),o);return(-i(d)+S1>0?-1:1)*((m-y)*_)/w}):(i=d=>{const h=Math.exp(-d*t),p=(d-n)*t+1;return-S1+h*p},a=d=>{const h=Math.exp(-d*t),p=(n-d)*(t*t);return h*p});const c=5/t,u=Y9(i,a,c);if(t=qa(t),isNaN(u))return{stiffness:wn.stiffness,damping:wn.damping,duration:t};{const d=Math.pow(u,2)*r;return{stiffness:d,damping:o*2*Math.sqrt(r*d),duration:t}}}const $9=12;function Y9(t,e,n){let r=n;for(let i=1;i<$9;i++)r=r-t(r)/e(r);return r}function _x(t,e){return t*Math.sqrt(1-e*e)}const K9=["duration","bounce"],X9=["stiffness","damping","mass"];function II(t,e){return e.some(n=>t[n]!==void 0)}function W9(t){let e={velocity:wn.velocity,stiffness:wn.stiffness,damping:wn.damping,mass:wn.mass,isResolvedFromDuration:!1,...t};if(!II(t,X9)&&II(t,K9))if(t.visualDuration){const n=t.visualDuration,r=2*Math.PI/(n*1.2),i=r*r,a=2*Ls(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:wn.mass,stiffness:i,damping:a}}else{const n=H9(t);e={...e,...n,mass:wn.mass},e.isResolvedFromDuration=!0}return e}function E0(t=wn.visualDuration,e=wn.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:r,restDelta:i}=n;const a=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],c={done:!1,value:a},{stiffness:u,damping:d,mass:h,duration:p,velocity:m,isResolvedFromDuration:y}=W9({...n,velocity:-qi(n.velocity||0)}),_=m||0,w=d/(2*Math.sqrt(u*h)),E=o-a,T=qi(Math.sqrt(u/h)),I=Math.abs(E)<5;r||(r=I?wn.restSpeed.granular:wn.restSpeed.default),i||(i=I?wn.restDelta.granular:wn.restDelta.default);let D;if(w<1){const z=_x(T,w);D=P=>{const A=Math.exp(-w*T*P);return o-A*((_+w*T*E)/z*Math.sin(z*P)+E*Math.cos(z*P))}}else if(w===1)D=z=>o-Math.exp(-T*z)*(E+(_+T*E)*z);else{const z=T*Math.sqrt(w*w-1);D=P=>{const A=Math.exp(-w*T*P),C=Math.min(z*P,300);return o-A*((_+w*T*E)*Math.sinh(C)+z*E*Math.cosh(C))/z}}const O={calculatedDuration:y&&p||null,next:z=>{const P=D(z);if(y)c.done=z>=p;else{let A=z===0?_:0;w<1&&(A=z===0?qa(_):MN(D,z,P));const C=Math.abs(A)<=r,k=Math.abs(o-P)<=i;c.done=C&&k}return c.value=c.done?o:P,c},toString:()=>{const z=Math.min(_w(O),S0),P=NN(A=>O.next(z*A).value,z,30);return z+"ms "+P},toTransition:()=>{}};return O}E0.applyToOptions=t=>{const e=G9(t,100,E0);return t.ease=e.ease,t.duration=qa(e.duration),t.type="keyframes",t};function wx({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:a=500,modifyTarget:o,min:c,max:u,restDelta:d=.5,restSpeed:h}){const p=t[0],m={done:!1,value:p},y=C=>c!==void 0&&C<c||u!==void 0&&C>u,_=C=>c===void 0?u:u===void 0||Math.abs(c-C)<Math.abs(u-C)?c:u;let w=n*e;const E=p+w,T=o===void 0?E:o(E);T!==E&&(w=T-p);const I=C=>-w*Math.exp(-C/r),D=C=>T+I(C),O=C=>{const k=I(C),V=D(C);m.done=Math.abs(k)<=d,m.value=m.done?T:V};let z,P;const A=C=>{y(m.value)&&(z=C,P=E0({keyframes:[m.value,_(m.value)],velocity:MN(D,C,m.value),damping:i,stiffness:a,restDelta:d,restSpeed:h}))};return A(0),{calculatedDuration:null,next:C=>{let k=!1;return!P&&z===void 0&&(k=!0,O(C),A(C)),z!==void 0&&C>=z?P.next(C-z):(!k&&O(C),m)}}}function Q9(t,e,n){const r=[],i=n||Bs.mix||kN,a=t.length-1;for(let o=0;o<a;o++){let c=i(t[o],t[o+1]);if(e){const u=Array.isArray(e)?e[o]||$i:e;c=yp(u,c)}r.push(c)}return r}function Z9(t,e,{clamp:n=!0,ease:r,mixer:i}={}){const a=t.length;if(dw(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[a-1]&&(t=[...t].reverse(),e=[...e].reverse());const c=Q9(e,r,i),u=c.length,d=h=>{if(o&&h<t[0])return e[0];let p=0;if(u>1)for(;p<t.length-2&&!(h<t[p+1]);p++);const m=zh(t[p],t[p+1],h);return c[p](m)};return n?h=>d(Ls(t[0],t[a-1],h)):d}function J9(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const i=zh(0,e,r);t.push(pn(n,1,i))}}function eB(t){const e=[0];return J9(e,t.length-1),e}function tB(t,e){return t.map(n=>n*e)}function nB(t,e){return t.map(()=>e||_N).splice(0,t.length-1)}function ph({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const i=h9(r)?r.map(SI):SI(r),a={done:!1,value:e[0]},o=tB(n&&n.length===e.length?n:eB(e),t),c=Z9(o,e,{ease:Array.isArray(i)?i:nB(e,i)});return{calculatedDuration:t,next:u=>(a.value=c(u),a.done=u>=t,a)}}const rB=t=>t!==null;function ww(t,{repeat:e,repeatType:n="loop"},r,i=1){const a=t.filter(rB),c=i<0||e&&n!=="loop"&&e%2===1?0:a.length-1;return!c||r===void 0?a[c]:r}const iB={decay:wx,inertia:wx,tween:ph,keyframes:ph,spring:E0};function PN(t){typeof t.type=="string"&&(t.type=iB[t.type])}class Sw{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,n){return this.finished.then(e,n)}}const aB=t=>t/100;class Ew extends Sw{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;n&&n.updatedAt!==ni.now()&&this.tick(ni.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;PN(e);const{type:n=ph,repeat:r=0,repeatDelay:i=0,repeatType:a,velocity:o=0}=e;let{keyframes:c}=e;const u=n||ph;u!==ph&&typeof c[0]!="number"&&(this.mixKeyframes=yp(aB,kN(c[0],c[1])),c=[0,100]);const d=u({...e,keyframes:c});a==="mirror"&&(this.mirroredGenerator=u({...e,keyframes:[...c].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=_w(d));const{calculatedDuration:h}=d;this.calculatedDuration=h,this.resolvedDuration=h+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=d}updateTime(e){const n=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(e,n=!1){const{generator:r,totalDuration:i,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:c,calculatedDuration:u}=this;if(this.startTime===null)return r.next(0);const{delay:d=0,keyframes:h,repeat:p,repeatType:m,repeatDelay:y,type:_,onUpdate:w,finalKeyframe:E}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),n?this.currentTime=e:this.updateTime(e);const T=this.currentTime-d*(this.playbackSpeed>=0?1:-1),I=this.playbackSpeed>=0?T<0:T>i;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let D=this.currentTime,O=r;if(p){const C=Math.min(this.currentTime,i)/c;let k=Math.floor(C),V=C%1;!V&&C>=1&&(V=1),V===1&&k--,k=Math.min(k,p+1),!!(k%2)&&(m==="reverse"?(V=1-V,y&&(V-=y/c)):m==="mirror"&&(O=o)),D=Ls(0,1,V)*c}const z=I?{done:!1,value:h[0]}:O.next(D);a&&(z.value=a(z.value));let{done:P}=z;!I&&u!==null&&(P=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const A=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&P);return A&&_!==wx&&(z.value=ww(h,this.options,E,this.speed)),w&&w(z.value),A&&this.finish(),z}then(e,n){return this.finished.then(e,n)}get duration(){return qi(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+qi(e)}get time(){return qi(this.currentTime)}set time(e){e=qa(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(ni.now());const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=qi(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=U9,startTime:n}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=n??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ni.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function sB(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const ac=t=>t*180/Math.PI,Sx=t=>{const e=ac(Math.atan2(t[1],t[0]));return Ex(e)},oB={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:Sx,rotateZ:Sx,skewX:t=>ac(Math.atan(t[1])),skewY:t=>ac(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Ex=t=>(t=t%360,t<0&&(t+=360),t),DI=Sx,RI=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),kI=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),lB={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:RI,scaleY:kI,scale:t=>(RI(t)+kI(t))/2,rotateX:t=>Ex(ac(Math.atan2(t[6],t[5]))),rotateY:t=>Ex(ac(Math.atan2(-t[2],t[0]))),rotateZ:DI,rotate:DI,skewX:t=>ac(Math.atan(t[4])),skewY:t=>ac(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function Tx(t){return t.includes("scale")?1:0}function Ax(t,e){if(!t||t==="none")return Tx(e);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(n)r=lB,i=n;else{const c=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=oB,i=c}if(!i)return Tx(e);const a=r[e],o=i[1].split(",").map(uB);return typeof a=="function"?a(o):o[a]}const cB=(t,e)=>{const{transform:n="none"}=getComputedStyle(t);return Ax(n,e)};function uB(t){return parseFloat(t.trim())}const Pd=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Od=new Set(Pd),NI=t=>t===Md||t===Ze,dB=new Set(["x","y","z"]),fB=Pd.filter(t=>!dB.has(t));function hB(t){const e=[];return fB.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e}const cc={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>Ax(e,"x"),y:(t,{transform:e})=>Ax(e,"y")};cc.translateX=cc.x;cc.translateY=cc.y;const uc=new Set;let Cx=!1,Ix=!1,Dx=!1;function ON(){if(Ix){const t=Array.from(uc).filter(r=>r.needsMeasurement),e=new Set(t.map(r=>r.element)),n=new Map;e.forEach(r=>{const i=hB(r);i.length&&(n.set(r,i),r.render())}),t.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=n.get(r);i&&i.forEach(([a,o])=>{r.getValue(a)?.set(o)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}Ix=!1,Cx=!1,uc.forEach(t=>t.complete(Dx)),uc.clear()}function VN(){uc.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Ix=!0)})}function pB(){Dx=!0,VN(),ON(),Dx=!1}class Tw{constructor(e,n,r,i,a,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=r,this.motionValue=i,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(uc.add(this),Cx||(Cx=!0,cn.read(VN),cn.resolveKeyframes(ON))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:r,motionValue:i}=this;if(e[0]===null){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&n){const c=r.readValue(n,o);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}sB(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),uc.delete(this)}cancel(){this.state==="scheduled"&&(uc.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const gB=t=>t.startsWith("--");function mB(t,e,n){gB(e)?t.style.setProperty(e,n):t.style[e]=n}const vB=fw(()=>window.ScrollTimeline!==void 0),yB={};function bB(t,e){const n=fw(t);return()=>yB[e]??n()}const jN=bB(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),nh=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,MI={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:nh([0,.65,.55,1]),circOut:nh([.55,0,1,.45]),backIn:nh([.31,.01,.66,-.59]),backOut:nh([.33,1.53,.69,.99])};function zN(t,e){if(t)return typeof t=="function"?jN()?NN(t,e):"ease-out":wN(t)?nh(t):Array.isArray(t)?t.map(n=>zN(n,e)||MI.easeOut):MI[t]}function xB(t,e,n,{delay:r=0,duration:i=300,repeat:a=0,repeatType:o="loop",ease:c="easeOut",times:u}={},d=void 0){const h={[e]:n};u&&(h.offset=u);const p=zN(c,i);Array.isArray(p)&&(h.easing=p);const m={delay:r,duration:i,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};return d&&(m.pseudoElement=d),t.animate(h,m)}function LN(t){return typeof t=="function"&&"applyToOptions"in t}function _B({type:t,...e}){return LN(t)&&jN()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class wB extends Sw{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:n,name:r,keyframes:i,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:c,onComplete:u}=e;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=e,dw(typeof e.type!="string");const d=_B(e);this.animation=xB(n,r,i,d,a),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const h=ww(i,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(h):mB(n,r,h),this.animation.cancel()}u?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return qi(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+qi(e)}get time(){return qi(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=qa(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:n}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&vB()?(this.animation.timeline=e,$i):n(this)}}const BN={anticipate:yN,backInOut:vN,circInOut:xN};function SB(t){return t in BN}function EB(t){typeof t.ease=="string"&&SB(t.ease)&&(t.ease=BN[t.ease])}const PI=10;class TB extends wB{constructor(e){EB(e),PN(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:n,onUpdate:r,onComplete:i,element:a,...o}=this.options;if(!n)return;if(e!==void 0){n.set(e);return}const c=new Ew({...o,autoplay:!1}),u=qa(this.finishedTime??this.time);n.setWithVelocity(c.sample(u-PI).value,c.sample(u).value,PI),c.stop()}}const OI=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(il.test(t)||t==="0")&&!t.startsWith("url("));function AB(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function CB(t,e,n,r){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const a=t[t.length-1],o=OI(i,e),c=OI(a,e);return!o||!c?!1:AB(t)||(n==="spring"||LN(n))&&r}function Rx(t){t.duration=0,t.type="keyframes"}const IB=new Set(["opacity","clipPath","filter","transform"]),DB=fw(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function RB(t){const{motionValue:e,name:n,repeatDelay:r,repeatType:i,damping:a,type:o}=t;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:d}=e.owner.getProps();return DB()&&n&&IB.has(n)&&(n!=="transform"||!d)&&!u&&!r&&i!=="mirror"&&a!==0&&o!=="inertia"}const kB=40;class NB extends Sw{constructor({autoplay:e=!0,delay:n=0,type:r="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:o="loop",keyframes:c,name:u,motionValue:d,element:h,...p}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=ni.now();const m={autoplay:e,delay:n,type:r,repeat:i,repeatDelay:a,repeatType:o,name:u,motionValue:d,element:h,...p},y=h?.KeyframeResolver||Tw;this.keyframeResolver=new y(c,(_,w,E)=>this.onKeyframesResolved(_,w,m,!E),u,d,h),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,n,r,i){this.keyframeResolver=void 0;const{name:a,type:o,velocity:c,delay:u,isHandoff:d,onUpdate:h}=r;this.resolvedAt=ni.now(),CB(e,a,o,c)||((Bs.instantAnimations||!u)&&h?.(ww(e,r,n)),e[0]=e[e.length-1],Rx(r),r.repeat=0);const m={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>kB?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:e},y=!d&&RB(m)?new TB({...m,element:m.motionValue.owner.current}):new Ew(m);y.finished.then(()=>this.notifyFinished()).catch($i),this.pendingTimeline&&(this.stopTimeline=y.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=y}get finished(){return this._animation?this.animation.finished:this._finished}then(e,n){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),pB()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const MB=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function PB(t){const e=MB.exec(t);if(!e)return[,];const[,n,r,i]=e;return[`--${n??r}`,i]}function FN(t,e,n=1){const[r,i]=PB(t);if(!r)return;const a=window.getComputedStyle(e).getPropertyValue(r);if(a){const o=a.trim();return cN(o)?parseFloat(o):o}return vw(i)?FN(i,e,n+1):i}function Aw(t,e){return t?.[e]??t?.default??t}const UN=new Set(["width","height","top","left","right","bottom",...Pd]),OB={test:t=>t==="auto",parse:t=>t},GN=t=>e=>e.test(t),qN=[Md,Ze,Ha,zo,A9,T9,OB],VI=t=>qN.find(GN(t));function VB(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||dN(t):!0}const jB=new Set(["brightness","contrast","saturate","opacity"]);function zB(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(yw)||[];if(!r)return t;const i=n.replace(r,"");let a=jB.has(e)?1:0;return r!==n&&(a*=100),e+"("+a+i+")"}const LB=/\b([a-z-]*)\(.*?\)/gu,kx={...il,getAnimatableNone:t=>{const e=t.match(LB);return e?e.map(zB).join(" "):t}},jI={...Md,transform:Math.round},BB={rotate:zo,rotateX:zo,rotateY:zo,rotateZ:zo,scale:_m,scaleX:_m,scaleY:_m,scaleZ:_m,skew:zo,skewX:zo,skewY:zo,distance:Ze,translateX:Ze,translateY:Ze,translateZ:Ze,x:Ze,y:Ze,z:Ze,perspective:Ze,transformPerspective:Ze,opacity:Lh,originX:EI,originY:EI,originZ:Ze},Cw={borderWidth:Ze,borderTopWidth:Ze,borderRightWidth:Ze,borderBottomWidth:Ze,borderLeftWidth:Ze,borderRadius:Ze,radius:Ze,borderTopLeftRadius:Ze,borderTopRightRadius:Ze,borderBottomRightRadius:Ze,borderBottomLeftRadius:Ze,width:Ze,maxWidth:Ze,height:Ze,maxHeight:Ze,top:Ze,right:Ze,bottom:Ze,left:Ze,padding:Ze,paddingTop:Ze,paddingRight:Ze,paddingBottom:Ze,paddingLeft:Ze,margin:Ze,marginTop:Ze,marginRight:Ze,marginBottom:Ze,marginLeft:Ze,backgroundPositionX:Ze,backgroundPositionY:Ze,...BB,zIndex:jI,fillOpacity:Lh,strokeOpacity:Lh,numOctaves:jI},FB={...Cw,color:Fn,backgroundColor:Fn,outlineColor:Fn,fill:Fn,stroke:Fn,borderColor:Fn,borderTopColor:Fn,borderRightColor:Fn,borderBottomColor:Fn,borderLeftColor:Fn,filter:kx,WebkitFilter:kx},HN=t=>FB[t];function $N(t,e){let n=HN(t);return n!==kx&&(n=il),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const UB=new Set(["auto","none","0"]);function GB(t,e,n){let r=0,i;for(;r<t.length&&!i;){const a=t[r];typeof a=="string"&&!UB.has(a)&&Bh(a).values.length&&(i=t[r]),r++}if(i&&n)for(const a of e)t[a]=$N(n,i)}class qB extends Tw{constructor(e,n,r,i,a){super(e,n,r,i,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let d=e[u];if(typeof d=="string"&&(d=d.trim(),vw(d))){const h=FN(d,n.current);h!==void 0&&(e[u]=h),u===e.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!UN.has(r)||e.length!==2)return;const[i,a]=e,o=VI(i),c=VI(a);if(o!==c)if(NI(o)&&NI(c))for(let u=0;u<e.length;u++){const d=e[u];typeof d=="string"&&(e[u]=parseFloat(d))}else cc[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,r=[];for(let i=0;i<e.length;i++)(e[i]===null||VB(e[i]))&&r.push(i);r.length&&GB(e,r,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=cc[r](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const i=n[n.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){const{element:e,name:n,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const i=e.getValue(n);i&&i.jump(this.measuredOrigin,!1);const a=r.length-1,o=r[a];r[a]=cc[n](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([c,u])=>{e.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function HB(t,e,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let r=document;const i=n?.[t]??r.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}const YN=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function KN(t){return uN(t)&&"offsetHeight"in t}const zI=30,$B=t=>!isNaN(parseFloat(t));class YB{constructor(e,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const i=ni.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=ni.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=$B(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new hw);const r=this.events[e].add(n);return e==="change"?()=>{r(),cn.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ni.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>zI)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,zI);return fN(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ad(t,e){return new YB(t,e)}const{schedule:Iw}=SN(queueMicrotask,!1),la={x:!1,y:!1};function XN(){return la.x||la.y}function KB(t){return t==="x"||t==="y"?la[t]?null:(la[t]=!0,()=>{la[t]=!1}):la.x||la.y?null:(la.x=la.y=!0,()=>{la.x=la.y=!1})}function WN(t,e){const n=HB(t),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[n,i,()=>r.abort()]}function LI(t){return!(t.pointerType==="touch"||XN())}function XB(t,e,n={}){const[r,i,a]=WN(t,n),o=c=>{if(!LI(c))return;const{target:u}=c,d=e(u,c);if(typeof d!="function"||!u)return;const h=p=>{LI(p)&&(d(p),u.removeEventListener("pointerleave",h))};u.addEventListener("pointerleave",h,i)};return r.forEach(c=>{c.addEventListener("pointerenter",o,i)}),a}const QN=(t,e)=>e?t===e?!0:QN(t,e.parentElement):!1,Dw=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,WB=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function QB(t){return WB.has(t.tagName)||t.tabIndex!==-1}const Zm=new WeakSet;function BI(t){return e=>{e.key==="Enter"&&t(e)}}function E1(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const ZB=(t,e)=>{const n=t.currentTarget;if(!n)return;const r=BI(()=>{if(Zm.has(n))return;E1(n,"down");const i=BI(()=>{E1(n,"up")}),a=()=>E1(n,"cancel");n.addEventListener("keyup",i,e),n.addEventListener("blur",a,e)});n.addEventListener("keydown",r,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),e)};function FI(t){return Dw(t)&&!XN()}function JB(t,e,n={}){const[r,i,a]=WN(t,n),o=c=>{const u=c.currentTarget;if(!FI(c))return;Zm.add(u);const d=e(u,c),h=(y,_)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",m),Zm.has(u)&&Zm.delete(u),FI(y)&&typeof d=="function"&&d(y,{success:_})},p=y=>{h(y,u===window||u===document||n.useGlobalTarget||QN(u,y.target))},m=y=>{h(y,!1)};window.addEventListener("pointerup",p,i),window.addEventListener("pointercancel",m,i)};return r.forEach(c=>{(n.useGlobalTarget?window:c).addEventListener("pointerdown",o,i),KN(c)&&(c.addEventListener("focus",d=>ZB(d,i)),!QB(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),a}function ZN(t){return uN(t)&&"ownerSVGElement"in t}function eF(t){return ZN(t)&&t.tagName==="svg"}const Cr=t=>!!(t&&t.getVelocity),tF=[...qN,Fn,il],nF=t=>tF.find(GN(t)),Rw=G.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function UI(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function rF(...t){return e=>{let n=!1;const r=t.map(i=>{const a=UI(i,e);return!n&&typeof a=="function"&&(n=!0),a});if(n)return()=>{for(let i=0;i<r.length;i++){const a=r[i];typeof a=="function"?a():UI(t[i],null)}}}}function iF(...t){return G.useCallback(rF(...t),t)}class aF extends G.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=n.offsetParent,i=KN(r)&&r.offsetWidth||0,a=this.props.sizeRef.current;a.height=n.offsetHeight||0,a.width=n.offsetWidth||0,a.top=n.offsetTop,a.left=n.offsetLeft,a.right=i-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function sF({children:t,isPresent:e,anchorX:n,root:r}){const i=G.useId(),a=G.useRef(null),o=G.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=G.useContext(Rw),u=iF(a,t?.ref);return G.useInsertionEffect(()=>{const{width:d,height:h,top:p,left:m,right:y}=o.current;if(e||!a.current||!d||!h)return;const _=n==="left"?`left: ${m}`:`right: ${y}`;a.current.dataset.motionPopId=i;const w=document.createElement("style");c&&(w.nonce=c);const E=r??document.head;return E.appendChild(w),w.sheet&&w.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${h}px !important;
            ${_}px !important;
            top: ${p}px !important;
          }
        `),()=>{E.contains(w)&&E.removeChild(w)}},[e]),b.jsx(aF,{isPresent:e,childRef:a,sizeRef:o,children:G.cloneElement(t,{ref:u})})}const oF=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:i,presenceAffectsLayout:a,mode:o,anchorX:c,root:u})=>{const d=yv(lF),h=G.useId();let p=!0,m=G.useMemo(()=>(p=!1,{id:h,initial:e,isPresent:n,custom:i,onExitComplete:y=>{d.set(y,!0);for(const _ of d.values())if(!_)return;r&&r()},register:y=>(d.set(y,!1),()=>d.delete(y))}),[n,d,r]);return a&&p&&(m={...m}),G.useMemo(()=>{d.forEach((y,_)=>d.set(_,!1))},[n]),G.useEffect(()=>{!n&&!d.size&&r&&r()},[n]),o==="popLayout"&&(t=b.jsx(sF,{isPresent:n,anchorX:c,root:u,children:t})),b.jsx(bv.Provider,{value:m,children:t})};function lF(){return new Map}function JN(t=!0){const e=G.useContext(bv);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:i}=e,a=G.useId();G.useEffect(()=>{if(t)return i(a)},[t]);const o=G.useCallback(()=>t&&r&&r(a),[a,r,t]);return!n&&r?[!1,o]:[!0]}const wm=t=>t.key||"";function GI(t){const e=[];return G.Children.forEach(t,n=>{G.isValidElement(n)&&e.push(n)}),e}const vc=({children:t,custom:e,initial:n=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:a="sync",propagate:o=!1,anchorX:c="left",root:u})=>{const[d,h]=JN(o),p=G.useMemo(()=>GI(t),[t]),m=o&&!d?[]:p.map(wm),y=G.useRef(!0),_=G.useRef(p),w=yv(()=>new Map),[E,T]=G.useState(p),[I,D]=G.useState(p);lw(()=>{y.current=!1,_.current=p;for(let P=0;P<I.length;P++){const A=wm(I[P]);m.includes(A)?w.delete(A):w.get(A)!==!0&&w.set(A,!1)}},[I,m.length,m.join("-")]);const O=[];if(p!==E){let P=[...p];for(let A=0;A<I.length;A++){const C=I[A],k=wm(C);m.includes(k)||(P.splice(A,0,C),O.push(C))}return a==="wait"&&O.length&&(P=O),D(GI(P)),T(p),null}const{forceRender:z}=G.useContext(sw);return b.jsx(b.Fragment,{children:I.map(P=>{const A=wm(P),C=o&&!d?!1:p===I||m.includes(A),k=()=>{if(w.has(A))w.set(A,!0);else return;let V=!0;w.forEach(B=>{B||(V=!1)}),V&&(z?.(),D(_.current),o&&h?.(),r&&r())};return b.jsx(oF,{isPresent:C,initial:!y.current||n?void 0:!1,custom:e,presenceAffectsLayout:i,mode:a,root:u,onExitComplete:C?void 0:k,anchorX:c,children:P},A)})})},eM=G.createContext({strict:!1}),qI={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},sd={};for(const t in qI)sd[t]={isEnabled:e=>qI[t].some(n=>!!e[n])};function cF(t){for(const e in t)sd[e]={...sd[e],...t[e]}}const uF=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function T0(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||uF.has(t)}let tM=t=>!T0(t);function dF(t){typeof t=="function"&&(tM=e=>e.startsWith("on")?!T0(e):t(e))}try{dF(require("@emotion/is-prop-valid").default)}catch{}function fF(t,e,n){const r={};for(const i in t)i==="values"&&typeof t.values=="object"||(tM(i)||n===!0&&T0(i)||!e&&!T0(i)||t.draggable&&i.startsWith("onDrag"))&&(r[i]=t[i]);return r}const xv=G.createContext({});function _v(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Fh(t){return typeof t=="string"||Array.isArray(t)}const kw=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Nw=["initial",...kw];function wv(t){return _v(t.animate)||Nw.some(e=>Fh(t[e]))}function nM(t){return!!(wv(t)||t.variants)}function hF(t,e){if(wv(t)){const{initial:n,animate:r}=t;return{initial:n===!1||Fh(n)?n:void 0,animate:Fh(r)?r:void 0}}return t.inherit!==!1?e:{}}function pF(t){const{initial:e,animate:n}=hF(t,G.useContext(xv));return G.useMemo(()=>({initial:e,animate:n}),[HI(e),HI(n)])}function HI(t){return Array.isArray(t)?t.join(" "):t}const Uh={};function gF(t){for(const e in t)Uh[e]=t[e],mw(e)&&(Uh[e].isCSSVariable=!0)}function rM(t,{layout:e,layoutId:n}){return Od.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!Uh[t]||t==="opacity")}const mF={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},vF=Pd.length;function yF(t,e,n){let r="",i=!0;for(let a=0;a<vF;a++){const o=Pd[a],c=t[o];if(c===void 0)continue;let u=!0;if(typeof c=="number"?u=c===(o.startsWith("scale")?1:0):u=parseFloat(c)===0,!u||n){const d=YN(c,Cw[o]);if(!u){i=!1;const h=mF[o]||o;r+=`${h}(${d}) `}n&&(e[o]=d)}}return r=r.trim(),n?r=n(e,i?"":r):i&&(r="none"),r}function Mw(t,e,n){const{style:r,vars:i,transformOrigin:a}=t;let o=!1,c=!1;for(const u in e){const d=e[u];if(Od.has(u)){o=!0;continue}else if(mw(u)){i[u]=d;continue}else{const h=YN(d,Cw[u]);u.startsWith("origin")?(c=!0,a[u]=h):r[u]=h}}if(e.transform||(o||n?r.transform=yF(e,t.transform,n):r.transform&&(r.transform="none")),c){const{originX:u="50%",originY:d="50%",originZ:h=0}=a;r.transformOrigin=`${u} ${d} ${h}`}}const Pw=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function iM(t,e,n){for(const r in e)!Cr(e[r])&&!rM(r,n)&&(t[r]=e[r])}function bF({transformTemplate:t},e){return G.useMemo(()=>{const n=Pw();return Mw(n,e,t),Object.assign({},n.vars,n.style)},[e])}function xF(t,e){const n=t.style||{},r={};return iM(r,n,t),Object.assign(r,bF(t,e)),r}function _F(t,e){const n={},r=xF(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}const wF={offset:"stroke-dashoffset",array:"stroke-dasharray"},SF={offset:"strokeDashoffset",array:"strokeDasharray"};function EF(t,e,n=1,r=0,i=!0){t.pathLength=1;const a=i?wF:SF;t[a.offset]=Ze.transform(-r);const o=Ze.transform(e),c=Ze.transform(n);t[a.array]=`${o} ${c}`}function aM(t,{attrX:e,attrY:n,attrScale:r,pathLength:i,pathSpacing:a=1,pathOffset:o=0,...c},u,d,h){if(Mw(t,c,d),u){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:p,style:m}=t;p.transform&&(m.transform=p.transform,delete p.transform),(m.transform||p.transformOrigin)&&(m.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),m.transform&&(m.transformBox=h?.transformBox??"fill-box",delete p.transformBox),e!==void 0&&(p.x=e),n!==void 0&&(p.y=n),r!==void 0&&(p.scale=r),i!==void 0&&EF(p,i,a,o,!1)}const sM=()=>({...Pw(),attrs:{}}),oM=t=>typeof t=="string"&&t.toLowerCase()==="svg";function TF(t,e,n,r){const i=G.useMemo(()=>{const a=sM();return aM(a,e,oM(r),t.transformTemplate,t.style),{...a.attrs,style:{...a.style}}},[e]);if(t.style){const a={};iM(a,t.style,t),i.style={...a,...i.style}}return i}const AF=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Ow(t){return typeof t!="string"||t.includes("-")?!1:!!(AF.indexOf(t)>-1||/[A-Z]/u.test(t))}function CF(t,e,n,{latestValues:r},i,a=!1){const c=(Ow(t)?TF:_F)(e,r,i,t),u=fF(e,typeof t=="string",a),d=t!==G.Fragment?{...u,...c,ref:n}:{},{children:h}=e,p=G.useMemo(()=>Cr(h)?h.get():h,[h]);return G.createElement(t,{...d,children:p})}function $I(t){const e=[{},{}];return t?.values.forEach((n,r)=>{e[0][r]=n.get(),e[1][r]=n.getVelocity()}),e}function Vw(t,e,n,r){if(typeof e=="function"){const[i,a]=$I(r);e=e(n!==void 0?n:t.custom,i,a)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,a]=$I(r);e=e(n!==void 0?n:t.custom,i,a)}return e}function Jm(t){return Cr(t)?t.get():t}function IF({scrapeMotionValuesFromProps:t,createRenderState:e},n,r,i){return{latestValues:DF(n,r,i,t),renderState:e()}}function DF(t,e,n,r){const i={},a=r(t,{});for(const m in a)i[m]=Jm(a[m]);let{initial:o,animate:c}=t;const u=wv(t),d=nM(t);e&&d&&!u&&t.inherit!==!1&&(o===void 0&&(o=e.initial),c===void 0&&(c=e.animate));let h=n?n.initial===!1:!1;h=h||o===!1;const p=h?c:o;if(p&&typeof p!="boolean"&&!_v(p)){const m=Array.isArray(p)?p:[p];for(let y=0;y<m.length;y++){const _=Vw(t,m[y]);if(_){const{transitionEnd:w,transition:E,...T}=_;for(const I in T){let D=T[I];if(Array.isArray(D)){const O=h?D.length-1:0;D=D[O]}D!==null&&(i[I]=D)}for(const I in w)i[I]=w[I]}}}return i}const lM=t=>(e,n)=>{const r=G.useContext(xv),i=G.useContext(bv),a=()=>IF(t,e,r,i);return n?a():yv(a)};function jw(t,e,n){const{style:r}=t,i={};for(const a in r)(Cr(r[a])||e.style&&Cr(e.style[a])||rM(a,t)||n?.getValue(a)?.liveStyle!==void 0)&&(i[a]=r[a]);return i}const RF=lM({scrapeMotionValuesFromProps:jw,createRenderState:Pw});function cM(t,e,n){const r=jw(t,e,n);for(const i in t)if(Cr(t[i])||Cr(e[i])){const a=Pd.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[a]=t[i]}return r}const kF=lM({scrapeMotionValuesFromProps:cM,createRenderState:sM}),NF=Symbol.for("motionComponentSymbol");function Fu(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function MF(t,e,n){return G.useCallback(r=>{r&&t.onMount&&t.onMount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):Fu(n)&&(n.current=r))},[e])}const zw=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),PF="framerAppearId",uM="data-"+zw(PF),dM=G.createContext({});function OF(t,e,n,r,i){const{visualElement:a}=G.useContext(xv),o=G.useContext(eM),c=G.useContext(bv),u=G.useContext(Rw).reducedMotion,d=G.useRef(null);r=r||o.renderer,!d.current&&r&&(d.current=r(t,{visualState:e,parent:a,props:n,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const h=d.current,p=G.useContext(dM);h&&!h.projection&&i&&(h.type==="html"||h.type==="svg")&&VF(d.current,n,i,p);const m=G.useRef(!1);G.useInsertionEffect(()=>{h&&m.current&&h.update(n,c)});const y=n[uM],_=G.useRef(!!y&&!window.MotionHandoffIsComplete?.(y)&&window.MotionHasOptimisedAnimation?.(y));return lw(()=>{h&&(m.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),h.scheduleRenderMicrotask(),_.current&&h.animationState&&h.animationState.animateChanges())}),G.useEffect(()=>{h&&(!_.current&&h.animationState&&h.animationState.animateChanges(),_.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(y)}),_.current=!1),h.enteringChildren=void 0)}),h}function VF(t,e,n,r){const{layoutId:i,layout:a,drag:o,dragConstraints:c,layoutScroll:u,layoutRoot:d,layoutCrossfade:h}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:fM(t.parent)),t.projection.setOptions({layoutId:i,layout:a,alwaysMeasureLayout:!!o||c&&Fu(c),visualElement:t,animationType:typeof a=="string"?a:"both",initialPromotionConfig:r,crossfade:h,layoutScroll:u,layoutRoot:d})}function fM(t){if(t)return t.options.allowProjection!==!1?t.projection:fM(t.parent)}function T1(t,{forwardMotionProps:e=!1}={},n,r){n&&cF(n);const i=Ow(t)?kF:RF;function a(c,u){let d;const h={...G.useContext(Rw),...c,layoutId:jF(c)},{isStatic:p}=h,m=pF(c),y=i(c,p);if(!p&&ow){zF();const _=LF(h);d=_.MeasureLayout,m.visualElement=OF(t,y,h,r,_.ProjectionNode)}return b.jsxs(xv.Provider,{value:m,children:[d&&m.visualElement?b.jsx(d,{visualElement:m.visualElement,...h}):null,CF(t,c,MF(y,m.visualElement,u),y,p,e)]})}a.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const o=G.forwardRef(a);return o[NF]=t,o}function jF({layoutId:t}){const e=G.useContext(sw).id;return e&&t!==void 0?e+"-"+t:t}function zF(t,e){G.useContext(eM).strict}function LF(t){const{drag:e,layout:n}=sd;if(!e&&!n)return{};const r={...e,...n};return{MeasureLayout:e?.isEnabled(t)||n?.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function BF(t,e){if(typeof Proxy>"u")return T1;const n=new Map,r=(a,o)=>T1(a,o,t,e),i=(a,o)=>r(a,o);return new Proxy(i,{get:(a,o)=>o==="create"?r:(n.has(o)||n.set(o,T1(o,void 0,t,e)),n.get(o))})}function hM({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function FF({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function UF(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function A1(t){return t===void 0||t===1}function Nx({scale:t,scaleX:e,scaleY:n}){return!A1(t)||!A1(e)||!A1(n)}function $l(t){return Nx(t)||pM(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function pM(t){return YI(t.x)||YI(t.y)}function YI(t){return t&&t!=="0%"}function A0(t,e,n){const r=t-n,i=e*r;return n+i}function KI(t,e,n,r,i){return i!==void 0&&(t=A0(t,i,r)),A0(t,n,r)+e}function Mx(t,e=0,n=1,r,i){t.min=KI(t.min,e,n,r,i),t.max=KI(t.max,e,n,r,i)}function gM(t,{x:e,y:n}){Mx(t.x,e.translate,e.scale,e.originPoint),Mx(t.y,n.translate,n.scale,n.originPoint)}const XI=.999999999999,WI=1.0000000000001;function GF(t,e,n,r=!1){const i=n.length;if(!i)return;e.x=e.y=1;let a,o;for(let c=0;c<i;c++){a=n[c],o=a.projectionDelta;const{visualElement:u}=a.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Gu(t,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,gM(t,o)),r&&$l(a.latestValues)&&Gu(t,a.latestValues))}e.x<WI&&e.x>XI&&(e.x=1),e.y<WI&&e.y>XI&&(e.y=1)}function Uu(t,e){t.min=t.min+e,t.max=t.max+e}function QI(t,e,n,r,i=.5){const a=pn(t.min,t.max,i);Mx(t,e,n,a,r)}function Gu(t,e){QI(t.x,e.x,e.scaleX,e.scale,e.originX),QI(t.y,e.y,e.scaleY,e.scale,e.originY)}function mM(t,e){return hM(UF(t.getBoundingClientRect(),e))}function qF(t,e,n){const r=mM(t,n),{scroll:i}=e;return i&&(Uu(r.x,i.offset.x),Uu(r.y,i.offset.y)),r}const ZI=()=>({translate:0,scale:1,origin:0,originPoint:0}),qu=()=>({x:ZI(),y:ZI()}),JI=()=>({min:0,max:0}),Rn=()=>({x:JI(),y:JI()}),Px={current:null},vM={current:!1};function HF(){if(vM.current=!0,!!ow)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Px.current=t.matches;t.addEventListener("change",e),e()}else Px.current=!1}const $F=new WeakMap;function YF(t,e,n){for(const r in e){const i=e[r],a=n[r];if(Cr(i))t.addValue(r,i);else if(Cr(a))t.addValue(r,ad(i,{owner:t}));else if(a!==i)if(t.hasValue(r)){const o=t.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=t.getStaticValue(r);t.addValue(r,ad(o!==void 0?o:i,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const e2=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class KF{scrapeMotionValuesFromProps(e,n,r){return{}}constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:a,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Tw,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=ni.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,cn.render(this.render,!1,!0))};const{latestValues:u,renderState:d}=o;this.latestValues=u,this.baseTarget={...u},this.initialValues=n.initial?{...u}:{},this.renderState=d,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=c,this.blockInitialAnimation=!!a,this.isControllingVariants=wv(n),this.isVariantNode=nM(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...p}=this.scrapeMotionValuesFromProps(n,{},this);for(const m in p){const y=p[m];u[m]!==void 0&&Cr(y)&&y.set(u[m])}}mount(e){this.current=e,$F.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),vM.current||HF(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Px.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),rl(this.notifyUpdate),rl(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Od.has(e);r&&this.onBindTransform&&this.onBindTransform();const i=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&cn.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{i(),a&&a(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in sd){const n=sd[e];if(!n)continue;const{isEnabled:r,Feature:i}=n;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Rn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<e2.length;r++){const i=e2[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const a="on"+i,o=e[a];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=YF(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const r=this.values.get(e);n!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=ad(n===null?void 0:n,{owner:this}),this.addValue(e,r)),r}readValue(e,n){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(cN(r)||dN(r))?r=parseFloat(r):!nF(r)&&il.test(n)&&(r=$N(e,n)),this.setBaseTarget(e,Cr(r)?r.get():r)),Cr(r)?r.get():r}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const a=Vw(this.props,n,this.presenceContext?.custom);a&&(r=a[e])}if(n&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Cr(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new hw),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}scheduleRenderMicrotask(){Iw.render(this.render)}}class yM extends KF{constructor(){super(...arguments),this.KeyframeResolver=qB}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Cr(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function bM(t,{style:e,vars:n},r,i){const a=t.style;let o;for(o in e)a[o]=e[o];i?.applyProjectionStyles(a,r);for(o in n)a.setProperty(o,n[o])}function XF(t){return window.getComputedStyle(t)}class WF extends yM{constructor(){super(...arguments),this.type="html",this.renderInstance=bM}readValueFromInstance(e,n){if(Od.has(n))return this.projection?.isProjecting?Tx(n):cB(e,n);{const r=XF(e),i=(mw(n)?r.getPropertyValue(n):r[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return mM(e,n)}build(e,n,r){Mw(e,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,n,r){return jw(e,n,r)}}const xM=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function QF(t,e,n,r){bM(t,e,void 0,r);for(const i in e.attrs)t.setAttribute(xM.has(i)?i:zw(i),e.attrs[i])}class ZF extends yM{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Rn}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Od.has(n)){const r=HN(n);return r&&r.default||0}return n=xM.has(n)?n:zw(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,r){return cM(e,n,r)}build(e,n,r){aM(e,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,n,r,i){QF(e,n,r,i)}mount(e){this.isSVGTag=oM(e.tagName),super.mount(e)}}const JF=(t,e)=>Ow(t)?new ZF(e):new WF(e,{allowProjection:t!==G.Fragment});function Ju(t,e,n){const r=t.getProps();return Vw(r,e,n!==void 0?n:r.custom,t)}const Ox=t=>Array.isArray(t);function e8(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,ad(n))}function t8(t){return Ox(t)?t[t.length-1]||0:t}function Lw(t,e){const n=Ju(t,e);let{transitionEnd:r={},transition:i={},...a}=n||{};a={...a,...r};for(const o in a){const c=t8(a[o]);e8(t,o,c)}}function n8(t){return!!(Cr(t)&&t.add)}function Vx(t,e){const n=t.getValue("willChange");if(n8(n))return n.add(e);if(!n&&Bs.WillChange){const r=new Bs.WillChange("auto");t.addValue("willChange",r),r.add(e)}}function _M(t){return t.props[uM]}const r8=t=>t!==null;function i8(t,{repeat:e,repeatType:n="loop"},r){const i=t.filter(r8),a=e&&n!=="loop"&&e%2===1?0:i.length-1;return i[a]}const a8={type:"spring",stiffness:500,damping:25,restSpeed:10},s8=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),o8={type:"keyframes",duration:.8},l8={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},c8=(t,{keyframes:e})=>e.length>2?o8:Od.has(t)?t.startsWith("scale")?s8(e[1]):a8:l8;function u8({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:i,repeat:a,repeatType:o,repeatDelay:c,from:u,elapsed:d,...h}){return!!Object.keys(h).length}const Bw=(t,e,n,r={},i,a)=>o=>{const c=Aw(r,t)||{},u=c.delay||r.delay||0;let{elapsed:d=0}=r;d=d-qa(u);const h={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...c,delay:-d,onUpdate:m=>{e.set(m),c.onUpdate&&c.onUpdate(m)},onComplete:()=>{o(),c.onComplete&&c.onComplete()},name:t,motionValue:e,element:a?void 0:i};u8(c)||Object.assign(h,c8(t,h)),h.duration&&(h.duration=qa(h.duration)),h.repeatDelay&&(h.repeatDelay=qa(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let p=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(Rx(h),h.delay===0&&(p=!0)),(Bs.instantAnimations||Bs.skipAnimations)&&(p=!0,Rx(h),h.delay=0),h.allowFlatten=!c.type&&!c.ease,p&&!a&&e.get()!==void 0){const m=i8(h.keyframes,c);if(m!==void 0){cn.update(()=>{h.onUpdate(m),h.onComplete()});return}}return c.isSync?new Ew(h):new NB(h)};function d8({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function wM(t,e,{delay:n=0,transitionOverride:r,type:i}={}){let{transition:a=t.getDefaultTransition(),transitionEnd:o,...c}=e;r&&(a=r);const u=[],d=i&&t.animationState&&t.animationState.getState()[i];for(const h in c){const p=t.getValue(h,t.latestValues[h]??null),m=c[h];if(m===void 0||d&&d8(d,h))continue;const y={delay:n,...Aw(a||{},h)},_=p.get();if(_!==void 0&&!p.isAnimating&&!Array.isArray(m)&&m===_&&!y.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const T=_M(t);if(T){const I=window.MotionHandoffAnimation(T,h,cn);I!==null&&(y.startTime=I,w=!0)}}Vx(t,h),p.start(Bw(h,p,m,t.shouldReduceMotion&&UN.has(h)?{type:!1}:y,t,w));const E=p.animation;E&&u.push(E)}return o&&Promise.all(u).then(()=>{cn.update(()=>{o&&Lw(t,o)})}),u}function SM(t,e,n,r=0,i=1){const a=Array.from(t).sort((d,h)=>d.sortNodePosition(h)).indexOf(e),o=t.size,c=(o-1)*r;return typeof n=="function"?n(a,o):i===1?a*r:c-a*r}function jx(t,e,n={}){const r=Ju(t,e,n.type==="exit"?t.presenceContext?.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(i=n.transitionOverride);const a=r?()=>Promise.all(wM(t,r,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:h,staggerDirection:p}=i;return f8(t,e,u,d,h,p,n)}:()=>Promise.resolve(),{when:c}=i;if(c){const[u,d]=c==="beforeChildren"?[a,o]:[o,a];return u().then(()=>d())}else return Promise.all([a(),o(n.delay)])}function f8(t,e,n=0,r=0,i=0,a=1,o){const c=[];for(const u of t.variantChildren)u.notify("AnimationStart",e),c.push(jx(u,e,{...o,delay:n+(typeof r=="function"?0:r)+SM(t.variantChildren,u,r,i,a)}).then(()=>u.notify("AnimationComplete",e)));return Promise.all(c)}function EM(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(a=>jx(t,a,n));r=Promise.all(i)}else if(typeof e=="string")r=jx(t,e,n);else{const i=typeof e=="function"?Ju(t,e,n.custom):e;r=Promise.all(wM(t,i,n))}return r.then(()=>{t.notify("AnimationComplete",e)})}function TM(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}const h8=Nw.length;function AM(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?AM(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<h8;n++){const r=Nw[n],i=t.props[r];(Fh(i)||i===!1)&&(e[r]=i)}return e}const p8=[...kw].reverse(),g8=kw.length;function m8(t){return e=>Promise.all(e.map(({animation:n,options:r})=>EM(t,n,r)))}function v8(t){let e=m8(t),n=t2(),r=!0;const i=u=>(d,h)=>{const p=Ju(t,h,u==="exit"?t.presenceContext?.custom:void 0);if(p){const{transition:m,transitionEnd:y,..._}=p;d={...d,..._,...y}}return d};function a(u){e=u(t)}function o(u){const{props:d}=t,h=AM(t.parent)||{},p=[],m=new Set;let y={},_=1/0;for(let E=0;E<g8;E++){const T=p8[E],I=n[T],D=d[T]!==void 0?d[T]:h[T],O=Fh(D),z=T===u?I.isActive:null;z===!1&&(_=E);let P=D===h[T]&&D!==d[T]&&O;if(P&&r&&t.manuallyAnimateOnMount&&(P=!1),I.protectedKeys={...y},!I.isActive&&z===null||!D&&!I.prevProp||_v(D)||typeof D=="boolean")continue;const A=y8(I.prevProp,D);let C=A||T===u&&I.isActive&&!P&&O||E>_&&O,k=!1;const V=Array.isArray(D)?D:[D];let B=V.reduce(i(T),{});z===!1&&(B={});const{prevResolvedValues:j={}}=I,N={...j,...B},K=H=>{C=!0,m.has(H)&&(k=!0,m.delete(H)),I.needsAnimating[H]=!0;const te=t.getValue(H);te&&(te.liveStyle=!1)};for(const H in N){const te=B[H],re=j[H];if(y.hasOwnProperty(H))continue;let ue=!1;Ox(te)&&Ox(re)?ue=!TM(te,re):ue=te!==re,ue?te!=null?K(H):m.add(H):te!==void 0&&m.has(H)?K(H):I.protectedKeys[H]=!0}I.prevProp=D,I.prevResolvedValues=B,I.isActive&&(y={...y,...B}),r&&t.blockInitialAnimation&&(C=!1);const W=P&&A;C&&(!W||k)&&p.push(...V.map(H=>{const te={type:T};if(typeof H=="string"&&r&&!W&&t.manuallyAnimateOnMount&&t.parent){const{parent:re}=t,ue=Ju(re,H);if(re.enteringChildren&&ue){const{delayChildren:F}=ue.transition||{};te.delay=SM(re.enteringChildren,t,F)}}return{animation:H,options:te}}))}if(m.size){const E={};if(typeof d.initial!="boolean"){const T=Ju(t,Array.isArray(d.initial)?d.initial[0]:d.initial);T&&T.transition&&(E.transition=T.transition)}m.forEach(T=>{const I=t.getBaseTarget(T),D=t.getValue(T);D&&(D.liveStyle=!0),E[T]=I??null}),p.push({animation:E})}let w=!!p.length;return r&&(d.initial===!1||d.initial===d.animate)&&!t.manuallyAnimateOnMount&&(w=!1),r=!1,w?e(p):Promise.resolve()}function c(u,d){if(n[u].isActive===d)return Promise.resolve();t.variantChildren?.forEach(p=>p.animationState?.setActive(u,d)),n[u].isActive=d;const h=o(u);for(const p in n)n[p].protectedKeys={};return h}return{animateChanges:o,setActive:c,setAnimateFunction:a,getState:()=>n,reset:()=>{n=t2()}}}function y8(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!TM(e,t):!1}function ql(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function t2(){return{animate:ql(!0),whileInView:ql(),whileHover:ql(),whileTap:ql(),whileDrag:ql(),whileFocus:ql(),exit:ql()}}class hl{constructor(e){this.isMounted=!1,this.node=e}update(){}}class b8 extends hl{constructor(e){super(e),e.animationState||(e.animationState=v8(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();_v(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let x8=0;class _8 extends hl{constructor(){super(...arguments),this.id=x8++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);n&&!e&&i.then(()=>{n(this.id)})}mount(){const{register:e,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const w8={animation:{Feature:b8},exit:{Feature:_8}};function Gh(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}function _p(t){return{point:{x:t.pageX,y:t.pageY}}}const S8=t=>e=>Dw(e)&&t(e,_p(e));function gh(t,e,n,r){return Gh(t,e,S8(n),r)}const CM=1e-4,E8=1-CM,T8=1+CM,IM=.01,A8=0-IM,C8=0+IM;function zr(t){return t.max-t.min}function I8(t,e,n){return Math.abs(t-e)<=n}function n2(t,e,n,r=.5){t.origin=r,t.originPoint=pn(e.min,e.max,t.origin),t.scale=zr(n)/zr(e),t.translate=pn(n.min,n.max,t.origin)-t.originPoint,(t.scale>=E8&&t.scale<=T8||isNaN(t.scale))&&(t.scale=1),(t.translate>=A8&&t.translate<=C8||isNaN(t.translate))&&(t.translate=0)}function mh(t,e,n,r){n2(t.x,e.x,n.x,r?r.originX:void 0),n2(t.y,e.y,n.y,r?r.originY:void 0)}function r2(t,e,n){t.min=n.min+e.min,t.max=t.min+zr(e)}function D8(t,e,n){r2(t.x,e.x,n.x),r2(t.y,e.y,n.y)}function i2(t,e,n){t.min=e.min-n.min,t.max=t.min+zr(e)}function vh(t,e,n){i2(t.x,e.x,n.x),i2(t.y,e.y,n.y)}function Li(t){return[t("x"),t("y")]}const DM=({current:t})=>t?t.ownerDocument.defaultView:null,a2=(t,e)=>Math.abs(t-e);function R8(t,e){const n=a2(t.x,e.x),r=a2(t.y,e.y);return Math.sqrt(n**2+r**2)}class RM{constructor(e,n,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:a=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=I1(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,_=R8(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!y&&!_)return;const{point:w}=m,{timestamp:E}=mr;this.history.push({...w,timestamp:E});const{onStart:T,onMove:I}=this.handlers;y||(T&&T(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),I&&I(this.lastMoveEvent,m)},this.handlePointerMove=(m,y)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=C1(y,this.transformPagePoint),cn.update(this.updatePoint,!0)},this.handlePointerUp=(m,y)=>{this.end();const{onEnd:_,onSessionEnd:w,resumeAnimation:E}=this.handlers;if(this.dragSnapToOrigin&&E&&E(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=I1(m.type==="pointercancel"?this.lastMoveEventInfo:C1(y,this.transformPagePoint),this.history);this.startEvent&&_&&_(m,T),w&&w(m,T)},!Dw(e))return;this.dragSnapToOrigin=a,this.handlers=n,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=i||window;const c=_p(e),u=C1(c,this.transformPagePoint),{point:d}=u,{timestamp:h}=mr;this.history=[{...d,timestamp:h}];const{onSessionStart:p}=n;p&&p(e,I1(u,this.history)),this.removeListeners=yp(gh(this.contextWindow,"pointermove",this.handlePointerMove),gh(this.contextWindow,"pointerup",this.handlePointerUp),gh(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),rl(this.updatePoint)}}function C1(t,e){return e?{point:e(t.point)}:t}function s2(t,e){return{x:t.x-e.x,y:t.y-e.y}}function I1({point:t},e){return{point:t,delta:s2(t,kM(e)),offset:s2(t,k8(e)),velocity:N8(e,.1)}}function k8(t){return t[0]}function kM(t){return t[t.length-1]}function N8(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const i=kM(t);for(;n>=0&&(r=t[n],!(i.timestamp-r.timestamp>qa(e)));)n--;if(!r)return{x:0,y:0};const a=qi(i.timestamp-r.timestamp);if(a===0)return{x:0,y:0};const o={x:(i.x-r.x)/a,y:(i.y-r.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function M8(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?pn(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?pn(n,t,r.max):Math.min(t,n)),t}function o2(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function P8(t,{top:e,left:n,bottom:r,right:i}){return{x:o2(t.x,n,i),y:o2(t.y,e,r)}}function l2(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function O8(t,e){return{x:l2(t.x,e.x),y:l2(t.y,e.y)}}function V8(t,e){let n=.5;const r=zr(t),i=zr(e);return i>r?n=zh(e.min,e.max-r,t.min):r>i&&(n=zh(t.min,t.max-i,e.min)),Ls(0,1,n)}function j8(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const zx=.35;function z8(t=zx){return t===!1?t=0:t===!0&&(t=zx),{x:c2(t,"left","right"),y:c2(t,"top","bottom")}}function c2(t,e,n){return{min:u2(t,e),max:u2(t,n)}}function u2(t,e){return typeof t=="number"?t:t[e]||0}const L8=new WeakMap;class B8{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Rn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:n=!1,distanceThreshold:r}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const a=p=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(_p(p).point)},o=(p,m)=>{const{drag:y,dragPropagation:_,onDragStart:w}=this.getProps();if(y&&!_&&(this.openDragLock&&this.openDragLock(),this.openDragLock=KB(y),!this.openDragLock))return;this.latestPointerEvent=p,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Li(T=>{let I=this.getAxisMotionValue(T).get()||0;if(Ha.test(I)){const{projection:D}=this.visualElement;if(D&&D.layout){const O=D.layout.layoutBox[T];O&&(I=zr(O)*(parseFloat(I)/100))}}this.originPoint[T]=I}),w&&cn.postRender(()=>w(p,m)),Vx(this.visualElement,"transform");const{animationState:E}=this.visualElement;E&&E.setActive("whileDrag",!0)},c=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m;const{dragPropagation:y,dragDirectionLock:_,onDirectionLock:w,onDrag:E}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:T}=m;if(_&&this.currentDirection===null){this.currentDirection=F8(T),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",m.point,T),this.updateAxis("y",m.point,T),this.visualElement.render(),E&&E(p,m)},u=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m,this.stop(p,m),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>Li(p=>this.getAnimationState(p)==="paused"&&this.getAxisMotionValue(p).animation?.play()),{dragSnapToOrigin:h}=this.getProps();this.panSession=new RM(e,{onSessionStart:a,onStart:o,onMove:c,onSessionEnd:u,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,distanceThreshold:r,contextWindow:DM(this.visualElement)})}stop(e,n){const r=e||this.latestPointerEvent,i=n||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!i||!r)return;const{velocity:o}=i;this.startAnimation(o);const{onDragEnd:c}=this.getProps();c&&cn.postRender(()=>c(r,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:i}=this.getProps();if(!r||!Sm(e,i,this.currentDirection))return;const a=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=M8(o,this.constraints[e],this.elastic[e])),a.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,i=this.constraints;e&&Fu(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=P8(r.layoutBox,e):this.constraints=!1,this.elastic=z8(n),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Li(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=j8(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Fu(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const a=qF(r,i.root,this.visualElement.getTransformPagePoint());let o=O8(i.layout.layoutBox,a);if(n){const c=n(FF(o));this.hasMutatedConstraints=!!c,c&&(o=hM(c))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:i,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:c}=this.getProps(),u=this.constraints||{},d=Li(h=>{if(!Sm(h,n,this.currentDirection))return;let p=u&&u[h]||{};o&&(p={min:0,max:0});const m=i?200:1e6,y=i?40:1e7,_={type:"inertia",velocity:r?e[h]:0,bounceStiffness:m,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...a,...p};return this.startAxisValueAnimation(h,_)});return Promise.all(d).then(c)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return Vx(this.visualElement,e),r.start(Bw(e,r,0,n,this.visualElement,!1))}stopAnimation(){Li(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Li(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[n];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Li(n=>{const{drag:r}=this.getProps();if(!Sm(n,r,this.currentDirection))return;const{projection:i}=this.visualElement,a=this.getAxisMotionValue(n);if(i&&i.layout){const{min:o,max:c}=i.layout.layoutBox[n];a.set(e[n]-pn(o,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!Fu(n)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Li(o=>{const c=this.getAxisMotionValue(o);if(c&&this.constraints!==!1){const u=c.get();i[o]=V8({min:u,max:u},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Li(o=>{if(!Sm(o,e,null))return;const c=this.getAxisMotionValue(o),{min:u,max:d}=this.constraints[o];c.set(pn(u,d,i[o]))})}addListeners(){if(!this.visualElement.current)return;L8.set(this.visualElement,this);const e=this.visualElement.current,n=gh(e,"pointerdown",u=>{const{drag:d,dragListener:h=!0}=this.getProps();d&&h&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();Fu(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,a=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),cn.read(r);const o=Gh(window,"resize",()=>this.scalePositionWithinConstraints()),c=i.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:d})=>{this.isDragging&&d&&(Li(h=>{const p=this.getAxisMotionValue(h);p&&(this.originPoint[h]+=u[h].translate,p.set(p.get()+u[h].translate))}),this.visualElement.render())}));return()=>{o(),n(),a(),c&&c()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:a=!1,dragElastic:o=zx,dragMomentum:c=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:i,dragConstraints:a,dragElastic:o,dragMomentum:c}}}function Sm(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function F8(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class U8 extends hl{constructor(e){super(e),this.removeGroupControls=$i,this.removeListeners=$i,this.controls=new B8(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||$i}unmount(){this.removeGroupControls(),this.removeListeners()}}const d2=t=>(e,n)=>{t&&cn.postRender(()=>t(e,n))};class G8 extends hl{constructor(){super(...arguments),this.removePointerDownListener=$i}onPointerDown(e){this.session=new RM(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:DM(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:d2(e),onStart:d2(n),onMove:r,onEnd:(a,o)=>{delete this.session,i&&cn.postRender(()=>i(a,o))}}}mount(){this.removePointerDownListener=gh(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const e0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function f2(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Xf={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Ze.test(t))t=parseFloat(t);else return t;const n=f2(t,e.target.x),r=f2(t,e.target.y);return`${n}% ${r}%`}},q8={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,i=il.parse(t);if(i.length>5)return r;const a=il.createTransformer(t),o=typeof i[0]!="number"?1:0,c=n.x.scale*e.x,u=n.y.scale*e.y;i[0+o]/=c,i[1+o]/=u;const d=pn(c,u,.5);return typeof i[2+o]=="number"&&(i[2+o]/=d),typeof i[3+o]=="number"&&(i[3+o]/=d),a(i)}};let D1=!1;class H8 extends G.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:i}=this.props,{projection:a}=e;gF($8),a&&(n.group&&n.group.add(a),r&&r.register&&i&&r.register(a),D1&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),e0.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:i,isPresent:a}=this.props,{projection:o}=r;return o&&(o.isPresent=a,D1=!0,i||e.layoutDependency!==n||n===void 0||e.isPresent!==a?o.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?o.promote():o.relegate()||cn.postRender(()=>{const c=o.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Iw.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:i}=e;D1=!0,i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function NM(t){const[e,n]=JN(),r=G.useContext(sw);return b.jsx(H8,{...t,layoutGroup:r,switchLayoutGroup:G.useContext(dM),isPresent:e,safeToRemove:n})}const $8={borderRadius:{...Xf,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Xf,borderTopRightRadius:Xf,borderBottomLeftRadius:Xf,borderBottomRightRadius:Xf,boxShadow:q8};function Y8(t,e,n){const r=Cr(t)?t:ad(t);return r.start(Bw("",r,e,n)),r.animation}const K8=(t,e)=>t.depth-e.depth;class X8{constructor(){this.children=[],this.isDirty=!1}add(e){cw(this.children,e),this.isDirty=!0}remove(e){uw(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(K8),this.isDirty=!1,this.children.forEach(e)}}function W8(t,e){const n=ni.now(),r=({timestamp:i})=>{const a=i-n;a>=e&&(rl(r),t(a-e))};return cn.setup(r,!0),()=>rl(r)}const MM=["TopLeft","TopRight","BottomLeft","BottomRight"],Q8=MM.length,h2=t=>typeof t=="string"?parseFloat(t):t,p2=t=>typeof t=="number"||Ze.test(t);function Z8(t,e,n,r,i,a){i?(t.opacity=pn(0,n.opacity??1,J8(r)),t.opacityExit=pn(e.opacity??1,0,eU(r))):a&&(t.opacity=pn(e.opacity??1,n.opacity??1,r));for(let o=0;o<Q8;o++){const c=`border${MM[o]}Radius`;let u=g2(e,c),d=g2(n,c);if(u===void 0&&d===void 0)continue;u||(u=0),d||(d=0),u===0||d===0||p2(u)===p2(d)?(t[c]=Math.max(pn(h2(u),h2(d),r),0),(Ha.test(d)||Ha.test(u))&&(t[c]+="%")):t[c]=d}(e.rotate||n.rotate)&&(t.rotate=pn(e.rotate||0,n.rotate||0,r))}function g2(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const J8=PM(0,.5,bN),eU=PM(.5,.95,$i);function PM(t,e,n){return r=>r<t?0:r>e?1:n(zh(t,e,r))}function m2(t,e){t.min=e.min,t.max=e.max}function Vi(t,e){m2(t.x,e.x),m2(t.y,e.y)}function v2(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function y2(t,e,n,r,i){return t-=e,t=A0(t,1/n,r),i!==void 0&&(t=A0(t,1/i,r)),t}function tU(t,e=0,n=1,r=.5,i,a=t,o=t){if(Ha.test(e)&&(e=parseFloat(e),e=pn(o.min,o.max,e/100)-o.min),typeof e!="number")return;let c=pn(a.min,a.max,r);t===a&&(c-=e),t.min=y2(t.min,e,n,c,i),t.max=y2(t.max,e,n,c,i)}function b2(t,e,[n,r,i],a,o){tU(t,e[n],e[r],e[i],e.scale,a,o)}const nU=["x","scaleX","originX"],rU=["y","scaleY","originY"];function x2(t,e,n,r){b2(t.x,e,nU,n?n.x:void 0,r?r.x:void 0),b2(t.y,e,rU,n?n.y:void 0,r?r.y:void 0)}function _2(t){return t.translate===0&&t.scale===1}function OM(t){return _2(t.x)&&_2(t.y)}function w2(t,e){return t.min===e.min&&t.max===e.max}function iU(t,e){return w2(t.x,e.x)&&w2(t.y,e.y)}function S2(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function VM(t,e){return S2(t.x,e.x)&&S2(t.y,e.y)}function E2(t){return zr(t.x)/zr(t.y)}function T2(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class aU{constructor(){this.members=[]}add(e){cw(this.members,e),e.scheduleRender()}remove(e){if(uw(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(i=>e===i);if(n===0)return!1;let r;for(let i=n;i>=0;i--){const a=this.members[i];if(a.isPresent!==!1){r=a;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function sU(t,e,n){let r="";const i=t.x.translate/e.x,a=t.y.translate/e.y,o=n?.z||0;if((i||a||o)&&(r=`translate3d(${i}px, ${a}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:d,rotate:h,rotateX:p,rotateY:m,skewX:y,skewY:_}=n;d&&(r=`perspective(${d}px) ${r}`),h&&(r+=`rotate(${h}deg) `),p&&(r+=`rotateX(${p}deg) `),m&&(r+=`rotateY(${m}deg) `),y&&(r+=`skewX(${y}deg) `),_&&(r+=`skewY(${_}deg) `)}const c=t.x.scale*e.x,u=t.y.scale*e.y;return(c!==1||u!==1)&&(r+=`scale(${c}, ${u})`),r||"none"}const R1=["","X","Y","Z"],oU=1e3;let lU=0;function k1(t,e,n,r){const{latestValues:i}=e;i[t]&&(n[t]=i[t],e.setStaticValue(t,0),r&&(r[t]=0))}function jM(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=_M(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:i,layoutId:a}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",cn,!(i||a))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&jM(r)}function zM({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},c=e?.()){this.id=lU++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(dU),this.nodes.forEach(gU),this.nodes.forEach(mU),this.nodes.forEach(fU)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new X8)}addEventListener(o,c){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new hw),this.eventHandlers.get(o).add(c)}notifyListeners(o,...c){const u=this.eventHandlers.get(o);u&&u.notify(...c)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=ZN(o)&&!eF(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(u||c)&&(this.isLayoutDirty=!0),t){let h,p=0;const m=()=>this.root.updateBlockedByResize=!1;cn.read(()=>{p=window.innerWidth}),t(o,()=>{const y=window.innerWidth;y!==p&&(p=y,this.root.updateBlockedByResize=!0,h&&h(),h=W8(m,250),e0.hasAnimatedSinceResize&&(e0.hasAnimatedSinceResize=!1,this.nodes.forEach(I2)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:p,hasRelativeLayoutChanged:m,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||d.getDefaultTransition()||_U,{onLayoutAnimationStart:w,onLayoutAnimationComplete:E}=d.getProps(),T=!this.targetLayout||!VM(this.targetLayout,y),I=!p&&m;if(this.options.layoutRoot||this.resumeFrom||I||p&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const D={...Aw(_,"layout"),onPlay:w,onComplete:E};(d.shouldReduceMotion||this.options.layoutRoot)&&(D.delay=0,D.type=!1),this.startAnimation(D),this.setAnimationOrigin(h,I)}else p||I2(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),rl(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(vU),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&jM(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const p=this.path[h];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:c,layout:u}=this.options;if(c===void 0&&!u)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(A2);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(C2);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(pU),this.nodes.forEach(cU),this.nodes.forEach(uU)):this.nodes.forEach(C2),this.clearAllSnapshots();const c=ni.now();mr.delta=Ls(0,1e3/60,c-mr.timestamp),mr.timestamp=c,mr.isProcessing=!0,b1.update.process(mr),b1.preRender.process(mr),b1.render.process(mr),mr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Iw.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(hU),this.sharedNodes.forEach(yU)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,cn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){cn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!zr(this.snapshot.measuredBox.x)&&!zr(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Rn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(c=!1),c&&this.instance){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!OM(this.projectionDelta),u=this.getTransformTemplate(),d=u?u(this.latestValues,""):void 0,h=d!==this.prevTransformTemplateValue;o&&this.instance&&(c||$l(this.latestValues)||h)&&(i(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const c=this.measurePageBox();let u=this.removeElementScroll(c);return o&&(u=this.removeTransform(u)),wU(u),{animationId:this.root.animationId,measuredBox:c,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return Rn();const c=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(SU))){const{scroll:d}=this.root;d&&(Uu(c.x,d.offset.x),Uu(c.y,d.offset.y))}return c}removeElementScroll(o){const c=Rn();if(Vi(c,o),this.scroll?.wasRoot)return c;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:h,options:p}=d;d!==this.root&&h&&p.layoutScroll&&(h.wasRoot&&Vi(c,o),Uu(c.x,h.offset.x),Uu(c.y,h.offset.y))}return c}applyTransform(o,c=!1){const u=Rn();Vi(u,o);for(let d=0;d<this.path.length;d++){const h=this.path[d];!c&&h.options.layoutScroll&&h.scroll&&h!==h.root&&Gu(u,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),$l(h.latestValues)&&Gu(u,h.latestValues)}return $l(this.latestValues)&&Gu(u,this.latestValues),u}removeTransform(o){const c=Rn();Vi(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];if(!d.instance||!$l(d.latestValues))continue;Nx(d.latestValues)&&d.updateSnapshot();const h=Rn(),p=d.measurePageBox();Vi(h,p),x2(c,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,h)}return $l(this.latestValues)&&x2(c,this.latestValues),c}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==mr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:p}=this.options;if(!(!this.layout||!(h||p))){if(this.resolvedRelativeTargetAt=mr.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Rn(),this.relativeTargetOrigin=Rn(),vh(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Vi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Rn(),this.targetWithTransforms=Rn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),D8(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Vi(this.target,this.layout.layoutBox),gM(this.target,this.targetDelta)):Vi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Rn(),this.relativeTargetOrigin=Rn(),vh(this.relativeTargetOrigin,this.target,m.target),Vi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||Nx(this.parent.latestValues)||pM(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const o=this.getLead(),c=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===mr.timestamp&&(u=!1),u)return;const{layout:d,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||h))return;Vi(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,m=this.treeScale.y;GF(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Rn());const{target:y}=o;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(v2(this.prevProjectionDelta.x,this.projectionDelta.x),v2(this.prevProjectionDelta.y,this.projectionDelta.y)),mh(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==m||!T2(this.projectionDelta.x,this.prevProjectionDelta.x)||!T2(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=qu(),this.projectionDelta=qu(),this.projectionDeltaWithTransform=qu()}setAnimationOrigin(o,c=!1){const u=this.snapshot,d=u?u.latestValues:{},h={...this.latestValues},p=qu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const m=Rn(),y=u?u.source:void 0,_=this.layout?this.layout.source:void 0,w=y!==_,E=this.getStack(),T=!E||E.members.length<=1,I=!!(w&&!T&&this.options.crossfade===!0&&!this.path.some(xU));this.animationProgress=0;let D;this.mixTargetDelta=O=>{const z=O/1e3;D2(p.x,o.x,z),D2(p.y,o.y,z),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(vh(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),bU(this.relativeTarget,this.relativeTargetOrigin,m,z),D&&iU(this.relativeTarget,D)&&(this.isProjectionDirty=!1),D||(D=Rn()),Vi(D,this.relativeTarget)),w&&(this.animationValues=h,Z8(h,d,this.latestValues,z,I,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=z},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(rl(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=cn.update(()=>{e0.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=ad(0)),this.currentAnimation=Y8(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:c=>{this.mixTargetDelta(c),o.onUpdate&&o.onUpdate(c)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(oU),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:c,target:u,layout:d,latestValues:h}=o;if(!(!c||!u||!d)){if(this!==o&&this.layout&&d&&LM(this.options.animationType,this.layout.layoutBox,d.layoutBox)){u=this.target||Rn();const p=zr(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const m=zr(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+m}Vi(c,u),Gu(c,h),mh(this.projectionDeltaWithTransform,this.layoutCorrected,c,h)}}registerSharedNode(o,c){this.sharedNodes.has(o)||this.sharedNodes.set(o,new aU),this.sharedNodes.get(o).add(c);const d=c.options.initialPromotionConfig;c.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(c):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:c,preserveFollowOpacity:u}={}){const d=this.getStack();d&&d.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let c=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(c=!0),!c)return;const d={};u.z&&k1("z",o,d,this.animationValues);for(let h=0;h<R1.length;h++)k1(`rotate${R1[h]}`,o,d,this.animationValues),k1(`skew${R1[h]}`,o,d,this.animationValues);o.render();for(const h in d)o.setStaticValue(h,d[h]),this.animationValues&&(this.animationValues[h]=d[h]);o.scheduleRender()}applyProjectionStyles(o,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const u=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=Jm(c?.pointerEvents)||"",o.transform=u?u(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=Jm(c?.pointerEvents)||""),this.hasProjected&&!$l(this.latestValues)&&(o.transform=u?u({},""):"none",this.hasProjected=!1);return}o.visibility="";const h=d.animationValues||d.latestValues;this.applyTransformsToTarget();let p=sU(this.projectionDeltaWithTransform,this.treeScale,h);u&&(p=u(h,p)),o.transform=p;const{x:m,y}=this.projectionDelta;o.transformOrigin=`${m.origin*100}% ${y.origin*100}% 0`,d.animationValues?o.opacity=d===this?h.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:o.opacity=d===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const _ in Uh){if(h[_]===void 0)continue;const{correct:w,applyTo:E,isCSSVariable:T}=Uh[_],I=p==="none"?h[_]:w(h[_],d);if(E){const D=E.length;for(let O=0;O<D;O++)o[E[O]]=I}else T?this.options.visualElement.renderState.vars[_]=I:o[_]=I}this.options.layoutId&&(o.pointerEvents=d===this?Jm(c?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(A2),this.root.sharedNodes.clear()}}}function cU(t){t.updateLayout()}function uU(t){const e=t.resumeFrom?.snapshot||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:r}=t.layout,{animationType:i}=t.options,a=e.source!==t.layout.source;i==="size"?Li(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=zr(p);p.min=n[h].min,p.max=p.min+m}):LM(i,e.layoutBox,n)&&Li(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=zr(n[h]);p.max=p.min+m,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+m)});const o=qu();mh(o,n,e.layoutBox);const c=qu();a?mh(c,t.applyTransform(r,!0),e.measuredBox):mh(c,n,e.layoutBox);const u=!OM(o);let d=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:p,layout:m}=h;if(p&&m){const y=Rn();vh(y,e.layoutBox,p.layoutBox);const _=Rn();vh(_,n,m.layoutBox),VM(y,_)||(d=!0),h.options.layoutRoot&&(t.relativeTarget=_,t.relativeTargetOrigin=y,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:e,delta:c,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function dU(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function fU(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function hU(t){t.clearSnapshot()}function A2(t){t.clearMeasurements()}function C2(t){t.isLayoutDirty=!1}function pU(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function I2(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function gU(t){t.resolveTargetDelta()}function mU(t){t.calcProjection()}function vU(t){t.resetSkewAndRotation()}function yU(t){t.removeLeadSnapshot()}function D2(t,e,n){t.translate=pn(e.translate,0,n),t.scale=pn(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function R2(t,e,n,r){t.min=pn(e.min,n.min,r),t.max=pn(e.max,n.max,r)}function bU(t,e,n,r){R2(t.x,e.x,n.x,r),R2(t.y,e.y,n.y,r)}function xU(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const _U={duration:.45,ease:[.4,0,.1,1]},k2=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),N2=k2("applewebkit/")&&!k2("chrome/")?Math.round:$i;function M2(t){t.min=N2(t.min),t.max=N2(t.max)}function wU(t){M2(t.x),M2(t.y)}function LM(t,e,n){return t==="position"||t==="preserve-aspect"&&!I8(E2(e),E2(n),.2)}function SU(t){return t!==t.root&&t.scroll?.wasRoot}const EU=zM({attachResizeListener:(t,e)=>Gh(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),N1={current:void 0},BM=zM({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!N1.current){const t=new EU({});t.mount(window),t.setOptions({layoutScroll:!0}),N1.current=t}return N1.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),TU={pan:{Feature:G8},drag:{Feature:U8,ProjectionNode:BM,MeasureLayout:NM}};function P2(t,e,n){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",n==="Start");const i="onHover"+n,a=r[i];a&&cn.postRender(()=>a(e,_p(e)))}class AU extends hl{mount(){const{current:e}=this.node;e&&(this.unmount=XB(e,(n,r)=>(P2(this.node,r,"Start"),i=>P2(this.node,i,"End"))))}unmount(){}}class CU extends hl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=yp(Gh(this.node.current,"focus",()=>this.onFocus()),Gh(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function O2(t,e,n){const{props:r}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",n==="Start");const i="onTap"+(n==="End"?"":n),a=r[i];a&&cn.postRender(()=>a(e,_p(e)))}class IU extends hl{mount(){const{current:e}=this.node;e&&(this.unmount=JB(e,(n,r)=>(O2(this.node,r,"Start"),(i,{success:a})=>O2(this.node,i,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Lx=new WeakMap,M1=new WeakMap,DU=t=>{const e=Lx.get(t.target);e&&e(t)},RU=t=>{t.forEach(DU)};function kU({root:t,...e}){const n=t||document;M1.has(n)||M1.set(n,{});const r=M1.get(n),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(RU,{root:t,...e})),r[i]}function NU(t,e,n){const r=kU(e);return Lx.set(t,n),r.observe(t),()=>{Lx.delete(t),r.unobserve(t)}}const MU={some:0,all:1};class PU extends hl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:i="some",once:a}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:MU[i]},c=u=>{const{isIntersecting:d}=u;if(this.isInView===d||(this.isInView=d,a&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:h,onViewportLeave:p}=this.node.getProps(),m=d?h:p;m&&m(u)};return NU(this.node.current,o,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(OU(e,n))&&this.startObserver()}unmount(){}}function OU({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const VU={inView:{Feature:PU},tap:{Feature:IU},focus:{Feature:CU},hover:{Feature:AU}},jU={layout:{ProjectionNode:BM,MeasureLayout:NM}},zU={...w8,...VU,...TU,...jU},pl=BF(zU,JF);function LU(t){t.values.forEach(e=>e.stop())}function Bx(t,e){[...e].reverse().forEach(r=>{const i=t.getVariant(r);i&&Lw(t,i),t.variantChildren&&t.variantChildren.forEach(a=>{Bx(a,e)})})}function BU(t,e){if(Array.isArray(e))return Bx(t,e);if(typeof e=="string")return Bx(t,[e]);Lw(t,e)}function FU(){const t=new Set,e={subscribe(n){return t.add(n),()=>void t.delete(n)},start(n,r){const i=[];return t.forEach(a=>{i.push(EM(a,n,{transitionOverride:r}))}),Promise.all(i)},set(n){return t.forEach(r=>{BU(r,n)})},stop(){t.forEach(n=>{LU(n)})},mount(){return()=>{e.stop()}}};return e}function UU(){const t=yv(FU);return lw(t.mount,[]),t}const GU=UU;function qU(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.map(function(r){return r.split(" ").map(function(i){return i?""+t+i:""}).join(" ")}).join(" ")}function HU(t,e){return e.replace(/([^}{]*){/gm,function(n,r){return r.replace(/\.([^{,\s\d.]+)/g,"."+t+"$1")+"{"})}function Ps(t,e){return function(n){n&&(t[e]=n)}}function FM(t,e,n){return function(r){r&&(t[e][n]=r)}}function V2(t,e){return function(n){var r=n.prototype;t.forEach(function(i){e(r,i)})}}function $U(t,e){return e===void 0&&(e={}),function(n,r){t.forEach(function(i){var a=e[i]||i;a in n||(n[a]=function(){for(var o,c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];var d=(o=this[r])[i].apply(o,c);return d===this[r]?this:d})})}}var YU="function",KU="object",XU="string",WU="number",Fw="undefined",UM=typeof window!==Fw,QU=typeof document!==Fw&&document,ZU=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],Un=1e-7,Em={cm:function(t){return t*96/2.54},mm:function(t){return t*96/254},in:function(t){return t*96},pt:function(t){return t*96/72},pc:function(t){return t*96/6},"%":function(t,e){return t*e/100},vw:function(t,e){return e===void 0&&(e=window.innerWidth),t/100*e},vh:function(t,e){return e===void 0&&(e=window.innerHeight),t/100*e},vmax:function(t,e){return e===void 0&&(e=Math.max(window.innerWidth,window.innerHeight)),t/100*e},vmin:function(t,e){return e===void 0&&(e=Math.min(window.innerWidth,window.innerHeight)),t/100*e}};function JU(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}function C0(t,e,n,r){return(t*r+e*n)/(n+r)}function Sv(t){return typeof t===Fw}function va(t){return t&&typeof t===KU}function qn(t){return Array.isArray(t)}function ii(t){return typeof t===XU}function od(t){return typeof t===WU}function Uw(t){return typeof t===YU}function e7(t,e){var n=t===""||t==" ",r=e===""||e==" ";return r&&n||t===e}function GM(t,e,n,r,i){var a=Gw(t,e,n);return a?n:t7(t,e,n+1,r,i)}function Gw(t,e,n){if(!t.ignore)return null;var r=e.slice(Math.max(n-3,0),n+3).join("");return new RegExp(t.ignore).exec(r)}function t7(t,e,n,r,i){for(var a=function(d){var h=e[d].trim();if(h===t.close&&!Gw(t,e,d))return{value:d};var p=d,m=ai(i,function(y){var _=y.open;return _===h});if(m&&(p=GM(m,e,d,r,i)),p===-1)return o=d,"break";d=p,o=d},o,c=n;c<r;++c){var u=a(c);if(c=o,typeof u=="object")return u.value;if(u==="break")break}return-1}function qw(t,e){var n=ii(e)?{separator:e}:e,r=n.separator,i=r===void 0?",":r,a=n.isSeparateFirst,o=n.isSeparateOnlyOpenClose,c=n.isSeparateOpenClose,u=c===void 0?o:c,d=n.openCloseCharacters,h=d===void 0?ZU:d,p=h.map(function(A){var C=A.open,k=A.close;return C===k?C:C+"|"+k}).join("|"),m="(\\s*"+i+"\\s*|"+p+"|\\s+)",y=new RegExp(m,"g"),_=t.split(y).filter(function(A){return A&&A!=="undefined"}),w=_.length,E=[],T=[];function I(){return T.length?(E.push(T.join("")),T=[],!0):!1}for(var D=function(A){var C=_[A].trim(),k=A,V=ai(h,function(N){var K=N.open;return K===C}),B=ai(h,function(N){var K=N.close;return K===C});if(V){if(k=GM(V,_,A,w,h),k!==-1&&u)return I()&&a||(E.push(_.slice(A,k+1).join("")),A=k,a)?(O=A,"break"):(O=A,"continue")}else if(B&&!Gw(B,_,A)){var j=JU(h);return j.splice(h.indexOf(B),1),{value:qw(t,{separator:i,isSeparateFirst:a,isSeparateOnlyOpenClose:o,isSeparateOpenClose:u,openCloseCharacters:j})}}else if(e7(C,i)&&!o)return I(),a?(O=A,"break"):(O=A,"continue");k===-1&&(k=w-1),T.push(_.slice(A,k+1).join("")),A=k,O=A},O,z=0;z<w;++z){var P=D(z);if(z=O,typeof P=="object")return P.value;if(P==="break")break}return T.length&&E.push(T.join("")),E}function al(t){return qw(t,"")}function sc(t){return qw(t,",")}function qM(t){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(t);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function wp(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var n=e[1],r=e[2],i=e[3];return{prefix:n,unit:i,value:parseFloat(r)}}function n7(t){return t.replace(/[\s-_]+([^\s-_])/g,function(e,n){return n.toUpperCase()})}function t0(t,e){return t.replace(/([a-z])([A-Z])/g,function(n,r,i){return""+r+e+i.toLowerCase()})}function qh(){return Date.now?Date.now():new Date().getTime()}function Fs(t,e,n){n===void 0&&(n=-1);for(var r=t.length,i=0;i<r;++i)if(e(t[i],i,t))return i;return n}function ai(t,e,n){var r=Fs(t,e);return r>-1?t[r]:n}var HM=(function(){var t=qh(),e=UM&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(n){var r=qh(),i=setTimeout(function(){n(r-t)},1e3/60);return i}})(),r7=(function(){var t=UM&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return t?t.bind(window):function(e){clearTimeout(e)}})();function Us(t){return Object.keys(t)}function i7(t){var e=Us(t);return e.map(function(n){return t[n]})}function $t(t,e){var n=wp(t),r=n.value,i=n.unit;if(va(e)){var a=e[i];if(a){if(Uw(a))return a(r);if(Em[i])return Em[i](r,a)}}else if(i==="%")return r*e/100;return Em[i]?Em[i](r):r}function Fx(t,e,n){return Math.max(e,Math.min(t,n))}function j2(t,e,n,r){return r===void 0&&(r=t[0]/t[1]),[[rt(e[0],Un),rt(e[0]/r,Un)],[rt(e[1]*r,Un),rt(e[1],Un)]].filter(function(i){return i.every(function(a,o){var c=e[o],u=rt(c,Un);return n?a<=c||a<=u:a>=c||a>=u})})[0]||t}function $M(t,e,n,r){if(!r)return t.map(function(y,_){return Fx(y,e[_],n[_])});var i=t[0],a=t[1],o=r===!0?i/a:r,c=j2(t,e,!1,o),u=c[0],d=c[1],h=j2(t,n,!0,o),p=h[0],m=h[1];return i<u||a<d?(i=u,a=d):(i>p||a>m)&&(i=p,a=m),[i,a]}function a7(t){for(var e=t.length,n=0,r=e-1;r>=0;--r)n+=t[r];return n}function Ux(t){for(var e=t.length,n=0,r=e-1;r>=0;--r)n+=t[r];return e?n/e:0}function kn(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=Math.atan2(r,n);return i>=0?i:i+Math.PI*2}function s7(t){return[0,1].map(function(e){return Ux(t.map(function(n){return n[e]}))})}function z2(t){var e=s7(t),n=kn(e,t[0]),r=kn(e,t[1]);return n<r&&r-n<Math.PI||n>r&&r-n<-Math.PI?1:-1}function Os(t,e){return Math.sqrt(Math.pow((e?e[0]:0)-t[0],2)+Math.pow((e?e[1]:0)-t[1],2))}function rt(t,e){if(!e)return t;var n=1/e;return Math.round(t/e)/n}function L2(t,e){return t.forEach(function(n,r){t[r]=rt(t[r],e)}),t}function o7(t){for(var e=[],n=0;n<t;++n)e.push(n);return e}function YM(t){return t.reduce(function(e,n){return e.concat(n)},[])}function KM(t,e){t.indexOf(e)===-1&&t.push(e)}function Qn(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function XM(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function WM(t,e){if(t.classList)t.classList.remove(e);else{var n=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(n," ")}}function gr(t,e,n,r){t.addEventListener(e,n,r)}function Xn(t,e,n,r){t.removeEventListener(e,n,r)}function Vd(t){return t?.ownerDocument||QU}function Hw(t){return Vd(t).documentElement}function gl(t){return Vd(t).body}function Wo(t){var e;return((e=t?.ownerDocument)===null||e===void 0?void 0:e.defaultView)||window}function QM(t){return t&&"postMessage"in t&&"blur"in t&&"self"in t}function jd(t){return va(t)&&t.nodeName&&t.nodeType&&"ownerDocument"in t}var l7=(function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(n){return this.values[this.keys.indexOf(n)]},e.set=function(n,r){var i=this.keys,a=this.values,o=i.indexOf(n),c=o===-1?i.length:o;i[c]=n,a[c]=r},t})(),c7=(function(){function t(){this.object={}}var e=t.prototype;return e.get=function(n){return this.object[n]},e.set=function(n,r){this.object[n]=r},t})(),u7=typeof Map=="function",d7=(function(){function t(){}var e=t.prototype;return e.connect=function(n,r){this.prev=n,this.next=r,n&&(n.next=this),r&&(r.prev=this)},e.disconnect=function(){var n=this.prev,r=this.next;n&&(n.next=r),r&&(r.prev=n)},e.getIndex=function(){for(var n=this,r=-1;n;)n=n.prev,++r;return r},t})();function f7(t,e){var n=[],r=[];return t.forEach(function(i){var a=i[0],o=i[1],c=new d7;n[a]=c,r[o]=c}),n.forEach(function(i,a){i.connect(n[a-1])}),t.filter(function(i,a){return!e[a]}).map(function(i,a){var o=i[0],c=i[1];if(o===c)return[0,0];var u=n[o],d=r[c-1],h=u.getIndex();u.disconnect(),d?u.connect(d,d.next):u.connect(void 0,n[0]);var p=u.getIndex();return[h,p]})}var h7=(function(){function t(n,r,i,a,o,c,u,d){this.prevList=n,this.list=r,this.added=i,this.removed=a,this.changed=o,this.maintained=c,this.changedBeforeAdded=u,this.fixed=d}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var n=f7(this.changedBeforeAdded,this.fixed),r=this.changed,i=[];this.cacheOrdered=n.filter(function(a,o){var c=a[0],u=a[1],d=r[o],h=d[0],p=d[1];if(c!==u)return i.push([h,p]),!0}),this.cachePureChanged=i},t})();function Sp(t,e,n){var r=u7?Map:n?c7:l7,i=n||function(I){return I},a=[],o=[],c=[],u=t.map(i),d=e.map(i),h=new r,p=new r,m=[],y=[],_={},w=[],E=0,T=0;return u.forEach(function(I,D){h.set(I,D)}),d.forEach(function(I,D){p.set(I,D)}),u.forEach(function(I,D){var O=p.get(I);typeof O>"u"?(++T,o.push(D)):_[O]=T}),d.forEach(function(I,D){var O=h.get(I);typeof O>"u"?(a.push(D),++E):(c.push([O,D]),T=_[D]||0,m.push([O-T,D-E]),y.push(D===O),O!==D&&w.push([O,D]))}),o.reverse(),new h7(t,e,a,o,w,c,m,y)}var p7=(function(){function t(n,r){n===void 0&&(n=[]),this.findKeyCallback=r,this.list=[].slice.call(n)}var e=t.prototype;return e.update=function(n){var r=[].slice.call(n),i=Sp(this.list,r,this.findKeyCallback);return this.list=r,i},t})(),Gx=function(t,e){return Gx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Gx(t,e)};function Ep(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Gx(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Ba=function(){return Ba=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ba.apply(this,arguments)};function ZM(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function B2(t,e,n){for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return t.concat(a||Array.prototype.slice.call(e))}function F2(t){var e=0;return t.map(function(n){return n==null?"$compat".concat(++e):"".concat(n)})}function JM(t){var e=[];return t.forEach(function(n){e=e.concat(qn(n)?JM(n):n)}),e}function P1(t,e){if(!e)return t;for(var n in e)Sv(t[n])&&(t[n]=e[n]);return t}function I0(t,e){if(t===e)return!1;for(var n in t)if(!(n in e))return!0;for(var n in e)if(t[n]!==e[n])return!0;return!1}function U2(t){var e=t.className,n=ZM(t,["className"]);return e!=null&&(n.class=e),delete n.style,delete n.children,n}function G2(t){var e={},n={};for(var r in t)r.indexOf("on")===0?n[r]=t[r]:e[r]=t[r];return[e,n]}function Ev(t){if(!t)return null;var e=t.b;return jd(e)?e:Ev(t.c)}function eP(t){var e=t.parentNode;e&&e.removeChild(t)}function tP(t){t.forEach(function(e){e()})}function g7(){return this.constructor(this.props,this.context)}var $w=0,Tv=(function(){function t(n,r,i,a,o,c,u){u===void 0&&(u={}),this.t=n,this.d=r,this.k=i,this.i=a,this.c=o,this.ref=c,this.ps=u,this.typ="prov",this._ps=[],this._cs={},this._hyd=null,this._sel=!1}var e=t.prototype;return e.s=function(){return!0},e.u=function(n,r,i,a,o){var c=this,u=c.d,d=i7(r).filter(function(_){return _.$_req}),h=JM(d.map(function(_){return _.$_subs})),p=ai(h,function(_){return _.d===u});if(c.b&&!ii(i)&&!o&&!c.s(i.props,a)&&!p){var m=h.reduce(function(_,w){var E=w.d;return _[0]?_[0].d===E&&_.push(w):E>u&&_.push(w),_},[]);return m.forEach(function(_){Tp(_,_._ps,[_.o],n,r,!0)}),!1}c.o=i,c.ss(a);var y=c.ps;return ii(i)||(c.ps=i.props,c.ref=i.ref),Yw(this),c.r(n,r,c.b?y:{},a),!0},e.md=function(){this.rr()},e.ss=function(){},e.ud=function(){this.rr()},e.rr=function(){var n=this,r=n.ref,i=n.fr;r&&r(i?i.current:n.b)},t})();function nP(){return Object.__CROACT_CURRENT_INSTNACE__}function m7(){return $w}function v7(t){$w=t}function Yw(t){return Object.__CROACT_CURRENT_INSTNACE__=t,$w=0,t}var Kw=(function(){function t(n,r){n===void 0&&(n={}),this.props=n,this.context=r,this.state={},this.$_timer=0,this.$_state={},this.$_subs=[],this.$_cs={}}var e=t.prototype;return e.render=function(){return null},e.shouldComponentUpdate=function(n,r){return this.props!==n||this.state!==r},e.setState=function(n,r,i){var a=this;a.$_timer||(a.$_state={}),clearTimeout(a.$_timer),a.$_timer=0,a.$_state=Ba(Ba({},a.$_state),n),i?a.$_setState(r,i):a.$_timer=window.setTimeout(function(){a.$_timer=0,a.$_setState(r,i)})},e.forceUpdate=function(n){this.setState({},n,!0)},e.componentDidMount=function(){},e.componentDidUpdate=function(n,r){},e.componentWillUnmount=function(){},e.$_setState=function(n,r){var i=[],a=this.$_p,o=Tp(a.c,[a],[a.o],i,a._cs,Ba(Ba({},this.state),this.$_state),r);o&&(n&&i.push(n),tP(i),Yw(null))},t})(),rP=(function(t){Ep(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}var n=e.prototype;return n.shouldComponentUpdate=function(r,i){return I0(this.props,r)||I0(this.state,i)},e})(Kw);function iP(t){var e=function(n){e.current=n};return e.current=t,e}function y7(t){return t._fr=!0,t}function b7(t,e,n,r){var i,a;return!((i=t?.prototype)===null||i===void 0)&&i.render?a=new t(e,n):(a=new Kw(e,n),a.constructor=t,t._fr?(r.fr=iP(),a.render=function(){return this.constructor(this.props,r.fr)}):a.render=g7),a.$_p=r,a}var x7=(function(t){Ep(e,t);function e(r,i,a,o,c,u,d){d===void 0&&(d={});var h=t.call(this,r,i,a,o,c,u,P1(d,r.defaultProps))||this;return h.typ="comp",h._usefs=[],h._uefs=[],h._defs=[],h}var n=e.prototype;return n.s=function(r,i){var a=this.b;return a.shouldComponentUpdate(P1(r,this.t.defaultProps),i||a.state)!==!1},n.r=function(r,i,a){var o,c,u=this,d=u.t;u.ps=P1(u.ps,u.t.defaultProps);var h=u.ps,p=!u.b,m=d.contextType,y=u.b,_=m?.get(u);u._cs=i,p?(y=b7(d,h,_,u),u.b=y):(y.props=h,y.context=_);var w=y.state;u._usefs=[],u._uefs=[];var E=y.render();((c=(o=E?.props)===null||o===void 0?void 0:o.children)===null||c===void 0?void 0:c.length)===0&&(E.props.children=u.ps.children);var T=Ba(Ba({},i),y.$_cs);Tp(u,u._ps,E?[E]:[],r,T),p?u._uefs.push(function(){m?.register(u),y.componentDidMount()}):u._uefs.push(function(){y.componentDidUpdate(a,w)}),r.push(function(){u._usefs.forEach(function(I){I()}),p?u.md():u.ud(),u._defs=u._uefs.map(function(I){return I()})})},n.ss=function(r){var i=this.b;!i||!r||(i.state=r)},n.un=function(){var r,i=this;i._ps.forEach(function(o){o.un()});var a=i.t;(r=a.contextType)===null||r===void 0||r.unregister(i),clearTimeout(i.b.$_timer),i._defs.forEach(function(o){o&&o()}),i.b.componentWillUnmount()},e})(Tv);function _7(t,e,n){var r=Xw(U2(t),U2(e)),i=r.added,a=r.removed,o=r.changed;for(var c in i)n.setAttribute(c,i[c]);for(var u in o)n.setAttribute(u,o[u][1]);for(var d in a)n.removeAttribute(d)}function w7(t,e,n){var r=Xw(t,e),i=r.added,a=r.removed;for(var o in a)n.e(o,!0);for(var c in i)n.e(c)}function Xw(t,e){var n=Us(t),r=Us(e),i=Sp(n,r,function(u){return u}),a={},o={},c={};return i.added.forEach(function(u){var d=r[u];a[d]=e[d]}),i.removed.forEach(function(u){var d=n[u];o[d]=t[d]}),i.maintained.forEach(function(u){var d=u[0],h=n[d],p=[t[h],e[h]];t[h]!==e[h]&&(c[h]=p)}),{added:a,removed:o,changed:c}}function S7(t,e,n){var r=n.style,i=Xw(t,e),a=i.added,o=i.removed,c=i.changed;for(var u in a){var d=t0(u,"-");r.setProperty(d,a[u])}for(var u in c){var h=t0(u,"-");r.setProperty(h,c[u][1])}for(var u in o){var p=t0(u,"-");r.removeProperty(p)}}function E7(t){return t.replace(/^on/g,"").toLowerCase()}var T7=(function(t){Ep(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.typ="elem",r._es={},r._svg=!1,r}var n=e.prototype;return n.e=function(r,i){var a=this,o=a._es,c=a.b,u=E7(r);i?(Xn(c,u,o[r]),delete o[r]):(o[r]=function(d){var h,p;(p=(h=a.ps)[r])===null||p===void 0||p.call(h,d)},gr(c,u,o[r]))},n.s=function(r){return I0(this.ps,r)},n.r=function(r,i,a){var o,c=this,u=!c.b,d=c.ps;if(u){var h=Ev(c.c),p=!1;c._svg||c.t==="svg"?p=!0:p=h&&h.ownerSVGElement,c._svg=p;var m=(o=c._hyd)===null||o===void 0?void 0:o.splice(0,1)[0],y=c.t;if(m)c._hyd=[].slice.call(m.children||[]);else{var _=Vd(h);p?m=_.createElementNS("http://www.w3.org/2000/svg",y):m=_.createElement(y)}c.b=m}Tp(c,c._ps,d.children,r,i);var w=c.b,E=G2(a),T=E[0],I=E[1],D=G2(d),O=D[0],z=D[1];return _7(T,O,w),w7(I,z,c),S7(a.style||{},d.style||{},w),r.push(function(){u?c.md():c.ud()}),!0},n.un=function(){var r=this,i=r._es,a=r.b;for(var o in i)Xn(a,o,i[o]);r._ps.forEach(function(c){c.un()}),r._es={},r._sel||eP(a)},e})(Tv);function Hh(t){if(!t||jd(t))return t;var e=t.$_p._ps;return e.length?Hh(e[0].b):null}function aP(t){if(t){if(t.b&&jd(t.b))return t;var e=t._ps;return e.length?aP(e[0]):null}}function pa(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=e||{},a=i.key,o=i.ref,c=ZM(i,["key","ref"]);return{type:t,key:a,ref:o,props:Ba(Ba({},c),{children:YM(n).filter(function(u){return u!=null&&u!==!1})})}}var sP=(function(t){Ep(e,t);function e(r,i){i===void 0&&(i=0);var a=t.call(this,"container",i,"container",0,null)||this;return a.typ="container",a.b=r,a}var n=e.prototype;return n.r=function(){return!0},n.un=function(){},e})(Tv),A7=(function(t){Ep(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.typ="text",r}var n=e.prototype;return n.r=function(r){var i,a=this,o=!a.b;if(o){var c=Ev(a.c),u=(i=a._hyd)===null||i===void 0?void 0:i.splice(0,1)[0];a.b=u||Vd(c).createTextNode(a.t.replace("text_",""))}return r.push(function(){o?a.md():a.ud()}),!0},n.un=function(){eP(this.b)},e})(Tv);function C7(t,e,n){var r=n.map(function(u){return ii(u)?null:u.key}),i=F2(e.map(function(u){return u.k})),a=F2(r),o=Sp(i,a,function(u){return u});o.removed.forEach(function(u){e.splice(u,1)[0].un()}),o.ordered.forEach(function(u){var d=u[0],h=u[1],p=e.splice(d,1)[0];e.splice(h,0,p);var m=Hh(p.b),y=Hh(e[h+1]&&e[h+1].b);m&&m.parentNode.insertBefore(m,y)}),o.added.forEach(function(u){e.splice(u,0,q2(n[u],r[u],u,t))});var c=o.maintained.filter(function(u){u[0];var d=u[1],h=n[d],p=e[d],m=ii(h)?"text_".concat(h):h.type;return m!==p.t?(p.un(),e.splice(d,1,q2(h,r[d],d,t)),!0):(p.i=d,!1)});return B2(B2([],o.added,!0),c.map(function(u){u[0];var d=u[1];return d}))}function I7(t,e){for(var n=t._ps,r=n.length,i=e.i+1;i<r;++i){var a=Hh(n[i].b);if(a)return a}return null}function q2(t,e,n,r){var i=r.d+1;if(ii(t)||od(t))return new A7("text_".concat(t),i,e,n,r,null,{});var a=t.type,o=typeof a=="string"?T7:x7;return new o(a,i,e,n,r,t.ref,t.props)}function Tp(t,e,n,r,i,a,o){var c=C7(t,e,n),u=t._hyd,d=e.filter(function(p,m){return p._hyd=u,p.u(r,i,n[m],a,o)});t.typ==="container"&&t._sel&&e.forEach(function(p){var m=aP(p);m&&(m._sel=!0)}),t._hyd=null;var h=Ev(t);return h&&c.reverse().forEach(function(p){var m=e[p],y=Hh(m.b);if(y&&h!==y&&!y.parentNode){var _=I7(t,m);h.insertBefore(y,_)}}),d.length>0}function D7(t,e,n,r){n===void 0&&(n=e.__CROACT__),r===void 0&&(r={});var i=!!n;n||(n=new sP(e));var a=[];return Tp(n,n._ps,t?[t]:[],a,r,void 0,void 0),tP(a),Yw(null),i||(e.__CROACT__=n),n}function H2(t,e,n){return!n&&t&&(n=new sP(e.parentElement),n._hyd=[e],n._sel=!0),D7(t,e,n),n}function oP(t){var e=nP(),n=e._hs||(e._hs=[]),r=m7(),i=n[r];if(v7(r+1),i){if(!I0(i.deps,t.deps))return i.updated=!1,i;n[r]=t}else n.push(t);return t.value=t.func(),t.updated=!0,t}function R7(t,e){var n=oP({func:t,deps:e});return n.value}function k7(t){return R7(function(){return iP(t)},[])}function lP(t,e,n){var r=nP(),i=oP({func:function(){return t},deps:e}),a=n?r._usefs:r._uefs;i.updated?a.push(function(){return i.effect&&i.effect(),i.effect=t(),i.effect}):a.push(function(){return i.effect})}function N7(t,e,n){lP(function(){t?.(e())},n,!0)}function Ww(t,e){for(var n=t.length,r=0;r<n;++r)if(e(t[r],r))return!0;return!1}function cP(t,e){for(var n=t.length,r=0;r<n;++r)if(e(t[r],r))return t[r];return null}function uP(t){var e=t;if(typeof e>"u"){if(typeof navigator>"u"||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function Qw(t,e){try{return new RegExp(t,"g").exec(e)}catch{return null}}function M7(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var t=navigator.userAgentData,e=t.brands||t.uaList;return!!(e&&e.length)}function P7(t,e){var n=Qw("("+t+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return n?n[3]:""}function qx(t){return t.replace(/_/g,".")}function rh(t,e){var n=null,r="-1";return Ww(t,function(i){var a=Qw("("+i.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!a||i.brand?!1:(n=i,r=a[3]||"-1",i.versionAlias?r=i.versionAlias:i.versionTest&&(r=P7(i.versionTest.toLowerCase(),e)||r),r=qx(r),!0)}),{preset:n,version:r}}function Tm(t,e){var n={brand:"",version:"-1"};return Ww(t,function(r){var i=dP(e,r);return i?(n.brand=r.id,n.version=r.versionAlias||i.version,n.version!=="-1"):!1}),n}function dP(t,e){return cP(t,function(n){var r=n.brand;return Qw(""+e.test,r.toLowerCase())})}var fP=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],hP=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],Hx=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],pP=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],gP=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function mP(t){return!!rh(pP,t).preset}function O7(t){var e=uP(t),n=!!/mobi/g.exec(e),r={name:"unknown",version:"-1",majorVersion:-1,webview:mP(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},a=rh(fP,e),o=a.preset,c=a.version,u=rh(gP,e),d=u.preset,h=u.version,p=rh(hP,e);if(r.chromium=!!p.preset,r.chromiumVersion=p.version,!r.chromium){var m=rh(Hx,e);r.webkit=!!m.preset,r.webkitVersion=m.version}return d&&(i.name=d.id,i.version=h,i.majorVersion=parseInt(h,10)),o&&(r.name=o.id,r.version=c,r.webview&&i.name==="ios"&&r.name!=="safari"&&(r.webview=!1)),r.majorVersion=parseInt(r.version,10),{browser:r,os:i,isMobile:n,isHints:!1}}function V7(t){var e=navigator.userAgentData,n=(e.uaList||e.brands).slice(),r=e.mobile||!1,i=n[0],a=(e.platform||navigator.platform).toLowerCase(),o={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!Tm(pP,n).brand||mP(uP())},c={name:"unknown",version:"-1",majorVersion:-1};o.webkit=!o.chromium&&Ww(Hx,function(m){return dP(n,m)});var u=Tm(hP,n);if(o.chromium=!!u.brand,o.chromiumVersion=u.version||"-1",!o.chromium){var d=Tm(Hx,n);o.webkit=!!d.brand,o.webkitVersion=d.version||"-1"}var h=cP(gP,function(m){return new RegExp(""+m.test,"g").exec(a)});c.name=h?h.id:"";{var p=Tm(fP,n);o.name=p.brand||o.name,o.version=p.brand&&t?t.uaFullVersion:p.version}return o.webkit&&(c.name=r?"ios":"mac"),c.name==="ios"&&o.webview&&(o.version="-1"),c.version=qx(c.version),o.version=qx(o.version),c.majorVersion=parseInt(c.version,10),o.majorVersion=parseInt(o.version,10),{browser:o,os:c,isMobile:r,isHints:!0}}function j7(t){return M7()?V7():O7(t)}function z7(t,e,n,r,i,a){for(var o=0;o<i;++o){var c=n+o*i,u=r+o*i;t[c]+=t[u]*a,e[c]+=e[u]*a}}function L7(t,e,n,r,i){for(var a=0;a<i;++a){var o=n+a*i,c=r+a*i,u=t[o],d=e[o];t[o]=t[c],t[c]=u,e[o]=e[c],e[c]=d}}function B7(t,e,n,r,i){for(var a=0;a<r;++a){var o=n+a*r;t[o]/=i,e[o]/=i}}function vP(t,e,n){for(var r=t.slice(),i=0;i<n;++i)r[i*n+e-1]=0,r[(e-1)*n+i]=0;return r[(e-1)*(n+1)]=1,r}function Za(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var n=t.slice(),r=nn(e),i=0;i<e;++i){var a=e*i+i;if(!rt(n[a],Un)){for(var o=i+1;o<e;++o)if(n[e*i+o]){L7(n,r,i,o,e);break}}if(!rt(n[a],Un))return[];B7(n,r,i,e,n[a]);for(var o=0;o<e;++o){var c=o,u=o+i*e,d=n[u];!rt(d,Un)||i===o||z7(n,r,c,i,e,-d)}}return r}function F7(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var n=[],r=0;r<e;++r)for(var i=0;i<e;++i)n[i*e+r]=t[e*r+i];return n}function yP(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var n=[],r=t[e*e-1],i=0;i<e-1;++i)n[i]=t[e*(e-1)+i]/r;return n[e-1]=0,n}function U7(t,e){for(var n=nn(e),r=0;r<e-1;++r)n[e*(e-1)+r]=t[r]||0;return n}function yc(t,e){for(var n=t.slice(),r=t.length;r<e-1;++r)n[r]=0;return n[e-1]=1,n}function ya(t,e,n){if(e===void 0&&(e=Math.sqrt(t.length)),e===n)return t;for(var r=nn(n),i=Math.min(e,n),a=0;a<i-1;++a){for(var o=0;o<i-1;++o)r[a*n+o]=t[a*e+o];r[(a+1)*n-1]=t[(a+1)*e-1],r[(n-1)*n+a]=t[(e-1)*e+a]}return r[n*n-1]=t[e*e-1],r}function D0(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=nn(t);return e.forEach(function(i){r=Yt(r,i,t)}),r}function Yt(t,e,n){n===void 0&&(n=Math.sqrt(t.length));var r=[],i=t.length/n,a=e.length/i;if(i){if(!a)return t}else return e;for(var o=0;o<n;++o)for(var c=0;c<a;++c){r[c*n+o]=0;for(var u=0;u<i;++u)r[c*n+o]+=t[u*n+o]*e[c*i+u]}return r}function Tt(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),i=0;i<n;++i)r[i]=r[i]+e[i];return r}function qe(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),i=0;i<n;++i)r[i]=r[i]-e[i];return r}function G7(t,e){return e===void 0&&(e=t.length===6),e?[t[0],t[1],0,t[2],t[3],0,t[4],t[5],1]:t}function bP(t,e){return e===void 0&&(e=t.length===9),e?[t[0],t[1],t[3],t[4],t[6],t[7]]:t}function Rr(t,e,n){n===void 0&&(n=e.length);var r=Yt(t,e,n),i=r[n-1];return r.map(function(a){return a/i})}function q7(t,e){return Yt(t,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function H7(t,e){return Yt(t,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function $7(t,e){return Yt(t,Cp(e,4))}function Am(t,e){var n=e[0],r=n===void 0?1:n,i=e[1],a=i===void 0?1:i,o=e[2],c=o===void 0?1:o;return Yt(t,[r,0,0,0,0,a,0,0,0,0,c,0,0,0,0,1],4)}function Ap(t,e){return Rr(Cp(e,3),yc(t,3))}function O1(t,e){var n=e[0],r=n===void 0?0:n,i=e[1],a=i===void 0?0:i,o=e[2],c=o===void 0?0:o;return Yt(t,[1,0,0,0,0,1,0,0,0,0,1,0,r,a,c,1],4)}function $2(t,e){return Yt(t,e,4)}function Cp(t,e){var n=Math.cos(t),r=Math.sin(t),i=nn(e);return i[0]=n,i[1]=r,i[e]=-r,i[e+1]=n,i}function nn(t){for(var e=t*t,n=[],r=0;r<e;++r)n[r]=r%(t+1)?0:1;return n}function Zw(t,e){for(var n=nn(e),r=Math.min(t.length,e-1),i=0;i<r;++i)n[(e+1)*i]=t[i];return n}function bc(t,e){for(var n=nn(e),r=Math.min(t.length,e-1),i=0;i<r;++i)n[e*(e-1)+i]=t[i];return n}function Jw(t,e,n,r,i,a,o,c){var u=t[0],d=t[1],h=e[0],p=e[1],m=n[0],y=n[1],_=r[0],w=r[1],E=i[0],T=i[1],I=a[0],D=a[1],O=o[0],z=o[1],P=c[0],A=c[1],C=[u,0,h,0,m,0,_,0,d,0,p,0,y,0,w,0,1,0,1,0,1,0,1,0,0,u,0,h,0,m,0,_,0,d,0,p,0,y,0,w,0,1,0,1,0,1,0,1,-E*u,-T*u,-I*h,-D*h,-O*m,-z*m,-P*_,-A*_,-E*d,-T*d,-I*p,-D*p,-O*y,-z*y,-P*w,-A*w],k=Za(C,8);if(!k.length)return[];var V=Yt(k,[E,T,I,D,O,z,P,A],8);return V[8]=1,ya(F7(V),3,4)}var yh=function(){return yh=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},yh.apply(this,arguments)};function Y7(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function $h(t,e){return e===void 0&&(e=0),Mu(ld(t,e))}function K7(t,e){var n=Rr(t,[e[0],e[1]||0,e[2]||0,1],4),r=n[3]||1;return[n[0]/r,n[1]/r,n[2]/r]}function Mu(t){var e=Y7();return t.forEach(function(n){var r=n.matrixFunction,i=n.functionValue;r&&(e=r(e,i))}),e}function ld(t,e){e===void 0&&(e=0);var n=qn(t)?t:al(t);return n.map(function(r){var i=qM(r),a=i.prefix,o=i.value,c=null,u=a,d="";if(a==="translate"||a==="translateX"||a==="translate3d"){var h=va(e)?yh(yh({},e),{"o%":e["%"]}):{"%":e,"o%":e},p=sc(o).map(function(N,K){return K===0&&"x%"in h?h["%"]=e["x%"]:K===1&&"y%"in h?h["%"]=e["y%"]:h["%"]=e["o%"],$t(N,h)}),m=p[0],y=p[1],_=y===void 0?0:y,w=p[2],E=w===void 0?0:w;c=O1,d=[m,_,E]}else if(a==="translateY"){var T=va(e)?yh({"%":e["y%"]},e):{"%":e},_=$t(o,T);c=O1,d=[0,_,0]}else if(a==="translateZ"){var E=parseFloat(o);c=O1,d=[0,0,E]}else if(a==="scale"||a==="scale3d"){var I=sc(o).map(function(N){return parseFloat(N)}),D=I[0],O=I[1],z=O===void 0?D:O,P=I[2],A=P===void 0?1:P;c=Am,d=[D,z,A]}else if(a==="scaleX"){var D=parseFloat(o);c=Am,d=[D,1,1]}else if(a==="scaleY"){var z=parseFloat(o);c=Am,d=[1,z,1]}else if(a==="scaleZ"){var A=parseFloat(o);c=Am,d=[1,1,A]}else if(a==="rotate"||a==="rotateZ"||a==="rotateX"||a==="rotateY"){var C=wp(o),k=C.unit,V=C.value,B=k==="rad"?V:V*Math.PI/180;a==="rotate"||a==="rotateZ"?(u="rotateZ",c=$7):a==="rotateX"?c=q7:a==="rotateY"&&(c=H7),d=B}else if(a==="matrix3d")c=$2,d=sc(o).map(function(N){return parseFloat(N)});else if(a==="matrix"){var j=sc(o).map(function(N){return parseFloat(N)});c=$2,d=[j[0],j[1],0,0,j[2],j[3],0,0,0,0,1,0,j[4],j[5],0,1]}else u="";return{name:a,functionName:u,value:o,matrixFunction:c,functionValue:d}})}var $x=function(t,e){return $x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},$x(t,e)};function X7(t,e){$x(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var xP=typeof Map=="function"?void 0:(function(){var t=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++t)}})(),_P=(function(t){X7(e,t);function e(n){return n===void 0&&(n=[]),t.call(this,n,xP)||this}return e})(p7);function W7(t,e){return Sp(t,e,xP)}var Yx=function(){return Yx=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Yx.apply(this,arguments)};function Q7(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}var Av=(function(){function t(){this._events={}}var e=t.prototype;return e.on=function(n,r){if(va(n))for(var i in n)this.on(i,n[i]);else this._addEvent(n,r,{});return this},e.off=function(n,r){if(!n)this._events={};else if(va(n))for(var i in n)this.off(i);else if(!r)this._events[n]=[];else{var a=this._events[n];if(a){var o=Fs(a,function(c){return c.listener===r});o>-1&&a.splice(o,1)}}return this},e.once=function(n,r){var i=this;return r&&this._addEvent(n,r,{once:!0}),new Promise(function(a){i._addEvent(n,a,{once:!0})})},e.emit=function(n,r){var i=this;r===void 0&&(r={});var a=this._events[n];if(!n||!a)return!0;var o=!1;return r.eventType=n,r.stop=function(){o=!0},r.currentTarget=this,Q7(a).forEach(function(c){c.listener(r),c.once&&i.off(n,c.listener)}),!o},e.trigger=function(n,r){return r===void 0&&(r={}),this.emit(n,r)},e._addEvent=function(n,r,i){var a=this._events;a[n]=a[n]||[];var o=a[n];o.push(Yx({listener:r},i))},t})();var Kx=function(t,e){return Kx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},Kx(t,e)};function Z7(t,e){Kx(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Hu=function(){return Hu=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Hu.apply(this,arguments)};function J7(t){var e=t.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function Y2(t,e){return t.addEventListener("scroll",e),function(){t.removeEventListener("scroll",e)}}function Cm(t){if(t){if(ii(t))return document.querySelector(t)}else return null;if(Uw(t))return t();if(t instanceof Element)return t;if("current"in t)return t.current;if("value"in t)return t.value}var eG=(function(t){Z7(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r._startRect=null,r._startPos=[],r._prevTime=0,r._timer=0,r._prevScrollPos=[0,0],r._isWait=!1,r._flag=!1,r._currentOptions=null,r._lock=!1,r._unregister=null,r._onScroll=function(){var i=r._currentOptions;r._lock||!i||r.emit("scrollDrag",{next:function(a){r.checkScroll({container:i.container,inputEvent:a})}})},r}var n=e.prototype;return n.dragStart=function(r,i){var a=Cm(i.container);if(!a){this._flag=!1;return}var o=0,c=0,u=0,d=0;if(a===document.body)u=window.innerWidth,d=window.innerHeight;else{var h=a.getBoundingClientRect();o=h.top,c=h.left,u=h.width,d=h.height}this._flag=!0,this._startPos=[r.clientX,r.clientY],this._startRect={top:o,left:c,width:u,height:d},this._prevScrollPos=this._getScrollPosition([0,0],i),this._currentOptions=i,this._registerScrollEvent(i)},n.drag=function(r,i){if(clearTimeout(this._timer),!!this._flag){var a=r.clientX,o=r.clientY,c=i.threshold,u=c===void 0?0:c,d=this,h=d._startRect,p=d._startPos;this._currentOptions=i;var m=[0,0];return h.top>o-u?(p[1]>h.top||o<p[1])&&(m[1]=-1):h.top+h.height<o+u&&(p[1]<h.top+h.height||o>p[1])&&(m[1]=1),h.left>a-u?(p[0]>h.left||a<p[0])&&(m[0]=-1):h.left+h.width<a+u&&(p[0]<h.left+h.width||a>p[0])&&(m[0]=1),!m[0]&&!m[1]?!1:this._continueDrag(Hu(Hu({},i),{direction:m,inputEvent:r,isDrag:!0}))}},n.checkScroll=function(r){var i=this;if(this._isWait)return!1;var a=r.prevScrollPos,o=a===void 0?this._prevScrollPos:a,c=r.direction,u=r.throttleTime,d=u===void 0?0:u,h=r.inputEvent,p=r.isDrag,m=this._getScrollPosition(c||[0,0],r),y=m[0]-o[0],_=m[1]-o[1],w=c||[y?Math.abs(y)/y:0,_?Math.abs(_)/_:0];return this._prevScrollPos=m,this._lock=!1,!y&&!_?!1:(this.emit("move",{offsetX:w[0]?y:0,offsetY:w[1]?_:0,inputEvent:h}),d&&p&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},d)),!0)},n.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},n._getScrollPosition=function(r,i){var a=i.container,o=i.getScrollPosition,c=o===void 0?J7:o;return c({container:Cm(a),direction:r})},n._continueDrag=function(r){var i=this,a,o=r.container,c=r.direction,u=r.throttleTime,d=r.useScroll,h=r.isDrag,p=r.inputEvent;if(!(!this._flag||h&&this._isWait)){var m=qh(),y=Math.max(u+this._prevTime-m,0);if(y>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},y),!1;this._prevTime=m;var _=this._getScrollPosition(c,r);this._prevScrollPos=_,h&&(this._isWait=!0),d||(this._lock=!0);var w={container:Cm(o),direction:c,inputEvent:p};return(a=r.requestScroll)===null||a===void 0||a.call(r,w),this.emit("scroll",w),this._isWait=!1,d||this.checkScroll(Hu(Hu({},r),{prevScrollPos:_,direction:c,inputEvent:p}))}},n._registerScrollEvent=function(r){this._unregisterScrollEvent();var i=r.checkScrollEvent;if(i){var a=i===!0?Y2:i,o=Cm(r.container);i===!0&&(o===document.body||o===document.documentElement)?this._unregister=Y2(window,this._onScroll):this._unregister=a(o,this._onScroll)}},n._unregisterScrollEvent=function(){var r;(r=this._unregister)===null||r===void 0||r.call(this),this._unregister=null},e})(Av);function tG(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}function ei(t){return rt(t,Un)}function nG(t,e){return t.every(function(n,r){return ei(n-e[r])===0})}function rG(t,e){return!ei(t[0]-e[0])&&!ei(t[1]-e[1])}function wP(t){return t.length<3?0:Math.abs(a7(t.map(function(e,n){var r=t[n+1]||t[0];return e[0]*r[1]-r[0]*e[1]})))/2}function K2(t,e){var n=e.width,r=e.height,i=e.left,a=e.top,o=xc(t),c=o.minX,u=o.minY,d=o.maxX,h=o.maxY,p=n/(d-c),m=r/(h-u);return t.map(function(y){return[i+(y[0]-c)*p,a+(y[1]-u)*m]})}function xc(t){var e=t.map(function(r){return r[0]}),n=t.map(function(r){return r[1]});return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,n),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,n)}}function Xx(t,e,n){var r=t[0],i=t[1],a=xc(e),o=a.minX,c=a.maxX,u=[[o,i],[c,i]],d=R0(u[0],u[1]),h=Wx(e),p=[];if(h.forEach(function(_){var w=R0(_[0],_[1]),E=_[0];if(nG(d,w))p.push({pos:t,line:_,type:"line"});else{var T=SP(eS(d,w),[u,_]);T.forEach(function(I){_.some(function(D){return rG(D,I)})?p.push({pos:I,line:_,type:"point"}):ei(E[1]-i)!==0&&p.push({pos:I,line:_,type:"intersection"})})}}),ai(p,function(_){return _[0]===r}))return!0;var m=0,y={};return p.forEach(function(_){var w=_.pos,E=_.type,T=_.line;if(!(w[0]>r))if(E==="intersection")++m;else{if(E==="line")return;if(E==="point"){var I=ai(T,function(z){return z[1]!==i}),D=y[w[0]],O=I[1]>i?1:-1;D?D!==O&&++m:y[w[0]]=O}}}),m%2===1}function R0(t,e){var n=t[0],r=t[1],i=e[0],a=e[1],o=i-n,c=a-r;Math.abs(o)<Un&&(o=0),Math.abs(c)<Un&&(c=0);var u=0,d=0,h=0;return o?c?(u=-c/o,d=1,h=-u*n-r):(d=1,h=-r):c&&(u=-1,h=n),[u,d,h]}function eS(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],o=e[1],c=e[2],u=n===0&&a===0,d=r===0&&o===0,h=[];if(u&&d)return[];if(u){var p=-i/r,m=-c/o;return p!==m?[]:[[-1/0,p],[1/0,p]]}else if(d){var y=-i/n,_=-c/a;return y!==_?[]:[[y,-1/0],[y,1/0]]}else if(n===0){var w=-i/r,E=-(o*w+c)/a;h=[[E,w]]}else if(a===0){var w=-c/o,E=-(r*w+i)/n;h=[[E,w]]}else if(r===0){var E=-i/n,w=-(a*E+c)/o;h=[[E,w]]}else if(o===0){var E=-c/a,w=-(n*E+i)/r;h=[[E,w]]}else{var E=(r*c-o*i)/(o*n-r*a),w=-(n*E+i)/r;h=[[E,w]]}return h.map(function(T){return[T[0],T[1]]})}function SP(t,e){var n=e.map(function(p){return[0,1].map(function(m){return[Math.min(p[0][m],p[1][m]),Math.max(p[0][m],p[1][m])]})}),r=[];if(t.length===2){var i=t[0],a=i[0],o=i[1];if(ei(a-t[1][0])){if(!ei(o-t[1][1])){var d=Math.max.apply(Math,n.map(function(p){return p[0][0]})),h=Math.min.apply(Math,n.map(function(p){return p[0][1]}));if(ei(d-h)>0)return[];r=[[d,o],[h,o]]}}else{var c=Math.max.apply(Math,n.map(function(p){return p[1][0]})),u=Math.min.apply(Math,n.map(function(p){return p[1][1]}));if(ei(c-u)>0)return[];r=[[a,c],[a,u]]}}return r.length||(r=t.filter(function(p){var m=p[0],y=p[1];return n.every(function(_){return 0<=ei(m-_[0][0])&&0<=ei(_[0][1]-m)&&0<=ei(y-_[1][0])&&0<=ei(_[1][1]-y)})})),r.map(function(p){return[ei(p[0]),ei(p[1])]})}function Wx(t){return tG(t.slice(1),[t[0]]).map(function(e,n){return[t[n],e]})}function iG(t,e){var n=t.slice(),r=e.slice();z2(n)===-1&&n.reverse(),z2(r)===-1&&r.reverse();var i=Wx(n),a=Wx(r),o=i.map(function(h){return R0(h[0],h[1])}),c=a.map(function(h){return R0(h[0],h[1])}),u=[];o.forEach(function(h,p){var m=i[p],y=[];c.forEach(function(_,w){var E=eS(h,_),T=SP(E,[m,a[w]]);y.push.apply(y,T.map(function(I){return{index1:p,index2:w,pos:I,type:"intersection"}}))}),y.sort(function(_,w){return Os(m[0],_.pos)-Os(m[0],w.pos)}),u.push.apply(u,y),Xx(m[1],r)&&u.push({index1:p,index2:-1,pos:m[1],type:"inside"})}),a.forEach(function(h,p){if(Xx(h[1],n)){var m=!1,y=Fs(u,function(_){var w=_.index2;return w===p?(m=!0,!1):!!m});y===-1&&(m=!1,y=Fs(u,function(_){var w=_.index1,E=_.index2;return w===-1&&E+1===p?(m=!0,!1):!!m})),y===-1?u.push({index1:-1,index2:p,pos:h[1],type:"inside"}):u.splice(y,0,{index1:-1,index2:p,pos:h[1],type:"inside"})}});var d={};return u.filter(function(h){var p=h.pos,m=p[0]+"x"+p[1];return d[m]?!1:(d[m]=!0,!0)})}function aG(t,e){var n=iG(t,e);return n.map(function(r){var i=r.pos;return i})}function sG(t,e){var n=aG(t,e);return wP(n)}var Qx=function(t,e){return Qx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},Qx(t,e)};function oG(t,e){Qx(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Ln=function(){return Ln=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ln.apply(this,arguments)};function lG(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=Math.atan2(r,n);return i>=0?i:i+Math.PI*2}function V1(t){return lG([t[0].clientX,t[0].clientY],[t[1].clientX,t[1].clientY])/Math.PI*180}function cG(t){return t.touches&&t.touches.length>=2}function Im(t){return t?t.touches?dG(t.touches):[EP(t)]:[]}function uG(t){return t&&(t.type.indexOf("mouse")>-1||"button"in t)}function X2(t,e,n){var r=n.length,i=bh(t,r),a=i.clientX,o=i.clientY,c=i.originalClientX,u=i.originalClientY,d=bh(e,r),h=d.clientX,p=d.clientY,m=bh(n,r),y=m.clientX,_=m.clientY,w=a-h,E=o-p,T=a-y,I=o-_;return{clientX:c,clientY:u,deltaX:w,deltaY:E,distX:T,distY:I}}function j1(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function dG(t){for(var e=Math.min(t.length,2),n=[],r=0;r<e;++r)n.push(EP(t[r]));return n}function EP(t){return{clientX:t.clientX,clientY:t.clientY}}function bh(t,e){e===void 0&&(e=t.length);for(var n={clientX:0,clientY:0,originalClientX:0,originalClientY:0},r=Math.min(t.length,e),i=0;i<r;++i){var a=t[i];n.originalClientX+="originalClientX"in a?a.originalClientX:a.clientX,n.originalClientY+="originalClientY"in a?a.originalClientY:a.clientY,n.clientX+=a.clientX,n.clientY+=a.clientY}return e?{clientX:n.clientX/e,clientY:n.clientY/e,originalClientX:n.originalClientX/e,originalClientY:n.originalClientY/e}:n}var z1=(function(){function t(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return t.prototype.getAngle=function(e){return e===void 0&&(e=this.prevClients),V1(e)},t.prototype.getRotation=function(e){return e===void 0&&(e=this.prevClients),V1(e)-V1(this.startClients)},t.prototype.getPosition=function(e,n){e===void 0&&(e=this.prevClients);var r=X2(e||this.prevClients,this.prevClients,this.startClients),i=r.deltaX,a=r.deltaY;return this.movement+=Math.sqrt(i*i+a*a),this.prevClients=e,r},t.prototype.getPositions=function(e){e===void 0&&(e=this.prevClients);for(var n=this.prevClients,r=this.startClients,i=Math.min(this.length,n.length),a=[],o=0;o<i;++o)a[o]=X2([e[o]],[n[o]],[r[o]]);return a},t.prototype.getMovement=function(e){var n=this.movement;if(!e)return n;var r=bh(e,this.length),i=bh(this.prevClients,this.length),a=r.clientX-i.clientX,o=r.clientY-i.clientY;return Math.sqrt(a*a+o*o)+n},t.prototype.getDistance=function(e){return e===void 0&&(e=this.prevClients),j1(e)},t.prototype.getScale=function(e){return e===void 0&&(e=this.prevClients),j1(e)/j1(this.startClients)},t.prototype.move=function(e,n){this.startClients.forEach(function(r){r.clientX-=e,r.clientY-=n}),this.prevClients.forEach(function(r){r.clientX-=e,r.clientY-=n})},t})(),W2=["textarea","input"],fG=(function(t){oG(e,t);function e(n,r){r===void 0&&(r={});var i=t.call(this)||this;i.options={},i.flag=!1,i.pinchFlag=!1,i.data={},i.isDrag=!1,i.isPinch=!1,i.clientStores=[],i.targets=[],i.prevTime=0,i.doubleFlag=!1,i._useMouse=!1,i._useTouch=!1,i._useDrag=!1,i._dragFlag=!1,i._isTrusted=!1,i._isMouseEvent=!1,i._isSecondaryButton=!1,i._preventMouseEvent=!1,i._prevInputEvent=null,i._isDragAPI=!1,i._isIdle=!0,i._preventMouseEventId=0,i._window=window,i.onDragStart=function(m,y){if(y===void 0&&(y=!0),!(!i.flag&&m.cancelable===!1)){var _=m.type.indexOf("drag")>=-1;if(!(i.flag&&_)){i._isDragAPI=!0;var w=i.options,E=w.container,T=w.pinchOutside,I=w.preventWheelClick,D=w.preventRightClick,O=w.preventDefault,z=w.checkInput,P=w.dragFocusedInput,A=w.preventClickEventOnDragStart,C=w.preventClickEventOnDrag,k=w.preventClickEventByCondition,V=i._useTouch,B=!i.flag;if(i._isSecondaryButton=m.which===3||m.button===2,I&&(m.which===2||m.button===1)||D&&(m.which===3||m.button===2))return i.stop(),!1;if(B){var j=i._window.document.activeElement,N=m.target;if(N){var K=N.tagName.toLowerCase(),W=W2.indexOf(K)>-1,$=N.isContentEditable;if(W||$){if(z||!P&&j===N)return!1;if(j&&(j===N||$&&j.isContentEditable&&j.contains(N)))if(P)N.blur();else return!1}else if((O||m.type==="touchstart")&&j){var H=j.tagName.toLowerCase();(j.isContentEditable||W2.indexOf(H)>-1)&&j.blur()}(A||C||k)&&gr(i._window,"click",i._onClick,!0)}i.clientStores=[new z1(Im(m))],i._isIdle=!1,i.flag=!0,i.isDrag=!1,i._isTrusted=y,i._dragFlag=!0,i._prevInputEvent=m,i.data={},i.doubleFlag=qh()-i.prevTime<200,i._isMouseEvent=uG(m),!i._isMouseEvent&&i._preventMouseEvent&&i._allowMouseEvent();var te=i._preventMouseEvent||i.emit("dragStart",Ln(Ln({data:i.data,datas:i.data,inputEvent:m,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,isTrusted:y,isDouble:i.doubleFlag},i.getCurrentStore().getPosition()),{preventDefault:function(){m.preventDefault()},preventDrag:function(){i._dragFlag=!1}}));te===!1&&i.stop(),i._isMouseEvent&&i.flag&&O&&m.preventDefault()}if(!i.flag)return!1;var re=0;if(B?(i._attchDragEvent(),V&&T&&(re=setTimeout(function(){gr(E,"touchstart",i.onDragStart,{passive:!1})}))):V&&T&&Xn(E,"touchstart",i.onDragStart),i.flag&&cG(m)){if(clearTimeout(re),B&&m.touches.length!==m.changedTouches.length)return;i.pinchFlag||i.onPinchStart(m)}}}},i.onDrag=function(m,y){if(i.flag){var _=i.options.preventDefault;!i._isMouseEvent&&_&&m.preventDefault(),i._prevInputEvent=m;var w=Im(m),E=i.moveClients(w,m,!1);if(i._dragFlag){if(i.pinchFlag||E.deltaX||E.deltaY){var T=i._preventMouseEvent||i.emit("drag",Ln(Ln({},E),{isScroll:!!y,inputEvent:m}));if(T===!1){i.stop();return}}i.pinchFlag&&i.onPinch(m,w)}i.getCurrentStore().getPosition(w,!0)}},i.onDragEnd=function(m){if(i.flag){var y=i.options,_=y.pinchOutside,w=y.container,E=y.preventClickEventOnDrag,T=y.preventClickEventOnDragStart,I=y.preventClickEventByCondition,D=i.isDrag;(E||T||I)&&requestAnimationFrame(function(){i._allowClickEvent()}),!I&&!T&&E&&!D&&i._allowClickEvent(),i._useTouch&&_&&Xn(w,"touchstart",i.onDragStart),i.pinchFlag&&i.onPinchEnd(m);var O=m?.touches?Im(m):[],z=O.length;z===0||!i.options.keepDragging?i.flag=!1:i._addStore(new z1(O));var P=i._getPosition(),A=qh(),C=!D&&i.doubleFlag;i._prevInputEvent=null,i.prevTime=D||C?0:A,i.flag||(i._dettachDragEvent(),i._preventMouseEvent||i.emit("dragEnd",Ln({data:i.data,datas:i.data,isDouble:C,isDrag:D,isClick:!D,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,inputEvent:m,isTrusted:i._isTrusted},P)),i.clientStores=[],i._isMouseEvent||(i._preventMouseEvent=!0,clearTimeout(i._preventMouseEventId),i._preventMouseEventId=setTimeout(function(){i._preventMouseEvent=!1},200)),i._isIdle=!0)}},i.onBlur=function(){i.onDragEnd()},i._allowClickEvent=function(){Xn(i._window,"click",i._onClick,!0)},i._onClick=function(m){i._allowClickEvent(),i._allowMouseEvent();var y=i.options.preventClickEventByCondition;y?.(m)||(m.stopPropagation(),m.preventDefault())},i._onContextMenu=function(m){var y=i.options;y.preventRightClick?i.onDragEnd(m):m.preventDefault()},i._passCallback=function(){};var a=[].concat(n),o=a[0];i._window=QM(o)?o:Wo(o),i.options=Ln({checkInput:!1,container:o&&!("document"in o)?Wo(o):o,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},r);var c=i.options,u=c.container,d=c.events,h=c.checkWindowBlur;if(i._useDrag=d.indexOf("drag")>-1,i._useTouch=d.indexOf("touch")>-1,i._useMouse=d.indexOf("mouse")>-1,i.targets=a,i._useDrag&&a.forEach(function(m){gr(m,"dragstart",i.onDragStart)}),i._useMouse&&(a.forEach(function(m){gr(m,"mousedown",i.onDragStart),gr(m,"mousemove",i._passCallback)}),gr(u,"contextmenu",i._onContextMenu)),h&&gr(Wo(),"blur",i.onBlur),i._useTouch){var p={passive:!1};a.forEach(function(m){gr(m,"touchstart",i.onDragStart,p),gr(m,"touchmove",i._passCallback,p)})}return i}return e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(n){return this.getCurrentStore().getMovement(n)+this.clientStores.slice(1).reduce(function(r,i){return r+i.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(n,r,i,a){a===void 0&&(a=!0),this.flag&&(this.clientStores[0].move(n,r),a&&this.onDrag(i,!0))},e.prototype.move=function(n,r){var i=n[0],a=n[1],o=this.getCurrentStore(),c=o.prevClients;return this.moveClients(c.map(function(u){var d=u.clientX,h=u.clientY;return{clientX:d+i,clientY:h+a,originalClientX:d,originalClientY:h}}),r,!0)},e.prototype.triggerDragStart=function(n){this.onDragStart(n,!1)},e.prototype.setEventData=function(n){var r=this.data;for(var i in n)r[i]=n[i];return this},e.prototype.setEventDatas=function(n){return this.setEventData(n)},e.prototype.getCurrentEvent=function(n){return n===void 0&&(n=this._prevInputEvent),Ln(Ln({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:n})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var n=this,r=this.targets,i=this.options.container;this.off(),Xn(this._window,"blur",this.onBlur),this._useDrag&&r.forEach(function(a){Xn(a,"dragstart",n.onDragStart)}),this._useMouse&&(r.forEach(function(a){Xn(a,"mousedown",n.onDragStart)}),Xn(i,"contextmenu",this._onContextMenu)),this._useTouch&&(r.forEach(function(a){Xn(a,"touchstart",n.onDragStart)}),Xn(i,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(n){var r=this,i=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>i)){var a=new z1(Im(n));this.pinchFlag=!0,this._addStore(a);var o=this.emit("pinchStart",Ln(Ln({data:this.data,datas:this.data,angle:a.getAngle(),touches:this.getCurrentStore().getPositions()},a.getPosition()),{inputEvent:n,isTrusted:this._isTrusted,preventDefault:function(){n.preventDefault()},preventDrag:function(){r._dragFlag=!1}}));o===!1&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(n,r){if(!(!this.flag||!this.pinchFlag||r.length<2)){var i=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",Ln(Ln({data:this.data,datas:this.data,movement:this.getMovement(r),angle:i.getAngle(r),rotation:i.getRotation(r),touches:i.getPositions(r),scale:i.getScale(r),distance:i.getDistance(r)},i.getPosition(r)),{inputEvent:n,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(n){if(this.pinchFlag){var r=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var i=this.getCurrentStore();this.emit("pinchEnd",Ln(Ln({data:this.data,datas:this.data,isPinch:r,touches:i.getPositions()},i.getPosition()),{inputEvent:n}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(n,r,i){var a=this._getPosition(n,i),o=this.isDrag;(a.deltaX||a.deltaY)&&(this.isDrag=!0);var c=!1;return!o&&this.isDrag&&(c=!0),Ln(Ln({data:this.data,datas:this.data},a),{movement:this.getMovement(n),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:r,isTrusted:this._isTrusted,isFirstDrag:c})},e.prototype._addStore=function(n){this.clientStores.splice(0,0,n)},e.prototype._getPosition=function(n,r){var i=this.getCurrentStore(),a=i.getPosition(n,r),o=this.clientStores.slice(1).reduce(function(d,h){var p=h.getPosition();return d.distX+=p.distX,d.distY+=p.distY,d},a),c=o.distX,u=o.distY;return Ln(Ln({},a),{distX:c,distY:u})},e.prototype._attchDragEvent=function(){var n=this._window,r=this.options.container,i={passive:!1};this._isDragAPI&&(gr(r,"dragover",this.onDrag,i),gr(n,"dragend",this.onDragEnd)),this._useMouse&&(gr(r,"mousemove",this.onDrag),gr(n,"mouseup",this.onDragEnd)),this._useTouch&&(gr(r,"touchmove",this.onDrag,i),gr(n,"touchend",this.onDragEnd,i),gr(n,"touchcancel",this.onDragEnd,i))},e.prototype._dettachDragEvent=function(){var n=this._window,r=this.options.container;this._isDragAPI&&(Xn(r,"dragover",this.onDrag),Xn(n,"dragend",this.onDragEnd)),this._useMouse&&(Xn(r,"mousemove",this.onDrag),Xn(n,"mouseup",this.onDragEnd)),this._useTouch&&(Xn(r,"touchstart",this.onDragStart),Xn(r,"touchmove",this.onDrag),Xn(n,"touchend",this.onDragEnd),Xn(n,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e})(Av);function hG(t){for(var e=5381,n=t.length;n;)e=e*33^t.charCodeAt(--n);return e>>>0}var pG=hG;function gG(t){return pG(t).toString(36)}function mG(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function vG(t,e,n){return n.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(r,i){var a=i.trim();return(a?sc(a):[""]).map(function(o){var c=o.trim();return c.indexOf("@")===0?c:c.indexOf(":global")>-1?c.replace(/\:global/g,""):c.indexOf(":host")>-1?"".concat(c.replace(/\:host/g,".".concat(t))):c?".".concat(t," ").concat(c):".".concat(t)}).join(", ")+" {"})}function yG(t,e,n,r,i){var a=Vd(r),o=a.createElement("style");return o.setAttribute("type","text/css"),o.setAttribute("data-styled-id",t),o.setAttribute("data-styled-count","1"),n.nonce&&o.setAttribute("nonce",n.nonce),o.innerHTML=vG(t,e,n),(i||a.head||a.body).appendChild(o),o}function bG(t){var e="rCS"+gG(t);return{className:e,inject:function(n,r){r===void 0&&(r={});var i=mG(n),a=(i||n.ownerDocument||document).querySelector('style[data-styled-id="'.concat(e,'"]'));if(!a)a=yG(e,t,r,n,i);else{var o=parseFloat(a.getAttribute("data-styled-count"))||0;a.setAttribute("data-styled-count","".concat(o+1))}return{destroy:function(){var c,u=parseFloat(a.getAttribute("data-styled-count"))||0;u<=1?(a.remove?a.remove():(c=a.parentNode)===null||c===void 0||c.removeChild(a),a=null):a.setAttribute("data-styled-count","".concat(u-1))}}}}}var Zx=function(){return Zx=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Zx.apply(this,arguments)};function xG(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function TP(t,e){var n=bG(e),r=n.className;return y7(function(i,a){var o=i.className,c=o===void 0?"":o;i.cspNonce;var u=xG(i,["className","cspNonce"]),d=k7();return N7(a,function(){return d.current},[]),lP(function(){var h=n.inject(d.current,{nonce:i.cspNonce});return function(){h.destroy()}},[]),pa(t,Zx({ref:d,"data-styled-id":r,className:"".concat(c," ").concat(r)},u))})}var Jx=function(t,e){return Jx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Jx(t,e)};function Ip(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Jx(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Z=function(){return Z=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Z.apply(this,arguments)};function _G(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function wG(t,e,n,r){var i=arguments.length,a=i<3?e:r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}function SG(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function J(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function Ce(t,e,n){if(arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return t.concat(a||Array.prototype.slice.call(e))}function Dp(t,e){return Z({events:[],props:[],name:t},e)}var EG=["n","w","s","e"],tS=["n","w","s","e","nw","ne","sw","se"];function TG(t,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*t,'px" height="').concat(32*t,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}function AG(t){var e=TG(1,t),n=Math.round(t/45)*45%180,r="ns-resize";return n===135?r="nwse-resize":n===45?r="nesw-resize":n===90&&(r="ew-resize"),"cursor:".concat(r,";cursor: url('").concat(e,"') 16 16, ").concat(r,";")}var zd=j7(),AP=zd.browser.webkit,CP=AP&&(function(){var t=typeof window>"u"?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(t.userAgent.toLowerCase());return e?parseFloat(e[1])<605:!1})(),IP=zd.browser.name,DP=parseInt(zd.browser.version,10),CG=IP==="chrome",IG=zd.browser.chromium,DG=parseInt(zd.browser.chromiumVersion,10)||0,RG=CG&&DP>=109||IG&&DG>=109,kG=IP==="firefox",NG=parseInt(zd.browser.webkitVersion,10)>=612||DP>=15,nS="moveable-",MG=tS.map(function(t){var e="",n="",r="center",i="center",a="calc(var(--moveable-control-padding, 20) * -1px)";return t.indexOf("n")>-1&&(e="top: ".concat(a,";"),i="bottom"),t.indexOf("s")>-1&&(e="top: 0px;",i="top"),t.indexOf("w")>-1&&(n="left: ".concat(a,";"),r="right"),t.indexOf("e")>-1&&(n="left: 0px;",r="left"),'.around-control[data-direction*="'.concat(t,`"] {
        `).concat(n).concat(e,`
        transform-origin: `).concat(r," ").concat(i,`;
    }`)}).join(`
`),PG=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(MG,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(t){return`
.direction[data-rotation="`.concat(t,'"], :global .view-control-rotation').concat(t,` {
`).concat(AG(t),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(CP?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),OG=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],e_=1e-4,Ur=1e-7,Dm=1e-9,t_=Math.pow(10,10),Q2=-t_,VG={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},rS={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},RP={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},kP=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function Rp(t,e,n,r,i,a){var o,c;a===void 0&&(a="draggable");var u=(c=(o=e.gestos[a])===null||o===void 0?void 0:o.move(n,t.inputEvent))!==null&&c!==void 0?c:{},d=u.originalDatas||u.datas,h=d[a]||(d[a]={});return Z(Z({},u),{isPinch:!!r,parentEvent:!0,datas:h,originalDatas:t.originalDatas})}var cd=(function(){function t(e){var n;e===void 0&&(e="draggable"),this.ableName=e,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(n={},n[e]={},n)}return t.prototype.dragStart=function(e,n){this.isDrag=!1,this.isFlag=!1;var r=n.originalDatas;return this.datas=r,r[this.ableName]||(r[this.ableName]={}),Z(Z({},this.move(e,n.inputEvent)),{type:"dragstart"})},t.prototype.drag=function(e,n){return this.move([e[0]-this.prevX,e[1]-this.prevY],n)},t.prototype.move=function(e,n){var r,i,a=!1;if(!this.isFlag)this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],r=e[0],i=e[1],this.isFlag=!0;else{var o=this.isDrag;r=this.prevX+e[0],i=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!o&&this.isDrag&&(a=!0)}return this.prevX=r,this.prevY=i,{type:"drag",clientX:r,clientY:i,inputEvent:n,isFirstDrag:a,isDrag:this.isDrag,distX:r-this.startX,distY:i-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},t})();function ed(t,e,n,r){var i=t.length===16,a=i?4:3,o=Vc(t,n,r,a),c=J(o,4),u=J(c[0],2),d=u[0],h=u[1],p=J(c[1],2),m=p[0],y=p[1],_=J(c[2],2),w=_[0],E=_[1],T=J(c[3],2),I=T[0],D=T[1],O=J(hn(t,e,a),2),z=O[0],P=O[1],A=Math.min(d,m,w,I),C=Math.min(h,y,E,D),k=Math.max(d,m,w,I),V=Math.max(h,y,E,D);d=d-A||0,m=m-A||0,w=w-A||0,I=I-A||0,h=h-C||0,y=y-C||0,E=E-C||0,D=D-C||0,z=z-A||0,P=P-C||0;var B=t[0],j=t[a+1],N=Vr(B*j);return{left:A,top:C,right:k,bottom:V,origin:[z,P],pos1:[d,h],pos2:[m,y],pos3:[w,E],pos4:[I,D],direction:N}}function NP(t,e){var n=e.clientX,r=e.clientY,i=e.datas,a=t.state,o=a.moveableClientRect,c=a.rootMatrix,u=a.is3d,d=a.pos1,h=o.left,p=o.top,m=u?4:3,y=J(qe(fd(c,[n-h,r-p],m),d),2),_=y[0],w=y[1],E=J(ss({datas:i,distX:_,distY:w}),2),T=E[0],I=E[1];return[T,I]}function Oc(t,e){var n=e.datas,r=t.state,i=r.allMatrix,a=r.beforeMatrix,o=r.is3d,c=r.left,u=r.top,d=r.origin,h=r.offsetMatrix,p=r.targetMatrix,m=r.transformOrigin,y=o?4:3;n.is3d=o,n.matrix=i,n.targetMatrix=p,n.beforeMatrix=a,n.offsetMatrix=h,n.transformOrigin=m,n.inverseMatrix=Za(i,y),n.inverseBeforeMatrix=Za(a,y),n.absoluteOrigin=yc(Tt([c,u],d),y),n.startDragBeforeDist=Rr(n.inverseBeforeMatrix,n.absoluteOrigin,y),n.startDragDist=Rr(n.inverseMatrix,n.absoluteOrigin,y)}function jG(t){return ed(t.datas.beforeTransform,[50,50],100,100).direction}function Cv(t,e,n){var r=e.datas,i=e.originalDatas.beforeRenderable,a=r.transformIndex,o=i.nextTransforms,c=o.length,u=i.nextTransformAppendedIndexes,d=-1;a===-1?(n==="translate"?d=0:n==="rotate"&&(d=Fs(o,function(y){return y.match(/scale\(/g)})),d===-1&&(d=o.length),r.transformIndex=d):ai(u,function(y){return y.index===a&&y.functionName===n})?d=a:d=a+u.filter(function(y){return y.index<a}).length;var h=cH(o,t.state,d),p=h.targetFunction,m=n==="rotate"?"rotateZ":n;r.beforeFunctionTexts=h.beforeFunctionTexts,r.afterFunctionTexts=h.afterFunctionTexts,r.beforeTransform=h.beforeFunctionMatrix,r.beforeTransform2=h.beforeFunctionMatrix2,r.targetTansform=h.targetFunctionMatrix,r.afterTransform=h.afterFunctionMatrix,r.afterTransform2=h.afterFunctionMatrix2,r.targetAllTransform=h.allFunctionMatrix,p.functionName===m?(r.afterFunctionTexts.splice(0,1),r.isAppendTransform=!1):c>d&&(r.isAppendTransform=!0,i.nextTransformAppendedIndexes=Ce(Ce([],J(u),!1),[{functionName:n,index:d,isAppend:!0}],!1))}function Iv(t,e,n){return"".concat(t.beforeFunctionTexts.join(" ")," ").concat(t.isAppendTransform?n:e," ").concat(t.afterFunctionTexts.join(" "))}function zG(t){var e=t.datas,n=t.distX,r=t.distY,i=J(PP({datas:e,distX:n,distY:r}),2),a=i[0],o=i[1],c=MP(e,U7([a,o],4));return Rr(c,yc([0,0,0],4),4)}function MP(t,e,n){var r=t.beforeTransform,i=t.afterTransform,a=t.beforeTransform2,o=t.afterTransform2,c=t.targetAllTransform,u=n?Yt(c,e,4):Yt(e,c,4),d=Yt(Za(n?a:r,4),u,4),h=Yt(d,Za(n?o:i,4),4);return h}function PP(t){var e=t.datas,n=t.distX,r=t.distY,i=e.inverseBeforeMatrix,a=e.is3d,o=e.startDragBeforeDist,c=e.absoluteOrigin,u=a?4:3;return qe(Rr(i,Tt(c,[n,r]),u),o)}function ss(t,e){var n=t.datas,r=t.distX,i=t.distY,a=n.inverseBeforeMatrix,o=n.inverseMatrix,c=n.is3d,u=n.startDragBeforeDist,d=n.startDragDist,h=n.absoluteOrigin,p=c?4:3;return qe(Rr(e?a:o,Tt(h,[r,i]),p),e?u:d)}function LG(t,e){var n=t.datas,r=t.distX,i=t.distY;n.beforeMatrix;var a=n.matrix,o=n.is3d;n.startDragBeforeDist;var c=n.startDragDist,u=n.absoluteOrigin,d=o?4:3;return qe(Rr(a,Tt(c,[r,i]),d),u)}function BG(t,e,n,r,i,a){return r===void 0&&(r=e),i===void 0&&(i=n),a===void 0&&(a=[0,0]),t?t.map(function(o,c){var u=wp(o),d=u.value,h=u.unit,p=c?i:r,m=c?n:e;if(o==="%"||isNaN(d)){var y=p?a[c]/p:0;return m*y}else if(h!=="%")return d;return m*d/100}):a}function OP(t){var e=[];return t[1]>=0&&(t[0]>=0&&e.push(3),t[0]<=0&&e.push(2)),t[1]<=0&&(t[0]>=0&&e.push(1),t[0]<=0&&e.push(0)),e}function FG(t,e){return OP(e).map(function(n){return t[n]})}function L1(t,e){var n=(e+1)/2;return[C0(t[0][0],t[1][0],n,1-n),C0(t[0][1],t[1][1],n,1-n)]}function Zn(t,e){var n=L1([t[0],t[1]],e[0]),r=L1([t[2],t[3]],e[0]);return L1([n,r],e[1])}function UG(t,e,n,r,i,a){var o=Vc(e,n,r,i),c=Zn(o,a),u=t[0]-c[0],d=t[1]-c[1];return[u,d]}function kp(t,e,n,r){return Yt(t,_h(e,r,n),r)}function GG(t,e,n,r){var i=t.transformOrigin,a=t.offsetMatrix,o=t.is3d,c=o?4:3,u;if(ii(n)){var d=e.beforeTransform,h=e.afterTransform;r?u=ya($h(n),4,c):u=ya(Yt(Yt(d,$h([n]),4),h,4),4,c)}else u=n;return kp(a,u,i,c)}function qG(t,e){var n=t.transformOrigin,r=t.offsetMatrix,i=t.is3d,a=t.targetMatrix,o=t.targetAllTransform,c=i?4:3;return kp(r,Yt(o||a,Zw(e,c),c),n,c)}function Dv(t,e){var n=Ld(e);return{setTransform:function(r,i){i===void 0&&(i=-1),n.startTransforms=qn(r)?r:al(r),n_(t,e,i)},setTransformIndex:function(r){n_(t,e,r)}}}function Rv(t,e,n){var r=Ld(e),i=r.startTransforms;n_(t,e,Fs(i,function(a){return a.indexOf("".concat(n,"("))===0}))}function n_(t,e,n){var r=Ld(e),i=e.datas;if(i.transformIndex=n,n!==-1){var a=r.startTransforms[n];if(a){var o=t.state,c=ld([a],{"x%":function(u){return u/100*o.offsetWidth},"y%":function(u){return u/100*o.offsetHeight}});i.startValue=c[0].functionValue}}}function iS(t,e){var n=Ld(t);n.nextTransforms=al(e)}function Ld(t){return t.originalDatas.beforeRenderable}function k0(t){var e=t.originalDatas.beforeRenderable;return e.nextTransforms}function Rm(t){return(k0(t)||[]).join(" ")}function km(t){return Ld(t).nextStyle}function VP(t,e,n,r,i){iS(i,e);var a=Or.drag(t,Rp(i,t.state,n,r)),o=a?a.transform:e;return Z(Z({transform:e,drag:a},Lr({transform:o},i)),{afterTransform:o})}function aS(t,e,n,r,i,a){var o=GG(t.state,i,e,a),c=YG(t,n,r,o);return c}function jP(t,e,n,r,i,a,o){var c=aS(t,e,n,i,a,o),u=t.state,d=u.left,h=u.top,p=t.props.groupable,m=p?d:0,y=p?h:0,_=qe(r,c);return qe(_,[m,y])}function HG(t,e,n,r,i,a,o){var c=jP(t,e,n,r,i,a,o);return c}function $G(t,e,n){return[e?-1+t[0]/(e/2):0,n?-1+t[1]/(n/2):0]}function YG(t,e,n,r){r===void 0&&(r=t.state.allMatrix);var i=t.state,a=i.width,o=i.height,c=i.is3d,u=c?4:3,d=[a/2*(1+e[0])+n[0],o/2*(1+e[1])+n[1]];return hn(r,d,u)}function KG(t,e,n){var r=n.fixedDirection,i=n.fixedPosition,a=n.fixedOffset;return jP(t,"rotate(".concat(e,"deg)"),r,i,a,n)}function XG(t,e,n,r,i,a){var o=t.props.groupable,c=t.state,u=c.transformOrigin,d=c.offsetMatrix,h=c.is3d,p=c.width,m=c.height,y=c.left,_=c.top,w=a.fixedDirection,E=a.nextTargetMatrix||c.targetMatrix,T=h?4:3,I=BG(i,e,n,p,m,u),D=o?y:0,O=o?_:0,z=kp(d,E,I,T),P=UG(r,z,e,n,T,w);return qe(P,[D,O])}function WG(t,e){return Zn(Qi(t.state),e)}function QG(t,e){var n=t.targetGesto,r=t.controlGesto,i;return n?.isFlag()&&(i=n.getEventData()[e]),!i&&r?.isFlag()&&(i=r.getEventData()[e]),i||{}}function ZG(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function JG(t){var e=t("scale"),n=t("rotate"),r=t("translate"),i=[];return r&&r!=="0px"&&r!=="none"&&i.push("translate(".concat(r.split(/\s+/).join(","),")")),n&&n!=="1"&&n!=="none"&&i.push("rotate(".concat(n,")")),e&&e!=="1"&&e!=="none"&&i.push("scale(".concat(e.split(/\s+/).join(","),")")),i}function zP(t,e,n){for(var r=t,i=[],a=Hw(t)||gl(t),o=!n&&t===e||t===a,c=o,u=!1,d=3,h,p,m,y=!1,_=Kh(e,e,!0).offsetParent,w=1;r&&!c;){c=o;var E=si(r),T=E("position"),I=lO(r),D=T==="fixed",O=JG(E),z=G7(Wq(I)),P=void 0,A=!1,C=!1,k=0,V=0,B=0,j=0,N={hasTransform:!1,fixedContainer:null};D&&(y=!0,N=tH(r),_=N.fixedContainer);var K=z.length;!u&&(K===16||O.length)&&(u=!0,d=4,l_(i),m&&(m=ya(m,3,4))),u&&K===9&&(z=ya(z,3,4));var W=eH(r,t),$=W.tagName,H=W.hasOffset,te=W.isSVG,re=W.origin,ue=W.targetOrigin,F=W.offset,Q=J(F,2),Y=Q[0],ne=Q[1];$==="svg"&&!r.ownerSVGElement&&m&&(i.push({type:"target",target:r,matrix:nH(r,d)}),i.push({type:"offset",target:r,matrix:nn(d)}));var pe=parseFloat(E("zoom"))||1;if(D)P=N.fixedContainer,A=!0;else{var de=Kh(r,e,!1,!0,E),ge=de.offsetZoom;if(P=de.offsetParent,A=de.isEnd,C=de.isStatic,w*=ge,(de.isCustomElement||ge!==1)&&C)Y-=P.offsetLeft,ne-=P.offsetTop;else if(kG||RG){var we=de.parentSlotElement;if(we){for(var Te=P,Xe=0,Se=0;Te&&ZG(Te);)Xe+=Te.offsetLeft,Se+=Te.offsetTop,Te=Te.offsetParent;Y-=Xe,ne-=Se}}}if(AP&&!NG&&H&&!te&&C&&(T==="relative"||T==="static")&&(Y-=P.offsetLeft,ne-=P.offsetTop,o=o||A),D)H&&N.hasTransform&&(B=P.clientLeft,j=P.clientTop);else if(H&&_!==P&&(k=P.clientLeft,V=P.clientTop),H&&P===a){var Ie=cO(r,!1);Y+=Ie[0],ne+=Ie[1]}if(i.push({type:"target",target:r,matrix:_h(z,d,re)}),O.length&&(i.push({type:"offset",target:r,matrix:nn(d)}),i.push({type:"target",target:r,matrix:_h($h(O),d,re)})),H){var Je=r===t,Me=Je?0:r.scrollLeft,$e=Je?0:r.scrollTop;i.push({type:"offset",target:r,matrix:bc([Y-Me+k-B,ne-$e+V-j],d)})}else i.push({type:"offset",target:r,origin:re});if(pe!==1&&i.push({type:"zoom",target:r,matrix:_h(Zw([pe,pe],d),d,[0,0])}),m||(m=z),h||(h=re),p||(p=ue),c||D)break;r=P,o=A,(!n||r===a)&&(c=o)}return m||(m=nn(d)),h||(h=[0,0]),p||(p=[0,0]),{zoom:w,offsetContainer:_,matrixes:i,targetMatrix:m,transformOrigin:h,targetOrigin:p,is3d:u,hasFixed:y}}var Wl=null,Ql=null,$u=null;function ud(t){t?(window.Map&&(Wl=new Map,Ql=new Map),$u=[]):(Wl=null,$u=null,Ql=null)}function eq(t){var e=Ql?.get(t);if(e)return e;var n=wh(t,!0);return Ql&&Ql.set(t,n),n}function tq(t,e){if($u){var n=ai($u,function(i){return i[0][0]==t&&i[0][1]==e});if(n)return n[1]}var r=zP(t,e,!0);return $u&&$u.push([[t,e],r]),r}function si(t){var e=Wl?.get(t);if(!e){var n=Wo(t).getComputedStyle(t);if(!Wl)return function(a){return n[a]};e={style:n,cached:{}},Wl.set(t,e)}var r=e.cached,i=e.style;return function(a){return a in r||(r[a]=i[a]),r[a]}}function ga(t,e,n){var r=n.originalDatas;r.groupable=r.groupable||{};var i=r.groupable;i.childDatas=i.childDatas||[];var a=i.childDatas;return t.moveables.map(function(o,c){return a[c]=a[c]||{},a[c][e]=a[c][e]||{},Z(Z({},n),{isRequestChild:!0,datas:a[c][e],originalDatas:a[c]})})}function B1(t,e,n,r,i,a,o){var c=!!n.match(/Start$/g),u=!!n.match(/End$/g),d=i.isPinch,h=i.datas,p=ga(t,e.name,i),m=t.moveables,y=[],_=p.map(function(w,E){var T=m[E],I=T.state,D=I.gestos,O=w;if(c)O=new cd(o).dragStart(r,w),y.push(O);else{if(D[o]||(D[o]=h.childGestos[E]),!D[o])return;O=Rp(w,I,r,d,a,o),y.push(O)}var z=e[n](T,Z(Z({},O),{parentFlag:!0}));return u&&(D[o]=null),z});return c&&(h.childGestos=m.map(function(w){return w.state.gestos[o]})),{eventParams:_,childEvents:y}}function Vs(t,e,n,r,i,a){i===void 0&&(i=function(h,p){return p});var o=!!n.match(/End$/g),c=ga(t,e.name,r),u=t.moveables,d=c.map(function(h,p){var m=u[p],y=h;y=i(m,h);var _=e[n](m,Z(Z({},y),{parentFlag:!0}));return o&&(m.state.gestos={}),_});return d}function N0(t,e,n,r){var i=n.fixedDirection,a=n.fixedPosition,o=r.datas.startPositions||Qi(e.state),c=Zn(o,i),u=J(Rr(Cp(-t.rotation/180*Math.PI,3),[c[0]-a[0],c[1]-a[1],1],3),2),d=u[0],h=u[1];return r.datas.originalX=d,r.datas.originalY=h,r}function LP(t,e,n,r){var i=t.getState(),a=i.renderPoses,o=i.rotation,c=i.direction,u=_c(t.props,e).zoom,d=xh(o/Math.PI*180),h={},p=t.renderState;p.renderDirectionMap||(p.renderDirectionMap={});var m=p.renderDirectionMap;n.forEach(function(_){var w=_.dir;h[w]=!0});var y=Vr(c);return n.map(function(_){var w=_.data,E=_.classNames,T=_.dir,I=rS[T];if(!I||!h[T])return null;m[T]=!0;var D=(rt(d,15)+y*RP[T]+720)%180,O={};return Us(w).forEach(function(z){O["data-".concat(z)]=w[z]}),r.createElement("div",Z({className:Be.apply(void 0,Ce(["control","direction",T,e],J(E),!1)),"data-rotation":D,"data-direction":T},O,{key:"direction-".concat(T),style:V0.apply(void 0,Ce([o,u],J(I.map(function(z){return a[z]})),!1))}))})}function BP(t,e,n,r){var i=_c(t.props,n),a=i.renderDirections,o=a===void 0?e:a,c=i.displayAroundControls;if(!o)return[];var u=o===!0?tS:o;return Ce(Ce([],J(c?qP(t,r,n,u):[]),!1),J(LP(t,n,u.map(function(d){return{data:{},classNames:[],dir:d}}),r)),!1)}function Yh(t,e,n,r,i,a){for(var o=[],c=6;c<arguments.length;c++)o[c-6]=arguments[c];var u=kn(n,r),d=e?rt(u/Math.PI*180,15)%180:-1;return t.createElement("div",{key:"line-".concat(a),className:Be.apply(void 0,Ce(["line","direction",e?"edge":"",e],J(o),!1)),"data-rotation":d,"data-line-key":a,"data-direction":e,style:ah(n,r,i,u)})}function FP(t,e,n,r,i){var a=n===!0?EG:n;return a.map(function(o,c){var u=J(rS[o],2),d=u[0],h=u[1];if(h!=null)return Yh(t,o,r[d],r[h],i,"".concat(e,"Edge").concat(c),e)}).filter(Boolean)}function UP(t){return function(e,n){var r=_c(e.props,t).edge;return r&&(r===!0||r.length)?Ce(Ce([],J(FP(n,t,r,e.getState().renderPoses,e.props.zoom)),!1),J(nq(e,t,n)),!1):GP(e,t,n)}}function GP(t,e,n){return BP(t,tS,e,n)}function nq(t,e,n){return BP(t,["nw","ne","sw","se"],e,n)}function qP(t,e,n,r){var i=t.renderState;i.renderDirectionMap||(i.renderDirectionMap={});var a=t.getState(),o=a.renderPoses,c=a.rotation,u=a.direction,d=i.renderDirectionMap,h=t.props.zoom,p=Vr(u),m=c/Math.PI*180;return(r||Us(d)).map(function(y){var _=rS[y];if(!_)return null;var w=(rt(m,15)+p*RP[y]+720)%180,E=["around-control"];return n&&E.push("direction",n),e.createElement("div",{className:Be.apply(void 0,Ce([],J(E),!1)),"data-rotation":w,"data-direction":y,key:"direction-around-".concat(y),style:V0.apply(void 0,Ce([c,h],J(_.map(function(T){return o[T]})),!1))})})}function sS(t,e,n){var r=t||{},i=r.position,a=i===void 0?"client":i,o=r.left,c=o===void 0?-1/0:o,u=r.top,d=u===void 0?-1/0:u,h=r.right,p=h===void 0?1/0:h,m=r.bottom,y=m===void 0?1/0:m,_={position:a,left:c,top:d,right:p,bottom:y};return{vertical:Z2(_,e,!0),horizontal:Z2(_,n,!1)}}function kv(t,e){var n=t.state,r=n.containerClientRect,i=r.clientHeight,a=r.clientWidth,o=r.clientLeft,c=r.clientTop,u=n.snapOffset,d=u.left,h=u.top,p=u.right,m=u.bottom,y=e||t.props.bounds||{},_=y.position||"client",w=_==="css",E=y.left,T=E===void 0?-1/0:E,I=y.top,D=I===void 0?-1/0:I,O=y.right,z=O===void 0?w?-1/0:1/0:O,P=y.bottom,A=P===void 0?w?-1/0:1/0:P;return w&&(z=a+p-d-z,A=i+m-h-A),{left:T+d-o,right:z+d-o,top:D+h-c,bottom:A+h-c}}function rq(t,e,n){var r=kv(t),i=r.left,a=r.top,o=r.right,c=r.bottom,u=J(n,2),d=u[0],h=u[1],p=J(qe(n,e),2),m=p[0],y=p[1];xe(m)<Ur&&(m=0),xe(y)<Ur&&(y=0);var _=y>0,w=m>0,E={isBound:!1,offset:0,pos:0},T={isBound:!1,offset:0,pos:0};if(m===0&&y===0)return{vertical:E,horizontal:T};if(m===0)_?c<h&&(T.pos=c,T.offset=h-c):a>h&&(T.pos=a,T.offset=h-a);else if(y===0)w?o<d&&(E.pos=o,E.offset=d-o):i>d&&(E.pos=i,E.offset=d-i);else{var I=y/m,D=n[1]-I*d,O=0,z=0,P=!1;w&&o<=d?(O=I*o+D,z=o,P=!0):!w&&d<=i&&(O=I*i+D,z=i,P=!0),P&&(O<a||O>c)&&(P=!1),P||(_&&c<=h?(O=c,z=(O-D)/I,P=!0):!_&&h<=a&&(O=a,z=(O-D)/I,P=!0)),P&&(E.isBound=!0,E.pos=z,E.offset=d-z,T.isBound=!0,T.pos=O,T.offset=h-O)}return{vertical:E,horizontal:T}}function Z2(t,e,n){var r=t[n?"left":"top"],i=t[n?"right":"bottom"],a=Math.min.apply(Math,Ce([],J(e),!1)),o=Math.max.apply(Math,Ce([],J(e),!1)),c=[];return r+1>a&&c.push({direction:"start",isBound:!0,offset:a-r,pos:r}),i-1<o&&c.push({direction:"end",isBound:!0,offset:o-i,pos:i}),c.length||c.push({isBound:!1,offset:0,pos:0}),c.sort(function(u,d){return xe(d.offset)-xe(u.offset)})}function J2(t,e,n){var r=n?t.map(function(i){return Ap(i,n)}):t;return r.some(function(i){return i[0]<e.left&&xe(i[0]-e.left)>.1||i[0]>e.right&&xe(i[0]-e.right)>.1||i[1]<e.top&&xe(i[1]-e.top)>.1||i[1]>e.bottom&&xe(i[1]-e.bottom)>.1})}function iq(t,e,n){var r=Wi(t),i=Math.sqrt(r*r-e*e)||0;return[i,-i].sort(function(a,o){return xe(a-t[n?0:1])-xe(o-t[n?0:1])}).map(function(a){return kn([0,0],n?[a,e]:[e,a])})}function aq(t,e,n,r,i){if(!t.props.bounds)return[];var a=i*Math.PI/180,o=kv(t),c=o.left,u=o.top,d=o.right,h=o.bottom,p=c-r[0],m=d-r[0],y=u-r[1],_=h-r[1],w={left:p,top:y,right:m,bottom:_};if(!J2(n,w,0))return[];var E=[];return[[p,0],[m,0],[y,1],[_,1]].forEach(function(T){var I=J(T,2),D=I[0],O=I[1];n.forEach(function(z){var P=kn([0,0],z);E.push.apply(E,Ce([],J(iq(z,D,O).map(function(A){return a+A-P}).filter(function(A){return!J2(e,w,A)}).map(function(A){return rt(A*180/Math.PI,Ur)})),!1))})}),E}var sq=["left","right","center"],oq=["top","bottom","middle"],eD={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},sl={start:"left",end:"right",center:"center"},ol={start:"top",end:"bottom",center:"middle"};function Yu(){return{left:!1,top:!1,right:!1,bottom:!1}}function Bd(t,e){var n=t.props,r=n.snappable,i=n.bounds,a=n.innerBounds,o=n.verticalGuidelines,c=n.horizontalGuidelines,u=n.snapGridWidth,d=n.snapGridHeight,h=t.state,p=h.guidelines,m=h.enableSnap;return!r||!m||e&&r!==!0&&r.indexOf(e)<0?!1:!!(u||d||i||a||p&&p.length||o&&o.length||c&&c.length)}function oS(t){return t===!1?{}:t===!0||!t?{left:!0,right:!0,top:!0,bottom:!0}:t}function lq(t,e){var n=oS(t),r={};for(var i in n)i in e&&n[i]&&(r[i]=e[i]);return r}function lS(t,e){var n=lq(t,e),r=oq.filter(function(a){return a in n}),i=sq.filter(function(a){return a in n});return{horizontalNames:r,verticalNames:i,horizontal:r.map(function(a){return n[a]}),vertical:i.map(function(a){return n[a]})}}function cq(t,e,n){var r=hn(t,[e.clientLeft,e.clientTop],n);return[e.left+r[0],e.top+r[1]]}function uq(t){var e=J(t,2),n=e[0],r=e[1],i=r[0]-n[0],a=r[1]-n[1];Math.abs(i)<Un&&(i=0),Math.abs(a)<Un&&(a=0);var o=0,c=0,u=0;return i?a?(o=-a/i,c=1,u=o*n[0]-n[1]):(c=1,u=-n[1]):(o=-1,u=n[0]),[o,c,u].map(function(d){return rt(d,Un)})}var HP="snapRotationThreshold",$P="snapRotationDegrees",YP="snapHorizontalThreshold",KP="snapVerticalThreshold";function Nv(t,e,n,r,i,a,o){var c;r===void 0&&(r=[]),i===void 0&&(i=[]);var u=t.props,d=((c=t.state.snapThresholdInfo)===null||c===void 0?void 0:c.multiples)||[1,1],h=gD(o,u[YP],5),p=gD(a,u[KP],5);return XP(t.state.guidelines,e,n,r,i,h,p,d)}function XP(t,e,n,r,i,a,o,c){return{vertical:nD(t,"vertical",e,o*c[0],r),horizontal:nD(t,"horizontal",n,a*c[1],i)}}function dq(t,e,n){var r=J(n,2),i=r[0],a=r[1],o=J(e,2),c=o[0],u=o[1],d=J(qe(n,e),2),h=d[0],p=d[1],m=p>0,y=h>0;h=j0(h),p=j0(p);var _={isSnap:!1,offset:0,pos:0},w={isSnap:!1,offset:0,pos:0};if(h===0&&p===0)return{vertical:_,horizontal:w};var E=Nv(t,h?[i]:[],p?[a]:[],[],[],void 0,void 0),T=E.vertical,I=E.horizontal;T.posInfos.filter(function($){var H=$.pos;return y?H>=c:H<=c}),I.posInfos.filter(function($){var H=$.pos;return m?H>=u:H<=u}),T.isSnap=T.posInfos.length>0,I.isSnap=I.posInfos.length>0;var D=r_(T),O=D.isSnap,z=D.guideline,P=r_(I),A=P.isSnap,C=P.guideline,k=A?C.pos[1]:0,V=O?z.pos[0]:0;if(h===0)A&&(w.isSnap=!0,w.pos=C.pos[1],w.offset=a-w.pos);else if(p===0)O&&(_.isSnap=!0,_.pos=V,_.offset=i-V);else{var B=p/h,j=n[1]-B*i,N=0,K=0,W=!1;O?(K=V,N=B*K+j,W=!0):A&&(N=k,K=(N-j)/B,W=!0),W&&(_.isSnap=!0,_.pos=K,_.offset=i-K,w.isSnap=!0,w.pos=N,w.offset=a-N)}return{vertical:_,horizontal:w}}function $o(t){var e="";return t===-1||t==="top"||t==="left"?e="start":t===0||t==="center"||t==="middle"?e="center":(t===1||t==="right"||t==="bottom")&&(e="end"),e}function tD(t,e,n,r){var i=lS(t.props.snapDirections,e),a=Nv(t,i.vertical,i.horizontal,i.verticalNames.map(function(u){return $o(u)}),i.horizontalNames.map(function(u){return $o(u)}),n,r),o=$o(i.horizontalNames[a.horizontal.index]),c=$o(i.verticalNames[a.vertical.index]);return{vertical:Z(Z({},a.vertical),{direction:c}),horizontal:Z(Z({},a.horizontal),{direction:o})}}function r_(t){var e=t.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var n=t.posInfos[0],r=n.guidelineInfos[0],i=r.offset,a=r.dist,o=r.guideline;return{isSnap:e,offset:i,dist:a,pos:n.pos,guideline:o}}function nD(t,e,n,r,i){var a,o;if(i===void 0&&(i=[]),!t||!t.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var c=e==="vertical",u=c?0:1,d=n.map(function(p,m){var y=i[m]||"",_=t.map(function(w){var E=w.pos,T=p-E[u];return{offset:T,dist:xe(T),guideline:w,direction:y}}).filter(function(w){var E=w.guideline,T=w.dist,I=E.type;return!(I!==e||T>r)}).sort(function(w,E){return w.dist-E.dist});return{pos:p,index:m,guidelineInfos:_,direction:y}}).filter(function(p){return p.guidelineInfos.length>0}).sort(function(p,m){return p.guidelineInfos[0].dist-m.guidelineInfos[0].dist}),h=d.length>0;return{isSnap:h,index:h?d[0].index:-1,direction:(o=(a=d[0])===null||a===void 0?void 0:a.direction)!==null&&o!==void 0?o:"",posInfos:d}}function fq(t,e,n,r,i){var a=[];n[0]&&n[1]?a=[n,[-n[0],n[1]],[n[0],-n[1]]]:!n[0]&&!n[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(m,y,_){var w=_[y+1]||_[0];a.push(m),a.push([(m[0]+w[0])/2,(m[1]+w[1])/2])}):t.props.keepRatio?a.push([-1,-1],[-1,1],[1,-1],[1,1],n):(a.push.apply(a,Ce([],J(FG([[-1,-1],[1,-1],[-1,-1],[1,1]],n)),!1)),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var o=a.map(function(m){return Zn(e,m)}),c=o.map(function(m){return m[0]}),u=o.map(function(m){return m[1]}),d=Nv(t,c,u,a.map(function(m){return $o(m[0])}),a.map(function(m){return $o(m[1])}),r,i),h=$o(a.map(function(m){return m[0]})[d.vertical.index]),p=$o(a.map(function(m){return m[1]})[d.horizontal.index]);return{vertical:Z(Z({},d.vertical),{direction:h}),horizontal:Z(Z({},d.horizontal),{direction:p})}}function WP(t,e){var n=xe(t.offset),r=xe(e.offset);return t.isBound&&e.isBound?r-n:t.isBound?-1:e.isBound?1:t.isSnap&&e.isSnap?r-n:t.isSnap?-1:e.isSnap||n<Ur?1:r<Ur?-1:n-r}function M0(t,e){return t.slice().sort(function(n,r){var i=n.sign[e],a=r.sign[e],o=n.offset[e],c=r.offset[e];if(i){if(!a)return-1}else return 1;return WP({isBound:n.isBound,isSnap:n.isSnap,offset:o},{isBound:r.isBound,isSnap:r.isSnap,offset:c})})[0]}function hq(t,e,n){var r=[];if(n)xe(e[0])!==1||xe(e[1])!==1?r.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):r.push([e,[t[0],-t[1]]],[e,[-t[0],t[1]]]),r.push([e,t]);else if(t[0]&&t[1]||!t[0]&&!t[1]){var i=t[0]?t:[1,1];[1,-1].forEach(function(o){[1,-1].forEach(function(c){var u=[o*i[0],c*i[1]];e[0]===u[0]&&e[1]===u[1]||r.push([e,u])})})}else if(t[0]){var a=xe(e[0])===1?[1]:[1,-1];a.forEach(function(o){r.push([[e[0],-1],[o*t[0],-1]],[[e[0],0],[o*t[0],0]],[[e[0],1],[o*t[0],1]])})}else if(t[1]){var a=xe(e[1])===1?[1]:[1,-1];a.forEach(function(c){r.push([[-1,e[1]],[-1,c*t[1]]],[[0,e[1]],[0,c*t[1]]],[[1,e[1]],[1,c*t[1]]])})}return r}function QP(t,e){var n=Ux([e[0][0],e[1][0]]),r=Ux([e[0][1],e[1][1]]);return{vertical:n<=t[0],horizontal:r<=t[1]}}function cS(t,e){var n=J(e,2),r=n[0],i=n[1],a=i[0]-r[0],o=i[1]-r[1];xe(a)<Ur&&(a=0),xe(o)<Ur&&(o=0);var c,u;if(!a)c=r[0],u=t[0];else if(!o)c=r[1],u=t[1];else{var d=o/a;c=d*(t[0]-r[0])+r[1],u=t[1]}return c-u}function ZP(t,e,n,r){return r===void 0&&(r=Ur),t.every(function(i){var a=cS(i,e),o=a<=0;return o===n||xe(a)<=r})}function rD(t,e,n,r,i){return i===void 0&&(i=0),r&&e-i<=t||!r&&t<=n+i?{isBound:!0,offset:r?e-t:n-t}:{isBound:!1,offset:0}}function pq(t,e){var n=e.line,r=e.centerSign,i=e.verticalSign,a=e.horizontalSign,o=e.lineConstants,c=t.props.innerBounds;if(!c)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var u=c.left,d=c.top,h=c.width,p=c.height,m=[[u,d],[u,d+p]],y=[[u,d],[u+h,d]],_=[[u+h,d],[u+h,d+p]],w=[[u,d+p],[u+h,d+p]];if(ZP([[u,d],[u+h,d],[u,d+p],[u+h,d+p]],n,r))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var E=Yo(n,o,y,i),T=Yo(n,o,w,i),I=Yo(n,o,m,a),D=Yo(n,o,_,a),O=E.isBound&&T.isBound,z=E.isBound||T.isBound,P=I.isBound&&D.isBound,A=I.isBound||D.isBound,C=dd(E.offset,T.offset),k=dd(I.offset,D.offset),V=[0,0],B=!1,j=!1;return xe(k)<xe(C)?(V=[C,0],B=z,j=O):(V=[0,k],B=A,j=P),{isAllBound:j,isVerticalBound:z,isHorizontalBound:A,isBound:B,offset:V}}function Yo(t,e,n,r,i,a){var o=J(e,2),c=o[0],u=o[1],d=t[0],h=n[0],p=n[1],m=j0(p[1]-h[1]),y=j0(p[0]-h[0]),_=u,w=c,E=-c/u;if(y){if(!m){if(a&&!_)return{isBound:!1,offset:0};if(w){var O=(h[1]-d[1])/E+d[0];return rD(O,h[0],p[0],r,i)}else{var I=h[1]-d[1],D=xe(I)<=(i||0);return{isBound:D,offset:D?I:0}}}}else{if(a&&!w)return{isBound:!1,offset:0};if(_){var T=E*(h[0]-d[0])+d[1];return rD(T,h[1],p[1],r,i)}else{var I=h[0]-d[0],D=xe(I)<=(i||0);return{isBound:D,offset:D?I:0}}}return{isBound:!1,offset:0}}function JP(t,e,n){return e.map(function(r){var i=pq(t,r),a=i.isBound,o=i.offset,c=i.isVerticalBound,u=i.isHorizontalBound,d=r.multiple,h=ss({datas:n,distX:o[0],distY:o[1]}).map(function(p,m){return p*(d[m]?2/d[m]:0)});return{sign:d,isBound:a,isVerticalBound:c,isHorizontalBound:u,isSnap:!1,offset:h}})}function gq(t,e,n){var r,i=uS(t,e,[0,0],!1).map(function(m){return Z(Z({},m),{multiple:m.multiple.map(function(y){return xe(y)*2})})}),a=JP(t,i,n),o=M0(a,0),c=M0(a,1),u=0,d=0,h=o.isVerticalBound||c.isVerticalBound,p=o.isHorizontalBound||c.isHorizontalBound;return(h||p)&&(r=J(LG({datas:n,distX:-o.offset[0],distY:-c.offset[1]}),2),u=r[0],d=r[1]),{vertical:{isBound:h,offset:u},horizontal:{isBound:p,offset:d}}}function mq(t,e){var n=[],r=t[0],i=t[1];return r&&i?n.push([[0,i*2],t,[-r,i]],[[r*2,0],t,[r,-i]]):r?(n.push([[r*2,0],[r,1],[r,-1]]),e&&n.push([[0,-1],[r,-1],[-r,-1]],[[0,1],[r,1],[-r,1]])):i?(n.push([[0,i*2],[1,i],[-1,i]]),e&&n.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):n.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),n}function uS(t,e,n,r){var i=t.state,a=i.allMatrix,o=i.is3d,c=Vc(a,100,100,o?4:3),u=Zn(c,[0,0]);return mq(n,r).map(function(d){var h=J(d,3),p=h[0],m=h[1],y=h[2],_=[Zn(c,m),Zn(c,y)],w=uq(_),E=QP(u,_),T=E.vertical,I=E.horizontal,D=cS(u,_)<=0;return{multiple:p,centerSign:D,verticalSign:T,horizontalSign:I,lineConstants:w,line:[Zn(e,m),Zn(e,y)]}})}function iD(t,e,n,r){var i=r?t.map(function(a){return Ap(a,r)}):t;return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some(function(a){var o=cS(n,a)<=0;return!ZP(e,a,o)})}function vq(t){var e=J(t,2),n=e[0],r=e[1],i=r[0]-n[0],a=r[1]-n[1];if(!i)return xe(n[0]);if(!a)return xe(n[1]);var o=a/i;return xe((-o*n[0]+n[1])/Math.sqrt(Math.pow(o,2)+1))}function yq(t){var e=J(t,2),n=e[0],r=e[1],i=r[0]-n[0],a=r[1]-n[1];if(!i)return[n[0],0];if(!a)return[0,n[1]];var o=a/i,c=-o*n[0]+n[1];return[-c/(o+1/o),c/(o*o+1)]}function bq(t,e,n,r,i){var a=t.props.innerBounds,o=i*Math.PI/180;if(!a)return[];var c=a.left,u=a.top,d=a.width,h=a.height,p=c-r[0],m=c+d-r[0],y=u-r[1],_=u+h-r[1],w=[[p,y],[m,y],[p,_],[m,_]],E=Zn(n,[0,0]);if(!iD(n,w,E,0))return[];var T=[],I=w.map(function(D){return[Wi(D),kn([0,0],D)]});return[[n[0],n[1]],[n[1],n[3]],[n[3],n[2]],[n[2],n[0]]].forEach(function(D){var O=kn([0,0],yq(D)),z=vq(D);T.push.apply(T,Ce([],J(I.filter(function(P){var A=J(P,1),C=A[0];return C&&z<=C}).map(function(P){var A=J(P,2),C=A[0],k=A[1],V=Math.acos(C?z/C:0),B=k+V,j=k-V;return[o+B-O,o+j-O]}).reduce(function(P,A){return P.push.apply(P,Ce([],J(A),!1)),P},[]).filter(function(P){return!iD(e,w,E,P)}).map(function(P){return rt(P*180/Math.PI,Ur)})),!1))}),T}function xq(t){var e=t.props.innerBounds,n=Yu();if(!e)return{boundMap:n,vertical:[],horizontal:[]};var r=t.getRect(),i=r.pos1,a=r.pos2,o=r.pos3,c=r.pos4,u=[i,a,o,c],d=Zn(u,[0,0]),h=e.left,p=e.top,m=e.width,y=e.height,_=[[h,p],[h,p+y]],w=[[h,p],[h+m,p]],E=[[h+m,p],[h+m,p+y]],T=[[h,p+y],[h+m,p+y]],I=uS(t,u,[0,0],!1),D=[],O=[];return I.forEach(function(z){var P=z.line,A=z.lineConstants,C=QP(d,P),k=C.horizontal,V=C.vertical,B=Yo(P,A,w,V,1,!0),j=Yo(P,A,T,V,1,!0),N=Yo(P,A,_,k,1,!0),K=Yo(P,A,E,k,1,!0);B.isBound&&!n.top&&(D.push(p),n.top=!0),j.isBound&&!n.bottom&&(D.push(p+y),n.bottom=!0),N.isBound&&!n.left&&(O.push(h),n.left=!0),K.isBound&&!n.right&&(O.push(h+m),n.right=!0)}),{boundMap:n,horizontal:D,vertical:O}}function _q(t,e,n,r){var i=e[0]-t[0],a=e[1]-t[1];if(xe(i)<Un&&(i=0),xe(a)<Un&&(a=0),!i)return r?[0,0]:[0,n];if(!a)return r?[n,0]:[0,0];var o=a/i,c=t[1]-o*t[0];if(r){var u=o*(e[0]+n)+c;return[n,u-e[1]]}else{var d=(e[1]+n-c)/o;return[d-e[0],n]}}function i_(t,e,n,r,i){var a=_q(t,e,n,r);if(!a)return{isOutside:!1,offset:[0,0]};var o=Os(t,e),c=Os(a,t),u=Os(a,e),d=c>o||u>o,h=J(ss({datas:i,distX:a[0],distY:a[1]}),2),p=h[0],m=h[1];return{offset:[p,m],isOutside:d}}function P0(t,e){return t.isBound?t.offset:e.isSnap?r_(e).offset:0}function wq(t,e,n,r,i){var a=J(e,2),o=a[0],c=a[1],u=J(n,2),d=u[0],h=u[1],p=J(r,2),m=p[0],y=p[1],_=J(i,2),w=_[0],E=_[1],T=-w,I=-E;if(t&&o&&c){T=0,I=0;var D=[];if(d&&h?D.push([0,E],[w,0]):d?D.push([w,0]):h?D.push([0,E]):m&&y?D.push([0,E],[w,0]):m?D.push([w,0]):y&&D.push([0,E]),D.length){D.sort(function(A,C){return Wi(qe([o,c],A))-Wi(qe([o,c],C))});var O=D[0];if(O[0]&&xe(o)>Un)T=-O[0],I=c*xe(o+T)/xe(o)-c;else if(O[1]&&xe(c)>Un){var z=c;I=-O[1],T=o*xe(c+I)/xe(z)-o}if(t&&h&&d)if(xe(T)>Un&&xe(T)<xe(w)){var P=xe(w)/xe(T);T*=P,I*=P}else if(xe(I)>Un&&xe(I)<xe(E)){var P=xe(E)/xe(I);T*=P,I*=P}else T=dd(-w,T),I=dd(-E,I)}}else T=o||d?-w:0,I=c||h?-E:0;return[T,I]}function Sq(t,e,n,r,i,a){if(!Bd(t,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var o=hS(a.absolutePoses,[e,n]),c=Yi(o),u=c.left,d=c.right,h=c.top,p=c.bottom,m={horizontal:o.map(function(K){return K[1]}),vertical:o.map(function(K){return K[0]})},y=oS(t.props.snapDirections),_=lS(y,{left:u,right:d,top:h,bottom:p,center:(u+d)/2,middle:(h+p)/2}),w=Mv(t,i,_,m),E=w.vertical,T=w.horizontal,I=gq(t,o,a),D=I.vertical,O=I.horizontal,z=E.isSnap,P=T.isSnap,A=E.isBound||D.isBound,C=T.isBound||O.isBound,k=dd(E.offset,D.offset),V=dd(T.offset,O.offset),B=J(wq(r,[e,n],[A,C],[z,P],[k,V]),2),j=B[0],N=B[1];return[{isBound:A,isSnap:z,offset:j},{isBound:C,isSnap:P,offset:N}]}function Mv(t,e,n,r){r===void 0&&(r=n);var i=sS(kv(t),r.vertical,r.horizontal),a=i.horizontal,o=i.vertical,c=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:Nv(t,n.vertical,n.horizontal,void 0,void 0,void 0,void 0),u=c.horizontal,d=c.vertical,h=P0(a[0],u),p=P0(o[0],d),m=xe(h),y=xe(p);return{horizontal:{isBound:a[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:h,dist:m,bounds:a,snap:u},vertical:{isBound:o[0].isBound,isSnap:d.isSnap,snapIndex:d.index,offset:p,dist:y,bounds:o,snap:d}}}function aD(t,e,n,r,i,a,o){o===void 0&&(o=[1,1]);var c=sS(e,n,r),u=c.horizontal,d=c.vertical,h=XP(t,n,r,[],[],i,a,o),p=h.horizontal,m=h.vertical,y=P0(u[0],p),_=P0(d[0],m),w=xe(y),E=xe(_);return{horizontal:{isBound:u[0].isBound,isSnap:p.isSnap,snapIndex:p.index,offset:y,dist:w,bounds:u,snap:p},vertical:{isBound:d[0].isBound,isSnap:m.isSnap,snapIndex:m.index,offset:_,dist:E,bounds:d,snap:m}}}function Eq(t,e,n,r){var i=kn(t,e)/Math.PI*180,a=n.vertical,o=a.isBound,c=a.isSnap,u=a.dist,d=n.horizontal,h=d.isBound,p=d.isSnap,m=d.dist,y=i%180,_=y<3||y>177,w=y>87&&y<93;return m<u&&(o||c&&!w&&(!r||!_))?"vertical":h||p&&!_&&(!r||!w)?"horizontal":""}function Tq(t,e,n,r,i,a){return n.map(function(o){var c=J(o,2),u=c[0],d=c[1],h=Zn(e,u),p=Zn(e,d),m=r?Aq(t,h,p,i):Mv(t,i,{vertical:[p[0]],horizontal:[p[1]]}),y=m.horizontal,_=y.offset,w=y.isBound,E=y.isSnap,T=m.vertical,I=T.offset,D=T.isBound,O=T.isSnap,z=qe(d,u);if(!I&&!_)return{isBound:D||w,isSnap:O||E,sign:z,offset:[0,0]};var P=Eq(h,p,m,r);if(!P)return{sign:z,isBound:!1,isSnap:!1,offset:[0,0]};var A=P==="vertical",C=[0,0];return!r&&xe(d[0])===1&&xe(d[1])===1&&u[0]!==d[0]&&u[1]!==d[1]?C=ss({datas:a,distX:-I,distY:-_}):C=i_(h,p,-(A?I:_),A,a).offset,C=C.map(function(k,V){return k*(z[V]?2/z[V]:0)}),{sign:z,isBound:A?D:w,isSnap:A?O:E,offset:C}})}function sD(t,e){return t.isBound?t.offset:e.isSnap?e.offset:0}function Aq(t,e,n,r){var i=rq(t,e,n),a=i.horizontal,o=i.vertical,c=r?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:dq(t,e,n),u=c.horizontal,d=c.vertical,h=sD(a,u),p=sD(o,d),m=xe(h),y=xe(p);return{horizontal:{isBound:a.isBound,isSnap:u.isSnap,offset:h,dist:m},vertical:{isBound:o.isBound,isSnap:d.isSnap,offset:p,dist:y}}}function Cq(t,e,n,r,i){var a=[-n[0],-n[1]],o=t.state,c=o.width,u=o.height,d=t.props.bounds,h=1/0,p=1/0;if(d){var m=[[n[0],-n[1]],[-n[0],n[1]]],y=d.left,_=y===void 0?-1/0:y,w=d.top,E=w===void 0?-1/0:w,T=d.right,I=T===void 0?1/0:T,D=d.bottom,O=D===void 0?1/0:D;m.forEach(function(z){var P=z[0]!==a[0],A=z[1]!==a[1],C=Zn(e,z),k=kn(r,C)*360/Math.PI;if(A){var V=C.slice();(xe(k-360)<2||xe(k-180)<2)&&(V[1]=r[1]);var B=i_(r,V,(r[1]<C[1]?O:E)-C[1],!1,i),j=J(B.offset,2),N=j[1],K=B.isOutside;isNaN(N)||(p=u+(K?1:-1)*xe(N))}if(P){var V=C.slice();(xe(k-90)<2||xe(k-270)<2)&&(V[0]=r[0]);var W=i_(r,V,(r[0]<C[0]?I:_)-C[0],!0,i),$=J(W.offset,1),H=$[0],te=W.isOutside;isNaN(H)||(h=c+(te?1:-1)*xe(H))}})}return{maxWidth:h,maxHeight:p}}var Or={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(t,e){var n=t.props,r=n.hideThrottleDragRotateLine,i=n.throttleDragRotate,a=n.zoom,o=t.getState(),c=o.dragInfo,u=o.beforeOrigin;if(r||!i||!c)return[];var d=c.dist;if(!d[0]&&!d[1])return[];var h=Wi(d),p=kn(d,[0,0]);return[e.createElement("div",{className:Be("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(h,"px"),transform:"translate(".concat(u[0],"px, ").concat(u[1],"px) rotate(").concat(p,"rad) scaleY(").concat(a,")")}})]},dragStart:function(t,e){var n=e.datas,r=e.parentEvent,i=e.parentGesto,a=t.state,o=a.gestos,c=a.style;if(o.draggable)return!1;o.draggable=i||t.targetGesto,n.datas={},n.left=parseFloat(c.left||"")||0,n.top=parseFloat(c.top||"")||0,n.bottom=parseFloat(c.bottom||"")||0,n.right=parseFloat(c.right||"")||0,n.startValue=[0,0],Oc(t,e),Rv(t,e,"translate"),$q(t,n),n.prevDist=[0,0],n.prevBeforeDist=[0,0],n.isDrag=!1,n.deltaOffset=[0,0];var u=lt(t,e,Z({set:function(h){n.startValue=h}},Dv(t,e))),d=r||Ne(t,"onDragStart",u);return d!==!1?(n.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(o.draggable=null,n.isPinch=!1),n.isDrag?u:!1},drag:function(t,e){if(e){Cv(t,e,"translate");var n=e.datas,r=e.parentEvent,i=e.parentFlag,a=e.isPinch,o=e.deltaOffset,c=e.useSnap,u=e.isRequest,d=e.isGroup,h=e.parentThrottleDrag,p=e.distX,m=e.distY,y=n.isDrag,_=n.prevDist,w=n.prevBeforeDist,E=n.startValue;if(y){o&&(p+=o[0],m+=o[1]);var T=t.props,I=T.parentMoveable,D=d?0:T.throttleDrag||h||0,O=r?0:T.throttleDragRotate||0,z=0,P=!1,A=!1,C=!1,k=!1;if(!r&&O>0&&(p||m)){var V=T.startDragRotate||0,B=rt(V+kn([0,0],[p,m])*180/Math.PI,O)-V,j=m*Math.abs(Math.cos((B-90)/180*Math.PI)),N=p*Math.abs(Math.cos(B/180*Math.PI)),K=Wi([N,j]);z=B*Math.PI/180,p=K*Math.cos(z),m=K*Math.sin(z)}if(!a&&!r&&!i){var W=J(Sq(t,p,m,O,!c&&u||o,n),2),$=W[0],H=W[1];P=$.isSnap,A=$.isBound,C=H.isSnap,k=H.isBound;var te=$.offset,re=H.offset;p+=te,m+=re}var ue=Tt(PP({datas:n,distX:p,distY:m}),E),F=Tt(zG({datas:n,distX:p,distY:m}),E);L2(F,Ur),L2(ue,Ur),O||(!P&&!A&&(F[0]=rt(F[0],D),ue[0]=rt(ue[0],D)),!C&&!k&&(F[1]=rt(F[1],D),ue[1]=rt(ue[1],D)));var Q=qe(ue,E),Y=qe(F,E),ne=qe(Y,_),pe=qe(Q,w);n.prevDist=Y,n.prevBeforeDist=Q,n.passDelta=ne,n.passDist=Y;var de=n.left+Q[0],ge=n.top+Q[1],we=n.right-Q[0],Te=n.bottom-Q[1],Xe=Iv(n,"translate(".concat(F[0],"px, ").concat(F[1],"px)"),"translate(".concat(Y[0],"px, ").concat(Y[1],"px)"));if(iS(e,Xe),t.state.dragInfo.dist=r?[0,0]:Y,!(!r&&!I&&ne.every(function($e){return!$e})&&pe.some(function($e){return!$e}))){var Se=t.state,Ie=Se.width,Je=Se.height,Me=lt(t,e,Z({transform:Xe,dist:Y,delta:ne,translate:F,beforeDist:Q,beforeDelta:pe,beforeTranslate:ue,left:de,top:ge,right:we,bottom:Te,width:Ie,height:Je,isPinch:a},Lr({transform:Xe},e)));return!r&&Ne(t,"onDrag",Me),Me}}}},dragAfter:function(t,e){var n=e.datas,r=n.deltaOffset;return r[0]||r[1]?(n.deltaOffset=[0,0],this.drag(t,Z(Z({},e),{deltaOffset:r}))):!1},dragEnd:function(t,e){var n=e.parentEvent,r=e.datas;if(t.state.dragInfo=null,!!r.isDrag){r.isDrag=!1;var i=_i(t,e,{});return!n&&Ne(t,"onDragEnd",i),i}},dragGroupStart:function(t,e){var n,r,i=e.datas,a=e.clientX,o=e.clientY,c=this.dragStart(t,e);if(!c)return!1;var u=B1(t,this,"dragStart",[a||0,o||0],e,!1,"draggable"),d=u.childEvents,h=u.eventParams,p=Z(Z({},c),{targets:t.props.targets,events:h}),m=Ne(t,"onDragGroupStart",p);i.isDrag=m!==!1;var y=(r=(n=d[0])===null||n===void 0?void 0:n.datas.startValue)!==null&&r!==void 0?r:[0,0];return i.throttleOffset=[y[0]%1,y[1]%1],i.isDrag?c:!1},dragGroup:function(t,e){var n=e.datas;if(n.isDrag){var r=this.drag(t,Z(Z({},e),{parentThrottleDrag:t.props.throttleDrag})),i=e.datas.passDelta,a=B1(t,this,"drag",i,e,!1,"draggable").eventParams;if(r){var o=Z({targets:t.props.targets,events:a},r);return Ne(t,"onDragGroup",o),o}}},dragGroupEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isDrag){this.dragEnd(t,e);var i=B1(t,this,"dragEnd",[0,0],e,!1,"draggable").eventParams;return Ne(t,"onDragGroupEnd",_i(t,e,{targets:t.props.targets,events:i})),n}},request:function(t){var e={},n=t.getRect(),r=0,i=0,a=!1;return{isControl:!1,requestStart:function(o){return a=o.useSnap,{datas:e,useSnap:a}},request:function(o){return"x"in o?r=o.x-n.left:"deltaX"in o&&(r+=o.deltaX),"y"in o?i=o.y-n.top:"deltaY"in o&&(i+=o.deltaY),{datas:e,distX:r,distY:i,useSnap:a}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:a}}}},unset:function(t){t.state.gestos.draggable=null,t.state.dragInfo=null}};function eO(t,e){var n=Zn(t,e),r=[0,0];return{fixedPosition:n,fixedDirection:e,fixedOffset:r}}function Iq(t,e){var n=t.allMatrix,r=t.is3d,i=t.width,a=t.height,o=r?4:3,c=[i/2*(1+e[0]),a/2*(1+e[1])],u=hn(n,c,o),d=[0,0];return{fixedPosition:u,fixedDirection:e,fixedOffset:d}}function tO(t,e){var n=t.allMatrix,r=t.is3d,i=t.width,a=t.height,o=r?4:3,c=$G(e,i,a),u=hn(n,e,o),d=[i?0:e[0],a?0:e[1]];return{fixedPosition:u,fixedDirection:c,fixedOffset:d}}var oD=mS("resizable"),a_={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:UP("resizable"),dragControlCondition:oD,viewClassName:gS("resizable"),dragControlStart:function(t,e){var n,r=e.inputEvent,i=e.isPinch,a=e.isGroup,o=e.parentDirection,c=e.parentGesto,u=e.datas,d=e.parentFixedDirection,h=e.parentEvent,p=pO(o,i,r,u),m=t.state,y=m.target,_=m.width,w=m.height,E=m.gestos;if(!p||!y||E.resizable)return!1;E.resizable=c||t.controlGesto,!i&&Oc(t,e),u.datas={},u.direction=p,u.startOffsetWidth=_,u.startOffsetHeight=w,u.prevWidth=0,u.prevHeight=0,u.minSize=[0,0],u.startWidth=m.inlineCSSWidth||m.cssWidth,u.startHeight=m.inlineCSSHeight||m.cssHeight,u.maxSize=[1/0,1/0],a||(u.minSize=[m.minOffsetWidth,m.minOffsetHeight],u.maxSize=[m.maxOffsetWidth,m.maxOffsetHeight]);var T=t.props.transformOrigin||"% %";u.transformOrigin=ii(T)?T.split(" "):T,u.startOffsetMatrix=m.offsetMatrix,u.startTransformOrigin=m.transformOrigin,u.isWidth=(n=e?.parentIsWidth)!==null&&n!==void 0?n:!p[0]&&!p[1]||p[0]||!p[1];function I(k){u.ratio=k&&isFinite(k)?k:0}u.startPositions=Qi(t.state);function D(k){var V=eO(u.startPositions,k);u.fixedDirection=V.fixedDirection,u.fixedPosition=V.fixedPosition,u.fixedOffset=V.fixedOffset}function O(k){var V=tO(t.state,k);u.fixedDirection=V.fixedDirection,u.fixedPosition=V.fixedPosition,u.fixedOffset=V.fixedOffset}function z(k){u.minSize=[$t("".concat(k[0]),0)||0,$t("".concat(k[1]),0)||0]}function P(k){var V=[k[0]||1/0,k[1]||1/0];(!od(V[0])||isFinite(V[0]))&&(V[0]=$t("".concat(V[0]),0)||1/0),(!od(V[1])||isFinite(V[1]))&&(V[1]=$t("".concat(V[1]),0)||1/0),u.maxSize=V}I(_/w),D(d||[-p[0],-p[1]]),u.setFixedDirection=D,u.setFixedPosition=O,u.setMin=z,u.setMax=P;var A=lt(t,e,{direction:p,startRatio:u.ratio,set:function(k){var V=J(k,2),B=V[0],j=V[1];u.startWidth=B,u.startHeight=j},setMin:z,setMax:P,setRatio:I,setFixedDirection:D,setFixedPosition:O,setOrigin:function(k){u.transformOrigin=k},dragStart:Or.dragStart(t,new cd().dragStart([0,0],e))}),C=h||Ne(t,"onResizeStart",A);return u.startFixedDirection=u.fixedDirection,u.startFixedPosition=u.fixedPosition,C!==!1&&(u.isResize=!0,t.state.snapRenderInfo={request:e.isRequest,direction:p}),u.isResize?A:!1},dragControl:function(t,e){var n,r=e.datas,i=e.parentFlag,a=e.isPinch,o=e.parentKeepRatio,c=e.dragClient,u=e.parentDist,d=e.useSnap,h=e.isRequest,p=e.isGroup,m=e.parentEvent,y=e.resolveMatrix,_=r.isResize,w=r.transformOrigin,E=r.startWidth,T=r.startHeight,I=r.prevWidth,D=r.prevHeight,O=r.minSize,z=r.maxSize,P=r.ratio,A=r.startOffsetWidth,C=r.startOffsetHeight,k=r.isWidth;if(!_)return;if(y){var V=t.state.is3d,B=r.startOffsetMatrix,j=r.startTransformOrigin,N=V?4:3,K=$h(k0(e)),W=Math.sqrt(K.length);N!==W&&(K=ya(K,W,N));var $=kp(B,K,j,N),H=Vc($,A,C,N);r.startPositions=H,r.nextTargetMatrix=K,r.nextAllMatrix=$}var te=_c(t.props,"resizable"),re=te.resizeFormat,ue=te.throttleResize,F=ue===void 0?i?0:1:ue,Q=te.parentMoveable,Y=te.keepRatioFinally,ne=r.direction,pe=ne,de=0,ge=0;!ne[0]&&!ne[1]&&(pe=[1,1]);var we=P&&(o??te.keepRatio)||!1;function Te(){var ht=r.fixedDirection,At=xO(pe,we,r,e);de=At.distWidth,ge=At.distHeight;var Ft=pe[0]-ht[0]||we?Math.max(A+de,Ur):A,lr=pe[1]-ht[1]||we?Math.max(C+ge,Ur):C;return we&&A&&C&&(k?lr=Ft/P:Ft=lr*P),[Ft,lr]}var Xe=J(Te(),2),Se=Xe[0],Ie=Xe[1];m||(r.setFixedDirection(r.fixedDirection),Ne(t,"onBeforeResize",lt(t,e,{startFixedDirection:r.startFixedDirection,startFixedPosition:r.startFixedPosition,setFixedDirection:function(ht){var At;return r.setFixedDirection(ht),At=J(Te(),2),Se=At[0],Ie=At[1],[Se,Ie]},setFixedPosition:function(ht){var At;return r.setFixedPosition(ht),At=J(Te(),2),Se=At[0],Ie=At[1],[Se,Ie]},boundingWidth:Se,boundingHeight:Ie,setSize:function(ht){var At;At=J(ht,2),Se=At[0],Ie=At[1]}},!0)));var Je=c;c||(!i&&a?Je=WG(t,[0,0]):Je=r.fixedPosition);var Me=[0,0];a||(Me=qq(t,Se,Ie,ne,Je,!d&&h,r)),u&&(!u[0]&&(Me[0]=0),!u[1]&&(Me[1]=0));function $e(){var ht;re&&(ht=J(re([Se,Ie]),2),Se=ht[0],Ie=ht[1]),Se=rt(Se,F),Ie=rt(Ie,F)}if(we){pe[0]&&pe[1]&&Me[0]&&Me[1]&&(xe(Me[0])>xe(Me[1])?Me[1]=0:Me[0]=0);var We=!Me[0]&&!Me[1];We&&$e(),pe[0]&&!pe[1]||Me[0]&&!Me[1]||We&&k?(Se+=Me[0],Ie=Se/P):(!pe[0]&&pe[1]||!Me[0]&&Me[1]||We&&!k)&&(Ie+=Me[1],Se=Ie*P)}else Se+=Me[0],Ie+=Me[1],Se=Math.max(0,Se),Ie=Math.max(0,Ie);n=J($M([Se,Ie],O,z,we?P:!1),2),Se=n[0],Ie=n[1],$e(),we&&(p||Y)&&(k?Ie=Se/P:Se=Ie*P),de=Se-A,ge=Ie-C;var pt=[de-I,ge-D];r.prevWidth=de,r.prevHeight=ge;var _t=XG(t,Se,Ie,Je,w,r);if(!(!Q&&pt.every(function(ht){return!ht})&&_t.every(function(ht){return!ht}))){var Pe=Or.drag(t,Rp(e,t.state,_t,!!a,!1,"draggable")),Ue=Pe.transform,Pt=E+de,yn=T+ge,Wt=lt(t,e,Z({width:Pt,height:yn,offsetWidth:Math.round(Se),offsetHeight:Math.round(Ie),startRatio:P,boundingWidth:Se,boundingHeight:Ie,direction:ne,dist:[de,ge],delta:pt,isPinch:!!a,drag:Pe},mO({style:{width:"".concat(Pt,"px"),height:"".concat(yn,"px")},transform:Ue},Pe,e)));return!m&&Ne(t,"onResize",Wt),Wt}},dragControlAfter:function(t,e){var n=e.datas,r=n.isResize,i=n.startOffsetWidth,a=n.startOffsetHeight,o=n.prevWidth,c=n.prevHeight;if(!(!r||t.props.checkResizableError===!1)){var u=t.state,d=u.width,h=u.height,p=d-(i+o),m=h-(a+c),y=xe(p)>3,_=xe(m)>3;if(y&&(n.startWidth+=p,n.startOffsetWidth+=p,n.prevWidth+=p),_&&(n.startHeight+=m,n.startOffsetHeight+=m,n.prevHeight+=m),y||_)return this.dragControl(t,e)}},dragControlEnd:function(t,e){var n=e.datas,r=e.parentEvent;if(n.isResize){n.isResize=!1;var i=_i(t,e,{});return!r&&Ne(t,"onResizeEnd",i),i}},dragGroupControlCondition:oD,dragGroupControlStart:function(t,e){var n=e.datas,r=this.dragControlStart(t,Z(Z({},e),{isGroup:!0}));if(!r)return!1;var i=ga(t,"resizable",e),a=n.startOffsetWidth,o=n.startOffsetHeight;function c(){var y=n.minSize;i.forEach(function(_){var w=_.datas,E=w.minSize,T=w.startOffsetWidth,I=w.startOffsetHeight,D=a*(T?E[0]/T:0),O=o*(I?E[1]/I:0);y[0]=Math.max(y[0],D),y[1]=Math.max(y[1],O)})}function u(){var y=n.maxSize;i.forEach(function(_){var w=_.datas,E=w.maxSize,T=w.startOffsetWidth,I=w.startOffsetHeight,D=a*(T?E[0]/T:0),O=o*(I?E[1]/I:0);y[0]=Math.min(y[0],D),y[1]=Math.min(y[1],O)})}var d=Vs(t,this,"dragControlStart",e,function(y,_){return N0(t,y,n,_)});c(),u();var h=function(y){r.setFixedDirection(y),d.forEach(function(_,w){_.setFixedDirection(y),N0(t,_.moveable,n,i[w])})};n.setFixedDirection=h;var p=Z(Z({},r),{targets:t.props.targets,events:d.map(function(y){return Z(Z({},y),{setMin:function(_){y.setMin(_),c()},setMax:function(_){y.setMax(_),u()}})}),setFixedDirection:h,setMin:function(y){r.setMin(y),c()},setMax:function(y){r.setMax(y),u()}}),m=Ne(t,"onResizeGroupStart",p);return n.isResize=m!==!1,n.isResize?r:!1},dragGroupControl:function(t,e){var n=e.datas;if(n.isResize){var r=_c(t.props,"resizable");Ov(t,"onBeforeResize",function(y){Ne(t,"onBeforeResizeGroup",lt(t,e,Z(Z({},y),{targets:r.targets}),!0))});var i=this.dragControl(t,Z(Z({},e),{isGroup:!0}));if(i){var a=i.boundingWidth,o=i.boundingHeight,c=i.dist,u=r.keepRatio,d=[a/(a-c[0]),o/(o-c[1])],h=n.fixedPosition,p=Vs(t,this,"dragControl",e,function(y,_){var w=J(Rr(Cp(t.rotation/180*Math.PI,3),[_.datas.originalX*d[0],_.datas.originalY*d[1],1],3),2),E=w[0],T=w[1];return Z(Z({},_),{parentDist:null,parentScale:d,dragClient:Tt(h,[E,T]),parentKeepRatio:u})}),m=Z({targets:r.targets,events:p},i);return Ne(t,"onResizeGroup",m),m}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isResize){this.dragControlEnd(t,e);var i=Vs(t,this,"dragControlEnd",e),a=_i(t,e,{targets:t.props.targets,events:i});return Ne(t,"onResizeGroupEnd",a),n}},request:function(t){var e={},n=0,r=0,i=!1,a=t.getRect();return{isControl:!0,requestStart:function(o){var c;return i=o.useSnap,{datas:e,parentDirection:o.direction||[1,1],parentIsWidth:(c=o?.horizontal)!==null&&c!==void 0?c:!0,useSnap:i}},request:function(o){return"offsetWidth"in o?n=o.offsetWidth-a.offsetWidth:"deltaWidth"in o&&(n+=o.deltaWidth),"offsetHeight"in o?r=o.offsetHeight-a.offsetHeight:"deltaHeight"in o&&(r+=o.deltaHeight),{datas:e,parentDist:[n,r],parentKeepRatio:o.keepRatio,useSnap:i}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:i}}}},unset:function(t){t.state.gestos.resizable=null}};function F1(t,e,n,r,i){var a=t.props.groupable,o=t.state,c=o.is3d?4:3,u=e.origin,d=hn(t.state.rootMatrix,qe([u[0],u[1]],a?[0,0]:[o.left,o.top]),c),h=Tt([i.left,i.top],d);e.startAbsoluteOrigin=h,e.prevDeg=kn(h,[n,r])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=Os(h,[n,r])}function n0(t,e,n){var r=n.defaultDeg,i=n.prevDeg,a=i%360,o=Math.floor(i/360);a<0&&(a+=360),a>t&&a>270&&t<90?++o:a<t&&a<90&&t>270&&--o;var c=e*(o*360+t-r);return n.prevDeg=r+c,c}function U1(t,e,n,r){return n0(kn(r.startAbsoluteOrigin,[t,e])/Math.PI*180,n,r)}function G1(t,e,n,r,i,a){var o=t.props.throttleRotate,c=o===void 0?0:o,u=n.prevSnapDeg,d=0,h=!1;if(a){var p=Gq(t,e,r,i+r);h=p.isSnap,d=i+p.dist}h||(d=rt(i+r,c));var m=d-i;return n.prevSnapDeg=m,[m-u,m,d]}function nO(t,e,n){var r=J(e,4),i=r[0],a=r[1],o=r[2],c=r[3];if(t==="none")return[];if(qn(t))return t.map(function(E){return nO(E,[i,a,o,c],n)[0]});var u=J((t||"top").split("-"),2),d=u[0],h=u[1],p=[i,a];d==="left"?p=[o,i]:d==="right"?p=[a,c]:d==="bottom"&&(p=[c,o]);var m=[(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2],y=fO(p,n);if(h){var _=h==="top"||h==="left",w=d==="bottom"||d==="left";m=p[_&&!w||!_&&w?0:1]}return[[m,y]]}function s_(t,e){if(e.isRequest)return e.requestAble==="rotatable";var n=e.inputEvent.target;if(Qn(n,Be("rotation-control"))||t.props.rotateAroundControls&&Qn(n,Be("around-control"))||Qn(n,Be("control"))&&Qn(n,Be("rotatable")))return!0;var r=t.props.rotationTarget;return r?vS(r,!0).some(function(i){return i?n===i||n.contains(i):!1}):!1}var Dq=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,Rq={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[Dq],viewClassName:function(t){return t.isDragging("rotatable")?Be("view-rotation-dragging"):""},render:function(t,e){var n=_c(t.props,"rotatable"),r=n.rotatable,i=n.rotationPosition,a=n.zoom,o=n.renderDirections,c=n.rotateAroundControls,u=n.resolveAblesWithRotatable,d=t.getState(),h=d.renderPoses,p=d.direction;if(!r)return null;var m=nO(i,h,p),y=[];if(m.forEach(function(T,I){var D=J(T,2),O=D[0],z=D[1];y.push(e.createElement("div",{key:"rotation".concat(I),className:Be("rotation"),style:{transform:"translate(-50%) translate(".concat(O[0],"px, ").concat(O[1],"px) rotate(").concat(z,"rad)")}},e.createElement("div",{className:Be("line rotation-line"),style:{transform:"scaleX(".concat(a,")")}}),e.createElement("div",{className:Be("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(a,")")}})))}),o){var _=Us(u||{}),w={};_.forEach(function(T){u[T].forEach(function(I){w[I]=T})});var E=[];qn(o)&&(E=o.map(function(T){var I=w[T];return{data:I?{resolve:I}:{},classNames:I?["move"]:[],dir:T}})),y.push.apply(y,Ce([],J(LP(t,"rotatable",E,e)),!1))}return c&&y.push.apply(y,Ce([],J(qP(t,e)),!1)),y},dragControlCondition:s_,dragControlStart:function(t,e){var n,r,i=e.datas,a=e.clientX,o=e.clientY,c=e.parentRotate,u=e.parentFlag,d=e.isPinch,h=e.isRequest,p=t.state,m=p.target,y=p.left,_=p.top,w=p.direction,E=p.beforeDirection,T=p.targetTransform,I=p.moveableClientRect,D=p.offsetMatrix,O=p.targetMatrix,z=p.allMatrix,P=p.width,A=p.height;if(!h&&!m)return!1;var C=t.getRect();i.rect=C,i.transform=T,i.left=y,i.top=_;var k=function(pe){var de=tO(t.state,pe);i.fixedDirection=de.fixedDirection,i.fixedOffset=de.fixedOffset,i.fixedPosition=de.fixedPosition,F&&F.setFixedPosition(pe)},V=function(pe){var de=Iq(t.state,pe);i.fixedDirection=de.fixedDirection,i.fixedOffset=de.fixedOffset,i.fixedPosition=de.fixedPosition,F&&F.setFixedDirection(pe)},B=a,j=o;if(h||d||u){var N=c||0;i.beforeInfo={origin:C.beforeOrigin,prevDeg:N,defaultDeg:N,prevSnapDeg:0,startDist:0},i.afterInfo=Z(Z({},i.beforeInfo),{origin:C.origin}),i.absoluteInfo=Z(Z({},i.beforeInfo),{origin:C.origin,startValue:N})}else{var K=(r=e.inputEvent)===null||r===void 0?void 0:r.target;if(K){var W=K.getAttribute("data-direction")||"",$=VG[W];if($){i.isControl=!0,i.isAroundControl=Qn(K,Be("around-control")),i.controlDirection=$;var H=K.getAttribute("data-resolve");H&&(i.resolveAble=H);var te=aH(p.rootMatrix,p.renderPoses,I);n=J(Zn(te,$),2),B=n[0],j=n[1]}}i.beforeInfo={origin:C.beforeOrigin},i.afterInfo={origin:C.origin},i.absoluteInfo={origin:C.origin,startValue:C.rotation};var re=k;k=function(pe){var de=p.is3d?4:3,ge=J(Tt(yP(O,de),pe),2),we=ge[0],Te=ge[1],Xe=Rr(D,yc([we,Te],de)),Se=Rr(z,yc([pe[0],pe[1]],de));re(pe);var Ie=p.posDelta;i.beforeInfo.origin=qe(Xe,Ie),i.afterInfo.origin=qe(Se,Ie),i.absoluteInfo.origin=qe(Se,Ie),F1(t,i.beforeInfo,B,j,I),F1(t,i.afterInfo,B,j,I),F1(t,i.absoluteInfo,B,j,I)},V=function(pe){var de=Zn([[0,0],[P,0],[0,A],[P,A]],pe);k(de)}}i.startClientX=B,i.startClientY=j,i.direction=w,i.beforeDirection=E,i.startValue=0,i.datas={},Rv(t,e,"rotate");var ue=!1,F=!1;if(i.isControl&&i.resolveAble){var Q=i.resolveAble;Q==="resizable"&&(F=a_.dragControlStart(t,Z(Z({},new cd("resizable").dragStart([0,0],e)),{parentPosition:i.controlPosition,parentFixedPosition:i.fixedPosition})))}F||(ue=Or.dragStart(t,new cd().dragStart([0,0],e))),k(sH(t));var Y=lt(t,e,Z(Z({set:function(pe){i.startValue=pe*Math.PI/180},setFixedDirection:V,setFixedPosition:k},Dv(t,e)),{dragStart:ue,resizeStart:F})),ne=Ne(t,"onRotateStart",Y);return i.isRotate=ne!==!1,p.snapRenderInfo={request:e.isRequest},i.isRotate?Y:!1},dragControl:function(t,e){var n,r,i,a=e.datas,o=e.clientDistX,c=e.clientDistY,u=e.parentRotate,d=e.parentFlag,h=e.isPinch,p=e.groupDelta,m=e.resolveMatrix,y=a.beforeDirection,_=a.beforeInfo,w=a.afterInfo,E=a.absoluteInfo,T=a.isRotate,I=a.startValue,D=a.rect,O=a.startClientX,z=a.startClientY;if(T){Cv(t,e,"rotate");var P=jG(e),A=y*P,C=t.props.parentMoveable,k=0,V,B,j=0,N,K,W=0,$,H,te=180/Math.PI*I,re=E.startValue,ue=!1,F=O+o,Q=z+c;if(!d&&"parentDist"in e){var Y=e.parentDist;V=Y,N=Y,$=Y}else h||d?(V=n0(u,y,_),N=n0(u,A,w),$=n0(u,A,E)):(V=U1(F,Q,y,_),N=U1(F,Q,A,w),$=U1(F,Q,A,E),ue=!0);if(B=te+V,K=te+N,H=re+$,Ne(t,"onBeforeRotate",lt(t,e,{beforeRotation:B,rotation:K,absoluteRotation:H,setRotation:function(Je){N=Je-te,V=N,$=N}},!0)),n=J(G1(t,D,_,V,te,ue),3),k=n[0],V=n[1],B=n[2],r=J(G1(t,D,w,N,te,ue),3),j=r[0],N=r[1],K=r[2],i=J(G1(t,D,E,$,re,ue),3),W=i[0],$=i[1],H=i[2],!(!W&&!j&&!k&&!C&&!m)){var ne=Iv(a,"rotate(".concat(K,"deg)"),"rotate(".concat(N,"deg)"));m&&(a.fixedPosition=aS(t,a.targetAllTransform,a.fixedDirection,a.fixedOffset,a));var pe=KG(t,N,a),de=qe(Tt(p||[0,0],pe),a.prevInverseDist||[0,0]);a.prevInverseDist=pe,a.requestValue=null;var ge=VP(t,ne,de,h,e),we=ge,Te=Os([F,Q],E.startAbsoluteOrigin)-E.startDist,Xe=void 0;if(a.resolveAble==="resizable"){var Se=a_.dragControl(t,Z(Z({},Rp(e,t.state,[e.deltaX,e.deltaY],!!h,!1,"resizable")),{resolveMatrix:!0,parentDistance:Te}));Se&&(Xe=Se,we=mO(we,Se,e))}var Ie=lt(t,e,Z(Z({delta:j,dist:N,rotate:K,rotation:K,beforeDist:V,beforeDelta:k,beforeRotate:B,beforeRotation:B,absoluteDist:$,absoluteDelta:W,absoluteRotate:H,absoluteRotation:H,isPinch:!!h,resize:Xe},ge),we));return Ne(t,"onRotate",Ie),Ie}}},dragControlEnd:function(t,e){var n=e.datas;if(n.isRotate){n.isRotate=!1;var r=_i(t,e,{});return Ne(t,"onRotateEnd",r),r}},dragGroupControlCondition:s_,dragGroupControlStart:function(t,e){var n=e.datas,r=t.state,i=r.left,a=r.top,o=r.beforeOrigin,c=this.dragControlStart(t,e);if(!c)return!1;c.set(n.beforeDirection*t.rotation);var u=Vs(t,this,"dragControlStart",e,function(p,m){var y=p.state,_=y.left,w=y.top,E=y.beforeOrigin,T=Tt(qe([_,w],[i,a]),qe(E,o));return m.datas.startGroupClient=T,m.datas.groupClient=T,Z(Z({},m),{parentRotate:0})}),d=Z(Z({},c),{targets:t.props.targets,events:u}),h=Ne(t,"onRotateGroupStart",d);return n.isRotate=h!==!1,n.isRotate?c:!1},dragGroupControl:function(t,e){var n=e.datas;if(n.isRotate){Ov(t,"onBeforeRotate",function(d){Ne(t,"onBeforeRotateGroup",lt(t,e,Z(Z({},d),{targets:t.props.targets}),!0))});var r=this.dragControl(t,e);if(r){var i=n.beforeDirection,a=r.beforeDist,o=a/180*Math.PI,c=Vs(t,this,"dragControl",e,function(d,h){var p=h.datas.startGroupClient,m=J(h.datas.groupClient,2),y=m[0],_=m[1],w=J(Ap(p,o*i),2),E=w[0],T=w[1],I=[E-y,T-_];return h.datas.groupClient=[E,T],Z(Z({},h),{parentRotate:a,groupDelta:I})});t.rotation=i*r.beforeRotation;var u=Z({targets:t.props.targets,events:c,set:function(d){t.rotation=d},setGroupRotation:function(d){t.rotation=d}},r);return Ne(t,"onRotateGroup",u),u}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isRotate){this.dragControlEnd(t,e);var i=Vs(t,this,"dragControlEnd",e),a=_i(t,e,{targets:t.props.targets,events:i});return Ne(t,"onRotateGroupEnd",a),n}},request:function(t){var e={},n=0,r=t.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(i){return"deltaRotate"in i?n+=i.deltaRotate:"rotate"in i&&(n=i.rotate-r),{datas:e,parentDist:n}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function kq(t,e){var n,r=t.direction,i=t.classNames,a=t.size,o=t.pos,c=t.zoom,u=t.key,d=r==="horizontal",h=d?"Y":"X";return e.createElement("div",{key:u,className:i.join(" "),style:(n={},n[d?"width":"height"]="".concat(a),n.transform="translate(".concat(o[0],", ").concat(o[1],") translate").concat(h,"(-50%) scale").concat(h,"(").concat(c,")"),n)})}function dS(t,e){return kq(Z(Z({},t),{classNames:Ce([Be("line","guideline",t.direction)],J(t.classNames),!1).filter(function(n){return n}),size:t.size||"".concat(t.sizeValue,"px"),pos:t.pos||t.posValue.map(function(n){return"".concat(rt(n,.1),"px")})}),e)}function lD(t,e,n,r,i,a,o,c){var u=t.props.zoom;return n.map(function(d,h){var p=d.type,m=d.pos,y=[0,0];return y[o]=r,y[o?0:1]=-i+m,dS({key:"".concat(e,"TargetGuideline").concat(h),classNames:[Be("target","bold",p)],posValue:y,sizeValue:a,zoom:u,direction:e},c)})}function cD(t,e,n,r,i,a){var o=t.props,c=o.zoom,u=o.isDisplayInnerSnapDigit,d=e==="horizontal"?sl:ol,h=i[d.start],p=i[d.end];return n.filter(function(m){var y=m.hide,_=m.elementRect;if(y)return!1;if(u&&_){var w=_.rect;if(w[d.start]<=h&&p<=w[d.end])return!1}return!0}).map(function(m,y){var _=m.pos,w=m.size,E=m.element,T=m.className,I=[-r[0]+_[0],-r[1]+_[1]];return dS({key:"".concat(e,"-default-guideline-").concat(y),classNames:E?[Be("bold"),T]:[Be("normal"),T],direction:e,posValue:I,sizeValue:w,zoom:c},a)})}function ih(t,e,n,r,i,a,o,c){var u,d=t.props,h=d.snapDigit,p=h===void 0?0:h,m=d.isDisplaySnapDigit,y=m===void 0?!0:m,_=d.snapDistFormat,w=_===void 0?function(z,P){return z}:_,E=d.zoom,T=e==="horizontal"?"X":"Y",I=e==="vertical"?"height":"width",D=Math.abs(i),O=y?parseFloat(D.toFixed(p)):0;return c.createElement("div",{key:"".concat(e,"-").concat(n,"-guideline-").concat(r),className:Be("guideline-group",e),style:(u={left:"".concat(a[0],"px"),top:"".concat(a[1],"px")},u[I]="".concat(D,"px"),u)},dS({direction:e,classNames:[Be(n),o],size:"100%",posValue:[0,0],sizeValue:D,zoom:E},c),c.createElement("div",{className:Be("size-value","gap"),style:{transform:"translate".concat(T,"(-50%) scale(").concat(E,")")}},O>0?w(O,e):""))}function Nq(t,e,n,r){var i=t==="vertical"?0:1,a=t==="vertical"?1:0,o=i?sl:ol,c=n[o.start],u=n[o.end];return vO(e,function(d){return d.pos[i]}).map(function(d){var h=[],p=[],m=[];return d.forEach(function(y){var _,w,E=y.element,T=y.elementRect.rect;if(T[o.end]<c)h.push(y);else if(u<T[o.start])p.push(y);else if(T[o.start]<=c&&u<=T[o.end]&&r){var I=y.pos,D={element:E,rect:Z(Z({},T),(_={},_[o.end]=T[o.start],_))},O={element:E,rect:Z(Z({},T),(w={},w[o.start]=T[o.end],w))},z=[0,0],P=[0,0];z[i]=I[i],z[a]=I[a],P[i]=I[i],P[a]=I[a]+y.size,h.push({type:t,pos:z,size:0,elementRect:D,direction:"",elementDirection:"end"}),p.push({type:t,pos:P,size:0,elementRect:O,direction:"",elementDirection:"start"})}}),h.sort(function(y,_){return _.pos[a]-y.pos[a]}),p.sort(function(y,_){return y.pos[a]-_.pos[a]}),{total:d,start:h,end:p,inner:m}})}function Mq(t,e,n,r,i){var a=t.props.isDisplayInnerSnapDigit,o=[];return["vertical","horizontal"].forEach(function(c){var u=e.filter(function(E){return E.type===c}),d=c==="vertical"?1:0,h=d?0:1,p=Nq(c,u,r,a),m=d?ol:sl,y=d?sl:ol,_=r[m.start],w=r[m.end];p.forEach(function(E){var T=E.total,I=E.start,D=E.end,O=E.inner,z=n[h]+T[0].pos[h]-r[y.start],P=r;I.forEach(function(A){var C=A.elementRect.rect,k=P[m.start]-C[m.end];if(k>0){var V=[0,0];V[d]=n[d]+P[m.start]-_-k,V[h]=z,o.push(ih(t,c,"dashed",o.length,k,V,A.className,i))}P=C}),P=r,D.forEach(function(A){var C=A.elementRect.rect,k=C[m.start]-P[m.end];if(k>0){var V=[0,0];V[d]=n[d]+P[m.end]-_,V[h]=z,o.push(ih(t,c,"dashed",o.length,k,V,A.className,i))}P=C}),O.forEach(function(A){var C=A.elementRect.rect,k=_-C[m.start],V=C[m.end]-w,B=[0,0],j=[0,0];B[d]=n[d]-k,B[h]=z,j[d]=n[d]+w-_,j[h]=z,o.push(ih(t,c,"dashed",o.length,k,B,A.className,i)),o.push(ih(t,c,"dashed",o.length,V,j,A.className,i))})})}),o}function Pq(t,e,n,r,i){var a=[];return["horizontal","vertical"].forEach(function(o){var c=e.filter(function(E){return E.type===o}).slice(0,1),u=o==="vertical"?0:1,d=u?0:1,h=u?ol:sl,p=u?sl:ol,m=r[h.start],y=r[h.end],_=r[p.start],w=r[p.end];c.forEach(function(E){var T=E.gap,I=E.gapRects,D=Math.max.apply(Math,Ce([_],J(I.map(function(P){var A=P.rect;return A[p.start]})),!1)),O=Math.min.apply(Math,Ce([w],J(I.map(function(P){var A=P.rect;return A[p.end]})),!1)),z=(D+O)/2;D===O||z===(_+w)/2||I.forEach(function(P){var A=P.rect,C=P.className,k=[n[0],n[1]];if(A[h.end]<m)k[u]+=A[h.end]-m;else if(y<A[h.start])k[u]+=A[h.start]-m-T;else return;k[d]+=z-_,a.push(ih(t,u?"vertical":"horizontal","gap",a.length,T,k,C,i))})})}),a}function o_(t){var e,n,r=t.state,i=r.containerClientRect,a=r.hasFixed,o=i.overflow,c=i.scrollHeight,u=i.scrollWidth,d=i.clientHeight,h=i.clientWidth,p=i.clientLeft,m=i.clientTop,y=t.props,_=y.snapGap,w=_===void 0?!0:_,E=y.verticalGuidelines,T=y.horizontalGuidelines,I=y.snapThreshold,D=I===void 0?5:I,O=y.maxSnapElementGuidelineDistance,z=O===void 0?1/0:O,P=y.isDisplayGridGuidelines,A=Yi(Qi(t.state)),C=A.top,k=A.left,V=A.bottom,B=A.right,j={top:C,left:k,bottom:V,right:B,center:(k+B)/2,middle:(C+V)/2},N=zq(t),K=Ce([],J(N),!1),W=((n=(e=r.snapThresholdInfo)===null||e===void 0?void 0:e.multiples)!==null&&n!==void 0?n:[1,1]).map(function(re){return re*D});w&&K.push.apply(K,Ce([],J(Oq(t,j,W)),!1));var $=Z({},r.snapOffset||{left:0,top:0,bottom:0,right:0});if(K.push.apply(K,Ce([],J(jq(t,o?u:h,o?c:d,p,m,$,P)),!1)),a){var H=i.left,te=i.top;$.left+=H,$.top+=te,$.right+=H,$.bottom+=te}return K.push.apply(K,Ce([],J(iO(T||!1,E||!1,o?u:h,o?c:d,p,m,$)),!1)),K=K.filter(function(re){var ue=re.element,F=re.elementRect,Q=re.type;if(!ue||!F)return!0;var Y=F.rect;return rO(j,Y,Q,z)}),K}function Oq(t,e,n){var r=t.props,i=r.maxSnapElementGuidelineDistance,a=i===void 0?1/0:i,o=r.maxSnapElementGapDistance,c=o===void 0?1/0:o,u=t.state.elementRects,d=[];return[["vertical",sl,ol],["horizontal",ol,sl]].forEach(function(h){var p=J(h,3),m=p[0],y=p[1],_=p[2],w=e[y.start],E=e[y.end],T=e[y.center],I=e[_.start],D=e[_.end],O={left:n[0],top:n[1]};function z(C){var k=C.rect,V=O[y.start];return k[y.end]<w+V?w-k[y.end]:E-V<k[y.start]?k[y.start]-E:-1}var P=u.filter(function(C){var k=C.rect;return k[_.start]>D||k[_.end]<I?!1:z(C)>0}).sort(function(C,k){return z(C)-z(k)}),A=[];P.forEach(function(C){P.forEach(function(k){if(C!==k){var V=C.rect,B=k.rect,j=V[_.start],N=V[_.end],K=B[_.start],W=B[_.end];j>W||K>N||A.push([C,k])}})}),A.forEach(function(C){var k=J(C,2),V=k[0],B=k[1],j=V.rect,N=B.rect,K=j[y.start],W=j[y.end],$=N[y.start],H=N[y.end],te=O[y.start],re=0,ue=0,F=!1,Q=!1,Y=!1;if(W<=w&&E<=$){if(Q=!0,re=($-W-(E-w))/2,ue=W+re+(E-w)/2,xe(ue-T)>te)return}else if(W<$&&H<w+te){if(F=!0,re=$-W,ue=H+re,xe(ue-w)>te)return}else if(W<$&&E-te<K){if(Y=!0,re=$-W,ue=K-re,xe(ue-E)>te)return}else return;re&&rO(e,N,m,a)&&(re>c||d.push({type:m,pos:m==="vertical"?[ue,0]:[0,ue],element:B.element,size:0,className:B.className,isStart:F,isCenter:Q,isEnd:Y,gap:re,hide:!0,gapRects:[V,B],direction:"",elementDirection:""}))})}),d}function Vq(t,e,n,r){var i,a,o=t.props,c=t.state,u=o.snapGridAll,d=o.snapGridWidth,h=d===void 0?0:d,p=o.snapGridHeight,m=p===void 0?0:p,y=c.snapRenderInfo,_=y&&(((i=y.direction)===null||i===void 0?void 0:i[0])||((a=y.direction)===null||a===void 0?void 0:a[1])),w=t.moveables;if(u&&w&&_&&(h||m)){if(c.snapThresholdInfo)return;c.snapThresholdInfo={multiples:[1,1],offset:[0,0]};var E=t.getRect(),T=E.children,I=y.direction;if(T){var D=I.map(function(z,P){var A=P===0?{snapSize:h,posName:"left",sizeName:"width",clientOffset:r.left-e}:{snapSize:m,posName:"top",sizeName:"height",clientOffset:r.top-n},C=A.snapSize,k=A.posName,V=A.sizeName,B=A.clientOffset;if(!C)return{dir:z,multiple:1,snapSize:C,snapOffset:0};var j=E[V],N=E[k],K=YM(T.map(function(F){return[F[k]-N,F[V],j-F[V]-F[k]+N]})).filter(function(F){return F}).sort(function(F,Q){return F-Q}),W=K[0],$=K.map(function(F){return rt(F/W,.1)*C}),H=1,te=rt(j/W,.1);for(H=1;H<=10&&!$.every(function(F){return F*H%1===0});++H);var re=(-z+1)/2,ue=C0(N-B,N-B+j,re,1-re);return{multiple:te*H,dir:z,snapSize:C,snapOffset:Math.round(ue/C)}}),O=D.map(function(z){return z.multiple||1});c.snapThresholdInfo.multiples=O,c.snapThresholdInfo.offset=D.map(function(z){return z.snapOffset}),D.forEach(function(z,P){z.snapSize})}}else c.snapThresholdInfo=null}function jq(t,e,n,r,i,a,o){r===void 0&&(r=0),i===void 0&&(i=0);var c=t.props,u=t.state,d=c.snapGridWidth,h=d===void 0?0:d,p=c.snapGridHeight,m=p===void 0?0:p,y=[],_=a.left,w=a.top,E=[0,0];Vq(t,r,i,a);var T=u.snapThresholdInfo,I=h,D=m;if(T&&(h*=T.multiples[0]||1,m*=T.multiples[1]||1,E=T.offset),m){for(var O=function(P){y.push({type:"horizontal",pos:[_,rt(E[1]*D+P-i+w,.1)],className:Be("grid-guideline"),size:e,hide:!o,direction:"",grid:!0})},z=0;z<=n*2;z+=m)O(z);for(var z=-m;z>=-n;z-=m)O(z)}if(h){for(var O=function(A){y.push({type:"vertical",pos:[rt(E[0]*I+A-r+_,.1),w],className:Be("grid-guideline"),size:n,hide:!o,direction:"",grid:!0})},z=0;z<=e*2;z+=h)O(z);for(var z=-h;z>=-e;z-=h)O(z)}return y}function rO(t,e,n,r){return n==="horizontal"?xe(t.right-e.left)<=r||xe(t.left-e.right)<=r||t.left<=e.right&&e.left<=t.right:n==="vertical"?xe(t.bottom-e.top)<=r||xe(t.top-e.bottom)<=r||t.top<=e.bottom&&e.top<=t.bottom:!0}function zq(t){var e=t.state,n=t.props.elementGuidelines,r=n===void 0?[]:n;if(!r.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter(function(m){return!m.refresh}),a=r.map(function(m){return va(m)&&"element"in m?Z(Z({},m),{element:$a(m.element,!0)}):{element:$a(m,!0)}}).filter(function(m){return m.element}),o=W7(i.map(function(m){return m.element}),a.map(function(m){return m.element})),c=o.maintained,u=o.added,d=[];c.forEach(function(m){var y=J(m,2),_=y[0],w=y[1];d[w]=i[_]}),Lq(t,u.map(function(m){return a[m]})).map(function(m,y){d[u[y]]=m}),e.elementRects=d;var h=oS(t.props.elementSnapDirections),p=[];return d.forEach(function(m){var y=m.element,_=m.top,w=_===void 0?h.top:_,E=m.left,T=E===void 0?h.left:E,I=m.right,D=I===void 0?h.right:I,O=m.bottom,z=O===void 0?h.bottom:O,P=m.center,A=P===void 0?h.center:P,C=m.middle,k=C===void 0?h.middle:C,V=m.className,B=m.rect,j=lS({top:w,right:D,left:T,bottom:z,center:A,middle:k},B),N=j.horizontal,K=j.vertical,W=j.horizontalNames,$=j.verticalNames,H=B.top,te=B.left,re=B.right-te,ue=B.bottom-H,F=[re,ue];K.forEach(function(Q,Y){p.push({type:"vertical",element:y,pos:[rt(Q,.1),H],size:ue,sizes:F,className:V,elementRect:m,elementDirection:eD[$[Y]]||$[Y],direction:""})}),N.forEach(function(Q,Y){p.push({type:"horizontal",element:y,pos:[te,rt(Q,.1)],size:re,sizes:F,className:V,elementRect:m,elementDirection:eD[W[Y]]||W[Y],direction:""})})}),p}function uD(t,e){return t?t.map(function(n){var r=va(n)?n:{pos:n},i=r.pos;return od(i)?r:Z(Z({},r),{pos:$t(i,e)})}):[]}function iO(t,e,n,r,i,a,o){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o={left:0,top:0,right:0,bottom:0});var c=[],u=o.left,d=o.top,h=o.bottom,p=o.right,m=n+p-u,y=r+h-d;return uD(t,y).forEach(function(_){c.push({type:"horizontal",pos:[u,rt(_.pos-a+d,.1)],size:m,className:_.className,direction:""})}),uD(e,m).forEach(function(_){c.push({type:"vertical",pos:[rt(_.pos-i+u,.1),d],size:y,className:_.className,direction:""})}),c}function Lq(t,e){if(!e.length)return[];var n=t.props.groupable,r=t.state,i=r.containerClientRect,a=r.rootMatrix,o=r.is3d,c=r.offsetDelta,u=o?4:3,d=J(cq(a,i,u),2),h=d[0],p=d[1],m=n?0:c[0],y=n?0:c[1];return e.map(function(_){var w=_.element.getBoundingClientRect(),E=w.left-h-m,T=w.top-p-y,I=T+w.height,D=E+w.width,O=J(fd(a,[E,T],u),2),z=O[0],P=O[1],A=J(fd(a,[D,I],u),2),C=A[0],k=A[1];return Z(Z({},_),{rect:{left:z,right:C,top:P,bottom:k,center:(z+C)/2,middle:(P+k)/2}})})}function Nm(t){var e=t.state,n=e.container,r=t.props.snapContainer||n;if(e.snapContainer===r&&e.guidelines&&e.guidelines.length)return!1;var i=e.containerClientRect,a={left:0,top:0,bottom:0,right:0};if(n!==r){var o=$a(r,!0);if(o){var c=wh(o),u=mD(e,[c.left-i.left,c.top-i.top]),d=mD(e,[c.right-i.right,c.bottom-i.bottom]);a.left=rt(u[0],1e-5),a.top=rt(u[1],1e-5),a.right=rt(d[0],1e-5),a.bottom=rt(d[1],1e-5)}}return e.snapContainer=r,e.snapOffset=a,e.guidelines=o_(t),e.enableSnap=!0,!0}function aO(t,e,n,r,i,a){var o=Vc(t,e,n,a?4:3),c=Zn(o,r);return hS(o,qe(i,c))}function dD(t){return t?t/xe(t):0}function Bq(t,e,n,r,i,a){var o=a.fixedDirection,c=hq(n,o,r),u=uS(t,e,n,r),d=Ce(Ce([],J(Tq(t,e,c,r,i,a)),!1),J(JP(t,u,a)),!1),h=M0(d,0),p=M0(d,1);return{width:{isBound:h.isBound,offset:h.offset[0]},height:{isBound:p.isBound,offset:p.offset[1]}}}function Fq(t,e,n,r,i,a,o,c,u){var d=Zn(e,o),h=Mv(t,c,{vertical:[d[0]],horizontal:[d[1]]}),p=h.horizontal.offset,m=h.vertical.offset;if(rt(m,e_)||rt(p,e_)){var y=J(ss({datas:u,distX:-m,distY:-p}),2),_=y[0],w=y[1],E=Math.min(i||1/0,n+o[0]*_),T=Math.min(a||1/0,r+o[1]*w);return[E-n,T-r]}return[0,0]}function sO(t,e,n,r,i,a,o,c){for(var u=Qi(t.state),d=t.props.keepRatio,h=0,p=0,m=0;m<2;++m){var y=e(h,p),_=Bq(t,y,i,d,o,c),w=_.width,E=_.height,T=w.isBound,I=E.isBound,D=w.offset,O=E.offset;if(m===1&&(T||(D=0),I||(O=0)),m===0&&o&&!T&&!I)return[0,0];if(d){var z=xe(D)*(n?1/n:1),P=xe(O)*(r?1/r:1),A=T&&I?z<P:I||!T&&z<P;A?D=n*O/r:O=r*D/n}h+=D,p+=O}if(!d&&i[0]&&i[1]){var C=Cq(t,u,i,a,c),k=C.maxWidth,V=C.maxHeight,B=J(Fq(t,e(h,p).map(function(K){return K.map(function(W){return rt(W,e_)})}),n+h,r+p,k,V,i,o,c),2),D=B[0],O=B[1];h+=D,p+=O}return[h,p]}function xh(t){return t<0&&(t=t%360+360),t%=360,t}function Uq(t,e){e=xh(e);var n=Math.floor(t/360),r=n*360+360-e,i=n*360+e;return xe(t-r)<xe(t-i)?r:i}function q1(t,e){t=xh(t),e=xh(e);var n=xh(t-e);return Math.min(n,360-n)}function Gq(t,e,n,r){var i,a=t.props,o=(i=a[HP])!==null&&i!==void 0?i:5,c=a[$P];if(Bd(t,"rotatable")){var u=e.pos1,d=e.pos2,h=e.pos3,p=e.pos4,m=e.origin,y=n*Math.PI/180,_=[u,d,h,p].map(function(O){return qe(O,m)}),w=_.map(function(O){return Ap(O,y)}),E=Ce(Ce([],J(aq(t,_,w,m,n)),!1),J(bq(t,_,w,m,n)),!1);E.sort(function(O,z){return xe(O-n)-xe(z-n)});var T=E.length>0;if(T)return{isSnap:T,dist:T?E[0]:n}}if(c?.length&&o){var I=c.slice().sort(function(O,z){return q1(O,r)-q1(z,r)}),D=I[0];if(q1(D,r)<=o)return{isSnap:!0,dist:n+Uq(r,D)-r}}return{isSnap:!1,dist:n}}function qq(t,e,n,r,i,a,o){if(!Bd(t,"resizable"))return[0,0];var c=o.fixedDirection,u=o.nextAllMatrix,d=t.state,h=d.allMatrix,p=d.is3d;return sO(t,function(m,y){return aO(u||h,e+m,n+y,c,i,p)},e,n,r,i,a,o)}function Hq(t,e,n,r,i){if(!Bd(t,"scalable"))return[0,0];var a=i.startOffsetWidth,o=i.startOffsetHeight,c=i.fixedPosition,u=i.fixedDirection,d=i.is3d,h=sO(t,function(p,m){return aO(qG(i,Tt(e,[p/a,m/o])),a,o,u,c,d)},a,o,n,c,r,i);return[h[0]/a,h[1]/o]}function $q(t,e){e.absolutePoses=Qi(t.state)}function fD(t){var e=[];return t.forEach(function(n){n.guidelineInfos.forEach(function(r){var i=r.guideline;ai(e,function(a){return a.guideline===i})||(i.direction="",e.push({guideline:i,posInfo:n}))})}),e.map(function(n){var r=n.guideline,i=n.posInfo;return Z(Z({},r),{direction:i.direction})})}function hD(t,e,n,r,i,a){var o=sS(kv(t,a),e,n),c=o.vertical,u=o.horizontal,d=Yu();c.forEach(function(_){_.isBound&&(_.direction==="start"&&(d.left=!0),_.direction==="end"&&(d.right=!0),r.push({type:"bounds",pos:_.pos}))}),u.forEach(function(_){_.isBound&&(_.direction==="start"&&(d.top=!0),_.direction==="end"&&(d.bottom=!0),i.push({type:"bounds",pos:_.pos}))});var h=xq(t),p=h.boundMap,m=h.vertical,y=h.horizontal;return m.forEach(function(_){Fs(r,function(w){var E=w.type,T=w.pos;return E==="bounds"&&T===_})>=0||r.push({type:"bounds",pos:_})}),y.forEach(function(_){Fs(i,function(w){var E=w.type,T=w.pos;return E==="bounds"&&T===_})>=0||i.push({type:"bounds",pos:_})}),{boundMap:d,innerBoundMap:p}}var Yq=mS("",["resizable","scalable"]),Kq={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold","snapGridAll",HP,$P,YP,KP,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(t,e){var n=t.state,r=n.top,i=n.left,a=n.pos1,o=n.pos2,c=n.pos3,u=n.pos4,d=n.snapRenderInfo,h=t.props.snapRenderThreshold,p=h===void 0?1:h;if(!d||!d.render||!Bd(t,""))return Xu(t,"boundMap",Yu(),function(ne){return JSON.stringify(ne)}),Xu(t,"innerBoundMap",Yu(),function(ne){return JSON.stringify(ne)}),[];n.guidelines=o_(t);var m=Math.min(a[0],o[0],c[0],u[0]),y=Math.min(a[1],o[1],c[1],u[1]),_=d.externalPoses||[],w=Qi(t.state),E=[],T=[],I=[],D=[],O=[],z=Yi(w),P=z.width,A=z.height,C=z.top,k=z.left,V=z.bottom,B=z.right,j={left:k,right:B,top:C,bottom:V,center:(k+B)/2,middle:(C+V)/2},N=_.length>0,K=N?Yi(_):{};if(!d.request){if(d.direction&&O.push(fq(t,w,d.direction,p,p)),d.snap){var W=Yi(w);d.center&&(W.middle=(W.top+W.bottom)/2,W.center=(W.left+W.right)/2),O.push(tD(t,W,p,p))}N&&(d.center&&(K.middle=(K.top+K.bottom)/2,K.center=(K.left+K.right)/2),O.push(tD(t,K,p,p))),O.forEach(function(ne){var pe=ne.vertical.posInfos,de=ne.horizontal.posInfos;E.push.apply(E,Ce([],J(pe.filter(function(ge){var we=ge.guidelineInfos;return we.some(function(Te){var Xe=Te.guideline;return!Xe.hide})}).map(function(ge){return{type:"snap",pos:ge.pos}})),!1)),T.push.apply(T,Ce([],J(de.filter(function(ge){var we=ge.guidelineInfos;return we.some(function(Te){var Xe=Te.guideline;return!Xe.hide})}).map(function(ge){return{type:"snap",pos:ge.pos}})),!1)),I.push.apply(I,Ce([],J(fD(pe)),!1)),D.push.apply(D,Ce([],J(fD(de)),!1))})}var $=hD(t,[k,B],[C,V],E,T),H=$.boundMap,te=$.innerBoundMap;N&&hD(t,[K.left,K.right],[K.top,K.bottom],E,T,d.externalBounds);var re=Ce(Ce([],J(I),!1),J(D),!1),ue=re.filter(function(ne){return ne.element&&!ne.gapRects}),F=re.filter(function(ne){return ne.gapRects}).sort(function(ne,pe){return ne.gap-pe.gap});Ne(t,"onSnap",{guidelines:re.filter(function(ne){var pe=ne.element;return!pe}),elements:ue,gaps:F},!0);var Q=Xu(t,"boundMap",H,function(ne){return JSON.stringify(ne)},Yu()),Y=Xu(t,"innerBoundMap",te,function(ne){return JSON.stringify(ne)},Yu());return(H===Q||te===Y)&&Ne(t,"onBound",{bounds:H,innerBounds:te},!0),Ce(Ce(Ce(Ce(Ce(Ce([],J(Mq(t,ue,[m,y],j,e)),!1),J(Pq(t,F,[m,y],j,e)),!1),J(cD(t,"horizontal",D,[i,r],j,e)),!1),J(cD(t,"vertical",I,[i,r],j,e)),!1),J(lD(t,"horizontal",T,m,r,P,0,e)),!1),J(lD(t,"vertical",E,y,i,A,1,e)),!1)},dragStart:function(t,e){t.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},Nm(t)},drag:function(t){var e=t.state;Nm(t)||(e.guidelines=o_(t)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart:function(t){this.unset(t)},dragEnd:function(t){this.unset(t)},dragControlCondition:function(t,e){if(Yq(t,e)||s_(t,e))return!0;if(!e.isRequest&&e.inputEvent)return Qn(e.inputEvent.target,Be("snap-control"))},dragControlStart:function(t){t.state.snapRenderInfo=null,Nm(t)},dragControl:function(t){this.drag(t)},dragControlEnd:function(t){this.unset(t)},dragGroupStart:function(t,e){this.dragStart(t,e)},dragGroup:function(t){this.drag(t)},dragGroupEnd:function(t){this.unset(t)},dragGroupControlStart:function(t){t.state.snapRenderInfo=null,Nm(t)},dragGroupControl:function(t){this.drag(t)},dragGroupControlEnd:function(t){this.unset(t)},unset:function(t){var e=t.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function Xq(t,e){return[t[0]*e[0],t[1]*e[1]]}function Be(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return qU.apply(void 0,Ce([nS],J(t),!1))}function oO(t){t()}function Wq(t){return!t||t==="none"?[1,0,0,1,0,0]:va(t)?t:$h(t)}function _h(t,e,n){return D0(e,bc(n,e),t,bc(n.map(function(r){return-r}),e))}function Qq(t,e,n){if(e==="%"){var r=fS(t.ownerSVGElement);return r[n?"width":"height"]/100}return 1}function Zq(t){var e=Jq(pS(t,":before"));return e.map(function(n,r){var i=wp(n),a=i.value,o=i.unit;return a*Qq(t,o,r===0)})}function O0(t){return t?t.split(" "):["0","0"]}function Jq(t){return O0(t.transformOrigin)}function lO(t){var e=si(t),n=e("transform");if(n&&n!=="none")return n;if("transform"in t){var r=t.transform,i=r.baseVal;if(!i)return"";var a=i.length;if(!a)return"";for(var o=[],c=function(d){var h=i[d].matrix;o.push("matrix(".concat(["a","b","c","d","e","f"].map(function(p){return h[p]}).join(", "),")"))},u=0;u<a;++u)c(u);return o.join(" ")}return""}function Kh(t,e,n,r,i){var a,o,c=Hw(t)||gl(t),u=!1,d,h;if(!t||n)d=t;else{var p=(a=t?.assignedSlot)===null||a===void 0?void 0:a.parentElement,m=t.parentElement;p?(u=!0,h=m,d=p):d=m}for(var y=!1,_=t===e||d===e,w="relative",E=1,T=parseFloat(i?.("zoom"))||1,I=i?.("position");d&&d!==c;){e===d&&(_=!0);var D=si(d),O=d.tagName.toLowerCase(),z=lO(d),P=D("willChange"),A=parseFloat(D("zoom"))||1;if(w=D("position"),r&&A!==1){E=A;break}if(!n&&r&&T!==1&&I&&I!=="absolute"||O==="svg"||O==="foreignobject"||w!=="static"||z&&z!=="none"||P==="transform")break;var C=(o=t?.assignedSlot)===null||o===void 0?void 0:o.parentNode,k=d.parentNode;C&&(u=!0,h=k);var V=k;if(V&&V.nodeType===11){d=V.host,y=!0,w=si(d)("position");break}d=V,w="relative"}return{offsetZoom:E,hasSlot:u,parentSlotElement:h,isCustomElement:y,isStatic:w==="static",isEnd:_||!d||d===c,offsetParent:d||c}}function eH(t,e){var n,r=t.tagName.toLowerCase(),i=t.offsetLeft,a=t.offsetTop,o=si(t),c=Sv(i),u=!c,d,h;return!u&&(r!=="svg"||t.ownerSVGElement)?(d=CP?Zq(t):O0(o("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice(),u=!0,r==="svg"?(i=0,a=0):(n=J(rH(t,d,t===e&&e.tagName.toLowerCase()==="g"),4),i=n[0],a=n[1],d[0]=n[2],d[1]=n[3])):(d=O0(o("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice()),{tagName:r,isSVG:c,hasOffset:u,offset:[i||0,a||0],origin:d,targetOrigin:h}}function cO(t,e){var n=si(t),r=si(gl(t)),i=r("position");if(!e&&(!i||i==="static"))return[0,0];var a=parseInt(r("marginLeft"),10),o=parseInt(r("marginTop"),10);return n("position")==="absolute"&&((n("top")!=="auto"||n("bottom")!=="auto")&&(o=0),(n("left")!=="auto"||n("right")!=="auto")&&(a=0)),[a,o]}function l_(t){t.forEach(function(e){var n=e.matrix;n&&(e.matrix=ya(n,3,4))})}function tH(t){for(var e=t.parentElement,n=!1,r=gl(t);e;){var i=pS(e).transform;if(i&&i!=="none"){n=!0;break}if(e===r)break;e=e.parentElement}return{fixedContainer:e||r,hasTransform:n}}function Pv(t,e){return e===void 0&&(e=t.length>9),"".concat(e?"matrix3d":"matrix","(").concat(bP(t,!e).join(","),")")}function fS(t){var e=t.clientWidth,n=t.clientHeight;if(!t)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:n};var r=t.viewBox,i=r&&r.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||n,clientWidth:e,clientHeight:n}}function nH(t,e){var n,r=fS(t),i=r.width,a=r.height,o=r.clientWidth,c=r.clientHeight,u=o/i,d=c/a,h=t.preserveAspectRatio.baseVal,p=h.align,m=h.meetOrSlice,y=[0,0],_=[u,d],w=[0,0];if(p!==1){var E=(p-2)%3,T=Math.floor((p-2)/3);y[0]=i*E/2,y[1]=a*T/2;var I=m===2?Math.max(d,u):Math.min(u,d);_[0]=I,_[1]=I,w[0]=(o-i)/2*E,w[1]=(c-a)/2*T}var D=Zw(_,e);return n=J(w,2),D[e*(e-1)]=n[0],D[e*(e-1)+1]=n[1],_h(D,e,y)}function rH(t,e,n){var r=t.tagName.toLowerCase();if(!t.getBBox||!n&&r==="g")return[0,0,0,0];var i=si(t),a=i("transform-box")==="fill-box",o=t.getBBox(),c=fS(t.ownerSVGElement),u=o.x,d=o.y;r==="foreignobject"&&!u&&!d&&(u=parseFloat(t.getAttribute("x"))||0,d=parseFloat(t.getAttribute("y"))||0);var h=u-c.x,p=d-c.y,m=a?e[0]:e[0]-h,y=a?e[1]:e[1]-p;return[h,p,m,y]}function hn(t,e,n){return Rr(t,yc(e,n),n)}function Vc(t,e,n,r){return[[0,0],[e,0],[0,n],[e,n]].map(function(i){return hn(t,i,r)})}function Yi(t){var e=t.map(function(d){return d[0]}),n=t.map(function(d){return d[1]}),r=Math.min.apply(Math,Ce([],J(e),!1)),i=Math.min.apply(Math,Ce([],J(n),!1)),a=Math.max.apply(Math,Ce([],J(e),!1)),o=Math.max.apply(Math,Ce([],J(n),!1)),c=a-r,u=o-i;return{left:r,top:i,right:a,bottom:o,width:c,height:u}}function pD(t,e,n,r){var i=Vc(t,e,n,r);return Yi(i)}function iH(t,e,n,r,i){var a,o=t.target,c=t.origin,u=e.matrix,d=dO(o),h=d.offsetWidth,p=d.offsetHeight,m=n.getBoundingClientRect(),y=[0,0];n===gl(n)&&(y=cO(o,!0));for(var _=o.getBoundingClientRect(),w=_.left-m.left+n.scrollLeft-(n.clientLeft||0)+y[0],E=_.top-m.top+n.scrollTop-(n.clientTop||0)+y[1],T=_.width,I=_.height,D=D0(r,i,u),O=pD(D,h,p,r),z=O.left,P=O.top,A=O.width,C=O.height,k=hn(D,c,r),V=qe(k,[z,P]),B=[w+V[0]*T/A,E+V[1]*I/C],j=[0,0],N=0;++N<10;){var K=Za(i,r);a=J(qe(hn(K,B,r),hn(K,k,r)),2),j[0]=a[0],j[1]=a[1];var W=D0(r,i,bc(j,r),u),$=pD(W,h,p,r),H=$.left,te=$.top,re=H-w,ue=te-E;if(xe(re)<2&&xe(ue)<2)break;B[0]-=re,B[1]-=ue}return j.map(function(F){return Math.round(F)})}function aH(t,e,n){var r=t.length===16,i=r?4:3,a=e.map(function(u){return hn(t,u,i)}),o=n.left,c=n.top;return a.map(function(u){return[u[0]+o,u[1]+c]})}function Wi(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function uO(t,e){return Wi([e[0]-t[0],e[1]-t[1]])}function ah(t,e,n,r){n===void 0&&(n=1),r===void 0&&(r=kn(t,e));var i=uO(t,e);return{transform:"translateY(-50%) translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(r,"rad) scaleY(").concat(n,")"),width:"".concat(i,"px")}}function V0(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n.length,a=n.reduce(function(c,u){return c+u[0]},0)/i,o=n.reduce(function(c,u){return c+u[1]},0)/i;return{transform:"translateZ(0px) translate(".concat(a,"px, ").concat(o,"px) rotate(").concat(t,"rad) scale(").concat(e,")")}}function _c(t,e){var n=t[e];return va(n)?Z(Z({},t),n):t}function dO(t){var e=t&&!Sv(t.offsetWidth),n=0,r=0,i=0,a=0,o=0,c=0,u=0,d=0,h=0,p=0,m=0,y=0,_=1/0,w=1/0,E=1/0,T=1/0,I=0,D=0,O=!1;if(t)if(!e&&t.ownerSVGElement){var z=t.getBBox();O=!0,n=z.width,r=z.height,o=n,c=r,u=n,d=r,i=n,a=r}else{var P=si(t),A=t.style,C=P("boxSizing")==="border-box",k=parseFloat(P("borderLeftWidth"))||0,V=parseFloat(P("borderRightWidth"))||0,B=parseFloat(P("borderTopWidth"))||0,j=parseFloat(P("borderBottomWidth"))||0,N=parseFloat(P("paddingLeft"))||0,K=parseFloat(P("paddingRight"))||0,W=parseFloat(P("paddingTop"))||0,$=parseFloat(P("paddingBottom"))||0,H=N+K,te=W+$,re=k+V,ue=B+j,F=H+re,Q=te+ue,Y=P("position"),ne=0,pe=0;if("clientLeft"in t){var de=null;if(Y==="absolute"){var ge=Kh(t,gl(t));de=ge.offsetParent}else de=t.parentElement;if(de){var we=si(de);ne=parseFloat(we("width")),pe=parseFloat(we("height"))}}h=Math.max(H,$t(P("minWidth"),ne)||0),p=Math.max(te,$t(P("minHeight"),pe)||0),_=$t(P("maxWidth"),ne),w=$t(P("maxHeight"),pe),isNaN(_)&&(_=1/0),isNaN(w)&&(w=1/0),I=$t(A.width,0)||0,D=$t(A.height,0)||0,o=parseFloat(P("width"))||0,c=parseFloat(P("height"))||0,u=xe(o-I)<1?Fx(h,I||o,_):o,d=xe(c-D)<1?Fx(p,D||c,w):c,n=u,r=d,i=u,a=d,C?(E=_,T=w,m=h,y=p,u=n-F,d=r-Q):(E=_+F,T=w+Q,m=h+F,y=p+Q,n=u+F,r=d+Q),i=u+H,a=d+te}return{svg:O,offsetWidth:n,offsetHeight:r,clientWidth:i,clientHeight:a,contentWidth:u,contentHeight:d,inlineCSSWidth:I,inlineCSSHeight:D,cssWidth:o,cssHeight:c,minWidth:h,minHeight:p,maxWidth:_,maxHeight:w,minOffsetWidth:m,minOffsetHeight:y,maxOffsetWidth:E,maxOffsetHeight:T}}function fO(t,e){return kn(e>0?t[0]:t[1],e>0?t[1]:t[0])}function Mm(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function hO(t,e){var n=t===gl(t)||t===Hw(t),r={clientLeft:t.clientLeft,clientTop:t.clientTop,clientWidth:t.clientWidth,clientHeight:t.clientHeight,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight,overflow:!1};return n&&(r.clientHeight=Math.max(e.height,r.clientHeight),r.scrollHeight=Math.max(e.height,r.scrollHeight)),r.overflow=si(t)("overflow")!=="visible",Z(Z({},e),r)}function H1(t,e,n,r){var i=t.left,a=t.right,o=t.top,c=t.bottom,u=e.top,d=e.left,h={left:d+i,top:u+o,right:d+a,bottom:u+c,width:a-i,height:c-o};return n&&r?hO(n,h):h}function wh(t,e){var n=0,r=0,i=0,a=0;if(t){var o=t.getBoundingClientRect();n=o.left,r=o.top,i=o.width,a=o.height}var c={left:n,top:r,width:i,height:a,right:n+i,bottom:r+a};return t&&e?hO(t,c):c}function sH(t){var e=t.props,n=e.groupable,r=e.svgOrigin,i=t.getState(),a=i.offsetWidth,o=i.offsetHeight,c=i.svg,u=i.transformOrigin;return!n&&c&&r?yS(r,a,o):u}function pO(t,e,n,r){var i;if(t)i=t;else if(e)i=[0,0];else{var a=n.target;i=gO(a,r)}return i}function gO(t,e){if(t){var n=t.getAttribute("data-rotation")||"",r=t.getAttribute("data-direction");if(e.deg=n,!!r){var i=[0,0];return r.indexOf("w")>-1&&(i[0]=-1),r.indexOf("e")>-1&&(i[0]=1),r.indexOf("n")>-1&&(i[1]=-1),r.indexOf("s")>-1&&(i[1]=1),i}}}function hS(t,e){return[Tt(e,t[0]),Tt(e,t[1]),Tt(e,t[2]),Tt(e,t[3])]}function Qi(t){var e=t.left,n=t.top,r=t.pos1,i=t.pos2,a=t.pos3,o=t.pos4;return hS([r,i,a,o],[e,n])}function c_(t,e){t[e?"controlAbles":"targetAbles"].forEach(function(n){n.unset&&n.unset(t)})}function Ku(t,e){var n=e?"controlGesto":"targetGesto",r=t[n];r?.isIdle()===!1&&c_(t,e),r?.unset(),t[n]=null}function Lr(t,e){if(e){var n=Ld(e);n.nextStyle=Z(Z({},n.nextStyle),t)}return{style:t,cssText:Us(t).map(function(r){return"".concat(t0(r,"-"),": ").concat(t[r],";")}).join("")}}function mO(t,e,n){var r=e.afterTransform||e.transform;return Z(Z({},Lr(Z(Z(Z({},t.style),e.style),{transform:r}),n)),{afterTransform:r,transform:t.transform})}function lt(t,e,n,r){var i=e.datas;i.datas||(i.datas={});var a=Z(Z({},n),{target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,moveable:t,datas:i.datas,isRequest:e.isRequest,isRequestChild:e.isRequestChild,isFirstDrag:!!e.isFirstDrag,isTrusted:e.isTrusted!==!1,stopAble:function(){i.isEventStart=!1},stopDrag:function(){var o;(o=e.stop)===null||o===void 0||o.call(e)}});return i.isStartEvent?r||(i.lastEvent=a):i.isStartEvent=!0,a}function _i(t,e,n){var r=e.datas,i="isDrag"in n?n.isDrag:e.isDrag;return r.datas||(r.datas={}),Z(Z({isDrag:i},n),{moveable:t,target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,lastEvent:r.lastEvent,isDouble:e.isDouble,datas:r.datas,isFirstDrag:!!e.isFirstDrag})}function Ov(t,e,n){t._emitter.on(e,n)}function Ne(t,e,n,r,i){return t.triggerEvent(e,n,r,i)}function pS(t,e){return Wo(t).getComputedStyle(t,e)}function Pm(t,e,n){var r={},i={};return t.filter(function(a){var o=a.name;if(r[o]||!e.some(function(c){return a[c]}))return!1;if(!n&&a.ableGroup){if(i[a.ableGroup])return!1;i[a.ableGroup]=!0}return r[o]=!0,!0})}function u_(t,e){return t===e||t==null&&e==null}function gD(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=t.length-1,r=0;r<n;++r){var i=t[r];if(!Sv(i))return i}return t[n]}function vO(t,e){var n=[],r=[];return t.forEach(function(i,a){var o=e(i,a,t),c=r.indexOf(o),u=n[c]||[];c===-1&&(r.push(o),n.push(u)),u.push(i)}),n}function oH(t,e){var n=[],r={};return t.forEach(function(i,a){var o=e(i,a,t),c=r[o];c||(c=[],r[o]=c,n.push(c)),c.push(i)}),n}function yO(t){return t.reduce(function(e,n){return e.concat(n)},[])}function dd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.sort(function(n,r){return xe(r)-xe(n)}),t[0]}function fd(t,e,n){return Rr(Za(t,n),yc(e,n),n)}function lH(t,e){var n,r=t.is3d,i=t.rootMatrix,a=r?4:3;return n=J(fd(i,[e.distX,e.distY],a),2),e.distX=n[0],e.distY=n[1],e}function ji(t,e,n,r){if(!n[0]&&!n[1])return e;var i=hn(t,[dD(n[0]||1),0],r),a=hn(t,[0,dD(n[1]||1)],r),o=hn(t,[n[0]/Wi(i),n[1]/Wi(a)],r);return Tt(e,o)}function ca(t,e,n){return n?"".concat(t/e*100,"%"):"".concat(t,"px")}function j0(t){return xe(t)<=Ur?0:t}function gS(t){return function(e){if(!e.isDragging(t))return"";var n=QG(e,t),r=n.deg;return r?Be("view-control-rotation".concat(r)):""}}function mS(t,e){return e===void 0&&(e=[t]),function(n,r){if(r.isRequest)return e.some(function(a){return r.requestAble===a})?r.parentDirection:!1;var i=r.inputEvent.target;return Qn(i,Be("direction"))&&(!t||Qn(i,Be(t)))}}function cH(t,e,n){var r,i=ld(t,{"x%":function(z){return z/100*e.offsetWidth},"y%":function(z){return z/100*e.offsetHeight}}),a=t.slice(0,n<0?void 0:n),o=t.slice(0,n<0?void 0:n+1),c=t[n]||"",u=n<0?[]:t.slice(n),d=n<0?[]:t.slice(n+1),h=i.slice(0,n<0?void 0:n),p=i.slice(0,n<0?void 0:n+1),m=(r=i[n])!==null&&r!==void 0?r:ld([""])[0],y=n<0?[]:i.slice(n),_=n<0?[]:i.slice(n+1),w=m?[m]:[],E=Mu(h),T=Mu(p),I=Mu(y),D=Mu(_),O=Yt(E,I,4);return{transforms:t,beforeFunctionMatrix:E,beforeFunctionMatrix2:T,targetFunctionMatrix:Mu(w),afterFunctionMatrix:I,afterFunctionMatrix2:D,allFunctionMatrix:O,beforeFunctions:h,beforeFunctions2:p,targetFunction:w[0],afterFunctions:y,afterFunctions2:_,beforeFunctionTexts:a,beforeFunctionTexts2:o,targetFunctionText:c,afterFunctionTexts:u,afterFunctionTexts2:d}}function uH(t){return!t||!va(t)||jd(t)?!1:qn(t)||"length"in t}function $a(t,e){return t?jd(t)?t:ii(t)?e?document.querySelector(t):t:Uw(t)?t():QM(t)?t:"current"in t?t.current:t:null}function vS(t,e){if(!t)return[];var n=uH(t)?[].slice.call(t):[t];return n.reduce(function(r,i){return ii(i)&&e?Ce(Ce([],J(r),!1),J([].slice.call(document.querySelectorAll(i))),!1):(qn(i)?r.push(vS(i,e)):r.push($a(i,e)),r)},[])}function dH(t,e,n){var r=kn(t,e)/Math.PI*180;return r=n>=0?r:180-r,r=r>=0?r:360+r,r}function mD(t,e){var n=t.rootMatrix,r=t.is3d,i=r?4:3,a=Za(n,i);return r||(a=ya(a,3,4)),a[12]=0,a[13]=0,a[14]=0,K7(a,e)}function bO(t,e,n,r,i){var a=J(t,2),o=a[0],c=a[1],u=0,d=0;if(i&&o&&c){var h=kn([0,0],e),p=kn([0,0],r),m=Wi(e),y=Math.cos(h-p)*m;if(!r[0])d=y,u=d*n;else if(!r[1])u=y,d=u/n;else{var _=r[0]*o,w=r[1]*c,E=Math.atan2(_+e[0],w+e[1]),T=Math.atan2(_,w);E<0&&(E+=Math.PI*2),T<0&&(T+=Math.PI*2);var I=0;xe(E-T)<Math.PI/2||xe(E-T)>Math.PI/2*3||(T+=Math.PI),I=E-T,I>Math.PI*2?I-=Math.PI*2:I>Math.PI?I=2*Math.PI-I:I<-Math.PI&&(I=-2*Math.PI-I);var D=Wi([_+e[0],w+e[1]])*Math.cos(I);u=D*Math.sin(T)-_,d=D*Math.cos(T)-w,r[0]<0&&(u*=-1),r[1]<0&&(d*=-1)}}else u=r[0]*e[0],d=r[1]*e[1];return[u,d]}function xO(t,e,n,r){var i,a=n.ratio,o=n.startOffsetWidth,c=n.startOffsetHeight,u=0,d=0,h=r.distX,p=r.distY,m=r.pinchScale,y=r.parentDistance,_=r.parentDist,w=r.parentScale,E=n.fixedDirection,T=[0,1].map(function(A){return xe(t[A]-E[A])}),I=[0,1].map(function(A){var C=T[A];return C!==0&&(C=2/C),C});if(_)u=_[0],d=_[1],e&&(u?d||(d=u/a):u=d*a);else if(od(m))u=(m-1)*o,d=(m-1)*c;else if(w)u=(w[0]-1)*o,d=(w[1]-1)*c;else if(y){var D=o*T[0],O=c*T[1],z=Wi([D,O]);u=y/z*D*I[0],d=y/z*O*I[1]}else{var P=ss({datas:n,distX:h,distY:p});P=I.map(function(A,C){return P[C]*A}),i=J(bO([o,c],P,a,t,e),2),u=i[0],d=i[1]}return{distWidth:u,distHeight:d}}function d_(t,e){if(e){if(t==="left")return{x:"0%",y:"50%"};if(t==="top")return{x:"50%",y:"50%"};if(t==="center")return{x:"50%",y:"50%"};if(t==="right")return{x:"100%",y:"50%"};if(t==="bottom")return{x:"50%",y:"100%"};var n=J(t.split(" "),2),r=n[0],i=n[1],a=d_(r||""),o=d_(i||""),c=Z(Z({},a),o),u={x:"50%",y:"50%"};return c.x&&(u.x=c.x),c.y&&(u.y=c.y),c.value&&(c.x&&!c.y&&(u.y=c.value),!c.x&&c.y&&(u.x=c.value)),u}return t==="left"?{x:"0%"}:t==="right"?{x:"100%"}:t==="top"?{y:"0%"}:t==="bottom"?{y:"100%"}:t?t==="center"?{value:"50%"}:{value:t}:{}}function yS(t,e,n){var r=d_(t,!0),i=r.x,a=r.y;return[$t(i,e)||0,$t(a,n)||0]}function fH(t,e,n){var r=t.map(function(a){return qe(a,e)}),i=r.map(function(a){return Ap(a,n)});return{prev:r,next:i,result:i.map(function(a){return Tt(a,e)})}}function _O(t,e){return t.length===e.length&&t.every(function(n,r){var i=e[r],a=qn(n),o=qn(i);return a&&o?_O(n,i):!a&&!o?n===i:!1})}function Xu(t,e,n,r,i){var a=t._store,o=a[e];if(!(e in a))if(i!=null)a[e]=i,o=i;else return a[e]=n,n;return o===n||r(o)===r(n)?o:(a[e]=n,n)}function Vr(t){return t>=0?1:-1}function xe(t){return Math.abs(t)}function $1(t,e){return o7(t).map(function(n){return e(n)})}function wO(t){return od(t)?{top:t,left:t,right:t,bottom:t}:{left:t.left||0,top:t.top||0,right:t.right||0,bottom:t.bottom||0}}var hH=Dp("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(t,e){var n=e.datas,r=e.targets,i=e.angle,a=e.originalDatas,o=t.props,c=o.pinchable,u=o.ables;if(!c)return!1;var d="onPinch".concat(r?"Group":"","Start"),h="drag".concat(r?"Group":"","ControlStart"),p=(c===!0?t.controlAbles:u.filter(function(w){return c.indexOf(w.name)>-1})).filter(function(w){return w.canPinch&&w[h]}),m=lt(t,e,{});r&&(m.targets=r);var y=Ne(t,d,m);n.isPinch=y!==!1,n.ables=p;var _=n.isPinch;return _?(p.forEach(function(w){if(a[w.name]=a[w.name]||{},!!w[h]){var E=Z(Z({},e),{datas:a[w.name],parentRotate:i,isPinch:!0});w[h](t,E)}}),t.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},_):!1},pinch:function(t,e){var n=e.datas,r=e.scale,i=e.distance,a=e.originalDatas,o=e.inputEvent,c=e.targets,u=e.angle;if(n.isPinch){var d=i*(1-1/r),h=lt(t,e,{});c&&(h.targets=c);var p="onPinch".concat(c?"Group":"");Ne(t,p,h);var m=n.ables,y="drag".concat(c?"Group":"","Control");return m.forEach(function(_){_[y]&&_[y](t,Z(Z({},e),{datas:a[_.name],inputEvent:o,resolveMatrix:!0,pinchScale:r,parentDistance:d,parentRotate:u,isPinch:!0}))}),h}},pinchEnd:function(t,e){var n=e.datas,r=e.isPinch,i=e.inputEvent,a=e.targets,o=e.originalDatas;if(n.isPinch){var c="onPinch".concat(a?"Group":"","End"),u=_i(t,e,{isDrag:r});a&&(u.targets=a),Ne(t,c,u);var d=n.ables,h="drag".concat(a?"Group":"","ControlEnd");return d.forEach(function(p){p[h]&&p[h](t,Z(Z({},e),{isDrag:r,datas:o[p.name],inputEvent:i,isPinch:!0}))}),r}},pinchGroupStart:function(t,e){return this.pinchStart(t,Z(Z({},e),{targets:t.props.targets}))},pinchGroup:function(t,e){return this.pinch(t,Z(Z({},e),{targets:t.props.targets}))},pinchGroupEnd:function(t,e){return this.pinchEnd(t,Z(Z({},e),{targets:t.props.targets}))}}),vD=mS("scalable"),pH={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:UP("scalable"),dragControlCondition:vD,viewClassName:gS("scalable"),dragControlStart:function(t,e){var n=e.datas,r=e.isPinch,i=e.inputEvent,a=e.parentDirection,o=pO(a,r,i,n),c=t.state,u=c.width,d=c.height,h=c.targetTransform,p=c.target,m=c.pos1,y=c.pos2,_=c.pos4;if(!o||!p)return!1;r||Oc(t,e),n.datas={},n.transform=h,n.prevDist=[1,1],n.direction=o,n.startOffsetWidth=u,n.startOffsetHeight=d,n.startValue=[1,1];var w=!o[0]&&!o[1]||o[0]||!o[1];Rv(t,e,"scale"),n.isWidth=w;function E(P){n.ratio=P&&isFinite(P)?P:0}n.startPositions=Qi(t.state);function T(P){var A=eO(n.startPositions,P);n.fixedDirection=A.fixedDirection,n.fixedPosition=A.fixedPosition,n.fixedOffset=A.fixedOffset}n.setFixedDirection=T,E(Os(m,y)/Os(y,_)),T([-o[0],-o[1]]);var I=function(P){n.minScaleSize=P},D=function(P){n.maxScaleSize=P};I([-1/0,-1/0]),D([1/0,1/0]);var O=lt(t,e,Z(Z({direction:o,set:function(P){n.startValue=P},setRatio:E,setFixedDirection:T,setMinScaleSize:I,setMaxScaleSize:D},Dv(t,e)),{dragStart:Or.dragStart(t,new cd().dragStart([0,0],e))})),z=Ne(t,"onScaleStart",O);return n.startFixedDirection=n.fixedDirection,z!==!1&&(n.isScale=!0,t.state.snapRenderInfo={request:e.isRequest,direction:o}),n.isScale?O:!1},dragControl:function(t,e){Cv(t,e,"scale");var n=e.datas,r=e.parentKeepRatio,i=e.parentFlag,a=e.isPinch,o=e.dragClient,c=e.isRequest,u=e.useSnap,d=e.resolveMatrix,h=n.prevDist,p=n.direction,m=n.startOffsetWidth,y=n.startOffsetHeight,_=n.isScale,w=n.startValue,E=n.isWidth,T=n.ratio;if(!_)return!1;var I=t.props,D=I.throttleScale,O=I.parentMoveable,z=p;!p[0]&&!p[1]&&(z=[1,1]);var P=T&&(r??I.keepRatio)||!1,A=t.state,C=[w[0],w[1]];function k(){var Se=xO(z,P,n,e),Ie=Se.distWidth,Je=Se.distHeight,Me=m?(m+Ie)/m:1,$e=y?(y+Je)/y:1;w[0]||(C[0]=Ie/m),w[1]||(C[1]=Je/y);var We=(z[0]||P?Me:1)*C[0],pt=(z[1]||P?$e:1)*C[1];return We===0&&(We=Vr(h[0])*Dm),pt===0&&(pt=Vr(h[1])*Dm),[We,pt]}var V=k();if(!a&&t.props.groupable){var B=A.snapRenderInfo||{},j=B.direction;qn(j)&&(j[0]||j[1])&&(A.snapRenderInfo={direction:p,request:e.isRequest})}Ne(t,"onBeforeScale",lt(t,e,{scale:V,setFixedDirection:function(Se){return n.setFixedDirection(Se),V=k(),V},startFixedDirection:n.startFixedDirection,setScale:function(Se){V=Se}},!0));var N=[V[0]/C[0],V[1]/C[1]],K=o,W=[0,0],$=Vr(N[0]*N[1]),H=!o&&!i&&a;if(H||d?K=aS(t,n.targetAllTransform,[0,0],[0,0],n):o||(K=n.fixedPosition),a||(W=Hq(t,N,p,!u&&c,n)),P){z[0]&&z[1]&&W[0]&&W[1]&&(Math.abs(W[0]*m)>Math.abs(W[1]*y)?W[1]=0:W[0]=0);var te=!W[0]&&!W[1];if(te&&(E?N[0]=rt(N[0]*C[0],D)/C[0]:N[1]=rt(N[1]*C[1],D)/C[1]),z[0]&&!z[1]||W[0]&&!W[1]||te&&E){N[0]+=W[0];var re=m*N[0]*C[0]/T;N[1]=Vr($*N[0])*xe(re/y/C[1])}else if(!z[0]&&z[1]||!W[0]&&W[1]||te&&!E){N[1]+=W[1];var ue=y*N[1]*C[1]*T;N[0]=Vr($*N[1])*xe(ue/m/C[0])}}else N[0]+=W[0],N[1]+=W[1],W[0]||(N[0]=rt(N[0]*C[0],D)/C[0]),W[1]||(N[1]=rt(N[1]*C[1],D)/C[1]);N[0]===0&&(N[0]=Vr(h[0])*Dm),N[1]===0&&(N[1]=Vr(h[1])*Dm),V=Xq(N,[C[0],C[1]]);var F=[m,y],Q=[m*V[0],y*V[1]];Q=$M(Q,n.minScaleSize,n.maxScaleSize,P?T:!1),V=$1(2,function(Se){return F[Se]?Q[Se]/F[Se]:Q[Se]}),N=$1(2,function(Se){return V[Se]/C[Se]});var Y=$1(2,function(Se){return h[Se]?N[Se]/h[Se]:N[Se]}),ne="scale(".concat(N.join(", "),")"),pe="scale(".concat(V.join(", "),")"),de=Iv(n,pe,ne),ge=!w[0]||!w[1],we=HG(t,ge?pe:ne,n.fixedDirection,K,n.fixedOffset,n,ge),Te=H?we:qe(we,n.prevInverseDist||[0,0]);if(n.prevDist=N,n.prevInverseDist=we,V[0]===h[0]&&V[1]===h[1]&&Te.every(function(Se){return!Se})&&!O&&!H)return!1;var Xe=lt(t,e,Z({offsetWidth:m,offsetHeight:y,direction:p,scale:V,dist:N,delta:Y,isPinch:!!a},VP(t,de,Te,a,e)));return Ne(t,"onScale",Xe),Xe},dragControlEnd:function(t,e){var n=e.datas;if(!n.isScale)return!1;n.isScale=!1;var r=_i(t,e,{});return Ne(t,"onScaleEnd",r),r},dragGroupControlCondition:vD,dragGroupControlStart:function(t,e){var n=e.datas,r=this.dragControlStart(t,e);if(!r)return!1;var i=ga(t,"resizable",e);n.moveableScale=t.scale;var a=Vs(t,this,"dragControlStart",e,function(d,h){return N0(t,d,n,h)}),o=function(d){r.setFixedDirection(d),a.forEach(function(h,p){h.setFixedDirection(d),N0(t,h.moveable,n,i[p])})};n.setFixedDirection=o;var c=Z(Z({},r),{targets:t.props.targets,events:a,setFixedDirection:o}),u=Ne(t,"onScaleGroupStart",c);return n.isScale=u!==!1,n.isScale?c:!1},dragGroupControl:function(t,e){var n=e.datas;if(n.isScale){Ov(t,"onBeforeScale",function(h){Ne(t,"onBeforeScaleGroup",lt(t,e,Z(Z({},h),{targets:t.props.targets}),!0))});var r=this.dragControl(t,e);if(r){var i=r.dist,a=n.moveableScale;t.scale=[i[0]*a[0],i[1]*a[1]];var o=t.props.keepRatio,c=n.fixedPosition,u=Vs(t,this,"dragControl",e,function(h,p){var m=J(Rr(Cp(t.rotation/180*Math.PI,3),[p.datas.originalX*i[0],p.datas.originalY*i[1],1],3),2),y=m[0],_=m[1];return Z(Z({},p),{parentDist:null,parentScale:i,parentKeepRatio:o,dragClient:Tt(c,[y,_])})}),d=Z({targets:t.props.targets,events:u},r);return Ne(t,"onScaleGroup",d),d}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isScale){this.dragControlEnd(t,e);var i=Vs(t,this,"dragControlEnd",e),a=_i(t,e,{targets:t.props.targets,events:i});return Ne(t,"onScaleGroupEnd",a),n}},request:function(){var t={},e=0,n=0,r=!1;return{isControl:!0,requestStart:function(i){return r=i.useSnap,{datas:t,parentDirection:i.direction||[1,1],useSnap:r}},request:function(i){return e+=i.deltaWidth,n+=i.deltaHeight,{datas:t,parentDist:[e,n],parentKeepRatio:i.keepRatio,useSnap:r}},requestEnd:function(){return{datas:t,isDrag:!0,useSnap:r}}}}};function No(t,e){return t.map(function(n,r){return C0(n,e[r],1,2)})}function yD(t,e,n){var r=kn(t,e),i=kn(t,n),a=i-r;return a>=0?a:a+2*Math.PI}function gH(t,e){var n=yD(t[0],t[1],t[2]),r=yD(e[0],e[1],e[2]),i=Math.PI;return!(n>=i&&r<=i||n<=i&&r>=i)}var mH={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:gS("warpable"),render:function(t,e){var n=t.props,r=n.resizable,i=n.scalable,a=n.warpable,o=n.zoom;if(r||i||!a)return[];var c=t.state,u=c.pos1,d=c.pos2,h=c.pos3,p=c.pos4,m=No(u,d),y=No(d,u),_=No(u,h),w=No(h,u),E=No(h,p),T=No(p,h),I=No(d,p),D=No(p,d);return Ce([e.createElement("div",{className:Be("line"),key:"middeLine1",style:ah(m,E,o)}),e.createElement("div",{className:Be("line"),key:"middeLine2",style:ah(y,T,o)}),e.createElement("div",{className:Be("line"),key:"middeLine3",style:ah(_,I,o)}),e.createElement("div",{className:Be("line"),key:"middeLine4",style:ah(w,D,o)})],J(GP(t,"warpable",e)),!1)},dragControlCondition:function(t,e){if(e.isRequest)return!1;var n=e.inputEvent.target;return Qn(n,Be("direction"))&&Qn(n,Be("warpable"))},dragControlStart:function(t,e){var n=e.datas,r=e.inputEvent,i=t.props.target,a=r.target,o=gO(a,n);if(!o||!i)return!1;var c=t.state,u=c.transformOrigin,d=c.is3d,h=c.targetTransform,p=c.targetMatrix,m=c.width,y=c.height,_=c.left,w=c.top;n.datas={},n.targetTransform=h,n.warpTargetMatrix=d?p:ya(p,3,4),n.targetInverseMatrix=vP(Za(n.warpTargetMatrix,4),3,4),n.direction=o,n.left=_,n.top=w,n.poses=[[0,0],[m,0],[0,y],[m,y]].map(function(I){return qe(I,u)}),n.nextPoses=n.poses.map(function(I){var D=J(I,2),O=D[0],z=D[1];return Rr(n.warpTargetMatrix,[O,z,0,1],4)}),n.startValue=nn(4),n.prevMatrix=nn(4),n.absolutePoses=Qi(c),n.posIndexes=OP(o),Oc(t,e),Rv(t,e,"matrix3d"),c.snapRenderInfo={request:e.isRequest,direction:o};var E=lt(t,e,Z({set:function(I){n.startValue=I}},Dv(t,e))),T=Ne(t,"onWarpStart",E);return T!==!1&&(n.isWarp=!0),n.isWarp},dragControl:function(t,e){var n=e.datas,r=e.isRequest,i=e.distX,a=e.distY,o=n.targetInverseMatrix,c=n.prevMatrix,u=n.isWarp,d=n.startValue,h=n.poses,p=n.posIndexes,m=n.absolutePoses;if(!u)return!1;if(Cv(t,e,"matrix3d"),Bd(t,"warpable")){var y=p.map(function(k){return m[k]});y.length>1&&y.push([(y[0][0]+y[1][0])/2,(y[0][1]+y[1][1])/2]);var _=Mv(t,r,{horizontal:y.map(function(k){return k[1]+a}),vertical:y.map(function(k){return k[0]+i})}),w=_.horizontal,E=_.vertical;a-=w.offset,i-=E.offset}var T=ss({datas:n,distX:i,distY:a},!0),I=n.nextPoses.slice();if(p.forEach(function(k){I[k]=Tt(I[k],T)}),!OG.every(function(k){return gH(k.map(function(V){return h[V]}),k.map(function(V){return I[V]}))}))return!1;var D=Jw(h[0],h[2],h[1],h[3],I[0],I[2],I[1],I[3]);if(!D.length)return!1;var O=Yt(o,D,4),z=MP(n,O,!0),P=Yt(Za(c,4),z,4);n.prevMatrix=z;var A=Yt(d,z,4),C=Iv(n,"matrix3d(".concat(A.join(", "),")"),"matrix3d(".concat(z.join(", "),")"));return iS(e,C),Ne(t,"onWarp",lt(t,e,Z({delta:P,matrix:A,dist:z,multiply:Yt,transform:C},Lr({transform:C},e)))),!0},dragControlEnd:function(t,e){var n=e.datas,r=e.isDrag;return n.isWarp?(n.isWarp=!1,Ne(t,"onWarpEnd",_i(t,e,{})),r):!1}},vH=Be("area-pieces"),Om=Be("area-piece"),SO=Be("avoid"),yH=Be("view-dragging");function Y1(t){var e=t.areaElement;if(e){var n=t.state,r=n.width,i=n.height;WM(e,SO),e.style.cssText+="left: 0px; top: 0px; width: ".concat(r,"px; height: ").concat(i,"px")}}function bD(t){return t.createElement("div",{key:"area_pieces",className:vH},t.createElement("div",{className:Om}),t.createElement("div",{className:Om}),t.createElement("div",{className:Om}),t.createElement("div",{className:Om}))}var EO={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(t,e){var n=t.props,r=n.target,i=n.dragArea,a=n.groupable,o=n.passDragArea,c=t.getState(),u=c.width,d=c.height,h=c.renderPoses,p=o?Be("area","pass"):Be("area");if(a)return[e.createElement("div",{key:"area",ref:Ps(t,"areaElement"),className:p}),bD(e)];if(!r||!i)return[];var m=Jw([0,0],[u,0],[0,d],[u,d],h[0],h[1],h[2],h[3]),y=m.length?Pv(m,!0):"none";return[e.createElement("div",{key:"area",ref:Ps(t,"areaElement"),className:p,style:{top:"0px",left:"0px",width:"".concat(u,"px"),height:"".concat(d,"px"),transformOrigin:"0 0",transform:y}}),bD(e)]},dragStart:function(t,e){var n=e.datas,r=e.clientX,i=e.clientY,a=e.inputEvent;if(!a)return!1;n.isDragArea=!1;var o=t.areaElement,c=t.state,u=c.moveableClientRect,d=c.renderPoses,h=c.rootMatrix,p=c.is3d,m=u.left,y=u.top,_=Yi(d),w=_.left,E=_.top,T=_.width,I=_.height,D=p?4:3,O=J(fd(h,[r-m,i-y],D),2),z=O[0],P=O[1];z-=w,P-=E;var A=[{left:w,top:E,width:T,height:P-10},{left:w,top:E,width:z-10,height:I},{left:w,top:E+P+10,width:T,height:I-P-10},{left:w+z+10,top:E,width:T-z-10,height:I}],C=[].slice.call(o.nextElementSibling.children);A.forEach(function(k,V){C[V].style.cssText="left: ".concat(k.left,"px;top: ").concat(k.top,"px; width: ").concat(k.width,"px; height: ").concat(k.height,"px;")}),XM(o,SO),c.disableNativeEvent=!0},drag:function(t,e){var n=e.datas,r=e.inputEvent;if(this.enableNativeEvent(t),!r)return!1;n.isDragArea||(n.isDragArea=!0,Y1(t))},dragEnd:function(t,e){this.enableNativeEvent(t);var n=e.inputEvent,r=e.datas;if(!n)return!1;r.isDragArea||Y1(t)},dragGroupStart:function(t,e){return this.dragStart(t,e)},dragGroup:function(t,e){return this.drag(t,e)},dragGroupEnd:function(t,e){return this.dragEnd(t,e)},unset:function(t){Y1(t),t.state.disableNativeEvent=!1},enableNativeEvent:function(t){var e=t.state;e.disableNativeEvent&&HM(function(){e.disableNativeEvent=!1})}},bH=Dp("origin",{props:["origin","svgOrigin"],render:function(t,e){var n=t.props,r=n.zoom,i=n.svgOrigin,a=n.groupable,o=t.getState(),c=o.beforeOrigin,u=o.rotation,d=o.svg,h=o.allMatrix,p=o.is3d,m=o.left,y=o.top,_=o.offsetWidth,w=o.offsetHeight,E;if(!a&&d&&i){var T=J(yS(i,_,w),2),I=T[0],D=T[1],O=p?4:3,z=hn(h,[I,D],O);E=V0(u,r,qe(z,[m,y]))}else E=V0(u,r,c);return[e.createElement("div",{className:Be("control","origin"),style:E,key:"beforeOrigin"})]}});function xH(t){var e=t.scrollContainer;return[e.scrollLeft,e.scrollTop]}var _H={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(t,e){var n=t.props,r=n.scrollContainer,i=r===void 0?t.getContainer():r,a=n.scrollOptions,o=new eG,c=$a(i,!0);e.datas.dragScroll=o,t.state.dragScroll=o;var u=e.isControl?"controlGesto":"targetGesto",d=e.targets;o.on("scroll",function(h){var p=h.container,m=h.direction,y=lt(t,e,{scrollContainer:p,direction:m}),_=d?"onScrollGroup":"onScroll";d&&(y.targets=d),Ne(t,_,y)}).on("move",function(h){var p=h.offsetX,m=h.offsetY,y=h.inputEvent;t[u].scrollBy(p,m,y.inputEvent,!1)}).on("scrollDrag",function(h){var p=h.next;p(t[u].getCurrentEvent())}),o.dragStart(e,Z({container:c},a))},checkScroll:function(t,e){var n=e.datas.dragScroll;if(n){var r=t.props,i=r.scrollContainer,a=i===void 0?t.getContainer():i,o=r.scrollThreshold,c=o===void 0?0:o,u=r.scrollThrottleTime,d=u===void 0?0:u,h=r.getScrollPosition,p=h===void 0?xH:h,m=r.scrollOptions;return n.drag(e,Z({container:a,threshold:c,throttleTime:d,getScrollPosition:function(y){return p({scrollContainer:y.container,direction:y.direction})}},m)),!0}},drag:function(t,e){return this.checkScroll(t,e)},dragEnd:function(t,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(t,e){return this.dragStart(t,Z(Z({},e),{isControl:!0}))},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupStart:function(t,e){return this.dragStart(t,Z(Z({},e),{targets:t.props.targets}))},dragGroup:function(t,e){return this.drag(t,Z(Z({},e),{targets:t.props.targets}))},dragGroupEnd:function(t,e){return this.dragEnd(t,Z(Z({},e),{targets:t.props.targets}))},dragGroupControlStart:function(t,e){return this.dragStart(t,Z(Z({},e),{targets:t.props.targets,isControl:!0}))},dragGroupControl:function(t,e){return this.drag(t,Z(Z({},e),{targets:t.props.targets}))},dragGroupControEnd:function(t,e){return this.dragEnd(t,Z(Z({},e),{targets:t.props.targets}))},unset:function(t){var e,n=t.state;(e=n.dragScroll)===null||e===void 0||e.dragEnd(),n.dragScroll=null}},TO={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","preventRightClick","preventWheelClick","requestStyles"],events:["changeTargets"]},wH=Dp("padding",{props:["padding"],render:function(t,e){var n=t.props;if(n.dragArea)return[];var r=wO(n.padding||{}),i=r.left,a=r.top,o=r.right,c=r.bottom,u=t.getState(),d=u.renderPoses,h=u.pos1,p=u.pos2,m=u.pos3,y=u.pos4,_=[h,p,m,y],w=[];return i>0&&w.push([0,2]),a>0&&w.push([0,1]),o>0&&w.push([1,3]),c>0&&w.push([2,3]),w.map(function(E,T){var I=J(E,2),D=I[0],O=I[1],z=_[D],P=_[O],A=d[D],C=d[O],k=Jw([0,0],[100,0],[0,100],[100,100],z,P,A,C);if(k.length)return e.createElement("div",{key:"padding".concat(T),className:Be("padding"),style:{transform:Pv(k,!0)}})})}}),xD=["nw","ne","se","sw"];function Vm(t,e){var n=t[0]+t[1],r=n>e?e/n:1;return t[0]*=r,t[1]=e-t[1]*r,t}var SH=[1,2,5,6],EH=[0,3,4,7],Zl=[1,-1,-1,1],Jl=[1,1,-1,-1];function bS(t,e,n,r,i,a,o,c){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=n),c===void 0&&(c=r);var u=[],d=!1,h=t.filter(function(m){return!m.virtual}),p=h.map(function(m){var y=m.horizontal,_=m.vertical,w=m.pos;if(_&&!d&&(d=!0,u.push("/")),d){var E=Math.max(0,_===1?w[1]-a:c-w[1]);return u.push(ca(E,r,e)),E}else{var E=Math.max(0,y===1?w[0]-i:o-w[0]);return u.push(ca(E,n,e)),E}});return{radiusPoses:h,styles:u,raws:p}}function AO(t){for(var e=[0,0],n=[0,0],r=t.length,i=0;i<r;++i){var a=t[i];a.sub&&(a.horizontal&&(e[1]===0&&(e[0]=i),e[1]=i-e[0]+1,n[0]=i+1),a.vertical&&(n[1]===0&&(n[0]=i),n[1]=i-n[0]+1))}return{horizontalRange:e,verticalRange:n}}function CO(t,e,n,r,i,a,o){var c,u,d,h;a===void 0&&(a=[0,0]),o===void 0&&(o=!1);var p=t.indexOf("/"),m=(p>-1?t.slice(0,p):t).length,y=t.slice(0,m),_=t.slice(m+1),w=y.length,E=_.length,T=E>0,I=J(y,4),D=I[0],O=D===void 0?"0px":D,z=I[1],P=z===void 0?O:z,A=I[2],C=A===void 0?O:A,k=I[3],V=k===void 0?P:k,B=J(_,4),j=B[0],N=j===void 0?O:j,K=B[1],W=K===void 0?T?N:P:K,$=B[2],H=$===void 0?T?N:C:$,te=B[3],re=te===void 0?T?W:V:te,ue=[O,P,C,V].map(function(de){return $t(de,e)}),F=[N,W,H,re].map(function(de){return $t(de,n)}),Q=ue.slice(),Y=F.slice();c=J(Vm([Q[0],Q[1]],e),2),Q[0]=c[0],Q[1]=c[1],u=J(Vm([Q[3],Q[2]],e),2),Q[3]=u[0],Q[2]=u[1],d=J(Vm([Y[0],Y[3]],n),2),Y[0]=d[0],Y[3]=d[1],h=J(Vm([Y[1],Y[2]],n),2),Y[1]=h[0],Y[2]=h[1];var ne=o?Q:Q.slice(0,Math.max(a[0],w)),pe=o?Y:Y.slice(0,Math.max(a[1],E));return Ce(Ce([],J(ne.map(function(de,ge){var we=xD[ge];return{virtual:ge>=w,horizontal:Zl[ge],vertical:0,pos:[r+de,i+(Jl[ge]===-1?n:0)],sub:!0,raw:ue[ge],direction:we}})),!1),J(pe.map(function(de,ge){var we=xD[ge];return{virtual:ge>=E,horizontal:0,vertical:Jl[ge],pos:[r+(Zl[ge]===-1?e:0),i+de],sub:!0,raw:F[ge],direction:we}})),!1)}function TH(t,e,n,r,i){i===void 0&&(i=e.length);var a=AO(t.slice(r)),o=a.horizontalRange,c=a.verticalRange,u=n-r,d=0;if(u===0)d=i;else if(u>0&&u<o[1])d=o[1]-u;else if(u>=c[0])d=c[0]+c[1]-u;else return;t.splice(n,d),e.splice(n,d)}function AH(t,e,n,r,i,a,o,c,u,d,h){d===void 0&&(d=0),h===void 0&&(h=0);var p=AO(t.slice(n)),m=p.horizontalRange,y=p.verticalRange;if(r>-1)for(var _=Zl[r]===1?a-d:c-a,w=m[1];w<=r;++w){var E=Jl[w]===1?h:u,T=0;if(r===w?T=a:w===0?T=d+_:Zl[w]===-1&&(T=c-(e[n][0]-d)),t.splice(n+w,0,{horizontal:Zl[w],vertical:0,pos:[T,E]}),e.splice(n+w,0,[T,E]),w===0)break}else if(i>-1){var I=Jl[i]===1?o-h:u-o;if(m[1]===0&&y[1]===0){var D=[d+I,h];t.push({horizontal:Zl[0],vertical:0,pos:D}),e.push(D)}for(var O=y[0],w=y[1];w<=i;++w){var T=Zl[w]===1?d:c,E=0;if(i===w?E=o:w===0?E=h+I:Jl[w]===1?E=e[n+O][1]:Jl[w]===-1&&(E=u-(e[n+O][1]-h)),t.push({horizontal:0,vertical:Jl[w],pos:[T,E]}),e.push([T,E]),w===0)break}}}function CH(t,e){e===void 0&&(e=t.map(function(i){return i.raw}));var n=t.map(function(i,a){return i.horizontal?e[a]:null}).filter(function(i){return i!=null}),r=t.map(function(i,a){return i.vertical?e[a]:null}).filter(function(i){return i!=null});return{horizontals:n,verticals:r}}var IH=[[0,-1,"n"],[1,0,"e"]],DH=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function xS(t,e,n){var r=t.props.clipRelative,i=t.state,a=i.width,o=i.height,c=e,u=c.type,d=c.poses,h=u==="rect",p=u==="circle";if(u==="polygon")return n.map(function(P){return"".concat(ca(P[0],a,r)," ").concat(ca(P[1],o,r))});if(h||u==="inset"){var m=n[1][1],y=n[3][0],_=n[7][0],w=n[5][1];if(h)return[m,y,w,_].map(function(P){return"".concat(P,"px")});var E=[m,a-y,o-w,_].map(function(P,A){return ca(P,A%2?a:o,r)});if(n.length>8){var T=J(qe(n[4],n[0]),2),I=T[0],D=T[1];E.push.apply(E,Ce(["round"],J(bS(d.slice(8).map(function(P,A){return Z(Z({},P),{pos:n[A]})}),r,I,D,_,m,y,w).styles),!1))}return E}else if(p||u==="ellipse"){var O=n[0],z=ca(xe(n[1][1]-O[1]),p?Math.sqrt((a*a+o*o)/2):o,r),E=p?[z]:[ca(xe(n[2][0]-O[0]),a,r),z];return E.push("at",ca(O[0],a,r),ca(O[1],o,r)),E}}function z0(t,e,n,r){var i=[r,(r+e)/2,e],a=[t,(t+n)/2,n];return DH.map(function(o){var c=J(o,3),u=c[0],d=c[1],h=c[2],p=i[u+1],m=a[d+1];return{vertical:xe(d),horizontal:xe(u),direction:h,pos:[p,m]}})}function IO(t){var e=[1/0,-1/0],n=[1/0,-1/0];return t.forEach(function(r){var i=r.pos;e[0]=Math.min(e[0],i[0]),e[1]=Math.max(e[1],i[0]),n[0]=Math.min(n[0],i[1]),n[1]=Math.max(n[1],i[1])}),[xe(e[1]-e[0]),xe(n[1]-n[0])]}function _D(t,e,n,r,i){var a,o,c,u,d,h,p,m,y;if(t){var _=i;if(!_){var w=si(t),E=w("clipPath");_=E!=="none"?E:w("clip")}if(!((!_||_==="none"||_==="auto")&&(_=r,!_))){var T=qM(_),I=T.prefix,D=I===void 0?_:I,O=T.value,z=O===void 0?"":O,P=D==="circle",A=" ";if(D==="polygon"){var C=sc(z||"0% 0%, 100% 0%, 100% 100%, 0% 100%");A=",";var k=C.map(function(Pt){var yn=J(Pt.split(" "),2),Wt=yn[0],ht=yn[1];return{vertical:1,horizontal:1,pos:[$t(Wt,e),$t(ht,n)]}}),V=xc(k.map(function(Pt){return Pt.pos}));return{type:D,clipText:_,poses:k,splitter:A,left:V.minX,right:V.maxX,top:V.minY,bottom:V.maxY}}else if(P||D==="ellipse"){var B="",j="",N=0,K=0,C=al(z);if(P){var W="";a=J(C,4),o=a[0],W=o===void 0?"50%":o,c=a[2],B=c===void 0?"50%":c,u=a[3],j=u===void 0?"50%":u,N=$t(W,Math.sqrt((e*e+n*n)/2)),K=N}else{var $="",H="";d=J(C,5),h=d[0],$=h===void 0?"50%":h,p=d[1],H=p===void 0?"50%":p,m=d[3],B=m===void 0?"50%":m,y=d[4],j=y===void 0?"50%":y,N=$t($,e),K=$t(H,n)}var te=[$t(B,e),$t(j,n)],k=Ce([{vertical:1,horizontal:1,pos:te,direction:"nesw"}],J(IH.slice(0,P?1:2).map(function(Wt){return{vertical:xe(Wt[1]),horizontal:Wt[0],direction:Wt[2],sub:!0,pos:[te[0]+Wt[0]*N,te[1]+Wt[1]*K]}})),!1);return{type:D,clipText:_,radiusX:N,radiusY:K,left:te[0]-N,top:te[1]-K,right:te[0]+N,bottom:te[1]+K,poses:k,splitter:A}}else if(D==="inset"){var C=al(z||"0 0 0 0"),re=C.indexOf("round"),ue=(re>-1?C.slice(0,re):C).length,F=C.slice(ue+1),Q=J(C.slice(0,ue),4),Y=Q[0],ne=Q[1],pe=ne===void 0?Y:ne,de=Q[2],ge=de===void 0?Y:de,we=Q[3],Te=we===void 0?pe:we,Xe=J([Y,ge].map(function(Wt){return $t(Wt,n)}),2),Se=Xe[0],Ie=Xe[1],Je=J([Te,pe].map(function(Wt){return $t(Wt,e)}),2),Me=Je[0],$e=Je[1],We=e-$e,pt=n-Ie,_t=CO(F,We-Me,pt-Se,Me,Se),k=Ce(Ce([],J(z0(Se,We,pt,Me)),!1),J(_t),!1);return{type:"inset",clipText:_,poses:k,top:Se,left:Me,right:We,bottom:pt,radius:F,splitter:A}}else if(D==="rect"){var C=sc(z||"0px, ".concat(e,"px, ").concat(n,"px, 0px"));A=",";var Pe=J(C.map(function(Ft){var lr=wp(Ft).value;return lr}),4),Ue=Pe[0],$e=Pe[1],Ie=Pe[2],Me=Pe[3],k=z0(Ue,$e,Ie,Me);return{type:"rect",clipText:_,poses:k,top:Ue,right:$e,bottom:Ie,left:Me,values:C,splitter:A}}}}}function RH(t,e,n,r,i){var a=t[e],o=a.direction,c=a.sub,u=t.map(function(){return[0,0]}),d=o?o.split(""):[];if(r&&e<8){var h=d.filter(function(N){return N==="w"||N==="e"}),p=d.filter(function(N){return N==="n"||N==="s"}),m=h[0],y=p[0];u[e]=n;var _=J(IO(t),2),w=_[0],E=_[1],T=w&&E?w/E:0;if(T&&i){var I=(e+4)%8,D=t[I].pos,O=[0,0];o.indexOf("w")>-1?O[0]=-1:o.indexOf("e")>-1&&(O[0]=1),o.indexOf("n")>-1?O[1]=-1:o.indexOf("s")>-1&&(O[1]=1);var z=bO([w,E],n,T,O,!0),P=w+z[0],A=E+z[1],C=D[1],k=D[1],V=D[0],B=D[0];O[0]===-1?V=B-P:O[0]===1?B=V+P:(V=V-P/2,B=B+P/2),O[1]===-1?C=k-A:(O[1]===1||(C=k-A/2),k=C+A);var j=z0(C,B,k,V);t.forEach(function(N,K){u[K][0]=j[K].pos[0]-N.pos[0],u[K][1]=j[K].pos[1]-N.pos[1]})}else t.forEach(function(N,K){var W=N.direction;W&&(W.indexOf(m)>-1&&(u[K][0]=n[0]),W.indexOf(y)>-1&&(u[K][1]=n[1]))}),m&&(u[1][0]=n[0]/2,u[5][0]=n[0]/2),y&&(u[3][1]=n[1]/2,u[7][1]=n[1]/2)}else o&&!c?d.forEach(function(N){var K=N==="n"||N==="s";t.forEach(function(W,$){var H=W.direction,te=W.horizontal,re=W.vertical;!H||H.indexOf(N)===-1||(u[$]=[K||!te?0:n[0],!K||!re?0:n[1]])})}):u[e]=n;return u}function kH(t,e){var n=J(NP(t,e),2),r=n[0],i=n[1],a=e.datas,o=a.clipPath,c=a.clipIndex,u=o,d=u.type,h=u.poses,p=u.splitter,m=h.map(function(I){return I.pos});if(d==="polygon")m.splice(c,0,[r,i]);else if(d==="inset"){var y=SH.indexOf(c),_=EH.indexOf(c),w=h.length;if(AH(h,m,8,y,_,r,i,m[4][0],m[4][1],m[0][0],m[0][1]),w===h.length)return}else return;var E=xS(t,o,m),T="".concat(d,"(").concat(E.join(p),")");Ne(t,"onClip",lt(t,e,Z({clipEventType:"added",clipType:d,poses:m,clipStyles:E,clipStyle:T,distX:0,distY:0},Lr({clipPath:T},e))))}function NH(t,e){var n=e.datas,r=n.clipPath,i=n.clipIndex,a=r,o=a.type,c=a.poses,u=a.splitter,d=c.map(function(y){return y.pos}),h=d.length;if(o==="polygon")c.splice(i,1),d.splice(i,1);else if(o==="inset"){if(i<8||(TH(c,d,i,8,h),h===c.length))return}else return;var p=xS(t,r,d),m="".concat(o,"(").concat(p.join(u),")");Ne(t,"onClip",lt(t,e,Z({clipEventType:"removed",clipType:o,poses:d,clipStyles:p,clipStyle:m,distX:0,distY:0},Lr({clipPath:m},e))))}var MH={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(t,e){var n=t.props,r=n.customClipPath,i=n.defaultClipPath,a=n.clipArea,o=n.zoom,c=n.groupable,u=t.getState(),d=u.target,h=u.width,p=u.height,m=u.allMatrix,y=u.is3d,_=u.left,w=u.top,E=u.pos1,T=u.pos2,I=u.pos3,D=u.pos4,O=u.clipPathState,z=u.snapBoundInfos,P=u.rotation;if(!d||c)return[];var A=_D(d,h,p,i||"inset",O||r);if(!A)return[];var C=y?4:3,k=A.type,V=A.poses,B=V.map(function($e){var We=hn(m,$e.pos,C);return[We[0]-_,We[1]-w]}),j=[],N=[],K=k==="rect",W=k==="inset",$=k==="polygon";if(K||W||$){var H=W?B.slice(0,8):B;N=H.map(function($e,We){var pt=We===0?H[H.length-1]:H[We-1],_t=kn(pt,$e),Pe=uO(pt,$e);return e.createElement("div",{key:"clipLine".concat(We),className:Be("line","clip-line","snap-control"),"data-clip-index":We,style:{width:"".concat(Pe,"px"),transform:"translate(".concat(pt[0],"px, ").concat(pt[1],"px) rotate(").concat(_t,"rad) scaleY(").concat(o,")")}})})}if(j=B.map(function($e,We){return e.createElement("div",{key:"clipControl".concat(We),className:Be("control","clip-control","snap-control"),"data-clip-index":We,style:{transform:"translate(".concat($e[0],"px, ").concat($e[1],"px) rotate(").concat(P,"rad) scale(").concat(o,")")}})}),W&&j.push.apply(j,Ce([],J(B.slice(8).map(function($e,We){return e.createElement("div",{key:"clipRadiusControl".concat(We),className:Be("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+We,style:{transform:"translate(".concat($e[0],"px, ").concat($e[1],"px) rotate(").concat(P,"rad) scale(").concat(o,")")}})})),!1)),k==="circle"||k==="ellipse"){var te=A.left,re=A.top,ue=A.radiusX,F=A.radiusY,Q=J(qe(hn(m,[te,re],C),hn(m,[0,0],C)),2),Y=Q[0],ne=Q[1],pe="none";if(!a){for(var de=Math.max(10,ue/5,F/5),ge=[],we=0;we<=de;++we){var Te=Math.PI*2/de*we;ge.push([ue+(ue-o)*Math.cos(Te),F+(F-o)*Math.sin(Te)])}ge.push([ue,-2]),ge.push([-2,-2]),ge.push([-2,F*2+2]),ge.push([ue*2+2,F*2+2]),ge.push([ue*2+2,-2]),ge.push([ue,-2]),pe="polygon(".concat(ge.map(function($e){return"".concat($e[0],"px ").concat($e[1],"px")}).join(", "),")")}j.push(e.createElement("div",{key:"clipEllipse",className:Be("clip-ellipse","snap-control"),style:{width:"".concat(ue*2,"px"),height:"".concat(F*2,"px"),clipPath:pe,transform:"translate(".concat(-_+Y,"px, ").concat(-w+ne,"px) ").concat(Pv(m))}}))}if(a){var Xe=Yi(Ce([E,T,I,D],J(B),!1)),Se=Xe.width,Ie=Xe.height,Je=Xe.left,Me=Xe.top;if($||K||W){var ge=W?B.slice(0,8):B;j.push(e.createElement("div",{key:"clipArea",className:Be("clip-area","snap-control"),style:{width:"".concat(Se,"px"),height:"".concat(Ie,"px"),transform:"translate(".concat(Je,"px, ").concat(Me,"px)"),clipPath:"polygon(".concat(ge.map(function(We){return"".concat(We[0]-Je,"px ").concat(We[1]-Me,"px")}).join(", "),")")}}))}}return z&&["vertical","horizontal"].forEach(function($e){var We=z[$e],pt=$e==="horizontal";We.isSnap&&N.push.apply(N,Ce([],J(We.snap.posInfos.map(function(_t,Pe){var Ue=_t.pos,Pt=qe(hn(m,pt?[0,Ue]:[Ue,0],C),[_,w]),yn=qe(hn(m,pt?[h,Ue]:[Ue,p],C),[_,w]);return Yh(e,"",Pt,yn,o,"clip".concat($e,"snap").concat(Pe),"guideline")})),!1)),We.isBound&&N.push.apply(N,Ce([],J(We.bounds.map(function(_t,Pe){var Ue=_t.pos,Pt=qe(hn(m,pt?[0,Ue]:[Ue,0],C),[_,w]),yn=qe(hn(m,pt?[h,Ue]:[Ue,p],C),[_,w]);return Yh(e,"",Pt,yn,o,"clip".concat($e,"bounds").concat(Pe),"guideline","bounds","bold")})),!1))}),Ce(Ce([],J(j),!1),J(N),!1)},dragControlCondition:function(t,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(t,e){var n=t.props,r=n.dragWithClip,i=r===void 0?!0:r;return i?!1:this.dragControlStart(t,e)},drag:function(t,e){return this.dragControl(t,Z(Z({},e),{isDragTarget:!0}))},dragEnd:function(t,e){return this.dragControlEnd(t,e)},dragControlStart:function(t,e){var n=t.state,r=t.props,i=r.defaultClipPath,a=r.customClipPath,o=n.target,c=n.width,u=n.height,d=e.inputEvent?e.inputEvent.target:null,h=d&&d.getAttribute("class")||"",p=e.datas,m=_D(o,c,u,i||"inset",a);if(!m)return!1;var y=m.clipText,_=m.type,w=m.poses,E=Ne(t,"onClipStart",lt(t,e,{clipType:_,clipStyle:y,poses:w.map(function(T){return T.pos})}));return E===!1?(p.isClipStart=!1,!1):(p.isControl=h&&h.indexOf("clip-control")>-1,p.isLine=h.indexOf("clip-line")>-1,p.isArea=h.indexOf("clip-area")>-1||h.indexOf("clip-ellipse")>-1,p.clipIndex=d?parseInt(d.getAttribute("data-clip-index"),10):-1,p.clipPath=m,p.isClipStart=!0,n.clipPathState=y,Oc(t,e),!0)},dragControl:function(t,e){var n,r,i,a=e.datas,o=e.originalDatas,c=e.isDragTarget;if(!a.isClipStart)return!1;var u=a,d=u.isControl,h=u.isLine,p=u.isArea,m=u.clipIndex,y=u.clipPath;if(!y)return!1;var _=_c(t.props,"clippable"),w=_.keepRatio,E=0,T=0,I=o.draggable,D=ss(e);c&&I?(n=J(I.prevBeforeDist,2),E=n[0],T=n[1]):(r=J(D,2),E=r[0],T=r[1]);var O=[E,T],z=t.state,P=z.width,A=z.height,C=!p&&!d&&!h,k=y.type,V=y.poses,B=y.splitter,j=V.map(function(ut){return ut.pos});C&&(E=-E,T=-T);var N=!d||V[m].direction==="nesw",K=k==="inset"||k==="rect",W=V.map(function(){return[0,0]});if(d&&!N){var $=V[m],H=$.horizontal,te=$.vertical,re=[E*xe(H),T*xe(te)];W=RH(V,m,re,K,w)}else N&&(W=j.map(function(){return[E,T]}));var ue=j.map(function(ut,Zt){return Tt(ut,W[Zt])}),F=Ce([],J(ue),!1);z.snapBoundInfos=null;var Q=y.type==="circle",Y=y.type==="ellipse";if(Q||Y){var ne=Yi(ue),pe=xe(ne.bottom-ne.top),de=xe(Y?ne.right-ne.left:pe),ge=ue[0][1]+pe,we=ue[0][0]-de,Te=ue[0][0]+de;Q&&(F.push([Te,ne.bottom]),W.push([1,0])),F.push([ne.left,ge]),W.push([0,1]),F.push([we,ne.bottom]),W.push([1,0])}var Xe=iO((_.clipHorizontalGuidelines||[]).map(function(ut){return $t("".concat(ut),A)}),(_.clipVerticalGuidelines||[]).map(function(ut){return $t("".concat(ut),P)}),P,A),Se=[],Ie=[];if(Q||Y)Se=[F[4][0],F[2][0]],Ie=[F[1][1],F[3][1]];else if(K){var Je=[F[0],F[2],F[4],F[6]],Me=[W[0],W[2],W[4],W[6]];Se=Je.filter(function(ut,Zt){return Me[Zt][0]}).map(function(ut){return ut[0]}),Ie=Je.filter(function(ut,Zt){return Me[Zt][1]}).map(function(ut){return ut[1]})}else Se=F.filter(function(ut,Zt){return W[Zt][0]}).map(function(ut){return ut[0]}),Ie=F.filter(function(ut,Zt){return W[Zt][1]}).map(function(ut){return ut[1]});var $e=[0,0],We=aD(Xe,_.clipTargetBounds&&{left:0,top:0,right:P,bottom:A},Se,Ie,5,5),pt=We.horizontal,_t=We.vertical,Pe=pt.offset,Ue=_t.offset;if(pt.isBound&&($e[1]+=Pe),_t.isBound&&($e[0]+=Ue),(Y||Q)&&W[0][0]===0&&W[0][1]===0){var ne=Yi(ue),Pt=ne.bottom-ne.top,yn=Y?ne.right-ne.left:Pt,Wt=_t.isBound?xe(Ue):_t.snapIndex===0?-Ue:Ue,ht=pt.isBound?xe(Pe):pt.snapIndex===0?-Pe:Pe;yn-=Wt,Pt-=ht,Q&&(Pt=WP(_t,pt)>0?Pt:yn,yn=Pt);var At=F[0];F[1][1]=At[1]-Pt,F[2][0]=At[0]+yn,F[3][1]=At[1]+Pt,F[4][0]=At[0]-yn}else if(K&&w&&d){var Ft=J(IO(V),2),lr=Ft[0],Gr=Ft[1],ls=lr&&Gr?lr/Gr:0,Zs=V[m],Si=Zs.direction||"",_r=F[1][1],ge=F[5][1],we=F[7][0],Te=F[3][0];xe(Pe)<=xe(Ue)?Pe=Vr(Pe)*xe(Ue)/ls:Ue=Vr(Ue)*xe(Pe)*ls,Si.indexOf("w")>-1?we-=Ue:Si.indexOf("e")>-1?Te-=Ue:(we+=Ue/2,Te-=Ue/2),Si.indexOf("n")>-1?_r-=Pe:Si.indexOf("s")>-1?ge-=Pe:(_r+=Pe/2,ge-=Pe/2);var Nr=z0(_r,Te,ge,we);F.forEach(function(Ae,je){var wt;wt=J(Nr[je].pos,2),Ae[0]=wt[0],Ae[1]=wt[1]})}else F.forEach(function(ut,Zt){var Jt=W[Zt];Jt[0]&&(ut[0]-=Ue),Jt[1]&&(ut[1]-=Pe)});var bn=xS(t,y,ue),tr="".concat(k,"(").concat(bn.join(B),")");if(z.clipPathState=tr,Q||Y)Se=[F[4][0],F[2][0]],Ie=[F[1][1],F[3][1]];else if(K){var Je=[F[0],F[2],F[4],F[6]];Se=Je.map(function(Zt){return Zt[0]}),Ie=Je.map(function(Zt){return Zt[1]})}else Se=F.map(function(ut){return ut[0]}),Ie=F.map(function(ut){return ut[1]});if(z.snapBoundInfos=aD(Xe,_.clipTargetBounds&&{left:0,top:0,right:P,bottom:A},Se,Ie,1,1),I){var Qt=z.is3d,Js=z.allMatrix,xa=Qt?4:3,_a=$e;c&&(_a=[O[0]+$e[0]-D[0],O[1]+$e[1]-D[1]]),I.deltaOffset=Yt(Js,[_a[0],_a[1],0,0],xa)}return Ne(t,"onClip",lt(t,e,Z({clipEventType:"changed",clipType:k,poses:ue,clipStyle:tr,clipStyles:bn,distX:E,distY:T},Lr((i={},i[k==="rect"?"clip":"clipPath"]=tr,i),e)))),!0},dragControlEnd:function(t,e){this.unset(t);var n=e.isDrag,r=e.datas,i=e.isDouble,a=r.isLine,o=r.isClipStart,c=r.isControl;return o?(Ne(t,"onClipEnd",_i(t,e,{})),i&&(c?NH(t,e):a&&kH(t,e)),i||n):!1},unset:function(t){t.state.clipPathState="",t.state.snapBoundInfos=null}},PH={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(t,e){return e.isRequest?e.requestAble==="originDraggable":Qn(e.inputEvent.target,Be("origin"))},dragControlStart:function(t,e){var n=e.datas;Oc(t,e);var r=lt(t,e,{dragStart:Or.dragStart(t,new cd().dragStart([0,0],e))}),i=Ne(t,"onDragOriginStart",r);return n.startOrigin=t.state.transformOrigin,n.startTargetOrigin=t.state.targetOrigin,n.prevOrigin=[0,0],n.isDragOrigin=!0,i===!1?(n.isDragOrigin=!1,!1):r},dragControl:function(t,e){var n=e.datas,r=e.isPinch,i=e.isRequest;if(!n.isDragOrigin)return!1;var a=J(ss(e),2),o=a[0],c=a[1],u=t.state,d=u.width,h=u.height,p=u.offsetMatrix,m=u.targetMatrix,y=u.is3d,_=t.props.originRelative,w=_===void 0?!0:_,E=y?4:3,T=[o,c];if(i){var I=e.distOrigin;(I[0]||I[1])&&(T=I)}var D=Tt(n.startOrigin,T),O=Tt(n.startTargetOrigin,T),z=qe(T,n.prevOrigin),P=kp(p,m,D,E),A=t.getRect(),C=Yi(Vc(P,d,h,E)),k=[A.left-C.left,A.top-C.top];n.prevOrigin=T;var V=[ca(O[0],d,w),ca(O[1],h,w)].join(" "),B=Or.drag(t,Rp(e,t.state,k,!!r)),j=lt(t,e,Z(Z({width:d,height:h,origin:D,dist:T,delta:z,transformOrigin:V,drag:B},Lr({transformOrigin:V,transform:B.transform},e)),{afterTransform:B.transform}));return Ne(t,"onDragOrigin",j),j},dragControlEnd:function(t,e){var n=e.datas;return n.isDragOrigin?(Ne(t,"onDragOriginEnd",_i(t,e,{})),!0):!1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragGroupControlStart:function(t,e){var n=this.dragControlStart(t,e);return!!n},dragGroupControl:function(t,e){var n=this.dragControl(t,e);return n?(t.transformOrigin=n.transformOrigin,!0):!1},request:function(t){var e={},n=t.getRect(),r=0,i=0,a=n.transformOrigin,o=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(c){return"deltaOrigin"in c?(o[0]+=c.deltaOrigin[0],o[1]+=c.deltaOrigin[1]):"origin"in c?(o[0]=c.origin[0]-a[0],o[1]=c.origin[1]-a[1]):("x"in c?r=c.x-n.left:"deltaX"in c&&(r+=c.deltaX),"y"in c?i=c.y-n.top:"deltaY"in c&&(i+=c.deltaY)),{datas:e,distX:r,distY:i,distOrigin:o}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function OH(t,e,n,r){var i=t.filter(function(u){var d=u.virtual,h=u.horizontal;return h&&!d}).length,a=t.filter(function(u){var d=u.virtual,h=u.vertical;return h&&!d}).length,o=-1;if(e===0&&(i===0?o=0:i===1&&(o=1)),e===2&&(i<=2?o=2:i<=3&&(o=3)),e===3&&(a===0?o=4:a<4&&(o=7)),e===1&&(a<=1?o=5:a<=2&&(o=6)),!(o===-1||!t[o].virtual)){var c=t[o];VH(t,o),o<4?c.pos[0]=n:c.pos[1]=r}}function VH(t,e){e<4?t.slice(0,e+1).forEach(function(n){n.virtual=!1}):(t[0].virtual&&(t[0].virtual=!1),t.slice(4,e+1).forEach(function(n){n.virtual=!1}))}function jH(t,e){e<4?t.slice(e,4).forEach(function(n){n.virtual=!0}):t.slice(e).forEach(function(n){n.virtual=!0})}function wD(t,e,n,r,i){r===void 0&&(r=[0,0]);var a=[];return!t||t==="0px"?a=[]:a=al(t),CO(a,e,n,0,0,r,i)}function SD(t,e,n,r,i){var a=t.state,o=a.width,c=a.height,u=bS(i,t.props.roundRelative,o,c),d=u.raws,h=u.styles,p=u.radiusPoses,m=CH(p,d),y=m.horizontals,_=m.verticals,w=h.join(" ");a.borderRadiusState=w;var E=lt(t,e,Z({horizontals:y,verticals:_,borderRadius:w,width:o,height:c,delta:r,dist:n},Lr({borderRadius:w},e)));return Ne(t,"onRound",E),E}function ED(t){var e,n,r=t.getState().style,i=r.borderRadius||"";if(!i&&t.props.groupable){var a=t.moveables[0],o=t.getTargets()[0];o&&(a?.props.target===o?(i=(n=(e=t.moveables[0])===null||e===void 0?void 0:e.state.style.borderRadius)!==null&&n!==void 0?n:"",r.borderRadius=i):(i=pS(o).borderRadius,r.borderRadius=i))}return i}var zH={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(t){var e=t.props.roundClickable;return e===!0||e==="line"?Be("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(t,e){var n=t.getState(),r=n.target,i=n.width,a=n.height,o=n.allMatrix,c=n.is3d,u=n.left,d=n.top,h=n.borderRadiusState,p=t.props,m=p.minRoundControls,y=m===void 0?[0,0]:m,_=p.maxRoundControls,w=_===void 0?[4,4]:_,E=p.zoom,T=p.roundPadding,I=T===void 0?0:T,D=p.isDisplayShadowRoundControls,O=p.groupable;if(!r)return null;var z=h||ED(t),P=c?4:3,A=wD(z,i,a,y,!0);if(!A)return null;var C=0,k=0,V=O?[0,0]:[u,d];return A.map(function(B,j){var N=B.horizontal,K=B.vertical,W=B.direction||"",$=Ce([],J(B.pos),!1);k+=Math.abs(N),C+=Math.abs(K),N&&W.indexOf("n")>-1&&($[1]-=I),K&&W.indexOf("w")>-1&&($[0]-=I),N&&W.indexOf("s")>-1&&($[1]+=I),K&&W.indexOf("e")>-1&&($[0]+=I);var H=qe(hn(o,$,P),V),te=D&&D!=="horizontal",re=B.vertical?C<=w[1]&&(te||!B.virtual):k<=w[0]&&(D||!B.virtual);return e.createElement("div",{key:"borderRadiusControl".concat(j),className:Be("control","border-radius",B.vertical?"vertical":"",B.virtual?"virtual":""),"data-radius-index":j,style:{display:re?"block":"none",transform:"translate(".concat(H[0],"px, ").concat(H[1],"px) scale(").concat(E,")")}})})},dragControlCondition:function(t,e){if(!e.inputEvent||e.isRequest)return!1;var n=e.inputEvent.target.getAttribute("class")||"";return n.indexOf("border-radius")>-1||n.indexOf("moveable-line")>-1&&n.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragControlStart:function(t,e){var n=e.inputEvent,r=e.datas,i=n.target,a=i.getAttribute("class")||"",o=a.indexOf("border-radius")>-1,c=a.indexOf("moveable-line")>-1&&a.indexOf("moveable-direction")>-1,u=o?parseInt(i.getAttribute("data-radius-index"),10):-1,d=-1;if(c){var h=i.getAttribute("data-line-key")||"";h&&(d=parseInt(h.replace(/render-line-/g,""),10),isNaN(d)&&(d=-1))}if(!o&&!c)return!1;var p=lt(t,e,{}),m=Ne(t,"onRoundStart",p);if(m===!1)return!1;r.lineIndex=d,r.controlIndex=u,r.isControl=o,r.isLine=c,Oc(t,e);var y=t.props,_=y.roundRelative,w=y.minRoundControls,E=w===void 0?[0,0]:w,T=t.state,I=T.width,D=T.height;r.isRound=!0,r.prevDist=[0,0];var O=ED(t),z=wD(O||"",I,D,E,!0)||[];return r.controlPoses=z,T.borderRadiusState=bS(z,_,I,D).styles.join(" "),p},dragControl:function(t,e){var n=e.datas,r=n.controlPoses;if(!n.isRound||!n.isControl||!r.length)return!1;var i=n.controlIndex,a=J(ss(e),2),o=a[0],c=a[1],u=[o,c],d=qe(u,n.prevDist),h=t.props.maxRoundControls,p=h===void 0?[4,4]:h,m=t.state,y=m.width,_=m.height,w=r[i],E=w.vertical,T=w.horizontal,I=r.map(function(O){var z=O.horizontal,P=O.vertical,A=[z*T*u[0],P*E*u[1]];if(z){if(p[0]===1)return A;if(p[0]<4&&z!==T)return A}else{if(p[1]===0)return A[1]=P*T*u[0]/y*_,A;if(E){if(p[1]===1)return A;if(p[1]<4&&P!==E)return A}}return[0,0]});I[i]=u;var D=r.map(function(O,z){return Z(Z({},O),{pos:Tt(O.pos,I[z])})});return i<4?D.slice(0,i+1).forEach(function(O){O.virtual=!1}):D.slice(4,i+1).forEach(function(O){O.virtual=!1}),n.prevDist=[o,c],SD(t,e,u,d,D)},dragControlEnd:function(t,e){var n=t.state;n.borderRadiusState="";var r=e.datas,i=e.isDouble;if(!r.isRound)return!1;var a=r.isControl,o=r.controlIndex,c=r.isLine,u=r.lineIndex,d=r.controlPoses,h=d.filter(function(T){var I=T.virtual;return I}).length,p=t.props.roundClickable,m=p===void 0?!0:p;if(i&&m){if(a&&(m===!0||m==="control"))jH(d,o);else if(c&&(m===!0||m==="line")){var y=J(NP(t,e),2),_=y[0],w=y[1];OH(d,u,_,w)}h!==d.filter(function(T){var I=T.virtual;return I}).length&&SD(t,e,[0,0],[0,0],d)}var E=_i(t,e,{});return Ne(t,"onRoundEnd",E),n.borderRadiusState="",E},dragGroupControlStart:function(t,e){var n=this.dragControlStart(t,e);if(!n)return!1;var r=t.moveables,i=t.props.targets,a=ga(t,"roundable",e),o=Z({targets:t.props.targets,events:a.map(function(c,u){return Z(Z({},c),{target:i[u],moveable:r[u],currentTarget:r[u]})})},n);return Ne(t,"onRoundGroupStart",o),n},dragGroupControl:function(t,e){var n=this.dragControl(t,e);if(!n)return!1;var r=t.moveables,i=t.props.targets,a=ga(t,"roundable",e),o=Z({targets:t.props.targets,events:a.map(function(c,u){return Z(Z(Z({},c),{target:i[u],moveable:r[u],currentTarget:r[u]}),Lr({borderRadius:n.borderRadius},c))})},n);return Ne(t,"onRoundGroup",o),o},dragGroupControlEnd:function(t,e){var n=t.moveables,r=t.props.targets,i=ga(t,"roundable",e);Ov(t,"onRound",function(c){var u=Z({targets:t.props.targets,events:i.map(function(d,h){return Z(Z(Z({},d),{target:r[h],moveable:n[h],currentTarget:n[h]}),Lr({borderRadius:c.borderRadius},d))})},c);Ne(t,"onRoundGroup",u)});var a=this.dragControlEnd(t,e);if(!a)return!1;var o=Z({targets:t.props.targets,events:i.map(function(c,u){var d;return Z(Z({},c),{target:r[u],moveable:n[u],currentTarget:n[u],lastEvent:(d=c.datas)===null||d===void 0?void 0:d.lastEvent})})},a);return Ne(t,"onRoundGroupEnd",o),o},unset:function(t){t.state.borderRadiusState=""}};function LH(t,e){var n=e?4:3,r=nn(n),i="matrix".concat(e?"3d":"","(").concat(r.join(","),")");return t===i||t==="matrix(1,0,0,1,0,0)"}var DO={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(t,e){var n=t.state,r=n.is3d,i=n.targetMatrix,a=n.inlineTransform,o=r?"matrix3d(".concat(i.join(","),")"):"matrix(".concat(bP(i,!0),")"),c=!a||a==="none"?o:a;e.datas.startTransforms=LH(c,r)?[]:al(c)},resetStyle:function(t){var e=t.datas;e.nextStyle={},e.nextTransforms=t.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(t,e){return lt(t,e,{setTransform:function(n){e.datas.startTransforms=qn(n)?n:al(n)},isPinch:!!e.isPinch})},fillDragParams:function(t,e){return lt(t,e,{isPinch:!!e.isPinch})},dragStart:function(t,e){this.setTransform(t,e),this.resetStyle(e),Ne(t,"onBeforeRenderStart",this.fillDragStartParams(t,e))},drag:function(t,e){e.datas.startTransforms||this.setTransform(t,e),this.resetStyle(e),Ne(t,"onBeforeRender",lt(t,e,{isPinch:!!e.isPinch}))},dragEnd:function(t,e){e.datas.startTransforms||(this.setTransform(t,e),this.resetStyle(e)),Ne(t,"onBeforeRenderEnd",lt(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(t,e){var n=this;this.dragStart(t,e);var r=ga(t,"beforeRenderable",e),i=t.moveables,a=r.map(function(o,c){var u=i[c];return n.setTransform(u,o),n.resetStyle(o),n.fillDragStartParams(u,o)});Ne(t,"onBeforeRenderGroupStart",lt(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,setTransform:function(){},events:a}))},dragGroup:function(t,e){var n=this;this.drag(t,e);var r=ga(t,"beforeRenderable",e),i=t.moveables,a=r.map(function(o,c){var u=i[c];return n.resetStyle(o),n.fillDragParams(u,o)});Ne(t,"onBeforeRenderGroup",lt(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,events:a}))},dragGroupEnd:function(t,e){this.dragEnd(t,e),Ne(t,"onBeforeRenderGroupEnd",lt(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets}))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)}},RO={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(t,e){Ne(t,"onRenderStart",lt(t,e,{isPinch:!!e.isPinch}))},drag:function(t,e){Ne(t,"onRender",this.fillDragParams(t,e))},dragAfter:function(t,e){return this.drag(t,e)},dragEnd:function(t,e){Ne(t,"onRenderEnd",this.fillDragEndParams(t,e))},dragGroupStart:function(t,e){Ne(t,"onRenderGroupStart",lt(t,e,{isPinch:!!e.isPinch,targets:t.props.targets}))},dragGroup:function(t,e){var n=this,r=ga(t,"beforeRenderable",e),i=t.moveables,a=r.map(function(o,c){var u=i[c];return n.fillDragParams(u,o)});Ne(t,"onRenderGroup",lt(t,e,Z(Z({isPinch:!!e.isPinch,targets:t.props.targets,transform:Rm(e),transformObject:{}},Lr(km(e))),{events:a})))},dragGroupEnd:function(t,e){var n=this,r=ga(t,"beforeRenderable",e),i=t.moveables,a=r.map(function(o,c){var u=i[c];return n.fillDragEndParams(u,o)});Ne(t,"onRenderGroupEnd",lt(t,e,Z({isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets,events:a,transformObject:{},transform:Rm(e)},Lr(km(e)))))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlAfter:function(t,e){return this.dragAfter(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)},fillDragParams:function(t,e){var n={};return ld(k0(e)||[]).forEach(function(r){n[r.name]=r.functionValue}),lt(t,e,Z({isPinch:!!e.isPinch,transformObject:n,transform:Rm(e)},Lr(km(e))))},fillDragEndParams:function(t,e){var n={};return ld(k0(e)||[]).forEach(function(r){n[r.name]=r.functionValue}),lt(t,e,Z({isPinch:!!e.isPinch,isDrag:e.isDrag,transformObject:n,transform:Rm(e)},Lr(km(e))))}};function Sh(t,e,n,r,i,a,o){a.clientDistX=a.distX,a.clientDistY=a.distY;var c=i==="Start",u=i==="End",d=i==="After",h=t.state.target,p=a.isRequest,m=r.indexOf("Control")>-1;if(!h||c&&m&&!p&&t.areaElement===a.inputEvent.target)return!1;var y=Ce([],J(e),!1);if(p){var _=a.requestAble;y.some(function(j){return j.name===_})||y.push.apply(y,Ce([],J(t.props.ables.filter(function(j){return j.name===_})),!1))}if(!y.length||y.every(function(j){return j.dragRelation}))return!1;var w=a.inputEvent,E;u&&w&&(E=document.elementFromPoint(a.clientX,a.clientY)||w.target);var T=!1,I=function(){var j;T=!0,(j=a.stop)===null||j===void 0||j.call(a)},D=c&&(!t.targetGesto||!t.controlGesto||!t.targetGesto.isFlag()||!t.controlGesto.isFlag());D&&t.updateRect(i,!0,!1);var O=a.datas,z=m?"controlGesto":"targetGesto",P=t[z],A=function(j,N,K){if(!(N in j)||P!==t[z])return!1;var W=j.name,$=O[W]||(O[W]={});if(c&&($.isEventStart=!K||!j[K]||j[K](t,a)),!$.isEventStart)return!1;var H=j[N](t,Z(Z({},a),{stop:I,datas:$,originalDatas:O,inputTarget:E}));return t._emitter.off(),c&&H===!1&&($.isEventStart=!1),H};D&&y.forEach(function(j){j.unset&&j.unset(t)}),A(DO,"drag".concat(r).concat(i));var C=0,k=0;n.forEach(function(j){if(T)return!1;var N="".concat(j).concat(r).concat(i),K="".concat(j).concat(r,"Condition");i===""&&!p&&lH(t.state,a);var W=y.filter(function(te){return te[N]});W=W.filter(function(te,re){return te.name&&W.indexOf(te)===re});var $=W.filter(function(te){return A(te,N,K)}),H=$.length;T&&++C,H&&++k,!T&&c&&W.length&&!H&&(C+=W.filter(function(te){var re=te.name,ue=O[re];return ue.isEventStart?te.dragRelation!=="strong":!1}).length?1:0)}),(!d||k)&&A(RO,"drag".concat(r).concat(i));var V=P!==t[z]||C===n.length;if((u||T||V)&&(t.state.gestos={},t.moveables&&t.moveables.forEach(function(j){j.state.gestos={}}),y.forEach(function(j){j.unset&&j.unset(t)})),c&&!V&&!p&&k&&t.props.preventDefault&&a?.preventDefault(),t.isUnmounted||V)return!1;if(!c&&k&&!o||u){var B=t.props.flushSync||oO;B(function(){t.updateRect(u?i:"",!0,!1),t.forceUpdate()})}return!c&&!u&&!d&&k&&!o&&Sh(t,e,n,r,i+"After",a),!0}function _S(t,e){return function(n,r){var i;r===void 0&&(r=n.inputEvent.target);var a=r,o=t.areaElement,c=t._dragTarget;return!c||!e&&(!((i=t.controlGesto)===null||i===void 0)&&i.isFlag())?!1:a===c||c.contains(a)||a===o||!t.isMoveableElement(a)&&!t.controlBox.contains(a)||Qn(a,"moveable-area")||Qn(a,"moveable-padding")||Qn(a,"moveable-edgeDraggable")}}function kO(t,e,n){var r=t.controlBox,i=[],a=t.props,o=a.dragArea,c=t.state.target,u=a.dragTarget;i.push(r),(!o||u)&&i.push(e),!o&&u&&c&&e!==c&&a.dragTargetSelf&&i.push(c);var d=_S(t);return MO(t,i,"targetAbles",n,{dragStart:d,pinchStart:d})}function NO(t,e){var n=t.controlBox,r=[];r.push(n);var i=_S(t,!0),a=function(o,c){if(c===void 0&&(c=o.inputEvent.target),c===n)return!0;var u=i(o,c);return!u};return MO(t,r,"controlAbles",e,{dragStart:a,pinchStart:a})}function MO(t,e,n,r,i){i===void 0&&(i={});var a=n==="targetAbles",o=t.props,c=o.pinchOutside,u=o.pinchThreshold,d=o.preventClickEventOnDrag,h=o.preventClickDefault,p=o.checkInput,m=o.dragFocusedInput,y=o.preventDefault,_=y===void 0?!0:y,w=o.preventRightClick,E=w===void 0?!0:w,T=o.preventWheelClick,I=T===void 0?!0:T,D=o.dragContainer,O=$a(D,!0),z={preventDefault:_,preventRightClick:E,preventWheelClick:I,container:O||Wo(t.getControlBoxElement()),pinchThreshold:u,pinchOutside:c,preventClickEventOnDrag:a?d:!1,preventClickEventOnDragStart:a?h:!1,preventClickEventByCondition:a?null:function(C){return t.controlBox.contains(C.target)},checkInput:a?p:!1,dragFocusedInput:m},P=new fG(e,z),A=r==="Control";return["drag","pinch"].forEach(function(C){["Start","","End"].forEach(function(k){P.on("".concat(C).concat(k),function(V){var B,j=V.eventType,N=C==="drag"&&V.isPinch;if(i[j]&&!i[j](V)){V.stop();return}if(!N){var K=C==="drag"?[C]:["drag",C],W=Ce([],J(t[n]),!1),$=Sh(t,W,K,r,k,V);$?(t.props.stopPropagation||k==="Start"&&A)&&((B=V?.inputEvent)===null||B===void 0||B.stopPropagation()):V.stop()}})})}),P}var BH=(function(){function t(e,n,r){var i=this;this.target=e,this.moveable=n,this.eventName=r,this.ables=[],this._onEvent=function(a){var o=i.eventName,c=i.moveable;c.state.disableNativeEvent||i.ables.forEach(function(u){u[o](c,{inputEvent:a})})},e.addEventListener(r.toLowerCase(),this._onEvent)}return t.prototype.setAbles=function(e){this.ables=e},t.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},t})();function FH(t,e,n,r){var i;n===void 0&&(n=e);var a=zP(t,e),o=a.matrixes,c=a.is3d,u=a.targetMatrix,d=a.transformOrigin,h=a.targetOrigin,p=a.offsetContainer,m=a.hasFixed,y=a.zoom,_=tq(p,n),w=_.matrixes,E=_.is3d,T=_.offsetContainer,I=_.zoom,D=r,O=4,z=t.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in t,P=u,A=nn(O),C=nn(O),k=nn(O),V=nn(O),B=o.length,j=w.map(function(re){return Z(Z({},re),{matrix:re.matrix?Ce([],J(re.matrix),!1):void 0})}).reverse();o.reverse(),!c&&D&&(P=ya(P,3,4),l_(o)),!E&&D&&l_(j),j.forEach(function(re){C=Yt(C,re.matrix,O)});var N=n||gl(t),K=((i=j[0])===null||i===void 0?void 0:i.target)||Kh(N,N,!0).offsetParent,W=j.slice(1).reduce(function(re,ue){return Yt(re,ue.matrix,O)},nn(O));o.forEach(function(re,ue){if(B-2===ue&&(k=A.slice()),B-1===ue&&(V=A.slice()),!re.matrix){var F=o[ue+1],Q=iH(re,F,K,O,Yt(W,A,O));re.matrix=bc(Q,O)}A=Yt(A,re.matrix,O)});var $=!z&&c;P||(P=nn($?4:3));var H=Pv(z&&P.length===16?ya(P,4,3):P,$),te=C;return C=vP(C,O,O),{hasZoom:y!==1||I!==1,hasFixed:m,matrixes:o,rootMatrix:C,originalRootMatrix:te,beforeMatrix:k,offsetMatrix:V,allMatrix:A,targetMatrix:P,targetTransform:H,inlineTransform:t.style.transform,transformOrigin:d,targetOrigin:h,is3d:D,offsetContainer:p,offsetRootContainer:T}}function UH(t,e,n,r){n===void 0&&(n=e);var i=0,a=0,o=0,c={},u=dO(t);if(t&&(i=u.offsetWidth,a=u.offsetHeight),t){var d=FH(t,e,n,r),h=ed(d.allMatrix,d.transformOrigin,i,a);c=Z(Z({},d),h);var p=ed(d.allMatrix,[50,50],100,100);o=fO([p.pos1,p.pos2],p.direction)}var m=4;return Z(Z(Z({hasZoom:!1,width:i,height:a,rotation:o},u),{originalRootMatrix:nn(m),rootMatrix:nn(m),beforeMatrix:nn(m),offsetMatrix:nn(m),allMatrix:nn(m),targetMatrix:nn(m),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!0,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),c)}function f_(t,e,n,r,i,a){a===void 0&&(a=[]);var o=1,c=[0,0],u=Mm(),d=Mm(),h=Mm(),p=Mm(),m=[0,0],y={},_=UH(e,n,i,!0);if(e){var w=si(e);a.forEach(function(j){y[j]=w(j)});var E=_.is3d?4:3,T=ed(_.offsetMatrix,Tt(_.transformOrigin,yP(_.targetMatrix,E)),_.width,_.height);o=T.direction,c=Tt(T.origin,[T.left-_.left,T.top-_.top]),p=wh(_.offsetRootContainer);var I=Kh(r,r,!0).offsetParent||_.offsetRootContainer;if(_.hasZoom){var D=ed(Yt(_.originalRootMatrix,_.allMatrix),_.transformOrigin,_.width,_.height),O=ed(_.originalRootMatrix,O0(si(I)("transformOrigin")).map(function(j){return parseFloat(j)}),I.offsetWidth,I.offsetHeight);if(u=H1(D,p),h=H1(O,p,I,!0),t){var z=D.left,P=D.top;d=H1({left:z,top:P,bottom:P,right:P},p)}}else{u=wh(e),h=eq(I),t&&(d=wh(t));var A=h.left,C=h.top,k=h.clientLeft,V=h.clientTop,B=[u.left-A,u.top-C];m=qe(fd(_.rootMatrix,B,4),[k+_.left,V+_.top])}}return Z({targetClientRect:u,containerClientRect:h,moveableClientRect:d,rootContainerClientRect:p,beforeDirection:o,beforeOrigin:c,originalBeforeOrigin:c,target:e,style:y,offsetDelta:m},_)}function TD(t){var e=t.pos1,n=t.pos2,r=t.pos3,i=t.pos4;if(!e||!n||!r||!i)return null;var a=xc([e,n,r,i]),o=[a.minX,a.minY],c=qe(t.origin,o);return e=qe(e,o),n=qe(n,o),r=qe(r,o),i=qe(i,o),Z(Z({},t),{left:t.left,top:t.top,posDelta:o,pos1:e,pos2:n,pos3:r,pos4:i,origin:c,beforeOrigin:c,isPersisted:!0})}var hd=(function(t){Ip(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.state=Z({container:null,gestos:{},renderLines:[[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]]],renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},f_(null)),n.renderState={},n.enabledAbles=[],n.targetAbles=[],n.controlAbles=[],n.rotation=0,n.scale=[1,1],n.isMoveableMounted=!1,n.isUnmounted=!1,n.events={mouseEnter:null,mouseLeave:null},n._emitter=new Av,n._prevOriginalDragTarget=null,n._originalDragTarget=null,n._prevDragTarget=null,n._dragTarget=null,n._prevPropTarget=null,n._propTarget=null,n._prevDragArea=!1,n._isPropTargetChanged=!1,n._hasFirstTarget=!1,n._reiszeObserver=null,n._observerId=0,n._mutationObserver=null,n._rootContainer=null,n._viewContainer=null,n._viewClassNames=[],n._store={},n.checkUpdateRect=function(){if(!n.isDragging()){var r=n.props.parentMoveable;if(r){r.checkUpdateRect();return}r7(n._observerId),n._observerId=HM(function(){n.isDragging()||n.updateRect()})}},n._onPreventClick=function(r){r.stopPropagation(),r.preventDefault()},n}return e.prototype.render=function(){var n=this.props,r=this.getState(),i=n.parentPosition,a=n.className,o=n.target,c=n.zoom,u=n.cspNonce,d=n.translateZ,h=n.cssStyled,p=n.groupable,m=n.linePadding,y=n.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var _=J(i||[0,0],2),w=_[0],E=_[1],T=r.left,I=r.top,D=r.target,O=r.direction,z=r.hasFixed,P=r.offsetDelta,A=n.targets,C=this.isDragging(),k={};this.getEnabledAbles().forEach(function(W){k["data-able-".concat(W.name.toLowerCase())]=!0});var V=this._getAbleClassName(),B=A&&A.length&&(D||p)||o||!this._hasFirstTarget&&this.state.isPersisted,j=this.controlBox||this.props.firstRenderState||this.props.persistData,N=[T-w,I-E];!p&&n.useAccuratePosition&&(N[0]+=P[0],N[1]+=P[1]);var K={position:z?"fixed":"absolute",display:B?"block":"none",visibility:j?"visible":"hidden",transform:"translate3d(".concat(N[0],"px, ").concat(N[1],"px, ").concat(d,")"),"--zoom":c,"--zoompx":"".concat(c,"px")};return m&&(K["--moveable-line-padding"]=m),y&&(K["--moveable-control-padding"]=y),pa(h,Z({cspNonce:u,ref:Ps(this,"controlBox"),className:"".concat(Be("control-box",O===-1?"reverse":"",C?"dragging":"")," ").concat(V," ").concat(a)},k,{onClick:this._onPreventClick,style:K}),this.renderAbles(),this._renderLines())},e.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var n=this.props,r=n.parentMoveable,i=n.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!r&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},e.prototype.componentDidUpdate=function(n){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(n)},e.prototype.componentWillUnmount=function(){var n,r;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(n=this._reiszeObserver)===null||n===void 0||n.disconnect(),(r=this._mutationObserver)===null||r===void 0||r.disconnect();var i=this._viewContainer;i&&this._changeAbleViewClassNames([]),Ku(this,!1),Ku(this,!0);var a=this.events;for(var o in a){var c=a[o];c&&c.destroy()}},e.prototype.getTargets=function(){var n=this.props.target;return n?[n]:[]},e.prototype.getAble=function(n){var r=this.props.ables||[];return ai(r,function(i){return i.name===n})},e.prototype.getContainer=function(){var n=this.props,r=n.parentMoveable,i=n.wrapperMoveable,a=n.container;return a||i&&i.getContainer()||r&&r.getContainer()||this.controlBox.parentElement},e.prototype.getControlBoxElement=function(){return this.controlBox},e.prototype.getDragElement=function(){return this._dragTarget},e.prototype.isMoveableElement=function(n){var r;return n&&(((r=n.getAttribute)===null||r===void 0?void 0:r.call(n,"class"))||"").indexOf(nS)>-1},e.prototype.dragStart=function(n,r){r===void 0&&(r=n.target);var i=this.targetGesto,a=this.controlGesto;return i&&_S(this)({inputEvent:n},r)?i.isFlag()||i.triggerDragStart(n):a&&this.isMoveableElement(r)&&(a.isFlag()||a.triggerDragStart(n)),this},e.prototype.hitTest=function(n){var r=this.state,i=r.target,a=r.pos1,o=r.pos2,c=r.pos3,u=r.pos4,d=r.targetClientRect;if(!i)return 0;var h;if(jd(n)){var p=n.getBoundingClientRect();h={left:p.left,top:p.top,width:p.width,height:p.height}}else h=Z({width:0,height:0},n);var m=h.left,y=h.top,_=h.width,w=h.height,E=K2([a,o,u,c],d),T=sG(E,[[m,y],[m+_,y],[m+_,y+w],[m,y+w]]),I=wP(E);return!T||!I?0:Math.min(100,T/I*100)},e.prototype.isInside=function(n,r){var i=this.state,a=i.target,o=i.pos1,c=i.pos2,u=i.pos3,d=i.pos4,h=i.targetClientRect;return a?Xx([n,r],K2([o,c,d,u],h)):!1},e.prototype.updateRect=function(n,r,i){i===void 0&&(i=!0);var a=this.props,o=!a.parentPosition&&!a.wrapperMoveable;o&&ud(!0);var c=a.parentMoveable,u=this.state,d=u.target||a.target,h=this.getContainer(),p=c?c._rootContainer:this._rootContainer,m=f_(this.controlBox,d,h,h,p||h,this._getRequestStyles());if(!d&&this._hasFirstTarget&&a.persistData){var y=TD(a.persistData);for(var _ in y)m[_]=y[_]}o&&ud(),this.updateState(m,c?!1:i)},e.prototype.isDragging=function(n){var r,i,a=this.targetGesto,o=this.controlGesto;if(a?.isFlag()){if(!n)return!0;var c=a.getEventData();return!!(!((r=c[n])===null||r===void 0)&&r.isEventStart)}if(o?.isFlag()){if(!n)return!0;var c=o.getEventData();return!!(!((i=c[n])===null||i===void 0)&&i.isEventStart)}return!1},e.prototype.updateTarget=function(n){this.updateRect(n,!0)},e.prototype.getRect=function(){var n=this.state,r=Qi(this.state),i=J(r,4),a=i[0],o=i[1],c=i[2],u=i[3],d=Yi(r),h=n.width,p=n.height,m=d.width,y=d.height,_=d.left,w=d.top,E=[n.left,n.top],T=Tt(E,n.origin),I=Tt(E,n.beforeOrigin),D=n.transformOrigin;return{width:m,height:y,left:_,top:w,pos1:a,pos2:o,pos3:c,pos4:u,offsetWidth:h,offsetHeight:p,beforeOrigin:I,origin:T,transformOrigin:D,rotation:this.getRotation()}},e.prototype.getManager=function(){return this},e.prototype.stopDrag=function(n){if(!n||n==="target"){var r=this.targetGesto;r?.isIdle()===!1&&c_(this,!1),r?.stop()}if(!n||n==="control"){var r=this.controlGesto;r?.isIdle()===!1&&c_(this,!0),r?.stop()}},e.prototype.getRotation=function(){var n=this.state,r=n.pos1,i=n.pos2,a=n.direction;return dH(r,i,a)},e.prototype.request=function(n,r,i){r===void 0&&(r={});var a=this,o=a.props,c=o.parentMoveable||o.wrapperMoveable||a,u=c.props.ables,d=o.groupable,h=ai(u,function(T){return T.name===n});if(this.isDragging()||!h||!h.request)return{request:function(){return this},requestEnd:function(){return this}};var p=h.request(a),m=i||r.isInstant,y=p.isControl?"controlAbles":"targetAbles",_="".concat(d?"Group":"").concat(p.isControl?"Control":""),w=Ce([],J(c[y]),!1),E={request:function(T){return Sh(a,w,["drag"],_,"",Z(Z({},p.request(T)),{requestAble:n,isRequest:!0}),m),E},requestEnd:function(){return Sh(a,w,["drag"],_,"End",Z(Z({},p.requestEnd()),{requestAble:n,isRequest:!0}),m),E}};return Sh(a,w,["drag"],_,"Start",Z(Z({},p.requestStart(r)),{requestAble:n,isRequest:!0}),m),m?E.request(r).requestEnd():E},e.prototype.getMoveables=function(){return[this]},e.prototype.destroy=function(){this.componentWillUnmount()},e.prototype.updateRenderPoses=function(){var n=this.getState(),r=this.props,i=r.padding,a=n.originalBeforeOrigin,o=n.transformOrigin,c=n.allMatrix,u=n.is3d,d=n.pos1,h=n.pos2,p=n.pos3,m=n.pos4,y=n.left,_=n.top,w=n.isPersisted,E=r.zoom||1;if(!i&&E<=1){n.renderPoses=[d,h,p,m],n.renderLines=[[d,h],[h,m],[m,p],[p,d]];return}var T=wO(i||{}),I=T.left,D=T.top,O=T.bottom,z=T.right,P=u?4:3,A=[];w?A=o:this.controlBox&&r.groupable?A=a:A=Tt(a,[y,_]);var C=D0(P,bc(A.map(function(K){return-K}),P),c,bc(o,P)),k=ji(C,d,[-I,-D],P),V=ji(C,h,[z,-D],P),B=ji(C,p,[-I,O],P),j=ji(C,m,[z,O],P);n.renderPoses=[k,V,B,j],n.renderLines=[[k,V],[V,j],[j,B],[B,k]];{var N=E/2;n.renderLines=[[ji(C,d,[-I-N,-D],P),ji(C,h,[z+N,-D],P)],[ji(C,h,[z,-D-N],P),ji(C,m,[z,O+N],P)],[ji(C,m,[z+N,O],P),ji(C,p,[-I-N,O],P)],[ji(C,p,[-I,O+N],P),ji(C,d,[-I,-D-N],P)]]}},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var n=this.props,r=n.target,i=n.container,a=n.parentMoveable,o=this.state,c=o.target,u=o.container;if(!(!c&&!r)){this.updateAbles();var d=!u_(c,r),h=d||!u_(u,i);if(h){var p=i||this.controlBox;p&&this.unsetAbles(),this.updateState({target:r,container:i}),!a&&p&&this.updateRect("End",!1,!1),this._isPropTargetChanged=d}}},e.prototype.waitToChangeTarget=function(){return new Promise(function(){})},e.prototype.triggerEvent=function(n,r){var i=this.props;if(this._emitter.trigger(n,r),i.parentMoveable&&r.isRequest&&!r.isRequestChild)return i.parentMoveable.triggerEvent(n,r,!0);var a=i[n];return a&&a(r)},e.prototype.useCSS=function(n,r){var i=this.props.customStyledMap,a=n+r;return i[a]||(i[a]=TP(n,r)),i[a]},e.prototype.getState=function(){var n,r=this.props;(r.target||!((n=r.targets)===null||n===void 0)&&n.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,a=r.persistData,o=r.firstRenderState;if(o&&!i)return o;if(!this._hasFirstTarget&&a){var c=TD(a);if(c)return this.updateState(c,!1),this.state}return this.state.isPersisted=!1,this.state},e.prototype.updateSelectors=function(){},e.prototype.unsetAbles=function(){var n=this;this.targetAbles.forEach(function(r){r.unset&&r.unset(n)})},e.prototype.updateAbles=function(n,r){n===void 0&&(n=this.props.ables),r===void 0&&(r="");var i=this.props,a=i.triggerAblesSimultaneously,o=this.getEnabledAbles(n),c="drag".concat(r,"Start"),u="pinch".concat(r,"Start"),d="drag".concat(r,"ControlStart"),h=Pm(o,[c,u],a),p=Pm(o,[d],a);this.enabledAbles=o,this.targetAbles=h,this.controlAbles=p},e.prototype.updateState=function(n,r){if(r){if(this.isUnmounted)return;this.setState(n)}else{var i=this.state;for(var a in n)i[a]=n[a]}},e.prototype.getEnabledAbles=function(n){n===void 0&&(n=this.props.ables);var r=this.props;return n.filter(function(i){return i&&(i.always&&r[i.name]!==!1||r[i.name])})},e.prototype.renderAbles=function(){var n=this,r=this.props,i=r.triggerAblesSimultaneously,a={createElement:pa};return this.renderState={},oH(yO(Pm(this.getEnabledAbles(),["render"],i).map(function(o){var c=o.render;return c(n,a)||[]})).filter(function(o){return o}),function(o){var c=o.key;return c}).map(function(o){return o[0]})},e.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},e.prototype._getRequestStyles=function(){var n=this.getEnabledAbles().reduce(function(r,i){var a,o,c=(o=(a=i.requestStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return Ce(Ce([],J(r),!1),J(c),!1)},Ce([],J(this.props.requestStyles||[]),!1));return n},e.prototype._updateObserver=function(n){this._updateResizeObserver(n),this._updateMutationObserver(n)},e.prototype._updateEvents=function(){var n=this.targetAbles.length,r=this.controlAbles.length,i=this._dragTarget,a=!n&&this.targetGesto||this._isTargetChanged(!0);a&&(Ku(this,!1),this.updateState({gestos:{}})),r||Ku(this,!0),i&&n&&!this.targetGesto&&(this.targetGesto=kO(this,i,"")),!this.controlGesto&&r&&(this.controlGesto=NO(this,"Control"))},e.prototype._updateTargets=function(){var n=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=n.dragArea,this._propTarget=n.target,this._originalDragTarget=n.dragTarget||n.target,this._dragTarget=$a(this._originalDragTarget,!0)},e.prototype._renderLines=function(){var n=this.props,r=n,i=r.zoom,a=r.hideDefaultLines,o=r.hideChildMoveableDefaultLines,c=r.parentMoveable;if(a||c&&o)return[];var u=this.getState(),d={createElement:pa};return u.renderLines.map(function(h,p){return Yh(d,"",h[0],h[1],i,"render-line-".concat(p))})},e.prototype._isTargetChanged=function(n){var r=this.props,i=r.dragTarget||r.target,a=this._prevOriginalDragTarget,o=this._prevDragArea,c=r.dragArea,u=!c&&a!==i,d=(n||c)&&o!==c;return u||d||this._prevPropTarget!=this._propTarget},e.prototype._updateNativeEvents=function(){var n=this,r=this.props,i=r.dragArea?this.areaElement:this.state.target,a=this.events,o=Us(a);if(this._isTargetChanged())for(var c in a){var u=a[c];u&&u.destroy(),a[c]=null}if(i){var d=this.enabledAbles;o.forEach(function(h){var p=Pm(d,[h]),m=p.length>0,y=a[h];if(!m){y&&(y.destroy(),a[h]=null);return}y||(y=new BH(i,n,h),a[h]=y),y.setAbles(p)})}},e.prototype._checkUpdateRootContainer=function(){var n=this.props.rootContainer;!this._rootContainer&&n&&(this._rootContainer=$a(n,!0))},e.prototype._checkUpdateViewContainer=function(){var n=this.props.viewContainer;!this._viewContainer&&n&&(this._viewContainer=$a(n,!0));var r=this._viewContainer;r&&this._changeAbleViewClassNames(Ce(Ce([],J(this._getAbleViewClassNames()),!1),[this.isDragging()?yH:""],!1))},e.prototype._changeAbleViewClassNames=function(n){var r=this._viewContainer,i=vO(n.filter(Boolean),function(d){return d}).map(function(d){var h=J(d,1),p=h[0];return p}),a=this._viewClassNames,o=Sp(a,i),c=o.removed,u=o.added;c.forEach(function(d){WM(r,a[d])}),u.forEach(function(d){XM(r,i[d])}),this._viewClassNames=i},e.prototype._getAbleViewClassNames=function(){var n=this;return(this.getEnabledAbles().map(function(r){var i;return((i=r.viewClassName)===null||i===void 0?void 0:i.call(r,n))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},e.prototype._getAbleClassName=function(n){var r=this;n===void 0&&(n="");var i=this.getEnabledAbles(),a=this.targetGesto,o=this.controlGesto,c=a?.isFlag()?a.getEventData():{},u=o?.isFlag()?o.getEventData():{};return i.map(function(d){var h,p,m,y=d.name,_=((h=d.className)===null||h===void 0?void 0:h.call(d,r))||"";return(!((p=c[y])===null||p===void 0)&&p.isEventStart||!((m=u[y])===null||m===void 0)&&m.isEventStart)&&(_+=" ".concat(Be("".concat(y).concat(n,"-dragging")))),_.trim()}).filter(Boolean).join(" ")},e.prototype._updateResizeObserver=function(n){var r,i=this.props,a=i.target,o=Wo(this.getControlBoxElement());if(!o.ResizeObserver||!a||!i.useResizeObserver){(r=this._reiszeObserver)===null||r===void 0||r.disconnect();return}if(!(n.target===a&&this._reiszeObserver)){var c=new o.ResizeObserver(this.checkUpdateRect);c.observe(a,{box:"border-box"}),this._reiszeObserver=c}},e.prototype._updateMutationObserver=function(n){var r=this,i,a=this.props,o=a.target,c=Wo(this.getControlBoxElement());if(!c.MutationObserver||!o||!a.useMutationObserver){(i=this._mutationObserver)===null||i===void 0||i.disconnect();return}if(!(n.target===o&&this._mutationObserver)){var u=new c.MutationObserver(function(d){var h,p;try{for(var m=SG(d),y=m.next();!y.done;y=m.next()){var _=y.value;_.type==="attributes"&&_.attributeName==="style"&&r.checkUpdateRect()}}catch(w){h={error:w}}finally{try{y&&!y.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}});u.observe(o,{attributes:!0}),this._mutationObserver=u}},e.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:oO,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},e})(rP),wS={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(t,e){var n,r=t.props,i=r.targets||[],a=t.getState(),o=a.left,c=a.top,u=a.isPersisted,d=r.zoom||1,h=t.renderGroupRects,p=((n=r.persistData)===null||n===void 0?void 0:n.children)||[];u?i=p.map(function(){return null}):p=[];var m=Xu(t,"parentPosition",[o,c],function(_){return _.join(",")}),y=Xu(t,"requestStyles",t.getRequestChildStyles(),function(_){return _.join(",")});return t.moveables=t.moveables.slice(0,i.length),Ce(Ce([],J(i.map(function(_,w){return e.createElement(hd,{key:"moveable"+w,ref:FM(t,"moveables",w),target:_,origin:!1,requestStyles:y,cssStyled:r.cssStyled,customStyledMap:r.customStyledMap,useResizeObserver:r.useResizeObserver,useMutationObserver:r.useMutationObserver,hideChildMoveableDefaultLines:r.hideChildMoveableDefaultLines,parentMoveable:t,parentPosition:[o,c],persistData:p[w],zoom:d})})),!1),J(yO(h.map(function(_,w){var E=_.pos1,T=_.pos2,I=_.pos3,D=_.pos4,O=[E,T,I,D];return[[0,1],[1,3],[3,2],[2,0]].map(function(z,P){var A=J(z,2),C=A[0],k=A[1];return Yh(e,"",qe(O[C],m),qe(O[k],m),d,"group-rect-".concat(w,"-").concat(P))})}))),!1)}},GH=Dp("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(t,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(t,e){var n=t.props.target,r=e.inputEvent,i=e.inputTarget,a=t.isMoveableElement(i),o=!a&&t.controlBox.contains(i);if(!(!r||!i||e.isDrag||t.isMoveableElement(i)||o)){var c=n.contains(i);Ne(t,"onClick",lt(t,e,{isDouble:e.isDouble,inputTarget:i,isTarget:n===i,moveableTarget:t.props.target,containsTarget:c}))}},dragGroupEnd:function(t,e){var n=e.inputEvent,r=e.inputTarget;if(!(!n||!r||e.isDrag||t.isMoveableElement(r)||e.datas.inputTarget===r)){var i=t.props.targets,a=i.indexOf(r),o=a>-1,c=!1;a===-1&&(a=Fs(i,function(u){return u.contains(r)}),c=a>-1),Ne(t,"onClickGroup",lt(t,e,{isDouble:e.isDouble,targets:i,inputTarget:r,targetIndex:a,isTarget:o,containsTarget:c,moveableTarget:i[a]}))}},dragControlEnd:function(t,e){this.dragEnd(t,e)},dragGroupControlEnd:function(t,e){this.dragEnd(t,e)}});function Tu(t){var e=t.originalDatas.draggable;return e||(t.originalDatas.draggable={},e=t.originalDatas.draggable),Z(Z({},t),{datas:e})}var qH=Dp("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(t,e){var n=t.props,r=n.edgeDraggable;return r?FP(e,"edgeDraggable",r,t.getState().renderPoses,n.zoom):[]},dragCondition:function(t,e){var n,r=t.props,i=(n=e.inputEvent)===null||n===void 0?void 0:n.target;return!r.edgeDraggable||!i?!1:!r.draggable&&Qn(i,Be("direction"))&&Qn(i,Be("edge"))&&Qn(i,Be("edgeDraggable"))},dragStart:function(t,e){return Or.dragStart(t,Tu(e))},drag:function(t,e){return Or.drag(t,Tu(e))},dragEnd:function(t,e){return Or.dragEnd(t,Tu(e))},dragGroupCondition:function(t,e){var n,r=t.props,i=(n=e.inputEvent)===null||n===void 0?void 0:n.target;return!r.edgeDraggable||!i?!1:!r.draggable&&Qn(i,Be("direction"))&&Qn(i,Be("line"))},dragGroupStart:function(t,e){return Or.dragGroupStart(t,Tu(e))},dragGroup:function(t,e){return Or.dragGroup(t,Tu(e))},dragGroupEnd:function(t,e){return Or.dragGroupEnd(t,Tu(e))},unset:function(t){return Or.unset(t)}}),PO={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},SS=[DO,TO,Kq,hH,Or,qH,a_,pH,mH,Rq,_H,wH,bH,PH,MH,zH,wS,PO,GH,EO,RO],HH=SS.reduce(function(t,e){return(e.events||[]).forEach(function(n){KM(t,n)}),t},[]),$H=SS.reduce(function(t,e){return(e.props||[]).forEach(function(n){KM(t,n)}),t},[]);function AD(t,e){var n=J(t,3),r=n[0],i=n[1],a=n[2];return(r*e[0]+i*e[1]+a)/Math.sqrt(r*r+i*i)}function jm(t,e){var n=J(t,2),r=n[0],i=n[1];return-r*e[0]-i*e[1]}function CD(t,e){return Math.max.apply(Math,Ce([],J(t.map(function(n){var r=J(n,4),i=r[0],a=r[1],o=r[2],c=r[3];return Math.max(i[e],a[e],o[e],c[e])})),!1))}function ID(t,e){return Math.min.apply(Math,Ce([],J(t.map(function(n){var r=J(n,4),i=r[0],a=r[1],o=r[2],c=r[3];return Math.min(i[e],a[e],o[e],c[e])})),!1))}function YH(t,e){var n,r,i,a=[0,0],o=[0,0],c=[0,0],u=[0,0],d=0,h=0;if(!t.length)return{pos1:a,pos2:o,pos3:c,pos4:u,minX:0,minY:0,maxX:0,maxY:0,width:d,height:h,rotation:e};var p=rt(e,Ur);if(p%90){var m=p/180*Math.PI,y=Math.tan(m),_=-1/y,w=[t_,Q2],E=[[0,0],[0,0]],T=[t_,Q2],I=[[0,0],[0,0]];t.forEach(function(Y){Y.forEach(function(ne){var pe=AD([-y,1,0],ne),de=AD([-_,1,0],ne);w[0]>pe&&(E[0]=ne,w[0]=pe),w[1]<pe&&(E[1]=ne,w[1]=pe),T[0]>de&&(I[0]=ne,T[0]=de),T[1]<de&&(I[1]=ne,T[1]=de)})});var D=J(E,2),O=D[0],z=D[1],P=J(I,2),A=P[0],C=P[1],k=[-y,1,jm([-y,1],O)],V=[-y,1,jm([-y,1],z)],B=[-_,1,jm([-_,1],A)],j=[-_,1,jm([-_,1],C)];n=J([[k,B],[k,j],[V,B],[V,j]].map(function(Y){var ne=J(Y,2),pe=ne[0],de=ne[1];return eS(pe,de)[0]}),4),a=n[0],o=n[1],c=n[2],u=n[3],d=T[1]-T[0],h=w[1]-w[0]}else{var N=ID(t,0),K=ID(t,1),W=CD(t,0),$=CD(t,1);if(a=[N,K],o=[W,K],c=[N,$],u=[W,$],d=W-N,h=$-K,p%180){var H=[c,a,u,o];r=J(H,4),a=r[0],o=r[1],c=r[2],u=r[3],d=$-K,h=W-N}}if(p%360>180){var H=[u,c,o,a];i=J(H,4),a=i[0],o=i[1],c=i[2],u=i[3]}var te=xc([a,o,c,u]),re=te.minX,ue=te.minY,F=te.maxX,Q=te.maxY;return{pos1:a,pos2:o,pos3:c,pos4:u,width:d,height:h,minX:re,minY:ue,maxX:F,maxY:Q,rotation:e}}function OO(t,e){var n=e.map(function(r){if(qn(r)){var i=OO(t,r),a=i.length;return a>1?i:a===1?i[0]:null}else{var o=ai(t,function(c){var u=c.manager;return u.props.target===r});return o?(o.finded=!0,o.manager):null}}).filter(Boolean);return n.length===1&&qn(n[0])?n[0]:n}var KH=(function(t){Ip(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.differ=new _P,n.moveables=[],n.transformOrigin="50% 50%",n.renderGroupRects=[],n._targetGroups=[],n._hasFirstTargets=!1,n}return e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this)},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(n,r,i){var a;i===void 0&&(i=!0);var o=this.state;if(!this.controlBox||o.isPersisted)return;ud(!0),this.moveables.forEach(function(we){we.updateRect(n,!1,!1)});var c=this.props,u=this.moveables,d=o.target||c.target,h=u.map(function(we){return{finded:!1,manager:we}}),p=this.props.targetGroups||[],m=OO(h,p),y=c.useDefaultGroupRotate;m.push.apply(m,Ce([],J(h.filter(function(we){var Te=we.finded;return!Te}).map(function(we){var Te=we.manager;return Te})),!1));var _=[],w=!r||n!==""&&c.updateGroup,E=c.defaultGroupRotate||0;if(!this._hasFirstTargets){var T=(a=c.persistData)===null||a===void 0?void 0:a.rotation;T!=null&&(E=T)}function I(we,Te,Xe){var Se=we.map(function(_t){if(qn(_t)){var Pe=I(_t,Te),Ue=[Pe.pos1,Pe.pos2,Pe.pos3,Pe.pos4];return _.push(Pe),{poses:Ue,rotation:Pe.rotation}}else return{poses:Qi(_t.state),rotation:_t.getRotation()}}),Ie=Se.map(function(_t){var Pe=_t.rotation;return Pe}),Je=0,Me=Ie[0],$e=Ie.every(function(_t){return Math.abs(Me-_t)<.1});w?Je=!y&&$e?Me:E:Je=!y&&!Xe&&$e?Me:Te;var We=Se.map(function(_t){var Pe=_t.poses;return Pe}),pt=YH(We,Je);return pt}var D=I(m,this.rotation,!0);w&&(this.rotation=D.rotation,this.transformOrigin=c.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=p,this.renderGroupRects=_;var O=this.transformOrigin,z=this.rotation,P=this.scale,A=D.width,C=D.height,k=D.minX,V=D.minY,B=fH([[0,0],[A,0],[0,C],[A,C]],yS(O,A,C),this.rotation/180*Math.PI),j=xc(B.result),N=j.minX,K=j.minY,W=" rotate(".concat(z,"deg)")+" scale(".concat(Vr(P[0]),", ").concat(Vr(P[1]),")"),$="translate(".concat(-N,"px, ").concat(-K,"px)").concat(W);this.controlBox.style.transform="translate3d(".concat(k,"px, ").concat(V,"px, ").concat(this.props.translateZ||0,")"),d.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(O,";")+"width:".concat(A,"px;height:").concat(C,"px;")+"transform: ".concat($),o.width=A,o.height=C;var H=this.getContainer(),te=f_(this.controlBox,d,this.controlBox,this.getContainer(),this._rootContainer||H,[]),re=[te.left,te.top],ue=J(Qi(te),4),F=ue[0],Q=ue[1],Y=ue[2],ne=ue[3],pe=xc([F,Q,Y,ne]),de=[pe.minX,pe.minY],ge=Vr(P[0]*P[1]);te.pos1=qe(F,de),te.pos2=qe(Q,de),te.pos3=qe(Y,de),te.pos4=qe(ne,de),te.left=k-te.left+de[0],te.top=V-te.top+de[1],te.origin=qe(Tt(re,te.origin),de),te.beforeOrigin=qe(Tt(re,te.beforeOrigin),de),te.originalBeforeOrigin=Tt(re,te.originalBeforeOrigin),te.transformOrigin=qe(Tt(re,te.transformOrigin),de),d.style.transform="translate(".concat(-N-de[0],"px, ").concat(-K-de[1],"px)")+W,ud(),this.updateState(Z(Z({},te),{posDelta:de,direction:ge,beforeDirection:ge}),i)},e.prototype.getRect=function(){return Z(Z({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(n){return n.getRect()})})},e.prototype.triggerEvent=function(n,r,i){if(i||n.indexOf("Group")>-1)return t.prototype.triggerEvent.call(this,n,r);this._emitter.trigger(n,r)},e.prototype.getRequestChildStyles=function(){var n=this.getEnabledAbles().reduce(function(r,i){var a,o,c=(o=(a=i.requestChildStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return Ce(Ce([],J(r),!1),J(c),!1)},[]);return n},e.prototype.getMoveables=function(){return Ce([],J(this.moveables),!1)},e.prototype.updateAbles=function(){t.prototype.updateAbles.call(this,Ce(Ce([],J(this.props.ables),!1),[wS],!1),"Group")},e.prototype._updateTargets=function(){t.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=$a(this._originalDragTarget,!0)},e.prototype._updateEvents=function(){var n=this.state,r=this.props,i=this._prevDragTarget,a=r.dragTarget||this.areaElement,o=r.targets,c=this.differ.update(o),u=c.added,d=c.changed,h=c.removed,p=u.length||h.length;(p||this._prevOriginalDragTarget!==this._originalDragTarget)&&(Ku(this,!1),Ku(this,!0),this.updateState({gestos:{}})),i!==a&&(n.target=null),n.target||(n.target=this.areaElement,this.controlBox.style.display="block"),n.target&&(this.targetGesto||(this.targetGesto=kO(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=NO(this,"GroupControl")));var m=!u_(n.container,r.container);m&&(n.container=r.container),(m||p||this.transformOrigin!==(r.defaultGroupOrigin||"50% 50%")||d.length||o.length&&!_O(this._targetGroups,r.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!p},e.prototype._updateObserver=function(){},e.defaultProps=Z(Z({},hd.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e})(hd),XH=(function(t){Ip(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.moveables=[],n}return e.prototype.render=function(){var n=this,r,i=this.props,a=i.cspNonce,o=i.cssStyled,c=i.persistData,u=i.targets||[],d=u.length,h=this.isUnmounted||!d,p=(r=c?.children)!==null&&r!==void 0?r:[];return h&&!d&&p.length?u=p.map(function(){return null}):h||(p=[]),pa(o,{cspNonce:a,ref:Ps(this,"controlBox"),className:Be("control-box")},u.map(function(m,y){var _,w,E=(w=(_=i.individualGroupableProps)===null||_===void 0?void 0:_.call(i,m,y))!==null&&w!==void 0?w:{};return pa(hd,Z({key:"moveable"+y,ref:FM(n,"moveables",y)},i,E,{target:m,wrapperMoveable:n,isWrapperMounted:n.isMoveableMounted,persistData:p[y]}))}))},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(n,r,i){i===void 0&&(i=!0),ud(!0),this.moveables.forEach(function(a){a.updateRect(n,r,i)}),ud()},e.prototype.getRect=function(){return Z(Z({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(n){return n.getRect()})})},e.prototype.request=function(n,r,i){r===void 0&&(r={});var a=this.moveables.map(function(u){return u.request(n,Z(Z({},r),{isInstant:!1}),!1)}),o=i||r.isInstant,c={request:function(u){return a.forEach(function(d){return d.request(u)}),this},requestEnd:function(){return a.forEach(function(u){return u.requestEnd()}),this}};return o?c.request(r).requestEnd():c},e.prototype.dragStart=function(n,r){r===void 0&&(r=n.target);var i=r,a=ai(this.moveables,function(o){var c=o.getTargets()[0],u=o.getControlBoxElement(),d=o.getDragElement();return!c||!d?!1:d===i||d.contains(i)||d!==c&&c===i||c.contains(i)||u===i||u.contains(i)});return a&&a.dragStart(n,r),this},e.prototype.hitTest=function(){return 0},e.prototype.isInside=function(){return!1},e.prototype.isDragging=function(){return!1},e.prototype.getDragElement=function(){return null},e.prototype.getMoveables=function(){return Ce([],J(this.moveables),!1)},e.prototype.updateRenderPoses=function(){},e.prototype.checkUpdate=function(){},e.prototype.triggerEvent=function(){},e.prototype.updateAbles=function(){},e.prototype._updateEvents=function(){},e.prototype._updateObserver=function(){},e})(hd);function VO(t,e){var n=[];return t.forEach(function(r){if(r){if(ii(r)){e[r]&&n.push.apply(n,Ce([],J(e[r]),!1));return}qn(r)?n.push.apply(n,Ce([],J(VO(r,e)),!1)):n.push(r)}}),n}function jO(t,e){var n=[];return t.forEach(function(r){if(r){if(ii(r)){e[r]&&n.push.apply(n,Ce([],J(e[r]),!1));return}qn(r)?n.push(jO(r,e)):n.push(r)}}),n}function zO(t,e){return t.length!==e.length||t.some(function(n,r){var i=e[r];return!n&&!i?!1:n!=i?qn(n)&&qn(i)?zO(n,i):!0:!1})}var WH=(function(t){Ip(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.refTargets=[],n.selectorMap={},n._differ=new _P,n._elementTargets=[],n._tmpRefTargets=[],n._tmpSelectorMap={},n._onChangeTargets=null,n}return e.makeStyled=function(){var n={},r=this.getTotalAbles();r.forEach(function(a){var o=a.css;o&&o.forEach(function(c){n[c]=!0})});var i=Us(n).join(`
`);this.defaultStyled=TP("div",HU(nS,PG+i))},e.getTotalAbles=function(){return Ce([TO,wS,PO,EO],J(this.defaultAbles),!1)},e.prototype.render=function(){var n,r=this.constructor;r.defaultStyled||r.makeStyled();var i=this.props,a=i.ables,o=i.props,c=_G(i,["ables","props"]),u=J(this._updateRefs(!0),2),d=u[0],h=u[1],p=VO(d,h),m=p.length>1,y=r.getTotalAbles(),_=Ce(Ce([],J(y),!1),J(a||[]),!1),w=Z(Z(Z({},c),o||{}),{ables:_,cssStyled:r.defaultStyled,customStyledMap:r.customStyledMap});this._elementTargets=p;var E=null,T=this.moveable,I=c.persistData;if(I?.children&&(m=!0),c.individualGroupable)return pa(XH,Z({key:"individual-group",ref:Ps(this,"moveable")},w,{target:null,targets:p}));if(m){var D=jO(d,h);if(T&&!T.props.groupable&&!T.props.individualGroupable){var O=T.props.target;O&&p.indexOf(O)>-1&&(E=Z({},T.state))}return pa(KH,Z({key:"group",ref:Ps(this,"moveable")},w,(n=c.groupableProps)!==null&&n!==void 0?n:{},{target:null,targets:p,targetGroups:D,firstRenderState:E}))}else{var z=p[0];if(T&&(T.props.groupable||T.props.individualGroupable)){var P=T.moveables||[],A=ai(P,function(C){return C.props.target===z});A&&(E=Z({},A.state))}return pa(hd,Z({key:"single",ref:Ps(this,"moveable")},w,{target:z,firstRenderState:E}))}},e.prototype.componentDidMount=function(){this._checkChangeTargets()},e.prototype.componentDidUpdate=function(){this._checkChangeTargets()},e.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},e.prototype.getTargets=function(){var n,r;return(r=(n=this.moveable)===null||n===void 0?void 0:n.getTargets())!==null&&r!==void 0?r:[]},e.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs(),this.forceUpdate()},e.prototype.waitToChangeTarget=function(){var n=this,r;return this._onChangeTargets=function(){n._onChangeTargets=null,r()},new Promise(function(i){r=i})},e.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},e.prototype.getManager=function(){return this.moveable},e.prototype.getMoveables=function(){return this.moveable.getMoveables()},e.prototype.getDragElement=function(){return this.moveable.getDragElement()},e.prototype._updateRefs=function(n){var r=this.refTargets,i=vS(this.props.target||this.props.targets),a=typeof document<"u",o=zO(r,i),c=this.selectorMap,u={};return this.refTargets.forEach(function d(h){if(ii(h)){var p=c[h];p?u[h]=c[h]:a&&(o=!0,u[h]=[].slice.call(document.querySelectorAll(h)))}else qn(h)&&h.forEach(d)}),this._tmpRefTargets=i,this._tmpSelectorMap=u,[i,u,!n&&o]},e.prototype._checkChangeTargets=function(){var n,r,i;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var a=this._differ.update(this._elementTargets),o=a.added,c=a.removed,u=o.length||c.length;u&&((r=(n=this.props).onChangeTargets)===null||r===void 0||r.call(n,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this));var d=J(this._updateRefs(),3),h=d[0],p=d[1],m=d[2];this.refTargets=h,this.selectorMap=p,m&&this.forceUpdate()},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,wG([$U(kP)],e.prototype,"moveable",void 0),e})(rP),QH=(function(t){Ip(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.defaultAbles=SS,e})(WH),h_=function(t,e){return h_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},h_(t,e)};function ES(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");h_(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Xh=function(){return Xh=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Xh.apply(this,arguments)};function ZH(t,e,n,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}var JH=(function(t){ES(e,t);function e(r){var i=t.call(this,r)||this;return i.state={},i.state=i.props,i}var n=e.prototype;return n.render=function(){return pa(QH,Xh({ref:Ps(this,"moveable")},this.state))},e})(Kw),e$=$H,t$=kP,n$=HH,r$=(function(t){ES(e,t);function e(r,i){i===void 0&&(i={});var a=t.call(this)||this;a.containerProvider=null,a.selfElement=null,a._warp=!1;var o=Xh({},i),c={};n$.forEach(function(h){c[n7("on ".concat(h))]=function(p){return a.trigger(h,p)}});var u;i.warpSelf?(delete i.warpSelf,a._warp=!0,u=r):(u=Vd(r).createElement("div"),r.appendChild(u)),a.containerProvider=H2(pa(JH,Xh({ref:Ps(a,"innerMoveable")},o,c)),u),a.selfElement=u;var d=o.target;return qn(d)&&d.length>1&&a.updateRect(),a}var n=e.prototype;return n.setState=function(r,i){this.innerMoveable.setState(r,i)},n.forceUpdate=function(r){this.innerMoveable.forceUpdate(r)},n.dragStart=function(r,i){i===void 0&&(i=r.target);var a=this.innerMoveable;a.$_timer&&this.forceUpdate(),this.getMoveable().dragStart(r,i)},n.destroy=function(){var r,i=this.selfElement;H2(null,i,this.containerProvider),this._warp||(r=i?.parentElement)===null||r===void 0||r.removeChild(i),this.containerProvider=null,this.off(),this.selfElement=null,this.innerMoveable=null},n.getMoveable=function(){return this.innerMoveable.moveable},e=ZH([V2(t$,function(r,i){r[i]||(r[i]=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];var c=this.getMoveable();if(!(!c||!c[i]))return c[i].apply(c,a)})}),V2(e$,function(r,i){Object.defineProperty(r,i,{get:function(){return this.getMoveable().props[i]},set:function(a){var o;this.setState((o={},o[i]=a,o))},enumerable:!0,configurable:!0})})],e),e})(Av),i$=(function(t){ES(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(r$);const DD=t=>{let e;const n=new Set,r=(d,h)=>{const p=typeof d=="function"?d(e):d;if(!Object.is(p,e)){const m=e;e=h??(typeof p!="object"||p===null)?p:Object.assign({},e,p),n.forEach(y=>y(e,m))}},i=()=>e,c={setState:r,getState:i,getInitialState:()=>u,subscribe:d=>(n.add(d),()=>n.delete(d))},u=e=t(r,i,c);return c},a$=(t=>t?DD(t):DD),s$=t=>t;function o$(t,e=s$){const n=vm.useSyncExternalStore(t.subscribe,vm.useCallback(()=>e(t.getState()),[t,e]),vm.useCallback(()=>e(t.getInitialState()),[t,e]));return vm.useDebugValue(n),n}const RD=t=>{const e=a$(t),n=r=>o$(e,r);return Object.assign(n,e),n},Vv=(t=>t?RD(t):RD);function l$(t,e){let n;try{n=t()}catch{return}return{getItem:i=>{var a;const o=u=>u===null?null:JSON.parse(u,void 0),c=(a=n.getItem(i))!=null?a:null;return c instanceof Promise?c.then(o):o(c)},setItem:(i,a)=>n.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>n.removeItem(i)}}const p_=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return p_(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return p_(r)(n)}}}},c$=(t,e)=>(n,r,i)=>{let a={storage:l$(()=>localStorage),partialize:w=>w,version:0,merge:(w,E)=>({...E,...w}),...e},o=!1;const c=new Set,u=new Set;let d=a.storage;if(!d)return t((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),n(...w)},r,i);const h=()=>{const w=a.partialize({...r()});return d.setItem(a.name,{state:w,version:a.version})},p=i.setState;i.setState=(w,E)=>(p(w,E),h());const m=t((...w)=>(n(...w),h()),r,i);i.getInitialState=()=>m;let y;const _=()=>{var w,E;if(!d)return;o=!1,c.forEach(I=>{var D;return I((D=r())!=null?D:m)});const T=((E=a.onRehydrateStorage)==null?void 0:E.call(a,(w=r())!=null?w:m))||void 0;return p_(d.getItem.bind(d))(a.name).then(I=>{if(I)if(typeof I.version=="number"&&I.version!==a.version){if(a.migrate){const D=a.migrate(I.state,I.version);return D instanceof Promise?D.then(O=>[!0,O]):[!0,D]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,I.state];return[!1,void 0]}).then(I=>{var D;const[O,z]=I;if(y=a.merge(z,(D=r())!=null?D:m),n(y,!0),O)return h()}).then(()=>{T?.(y,void 0),y=r(),o=!0,u.forEach(I=>I(y))}).catch(I=>{T?.(void 0,I)})};return i.persist={setOptions:w=>{a={...a,...w},w.storage&&(d=w.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:w=>(c.add(w),()=>{c.delete(w)}),onFinishHydration:w=>(u.add(w),()=>{u.delete(w)})},a.skipHydration||_(),y||m},TS=c$;var Wu=9e15,ml=1e9,g_="0123456789abcdef",L0="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",B0="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",m_={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Wu,maxE:Wu,crypto:!1},LO,Ds,tt=!0,jv="[DecimalError] ",ll=jv+"Invalid argument: ",BO=jv+"Precision limit exceeded",FO=jv+"crypto unavailable",UO="[object Decimal]",kr=Math.floor,Wn=Math.pow,u$=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,d$=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,f$=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,GO=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ma=1e7,Ke=7,h$=9007199254740991,p$=L0.length-1,v_=B0.length-1,_e={toStringTag:UO};_e.absoluteValue=_e.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),Fe(t)};_e.ceil=function(){return Fe(new this.constructor(this),this.e+1,2)};_e.clampedTo=_e.clamp=function(t,e){var n,r=this,i=r.constructor;if(t=new i(t),e=new i(e),!t.s||!e.s)return new i(NaN);if(t.gt(e))throw Error(ll+e);return n=r.cmp(t),n<0?t:r.cmp(e)>0?e:new i(r)};_e.comparedTo=_e.cmp=function(t){var e,n,r,i,a=this,o=a.d,c=(t=new a.constructor(t)).d,u=a.s,d=t.s;if(!o||!c)return!u||!d?NaN:u!==d?u:o===c?0:!o^u<0?1:-1;if(!o[0]||!c[0])return o[0]?u:c[0]?-d:0;if(u!==d)return u;if(a.e!==t.e)return a.e>t.e^u<0?1:-1;for(r=o.length,i=c.length,e=0,n=r<i?r:i;e<n;++e)if(o[e]!==c[e])return o[e]>c[e]^u<0?1:-1;return r===i?0:r>i^u<0?1:-1};_e.cosine=_e.cos=function(){var t,e,n=this,r=n.constructor;return n.d?n.d[0]?(t=r.precision,e=r.rounding,r.precision=t+Math.max(n.e,n.sd())+Ke,r.rounding=1,n=g$(r,KO(r,n)),r.precision=t,r.rounding=e,Fe(Ds==2||Ds==3?n.neg():n,t,e,!0)):new r(1):new r(NaN)};_e.cubeRoot=_e.cbrt=function(){var t,e,n,r,i,a,o,c,u,d,h=this,p=h.constructor;if(!h.isFinite()||h.isZero())return new p(h);for(tt=!1,a=h.s*Wn(h.s*h,1/3),!a||Math.abs(a)==1/0?(n=br(h.d),t=h.e,(a=(t-n.length+1)%3)&&(n+=a==1||a==-2?"0":"00"),a=Wn(n,1/3),t=kr((t+1)/3)-(t%3==(t<0?-1:2)),a==1/0?n="5e"+t:(n=a.toExponential(),n=n.slice(0,n.indexOf("e")+1)+t),r=new p(n),r.s=h.s):r=new p(a.toString()),o=(t=p.precision)+3;;)if(c=r,u=c.times(c).times(c),d=u.plus(h),r=Xt(d.plus(h).times(c),d.plus(u),o+2,1),br(c.d).slice(0,o)===(n=br(r.d)).slice(0,o))if(n=n.slice(o-3,o+1),n=="9999"||!i&&n=="4999"){if(!i&&(Fe(c,t+1,0),c.times(c).times(c).eq(h))){r=c;break}o+=4,i=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&(Fe(r,t+1,1),e=!r.times(r).times(r).eq(h));break}return tt=!0,Fe(r,t,p.rounding,e)};_e.decimalPlaces=_e.dp=function(){var t,e=this.d,n=NaN;if(e){if(t=e.length-1,n=(t-kr(this.e/Ke))*Ke,t=e[t],t)for(;t%10==0;t/=10)n--;n<0&&(n=0)}return n};_e.dividedBy=_e.div=function(t){return Xt(this,new this.constructor(t))};_e.dividedToIntegerBy=_e.divToInt=function(t){var e=this,n=e.constructor;return Fe(Xt(e,new n(t),0,1,1),n.precision,n.rounding)};_e.equals=_e.eq=function(t){return this.cmp(t)===0};_e.floor=function(){return Fe(new this.constructor(this),this.e+1,3)};_e.greaterThan=_e.gt=function(t){return this.cmp(t)>0};_e.greaterThanOrEqualTo=_e.gte=function(t){var e=this.cmp(t);return e==1||e===0};_e.hyperbolicCosine=_e.cosh=function(){var t,e,n,r,i,a=this,o=a.constructor,c=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return c;n=o.precision,r=o.rounding,o.precision=n+Math.max(a.e,a.sd())+4,o.rounding=1,i=a.d.length,i<32?(t=Math.ceil(i/3),e=(1/Lv(4,t)).toString()):(t=16,e="2.3283064365386962890625e-10"),a=pd(o,1,a.times(e),new o(1),!0);for(var u,d=t,h=new o(8);d--;)u=a.times(a),a=c.minus(u.times(h.minus(u.times(h))));return Fe(a,o.precision=n,o.rounding=r,!0)};_e.hyperbolicSine=_e.sinh=function(){var t,e,n,r,i=this,a=i.constructor;if(!i.isFinite()||i.isZero())return new a(i);if(e=a.precision,n=a.rounding,a.precision=e+Math.max(i.e,i.sd())+4,a.rounding=1,r=i.d.length,r<3)i=pd(a,2,i,i,!0);else{t=1.4*Math.sqrt(r),t=t>16?16:t|0,i=i.times(1/Lv(5,t)),i=pd(a,2,i,i,!0);for(var o,c=new a(5),u=new a(16),d=new a(20);t--;)o=i.times(i),i=i.times(c.plus(o.times(u.times(o).plus(d))))}return a.precision=e,a.rounding=n,Fe(i,e,n,!0)};_e.hyperbolicTangent=_e.tanh=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+7,r.rounding=1,Xt(n.sinh(),n.cosh(),r.precision=t,r.rounding=e)):new r(n.s)};_e.inverseCosine=_e.acos=function(){var t=this,e=t.constructor,n=t.abs().cmp(1),r=e.precision,i=e.rounding;return n!==-1?n===0?t.isNeg()?Fa(e,r,i):new e(0):new e(NaN):t.isZero()?Fa(e,r+4,i).times(.5):(e.precision=r+6,e.rounding=1,t=new e(1).minus(t).div(t.plus(1)).sqrt().atan(),e.precision=r,e.rounding=i,t.times(2))};_e.inverseHyperbolicCosine=_e.acosh=function(){var t,e,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(t=r.precision,e=r.rounding,r.precision=t+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,tt=!1,n=n.times(n).minus(1).sqrt().plus(n),tt=!0,r.precision=t,r.rounding=e,n.ln()):new r(n)};_e.inverseHyperbolicSine=_e.asinh=function(){var t,e,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,tt=!1,n=n.times(n).plus(1).sqrt().plus(n),tt=!0,r.precision=t,r.rounding=e,n.ln())};_e.inverseHyperbolicTangent=_e.atanh=function(){var t,e,n,r,i=this,a=i.constructor;return i.isFinite()?i.e>=0?new a(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(t=a.precision,e=a.rounding,r=i.sd(),Math.max(r,t)<2*-i.e-1?Fe(new a(i),t,e,!0):(a.precision=n=r-i.e,i=Xt(i.plus(1),new a(1).minus(i),n+t,1),a.precision=t+4,a.rounding=1,i=i.ln(),a.precision=t,a.rounding=e,i.times(.5))):new a(NaN)};_e.inverseSine=_e.asin=function(){var t,e,n,r,i=this,a=i.constructor;return i.isZero()?new a(i):(e=i.abs().cmp(1),n=a.precision,r=a.rounding,e!==-1?e===0?(t=Fa(a,n+4,r).times(.5),t.s=i.s,t):new a(NaN):(a.precision=n+6,a.rounding=1,i=i.div(new a(1).minus(i.times(i)).sqrt().plus(1)).atan(),a.precision=n,a.rounding=r,i.times(2)))};_e.inverseTangent=_e.atan=function(){var t,e,n,r,i,a,o,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding;if(d.isFinite()){if(d.isZero())return new h(d);if(d.abs().eq(1)&&p+4<=v_)return o=Fa(h,p+4,m).times(.25),o.s=d.s,o}else{if(!d.s)return new h(NaN);if(p+4<=v_)return o=Fa(h,p+4,m).times(.5),o.s=d.s,o}for(h.precision=c=p+10,h.rounding=1,n=Math.min(28,c/Ke+2|0),t=n;t;--t)d=d.div(d.times(d).plus(1).sqrt().plus(1));for(tt=!1,e=Math.ceil(c/Ke),r=1,u=d.times(d),o=new h(d),i=d;t!==-1;)if(i=i.times(u),a=o.minus(i.div(r+=2)),i=i.times(u),o=a.plus(i.div(r+=2)),o.d[e]!==void 0)for(t=e;o.d[t]===a.d[t]&&t--;);return n&&(o=o.times(2<<n-1)),tt=!0,Fe(o,h.precision=p,h.rounding=m,!0)};_e.isFinite=function(){return!!this.d};_e.isInteger=_e.isInt=function(){return!!this.d&&kr(this.e/Ke)>this.d.length-2};_e.isNaN=function(){return!this.s};_e.isNegative=_e.isNeg=function(){return this.s<0};_e.isPositive=_e.isPos=function(){return this.s>0};_e.isZero=function(){return!!this.d&&this.d[0]===0};_e.lessThan=_e.lt=function(t){return this.cmp(t)<0};_e.lessThanOrEqualTo=_e.lte=function(t){return this.cmp(t)<1};_e.logarithm=_e.log=function(t){var e,n,r,i,a,o,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding,y=5;if(t==null)t=new h(10),e=!0;else{if(t=new h(t),n=t.d,t.s<0||!n||!n[0]||t.eq(1))return new h(NaN);e=t.eq(10)}if(n=d.d,d.s<0||!n||!n[0]||d.eq(1))return new h(n&&!n[0]?-1/0:d.s!=1?NaN:n?0:1/0);if(e)if(n.length>1)a=!0;else{for(i=n[0];i%10===0;)i/=10;a=i!==1}if(tt=!1,c=p+y,o=Ko(d,c),r=e?F0(h,c+10):Ko(t,c),u=Xt(o,r,c,1),Wh(u.d,i=p,m))do if(c+=10,o=Ko(d,c),r=e?F0(h,c+10):Ko(t,c),u=Xt(o,r,c,1),!a){+br(u.d).slice(i+1,i+15)+1==1e14&&(u=Fe(u,p+1,0));break}while(Wh(u.d,i+=10,m));return tt=!0,Fe(u,p,m)};_e.minus=_e.sub=function(t){var e,n,r,i,a,o,c,u,d,h,p,m,y=this,_=y.constructor;if(t=new _(t),!y.d||!t.d)return!y.s||!t.s?t=new _(NaN):y.d?t.s=-t.s:t=new _(t.d||y.s!==t.s?y:NaN),t;if(y.s!=t.s)return t.s=-t.s,y.plus(t);if(d=y.d,m=t.d,c=_.precision,u=_.rounding,!d[0]||!m[0]){if(m[0])t.s=-t.s;else if(d[0])t=new _(y);else return new _(u===3?-0:0);return tt?Fe(t,c,u):t}if(n=kr(t.e/Ke),h=kr(y.e/Ke),d=d.slice(),a=h-n,a){for(p=a<0,p?(e=d,a=-a,o=m.length):(e=m,n=h,o=d.length),r=Math.max(Math.ceil(c/Ke),o)+2,a>r&&(a=r,e.length=1),e.reverse(),r=a;r--;)e.push(0);e.reverse()}else{for(r=d.length,o=m.length,p=r<o,p&&(o=r),r=0;r<o;r++)if(d[r]!=m[r]){p=d[r]<m[r];break}a=0}for(p&&(e=d,d=m,m=e,t.s=-t.s),o=d.length,r=m.length-o;r>0;--r)d[o++]=0;for(r=m.length;r>a;){if(d[--r]<m[r]){for(i=r;i&&d[--i]===0;)d[i]=ma-1;--d[i],d[r]+=ma}d[r]-=m[r]}for(;d[--o]===0;)d.pop();for(;d[0]===0;d.shift())--n;return d[0]?(t.d=d,t.e=zv(d,n),tt?Fe(t,c,u):t):new _(u===3?-0:0)};_e.modulo=_e.mod=function(t){var e,n=this,r=n.constructor;return t=new r(t),!n.d||!t.s||t.d&&!t.d[0]?new r(NaN):!t.d||n.d&&!n.d[0]?Fe(new r(n),r.precision,r.rounding):(tt=!1,r.modulo==9?(e=Xt(n,t.abs(),0,3,1),e.s*=t.s):e=Xt(n,t,0,r.modulo,1),e=e.times(t),tt=!0,n.minus(e))};_e.naturalExponential=_e.exp=function(){return y_(this)};_e.naturalLogarithm=_e.ln=function(){return Ko(this)};_e.negated=_e.neg=function(){var t=new this.constructor(this);return t.s=-t.s,Fe(t)};_e.plus=_e.add=function(t){var e,n,r,i,a,o,c,u,d,h,p=this,m=p.constructor;if(t=new m(t),!p.d||!t.d)return!p.s||!t.s?t=new m(NaN):p.d||(t=new m(t.d||p.s===t.s?p:NaN)),t;if(p.s!=t.s)return t.s=-t.s,p.minus(t);if(d=p.d,h=t.d,c=m.precision,u=m.rounding,!d[0]||!h[0])return h[0]||(t=new m(p)),tt?Fe(t,c,u):t;if(a=kr(p.e/Ke),r=kr(t.e/Ke),d=d.slice(),i=a-r,i){for(i<0?(n=d,i=-i,o=h.length):(n=h,r=a,o=d.length),a=Math.ceil(c/Ke),o=a>o?a+1:o+1,i>o&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(o=d.length,i=h.length,o-i<0&&(i=o,n=h,h=d,d=n),e=0;i;)e=(d[--i]=d[i]+h[i]+e)/ma|0,d[i]%=ma;for(e&&(d.unshift(e),++r),o=d.length;d[--o]==0;)d.pop();return t.d=d,t.e=zv(d,r),tt?Fe(t,c,u):t};_e.precision=_e.sd=function(t){var e,n=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(ll+t);return n.d?(e=qO(n.d),t&&n.e+1>e&&(e=n.e+1)):e=NaN,e};_e.round=function(){var t=this,e=t.constructor;return Fe(new e(t),t.e+1,e.rounding)};_e.sine=_e.sin=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+Math.max(n.e,n.sd())+Ke,r.rounding=1,n=v$(r,KO(r,n)),r.precision=t,r.rounding=e,Fe(Ds>2?n.neg():n,t,e,!0)):new r(NaN)};_e.squareRoot=_e.sqrt=function(){var t,e,n,r,i,a,o=this,c=o.d,u=o.e,d=o.s,h=o.constructor;if(d!==1||!c||!c[0])return new h(!d||d<0&&(!c||c[0])?NaN:c?o:1/0);for(tt=!1,d=Math.sqrt(+o),d==0||d==1/0?(e=br(c),(e.length+u)%2==0&&(e+="0"),d=Math.sqrt(e),u=kr((u+1)/2)-(u<0||u%2),d==1/0?e="5e"+u:(e=d.toExponential(),e=e.slice(0,e.indexOf("e")+1)+u),r=new h(e)):r=new h(d.toString()),n=(u=h.precision)+3;;)if(a=r,r=a.plus(Xt(o,a,n+2,1)).times(.5),br(a.d).slice(0,n)===(e=br(r.d)).slice(0,n))if(e=e.slice(n-3,n+1),e=="9999"||!i&&e=="4999"){if(!i&&(Fe(a,u+1,0),a.times(a).eq(o))){r=a;break}n+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(Fe(r,u+1,1),t=!r.times(r).eq(o));break}return tt=!0,Fe(r,u,h.rounding,t)};_e.tangent=_e.tan=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+10,r.rounding=1,n=n.sin(),n.s=1,n=Xt(n,new r(1).minus(n.times(n)).sqrt(),t+10,0),r.precision=t,r.rounding=e,Fe(Ds==2||Ds==4?n.neg():n,t,e,!0)):new r(NaN)};_e.times=_e.mul=function(t){var e,n,r,i,a,o,c,u,d,h=this,p=h.constructor,m=h.d,y=(t=new p(t)).d;if(t.s*=h.s,!m||!m[0]||!y||!y[0])return new p(!t.s||m&&!m[0]&&!y||y&&!y[0]&&!m?NaN:!m||!y?t.s/0:t.s*0);for(n=kr(h.e/Ke)+kr(t.e/Ke),u=m.length,d=y.length,u<d&&(a=m,m=y,y=a,o=u,u=d,d=o),a=[],o=u+d,r=o;r--;)a.push(0);for(r=d;--r>=0;){for(e=0,i=u+r;i>r;)c=a[i]+y[r]*m[i-r-1]+e,a[i--]=c%ma|0,e=c/ma|0;a[i]=(a[i]+e)%ma|0}for(;!a[--o];)a.pop();return e?++n:a.shift(),t.d=a,t.e=zv(a,n),tt?Fe(t,p.precision,p.rounding):t};_e.toBinary=function(t,e){return AS(this,2,t,e)};_e.toDecimalPlaces=_e.toDP=function(t,e){var n=this,r=n.constructor;return n=new r(n),t===void 0?n:(oi(t,0,ml),e===void 0?e=r.rounding:oi(e,0,8),Fe(n,t+n.e+1,e))};_e.toExponential=function(t,e){var n,r=this,i=r.constructor;return t===void 0?n=Ja(r,!0):(oi(t,0,ml),e===void 0?e=i.rounding:oi(e,0,8),r=Fe(new i(r),t+1,e),n=Ja(r,!0,t+1)),r.isNeg()&&!r.isZero()?"-"+n:n};_e.toFixed=function(t,e){var n,r,i=this,a=i.constructor;return t===void 0?n=Ja(i):(oi(t,0,ml),e===void 0?e=a.rounding:oi(e,0,8),r=Fe(new a(i),t+i.e+1,e),n=Ja(r,!1,t+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n};_e.toFraction=function(t){var e,n,r,i,a,o,c,u,d,h,p,m,y=this,_=y.d,w=y.constructor;if(!_)return new w(y);if(d=n=new w(1),r=u=new w(0),e=new w(r),a=e.e=qO(_)-y.e-1,o=a%Ke,e.d[0]=Wn(10,o<0?Ke+o:o),t==null)t=a>0?e:d;else{if(c=new w(t),!c.isInt()||c.lt(d))throw Error(ll+c);t=c.gt(e)?a>0?e:d:c}for(tt=!1,c=new w(br(_)),h=w.precision,w.precision=a=_.length*Ke*2;p=Xt(c,e,0,1,1),i=n.plus(p.times(r)),i.cmp(t)!=1;)n=r,r=i,i=d,d=u.plus(p.times(i)),u=i,i=e,e=c.minus(p.times(i)),c=i;return i=Xt(t.minus(n),r,0,1,1),u=u.plus(i.times(d)),n=n.plus(i.times(r)),u.s=d.s=y.s,m=Xt(d,r,a,1).minus(y).abs().cmp(Xt(u,n,a,1).minus(y).abs())<1?[d,r]:[u,n],w.precision=h,tt=!0,m};_e.toHexadecimal=_e.toHex=function(t,e){return AS(this,16,t,e)};_e.toNearest=function(t,e){var n=this,r=n.constructor;if(n=new r(n),t==null){if(!n.d)return n;t=new r(1),e=r.rounding}else{if(t=new r(t),e===void 0?e=r.rounding:oi(e,0,8),!n.d)return t.s?n:t;if(!t.d)return t.s&&(t.s=n.s),t}return t.d[0]?(tt=!1,n=Xt(n,t,0,e,1).times(t),tt=!0,Fe(n)):(t.s=n.s,n=t),n};_e.toNumber=function(){return+this};_e.toOctal=function(t,e){return AS(this,8,t,e)};_e.toPower=_e.pow=function(t){var e,n,r,i,a,o,c=this,u=c.constructor,d=+(t=new u(t));if(!c.d||!t.d||!c.d[0]||!t.d[0])return new u(Wn(+c,d));if(c=new u(c),c.eq(1))return c;if(r=u.precision,a=u.rounding,t.eq(1))return Fe(c,r,a);if(e=kr(t.e/Ke),e>=t.d.length-1&&(n=d<0?-d:d)<=h$)return i=HO(u,c,n,r),t.s<0?new u(1).div(i):Fe(i,r,a);if(o=c.s,o<0){if(e<t.d.length-1)return new u(NaN);if((t.d[e]&1)==0&&(o=1),c.e==0&&c.d[0]==1&&c.d.length==1)return c.s=o,c}return n=Wn(+c,d),e=n==0||!isFinite(n)?kr(d*(Math.log("0."+br(c.d))/Math.LN10+c.e+1)):new u(n+"").e,e>u.maxE+1||e<u.minE-1?new u(e>0?o/0:0):(tt=!1,u.rounding=c.s=1,n=Math.min(12,(e+"").length),i=y_(t.times(Ko(c,r+n)),r),i.d&&(i=Fe(i,r+5,1),Wh(i.d,r,a)&&(e=r+10,i=Fe(y_(t.times(Ko(c,e+n)),e),e+5,1),+br(i.d).slice(r+1,r+15)+1==1e14&&(i=Fe(i,r+1,0)))),i.s=o,tt=!0,u.rounding=a,Fe(i,r,a))};_e.toPrecision=function(t,e){var n,r=this,i=r.constructor;return t===void 0?n=Ja(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(oi(t,1,ml),e===void 0?e=i.rounding:oi(e,0,8),r=Fe(new i(r),t,e),n=Ja(r,t<=r.e||r.e<=i.toExpNeg,t)),r.isNeg()&&!r.isZero()?"-"+n:n};_e.toSignificantDigits=_e.toSD=function(t,e){var n=this,r=n.constructor;return t===void 0?(t=r.precision,e=r.rounding):(oi(t,1,ml),e===void 0?e=r.rounding:oi(e,0,8)),Fe(new r(n),t,e)};_e.toString=function(){var t=this,e=t.constructor,n=Ja(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()&&!t.isZero()?"-"+n:n};_e.truncated=_e.trunc=function(){return Fe(new this.constructor(this),this.e+1,1)};_e.valueOf=_e.toJSON=function(){var t=this,e=t.constructor,n=Ja(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()?"-"+n:n};function br(t){var e,n,r,i=t.length-1,a="",o=t[0];if(i>0){for(a+=o,e=1;e<i;e++)r=t[e]+"",n=Ke-r.length,n&&(a+=Lo(n)),a+=r;o=t[e],r=o+"",n=Ke-r.length,n&&(a+=Lo(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}function oi(t,e,n){if(t!==~~t||t<e||t>n)throw Error(ll+t)}function Wh(t,e,n,r){var i,a,o,c;for(a=t[0];a>=10;a/=10)--e;return--e<0?(e+=Ke,i=0):(i=Math.ceil((e+1)/Ke),e%=Ke),a=Wn(10,Ke-e),c=t[i]%a|0,r==null?e<3?(e==0?c=c/100|0:e==1&&(c=c/10|0),o=n<4&&c==99999||n>3&&c==49999||c==5e4||c==0):o=(n<4&&c+1==a||n>3&&c+1==a/2)&&(t[i+1]/a/100|0)==Wn(10,e-2)-1||(c==a/2||c==0)&&(t[i+1]/a/100|0)==0:e<4?(e==0?c=c/1e3|0:e==1?c=c/100|0:e==2&&(c=c/10|0),o=(r||n<4)&&c==9999||!r&&n>3&&c==4999):o=((r||n<4)&&c+1==a||!r&&n>3&&c+1==a/2)&&(t[i+1]/a/1e3|0)==Wn(10,e-3)-1,o}function r0(t,e,n){for(var r,i=[0],a,o=0,c=t.length;o<c;){for(a=i.length;a--;)i[a]*=e;for(i[0]+=g_.indexOf(t.charAt(o++)),r=0;r<i.length;r++)i[r]>n-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/n|0,i[r]%=n)}return i.reverse()}function g$(t,e){var n,r,i;if(e.isZero())return e;r=e.d.length,r<32?(n=Math.ceil(r/3),i=(1/Lv(4,n)).toString()):(n=16,i="2.3283064365386962890625e-10"),t.precision+=n,e=pd(t,1,e.times(i),new t(1));for(var a=n;a--;){var o=e.times(e);e=o.times(o).minus(o).times(8).plus(1)}return t.precision-=n,e}var Xt=(function(){function t(r,i,a){var o,c=0,u=r.length;for(r=r.slice();u--;)o=r[u]*i+c,r[u]=o%a|0,c=o/a|0;return c&&r.unshift(c),r}function e(r,i,a,o){var c,u;if(a!=o)u=a>o?1:-1;else for(c=u=0;c<a;c++)if(r[c]!=i[c]){u=r[c]>i[c]?1:-1;break}return u}function n(r,i,a,o){for(var c=0;a--;)r[a]-=c,c=r[a]<i[a]?1:0,r[a]=c*o+r[a]-i[a];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,a,o,c,u){var d,h,p,m,y,_,w,E,T,I,D,O,z,P,A,C,k,V,B,j,N=r.constructor,K=r.s==i.s?1:-1,W=r.d,$=i.d;if(!W||!W[0]||!$||!$[0])return new N(!r.s||!i.s||(W?$&&W[0]==$[0]:!$)?NaN:W&&W[0]==0||!$?K*0:K/0);for(u?(y=1,h=r.e-i.e):(u=ma,y=Ke,h=kr(r.e/y)-kr(i.e/y)),B=$.length,k=W.length,T=new N(K),I=T.d=[],p=0;$[p]==(W[p]||0);p++);if($[p]>(W[p]||0)&&h--,a==null?(P=a=N.precision,o=N.rounding):c?P=a+(r.e-i.e)+1:P=a,P<0)I.push(1),_=!0;else{if(P=P/y+2|0,p=0,B==1){for(m=0,$=$[0],P++;(p<k||m)&&P--;p++)A=m*u+(W[p]||0),I[p]=A/$|0,m=A%$|0;_=m||p<k}else{for(m=u/($[0]+1)|0,m>1&&($=t($,m,u),W=t(W,m,u),B=$.length,k=W.length),C=B,D=W.slice(0,B),O=D.length;O<B;)D[O++]=0;j=$.slice(),j.unshift(0),V=$[0],$[1]>=u/2&&++V;do m=0,d=e($,D,B,O),d<0?(z=D[0],B!=O&&(z=z*u+(D[1]||0)),m=z/V|0,m>1?(m>=u&&(m=u-1),w=t($,m,u),E=w.length,O=D.length,d=e(w,D,E,O),d==1&&(m--,n(w,B<E?j:$,E,u))):(m==0&&(d=m=1),w=$.slice()),E=w.length,E<O&&w.unshift(0),n(D,w,O,u),d==-1&&(O=D.length,d=e($,D,B,O),d<1&&(m++,n(D,B<O?j:$,O,u))),O=D.length):d===0&&(m++,D=[0]),I[p++]=m,d&&D[0]?D[O++]=W[C]||0:(D=[W[C]],O=1);while((C++<k||D[0]!==void 0)&&P--);_=D[0]!==void 0}I[0]||I.shift()}if(y==1)T.e=h,LO=_;else{for(p=1,m=I[0];m>=10;m/=10)p++;T.e=p+h*y-1,Fe(T,c?a+T.e+1:a,o,_)}return T}})();function Fe(t,e,n,r){var i,a,o,c,u,d,h,p,m,y=t.constructor;e:if(e!=null){if(p=t.d,!p)return t;for(i=1,c=p[0];c>=10;c/=10)i++;if(a=e-i,a<0)a+=Ke,o=e,h=p[m=0],u=h/Wn(10,i-o-1)%10|0;else if(m=Math.ceil((a+1)/Ke),c=p.length,m>=c)if(r){for(;c++<=m;)p.push(0);h=u=0,i=1,a%=Ke,o=a-Ke+1}else break e;else{for(h=c=p[m],i=1;c>=10;c/=10)i++;a%=Ke,o=a-Ke+i,u=o<0?0:h/Wn(10,i-o-1)%10|0}if(r=r||e<0||p[m+1]!==void 0||(o<0?h:h%Wn(10,i-o-1)),d=n<4?(u||r)&&(n==0||n==(t.s<0?3:2)):u>5||u==5&&(n==4||r||n==6&&(a>0?o>0?h/Wn(10,i-o):0:p[m-1])%10&1||n==(t.s<0?8:7)),e<1||!p[0])return p.length=0,d?(e-=t.e+1,p[0]=Wn(10,(Ke-e%Ke)%Ke),t.e=-e||0):p[0]=t.e=0,t;if(a==0?(p.length=m,c=1,m--):(p.length=m+1,c=Wn(10,Ke-a),p[m]=o>0?(h/Wn(10,i-o)%Wn(10,o)|0)*c:0),d)for(;;)if(m==0){for(a=1,o=p[0];o>=10;o/=10)a++;for(o=p[0]+=c,c=1;o>=10;o/=10)c++;a!=c&&(t.e++,p[0]==ma&&(p[0]=1));break}else{if(p[m]+=c,p[m]!=ma)break;p[m--]=0,c=1}for(a=p.length;p[--a]===0;)p.pop()}return tt&&(t.e>y.maxE?(t.d=null,t.e=NaN):t.e<y.minE&&(t.e=0,t.d=[0])),t}function Ja(t,e,n){if(!t.isFinite())return YO(t);var r,i=t.e,a=br(t.d),o=a.length;return e?(n&&(r=n-o)>0?a=a.charAt(0)+"."+a.slice(1)+Lo(r):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(t.e<0?"e":"e+")+t.e):i<0?(a="0."+Lo(-i-1)+a,n&&(r=n-o)>0&&(a+=Lo(r))):i>=o?(a+=Lo(i+1-o),n&&(r=n-i-1)>0&&(a=a+"."+Lo(r))):((r=i+1)<o&&(a=a.slice(0,r)+"."+a.slice(r)),n&&(r=n-o)>0&&(i+1===o&&(a+="."),a+=Lo(r))),a}function zv(t,e){var n=t[0];for(e*=Ke;n>=10;n/=10)e++;return e}function F0(t,e,n){if(e>p$)throw tt=!0,n&&(t.precision=n),Error(BO);return Fe(new t(L0),e,1,!0)}function Fa(t,e,n){if(e>v_)throw Error(BO);return Fe(new t(B0),e,n,!0)}function qO(t){var e=t.length-1,n=e*Ke+1;if(e=t[e],e){for(;e%10==0;e/=10)n--;for(e=t[0];e>=10;e/=10)n++}return n}function Lo(t){for(var e="";t--;)e+="0";return e}function HO(t,e,n,r){var i,a=new t(1),o=Math.ceil(r/Ke+4);for(tt=!1;;){if(n%2&&(a=a.times(e),ND(a.d,o)&&(i=!0)),n=kr(n/2),n===0){n=a.d.length-1,i&&a.d[n]===0&&++a.d[n];break}e=e.times(e),ND(e.d,o)}return tt=!0,a}function kD(t){return t.d[t.d.length-1]&1}function $O(t,e,n){for(var r,i,a=new t(e[0]),o=0;++o<e.length;){if(i=new t(e[o]),!i.s){a=i;break}r=a.cmp(i),(r===n||r===0&&a.s===n)&&(a=i)}return a}function y_(t,e){var n,r,i,a,o,c,u,d=0,h=0,p=0,m=t.constructor,y=m.rounding,_=m.precision;if(!t.d||!t.d[0]||t.e>17)return new m(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(e==null?(tt=!1,u=_):u=e,c=new m(.03125);t.e>-2;)t=t.times(c),p+=5;for(r=Math.log(Wn(2,p))/Math.LN10*2+5|0,u+=r,n=a=o=new m(1),m.precision=u;;){if(a=Fe(a.times(t),u,1),n=n.times(++h),c=o.plus(Xt(a,n,u,1)),br(c.d).slice(0,u)===br(o.d).slice(0,u)){for(i=p;i--;)o=Fe(o.times(o),u,1);if(e==null)if(d<3&&Wh(o.d,u-r,y,d))m.precision=u+=10,n=a=c=new m(1),h=0,d++;else return Fe(o,m.precision=_,y,tt=!0);else return m.precision=_,o}o=c}}function Ko(t,e){var n,r,i,a,o,c,u,d,h,p,m,y=1,_=10,w=t,E=w.d,T=w.constructor,I=T.rounding,D=T.precision;if(w.s<0||!E||!E[0]||!w.e&&E[0]==1&&E.length==1)return new T(E&&!E[0]?-1/0:w.s!=1?NaN:E?0:w);if(e==null?(tt=!1,h=D):h=e,T.precision=h+=_,n=br(E),r=n.charAt(0),Math.abs(a=w.e)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)w=w.times(t),n=br(w.d),r=n.charAt(0),y++;a=w.e,r>1?(w=new T("0."+n),a++):w=new T(r+"."+n.slice(1))}else return d=F0(T,h+2,D).times(a+""),w=Ko(new T(r+"."+n.slice(1)),h-_).plus(d),T.precision=D,e==null?Fe(w,D,I,tt=!0):w;for(p=w,u=o=w=Xt(w.minus(1),w.plus(1),h,1),m=Fe(w.times(w),h,1),i=3;;){if(o=Fe(o.times(m),h,1),d=u.plus(Xt(o,new T(i),h,1)),br(d.d).slice(0,h)===br(u.d).slice(0,h))if(u=u.times(2),a!==0&&(u=u.plus(F0(T,h+2,D).times(a+""))),u=Xt(u,new T(y),h,1),e==null)if(Wh(u.d,h-_,I,c))T.precision=h+=_,d=o=w=Xt(p.minus(1),p.plus(1),h,1),m=Fe(w.times(w),h,1),i=c=1;else return Fe(u,T.precision=D,I,tt=!0);else return T.precision=D,u;u=d,i+=2}}function YO(t){return String(t.s*t.s/0)}function i0(t,e){var n,r,i;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),r=0;e.charCodeAt(r)===48;r++);for(i=e.length;e.charCodeAt(i-1)===48;--i);if(e=e.slice(r,i),e){if(i-=r,t.e=n=n-r-1,t.d=[],r=(n+1)%Ke,n<0&&(r+=Ke),r<i){for(r&&t.d.push(+e.slice(0,r)),i-=Ke;r<i;)t.d.push(+e.slice(r,r+=Ke));e=e.slice(r),r=Ke-e.length}else r-=i;for(;r--;)e+="0";t.d.push(+e),tt&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function m$(t,e){var n,r,i,a,o,c,u,d,h;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),GO.test(e))return i0(t,e)}else if(e==="Infinity"||e==="NaN")return+e||(t.s=NaN),t.e=NaN,t.d=null,t;if(d$.test(e))n=16,e=e.toLowerCase();else if(u$.test(e))n=2;else if(f$.test(e))n=8;else throw Error(ll+e);for(a=e.search(/p/i),a>0?(u=+e.slice(a+1),e=e.substring(2,a)):e=e.slice(2),a=e.indexOf("."),o=a>=0,r=t.constructor,o&&(e=e.replace(".",""),c=e.length,a=c-a,i=HO(r,new r(n),a,a*2)),d=r0(e,n,ma),h=d.length-1,a=h;d[a]===0;--a)d.pop();return a<0?new r(t.s*0):(t.e=zv(d,h),t.d=d,tt=!1,o&&(t=Xt(t,i,c*4)),u&&(t=t.times(Math.abs(u)<54?Wn(2,u):ti.pow(2,u))),tt=!0,t)}function v$(t,e){var n,r=e.d.length;if(r<3)return e.isZero()?e:pd(t,2,e,e);n=1.4*Math.sqrt(r),n=n>16?16:n|0,e=e.times(1/Lv(5,n)),e=pd(t,2,e,e);for(var i,a=new t(5),o=new t(16),c=new t(20);n--;)i=e.times(e),e=e.times(a.plus(i.times(o.times(i).minus(c))));return e}function pd(t,e,n,r,i){var a,o,c,u,d=t.precision,h=Math.ceil(d/Ke);for(tt=!1,u=n.times(n),c=new t(r);;){if(o=Xt(c.times(u),new t(e++*e++),d,1),c=i?r.plus(o):r.minus(o),r=Xt(o.times(u),new t(e++*e++),d,1),o=c.plus(r),o.d[h]!==void 0){for(a=h;o.d[a]===c.d[a]&&a--;);if(a==-1)break}a=c,c=r,r=o,o=a}return tt=!0,o.d.length=h+1,o}function Lv(t,e){for(var n=t;--e;)n*=t;return n}function KO(t,e){var n,r=e.s<0,i=Fa(t,t.precision,1),a=i.times(.5);if(e=e.abs(),e.lte(a))return Ds=r?4:1,e;if(n=e.divToInt(i),n.isZero())Ds=r?3:2;else{if(e=e.minus(n.times(i)),e.lte(a))return Ds=kD(n)?r?2:3:r?4:1,e;Ds=kD(n)?r?1:4:r?3:2}return e.minus(i).abs()}function AS(t,e,n,r){var i,a,o,c,u,d,h,p,m,y=t.constructor,_=n!==void 0;if(_?(oi(n,1,ml),r===void 0?r=y.rounding:oi(r,0,8)):(n=y.precision,r=y.rounding),!t.isFinite())h=YO(t);else{for(h=Ja(t),o=h.indexOf("."),_?(i=2,e==16?n=n*4-3:e==8&&(n=n*3-2)):i=e,o>=0&&(h=h.replace(".",""),m=new y(1),m.e=h.length-o,m.d=r0(Ja(m),10,i),m.e=m.d.length),p=r0(h,10,i),a=u=p.length;p[--u]==0;)p.pop();if(!p[0])h=_?"0p+0":"0";else{if(o<0?a--:(t=new y(t),t.d=p,t.e=a,t=Xt(t,m,n,r,0,i),p=t.d,a=t.e,d=LO),o=p[n],c=i/2,d=d||p[n+1]!==void 0,d=r<4?(o!==void 0||d)&&(r===0||r===(t.s<0?3:2)):o>c||o===c&&(r===4||d||r===6&&p[n-1]&1||r===(t.s<0?8:7)),p.length=n,d)for(;++p[--n]>i-1;)p[n]=0,n||(++a,p.unshift(1));for(u=p.length;!p[u-1];--u);for(o=0,h="";o<u;o++)h+=g_.charAt(p[o]);if(_){if(u>1)if(e==16||e==8){for(o=e==16?4:3,--u;u%o;u++)h+="0";for(p=r0(h,i,e),u=p.length;!p[u-1];--u);for(o=1,h="1.";o<u;o++)h+=g_.charAt(p[o])}else h=h.charAt(0)+"."+h.slice(1);h=h+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)h="0"+h;h="0."+h}else if(++a>u)for(a-=u;a--;)h+="0";else a<u&&(h=h.slice(0,a)+"."+h.slice(a))}h=(e==16?"0x":e==2?"0b":e==8?"0o":"")+h}return t.s<0?"-"+h:h}function ND(t,e){if(t.length>e)return t.length=e,!0}function y$(t){return new this(t).abs()}function b$(t){return new this(t).acos()}function x$(t){return new this(t).acosh()}function _$(t,e){return new this(t).plus(e)}function w$(t){return new this(t).asin()}function S$(t){return new this(t).asinh()}function E$(t){return new this(t).atan()}function T$(t){return new this(t).atanh()}function A$(t,e){t=new this(t),e=new this(e);var n,r=this.precision,i=this.rounding,a=r+4;return!t.s||!e.s?n=new this(NaN):!t.d&&!e.d?(n=Fa(this,a,1).times(e.s>0?.25:.75),n.s=t.s):!e.d||t.isZero()?(n=e.s<0?Fa(this,r,i):new this(0),n.s=t.s):!t.d||e.isZero()?(n=Fa(this,a,1).times(.5),n.s=t.s):e.s<0?(this.precision=a,this.rounding=1,n=this.atan(Xt(t,e,a,1)),e=Fa(this,a,1),this.precision=r,this.rounding=i,n=t.s<0?n.minus(e):n.plus(e)):n=this.atan(Xt(t,e,a,1)),n}function C$(t){return new this(t).cbrt()}function I$(t){return Fe(t=new this(t),t.e+1,2)}function D$(t,e,n){return new this(t).clamp(e,n)}function R$(t){if(!t||typeof t!="object")throw Error(jv+"Object expected");var e,n,r,i=t.defaults===!0,a=["precision",1,ml,"rounding",0,8,"toExpNeg",-Wu,0,"toExpPos",0,Wu,"maxE",0,Wu,"minE",-Wu,0,"modulo",0,9];for(e=0;e<a.length;e+=3)if(n=a[e],i&&(this[n]=m_[n]),(r=t[n])!==void 0)if(kr(r)===r&&r>=a[e+1]&&r<=a[e+2])this[n]=r;else throw Error(ll+n+": "+r);if(n="crypto",i&&(this[n]=m_[n]),(r=t[n])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(FO);else this[n]=!1;else throw Error(ll+n+": "+r);return this}function k$(t){return new this(t).cos()}function N$(t){return new this(t).cosh()}function XO(t){var e,n,r;function i(a){var o,c,u,d=this;if(!(d instanceof i))return new i(a);if(d.constructor=i,MD(a)){d.s=a.s,tt?!a.d||a.e>i.maxE?(d.e=NaN,d.d=null):a.e<i.minE?(d.e=0,d.d=[0]):(d.e=a.e,d.d=a.d.slice()):(d.e=a.e,d.d=a.d?a.d.slice():a.d);return}if(u=typeof a,u==="number"){if(a===0){d.s=1/a<0?-1:1,d.e=0,d.d=[0];return}if(a<0?(a=-a,d.s=-1):d.s=1,a===~~a&&a<1e7){for(o=0,c=a;c>=10;c/=10)o++;tt?o>i.maxE?(d.e=NaN,d.d=null):o<i.minE?(d.e=0,d.d=[0]):(d.e=o,d.d=[a]):(d.e=o,d.d=[a]);return}if(a*0!==0){a||(d.s=NaN),d.e=NaN,d.d=null;return}return i0(d,a.toString())}if(u==="string")return(c=a.charCodeAt(0))===45?(a=a.slice(1),d.s=-1):(c===43&&(a=a.slice(1)),d.s=1),GO.test(a)?i0(d,a):m$(d,a);if(u==="bigint")return a<0?(a=-a,d.s=-1):d.s=1,i0(d,a.toString());throw Error(ll+a)}if(i.prototype=_e,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=R$,i.clone=XO,i.isDecimal=MD,i.abs=y$,i.acos=b$,i.acosh=x$,i.add=_$,i.asin=w$,i.asinh=S$,i.atan=E$,i.atanh=T$,i.atan2=A$,i.cbrt=C$,i.ceil=I$,i.clamp=D$,i.cos=k$,i.cosh=N$,i.div=M$,i.exp=P$,i.floor=O$,i.hypot=V$,i.ln=j$,i.log=z$,i.log10=B$,i.log2=L$,i.max=F$,i.min=U$,i.mod=G$,i.mul=q$,i.pow=H$,i.random=$$,i.round=Y$,i.sign=K$,i.sin=X$,i.sinh=W$,i.sqrt=Q$,i.sub=Z$,i.sum=J$,i.tan=eY,i.tanh=tY,i.trunc=nY,t===void 0&&(t={}),t&&t.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<r.length;)t.hasOwnProperty(n=r[e++])||(t[n]=this[n]);return i.config(t),i}function M$(t,e){return new this(t).div(e)}function P$(t){return new this(t).exp()}function O$(t){return Fe(t=new this(t),t.e+1,3)}function V$(){var t,e,n=new this(0);for(tt=!1,t=0;t<arguments.length;)if(e=new this(arguments[t++]),e.d)n.d&&(n=n.plus(e.times(e)));else{if(e.s)return tt=!0,new this(1/0);n=e}return tt=!0,n.sqrt()}function MD(t){return t instanceof ti||t&&t.toStringTag===UO||!1}function j$(t){return new this(t).ln()}function z$(t,e){return new this(t).log(e)}function L$(t){return new this(t).log(2)}function B$(t){return new this(t).log(10)}function F$(){return $O(this,arguments,-1)}function U$(){return $O(this,arguments,1)}function G$(t,e){return new this(t).mod(e)}function q$(t,e){return new this(t).mul(e)}function H$(t,e){return new this(t).pow(e)}function $$(t){var e,n,r,i,a=0,o=new this(1),c=[];if(t===void 0?t=this.precision:oi(t,1,ml),r=Math.ceil(t/Ke),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));a<r;)i=e[a],i>=429e7?e[a]=crypto.getRandomValues(new Uint32Array(1))[0]:c[a++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(r*=4);a<r;)i=e[a]+(e[a+1]<<8)+(e[a+2]<<16)+((e[a+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(e,a):(c.push(i%1e7),a+=4);a=r/4}else throw Error(FO);else for(;a<r;)c[a++]=Math.random()*1e7|0;for(r=c[--a],t%=Ke,r&&t&&(i=Wn(10,Ke-t),c[a]=(r/i|0)*i);c[a]===0;a--)c.pop();if(a<0)n=0,c=[0];else{for(n=-1;c[0]===0;n-=Ke)c.shift();for(r=1,i=c[0];i>=10;i/=10)r++;r<Ke&&(n-=Ke-r)}return o.e=n,o.d=c,o}function Y$(t){return Fe(t=new this(t),t.e+1,this.rounding)}function K$(t){return t=new this(t),t.d?t.d[0]?t.s:0*t.s:t.s||NaN}function X$(t){return new this(t).sin()}function W$(t){return new this(t).sinh()}function Q$(t){return new this(t).sqrt()}function Z$(t,e){return new this(t).sub(e)}function J$(){var t=0,e=arguments,n=new this(e[t]);for(tt=!1;n.s&&++t<e.length;)n=n.plus(e[t]);return tt=!0,Fe(n,this.precision,this.rounding)}function eY(t){return new this(t).tan()}function tY(t){return new this(t).tanh()}function nY(t){return Fe(t=new this(t),t.e+1,1)}_e[Symbol.for("nodejs.util.inspect.custom")]=_e.toString;_e[Symbol.toStringTag]="Decimal";var ti=_e.constructor=XO(m_);L0=new ti(L0);B0=new ti(B0);const rY=()=>{};var PD={};const WO=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},iY=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[n++];e[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[n++],o=t[n++],c=t[n++],u=((i&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const a=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return e.join("")},QO={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const a=t[i],o=i+1<t.length,c=o?t[i+1]:0,u=i+2<t.length,d=u?t[i+2]:0,h=a>>2,p=(a&3)<<4|c>>4;let m=(c&15)<<2|d>>6,y=d&63;u||(y=64,o||(m=64)),r.push(n[h],n[p],n[m],n[y])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(WO(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):iY(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const a=n[t.charAt(i++)],c=i<t.length?n[t.charAt(i)]:0;++i;const d=i<t.length?n[t.charAt(i)]:64;++i;const p=i<t.length?n[t.charAt(i)]:64;if(++i,a==null||c==null||d==null||p==null)throw new aY;const m=a<<2|c>>4;if(r.push(m),d!==64){const y=c<<4&240|d>>2;if(r.push(y),p!==64){const _=d<<6&192|p;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class aY extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const sY=function(t){const e=WO(t);return QO.encodeByteArray(e,!0)},U0=function(t){return sY(t).replace(/\./g,"")},ZO=function(t){try{return QO.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function JO(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const oY=()=>JO().__FIREBASE_DEFAULTS__,lY=()=>{if(typeof process>"u"||typeof PD>"u")return;const t=PD.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},cY=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&ZO(t[1]);return e&&JSON.parse(e)},Bv=()=>{try{return rY()||oY()||lY()||cY()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},e4=t=>Bv()?.emulatorHosts?.[t],uY=t=>{const e=e4(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},t4=()=>Bv()?.config,n4=t=>Bv()?.[`_${t}`];class dY{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}function Fd(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function r4(t){return(await fetch(t,{credentials:"include"})).ok}function fY(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...t};return[U0(JSON.stringify(n)),U0(JSON.stringify(o)),""].join(".")}const Eh={};function hY(){const t={prod:[],emulator:[]};for(const e of Object.keys(Eh))Eh[e]?t.emulator.push(e):t.prod.push(e);return t}function pY(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let OD=!1;function i4(t,e){if(typeof window>"u"||typeof document>"u"||!Fd(window.location.host)||Eh[t]===e||Eh[t]||OD)return;Eh[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",a=hY().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function c(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,y){m.setAttribute("width","24"),m.setAttribute("id",y),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{OD=!0,o()},m}function h(m,y){m.setAttribute("id",y),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=pY(r),y=n("text"),_=document.getElementById(y)||document.createElement("span"),w=n("learnmore"),E=document.getElementById(w)||document.createElement("a"),T=n("preprendIcon"),I=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const D=m.element;c(D),h(E,w);const O=d();u(I,T),D.append(I,_,E,O),document.body.appendChild(D)}a?(_.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function Jn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function gY(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Jn())}function a4(){const t=Bv()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function mY(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function vY(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function yY(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function bY(){const t=Jn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function s4(){return!a4()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function o4(){return!a4()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function l4(){try{return typeof indexedDB=="object"}catch{return!1}}function xY(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(n){e(n)}})}const _Y="FirebaseError";class Ys extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=_Y,Object.setPrototypeOf(this,Ys.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Np.prototype.create)}}class Np{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,a=this.errors[e],o=a?wY(a,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new Ys(i,c,r)}}function wY(t,e){return t.replace(SY,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const SY=/\{\$([^}]+)}/g;function EY(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function wc(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const a=t[i],o=e[i];if(VD(a)&&VD(o)){if(!wc(a,o))return!1}else if(a!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function VD(t){return t!==null&&typeof t=="object"}function Mp(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function sh(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,a]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function oh(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function TY(t,e){const n=new AY(t,e);return n.subscribe.bind(n)}class AY{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");CY(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=K1),i.error===void 0&&(i.error=K1),i.complete===void 0&&(i.complete=K1);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function CY(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function K1(){}function vn(t){return t&&t._delegate?t._delegate:t}class Sc{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Yl="[DEFAULT]";class IY{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new dY;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(RY(e))try{this.getOrInitializeService({instanceIdentifier:Yl})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const a=this.getOrInitializeService({instanceIdentifier:i});r.resolve(a)}catch{}}}}clearInstance(e=Yl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Yl){return this.instances.has(e)}getOptions(e=Yl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[a,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);r===c&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const a=this.instances.get(r);return a&&e(a,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:DY(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Yl){return this.component?this.component.multipleInstances?e:Yl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function DY(t){return t===Yl?void 0:t}function RY(t){return t.instantiationMode==="EAGER"}class kY{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new IY(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var bt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(bt||(bt={}));const NY={debug:bt.DEBUG,verbose:bt.VERBOSE,info:bt.INFO,warn:bt.WARN,error:bt.ERROR,silent:bt.SILENT},MY=bt.INFO,PY={[bt.DEBUG]:"log",[bt.VERBOSE]:"log",[bt.INFO]:"info",[bt.WARN]:"warn",[bt.ERROR]:"error"},OY=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=PY[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class CS{constructor(e){this.name=e,this._logLevel=MY,this._logHandler=OY,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in bt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?NY[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,bt.DEBUG,...e),this._logHandler(this,bt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,bt.VERBOSE,...e),this._logHandler(this,bt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,bt.INFO,...e),this._logHandler(this,bt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,bt.WARN,...e),this._logHandler(this,bt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,bt.ERROR,...e),this._logHandler(this,bt.ERROR,...e)}}const VY=(t,e)=>e.some(n=>t instanceof n);let jD,zD;function jY(){return jD||(jD=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function zY(){return zD||(zD=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const c4=new WeakMap,b_=new WeakMap,u4=new WeakMap,X1=new WeakMap,IS=new WeakMap;function LY(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{n(Qo(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&c4.set(n,t)}).catch(()=>{}),IS.set(e,t),e}function BY(t){if(b_.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});b_.set(t,e)}let x_={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return b_.get(t);if(e==="objectStoreNames")return t.objectStoreNames||u4.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Qo(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function FY(t){x_=t(x_)}function UY(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(W1(this),e,...n);return u4.set(r,e.sort?e.sort():[e]),Qo(r)}:zY().includes(t)?function(...e){return t.apply(W1(this),e),Qo(c4.get(this))}:function(...e){return Qo(t.apply(W1(this),e))}}function GY(t){return typeof t=="function"?UY(t):(t instanceof IDBTransaction&&BY(t),VY(t,jY())?new Proxy(t,x_):t)}function Qo(t){if(t instanceof IDBRequest)return LY(t);if(X1.has(t))return X1.get(t);const e=GY(t);return e!==t&&(X1.set(t,e),IS.set(e,t)),e}const W1=t=>IS.get(t);function qY(t,e,{blocked:n,upgrade:r,blocking:i,terminated:a}={}){const o=indexedDB.open(t,e),c=Qo(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Qo(o.result),u.oldVersion,u.newVersion,Qo(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),c.then(u=>{a&&u.addEventListener("close",()=>a()),i&&u.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const HY=["get","getKey","getAll","getAllKeys","count"],$Y=["put","add","delete","clear"],Q1=new Map;function LD(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Q1.get(e))return Q1.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=$Y.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||HY.includes(n)))return;const a=async function(o,...c){const u=this.transaction(o,i?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[n](...c),i&&u.done]))[0]};return Q1.set(e,a),a}FY(t=>({...t,get:(e,n,r)=>LD(e,n)||t.get(e,n,r),has:(e,n)=>!!LD(e,n)||t.has(e,n)}));class YY{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(KY(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function KY(t){return t.getComponent()?.type==="VERSION"}const __="@firebase/app",BD="0.14.6";const Gs=new CS("@firebase/app"),XY="@firebase/app-compat",WY="@firebase/analytics-compat",QY="@firebase/analytics",ZY="@firebase/app-check-compat",JY="@firebase/app-check",eK="@firebase/auth",tK="@firebase/auth-compat",nK="@firebase/database",rK="@firebase/data-connect",iK="@firebase/database-compat",aK="@firebase/functions",sK="@firebase/functions-compat",oK="@firebase/installations",lK="@firebase/installations-compat",cK="@firebase/messaging",uK="@firebase/messaging-compat",dK="@firebase/performance",fK="@firebase/performance-compat",hK="@firebase/remote-config",pK="@firebase/remote-config-compat",gK="@firebase/storage",mK="@firebase/storage-compat",vK="@firebase/firestore",yK="@firebase/ai",bK="@firebase/firestore-compat",xK="firebase",_K="12.6.0";const w_="[DEFAULT]",wK={[__]:"fire-core",[XY]:"fire-core-compat",[QY]:"fire-analytics",[WY]:"fire-analytics-compat",[JY]:"fire-app-check",[ZY]:"fire-app-check-compat",[eK]:"fire-auth",[tK]:"fire-auth-compat",[nK]:"fire-rtdb",[rK]:"fire-data-connect",[iK]:"fire-rtdb-compat",[aK]:"fire-fn",[sK]:"fire-fn-compat",[oK]:"fire-iid",[lK]:"fire-iid-compat",[cK]:"fire-fcm",[uK]:"fire-fcm-compat",[dK]:"fire-perf",[fK]:"fire-perf-compat",[hK]:"fire-rc",[pK]:"fire-rc-compat",[gK]:"fire-gcs",[mK]:"fire-gcs-compat",[vK]:"fire-fst",[bK]:"fire-fst-compat",[yK]:"fire-vertex","fire-js":"fire-js",[xK]:"fire-js-all"};const G0=new Map,SK=new Map,S_=new Map;function FD(t,e){try{t.container.addComponent(e)}catch(n){Gs.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function gd(t){const e=t.name;if(S_.has(e))return Gs.debug(`There were multiple attempts to register component ${e}.`),!1;S_.set(e,t);for(const n of G0.values())FD(n,t);for(const n of SK.values())FD(n,t);return!0}function DS(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Ui(t){return t==null?!1:t.settings!==void 0}const EK={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Zo=new Np("app","Firebase",EK);class TK{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Sc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Zo.create("app-deleted",{appName:this._name})}}const Ud=_K;function d4(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:w_,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Zo.create("bad-app-name",{appName:String(i)});if(n||(n=t4()),!n)throw Zo.create("no-options");const a=G0.get(i);if(a){if(wc(n,a.options)&&wc(r,a.config))return a;throw Zo.create("duplicate-app",{appName:i})}const o=new kY(i);for(const u of S_.values())o.addComponent(u);const c=new TK(n,r,o);return G0.set(i,c),c}function f4(t=w_){const e=G0.get(t);if(!e&&t===w_&&t4())return d4();if(!e)throw Zo.create("no-app",{appName:t});return e}function Jo(t,e,n){let r=wK[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Gs.warn(o.join(" "));return}gd(new Sc(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const AK="firebase-heartbeat-database",CK=1,Qh="firebase-heartbeat-store";let Z1=null;function h4(){return Z1||(Z1=qY(AK,CK,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Qh)}catch(n){console.warn(n)}}}}).catch(t=>{throw Zo.create("idb-open",{originalErrorMessage:t.message})})),Z1}async function IK(t){try{const n=(await h4()).transaction(Qh),r=await n.objectStore(Qh).get(p4(t));return await n.done,r}catch(e){if(e instanceof Ys)Gs.warn(e.message);else{const n=Zo.create("idb-get",{originalErrorMessage:e?.message});Gs.warn(n.message)}}}async function UD(t,e){try{const r=(await h4()).transaction(Qh,"readwrite");await r.objectStore(Qh).put(e,p4(t)),await r.done}catch(n){if(n instanceof Ys)Gs.warn(n.message);else{const r=Zo.create("idb-set",{originalErrorMessage:n?.message});Gs.warn(r.message)}}}function p4(t){return`${t.name}!${t.options.appId}`}const DK=1024,RK=30;class kK{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new MK(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=GD();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>RK){const i=PK(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Gs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=GD(),{heartbeatsToSend:n,unsentEntries:r}=NK(this._heartbeatsCache.heartbeats),i=U0(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Gs.warn(e),""}}}function GD(){return new Date().toISOString().substring(0,10)}function NK(t,e=DK){const n=[];let r=t.slice();for(const i of t){const a=n.find(o=>o.agent===i.agent);if(a){if(a.dates.push(i.date),qD(n)>e){a.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),qD(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class MK{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return l4()?xY().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await IK(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return UD(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return UD(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function qD(t){return U0(JSON.stringify({version:2,heartbeats:t})).length}function PK(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}function OK(t){gd(new Sc("platform-logger",e=>new YY(e),"PRIVATE")),gd(new Sc("heartbeat",e=>new kK(e),"PRIVATE")),Jo(__,BD,t),Jo(__,BD,"esm2020"),Jo("fire-js","")}OK("");function g4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const VK=g4,m4=new Np("auth","Firebase",g4());const q0=new CS("@firebase/auth");function jK(t,...e){q0.logLevel<=bt.WARN&&q0.warn(`Auth (${Ud}): ${t}`,...e)}function a0(t,...e){q0.logLevel<=bt.ERROR&&q0.error(`Auth (${Ud}): ${t}`,...e)}function ba(t,...e){throw RS(t,...e)}function Ya(t,...e){return RS(t,...e)}function v4(t,e,n){const r={...VK(),[e]:n};return new Np("auth","Firebase",r).create(e,{appName:t.name})}function js(t){return v4(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function RS(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return m4.create(t,...e)}function Qe(t,e,...n){if(!t)throw RS(e,...n)}function Rs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw a0(e),new Error(e)}function qs(t,e){t||Rs(e)}function E_(){return typeof self<"u"&&self.location?.href||""}function zK(){return HD()==="http:"||HD()==="https:"}function HD(){return typeof self<"u"&&self.location?.protocol||null}function LK(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(zK()||vY()||"connection"in navigator)?navigator.onLine:!0}function BK(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class Pp{constructor(e,n){this.shortDelay=e,this.longDelay=n,qs(n>e,"Short delay should be less than long delay!"),this.isMobile=gY()||yY()}get(){return LK()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function kS(t,e){qs(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class y4{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Rs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Rs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Rs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const FK={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const UK=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],GK=new Pp(3e4,6e4);function Ks(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function os(t,e,n,r,i={}){return b4(t,i,async()=>{let a={},o={};r&&(e==="GET"?o=r:a={body:JSON.stringify(r)});const c=Mp({key:t.config.apiKey,...o}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:u,...a};return mY()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Fd(t.emulatorConfig.host)&&(d.credentials="include"),y4.fetch()(await x4(t,t.config.apiHost,n,c),d)})}async function b4(t,e,n){t._canInitEmulator=!1;const r={...FK,...e};try{const i=new HK(t),a=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw zm(t,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const c=a.ok?o.errorMessage:o.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw zm(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw zm(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw zm(t,"user-disabled",o);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw v4(t,h,d);ba(t,h)}}catch(i){if(i instanceof Ys)throw i;ba(t,"network-request-failed",{message:String(i)})}}async function Op(t,e,n,r,i={}){const a=await os(t,e,n,r,i);return"mfaPendingCredential"in a&&ba(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function x4(t,e,n,r){const i=`${e}${n}?${r}`,a=t,o=a.config.emulator?kS(t.config,i):`${t.config.apiScheme}://${i}`;return UK.includes(n)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(o).toString():o}function qK(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class HK{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Ya(this.auth,"network-request-failed")),GK.get())})}}function zm(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Ya(t,e,r);return i.customData._tokenResponse=n,i}function $D(t){return t!==void 0&&t.enterprise!==void 0}class $K{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return qK(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function YK(t,e){return os(t,"GET","/v2/recaptchaConfig",Ks(t,e))}async function KK(t,e){return os(t,"POST","/v1/accounts:delete",e)}async function H0(t,e){return os(t,"POST","/v1/accounts:lookup",e)}function Th(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function XK(t,e=!1){const n=vn(t),r=await n.getIdToken(e),i=NS(r);Qe(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,o=a?.sign_in_provider;return{claims:i,token:r,authTime:Th(J1(i.auth_time)),issuedAtTime:Th(J1(i.iat)),expirationTime:Th(J1(i.exp)),signInProvider:o||null,signInSecondFactor:a?.sign_in_second_factor||null}}function J1(t){return Number(t)*1e3}function NS(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return a0("JWT malformed, contained fewer than 3 sections"),null;try{const i=ZO(n);return i?JSON.parse(i):(a0("Failed to decode base64 JWT payload"),null)}catch(i){return a0("Caught error parsing JWT payload as JSON",i?.toString()),null}}function YD(t){const e=NS(t);return Qe(e,"internal-error"),Qe(typeof e.exp<"u","internal-error"),Qe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function md(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Ys&&WK(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function WK({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class QK{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class T_{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Th(this.lastLoginAt),this.creationTime=Th(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function $0(t){const e=t.auth,n=await t.getIdToken(),r=await md(t,H0(e,{idToken:n}));Qe(r?.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const a=i.providerUserInfo?.length?_4(i.providerUserInfo):[],o=JK(t.providerData,a),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!o?.length,d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new T_(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function ZK(t){const e=vn(t);await $0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function JK(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function _4(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function eX(t,e){const n=await b4(t,{},async()=>{const r=Mp({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=t.config,o=await x4(t,i,"/v1/token",`key=${a}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:r};return t.emulatorConfig&&Fd(t.emulatorConfig.host)&&(u.credentials="include"),y4.fetch()(o,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function tX(t,e){return os(t,"POST","/v2/accounts:revokeToken",Ks(t,e))}class td{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Qe(e.idToken,"internal-error"),Qe(typeof e.idToken<"u","internal-error"),Qe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):YD(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Qe(e.length!==0,"internal-error");const n=YD(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Qe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:a}=await eX(e,n);this.updateTokensAndExpiration(r,i,Number(a))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:a}=n,o=new td;return r&&(Qe(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Qe(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),a&&(Qe(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new td,this.toJSON())}_performRefresh(){return Rs("not implemented")}}function Mo(t,e){Qe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class fa{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new QK(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new T_(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await md(this,this.stsTokenManager.getToken(this.auth,e));return Qe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return XK(this,e)}reload(){return ZK(this)}_assign(e){this!==e&&(Qe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new fa({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Qe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await $0(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ui(this.auth.app))return Promise.reject(js(this.auth));const e=await this.getIdToken();return await md(this,KK(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,a=n.phoneNumber??void 0,o=n.photoURL??void 0,c=n.tenantId??void 0,u=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:y,providerData:_,stsTokenManager:w}=n;Qe(p&&w,e,"internal-error");const E=td.fromJSON(this.name,w);Qe(typeof p=="string",e,"internal-error"),Mo(r,e.name),Mo(i,e.name),Qe(typeof m=="boolean",e,"internal-error"),Qe(typeof y=="boolean",e,"internal-error"),Mo(a,e.name),Mo(o,e.name),Mo(c,e.name),Mo(u,e.name),Mo(d,e.name),Mo(h,e.name);const T=new fa({uid:p,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:y,photoURL:o,phoneNumber:a,tenantId:c,stsTokenManager:E,createdAt:d,lastLoginAt:h});return _&&Array.isArray(_)&&(T.providerData=_.map(I=>({...I}))),u&&(T._redirectEventId=u),T}static async _fromIdTokenResponse(e,n,r=!1){const i=new td;i.updateFromServerResponse(n);const a=new fa({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await $0(a),a}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];Qe(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?_4(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!a?.length,c=new td;c.updateFromIdToken(r);const u=new fa({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new T_(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(u,d),u}}const KD=new Map;function ks(t){qs(t instanceof Function,"Expected a class definition");let e=KD.get(t);return e?(qs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,KD.set(t,e),e)}class w4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}w4.type="NONE";const XD=w4;function s0(t,e,n){return`firebase:${t}:${e}:${n}`}class nd{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:a}=this.auth;this.fullUserKey=s0(this.userKey,i.apiKey,a),this.fullPersistenceKey=s0("persistence",i.apiKey,a),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await H0(this.auth,{idToken:e}).catch(()=>{});return n?fa._fromGetAccountInfoResponse(this.auth,n,e):null}return fa._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new nd(ks(XD),e,r);const i=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let a=i[0]||ks(XD);const o=s0(r,e.config.apiKey,e.name);let c=null;for(const d of n)try{const h=await d._get(o);if(h){let p;if(typeof h=="string"){const m=await H0(e,{idToken:h}).catch(()=>{});if(!m)break;p=await fa._fromGetAccountInfoResponse(e,m,h)}else p=fa._fromJSON(e,h);d!==a&&(c=p),a=d;break}}catch{}const u=i.filter(d=>d._shouldAllowMigration);return!a._shouldAllowMigration||!u.length?new nd(a,e,r):(a=u[0],c&&await a._set(o,c.toJSON()),await Promise.all(n.map(async d=>{if(d!==a)try{await d._remove(o)}catch{}})),new nd(a,e,r))}}function WD(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(A4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(S4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(I4(e))return"Blackberry";if(D4(e))return"Webos";if(E4(e))return"Safari";if((e.includes("chrome/")||T4(e))&&!e.includes("edge/"))return"Chrome";if(C4(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if(r?.length===2)return r[1]}return"Other"}function S4(t=Jn()){return/firefox\//i.test(t)}function E4(t=Jn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function T4(t=Jn()){return/crios\//i.test(t)}function A4(t=Jn()){return/iemobile/i.test(t)}function C4(t=Jn()){return/android/i.test(t)}function I4(t=Jn()){return/blackberry/i.test(t)}function D4(t=Jn()){return/webos/i.test(t)}function MS(t=Jn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function nX(t=Jn()){return MS(t)&&!!window.navigator?.standalone}function rX(){return bY()&&document.documentMode===10}function R4(t=Jn()){return MS(t)||C4(t)||D4(t)||I4(t)||/windows phone/i.test(t)||A4(t)}function k4(t,e=[]){let n;switch(t){case"Browser":n=WD(Jn());break;case"Worker":n=`${WD(Jn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ud}/${r}`}class iX{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=a=>new Promise((o,c)=>{try{const u=e(a);o(u)}catch(u){c(u)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function aX(t,e={}){return os(t,"GET","/v2/passwordPolicy",Ks(t,e))}const sX=6;class oX{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??sX,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class lX{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new QD(this),this.idTokenSubscription=new QD(this),this.beforeStateQueue=new iX(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=m4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ks(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await nd.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await H0(this,{idToken:e}),r=await fa._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ui(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,o=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===o)&&c?.user&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Qe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await $0(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=BK()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ui(this.app))return Promise.reject(js(this));const n=e?vn(e):null;return n&&Qe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Qe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ui(this.app)?Promise.reject(js(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ui(this.app)?Promise.reject(js(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ks(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await aX(this),n=new oX(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Np("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await tX(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ks(e)||this._popupRedirectResolver;Qe(n,this,"argument-error"),this.redirectPersistenceManager=await nd.create(this,[ks(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const a=typeof n=="function"?n:n.next.bind(n);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(Qe(c,this,"internal-error"),c.then(()=>{o||a(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,i);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Qe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=k4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Ui(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&jK(`Error while retrieving App Check token: ${e.error}`),e?.token}}function vl(t){return vn(t)}class QD{constructor(e){this.auth=e,this.observer=null,this.addObserver=TY(n=>this.observer=n)}get next(){return Qe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Fv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function cX(t){Fv=t}function N4(t){return Fv.loadJS(t)}function uX(){return Fv.recaptchaEnterpriseScript}function dX(){return Fv.gapiScript}function fX(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class hX{constructor(){this.enterprise=new pX}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class pX{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const gX="recaptcha-enterprise",M4="NO_RECAPTCHA";class mX{constructor(e){this.type=gX,this.auth=vl(e)}async verify(e="verify",n=!1){async function r(a){if(!n){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,c)=>{YK(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new $K(u);return a.tenantId==null?a._agentRecaptchaConfig=d:a._tenantRecaptchaConfigs[a.tenantId]=d,o(d.siteKey)}}).catch(u=>{c(u)})})}function i(a,o,c){const u=window.grecaptcha;$D(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:e}).then(d=>{o(d)}).catch(()=>{o(M4)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new hX().execute("siteKey",{action:"verify"}):new Promise((a,o)=>{r(this.auth).then(c=>{if(!n&&$D(window.grecaptcha))i(c,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=uX();u.length!==0&&(u+=c),N4(u).then(()=>{i(c,a,o)}).catch(d=>{o(d)})}}).catch(c=>{o(c)})})}}async function ZD(t,e,n,r=!1,i=!1){const a=new mX(t);let o;if(i)o=M4;else try{o=await a.verify(n)}catch{o=await a.verify(n,!0)}const c={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function Y0(t,e,n,r,i){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await ZD(t,e,n,n==="getOobCode");return r(t,a)}else return r(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await ZD(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(a)})}function vX(t,e){const n=DS(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),a=n.getOptions();if(wc(a,e??{}))return i;ba(i,"already-initialized")}return n.initialize({options:e})}function yX(t,e){const n=e?.persistence||[],r=(Array.isArray(n)?n:[n]).map(ks);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e?.popupRedirectResolver)}function bX(t,e,n){const r=vl(t);Qe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,a=P4(e),{host:o,port:c}=xX(e),u=c===null?"":`:${c}`,d={url:`${a}//${o}${u}/`},h=Object.freeze({host:o,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Qe(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Qe(wc(d,r.config.emulator)&&wc(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Fd(o)?(r4(`${a}//${o}${u}`),i4("Auth",!0)):_X()}function P4(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function xX(t){const e=P4(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const a=i[1];return{host:a,port:JD(r.substr(a.length+1))}}else{const[a,o]=r.split(":");return{host:a,port:JD(o)}}}function JD(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function _X(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class PS{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Rs("not implemented")}_getIdTokenResponse(e){return Rs("not implemented")}_linkToIdToken(e,n){return Rs("not implemented")}_getReauthenticationResolver(e){return Rs("not implemented")}}async function wX(t,e){return os(t,"POST","/v1/accounts:signUp",e)}async function SX(t,e){return Op(t,"POST","/v1/accounts:signInWithPassword",Ks(t,e))}async function O4(t,e){return os(t,"POST","/v1/accounts:sendOobCode",Ks(t,e))}async function EX(t,e){return O4(t,e)}async function TX(t,e){return O4(t,e)}async function AX(t,e){return Op(t,"POST","/v1/accounts:signInWithEmailLink",Ks(t,e))}async function CX(t,e){return Op(t,"POST","/v1/accounts:signInWithEmailLink",Ks(t,e))}class Zh extends PS{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new Zh(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Zh(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Y0(e,n,"signInWithPassword",SX);case"emailLink":return AX(e,{email:this._email,oobCode:this._password});default:ba(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Y0(e,r,"signUpPassword",wX);case"emailLink":return CX(e,{idToken:n,email:this._email,oobCode:this._password});default:ba(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function rd(t,e){return Op(t,"POST","/v1/accounts:signInWithIdp",Ks(t,e))}const IX="http://localhost";class Ec extends PS{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ec(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ba("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...a}=n;if(!r||!i)return null;const o=new Ec(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return rd(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,rd(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,rd(e,n)}buildRequest(){const e={requestUri:IX,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Mp(n)}return e}}function DX(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function RX(t){const e=sh(oh(t)).link,n=e?sh(oh(e)).deep_link_id:null,r=sh(oh(t)).deep_link_id;return(r?sh(oh(r)).link:null)||r||n||e||t}class OS{constructor(e){const n=sh(oh(e)),r=n.apiKey??null,i=n.oobCode??null,a=DX(n.mode??null);Qe(r&&i&&a,"argument-error"),this.apiKey=r,this.operation=a,this.code=i,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=RX(e);try{return new OS(n)}catch{return null}}}class jc{constructor(){this.providerId=jc.PROVIDER_ID}static credential(e,n){return Zh._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=OS.parseLink(n);return Qe(r,"argument-error"),Zh._fromEmailAndCode(e,r.code,r.tenantId)}}jc.PROVIDER_ID="password";jc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";jc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class V4{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Vp extends V4{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Bo extends Vp{constructor(){super("facebook.com")}static credential(e){return Ec._fromParams({providerId:Bo.PROVIDER_ID,signInMethod:Bo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bo.credentialFromTaggedObject(e)}static credentialFromError(e){return Bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bo.credential(e.oauthAccessToken)}catch{return null}}}Bo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Bo.PROVIDER_ID="facebook.com";class Fo extends Vp{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ec._fromParams({providerId:Fo.PROVIDER_ID,signInMethod:Fo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Fo.credentialFromTaggedObject(e)}static credentialFromError(e){return Fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Fo.credential(n,r)}catch{return null}}}Fo.GOOGLE_SIGN_IN_METHOD="google.com";Fo.PROVIDER_ID="google.com";class Uo extends Vp{constructor(){super("github.com")}static credential(e){return Ec._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Uo.credential(e.oauthAccessToken)}catch{return null}}}Uo.GITHUB_SIGN_IN_METHOD="github.com";Uo.PROVIDER_ID="github.com";class Go extends Vp{constructor(){super("twitter.com")}static credential(e,n){return Ec._fromParams({providerId:Go.PROVIDER_ID,signInMethod:Go.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Go.credentialFromTaggedObject(e)}static credentialFromError(e){return Go.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Go.credential(n,r)}catch{return null}}}Go.TWITTER_SIGN_IN_METHOD="twitter.com";Go.PROVIDER_ID="twitter.com";async function kX(t,e){return Op(t,"POST","/v1/accounts:signUp",Ks(t,e))}class Tc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const a=await fa._fromIdTokenResponse(e,r,i),o=eR(r);return new Tc({user:a,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=eR(r);return new Tc({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function eR(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class K0 extends Ys{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,K0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new K0(e,n,r,i)}}function j4(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?K0._fromErrorAndOperation(t,a,e,r):a})}async function NX(t,e,n=!1){const r=await md(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Tc._forOperation(t,"link",r)}async function z4(t,e,n=!1){const{auth:r}=t;if(Ui(r.app))return Promise.reject(js(r));const i="reauthenticate";try{const a=await md(t,j4(r,i,e,t),n);Qe(a.idToken,r,"internal-error");const o=NS(a.idToken);Qe(o,r,"internal-error");const{sub:c}=o;return Qe(t.uid===c,r,"user-mismatch"),Tc._forOperation(t,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&ba(r,"user-mismatch"),a}}async function L4(t,e,n=!1){if(Ui(t.app))return Promise.reject(js(t));const r="signIn",i=await j4(t,r,e),a=await Tc._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(a.user),a}async function MX(t,e){return L4(vl(t),e)}async function PX(t,e){return z4(vn(t),e)}async function B4(t){const e=vl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function OX(t,e,n){const r=vl(t);await Y0(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",TX)}async function VX(t,e,n){if(Ui(t.app))return Promise.reject(js(t));const r=vl(t),o=await Y0(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",kX).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&B4(t),u}),c=await Tc._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(c.user),c}function jX(t,e,n){return Ui(t.app)?Promise.reject(js(t)):MX(vn(t),jc.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&B4(t),r})}async function tR(t,e){const n=vn(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:a}=await EX(n.auth,i);a!==t.email&&await t.reload()}async function zX(t,e){return os(t,"POST","/v1/accounts:update",e)}async function LX(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=vn(t),a={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await md(r,zX(r.auth,a));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const c=r.providerData.find(({providerId:u})=>u==="password");c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function BX(t,e,n,r){return vn(t).onIdTokenChanged(e,n,r)}function FX(t,e,n){return vn(t).beforeAuthStateChanged(e,n)}function UX(t,e,n,r){return vn(t).onAuthStateChanged(e,n,r)}function nR(t){return vn(t).signOut()}async function GX(t){return vn(t).delete()}const X0="__sak";class F4{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(X0,"1"),this.storage.removeItem(X0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const qX=1e3,HX=10;class U4 extends F4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=R4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},a=this.storage.getItem(r);rX()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,HX):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},qX)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}U4.type="LOCAL";const $X=U4;class G4 extends F4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}G4.type="SESSION";const q4=G4;function YX(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class Uv{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Uv(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:a}=n.data,o=this.handlersMap[i];if(!o?.size)return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const c=Array.from(o).map(async d=>d(n.origin,a)),u=await YX(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Uv.receivers=[];function VS(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}class KX{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,o;return new Promise((c,u)=>{const d=VS("",20);i.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const m=p;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),a=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(m.data.response);break;default:clearTimeout(h),clearTimeout(a),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Ka(){return window}function XX(t){Ka().location.href=t}function H4(){return typeof Ka().WorkerGlobalScope<"u"&&typeof Ka().importScripts=="function"}async function WX(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function QX(){return navigator?.serviceWorker?.controller||null}function ZX(){return H4()?self:null}const $4="firebaseLocalStorageDb",JX=1,W0="firebaseLocalStorage",Y4="fbase_key";class jp{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Gv(t,e){return t.transaction([W0],e?"readwrite":"readonly").objectStore(W0)}function eW(){const t=indexedDB.deleteDatabase($4);return new jp(t).toPromise()}function A_(){const t=indexedDB.open($4,JX);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(W0,{keyPath:Y4})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(W0)?e(r):(r.close(),await eW(),e(await A_()))})})}async function rR(t,e,n){const r=Gv(t,!0).put({[Y4]:e,value:n});return new jp(r).toPromise()}async function tW(t,e){const n=Gv(t,!1).get(e),r=await new jp(n).toPromise();return r===void 0?null:r.value}function iR(t,e){const n=Gv(t,!0).delete(e);return new jp(n).toPromise()}const nW=800,rW=3;class K4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await A_(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>rW)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return H4()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Uv._getInstance(ZX()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await WX(),!this.activeServiceWorker)return;this.sender=new KX(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||QX()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await A_();return await rR(e,X0,"1"),await iR(e,X0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>rR(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>tW(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>iR(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=Gv(i,!1).getAll();return new jp(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),nW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}K4.type="LOCAL";const iW=K4;new Pp(3e4,6e4);function aW(t,e){return e?ks(e):(Qe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class jS extends PS{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return rd(e,this._buildIdpRequest())}_linkToIdToken(e,n){return rd(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return rd(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function sW(t){return L4(t.auth,new jS(t),t.bypassAuthState)}function oW(t){const{auth:e,user:n}=t;return Qe(n,e,"internal-error"),z4(n,new jS(t),t.bypassAuthState)}async function lW(t){const{auth:e,user:n}=t;return Qe(n,e,"internal-error"),NX(n,new jS(t),t.bypassAuthState)}class X4{constructor(e,n,r,i,a=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:a,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return sW;case"linkViaPopup":case"linkViaRedirect":return lW;case"reauthViaPopup":case"reauthViaRedirect":return oW;default:ba(this.auth,"internal-error")}}resolve(e){qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const cW=new Pp(2e3,1e4);class Qu extends X4{constructor(e,n,r,i,a){super(e,n,i,a),this.provider=r,this.authWindow=null,this.pollId=null,Qu.currentPopupAction&&Qu.currentPopupAction.cancel(),Qu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Qe(e,this.auth,"internal-error"),e}async onExecution(){qs(this.filter.length===1,"Popup operations only handle one event");const e=VS();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Ya(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ya(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Qu.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ya(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,cW.get())};e()}}Qu.currentPopupAction=null;const uW="pendingRedirect",o0=new Map;class dW extends X4{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=o0.get(this.auth._key());if(!e){try{const r=await fW(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}o0.set(this.auth._key(),e)}return this.bypassAuthState||o0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function fW(t,e){const n=gW(e),r=pW(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function hW(t,e){o0.set(t._key(),e)}function pW(t){return ks(t._redirectPersistence)}function gW(t){return s0(uW,t.config.apiKey,t.name)}async function mW(t,e,n=!1){if(Ui(t.app))return Promise.reject(js(t));const r=vl(t),i=aW(r,e),o=await new dW(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}const vW=600*1e3;class yW{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!bW(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!W4(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";n.onError(Ya(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=vW&&this.cachedEventUids.clear(),this.cachedEventUids.has(aR(e))}saveEventToCache(e){this.cachedEventUids.add(aR(e)),this.lastProcessedEventTime=Date.now()}}function aR(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function W4({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function bW(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return W4(t);default:return!1}}async function xW(t,e={}){return os(t,"GET","/v1/projects",e)}const _W=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,wW=/^https?/;async function SW(t){if(t.config.emulator)return;const{authorizedDomains:e}=await xW(t);for(const n of e)try{if(EW(n))return}catch{}ba(t,"unauthorized-domain")}function EW(t){const e=E_(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!wW.test(n))return!1;if(_W.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const TW=new Pp(3e4,6e4);function sR(){const t=Ka().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function AW(t){return new Promise((e,n)=>{function r(){sR(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{sR(),n(Ya(t,"network-request-failed"))},timeout:TW.get()})}if(Ka().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ka().gapi?.load)r();else{const i=fX("iframefcb");return Ka()[i]=()=>{gapi.load?r():n(Ya(t,"network-request-failed"))},N4(`${dX()}?onload=${i}`).catch(a=>n(a))}}).catch(e=>{throw l0=null,e})}let l0=null;function CW(t){return l0=l0||AW(t),l0}const IW=new Pp(5e3,15e3),DW="__/auth/iframe",RW="emulator/auth/iframe",kW={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},NW=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function MW(t){const e=t.config;Qe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?kS(e,RW):`https://${t.config.authDomain}/${DW}`,r={apiKey:e.apiKey,appName:t.name,v:Ud},i=NW.get(t.config.apiHost);i&&(r.eid=i);const a=t._getFrameworks();return a.length&&(r.fw=a.join(",")),`${n}?${Mp(r).slice(1)}`}async function PW(t){const e=await CW(t),n=Ka().gapi;return Qe(n,t,"internal-error"),e.open({where:document.body,url:MW(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:kW,dontclear:!0},r=>new Promise(async(i,a)=>{await r.restyle({setHideOnLeave:!1});const o=Ya(t,"network-request-failed"),c=Ka().setTimeout(()=>{a(o)},IW.get());function u(){Ka().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{a(o)})}))}const OW={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},VW=500,jW=600,zW="_blank",LW="http://localhost";class oR{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function BW(t,e,n,r=VW,i=jW){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u={...OW,width:r.toString(),height:i.toString(),top:a,left:o},d=Jn().toLowerCase();n&&(c=T4(d)?zW:n),S4(d)&&(e=e||LW,u.scrollbars="yes");const h=Object.entries(u).reduce((m,[y,_])=>`${m}${y}=${_},`,"");if(nX(d)&&c!=="_self")return FW(e||"",c),new oR(null);const p=window.open(e||"",c,h);Qe(p,t,"popup-blocked");try{p.focus()}catch{}return new oR(p)}function FW(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}const UW="__/auth/handler",GW="emulator/auth/handler",qW=encodeURIComponent("fac");async function lR(t,e,n,r,i,a){Qe(t.config.authDomain,t,"auth-domain-config-required"),Qe(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Ud,eventId:i};if(e instanceof V4){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",EY(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))o[h]=p}if(e instanceof Vp){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const h of Object.keys(c))c[h]===void 0&&delete c[h];const u=await t._getAppCheckToken(),d=u?`#${qW}=${encodeURIComponent(u)}`:"";return`${HW(t)}?${Mp(c).slice(1)}${d}`}function HW({config:t}){return t.emulator?kS(t,GW):`https://${t.authDomain}/${UW}`}const ex="webStorageSupport";class $W{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=q4,this._completeRedirectFn=mW,this._overrideRedirectResult=hW}async _openPopup(e,n,r,i){qs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await lR(e,n,r,E_(),i);return BW(e,a,VS())}async _openRedirect(e,n,r,i){await this._originValidation(e);const a=await lR(e,n,r,E_(),i);return XX(a),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:a}=this.eventManagers[n];return i?Promise.resolve(i):(qs(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await PW(e),r=new yW(e);return n.register("authEvent",i=>(Qe(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(ex,{type:ex},i=>{const a=i?.[0]?.[ex];a!==void 0&&n(!!a),ba(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=SW(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return R4()||E4()||MS()}}const YW=$W;var cR="@firebase/auth",uR="1.11.1";class KW{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Qe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function XW(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function WW(t){gd(new Sc("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;Qe(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:k4(t)},d=new lX(r,i,a,u);return yX(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),gd(new Sc("auth-internal",e=>{const n=vl(e.getProvider("auth").getImmediate());return(r=>new KW(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Jo(cR,uR,XW(t)),Jo(cR,uR,"esm2020")}const QW=300,ZW=n4("authIdTokenMaxAge")||QW;let dR=null;const JW=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>ZW)return;const i=n?.token;dR!==i&&(dR=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function eQ(t=f4()){const e=DS(t,"auth");if(e.isInitialized())return e.getImmediate();const n=vX(t,{popupRedirectResolver:YW,persistence:[iW,$X,q4]}),r=n4("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const o=JW(a.toString());FX(n,o,()=>o(n.currentUser)),BX(n,c=>o(c))}}const i=e4("auth");return i&&bX(n,`http://${i}`),n}function tQ(){return document.getElementsByTagName("head")?.[0]??document}cX({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const a=Ya("internal-error");a.customData=i,n(a)},r.type="text/javascript",r.charset="UTF-8",tQ().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});WW("Browser");var nQ="firebase",rQ="12.6.0";Jo(nQ,rQ,"app");var fR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var el,Q4;(function(){var t;function e(A,C){function k(){}k.prototype=C.prototype,A.F=C.prototype,A.prototype=new k,A.prototype.constructor=A,A.D=function(V,B,j){for(var N=Array(arguments.length-2),K=2;K<arguments.length;K++)N[K-2]=arguments[K];return C.prototype[B].apply(V,N)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,C,k){k||(k=0);const V=Array(16);if(typeof C=="string")for(var B=0;B<16;++B)V[B]=C.charCodeAt(k++)|C.charCodeAt(k++)<<8|C.charCodeAt(k++)<<16|C.charCodeAt(k++)<<24;else for(B=0;B<16;++B)V[B]=C[k++]|C[k++]<<8|C[k++]<<16|C[k++]<<24;C=A.g[0],k=A.g[1],B=A.g[2];let j=A.g[3],N;N=C+(j^k&(B^j))+V[0]+3614090360&4294967295,C=k+(N<<7&4294967295|N>>>25),N=j+(B^C&(k^B))+V[1]+3905402710&4294967295,j=C+(N<<12&4294967295|N>>>20),N=B+(k^j&(C^k))+V[2]+606105819&4294967295,B=j+(N<<17&4294967295|N>>>15),N=k+(C^B&(j^C))+V[3]+3250441966&4294967295,k=B+(N<<22&4294967295|N>>>10),N=C+(j^k&(B^j))+V[4]+4118548399&4294967295,C=k+(N<<7&4294967295|N>>>25),N=j+(B^C&(k^B))+V[5]+1200080426&4294967295,j=C+(N<<12&4294967295|N>>>20),N=B+(k^j&(C^k))+V[6]+2821735955&4294967295,B=j+(N<<17&4294967295|N>>>15),N=k+(C^B&(j^C))+V[7]+4249261313&4294967295,k=B+(N<<22&4294967295|N>>>10),N=C+(j^k&(B^j))+V[8]+1770035416&4294967295,C=k+(N<<7&4294967295|N>>>25),N=j+(B^C&(k^B))+V[9]+2336552879&4294967295,j=C+(N<<12&4294967295|N>>>20),N=B+(k^j&(C^k))+V[10]+4294925233&4294967295,B=j+(N<<17&4294967295|N>>>15),N=k+(C^B&(j^C))+V[11]+2304563134&4294967295,k=B+(N<<22&4294967295|N>>>10),N=C+(j^k&(B^j))+V[12]+1804603682&4294967295,C=k+(N<<7&4294967295|N>>>25),N=j+(B^C&(k^B))+V[13]+4254626195&4294967295,j=C+(N<<12&4294967295|N>>>20),N=B+(k^j&(C^k))+V[14]+2792965006&4294967295,B=j+(N<<17&4294967295|N>>>15),N=k+(C^B&(j^C))+V[15]+1236535329&4294967295,k=B+(N<<22&4294967295|N>>>10),N=C+(B^j&(k^B))+V[1]+4129170786&4294967295,C=k+(N<<5&4294967295|N>>>27),N=j+(k^B&(C^k))+V[6]+3225465664&4294967295,j=C+(N<<9&4294967295|N>>>23),N=B+(C^k&(j^C))+V[11]+643717713&4294967295,B=j+(N<<14&4294967295|N>>>18),N=k+(j^C&(B^j))+V[0]+3921069994&4294967295,k=B+(N<<20&4294967295|N>>>12),N=C+(B^j&(k^B))+V[5]+3593408605&4294967295,C=k+(N<<5&4294967295|N>>>27),N=j+(k^B&(C^k))+V[10]+38016083&4294967295,j=C+(N<<9&4294967295|N>>>23),N=B+(C^k&(j^C))+V[15]+3634488961&4294967295,B=j+(N<<14&4294967295|N>>>18),N=k+(j^C&(B^j))+V[4]+3889429448&4294967295,k=B+(N<<20&4294967295|N>>>12),N=C+(B^j&(k^B))+V[9]+568446438&4294967295,C=k+(N<<5&4294967295|N>>>27),N=j+(k^B&(C^k))+V[14]+3275163606&4294967295,j=C+(N<<9&4294967295|N>>>23),N=B+(C^k&(j^C))+V[3]+4107603335&4294967295,B=j+(N<<14&4294967295|N>>>18),N=k+(j^C&(B^j))+V[8]+1163531501&4294967295,k=B+(N<<20&4294967295|N>>>12),N=C+(B^j&(k^B))+V[13]+2850285829&4294967295,C=k+(N<<5&4294967295|N>>>27),N=j+(k^B&(C^k))+V[2]+4243563512&4294967295,j=C+(N<<9&4294967295|N>>>23),N=B+(C^k&(j^C))+V[7]+1735328473&4294967295,B=j+(N<<14&4294967295|N>>>18),N=k+(j^C&(B^j))+V[12]+2368359562&4294967295,k=B+(N<<20&4294967295|N>>>12),N=C+(k^B^j)+V[5]+4294588738&4294967295,C=k+(N<<4&4294967295|N>>>28),N=j+(C^k^B)+V[8]+2272392833&4294967295,j=C+(N<<11&4294967295|N>>>21),N=B+(j^C^k)+V[11]+1839030562&4294967295,B=j+(N<<16&4294967295|N>>>16),N=k+(B^j^C)+V[14]+4259657740&4294967295,k=B+(N<<23&4294967295|N>>>9),N=C+(k^B^j)+V[1]+2763975236&4294967295,C=k+(N<<4&4294967295|N>>>28),N=j+(C^k^B)+V[4]+1272893353&4294967295,j=C+(N<<11&4294967295|N>>>21),N=B+(j^C^k)+V[7]+4139469664&4294967295,B=j+(N<<16&4294967295|N>>>16),N=k+(B^j^C)+V[10]+3200236656&4294967295,k=B+(N<<23&4294967295|N>>>9),N=C+(k^B^j)+V[13]+681279174&4294967295,C=k+(N<<4&4294967295|N>>>28),N=j+(C^k^B)+V[0]+3936430074&4294967295,j=C+(N<<11&4294967295|N>>>21),N=B+(j^C^k)+V[3]+3572445317&4294967295,B=j+(N<<16&4294967295|N>>>16),N=k+(B^j^C)+V[6]+76029189&4294967295,k=B+(N<<23&4294967295|N>>>9),N=C+(k^B^j)+V[9]+3654602809&4294967295,C=k+(N<<4&4294967295|N>>>28),N=j+(C^k^B)+V[12]+3873151461&4294967295,j=C+(N<<11&4294967295|N>>>21),N=B+(j^C^k)+V[15]+530742520&4294967295,B=j+(N<<16&4294967295|N>>>16),N=k+(B^j^C)+V[2]+3299628645&4294967295,k=B+(N<<23&4294967295|N>>>9),N=C+(B^(k|~j))+V[0]+4096336452&4294967295,C=k+(N<<6&4294967295|N>>>26),N=j+(k^(C|~B))+V[7]+1126891415&4294967295,j=C+(N<<10&4294967295|N>>>22),N=B+(C^(j|~k))+V[14]+2878612391&4294967295,B=j+(N<<15&4294967295|N>>>17),N=k+(j^(B|~C))+V[5]+4237533241&4294967295,k=B+(N<<21&4294967295|N>>>11),N=C+(B^(k|~j))+V[12]+1700485571&4294967295,C=k+(N<<6&4294967295|N>>>26),N=j+(k^(C|~B))+V[3]+2399980690&4294967295,j=C+(N<<10&4294967295|N>>>22),N=B+(C^(j|~k))+V[10]+4293915773&4294967295,B=j+(N<<15&4294967295|N>>>17),N=k+(j^(B|~C))+V[1]+2240044497&4294967295,k=B+(N<<21&4294967295|N>>>11),N=C+(B^(k|~j))+V[8]+1873313359&4294967295,C=k+(N<<6&4294967295|N>>>26),N=j+(k^(C|~B))+V[15]+4264355552&4294967295,j=C+(N<<10&4294967295|N>>>22),N=B+(C^(j|~k))+V[6]+2734768916&4294967295,B=j+(N<<15&4294967295|N>>>17),N=k+(j^(B|~C))+V[13]+1309151649&4294967295,k=B+(N<<21&4294967295|N>>>11),N=C+(B^(k|~j))+V[4]+4149444226&4294967295,C=k+(N<<6&4294967295|N>>>26),N=j+(k^(C|~B))+V[11]+3174756917&4294967295,j=C+(N<<10&4294967295|N>>>22),N=B+(C^(j|~k))+V[2]+718787259&4294967295,B=j+(N<<15&4294967295|N>>>17),N=k+(j^(B|~C))+V[9]+3951481745&4294967295,A.g[0]=A.g[0]+C&4294967295,A.g[1]=A.g[1]+(B+(N<<21&4294967295|N>>>11))&4294967295,A.g[2]=A.g[2]+B&4294967295,A.g[3]=A.g[3]+j&4294967295}r.prototype.v=function(A,C){C===void 0&&(C=A.length);const k=C-this.blockSize,V=this.C;let B=this.h,j=0;for(;j<C;){if(B==0)for(;j<=k;)i(this,A,j),j+=this.blockSize;if(typeof A=="string"){for(;j<C;)if(V[B++]=A.charCodeAt(j++),B==this.blockSize){i(this,V),B=0;break}}else for(;j<C;)if(V[B++]=A[j++],B==this.blockSize){i(this,V),B=0;break}}this.h=B,this.o+=C},r.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var C=1;C<A.length-8;++C)A[C]=0;C=this.o*8;for(var k=A.length-8;k<A.length;++k)A[k]=C&255,C/=256;for(this.v(A),A=Array(16),C=0,k=0;k<4;++k)for(let V=0;V<32;V+=8)A[C++]=this.g[k]>>>V&255;return A};function a(A,C){var k=c;return Object.prototype.hasOwnProperty.call(k,A)?k[A]:k[A]=C(A)}function o(A,C){this.h=C;const k=[];let V=!0;for(let B=A.length-1;B>=0;B--){const j=A[B]|0;V&&j==C||(k[B]=j,V=!1)}this.g=k}var c={};function u(A){return-128<=A&&A<128?a(A,function(C){return new o([C|0],C<0?-1:0)}):new o([A|0],A<0?-1:0)}function d(A){if(isNaN(A)||!isFinite(A))return p;if(A<0)return E(d(-A));const C=[];let k=1;for(let V=0;A>=k;V++)C[V]=A/k|0,k*=4294967296;return new o(C,0)}function h(A,C){if(A.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(A.charAt(0)=="-")return E(h(A.substring(1),C));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=d(Math.pow(C,8));let V=p;for(let j=0;j<A.length;j+=8){var B=Math.min(8,A.length-j);const N=parseInt(A.substring(j,j+B),C);B<8?(B=d(Math.pow(C,B)),V=V.j(B).add(d(N))):(V=V.j(k),V=V.add(d(N)))}return V}var p=u(0),m=u(1),y=u(16777216);t=o.prototype,t.m=function(){if(w(this))return-E(this).m();let A=0,C=1;for(let k=0;k<this.g.length;k++){const V=this.i(k);A+=(V>=0?V:4294967296+V)*C,C*=4294967296}return A},t.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(_(this))return"0";if(w(this))return"-"+E(this).toString(A);const C=d(Math.pow(A,6));var k=this;let V="";for(;;){const B=O(k,C).g;k=T(k,B.j(C));let j=((k.g.length>0?k.g[0]:k.h)>>>0).toString(A);if(k=B,_(k))return j+V;for(;j.length<6;)j="0"+j;V=j+V}},t.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function _(A){if(A.h!=0)return!1;for(let C=0;C<A.g.length;C++)if(A.g[C]!=0)return!1;return!0}function w(A){return A.h==-1}t.l=function(A){return A=T(this,A),w(A)?-1:_(A)?0:1};function E(A){const C=A.g.length,k=[];for(let V=0;V<C;V++)k[V]=~A.g[V];return new o(k,~A.h).add(m)}t.abs=function(){return w(this)?E(this):this},t.add=function(A){const C=Math.max(this.g.length,A.g.length),k=[];let V=0;for(let B=0;B<=C;B++){let j=V+(this.i(B)&65535)+(A.i(B)&65535),N=(j>>>16)+(this.i(B)>>>16)+(A.i(B)>>>16);V=N>>>16,j&=65535,N&=65535,k[B]=N<<16|j}return new o(k,k[k.length-1]&-2147483648?-1:0)};function T(A,C){return A.add(E(C))}t.j=function(A){if(_(this)||_(A))return p;if(w(this))return w(A)?E(this).j(E(A)):E(E(this).j(A));if(w(A))return E(this.j(E(A)));if(this.l(y)<0&&A.l(y)<0)return d(this.m()*A.m());const C=this.g.length+A.g.length,k=[];for(var V=0;V<2*C;V++)k[V]=0;for(V=0;V<this.g.length;V++)for(let B=0;B<A.g.length;B++){const j=this.i(V)>>>16,N=this.i(V)&65535,K=A.i(B)>>>16,W=A.i(B)&65535;k[2*V+2*B]+=N*W,I(k,2*V+2*B),k[2*V+2*B+1]+=j*W,I(k,2*V+2*B+1),k[2*V+2*B+1]+=N*K,I(k,2*V+2*B+1),k[2*V+2*B+2]+=j*K,I(k,2*V+2*B+2)}for(A=0;A<C;A++)k[A]=k[2*A+1]<<16|k[2*A];for(A=C;A<2*C;A++)k[A]=0;return new o(k,0)};function I(A,C){for(;(A[C]&65535)!=A[C];)A[C+1]+=A[C]>>>16,A[C]&=65535,C++}function D(A,C){this.g=A,this.h=C}function O(A,C){if(_(C))throw Error("division by zero");if(_(A))return new D(p,p);if(w(A))return C=O(E(A),C),new D(E(C.g),E(C.h));if(w(C))return C=O(A,E(C)),new D(E(C.g),C.h);if(A.g.length>30){if(w(A)||w(C))throw Error("slowDivide_ only works with positive integers.");for(var k=m,V=C;V.l(A)<=0;)k=z(k),V=z(V);var B=P(k,1),j=P(V,1);for(V=P(V,2),k=P(k,2);!_(V);){var N=j.add(V);N.l(A)<=0&&(B=B.add(k),j=N),V=P(V,1),k=P(k,1)}return C=T(A,B.j(C)),new D(B,C)}for(B=p;A.l(C)>=0;){for(k=Math.max(1,Math.floor(A.m()/C.m())),V=Math.ceil(Math.log(k)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),j=d(k),N=j.j(C);w(N)||N.l(A)>0;)k-=V,j=d(k),N=j.j(C);_(j)&&(j=m),B=B.add(j),A=T(A,N)}return new D(B,A)}t.B=function(A){return O(this,A).h},t.and=function(A){const C=Math.max(this.g.length,A.g.length),k=[];for(let V=0;V<C;V++)k[V]=this.i(V)&A.i(V);return new o(k,this.h&A.h)},t.or=function(A){const C=Math.max(this.g.length,A.g.length),k=[];for(let V=0;V<C;V++)k[V]=this.i(V)|A.i(V);return new o(k,this.h|A.h)},t.xor=function(A){const C=Math.max(this.g.length,A.g.length),k=[];for(let V=0;V<C;V++)k[V]=this.i(V)^A.i(V);return new o(k,this.h^A.h)};function z(A){const C=A.g.length+1,k=[];for(let V=0;V<C;V++)k[V]=A.i(V)<<1|A.i(V-1)>>>31;return new o(k,A.h)}function P(A,C){const k=C>>5;C%=32;const V=A.g.length-k,B=[];for(let j=0;j<V;j++)B[j]=C>0?A.i(j+k)>>>C|A.i(j+k+1)<<32-C:A.i(j+k);return new o(B,A.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Q4=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,el=o}).apply(typeof fR<"u"?fR:typeof self<"u"?self:typeof window<"u"?window:{});var Lm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Z4,lh,J4,c0,C_,e3,t3,n3;(function(){var t,e=Object.defineProperty;function n(v){v=[typeof globalThis=="object"&&globalThis,v,typeof window=="object"&&window,typeof self=="object"&&self,typeof Lm=="object"&&Lm];for(var R=0;R<v.length;++R){var L=v[R];if(L&&L.Math==Math)return L}throw Error("Cannot find global object")}var r=n(this);function i(v,R){if(R)e:{var L=r;v=v.split(".");for(var q=0;q<v.length-1;q++){var se=v[q];if(!(se in L))break e;L=L[se]}v=v[v.length-1],q=L[v],R=R(q),R!=q&&R!=null&&e(L,v,{configurable:!0,writable:!0,value:R})}}i("Symbol.dispose",function(v){return v||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(v){return v||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(v){return v||function(R){var L=[],q;for(q in R)Object.prototype.hasOwnProperty.call(R,q)&&L.push([q,R[q]]);return L}});var a=a||{},o=this||self;function c(v){var R=typeof v;return R=="object"&&v!=null||R=="function"}function u(v,R,L){return v.call.apply(v.bind,arguments)}function d(v,R,L){return d=u,d.apply(null,arguments)}function h(v,R){var L=Array.prototype.slice.call(arguments,1);return function(){var q=L.slice();return q.push.apply(q,arguments),v.apply(this,q)}}function p(v,R){function L(){}L.prototype=R.prototype,v.Z=R.prototype,v.prototype=new L,v.prototype.constructor=v,v.Ob=function(q,se,fe){for(var Re=Array(arguments.length-2),st=2;st<arguments.length;st++)Re[st-2]=arguments[st];return R.prototype[se].apply(q,Re)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?v=>v&&AsyncContext.Snapshot.wrap(v):v=>v;function y(v){const R=v.length;if(R>0){const L=Array(R);for(let q=0;q<R;q++)L[q]=v[q];return L}return[]}function _(v,R){for(let q=1;q<arguments.length;q++){const se=arguments[q];var L=typeof se;if(L=L!="object"?L:se?Array.isArray(se)?"array":L:"null",L=="array"||L=="object"&&typeof se.length=="number"){L=v.length||0;const fe=se.length||0;v.length=L+fe;for(let Re=0;Re<fe;Re++)v[L+Re]=se[Re]}else v.push(se)}}class w{constructor(R,L){this.i=R,this.j=L,this.h=0,this.g=null}get(){let R;return this.h>0?(this.h--,R=this.g,this.g=R.next,R.next=null):R=this.i(),R}}function E(v){o.setTimeout(()=>{throw v},0)}function T(){var v=A;let R=null;return v.g&&(R=v.g,v.g=v.g.next,v.g||(v.h=null),R.next=null),R}class I{constructor(){this.h=this.g=null}add(R,L){const q=D.get();q.set(R,L),this.h?this.h.next=q:this.g=q,this.h=q}}var D=new w(()=>new O,v=>v.reset());class O{constructor(){this.next=this.g=this.h=null}set(R,L){this.h=R,this.g=L,this.next=null}reset(){this.next=this.g=this.h=null}}let z,P=!1,A=new I,C=()=>{const v=Promise.resolve(void 0);z=()=>{v.then(k)}};function k(){for(var v;v=T();){try{v.h.call(v.g)}catch(L){E(L)}var R=D;R.j(v),R.h<100&&(R.h++,v.next=R.g,R.g=v)}P=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function B(v,R){this.type=v,this.g=this.target=R,this.defaultPrevented=!1}B.prototype.h=function(){this.defaultPrevented=!0};var j=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var v=!1,R=Object.defineProperty({},"passive",{get:function(){v=!0}});try{const L=()=>{};o.addEventListener("test",L,R),o.removeEventListener("test",L,R)}catch{}return v})();function N(v){return/^[\s\xa0]*$/.test(v)}function K(v,R){B.call(this,v?v.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,v&&this.init(v,R)}p(K,B),K.prototype.init=function(v,R){const L=this.type=v.type,q=v.changedTouches&&v.changedTouches.length?v.changedTouches[0]:null;this.target=v.target||v.srcElement,this.g=R,R=v.relatedTarget,R||(L=="mouseover"?R=v.fromElement:L=="mouseout"&&(R=v.toElement)),this.relatedTarget=R,q?(this.clientX=q.clientX!==void 0?q.clientX:q.pageX,this.clientY=q.clientY!==void 0?q.clientY:q.pageY,this.screenX=q.screenX||0,this.screenY=q.screenY||0):(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0),this.button=v.button,this.key=v.key||"",this.ctrlKey=v.ctrlKey,this.altKey=v.altKey,this.shiftKey=v.shiftKey,this.metaKey=v.metaKey,this.pointerId=v.pointerId||0,this.pointerType=v.pointerType,this.state=v.state,this.i=v,v.defaultPrevented&&K.Z.h.call(this)},K.prototype.h=function(){K.Z.h.call(this);const v=this.i;v.preventDefault?v.preventDefault():v.returnValue=!1};var W="closure_listenable_"+(Math.random()*1e6|0),$=0;function H(v,R,L,q,se){this.listener=v,this.proxy=null,this.src=R,this.type=L,this.capture=!!q,this.ha=se,this.key=++$,this.da=this.fa=!1}function te(v){v.da=!0,v.listener=null,v.proxy=null,v.src=null,v.ha=null}function re(v,R,L){for(const q in v)R.call(L,v[q],q,v)}function ue(v,R){for(const L in v)R.call(void 0,v[L],L,v)}function F(v){const R={};for(const L in v)R[L]=v[L];return R}const Q="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Y(v,R){let L,q;for(let se=1;se<arguments.length;se++){q=arguments[se];for(L in q)v[L]=q[L];for(let fe=0;fe<Q.length;fe++)L=Q[fe],Object.prototype.hasOwnProperty.call(q,L)&&(v[L]=q[L])}}function ne(v){this.src=v,this.g={},this.h=0}ne.prototype.add=function(v,R,L,q,se){const fe=v.toString();v=this.g[fe],v||(v=this.g[fe]=[],this.h++);const Re=de(v,R,q,se);return Re>-1?(R=v[Re],L||(R.fa=!1)):(R=new H(R,this.src,fe,!!q,se),R.fa=L,v.push(R)),R};function pe(v,R){const L=R.type;if(L in v.g){var q=v.g[L],se=Array.prototype.indexOf.call(q,R,void 0),fe;(fe=se>=0)&&Array.prototype.splice.call(q,se,1),fe&&(te(R),v.g[L].length==0&&(delete v.g[L],v.h--))}}function de(v,R,L,q){for(let se=0;se<v.length;++se){const fe=v[se];if(!fe.da&&fe.listener==R&&fe.capture==!!L&&fe.ha==q)return se}return-1}var ge="closure_lm_"+(Math.random()*1e6|0),we={};function Te(v,R,L,q,se){if(Array.isArray(R)){for(let fe=0;fe<R.length;fe++)Te(v,R[fe],L,q,se);return null}return L=_t(L),v&&v[W]?v.J(R,L,c(q)?!!q.capture:!1,se):Xe(v,R,L,!1,q,se)}function Xe(v,R,L,q,se,fe){if(!R)throw Error("Invalid event type");const Re=c(se)?!!se.capture:!!se;let st=We(v);if(st||(v[ge]=st=new ne(v)),L=st.add(R,L,q,Re,fe),L.proxy)return L;if(q=Se(),L.proxy=q,q.src=v,q.listener=L,v.addEventListener)j||(se=Re),se===void 0&&(se=!1),v.addEventListener(R.toString(),q,se);else if(v.attachEvent)v.attachEvent(Me(R.toString()),q);else if(v.addListener&&v.removeListener)v.addListener(q);else throw Error("addEventListener and attachEvent are unavailable.");return L}function Se(){function v(L){return R.call(v.src,v.listener,L)}const R=$e;return v}function Ie(v,R,L,q,se){if(Array.isArray(R))for(var fe=0;fe<R.length;fe++)Ie(v,R[fe],L,q,se);else q=c(q)?!!q.capture:!!q,L=_t(L),v&&v[W]?(v=v.i,fe=String(R).toString(),fe in v.g&&(R=v.g[fe],L=de(R,L,q,se),L>-1&&(te(R[L]),Array.prototype.splice.call(R,L,1),R.length==0&&(delete v.g[fe],v.h--)))):v&&(v=We(v))&&(R=v.g[R.toString()],v=-1,R&&(v=de(R,L,q,se)),(L=v>-1?R[v]:null)&&Je(L))}function Je(v){if(typeof v!="number"&&v&&!v.da){var R=v.src;if(R&&R[W])pe(R.i,v);else{var L=v.type,q=v.proxy;R.removeEventListener?R.removeEventListener(L,q,v.capture):R.detachEvent?R.detachEvent(Me(L),q):R.addListener&&R.removeListener&&R.removeListener(q),(L=We(R))?(pe(L,v),L.h==0&&(L.src=null,R[ge]=null)):te(v)}}}function Me(v){return v in we?we[v]:we[v]="on"+v}function $e(v,R){if(v.da)v=!0;else{R=new K(R,this);const L=v.listener,q=v.ha||v.src;v.fa&&Je(v),v=L.call(q,R)}return v}function We(v){return v=v[ge],v instanceof ne?v:null}var pt="__closure_events_fn_"+(Math.random()*1e9>>>0);function _t(v){return typeof v=="function"?v:(v[pt]||(v[pt]=function(R){return v.handleEvent(R)}),v[pt])}function Pe(){V.call(this),this.i=new ne(this),this.M=this,this.G=null}p(Pe,V),Pe.prototype[W]=!0,Pe.prototype.removeEventListener=function(v,R,L,q){Ie(this,v,R,L,q)};function Ue(v,R){var L,q=v.G;if(q)for(L=[];q;q=q.G)L.push(q);if(v=v.M,q=R.type||R,typeof R=="string")R=new B(R,v);else if(R instanceof B)R.target=R.target||v;else{var se=R;R=new B(q,v),Y(R,se)}se=!0;let fe,Re;if(L)for(Re=L.length-1;Re>=0;Re--)fe=R.g=L[Re],se=Pt(fe,q,!0,R)&&se;if(fe=R.g=v,se=Pt(fe,q,!0,R)&&se,se=Pt(fe,q,!1,R)&&se,L)for(Re=0;Re<L.length;Re++)fe=R.g=L[Re],se=Pt(fe,q,!1,R)&&se}Pe.prototype.N=function(){if(Pe.Z.N.call(this),this.i){var v=this.i;for(const R in v.g){const L=v.g[R];for(let q=0;q<L.length;q++)te(L[q]);delete v.g[R],v.h--}}this.G=null},Pe.prototype.J=function(v,R,L,q){return this.i.add(String(v),R,!1,L,q)},Pe.prototype.K=function(v,R,L,q){return this.i.add(String(v),R,!0,L,q)};function Pt(v,R,L,q){if(R=v.i.g[String(R)],!R)return!0;R=R.concat();let se=!0;for(let fe=0;fe<R.length;++fe){const Re=R[fe];if(Re&&!Re.da&&Re.capture==L){const st=Re.listener,Cn=Re.ha||Re.src;Re.fa&&pe(v.i,Re),se=st.call(Cn,q)!==!1&&se}}return se&&!q.defaultPrevented}function yn(v,R){if(typeof v!="function")if(v&&typeof v.handleEvent=="function")v=d(v.handleEvent,v);else throw Error("Invalid listener argument");return Number(R)>2147483647?-1:o.setTimeout(v,R||0)}function Wt(v){v.g=yn(()=>{v.g=null,v.i&&(v.i=!1,Wt(v))},v.l);const R=v.h;v.h=null,v.m.apply(null,R)}class ht extends V{constructor(R,L){super(),this.m=R,this.l=L,this.h=null,this.i=!1,this.g=null}j(R){this.h=arguments,this.g?this.i=!0:Wt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function At(v){V.call(this),this.h=v,this.g={}}p(At,V);var Ft=[];function lr(v){re(v.g,function(R,L){this.g.hasOwnProperty(L)&&Je(R)},v),v.g={}}At.prototype.N=function(){At.Z.N.call(this),lr(this)},At.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Gr=o.JSON.stringify,ls=o.JSON.parse,Zs=class{stringify(v){return o.JSON.stringify(v,void 0)}parse(v){return o.JSON.parse(v,void 0)}};function Si(){}function _r(){}var Nr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function bn(){B.call(this,"d")}p(bn,B);function tr(){B.call(this,"c")}p(tr,B);var Qt={},Js=null;function xa(){return Js=Js||new Pe}Qt.Ia="serverreachability";function _a(v){B.call(this,Qt.Ia,v)}p(_a,B);function ut(v){const R=xa();Ue(R,new _a(R))}Qt.STAT_EVENT="statevent";function Zt(v,R){B.call(this,Qt.STAT_EVENT,v),this.stat=R}p(Zt,B);function Jt(v){const R=xa();Ue(R,new Zt(R,v))}Qt.Ja="timingevent";function Ae(v,R){B.call(this,Qt.Ja,v),this.size=R}p(Ae,B);function je(v,R){if(typeof v!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){v()},R)}function wt(){this.g=!0}wt.prototype.ua=function(){this.g=!1};function rn(v,R,L,q,se,fe){v.info(function(){if(v.g)if(fe){var Re="",st=fe.split("&");for(let Dt=0;Dt<st.length;Dt++){var Cn=st[Dt].split("=");if(Cn.length>1){const sn=Cn[0];Cn=Cn[1];const Ci=sn.split("_");Re=Ci.length>=2&&Ci[1]=="type"?Re+(sn+"="+Cn+"&"):Re+(sn+"=redacted&")}}}else Re=null;else Re=fe;return"XMLHTTP REQ ("+q+") [attempt "+se+"]: "+R+`
`+L+`
`+Re})}function qr(v,R,L,q,se,fe,Re){v.info(function(){return"XMLHTTP RESP ("+q+") [ attempt "+se+"]: "+R+`
`+L+`
`+fe+" "+Re})}function cr(v,R,L,q){v.info(function(){return"XMLHTTP TEXT ("+R+"): "+Nt(v,L)+(q?" "+q:"")})}function wr(v,R){v.info(function(){return"TIMEOUT: "+R})}wt.prototype.info=function(){};function Nt(v,R){if(!v.g)return R;if(!R)return null;try{const fe=JSON.parse(R);if(fe){for(v=0;v<fe.length;v++)if(Array.isArray(fe[v])){var L=fe[v];if(!(L.length<2)){var q=L[1];if(Array.isArray(q)&&!(q.length<1)){var se=q[0];if(se!="noop"&&se!="stop"&&se!="close")for(let Re=1;Re<q.length;Re++)q[Re]=""}}}}return Gr(fe)}catch{return R}}var Ot={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},an={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},nr;function Hr(){}p(Hr,Si),Hr.prototype.g=function(){return new XMLHttpRequest},nr=new Hr;function $n(v){return encodeURIComponent(String(v))}function Nn(v){var R=1;v=v.split(":");const L=[];for(;R>0&&v.length;)L.push(v.shift()),R--;return v.length&&L.push(v.join(":")),L}function Yn(v,R,L,q){this.j=v,this.i=R,this.l=L,this.S=q||1,this.V=new At(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new rr}function rr(){this.i=null,this.g="",this.h=!1}var dn={},fn={};function $r(v,R,L){v.M=1,v.A=xl(Pn(R)),v.u=L,v.R=!0,Zi(v,null)}function Zi(v,R){v.F=Date.now(),wa(v),v.B=Pn(v.A);var L=v.B,q=v.S;Array.isArray(q)||(q=[String(q)]),Gc(L.i,"t",q),v.C=0,L=v.j.L,v.h=new rr,v.g=ug(v.j,L?R:null,!v.u),v.P>0&&(v.O=new ht(d(v.Y,v,v.g),v.P)),R=v.V,L=v.g,q=v.ba;var se="readystatechange";Array.isArray(se)||(se&&(Ft[0]=se.toString()),se=Ft);for(let fe=0;fe<se.length;fe++){const Re=Te(L,se[fe],q||R.handleEvent,!1,R.h||R);if(!Re)break;R.g[Re.key]=Re}R=v.J?F(v.J):{},v.u?(v.v||(v.v="POST"),R["Content-Type"]="application/x-www-form-urlencoded",v.g.ea(v.B,v.v,v.u,R)):(v.v="GET",v.g.ea(v.B,v.v,null,R)),ut(),rn(v.i,v.v,v.B,v.l,v.S,v.u)}Yn.prototype.ba=function(v){v=v.target;const R=this.O;R&&ta(v)==3?R.j():this.Y(v)},Yn.prototype.Y=function(v){try{if(v==this.g)e:{const st=ta(this.g),Cn=this.g.ya(),Dt=this.g.ca();if(!(st<3)&&(st!=3||this.g&&(this.h.h||this.g.la()||ur(this.g)))){this.K||st!=4||Cn==7||(Cn==8||Dt<=0?ut(3):ut(2)),Sa(this);var R=this.g.ca();this.X=R;var L=vy(this);if(this.o=R==200,qr(this.i,this.v,this.B,this.l,this.S,st,R),this.o){if(this.U&&!this.L){t:{if(this.g){var q,se=this.g;if((q=se.g?se.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(q)){var fe=q;break t}}fe=null}if(v=fe)cr(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ea(this,v);else{this.o=!1,this.m=3,Jt(12),li(this),Ei(this);break e}}if(this.R){v=!0;let sn;for(;!this.K&&this.C<L.length;)if(sn=Qp(this,L),sn==fn){st==4&&(this.m=4,Jt(14),v=!1),cr(this.i,this.l,null,"[Incomplete Response]");break}else if(sn==dn){this.m=4,Jt(15),cr(this.i,this.l,L,"[Invalid Chunk]"),v=!1;break}else cr(this.i,this.l,sn,null),Ea(this,sn);if(Wp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),st!=4||L.length!=0||this.h.h||(this.m=1,Jt(16),v=!1),this.o=this.o&&v,!v)cr(this.i,this.l,L,"[Invalid Chunked Response]"),li(this),Ei(this);else if(L.length>0&&!this.W){this.W=!0;var Re=this.j;Re.g==this&&Re.aa&&!Re.P&&(Re.j.info("Great, no buffering proxy detected. Bytes received: "+L.length),cf(Re),Re.P=!0,Jt(11))}}else cr(this.i,this.l,L,null),Ea(this,L);st==4&&li(this),this.o&&!this.K&&(st==4?sg(this.j,this):(this.o=!1,wa(this)))}else us(this.g),R==400&&L.indexOf("Unknown SID")>0?(this.m=3,Jt(12)):(this.m=0,Jt(13)),li(this),Ei(this)}}}catch{}finally{}};function vy(v){if(!Wp(v))return v.g.la();const R=ur(v.g);if(R==="")return"";let L="";const q=R.length,se=ta(v.g)==4;if(!v.h.i){if(typeof TextDecoder>"u")return li(v),Ei(v),"";v.h.i=new o.TextDecoder}for(let fe=0;fe<q;fe++)v.h.h=!0,L+=v.h.i.decode(R[fe],{stream:!(se&&fe==q-1)});return R.length=0,v.h.g+=L,v.C=0,v.h.g}function Wp(v){return v.g?v.v=="GET"&&v.M!=2&&v.j.Aa:!1}function Qp(v,R){var L=v.C,q=R.indexOf(`
`,L);return q==-1?fn:(L=Number(R.substring(L,q)),isNaN(L)?dn:(q+=1,q+L>R.length?fn:(R=R.slice(q,q+L),v.C=q+L,R)))}Yn.prototype.cancel=function(){this.K=!0,li(this)};function wa(v){v.T=Date.now()+v.H,Bc(v,v.H)}function Bc(v,R){if(v.D!=null)throw Error("WatchDog timer not null");v.D=je(d(v.aa,v),R)}function Sa(v){v.D&&(o.clearTimeout(v.D),v.D=null)}Yn.prototype.aa=function(){this.D=null;const v=Date.now();v-this.T>=0?(wr(this.i,this.B),this.M!=2&&(ut(),Jt(17)),li(this),this.m=2,Ei(this)):Bc(this,this.T-v)};function Ei(v){v.j.I==0||v.K||sg(v.j,v)}function li(v){Sa(v);var R=v.O;R&&typeof R.dispose=="function"&&R.dispose(),v.O=null,lr(v.V),v.g&&(R=v.g,v.g=null,R.abort(),R.dispose())}function Ea(v,R){try{var L=v.j;if(L.I!=0&&(L.g==v||Aa(L.h,v))){if(!v.L&&Aa(L.h,v)&&L.I==3){try{var q=L.Ba.g.parse(R)}catch{q=null}if(Array.isArray(q)&&q.length==3){var se=q;if(se[0]==0){e:if(!L.v){if(L.g)if(L.g.F+3e3<v.F)Kc(L),oo(L);else break e;Cl(L),Jt(18)}}else L.xa=se[1],0<L.xa-L.K&&se[2]<37500&&L.F&&L.A==0&&!L.C&&(L.C=je(d(L.Va,L),6e3));Ta(L.h)<=1&&L.ta&&(L.ta=void 0)}else Na(L,11)}else if((v.L||L.g==v)&&Kc(L),!N(R))for(se=L.Ba.g.parse(R),R=0;R<se.length;R++){let Dt=se[R];const sn=Dt[0];if(!(sn<=L.K))if(L.K=sn,Dt=Dt[1],L.I==2)if(Dt[0]=="c"){L.M=Dt[1],L.ba=Dt[2];const Ci=Dt[3];Ci!=null&&(L.ka=Ci,L.j.info("VER="+L.ka));const Ma=Dt[4];Ma!=null&&(L.za=Ma,L.j.info("SVER="+L.za));const na=Dt[5];na!=null&&typeof na=="number"&&na>0&&(q=1.5*na,L.O=q,L.j.info("backChannelRequestTimeoutMs_="+q)),q=L;const ra=v.g;if(ra){const Il=ra.g?ra.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Il){var fe=q.h;fe.g||Il.indexOf("spdy")==-1&&Il.indexOf("quic")==-1&&Il.indexOf("h2")==-1||(fe.j=fe.l,fe.g=new Set,fe.h&&(Wd(fe,fe.h),fe.h=null))}if(q.G){const Xc=ra.g?ra.g.getResponseHeader("X-HTTP-Session-Id"):null;Xc&&(q.wa=Xc,Vt(q.J,q.G,Xc))}}L.I=3,L.l&&L.l.ra(),L.aa&&(L.T=Date.now()-v.F,L.j.info("Handshake RTT: "+L.T+"ms")),q=L;var Re=v;if(q.na=cg(q,q.L?q.ba:null,q.W),Re.L){Qd(q.h,Re);var st=Re,Cn=q.O;Cn&&(st.H=Cn),st.D&&(Sa(st),wa(st)),q.g=Re}else ig(q);L.i.length>0&&ka(L)}else Dt[0]!="stop"&&Dt[0]!="close"||Na(L,7);else L.I==3&&(Dt[0]=="stop"||Dt[0]=="close"?Dt[0]=="stop"?Na(L,7):of(L):Dt[0]!="noop"&&L.l&&L.l.qa(Dt),L.A=0)}}ut(4)}catch{}}var Mn=class{constructor(v,R){this.g=v,this.map=R}};function Kd(v){this.l=v||10,o.PerformanceNavigationTiming?(v=o.performance.getEntriesByType("navigation"),v=v.length>0&&(v[0].nextHopProtocol=="hq"||v[0].nextHopProtocol=="h2")):v=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=v?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Xd(v){return v.h?!0:v.g?v.g.size>=v.j:!1}function Ta(v){return v.h?1:v.g?v.g.size:0}function Aa(v,R){return v.h?v.h==R:v.g?v.g.has(R):!1}function Wd(v,R){v.g?v.g.add(R):v.h=R}function Qd(v,R){v.h&&v.h==R?v.h=null:v.g&&v.g.has(R)&&v.g.delete(R)}Kd.prototype.cancel=function(){if(this.i=Zd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const v of this.g.values())v.cancel();this.g.clear()}};function Zd(v){if(v.h!=null)return v.i.concat(v.h.G);if(v.g!=null&&v.g.size!==0){let R=v.i;for(const L of v.g.values())R=R.concat(L.G);return R}return y(v.i)}var Zp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Fc(v,R){if(v){v=v.split("&");for(let L=0;L<v.length;L++){const q=v[L].indexOf("=");let se,fe=null;q>=0?(se=v[L].substring(0,q),fe=v[L].substring(q+1)):se=v[L],R(se,fe?decodeURIComponent(fe.replace(/\+/g," ")):"")}}}function ci(v){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let R;v instanceof ci?(this.l=v.l,ir(this,v.j),this.o=v.o,this.g=v.g,eo(this,v.u),this.h=v.h,Jd(this,ng(v.i)),this.m=v.m):v&&(R=String(v).match(Zp))?(this.l=!1,ir(this,R[1]||"",!0),this.o=Ca(R[2]||""),this.g=Ca(R[3]||"",!0),eo(this,R[4]),this.h=Ca(R[5]||"",!0),Jd(this,R[6]||"",!0),this.m=Ca(R[7]||"")):(this.l=!1,this.i=new no(null,this.l))}ci.prototype.toString=function(){const v=[];var R=this.j;R&&v.push(_l(R,Uc,!0),":");var L=this.g;return(L||R=="file")&&(v.push("//"),(R=this.o)&&v.push(_l(R,Uc,!0),"@"),v.push($n(L).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),L=this.u,L!=null&&v.push(":",String(L))),(L=this.h)&&(this.g&&L.charAt(0)!="/"&&v.push("/"),v.push(_l(L,L.charAt(0)=="/"?ef:Jp,!0))),(L=this.i.toString())&&v.push("?",L),(L=this.m)&&v.push("#",_l(L,eg)),v.join("")},ci.prototype.resolve=function(v){const R=Pn(this);let L=!!v.j;L?ir(R,v.j):L=!!v.o,L?R.o=v.o:L=!!v.g,L?R.g=v.g:L=v.u!=null;var q=v.h;if(L)eo(R,v.u);else if(L=!!v.h){if(q.charAt(0)!="/")if(this.g&&!this.h)q="/"+q;else{var se=R.h.lastIndexOf("/");se!=-1&&(q=R.h.slice(0,se+1)+q)}if(se=q,se==".."||se==".")q="";else if(se.indexOf("./")!=-1||se.indexOf("/.")!=-1){q=se.lastIndexOf("/",0)==0,se=se.split("/");const fe=[];for(let Re=0;Re<se.length;){const st=se[Re++];st=="."?q&&Re==se.length&&fe.push(""):st==".."?((fe.length>1||fe.length==1&&fe[0]!="")&&fe.pop(),q&&Re==se.length&&fe.push("")):(fe.push(st),q=!0)}q=fe.join("/")}else q=se}return L?R.h=q:L=v.i.toString()!=="",L?Jd(R,ng(v.i)):L=!!v.m,L&&(R.m=v.m),R};function Pn(v){return new ci(v)}function ir(v,R,L){v.j=L?Ca(R,!0):R,v.j&&(v.j=v.j.replace(/:$/,""))}function eo(v,R){if(R){if(R=Number(R),isNaN(R)||R<0)throw Error("Bad port number "+R);v.u=R}else v.u=null}function Jd(v,R,L){R instanceof no?(v.i=R,qc(v.i,v.l)):(L||(R=_l(R,to)),v.i=new no(R,v.l))}function Vt(v,R,L){v.i.set(R,L)}function xl(v){return Vt(v,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),v}function Ca(v,R){return v?R?decodeURI(v.replace(/%25/g,"%2525")):decodeURIComponent(v):""}function _l(v,R,L){return typeof v=="string"?(v=encodeURI(v).replace(R,Yr),L&&(v=v.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v):null}function Yr(v){return v=v.charCodeAt(0),"%"+(v>>4&15).toString(16)+(v&15).toString(16)}var Uc=/[#\/\?@]/g,Jp=/[#\?:]/g,ef=/[#\?]/g,to=/[#\?@]/g,eg=/#/g;function no(v,R){this.h=this.g=null,this.i=v||null,this.j=!!R}function Kr(v){v.g||(v.g=new Map,v.h=0,v.i&&Fc(v.i,function(R,L){v.add(decodeURIComponent(R.replace(/\+/g," ")),L)}))}t=no.prototype,t.add=function(v,R){Kr(this),this.i=null,v=ro(this,v);let L=this.g.get(v);return L||this.g.set(v,L=[]),L.push(R),this.h+=1,this};function tg(v,R){Kr(v),R=ro(v,R),v.g.has(R)&&(v.i=null,v.h-=v.g.get(R).length,v.g.delete(R))}function tf(v,R){return Kr(v),R=ro(v,R),v.g.has(R)}t.forEach=function(v,R){Kr(this),this.g.forEach(function(L,q){L.forEach(function(se){v.call(R,se,q,this)},this)},this)};function nf(v,R){Kr(v);let L=[];if(typeof R=="string")tf(v,R)&&(L=L.concat(v.g.get(ro(v,R))));else for(v=Array.from(v.g.values()),R=0;R<v.length;R++)L=L.concat(v[R]);return L}t.set=function(v,R){return Kr(this),this.i=null,v=ro(this,v),tf(this,v)&&(this.h-=this.g.get(v).length),this.g.set(v,[R]),this.h+=1,this},t.get=function(v,R){return v?(v=nf(this,v),v.length>0?String(v[0]):R):R};function Gc(v,R,L){tg(v,R),L.length>0&&(v.i=null,v.g.set(ro(v,R),y(L)),v.h+=L.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const v=[],R=Array.from(this.g.keys());for(let q=0;q<R.length;q++){var L=R[q];const se=$n(L);L=nf(this,L);for(let fe=0;fe<L.length;fe++){let Re=se;L[fe]!==""&&(Re+="="+$n(L[fe])),v.push(Re)}}return this.i=v.join("&")};function ng(v){const R=new no;return R.i=v.i,v.g&&(R.g=new Map(v.g),R.h=v.h),R}function ro(v,R){return R=String(R),v.j&&(R=R.toLowerCase()),R}function qc(v,R){R&&!v.j&&(Kr(v),v.i=null,v.g.forEach(function(L,q){const se=q.toLowerCase();q!=se&&(tg(this,q),Gc(this,se,L))},v)),v.j=R}function Ji(v,R){const L=new wt;if(o.Image){const q=new Image;q.onload=h(Ti,L,"TestLoadImage: loaded",!0,R,q),q.onerror=h(Ti,L,"TestLoadImage: error",!1,R,q),q.onabort=h(Ti,L,"TestLoadImage: abort",!1,R,q),q.ontimeout=h(Ti,L,"TestLoadImage: timeout",!1,R,q),o.setTimeout(function(){q.ontimeout&&q.ontimeout()},1e4),q.src=v}else R(!1)}function rf(v,R){const L=new wt,q=new AbortController,se=setTimeout(()=>{q.abort(),Ti(L,"TestPingServer: timeout",!1,R)},1e4);fetch(v,{signal:q.signal}).then(fe=>{clearTimeout(se),fe.ok?Ti(L,"TestPingServer: ok",!0,R):Ti(L,"TestPingServer: server error",!1,R)}).catch(()=>{clearTimeout(se),Ti(L,"TestPingServer: error",!1,R)})}function Ti(v,R,L,q,se){try{se&&(se.onload=null,se.onerror=null,se.onabort=null,se.ontimeout=null),q(L)}catch{}}function io(){this.g=new Zs}function Ia(v){this.i=v.Sb||null,this.h=v.ab||!1}p(Ia,Si),Ia.prototype.g=function(){return new wl(this.i,this.h)};function wl(v,R){Pe.call(this),this.H=v,this.o=R,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(wl,Pe),t=wl.prototype,t.open=function(v,R){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=v,this.D=R,this.readyState=1,ea(this)},t.send=function(v){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const R={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};v&&(R.body=v),(this.H||o).fetch(new Request(this.D,R)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ao(this)),this.readyState=0},t.Pa=function(v){if(this.g&&(this.l=v,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=v.headers,this.readyState=2,ea(this)),this.g&&(this.readyState=3,ea(this),this.g)))if(this.responseType==="arraybuffer")v.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in v){if(this.j=v.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Hc(this)}else v.text().then(this.Oa.bind(this),this.ga.bind(this))};function Hc(v){v.j.read().then(v.Ma.bind(v)).catch(v.ga.bind(v))}t.Ma=function(v){if(this.g){if(this.o&&v.value)this.response.push(v.value);else if(!this.o){var R=v.value?v.value:new Uint8Array(0);(R=this.B.decode(R,{stream:!v.done}))&&(this.response=this.responseText+=R)}v.done?ao(this):ea(this),this.readyState==3&&Hc(this)}},t.Oa=function(v){this.g&&(this.response=this.responseText=v,ao(this))},t.Na=function(v){this.g&&(this.response=v,ao(this))},t.ga=function(){this.g&&ao(this)};function ao(v){v.readyState=4,v.l=null,v.j=null,v.B=null,ea(v)}t.setRequestHeader=function(v,R){this.A.append(v,R)},t.getResponseHeader=function(v){return this.h&&this.h.get(v.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const v=[],R=this.h.entries();for(var L=R.next();!L.done;)L=L.value,v.push(L[0]+": "+L[1]),L=R.next();return v.join(`\r
`)};function ea(v){v.onreadystatechange&&v.onreadystatechange.call(v)}Object.defineProperty(wl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(v){this.m=v?"include":"same-origin"}});function Ai(v){let R="";return re(v,function(L,q){R+=q,R+=":",R+=L,R+=`\r
`}),R}function Sl(v,R,L){e:{for(q in L){var q=!1;break e}q=!0}q||(L=Ai(L),typeof v=="string"?L!=null&&$n(L):Vt(v,R,L))}function Ut(v){Pe.call(this),this.headers=new Map,this.L=v||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(Ut,Pe);var Da=/^https?$/i,af=["POST","PUT"];t=Ut.prototype,t.Fa=function(v){this.H=v},t.ea=function(v,R,L,q){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+v);R=R?R.toUpperCase():"GET",this.D=v,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():nr.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(R,String(v),!0),this.B=!1}catch(fe){El(this,fe);return}if(v=L||"",L=new Map(this.headers),q)if(Object.getPrototypeOf(q)===Object.prototype)for(var se in q)L.set(se,q[se]);else if(typeof q.keys=="function"&&typeof q.get=="function")for(const fe of q.keys())L.set(fe,q.get(fe));else throw Error("Unknown input type for opt_headers: "+String(q));q=Array.from(L.keys()).find(fe=>fe.toLowerCase()=="content-type"),se=o.FormData&&v instanceof o.FormData,!(Array.prototype.indexOf.call(af,R,void 0)>=0)||q||se||L.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[fe,Re]of L)this.g.setRequestHeader(fe,Re);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(v),this.v=!1}catch(fe){El(this,fe)}};function El(v,R){v.h=!1,v.g&&(v.j=!0,v.g.abort(),v.j=!1),v.l=R,v.o=5,sf(v),cs(v)}function sf(v){v.A||(v.A=!0,Ue(v,"complete"),Ue(v,"error"))}t.abort=function(v){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=v||7,Ue(this,"complete"),Ue(this,"abort"),cs(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),cs(this,!0)),Ut.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Tl(this):this.Xa())},t.Xa=function(){Tl(this)};function Tl(v){if(v.h&&typeof a<"u"){if(v.v&&ta(v)==4)setTimeout(v.Ca.bind(v),0);else if(Ue(v,"readystatechange"),ta(v)==4){v.h=!1;try{const fe=v.ca();e:switch(fe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var R=!0;break e;default:R=!1}var L;if(!(L=R)){var q;if(q=fe===0){let Re=String(v.D).match(Zp)[1]||null;!Re&&o.self&&o.self.location&&(Re=o.self.location.protocol.slice(0,-1)),q=!Da.test(Re?Re.toLowerCase():"")}L=q}if(L)Ue(v,"complete"),Ue(v,"success");else{v.o=6;try{var se=ta(v)>2?v.g.statusText:""}catch{se=""}v.l=se+" ["+v.ca()+"]",sf(v)}}finally{cs(v)}}}}function cs(v,R){if(v.g){v.m&&(clearTimeout(v.m),v.m=null);const L=v.g;v.g=null,R||Ue(v,"ready");try{L.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function ta(v){return v.g?v.g.readyState:0}t.ca=function(){try{return ta(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(v){if(this.g){var R=this.g.responseText;return v&&R.indexOf(v)==0&&(R=R.substring(v.length)),ls(R)}};function ur(v){try{if(!v.g)return null;if("response"in v.g)return v.g.response;switch(v.F){case"":case"text":return v.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in v.g)return v.g.mozResponseArrayBuffer}return null}catch{return null}}function us(v){const R={};v=(v.g&&ta(v)>=2&&v.g.getAllResponseHeaders()||"").split(`\r
`);for(let q=0;q<v.length;q++){if(N(v[q]))continue;var L=Nn(v[q]);const se=L[0];if(L=L[1],typeof L!="string")continue;L=L.trim();const fe=R[se]||[];R[se]=fe,fe.push(L)}ue(R,function(q){return q.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ra(v,R,L){return L&&L.internalChannelParams&&L.internalChannelParams[v]||R}function so(v){this.za=0,this.i=[],this.j=new wt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ra("failFast",!1,v),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ra("baseRetryDelayMs",5e3,v),this.Za=Ra("retryDelaySeedMs",1e4,v),this.Ta=Ra("forwardChannelMaxRetries",2,v),this.va=Ra("forwardChannelRequestTimeoutMs",2e4,v),this.ma=v&&v.xmlHttpFactory||void 0,this.Ua=v&&v.Rb||void 0,this.Aa=v&&v.useFetchStreams||!1,this.O=void 0,this.L=v&&v.supportsCrossDomainXhr||!1,this.M="",this.h=new Kd(v&&v.concurrentRequestLimit),this.Ba=new io,this.S=v&&v.fastHandshake||!1,this.R=v&&v.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=v&&v.Pb||!1,v&&v.ua&&this.j.ua(),v&&v.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&v&&v.detectBufferingProxy||!1,this.ia=void 0,v&&v.longPollingTimeout&&v.longPollingTimeout>0&&(this.ia=v.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=so.prototype,t.ka=8,t.I=1,t.connect=function(v,R,L,q){Jt(0),this.W=v,this.H=R||{},L&&q!==void 0&&(this.H.OSID=L,this.H.OAID=q),this.F=this.X,this.J=cg(this,null,this.W),ka(this)};function of(v){if($c(v),v.I==3){var R=v.V++,L=Pn(v.J);if(Vt(L,"SID",v.M),Vt(L,"RID",R),Vt(L,"TYPE","terminate"),Al(v,L),R=new Yn(v,v.j,R),R.M=2,R.A=xl(Pn(L)),L=!1,o.navigator&&o.navigator.sendBeacon)try{L=o.navigator.sendBeacon(R.A.toString(),"")}catch{}!L&&o.Image&&(new Image().src=R.A,L=!0),L||(R.g=ug(R.j,null),R.g.ea(R.A)),R.F=Date.now(),wa(R)}lg(v)}function oo(v){v.g&&(cf(v),v.g.cancel(),v.g=null)}function $c(v){oo(v),v.v&&(o.clearTimeout(v.v),v.v=null),Kc(v),v.h.cancel(),v.m&&(typeof v.m=="number"&&o.clearTimeout(v.m),v.m=null)}function ka(v){if(!Xd(v.h)&&!v.m){v.m=!0;var R=v.Ea;z||C(),P||(z(),P=!0),A.add(R,v),v.D=0}}function Yc(v,R){return Ta(v.h)>=v.h.j-(v.m?1:0)?!1:v.m?(v.i=R.G.concat(v.i),!0):v.I==1||v.I==2||v.D>=(v.Sa?0:v.Ta)?!1:(v.m=je(d(v.Ea,v,R),og(v,v.D)),v.D++,!0)}t.Ea=function(v){if(this.m)if(this.m=null,this.I==1){if(!v){this.V=Math.floor(Math.random()*1e5),v=this.V++;const se=new Yn(this,this.j,v);let fe=this.o;if(this.U&&(fe?(fe=F(fe),Y(fe,this.U)):fe=this.U),this.u!==null||this.R||(se.J=fe,fe=null),this.S)e:{for(var R=0,L=0;L<this.i.length;L++){t:{var q=this.i[L];if("__data__"in q.map&&(q=q.map.__data__,typeof q=="string")){q=q.length;break t}q=void 0}if(q===void 0)break;if(R+=q,R>4096){R=L;break e}if(R===4096||L===this.i.length-1){R=L+1;break e}}R=1e3}else R=1e3;R=rg(this,se,R),L=Pn(this.J),Vt(L,"RID",v),Vt(L,"CVER",22),this.G&&Vt(L,"X-HTTP-Session-Id",this.G),Al(this,L),fe&&(this.R?R="headers="+$n(Ai(fe))+"&"+R:this.u&&Sl(L,this.u,fe)),Wd(this.h,se),this.Ra&&Vt(L,"TYPE","init"),this.S?(Vt(L,"$req",R),Vt(L,"SID","null"),se.U=!0,$r(se,L,null)):$r(se,L,R),this.I=2}}else this.I==3&&(v?lf(this,v):this.i.length==0||Xd(this.h)||lf(this))};function lf(v,R){var L;R?L=R.l:L=v.V++;const q=Pn(v.J);Vt(q,"SID",v.M),Vt(q,"RID",L),Vt(q,"AID",v.K),Al(v,q),v.u&&v.o&&Sl(q,v.u,v.o),L=new Yn(v,v.j,L,v.D+1),v.u===null&&(L.J=v.o),R&&(v.i=R.G.concat(v.i)),R=rg(v,L,1e3),L.H=Math.round(v.va*.5)+Math.round(v.va*.5*Math.random()),Wd(v.h,L),$r(L,q,R)}function Al(v,R){v.H&&re(v.H,function(L,q){Vt(R,q,L)}),v.l&&re({},function(L,q){Vt(R,q,L)})}function rg(v,R,L){L=Math.min(v.i.length,L);const q=v.l?d(v.l.Ka,v.l,v):null;e:{var se=v.i;let st=-1;for(;;){const Cn=["count="+L];st==-1?L>0?(st=se[0].g,Cn.push("ofs="+st)):st=0:Cn.push("ofs="+st);let Dt=!0;for(let sn=0;sn<L;sn++){var fe=se[sn].g;const Ci=se[sn].map;if(fe-=st,fe<0)st=Math.max(0,se[sn].g-100),Dt=!1;else try{fe="req"+fe+"_"||"";try{var Re=Ci instanceof Map?Ci:Object.entries(Ci);for(const[Ma,na]of Re){let ra=na;c(na)&&(ra=Gr(na)),Cn.push(fe+Ma+"="+encodeURIComponent(ra))}}catch(Ma){throw Cn.push(fe+"type="+encodeURIComponent("_badmap")),Ma}}catch{q&&q(Ci)}}if(Dt){Re=Cn.join("&");break e}}Re=void 0}return v=v.i.splice(0,L),R.G=v,Re}function ig(v){if(!v.g&&!v.v){v.Y=1;var R=v.Da;z||C(),P||(z(),P=!0),A.add(R,v),v.A=0}}function Cl(v){return v.g||v.v||v.A>=3?!1:(v.Y++,v.v=je(d(v.Da,v),og(v,v.A)),v.A++,!0)}t.Da=function(){if(this.v=null,ag(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var v=4*this.T;this.j.info("BP detection timer enabled: "+v),this.B=je(d(this.Wa,this),v)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Jt(10),oo(this),ag(this))};function cf(v){v.B!=null&&(o.clearTimeout(v.B),v.B=null)}function ag(v){v.g=new Yn(v,v.j,"rpc",v.Y),v.u===null&&(v.g.J=v.o),v.g.P=0;var R=Pn(v.na);Vt(R,"RID","rpc"),Vt(R,"SID",v.M),Vt(R,"AID",v.K),Vt(R,"CI",v.F?"0":"1"),!v.F&&v.ia&&Vt(R,"TO",v.ia),Vt(R,"TYPE","xmlhttp"),Al(v,R),v.u&&v.o&&Sl(R,v.u,v.o),v.O&&(v.g.H=v.O);var L=v.g;v=v.ba,L.M=1,L.A=xl(Pn(R)),L.u=null,L.R=!0,Zi(L,v)}t.Va=function(){this.C!=null&&(this.C=null,oo(this),Cl(this),Jt(19))};function Kc(v){v.C!=null&&(o.clearTimeout(v.C),v.C=null)}function sg(v,R){var L=null;if(v.g==R){Kc(v),cf(v),v.g=null;var q=2}else if(Aa(v.h,R))L=R.G,Qd(v.h,R),q=1;else return;if(v.I!=0){if(R.o)if(q==1){L=R.u?R.u.length:0,R=Date.now()-R.F;var se=v.D;q=xa(),Ue(q,new Ae(q,L)),ka(v)}else ig(v);else if(se=R.m,se==3||se==0&&R.X>0||!(q==1&&Yc(v,R)||q==2&&Cl(v)))switch(L&&L.length>0&&(R=v.h,R.i=R.i.concat(L)),se){case 1:Na(v,5);break;case 4:Na(v,10);break;case 3:Na(v,6);break;default:Na(v,2)}}}function og(v,R){let L=v.Qa+Math.floor(Math.random()*v.Za);return v.isActive()||(L*=2),L*R}function Na(v,R){if(v.j.info("Error code "+R),R==2){var L=d(v.bb,v),q=v.Ua;const se=!q;q=new ci(q||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ir(q,"https"),xl(q),se?Ji(q.toString(),L):rf(q.toString(),L)}else Jt(2);v.I=0,v.l&&v.l.pa(R),lg(v),$c(v)}t.bb=function(v){v?(this.j.info("Successfully pinged google.com"),Jt(2)):(this.j.info("Failed to ping google.com"),Jt(1))};function lg(v){if(v.I=0,v.ja=[],v.l){const R=Zd(v.h);(R.length!=0||v.i.length!=0)&&(_(v.ja,R),_(v.ja,v.i),v.h.i.length=0,y(v.i),v.i.length=0),v.l.oa()}}function cg(v,R,L){var q=L instanceof ci?Pn(L):new ci(L);if(q.g!="")R&&(q.g=R+"."+q.g),eo(q,q.u);else{var se=o.location;q=se.protocol,R=R?R+"."+se.hostname:se.hostname,se=+se.port;const fe=new ci(null);q&&ir(fe,q),R&&(fe.g=R),se&&eo(fe,se),L&&(fe.h=L),q=fe}return L=v.G,R=v.wa,L&&R&&Vt(q,L,R),Vt(q,"VER",v.ka),Al(v,q),q}function ug(v,R,L){if(R&&!v.L)throw Error("Can't create secondary domain capable XhrIo object.");return R=v.Aa&&!v.ma?new Ut(new Ia({ab:L})):new Ut(v.ma),R.Fa(v.L),R}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function dg(){}t=dg.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function lo(){}lo.prototype.g=function(v,R){return new Mr(v,R)};function Mr(v,R){Pe.call(this),this.g=new so(R),this.l=v,this.h=R&&R.messageUrlParams||null,v=R&&R.messageHeaders||null,R&&R.clientProtocolHeaderRequired&&(v?v["X-Client-Protocol"]="webchannel":v={"X-Client-Protocol":"webchannel"}),this.g.o=v,v=R&&R.initMessageHeaders||null,R&&R.messageContentType&&(v?v["X-WebChannel-Content-Type"]=R.messageContentType:v={"X-WebChannel-Content-Type":R.messageContentType}),R&&R.sa&&(v?v["X-WebChannel-Client-Profile"]=R.sa:v={"X-WebChannel-Client-Profile":R.sa}),this.g.U=v,(v=R&&R.Qb)&&!N(v)&&(this.g.u=v),this.A=R&&R.supportsCrossDomainXhr||!1,this.v=R&&R.sendRawJson||!1,(R=R&&R.httpSessionIdParam)&&!N(R)&&(this.g.G=R,v=this.h,v!==null&&R in v&&(v=this.h,R in v&&delete v[R])),this.j=new ds(this)}p(Mr,Pe),Mr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Mr.prototype.close=function(){of(this.g)},Mr.prototype.o=function(v){var R=this.g;if(typeof v=="string"){var L={};L.__data__=v,v=L}else this.v&&(L={},L.__data__=Gr(v),v=L);R.i.push(new Mn(R.Ya++,v)),R.I==3&&ka(R)},Mr.prototype.N=function(){this.g.l=null,delete this.j,of(this.g),delete this.g,Mr.Z.N.call(this)};function fg(v){bn.call(this),v.__headers__&&(this.headers=v.__headers__,this.statusCode=v.__status__,delete v.__headers__,delete v.__status__);var R=v.__sm__;if(R){e:{for(const L in R){v=L;break e}v=void 0}(this.i=v)&&(v=this.i,R=R!==null&&v in R?R[v]:void 0),this.data=R}else this.data=v}p(fg,bn);function hg(){tr.call(this),this.status=1}p(hg,tr);function ds(v){this.g=v}p(ds,dg),ds.prototype.ra=function(){Ue(this.g,"a")},ds.prototype.qa=function(v){Ue(this.g,new fg(v))},ds.prototype.pa=function(v){Ue(this.g,new hg)},ds.prototype.oa=function(){Ue(this.g,"b")},lo.prototype.createWebChannel=lo.prototype.g,Mr.prototype.send=Mr.prototype.o,Mr.prototype.open=Mr.prototype.m,Mr.prototype.close=Mr.prototype.close,n3=function(){return new lo},t3=function(){return xa()},e3=Qt,C_={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ot.NO_ERROR=0,Ot.TIMEOUT=8,Ot.HTTP_ERROR=6,c0=Ot,an.COMPLETE="complete",J4=an,_r.EventType=Nr,Nr.OPEN="a",Nr.CLOSE="b",Nr.ERROR="c",Nr.MESSAGE="d",Pe.prototype.listen=Pe.prototype.J,lh=_r,Ut.prototype.listenOnce=Ut.prototype.K,Ut.prototype.getLastError=Ut.prototype.Ha,Ut.prototype.getLastErrorCode=Ut.prototype.ya,Ut.prototype.getStatus=Ut.prototype.ca,Ut.prototype.getResponseJson=Ut.prototype.La,Ut.prototype.getResponseText=Ut.prototype.la,Ut.prototype.send=Ut.prototype.ea,Ut.prototype.setWithCredentials=Ut.prototype.Fa,Z4=Ut}).apply(typeof Lm<"u"?Lm:typeof self<"u"?self:typeof window<"u"?window:{});const hR="@firebase/firestore",pR="4.9.2";class vr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}vr.UNAUTHENTICATED=new vr(null),vr.GOOGLE_CREDENTIALS=new vr("google-credentials-uid"),vr.FIRST_PARTY=new vr("first-party-uid"),vr.MOCK_USER=new vr("mock-user");let Gd="12.3.0";const Ac=new CS("@firebase/firestore");function Pu(){return Ac.logLevel}function Ee(t,...e){if(Ac.logLevel<=bt.DEBUG){const n=e.map(zS);Ac.debug(`Firestore (${Gd}): ${t}`,...n)}}function jr(t,...e){if(Ac.logLevel<=bt.ERROR){const n=e.map(zS);Ac.error(`Firestore (${Gd}): ${t}`,...n)}}function Cc(t,...e){if(Ac.logLevel<=bt.WARN){const n=e.map(zS);Ac.warn(`Firestore (${Gd}): ${t}`,...n)}}function zS(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function Ve(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,r3(t,r,n)}function r3(t,e,n){let r=`FIRESTORE (${Gd}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw jr(r),new Error(r)}function Le(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||r3(e,i,r)}function it(t,e){return t}const me={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class De extends Ys{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Xa{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class i3{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class iQ{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(vr.UNAUTHENTICATED)))}shutdown(){}}class aQ{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class sQ{constructor(e){this.t=e,this.currentUser=vr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Le(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let a=new Xa;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Xa,e.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const u=a;e.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},c=u=>{Ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>c(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(Ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Xa)}}),0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((r=>this.i!==e?(Ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Le(typeof r.accessToken=="string",31837,{l:r}),new i3(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Le(e===null||typeof e=="string",2055,{h:e}),new vr(e)}}class oQ{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=vr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class lQ{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new oQ(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(vr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class gR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class cQ{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ui(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Le(this.o===void 0,3512);const r=a=>{a.error!=null&&Ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.m;return this.m=a.token,Ee("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>r(a)))};const i=a=>{Ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):Ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new gR(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(Le(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new gR(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function uQ(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}class LS{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=uQ(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<n&&(r+=e.charAt(i[a]%62))}return r}}function nt(t,e){return t<e?-1:t>e?1:0}function I_(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),a=e.charAt(r);if(i!==a)return tx(i)===tx(a)?nt(i,a):tx(i)?1:-1}return nt(t.length,e.length)}const dQ=55296,fQ=57343;function tx(t){const e=t.charCodeAt(0);return e>=dQ&&e<=fQ}function vd(t,e,n){return t.length===e.length&&t.every(((r,i)=>n(r,e[i])))}function a3(t){return t+"\0"}const mR="__name__";class za{constructor(e,n,r){n===void 0?n=0:n>e.length&&Ve(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Ve(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return za.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof za?e.forEach((r=>{n.push(r)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const a=za.compareSegments(e.get(i),n.get(i));if(a!==0)return a}return nt(e.length,n.length)}static compareSegments(e,n){const r=za.isNumericId(e),i=za.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?za.extractNumericId(e).compare(za.extractNumericId(n)):I_(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return el.fromString(e.substring(4,e.length-2))}}class kt extends za{construct(e,n,r){return new kt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new De(me.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter((i=>i.length>0)))}return new kt(n)}static emptyPath(){return new kt([])}}const hQ=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class gn extends za{construct(e,n,r){return new gn(e,n,r)}static isValidIdentifier(e){return hQ.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===mR}static keyField(){return new gn([mR])}static fromServerFormat(e){const n=[];let r="",i=0;const a=()=>{if(r.length===0)throw new De(me.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new De(me.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new De(me.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(r+=c,i++):(a(),i++)}if(a(),o)throw new De(me.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new gn(n)}static emptyPath(){return new gn([])}}class ke{constructor(e){this.path=e}static fromPath(e){return new ke(kt.fromString(e))}static fromName(e){return new ke(kt.fromString(e).popFirst(5))}static empty(){return new ke(kt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&kt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return kt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ke(new kt(e.slice()))}}function s3(t,e,n){if(!n)throw new De(me.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function pQ(t,e,n,r){if(e===!0&&r===!0)throw new De(me.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function vR(t){if(!ke.isDocumentKey(t))throw new De(me.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function yR(t){if(ke.isDocumentKey(t))throw new De(me.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function o3(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function qv(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ve(12329,{type:typeof t})}function Br(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new De(me.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=qv(t);throw new De(me.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Gn(t,e){const n={typeString:t};return e&&(n.value=e),n}function zp(t,e){if(!o3(t))throw new De(me.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(a!==void 0&&o!==a.value){n=`Expected '${r}' field to equal '${a.value}'`;break}}if(n)throw new De(me.INVALID_ARGUMENT,n);return!0}const bR=-62135596800,xR=1e6;class dt{static now(){return dt.fromMillis(Date.now())}static fromDate(e){return dt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*xR);return new dt(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new De(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new De(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<bR)throw new De(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new De(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/xR}_compareTo(e){return this.seconds===e.seconds?nt(this.nanoseconds,e.nanoseconds):nt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:dt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(zp(e,dt._jsonSchema))return new dt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-bR;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}dt._jsonSchemaVersion="firestore/timestamp/1.0",dt._jsonSchema={type:Gn("string",dt._jsonSchemaVersion),seconds:Gn("number"),nanoseconds:Gn("number")};class He{static fromTimestamp(e){return new He(e)}static min(){return new He(new dt(0,0))}static max(){return new He(new dt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Jh=-1;class Q0{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function D_(t){return t.fields.find((e=>e.kind===2))}function Kl(t){return t.fields.filter((e=>e.kind!==2))}Q0.UNKNOWN_ID=-1;class u0{constructor(e,n){this.fieldPath=e,this.kind=n}}class ep{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new ep(0,wi.min())}}function gQ(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=He.fromTimestamp(r===1e9?new dt(n+1,0):new dt(n,r));return new wi(i,ke.empty(),e)}function l3(t){return new wi(t.readTime,t.key,Jh)}class wi{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new wi(He.min(),ke.empty(),Jh)}static max(){return new wi(He.max(),ke.empty(),Jh)}}function BS(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ke.comparator(t.documentKey,e.documentKey),n!==0?n:nt(t.largestBatchId,e.largestBatchId))}const c3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class u3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function zc(t){if(t.code!==me.FAILED_PRECONDITION||t.message!==c3)throw t;Ee("LocalStore","Unexpectedly lost primary lease")}class ae{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ve(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ae(((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(n,a).next(r,i)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof ae?n:ae.resolve(n)}catch(n){return ae.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):ae.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):ae.reject(n)}static resolve(e){return new ae(((n,r)=>{n(e)}))}static reject(e){return new ae(((n,r)=>{r(e)}))}static waitFor(e){return new ae(((n,r)=>{let i=0,a=0,o=!1;e.forEach((c=>{++i,c.next((()=>{++a,o&&a===i&&n()}),(u=>r(u)))})),o=!0,a===i&&n()}))}static or(e){let n=ae.resolve(!1);for(const r of e)n=n.next((i=>i?ae.resolve(i):r()));return n}static forEach(e,n){const r=[];return e.forEach(((i,a)=>{r.push(n.call(this,i,a))})),this.waitFor(r)}static mapArray(e,n){return new ae(((r,i)=>{const a=e.length,o=new Array(a);let c=0;for(let u=0;u<a;u++){const d=u;n(e[d]).next((h=>{o[d]=h,++c,c===a&&r(o)}),(h=>i(h)))}}))}static doWhile(e,n){return new ae(((r,i)=>{const a=()=>{e()===!0?n().next((()=>{a()}),i):r()};a()}))}}const yi="SimpleDb";class Hv{static open(e,n,r,i){try{return new Hv(n,e.transaction(i,r))}catch(a){throw new Ah(n,a)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new Xa,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new Ah(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=FS(r.target.error);this.S.reject(new Ah(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ee(yi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new vQ(n)}}class tl{static delete(e){return Ee(yi,"Removing database:",e),ec(JO().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!l4())return!1;if(tl.F())return!0;const e=Jn(),n=tl.M(e),r=0<n&&n<10,i=d3(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,tl.M(Jn())===12.2&&jr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Ee(yi,"Opening database:",this.name),this.db=await new Promise(((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=a=>{const o=a.target.result;n(o)},i.onblocked=()=>{r(new Ah(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=a=>{const o=a.target.error;o.name==="VersionError"?r(new De(me.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new De(me.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Ah(e,o))},i.onupgradeneeded=a=>{Ee(yi,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const o=a.target.result;this.N.k(o,i.transaction,a.oldVersion,this.version).next((()=>{Ee(yi,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const a=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const c=Hv.open(this.db,e,a?"readonly":"readwrite",r),u=i(c).next((d=>(c.C(),d))).catch((d=>(c.abort(d),ae.reject(d)))).toPromise();return u.catch((()=>{})),await c.D,u}catch(c){const u=c,d=u.name!=="FirebaseError"&&o<3;if(Ee(yi,"Transaction failed with error:",u.message,"Retrying:",d),this.close(),!d)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function d3(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class mQ{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return ec(this.U.delete())}}class Ah extends De{constructor(e,n){super(me.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function yl(t){return t.name==="IndexedDbTransactionError"}class vQ{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(Ee(yi,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(Ee(yi,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ec(r)}add(e){return Ee(yi,"ADD",this.store.name,e,e),ec(this.store.add(e))}get(e){return ec(this.store.get(e)).next((n=>(n===void 0&&(n=null),Ee(yi,"GET",this.store.name,e,n),n)))}delete(e){return Ee(yi,"DELETE",this.store.name,e),ec(this.store.delete(e))}count(){return Ee(yi,"COUNT",this.store.name),ec(this.store.count())}J(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const a=i.getAll(r.range);return new ae(((o,c)=>{a.onerror=u=>{c(u.target.error)},a.onsuccess=u=>{o(u.target.result)}}))}{const a=this.cursor(r),o=[];return this.H(a,((c,u)=>{o.push(u)})).next((()=>o))}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new ae(((i,a)=>{r.onerror=o=>{a(o.target.error)},r.onsuccess=o=>{i(o.target.result)}}))}Z(e,n){Ee(yi,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const i=this.cursor(r);return this.H(i,((a,o,c)=>c.delete()))}ee(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.H(i,n)}te(e){const n=this.cursor({});return new ae(((r,i)=>{n.onerror=a=>{const o=FS(a.target.error);i(o)},n.onsuccess=a=>{const o=a.target.result;o?e(o.primaryKey,o.value).next((c=>{c?o.continue():r()})):r()}}))}H(e,n){const r=[];return new ae(((i,a)=>{e.onerror=o=>{a(o.target.error)},e.onsuccess=o=>{const c=o.target.result;if(!c)return void i();const u=new mQ(c),d=n(c.primaryKey,c.value,u);if(d instanceof ae){const h=d.catch((p=>(u.done(),ae.reject(p))));r.push(h)}u.isDone?i():u.G===null?c.continue():c.continue(u.G)}})).next((()=>ae.waitFor(r)))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function ec(t){return new ae(((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=FS(r.target.error);n(i)}}))}let _R=!1;function FS(t){const e=tl.M(Jn());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new De("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return _R||(_R=!0,setTimeout((()=>{throw r}),0)),r}}return t}const Ch="IndexBackfiller";class yQ{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Ee(Ch,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const n=await this.ne.ie();Ee(Ch,`Documents written: ${n}`)}catch(n){yl(n)?Ee(Ch,"Ignoring IndexedDB error during index backfill: ",n):await zc(n)}await this.re(6e4)}))}}class bQ{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(n=>this.se(n,e)))}se(e,n){const r=new Set;let i=n,a=!0;return ae.doWhile((()=>a===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!r.has(o))return Ee(Ch,`Processing collection: ${o}`),this.oe(e,o,i).next((c=>{i-=c,r.add(o)}));a=!1})))).next((()=>n-i))}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next((i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next((a=>{const o=a.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(i,a))).next((c=>(Ee(Ch,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,n,c)))).next((()=>o.size))}))))}_e(e,n){let r=e;return n.changes.forEach(((i,a)=>{const o=l3(a);BS(o,r)>0&&(r=o)})),new wi(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}class Hi{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Hi.ce=-1;const dc=-1;function $v(t){return t==null}function tp(t){return t===0&&1/t==-1/0}function xQ(t){return typeof t=="number"&&Number.isInteger(t)&&!tp(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const Z0="";function Dr(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=wR(e)),e=_Q(t.get(n),e);return wR(e)}function _Q(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const a=t.charAt(i);switch(a){case"\0":n+="";break;case Z0:n+="";break;default:n+=a}}return n}function wR(t){return t+Z0+""}function Ua(t){const e=t.length;if(Le(e>=2,64408,{path:t}),e===2)return Le(t.charAt(0)===Z0&&t.charAt(1)==="",56145,{path:t}),kt.emptyPath();const n=e-2,r=[];let i="";for(let a=0;a<e;){const o=t.indexOf(Z0,a);switch((o<0||o>n)&&Ve(50515,{path:t}),t.charAt(o+1)){case"":const c=t.substring(a,o);let u;i.length===0?u=c:(i+=c,u=i,i=""),r.push(u);break;case"":i+=t.substring(a,o),i+="\0";break;case"":i+=t.substring(a,o+1);break;default:Ve(61167,{path:t})}a=o+2}return new kt(r)}const Xl="remoteDocuments",Lp="owner",Au="owner",np="mutationQueues",wQ="userId",ua="mutations",SR="batchId",oc="userMutationsIndex",ER=["userId","batchId"];function d0(t,e){return[t,Dr(e)]}function f3(t,e,n){return[t,Dr(e),n]}const SQ={},yd="documentMutations",J0="remoteDocumentsV14",EQ=["prefixPath","collectionGroup","readTime","documentId"],f0="documentKeyIndex",TQ=["prefixPath","collectionGroup","documentId"],h3="collectionGroupIndex",AQ=["collectionGroup","readTime","prefixPath","documentId"],rp="remoteDocumentGlobal",R_="remoteDocumentGlobalKey",bd="targets",p3="queryTargetsIndex",CQ=["canonicalId","targetId"],xd="targetDocuments",IQ=["targetId","path"],US="documentTargetsIndex",DQ=["path","targetId"],ev="targetGlobalKey",fc="targetGlobal",ip="collectionParents",RQ=["collectionId","parent"],_d="clientMetadata",kQ="clientId",Yv="bundles",NQ="bundleId",Kv="namedQueries",MQ="name",GS="indexConfiguration",PQ="indexId",k_="collectionGroupIndex",OQ="collectionGroup",Ih="indexState",VQ=["indexId","uid"],g3="sequenceNumberIndex",jQ=["uid","sequenceNumber"],Dh="indexEntries",zQ=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],m3="documentKeyIndex",LQ=["indexId","uid","orderedDocumentKey"],Xv="documentOverlays",BQ=["userId","collectionPath","documentId"],N_="collectionPathOverlayIndex",FQ=["userId","collectionPath","largestBatchId"],v3="collectionGroupOverlayIndex",UQ=["userId","collectionGroup","largestBatchId"],qS="globals",GQ="name",y3=[np,ua,yd,Xl,bd,Lp,fc,xd,_d,rp,ip,Yv,Kv],qQ=[...y3,Xv],b3=[np,ua,yd,J0,bd,Lp,fc,xd,_d,rp,ip,Yv,Kv,Xv],x3=b3,HS=[...x3,GS,Ih,Dh],HQ=HS,_3=[...HS,qS],$Q=_3;class M_ extends u3{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function er(t,e){const n=it(t);return tl.O(n.le,e)}function TR(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function bl(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function w3(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class un{constructor(e,n){this.comparator=e,this.root=n||yr.EMPTY}insert(e,n){return new un(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,yr.BLACK,null,null))}remove(e){return new un(this.comparator,this.root.remove(e,this.comparator).copy(null,null,yr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,r)=>(e(n,r),!1)))}toString(){const e=[];return this.inorderTraversal(((n,r)=>(e.push(`${n}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Bm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Bm(this.root,e,this.comparator,!1)}getReverseIterator(){return new Bm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Bm(this.root,e,this.comparator,!0)}}class Bm{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=n?r(e.key,n):1,n&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class yr{constructor(e,n,r,i,a){this.key=e,this.value=n,this.color=r??yr.RED,this.left=i??yr.EMPTY,this.right=a??yr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,a){return new yr(e??this.key,n??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,n,r),null):a===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return yr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return yr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,yr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,yr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ve(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ve(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ve(27949);return e+(this.isRed()?0:1)}}yr.EMPTY=null,yr.RED=!0,yr.BLACK=!1;yr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ve(57766)}get value(){throw Ve(16141)}get color(){throw Ve(16727)}get left(){throw Ve(29726)}get right(){throw Ve(36894)}copy(e,n,r,i,a){return this}insert(e,n,r){return new yr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Bt{constructor(e){this.comparator=e,this.data=new un(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,r)=>(e(n),!1)))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new AR(this.data.getIterator())}getIteratorFrom(e){return new AR(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((r=>{n=n.add(r)})),n}isEqual(e){if(!(e instanceof Bt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,a=r.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new Bt(this.comparator);return n.data=e,n}}class AR{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Cu(t){return t.hasNext()?t.getNext():void 0}class ri{constructor(e){this.fields=e,e.sort(gn.comparator)}static empty(){return new ri([])}unionWith(e){let n=new Bt(gn.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new ri(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return vd(this.fields,e.fields,((n,r)=>n.isEqual(r)))}}class S3 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Hn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new S3("Invalid base64 string: "+a):a}})(e);return new Hn(n)}static fromUint8Array(e){const n=(function(i){let a="";for(let o=0;o<i.length;++o)a+=String.fromCharCode(i[o]);return a})(e);return new Hn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return nt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Hn.EMPTY_BYTE_STRING=new Hn("");const YQ=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Hs(t){if(Le(!!t,39018),typeof t=="string"){let e=0;const n=YQ.exec(t);if(Le(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ln(t.seconds),nanos:ln(t.nanos)}}function ln(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function $s(t){return typeof t=="string"?Hn.fromBase64String(t):Hn.fromUint8Array(t)}const E3="server_timestamp",T3="__type__",A3="__previous_value__",C3="__local_write_time__";function $S(t){return(t?.mapValue?.fields||{})[T3]?.stringValue===E3}function Wv(t){const e=t.mapValue.fields[A3];return $S(e)?Wv(e):e}function ap(t){const e=Hs(t.mapValue.fields[C3].timestampValue);return new dt(e.seconds,e.nanos)}class KQ{constructor(e,n,r,i,a,o,c,u,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=h}}const tv="(default)";class Ic{constructor(e,n){this.projectId=e,this.database=n||tv}static empty(){return new Ic("","")}get isDefaultDatabase(){return this.database===tv}isEqual(e){return e instanceof Ic&&e.projectId===this.projectId&&e.database===this.database}}const YS="__type__",I3="__max__",Xo={mapValue:{fields:{__type__:{stringValue:I3}}}},KS="__vector__",wd="value",h0={nullValue:"NULL_VALUE"};function cl(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?$S(t)?4:D3(t)?9007199254740991:Qv(t)?10:11:Ve(28295,{value:t})}function es(t,e){if(t===e)return!0;const n=cl(t);if(n!==cl(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ap(t).isEqual(ap(e));case 3:return(function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const o=Hs(i.timestampValue),c=Hs(a.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(i,a){return $s(i.bytesValue).isEqual($s(a.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(i,a){return ln(i.geoPointValue.latitude)===ln(a.geoPointValue.latitude)&&ln(i.geoPointValue.longitude)===ln(a.geoPointValue.longitude)})(t,e);case 2:return(function(i,a){if("integerValue"in i&&"integerValue"in a)return ln(i.integerValue)===ln(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const o=ln(i.doubleValue),c=ln(a.doubleValue);return o===c?tp(o)===tp(c):isNaN(o)&&isNaN(c)}return!1})(t,e);case 9:return vd(t.arrayValue.values||[],e.arrayValue.values||[],es);case 10:case 11:return(function(i,a){const o=i.mapValue.fields||{},c=a.mapValue.fields||{};if(TR(o)!==TR(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!es(o[u],c[u])))return!1;return!0})(t,e);default:return Ve(52216,{left:t})}}function sp(t,e){return(t.values||[]).find((n=>es(n,e)))!==void 0}function ul(t,e){if(t===e)return 0;const n=cl(t),r=cl(e);if(n!==r)return nt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return nt(t.booleanValue,e.booleanValue);case 2:return(function(a,o){const c=ln(a.integerValue||a.doubleValue),u=ln(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1})(t,e);case 3:return CR(t.timestampValue,e.timestampValue);case 4:return CR(ap(t),ap(e));case 5:return I_(t.stringValue,e.stringValue);case 6:return(function(a,o){const c=$s(a),u=$s(o);return c.compareTo(u)})(t.bytesValue,e.bytesValue);case 7:return(function(a,o){const c=a.split("/"),u=o.split("/");for(let d=0;d<c.length&&d<u.length;d++){const h=nt(c[d],u[d]);if(h!==0)return h}return nt(c.length,u.length)})(t.referenceValue,e.referenceValue);case 8:return(function(a,o){const c=nt(ln(a.latitude),ln(o.latitude));return c!==0?c:nt(ln(a.longitude),ln(o.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return IR(t.arrayValue,e.arrayValue);case 10:return(function(a,o){const c=a.fields||{},u=o.fields||{},d=c[wd]?.arrayValue,h=u[wd]?.arrayValue,p=nt(d?.values?.length||0,h?.values?.length||0);return p!==0?p:IR(d,h)})(t.mapValue,e.mapValue);case 11:return(function(a,o){if(a===Xo.mapValue&&o===Xo.mapValue)return 0;if(a===Xo.mapValue)return 1;if(o===Xo.mapValue)return-1;const c=a.fields||{},u=Object.keys(c),d=o.fields||{},h=Object.keys(d);u.sort(),h.sort();for(let p=0;p<u.length&&p<h.length;++p){const m=I_(u[p],h[p]);if(m!==0)return m;const y=ul(c[u[p]],d[h[p]]);if(y!==0)return y}return nt(u.length,h.length)})(t.mapValue,e.mapValue);default:throw Ve(23264,{he:n})}}function CR(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return nt(t,e);const n=Hs(t),r=Hs(e),i=nt(n.seconds,r.seconds);return i!==0?i:nt(n.nanos,r.nanos)}function IR(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const a=ul(n[i],r[i]);if(a)return a}return nt(n.length,r.length)}function Sd(t){return P_(t)}function P_(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const r=Hs(n);return`time(${r.seconds},${r.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return $s(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return ke.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let r="[",i=!0;for(const a of n.values||[])i?i=!1:r+=",",r+=P_(a);return r+"]"})(t.arrayValue):"mapValue"in t?(function(n){const r=Object.keys(n.fields||{}).sort();let i="{",a=!0;for(const o of r)a?a=!1:i+=",",i+=`${o}:${P_(n.fields[o])}`;return i+"}"})(t.mapValue):Ve(61005,{value:t})}function p0(t){switch(cl(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Wv(t);return e?16+p0(e):16;case 5:return 2*t.stringValue.length;case 6:return $s(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,a)=>i+p0(a)),0)})(t.arrayValue);case 10:case 11:return(function(r){let i=0;return bl(r.fields,((a,o)=>{i+=a.length+p0(o)})),i})(t.mapValue);default:throw Ve(13486,{value:t})}}function op(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function O_(t){return!!t&&"integerValue"in t}function lp(t){return!!t&&"arrayValue"in t}function DR(t){return!!t&&"nullValue"in t}function RR(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function g0(t){return!!t&&"mapValue"in t}function Qv(t){return(t?.mapValue?.fields||{})[YS]?.stringValue===KS}function Rh(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return bl(t.mapValue.fields,((n,r)=>e.mapValue.fields[n]=Rh(r))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Rh(t.arrayValue.values[n]);return e}return{...t}}function D3(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===I3}const R3={mapValue:{fields:{[YS]:{stringValue:KS},[wd]:{arrayValue:{}}}}};function XQ(t){return"nullValue"in t?h0:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?op(Ic.empty(),ke.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Qv(t)?R3:{mapValue:{}}:Ve(35942,{value:t})}function WQ(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?op(Ic.empty(),ke.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?R3:"mapValue"in t?Qv(t)?{mapValue:{}}:Xo:Ve(61959,{value:t})}function kR(t,e){const n=ul(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function NR(t,e){const n=ul(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}class Ar{constructor(e){this.value=e}static empty(){return new Ar({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!g0(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Rh(n)}setAll(e){let n=gn.emptyPath(),r={},i=[];e.forEach(((o,c)=>{if(!n.isImmediateParentOf(c)){const u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=c.popLast()}o?r[c.lastSegment()]=Rh(o):i.push(c.lastSegment())}));const a=this.getFieldsMap(n);this.applyChanges(a,r,i)}delete(e){const n=this.field(e.popLast());g0(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return es(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];g0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){bl(n,((i,a)=>e[i]=a));for(const i of r)delete e[i]}clone(){return new Ar(Rh(this.value))}}function k3(t){const e=[];return bl(t.fields,((n,r)=>{const i=new gn([n]);if(g0(r)){const a=k3(r.mapValue).fields;if(a.length===0)e.push(i);else for(const o of a)e.push(i.child(o))}else e.push(i)})),new ri(e)}class En{constructor(e,n,r,i,a,o,c){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=a,this.data=o,this.documentState=c}static newInvalidDocument(e){return new En(e,0,He.min(),He.min(),He.min(),Ar.empty(),0)}static newFoundDocument(e,n,r,i){return new En(e,1,n,He.min(),r,i,0)}static newNoDocument(e,n){return new En(e,2,n,He.min(),He.min(),Ar.empty(),0)}static newUnknownDocument(e,n){return new En(e,3,n,He.min(),He.min(),Ar.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(He.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ar.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ar.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=He.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof En&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new En(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ed{constructor(e,n){this.position=e,this.inclusive=n}}function MR(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const a=e[i],o=t.position[i];if(a.field.isKeyField()?r=ke.comparator(ke.fromName(o.referenceValue),n.key):r=ul(o,n.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function PR(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!es(t.position[n],e.position[n]))return!1;return!0}class cp{constructor(e,n="asc"){this.field=e,this.dir=n}}function QQ(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class N3{}class xt extends N3{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new ZQ(e,n,r):n==="array-contains"?new tZ(e,r):n==="in"?new z3(e,r):n==="not-in"?new nZ(e,r):n==="array-contains-any"?new rZ(e,r):new xt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new JQ(e,r):new eZ(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(ul(n,this.value)):n!==null&&cl(this.value)===cl(n)&&this.matchesComparison(ul(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ve(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Lt extends N3{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Lt(e,n)}matches(e){return Td(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Td(t){return t.op==="and"}function V_(t){return t.op==="or"}function XS(t){return M3(t)&&Td(t)}function M3(t){for(const e of t.filters)if(e instanceof Lt)return!1;return!0}function j_(t){if(t instanceof xt)return t.field.canonicalString()+t.op.toString()+Sd(t.value);if(XS(t))return t.filters.map((e=>j_(e))).join(",");{const e=t.filters.map((n=>j_(n))).join(",");return`${t.op}(${e})`}}function P3(t,e){return t instanceof xt?(function(r,i){return i instanceof xt&&r.op===i.op&&r.field.isEqual(i.field)&&es(r.value,i.value)})(t,e):t instanceof Lt?(function(r,i){return i instanceof Lt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((a,o,c)=>a&&P3(o,i.filters[c])),!0):!1})(t,e):void Ve(19439)}function O3(t,e){const n=t.filters.concat(e);return Lt.create(n,t.op)}function V3(t){return t instanceof xt?(function(n){return`${n.field.canonicalString()} ${n.op} ${Sd(n.value)}`})(t):t instanceof Lt?(function(n){return n.op.toString()+" {"+n.getFilters().map(V3).join(" ,")+"}"})(t):"Filter"}class ZQ extends xt{constructor(e,n,r){super(e,n,r),this.key=ke.fromName(r.referenceValue)}matches(e){const n=ke.comparator(e.key,this.key);return this.matchesComparison(n)}}class JQ extends xt{constructor(e,n){super(e,"in",n),this.keys=j3("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class eZ extends xt{constructor(e,n){super(e,"not-in",n),this.keys=j3("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function j3(t,e){return(e.arrayValue?.values||[]).map((n=>ke.fromName(n.referenceValue)))}class tZ extends xt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return lp(n)&&sp(n.arrayValue,this.value)}}class z3 extends xt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&sp(this.value.arrayValue,n)}}class nZ extends xt{constructor(e,n){super(e,"not-in",n)}matches(e){if(sp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!sp(this.value.arrayValue,n)}}class rZ extends xt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!lp(n)||!n.arrayValue.values)&&n.arrayValue.values.some((r=>sp(this.value.arrayValue,r)))}}class iZ{constructor(e,n=null,r=[],i=[],a=null,o=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=c,this.Te=null}}function z_(t,e=null,n=[],r=[],i=null,a=null,o=null){return new iZ(t,e,n,r,i,a,o)}function Dc(t){const e=it(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((r=>j_(r))).join(","),n+="|ob:",n+=e.orderBy.map((r=>(function(a){return a.field.canonicalString()+a.dir})(r))).join(","),$v(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((r=>Sd(r))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((r=>Sd(r))).join(",")),e.Te=n}return e.Te}function Bp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!QQ(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!P3(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!PR(t.startAt,e.startAt)&&PR(t.endAt,e.endAt)}function nv(t){return ke.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function rv(t,e){return t.filters.filter((n=>n instanceof xt&&n.field.isEqual(e)))}function OR(t,e,n){let r=h0,i=!0;for(const a of rv(t,e)){let o=h0,c=!0;switch(a.op){case"<":case"<=":o=XQ(a.value);break;case"==":case"in":case">=":o=a.value;break;case">":o=a.value,c=!1;break;case"!=":case"not-in":o=h0}kR({value:r,inclusive:i},{value:o,inclusive:c})<0&&(r=o,i=c)}if(n!==null){for(let a=0;a<t.orderBy.length;++a)if(t.orderBy[a].field.isEqual(e)){const o=n.position[a];kR({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function VR(t,e,n){let r=Xo,i=!0;for(const a of rv(t,e)){let o=Xo,c=!0;switch(a.op){case">=":case">":o=WQ(a.value),c=!1;break;case"==":case"in":case"<=":o=a.value;break;case"<":o=a.value,c=!1;break;case"!=":case"not-in":o=Xo}NR({value:r,inclusive:i},{value:o,inclusive:c})>0&&(r=o,i=c)}if(n!==null){for(let a=0;a<t.orderBy.length;++a)if(t.orderBy[a].field.isEqual(e)){const o=n.position[a];NR({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}class qd{constructor(e,n=null,r=[],i=[],a=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function aZ(t,e,n,r,i,a,o,c){return new qd(t,e,n,r,i,a,o,c)}function Fp(t){return new qd(t)}function jR(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function L3(t){return t.collectionGroup!==null}function kh(t){const e=it(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),n.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Bt(gn.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((d=>{d.isInequality()&&(c=c.add(d.field))}))})),c})(e).forEach((a=>{n.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new cp(a,r))})),n.has(gn.keyField().canonicalString())||e.Ie.push(new cp(gn.keyField(),r))}return e.Ie}function Ki(t){const e=it(t);return e.Ee||(e.Ee=sZ(e,kh(t))),e.Ee}function sZ(t,e){if(t.limitType==="F")return z_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((i=>{const a=i.dir==="desc"?"asc":"desc";return new cp(i.field,a)}));const n=t.endAt?new Ed(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ed(t.startAt.position,t.startAt.inclusive):null;return z_(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function L_(t,e){const n=t.filters.concat([e]);return new qd(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function iv(t,e,n){return new qd(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Zv(t,e){return Bp(Ki(t),Ki(e))&&t.limitType===e.limitType}function B3(t){return`${Dc(Ki(t))}|lt:${t.limitType}`}function Ou(t){return`Query(target=${(function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map((i=>V3(i))).join(", ")}]`),$v(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map((i=>Sd(i))).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map((i=>Sd(i))).join(",")),`Target(${r})`})(Ki(t))}; limitType=${t.limitType})`}function Up(t,e){return e.isFoundDocument()&&(function(r,i){const a=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):ke.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)})(t,e)&&(function(r,i){for(const a of kh(r))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0})(t,e)&&(function(r,i){for(const a of r.filters)if(!a.matches(i))return!1;return!0})(t,e)&&(function(r,i){return!(r.startAt&&!(function(o,c,u){const d=MR(o,c,u);return o.inclusive?d<=0:d<0})(r.startAt,kh(r),i)||r.endAt&&!(function(o,c,u){const d=MR(o,c,u);return o.inclusive?d>=0:d>0})(r.endAt,kh(r),i))})(t,e)}function oZ(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function F3(t){return(e,n)=>{let r=!1;for(const i of kh(t)){const a=lZ(i,e,n);if(a!==0)return a;r=r||i.field.isKeyField()}return 0}}function lZ(t,e,n){const r=t.field.isKeyField()?ke.comparator(e.key,n.key):(function(a,o,c){const u=o.data.field(a),d=c.data.field(a);return u!==null&&d!==null?ul(u,d):Ve(42886)})(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ve(19790,{direction:t.dir})}}class Xs{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,a]of r)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){bl(this.inner,((n,r)=>{for(const[i,a]of r)e(i,a)}))}isEmpty(){return w3(this.inner)}size(){return this.innerSize}}const cZ=new un(ke.comparator);function bi(){return cZ}const U3=new un(ke.comparator);function ch(...t){let e=U3;for(const n of t)e=e.insert(n.key,n);return e}function G3(t){let e=U3;return t.forEach(((n,r)=>e=e.insert(n,r.overlayedDocument))),e}function Ga(){return Nh()}function q3(){return Nh()}function Nh(){return new Xs((t=>t.toString()),((t,e)=>t.isEqual(e)))}const uZ=new un(ke.comparator),dZ=new Bt(ke.comparator);function ft(...t){let e=dZ;for(const n of t)e=e.add(n);return e}const fZ=new Bt(nt);function hZ(){return fZ}function WS(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:tp(e)?"-0":e}}function H3(t){return{integerValue:""+t}}function pZ(t,e){return xQ(e)?H3(e):WS(t,e)}class Jv{constructor(){this._=void 0}}function gZ(t,e,n){return t instanceof up?(function(i,a){const o={fields:{[T3]:{stringValue:E3},[C3]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&$S(a)&&(a=Wv(a)),a&&(o.fields[A3]=a),{mapValue:o}})(n,e):t instanceof Ad?Y3(t,e):t instanceof Cd?K3(t,e):(function(i,a){const o=$3(i,a),c=zR(o)+zR(i.Ae);return O_(o)&&O_(i.Ae)?H3(c):WS(i.serializer,c)})(t,e)}function mZ(t,e,n){return t instanceof Ad?Y3(t,e):t instanceof Cd?K3(t,e):n}function $3(t,e){return t instanceof dp?(function(r){return O_(r)||(function(a){return!!a&&"doubleValue"in a})(r)})(e)?e:{integerValue:0}:null}class up extends Jv{}class Ad extends Jv{constructor(e){super(),this.elements=e}}function Y3(t,e){const n=X3(e);for(const r of t.elements)n.some((i=>es(i,r)))||n.push(r);return{arrayValue:{values:n}}}class Cd extends Jv{constructor(e){super(),this.elements=e}}function K3(t,e){let n=X3(e);for(const r of t.elements)n=n.filter((i=>!es(i,r)));return{arrayValue:{values:n}}}class dp extends Jv{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function zR(t){return ln(t.integerValue||t.doubleValue)}function X3(t){return lp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class vZ{constructor(e,n){this.field=e,this.transform=n}}function yZ(t,e){return t.field.isEqual(e.field)&&(function(r,i){return r instanceof Ad&&i instanceof Ad||r instanceof Cd&&i instanceof Cd?vd(r.elements,i.elements,es):r instanceof dp&&i instanceof dp?es(r.Ae,i.Ae):r instanceof up&&i instanceof up})(t.transform,e.transform)}class bZ{constructor(e,n){this.version=e,this.transformResults=n}}class Ir{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ir}static exists(e){return new Ir(void 0,e)}static updateTime(e){return new Ir(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function m0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ey{}function W3(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ty(t.key,Ir.none()):new Hd(t.key,t.data,Ir.none());{const n=t.data,r=Ar.empty();let i=new Bt(gn.comparator);for(let a of e.fields)if(!i.has(a)){let o=n.field(a);o===null&&a.length>1&&(a=a.popLast(),o=n.field(a)),o===null?r.delete(a):r.set(a,o),i=i.add(a)}return new Ws(t.key,r,new ri(i.toArray()),Ir.none())}}function xZ(t,e,n){t instanceof Hd?(function(i,a,o){const c=i.value.clone(),u=BR(i.fieldTransforms,a,o.transformResults);c.setAll(u),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(t,e,n):t instanceof Ws?(function(i,a,o){if(!m0(i.precondition,a))return void a.convertToUnknownDocument(o.version);const c=BR(i.fieldTransforms,a,o.transformResults),u=a.data;u.setAll(Q3(i)),u.setAll(c),a.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(t,e,n):(function(i,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,n)}function Mh(t,e,n,r){return t instanceof Hd?(function(a,o,c,u){if(!m0(a.precondition,o))return c;const d=a.value.clone(),h=FR(a.fieldTransforms,u,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(t,e,n,r):t instanceof Ws?(function(a,o,c,u){if(!m0(a.precondition,o))return c;const d=FR(a.fieldTransforms,u,o),h=o.data;return h.setAll(Q3(a)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((p=>p.field)))})(t,e,n,r):(function(a,o,c){return m0(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(t,e,n)}function _Z(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),a=$3(r.transform,i||null);a!=null&&(n===null&&(n=Ar.empty()),n.set(r.field,a))}return n||null}function LR(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&vd(r,i,((a,o)=>yZ(a,o)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Hd extends ey{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ws extends ey{constructor(e,n,r,i,a=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Q3(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}})),e}function BR(t,e,n){const r=new Map;Le(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const a=t[i],o=a.transform,c=e.data.field(a.field);r.set(a.field,mZ(o,c,n[i]))}return r}function FR(t,e,n){const r=new Map;for(const i of t){const a=i.transform,o=n.data.field(i.field);r.set(i.field,gZ(a,o,e))}return r}class ty extends ey{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Z3 extends ey{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class QS{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&xZ(a,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Mh(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Mh(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=q3();return this.mutations.forEach((i=>{const a=e.get(i.key),o=a.overlayedDocument;let c=this.applyToLocalView(o,a.mutatedFields);c=n.has(i.key)?null:c;const u=W3(o,c);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(He.min())})),r}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),ft())}isEqual(e){return this.batchId===e.batchId&&vd(this.mutations,e.mutations,((n,r)=>LR(n,r)))&&vd(this.baseMutations,e.baseMutations,((n,r)=>LR(n,r)))}}class ZS{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Le(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return uZ})();const a=e.mutations;for(let o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new ZS(e,n,r,i)}}class JS{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class wZ{constructor(e,n){this.count=e,this.unchangedNames=n}}var Bn,Et;function SZ(t){switch(t){case me.OK:return Ve(64938);case me.CANCELLED:case me.UNKNOWN:case me.DEADLINE_EXCEEDED:case me.RESOURCE_EXHAUSTED:case me.INTERNAL:case me.UNAVAILABLE:case me.UNAUTHENTICATED:return!1;case me.INVALID_ARGUMENT:case me.NOT_FOUND:case me.ALREADY_EXISTS:case me.PERMISSION_DENIED:case me.FAILED_PRECONDITION:case me.ABORTED:case me.OUT_OF_RANGE:case me.UNIMPLEMENTED:case me.DATA_LOSS:return!0;default:return Ve(15467,{code:t})}}function J3(t){if(t===void 0)return jr("GRPC error has no .code"),me.UNKNOWN;switch(t){case Bn.OK:return me.OK;case Bn.CANCELLED:return me.CANCELLED;case Bn.UNKNOWN:return me.UNKNOWN;case Bn.DEADLINE_EXCEEDED:return me.DEADLINE_EXCEEDED;case Bn.RESOURCE_EXHAUSTED:return me.RESOURCE_EXHAUSTED;case Bn.INTERNAL:return me.INTERNAL;case Bn.UNAVAILABLE:return me.UNAVAILABLE;case Bn.UNAUTHENTICATED:return me.UNAUTHENTICATED;case Bn.INVALID_ARGUMENT:return me.INVALID_ARGUMENT;case Bn.NOT_FOUND:return me.NOT_FOUND;case Bn.ALREADY_EXISTS:return me.ALREADY_EXISTS;case Bn.PERMISSION_DENIED:return me.PERMISSION_DENIED;case Bn.FAILED_PRECONDITION:return me.FAILED_PRECONDITION;case Bn.ABORTED:return me.ABORTED;case Bn.OUT_OF_RANGE:return me.OUT_OF_RANGE;case Bn.UNIMPLEMENTED:return me.UNIMPLEMENTED;case Bn.DATA_LOSS:return me.DATA_LOSS;default:return Ve(39323,{code:t})}}(Et=Bn||(Bn={}))[Et.OK=0]="OK",Et[Et.CANCELLED=1]="CANCELLED",Et[Et.UNKNOWN=2]="UNKNOWN",Et[Et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Et[Et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Et[Et.NOT_FOUND=5]="NOT_FOUND",Et[Et.ALREADY_EXISTS=6]="ALREADY_EXISTS",Et[Et.PERMISSION_DENIED=7]="PERMISSION_DENIED",Et[Et.UNAUTHENTICATED=16]="UNAUTHENTICATED",Et[Et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Et[Et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Et[Et.ABORTED=10]="ABORTED",Et[Et.OUT_OF_RANGE=11]="OUT_OF_RANGE",Et[Et.UNIMPLEMENTED=12]="UNIMPLEMENTED",Et[Et.INTERNAL=13]="INTERNAL",Et[Et.UNAVAILABLE=14]="UNAVAILABLE",Et[Et.DATA_LOSS=15]="DATA_LOSS";function EZ(){return new TextEncoder}const TZ=new el([4294967295,4294967295],0);function UR(t){const e=EZ().encode(t),n=new Q4;return n.update(e),new Uint8Array(n.digest())}function GR(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new el([n,r],0),new el([i,a],0)]}class eE{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new uh(`Invalid padding: ${n}`);if(r<0)throw new uh(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new uh(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new uh(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=el.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(el.fromNumber(r)));return i.compare(TZ)===1&&(i=new el([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=UR(e),[r,i]=GR(n);for(let a=0;a<this.hashCount;a++){const o=this.ye(r,i,a);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new eE(a,i,n);return r.forEach((c=>o.insert(c))),o}insert(e){if(this.ge===0)return;const n=UR(e),[r,i]=GR(n);for(let a=0;a<this.hashCount;a++){const o=this.ye(r,i,a);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class uh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class ny{constructor(e,n,r,i,a){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Gp.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new ny(He.min(),i,new un(nt),bi(),ft())}}class Gp{constructor(e,n,r,i,a){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Gp(r,n,ft(),ft(),ft())}}class v0{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class eV{constructor(e,n){this.targetId=e,this.Ce=n}}class tV{constructor(e,n,r=Hn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class qR{constructor(){this.ve=0,this.Fe=HR(),this.Me=Hn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ft(),n=ft(),r=ft();return this.Fe.forEach(((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Ve(38017,{changeType:a})}})),new Gp(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=HR()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Le(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class AZ{constructor(e){this.Ge=e,this.ze=new Map,this.je=bi(),this.Je=Fm(),this.He=Fm(),this.Ye=new un(nt)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:Ve(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((r,i)=>{this.rt(i)&&n(i)}))}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const a=i.target;if(nv(a))if(r===0){const o=new ke(a.path);this.et(n,o,En.newNoDocument(o,He.min()))}else Le(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:a=0}=n;let o,c;try{o=$s(r).toUint8Array()}catch(u){if(u instanceof S3)return Cc("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new eE(o,i,a)}catch(u){return Cc(u instanceof uh?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach((a=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.et(n,a,null),i++)})),i}Tt(e){const n=new Map;this.ze.forEach(((a,o)=>{const c=this.ot(o);if(c){if(a.current&&nv(c.target)){const u=new ke(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,En.newNoDocument(u,e))}a.Be&&(n.set(o,a.ke()),a.qe())}}));let r=ft();this.He.forEach(((a,o)=>{let c=!0;o.forEachWhile((u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(a))})),this.je.forEach(((a,o)=>o.setReadTime(e)));const i=new ny(e,n,this.Ye,this.je,r);return this.je=bi(),this.Je=Fm(),this.He=Fm(),this.Ye=new un(nt),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new qR,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Bt(nt),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Bt(nt),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Ee("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new qR),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Fm(){return new un(ke.comparator)}function HR(){return new un(ke.comparator)}const CZ={asc:"ASCENDING",desc:"DESCENDING"},IZ={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},DZ={and:"AND",or:"OR"};class RZ{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function B_(t,e){return t.useProto3Json||$v(e)?e:{value:e}}function Id(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function nV(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function kZ(t,e){return Id(t,e.toTimestamp())}function Fr(t){return Le(!!t,49232),He.fromTimestamp((function(n){const r=Hs(n);return new dt(r.seconds,r.nanos)})(t))}function tE(t,e){return F_(t,e).canonicalString()}function F_(t,e){const n=(function(i){return new kt(["projects",i.projectId,"databases",i.database])})(t).child("documents");return e===void 0?n:n.child(e)}function rV(t){const e=kt.fromString(t);return Le(fV(e),10190,{key:e.toString()}),e}function av(t,e){return tE(t.databaseId,e.path)}function hc(t,e){const n=rV(e);if(n.get(1)!==t.databaseId.projectId)throw new De(me.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new De(me.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ke(sV(n))}function iV(t,e){return tE(t.databaseId,e)}function aV(t){const e=rV(t);return e.length===4?kt.emptyPath():sV(e)}function U_(t){return new kt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function sV(t){return Le(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function $R(t,e,n){return{name:av(t,e),fields:n.value.mapValue.fields}}function NZ(t,e,n){const r=hc(t,e.name),i=Fr(e.updateTime),a=e.createTime?Fr(e.createTime):He.min(),o=new Ar({mapValue:{fields:e.fields}}),c=En.newFoundDocument(r,i,a,o);return n&&c.setHasCommittedMutations(),n?c.setHasCommittedMutations():c}function MZ(t,e){let n;if("targetChange"in e){e.targetChange;const r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Ve(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=(function(d,h){return d.useProto3Json?(Le(h===void 0||typeof h=="string",58123),Hn.fromBase64String(h||"")):(Le(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Hn.fromUint8Array(h||new Uint8Array))})(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(d){const h=d.code===void 0?me.UNKNOWN:J3(d.code);return new De(h,d.message||"")})(o);n=new tV(r,i,a,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=hc(t,r.document.name),a=Fr(r.document.updateTime),o=r.document.createTime?Fr(r.document.createTime):He.min(),c=new Ar({mapValue:{fields:r.document.fields}}),u=En.newFoundDocument(i,a,o,c),d=r.targetIds||[],h=r.removedTargetIds||[];n=new v0(d,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=hc(t,r.document),a=r.readTime?Fr(r.readTime):He.min(),o=En.newNoDocument(i,a),c=r.removedTargetIds||[];n=new v0([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=hc(t,r.document),a=r.removedTargetIds||[];n=new v0([],a,i,null)}else{if(!("filter"in e))return Ve(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:a}=r,o=new wZ(i,a),c=r.targetId;n=new eV(c,o)}}return n}function sv(t,e){let n;if(e instanceof Hd)n={update:$R(t,e.key,e.value)};else if(e instanceof ty)n={delete:av(t,e.key)};else if(e instanceof Ws)n={update:$R(t,e.key,e.data),updateMask:LZ(e.fieldMask)};else{if(!(e instanceof Z3))return Ve(16599,{Vt:e.type});n={verify:av(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((r=>(function(a,o){const c=o.transform;if(c instanceof up)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Ad)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Cd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof dp)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw Ve(20930,{transform:o.transform})})(0,r)))),e.precondition.isNone||(n.currentDocument=(function(i,a){return a.updateTime!==void 0?{updateTime:kZ(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Ve(27497)})(t,e.precondition)),n}function G_(t,e){const n=e.currentDocument?(function(a){return a.updateTime!==void 0?Ir.updateTime(Fr(a.updateTime)):a.exists!==void 0?Ir.exists(a.exists):Ir.none()})(e.currentDocument):Ir.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(o,c){let u=null;if("setToServerValue"in c)Le(c.setToServerValue==="REQUEST_TIME",16630,{proto:c}),u=new up;else if("appendMissingElements"in c){const h=c.appendMissingElements.values||[];u=new Ad(h)}else if("removeAllFromArray"in c){const h=c.removeAllFromArray.values||[];u=new Cd(h)}else"increment"in c?u=new dp(o,c.increment):Ve(16584,{proto:c});const d=gn.fromServerFormat(c.fieldPath);return new vZ(d,u)})(t,i))):[];if(e.update){e.update.name;const i=hc(t,e.update.name),a=new Ar({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const d=u.fieldPaths||[];return new ri(d.map((h=>gn.fromServerFormat(h))))})(e.updateMask);return new Ws(i,a,o,n,r)}return new Hd(i,a,n,r)}if(e.delete){const i=hc(t,e.delete);return new ty(i,n)}if(e.verify){const i=hc(t,e.verify);return new Z3(i,n)}return Ve(1463,{proto:e})}function PZ(t,e){return t&&t.length>0?(Le(e!==void 0,14353),t.map((n=>(function(i,a){let o=i.updateTime?Fr(i.updateTime):Fr(a);return o.isEqual(He.min())&&(o=Fr(a)),new bZ(o,i.transformResults||[])})(n,e)))):[]}function oV(t,e){return{documents:[iV(t,e.path)]}}function lV(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=iV(t,i);const a=(function(d){if(d.length!==0)return dV(Lt.create(d,"and"))})(e.filters);a&&(n.structuredQuery.where=a);const o=(function(d){if(d.length!==0)return d.map((h=>(function(m){return{field:Vu(m.field),direction:VZ(m.dir)}})(h)))})(e.orderBy);o&&(n.structuredQuery.orderBy=o);const c=B_(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:n,parent:i}}function cV(t){let e=aV(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Le(r===1,65062);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let a=[];n.where&&(a=(function(p){const m=uV(p);return m instanceof Lt&&XS(m)?m.getFilters():[m]})(n.where));let o=[];n.orderBy&&(o=(function(p){return p.map((m=>(function(_){return new cp(ju(_.field),(function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(_.direction))})(m)))})(n.orderBy));let c=null;n.limit&&(c=(function(p){let m;return m=typeof p=="object"?p.value:p,$v(m)?null:m})(n.limit));let u=null;n.startAt&&(u=(function(p){const m=!!p.before,y=p.values||[];return new Ed(y,m)})(n.startAt));let d=null;return n.endAt&&(d=(function(p){const m=!p.before,y=p.values||[];return new Ed(y,m)})(n.endAt)),aZ(e,i,o,a,c,"F",u,d)}function OZ(t,e){const n=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ve(28987,{purpose:i})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function uV(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=ju(n.unaryFilter.field);return xt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=ju(n.unaryFilter.field);return xt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=ju(n.unaryFilter.field);return xt.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ju(n.unaryFilter.field);return xt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ve(61313);default:return Ve(60726)}})(t):t.fieldFilter!==void 0?(function(n){return xt.create(ju(n.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ve(58110);default:return Ve(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return Lt.create(n.compositeFilter.filters.map((r=>uV(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ve(1026)}})(n.compositeFilter.op))})(t):Ve(30097,{filter:t})}function VZ(t){return CZ[t]}function jZ(t){return IZ[t]}function zZ(t){return DZ[t]}function Vu(t){return{fieldPath:t.canonicalString()}}function ju(t){return gn.fromServerFormat(t.fieldPath)}function dV(t){return t instanceof xt?(function(n){if(n.op==="=="){if(RR(n.value))return{unaryFilter:{field:Vu(n.field),op:"IS_NAN"}};if(DR(n.value))return{unaryFilter:{field:Vu(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(RR(n.value))return{unaryFilter:{field:Vu(n.field),op:"IS_NOT_NAN"}};if(DR(n.value))return{unaryFilter:{field:Vu(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vu(n.field),op:jZ(n.op),value:n.value}}})(t):t instanceof Lt?(function(n){const r=n.getFilters().map((i=>dV(i)));return r.length===1?r[0]:{compositeFilter:{op:zZ(n.op),filters:r}}})(t):Ve(54877,{filter:t})}function LZ(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function fV(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Ns{constructor(e,n,r,i,a=He.min(),o=He.min(),c=Hn.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Ns(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ns(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ns(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ns(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class hV{constructor(e){this.yt=e}}function BZ(t,e){let n;if(e.document)n=NZ(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ke.fromSegments(e.noDocument.path),i=kc(e.noDocument.readTime);n=En.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ve(56709);{const r=ke.fromSegments(e.unknownDocument.path),i=kc(e.unknownDocument.version);n=En.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime((function(i){const a=new dt(i[0],i[1]);return He.fromTimestamp(a)})(e.readTime)),n}function YR(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:ov(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(a,o){return{name:av(a,o.key),fields:o.data.value.mapValue.fields,updateTime:Id(a,o.version.toTimestamp()),createTime:Id(a,o.createTime.toTimestamp())}})(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Rc(e.version)};else{if(!e.isUnknownDocument())return Ve(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:Rc(e.version)}}return r}function ov(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Rc(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function kc(t){const e=new dt(t.seconds,t.nanoseconds);return He.fromTimestamp(e)}function tc(t,e){const n=(e.baseMutations||[]).map((a=>G_(t.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const o=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const c=e.mutations[a+1];o.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const r=e.mutations.map((a=>G_(t.yt,a))),i=dt.fromMillis(e.localWriteTimeMs);return new QS(e.batchId,i,n,r)}function dh(t){const e=kc(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?kc(t.lastLimboFreeSnapshotVersion):He.min();let r;return r=(function(a){return a.documents!==void 0})(t.query)?(function(a){const o=a.documents.length;return Le(o===1,1966,{count:o}),Ki(Fp(aV(a.documents[0])))})(t.query):(function(a){return Ki(cV(a))})(t.query),new Ns(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Hn.fromBase64String(t.resumeToken))}function pV(t,e){const n=Rc(e.snapshotVersion),r=Rc(e.lastLimboFreeSnapshotVersion);let i;i=nv(e.target)?oV(t.yt,e.target):lV(t.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Dc(e.target),readTime:n,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function gV(t){const e=cV({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?iv(e,e.limit,"L"):e}function nx(t,e){return new JS(e.largestBatchId,G_(t.yt,e.overlayMutation))}function KR(t,e){const n=e.path.lastSegment();return[t,Dr(e.path.popLast()),n]}function XR(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Rc(r.readTime),documentKey:Dr(r.documentKey.path),largestBatchId:r.largestBatchId}}class FZ{getBundleMetadata(e,n){return WR(e).get(n).next((r=>{if(r)return(function(a){return{id:a.bundleId,createTime:kc(a.createTime),version:a.version}})(r)}))}saveBundleMetadata(e,n){return WR(e).put((function(i){return{bundleId:i.id,createTime:Rc(Fr(i.createTime)),version:i.version}})(n))}getNamedQuery(e,n){return QR(e).get(n).next((r=>{if(r)return(function(a){return{name:a.name,query:gV(a.bundledQuery),readTime:kc(a.readTime)}})(r)}))}saveNamedQuery(e,n){return QR(e).put((function(i){return{name:i.name,readTime:Rc(Fr(i.readTime)),bundledQuery:i.bundledQuery}})(n))}}function WR(t){return er(t,Yv)}function QR(t){return er(t,Kv)}class ry{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new ry(e,r)}getOverlay(e,n){return Wf(e).get(KR(this.userId,n)).next((r=>r?nx(this.serializer,r):null))}getOverlays(e,n){const r=Ga();return ae.forEach(n,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,n,r){const i=[];return r.forEach(((a,o)=>{const c=new JS(n,o);i.push(this.St(e,c))})),ae.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach((o=>i.add(Dr(o.getCollectionPath()))));const a=[];return i.forEach((o=>{const c=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);a.push(Wf(e).Z(N_,c))})),ae.waitFor(a)}getOverlaysForCollection(e,n,r){const i=Ga(),a=Dr(n),o=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Wf(e).J(N_,o).next((c=>{for(const u of c){const d=nx(this.serializer,u);i.set(d.getKey(),d)}return i}))}getOverlaysForCollectionGroup(e,n,r,i){const a=Ga();let o;const c=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Wf(e).ee({index:v3,range:c},((u,d,h)=>{const p=nx(this.serializer,d);a.size()<i||p.largestBatchId===o?(a.set(p.getKey(),p),o=p.largestBatchId):h.done()})).next((()=>a))}St(e,n){return Wf(e).put((function(i,a,o){const[c,u,d]=KR(a,o.mutation.key);return{userId:a,collectionPath:u,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:sv(i.yt,o.mutation)}})(this.serializer,this.userId,n))}}function Wf(t){return er(t,Xv)}class UZ{bt(e){return er(e,qS)}getSessionToken(e){return this.bt(e).get("sessionToken").next((n=>{const r=n?.value;return r?Hn.fromUint8Array(r):Hn.EMPTY_BYTE_STRING}))}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}class nc{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(ln(e.integerValue));else if("doubleValue"in e){const r=ln(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),tp(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=Hs(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt($s(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?D3(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):Qv(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):Ve(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const i of Object.keys(r))this.Ot(i,n),this.Ct(r[i],n)}kt(e,n){const r=e.fields||{};this.Ft(n,53);const i=wd,a=r[i].arrayValue?.values?.length||0;this.Ft(n,15),n.Mt(ln(a)),this.Ot(i,n),this.Ct(r[i],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const i of r)this.Ct(i,n)}Lt(e,n){this.Ft(n,37),ke.fromName(e).path.forEach((r=>{this.Ft(n,60),this.Ut(r,n)}))}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}nc.Kt=new nc;const Iu=255;function GZ(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function ZR(t){const e=64-(function(r){let i=0;for(let a=0;a<8;++a){const o=GZ(255&r[a]);if(i+=o,o!==8)break}return i})(t);return Math.ceil(e/8)}class qZ{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=n.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=n.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const n=this.en(e),r=ZR(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}nn(e){const n=this.en(e),r=ZR(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}rn(){this.sn(Iu),this.sn(255)}_n(){this.an(Iu),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=(function(a){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,a,!1),new Uint8Array(o.buffer)})(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===Iu?(this.sn(Iu),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===Iu?(this.an(Iu),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class HZ{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class $Z{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Qf{constructor(){this.cn=new qZ,this.ln=new HZ(this.cn),this.hn=new $Z(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class rc{constructor(e,n,r,i){this.Tn=e,this.In=n,this.En=r,this.dn=i}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new rc(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:y0(this.En),directionalValue:y0(this.dn),orderedDocumentKey:y0(n),documentKey:r.path.toArray()}}Vn(e,n,r){const i=this.Rn(e,n,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Po(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=JR(t.En,e.En),n!==0?n:(n=JR(t.dn,e.dn),n!==0?n:ke.comparator(t.In,e.In)))}function JR(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function y0(t){return o4()?(function(n){let r="";for(let i=0;i<n.length;i++)r+=String.fromCharCode(n[i]);return r})(t):t}function ek(t){return typeof t!="string"?t:(function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r})(t)}class tk{constructor(e){this.mn=new Bt(((n,r)=>gn.comparator(n.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Le(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=D_(e);if(n!==void 0&&!this.wn(n))return!1;const r=Kl(e);let i=new Set,a=0,o=0;for(;a<r.length&&this.wn(r[a]);++a)i=i.add(r[a].fieldPath.canonicalString());if(a===r.length)return!0;if(this.mn.size>0){const c=this.mn.getIterator().getNext();if(!i.has(c.field.canonicalString())){const u=r[a];if(!this.Sn(c,u)||!this.bn(this.fn[o++],u))return!1}++a}for(;a<r.length;++a){const c=r[a];if(o>=this.fn.length||!this.bn(this.fn[o++],c))return!1}return!0}Dn(){if(this.pn)return null;let e=new Bt(gn.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new u0(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new u0(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new u0(r.field,r.dir==="asc"?0:1)));return new Q0(Q0.UNKNOWN_ID,this.collectionId,n,ep.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}function mV(t){if(Le(t instanceof xt||t instanceof Lt,20012),t instanceof xt){if(t instanceof z3){const n=t.value.arrayValue?.values?.map((r=>xt.create(t.field,"==",r)))||[];return Lt.create(n,"or")}return t}const e=t.filters.map((n=>mV(n)));return Lt.create(e,t.op)}function YZ(t){if(t.getFilters().length===0)return[];const e=$_(mV(t));return Le(vV(e),7391),q_(e)||H_(e)?[e]:e.getFilters()}function q_(t){return t instanceof xt}function H_(t){return t instanceof Lt&&XS(t)}function vV(t){return q_(t)||H_(t)||(function(n){if(n instanceof Lt&&V_(n)){for(const r of n.getFilters())if(!q_(r)&&!H_(r))return!1;return!0}return!1})(t)}function $_(t){if(Le(t instanceof xt||t instanceof Lt,34018),t instanceof xt)return t;if(t.filters.length===1)return $_(t.filters[0]);const e=t.filters.map((r=>$_(r)));let n=Lt.create(e,t.op);return n=lv(n),vV(n)?n:(Le(n instanceof Lt,64498),Le(Td(n),40251),Le(n.filters.length>1,57927),n.filters.reduce(((r,i)=>nE(r,i))))}function nE(t,e){let n;return Le(t instanceof xt||t instanceof Lt,38388),Le(e instanceof xt||e instanceof Lt,25473),n=t instanceof xt?e instanceof xt?(function(i,a){return Lt.create([i,a],"and")})(t,e):nk(t,e):e instanceof xt?nk(e,t):(function(i,a){if(Le(i.filters.length>0&&a.filters.length>0,48005),Td(i)&&Td(a))return O3(i,a.getFilters());const o=V_(i)?i:a,c=V_(i)?a:i,u=o.filters.map((d=>nE(d,c)));return Lt.create(u,"or")})(t,e),lv(n)}function nk(t,e){if(Td(e))return O3(e,t.getFilters());{const n=e.filters.map((r=>nE(t,r)));return Lt.create(n,"or")}}function lv(t){if(Le(t instanceof xt||t instanceof Lt,11850),t instanceof xt)return t;const e=t.getFilters();if(e.length===1)return lv(e[0]);if(M3(t))return t;const n=e.map((i=>lv(i))),r=[];return n.forEach((i=>{i instanceof xt?r.push(i):i instanceof Lt&&(i.op===t.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:Lt.create(r,t.op)}class KZ{constructor(){this.Cn=new rE}addToCollectionParentIndex(e,n){return this.Cn.add(n),ae.resolve()}getCollectionParents(e,n){return ae.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return ae.resolve()}deleteFieldIndex(e,n){return ae.resolve()}deleteAllFieldIndexes(e){return ae.resolve()}createTargetIndexes(e,n){return ae.resolve()}getDocumentsMatchingTarget(e,n){return ae.resolve(null)}getIndexType(e,n){return ae.resolve(0)}getFieldIndexes(e,n){return ae.resolve([])}getNextCollectionGroupToUpdate(e){return ae.resolve(null)}getMinOffset(e,n){return ae.resolve(wi.min())}getMinOffsetFromCollectionGroup(e,n){return ae.resolve(wi.min())}updateCollectionGroup(e,n,r){return ae.resolve()}updateIndexEntries(e,n){return ae.resolve()}}class rE{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Bt(kt.comparator),a=!i.has(r);return this.index[n]=i.add(r),a}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Bt(kt.comparator)).toArray()}}const rk="IndexedDbIndexManager",Um=new Uint8Array(0);class XZ{constructor(e,n){this.databaseId=n,this.vn=new rE,this.Fn=new Xs((r=>Dc(r)),((r,i)=>Bp(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener((()=>{this.vn.add(n)}));const a={collectionId:r,parent:Dr(i)};return ik(e).put(a)}return ae.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[a3(n),""],!1,!0);return ik(e).J(i).next((a=>{for(const o of a){if(o.collectionId!==n)break;r.push(Ua(o.parent))}return r}))}addFieldIndex(e,n){const r=Zf(e),i=(function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(n);delete i.indexId;const a=r.add(i);if(n.indexState){const o=Ru(e);return a.next((c=>{o.put(XR(c,this.uid,n.indexState.sequenceNumber,n.indexState.offset))}))}return a.next()}deleteFieldIndex(e,n){const r=Zf(e),i=Ru(e),a=Du(e);return r.delete(n.indexId).next((()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const n=Zf(e),r=Du(e),i=Ru(e);return n.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,n){return ae.forEach(this.Mn(n),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const a=new tk(r).Dn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,n){const r=Du(e);let i=!0;const a=new Map;return ae.forEach(this.Mn(n),(o=>this.xn(e,o).next((c=>{i&&(i=!!c),a.set(o,c)})))).next((()=>{if(i){let o=ft();const c=[];return ae.forEach(a,((u,d)=>{Ee(rk,`Using index ${(function(D){return`id=${D.indexId}|cg=${D.collectionGroup}|f=${D.fields.map((O=>`${O.fieldPath}:${O.kind}`)).join(",")}`})(u)} to execute ${Dc(n)}`);const h=(function(D,O){const z=D_(O);if(z===void 0)return null;for(const P of rv(D,z.fieldPath))switch(P.op){case"array-contains-any":return P.value.arrayValue.values||[];case"array-contains":return[P.value]}return null})(d,u),p=(function(D,O){const z=new Map;for(const P of Kl(O))for(const A of rv(D,P.fieldPath))switch(A.op){case"==":case"in":z.set(P.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return z.set(P.fieldPath.canonicalString(),A.value),Array.from(z.values())}return null})(d,u),m=(function(D,O){const z=[];let P=!0;for(const A of Kl(O)){const C=A.kind===0?OR(D,A.fieldPath,D.startAt):VR(D,A.fieldPath,D.startAt);z.push(C.value),P&&(P=C.inclusive)}return new Ed(z,P)})(d,u),y=(function(D,O){const z=[];let P=!0;for(const A of Kl(O)){const C=A.kind===0?VR(D,A.fieldPath,D.endAt):OR(D,A.fieldPath,D.endAt);z.push(C.value),P&&(P=C.inclusive)}return new Ed(z,P)})(d,u),_=this.On(u,d,m),w=this.On(u,d,y),E=this.Nn(u,d,p),T=this.Bn(u.indexId,h,_,m.inclusive,w,y.inclusive,E);return ae.forEach(T,(I=>r.Y(I,n.limit).next((D=>{D.forEach((O=>{const z=ke.fromSegments(O.documentKey);o.has(z)||(o=o.add(z),c.push(z))}))}))))})).next((()=>c))}return ae.resolve(null)}))}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=YZ(Lt.create(e.filters,"and")).map((r=>z_(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,n),n)}Bn(e,n,r,i,a,o,c){const u=(n!=null?n.length:1)*Math.max(r.length,a.length),d=u/(n!=null?n.length:1),h=[];for(let p=0;p<u;++p){const m=n?this.Ln(n[p/d]):Um,y=this.kn(e,m,r[p%d],i),_=this.qn(e,m,a[p%d],o),w=c.map((E=>this.kn(e,m,E,!0)));h.push(...this.createRange(y,_,w))}return h}kn(e,n,r,i){const a=new rc(e,ke.empty(),n,r);return i?a:a.An()}qn(e,n,r,i){const a=new rc(e,ke.empty(),n,r);return i?a.An():a}xn(e,n){const r=new tk(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next((a=>{let o=null;for(const c of a)r.yn(c)&&(!o||c.fields.length>o.fields.length)&&(o=c);return o}))}getIndexType(e,n){let r=2;const i=this.Mn(n);return ae.forEach(i,(a=>this.xn(e,a).next((o=>{o?r!==0&&o.fields.length<(function(u){let d=new Bt(gn.comparator),h=!1;for(const p of u.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:d=d.add(m.field));for(const p of u.orderBy)p.field.isKeyField()||(d=d.add(p.field));return d.size+(h?1:0)})(a)&&(r=1):r=0})))).next((()=>(function(o){return o.limit!==null})(n)&&i.length>1&&r===2?1:r))}Qn(e,n){const r=new Qf;for(const i of Kl(e)){const a=n.data.field(i.fieldPath);if(a==null)return null;const o=r.Pn(i.kind);nc.Kt.Dt(a,o)}return r.un()}Ln(e){const n=new Qf;return nc.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new Qf;return nc.Kt.Dt(op(this.databaseId,n),r.Pn((function(a){const o=Kl(a);return o.length===0?0:o[o.length-1].kind})(e))),r.un()}Nn(e,n,r){if(r===null)return[];let i=[];i.push(new Qf);let a=0;for(const o of Kl(e)){const c=r[a++];for(const u of i)if(this.Un(n,o.fieldPath)&&lp(c))i=this.Kn(i,o,c);else{const d=u.Pn(o.kind);nc.Kt.Dt(c,d)}}return this.Wn(i)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const i=[...e],a=[];for(const o of r.arrayValue.values||[])for(const c of i){const u=new Qf;u.seed(c.un()),nc.Kt.Dt(o,u.Pn(n.kind)),a.push(u)}return a}Un(e,n){return!!e.filters.find((r=>r instanceof xt&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,n){const r=Zf(e),i=Ru(e);return(n?r.J(k_,IDBKeyRange.bound(n,n)):r.J()).next((a=>{const o=[];return ae.forEach(a,(c=>i.get([c.indexId,this.uid]).next((u=>{o.push((function(h,p){const m=p?new ep(p.sequenceNumber,new wi(kc(p.readTime),new ke(Ua(p.documentKey)),p.largestBatchId)):ep.empty(),y=h.fields.map((([_,w])=>new u0(gn.fromServerFormat(_),w)));return new Q0(h.indexId,h.collectionGroup,y,m)})(c,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((n=>n.length===0?null:(n.sort(((r,i)=>{const a=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return a!==0?a:nt(r.collectionGroup,i.collectionGroup)})),n[0].collectionGroup)))}updateCollectionGroup(e,n,r){const i=Zf(e),a=Ru(e);return this.Gn(e).next((o=>i.J(k_,IDBKeyRange.bound(n,n)).next((c=>ae.forEach(c,(u=>a.put(XR(u.indexId,this.uid,o,r))))))))}updateIndexEntries(e,n){const r=new Map;return ae.forEach(n,((i,a)=>{const o=r.get(i.collectionGroup);return(o?ae.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next((c=>(r.set(i.collectionGroup,c),ae.forEach(c,(u=>this.zn(e,i,u).next((d=>{const h=this.jn(a,u);return d.isEqual(h)?ae.resolve():this.Jn(e,a,u,d,h)})))))))}))}Hn(e,n,r,i){return Du(e).put(i.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,i){return Du(e).delete(i.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const i=Du(e);let a=new Bt(Po);return i.ee({index:m3,range:IDBKeyRange.only([r.indexId,this.uid,y0(this.$n(r,n))])},((o,c)=>{a=a.add(new rc(r.indexId,n,ek(c.arrayValue),ek(c.directionalValue)))})).next((()=>a))}jn(e,n){let r=new Bt(Po);const i=this.Qn(n,e);if(i==null)return r;const a=D_(n);if(a!=null){const o=e.data.field(a.fieldPath);if(lp(o))for(const c of o.arrayValue.values||[])r=r.add(new rc(n.indexId,e.key,this.Ln(c),i))}else r=r.add(new rc(n.indexId,e.key,Um,i));return r}Jn(e,n,r,i,a){Ee(rk,"Updating index entries for document '%s'",n.key);const o=[];return(function(u,d,h,p,m){const y=u.getIterator(),_=d.getIterator();let w=Cu(y),E=Cu(_);for(;w||E;){let T=!1,I=!1;if(w&&E){const D=h(w,E);D<0?I=!0:D>0&&(T=!0)}else w!=null?I=!0:T=!0;T?(p(E),E=Cu(_)):I?(m(w),w=Cu(y)):(w=Cu(y),E=Cu(_))}})(i,a,Po,(c=>{o.push(this.Hn(e,n,r,c))}),(c=>{o.push(this.Yn(e,n,r,c))})),ae.waitFor(o)}Gn(e){let n=1;return Ru(e).ee({index:g3,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,a)=>{a.done(),n=i.sequenceNumber+1})).next((()=>n))}createRange(e,n,r){r=r.sort(((o,c)=>Po(o,c))).filter(((o,c,u)=>!c||Po(o,u[c-1])!==0));const i=[];i.push(e);for(const o of r){const c=Po(o,e),u=Po(o,n);if(c===0)i[0]=e.An();else if(c>0&&u<0)i.push(o),i.push(o.An());else if(u>0)break}i.push(n);const a=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const c=i[o].Vn(this.uid,Um,ke.empty()),u=i[o+1].Vn(this.uid,Um,ke.empty());a.push(IDBKeyRange.bound(c,u))}return a}Zn(e,n){return Po(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(ak)}getMinOffset(e,n){return ae.mapArray(this.Mn(n),(r=>this.xn(e,r).next((i=>i||Ve(44426))))).next(ak)}}function ik(t){return er(t,ip)}function Du(t){return er(t,Dh)}function Zf(t){return er(t,GS)}function Ru(t){return er(t,Ih)}function ak(t){Le(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;BS(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new wi(e.readTime,e.documentKey,n)}const sk={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},yV=41943040;class Tr{static withCacheSize(e){return new Tr(e,Tr.DEFAULT_COLLECTION_PERCENTILE,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}function bV(t,e,n){const r=t.store(ua),i=t.store(yd),a=[],o=IDBKeyRange.only(n.batchId);let c=0;const u=r.ee({range:o},((h,p,m)=>(c++,m.delete())));a.push(u.next((()=>{Le(c===1,47070,{batchId:n.batchId})})));const d=[];for(const h of n.mutations){const p=f3(e,h.key.path,n.batchId);a.push(i.delete(p)),d.push(h.key)}return ae.waitFor(a).next((()=>d))}function cv(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Ve(14731);e=t.noDocument}return JSON.stringify(e).length}Tr.DEFAULT_COLLECTION_PERCENTILE=10,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Tr.DEFAULT=new Tr(yV,Tr.DEFAULT_COLLECTION_PERCENTILE,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Tr.DISABLED=new Tr(-1,0,0);class iy{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,n,r,i){Le(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new iy(a,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Oo(e).ee({index:oc,range:r},((i,a,o)=>{n=!1,o.done()})).next((()=>n))}addMutationBatch(e,n,r,i){const a=zu(e),o=Oo(e);return o.add({}).next((c=>{Le(typeof c=="number",49019);const u=new QS(c,n,r,i),d=(function(y,_,w){const E=w.baseMutations.map((I=>sv(y.yt,I))),T=w.mutations.map((I=>sv(y.yt,I)));return{userId:_,batchId:w.batchId,localWriteTimeMs:w.localWriteTime.toMillis(),baseMutations:E,mutations:T}})(this.serializer,this.userId,u),h=[];let p=new Bt(((m,y)=>nt(m.canonicalString(),y.canonicalString())));for(const m of i){const y=f3(this.userId,m.key.path,c);p=p.add(m.key.path.popLast()),h.push(o.put(d)),h.push(a.put(y,SQ))}return p.forEach((m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[c]=u.keys()})),ae.waitFor(h).next((()=>u))}))}lookupMutationBatch(e,n){return Oo(e).get(n).next((r=>r?(Le(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),tc(this.serializer,r)):null))}er(e,n){return this.Xn[n]?ae.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next((r=>{if(r){const i=r.keys();return this.Xn[n]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return Oo(e).ee({index:oc,range:i},((o,c,u)=>{c.userId===this.userId&&(Le(c.batchId>=r,47524,{tr:r}),a=tc(this.serializer,c)),u.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=dc;return Oo(e).ee({index:oc,range:n,reverse:!0},((i,a,o)=>{r=a.batchId,o.done()})).next((()=>r))}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,dc],[this.userId,Number.POSITIVE_INFINITY]);return Oo(e).J(oc,n).next((r=>r.map((i=>tc(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=d0(this.userId,n.path),i=IDBKeyRange.lowerBound(r),a=[];return zu(e).ee({range:i},((o,c,u)=>{const[d,h,p]=o,m=Ua(h);if(d===this.userId&&n.path.isEqual(m))return Oo(e).get(p).next((y=>{if(!y)throw Ve(61480,{nr:o,batchId:p});Le(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:p}),a.push(tc(this.serializer,y))}));u.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Bt(nt);const i=[];return n.forEach((a=>{const o=d0(this.userId,a.path),c=IDBKeyRange.lowerBound(o),u=zu(e).ee({range:c},((d,h,p)=>{const[m,y,_]=d,w=Ua(y);m===this.userId&&a.path.isEqual(w)?r=r.add(_):p.done()}));i.push(u)})),ae.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,a=d0(this.userId,r),o=IDBKeyRange.lowerBound(a);let c=new Bt(nt);return zu(e).ee({range:o},((u,d,h)=>{const[p,m,y]=u,_=Ua(m);p===this.userId&&r.isPrefixOf(_)?_.length===i&&(c=c.add(y)):h.done()})).next((()=>this.rr(e,c)))}rr(e,n){const r=[],i=[];return n.forEach((a=>{i.push(Oo(e).get(a).next((o=>{if(o===null)throw Ve(35274,{batchId:a});Le(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:a}),r.push(tc(this.serializer,o))})))})),ae.waitFor(i).next((()=>r))}removeMutationBatch(e,n){return bV(e.le,this.userId,n).next((r=>(e.addOnCommittedListener((()=>{this.ir(n.batchId)})),ae.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((n=>{if(!n)return ae.resolve();const r=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),i=[];return zu(e).ee({range:r},((a,o,c)=>{if(a[0]===this.userId){const u=Ua(a[1]);i.push(u)}else c.done()})).next((()=>{Le(i.length===0,56720,{sr:i.map((a=>a.canonicalString()))})}))}))}containsKey(e,n){return xV(e,this.userId,n)}_r(e){return _V(e).get(this.userId).next((n=>n||{userId:this.userId,lastAcknowledgedBatchId:dc,lastStreamToken:""}))}}function xV(t,e,n){const r=d0(e,n.path),i=r[1],a=IDBKeyRange.lowerBound(r);let o=!1;return zu(t).ee({range:a,X:!0},((c,u,d)=>{const[h,p,m]=c;h===e&&p===i&&(o=!0),d.done()})).next((()=>o))}function Oo(t){return er(t,ua)}function zu(t){return er(t,yd)}function _V(t){return er(t,np)}class Nc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Nc(0)}static cr(){return new Nc(-1)}}class WZ{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next((n=>{const r=new Nc(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next((()=>n.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((n=>He.fromTimestamp(new dt(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((n=>n.highestListenSequenceNumber))}setTargetsMetadata(e,n,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.hr(e,i))))}addTargetData(e,n){return this.Pr(e,n).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next((()=>ku(e).delete(n.targetId))).next((()=>this.lr(e))).next((r=>(Le(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,n,r){let i=0;const a=[];return ku(e).ee(((o,c)=>{const u=dh(c);u.sequenceNumber<=n&&r.get(u.targetId)===null&&(i++,a.push(this.removeTargetData(e,u)))})).next((()=>ae.waitFor(a))).next((()=>i))}forEachTarget(e,n){return ku(e).ee(((r,i)=>{const a=dh(i);n(a)}))}lr(e){return ok(e).get(ev).next((n=>(Le(n!==null,2888),n)))}hr(e,n){return ok(e).put(ev,n)}Pr(e,n){return ku(e).put(pV(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((n=>n.targetCount))}getTargetData(e,n){const r=Dc(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return ku(e).ee({range:i,index:p3},((o,c,u)=>{const d=dh(c);Bp(n,d.target)&&(a=d,u.done())})).next((()=>a))}addMatchingKeys(e,n,r){const i=[],a=qo(e);return n.forEach((o=>{const c=Dr(o.path);i.push(a.put({targetId:r,path:c})),i.push(this.referenceDelegate.addReference(e,r,o))})),ae.waitFor(i)}removeMatchingKeys(e,n,r){const i=qo(e);return ae.forEach(n,(a=>{const o=Dr(a.path);return ae.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,a)])}))}removeMatchingKeysForTargetId(e,n){const r=qo(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=qo(e);let a=ft();return i.ee({range:r,X:!0},((o,c,u)=>{const d=Ua(o[1]),h=new ke(d);a=a.add(h)})).next((()=>a))}containsKey(e,n){const r=Dr(n.path),i=IDBKeyRange.bound([r],[a3(r)],!1,!0);let a=0;return qo(e).ee({index:US,X:!0,range:i},(([o,c],u,d)=>{o!==0&&(a++,d.done())})).next((()=>a>0))}At(e,n){return ku(e).get(n).next((r=>r?dh(r):null))}}function ku(t){return er(t,bd)}function ok(t){return er(t,fc)}function qo(t){return er(t,xd)}const lk="LruGarbageCollector",QZ=1048576;function ck([t,e],[n,r]){const i=nt(t,n);return i===0?nt(e,r):i}class ZZ{constructor(e){this.Ir=e,this.buffer=new Bt(ck),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();ck(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class wV{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ee(lk,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){yl(n)?Ee(lk,"Ignoring IndexedDB error during garbage collection: ",n):await zc(n)}await this.Vr(3e5)}))}}class JZ{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((r=>Math.floor(n/100*r)))}nthSequenceNumber(e,n){if(n===0)return ae.resolve(Hi.ce);const r=new ZZ(n);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Ee("LruGarbageCollector","Garbage collection skipped; disabled"),ae.resolve(sk)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),sk):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,a,o,c,u,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(Ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i)))).next((p=>(r=p,c=Date.now(),this.removeTargets(e,r,n)))).next((p=>(a=p,u=Date.now(),this.removeOrphanedDocuments(e,r)))).next((p=>(d=Date.now(),Pu()<=bt.DEBUG&&Ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${a} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(d-u)+`ms
Total Duration: ${d-h}ms`),ae.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:p}))))}}function SV(t,e){return new JZ(t,e)}class eJ{constructor(e,n){this.db=e,this.garbageCollector=SV(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>n.next((i=>r+i))))}wr(e){let n=0;return this.pr(e,(r=>{n++})).next((()=>n))}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,((r,i)=>n(i)))}addReference(e,n,r){return Gm(e,r)}removeReference(e,n,r){return Gm(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Gm(e,n)}br(e,n){return(function(i,a){let o=!1;return _V(i).te((c=>xV(i,c,a).next((u=>(u&&(o=!0),ae.resolve(!u)))))).next((()=>o))})(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Sr(e,((o,c)=>{if(c<=n){const u=this.br(e,o).next((d=>{if(!d)return a++,r.getEntry(e,o).next((()=>(r.removeEntry(o,He.min()),qo(e).delete((function(p){return[0,Dr(p.path)]})(o)))))}));i.push(u)}})).next((()=>ae.waitFor(i))).next((()=>r.apply(e))).next((()=>a))}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Gm(e,n)}Sr(e,n){const r=qo(e);let i,a=Hi.ce;return r.ee({index:US},(([o,c],{path:u,sequenceNumber:d})=>{o===0?(a!==Hi.ce&&n(new ke(Ua(i)),a),a=d,i=u):a=Hi.ce})).next((()=>{a!==Hi.ce&&n(new ke(Ua(i)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Gm(t,e){return qo(t).put((function(r,i){return{targetId:0,path:Dr(r.path),sequenceNumber:i}})(e,t.currentSequenceNumber))}class EV{constructor(){this.changes=new Xs((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,En.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?ae.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class tJ{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Hl(e).put(r)}removeEntry(e,n,r){return Hl(e).delete((function(a,o){const c=a.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],ov(o),c[c.length-1]]})(n,r))}updateMetadata(e,n){return this.getMetadata(e).next((r=>(r.byteSize+=n,this.Dr(e,r))))}getEntry(e,n){let r=En.newInvalidDocument(n);return Hl(e).ee({index:f0,range:IDBKeyRange.only(Jf(n))},((i,a)=>{r=this.Cr(n,a)})).next((()=>r))}vr(e,n){let r={size:0,document:En.newInvalidDocument(n)};return Hl(e).ee({index:f0,range:IDBKeyRange.only(Jf(n))},((i,a)=>{r={document:this.Cr(n,a),size:cv(a)}})).next((()=>r))}getEntries(e,n){let r=bi();return this.Fr(e,n,((i,a)=>{const o=this.Cr(i,a);r=r.insert(i,o)})).next((()=>r))}Mr(e,n){let r=bi(),i=new un(ke.comparator);return this.Fr(e,n,((a,o)=>{const c=this.Cr(a,o);r=r.insert(a,c),i=i.insert(a,cv(o))})).next((()=>({documents:r,Or:i})))}Fr(e,n,r){if(n.isEmpty())return ae.resolve();let i=new Bt(fk);n.forEach((u=>i=i.add(u)));const a=IDBKeyRange.bound(Jf(i.first()),Jf(i.last())),o=i.getIterator();let c=o.getNext();return Hl(e).ee({index:f0,range:a},((u,d,h)=>{const p=ke.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;c&&fk(c,p)<0;)r(c,null),c=o.getNext();c&&c.isEqual(p)&&(r(c,d),c=o.hasNext()?o.getNext():null),c?h.j(Jf(c)):h.done()})).next((()=>{for(;c;)r(c,null),c=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,n,r,i,a){const o=n.path,c=[o.popLast().toArray(),o.lastSegment(),ov(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Hl(e).J(IDBKeyRange.bound(c,u,!0)).next((d=>{a?.incrementDocumentReadCount(d.length);let h=bi();for(const p of d){const m=this.Cr(ke.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(Up(n,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h}))}getAllFromCollectionGroup(e,n,r,i){let a=bi();const o=dk(n,r),c=dk(n,wi.max());return Hl(e).ee({index:h3,range:IDBKeyRange.bound(o,c,!0)},((u,d,h)=>{const p=this.Cr(ke.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);a=a.insert(p.key,p),a.size===i&&h.done()})).next((()=>a))}newChangeBuffer(e){return new nJ(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((n=>n.byteSize))}getMetadata(e){return uk(e).get(R_).next((n=>(Le(!!n,20021),n)))}Dr(e,n){return uk(e).put(R_,n)}Cr(e,n){if(n){const r=BZ(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(He.min())))return r}return En.newInvalidDocument(e)}}function TV(t){return new tJ(t)}class nJ extends EV{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new Xs((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const n=[];let r=0,i=new Bt(((a,o)=>nt(a.canonicalString(),o.canonicalString())));return this.changes.forEach(((a,o)=>{const c=this.Br.get(a);if(n.push(this.Nr.removeEntry(e,a,c.readTime)),o.isValidDocument()){const u=YR(this.Nr.serializer,o);i=i.add(a.path.popLast());const d=cv(u);r+=d-c.size,n.push(this.Nr.addEntry(e,a,u))}else if(r-=c.size,this.trackRemovals){const u=YR(this.Nr.serializer,o.convertToNoDocument(He.min()));n.push(this.Nr.addEntry(e,a,u))}})),i.forEach((a=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,a))})),n.push(this.Nr.updateMetadata(e,r)),ae.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next((r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next((({documents:r,Or:i})=>(i.forEach(((a,o)=>{this.Br.set(a,{size:o,readTime:r.get(a).readTime})})),r)))}}function uk(t){return er(t,rp)}function Hl(t){return er(t,J0)}function Jf(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function dk(t,e){const n=e.documentKey.path.toArray();return[t,ov(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function fk(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let a=0;a<n.length-2&&a<r.length-2;++a)if(i=nt(n[a],r[a]),i)return i;return i=nt(n.length,r.length),i||(i=nt(n[n.length-2],r[r.length-2]),i||nt(n[n.length-1],r[r.length-1]))}class rJ{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class AV{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,n)))).next((i=>(r!==null&&Mh(r.mutation,i,ri.empty(),dt.now()),i)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.getLocalViewOfDocuments(e,r,ft()).next((()=>r))))}getLocalViewOfDocuments(e,n,r=ft()){const i=Ga();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,r).next((a=>{let o=ch();return a.forEach(((c,u)=>{o=o.insert(c,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,n){const r=Ga();return this.populateOverlays(e,r,n).next((()=>this.computeViews(e,n,r,ft())))}populateOverlays(e,n,r){const i=[];return r.forEach((a=>{n.has(a)||i.push(a)})),this.documentOverlayCache.getOverlays(e,i).next((a=>{a.forEach(((o,c)=>{n.set(o,c)}))}))}computeViews(e,n,r,i){let a=bi();const o=Nh(),c=(function(){return Nh()})();return n.forEach(((u,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof Ws)?a=a.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Mh(h.mutation,d,h.mutation.getFieldMask(),dt.now())):o.set(d.key,ri.empty())})),this.recalculateAndSaveOverlays(e,a).next((u=>(u.forEach(((d,h)=>o.set(d,h))),n.forEach(((d,h)=>c.set(d,new rJ(h,o.get(d)??null)))),c)))}recalculateAndSaveOverlays(e,n){const r=Nh();let i=new un(((o,c)=>o-c)),a=ft();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((o=>{for(const c of o)c.keys().forEach((u=>{const d=n.get(u);if(d===null)return;let h=r.get(u)||ri.empty();h=c.applyToLocalView(d,h),r.set(u,h);const p=(i.get(c.batchId)||ft()).add(u);i=i.insert(c.batchId,p)}))})).next((()=>{const o=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,h=u.value,p=q3();h.forEach((m=>{if(!a.has(m)){const y=W3(n.get(m),r.get(m));y!==null&&p.set(m,y),a=a.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return ae.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,n,r,i){return(function(o){return ke.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):L3(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next((a=>{const o=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-a.size):ae.resolve(Ga());let c=Jh,u=a;return o.next((d=>ae.forEach(d,((h,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),a.get(h)?ae.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{u=u.insert(h,m)}))))).next((()=>this.populateOverlays(e,d,a))).next((()=>this.computeViews(e,u,d,ft()))).next((h=>({batchId:c,changes:G3(h)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ke(n)).next((r=>{let i=ch();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const a=n.collectionGroup;let o=ch();return this.indexManager.getCollectionParents(e,a).next((c=>ae.forEach(c,(u=>{const d=(function(p,m){return new qd(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(n,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next((h=>{h.forEach(((p,m)=>{o=o.insert(p,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,n,r,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next((o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,a,i)))).next((o=>{a.forEach(((u,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,En.newInvalidDocument(h)))}));let c=ch();return o.forEach(((u,d)=>{const h=a.get(u);h!==void 0&&Mh(h.mutation,d,ri.empty(),dt.now()),Up(n,d)&&(c=c.insert(u,d))})),c}))}}class iJ{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return ae.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(i){return{id:i.id,version:i.version,createTime:Fr(i.createTime)}})(n)),ae.resolve()}getNamedQuery(e,n){return ae.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(i){return{name:i.name,query:gV(i.bundledQuery),readTime:Fr(i.readTime)}})(n)),ae.resolve()}}class aJ{constructor(){this.overlays=new un(ke.comparator),this.qr=new Map}getOverlay(e,n){return ae.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ga();return ae.forEach(n,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,n,r){return r.forEach(((i,a)=>{this.St(e,n,a)})),ae.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(r)),ae.resolve()}getOverlaysForCollection(e,n,r){const i=Ga(),a=n.length+1,o=new ke(n.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===a&&u.largestBatchId>r&&i.set(u.getKey(),u)}return ae.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let a=new un(((d,h)=>d-h));const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=a.get(d.largestBatchId);h===null&&(h=Ga(),a=a.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const c=Ga(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((d,h)=>c.set(d,h))),!(c.size()>=i)););return ae.resolve(c)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new JS(n,r));let a=this.qr.get(n);a===void 0&&(a=ft(),this.qr.set(n,a)),this.qr.set(n,a.add(r.key))}}class sJ{constructor(){this.sessionToken=Hn.EMPTY_BYTE_STRING}getSessionToken(e){return ae.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ae.resolve()}}class iE{constructor(){this.Qr=new Bt(or.$r),this.Ur=new Bt(or.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new or(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach((r=>this.addReference(r,n)))}removeReference(e,n){this.Gr(new or(e,n))}zr(e,n){e.forEach((r=>this.removeReference(r,n)))}jr(e){const n=new ke(new kt([])),r=new or(n,e),i=new or(n,e+1),a=[];return this.Ur.forEachInRange([r,i],(o=>{this.Gr(o),a.push(o.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new ke(new kt([])),r=new or(n,e),i=new or(n,e+1);let a=ft();return this.Ur.forEachInRange([r,i],(o=>{a=a.add(o.key)})),a}containsKey(e){const n=new or(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class or{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return ke.comparator(e.key,n.key)||nt(e.Yr,n.Yr)}static Kr(e,n){return nt(e.Yr,n.Yr)||ke.comparator(e.key,n.key)}}class oJ{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Bt(or.$r)}checkEmpty(e){return ae.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new QS(a,n,r,i);this.mutationQueue.push(o);for(const c of i)this.Zr=this.Zr.add(new or(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return ae.resolve(o)}lookupMutationBatch(e,n){return ae.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),a=i<0?0:i;return ae.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ae.resolve(this.mutationQueue.length===0?dc:this.tr-1)}getAllMutationBatches(e){return ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new or(n,0),i=new or(n,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([r,i],(o=>{const c=this.Xr(o.Yr);a.push(c)})),ae.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Bt(nt);return n.forEach((i=>{const a=new or(i,0),o=new or(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,o],(c=>{r=r.add(c.Yr)}))})),ae.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let a=r;ke.isDocumentKey(a)||(a=a.child(""));const o=new or(new ke(a),0);let c=new Bt(nt);return this.Zr.forEachWhile((u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(c=c.add(u.Yr)),!0)}),o),ae.resolve(this.ti(c))}ti(e){const n=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&n.push(i)})),n}removeMutationBatch(e,n){Le(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return ae.forEach(n.mutations,(i=>{const a=new or(i.key,n.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,n){const r=new or(n,0),i=this.Zr.firstAfterOrEqual(r);return ae.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ae.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class lJ{constructor(e){this.ri=e,this.docs=(function(){return new un(ke.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),a=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return ae.resolve(r?r.document.mutableCopy():En.newInvalidDocument(n))}getEntries(e,n){let r=bi();return n.forEach((i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():En.newInvalidDocument(i))})),ae.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let a=bi();const o=n.path,c=new ke(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:h}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||BS(l3(h),r)<=0||(i.has(h.key)||Up(n,h))&&(a=a.insert(h.key,h.mutableCopy()))}return ae.resolve(a)}getAllFromCollectionGroup(e,n,r,i){Ve(9500)}ii(e,n){return ae.forEach(this.docs,(r=>n(r)))}newChangeBuffer(e){return new cJ(this)}getSize(e){return ae.resolve(this.size)}}class cJ extends EV{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),ae.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class uJ{constructor(e){this.persistence=e,this.si=new Xs((n=>Dc(n)),Bp),this.lastRemoteSnapshotVersion=He.min(),this.highestTargetId=0,this.oi=0,this._i=new iE,this.targetCount=0,this.ai=Nc.ur()}forEachTarget(e,n){return this.si.forEach(((r,i)=>n(i))),ae.resolve()}getLastRemoteSnapshotVersion(e){return ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ae.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ae.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),ae.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Nc(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,ae.resolve()}updateTargetData(e,n){return this.Pr(n),ae.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,ae.resolve()}removeTargets(e,n,r){let i=0;const a=[];return this.si.forEach(((o,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.si.delete(o),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)})),ae.waitFor(a).next((()=>i))}getTargetCount(e){return ae.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return ae.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),ae.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,a=[];return i&&n.forEach((o=>{a.push(i.markPotentiallyOrphaned(e,o))})),ae.waitFor(a)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),ae.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return ae.resolve(r)}containsKey(e,n){return ae.resolve(this._i.containsKey(n))}}class aE{constructor(e,n){this.ui={},this.overlays={},this.ci=new Hi(0),this.li=!1,this.li=!0,this.hi=new sJ,this.referenceDelegate=e(this),this.Pi=new uJ(this),this.indexManager=new KZ,this.remoteDocumentCache=(function(i){return new lJ(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new hV(n),this.Ii=new iJ(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new aJ,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new oJ(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){Ee("MemoryPersistence","Starting transaction:",e);const i=new dJ(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((a=>this.referenceDelegate.di(i).next((()=>a)))).toPromise().then((a=>(i.raiseOnCommittedEvent(),a)))}Ai(e,n){return ae.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,n))))}}class dJ extends u3{constructor(e){super(),this.currentSequenceNumber=e}}class ay{constructor(e){this.persistence=e,this.Ri=new iE,this.Vi=null}static mi(e){return new ay(e)}get fi(){if(this.Vi)return this.Vi;throw Ve(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),ae.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),ae.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),ae.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next((i=>{i.forEach((a=>this.fi.add(a.toString())))})).next((()=>r.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ae.forEach(this.fi,(r=>{const i=ke.fromPath(r);return this.gi(e,i).next((a=>{a||n.removeEntry(i,He.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return ae.or([()=>ae.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class uv{constructor(e,n){this.persistence=e,this.pi=new Xs((r=>Dr(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=SV(this,n)}static mi(e,n){return new uv(e,n)}Ei(){}di(e){return ae.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>n.next((i=>r+i))))}wr(e){let n=0;return this.pr(e,(r=>{n++})).next((()=>n))}pr(e,n){return ae.forEach(this.pi,((r,i)=>this.br(e,r,i).next((a=>a?ae.resolve():n(i)))))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,(o=>this.br(e,o,n).next((c=>{c||(r++,a.removeEntry(o,He.min()))})))).next((()=>a.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),ae.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),ae.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),ae.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),ae.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=p0(e.data.value)),n}br(e,n,r){return ae.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return ae.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class fJ{constructor(e){this.serializer=e}k(e,n,r,i){const a=new Hv("createOrUpgrade",n);r<1&&i>=1&&((function(u){u.createObjectStore(Lp)})(e),(function(u){u.createObjectStore(np,{keyPath:wQ}),u.createObjectStore(ua,{keyPath:SR,autoIncrement:!0}).createIndex(oc,ER,{unique:!0}),u.createObjectStore(yd)})(e),hk(e),(function(u){u.createObjectStore(Xl)})(e));let o=ae.resolve();return r<3&&i>=3&&(r!==0&&((function(u){u.deleteObjectStore(xd),u.deleteObjectStore(bd),u.deleteObjectStore(fc)})(e),hk(e)),o=o.next((()=>(function(u){const d=u.store(fc),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:He.min().toTimestamp(),targetCount:0};return d.put(ev,h)})(a)))),r<4&&i>=4&&(r!==0&&(o=o.next((()=>(function(u,d){return d.store(ua).J().next((p=>{u.deleteObjectStore(ua),u.createObjectStore(ua,{keyPath:SR,autoIncrement:!0}).createIndex(oc,ER,{unique:!0});const m=d.store(ua),y=p.map((_=>m.put(_)));return ae.waitFor(y)}))})(e,a)))),o=o.next((()=>{(function(u){u.createObjectStore(_d,{keyPath:kQ})})(e)}))),r<5&&i>=5&&(o=o.next((()=>this.yi(a)))),r<6&&i>=6&&(o=o.next((()=>((function(u){u.createObjectStore(rp)})(e),this.wi(a))))),r<7&&i>=7&&(o=o.next((()=>this.Si(a)))),r<8&&i>=8&&(o=o.next((()=>this.bi(e,a)))),r<9&&i>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(o=o.next((()=>this.Di(a)))),r<11&&i>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(Yv,{keyPath:NQ})})(e),(function(u){u.createObjectStore(Kv,{keyPath:MQ})})(e)}))),r<12&&i>=12&&(o=o.next((()=>{(function(u){const d=u.createObjectStore(Xv,{keyPath:BQ});d.createIndex(N_,FQ,{unique:!1}),d.createIndex(v3,UQ,{unique:!1})})(e)}))),r<13&&i>=13&&(o=o.next((()=>(function(u){const d=u.createObjectStore(J0,{keyPath:EQ});d.createIndex(f0,TQ),d.createIndex(h3,AQ)})(e))).next((()=>this.Ci(e,a))).next((()=>e.deleteObjectStore(Xl)))),r<14&&i>=14&&(o=o.next((()=>this.Fi(e,a)))),r<15&&i>=15&&(o=o.next((()=>(function(u){u.createObjectStore(GS,{keyPath:PQ,autoIncrement:!0}).createIndex(k_,OQ,{unique:!1}),u.createObjectStore(Ih,{keyPath:VQ}).createIndex(g3,jQ,{unique:!1}),u.createObjectStore(Dh,{keyPath:zQ}).createIndex(m3,LQ,{unique:!1})})(e)))),r<16&&i>=16&&(o=o.next((()=>{n.objectStore(Ih).clear()})).next((()=>{n.objectStore(Dh).clear()}))),r<17&&i>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(qS,{keyPath:GQ})})(e)}))),r<18&&i>=18&&o4()&&(o=o.next((()=>{n.objectStore(Ih).clear()})).next((()=>{n.objectStore(Dh).clear()}))),o}wi(e){let n=0;return e.store(Xl).ee(((r,i)=>{n+=cv(i)})).next((()=>{const r={byteSize:n};return e.store(rp).put(R_,r)}))}yi(e){const n=e.store(np),r=e.store(ua);return n.J().next((i=>ae.forEach(i,(a=>{const o=IDBKeyRange.bound([a.userId,dc],[a.userId,a.lastAcknowledgedBatchId]);return r.J(oc,o).next((c=>ae.forEach(c,(u=>{Le(u.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const d=tc(this.serializer,u);return bV(e,a.userId,d).next((()=>{}))}))))}))))}Si(e){const n=e.store(xd),r=e.store(Xl);return e.store(fc).get(ev).next((i=>{const a=[];return r.ee(((o,c)=>{const u=new kt(o),d=(function(p){return[0,Dr(p)]})(u);a.push(n.get(d).next((h=>h?ae.resolve():(p=>n.put({targetId:0,path:Dr(p),sequenceNumber:i.highestListenSequenceNumber}))(u))))})).next((()=>ae.waitFor(a)))}))}bi(e,n){e.createObjectStore(ip,{keyPath:RQ});const r=n.store(ip),i=new rE,a=o=>{if(i.add(o)){const c=o.lastSegment(),u=o.popLast();return r.put({collectionId:c,parent:Dr(u)})}};return n.store(Xl).ee({X:!0},((o,c)=>{const u=new kt(o);return a(u.popLast())})).next((()=>n.store(yd).ee({X:!0},(([o,c,u],d)=>{const h=Ua(c);return a(h.popLast())}))))}Di(e){const n=e.store(bd);return n.ee(((r,i)=>{const a=dh(i),o=pV(this.serializer,a);return n.put(o)}))}Ci(e,n){const r=n.store(Xl),i=[];return r.ee(((a,o)=>{const c=n.store(J0),u=(function(p){return p.document?new ke(kt.fromString(p.document.name).popFirst(5)):p.noDocument?ke.fromSegments(p.noDocument.path):p.unknownDocument?ke.fromSegments(p.unknownDocument.path):Ve(36783)})(o).path.toArray(),d={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(c.put(d))})).next((()=>ae.waitFor(i)))}Fi(e,n){const r=n.store(ua),i=TV(this.serializer),a=new aE(ay.mi,this.serializer.yt);return r.J().next((o=>{const c=new Map;return o.forEach((u=>{let d=c.get(u.userId)??ft();tc(this.serializer,u).keys().forEach((h=>d=d.add(h))),c.set(u.userId,d)})),ae.forEach(c,((u,d)=>{const h=new vr(d),p=ry.wt(this.serializer,h),m=a.getIndexManager(h),y=iy.wt(h,this.serializer,m,a.referenceDelegate);return new AV(i,y,p,m).recalculateAndSaveOverlaysForDocumentKeys(new M_(n,Hi.ce),u).next()}))}))}}function hk(t){t.createObjectStore(xd,{keyPath:IQ}).createIndex(US,DQ,{unique:!0}),t.createObjectStore(bd,{keyPath:"targetId"}).createIndex(p3,CQ,{unique:!0}),t.createObjectStore(fc)}const Vo="IndexedDbPersistence",rx=18e5,ix=5e3,ax="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",hJ="main";class sE{constructor(e,n,r,i,a,o,c,u,d,h,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=a,this.window=o,this.document=c,this.xi=d,this.Oi=h,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!sE.v())throw new De(me.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new eJ(this,i),this.$i=n+hJ,this.serializer=new hV(u),this.Ui=new tl(this.$i,this.Ni,new fJ(this.serializer)),this.hi=new UZ,this.Pi=new WZ(this.referenceDelegate,this.serializer),this.remoteDocumentCache=TV(this.serializer),this.Ii=new FZ,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&jr(Vo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new De(me.FAILED_PRECONDITION,ax);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Hi(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async n=>{n.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>qm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((n=>this.isPrimary&&!n?this.Zi(e).next((()=>!1)):!!n&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(yl(e))return Ee(Vo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ee(Vo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return eh(e).get(Au).next((n=>ae.resolve(this.es(n))))}ts(e){return qm(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,rx)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(n=>{const r=er(n,_d);return r.J().next((i=>{const a=this.ss(i,rx),o=i.filter((c=>a.indexOf(c)===-1));return ae.forEach(o,(c=>r.delete(c.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?ae.resolve(!0):eh(e).get(Au).next((n=>{if(n!==null&&this.rs(n.leaseTimestampMs,ix)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new De(me.FAILED_PRECONDITION,ax);return!1}}return!(!this.networkEnabled||!this.inForeground)||qm(e).J().next((r=>this.ss(r,ix).find((i=>{if(this.clientId!==i.clientId){const a=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,c=this.networkEnabled===i.networkEnabled;if(a||o&&c)return!0}return!1}))===void 0))})).next((n=>(this.isPrimary!==n&&Ee(Vo,`Client ${n?"is":"is not"} eligible for a primary lease.`),n)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Lp,_d],(e=>{const n=new M_(e,Hi.ce);return this.Zi(n).next((()=>this.ts(n)))})),this.Ui.close(),this.Ps()}ss(e,n){return e.filter((r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>qm(e).J().next((n=>this.ss(n,rx).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return iy.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new XZ(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return ry.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){Ee(Vo,"Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",a=(function(u){return u===18?$Q:u===17?_3:u===16?HQ:u===15?HS:u===14?x3:u===13?b3:u===12?qQ:u===11?y3:void Ve(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,i,a,(c=>(o=new M_(c,this.ci?this.ci.next():Hi.ce),n==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw jr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new De(me.FAILED_PRECONDITION,c3);return r(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>r(o)))))).then((c=>(o.raiseOnCommittedEvent(),c)))}Is(e){return eh(e).get(Au).next((n=>{if(n!==null&&this.rs(n.leaseTimestampMs,ix)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new De(me.FAILED_PRECONDITION,ax)}))}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return eh(e).put(Au,n)}static v(){return tl.v()}Zi(e){const n=eh(e);return n.get(Au).next((r=>this.es(r)?(Ee(Vo,"Releasing primary lease."),n.delete(Au)):ae.resolve()))}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(jr(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;s4()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const n=this.Ki?.getItem(this._s(e))!==null;return Ee(Vo,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return jr(Vo,"Failed to get zombied client id.",n),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){jr("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function eh(t){return er(t,Lp)}function qm(t){return er(t,_d)}function pJ(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}class oE{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=ft(),i=ft();for(const a of n.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new oE(e,n.fromCache,r,i)}}class gJ{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class CV{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return s4()?8:d3(Jn())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const a={result:null};return this.ys(e,n).next((o=>{a.result=o})).next((()=>{if(!a.result)return this.ws(e,n,i,r).next((o=>{a.result=o}))})).next((()=>{if(a.result)return;const o=new gJ;return this.Ss(e,n,o).next((c=>{if(a.result=c,this.Vs)return this.bs(e,n,o,c.size)}))})).next((()=>a.result))}bs(e,n,r,i){return r.documentReadCount<this.fs?(Pu()<=bt.DEBUG&&Ee("QueryEngine","SDK will not create cache indexes for query:",Ou(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ae.resolve()):(Pu()<=bt.DEBUG&&Ee("QueryEngine","Query:",Ou(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Pu()<=bt.DEBUG&&Ee("QueryEngine","The SDK decides to create cache indexes for query:",Ou(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ki(n))):ae.resolve())}ys(e,n){if(jR(n))return ae.resolve(null);let r=Ki(n);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(n.limit!==null&&i===1&&(n=iv(n,null,"F"),r=Ki(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next((a=>{const o=ft(...a);return this.ps.getDocuments(e,o).next((c=>this.indexManager.getMinOffset(e,r).next((u=>{const d=this.Ds(n,c);return this.Cs(n,d,o,u.readTime)?this.ys(e,iv(n,null,"F")):this.vs(e,d,n,u)}))))})))))}ws(e,n,r,i){return jR(n)||i.isEqual(He.min())?ae.resolve(null):this.ps.getDocuments(e,r).next((a=>{const o=this.Ds(n,a);return this.Cs(n,o,r,i)?ae.resolve(null):(Pu()<=bt.DEBUG&&Ee("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ou(n)),this.vs(e,o,n,gQ(i,Jh)).next((c=>c)))}))}Ds(e,n){let r=new Bt(F3(e));return n.forEach(((i,a)=>{Up(e,a)&&(r=r.add(a))})),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const a=e.limitType==="F"?n.last():n.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,n,r){return Pu()<=bt.DEBUG&&Ee("QueryEngine","Using full collection scan to execute query:",Ou(n)),this.ps.getDocumentsMatchingQuery(e,n,wi.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((a=>(n.forEach((o=>{a=a.insert(o.key,o)})),a)))}}const lE="LocalStore",mJ=3e8;class vJ{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new un(nt),this.xs=new Xs((a=>Dc(a)),Bp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new AV(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function IV(t,e,n,r){return new vJ(t,e,n,r)}async function DV(t,e){const n=it(t);return await n.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next((a=>(i=a,n.Bs(e),n.mutationQueue.getAllMutationBatches(r)))).next((a=>{const o=[],c=[];let u=ft();for(const d of i){o.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}for(const d of a){c.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}return n.localDocuments.getDocuments(r,u).next((d=>({Ls:d,removedBatchIds:o,addedBatchIds:c})))}))}))}function yJ(t,e){const n=it(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),a=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,u,d,h){const p=d.batch,m=p.keys();let y=ae.resolve();return m.forEach((_=>{y=y.next((()=>h.getEntry(u,_))).next((w=>{const E=d.docVersions.get(_);Le(E!==null,48541),w.version.compareTo(E)<0&&(p.applyToRemoteDocument(w,d),w.isValidDocument()&&(w.setReadTime(d.commitVersion),h.addEntry(w)))}))})),y.next((()=>c.mutationQueue.removeMutationBatch(u,p)))})(n,r,e,a).next((()=>a.apply(r))).next((()=>n.mutationQueue.performConsistencyCheck(r))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let u=ft();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u})(e)))).next((()=>n.localDocuments.getDocuments(r,i)))}))}function RV(t){const e=it(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function bJ(t,e){const n=it(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const c=[];e.targetChanges.forEach(((h,p)=>{const m=i.get(p);if(!m)return;c.push(n.Pi.removeMatchingKeys(a,h.removedDocuments,p).next((()=>n.Pi.addMatchingKeys(a,h.addedDocuments,p))));let y=m.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(p)!==null?y=y.withResumeToken(Hn.EMPTY_BYTE_STRING,He.min()).withLastLimboFreeSnapshotVersion(He.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,r)),i=i.insert(p,y),(function(w,E,T){return w.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=mJ?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(m,y,h)&&c.push(n.Pi.updateTargetData(a,y))}));let u=bi(),d=ft();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(a,h))})),c.push(xJ(a,o,e.documentUpdates).next((h=>{u=h.ks,d=h.qs}))),!r.isEqual(He.min())){const h=n.Pi.getLastRemoteSnapshotVersion(a).next((p=>n.Pi.setTargetsMetadata(a,a.currentSequenceNumber,r)));c.push(h)}return ae.waitFor(c).next((()=>o.apply(a))).next((()=>n.localDocuments.getLocalViewOfDocuments(a,u,d))).next((()=>u))})).then((a=>(n.Ms=i,a)))}function xJ(t,e,n){let r=ft(),i=ft();return n.forEach((a=>r=r.add(a))),e.getEntries(t,r).next((a=>{let o=bi();return n.forEach(((c,u)=>{const d=a.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(He.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):Ee(lE,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)})),{ks:o,qs:i}}))}function _J(t,e){const n=it(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=dc),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function wJ(t,e){const n=it(t);return n.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return n.Pi.getTargetData(r,e).next((a=>a?(i=a,ae.resolve(i)):n.Pi.allocateTargetId(r).next((o=>(i=new Ns(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r}))}async function Y_(t,e,n){const r=it(t),i=r.Ms.get(e),a=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",a,(o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!yl(o))throw o;Ee(lE,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function pk(t,e,n){const r=it(t);let i=He.min(),a=ft();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(u,d,h){const p=it(u),m=p.xs.get(h);return m!==void 0?ae.resolve(p.Ms.get(m)):p.Pi.getTargetData(d,h)})(r,o,Ki(e)).next((c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,c.targetId).next((u=>{a=u}))})).next((()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:He.min(),n?a:ft()))).next((c=>(SJ(r,oZ(e),c),{documents:c,Qs:a})))))}function SJ(t,e,n){let r=t.Os.get(e)||He.min();n.forEach(((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)})),t.Os.set(e,r)}class gk{constructor(){this.activeTargetIds=hZ()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class kV{constructor(){this.Mo=new gk,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new gk,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class EJ{Oo(e){}shutdown(){}}const mk="ConnectivityMonitor";class vk{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ee(mk,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ee(mk,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Hm=null;function K_(){return Hm===null?Hm=(function(){return 268435456+Math.round(2147483648*Math.random())})():Hm++,"0x"+Hm.toString(16)}const sx="RestConnection",TJ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class AJ{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===tv?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,a){const o=K_(),c=this.zo(e,n.toUriEncodedString());Ee(sx,`Sending RPC '${e}' ${o}:`,c,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,a);const{host:d}=new URL(c),h=Fd(d);return this.Jo(e,c,u,r,h).then((p=>(Ee(sx,`Received RPC '${e}' ${o}: `,p),p)),(p=>{throw Cc(sx,`RPC '${e}' ${o} failed with error: `,p,"url: ",c,"request:",r),p}))}Ho(e,n,r,i,a,o){return this.Go(e,n,r,i,a)}jo(e,n,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Gd})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((i,a)=>e[a]=i)),r&&r.headers.forEach(((i,a)=>e[a]=i))}zo(e,n){const r=TJ[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}class CJ{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Er="WebChannelConnection";class IJ extends AJ{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,a){const o=K_();return new Promise(((c,u)=>{const d=new Z4;d.setWithCredentials(!0),d.listenOnce(J4.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case c0.NO_ERROR:const p=d.getResponseJson();Ee(Er,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),c(p);break;case c0.TIMEOUT:Ee(Er,`RPC '${e}' ${o} timed out`),u(new De(me.DEADLINE_EXCEEDED,"Request time out"));break;case c0.HTTP_ERROR:const m=d.getStatus();if(Ee(Er,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let y=d.getResponseJson();Array.isArray(y)&&(y=y[0]);const _=y?.error;if(_&&_.status&&_.message){const w=(function(T){const I=T.toLowerCase().replace(/_/g,"-");return Object.values(me).indexOf(I)>=0?I:me.UNKNOWN})(_.status);u(new De(w,_.message))}else u(new De(me.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new De(me.UNAVAILABLE,"Connection failed."));break;default:Ve(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Ee(Er,`RPC '${e}' ${o} completed.`)}}));const h=JSON.stringify(i);Ee(Er,`RPC '${e}' ${o} sending request:`,i),d.send(n,"POST",h,r,15)}))}T_(e,n,r){const i=K_(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=n3(),c=t3(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const h=a.join("");Ee(Er,`Creating RPC '${e}' stream ${i}: ${h}`,u);const p=o.createWebChannel(h,u);this.I_(p);let m=!1,y=!1;const _=new CJ({Yo:E=>{y?Ee(Er,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(m||(Ee(Er,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),Ee(Er,`RPC '${e}' stream ${i} sending:`,E),p.send(E))},Zo:()=>p.close()}),w=(E,T,I)=>{E.listen(T,(D=>{try{I(D)}catch(O){setTimeout((()=>{throw O}),0)}}))};return w(p,lh.EventType.OPEN,(()=>{y||(Ee(Er,`RPC '${e}' stream ${i} transport opened.`),_.o_())})),w(p,lh.EventType.CLOSE,(()=>{y||(y=!0,Ee(Er,`RPC '${e}' stream ${i} transport closed`),_.a_(),this.E_(p))})),w(p,lh.EventType.ERROR,(E=>{y||(y=!0,Cc(Er,`RPC '${e}' stream ${i} transport errored. Name:`,E.name,"Message:",E.message),_.a_(new De(me.UNAVAILABLE,"The operation could not be completed")))})),w(p,lh.EventType.MESSAGE,(E=>{if(!y){const T=E.data[0];Le(!!T,16349);const I=T,D=I?.error||I[0]?.error;if(D){Ee(Er,`RPC '${e}' stream ${i} received error:`,D);const O=D.status;let z=(function(C){const k=Bn[C];if(k!==void 0)return J3(k)})(O),P=D.message;z===void 0&&(z=me.INTERNAL,P="Unknown error status: "+O+" with message "+D.message),y=!0,_.a_(new De(z,P)),p.close()}else Ee(Er,`RPC '${e}' stream ${i} received:`,T),_.u_(T)}})),w(c,e3.STAT_EVENT,(E=>{E.stat===C_.PROXY?Ee(Er,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===C_.NOPROXY&&Ee(Er,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{_.__()}),0),_}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function DJ(){return typeof window<"u"?window:null}function b0(){return typeof document<"u"?document:null}function sy(t){return new RZ(t,!0)}class NV{constructor(e,n,r=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&Ee("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const yk="PersistentStream";class MV{constructor(e,n,r,i,a,o,c,u){this.Mi=e,this.S_=r,this.b_=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new NV(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===me.RESOURCE_EXHAUSTED?(jr(n.toString()),jr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===me.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===n&&this.G_(r,i)}),(r=>{e((()=>{const i=new De(me.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ee(yk,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(Ee(yk,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class RJ extends MV{constructor(e,n,r,i,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=a}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=MZ(this.serializer,e),r=(function(a){if(!("targetChange"in a))return He.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?He.min():o.readTime?Fr(o.readTime):He.min()})(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=U_(this.serializer),n.addTarget=(function(a,o){let c;const u=o.target;if(c=nv(u)?{documents:oV(a,u)}:{query:lV(a,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=nV(a,o.resumeToken);const d=B_(a,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(He.min())>0){c.readTime=Id(a,o.snapshotVersion.toTimestamp());const d=B_(a,o.expectedCount);d!==null&&(c.expectedCount=d)}return c})(this.serializer,e);const r=OZ(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=U_(this.serializer),n.removeTarget=e,this.q_(n)}}class kJ extends MV{constructor(e,n,r,i,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Le(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Le(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Le(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=PZ(e.writeResults,e.commitTime),r=Fr(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=U_(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((r=>sv(this.serializer,r)))};this.q_(n)}}class NJ{}class MJ extends NJ{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new De(me.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Go(e,F_(n,r),i,a,o))).catch((a=>{throw a.name==="FirebaseError"?(a.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new De(me.UNKNOWN,a.toString())}))}Ho(e,n,r,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Ho(e,F_(n,r),i,o,c,a))).catch((o=>{throw o.name==="FirebaseError"?(o.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new De(me.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class PJ{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(jr(n),this.aa=!1):Ee("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Mc="RemoteStore";class OJ{constructor(e,n,r,i,a){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((o=>{r.enqueueAndForget((async()=>{Lc(this)&&(Ee(Mc,"Restarting streams for network reachability change."),await(async function(u){const d=it(u);d.Ea.add(4),await qp(d),d.Ra.set("Unknown"),d.Ea.delete(4),await oy(d)})(this))}))})),this.Ra=new PJ(r,i)}}async function oy(t){if(Lc(t))for(const e of t.da)await e(!0)}async function qp(t){for(const e of t.da)await e(!1)}function PV(t,e){const n=it(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),fE(n)?dE(n):$d(n).O_()&&uE(n,e))}function cE(t,e){const n=it(t),r=$d(n);n.Ia.delete(e),r.O_()&&OV(n,e),n.Ia.size===0&&(r.O_()?r.L_():Lc(n)&&n.Ra.set("Unknown"))}function uE(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(He.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}$d(t).Y_(e)}function OV(t,e){t.Va.Ue(e),$d(t).Z_(e)}function dE(t){t.Va=new AZ({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),$d(t).start(),t.Ra.ua()}function fE(t){return Lc(t)&&!$d(t).x_()&&t.Ia.size>0}function Lc(t){return it(t).Ea.size===0}function VV(t){t.Va=void 0}async function VJ(t){t.Ra.set("Online")}async function jJ(t){t.Ia.forEach(((e,n)=>{uE(t,e)}))}async function zJ(t,e){VV(t),fE(t)?(t.Ra.ha(e),dE(t)):t.Ra.set("Unknown")}async function LJ(t,e,n){if(t.Ra.set("Online"),e instanceof tV&&e.state===2&&e.cause)try{await(async function(i,a){const o=a.cause;for(const c of a.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.Ia.delete(c),i.Va.removeTarget(c))})(t,e)}catch(r){Ee(Mc,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await dv(t,r)}else if(e instanceof v0?t.Va.Ze(e):e instanceof eV?t.Va.st(e):t.Va.tt(e),!n.isEqual(He.min()))try{const r=await RV(t.localStore);n.compareTo(r)>=0&&await(function(a,o){const c=a.Va.Tt(o);return c.targetChanges.forEach(((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const h=a.Ia.get(d);h&&a.Ia.set(d,h.withResumeToken(u.resumeToken,o))}})),c.targetMismatches.forEach(((u,d)=>{const h=a.Ia.get(u);if(!h)return;a.Ia.set(u,h.withResumeToken(Hn.EMPTY_BYTE_STRING,h.snapshotVersion)),OV(a,u);const p=new Ns(h.target,u,d,h.sequenceNumber);uE(a,p)})),a.remoteSyncer.applyRemoteEvent(c)})(t,n)}catch(r){Ee(Mc,"Failed to raise snapshot:",r),await dv(t,r)}}async function dv(t,e,n){if(!yl(e))throw e;t.Ea.add(1),await qp(t),t.Ra.set("Offline"),n||(n=()=>RV(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ee(Mc,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await oy(t)}))}function jV(t,e){return e().catch((n=>dv(t,n,e)))}async function Hp(t){const e=it(t),n=dl(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:dc;for(;BJ(e);)try{const i=await _J(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,FJ(e,i)}catch(i){await dv(e,i)}zV(e)&&LV(e)}function BJ(t){return Lc(t)&&t.Ta.length<10}function FJ(t,e){t.Ta.push(e);const n=dl(t);n.O_()&&n.X_&&n.ea(e.mutations)}function zV(t){return Lc(t)&&!dl(t).x_()&&t.Ta.length>0}function LV(t){dl(t).start()}async function UJ(t){dl(t).ra()}async function GJ(t){const e=dl(t);for(const n of t.Ta)e.ea(n.mutations)}async function qJ(t,e,n){const r=t.Ta.shift(),i=ZS.from(r,e,n);await jV(t,(()=>t.remoteSyncer.applySuccessfulWrite(i))),await Hp(t)}async function HJ(t,e){e&&dl(t).X_&&await(async function(r,i){if((function(o){return SZ(o)&&o!==me.ABORTED})(i.code)){const a=r.Ta.shift();dl(r).B_(),await jV(r,(()=>r.remoteSyncer.rejectFailedWrite(a.batchId,i))),await Hp(r)}})(t,e),zV(t)&&LV(t)}async function bk(t,e){const n=it(t);n.asyncQueue.verifyOperationInProgress(),Ee(Mc,"RemoteStore received new credentials");const r=Lc(n);n.Ea.add(3),await qp(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await oy(n)}async function $J(t,e){const n=it(t);e?(n.Ea.delete(2),await oy(n)):e||(n.Ea.add(2),await qp(n),n.Ra.set("Unknown"))}function $d(t){return t.ma||(t.ma=(function(n,r,i){const a=it(n);return a.sa(),new RJ(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(t.datastore,t.asyncQueue,{Xo:VJ.bind(null,t),t_:jJ.bind(null,t),r_:zJ.bind(null,t),H_:LJ.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),fE(t)?dE(t):t.Ra.set("Unknown")):(await t.ma.stop(),VV(t))}))),t.ma}function dl(t){return t.fa||(t.fa=(function(n,r,i){const a=it(n);return a.sa(),new kJ(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:UJ.bind(null,t),r_:HJ.bind(null,t),ta:GJ.bind(null,t),na:qJ.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await Hp(t)):(await t.fa.stop(),t.Ta.length>0&&(Ee(Mc,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class hE{constructor(e,n,r,i,a){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Xa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,a){const o=Date.now()+r,c=new hE(e,n,o,i,a);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new De(me.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function pE(t,e){if(jr("AsyncQueue",`${e}: ${t}`),yl(t))return new De(me.UNAVAILABLE,`${e}: ${t}`);throw t}class id{static emptySet(e){return new id(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ke.comparator(n.key,r.key):(n,r)=>ke.comparator(n.key,r.key),this.keyedMap=ch(),this.sortedSet=new un(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,r)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof id)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new id;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}class xk{constructor(){this.ga=new un(ke.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Ve(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,r)=>{e.push(r)})),e}}class Dd{constructor(e,n,r,i,a,o,c,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,i,a){const o=[];return n.forEach((c=>{o.push({type:0,doc:c})})),new Dd(e,n,id.emptySet(n),o,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Zv(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}class YJ{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class KJ{constructor(){this.queries=_k(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=it(n),a=i.queries;i.queries=_k(),a.forEach(((o,c)=>{for(const u of c.Sa)u.onError(r)}))})(this,new De(me.ABORTED,"Firestore shutting down"))}}function _k(){return new Xs((t=>B3(t)),Zv)}async function gE(t,e){const n=it(t);let r=3;const i=e.query;let a=n.queries.get(i);a?!a.ba()&&e.Da()&&(r=2):(a=new YJ,r=e.Da()?0:1);try{switch(r){case 0:a.wa=await n.onListen(i,!0);break;case 1:a.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const c=pE(o,`Initialization of query '${Ou(e.query)}' failed`);return void e.onError(c)}n.queries.set(i,a),a.Sa.push(e),e.va(n.onlineState),a.wa&&e.Fa(a.wa)&&vE(n)}async function mE(t,e){const n=it(t),r=e.query;let i=3;const a=n.queries.get(r);if(a){const o=a.Sa.indexOf(e);o>=0&&(a.Sa.splice(o,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function XJ(t,e){const n=it(t);let r=!1;for(const i of e){const a=i.query,o=n.queries.get(a);if(o){for(const c of o.Sa)c.Fa(i)&&(r=!0);o.wa=i}}r&&vE(n)}function WJ(t,e,n){const r=it(t),i=r.queries.get(e);if(i)for(const a of i.Sa)a.onError(n);r.queries.delete(e)}function vE(t){t.Ca.forEach((e=>{e.next()}))}var X_,wk;(wk=X_||(X_={})).Ma="default",wk.Cache="cache";class yE{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Dd(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Dd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==X_.Cache}}class BV{constructor(e){this.key=e}}class FV{constructor(e){this.key=e}}class QJ{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ft(),this.mutatedKeys=ft(),this.eu=F3(e),this.tu=new id(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new xk,i=n?n.tu:this.tu;let a=n?n.mutatedKeys:this.mutatedKeys,o=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,p)=>{const m=i.get(h),y=Up(this.query,p)?p:null,_=!!m&&this.mutatedKeys.has(m.key),w=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let E=!1;m&&y?m.data.isEqual(y.data)?_!==w&&(r.track({type:3,doc:y}),E=!0):this.su(m,y)||(r.track({type:2,doc:y}),E=!0,(u&&this.eu(y,u)>0||d&&this.eu(y,d)<0)&&(c=!0)):!m&&y?(r.track({type:0,doc:y}),E=!0):m&&!y&&(r.track({type:1,doc:m}),E=!0,(u||d)&&(c=!0)),E&&(y?(o=o.add(y),a=w?a.add(h):a.delete(h)):(o=o.delete(h),a=a.delete(h)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),a=a.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:c,mutatedKeys:a}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((h,p)=>(function(y,_){const w=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ve(20277,{Rt:E})}};return w(y)-w(_)})(h.type,p.type)||this.eu(h.doc,p.doc))),this.ou(r),i=i??!1;const c=n&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,d=u!==this.Za;return this.Za=u,o.length!==0||d?{snapshot:new Dd(this.query,e.tu,a,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new xk,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ft(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const n=[];return e.forEach((r=>{this.Xa.has(r)||n.push(new FV(r))})),this.Xa.forEach((r=>{e.has(r)||n.push(new BV(r))})),n}cu(e){this.Ya=e.Qs,this.Xa=ft();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Dd.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const bE="SyncEngine";class ZJ{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class JJ{constructor(e){this.key=e,this.hu=!1}}class eee{constructor(e,n,r,i,a,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Xs((c=>B3(c)),Zv),this.Iu=new Map,this.Eu=new Set,this.du=new un(ke.comparator),this.Au=new Map,this.Ru=new iE,this.Vu={},this.mu=new Map,this.fu=Nc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function tee(t,e,n=!0){const r=YV(t);let i;const a=r.Tu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await UV(r,e,n,!0),i}async function nee(t,e){const n=YV(t);await UV(n,e,!0,!1)}async function UV(t,e,n,r){const i=await wJ(t.localStore,Ki(e)),a=i.targetId,o=t.sharedClientState.addLocalQueryTarget(a,n);let c;return r&&(c=await ree(t,e,a,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&PV(t.remoteStore,i),c}async function ree(t,e,n,r,i){t.pu=(p,m,y)=>(async function(w,E,T,I){let D=E.view.ru(T);D.Cs&&(D=await pk(w.localStore,E.query,!1).then((({documents:A})=>E.view.ru(A,D))));const O=I&&I.targetChanges.get(E.targetId),z=I&&I.targetMismatches.get(E.targetId)!=null,P=E.view.applyChanges(D,w.isPrimaryClient,O,z);return Ek(w,E.targetId,P.au),P.snapshot})(t,p,m,y);const a=await pk(t.localStore,e,!0),o=new QJ(e,a.Qs),c=o.ru(a.documents),u=Gp.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),d=o.applyChanges(c,t.isPrimaryClient,u);Ek(t,n,d.au);const h=new ZJ(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function iee(t,e,n){const r=it(t),i=r.Tu.get(e),a=r.Iu.get(i.targetId);if(a.length>1)return r.Iu.set(i.targetId,a.filter((o=>!Zv(o,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Y_(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&cE(r.remoteStore,i.targetId),W_(r,i.targetId)})).catch(zc)):(W_(r,i.targetId),await Y_(r.localStore,i.targetId,!0))}async function aee(t,e){const n=it(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),cE(n.remoteStore,r.targetId))}async function see(t,e,n){const r=KV(t);try{const i=await(function(o,c){const u=it(o),d=dt.now(),h=c.reduce(((y,_)=>y.add(_.key)),ft());let p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",(y=>{let _=bi(),w=ft();return u.Ns.getEntries(y,h).next((E=>{_=E,_.forEach(((T,I)=>{I.isValidDocument()||(w=w.add(T))}))})).next((()=>u.localDocuments.getOverlayedDocuments(y,_))).next((E=>{p=E;const T=[];for(const I of c){const D=_Z(I,p.get(I.key).overlayedDocument);D!=null&&T.push(new Ws(I.key,D,k3(D.value.mapValue),Ir.exists(!0)))}return u.mutationQueue.addMutationBatch(y,d,T,c)})).next((E=>{m=E;const T=E.applyToLocalDocumentSet(p,w);return u.documentOverlayCache.saveOverlays(y,E.batchId,T)}))})).then((()=>({batchId:m.batchId,changes:G3(p)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,c,u){let d=o.Vu[o.currentUser.toKey()];d||(d=new un(nt)),d=d.insert(c,u),o.Vu[o.currentUser.toKey()]=d})(r,i.batchId,n),await $p(r,i.changes),await Hp(r.remoteStore)}catch(i){const a=pE(i,"Failed to persist write");n.reject(a)}}async function GV(t,e){const n=it(t);try{const r=await bJ(n.localStore,e);e.targetChanges.forEach(((i,a)=>{const o=n.Au.get(a);o&&(Le(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?Le(o.hu,14607):i.removedDocuments.size>0&&(Le(o.hu,42227),o.hu=!1))})),await $p(n,r,e)}catch(r){await zc(r)}}function Sk(t,e,n){const r=it(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach(((a,o)=>{const c=o.view.va(e);c.snapshot&&i.push(c.snapshot)})),(function(o,c){const u=it(o);u.onlineState=c;let d=!1;u.queries.forEach(((h,p)=>{for(const m of p.Sa)m.va(c)&&(d=!0)})),d&&vE(u)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function oee(t,e,n){const r=it(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),a=i&&i.key;if(a){let o=new un(ke.comparator);o=o.insert(a,En.newNoDocument(a,He.min()));const c=ft().add(a),u=new ny(He.min(),new Map,new un(nt),o,c);await GV(r,u),r.du=r.du.remove(a),r.Au.delete(e),xE(r)}else await Y_(r.localStore,e,!1).then((()=>W_(r,e,n))).catch(zc)}async function lee(t,e){const n=it(t),r=e.batch.batchId;try{const i=await yJ(n.localStore,e);HV(n,r,null),qV(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await $p(n,i)}catch(i){await zc(i)}}async function cee(t,e,n){const r=it(t);try{const i=await(function(o,c){const u=it(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let h;return u.mutationQueue.lookupMutationBatch(d,c).next((p=>(Le(p!==null,37113),h=p.keys(),u.mutationQueue.removeMutationBatch(d,p)))).next((()=>u.mutationQueue.performConsistencyCheck(d))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(d,h,c))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h))).next((()=>u.localDocuments.getDocuments(d,h)))}))})(r.localStore,e);HV(r,e,n),qV(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await $p(r,i)}catch(i){await zc(i)}}function qV(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function HV(t,e,n){const r=it(t);let i=r.Vu[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(n?a.reject(n):a.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function W_(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((r=>{t.Ru.containsKey(r)||$V(t,r)}))}function $V(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(cE(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),xE(t))}function Ek(t,e,n){for(const r of n)r instanceof BV?(t.Ru.addReference(r.key,e),uee(t,r)):r instanceof FV?(Ee(bE,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||$V(t,r.key)):Ve(19791,{wu:r})}function uee(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(Ee(bE,"New document in limbo: "+n),t.Eu.add(r),xE(t))}function xE(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ke(kt.fromString(e)),r=t.fu.next();t.Au.set(r,new JJ(n)),t.du=t.du.insert(n,r),PV(t.remoteStore,new Ns(Ki(Fp(n.path)),r,"TargetPurposeLimboResolution",Hi.ce))}}async function $p(t,e,n){const r=it(t),i=[],a=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,u)=>{o.push(r.pu(u,e,n).then((d=>{if((d||n)&&r.isPrimaryClient){const h=d?!d.fromCache:n?.targetChanges.get(u.targetId)?.current;r.sharedClientState.updateQueryState(u.targetId,h?"current":"not-current")}if(d){i.push(d);const h=oE.As(u.targetId,d);a.push(h)}})))})),await Promise.all(o),r.Pu.H_(i),await(async function(u,d){const h=it(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>ae.forEach(d,(m=>ae.forEach(m.Es,(y=>h.persistence.referenceDelegate.addReference(p,m.targetId,y))).next((()=>ae.forEach(m.ds,(y=>h.persistence.referenceDelegate.removeReference(p,m.targetId,y)))))))))}catch(p){if(!yl(p))throw p;Ee(lE,"Failed to update sequence numbers: "+p)}for(const p of d){const m=p.targetId;if(!p.fromCache){const y=h.Ms.get(m),_=y.snapshotVersion,w=y.withLastLimboFreeSnapshotVersion(_);h.Ms=h.Ms.insert(m,w)}}})(r.localStore,a))}async function dee(t,e){const n=it(t);if(!n.currentUser.isEqual(e)){Ee(bE,"User change. New user:",e.toKey());const r=await DV(n.localStore,e);n.currentUser=e,(function(a,o){a.mu.forEach((c=>{c.forEach((u=>{u.reject(new De(me.CANCELLED,o))}))})),a.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await $p(n,r.Ls)}}function fee(t,e){const n=it(t),r=n.Au.get(e);if(r&&r.hu)return ft().add(r.key);{let i=ft();const a=n.Iu.get(e);if(!a)return i;for(const o of a){const c=n.Tu.get(o);i=i.unionWith(c.view.nu)}return i}}function YV(t){const e=it(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=GV.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=fee.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=oee.bind(null,e),e.Pu.H_=XJ.bind(null,e.eventManager),e.Pu.yu=WJ.bind(null,e.eventManager),e}function KV(t){const e=it(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=lee.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=cee.bind(null,e),e}class fp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=sy(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return IV(this.persistence,new CV,e.initialUser,this.serializer)}Cu(e){return new aE(ay.mi,this.serializer)}Du(e){return new kV}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}fp.provider={build:()=>new fp};class hee extends fp{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Le(this.persistence.referenceDelegate instanceof uv,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new wV(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Tr.withCacheSize(this.cacheSizeBytes):Tr.DEFAULT;return new aE((r=>uv.mi(r,n)),this.serializer)}}class pee extends fp{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await KV(this.xu.syncEngine),await Hp(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return IV(this.persistence,new CV,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new wV(r,e.asyncQueue,n)}Mu(e,n){const r=new bQ(n,this.persistence);return new yQ(e.asyncQueue,r)}Cu(e){const n=pJ(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Tr.withCacheSize(this.cacheSizeBytes):Tr.DEFAULT;return new sE(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,DJ(),b0(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new kV}}class fv{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Sk(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=dee.bind(null,this.syncEngine),await $J(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new KJ})()}createDatastore(e){const n=sy(e.databaseInfo.databaseId),r=(function(a){return new IJ(a)})(e.databaseInfo);return(function(a,o,c,u){return new MJ(a,o,c,u)})(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return(function(r,i,a,o,c){return new OJ(r,i,a,o,c)})(this.localStore,this.datastore,e.asyncQueue,(n=>Sk(this.syncEngine,n,0)),(function(){return vk.v()?new vk:new EJ})())}createSyncEngine(e,n){return(function(i,a,o,c,u,d,h){const p=new eee(i,a,o,c,u,d);return h&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const r=it(n);Ee(Mc,"RemoteStore shutting down."),r.Ea.add(5),await qp(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}fv.provider={build:()=>new fv};class _E{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):jr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const fl="FirestoreClient";class gee{constructor(e,n,r,i,a){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=vr.UNAUTHENTICATED,this.clientId=LS.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,(async o=>{Ee(fl,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(Ee(fl,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Xa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=pE(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function ox(t,e){t.asyncQueue.verifyOperationInProgress(),Ee(fl,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener((async i=>{r.isEqual(i)||(await DV(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function Tk(t,e){t.asyncQueue.verifyOperationInProgress();const n=await mee(t);Ee(fl,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((r=>bk(e.remoteStore,r))),t.setAppCheckTokenChangeListener(((r,i)=>bk(e.remoteStore,i))),t._onlineComponents=e}async function mee(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ee(fl,"Using user provided OfflineComponentProvider");try{await ox(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(i){return i.name==="FirebaseError"?i.code===me.FAILED_PRECONDITION||i.code===me.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(n))throw n;Cc("Error using user provided cache. Falling back to memory cache: "+n),await ox(t,new fp)}}else Ee(fl,"Using default OfflineComponentProvider"),await ox(t,new hee(void 0));return t._offlineComponents}async function XV(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ee(fl,"Using user provided OnlineComponentProvider"),await Tk(t,t._uninitializedComponentsProvider._online)):(Ee(fl,"Using default OnlineComponentProvider"),await Tk(t,new fv))),t._onlineComponents}function vee(t){return XV(t).then((e=>e.syncEngine))}async function hv(t){const e=await XV(t),n=e.eventManager;return n.onListen=tee.bind(null,e.syncEngine),n.onUnlisten=iee.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=nee.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=aee.bind(null,e.syncEngine),n}function yee(t,e,n={}){const r=new Xa;return t.asyncQueue.enqueueAndForget((async()=>(function(a,o,c,u,d){const h=new _E({next:m=>{h.Nu(),o.enqueueAndForget((()=>mE(a,p)));const y=m.docs.has(c);!y&&m.fromCache?d.reject(new De(me.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&u&&u.source==="server"?d.reject(new De(me.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new yE(Fp(c.path),h,{includeMetadataChanges:!0,qa:!0});return gE(a,p)})(await hv(t),t.asyncQueue,e,n,r))),r.promise}function bee(t,e,n={}){const r=new Xa;return t.asyncQueue.enqueueAndForget((async()=>(function(a,o,c,u,d){const h=new _E({next:m=>{h.Nu(),o.enqueueAndForget((()=>mE(a,p))),m.fromCache&&u.source==="server"?d.reject(new De(me.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new yE(c,h,{includeMetadataChanges:!0,qa:!0});return gE(a,p)})(await hv(t),t.asyncQueue,e,n,r))),r.promise}function WV(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const Ak=new Map;const QV="firestore.googleapis.com",Ck=!0;class Ik{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new De(me.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=QV,this.ssl=Ck}else this.host=e.host,this.ssl=e.ssl??Ck;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=yV;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<QZ)throw new De(me.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}pQ("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=WV(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new De(me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new De(me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new De(me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ly{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ik({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new De(me.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new De(me.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ik(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new iQ;switch(r.type){case"firstParty":return new lQ(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new De(me.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const r=Ak.get(n);r&&(Ee("ComponentProvider","Removing Datastore"),Ak.delete(n),r.terminate())})(this),Promise.resolve()}}function xee(t,e,n,r={}){t=Br(t,ly);const i=Fd(e),a=t._getSettings(),o={...a,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${n}`;i&&(r4(`https://${c}`),i4("Firestore",!0)),a.host!==QV&&a.host!==c&&Cc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...a,host:c,ssl:i,emulatorOptions:r};if(!wc(u,o)&&(t._setSettings(u),r.mockUserToken)){let d,h;if(typeof r.mockUserToken=="string")d=r.mockUserToken,h=vr.MOCK_USER;else{d=fY(r.mockUserToken,t._app?.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new De(me.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new vr(p)}t._authCredentials=new aQ(new i3(d,h))}}class Qs{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Qs(this.firestore,e,this._query)}}class Tn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new nl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Tn(this.firestore,e,this._key)}toJSON(){return{type:Tn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(zp(n,Tn._jsonSchema))return new Tn(e,r||null,new ke(kt.fromString(n.referencePath)))}}Tn._jsonSchemaVersion="firestore/documentReference/1.0",Tn._jsonSchema={type:Gn("string",Tn._jsonSchemaVersion),referencePath:Gn("string")};class nl extends Qs{constructor(e,n,r){super(e,n,Fp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Tn(this.firestore,null,new ke(e))}withConverter(e){return new nl(this.firestore,e,this._path)}}function La(t,e,...n){if(t=vn(t),s3("collection","path",e),t instanceof ly){const r=kt.fromString(e,...n);return yR(r),new nl(t,null,r)}{if(!(t instanceof Tn||t instanceof nl))throw new De(me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(kt.fromString(e,...n));return yR(r),new nl(t.firestore,null,r)}}function Sn(t,e,...n){if(t=vn(t),arguments.length===1&&(e=LS.newId()),s3("doc","path",e),t instanceof ly){const r=kt.fromString(e,...n);return vR(r),new Tn(t,null,new ke(r))}{if(!(t instanceof Tn||t instanceof nl))throw new De(me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(kt.fromString(e,...n));return vR(r),new Tn(t.firestore,t instanceof nl?t.converter:null,new ke(r))}}const Dk="AsyncQueue";class Rk{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new NV(this,"async_queue_retry"),this._c=()=>{const r=b0();r&&Ee(Dk,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=b0();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=b0();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new Xa;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!yl(e))throw e;Ee(Dk,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,jr("INTERNAL UNHANDLED ERROR: ",kk(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=hE.createAndSchedule(this,e,n,r,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&Ve(47125,{Pc:kk(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,r)=>n.targetTimeMs-r.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function kk(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}function Nk(t){return(function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const a of r)if(a in i&&typeof i[a]=="function")return!0;return!1})(t,["next","error","complete"])}class ts extends ly{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Rk,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Rk(e),this._firestoreClient=void 0,await e}}}function _ee(t,e){const n=typeof t=="object"?t:f4(),r=typeof t=="string"?t:tv,i=DS(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const a=uY("firestore");a&&xee(i,...a)}return i}function cy(t){if(t._terminated)throw new De(me.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||ZV(t),t._firestoreClient}function ZV(t){const e=t._freezeSettings(),n=(function(i,a,o,c){return new KQ(i,a,o,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,WV(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new gee(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}})(t._componentsProvider))}function wee(t,e){Cc("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return See(t,fv.provider,{build:r=>new pee(r,n.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function See(t,e,n){if((t=Br(t,ts))._firestoreClient||t._terminated)throw new De(me.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new De(me.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},ZV(t)}class Gi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gi(Hn.fromBase64String(e))}catch(n){throw new De(me.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Gi(Hn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Gi._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(zp(e,Gi._jsonSchema))return Gi.fromBase64String(e.bytes)}}Gi._jsonSchemaVersion="firestore/bytes/1.0",Gi._jsonSchema={type:Gn("string",Gi._jsonSchemaVersion),bytes:Gn("string")};class uy{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new De(me.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class wE{constructor(e){this._methodName=e}}class Wa{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new De(me.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new De(me.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return nt(this._lat,e._lat)||nt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Wa._jsonSchemaVersion}}static fromJSON(e){if(zp(e,Wa._jsonSchema))return new Wa(e.latitude,e.longitude)}}Wa._jsonSchemaVersion="firestore/geoPoint/1.0",Wa._jsonSchema={type:Gn("string",Wa._jsonSchemaVersion),latitude:Gn("number"),longitude:Gn("number")};class Qa{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Qa._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(zp(e,Qa._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new Qa(e.vectorValues);throw new De(me.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Qa._jsonSchemaVersion="firestore/vectorValue/1.0",Qa._jsonSchema={type:Gn("string",Qa._jsonSchemaVersion),vectorValues:Gn("object")};const Eee=/^__.*__$/;class Tee{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ws(e,this.data,this.fieldMask,n,this.fieldTransforms):new Hd(e,this.data,n,this.fieldTransforms)}}class JV{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ws(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function ej(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ve(40011,{Ac:t})}}class SE{constructor(e,n,r,i,a,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new SE({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){const n=this.path?.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return pv(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(ej(this.Ac)&&Eee.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Aee{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||sy(e)}Cc(e,n,r,i=!1){return new SE({Ac:e,methodName:n,Dc:r,path:gn.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function dy(t){const e=t._freezeSettings(),n=sy(t._databaseId);return new Aee(t._databaseId,!!e.ignoreUndefinedProperties,n)}function tj(t,e,n,r,i,a={}){const o=t.Cc(a.merge||a.mergeFields?2:0,e,n,i);EE("Data must be an object, but it was:",o,r);const c=nj(r,o);let u,d;if(a.merge)u=new ri(o.fieldMask),d=o.fieldTransforms;else if(a.mergeFields){const h=[];for(const p of a.mergeFields){const m=Q_(e,p,n);if(!o.contains(m))throw new De(me.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);ij(h,m)||h.push(m)}u=new ri(h),d=o.fieldTransforms.filter((p=>u.covers(p.field)))}else u=null,d=o.fieldTransforms;return new Tee(new Ar(c),u,d)}class fy extends wE{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof fy}}function Cee(t,e,n,r){const i=t.Cc(1,e,n);EE("Data must be an object, but it was:",i,r);const a=[],o=Ar.empty();bl(r,((u,d)=>{const h=TE(e,u,n);d=vn(d);const p=i.yc(h);if(d instanceof fy)a.push(h);else{const m=Yp(d,p);m!=null&&(a.push(h),o.set(h,m))}}));const c=new ri(a);return new JV(o,c,i.fieldTransforms)}function Iee(t,e,n,r,i,a){const o=t.Cc(1,e,n),c=[Q_(e,r,n)],u=[i];if(a.length%2!=0)throw new De(me.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<a.length;m+=2)c.push(Q_(e,a[m])),u.push(a[m+1]);const d=[],h=Ar.empty();for(let m=c.length-1;m>=0;--m)if(!ij(d,c[m])){const y=c[m];let _=u[m];_=vn(_);const w=o.yc(y);if(_ instanceof fy)d.push(y);else{const E=Yp(_,w);E!=null&&(d.push(y),h.set(y,E))}}const p=new ri(d);return new JV(h,p,o.fieldTransforms)}function Dee(t,e,n,r=!1){return Yp(n,t.Cc(r?4:3,e))}function Yp(t,e){if(rj(t=vn(t)))return EE("Unsupported field value:",e,t),nj(t,e);if(t instanceof wE)return(function(r,i){if(!ej(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(i);a&&i.fieldTransforms.push(a)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const a=[];let o=0;for(const c of r){let u=Yp(c,i.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),o++}return{arrayValue:{values:a}}})(t,e)}return(function(r,i){if((r=vn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return pZ(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=dt.fromDate(r);return{timestampValue:Id(i.serializer,a)}}if(r instanceof dt){const a=new dt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Id(i.serializer,a)}}if(r instanceof Wa)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Gi)return{bytesValue:nV(i.serializer,r._byteString)};if(r instanceof Tn){const a=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(a))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:tE(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Qa)return(function(o,c){return{mapValue:{fields:{[YS]:{stringValue:KS},[wd]:{arrayValue:{values:o.toArray().map((d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return WS(c.serializer,d)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${qv(r)}`)})(t,e)}function nj(t,e){const n={};return w3(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):bl(t,((r,i)=>{const a=Yp(i,e.mc(r));a!=null&&(n[r]=a)})),{mapValue:{fields:n}}}function rj(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof dt||t instanceof Wa||t instanceof Gi||t instanceof Tn||t instanceof wE||t instanceof Qa)}function EE(t,e,n){if(!rj(n)||!o3(n)){const r=qv(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function Q_(t,e,n){if((e=vn(e))instanceof uy)return e._internalPath;if(typeof e=="string")return TE(t,e);throw pv("Field path arguments must be of type string or ",t,!1,void 0,n)}const Ree=new RegExp("[~\\*/\\[\\]]");function TE(t,e,n){if(e.search(Ree)>=0)throw pv(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new uy(...e.split("."))._internalPath}catch{throw pv(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function pv(t,e,n,r,i){const a=r&&!r.isEmpty(),o=i!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(a||o)&&(u+=" (found",a&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new De(me.INVALID_ARGUMENT,c+t+u)}function ij(t,e){return t.some((n=>n.isEqual(e)))}class aj{constructor(e,n,r,i,a){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Tn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new kee(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(hy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class kee extends aj{data(){return super.data()}}function hy(t,e){return typeof e=="string"?TE(t,e):e instanceof uy?e._internalPath:e._delegate._internalPath}function sj(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new De(me.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class AE{}class CE extends AE{}function ha(t,e,...n){let r=[];e instanceof AE&&r.push(e),r=r.concat(n),(function(a){const o=a.filter((u=>u instanceof IE)).length,c=a.filter((u=>u instanceof py)).length;if(o>1||o>0&&c>0)throw new De(me.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)t=i._apply(t);return t}class py extends CE{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new py(e,n,r)}_apply(e){const n=this._parse(e);return oj(e._query,n),new Qs(e.firestore,e.converter,L_(e._query,n))}_parse(e){const n=dy(e.firestore);return(function(a,o,c,u,d,h,p){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new De(me.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){Ok(p,h);const _=[];for(const w of p)_.push(Pk(u,a,w));m={arrayValue:{values:_}}}else m=Pk(u,a,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||Ok(p,h),m=Dee(c,o,p,h==="in"||h==="not-in");return xt.create(d,h,m)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function $m(t,e,n){const r=e,i=hy("where",t);return py._create(i,r,n)}class IE extends AE{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new IE(e,n)}_parse(e){const n=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return n.length===1?n[0]:Lt.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(i,a){let o=i;const c=a.getFlattenedFilters();for(const u of c)oj(o,u),o=L_(o,u)})(e._query,n),new Qs(e.firestore,e.converter,L_(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class DE extends CE{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new DE(e,n)}_apply(e){const n=(function(i,a,o){if(i.startAt!==null)throw new De(me.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new De(me.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new cp(a,o)})(e._query,this._field,this._direction);return new Qs(e.firestore,e.converter,(function(i,a){const o=i.explicitOrderBy.concat([a]);return new qd(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,n))}}function hp(t,e="asc"){const n=e,r=hy("orderBy",t);return DE._create(r,n)}class RE extends CE{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new RE(e,n,r)}_apply(e){return new Qs(e.firestore,e.converter,iv(e._query,this._limit,this._limitType))}}function Mk(t){return RE._create("limit",t,"F")}function Pk(t,e,n){if(typeof(n=vn(n))=="string"){if(n==="")throw new De(me.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!L3(e)&&n.indexOf("/")!==-1)throw new De(me.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(kt.fromString(n));if(!ke.isDocumentKey(r))throw new De(me.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return op(t,new ke(r))}if(n instanceof Tn)return op(t,n._key);throw new De(me.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${qv(n)}.`)}function Ok(t,e){if(!Array.isArray(t)||t.length===0)throw new De(me.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function oj(t,e){const n=(function(i,a){for(const o of i)for(const c of o.getFlattenedFilters())if(a.indexOf(c.op)>=0)return c.op;return null})(t.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new De(me.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new De(me.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Nee{convertValue(e,n="none"){switch(cl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ln(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes($s(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ve(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return bl(e,((i,a)=>{r[i]=this.convertValue(a,n)})),r}convertVectorValue(e){const n=e.fields?.[wd].arrayValue?.values?.map((r=>ln(r.doubleValue)));return new Qa(n)}convertGeoPoint(e){return new Wa(ln(e.latitude),ln(e.longitude))}convertArray(e,n){return(e.values||[]).map((r=>this.convertValue(r,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Wv(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ap(e));default:return null}}convertTimestamp(e){const n=Hs(e);return new dt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=kt.fromString(e);Le(fV(r),9688,{name:e});const i=new Ic(r.get(1),r.get(3)),a=new ke(r.popFirst(5));return i.isEqual(n)||jr(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),a}}function lj(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class fh{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class pc extends aj{constructor(e,n,r,i,a,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new x0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(hy("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new De(me.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=pc._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}pc._jsonSchemaVersion="firestore/documentSnapshot/1.0",pc._jsonSchema={type:Gn("string",pc._jsonSchemaVersion),bundleSource:Gn("string","DocumentSnapshot"),bundleName:Gn("string"),bundle:Gn("string")};class x0 extends pc{data(e={}){return super.data(e)}}class gc{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new fh(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((r=>{e.call(n,new x0(this._firestore,this._userDataWriter,r.key,r,new fh(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new De(me.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((c=>{const u=new x0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new fh(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((c=>a||c.type!==3)).map((c=>{const u=new x0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new fh(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),h=o.indexOf(c.doc.key)),{type:Mee(c.type),doc:u,oldIndex:d,newIndex:h}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new De(me.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=gc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=LS.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(n.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Mee(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ve(61501,{type:t})}}function Pee(t){t=Br(t,Tn);const e=Br(t.firestore,ts);return yee(cy(e),t._key).then((n=>cj(e,t,n)))}gc._jsonSchemaVersion="firestore/querySnapshot/1.0",gc._jsonSchema={type:Gn("string",gc._jsonSchemaVersion),bundleSource:Gn("string","QuerySnapshot"),bundleName:Gn("string"),bundle:Gn("string")};class kE extends Nee{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gi(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Tn(this.firestore,null,n)}}function Rd(t){t=Br(t,Qs);const e=Br(t.firestore,ts),n=cy(e),r=new kE(e);return sj(t._query),bee(n,t._query).then((i=>new gc(e,r,t,i)))}function Ho(t,e,n){t=Br(t,Tn);const r=Br(t.firestore,ts),i=lj(t.converter,e,n);return my(r,[tj(dy(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Ir.none())])}function Kp(t,e,n,...r){t=Br(t,Tn);const i=Br(t.firestore,ts),a=dy(i);let o;return o=typeof(e=vn(e))=="string"||e instanceof uy?Iee(a,"updateDoc",t._key,e,n,r):Cee(a,"updateDoc",t._key,e),my(i,[o.toMutation(t._key,Ir.exists(!0))])}function kd(t){return my(Br(t.firestore,ts),[new ty(t._key,Ir.none())])}function gy(t,e){const n=Br(t.firestore,ts),r=Sn(t),i=lj(t.converter,e);return my(n,[tj(dy(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Ir.exists(!1))]).then((()=>r))}function mc(t,...e){t=vn(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Nk(e[r])||(n=e[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(Nk(e[r])){const u=e[r];e[r]=u.next?.bind(u),e[r+1]=u.error?.bind(u),e[r+2]=u.complete?.bind(u)}let a,o,c;if(t instanceof Tn)o=Br(t.firestore,ts),c=Fp(t._key.path),a={next:u=>{e[r]&&e[r](cj(o,t,u))},error:e[r+1],complete:e[r+2]};else{const u=Br(t,Qs);o=Br(u.firestore,ts),c=u._query;const d=new kE(o);a={next:h=>{e[r]&&e[r](new gc(o,d,u,h))},error:e[r+1],complete:e[r+2]},sj(t._query)}return(function(d,h,p,m){const y=new _E(m),_=new yE(h,y,p);return d.asyncQueue.enqueueAndForget((async()=>gE(await hv(d),_))),()=>{y.Nu(),d.asyncQueue.enqueueAndForget((async()=>mE(await hv(d),_)))}})(cy(o),c,i,a)}function my(t,e){return(function(r,i){const a=new Xa;return r.asyncQueue.enqueueAndForget((async()=>see(await vee(r),i,a))),a.promise})(cy(t),e)}function cj(t,e,n){const r=n.docs.get(e._key),i=new kE(t);return new pc(t,i,e._key,r,new fh(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(i){Gd=i})(Ud),gd(new Sc("firestore",((r,{instanceIdentifier:i,options:a})=>{const o=r.getProvider("app").getImmediate(),c=new ts(new sQ(r.getProvider("auth-internal")),new cQ(o,r.getProvider("app-check-internal")),(function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new De(me.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ic(d.options.projectId,h)})(o,i),o);return a={useFetchStreams:n,...a},c._setSettings(a),c}),"PUBLIC").setMultipleInstances(!0)),Jo(hR,pR,e),Jo(hR,pR,"esm2020")})();const Oee={apiKey:"AIzaSyDwUA0paVI6n01aENV5Q2aLwVz1DEDtNuA",authDomain:"personal-budget-pwa-5defb.firebaseapp.com",projectId:"personal-budget-pwa-5defb",storageBucket:"personal-budget-pwa-5defb.firebasestorage.app",messagingSenderId:"137454342284",appId:"1:137454342284:web:d7a8169fd53f437e42aba9"},uj=d4(Oee),jo=eQ(uj),Mt=_ee(uj);wee(Mt).catch(t=>{t.code==="failed-precondition"?console.warn(" Offline persistence failed: Multiple tabs open"):t.code==="unimplemented"?console.warn(" Offline persistence not available in this browser"):console.error(" Failed to enable offline persistence:",t)});const lx=t=>({id:t.uid,username:t.email||t.uid,displayName:t.displayName||t.email?.split("@")[0]||"User",email:t.email||void 0}),Xi=Vv()(TS(t=>({currentUser:null,isAuthenticated:!1,loginError:null,isLoading:!1,isInitialized:!1,isInitializing:!0,lastAuthTime:null,offlineGracePeriod:10080*60*1e3,lastVerificationEmailSent:null,login:async(e,n)=>{t({isLoading:!0,loginError:null});try{const i=(await jX(jo,e,n)).user;if(!i.emailVerified)return await nR(jo),t({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:"Please verify your email address before signing in. Check your email for a verification link."}),console.log(` Login blocked: ${i.email} not verified`),!1;const a=lx(i);return t({currentUser:a,isAuthenticated:!0,isLoading:!1,loginError:null,lastAuthTime:Date.now()}),console.log(` User logged in: ${a.email}`),!0}catch(r){console.error("Login error:",r),console.error("Error code:",r.code),console.error("Error message:",r.message);let i="Login failed. Please try again.";if(r.code)switch(r.code){case"auth/invalid-email":i="Invalid email address.";break;case"auth/user-disabled":i="This account has been disabled.";break;case"auth/user-not-found":i="No account found with this email.";break;case"auth/wrong-password":i="Incorrect password.";break;case"auth/too-many-requests":i="Too many failed attempts. Please try again later.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break;case"auth/invalid-credential":i="Invalid email or password.";break;default:console.warn(`Unhandled Firebase error code: ${r.code}`),i="Authentication failed. Please try again.";break}else console.warn("Non-Firebase error in login:",r),i="An unexpected error occurred. Please try again.";return t({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:i}),!1}},register:async(e,n,r)=>{t({isLoading:!0,loginError:null});try{const a=(await VX(jo,e,n)).user;await LX(a,{displayName:r}),await tR(a);const o=lx(a);return t({currentUser:o,isAuthenticated:!1,isLoading:!1,loginError:null,lastVerificationEmailSent:Date.now()}),console.log(` User registered: ${o.email}, verification email sent`),!0}catch(i){console.error("Registration error:",i);let a="Registration failed. Please try again.";switch(i.code){case"auth/email-already-in-use":a="An account with this email already exists.";break;case"auth/invalid-email":a="Invalid email address.";break;case"auth/weak-password":a="Password should be at least 6 characters.";break;case"auth/operation-not-allowed":a="Email/password accounts are not enabled.";break}return t({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:a}),!1}},logout:async()=>{try{await nR(jo),console.log(" User logged out")}catch(e){console.error("Logout error:",e)}},clearError:()=>{t({loginError:null})},sendPasswordReset:async e=>{t({isLoading:!0,loginError:null});try{return await OX(jo,e),t({isLoading:!1}),!0}catch(n){console.error("Password reset error:",n);let r="Failed to send password reset email. Please try again.";switch(n.code){case"auth/user-not-found":r="No account found with this email.";break;case"auth/invalid-email":r="Invalid email address.";break;case"auth/too-many-requests":r="Too many attempts. Please try again later.";break}return t({isLoading:!1,loginError:r}),!1}},sendEmailVerification:async()=>{const e=jo.currentUser;if(!e)return t({loginError:"No user is currently signed in."}),!1;t({isLoading:!0,loginError:null});try{return await tR(e),t({isLoading:!1,lastVerificationEmailSent:Date.now()}),console.log(` Verification email sent to: ${e.email}`),!0}catch(n){console.error("Email verification error:",n);let r="Failed to send verification email. Please try again.";switch(n.code){case"auth/too-many-requests":r="Too many verification emails sent. Please wait before trying again.";break}return t({isLoading:!1,loginError:r}),!1}},resendEmailVerification:async()=>{const e=Xi.getState();if(e.lastVerificationEmailSent){const n=Date.now()-e.lastVerificationEmailSent,r=60*1e3;if(n<r){const i=Math.ceil((r-n)/1e3);return t({loginError:`Please wait ${i} seconds before requesting another verification email.`}),!1}}return e.sendEmailVerification()},deleteAccount:async e=>{const n=jo.currentUser;if(!n||!n.email)return t({loginError:"No user is currently signed in."}),!1;t({isLoading:!0,loginError:null});try{const r=jc.credential(n.email,e);return await PX(n,r),await GX(n),t({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:null,lastAuthTime:null}),console.log(` Account permanently deleted: ${n.email}`),!0}catch(r){console.error("Account deletion error:",r);let i="Failed to delete account. Please try again.";switch(r.code){case"auth/requires-recent-login":i="For security, please log out and log back in before deleting your account.";break;case"auth/wrong-password":i="Incorrect password. Please enter your current password.";break;case"auth/too-many-requests":i="Too many deletion attempts. Please wait before trying again.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break}return t({isLoading:!1,loginError:i}),!1}},initializeAuth:()=>Xi.getState().isInitialized?()=>{}:(t({isInitialized:!1}),UX(jo,r=>{const i=Date.now(),a=Xi.getState(),o=r?lx(r):null,c=a.lastAuthTime&&i-a.lastAuthTime<a.offlineGracePeriod,d=typeof navigator<"u"&&!navigator.onLine&&a.isAuthenticated&&c&&!o,h=r?r.emailVerified:!0,p=r&&h||!!d,m=r?o:d?a.currentUser:null;t({currentUser:m,isAuthenticated:p,isInitialized:!0,isLoading:!1,loginError:null,lastAuthTime:r&&h?i:a.lastAuthTime}),m?console.log(` Auth state: User is signed in (${m.email})`,d?"(offline grace period)":h?"(verified)":"(unverified)"):console.log(" Auth state: User is signed out")}))}),{name:"auth-storage",partialize:t=>({isAuthenticated:t.isAuthenticated,currentUser:t.currentUser,lastAuthTime:t.lastAuthTime,offlineGracePeriod:t.offlineGracePeriod,lastVerificationEmailSent:t.lastVerificationEmailSent})})),Vee=t=>t==="income"?"Income":t==="expense"?"Expense":t==="transfer"?"Transfer":t,dj=t=>{const e=t.toLowerCase();return e==="income"||e==="expense"||e==="transfer"?e:"expense"},NE=t=>{const e=t.date?.toDate?.()?t.date.toDate().toISOString():t.date,n=new Date(e),r=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`;return{id:t.id,date:e,amount:typeof t.amount=="string"?parseFloat(t.amount)||0:t.amount,description:t.description||"",merchant:t.merchant||void 0,envelopeId:t.envelopeId||"",reconciled:t.reconciled??!1,type:Vee(t.type),transferId:t.transferId??void 0,userId:t.userId,month:r,isAutomatic:t.isAutomatic??void 0,paymentMethod:t.paymentMethod??void 0}},jee=(t,e)=>{const n={id:t.id,userId:e,envelopeId:t.envelopeId,amount:t.amount.toString(),date:dt.fromDate(new Date(t.date)),description:t.description,merchant:t.merchant||null,reconciled:t.reconciled??!1,type:dj(t.type),transferId:t.transferId??null};return t.isAutomatic===!0&&(n.isAutomatic=!0),t.paymentMethod&&(n.paymentMethod=t.paymentMethod),n},zee=t=>{const e={envelopeId:t.envelopeId,amount:t.amount.toString(),date:dt.fromDate(new Date(t.date)),description:t.description,merchant:t.merchant||null,reconciled:t.reconciled??!1,type:dj(t.type),transferId:t.transferId??null};return t.isAutomatic===!0&&(e.isAutomatic=!0),t.paymentMethod&&(e.paymentMethod=t.paymentMethod),e},cx=t=>La(Mt,"users",t,"transactions"),da={subscribeToTransactions:(t,e)=>{const n=ha(cx(t),hp("date","desc"));return mc(n,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllTransactions:async t=>{console.log(` TransactionService.getAllTransactions: Fetching for user ${t}`);const e=ha(cx(t),hp("date","desc")),r=(await Rd(e)).docs.map(i=>{const a={id:i.id,...i.data()};return NE(a)});return console.log(` Fetched ${r.length} transactions:`,r.map(i=>({id:i.id,description:i.description,month:i.month}))),r},addTransaction:async t=>{const{userId:e,id:n,...r}=t;if(!e)throw new Error("User ID is required to create transaction");console.log(` TransactionService.addTransaction: Adding transaction for user ${e}:`,r),console.log(` Original transaction had temp ID: ${n}`);try{console.log(" About to call addDoc with:",r);const i=await gy(cx(e),r);console.log(" addDoc succeeded, docRef:",i),console.log(` Document ID: ${i.id}`),console.log(` Document path: ${i.path}`);const a={id:i.id,...r,userId:e};return console.log(" Final result object:",a),a}catch(i){throw console.error(" addDoc failed:",i),console.error("Error message:",i.message),i}},updateTransaction:async(t,e,n)=>{const r=Sn(Mt,"users",t,"transactions",e);return await Kp(r,n)},deleteTransaction:async(t,e)=>{console.log(` TransactionService.deleteTransaction: Deleting transaction ${e} for user ${t}`);try{const n=Sn(Mt,"users",t,"transactions",e);console.log(` Deleting document at path: ${n.path}`),await kd(n),console.log(` TransactionService.deleteTransaction: Successfully deleted transaction ${e}`)}catch(n){throw console.error(` TransactionService.deleteTransaction: Failed to delete transaction ${e}:`,n),console.error("Error message:",n.message),n}}},ux=t=>La(Mt,"users",t,"envelopes"),Fi={subscribeToEnvelopes:(t,e)=>{const n=ha(ux(t),hp("orderIndex","asc"));return mc(n,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllEnvelopes:async t=>{try{console.log(" EnvelopeService.getAllEnvelopes called for user:",t);const e=ux(t),i=(await Rd(e)).docs.map((a,o)=>({id:a.id,...a.data(),orderIndex:a.data().orderIndex??o})).sort((a,o)=>{const c=a.orderIndex??0,u=o.orderIndex??0;return c-u});return console.log(" Fetched envelopes:",i.length),i}catch(e){return console.error(" EnvelopeService.getAllEnvelopes failed:",e),[]}},createEnvelope:async t=>{const{userId:e,id:n,...r}=t;if(!e)throw new Error("User ID is required to create envelope");try{return{id:(await gy(ux(e),r)).id,...r,userId:e}}catch(i){throw console.error(" Envelope addDoc failed:",i),i}},saveEnvelope:async(t,e)=>{if(!e.id)throw new Error("Envelope ID is required for save operation");const n=Sn(Mt,"users",t,"envelopes",e.id);return await Ho(n,e,{merge:!0})},updateBalance:async(t,e,n)=>{const r=Sn(Mt,"users",t,"envelopes",e);return await Kp(r,{currentBalance:n,lastUpdated:new Date().toISOString()})},deleteEnvelope:async(t,e)=>{console.log(` EnvelopeService.deleteEnvelope: Deleting envelope ${e} for user ${t}`);const n=Sn(Mt,"users",t,"envelopes",e);await kd(n),console.log(` EnvelopeService.deleteEnvelope: Successfully deleted envelope ${e}`)}},dx=t=>{const e={...t},n=e;if(Object.keys(e).forEach(r=>{e[r]===void 0&&delete n[r]}),e.piggybankConfig){const r={...e.piggybankConfig},i=r;Object.keys(r).forEach(a=>{r[a]===void 0&&delete i[a]}),e.piggybankConfig=r}return e},Lee=({set:t,get:e,getCurrentUserId:n,isNetworkError:r})=>{const i=a=>({id:a.id,date:a.date?.toDate?.()?a.date.toDate().toISOString():a.date,amount:parseFloat(a.amount)||0,description:a.description||"",envelopeId:a.envelopeId||"",reconciled:a.reconciled||!1,type:a.type==="income"?"Income":a.type==="expense"?"Expense":"Transfer",transferId:a.transferId||void 0,userId:a.userId||void 0});return{createEnvelope:async a=>{const o=a.currentBalance&&a.currentBalance>0,c=o?{...a,currentBalance:0,orderIndex:a.orderIndex??0}:{...a,orderIndex:a.orderIndex??0},u=`temp-${Date.now()}-${Math.random()}`,d={...c,id:u};if(t(h=>({envelopes:[...h.envelopes,d],isLoading:!0})),o){console.log(` Creating initial deposit transaction locally first: ${d.name} (tempId: ${u})`);try{await e().addTransaction({description:"Initial Deposit",amount:a.currentBalance,envelopeId:u,date:new Date().toISOString(),type:"Income",reconciled:!1}),console.log(" Initial deposit transaction created locally");const h=e().getEnvelopeBalance(u);console.log(` Test balance for temp envelope ${u}: $${h.toNumber()}`)}catch(h){console.error(" Failed to create initial deposit transaction locally:",h)}}try{console.log(" Attempting Firebase envelope creation...");const h=n(),p={...c,id:"",userId:h},m=dx(p),y=Fi.createEnvelope(m),_=new Promise((z,P)=>setTimeout(()=>P(new Error("Firebase timeout - likely offline")),3e3)),w=await Promise.race([y,_]),E={id:w.id,name:w.name,currentBalance:w.currentBalance,lastUpdated:w.lastUpdated,isActive:w.isActive??!0,orderIndex:w.orderIndex??0,userId:w.userId,createdAt:w.createdAt,isPiggybank:w.isPiggybank,piggybankConfig:w.piggybankConfig};t(z=>({envelopes:z.envelopes.map(P=>P.id===u?E:P),isLoading:!1,pendingSync:!1})),t(z=>({transactions:z.transactions.map(P=>P.envelopeId===u?{...P,envelopeId:w.id}:P)}));const{useMonthlyBudgetStore:T}=await vi(async()=>{const{useMonthlyBudgetStore:z}=await Promise.resolve().then(()=>Ph);return{useMonthlyBudgetStore:z}},[]),I=T.getState(),D=I.envelopeAllocations.map(z=>z.envelopeId===u?{...z,envelopeId:w.id}:z);T.setState({envelopeAllocations:D});const O=D.filter(z=>z.envelopeId===w.id&&z.id?.startsWith("temp-"));if(O.length>0){const{MonthlyBudgetService:z}=await vi(async()=>{const{MonthlyBudgetService:C}=await Promise.resolve().then(()=>Zu);return{MonthlyBudgetService:C}},void 0),P=z.getInstance();for(const C of O)try{await P.createEnvelopeAllocation({envelopeId:C.envelopeId,budgetedAmount:C.budgetedAmount,userId:C.userId,month:C.month}),console.log(` Synced allocation for envelope ${w.id}`)}catch(k){console.error(` Failed to sync allocation for envelope ${w.id}:`,k)}const A=await P.getEnvelopeAllocations(O[0].userId,I.currentMonth);T.setState({envelopeAllocations:A})}if(o){const z=e().transactions.filter(P=>P.envelopeId===w.id&&P.id&&P.id.startsWith("temp-"));console.log(` Found ${z.length} transactions to sync for envelope ${w.id}:`,z.map(P=>({id:P.id,envelopeId:P.envelopeId})));for(const P of z)try{console.log(" Syncing transaction:",P);const A={...P,amount:P.amount.toString(),type:P.type.toLowerCase(),date:dt.fromDate(new Date(P.date))},C=await da.addTransaction(A);console.log(" Transaction synced:",C);const k=i(C);console.log(` Replacing temp transaction ${P.id} with Firebase transaction ${C.id}`),t(V=>({transactions:V.transactions.map(B=>B.id===P.id?k:B)}))}catch(A){console.error(` Failed to sync transaction ${P.id}:`,A)}t({pendingSync:!1})}return w}catch(h){if(console.error("Create Envelope Failed:",h),console.log("Error details:",{code:h?.code,message:h?.message,name:h?.name,isNetworkError:r(h)}),r(h)||h.message?.includes("timeout")||!navigator.onLine)return console.log(" Offline detected - keeping envelope locally, will sync when online"),t({isLoading:!1,pendingSync:!0,error:null}),d;throw console.log(" Real error - removing temp envelope"),t(m=>({envelopes:m.envelopes.filter(y=>y.id!==u),transactions:m.transactions.filter(y=>y.envelopeId!==u),error:h.message,isLoading:!1})),h}return d},addToEnvelope:async(a,o,c,u)=>{const d=u?typeof u=="string"?u:u.toISOString():new Date().toISOString();await e().addTransaction({description:c,amount:o,envelopeId:a,date:d,type:"Income",reconciled:!1})},spendFromEnvelope:async(a,o,c,u)=>{const d=u?typeof u=="string"?u:u.toISOString():new Date().toISOString();await e().addTransaction({description:c,amount:o,envelopeId:a,date:d,type:"Expense",reconciled:!1})},transferFunds:async(a,o,c,u,d)=>{console.log(`Transferring ${c} from ${a} to ${o} with note: ${u}`);const h=d?typeof d=="string"?d:d.toISOString():new Date().toISOString(),p=`transfer-${Date.now()}-${Math.random()}`;await e().addTransaction({description:`Transfer to ${e().envelopes.find(m=>m.id===o)?.name||"envelope"}`,amount:c,envelopeId:a,date:h,type:"Expense",transferId:p,reconciled:!1}),await e().addTransaction({description:`Transfer from ${e().envelopes.find(m=>m.id===a)?.name||"envelope"}`,amount:c,envelopeId:o,date:h,type:"Income",transferId:p,reconciled:!1})},deleteEnvelope:async a=>{const o=e().transactions.filter(c=>c.envelopeId===a);t(c=>({envelopes:c.envelopes.filter(u=>u.id!==a),transactions:c.transactions.filter(u=>u.envelopeId!==a),isLoading:!0}));try{const c=n(),u=Fi.deleteEnvelope(c,a),d=new Promise((y,_)=>setTimeout(()=>_(new Error("Firebase timeout - likely offline")),3e3));await Promise.race([u,d]);for(const y of o)if(y.id&&!y.id.startsWith("temp-")){const _=da.deleteTransaction(c,y.id),w=new Promise((E,T)=>setTimeout(()=>T(new Error("Firebase timeout - likely offline")),3e3));await Promise.race([_,w])}const{useMonthlyBudgetStore:h}=await vi(async()=>{const{useMonthlyBudgetStore:y}=await Promise.resolve().then(()=>Ph);return{useMonthlyBudgetStore:y}},void 0),p=h.getState(),m=p.envelopeAllocations.filter(y=>y.envelopeId===a);if(m.length>0){const{MonthlyBudgetService:y}=await vi(async()=>{const{MonthlyBudgetService:w}=await Promise.resolve().then(()=>Zu);return{MonthlyBudgetService:w}},void 0),_=y.getInstance();for(const w of m)if(w.id&&!w.id.startsWith("temp-"))try{await _.deleteEnvelopeAllocation(c,w.id),console.log(` Deleted allocation ${w.id} for envelope ${a}`)}catch(E){console.error(` Failed to delete allocation ${w.id}:`,E)}h.setState({envelopeAllocations:p.envelopeAllocations.filter(w=>w.envelopeId!==a)}),await h.getState().refreshAvailableToBudget()}await e().removeEnvelopeFromTemplates(a),t({isLoading:!1})}catch(c){if(console.error("Delete Envelope Failed:",c),r(c)||c.message?.includes("timeout")||!navigator.onLine)console.log(" Offline detected - keeping envelope deletion locally, will sync when online"),t(d=>({isLoading:!1,pendingSync:!0,error:null,pendingDeletes:[...d.pendingDeletes,a]}));else{const d=e().envelopes.find(h=>h.id===a);t(d?h=>({envelopes:[...h.envelopes,d],transactions:[...h.transactions,...o],error:c.message,isLoading:!1}):{error:c.message,isLoading:!1})}}},reorderEnvelopes:async a=>{if(!a.length)return;const o=e(),c=new Map;a.forEach((p,m)=>{c.set(p,m)});const u=o.envelopes,d=u.map(p=>{if(!c.has(p.id))return p;const m=c.get(p.id);return p.orderIndex===m?p:{...p,orderIndex:m}}),h=d.filter((p,m)=>p!==u[m]);if(h.length){t({envelopes:d,isLoading:!0});try{const p=n();await Promise.all(h.map(m=>{const y=dx(m);return Fi.saveEnvelope(p,y)})),t({isLoading:!1})}catch(p){if(console.error("Reorder envelopes failed:",p),r(p))t({isLoading:!1,pendingSync:!0,error:null});else throw t({envelopes:u,isLoading:!1,error:p?.message??"Failed to reorder envelopes"}),p}}},updateEnvelope:async a=>{const o=dx(a);t(c=>({envelopes:c.envelopes.map(u=>u.id===o.id?o:u),isLoading:!0}));try{const c=n();await Fi.saveEnvelope(c,o),t({isLoading:!1})}catch(c){console.error("Update Envelope Failed:",c),r(c)?t({isLoading:!1,pendingSync:!0,error:null}):t({error:c.message,isLoading:!1})}},renameEnvelope:async(a,o)=>{t(c=>({envelopes:c.envelopes.map(u=>u.id===a?{...u,name:o}:u),isLoading:!0}));try{t({isLoading:!1})}catch(c){console.error("Rename Envelope Failed:",c),t({error:c.message,isLoading:!1})}}}},fx=t=>La(Mt,"users",t,"distributionTemplates"),Bi={subscribeToDistributionTemplates:(t,e)=>{const n=ha(fx(t),hp("lastUsed","desc"));return mc(n,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllDistributionTemplates:async t=>{const e=ha(fx(t),hp("lastUsed","desc"));return(await Rd(e)).docs.map(r=>({id:r.id,...r.data()}))},createDistributionTemplate:async t=>{const{userId:e,id:n,...r}=t;if(!e)throw new Error("User ID is required to create distribution template");console.log(` DistributionTemplateService.createDistributionTemplate: Adding template for user ${e}:`,r);try{const i=await gy(fx(e),r);console.log(" Template addDoc succeeded, docRef:",i);const a={id:i.id,...r,userId:e};return console.log(" Final template result object:",a),a}catch(i){throw console.error(" Template addDoc failed:",i),i}},saveDistributionTemplate:async(t,e)=>{const n=Sn(Mt,"users",t,"distributionTemplates",e.id);return await Ho(n,e,{merge:!0})},updateDistributionTemplate:async(t,e,n)=>{const r=Sn(Mt,"users",t,"distributionTemplates",e);return await Kp(r,n)},deleteDistributionTemplate:async(t,e)=>{console.log(` DistributionTemplateService.deleteDistributionTemplate: Deleting template ${e} for user ${t}`);const n=Sn(Mt,"users",t,"distributionTemplates",e);await kd(n),console.log(` DistributionTemplateService.deleteDistributionTemplate: Successfully deleted template ${e}`)}},Bee=({set:t,get:e,getCurrentUserId:n,isNetworkError:r})=>({saveTemplate:async(i,a,o)=>{console.log(" saveTemplate called with:",{name:i,distributions:a,note:o});try{const c=n(),u={id:`temp-${Date.now()}`,userId:c,name:i,note:o,lastUsed:new Date().toISOString(),distributions:a};console.log(" Attempting Firebase template save..."),console.log(" Current online status:",navigator.onLine);try{const d=Bi.createDistributionTemplate(u),h=new Promise((m,y)=>setTimeout(()=>y(new Error("Firebase timeout - likely offline")),5e3)),p=await Promise.race([d,h]);console.log(" Firebase template save succeeded (online mode):",p),console.log(" Template saved to Firebase - real-time subscription will update local state"),console.log(" Template saved to Firebase:",p),console.log(" Store now has templates:",e().distributionTemplates.length)}catch(d){throw console.log(" Firebase template save failed or timed out:",d.message),d}}catch(c){console.error(" Failed to save template to Firebase, saving locally:",c),console.log(" Error details:",{name:c?.name||"Unknown",message:c?.message||"Unknown",code:c?.code||"Unknown",isNetworkError:r(c)});const u=n(),d={id:`local-${Date.now()}`,userId:u,name:i,note:o,lastUsed:new Date().toISOString(),distributions:a};console.log(" Saving template locally (offline):",d),t(h=>({distributionTemplates:[...h.distributionTemplates,d],pendingSync:!0})),console.log(" Template saved locally as fallback:",d),console.log(" Store now has templates:",e().distributionTemplates.length)}},updateTemplate:async i=>{try{const a=n();await Bi.updateDistributionTemplate(a,i.id,{name:i.name,note:i.note,distributions:i.distributions,lastUsed:i.lastUsed}),t(o=>({distributionTemplates:o.distributionTemplates.map(c=>c.id===i.id?i:c)})),console.log(" Template updated in Firebase:",i.id)}catch(a){throw console.error(" Failed to update template in Firebase:",a),a}},deleteTemplate:async i=>{try{const a=n();await Bi.deleteDistributionTemplate(a,i),t(o=>({distributionTemplates:o.distributionTemplates.filter(c=>c.id!==i)})),console.log(" Template deleted from Firebase:",i)}catch(a){throw console.error(" Failed to delete template from Firebase:",a),a}},cleanupOrphanedTemplates:async()=>{console.log(" Cleaning up orphaned templates...");const i=e().distributionTemplates,a=e().envelopes,o=new Set(a.map(u=>u.id));let c=0;for(const u of i){const d={...u.distributions},h={};for(const[p,m]of Object.entries(u.distributions))o.has(p)&&(h[p]=m);if(Object.keys(h).length===0){console.log(` Deleting orphaned template: ${u.name}`);const p=n();await Bi.deleteDistributionTemplate(p,u.id),c++}else if(JSON.stringify(h)!==JSON.stringify(d)){console.log(` Updating template ${u.name} - removed orphaned envelope references`);const p=n();await Bi.updateDistributionTemplate(p,u.id,{distributions:h}),c++}}c>0?console.log(` Cleaned up ${c} templates`):console.log(" No orphaned templates found")},updateTemplateEnvelopeReferences:async(i,a)=>{console.log(` Updating template references: ${i}  ${a}`);const o=e().distributionTemplates;let c=0;for(const u of o)if(u.distributions[i]!==void 0){const d={...u.distributions};d[a]=d[i],delete d[i],console.log(` Updating template: ${u.name}`);const h=n();await Bi.updateDistributionTemplate(h,u.id,{distributions:d}),c++}c>0&&console.log(` Updated ${c} templates with new envelope reference`)},removeEnvelopeFromTemplates:async i=>{console.log(` Removing envelope ${i} from all templates`);const a=e().distributionTemplates;let o=0,c=0;for(const u of a)if(u.distributions[i]!==void 0){const d={...u.distributions};if(delete d[i],Object.keys(d).length===0){console.log(` Deleting template ${u.name} - no envelopes left`);const h=n();await Bi.deleteDistributionTemplate(h,u.id),c++}else{console.log(` Removing envelope from template: ${u.name}`);const h=n();await Bi.updateDistributionTemplate(h,u.id,{distributions:d}),o++}}(o>0||c>0)&&console.log(` Updated ${o} templates, deleted ${c} empty templates`)}}),hx=t=>La(Mt,"users",t,"appSettings"),Is={subscribeToAppSettings:(t,e)=>{const n=ha(hx(t),Mk(1));return mc(n,i=>{if(i.empty){e(null);return}const a=i.docs.map(o=>({id:o.id,...o.data()}))[0];e(a)})},getAppSettings:async t=>{const e=ha(hx(t),Mk(1)),n=await Rd(e);if(n.empty)return null;const r=n.docs[0];return{id:r.id,...r.data()}},createAppSettings:async t=>{const{userId:e,...n}=t;if(!e)throw new Error("User ID is required to create app settings");console.log(` AppSettingsService.createAppSettings: Creating settings for user ${e}:`,n);try{const r=await gy(hx(e),n);console.log(" Settings addDoc succeeded, docRef:",r);const i={id:r.id,...n,userId:e};return console.log(" Final settings result object:",i),i}catch(r){throw console.error(" Settings addDoc failed:",r),r}},saveAppSettings:async(t,e)=>{const n=Sn(Mt,"users",t,"appSettings",e.id);return await Ho(n,e,{merge:!0})},updateAppSettings:async(t,e,n)=>{const r=Sn(Mt,"users",t,"appSettings",e);return await Kp(r,n)},deleteAppSettings:async(t,e)=>{console.log(` AppSettingsService.deleteAppSettings: Deleting settings ${e} for user ${t}`);const n=Sn(Mt,"users",t,"appSettings",e);await kd(n),console.log(` AppSettingsService.deleteAppSettings: Successfully deleted settings ${e}`)}},fj=({set:t,get:e,getCurrentUserId:n})=>({updateAppSettings:async r=>{const i=e();if(!i.appSettings){try{await fj({set:t,get:e,getCurrentUserId:n}).initializeAppSettings();const a=e();if(a.appSettings){const o={...a.appSettings,...r};t({appSettings:o});const c=n();await Is.updateAppSettings(c,a.appSettings.id,r),console.log(" App settings updated successfully")}}catch(a){console.error(" Failed to initialize/update settings:",a)}return}try{t(o=>({appSettings:{...o.appSettings,...r}}));const a=n();await Is.updateAppSettings(a,i.appSettings.id,r),console.log(" App settings updated successfully")}catch(a){throw console.error(" Failed to update app settings:",a),t(o=>({appSettings:o.appSettings})),a}},initializeAppSettings:async()=>{try{const i={userId:n(),theme:"system",enableMoveableReorder:!1},a=await Is.createAppSettings(i);t({appSettings:a}),console.log(" App settings initialized successfully")}catch(r){console.error(" Failed to initialize app settings:",r);const i=n();t({appSettings:{id:"local-settings",userId:i,theme:"system",enableMoveableReorder:!1}})}}});class sr{static instance;static getInstance(){return sr.instance||(sr.instance=new sr),sr.instance}async getMonthlyBudget(e,n){try{const r=Sn(Mt,"users",e,"monthlyBudgets",n),i=await Pee(r);if(i.exists()){const a=i.data();return{id:a.id,userId:a.userId,month:a.month,totalIncome:parseFloat(a.totalIncome),availableToBudget:parseFloat(a.availableToBudget),createdAt:a.createdAt.toDate().toISOString(),updatedAt:a.updatedAt.toDate().toISOString()}}return null}catch(r){throw console.error("Error getting monthly budget:",r),r}}async createOrUpdateMonthlyBudget(e){try{const n=dt.now(),r=`${e.userId}_${e.month}`,i={id:r,userId:e.userId,month:e.month,totalIncome:e.totalIncome.toString(),availableToBudget:e.availableToBudget.toString(),createdAt:n,updatedAt:n};return await Ho(Sn(Mt,"users",e.userId,"monthlyBudgets",e.month),i),{...e,id:r,createdAt:n.toDate().toISOString(),updatedAt:n.toDate().toISOString()}}catch(n){throw console.error("Error creating/updating monthly budget:",n),n}}async getIncomeSources(e,n){try{const r=ha(La(Mt,"users",e,"incomeSources"),$m("month","==",n));return(await Rd(r)).docs.map(a=>{const o=a.data();return{id:o.id,userId:o.userId,month:o.month,name:o.name,amount:parseFloat(o.amount),frequency:o.frequency,category:o.category,createdAt:o.createdAt.toDate().toISOString(),updatedAt:o.updatedAt.toDate().toISOString()}}).sort((a,o)=>new Date(a.createdAt).getTime()-new Date(o.createdAt).getTime())}catch(r){throw console.error("Error getting income sources:",r),r}}async createIncomeSource(e){try{const n=dt.now(),r=Sn(La(Mt,"users",e.userId,"incomeSources")),i={id:r.id,userId:e.userId,month:e.month,name:e.name,amount:e.amount.toString(),frequency:e.frequency||"monthly",...e.category&&{category:e.category},createdAt:n,updatedAt:n};return await Ho(r,i),{...e,frequency:e.frequency||"monthly",id:r.id,createdAt:n.toDate().toISOString(),updatedAt:n.toDate().toISOString()}}catch(n){throw console.error("Error creating income source:",n),n}}async getEnvelopeAllocations(e,n){try{const r=ha(La(Mt,"users",e,"envelopeAllocations"),$m("month","==",n));return(await Rd(r)).docs.map(a=>{const o=a.data();return{id:o.id,userId:o.userId,envelopeId:o.envelopeId,month:o.month,budgetedAmount:parseFloat(o.budgetedAmount),createdAt:o.createdAt.toDate().toISOString(),updatedAt:o.updatedAt.toDate().toISOString()}}).sort((a,o)=>new Date(a.createdAt).getTime()-new Date(o.createdAt).getTime())}catch(r){throw console.error("Error getting envelope allocations:",r),r}}async createEnvelopeAllocation(e){try{const n=dt.now(),r=Sn(La(Mt,"users",e.userId,"envelopeAllocations")),i={id:r.id,userId:e.userId,envelopeId:e.envelopeId,month:e.month,budgetedAmount:e.budgetedAmount.toString(),createdAt:n,updatedAt:n};return await Ho(r,i),{...e,id:r.id,createdAt:n.toDate().toISOString(),updatedAt:n.toDate().toISOString()}}catch(n){throw console.error("Error creating envelope allocation:",n),n}}async copyMonthData(e,n,r){try{const i=await this.getIncomeSources(e,n);for(const d of i)await this.createIncomeSource({...d,month:r});const a=await this.getEnvelopeAllocations(e,n);for(const d of a)await this.createEnvelopeAllocation({...d,month:r});const o=i.reduce((d,h)=>d+h.amount,0),c=a.reduce((d,h)=>d+h.budgetedAmount,0),u=o-c;await this.createOrUpdateMonthlyBudget({userId:e,month:r,totalIncome:o,availableToBudget:u})}catch(i){throw console.error("Error copying month data:",i),i}}async deleteIncomeSource(e,n){try{const r=Sn(Mt,"users",e,"incomeSources",n);await kd(r)}catch(r){throw console.error("Error deleting income source:",r),r}}async updateIncomeSource(e,n,r){try{const i=Sn(Mt,"users",e,"incomeSources",n),a={...r,updatedAt:dt.now()};await Ho(i,a,{merge:!0})}catch(i){throw console.error("Error updating income source:",i),i}}async deleteEnvelopeAllocation(e,n){try{const r=Sn(Mt,"users",e,"envelopeAllocations",n);await kd(r)}catch(r){throw console.error("Error deleting envelope allocation:",r),r}}async updateEnvelopeAllocation(e,n,r){try{const i=Sn(Mt,"users",e,"envelopeAllocations",n),a={...r,updatedAt:dt.now()};await Ho(i,a,{merge:!0})}catch(i){throw console.error("Error updating envelope allocation:",i),i}}async clearMonthData(e,n){try{const[r,i]=await Promise.all([this.getIncomeSources(e,n),this.getEnvelopeAllocations(e,n)]),a=r.map(c=>this.deleteIncomeSource(e,c.id)),o=i.map(c=>this.deleteEnvelopeAllocation(e,c.id));await Promise.all([...a,...o]),await this.createOrUpdateMonthlyBudget({userId:e,month:n,totalIncome:0,availableToBudget:0})}catch(r){throw console.error("Error clearing month data:",r),r}}async calculateAvailableToBudget(e,n){try{const r=await this.getIncomeSources(e,n),i=await this.getEnvelopeAllocations(e,n),a=r.reduce((c,u)=>c+u.amount,0),o=i.reduce((c,u)=>c+u.budgetedAmount,0);return a-o}catch(r){throw console.error("Error calculating available to budget:",r),r}}subscribeToMonthlyBudget(e,n,r){const i=Sn(Mt,"monthlyBudgets",`${e}_${n}`);return mc(i,a=>{if(a.exists()){const o=a.data();r(o)}else r(null)})}subscribeToIncomeSources(e,n,r){const i=ha(La(Mt,"users",e,"incomeSources"),$m("month","==",n));return mc(i,a=>{const o=a.docs.map(c=>({id:c.id,...c.data()})).sort((c,u)=>{const d=c.createdAt?.toDate?.()?.getTime()||0,h=u.createdAt?.toDate?.()?.getTime()||0;return d-h});r(o)})}subscribeToEnvelopeAllocations(e,n,r){const i=ha(La(Mt,"users",e,"envelopeAllocations"),$m("month","==",n));return mc(i,a=>{const o=a.docs.map(c=>({id:c.id,...c.data()}));r(o)})}}const Zu=Object.freeze(Object.defineProperty({__proto__:null,MonthlyBudgetService:sr},Symbol.toStringTag,{value:"Module"})),Fee=t=>t?{id:t.id,userId:t.userId,month:t.month,totalIncome:parseFloat(t.totalIncome),availableToBudget:parseFloat(t.availableToBudget),createdAt:t.createdAt?.toDate?.()?t.createdAt.toDate().toISOString():t.createdAt||new Date().toISOString(),updatedAt:t.updatedAt?.toDate?.()?t.updatedAt.toDate().toISOString():t.updatedAt||new Date().toISOString()}:null,Uee=t=>({id:t.id,userId:t.userId,month:t.month,name:t.name,amount:parseFloat(t.amount),frequency:t.frequency,category:t.category,createdAt:t.createdAt?.toDate?.()?t.createdAt.toDate().toISOString():t.createdAt||new Date().toISOString(),updatedAt:t.updatedAt?.toDate?.()?t.updatedAt.toDate().toISOString():t.updatedAt||new Date().toISOString()}),Gee=t=>({id:t.id,userId:t.userId,envelopeId:t.envelopeId,month:t.month,budgetedAmount:parseFloat(t.budgetedAmount),createdAt:t.createdAt?.toDate?.()?t.createdAt.toDate().toISOString():t.createdAt||new Date().toISOString(),updatedAt:t.updatedAt?.toDate?.()?t.updatedAt.toDate().toISOString():t.updatedAt||new Date().toISOString()}),px=(t,e,n)=>{if(window.__monthlyBudgetUnsubscribers){console.log(" Monthly budget real-time subscriptions already active, skipping setup");return}console.log(" Setting up monthly budget real-time Firebase subscriptions for month:",n);const r=sr.getInstance(),i=r.subscribeToMonthlyBudget(e,n,c=>{const u=t.getState();if(u.isOnline&&!u.pendingSync&&!u.resetPending){console.log(" Real-time sync: Monthly budget updated",c?"found":"null");const d=Fee(c);t.setState({monthlyBudget:d})}}),a=r.subscribeToIncomeSources(e,n,c=>{const u=t.getState();if(u.isOnline&&!u.pendingSync&&!u.resetPending){const d=c.map(Uee),h=new Set,p=d.filter(m=>h.has(m.id)?!1:(h.add(m.id),!0));t.setState({incomeSources:p})}}),o=r.subscribeToEnvelopeAllocations(e,n,c=>{const u=t.getState();if(u.isOnline&&!u.pendingSync&&!u.resetPending){console.log(" Real-time sync: Envelope allocations updated",c.length);const d=c.map(Gee);t.setState({envelopeAllocations:d})}});window.__monthlyBudgetUnsubscribers={monthlyBudget:i,incomeSources:a,envelopeAllocations:o},console.log(" Monthly budget real-time subscriptions active for month:",n)},Vk=()=>{if(window.__monthlyBudgetUnsubscribers){const t=window.__monthlyBudgetUnsubscribers;t.monthlyBudget&&t.monthlyBudget(),t.incomeSources&&t.incomeSources(),t.envelopeAllocations&&t.envelopeAllocations(),delete window.__monthlyBudgetUnsubscribers,console.log(" Cleaned up monthly budget Firebase subscriptions")}},qee=t=>{const{useMonthlyBudgetStore:e,useAuthStore:n,getCurrentUserId:r}=t;if(typeof window>"u")return;window.addEventListener("online",async()=>{console.log(" Browser online event detected"),await e.getState().updateOnlineStatus();const u=e.getState();u.isOnline&&(u.pendingSync||u.resetPending)&&(console.log(" Auto-syncing pending operations..."),u.syncData())}),window.addEventListener("offline",()=>{console.log(" Browser offline event detected"),e.setState({isOnline:!1})}),setTimeout(()=>{e.getState().updateOnlineStatus()},1e3);let i=null;const a=()=>{i&&clearInterval(i),i=setInterval(async()=>{const u=e.getState();if(!u.isOnline&&!u.testingConnectivity){console.log(" Periodic offline retry: testing connectivity..."),e.setState({testingConnectivity:!0});try{await(async()=>(await e.getState().updateOnlineStatus(),e.getState().isOnline))()?(console.log(" Periodic retry succeeded - back online!"),e.setState({isOnline:!0,testingConnectivity:!1}),(u.pendingSync||u.resetPending)&&e.getState().syncData(),i&&(clearInterval(i),i=null)):e.setState({testingConnectivity:!1})}catch(d){console.log(" Periodic retry failed:",d),e.setState({testingConnectivity:!1})}}else u.isOnline&&i&&(clearInterval(i),i=null)},3e4)};a(),e.subscribe(u=>{!u.isOnline&&!i&&(console.log(" Starting periodic connectivity retry"),a())});let o=null;e.subscribe(u=>{if(o!==null&&u.currentMonth!==o){console.log(" Month changed from",o,"to",u.currentMonth),Vk();const d=n.getState();d.isAuthenticated&&d.currentUser&&px(e,r(),u.currentMonth)}o=u.currentMonth});const c=n.getState();if(c.isAuthenticated&&c.currentUser){console.log(" User already authenticated on app load, setting up monthly budget real-time subscriptions");const u=e.getState().currentMonth;px(e,r(),u)}n.subscribe(u=>{if(u.isAuthenticated&&u.currentUser){console.log(" User authenticated, setting up monthly budget real-time subscriptions");const d=e.getState().currentMonth;px(e,r(),d)}else!u.isAuthenticated&&!u.isLoading&&(console.log(" User logged out, clearing monthly budget data and unsubscribing"),Vk(),e.getState().handleUserLogout())})},zi=()=>{const t=Xi.getState().currentUser;if(!t)throw new Error("User not authenticated");return t.id},hj=zi,Hee=()=>{const t=new Date;return`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}`},jk=async(t,e,n)=>{const{transactions:r,addTransaction:i,deleteTransaction:a,updateTransaction:o}=An.getState(),c="Monthly Budget Allocation",[u,d]=n.split("-").map(Number);console.log(" Syncing budget allocation transaction:",{envelopeId:t,budgetedAmount:e,month:n,totalTransactions:r.length});const h=r.filter(m=>{if(m.envelopeId!==t)return!1;const y=m.description===c,_=m.description.startsWith("Monthly contribution to");if(!y&&!_)return!1;try{let w;if(typeof m.date=="string")w=new Date(m.date);else if(m.date?.toDate&&typeof m.date.toDate=="function")w=m.date.toDate();else return!1;return w.getFullYear()===u&&w.getMonth()+1===d}catch{return!1}});console.log(" Found existing transactions:",h.length);const p=new ti(e.toString()||"0");if(h.length>0){const[m,...y]=h;for(const _ of y)console.log(" Deleting duplicate allocation transaction:",_.id),await a(_.id);m.amount!==p.toNumber()||m.description!==c?(console.log(" Updating existing allocation transaction:",m.id,"to amount:",p.toNumber()),await o({...m,amount:p.toNumber(),description:c,type:"Income",reconciled:!0})):console.log(" Transaction already correct:",m.id)}else if(p.gt(0)){const m=new Date,y=`${m.getFullYear()}-${String(m.getMonth()+1).padStart(2,"0")}`,_=`${u}-${String(d).padStart(2,"0")}`;if(_>y){console.log(` Skipping allocation transaction for ${_} - future month beyond ${y}`);return}console.log(" Creating new allocation transaction with amount",p.toNumber());const w=new Date(u,d-1,1).toISOString();await i({description:c,amount:p.toNumber(),envelopeId:t,date:w,type:"Income",reconciled:!0})}else console.log(" No new transaction needed (amount is 0)")},xr=Vv()(TS((t,e)=>({currentMonth:Hee(),monthlyBudget:null,incomeSources:[],envelopeAllocations:[],isLoading:!1,error:null,isOnline:typeof navigator<"u"?navigator.onLine:!0,pendingSync:!1,resetPending:!1,testingConnectivity:!1,pendingDeletedIncomeSources:[],setCurrentMonth:n=>{t({currentMonth:n,isLoading:!0}),e().fetchMonthlyData()},fetchMonthlyData:async()=>{try{const n=zi(),r=e().currentMonth,i=e();i.incomeSources.length>0||i.envelopeAllocations.length>0?console.log(" Using cached monthly budget data, fetching updates in background..."):(console.log(" No cached monthly budget data, fetching from Firebase..."),t({isLoading:!0,error:null}));try{const o=sr.getInstance(),c=new Promise((_,w)=>{setTimeout(()=>w(new Error("Firebase query timeout")),5e3)}),u=Promise.all([o.getMonthlyBudget(n,r),o.getIncomeSources(n,r),o.getEnvelopeAllocations(n,r)]),[d,h,p]=await Promise.race([u,c]);t({monthlyBudget:d,incomeSources:h,envelopeAllocations:p,isLoading:!1}),console.log(" Monthly budget data fetched from Firebase"),await e().cleanupOrphanedAllocations();const m=new Date,y=`${m.getFullYear()}-${String(m.getMonth()+1).padStart(2,"0")}`;y===r?(console.log(` Real month ${y} matches budget month ${r} - processing piggybank contributions`),await e().processMonthlyPiggybankContributions(r)):console.log(` Real month ${y} doesn't match budget month ${r} - skipping piggybank contributions`)}catch(o){console.error(" Firebase fetch failed:",o);const c=e();c.incomeSources.length>0||c.envelopeAllocations.length>0?(console.log(" Using cached monthly budget data due to fetch error (likely offline)"),t({isLoading:!1,error:null})):(console.error(" No cached monthly budget data available"),t({error:o instanceof Error?o.message:"Failed to fetch monthly data",isLoading:!1}))}}catch(n){console.error(" Critical error in fetchMonthlyData:",n),t({isLoading:!1,error:"Failed to load budget data"})}},createIncomeSource:async n=>{const r=zi(),i=e().currentMonth,a=`temp-${Date.now()}-${Math.random()}`,o=new Date().toISOString(),c={...n,id:a,userId:r,month:i,createdAt:o,updatedAt:o};t(u=>({incomeSources:[...u.incomeSources,c]}));try{console.log(" Creating income source in Firebase...",n);const u=sr.getInstance(),d=u.createIncomeSource({...n,userId:r,month:i}),h=new Promise((m,y)=>setTimeout(()=>y(new Error("Firebase timeout - likely offline")),3e3));await Promise.race([d,h]),console.log(" Income source created in Firebase successfully");const p=await u.getIncomeSources(r,i);console.log(" Refreshed income sources:",p),t({incomeSources:p}),await e().refreshAvailableToBudget()}catch(u){if(u?.message?.includes("timeout")||!navigator.onLine)console.log(" Offline detected - keeping income source locally, will sync when online"),console.log(" Error details:",u);else throw console.error(" Error creating income source:",u),t(h=>({incomeSources:h.incomeSources.filter(p=>p.id!==a)})),u}},updateIncomeSource:async(n,r)=>{const i=new Date().toISOString();t(a=>({incomeSources:a.incomeSources.map(o=>o.id===n?{...o,...r,updatedAt:i}:o)}));try{const a={updatedAt:dt.now()};r.name!==void 0&&(a.name=r.name),r.amount!==void 0&&(a.amount=r.amount.toString()),r.frequency!==void 0&&(a.frequency=r.frequency),r.category!==void 0&&(a.category=r.category);const o=zi(),c=Sn(Mt,"users",o,"incomeSources",n),u=Kp(c,a),d=new Promise((y,_)=>setTimeout(()=>_(new Error("Firebase timeout - likely offline")),3e3));await Promise.race([u,d]);const h=sr.getInstance(),p=e().currentMonth,m=await h.getIncomeSources(o,p);t({incomeSources:m})}catch(a){if(a?.message?.includes("timeout")||!navigator.onLine)console.log(" Offline detected - keeping income source update locally, will sync when online");else throw console.error("Error updating income source:",a),a}},deleteIncomeSource:async n=>{t(r=>({incomeSources:r.incomeSources.filter(i=>i.id!==n)}));try{const r=sr.getInstance(),i=zi(),a=r.deleteIncomeSource(i,n),o=new Promise((c,u)=>setTimeout(()=>u(new Error("Firebase timeout - likely offline")),3e3));await Promise.race([a,o]),await e().refreshAvailableToBudget()}catch(r){r.message?.includes("timeout")||!navigator.onLine?(console.log(" Offline detected - keeping income source deletion locally, will sync when online"),t(a=>({pendingSync:!0,pendingDeletedIncomeSources:[...a.pendingDeletedIncomeSources,n]}))):console.error("Error deleting income source from Firebase:",r),await e().refreshAvailableToBudget()}},restoreIncomeSource:async(n,r)=>{try{t(i=>{const a=[...i.incomeSources];return r!==void 0&&r>=0&&r<=a.length?a.splice(r,0,n):a.push(n),{incomeSources:a}}),await e().refreshAvailableToBudget()}catch(i){throw console.error("Error restoring income source:",i),i}},createEnvelopeAllocation:async n=>{try{const r=zi(),i=e().currentMonth,a=`temp-${Date.now()}-${Math.random()}`,o=new Date().toISOString(),c={...n,id:a,userId:r,month:i,createdAt:o,updatedAt:o};t(d=>({envelopeAllocations:[...d.envelopeAllocations,c]}));const u=sr.getInstance();try{const d=u.createEnvelopeAllocation({...n,userId:r,month:i}),h=new Promise((m,y)=>setTimeout(()=>y(new Error("Firebase timeout - likely offline")),3e3));await Promise.race([d,h]);const p=await u.getEnvelopeAllocations(r,i);t({envelopeAllocations:p})}catch(d){if(d.message?.includes("timeout")||!navigator.onLine)console.log(" Offline - keeping allocation locally, will sync when online"),t({pendingSync:!0});else throw console.error(" Real error - removing temp allocation"),t(p=>({envelopeAllocations:p.envelopeAllocations.filter(m=>m.id!==a)})),d}}catch(r){throw console.error("Error creating envelope allocation:",r),r}},updateEnvelopeAllocation:async(n,r)=>{try{const i=zi(),a=e().currentMonth,o=sr.getInstance(),c={};r.envelopeId!==void 0&&(c.envelopeId=r.envelopeId),r.budgetedAmount!==void 0&&(c.budgetedAmount=r.budgetedAmount.toString()),await o.updateEnvelopeAllocation(i,n,c);const u=await o.getEnvelopeAllocations(i,a);t({envelopeAllocations:u})}catch(i){throw console.error("Error updating envelope allocation:",i),i}},deleteEnvelopeAllocation:async n=>{t(a=>({envelopeAllocations:a.envelopeAllocations.filter(o=>o.id!==n)}));const r=sr.getInstance(),i=zi();r.deleteEnvelopeAllocation(i,n).catch(a=>{console.error("Error deleting envelope allocation from Firebase:",a)})},restoreEnvelopeAllocation:async(n,r)=>{try{t(i=>{const a=[...i.envelopeAllocations];return r!==void 0&&r>=0&&r<=a.length?a.splice(r,0,n):a.push(n),{envelopeAllocations:a}}),await e().refreshAvailableToBudget()}catch(i){throw console.error("Error restoring envelope allocation:",i),i}},setEnvelopeAllocation:async(n,r)=>{try{const i=e().envelopeAllocations.find(o=>o.envelopeId===n);i?await e().updateEnvelopeAllocation(i.id,{budgetedAmount:r}):await e().createEnvelopeAllocation({envelopeId:n,budgetedAmount:r});const a=e().currentMonth;await jk(n,r,a),await e().refreshAvailableToBudget()}catch(i){throw console.error(" Error setting envelope allocation:",i),console.error("Error details:",i instanceof Error?i.message:i),i}},copyFromPreviousMonth:async()=>{try{t({isLoading:!0,error:null});const n=zi(),r=e().currentMonth,[i,a]=r.split("-").map(Number);let o=i,c=a-1;c<1&&(o=i-1,c=12);const u=`${o}-${c.toString().padStart(2,"0")}`,d=sr.getInstance(),[h,p]=await Promise.all([d.getIncomeSources(n,u),d.getEnvelopeAllocations(n,u)]);for(const m of h)await e().createIncomeSource({name:m.name,amount:m.amount});for(const m of p)await e().setEnvelopeAllocation(m.envelopeId,m.budgetedAmount);await e().processMonthlyPiggybankContributions(r),await e().fetchMonthlyData()}catch(n){console.error("Error copying from previous month:",n),t({error:n instanceof Error?n.message:"Failed to copy month data",isLoading:!1})}},processMonthlyPiggybankContributions:async n=>{try{console.log(" Processing piggybank contributions for month:",n);const{envelopes:r,transactions:i,deleteTransaction:a}=An.getState(),o=new Date,c=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}`;if(n!==c){n>c?console.log(`Skipping piggybank contributions for ${n} - future month beyond ${c}`):console.log(`Skipping piggybank contributions for ${n} - past month, current is ${c}`);return}const u=r.filter(d=>d.isPiggybank&&d.isActive);if(console.log(`Found ${u.length} active piggybanks`),u.length===0){console.log("No piggybanks to process");return}for(const d of u){const h=d.piggybankConfig?.monthlyContribution||0;if(d.piggybankConfig?.paused||!1){console.log(`Skipping ${d.name} - contributions paused`);continue}if(h<=0){console.log(`Skipping ${d.name} - no contribution set`);continue}if(d.createdAt){const _=new Date(d.createdAt),w=`${_.getUTCFullYear()}-${String(_.getUTCMonth()+1).padStart(2,"0")}`;if(n<w){console.log(`Skipping ${d.name} - month ${n} is before creation month ${w}`);continue}}const m=i.filter(_=>_.envelopeId===d.id&&_.isAutomatic===!0&&_.month===n&&_.description.startsWith("Monthly contribution to"));if(m.length>0){console.log(`Found ${m.length} legacy auto-contributions for ${d.name}. Deleting all...`);for(const _ of m)console.log(`Deleting legacy transaction ${_.id}`),await a(_.id)}const y=e().envelopeAllocations.filter(_=>_.envelopeId===d.id&&_.month===n);if(y.length>1){console.warn(`Found ${y.length} duplicate allocations for ${d.name}. Cleaning up...`);const[_,...w]=y;for(const E of w)E.id&&(console.log(`Deleting duplicate allocation ${E.id}`),await e().deleteEnvelopeAllocation(E.id));_.budgetedAmount!==h&&(console.log(`Updating allocation for ${d.name} to $${h}`),await e().setEnvelopeAllocation(d.id,h))}else if(y.length===1){const _=y[0].budgetedAmount;_!==h?(console.log(`Updating allocation for ${d.name} to $${h}`),await e().setEnvelopeAllocation(d.id,h)):i.find(E=>E.envelopeId===d.id&&E.month===n&&E.description==="Monthly Budget Allocation")?console.log(`Allocation for ${d.name} already correct ($${h})`):(console.log(` Missing transaction for ${d.name} allocation - creating transaction`),await jk(d.id,_,n))}else console.log(`Creating initial allocation for ${d.name} ($${h})`),await e().setEnvelopeAllocation(d.id,h)}await e().refreshAvailableToBudget()}catch(r){throw console.error("Error processing piggybank contributions:",r),r}},calculateAvailableToBudget:()=>{const n=e(),r=n.incomeSources.reduce((a,o)=>a+o.amount,0),i=n.envelopeAllocations.reduce((a,o)=>a+o.budgetedAmount,0);return r-i},refreshAvailableToBudget:async()=>{try{const n=e(),r=zi(),i=n.currentMonth;console.log(" Refreshing monthly budget..."),console.log(" Income sources in state:",n.incomeSources),console.log(" Allocations in state:",n.envelopeAllocations);const a=n.incomeSources.reduce((h,p)=>h+p.amount,0),o=n.envelopeAllocations.reduce((h,p)=>h+p.budgetedAmount,0),c=a-o;console.log(" Calculated totalIncome:",a),console.log(" Calculated totalAllocations:",o),console.log(" Calculated availableToBudget:",c);const u=sr.getInstance(),d=n.monthlyBudget;if(d){console.log(" Updating existing budget:",d);const h={...d,availableToBudget:c,totalIncome:a};await u.createOrUpdateMonthlyBudget(h),t({monthlyBudget:h}),console.log(" Monthly budget updated in Firebase")}else{console.log(" Creating new budget");const h=await u.createOrUpdateMonthlyBudget({userId:r,month:i,totalIncome:a,availableToBudget:c});t({monthlyBudget:h}),console.log(" Monthly budget created in Firebase:",h)}}catch(n){console.error(" Error refreshing available to budget:",n)}},clearMonthData:async()=>{try{const n=zi(),r=e().currentMonth,i=sr.getInstance(),{transactions:a,deleteTransaction:o,envelopes:c}=An.getState(),u="Monthly Budget Allocation",[d,h]=r.split("-").map(Number),p=a.filter(y=>{if(y.description!==u)return!1;try{const _=new Date(y.date);return _.getFullYear()===d&&_.getMonth()+1===h}catch{return!1}});for(const y of p)await o(y.id);const m=c.filter(y=>{if(!y.isPiggybank)return!1;if(y.createdAt){const _=new Date(y.createdAt);return`${_.getUTCFullYear()}-${String(_.getUTCMonth()+1).padStart(2,"0")}`===r}return!1});console.log(` Deleting ${m.length} piggybanks created in ${r}`);for(const y of m){const _=a.filter(T=>T.envelopeId===y.id&&T.month===r);for(const T of _)console.log(` Deleting transaction ${T.id} for ${y.name} from ${r}`),await o(T.id);const w=e().envelopeAllocations.find(T=>T.envelopeId===y.id&&T.month===r);w&&(console.log(` Deleting allocation ${w.id} for ${y.name} from ${r}`),await e().deleteEnvelopeAllocation(w.id)),console.log(` Deleting piggybank ${y.name} (created in ${r})`);const{deleteEnvelope:E}=An.getState();await E(y.id)}await i.clearMonthData(n,r),t({incomeSources:[],envelopeAllocations:[]}),await e().refreshAvailableToBudget()}catch(n){throw console.error("Error clearing month data:",n),n}},clearMonthlyBudget:async()=>{console.log(" Clearing monthly budget data (local and Firebase)..."),t({monthlyBudget:null,incomeSources:[],envelopeAllocations:[]});try{await e().clearMonthData(),console.log(" Firebase monthly budget data cleared")}catch(n){console.error(" Failed to clear Firebase monthly budget data:",n)}},loadDemoData:(n,r)=>{t({incomeSources:n,envelopeAllocations:r,isLoading:!1})},cleanupInvalidAllocations:()=>{const n=e().envelopeAllocations,r=n.filter(i=>i.budgetedAmount>0&&!i.envelopeId.startsWith("temp-"));n.length!==r.length&&(t({envelopeAllocations:r}),console.log(`Cleaned ${n.length-r.length} invalid allocations`))},cleanupOrphanedAllocations:async()=>{const{envelopes:n}=await vi(()=>Promise.resolve().then(()=>ete),void 0).then(a=>a.useEnvelopeStore.getState()),r=e().envelopeAllocations,i=r.filter(a=>!n.some(o=>o.id===a.envelopeId));if(i.length>0){console.log(` Found ${i.length} orphaned allocations, cleaning up...`);const a=zi(),o=sr.getInstance();for(const c of i)if(c.id&&!c.id.startsWith("temp-"))try{await o.deleteEnvelopeAllocation(a,c.id),console.log(` Deleted orphaned allocation ${c.id}`)}catch(u){console.error(` Failed to delete orphaned allocation ${c.id}:`,u)}t({envelopeAllocations:r.filter(c=>n.some(u=>u.id===c.envelopeId))}),await e().refreshAvailableToBudget()}},updateOnlineStatus:async()=>{console.log("Monthly budget updateOnlineStatus called")},syncData:async()=>{console.log("Monthly budget syncData called")},handleUserLogout:()=>{t({monthlyBudget:null,incomeSources:[],envelopeAllocations:[],isLoading:!1,error:null,pendingSync:!1,resetPending:!1,testingConnectivity:!1})}}),{name:"monthly-budget-store",version:1,partialize:t=>({incomeSources:t.incomeSources,envelopeAllocations:t.envelopeAllocations,monthlyBudget:t.monthlyBudget,currentMonth:t.currentMonth})}));qee({useMonthlyBudgetStore:xr,useAuthStore:Xi,getCurrentUserId:hj});const Ph=Object.freeze(Object.defineProperty({__proto__:null,getCurrentUserId:hj,useMonthlyBudgetStore:xr},Symbol.toStringTag,{value:"Module"})),$ee=({set:t,get:e,getCurrentUserId:n,isNetworkError:r})=>({addTransaction:async i=>{const a=`temp-${Date.now()}-${Math.random()}`,o=n(),c=new Date(i.date),u=`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}`;console.log(" Month calculation in addTransaction:",{originalDate:i.date,dateObj:c,calculatedMonth:u,currentMonth:xr.getState().currentMonth});const d={...i,id:a,userId:o,month:u};if(t(h=>({transactions:[...h.transactions,d],isLoading:!0})),i.envelopeId.startsWith("temp-"))console.log(` Skipping Firebase sync for transaction with temp envelopeId: ${i.envelopeId}`),t({isLoading:!1,pendingSync:!0});else try{const h=jee(d,o),p=da.addTransaction(h),m=new Promise((w,E)=>setTimeout(()=>E(new Error("Firebase timeout - likely offline")),3e3)),y=await Promise.race([p,m]);console.log(` Replacing temp transaction ${a} with Firebase transaction:`,y);const _=NE(y);t(w=>({transactions:w.transactions.map(E=>E.id===a?_:E),isLoading:!1,pendingSync:!1}))}catch(h){console.error("Add Transaction Failed:",h),r(h)||h.message?.includes("timeout")||!navigator.onLine?(console.log(" Offline detected - keeping transaction locally, will sync when online"),t({isLoading:!1,pendingSync:!0,error:null})):(console.error(" Real error - removing temp transaction"),t(m=>({transactions:m.transactions.filter(y=>y.id!==a),error:h.message,isLoading:!1})))}},deleteTransaction:async i=>{const a=e().transactions.find(d=>d.id===i);if(!a)return;const o=[i];if(a.transferId){const d=e().transactions.find(h=>h.transferId===a.transferId&&h.id!==i);d&&d.id&&o.push(d.id)}t(d=>({transactions:d.transactions.filter(h=>h.id&&!o.includes(h.id)),isLoading:!0}));const c=n(),u=o.filter(d=>!d.startsWith("temp-"));try{for(const d of u){console.log(` About to delete transaction ID: ${d}`);const h=da.deleteTransaction(c,d),p=new Promise((m,y)=>setTimeout(()=>y(new Error("Firebase timeout - likely offline")),3e3));await Promise.race([h,p]),console.log(` Deleted transaction ID: ${d}`)}console.log(" All transaction deletions completed"),t({isLoading:!1})}catch(d){if(console.error("Delete Transaction Failed:",d),r(d)||d.message?.includes("timeout")||!navigator.onLine)console.log(" Offline detected - keeping transaction deletion locally, will sync when online"),t(p=>({isLoading:!1,pendingSync:!0,error:null,pendingDeletedTransactions:[...p.pendingDeletedTransactions,...u]}));else{const p=o.map(m=>e().transactions.find(y=>y.id===m)||a).filter(Boolean);t(m=>({transactions:[...m.transactions,...p],error:d.message,isLoading:!1}))}}},updateTransaction:async i=>{console.log(" updateTransaction called:",i),t(a=>({transactions:a.transactions.map(o=>o.id===i.id?i:o),isLoading:!0}));try{const a=n(),o=da.updateTransaction(a,i.id,zee(i)),c=new Promise((u,d)=>setTimeout(()=>d(new Error("Firebase timeout - likely offline")),3e3));await Promise.race([o,c]),console.log(" Transaction updated in Firebase"),t({isLoading:!1})}catch(a){console.error("Update Transaction Failed:",a),console.log(" Error details:",{name:a?.name||"Unknown",message:a?.message||"Unknown",code:a?.code||"Unknown",isNetworkError:r(a)}),r(a)||a.message?.includes("timeout")||!navigator.onLine?(console.log(" Offline detected - keeping transaction update locally, will sync when online"),t({isLoading:!1,pendingSync:!0,error:null})):(console.error(" Real error - reverting transaction update"),t({error:a.message,isLoading:!1}))}},restoreTransaction:async i=>{t(a=>({transactions:[...a.transactions,i],isLoading:!0}));try{t({isLoading:!1})}catch(a){console.error("Restore Transaction Failed:",a),t({error:a.message,isLoading:!1})}}}),Yee=({set:t,get:e,getCurrentUserId:n,isNetworkError:r,loadFallbackData:i,checkOnlineStatus:a,clearUserData:o})=>{const c=async()=>{try{const w=e(),E=n();if(w.resetPending){console.log(" fetchData: Reset pending detected, performing Firebase reset instead..."),await e().performFirebaseReset();return}console.log(" fetchData: Starting data fetch for user:",E),w.envelopes.length>0||w.transactions.length>0?console.log(" Using cached envelope data, fetching updates in background..."):(console.log(" No cached envelope data, fetching from Firebase..."),t({isLoading:!0,error:null}));try{const I=new Promise((V,B)=>{setTimeout(()=>B(new Error("Firebase query timeout")),5e3)}),D=Promise.all([Fi.getAllEnvelopes(E).catch(V=>(console.error(" Failed to fetch envelopes:",V),[])),da.getAllTransactions(E).catch(V=>(console.error(" Failed to fetch transactions:",V),[])),Bi.getAllDistributionTemplates(E).catch(V=>(console.error(" Failed to fetch templates:",V),[])),Is.getAppSettings(E).catch(V=>(console.error(" Failed to fetch settings:",V),null))]);let O,z,P,A;[O,z,P,A]=await Promise.race([D,I]),console.log(" fetchData: Firebase calls completed"),console.log(" Fetched data counts:",{envelopes:O?.length||0,transactions:z?.length||0,templates:P?.length||0,settings:A?"found":"null"}),e().markOnlineFromFirebaseSuccess();const C=(O?.length||0)>0||(z?.length||0)>0||(P?.length||0)>0;let k=null;C||(console.log(" No data from Firebase, loading fallback data..."),k=await i(),k&&(console.log(" Using fallback data for initialization"),O=k.envelopes||[],z=k.transactions||[],P=k.distributionTemplates||[],A=k.appSettings||null)),t(V=>{const B=Y=>Y.map(ne=>({...ne,date:ne.date&&typeof ne.date=="object"&&ne.date.toDate?ne.date.toDate().toISOString():ne.date,type:ne.type==="income"?"Income":ne.type==="expense"?"Expense":ne.type==="transfer"?"Transfer":ne.type,amount:typeof ne.amount=="string"?parseFloat(ne.amount):ne.amount})),j=Y=>({id:Y.id,name:Y.name,currentBalance:Y.currentBalance||0,lastUpdated:Y.lastUpdated,isActive:Y.isActive??!0,orderIndex:Y.orderIndex??0,createdAt:Y.createdAt,isPiggybank:Y.isPiggybank,piggybankConfig:Y.piggybankConfig}),N=O.filter(Y=>!("orderIndex"in Y));N.length>0&&(console.log(` Migrating ${N.length} envelopes to add orderIndex...`),N.forEach((Y,ne)=>{const pe=ne,de=n();Fi.saveEnvelope(de,{...Y,orderIndex:pe}).then(()=>console.log(` Migrated envelope ${Y.name} with orderIndex ${pe}`)).catch(ge=>console.warn(`Failed to migrate envelope ${Y.id}:`,ge))}));const K=O.map(j),W=new Set([...V.envelopes.map(Y=>Y.id),...O.map(Y=>Y.id)]),$=V.envelopes.filter(Y=>Y.id&&!O.some(ne=>ne.id===Y.id)),H=V.transactions.filter(Y=>{const ne=Y.id&&!z.some(we=>we.id===Y.id),pe=Y.id&&Y.id.startsWith("temp-"),de=W.has(Y.envelopeId),ge=ne&&(pe&&de||!pe&&de);return ne&&!ge&&console.log(` Filtering out orphaned transaction: ${Y.id} (envelope: ${Y.envelopeId}, exists: ${de})`),ge});let te,re=[];navigator.onLine?(te=P,console.log(` Online mode: Using Firebase templates only (${te.length} templates)`)):(re=V.distributionTemplates.filter(Y=>Y.id&&!P.some(ne=>ne.id===Y.id)),te=P.concat(re),console.log(` Offline mode: Merged ${P.length} Firebase + ${re.length} local templates`)),console.log(" fetchData merge details:"),console.log("  Store envelopes:",V.envelopes.map(Y=>({id:Y.id,name:Y.name}))),console.log("  Firebase envelopes:",O.map(Y=>({id:Y.id,name:Y.name}))),console.log("  Store transactions:",V.transactions.map(Y=>({id:Y.id,envelopeId:Y.envelopeId,description:Y.description}))),console.log("  Firebase transactions:",z.map(Y=>({id:Y.id,envelopeId:Y.envelopeId,description:Y.description}))),console.log("  Store templates:",V.distributionTemplates.map(Y=>({id:Y.id,name:Y.name}))),console.log("  Firebase templates:",P.map(Y=>({id:Y.id,name:Y.name}))),console.log("  Local-only envelopes:",$.map(Y=>({id:Y.id,name:Y.name}))),console.log("  Local-only transactions:",H.map(Y=>({id:Y.id,envelopeId:Y.envelopeId,description:Y.description}))),console.log("  Local-only templates:",re.map(Y=>({id:Y.id,name:Y.name}))),console.log("  Total merged templates:",te.length,te.map(Y=>({id:Y.id,name:Y.name})));const ue=K.concat($),F=B(z).concat(H);let Q=A;if(A&&"isDarkMode"in A&&!("theme"in A)){const Y=A;if(Q={...Y,theme:Y.isDarkMode?"dark":"light"},delete Q.isDarkMode,Q&&Q.id){const ne=n();Is.updateAppSettings(ne,Q.id,{theme:Q.theme}).catch(pe=>console.warn("Failed to migrate app settings:",pe))}}return{envelopes:ue,transactions:F,distributionTemplates:te,appSettings:Q,isLoading:!1,pendingSync:!1}})}catch(I){console.error(" Firebase fetch failed:",I);const D=e(),O=D.envelopes.length>0||D.transactions.length>0;I.message==="Firebase query timeout"||r(I)?O?(console.log(" Using cached envelope data due to timeout/network error (likely offline)"),t({isLoading:!1,pendingSync:!0})):(console.error(" No cached envelope data available"),t({isLoading:!1,pendingSync:!0,error:"Unable to load data. Please check your connection."})):t({error:I.message,isLoading:!1})}}catch(w){console.error(" Critical error in fetchData:",w),t({isLoading:!1,error:"Failed to load envelope data"})}},u=async()=>{if(!e().isOnline)return;const w=e();if(w.resetPending){console.log(" Sync detected pending reset - performing Firebase reset..."),t({pendingSync:!0});try{await e().performFirebaseReset(),console.log(" Pending reset completed during sync")}catch(T){console.error("Firebase reset during sync failed:",T)}return}if(t({pendingSync:!0}),w.pendingDeletes&&w.pendingDeletes.length>0){console.log(` Syncing ${w.pendingDeletes.length} pending envelope deletions to Firebase...`);const T=n();for(const I of w.pendingDeletes)try{await Fi.deleteEnvelope(T,I),console.log(` Deleted envelope ${I} from Firebase`)}catch(D){console.error(` Failed to delete envelope ${I}:`,D)}t({pendingDeletes:[]})}if(w.pendingDeletedTransactions&&w.pendingDeletedTransactions.length>0){console.log(` Syncing ${w.pendingDeletedTransactions.length} pending transaction deletions to Firebase...`);const T=n();for(const I of w.pendingDeletedTransactions)try{await da.deleteTransaction(T,I),console.log(` Deleted transaction ${I} from Firebase`)}catch(D){console.error(` Failed to delete transaction ${I}:`,D)}t({pendingDeletedTransactions:[]})}try{const{useMonthlyBudgetStore:T}=await vi(async()=>{const{useMonthlyBudgetStore:D}=await Promise.resolve().then(()=>Ph);return{useMonthlyBudgetStore:D}},void 0),I=T.getState();if(I.pendingDeletedIncomeSources&&I.pendingDeletedIncomeSources.length>0){console.log(` Syncing ${I.pendingDeletedIncomeSources.length} pending income source deletions to Firebase...`);const{MonthlyBudgetService:D}=await vi(async()=>{const{MonthlyBudgetService:P}=await Promise.resolve().then(()=>Zu);return{MonthlyBudgetService:P}},void 0),O=D.getInstance(),z=n();for(const P of I.pendingDeletedIncomeSources)try{await O.deleteIncomeSource(z,P),console.log(` Deleted income source ${P} from Firebase`)}catch(A){console.error(` Failed to delete income source ${P}:`,A)}T.setState({pendingDeletedIncomeSources:[]})}}catch(T){console.error("Failed to sync income source deletions:",T)}const E=w.envelopes.filter(T=>T.id.startsWith("temp-"));if(E.length>0){console.log(` Syncing ${E.length} temp envelopes to Firebase...`);for(const T of E)try{const{id:I,...D}=T;D.userId||(D.userId=n());const O=await Fi.createEnvelope(D);console.log(` Synced temp envelope ${I} -> ${O.id}`),t(k=>({envelopes:k.envelopes.map(V=>V.id===I?{...O,order:T.order}:V)})),t(k=>({transactions:k.transactions.map(V=>V.envelopeId===I?{...V,envelopeId:O.id}:V)}));const{useMonthlyBudgetStore:z}=await vi(async()=>{const{useMonthlyBudgetStore:k}=await Promise.resolve().then(()=>Ph);return{useMonthlyBudgetStore:k}},void 0),P=z.getState(),A=P.envelopeAllocations.map(k=>k.envelopeId===I?{...k,envelopeId:O.id}:k);z.setState({envelopeAllocations:A});const C=A.filter(k=>k.envelopeId===O.id&&k.id?.startsWith("temp-"));if(C.length>0){const{MonthlyBudgetService:k}=await vi(async()=>{const{MonthlyBudgetService:j}=await Promise.resolve().then(()=>Zu);return{MonthlyBudgetService:j}},void 0),V=k.getInstance();for(const j of C)try{await V.createEnvelopeAllocation({envelopeId:j.envelopeId,budgetedAmount:j.budgetedAmount,userId:j.userId,month:j.month}),console.log(` Synced allocation for envelope ${O.id}`)}catch(N){console.error(" Failed to sync allocation:",N)}const B=await V.getEnvelopeAllocations(C[0].userId,P.currentMonth);z.setState({envelopeAllocations:B})}}catch(I){console.error(` Failed to sync temp envelope ${T.id}:`,I)}}try{const{useMonthlyBudgetStore:T}=await vi(async()=>{const{useMonthlyBudgetStore:O}=await Promise.resolve().then(()=>Ph);return{useMonthlyBudgetStore:O}},void 0),I=T.getState(),D=I.envelopeAllocations.filter(O=>O.id?.startsWith("temp-")&&!O.envelopeId.startsWith("temp-"));if(D.length>0){console.log(` Syncing ${D.length} temp allocations to Firebase...`);const{MonthlyBudgetService:O}=await vi(async()=>{const{MonthlyBudgetService:A}=await Promise.resolve().then(()=>Zu);return{MonthlyBudgetService:A}},void 0),z=O.getInstance();for(const A of D)try{await z.createEnvelopeAllocation({envelopeId:A.envelopeId,budgetedAmount:A.budgetedAmount,userId:A.userId,month:A.month}),console.log(` Synced temp allocation ${A.id} for envelope ${A.envelopeId}`)}catch(C){console.error(` Failed to sync temp allocation ${A.id}:`,C)}const P=await z.getEnvelopeAllocations(I.envelopeAllocations[0]?.userId||n(),I.currentMonth);T.setState({envelopeAllocations:P}),console.log(" Allocations refreshed after sync")}}catch(T){console.error("Failed to sync temp allocations:",T)}try{await e().fetchData()}catch(T){console.error("Manual sync failed:",T)}},d=async()=>{const w=await a();t({isOnline:w})},h=()=>{e().isOnline||(console.log(" Firebase operation succeeded - marking as online"),t({isOnline:!0}))},p=()=>{o()},m=async w=>{t({isImporting:!0});try{if(!w.envelopes||!w.transactions)return{success:!1,message:"Invalid backup format: Missing core data."};const E=n();console.log(` Importing data for user: ${E}`),console.log(" isImporting flag set to TRUE - real-time sync paused"),console.log(" Clearing existing Firebase data before import..."),await y(),t({envelopes:[],transactions:[],distributionTemplates:[],appSettings:null,error:null,pendingSync:!0,isLoading:!0}),console.log(" Local state cleared before import");const{clearMonthlyBudget:T}=xr.getState();await T(),console.log(" Monthly budget store cleared");const I=w.envelopes.map(j=>{console.log(" Raw envelope from backup:",JSON.stringify(j,null,2));const N={...j,id:j.id||`imported-${Date.now()}-${Math.random()}`,userId:E};return console.log(` Processing envelope: ${N.name}`,{isPiggybank:N.isPiggybank,hasPiggybankConfig:!!N.piggybankConfig,piggybankConfig:N.piggybankConfig}),N}),D=w.transactions.map(j=>({...j,id:j.id||`imported-${Date.now()}-${Math.random()}`,userId:E,date:j.date,amount:typeof j.amount=="number"?j.amount:parseFloat(j.amount)||0,type:j.type,reconciled:j.reconciled??!1})),O=(w.envelopeAllocations||[]).map(j=>({...j,id:j.id||`imported-${Date.now()}-${Math.random()}`,userId:E})),z=O.reduce((j,N)=>{const K=j.findIndex(W=>W.envelopeId===N.envelopeId);return K>=0?(j[K]=N,console.log(` Deduplicating allocation for envelope ${N.envelopeId} - keeping newer one`)):j.push(N),j},[]);console.log(` After deduplication: ${z.length} allocations (was ${O.length})`);const P=(w.incomeSources||[]).map(j=>({...j,id:j.id||`imported-${Date.now()}-${Math.random()}`,userId:E})),A=w.appSettings?{...w.appSettings,id:w.appSettings.id||`settings-${E}`,userId:E}:null;console.log(` Importing: ${I.length} envelopes, ${D.length} transactions, ${z.length} allocations, ${P.length} income sources`),t({envelopes:I,transactions:D,distributionTemplates:[],appSettings:A,error:null,pendingSync:!0});try{console.log(" Syncing imported data to Firebase...");for(const N of I)try{await Fi.saveEnvelope(E,N),console.log(` Synced envelope: ${N.name}`)}catch(K){console.error(` Failed to sync envelope ${N.name}:`,K)}for(const N of D)try{const K={...N,amount:N.amount.toString(),type:N.type.toLowerCase(),date:dt.fromDate(new Date(N.date))};await da.addTransaction(K),console.log(` Synced transaction: ${N.description}`)}catch(K){console.error(` Failed to sync transaction ${N.description}:`,K)}const j=(await vi(async()=>{const{MonthlyBudgetService:N}=await Promise.resolve().then(()=>Zu);return{MonthlyBudgetService:N}},void 0)).MonthlyBudgetService.getInstance();for(const N of z)try{await j.createEnvelopeAllocation(N),console.log(` Synced allocation for envelope: ${N.envelopeId}`)}catch(K){console.error(" Failed to sync allocation:",K)}for(const N of P)try{await j.createIncomeSource(N),console.log(` Synced income source: ${N.name}`)}catch(K){console.error(` Failed to sync income source ${N.name}:`,K)}if(A)try{await Is.createAppSettings(A),console.log(" Synced app settings")}catch(N){console.error(" Failed to sync app settings:",N)}console.log(" All imported data synced to Firebase"),console.log(" Clearing local state to fetch fresh data with Firebase IDs..."),t({envelopes:[],transactions:[],distributionTemplates:[],pendingSync:!1,isLoading:!1}),console.log(" Fetching fresh data from Firebase after import..."),await e().fetchData(),console.log(" Fresh data loaded from Firebase")}catch(j){console.error(" Error syncing to Firebase:",j),t({pendingSync:!0})}const C=A?"Settings imported.":"",{refreshAvailableToBudget:k,envelopeAllocations:V}=xr.getState();console.log(" Checking allocations after import:"),V.forEach(j=>{console.log(`  - ${j.envelopeId}: $${j.budgetedAmount}`)});const B=V.reduce((j,N)=>j+N.budgetedAmount,0);return console.log(` Total allocated after import: $${B}`),await k(),console.log(" Monthly budget available to budget refreshed"),{success:!0,message:`Imported and synced ${I.length} envelopes, ${D.length} transactions, ${z.length} allocations, ${P.length} income sources to Firebase.${C?` ${C}`:""}`}}catch(E){return console.error("Import failed:",E),{success:!1,message:"Failed to import data. Check file format."}}finally{console.log(" isImporting flag set to FALSE - real-time sync resumed"),t({isImporting:!1})}},y=async()=>{console.log(" performFirebaseReset: Starting complete Firebase reset..."),t({isLoading:!0});try{const w=n();console.log(" Querying Firebase for all data to delete...");const[E,T,I,D]=await Promise.all([Fi.getAllEnvelopes(w).catch(A=>(console.error(" Failed to fetch envelopes for reset:",A),[])),da.getAllTransactions(w).catch(A=>(console.error(" Failed to fetch transactions for reset:",A),[])),Bi.getAllDistributionTemplates(w).catch(A=>(console.error(" Failed to fetch templates for reset:",A),[])),Is.getAppSettings(w).catch(A=>(console.error(" Failed to fetch settings for reset:",A),null))]);console.log(` Found in Firebase: ${E.length} envelopes, ${T.length} transactions, ${I.length} templates`);let O=0;for(const A of E)if(A.id)try{await Fi.deleteEnvelope(w,A.id),O++,console.log(` Deleted envelope: ${A.name||A.id}`)}catch(C){console.error(` Failed to delete envelope ${A.id}:`,C)}let z=0;for(const A of T)if(A.id)try{await da.deleteTransaction(w,A.id),z++,console.log(` Deleted transaction: ${A.id}`)}catch(C){console.error(` Failed to delete transaction ${A.id}:`,C)}let P=0;for(const A of I)if(A.id)try{await Bi.deleteDistributionTemplate(w,A.id),P++,console.log(` Deleted template: ${A.name||A.id}`)}catch(C){console.error(` Failed to delete template ${A.id}:`,C)}if(D?.id)try{await Is.deleteAppSettings(w,D.id),console.log(" Deleted app settings")}catch(A){console.error(" Failed to delete app settings:",A)}console.log(` Firebase reset complete: Deleted ${O} envelopes, ${z} transactions, ${P} templates`),t({resetPending:!1,isLoading:!1,pendingSync:!1})}catch(w){throw console.error(" Error during Firebase reset:",w),t({isLoading:!1,pendingSync:!0}),w}};return{fetchData:c,syncData:u,updateOnlineStatus:d,markOnlineFromFirebaseSuccess:h,handleUserLogout:p,importData:m,performFirebaseReset:y,resetData:async()=>{if(console.log(" Starting complete data reset (offline-first)..."),t({envelopes:[],transactions:[],distributionTemplates:[],appSettings:null,error:null,resetPending:!0,isLoading:!0}),console.log(" Local state cleared immediately"),e().isOnline){console.log(" Online - performing Firebase reset immediately...");try{await e().performFirebaseReset(),console.log(" Firebase reset completed immediately")}catch(E){console.error(" Firebase reset failed, will retry on next sync:",E),t({isLoading:!1,pendingSync:!0})}}else console.log(" Offline - Firebase reset will be performed when connection is restored"),t({isLoading:!1,pendingSync:!0})}}},Kee=t=>NE(t),Xee=t=>({id:t.id,name:t.name||"",currentBalance:t.currentBalance||0,lastUpdated:t.lastUpdated,isActive:t.isActive??!0,orderIndex:t.orderIndex??0,userId:t.userId||void 0,createdAt:t.createdAt,isPiggybank:t.isPiggybank,piggybankConfig:t.piggybankConfig}),Wee=t=>({id:t.id,name:t.name||"",distributions:t.distributions||{},lastUsed:t.lastUsed?.toDate?.()?t.lastUsed.toDate().toISOString():t.lastUsed||new Date().toISOString(),note:t.note||"",userId:t.userId||void 0}),zk=(t,e)=>{if(window.__firebaseUnsubscribers){console.log(" Real-time subscriptions already active, skipping setup");return}console.log(" Setting up real-time Firebase subscriptions...");const n=Fi.subscribeToEnvelopes(e,o=>{const c=t.getState();if(c.isOnline&&!c.pendingSync&&!c.resetPending&&!c.isImporting){console.log(" Real-time sync: Envelopes updated",o.length);const u=o.map(Xee);t.setState({envelopes:u})}else console.log(" Real-time sync: BLOCKED envelope update",{isOnline:c.isOnline,pendingSync:c.pendingSync,resetPending:c.resetPending,isImporting:c.isImporting})}),r=da.subscribeToTransactions(e,o=>{const c=t.getState();if(c.isOnline&&!c.pendingSync&&!c.resetPending&&!c.isImporting){console.log(" Real-time sync: Transactions updated",o.length);const u=o.map(Kee);t.setState({transactions:u})}else console.log(" Real-time sync: BLOCKED transaction update",{isOnline:c.isOnline,pendingSync:c.pendingSync,resetPending:c.resetPending,isImporting:c.isImporting,transactionCount:o.length})}),i=Bi.subscribeToDistributionTemplates(e,o=>{const c=t.getState();if(c.isOnline&&!c.pendingSync&&!c.resetPending&&!c.isImporting){console.log(" Real-time sync: Templates updated from Firebase",o.length),console.log(" Firebase templates:",o.map(d=>({id:d.id,name:d.name})));const u=o.map(Wee);console.log(" Setting store templates to:",u.map(d=>({id:d.id,name:d.name}))),t.setState({distributionTemplates:u})}else console.log(" Real-time sync: Skipping template update (offline or pending changes)")}),a=Is.subscribeToAppSettings(e,o=>{const c=t.getState();c.isOnline&&!c.pendingSync&&!c.resetPending&&!c.isImporting&&(console.log(" Real-time sync: Settings updated",o?"found":"null"),t.setState({appSettings:o}))});window.__firebaseUnsubscribers={envelopes:n,transactions:r,templates:i,settings:a},console.log(" Real-time subscriptions active - cross-device sync enabled")},Qee=t=>{const{useEnvelopeStore:e,useAuthStore:n,getCurrentUserId:r}=t;if(typeof window>"u")return;window.addEventListener("online",async()=>{console.log(" Browser online event detected"),await e.getState().updateOnlineStatus();const c=e.getState();c.isOnline&&(c.pendingSync||c.resetPending)&&(console.log(" Auto-syncing pending operations..."),c.syncData())}),window.addEventListener("offline",()=>{console.log(" Browser offline event detected"),e.setState({isOnline:!1})}),setTimeout(()=>{e.getState().updateOnlineStatus()},1e3);let i=null;const a=()=>{i&&clearInterval(i),i=setInterval(async()=>{const c=e.getState();if(!c.isOnline&&!c.testingConnectivity){console.log(" Periodic offline retry: testing connectivity..."),e.setState({testingConnectivity:!0});try{await(async()=>(await e.getState().updateOnlineStatus(),e.getState().isOnline))()?(console.log(" Periodic retry succeeded - back online!"),e.setState({isOnline:!0,testingConnectivity:!1}),(c.pendingSync||c.resetPending)&&e.getState().syncData(),i&&(clearInterval(i),i=null)):e.setState({testingConnectivity:!1})}catch(u){console.log(" Periodic retry failed:",u),e.setState({testingConnectivity:!1})}}else c.isOnline&&i&&(clearInterval(i),i=null)},3e4)};a(),e.subscribe(c=>{!c.isOnline&&!i&&(console.log(" Starting periodic connectivity retry"),a())});const o=n.getState();o.isAuthenticated&&o.currentUser&&(console.log(" User already authenticated on app load, setting up real-time subscriptions"),zk(e,r())),n.subscribe(c=>{if(c.isAuthenticated&&c.currentUser)console.log(" User authenticated, setting up real-time subscriptions"),zk(e,r());else if(!c.isAuthenticated&&!c.isLoading){if(console.log(" User logged out, clearing data and unsubscribing"),window.__firebaseUnsubscribers){const u=window.__firebaseUnsubscribers;u.envelopes&&u.envelopes(),u.transactions&&u.transactions(),u.templates&&u.templates(),u.settings&&u.settings(),delete window.__firebaseUnsubscribers,console.log(" Cleaned up Firebase subscriptions")}e.getState().handleUserLogout()}})},Zee=async()=>{try{console.log(" Attempting to load fallback data from backup file...");const t=await fetch("/HouseBudget_Backup_2025-11-25.json");if(t.ok){const e=await t.json();return console.log(" Loaded fallback data:",{envelopes:e.envelopes?.length||0,transactions:e.transactions?.length||0,templates:e.distributionTemplates?.length||0}),e}}catch(t){console.log(" Could not load fallback data:",t)}return null},Lu=()=>{const{currentUser:t}=Xi.getState();if(!t)throw new Error("No authenticated user found");return t.id},Jee=()=>{console.log(" Clearing user data on logout"),An.setState({envelopes:[],transactions:[],distributionTemplates:[],appSettings:null,isLoading:!1,isImporting:!1,error:null,isOnline:typeof navigator<"u"?navigator.onLine:!0,pendingSync:!1,resetPending:!1,pendingDeletes:[],pendingDeletedTransactions:[]})},Lk=async()=>{if(typeof navigator>"u"||!navigator.onLine)return console.log(" Browser reports offline"),!1;const t=async(n,r={})=>{try{const i=new AbortController,a=setTimeout(()=>i.abort(),4e3);return await fetch(n,{method:"HEAD",mode:"no-cors",cache:"no-cache",signal:i.signal,...r}),clearTimeout(a),!0}catch(i){return console.log(` Connectivity test failed for ${n}:`,i instanceof Error?i.message:"Unknown error"),!1}},e=[t("https://httpbin.org/status/200",{method:"GET"}),t("https://www.cloudflare.com/favicon.ico"),t("https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"),t("https://www.google.com/favicon.ico")];console.log(" Testing connectivity with multiple endpoints...");try{const n=await Promise.allSettled(e),r=n.filter(a=>a.status==="fulfilled"&&a.value===!0).length,i=n.length;return r>0?(console.log(` Connectivity confirmed (${r}/${i} tests passed)`),!0):(console.log(` All connectivity tests failed (${i} tests)`),!1)}catch(n){return console.log(" Connectivity testing error:",n),!1}},Ym=t=>{const e=t?.code?.toLowerCase()||"",n=t?.message?.toLowerCase()||"",r=t?.name?.toLowerCase()||"";return!!(e==="unavailable"||e==="cancelled"||n.includes("network")||n.includes("offline")||n.includes("disconnected")||n.includes("connection")||n.includes("fetch")||n.includes("timeout")||n.includes("err_internet_disconnected")||n.includes("err_network_changed")||n.includes("err_connection_refused")||!navigator.onLine||r==="undefined"&&n==="undefined")},An=Vv()(TS((t,e)=>{const n=Lee({set:t,get:e,getCurrentUserId:Lu,isNetworkError:Ym}),r=Bee({set:t,get:e,getCurrentUserId:Lu,isNetworkError:Ym}),i=fj({set:t,get:e,getCurrentUserId:Lu}),a=$ee({set:t,get:e,getCurrentUserId:Lu,isNetworkError:Ym}),o=Yee({set:t,get:e,getCurrentUserId:Lu,isNetworkError:Ym,loadFallbackData:Zee,checkOnlineStatus:Lk,clearUserData:Jee});return{envelopes:[],transactions:[],distributionTemplates:[],appSettings:null,isLoading:!1,isImporting:!1,error:null,isOnline:typeof navigator<"u"?navigator.onLine:!0,pendingSync:!1,resetPending:!1,testingConnectivity:!1,pendingDeletes:[],pendingDeletedTransactions:[],addEnvelope:async c=>(await n.createEnvelope(c)).id,updateEnvelope:n.updateEnvelope,reorderEnvelopes:n.reorderEnvelopes,deleteEnvelope:n.deleteEnvelope,renameEnvelope:n.renameEnvelope,transferFunds:n.transferFunds,addTransaction:a.addTransaction,updateTransaction:a.updateTransaction,deleteTransaction:a.deleteTransaction,restoreTransaction:a.restoreTransaction,addDistributionTemplate:r.saveTemplate,updateDistributionTemplate:r.updateTemplate,deleteDistributionTemplate:r.deleteTemplate,removeEnvelopeFromTemplates:r.removeEnvelopeFromTemplates,cleanupOrphanedTemplates:r.cleanupOrphanedTemplates,updateAppSettings:i.updateAppSettings,initializeAppSettings:i.initializeAppSettings,fetchData:o.fetchData,syncData:o.syncData,updateOnlineStatus:o.updateOnlineStatus,markOnlineFromFirebaseSuccess:o.markOnlineFromFirebaseSuccess,handleUserLogout:o.handleUserLogout,importData:o.importData,performFirebaseReset:o.performFirebaseReset,resetData:o.resetData,getEnvelopeBalance:c=>{const u=e();if(!u.envelopes.find(E=>E.id===c))return console.log(` getEnvelopeBalance: Envelope ${c} not found`),new ti(0);const h=u.transactions.filter(E=>E.envelopeId===c),p=h.filter(E=>E.type==="Expense"),m=h.filter(E=>E.type==="Income"),y=p.reduce((E,T)=>E.plus(new ti(T.amount||0)),new ti(0));return m.reduce((E,T)=>E.plus(new ti(T.amount||0)),new ti(0)).minus(y)},getTransactionsForMonth:c=>e().transactions.filter(d=>d.month===c),resetAllData:async()=>{console.log(" Resetting all data"),t({envelopes:[],transactions:[],distributionTemplates:[],appSettings:null,isLoading:!1,isImporting:!1,error:null,isOnline:typeof navigator<"u"?navigator.onLine:!0,pendingSync:!1,resetPending:!1})},testConnectivity:async()=>{console.log(" Testing connectivity"),await Lk()}}},{name:"envelope-storage",partialize:t=>({envelopes:t.envelopes,transactions:t.transactions,distributionTemplates:t.distributionTemplates,appSettings:t.appSettings})}));Qee({useEnvelopeStore:An,useAuthStore:Xi,getCurrentUserId:Lu});const ete=Object.freeze(Object.defineProperty({__proto__:null,useEnvelopeStore:An},Symbol.toStringTag,{value:"Module"})),tte=({currentMonth:t,onMonthChange:e})=>{const[n,r]=t.split("-").map(Number),a=["January","February","March","April","May","June","July","August","September","October","November","December"][r-1],o=()=>{let d=n,h=r-1;h<1&&(d=n-1,h=12);const p=`${d}-${h.toString().padStart(2,"0")}`;e(p)},c=()=>{let d=n,h=r+1;h>12&&(d=n+1,h=1);const p=`${d}-${h.toString().padStart(2,"0")}`;e(p)},u=()=>{const d=new Date,h=`${d.getFullYear()}-${(d.getMonth()+1).toString().padStart(2,"0")}`;e(h)};return b.jsx("div",{className:"py-1.5",children:b.jsxs("div",{className:"flex items-center justify-between",children:[b.jsx("button",{onClick:o,className:"p-2 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Previous month",children:b.jsx(Yz,{size:20})}),b.jsx("div",{className:"flex-1 text-center",children:b.jsxs("button",{onClick:u,className:"text-lg font-semibold text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors",title:"Click to go to current month",children:[a," ",n]})}),b.jsx("button",{onClick:c,className:"p-2 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Next month",children:b.jsx(Nu,{size:20})})]})})},nte=({amount:t,totalIncome:e,totalAllocated:n,isLoading:r=!1,variant:i="default"})=>{const a=e>0?n/e*100:0,o=t>0,c=Math.abs(t)<.01,u=t<0,d=c?100:Math.min(a,100),h=u?"bg-red-500":"bg-green-500",p=c,m=u,y=o,w=p?{icon:iw,color:"text-green-600 dark:text-emerald-400",bgColor:"bg-green-50 dark:bg-emerald-900/20",borderColor:"border-green-200 dark:border-emerald-800",title:"Budget Balanced!",subtitle:"Every dollar has a job"}:m?{icon:HL,color:"text-red-600 dark:text-red-400",bgColor:"bg-red-50 dark:bg-red-900/20",borderColor:"border-red-200 dark:border-red-800",title:"Over Budget",subtitle:"Reduce allocations or add income"}:{icon:FL,color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-50 dark:bg-blue-900/20",borderColor:"border-blue-200 dark:border-blue-800",title:"Available to Budget",subtitle:"Assign money to envelopes"};return r?b.jsxs("div",{className:i==="header"?"py-1.5 px-2":"bg-gray-50 dark:bg-zinc-900 rounded-2xl p-6 border border-gray-200 dark:border-zinc-800 animate-pulse",children:[b.jsxs("div",{className:"flex items-center justify-between mb-4",children:[b.jsx("div",{className:"h-6 bg-gray-200 dark:bg-zinc-700 rounded w-32"}),b.jsx("div",{className:"h-8 bg-gray-200 dark:bg-zinc-700 rounded w-20"})]}),b.jsx("div",{className:"h-2 bg-gray-200 dark:bg-zinc-700 rounded"})]}):b.jsxs("div",{className:i==="header"?"py-1.5 px-2":`rounded-2xl p-6 border ${w.bgColor} ${w.borderColor}`,children:[b.jsxs("div",{className:i==="header"?"flex items-center gap-3 mb-0.5":"flex items-center justify-between mb-4",children:[b.jsxs("div",{className:"flex-shrink-0 text-center",children:[b.jsx("div",{className:"text-xs text-gray-600 dark:text-zinc-400",children:"Assigned:"}),b.jsxs("div",{className:"text-base font-semibold text-gray-900 dark:text-white",children:["$",n.toFixed(2)]})]}),i==="header"&&b.jsx("div",{className:"flex-1 flex justify-center items-center",children:c?b.jsx("img",{src:"/personal-budget-pwa/images/budget-balanced.png",alt:"Budget Balanced",className:"w-6 h-6"}):u?b.jsx("div",{className:"text-center",children:b.jsx("div",{className:"text-xs text-red-600 dark:text-red-400 font-medium",children:"You're not in Congress!"})}):b.jsx("div",{className:"w-full h-1.5 bg-gray-200 dark:bg-zinc-700 rounded-full",children:b.jsx("div",{className:`h-1.5 rounded-full transition-all duration-300 ${h}`,style:{width:`${d}%`}})})}),b.jsx("div",{className:"flex-shrink-0 text-center",children:o?b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"text-xs text-gray-600 dark:text-zinc-400",children:"Left to Budget:"}),b.jsxs("div",{className:"text-base font-semibold text-gray-900 dark:text-white",children:["$",t.toFixed(2)]})]}):c?b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"text-xs text-green-600 dark:text-emerald-400",children:"All Budgeted!"}),b.jsx("div",{className:"text-base font-semibold text-green-600 dark:text-emerald-400",children:"$0.00"})]}):b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"text-xs text-red-600 dark:text-red-400",children:"Over Budget:"}),b.jsxs("div",{className:"text-base font-semibold text-red-600 dark:text-red-400",children:["-$",Math.abs(t).toFixed(2)]})]})})]}),i!=="header"&&!p&&e>0&&b.jsxs("div",{className:"space-y-2",children:[b.jsxs("div",{className:"flex justify-between text-sm text-gray-600 dark:text-zinc-400",children:[b.jsx("span",{children:"Allocated"}),b.jsxs("span",{children:[a.toFixed(0),"% of income"]})]}),b.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-700 rounded-full h-2",children:b.jsx("div",{className:`h-2 rounded-full transition-all duration-500 ${m?"bg-red-500":y?"bg-blue-500":"bg-green-500"}`,style:{width:`${Math.min(a,100)}%`}})}),b.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-zinc-500",children:[b.jsxs("span",{children:["$",n.toFixed(2)," allocated"]}),b.jsxs("span",{children:["$",e.toFixed(2)," income"]})]})]}),i!=="header"&&b.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-zinc-700",children:b.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[b.jsxs("div",{children:[b.jsxs("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["$",e.toFixed(2)]}),b.jsx("div",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Total Income"})]}),b.jsxs("div",{children:[b.jsxs("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["$",n.toFixed(2)]}),b.jsx("div",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Allocated"})]})]})})]})},rte=()=>{const[t,e]=G.useState(!1),n=G.useRef(null),{currentUser:r,logout:i}=Xi(),{handleUserLogout:a}=An(),o=as();G.useEffect(()=>{const d=h=>{n.current&&!n.current.contains(h.target)&&e(!1)};if(t)return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[t]);const c=async()=>{if(window.confirm("Are you sure you want to log out? This will clear all your data from the app until you log back in."))try{a(),i(),o("/"),e(!1)}catch(d){console.error("Logout failed:",d)}};if(!r)return null;const u=r.displayName?.charAt(0)?.toUpperCase()||r.email?.charAt(0)?.toUpperCase()||"U";return b.jsxs("div",{className:"relative",ref:n,children:[b.jsxs("button",{onClick:()=>e(!t),className:"flex items-center gap-2 px-3 py-1.5 rounded-lg hover:bg-gray-100 dark:hover:bg-zinc-800 transition-colors",children:[b.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-semibold",children:u}),b.jsx("span",{className:"hidden sm:block text-sm font-medium text-gray-700 dark:text-gray-300",children:r.displayName||r.email?.split("@")[0]||"User"}),b.jsx(sN,{size:16,className:`text-gray-500 dark:text-gray-400 transition-transform ${t?"rotate-180":""}`})]}),t&&b.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-zinc-900 rounded-xl shadow-lg border border-gray-200 dark:border-zinc-800 overflow-hidden z-50",children:[b.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-zinc-800",children:b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold",children:u}),b.jsxs("div",{className:"flex-1 min-w-0",children:[b.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-white truncate",children:r.displayName||r.email?.split("@")[0]||"User"}),b.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-400 truncate",children:r.email})]})]})}),b.jsxs("div",{className:"py-1",children:[b.jsxs("button",{onClick:()=>{o("/settings"),e(!1)},className:"w-full px-4 py-2.5 flex items-center gap-3 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:[b.jsx(oN,{size:18,className:"text-gray-500 dark:text-gray-400"}),"Settings"]}),b.jsxs("button",{onClick:c,className:"w-full px-4 py-2.5 flex items-center gap-3 text-left text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/10 transition-colors",children:[b.jsx(kL,{size:18}),"Log Out"]})]})]})]})},Xp=({children:t,onDelete:e,threshold:n=-100})=>{const r=GU(),[i,a]=G.useState(!1),o=G.useRef(0),c=()=>{a(!0),o.current=Date.now()},u=async(d,h)=>{const p=h.offset.x,m=h.velocity.x;if(setTimeout(()=>a(!1),100),p<n||p<-50&&m<-500){const y=e();y===!1?r.start({x:0}):y instanceof Promise&&y.then(_=>{_===!1&&r.start({x:0})})}else r.start({x:0})};return b.jsxs("div",{className:"relative w-full overflow-hidden mb-2 rounded-xl group",children:[b.jsx("div",{className:"absolute inset-0 bg-red-500 flex items-center justify-end pr-6 rounded-xl",children:b.jsx(Wm,{className:"text-white w-6 h-6"})}),b.jsx(pl.div,{drag:"x",dragConstraints:{left:-500,right:0},dragElastic:.1,onDragStart:c,onDragEnd:u,animate:r,className:`relative bg-white dark:bg-zinc-900 rounded-xl ${i?"z-20":"z-10"}`,style:{touchAction:"pan-y",pointerEvents:i?"none":"auto"},children:t})]})},pj=({message:t="Loading your budget...",showTimeout:e=!1})=>b.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex flex-col items-center justify-center px-4",children:[b.jsx("div",{className:"mb-8",children:b.jsxs("div",{className:"relative",children:[b.jsx(lc,{size:48,className:"text-blue-500 animate-spin"}),b.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:b.jsx(aw,{size:24,className:"text-blue-600 dark:text-blue-400"})})]})}),b.jsxs("div",{className:"text-center space-y-3",children:[b.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:t}),b.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400 max-w-md",children:"This may take a moment on slow connections. We're fetching your budget data securely."})]}),b.jsxs("div",{className:"mt-12 w-full max-w-md space-y-4",children:[b.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:b.jsxs("div",{className:"flex justify-between items-center",children:[b.jsx("div",{className:"h-6 bg-gray-200 dark:bg-zinc-700 rounded w-24 animate-pulse"}),b.jsxs("div",{className:"flex gap-2",children:[b.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),b.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),b.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]})]})}),b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-zinc-800",children:[b.jsx("div",{className:"h-4 bg-gray-200 dark:bg-zinc-700 rounded w-32 mb-2 animate-pulse"}),b.jsx("div",{className:"h-8 bg-gray-200 dark:bg-zinc-700 rounded w-20 animate-pulse"})]}),b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[b.jsxs("div",{className:"flex justify-between items-center mb-4",children:[b.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-28 animate-pulse"}),b.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),b.jsxs("div",{className:"space-y-3",children:[b.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),b.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]}),b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[b.jsxs("div",{className:"flex justify-between items-center mb-4",children:[b.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-32 animate-pulse"}),b.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),b.jsxs("div",{className:"space-y-3",children:[b.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),b.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),b.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]})]}),e&&b.jsx("div",{className:"mt-8 p-4 bg-amber-50 dark:bg-amber-900/20 rounded-xl border border-amber-200 dark:border-amber-800 max-w-md",children:b.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200 text-center",children:"This is taking longer than usual. If you're on a very slow connection, this is normal. Your data will load shortly."})}),b.jsx("div",{className:"mt-8 w-full max-w-md",children:b.jsx("div",{className:"h-1 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:b.jsx("div",{className:"h-full bg-blue-500 rounded-full animate-pulse",style:{width:"60%"}})})})]}),Yd=Vv((t,e)=>({message:"",type:"neutral",isVisible:!1,undoAction:void 0,showToast:(n,r="neutral",i)=>{t({message:n,type:r,isVisible:!0,undoAction:i}),setTimeout(()=>{e().hideToast()},6e3)},hideToast:()=>{t({isVisible:!1})}})),ite=({isVisible:t,onClose:e,mode:n,initialIncomeSource:r})=>{const{createIncomeSource:i,updateIncomeSource:a}=xr(),{showToast:o}=Yd(),[c,u]=G.useState(""),[d,h]=G.useState(""),[p,m]=G.useState(!1);G.useEffect(()=>{if(!t)return;const _=window.setTimeout(()=>{n==="edit"&&r?(u(r.name),h(r.amount.toString())):(u(""),h(""))},0);return()=>window.clearTimeout(_)},[t,n,r]);const y=async _=>{if(_.preventDefault(),!c.trim()||!d||parseFloat(d)<=0){o("Please fill in all required fields with valid values","error");return}m(!0);try{if(n==="add")await i({name:c.trim(),amount:parseFloat(d)}),o(`Added "${c.trim()}" as income source`,"success");else if(n==="edit"){if(!r){o("Error: No income source to edit","error");return}await a(r.id,{name:c.trim(),amount:parseFloat(d)}),o(`Updated "${c.trim()}" income source`,"success")}e()}catch(w){console.error("Error saving income source:",w),o("Failed to save income source. Please try again.","error")}finally{m(!1)}};return t?b.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[b.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[b.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n==="add"?"Add Income Source":"Edit Income Source"}),b.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",children:""})]}),b.jsxs("form",{onSubmit:y,className:"p-6 space-y-4",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Income Source Name *"}),b.jsx("input",{type:"text",value:c,onChange:_=>u(_.target.value),placeholder:"e.g., Primary Job, Freelance, Investments",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Amount *"}),b.jsxs("div",{className:"relative",children:[b.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-zinc-400",children:"$"}),b.jsx("input",{type:"number",value:d,onChange:_=>h(_.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]})]}),b.jsxs("div",{className:"flex gap-3 pt-4",children:[b.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),b.jsx("button",{type:"submit",disabled:p||!c.trim()||!d||parseFloat(d)<=0,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:p?"Saving...":n==="add"?"Add Income":"Save Changes"})]})]})]})}):null},ate=({isVisible:t,onClose:e,onConfirm:n,currentMonth:r,incomeCount:i,totalIncome:a,allocationCount:o,totalAllocated:c,isLoading:u=!1})=>{const[d,h]=G.useState(""),[p,m]=G.useState("confirm"),y=E=>{const[T,I]=E.split("-");return new Date(parseInt(T),parseInt(I)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},_=()=>{p==="confirm"?m("type"):p==="type"&&d==="START FRESH"&&n()},w=()=>{m("confirm"),h(""),e()};return t?b.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[b.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[b.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Start Fresh for ",y(r)]}),b.jsx("button",{onClick:w,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",disabled:u,children:""})]}),b.jsx("div",{className:"p-6 space-y-4",children:p==="confirm"?b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:b.jsxs("div",{className:"flex items-start",children:[b.jsx("div",{className:"flex-shrink-0",children:b.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:b.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),b.jsxs("div",{className:"ml-3",children:[b.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"This action will permanently delete:"}),b.jsx("div",{className:"mt-2 text-sm text-red-700 dark:text-red-300",children:b.jsxs("ul",{className:"space-y-1",children:[b.jsxs("li",{children:[" ",i," income source",i!==1?"s":""," (totaling $",a.toFixed(2),"/month)"]}),b.jsxs("li",{children:[" ",o," envelope allocation",o!==1?"s":""," (totaling $",c.toFixed(2),")"]})]})})]})]})}),b.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:b.jsxs("div",{className:"flex",children:[b.jsx("div",{className:"flex-shrink-0",children:b.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:b.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),b.jsx("div",{className:"ml-3",children:b.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[b.jsx("strong",{children:"All other months will remain completely unchanged."})," This only affects the current month's budget data."]})})]})}),b.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"You can undo this action within 30 seconds if you change your mind."})]}):b.jsxs(b.Fragment,{children:[b.jsxs("div",{className:"text-center",children:[b.jsxs("p",{className:"text-sm text-gray-900 dark:text-white mb-4",children:["Type ",b.jsx("strong",{children:"START FRESH"})," to confirm:"]}),b.jsx("input",{type:"text",value:d,onChange:E=>h(E.target.value),placeholder:"START FRESH",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent dark:bg-zinc-800 dark:text-white text-center font-mono text-lg",autoFocus:!0})]}),b.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500 text-center",children:"This action cannot be undone after 30 seconds"})]})}),b.jsxs("div",{className:"flex gap-3 p-6 border-t border-gray-200 dark:border-zinc-800",children:[b.jsx("button",{type:"button",onClick:w,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",disabled:u,children:"Cancel"}),b.jsx("button",{type:"button",onClick:_,disabled:u||p==="type"&&d!=="START FRESH",className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:u?"Clearing...":p==="confirm"?"Continue":"Start Fresh"})]})]})}):null},ste=({currentMonth:t,onCopy:e,onDismiss:n,isLoading:r=!1})=>{const i=o=>{const[c,u]=o.split("-");return new Date(parseInt(c),parseInt(u)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},a=o=>{const[c,u]=o.split("-").map(Number);let d=c,h=u-1;return h<1&&(d=c-1,h=12),i(`${d}-${h.toString().padStart(2,"0")}`)};return b.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-2xl p-6 mb-6",children:[b.jsxs("div",{className:"flex items-start justify-between",children:[b.jsxs("div",{className:"flex items-start space-x-3",children:[b.jsx("div",{className:"flex-shrink-0",children:b.jsx(oL,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),b.jsxs("div",{className:"flex-1",children:[b.jsx("h3",{className:"text-lg font-medium text-blue-900 dark:text-blue-100",children:"Copy Previous Month?"}),b.jsxs("p",{className:"mt-1 text-sm text-blue-700 dark:text-blue-300",children:["Would you like to copy your budget setup from ",a(t)," to get started with ",i(t),"?"]}),b.jsx("p",{className:"mt-2 text-xs text-blue-600 dark:text-blue-400",children:"This will copy your income sources and envelope allocations, but not transactions."})]})]}),b.jsx("button",{onClick:n,className:"flex-shrink-0 text-blue-400 hover:text-blue-600 dark:hover:text-blue-300 transition-colors","aria-label":"Dismiss",children:b.jsx(vp,{className:"h-5 w-5"})})]}),b.jsxs("div",{className:"mt-4 flex space-x-3",children:[b.jsx("button",{onClick:n,className:"flex-1 px-4 py-2 text-sm font-medium text-blue-700 dark:text-blue-300 bg-white dark:bg-zinc-800 border border-blue-300 dark:border-blue-600 rounded-lg hover:bg-blue-50 dark:hover:bg-zinc-700 transition-colors",disabled:r,children:"Start Fresh"}),b.jsx("button",{onClick:e,disabled:r,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:r?"Copying...":"Copy Previous Month"})]})]})},ote=({piggybank:t,balance:e,onNavigate:n})=>{const r=An(K=>K.updateEnvelope),i=An(K=>K.transactions),a=An(K=>K.deleteTransaction),o=xr(K=>K.currentMonth),c=xr(K=>K.setEnvelopeAllocation),u=Yd(K=>K.showToast),d=t.piggybankConfig?.targetAmount,h=t.piggybankConfig?.monthlyContribution||0,p=t.piggybankConfig?.color||"#3B82F6",m=t.piggybankConfig?.paused||!1,y=e.toNumber(),_=(K,W=1)=>{const $=K.replace("#",""),H=parseInt($,16),te=H>>16&255,re=H>>8&255,ue=H&255;return`rgba(${te}, ${re}, ${ue}, ${W})`},w=`linear-gradient(135deg, ${_(p,.14)} 0%, ${_(p,.05)} 100%)`,E=_(p,.4),[T,I]=G.useState(!1),[D,O]=G.useState(h?h.toFixed(2):"0.00"),[z,P]=G.useState(!1),A=G.useRef(null),C=d&&d>0?Math.min(y/d*100,100):0,k=d&&y>=d;G.useEffect(()=>{T||O(h?h.toFixed(2):"0.00")},[h,T]),G.useEffect(()=>{T&&A.current&&(A.current.focus(),A.current.select())},[T]);const V=K=>{K.stopPropagation(),("touches"in K||K.type.startsWith("touch"))&&K.preventDefault(),!z&&(O(h?h.toFixed(2):"0.00"),I(!0))},B=()=>{I(!1),O(h?h.toFixed(2):"0.00")},j=async()=>{if(!T||z)return;const K=parseFloat(D);if(Number.isNaN(K)||K<0){u("Enter a valid contribution amount","error");return}if(K===h){I(!1);return}P(!0);try{const W={...t,lastUpdated:new Date().toISOString(),piggybankConfig:{monthlyContribution:K,targetAmount:t.piggybankConfig?.targetAmount,color:t.piggybankConfig?.color,icon:t.piggybankConfig?.icon,paused:t.piggybankConfig?.paused}};await r(W);const $=i.find(H=>H.envelopeId===t.id&&H.isAutomatic===!0&&H.month===o&&H.description.startsWith("Monthly contribution to"));$&&await a($.id),m||await c(t.id,K),u("Monthly contribution updated","success"),O(K.toFixed(2)),I(!1)}catch(W){console.error("Failed to update piggybank contribution",W),u("Failed to update contribution","error")}finally{P(!1)}},N=K=>{K.key==="Enter"?(K.preventDefault(),j()):K.key==="Escape"&&(K.preventDefault(),B())};return b.jsxs("div",{onClick:()=>n(t.id),className:"rounded-xl p-4 border transition-all cursor-pointer shadow-sm hover:shadow-md",style:{background:w,borderColor:E},children:[b.jsxs("div",{className:"flex items-start justify-between mb-3",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{backgroundColor:`${p}20`},children:b.jsx(jh,{size:20,style:{color:p}})}),b.jsxs("div",{children:[b.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:t.name}),k&&b.jsx("span",{className:"text-xs text-green-600 dark:text-green-400 font-medium",children:" Goal Reached!"})]})]}),b.jsxs("div",{className:"text-right",children:[b.jsxs("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:["$",y.toFixed(2)]}),d&&b.jsxs("div",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["of $",d.toFixed(2)]})]})]}),d&&d>0&&b.jsxs("div",{className:"mb-3",children:[b.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-800 rounded-full h-2 overflow-hidden",children:b.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${C}%`,backgroundColor:p}})}),b.jsxs("div",{className:"flex justify-between items-center mt-1",children:[b.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:[C.toFixed(0),"% complete"]}),b.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["$",(d-y).toFixed(2)," to go"]}),b.jsx("span",{className:"ml-2 px-2 py-0.5 text-[11px] font-semibold rounded-full uppercase tracking-wide",style:{backgroundColor:_(p,.15),color:p},children:"Piggybank"})]})]}),b.jsx("div",{className:"mt-2",children:m?b.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-zinc-400",children:[b.jsx(PL,{size:14,className:"text-orange-500"}),b.jsx("span",{className:"text-orange-600 dark:text-orange-400",children:"Paused"})]}):b.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-zinc-400",children:[b.jsx(YL,{size:14,style:{color:p}}),T?b.jsxs("form",{onSubmit:K=>{K.preventDefault(),j()},className:"flex items-center gap-2",children:[b.jsxs("div",{className:"relative",children:[b.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),b.jsx("input",{ref:A,type:"number",min:"0",step:"0.01",value:D,onChange:K=>O(K.target.value),onBlur:j,onKeyDown:N,disabled:z,autoFocus:!0,className:"w-28 pl-6 pr-3 py-1.5 rounded-lg border border-gray-300 dark:border-zinc-600 bg-white dark:bg-zinc-900 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),z&&b.jsx(EL,{size:16,className:"animate-spin text-gray-400"})]}):b.jsxs("div",{onClick:V,onTouchEnd:V,className:"font-medium text-gray-900 dark:text-white hover:underline cursor-pointer",children:["$",h.toFixed(2),"/month"]})]})})]})},th=(t,e=1)=>{const n=t.replace("#",""),r=parseInt(n,16),i=r>>16&255,a=r>>8&255,o=r&255;return`rgba(${i}, ${a}, ${o}, ${e})`},lte=12,cte=(t,e,n)=>Math.min(Math.max(t,e),n),ute=({env:t,budgetedAmount:e,remainingBalance:n,editingEnvelopeId:r,setEditingEnvelopeId:i,editingAmount:a,setEditingAmount:o,handleBudgetSave:c,navigate:u,inputRef:d,transactions:h,currentMonth:p,setMoveableRef:m,isReorderingActive:y,activelyDraggingId:_,onItemDragStart:w,onMoveUp:E,onMoveDown:T,isFirst:I,isLast:D,isReorderUnlocked:O})=>{const z=!!t.isPiggybank,P=t.piggybankConfig?.color||"#3B82F6",A=z?`linear-gradient(135deg, ${th(P,.18)} 0%, ${th(P,.08)} 100%)`:void 0,C=z?th(P,.5):void 0,k=G.useRef(null),[V,B]=G.useState(!1),j=h.filter(F=>F.envelopeId===t.id&&F.month===p),N=j.filter(F=>F.type==="Expense"),K=j.filter(F=>F.type==="Income"),W=N.reduce((F,Q)=>F+(Q.amount||0),0),$=K.reduce((F,Q)=>F+(Q.amount||0),0),H=Math.max(0,W/$*100),te=F=>{if(V||y){F.preventDefault(),F.stopPropagation();return}if(r===t.id){F.preventDefault(),F.stopPropagation();return}u(`/envelope/${t.id}`)};G.useEffect(()=>{_&&_!==t.id&&B(!1)},[_,t.id]),G.useEffect(()=>{_===t.id&&(B(!0),w(t.id))},[_,t.id,w]),G.useEffect(()=>{if(!_&&V){const F=setTimeout(()=>{B(!1)},300);return()=>clearTimeout(F)}},[_,V]);const re=b.jsxs("div",{className:"flex items-center gap-2 w-full",children:[O&&b.jsxs("div",{className:"flex flex-col gap-1",children:[b.jsx("button",{onClick:F=>{F.stopPropagation(),E()},disabled:I,className:`p-1 rounded transition-colors ${I?"text-gray-300 dark:text-zinc-700 cursor-not-allowed":"text-gray-500 dark:text-zinc-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20"}`,title:"Move up","aria-label":"Move envelope up",children:b.jsx(Wz,{size:18})}),b.jsx("button",{onClick:F=>{F.stopPropagation(),T()},disabled:D,className:`p-1 rounded transition-colors ${D?"text-gray-300 dark:text-zinc-700 cursor-not-allowed":"text-gray-500 dark:text-zinc-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20"}`,title:"Move down","aria-label":"Move envelope down",children:b.jsx(sN,{size:18})})]}),b.jsxs("div",{className:"flex-1",children:[b.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[z&&b.jsx("span",{className:"w-8 h-8 rounded-full flex items-center justify-center border",style:{borderColor:th(P,.4),backgroundColor:th(P,.15),color:P},children:b.jsx(jh,{size:16})}),b.jsxs("div",{children:[b.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:t.name}),z&&b.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:P},children:"Piggybank"})]})]}),b.jsxs("div",{className:"flex justify-between items-center",children:[b.jsx("div",{className:"flex items-center space-x-4",onPointerDown:F=>F.stopPropagation(),children:r===t.id?b.jsxs("div",{className:"flex items-center space-x-1",children:[b.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Budgeted:"}),b.jsx("form",{onSubmit:F=>{F.preventDefault(),c()},children:b.jsx("input",{ref:d,type:"number",value:a,onChange:F=>o(F.target.value),onBlur:c,className:"w-24 px-2 py-1 text-sm border rounded bg-white dark:bg-zinc-900 text-gray-900 dark:text-white",step:"0.01",autoFocus:!0})})]}):b.jsxs("div",{onClick:F=>{F.preventDefault(),F.stopPropagation(),i(t.id),o(e.toString())},onTouchEnd:F=>{F.preventDefault(),F.stopPropagation(),i(t.id),o(e.toString())},className:"flex items-center space-x-1 hover:bg-gray-200 dark:hover:bg-zinc-700 px-3 py-2 rounded transition-colors cursor-pointer js-budget-target",children:[b.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Budgeted:"}),b.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:["$",e.toFixed(2)]})]})}),b.jsxs("div",{className:"text-right",children:[b.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 block",children:"Remaining"}),b.jsxs("span",{className:`font-bold ${n.toNumber()<0||100-H<=5?"text-red-500":H>=80?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-emerald-400"}`,children:["$",n.toNumber().toFixed(2)]})]})]}),e>0&&b.jsx("div",{className:"mt-3",onClick:F=>F.stopPropagation(),children:b.jsxs(b.Fragment,{children:[b.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-zinc-400 mb-1",children:[b.jsx("span",{children:"Budget Used"}),b.jsxs("span",{children:[H.toFixed(0),"%"]})]}),b.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-700 rounded-full h-2 overflow-hidden",children:b.jsx("div",{className:`h-full transition-all duration-300 ease-out ${n.toNumber()<0||100-H<=5?"bg-red-500":H>=80?"bg-yellow-500":"bg-green-400"}`,style:{width:`${Math.max(100-H,2)}%`}})})]})})]})]}),ue=_===t.id;return b.jsx(pl.div,{layout:!ue,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},ref:F=>{m(t.id)(F),k.current=F},onClick:te,style:{boxShadow:"0 1px 2px rgba(15,23,42,0.08)",background:A,borderColor:C,cursor:"pointer"},className:`p-4 rounded-xl active:scale-[0.99] transition-all select-none border ${z?"bg-white/70 dark:bg-zinc-800/80":"bg-gray-50 dark:bg-zinc-800 border-transparent"}`,children:re})},dte=()=>{const{envelopes:t,transactions:e,fetchData:n,isLoading:r,isOnline:i,pendingSync:a,syncData:o,testingConnectivity:c,reorderEnvelopes:u}=An(),d=G.useCallback(Ae=>je=>{je?Pe.current[Ae]=je:delete Pe.current[Ae]},[]),{currentMonth:h,fetchMonthlyData:p,incomeSources:m,envelopeAllocations:y,calculateAvailableToBudget:_,deleteIncomeSource:w,restoreIncomeSource:E,clearMonthData:T,copyFromPreviousMonth:I,setEnvelopeAllocation:D,isLoading:O}=xr(),{showToast:z}=Yd(),P=as(),A=G.useCallback(async Ae=>{if(!Ae.length)return;const je=Ae.map(wt=>wt.id);try{await u(je)}catch(wt){console.error("Failed to persist envelope order:",wt),z("Failed to save envelope order","error")}},[u,z]),[C,k]=G.useState(!1),[V,B]=G.useState("add"),[j,N]=G.useState(null),[K,W]=G.useState(!1),[$,H]=G.useState(!1),[te,re]=G.useState(!1),ue=G.useRef(null),[F,Q]=G.useState(!1),Y=G.useRef(null),[ne,pe]=G.useState(!1),de=!ne||r||O,[ge,we]=G.useState(null),[Te,Xe]=G.useState(""),Se=G.useRef(null),[Ie,Je]=G.useState(()=>localStorage.getItem("envelopeReorderUnlocked")==="true");G.useEffect(()=>{localStorage.setItem("envelopeReorderUnlocked",Ie.toString())},[Ie]);const Me=Ae=>{if(t.find(Ot=>Ot.id===Ae)?.isPiggybank)return An.getState().getEnvelopeBalance(Ae);const wt=e.filter(Ot=>Ot.envelopeId===Ae&&Ot.month===h),rn=wt.filter(Ot=>Ot.type==="Expense"),qr=wt.filter(Ot=>Ot.type==="Income"),cr=rn.reduce((Ot,an)=>Ot.plus(new ti(an.amount||0)),new ti(0));return qr.reduce((Ot,an)=>Ot.plus(new ti(an.amount||0)),new ti(0)).minus(cr)};G.useEffect(()=>(Y.current=setTimeout(()=>{Q(!0)},8e3),n(),p(),pe(!0),()=>{Y.current&&clearTimeout(Y.current)}),[]),G.useEffect(()=>{ne&&!r&&!O&&(Q(!1),Y.current&&clearTimeout(Y.current))},[ne,r,O]),G.useEffect(()=>{if(!O&&!de){const Ae=m.length===0&&y.length===0;re(Ae)}},[O,de,m,y,h]),G.useEffect(()=>{ge&&Se.current&&(Se.current.focus(),Se.current.select())},[ge]);const[$e,We]=G.useState(!1),pt=G.useRef(null),_t=G.useRef(0),Pe=G.useRef({}),Ue=G.useRef({}),[Pt,yn]=G.useState(null),Wt=G.useRef({activeId:null,startIndex:0,currentIndex:0,itemHeight:0}),[ht,At]=G.useState([]),Ft=G.useRef([]),lr=t.filter(Ae=>{if(!Ae.isPiggybank||!Ae.isActive)return!1;if(Ae.createdAt){const je=new Date(Ae.createdAt),wt=`${je.getUTCFullYear()}-${String(je.getUTCMonth()+1).padStart(2,"0")}`;return console.log(` Piggybank filter: ${Ae.name}`,{createdAt:Ae.createdAt,createdMonth:wt,currentMonth:h,shouldShow:h>=wt}),h>=wt}return console.log(` Piggybank ${Ae.name} has no createdAt - showing by default`),!0});G.useEffect(()=>{if(!$e){const Ae=t.filter(je=>!je.isPiggybank&&je.isActive!==!1&&y.some(wt=>wt.envelopeId===je.id)).sort((je,wt)=>{const rn=je.orderIndex??0,qr=wt.orderIndex??0;return rn-qr});At(Ae),Ft.current=Ae}},[t,y,$e]);const Gr=G.useCallback(()=>We(!0),[]),ls=G.useCallback(()=>{We(!1),Ft.current.length&&A(Ft.current)},[A]),Zs=G.useCallback(Ae=>{},[]),Si=G.useCallback(Ae=>{ge!==Ae&&P(`/envelope/${Ae}`)},[ge,P]),_r=ht;G.useEffect(()=>{const Ae=()=>{Object.values(Ue.current).forEach(rn=>rn?.destroy()),Ue.current={}};if(!_r.length)return;const je=()=>{Ie&&_r.forEach(rn=>{const qr=Pe.current[rn.id];if(!qr)return;const cr=Ue.current[rn.id];if(cr){cr.target=qr;return}const wr=new i$(pt.current,{target:qr,draggable:Ie,throttleDrag:0,edgeDraggable:!1,startDragRotate:0,throttleDragRotate:0,rotatable:!1,scalable:!1,resizable:!1,warpable:!1,pinchable:!1,snappable:!0,snapThreshold:5,isDisplaySnapDigit:!1,isDisplayInnerSnapDigit:!1,snapGap:!0,snapDirections:{top:!0,bottom:!0,left:!1,right:!1},elementSnapDirections:{top:!0,bottom:!0,left:!1,right:!1},clickable:!0,preventClickDefault:!1,preventClickEventOnDrag:!0,checkInput:!1,dragArea:!0,hideDefaultLines:!0,hideChildMoveableDefaultLines:!0,renderDirections:[]});wr.on("dragStart",Ot=>{const an=Ft.current.findIndex(Nn=>Nn.id===rn.id),nr=Ot.target,$n=nr.getBoundingClientRect().height+lte;yn(rn.id),Wt.current={activeId:rn.id,startIndex:an,currentIndex:an,itemHeight:$n},nr&&(nr.style.transition="none",nr.style.boxShadow="0 18px 45px rgba(15,23,42,0.35)",nr.style.zIndex="20"),Gr()});let Nt=null;wr.on("drag",Ot=>{const an=Ot.target;Nt!==null&&cancelAnimationFrame(Nt),Nt=requestAnimationFrame(()=>{const nr=Wt.current;if(nr.activeId!==rn.id)return;const Hr=Ot.beforeTranslate[1];an.style.transform=`translateY(${Hr}px)`,an.style.transition="none";const{itemHeight:$n,startIndex:Nn}=nr;if(!$n)return;const Yn=Math.round(Hr/$n),rr=cte(Nn+Yn,0,Ft.current.length-1);rr!==nr.currentIndex&&(nr.currentIndex=rr,Ft.current.forEach((dn,fn)=>{if(dn.id===rn.id)return;const $r=Pe.current[dn.id];if(!$r)return;let Zi=0;Nn<rr?fn>Nn&&fn<=rr&&(Zi=-$n):Nn>rr&&fn>=rr&&fn<Nn&&(Zi=$n),$r.style.transform=Zi?`translateY(${Zi}px)`:"",$r.style.transition="transform 0.2s ease"})),Nt=null})}),wr.on("dragEnd",Ot=>{Nt!==null&&(cancelAnimationFrame(Nt),Nt=null);const an=Ot.target,nr=Wt.current,{startIndex:Hr,currentIndex:$n}=nr;if(an.style.transform="",an.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease",an.style.boxShadow="",Ft.current.forEach(Nn=>{if(Nn.id===rn.id)return;const Yn=Pe.current[Nn.id];Yn&&(Yn.style.transform="",Yn.style.transition="")}),Hr!==$n){const Nn=[...Ft.current],[Yn]=Nn.splice(Hr,1);Nn.splice($n,0,Yn),Ft.current=Nn,At(Nn)}setTimeout(()=>{an.style.zIndex="",an.style.transition="",yn(null)},300),Wt.current={activeId:null,startIndex:0,currentIndex:0,itemHeight:0},_t.current=Date.now(),ls()}),wr.on("click",Ot=>{const an=Ot.inputEvent.target;an.closest(".js-budget-target")||an.tagName==="INPUT"||Si(rn.id)}),Ue.current[rn.id]=wr})},wt=window.setTimeout(je,80);return()=>{clearTimeout(wt),Ae()}},[_r,Gr,ls,Si,Ie]);const Nr=t.reduce((Ae,je)=>Ae+Me(je.id).toNumber(),0);console.log(" Total balance:",Nr);const bn=async()=>{if(ge)try{const Ae=parseFloat(Te)||0;await D(ge,Ae)}catch(Ae){console.error("Failed to save budget amount:",Ae),z("Failed to update budget","error")}finally{we(null),Xe("")}},tr=()=>{B("add"),N(null),k(!0)},Qt=Ae=>{ue.current&&clearTimeout(ue.current),!K&&(B("edit"),N(Ae),k(!0))},Js=Ae=>{ue.current&&clearTimeout(ue.current),W(!0);const je=m.findIndex(rn=>rn.id===Ae.id),wt={...Ae};w(Ae.id).catch(console.error),z(`Deleted "${Ae.name}"`,"neutral",()=>E(wt,je)),setTimeout(()=>W(!1),500)},xa=()=>{k(!1),N(null)},_a=()=>{H(!0)},ut=async()=>{try{await T(),H(!1),z(`"${h}" budget cleared`,"neutral",()=>z('Cannot undo "Start Fresh" after 30 seconds',"error"))}catch(Ae){console.error("Error clearing month data:",Ae),z("Failed to clear month data","error")}},Zt=async()=>{try{await I(),re(!1),z("Previous month budget copied","success")}catch(Ae){console.error("Error copying previous month:",Ae),z("Failed to copy previous month","error")}},Jt=_();return de?b.jsx(pj,{message:F?"Still loading... This is normal on slow connections":"Loading your budget...",showTimeout:F}):b.jsxs(b.Fragment,{children:[b.jsx("style",{dangerouslySetInnerHTML:{__html:`
        .moveable-control { display: none !important; }
        .moveable-origin { display: none !important; }
        .moveable-line { display: none !important; }
      `}}),b.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-20",children:[b.jsxs("header",{className:"fixed top-0 left-0 right-0 z-50 bg-white dark:bg-zinc-900 border-b border-gray-100 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+4px)] pb-1",children:[b.jsxs("div",{className:"flex justify-between items-center",children:[b.jsx("div",{className:"flex items-center gap-2",children:i?r?b.jsxs("div",{className:"flex items-center gap-1 text-blue-500",children:[b.jsx(lc,{size:16,className:"animate-spin"}),b.jsx("span",{className:"text-sm font-medium",children:"Syncing..."})]}):a?b.jsxs("button",{onClick:o,className:"flex items-center gap-1 text-orange-500 hover:text-orange-600 transition-colors",title:"Sync pending - tap to sync",children:[b.jsx(lc,{size:16}),b.jsx("span",{className:"text-sm font-medium",children:"Sync"})]}):b.jsxs("div",{className:"flex items-center gap-1 text-green-500",children:[b.jsx(a9,{size:16}),b.jsx("span",{className:"text-sm font-medium",children:"Online"})]}):b.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[b.jsx(r9,{size:16}),b.jsx("span",{className:"text-sm font-medium",children:c?"Testing...":r?"Saving...":"Offline"})]})}),b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("button",{onClick:()=>Je(!Ie),className:`transition-colors ${Ie?"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300":"text-gray-500 hover:text-gray-600 dark:text-zinc-400 dark:hover:text-zinc-300"}`,title:Ie?"Lock envelope order":"Unlock to reorder envelopes",children:Ie?b.jsx(CL,{size:22}):b.jsx(DL,{size:22})}),b.jsx("button",{onClick:_a,className:"text-orange-500 hover:text-orange-600 dark:hover:text-orange-400 transition-colors",title:"Start Fresh - Clear current month budget",children:b.jsx(lc,{size:22})}),b.jsx(rte,{})]})]}),b.jsx(nte,{amount:Jt,totalIncome:m.reduce((Ae,je)=>Ae+je.amount,0),totalAllocated:y.filter(Ae=>t.some(je=>je.id===Ae.envelopeId)).reduce((Ae,je)=>Ae+je.budgetedAmount,0),isLoading:r,variant:"header"}),b.jsx(tte,{currentMonth:h,onMonthChange:Ae=>{re(!1),xr.getState().setCurrentMonth(Ae)}})]}),b.jsxs("div",{className:"pt-40 p-4 max-w-md mx-auto space-y-6",children:[te&&b.jsx(ste,{currentMonth:h,onCopy:Zt,onDismiss:()=>re(!1)}),b.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[b.jsxs("div",{className:"flex justify-between items-center mb-4",children:[b.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Income Sources"}),b.jsx("button",{onClick:tr,className:"text-blue-600 dark:text-blue-300 hover:text-blue-700 dark:hover:text-blue-200 transition-colors",children:b.jsx(bm,{size:20})})]}),m.length===0?b.jsx("div",{className:"text-center py-6",children:b.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-sm",children:"No income sources yet. Add your monthly income."})}):b.jsx("div",{className:"space-y-3",children:b.jsx(vc,{initial:!1,mode:"popLayout",children:m.map(Ae=>b.jsx(pl.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:b.jsx(Xp,{onDelete:()=>Js(Ae),children:b.jsxs("div",{className:"flex justify-between items-center py-3 px-4 bg-gray-50 dark:bg-zinc-800 rounded-xl cursor-pointer",onClick:()=>Qt(Ae),children:[b.jsxs("div",{className:"flex-1",children:[b.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:Ae.name}),b.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Monthly income"})]}),b.jsxs("p",{className:"font-semibold text-green-600 dark:text-emerald-400",children:["$",Ae.amount.toFixed(2)]})]})})},Ae.id))})})]}),b.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[b.jsxs("div",{className:"flex justify-between items-center mb-4",children:[b.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Spending Envelopes"}),b.jsx("button",{onClick:()=>P("/add-envelope"),className:"text-blue-600 dark:text-blue-300 hover:text-blue-700 dark:hover:text-blue-200 transition-colors",title:"Create New Envelope",children:b.jsx(bm,{size:20})})]}),_r.length===0?b.jsxs("div",{className:"text-center py-6",children:[b.jsx(aw,{className:"w-12 h-12 text-gray-300 dark:text-zinc-700 mx-auto mb-3"}),b.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-sm mb-4",children:t.length>0?"No envelopes added to this month. Copy from previous month or add new ones.":"No envelopes yet. Create one to get started."}),b.jsx("button",{onClick:()=>P("/add-envelope"),className:"text-blue-600 dark:text-blue-300 font-medium hover:text-blue-700 dark:hover:text-blue-200 transition-colors",children:"Create First Envelope"})]}):b.jsx("div",{ref:pt,children:b.jsx(vc,{initial:!1,children:b.jsx("div",{className:"space-y-3",children:_r.map((Ae,je)=>{const rn=y.find(Nt=>Nt.envelopeId===Ae.id)?.budgetedAmount||0,qr=Me(Ae.id),cr=()=>{if(je===0)return;const Nt=[...Ft.current];[Nt[je-1],Nt[je]]=[Nt[je],Nt[je-1]],Ft.current=Nt,At(Nt),A(Nt)},wr=()=>{if(je===_r.length-1)return;const Nt=[...Ft.current];[Nt[je],Nt[je+1]]=[Nt[je+1],Nt[je]],Ft.current=Nt,At(Nt),A(Nt)};return b.jsx(ute,{env:Ae,budgetedAmount:rn,remainingBalance:qr,editingEnvelopeId:ge,setEditingEnvelopeId:we,editingAmount:Te,setEditingAmount:Xe,handleBudgetSave:bn,navigate:P,inputRef:Se,transactions:e,currentMonth:h,setMoveableRef:d,isReorderingActive:$e,activelyDraggingId:Pt,onItemDragStart:Zs,onMoveUp:cr,onMoveDown:wr,isFirst:je===0,isLast:je===_r.length-1,isReorderUnlocked:Ie},Ae.id)})})})})]}),b.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[b.jsxs("div",{className:"flex justify-between items-center mb-4",children:[b.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[b.jsx(jh,{size:20,className:"text-blue-600 dark:text-blue-400"}),"Piggybanks"]}),b.jsx("button",{onClick:()=>P("/add-envelope?type=piggybank"),className:"text-blue-600 dark:text-blue-300 hover:text-blue-700 dark:hover:text-blue-200 transition-colors",title:"Create New Piggybank",children:b.jsx(bm,{size:20})})]}),lr.length>0?b.jsx("div",{className:"space-y-3",children:lr.map(Ae=>b.jsx(ote,{piggybank:Ae,balance:Me(Ae.id),onNavigate:je=>P(`/envelope/${je}`)},Ae.id))}):b.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-zinc-400",children:[b.jsx(jh,{size:48,className:"mx-auto mb-3 opacity-30"}),b.jsx("p",{className:"text-sm",children:"No piggybanks yet"}),b.jsx("p",{className:"text-xs mt-1",children:"Click the + button above to create your first piggybank"})]})]}),b.jsx("button",{onClick:()=>P("/add-transaction"),className:"fixed bottom-32 right-6 md:bottom-20 bg-blue-600 text-white p-4 rounded-full shadow-lg active:scale-90 transition-transform z-40 pointer-events-auto",children:b.jsx(bm,{size:28})}),b.jsx(ite,{isVisible:C,onClose:xa,mode:V,initialIncomeSource:j}),b.jsx(ate,{isVisible:$,onClose:()=>H(!1),onConfirm:ut,currentMonth:h,incomeCount:m.length,totalIncome:m.reduce((Ae,je)=>Ae+je.amount,0),allocationCount:y.filter(Ae=>t.some(je=>je.id===Ae.envelopeId)).length,totalAllocated:y.filter(Ae=>t.some(je=>je.id===Ae.envelopeId)).reduce((Ae,je)=>Ae+je.budgetedAmount,0)})]})]})]})},fte=[{id:"1",name:"Amazon Prime",network:"Visa",last4:"7474",color:"#232f3e"},{id:"2",name:"Apple Card",network:"Mastercard",last4:"0274",color:"#e3e3e3"},{id:"3",name:"AA Credit Union",network:"Visa",last4:"3386",color:"#5494DA"}],gj=({selectedCard:t,onCardSelect:e,initialCards:n=fte,disabled:r=!1,isUserSelected:i=!1})=>{const[a,o]=G.useState(n[0]),[c,u]=G.useState(!1),[d,h]=G.useState(!1),[p,m]=G.useState(n),[y,_]=G.useState(null),[w,E]=G.useState({name:"",network:"Visa",last4:"",color:"#3b82f6"}),T=t||a;G.useEffect(()=>{!t&&e&&p.length>0&&e(p[0])},[t,e,p]);const I=k=>{r||(k.id==="add-new"?h(!0):(o(k),e?.(k),u(!1)))},D=()=>{r||u(!c)},O=k=>{r||_(k)},z=()=>{if(y&&!r){const k=p.filter(V=>V.id!==y.id);if(m(k),T.id===y.id&&k.length>0){const V=k[0];o(V),e?.(V)}_(null)}},P=()=>{_(null)},A=()=>{if(r)return;if(w.last4.length!==4||!/^\d{4}$/.test(w.last4)){alert("Please enter exactly 4 digits for the last 4 digits");return}if(!w.name.trim()){alert("Please enter a card name");return}const k={id:`custom-${Date.now()}`,name:w.name.trim(),network:w.network,last4:w.last4,color:w.color},V=[...p,k];m(V),o(k),e?.(k),h(!1),u(!1),E({name:"",network:"Visa",last4:"",color:"#3b82f6"})},C=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#6b7280","#0f4c81","#fdbb30","#7fb5b5","#232f3e","#e3e3e3"];return b.jsxs(b.Fragment,{children:[b.jsxs("div",{children:[b.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Payment Method",!i&&b.jsx("span",{className:"ml-2 text-xs text-blue-600 dark:text-blue-400 font-medium",children:"(Default selected)"})]}),b.jsxs("div",{onClick:D,className:`flex items-center gap-4 p-3 border rounded-lg transition-colors ${r?"cursor-not-allowed opacity-50 border-gray-300 dark:border-gray-600":"cursor-pointer hover:bg-gray-50 dark:hover:bg-zinc-800 border-gray-300 dark:border-gray-600"} ${i?"":"ring-2 ring-blue-200 dark:ring-blue-800"}`,children:[b.jsxs("div",{className:"w-[70px] h-[40px] rounded-lg flex flex-col justify-between p-[6px] shadow-lg text-white font-mono text-xs",style:{backgroundColor:T.color},children:[b.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:T.network}),b.jsxs("span",{className:"text-left text-[9px] leading-none",children:[" ",T.last4]})]}),b.jsxs("div",{className:"flex-1",children:[b.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:T.name}),b.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(...",T.last4,")"]})]}),b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx("span",{className:"text-gray-400",children:c?"":""}),!i&&b.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",title:"Default payment method - tap to change"})]})]}),c&&b.jsx("div",{className:"card-stack-dropdown",children:b.jsx("div",{className:"card-stack",children:b.jsx(vc,{initial:!1,mode:"popLayout",children:[...p,{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}].map((k,V)=>{const B=T.id===k.id,j=k.id==="add-new";return b.jsx(pl.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:b.jsx(Xp,{onDelete:()=>!j&&!r&&O(k),threshold:-80,children:b.jsxs("div",{className:`card-stack-item ${B?"selected":""} ${j?"add-new-card":""}`,onClick:()=>I(k),style:{backgroundColor:j?"#f3f4f6":k.color,color:j?"#374151":k.color==="#e3e3e3"?"#000":"#fff",zIndex:p.length-V},children:[b.jsxs("div",{className:"card-header",children:[b.jsx("span",{className:"card-network",children:j?"":k.network}),B&&!j&&b.jsx("span",{className:"selected-indicator",children:""})]}),b.jsxs("div",{className:"card-details",children:[b.jsx("div",{className:"card-name",children:k.name}),b.jsx("div",{className:"card-number",children:j?"":` ${k.last4}`})]}),j&&b.jsx("div",{className:"add-icon",children:b.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[b.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),b.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})})},k.id)})})})})]}),d&&b.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-md mx-4",children:[b.jsxs("div",{className:"flex justify-between items-center mb-6",children:[b.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Add New Card"}),b.jsx("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:""})]}),b.jsxs("div",{className:"space-y-4",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Card Name"}),b.jsx("input",{type:"text",value:w.name,onChange:k=>E({...w,name:k.target.value}),placeholder:"e.g., My Chase Card",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Network"}),b.jsxs("select",{value:w.network,onChange:k=>E({...w,network:k.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[b.jsx("option",{value:"Visa",children:"Visa"}),b.jsx("option",{value:"Mastercard",children:"Mastercard"}),b.jsx("option",{value:"Amex",children:"Amex"})]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Last 4 Digits"}),b.jsx("input",{type:"text",value:w.last4,onChange:k=>E({...w,last4:k.target.value.replace(/\D/g,"").slice(0,4)}),placeholder:"1234",maxLength:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Card Color"}),b.jsx("div",{className:"grid grid-cols-6 gap-2",children:C.map(k=>b.jsx("button",{onClick:()=>E({...w,color:k}),className:`w-full h-10 rounded-lg border-2 transition-all ${w.color===k?"border-blue-500 scale-110":"border-gray-300 dark:border-gray-600"}`,style:{backgroundColor:k}},k))})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Preview"}),b.jsxs("div",{className:"w-full h-20 rounded-lg flex flex-col justify-between p-3 shadow-lg text-white font-mono text-xs",style:{backgroundColor:w.color},children:[b.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:w.network}),b.jsxs("span",{className:"text-left text-[9px] leading-none",children:[" ",w.last4||"0000"]})]})]}),b.jsxs("div",{className:"flex gap-3 pt-4",children:[b.jsx("button",{onClick:()=>h(!1),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),b.jsx("button",{onClick:A,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors",children:"Add Card"})]})]})]})}),y&&b.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:b.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-sm mx-4",children:b.jsxs("div",{className:"text-center",children:[b.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center mx-auto mb-4",children:b.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:b.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),b.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Delete Card"}),b.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Are you sure you want to delete ",b.jsx("span",{className:"font-medium",children:y.name}),"?"]}),b.jsxs("div",{className:"flex gap-3",children:[b.jsx("button",{onClick:P,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),b.jsx("button",{onClick:z,className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md transition-colors",children:"Delete"})]})]})})})]})},mj=({isVisible:t,onClose:e,mode:n,currentEnvelope:r,initialTransaction:i})=>{const{addTransaction:a,updateTransaction:o,deleteTransaction:c}=An(),{currentMonth:u}=xr(),[d,h]=G.useState(""),[p,m]=G.useState(""),[y,_]=G.useState(""),[w,E]=G.useState(new Date().toISOString().split("T")[0]),[T,I]=G.useState(null);if(G.useEffect(()=>{if(!t)return;const A=window.setTimeout(()=>{if(n==="edit"&&i){h(i.amount.toString()),m(i.merchant||""),_(i.description),I(i.paymentMethod||null);try{const C=new Date(i.date);isNaN(C.getTime())?(console.warn("Invalid date in transaction:",i.date),E(new Date().toISOString().split("T")[0])):E(C.toISOString().split("T")[0])}catch(C){console.error("Error parsing transaction date:",C),E(new Date().toISOString().split("T")[0])}}else h(""),m(""),_(""),E(new Date().toISOString().split("T")[0]),I(null)},0);return()=>window.clearTimeout(A)},[t,n,i]),!t)return null;const D=async A=>{A.preventDefault();const C=parseFloat(d);if(isNaN(C)||C<=0){console.log(" Invalid amount:",d);return}console.log(" Saving transaction:",{mode:n,amount:C,note:y,date:w,envelopeId:r.id,paymentMethod:T});try{const k=new Date(w),V=`${k.getFullYear()}-${(k.getMonth()+1).toString().padStart(2,"0")}`;if(V!==u){const B=`This transaction date (${V}) does not match the current budget month (${u}). Are you sure you want to save it?`;if(!window.confirm(B))return}n==="add"?(console.log(" Adding income transaction"),await a({amount:C,description:y,merchant:p||void 0,date:new Date(w).toISOString(),envelopeId:r.id,type:"Income",reconciled:!1,paymentMethod:T||void 0})):n==="spend"?(console.log(" Adding expense transaction"),await a({amount:C,description:y,merchant:p||void 0,date:new Date(w).toISOString(),envelopeId:r.id,type:"Expense",reconciled:!1,paymentMethod:T||void 0})):n==="edit"&&i&&(console.log(" Updating transaction"),await o({...i,amount:C,description:y,merchant:p||void 0,date:new Date(w).toISOString(),paymentMethod:T||void 0})),console.log(" Transaction saved successfully"),e()}catch(k){console.error(" Error saving transaction:",k),alert("Failed to save transaction: "+(k instanceof Error?k.message:"Unknown error"))}},O=()=>{!i||!i.id||window.confirm("Are you sure you want to delete this transaction?")&&(c(i.id),e())},z=n==="add"?"Add Money":n==="spend"?"Spend Money":"Edit Transaction",P=n==="add"?"text-green-500":"text-red-500";return b.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:b.jsxs("div",{className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden",children:[b.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[b.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),b.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:z}),b.jsx("button",{onClick:D,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!d||parseFloat(d)<=0,children:"Save"})]}),b.jsxs("form",{onSubmit:D,className:"p-6 space-y-6",children:[b.jsxs("div",{className:"text-center",children:[b.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),b.jsxs("div",{className:"relative inline-block",children:[b.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${P}`,children:"$"}),b.jsx("input",{type:"number",inputMode:"decimal",step:"0.01",value:d,onChange:A=>{const C=A.target.value;(C===""||!isNaN(parseFloat(C))&&parseFloat(C)>=0)&&h(C)},onKeyDown:A=>{(A.key==="e"||A.key==="E"||A.key==="+"||A.key==="-")&&A.preventDefault()},placeholder:"0.00",autoFocus:!0,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${P} placeholder-gray-700`})]})]}),b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[b.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),b.jsx("input",{type:"text",value:p,onChange:A=>m(A.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),b.jsx(gj,{selectedCard:T,onCardSelect:I}),b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[b.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),b.jsx("input",{type:"text",value:y,onChange:A=>_(A.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[b.jsxs("div",{className:"flex justify-between items-center mb-1",children:[b.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const A=new Date(w);return`${A.getFullYear()}-${(A.getMonth()+1).toString().padStart(2,"0")}`!==u?b.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[b.jsx(vv,{size:14}),b.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),b.jsx("input",{type:"date",value:w,onChange:A=>{console.log("Date changed to:",A.target.value),E(A.target.value)},required:!0,className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),n==="edit"&&b.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-zinc-800",children:b.jsxs("button",{type:"button",onClick:O,className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-50 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-200 dark:border-zinc-800",children:[b.jsx(lN,{className:"w-5 h-5 mr-2"}),"Delete Transaction"]})})]})]})})},hte=({isVisible:t,onClose:e,sourceEnvelope:n})=>{const{envelopes:r,transferFunds:i}=An(),[a,o]=G.useState(""),[c,u]=G.useState(""),[d,h]=G.useState(""),[p,m]=G.useState(new Date().toISOString().split("T")[0]),y=r.filter(E=>E.id!==n.id);if(G.useEffect(()=>{if(!t)return;const E=window.setTimeout(()=>{o(""),u(""),h(""),m(new Date().toISOString().split("T")[0])},0);return()=>window.clearTimeout(E)},[t]),!t)return null;const _=E=>{E.preventDefault();const T=parseFloat(c);isNaN(T)||T<=0||!a||(i(n.id,a,T,d,new Date(p)),e())},w=r.find(E=>E.id===a);return b.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:b.jsxs("div",{className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden",children:[b.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[b.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),b.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:"Transfer Money"}),b.jsx("button",{onClick:_,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!c||parseFloat(c)<=0||!a,children:"Transfer"})]}),b.jsxs("form",{onSubmit:_,className:"p-6 space-y-6",children:[b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800",children:[b.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"From"}),b.jsx("div",{className:"text-gray-900 dark:text-white font-medium",children:n.name})]}),b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[b.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"To"}),b.jsxs("select",{value:a,onChange:E=>o(E.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none cursor-pointer",children:[b.jsx("option",{value:"",className:"bg-white dark:bg-zinc-900",children:"Select envelope..."}),y.map(E=>b.jsx("option",{value:E.id,className:"bg-white dark:bg-zinc-900",children:E.name},E.id))]})]}),b.jsxs("div",{className:"text-center",children:[b.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),b.jsxs("div",{className:"relative inline-block",children:[b.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl text-blue-600 dark:text-blue-400",children:"$"}),b.jsx("input",{type:"number",inputMode:"decimal",step:"0.01",value:c,onChange:E=>u(E.target.value),onKeyDown:E=>{(E.key==="e"||E.key==="E"||E.key==="+"||E.key==="-")&&E.preventDefault()},placeholder:"0.00",autoFocus:!0,className:"bg-transparent text-4xl font-bold text-center w-40 focus:outline-none text-blue-600 dark:text-blue-400 placeholder-gray-400 dark:placeholder-gray-600"})]})]}),b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[b.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note (Optional)"}),b.jsx("input",{type:"text",value:d,onChange:E=>h(E.target.value),placeholder:"What is this transfer for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[b.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Date"}),b.jsx("input",{type:"date",value:p,onChange:E=>m(E.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),w&&c&&parseFloat(c)>0&&b.jsxs("div",{className:"text-center text-sm text-gray-500 dark:text-zinc-400 pt-2 border-t border-gray-200 dark:border-zinc-800",children:["Moving ",b.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-bold",children:["$",parseFloat(c).toFixed(2)]})," from"," ",b.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:n.name})," to"," ",b.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:w.name})]})]})]})})},pte=t=>{if(!t)return"No Date";try{let e;return t&&typeof t=="object"&&t.toDate&&typeof t.toDate=="function"?e=t.toDate():typeof t=="number"?t<1e10?e=new Date((t+978307200)*1e3):e=new Date(t):e=new Date(t),isNaN(e.getTime())?"Invalid Date":new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(e)}catch(e){return console.error("Date error:",e),"Error"}},gte=t=>{const e=typeof t=="string"?parseFloat(t):t;return typeof e!="number"||isNaN(e)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.abs(e))},vj=({transaction:t,envelopeName:e,onReconcile:n,onEdit:r})=>{if(!t)return null;console.log(" Transaction payment method:",t.paymentMethod);const i=t.type==="Income",a=t.type==="Expense";let o="text-gray-900 dark:text-white";return i&&(o="text-green-600 dark:text-green-400"),a&&(o="text-red-600 dark:text-red-400"),b.jsxs("div",{onClick:r,className:"flex items-center justify-between p-4 bg-white dark:bg-zinc-900 active:bg-gray-50 dark:active:bg-zinc-800 transition-colors cursor-pointer group border-b border-gray-100 dark:border-zinc-800 last:border-0",children:[b.jsxs("div",{className:"flex flex-col gap-1 overflow-hidden",children:[b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx("span",{className:"font-medium text-gray-900 dark:text-white truncate",children:t.merchant||t.description||"No Description"}),t.reconciled&&b.jsx("span",{className:"text-[10px] bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 px-1.5 py-0.5 rounded-full font-bold uppercase tracking-wide",children:"R"})]}),t.merchant&&t.description&&t.description!==t.merchant&&b.jsx("div",{className:"text-xs text-gray-600 dark:text-zinc-400 truncate",children:t.description}),b.jsxs("div",{className:"text-xs text-gray-500 dark:text-zinc-500 flex items-center gap-1 flex-wrap",children:[b.jsx("span",{children:pte(t.date)}),e&&b.jsxs(b.Fragment,{children:[b.jsx("span",{children:""}),b.jsx("span",{className:"text-blue-500 dark:text-blue-400 truncate max-w-[150px]",children:e})]}),t.paymentMethod&&b.jsxs(b.Fragment,{children:[b.jsx("span",{children:""}),b.jsxs("span",{className:"flex items-center gap-1",children:[b.jsx("span",{className:"w-[12px] h-[8px] rounded-[2px] flex-shrink-0",style:{backgroundColor:t.paymentMethod.color}}),b.jsx("span",{className:"truncate max-w-[80px]",children:t.paymentMethod.name})]})]})]})]}),b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsxs("div",{className:`font-bold font-mono whitespace-nowrap ${o}`,children:[a?"-":i?"+":"",gte(t.amount)]}),n?b.jsx("button",{type:"button",onClick:c=>{c.stopPropagation(),n()},className:"p-1.5 rounded-full border border-transparent hover:border-green-200 dark:hover:border-green-500 transition-colors","aria-label":t.reconciled?"Mark as unreconciled":"Mark as reconciled",children:t.reconciled?b.jsx(yI,{className:"text-green-500",size:20}):b.jsx(xI,{className:"text-gray-400",size:20})}):b.jsx("span",{children:t.reconciled?b.jsx(yI,{className:"text-green-500",size:20}):b.jsx(xI,{className:"text-gray-400",size:20})})]})]})},mte=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t),vte=()=>{const{id:t}=L6(),{envelopes:e,transactions:n,fetchData:r,isLoading:i,deleteEnvelope:a,renameEnvelope:o,updateTransaction:c,deleteTransaction:u,restoreTransaction:d,getEnvelopeBalance:h}=An(),{showToast:p}=Yd(),{currentMonth:m}=xr(),y=as(),_=is(),[w,E]=G.useState(!1),[T,I]=G.useState(!1),[D,O]=G.useState(!1),[z,P]=G.useState(null);G.useEffect(()=>{e.length===0&&r()},[]);const A=e.find(j=>j.id===t);if(!A)return i?b.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:b.jsx("p",{children:"Loading envelope..."})}):b.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:b.jsx("p",{children:"Envelope not found."})});if(A.isPiggybank){const j=n.filter(N=>N.envelopeId===A.id);console.log(" Piggybank:",A.name),console.log(" Created at:",A.createdAt),console.log(" Transactions:",j.map(N=>({date:N.date,description:N.description,amount:N.amount})))}const C=n.filter(j=>j.envelopeId===A.id).filter(j=>{if(A.isPiggybank){if(!A.createdAt)return!0;const N=new Date(A.createdAt);return new Date(j.date)>=N}return j.month===m||!j.month}).sort((j,N)=>new Date(N.date).getTime()-new Date(j.date).getTime()),k=()=>{_.state?.fromGlobalFAB?y("/"):y(-1)},V=()=>{t&&(a(t),y(-1))},B=j=>{const N={...j,reconciled:!j.reconciled};c(N)};return b.jsxs("div",{className:"min-h-screen bg-white dark:bg-black text-gray-900 dark:text-white p-4 pb-28",children:[b.jsxs("header",{className:"flex justify-between items-center pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 bg-white dark:bg-black z-10 border-b border-gray-100 dark:border-zinc-800",children:[b.jsx("button",{onClick:()=>{const j=prompt("Rename envelope:",A.name);j&&j.trim()&&t&&o(t,j)},className:"text-blue-600 dark:text-blue-400 font-medium",children:"Rename"}),b.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:A.name}),b.jsx("button",{onClick:k,className:"text-blue-600 dark:text-blue-400 font-bold",children:"Done"})]}),b.jsx("section",{className:"mt-4 bg-white dark:bg-zinc-900 rounded-lg p-4 shadow-lg mb-4 border border-gray-100 dark:border-zinc-800",children:b.jsxs("div",{className:"flex justify-between items-center mb-2",children:[b.jsx("span",{className:"text-lg font-headline text-gray-900 dark:text-white",children:"Current Balance"}),(()=>{const j=h(A.id).toNumber();return console.log(`Debug: Envelope ${A.name} Balance:`,j),b.jsx("span",{className:`text-xl font-bold ${j<0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:mte(j)})})()]})}),b.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg mb-4 divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:[b.jsxs("button",{className:"flex items-center w-full p-4 text-left text-green-600 dark:text-green-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>E(!0),children:[b.jsx(eL,{className:"w-5 h-5 mr-3"}),"Add Money"]}),b.jsxs("button",{className:"flex items-center w-full p-4 text-left text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>I(!0),children:[b.jsx(Zz,{className:"w-5 h-5 mr-3"}),"Spend Money"]}),b.jsxs("button",{className:"flex items-center w-full p-4 text-left text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>O(!0),children:[b.jsx(Uz,{className:"w-5 h-5 mr-3"}),"Transfer Money"]})]}),b.jsxs("section",{className:"mt-6",children:[b.jsx("h2",{className:"text-sm font-semibold uppercase text-gray-500 dark:text-zinc-400 mb-2 px-2",children:"Transaction History"}),b.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:C.length===0?b.jsx("p",{className:"p-4 text-center text-gray-500 dark:text-zinc-400",children:"No transactions yet for this envelope."}):b.jsx(vc,{initial:!1,mode:"popLayout",children:C.map(j=>b.jsx(pl.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:b.jsx(Xp,{onDelete:()=>{if(!j.id)return;const N={...j};u(j.id),p("Transaction deleted","neutral",()=>d(N))},children:b.jsx(vj,{transaction:j,onReconcile:()=>B(j),onEdit:()=>P(j)})})},j.id))})})]}),b.jsx("div",{className:"mt-8",children:b.jsxs("button",{className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-100 dark:border-zinc-800",onClick:()=>{confirm(`Are you sure you want to delete "${A.name}"? This will delete all transactions.`)&&V()},children:[b.jsx(lN,{className:"w-5 h-5 mr-2"}),"Delete Envelope"]})}),(w||T||z)&&b.jsx(mj,{isVisible:w||T||!!z,onClose:()=>{E(!1),I(!1),P(null)},mode:w?"add":T?"spend":"edit",currentEnvelope:A,initialTransaction:z}),D&&b.jsx(hte,{isVisible:D,onClose:()=>O(!1),sourceEnvelope:A})]})},yte="1.2.0",bte={version:yte},xte=()=>{const t=as(),e=G.useRef(null),{envelopes:n,transactions:r,resetData:i,importData:a,getEnvelopeBalance:o,appSettings:c,updateAppSettings:u,initializeAppSettings:d}=An(),{envelopeAllocations:h,incomeSources:p}=xr(),{currentUser:m,deleteAccount:y}=Xi(),[_,w]=G.useState(null),[E,T]=G.useState(()=>localStorage.getItem("lastBackupDate")||"Never"),[I,D]=G.useState(!1),[O,z]=G.useState(""),[P,A]=G.useState(!1),[C,k]=G.useState(!1),[V,B]=G.useState(null);console.log(V);const j=978307200,N=bte.version,K=c?.theme??"system";G.useEffect(()=>{c||d().catch(Y=>{console.error("Failed to initialize app settings:",Y)})},[c,d]),G.useEffect(()=>{const{cleanupInvalidAllocations:Y}=xr.getState();Y()},[]);const W=(Y,ne)=>{w({type:Y,text:ne}),setTimeout(()=>w(null),3500)},$=G.useMemo(()=>{const Y=n.length,ne=r.length,pe=p.length,de=h.length,ge=n.reduce((Se,Ie)=>Se+o(Ie.id).toNumber(),0),we=0,Te=r.reduce((Se,Ie)=>{let Je=0;if(typeof Ie.date=="string"){const Me=Date.parse(Ie.date);Je=Number.isNaN(Me)?0:Me}else typeof Ie.date=="number"&&(Je=Ie.date<2e9?(Ie.date+j)*1e3:Ie.date);return Math.max(Se,Je)},0),Xe=we||Te?new Date(Math.max(we,Te)).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"Never";return{envelopeCount:Y,transactionCount:ne,incomeSourceCount:pe,allocationCount:de,totalBalance:ge,lastUpdated:Xe}},[n,r,p,h]),H=()=>{try{console.log(" Creating backup..."),console.log(" Envelopes in store:",n.map(we=>({id:we.id,name:we.name,isPiggybank:we.isPiggybank,hasPiggybankConfig:!!we.piggybankConfig,piggybankConfig:we.piggybankConfig})));const Y={appVersion:"2.1 (PWA)",backupDate:Date.now(),appSettings:c||{theme:"system"},envelopes:n.map(we=>({...we,currentBalance:o(we.id).toNumber(),lastUpdated:new Date().toISOString()})),transactions:r,envelopeAllocations:h,incomeSources:p};console.log(" Backup data created:",{envelopeCount:Y.envelopes.length,piggybankEnvelopes:Y.envelopes.filter(we=>we.isPiggybank).length,sampleEnvelope:Y.envelopes.find(we=>we.isPiggybank)||Y.envelopes[0]});const ne=new Blob([JSON.stringify(Y,null,2)],{type:"application/json"}),pe=URL.createObjectURL(ne),de=document.createElement("a");de.href=pe,de.download=`HouseBudget_Backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(de),de.click(),document.body.removeChild(de),URL.revokeObjectURL(pe);const ge=new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});localStorage.setItem("lastBackupDate",ge),T(ge),B({success:!0,message:"Backup downloaded successfully."})}catch(Y){console.error(Y),B({success:!1,message:"Failed to create backup file.",onRetry:H})}},te=()=>{k(!0),B(null);try{const Y=["Date","Merchant","Notes","Amount","Type","Envelope","Reconciled"],ne=r.map(Te=>{const Xe=n.find(Me=>Me.id===Te.envelopeId)?.name||"Unknown",Se=(Te.merchant||"").replace(/"/g,'""'),Ie=(Te.description||"").replace(/"/g,'""');let Je="Invalid Date";if(Te.date){if(typeof Te.date=="string")Je=Te.date.split("T")[0];else if(typeof Te.date=="number"){const Me=Te.date<2e9?(Te.date+j)*1e3:Te.date;Je=new Date(Me).toISOString().split("T")[0]}}return[Je,`"${Se}"`,`"${Ie}"`,Te.amount.toFixed(2),Te.type,`"${Xe}"`,Te.reconciled?"Yes":"No"].join(",")}),pe=[Y.join(","),...ne].join(`
`),de=new Blob([pe],{type:"text/csv;charset=utf-8;"}),ge=URL.createObjectURL(de),we=document.createElement("a");we.href=ge,we.download=`HouseBudget_Transactions_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(we),we.click(),document.body.removeChild(we),URL.revokeObjectURL(ge),B({success:!0,message:"Transactions CSV exported successfully."})}catch(Y){console.error(Y),B({success:!1,message:"Failed to export CSV. Please try again.",onRetry:te})}finally{k(!1)}},re=()=>{e.current?.click()},ue=Y=>{const ne=Y.target.files?.[0];if(!ne)return;const pe=new FileReader;pe.onload=async de=>{try{const ge=JSON.parse(de.target?.result),we=await a(ge);if(!we.success){W("error",we.message);return}if(ge.appSettings?.theme)try{await u({theme:ge.appSettings.theme})}catch(Te){console.error("Failed to update imported settings:",Te)}else if(ge.appSettings?.isDarkMode!==void 0)try{const Te=ge.appSettings.isDarkMode?"dark":"light";await u({theme:Te})}catch(Te){console.error("Failed to update imported settings:",Te)}W("success",`Loaded ${ge.envelopes?.length??0} envelopes, ${ge.transactions?.length??0} transactions, ${ge.envelopeAllocations?.length??0} allocations, and ${ge.incomeSources?.length??0} income sources.`)}catch(ge){console.error(ge),W("error","Invalid backup file. Please verify the JSON.")}},pe.readAsText(ne),Y.target.value=""},F=async()=>{if(window.confirm("Are you sure? This will permanently delete all envelopes, transactions, budget allocations, income sources, and settings from the cloud. This action cannot be undone."))try{await i(),W("success","All data has been permanently deleted."),t("/")}catch(Y){console.error("Reset failed:",Y),W("error","Failed to delete all data. Some data may remain.")}},Q=async()=>{if(!O.trim()){W("error","Please enter your password to confirm account deletion.");return}D(!0);try{await i(),await y(O)?W("success","Your account has been permanently deleted."):W("error","Failed to delete account. Please try again.")}catch(Y){console.error("Account deletion failed:",Y),W("error","Failed to delete account. Please try again.")}finally{D(!1),A(!1),z("")}};return b.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black transition-colors duration-200",children:[b.jsx("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-between shadow-sm",children:b.jsxs("div",{className:"flex items-center",children:[b.jsx("button",{onClick:()=>t(-1),className:"mr-3 text-blue-600 dark:text-blue-400 font-medium",children:"Done"}),b.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Settings"})]})}),b.jsxs("div",{className:"p-4 space-y-6 max-w-2xl mx-auto pb-24",children:[_&&b.jsxs("div",{className:`px-4 py-3 rounded-2xl text-sm font-medium flex items-center gap-2 ${_.type==="success"?"bg-green-50 text-green-700 dark:bg-emerald-900/30 dark:text-emerald-200":"bg-red-50 text-red-700 dark:bg-red-900/30 dark:text-red-200"}`,children:[_.type==="success"?b.jsx(iw,{size:18}):b.jsx(Wm,{size:18}),_.text]}),b.jsx("section",{children:b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-5 space-y-3",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx(_I,{className:"text-blue-500",size:22}),b.jsxs("div",{children:[b.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Backup & Restore"}),b.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Create backups of all your data including envelopes, transactions, budget allocations, income sources, and settings."})]})]}),b.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 pt-2",children:[b.jsxs("div",{children:[b.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Envelopes"}),b.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:$.envelopeCount})]}),b.jsxs("div",{children:[b.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Transactions"}),b.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:$.transactionCount})]}),b.jsxs("div",{children:[b.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Income Sources"}),b.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:$.incomeSourceCount})]}),b.jsxs("div",{children:[b.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Budget Allocations"}),b.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:$.allocationCount})]})]})]})}),b.jsxs("section",{children:[b.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Appearance"}),b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4",children:[b.jsxs("div",{className:"flex items-center justify-between mb-3",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[K==="light"&&b.jsx("span",{className:"text-orange-500 text-lg",children:""}),K==="dark"&&b.jsx("span",{className:"text-purple-500 text-lg",children:""}),K==="system"&&b.jsx("span",{className:"text-gray-500 text-lg",children:""}),b.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Theme"})]}),b.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 capitalize",children:K})]}),b.jsx("div",{className:"text-xs text-gray-500 dark:text-zinc-500 mb-3",children:"Choose your preferred appearance."}),b.jsx("div",{className:"flex gap-2",children:[{label:"Light",value:"light"},{label:"Dark",value:"dark"},{label:"System",value:"system"}].map(Y=>b.jsx("button",{onClick:async()=>{try{await u({theme:Y.value})}catch(ne){console.error("Failed to update theme setting:",ne)}},className:`flex-1 py-2 rounded-lg text-sm font-medium border transition-colors ${K===Y.value?"bg-blue-50 dark:bg-blue-900/30 border-blue-500 text-blue-700 dark:text-blue-200":"border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 hover:border-gray-300 dark:hover:border-zinc-600"}`,children:Y.label},Y.value))})]})]}),b.jsxs("section",{children:[b.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Actions"}),b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:[b.jsxs("button",{onClick:H,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx(_I,{className:"text-blue-500",size:20}),b.jsxs("div",{className:"flex flex-col items-start",children:[b.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Create Backup"}),b.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["Last backup: ",E]})]})]}),b.jsx(Nu,{className:"text-gray-400",size:18})]}),b.jsxs("button",{onClick:re,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx(ZL,{className:"text-blue-500",size:20}),b.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Restore from Backup"})]}),b.jsx(Nu,{className:"text-gray-400",size:18})]}),b.jsx("div",{className:"p-4",children:b.jsxs("button",{onClick:te,disabled:C,className:"w-full flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors disabled:opacity-60 disabled:cursor-not-allowed rounded-xl border border-gray-100 dark:border-zinc-800 px-4 py-3 bg-white dark:bg-zinc-900",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[C?b.jsx(wI,{className:"text-blue-500 animate-spin",size:20}):b.jsx(pL,{className:"text-blue-500",size:20}),b.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:C?"Preparing CSV":"Export Transactions (CSV)"})]}),b.jsx(Nu,{className:"text-gray-400",size:18})]})}),b.jsx("input",{type:"file",ref:e,onChange:ue,accept:".json",className:"hidden"})]})]}),b.jsxs("section",{children:[b.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Tips"}),b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4 text-sm text-gray-600 dark:text-zinc-300 space-y-2",children:[b.jsx("p",{children:"Create regular backups before major changes."}),b.jsx("p",{children:"Store backups in iCloud, Files, or another safe location."}),b.jsx("p",{children:"Backups are plain JSON files and can be inspected in any text editor."}),b.jsx("p",{children:"Restoring replaces all current envelopes, transactions, budget allocations, income sources, and settings."})]})]}),b.jsxs("section",{children:[b.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Danger Zone"}),b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm",children:[b.jsxs("button",{onClick:F,className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/10 transition-colors group border-b border-gray-100 dark:border-zinc-800",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx(Wm,{className:"text-red-500 group-hover:text-red-600",size:20}),b.jsx("span",{className:"text-red-500 group-hover:text-red-600 font-medium",children:"Reset All Data"})]}),b.jsx(Nu,{className:"text-gray-400",size:18})]}),b.jsxs("button",{onClick:()=>A(!0),className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/10 transition-colors group",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx(Wm,{className:"text-red-600 group-hover:text-red-700",size:20}),b.jsx("span",{className:"text-red-600 group-hover:text-red-700 font-medium",children:"Delete Account"})]}),b.jsx(Nu,{className:"text-gray-400",size:18})]})]}),b.jsxs("div",{className:"px-1 pt-2 text-xs text-gray-500 dark:text-zinc-500 space-y-1",children:[b.jsx("div",{children:"This clears every envelope, transaction, budget allocation, and income source. Use with caution."}),b.jsx("div",{children:"Deleting your account permanently removes all data and cannot be undone."})]})]}),b.jsx("div",{className:"px-1 text-xs text-gray-500 dark:text-zinc-500 flex items-center justify-center",children:b.jsxs("span",{children:["App Version ",N]})}),P&&b.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full p-6 shadow-xl",children:[b.jsxs("div",{className:"flex items-center justify-between mb-4",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("div",{className:"w-10 h-10 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:b.jsx(vv,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),b.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Account"})]}),b.jsx("button",{onClick:()=>A(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:b.jsx(vp,{size:20})})]}),b.jsxs("div",{className:"space-y-4",children:[b.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[b.jsx("p",{className:"text-sm text-red-800 dark:text-red-200 font-medium mb-2",children:"This action cannot be undone"}),b.jsx("p",{className:"text-sm text-red-700 dark:text-red-300",children:"Deleting your account will permanently remove all your data including envelopes, transactions, budget allocations, income sources, and settings. This action is irreversible."})]}),b.jsxs("div",{children:[b.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Account Email: ",b.jsx("span",{className:"font-semibold",children:m?.email})]}),b.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Confirm Password"}),b.jsx("input",{type:"password",value:O,onChange:Y=>z(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your password",disabled:I})]}),b.jsxs("div",{className:"flex gap-3",children:[b.jsx("button",{onClick:()=>A(!1),disabled:I,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors disabled:opacity-50",children:"Cancel"}),b.jsx("button",{onClick:Q,disabled:I||!O.trim(),className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white rounded-md transition-colors disabled:cursor-not-allowed flex items-center justify-center gap-2",children:I?b.jsxs(b.Fragment,{children:[b.jsx(wI,{className:"w-4 h-4 animate-spin"}),"Deleting..."]}):"Delete Account"})]})]})]})})]})]})},_te=()=>{const{addEnvelope:t}=An(),{setEnvelopeAllocation:e,currentMonth:n}=xr(),r=as(),[i]=Dz(),[a,o]=G.useState(""),[c,u]=G.useState(""),d=i.get("type")==="piggybank",[h,p]=G.useState(""),[m,y]=G.useState(""),[_,w]=G.useState("#3B82F6"),E=async T=>{if(T.preventDefault(),!a.trim())return;const I=parseFloat(c),D=isNaN(I)?0:I,O=An.getState().envelopes,P=(O.length>0?Math.max(...O.map(V=>V.orderIndex??0)):-1)+1,A=d?new Date(`${n}-01T00:00:00.000Z`):new Date,C={name:a,currentBalance:D,lastUpdated:new Date().toISOString(),createdAt:A.toISOString(),isActive:!0,orderIndex:P};d&&(C.isPiggybank=!0,C.piggybankConfig={targetAmount:h?parseFloat(h):void 0,monthlyContribution:parseFloat(m||"0"),color:_,icon:"piggy-bank"}),t(C).then(V=>{if(V){const B=d?parseFloat(m||"0"):0;e(V,B).catch(j=>console.error("Failed to create allocation:",j))}}).catch(V=>{console.error("Failed to create envelope:",V)}),setTimeout(()=>{r("/")},50)};return b.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-28",children:[b.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-10 flex items-center shadow-sm",children:[b.jsx("button",{onClick:()=>r("/"),className:"mr-3 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white",children:b.jsx(Vh,{size:24})}),b.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:d?"New Piggybank":"New Envelope"})]}),b.jsx("div",{className:"p-4 max-w-md mx-auto",children:b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:[b.jsx("div",{className:"p-6 bg-blue-50 dark:bg-zinc-800 border-b border-blue-100 dark:border-zinc-700 flex justify-center py-8",children:b.jsx("div",{className:"w-20 h-20 bg-blue-100 dark:bg-zinc-700 text-blue-600 dark:text-blue-400 rounded-full flex items-center justify-center",children:d?b.jsx(jh,{size:40}):b.jsx(mL,{size:40})})}),b.jsxs("form",{onSubmit:E,className:"p-6 space-y-6 pb-6",children:[b.jsxs("div",{className:"space-y-2",children:[b.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:d?"Piggybank Name":"Envelope Name"}),b.jsx("input",{type:"text",id:"name",value:a,onChange:T=>o(T.target.value),placeholder:d?"e.g. Vacation Fund, Emergency Savings":"e.g. Groceries, Rent, Fun Money",className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",autoFocus:!0,required:!0})]}),d&&b.jsxs(b.Fragment,{children:[b.jsxs("div",{className:"space-y-2",children:[b.jsx("label",{htmlFor:"monthly-contribution",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Monthly Auto-Contribution *"}),b.jsxs("div",{className:"relative",children:[b.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),b.jsx("input",{type:"number",id:"monthly-contribution",value:m,onChange:T=>y(T.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:d})]}),b.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"This amount will be automatically added each month and deducted from Available to Budget"})]}),b.jsxs("div",{className:"space-y-2",children:[b.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Target Goal (Optional)"}),b.jsxs("div",{className:"relative",children:[b.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),b.jsx("input",{type:"number",id:"target-amount",value:h,onChange:T=>p(T.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),b.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Set a savings goal to track progress"})]}),b.jsxs("div",{className:"space-y-2",children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Color"}),b.jsx("div",{className:"grid grid-cols-6 gap-2",children:[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#F59E0B",label:"Amber"},{value:"#EF4444",label:"Red"},{value:"#8B5CF6",label:"Purple"},{value:"#EC4899",label:"Pink"}].map(T=>b.jsx("button",{type:"button",onClick:()=>w(T.value),className:`w-full aspect-square rounded-lg transition-all ${_===T.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-zinc-900":"hover:scale-110"}`,style:{backgroundColor:T.value},title:T.label},T.value))})]})]}),b.jsxs("div",{className:"space-y-2",children:[b.jsx("label",{htmlFor:"balance",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Initial Deposit (Optional)"}),b.jsxs("div",{className:"relative",children:[b.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),b.jsx("input",{type:"number",id:"balance",value:c,onChange:T=>u(T.target.value),onKeyDown:T=>{(T.key==="e"||T.key==="E"||T.key==="+"||T.key==="-")&&T.preventDefault()},placeholder:"0.00",step:"0.01",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),b.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:'This creates an "Initial Deposit" income transaction. You can also add money later by editing the envelope budget on the main screen.'})]}),b.jsxs("div",{className:"pt-4 flex gap-3",children:[b.jsx("button",{type:"button",onClick:()=>r("/"),className:"flex-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 font-semibold bg-white dark:bg-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",children:"Cancel"}),b.jsx("button",{type:"submit",disabled:!a.trim()||d&&!m,className:`flex-1 py-3 px-4 rounded-xl font-semibold shadow-sm text-white transition-colors ${a.trim()&&(!d||m)?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-300 dark:bg-zinc-600 cursor-not-allowed"}`,children:d?"Create Piggybank":"Create Envelope"})]})]})]})})]})},wte=({envelopes:t,transactionAmount:e,onSplitChange:n})=>{const[r,i]=G.useState([]),[a,o]=G.useState({}),[c,u]=G.useState(e),d=_=>{i(w=>w.includes(_)?w.filter(E=>E!==_):[...w,_])},h=(_,w)=>{o(E=>({...E,[_]:w}))};G.useEffect(()=>{if(r.length===1){const _=r[0];o({[_]:e})}},[r.length,e]),G.useEffect(()=>{const _=Object.values(a).reduce((w,E)=>w+(E||0),0);u(e-_),n(a)},[a,e,n]),G.useEffect(()=>{const _={...a};Object.keys(_).forEach(w=>{r.includes(w)||delete _[w]}),Object.keys(_).length!==Object.keys(a).length&&o(_)},[r,a]);const p=()=>{i([]),o({})},m=Math.abs(c)<.01&&r.length>0,y=r.length>0&&Math.abs(c)>.01;return b.jsxs("div",{className:"space-y-3",children:[r.length>1&&b.jsxs("div",{className:`p-3 rounded-lg ${y?"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800":m?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-zinc-800 border border-gray-200 dark:border-zinc-700"}`,children:[b.jsxs("div",{className:"flex justify-between items-center",children:[b.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Remaining to Split:"}),b.jsxs("span",{className:`font-bold text-lg ${y?"text-red-600 dark:text-red-400":m?"text-green-600 dark:text-green-400":"text-gray-900 dark:text-white"}`,children:["$",c.toFixed(2)]})]}),y&&b.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Split amounts must equal transaction total"})]}),b.jsxs("div",{className:"flex justify-between items-center",children:[b.jsx("label",{className:"text-xs text-gray-500 dark:text-zinc-400",children:r.length>1?"Split Across Envelopes":"Select Envelope"}),r.length>0&&b.jsx("button",{type:"button",onClick:p,className:"text-xs text-blue-600 dark:text-blue-400",children:"Clear All"})]}),b.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-200 dark:border-zinc-800 rounded-lg",children:t.map(_=>b.jsxs("div",{className:"flex items-center py-3 px-3 border-b border-gray-100 dark:border-zinc-800 last:border-b-0 hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[b.jsx("input",{type:"checkbox",checked:r.includes(_.id),onChange:()=>d(_.id),className:"mr-3 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),b.jsx("span",{className:"flex-1 text-gray-900 dark:text-white",children:_.name}),r.includes(_.id)&&r.length>1&&b.jsxs("div",{className:"flex items-center",children:[b.jsx("span",{className:"mr-1 text-gray-500 dark:text-zinc-400",children:"$"}),b.jsx("input",{type:"number",min:"0",step:"0.01",value:a[_.id]||"",onChange:w=>h(_.id,parseFloat(w.target.value)||0),className:"w-24 px-2 py-1 border border-gray-300 dark:border-zinc-700 rounded bg-white dark:bg-zinc-900 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]})]},_.id))})]})},Ste=()=>{const t=as(),{envelopes:e,addTransaction:n}=An(),{currentMonth:r}=xr(),[i,a]=G.useState(""),[o,c]=G.useState(""),[u,d]=G.useState(""),[h,p]=G.useState(new Date().toISOString().split("T")[0]),[m,y]=G.useState("expense"),[_,w]=G.useState({}),[E,T]=G.useState(null),[I,D]=G.useState(!1),O=j=>{T(j),E&&D(!0)},z=Object.keys(_).length>0,P=Object.values(_).reduce((j,N)=>j+(N||0),0),A=Math.abs(P-parseFloat(i||"0"))<.01,C=i&&parseFloat(i)>0&&z&&A,k=async j=>{if(j.preventDefault(),!C)return;const[N,K,W]=h.split("-").map(Number),$=new Date(N,K-1,W,12,0,0);console.log(" Selected date:",h),console.log(" Parsed date:",$.toISOString());try{const[H,te]=h.split("-").map(Number),re=`${H}-${te.toString().padStart(2,"0")}`;if(re!==r){const F=`This transaction date (${re}) does not match the current budget month (${r}). Are you sure you want to save it?`;if(!window.confirm(F))return}const ue=Object.entries(_).filter(([F,Q])=>Q>0);Promise.all(ue.map(([F,Q])=>n({amount:Q,description:u,merchant:o||void 0,date:$.toISOString(),envelopeId:F,type:m==="income"?"Income":"Expense",reconciled:!1,paymentMethod:E||void 0}).catch(Y=>console.error("Failed to create transaction:",Y)))).catch(F=>console.error("Failed to create transactions:",F)),t("/")}catch(H){console.error("Error saving transaction:",H),alert("Failed to save transaction: "+(H instanceof Error?H.message:"Unknown error"))}},V=[...e].sort((j,N)=>{const K=j.orderIndex??0,W=N.orderIndex??0;return K!==W?K-W:j.name.localeCompare(N.name)}),B=m==="income"?"text-green-500":"text-red-500";return b.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black",children:[b.jsxs("header",{className:"bg-white dark:bg-black border-b border-gray-200 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 z-10 flex items-center justify-between",children:[b.jsx("button",{onClick:()=>t(-1),className:"text-blue-600 dark:text-blue-400 font-medium",children:"Cancel"}),b.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"New Transaction"}),b.jsx("button",{onClick:k,disabled:!C,className:"text-blue-600 dark:text-blue-400 font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:"Save"})]}),b.jsx("div",{className:"p-4 max-w-md mx-auto pb-24",children:b.jsxs("form",{onSubmit:k,className:"space-y-6",children:[b.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl border border-gray-200 dark:border-zinc-800 overflow-hidden",children:b.jsxs("div",{className:"flex",children:[b.jsx("button",{type:"button",onClick:()=>y("expense"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${m==="expense"?"bg-red-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Expense"}),b.jsx("button",{type:"button",onClick:()=>y("income"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${m==="income"?"bg-green-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Income"})]})}),b.jsxs("div",{className:"text-center",children:[b.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),b.jsxs("div",{className:"relative inline-block",children:[b.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${B}`,children:"$"}),b.jsx("input",{type:"number",inputMode:"decimal",step:"0.01",value:i,onChange:j=>{const N=j.target.value;(N===""||!isNaN(parseFloat(N))&&parseFloat(N)>=0)&&a(N)},onKeyDown:j=>{(j.key==="e"||j.key==="E"||j.key==="+"||j.key==="-")&&j.preventDefault()},placeholder:"0.00",autoFocus:!0,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${B} placeholder-gray-700`})]})]}),b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[b.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),b.jsx("input",{type:"text",value:o,onChange:j=>c(j.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),b.jsx(gj,{selectedCard:E,onCardSelect:O,isUserSelected:I}),b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[b.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),b.jsx("input",{type:"text",value:u,onChange:j=>d(j.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[b.jsxs("div",{className:"flex justify-between items-center mb-1",children:[b.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const[j,N]=h.split("-").map(Number);return`${j}-${N.toString().padStart(2,"0")}`!==r?b.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[b.jsx(vv,{size:14}),b.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),b.jsx("input",{type:"date",value:h,onChange:j=>p(j.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),b.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 transition-colors",children:b.jsx(wte,{envelopes:V,transactionAmount:parseFloat(i)||0,onSplitChange:w})})]})})]})},Ete=()=>{const t=as(),{transactions:e,envelopes:n,updateTransaction:r,deleteTransaction:i,restoreTransaction:a}=An(),{showToast:o}=Yd(),{currentMonth:c}=xr(),[u,d]=G.useState(!1),[h,p]=G.useState(""),[m,y]=G.useState("all"),[_,w]=G.useState("All"),[E,T]=G.useState(!1),[I,D]=G.useState("all"),[O,z]=G.useState(!1),[P,A]=G.useState("all"),[C,k]=G.useState(()=>{const H=new Date;return H.setMonth(H.getMonth()-1),H.toISOString().split("T")[0]}),[V,B]=G.useState(()=>new Date().toISOString().split("T")[0]),[j,N]=G.useState(null),K=G.useMemo(()=>{console.log(" Filtering transactions:",{totalTransactions:e.length,showAllTime:O,currentMonth:c,transactionMonths:e.map(re=>({id:re.id,month:re.month,date:re.date}))});let H=e;return O||(H=e.filter(re=>re.month===c||!re.month),console.log(" After month filter:",H.length,"transactions remain")),H.map(re=>{if(!re)return null;let ue=re.date;if(typeof re.date=="number"){const Q=(re.date+978307200)*1e3;ue=new Date(Q).toISOString()}else if(!re.date||typeof re.date!="string")return null;return{...re,date:ue}}).filter(Boolean).filter(re=>{if(h){const F=h.toLowerCase(),Q=n.find(pe=>pe.id===re.envelopeId)?.name.toLowerCase()||"",Y=re.amount.toFixed(2);if(!(re.description.toLowerCase().includes(F)||Q.includes(F)||Y.includes(F)))return!1}if(m!=="all"&&re.envelopeId!==m||_!=="All"&&re.type!==_||P!=="all"&&(!re.paymentMethod||re.paymentMethod.id!==P)||!re.date||typeof re.date!="string")return!1;const ue=re.date.split("T")[0];return!(I!=="all"&&new Date(ue).getMonth()!==parseInt(I)||E&&!re.reconciled)}).sort((re,ue)=>new Date(ue.date).getTime()-new Date(re.date).getTime())},[e,n,h,m,_,P,C,V,E,O,c]);console.log(" Final filtered transactions:",{count:K.length,transactions:K.map(H=>({id:H.id,description:H.description,amount:H.amount,date:H.date,month:H.month,type:H.type}))});const W=j?n.find(H=>H.id===j.envelopeId):null,$=H=>{const te={...H,reconciled:!H.reconciled};r(te)};return b.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-20 transition-colors duration-200",children:[b.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-between shadow-sm",children:[b.jsxs("div",{className:"flex items-center",children:[b.jsx("button",{onClick:()=>t(-1),className:"mr-3 text-gray-600 hover:text-gray-900 dark:text-zinc-400 dark:hover:text-white transition-colors",children:b.jsx(Vh,{size:24})}),b.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"All Transactions"})]}),b.jsx("button",{onClick:()=>d(!u),className:`p-2 rounded-full transition-colors ${u?"bg-blue-100 text-blue-600 dark:bg-blue-900/40 dark:text-blue-400":"text-gray-400 dark:text-zinc-600 hover:bg-gray-100 dark:hover:bg-zinc-800"}`,children:b.jsx(yL,{size:20,className:u?"fill-current":""})})]}),b.jsxs("div",{className:"px-4 py-2 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 flex justify-between items-center",children:[b.jsxs("div",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:["Month: ",c]}),b.jsx("button",{onClick:()=>z(!O),className:`text-sm px-3 py-1 rounded-md ${O?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-800 dark:bg-zinc-800 dark:text-zinc-300"}`,children:O?"Current Month Only":"All Time"})]}),b.jsx("div",{className:"px-4 py-3 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800",children:b.jsxs("div",{className:"space-y-1",children:[b.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Payment Method"}),b.jsxs("select",{value:P,onChange:H=>A(H.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[b.jsx("option",{value:"all",children:"All Payment Methods"}),[{id:"1",name:"Amazon Prime",network:"Visa",last4:"7474",color:"#232f3e"},{id:"2",name:"Apple Card",network:"Mastercard",last4:"0274",color:"#e3e3e3"},{id:"3",name:"AA Credit Union",network:"Visa",last4:"3386",color:"#5494DA"}].map(H=>b.jsx("option",{value:H.id,children:H.name},H.id))]})]})}),b.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 ${u?"max-h-[500px] opacity-100":"max-h-0 opacity-0"}`,children:b.jsxs("div",{className:"p-4 space-y-4",children:[b.jsxs("div",{className:"relative",children:[b.jsx(zL,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),b.jsx("input",{type:"text",placeholder:"Search transactions...",value:h,onChange:H=>p(H.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none dark:text-white"}),h&&b.jsx("button",{onClick:()=>p(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",children:b.jsx(vp,{size:16})})]}),b.jsxs("div",{className:"space-y-1",children:[b.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Envelope"}),b.jsxs("select",{value:m,onChange:H=>y(H.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[b.jsx("option",{value:"all",children:"All Envelopes"}),n.sort((H,te)=>H.name.localeCompare(te.name)).map(H=>b.jsx("option",{value:H.id,children:H.name},H.id))]})]}),b.jsx("div",{className:"bg-gray-100 dark:bg-zinc-800 p-1 rounded-lg flex",children:["All","Income","Expense"].map(H=>b.jsx("button",{onClick:()=>w(H),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${_===H?"bg-white dark:bg-zinc-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-zinc-500 hover:text-gray-700"}`,children:H},H))}),b.jsxs("div",{className:"space-y-1",children:[b.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Month"}),b.jsxs("select",{value:I,onChange:H=>D(H.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[b.jsx("option",{value:"all",children:"All Months"}),Array.from({length:12},(H,te)=>te).map(H=>b.jsx("option",{value:H,children:new Date(2022,H).toLocaleString("default",{month:"long"})},H))]})]}),b.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[b.jsxs("div",{className:"space-y-1",children:[b.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"From"}),b.jsx("div",{className:"relative",children:b.jsx("input",{type:"date",value:C,onChange:H=>k(H.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]}),b.jsxs("div",{className:"space-y-1",children:[b.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"To"}),b.jsx("div",{className:"relative",children:b.jsx("input",{type:"date",value:V,onChange:H=>B(H.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]})]}),b.jsxs("div",{className:"flex items-center justify-between pt-2",children:[b.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show only reconciled"}),b.jsx("button",{onClick:()=>T(!E),className:`w-11 h-6 rounded-full transition-colors relative ${E?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:b.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${E?"translate-x-5":"translate-x-0"}`})})]}),b.jsxs("div",{className:"flex items-center justify-between pt-2",children:[b.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show all time"}),b.jsx("button",{onClick:()=>z(!O),className:`w-11 h-6 rounded-full transition-colors relative ${O?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:b.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${O?"translate-x-5":"translate-x-0"}`})})]})]})}),b.jsx("div",{className:"p-4 max-w-2xl mx-auto",children:b.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:K.length===0?b.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-zinc-500",children:"No transactions match your filters."}):b.jsx(vc,{initial:!1,mode:"popLayout",children:K.map(H=>{const te=n.find(re=>re.id===H.envelopeId);return b.jsx(pl.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:b.jsx(Xp,{onDelete:()=>{if(!H.id)return;const re={...H};i(H.id),o("Transaction deleted","neutral",()=>a(re))},children:b.jsx(vj,{transaction:H,envelopeName:te?.name||"Unknown Envelope",onReconcile:()=>$(H),onEdit:()=>{te?N(H):alert("Cannot edit: Envelope deleted.")}})})},H.id)})})})}),j&&W&&b.jsx(mj,{isVisible:!!j,onClose:()=>N(null),mode:"edit",currentEnvelope:W,initialTransaction:j})]})},yj=[{id:"length",label:"Minimum 12 characters",regex:/^.{12,}$/},{id:"uppercase",label:"At least one uppercase letter (A-Z)",regex:/[A-Z]/},{id:"lowercase",label:"At least one lowercase letter (a-z)",regex:/[a-z]/},{id:"number",label:"At least one number (0-9)",regex:/\d/},{id:"special",label:"At least one special character (!@#$%^&*)",regex:/[!@#$%^&*]/}],Tte=t=>{if(!t)return{score:0,level:"weak",color:"text-gray-400",label:"Enter password"};const r=yj.map(c=>({...c,met:c.regex.test(t)})).filter(c=>c.met).length;let i,a,o;return r<=1?(i="weak",a="text-red-500",o="Weak"):r<=3?(i="medium",a="text-yellow-500",o="Medium"):r===4?(i="strong",a="text-blue-500",o="Strong"):(i="very-strong",a="text-green-500",o="Very Strong"),{score:r,level:i,color:a,label:o}},ME=t=>{const e=yj.map(i=>({...i,met:i.regex.test(t)})),n=Tte(t),r=e.every(i=>i.met);return{requirements:e,strength:n,isValid:r,isEmpty:!t.trim()}},Ate=({password:t,className:e=""})=>{const{strength:n,isEmpty:r}=ME(t);return r?null:b.jsxs("div",{className:`flex items-center gap-2 ${e}`,children:[b.jsx("div",{className:"flex-1",children:b.jsx("div",{className:"flex gap-1",children:[1,2,3,4].map(i=>b.jsx("div",{className:`h-1 flex-1 rounded-full ${i<=n.score?n.score<=1?"bg-red-500":n.score<=3?"bg-yellow-500":n.score===4?"bg-blue-500":"bg-green-500":"bg-gray-200 dark:bg-gray-700"}`},i))})}),b.jsx("span",{className:`text-sm font-medium ${n.color}`,children:n.label})]})},Cte=({password:t,className:e=""})=>{const{requirements:n,isEmpty:r}=ME(t);return r?null:b.jsx("div",{className:`space-y-1 ${e}`,children:n.map(i=>b.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.met?b.jsx(qz,{className:"h-4 w-4 text-green-500 flex-shrink-0"}):b.jsx(vp,{className:"h-4 w-4 text-red-500 flex-shrink-0"}),b.jsx("span",{className:i.met?"text-green-700 dark:text-green-300":"text-gray-600 dark:text-gray-400",children:i.label})]},i.id))})},Ite=()=>{const[t,e]=G.useState(""),[n,r]=G.useState(""),[i,a]=G.useState(""),[o,c]=G.useState(!1),[u,d]=G.useState(!1),[h,p]=G.useState(!1),[m,y]=G.useState(!1),{login:_,register:w,sendPasswordReset:E,isLoading:T,loginError:I,clearError:D}=Xi(),O=ME(n),z=async A=>{if(A.preventDefault(),D(),t.trim()&&n.trim())if(u){if(!i.trim()||!O.isValid)return;await w(t.trim(),n,i.trim())}else await _(t.trim(),n)},P=async A=>{A.preventDefault(),t.trim()&&await E(t.trim())&&y(!0)};return G.useEffect(()=>{e(""),r(""),a(""),y(!1)},[u,h]),b.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:b.jsxs("div",{className:"max-w-md w-full space-y-8",children:[b.jsx("div",{className:"text-center",children:b.jsxs("div",{className:"flex flex-col items-center gap-3 mb-2",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"Personal Budget Logo",className:"w-10 h-10"}),b.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"Personal Budget"})]}),b.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Simple envelope budgeting for personal finance"})]})}),b.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:h?b.jsxs("form",{onSubmit:P,className:"space-y-6",children:[b.jsxs("div",{className:"text-center mb-2",children:[b.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Reset Password"}),b.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Enter your email and we'll send you a link to reset your password."})]}),b.jsxs("div",{children:[b.jsx("label",{htmlFor:"reset-email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),b.jsxs("div",{className:"relative",children:[b.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:b.jsx(yx,{className:"h-5 w-5 text-gray-400"})}),b.jsx("input",{id:"reset-email",type:"email",value:t,onChange:A=>e(A.target.value),className:"w-full pl-10 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"email"})]})]}),m?b.jsxs("div",{className:"text-center py-4",children:[b.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 dark:bg-green-900/30",children:b.jsx(yx,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),b.jsx("h3",{className:"mt-3 text-lg font-medium text-gray-900 dark:text-white",children:"Check your email"}),b.jsxs("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:["We've sent a password reset link to ",b.jsx("span",{className:"font-medium",children:t})]}),b.jsxs("button",{type:"button",onClick:()=>p(!1),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[b.jsx(Vh,{className:"-ml-1 mr-2 h-4 w-4"}),"Back to login"]})]}):b.jsxs(b.Fragment,{children:[b.jsx("button",{type:"submit",disabled:T||!t.trim(),className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?"Sending...":"Send Reset Link"}),b.jsx("div",{className:"mt-4 text-center",children:b.jsxs("button",{type:"button",onClick:()=>p(!1),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:[b.jsx(Vh,{className:"inline-block h-4 w-4 -ml-1 mr-1"}),"Back to login"]})})]})]}):b.jsxs("form",{onSubmit:z,className:"space-y-6",children:[b.jsxs("div",{className:"text-center mb-6",children:[b.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:u?"Create Account":"Sign In"}),b.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:u?"Create a new account to get started":"Sign in to your account"})]}),b.jsxs("div",{children:[b.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),b.jsx("input",{id:"email",type:"email",value:t,onChange:A=>e(A.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"username"})]}),u&&b.jsxs("div",{children:[b.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Display Name"}),b.jsx("input",{id:"displayName",type:"text",value:i,onChange:A=>a(A.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your display name",required:!0,disabled:T})]}),b.jsxs("div",{children:[b.jsxs("div",{className:"flex items-center justify-between mb-2",children:[b.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"}),!u&&b.jsx("button",{type:"button",onClick:()=>p(!0),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:"Forgot password?"})]}),b.jsxs("div",{className:"relative",children:[b.jsx("input",{id:"password",type:o?"text":"password",value:n,onChange:A=>r(A.target.value),className:`w-full px-3 py-2 pr-10 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white ${u&&n&&!O.isValid?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"Enter your password",required:!0,disabled:T,autoComplete:u?"new-password":"current-password"}),b.jsx("button",{type:"button",onClick:()=>c(!o),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none",disabled:T,children:o?b.jsx(uL,{className:"h-5 w-5"}):b.jsx(fL,{className:"h-5 w-5"})})]}),u&&n&&b.jsx("div",{className:"mt-2",children:b.jsx(Ate,{password:n})}),u&&n&&b.jsx("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-md",children:b.jsx(Cte,{password:n})})]}),I&&b.jsxs("div",{className:"text-red-600 dark:text-red-400 text-sm text-center bg-red-50 dark:bg-red-900/20 p-3 rounded-md",children:[I,I.includes("verify your email")&&b.jsx("div",{className:"mt-3",children:b.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Please check your email and click the verification link to continue."})})]}),b.jsx("button",{type:"submit",disabled:T||!t.trim()||!n.trim()||u&&!i.trim()||u&&!O.isValid,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?u?"Creating Account...":"Signing in...":u?"Create Account":"Sign In"}),b.jsx("div",{className:"mt-6 text-center",children:b.jsxs("button",{type:"button",onClick:()=>{d(!u),p(!1)},className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",disabled:T,children:[b.jsx(e9,{className:"h-4 w-4"}),u?"Already have an account? Sign In":"Don't have an account? Sign Up"]})})]})})]})})},Bk=()=>{const[t,e]=G.useState(!1),[n,r]=G.useState(!1),{currentUser:i,resendEmailVerification:a,logout:o,loginError:c}=Xi();G.useEffect(()=>{i||console.warn("EmailVerificationView: No current user, this should not happen")},[i]);const u=async()=>{e(!0),r(!1);const h=await a();e(!1),h&&(r(!0),setTimeout(()=>r(!1),3e3))},d=async()=>{await o()};return i?b.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:b.jsxs("div",{className:"max-w-md w-full space-y-8",children:[b.jsx("div",{className:"text-center",children:b.jsx("div",{className:"flex flex-col items-center gap-3 mb-2",children:b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"House Budget Logo",className:"w-10 h-10"}),b.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"House Budget"})]})})}),b.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:b.jsxs("div",{className:"text-center",children:[b.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/30 mb-4",children:b.jsx(yx,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),b.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Check your email"}),b.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["We've sent a verification link to"," ",b.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:i.email})]}),b.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 mb-6",children:b.jsxs("div",{className:"flex items-start gap-3",children:[b.jsx(iw,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),b.jsxs("div",{className:"text-left",children:[b.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium",children:"What to do next:"}),b.jsxs("ol",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1 space-y-1",children:[b.jsx("li",{children:"1. Open your email inbox"}),b.jsx("li",{children:"2. Find the email from House Budget"}),b.jsx("li",{children:'3. Click the "Verify Email" link'}),b.jsx("li",{children:"4. Return here and sign in"})]})]})]})}),c&&b.jsx("div",{className:"text-red-600 dark:text-red-400 text-sm mb-4 p-3 bg-red-50 dark:bg-red-900/20 rounded-md",children:c}),n&&b.jsx("div",{className:"text-green-600 dark:text-green-400 text-sm mb-4 p-3 bg-green-50 dark:bg-green-900/20 rounded-md",children:"Verification email sent successfully!"}),b.jsx("button",{onClick:u,disabled:t,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed mb-4 flex items-center justify-center gap-2",children:t?b.jsxs(b.Fragment,{children:[b.jsx(lc,{className:"h-4 w-4 animate-spin"}),"Sending..."]}):b.jsxs(b.Fragment,{children:[b.jsx(lc,{className:"h-4 w-4"}),"Resend verification email"]})}),b.jsxs("button",{onClick:d,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",children:[b.jsx(Vh,{className:"h-4 w-4"}),"Back to sign in"]})]})}),b.jsx("div",{className:"text-center",children:b.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Didn't receive the email? Check your spam folder or try resending."})})]})}):null},Fk=[{id:"1",name:"Amazon Prime",network:"Visa",last4:"7474",color:"#232f3e"},{id:"2",name:"Apple Card",network:"Mastercard",last4:"0274",color:"#e3e3e3"},{id:"3",name:"AA Credit Union",network:"Visa",last4:"3386",color:"#5494DA"}],Dte=()=>{const[t,e]=G.useState(Fk[0]),[n,r]=G.useState(!1),[i,a]=G.useState(!1),[o,c]=G.useState(Fk),[u,d]=G.useState(null),[h,p]=G.useState({name:"",network:"Visa",last4:"",color:"#3b82f6"}),m=D=>{D.id==="add-new"?a(!0):(e(D),r(!1))},y=()=>{r(!n)},_=D=>{d(D)},w=()=>{if(u){const D=o.filter(O=>O.id!==u.id);c(D),t.id===u.id&&D.length>0&&e(D[0]),d(null)}},E=()=>{d(null)},T=()=>{if(h.last4.length!==4||!/^\d{4}$/.test(h.last4)){alert("Please enter exactly 4 digits for the last 4 digits");return}if(!h.name.trim()){alert("Please enter a card name");return}const D={id:`custom-${Date.now()}`,name:h.name.trim(),network:h.network,last4:h.last4,color:h.color};c([...o,D]),e(D),a(!1),r(!1),p({name:"",network:"Visa",last4:"",color:"#3b82f6"})},I=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#6b7280","#0f4c81","#fdbb30","#7fb5b5","#232f3e","#e3e3e3"];return b.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black p-8",children:[b.jsxs("div",{className:"max-w-md mx-auto",children:[b.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:"Apple Wallet-Style Card Stack"}),b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-6 space-y-6",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Payment Method"}),b.jsxs("div",{onClick:y,className:"flex items-center gap-4 p-3 border border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:[b.jsxs("div",{className:"w-[70px] h-[40px] rounded-lg flex flex-col justify-between p-[6px] shadow-lg text-white font-mono text-xs",style:{backgroundColor:t.color},children:[b.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:t.network}),b.jsxs("span",{className:"text-left text-[9px] leading-none",children:[" ",t.last4]})]}),b.jsxs("div",{className:"flex-1",children:[b.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:t.name}),b.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(...",t.last4,")"]})]}),b.jsx("div",{className:"text-gray-400",children:n?"":""})]})]}),n&&b.jsx("div",{className:"card-stack-dropdown",children:b.jsx("div",{className:"card-stack",children:b.jsx(vc,{initial:!1,mode:"popLayout",children:[...o,{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}].map((D,O)=>{const z=t.id===D.id,P=D.id==="add-new";return b.jsx(pl.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:b.jsx(Xp,{onDelete:()=>!P&&_(D),threshold:-80,children:b.jsxs("div",{className:`card-stack-item ${z?"selected":""} ${P?"add-new-card":""}`,onClick:()=>m(D),style:{backgroundColor:P?"#f3f4f6":D.color,color:P?"#374151":D.color==="#e3e3e3"?"#000":"#fff",zIndex:o.length-O},children:[b.jsxs("div",{className:"card-header",children:[b.jsx("span",{className:"card-network",children:P?"":D.network}),z&&!P&&b.jsx("span",{className:"selected-indicator",children:""})]}),b.jsxs("div",{className:"card-details",children:[b.jsx("div",{className:"card-name",children:D.name}),b.jsx("div",{className:"card-number",children:P?"":` ${D.last4}`})]}),P&&b.jsx("div",{className:"add-icon",children:b.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[b.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),b.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})})},D.id)})})})})]})]}),i&&b.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:b.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-md mx-4",children:[b.jsxs("div",{className:"flex justify-between items-center mb-6",children:[b.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Add New Card"}),b.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:""})]}),b.jsxs("div",{className:"space-y-4",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Card Name"}),b.jsx("input",{type:"text",value:h.name,onChange:D=>p({...h,name:D.target.value}),placeholder:"e.g., My Chase Card",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Network"}),b.jsxs("select",{value:h.network,onChange:D=>p({...h,network:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[b.jsx("option",{value:"Visa",children:"Visa"}),b.jsx("option",{value:"Mastercard",children:"Mastercard"}),b.jsx("option",{value:"Amex",children:"Amex"})]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Last 4 Digits"}),b.jsx("input",{type:"text",value:h.last4,onChange:D=>p({...h,last4:D.target.value.replace(/\D/g,"").slice(0,4)}),placeholder:"1234",maxLength:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Card Color"}),b.jsx("div",{className:"grid grid-cols-6 gap-2",children:I.map(D=>b.jsx("button",{onClick:()=>p({...h,color:D}),className:`w-full h-10 rounded-lg border-2 transition-all ${h.color===D?"border-blue-500 scale-110":"border-gray-300 dark:border-gray-600"}`,style:{backgroundColor:D}},D))})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Preview"}),b.jsxs("div",{className:"w-full h-20 rounded-lg flex flex-col justify-between p-3 shadow-lg text-white font-mono text-xs",style:{backgroundColor:h.color},children:[b.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:h.network}),b.jsxs("span",{className:"text-left text-[9px] leading-none",children:[" ",h.last4||"0000"]})]})]}),b.jsxs("div",{className:"flex gap-3 pt-4",children:[b.jsx("button",{onClick:()=>a(!1),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),b.jsx("button",{onClick:T,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors",children:"Add Card"})]})]})]})}),u&&b.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:b.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-sm mx-4",children:b.jsxs("div",{className:"text-center",children:[b.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center mx-auto mb-4",children:b.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:b.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),b.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Delete Card"}),b.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Are you sure you want to delete ",b.jsx("span",{className:"font-medium",children:u.name}),"?"]}),b.jsxs("div",{className:"flex gap-3",children:[b.jsx("button",{onClick:E,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),b.jsx("button",{onClick:w,className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md transition-colors",children:"Delete"})]})]})})})]})},Rte=()=>{const{message:t,type:e,isVisible:n,undoAction:r,hideToast:i}=Yd(),a=()=>{switch(e){case"success":return"bg-green-500 dark:bg-green-600 text-white";case"error":return"bg-red-500 dark:bg-red-600 text-white";case"neutral":default:return"bg-gray-800 dark:bg-gray-900 text-white border border-gray-200 dark:border-gray-700"}};return b.jsx(vc,{children:n&&b.jsx(pl.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-0 left-4 right-4 z-50 mb-[calc(env(safe-area-inset-bottom)+20px)]",children:b.jsxs("div",{className:`rounded-xl shadow-lg p-4 flex items-center justify-between ${a()}`,children:[b.jsx("div",{className:"flex items-center flex-1 min-w-0",children:b.jsx("span",{className:"text-sm font-medium truncate pr-2",children:t})}),b.jsxs("div",{className:"flex items-center gap-2 ml-3 flex-shrink-0",children:[r&&b.jsxs("button",{onClick:()=>{r(),i()},className:"px-3 py-1.5 bg-white/20 hover:bg-white/30 rounded-lg text-xs font-bold transition-colors",children:[b.jsx(WL,{size:14,className:"inline mr-1"}),"Undo"]}),b.jsx("button",{onClick:i,className:"p-1 hover:bg-black/10 dark:hover:bg-white/10 rounded-full transition-colors",children:b.jsx(vp,{size:16})})]})]})})})};class oa extends G.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("ErrorBoundary caught an error:",e,n),this.setState({error:e,errorInfo:n}),this.props.onError&&this.props.onError(e,n)}componentDidUpdate(e){this.props.resetKeys&&this.props.resetOnPropsChange&&this.props.resetKeys.some((r,i)=>r!==e.resetKeys?.[i])&&this.state.hasError&&this.resetErrorBoundary()}resetErrorBoundary=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:b.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:b.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[b.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 dark:bg-red-900/30 rounded-full",children:b.jsx(vv,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),b.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white text-center mb-2",children:"Something went wrong"}),b.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-6",children:"We're sorry, but something unexpected happened. You can try refreshing or going back to the home screen."}),!1,b.jsxs("div",{className:"flex flex-col gap-3",children:[b.jsxs("button",{onClick:this.resetErrorBoundary,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors",children:[b.jsx(lc,{className:"h-4 w-4"}),"Try Again"]}),b.jsxs("button",{onClick:()=>window.location.href="/#/",className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white font-medium rounded-md transition-colors",children:[b.jsx(xL,{className:"h-4 w-4"}),"Go to Home"]})]})]})}):this.props.children}}const kte=()=>{const t=as(),e=is(),n=[{path:"/",label:"Budget",icon:b.jsx(aw,{className:"w-6 h-6"}),enabled:!0},{path:"/transactions",label:"Transactions",icon:b.jsx(wL,{className:"w-6 h-6"}),enabled:!0},{path:"/settings",label:"Settings",icon:b.jsx(oN,{className:"w-6 h-6"}),enabled:!0},{path:"#",label:"Future",icon:b.jsx(bI,{className:"w-6 h-6"}),enabled:!1},{path:"#",label:"Future",icon:b.jsx(bI,{className:"w-6 h-6"}),enabled:!1}],r=(a,o)=>{o&&a!=="#"&&t(a)},i=a=>a==="/"?e.pathname==="/":e.pathname.startsWith(a);return b.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white dark:bg-zinc-900 border-t border-gray-200 dark:border-zinc-800 safe-area-inset-bottom z-50",children:b.jsx("div",{className:"flex justify-around items-center h-16 max-w-screen-xl mx-auto px-2",children:n.map((a,o)=>b.jsxs("button",{onClick:()=>r(a.path,a.enabled),disabled:!a.enabled,className:`flex flex-col items-center justify-center flex-1 h-full transition-colors ${a.enabled?i(a.path)?"text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white":"text-gray-300 dark:text-zinc-700 cursor-not-allowed"}`,children:[b.jsx("div",{className:`transition-transform ${i(a.path)&&a.enabled?"scale-110":""}`,children:a.icon}),b.jsx("span",{className:"text-xs mt-1 font-medium",children:a.label})]},o))})})};function Nte(){const[t,e]=G.useState(!0),{appSettings:n}=An(),{isAuthenticated:r,isInitialized:i,initializeAuth:a,lastAuthTime:o,offlineGracePeriod:c,currentUser:u}=Xi();if(G.useEffect(()=>{const p=setTimeout(()=>{e(!1)},2e3);return()=>clearTimeout(p)},[]),G.useEffect(()=>a(),[a]),G.useEffect(()=>{const p=document.documentElement,m=window.matchMedia("(prefers-color-scheme: dark)"),y=()=>{const _=n?.theme??"system",w=m.matches;_==="dark"||_==="system"&&w?p.classList.add("dark"):p.classList.remove("dark")};if(y(),n?.theme==="system")return m.addEventListener("change",y),()=>m.removeEventListener("change",y)},[n]),t||!i)return b.jsx(pj,{message:"Initializing Personal Budget..."});if(!r)return u?b.jsx(oa,{children:b.jsx(Bk,{})}):b.jsx(oa,{children:b.jsx(Ite,{})});const h=typeof navigator<"u"&&!navigator.onLine&&r&&o&&Date.now()-o<c;return b.jsxs(oa,{children:[h&&b.jsx("div",{className:"bg-yellow-100 dark:bg-yellow-900 border-l-4 border-yellow-500 text-yellow-700 dark:text-yellow-200 p-4",children:b.jsxs("div",{className:"flex",children:[b.jsx("div",{className:"flex-shrink-0",children:b.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:b.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),b.jsx("div",{className:"ml-3",children:b.jsxs("p",{className:"text-sm",children:[b.jsx("strong",{children:"Offline Access:"})," You're using cached authentication. Expires in"," ",Math.ceil((c-(Date.now()-o))/(1440*60*1e3))," ","days. Connect to internet to refresh."]})})]})}),b.jsxs(Ez,{children:[b.jsxs(ez,{children:[b.jsx(Cs,{path:"/",element:b.jsx(oa,{children:b.jsx(dte,{})})}),b.jsx(Cs,{path:"/envelope/:id",element:b.jsx(oa,{children:b.jsx(vte,{})})}),b.jsx(Cs,{path:"/add-envelope",element:b.jsx(oa,{children:b.jsx(_te,{})})}),b.jsx(Cs,{path:"/add-transaction",element:b.jsx(oa,{children:b.jsx(Ste,{})})}),b.jsx(Cs,{path:"/transactions",element:b.jsx(oa,{children:b.jsx(Ete,{})})}),b.jsx(Cs,{path:"/settings",element:b.jsx(oa,{children:b.jsx(xte,{})})}),b.jsx(Cs,{path:"/verify-email",element:b.jsx(oa,{children:b.jsx(Bk,{})})}),b.jsx(Cs,{path:"/card-stack",element:b.jsx(oa,{children:b.jsx(Dte,{})})})]}),b.jsx(kte,{})]}),b.jsx(Rte,{})]})}l6({onNeedRefresh(){},onOfflineReady(){console.log("App is ready for offline work")}});a6.createRoot(document.getElementById("root")).render(b.jsx(G.StrictMode,{children:b.jsx(Nte,{})}));
